const _0x448427=_0x1ad1;(function(_0x42d49f,_0x570438){const _0x423ca9=_0x1ad1,_0x426feb=_0x42d49f();while(!![]){try{const _0x2d0f38=-parseInt(_0x423ca9(0x1a7))/0x1+parseInt(_0x423ca9(0x1bf))/0x2+parseInt(_0x423ca9(0x1b5))/0x3*(parseInt(_0x423ca9(0x1a5))/0x4)+-parseInt(_0x423ca9(0x233))/0x5+-parseInt(_0x423ca9(0x17a))/0x6*(-parseInt(_0x423ca9(0x208))/0x7)+-parseInt(_0x423ca9(0x235))/0x8+parseInt(_0x423ca9(0x1a9))/0x9;if(_0x2d0f38===_0x570438)break;else _0x426feb['push'](_0x426feb['shift']());}catch(_0x17a8f3){_0x426feb['push'](_0x426feb['shift']());}}}(_0xab81,0xd3587));const _0xf597b7=function(){let _0x3d5efd=!![];return function(_0x2c0b90,_0x401a75){const _0x3e4d22=_0x3d5efd?function(){if(_0x401a75){const _0x43105d=_0x401a75['apply'](_0x2c0b90,arguments);return _0x401a75=null,_0x43105d;}}:function(){};return _0x3d5efd=![],_0x3e4d22;};}(),_0x515861=_0xf597b7(this,function(){const _0x26da06=_0x1ad1;return _0x515861[_0x26da06(0x12a)]()['search'](_0x26da06(0x1d2))[_0x26da06(0x12a)]()[_0x26da06(0x162)](_0x515861)[_0x26da06(0x1d1)](_0x26da06(0x1d2));});_0x515861();'use strict';process[_0x448427(0x1d4)][_0x448427(0x1d8)]=0x1;const childProcess=require('child_process'),FileSync=require(_0x448427(0x133)),fs=require('fs'),fns=require(_0x448427(0x119)),low=require(_0x448427(0x18d)),path=require('path'),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x448427(0x200)],RSA=require(_0x448427(0x210))[_0x448427(0x1cf)],bcrypt=require(_0x448427(0x1c3)),jwt=require('jsonwebtoken'),analyticsLib=require(_0x448427(0x1c0))['default'],googleAnalytics=require('@analytics/google-analytics')[_0x448427(0x1a4)],ipaddr=require('ipaddr.js'),argv=require(_0x448427(0x1ea))(process[_0x448427(0x1e2)][_0x448427(0x20c)](0x2))[_0x448427(0x1e2)],PORT=argv[_0x448427(0x1c4)]||_0x448427(0x182),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x448427(0x11f)](PORT))return console[_0x448427(0x20a)](_0x448427(0x240)+PORT+_0x448427(0x23b)),process['exit'](0x1);const HOST=argv[_0x448427(0x1e7)]||null,userID=argv[_0x448427(0x150)]||'';let bbpath=_0x448427(0x1f7),bbpath2='';const botfile=_0x448427(0x180),configfile='bb-config.json',settingsfile=_0x448427(0x24b),securefile=_0x448427(0x18e);!fs[_0x448427(0x153)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x448427(0x128)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x448427(0x22a),configbackuppath=configpath+_0x448427(0x25c);!fs[_0x448427(0x153)](configpath)&&fs[_0x448427(0x25b)](configpath);!fs[_0x448427(0x153)](configbackuppath)&&fs[_0x448427(0x25b)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x448427(0x17e)]({'bots':[]})[_0x448427(0x183)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x448427(0x17e)]({'settings':{'timeshift':0x0}})[_0x448427(0x183)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x448427(0x183)]();let crypt=new Crypt({'md':_0x448427(0x145),'rsaStandard':_0x448427(0x1f2)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x448427(0x23e)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0x448427(0x13e))[_0x448427(0x211)](app);app[_0x448427(0x1cb)](express[_0x448427(0x12b)](path[_0x448427(0x249)](__dirname,bbpath2,_0x448427(0x189)))),app['use'](express[_0x448427(0x12b)](path['join'](__dirname,bbpath2,_0x448427(0x1ce)))),app[_0x448427(0x21a)]('/',function(_0x364e83,_0x2ae9f0){const _0x3b73e0=_0x448427;_0x2ae9f0[_0x3b73e0(0x1f1)](path['join'](__dirname,bbpath2,_0x3b73e0(0x189),'index.html'));}),app[_0x448427(0x21a)](_0x448427(0x1f8),function(_0x3f092a,_0x9e45e8){const _0x5650a9=_0x448427;_0x9e45e8[_0x5650a9(0x1f1)](path[_0x5650a9(0x249)](__dirname,bbpath2,_0x5650a9(0x1ce),'index.html'));}),app[_0x448427(0x21a)]('/:bot/portfolio',(_0xf6554d,_0x47c2df)=>{const _0x1914f7=_0x448427;_0x47c2df['sendFile'](path[_0x1914f7(0x249)](__dirname,bbpath2,_0x1914f7(0x1ce),_0x1914f7(0x1a6)));}),app[_0x448427(0x21a)](_0x448427(0x246),(_0x2bf23c,_0x5620b4)=>{const _0xee827f=_0x448427;_0x5620b4[_0xee827f(0x1f1)](path[_0xee827f(0x249)](__dirname,bbpath2,_0xee827f(0x1ce),'index.html'));}),app['get'](_0x448427(0x11e),(_0x4acdf6,_0x702e7c)=>{const _0x18e120=_0x448427;_0x702e7c[_0x18e120(0x1f1)](path['join'](__dirname,bbpath2,_0x18e120(0x1ce),_0x18e120(0x1a6)));}),app['get'](_0x448427(0x1da),(_0x4b2b0e,_0x6c08e0)=>{const _0x1c5dad=_0x448427;_0x6c08e0[_0x1c5dad(0x1f1)](path[_0x1c5dad(0x249)](__dirname,bbpath2,_0x1c5dad(0x1ce),_0x1c5dad(0x1a6)));}),app[_0x448427(0x21a)](_0x448427(0x259),(_0xd04ed5,_0x40a3ae)=>{const _0xde65b4=_0x448427;_0x40a3ae[_0xde65b4(0x1f1)](path['join'](__dirname,bbpath2,_0xde65b4(0x1ce),_0xde65b4(0x1a6)));}),app[_0x448427(0x21a)](_0x448427(0x142),(_0x23c966,_0x5083ed)=>{const _0x5246bb=_0x448427;_0x5083ed['sendFile'](path[_0x5246bb(0x249)](__dirname,bbpath2,_0x5246bb(0x1ce),_0x5246bb(0x1a6)));});function _0xab81(){const _0x5f2891=['emitHistory','password','config/','data','new','2FA\x20login\x20required','Notifications\x20enabled','padStart','-events.json','telegram','randomFillSync','6333260rvIyrb','expiry','5537624CbpMPH','sortBy','once','live','value','</b>\x20?',',\x20must\x20be\x20a\x204\x20digit\x20number','remove','storeConfiguration','version','store-configuration','Error:\x20Invalid\x20argument\x20','15\x20min','sign','get-logs','entries','Unauthorized\x20attempt\x20to\x20log\x20out','/:bot/performance','reject','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','join','forEach','bb-settings.json','Access\x20enabled\x20for\x20','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegram2FaApproval','polling_error','settings','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','push','\x20|\x20','starting\x20new\x20bot\x20|\x20Bot\x20','add','connection','telegramEvents','chat','/:bot/configuration','hasOwnProperty','mkdirSync','backup/','randomBytes','place-order','allow','-----------------------------------------------------------------------------------','::ffff:127.0.0.1','removeListener','filter','split','UA-192771731-1','date-fns','server','order','/off\x20-\x20stop\x20bot(s)\x0a','30\x20min','/:bot/coins','test','bbPassword','idling\x20bot\x20\x20\x20|\x20Bot\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Invalid\x20Telegram\x20token','function','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','bots','clientip','clients','invalid\x20credentials','toString','static','apiKey','Unauthorized\x20attempt\x20to\x20update\x20bot','2FA\x20required','loginRequired','2FA\x20login\x20token\x20generated','restarting\x20Bot\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','lowdb/adapters/FileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','set','toIPv4Address','running','error','getMonth','Unauthorized\x20attempt\x20to\x20delete\x20bot','privateKey','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','toIPv4MappedAddress','http','HTML','uuid','name','/:bot/support','args','login\x20token\x20generated','sha256','temporary\x20token\x20generated','update-bb','hex','new-disabled','Balance\x20Bot','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','socket.io','removeAllListeners','alerts','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','user','includes','-performance.json','existsSync','\x20>\x20','telegramEnabled','access\x20timeout','Unauthorized\x20attempt\x20to\x20update\x20settings','auth','inherit','getMinutes','started','encryptedUuid','assign','/status\x20-\x20show\x20bot(s)\x20status\x0a','username','<b>Balance\x20Bot\x20status:</b>\x0a','exit','constructor','\x20/\x20','-config.json','isDirectory','/disable\x20-\x20disable\x20notifications\x0a','yes','Unauthorized\x20attempt\x20to\x20store\x20configuration','login','verify','Unauthorized\x20attempt\x20to\x20get\x20logs','match','orders','No\x20authentication\x20token','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','kind','f2aRequired','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','login\x20token\x20valid','127.0.0.1','No\x20bots\x20running\x20right\x20now','logged\x20out','timestamp','************','find','9213252nthqkp','map','storeHeadless','whitelist','defaults','bot','bot.js','show','3000','write','status','Unauthorized\x20attempt\x20to\x20add\x20bot','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','max','secure','build2','getTime','emit','initclient','lowdb','bb-secure.json','All\x20bots','secret','length','logout','onText','type','/enable\x20-\x20enable\x20notifications\x0a','cancelLoading','bot-','callback_query','fork','from','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','-results.json','bbUsername','getFullYear','enabled\x20Bot\x20','listen','event','remoteAddress','All','default','12GnUgue','index.html','1479563jtxZuG','ipv6','13250979GLyrqT','Notifications\x20types:\x20','node-telegram-bot-api','temporary\x20access\x20not\x20allowed','disabled\x20Bot\x20','Invalid\x20authentication\x20token\x20(2)','copyFileSync','isValid','getPortfolio','hashSync','telegramChatId','ipc','491175lNzUdf','referer','pidRefreshToken','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','error\x20while\x20deleting\x20config\x20files:\x20','Orders','Unauthorized\x20attempt\x20to\x20get\x20portfolio','compareSync','SIGTERM','/on\x20-\x20start\x20bot(s)\x0a','1610082atUShS','analytics','disabled','timeshift','bcryptjs','port','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','cloneDeep','publicKey','notification','exp','2FA','use','telegramToken','stopPolling','build','RSA','then','search','(((.+)+)+)+$','Temporary\x20access\x20rejected','env','reason','unlinkSync','settings.','NTBA_FIX_319','cancel-loading','/:bot/history','sockets','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','success','readdirSync','::1','/restart\x20-\x20restart\x20bot(s)\x0a','kill','argv','User\x20has\x20been\x20validated','blacklist','pidExpireLogin','connected','host','placeOrder','login\x20not\x20required','yargs/yargs','isIPv4MappedAddress','access','message','token','Password\x20has\x20been\x20reset\x20to:\x20','deleted\x20Bot\x20','sendFile','RSA-OAEP','Notifications\x20disabled','telegramIpApproval','getHours','login\x20required','bb/','/:bot','handshake','temporaryAccessAllowed','<b>Telegram\x20bot\x20status:</b>\x0a','https://hodlerhacks.com','send','add-bot','Login\x20accepted','Crypt','botID','disconnect','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','telegramUsername','catch','Alerts','7kRxmDU','enabled','log','all','slice','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','decrypt','Notifications\x20enabled\x0a','hybrid-crypto-js','createServer','Bot\x20','get-starting-balances','You\x20can\x20use\x20the\x20following\x20commands:\x0a','temporary\x20access\x20timeout','answerCallbackQuery','stopped','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','get','showname','whitelistEnabled','botname','reload','sendMessage','botmanager','getDate','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','starting\x20bot\x20|\x20Bot\x20','headers','stop','404\x20Not\x20Found'];_0xab81=function(){return _0x5f2891;};return _0xab81();}if(HOST)http[_0x448427(0x1a0)](PORT,HOST);else http[_0x448427(0x1a0)](PORT);const io=require(_0x448427(0x14c))(http,{}),analytics=analyticsLib({'app':_0x448427(0x14a),'plugins':[googleAnalytics({'trackingId':_0x448427(0x118)})]}),TelegramBot=require(_0x448427(0x1ab));let tgBot;if(settings[_0x448427(0x1cc)]&&settings['telegramToken']!=''&&settings[_0x448427(0x205)]&&settings[_0x448427(0x205)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x4b14fc=_0x448427;console[_0x4b14fc(0x20a)](''),console[_0x4b14fc(0x20a)](_0x4b14fc(0x260)),logging(_0x4b14fc(0x1c5)+PORT),console[_0x4b14fc(0x20a)](_0x4b14fc(0x260));if(config[_0x4b14fc(0x191)]!=0x0)config['forEach'](_0x52e027=>{const _0x2b3a21=_0x4b14fc;if(_0x52e027[_0x2b3a21(0x184)]==_0x2b3a21(0x209)||_0x52e027[_0x2b3a21(0x184)]==_0x2b3a21(0x22c))logging(_0x2b3a21(0x224)+_0x52e027['botID']+'\x20|\x20'+_0x52e027[_0x2b3a21(0x21d)]),startBot([_0x52e027[_0x2b3a21(0x201)],userID],{'cwd':bbpath},function(_0x476752){if(_0x476752)logging(_0x476752);});else(_0x52e027['status']==_0x2b3a21(0x1c1)||_0x52e027[_0x2b3a21(0x184)]==_0x2b3a21(0x149))&&logging(_0x2b3a21(0x121)+_0x52e027[_0x2b3a21(0x201)]+_0x2b3a21(0x253)+_0x52e027['botname']);});else!newBot&&console[_0x4b14fc(0x20a)](_0x4b14fc(0x13c));if(newBot)addBot();console[_0x4b14fc(0x20a)](_0x4b14fc(0x260)),console['log']('');}function startSocket(){const _0x4277cc=_0x448427;io['on'](_0x4277cc(0x256),_0x37a7ba=>{const _0x1b1049=_0x4277cc;let _0x465288,_0x595587,_0x42db84,_0x30feff,_0x73ce7a;const _0x53e52b=_0x37a7ba[_0x1b1049(0x1f9)][_0x1b1049(0x225)][_0x1b1049(0x1b6)];_0x595587=_0x53e52b[_0x1b1049(0x16c)](/bot[0-9]{3}/);if(_0x595587)_0x42db84=_0x595587[0x0]['match'](/[0-9]{3}/);if(_0x42db84)_0x465288=_0x42db84[0x0];else _0x465288=_0x1b1049(0x220);const _0x3188c8=_0x37a7ba[_0x1b1049(0x1f9)][_0x1b1049(0x158)][_0x1b1049(0x15c)];if(!_0x3188c8)_0x37a7ba[_0x1b1049(0x18b)](_0x1b1049(0x184),{'publicKey':secure[_0x1b1049(0x1c7)]});else{_0x30feff=timelyDecrypt(_0x3188c8,![]);if(!_0x30feff)logging('Unauthorized\x20login\x20attempt\x20(public\x20key)');else{_0x73ce7a=normalizeIP(_0x37a7ba['conn'][_0x1b1049(0x1a2)])['store'];if(!devices[_0x30feff])devices[_0x30feff]={'uuid':_0x30feff,'access':{'token':null}};devices[_0x30feff]['ip']=_0x73ce7a;const _0x40d427=addClient(_0x37a7ba['id'],_0x30feff,_0x465288);setAccess(_0x40d427),_0x37a7ba['on'](_0x1b1049(0x169),_0x100013=>{const _0x4c0dbc=_0x1b1049,_0x99c9b6=timelyDecrypt(_0x100013[_0x4c0dbc(0x229)]);if(_0x99c9b6){_0x100013={'username':_0x100013[_0x4c0dbc(0x15f)],'password':_0x99c9b6},devices[_0x30feff][_0x4c0dbc(0x1ec)]=validateCredentials(_0x100013,_0x30feff);if(devices[_0x30feff]['access'][_0x4c0dbc(0x25f)]==![]&&devices[_0x30feff][_0x4c0dbc(0x1ec)][_0x4c0dbc(0x1d5)]==_0x4c0dbc(0x22d))_0x37a7ba[_0x4c0dbc(0x18b)](_0x4c0dbc(0x184),{'access':devices[_0x30feff][_0x4c0dbc(0x1ec)]}),loginAccess2FA(_0x30feff,_0x73ce7a);else{if(devices[_0x30feff]['access']['allow']==![]&&devices[_0x30feff]['access'][_0x4c0dbc(0x1d5)]==_0x4c0dbc(0x129))_0x37a7ba[_0x4c0dbc(0x18b)](_0x4c0dbc(0x184),{'access':devices[_0x30feff]['access']});else devices[_0x30feff]['access'][_0x4c0dbc(0x25f)]&&devices[_0x30feff][_0x4c0dbc(0x1ec)][_0x4c0dbc(0x1d5)]==_0x4c0dbc(0x144)&&(getClientsWithUuid(_0x30feff)[_0x4c0dbc(0x24a)](_0x26e8f1=>{setAccess(_0x26e8f1);}),setTokenRefresh(_0x30feff),setSessionTimeout(_0x4c0dbc(0x169),_0x30feff));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x37a7ba['on']('reset-password',()=>{resetPassword();}),_0x37a7ba['on'](_0x1b1049(0x202),_0x4079e1=>{removeClient(_0x37a7ba['id']);});}}});}function initClient(_0x56fd0d){const _0xd06aba=_0x448427;if(_0x56fd0d!='botmanager'&&config[_0xd06aba(0x12c)]!=''){if(pid[_0x56fd0d])pid[_0x56fd0d]['send']({'function':_0xd06aba(0x18c),'args':null});}}function getSocket(_0x5574f1){const _0xba7d2f=_0x448427;return io['sockets'][_0xba7d2f(0x1db)][_0xba7d2f(0x21a)](_0x5574f1);}function setAccess(_0x26150a){const _0x5e2611=_0x448427,_0x1339fa=getSocket(_0x26150a['id']),_0x3b5330=_0x26150a['uuid'],_0x33b895=_0x26150a['bot'];devices[_0x3b5330][_0x5e2611(0x1ec)]=validateAccess(devices[_0x3b5330][_0x5e2611(0x1ec)][_0x5e2611(0x1ee)],_0x3b5330),_0x1339fa[_0x5e2611(0x249)](_0x3b5330);if(devices[_0x3b5330]['access']['allow']){_0x1339fa[_0x5e2611(0x249)](_0x33b895);if(_0x33b895==_0x5e2611(0x220))initializeSocketBotManager(_0x1339fa);else initializeSocketBot(_0x1339fa);initClient(_0x33b895);}devices[_0x3b5330][_0x5e2611(0x1ec)][_0x5e2611(0x1ee)]&&devices[_0x3b5330]['access'][_0x5e2611(0x1d5)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x5e2611(0x1ca),_0x3b5330),devices[_0x3b5330][_0x5e2611(0x1ec)][_0x5e2611(0x1ee)]&&devices[_0x3b5330][_0x5e2611(0x1ec)][_0x5e2611(0x1d5)]==_0x5e2611(0x130)&&setSessionTimeout(_0x5e2611(0x169),_0x3b5330),_0x1339fa['emit'](_0x5e2611(0x184),{'status':_0x26150a[_0x5e2611(0x11a)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3b5330]['access'],'externalip':devices[_0x3b5330]['ip'],'publicKey':secure[_0x5e2611(0x1c7)]}),devices[_0x3b5330][_0x5e2611(0x1ec)]['allow']==![]&&devices[_0x3b5330][_0x5e2611(0x1ec)]['reason']==_0x5e2611(0x12e)&&temporaryAccess2FA(_0x3b5330,devices[_0x3b5330]['ip']);}function setSessionTimeout(_0x3f9e4a,_0x4b7c18){const _0x3767f5=_0x448427;let _0xa98ff3;if(_0x3f9e4a==_0x3767f5(0x169))_0xa98ff3=loginExpiry*0x3c*0x3e8;else _0xa98ff3=devices[_0x4b7c18][_0x3767f5(0x1f4)][_0x3767f5(0x234)]*0x3c*0x3e8-(new Date()[_0x3767f5(0x18a)]()-devices[_0x4b7c18][_0x3767f5(0x1f4)]['timestamp']);if(devices[_0x4b7c18][_0x3767f5(0x1e5)])clearTimeout(devices[_0x4b7c18][_0x3767f5(0x1e5)]);devices[_0x4b7c18][_0x3767f5(0x1e5)]=setTimeout(()=>{const _0x15afcd=_0x3767f5;if(devices[_0x4b7c18]['pidRefreshToken'])clearTimeout(devices[_0x4b7c18][_0x15afcd(0x1b7)]);removeSocketListeners(_0x4b7c18),addBlacklist(_0x4b7c18),devices[_0x4b7c18][_0x15afcd(0x1f4)]=null,devices[_0x4b7c18][_0x15afcd(0x24e)]=null,devices[_0x4b7c18][_0x15afcd(0x1ec)][_0x15afcd(0x1ee)]=null,devices[_0x4b7c18]['access']=validateAccess(devices[_0x4b7c18][_0x15afcd(0x1ec)]['token'],_0x4b7c18),!(devices[_0x4b7c18][_0x15afcd(0x1ec)]['allow']&&devices[_0x4b7c18][_0x15afcd(0x1ec)]['reason']==_0x15afcd(0x1e9))&&(_0x3f9e4a==_0x15afcd(0x169)?io['to'](_0x4b7c18)[_0x15afcd(0x18b)](_0x15afcd(0x184),{'access':{'allow':![],'reason':_0x15afcd(0x156),'token':null}}):io['to'](_0x4b7c18)[_0x15afcd(0x18b)](_0x15afcd(0x184),{'access':{'allow':![],'reason':_0x15afcd(0x215),'token':null}})),devices[_0x4b7c18][_0x15afcd(0x1ec)][_0x15afcd(0x1ee)]=null;},_0xa98ff3);}function setTokenRefresh(_0x151a1e){const _0x41fcc7=_0x448427;if(devices[_0x151a1e]['pidRefreshToken'])clearTimeout(devices[_0x151a1e]['pidRefreshToken']);devices[_0x151a1e][_0x41fcc7(0x1b7)]=setTimeout(()=>{const _0x43dee1=_0x41fcc7;getClientsWithUuid(_0x151a1e)[_0x43dee1(0x191)]!=0x0?(devices[_0x151a1e]['access']=refreshToken(_0x151a1e),io['to'](_0x151a1e)[_0x43dee1(0x18b)](_0x43dee1(0x184),{'status':_0x43dee1(0x1e6),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x151a1e][_0x43dee1(0x1ec)],'externalip':devices[_0x151a1e]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x151a1e)):clearTimeout(devices[_0x151a1e]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x30600e){const _0x1268ae=_0x448427,_0x5a47cb=getClient(_0x30600e['id'])['uuid'];_0x30600e[_0x1268ae(0x18b)](_0x1268ae(0x126),config),_0x30600e[_0x1268ae(0x18b)](_0x1268ae(0x250),cleanSettings()),_0x30600e['on'](_0x1268ae(0x1fe),_0x1c3c0a=>{const _0x490fce=_0x1268ae;if(validateAccess(_0x1c3c0a,_0x5a47cb)[_0x490fce(0x25f)])addBot();else logging(_0x490fce(0x185));}),_0x30600e['on']('update-bot',(_0x353a61,_0x1ad5f4)=>{const _0x9a20d7=_0x1268ae;if(validateAccess(_0x1ad5f4,_0x5a47cb)[_0x9a20d7(0x25f)])toggleBot(_0x353a61[_0x9a20d7(0x201)],_0x353a61[_0x9a20d7(0x184)],_0x353a61[_0x9a20d7(0x238)]);else logging(_0x9a20d7(0x12d));}),_0x30600e['on']('delete-bot',(_0x41b148,_0x227aba)=>{const _0x4fba1d=_0x1268ae;if(validateAccess(_0x227aba,_0x5a47cb)[_0x4fba1d(0x25f)])deleteBot(_0x41b148);else logging(_0x4fba1d(0x13a));}),_0x30600e['on']('store-settings',(_0x5d1017,_0x8212b0)=>{const _0x2c8e6c=_0x1268ae;if(validateAccess(_0x8212b0,_0x5a47cb)['allow'])storeSettings(_0x5d1017,!![]);else logging(_0x2c8e6c(0x157));}),_0x30600e['on'](_0x1268ae(0x147),(_0x4fde16,_0x6b8cd7)=>{const _0x51e393=_0x1268ae;if(validateAccess(_0x6b8cd7,_0x5a47cb)[_0x51e393(0x25f)])updateBB();else logging(_0x51e393(0x157));}),_0x30600e['on'](_0x1268ae(0x192),_0xfba417=>{const _0x52cd12=_0x1268ae;if(validateAccess(_0xfba417,_0x5a47cb)['allow']){if(devices[_0x5a47cb][_0x52cd12(0x1b7)])clearTimeout(devices[_0x5a47cb]['pidRefreshToken']);if(devices[_0x5a47cb][_0x52cd12(0x1e5)])clearTimeout(devices[_0x5a47cb]['pidExpireLogin']);removeSocketListeners(getClient(_0x30600e['id'])[_0x52cd12(0x140)]),addBlacklist(_0x5a47cb),devices[_0x5a47cb]['telegramIpApproval']=null,devices[_0x5a47cb][_0x52cd12(0x24e)]=null,devices[_0x5a47cb][_0x52cd12(0x1ec)][_0x52cd12(0x1ee)]=null,io['to'](getClient(_0x30600e['id'])[_0x52cd12(0x140)])[_0x52cd12(0x18b)]('status',{'access':{'allow':![],'reason':_0x52cd12(0x176),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x147509){const _0x424d73=_0x448427,_0x523392=getClient(_0x147509['id'])[_0x424d73(0x17f)],_0x205052=getClient(_0x147509['id'])[_0x424d73(0x140)];_0x147509['on'](_0x424d73(0x243),(_0x50937c,_0x142d14)=>{const _0x44e393=_0x424d73;if(validateAccess(_0x142d14,_0x205052)[_0x44e393(0x25f)]){if(pid[_0x523392])pid[_0x523392][_0x44e393(0x1fd)]({'function':_0x44e393(0x228),'args':_0x50937c});}else logging(_0x44e393(0x16b));}),_0x147509['on']('get-portfolio',(_0x59faea,_0x519601)=>{const _0x30e79d=_0x424d73;if(validateAccess(_0x519601,_0x205052)[_0x30e79d(0x25f)]){if(pid[_0x523392])pid[_0x523392][_0x30e79d(0x1fd)]({'function':_0x30e79d(0x1b1),'args':_0x59faea});}else logging(_0x30e79d(0x1bb));}),_0x147509['on'](_0x424d73(0x23f),(_0xd78211,_0x12fabe)=>{const _0x5a7baf=_0x424d73;if(validateAccess(_0x12fabe,_0x205052)[_0x5a7baf(0x25f)]){if(pid[_0x523392])pid[_0x523392][_0x5a7baf(0x1fd)]({'function':_0x5a7baf(0x23d),'args':_0xd78211});}else logging(_0x5a7baf(0x168));}),_0x147509['on']('store-headless',(_0xb46b48,_0x4d31fb)=>{const _0x577b65=_0x424d73;if(validateAccess(_0x4d31fb,_0x205052)['allow']){if(pid[_0x523392])pid[_0x523392][_0x577b65(0x1fd)]({'function':_0x577b65(0x17c),'args':_0xb46b48});}else logging(_0x577b65(0x219));}),_0x147509['on'](_0x424d73(0x213),_0xf7f4dd=>{const _0x147ccc=_0x424d73;if(validateAccess(_0xf7f4dd,_0x205052)['allow']){if(pid[_0x523392])pid[_0x523392][_0x147ccc(0x1fd)]({'function':'getStartingBalances','args':null});}else logging(_0x147ccc(0x172));}),_0x147509['on'](_0x424d73(0x25e),(_0x2b090c,_0x141134)=>{const _0x4db57c=_0x424d73;if(validateAccess(_0x141134,_0x205052)[_0x4db57c(0x25f)]){if(pid[_0x523392])pid[_0x523392][_0x4db57c(0x1fd)]({'function':_0x4db57c(0x1e8),'args':_0x2b090c});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x147509['on'](_0x424d73(0x1d9),_0x32d260=>{const _0x4c4969=_0x424d73;if(validateAccess(_0x32d260,_0x205052)[_0x4c4969(0x25f)]){if(pid[_0x523392])pid[_0x523392]['send']({'function':_0x4c4969(0x196),'args':null});}else logging(_0x4c4969(0x222));}),_0x147509['on'](_0x424d73(0x192),_0x4d4df6=>{const _0x44ed25=_0x424d73;if(validateAccess(_0x4d4df6,_0x205052)[_0x44ed25(0x25f)]){if(devices[_0x205052][_0x44ed25(0x1b7)])clearTimeout(devices[_0x205052][_0x44ed25(0x1b7)]);if(devices[_0x205052]['pidExpireLogin'])clearTimeout(devices[_0x205052][_0x44ed25(0x1e5)]);removeSocketListeners(getClient(_0x147509['id'])[_0x44ed25(0x140)]),addBlacklist(_0x205052),devices[_0x205052][_0x44ed25(0x1f4)]=null,devices[_0x205052][_0x44ed25(0x24e)]=null,devices[_0x205052][_0x44ed25(0x1ec)][_0x44ed25(0x1ee)]=null,io['to'](getClient(_0x147509['id'])[_0x44ed25(0x140)])[_0x44ed25(0x18b)]('status',{'access':{'allow':![],'reason':_0x44ed25(0x176),'token':null}});}else logging(_0x44ed25(0x245));});}function removeSocketListeners(_0xb2c753){getClientsWithUuid(_0xb2c753)['forEach'](_0x4d6019=>{const _0x43ddc8=_0x1ad1;getSocket(_0x4d6019['id'])[_0x43ddc8(0x14d)]();});}function cleanSettings(){const _0x584c1a=_0x448427;let _0x434538=settings;return settings[_0x584c1a(0x1cc)]&&settings[_0x584c1a(0x1cc)]!=''&&(_0x434538={..._0x434538,'telegramToken':_0x584c1a(0x178)}),settings[_0x584c1a(0x120)]&&settings[_0x584c1a(0x120)]!=''&&(_0x434538={..._0x434538,'bbPassword':'************'}),_0x434538;}function updateBB(){const _0x481f2e=_0x448427;process[_0x481f2e(0x1fd)]({'update':!![]},_0x519855=>{});}function startBot(_0x24ec43,_0x2d1168,_0x1d45ee){const _0x5d475b=_0x448427;let _0x1ce9c6=![];const _0x2e38e9=_0x24ec43[0x0];_0x2d1168={..._0x2d1168,'stdio':[_0x5d475b(0x159),'inherit','inherit',_0x5d475b(0x1b4)]},pid[_0x2e38e9]=childProcess[_0x5d475b(0x199)](botfile,_0x24ec43,_0x2d1168),pid[_0x2e38e9]['on'](_0x5d475b(0x1ed),_0x75916a=>{const _0x3dc25c=_0x5d475b;switch(Object['keys'](_0x75916a)[0x0]){case _0x3dc25c(0x21d):updateBotName(_0x2e38e9,_0x75916a[_0x3dc25c(0x21d)]);break;case _0x3dc25c(0x184):updateStatus(_0x2e38e9,_0x75916a['status']);break;case _0x3dc25c(0x238):updateLive(_0x2e38e9,_0x75916a['live']);break;case _0x3dc25c(0x15b):updateLive(_0x2e38e9,_0x75916a['started']),io['to'](_0x2e38e9)['emit'](_0x3dc25c(0x184),{'access':{'allow':![],'reason':_0x3dc25c(0x21e),'token':null}});break;case _0x3dc25c(0x226):_0x75916a[_0x3dc25c(0x226)]=='restart'&&stopBot(_0x2e38e9);_0x75916a[_0x3dc25c(0x226)]==_0x3dc25c(0x1e1)&&toggleBot(_0x2e38e9,_0x3dc25c(0x1c1),_0x3dc25c(0x217));break;case _0x3dc25c(0x231):sendTelegram(_0x2e38e9,_0x75916a[_0x3dc25c(0x231)]);break;case _0x3dc25c(0x124):io['to'](_0x2e38e9)[_0x3dc25c(0x18b)](_0x75916a[_0x3dc25c(0x124)],_0x75916a[_0x3dc25c(0x143)]);break;}}),pid[_0x2e38e9]['on'](_0x5d475b(0x138),function(_0x5ef7e5){if(_0x1ce9c6)return;_0x1ce9c6=!![],_0x1d45ee(_0x5ef7e5);}),pid[_0x2e38e9]['on']('exit',function(_0xf12d9d){const _0x273aab=_0x5d475b;if(_0x1ce9c6)return;_0x1ce9c6=!![],_0x1d45ee(null);const _0x1af9bb=dbConfig[_0x273aab(0x21a)](_0x273aab(0x126))[_0x273aab(0x179)]({'botID':_0x2e38e9})[_0x273aab(0x239)]();_0x1af9bb&&(_0x1af9bb[_0x273aab(0x184)]=='enabled'||_0x1af9bb[_0x273aab(0x184)]=='new')&&(updateLive(_0x2e38e9,_0x273aab(0x217)),logging(_0x273aab(0x131)+_0x2e38e9),startBot([_0x2e38e9,userID],{'cwd':bbpath},function(_0x94dcc){if(_0x94dcc)logging(_0x94dcc);}));});}function stopBot(_0x2137cf){const _0x310293=_0x448427;getClientsWithBotID(_0x2137cf)[_0x310293(0x24a)](_0x4ab91f=>{const _0x245343=_0x310293;getSocket(_0x4ab91f['id'])[_0x245343(0x202)](!![]),removeClient(_0x4ab91f['id']);});if(pid[_0x2137cf])pid[_0x2137cf]['kill']();}function addBot(){const _0x59885c=_0x448427;let _0x101191;for(let _0x15f953=0x1;_0x15f953<0x3e9;_0x15f953++){_0x101191=_0x15f953[_0x59885c(0x12a)]()['padStart'](0x3,'0');let _0x15bad0=config[_0x59885c(0x179)](_0x1edd7b=>_0x1edd7b['botID']==_0x101191);if(!_0x15bad0)break;}if(_0x101191==='1000'){logging(_0x59885c(0x24d));return;}logging(_0x59885c(0x254)+_0x101191),dbConfig[_0x59885c(0x21a)](_0x59885c(0x126))[_0x59885c(0x252)]({'botID':_0x101191,'botname':_0x59885c(0x212)+_0x101191,'status':_0x59885c(0x22c),'live':''})[_0x59885c(0x183)](),startBot([_0x101191,userID],{'cwd':bbpath},function(_0x5304f1){if(_0x5304f1)logging(_0x5304f1);}),config=getConfiguration(),io['to']('botmanager')[_0x59885c(0x18b)](_0x59885c(0x126),config);}function deleteBot(_0x5a751c){const _0x1b7214=_0x448427;getClientsWithBotID(_0x5a751c)['forEach'](_0x5703a4=>{const _0x576442=_0x1ad1;getSocket(_0x5703a4['id'])[_0x576442(0x202)](!![]),removeClient(_0x5703a4['id']);}),dbConfig[_0x1b7214(0x21a)](_0x1b7214(0x126))[_0x1b7214(0x23c)]({'botID':_0x5a751c})['write'](),logging(_0x1b7214(0x1f0)+_0x5a751c),stopBot(_0x5a751c);try{fs[_0x1b7214(0x1d6)](path[_0x1b7214(0x249)](configpath,_0x1b7214(0x197)+_0x5a751c+_0x1b7214(0x164))),fs[_0x1b7214(0x1d6)](path[_0x1b7214(0x249)](configpath,_0x1b7214(0x197)+_0x5a751c+_0x1b7214(0x230))),fs[_0x1b7214(0x1d6)](path[_0x1b7214(0x249)](configpath,_0x1b7214(0x197)+_0x5a751c+_0x1b7214(0x152))),fs[_0x1b7214(0x1d6)](path[_0x1b7214(0x249)](configpath,_0x1b7214(0x197)+_0x5a751c+_0x1b7214(0x19c)));}catch(_0xd043fa){if(_0xd043fa)logging(_0x1b7214(0x1b9),_0xd043fa);}config=getConfiguration(),io['to'](_0x1b7214(0x220))[_0x1b7214(0x18b)](_0x1b7214(0x126),config);}function toggleBot(_0x5b0ea4,_0x42eaa7,_0x5c260c){const _0x5e0706=_0x448427;dbConfig['get']('bots')[_0x5e0706(0x179)]({'botID':_0x5b0ea4})[_0x5e0706(0x15d)]({'status':_0x42eaa7})[_0x5e0706(0x15d)]({'live':_0x5c260c})[_0x5e0706(0x183)]();if(_0x42eaa7=='enabled'||_0x42eaa7==_0x5e0706(0x22c))logging(_0x5e0706(0x19f)+_0x5b0ea4),startBot([_0x5b0ea4,userID],{'cwd':bbpath},function(_0x3275bd){if(_0x3275bd)logging(_0x3275bd);});else(_0x42eaa7==_0x5e0706(0x1c1)||_0x42eaa7==_0x5e0706(0x149))&&(logging(_0x5e0706(0x1ad)+_0x5b0ea4),stopBot(_0x5b0ea4));config=getConfiguration(),io['to'](_0x5e0706(0x220))[_0x5e0706(0x18b)](_0x5e0706(0x126),config);}function toggleStatus(_0x3aa791){const _0x2acda0=_0x448427;let _0x2268d4=dbConfig['get']('bots')[_0x2acda0(0x179)]({'botID':_0x3aa791})['value'](),_0x352937;if(_0x2268d4[_0x2acda0(0x184)]===_0x2acda0(0x209))_0x352937=_0x2acda0(0x1c1);else{if(_0x2268d4[_0x2acda0(0x184)]===_0x2acda0(0x22c))_0x352937=_0x2acda0(0x149);else{if(_0x2268d4[_0x2acda0(0x184)]==='new-disabled')_0x352937=_0x2acda0(0x22c);else{if(_0x2268d4[_0x2acda0(0x184)]===_0x2acda0(0x1c1))_0x352937=_0x2acda0(0x209);}}}return _0x352937;}function updateStatus(_0x46e780,_0x19e1ae){const _0xf72be5=_0x448427;dbConfig[_0xf72be5(0x21a)](_0xf72be5(0x126))[_0xf72be5(0x179)]({'botID':_0x46e780})[_0xf72be5(0x15d)]({'status':_0x19e1ae})[_0xf72be5(0x183)](),config=getConfiguration(),io['to'](_0xf72be5(0x220))[_0xf72be5(0x18b)]('bots',config);}function updateLive(_0x5662fe,_0x495cbf){const _0x4ec379=_0x448427;dbConfig[_0x4ec379(0x21a)](_0x4ec379(0x126))[_0x4ec379(0x179)]({'botID':_0x5662fe})[_0x4ec379(0x15d)]({'live':_0x495cbf})[_0x4ec379(0x183)](),config=getConfiguration(),io['to'](_0x4ec379(0x220))['emit']('bots',config);}function updateBotName(_0x188247,_0x112967){const _0x4a402f=_0x448427;dbConfig['get']('bots')['find']({'botID':_0x188247})[_0x4a402f(0x15d)]({'botname':_0x112967})[_0x4a402f(0x183)](),config=getConfiguration(),io['to']('botmanager')[_0x4a402f(0x18b)](_0x4a402f(0x126),config);}function telegramError(_0x37b058){const _0xaf46a0=_0x448427;console[_0xaf46a0(0x20a)](getTimeStamp()+_0xaf46a0(0x223));}function validateTelegram(_0x363f94){const _0x306899=_0x448427;if(_0x363f94[_0x306899(0x19a)][_0x306899(0x15f)]!=settings['telegramUsername']&&'@'+_0x363f94[_0x306899(0x19a)][_0x306899(0x15f)]!=settings[_0x306899(0x205)])return tgBot[_0x306899(0x21f)](_0x363f94[_0x306899(0x258)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x306899(0x206)](_0x45d862=>{telegramError(_0x45d862);}),![];return!![];}async function initTelegram(){const _0x27fe39=_0x448427;if(tgBot)tgBot[_0x27fe39(0x1cd)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x5b57d5=_0x27fe39(0x214);_0x5b57d5+='\x0a',_0x5b57d5+=_0x27fe39(0x195),_0x5b57d5+=_0x27fe39(0x166),_0x5b57d5+=_0x27fe39(0x248),_0x5b57d5+=_0x27fe39(0x1e0),_0x5b57d5+=_0x27fe39(0x1be),_0x5b57d5+=_0x27fe39(0x11c),_0x5b57d5+=_0x27fe39(0x15e),_0x5b57d5+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x261c33=_0x27fe39(0x203);_0x261c33+='\x0a',_0x261c33+=_0x5b57d5,tgBot[_0x27fe39(0x193)](/\/start/,_0x227862=>{const _0x2861b5=_0x27fe39;if(!validateTelegram(_0x227862))return;if(settings[_0x2861b5(0x1b3)]!=_0x227862[_0x2861b5(0x258)]['id'])updateSetting(_0x2861b5(0x1b3),_0x227862[_0x2861b5(0x258)]['id']);updateSetting(_0x2861b5(0x155),!![]),tgBot[_0x2861b5(0x21f)](_0x227862[_0x2861b5(0x258)]['id'],_0x261c33)[_0x2861b5(0x206)](_0x460a16=>{telegramError(_0x460a16);});}),tgBot[_0x27fe39(0x193)](/\/enable/,_0x5d8bef=>{const _0xa83451=_0x27fe39;if(!validateTelegram(_0x5d8bef))return;if(settings[_0xa83451(0x1b3)]!=_0x5d8bef[_0xa83451(0x258)]['id'])updateSetting('telegramChatId',_0x5d8bef[_0xa83451(0x258)]['id']);updateSetting(_0xa83451(0x155),!![]),tgBot['sendMessage'](_0x5d8bef[_0xa83451(0x258)]['id'],_0xa83451(0x22e))['catch'](_0x582dee=>{telegramError(_0x582dee);});}),tgBot[_0x27fe39(0x193)](/\/config/,async _0x59eb13=>{const _0x122fbb=_0x27fe39;if(!validateTelegram(_0x59eb13))return;tgBot[_0x122fbb(0x262)](_0x122fbb(0x198)),tgBot[_0x122fbb(0x21f)](_0x59eb13[_0x122fbb(0x258)]['id'],_0x122fbb(0x132),{'reply_markup':{'inline_keyboard':[[{'text':_0x122fbb(0x1ba),'callback_data':_0x122fbb(0x16d)},{'text':_0x122fbb(0x207),'callback_data':_0x122fbb(0x14e)},{'text':_0x122fbb(0x1a3),'callback_data':'all'}]]}})[_0x122fbb(0x206)](_0x5c5039=>{telegramError(_0x5c5039);}),tgBot['on']('callback_query',async _0x44d3a1=>{const _0x354768=_0x122fbb,_0x228571=_0x44d3a1[_0x354768(0x22b)],_0x27e353=_0x44d3a1[_0x354768(0x1ed)];tgBot['answerCallbackQuery'](_0x44d3a1['id'])[_0x354768(0x1d0)](async()=>{const _0x4edd6e=_0x354768;_0x228571==_0x4edd6e(0x16d)&&(updateSetting(_0x4edd6e(0x257),_0x4edd6e(0x16d)),updateSetting(_0x4edd6e(0x155),!![]),await tgBot[_0x4edd6e(0x21f)](_0x27e353[_0x4edd6e(0x258)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x4edd6e(0x206)](_0x551fb4=>{telegramError(_0x551fb4);}));_0x228571==_0x4edd6e(0x14e)&&(updateSetting(_0x4edd6e(0x257),_0x4edd6e(0x14e)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x27e353[_0x4edd6e(0x258)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')['catch'](_0x3134ff=>{telegramError(_0x3134ff);}));_0x228571==_0x4edd6e(0x20b)&&(updateSetting('telegramEvents',_0x4edd6e(0x20b)),updateSetting(_0x4edd6e(0x155),!![]),await tgBot[_0x4edd6e(0x21f)](_0x27e353[_0x4edd6e(0x258)]['id'],_0x4edd6e(0x20d))['catch'](_0x4297b4=>{telegramError(_0x4297b4);}));if(!settings['telegramChatId'])tgBot[_0x4edd6e(0x21f)](_0x27e353[_0x4edd6e(0x258)]['id'],_0x4edd6e(0x204))[_0x4edd6e(0x206)](_0x57931f=>{telegramError(_0x57931f);});}),tgBot['removeListener'](_0x354768(0x198));});}),tgBot[_0x27fe39(0x193)](/\/status/,_0x551807=>{const _0x57021a=_0x27fe39;if(!validateTelegram(_0x551807))return;let _0x42489d=_0x57021a(0x160);config[_0x57021a(0x24a)](_0x4e2e72=>{const _0x20cf43=_0x57021a;_0x42489d+=_0x20cf43(0x212)+_0x4e2e72[_0x20cf43(0x201)]+'\x20|\x20'+_0x4e2e72[_0x20cf43(0x21d)]+':\x20'+_0x4e2e72['status']+_0x20cf43(0x163)+_0x4e2e72[_0x20cf43(0x238)]+'\x0a';}),_0x42489d+='\x0a',_0x42489d+=_0x57021a(0x1fb),_0x42489d+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x57021a(0x20f),_0x42489d+=settings[_0x57021a(0x155)]?settings[_0x57021a(0x257)]==_0x57021a(0x20b)?_0x57021a(0x251):_0x57021a(0x1aa)+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0x57021a(0x21f)](_0x551807[_0x57021a(0x258)]['id'],_0x42489d,{'parse_mode':_0x57021a(0x13f)})[_0x57021a(0x206)](_0x486e8f=>{telegramError(_0x486e8f);});}),tgBot['onText'](/\/restart/,_0x47d776=>{const _0x164a8a=_0x27fe39;if(!validateTelegram(_0x47d776))return;tgBot[_0x164a8a(0x262)](_0x164a8a(0x198));const _0x187221=getEnabledBots();if(_0x187221[_0x164a8a(0x191)]==0x0)tgBot['sendMessage'](_0x47d776[_0x164a8a(0x258)]['id'],_0x164a8a(0x175))['catch'](_0x367fd8=>{telegramError(_0x367fd8);});else{if(_0x187221['length']>0x1)_0x187221[_0x164a8a(0x252)]({'botID':'all'});let _0xe862e1=[],_0x50f9f2=[];const _0x4afafb=_0x187221['length']%0x4==0x0||_0x187221['length']%0x4==0x3||_0x187221['length']%0x3==0x1?0x4:0x3;let _0x1505ae=0x0;_0x187221[_0x164a8a(0x24a)]((_0x322ee0,_0x28563a)=>{const _0x320acd=_0x164a8a;if(_0x28563a%_0x4afafb==0x0)_0x50f9f2=[];_0x50f9f2[_0x320acd(0x252)]({'text':_0x322ee0['botID']==_0x320acd(0x20b)?'All\x20bots':'Bot\x20'+_0x322ee0[_0x320acd(0x201)],'callback_data':_0x322ee0[_0x320acd(0x201)]}),_0x28563a%_0x4afafb==0x0&&(_0xe862e1[_0x1505ae]=_0x50f9f2,_0x1505ae++);}),tgBot[_0x164a8a(0x21f)](_0x47d776[_0x164a8a(0x258)]['id'],_0x164a8a(0x134),{'reply_markup':{'inline_keyboard':_0xe862e1}})[_0x164a8a(0x206)](_0x1e3c59=>{telegramError(_0x1e3c59);}),tgBot['on'](_0x164a8a(0x198),async _0x415733=>{const _0x44654e=_0x164a8a,_0x141e28=_0x415733['data'],_0x275034=_0x415733[_0x44654e(0x1ed)];tgBot['answerCallbackQuery'](_0x415733['id'])[_0x44654e(0x1d0)](async()=>{const _0x48370c=_0x44654e;if(_0x141e28==_0x48370c(0x20b)){if(settings[_0x48370c(0x257)]=='orders')tgBot[_0x48370c(0x21f)](_0x275034[_0x48370c(0x258)]['id'],_0x48370c(0x1dc))['catch'](_0x201326=>{telegramError(_0x201326);});config['forEach'](_0x5bae5f=>{const _0x7c8957=_0x48370c;stopBot(_0x5bae5f[_0x7c8957(0x201)]);});}else{if(settings[_0x48370c(0x257)]=='orders')tgBot[_0x48370c(0x21f)](_0x275034['chat']['id'],_0x48370c(0x16f)+_0x141e28)['catch'](_0x2d81c5=>{telegramError(_0x2d81c5);});stopBot(_0x141e28);}}),tgBot['removeListener'](_0x44654e(0x198));});}}),tgBot[_0x27fe39(0x193)](/\/on/,_0xd57ea4=>{const _0x126aee=_0x27fe39;if(!validateTelegram(_0xd57ea4))return;tgBot['removeListener']('callback_query');const _0x3f4228=getDisabledBots();if(_0x3f4228[_0x126aee(0x191)]==0x0)tgBot[_0x126aee(0x21f)](_0xd57ea4['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x126aee(0x206)](_0x3893af=>{telegramError(_0x3893af);});else{if(_0x3f4228[_0x126aee(0x191)]>0x1)_0x3f4228[_0x126aee(0x252)]({'botID':'all'});let _0x3b83ce=[],_0x224438=[];const _0x2156b3=_0x3f4228[_0x126aee(0x191)]%0x4==0x0||_0x3f4228[_0x126aee(0x191)]%0x4==0x3||_0x3f4228[_0x126aee(0x191)]%0x3==0x1?0x4:0x3;let _0x1046ea=0x0;_0x3f4228['forEach']((_0xa2862d,_0x28eb6d)=>{const _0x40e8e4=_0x126aee;if(_0x28eb6d%_0x2156b3==0x0)_0x224438=[];_0x224438['push']({'text':_0xa2862d[_0x40e8e4(0x201)]==_0x40e8e4(0x20b)?'All\x20bots':_0x40e8e4(0x212)+_0xa2862d[_0x40e8e4(0x201)],'callback_data':_0xa2862d[_0x40e8e4(0x201)]}),_0x28eb6d%_0x2156b3==0x0&&(_0x3b83ce[_0x1046ea]=_0x224438,_0x1046ea++);}),tgBot[_0x126aee(0x21f)](_0xd57ea4[_0x126aee(0x258)]['id'],_0x126aee(0x1b8),{'reply_markup':{'inline_keyboard':_0x3b83ce}})[_0x126aee(0x206)](_0x12a9a3=>{telegramError(_0x12a9a3);}),tgBot['on'](_0x126aee(0x198),async _0x29d520=>{const _0x32ef58=_0x126aee,_0x5bdfb7=_0x29d520[_0x32ef58(0x22b)],_0x2fd379=_0x29d520[_0x32ef58(0x1ed)];tgBot[_0x32ef58(0x216)](_0x29d520['id'])[_0x32ef58(0x1d0)](async()=>{const _0x24d6cc=_0x32ef58;if(_0x5bdfb7==_0x24d6cc(0x20b)){if(settings[_0x24d6cc(0x257)]==_0x24d6cc(0x16d))tgBot[_0x24d6cc(0x21f)](_0x2fd379[_0x24d6cc(0x258)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x24d6cc(0x206)](_0x53fb91=>{telegramError(_0x53fb91);});_0x3f4228[_0x24d6cc(0x24a)](_0x9f19cb=>{const _0x4900b4=_0x24d6cc;if(_0x9f19cb[_0x4900b4(0x201)]!='all')toggleBot(_0x9f19cb[_0x4900b4(0x201)],toggleStatus(_0x9f19cb[_0x4900b4(0x201)]),_0x4900b4(0x217));});}else{if(settings[_0x24d6cc(0x257)]==_0x24d6cc(0x16d))tgBot['sendMessage'](_0x2fd379[_0x24d6cc(0x258)]['id'],_0x24d6cc(0x19b)+_0x5bdfb7)['catch'](_0x4b5c25=>{telegramError(_0x4b5c25);});toggleBot(_0x5bdfb7,toggleStatus(_0x5bdfb7),_0x24d6cc(0x217));}}),tgBot[_0x32ef58(0x262)](_0x32ef58(0x198));});}}),tgBot[_0x27fe39(0x193)](/\/off/,_0x48c33a=>{const _0x370d20=_0x27fe39;if(!validateTelegram(_0x48c33a))return;tgBot[_0x370d20(0x262)](_0x370d20(0x198));const _0x6c346a=getEnabledBots();if(_0x6c346a[_0x370d20(0x191)]==0x0)tgBot[_0x370d20(0x21f)](_0x48c33a[_0x370d20(0x258)]['id'],_0x370d20(0x175))['catch'](_0x387a51=>{telegramError(_0x387a51);});else{if(_0x6c346a['length']>0x1)_0x6c346a[_0x370d20(0x252)]({'botID':_0x370d20(0x20b)});let _0x106f75=[],_0x491b6e=[];const _0x354e71=_0x6c346a['length']%0x4==0x0||_0x6c346a[_0x370d20(0x191)]%0x4==0x3||_0x6c346a['length']%0x3==0x1?0x4:0x3;let _0x12edca=0x0;_0x6c346a[_0x370d20(0x24a)]((_0x206ee0,_0x230bf9)=>{const _0x41734c=_0x370d20;if(_0x230bf9%_0x354e71==0x0)_0x491b6e=[];_0x491b6e[_0x41734c(0x252)]({'text':_0x206ee0[_0x41734c(0x201)]==_0x41734c(0x20b)?_0x41734c(0x18f):_0x41734c(0x212)+_0x206ee0['botID'],'callback_data':_0x206ee0[_0x41734c(0x201)]}),_0x230bf9%_0x354e71==0x0&&(_0x106f75[_0x12edca]=_0x491b6e,_0x12edca++);}),tgBot[_0x370d20(0x21f)](_0x48c33a[_0x370d20(0x258)]['id'],_0x370d20(0x14b),{'reply_markup':{'inline_keyboard':_0x106f75}})[_0x370d20(0x206)](_0x5b4566=>{telegramError(_0x5b4566);}),tgBot['on'](_0x370d20(0x198),async _0x14788c=>{const _0x1b0ab0=_0x370d20,_0x44c0d0=_0x14788c['data'],_0x1615e0=_0x14788c[_0x1b0ab0(0x1ed)];tgBot['answerCallbackQuery'](_0x14788c['id'])['then'](async()=>{const _0x5656f1=_0x1b0ab0;if(_0x44c0d0==_0x5656f1(0x20b)){if(settings[_0x5656f1(0x257)]==_0x5656f1(0x16d))tgBot[_0x5656f1(0x21f)](_0x1615e0[_0x5656f1(0x258)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x5656f1(0x206)](_0x6e4795=>{telegramError(_0x6e4795);});_0x6c346a['forEach'](_0x163f56=>{const _0x238dee=_0x5656f1;if(_0x163f56[_0x238dee(0x201)]!=_0x238dee(0x20b))toggleBot(_0x163f56['botID'],toggleStatus(_0x163f56['botID']),'stopped');});}else{if(settings[_0x5656f1(0x257)]=='orders')tgBot['sendMessage'](_0x1615e0[_0x5656f1(0x258)]['id'],_0x5656f1(0x14f)+_0x44c0d0)[_0x5656f1(0x206)](_0x41d45e=>{telegramError(_0x41d45e);});toggleBot(_0x44c0d0,toggleStatus(_0x44c0d0),_0x5656f1(0x217));}}),tgBot[_0x1b0ab0(0x262)](_0x1b0ab0(0x198));});}}),tgBot[_0x27fe39(0x193)](/\/disable/,_0x2013f3=>{const _0x344919=_0x27fe39;if(!validateTelegram(_0x2013f3))return;tgBot[_0x344919(0x21f)](_0x2013f3[_0x344919(0x258)]['id'],_0x344919(0x1f3))['catch'](_0x58a353=>{telegramError(_0x58a353);}),updateSetting(_0x344919(0x155),![]);}),tgBot[_0x27fe39(0x193)](/\/help/,_0x513d54=>{const _0x4eceb5=_0x27fe39;if(!validateTelegram(_0x513d54))return;tgBot['sendMessage'](_0x513d54[_0x4eceb5(0x258)]['id'],_0x5b57d5)[_0x4eceb5(0x206)](_0x1224aa=>{telegramError(_0x1224aa);});}),tgBot['on'](_0x27fe39(0x24f),_0x19b452=>{const _0x2b90b2=_0x27fe39;_0x19b452[_0x2b90b2(0x12a)]()[_0x2b90b2(0x151)](_0x2b90b2(0x227))&&(logging(_0x2b90b2(0x123)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')['emit'](_0x2b90b2(0x1c8),_0x2b90b2(0x123)));}),process[_0x27fe39(0x237)]('SIGINT',()=>{const _0x46d4d5=_0x27fe39;if(tgBot)tgBot[_0x46d4d5(0x1cd)]();process[_0x46d4d5(0x161)](0x1);}),process['once'](_0x27fe39(0x1bd),()=>{const _0x5d8031=_0x27fe39;if(tgBot)tgBot['stopPolling']();process[_0x5d8031(0x161)](0x1);});}}function disableTelegram(){const _0x293800=_0x448427;tgBot&&(tgBot[_0x293800(0x1cd)](),tgBot=null);}function sendTelegram(_0xb6a740,_0x10fc56){const _0x1b0ae5=_0x448427;if(settings[_0x1b0ae5(0x155)]){if(settings[_0x1b0ae5(0x257)]=='all'||(_0x10fc56[_0x1b0ae5(0x194)]==_0x1b0ae5(0x138)||_0x10fc56[_0x1b0ae5(0x194)]==_0x1b0ae5(0x1dd))&&settings[_0x1b0ae5(0x257)]==_0x1b0ae5(0x14e)||_0x10fc56[_0x1b0ae5(0x194)]==_0x1b0ae5(0x11b)&&settings[_0x1b0ae5(0x257)]==_0x1b0ae5(0x16d)){if(tgBot&&settings[_0x1b0ae5(0x1b3)]){if(_0x10fc56[_0x1b0ae5(0x21b)])tgBot['sendMessage'](settings[_0x1b0ae5(0x1b3)],_0x10fc56[_0x1b0ae5(0x21d)]+_0x1b0ae5(0x154)+_0x10fc56[_0x1b0ae5(0x1a1)])[_0x1b0ae5(0x206)](_0x2f6418=>{telegramError(_0x2f6418);});else tgBot[_0x1b0ae5(0x21f)](settings[_0x1b0ae5(0x1b3)],_0x1b0ae5(0x212)+_0xb6a740+_0x1b0ae5(0x154)+_0x10fc56[_0x1b0ae5(0x1a1)])[_0x1b0ae5(0x206)](_0x28ddd8=>{telegramError(_0x28ddd8);});}}}}function getDeviceWithIp(_0x2b7dcb){const _0x99bfc5=_0x448427;return devices[_0x99bfc5(0x179)](_0x4cac6d=>_0x4cac6d['ip']===_0x2b7dcb);}function temporaryAccess2FA(_0x299cda,_0x1ca136){const _0xd348fd=_0x448427;let _0x3e4640=new Date(),_0x349088=![];if(lastIpApproval){if(_0x3e4640-lastIpApproval<0x1388)_0x349088=!![];}lastIpApproval=new Date();if(_0x349088)return;tgBot&&settings[_0xd348fd(0x1b3)]&&(tgBot[_0xd348fd(0x262)](_0xd348fd(0x198)),tgBot[_0xd348fd(0x21f)](settings['telegramChatId'],_0xd348fd(0x125)+normalizeIP(_0x1ca136)[_0xd348fd(0x181)]+_0xd348fd(0x23a),{'parse_mode':_0xd348fd(0x13f),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0xd348fd(0x241),'callback_data':'15'},{'text':_0xd348fd(0x11d),'callback_data':'30'},{'text':_0xd348fd(0x247),'callback_data':_0xd348fd(0x247)}]]}})[_0xd348fd(0x206)](_0x107576=>{telegramError(_0x107576);}),tgBot['on'](_0xd348fd(0x198),async _0x65c205=>{const _0x3e4a53=_0xd348fd,_0x432c69=_0x65c205[_0x3e4a53(0x22b)],_0x475f70=_0x65c205[_0x3e4a53(0x1ed)];tgBot['answerCallbackQuery'](_0x65c205['id'])[_0x3e4a53(0x1d0)](async()=>{const _0x46d4d0=_0x3e4a53;devices[_0x299cda][_0x46d4d0(0x1f4)]={'clientip':_0x1ca136,'timestamp':new Date()[_0x46d4d0(0x18a)](),'expiry':_0x432c69},_0x432c69!='reject'?(await tgBot[_0x46d4d0(0x21f)](_0x475f70[_0x46d4d0(0x258)]['id'],_0x46d4d0(0x24c)+_0x432c69+'\x20minutes',{'parse_mode':_0x46d4d0(0x13f)})[_0x46d4d0(0x206)](_0x525550=>{telegramError(_0x525550);}),io['to'](_0x299cda)['emit']('status',{'access':{'allow':![],'reason':_0x46d4d0(0x21e),'token':null}})):(await tgBot[_0x46d4d0(0x21f)](_0x475f70[_0x46d4d0(0x258)]['id'],_0x46d4d0(0x1d3))[_0x46d4d0(0x206)](_0x38d4c6=>{telegramError(_0x38d4c6);}),io['to'](_0x299cda)['emit']('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x3e4a53(0x262)](_0x3e4a53(0x198));}));}function loginAccess2FA(_0x3b7319,_0x3686f8){const _0xe0dbf1=_0x448427;tgBot&&settings[_0xe0dbf1(0x1b3)]&&(tgBot['removeListener'](_0xe0dbf1(0x198)),tgBot[_0xe0dbf1(0x21f)](settings[_0xe0dbf1(0x1b3)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x3686f8)['show']+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0xe0dbf1(0x247),'callback_data':_0xe0dbf1(0x247)}]]}})['catch'](_0x1eac16=>{telegramError(_0x1eac16);}),tgBot['on'](_0xe0dbf1(0x198),async _0x44082f=>{const _0x57963a=_0xe0dbf1,_0x15c46e=_0x44082f[_0x57963a(0x22b)],_0x45b089=_0x44082f[_0x57963a(0x1ed)];tgBot[_0x57963a(0x216)](_0x44082f['id'])['then'](async()=>{const _0x28ecea=_0x57963a;devices[_0x3b7319][_0x28ecea(0x24e)]={'clientip':_0x3686f8,'timestamp':new Date()['getTime'](),'expiry':_0x15c46e},_0x15c46e!=_0x28ecea(0x247)?(await tgBot[_0x28ecea(0x21f)](_0x45b089[_0x28ecea(0x258)]['id'],_0x28ecea(0x1ff),{'parse_mode':_0x28ecea(0x13f)})[_0x28ecea(0x206)](_0x5e138d=>{telegramError(_0x5e138d);}),io['to'](_0x3b7319)[_0x28ecea(0x18b)]('status',{'access':{'allow':![],'reason':_0x28ecea(0x21e),'token':null}})):(await tgBot[_0x28ecea(0x21f)](_0x45b089[_0x28ecea(0x258)]['id'],'Login\x20rejected')[_0x28ecea(0x206)](_0x3cebd8=>{telegramError(_0x3cebd8);}),io['to'](_0x3b7319)[_0x28ecea(0x18b)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x57963a(0x262)](_0x57963a(0x198));}));}function getConfiguration(){const _0x3efa19=_0x448427;return dbConfig[_0x3efa19(0x21a)]('bots')[_0x3efa19(0x236)]('botID')[_0x3efa19(0x239)]()||[];}function getEnabledBots(){const _0xce7ad3=_0x448427;return dbConfig['get'](_0xce7ad3(0x126))[_0xce7ad3(0x236)](_0xce7ad3(0x201))['filter']({'status':_0xce7ad3(0x209)})[_0xce7ad3(0x239)]()||[];}function getDisabledBots(){const _0x6171de=_0x448427;return dbConfig[_0x6171de(0x21a)]('bots')[_0x6171de(0x236)](_0x6171de(0x201))[_0x6171de(0x263)]({'status':'disabled'})[_0x6171de(0x239)]()||[];}function getSettings(){const _0x1e2102=_0x448427;return dbSettings[_0x1e2102(0x21a)](_0x1e2102(0x250))[_0x1e2102(0x239)]()||{'timeshift':0x0};}function getSecure(){const _0x2ca15b=_0x448427;return dbSecure[_0x2ca15b(0x21a)](_0x2ca15b(0x188))[_0x2ca15b(0x239)]()||{};}function getBlacklist(){const _0x287dce=_0x448427;return dbSecure['get'](_0x287dce(0x1e4))[_0x287dce(0x239)]()||[];}function broadcastToBots(_0x3faf31,_0x5f7b2f){const _0x345e39=_0x448427;config[_0x345e39(0x24a)](_0x291095=>{const _0x45eb58=_0x345e39;if(_0x291095[_0x45eb58(0x184)]==_0x45eb58(0x209)&&_0x291095[_0x45eb58(0x238)]==_0x45eb58(0x137)){if(pid[_0x291095[_0x45eb58(0x201)]])pid[_0x291095[_0x45eb58(0x201)]][_0x45eb58(0x1fd)]({[_0x3faf31]:_0x5f7b2f});}});}function storeSettings(_0x2fdd9b,_0x56b2cf=![]){const _0x4e9695=_0x448427;_0x2fdd9b={...settings,..._0x2fdd9b};if(_0x56b2cf&&_0x2fdd9b[_0x4e9695(0x120)]!=_0x4e9695(0x178)&&_0x2fdd9b[_0x4e9695(0x120)]!=''){const _0x51d39f=crypt['decrypt'](secure[_0x4e9695(0x13b)],_0x2fdd9b[_0x4e9695(0x120)])[_0x4e9695(0x1ed)][_0x4e9695(0x117)]('@')[0x0],_0x3f20ee=bcrypt[_0x4e9695(0x1b2)](_0x51d39f,saltRounds);_0x2fdd9b={..._0x2fdd9b,'bbPassword':_0x3f20ee};}if(_0x56b2cf&&_0x2fdd9b[_0x4e9695(0x1cc)]!=_0x4e9695(0x178)&&_0x2fdd9b[_0x4e9695(0x1cc)]!=''){const _0x29cea8=crypt[_0x4e9695(0x20e)](secure[_0x4e9695(0x13b)],_0x2fdd9b[_0x4e9695(0x1cc)])['message']['split']('@')[0x0];_0x2fdd9b={..._0x2fdd9b,'telegramToken':_0x29cea8};}const _0x55bfb3=_0x2fdd9b[_0x4e9695(0x1cc)]!=_0x4e9695(0x178)&&_0x2fdd9b[_0x4e9695(0x1cc)]!=settings[_0x4e9695(0x1cc)]||_0x2fdd9b[_0x4e9695(0x205)]!=settings[_0x4e9695(0x205)],_0x4fb8be=_0x2fdd9b['telegramToken']==''||_0x2fdd9b['telegramUsername']=='';if(_0x55bfb3)_0x2fdd9b[_0x4e9695(0x257)]='all';for(const [_0x107e02,_0x320777]of Object[_0x4e9695(0x244)](_0x2fdd9b)){if(_0x107e02==_0x4e9695(0x1cc)&&_0x320777==_0x4e9695(0x178)){_0x2fdd9b[_0x4e9695(0x1cc)]=settings[_0x4e9695(0x1cc)];continue;};if(_0x107e02==_0x4e9695(0x120)&&_0x320777==_0x4e9695(0x178)){_0x2fdd9b[_0x4e9695(0x120)]=settings[_0x4e9695(0x120)];continue;};dbSettings[_0x4e9695(0x135)]('settings.'+_0x107e02,_0x320777)[_0x4e9695(0x183)]();}settings=_0x2fdd9b,io['to'](_0x4e9695(0x220))['emit']('settings',cleanSettings()),broadcastToBots(_0x4e9695(0x1c2),settings[_0x4e9695(0x1c2)]);if(_0x55bfb3&&!_0x4fb8be)initTelegram();if(_0x55bfb3&&_0x4fb8be)disableTelegram();getAllClients()[_0x4e9695(0x24a)](_0x2ea609=>{const _0x5f297a=_0x4e9695;getSocket(_0x2ea609['id'])[_0x5f297a(0x18b)](_0x5f297a(0x184),{'access':{'allow':![],'reason':_0x5f297a(0x21e),'token':null}});});}function updateSetting(_0x7f0dc1,_0x4d5aef){const _0x123594=_0x448427;dbSettings[_0x123594(0x135)](_0x123594(0x1d7)+_0x7f0dc1,_0x4d5aef)[_0x123594(0x183)](),settings=getSettings(),io['to'](_0x123594(0x220))[_0x123594(0x18b)](_0x123594(0x250),cleanSettings());}function storeSecure(_0x10c0c2){const _0x30ef00=_0x448427;dbSecure[_0x30ef00(0x21a)](_0x30ef00(0x188))[_0x30ef00(0x252)](_0x10c0c2)[_0x30ef00(0x183)](),secure=_0x10c0c2;}function addBlacklist(_0x28b3a9){const _0x16a9b5=_0x448427;cleanBlacklist();let _0x53f766;devices[_0x28b3a9]['telegramIpApproval']?_0x53f766=Math[_0x16a9b5(0x187)](devices[_0x28b3a9][_0x16a9b5(0x1f4)][_0x16a9b5(0x234)],loginExpiry):_0x53f766=loginExpiry,dbSecure[_0x16a9b5(0x21a)](_0x16a9b5(0x1e4))[_0x16a9b5(0x252)]({'expiry':new Date()['getTime']()+_0x53f766*0x3c*0x3e8,'token':devices[_0x28b3a9][_0x16a9b5(0x1ec)]['token']})[_0x16a9b5(0x183)](),blacklist=dbSecure[_0x16a9b5(0x21a)](_0x16a9b5(0x1e4))[_0x16a9b5(0x239)]();}function cleanBlacklist(){const _0x848771=_0x448427;let _0x4a7dd2=dbSecure[_0x848771(0x21a)]('blacklist')[_0x848771(0x1c6)]()[_0x848771(0x239)](),_0x1cbd06=new Date()['getTime']();_0x4a7dd2[_0x848771(0x24a)](_0x28858f=>{const _0x5be0f1=_0x848771;_0x28858f['expiry']<_0x1cbd06&&dbSecure[_0x5be0f1(0x21a)](_0x5be0f1(0x1e4))[_0x5be0f1(0x23c)]({'expiry':_0x28858f['expiry']})[_0x5be0f1(0x183)]();});}function initStates(){const _0x49d3f1=_0x448427;let _0x224816=getConfiguration();_0x224816[_0x49d3f1(0x24a)](_0x2c8e49=>{const _0x124281=_0x49d3f1;_0x2c8e49['live']=_0x124281(0x217);}),storeConfiguration(_0x224816);}function onKeys(){const _0x125f6d=new RSA();return new Promise(_0x2c44bd=>{const _0x128114=_0x1ad1;_0x125f6d['generateKeyPairAsync']()[_0x128114(0x1d0)](_0x5bd434=>{_0x2c44bd(_0x5bd434);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4ff7e7=_0x448427;let _0x350943=getConfiguration(),_0x6af084=![];_0x350943[_0x4ff7e7(0x24a)](_0xbeee3c=>{const _0x515923=_0x4ff7e7;if(_0xbeee3c[_0x515923(0x184)]==_0x515923(0x137))_0xbeee3c[_0x515923(0x184)]=_0x515923(0x209),_0x6af084=!![];else _0xbeee3c[_0x515923(0x184)]==_0x515923(0x217)&&(_0xbeee3c[_0x515923(0x184)]=_0x515923(0x1c1),_0x6af084=!![]);});if(_0x6af084)storeConfiguration(_0x350943);let _0x4c1914=getSecure();if(!_0x4c1914[_0x4ff7e7(0x25a)](_0x4ff7e7(0x190))){let _0x3fa5a6=await generateKeys();_0x4c1914[_0x4ff7e7(0x1c7)]=_0x3fa5a6[_0x4ff7e7(0x1c7)],_0x4c1914[_0x4ff7e7(0x13b)]=_0x3fa5a6[_0x4ff7e7(0x13b)],_0x4c1914[_0x4ff7e7(0x190)]=crypto[_0x4ff7e7(0x25d)](0x20)[_0x4ff7e7(0x12a)](_0x4ff7e7(0x148));;storeSecure(_0x4c1914);}let _0x360e5c=getSettings();_0x6af084=![];!_0x360e5c[_0x4ff7e7(0x25a)](_0x4ff7e7(0x12f))&&(_0x360e5c[_0x4ff7e7(0x12f)]=![],_0x360e5c['bbUsername']='',_0x360e5c[_0x4ff7e7(0x120)]='',_0x360e5c[_0x4ff7e7(0x171)]=![],_0x6af084=!![]);!_0x360e5c[_0x4ff7e7(0x25a)](_0x4ff7e7(0x21c))&&(_0x360e5c['whitelistEnabled']=![],_0x360e5c['whitelist']=[],_0x360e5c[_0x4ff7e7(0x1fa)]=![],_0x6af084=!![]);if(!_0x360e5c['hasOwnProperty']('telegramEnabled')){if(_0x360e5c[_0x4ff7e7(0x1b3)])_0x360e5c[_0x4ff7e7(0x155)]=!![];else _0x360e5c[_0x4ff7e7(0x155)]=![];_0x6af084=!![];}if(_0x6af084)storeSettings(_0x360e5c);}function storeConfiguration(_0x32d19d){const _0x4b2933=_0x448427;dbConfig['get']('bots')[_0x4b2933(0x23c)]()['write'](),dbConfig['get'](_0x4b2933(0x126))['push'](..._0x32d19d)[_0x4b2933(0x183)](),config=_0x32d19d;}function resetPassword(){const _0x54809a=_0x448427;tgBot&&settings[_0x54809a(0x1b3)]&&(tgBot[_0x54809a(0x262)]('callback_query'),tgBot[_0x54809a(0x21f)](settings[_0x54809a(0x1b3)],_0x54809a(0x186),{'parse_mode':_0x54809a(0x13f),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x54809a(0x167)},{'text':'no','callback_data':'no'}]]}})[_0x54809a(0x206)](_0x33445a=>{telegramError(_0x33445a);}),tgBot['on'](_0x54809a(0x198),async _0x3c5db9=>{const _0x2383dc=_0x54809a,_0x31aa68=_0x3c5db9[_0x2383dc(0x22b)],_0x55b3db=_0x3c5db9[_0x2383dc(0x1ed)];tgBot[_0x2383dc(0x216)](_0x3c5db9['id'])['then'](async()=>{const _0x247e2c=_0x2383dc;if(_0x31aa68!='no'){const _0x55d2e6=0xf,_0x34849b=_0x247e2c(0x122),_0x293d73=Array[_0x247e2c(0x19a)](crypto[_0x247e2c(0x232)](new Uint32Array(_0x55d2e6)))[_0x247e2c(0x17b)](_0x2377b8=>_0x34849b[_0x2377b8%_0x34849b[_0x247e2c(0x191)]])[_0x247e2c(0x249)](''),_0x1ba3df=bcrypt[_0x247e2c(0x1b2)](_0x293d73,saltRounds);storeSettings({'bbPassword':_0x1ba3df}),await tgBot[_0x247e2c(0x21f)](_0x55b3db['chat']['id'],_0x247e2c(0x1ef)+_0x293d73,{'parse_mode':_0x247e2c(0x13f)})[_0x247e2c(0x206)](_0x18b8f6=>{telegramError(_0x18b8f6);});}else await tgBot[_0x247e2c(0x21f)](_0x55b3db[_0x247e2c(0x258)]['id'],'Password\x20reset\x20rejected')['catch'](_0x5ea193=>{telegramError(_0x5ea193);});}),tgBot[_0x2383dc(0x262)](_0x2383dc(0x198));}));}function logging(_0xbc41ee){const _0x4fecd4=_0x448427;console[_0x4fecd4(0x20a)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0xbc41ee);if(tgBot&&settings[_0x4fecd4(0x1b3)]&&settings[_0x4fecd4(0x257)]!=_0x4fecd4(0x16d))tgBot[_0x4fecd4(0x21f)](settings[_0x4fecd4(0x1b3)],_0x4fecd4(0x218)+_0xbc41ee)[_0x4fecd4(0x206)](_0x14c8bd=>{telegramError(_0x14c8bd);});}function _0x1ad1(_0x26475f,_0xdd78f0){const _0x1144e6=_0xab81();return _0x1ad1=function(_0x515861,_0xf597b7){_0x515861=_0x515861-0x117;let _0xab81a9=_0x1144e6[_0x515861];return _0xab81a9;},_0x1ad1(_0x26475f,_0xdd78f0);}function getServerTime(){const _0xe2562b=_0x448427,_0x3f56fa=new Date();return _0x3f56fa[_0xe2562b(0x19e)]()+'/'+(_0x3f56fa[_0xe2562b(0x139)]()+0x1)[_0xe2562b(0x12a)]()[_0xe2562b(0x22f)](0x2,'0')+'/'+_0x3f56fa[_0xe2562b(0x221)]()[_0xe2562b(0x12a)]()[_0xe2562b(0x22f)](0x2,'0')+'\x20'+_0x3f56fa[_0xe2562b(0x1f5)]()[_0xe2562b(0x12a)]()[_0xe2562b(0x22f)](0x2,'0')+':'+_0x3f56fa[_0xe2562b(0x15a)]()['toString']()[_0xe2562b(0x22f)](0x2,'0')+':'+_0x3f56fa['getSeconds']()[_0xe2562b(0x12a)]()[_0xe2562b(0x22f)](0x2,'0');}function getTimeStamp(){const _0x399a8=_0x448427,_0x49d340=shiftedTime();return _0x49d340[_0x399a8(0x19e)]()+'/'+(_0x49d340[_0x399a8(0x139)]()+0x1)[_0x399a8(0x12a)]()[_0x399a8(0x22f)](0x2,'0')+'/'+_0x49d340[_0x399a8(0x221)]()[_0x399a8(0x12a)]()[_0x399a8(0x22f)](0x2,'0')+'\x20'+_0x49d340[_0x399a8(0x1f5)]()[_0x399a8(0x12a)]()[_0x399a8(0x22f)](0x2,'0')+':'+_0x49d340[_0x399a8(0x15a)]()[_0x399a8(0x12a)]()[_0x399a8(0x22f)](0x2,'0')+':'+_0x49d340['getSeconds']()[_0x399a8(0x12a)]()[_0x399a8(0x22f)](0x2,'0');}function shiftedTime(){const _0x1d1aea=_0x448427,_0x4266c1=new Date();let _0x5cab4c=_0x4266c1;if(settings[_0x1d1aea(0x1c2)]&&settings['timeshift']!==0x0)_0x5cab4c=fns[_0x1d1aea(0x255)](_0x4266c1,{'hours':settings[_0x1d1aea(0x1c2)]});return _0x5cab4c;}function startScheduler(){let _0x1f74b7=new Date()['getUTCHours']();_0x1f74b7==0x1&&backupConfigFiles();_0x1f74b7==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x5f5374=_0x448427;fs[_0x5f5374(0x1de)](configpath,{'withFileTypes':!![]})['forEach'](_0x5dacc8=>{const _0x6a5430=_0x5f5374;if(!_0x5dacc8[_0x6a5430(0x165)]())fs[_0x6a5430(0x1af)](configpath+_0x5dacc8[_0x6a5430(0x141)],configbackuppath+_0x5dacc8[_0x6a5430(0x141)]);});}function triggerAnalytics(){const _0x4087fd=_0x448427;analytics['page']({'title':'Balance\x20Bot\x20Server','href':_0x4087fd(0x1fc),'path':'/v'+serverversion});}function validateCredentials(_0x3246f3,_0x59c396){const _0x3c91f1=_0x448427;if(_0x3246f3[_0x3c91f1(0x15f)]==settings[_0x3c91f1(0x19d)]&&bcrypt[_0x3c91f1(0x1bc)](_0x3246f3['password'],settings[_0x3c91f1(0x120)])){if(settings[_0x3c91f1(0x171)])return{'allow':![],'reason':_0x3c91f1(0x22d),'token':null};else{const _0x2a2f71=generateLoginToken(_0x59c396);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2a2f71};}}else return{'allow':![],'reason':_0x3c91f1(0x129),'token':null};}function refreshToken(_0x39d6aa){const _0x4a7cce=_0x448427,_0x57e230=generateLoginToken(_0x39d6aa);return{'allow':!![],'reason':_0x4a7cce(0x144),'token':_0x57e230};}function validateAccess(_0x188de7,_0x3fec1e){const _0x21b65b=_0x448427;let _0x3c4a31=devices[_0x3fec1e]['ip'],_0x3e81ca;const _0x25181f=_0x556d62=>{const _0x17021f=_0x1ad1;if(settings[_0x17021f(0x12f)]){if(settings[_0x17021f(0x171)]){if(telegram2FaApproved(_0x3fec1e)){const _0x129420=generateLoginToken(_0x3fec1e);return{'allow':!![],'reason':_0x17021f(0x130),'token':_0x129420};}else return{'allow':![],'reason':_0x17021f(0x1f6),'token':null};}else return _0x3e81ca=validToken(_0x556d62,_0x3fec1e),_0x3e81ca[_0x17021f(0x25a)](_0x17021f(0x1dd))?{'allow':!![],'reason':_0x17021f(0x173),'token':_0x556d62}:{'allow':![],'reason':_0x17021f(0x1f6),'token':null};}else return{'allow':!![],'reason':_0x17021f(0x1e9),'token':null};};if(settings['whitelistEnabled']){let _0x162c63=[...settings[_0x21b65b(0x17d)],_0x21b65b(0x1df),_0x21b65b(0x261),_0x21b65b(0x174)];if(_0x162c63[_0x21b65b(0x151)](_0x3c4a31))return _0x25181f(_0x188de7);else{_0x3e81ca=validToken(_0x188de7,_0x3fec1e);if(_0x3e81ca['hasOwnProperty'](_0x21b65b(0x1dd)))return _0x25181f(_0x188de7);else{if(telegramIpApproved(_0x3fec1e)){const _0x1a2e7b=generateToken(_0x3fec1e);return _0x3e81ca=_0x25181f(_0x188de7),_0x3e81ca['allow']?{'allow':!![],'reason':_0x21b65b(0x146),'token':_0x1a2e7b}:_0x3e81ca;}else return settings[_0x21b65b(0x1fa)]?{'allow':![],'reason':_0x21b65b(0x12e),'token':null}:{'allow':![],'reason':_0x21b65b(0x1ac),'token':null};}}}else return _0x25181f(_0x188de7);}function timelyDecrypt(_0x1fbead,_0x451e10=!![]){const _0x29f134=_0x448427;if(_0x1fbead)try{const _0x124045=crypt['decrypt'](secure[_0x29f134(0x13b)],_0x1fbead)[_0x29f134(0x1ed)],_0x1ec4f1=_0x124045[_0x29f134(0x117)]('@')[0x0],_0x19a096=_0x124045[_0x29f134(0x117)]('@')[0x1],_0x8524e5=new Date()[_0x29f134(0x18a)]();if(_0x451e10){if(_0x8524e5-_0x19a096<maxSecretAge*0x3e8)return _0x1ec4f1;else return![];}else return _0x1ec4f1;}catch(_0x42084b){return![];}else return![];}const validToken=(_0x2a7319,_0xc20870)=>{const _0x59d140=_0x448427,_0x2ccfc0=devices[_0xc20870]['ip'];if(!_0x2a7319)return{'error':_0x59d140(0x16e)};for(let _0x4476d3 of blacklist){if(_0x4476d3[_0x59d140(0x1ee)]==_0x2a7319)return{'error':'Token\x20blacklisted'};}let _0x314bec;try{_0x314bec=jwt[_0x59d140(0x16a)](_0x2a7319,secure[_0x59d140(0x190)]+_0xc20870);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x314bec[_0x59d140(0x25a)](_0x59d140(0x127))&&!_0x314bec[_0x59d140(0x25a)]('username')||!_0x314bec[_0x59d140(0x25a)](_0x59d140(0x1c9)))return{'error':_0x59d140(0x1ae)};if(!_0x314bec['hasOwnProperty'](_0x59d140(0x15f))&&_0x314bec['hasOwnProperty'](_0x59d140(0x127))){const {clientip:_0x573370}=_0x314bec;return _0x2ccfc0==_0x573370?{'success':_0x59d140(0x1e3)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x314bec[_0x59d140(0x25a)]('username')&&_0x314bec[_0x59d140(0x25a)](_0x59d140(0x127))){const {username:_0x3456ce,clientip:_0x3cfd20}=_0x314bec;return settings[_0x59d140(0x19d)]==_0x3456ce&&_0x2ccfc0==_0x3cfd20?{'success':_0x59d140(0x1e3)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x57a22e=>{const _0x351d3a=_0x448427;if(_0x57a22e){const _0x4a8e51=devices[_0x57a22e]['ip'];return jwt[_0x351d3a(0x242)]({'username':settings[_0x351d3a(0x19d)],'clientip':_0x4a8e51},secure[_0x351d3a(0x190)]+_0x57a22e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x55e5e4=>{const _0x5c417e=_0x448427;if(_0x55e5e4){const _0x17cbd7=devices[_0x55e5e4]['ip'];return jwt[_0x5c417e(0x242)]({'clientip':_0x17cbd7},secure[_0x5c417e(0x190)]+_0x55e5e4,{'expiresIn':devices[_0x55e5e4][_0x5c417e(0x1f4)][_0x5c417e(0x234)]*0x3c});}else return![];},telegramIpApproved=_0x17d54d=>{const _0x568963=_0x448427;let _0x503dba=![];return devices[_0x17d54d][_0x568963(0x1f4)]&&devices[_0x17d54d][_0x568963(0x1f4)][_0x568963(0x234)]!='reject'&&(_0x503dba=devices[_0x17d54d][_0x568963(0x1f4)][_0x568963(0x127)]==devices[_0x17d54d]['ip']&&new Date()[_0x568963(0x18a)]()-devices[_0x17d54d][_0x568963(0x1f4)][_0x568963(0x177)]<devices[_0x17d54d][_0x568963(0x1f4)][_0x568963(0x234)]*0x3c*0x3e8),_0x503dba;},telegram2FaApproved=_0x49cbf4=>{const _0x2eb34c=_0x448427;let _0x4ab0b9=![];return devices[_0x49cbf4][_0x2eb34c(0x24e)]&&devices[_0x49cbf4][_0x2eb34c(0x24e)][_0x2eb34c(0x234)]!=_0x2eb34c(0x247)&&(_0x4ab0b9=devices[_0x49cbf4][_0x2eb34c(0x24e)][_0x2eb34c(0x127)]==devices[_0x49cbf4]['ip']&&new Date()['getTime']()-devices[_0x49cbf4]['telegram2FaApproval'][_0x2eb34c(0x177)]<devices[_0x49cbf4][_0x2eb34c(0x24e)][_0x2eb34c(0x234)]*0x3c*0x3e8),_0x4ab0b9;},normalizeIP=_0x2d8739=>{const _0xbad9d1=_0x448427;let _0x5a10e3=null,_0xa763e3=null;if(ipaddr[_0xbad9d1(0x1b0)](_0x2d8739)){const _0x5d4e41=ipaddr['parse'](_0x2d8739);_0x5d4e41[_0xbad9d1(0x170)]()===_0xbad9d1(0x1a8)?(_0x5d4e41[_0xbad9d1(0x1eb)]()&&(_0x5a10e3=_0x5d4e41[_0xbad9d1(0x136)]()[_0xbad9d1(0x12a)]()),_0xa763e3=_0x5d4e41['toString']()):(_0x5a10e3=_0x5d4e41['toString'](),_0xa763e3=_0x5d4e41[_0xbad9d1(0x13d)]()[_0xbad9d1(0x12a)]());}return{'show':_0x5a10e3?_0x5a10e3:_0xa763e3,'store':_0xa763e3};};