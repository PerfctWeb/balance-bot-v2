const _0x3556f9=_0x4684;(function(_0x2a6b3e,_0x5ee981){const _0x4af0d8=_0x4684,_0x141c83=_0x2a6b3e();while(!![]){try{const _0x15b1e2=-parseInt(_0x4af0d8(0xc9))/0x1*(-parseInt(_0x4af0d8(0x121))/0x2)+parseInt(_0x4af0d8(0x12f))/0x3+parseInt(_0x4af0d8(0x164))/0x4*(parseInt(_0x4af0d8(0xff))/0x5)+-parseInt(_0x4af0d8(0x10c))/0x6*(-parseInt(_0x4af0d8(0x15d))/0x7)+-parseInt(_0x4af0d8(0x1f0))/0x8+parseInt(_0x4af0d8(0xb8))/0x9*(-parseInt(_0x4af0d8(0xe6))/0xa)+-parseInt(_0x4af0d8(0x166))/0xb*(parseInt(_0x4af0d8(0x1f4))/0xc);if(_0x15b1e2===_0x5ee981)break;else _0x141c83['push'](_0x141c83['shift']());}catch(_0xbccc78){_0x141c83['push'](_0x141c83['shift']());}}}(_0x17f6,0xb86a7));const _0x12b1e8=function(){let _0x2cfef7=!![];return function(_0x16f98f,_0x332e49){const _0x299744=_0x2cfef7?function(){const _0x1bbe25=_0x4684;if(_0x332e49){const _0x562e95=_0x332e49[_0x1bbe25(0xc5)](_0x16f98f,arguments);return _0x332e49=null,_0x562e95;}}:function(){};return _0x2cfef7=![],_0x299744;};}(),_0x10a8a1=_0x12b1e8(this,function(){const _0x54adfd=_0x4684;return _0x10a8a1['toString']()[_0x54adfd(0xf8)](_0x54adfd(0xfe))[_0x54adfd(0x136)]()[_0x54adfd(0x1e7)](_0x10a8a1)['search'](_0x54adfd(0xfe));});_0x10a8a1();'use strict';process[_0x3556f9(0x10b)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3556f9(0xa6)),FileSync=require(_0x3556f9(0x106)),fs=require('fs'),fns=require(_0x3556f9(0x1de)),low=require('lowdb'),path=require(_0x3556f9(0x152)),crypto=require(_0x3556f9(0xf3)),Crypt=require(_0x3556f9(0x19f))['Crypt'],RSA=require(_0x3556f9(0x19f))[_0x3556f9(0x162)],bcrypt=require(_0x3556f9(0x139)),jwt=require(_0x3556f9(0xea)),analyticsLib=require('analytics')['default'],googleAnalytics=require(_0x3556f9(0x13e))['default'],ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process['argv'][_0x3556f9(0xdd)](0x2))[_0x3556f9(0x1b0)],PORT=argv[_0x3556f9(0x103)]||_0x3556f9(0x11f),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x3556f9(0x1a5)](PORT))return console[_0x3556f9(0x13f)](_0x3556f9(0x198)+PORT+_0x3556f9(0x1be)),process[_0x3556f9(0x135)](0x1);const HOST=argv[_0x3556f9(0x14e)]||null,userID=argv[_0x3556f9(0x13b)]||'';let bbpath=_0x3556f9(0x14c),bbpath2='';const botfile=_0x3556f9(0x151),configfile=_0x3556f9(0x1a3),settingsfile='bb-settings.json',securefile='bb-secure.json';!fs[_0x3556f9(0x153)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3556f9(0x138)),configpath=userID?bbpath+_0x3556f9(0x1e8)+userID+'/':bbpath+_0x3556f9(0x1e8),configbackuppath=configpath+_0x3556f9(0x17a);!fs[_0x3556f9(0x153)](configpath)&&fs[_0x3556f9(0x1d2)](configpath);!fs[_0x3556f9(0x153)](configbackuppath)&&fs[_0x3556f9(0x1d2)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3556f9(0x177)]({'bots':[]})[_0x3556f9(0x15a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3556f9(0x177)]({'settings':{'timeshift':0x0}})[_0x3556f9(0x15a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3556f9(0x177)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3556f9(0x1e9),'rsaStandard':_0x3556f9(0x15e)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x3556f9(0x15b)),app=express(),http=require('http')[_0x3556f9(0x175)](app);app[_0x3556f9(0xe1)](express[_0x3556f9(0x12c)](path[_0x3556f9(0x18f)](__dirname,bbpath2,_0x3556f9(0x183)))),app['use'](express[_0x3556f9(0x12c)](path['join'](__dirname,bbpath2,_0x3556f9(0x192)))),app['get']('/',function(_0x1b9e49,_0x6bcb7f){const _0x232e6b=_0x3556f9;_0x6bcb7f['sendFile'](path[_0x232e6b(0x18f)](__dirname,bbpath2,'build2',_0x232e6b(0x1bd)));}),app[_0x3556f9(0x1e0)](_0x3556f9(0x149),function(_0x3a6f7b,_0x3e1caf){const _0x212708=_0x3556f9;_0x3e1caf[_0x212708(0x194)](path[_0x212708(0x18f)](__dirname,bbpath2,_0x212708(0x192),_0x212708(0x1bd)));}),app[_0x3556f9(0x1e0)](_0x3556f9(0x12d),(_0x44632a,_0x4650c2)=>{const _0x375fa5=_0x3556f9;_0x4650c2[_0x375fa5(0x194)](path[_0x375fa5(0x18f)](__dirname,bbpath2,'build',_0x375fa5(0x1bd)));}),app['get'](_0x3556f9(0x1a4),(_0x25b722,_0x408a3b)=>{const _0xa6d6b0=_0x3556f9;_0x408a3b[_0xa6d6b0(0x194)](path[_0xa6d6b0(0x18f)](__dirname,bbpath2,'build',_0xa6d6b0(0x1bd)));}),app[_0x3556f9(0x1e0)](_0x3556f9(0x144),(_0xe691f7,_0x2119bb)=>{const _0x35bdb4=_0x3556f9;_0x2119bb[_0x35bdb4(0x194)](path[_0x35bdb4(0x18f)](__dirname,bbpath2,_0x35bdb4(0x192),'index.html'));}),app['get'](_0x3556f9(0x13a),(_0x204a0e,_0x355cfa)=>{const _0x292418=_0x3556f9;_0x355cfa[_0x292418(0x194)](path[_0x292418(0x18f)](__dirname,bbpath2,'build',_0x292418(0x1bd)));}),app['get'](_0x3556f9(0x1a6),(_0x54d8ac,_0x4fd8ab)=>{const _0x164254=_0x3556f9;_0x4fd8ab[_0x164254(0x194)](path[_0x164254(0x18f)](__dirname,bbpath2,_0x164254(0x192),'index.html'));}),app[_0x3556f9(0x1e0)](_0x3556f9(0x1ab),(_0x476e45,_0x338368)=>{const _0x32e2de=_0x3556f9;_0x338368['sendFile'](path['join'](__dirname,bbpath2,'build',_0x32e2de(0x1bd)));});if(HOST)http['listen'](PORT,HOST);else http[_0x3556f9(0xf0)](PORT);const io=require(_0x3556f9(0xc1))(http,{}),analytics=analyticsLib({'app':_0x3556f9(0x129),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x3556f9(0xd5));let tgBot;if(settings[_0x3556f9(0x122)]&&settings[_0x3556f9(0x122)]!=''&&settings['telegramUsername']&&settings[_0x3556f9(0x110)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x1945cb=_0x3556f9;console['log'](''),console['log'](_0x1945cb(0x104)),logging(_0x1945cb(0x17c)+PORT),console[_0x1945cb(0x13f)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)config[_0x1945cb(0x147)](_0x3b144a=>{const _0x285cb9=_0x1945cb;if(_0x3b144a[_0x285cb9(0x1bc)]==_0x285cb9(0x12a)||_0x3b144a['status']=='new')logging(_0x285cb9(0xef)+_0x3b144a['botID']+_0x285cb9(0x18d)+_0x3b144a[_0x285cb9(0x19a)]),startBot([_0x3b144a[_0x285cb9(0x156)],userID],{'cwd':bbpath},function(_0x3afd21){if(_0x3afd21)logging(_0x3afd21);});else(_0x3b144a['status']==_0x285cb9(0x1c8)||_0x3b144a[_0x285cb9(0x1bc)]==_0x285cb9(0x1c4))&&logging(_0x285cb9(0xb0)+_0x3b144a[_0x285cb9(0x156)]+_0x285cb9(0x18d)+_0x3b144a[_0x285cb9(0x19a)]);});else!newBot&&console[_0x1945cb(0x13f)](_0x1945cb(0x132));if(newBot)addBot();console['log']('-----------------------------------------------------------------------------------'),console['log']('');}function startSocket(){const _0x2bffc1=_0x3556f9;io['on'](_0x2bffc1(0x11e),_0x5f1c0a=>{const _0x59e4d3=_0x2bffc1;let _0x5b706c,_0x1498b7,_0x35e28c,_0x340c06,_0x2cfbe1;const _0x812cf9=_0x5f1c0a[_0x59e4d3(0x1e1)]['headers'][_0x59e4d3(0x17b)];_0x1498b7=_0x812cf9['match'](/bot[0-9]{3}/);if(_0x1498b7)_0x35e28c=_0x1498b7[0x0][_0x59e4d3(0x148)](/[0-9]{3}/);if(_0x35e28c)_0x5b706c=_0x35e28c[0x0];else _0x5b706c=_0x59e4d3(0x1a8);const _0x429b83=_0x5f1c0a[_0x59e4d3(0x1e1)][_0x59e4d3(0x1dd)][_0x59e4d3(0xcb)];if(!_0x429b83)_0x5f1c0a[_0x59e4d3(0x1a7)](_0x59e4d3(0x1bc),{'publicKey':secure[_0x59e4d3(0x180)]});else{_0x340c06=timelyDecrypt(_0x429b83,![]);if(!_0x340c06)_0x5f1c0a[_0x59e4d3(0x1a7)](_0x59e4d3(0x1bc),{'publicKey':secure['publicKey']});else{_0x2cfbe1=normalizeIP(_0x5f1c0a['conn'][_0x59e4d3(0x112)])[_0x59e4d3(0x134)];if(!devices[_0x340c06])devices[_0x340c06]={'uuid':_0x340c06,'access':{'token':null}};devices[_0x340c06]['ip']=_0x2cfbe1;const _0x150043=addClient(_0x5f1c0a['id'],_0x340c06,_0x5b706c);setAccess(_0x150043),_0x5f1c0a['on'](_0x59e4d3(0x1ed),_0x49805b=>{const _0x2ef08d=_0x59e4d3,_0x17ddc8=timelyDecrypt(_0x49805b[_0x2ef08d(0xcd)]);if(_0x17ddc8){_0x49805b={'username':_0x49805b[_0x2ef08d(0x169)],'password':_0x17ddc8},devices[_0x340c06][_0x2ef08d(0x1ef)]=validateCredentials(_0x49805b,_0x340c06);if(devices[_0x340c06][_0x2ef08d(0x1ef)][_0x2ef08d(0x11d)]==![]&&devices[_0x340c06][_0x2ef08d(0x1ef)][_0x2ef08d(0x1ad)]==_0x2ef08d(0x171))_0x5f1c0a[_0x2ef08d(0x1a7)]('status',{'access':devices[_0x340c06]['access']}),loginAccess2FA(_0x340c06,_0x2cfbe1);else{if(devices[_0x340c06][_0x2ef08d(0x1ef)][_0x2ef08d(0x11d)]==![]&&devices[_0x340c06][_0x2ef08d(0x1ef)][_0x2ef08d(0x1ad)]==_0x2ef08d(0x120))_0x5f1c0a['emit'](_0x2ef08d(0x1bc),{'access':devices[_0x340c06]['access']});else devices[_0x340c06][_0x2ef08d(0x1ef)][_0x2ef08d(0x11d)]&&devices[_0x340c06][_0x2ef08d(0x1ef)][_0x2ef08d(0x1ad)]==_0x2ef08d(0xa7)&&(getClientsWithUuid(_0x340c06)[_0x2ef08d(0x147)](_0xae956b=>{setAccess(_0xae956b);}),setTokenRefresh(_0x340c06),setSessionTimeout(_0x2ef08d(0x1ed),_0x340c06));}}else logging(_0x2ef08d(0x1b2));}),_0x5f1c0a['on'](_0x59e4d3(0x10f),()=>{resetPassword();}),_0x5f1c0a['on'](_0x59e4d3(0x1ac),_0x5c47de=>{removeClient(_0x5f1c0a['id']);});}}});}function initClient(_0x3b72c4){const _0x2b2db5=_0x3556f9;if(_0x3b72c4!='botmanager'&&config[_0x2b2db5(0x1e6)]!=''){if(pid[_0x3b72c4])pid[_0x3b72c4]['send']({'function':_0x2b2db5(0xfd),'args':null});}}function getSocket(_0x45227e){const _0x127f9c=_0x3556f9;return io[_0x127f9c(0xcf)][_0x127f9c(0xcf)][_0x127f9c(0x1e0)](_0x45227e);}function _0x17f6(){const _0x16c4ed=['https://hodlerhacks.com','@analytics/google-analytics','log','accept','readdirSync','-results.json','pidRefreshToken','/:bot/coins','success','No\x20bots\x20running\x20right\x20now','forEach','match','/:bot','enabled\x20Bot\x20','name','bb/','error\x20while\x20deleting\x20config\x20files:\x20','host','clientip','1000','bot.js','path','existsSync','::ffff:127.0.0.1','login\x20required','botID','<b>Balance\x20Bot\x20status:</b>\x0a','get-logs','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','write','express','-events.json','21xMAGWn','RSA-OAEP','cancel-loading','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','onText','RSA','Alerts','92Ysvqfs','yes','603691XteGyo','15\x20min','assign','username','storeConfiguration','logout','bbUsername','Invalid\x20IP\x20address','cancelLoading','Ok,\x20will\x20send\x20alert\x20notifications\x20only','exp','2FA\x20login\x20required','page','stopPolling','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','createServer','settings','defaults','push','Ok,\x20will\x20send\x20order\x20notifications\x20only','backup/','referer','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20settings','Notifications\x20enabled','publicKey','telegramEvents','Invalid\x20authentication\x20token\x20(1)','build2','</b>\x20?','hex','isDirectory','You\x20can\x20use\x20the\x20following\x20commands:\x0a','temporary\x20access\x20not\x20allowed','\x20minutes','Bot\x20','timeshift','getFullYear','\x20|\x20','event','join','removeListener','telegram','build','function','sendFile','error','add-bot','alerts','Error:\x20Invalid\x20argument\x20','getTime','botname','from','cloneDeep','restarting\x20Bot\x20','bot-','hybrid-crypto-js','connected','running','blacklist','bb-config.json','/:bot/performance','test','/:bot/configuration','emit','botmanager','store-headless','args','/:bot/support','disconnect','reason','reject','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','argv','answerCallbackQuery','Unauthorized\x20login\x20attempt\x20(timeout)','telegramEnabled','emitHistory','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','bot','callback_query','Temporary\x20access\x20rejected','timestamp','getSeconds','All\x20bots\x20running\x20right\x20now','status','index.html',',\x20must\x20be\x20a\x204\x20digit\x20number','place-order','all','Bot\x20Mgr\x20>\x20','set','map','new-disabled','kind','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','data','disabled','temporary\x20token\x20generated','login\x20not\x20required','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','reload','catch','fork','getMinutes','Notifications\x20enabled\x0a','once','mkdirSync','Login\x20accepted','ipc','whitelistEnabled','privateKey','Unauthorized\x20attempt\x20to\x20add\x20bot','store-settings','store-configuration','User\x20has\x20been\x20validated','secret','token','auth','date-fns','\x20>\x20','get','handshake','/help\x20-\x20show\x20available\x20commands\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getMonth','apiKey','constructor','config/','sha256','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','getPortfolio','Notifications\x20disabled\x0a','login','Invalid\x20authentication\x20token\x20(2)','access','5181456ALFfVr','bots','chat','stop','48WwcZLN','child_process','login\x20token\x20generated','split','ipv6','get-starting-balances','Allow\x20login\x20from\x20IP\x20address\x20<b>','f2aRequired','Invalid\x20Telegram\x20token','stopped','padStart','idling\x20bot\x20\x20\x20|\x20Bot\x20','toIPv4MappedAddress','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Notifications\x20types:\x20','Token\x20blacklisted','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','show','polling_error','12613437BoeThq','uuid','copyFileSync','restart','telegramChatId','whitelist','orders','All\x20bots','update-bot','socket.io','live','loginRequired','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','apply','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20log\x20out','All','73YjXqUp','secure','encryptedUuid','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','password','127.0.0.1','sockets','new','HTML','includes','get-portfolio','send','node-telegram-bot-api','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','temporaryAccessAllowed','Password\x20reset\x20rejected','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','logged\x20out','/disable\x20-\x20disable\x20notifications\x0a','compareSync','slice','randomBytes','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','5\x20min','use','entries','filter','2FA','sortBy','10MdcqKf','404\x20Not\x20Found','value','sendMessage','jsonwebtoken',':\x20Bot\x20Mgr\x20>\x20','keys','<b>Telegram\x20bot\x20status:</b>\x0a','length','starting\x20bot\x20|\x20Bot\x20','listen','find','Unauthorized\x20attempt\x20to\x20get\x20portfolio','crypto','/restart\x20-\x20restart\x20bot(s)\x0a','2FA\x20login\x20token\x20generated','kill','parse','search','notification','bbPassword','No\x20authentication\x20token','type','initclient','(((.+)+)+)+$','147670zdDYWE','login\x20token\x20valid','pidExpireLogin','SIGINT','port','-----------------------------------------------------------------------------------','message','lowdb/adapters/FileSync','decrypt','telegramIpApproval','then','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','env','63516JegRwS','Password\x20has\x20been\x20reset\x20to:\x20','SIGTERM','reset-password','telegramUsername','2FA\x20required','remoteAddress','remove','hasOwnProperty','unlinkSync','randomFillSync','hashSync','sign','settings.','storeHeadless','Unauthorized\x20attempt\x20to\x20get\x20logs','getStartingBalances','allow','connection','3000','invalid\x20credentials','38614MMEobn','telegramToken','disabled\x20Bot\x20','showname','temporary\x20access\x20rejected','expiry','getHours','delete-bot','Balance\x20Bot','enabled','30\x20min','static','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20delete\x20bot','2710845QoveYO','************','telegram2FaApproval','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getDate','store','exit','toString','started','clients','bcryptjs','/:bot/history','user','inherit'];_0x17f6=function(){return _0x16c4ed;};return _0x17f6();}function setAccess(_0x8274d0){const _0x1b65ca=_0x3556f9,_0x986463=getSocket(_0x8274d0['id']),_0x4e5fec=_0x8274d0[_0x1b65ca(0xb9)],_0x506c8b=_0x8274d0['bot'];devices[_0x4e5fec]['access']=validateAccess(devices[_0x4e5fec][_0x1b65ca(0x1ef)]['token'],_0x4e5fec),_0x986463[_0x1b65ca(0x18f)](_0x4e5fec);if(devices[_0x4e5fec][_0x1b65ca(0x1ef)][_0x1b65ca(0x11d)]){_0x986463[_0x1b65ca(0x18f)](_0x506c8b);if(_0x506c8b==_0x1b65ca(0x1a8))initializeSocketBotManager(_0x986463);else initializeSocketBot(_0x986463);initClient(_0x506c8b);}devices[_0x4e5fec][_0x1b65ca(0x1ef)]['token']&&devices[_0x4e5fec]['access']['reason']==_0x1b65ca(0x1c9)&&setSessionTimeout(_0x1b65ca(0xe4),_0x4e5fec),devices[_0x4e5fec][_0x1b65ca(0x1ef)][_0x1b65ca(0x1dc)]&&devices[_0x4e5fec][_0x1b65ca(0x1ef)][_0x1b65ca(0x1ad)]==_0x1b65ca(0xf5)&&setSessionTimeout(_0x1b65ca(0x1ed),_0x4e5fec),_0x986463[_0x1b65ca(0x1a7)](_0x1b65ca(0x1bc),{'status':_0x8274d0['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4e5fec][_0x1b65ca(0x1ef)],'externalip':devices[_0x4e5fec]['ip'],'publicKey':secure[_0x1b65ca(0x180)]}),devices[_0x4e5fec][_0x1b65ca(0x1ef)][_0x1b65ca(0x11d)]==![]&&devices[_0x4e5fec][_0x1b65ca(0x1ef)]['reason']==_0x1b65ca(0x111)&&temporaryAccess2FA(_0x4e5fec,devices[_0x4e5fec]['ip']);}function setSessionTimeout(_0x1f50f9,_0x387fb4){const _0x263fd1=_0x3556f9;let _0x54520a;if(_0x1f50f9=='login')_0x54520a=loginExpiry*0x3c*0x3e8;else _0x54520a=devices[_0x387fb4][_0x263fd1(0x108)][_0x263fd1(0x126)]*0x3c*0x3e8-(new Date()[_0x263fd1(0x199)]()-devices[_0x387fb4][_0x263fd1(0x108)]['timestamp']);if(devices[_0x387fb4][_0x263fd1(0x101)])clearTimeout(devices[_0x387fb4][_0x263fd1(0x101)]);devices[_0x387fb4][_0x263fd1(0x101)]=setTimeout(()=>{const _0x30396a=_0x263fd1;if(devices[_0x387fb4]['pidRefreshToken'])clearTimeout(devices[_0x387fb4]['pidRefreshToken']);removeSocketListeners(_0x387fb4),addBlacklist(_0x387fb4),devices[_0x387fb4]['telegramIpApproval']=null,devices[_0x387fb4][_0x30396a(0x131)]=null,devices[_0x387fb4][_0x30396a(0x1ef)][_0x30396a(0x1dc)]=null,devices[_0x387fb4][_0x30396a(0x1ef)]=validateAccess(devices[_0x387fb4][_0x30396a(0x1ef)][_0x30396a(0x1dc)],_0x387fb4),!(devices[_0x387fb4]['access'][_0x30396a(0x11d)]&&devices[_0x387fb4][_0x30396a(0x1ef)][_0x30396a(0x1ad)]==_0x30396a(0x1ca))&&(_0x1f50f9==_0x30396a(0x1ed)?io['to'](_0x387fb4)[_0x30396a(0x1a7)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x387fb4)[_0x30396a(0x1a7)](_0x30396a(0x1bc),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x387fb4][_0x30396a(0x1ef)][_0x30396a(0x1dc)]=null;},_0x54520a);}function setTokenRefresh(_0x4ffeaa){const _0x3bb265=_0x3556f9;if(devices[_0x4ffeaa][_0x3bb265(0x143)])clearTimeout(devices[_0x4ffeaa][_0x3bb265(0x143)]);devices[_0x4ffeaa][_0x3bb265(0x143)]=setTimeout(()=>{const _0x466064=_0x3bb265;getClientsWithUuid(_0x4ffeaa)[_0x466064(0xee)]!=0x0?(devices[_0x4ffeaa][_0x466064(0x1ef)]=refreshToken(_0x4ffeaa),io['to'](_0x4ffeaa)['emit']('status',{'status':_0x466064(0x1a0),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4ffeaa][_0x466064(0x1ef)],'externalip':devices[_0x4ffeaa]['ip'],'publicKey':secure[_0x466064(0x180)]}),setTokenRefresh(_0x4ffeaa)):clearTimeout(devices[_0x4ffeaa][_0x466064(0x143)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1a1dd3){const _0x25f872=_0x3556f9,_0x198274=getClient(_0x1a1dd3['id'])[_0x25f872(0xb9)];_0x1a1dd3[_0x25f872(0x1a7)](_0x25f872(0x1f1),config),_0x1a1dd3[_0x25f872(0x1a7)]('settings',cleanSettings()),_0x1a1dd3['on'](_0x25f872(0x196),_0x1c09fb=>{const _0x220d8e=_0x25f872;if(validateAccess(_0x1c09fb,_0x198274)[_0x220d8e(0x11d)])addBot();else logging(_0x220d8e(0x1d7));}),_0x1a1dd3['on'](_0x25f872(0xc0),(_0x1cc3d5,_0x1e86dc)=>{const _0x6e88b3=_0x25f872;if(validateAccess(_0x1e86dc,_0x198274)[_0x6e88b3(0x11d)])toggleBot(_0x1cc3d5['botID'],_0x1cc3d5[_0x6e88b3(0x1bc)],_0x1cc3d5[_0x6e88b3(0xc2)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1a1dd3['on'](_0x25f872(0x128),(_0x71843b,_0x585e74)=>{const _0x7f8a3f=_0x25f872;if(validateAccess(_0x585e74,_0x198274)[_0x7f8a3f(0x11d)])deleteBot(_0x71843b);else logging(_0x7f8a3f(0x12e));}),_0x1a1dd3['on'](_0x25f872(0x1d8),(_0x5d1c6a,_0x3b7577)=>{const _0x9375ce=_0x25f872;if(validateAccess(_0x3b7577,_0x198274)[_0x9375ce(0x11d)])storeSettings(_0x5d1c6a,!![]);else logging(_0x9375ce(0x17e));}),_0x1a1dd3['on']('update-bb',(_0x1a5474,_0x3da42f)=>{const _0x2eb0ac=_0x25f872;if(validateAccess(_0x3da42f,_0x198274)[_0x2eb0ac(0x11d)])updateBB();else logging(_0x2eb0ac(0x17e));}),_0x1a1dd3['on'](_0x25f872(0x16b),_0x3c9c26=>{const _0x293632=_0x25f872;if(validateAccess(_0x3c9c26,_0x198274)['allow']){if(devices[_0x198274][_0x293632(0x143)])clearTimeout(devices[_0x198274][_0x293632(0x143)]);if(devices[_0x198274][_0x293632(0x101)])clearTimeout(devices[_0x198274][_0x293632(0x101)]);removeSocketListeners(getClient(_0x1a1dd3['id'])[_0x293632(0xb9)]),addBlacklist(_0x198274),devices[_0x198274][_0x293632(0x108)]=null,devices[_0x198274][_0x293632(0x131)]=null,devices[_0x198274][_0x293632(0x1ef)][_0x293632(0x1dc)]=null,io['to'](getClient(_0x1a1dd3['id'])[_0x293632(0xb9)])[_0x293632(0x1a7)]('status',{'access':{'allow':![],'reason':_0x293632(0xda),'token':null}});}else logging(_0x293632(0xc7));});}function initializeSocketBot(_0x5bdc04){const _0x1850e6=_0x3556f9,_0x555177=getClient(_0x5bdc04['id'])[_0x1850e6(0x1b6)],_0x26777f=getClient(_0x5bdc04['id'])[_0x1850e6(0xb9)];_0x5bdc04['on'](_0x1850e6(0x158),(_0x40859f,_0x110173)=>{const _0x58afe7=_0x1850e6;if(validateAccess(_0x110173,_0x26777f)[_0x58afe7(0x11d)]){if(pid[_0x555177])pid[_0x555177][_0x58afe7(0xd4)]({'function':_0x58afe7(0x1b4),'args':_0x40859f});}else logging(_0x58afe7(0x11b));}),_0x5bdc04['on'](_0x1850e6(0xd3),(_0x2f9360,_0x3e3072)=>{const _0x241cde=_0x1850e6;if(validateAccess(_0x3e3072,_0x26777f)[_0x241cde(0x11d)]){if(pid[_0x555177])pid[_0x555177][_0x241cde(0xd4)]({'function':_0x241cde(0x1eb),'args':_0x2f9360});}else logging(_0x241cde(0xf2));}),_0x5bdc04['on'](_0x1850e6(0x1d9),(_0x4c9834,_0x2076d7)=>{const _0x1509c1=_0x1850e6;if(validateAccess(_0x2076d7,_0x26777f)['allow']){if(pid[_0x555177])pid[_0x555177][_0x1509c1(0xd4)]({'function':_0x1509c1(0x16a),'args':_0x4c9834});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x5bdc04['on'](_0x1850e6(0x1a9),(_0x42f896,_0x39ef32)=>{const _0x4021e2=_0x1850e6;if(validateAccess(_0x39ef32,_0x26777f)[_0x4021e2(0x11d)]){if(pid[_0x555177])pid[_0x555177][_0x4021e2(0xd4)]({'function':_0x4021e2(0x11a),'args':_0x42f896});}else logging(_0x4021e2(0x1e4));}),_0x5bdc04['on'](_0x1850e6(0xaa),_0x10095e=>{const _0x558ad9=_0x1850e6;if(validateAccess(_0x10095e,_0x26777f)[_0x558ad9(0x11d)]){if(pid[_0x555177])pid[_0x555177][_0x558ad9(0xd4)]({'function':_0x558ad9(0x11c),'args':null});}else logging(_0x558ad9(0xc6));}),_0x5bdc04['on'](_0x1850e6(0x1bf),(_0x420c31,_0x12b8e1)=>{const _0x2b19fc=_0x1850e6;if(validateAccess(_0x12b8e1,_0x26777f)[_0x2b19fc(0x11d)]){if(pid[_0x555177])pid[_0x555177][_0x2b19fc(0xd4)]({'function':'placeOrder','args':_0x420c31});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5bdc04['on'](_0x1850e6(0x15f),_0x2e90a6=>{const _0x249e5b=_0x1850e6;if(validateAccess(_0x2e90a6,_0x26777f)[_0x249e5b(0x11d)]){if(pid[_0x555177])pid[_0x555177][_0x249e5b(0xd4)]({'function':_0x249e5b(0x16e),'args':null});}else logging(_0x249e5b(0x159));}),_0x5bdc04['on'](_0x1850e6(0x16b),_0x1db6e0=>{const _0x17014c=_0x1850e6;if(validateAccess(_0x1db6e0,_0x26777f)['allow']){if(devices[_0x26777f][_0x17014c(0x143)])clearTimeout(devices[_0x26777f][_0x17014c(0x143)]);if(devices[_0x26777f][_0x17014c(0x101)])clearTimeout(devices[_0x26777f][_0x17014c(0x101)]);removeSocketListeners(getClient(_0x5bdc04['id'])[_0x17014c(0xb9)]),addBlacklist(_0x26777f),devices[_0x26777f][_0x17014c(0x108)]=null,devices[_0x26777f][_0x17014c(0x131)]=null,devices[_0x26777f][_0x17014c(0x1ef)][_0x17014c(0x1dc)]=null,io['to'](getClient(_0x5bdc04['id'])[_0x17014c(0xb9)])[_0x17014c(0x1a7)]('status',{'access':{'allow':![],'reason':_0x17014c(0xda),'token':null}});}else logging(_0x17014c(0xc7));});}function removeSocketListeners(_0x4e083d){const _0x5a8924=_0x3556f9;getClientsWithUuid(_0x4e083d)[_0x5a8924(0x147)](_0x3e35ab=>{getSocket(_0x3e35ab['id'])['removeAllListeners']();});}function cleanSettings(){const _0x633228=_0x3556f9;let _0x426452=settings;return settings['telegramToken']&&settings[_0x633228(0x122)]!=''&&(_0x426452={..._0x426452,'telegramToken':_0x633228(0x130)}),settings[_0x633228(0xfa)]&&settings[_0x633228(0xfa)]!=''&&(_0x426452={..._0x426452,'bbPassword':'************'}),_0x426452;}function updateBB(){const _0x1c172b=_0x3556f9;installingUpdate=!![],config['forEach'](_0x1ca0d0=>{const _0x2903b7=_0x4684;restartBot(_0x1ca0d0[_0x2903b7(0x156)]);}),process[_0x1c172b(0xd4)]({'update':!![]},_0x549559=>{});}function startBot(_0x757ce1,_0xd0fbe1,_0x585574){const _0x35e465=_0x3556f9;let _0x4f76e6=![];const _0x133d79=_0x757ce1[0x0];_0xd0fbe1={..._0xd0fbe1,'stdio':[_0x35e465(0x13c),_0x35e465(0x13c),'inherit',_0x35e465(0x1d4)]},pid[_0x133d79]=childProcess[_0x35e465(0x1ce)](botfile,_0x757ce1,_0xd0fbe1),pid[_0x133d79]['on'](_0x35e465(0x105),_0x3cf52f=>{const _0x4aa583=_0x35e465;switch(Object[_0x4aa583(0xec)](_0x3cf52f)[0x0]){case _0x4aa583(0x19a):updateBotName(_0x133d79,_0x3cf52f[_0x4aa583(0x19a)]);break;case _0x4aa583(0x1bc):updateStatus(_0x133d79,_0x3cf52f[_0x4aa583(0x1bc)]);break;case'live':updateLive(_0x133d79,_0x3cf52f[_0x4aa583(0xc2)]);break;case _0x4aa583(0x137):updateLive(_0x133d79,_0x3cf52f['started']),io['to'](_0x133d79)[_0x4aa583(0x1a7)](_0x4aa583(0x1bc),{'access':{'allow':![],'reason':_0x4aa583(0x1cc),'token':null}});break;case'stop':_0x3cf52f[_0x4aa583(0x1f3)]==_0x4aa583(0xbb)&&restartBot(_0x133d79);_0x3cf52f[_0x4aa583(0x1f3)]==_0x4aa583(0xf6)&&toggleBot(_0x133d79,'disabled',_0x4aa583(0xae));break;case'telegram':sendTelegram(_0x133d79,_0x3cf52f[_0x4aa583(0x191)]);break;case _0x4aa583(0x193):io['to'](_0x133d79)[_0x4aa583(0x1a7)](_0x3cf52f[_0x4aa583(0x193)],_0x3cf52f[_0x4aa583(0x1aa)]);break;}}),pid[_0x133d79]['on'](_0x35e465(0x195),function(_0x666ab1){if(_0x4f76e6)return;_0x4f76e6=!![],_0x585574(_0x666ab1);}),pid[_0x133d79]['on'](_0x35e465(0x135),function(_0x2f05b1){const _0x1f7341=_0x35e465;if(installingUpdate)return;if(_0x4f76e6)return;_0x4f76e6=!![],_0x585574(null);const _0x586edf=dbConfig[_0x1f7341(0x1e0)](_0x1f7341(0x1f1))[_0x1f7341(0xf1)]({'botID':_0x133d79})[_0x1f7341(0xe8)]();_0x586edf&&(_0x586edf['status']==_0x1f7341(0x12a)||_0x586edf['status']==_0x1f7341(0xd0))&&(updateLive(_0x133d79,'stopped'),logging(_0x1f7341(0x19d)+_0x133d79),startBot([_0x133d79,userID],{'cwd':bbpath},function(_0x466356){if(_0x466356)logging(_0x466356);}));});}function stopBot(_0x335564){const _0x56ca28=_0x3556f9;getClientsWithBotID(_0x335564)[_0x56ca28(0x147)](_0x584341=>{getSocket(_0x584341['id'])['disconnect'](!![]),removeClient(_0x584341['id']);});if(pid[_0x335564])pid[_0x335564][_0x56ca28(0xf6)]();}function restartBot(_0x23154d){if(pid[_0x23154d])pid[_0x23154d]['kill']();}function addBot(){const _0x4b70c0=_0x3556f9;let _0x553e31;for(let _0x2b198e=0x1;_0x2b198e<0x3e9;_0x2b198e++){_0x553e31=_0x2b198e[_0x4b70c0(0x136)]()[_0x4b70c0(0xaf)](0x3,'0');let _0x632520=config['find'](_0x13a8c4=>_0x13a8c4[_0x4b70c0(0x156)]==_0x553e31);if(!_0x632520)break;}if(_0x553e31===_0x4b70c0(0x150)){logging(_0x4b70c0(0xb2));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x553e31),dbConfig[_0x4b70c0(0x1e0)](_0x4b70c0(0x1f1))['push']({'botID':_0x553e31,'botname':_0x4b70c0(0x18a)+_0x553e31,'status':'new','live':''})[_0x4b70c0(0x15a)](),startBot([_0x553e31,userID],{'cwd':bbpath},function(_0x1491a5){if(_0x1491a5)logging(_0x1491a5);}),config=getConfiguration(),io['to'](_0x4b70c0(0x1a8))[_0x4b70c0(0x1a7)](_0x4b70c0(0x1f1),config);}function deleteBot(_0x35734c){const _0x30872d=_0x3556f9;getClientsWithBotID(_0x35734c)['forEach'](_0x5c4537=>{getSocket(_0x5c4537['id'])['disconnect'](!![]),removeClient(_0x5c4537['id']);}),dbConfig[_0x30872d(0x1e0)]('bots')['remove']({'botID':_0x35734c})[_0x30872d(0x15a)](),logging('deleted\x20Bot\x20'+_0x35734c),stopBot(_0x35734c);try{fs[_0x30872d(0x115)](path[_0x30872d(0x18f)](configpath,'bot-'+_0x35734c+'-config.json')),fs[_0x30872d(0x115)](path['join'](configpath,_0x30872d(0x19e)+_0x35734c+_0x30872d(0x15c))),fs[_0x30872d(0x115)](path['join'](configpath,_0x30872d(0x19e)+_0x35734c+'-performance.json')),fs[_0x30872d(0x115)](path[_0x30872d(0x18f)](configpath,_0x30872d(0x19e)+_0x35734c+_0x30872d(0x142)));}catch(_0x161499){if(_0x161499)logging(_0x30872d(0x14d),_0x161499);}config=getConfiguration(),io['to'](_0x30872d(0x1a8))[_0x30872d(0x1a7)](_0x30872d(0x1f1),config);}function toggleBot(_0x24ea13,_0x5196c3,_0x2dc176){const _0x349375=_0x3556f9;dbConfig['get'](_0x349375(0x1f1))['find']({'botID':_0x24ea13})['assign']({'status':_0x5196c3})[_0x349375(0x168)]({'live':_0x2dc176})['write']();if(_0x5196c3==_0x349375(0x12a)||_0x5196c3==_0x349375(0xd0))logging(_0x349375(0x14a)+_0x24ea13),startBot([_0x24ea13,userID],{'cwd':bbpath},function(_0x598594){if(_0x598594)logging(_0x598594);});else(_0x5196c3=='disabled'||_0x5196c3==_0x349375(0x1c4))&&(logging(_0x349375(0x123)+_0x24ea13),stopBot(_0x24ea13));config=getConfiguration(),io['to'](_0x349375(0x1a8))[_0x349375(0x1a7)](_0x349375(0x1f1),config);}function toggleStatus(_0x5e43ac){const _0x4ae183=_0x3556f9;let _0xfecec4=dbConfig[_0x4ae183(0x1e0)]('bots')[_0x4ae183(0xf1)]({'botID':_0x5e43ac})[_0x4ae183(0xe8)](),_0x1588b5;if(_0xfecec4[_0x4ae183(0x1bc)]===_0x4ae183(0x12a))_0x1588b5=_0x4ae183(0x1c8);else{if(_0xfecec4[_0x4ae183(0x1bc)]==='new')_0x1588b5=_0x4ae183(0x1c4);else{if(_0xfecec4[_0x4ae183(0x1bc)]==='new-disabled')_0x1588b5='new';else{if(_0xfecec4['status']===_0x4ae183(0x1c8))_0x1588b5=_0x4ae183(0x12a);}}}return _0x1588b5;}function _0x4684(_0x2e2336,_0x80ba19){const _0x1dea2=_0x17f6();return _0x4684=function(_0x10a8a1,_0x12b1e8){_0x10a8a1=_0x10a8a1-0xa6;let _0x17f65b=_0x1dea2[_0x10a8a1];return _0x17f65b;},_0x4684(_0x2e2336,_0x80ba19);}function updateStatus(_0xaa2cb4,_0x353d0e){const _0x291c09=_0x3556f9;dbConfig['get'](_0x291c09(0x1f1))[_0x291c09(0xf1)]({'botID':_0xaa2cb4})[_0x291c09(0x168)]({'status':_0x353d0e})[_0x291c09(0x15a)](),config=getConfiguration(),io['to'](_0x291c09(0x1a8))['emit'](_0x291c09(0x1f1),config);}function updateLive(_0x88fa51,_0x1783fb){const _0x1eb515=_0x3556f9;dbConfig[_0x1eb515(0x1e0)]('bots')[_0x1eb515(0xf1)]({'botID':_0x88fa51})['assign']({'live':_0x1783fb})[_0x1eb515(0x15a)](),config=getConfiguration(),io['to'](_0x1eb515(0x1a8))['emit']('bots',config);}function updateBotName(_0x16bf35,_0x544a87){const _0x4b7396=_0x3556f9;dbConfig[_0x4b7396(0x1e0)](_0x4b7396(0x1f1))['find']({'botID':_0x16bf35})['assign']({'botname':_0x544a87})[_0x4b7396(0x15a)](),config=getConfiguration(),io['to']('botmanager')[_0x4b7396(0x1a7)]('bots',config);}function telegramError(_0x1b185){const _0x28b272=_0x3556f9;console[_0x28b272(0x13f)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x531993){const _0x4934e6=_0x3556f9;if(_0x531993[_0x4934e6(0x19b)][_0x4934e6(0x169)]!=settings['telegramUsername']&&'@'+_0x531993[_0x4934e6(0x19b)][_0x4934e6(0x169)]!=settings[_0x4934e6(0x110)])return tgBot[_0x4934e6(0xe9)](_0x531993['chat']['id'],_0x4934e6(0xb5),{'parse_mode':_0x4934e6(0xd1)})['catch'](_0x9b34ec=>{telegramError(_0x9b34ec);}),![];return!![];}async function initTelegram(){const _0x9f922b=_0x3556f9;if(tgBot)tgBot[_0x9f922b(0x173)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x9f922b(0x122)],{'polling':!![]});let _0x478d8a=_0x9f922b(0x187);_0x478d8a+='\x0a',_0x478d8a+='/enable\x20-\x20enable\x20notifications\x0a',_0x478d8a+=_0x9f922b(0xdb),_0x478d8a+=_0x9f922b(0xdf),_0x478d8a+=_0x9f922b(0xf4),_0x478d8a+='/on\x20-\x20start\x20bot(s)\x0a',_0x478d8a+='/off\x20-\x20stop\x20bot(s)\x0a',_0x478d8a+=_0x9f922b(0x1e3),_0x478d8a+=_0x9f922b(0x1e2);let _0x1198b9=_0x9f922b(0x1ea);_0x1198b9+='\x0a',_0x1198b9+=_0x478d8a,tgBot[_0x9f922b(0x161)](/\/start/,_0x10d47d=>{const _0x5174e2=_0x9f922b;if(!validateTelegram(_0x10d47d))return;if(settings[_0x5174e2(0xbc)]!=_0x10d47d[_0x5174e2(0x1f2)]['id'])updateSetting(_0x5174e2(0xbc),_0x10d47d[_0x5174e2(0x1f2)]['id']);updateSetting(_0x5174e2(0x1b3),!![]),tgBot[_0x5174e2(0xe9)](_0x10d47d[_0x5174e2(0x1f2)]['id'],_0x1198b9)[_0x5174e2(0x1cd)](_0x6665fb=>{telegramError(_0x6665fb);});}),tgBot[_0x9f922b(0x161)](/\/enable/,_0x360d64=>{const _0x5cb930=_0x9f922b;if(!validateTelegram(_0x360d64))return;if(settings[_0x5cb930(0xbc)]!=_0x360d64[_0x5cb930(0x1f2)]['id'])updateSetting(_0x5cb930(0xbc),_0x360d64[_0x5cb930(0x1f2)]['id']);updateSetting(_0x5cb930(0x1b3),!![]),tgBot[_0x5cb930(0xe9)](_0x360d64['chat']['id'],_0x5cb930(0x17f))['catch'](_0x53733a=>{telegramError(_0x53733a);});}),tgBot[_0x9f922b(0x161)](/\/config/,async _0x143703=>{const _0x25013a=_0x9f922b;if(!validateTelegram(_0x143703))return;tgBot[_0x25013a(0x190)](_0x25013a(0x1b7)),tgBot[_0x25013a(0xe9)](_0x143703[_0x25013a(0x1f2)]['id'],_0x25013a(0x1b5),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x25013a(0x163),'callback_data':_0x25013a(0x197)},{'text':_0x25013a(0xc8),'callback_data':_0x25013a(0x1c0)}]]}})['catch'](_0x46ead9=>{telegramError(_0x46ead9);}),tgBot['on'](_0x25013a(0x1b7),async _0x1876e7=>{const _0x18c59c=_0x25013a,_0x3e0530=_0x1876e7[_0x18c59c(0x1c7)],_0x15100f=_0x1876e7[_0x18c59c(0x105)];tgBot[_0x18c59c(0x1b1)](_0x1876e7['id'])[_0x18c59c(0x109)](async()=>{const _0x529b48=_0x18c59c;_0x3e0530==_0x529b48(0xbe)&&(updateSetting('telegramEvents','orders'),updateSetting(_0x529b48(0x1b3),!![]),await tgBot[_0x529b48(0xe9)](_0x15100f[_0x529b48(0x1f2)]['id'],_0x529b48(0x179))['catch'](_0x409448=>{telegramError(_0x409448);}));_0x3e0530==_0x529b48(0x197)&&(updateSetting(_0x529b48(0x181),_0x529b48(0x197)),updateSetting(_0x529b48(0x1b3),!![]),await tgBot[_0x529b48(0xe9)](_0x15100f[_0x529b48(0x1f2)]['id'],_0x529b48(0x16f))['catch'](_0x32d38f=>{telegramError(_0x32d38f);}));_0x3e0530=='all'&&(updateSetting(_0x529b48(0x181),_0x529b48(0x1c0)),updateSetting(_0x529b48(0x1b3),!![]),await tgBot[_0x529b48(0xe9)](_0x15100f[_0x529b48(0x1f2)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x529b48(0x1cd)](_0x21fc14=>{telegramError(_0x21fc14);}));if(!settings[_0x529b48(0xbc)])tgBot[_0x529b48(0xe9)](_0x15100f[_0x529b48(0x1f2)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x529b48(0x1cd)](_0x385839=>{telegramError(_0x385839);});}),tgBot[_0x18c59c(0x190)](_0x18c59c(0x1b7));});}),tgBot[_0x9f922b(0x161)](/\/status/,_0x4046de=>{const _0x1f3e42=_0x9f922b;if(!validateTelegram(_0x4046de))return;let _0x4324c7=_0x1f3e42(0x157);config[_0x1f3e42(0x147)](_0x261449=>{const _0x1eee4f=_0x1f3e42;_0x4324c7+=_0x1eee4f(0x18a)+_0x261449[_0x1eee4f(0x156)]+_0x1eee4f(0x18d)+_0x261449[_0x1eee4f(0x19a)]+':\x20'+_0x261449['status']+'\x20/\x20'+_0x261449[_0x1eee4f(0xc2)]+'\x0a';}),_0x4324c7+='\x0a',_0x4324c7+=_0x1f3e42(0xed),_0x4324c7+=!settings[_0x1f3e42(0x1b3)]?_0x1f3e42(0x1ec):_0x1f3e42(0x1d0),_0x4324c7+=settings[_0x1f3e42(0x1b3)]?settings[_0x1f3e42(0x181)]==_0x1f3e42(0x1c0)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x1f3e42(0xb3)+settings[_0x1f3e42(0x181)]+'\x20only\x0a':'',tgBot[_0x1f3e42(0xe9)](_0x4046de[_0x1f3e42(0x1f2)]['id'],_0x4324c7,{'parse_mode':_0x1f3e42(0xd1)})['catch'](_0x231b1f=>{telegramError(_0x231b1f);});}),tgBot[_0x9f922b(0x161)](/\/restart/,_0x30cc48=>{const _0x3b8aef=_0x9f922b;if(!validateTelegram(_0x30cc48))return;tgBot[_0x3b8aef(0x190)]('callback_query');const _0x302554=getEnabledBots();if(_0x302554['length']==0x0)tgBot['sendMessage'](_0x30cc48[_0x3b8aef(0x1f2)]['id'],_0x3b8aef(0x146))[_0x3b8aef(0x1cd)](_0x5e1a4a=>{telegramError(_0x5e1a4a);});else{if(_0x302554[_0x3b8aef(0xee)]>0x1)_0x302554[_0x3b8aef(0x178)]({'botID':_0x3b8aef(0x1c0)});let _0x36000a=[],_0x328718=[];const _0xb2963e=_0x302554[_0x3b8aef(0xee)]%0x4==0x0||_0x302554[_0x3b8aef(0xee)]%0x4==0x3||_0x302554[_0x3b8aef(0xee)]%0x3==0x1?0x4:0x3;let _0x4e861b=0x0;_0x302554['forEach']((_0x5bae03,_0x3a7069)=>{const _0xa36d4e=_0x3b8aef;if(_0x3a7069%_0xb2963e==0x0)_0x328718=[];_0x328718[_0xa36d4e(0x178)]({'text':_0x5bae03['botID']==_0xa36d4e(0x1c0)?_0xa36d4e(0xbf):_0xa36d4e(0x18a)+_0x5bae03['botID'],'callback_data':_0x5bae03['botID']}),_0x3a7069%_0xb2963e==0x0&&(_0x36000a[_0x4e861b]=_0x328718,_0x4e861b++);}),tgBot[_0x3b8aef(0xe9)](_0x30cc48[_0x3b8aef(0x1f2)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x36000a}})['catch'](_0x63e1ca=>{telegramError(_0x63e1ca);}),tgBot['on'](_0x3b8aef(0x1b7),async _0x4881e8=>{const _0x4d28d8=_0x3b8aef,_0x1e43c0=_0x4881e8[_0x4d28d8(0x1c7)],_0x4652ff=_0x4881e8[_0x4d28d8(0x105)];tgBot[_0x4d28d8(0x1b1)](_0x4881e8['id'])['then'](async()=>{const _0x47b837=_0x4d28d8;if(_0x1e43c0==_0x47b837(0x1c0)){if(settings['telegramEvents']==_0x47b837(0xbe))tgBot[_0x47b837(0xe9)](_0x4652ff[_0x47b837(0x1f2)]['id'],_0x47b837(0xd9))['catch'](_0x5184d0=>{telegramError(_0x5184d0);});config[_0x47b837(0x147)](_0x38216f=>{const _0x49e7d2=_0x47b837;restartBot(_0x38216f[_0x49e7d2(0x156)]);});}else{if(settings[_0x47b837(0x181)]==_0x47b837(0xbe))tgBot[_0x47b837(0xe9)](_0x4652ff['chat']['id'],_0x47b837(0x160)+_0x1e43c0)[_0x47b837(0x1cd)](_0x58ee8f=>{telegramError(_0x58ee8f);});restartBot(_0x1e43c0);}}),tgBot[_0x4d28d8(0x190)]('callback_query');});}}),tgBot[_0x9f922b(0x161)](/\/on/,_0xdcd699=>{const _0x1ea257=_0x9f922b;if(!validateTelegram(_0xdcd699))return;tgBot[_0x1ea257(0x190)]('callback_query');const _0x3fcd05=getDisabledBots();if(_0x3fcd05[_0x1ea257(0xee)]==0x0)tgBot[_0x1ea257(0xe9)](_0xdcd699[_0x1ea257(0x1f2)]['id'],_0x1ea257(0x1bb))[_0x1ea257(0x1cd)](_0x230e07=>{telegramError(_0x230e07);});else{if(_0x3fcd05[_0x1ea257(0xee)]>0x1)_0x3fcd05['push']({'botID':_0x1ea257(0x1c0)});let _0x338fc4=[],_0x5c7aa4=[];const _0xd0acc1=_0x3fcd05[_0x1ea257(0xee)]%0x4==0x0||_0x3fcd05['length']%0x4==0x3||_0x3fcd05[_0x1ea257(0xee)]%0x3==0x1?0x4:0x3;let _0x2c5979=0x0;_0x3fcd05[_0x1ea257(0x147)]((_0x11d748,_0x946f32)=>{const _0x9420=_0x1ea257;if(_0x946f32%_0xd0acc1==0x0)_0x5c7aa4=[];_0x5c7aa4[_0x9420(0x178)]({'text':_0x11d748[_0x9420(0x156)]==_0x9420(0x1c0)?_0x9420(0xbf):_0x9420(0x18a)+_0x11d748[_0x9420(0x156)],'callback_data':_0x11d748[_0x9420(0x156)]}),_0x946f32%_0xd0acc1==0x0&&(_0x338fc4[_0x2c5979]=_0x5c7aa4,_0x2c5979++);}),tgBot['sendMessage'](_0xdcd699['chat']['id'],_0x1ea257(0x10a),{'reply_markup':{'inline_keyboard':_0x338fc4}})[_0x1ea257(0x1cd)](_0x48334b=>{telegramError(_0x48334b);}),tgBot['on'](_0x1ea257(0x1b7),async _0x1cb354=>{const _0x27acfc=_0x1ea257,_0x4d3545=_0x1cb354[_0x27acfc(0x1c7)],_0x15621a=_0x1cb354[_0x27acfc(0x105)];tgBot['answerCallbackQuery'](_0x1cb354['id'])[_0x27acfc(0x109)](async()=>{const _0x514b7f=_0x27acfc;if(_0x4d3545==_0x514b7f(0x1c0)){if(settings[_0x514b7f(0x181)]=='orders')tgBot[_0x514b7f(0xe9)](_0x15621a['chat']['id'],_0x514b7f(0x1c6))[_0x514b7f(0x1cd)](_0x5f5931=>{telegramError(_0x5f5931);});_0x3fcd05[_0x514b7f(0x147)](_0x207084=>{const _0x3be7f2=_0x514b7f;if(_0x207084[_0x3be7f2(0x156)]!='all')toggleBot(_0x207084['botID'],toggleStatus(_0x207084['botID']),'stopped');});}else{if(settings['telegramEvents']==_0x514b7f(0xbe))tgBot[_0x514b7f(0xe9)](_0x15621a['chat']['id'],_0x514b7f(0xd6)+_0x4d3545)[_0x514b7f(0x1cd)](_0x2e7d3b=>{telegramError(_0x2e7d3b);});toggleBot(_0x4d3545,toggleStatus(_0x4d3545),_0x514b7f(0xae));}}),tgBot['removeListener'](_0x27acfc(0x1b7));});}}),tgBot['onText'](/\/off/,_0x5ac115=>{const _0x2036be=_0x9f922b;if(!validateTelegram(_0x5ac115))return;tgBot[_0x2036be(0x190)]('callback_query');const _0x4c2328=getEnabledBots();if(_0x4c2328[_0x2036be(0xee)]==0x0)tgBot[_0x2036be(0xe9)](_0x5ac115[_0x2036be(0x1f2)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x2036be(0x1cd)](_0x1dd8d9=>{telegramError(_0x1dd8d9);});else{if(_0x4c2328[_0x2036be(0xee)]>0x1)_0x4c2328[_0x2036be(0x178)]({'botID':_0x2036be(0x1c0)});let _0x65330b=[],_0x4e3aef=[];const _0x35f2c3=_0x4c2328['length']%0x4==0x0||_0x4c2328[_0x2036be(0xee)]%0x4==0x3||_0x4c2328[_0x2036be(0xee)]%0x3==0x1?0x4:0x3;let _0x1c5cf5=0x0;_0x4c2328['forEach']((_0x3cf5c2,_0x56a19b)=>{const _0x20620d=_0x2036be;if(_0x56a19b%_0x35f2c3==0x0)_0x4e3aef=[];_0x4e3aef['push']({'text':_0x3cf5c2['botID']==_0x20620d(0x1c0)?_0x20620d(0xbf):_0x20620d(0x18a)+_0x3cf5c2[_0x20620d(0x156)],'callback_data':_0x3cf5c2[_0x20620d(0x156)]}),_0x56a19b%_0x35f2c3==0x0&&(_0x65330b[_0x1c5cf5]=_0x4e3aef,_0x1c5cf5++);}),tgBot['sendMessage'](_0x5ac115[_0x2036be(0x1f2)]['id'],_0x2036be(0xc4),{'reply_markup':{'inline_keyboard':_0x65330b}})[_0x2036be(0x1cd)](_0x125701=>{telegramError(_0x125701);}),tgBot['on'](_0x2036be(0x1b7),async _0x5a1dda=>{const _0x316b28=_0x2036be,_0x319201=_0x5a1dda[_0x316b28(0x1c7)],_0x4dcd5c=_0x5a1dda[_0x316b28(0x105)];tgBot[_0x316b28(0x1b1)](_0x5a1dda['id'])[_0x316b28(0x109)](async()=>{const _0x3b6ed4=_0x316b28;if(_0x319201==_0x3b6ed4(0x1c0)){if(settings[_0x3b6ed4(0x181)]==_0x3b6ed4(0xbe))tgBot[_0x3b6ed4(0xe9)](_0x4dcd5c[_0x3b6ed4(0x1f2)]['id'],_0x3b6ed4(0xcc))['catch'](_0x1b2884=>{telegramError(_0x1b2884);});_0x4c2328['forEach'](_0x2ccd03=>{const _0x57b6c5=_0x3b6ed4;if(_0x2ccd03['botID']!=_0x57b6c5(0x1c0))toggleBot(_0x2ccd03['botID'],toggleStatus(_0x2ccd03['botID']),'stopped');});}else{if(settings[_0x3b6ed4(0x181)]=='orders')tgBot[_0x3b6ed4(0xe9)](_0x4dcd5c['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x319201)['catch'](_0x1e12be=>{telegramError(_0x1e12be);});toggleBot(_0x319201,toggleStatus(_0x319201),_0x3b6ed4(0xae));}}),tgBot[_0x316b28(0x190)](_0x316b28(0x1b7));});}}),tgBot[_0x9f922b(0x161)](/\/disable/,_0x331eaf=>{const _0x351ba2=_0x9f922b;if(!validateTelegram(_0x331eaf))return;tgBot[_0x351ba2(0xe9)](_0x331eaf[_0x351ba2(0x1f2)]['id'],'Notifications\x20disabled')[_0x351ba2(0x1cd)](_0x5f0083=>{telegramError(_0x5f0083);}),updateSetting(_0x351ba2(0x1b3),![]);}),tgBot[_0x9f922b(0x161)](/\/help/,_0x38830a=>{const _0x4fc76f=_0x9f922b;if(!validateTelegram(_0x38830a))return;tgBot[_0x4fc76f(0xe9)](_0x38830a[_0x4fc76f(0x1f2)]['id'],_0x478d8a)[_0x4fc76f(0x1cd)](_0x336004=>{telegramError(_0x336004);});}),tgBot['on'](_0x9f922b(0xb7),_0x4ccd30=>{const _0x49021d=_0x9f922b;_0x4ccd30[_0x49021d(0x136)]()[_0x49021d(0xd2)](_0x49021d(0xe7))&&(logging(_0x49021d(0xad)),tgBot[_0x49021d(0x173)](),tgBot=null,io['to'](_0x49021d(0x1a8))[_0x49021d(0x1a7)](_0x49021d(0xf9),'Invalid\x20Telegram\x20token'));}),process[_0x9f922b(0x1d1)](_0x9f922b(0x102),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process['once'](_0x9f922b(0x10e),()=>{const _0x34d862=_0x9f922b;if(tgBot)tgBot[_0x34d862(0x173)]();process[_0x34d862(0x135)](0x1);});}}function disableTelegram(){const _0x164279=_0x3556f9;tgBot&&(tgBot[_0x164279(0x173)](),tgBot=null);}function sendTelegram(_0x5a4029,_0x30a851){const _0x15f70d=_0x3556f9;if(settings['telegramEnabled']){if(settings[_0x15f70d(0x181)]=='all'||(_0x30a851[_0x15f70d(0xfc)]==_0x15f70d(0x195)||_0x30a851['type']==_0x15f70d(0x145))&&settings[_0x15f70d(0x181)]=='alerts'||_0x30a851['type']=='order'&&settings[_0x15f70d(0x181)]=='orders'){if(tgBot&&settings[_0x15f70d(0xbc)]){if(_0x30a851[_0x15f70d(0x124)])tgBot['sendMessage'](settings['telegramChatId'],_0x30a851[_0x15f70d(0x19a)]+_0x15f70d(0x1df)+_0x30a851[_0x15f70d(0x18e)])[_0x15f70d(0x1cd)](_0x269c55=>{telegramError(_0x269c55);});else tgBot[_0x15f70d(0xe9)](settings['telegramChatId'],'Bot\x20'+_0x5a4029+'\x20>\x20'+_0x30a851['event'])[_0x15f70d(0x1cd)](_0x246921=>{telegramError(_0x246921);});}}}}function getDeviceWithIp(_0x49e071){const _0x31904c=_0x3556f9;return devices[_0x31904c(0xf1)](_0x3cb3c6=>_0x3cb3c6['ip']===_0x49e071);}function temporaryAccess2FA(_0x44687f,_0x354a26){const _0x4640c9=_0x3556f9;let _0x4fca7d=new Date(),_0x2587a3=![];if(lastIpApproval){if(_0x4fca7d-lastIpApproval<0x1388)_0x2587a3=!![];}lastIpApproval=new Date();if(_0x2587a3)return;tgBot&&settings[_0x4640c9(0xbc)]&&(tgBot[_0x4640c9(0x190)](_0x4640c9(0x1b7)),tgBot[_0x4640c9(0xe9)](settings[_0x4640c9(0xbc)],_0x4640c9(0x174)+normalizeIP(_0x354a26)[_0x4640c9(0xb6)]+_0x4640c9(0x184),{'parse_mode':_0x4640c9(0xd1),'reply_markup':{'inline_keyboard':[[{'text':_0x4640c9(0xe0),'callback_data':'5'},{'text':_0x4640c9(0x167),'callback_data':'15'},{'text':_0x4640c9(0x12b),'callback_data':'30'},{'text':_0x4640c9(0x1ae),'callback_data':_0x4640c9(0x1ae)}]]}})[_0x4640c9(0x1cd)](_0x4f1790=>{telegramError(_0x4f1790);}),tgBot['on'](_0x4640c9(0x1b7),async _0x3473af=>{const _0x16e66a=_0x4640c9,_0x3928ba=_0x3473af[_0x16e66a(0x1c7)],_0x3385ca=_0x3473af[_0x16e66a(0x105)];tgBot[_0x16e66a(0x1b1)](_0x3473af['id'])['then'](async()=>{const _0x27a10d=_0x16e66a;devices[_0x44687f]['telegramIpApproval']={'clientip':_0x354a26,'timestamp':new Date()['getTime'](),'expiry':_0x3928ba},_0x3928ba!=_0x27a10d(0x1ae)?(await tgBot[_0x27a10d(0xe9)](_0x3385ca[_0x27a10d(0x1f2)]['id'],'Access\x20enabled\x20for\x20'+_0x3928ba+_0x27a10d(0x189),{'parse_mode':_0x27a10d(0xd1)})[_0x27a10d(0x1cd)](_0x991019=>{telegramError(_0x991019);}),io['to'](_0x44687f)['emit'](_0x27a10d(0x1bc),{'access':{'allow':![],'reason':_0x27a10d(0x1cc),'token':null}})):(await tgBot['sendMessage'](_0x3385ca[_0x27a10d(0x1f2)]['id'],_0x27a10d(0x1b8))[_0x27a10d(0x1cd)](_0x47917e=>{telegramError(_0x47917e);}),io['to'](_0x44687f)[_0x27a10d(0x1a7)](_0x27a10d(0x1bc),{'access':{'allow':![],'reason':_0x27a10d(0x125),'token':null}}));}),tgBot[_0x16e66a(0x190)](_0x16e66a(0x1b7));}));}function loginAccess2FA(_0x1dd997,_0x548e2f){const _0x135902=_0x3556f9;tgBot&&settings['telegramChatId']&&(tgBot[_0x135902(0x190)](_0x135902(0x1b7)),tgBot[_0x135902(0xe9)](settings[_0x135902(0xbc)],_0x135902(0xab)+normalizeIP(_0x548e2f)[_0x135902(0xb6)]+_0x135902(0x184),{'parse_mode':_0x135902(0xd1),'reply_markup':{'inline_keyboard':[[{'text':_0x135902(0x140),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x135902(0x1ae)}]]}})[_0x135902(0x1cd)](_0x293d5e=>{telegramError(_0x293d5e);}),tgBot['on'](_0x135902(0x1b7),async _0xe1dac9=>{const _0x193a0f=_0x135902,_0x3f1bdb=_0xe1dac9[_0x193a0f(0x1c7)],_0x24e15b=_0xe1dac9[_0x193a0f(0x105)];tgBot[_0x193a0f(0x1b1)](_0xe1dac9['id'])[_0x193a0f(0x109)](async()=>{const _0x540fb6=_0x193a0f;devices[_0x1dd997][_0x540fb6(0x131)]={'clientip':_0x548e2f,'timestamp':new Date()['getTime'](),'expiry':_0x3f1bdb},_0x3f1bdb!=_0x540fb6(0x1ae)?(await tgBot[_0x540fb6(0xe9)](_0x24e15b[_0x540fb6(0x1f2)]['id'],_0x540fb6(0x1d3),{'parse_mode':_0x540fb6(0xd1)})['catch'](_0x52e04d=>{telegramError(_0x52e04d);}),io['to'](_0x1dd997)[_0x540fb6(0x1a7)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x540fb6(0xe9)](_0x24e15b[_0x540fb6(0x1f2)]['id'],'Login\x20rejected')[_0x540fb6(0x1cd)](_0x19843c=>{telegramError(_0x19843c);}),io['to'](_0x1dd997)[_0x540fb6(0x1a7)](_0x540fb6(0x1bc),{'access':{'allow':![],'reason':_0x540fb6(0x17d),'token':null}}));}),tgBot[_0x193a0f(0x190)](_0x193a0f(0x1b7));}));}function getConfiguration(){const _0x5c3044=_0x3556f9;return dbConfig[_0x5c3044(0x1e0)](_0x5c3044(0x1f1))['sortBy']('botID')['value']()||[];}function getEnabledBots(){const _0x4c0f44=_0x3556f9;return dbConfig[_0x4c0f44(0x1e0)](_0x4c0f44(0x1f1))[_0x4c0f44(0xe5)]('botID')[_0x4c0f44(0xe3)]({'status':_0x4c0f44(0x12a)})[_0x4c0f44(0xe8)]()||[];}function getDisabledBots(){const _0x44ab44=_0x3556f9;return dbConfig[_0x44ab44(0x1e0)](_0x44ab44(0x1f1))['sortBy'](_0x44ab44(0x156))[_0x44ab44(0xe3)]({'status':_0x44ab44(0x1c8)})[_0x44ab44(0xe8)]()||[];}function getSettings(){const _0x14e311=_0x3556f9;return dbSettings[_0x14e311(0x1e0)](_0x14e311(0x176))[_0x14e311(0xe8)]()||{'timeshift':0x0};}function getSecure(){const _0x38ba0d=_0x3556f9;return dbSecure[_0x38ba0d(0x1e0)](_0x38ba0d(0xca))['value']()||{};}function getBlacklist(){const _0x3f1e22=_0x3556f9;return dbSecure[_0x3f1e22(0x1e0)](_0x3f1e22(0x1a2))[_0x3f1e22(0xe8)]()||[];}function broadcastToBots(_0x35a841,_0x13599a){const _0x1a6d1d=_0x3556f9;config[_0x1a6d1d(0x147)](_0xe15fae=>{const _0x356b9e=_0x1a6d1d;if(_0xe15fae[_0x356b9e(0x1bc)]==_0x356b9e(0x12a)&&_0xe15fae[_0x356b9e(0xc2)]==_0x356b9e(0x1a1)){if(pid[_0xe15fae[_0x356b9e(0x156)]])pid[_0xe15fae['botID']][_0x356b9e(0xd4)]({[_0x35a841]:_0x13599a});}});}function storeSettings(_0x5c39c2,_0x4a98f8=![]){const _0x434048=_0x3556f9;_0x5c39c2={...settings,..._0x5c39c2};if(_0x4a98f8&&_0x5c39c2[_0x434048(0xfa)]!=_0x434048(0x130)&&_0x5c39c2[_0x434048(0xfa)]!=''){const _0x401127=crypt[_0x434048(0x107)](secure[_0x434048(0x1d6)],_0x5c39c2[_0x434048(0xfa)])['message'][_0x434048(0xa8)]('@')[0x0],_0x40eada=bcrypt[_0x434048(0x117)](_0x401127,saltRounds);_0x5c39c2={..._0x5c39c2,'bbPassword':_0x40eada};}if(_0x4a98f8&&_0x5c39c2[_0x434048(0x122)]!='************'&&_0x5c39c2['telegramToken']!=''){const _0x4bc305=crypt[_0x434048(0x107)](secure['privateKey'],_0x5c39c2['telegramToken'])['message'][_0x434048(0xa8)]('@')[0x0];_0x5c39c2={..._0x5c39c2,'telegramToken':_0x4bc305};}const _0xee93a=_0x5c39c2[_0x434048(0x122)]!=_0x434048(0x130)&&_0x5c39c2[_0x434048(0x122)]!=settings[_0x434048(0x122)]||_0x5c39c2[_0x434048(0x110)]!=settings[_0x434048(0x110)],_0x4d224f=_0x5c39c2[_0x434048(0x122)]==''||_0x5c39c2['telegramUsername']=='';if(_0xee93a)_0x5c39c2[_0x434048(0x181)]=_0x434048(0x1c0);for(const [_0x421c6e,_0xfd5b66]of Object[_0x434048(0xe2)](_0x5c39c2)){if(_0x421c6e==_0x434048(0x122)&&_0xfd5b66==_0x434048(0x130)){_0x5c39c2[_0x434048(0x122)]=settings['telegramToken'];continue;};if(_0x421c6e=='bbPassword'&&_0xfd5b66==_0x434048(0x130)){_0x5c39c2[_0x434048(0xfa)]=settings[_0x434048(0xfa)];continue;};dbSettings['set'](_0x434048(0x119)+_0x421c6e,_0xfd5b66)[_0x434048(0x15a)]();}settings=_0x5c39c2,io['to'](_0x434048(0x1a8))['emit']('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x434048(0x18b)]);if(_0xee93a&&!_0x4d224f)initTelegram();if(_0xee93a&&_0x4d224f)disableTelegram();getAllClients()['forEach'](_0x3ecf5e=>{const _0x24ecbf=_0x434048;getSocket(_0x3ecf5e['id'])[_0x24ecbf(0x1a7)]('status',{'access':{'allow':![],'reason':_0x24ecbf(0x1cc),'token':null}});});}function updateSetting(_0x674d87,_0x2f7d9b){const _0x3dc37e=_0x3556f9;dbSettings[_0x3dc37e(0x1c2)](_0x3dc37e(0x119)+_0x674d87,_0x2f7d9b)[_0x3dc37e(0x15a)](),settings=getSettings(),io['to'](_0x3dc37e(0x1a8))[_0x3dc37e(0x1a7)](_0x3dc37e(0x176),cleanSettings());}function storeSecure(_0x257c11){const _0x41ef72=_0x3556f9;dbSecure[_0x41ef72(0x1e0)]('secure')[_0x41ef72(0x178)](_0x257c11)[_0x41ef72(0x15a)](),secure=_0x257c11;}function addBlacklist(_0x16f2a9){const _0x1cebee=_0x3556f9;cleanBlacklist();let _0x35bd5d;devices[_0x16f2a9][_0x1cebee(0x108)]?_0x35bd5d=Math['max'](devices[_0x16f2a9][_0x1cebee(0x108)][_0x1cebee(0x126)],loginExpiry):_0x35bd5d=loginExpiry,dbSecure[_0x1cebee(0x1e0)](_0x1cebee(0x1a2))[_0x1cebee(0x178)]({'expiry':new Date()[_0x1cebee(0x199)]()+_0x35bd5d*0x3c*0x3e8,'token':devices[_0x16f2a9]['access']['token']})[_0x1cebee(0x15a)](),blacklist=dbSecure['get'](_0x1cebee(0x1a2))['value']();}function cleanBlacklist(){const _0x22da9a=_0x3556f9;let _0xea72d2=dbSecure['get'](_0x22da9a(0x1a2))[_0x22da9a(0x19c)]()[_0x22da9a(0xe8)](),_0x4d4221=new Date()[_0x22da9a(0x199)]();_0xea72d2[_0x22da9a(0x147)](_0x1057fa=>{const _0x1c5eb1=_0x22da9a;_0x1057fa[_0x1c5eb1(0x126)]<_0x4d4221&&dbSecure[_0x1c5eb1(0x1e0)](_0x1c5eb1(0x1a2))['remove']({'expiry':_0x1057fa[_0x1c5eb1(0x126)]})[_0x1c5eb1(0x15a)]();});}function initStates(){const _0x26657e=_0x3556f9;let _0x3f0606=getConfiguration();_0x3f0606[_0x26657e(0x147)](_0x3f291c=>{const _0x1dd449=_0x26657e;_0x3f291c['live']=_0x1dd449(0xae);}),storeConfiguration(_0x3f0606);}function onKeys(){const _0x1d9d1b=new RSA();return new Promise(_0x1fe615=>{const _0x361a7d=_0x4684;_0x1d9d1b['generateKeyPairAsync']()[_0x361a7d(0x109)](_0x14d1c6=>{_0x1fe615(_0x14d1c6);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2815a8=_0x3556f9;let _0x21536e=getConfiguration(),_0x1a6522=![];_0x21536e[_0x2815a8(0x147)](_0xe9c759=>{const _0x4e7460=_0x2815a8;if(_0xe9c759['status']==_0x4e7460(0x1a1))_0xe9c759[_0x4e7460(0x1bc)]=_0x4e7460(0x12a),_0x1a6522=!![];else _0xe9c759['status']==_0x4e7460(0xae)&&(_0xe9c759[_0x4e7460(0x1bc)]=_0x4e7460(0x1c8),_0x1a6522=!![]);});if(_0x1a6522)storeConfiguration(_0x21536e);let _0x34164b=getSecure();if(!_0x34164b['hasOwnProperty']('secret')){let _0x408ba9=await generateKeys();_0x34164b[_0x2815a8(0x180)]=_0x408ba9[_0x2815a8(0x180)],_0x34164b['privateKey']=_0x408ba9[_0x2815a8(0x1d6)],_0x34164b[_0x2815a8(0x1db)]=crypto[_0x2815a8(0xde)](0x20)[_0x2815a8(0x136)](_0x2815a8(0x185));;storeSecure(_0x34164b);}let _0xd1a680=getSettings();_0x1a6522=![];!_0xd1a680[_0x2815a8(0x114)](_0x2815a8(0xc3))&&(_0xd1a680['loginRequired']=![],_0xd1a680['bbUsername']='',_0xd1a680['bbPassword']='',_0xd1a680['f2aRequired']=![],_0x1a6522=!![]);!_0xd1a680[_0x2815a8(0x114)](_0x2815a8(0x1d5))&&(_0xd1a680['whitelistEnabled']=![],_0xd1a680[_0x2815a8(0xbd)]=[],_0xd1a680[_0x2815a8(0xd7)]=![],_0x1a6522=!![]);if(!_0xd1a680['hasOwnProperty'](_0x2815a8(0x1b3))){if(_0xd1a680[_0x2815a8(0xbc)])_0xd1a680['telegramEnabled']=!![];else _0xd1a680['telegramEnabled']=![];_0x1a6522=!![];}if(_0x1a6522)storeSettings(_0xd1a680);}function storeConfiguration(_0x164ec2){const _0x7ae10c=_0x3556f9;dbConfig[_0x7ae10c(0x1e0)](_0x7ae10c(0x1f1))[_0x7ae10c(0x113)]()['write'](),dbConfig[_0x7ae10c(0x1e0)](_0x7ae10c(0x1f1))[_0x7ae10c(0x178)](..._0x164ec2)[_0x7ae10c(0x15a)](),config=_0x164ec2;}function resetPassword(){const _0x1098ac=_0x3556f9;tgBot&&settings[_0x1098ac(0xbc)]&&(tgBot[_0x1098ac(0x190)]('callback_query'),tgBot[_0x1098ac(0xe9)](settings[_0x1098ac(0xbc)],_0x1098ac(0x1af),{'parse_mode':_0x1098ac(0xd1),'reply_markup':{'inline_keyboard':[[{'text':_0x1098ac(0x165),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x4fbd9a=>{telegramError(_0x4fbd9a);}),tgBot['on']('callback_query',async _0x55a008=>{const _0xe865a0=_0x1098ac,_0x11b95c=_0x55a008[_0xe865a0(0x1c7)],_0x4517d5=_0x55a008[_0xe865a0(0x105)];tgBot[_0xe865a0(0x1b1)](_0x55a008['id'])['then'](async()=>{const _0xf943a0=_0xe865a0;if(_0x11b95c!='no'){const _0x3051d7=0xf,_0x3e456d=_0xf943a0(0x1cb),_0x323b95=Array[_0xf943a0(0x19b)](crypto[_0xf943a0(0x116)](new Uint32Array(_0x3051d7)))[_0xf943a0(0x1c3)](_0x37f1bb=>_0x3e456d[_0x37f1bb%_0x3e456d['length']])[_0xf943a0(0x18f)](''),_0x4a7522=bcrypt[_0xf943a0(0x117)](_0x323b95,saltRounds);storeSettings({'bbPassword':_0x4a7522}),await tgBot[_0xf943a0(0xe9)](_0x4517d5[_0xf943a0(0x1f2)]['id'],_0xf943a0(0x10d)+_0x323b95,{'parse_mode':_0xf943a0(0xd1)})[_0xf943a0(0x1cd)](_0x553be5=>{telegramError(_0x553be5);});}else await tgBot[_0xf943a0(0xe9)](_0x4517d5[_0xf943a0(0x1f2)]['id'],_0xf943a0(0xd8))[_0xf943a0(0x1cd)](_0x4c3689=>{telegramError(_0x4c3689);});}),tgBot[_0xe865a0(0x190)]('callback_query');}));}function logging(_0x820510){const _0x2a780c=_0x3556f9;console[_0x2a780c(0x13f)](getTimeStamp()+_0x2a780c(0xeb)+_0x820510);if(tgBot&&settings[_0x2a780c(0xbc)]&&settings[_0x2a780c(0x181)]!=_0x2a780c(0xbe))tgBot[_0x2a780c(0xe9)](settings[_0x2a780c(0xbc)],_0x2a780c(0x1c1)+_0x820510)[_0x2a780c(0x1cd)](_0x1b2f09=>{telegramError(_0x1b2f09);});}function getServerTime(){const _0x3404e0=_0x3556f9,_0x3f7cdd=new Date();return _0x3f7cdd[_0x3404e0(0x18c)]()+'/'+(_0x3f7cdd[_0x3404e0(0x1e5)]()+0x1)[_0x3404e0(0x136)]()[_0x3404e0(0xaf)](0x2,'0')+'/'+_0x3f7cdd[_0x3404e0(0x133)]()[_0x3404e0(0x136)]()[_0x3404e0(0xaf)](0x2,'0')+'\x20'+_0x3f7cdd[_0x3404e0(0x127)]()['toString']()[_0x3404e0(0xaf)](0x2,'0')+':'+_0x3f7cdd[_0x3404e0(0x1cf)]()[_0x3404e0(0x136)]()[_0x3404e0(0xaf)](0x2,'0')+':'+_0x3f7cdd[_0x3404e0(0x1ba)]()[_0x3404e0(0x136)]()[_0x3404e0(0xaf)](0x2,'0');}function getTimeStamp(){const _0x3e7b95=_0x3556f9,_0x35f263=shiftedTime();return _0x35f263[_0x3e7b95(0x18c)]()+'/'+(_0x35f263[_0x3e7b95(0x1e5)]()+0x1)[_0x3e7b95(0x136)]()[_0x3e7b95(0xaf)](0x2,'0')+'/'+_0x35f263[_0x3e7b95(0x133)]()[_0x3e7b95(0x136)]()[_0x3e7b95(0xaf)](0x2,'0')+'\x20'+_0x35f263[_0x3e7b95(0x127)]()[_0x3e7b95(0x136)]()[_0x3e7b95(0xaf)](0x2,'0')+':'+_0x35f263[_0x3e7b95(0x1cf)]()[_0x3e7b95(0x136)]()['padStart'](0x2,'0')+':'+_0x35f263['getSeconds']()[_0x3e7b95(0x136)]()[_0x3e7b95(0xaf)](0x2,'0');}function shiftedTime(){const _0x40272d=_0x3556f9,_0x26659c=new Date();let _0x1d9870=_0x26659c;if(settings['timeshift']&&settings[_0x40272d(0x18b)]!==0x0)_0x1d9870=fns['add'](_0x26659c,{'hours':settings[_0x40272d(0x18b)]});return _0x1d9870;}function startScheduler(){let _0x377901=new Date()['getUTCHours']();_0x377901==0x1&&backupConfigFiles();_0x377901==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x46c4ab=_0x3556f9;fs[_0x46c4ab(0x141)](configpath,{'withFileTypes':!![]})[_0x46c4ab(0x147)](_0x871288=>{const _0x3dd17d=_0x46c4ab;if(!_0x871288[_0x3dd17d(0x186)]())fs[_0x3dd17d(0xba)](configpath+_0x871288[_0x3dd17d(0x14b)],configbackuppath+_0x871288['name']);});}function triggerAnalytics(){const _0x3bf8c9=_0x3556f9;analytics[_0x3bf8c9(0x172)]({'title':'Balance\x20Bot\x20Server','href':_0x3bf8c9(0x13d),'path':'/v'+serverversion});}function validateCredentials(_0x5b09a1,_0x16e906){const _0x4cb3ba=_0x3556f9;if(_0x5b09a1[_0x4cb3ba(0x169)]==settings[_0x4cb3ba(0x16c)]&&bcrypt[_0x4cb3ba(0xdc)](_0x5b09a1['password'],settings[_0x4cb3ba(0xfa)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x4cb3ba(0x171),'token':null};else{const _0x34343b=generateLoginToken(_0x16e906);return{'allow':!![],'reason':_0x4cb3ba(0xa7),'token':_0x34343b};}}else return{'allow':![],'reason':_0x4cb3ba(0x120),'token':null};}function refreshToken(_0x4345b6){const _0x3bca0e=_0x3556f9,_0x432e24=generateLoginToken(_0x4345b6);return{'allow':!![],'reason':_0x3bca0e(0xa7),'token':_0x432e24};}function validateAccess(_0x5b6d45,_0x7c69b3){const _0x3ac6ba=_0x3556f9;let _0x5741bc=devices[_0x7c69b3]['ip'],_0x1e8206;const _0x15dd58=_0x1d9f38=>{const _0x302429=_0x4684;if(settings[_0x302429(0xc3)]){if(settings[_0x302429(0xac)]){if(telegram2FaApproved(_0x7c69b3)){const _0x2db8f5=generateLoginToken(_0x7c69b3);return{'allow':!![],'reason':_0x302429(0xf5),'token':_0x2db8f5};}else return{'allow':![],'reason':_0x302429(0x155),'token':null};}else return _0x1e8206=validToken(_0x1d9f38,_0x7c69b3),_0x1e8206[_0x302429(0x114)](_0x302429(0x145))?{'allow':!![],'reason':_0x302429(0x100),'token':_0x1d9f38}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x302429(0x1ca),'token':null};};if(settings[_0x3ac6ba(0x1d5)]){let _0x544e9f=[...settings[_0x3ac6ba(0xbd)],'::1',_0x3ac6ba(0x154),_0x3ac6ba(0xce)];if(_0x544e9f[_0x3ac6ba(0xd2)](_0x5741bc))return _0x15dd58(_0x5b6d45);else{_0x1e8206=validToken(_0x5b6d45,_0x7c69b3);if(_0x1e8206[_0x3ac6ba(0x114)](_0x3ac6ba(0x145)))return _0x15dd58(_0x5b6d45);else{if(telegramIpApproved(_0x7c69b3)){const _0xf1fc39=generateToken(_0x7c69b3);return _0x1e8206=_0x15dd58(_0x5b6d45),_0x1e8206[_0x3ac6ba(0x11d)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0xf1fc39}:_0x1e8206;}else return settings[_0x3ac6ba(0xd7)]?{'allow':![],'reason':_0x3ac6ba(0x111),'token':null}:{'allow':![],'reason':_0x3ac6ba(0x188),'token':null};}}}else return _0x15dd58(_0x5b6d45);}function timelyDecrypt(_0xcc45b4,_0x29c2bd=!![]){const _0x34497e=_0x3556f9;if(_0xcc45b4)try{const _0x3c58a6=crypt[_0x34497e(0x107)](secure[_0x34497e(0x1d6)],_0xcc45b4)[_0x34497e(0x105)],_0x3f83fc=_0x3c58a6[_0x34497e(0xa8)]('@')[0x0],_0x279394=_0x3c58a6[_0x34497e(0xa8)]('@')[0x1],_0xd9b5d5=new Date()[_0x34497e(0x199)]();if(_0x29c2bd){if(_0xd9b5d5-_0x279394<maxSecretAge*0x3e8)return _0x3f83fc;else return![];}else return _0x3f83fc;}catch(_0x5343e5){return![];}else return![];}const validToken=(_0x1f5478,_0x213393)=>{const _0x553fd1=_0x3556f9,_0x40299a=devices[_0x213393]['ip'];if(!_0x1f5478)return{'error':_0x553fd1(0xfb)};for(let _0x21d1eb of blacklist){if(_0x21d1eb[_0x553fd1(0x1dc)]==_0x1f5478)return{'error':_0x553fd1(0xb4)};}let _0x3a288d;try{_0x3a288d=jwt['verify'](_0x1f5478,secure[_0x553fd1(0x1db)]+_0x213393);}catch{return{'error':_0x553fd1(0x182)};}if(!_0x3a288d[_0x553fd1(0x114)](_0x553fd1(0x14f))&&!_0x3a288d[_0x553fd1(0x114)](_0x553fd1(0x169))||!_0x3a288d['hasOwnProperty'](_0x553fd1(0x170)))return{'error':_0x553fd1(0x1ee)};if(!_0x3a288d[_0x553fd1(0x114)](_0x553fd1(0x169))&&_0x3a288d['hasOwnProperty']('clientip')){const {clientip:_0x2cdacc}=_0x3a288d;return _0x40299a==_0x2cdacc?{'success':_0x553fd1(0x1da)}:{'error':_0x553fd1(0x16d)};}else{if(_0x3a288d[_0x553fd1(0x114)](_0x553fd1(0x169))&&_0x3a288d[_0x553fd1(0x114)](_0x553fd1(0x14f))){const {username:_0x5635d1,clientip:_0x5b605f}=_0x3a288d;return settings['bbUsername']==_0x5635d1&&_0x40299a==_0x5b605f?{'success':_0x553fd1(0x1da)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xfb7d58=>{const _0x6ca790=_0x3556f9;if(_0xfb7d58){const _0xd11e34=devices[_0xfb7d58]['ip'];return jwt[_0x6ca790(0x118)]({'username':settings[_0x6ca790(0x16c)],'clientip':_0xd11e34},secure[_0x6ca790(0x1db)]+_0xfb7d58,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x503488=>{const _0x367226=_0x3556f9;if(_0x503488){const _0x5d3ede=devices[_0x503488]['ip'];return jwt[_0x367226(0x118)]({'clientip':_0x5d3ede},secure[_0x367226(0x1db)]+_0x503488,{'expiresIn':devices[_0x503488][_0x367226(0x108)][_0x367226(0x126)]*0x3c});}else return![];},telegramIpApproved=_0x360c4e=>{const _0x11a6cc=_0x3556f9;let _0x392204=![];return devices[_0x360c4e][_0x11a6cc(0x108)]&&devices[_0x360c4e]['telegramIpApproval'][_0x11a6cc(0x126)]!=_0x11a6cc(0x1ae)&&(_0x392204=devices[_0x360c4e]['telegramIpApproval'][_0x11a6cc(0x14f)]==devices[_0x360c4e]['ip']&&new Date()[_0x11a6cc(0x199)]()-devices[_0x360c4e][_0x11a6cc(0x108)][_0x11a6cc(0x1b9)]<devices[_0x360c4e][_0x11a6cc(0x108)]['expiry']*0x3c*0x3e8),_0x392204;},telegram2FaApproved=_0x7aca06=>{const _0x3a42f3=_0x3556f9;let _0x4589d7=![];return devices[_0x7aca06]['telegram2FaApproval']&&devices[_0x7aca06]['telegram2FaApproval']['expiry']!=_0x3a42f3(0x1ae)&&(_0x4589d7=devices[_0x7aca06][_0x3a42f3(0x131)][_0x3a42f3(0x14f)]==devices[_0x7aca06]['ip']&&new Date()['getTime']()-devices[_0x7aca06][_0x3a42f3(0x131)][_0x3a42f3(0x1b9)]<devices[_0x7aca06][_0x3a42f3(0x131)][_0x3a42f3(0x126)]*0x3c*0x3e8),_0x4589d7;},normalizeIP=_0xe397e3=>{const _0x35d7bf=_0x3556f9;let _0x142836=null,_0x22455b=null;if(ipaddr['isValid'](_0xe397e3)){const _0x524d89=ipaddr[_0x35d7bf(0xf7)](_0xe397e3);_0x524d89[_0x35d7bf(0x1c5)]()===_0x35d7bf(0xa9)?(_0x524d89['isIPv4MappedAddress']()&&(_0x142836=_0x524d89['toIPv4Address']()['toString']()),_0x22455b=_0x524d89[_0x35d7bf(0x136)]()):(_0x142836=_0x524d89[_0x35d7bf(0x136)](),_0x22455b=_0x524d89[_0x35d7bf(0xb1)]()['toString']());}return{'show':_0x142836?_0x142836:_0x22455b,'store':_0x22455b};};