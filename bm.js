const _0xebe72d=_0x2b9f;(function(_0x18a322,_0x2fd8c2){const _0x141cd1=_0x2b9f,_0x270747=_0x18a322();while(!![]){try{const _0x461048=parseInt(_0x141cd1(0x286))/0x1*(-parseInt(_0x141cd1(0x203))/0x2)+parseInt(_0x141cd1(0x238))/0x3*(parseInt(_0x141cd1(0x184))/0x4)+-parseInt(_0x141cd1(0x2c9))/0x5+-parseInt(_0x141cd1(0x2b1))/0x6*(-parseInt(_0x141cd1(0x2cc))/0x7)+parseInt(_0x141cd1(0x225))/0x8*(parseInt(_0x141cd1(0x167))/0x9)+parseInt(_0x141cd1(0x2a1))/0xa*(-parseInt(_0x141cd1(0x2b3))/0xb)+parseInt(_0x141cd1(0x234))/0xc;if(_0x461048===_0x2fd8c2)break;else _0x270747['push'](_0x270747['shift']());}catch(_0x4b169e){_0x270747['push'](_0x270747['shift']());}}}(_0x45de,0xa494e));const _0x2440bc=function(){let _0x2e4978=!![];return function(_0x4e1228,_0x5e8a85){const _0x4362a1=_0x2e4978?function(){const _0x4cc0df=_0x2b9f;if(_0x5e8a85){const _0x2c5396=_0x5e8a85[_0x4cc0df(0x1d3)](_0x4e1228,arguments);return _0x5e8a85=null,_0x2c5396;}}:function(){};return _0x2e4978=![],_0x4362a1;};}(),_0x46d3b9=_0x2440bc(this,function(){const _0x414509=_0x2b9f;return _0x46d3b9['toString']()[_0x414509(0x1a7)](_0x414509(0x2af))[_0x414509(0x1ff)]()[_0x414509(0x127)](_0x46d3b9)[_0x414509(0x1a7)](_0x414509(0x2af));});_0x46d3b9();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0xebe72d(0x1f9)),low=require(_0xebe72d(0x22b)),FileSync=require(_0xebe72d(0x1d4)),path=require(_0xebe72d(0x104)),crypto=require('crypto'),Crypt=require(_0xebe72d(0x163))[_0xebe72d(0x118)],RSA=require(_0xebe72d(0x163))[_0xebe72d(0x1bf)],bcrypt=require(_0xebe72d(0x22a)),jwt=require(_0xebe72d(0x139)),ipaddr=require(_0xebe72d(0x18f)),argv=require('yargs/yargs')(process['argv']['slice'](0x2))['argv'],uuidRandom=require(_0xebe72d(0x2c1)),TelegramBot=require(_0xebe72d(0x19f)),Mixpanel=require(_0xebe72d(0x272)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0xebe72d(0x274)),fileUpload=require(_0xebe72d(0x160)),{networkInterfaces}=require('os'),PORT=argv[_0xebe72d(0x228)]||_0xebe72d(0x12e),pattern=/^[0-9]{2,4}$/;!pattern[_0xebe72d(0x111)](PORT)&&(console[_0xebe72d(0x1c8)](_0xebe72d(0x162)+PORT+_0xebe72d(0x1ca)),process[_0xebe72d(0x17c)](0x1));const HOST=argv['host']||null,userID=argv[_0xebe72d(0x1bc)]||'',debugging=argv['d']||![],nodeversion=process[_0xebe72d(0x102)][_0xebe72d(0x2d7)];let bbpath=_0xebe72d(0x188),bbpath2='';const botfile=_0xebe72d(0x210),configfile=_0xebe72d(0x254),settingsfile='bb-settings.json',securefile=_0xebe72d(0x204),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xebe72d(0x268)),configpath=userID?bbpath+_0xebe72d(0x24c)+userID+'/':bbpath+_0xebe72d(0x24c),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0xebe72d(0x1c6)+userID+'/':bbpath+_0xebe72d(0x1c6),zippath=userID?bbpath+_0xebe72d(0x136)+userID+'/':bbpath+_0xebe72d(0x136),loggerfile=fs['createWriteStream'](logspath+_0xebe72d(0x1c7),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0xebe72d(0x18b);!fs[_0xebe72d(0x1e1)](configpath)&&fs['mkdirSync'](configpath);function _0x2b9f(_0x1aecfc,_0x1a4e42){const _0x753385=_0x45de();return _0x2b9f=function(_0x46d3b9,_0x2440bc){_0x46d3b9=_0x46d3b9-0xfa;let _0x45dec6=_0x753385[_0x46d3b9];return _0x45dec6;},_0x2b9f(_0x1aecfc,_0x1a4e42);}!fs[_0xebe72d(0x1e1)](configbackuppath)&&fs[_0xebe72d(0x27f)](configbackuppath);!fs[_0xebe72d(0x1e1)](logspath)&&fs[_0xebe72d(0x27f)](logspath);!fs[_0xebe72d(0x1e1)](zippath)&&fs[_0xebe72d(0x27f)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xebe72d(0x1fd)]({'bots':[]})[_0xebe72d(0x285)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xebe72d(0x1fd)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xebe72d(0x1fd)]({'secure':{},'blacklist':[]})[_0xebe72d(0x285)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0xebe72d(0x1da)});const saltRounds=0xa,mixpanel=Mixpanel[_0xebe72d(0x2a3)](_0xebe72d(0x176),{'host':_0xebe72d(0x291)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0xebe72d(0x155)]!=''&&settings['telegramUsername']&&settings[_0xebe72d(0x222)]!='')initTelegram();const parseColor=(_0x19cd76,_0x468965)=>{const _0x1c1b28=_0xebe72d,_0x5ea940=/#[A-Z]{3}#/g;if(typeof _0x19cd76==_0x1c1b28(0x244)){!_0x468965?_0x19cd76=_0x19cd76[_0x1c1b28(0x1f7)](_0x5ea940,''):(_0x19cd76=_0x19cd76['replace'](/#BLU#/g,_0x1c1b28(0x2a8)),_0x19cd76=_0x19cd76[_0x1c1b28(0x1f7)](/#RED#/g,'\x1b[31m'),_0x19cd76=_0x19cd76[_0x1c1b28(0x1f7)](/#YEL#/g,_0x1c1b28(0x191)),_0x19cd76=_0x19cd76[_0x1c1b28(0x1f7)](/#MAG#/g,_0x1c1b28(0x264)),_0x19cd76=_0x19cd76['replace'](/#CYA#/g,_0x1c1b28(0x2ba)),_0x19cd76=_0x19cd76[_0x1c1b28(0x1f7)](/#RES#/g,_0x1c1b28(0x1b2)));;}return _0x19cd76;},logger={'screen':_0x257196=>{const _0x118b63=_0xebe72d;console[_0x118b63(0x1c8)](parseColor(_0x257196,!![]));},'simple':_0x186e90=>{const _0x1638b4=_0xebe72d;console[_0x1638b4(0x1c8)](parseColor(_0x186e90,!![])),loggerfile[_0x1638b4(0x285)](util[_0x1638b4(0x14b)](parseColor(_0x186e90,![]))+'\x0a');},'full':async _0x3366d3=>{const _0x341c9c=_0xebe72d,_0x2d57e5=getTimeStamp()+_0x341c9c(0x16e)+_0x3366d3;console['log'](parseColor(_0x2d57e5,!![])),loggerfile[_0x341c9c(0x285)](util[_0x341c9c(0x14b)](parseColor(_0x2d57e5,![]))+'\x0a');if(tgBot&&settings[_0x341c9c(0x263)]&&settings[_0x341c9c(0x21b)]!='orders')await tgBot[_0x341c9c(0x24a)](settings[_0x341c9c(0x263)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x3366d3,![]))[_0x341c9c(0x231)](_0x51161a=>{telegramError(_0x51161a);});},'debug':async(_0x5bea4d,_0x1ec83b='')=>{const _0xfbca45=_0xebe72d,_0x540143=getTimeStamp()+_0xfbca45(0x132)+_0x5bea4d;if(debugging)console[_0xfbca45(0x1c8)](parseColor(_0x540143,!![]));loggerfile[_0xfbca45(0x285)](util['format'](parseColor(_0x540143,![]))+'\x0a');if(_0x1ec83b){if(debugging)console[_0xfbca45(0x1c8)](_0x1ec83b);loggerfile[_0xfbca45(0x285)](util['format'](_0x1ec83b)+'\x0a');}}};process['on'](_0xebe72d(0x20b),function(_0x23874c){logger['simple'](_0x23874c);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xebe72d(0x129))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xebe72d(0x224)),app=express(),http=require('http')[_0xebe72d(0x1ec)](app);app[_0xebe72d(0x1b6)](fileUpload({'useTempFiles':!![]})),app[_0xebe72d(0x10c)](_0xebe72d(0x24d),async(_0x191e9a,_0x93a51c)=>{const _0x1d8e9e=_0xebe72d,_0x1e23e3=_0x191e9a[_0x1d8e9e(0x29d)]['type'],_0x5462b3=getClientsWithBotID(_0x1d8e9e(0x213)),_0x1a4135=_0x191e9a[_0x1d8e9e(0x15c)][_0x1d8e9e(0x113)],_0x122d54=timelyDecrypt(_0x1a4135,![]),_0x1f6e63=_0x5462b3[_0x1d8e9e(0x265)](_0x5b597e=>_0x5b597e[_0x1d8e9e(0x113)]==_0x122d54);if(_0x1f6e63){const _0x38441b=normalizeIP(_0x191e9a[_0x1d8e9e(0x2bf)][_0x1d8e9e(0x18a)])[_0x1d8e9e(0x26b)],_0x555965=_0x191e9a[_0x1d8e9e(0x15c)][_0x1d8e9e(0x25f)];if(validateAccess(_0x555965,_0x122d54,_0x38441b)[_0x1d8e9e(0x205)])_0x1e23e3==_0x1d8e9e(0x2b2)&&await backupConfigFiles(),await zipFiles(_0x1e23e3),_0x93a51c['download'](zippath+(_0x1e23e3+_0x1d8e9e(0x239)),_0x5975f7=>{const _0x28bfa0=_0x1d8e9e;_0x5975f7&&(logger[_0x28bfa0(0x1ab)]('Failed\x20to\x20download\x20'+_0x1e23e3),logger['simple'](_0x5975f7));});else logger[_0x1d8e9e(0x1ab)](_0x1d8e9e(0x212)+_0x1e23e3+_0x1d8e9e(0x196));}else logger[_0x1d8e9e(0x1ab)](_0x1d8e9e(0x212)+_0x1e23e3+'\x20(2)');}),app[_0xebe72d(0x275)](_0xebe72d(0x158),async(_0x1a1b20,_0x5e7c14)=>{const _0x5ad3a8=_0xebe72d,_0x2eea17=getClientsWithBotID(_0x5ad3a8(0x213)),_0x2b8b38=_0x1a1b20[_0x5ad3a8(0x15c)]['uuid'],_0x4ff6e8=timelyDecrypt(_0x2b8b38,![]),_0x5a30ac=_0x2eea17[_0x5ad3a8(0x265)](_0x5637c0=>_0x5637c0['uuid']==_0x4ff6e8);logger[_0x5ad3a8(0x23d)](_0x5ad3a8(0x1e9));if(_0x5a30ac){const _0x105249=normalizeIP(_0x1a1b20[_0x5ad3a8(0x2bf)][_0x5ad3a8(0x18a)])[_0x5ad3a8(0x26b)],_0x449389=_0x1a1b20['headers'][_0x5ad3a8(0x25f)];if(validateAccess(_0x449389,_0x4ff6e8,_0x105249)[_0x5ad3a8(0x205)]){if(_0x1a1b20[_0x5ad3a8(0x1f2)]){const _0x423ea9=_0x1a1b20[_0x5ad3a8(0x1f2)][_0x5ad3a8(0x153)];await _0x423ea9['mv'](temppath+_0x423ea9[_0x5ad3a8(0x1ef)]),_0x5e7c14[_0x5ad3a8(0x19e)]({'status':!![],'message':_0x5ad3a8(0x1d1)});const _0x2a3c98=getBotsWithMode();_0x2a3c98['length']>0x0?confirmRestore(temppath,_0x423ea9['name']):unzipFile(temppath,_0x423ea9[_0x5ad3a8(0x1ef)]);}}else logger[_0x5ad3a8(0x1ab)](_0x5ad3a8(0x10b));}else logger[_0x5ad3a8(0x1ab)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0xebe72d(0x1b6)](express['static'](path[_0xebe72d(0x201)](__dirname,bbpath2,_0xebe72d(0x1a9)))),app['use'](express['static'](path[_0xebe72d(0x201)](__dirname,bbpath2,_0xebe72d(0x2c0)))),app['get']('/',function(_0x703881,_0x1c88ec){const _0x49dfef=_0xebe72d;_0x1c88ec[_0x49dfef(0x1d6)](path[_0x49dfef(0x201)](__dirname,bbpath2,_0x49dfef(0x1a9),_0x49dfef(0x185)));}),app['get'](_0xebe72d(0x2b8),function(_0x5ea8d6,_0x5e5655){const _0x4278a1=_0xebe72d;_0x5e5655[_0x4278a1(0x1d6)](path['join'](__dirname,bbpath2,_0x4278a1(0x2c0),_0x4278a1(0x185)));}),app[_0xebe72d(0x10c)](_0xebe72d(0x208),(_0x5432b2,_0x377ffa)=>{const _0xa0ab0a=_0xebe72d;_0x377ffa[_0xa0ab0a(0x1d6)](path['join'](__dirname,bbpath2,_0xa0ab0a(0x2c0),_0xa0ab0a(0x185)));}),app[_0xebe72d(0x10c)]('/:bot/performance',(_0x443f57,_0x3fa6ac)=>{const _0x3b9fc8=_0xebe72d;_0x3fa6ac[_0x3b9fc8(0x1d6)](path[_0x3b9fc8(0x201)](__dirname,bbpath2,'build',_0x3b9fc8(0x185)));}),app[_0xebe72d(0x10c)]('/:bot/coins',(_0x2c9a94,_0x412580)=>{const _0xf3eb7c=_0xebe72d;_0x412580[_0xf3eb7c(0x1d6)](path[_0xf3eb7c(0x201)](__dirname,bbpath2,_0xf3eb7c(0x2c0),'index.html'));}),app[_0xebe72d(0x10c)]('/:bot/history',(_0x4f6603,_0x4e7453)=>{const _0x21b76c=_0xebe72d;_0x4e7453[_0x21b76c(0x1d6)](path[_0x21b76c(0x201)](__dirname,bbpath2,_0x21b76c(0x2c0),_0x21b76c(0x185)));}),app[_0xebe72d(0x10c)](_0xebe72d(0x114),(_0x3384fa,_0x28cffe)=>{const _0xe17e4=_0xebe72d;_0x28cffe[_0xe17e4(0x1d6)](path[_0xe17e4(0x201)](__dirname,bbpath2,_0xe17e4(0x2c0),_0xe17e4(0x185)));}),app['get']('/:bot/support',(_0x5863b8,_0x241613)=>{const _0x53820b=_0xebe72d;_0x241613[_0x53820b(0x1d6)](path[_0x53820b(0x201)](__dirname,bbpath2,_0x53820b(0x2c0),_0x53820b(0x185)));});if(HOST)http['listen'](PORT,HOST);else http[_0xebe72d(0x17b)](PORT);const io=require(_0xebe72d(0x217))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x425757=_0xebe72d;let _0x58c5dc=_0x425757(0x16b);const _0x2b0c5f=networkInterfaces(),_0x3d8d9b={};for(const _0x47f8ff of Object[_0x425757(0x156)](_0x2b0c5f)){for(const _0xfedba7 of _0x2b0c5f[_0x47f8ff]){if((_0xfedba7[_0x425757(0x227)]==_0x425757(0x15b)||_0xfedba7[_0x425757(0x227)]==0x4)&&!_0xfedba7[_0x425757(0x125)]){const _0x4ebfbf=ipaddr['parse'](_0xfedba7['address'])['range']();_0x4ebfbf!='private'&&(!_0x3d8d9b[_0x47f8ff]&&(_0x3d8d9b[_0x47f8ff]=[]),_0x3d8d9b[_0x47f8ff]['push'](_0xfedba7['address']),_0x58c5dc=_0xfedba7['address']);}}}return{'serverip':_0x58c5dc,'netinterfaces':_0x3d8d9b};}async function startServer(){const _0x23847e=_0xebe72d,{serverip:_0x557f49,netinterfaces:_0x58483c}=getServerIP();logger[_0x23847e(0x1aa)](''),logger[_0x23847e(0x1aa)](_0x23847e(0x258)),await logger[_0x23847e(0x1ab)](_0x23847e(0x220)+serverversion+'#RES#\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x23847e(0x1ce)+_0x557f49+':'+PORT+_0x23847e(0x292))),logger[_0x23847e(0x1aa)]('-----------------------------------------------------------------------------------');if(config[_0x23847e(0x10a)]!=0x0)for(const _0x33c113 of config){if(_0x33c113[_0x23847e(0x1d2)]==_0x23847e(0x287)||_0x33c113[_0x23847e(0x1d2)]=='new')await logger[_0x23847e(0x1ab)](_0x23847e(0x25e)+_0x33c113[_0x23847e(0x18e)]+_0x23847e(0x1d8)+_0x33c113['botname']),startBot([_0x33c113[_0x23847e(0x18e)],userID],{'cwd':bbpath},function(_0x38b846){if(_0x38b846)logger['full'](_0x38b846);});else(_0x33c113[_0x23847e(0x1d2)]==_0x23847e(0x290)||_0x33c113['status']=='new-disabled')&&await logger[_0x23847e(0x1ab)](_0x23847e(0x28e)+_0x33c113[_0x23847e(0x18e)]+_0x23847e(0x1d8)+_0x33c113['botname']);}else!newBot&&logger[_0x23847e(0x1aa)](_0x23847e(0x13b));if(newBot)addBot();logger[_0x23847e(0x1aa)](_0x23847e(0x258)),logger[_0x23847e(0x1aa)](''),await logger[_0x23847e(0x23d)](_0x23847e(0x1e4)+nodeversion),await logger['debug'](_0x23847e(0x2ae),_0x58483c);}function startSocket(){const _0x14cebe=_0xebe72d;io['on'](_0x14cebe(0x2be),_0x214c45=>{const _0x2d6b7e=_0x14cebe;let _0x5aabbd,_0x20f1e6,_0x13389,_0x46ef15,_0x5a325b;const _0x42df5f=_0x214c45[_0x2d6b7e(0x131)][_0x2d6b7e(0x15c)][_0x2d6b7e(0x1f6)];_0x20f1e6=_0x42df5f[_0x2d6b7e(0x1a0)](/bot[0-9]{3}/);if(_0x20f1e6)_0x13389=_0x20f1e6[0x0][_0x2d6b7e(0x1a0)](/[0-9]{3}/);if(_0x13389)_0x5aabbd=_0x13389[0x0];else _0x5aabbd=_0x2d6b7e(0x213);const _0x4b5d3e=_0x214c45['handshake'][_0x2d6b7e(0x211)][_0x2d6b7e(0x2b4)];if(!_0x4b5d3e)_0x214c45['emit'](_0x2d6b7e(0x1d2),{'publicKey':secure[_0x2d6b7e(0x29a)]});else{_0x46ef15=timelyDecrypt(_0x4b5d3e,![]);if(!_0x46ef15)_0x214c45[_0x2d6b7e(0x106)](_0x2d6b7e(0x1d2),{'publicKey':secure[_0x2d6b7e(0x29a)]});else{_0x5a325b=normalizeIP(_0x214c45[_0x2d6b7e(0x1dc)][_0x2d6b7e(0x18a)])[_0x2d6b7e(0x26b)];if(!devices[_0x46ef15])devices[_0x46ef15]={'uuid':_0x46ef15,'access':{'token':null}};devices[_0x46ef15]['ip']=_0x5a325b;const _0x537280=addClient(_0x214c45['id'],_0x46ef15,_0x5aabbd);setAccess(_0x537280),emitMessages(),_0x214c45['on'](_0x2d6b7e(0xfb),_0x5f033f=>{const _0x4b29e9=_0x2d6b7e,_0x397b88=timelyDecrypt(_0x5f033f[_0x4b29e9(0x27e)]);if(_0x397b88){_0x5f033f={'username':_0x5f033f[_0x4b29e9(0x280)],'password':_0x397b88},devices[_0x46ef15][_0x4b29e9(0x2d1)]=validateCredentials(_0x5f033f,_0x46ef15);if(devices[_0x46ef15][_0x4b29e9(0x2d1)][_0x4b29e9(0x205)]==![]&&devices[_0x46ef15][_0x4b29e9(0x2d1)]['reason']==_0x4b29e9(0x1eb))_0x214c45[_0x4b29e9(0x106)](_0x4b29e9(0x1d2),{'access':devices[_0x46ef15][_0x4b29e9(0x2d1)]}),loginAccess2FA(_0x46ef15,_0x5a325b);else{if(devices[_0x46ef15]['access'][_0x4b29e9(0x205)]==![]&&devices[_0x46ef15][_0x4b29e9(0x2d1)][_0x4b29e9(0x255)]==_0x4b29e9(0x298))_0x214c45[_0x4b29e9(0x106)](_0x4b29e9(0x1d2),{'access':devices[_0x46ef15][_0x4b29e9(0x2d1)]});else devices[_0x46ef15][_0x4b29e9(0x2d1)][_0x4b29e9(0x205)]&&devices[_0x46ef15][_0x4b29e9(0x2d1)][_0x4b29e9(0x255)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x46ef15)[_0x4b29e9(0x179)](_0x4b2d02=>{setAccess(_0x4b2d02);}),logger[_0x4b29e9(0x23d)](_0x4b29e9(0x1f1)+_0x46ef15[_0x4b29e9(0x190)](-0x8)),setTokenRefresh(_0x46ef15),setSessionTimeout(_0x4b29e9(0xfb),_0x46ef15));}}else logger[_0x4b29e9(0x1ab)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x214c45['on']('reset-password',()=>{resetPassword();}),_0x214c45['on'](_0x2d6b7e(0x150),_0x522570=>{removeClient(_0x214c45['id']);}),_0x5aabbd==_0x2d6b7e(0x213)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x224bce){const _0x243a4f=_0xebe72d;if(_0x224bce!=_0x243a4f(0x213)&&config[_0x243a4f(0x120)]!=''){if(pid[_0x224bce])pid[_0x224bce][_0x243a4f(0x19e)]({'function':'initclient','args':null});}_0x224bce!=_0x243a4f(0x213)&&broadcastToBots(_0x243a4f(0x2a6),JSON[_0x243a4f(0x1a5)](config));}function reloadBotManager(){const _0x3226d7=_0xebe72d;getClientsWithBotID(_0x3226d7(0x213))[_0x3226d7(0x179)](_0x481d4b=>{const _0x58824f=_0x3226d7;getSocket(_0x481d4b['id'])[_0x58824f(0x106)](_0x58824f(0x1d2),{'access':{'allow':![],'reason':_0x58824f(0x170),'token':null}});});}function getSocket(_0x36f5b1){const _0x58b57d=_0xebe72d;return io[_0x58b57d(0x2cb)][_0x58b57d(0x2cb)][_0x58b57d(0x10c)](_0x36f5b1);}function setAccess(_0x4faf60){const _0x4432a9=_0xebe72d,_0xe9745f=getSocket(_0x4faf60['id']),_0x1d40ab=_0x4faf60[_0x4432a9(0x113)],_0x58dcfa=_0x4faf60['bot'];devices[_0x1d40ab][_0x4432a9(0x2d1)]=validateAccess(devices[_0x1d40ab][_0x4432a9(0x2d1)][_0x4432a9(0x1b4)],_0x1d40ab),logger[_0x4432a9(0x23d)](_0x4432a9(0x289)+devices[_0x1d40ab][_0x4432a9(0x2d1)][_0x4432a9(0x255)]+_0x4432a9(0x20c)+_0x4faf60['id'][_0x4432a9(0x190)](-0x8)+_0x4432a9(0x279)+_0x1d40ab[_0x4432a9(0x190)](-0x8)),_0xe9745f[_0x4432a9(0x201)](_0x1d40ab);if(devices[_0x1d40ab][_0x4432a9(0x2d1)][_0x4432a9(0x205)]){_0xe9745f[_0x4432a9(0x201)](_0x58dcfa);if(_0x58dcfa==_0x4432a9(0x213))initializeSocketBotManager(_0xe9745f);else initializeSocketBot(_0xe9745f);initClient(_0x58dcfa);}devices[_0x1d40ab][_0x4432a9(0x2d1)][_0x4432a9(0x1b4)]&&devices[_0x1d40ab][_0x4432a9(0x2d1)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x1d40ab),devices[_0x1d40ab][_0x4432a9(0x2d1)]['token']&&devices[_0x1d40ab][_0x4432a9(0x2d1)][_0x4432a9(0x255)]==_0x4432a9(0x20d)&&setSessionTimeout(_0x4432a9(0xfb),_0x1d40ab),_0xe9745f[_0x4432a9(0x106)](_0x4432a9(0x1d2),{'status':_0x4faf60[_0x4432a9(0x13d)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1d40ab][_0x4432a9(0x2d1)],'externalip':devices[_0x1d40ab]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x4432a9(0x141)],'validInstallation':validInstallation}),devices[_0x1d40ab]['access'][_0x4432a9(0x205)]==![]&&devices[_0x1d40ab]['access'][_0x4432a9(0x255)]==_0x4432a9(0x262)&&temporaryAccess2FA(_0x1d40ab,devices[_0x1d40ab]['ip']);}function setSessionTimeout(_0x20f9a2,_0x598d3b){const _0x2437a8=_0xebe72d;let _0x2efdff;if(_0x20f9a2==_0x2437a8(0xfb))_0x2efdff=loginExpiry*0x3c*0x3e8;else _0x2efdff=devices[_0x598d3b][_0x2437a8(0x1cc)][_0x2437a8(0x126)]*0x3c*0x3e8-(new Date()[_0x2437a8(0x2bd)]()-devices[_0x598d3b]['telegramIpApproval'][_0x2437a8(0x214)]);if(devices[_0x598d3b]['pidExpireLogin'])clearTimeout(devices[_0x598d3b][_0x2437a8(0x1c0)]);devices[_0x598d3b][_0x2437a8(0x1c0)]=setTimeout(()=>{const _0x6978d1=_0x2437a8;if(devices[_0x598d3b][_0x6978d1(0x2bb)])clearTimeout(devices[_0x598d3b][_0x6978d1(0x2bb)]);removeSocketListeners(_0x598d3b),addBlacklist(_0x598d3b),devices[_0x598d3b]['telegramIpApproval']=null,devices[_0x598d3b][_0x6978d1(0x2c8)]=null,devices[_0x598d3b][_0x6978d1(0x2d1)]['token']=null,logger[_0x6978d1(0x23d)](_0x6978d1(0x159)+_0x598d3b['slice'](-0x8)),devices[_0x598d3b][_0x6978d1(0x2d1)]=validateAccess(devices[_0x598d3b][_0x6978d1(0x2d1)][_0x6978d1(0x1b4)],_0x598d3b),!(devices[_0x598d3b]['access'][_0x6978d1(0x205)]&&devices[_0x598d3b][_0x6978d1(0x2d1)]['reason']==_0x6978d1(0x1ba))&&(_0x20f9a2==_0x6978d1(0xfb)?io['to'](_0x598d3b)[_0x6978d1(0x106)]('status',{'access':{'allow':![],'reason':_0x6978d1(0x282),'token':null}}):io['to'](_0x598d3b)[_0x6978d1(0x106)](_0x6978d1(0x1d2),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x598d3b]['access'][_0x6978d1(0x1b4)]=null;},_0x2efdff);}function setTokenRefresh(_0x1a4e16){const _0x161bcb=_0xebe72d;if(devices[_0x1a4e16][_0x161bcb(0x2bb)])clearTimeout(devices[_0x1a4e16]['pidRefreshToken']);devices[_0x1a4e16][_0x161bcb(0x2bb)]=setTimeout(()=>{const _0x53637a=_0x161bcb;getClientsWithUuid(_0x1a4e16)[_0x53637a(0x10a)]!=0x0?(devices[_0x1a4e16]['access']=refreshToken(_0x1a4e16),io['to'](_0x1a4e16)[_0x53637a(0x106)]('status',{'status':_0x53637a(0x174),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1a4e16][_0x53637a(0x2d1)],'externalip':devices[_0x1a4e16]['ip'],'publicKey':secure[_0x53637a(0x29a)],'validInstallation':validInstallation}),setTokenRefresh(_0x1a4e16)):clearTimeout(devices[_0x1a4e16][_0x53637a(0x2bb)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5ccf4b){const _0x3f6db9=_0xebe72d,_0x4168b4=getClient(_0x5ccf4b['id'])[_0x3f6db9(0x113)];_0x5ccf4b[_0x3f6db9(0x106)]('bots',config),_0x5ccf4b[_0x3f6db9(0x106)](_0x3f6db9(0x243),cleanSettings()),_0x5ccf4b['on'](_0x3f6db9(0x233),_0x52a7a5=>{const _0x512cc1=_0x3f6db9;if(validateAccess(_0x52a7a5,_0x4168b4)['allow'])addBot();else logger['full'](_0x512cc1(0x256));}),_0x5ccf4b['on'](_0x3f6db9(0x148),(_0x4bd8c8,_0x183d35)=>{const _0xa38428=_0x3f6db9;if(validateAccess(_0x183d35,_0x4168b4)[_0xa38428(0x205)])toggleBot(_0x4bd8c8['botID'],_0x4bd8c8['status'],_0x4bd8c8['live']);else logger[_0xa38428(0x1ab)](_0xa38428(0x1bd));}),_0x5ccf4b['on'](_0x3f6db9(0x142),(_0x337164,_0x751b3a)=>{const _0x390972=_0x3f6db9;if(validateAccess(_0x751b3a,_0x4168b4)[_0x390972(0x205)])toggleBotMode(_0x337164);else logger[_0x390972(0x1ab)](_0x390972(0x1bd));}),_0x5ccf4b['on']('delete-bot',(_0x209870,_0x1ea120)=>{const _0x535e7b=_0x3f6db9;if(validateAccess(_0x1ea120,_0x4168b4)[_0x535e7b(0x205)])deleteBot(_0x209870);else logger[_0x535e7b(0x1ab)](_0x535e7b(0x2d4));}),_0x5ccf4b['on']('store-settings',(_0x184277,_0x549419)=>{const _0x1a6402=_0x3f6db9;if(validateAccess(_0x549419,_0x4168b4)[_0x1a6402(0x205)])storeSettings(_0x184277,!![]);else logger[_0x1a6402(0x1ab)](_0x1a6402(0x186));}),_0x5ccf4b['on']('update-bb',_0x32e6ff=>{const _0x59c442=_0x3f6db9;if(validateAccess(_0x32e6ff,_0x4168b4)['allow'])updateBB(_0x59c442(0x2c2));else logger[_0x59c442(0x1ab)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5ccf4b['on'](_0x3f6db9(0x25d),_0x4ce638=>{const _0x45d355=_0x3f6db9;if(validateAccess(_0x4ce638,_0x4168b4)[_0x45d355(0x205)])updateBB(_0x45d355(0x165));else logger[_0x45d355(0x1ab)](_0x45d355(0x17d));}),_0x5ccf4b['on'](_0x3f6db9(0x13e),_0x3f6f93=>{const _0x4b1179=_0x3f6db9;if(validateAccess(_0x3f6f93,_0x4168b4)['allow']){const _0x1e650d=getClient(_0x5ccf4b['id']);if(_0x1e650d)getBackupFiles(_0x1e650d[_0x4b1179(0x113)]);else logger[_0x4b1179(0x1ab)](_0x4b1179(0x1b8));}else logger[_0x4b1179(0x1ab)](_0x4b1179(0x164));}),_0x5ccf4b['on'](_0x3f6db9(0x161),(_0x31d008,_0x239045)=>{const _0x2e1fb4=_0x3f6db9;if(validateAccess(_0x239045,_0x4168b4)[_0x2e1fb4(0x205)])restoreBackupFile(_0x31d008);else logger[_0x2e1fb4(0x1ab)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5ccf4b['on'](_0x3f6db9(0x171),_0x1b1623=>{const _0x56c6ec=_0x3f6db9;if(validateAccess(_0x1b1623,_0x4168b4)['allow'])getMessages();else logger[_0x56c6ec(0x1ab)](_0x56c6ec(0x251));}),_0x5ccf4b['on']('confirm-message',(_0x2ff7e5,_0x4a07f9)=>{const _0x546c8d=_0x3f6db9;if(validateAccess(_0x4a07f9,_0x4168b4)[_0x546c8d(0x205)])confirmMessage(_0x2ff7e5);else logger[_0x546c8d(0x1ab)](_0x546c8d(0x249));}),_0x5ccf4b['on'](_0x3f6db9(0x28c),_0x56d927=>{const _0x215fb5=_0x3f6db9;if(validateAccess(_0x56d927,_0x4168b4)[_0x215fb5(0x205)]){if(devices[_0x4168b4][_0x215fb5(0x2bb)])clearTimeout(devices[_0x4168b4]['pidRefreshToken']);if(devices[_0x4168b4]['pidExpireLogin'])clearTimeout(devices[_0x4168b4][_0x215fb5(0x1c0)]);removeSocketListeners(getClient(_0x5ccf4b['id'])[_0x215fb5(0x113)]),addBlacklist(_0x4168b4),devices[_0x4168b4][_0x215fb5(0x1cc)]=null,devices[_0x4168b4][_0x215fb5(0x2c8)]=null,devices[_0x4168b4][_0x215fb5(0x2d1)]['token']=null,logger[_0x215fb5(0x23d)]('Logged\x20out\x20user\x20...'+_0x4168b4[_0x215fb5(0x190)](-0x8)),io['to'](getClient(_0x5ccf4b['id'])[_0x215fb5(0x113)])['emit'](_0x215fb5(0x1d2),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x215fb5(0x1ab)](_0x215fb5(0x14e));});}function initializeSocketBot(_0x7d3385){const _0x1a9fd7=_0xebe72d,_0x380632=getClient(_0x7d3385['id'])['bot'],_0x47f63e=getClient(_0x7d3385['id'])[_0x1a9fd7(0x113)];_0x7d3385['on'](_0x1a9fd7(0x183),(_0x1e3f3f,_0x8c1692)=>{const _0x1c256f=_0x1a9fd7;if(validateAccess(_0x8c1692,_0x47f63e)['allow']){if(pid[_0x380632])pid[_0x380632][_0x1c256f(0x19e)]({'function':_0x1c256f(0x194),'args':_0x1e3f3f});}else logger[_0x1c256f(0x1ab)](_0x1c256f(0x172));}),_0x7d3385['on'](_0x1a9fd7(0x109),(_0x1944bd,_0x4a39f1)=>{const _0x1fc62f=_0x1a9fd7;if(validateAccess(_0x4a39f1,_0x47f63e)['allow']){if(pid[_0x380632])pid[_0x380632][_0x1fc62f(0x19e)]({'function':_0x1fc62f(0x18c),'args':_0x1944bd});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x7d3385['on'](_0x1a9fd7(0x19d),(_0x5b4bd7,_0x48e5e9)=>{const _0x2ba1bf=_0x1a9fd7;if(validateAccess(_0x48e5e9,_0x47f63e)[_0x2ba1bf(0x205)]){if(pid[_0x380632])pid[_0x380632][_0x2ba1bf(0x19e)]({'function':'getPortfolio','args':_0x5b4bd7});}else logger['full'](_0x2ba1bf(0x1e3));}),_0x7d3385['on'](_0x1a9fd7(0x21f),(_0xba5db5,_0x377eb6)=>{const _0x9eb54a=_0x1a9fd7;if(validateAccess(_0x377eb6,_0x47f63e)[_0x9eb54a(0x205)]){if(pid[_0x380632])pid[_0x380632][_0x9eb54a(0x19e)]({'function':_0x9eb54a(0x28b),'args':_0xba5db5});}else logger[_0x9eb54a(0x1ab)](_0x9eb54a(0x242));}),_0x7d3385['on'](_0x1a9fd7(0x206),(_0x28e3ae,_0xbef12d)=>{const _0x542c0a=_0x1a9fd7;if(validateAccess(_0xbef12d,_0x47f63e)['allow']){if(pid[_0x380632])pid[_0x380632][_0x542c0a(0x19e)]({'function':_0x542c0a(0x100),'args':_0x28e3ae});}else logger[_0x542c0a(0x1ab)](_0x542c0a(0x1af));}),_0x7d3385['on'](_0x1a9fd7(0x173),(_0x519726,_0x7f31f6)=>{const _0xc712a2=_0x1a9fd7;if(validateAccess(_0x7f31f6,_0x47f63e)['allow']){if(pid[_0x380632])pid[_0x380632][_0xc712a2(0x19e)]({'function':_0xc712a2(0x14c),'args':_0x519726});}else logger['full'](_0xc712a2(0x215));}),_0x7d3385['on'](_0x1a9fd7(0x229),_0x50d2f1=>{const _0x47deee=_0x1a9fd7;if(validateAccess(_0x50d2f1,_0x47f63e)[_0x47deee(0x205)]){if(pid[_0x380632])pid[_0x380632][_0x47deee(0x19e)]({'function':'resetHistory','args':null});}else logger[_0x47deee(0x1ab)](_0x47deee(0x19c));}),_0x7d3385['on'](_0x1a9fd7(0x27b),_0x27565b=>{const _0x562d14=_0x1a9fd7;if(validateAccess(_0x27565b,_0x47f63e)['allow']){if(pid[_0x380632])pid[_0x380632][_0x562d14(0x19e)]({'function':_0x562d14(0x13c),'args':null});}else logger[_0x562d14(0x1ab)](_0x562d14(0x21a));}),_0x7d3385['on'](_0x1a9fd7(0x1f4),(_0xbd7671,_0x15b599)=>{const _0x1e5686=_0x1a9fd7;if(validateAccess(_0x15b599,_0x47f63e)['allow']){if(pid[_0x380632])pid[_0x380632][_0x1e5686(0x19e)]({'function':_0x1e5686(0x1e5),'args':_0xbd7671});}else logger[_0x1e5686(0x1ab)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x7d3385['on'](_0x1a9fd7(0x128),_0x4572dc=>{const _0x58d1c1=_0x1a9fd7;if(validateAccess(_0x4572dc,_0x47f63e)[_0x58d1c1(0x205)]){if(pid[_0x380632])pid[_0x380632][_0x58d1c1(0x19e)]({'function':_0x58d1c1(0x261),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x7d3385['on'](_0x1a9fd7(0x271),_0x3d57d2=>{const _0x2be23b=_0x1a9fd7;if(validateAccess(_0x3d57d2,_0x47f63e)[_0x2be23b(0x205)]){if(pid[_0x380632])pid[_0x380632]['send']({'function':_0x2be23b(0x1ad),'args':null});}else logger[_0x2be23b(0x1ab)](_0x2be23b(0x177));}),_0x7d3385['on'](_0x1a9fd7(0x283),_0x55d28a=>{const _0x23d194=_0x1a9fd7;if(validateAccess(_0x55d28a,_0x47f63e)['allow'])updateBB(_0x23d194(0x2c2));else logger['full'](_0x23d194(0x25a));}),_0x7d3385['on']('get-messages',_0x3034e4=>{const _0x369580=_0x1a9fd7;if(validateAccess(_0x3034e4,_0x47f63e)['allow'])getMessages();else logger['full'](_0x369580(0x251));}),_0x7d3385['on']('confirm-message',(_0x2e4ddb,_0x3224a1)=>{const _0x51d3eb=_0x1a9fd7;if(validateAccess(_0x3224a1,_0x47f63e)[_0x51d3eb(0x205)])confirmMessage(_0x2e4ddb);else logger[_0x51d3eb(0x1ab)](_0x51d3eb(0x249));}),_0x7d3385['on'](_0x1a9fd7(0x28c),_0x2bb913=>{const _0xa8a922=_0x1a9fd7;if(validateAccess(_0x2bb913,_0x47f63e)[_0xa8a922(0x205)]){if(devices[_0x47f63e][_0xa8a922(0x2bb)])clearTimeout(devices[_0x47f63e][_0xa8a922(0x2bb)]);if(devices[_0x47f63e]['pidExpireLogin'])clearTimeout(devices[_0x47f63e][_0xa8a922(0x1c0)]);removeSocketListeners(getClient(_0x7d3385['id'])[_0xa8a922(0x113)]),addBlacklist(_0x47f63e),devices[_0x47f63e][_0xa8a922(0x1cc)]=null,devices[_0x47f63e]['telegram2FaApproval']=null,devices[_0x47f63e][_0xa8a922(0x2d1)]['token']=null,logger[_0xa8a922(0x23d)](_0xa8a922(0x154)+_0x47f63e[_0xa8a922(0x190)](-0x8)),io['to'](getClient(_0x7d3385['id'])[_0xa8a922(0x113)])['emit'](_0xa8a922(0x1d2),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0xa8a922(0x1ab)](_0xa8a922(0x14e));});}function removeSocketListeners(_0x519999){getClientsWithUuid(_0x519999)['forEach'](_0x39b7cf=>{const _0x14749b=_0x2b9f;getSocket(_0x39b7cf['id'])[_0x14749b(0x22c)]();});}function cleanSettings(){const _0x443767=_0xebe72d;let _0x4e5295=settings;return settings[_0x443767(0x155)]&&settings[_0x443767(0x155)]!=''&&(_0x4e5295={..._0x4e5295,'telegramToken':'************'}),settings[_0x443767(0x294)]&&settings['bbPassword']!=''&&(_0x4e5295={..._0x4e5295,'bbPassword':'************'}),(settings[_0x443767(0x294)]&&settings[_0x443767(0x294)]=='***'||settings[_0x443767(0x155)]&&settings[_0x443767(0x155)]==_0x443767(0x140))&&(_0x4e5295={..._0x4e5295,'restored':{'password':settings[_0x443767(0x294)]==_0x443767(0x140),'telegram':settings[_0x443767(0x155)]==_0x443767(0x140)}}),_0x4e5295;}async function updateBB(_0x438adf){const _0x3969e9=_0xebe72d;await backupConfigFiles(),installingUpdate=!![],config[_0x3969e9(0x179)](_0x4f87b3=>{const _0x41a6a9=_0x3969e9;restartBot(_0x4f87b3[_0x41a6a9(0x18e)]);}),logger[_0x3969e9(0x23d)](_0x3969e9(0x14a)+_0x438adf);if(_0x438adf==_0x3969e9(0x2c2))process[_0x3969e9(0x19e)]({'update':!![]},_0x42089f=>{});else _0x438adf=='reinstall'&&process[_0x3969e9(0x19e)]({'reinstall':!![]},_0x196abc=>{});}function startBot(_0x5b623e,_0x3195d4,_0x1ef7ad){const _0x2bdc3c=_0xebe72d;if(debugging)_0x5b623e[_0x2bdc3c(0x200)]('-d');let _0x5f5992=![];const _0x4e1b9f=_0x5b623e[0x0];_0x3195d4={..._0x3195d4,'stdio':['inherit','inherit',_0x2bdc3c(0x12d),'ipc']},pid[_0x4e1b9f]=childProcess[_0x2bdc3c(0x2c6)](botfile,_0x5b623e,_0x3195d4),pid[_0x4e1b9f]['on'](_0x2bdc3c(0x1d5),_0x4379a8=>{const _0x4eb2af=_0x2bdc3c;switch(Object[_0x4eb2af(0x156)](_0x4379a8)[0x0]){case _0x4eb2af(0x1c9):updateBotName(_0x4e1b9f,_0x4379a8[_0x4eb2af(0x1c9)]);break;case _0x4eb2af(0x192):updateBotManager();break;case _0x4eb2af(0x1d2):updateStatus(_0x4e1b9f,_0x4379a8[_0x4eb2af(0x1d2)]);break;case _0x4eb2af(0x21e):updateLive(_0x4e1b9f,_0x4379a8[_0x4eb2af(0x21e)]);break;case _0x4eb2af(0x221):updateLive(_0x4e1b9f,_0x4379a8['started']),io['to'](_0x4e1b9f)[_0x4eb2af(0x106)]('status',{'access':{'allow':![],'reason':_0x4eb2af(0x170),'token':null}});break;case _0x4eb2af(0x110):_0x4379a8[_0x4eb2af(0x110)]==_0x4eb2af(0x269)&&restartBot(_0x4e1b9f);_0x4379a8[_0x4eb2af(0x110)]=='kill'&&toggleBot(_0x4e1b9f,_0x4eb2af(0x290),_0x4eb2af(0x1b7));break;case'telegram':sendTelegram(_0x4e1b9f,_0x4379a8['telegram']);break;case _0x4eb2af(0x20e):sendTelegramMsg(_0x4379a8['telegrammsg']);break;case _0x4eb2af(0x1a4):io['to'](_0x4e1b9f)[_0x4eb2af(0x106)](_0x4379a8[_0x4eb2af(0x1a4)],_0x4379a8[_0x4eb2af(0x278)]);break;}}),pid[_0x4e1b9f]['on']('error',function(_0x1873a8){if(_0x5f5992)return;_0x5f5992=!![],_0x1ef7ad(_0x1873a8);}),pid[_0x4e1b9f]['on'](_0x2bdc3c(0x17c),async function(_0x524191){const _0x2b93a4=_0x2bdc3c;if(installingUpdate)return;if(_0x5f5992)return;_0x5f5992=!![],_0x1ef7ad(null);const _0x13cf7b=dbConfig[_0x2b93a4(0x10c)](_0x2b93a4(0x2a6))[_0x2b93a4(0x265)]({'botID':_0x4e1b9f})[_0x2b93a4(0x248)]();_0x13cf7b&&(_0x13cf7b[_0x2b93a4(0x1d2)]==_0x2b93a4(0x287)||_0x13cf7b[_0x2b93a4(0x1d2)]==_0x2b93a4(0x1c3))&&(await sleep(0x3e8),updateLive(_0x4e1b9f,'stopped'),logger[_0x2b93a4(0x1ab)]('Restarting\x20Bot\x20'+_0x4e1b9f),startBot([_0x4e1b9f,userID],{'cwd':bbpath},function(_0x58bf32){const _0x1c7036=_0x2b93a4;if(_0x58bf32)logger[_0x1c7036(0x1ab)](_0x58bf32);}));});}function stopBot(_0x36a569){const _0x4f329c=_0xebe72d;getClientsWithBotID(_0x36a569)[_0x4f329c(0x179)](_0x4ab6d2=>{const _0x5779d3=_0x4f329c;getSocket(_0x4ab6d2['id'])[_0x5779d3(0x150)](!![]),removeClient(_0x4ab6d2['id']);}),pid[_0x36a569]&&(pid[_0x36a569]['kill'](),pid[_0x36a569]=null);}function restartBot(_0x17353b){if(pid[_0x17353b])pid[_0x17353b]['kill']();}function addBot(){const _0x1c75fc=_0xebe72d;let _0x1215e3;for(let _0x3bbd32=0x1;_0x3bbd32<0x3e9;_0x3bbd32++){_0x1215e3=_0x3bbd32['toString']()[_0x1c75fc(0x1fb)](0x3,'0');let _0x1489a8=config[_0x1c75fc(0x265)](_0x519f9d=>_0x519f9d[_0x1c75fc(0x18e)]==_0x1215e3);if(!_0x1489a8)break;}if(_0x1215e3===_0x1c75fc(0x288)){logger[_0x1c75fc(0x1ab)](_0x1c75fc(0x2ad));return;}logger[_0x1c75fc(0x1ab)](_0x1c75fc(0x16d)+_0x1215e3),dbConfig['get'](_0x1c75fc(0x2a6))['push']({'botID':_0x1215e3,'botname':'Bot\x20'+_0x1215e3,'status':_0x1c75fc(0x1c3),'live':''})[_0x1c75fc(0x285)](),startBot([_0x1215e3,userID],{'cwd':bbpath},function(_0x3fbe31){const _0x3b55ec=_0x1c75fc;if(_0x3fbe31)logger[_0x3b55ec(0x1ab)](_0x3fbe31);}),config=getConfiguration(),io['to'](_0x1c75fc(0x213))[_0x1c75fc(0x106)]('bots',config),broadcastToBots(_0x1c75fc(0x2a6),JSON[_0x1c75fc(0x1a5)](config));}function deleteBot(_0x550462){const _0x3c9852=_0xebe72d;getClientsWithBotID(_0x550462)[_0x3c9852(0x179)](_0x5bd524=>{getSocket(_0x5bd524['id'])['disconnect'](!![]),removeClient(_0x5bd524['id']);}),dbConfig[_0x3c9852(0x10c)](_0x3c9852(0x2a6))[_0x3c9852(0x1e0)]({'botID':_0x550462})[_0x3c9852(0x285)](),logger[_0x3c9852(0x1ab)]('Deleted\x20Bot\x20'+_0x550462),stopBot(_0x550462);try{if(fs[_0x3c9852(0x1e1)](path['join'](configpath,_0x3c9852(0x2d3)+_0x550462+_0x3c9852(0x28d))))fs[_0x3c9852(0x143)](path['join'](configpath,_0x3c9852(0x2d3)+_0x550462+_0x3c9852(0x28d)));if(fs[_0x3c9852(0x1e1)](path[_0x3c9852(0x201)](configpath,_0x3c9852(0x2d3)+_0x550462+_0x3c9852(0x198))))fs[_0x3c9852(0x143)](path[_0x3c9852(0x201)](configpath,_0x3c9852(0x2d3)+_0x550462+_0x3c9852(0x198)));if(fs['existsSync'](path[_0x3c9852(0x201)](configpath,'bot-'+_0x550462+_0x3c9852(0x1f0))))fs['unlinkSync'](path[_0x3c9852(0x201)](configpath,_0x3c9852(0x2d3)+_0x550462+'-performance.json'));if(fs[_0x3c9852(0x1e1)](path['join'](configpath,'bot-'+_0x550462+_0x3c9852(0x2d2))))fs[_0x3c9852(0x143)](path[_0x3c9852(0x201)](configpath,_0x3c9852(0x2d3)+_0x550462+_0x3c9852(0x2d2)));}catch(_0x4210d5){if(_0x4210d5)logger[_0x3c9852(0x1ab)](_0x3c9852(0x16f),_0x4210d5);}config=getConfiguration(),io['to'](_0x3c9852(0x213))[_0x3c9852(0x106)](_0x3c9852(0x2a6),config),broadcastToBots(_0x3c9852(0x2a6),JSON['stringify'](config));}function toggleBot(_0x2fcb59,_0x16e7ae,_0x540807){const _0x49508a=_0xebe72d;dbConfig[_0x49508a(0x10c)]('bots')[_0x49508a(0x265)]({'botID':_0x2fcb59})[_0x49508a(0x1b3)]({'status':_0x16e7ae})[_0x49508a(0x1b3)]({'live':_0x540807})[_0x49508a(0x285)]();if(_0x16e7ae==_0x49508a(0x287)||_0x16e7ae==_0x49508a(0x1c3))logger[_0x49508a(0x1ab)](_0x49508a(0x1f3)+_0x2fcb59),startBot([_0x2fcb59,userID],{'cwd':bbpath},function(_0x34bcfe){const _0x435ee1=_0x49508a;if(_0x34bcfe)logger[_0x435ee1(0x1ab)](_0x34bcfe);});else(_0x16e7ae==_0x49508a(0x290)||_0x16e7ae==_0x49508a(0x178))&&(logger[_0x49508a(0x1ab)](_0x49508a(0x2c7)+_0x2fcb59),stopBot(_0x2fcb59));config=getConfiguration(),io['to'](_0x49508a(0x213))['emit'](_0x49508a(0x2a6),config),broadcastToBots('bots',JSON[_0x49508a(0x1a5)](config));}function toggleStatus(_0xaac569){const _0x58a680=_0xebe72d;let _0x1adb46=dbConfig[_0x58a680(0x10c)](_0x58a680(0x2a6))[_0x58a680(0x265)]({'botID':_0xaac569})[_0x58a680(0x248)](),_0x4fa3de;if(_0x1adb46[_0x58a680(0x1d2)]===_0x58a680(0x287))_0x4fa3de=_0x58a680(0x290);else{if(_0x1adb46[_0x58a680(0x1d2)]===_0x58a680(0x1c3))_0x4fa3de=_0x58a680(0x178);else{if(_0x1adb46[_0x58a680(0x1d2)]==='new-disabled')_0x4fa3de=_0x58a680(0x1c3);else{if(_0x1adb46[_0x58a680(0x1d2)]===_0x58a680(0x290))_0x4fa3de='enabled';}}}return _0x4fa3de;}function updateStatus(_0x520079,_0x216e64){const _0x4bfd95=_0xebe72d;dbConfig[_0x4bfd95(0x10c)](_0x4bfd95(0x2a6))[_0x4bfd95(0x265)]({'botID':_0x520079})[_0x4bfd95(0x1b3)]({'status':_0x216e64})['write'](),config=getConfiguration(),io['to'](_0x4bfd95(0x213))[_0x4bfd95(0x106)](_0x4bfd95(0x2a6),config),broadcastToBots(_0x4bfd95(0x2a6),JSON['stringify'](config));}function updateLive(_0x456e02,_0x44a4cd){const _0xc7eadf=_0xebe72d;dbConfig['get']('bots')[_0xc7eadf(0x265)]({'botID':_0x456e02})[_0xc7eadf(0x1b3)]({'live':_0x44a4cd})['write'](),config=getConfiguration(),io['to'](_0xc7eadf(0x213))['emit'](_0xc7eadf(0x2a6),config),broadcastToBots('bots',JSON[_0xc7eadf(0x1a5)](config));}function updateBotName(_0xeffd34,_0x1eef49){const _0x1741a0=_0xebe72d;dbConfig['get'](_0x1741a0(0x2a6))[_0x1741a0(0x265)]({'botID':_0xeffd34})['assign']({'botname':_0x1eef49})[_0x1741a0(0x285)](),config=getConfiguration(),io['to'](_0x1741a0(0x213))[_0x1741a0(0x106)](_0x1741a0(0x2a6),config),broadcastToBots(_0x1741a0(0x2a6),JSON[_0x1741a0(0x1a5)](config));}function updateBotManager(){const _0x4fdfb5=_0xebe72d;config=getConfiguration(),io['to'](_0x4fdfb5(0x213))[_0x4fdfb5(0x106)](_0x4fdfb5(0x2a6),config),broadcastToBots('bots',JSON[_0x4fdfb5(0x1a5)](config));}function toggleBotMode(_0x5e1789){const _0x34f36c=_0xebe72d;if(pid[_0x5e1789])pid[_0x5e1789][_0x34f36c(0x19e)]({'function':_0x34f36c(0x1f8),'args':null});else{const _0x4f583d=configpath+_0x34f36c(0x2d3)+_0x5e1789+_0x34f36c(0x28d),_0x5a7dc3=fs[_0x34f36c(0x18d)](_0x4f583d),_0x5c0f94=JSON[_0x34f36c(0x2a0)](_0x5a7dc3),_0x366675=_0x5c0f94[_0x34f36c(0x1ed)][0x0][_0x34f36c(0x23f)];_0x5c0f94[_0x34f36c(0x1ed)][0x0][_0x34f36c(0x23f)]=!_0x366675;const _0x3c0567=JSON['stringify'](_0x5c0f94,null,0x2);fs[_0x34f36c(0x218)](_0x4f583d,_0x3c0567),config=getConfiguration(),io['to']('botmanager')[_0x34f36c(0x106)](_0x34f36c(0x2a6),config),broadcastToBots(_0x34f36c(0x2a6),JSON[_0x34f36c(0x1a5)](config));}}function telegramError(_0x45686a){const _0x38e413=_0xebe72d;logger[_0x38e413(0x1aa)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x27bd5c){const _0x6fdf47=_0xebe72d;if(_0x27bd5c[_0x6fdf47(0x246)][_0x6fdf47(0x280)]!=settings[_0x6fdf47(0x222)]&&'@'+_0x27bd5c[_0x6fdf47(0x246)][_0x6fdf47(0x280)]!=settings[_0x6fdf47(0x222)])return tgBot[_0x6fdf47(0x24a)](_0x27bd5c[_0x6fdf47(0x1b0)]['id'],_0x6fdf47(0x26c),{'parse_mode':'HTML'})[_0x6fdf47(0x231)](_0x43e481=>{telegramError(_0x43e481);}),![];return!![];}async function initTelegram(){const _0x20cd78=_0xebe72d;if(tgBot)tgBot[_0x20cd78(0x2a2)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x1c8dda=_0x20cd78(0x29e);_0x1c8dda+='\x0a',_0x1c8dda+=_0x20cd78(0x250),_0x1c8dda+=_0x20cd78(0x1a8),_0x1c8dda+=_0x20cd78(0x297),_0x1c8dda+=_0x20cd78(0x157),_0x1c8dda+=_0x20cd78(0x22d),_0x1c8dda+=_0x20cd78(0x28a),_0x1c8dda+=_0x20cd78(0x117),_0x1c8dda+=_0x20cd78(0x19b),_0x1c8dda+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1c8dda+=_0x20cd78(0x29b),_0x1c8dda+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x1c8dda+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1c8dda+=_0x20cd78(0x236),_0x1c8dda+=_0x20cd78(0x14f);let _0x4a89a5='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x4a89a5+='\x0a',_0x4a89a5+=_0x1c8dda,tgBot[_0x20cd78(0x11f)](/\/start/,_0x5255da=>{const _0x5f1d8d=_0x20cd78;if(!validateTelegram(_0x5255da))return;if(settings[_0x5f1d8d(0x263)]!=_0x5255da[_0x5f1d8d(0x1b0)]['id'])updateSetting(_0x5f1d8d(0x263),_0x5255da[_0x5f1d8d(0x1b0)]['id']);updateSetting(_0x5f1d8d(0x29f),!![]),tgBot[_0x5f1d8d(0x24a)](_0x5255da[_0x5f1d8d(0x1b0)]['id'],_0x4a89a5)[_0x5f1d8d(0x231)](_0x58c6f8=>{telegramError(_0x58c6f8);});}),tgBot[_0x20cd78(0x11f)](/\/enable/,_0x2d2d02=>{const _0x3bee6a=_0x20cd78;if(!validateTelegram(_0x2d2d02))return;if(settings['telegramChatId']!=_0x2d2d02[_0x3bee6a(0x1b0)]['id'])updateSetting(_0x3bee6a(0x263),_0x2d2d02['chat']['id']);updateSetting(_0x3bee6a(0x29f),!![]),tgBot[_0x3bee6a(0x24a)](_0x2d2d02[_0x3bee6a(0x1b0)]['id'],_0x3bee6a(0x11e))['catch'](_0x3a64d8=>{telegramError(_0x3a64d8);});}),tgBot['onText'](/\/config/,async _0x5b3fa8=>{const _0x210def=_0x20cd78;if(!validateTelegram(_0x5b3fa8))return;tgBot[_0x210def(0x21c)]('callback_query'),tgBot[_0x210def(0x24a)](_0x5b3fa8[_0x210def(0x1b0)]['id'],_0x210def(0x15e),{'reply_markup':{'inline_keyboard':[[{'text':_0x210def(0x1c2),'callback_data':_0x210def(0x299)},{'text':_0x210def(0x226),'callback_data':_0x210def(0x2c4)},{'text':_0x210def(0xfd),'callback_data':'all'}]]}})[_0x210def(0x231)](_0x3121d0=>{telegramError(_0x3121d0);}),tgBot['on'](_0x210def(0x12c),async _0x5de484=>{const _0x7b4e3d=_0x210def,_0x11786b=_0x5de484[_0x7b4e3d(0x20a)],_0x3e7094=_0x5de484['message'];tgBot['answerCallbackQuery'](_0x5de484['id'])[_0x7b4e3d(0x144)](async()=>{const _0x22a960=_0x7b4e3d;_0x11786b==_0x22a960(0x299)&&(updateSetting(_0x22a960(0x21b),'orders'),updateSetting(_0x22a960(0x29f),!![]),await tgBot['sendMessage'](_0x3e7094[_0x22a960(0x1b0)]['id'],_0x22a960(0x17f))[_0x22a960(0x231)](_0x513b85=>{telegramError(_0x513b85);}));_0x11786b==_0x22a960(0x2c4)&&(updateSetting('telegramEvents',_0x22a960(0x2c4)),updateSetting(_0x22a960(0x29f),!![]),await tgBot[_0x22a960(0x24a)](_0x3e7094[_0x22a960(0x1b0)]['id'],_0x22a960(0x180))[_0x22a960(0x231)](_0x5a3c7a=>{telegramError(_0x5a3c7a);}));_0x11786b==_0x22a960(0x27a)&&(updateSetting(_0x22a960(0x21b),_0x22a960(0x27a)),updateSetting(_0x22a960(0x29f),!![]),await tgBot[_0x22a960(0x24a)](_0x3e7094['chat']['id'],_0x22a960(0x1b5))[_0x22a960(0x231)](_0x3cb3d3=>{telegramError(_0x3cb3d3);}));if(!settings[_0x22a960(0x263)])tgBot[_0x22a960(0x24a)](_0x3e7094[_0x22a960(0x1b0)]['id'],_0x22a960(0x2c5))['catch'](_0x1339c0=>{telegramError(_0x1339c0);});}),tgBot[_0x7b4e3d(0x21c)](_0x7b4e3d(0x12c));});}),tgBot[_0x20cd78(0x11f)](/\/status/,_0x15a023=>{const _0x368c72=_0x20cd78;if(!validateTelegram(_0x15a023))return;const _0x8e11e4=getBotsWithMode();let _0x39c087='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x368c72(0x179)](_0x1fe50b=>{const _0x438876=_0x368c72,_0xf75e08=_0x8e11e4[_0x438876(0x265)](_0x3880a9=>_0x3880a9[_0x438876(0x18e)]==_0x1fe50b[_0x438876(0x18e)])['mode'];_0x39c087+=_0x438876(0x24e)+_0x1fe50b[_0x438876(0x18e)]+':\x20'+_0x1fe50b[_0x438876(0x1d2)]+_0x438876(0x1d8)+_0xf75e08+_0x438876(0x1d8)+_0x1fe50b[_0x438876(0x21e)]+'\x0a';}),_0x39c087+='\x0a',_0x39c087+=_0x368c72(0x2a9),_0x39c087+=!settings[_0x368c72(0x29f)]?'Notifications\x20disabled\x0a':_0x368c72(0x1f5),_0x39c087+=settings[_0x368c72(0x29f)]?settings[_0x368c72(0x21b)]==_0x368c72(0x27a)?_0x368c72(0x122):_0x368c72(0x151)+settings[_0x368c72(0x21b)]+'\x20only\x0a':'',tgBot['sendMessage'](_0x15a023[_0x368c72(0x1b0)]['id'],_0x39c087,{'parse_mode':_0x368c72(0x2b5)})[_0x368c72(0x231)](_0x1d00fa=>{telegramError(_0x1d00fa);});}),tgBot['onText'](/\/restart/,_0x39a7b8=>{const _0x7e2c31=_0x20cd78;if(!validateTelegram(_0x39a7b8))return;tgBot[_0x7e2c31(0x21c)]('callback_query');const _0x27848e=getEnabledBots();if(_0x27848e['length']==0x0)tgBot['sendMessage'](_0x39a7b8[_0x7e2c31(0x1b0)]['id'],_0x7e2c31(0x147))[_0x7e2c31(0x231)](_0x558078=>{telegramError(_0x558078);});else{if(_0x27848e['length']>0x1)_0x27848e[_0x7e2c31(0x200)]({'botID':_0x7e2c31(0x27a)});let _0x1242cb=[],_0x26026f=[];const _0x165229=_0x27848e[_0x7e2c31(0x10a)]%0x4==0x0||_0x27848e['length']%0x4==0x3||_0x27848e['length']%0x3==0x1?0x4:0x3;let _0x4e4245=0x0;_0x27848e[_0x7e2c31(0x179)]((_0x1ddd11,_0x1ed5b4)=>{const _0x339ce9=_0x7e2c31;if(_0x1ed5b4%_0x165229==0x0)_0x26026f=[];_0x26026f[_0x339ce9(0x200)]({'text':_0x1ddd11[_0x339ce9(0x18e)]=='all'?_0x339ce9(0x235):_0x339ce9(0x24e)+_0x1ddd11['botID'],'callback_data':_0x1ddd11[_0x339ce9(0x18e)]}),_0x1ed5b4%_0x165229==0x0&&(_0x1242cb[_0x4e4245]=_0x26026f,_0x4e4245++);}),tgBot[_0x7e2c31(0x24a)](_0x39a7b8['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x1242cb}})['catch'](_0x166b65=>{telegramError(_0x166b65);}),tgBot['on'](_0x7e2c31(0x12c),async _0x47365c=>{const _0xe60df3=_0x7e2c31,_0x1b0a13=_0x47365c[_0xe60df3(0x20a)],_0x2fd46f=_0x47365c[_0xe60df3(0x1d5)];tgBot[_0xe60df3(0x1b1)](_0x47365c['id'])[_0xe60df3(0x144)](async()=>{_0x1b0a13=='all'?config['forEach'](_0x5456c=>{restartBot(_0x5456c['botID']);}):restartBot(_0x1b0a13);}),tgBot['removeListener'](_0xe60df3(0x12c));});}}),tgBot[_0x20cd78(0x11f)](/\/on/,_0x3882ea=>{const _0x4444e7=_0x20cd78;if(!validateTelegram(_0x3882ea))return;tgBot[_0x4444e7(0x21c)]('callback_query');const _0x36e1b1=getDisabledBots();if(_0x36e1b1['length']==0x0)tgBot['sendMessage'](_0x3882ea[_0x4444e7(0x1b0)]['id'],_0x4444e7(0xfe))[_0x4444e7(0x231)](_0x53a0ae=>{telegramError(_0x53a0ae);});else{if(_0x36e1b1[_0x4444e7(0x10a)]>0x1)_0x36e1b1[_0x4444e7(0x200)]({'botID':_0x4444e7(0x27a)});let _0x12bfd4=[],_0x1d9f7b=[];const _0x521a73=_0x36e1b1['length']%0x4==0x0||_0x36e1b1[_0x4444e7(0x10a)]%0x4==0x3||_0x36e1b1[_0x4444e7(0x10a)]%0x3==0x1?0x4:0x3;let _0x1e5fab=0x0;_0x36e1b1['forEach']((_0xb94a44,_0x9c09ea)=>{const _0x4a553f=_0x4444e7;if(_0x9c09ea%_0x521a73==0x0)_0x1d9f7b=[];_0x1d9f7b[_0x4a553f(0x200)]({'text':_0xb94a44[_0x4a553f(0x18e)]==_0x4a553f(0x27a)?'All\x20bots':_0x4a553f(0x24e)+_0xb94a44[_0x4a553f(0x18e)],'callback_data':_0xb94a44['botID']}),_0x9c09ea%_0x521a73==0x0&&(_0x12bfd4[_0x1e5fab]=_0x1d9f7b,_0x1e5fab++);}),tgBot[_0x4444e7(0x24a)](_0x3882ea[_0x4444e7(0x1b0)]['id'],_0x4444e7(0x232),{'reply_markup':{'inline_keyboard':_0x12bfd4}})[_0x4444e7(0x231)](_0x955c71=>{telegramError(_0x955c71);}),tgBot['on'](_0x4444e7(0x12c),async _0x3ed966=>{const _0xfecdf7=_0x4444e7,_0x1c4d9d=_0x3ed966[_0xfecdf7(0x20a)],_0x5133ac=_0x3ed966[_0xfecdf7(0x1d5)];tgBot[_0xfecdf7(0x1b1)](_0x3ed966['id'])[_0xfecdf7(0x144)](async()=>{const _0x28cdb6=_0xfecdf7;_0x1c4d9d=='all'?(tgBot['sendMessage'](_0x5133ac[_0x28cdb6(0x1b0)]['id'],_0x28cdb6(0x2c3))[_0x28cdb6(0x231)](_0x334c42=>{telegramError(_0x334c42);}),_0x36e1b1[_0x28cdb6(0x179)](_0x36bc39=>{const _0x2dde94=_0x28cdb6;if(_0x36bc39[_0x2dde94(0x18e)]!=_0x2dde94(0x27a))toggleBot(_0x36bc39[_0x2dde94(0x18e)],toggleStatus(_0x36bc39[_0x2dde94(0x18e)]),_0x2dde94(0x1b7));})):(tgBot['sendMessage'](_0x5133ac[_0x28cdb6(0x1b0)]['id'],_0x28cdb6(0x26a)+_0x1c4d9d)['catch'](_0xcb76c0=>{telegramError(_0xcb76c0);}),toggleBot(_0x1c4d9d,toggleStatus(_0x1c4d9d),_0x28cdb6(0x1b7)));}),tgBot[_0xfecdf7(0x21c)]('callback_query');});}}),tgBot[_0x20cd78(0x11f)](/\/off/,_0x125c47=>{const _0x180aeb=_0x20cd78;if(!validateTelegram(_0x125c47))return;tgBot[_0x180aeb(0x21c)]('callback_query');const _0x3e335c=getEnabledBots();if(_0x3e335c[_0x180aeb(0x10a)]==0x0)tgBot[_0x180aeb(0x24a)](_0x125c47['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x180aeb(0x231)](_0x497097=>{telegramError(_0x497097);});else{if(_0x3e335c[_0x180aeb(0x10a)]>0x1)_0x3e335c[_0x180aeb(0x200)]({'botID':_0x180aeb(0x27a)});let _0x3fe5ca=[],_0x304a83=[];const _0x523da5=_0x3e335c['length']%0x4==0x0||_0x3e335c[_0x180aeb(0x10a)]%0x4==0x3||_0x3e335c[_0x180aeb(0x10a)]%0x3==0x1?0x4:0x3;let _0x2c0934=0x0;_0x3e335c[_0x180aeb(0x179)]((_0x426380,_0x4a2915)=>{const _0xb9ff35=_0x180aeb;if(_0x4a2915%_0x523da5==0x0)_0x304a83=[];_0x304a83[_0xb9ff35(0x200)]({'text':_0x426380[_0xb9ff35(0x18e)]=='all'?'All\x20bots':_0xb9ff35(0x24e)+_0x426380[_0xb9ff35(0x18e)],'callback_data':_0x426380['botID']}),_0x4a2915%_0x523da5==0x0&&(_0x3fe5ca[_0x2c0934]=_0x304a83,_0x2c0934++);}),tgBot[_0x180aeb(0x24a)](_0x125c47[_0x180aeb(0x1b0)]['id'],_0x180aeb(0x23b),{'reply_markup':{'inline_keyboard':_0x3fe5ca}})[_0x180aeb(0x231)](_0x4ec913=>{telegramError(_0x4ec913);}),tgBot['on'](_0x180aeb(0x12c),async _0x65f45b=>{const _0x541631=_0x180aeb,_0x24f8a4=_0x65f45b['data'],_0x156226=_0x65f45b[_0x541631(0x1d5)];tgBot[_0x541631(0x1b1)](_0x65f45b['id'])[_0x541631(0x144)](async()=>{const _0x231346=_0x541631;_0x24f8a4==_0x231346(0x27a)?(tgBot[_0x231346(0x24a)](_0x156226[_0x231346(0x1b0)]['id'],_0x231346(0x1be))[_0x231346(0x231)](_0x11f1b6=>{telegramError(_0x11f1b6);}),_0x3e335c[_0x231346(0x179)](_0x1e5516=>{const _0x340043=_0x231346;if(_0x1e5516[_0x340043(0x18e)]!=_0x340043(0x27a))toggleBot(_0x1e5516[_0x340043(0x18e)],toggleStatus(_0x1e5516[_0x340043(0x18e)]),'stopped');})):(tgBot['sendMessage'](_0x156226[_0x231346(0x1b0)]['id'],_0x231346(0x29c)+_0x24f8a4)[_0x231346(0x231)](_0xe79797=>{telegramError(_0xe79797);}),toggleBot(_0x24f8a4,toggleStatus(_0x24f8a4),_0x231346(0x1b7)));}),tgBot[_0x541631(0x21c)](_0x541631(0x12c));});}}),tgBot[_0x20cd78(0x11f)](/\/metrics/,_0x118254=>{const _0x4cc1fc=_0x20cd78;if(!validateTelegram(_0x118254))return;tgBot['removeListener'](_0x4cc1fc(0x12c));const _0x4793f5=getEnabledBots();if(_0x4793f5[_0x4cc1fc(0x10a)]==0x0)tgBot[_0x4cc1fc(0x24a)](_0x118254[_0x4cc1fc(0x1b0)]['id'],_0x4cc1fc(0x147))['catch'](_0x207800=>{telegramError(_0x207800);});else{if(_0x4793f5[_0x4cc1fc(0x10a)]>0x1){let _0x3f7984=[],_0x180498=[];const _0x22ada1=_0x4793f5[_0x4cc1fc(0x10a)]%0x4==0x0||_0x4793f5[_0x4cc1fc(0x10a)]%0x4==0x3||_0x4793f5[_0x4cc1fc(0x10a)]%0x3==0x1?0x4:0x3;let _0x41c68c=0x0;_0x4793f5['forEach']((_0x1c2279,_0x495f15)=>{const _0x7d35ed=_0x4cc1fc;if(_0x495f15%_0x22ada1==0x0)_0x180498=[];_0x180498[_0x7d35ed(0x200)]({'text':'Bot\x20'+_0x1c2279[_0x7d35ed(0x18e)],'callback_data':_0x1c2279['botID']}),_0x495f15%_0x22ada1==0x0&&(_0x3f7984[_0x41c68c]=_0x180498,_0x41c68c++);}),tgBot[_0x4cc1fc(0x24a)](_0x118254[_0x4cc1fc(0x1b0)]['id'],_0x4cc1fc(0x119),{'reply_markup':{'inline_keyboard':_0x3f7984}})['catch'](_0x2ba52a=>{telegramError(_0x2ba52a);}),tgBot['on'](_0x4cc1fc(0x12c),async _0x574622=>{const _0x1acccf=_0x4cc1fc,_0x45ec93=_0x574622['data'],_0x1c6e99=_0x574622[_0x1acccf(0x1d5)];tgBot[_0x1acccf(0x1b1)](_0x574622['id'])['then'](async()=>{const _0xceab93=_0x1acccf;if(pid[_0x45ec93])pid[_0x45ec93][_0xceab93(0x19e)]({'function':_0xceab93(0x11d),'args':null});}),tgBot[_0x1acccf(0x21c)](_0x1acccf(0x12c));});}else{const _0x2851ed=_0x4793f5[0x0][_0x4cc1fc(0x18e)];if(pid[_0x2851ed])pid[_0x2851ed][_0x4cc1fc(0x19e)]({'function':_0x4cc1fc(0x11d),'args':null});}}}),tgBot[_0x20cd78(0x11f)](/\/portfolio/,_0x3337e1=>{const _0xa83f2=_0x20cd78;if(!validateTelegram(_0x3337e1))return;tgBot[_0xa83f2(0x21c)](_0xa83f2(0x12c));const _0x178ccf=getEnabledBots();if(_0x178ccf['length']==0x0)tgBot[_0xa83f2(0x24a)](_0x3337e1[_0xa83f2(0x1b0)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x500902=>{telegramError(_0x500902);});else{if(_0x178ccf['length']>0x1){let _0x213f31=[],_0x491a3e=[];const _0x1b1101=_0x178ccf['length']%0x4==0x0||_0x178ccf['length']%0x4==0x3||_0x178ccf[_0xa83f2(0x10a)]%0x3==0x1?0x4:0x3;let _0x33d8ad=0x0;_0x178ccf[_0xa83f2(0x179)]((_0x556376,_0x410065)=>{const _0x519882=_0xa83f2;if(_0x410065%_0x1b1101==0x0)_0x491a3e=[];_0x491a3e[_0x519882(0x200)]({'text':_0x519882(0x24e)+_0x556376[_0x519882(0x18e)],'callback_data':_0x556376[_0x519882(0x18e)]}),_0x410065%_0x1b1101==0x0&&(_0x213f31[_0x33d8ad]=_0x491a3e,_0x33d8ad++);}),tgBot[_0xa83f2(0x24a)](_0x3337e1[_0xa83f2(0x1b0)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x213f31}})['catch'](_0x3ba628=>{telegramError(_0x3ba628);}),tgBot['on'](_0xa83f2(0x12c),async _0x116fbc=>{const _0xe8623e=_0xa83f2,_0x2eb24b=_0x116fbc[_0xe8623e(0x20a)],_0x25c9d2=_0x116fbc[_0xe8623e(0x1d5)];tgBot[_0xe8623e(0x1b1)](_0x116fbc['id'])['then'](async()=>{const _0x61bed6=_0xe8623e;if(pid[_0x2eb24b])pid[_0x2eb24b][_0x61bed6(0x19e)]({'function':_0x61bed6(0x108),'args':null});}),tgBot['removeListener'](_0xe8623e(0x12c));});}else{const _0x5772ae=_0x178ccf[0x0]['botID'];if(pid[_0x5772ae])pid[_0x5772ae][_0xa83f2(0x19e)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['onText'](/\/update/,async _0x5c9b9c=>{const _0x28bba0=_0x20cd78;if(!validateTelegram(_0x5c9b9c))return;tgBot[_0x28bba0(0x21c)](_0x28bba0(0x12c)),await getMessages();if(!updateAvailable)tgBot[_0x28bba0(0x24a)](_0x5c9b9c[_0x28bba0(0x1b0)]['id'],_0x28bba0(0x22e))[_0x28bba0(0x231)](_0x47bbd4=>{telegramError(_0x47bbd4);});else!validInstallation?tgBot[_0x28bba0(0x24a)](_0x5c9b9c[_0x28bba0(0x1b0)]['id'],_0x28bba0(0x1dd))['catch'](_0x433d2b=>{telegramError(_0x433d2b);}):(tgBot[_0x28bba0(0x24a)](_0x5c9b9c['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x28bba0(0x11a)},{'text':'No','callback_data':'no'}]]}})[_0x28bba0(0x231)](_0x2fd04a=>{telegramError(_0x2fd04a);}),tgBot['on']('callback_query',async _0x315cbc=>{const _0x4653a0=_0x28bba0,_0x2ec148=_0x315cbc[_0x4653a0(0x20a)],_0x1d82b9=_0x315cbc[_0x4653a0(0x1d5)];tgBot[_0x4653a0(0x1b1)](_0x315cbc['id'])[_0x4653a0(0x144)](async()=>{const _0x5c7d96=_0x4653a0;_0x2ec148=='yes'&&(await tgBot[_0x5c7d96(0x24a)](_0x1d82b9[_0x5c7d96(0x1b0)]['id'],_0x5c7d96(0x187))[_0x5c7d96(0x231)](_0xa33b34=>{telegramError(_0xa33b34);}),updateBB(_0x5c7d96(0x2c2))),_0x2ec148=='no'&&await tgBot[_0x5c7d96(0x24a)](_0x1d82b9['chat']['id'],_0x5c7d96(0x22f))[_0x5c7d96(0x231)](_0x34441f=>{telegramError(_0x34441f);});}),tgBot[_0x4653a0(0x21c)](_0x4653a0(0x12c));}));}),tgBot[_0x20cd78(0x11f)](/\/reinstall/,async _0x389c45=>{const _0x500dac=_0x20cd78;if(!validateTelegram(_0x389c45))return;tgBot[_0x500dac(0x21c)](_0x500dac(0x12c)),!validInstallation?tgBot[_0x500dac(0x24a)](_0x389c45[_0x500dac(0x1b0)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x500dac(0x231)](_0x2dc830=>{telegramError(_0x2dc830);}):(tgBot[_0x500dac(0x24a)](_0x389c45[_0x500dac(0x1b0)]['id'],_0x500dac(0x240),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x500dac(0x11a)},{'text':'No','callback_data':'no'}]]}})[_0x500dac(0x231)](_0x38f534=>{telegramError(_0x38f534);}),tgBot['on'](_0x500dac(0x12c),async _0x4faf9d=>{const _0xf28ef1=_0x500dac,_0xb13c2d=_0x4faf9d[_0xf28ef1(0x20a)],_0x4ab4c8=_0x4faf9d['message'];tgBot[_0xf28ef1(0x1b1)](_0x4faf9d['id'])[_0xf28ef1(0x144)](async()=>{const _0x288799=_0xf28ef1;_0xb13c2d=='yes'&&(await tgBot[_0x288799(0x24a)](_0x4ab4c8['chat']['id'],_0x288799(0xfa))[_0x288799(0x231)](_0x5eb6cc=>{telegramError(_0x5eb6cc);}),updateBB('reinstall')),_0xb13c2d=='no'&&await tgBot[_0x288799(0x24a)](_0x4ab4c8[_0x288799(0x1b0)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')['catch'](_0x99d9f=>{telegramError(_0x99d9f);});}),tgBot[_0xf28ef1(0x21c)](_0xf28ef1(0x12c));}));}),tgBot['onText'](/\/toggle/,_0x317e65=>{const _0x14e231=_0x20cd78;if(!validateTelegram(_0x317e65))return;tgBot[_0x14e231(0x21c)](_0x14e231(0x12c));const _0x478a5a=getBotsWithMode();if(_0x478a5a[_0x14e231(0x10a)]==0x0)tgBot[_0x14e231(0x24a)](_0x317e65[_0x14e231(0x1b0)]['id'],_0x14e231(0x147))[_0x14e231(0x231)](_0x229b06=>{telegramError(_0x229b06);});else{let _0x57a746=[],_0x1f7356=[];const _0x3493dd=0x2;let _0x4223a8=0x0;_0x478a5a['forEach']((_0x36a5c3,_0xf5a91c)=>{const _0x391b1b=_0x14e231;if(_0xf5a91c%_0x3493dd==0x0)_0x1f7356=[];_0x1f7356['push']({'text':_0x391b1b(0x24e)+_0x36a5c3[_0x391b1b(0x18e)]+'\x20('+_0x36a5c3[_0x391b1b(0x1df)]+')','callback_data':_0x36a5c3[_0x391b1b(0x18e)]}),_0xf5a91c%_0x3493dd==0x0&&(_0x57a746[_0x4223a8]=_0x1f7356,_0x4223a8++);}),tgBot['sendMessage'](_0x317e65[_0x14e231(0x1b0)]['id'],_0x14e231(0x1d0),{'reply_markup':{'inline_keyboard':_0x57a746}})[_0x14e231(0x231)](_0x44d893=>{telegramError(_0x44d893);}),tgBot['on'](_0x14e231(0x12c),async _0x288914=>{const _0x19db23=_0x14e231,_0x4403dd=_0x288914['data'],_0x4c26b9=_0x288914[_0x19db23(0x1d5)];tgBot[_0x19db23(0x1b1)](_0x288914['id'])[_0x19db23(0x144)](async()=>{const _0x1ba91f=_0x19db23,_0x12154f=_0x478a5a['find'](_0x4f031f=>_0x4f031f[_0x1ba91f(0x18e)]==_0x4403dd),_0x5075bf=_0x12154f[_0x1ba91f(0x1df)]=='auto'?'manual':_0x1ba91f(0x135);tgBot[_0x1ba91f(0x24a)](_0x4c26b9[_0x1ba91f(0x1b0)]['id'],_0x1ba91f(0x182)+_0x4403dd+'\x20to\x20'+_0x5075bf+'\x20mode')['catch'](_0x4aff88=>{telegramError(_0x4aff88);}),toggleBotMode(_0x4403dd);}),tgBot[_0x19db23(0x21c)](_0x19db23(0x12c));});}}),tgBot['onText'](/\/names/,_0x49599f=>{const _0x28b187=_0x20cd78;if(!validateTelegram(_0x49599f))return;let _0x20bbd0='';config['forEach'](_0x41f05c=>{const _0x540968=_0x2b9f;_0x20bbd0+=_0x540968(0x24e)+_0x41f05c[_0x540968(0x18e)]+':\x20'+_0x41f05c[_0x540968(0x1c9)]+'\x0a';}),tgBot[_0x28b187(0x24a)](_0x49599f[_0x28b187(0x1b0)]['id'],_0x20bbd0,{'parse_mode':_0x28b187(0x2b5)})[_0x28b187(0x231)](_0x2fa1c4=>{telegramError(_0x2fa1c4);});}),tgBot[_0x20cd78(0x11f)](/\/disable/,_0x2d6f4d=>{const _0x4181c3=_0x20cd78;if(!validateTelegram(_0x2d6f4d))return;tgBot['sendMessage'](_0x2d6f4d[_0x4181c3(0x1b0)]['id'],_0x4181c3(0x253))[_0x4181c3(0x231)](_0x3fa0a9=>{telegramError(_0x3fa0a9);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x20cd78(0x11f)](/\/help/,_0x3b18e6=>{const _0x553c97=_0x20cd78;if(!validateTelegram(_0x3b18e6))return;tgBot[_0x553c97(0x24a)](_0x3b18e6[_0x553c97(0x1b0)]['id'],_0x1c8dda)[_0x553c97(0x231)](_0x4b67f7=>{telegramError(_0x4b67f7);});}),tgBot['on'](_0x20cd78(0x2d5),_0x4a6fb1=>{const _0x2771bd=_0x20cd78;_0x4a6fb1['toString']()[_0x2771bd(0x169)](_0x2771bd(0x27c))&&(logger[_0x2771bd(0x1ab)](_0x2771bd(0x1fa)),tgBot[_0x2771bd(0x2a2)](),tgBot=null,io['to'](_0x2771bd(0x213))[_0x2771bd(0x106)]('notification',_0x2771bd(0x1fa)));}),process[_0x20cd78(0x145)]('SIGINT',()=>{const _0x4d0ecf=_0x20cd78;if(tgBot)tgBot[_0x4d0ecf(0x2a2)]();process[_0x4d0ecf(0x17c)](0x1);}),process[_0x20cd78(0x145)](_0x20cd78(0x1bb),()=>{const _0x5a3975=_0x20cd78;if(tgBot)tgBot[_0x5a3975(0x2a2)]();process[_0x5a3975(0x17c)](0x1);});}}function disableTelegram(){const _0x339a99=_0xebe72d;tgBot&&(tgBot[_0x339a99(0x2a2)](),tgBot=null);}function sendTelegram(_0x4facbb,_0x237a08){const _0x6269b5=_0xebe72d;if(settings[_0x6269b5(0x29f)]){if(settings[_0x6269b5(0x21b)]==_0x6269b5(0x27a)||(_0x237a08['type']==_0x6269b5(0x281)||_0x237a08[_0x6269b5(0x105)]==_0x6269b5(0x14d)||_0x237a08[_0x6269b5(0x105)]==_0x6269b5(0x116))&&settings['telegramEvents']=='alerts'||_0x237a08[_0x6269b5(0x105)]==_0x6269b5(0x20f)&&settings[_0x6269b5(0x21b)]==_0x6269b5(0x299)){if(tgBot&&settings[_0x6269b5(0x263)]){if(_0x237a08[_0x6269b5(0x10e)])tgBot[_0x6269b5(0x24a)](settings[_0x6269b5(0x263)],_0x237a08[_0x6269b5(0x1c9)]+_0x6269b5(0x1d9)+_0x237a08[_0x6269b5(0x2b9)])[_0x6269b5(0x231)](_0x5bd385=>{telegramError(_0x5bd385);});else tgBot[_0x6269b5(0x24a)](settings['telegramChatId'],_0x6269b5(0x24e)+_0x4facbb+_0x6269b5(0x1d9)+_0x237a08[_0x6269b5(0x2b9)])[_0x6269b5(0x231)](_0x51471a=>{telegramError(_0x51471a);});}}}}async function sendTelegramMsg(_0x3bddee,_0x366ffa=_0xebe72d(0x2b5)){const _0x591b3b=_0xebe72d;return settings[_0x591b3b(0x29f)]&&tgBot&&settings[_0x591b3b(0x263)]?(await tgBot[_0x591b3b(0x24a)](settings[_0x591b3b(0x263)],_0x3bddee,{'parse_mode':_0x366ffa})[_0x591b3b(0x231)](_0x596e1b=>{telegramError(_0x596e1b);}),!![]):![];}function getDeviceWithIp(_0x374127){const _0x1ea0d7=_0xebe72d;return devices[_0x1ea0d7(0x265)](_0x12cf4c=>_0x12cf4c['ip']===_0x374127);}function temporaryAccess2FA(_0x1ab26c,_0x2df229){const _0x38655e=_0xebe72d;let _0x4270b5=new Date(),_0x192749=![];if(lastIpApproval){if(_0x4270b5-lastIpApproval<0x1388)_0x192749=!![];}lastIpApproval=new Date();if(_0x192749)return;tgBot&&settings[_0x38655e(0x263)]&&(tgBot[_0x38655e(0x21c)](_0x38655e(0x12c)),tgBot[_0x38655e(0x24a)](settings['telegramChatId'],_0x38655e(0x149)+normalizeIP(_0x2df229)['show']+_0x38655e(0x1db),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x38655e(0x202),'callback_data':'5'},{'text':_0x38655e(0x1e8),'callback_data':'15'},{'text':_0x38655e(0x270),'callback_data':'30'},{'text':_0x38655e(0x16c),'callback_data':_0x38655e(0x16c)}]]}})[_0x38655e(0x231)](_0x43b664=>{telegramError(_0x43b664);}),tgBot['on'](_0x38655e(0x12c),async _0x161e15=>{const _0x4f6fd0=_0x38655e,_0xdd3e70=_0x161e15[_0x4f6fd0(0x20a)],_0x2d480e=_0x161e15['message'];tgBot[_0x4f6fd0(0x1b1)](_0x161e15['id'])[_0x4f6fd0(0x144)](async()=>{const _0x2052b1=_0x4f6fd0;devices[_0x1ab26c]['telegramIpApproval']={'clientip':_0x2df229,'timestamp':new Date()[_0x2052b1(0x2bd)](),'expiry':_0xdd3e70},_0xdd3e70!=_0x2052b1(0x16c)?(await tgBot[_0x2052b1(0x24a)](_0x2d480e[_0x2052b1(0x1b0)]['id'],_0x2052b1(0x241)+_0xdd3e70+_0x2052b1(0x296),{'parse_mode':_0x2052b1(0x2b5)})[_0x2052b1(0x231)](_0x51fe47=>{telegramError(_0x51fe47);}),io['to'](_0x1ab26c)['emit'](_0x2052b1(0x1d2),{'access':{'allow':![],'reason':_0x2052b1(0x170),'token':null}})):(await tgBot[_0x2052b1(0x24a)](_0x2d480e[_0x2052b1(0x1b0)]['id'],'Temporary\x20access\x20rejected')[_0x2052b1(0x231)](_0x18f36d=>{telegramError(_0x18f36d);}),io['to'](_0x1ab26c)[_0x2052b1(0x106)](_0x2052b1(0x1d2),{'access':{'allow':![],'reason':_0x2052b1(0x209),'token':null}}));}),tgBot[_0x4f6fd0(0x21c)]('callback_query');}));}function loginAccess2FA(_0x2731e4,_0x37c729){const _0x55bf67=_0xebe72d;tgBot&&settings[_0x55bf67(0x263)]&&(tgBot[_0x55bf67(0x21c)]('callback_query'),tgBot[_0x55bf67(0x24a)](settings[_0x55bf67(0x263)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x37c729)[_0x55bf67(0x257)]+_0x55bf67(0x1db),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x55bf67(0x26f),'callback_data':loginExpiry},{'text':_0x55bf67(0x16c),'callback_data':_0x55bf67(0x16c)}]]}})[_0x55bf67(0x231)](_0x46cbda=>{telegramError(_0x46cbda);}),tgBot['on'](_0x55bf67(0x12c),async _0x1c9be6=>{const _0x52fff1=_0x55bf67,_0x1cdb91=_0x1c9be6['data'],_0x2474a7=_0x1c9be6[_0x52fff1(0x1d5)];tgBot[_0x52fff1(0x1b1)](_0x1c9be6['id'])['then'](async()=>{const _0x58dbb7=_0x52fff1;devices[_0x2731e4][_0x58dbb7(0x2c8)]={'clientip':_0x37c729,'timestamp':new Date()[_0x58dbb7(0x2bd)](),'expiry':_0x1cdb91},_0x1cdb91!=_0x58dbb7(0x16c)?(await tgBot[_0x58dbb7(0x24a)](_0x2474a7[_0x58dbb7(0x1b0)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})['catch'](_0x42b715=>{telegramError(_0x42b715);}),io['to'](_0x2731e4)[_0x58dbb7(0x106)]('status',{'access':{'allow':![],'reason':_0x58dbb7(0x170),'token':null}})):(await tgBot[_0x58dbb7(0x24a)](_0x2474a7[_0x58dbb7(0x1b0)]['id'],'Login\x20rejected')['catch'](_0x1dd46e=>{telegramError(_0x1dd46e);}),io['to'](_0x2731e4)[_0x58dbb7(0x106)](_0x58dbb7(0x1d2),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x52fff1(0x21c)](_0x52fff1(0x12c));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xcebf6e=_0xebe72d;return dbConfig[_0xcebf6e(0x10c)](_0xcebf6e(0x2a6))[_0xcebf6e(0x1cf)]('botID')[_0xcebf6e(0x137)]({'status':_0xcebf6e(0x287)})[_0xcebf6e(0x248)]()||[];}function getDisabledBots(){const _0x23a327=_0xebe72d;return dbConfig[_0x23a327(0x10c)](_0x23a327(0x2a6))[_0x23a327(0x1cf)](_0x23a327(0x18e))[_0x23a327(0x137)]({'status':_0x23a327(0x290)})[_0x23a327(0x248)]()||[];}function getBotAttributes(_0x2c7221){const _0x52cbe0=_0xebe72d;let _0x54f096={};const _0x3a44fa=configpath+'bot-'+_0x2c7221+_0x52cbe0(0x28d),_0x17a9d2=fs[_0x52cbe0(0x1e1)](_0x3a44fa);if(_0x17a9d2){const _0x2dac04=fs[_0x52cbe0(0x18d)](_0x3a44fa);try{const _0x2330a9=JSON[_0x52cbe0(0x2a0)](_0x2dac04),_0x2ad266=_0x2330a9?_0x2330a9['bot'][0x0][_0x52cbe0(0x23f)]:![];_0x54f096[_0x52cbe0(0x1df)]=_0x2ad266?_0x52cbe0(0x135):_0x52cbe0(0x134),_0x54f096[_0x52cbe0(0x1c9)]=_0x2330a9?_0x2330a9[_0x52cbe0(0x1ed)][0x0][_0x52cbe0(0x1c9)]:'Bot\x20'+_0x2c7221;}catch(_0x51b8b1){_0x54f096[_0x52cbe0(0x1df)]='manual',_0x54f096[_0x52cbe0(0x1c9)]='Bot\x20'+_0x2c7221;}}else _0x54f096['mode']=_0x52cbe0(0x134),_0x54f096['botname']=_0x52cbe0(0x24e)+_0x2c7221;return _0x54f096;}function getBotsWithMode(){const _0x2642a7=_0xebe72d,_0x3c84f2=dbConfig['get']('bots')['sortBy'](_0x2642a7(0x18e))[_0x2642a7(0x248)]()||[];return _0x3c84f2['forEach'](_0xc94886=>{const _0x41707e=_0x2642a7;let _0x5308c0=getBotAttributes(_0xc94886[_0x41707e(0x18e)]);_0xc94886[_0x41707e(0x1df)]=_0x5308c0[_0x41707e(0x1df)];}),_0x3c84f2;}function getBotExchanges(){const _0x400bc0=_0xebe72d;let _0x283cff=[];const _0x584435=dbConfig[_0x400bc0(0x10c)](_0x400bc0(0x2a6))[_0x400bc0(0x1cf)](_0x400bc0(0x18e))['value']()||[];_0x584435[_0x400bc0(0x179)](_0x3aacb2=>{const _0x43a81f=_0x400bc0;if(_0x3aacb2[_0x43a81f(0x1d2)]=='enabled'){const _0x5b49a2=configpath+'bot-'+_0x3aacb2[_0x43a81f(0x18e)]+'-config.json',_0x4015cf=fs[_0x43a81f(0x1e1)](_0x5b49a2);let _0x2d842d;if(_0x4015cf){const _0x1a329f=fs[_0x43a81f(0x18d)](_0x5b49a2);try{const _0x3a809b=JSON[_0x43a81f(0x2a0)](_0x1a329f);_0x2d842d=_0x3a809b?_0x3a809b[_0x43a81f(0x1ed)][0x0][_0x43a81f(0x2d0)]:null;}catch(_0xd406ae){}}if(_0x2d842d)_0x283cff[_0x43a81f(0x200)](_0x2d842d);}});const _0x62e297=[...new Set(_0x283cff)][_0x400bc0(0x181)]();return _0x62e297;}async function initUser(){const _0x2bb60e=_0xebe72d;if(!settings[_0x2bb60e(0x141)]){const _0x373aee=uuidRandom();mixpanel[_0x2bb60e(0x197)](_0x373aee),updateSetting('userid',_0x373aee);}}async function initSecure(){const _0x1e6a26=_0xebe72d;let _0x5ee4d3=getSecure();if(!_0x5ee4d3['hasOwnProperty'](_0x1e6a26(0x27d))){let _0x5712c6=await generateKeys();_0x5ee4d3[_0x1e6a26(0x29a)]=_0x5712c6[_0x1e6a26(0x29a)],_0x5ee4d3[_0x1e6a26(0x266)]=_0x5712c6[_0x1e6a26(0x266)],_0x5ee4d3[_0x1e6a26(0x27d)]=crypto[_0x1e6a26(0x166)](0x20)[_0x1e6a26(0x1ff)](_0x1e6a26(0x2ca));;storeSecure(_0x5ee4d3);}}function getSettings(){const _0x4acad9=_0xebe72d;return dbSettings[_0x4acad9(0x10c)](_0x4acad9(0x243))[_0x4acad9(0x248)]()||{};}function getSecure(){const _0x584d7c=_0xebe72d;return dbSecure[_0x584d7c(0x10c)](_0x584d7c(0x247))[_0x584d7c(0x248)]()||{};}function getBlacklist(){const _0x1c890e=_0xebe72d;return dbSecure[_0x1c890e(0x10c)](_0x1c890e(0x1d7))[_0x1c890e(0x248)]()||[];}function broadcastToBots(_0x1e22a8,_0x2d3ef7){const _0x5fddf5=_0xebe72d;config[_0x5fddf5(0x179)](_0x451f1b=>{const _0x4f3124=_0x5fddf5;if(_0x451f1b['status']==_0x4f3124(0x287)&&_0x451f1b[_0x4f3124(0x21e)]=='running'||_0x451f1b[_0x4f3124(0x1d2)]==_0x4f3124(0x1c3)&&_0x451f1b[_0x4f3124(0x21e)]==_0x4f3124(0x284)){if(pid[_0x451f1b[_0x4f3124(0x18e)]])pid[_0x451f1b[_0x4f3124(0x18e)]][_0x4f3124(0x19e)]({[_0x1e22a8]:_0x2d3ef7});}});}function storeSettings(_0xf593de,_0x3e7d88=![]){const _0x25aba0=_0xebe72d;_0xf593de={...settings,..._0xf593de};if(_0x3e7d88&&_0xf593de[_0x25aba0(0x294)]!=_0x25aba0(0x130)&&_0xf593de[_0x25aba0(0x294)]!=_0x25aba0(0x140)&&_0xf593de[_0x25aba0(0x294)]!=''){const _0x27bac4=crypt[_0x25aba0(0x259)](secure[_0x25aba0(0x266)],_0xf593de[_0x25aba0(0x294)])[_0x25aba0(0x1d5)][_0x25aba0(0x1b9)]('@')[0x0],_0xe510cd=bcrypt[_0x25aba0(0x133)](_0x27bac4,saltRounds);_0xf593de={..._0xf593de,'bbPassword':_0xe510cd};}if(_0x3e7d88&&_0xf593de['telegramToken']!=_0x25aba0(0x130)&&_0xf593de[_0x25aba0(0x155)]!=_0x25aba0(0x140)&&_0xf593de['telegramToken']!=''){const _0x1eb24d=crypt[_0x25aba0(0x259)](secure['privateKey'],_0xf593de[_0x25aba0(0x155)])[_0x25aba0(0x1d5)][_0x25aba0(0x1b9)]('@')[0x0];_0xf593de={..._0xf593de,'telegramToken':_0x1eb24d};}const _0x14fc14=_0xf593de[_0x25aba0(0x155)]!=_0x25aba0(0x130)&&_0xf593de[_0x25aba0(0x155)]!=settings[_0x25aba0(0x155)]||_0xf593de[_0x25aba0(0x222)]!=settings[_0x25aba0(0x222)],_0xc40e00=_0xf593de[_0x25aba0(0x155)]==''||_0xf593de[_0x25aba0(0x222)]=='';if(_0x14fc14)_0xf593de[_0x25aba0(0x21b)]='all';for(const [_0x717156,_0x1eb6cc]of Object['entries'](_0xf593de)){if(_0x717156=='telegramToken'&&_0x1eb6cc==_0x25aba0(0x130)){_0xf593de['telegramToken']=settings[_0x25aba0(0x155)];continue;};if(_0x717156==_0x25aba0(0x294)&&_0x1eb6cc==_0x25aba0(0x130)){_0xf593de[_0x25aba0(0x294)]=settings[_0x25aba0(0x294)];continue;};dbSettings[_0x25aba0(0x1fe)](_0x25aba0(0x25b)+_0x717156,_0x1eb6cc)['write']();}settings=_0xf593de,io['to'](_0x25aba0(0x213))[_0x25aba0(0x106)](_0x25aba0(0x243),cleanSettings()),broadcastToBots(_0x25aba0(0x146),settings[_0x25aba0(0x146)]),broadcastToBots(_0x25aba0(0x1ac),settings['onepagemode']);if(_0x14fc14&&!_0xc40e00)initTelegram();if(_0x14fc14&&_0xc40e00)disableTelegram();getAllClients()[_0x25aba0(0x179)](_0x1c079e=>{const _0x3dd89a=_0x25aba0;getSocket(_0x1c079e['id'])[_0x3dd89a(0x106)]('status',{'access':{'allow':![],'reason':_0x3dd89a(0x170),'token':null}});});}function updateSetting(_0x192d5b,_0x26e5ee){const _0x5cfc9e=_0xebe72d;dbSettings[_0x5cfc9e(0x1fe)]('settings.'+_0x192d5b,_0x26e5ee)[_0x5cfc9e(0x285)](),settings=getSettings(),io['to'](_0x5cfc9e(0x213))[_0x5cfc9e(0x106)]('settings',cleanSettings());}function storeSecure(_0x3a5fbb){const _0x13707c=_0xebe72d;dbSecure[_0x13707c(0x10c)](_0x13707c(0x247))[_0x13707c(0x200)](_0x3a5fbb)[_0x13707c(0x285)](),secure=_0x3a5fbb;}function addBlacklist(_0x409fff){const _0x203465=_0xebe72d;cleanBlacklist();let _0x13b35f;devices[_0x409fff][_0x203465(0x1cc)]?_0x13b35f=Math[_0x203465(0x1e2)](devices[_0x409fff][_0x203465(0x1cc)][_0x203465(0x126)],loginExpiry):_0x13b35f=loginExpiry,dbSecure[_0x203465(0x10c)](_0x203465(0x1d7))['push']({'expiry':new Date()[_0x203465(0x2bd)]()+_0x13b35f*0x3c*0x3e8,'token':devices[_0x409fff][_0x203465(0x2d1)][_0x203465(0x1b4)]})['write'](),blacklist=dbSecure[_0x203465(0x10c)](_0x203465(0x1d7))[_0x203465(0x248)]();}function cleanBlacklist(){const _0x2c8326=_0xebe72d;let _0x283677=dbSecure['get'](_0x2c8326(0x1d7))[_0x2c8326(0x1a6)]()[_0x2c8326(0x248)](),_0x57a88e=new Date()[_0x2c8326(0x2bd)]();_0x283677[_0x2c8326(0x179)](_0x4bf790=>{const _0x300513=_0x2c8326;_0x4bf790['expiry']<_0x57a88e&&dbSecure[_0x300513(0x10c)](_0x300513(0x1d7))['remove']({'expiry':_0x4bf790[_0x300513(0x126)]})['write']();});}function initStates(){const _0x34cf36=_0xebe72d;let _0x15ab5d=getConfiguration();_0x15ab5d[_0x34cf36(0x179)](_0x58489c=>{const _0x19f096=_0x34cf36;_0x58489c[_0x19f096(0x21e)]=_0x19f096(0x1b7);}),storeConfiguration(_0x15ab5d);}function onKeys(){const _0x5386b8=new RSA();return new Promise(_0x2aeb20=>{const _0x169dc8=_0x2b9f;_0x5386b8[_0x169dc8(0x13a)]()[_0x169dc8(0x144)](_0x1401b2=>{_0x2aeb20(_0x1401b2);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5d59fb=_0xebe72d;let _0x310b57=getSettings(),_0x11e0a3=![];!_0x310b57[_0x5d59fb(0x1a1)]('lastmsgtelegram')&&(_0x310b57[_0x5d59fb(0x107)]=0x0,_0x11e0a3=!![]);!_0x310b57[_0x5d59fb(0x1a1)]('lastmsgemitted')&&(_0x310b57[_0x5d59fb(0x237)]=0x0,_0x11e0a3=!![]);!_0x310b57[_0x5d59fb(0x1a1)](_0x5d59fb(0x17e))&&(_0x310b57[_0x5d59fb(0x17e)]='0.0.0',_0x11e0a3=!![]);!_0x310b57[_0x5d59fb(0x1a1)](_0x5d59fb(0x1ac))&&(_0x310b57[_0x5d59fb(0x1ac)]=![],_0x11e0a3=!![]);if(_0x11e0a3)storeSettings(_0x310b57);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x5d59fb(0x179)](_0x5ca003=>{const _0x117b39=_0x5d59fb;if(!_0x5ca003[_0x117b39(0x2b0)]()){if(!_0x5ca003[_0x117b39(0x1ef)][_0x117b39(0x15d)](_0x117b39(0x138)))fs['unlinkSync'](configbackuppath+_0x5ca003[_0x117b39(0x1ef)]);}else fs['rmSync'](configbackuppath+_0x5ca003[_0x117b39(0x1ef)],{'recursive':!![]});});}catch(_0x57dd79){logger[_0x5d59fb(0x23d)](_0x5d59fb(0x11b),_0x57dd79);}}function storeConfiguration(_0x409d81){const _0x3b21a9=_0xebe72d;dbConfig[_0x3b21a9(0x10c)](_0x3b21a9(0x2a6))[_0x3b21a9(0x1e0)]()[_0x3b21a9(0x285)](),_0x409d81[_0x3b21a9(0x179)](_0x2776cd=>{delete _0x2776cd['mode'];}),dbConfig[_0x3b21a9(0x10c)](_0x3b21a9(0x2a6))[_0x3b21a9(0x200)](..._0x409d81)[_0x3b21a9(0x285)](),config=_0x409d81;}function resetPassword(){const _0x1d26c7=_0xebe72d;tgBot&&settings[_0x1d26c7(0x263)]&&(tgBot[_0x1d26c7(0x21c)](_0x1d26c7(0x12c)),tgBot[_0x1d26c7(0x24a)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x1d26c7(0x2b5),'reply_markup':{'inline_keyboard':[[{'text':_0x1d26c7(0x11a),'callback_data':_0x1d26c7(0x11a)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x3e581d=>{telegramError(_0x3e581d);}),tgBot['on'](_0x1d26c7(0x12c),async _0xd1d6e1=>{const _0x1bed3a=_0x1d26c7,_0x3ecd03=_0xd1d6e1[_0x1bed3a(0x20a)],_0x479700=_0xd1d6e1[_0x1bed3a(0x1d5)];tgBot[_0x1bed3a(0x1b1)](_0xd1d6e1['id'])['then'](async()=>{const _0x3fda0e=_0x1bed3a;if(_0x3ecd03!='no'){const _0x573b83=0xf,_0x5a0c08=_0x3fda0e(0x2a5),_0x8edcf9=Array[_0x3fda0e(0x246)](crypto['randomFillSync'](new Uint32Array(_0x573b83)))['map'](_0x3aa0d3=>_0x5a0c08[_0x3aa0d3%_0x5a0c08[_0x3fda0e(0x10a)]])[_0x3fda0e(0x201)](''),_0x38763d=bcrypt['hashSync'](_0x8edcf9,saltRounds);storeSettings({'bbPassword':_0x38763d}),await tgBot[_0x3fda0e(0x24a)](_0x479700['chat']['id'],_0x3fda0e(0x223)+_0x8edcf9,{'parse_mode':_0x3fda0e(0x2b5)})[_0x3fda0e(0x231)](_0xa96874=>{telegramError(_0xa96874);});}else await tgBot[_0x3fda0e(0x24a)](_0x479700['chat']['id'],_0x3fda0e(0x17a))['catch'](_0x3650d9=>{telegramError(_0x3650d9);});}),tgBot[_0x1bed3a(0x21c)](_0x1bed3a(0x12c));}));}async function confirmRestore(_0x8e5bf5,_0x250905){const _0x223ce4=_0xebe72d;io['to'](_0x223ce4(0x213))[_0x223ce4(0x106)](_0x223ce4(0x2a4),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x223ce4(0x116)),tgBot&&settings[_0x223ce4(0x263)]&&(tgBot[_0x223ce4(0x21c)](_0x223ce4(0x12c)),await tgBot[_0x223ce4(0x24a)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x223ce4(0x2b5),'reply_markup':{'inline_keyboard':[[{'text':_0x223ce4(0x11a),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x587cc4=>{telegramError(_0x587cc4);}),tgBot['on']('callback_query',async _0x4afc8e=>{const _0x14ad21=_0x223ce4,_0x2a0ca6=_0x4afc8e[_0x14ad21(0x20a)],_0xb743d7=_0x4afc8e['message'];tgBot['answerCallbackQuery'](_0x4afc8e['id'])[_0x14ad21(0x144)](async()=>{const _0x2c84e1=_0x14ad21;_0x2a0ca6=='yes'?(await tgBot[_0x2c84e1(0x24a)](_0xb743d7['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x2c84e1(0x2b5)})[_0x2c84e1(0x231)](_0x46a12a=>{telegramError(_0x46a12a);}),unzipFile(_0x8e5bf5,_0x250905)):(logger[_0x2c84e1(0x23d)](_0x2c84e1(0x1ee)),await tgBot[_0x2c84e1(0x24a)](_0xb743d7['chat']['id'],'Restore\x20process\x20aborted')['catch'](_0x48cfa0=>{telegramError(_0x48cfa0);}));}),tgBot[_0x14ad21(0x21c)](_0x14ad21(0x12c));}));}function getServerTime(){const _0x1a48dd=_0xebe72d,_0x166f32=new Date();return _0x166f32[_0x1a48dd(0x26e)]()+'/'+(_0x166f32[_0x1a48dd(0x2ac)]()+0x1)[_0x1a48dd(0x1ff)]()[_0x1a48dd(0x1fb)](0x2,'0')+'/'+_0x166f32['getDate']()[_0x1a48dd(0x1ff)]()[_0x1a48dd(0x1fb)](0x2,'0')+'\x20'+_0x166f32[_0x1a48dd(0x112)]()[_0x1a48dd(0x1ff)]()[_0x1a48dd(0x1fb)](0x2,'0')+':'+_0x166f32[_0x1a48dd(0x15f)]()['toString']()[_0x1a48dd(0x1fb)](0x2,'0')+':'+_0x166f32[_0x1a48dd(0x10d)]()[_0x1a48dd(0x1ff)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x471a3f=_0xebe72d,_0x49272a=shiftedTime();return _0x49272a[_0x471a3f(0x26e)]()+'/'+(_0x49272a[_0x471a3f(0x2ac)]()+0x1)[_0x471a3f(0x1ff)]()[_0x471a3f(0x1fb)](0x2,'0')+'/'+_0x49272a[_0x471a3f(0x19a)]()[_0x471a3f(0x1ff)]()['padStart'](0x2,'0')+'\x20'+_0x49272a['getHours']()[_0x471a3f(0x1ff)]()[_0x471a3f(0x1fb)](0x2,'0')+':'+_0x49272a[_0x471a3f(0x15f)]()['toString']()[_0x471a3f(0x1fb)](0x2,'0')+':'+_0x49272a['getSeconds']()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x5b1a7a=_0xebe72d,_0x23a901=shiftedTime();return _0x23a901[_0x5b1a7a(0x26e)]()+(_0x23a901[_0x5b1a7a(0x2ac)]()+0x1)[_0x5b1a7a(0x1ff)]()[_0x5b1a7a(0x1fb)](0x2,'0')+_0x23a901[_0x5b1a7a(0x19a)]()[_0x5b1a7a(0x1ff)]()[_0x5b1a7a(0x1fb)](0x2,'0')+'-'+_0x23a901[_0x5b1a7a(0x112)]()[_0x5b1a7a(0x1ff)]()[_0x5b1a7a(0x1fb)](0x2,'0')+_0x23a901[_0x5b1a7a(0x15f)]()['toString']()[_0x5b1a7a(0x1fb)](0x2,'0')+_0x23a901[_0x5b1a7a(0x10d)]()[_0x5b1a7a(0x1ff)]()[_0x5b1a7a(0x1fb)](0x2,'0');}function shiftedTime(){const _0x307d0a=_0xebe72d,_0x141426=new Date();let _0x1feecf=_0x141426;if(settings[_0x307d0a(0x146)]&&settings['timeshift']!==0x0)_0x1feecf=fns[_0x307d0a(0x1c4)](_0x141426,{'hours':settings[_0x307d0a(0x146)]});return _0x1feecf;}function startScheduler(){const _0x43831a=_0xebe72d,_0x1d728b=new Date()[_0x43831a(0x12f)](),_0x309a5f=shiftedTime()[_0x43831a(0x112)]();_0x309a5f==0x4&&backupConfigFiles();_0x309a5f==0x0&&rotateLogFiles();_0x1d728b%0x6==0x0&&triggerAnalytics();_0x1d728b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2ed6a8){const _0x5c910e=_0xebe72d;logger[_0x5c910e(0x23d)]('Restore\x20backup\x20file\x20'+_0x2ed6a8);const _0x1aa211=getBotsWithMode();_0x1aa211[_0x5c910e(0x10a)]>0x0?confirmRestore(configbackuppath,_0x2ed6a8):unzipFile(configbackuppath,_0x2ed6a8);}async function getBackupFiles(_0x5668f7=null){const _0x41a4f7=_0xebe72d;let _0x339ec6=[],_0x4d219f=fs[_0x41a4f7(0x267)](configbackuppath,{'withFileTypes':!![]});_0x4d219f[_0x41a4f7(0x181)]((_0x4dd89d,_0x2c9f3f)=>_0x4dd89d[_0x41a4f7(0x1ef)]<_0x2c9f3f[_0x41a4f7(0x1ef)]?0x1:_0x2c9f3f['name']<_0x4dd89d[_0x41a4f7(0x1ef)]?-0x1:0x0),_0x4d219f['forEach'](_0x3c34db=>{const _0x12af6b=_0x41a4f7;if(!_0x3c34db[_0x12af6b(0x2b0)]()&&_0x3c34db[_0x12af6b(0x1ef)][_0x12af6b(0x15d)](_0x12af6b(0x138))&&_0x3c34db[_0x12af6b(0x1ef)][_0x12af6b(0x1e6)](_0x12af6b(0x239))){const _0x30c087=formatDate(fs[_0x12af6b(0x276)](configbackuppath+_0x3c34db[_0x12af6b(0x1ef)])[_0x12af6b(0x168)]);_0x339ec6[_0x12af6b(0x200)]({'name':_0x3c34db['name'],'mtime':_0x30c087});}});if(_0x5668f7)io['to'](_0x5668f7)[_0x41a4f7(0x106)](_0x41a4f7(0x2d6),_0x339ec6);else return _0x339ec6;}async function backupConfigFiles(){const _0x428e70=_0xebe72d;await zipFiles('backup-full');const _0x22cc12=getCleanTimeStamp();fs[_0x428e70(0x1a3)](zippath+_0x428e70(0x1cd),configbackuppath+(_0x428e70(0x138)+_0x22cc12+_0x428e70(0x239)));let _0x24fc5d=fs[_0x428e70(0x267)](configbackuppath,{'withFileTypes':!![]});_0x24fc5d[_0x428e70(0x181)]((_0x55fd82,_0x430475)=>_0x55fd82['name']<_0x430475[_0x428e70(0x1ef)]?0x1:_0x430475[_0x428e70(0x1ef)]<_0x55fd82[_0x428e70(0x1ef)]?-0x1:0x0),_0x24fc5d[_0x428e70(0x10a)]>maxBackups&&fs[_0x428e70(0x143)](configbackuppath+_0x24fc5d[_0x24fc5d['length']-0x1][_0x428e70(0x1ef)]);}function _0x45de(){const _0x435ec5=['::1','IPv4','headers','startsWith','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getMinutes','express-fileupload','restore-backup-file','Error:\x20Invalid\x20argument\x20','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','reinstall','randomBytes','6947181ehNTzX','mtime','includes','Token\x20blacklisted','[ip-address]','reject','Starting\x20new\x20bot\x20|\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20','Error\x20while\x20deleting\x20config\x20files:\x20','reload','get-messages','Unauthorized\x20attempt\x20to\x20get\x20events','store-fiat','connected','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','6b67f3d61ee94b8f5c80b4affef4c4d9','Unauthorized\x20attempt\x20to\x20show\x20configuration','new-disabled','forEach','Password\x20reset\x20rejected','listen','exit','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','latestversion','Ok,\x20will\x20send\x20order\x20notifications\x20only','Ok,\x20will\x20send\x20alert\x20notifications\x20only','sort','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','get-logs','332yZWIzI','index.html','Unauthorized\x20attempt\x20to\x20update\x20settings','Starting\x20Balance\x20Bot\x20update','bb/','clientip','remoteAddress','temp/','deleteHistoryAlerts','readFileSync','botID','ipaddr.js','slice','\x1b[33m','updatebotmanager','verify','emitHistory','output-001.log','\x20(1)','alias','-events.json','Invalid\x20username\x20or\x20IP\x20address','getDate','/names\x20-\x20show\x20bot\x20names\x0a','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','get-portfolio','send','node-telegram-bot-api','match','hasOwnProperty','node-zip','copyFileSync','function','stringify','cloneDeep','search','/disable\x20-\x20disable\x20notifications\x0a','build2','simple','full','onepagemode','showConfig','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','chat','answerCallbackQuery','\x1b[0m','assign','token','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','use','stopped','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','split','login\x20not\x20required','SIGTERM','user','Unauthorized\x20attempt\x20to\x20update\x20bot','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','RSA','pidExpireLogin','login\x20token\x20generated','Orders','new','add','bbvReceive','logs/','/output-000.log','log','botname',',\x20must\x20be\x20a\x204\x20digit\x20number','bbvNew','telegramIpApproval','backup-full.zip','=>\x20Go\x20to\x20#CYA#http://','sortBy','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','File\x20uploaded','status','apply','lowdb/adapters/FileSync','message','sendFile','blacklist','\x20|\x20','\x20>\x20','RSA-OAEP','</b>\x20?','conn','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','exec','mode','remove','existsSync','max','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Node.js\x20v','placeOrder','endsWith','apiSecret','15\x20min','Backup\x20file\x20uploaded','Markdown','2FA\x20login\x20required','createServer','bot','Restore\x20process\x20aborted','name','-performance.json','Logged\x20in\x20user\x20...','files','Enabled\x20Bot\x20','place-order','Notifications\x20enabled\x0a','referer','replace','toggleBotMode','date-fns','Invalid\x20Telegram\x20token','padStart','compareSync','defaults','set','toString','push','join','5\x20min','1933594KHVPXQ','bb-secure.json','allow','store-headless','temporary\x20access\x20not\x20allowed','/:bot/portfolio','temporary\x20access\x20rejected','data','uncaughtException','\x20|\x20client:\x20...','2FA\x20login\x20token\x20generated','telegrammsg','order','bot.js','auth','Unauthorized\x20attempt\x20to\x20download\x20','botmanager','timestamp','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','file','socket.io','writeFileSync','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','telegramEvents','removeListener','::ffff:127.0.0.1','live','store-configuration','Starting\x20#RED#Balance\x20Bot\x20v','started','telegramUsername','Password\x20has\x20been\x20reset\x20to:\x20','express','8oSdLbx','Alerts','family','port','reset-history','bcryptjs','lowdb','removeAllListeners','/on\x20-\x20start\x20bot(s)\x0a','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','DEFLATE','catch','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','add-bot','7359552mpLsvX','All\x20bots','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','lastmsgemitted','21603IBFPrm','.zip','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','login\x20token\x20valid','debug','Server','headless','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Access\x20enabled\x20for\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','settings','string','rmSync','from','secure','value','Unauthorized\x20attempt\x20to\x20confirm\x20message','sendMessage','_data','config/','/download/:type','Bot\x20','$1_$2_$3','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','request','Notifications\x20disabled','bb-config.json','reason','Unauthorized\x20attempt\x20to\x20add\x20bot','show','-----------------------------------------------------------------------------------','decrypt','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','settings.','messages','reinstall-bb','Starting\x20bot\x20|\x20Bot\x20','tkn','apiPassword','cancelLoading','2FA\x20required','telegramChatId','\x1b[35m','find','privateKey','readdirSync','clients','restart','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','store','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','output-002.log','getFullYear','accept','30\x20min','show-config','mixpanel','login\x20required','util','post','statSync','min','args','\x20|\x20user:\x20...','all','get-starting-balances','404\x20Not\x20Found','secret','password','mkdirSync','username','error','access\x20timeout','update-bb','running','write','1HHLymL','enabled','1000','Setting\x20access:\x20','/off\x20-\x20stop\x20bot(s)\x0a','storeConfiguration','logout','-config.json','Idling\x20bot\x20\x20\x20|\x20Bot\x20','exp','disabled','api-eu.mixpanel.com','#RES#\x20if\x20running\x20on\x20server','title','bbPassword','ipv6','\x20minutes','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','invalid\x20credentials','orders','publicKey','/metrics\x20-\x20show\x20bot\x20performance\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','params','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegramEnabled','parse','4820YUZMvS','stopPolling','init','notification','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','bots','size','\x1b[34m','<b>Telegram\x20Bot\x20Status:</b>\x0a','Invalid\x20authentication\x20token\x20(2)','number','getMonth','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Network\x20Interfaces:','(((.+)+)+)+$','isDirectory','42SBjTxr','backup','5478fXbdHV','encryptedUuid','HTML','track','whitelistEnabled','/:bot','event','\x1b[36m','pidRefreshToken','binary','getTime','connection','socket','build','uuid-random','update','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','alerts','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','fork','Disabled\x20Bot\x20','telegram2FaApproval','1853680HKTYha','hex','sockets','268807aEeGCL','https://api.ipify.org?format=json','generate','whitelist','exchange','access','-results.json','bot-','Unauthorized\x20attempt\x20to\x20delete\x20bot','polling_error','backup-files','node','Starting\x20Balance\x20Bot\x20reinstallation','login','logs','All','All\x20bots\x20running\x20right\x20now','isValid','storeHeadless','loginRequired','versions','User\x20has\x20been\x20validated','path','type','emit','lastmsgtelegram','sendPortfolioTelegram','delete-alerts','length','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','get','getSeconds','showname','isIPv4MappedAddress','stop','test','getHours','uuid','/:bot/configuration','output-003.log','success','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Crypt','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','yes','Error\x20removing\x20old\x20backup\x20files:','bbUsername','sendMetricsTelegram','Notifications\x20enabled','onText','apiKey','toIPv4MappedAddress','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','output-000.log','kind','internal','expiry','constructor','cancel-loading','version.json','f2aRequired','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','callback_query','inherit','3000','getUTCHours','************','handshake',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','hashSync','manual','auto','zip/','filter','backup-full@','jsonwebtoken','generateKeyPairAsync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getStartingBalances','server','get-backup-files','*$1*','***','userid','toggle-bot-mode','unlinkSync','then','once','timeshift','No\x20bots\x20running\x20right\x20now','update-bot','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Starting\x20Balance\x20Bot\x20','format','storeFiat','warning','Unauthorized\x20attempt\x20to\x20log\x20out','/help\x20-\x20show\x20available\x20commands\x0a','disconnect','Notifications\x20types:\x20','sign','backupfile','Logged\x20out\x20user\x20...','telegramToken','keys','/restart\x20-\x20restart\x20bot(s)\x0a','/upload-backup','Session\x20expired\x20for\x20user\x20...'];_0x45de=function(){return _0x435ec5;};return _0x45de();}function rotateLogFiles(){const _0x1793f0=_0xebe72d,_0x10a52c=fs[_0x1793f0(0x276)](logspath+_0x1793f0(0x123)),_0x3810d9=_0x10a52c[_0x1793f0(0x2a7)]/0x400;if(_0x3810d9>0x64){let _0x22754c=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x22754c[_0x1793f0(0x181)]((_0x325f19,_0x2f75f2)=>_0x325f19[_0x1793f0(0x1ef)]<_0x2f75f2[_0x1793f0(0x1ef)]?0x1:_0x2f75f2['name']<_0x325f19[_0x1793f0(0x1ef)]?-0x1:0x0),_0x22754c['forEach'](_0x569680=>{const _0x4b66d1=_0x1793f0;if(_0x569680[_0x4b66d1(0x1ef)]==_0x4b66d1(0x26d))fs[_0x4b66d1(0x1a3)](logspath+_0x569680[_0x4b66d1(0x1ef)],logspath+_0x4b66d1(0x115));if(_0x569680['name']==_0x4b66d1(0x195))fs['copyFileSync'](logspath+_0x569680['name'],logspath+'output-002.log');_0x569680[_0x4b66d1(0x1ef)]=='output-000.log'&&(fs[_0x4b66d1(0x1a3)](logspath+_0x569680[_0x4b66d1(0x1ef)],logspath+_0x4b66d1(0x195)),fs[_0x4b66d1(0x218)](logspath+_0x569680[_0x4b66d1(0x1ef)],''));});}}async function zipFiles(_0x30521c){const _0x410be2=_0xebe72d;let _0x147cfe;if(_0x30521c==_0x410be2(0xfc))_0x147cfe=logspath;if(_0x30521c==_0x410be2(0x2b2))_0x147cfe=configpath;if(_0x30521c=='backup-full')_0x147cfe=configpath;let _0xc9d77c=fs[_0x410be2(0x267)](_0x147cfe,{'withFileTypes':!![]});const _0x4c6704=new require(_0x410be2(0x1a2))();_0xc9d77c['forEach'](_0x5bdd19=>{const _0x4ea535=_0x410be2;if(!_0x5bdd19['isDirectory']()){let _0x11697a=fs['readFileSync'](_0x147cfe+_0x5bdd19[_0x4ea535(0x1ef)]);if(_0x30521c==_0x4ea535(0x2b2)){const _0x3e3534=/^bot-[0-9]{3}-config.json$/,_0x1e9ccd=_0x3e3534[_0x4ea535(0x111)](_0x5bdd19['name']);if(_0x1e9ccd){const _0x233b8f=JSON[_0x4ea535(0x2a0)](_0x11697a);if(_0x233b8f[_0x4ea535(0x1ed)][0x0]){_0x233b8f[_0x4ea535(0x1ed)][0x0][_0x4ea535(0x120)]='***',_0x233b8f[_0x4ea535(0x1ed)][0x0][_0x4ea535(0x1e7)]=_0x4ea535(0x140);if(_0x233b8f[_0x4ea535(0x1ed)][0x0][_0x4ea535(0x260)])_0x233b8f[_0x4ea535(0x1ed)][0x0][_0x4ea535(0x260)]=_0x4ea535(0x140);}_0x11697a=JSON[_0x4ea535(0x1a5)](_0x233b8f,null,0x2);}if(_0x5bdd19['name']=='bb-settings.json'){const _0x17c87=JSON['parse'](_0x11697a);if(_0x17c87[_0x4ea535(0x243)][_0x4ea535(0x101)])_0x17c87[_0x4ea535(0x243)][_0x4ea535(0x101)]=![];if(_0x17c87[_0x4ea535(0x243)][_0x4ea535(0x294)])_0x17c87['settings'][_0x4ea535(0x294)]=_0x4ea535(0x140);if(_0x17c87[_0x4ea535(0x243)][_0x4ea535(0x155)])_0x17c87[_0x4ea535(0x243)]['telegramToken']=_0x4ea535(0x140);if(_0x17c87[_0x4ea535(0x243)]['telegramChatId'])_0x17c87['settings'][_0x4ea535(0x263)]=null;_0x11697a=JSON[_0x4ea535(0x1a5)](_0x17c87,null,0x2);}if(_0x5bdd19[_0x4ea535(0x1ef)]!='bb-secure.json')_0x4c6704[_0x4ea535(0x216)](_0x5bdd19[_0x4ea535(0x1ef)],_0x11697a);}else _0x4c6704[_0x4ea535(0x216)](_0x5bdd19['name'],_0x11697a);}});const _0x195fa7=_0x4c6704[_0x410be2(0x2ce)]({'base64':![],'compression':_0x410be2(0x230)});fs[_0x410be2(0x218)](zippath+(_0x30521c+'.zip'),_0x195fa7,_0x410be2(0x2bc));}async function unzipFile(_0x50299c,_0x1e5ba6){const _0x3652ff=_0xebe72d;fs[_0x3652ff(0x267)](configpath,{'withFileTypes':!![]})[_0x3652ff(0x179)](_0x434905=>{const _0x27988e=_0x3652ff;if(!_0x434905[_0x27988e(0x2b0)]())fs['rmSync'](configpath+_0x434905[_0x27988e(0x1ef)]);});const _0x126d0c=fs[_0x3652ff(0x18d)](_0x50299c+_0x1e5ba6,'binary'),_0x3f0467=new require(_0x3652ff(0x1a2))(_0x126d0c,{'base64':![],'checkCRC32':!![]});Object[_0x3652ff(0x156)](_0x3f0467[_0x3652ff(0x1f2)])[_0x3652ff(0x179)](_0x105346=>{const _0x1512dd=_0x3652ff,_0x1dd2af=_0x3f0467[_0x1512dd(0x1f2)][_0x105346];fs[_0x1512dd(0x218)](configpath+_0x1dd2af['name'],_0x1dd2af[_0x1512dd(0x24b)]);}),fs[_0x3652ff(0x267)](temppath,{'withFileTypes':!![]})[_0x3652ff(0x179)](_0x2e7522=>{const _0x2d4e56=_0x3652ff;if(!_0x2e7522['isDirectory']())fs[_0x2d4e56(0x245)](temppath+_0x2e7522[_0x2d4e56(0x1ef)]);}),logger[_0x3652ff(0x23d)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x3652ff(0x19e)]({'restore':!![]},_0x15914d=>{});}async function getPublicIp(){const _0x2918c4=_0xebe72d;try{const _0x463ff0=await axios[_0x2918c4(0x10c)](_0x2918c4(0x2cd));publicip=_0x463ff0[_0x2918c4(0x20a)]['ip'];}catch(_0x47759f){}}async function triggerAnalytics(){const _0x1fad55=_0xebe72d;if(!publicip)await getPublicIp();const _0x569ecb=getBotsWithMode();let _0xc6e2bc=0x0;_0x569ecb['forEach'](_0x56c939=>{const _0x54c757=_0x2b9f;if(_0x56c939[_0x54c757(0x1d2)]===_0x54c757(0x287))_0xc6e2bc++;});const _0x5d896f=getBotExchanges();mixpanel[_0x1fad55(0x2b6)](_0x1fad55(0x23e),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x569ecb['length'],'numbotsenabled':_0xc6e2bc,'exchanges':_0x5d896f});}async function getMessages(){const _0x5d472d=_0xebe72d,_0x102d04=_0x5d472d(0x23a),_0x5d4fd9=new GraphQLClient(_0x102d04),_0x3cd528={'authorization':_0x5d472d(0x219)},_0x53c284=serverversion['split']('.'),_0x50f123=_0x53c284[0x0]+'.'+_0x53c284[0x1],_0x29c7dc=Math[_0x5d472d(0x277)](settings[_0x5d472d(0x107)],settings[_0x5d472d(0x237)]),_0x1d71fc={'last':parseInt(_0x29c7dc),'bbm':_0x50f123},_0x58a219=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x10b2d5;try{_0x10b2d5=await _0x5d4fd9[_0x5d472d(0x252)](_0x58a219,_0x1d71fc,_0x3cd528);}catch(_0x5a8947){}if(_0x10b2d5&&_0x10b2d5[_0x5d472d(0x25c)]){let _0x5978df=settings[_0x5d472d(0x107)];newMessages=[];for(const _0x4f00be of _0x10b2d5['messages']){newMessages[_0x5d472d(0x200)](_0x4f00be);if(_0x4f00be[_0x5d472d(0x1cb)])updateSetting(_0x5d472d(0x17e),_0x4f00be[_0x5d472d(0x1cb)]);let _0xb405bf=_0x4f00be['bbvNew']?serverversion>=_0x4f00be[_0x5d472d(0x1cb)]:![];if(!_0xb405bf&&_0x4f00be[_0x5d472d(0x2ab)]>_0x5978df){if(_0x4f00be[_0x5d472d(0x1c5)]==='any'||serverversion['startsWith'](_0x4f00be['bbvReceive'])){let _0xda9c04=''+_0x4f00be[_0x5d472d(0x293)]+'\x0a\x0a'+_0x4f00be[_0x5d472d(0x1d5)];const _0x3eceb1=await sendTelegramMsg(toTelegramMarkdown(_0xda9c04),_0x5d472d(0x1ea));if(_0x3eceb1)_0x5978df=_0x4f00be[_0x5d472d(0x2ab)];}}}updateAvailable=isNewerVersion(settings[_0x5d472d(0x17e)],serverversion),updateSetting('lastmsgtelegram',_0x5978df),emitMessages();}}function emitMessages(){const _0x2d1aec=_0xebe72d,_0x43db91=settings[_0x2d1aec(0x237)];let _0x3a0a74=[];newMessages[_0x2d1aec(0x179)](_0x322840=>{_0x322840['number']>_0x43db91&&_0x3a0a74['push'](_0x322840);}),_0x3a0a74['length']>0x0&&getAllClients()[_0x2d1aec(0x179)](_0x236f94=>{getSocket(_0x236f94['id'])['emit']('message',_0x3a0a74);});}function confirmMessage(_0x2c4352){updateSetting('lastmsgemitted',Number(_0x2c4352));}function isNewerVersion(_0xe34290,_0x3fda15){const _0xf313e=_0xebe72d,_0x41514e=_0x3fda15['split']('.'),_0x458f7f=_0xe34290[_0xf313e(0x1b9)]('.');for(var _0x5cf476=0x0;_0x5cf476<_0x458f7f[_0xf313e(0x10a)];_0x5cf476++){const _0x4d7176=~~_0x458f7f[_0x5cf476],_0xee7141=~~_0x41514e[_0x5cf476];if(_0x4d7176>_0xee7141)return!![];if(_0x4d7176<_0xee7141)return![];}return![];}function toTelegramMarkdown(_0x271a59){const _0x483180=_0xebe72d,_0x31d55d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x55b298=/\*{2}(.+?)\*{2}/gim;return _0x271a59=_0x271a59[_0x483180(0x1f7)](_0x31d55d,_0x483180(0x24f))['replace'](_0x55b298,_0x483180(0x13f)),_0x271a59;}async function validateConfigFile(){const _0x33632d=_0xebe72d,_0x56f3a1=dbConfig[_0x33632d(0x10c)]('bots')['sortBy'](_0x33632d(0x18e))['value']()||[];if(_0x56f3a1['length']==0x0){let _0x6b4539=0x0,_0x3f4144=[];const _0x580435=/^bot-([0-9]{3})-config.json$/,_0x11e60e=fs[_0x33632d(0x267)](configpath);_0x11e60e[_0x33632d(0x179)](_0x4c09dc=>{const _0x3f222a=_0x33632d,_0x16b074=_0x580435[_0x3f222a(0x1de)](_0x4c09dc);if(_0x16b074){const _0x21d0c5=_0x16b074[0x1];let _0x2165da=getBotAttributes(_0x21d0c5);_0x3f4144[_0x3f222a(0x200)]({'botID':_0x21d0c5,'botname':_0x2165da[_0x3f222a(0x1c9)],'status':'disabled','live':_0x3f222a(0x1b7)}),_0x6b4539++;}}),_0x6b4539!=0x0&&(dbConfig[_0x33632d(0x10c)](_0x33632d(0x2a6))[_0x33632d(0x1b3)](_0x3f4144)[_0x33632d(0x285)](),config=_0x3f4144,restoredConfigFile=_0x6b4539);}}async function restoreConfigNotify(_0x48ebbb){const _0x535e97=_0xebe72d;let _0x2cc573;if(restoredConfigFile==0x1)_0x2cc573=_0x535e97(0x175);else _0x2cc573=_0x535e97(0x12b);if(_0x48ebbb)io['to'](_0x535e97(0x213))[_0x535e97(0x106)](_0x535e97(0x2a4),_0x2cc573);else{logger['simple'](_0x535e97(0x258)),logger[_0x535e97(0x1aa)](_0x2cc573),logger[_0x535e97(0x1aa)](_0x535e97(0x258)),logger[_0x535e97(0x1aa)]('');if(tgBot&&settings[_0x535e97(0x263)]&&settings['telegramEvents']!=_0x535e97(0x299))tgBot[_0x535e97(0x24a)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x2cc573)[_0x535e97(0x231)](_0x45e68f=>{telegramError(_0x45e68f);});}}function validateCredentials(_0xbb36c2,_0x784d6b){const _0x111e27=_0xebe72d;if(_0xbb36c2[_0x111e27(0x280)]==settings[_0x111e27(0x11c)]&&bcrypt[_0x111e27(0x1fc)](_0xbb36c2['password'],settings[_0x111e27(0x294)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x111e27(0x1eb),'token':null};else{const _0x5021a2=generateLoginToken(_0x784d6b);return{'allow':!![],'reason':_0x111e27(0x1c1),'token':_0x5021a2};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x4c7f2e){const _0x5e9ac4=generateLoginToken(_0x4c7f2e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5e9ac4};}function validateAccess(_0x1655f5,_0x36fd53,_0x405d0b){const _0x10a478=_0xebe72d,_0x987790=_0x405d0b?_0x405d0b:devices[_0x36fd53]['ip'];let _0x56755a;const _0x22ecd4=_0x1ff284=>{const _0xde3b79=_0x2b9f;if(settings['loginRequired']){if(settings[_0xde3b79(0x12a)]){if(telegram2FaApproved(_0x36fd53)){const _0x412eb6=generateLoginToken(_0x36fd53);return{'allow':!![],'reason':_0xde3b79(0x20d),'token':_0x412eb6};}else return{'allow':![],'reason':_0xde3b79(0x273),'token':null};}else return _0x56755a=validToken(_0x1ff284,_0x36fd53),_0x56755a[_0xde3b79(0x1a1)](_0xde3b79(0x116))?{'allow':!![],'reason':_0xde3b79(0x23c),'token':_0x1ff284}:{'allow':![],'reason':_0xde3b79(0x273),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x10a478(0x2b7)]){let _0x19415b=[...settings[_0x10a478(0x2cf)],_0x10a478(0x15a),_0x10a478(0x21d),'127.0.0.1'];if(_0x19415b[_0x10a478(0x169)](_0x987790))return _0x22ecd4(_0x1655f5);else{_0x56755a=validToken(_0x1655f5,_0x36fd53);if(_0x56755a[_0x10a478(0x1a1)](_0x10a478(0x116)))return _0x22ecd4(_0x1655f5);else{if(telegramIpApproved(_0x36fd53)){const _0x136ddb=generateToken(_0x36fd53);return _0x56755a=_0x22ecd4(_0x1655f5),_0x56755a[_0x10a478(0x205)]?{'allow':!![],'reason':_0x10a478(0x1ae),'token':_0x136ddb}:_0x56755a;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x10a478(0x262),'token':null}:{'allow':![],'reason':_0x10a478(0x207),'token':null};}}}else return _0x22ecd4(_0x1655f5);}function timelyDecrypt(_0x13bbb4,_0x96660c=!![]){const _0x95eb99=_0xebe72d;if(_0x13bbb4)try{const _0x1ebf7a=crypt[_0x95eb99(0x259)](secure['privateKey'],_0x13bbb4)[_0x95eb99(0x1d5)],_0x1482d8=_0x1ebf7a[_0x95eb99(0x1b9)]('@')[0x0],_0x3e1f18=_0x1ebf7a[_0x95eb99(0x1b9)]('@')[0x1],_0x46fa01=new Date()[_0x95eb99(0x2bd)]();if(_0x96660c){if(_0x46fa01-_0x3e1f18<maxSecretAge*0x3e8)return _0x1482d8;else return![];}else return _0x1482d8;}catch(_0x13f426){return![];}else return![];}const validToken=(_0x493659,_0x93b6f4)=>{const _0x8ab121=_0xebe72d,_0xf88111=devices[_0x93b6f4]['ip'];if(!_0x493659)return{'error':'No\x20authentication\x20token'};for(let _0x306c98 of blacklist){if(_0x306c98[_0x8ab121(0x1b4)]==_0x493659)return{'error':_0x8ab121(0x16a)};}let _0x5d98bb;try{_0x5d98bb=jwt[_0x8ab121(0x193)](_0x493659,secure['secret']+_0x93b6f4);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5d98bb['hasOwnProperty'](_0x8ab121(0x189))&&!_0x5d98bb[_0x8ab121(0x1a1)](_0x8ab121(0x280))||!_0x5d98bb[_0x8ab121(0x1a1)](_0x8ab121(0x28f)))return{'error':_0x8ab121(0x2aa)};if(!_0x5d98bb[_0x8ab121(0x1a1)](_0x8ab121(0x280))&&_0x5d98bb[_0x8ab121(0x1a1)](_0x8ab121(0x189))){const {clientip:_0x6212c1}=_0x5d98bb;return _0xf88111==_0x6212c1?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5d98bb[_0x8ab121(0x1a1)](_0x8ab121(0x280))&&_0x5d98bb[_0x8ab121(0x1a1)]('clientip')){const {username:_0x26a24b,clientip:_0x47cc66}=_0x5d98bb;return settings[_0x8ab121(0x11c)]==_0x26a24b&&_0xf88111==_0x47cc66?{'success':_0x8ab121(0x103)}:{'error':_0x8ab121(0x199)};}}},generateLoginToken=_0x3370e9=>{const _0x2b2a0c=_0xebe72d;if(_0x3370e9){const _0x159946=devices[_0x3370e9]['ip'];return jwt['sign']({'username':settings[_0x2b2a0c(0x11c)],'clientip':_0x159946},secure[_0x2b2a0c(0x27d)]+_0x3370e9,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x384228=>{const _0x24848b=_0xebe72d;if(_0x384228){const _0xfb81d1=devices[_0x384228]['ip'];return jwt[_0x24848b(0x152)]({'clientip':_0xfb81d1},secure['secret']+_0x384228,{'expiresIn':devices[_0x384228]['telegramIpApproval'][_0x24848b(0x126)]*0x3c});}else return![];},telegramIpApproved=_0x41dfc6=>{const _0xc5e894=_0xebe72d;let _0x240500=![];return devices[_0x41dfc6][_0xc5e894(0x1cc)]&&devices[_0x41dfc6][_0xc5e894(0x1cc)][_0xc5e894(0x126)]!='reject'&&(_0x240500=devices[_0x41dfc6]['telegramIpApproval'][_0xc5e894(0x189)]==devices[_0x41dfc6]['ip']&&new Date()['getTime']()-devices[_0x41dfc6][_0xc5e894(0x1cc)][_0xc5e894(0x214)]<devices[_0x41dfc6]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x240500;},telegram2FaApproved=_0x117f55=>{const _0x864325=_0xebe72d;let _0x29a84c=![];return devices[_0x117f55]['telegram2FaApproval']&&devices[_0x117f55][_0x864325(0x2c8)][_0x864325(0x126)]!='reject'&&(_0x29a84c=devices[_0x117f55][_0x864325(0x2c8)][_0x864325(0x189)]==devices[_0x117f55]['ip']&&new Date()[_0x864325(0x2bd)]()-devices[_0x117f55]['telegram2FaApproval'][_0x864325(0x214)]<devices[_0x117f55][_0x864325(0x2c8)][_0x864325(0x126)]*0x3c*0x3e8),_0x29a84c;},normalizeIP=_0x9a0057=>{const _0x55fbb7=_0xebe72d;let _0x501b96=null,_0x55794=null;if(ipaddr[_0x55fbb7(0xff)](_0x9a0057)){const _0x163c00=ipaddr[_0x55fbb7(0x2a0)](_0x9a0057);_0x163c00[_0x55fbb7(0x124)]()===_0x55fbb7(0x295)?(_0x163c00[_0x55fbb7(0x10f)]()&&(_0x501b96=_0x163c00['toIPv4Address']()[_0x55fbb7(0x1ff)]()),_0x55794=_0x163c00[_0x55fbb7(0x1ff)]()):(_0x501b96=_0x163c00[_0x55fbb7(0x1ff)](),_0x55794=_0x163c00[_0x55fbb7(0x121)]()['toString']());}return{'show':_0x501b96?_0x501b96:_0x55794,'store':_0x55794};};function formatDate(_0x4e17f2){const _0x44a801=_0xebe72d;return _0x4e17f2[_0x44a801(0x26e)]()+'/'+(_0x4e17f2[_0x44a801(0x2ac)]()+0x1)[_0x44a801(0x1ff)]()[_0x44a801(0x1fb)](0x2,'0')+'/'+_0x4e17f2['getDate']()[_0x44a801(0x1ff)]()['padStart'](0x2,'0')+'\x20'+_0x4e17f2[_0x44a801(0x112)]()[_0x44a801(0x1ff)]()[_0x44a801(0x1fb)](0x2,'0')+':'+_0x4e17f2[_0x44a801(0x15f)]()[_0x44a801(0x1ff)]()['padStart'](0x2,'0')+':'+_0x4e17f2[_0x44a801(0x10d)]()[_0x44a801(0x1ff)]()['padStart'](0x2,'0');}function sleep(_0x3485fa){return new Promise(_0x57c1de=>setTimeout(_0x57c1de,_0x3485fa));}