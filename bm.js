const _0x107b97=_0x537f;(function(_0x135f97,_0x28d0f1){const _0x51548b=_0x537f,_0x4e39a3=_0x135f97();while(!![]){try{const _0x1f69a3=-parseInt(_0x51548b(0x232))/0x1*(parseInt(_0x51548b(0x251))/0x2)+parseInt(_0x51548b(0xb0))/0x3+parseInt(_0x51548b(0xa6))/0x4*(-parseInt(_0x51548b(0x1bc))/0x5)+-parseInt(_0x51548b(0x193))/0x6*(parseInt(_0x51548b(0x14f))/0x7)+parseInt(_0x51548b(0x1fd))/0x8+-parseInt(_0x51548b(0x186))/0x9*(-parseInt(_0x51548b(0x1c9))/0xa)+-parseInt(_0x51548b(0xdf))/0xb;if(_0x1f69a3===_0x28d0f1)break;else _0x4e39a3['push'](_0x4e39a3['shift']());}catch(_0xbb4412){_0x4e39a3['push'](_0x4e39a3['shift']());}}}(_0x594c,0x929f7));const _0xe9d025=function(){let _0x2a15c4=!![];return function(_0x43b9ce,_0x5987b0){const _0x3ec14e=_0x2a15c4?function(){if(_0x5987b0){const _0x3e4731=_0x5987b0['apply'](_0x43b9ce,arguments);return _0x5987b0=null,_0x3e4731;}}:function(){};return _0x2a15c4=![],_0x3ec14e;};}(),_0x15ba72=_0xe9d025(this,function(){const _0x4eb9fe=_0x537f;return _0x15ba72[_0x4eb9fe(0x9b)]()[_0x4eb9fe(0x246)]('(((.+)+)+)+$')[_0x4eb9fe(0x9b)]()[_0x4eb9fe(0x122)](_0x15ba72)[_0x4eb9fe(0x246)](_0x4eb9fe(0x124));});_0x15ba72();'use strict';process[_0x107b97(0x257)][_0x107b97(0x133)]=0x1;const childProcess=require(_0x107b97(0x1bb)),fs=require('fs'),fns=require(_0x107b97(0x1de)),low=require(_0x107b97(0xce)),FileSync=require(_0x107b97(0x158)),path=require(_0x107b97(0x207)),crypto=require(_0x107b97(0x165)),Crypt=require('hybrid-crypto-js')[_0x107b97(0x188)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x107b97(0xbf)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x107b97(0x249))(process[_0x107b97(0xd8)][_0x107b97(0x168)](0x2))['argv'],uuidRandom=require(_0x107b97(0x1b8)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x107b97(0xb4)),axios=require('axios'),{GraphQLClient,gql}=require(_0x107b97(0xfc)),util=require(_0x107b97(0x1e7)),fileUpload=require(_0x107b97(0x283)),{networkInterfaces}=require('os'),PORT=argv[_0x107b97(0x163)]||_0x107b97(0x233),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x107b97(0xb5)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x107b97(0x1b7)),process[_0x107b97(0x21e)](0x1));const HOST=argv[_0x107b97(0x1c3)]||null,userID=argv[_0x107b97(0x177)]||'',debugging=argv['d']||![],nodeversion=process[_0x107b97(0xeb)][_0x107b97(0xaf)];let bbpath=_0x107b97(0xfe),bbpath2='';const botfile=_0x107b97(0x1a1),configfile=_0x107b97(0x22a),settingsfile=_0x107b97(0x222),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x107b97(0x29b))[_0x107b97(0xec)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x107b97(0x14b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x107b97(0x102)+userID+'/':bbpath+_0x107b97(0x102),configbackuppath=configpath+_0x107b97(0xdb),logspath=userID?bbpath+_0x107b97(0xcc)+userID+'/':bbpath+_0x107b97(0xcc),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x107b97(0x202),loggerfile=fs['createWriteStream'](logspath+_0x107b97(0x1dc),{'flags':'a'}),temppath=userID?bbpath+_0x107b97(0x1f2)+userID+'/':bbpath+_0x107b97(0x1f2);!fs[_0x107b97(0x14b)](configpath)&&fs[_0x107b97(0xcd)](configpath);!fs[_0x107b97(0x14b)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x107b97(0x14b)](logspath)&&fs[_0x107b97(0xcd)](logspath);!fs[_0x107b97(0x14b)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x107b97(0x14b)](temppath)&&fs[_0x107b97(0xcd)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x107b97(0x20e)]({'bots':[]})[_0x107b97(0x15f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x107b97(0x20e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x107b97(0x28e),'onepagemode':![]}})[_0x107b97(0x15f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x107b97(0x1e1),'rsaStandard':_0x107b97(0x26d)});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings[_0x107b97(0xd4)]!=_0x107b97(0x254))&&settings[_0x107b97(0x157)]&&settings[_0x107b97(0x157)]!='')initTelegram();const parseColor=(_0x3f706d,_0x40d3c4)=>{const _0x340c3b=_0x107b97,_0x53af1f=/#[A-Z]{3}#/g;if(typeof _0x3f706d==_0x340c3b(0x18c)){!_0x40d3c4?_0x3f706d=_0x3f706d[_0x340c3b(0x208)](_0x53af1f,''):(_0x3f706d=_0x3f706d[_0x340c3b(0x208)](/#BLU#/g,_0x340c3b(0x276)),_0x3f706d=_0x3f706d[_0x340c3b(0x208)](/#RED#/g,_0x340c3b(0xa1)),_0x3f706d=_0x3f706d[_0x340c3b(0x208)](/#YEL#/g,_0x340c3b(0x11a)),_0x3f706d=_0x3f706d['replace'](/#MAG#/g,_0x340c3b(0x1d4)),_0x3f706d=_0x3f706d[_0x340c3b(0x208)](/#CYA#/g,_0x340c3b(0x144)),_0x3f706d=_0x3f706d[_0x340c3b(0x208)](/#RES#/g,_0x340c3b(0x24f)));;}return _0x3f706d;},logger={'screen':_0x48798b=>{console['log'](parseColor(_0x48798b,!![]));},'simple':_0x3fedc=>{const _0x1f5594=_0x107b97;console[_0x1f5594(0xb5)](parseColor(_0x3fedc,!![])),loggerfile[_0x1f5594(0x15f)](util[_0x1f5594(0x105)](parseColor(_0x3fedc,![]))+'\x0a');},'full':async _0x1ad544=>{const _0x4f14b1=_0x107b97,_0x5ba62c=getTimeStamp()+_0x4f14b1(0x162)+_0x1ad544;console[_0x4f14b1(0xb5)](parseColor(_0x5ba62c,!![])),loggerfile[_0x4f14b1(0x15f)](util[_0x4f14b1(0x105)](parseColor(_0x5ba62c,![]))+'\x0a');if(tgBot&&settings[_0x4f14b1(0x204)]&&settings[_0x4f14b1(0xf1)]!='orders')await sendTelegram(settings['telegramChatId'],_0x4f14b1(0x25f)+parseColor(_0x1ad544,![]));},'debug':async(_0x1270a5,_0x430641='')=>{const _0x1b1c29=_0x107b97,_0x5f3d83=getTimeStamp()+_0x1b1c29(0x161)+_0x1270a5;if(debugging)console[_0x1b1c29(0xb5)](parseColor(_0x5f3d83,!![]));loggerfile[_0x1b1c29(0x15f)](util[_0x1b1c29(0x105)](parseColor(_0x5f3d83,![]))+'\x0a');if(_0x430641){if(debugging)console[_0x1b1c29(0xb5)](_0x430641);loggerfile[_0x1b1c29(0x15f)](util[_0x1b1c29(0x105)](_0x430641)+'\x0a');}}};let terminating=![];process['on'](_0x107b97(0x151),function(_0x208164){const _0xd0a544=_0x107b97;logger[_0xd0a544(0xbb)](_0x208164);}),process['on'](_0x107b97(0x21e),()=>{stopAllBots();}),process['on'](_0x107b97(0x131),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x107b97(0x29b))[_0x107b97(0x16d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x594c(){const _0x39e5f4=['name','loginRequired','randomBytes','status','warning','backup-files','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','settings','Server','getStartingBalances','SIGINT','expiry','NTBA_FIX_319','Markdown','files','getMonth','storeHeadless','new-disabled','encryptedUuid','sort','telegrammsg','\x20|\x20','isIPv4MappedAddress','restore-backup-file','login\x20required','lastmsgtelegram','/:bot/configuration','show-config','sign','\x1b[36m','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Invalid\x20authentication\x20token\x20(1)','/download/:type','Bot\x20','emit','args','existsSync','reinstall_yes','delete-alerts','hex','14ORMjRt','logout','uncaughtException','orders','readFileSync','express','#RES#\x20if\x20running\x20on\x20server','isDirectory','telegramUsername','lowdb/adapters/FileSync','command','manual','No\x20bots\x20running\x20right\x20now','.zip','toggle_','Unauthorized\x20attempt\x20to\x20confirm\x20message','write','getPortfolio',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20',':\x20Bot\x20Mgr\x20>\x20','port','Enabled\x20Bot\x20','crypto','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','/disable\x20-\x20disable\x20notifications\x0a','slice','length','getFullYear','new','build','version','[ip-address]','inlineKeyboard','remoteAddress','help','Restore\x20backup\x20file\x20','off_','once','keys','message','user','auth','Token\x20blacklisted','bbUsername','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Access\x20enabled\x20for\x20','tempaccess_15_','title','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20log\x20out','request','telegramEnabled','enable','Yes','pidExpireLogin','9vjgbTv','file','Crypt','Password\x20reset\x20rejected','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','publicKey','string','metrics_','store-configuration','messages','store','bbPassword','Disabled\x20Bot\x20','1585926CpPmGx','rmSync','output-000.log','update-bb','privateKey','Allow\x20login\x20from\x20IP\x20address\x20','\x20to\x20','telegram2FaApproval','binary','temporary\x20access\x20rejected','backupfile','kind','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','You\x20can\x20use\x20the\x20following\x20commands:\x0a','bot.js','Logged\x20in\x20user\x20...','token','/:bot/history','test','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','value','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','telegram','IPv4','build2','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','add-bot','\x20only\x0a','apiKey','yes','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Notifications\x20disabled\x0a','assign','remove',',\x20must\x20be\x20a\x204\x20digit\x20number','uuid-random','hashSync','from','child_process','74885dTxdnS','Starting\x20(','Login\x20rejected','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','action','access','show','host','/:bot/portfolio','store-fiat','/update\x20-\x20update\x20Balance\x20Bot\x0a','secret','stopped','4861930YEkNEn','fork','login\x20token\x20valid','server','placeOrder','push','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','address','login','<b>Balance\x20Bot\x20Status:</b>\x0a','Unauthorized\x20login\x20attempt\x20(timeout)','\x1b[35m','login\x20token\x20generated','lastmsgemitted','Starting\x20Balance\x20Bot\x20reinstallation','enabled','https://api.ipify.org?format=json','headers','get-starting-balances','/output-000.log','\x20mode','date-fns','5\x20min','auto','sha256','botmanager','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','editMessageReplyMarkup','http','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','util','config_orders','temporary\x20access\x20timeout','showname','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','disabled','toIPv4Address','params','download',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','resetHistory','temp/','Temporary\x20access\x20rejected','backup-full@','reload','-events.json','Starting\x20#RED#Balance\x20Bot\x20v','All\x20bots','password','Starting\x20new\x20bot\x20|\x20Bot\x20','use','getHours','1762368efheMe','latestversion','restart_','-config.json','join','zip/','family','telegramChatId','uuid','event','path','replace','started','/start','callback','\x20(1)','telegramIpApproval','defaults','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','get','verify','listen','************','min','reply','update','removeAllListeners','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','toggle-bot-mode','compareSync','Unauthorized\x20attempt\x20to\x20add\x20bot','close','exit','forEach','Notifications\x20types:\x20','names','bb-settings.json','ipv6','Unauthorized\x20attempt\x20to\x20delete\x20alerts','index.html','Alerts','exec','User\x20has\x20been\x20validated','copyFileSync','bb-config.json','cloneDeep','resetpw_yes','alerts','Error\x20removing\x20old\x20backup\x20files:','statSync','node-zip','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','121571CCUuQX','3000','::1','clientip','#RES#\x20if\x20running\x20locally\x0a','Logged\x20out\x20user\x20...','cancel-loading','Unauthorized\x20attempt\x20to\x20delete\x20bot','then','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','backup-full','Error\x20while\x20deleting\x20config\x20files:\x20','hasOwnProperty','Restore\x20process\x20confirmed','number','get-logs','bbvNew','f2aRequired','login2fa_reject_','userid','search','Notifications\x20enabled\x0a','HTML','yargs/yargs','Deleted\x20Bot\x20','sendMessage','getSeconds','staging','success','\x1b[0m','Ok,\x20will\x20send\x20order\x20notifications\x20only','2DQzcqW','Failed\x20to\x20download\x20','handshake','***','stringify','/:bot/support','env','entries','2FA\x20required','readdirSync','Session\x20expired\x20for\x20user\x20...','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','tempaccess_30_','config','Bot\x20Mgr\x20>\x20','place-order','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','running','internal','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','mode','private',')\x20\x20\x20|\x20Bot\x20','15\x20min','conn','<b>Telegram\x20Bot\x20Status:</b>\x0a','store-settings','unlinkSync','RSA-OAEP','backup','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','match','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','any','padStart','reinstall-bb','settings.','\x1b[34m','stop','No\x20authentication\x20token','reason','decrypt','ipc','secure','getTime','set','username','delete-bot','max','bots','express-fileupload','2FA\x20login\x20token\x20generated','login\x20not\x20required','generate','2FA\x20login\x20rejected','\x20|\x20client:\x20...','Restore\x20process\x20aborted','_data','reject','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','chat','0.0.0','order','Notifications\x20disabled','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','emitHistory','Restoring\x20bot(s)\x20from\x20backup','all','allow','Unauthorized\x20attempt\x20to\x20store\x20configuration','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','$1_$2_$3','button','-performance.json','version.json','config_all','startsWith','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','disconnect','1000','/restart\x20-\x20restart\x20bot(s)\x0a','data','toString','restore_no_','update-bot','Orders','restart','inherit','\x1b[31m','Backup\x20file\x20unzipped\x20and\x20stored','portfolio_','metrics','sendPortfolioTelegram','68bVlfKH','=>\x20Go\x20to\x20#CYA#http://','apiPassword','range','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20get\x20portfolio','endsWith','accept','node','3189096vbBPbO','sockets','notification','generateKeyPairAsync','mixpanel','log','referer','error','onepagemode','All\x20bots\x20running\x20right\x20now','send','simple','add','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','-results.json','bcryptjs','find','bbvReceive','reset-history','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','headless','deleteHistoryAlerts','/off\x20-\x20stop\x20bot(s)\x0a','update_yes','timestamp','sortBy','logs/','mkdirSync','lowdb','/help\x20-\x20show\x20available\x20commands\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Telegram\x20error:','cancelLoading','login2fa_','telegramToken','\x20>\x20','bot-','Starting\x20Balance\x20Bot\x20update','argv','getDate','Restarting\x20Bot\x20','backup/','writeFileSync','store-headless','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','2905452qpVBiL','parse','timeshift','sendFile','pidRefreshToken','DEFLATE','bot','get-messages','Ok,\x20will\x20send\x20alert\x20notifications\x20only','resetpw_no','live','debug','versions','environment','filter','tkn','kill','whitelist','telegramEvents','output-002.log','socket','config_alerts','type','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','logs','exp','sendMetricsTelegram','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','graphql-request','temporary\x20token\x20generated','bb/','botname','Password\x20has\x20been\x20reset\x20to:\x20','reinstall','config/','full','blacklist','format','confirm-message','-----------------------------------------------------------------------------------','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Invalid\x20authentication\x20token\x20(2)','text','socket.io','toggleBotMode','backup-full.zip','alias','off','static','post',')\x20|\x20Bot\x20','2FA','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','exchange','Unauthorized\x20attempt\x20to\x20show\x20configuration','getMinutes','Login\x20accepted','\x1b[33m','/:bot','showConfig','All','Invalid\x20IP\x20address','track','connected','botID','constructor','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','(((.+)+)+)+$','invalid\x20credentials','split'];_0x594c=function(){return _0x39e5f4;};return _0x594c();}const express=require(_0x107b97(0x154)),app=express(),http=require(_0x107b97(0x1e5))['createServer'](app);app[_0x107b97(0x1fb)](fileUpload({'useTempFiles':!![]})),app['get'](_0x107b97(0x147),async(_0x1f0c51,_0x2520f2)=>{const _0x40794f=_0x107b97,_0x12413a=_0x1f0c51[_0x40794f(0x1ee)]['type'],_0x4cf49d=getClientsWithBotID(_0x40794f(0x1e2)),_0x3b765b=_0x1f0c51[_0x40794f(0x1da)][_0x40794f(0x205)],_0x26c835=timelyDecrypt(_0x3b765b,![]),_0x2f5647=_0x4cf49d[_0x40794f(0xc0)](_0x265066=>_0x265066[_0x40794f(0x205)]==_0x26c835);if(_0x2f5647){const _0x226f5c=normalizeIP(_0x1f0c51[_0x40794f(0xf3)]['remoteAddress'])[_0x40794f(0x190)],_0x33056d=_0x1f0c51[_0x40794f(0x1da)][_0x40794f(0xee)];if(validateAccess(_0x33056d,_0x26c835,_0x226f5c)[_0x40794f(0x295)])_0x12413a==_0x40794f(0x26e)&&await backupConfigFiles(),await zipFiles(_0x12413a),_0x2520f2[_0x40794f(0x1ef)](zippath+(_0x12413a+_0x40794f(0x15c)),_0x953ecd=>{const _0x45b6e8=_0x40794f;_0x953ecd&&(logger[_0x45b6e8(0x103)](_0x45b6e8(0x252)+_0x12413a),logger['simple'](_0x953ecd));});else logger[_0x40794f(0x103)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x12413a+_0x40794f(0x20c));}else logger[_0x40794f(0x103)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x12413a+'\x20(2)');}),app[_0x107b97(0x111)]('/upload-backup',async(_0x3e41c7,_0xbdce8a)=>{const _0x5c8e62=_0x107b97,_0x46f979=getClientsWithBotID(_0x5c8e62(0x1e2)),_0x384f37=_0x3e41c7['headers'][_0x5c8e62(0x205)],_0x1d4449=timelyDecrypt(_0x384f37,![]),_0x43f748=_0x46f979['find'](_0x22ae6b=>_0x22ae6b['uuid']==_0x1d4449);logger['debug']('Backup\x20file\x20uploaded');if(_0x43f748){const _0x4d9189=normalizeIP(_0x3e41c7[_0x5c8e62(0xf3)]['remoteAddress'])[_0x5c8e62(0x190)],_0x2b35f9=_0x3e41c7[_0x5c8e62(0x1da)][_0x5c8e62(0xee)];if(validateAccess(_0x2b35f9,_0x1d4449,_0x4d9189)[_0x5c8e62(0x295)]){if(_0x3e41c7[_0x5c8e62(0x135)]){const _0x43fd1f=_0x3e41c7[_0x5c8e62(0x135)][_0x5c8e62(0x19d)];await _0x43fd1f['mv'](temppath+_0x43fd1f[_0x5c8e62(0x127)]),_0xbdce8a['send']({'status':!![],'message':'File\x20uploaded'});const _0xba86e3=getBotsWithMode();_0xba86e3['length']>0x0?confirmRestore(temppath,_0x43fd1f[_0x5c8e62(0x127)]):unzipFile(temppath,_0x43fd1f[_0x5c8e62(0x127)]);}}else logger[_0x5c8e62(0x103)](_0x5c8e62(0x25c));}else logger[_0x5c8e62(0x103)](_0x5c8e62(0x1eb));}),app[_0x107b97(0x1fb)](express[_0x107b97(0x110)](path[_0x107b97(0x201)](__dirname,bbpath2,_0x107b97(0x1ad)))),app['use'](express[_0x107b97(0x110)](path['join'](__dirname,bbpath2,_0x107b97(0x16c)))),app[_0x107b97(0x211)]('/',function(_0xc1027a,_0x2d4a33){const _0x3bbc9a=_0x107b97;_0x2d4a33[_0x3bbc9a(0xe2)](path['join'](__dirname,bbpath2,_0x3bbc9a(0x1ad),_0x3bbc9a(0x225)));}),app['get'](_0x107b97(0x11b),function(_0xcb73f2,_0x19a764){const _0x5c74b7=_0x107b97;_0x19a764['sendFile'](path[_0x5c74b7(0x201)](__dirname,bbpath2,_0x5c74b7(0x16c),_0x5c74b7(0x225)));}),app[_0x107b97(0x211)](_0x107b97(0x1c4),(_0x4482d0,_0x1ce85a)=>{const _0x3a69c9=_0x107b97;_0x1ce85a['sendFile'](path[_0x3a69c9(0x201)](__dirname,bbpath2,'build',_0x3a69c9(0x225)));}),app['get']('/:bot/performance',(_0x2884bb,_0x3c94df)=>{const _0x554b8a=_0x107b97;_0x3c94df[_0x554b8a(0xe2)](path[_0x554b8a(0x201)](__dirname,bbpath2,_0x554b8a(0x16c),_0x554b8a(0x225)));}),app[_0x107b97(0x211)]('/:bot/coins',(_0x3e9703,_0x369b45)=>{const _0x480cfb=_0x107b97;_0x369b45['sendFile'](path[_0x480cfb(0x201)](__dirname,bbpath2,_0x480cfb(0x16c),_0x480cfb(0x225)));}),app[_0x107b97(0x211)](_0x107b97(0x1a4),(_0x3cad21,_0x1457f0)=>{const _0x26844c=_0x107b97;_0x1457f0['sendFile'](path[_0x26844c(0x201)](__dirname,bbpath2,_0x26844c(0x16c),_0x26844c(0x225)));}),app[_0x107b97(0x211)](_0x107b97(0x141),(_0x3aa699,_0x15d8d1)=>{const _0x3d6b83=_0x107b97;_0x15d8d1[_0x3d6b83(0xe2)](path[_0x3d6b83(0x201)](__dirname,bbpath2,_0x3d6b83(0x16c),'index.html'));}),app[_0x107b97(0x211)](_0x107b97(0x256),(_0x235862,_0x5d23e3)=>{const _0x683de0=_0x107b97;_0x5d23e3[_0x683de0(0xe2)](path['join'](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x107b97(0x213)](PORT,HOST);else http[_0x107b97(0x213)](PORT);const io=require(_0x107b97(0x10b))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x355751=_0x107b97;let _0x269e8a=_0x355751(0x16e);const _0x580fcb=networkInterfaces(),_0x253c63={};for(const _0x4805af of Object[_0x355751(0x175)](_0x580fcb)){for(const _0x50abe7 of _0x580fcb[_0x4805af]){if((_0x50abe7[_0x355751(0x203)]==_0x355751(0x1ac)||_0x50abe7[_0x355751(0x203)]==0x4)&&!_0x50abe7[_0x355751(0x263)]){const _0x3671f2=ipaddr[_0x355751(0xe0)](_0x50abe7[_0x355751(0x1d0)])[_0x355751(0xa9)]();_0x3671f2!=_0x355751(0x266)&&(!_0x253c63[_0x4805af]&&(_0x253c63[_0x4805af]=[]),_0x253c63[_0x4805af]['push'](_0x50abe7[_0x355751(0x1d0)]),_0x269e8a=_0x50abe7['address']);}}}return{'serverip':_0x269e8a,'netinterfaces':_0x253c63};}async function startServer(){const _0x51d086=_0x107b97,{serverip:_0x280f74,netinterfaces:_0x569b36}=getServerIP();logger[_0x51d086(0xbb)](''),logger['simple'](_0x51d086(0x107)),await logger['full'](_0x51d086(0x1f7)+serverversion+'#RES#\x20'+(environment==_0x51d086(0x24d)?'(staging)':'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x51d086(0x236))+(_0x51d086(0xa7)+_0x280f74+':'+PORT+_0x51d086(0x155))),logger[_0x51d086(0xbb)](_0x51d086(0x107));if(config[_0x51d086(0x169)]!=0x0)for(const _0x2b1a96 of config){const _0x14641e=_0x2b1a96[_0x51d086(0x265)]==_0x51d086(0x1e0)?'a':'m';if(_0x2b1a96['status']=='enabled'||_0x2b1a96[_0x51d086(0x12a)]==_0x51d086(0x16b))await logger[_0x51d086(0x103)](_0x51d086(0x1bd)+_0x14641e+_0x51d086(0x112)+_0x2b1a96[_0x51d086(0x121)]+_0x51d086(0x13c)+_0x2b1a96[_0x51d086(0xff)]),startBot([_0x2b1a96[_0x51d086(0x121)],userID],{'cwd':bbpath},function(_0x3ef011){const _0x2819a3=_0x51d086;if(_0x3ef011)logger[_0x2819a3(0x103)](_0x3ef011);});else(_0x2b1a96[_0x51d086(0x12a)]==_0x51d086(0x1ec)||_0x2b1a96[_0x51d086(0x12a)]==_0x51d086(0x138))&&await logger[_0x51d086(0x103)]('Idling\x20('+_0x14641e+_0x51d086(0x267)+_0x2b1a96['botID']+'\x20|\x20'+_0x2b1a96['botname']);}else!newBot&&logger[_0x51d086(0xbb)](_0x51d086(0x17b));if(newBot)addBot();logger[_0x51d086(0xbb)]('-----------------------------------------------------------------------------------'),logger[_0x51d086(0xbb)](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger[_0x51d086(0xea)]('Network\x20Interfaces:',_0x569b36);}function startSocket(){io['on']('connection',_0x984cc5=>{const _0x5992f7=_0x537f;let _0x5ea910,_0x25adfc,_0x117a9c,_0x413624,_0x2b03db;const _0x50447e=_0x984cc5[_0x5992f7(0x253)]['headers'][_0x5992f7(0xb6)];_0x25adfc=_0x50447e[_0x5992f7(0x270)](/bot[0-9]{3}/);if(_0x25adfc)_0x117a9c=_0x25adfc[0x0][_0x5992f7(0x270)](/[0-9]{3}/);if(_0x117a9c)_0x5ea910=_0x117a9c[0x0];else _0x5ea910='botmanager';const _0x507f73=_0x984cc5[_0x5992f7(0x253)][_0x5992f7(0x178)][_0x5992f7(0x139)];if(!_0x507f73)_0x984cc5[_0x5992f7(0x149)](_0x5992f7(0x12a),{'publicKey':secure[_0x5992f7(0x18b)]});else{_0x413624=timelyDecrypt(_0x507f73,![]);if(!_0x413624)_0x984cc5[_0x5992f7(0x149)]('status',{'publicKey':secure[_0x5992f7(0x18b)]});else{_0x2b03db=normalizeIP(_0x984cc5[_0x5992f7(0x269)][_0x5992f7(0x170)])[_0x5992f7(0x190)];if(!devices[_0x413624])devices[_0x413624]={'uuid':_0x413624,'access':{'token':null}};devices[_0x413624]['ip']=_0x2b03db;const _0x3d53b7=addClient(_0x984cc5['id'],_0x413624,_0x5ea910);setAccess(_0x3d53b7),emitMessages(),_0x984cc5['on'](_0x5992f7(0x1d1),_0x30f683=>{const _0x681b65=_0x5992f7,_0x1cab6d=timelyDecrypt(_0x30f683[_0x681b65(0x1f9)]);if(_0x1cab6d){_0x30f683={'username':_0x30f683[_0x681b65(0x27f)],'password':_0x1cab6d},devices[_0x413624][_0x681b65(0x1c1)]=validateCredentials(_0x30f683,_0x413624);if(devices[_0x413624][_0x681b65(0x1c1)][_0x681b65(0x295)]==![]&&devices[_0x413624][_0x681b65(0x1c1)][_0x681b65(0x279)]=='2FA\x20login\x20required')_0x984cc5[_0x681b65(0x149)](_0x681b65(0x12a),{'access':devices[_0x413624][_0x681b65(0x1c1)]}),loginAccess2FA(_0x413624,_0x2b03db);else{if(devices[_0x413624][_0x681b65(0x1c1)][_0x681b65(0x295)]==![]&&devices[_0x413624]['access']['reason']=='invalid\x20credentials')_0x984cc5['emit'](_0x681b65(0x12a),{'access':devices[_0x413624][_0x681b65(0x1c1)]});else devices[_0x413624][_0x681b65(0x1c1)]['allow']&&devices[_0x413624][_0x681b65(0x1c1)][_0x681b65(0x279)]==_0x681b65(0x1d5)&&(getClientsWithUuid(_0x413624)[_0x681b65(0x21f)](_0x42c3ba=>{setAccess(_0x42c3ba);}),logger['debug'](_0x681b65(0x1a2)+_0x413624[_0x681b65(0x168)](-0x8)),setTokenRefresh(_0x413624),setSessionTimeout(_0x681b65(0x1d1),_0x413624));}}else logger['full'](_0x681b65(0x1d3));}),_0x984cc5['on']('reset-password',()=>{resetPassword();}),_0x984cc5['on'](_0x5992f7(0x97),_0x595567=>{removeClient(_0x984cc5['id']);}),_0x5ea910=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x305813){const _0x10907e=_0x107b97;if(_0x305813!=_0x10907e(0x1e2)&&config['apiKey']!=''){if(pid[_0x305813])pid[_0x305813][_0x10907e(0xba)]({'function':'initclient','args':null});}_0x305813!='botmanager'&&broadcastToBots(_0x10907e(0x282),JSON[_0x10907e(0x255)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0xe761c2=>{const _0x97c181=_0x537f;getSocket(_0xe761c2['id'])[_0x97c181(0x149)](_0x97c181(0x12a),{'access':{'allow':![],'reason':_0x97c181(0x1f5),'token':null}});});}function getSocket(_0x54a1ef){const _0x2c6c3d=_0x107b97;return io[_0x2c6c3d(0xb1)]['sockets'][_0x2c6c3d(0x211)](_0x54a1ef);}function setAccess(_0x2213ca){const _0x4263fe=_0x107b97,_0x500445=getSocket(_0x2213ca['id']),_0x25b557=_0x2213ca[_0x4263fe(0x205)],_0x3ba344=_0x2213ca[_0x4263fe(0xe5)];devices[_0x25b557][_0x4263fe(0x1c1)]=validateAccess(devices[_0x25b557][_0x4263fe(0x1c1)][_0x4263fe(0x1a3)],_0x25b557),logger['debug']('Setting\x20access:\x20'+devices[_0x25b557][_0x4263fe(0x1c1)][_0x4263fe(0x279)]+_0x4263fe(0x288)+_0x2213ca['id'][_0x4263fe(0x168)](-0x8)+_0x4263fe(0xab)+_0x25b557[_0x4263fe(0x168)](-0x8)),_0x500445[_0x4263fe(0x201)](_0x25b557);if(devices[_0x25b557]['access'][_0x4263fe(0x295)]){_0x500445[_0x4263fe(0x201)](_0x3ba344);if(_0x3ba344==_0x4263fe(0x1e2))initializeSocketBotManager(_0x500445);else initializeSocketBot(_0x500445);initClient(_0x3ba344);}devices[_0x25b557]['access'][_0x4263fe(0x1a3)]&&devices[_0x25b557][_0x4263fe(0x1c1)][_0x4263fe(0x279)]==_0x4263fe(0xfd)&&setSessionTimeout(_0x4263fe(0x113),_0x25b557),devices[_0x25b557]['access'][_0x4263fe(0x1a3)]&&devices[_0x25b557][_0x4263fe(0x1c1)]['reason']==_0x4263fe(0x284)&&setSessionTimeout('login',_0x25b557),_0x500445[_0x4263fe(0x149)](_0x4263fe(0x12a),{'status':_0x2213ca[_0x4263fe(0x1cc)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x25b557][_0x4263fe(0x1c1)],'externalip':devices[_0x25b557]['ip'],'publicKey':secure[_0x4263fe(0x18b)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x25b557][_0x4263fe(0x1c1)][_0x4263fe(0x295)]==![]&&devices[_0x25b557][_0x4263fe(0x1c1)][_0x4263fe(0x279)]==_0x4263fe(0x259)&&temporaryAccess2FA(_0x25b557,devices[_0x25b557]['ip']);}function setSessionTimeout(_0x2ac98c,_0x29610a){const _0x1e856d=_0x107b97;let _0x121ebc;if(_0x2ac98c==_0x1e856d(0x1d1))_0x121ebc=loginExpiry*0x3c*0x3e8;else _0x121ebc=devices[_0x29610a][_0x1e856d(0x20d)][_0x1e856d(0x132)]*0x3c*0x3e8-(new Date()[_0x1e856d(0x27d)]()-devices[_0x29610a][_0x1e856d(0x20d)]['timestamp']);if(devices[_0x29610a]['pidExpireLogin'])clearTimeout(devices[_0x29610a][_0x1e856d(0x185)]);devices[_0x29610a][_0x1e856d(0x185)]=setTimeout(()=>{const _0x31a4ca=_0x1e856d;if(devices[_0x29610a]['pidRefreshToken'])clearTimeout(devices[_0x29610a][_0x31a4ca(0xe3)]);removeSocketListeners(_0x29610a),addBlacklist(_0x29610a),devices[_0x29610a][_0x31a4ca(0x20d)]=null,devices[_0x29610a][_0x31a4ca(0x19a)]=null,devices[_0x29610a][_0x31a4ca(0x1c1)]['token']=null,logger[_0x31a4ca(0xea)](_0x31a4ca(0x25b)+_0x29610a['slice'](-0x8)),devices[_0x29610a][_0x31a4ca(0x1c1)]=validateAccess(devices[_0x29610a]['access'][_0x31a4ca(0x1a3)],_0x29610a),!(devices[_0x29610a]['access']['allow']&&devices[_0x29610a][_0x31a4ca(0x1c1)][_0x31a4ca(0x279)]==_0x31a4ca(0x285))&&(_0x2ac98c==_0x31a4ca(0x1d1)?io['to'](_0x29610a)[_0x31a4ca(0x149)](_0x31a4ca(0x12a),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x29610a)[_0x31a4ca(0x149)](_0x31a4ca(0x12a),{'access':{'allow':![],'reason':_0x31a4ca(0x1e9),'token':null}})),devices[_0x29610a][_0x31a4ca(0x1c1)][_0x31a4ca(0x1a3)]=null;},_0x121ebc);}function setTokenRefresh(_0x141f14){const _0x594fc8=_0x107b97;if(devices[_0x141f14][_0x594fc8(0xe3)])clearTimeout(devices[_0x141f14]['pidRefreshToken']);devices[_0x141f14]['pidRefreshToken']=setTimeout(()=>{const _0x9464c=_0x594fc8;getClientsWithUuid(_0x141f14)['length']!=0x0?(devices[_0x141f14][_0x9464c(0x1c1)]=refreshToken(_0x141f14),io['to'](_0x141f14)[_0x9464c(0x149)](_0x9464c(0x12a),{'status':_0x9464c(0x120),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x141f14][_0x9464c(0x1c1)],'externalip':devices[_0x141f14]['ip'],'publicKey':secure[_0x9464c(0x18b)],'validInstallation':validInstallation}),setTokenRefresh(_0x141f14)):clearTimeout(devices[_0x141f14]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xfc9e94){const _0x2f4f3e=_0x107b97,_0x229822=getClient(_0xfc9e94['id'])[_0x2f4f3e(0x205)];_0xfc9e94[_0x2f4f3e(0x149)]('bots',config),_0xfc9e94['emit'](_0x2f4f3e(0x12e),cleanSettings()),_0xfc9e94['on'](_0x2f4f3e(0x1af),_0x265644=>{const _0x552783=_0x2f4f3e;if(validateAccess(_0x265644,_0x229822)[_0x552783(0x295)])addBot();else logger[_0x552783(0x103)](_0x552783(0x21c));}),_0xfc9e94['on'](_0x2f4f3e(0x9d),(_0x5906e6,_0x5124d4)=>{const _0x366aa9=_0x2f4f3e;if(validateAccess(_0x5124d4,_0x229822)[_0x366aa9(0x295)])toggleBot(_0x5906e6[_0x366aa9(0x121)],_0x5906e6['status'],_0x5906e6[_0x366aa9(0xe9)]);else logger[_0x366aa9(0x103)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xfc9e94['on'](_0x2f4f3e(0x21a),(_0x224338,_0x4ed255)=>{if(validateAccess(_0x4ed255,_0x229822)['allow'])toggleBotMode(_0x224338);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xfc9e94['on'](_0x2f4f3e(0x280),(_0x52ed22,_0x4f131b)=>{const _0xafd030=_0x2f4f3e;if(validateAccess(_0x4f131b,_0x229822)[_0xafd030(0x295)])deleteBot(_0x52ed22);else logger['full'](_0xafd030(0x239));}),_0xfc9e94['on'](_0x2f4f3e(0x26b),(_0x5da29d,_0x4ad3a6)=>{const _0x4a8c20=_0x2f4f3e;if(validateAccess(_0x4ad3a6,_0x229822)[_0x4a8c20(0x295)])storeSettings(_0x5da29d,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0xfc9e94['on'](_0x2f4f3e(0x196),_0x46cefd=>{const _0x41a5ca=_0x2f4f3e;if(validateAccess(_0x46cefd,_0x229822)[_0x41a5ca(0x295)])updateBB(_0x41a5ca(0x217));else logger[_0x41a5ca(0x103)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0xfc9e94['on'](_0x2f4f3e(0x274),_0x4c4c11=>{const _0x4a7789=_0x2f4f3e;if(validateAccess(_0x4c4c11,_0x229822)[_0x4a7789(0x295)])updateBB(_0x4a7789(0x101));else logger['full'](_0x4a7789(0x261));}),_0xfc9e94['on']('get-backup-files',_0x28e927=>{const _0x35a0fe=_0x2f4f3e;if(validateAccess(_0x28e927,_0x229822)['allow']){const _0x59b702=getClient(_0xfc9e94['id']);if(_0x59b702)getBackupFiles(_0x59b702[_0x35a0fe(0x205)]);else logger[_0x35a0fe(0x103)](_0x35a0fe(0xfa));}else logger[_0x35a0fe(0x103)](_0x35a0fe(0x123));}),_0xfc9e94['on'](_0x2f4f3e(0x13e),(_0x31c145,_0x1f2a11)=>{const _0x553923=_0x2f4f3e;if(validateAccess(_0x1f2a11,_0x229822)[_0x553923(0x295)])restoreBackupFile(_0x31c145);else logger[_0x553923(0x103)](_0x553923(0xc4));}),_0xfc9e94['on'](_0x2f4f3e(0xe6),_0x103dd6=>{const _0x26c341=_0x2f4f3e;if(validateAccess(_0x103dd6,_0x229822)[_0x26c341(0x295)])getMessages();else logger[_0x26c341(0x103)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xfc9e94['on'](_0x2f4f3e(0x106),(_0x46a73b,_0x13d41f)=>{const _0x2e79c6=_0x2f4f3e;if(validateAccess(_0x13d41f,_0x229822)[_0x2e79c6(0x295)])confirmMessage(_0x46a73b);else logger['full'](_0x2e79c6(0x15e));}),_0xfc9e94['on'](_0x2f4f3e(0x150),_0x3c2ae5=>{const _0x595f28=_0x2f4f3e;if(validateAccess(_0x3c2ae5,_0x229822)[_0x595f28(0x295)]){if(devices[_0x229822][_0x595f28(0xe3)])clearTimeout(devices[_0x229822][_0x595f28(0xe3)]);if(devices[_0x229822]['pidExpireLogin'])clearTimeout(devices[_0x229822]['pidExpireLogin']);removeSocketListeners(getClient(_0xfc9e94['id'])[_0x595f28(0x205)]),addBlacklist(_0x229822),devices[_0x229822]['telegramIpApproval']=null,devices[_0x229822][_0x595f28(0x19a)]=null,devices[_0x229822][_0x595f28(0x1c1)][_0x595f28(0x1a3)]=null,logger['debug'](_0x595f28(0x237)+_0x229822['slice'](-0x8)),io['to'](getClient(_0xfc9e94['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x595f28(0x103)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x1b990c){const _0x353cdf=_0x107b97,_0x4ab7e7=getClient(_0x1b990c['id'])['bot'],_0x172e3e=getClient(_0x1b990c['id'])['uuid'];_0x1b990c['on'](_0x353cdf(0x241),(_0x547447,_0x241a2f)=>{const _0x40dc0e=_0x353cdf;if(validateAccess(_0x241a2f,_0x172e3e)[_0x40dc0e(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x40dc0e(0xba)]({'function':_0x40dc0e(0x292),'args':_0x547447});}else logger[_0x40dc0e(0x103)](_0x40dc0e(0xc3));}),_0x1b990c['on'](_0x353cdf(0x14d),(_0x474eb4,_0x18504a)=>{const _0x5655ee=_0x353cdf;if(validateAccess(_0x18504a,_0x172e3e)[_0x5655ee(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7]['send']({'function':_0x5655ee(0xc7),'args':_0x474eb4});}else logger[_0x5655ee(0x103)](_0x5655ee(0x224));}),_0x1b990c['on']('get-portfolio',(_0x6f688e,_0x40976e)=>{const _0x2ee136=_0x353cdf;if(validateAccess(_0x40976e,_0x172e3e)['allow']){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x2ee136(0xba)]({'function':_0x2ee136(0x160),'args':_0x6f688e});}else logger[_0x2ee136(0x103)](_0x2ee136(0xac));}),_0x1b990c['on'](_0x353cdf(0x18e),(_0x2c9ec6,_0x18b0e4)=>{const _0x3f3565=_0x353cdf;if(validateAccess(_0x18b0e4,_0x172e3e)[_0x3f3565(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x3f3565(0xba)]({'function':'storeConfiguration','args':_0x2c9ec6});}else logger[_0x3f3565(0x103)](_0x3f3565(0x296));}),_0x1b990c['on'](_0x353cdf(0xdd),(_0x52b3b6,_0x5c71fd)=>{const _0x2cb3f2=_0x353cdf;if(validateAccess(_0x5c71fd,_0x172e3e)[_0x2cb3f2(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7]['send']({'function':_0x2cb3f2(0x137),'args':_0x52b3b6});}else logger[_0x2cb3f2(0x103)](_0x2cb3f2(0x1b3));}),_0x1b990c['on'](_0x353cdf(0x1c5),(_0x471fa3,_0x32697d)=>{const _0x238667=_0x353cdf;if(validateAccess(_0x32697d,_0x172e3e)['allow']){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x238667(0xba)]({'function':'storeFiat','args':_0x471fa3});}else logger[_0x238667(0x103)](_0x238667(0x219));}),_0x1b990c['on'](_0x353cdf(0xc2),_0x1aeb51=>{const _0x57d296=_0x353cdf;if(validateAccess(_0x1aeb51,_0x172e3e)[_0x57d296(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x57d296(0xba)]({'function':_0x57d296(0x1f1),'args':null});}else logger[_0x57d296(0x103)](_0x57d296(0x20f));}),_0x1b990c['on'](_0x353cdf(0x1db),_0x5f56b3=>{const _0x14e389=_0x353cdf;if(validateAccess(_0x5f56b3,_0x172e3e)[_0x14e389(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x14e389(0xba)]({'function':_0x14e389(0x130),'args':null});}else logger[_0x14e389(0x103)](_0x14e389(0x264));}),_0x1b990c['on'](_0x353cdf(0x260),(_0x1df530,_0x464d5c)=>{const _0x4f832b=_0x353cdf;if(validateAccess(_0x464d5c,_0x172e3e)[_0x4f832b(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x4f832b(0xba)]({'function':_0x4f832b(0x1cd),'args':_0x1df530});}else logger['full'](_0x4f832b(0x114));}),_0x1b990c['on'](_0x353cdf(0x238),_0x555108=>{const _0x1e2d1e=_0x353cdf;if(validateAccess(_0x555108,_0x172e3e)[_0x1e2d1e(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x1e2d1e(0xba)]({'function':_0x1e2d1e(0xd2),'args':null});}else logger[_0x1e2d1e(0x103)](_0x1e2d1e(0xde));}),_0x1b990c['on'](_0x353cdf(0x142),_0x41e4e6=>{const _0x21606d=_0x353cdf;if(validateAccess(_0x41e4e6,_0x172e3e)[_0x21606d(0x295)]){if(pid[_0x4ab7e7])pid[_0x4ab7e7][_0x21606d(0xba)]({'function':_0x21606d(0x11c),'args':null});}else logger[_0x21606d(0x103)](_0x21606d(0x117));}),_0x1b990c['on'](_0x353cdf(0x196),_0x50e7c0=>{const _0x513f75=_0x353cdf;if(validateAccess(_0x50e7c0,_0x172e3e)[_0x513f75(0x295)])updateBB(_0x513f75(0x217));else logger[_0x513f75(0x103)](_0x513f75(0x12d));}),_0x1b990c['on'](_0x353cdf(0xe6),_0x10346c=>{const _0x159910=_0x353cdf;if(validateAccess(_0x10346c,_0x172e3e)['allow'])getMessages();else logger[_0x159910(0x103)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1b990c['on'](_0x353cdf(0x106),(_0x491c1b,_0x15d98f)=>{const _0x26f5bb=_0x353cdf;if(validateAccess(_0x15d98f,_0x172e3e)[_0x26f5bb(0x295)])confirmMessage(_0x491c1b);else logger['full'](_0x26f5bb(0x15e));}),_0x1b990c['on'](_0x353cdf(0x150),_0x1c3e8c=>{const _0x41970e=_0x353cdf;if(validateAccess(_0x1c3e8c,_0x172e3e)['allow']){if(devices[_0x172e3e][_0x41970e(0xe3)])clearTimeout(devices[_0x172e3e][_0x41970e(0xe3)]);if(devices[_0x172e3e]['pidExpireLogin'])clearTimeout(devices[_0x172e3e][_0x41970e(0x185)]);removeSocketListeners(getClient(_0x1b990c['id'])[_0x41970e(0x205)]),addBlacklist(_0x172e3e),devices[_0x172e3e]['telegramIpApproval']=null,devices[_0x172e3e][_0x41970e(0x19a)]=null,devices[_0x172e3e][_0x41970e(0x1c1)][_0x41970e(0x1a3)]=null,logger[_0x41970e(0xea)](_0x41970e(0x237)+_0x172e3e[_0x41970e(0x168)](-0x8)),io['to'](getClient(_0x1b990c['id'])[_0x41970e(0x205)])[_0x41970e(0x149)](_0x41970e(0x12a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x41970e(0x180));});}function removeSocketListeners(_0x4b6a72){const _0x4f88b=_0x107b97;getClientsWithUuid(_0x4b6a72)[_0x4f88b(0x21f)](_0x51f9f4=>{const _0x362fd1=_0x4f88b;getSocket(_0x51f9f4['id'])[_0x362fd1(0x218)]();});}function cleanSettings(){const _0x433b0f=_0x107b97;let _0x97785=settings;return settings[_0x433b0f(0xd4)]&&settings[_0x433b0f(0xd4)]!=''&&(_0x97785={..._0x97785,'telegramToken':'************'}),settings[_0x433b0f(0x191)]&&settings[_0x433b0f(0x191)]!=''&&(_0x97785={..._0x97785,'bbPassword':_0x433b0f(0x214)}),(settings[_0x433b0f(0x191)]&&settings[_0x433b0f(0x191)]==_0x433b0f(0x254)||settings[_0x433b0f(0xd4)]&&settings[_0x433b0f(0xd4)]=='***')&&(_0x97785={..._0x97785,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x433b0f(0xd4)]=='***'}}),_0x97785;}async function updateBB(_0x4fe576){const _0x1dbbad=_0x107b97;await backupConfigFiles(),installingUpdate=!![],config[_0x1dbbad(0x21f)](_0x1485fa=>{const _0x51c474=_0x1dbbad;restartBot(_0x1485fa[_0x51c474(0x121)]);});if(_0x4fe576==_0x1dbbad(0x217))process['send']({'update':!![],'environment':environment},_0x31c709=>{});else _0x4fe576==_0x1dbbad(0x101)&&process[_0x1dbbad(0xba)]({'reinstall':!![],'environment':environment},_0x22ef9e=>{});}function startBot(_0x37f44d,_0x5a2bad,_0x2a2d53){const _0xf37f05=_0x107b97;if(debugging)_0x37f44d[_0xf37f05(0x1ce)]('-d');let _0x12cbd3=![];const _0x2d205e=_0x37f44d[0x0];_0x5a2bad={..._0x5a2bad,'stdio':['inherit',_0xf37f05(0xa0),_0xf37f05(0xa0),_0xf37f05(0x27b)]},pid[_0x2d205e]=childProcess[_0xf37f05(0x1ca)](botfile,_0x37f44d,_0x5a2bad),pid[_0x2d205e]['on'](_0xf37f05(0x176),_0x21841e=>{const _0x191445=_0xf37f05;switch(Object[_0x191445(0x175)](_0x21841e)[0x0]){case _0x191445(0xff):updateBotName(_0x2d205e,_0x21841e['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x191445(0x12a):updateStatus(_0x2d205e,_0x21841e[_0x191445(0x12a)]);break;case _0x191445(0xe9):updateLive(_0x2d205e,_0x21841e[_0x191445(0xe9)]);break;case _0x191445(0x209):updateLive(_0x2d205e,_0x21841e[_0x191445(0x209)]),io['to'](_0x2d205e)[_0x191445(0x149)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x21841e[_0x191445(0x277)]=='restart'&&restartBot(_0x2d205e);_0x21841e['stop']=='kill'&&toggleBot(_0x2d205e,_0x191445(0x1ec),_0x191445(0x1c8));break;case'telegram':sendTelegramBot(_0x2d205e,_0x21841e['telegram']);break;case _0x191445(0x13b):sendTelegramMsg(_0x21841e['telegrammsg']);break;case'function':io['to'](_0x2d205e)[_0x191445(0x149)](_0x21841e['function'],_0x21841e[_0x191445(0x14a)]);break;}}),pid[_0x2d205e]['on']('error',function(_0xede6e5){if(_0x12cbd3)return;_0x12cbd3=!![],_0x2a2d53(_0xede6e5);}),pid[_0x2d205e]['on'](_0xf37f05(0x21e),async function(_0x263686){const _0x2f2066=_0xf37f05;if(terminating)return;if(installingUpdate){logger[_0x2f2066(0xea)](_0x2f2066(0x1a7)),io[_0x2f2066(0x21d)]();return;}if(_0x12cbd3)return;_0x12cbd3=!![],_0x2a2d53(null);const _0x9a035f=dbConfig[_0x2f2066(0x211)](_0x2f2066(0x282))[_0x2f2066(0xc0)]({'botID':_0x2d205e})[_0x2f2066(0x1a9)]();_0x9a035f&&(_0x9a035f[_0x2f2066(0x12a)]==_0x2f2066(0x1d8)||_0x9a035f[_0x2f2066(0x12a)]==_0x2f2066(0x16b))&&(await sleep(0x3e8),updateLive(_0x2d205e,_0x2f2066(0x1c8)),logger[_0x2f2066(0x103)](_0x2f2066(0xda)+_0x2d205e),startBot([_0x2d205e,userID],{'cwd':bbpath},function(_0x20a1ce){const _0x42f261=_0x2f2066;if(_0x20a1ce)logger[_0x42f261(0x103)](_0x20a1ce);}));});}function stopBot(_0x1556ff){const _0x573eab=_0x107b97;getClientsWithBotID(_0x1556ff)[_0x573eab(0x21f)](_0x38112e=>{const _0x30780a=_0x573eab;getSocket(_0x38112e['id'])[_0x30780a(0x97)](!![]),removeClient(_0x38112e['id']);}),pid[_0x1556ff]&&(pid[_0x1556ff][_0x573eab(0xef)](),pid[_0x1556ff]=null);}function stopAllBots(){const _0x1aede9=_0x107b97;terminating=!![];const _0x215633=getEnabledBots();_0x215633[_0x1aede9(0x21f)](_0x7fc30f=>{const _0x2562ff=_0x1aede9;stopBot(_0x7fc30f[_0x2562ff(0x121)]);});}function restartBot(_0x330778){const _0x430b6d=_0x107b97;if(pid[_0x330778])pid[_0x330778][_0x430b6d(0xef)]();}function _0x537f(_0x61efec,_0x3cd359){const _0x5b5703=_0x594c();return _0x537f=function(_0x15ba72,_0xe9d025){_0x15ba72=_0x15ba72-0x95;let _0x594c3a=_0x5b5703[_0x15ba72];return _0x594c3a;},_0x537f(_0x61efec,_0x3cd359);}function addBot(){const _0x37478c=_0x107b97;let _0x1faff9;for(let _0x1733f7=0x1;_0x1733f7<0x3e9;_0x1733f7++){_0x1faff9=_0x1733f7[_0x37478c(0x9b)]()[_0x37478c(0x273)](0x3,'0');let _0x5b0926=config[_0x37478c(0xc0)](_0x2407e6=>_0x2407e6['botID']==_0x1faff9);if(!_0x5b0926)break;}if(_0x1faff9===_0x37478c(0x98)){logger[_0x37478c(0x103)](_0x37478c(0x271));return;}logger['full'](_0x37478c(0x1fa)+_0x1faff9),dbConfig[_0x37478c(0x211)](_0x37478c(0x282))['push']({'botID':_0x1faff9,'botname':'Bot\x20'+_0x1faff9,'status':_0x37478c(0x16b),'live':''})[_0x37478c(0x15f)](),startBot([_0x1faff9,userID],{'cwd':bbpath},function(_0x665e4f){const _0xab0fb5=_0x37478c;if(_0x665e4f)logger[_0xab0fb5(0x103)](_0x665e4f);}),config=getConfiguration(),io['to'](_0x37478c(0x1e2))[_0x37478c(0x149)](_0x37478c(0x282),config),broadcastToBots('bots',JSON[_0x37478c(0x255)](config));}function deleteBot(_0x41b1c8){const _0x48be64=_0x107b97;getClientsWithBotID(_0x41b1c8)['forEach'](_0xbf53b8=>{getSocket(_0xbf53b8['id'])['disconnect'](!![]),removeClient(_0xbf53b8['id']);}),dbConfig[_0x48be64(0x211)]('bots')[_0x48be64(0x1b6)]({'botID':_0x41b1c8})[_0x48be64(0x15f)](),logger[_0x48be64(0x103)](_0x48be64(0x24a)+_0x41b1c8),stopBot(_0x41b1c8);try{if(fs[_0x48be64(0x14b)](path[_0x48be64(0x201)](configpath,_0x48be64(0xd6)+_0x41b1c8+'-config.json')))fs['unlinkSync'](path[_0x48be64(0x201)](configpath,'bot-'+_0x41b1c8+_0x48be64(0x200)));if(fs[_0x48be64(0x14b)](path[_0x48be64(0x201)](configpath,'bot-'+_0x41b1c8+_0x48be64(0x1f6))))fs[_0x48be64(0x26c)](path[_0x48be64(0x201)](configpath,_0x48be64(0xd6)+_0x41b1c8+_0x48be64(0x1f6)));if(fs['existsSync'](path[_0x48be64(0x201)](configpath,_0x48be64(0xd6)+_0x41b1c8+'-performance.json')))fs['unlinkSync'](path[_0x48be64(0x201)](configpath,_0x48be64(0xd6)+_0x41b1c8+_0x48be64(0x29a)));if(fs[_0x48be64(0x14b)](path[_0x48be64(0x201)](configpath,_0x48be64(0xd6)+_0x41b1c8+'-results.json')))fs[_0x48be64(0x26c)](path[_0x48be64(0x201)](configpath,_0x48be64(0xd6)+_0x41b1c8+_0x48be64(0xbe)));}catch(_0x1ce34b){if(_0x1ce34b)logger['full'](_0x48be64(0x23d),_0x1ce34b);}config=getConfiguration(),io['to'](_0x48be64(0x1e2))[_0x48be64(0x149)](_0x48be64(0x282),config),broadcastToBots('bots',JSON[_0x48be64(0x255)](config));}function toggleBot(_0x17e55f,_0x29e360,_0x2c84c8){const _0x27659e=_0x107b97;dbConfig[_0x27659e(0x211)](_0x27659e(0x282))[_0x27659e(0xc0)]({'botID':_0x17e55f})['assign']({'status':_0x29e360})[_0x27659e(0x1b5)]({'live':_0x2c84c8})[_0x27659e(0x15f)]();if(_0x29e360==_0x27659e(0x1d8)||_0x29e360=='new')logger[_0x27659e(0x103)](_0x27659e(0x164)+_0x17e55f),startBot([_0x17e55f,userID],{'cwd':bbpath},function(_0x493b1c){if(_0x493b1c)logger['full'](_0x493b1c);});else(_0x29e360==_0x27659e(0x1ec)||_0x29e360=='new-disabled')&&(logger[_0x27659e(0x103)](_0x27659e(0x192)+_0x17e55f),stopBot(_0x17e55f));config=getConfiguration(),io['to'](_0x27659e(0x1e2))[_0x27659e(0x149)](_0x27659e(0x282),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x5f2014){const _0x2a5900=_0x107b97;let _0x2356bf=dbConfig['get'](_0x2a5900(0x282))['find']({'botID':_0x5f2014})[_0x2a5900(0x1a9)](),_0x3c3388;if(_0x2356bf[_0x2a5900(0x12a)]===_0x2a5900(0x1d8))_0x3c3388='disabled';else{if(_0x2356bf[_0x2a5900(0x12a)]===_0x2a5900(0x16b))_0x3c3388='new-disabled';else{if(_0x2356bf['status']===_0x2a5900(0x138))_0x3c3388='new';else{if(_0x2356bf[_0x2a5900(0x12a)]==='disabled')_0x3c3388=_0x2a5900(0x1d8);}}}return _0x3c3388;}function updateStatus(_0x337a01,_0x25ef1b){const _0x362bc0=_0x107b97;dbConfig[_0x362bc0(0x211)](_0x362bc0(0x282))['find']({'botID':_0x337a01})[_0x362bc0(0x1b5)]({'status':_0x25ef1b})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x362bc0(0x149)](_0x362bc0(0x282),config),broadcastToBots(_0x362bc0(0x282),JSON[_0x362bc0(0x255)](config));}function updateLive(_0x1bc7cf,_0x5a5b08){const _0x3b8a31=_0x107b97;dbConfig[_0x3b8a31(0x211)](_0x3b8a31(0x282))[_0x3b8a31(0xc0)]({'botID':_0x1bc7cf})['assign']({'live':_0x5a5b08})[_0x3b8a31(0x15f)](),config=getConfiguration(),io['to'](_0x3b8a31(0x1e2))[_0x3b8a31(0x149)](_0x3b8a31(0x282),config),broadcastToBots(_0x3b8a31(0x282),JSON[_0x3b8a31(0x255)](config));}function updateBotName(_0x39463e,_0x33bfa2){const _0x2883f1=_0x107b97;dbConfig[_0x2883f1(0x211)](_0x2883f1(0x282))[_0x2883f1(0xc0)]({'botID':_0x39463e})['assign']({'botname':_0x33bfa2})[_0x2883f1(0x15f)](),config=getConfiguration(),io['to'](_0x2883f1(0x1e2))[_0x2883f1(0x149)](_0x2883f1(0x282),config),broadcastToBots(_0x2883f1(0x282),JSON[_0x2883f1(0x255)](config));}function updateBotManager(){const _0x50b4d8=_0x107b97;config=getConfiguration(),io['to']('botmanager')[_0x50b4d8(0x149)](_0x50b4d8(0x282),config),broadcastToBots(_0x50b4d8(0x282),JSON[_0x50b4d8(0x255)](config));}function toggleBotMode(_0x29cc1e){const _0x45e6b9=_0x107b97;if(pid[_0x29cc1e])pid[_0x29cc1e][_0x45e6b9(0xba)]({'function':_0x45e6b9(0x10c),'args':null});else{const _0x562e7d=configpath+_0x45e6b9(0xd6)+_0x29cc1e+_0x45e6b9(0x200),_0x308d14=fs[_0x45e6b9(0x153)](_0x562e7d),_0x450215=JSON[_0x45e6b9(0xe0)](_0x308d14),_0x4388e2=_0x450215['bot'][0x0][_0x45e6b9(0xc6)];_0x450215['bot'][0x0][_0x45e6b9(0xc6)]=!_0x4388e2;const _0x410dd9=JSON[_0x45e6b9(0x255)](_0x450215,null,0x2);fs['writeFileSync'](_0x562e7d,_0x410dd9),config=getConfiguration(),io['to'](_0x45e6b9(0x1e2))[_0x45e6b9(0x149)]('bots',config),broadcastToBots('bots',JSON[_0x45e6b9(0x255)](config));}}function validateTelegram(_0xb74ca7){const _0x46fb06=_0x107b97;if(_0xb74ca7[_0x46fb06(0x1ba)][_0x46fb06(0x27f)]!=settings[_0x46fb06(0x157)]&&'@'+_0xb74ca7[_0x46fb06(0x1ba)][_0x46fb06(0x27f)]!=settings[_0x46fb06(0x157)]||_0xb74ca7[_0x46fb06(0x28d)]['id']!=settings[_0x46fb06(0x204)])return sendTelegram(_0xb74ca7[_0x46fb06(0x28d)]['id'],_0x46fb06(0x28c),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0xbca539=_0x107b97;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x2d3d12=_0xbca539(0x1a0);_0x2d3d12+='\x0a',_0x2d3d12+='/enable\x20-\x20enable\x20notifications\x0a',_0x2d3d12+=_0xbca539(0x167),_0x2d3d12+=_0xbca539(0x1ae),_0x2d3d12+=_0xbca539(0x99),_0x2d3d12+='/on\x20-\x20start\x20bot(s)\x0a',_0x2d3d12+=_0xbca539(0xc8),_0x2d3d12+=_0xbca539(0xc5),_0x2d3d12+='/names\x20-\x20show\x20bot\x20names\x0a',_0x2d3d12+=_0xbca539(0x17f),_0x2d3d12+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x2d3d12+=_0xbca539(0x1aa),_0x2d3d12+=_0xbca539(0x1c6),_0x2d3d12+=_0xbca539(0x96),_0x2d3d12+=_0xbca539(0xcf);let _0x5cc533=_0xbca539(0xf6);_0x5cc533+='\x0a',_0x5cc533+=_0x2d3d12,tgBot['catch']((_0x165d3a,_0xc331d6)=>{const _0x190544=_0xbca539;logger[_0x190544(0xbb)](getTimeStamp()+_0x190544(0x1f0)),logger[_0x190544(0xea)]('Telegraf\x20error:',_0x165d3a);}),tgBot[_0xbca539(0x1fb)](async(_0xe6994b,_0x2781fb)=>{const _0x531dc6=_0xbca539;if(!(!settings[_0x531dc6(0x204)]&&_0xe6994b[_0x531dc6(0x217)][_0x531dc6(0x176)][_0x531dc6(0x10a)]==_0x531dc6(0x20a))){if(!validateTelegram(_0xe6994b))return;}_0x2781fb();}),tgBot['command']('start',async _0x52b490=>{const _0x20963b=_0xbca539;if(!settings['telegramChatId'])updateSetting(_0x20963b(0x204),_0x52b490['chat']['id']);updateSetting(_0x20963b(0x182),!![]);if(!validateTelegram(_0x52b490))return;await sendTelegram(_0x52b490[_0x20963b(0x28d)]['id'],_0x5cc533);}),tgBot['command'](_0xbca539(0x183),async _0xf6c8f1=>{const _0x174fdc=_0xbca539;updateSetting(_0x174fdc(0x182),!![]),await sendTelegram(_0xf6c8f1['chat']['id'],'Notifications\x20enabled');}),tgBot[_0xbca539(0x159)]('disable',async _0x3e358c=>{const _0x3c8626=_0xbca539;await sendTelegram(_0x3e358c[_0x3c8626(0x28d)]['id'],_0x3c8626(0x290)),updateSetting(_0x3c8626(0x182),![]);}),tgBot['command'](_0xbca539(0x25e),async _0x254cd4=>{const _0x14d8b0=_0xbca539,_0x5f121b=Markup['inlineKeyboard']([Markup[_0x14d8b0(0x299)]['callback'](_0x14d8b0(0x9e),'config_orders'),Markup[_0x14d8b0(0x299)][_0x14d8b0(0x20b)](_0x14d8b0(0x226),_0x14d8b0(0xf4)),Markup[_0x14d8b0(0x299)][_0x14d8b0(0x20b)](_0x14d8b0(0x11d),_0x14d8b0(0x29c))]);_0x254cd4[_0x14d8b0(0x216)](_0x14d8b0(0x166),_0x5f121b);}),tgBot[_0xbca539(0x1c0)](_0xbca539(0x1e8),async _0x39c3fc=>{const _0x4480cd=_0xbca539;_0x39c3fc[_0x4480cd(0x1e4)](),updateSetting('telegramEvents','orders'),updateSetting(_0x4480cd(0x182),!![]),await sendTelegram(_0x39c3fc['chat']['id'],_0x4480cd(0x250));}),tgBot[_0xbca539(0x1c0)](_0xbca539(0xf4),async _0x43f9e4=>{const _0x386ff3=_0xbca539;_0x43f9e4[_0x386ff3(0x1e4)](),updateSetting(_0x386ff3(0xf1),_0x386ff3(0x22d)),updateSetting(_0x386ff3(0x182),!![]),await sendTelegram(_0x43f9e4['chat']['id'],_0x386ff3(0xe7));}),tgBot[_0xbca539(0x1c0)](_0xbca539(0x29c),async _0xc68c64=>{const _0x185199=_0xbca539;_0xc68c64[_0x185199(0x1e4)](),updateSetting(_0x185199(0xf1),_0x185199(0x294)),updateSetting(_0x185199(0x182),!![]),await sendTelegram(_0xc68c64[_0x185199(0x28d)]['id'],_0x185199(0x115));}),tgBot[_0xbca539(0x159)](_0xbca539(0x12a),async _0x2cbff6=>{const _0x55b461=_0xbca539,_0x4b10e3=getBotsWithMode();let _0xff19d8=_0x55b461(0x1d2);config['forEach'](_0x3e8535=>{const _0x76778=_0x55b461,_0x3e1d55=_0x4b10e3[_0x76778(0xc0)](_0x541f9c=>_0x541f9c[_0x76778(0x121)]==_0x3e8535[_0x76778(0x121)])[_0x76778(0x265)];_0xff19d8+=_0x76778(0x148)+_0x3e8535[_0x76778(0x121)]+':\x20'+_0x3e8535['status']+'\x20|\x20'+_0x3e1d55+_0x76778(0x13c)+_0x3e8535[_0x76778(0xe9)]+'\x0a';}),_0xff19d8+='\x0a',_0xff19d8+=_0x55b461(0x26a),_0xff19d8+=!settings[_0x55b461(0x182)]?_0x55b461(0x1b4):_0x55b461(0x247),_0xff19d8+=settings[_0x55b461(0x182)]?settings[_0x55b461(0xf1)]==_0x55b461(0x294)?_0x55b461(0x291):_0x55b461(0x220)+settings[_0x55b461(0xf1)]+_0x55b461(0x1b0):'',await sendTelegram(_0x2cbff6[_0x55b461(0x28d)]['id'],_0xff19d8,{'parse_mode':_0x55b461(0x248)});}),tgBot[_0xbca539(0x159)](_0xbca539(0x9f),async _0x442f1d=>{const _0x355080=_0xbca539,_0x331d45=getEnabledBots();if(_0x331d45['length']==0x0)await sendTelegram(_0x442f1d[_0x355080(0x28d)]['id'],_0x355080(0x15b));else{if(_0x331d45[_0x355080(0x169)]>0x1)_0x331d45['push']({'botID':_0x355080(0x294)});let _0x41e929=[],_0x260c62=[];const _0x5c005e=_0x331d45[_0x355080(0x169)]%0x4==0x0||_0x331d45['length']%0x4==0x3||_0x331d45[_0x355080(0x169)]%0x3==0x1?0x4:0x3;let _0x2554d3=0x0;_0x331d45[_0x355080(0x21f)]((_0x28893e,_0x2ab324)=>{const _0x4e7957=_0x355080;if(_0x2ab324%_0x5c005e==0x0)_0x260c62=[];_0x260c62[_0x4e7957(0x1ce)](Markup[_0x4e7957(0x299)]['callback'](_0x28893e[_0x4e7957(0x121)]=='all'?_0x4e7957(0x1f8):_0x4e7957(0x148)+_0x28893e['botID'],_0x4e7957(0x1ff)+_0x28893e['botID'])),_0x2ab324%_0x5c005e==0x0&&(_0x41e929[_0x2554d3]=_0x260c62,_0x2554d3++);});const _0x2759e1=Markup[_0x355080(0x16f)](_0x41e929);_0x442f1d['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x2759e1);}}),tgBot[_0xbca539(0x1c0)](/restart_(.+)/,async _0x1e02bb=>{const _0x34c466=_0xbca539,_0x26fbaa=_0x1e02bb[_0x34c466(0x270)][0x1];_0x1e02bb[_0x34c466(0x1e4)](),_0x26fbaa=='all'?config['forEach'](_0x29ba12=>{const _0xc61739=_0x34c466;restartBot(_0x29ba12[_0xc61739(0x121)]);}):restartBot(_0x26fbaa);}),tgBot[_0xbca539(0x159)]('on',async _0x346728=>{const _0x3e070b=_0xbca539,_0x26579a=getDisabledBots();if(_0x26579a['length']==0x0)await sendTelegram(_0x346728[_0x3e070b(0x28d)]['id'],_0x3e070b(0xb9));else{if(_0x26579a[_0x3e070b(0x169)]>0x1)_0x26579a['push']({'botID':'all'});let _0x108f38=[],_0x14696d=[];const _0x8105cb=_0x26579a[_0x3e070b(0x169)]%0x4==0x0||_0x26579a[_0x3e070b(0x169)]%0x4==0x3||_0x26579a[_0x3e070b(0x169)]%0x3==0x1?0x4:0x3;let _0xf71b4c=0x0;_0x26579a[_0x3e070b(0x21f)]((_0x40229b,_0xb6dc1)=>{const _0x2978e3=_0x3e070b;if(_0xb6dc1%_0x8105cb==0x0)_0x14696d=[];_0x14696d[_0x2978e3(0x1ce)](Markup[_0x2978e3(0x299)][_0x2978e3(0x20b)](_0x40229b[_0x2978e3(0x121)]=='all'?_0x2978e3(0x1f8):_0x2978e3(0x148)+_0x40229b[_0x2978e3(0x121)],'on_'+_0x40229b[_0x2978e3(0x121)])),_0xb6dc1%_0x8105cb==0x0&&(_0x108f38[_0xf71b4c]=_0x14696d,_0xf71b4c++);});const _0x3aa30a=Markup['inlineKeyboard'](_0x108f38);_0x346728['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x3aa30a);}}),tgBot[_0xbca539(0x1c0)](/on_(.+)/,async _0x2d0e4c=>{const _0x27b1b4=_0xbca539,_0x4acec9=_0x2d0e4c[_0x27b1b4(0x270)][0x1];_0x2d0e4c[_0x27b1b4(0x1e4)]();if(_0x4acec9==_0x27b1b4(0x294)){const _0x1c61cb=getDisabledBots();await sendTelegram(_0x2d0e4c[_0x27b1b4(0x28d)]['id'],_0x27b1b4(0x23b)),_0x1c61cb[_0x27b1b4(0x21f)](_0x3bad05=>{const _0xa5418d=_0x27b1b4;if(_0x3bad05[_0xa5418d(0x121)]!=_0xa5418d(0x294))toggleBot(_0x3bad05[_0xa5418d(0x121)],toggleStatus(_0x3bad05[_0xa5418d(0x121)]),_0xa5418d(0x1c8));});}else await sendTelegram(_0x2d0e4c['chat']['id'],_0x27b1b4(0x1e6)+_0x4acec9),toggleBot(_0x4acec9,toggleStatus(_0x4acec9),_0x27b1b4(0x1c8));}),tgBot[_0xbca539(0x159)](_0xbca539(0x10f),async _0x142e0c=>{const _0x4dd260=_0xbca539,_0x38d665=getEnabledBots();if(_0x38d665['length']==0x0)await sendTelegram(_0x142e0c[_0x4dd260(0x28d)]['id'],_0x4dd260(0x15b));else{if(_0x38d665[_0x4dd260(0x169)]>0x1)_0x38d665[_0x4dd260(0x1ce)]({'botID':'all'});let _0x12c0ef=[],_0x38bedd=[];const _0x398765=_0x38d665['length']%0x4==0x0||_0x38d665[_0x4dd260(0x169)]%0x4==0x3||_0x38d665['length']%0x3==0x1?0x4:0x3;let _0x445790=0x0;_0x38d665[_0x4dd260(0x21f)]((_0x24afa3,_0x4f67d4)=>{const _0x365549=_0x4dd260;if(_0x4f67d4%_0x398765==0x0)_0x38bedd=[];_0x38bedd[_0x365549(0x1ce)](Markup[_0x365549(0x299)][_0x365549(0x20b)](_0x24afa3[_0x365549(0x121)]==_0x365549(0x294)?_0x365549(0x1f8):'Bot\x20'+_0x24afa3['botID'],_0x365549(0x173)+_0x24afa3[_0x365549(0x121)])),_0x4f67d4%_0x398765==0x0&&(_0x12c0ef[_0x445790]=_0x38bedd,_0x445790++);});const _0x32f685=Markup['inlineKeyboard'](_0x12c0ef);_0x142e0c[_0x4dd260(0x216)](_0x4dd260(0xbd),_0x32f685);}}),tgBot[_0xbca539(0x1c0)](/off_(.+)/,async _0x934bf6=>{const _0x5c1501=_0xbca539,_0x586e57=_0x934bf6[_0x5c1501(0x270)][0x1];_0x934bf6['editMessageReplyMarkup']();if(_0x586e57==_0x5c1501(0x294)){const _0x374f29=getEnabledBots();await sendTelegram(_0x934bf6[_0x5c1501(0x28d)]['id'],_0x5c1501(0xaa)),_0x374f29[_0x5c1501(0x21f)](_0x1b7fe0=>{const _0xa0086b=_0x5c1501;if(_0x1b7fe0['botID']!=_0xa0086b(0x294))toggleBot(_0x1b7fe0[_0xa0086b(0x121)],toggleStatus(_0x1b7fe0['botID']),_0xa0086b(0x1c8));});}else await sendTelegram(_0x934bf6['chat']['id'],_0x5c1501(0x1a6)+_0x586e57),toggleBot(_0x586e57,toggleStatus(_0x586e57),_0x5c1501(0x1c8));}),tgBot['command'](_0xbca539(0xa4),async _0x2176d2=>{const _0x2bc1d0=_0xbca539,_0x2c2aa4=getEnabledBots();if(_0x2c2aa4[_0x2bc1d0(0x169)]==0x0)await sendTelegram(_0x2176d2['chat']['id'],_0x2bc1d0(0x15b));else{if(_0x2c2aa4[_0x2bc1d0(0x169)]>0x1){let _0xe293a=[],_0x1629cd=[];const _0x1d6478=_0x2c2aa4['length']%0x4==0x0||_0x2c2aa4[_0x2bc1d0(0x169)]%0x4==0x3||_0x2c2aa4[_0x2bc1d0(0x169)]%0x3==0x1?0x4:0x3;let _0x4c0cef=0x0;_0x2c2aa4[_0x2bc1d0(0x21f)]((_0x2ced2e,_0x376166)=>{const _0x25e3ae=_0x2bc1d0;if(_0x376166%_0x1d6478==0x0)_0x1629cd=[];_0x1629cd[_0x25e3ae(0x1ce)](Markup['button'][_0x25e3ae(0x20b)](_0x25e3ae(0x148)+_0x2ced2e[_0x25e3ae(0x121)],_0x25e3ae(0x18d)+_0x2ced2e[_0x25e3ae(0x121)])),_0x376166%_0x1d6478==0x0&&(_0xe293a[_0x4c0cef]=_0x1629cd,_0x4c0cef++);});const _0x30f8b5=Markup[_0x2bc1d0(0x16f)](_0xe293a);_0x2176d2['reply'](_0x2bc1d0(0xfb),_0x30f8b5);}else{const _0x476acf=_0x2c2aa4[0x0]['botID'];if(pid[_0x476acf])pid[_0x476acf]['send']({'function':_0x2bc1d0(0xf9),'args':null});}}}),tgBot[_0xbca539(0x1c0)](/metrics_(.+)/,async _0x5ccb73=>{const _0x405a0b=_0xbca539,_0x452b65=_0x5ccb73[_0x405a0b(0x270)][0x1];_0x5ccb73[_0x405a0b(0x1e4)]();if(pid[_0x452b65])pid[_0x452b65][_0x405a0b(0xba)]({'function':_0x405a0b(0xf9),'args':null});}),tgBot['command']('portfolio',async _0x4c06dc=>{const _0x367eb1=_0xbca539,_0x3b7ee4=getEnabledBots();if(_0x3b7ee4[_0x367eb1(0x169)]==0x0)await sendTelegram(_0x4c06dc[_0x367eb1(0x28d)]['id'],_0x367eb1(0x15b));else{if(_0x3b7ee4['length']>0x1){let _0x1e6cfd=[],_0x5d279e=[];const _0x404f88=_0x3b7ee4[_0x367eb1(0x169)]%0x4==0x0||_0x3b7ee4[_0x367eb1(0x169)]%0x4==0x3||_0x3b7ee4[_0x367eb1(0x169)]%0x3==0x1?0x4:0x3;let _0x4ce66f=0x0;_0x3b7ee4[_0x367eb1(0x21f)]((_0x1a2cd9,_0x4bea01)=>{const _0x461816=_0x367eb1;if(_0x4bea01%_0x404f88==0x0)_0x5d279e=[];_0x5d279e[_0x461816(0x1ce)](Markup[_0x461816(0x299)][_0x461816(0x20b)](_0x461816(0x148)+_0x1a2cd9[_0x461816(0x121)],_0x461816(0xa3)+_0x1a2cd9[_0x461816(0x121)])),_0x4bea01%_0x404f88==0x0&&(_0x1e6cfd[_0x4ce66f]=_0x5d279e,_0x4ce66f++);});const _0x5e2e0f=Markup['inlineKeyboard'](_0x1e6cfd);_0x4c06dc['reply'](_0x367eb1(0x297),_0x5e2e0f);}else{const _0x362276=_0x3b7ee4[0x0][_0x367eb1(0x121)];if(pid[_0x362276])pid[_0x362276]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0xbca539(0x1c0)](/portfolio_(.+)/,async _0x1c1848=>{const _0x57b7b7=_0xbca539,_0x22ded5=_0x1c1848[_0x57b7b7(0x270)][0x1];_0x1c1848[_0x57b7b7(0x1e4)]();if(pid[_0x22ded5])pid[_0x22ded5][_0x57b7b7(0xba)]({'function':_0x57b7b7(0xa5),'args':null});}),tgBot[_0xbca539(0x159)]('update',async _0x183081=>{const _0x7680f=_0xbca539;await getMessages();if(!updateAvailable)await sendTelegram(_0x183081[_0x7680f(0x28d)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x183081[_0x7680f(0x28d)]['id'],_0x7680f(0xd0));else{const _0x3370ea=Markup[_0x7680f(0x16f)]([Markup[_0x7680f(0x299)][_0x7680f(0x20b)](_0x7680f(0x184),_0x7680f(0xc9)),Markup[_0x7680f(0x299)][_0x7680f(0x20b)]('No','update_no')]);_0x183081[_0x7680f(0x216)](_0x7680f(0x1bf),_0x3370ea);}}}),tgBot[_0xbca539(0x1c0)](/update_(.+)/,async _0x403ff7=>{const _0x5e86fc=_0xbca539,_0x3138f3=_0x403ff7[_0x5e86fc(0x270)][0x1];_0x403ff7[_0x5e86fc(0x1e4)](),_0x3138f3==_0x5e86fc(0x1b2)&&(await sendTelegram(_0x403ff7[_0x5e86fc(0x28d)]['id'],_0x5e86fc(0xd7)),updateBB(_0x5e86fc(0x217))),_0x3138f3=='no'&&await sendTelegram(_0x403ff7[_0x5e86fc(0x28d)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0xbca539(0x159)](_0xbca539(0x101),async _0x543678=>{const _0x16f20f=_0xbca539;if(!validInstallation)await sendTelegram(_0x543678[_0x16f20f(0x28d)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x342eed=Markup['inlineKeyboard']([Markup['button']['callback']('Yes',_0x16f20f(0x14c)),Markup[_0x16f20f(0x299)]['callback']('No','reinstall_no')]);_0x543678[_0x16f20f(0x216)](_0x16f20f(0x145),_0x342eed);}}),tgBot[_0xbca539(0x1c0)](/reinstall_(.+)/,async _0x30fa4e=>{const _0x5d913a=_0xbca539,_0x3a0eca=_0x30fa4e[_0x5d913a(0x270)][0x1];_0x30fa4e[_0x5d913a(0x1e4)](),_0x3a0eca==_0x5d913a(0x1b2)&&(await sendTelegram(_0x30fa4e[_0x5d913a(0x28d)]['id'],_0x5d913a(0x1d7)),updateBB(_0x5d913a(0x101))),_0x3a0eca=='no'&&await sendTelegram(_0x30fa4e[_0x5d913a(0x28d)]['id'],_0x5d913a(0x1cf));}),tgBot[_0xbca539(0x159)]('toggle',async _0x9ef52f=>{const _0x17fe42=_0xbca539,_0x754706=getBotsWithMode();if(_0x754706[_0x17fe42(0x169)]==0x0)await sendTelegram(_0x9ef52f['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x3b05a3=[],_0x2d3760=[];const _0x328e0f=0x2;let _0x5f288f=0x0;_0x754706[_0x17fe42(0x21f)]((_0x4463c2,_0x545e47)=>{const _0x50e6c7=_0x17fe42;if(_0x545e47%_0x328e0f==0x0)_0x2d3760=[];_0x2d3760[_0x50e6c7(0x1ce)](Markup['button'][_0x50e6c7(0x20b)](_0x50e6c7(0x148)+_0x4463c2[_0x50e6c7(0x121)]+'\x20('+_0x4463c2[_0x50e6c7(0x265)]+')',_0x50e6c7(0x15d)+_0x4463c2['botID'])),_0x545e47%_0x328e0f==0x0&&(_0x3b05a3[_0x5f288f]=_0x2d3760,_0x5f288f++);});const _0x3cb04e=Markup['inlineKeyboard'](_0x3b05a3);_0x9ef52f[_0x17fe42(0x216)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x3cb04e);}}),tgBot[_0xbca539(0x1c0)](/toggle_(.+)/,async _0x524f59=>{const _0x3f05da=_0xbca539,_0x3ab406=_0x524f59[_0x3f05da(0x270)][0x1];_0x524f59[_0x3f05da(0x1e4)]();const _0x52a55d=getBotsWithMode(),_0x3d7698=_0x52a55d[_0x3f05da(0xc0)](_0x3ae85e=>_0x3ae85e[_0x3f05da(0x121)]==_0x3ab406),_0x4d4463=_0x3d7698[_0x3f05da(0x265)]==_0x3f05da(0x1e0)?_0x3f05da(0x15a):_0x3f05da(0x1e0);await sendTelegram(_0x524f59[_0x3f05da(0x28d)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3ab406+_0x3f05da(0x199)+_0x4d4463+_0x3f05da(0x1dd)),toggleBotMode(_0x3ab406);}),tgBot[_0xbca539(0x159)](_0xbca539(0x221),async _0x51bc41=>{const _0x5aabce=_0xbca539;let _0x5bc29b='';config[_0x5aabce(0x21f)](_0x31a41e=>{const _0x38f9c9=_0x5aabce;_0x5bc29b+=_0x38f9c9(0x148)+_0x31a41e[_0x38f9c9(0x121)]+':\x20'+_0x31a41e['botname']+'\x0a';}),await sendTelegram(_0x51bc41['chat']['id'],_0x5bc29b,{'parse_mode':_0x5aabce(0x248)});}),tgBot[_0xbca539(0x159)](_0xbca539(0x171),async _0x2265c7=>{const _0x43f87c=_0xbca539;await sendTelegram(_0x2265c7[_0x43f87c(0x28d)]['id'],_0x2d3d12);}),process[_0xbca539(0x174)]('SIGINT',()=>tgBot[_0xbca539(0x277)](_0xbca539(0x131))),process[_0xbca539(0x174)]('SIGTERM',()=>tgBot[_0xbca539(0x277)]('SIGTERM')),tgBot['launch']();}}function disableTelegram(){const _0x363669=_0x107b97;tgBot&&tgBot[_0x363669(0x277)]();}async function sendTelegram(_0x17a998,_0x2c4fa5,_0x4dd01f){const _0x106ce8=_0x107b97;try{await tgBot[_0x106ce8(0x1ab)][_0x106ce8(0x24b)](_0x17a998,_0x2c4fa5,_0x4dd01f);}catch(_0x28cfee){console[_0x106ce8(0xb5)](_0x106ce8(0xd1),_0x28cfee);}}async function sendTelegramBot(_0x321edf,_0x5c5640){const _0x37914c=_0x107b97;if(settings[_0x37914c(0x182)]){if(settings[_0x37914c(0xf1)]=='all'||(_0x5c5640[_0x37914c(0xf5)]==_0x37914c(0xb7)||_0x5c5640[_0x37914c(0xf5)]==_0x37914c(0x12b)||_0x5c5640[_0x37914c(0xf5)]==_0x37914c(0x24e))&&settings[_0x37914c(0xf1)]==_0x37914c(0x22d)||_0x5c5640[_0x37914c(0xf5)]==_0x37914c(0x28f)&&settings[_0x37914c(0xf1)]==_0x37914c(0x152)){if(tgBot&&settings[_0x37914c(0x204)]){if(_0x5c5640[_0x37914c(0x1ea)])await sendTelegram(settings['telegramChatId'],_0x5c5640['botname']+_0x37914c(0xd5)+_0x5c5640[_0x37914c(0x206)]);else await sendTelegram(settings[_0x37914c(0x204)],_0x37914c(0x148)+_0x321edf+_0x37914c(0xd5)+_0x5c5640[_0x37914c(0x206)]);}}}}async function sendTelegramMsg(_0x42e540,_0x29fbf9='HTML'){const _0xda4a21=_0x107b97;return settings[_0xda4a21(0x182)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0xda4a21(0x204)],_0x42e540,{'parse_mode':_0x29fbf9}),!![]):![];}function getDeviceWithIp(_0xf5acd){return devices['find'](_0x228507=>_0x228507['ip']===_0xf5acd);}async function temporaryAccess2FA(_0x330704,_0x376071){const _0x119d38=_0x107b97;let _0x1613be=new Date(),_0x39734a=![];if(lastIpApproval){if(_0x1613be-lastIpApproval<0x1388)_0x39734a=!![];}lastIpApproval=new Date();if(_0x39734a)return;if(tgBot&&settings[_0x119d38(0x204)]){const _0x1250c6=uuidRandom();tmpStorage[_0x1250c6]={'uuid':_0x330704,'externalip':_0x376071};const _0xb965e0=Markup[_0x119d38(0x16f)]([Markup[_0x119d38(0x299)]['callback'](_0x119d38(0x1df),'tempaccess_5_'+_0x1250c6),Markup['button'][_0x119d38(0x20b)](_0x119d38(0x268),_0x119d38(0x17d)+_0x1250c6),Markup[_0x119d38(0x299)][_0x119d38(0x20b)]('30\x20min',_0x119d38(0x25d)+_0x1250c6),Markup[_0x119d38(0x299)][_0x119d38(0x20b)]('reject','tempaccess_reject_'+_0x1250c6)]);await sendTelegram(settings['telegramChatId'],_0x119d38(0x210)+normalizeIP(_0x376071)[_0x119d38(0x1c2)]+'\x20?',_0xb965e0),tgBot[_0x119d38(0x1c0)](/tempaccess_(.+)_(.+)/,async _0x3b6e46=>{const _0x2b61cc=_0x119d38,_0x222569=_0x3b6e46[_0x2b61cc(0x270)][0x1],_0x3e6852=_0x3b6e46['match'][0x2],{uuid:_0x364f62,externalip:_0x70004d}=tmpStorage[_0x3e6852];delete tmpStorage[_0x3e6852],_0x3b6e46[_0x2b61cc(0x1e4)](),devices[_0x364f62][_0x2b61cc(0x20d)]={'clientip':_0x70004d,'timestamp':new Date()[_0x2b61cc(0x27d)](),'expiry':_0x222569},_0x222569!=_0x2b61cc(0x28b)?(await sendTelegram(_0x3b6e46[_0x2b61cc(0x28d)]['id'],_0x2b61cc(0x17c)+_0x222569+'\x20minutes',{'parse_mode':_0x2b61cc(0x248)}),io['to'](_0x364f62)['emit'](_0x2b61cc(0x12a),{'access':{'allow':![],'reason':_0x2b61cc(0x1f5),'token':null}})):(await sendTelegram(_0x3b6e46[_0x2b61cc(0x28d)]['id'],_0x2b61cc(0x1f3)),io['to'](_0x364f62)['emit'](_0x2b61cc(0x12a),{'access':{'allow':![],'reason':_0x2b61cc(0x19c),'token':null}}));});}}async function loginAccess2FA(_0x301ea3,_0x4ffb56){const _0x1a26e2=_0x107b97;if(tgBot&&settings[_0x1a26e2(0x204)]){const _0x49e4bd=uuidRandom();tmpStorage[_0x49e4bd]={'uuid':_0x301ea3,'externalip':_0x4ffb56};const _0x48f28a=Markup[_0x1a26e2(0x16f)]([Markup[_0x1a26e2(0x299)][_0x1a26e2(0x20b)](_0x1a26e2(0xae),_0x1a26e2(0xd3)+loginExpiry+'_'+_0x49e4bd),Markup[_0x1a26e2(0x299)][_0x1a26e2(0x20b)](_0x1a26e2(0x28b),_0x1a26e2(0x244)+_0x49e4bd)]);await sendTelegram(settings[_0x1a26e2(0x204)],_0x1a26e2(0x198)+normalizeIP(_0x4ffb56)[_0x1a26e2(0x1c2)]+'\x20?',_0x48f28a),tgBot[_0x1a26e2(0x1c0)](/login2fa_(.+)_(.+)/,async _0x5dbaf7=>{const _0x404a1f=_0x1a26e2,_0x126ef5=_0x5dbaf7[_0x404a1f(0x270)][0x1],_0x1405c8=_0x5dbaf7['match'][0x2],{uuid:_0x42054c,externalip:_0x1779fa}=tmpStorage[_0x1405c8];delete tmpStorage[_0x1405c8],_0x5dbaf7[_0x404a1f(0x1e4)](),devices[_0x42054c][_0x404a1f(0x19a)]={'clientip':_0x1779fa,'timestamp':new Date()[_0x404a1f(0x27d)](),'expiry':_0x126ef5},_0x126ef5!=_0x404a1f(0x28b)?(await sendTelegram(_0x5dbaf7[_0x404a1f(0x28d)]['id'],_0x404a1f(0x119),{'parse_mode':_0x404a1f(0x248)}),io['to'](_0x42054c)[_0x404a1f(0x149)]('status',{'access':{'allow':![],'reason':_0x404a1f(0x1f5),'token':null}})):(await sendTelegram(_0x5dbaf7[_0x404a1f(0x28d)]['id'],_0x404a1f(0x1be)),io['to'](_0x42054c)[_0x404a1f(0x149)](_0x404a1f(0x12a),{'access':{'allow':![],'reason':_0x404a1f(0x287),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1d5809=_0x107b97;return dbConfig[_0x1d5809(0x211)](_0x1d5809(0x282))[_0x1d5809(0xcb)]('botID')[_0x1d5809(0xed)]({'status':_0x1d5809(0x1d8)})[_0x1d5809(0x1a9)]()||[];}function getDisabledBots(){const _0x1df82c=_0x107b97;return dbConfig[_0x1df82c(0x211)](_0x1df82c(0x282))[_0x1df82c(0xcb)](_0x1df82c(0x121))[_0x1df82c(0xed)]({'status':'disabled'})[_0x1df82c(0x1a9)]()||[];}function getBotAttributes(_0xd816f4){const _0x2cfad6=_0x107b97;let _0x1ccae5={};const _0x3e447c=configpath+_0x2cfad6(0xd6)+_0xd816f4+_0x2cfad6(0x200),_0x4a548b=fs[_0x2cfad6(0x14b)](_0x3e447c);if(_0x4a548b){const _0x3b7961=fs['readFileSync'](_0x3e447c);try{const _0x270d54=JSON[_0x2cfad6(0xe0)](_0x3b7961),_0x1853ff=_0x270d54?_0x270d54['bot'][0x0][_0x2cfad6(0xc6)]:![];_0x1ccae5['mode']=_0x1853ff?_0x2cfad6(0x1e0):_0x2cfad6(0x15a),_0x1ccae5[_0x2cfad6(0xff)]=_0x270d54?_0x270d54[_0x2cfad6(0xe5)][0x0][_0x2cfad6(0xff)]:'Bot\x20'+_0xd816f4;}catch(_0x132054){_0x1ccae5['mode']='manual',_0x1ccae5[_0x2cfad6(0xff)]=_0x2cfad6(0x148)+_0xd816f4;}}else _0x1ccae5[_0x2cfad6(0x265)]=_0x2cfad6(0x15a),_0x1ccae5[_0x2cfad6(0xff)]=_0x2cfad6(0x148)+_0xd816f4;return _0x1ccae5;}function getBotsWithMode(){const _0x10b568=_0x107b97,_0x3537c7=dbConfig[_0x10b568(0x211)]('bots')[_0x10b568(0xcb)](_0x10b568(0x121))[_0x10b568(0x1a9)]()||[];return _0x3537c7[_0x10b568(0x21f)](_0x4b13f7=>{const _0x4fa2d7=_0x10b568;let _0x2797a3=getBotAttributes(_0x4b13f7[_0x4fa2d7(0x121)]);_0x4b13f7['mode']=_0x2797a3[_0x4fa2d7(0x265)];}),_0x3537c7;}function getBotExchanges(){const _0x31ce65=_0x107b97;let _0x37bfde=[];const _0x37127a=dbConfig['get']('bots')[_0x31ce65(0xcb)](_0x31ce65(0x121))['value']()||[];_0x37127a[_0x31ce65(0x21f)](_0x22b92c=>{const _0x5aeb69=_0x31ce65;if(_0x22b92c[_0x5aeb69(0x12a)]==_0x5aeb69(0x1d8)){const _0x2f83df=configpath+'bot-'+_0x22b92c[_0x5aeb69(0x121)]+_0x5aeb69(0x200),_0x58cbd8=fs['existsSync'](_0x2f83df);let _0x1aab16;if(_0x58cbd8){const _0x222b07=fs[_0x5aeb69(0x153)](_0x2f83df);try{const _0x2eb94a=JSON['parse'](_0x222b07);_0x1aab16=_0x2eb94a?_0x2eb94a[_0x5aeb69(0xe5)][0x0][_0x5aeb69(0x116)]:null;}catch(_0x531ef0){}}if(_0x1aab16)_0x37bfde[_0x5aeb69(0x1ce)](_0x1aab16);}});const _0x20b842=[...new Set(_0x37bfde)][_0x31ce65(0x13a)]();return _0x20b842;}async function initUser(){const _0x28dcad=_0x107b97;if(!settings[_0x28dcad(0x245)]){const _0xd89f44=uuidRandom();mixpanel[_0x28dcad(0x10e)](_0xd89f44),updateSetting(_0x28dcad(0x245),_0xd89f44);}}async function initSecure(){const _0x580eda=_0x107b97;let _0x5188e1=getSecure();if(!_0x5188e1['hasOwnProperty'](_0x580eda(0x1c7))){let _0x355b66=await generateKeys();_0x5188e1[_0x580eda(0x18b)]=_0x355b66[_0x580eda(0x18b)],_0x5188e1[_0x580eda(0x197)]=_0x355b66[_0x580eda(0x197)],_0x5188e1[_0x580eda(0x1c7)]=crypto[_0x580eda(0x129)](0x20)[_0x580eda(0x9b)](_0x580eda(0x14e));;storeSecure(_0x5188e1);}}function getSettings(){const _0x23d3df=_0x107b97;return dbSettings['get'](_0x23d3df(0x12e))[_0x23d3df(0x1a9)]()||{};}function getSecure(){const _0x538638=_0x107b97;return dbSecure[_0x538638(0x211)](_0x538638(0x27c))[_0x538638(0x1a9)]()||{};}function getBlacklist(){const _0xd69e26=_0x107b97;return dbSecure[_0xd69e26(0x211)]('blacklist')[_0xd69e26(0x1a9)]()||[];}function broadcastToBots(_0x4f86ea,_0x359e04){const _0x5b8496=_0x107b97;config[_0x5b8496(0x21f)](_0xeb90a7=>{const _0x2306c7=_0x5b8496;if(_0xeb90a7[_0x2306c7(0x12a)]==_0x2306c7(0x1d8)&&_0xeb90a7[_0x2306c7(0xe9)]==_0x2306c7(0x262)||_0xeb90a7[_0x2306c7(0x12a)]=='new'&&_0xeb90a7[_0x2306c7(0xe9)]==_0x2306c7(0x262)){if(pid[_0xeb90a7[_0x2306c7(0x121)]])pid[_0xeb90a7[_0x2306c7(0x121)]][_0x2306c7(0xba)]({[_0x4f86ea]:_0x359e04});}});}function storeSettings(_0x43d5b4,_0x31b235=![]){const _0x3af173=_0x107b97;_0x43d5b4={...settings,..._0x43d5b4};if(_0x31b235&&_0x43d5b4[_0x3af173(0x191)]!=_0x3af173(0x214)&&_0x43d5b4[_0x3af173(0x191)]!=_0x3af173(0x254)&&_0x43d5b4['bbPassword']!=''){const _0x329a24=crypt[_0x3af173(0x27a)](secure['privateKey'],_0x43d5b4['bbPassword'])[_0x3af173(0x176)]['split']('@')[0x0],_0x4cddce=bcrypt[_0x3af173(0x1b9)](_0x329a24,saltRounds);_0x43d5b4={..._0x43d5b4,'bbPassword':_0x4cddce};}if(_0x31b235&&_0x43d5b4[_0x3af173(0xd4)]!='************'&&_0x43d5b4[_0x3af173(0xd4)]!=_0x3af173(0x254)&&_0x43d5b4[_0x3af173(0xd4)]!=''){const _0x1e3b4b=crypt['decrypt'](secure[_0x3af173(0x197)],_0x43d5b4['telegramToken'])[_0x3af173(0x176)][_0x3af173(0x126)]('@')[0x0];_0x43d5b4={..._0x43d5b4,'telegramToken':_0x1e3b4b};}const _0x1e3ade=_0x43d5b4['telegramToken']!=_0x3af173(0x214)&&_0x43d5b4[_0x3af173(0xd4)]!=settings[_0x3af173(0xd4)]||_0x43d5b4[_0x3af173(0x157)]!=settings[_0x3af173(0x157)],_0x30a733=_0x43d5b4[_0x3af173(0xd4)]==''||_0x43d5b4[_0x3af173(0x157)]=='';_0x1e3ade&&(_0x43d5b4['telegramChatId']=null,_0x43d5b4[_0x3af173(0xf1)]='all');for(const [_0x44aac7,_0x3872eb]of Object[_0x3af173(0x258)](_0x43d5b4)){if(_0x44aac7=='telegramToken'&&_0x3872eb==_0x3af173(0x214)){_0x43d5b4[_0x3af173(0xd4)]=settings[_0x3af173(0xd4)];continue;};if(_0x44aac7==_0x3af173(0x191)&&_0x3872eb==_0x3af173(0x214)){_0x43d5b4[_0x3af173(0x191)]=settings[_0x3af173(0x191)];continue;};dbSettings[_0x3af173(0x27e)]('settings.'+_0x44aac7,_0x3872eb)[_0x3af173(0x15f)]();}settings=_0x43d5b4,io['to']('botmanager')[_0x3af173(0x149)](_0x3af173(0x12e),cleanSettings()),broadcastToBots(_0x3af173(0xe1),settings['timeshift']),broadcastToBots(_0x3af173(0xb8),settings[_0x3af173(0xb8)]);if(_0x1e3ade&&!_0x30a733)initTelegram();if(_0x1e3ade&&_0x30a733)disableTelegram();getAllClients()['forEach'](_0x3f5fd5=>{const _0x2e99b6=_0x3af173;getSocket(_0x3f5fd5['id'])[_0x2e99b6(0x149)]('status',{'access':{'allow':![],'reason':_0x2e99b6(0x1f5),'token':null}});});}function updateSetting(_0x52cdde,_0xf279ec){const _0x5d1e6f=_0x107b97;dbSettings[_0x5d1e6f(0x27e)](_0x5d1e6f(0x275)+_0x52cdde,_0xf279ec)[_0x5d1e6f(0x15f)](),settings=getSettings(),io['to'](_0x5d1e6f(0x1e2))[_0x5d1e6f(0x149)]('settings',cleanSettings());}function storeSecure(_0x5f566b){const _0x27bd50=_0x107b97;dbSecure[_0x27bd50(0x211)](_0x27bd50(0x27c))[_0x27bd50(0x1ce)](_0x5f566b)[_0x27bd50(0x15f)](),secure=_0x5f566b;}function addBlacklist(_0x494e0d){const _0x5a487c=_0x107b97;cleanBlacklist();let _0x49822d;devices[_0x494e0d][_0x5a487c(0x20d)]?_0x49822d=Math[_0x5a487c(0x281)](devices[_0x494e0d][_0x5a487c(0x20d)]['expiry'],loginExpiry):_0x49822d=loginExpiry,dbSecure[_0x5a487c(0x211)](_0x5a487c(0x104))[_0x5a487c(0x1ce)]({'expiry':new Date()[_0x5a487c(0x27d)]()+_0x49822d*0x3c*0x3e8,'token':devices[_0x494e0d][_0x5a487c(0x1c1)]['token']})[_0x5a487c(0x15f)](),blacklist=dbSecure['get'](_0x5a487c(0x104))[_0x5a487c(0x1a9)]();}function cleanBlacklist(){const _0x4f1d02=_0x107b97;let _0x2e121c=dbSecure['get']('blacklist')[_0x4f1d02(0x22b)]()[_0x4f1d02(0x1a9)](),_0x3ac917=new Date()[_0x4f1d02(0x27d)]();_0x2e121c['forEach'](_0x532f0c=>{const _0x49b10a=_0x4f1d02;_0x532f0c['expiry']<_0x3ac917&&dbSecure[_0x49b10a(0x211)](_0x49b10a(0x104))[_0x49b10a(0x1b6)]({'expiry':_0x532f0c['expiry']})[_0x49b10a(0x15f)]();});}function initStates(){const _0x542e88=_0x107b97;let _0x3b9972=getConfiguration();_0x3b9972[_0x542e88(0x21f)](_0x2fd4ab=>{const _0x36fbbf=_0x542e88;_0x2fd4ab[_0x36fbbf(0xe9)]=_0x36fbbf(0x1c8);}),storeConfiguration(_0x3b9972);}function onKeys(){const _0x271837=new RSA();return new Promise(_0x1e35d7=>{const _0x4bc5ec=_0x537f;_0x271837[_0x4bc5ec(0xb3)]()[_0x4bc5ec(0x23a)](_0x8c602d=>{_0x1e35d7(_0x8c602d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x41bdd5=_0x107b97;let _0x8c3fc4=getSettings(),_0x379b6a=![];!_0x8c3fc4[_0x41bdd5(0x23e)]('lastmsgtelegram')&&(_0x8c3fc4['lastmsgtelegram']=0x0,_0x379b6a=!![]);!_0x8c3fc4['hasOwnProperty'](_0x41bdd5(0x1d6))&&(_0x8c3fc4[_0x41bdd5(0x1d6)]=0x0,_0x379b6a=!![]);!_0x8c3fc4['hasOwnProperty']('latestversion')&&(_0x8c3fc4[_0x41bdd5(0x1fe)]=_0x41bdd5(0x28e),_0x379b6a=!![]);!_0x8c3fc4[_0x41bdd5(0x23e)](_0x41bdd5(0xb8))&&(_0x8c3fc4[_0x41bdd5(0xb8)]=![],_0x379b6a=!![]);if(_0x379b6a)storeSettings(_0x8c3fc4);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x41bdd5(0x21f)](_0x1b7f7b=>{const _0x4f917d=_0x41bdd5;if(!_0x1b7f7b[_0x4f917d(0x156)]()){if(!_0x1b7f7b['name'][_0x4f917d(0x95)](_0x4f917d(0x1f4)))fs[_0x4f917d(0x26c)](configbackuppath+_0x1b7f7b['name']);}else fs[_0x4f917d(0x194)](configbackuppath+_0x1b7f7b[_0x4f917d(0x127)],{'recursive':!![]});});}catch(_0x1e5a7a){logger['debug'](_0x41bdd5(0x22e),_0x1e5a7a);}}function storeConfiguration(_0x17a22e){const _0x16bd5b=_0x107b97;dbConfig[_0x16bd5b(0x211)](_0x16bd5b(0x282))[_0x16bd5b(0x1b6)]()[_0x16bd5b(0x15f)](),dbConfig['get'](_0x16bd5b(0x282))[_0x16bd5b(0x1ce)](..._0x17a22e)[_0x16bd5b(0x15f)](),config=_0x17a22e;}async function resetPassword(){const _0x23ab06=_0x107b97;if(tgBot&&settings['telegramChatId']){const _0x4d4cd5=Markup[_0x23ab06(0x16f)]([Markup[_0x23ab06(0x299)]['callback'](_0x23ab06(0x1b2),_0x23ab06(0x22c)),Markup['button']['callback']('no',_0x23ab06(0xe8))]);await sendTelegram(settings['telegramChatId'],_0x23ab06(0x108),_0x4d4cd5),tgBot[_0x23ab06(0x1c0)](/resetpw_(.+)/,async _0x2442eb=>{const _0x452e98=_0x23ab06,_0x5b40d4=_0x2442eb[_0x452e98(0x270)][0x1];_0x2442eb[_0x452e98(0x1e4)]();if(_0x5b40d4!='no'){const _0x1c63b1=0xf,_0x4050cd=_0x452e98(0x19f),_0x2155ca=Array[_0x452e98(0x1ba)](crypto['randomFillSync'](new Uint32Array(_0x1c63b1)))['map'](_0x42cec2=>_0x4050cd[_0x42cec2%_0x4050cd[_0x452e98(0x169)]])[_0x452e98(0x201)](''),_0x12eaa9=bcrypt[_0x452e98(0x1b9)](_0x2155ca,saltRounds);storeSettings({'bbPassword':_0x12eaa9}),await sendTelegram(_0x2442eb[_0x452e98(0x28d)]['id'],_0x452e98(0x100)+_0x2155ca,{'parse_mode':_0x452e98(0x248)});}else await sendTelegram(_0x2442eb[_0x452e98(0x28d)]['id'],_0x452e98(0x189));});}}async function confirmRestore(_0x1d3207,_0x4de199){const _0x2f0104=_0x107b97;io['to'](_0x2f0104(0x1e2))[_0x2f0104(0x149)](_0x2f0104(0xb2),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x2f0104(0x24e));if(tgBot&&settings[_0x2f0104(0x204)]){const _0x232aed=uuidRandom();tmpStorage[_0x232aed]={'path':_0x1d3207,'filename':_0x4de199};const _0x527001=Markup[_0x2f0104(0x16f)]([Markup[_0x2f0104(0x299)][_0x2f0104(0x20b)](_0x2f0104(0x1b2),'restore_yes_'+_0x232aed),Markup['button']['callback']('no',_0x2f0104(0x9c)+_0x232aed)]);await sendTelegram(settings[_0x2f0104(0x204)],_0x2f0104(0x18a),_0x527001),tgBot['action'](/restore_(.+)_(.+)/,async _0x10c341=>{const _0x5fc3ec=_0x2f0104,_0x23621f=_0x10c341[_0x5fc3ec(0x270)][0x1],_0x55ef5f=_0x10c341[_0x5fc3ec(0x270)][0x2],{path:_0x40e2c4,filename:_0x2015c1}=tmpStorage[_0x55ef5f];delete tmpStorage[_0x55ef5f],_0x10c341['editMessageReplyMarkup'](),_0x23621f==_0x5fc3ec(0x1b2)?(logger[_0x5fc3ec(0xea)](_0x5fc3ec(0x23f)),await sendTelegram(_0x10c341['chat']['id'],_0x5fc3ec(0x293),{'parse_mode':_0x5fc3ec(0x248)}),unzipFile(_0x40e2c4,_0x2015c1)):(logger[_0x5fc3ec(0xea)](_0x5fc3ec(0x289)),await sendTelegram(_0x10c341[_0x5fc3ec(0x28d)]['id'],_0x5fc3ec(0x289)));});}}function getServerTime(){const _0x865f1=_0x107b97,_0x1853ef=new Date();return _0x1853ef['getFullYear']()+'/'+(_0x1853ef[_0x865f1(0x136)]()+0x1)['toString']()[_0x865f1(0x273)](0x2,'0')+'/'+_0x1853ef[_0x865f1(0xd9)]()[_0x865f1(0x9b)]()[_0x865f1(0x273)](0x2,'0')+'\x20'+_0x1853ef['getHours']()[_0x865f1(0x9b)]()[_0x865f1(0x273)](0x2,'0')+':'+_0x1853ef[_0x865f1(0x118)]()['toString']()[_0x865f1(0x273)](0x2,'0')+':'+_0x1853ef[_0x865f1(0x24c)]()[_0x865f1(0x9b)]()[_0x865f1(0x273)](0x2,'0');}function getTimeStamp(){const _0x561290=_0x107b97,_0x86621d=shiftedTime();return _0x86621d[_0x561290(0x16a)]()+'/'+(_0x86621d[_0x561290(0x136)]()+0x1)[_0x561290(0x9b)]()[_0x561290(0x273)](0x2,'0')+'/'+_0x86621d[_0x561290(0xd9)]()[_0x561290(0x9b)]()[_0x561290(0x273)](0x2,'0')+'\x20'+_0x86621d['getHours']()[_0x561290(0x9b)]()[_0x561290(0x273)](0x2,'0')+':'+_0x86621d[_0x561290(0x118)]()[_0x561290(0x9b)]()[_0x561290(0x273)](0x2,'0')+':'+_0x86621d['getSeconds']()[_0x561290(0x9b)]()[_0x561290(0x273)](0x2,'0');}function getCleanTimeStamp(){const _0x5466ba=_0x107b97,_0x335d25=shiftedTime();return _0x335d25[_0x5466ba(0x16a)]()+(_0x335d25[_0x5466ba(0x136)]()+0x1)['toString']()[_0x5466ba(0x273)](0x2,'0')+_0x335d25[_0x5466ba(0xd9)]()[_0x5466ba(0x9b)]()[_0x5466ba(0x273)](0x2,'0')+'-'+_0x335d25[_0x5466ba(0x1fc)]()[_0x5466ba(0x9b)]()[_0x5466ba(0x273)](0x2,'0')+_0x335d25[_0x5466ba(0x118)]()['toString']()[_0x5466ba(0x273)](0x2,'0')+_0x335d25[_0x5466ba(0x24c)]()['toString']()[_0x5466ba(0x273)](0x2,'0');}function shiftedTime(){const _0x51dad7=_0x107b97,_0x13f901=new Date();let _0x23b590=_0x13f901;if(settings[_0x51dad7(0xe1)]&&settings[_0x51dad7(0xe1)]!==0x0)_0x23b590=fns[_0x51dad7(0xbc)](_0x13f901,{'hours':settings['timeshift']});return _0x23b590;}function startScheduler(){const _0x153954=new Date()['getUTCHours'](),_0x52520a=shiftedTime()['getHours']();_0x52520a==0x4&&backupConfigFiles();_0x52520a==0x0&&rotateLogFiles();_0x153954%0x6==0x0&&triggerAnalytics();_0x153954%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x9a68b7){const _0x205c1e=_0x107b97;logger[_0x205c1e(0xea)](_0x205c1e(0x172)+_0x9a68b7);const _0x3878a7=getBotsWithMode();_0x3878a7[_0x205c1e(0x169)]>0x0?confirmRestore(configbackuppath,_0x9a68b7):unzipFile(configbackuppath,_0x9a68b7);}async function getBackupFiles(_0x381f2e=null){const _0x5af82a=_0x107b97;let _0x2a1d11=[],_0xbc5fa6=fs[_0x5af82a(0x25a)](configbackuppath,{'withFileTypes':!![]});_0xbc5fa6[_0x5af82a(0x13a)]((_0x3666e5,_0x12577f)=>_0x3666e5[_0x5af82a(0x127)]<_0x12577f[_0x5af82a(0x127)]?0x1:_0x12577f[_0x5af82a(0x127)]<_0x3666e5['name']?-0x1:0x0),_0xbc5fa6[_0x5af82a(0x21f)](_0x36e8ae=>{const _0x15caf2=_0x5af82a;if(!_0x36e8ae[_0x15caf2(0x156)]()&&_0x36e8ae['name'][_0x15caf2(0x95)](_0x15caf2(0x1f4))&&_0x36e8ae[_0x15caf2(0x127)][_0x15caf2(0xad)](_0x15caf2(0x15c))){const _0x56ef77=formatDate(fs[_0x15caf2(0x22f)](configbackuppath+_0x36e8ae[_0x15caf2(0x127)])['mtime']);_0x2a1d11[_0x15caf2(0x1ce)]({'name':_0x36e8ae['name'],'mtime':_0x56ef77});}});if(_0x381f2e)io['to'](_0x381f2e)['emit'](_0x5af82a(0x12c),_0x2a1d11);else return _0x2a1d11;}async function backupConfigFiles(){const _0x5e265b=_0x107b97;await zipFiles(_0x5e265b(0x23c));const _0x2ab6c5=getCleanTimeStamp();fs[_0x5e265b(0x229)](zippath+_0x5e265b(0x10d),configbackuppath+(_0x5e265b(0x1f4)+_0x2ab6c5+'.zip'));let _0x223514=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x223514[_0x5e265b(0x13a)]((_0xedb383,_0x52895a)=>_0xedb383[_0x5e265b(0x127)]<_0x52895a['name']?0x1:_0x52895a[_0x5e265b(0x127)]<_0xedb383[_0x5e265b(0x127)]?-0x1:0x0),_0x223514[_0x5e265b(0x169)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x223514[_0x223514[_0x5e265b(0x169)]-0x1]['name']);}function rotateLogFiles(){const _0x45638a=_0x107b97,_0x1bc3d8=fs['statSync'](logspath+_0x45638a(0x195)),_0x5d3862=_0x1bc3d8['size']/0x400;if(_0x5d3862>0x64){let _0x187e5e=fs[_0x45638a(0x25a)](logspath,{'withFileTypes':!![]});_0x187e5e[_0x45638a(0x13a)]((_0x1ad5a6,_0x51d88f)=>_0x1ad5a6[_0x45638a(0x127)]<_0x51d88f[_0x45638a(0x127)]?0x1:_0x51d88f['name']<_0x1ad5a6['name']?-0x1:0x0),_0x187e5e[_0x45638a(0x21f)](_0x1faddf=>{const _0x32d299=_0x45638a;if(_0x1faddf[_0x32d299(0x127)]==_0x32d299(0xf2))fs['copyFileSync'](logspath+_0x1faddf[_0x32d299(0x127)],logspath+'output-003.log');if(_0x1faddf[_0x32d299(0x127)]=='output-001.log')fs[_0x32d299(0x229)](logspath+_0x1faddf['name'],logspath+_0x32d299(0xf2));_0x1faddf['name']=='output-000.log'&&(fs['copyFileSync'](logspath+_0x1faddf[_0x32d299(0x127)],logspath+'output-001.log'),fs[_0x32d299(0xdc)](logspath+_0x1faddf['name'],''));});}}async function zipFiles(_0x1e6329){const _0x4f5e7e=_0x107b97;let _0x3eae9b;if(_0x1e6329==_0x4f5e7e(0xf7))_0x3eae9b=logspath;if(_0x1e6329==_0x4f5e7e(0x26e))_0x3eae9b=configpath;if(_0x1e6329==_0x4f5e7e(0x23c))_0x3eae9b=configpath;let _0x23a8a9=fs[_0x4f5e7e(0x25a)](_0x3eae9b,{'withFileTypes':!![]});const _0x278c15=new require('node-zip')();_0x23a8a9[_0x4f5e7e(0x21f)](_0x17c432=>{const _0x111126=_0x4f5e7e;if(!_0x17c432[_0x111126(0x156)]()){let _0x30368a=fs[_0x111126(0x153)](_0x3eae9b+_0x17c432[_0x111126(0x127)]);if(_0x1e6329==_0x111126(0x26e)){const _0x2cf949=/^bot-[0-9]{3}-config.json$/,_0x563337=_0x2cf949[_0x111126(0x1a5)](_0x17c432[_0x111126(0x127)]);if(_0x563337){const _0x1941c6=JSON[_0x111126(0xe0)](_0x30368a);if(_0x1941c6[_0x111126(0xe5)][0x0]){_0x1941c6[_0x111126(0xe5)][0x0][_0x111126(0x1b1)]='***',_0x1941c6[_0x111126(0xe5)][0x0]['apiSecret']=_0x111126(0x254);if(_0x1941c6[_0x111126(0xe5)][0x0][_0x111126(0xa8)])_0x1941c6[_0x111126(0xe5)][0x0]['apiPassword']=_0x111126(0x254);}_0x30368a=JSON[_0x111126(0x255)](_0x1941c6,null,0x2);}if(_0x17c432[_0x111126(0x127)]==_0x111126(0x222)){const _0x1d57db=JSON[_0x111126(0xe0)](_0x30368a);if(_0x1d57db['settings'][_0x111126(0x128)])_0x1d57db[_0x111126(0x12e)][_0x111126(0x128)]=![];if(_0x1d57db['settings'][_0x111126(0x191)])_0x1d57db[_0x111126(0x12e)][_0x111126(0x191)]=_0x111126(0x254);if(_0x1d57db['settings'][_0x111126(0xd4)])_0x1d57db[_0x111126(0x12e)][_0x111126(0xd4)]=_0x111126(0x254);if(_0x1d57db[_0x111126(0x12e)][_0x111126(0x204)])_0x1d57db['settings'][_0x111126(0x204)]=null;_0x30368a=JSON[_0x111126(0x255)](_0x1d57db,null,0x2);}if(_0x17c432[_0x111126(0x127)]!='bb-secure.json')_0x278c15[_0x111126(0x187)](_0x17c432['name'],_0x30368a);}else _0x278c15[_0x111126(0x187)](_0x17c432[_0x111126(0x127)],_0x30368a);}});const _0x421b1d=_0x278c15[_0x4f5e7e(0x286)]({'base64':![],'compression':_0x4f5e7e(0xe4)});fs[_0x4f5e7e(0xdc)](zippath+(_0x1e6329+_0x4f5e7e(0x15c)),_0x421b1d,_0x4f5e7e(0x19b));}async function unzipFile(_0x352464,_0x3ae4f1){const _0x166914=_0x107b97;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x166914(0x21f)](_0x460a82=>{const _0x478052=_0x166914;if(!_0x460a82['isDirectory']())fs[_0x478052(0x194)](configpath+_0x460a82[_0x478052(0x127)]);});const _0x44269a=fs[_0x166914(0x153)](_0x352464+_0x3ae4f1,_0x166914(0x19b)),_0x5cc177=new require(_0x166914(0x230))(_0x44269a,{'base64':![],'checkCRC32':!![]});Object[_0x166914(0x175)](_0x5cc177[_0x166914(0x135)])[_0x166914(0x21f)](_0x2c667e=>{const _0x36732c=_0x166914,_0x3d36b9=_0x5cc177[_0x36732c(0x135)][_0x2c667e];fs['writeFileSync'](configpath+_0x3d36b9['name'],_0x3d36b9[_0x36732c(0x28a)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x166914(0x21f)](_0x45ba96=>{const _0x16a8a5=_0x166914;if(!_0x45ba96[_0x16a8a5(0x156)]())fs[_0x16a8a5(0x194)](temppath+_0x45ba96[_0x16a8a5(0x127)]);}),logger['debug'](_0x166914(0xa2)),process[_0x166914(0xba)]({'restore':!![]},_0x54c729=>{});}async function getPublicIp(){const _0x565525=_0x107b97;try{const _0x3d5952=await axios[_0x565525(0x211)](_0x565525(0x1d9));publicip=_0x3d5952[_0x565525(0x9a)]['ip'];}catch(_0x1ee0e5){}}async function triggerAnalytics(){const _0x4f8dc6=_0x107b97;if(!publicip)await getPublicIp();const _0x29731c=getBotsWithMode();let _0x7fdf0a=0x0;_0x29731c['forEach'](_0x32535b=>{const _0x1a291a=_0x537f;if(_0x32535b[_0x1a291a(0x12a)]==='enabled')_0x7fdf0a++;});const _0x3bc1ad=getBotExchanges();mixpanel[_0x4f8dc6(0x11f)](_0x4f8dc6(0x12f),{'distinct_id':settings[_0x4f8dc6(0x245)],'ip':publicip,'version':serverversion,'numbots':_0x29731c[_0x4f8dc6(0x169)],'numbotsenabled':_0x7fdf0a,'exchanges':_0x3bc1ad,'environment':environment});}async function getMessages(){const _0xc8dc2e=_0x107b97,_0x5edf11=_0xc8dc2e(0x26f),_0xd3e794=new GraphQLClient(_0x5edf11),_0xbd4280={'authorization':_0xc8dc2e(0x231)},_0x5aac4c=serverversion[_0xc8dc2e(0x126)]('.'),_0x36eadc=_0x5aac4c[0x0]+'.'+_0x5aac4c[0x1],_0x523e93=Math[_0xc8dc2e(0x215)](settings[_0xc8dc2e(0x140)],settings[_0xc8dc2e(0x1d6)]),_0xed53cf={'last':parseInt(_0x523e93),'bbm':_0x36eadc},_0x1bb333=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x45e1d1;try{_0x45e1d1=await _0xd3e794[_0xc8dc2e(0x181)](_0x1bb333,_0xed53cf,_0xbd4280);}catch(_0x177eea){}if(_0x45e1d1&&_0x45e1d1['messages']){let _0x6cdaf9=settings[_0xc8dc2e(0x140)];newMessages=[];for(const _0x869ecd of _0x45e1d1[_0xc8dc2e(0x18f)]){newMessages[_0xc8dc2e(0x1ce)](_0x869ecd);let _0xd7f066=![];_0x869ecd[_0xc8dc2e(0x242)]&&(updateSetting('latestversion',_0x869ecd[_0xc8dc2e(0x242)]),_0xd7f066=isNewerVersion(serverversion,_0x869ecd[_0xc8dc2e(0x242)])||serverversion==_0x869ecd[_0xc8dc2e(0x242)]);if(!_0xd7f066&&_0x869ecd[_0xc8dc2e(0x240)]>_0x6cdaf9){if(_0x869ecd[_0xc8dc2e(0xc1)]===_0xc8dc2e(0x272)||serverversion[_0xc8dc2e(0x95)](_0x869ecd[_0xc8dc2e(0xc1)])){let _0x260789=''+_0x869ecd[_0xc8dc2e(0x17e)]+'\x0a\x0a'+_0x869ecd[_0xc8dc2e(0x176)];const _0x1ecc76=await sendTelegramMsg(toTelegramMarkdown(_0x260789),_0xc8dc2e(0x134));if(_0x1ecc76)_0x6cdaf9=_0x869ecd['number'];}}}updateAvailable=isNewerVersion(settings[_0xc8dc2e(0x1fe)],serverversion),updateSetting('lastmsgtelegram',_0x6cdaf9),emitMessages();}}function emitMessages(){const _0x244deb=_0x107b97,_0x445e8b=settings[_0x244deb(0x1d6)];let _0x5dc485=[];newMessages[_0x244deb(0x21f)](_0x5e30df=>{const _0xfabf3e=_0x244deb;_0x5e30df[_0xfabf3e(0x240)]>_0x445e8b&&_0x5dc485['push'](_0x5e30df);}),_0x5dc485['length']>0x0&&getAllClients()[_0x244deb(0x21f)](_0x363a7a=>{const _0x5020dd=_0x244deb;getSocket(_0x363a7a['id'])[_0x5020dd(0x149)]('message',_0x5dc485);});}function confirmMessage(_0x5e5d49){const _0x45e90c=_0x107b97;updateSetting(_0x45e90c(0x1d6),Number(_0x5e5d49));}function isNewerVersion(_0x187aef,_0x1895ff){const _0x12c91e=_0x107b97,_0x285d56=_0x1895ff[_0x12c91e(0x126)]('.'),_0x2a8236=_0x187aef[_0x12c91e(0x126)]('.');for(var _0x1cd233=0x0;_0x1cd233<_0x2a8236[_0x12c91e(0x169)];_0x1cd233++){const _0x2a046b=~~_0x2a8236[_0x1cd233],_0x3b4f20=~~_0x285d56[_0x1cd233];if(_0x2a046b>_0x3b4f20)return!![];if(_0x2a046b<_0x3b4f20)return![];}return![];}function toTelegramMarkdown(_0x3754a0){const _0x38eac3=_0x107b97,_0x5dedb0=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3414c5=/\*{2}(.+?)\*{2}/gim;return _0x3754a0=_0x3754a0[_0x38eac3(0x208)](_0x5dedb0,_0x38eac3(0x298))[_0x38eac3(0x208)](_0x3414c5,'*$1*'),_0x3754a0;}async function validateConfigFile(){const _0x5c4333=_0x107b97,_0x3c53ed=dbConfig['get'](_0x5c4333(0x282))['sortBy'](_0x5c4333(0x121))[_0x5c4333(0x1a9)]()||[];if(_0x3c53ed[_0x5c4333(0x169)]==0x0){let _0x127de4=0x0,_0x548ac5=[];const _0x5727db=/^bot-([0-9]{3})-config.json$/,_0x46007d=fs['readdirSync'](configpath);_0x46007d['forEach'](_0x187200=>{const _0x24104=_0x5c4333,_0x4a7abd=_0x5727db[_0x24104(0x227)](_0x187200);if(_0x4a7abd){const _0x2c8786=_0x4a7abd[0x1];let _0x5d56ff=getBotAttributes(_0x2c8786);_0x548ac5[_0x24104(0x1ce)]({'botID':_0x2c8786,'botname':_0x5d56ff[_0x24104(0xff)],'status':_0x24104(0x1ec),'live':_0x24104(0x1c8)}),_0x127de4++;}}),_0x127de4!=0x0&&(dbConfig['get'](_0x5c4333(0x282))[_0x5c4333(0x1b5)](_0x548ac5)[_0x5c4333(0x15f)](),config=_0x548ac5,restoredConfigFile=_0x127de4);}}async function restoreConfigNotify(_0x3d4612){const _0x1c2101=_0x107b97;let _0x4a622c;if(restoredConfigFile==0x1)_0x4a622c=_0x1c2101(0x1a8);else _0x4a622c=_0x1c2101(0x1e3);if(_0x3d4612)io['to']('botmanager')[_0x1c2101(0x149)](_0x1c2101(0xb2),_0x4a622c);else{logger[_0x1c2101(0xbb)]('-----------------------------------------------------------------------------------'),logger[_0x1c2101(0xbb)](_0x4a622c),logger[_0x1c2101(0xbb)]('-----------------------------------------------------------------------------------'),logger[_0x1c2101(0xbb)]('');if(tgBot&&settings[_0x1c2101(0x204)]&&settings['telegramEvents']!=_0x1c2101(0x152))await sendTelegram(settings['telegramChatId'],_0x1c2101(0x25f)+_0x4a622c);}}function validateCredentials(_0x114d67,_0x301af2){const _0x268a61=_0x107b97;if(_0x114d67['username']==settings['bbUsername']&&bcrypt[_0x268a61(0x21b)](_0x114d67[_0x268a61(0x1f9)],settings[_0x268a61(0x191)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5560ce=generateLoginToken(_0x301af2);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5560ce};}}else return{'allow':![],'reason':_0x268a61(0x125),'token':null};}function refreshToken(_0x15520b){const _0x2f98df=generateLoginToken(_0x15520b);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2f98df};}function validateAccess(_0x244bc8,_0x9f7a8d,_0x339094){const _0x1aa359=_0x107b97,_0x273c8e=_0x339094?_0x339094:devices[_0x9f7a8d]['ip'];let _0x27f60f;const _0x4b656c=_0x49a6b3=>{const _0x774192=_0x537f;if(settings[_0x774192(0x128)]){if(settings[_0x774192(0x243)]){if(telegram2FaApproved(_0x9f7a8d)){const _0x30b0a4=generateLoginToken(_0x9f7a8d);return{'allow':!![],'reason':_0x774192(0x284),'token':_0x30b0a4};}else return{'allow':![],'reason':_0x774192(0x13f),'token':null};}else return _0x27f60f=validToken(_0x49a6b3,_0x9f7a8d),_0x27f60f['hasOwnProperty']('success')?{'allow':!![],'reason':_0x774192(0x1cb),'token':_0x49a6b3}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x774192(0x285),'token':null};};if(settings['whitelistEnabled']){let _0x50c40d=[...settings[_0x1aa359(0xf0)],_0x1aa359(0x234),'::ffff:127.0.0.1','127.0.0.1'];if(_0x50c40d['includes'](_0x273c8e))return _0x4b656c(_0x244bc8);else{_0x27f60f=validToken(_0x244bc8,_0x9f7a8d);if(_0x27f60f[_0x1aa359(0x23e)](_0x1aa359(0x24e)))return _0x4b656c(_0x244bc8);else{if(telegramIpApproved(_0x9f7a8d)){const _0x278cfe=generateToken(_0x9f7a8d);return _0x27f60f=_0x4b656c(_0x244bc8),_0x27f60f[_0x1aa359(0x295)]?{'allow':!![],'reason':_0x1aa359(0xfd),'token':_0x278cfe}:_0x27f60f;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4b656c(_0x244bc8);}function timelyDecrypt(_0xb3cc6f,_0x4454a7=!![]){const _0x6b7a26=_0x107b97;if(_0xb3cc6f)try{const _0x39bd7e=crypt['decrypt'](secure[_0x6b7a26(0x197)],_0xb3cc6f)[_0x6b7a26(0x176)],_0x2e894c=_0x39bd7e[_0x6b7a26(0x126)]('@')[0x0],_0x2805ab=_0x39bd7e[_0x6b7a26(0x126)]('@')[0x1],_0x143b0f=new Date()[_0x6b7a26(0x27d)]();if(_0x4454a7){if(_0x143b0f-_0x2805ab<maxSecretAge*0x3e8)return _0x2e894c;else return![];}else return _0x2e894c;}catch(_0x5dd632){return![];}else return![];}const validToken=(_0x3896ca,_0x13b330)=>{const _0x430c9a=_0x107b97,_0x2cda08=devices[_0x13b330]['ip'];if(!_0x3896ca)return{'error':_0x430c9a(0x278)};for(let _0x3e9726 of blacklist){if(_0x3e9726[_0x430c9a(0x1a3)]==_0x3896ca)return{'error':_0x430c9a(0x179)};}let _0xd2774a;try{_0xd2774a=jwt[_0x430c9a(0x212)](_0x3896ca,secure[_0x430c9a(0x1c7)]+_0x13b330);}catch{return{'error':_0x430c9a(0x146)};}if(!_0xd2774a['hasOwnProperty'](_0x430c9a(0x235))&&!_0xd2774a['hasOwnProperty'](_0x430c9a(0x27f))||!_0xd2774a[_0x430c9a(0x23e)](_0x430c9a(0xf8)))return{'error':_0x430c9a(0x109)};if(!_0xd2774a[_0x430c9a(0x23e)](_0x430c9a(0x27f))&&_0xd2774a[_0x430c9a(0x23e)](_0x430c9a(0x235))){const {clientip:_0x4855c4}=_0xd2774a;return _0x2cda08==_0x4855c4?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x430c9a(0x11e)};}else{if(_0xd2774a['hasOwnProperty'](_0x430c9a(0x27f))&&_0xd2774a['hasOwnProperty'](_0x430c9a(0x235))){const {username:_0x1513d3,clientip:_0x237575}=_0xd2774a;return settings[_0x430c9a(0x17a)]==_0x1513d3&&_0x2cda08==_0x237575?{'success':_0x430c9a(0x228)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xd541e9=>{const _0x22a294=_0x107b97;if(_0xd541e9){const _0x105f22=devices[_0xd541e9]['ip'];return jwt[_0x22a294(0x143)]({'username':settings[_0x22a294(0x17a)],'clientip':_0x105f22},secure[_0x22a294(0x1c7)]+_0xd541e9,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4f9c34=>{const _0x201bc8=_0x107b97;if(_0x4f9c34){const _0x47a0ba=devices[_0x4f9c34]['ip'];return jwt[_0x201bc8(0x143)]({'clientip':_0x47a0ba},secure[_0x201bc8(0x1c7)]+_0x4f9c34,{'expiresIn':devices[_0x4f9c34]['telegramIpApproval'][_0x201bc8(0x132)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3ad02d=>{const _0x217c10=_0x107b97;let _0x13adbe=![];return devices[_0x3ad02d][_0x217c10(0x20d)]&&devices[_0x3ad02d]['telegramIpApproval'][_0x217c10(0x132)]!='reject'&&(_0x13adbe=devices[_0x3ad02d][_0x217c10(0x20d)][_0x217c10(0x235)]==devices[_0x3ad02d]['ip']&&new Date()[_0x217c10(0x27d)]()-devices[_0x3ad02d][_0x217c10(0x20d)][_0x217c10(0xca)]<devices[_0x3ad02d]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x13adbe;},telegram2FaApproved=_0x26ddde=>{const _0x3234b2=_0x107b97;let _0x9e0837=![];return devices[_0x26ddde][_0x3234b2(0x19a)]&&devices[_0x26ddde][_0x3234b2(0x19a)]['expiry']!=_0x3234b2(0x28b)&&(_0x9e0837=devices[_0x26ddde]['telegram2FaApproval']['clientip']==devices[_0x26ddde]['ip']&&new Date()[_0x3234b2(0x27d)]()-devices[_0x26ddde]['telegram2FaApproval'][_0x3234b2(0xca)]<devices[_0x26ddde][_0x3234b2(0x19a)][_0x3234b2(0x132)]*0x3c*0x3e8),_0x9e0837;},normalizeIP=_0x358846=>{const _0x4511d5=_0x107b97;let _0xa24353=null,_0x4cdded=null;if(ipaddr['isValid'](_0x358846)){const _0x155e7d=ipaddr[_0x4511d5(0xe0)](_0x358846);_0x155e7d[_0x4511d5(0x19e)]()===_0x4511d5(0x223)?(_0x155e7d[_0x4511d5(0x13d)]()&&(_0xa24353=_0x155e7d[_0x4511d5(0x1ed)]()[_0x4511d5(0x9b)]()),_0x4cdded=_0x155e7d[_0x4511d5(0x9b)]()):(_0xa24353=_0x155e7d[_0x4511d5(0x9b)](),_0x4cdded=_0x155e7d['toIPv4MappedAddress']()[_0x4511d5(0x9b)]());}return{'show':_0xa24353?_0xa24353:_0x4cdded,'store':_0x4cdded};};function formatDate(_0x3ba27c){const _0x25d6be=_0x107b97;return _0x3ba27c[_0x25d6be(0x16a)]()+'/'+(_0x3ba27c['getMonth']()+0x1)[_0x25d6be(0x9b)]()[_0x25d6be(0x273)](0x2,'0')+'/'+_0x3ba27c[_0x25d6be(0xd9)]()[_0x25d6be(0x9b)]()['padStart'](0x2,'0')+'\x20'+_0x3ba27c[_0x25d6be(0x1fc)]()['toString']()[_0x25d6be(0x273)](0x2,'0')+':'+_0x3ba27c[_0x25d6be(0x118)]()[_0x25d6be(0x9b)]()[_0x25d6be(0x273)](0x2,'0')+':'+_0x3ba27c[_0x25d6be(0x24c)]()['toString']()['padStart'](0x2,'0');}function sleep(_0x268009){return new Promise(_0x1dbf95=>setTimeout(_0x1dbf95,_0x268009));}