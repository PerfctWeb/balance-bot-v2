const _0x42acb5=_0x314d;(function(_0x2859b8,_0x51faf5){const _0x37f52d=_0x314d,_0x2e2e44=_0x2859b8();while(!![]){try{const _0x39a3c6=parseInt(_0x37f52d(0x335))/0x1+parseInt(_0x37f52d(0x25b))/0x2+parseInt(_0x37f52d(0x33c))/0x3+parseInt(_0x37f52d(0x399))/0x4+parseInt(_0x37f52d(0x364))/0x5+-parseInt(_0x37f52d(0x1ef))/0x6*(parseInt(_0x37f52d(0x26e))/0x7)+-parseInt(_0x37f52d(0x279))/0x8;if(_0x39a3c6===_0x51faf5)break;else _0x2e2e44['push'](_0x2e2e44['shift']());}catch(_0x3d0bb0){_0x2e2e44['push'](_0x2e2e44['shift']());}}}(_0x1d6d,0x7ae42));const _0x5306b7=function(){let _0x3c37f2=!![];return function(_0xc9ede1,_0x5c648e){const _0x4fc429=_0x3c37f2?function(){if(_0x5c648e){const _0x663258=_0x5c648e['apply'](_0xc9ede1,arguments);return _0x5c648e=null,_0x663258;}}:function(){};return _0x3c37f2=![],_0x4fc429;};}(),_0x37600a=_0x5306b7(this,function(){const _0x4476d5=_0x314d;return _0x37600a[_0x4476d5(0x3aa)]()[_0x4476d5(0x228)]('(((.+)+)+)+$')['toString']()[_0x4476d5(0x318)](_0x37600a)['search']('(((.+)+)+)+$');});_0x37600a();'use strict';process['env'][_0x42acb5(0x34a)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x42acb5(0x2c0)),FileSync=require(_0x42acb5(0x362)),path=require('path'),crypto=require(_0x42acb5(0x211)),Crypt=require('hybrid-crypto-js')[_0x42acb5(0x269)],RSA=require('hybrid-crypto-js')[_0x42acb5(0x1f1)],bcrypt=require(_0x42acb5(0x356)),jwt=require(_0x42acb5(0x2a3)),ipaddr=require(_0x42acb5(0x3a5)),argv=require(_0x42acb5(0x2ab))(process[_0x42acb5(0x2dc)]['slice'](0x2))['argv'],uuidRandom=require(_0x42acb5(0x349)),TelegramBot=require(_0x42acb5(0x28b)),Mixpanel=require(_0x42acb5(0x25c)),axios=require(_0x42acb5(0x322)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x42acb5(0x2eb)),fileUpload=require(_0x42acb5(0x208)),{networkInterfaces}=require('os'),PORT=argv[_0x42acb5(0x2b4)]||_0x42acb5(0x29a),pattern=/^[0-9]{2,4}$/;!pattern[_0x42acb5(0x23f)](PORT)&&(console[_0x42acb5(0x270)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x42acb5(0x2d4)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x42acb5(0x332)][_0x42acb5(0x28a)];let bbpath=_0x42acb5(0x256),bbpath2='';const botfile=_0x42acb5(0x22f),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x42acb5(0x346))['environment']||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x42acb5(0x254)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x42acb5(0x280)),configpath=userID?bbpath+_0x42acb5(0x396)+userID+'/':bbpath+_0x42acb5(0x396),configbackuppath=configpath+_0x42acb5(0x214),logspath=userID?bbpath+_0x42acb5(0x323)+userID+'/':bbpath+_0x42acb5(0x323),zippath=userID?bbpath+_0x42acb5(0x242)+userID+'/':bbpath+_0x42acb5(0x242),loggerfile=fs[_0x42acb5(0x363)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x42acb5(0x231)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x42acb5(0x260)](configpath);!fs[_0x42acb5(0x254)](configbackuppath)&&fs[_0x42acb5(0x260)](configbackuppath);!fs[_0x42acb5(0x254)](logspath)&&fs[_0x42acb5(0x260)](logspath);!fs[_0x42acb5(0x254)](zippath)&&fs[_0x42acb5(0x260)](zippath);!fs[_0x42acb5(0x254)](temppath)&&fs[_0x42acb5(0x260)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x42acb5(0x29e)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x42acb5(0x29e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x42acb5(0x33a),'onepagemode':![]}})[_0x42acb5(0x305)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x42acb5(0x29e)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x42acb5(0x212)});const saltRounds=0xa,mixpanel=Mixpanel[_0x42acb5(0x2cf)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x42acb5(0x268)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x42acb5(0x384)]&&settings['telegramToken']!=''&&settings[_0x42acb5(0x2d5)]&&settings[_0x42acb5(0x2d5)]!='')initTelegram();function _0x1d6d(){const _0x189fc4=['uuid-random','NTBA_FIX_319','All\x20bots\x20running\x20right\x20now','temporaryAccessAllowed','request','Password\x20reset\x20rejected','headless','rmSync','sign','toggle-bot-mode','download','connected','private','bcryptjs','whitelistEnabled','kill','secure','telegramEvents','isValid','\x20|\x20user:\x20...','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','endsWith','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','callback_query','entries','lowdb/adapters/FileSync','createWriteStream','1638995LNlIJY','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Setting\x20access:\x20','userid','Unauthorized\x20attempt\x20to\x20download\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','15\x20min','-performance.json','socket','includes','removeListener','temporary\x20access\x20not\x20allowed','SIGTERM','warning','order','bot','telegramEnabled','Unauthorized\x20attempt\x20to\x20log\x20out','emit','/download/:type','Starting\x20Balance\x20Bot\x20reinstallation','version','sockets','conn','All\x20bots','secret','telegramChatId','reset-password','[ip-address]','get-portfolio','access','telegramToken','Invalid\x20authentication\x20token\x20(1)','length','reinstall-bb','binary','logout','Unauthorized\x20attempt\x20to\x20update\x20settings','add','Unauthorized\x20login\x20attempt\x20(timeout)','Session\x20expired\x20for\x20user\x20...','stopPolling','Unauthorized\x20attempt\x20to\x20store\x20configuration','loginRequired','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','/:bot/configuration','all','Unauthorized\x20attempt\x20to\x20confirm\x20message','bbPassword','config/','event','bots','3626648jYaUPK','use','send','find','bbvNew','string','output-001.log','\x20minutes','updatebotmanager','enabled','/names\x20-\x20show\x20bot\x20names\x0a','cancelLoading','ipaddr.js','hex','Login\x20accepted','-config.json','Error\x20removing\x20old\x20backup\x20files:','toString','add-bot','delete-bot','data','2FA\x20login\x20token\x20generated','value','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','readdirSync','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','keys','Unauthorized\x20attempt\x20to\x20show\x20configuration','\x20>\x20','uncaughtException','placeOrder','Starting\x20#RED#Balance\x20Bot\x20v','getTime','Disabled\x20Bot\x20','getHours','botname','Your\x20installation\x20is\x20already\x20up\x20to\x20date','2FA\x20required','store-settings','status','emitHistory','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','express','started','sendMessage','reason','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','auth','verify','2FA\x20login\x20rejected','login\x20token\x20valid','file','storeHeadless','latestversion','-events.json','stopped','850182PRHEsX','live','RSA','access\x20timeout','files','backup-full.zip','publicKey','restore-backup-file','timeshift','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','auto','/:bot','Logged\x20out\x20user\x20...','Access\x20enabled\x20for\x20','allow','All','size','Backup\x20file\x20uploaded','join','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','HTML','update','exp','slice','express-fileupload','yes','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','kind','randomBytes','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','File\x20uploaded','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','crypto','RSA-OAEP','You\x20can\x20use\x20the\x20following\x20commands:\x0a','backup/','toIPv4MappedAddress','Notifications\x20disabled\x0a','127.0.0.1','.zip','Password\x20has\x20been\x20reset\x20to:\x20','number',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','index.html','sendFile','output-000.log','login\x20not\x20required','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','range','then','temporary\x20access\x20timeout','getMinutes','Server','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','search','cloneDeep','running','Token\x20blacklisted','notification','padStart','\x1b[35m','bot.js','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','temp/','answerCallbackQuery','Starting\x20Balance\x20Bot\x20update','show-config','resetHistory','::1','from','logs','Yes','sortBy','bot-','disabled','Markdown','filter','test','show','/off\x20-\x20stop\x20bot(s)\x0a','zip/','disconnect','ipv6','Notifications\x20enabled\x0a','map','Notifications\x20disabled','listen','reload','headers','storeFiat','botID','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','pidExpireLogin','***','-----------------------------------------------------------------------------------','statSync','delete-alerts','telegram','existsSync','Network\x20Interfaces:','bb/','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','$1_$2_$3','inherit','telegram2FaApproval','1686836pEZaOm','mixpanel','params','token','getSeconds','mkdirSync','sendPortfolioTelegram','backup-full@','any','set','\x1b[34m','get-logs','exec','api-eu.mixpanel.com','Crypt','https://api.ipify.org?format=json','=>\x20Go\x20to\x20#CYA#http://','track','No\x20authentication\x20token','7pPDUDy','\x20mode','log','new','node-zip','function','generateKeyPairAsync','\x20to\x20','IPv4','reject','message','21595072vBOLgz','\x20only\x0a','settings','apiKey','/status\x20-\x20show\x20bot(s)\x20status\x0a','login\x20required','Allow\x20login\x20from\x20IP\x20address\x20<b>','clients','store-fiat','getPortfolio','catch','match','Notifications\x20types:\x20','/disable\x20-\x20disable\x20notifications\x0a','build2','getDate','alerts','node','node-telegram-bot-api','max','Login\x20rejected','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','confirm-message','split','manual','once','orders','onepagemode','encryptedUuid','get-messages','Restarting\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20','post','3000','<b>Telegram\x20Bot\x20Status:</b>\x0a','unlinkSync','::ffff:127.0.0.1','defaults','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','onText','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Failed\x20to\x20download\x20','jsonwebtoken','login','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','get-backup-files','Starting\x20new\x20bot\x20|\x20Bot\x20','botmanager','No\x20bots\x20running\x20right\x20now','lastmsgtelegram','yargs/yargs','Bot\x20','handshake','compareSync','backup-files','stop','Bot\x20Mgr\x20>\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','toggleBotMode','port','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','</b>\x20?','generate','timestamp','temporary\x20access\x20rejected','\x20|\x20','output-003.log','assign','_data','createServer','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','lowdb','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','lastmsgemitted','restart','\x1b[0m','login\x20token\x20generated','sort','DEFLATE','/upload-backup','error','Invalid\x20IP\x20address','SIGINT','backupfile','reinstall','pidRefreshToken','init','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','invalid\x20credentials','readFileSync','getUTCHours','host','telegramUsername','(staging)','/:bot/portfolio','Restore\x20process\x20aborted','hasOwnProperty','************','Invalid\x20username\x20or\x20IP\x20address','argv','1000','build','parse','telegramIpApproval','success','privateKey','Restore\x20backup\x20file\x20','mode','bb-secure.json','whitelist','temporary\x20token\x20generated','Alerts','apiPassword','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','util','startsWith','replace','format','clientip','push','404\x20Not\x20Found','writeFileSync','password','toIPv4Address','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/:bot/coins','store','full','alias','type','username','/restart\x20-\x20restart\x20bot(s)\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','mtime','Unauthorized\x20attempt\x20to\x20get\x20messages','Logged\x20in\x20user\x20...','2FA','\x1b[33m','Invalid\x20Telegram\x20token','write','chat','bbUsername','copyFileSync','settings.','messages','hashSync','socket.io','f2aRequired','expiry','isDirectory','referer','Unauthorized\x20attempt\x20to\x20add\x20bot',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','debug','removeAllListeners','output-002.log','remove','Orders','constructor','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','forEach','simple','blacklist','stringify','*$1*','#RES#\x20if\x20running\x20on\x20server','getMonth','name','axios','logs/','remoteAddress','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','new-disabled','exit','title','Idling\x20bot\x20\x20\x20|\x20Bot\x20','2FA\x20login\x20required','bbvReceive','telegrammsg','tkn','Temporary\x20access\x20rejected','\x1b[36m','showConfig','family','versions','uuid','getFullYear','349911NKmghx','get','ipc','/:bot/performance','5\x20min','0.0.0','decrypt','2749959bFrhSZ','/help\x20-\x20show\x20available\x20commands\x0a','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20update\x20bot','initclient','http','#RES#\x20if\x20running\x20locally\x0a','staging','static','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','version.json','backup','address'];_0x1d6d=function(){return _0x189fc4;};return _0x1d6d();}const parseColor=(_0x181041,_0x23727d)=>{const _0x4de3c0=_0x42acb5,_0x3bd204=/#[A-Z]{3}#/g;if(typeof _0x181041==_0x4de3c0(0x39e)){!_0x23727d?_0x181041=_0x181041['replace'](_0x3bd204,''):(_0x181041=_0x181041['replace'](/#BLU#/g,_0x4de3c0(0x265)),_0x181041=_0x181041[_0x4de3c0(0x2ed)](/#RED#/g,'\x1b[31m'),_0x181041=_0x181041['replace'](/#YEL#/g,_0x4de3c0(0x303)),_0x181041=_0x181041[_0x4de3c0(0x2ed)](/#MAG#/g,_0x4de3c0(0x22e)),_0x181041=_0x181041['replace'](/#CYA#/g,_0x4de3c0(0x32f)),_0x181041=_0x181041[_0x4de3c0(0x2ed)](/#RES#/g,_0x4de3c0(0x2c4)));;}return _0x181041;},logger={'screen':_0x5f5067=>{const _0x222ec7=_0x42acb5;console[_0x222ec7(0x270)](parseColor(_0x5f5067,!![]));},'simple':_0x19d357=>{const _0x152126=_0x42acb5;console[_0x152126(0x270)](parseColor(_0x19d357,!![])),loggerfile[_0x152126(0x305)](util[_0x152126(0x2ee)](parseColor(_0x19d357,![]))+'\x0a');},'full':async _0x12a0ac=>{const _0xefece=_0x42acb5,_0x358c9a=getTimeStamp()+_0xefece(0x298)+_0x12a0ac;console[_0xefece(0x270)](parseColor(_0x358c9a,!![])),loggerfile[_0xefece(0x305)](util['format'](parseColor(_0x358c9a,![]))+'\x0a');if(tgBot&&settings[_0xefece(0x37f)]&&settings[_0xefece(0x35a)]!=_0xefece(0x293))await tgBot[_0xefece(0x1e3)](settings[_0xefece(0x37f)],_0xefece(0x2b1)+parseColor(_0x12a0ac,![]))[_0xefece(0x283)](_0x383cfb=>{telegramError(_0x383cfb);});},'debug':async(_0x33061b,_0x355862='')=>{const _0x7479f3=_0x42acb5,_0x36a0ac=getTimeStamp()+_0x7479f3(0x21b)+_0x33061b;if(debugging)console[_0x7479f3(0x270)](parseColor(_0x36a0ac,!![]));loggerfile[_0x7479f3(0x305)](util['format'](parseColor(_0x36a0ac,![]))+'\x0a');if(_0x355862){if(debugging)console['log'](_0x355862);loggerfile[_0x7479f3(0x305)](util[_0x7479f3(0x2ee)](_0x355862)+'\x0a');}}};process['on'](_0x42acb5(0x3b7),function(_0x117658){const _0x4677b4=_0x42acb5;logger[_0x4677b4(0x31b)](_0x117658);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x42acb5(0x346))[_0x42acb5(0x37a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x42acb5(0x1e1)),app=express(),http=require(_0x42acb5(0x341))[_0x42acb5(0x2be)](app);app[_0x42acb5(0x39a)](fileUpload({'useTempFiles':!![]})),app[_0x42acb5(0x336)](_0x42acb5(0x378),async(_0x132958,_0xd350c2)=>{const _0x4ef7c9=_0x42acb5,_0x221cb1=_0x132958[_0x4ef7c9(0x25d)]['type'],_0x20c43b=getClientsWithBotID(_0x4ef7c9(0x2a8)),_0x6e3650=_0x132958[_0x4ef7c9(0x24a)][_0x4ef7c9(0x333)],_0x2402db=timelyDecrypt(_0x6e3650,![]),_0x464233=_0x20c43b[_0x4ef7c9(0x39c)](_0x440a56=>_0x440a56[_0x4ef7c9(0x333)]==_0x2402db);if(_0x464233){const _0x3b5932=normalizeIP(_0x132958[_0x4ef7c9(0x36d)][_0x4ef7c9(0x324)])[_0x4ef7c9(0x2f7)],_0xc7323c=_0x132958['headers'][_0x4ef7c9(0x32d)];if(validateAccess(_0xc7323c,_0x2402db,_0x3b5932)[_0x4ef7c9(0x1fe)])_0x221cb1==_0x4ef7c9(0x347)&&await backupConfigFiles(),await zipFiles(_0x221cb1),_0xd350c2[_0x4ef7c9(0x353)](zippath+(_0x221cb1+_0x4ef7c9(0x218)),_0x5d4382=>{const _0x41479b=_0x4ef7c9;_0x5d4382&&(logger[_0x41479b(0x2f8)](_0x41479b(0x2a2)+_0x221cb1),logger[_0x41479b(0x31b)](_0x5d4382));});else logger[_0x4ef7c9(0x2f8)](_0x4ef7c9(0x368)+_0x221cb1+'\x20(1)');}else logger[_0x4ef7c9(0x2f8)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x221cb1+'\x20(2)');}),app[_0x42acb5(0x299)](_0x42acb5(0x2c8),async(_0x5caab0,_0x567eb2)=>{const _0x3b5e0c=_0x42acb5,_0x4bc35d=getClientsWithBotID('botmanager'),_0x24cb98=_0x5caab0['headers'][_0x3b5e0c(0x333)],_0xd0f50e=timelyDecrypt(_0x24cb98,![]),_0x586adb=_0x4bc35d[_0x3b5e0c(0x39c)](_0x5177bd=>_0x5177bd[_0x3b5e0c(0x333)]==_0xd0f50e);logger['debug'](_0x3b5e0c(0x201));if(_0x586adb){const _0x87e29b=normalizeIP(_0x5caab0[_0x3b5e0c(0x36d)][_0x3b5e0c(0x324)])[_0x3b5e0c(0x2f7)],_0x3750d4=_0x5caab0[_0x3b5e0c(0x24a)]['tkn'];if(validateAccess(_0x3750d4,_0xd0f50e,_0x87e29b)[_0x3b5e0c(0x1fe)]){if(_0x5caab0[_0x3b5e0c(0x1f3)]){const _0x5f574a=_0x5caab0[_0x3b5e0c(0x1f3)][_0x3b5e0c(0x2cc)];await _0x5f574a['mv'](temppath+_0x5f574a[_0x3b5e0c(0x321)]),_0x567eb2[_0x3b5e0c(0x39b)]({'status':!![],'message':_0x3b5e0c(0x20f)});const _0x3be9e0=getBotsWithMode();_0x3be9e0[_0x3b5e0c(0x386)]>0x0?confirmRestore(temppath,_0x5f574a[_0x3b5e0c(0x321)]):unzipFile(temppath,_0x5f574a[_0x3b5e0c(0x321)]);}}else logger[_0x3b5e0c(0x2f8)](_0x3b5e0c(0x210));}else logger[_0x3b5e0c(0x2f8)](_0x3b5e0c(0x227));}),app['use'](express[_0x42acb5(0x344)](path[_0x42acb5(0x202)](__dirname,bbpath2,_0x42acb5(0x287)))),app[_0x42acb5(0x39a)](express[_0x42acb5(0x344)](path[_0x42acb5(0x202)](__dirname,bbpath2,_0x42acb5(0x2de)))),app['get']('/',function(_0x41f085,_0x4c25f8){const _0x20fc01=_0x42acb5;_0x4c25f8[_0x20fc01(0x21d)](path[_0x20fc01(0x202)](__dirname,bbpath2,_0x20fc01(0x287),'index.html'));}),app[_0x42acb5(0x336)](_0x42acb5(0x1fb),function(_0x1327af,_0x3741cc){const _0x55530b=_0x42acb5;_0x3741cc[_0x55530b(0x21d)](path[_0x55530b(0x202)](__dirname,bbpath2,_0x55530b(0x2de),'index.html'));}),app[_0x42acb5(0x336)](_0x42acb5(0x2d7),(_0x13f5e7,_0x498348)=>{const _0x14f36a=_0x42acb5;_0x498348['sendFile'](path[_0x14f36a(0x202)](__dirname,bbpath2,_0x14f36a(0x2de),_0x14f36a(0x21c)));}),app[_0x42acb5(0x336)](_0x42acb5(0x338),(_0x281517,_0x2a9073)=>{const _0x15921e=_0x42acb5;_0x2a9073[_0x15921e(0x21d)](path['join'](__dirname,bbpath2,_0x15921e(0x2de),_0x15921e(0x21c)));}),app[_0x42acb5(0x336)](_0x42acb5(0x2f6),(_0x3a6aa2,_0x41a2d9)=>{const _0x2740b7=_0x42acb5;_0x41a2d9[_0x2740b7(0x21d)](path[_0x2740b7(0x202)](__dirname,bbpath2,_0x2740b7(0x2de),'index.html'));}),app['get']('/:bot/history',(_0x1be429,_0x3e08be)=>{const _0x18a450=_0x42acb5;_0x3e08be[_0x18a450(0x21d)](path['join'](__dirname,bbpath2,_0x18a450(0x2de),_0x18a450(0x21c)));}),app[_0x42acb5(0x336)](_0x42acb5(0x392),(_0x347011,_0x2cc600)=>{const _0x835f11=_0x42acb5;_0x2cc600[_0x835f11(0x21d)](path[_0x835f11(0x202)](__dirname,bbpath2,_0x835f11(0x2de),_0x835f11(0x21c)));}),app[_0x42acb5(0x336)]('/:bot/support',(_0x593bb0,_0x187be7)=>{const _0x3b94af=_0x42acb5;_0x187be7[_0x3b94af(0x21d)](path[_0x3b94af(0x202)](__dirname,bbpath2,'build',_0x3b94af(0x21c)));});if(HOST)http[_0x42acb5(0x248)](PORT,HOST);else http[_0x42acb5(0x248)](PORT);const io=require(_0x42acb5(0x30c))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4d4723=_0x42acb5;let _0x3ae3e9=_0x4d4723(0x381);const _0x386273=networkInterfaces(),_0x4fb3cf={};for(const _0x50d908 of Object['keys'](_0x386273)){for(const _0x3a77c6 of _0x386273[_0x50d908]){if((_0x3a77c6[_0x4d4723(0x331)]==_0x4d4723(0x276)||_0x3a77c6[_0x4d4723(0x331)]==0x4)&&!_0x3a77c6['internal']){const _0x223041=ipaddr[_0x4d4723(0x2df)](_0x3a77c6[_0x4d4723(0x348)])[_0x4d4723(0x222)]();_0x223041!=_0x4d4723(0x355)&&(!_0x4fb3cf[_0x50d908]&&(_0x4fb3cf[_0x50d908]=[]),_0x4fb3cf[_0x50d908]['push'](_0x3a77c6[_0x4d4723(0x348)]),_0x3ae3e9=_0x3a77c6['address']);}}}return{'serverip':_0x3ae3e9,'netinterfaces':_0x4fb3cf};}async function startServer(){const _0x372368=_0x42acb5,{serverip:_0x1af7f6,netinterfaces:_0x4296c7}=getServerIP();logger['simple'](''),logger[_0x372368(0x31b)](_0x372368(0x250)),await logger[_0x372368(0x2f8)](_0x372368(0x3b9)+serverversion+'#RES#\x20'+(environment==_0x372368(0x343)?_0x372368(0x2d6):'')+'\x0a'+(_0x372368(0x28e)+PORT+_0x372368(0x342))+(_0x372368(0x26b)+_0x1af7f6+':'+PORT+_0x372368(0x31f))),logger[_0x372368(0x31b)](_0x372368(0x250));if(config[_0x372368(0x386)]!=0x0)for(const _0x20de93 of config){if(_0x20de93[_0x372368(0x3c1)]==_0x372368(0x3a2)||_0x20de93[_0x372368(0x3c1)]==_0x372368(0x271))await logger[_0x372368(0x2f8)]('Starting\x20bot\x20|\x20Bot\x20'+_0x20de93[_0x372368(0x24c)]+_0x372368(0x2ba)+_0x20de93[_0x372368(0x3bd)]),startBot([_0x20de93['botID'],userID],{'cwd':bbpath},function(_0x48aefe){const _0x28f195=_0x372368;if(_0x48aefe)logger[_0x28f195(0x2f8)](_0x48aefe);});else(_0x20de93['status']==_0x372368(0x23c)||_0x20de93[_0x372368(0x3c1)]==_0x372368(0x326))&&await logger['full'](_0x372368(0x329)+_0x20de93[_0x372368(0x24c)]+_0x372368(0x2ba)+_0x20de93[_0x372368(0x3bd)]);}else!newBot&&logger[_0x372368(0x31b)](_0x372368(0x325));if(newBot)addBot();logger[_0x372368(0x31b)](_0x372368(0x250)),logger[_0x372368(0x31b)](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger['debug'](_0x372368(0x255),_0x4296c7);}function startSocket(){io['on']('connection',_0x1bb3da=>{const _0x391dd8=_0x314d;let _0x25303b,_0x43db51,_0x547f45,_0xb9a8d7,_0x72ad03;const _0x565cb0=_0x1bb3da[_0x391dd8(0x2ad)][_0x391dd8(0x24a)][_0x391dd8(0x310)];_0x43db51=_0x565cb0[_0x391dd8(0x284)](/bot[0-9]{3}/);if(_0x43db51)_0x547f45=_0x43db51[0x0][_0x391dd8(0x284)](/[0-9]{3}/);if(_0x547f45)_0x25303b=_0x547f45[0x0];else _0x25303b=_0x391dd8(0x2a8);const _0x279e31=_0x1bb3da['handshake'][_0x391dd8(0x1e6)][_0x391dd8(0x295)];if(!_0x279e31)_0x1bb3da[_0x391dd8(0x377)]('status',{'publicKey':secure[_0x391dd8(0x1f5)]});else{_0xb9a8d7=timelyDecrypt(_0x279e31,![]);if(!_0xb9a8d7)_0x1bb3da[_0x391dd8(0x377)](_0x391dd8(0x3c1),{'publicKey':secure[_0x391dd8(0x1f5)]});else{_0x72ad03=normalizeIP(_0x1bb3da[_0x391dd8(0x37c)][_0x391dd8(0x324)])[_0x391dd8(0x2f7)];if(!devices[_0xb9a8d7])devices[_0xb9a8d7]={'uuid':_0xb9a8d7,'access':{'token':null}};devices[_0xb9a8d7]['ip']=_0x72ad03;const _0x5bda3f=addClient(_0x1bb3da['id'],_0xb9a8d7,_0x25303b);setAccess(_0x5bda3f),emitMessages(),_0x1bb3da['on'](_0x391dd8(0x2a4),_0x5492ae=>{const _0x50aee8=_0x391dd8,_0x2de2ed=timelyDecrypt(_0x5492ae['password']);if(_0x2de2ed){_0x5492ae={'username':_0x5492ae['username'],'password':_0x2de2ed},devices[_0xb9a8d7][_0x50aee8(0x383)]=validateCredentials(_0x5492ae,_0xb9a8d7);if(devices[_0xb9a8d7][_0x50aee8(0x383)][_0x50aee8(0x1fe)]==![]&&devices[_0xb9a8d7][_0x50aee8(0x383)][_0x50aee8(0x1e4)]=='2FA\x20login\x20required')_0x1bb3da[_0x50aee8(0x377)](_0x50aee8(0x3c1),{'access':devices[_0xb9a8d7]['access']}),loginAccess2FA(_0xb9a8d7,_0x72ad03);else{if(devices[_0xb9a8d7][_0x50aee8(0x383)][_0x50aee8(0x1fe)]==![]&&devices[_0xb9a8d7][_0x50aee8(0x383)]['reason']=='invalid\x20credentials')_0x1bb3da[_0x50aee8(0x377)](_0x50aee8(0x3c1),{'access':devices[_0xb9a8d7][_0x50aee8(0x383)]});else devices[_0xb9a8d7][_0x50aee8(0x383)][_0x50aee8(0x1fe)]&&devices[_0xb9a8d7][_0x50aee8(0x383)][_0x50aee8(0x1e4)]==_0x50aee8(0x2c5)&&(getClientsWithUuid(_0xb9a8d7)[_0x50aee8(0x31a)](_0x120221=>{setAccess(_0x120221);}),logger[_0x50aee8(0x313)](_0x50aee8(0x301)+_0xb9a8d7[_0x50aee8(0x207)](-0x8)),setTokenRefresh(_0xb9a8d7),setSessionTimeout(_0x50aee8(0x2a4),_0xb9a8d7));}}else logger[_0x50aee8(0x2f8)](_0x50aee8(0x38c));}),_0x1bb3da['on'](_0x391dd8(0x380),()=>{resetPassword();}),_0x1bb3da['on']('disconnect',_0x26b98e=>{removeClient(_0x1bb3da['id']);}),_0x25303b==_0x391dd8(0x2a8)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4563de){const _0x776b56=_0x42acb5;if(_0x4563de!=_0x776b56(0x2a8)&&config[_0x776b56(0x27c)]!=''){if(pid[_0x4563de])pid[_0x4563de][_0x776b56(0x39b)]({'function':_0x776b56(0x340),'args':null});}_0x4563de!=_0x776b56(0x2a8)&&broadcastToBots(_0x776b56(0x398),JSON[_0x776b56(0x31d)](config));}function reloadBotManager(){const _0x57a10e=_0x42acb5;getClientsWithBotID(_0x57a10e(0x2a8))[_0x57a10e(0x31a)](_0xe4e4e8=>{const _0x3e5905=_0x57a10e;getSocket(_0xe4e4e8['id'])['emit'](_0x3e5905(0x3c1),{'access':{'allow':![],'reason':_0x3e5905(0x249),'token':null}});});}function getSocket(_0x41d94e){const _0xefacd6=_0x42acb5;return io[_0xefacd6(0x37b)]['sockets'][_0xefacd6(0x336)](_0x41d94e);}function setAccess(_0x1fc148){const _0x55b413=_0x42acb5,_0x87016e=getSocket(_0x1fc148['id']),_0x535cfd=_0x1fc148[_0x55b413(0x333)],_0x17e294=_0x1fc148[_0x55b413(0x374)];devices[_0x535cfd]['access']=validateAccess(devices[_0x535cfd][_0x55b413(0x383)][_0x55b413(0x25e)],_0x535cfd),logger[_0x55b413(0x313)](_0x55b413(0x366)+devices[_0x535cfd][_0x55b413(0x383)][_0x55b413(0x1e4)]+'\x20|\x20client:\x20...'+_0x1fc148['id']['slice'](-0x8)+_0x55b413(0x35c)+_0x535cfd[_0x55b413(0x207)](-0x8)),_0x87016e[_0x55b413(0x202)](_0x535cfd);if(devices[_0x535cfd]['access'][_0x55b413(0x1fe)]){_0x87016e[_0x55b413(0x202)](_0x17e294);if(_0x17e294==_0x55b413(0x2a8))initializeSocketBotManager(_0x87016e);else initializeSocketBot(_0x87016e);initClient(_0x17e294);}devices[_0x535cfd][_0x55b413(0x383)][_0x55b413(0x25e)]&&devices[_0x535cfd][_0x55b413(0x383)][_0x55b413(0x1e4)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x55b413(0x302),_0x535cfd),devices[_0x535cfd][_0x55b413(0x383)]['token']&&devices[_0x535cfd][_0x55b413(0x383)][_0x55b413(0x1e4)]==_0x55b413(0x3ae)&&setSessionTimeout('login',_0x535cfd),_0x87016e['emit'](_0x55b413(0x3c1),{'status':_0x1fc148['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x535cfd]['access'],'externalip':devices[_0x535cfd]['ip'],'publicKey':secure[_0x55b413(0x1f5)],'userid':settings[_0x55b413(0x367)],'validInstallation':validInstallation}),devices[_0x535cfd]['access'][_0x55b413(0x1fe)]==![]&&devices[_0x535cfd][_0x55b413(0x383)][_0x55b413(0x1e4)]==_0x55b413(0x3bf)&&temporaryAccess2FA(_0x535cfd,devices[_0x535cfd]['ip']);}function setSessionTimeout(_0x806146,_0x2bc715){const _0x535afc=_0x42acb5;let _0x4d833d;if(_0x806146=='login')_0x4d833d=loginExpiry*0x3c*0x3e8;else _0x4d833d=devices[_0x2bc715][_0x535afc(0x2e0)][_0x535afc(0x30e)]*0x3c*0x3e8-(new Date()[_0x535afc(0x3ba)]()-devices[_0x2bc715][_0x535afc(0x2e0)][_0x535afc(0x2b8)]);if(devices[_0x2bc715][_0x535afc(0x24e)])clearTimeout(devices[_0x2bc715][_0x535afc(0x24e)]);devices[_0x2bc715]['pidExpireLogin']=setTimeout(()=>{const _0xd10a07=_0x535afc;if(devices[_0x2bc715][_0xd10a07(0x2ce)])clearTimeout(devices[_0x2bc715][_0xd10a07(0x2ce)]);removeSocketListeners(_0x2bc715),addBlacklist(_0x2bc715),devices[_0x2bc715]['telegramIpApproval']=null,devices[_0x2bc715][_0xd10a07(0x25a)]=null,devices[_0x2bc715][_0xd10a07(0x383)][_0xd10a07(0x25e)]=null,logger[_0xd10a07(0x313)](_0xd10a07(0x38d)+_0x2bc715[_0xd10a07(0x207)](-0x8)),devices[_0x2bc715]['access']=validateAccess(devices[_0x2bc715][_0xd10a07(0x383)][_0xd10a07(0x25e)],_0x2bc715),!(devices[_0x2bc715][_0xd10a07(0x383)][_0xd10a07(0x1fe)]&&devices[_0x2bc715][_0xd10a07(0x383)][_0xd10a07(0x1e4)]==_0xd10a07(0x21f))&&(_0x806146==_0xd10a07(0x2a4)?io['to'](_0x2bc715)[_0xd10a07(0x377)](_0xd10a07(0x3c1),{'access':{'allow':![],'reason':_0xd10a07(0x1f2),'token':null}}):io['to'](_0x2bc715)[_0xd10a07(0x377)](_0xd10a07(0x3c1),{'access':{'allow':![],'reason':_0xd10a07(0x224),'token':null}})),devices[_0x2bc715][_0xd10a07(0x383)]['token']=null;},_0x4d833d);}function setTokenRefresh(_0x361ab5){const _0x3694d8=_0x42acb5;if(devices[_0x361ab5][_0x3694d8(0x2ce)])clearTimeout(devices[_0x361ab5][_0x3694d8(0x2ce)]);devices[_0x361ab5][_0x3694d8(0x2ce)]=setTimeout(()=>{const _0x226451=_0x3694d8;getClientsWithUuid(_0x361ab5)[_0x226451(0x386)]!=0x0?(devices[_0x361ab5][_0x226451(0x383)]=refreshToken(_0x361ab5),io['to'](_0x361ab5)[_0x226451(0x377)](_0x226451(0x3c1),{'status':_0x226451(0x354),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x361ab5]['access'],'externalip':devices[_0x361ab5]['ip'],'publicKey':secure[_0x226451(0x1f5)],'validInstallation':validInstallation}),setTokenRefresh(_0x361ab5)):clearTimeout(devices[_0x361ab5][_0x226451(0x2ce)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x9fcea9){const _0x3fa9f1=_0x42acb5,_0x2baf8a=getClient(_0x9fcea9['id'])[_0x3fa9f1(0x333)];_0x9fcea9[_0x3fa9f1(0x377)](_0x3fa9f1(0x398),config),_0x9fcea9['emit'](_0x3fa9f1(0x27b),cleanSettings()),_0x9fcea9['on'](_0x3fa9f1(0x3ab),_0x1d7843=>{const _0x507641=_0x3fa9f1;if(validateAccess(_0x1d7843,_0x2baf8a)[_0x507641(0x1fe)])addBot();else logger['full'](_0x507641(0x311));}),_0x9fcea9['on']('update-bot',(_0x3b9d4d,_0x2779b6)=>{const _0x28a572=_0x3fa9f1;if(validateAccess(_0x2779b6,_0x2baf8a)[_0x28a572(0x1fe)])toggleBot(_0x3b9d4d['botID'],_0x3b9d4d['status'],_0x3b9d4d[_0x28a572(0x1f0)]);else logger['full'](_0x28a572(0x33f));}),_0x9fcea9['on'](_0x3fa9f1(0x352),(_0x2ed4cb,_0x28deea)=>{const _0x62d7d7=_0x3fa9f1;if(validateAccess(_0x28deea,_0x2baf8a)['allow'])toggleBotMode(_0x2ed4cb);else logger[_0x62d7d7(0x2f8)](_0x62d7d7(0x33f));}),_0x9fcea9['on'](_0x3fa9f1(0x3ac),(_0x39fe82,_0x3833b2)=>{const _0x5d3a06=_0x3fa9f1;if(validateAccess(_0x3833b2,_0x2baf8a)[_0x5d3a06(0x1fe)])deleteBot(_0x39fe82);else logger[_0x5d3a06(0x2f8)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x9fcea9['on'](_0x3fa9f1(0x3c0),(_0x30823f,_0x3495fd)=>{const _0x378c51=_0x3fa9f1;if(validateAccess(_0x3495fd,_0x2baf8a)[_0x378c51(0x1fe)])storeSettings(_0x30823f,!![]);else logger['full'](_0x378c51(0x38a));}),_0x9fcea9['on']('update-bb',_0x238d9f=>{const _0x9488ef=_0x3fa9f1;if(validateAccess(_0x238d9f,_0x2baf8a)['allow'])updateBB(_0x9488ef(0x205));else logger[_0x9488ef(0x2f8)](_0x9488ef(0x257));}),_0x9fcea9['on'](_0x3fa9f1(0x387),_0x2abdec=>{const _0x2f8deb=_0x3fa9f1;if(validateAccess(_0x2abdec,_0x2baf8a)[_0x2f8deb(0x1fe)])updateBB(_0x2f8deb(0x2cd));else logger[_0x2f8deb(0x2f8)](_0x2f8deb(0x35f));}),_0x9fcea9['on'](_0x3fa9f1(0x2a6),_0x508e34=>{const _0x35e26c=_0x3fa9f1;if(validateAccess(_0x508e34,_0x2baf8a)[_0x35e26c(0x1fe)]){const _0x29eb78=getClient(_0x9fcea9['id']);if(_0x29eb78)getBackupFiles(_0x29eb78[_0x35e26c(0x333)]);else logger[_0x35e26c(0x2f8)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x35e26c(0x2f8)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x9fcea9['on'](_0x3fa9f1(0x1f6),(_0x3db022,_0x5cf163)=>{const _0x50228b=_0x3fa9f1;if(validateAccess(_0x5cf163,_0x2baf8a)[_0x50228b(0x1fe)])restoreBackupFile(_0x3db022);else logger['full'](_0x50228b(0x1f8));}),_0x9fcea9['on'](_0x3fa9f1(0x296),_0x4a1e77=>{const _0x280623=_0x3fa9f1;if(validateAccess(_0x4a1e77,_0x2baf8a)[_0x280623(0x1fe)])getMessages();else logger[_0x280623(0x2f8)](_0x280623(0x300));}),_0x9fcea9['on'](_0x3fa9f1(0x28f),(_0x26c664,_0x2c4ea6)=>{const _0x545dd5=_0x3fa9f1;if(validateAccess(_0x2c4ea6,_0x2baf8a)[_0x545dd5(0x1fe)])confirmMessage(_0x26c664);else logger['full'](_0x545dd5(0x394));}),_0x9fcea9['on']('logout',_0x262f4b=>{const _0x36d3e2=_0x3fa9f1;if(validateAccess(_0x262f4b,_0x2baf8a)[_0x36d3e2(0x1fe)]){if(devices[_0x2baf8a]['pidRefreshToken'])clearTimeout(devices[_0x2baf8a][_0x36d3e2(0x2ce)]);if(devices[_0x2baf8a][_0x36d3e2(0x24e)])clearTimeout(devices[_0x2baf8a][_0x36d3e2(0x24e)]);removeSocketListeners(getClient(_0x9fcea9['id'])['uuid']),addBlacklist(_0x2baf8a),devices[_0x2baf8a][_0x36d3e2(0x2e0)]=null,devices[_0x2baf8a][_0x36d3e2(0x25a)]=null,devices[_0x2baf8a][_0x36d3e2(0x383)][_0x36d3e2(0x25e)]=null,logger['debug'](_0x36d3e2(0x1fc)+_0x2baf8a[_0x36d3e2(0x207)](-0x8)),io['to'](getClient(_0x9fcea9['id'])[_0x36d3e2(0x333)])[_0x36d3e2(0x377)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x36d3e2(0x2f8)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x189013){const _0x5588c0=_0x42acb5,_0x1a4446=getClient(_0x189013['id'])['bot'],_0x4c4951=getClient(_0x189013['id'])[_0x5588c0(0x333)];_0x189013['on'](_0x5588c0(0x266),(_0xcdb863,_0x3f1b49)=>{const _0x24d327=_0x5588c0;if(validateAccess(_0x3f1b49,_0x4c4951)[_0x24d327(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x24d327(0x39b)]({'function':_0x24d327(0x3c2),'args':_0xcdb863});}else logger[_0x24d327(0x2f8)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x189013['on'](_0x5588c0(0x252),(_0x33be67,_0x578fca)=>{const _0x32f522=_0x5588c0;if(validateAccess(_0x578fca,_0x4c4951)[_0x32f522(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x32f522(0x39b)]({'function':'deleteHistoryAlerts','args':_0x33be67});}else logger[_0x32f522(0x2f8)](_0x32f522(0x20a));}),_0x189013['on'](_0x5588c0(0x382),(_0x48f134,_0x29fe04)=>{const _0xeb3075=_0x5588c0;if(validateAccess(_0x29fe04,_0x4c4951)[_0xeb3075(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446]['send']({'function':_0xeb3075(0x282),'args':_0x48f134});}else logger[_0xeb3075(0x2f8)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x189013['on']('store-configuration',(_0x2a782c,_0xfef59d)=>{const _0x26098f=_0x5588c0;if(validateAccess(_0xfef59d,_0x4c4951)['allow']){if(pid[_0x1a4446])pid[_0x1a4446][_0x26098f(0x39b)]({'function':'storeConfiguration','args':_0x2a782c});}else logger['full'](_0x26098f(0x38f));}),_0x189013['on']('store-headless',(_0x465271,_0x24ec1d)=>{const _0x522adc=_0x5588c0;if(validateAccess(_0x24ec1d,_0x4c4951)[_0x522adc(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x522adc(0x39b)]({'function':_0x522adc(0x1eb),'args':_0x465271});}else logger[_0x522adc(0x2f8)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x189013['on'](_0x5588c0(0x281),(_0xe0f76d,_0x1096bf)=>{const _0x1b5819=_0x5588c0;if(validateAccess(_0x1096bf,_0x4c4951)[_0x1b5819(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x1b5819(0x39b)]({'function':_0x1b5819(0x24b),'args':_0xe0f76d});}else logger[_0x1b5819(0x2f8)](_0x1b5819(0x1e0));}),_0x189013['on']('reset-history',_0x272da4=>{const _0x2fa98e=_0x5588c0;if(validateAccess(_0x272da4,_0x4c4951)['allow']){if(pid[_0x1a4446])pid[_0x1a4446][_0x2fa98e(0x39b)]({'function':_0x2fa98e(0x235),'args':null});}else logger[_0x2fa98e(0x2f8)](_0x2fa98e(0x2fe));}),_0x189013['on']('get-starting-balances',_0x48b7ca=>{const _0x15f8af=_0x5588c0;if(validateAccess(_0x48b7ca,_0x4c4951)[_0x15f8af(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x15f8af(0x39b)]({'function':'getStartingBalances','args':null});}else logger['full'](_0x15f8af(0x319));}),_0x189013['on']('place-order',(_0x2b8ea3,_0x5a156e)=>{const _0x324901=_0x5588c0;if(validateAccess(_0x5a156e,_0x4c4951)[_0x324901(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446]['send']({'function':_0x324901(0x3b8),'args':_0x2b8ea3});}else logger[_0x324901(0x2f8)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x189013['on']('cancel-loading',_0x1d712b=>{const _0x4863ff=_0x5588c0;if(validateAccess(_0x1d712b,_0x4c4951)[_0x4863ff(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x4863ff(0x39b)]({'function':_0x4863ff(0x3a4),'args':null});}else logger['full'](_0x4863ff(0x3b1));}),_0x189013['on'](_0x5588c0(0x234),_0x254ea6=>{const _0x55e80e=_0x5588c0;if(validateAccess(_0x254ea6,_0x4c4951)[_0x55e80e(0x1fe)]){if(pid[_0x1a4446])pid[_0x1a4446][_0x55e80e(0x39b)]({'function':_0x55e80e(0x330),'args':null});}else logger['full'](_0x55e80e(0x3b5));}),_0x189013['on']('update-bb',_0x19335d=>{const _0x5db205=_0x5588c0;if(validateAccess(_0x19335d,_0x4c4951)['allow'])updateBB('update');else logger[_0x5db205(0x2f8)](_0x5db205(0x257));}),_0x189013['on'](_0x5588c0(0x296),_0x37c173=>{const _0x7c9682=_0x5588c0;if(validateAccess(_0x37c173,_0x4c4951)[_0x7c9682(0x1fe)])getMessages();else logger['full'](_0x7c9682(0x300));}),_0x189013['on'](_0x5588c0(0x28f),(_0x370866,_0x355643)=>{const _0x29c51a=_0x5588c0;if(validateAccess(_0x355643,_0x4c4951)[_0x29c51a(0x1fe)])confirmMessage(_0x370866);else logger['full'](_0x29c51a(0x394));}),_0x189013['on'](_0x5588c0(0x389),_0x3b9846=>{const _0x1820f6=_0x5588c0;if(validateAccess(_0x3b9846,_0x4c4951)[_0x1820f6(0x1fe)]){if(devices[_0x4c4951][_0x1820f6(0x2ce)])clearTimeout(devices[_0x4c4951][_0x1820f6(0x2ce)]);if(devices[_0x4c4951][_0x1820f6(0x24e)])clearTimeout(devices[_0x4c4951]['pidExpireLogin']);removeSocketListeners(getClient(_0x189013['id'])[_0x1820f6(0x333)]),addBlacklist(_0x4c4951),devices[_0x4c4951][_0x1820f6(0x2e0)]=null,devices[_0x4c4951][_0x1820f6(0x25a)]=null,devices[_0x4c4951][_0x1820f6(0x383)]['token']=null,logger[_0x1820f6(0x313)](_0x1820f6(0x1fc)+_0x4c4951[_0x1820f6(0x207)](-0x8)),io['to'](getClient(_0x189013['id'])[_0x1820f6(0x333)])['emit'](_0x1820f6(0x3c1),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x1820f6(0x376));});}function removeSocketListeners(_0x183bca){const _0xf866b3=_0x42acb5;getClientsWithUuid(_0x183bca)[_0xf866b3(0x31a)](_0x2a90e4=>{const _0x17862f=_0xf866b3;getSocket(_0x2a90e4['id'])[_0x17862f(0x314)]();});}function cleanSettings(){const _0x200372=_0x42acb5;let _0x18556d=settings;return settings[_0x200372(0x384)]&&settings[_0x200372(0x384)]!=''&&(_0x18556d={..._0x18556d,'telegramToken':_0x200372(0x2da)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x18556d={..._0x18556d,'bbPassword':_0x200372(0x2da)}),(settings['bbPassword']&&settings[_0x200372(0x395)]==_0x200372(0x24f)||settings[_0x200372(0x384)]&&settings['telegramToken']==_0x200372(0x24f))&&(_0x18556d={..._0x18556d,'restored':{'password':settings['bbPassword']==_0x200372(0x24f),'telegram':settings['telegramToken']==_0x200372(0x24f)}}),_0x18556d;}async function updateBB(_0x18f8c0){const _0x1fe5d2=_0x42acb5;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x499cad=>{const _0x5c6d42=_0x314d;restartBot(_0x499cad[_0x5c6d42(0x24c)]);});if(_0x18f8c0==_0x1fe5d2(0x205))process[_0x1fe5d2(0x39b)]({'update':!![],'environment':environment},_0x16f12d=>{});else _0x18f8c0==_0x1fe5d2(0x2cd)&&process[_0x1fe5d2(0x39b)]({'reinstall':!![],'environment':environment},_0x1a002c=>{});}function startBot(_0x364dcf,_0x4cd9c3,_0x1cfe81){const _0x59c00b=_0x42acb5;if(debugging)_0x364dcf['push']('-d');let _0x1d80ee=![];const _0x16c4b3=_0x364dcf[0x0];_0x4cd9c3={..._0x4cd9c3,'stdio':['inherit',_0x59c00b(0x259),_0x59c00b(0x259),_0x59c00b(0x337)]},pid[_0x16c4b3]=childProcess['fork'](botfile,_0x364dcf,_0x4cd9c3),pid[_0x16c4b3]['on'](_0x59c00b(0x278),_0x9e7e90=>{const _0x397cbd=_0x59c00b;switch(Object[_0x397cbd(0x3b4)](_0x9e7e90)[0x0]){case _0x397cbd(0x3bd):updateBotName(_0x16c4b3,_0x9e7e90[_0x397cbd(0x3bd)]);break;case _0x397cbd(0x3a1):updateBotManager();break;case _0x397cbd(0x3c1):updateStatus(_0x16c4b3,_0x9e7e90[_0x397cbd(0x3c1)]);break;case _0x397cbd(0x1f0):updateLive(_0x16c4b3,_0x9e7e90[_0x397cbd(0x1f0)]);break;case _0x397cbd(0x1e2):updateLive(_0x16c4b3,_0x9e7e90[_0x397cbd(0x1e2)]),io['to'](_0x16c4b3)[_0x397cbd(0x377)](_0x397cbd(0x3c1),{'access':{'allow':![],'reason':_0x397cbd(0x249),'token':null}});break;case _0x397cbd(0x2b0):_0x9e7e90['stop']==_0x397cbd(0x2c3)&&restartBot(_0x16c4b3);_0x9e7e90[_0x397cbd(0x2b0)]==_0x397cbd(0x358)&&toggleBot(_0x16c4b3,'disabled',_0x397cbd(0x1ee));break;case _0x397cbd(0x253):sendTelegram(_0x16c4b3,_0x9e7e90[_0x397cbd(0x253)]);break;case _0x397cbd(0x32c):sendTelegramMsg(_0x9e7e90['telegrammsg']);break;case _0x397cbd(0x273):io['to'](_0x16c4b3)[_0x397cbd(0x377)](_0x9e7e90[_0x397cbd(0x273)],_0x9e7e90['args']);break;}}),pid[_0x16c4b3]['on']('error',function(_0x832800){if(_0x1d80ee)return;_0x1d80ee=!![],_0x1cfe81(_0x832800);}),pid[_0x16c4b3]['on'](_0x59c00b(0x327),async function(_0x2c855e){const _0x5aa471=_0x59c00b;if(installingUpdate)return;if(_0x1d80ee)return;_0x1d80ee=!![],_0x1cfe81(null);const _0xdcf6c4=dbConfig[_0x5aa471(0x336)](_0x5aa471(0x398))[_0x5aa471(0x39c)]({'botID':_0x16c4b3})[_0x5aa471(0x3af)]();_0xdcf6c4&&(_0xdcf6c4[_0x5aa471(0x3c1)]==_0x5aa471(0x3a2)||_0xdcf6c4[_0x5aa471(0x3c1)]==_0x5aa471(0x271))&&(await sleep(0x3e8),updateLive(_0x16c4b3,_0x5aa471(0x1ee)),logger[_0x5aa471(0x2f8)](_0x5aa471(0x297)+_0x16c4b3),startBot([_0x16c4b3,userID],{'cwd':bbpath},function(_0x5215cc){if(_0x5215cc)logger['full'](_0x5215cc);}));});}function stopBot(_0x4ebae2){const _0xdfa282=_0x42acb5;getClientsWithBotID(_0x4ebae2)[_0xdfa282(0x31a)](_0x808893=>{const _0x4249d9=_0xdfa282;getSocket(_0x808893['id'])[_0x4249d9(0x243)](!![]),removeClient(_0x808893['id']);}),pid[_0x4ebae2]&&(pid[_0x4ebae2][_0xdfa282(0x358)](),pid[_0x4ebae2]=null);}function restartBot(_0x51c35b){const _0x87c611=_0x42acb5;if(pid[_0x51c35b])pid[_0x51c35b][_0x87c611(0x358)]();}function addBot(){const _0x265cd5=_0x42acb5;let _0x12d681;for(let _0x2914fc=0x1;_0x2914fc<0x3e9;_0x2914fc++){_0x12d681=_0x2914fc[_0x265cd5(0x3aa)]()[_0x265cd5(0x22d)](0x3,'0');let _0x5def81=config[_0x265cd5(0x39c)](_0x57b1a9=>_0x57b1a9['botID']==_0x12d681);if(!_0x5def81)break;}if(_0x12d681===_0x265cd5(0x2dd)){logger[_0x265cd5(0x2f8)](_0x265cd5(0x3b3));return;}logger[_0x265cd5(0x2f8)](_0x265cd5(0x2a7)+_0x12d681),dbConfig[_0x265cd5(0x336)](_0x265cd5(0x398))[_0x265cd5(0x2f0)]({'botID':_0x12d681,'botname':_0x265cd5(0x2ac)+_0x12d681,'status':'new','live':''})[_0x265cd5(0x305)](),startBot([_0x12d681,userID],{'cwd':bbpath},function(_0x33c2fc){if(_0x33c2fc)logger['full'](_0x33c2fc);}),config=getConfiguration(),io['to'](_0x265cd5(0x2a8))[_0x265cd5(0x377)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x4c8642){const _0x338fda=_0x42acb5;getClientsWithBotID(_0x4c8642)[_0x338fda(0x31a)](_0x5e7033=>{const _0x51dbb6=_0x338fda;getSocket(_0x5e7033['id'])[_0x51dbb6(0x243)](!![]),removeClient(_0x5e7033['id']);}),dbConfig[_0x338fda(0x336)]('bots')[_0x338fda(0x316)]({'botID':_0x4c8642})[_0x338fda(0x305)](),logger[_0x338fda(0x2f8)]('Deleted\x20Bot\x20'+_0x4c8642),stopBot(_0x4c8642);try{if(fs['existsSync'](path[_0x338fda(0x202)](configpath,_0x338fda(0x23b)+_0x4c8642+_0x338fda(0x3a8))))fs[_0x338fda(0x29c)](path[_0x338fda(0x202)](configpath,_0x338fda(0x23b)+_0x4c8642+_0x338fda(0x3a8)));if(fs[_0x338fda(0x254)](path['join'](configpath,_0x338fda(0x23b)+_0x4c8642+_0x338fda(0x1ed))))fs[_0x338fda(0x29c)](path[_0x338fda(0x202)](configpath,_0x338fda(0x23b)+_0x4c8642+_0x338fda(0x1ed)));if(fs[_0x338fda(0x254)](path[_0x338fda(0x202)](configpath,_0x338fda(0x23b)+_0x4c8642+_0x338fda(0x36c))))fs[_0x338fda(0x29c)](path[_0x338fda(0x202)](configpath,'bot-'+_0x4c8642+_0x338fda(0x36c)));if(fs[_0x338fda(0x254)](path[_0x338fda(0x202)](configpath,_0x338fda(0x23b)+_0x4c8642+'-results.json')))fs[_0x338fda(0x29c)](path[_0x338fda(0x202)](configpath,_0x338fda(0x23b)+_0x4c8642+'-results.json'));}catch(_0x2a5eb1){if(_0x2a5eb1)logger[_0x338fda(0x2f8)](_0x338fda(0x2fd),_0x2a5eb1);}config=getConfiguration(),io['to']('botmanager')[_0x338fda(0x377)](_0x338fda(0x398),config),broadcastToBots(_0x338fda(0x398),JSON[_0x338fda(0x31d)](config));}function toggleBot(_0x2a31d9,_0x3931a6,_0x28065b){const _0x462f78=_0x42acb5;dbConfig[_0x462f78(0x336)](_0x462f78(0x398))[_0x462f78(0x39c)]({'botID':_0x2a31d9})['assign']({'status':_0x3931a6})['assign']({'live':_0x28065b})[_0x462f78(0x305)]();if(_0x3931a6==_0x462f78(0x3a2)||_0x3931a6==_0x462f78(0x271))logger[_0x462f78(0x2f8)]('Enabled\x20Bot\x20'+_0x2a31d9),startBot([_0x2a31d9,userID],{'cwd':bbpath},function(_0x7dc47a){const _0x397a59=_0x462f78;if(_0x7dc47a)logger[_0x397a59(0x2f8)](_0x7dc47a);});else(_0x3931a6==_0x462f78(0x23c)||_0x3931a6=='new-disabled')&&(logger[_0x462f78(0x2f8)](_0x462f78(0x3bb)+_0x2a31d9),stopBot(_0x2a31d9));config=getConfiguration(),io['to'](_0x462f78(0x2a8))['emit'](_0x462f78(0x398),config),broadcastToBots(_0x462f78(0x398),JSON[_0x462f78(0x31d)](config));}function toggleStatus(_0x518a99){const _0x3a0f11=_0x42acb5;let _0x58fbe3=dbConfig['get'](_0x3a0f11(0x398))[_0x3a0f11(0x39c)]({'botID':_0x518a99})[_0x3a0f11(0x3af)](),_0x93d633;if(_0x58fbe3['status']==='enabled')_0x93d633='disabled';else{if(_0x58fbe3['status']==='new')_0x93d633=_0x3a0f11(0x326);else{if(_0x58fbe3['status']===_0x3a0f11(0x326))_0x93d633=_0x3a0f11(0x271);else{if(_0x58fbe3[_0x3a0f11(0x3c1)]==='disabled')_0x93d633=_0x3a0f11(0x3a2);}}}return _0x93d633;}function updateStatus(_0x4b13b7,_0x2093f9){const _0x22494f=_0x42acb5;dbConfig[_0x22494f(0x336)]('bots')[_0x22494f(0x39c)]({'botID':_0x4b13b7})[_0x22494f(0x2bc)]({'status':_0x2093f9})[_0x22494f(0x305)](),config=getConfiguration(),io['to'](_0x22494f(0x2a8))[_0x22494f(0x377)](_0x22494f(0x398),config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x48b74d,_0x10b5c8){const _0x1ed0e4=_0x42acb5;dbConfig[_0x1ed0e4(0x336)](_0x1ed0e4(0x398))[_0x1ed0e4(0x39c)]({'botID':_0x48b74d})[_0x1ed0e4(0x2bc)]({'live':_0x10b5c8})['write'](),config=getConfiguration(),io['to'](_0x1ed0e4(0x2a8))[_0x1ed0e4(0x377)](_0x1ed0e4(0x398),config),broadcastToBots(_0x1ed0e4(0x398),JSON['stringify'](config));}function updateBotName(_0x3f3a9f,_0x392f46){const _0x390fc1=_0x42acb5;dbConfig[_0x390fc1(0x336)](_0x390fc1(0x398))[_0x390fc1(0x39c)]({'botID':_0x3f3a9f})['assign']({'botname':_0x392f46})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x390fc1(0x377)](_0x390fc1(0x398),config),broadcastToBots(_0x390fc1(0x398),JSON['stringify'](config));}function updateBotManager(){const _0x333e4f=_0x42acb5;config=getConfiguration(),io['to'](_0x333e4f(0x2a8))['emit'](_0x333e4f(0x398),config),broadcastToBots(_0x333e4f(0x398),JSON[_0x333e4f(0x31d)](config));}function toggleBotMode(_0x51f18e){const _0x57e28b=_0x42acb5;if(pid[_0x51f18e])pid[_0x51f18e][_0x57e28b(0x39b)]({'function':_0x57e28b(0x2b3),'args':null});else{const _0x19818b=configpath+_0x57e28b(0x23b)+_0x51f18e+_0x57e28b(0x3a8),_0x42d111=fs['readFileSync'](_0x19818b),_0x30750e=JSON[_0x57e28b(0x2df)](_0x42d111),_0x514e3e=_0x30750e['bot'][0x0][_0x57e28b(0x34f)];_0x30750e[_0x57e28b(0x374)][0x0][_0x57e28b(0x34f)]=!_0x514e3e;const _0x30bf23=JSON[_0x57e28b(0x31d)](_0x30750e,null,0x2);fs['writeFileSync'](_0x19818b,_0x30bf23),config=getConfiguration(),io['to']('botmanager')[_0x57e28b(0x377)]('bots',config),broadcastToBots(_0x57e28b(0x398),JSON[_0x57e28b(0x31d)](config));}}function telegramError(_0x39dc3a){const _0x1d362b=_0x42acb5;logger[_0x1d362b(0x31b)](getTimeStamp()+_0x1d362b(0x312));}function validateTelegram(_0x94534c){const _0x57136b=_0x42acb5;if(_0x94534c[_0x57136b(0x237)]['username']!=settings[_0x57136b(0x2d5)]&&'@'+_0x94534c['from'][_0x57136b(0x2fb)]!=settings[_0x57136b(0x2d5)])return tgBot['sendMessage'](_0x94534c[_0x57136b(0x306)]['id'],_0x57136b(0x2f5),{'parse_mode':'HTML'})[_0x57136b(0x283)](_0x567aad=>{telegramError(_0x567aad);}),![];return!![];}async function initTelegram(){const _0x5f2f8e=_0x42acb5;if(tgBot)tgBot[_0x5f2f8e(0x38e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x5f2f8e(0x384)],{'polling':!![]});let _0x55b3f0=_0x5f2f8e(0x213);_0x55b3f0+='\x0a',_0x55b3f0+='/enable\x20-\x20enable\x20notifications\x0a',_0x55b3f0+=_0x5f2f8e(0x286),_0x55b3f0+=_0x5f2f8e(0x2ea),_0x55b3f0+=_0x5f2f8e(0x2fc),_0x55b3f0+='/on\x20-\x20start\x20bot(s)\x0a',_0x55b3f0+=_0x5f2f8e(0x241),_0x55b3f0+=_0x5f2f8e(0x2d0),_0x55b3f0+=_0x5f2f8e(0x3a3),_0x55b3f0+=_0x5f2f8e(0x27d),_0x55b3f0+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x55b3f0+=_0x5f2f8e(0x2a5),_0x55b3f0+=_0x5f2f8e(0x369),_0x55b3f0+=_0x5f2f8e(0x36a),_0x55b3f0+=_0x5f2f8e(0x33d);let _0x54e9bb='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x54e9bb+='\x0a',_0x54e9bb+=_0x55b3f0,tgBot[_0x5f2f8e(0x2a0)](/\/start/,_0x1e5c2d=>{const _0x509782=_0x5f2f8e;if(!validateTelegram(_0x1e5c2d))return;if(settings['telegramChatId']!=_0x1e5c2d[_0x509782(0x306)]['id'])updateSetting(_0x509782(0x37f),_0x1e5c2d[_0x509782(0x306)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x509782(0x1e3)](_0x1e5c2d[_0x509782(0x306)]['id'],_0x54e9bb)[_0x509782(0x283)](_0x1f9506=>{telegramError(_0x1f9506);});}),tgBot[_0x5f2f8e(0x2a0)](/\/enable/,_0x52354b=>{const _0x2fe143=_0x5f2f8e;if(!validateTelegram(_0x52354b))return;if(settings[_0x2fe143(0x37f)]!=_0x52354b[_0x2fe143(0x306)]['id'])updateSetting(_0x2fe143(0x37f),_0x52354b[_0x2fe143(0x306)]['id']);updateSetting(_0x2fe143(0x375),!![]),tgBot[_0x2fe143(0x1e3)](_0x52354b[_0x2fe143(0x306)]['id'],'Notifications\x20enabled')[_0x2fe143(0x283)](_0x5ae9c3=>{telegramError(_0x5ae9c3);});}),tgBot['onText'](/\/config/,async _0x5b7bed=>{const _0x47835f=_0x5f2f8e;if(!validateTelegram(_0x5b7bed))return;tgBot[_0x47835f(0x36f)](_0x47835f(0x360)),tgBot['sendMessage'](_0x5b7bed[_0x47835f(0x306)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x47835f(0x317),'callback_data':_0x47835f(0x293)},{'text':_0x47835f(0x2e8),'callback_data':_0x47835f(0x289)},{'text':_0x47835f(0x1ff),'callback_data':'all'}]]}})[_0x47835f(0x283)](_0x2c6c5b=>{telegramError(_0x2c6c5b);}),tgBot['on'](_0x47835f(0x360),async _0x1f716d=>{const _0x3a8efe=_0x47835f,_0x55f885=_0x1f716d[_0x3a8efe(0x3ad)],_0x27c3b5=_0x1f716d[_0x3a8efe(0x278)];tgBot['answerCallbackQuery'](_0x1f716d['id'])['then'](async()=>{const _0x4be7c9=_0x3a8efe;_0x55f885==_0x4be7c9(0x293)&&(updateSetting('telegramEvents',_0x4be7c9(0x293)),updateSetting('telegramEnabled',!![]),await tgBot[_0x4be7c9(0x1e3)](_0x27c3b5[_0x4be7c9(0x306)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x4be7c9(0x283)](_0x459fbe=>{telegramError(_0x459fbe);}));_0x55f885==_0x4be7c9(0x289)&&(updateSetting(_0x4be7c9(0x35a),_0x4be7c9(0x289)),updateSetting(_0x4be7c9(0x375),!![]),await tgBot[_0x4be7c9(0x1e3)](_0x27c3b5[_0x4be7c9(0x306)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x4be7c9(0x283)](_0x45b060=>{telegramError(_0x45b060);}));_0x55f885==_0x4be7c9(0x393)&&(updateSetting('telegramEvents',_0x4be7c9(0x393)),updateSetting(_0x4be7c9(0x375),!![]),await tgBot[_0x4be7c9(0x1e3)](_0x27c3b5[_0x4be7c9(0x306)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x4be7c9(0x283)](_0x4b5d14=>{telegramError(_0x4b5d14);}));if(!settings[_0x4be7c9(0x37f)])tgBot['sendMessage'](_0x27c3b5[_0x4be7c9(0x306)]['id'],_0x4be7c9(0x2bf))[_0x4be7c9(0x283)](_0x29e433=>{telegramError(_0x29e433);});}),tgBot['removeListener'](_0x3a8efe(0x360));});}),tgBot[_0x5f2f8e(0x2a0)](/\/status/,_0x3ca0fe=>{const _0x1162fa=_0x5f2f8e;if(!validateTelegram(_0x3ca0fe))return;const _0x4b7a96=getBotsWithMode();let _0x2126ae='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x1162fa(0x31a)](_0x17a2be=>{const _0x5708a5=_0x1162fa,_0x5006db=_0x4b7a96[_0x5708a5(0x39c)](_0x2d3500=>_0x2d3500[_0x5708a5(0x24c)]==_0x17a2be['botID'])[_0x5708a5(0x2e4)];_0x2126ae+=_0x5708a5(0x2ac)+_0x17a2be[_0x5708a5(0x24c)]+':\x20'+_0x17a2be[_0x5708a5(0x3c1)]+_0x5708a5(0x2ba)+_0x5006db+_0x5708a5(0x2ba)+_0x17a2be[_0x5708a5(0x1f0)]+'\x0a';}),_0x2126ae+='\x0a',_0x2126ae+=_0x1162fa(0x29b),_0x2126ae+=!settings['telegramEnabled']?_0x1162fa(0x216):_0x1162fa(0x245),_0x2126ae+=settings['telegramEnabled']?settings['telegramEvents']=='all'?_0x1162fa(0x1f9):_0x1162fa(0x285)+settings[_0x1162fa(0x35a)]+_0x1162fa(0x27a):'',tgBot[_0x1162fa(0x1e3)](_0x3ca0fe[_0x1162fa(0x306)]['id'],_0x2126ae,{'parse_mode':'HTML'})[_0x1162fa(0x283)](_0x39014f=>{telegramError(_0x39014f);});}),tgBot[_0x5f2f8e(0x2a0)](/\/restart/,_0x3ffe61=>{const _0x965f1a=_0x5f2f8e;if(!validateTelegram(_0x3ffe61))return;tgBot[_0x965f1a(0x36f)](_0x965f1a(0x360));const _0x580e66=getEnabledBots();if(_0x580e66[_0x965f1a(0x386)]==0x0)tgBot[_0x965f1a(0x1e3)](_0x3ffe61[_0x965f1a(0x306)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x965f1a(0x283)](_0x58c72f=>{telegramError(_0x58c72f);});else{if(_0x580e66[_0x965f1a(0x386)]>0x1)_0x580e66['push']({'botID':_0x965f1a(0x393)});let _0x21e321=[],_0x5576cb=[];const _0x1da828=_0x580e66[_0x965f1a(0x386)]%0x4==0x0||_0x580e66[_0x965f1a(0x386)]%0x4==0x3||_0x580e66[_0x965f1a(0x386)]%0x3==0x1?0x4:0x3;let _0x172366=0x0;_0x580e66['forEach']((_0x18cedd,_0x2a1de2)=>{const _0x10820f=_0x965f1a;if(_0x2a1de2%_0x1da828==0x0)_0x5576cb=[];_0x5576cb[_0x10820f(0x2f0)]({'text':_0x18cedd[_0x10820f(0x24c)]=='all'?'All\x20bots':'Bot\x20'+_0x18cedd[_0x10820f(0x24c)],'callback_data':_0x18cedd[_0x10820f(0x24c)]}),_0x2a1de2%_0x1da828==0x0&&(_0x21e321[_0x172366]=_0x5576cb,_0x172366++);}),tgBot['sendMessage'](_0x3ffe61[_0x965f1a(0x306)]['id'],_0x965f1a(0x35d),{'reply_markup':{'inline_keyboard':_0x21e321}})[_0x965f1a(0x283)](_0xeb1ed1=>{telegramError(_0xeb1ed1);}),tgBot['on'](_0x965f1a(0x360),async _0x7dacca=>{const _0x1db9fe=_0x965f1a,_0x1b3dbc=_0x7dacca[_0x1db9fe(0x3ad)],_0xfa08bd=_0x7dacca['message'];tgBot[_0x1db9fe(0x232)](_0x7dacca['id'])[_0x1db9fe(0x223)](async()=>{const _0x2c76f5=_0x1db9fe;_0x1b3dbc==_0x2c76f5(0x393)?config['forEach'](_0x318851=>{restartBot(_0x318851['botID']);}):restartBot(_0x1b3dbc);}),tgBot[_0x1db9fe(0x36f)](_0x1db9fe(0x360));});}}),tgBot[_0x5f2f8e(0x2a0)](/\/on/,_0x2a6f21=>{const _0x68b8fd=_0x5f2f8e;if(!validateTelegram(_0x2a6f21))return;tgBot[_0x68b8fd(0x36f)](_0x68b8fd(0x360));const _0x3ed94a=getDisabledBots();if(_0x3ed94a[_0x68b8fd(0x386)]==0x0)tgBot[_0x68b8fd(0x1e3)](_0x2a6f21['chat']['id'],_0x68b8fd(0x34b))[_0x68b8fd(0x283)](_0x43e658=>{telegramError(_0x43e658);});else{if(_0x3ed94a['length']>0x1)_0x3ed94a[_0x68b8fd(0x2f0)]({'botID':_0x68b8fd(0x393)});let _0x40cccf=[],_0x40f97f=[];const _0x3b1c95=_0x3ed94a[_0x68b8fd(0x386)]%0x4==0x0||_0x3ed94a[_0x68b8fd(0x386)]%0x4==0x3||_0x3ed94a[_0x68b8fd(0x386)]%0x3==0x1?0x4:0x3;let _0x54cfc3=0x0;_0x3ed94a[_0x68b8fd(0x31a)]((_0x1eff40,_0x1215da)=>{const _0x3b3db7=_0x68b8fd;if(_0x1215da%_0x3b1c95==0x0)_0x40f97f=[];_0x40f97f['push']({'text':_0x1eff40['botID']==_0x3b3db7(0x393)?_0x3b3db7(0x37d):_0x3b3db7(0x2ac)+_0x1eff40['botID'],'callback_data':_0x1eff40[_0x3b3db7(0x24c)]}),_0x1215da%_0x3b1c95==0x0&&(_0x40cccf[_0x54cfc3]=_0x40f97f,_0x54cfc3++);}),tgBot[_0x68b8fd(0x1e3)](_0x2a6f21[_0x68b8fd(0x306)]['id'],_0x68b8fd(0x20b),{'reply_markup':{'inline_keyboard':_0x40cccf}})[_0x68b8fd(0x283)](_0x52a82d=>{telegramError(_0x52a82d);}),tgBot['on']('callback_query',async _0x339909=>{const _0x3c0f1a=_0x68b8fd,_0x1d91aa=_0x339909[_0x3c0f1a(0x3ad)],_0x288b54=_0x339909[_0x3c0f1a(0x278)];tgBot[_0x3c0f1a(0x232)](_0x339909['id'])[_0x3c0f1a(0x223)](async()=>{const _0xd8cee4=_0x3c0f1a;_0x1d91aa==_0xd8cee4(0x393)?(tgBot[_0xd8cee4(0x1e3)](_0x288b54[_0xd8cee4(0x306)]['id'],_0xd8cee4(0x391))[_0xd8cee4(0x283)](_0x2cc91a=>{telegramError(_0x2cc91a);}),_0x3ed94a['forEach'](_0x33bf13=>{const _0x462b9a=_0xd8cee4;if(_0x33bf13[_0x462b9a(0x24c)]!='all')toggleBot(_0x33bf13[_0x462b9a(0x24c)],toggleStatus(_0x33bf13['botID']),_0x462b9a(0x1ee));})):(tgBot[_0xd8cee4(0x1e3)](_0x288b54['chat']['id'],_0xd8cee4(0x24d)+_0x1d91aa)[_0xd8cee4(0x283)](_0x2b8d84=>{telegramError(_0x2b8d84);}),toggleBot(_0x1d91aa,toggleStatus(_0x1d91aa),_0xd8cee4(0x1ee)));}),tgBot[_0x3c0f1a(0x36f)](_0x3c0f1a(0x360));});}}),tgBot[_0x5f2f8e(0x2a0)](/\/off/,_0x4270f0=>{const _0x8bf024=_0x5f2f8e;if(!validateTelegram(_0x4270f0))return;tgBot['removeListener']('callback_query');const _0x1cabb5=getEnabledBots();if(_0x1cabb5[_0x8bf024(0x386)]==0x0)tgBot[_0x8bf024(0x1e3)](_0x4270f0[_0x8bf024(0x306)]['id'],_0x8bf024(0x2a9))[_0x8bf024(0x283)](_0x2fbc47=>{telegramError(_0x2fbc47);});else{if(_0x1cabb5[_0x8bf024(0x386)]>0x1)_0x1cabb5[_0x8bf024(0x2f0)]({'botID':_0x8bf024(0x393)});let _0x274949=[],_0x24add6=[];const _0x45befa=_0x1cabb5[_0x8bf024(0x386)]%0x4==0x0||_0x1cabb5[_0x8bf024(0x386)]%0x4==0x3||_0x1cabb5['length']%0x3==0x1?0x4:0x3;let _0x4b2724=0x0;_0x1cabb5[_0x8bf024(0x31a)]((_0x243934,_0x3f98dc)=>{const _0x589081=_0x8bf024;if(_0x3f98dc%_0x45befa==0x0)_0x24add6=[];_0x24add6[_0x589081(0x2f0)]({'text':_0x243934[_0x589081(0x24c)]==_0x589081(0x393)?_0x589081(0x37d):_0x589081(0x2ac)+_0x243934['botID'],'callback_data':_0x243934['botID']}),_0x3f98dc%_0x45befa==0x0&&(_0x274949[_0x4b2724]=_0x24add6,_0x4b2724++);}),tgBot['sendMessage'](_0x4270f0[_0x8bf024(0x306)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x274949}})[_0x8bf024(0x283)](_0x11c5b3=>{telegramError(_0x11c5b3);}),tgBot['on'](_0x8bf024(0x360),async _0x2843dc=>{const _0x56471b=_0x8bf024,_0x32ca6b=_0x2843dc[_0x56471b(0x3ad)],_0x3b78c4=_0x2843dc[_0x56471b(0x278)];tgBot[_0x56471b(0x232)](_0x2843dc['id'])[_0x56471b(0x223)](async()=>{const _0x2a6ea9=_0x56471b;_0x32ca6b=='all'?(tgBot[_0x2a6ea9(0x1e3)](_0x3b78c4[_0x2a6ea9(0x306)]['id'],_0x2a6ea9(0x33e))[_0x2a6ea9(0x283)](_0xb1f9f2=>{telegramError(_0xb1f9f2);}),_0x1cabb5['forEach'](_0xadc853=>{const _0x2a8662=_0x2a6ea9;if(_0xadc853[_0x2a8662(0x24c)]!='all')toggleBot(_0xadc853[_0x2a8662(0x24c)],toggleStatus(_0xadc853[_0x2a8662(0x24c)]),_0x2a8662(0x1ee));})):(tgBot[_0x2a6ea9(0x1e3)](_0x3b78c4[_0x2a6ea9(0x306)]['id'],_0x2a6ea9(0x230)+_0x32ca6b)[_0x2a6ea9(0x283)](_0x712d7f=>{telegramError(_0x712d7f);}),toggleBot(_0x32ca6b,toggleStatus(_0x32ca6b),_0x2a6ea9(0x1ee)));}),tgBot[_0x56471b(0x36f)]('callback_query');});}}),tgBot[_0x5f2f8e(0x2a0)](/\/metrics/,_0x292d33=>{const _0x23f33c=_0x5f2f8e;if(!validateTelegram(_0x292d33))return;tgBot['removeListener'](_0x23f33c(0x360));const _0x17f6dc=getEnabledBots();if(_0x17f6dc[_0x23f33c(0x386)]==0x0)tgBot[_0x23f33c(0x1e3)](_0x292d33[_0x23f33c(0x306)]['id'],_0x23f33c(0x2a9))[_0x23f33c(0x283)](_0x31dd47=>{telegramError(_0x31dd47);});else{if(_0x17f6dc['length']>0x1){let _0x519d6a=[],_0x2bdb05=[];const _0x3520fb=_0x17f6dc['length']%0x4==0x0||_0x17f6dc['length']%0x4==0x3||_0x17f6dc[_0x23f33c(0x386)]%0x3==0x1?0x4:0x3;let _0xa2fd47=0x0;_0x17f6dc[_0x23f33c(0x31a)]((_0x3509bc,_0xd32e4a)=>{const _0x396d7a=_0x23f33c;if(_0xd32e4a%_0x3520fb==0x0)_0x2bdb05=[];_0x2bdb05['push']({'text':_0x396d7a(0x2ac)+_0x3509bc[_0x396d7a(0x24c)],'callback_data':_0x3509bc[_0x396d7a(0x24c)]}),_0xd32e4a%_0x3520fb==0x0&&(_0x519d6a[_0xa2fd47]=_0x2bdb05,_0xa2fd47++);}),tgBot[_0x23f33c(0x1e3)](_0x292d33['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x519d6a}})[_0x23f33c(0x283)](_0x1c6b0f=>{telegramError(_0x1c6b0f);}),tgBot['on'](_0x23f33c(0x360),async _0x2596df=>{const _0x845a8d=_0x23f33c,_0x170ac2=_0x2596df[_0x845a8d(0x3ad)],_0x15425d=_0x2596df[_0x845a8d(0x278)];tgBot[_0x845a8d(0x232)](_0x2596df['id'])[_0x845a8d(0x223)](async()=>{const _0x1ed851=_0x845a8d;if(pid[_0x170ac2])pid[_0x170ac2][_0x1ed851(0x39b)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x845a8d(0x36f)](_0x845a8d(0x360));});}else{const _0x4ed05f=_0x17f6dc[0x0][_0x23f33c(0x24c)];if(pid[_0x4ed05f])pid[_0x4ed05f]['send']({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x5f2f8e(0x2a0)](/\/portfolio/,_0x49e0bd=>{const _0x1ff196=_0x5f2f8e;if(!validateTelegram(_0x49e0bd))return;tgBot['removeListener'](_0x1ff196(0x360));const _0x336d0c=getEnabledBots();if(_0x336d0c[_0x1ff196(0x386)]==0x0)tgBot['sendMessage'](_0x49e0bd[_0x1ff196(0x306)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x1ff196(0x283)](_0x3a5988=>{telegramError(_0x3a5988);});else{if(_0x336d0c[_0x1ff196(0x386)]>0x1){let _0x4a4afd=[],_0x289071=[];const _0x37e3c7=_0x336d0c[_0x1ff196(0x386)]%0x4==0x0||_0x336d0c[_0x1ff196(0x386)]%0x4==0x3||_0x336d0c[_0x1ff196(0x386)]%0x3==0x1?0x4:0x3;let _0x237188=0x0;_0x336d0c[_0x1ff196(0x31a)]((_0x351526,_0x259649)=>{const _0x3633e8=_0x1ff196;if(_0x259649%_0x37e3c7==0x0)_0x289071=[];_0x289071[_0x3633e8(0x2f0)]({'text':_0x3633e8(0x2ac)+_0x351526['botID'],'callback_data':_0x351526[_0x3633e8(0x24c)]}),_0x259649%_0x37e3c7==0x0&&(_0x4a4afd[_0x237188]=_0x289071,_0x237188++);}),tgBot[_0x1ff196(0x1e3)](_0x49e0bd['chat']['id'],_0x1ff196(0x2c1),{'reply_markup':{'inline_keyboard':_0x4a4afd}})[_0x1ff196(0x283)](_0xb2fdd3=>{telegramError(_0xb2fdd3);}),tgBot['on'](_0x1ff196(0x360),async _0x389547=>{const _0x1a78d2=_0x1ff196,_0x59f029=_0x389547['data'],_0x96a861=_0x389547[_0x1a78d2(0x278)];tgBot['answerCallbackQuery'](_0x389547['id'])['then'](async()=>{const _0x520e0a=_0x1a78d2;if(pid[_0x59f029])pid[_0x59f029][_0x520e0a(0x39b)]({'function':_0x520e0a(0x261),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0xf3908c=_0x336d0c[0x0][_0x1ff196(0x24c)];if(pid[_0xf3908c])pid[_0xf3908c][_0x1ff196(0x39b)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x5f2f8e(0x2a0)](/\/update/,async _0x8cb62b=>{const _0x218dab=_0x5f2f8e;if(!validateTelegram(_0x8cb62b))return;tgBot['removeListener'](_0x218dab(0x360)),await getMessages();if(!updateAvailable)tgBot[_0x218dab(0x1e3)](_0x8cb62b[_0x218dab(0x306)]['id'],_0x218dab(0x3be))[_0x218dab(0x283)](_0x20d2da=>{telegramError(_0x20d2da);});else!validInstallation?tgBot[_0x218dab(0x1e3)](_0x8cb62b['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x218dab(0x283)](_0x3ab07f=>{telegramError(_0x3ab07f);}):(tgBot[_0x218dab(0x1e3)](_0x8cb62b[_0x218dab(0x306)]['id'],_0x218dab(0x20e),{'reply_markup':{'inline_keyboard':[[{'text':_0x218dab(0x239),'callback_data':_0x218dab(0x209)},{'text':'No','callback_data':'no'}]]}})[_0x218dab(0x283)](_0x4b8f98=>{telegramError(_0x4b8f98);}),tgBot['on'](_0x218dab(0x360),async _0x1201e0=>{const _0x525a0f=_0x218dab,_0x83184f=_0x1201e0['data'],_0x314f4d=_0x1201e0[_0x525a0f(0x278)];tgBot[_0x525a0f(0x232)](_0x1201e0['id'])[_0x525a0f(0x223)](async()=>{const _0x20a456=_0x525a0f;_0x83184f==_0x20a456(0x209)&&(await tgBot['sendMessage'](_0x314f4d[_0x20a456(0x306)]['id'],_0x20a456(0x233))[_0x20a456(0x283)](_0x381e2e=>{telegramError(_0x381e2e);}),updateBB(_0x20a456(0x205))),_0x83184f=='no'&&await tgBot[_0x20a456(0x1e3)](_0x314f4d[_0x20a456(0x306)]['id'],_0x20a456(0x345))[_0x20a456(0x283)](_0x53454f=>{telegramError(_0x53454f);});}),tgBot[_0x525a0f(0x36f)](_0x525a0f(0x360));}));}),tgBot['onText'](/\/reinstall/,async _0x372297=>{const _0x472ede=_0x5f2f8e;if(!validateTelegram(_0x372297))return;tgBot[_0x472ede(0x36f)](_0x472ede(0x360)),!validInstallation?tgBot[_0x472ede(0x1e3)](_0x372297[_0x472ede(0x306)]['id'],_0x472ede(0x1e5))[_0x472ede(0x283)](_0x3929a7=>{telegramError(_0x3929a7);}):(tgBot[_0x472ede(0x1e3)](_0x372297[_0x472ede(0x306)]['id'],_0x472ede(0x1df),{'reply_markup':{'inline_keyboard':[[{'text':_0x472ede(0x239),'callback_data':_0x472ede(0x209)},{'text':'No','callback_data':'no'}]]}})[_0x472ede(0x283)](_0xfdf5d=>{telegramError(_0xfdf5d);}),tgBot['on'](_0x472ede(0x360),async _0x16c365=>{const _0xe0925c=_0x472ede,_0x36c917=_0x16c365[_0xe0925c(0x3ad)],_0x255e27=_0x16c365['message'];tgBot[_0xe0925c(0x232)](_0x16c365['id'])[_0xe0925c(0x223)](async()=>{const _0x75a9f6=_0xe0925c;_0x36c917==_0x75a9f6(0x209)&&(await tgBot[_0x75a9f6(0x1e3)](_0x255e27[_0x75a9f6(0x306)]['id'],_0x75a9f6(0x379))[_0x75a9f6(0x283)](_0x5add81=>{telegramError(_0x5add81);}),updateBB(_0x75a9f6(0x2cd))),_0x36c917=='no'&&await tgBot[_0x75a9f6(0x1e3)](_0x255e27[_0x75a9f6(0x306)]['id'],_0x75a9f6(0x2b2))[_0x75a9f6(0x283)](_0x52df8f=>{telegramError(_0x52df8f);});}),tgBot[_0xe0925c(0x36f)]('callback_query');}));}),tgBot[_0x5f2f8e(0x2a0)](/\/toggle/,_0x17f4bd=>{const _0x9c697c=_0x5f2f8e;if(!validateTelegram(_0x17f4bd))return;tgBot[_0x9c697c(0x36f)](_0x9c697c(0x360));const _0x52b83b=getBotsWithMode();if(_0x52b83b[_0x9c697c(0x386)]==0x0)tgBot[_0x9c697c(0x1e3)](_0x17f4bd[_0x9c697c(0x306)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x9c697c(0x283)](_0xe75e04=>{telegramError(_0xe75e04);});else{let _0x2b73cd=[],_0x132867=[];const _0x3b8723=0x2;let _0x279fda=0x0;_0x52b83b[_0x9c697c(0x31a)]((_0x69eaf8,_0x43c8f5)=>{const _0x230a57=_0x9c697c;if(_0x43c8f5%_0x3b8723==0x0)_0x132867=[];_0x132867[_0x230a57(0x2f0)]({'text':'Bot\x20'+_0x69eaf8[_0x230a57(0x24c)]+'\x20('+_0x69eaf8[_0x230a57(0x2e4)]+')','callback_data':_0x69eaf8['botID']}),_0x43c8f5%_0x3b8723==0x0&&(_0x2b73cd[_0x279fda]=_0x132867,_0x279fda++);}),tgBot[_0x9c697c(0x1e3)](_0x17f4bd['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x2b73cd}})[_0x9c697c(0x283)](_0x6c91a3=>{telegramError(_0x6c91a3);}),tgBot['on'](_0x9c697c(0x360),async _0x3945cb=>{const _0x210535=_0x9c697c,_0x3f01c5=_0x3945cb[_0x210535(0x3ad)],_0x608e5b=_0x3945cb[_0x210535(0x278)];tgBot['answerCallbackQuery'](_0x3945cb['id'])[_0x210535(0x223)](async()=>{const _0x400d1c=_0x210535,_0x810d10=_0x52b83b[_0x400d1c(0x39c)](_0x4525bc=>_0x4525bc[_0x400d1c(0x24c)]==_0x3f01c5),_0x4620e1=_0x810d10[_0x400d1c(0x2e4)]==_0x400d1c(0x1fa)?_0x400d1c(0x291):'auto';tgBot[_0x400d1c(0x1e3)](_0x608e5b[_0x400d1c(0x306)]['id'],_0x400d1c(0x2a1)+_0x3f01c5+_0x400d1c(0x275)+_0x4620e1+_0x400d1c(0x26f))[_0x400d1c(0x283)](_0x28e428=>{telegramError(_0x28e428);}),toggleBotMode(_0x3f01c5);}),tgBot[_0x210535(0x36f)](_0x210535(0x360));});}}),tgBot[_0x5f2f8e(0x2a0)](/\/names/,_0x1dd2e1=>{const _0x23a784=_0x5f2f8e;if(!validateTelegram(_0x1dd2e1))return;let _0x385472='';config['forEach'](_0x35c697=>{const _0x133be7=_0x314d;_0x385472+='Bot\x20'+_0x35c697[_0x133be7(0x24c)]+':\x20'+_0x35c697[_0x133be7(0x3bd)]+'\x0a';}),tgBot[_0x23a784(0x1e3)](_0x1dd2e1['chat']['id'],_0x385472,{'parse_mode':_0x23a784(0x204)})[_0x23a784(0x283)](_0x206dac=>{telegramError(_0x206dac);});}),tgBot[_0x5f2f8e(0x2a0)](/\/disable/,_0x27d3e8=>{const _0x39eae7=_0x5f2f8e;if(!validateTelegram(_0x27d3e8))return;tgBot[_0x39eae7(0x1e3)](_0x27d3e8[_0x39eae7(0x306)]['id'],_0x39eae7(0x247))[_0x39eae7(0x283)](_0x4d6467=>{telegramError(_0x4d6467);}),updateSetting(_0x39eae7(0x375),![]);}),tgBot[_0x5f2f8e(0x2a0)](/\/help/,_0x17d917=>{const _0x18f862=_0x5f2f8e;if(!validateTelegram(_0x17d917))return;tgBot['sendMessage'](_0x17d917[_0x18f862(0x306)]['id'],_0x55b3f0)[_0x18f862(0x283)](_0x1667ad=>{telegramError(_0x1667ad);});}),tgBot['on']('polling_error',_0x1ebbda=>{const _0x4b0ad6=_0x5f2f8e;_0x1ebbda['toString']()[_0x4b0ad6(0x36e)](_0x4b0ad6(0x2f1))&&(logger[_0x4b0ad6(0x2f8)](_0x4b0ad6(0x304)),tgBot[_0x4b0ad6(0x38e)](),tgBot=null,io['to']('botmanager')[_0x4b0ad6(0x377)]('notification',_0x4b0ad6(0x304)));}),process['once'](_0x5f2f8e(0x2cb),()=>{const _0x43c824=_0x5f2f8e;if(tgBot)tgBot['stopPolling']();process[_0x43c824(0x327)](0x1);}),process[_0x5f2f8e(0x292)](_0x5f2f8e(0x371),()=>{const _0x2c633a=_0x5f2f8e;if(tgBot)tgBot[_0x2c633a(0x38e)]();process[_0x2c633a(0x327)](0x1);});}}function disableTelegram(){const _0x227a12=_0x42acb5;tgBot&&(tgBot[_0x227a12(0x38e)](),tgBot=null);}function sendTelegram(_0x36584a,_0x258a5e){const _0x331a65=_0x42acb5;if(settings[_0x331a65(0x375)]){if(settings[_0x331a65(0x35a)]==_0x331a65(0x393)||(_0x258a5e[_0x331a65(0x2fa)]==_0x331a65(0x2c9)||_0x258a5e[_0x331a65(0x2fa)]==_0x331a65(0x372)||_0x258a5e[_0x331a65(0x2fa)]==_0x331a65(0x2e1))&&settings[_0x331a65(0x35a)]==_0x331a65(0x289)||_0x258a5e[_0x331a65(0x2fa)]==_0x331a65(0x373)&&settings['telegramEvents']==_0x331a65(0x293)){if(tgBot&&settings[_0x331a65(0x37f)]){if(_0x258a5e['showname'])tgBot[_0x331a65(0x1e3)](settings[_0x331a65(0x37f)],_0x258a5e[_0x331a65(0x3bd)]+_0x331a65(0x3b6)+_0x258a5e[_0x331a65(0x397)])[_0x331a65(0x283)](_0x44ad04=>{telegramError(_0x44ad04);});else tgBot[_0x331a65(0x1e3)](settings['telegramChatId'],_0x331a65(0x2ac)+_0x36584a+_0x331a65(0x3b6)+_0x258a5e[_0x331a65(0x397)])['catch'](_0x321f33=>{telegramError(_0x321f33);});}}}}async function sendTelegramMsg(_0x1df94b,_0x218bb5=_0x42acb5(0x204)){const _0x1b0c17=_0x42acb5;return settings[_0x1b0c17(0x375)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x1b0c17(0x1e3)](settings[_0x1b0c17(0x37f)],_0x1df94b,{'parse_mode':_0x218bb5})[_0x1b0c17(0x283)](_0x1b3347=>{telegramError(_0x1b3347);}),!![]):![];}function getDeviceWithIp(_0x130521){const _0x34987c=_0x42acb5;return devices[_0x34987c(0x39c)](_0x58c5d2=>_0x58c5d2['ip']===_0x130521);}function _0x314d(_0x18bab4,_0x1a8cab){const _0x365d4d=_0x1d6d();return _0x314d=function(_0x37600a,_0x5306b7){_0x37600a=_0x37600a-0x1df;let _0x1d6d06=_0x365d4d[_0x37600a];return _0x1d6d06;},_0x314d(_0x18bab4,_0x1a8cab);}function temporaryAccess2FA(_0x2d8529,_0x128fea){const _0x58b43e=_0x42acb5;let _0x290362=new Date(),_0x5e5eef=![];if(lastIpApproval){if(_0x290362-lastIpApproval<0x1388)_0x5e5eef=!![];}lastIpApproval=new Date();if(_0x5e5eef)return;tgBot&&settings[_0x58b43e(0x37f)]&&(tgBot[_0x58b43e(0x36f)]('callback_query'),tgBot[_0x58b43e(0x1e3)](settings[_0x58b43e(0x37f)],_0x58b43e(0x203)+normalizeIP(_0x128fea)['show']+_0x58b43e(0x2b6),{'parse_mode':_0x58b43e(0x204),'reply_markup':{'inline_keyboard':[[{'text':_0x58b43e(0x339),'callback_data':'5'},{'text':_0x58b43e(0x36b),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':_0x58b43e(0x277)}]]}})[_0x58b43e(0x283)](_0x8c93fc=>{telegramError(_0x8c93fc);}),tgBot['on'](_0x58b43e(0x360),async _0x379b3d=>{const _0x7e33fe=_0x58b43e,_0x3412c5=_0x379b3d['data'],_0x563e53=_0x379b3d[_0x7e33fe(0x278)];tgBot[_0x7e33fe(0x232)](_0x379b3d['id'])[_0x7e33fe(0x223)](async()=>{const _0x4dbbca=_0x7e33fe;devices[_0x2d8529][_0x4dbbca(0x2e0)]={'clientip':_0x128fea,'timestamp':new Date()[_0x4dbbca(0x3ba)](),'expiry':_0x3412c5},_0x3412c5!='reject'?(await tgBot['sendMessage'](_0x563e53[_0x4dbbca(0x306)]['id'],_0x4dbbca(0x1fd)+_0x3412c5+_0x4dbbca(0x3a0),{'parse_mode':_0x4dbbca(0x204)})[_0x4dbbca(0x283)](_0x29d831=>{telegramError(_0x29d831);}),io['to'](_0x2d8529)[_0x4dbbca(0x377)](_0x4dbbca(0x3c1),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x4dbbca(0x1e3)](_0x563e53[_0x4dbbca(0x306)]['id'],_0x4dbbca(0x32e))['catch'](_0x397251=>{telegramError(_0x397251);}),io['to'](_0x2d8529)['emit'](_0x4dbbca(0x3c1),{'access':{'allow':![],'reason':_0x4dbbca(0x2b9),'token':null}}));}),tgBot[_0x7e33fe(0x36f)]('callback_query');}));}function loginAccess2FA(_0x3a021a,_0x1d9ce4){const _0x1c766e=_0x42acb5;tgBot&&settings[_0x1c766e(0x37f)]&&(tgBot[_0x1c766e(0x36f)](_0x1c766e(0x360)),tgBot[_0x1c766e(0x1e3)](settings[_0x1c766e(0x37f)],_0x1c766e(0x27f)+normalizeIP(_0x1d9ce4)[_0x1c766e(0x240)]+_0x1c766e(0x2b6),{'parse_mode':_0x1c766e(0x204),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x1c766e(0x277),'callback_data':_0x1c766e(0x277)}]]}})[_0x1c766e(0x283)](_0x5c6980=>{telegramError(_0x5c6980);}),tgBot['on'](_0x1c766e(0x360),async _0x58a5d0=>{const _0x4c26be=_0x1c766e,_0x4d5d59=_0x58a5d0[_0x4c26be(0x3ad)],_0x364d00=_0x58a5d0[_0x4c26be(0x278)];tgBot[_0x4c26be(0x232)](_0x58a5d0['id'])[_0x4c26be(0x223)](async()=>{const _0x6aaaec=_0x4c26be;devices[_0x3a021a]['telegram2FaApproval']={'clientip':_0x1d9ce4,'timestamp':new Date()[_0x6aaaec(0x3ba)](),'expiry':_0x4d5d59},_0x4d5d59!=_0x6aaaec(0x277)?(await tgBot[_0x6aaaec(0x1e3)](_0x364d00[_0x6aaaec(0x306)]['id'],_0x6aaaec(0x3a7),{'parse_mode':_0x6aaaec(0x204)})[_0x6aaaec(0x283)](_0x923e31=>{telegramError(_0x923e31);}),io['to'](_0x3a021a)[_0x6aaaec(0x377)](_0x6aaaec(0x3c1),{'access':{'allow':![],'reason':_0x6aaaec(0x249),'token':null}})):(await tgBot[_0x6aaaec(0x1e3)](_0x364d00[_0x6aaaec(0x306)]['id'],_0x6aaaec(0x28d))['catch'](_0x58c3c7=>{telegramError(_0x58c3c7);}),io['to'](_0x3a021a)[_0x6aaaec(0x377)](_0x6aaaec(0x3c1),{'access':{'allow':![],'reason':_0x6aaaec(0x1e8),'token':null}}));}),tgBot[_0x4c26be(0x36f)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x11d4c8=_0x42acb5;return dbConfig['get']('bots')[_0x11d4c8(0x23a)](_0x11d4c8(0x24c))[_0x11d4c8(0x23e)]({'status':_0x11d4c8(0x3a2)})[_0x11d4c8(0x3af)]()||[];}function getDisabledBots(){const _0x42fc58=_0x42acb5;return dbConfig['get'](_0x42fc58(0x398))[_0x42fc58(0x23a)](_0x42fc58(0x24c))['filter']({'status':_0x42fc58(0x23c)})[_0x42fc58(0x3af)]()||[];}function getBotAttributes(_0x58e5a3){const _0x1ccafc=_0x42acb5;let _0x469fc6={};const _0x71a6c9=configpath+_0x1ccafc(0x23b)+_0x58e5a3+'-config.json',_0xc5e2b2=fs[_0x1ccafc(0x254)](_0x71a6c9);if(_0xc5e2b2){const _0x30a374=fs['readFileSync'](_0x71a6c9);try{const _0x2f96db=JSON[_0x1ccafc(0x2df)](_0x30a374),_0x2081fb=_0x2f96db?_0x2f96db[_0x1ccafc(0x374)][0x0][_0x1ccafc(0x34f)]:![];_0x469fc6[_0x1ccafc(0x2e4)]=_0x2081fb?_0x1ccafc(0x1fa):_0x1ccafc(0x291),_0x469fc6[_0x1ccafc(0x3bd)]=_0x2f96db?_0x2f96db[_0x1ccafc(0x374)][0x0][_0x1ccafc(0x3bd)]:_0x1ccafc(0x2ac)+_0x58e5a3;}catch(_0x59673c){_0x469fc6[_0x1ccafc(0x2e4)]=_0x1ccafc(0x291),_0x469fc6[_0x1ccafc(0x3bd)]=_0x1ccafc(0x2ac)+_0x58e5a3;}}else _0x469fc6[_0x1ccafc(0x2e4)]=_0x1ccafc(0x291),_0x469fc6[_0x1ccafc(0x3bd)]=_0x1ccafc(0x2ac)+_0x58e5a3;return _0x469fc6;}function getBotsWithMode(){const _0x274419=_0x42acb5,_0x18d1ce=dbConfig[_0x274419(0x336)](_0x274419(0x398))[_0x274419(0x23a)](_0x274419(0x24c))[_0x274419(0x3af)]()||[];return _0x18d1ce['forEach'](_0x1a5036=>{const _0x45baf1=_0x274419;let _0x15bea1=getBotAttributes(_0x1a5036[_0x45baf1(0x24c)]);_0x1a5036[_0x45baf1(0x2e4)]=_0x15bea1[_0x45baf1(0x2e4)];}),_0x18d1ce;}function getBotExchanges(){const _0x4811da=_0x42acb5;let _0x48c4f5=[];const _0x4ca9c7=dbConfig[_0x4811da(0x336)](_0x4811da(0x398))[_0x4811da(0x23a)](_0x4811da(0x24c))['value']()||[];_0x4ca9c7['forEach'](_0x2692ba=>{const _0x49d037=_0x4811da;if(_0x2692ba[_0x49d037(0x3c1)]==_0x49d037(0x3a2)){const _0x2e9985=configpath+_0x49d037(0x23b)+_0x2692ba[_0x49d037(0x24c)]+_0x49d037(0x3a8),_0x1fe08b=fs[_0x49d037(0x254)](_0x2e9985);let _0x3a3c56;if(_0x1fe08b){const _0x395e94=fs[_0x49d037(0x2d2)](_0x2e9985);try{const _0xb6a0f1=JSON[_0x49d037(0x2df)](_0x395e94);_0x3a3c56=_0xb6a0f1?_0xb6a0f1[_0x49d037(0x374)][0x0]['exchange']:null;}catch(_0x35e2a3){}}if(_0x3a3c56)_0x48c4f5[_0x49d037(0x2f0)](_0x3a3c56);}});const _0x3cd6dc=[...new Set(_0x48c4f5)]['sort']();return _0x3cd6dc;}async function initUser(){const _0x1d0a40=_0x42acb5;if(!settings[_0x1d0a40(0x367)]){const _0x3d432d=uuidRandom();mixpanel[_0x1d0a40(0x2f9)](_0x3d432d),updateSetting(_0x1d0a40(0x367),_0x3d432d);}}async function initSecure(){const _0x3cb6b4=_0x42acb5;let _0x56e2b8=getSecure();if(!_0x56e2b8['hasOwnProperty'](_0x3cb6b4(0x37e))){let _0x4e2f9d=await generateKeys();_0x56e2b8[_0x3cb6b4(0x1f5)]=_0x4e2f9d['publicKey'],_0x56e2b8['privateKey']=_0x4e2f9d['privateKey'],_0x56e2b8[_0x3cb6b4(0x37e)]=crypto[_0x3cb6b4(0x20d)](0x20)['toString'](_0x3cb6b4(0x3a6));;storeSecure(_0x56e2b8);}}function getSettings(){const _0x5796b0=_0x42acb5;return dbSettings[_0x5796b0(0x336)](_0x5796b0(0x27b))[_0x5796b0(0x3af)]()||{};}function getSecure(){const _0xdedb24=_0x42acb5;return dbSecure['get']('secure')[_0xdedb24(0x3af)]()||{};}function getBlacklist(){const _0x62b8cf=_0x42acb5;return dbSecure[_0x62b8cf(0x336)]('blacklist')[_0x62b8cf(0x3af)]()||[];}function broadcastToBots(_0x100add,_0x50aea8){const _0x31252f=_0x42acb5;config[_0x31252f(0x31a)](_0xa471f2=>{const _0x3d387c=_0x31252f;if(_0xa471f2[_0x3d387c(0x3c1)]==_0x3d387c(0x3a2)&&_0xa471f2[_0x3d387c(0x1f0)]==_0x3d387c(0x22a)||_0xa471f2[_0x3d387c(0x3c1)]==_0x3d387c(0x271)&&_0xa471f2[_0x3d387c(0x1f0)]==_0x3d387c(0x22a)){if(pid[_0xa471f2['botID']])pid[_0xa471f2[_0x3d387c(0x24c)]]['send']({[_0x100add]:_0x50aea8});}});}function storeSettings(_0x574d25,_0x2f50a4=![]){const _0x924f32=_0x42acb5;_0x574d25={...settings,..._0x574d25};if(_0x2f50a4&&_0x574d25[_0x924f32(0x395)]!=_0x924f32(0x2da)&&_0x574d25['bbPassword']!=_0x924f32(0x24f)&&_0x574d25[_0x924f32(0x395)]!=''){const _0x3aa343=crypt[_0x924f32(0x33b)](secure[_0x924f32(0x2e2)],_0x574d25[_0x924f32(0x395)])['message'][_0x924f32(0x290)]('@')[0x0],_0x1017bd=bcrypt[_0x924f32(0x30b)](_0x3aa343,saltRounds);_0x574d25={..._0x574d25,'bbPassword':_0x1017bd};}if(_0x2f50a4&&_0x574d25[_0x924f32(0x384)]!=_0x924f32(0x2da)&&_0x574d25[_0x924f32(0x384)]!='***'&&_0x574d25['telegramToken']!=''){const _0x287be9=crypt[_0x924f32(0x33b)](secure[_0x924f32(0x2e2)],_0x574d25['telegramToken'])[_0x924f32(0x278)][_0x924f32(0x290)]('@')[0x0];_0x574d25={..._0x574d25,'telegramToken':_0x287be9};}const _0x4ed137=_0x574d25[_0x924f32(0x384)]!=_0x924f32(0x2da)&&_0x574d25['telegramToken']!=settings[_0x924f32(0x384)]||_0x574d25[_0x924f32(0x2d5)]!=settings['telegramUsername'],_0x39338b=_0x574d25[_0x924f32(0x384)]==''||_0x574d25[_0x924f32(0x2d5)]=='';if(_0x4ed137)_0x574d25['telegramEvents']=_0x924f32(0x393);for(const [_0x2e33ad,_0x126baa]of Object[_0x924f32(0x361)](_0x574d25)){if(_0x2e33ad=='telegramToken'&&_0x126baa==_0x924f32(0x2da)){_0x574d25[_0x924f32(0x384)]=settings[_0x924f32(0x384)];continue;};if(_0x2e33ad==_0x924f32(0x395)&&_0x126baa==_0x924f32(0x2da)){_0x574d25[_0x924f32(0x395)]=settings[_0x924f32(0x395)];continue;};dbSettings[_0x924f32(0x264)](_0x924f32(0x309)+_0x2e33ad,_0x126baa)[_0x924f32(0x305)]();}settings=_0x574d25,io['to'](_0x924f32(0x2a8))['emit'](_0x924f32(0x27b),cleanSettings()),broadcastToBots(_0x924f32(0x1f7),settings[_0x924f32(0x1f7)]),broadcastToBots(_0x924f32(0x294),settings[_0x924f32(0x294)]);if(_0x4ed137&&!_0x39338b)initTelegram();if(_0x4ed137&&_0x39338b)disableTelegram();getAllClients()['forEach'](_0x53978b=>{const _0x42c5c7=_0x924f32;getSocket(_0x53978b['id'])[_0x42c5c7(0x377)](_0x42c5c7(0x3c1),{'access':{'allow':![],'reason':_0x42c5c7(0x249),'token':null}});});}function updateSetting(_0x46c9fc,_0x3e7c20){const _0x1b0140=_0x42acb5;dbSettings[_0x1b0140(0x264)]('settings.'+_0x46c9fc,_0x3e7c20)[_0x1b0140(0x305)](),settings=getSettings(),io['to'](_0x1b0140(0x2a8))[_0x1b0140(0x377)](_0x1b0140(0x27b),cleanSettings());}function storeSecure(_0x24dd4c){const _0x39f368=_0x42acb5;dbSecure[_0x39f368(0x336)](_0x39f368(0x359))[_0x39f368(0x2f0)](_0x24dd4c)['write'](),secure=_0x24dd4c;}function addBlacklist(_0x26fc39){const _0x2fd457=_0x42acb5;cleanBlacklist();let _0x528105;devices[_0x26fc39]['telegramIpApproval']?_0x528105=Math[_0x2fd457(0x28c)](devices[_0x26fc39][_0x2fd457(0x2e0)][_0x2fd457(0x30e)],loginExpiry):_0x528105=loginExpiry,dbSecure[_0x2fd457(0x336)](_0x2fd457(0x31c))[_0x2fd457(0x2f0)]({'expiry':new Date()[_0x2fd457(0x3ba)]()+_0x528105*0x3c*0x3e8,'token':devices[_0x26fc39][_0x2fd457(0x383)][_0x2fd457(0x25e)]})[_0x2fd457(0x305)](),blacklist=dbSecure[_0x2fd457(0x336)]('blacklist')['value']();}function cleanBlacklist(){const _0x545e39=_0x42acb5;let _0x5cf093=dbSecure[_0x545e39(0x336)](_0x545e39(0x31c))[_0x545e39(0x229)]()['value'](),_0x30c250=new Date()[_0x545e39(0x3ba)]();_0x5cf093['forEach'](_0x40d1e2=>{const _0x423135=_0x545e39;_0x40d1e2[_0x423135(0x30e)]<_0x30c250&&dbSecure[_0x423135(0x336)](_0x423135(0x31c))['remove']({'expiry':_0x40d1e2['expiry']})[_0x423135(0x305)]();});}function initStates(){let _0x3992c1=getConfiguration();_0x3992c1['forEach'](_0x1569fb=>{const _0x567154=_0x314d;_0x1569fb['live']=_0x567154(0x1ee);}),storeConfiguration(_0x3992c1);}function onKeys(){const _0x1c1864=new RSA();return new Promise(_0x30b07f=>{const _0x112ce2=_0x314d;_0x1c1864[_0x112ce2(0x274)]()[_0x112ce2(0x223)](_0x433b9f=>{_0x30b07f(_0x433b9f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x527228=_0x42acb5;let _0x2c7f16=getSettings(),_0x37ba2e=![];!_0x2c7f16[_0x527228(0x2d9)](_0x527228(0x2aa))&&(_0x2c7f16[_0x527228(0x2aa)]=0x0,_0x37ba2e=!![]);!_0x2c7f16[_0x527228(0x2d9)]('lastmsgemitted')&&(_0x2c7f16[_0x527228(0x2c2)]=0x0,_0x37ba2e=!![]);!_0x2c7f16[_0x527228(0x2d9)](_0x527228(0x1ec))&&(_0x2c7f16[_0x527228(0x1ec)]=_0x527228(0x33a),_0x37ba2e=!![]);!_0x2c7f16['hasOwnProperty'](_0x527228(0x294))&&(_0x2c7f16[_0x527228(0x294)]=![],_0x37ba2e=!![]);if(_0x37ba2e)storeSettings(_0x2c7f16);try{fs[_0x527228(0x3b2)](configbackuppath,{'withFileTypes':!![]})[_0x527228(0x31a)](_0x3e0aea=>{const _0x4cb3b3=_0x527228;if(!_0x3e0aea[_0x4cb3b3(0x30f)]()){if(!_0x3e0aea[_0x4cb3b3(0x321)][_0x4cb3b3(0x2ec)](_0x4cb3b3(0x262)))fs[_0x4cb3b3(0x29c)](configbackuppath+_0x3e0aea[_0x4cb3b3(0x321)]);}else fs['rmSync'](configbackuppath+_0x3e0aea[_0x4cb3b3(0x321)],{'recursive':!![]});});}catch(_0x3cbbe7){logger[_0x527228(0x313)](_0x527228(0x3a9),_0x3cbbe7);}}function storeConfiguration(_0x360ba7){const _0xa2c05=_0x42acb5;dbConfig[_0xa2c05(0x336)](_0xa2c05(0x398))['remove']()[_0xa2c05(0x305)](),_0x360ba7['forEach'](_0x5bb188=>{const _0x539234=_0xa2c05;delete _0x5bb188[_0x539234(0x2e4)];}),dbConfig[_0xa2c05(0x336)]('bots')[_0xa2c05(0x2f0)](..._0x360ba7)[_0xa2c05(0x305)](),config=_0x360ba7;}function resetPassword(){const _0x4b212d=_0x42acb5;tgBot&&settings[_0x4b212d(0x37f)]&&(tgBot[_0x4b212d(0x36f)]('callback_query'),tgBot[_0x4b212d(0x1e3)](settings[_0x4b212d(0x37f)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4b212d(0x209),'callback_data':_0x4b212d(0x209)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2461e4=>{telegramError(_0x2461e4);}),tgBot['on']('callback_query',async _0x416424=>{const _0x421eb6=_0x4b212d,_0x174a94=_0x416424[_0x421eb6(0x3ad)],_0x4c81c1=_0x416424[_0x421eb6(0x278)];tgBot['answerCallbackQuery'](_0x416424['id'])[_0x421eb6(0x223)](async()=>{const _0x375109=_0x421eb6;if(_0x174a94!='no'){const _0x23e03c=0xf,_0x5d0d48=_0x375109(0x29f),_0x5be03d=Array[_0x375109(0x237)](crypto['randomFillSync'](new Uint32Array(_0x23e03c)))[_0x375109(0x246)](_0x4b9e56=>_0x5d0d48[_0x4b9e56%_0x5d0d48[_0x375109(0x386)]])[_0x375109(0x202)](''),_0x2bdddb=bcrypt['hashSync'](_0x5be03d,saltRounds);storeSettings({'bbPassword':_0x2bdddb}),await tgBot[_0x375109(0x1e3)](_0x4c81c1[_0x375109(0x306)]['id'],_0x375109(0x219)+_0x5be03d,{'parse_mode':_0x375109(0x204)})[_0x375109(0x283)](_0x1e1a3c=>{telegramError(_0x1e1a3c);});}else await tgBot['sendMessage'](_0x4c81c1['chat']['id'],_0x375109(0x34e))[_0x375109(0x283)](_0x29ba93=>{telegramError(_0x29ba93);});}),tgBot['removeListener']('callback_query');}));}async function confirmRestore(_0xb66c63,_0x214c8a){const _0x934e68=_0x42acb5;io['to'](_0x934e68(0x2a8))['emit'](_0x934e68(0x22c),_0x934e68(0x2b5),'success'),tgBot&&settings[_0x934e68(0x37f)]&&(tgBot[_0x934e68(0x36f)](_0x934e68(0x360)),await tgBot['sendMessage'](settings[_0x934e68(0x37f)],_0x934e68(0x221),{'parse_mode':_0x934e68(0x204),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x934e68(0x209)},{'text':'no','callback_data':'no'}]]}})[_0x934e68(0x283)](_0x308840=>{telegramError(_0x308840);}),tgBot['on'](_0x934e68(0x360),async _0x16dd5e=>{const _0x597ad8=_0x934e68,_0x30d707=_0x16dd5e['data'],_0x46163d=_0x16dd5e[_0x597ad8(0x278)];tgBot[_0x597ad8(0x232)](_0x16dd5e['id'])['then'](async()=>{const _0x11645a=_0x597ad8;_0x30d707=='yes'?(await tgBot['sendMessage'](_0x46163d[_0x11645a(0x306)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x11645a(0x204)})[_0x11645a(0x283)](_0x20e124=>{telegramError(_0x20e124);}),unzipFile(_0xb66c63,_0x214c8a)):(logger[_0x11645a(0x313)](_0x11645a(0x2d8)),await tgBot[_0x11645a(0x1e3)](_0x46163d['chat']['id'],'Restore\x20process\x20aborted')['catch'](_0x3b89ea=>{telegramError(_0x3b89ea);}));}),tgBot[_0x597ad8(0x36f)](_0x597ad8(0x360));}));}function getServerTime(){const _0x115979=_0x42acb5,_0xdc9743=new Date();return _0xdc9743[_0x115979(0x334)]()+'/'+(_0xdc9743[_0x115979(0x320)]()+0x1)[_0x115979(0x3aa)]()[_0x115979(0x22d)](0x2,'0')+'/'+_0xdc9743['getDate']()[_0x115979(0x3aa)]()['padStart'](0x2,'0')+'\x20'+_0xdc9743[_0x115979(0x3bc)]()['toString']()[_0x115979(0x22d)](0x2,'0')+':'+_0xdc9743[_0x115979(0x225)]()[_0x115979(0x3aa)]()['padStart'](0x2,'0')+':'+_0xdc9743[_0x115979(0x25f)]()[_0x115979(0x3aa)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1573ee=_0x42acb5,_0x1efb79=shiftedTime();return _0x1efb79[_0x1573ee(0x334)]()+'/'+(_0x1efb79[_0x1573ee(0x320)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x1efb79['getDate']()[_0x1573ee(0x3aa)]()['padStart'](0x2,'0')+'\x20'+_0x1efb79[_0x1573ee(0x3bc)]()[_0x1573ee(0x3aa)]()[_0x1573ee(0x22d)](0x2,'0')+':'+_0x1efb79['getMinutes']()[_0x1573ee(0x3aa)]()[_0x1573ee(0x22d)](0x2,'0')+':'+_0x1efb79['getSeconds']()[_0x1573ee(0x3aa)]()[_0x1573ee(0x22d)](0x2,'0');}function getCleanTimeStamp(){const _0x2ef7f1=_0x42acb5,_0x4894cf=shiftedTime();return _0x4894cf[_0x2ef7f1(0x334)]()+(_0x4894cf[_0x2ef7f1(0x320)]()+0x1)[_0x2ef7f1(0x3aa)]()[_0x2ef7f1(0x22d)](0x2,'0')+_0x4894cf[_0x2ef7f1(0x288)]()['toString']()[_0x2ef7f1(0x22d)](0x2,'0')+'-'+_0x4894cf[_0x2ef7f1(0x3bc)]()[_0x2ef7f1(0x3aa)]()[_0x2ef7f1(0x22d)](0x2,'0')+_0x4894cf['getMinutes']()['toString']()['padStart'](0x2,'0')+_0x4894cf[_0x2ef7f1(0x25f)]()[_0x2ef7f1(0x3aa)]()[_0x2ef7f1(0x22d)](0x2,'0');}function shiftedTime(){const _0x2a7ed3=_0x42acb5,_0x50c756=new Date();let _0x8b5c16=_0x50c756;if(settings[_0x2a7ed3(0x1f7)]&&settings[_0x2a7ed3(0x1f7)]!==0x0)_0x8b5c16=fns[_0x2a7ed3(0x38b)](_0x50c756,{'hours':settings['timeshift']});return _0x8b5c16;}function startScheduler(){const _0x131dc8=_0x42acb5,_0x12c0d4=new Date()[_0x131dc8(0x2d3)](),_0x1719ed=shiftedTime()['getHours']();_0x1719ed==0x4&&backupConfigFiles();_0x1719ed==0x0&&rotateLogFiles();_0x12c0d4%0x6==0x0&&triggerAnalytics();_0x12c0d4%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x16a2c3){const _0x368c3e=_0x42acb5;logger[_0x368c3e(0x313)](_0x368c3e(0x2e3)+_0x16a2c3);const _0x3f9fc4=getBotsWithMode();_0x3f9fc4[_0x368c3e(0x386)]>0x0?confirmRestore(configbackuppath,_0x16a2c3):unzipFile(configbackuppath,_0x16a2c3);}async function getBackupFiles(_0x28ff9e=null){const _0x1ac712=_0x42acb5;let _0x4f1cbb=[],_0x19ff7e=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x19ff7e[_0x1ac712(0x2c6)]((_0x25cbdc,_0x3edf39)=>_0x25cbdc[_0x1ac712(0x321)]<_0x3edf39['name']?0x1:_0x3edf39[_0x1ac712(0x321)]<_0x25cbdc['name']?-0x1:0x0),_0x19ff7e['forEach'](_0x3abdfc=>{const _0x2401b6=_0x1ac712;if(!_0x3abdfc[_0x2401b6(0x30f)]()&&_0x3abdfc[_0x2401b6(0x321)]['startsWith'](_0x2401b6(0x262))&&_0x3abdfc[_0x2401b6(0x321)][_0x2401b6(0x35e)](_0x2401b6(0x218))){const _0x12d209=formatDate(fs[_0x2401b6(0x251)](configbackuppath+_0x3abdfc[_0x2401b6(0x321)])[_0x2401b6(0x2ff)]);_0x4f1cbb[_0x2401b6(0x2f0)]({'name':_0x3abdfc[_0x2401b6(0x321)],'mtime':_0x12d209});}});if(_0x28ff9e)io['to'](_0x28ff9e)[_0x1ac712(0x377)](_0x1ac712(0x2af),_0x4f1cbb);else return _0x4f1cbb;}async function backupConfigFiles(){const _0xfac02=_0x42acb5;await zipFiles('backup-full');const _0x38fd23=getCleanTimeStamp();fs[_0xfac02(0x308)](zippath+_0xfac02(0x1f4),configbackuppath+(_0xfac02(0x262)+_0x38fd23+_0xfac02(0x218)));let _0x4a44a1=fs[_0xfac02(0x3b2)](configbackuppath,{'withFileTypes':!![]});_0x4a44a1[_0xfac02(0x2c6)]((_0x2e4799,_0x256ea0)=>_0x2e4799['name']<_0x256ea0[_0xfac02(0x321)]?0x1:_0x256ea0[_0xfac02(0x321)]<_0x2e4799['name']?-0x1:0x0),_0x4a44a1['length']>maxBackups&&fs[_0xfac02(0x29c)](configbackuppath+_0x4a44a1[_0x4a44a1['length']-0x1][_0xfac02(0x321)]);}function rotateLogFiles(){const _0x5cad0b=_0x42acb5,_0x374fbd=fs[_0x5cad0b(0x251)](logspath+_0x5cad0b(0x21e)),_0x31895d=_0x374fbd[_0x5cad0b(0x200)]/0x400;if(_0x31895d>0x64){let _0x6517e=fs[_0x5cad0b(0x3b2)](logspath,{'withFileTypes':!![]});_0x6517e[_0x5cad0b(0x2c6)]((_0x49d367,_0x1bf1b0)=>_0x49d367[_0x5cad0b(0x321)]<_0x1bf1b0[_0x5cad0b(0x321)]?0x1:_0x1bf1b0[_0x5cad0b(0x321)]<_0x49d367[_0x5cad0b(0x321)]?-0x1:0x0),_0x6517e[_0x5cad0b(0x31a)](_0x493f1c=>{const _0x573f5a=_0x5cad0b;if(_0x493f1c[_0x573f5a(0x321)]==_0x573f5a(0x315))fs[_0x573f5a(0x308)](logspath+_0x493f1c['name'],logspath+_0x573f5a(0x2bb));if(_0x493f1c['name']=='output-001.log')fs['copyFileSync'](logspath+_0x493f1c[_0x573f5a(0x321)],logspath+'output-002.log');_0x493f1c['name']==_0x573f5a(0x21e)&&(fs['copyFileSync'](logspath+_0x493f1c['name'],logspath+_0x573f5a(0x39f)),fs[_0x573f5a(0x2f2)](logspath+_0x493f1c['name'],''));});}}async function zipFiles(_0xb78730){const _0x53852b=_0x42acb5;let _0x30dcb6;if(_0xb78730==_0x53852b(0x238))_0x30dcb6=logspath;if(_0xb78730==_0x53852b(0x347))_0x30dcb6=configpath;if(_0xb78730=='backup-full')_0x30dcb6=configpath;let _0x49c590=fs['readdirSync'](_0x30dcb6,{'withFileTypes':!![]});const _0x48ed6f=new require(_0x53852b(0x272))();_0x49c590[_0x53852b(0x31a)](_0x31f28a=>{const _0x590ef0=_0x53852b;if(!_0x31f28a['isDirectory']()){let _0x2b0ccf=fs[_0x590ef0(0x2d2)](_0x30dcb6+_0x31f28a[_0x590ef0(0x321)]);if(_0xb78730==_0x590ef0(0x347)){const _0x1aa6ae=/^bot-[0-9]{3}-config.json$/,_0x18c1f2=_0x1aa6ae[_0x590ef0(0x23f)](_0x31f28a[_0x590ef0(0x321)]);if(_0x18c1f2){const _0x2889de=JSON[_0x590ef0(0x2df)](_0x2b0ccf);if(_0x2889de['bot'][0x0]){_0x2889de[_0x590ef0(0x374)][0x0]['apiKey']=_0x590ef0(0x24f),_0x2889de[_0x590ef0(0x374)][0x0]['apiSecret']=_0x590ef0(0x24f);if(_0x2889de['bot'][0x0][_0x590ef0(0x2e9)])_0x2889de['bot'][0x0]['apiPassword']=_0x590ef0(0x24f);}_0x2b0ccf=JSON[_0x590ef0(0x31d)](_0x2889de,null,0x2);}if(_0x31f28a[_0x590ef0(0x321)]=='bb-settings.json'){const _0x33cdfd=JSON[_0x590ef0(0x2df)](_0x2b0ccf);if(_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x390)])_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x390)]=![];if(_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x395)])_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x395)]='***';if(_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x384)])_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x384)]=_0x590ef0(0x24f);if(_0x33cdfd[_0x590ef0(0x27b)][_0x590ef0(0x37f)])_0x33cdfd[_0x590ef0(0x27b)]['telegramChatId']=null;_0x2b0ccf=JSON[_0x590ef0(0x31d)](_0x33cdfd,null,0x2);}if(_0x31f28a[_0x590ef0(0x321)]!=_0x590ef0(0x2e5))_0x48ed6f[_0x590ef0(0x1ea)](_0x31f28a[_0x590ef0(0x321)],_0x2b0ccf);}else _0x48ed6f[_0x590ef0(0x1ea)](_0x31f28a[_0x590ef0(0x321)],_0x2b0ccf);}});const _0x201cb5=_0x48ed6f[_0x53852b(0x2b7)]({'base64':![],'compression':_0x53852b(0x2c7)});fs['writeFileSync'](zippath+(_0xb78730+'.zip'),_0x201cb5,'binary');}async function unzipFile(_0x3d4363,_0x13d8ef){const _0x472ab1=_0x42acb5;fs[_0x472ab1(0x3b2)](configpath,{'withFileTypes':!![]})[_0x472ab1(0x31a)](_0x29f5f9=>{const _0x1d1e1a=_0x472ab1;if(!_0x29f5f9['isDirectory']())fs['rmSync'](configpath+_0x29f5f9[_0x1d1e1a(0x321)]);});const _0x884276=fs['readFileSync'](_0x3d4363+_0x13d8ef,_0x472ab1(0x388)),_0x27b8e5=new require(_0x472ab1(0x272))(_0x884276,{'base64':![],'checkCRC32':!![]});Object[_0x472ab1(0x3b4)](_0x27b8e5[_0x472ab1(0x1f3)])['forEach'](_0x150540=>{const _0x8236db=_0x472ab1,_0x1160a4=_0x27b8e5[_0x8236db(0x1f3)][_0x150540];fs[_0x8236db(0x2f2)](configpath+_0x1160a4['name'],_0x1160a4[_0x8236db(0x2bd)]);}),fs[_0x472ab1(0x3b2)](temppath,{'withFileTypes':!![]})[_0x472ab1(0x31a)](_0x31a486=>{const _0x49da0d=_0x472ab1;if(!_0x31a486[_0x49da0d(0x30f)]())fs[_0x49da0d(0x350)](temppath+_0x31a486[_0x49da0d(0x321)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x472ab1(0x39b)]({'restore':!![]},_0x41ea7f=>{});}async function getPublicIp(){const _0x10f562=_0x42acb5;try{const _0x2ce763=await axios[_0x10f562(0x336)](_0x10f562(0x26a));publicip=_0x2ce763[_0x10f562(0x3ad)]['ip'];}catch(_0x5a3e13){}}async function triggerAnalytics(){const _0x4b0945=_0x42acb5;if(!publicip)await getPublicIp();const _0x25c720=getBotsWithMode();let _0x28f3f6=0x0;_0x25c720[_0x4b0945(0x31a)](_0x16707f=>{const _0x3c03e0=_0x4b0945;if(_0x16707f[_0x3c03e0(0x3c1)]===_0x3c03e0(0x3a2))_0x28f3f6++;});const _0x332287=getBotExchanges();mixpanel[_0x4b0945(0x26c)](_0x4b0945(0x226),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x25c720[_0x4b0945(0x386)],'numbotsenabled':_0x28f3f6,'exchanges':_0x332287,'environment':environment});}async function getMessages(){const _0x40fdb8=_0x42acb5,_0x445130='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x58b0c4=new GraphQLClient(_0x445130),_0x18f272={'authorization':_0x40fdb8(0x220)},_0x2ec679=serverversion[_0x40fdb8(0x290)]('.'),_0x522001=_0x2ec679[0x0]+'.'+_0x2ec679[0x1],_0x4a4307=Math['min'](settings[_0x40fdb8(0x2aa)],settings['lastmsgemitted']),_0x5e6f88={'last':parseInt(_0x4a4307),'bbm':_0x522001},_0x53b83c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1121c6;try{_0x1121c6=await _0x58b0c4[_0x40fdb8(0x34d)](_0x53b83c,_0x5e6f88,_0x18f272);}catch(_0x8dd92){}if(_0x1121c6&&_0x1121c6[_0x40fdb8(0x30a)]){let _0x206b3a=settings[_0x40fdb8(0x2aa)];newMessages=[];for(const _0x3b48ab of _0x1121c6[_0x40fdb8(0x30a)]){newMessages[_0x40fdb8(0x2f0)](_0x3b48ab);let _0x491898=![];_0x3b48ab['bbvNew']&&(updateSetting('latestversion',_0x3b48ab['bbvNew']),_0x491898=isNewerVersion(serverversion,_0x3b48ab[_0x40fdb8(0x39d)])||serverversion==_0x3b48ab[_0x40fdb8(0x39d)]);if(!_0x491898&&_0x3b48ab[_0x40fdb8(0x21a)]>_0x206b3a){if(_0x3b48ab[_0x40fdb8(0x32b)]===_0x40fdb8(0x263)||serverversion[_0x40fdb8(0x2ec)](_0x3b48ab[_0x40fdb8(0x32b)])){let _0x3d8a40=''+_0x3b48ab[_0x40fdb8(0x328)]+'\x0a\x0a'+_0x3b48ab[_0x40fdb8(0x278)];const _0x1addd8=await sendTelegramMsg(toTelegramMarkdown(_0x3d8a40),_0x40fdb8(0x23d));if(_0x1addd8)_0x206b3a=_0x3b48ab[_0x40fdb8(0x21a)];}}}updateAvailable=isNewerVersion(settings[_0x40fdb8(0x1ec)],serverversion),updateSetting(_0x40fdb8(0x2aa),_0x206b3a),emitMessages();}}function emitMessages(){const _0x39ad9c=_0x42acb5,_0x3912df=settings[_0x39ad9c(0x2c2)];let _0x42320a=[];newMessages['forEach'](_0x3c60de=>{const _0x1f2be0=_0x39ad9c;_0x3c60de['number']>_0x3912df&&_0x42320a[_0x1f2be0(0x2f0)](_0x3c60de);}),_0x42320a[_0x39ad9c(0x386)]>0x0&&getAllClients()['forEach'](_0xaaace=>{const _0x3cea4e=_0x39ad9c;getSocket(_0xaaace['id'])[_0x3cea4e(0x377)](_0x3cea4e(0x278),_0x42320a);});}function confirmMessage(_0x249598){const _0x3f5b88=_0x42acb5;updateSetting(_0x3f5b88(0x2c2),Number(_0x249598));}function isNewerVersion(_0x37e0c6,_0x45f91e){const _0x3f438e=_0x42acb5,_0x528645=_0x45f91e[_0x3f438e(0x290)]('.'),_0xff4e13=_0x37e0c6[_0x3f438e(0x290)]('.');for(var _0x2b8316=0x0;_0x2b8316<_0xff4e13['length'];_0x2b8316++){const _0x5d2976=~~_0xff4e13[_0x2b8316],_0x4a97ad=~~_0x528645[_0x2b8316];if(_0x5d2976>_0x4a97ad)return!![];if(_0x5d2976<_0x4a97ad)return![];}return![];}function toTelegramMarkdown(_0x4d90b3){const _0x4352b3=_0x42acb5,_0xa03a78=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x50527a=/\*{2}(.+?)\*{2}/gim;return _0x4d90b3=_0x4d90b3[_0x4352b3(0x2ed)](_0xa03a78,_0x4352b3(0x258))[_0x4352b3(0x2ed)](_0x50527a,_0x4352b3(0x31e)),_0x4d90b3;}async function validateConfigFile(){const _0x16aeb1=_0x42acb5,_0x392a45=dbConfig['get']('bots')[_0x16aeb1(0x23a)](_0x16aeb1(0x24c))[_0x16aeb1(0x3af)]()||[];if(_0x392a45[_0x16aeb1(0x386)]==0x0){let _0x41fdb3=0x0,_0x55872c=[];const _0x38b081=/^bot-([0-9]{3})-config.json$/,_0x19e6e0=fs[_0x16aeb1(0x3b2)](configpath);_0x19e6e0[_0x16aeb1(0x31a)](_0x4cdace=>{const _0x3a9380=_0x16aeb1,_0x5895e2=_0x38b081[_0x3a9380(0x267)](_0x4cdace);if(_0x5895e2){const _0x465c76=_0x5895e2[0x1];let _0x2a286b=getBotAttributes(_0x465c76);_0x55872c['push']({'botID':_0x465c76,'botname':_0x2a286b['botname'],'status':'disabled','live':_0x3a9380(0x1ee)}),_0x41fdb3++;}}),_0x41fdb3!=0x0&&(dbConfig[_0x16aeb1(0x336)](_0x16aeb1(0x398))[_0x16aeb1(0x2bc)](_0x55872c)[_0x16aeb1(0x305)](),config=_0x55872c,restoredConfigFile=_0x41fdb3);}}async function restoreConfigNotify(_0x301d0c){const _0x4b5029=_0x42acb5;let _0x470a3d;if(restoredConfigFile==0x1)_0x470a3d=_0x4b5029(0x365);else _0x470a3d='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x301d0c)io['to'](_0x4b5029(0x2a8))['emit'](_0x4b5029(0x22c),_0x470a3d);else{logger[_0x4b5029(0x31b)](_0x4b5029(0x250)),logger[_0x4b5029(0x31b)](_0x470a3d),logger[_0x4b5029(0x31b)](_0x4b5029(0x250)),logger[_0x4b5029(0x31b)]('');if(tgBot&&settings[_0x4b5029(0x37f)]&&settings['telegramEvents']!=_0x4b5029(0x293))tgBot['sendMessage'](settings[_0x4b5029(0x37f)],'Bot\x20Mgr\x20>\x20'+_0x470a3d)[_0x4b5029(0x283)](_0x3f39ae=>{telegramError(_0x3f39ae);});}}function validateCredentials(_0xd7c0ea,_0x459dae){const _0x492f57=_0x42acb5;if(_0xd7c0ea[_0x492f57(0x2fb)]==settings['bbUsername']&&bcrypt[_0x492f57(0x2ae)](_0xd7c0ea[_0x492f57(0x2f3)],settings[_0x492f57(0x395)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x492f57(0x32a),'token':null};else{const _0xce8c31=generateLoginToken(_0x459dae);return{'allow':!![],'reason':_0x492f57(0x2c5),'token':_0xce8c31};}}else return{'allow':![],'reason':_0x492f57(0x2d1),'token':null};}function refreshToken(_0x3fe99c){const _0x46387d=_0x42acb5,_0x3d3827=generateLoginToken(_0x3fe99c);return{'allow':!![],'reason':_0x46387d(0x2c5),'token':_0x3d3827};}function validateAccess(_0x2c79d4,_0x518927,_0x3f6ee2){const _0x34b752=_0x42acb5,_0x42b03d=_0x3f6ee2?_0x3f6ee2:devices[_0x518927]['ip'];let _0x2fbcce;const _0x478245=_0x278be3=>{const _0x3d06f4=_0x314d;if(settings[_0x3d06f4(0x390)]){if(settings[_0x3d06f4(0x30d)]){if(telegram2FaApproved(_0x518927)){const _0x11cd7a=generateLoginToken(_0x518927);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x11cd7a};}else return{'allow':![],'reason':_0x3d06f4(0x27e),'token':null};}else return _0x2fbcce=validToken(_0x278be3,_0x518927),_0x2fbcce[_0x3d06f4(0x2d9)](_0x3d06f4(0x2e1))?{'allow':!![],'reason':_0x3d06f4(0x1e9),'token':_0x278be3}:{'allow':![],'reason':_0x3d06f4(0x27e),'token':null};}else return{'allow':!![],'reason':_0x3d06f4(0x21f),'token':null};};if(settings[_0x34b752(0x357)]){let _0x5dbb32=[...settings[_0x34b752(0x2e6)],_0x34b752(0x236),_0x34b752(0x29d),_0x34b752(0x217)];if(_0x5dbb32[_0x34b752(0x36e)](_0x42b03d))return _0x478245(_0x2c79d4);else{_0x2fbcce=validToken(_0x2c79d4,_0x518927);if(_0x2fbcce[_0x34b752(0x2d9)]('success'))return _0x478245(_0x2c79d4);else{if(telegramIpApproved(_0x518927)){const _0x43b7a8=generateToken(_0x518927);return _0x2fbcce=_0x478245(_0x2c79d4),_0x2fbcce[_0x34b752(0x1fe)]?{'allow':!![],'reason':_0x34b752(0x2e7),'token':_0x43b7a8}:_0x2fbcce;}else return settings[_0x34b752(0x34c)]?{'allow':![],'reason':_0x34b752(0x3bf),'token':null}:{'allow':![],'reason':_0x34b752(0x370),'token':null};}}}else return _0x478245(_0x2c79d4);}function timelyDecrypt(_0xf907d3,_0x48107f=!![]){const _0x3be445=_0x42acb5;if(_0xf907d3)try{const _0x384521=crypt[_0x3be445(0x33b)](secure[_0x3be445(0x2e2)],_0xf907d3)[_0x3be445(0x278)],_0x4514c0=_0x384521[_0x3be445(0x290)]('@')[0x0],_0x262e24=_0x384521[_0x3be445(0x290)]('@')[0x1],_0x55a301=new Date()[_0x3be445(0x3ba)]();if(_0x48107f){if(_0x55a301-_0x262e24<maxSecretAge*0x3e8)return _0x4514c0;else return![];}else return _0x4514c0;}catch(_0xb785d4){return![];}else return![];}const validToken=(_0x26def5,_0x24a052)=>{const _0x30a0f3=_0x42acb5,_0x52b365=devices[_0x24a052]['ip'];if(!_0x26def5)return{'error':_0x30a0f3(0x26d)};for(let _0x45bd6c of blacklist){if(_0x45bd6c[_0x30a0f3(0x25e)]==_0x26def5)return{'error':_0x30a0f3(0x22b)};}let _0x14da47;try{_0x14da47=jwt[_0x30a0f3(0x1e7)](_0x26def5,secure[_0x30a0f3(0x37e)]+_0x24a052);}catch{return{'error':_0x30a0f3(0x385)};}if(!_0x14da47[_0x30a0f3(0x2d9)](_0x30a0f3(0x2ef))&&!_0x14da47[_0x30a0f3(0x2d9)](_0x30a0f3(0x2fb))||!_0x14da47[_0x30a0f3(0x2d9)](_0x30a0f3(0x206)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x14da47[_0x30a0f3(0x2d9)](_0x30a0f3(0x2fb))&&_0x14da47[_0x30a0f3(0x2d9)](_0x30a0f3(0x2ef))){const {clientip:_0x24faf9}=_0x14da47;return _0x52b365==_0x24faf9?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x30a0f3(0x2ca)};}else{if(_0x14da47[_0x30a0f3(0x2d9)](_0x30a0f3(0x2fb))&&_0x14da47[_0x30a0f3(0x2d9)]('clientip')){const {username:_0x2434b4,clientip:_0x3a4b8a}=_0x14da47;return settings[_0x30a0f3(0x307)]==_0x2434b4&&_0x52b365==_0x3a4b8a?{'success':_0x30a0f3(0x3b0)}:{'error':_0x30a0f3(0x2db)};}}},generateLoginToken=_0x26cd6a=>{const _0x4f865d=_0x42acb5;if(_0x26cd6a){const _0x2e4e7f=devices[_0x26cd6a]['ip'];return jwt['sign']({'username':settings[_0x4f865d(0x307)],'clientip':_0x2e4e7f},secure[_0x4f865d(0x37e)]+_0x26cd6a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x3ed4f2=>{const _0x3e87b0=_0x42acb5;if(_0x3ed4f2){const _0x16039f=devices[_0x3ed4f2]['ip'];return jwt[_0x3e87b0(0x351)]({'clientip':_0x16039f},secure['secret']+_0x3ed4f2,{'expiresIn':devices[_0x3ed4f2][_0x3e87b0(0x2e0)][_0x3e87b0(0x30e)]*0x3c});}else return![];},telegramIpApproved=_0x5e2e80=>{const _0x14ea05=_0x42acb5;let _0x25a6e0=![];return devices[_0x5e2e80][_0x14ea05(0x2e0)]&&devices[_0x5e2e80][_0x14ea05(0x2e0)][_0x14ea05(0x30e)]!=_0x14ea05(0x277)&&(_0x25a6e0=devices[_0x5e2e80][_0x14ea05(0x2e0)][_0x14ea05(0x2ef)]==devices[_0x5e2e80]['ip']&&new Date()[_0x14ea05(0x3ba)]()-devices[_0x5e2e80][_0x14ea05(0x2e0)]['timestamp']<devices[_0x5e2e80]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x25a6e0;},telegram2FaApproved=_0x1f2f90=>{const _0x488841=_0x42acb5;let _0x3456d9=![];return devices[_0x1f2f90][_0x488841(0x25a)]&&devices[_0x1f2f90][_0x488841(0x25a)]['expiry']!='reject'&&(_0x3456d9=devices[_0x1f2f90][_0x488841(0x25a)][_0x488841(0x2ef)]==devices[_0x1f2f90]['ip']&&new Date()[_0x488841(0x3ba)]()-devices[_0x1f2f90]['telegram2FaApproval'][_0x488841(0x2b8)]<devices[_0x1f2f90][_0x488841(0x25a)][_0x488841(0x30e)]*0x3c*0x3e8),_0x3456d9;},normalizeIP=_0x5db9f2=>{const _0x20a82d=_0x42acb5;let _0x2c33cd=null,_0x4ade84=null;if(ipaddr[_0x20a82d(0x35b)](_0x5db9f2)){const _0x588666=ipaddr['parse'](_0x5db9f2);_0x588666[_0x20a82d(0x20c)]()===_0x20a82d(0x244)?(_0x588666['isIPv4MappedAddress']()&&(_0x2c33cd=_0x588666[_0x20a82d(0x2f4)]()[_0x20a82d(0x3aa)]()),_0x4ade84=_0x588666[_0x20a82d(0x3aa)]()):(_0x2c33cd=_0x588666[_0x20a82d(0x3aa)](),_0x4ade84=_0x588666[_0x20a82d(0x215)]()[_0x20a82d(0x3aa)]());}return{'show':_0x2c33cd?_0x2c33cd:_0x4ade84,'store':_0x4ade84};};function formatDate(_0x184deb){const _0x1b9e5a=_0x42acb5;return _0x184deb[_0x1b9e5a(0x334)]()+'/'+(_0x184deb['getMonth']()+0x1)[_0x1b9e5a(0x3aa)]()[_0x1b9e5a(0x22d)](0x2,'0')+'/'+_0x184deb[_0x1b9e5a(0x288)]()[_0x1b9e5a(0x3aa)]()[_0x1b9e5a(0x22d)](0x2,'0')+'\x20'+_0x184deb['getHours']()[_0x1b9e5a(0x3aa)]()[_0x1b9e5a(0x22d)](0x2,'0')+':'+_0x184deb[_0x1b9e5a(0x225)]()[_0x1b9e5a(0x3aa)]()[_0x1b9e5a(0x22d)](0x2,'0')+':'+_0x184deb[_0x1b9e5a(0x25f)]()[_0x1b9e5a(0x3aa)]()[_0x1b9e5a(0x22d)](0x2,'0');}function sleep(_0x4b5925){return new Promise(_0x399e0b=>setTimeout(_0x399e0b,_0x4b5925));}