const _0xc1da20=_0x509a;(function(_0x30d37c,_0x2df158){const _0x2991b0=_0x509a,_0x39c64b=_0x30d37c();while(!![]){try{const _0x8f9af7=parseInt(_0x2991b0(0x13b))/0x1*(parseInt(_0x2991b0(0x1bc))/0x2)+-parseInt(_0x2991b0(0x28d))/0x3+-parseInt(_0x2991b0(0x284))/0x4+-parseInt(_0x2991b0(0x182))/0x5*(parseInt(_0x2991b0(0x20c))/0x6)+-parseInt(_0x2991b0(0x23b))/0x7*(parseInt(_0x2991b0(0x127))/0x8)+parseInt(_0x2991b0(0x228))/0x9*(-parseInt(_0x2991b0(0x1ef))/0xa)+parseInt(_0x2991b0(0x2b4))/0xb;if(_0x8f9af7===_0x2df158)break;else _0x39c64b['push'](_0x39c64b['shift']());}catch(_0x471b68){_0x39c64b['push'](_0x39c64b['shift']());}}}(_0x7ccf,0x580ed));const _0x10de65=function(){let _0x51c691=!![];return function(_0x5bf6d8,_0x58fa42){const _0xfd38c0=_0x51c691?function(){if(_0x58fa42){const _0x7b7ff6=_0x58fa42['apply'](_0x5bf6d8,arguments);return _0x58fa42=null,_0x7b7ff6;}}:function(){};return _0x51c691=![],_0xfd38c0;};}(),_0x41af09=_0x10de65(this,function(){const _0x2ecddb=_0x509a;return _0x41af09['toString']()[_0x2ecddb(0x2c9)]('(((.+)+)+)+$')[_0x2ecddb(0x216)]()[_0x2ecddb(0x1b1)](_0x41af09)[_0x2ecddb(0x2c9)](_0x2ecddb(0x154));});_0x41af09();'use strict';process[_0xc1da20(0x295)][_0xc1da20(0x13e)]=0x1;const childProcess=require(_0xc1da20(0x273)),fs=require('fs'),fns=require(_0xc1da20(0x157)),low=require(_0xc1da20(0x252)),FileSync=require(_0xc1da20(0x2a7)),path=require(_0xc1da20(0x1f8)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0xc1da20(0x1ea)],RSA=require(_0xc1da20(0x1db))[_0xc1da20(0x24f)],bcrypt=require('bcryptjs'),jwt=require(_0xc1da20(0x17a)),ipaddr=require(_0xc1da20(0x226)),argv=require(_0xc1da20(0x1e5))(process[_0xc1da20(0x27d)]['slice'](0x2))[_0xc1da20(0x27d)],uuidRandom=require(_0xc1da20(0x14a)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0xc1da20(0x2aa)),axios=require(_0xc1da20(0x206)),{GraphQLClient,gql}=require(_0xc1da20(0x1dc)),util=require(_0xc1da20(0x229)),fileUpload=require('express-fileupload'),PORT=argv[_0xc1da20(0x1cd)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0xc1da20(0x241)](PORT)&&(console['log'](_0xc1da20(0x204)+PORT+_0xc1da20(0x248)),process[_0xc1da20(0x245)](0x1));const HOST=argv[_0xc1da20(0x1f1)]||null,userID=argv[_0xc1da20(0x27c)]||'',debugging=argv['d']||![];let bbpath=_0xc1da20(0x2ad),bbpath2='';const botfile=_0xc1da20(0x1c0),configfile=_0xc1da20(0x1d0),settingsfile='bb-settings.json',securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0xc1da20(0x1d5)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xc1da20(0x2cb)),configpath=userID?bbpath+_0xc1da20(0x257)+userID+'/':bbpath+_0xc1da20(0x257),configbackuppath=configpath+_0xc1da20(0x172),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0xc1da20(0x11b),zippath=userID?bbpath+_0xc1da20(0x265)+userID+'/':bbpath+'zip/',loggerfile=fs[_0xc1da20(0x1e9)](logspath+_0xc1da20(0x15d),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0xc1da20(0x282);!fs[_0xc1da20(0x1d5)](configpath)&&fs[_0xc1da20(0x227)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0xc1da20(0x227)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0xc1da20(0x227)](logspath);!fs['existsSync'](zippath)&&fs[_0xc1da20(0x227)](zippath);function _0x7ccf(){const _0x586031=['logs/','running','\x20to\x20','userid','/names\x20-\x20show\x20bot\x20names\x0a','telegrammsg','password','f2aRequired','-performance.json','sort','getHours','getTime','24XksrAu','socket.io','disabled','length','/download/:type','remove','notification','endsWith','\x20|\x20client:\x20...','exp','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Enabled\x20Bot\x20','readFileSync','debug','output-001.log','name','update-bb','yes','reset-history','316715twqCKM','No\x20authentication\x20token','socket','NTBA_FIX_319','publicKey','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','push','delete-bot','***','temporary\x20token\x20generated','startsWith','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','all','manual','</b>\x20?','uuid-random','allow','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getSeconds','temporary\x20access\x20timeout','Login\x20rejected','then','deleteHistoryAlerts','/restart\x20-\x20restart\x20bot(s)\x0a','Restore\x20process\x20aborted','(((.+)+)+)+$','getStartingBalances','Yes','date-fns','headless',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','alias','success','get-starting-balances','/output-000.log','data','File\x20uploaded','/update\x20-\x20update\x20Balance\x20Bot\x0a','includes','index.html','started','apiKey','Starting\x20bot\x20|\x20Bot\x20','Idling\x20bot\x20\x20\x20|\x20Bot\x20','telegram2FaApproval','latestversion','sortBy','Bot\x20Mgr\x20>\x20','Login\x20accepted','Deleted\x20Bot\x20','kill','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','No\x20bots\x20running\x20right\x20now','2FA\x20required','<b>Balance\x20Bot\x20Status:</b>\x0a','backup/','getMinutes','bots','\x20(1)','handshake','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','emitHistory','logs','jsonwebtoken','confirm-message','\x20|\x20','min','http','Server','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','event','465055VYQzOz','404\x20Not\x20Found','uuid','chat','post','cancel-loading','settings','server','Unauthorized\x20attempt\x20to\x20download\x20','privateKey','catch','temporary\x20access\x20not\x20allowed','stop','Unauthorized\x20attempt\x20to\x20update\x20settings','loginRequired','Unauthorized\x20attempt\x20to\x20delete\x20bot','ipc','stopped','params','readdirSync','telegramChatId','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20get\x20events','HTML','Unauthorized\x20attempt\x20to\x20update\x20bot','pidExpireLogin','once','Unauthorized\x20attempt\x20to\x20add\x20bot','order','Notifications\x20disabled','track','************','invalid\x20credentials','mode','onText','log','2FA\x20login\x20rejected','logged\x20out','split','join','bb-secure.json','bbUsername','init','uncaughtException','createServer','bbPassword','bb-settings.json','constructor','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','get-backup-files','getUTCHours','type','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','reason','args','show-config','All','getMonth','2otRMiE','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','lastmsgemitted','add','bot.js','bot','format','isDirectory','use','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Password\x20has\x20been\x20reset\x20to:\x20','Temporary\x20access\x20rejected','removeListener','Restore\x20backup\x20file\x20','hashSync','headers','15\x20min','port','Unauthorized\x20login\x20attempt\x20(timeout)','backup-full','bb-config.json','timestamp','/:bot/portfolio','Invalid\x20IP\x20address','tkn','existsSync','getPortfolio','find','username','express','generate','hybrid-crypto-js','graphql-request','connection','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','referer','https://api.ipify.org?format=json','disconnect','output-002.log','reject','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','yargs/yargs','/upload-backup','secure','unlinkSync','createWriteStream','Crypt','get-portfolio','defaults','binary','2FA','10wEFsoD','assign','host','/:bot/history','bbvNew','store-headless','replace','Invalid\x20Telegram\x20token','Starting\x20Balance\x20Bot\x20update','path','error','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','store','.zip','Invalid\x20authentication\x20token\x20(2)','inherit','request','toIPv4Address','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','settings.','copyFileSync','Error:\x20Invalid\x20argument\x20','sign','axios','-----------------------------------------------------------------------------------','write','build','toIPv4MappedAddress','auto','6ckqwSw','\x20minutes','0.0.0','connected','output-003.log','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Notifications\x20disabled\x0a','encryptedUuid','max','toggle-bot-mode','toString','store-configuration','getDate','emit','botmanager','expiry','version.json','enabled','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','simple','output-000.log','Markdown','live','whitelist','bot-','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','ipaddr.js','mkdirSync','2009727DYtZhp','util','backup-full@','node-zip','slice','127.0.0.1','SIGINT','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','files','/enable\x20-\x20enable\x20notifications\x0a','send','answerCallbackQuery','restart','Unauthorized\x20attempt\x20to\x20store\x20configuration','Invalid\x20username\x20or\x20IP\x20address','filter','update','\x20|\x20user:\x20...','-config.json','475804mcGbwv','telegramEnabled','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20log\x20out','sendMetricsTelegram','storeHeadless','test','restore-backup-file','rmSync','number','exit','parse','static',',\x20must\x20be\x20a\x204\x20digit\x20number','alerts','ipv6','reload','stopPolling','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','backup','RSA','orders','accept','lowdb','<b>Telegram\x20Bot\x20Status:</b>\x0a','keys','Orders','entries','config/','All\x20bots\x20running\x20right\x20now','Ok,\x20will\x20send\x20order\x20notifications\x20only','api-eu.mixpanel.com','show','telegramIpApproval','botname','onepagemode','statSync','All\x20bots','Notifications\x20types:\x20','sockets','login\x20token\x20generated','stringify','zip/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','exec','messages','lastmsgtelegram','access','new','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','/help\x20-\x20show\x20available\x20commands\x0a','secret','telegramUsername','function','telegramToken','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','child_process','sendPortfolioTelegram','Bot\x20','botID','hasOwnProperty','logout','remoteAddress','Invalid\x20authentication\x20token\x20(1)','Logged\x20out\x20user\x20...','user','argv','sendFile','$1_$2_$3','login','You\x20can\x20use\x20the\x20following\x20commands:\x0a','temp/','Alerts','348872iLMRzV','Notifications\x20enabled','value','-results.json','DEFLATE','\x20>\x20','decrypt','cloneDeep','kind','1501758XStnHP','padStart','login\x20token\x20valid','*$1*','isValid','place-order','-events.json','_data','env','pidRefreshToken','::ffff:127.0.0.1','login\x20not\x20required','set','status','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','get-messages','whitelistEnabled','new-disabled','/:bot/performance','resetHistory','title','2FA\x20login\x20token\x20generated','getFullYear','forEach','blacklist','message','lowdb/adapters/FileSync','storeFiat','/:bot','mixpanel','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','randomBytes','bb/','access\x20timeout','compareSync','bbvReceive','timeshift','clientip','file','12672044UPoauv','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','store-settings','reinstall-bb','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegramEvents','\x20mode','/on\x20-\x20start\x20bot(s)\x0a','callback_query','reinstall','apiSecret','from','Starting\x20new\x20bot\x20|\x20Bot\x20','telegram','sendMessage','mtime','5\x20min','30\x20min','get-logs','full','search','2FA\x20login\x20required','clients','writeFileSync','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','build2','showConfig','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','exchange','temporaryAccessAllowed','get','Starting\x20Balance\x20Bot\x20reinstallation','listen','generateKeyPairAsync','token','initclient'];_0x7ccf=function(){return _0x586031;};return _0x7ccf();}!fs['existsSync'](temppath)&&fs[_0xc1da20(0x227)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xc1da20(0x1ec)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xc1da20(0x1ec)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xc1da20(0x20e),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xc1da20(0x1ec)]({'secure':{},'blacklist':[]})[_0xc1da20(0x208)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0xc1da20(0x1ac)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0xc1da20(0x25a)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0xc1da20(0x271)]!=''&&settings[_0xc1da20(0x26f)]&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x743272=>{const _0x1d45d8=_0xc1da20;console[_0x1d45d8(0x1a5)](_0x743272);},'simple':_0x5c7e62=>{const _0x4a5039=_0xc1da20;console['log'](_0x5c7e62),loggerfile[_0x4a5039(0x208)](util['format'](_0x5c7e62)+'\x0a');},'full':async _0x4afc18=>{const _0x2c5c2b=_0xc1da20,_0x486f8e=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4afc18;console['log'](_0x486f8e),loggerfile[_0x2c5c2b(0x208)](util[_0x2c5c2b(0x1c2)](_0x486f8e)+'\x0a');if(tgBot&&settings[_0x2c5c2b(0x196)]&&settings[_0x2c5c2b(0x2ba)]!=_0x2c5c2b(0x250))await tgBot[_0x2c5c2b(0x2c3)](settings[_0x2c5c2b(0x196)],_0x2c5c2b(0x16a)+_0x4afc18)[_0x2c5c2b(0x18c)](_0x27c607=>{telegramError(_0x27c607);});},'debug':async(_0x13f006,_0xdb03d1='')=>{const _0x8ed476=_0xc1da20,_0x32f744=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x13f006;if(debugging)console[_0x8ed476(0x1a5)](_0x32f744);loggerfile[_0x8ed476(0x208)](util[_0x8ed476(0x1c2)](_0x32f744)+'\x0a');if(_0xdb03d1){if(debugging)console[_0x8ed476(0x1a5)](_0xdb03d1);loggerfile[_0x8ed476(0x208)](util['format'](_0xdb03d1)+'\x0a');}}};process['on'](_0xc1da20(0x1ad),function(_0x1f2df4){const _0x59b11d=_0xc1da20;logger[_0x59b11d(0x21f)](_0x1f2df4);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xc1da20(0x21c))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xc1da20(0x1d9)),app=express(),http=require(_0xc1da20(0x17e))[_0xc1da20(0x1ae)](app);app[_0xc1da20(0x1c4)](fileUpload({'useTempFiles':!![]})),app['get'](_0xc1da20(0x12b),async(_0x4b2a72,_0xa0378f)=>{const _0x374182=_0xc1da20,_0x11d334=_0x4b2a72[_0x374182(0x194)][_0x374182(0x1b5)],_0x355cfc=getClientsWithBotID(_0x374182(0x21a)),_0x51e1f9=_0x4b2a72[_0x374182(0x1cb)][_0x374182(0x184)],_0x538b95=timelyDecrypt(_0x51e1f9,![]),_0x42a6aa=_0x355cfc['find'](_0x26c01d=>_0x26c01d[_0x374182(0x184)]==_0x538b95);if(_0x42a6aa){const _0x1d9dc8=normalizeIP(_0x4b2a72[_0x374182(0x13d)]['remoteAddress'])[_0x374182(0x1fb)],_0x517cfb=_0x4b2a72[_0x374182(0x1cb)][_0x374182(0x1d4)];if(validateAccess(_0x517cfb,_0x538b95,_0x1d9dc8)[_0x374182(0x14b)])_0x11d334==_0x374182(0x24e)&&await backupConfigFiles(),await zipFiles(_0x11d334),_0xa0378f['download'](zippath+(_0x11d334+_0x374182(0x1fc)),_0x34d868=>{const _0x49db4f=_0x374182;_0x34d868&&(logger[_0x49db4f(0x2c8)]('Failed\x20to\x20download\x20'+_0x11d334),logger[_0x49db4f(0x21f)](_0x34d868));});else logger['full'](_0x374182(0x18a)+_0x11d334+_0x374182(0x175));}else logger[_0x374182(0x2c8)](_0x374182(0x18a)+_0x11d334+'\x20(2)');}),app[_0xc1da20(0x186)](_0xc1da20(0x1e6),async(_0x6e0923,_0x2cc7e4)=>{const _0x23d78d=_0xc1da20,_0xe558ee=getClientsWithBotID(_0x23d78d(0x21a)),_0x2891bc=_0x6e0923[_0x23d78d(0x1cb)][_0x23d78d(0x184)],_0x4eafba=timelyDecrypt(_0x2891bc,![]),_0x2da236=_0xe558ee[_0x23d78d(0x1d7)](_0x50d0ee=>_0x50d0ee[_0x23d78d(0x184)]==_0x4eafba);logger['debug']('Backup\x20file\x20uploaded');if(_0x2da236){const _0x50598d=normalizeIP(_0x6e0923['socket'][_0x23d78d(0x279)])[_0x23d78d(0x1fb)],_0x45dd8d=_0x6e0923[_0x23d78d(0x1cb)][_0x23d78d(0x1d4)];if(validateAccess(_0x45dd8d,_0x4eafba,_0x50598d)[_0x23d78d(0x14b)]){if(_0x6e0923['files']){const _0x2dc126=_0x6e0923[_0x23d78d(0x230)]['backupfile'];await _0x2dc126['mv'](temppath+_0x2dc126[_0x23d78d(0x137)]),_0x2cc7e4['send']({'status':!![],'message':_0x23d78d(0x15f)});const _0xa25617=getBotsWithMode();_0xa25617[_0x23d78d(0x12a)]>0x0?confirmRestore(temppath,_0x2dc126[_0x23d78d(0x137)]):unzipFile(temppath,_0x2dc126[_0x23d78d(0x137)]);}}else logger['full'](_0x23d78d(0x24d));}else logger['full'](_0x23d78d(0x266));}),app[_0xc1da20(0x1c4)](express[_0xc1da20(0x247)](path[_0xc1da20(0x1a9)](__dirname,bbpath2,_0xc1da20(0x2ce)))),app[_0xc1da20(0x1c4)](express['static'](path[_0xc1da20(0x1a9)](__dirname,bbpath2,_0xc1da20(0x209)))),app[_0xc1da20(0x2d4)]('/',function(_0x2ea38f,_0x3de14b){const _0x12b708=_0xc1da20;_0x3de14b[_0x12b708(0x27e)](path['join'](__dirname,bbpath2,_0x12b708(0x2ce),'index.html'));}),app[_0xc1da20(0x2d4)](_0xc1da20(0x2a9),function(_0x24380,_0x3489d1){const _0x107f81=_0xc1da20;_0x3489d1[_0x107f81(0x27e)](path[_0x107f81(0x1a9)](__dirname,bbpath2,_0x107f81(0x209),_0x107f81(0x162)));}),app['get'](_0xc1da20(0x1d2),(_0x24c251,_0xa8b3eb)=>{const _0x1a3563=_0xc1da20;_0xa8b3eb[_0x1a3563(0x27e)](path[_0x1a3563(0x1a9)](__dirname,bbpath2,_0x1a3563(0x209),'index.html'));}),app[_0xc1da20(0x2d4)](_0xc1da20(0x29f),(_0x495e24,_0x55f4a8)=>{const _0x4a4434=_0xc1da20;_0x55f4a8[_0x4a4434(0x27e)](path[_0x4a4434(0x1a9)](__dirname,bbpath2,_0x4a4434(0x209),_0x4a4434(0x162)));}),app[_0xc1da20(0x2d4)]('/:bot/coins',(_0x43ac7e,_0x6db03b)=>{const _0x129f8a=_0xc1da20;_0x6db03b[_0x129f8a(0x27e)](path[_0x129f8a(0x1a9)](__dirname,bbpath2,_0x129f8a(0x209),_0x129f8a(0x162)));}),app[_0xc1da20(0x2d4)](_0xc1da20(0x1f2),(_0x5a44e2,_0x1dfcf0)=>{const _0x258101=_0xc1da20;_0x1dfcf0[_0x258101(0x27e)](path['join'](__dirname,bbpath2,_0x258101(0x209),_0x258101(0x162)));}),app[_0xc1da20(0x2d4)]('/:bot/configuration',(_0x21affe,_0x311c39)=>{const _0xdfe403=_0xc1da20;_0x311c39[_0xdfe403(0x27e)](path[_0xdfe403(0x1a9)](__dirname,bbpath2,_0xdfe403(0x209),_0xdfe403(0x162)));}),app[_0xc1da20(0x2d4)]('/:bot/support',(_0x87a472,_0x35b4e8)=>{const _0x36ce24=_0xc1da20;_0x35b4e8['sendFile'](path[_0x36ce24(0x1a9)](__dirname,bbpath2,'build',_0x36ce24(0x162)));});if(HOST)http['listen'](PORT,HOST);else http[_0xc1da20(0x2d6)](PORT);const io=require(_0xc1da20(0x128))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x597991=_0xc1da20;logger[_0x597991(0x21f)](''),logger[_0x597991(0x21f)](_0x597991(0x207)),await logger[_0x597991(0x2c8)](_0x597991(0x140)+PORT),logger[_0x597991(0x21f)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x2613a1 of config){if(_0x2613a1[_0x597991(0x29a)]==_0x597991(0x21d)||_0x2613a1[_0x597991(0x29a)]==_0x597991(0x26b))await logger[_0x597991(0x2c8)](_0x597991(0x165)+_0x2613a1[_0x597991(0x276)]+_0x597991(0x17c)+_0x2613a1[_0x597991(0x25d)]),startBot([_0x2613a1[_0x597991(0x276)],userID],{'cwd':bbpath},function(_0x4f412e){const _0x44b9d9=_0x597991;if(_0x4f412e)logger[_0x44b9d9(0x2c8)](_0x4f412e);});else(_0x2613a1['status']==_0x597991(0x129)||_0x2613a1[_0x597991(0x29a)]==_0x597991(0x29e))&&await logger[_0x597991(0x2c8)](_0x597991(0x166)+_0x2613a1['botID']+'\x20|\x20'+_0x2613a1[_0x597991(0x25d)]);}else!newBot&&logger[_0x597991(0x21f)](_0x597991(0x197));if(newBot)addBot();logger[_0x597991(0x21f)]('-----------------------------------------------------------------------------------'),logger[_0x597991(0x21f)]('');}function startSocket(){const _0x3cd065=_0xc1da20;io['on'](_0x3cd065(0x1dd),_0x18a140=>{const _0x465510=_0x3cd065;let _0x11737f,_0x314c18,_0x4d3fc8,_0x43efd2,_0x3ec220;const _0x4da019=_0x18a140[_0x465510(0x176)][_0x465510(0x1cb)][_0x465510(0x1df)];_0x314c18=_0x4da019['match'](/bot[0-9]{3}/);if(_0x314c18)_0x4d3fc8=_0x314c18[0x0]['match'](/[0-9]{3}/);if(_0x4d3fc8)_0x11737f=_0x4d3fc8[0x0];else _0x11737f='botmanager';const _0x467de8=_0x18a140[_0x465510(0x176)]['auth'][_0x465510(0x213)];if(!_0x467de8)_0x18a140[_0x465510(0x219)]('status',{'publicKey':secure['publicKey']});else{_0x43efd2=timelyDecrypt(_0x467de8,![]);if(!_0x43efd2)_0x18a140[_0x465510(0x219)](_0x465510(0x29a),{'publicKey':secure[_0x465510(0x13f)]});else{_0x3ec220=normalizeIP(_0x18a140['conn'][_0x465510(0x279)])[_0x465510(0x1fb)];if(!devices[_0x43efd2])devices[_0x43efd2]={'uuid':_0x43efd2,'access':{'token':null}};devices[_0x43efd2]['ip']=_0x3ec220;const _0x497b8c=addClient(_0x18a140['id'],_0x43efd2,_0x11737f);setAccess(_0x497b8c),emitMessages(),_0x18a140['on'](_0x465510(0x280),_0x4c1056=>{const _0x7e5338=_0x465510,_0x4f876d=timelyDecrypt(_0x4c1056[_0x7e5338(0x121)]);if(_0x4f876d){_0x4c1056={'username':_0x4c1056[_0x7e5338(0x1d8)],'password':_0x4f876d},devices[_0x43efd2][_0x7e5338(0x26a)]=validateCredentials(_0x4c1056,_0x43efd2);if(devices[_0x43efd2][_0x7e5338(0x26a)][_0x7e5338(0x14b)]==![]&&devices[_0x43efd2][_0x7e5338(0x26a)][_0x7e5338(0x1b7)]==_0x7e5338(0x2ca))_0x18a140[_0x7e5338(0x219)](_0x7e5338(0x29a),{'access':devices[_0x43efd2][_0x7e5338(0x26a)]}),loginAccess2FA(_0x43efd2,_0x3ec220);else{if(devices[_0x43efd2][_0x7e5338(0x26a)]['allow']==![]&&devices[_0x43efd2][_0x7e5338(0x26a)][_0x7e5338(0x1b7)]==_0x7e5338(0x1a2))_0x18a140['emit'](_0x7e5338(0x29a),{'access':devices[_0x43efd2][_0x7e5338(0x26a)]});else devices[_0x43efd2][_0x7e5338(0x26a)][_0x7e5338(0x14b)]&&devices[_0x43efd2][_0x7e5338(0x26a)][_0x7e5338(0x1b7)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x43efd2)[_0x7e5338(0x2a4)](_0x4cf021=>{setAccess(_0x4cf021);}),logger[_0x7e5338(0x135)]('Logged\x20in\x20user\x20...'+_0x43efd2[_0x7e5338(0x22c)](-0x8)),setTokenRefresh(_0x43efd2),setSessionTimeout(_0x7e5338(0x280),_0x43efd2));}}else logger['full'](_0x7e5338(0x1ce));}),_0x18a140['on']('reset-password',()=>{resetPassword();}),_0x18a140['on'](_0x465510(0x1e1),_0xd8f01b=>{removeClient(_0x18a140['id']);}),_0x11737f==_0x465510(0x21a)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x128cfe){const _0x2badbc=_0xc1da20;if(_0x128cfe!=_0x2badbc(0x21a)&&config[_0x2badbc(0x164)]!=''){if(pid[_0x128cfe])pid[_0x128cfe]['send']({'function':_0x2badbc(0x11a),'args':null});}_0x128cfe!=_0x2badbc(0x21a)&&broadcastToBots(_0x2badbc(0x174),JSON[_0x2badbc(0x264)](config));}function reloadBotManager(){const _0x58b826=_0xc1da20;getClientsWithBotID(_0x58b826(0x21a))[_0x58b826(0x2a4)](_0x5d428a=>{const _0x577e2e=_0x58b826;getSocket(_0x5d428a['id'])[_0x577e2e(0x219)](_0x577e2e(0x29a),{'access':{'allow':![],'reason':_0x577e2e(0x24b),'token':null}});});}function getSocket(_0x4313d5){const _0x33facd=_0xc1da20;return io[_0x33facd(0x262)][_0x33facd(0x262)][_0x33facd(0x2d4)](_0x4313d5);}function setAccess(_0x58d154){const _0x4dd9af=_0xc1da20,_0x27c0ea=getSocket(_0x58d154['id']),_0x530477=_0x58d154['uuid'],_0xab2d5d=_0x58d154['bot'];devices[_0x530477][_0x4dd9af(0x26a)]=validateAccess(devices[_0x530477][_0x4dd9af(0x26a)][_0x4dd9af(0x119)],_0x530477),logger['debug']('Setting\x20access:\x20'+devices[_0x530477][_0x4dd9af(0x26a)][_0x4dd9af(0x1b7)]+_0x4dd9af(0x12f)+_0x58d154['id'][_0x4dd9af(0x22c)](-0x8)+_0x4dd9af(0x239)+_0x530477[_0x4dd9af(0x22c)](-0x8)),_0x27c0ea[_0x4dd9af(0x1a9)](_0x530477);if(devices[_0x530477][_0x4dd9af(0x26a)][_0x4dd9af(0x14b)]){_0x27c0ea['join'](_0xab2d5d);if(_0xab2d5d=='botmanager')initializeSocketBotManager(_0x27c0ea);else initializeSocketBot(_0x27c0ea);initClient(_0xab2d5d);}devices[_0x530477][_0x4dd9af(0x26a)][_0x4dd9af(0x119)]&&devices[_0x530477][_0x4dd9af(0x26a)][_0x4dd9af(0x1b7)]==_0x4dd9af(0x144)&&setSessionTimeout(_0x4dd9af(0x1ee),_0x530477),devices[_0x530477][_0x4dd9af(0x26a)]['token']&&devices[_0x530477][_0x4dd9af(0x26a)][_0x4dd9af(0x1b7)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4dd9af(0x280),_0x530477),_0x27c0ea[_0x4dd9af(0x219)](_0x4dd9af(0x29a),{'status':_0x58d154[_0x4dd9af(0x189)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x530477][_0x4dd9af(0x26a)],'externalip':devices[_0x530477]['ip'],'publicKey':secure[_0x4dd9af(0x13f)],'userid':settings[_0x4dd9af(0x11e)],'validInstallation':validInstallation}),devices[_0x530477]['access'][_0x4dd9af(0x14b)]==![]&&devices[_0x530477][_0x4dd9af(0x26a)]['reason']==_0x4dd9af(0x170)&&temporaryAccess2FA(_0x530477,devices[_0x530477]['ip']);}function setSessionTimeout(_0x1dfeb4,_0x4e1a67){const _0x2ab67e=_0xc1da20;let _0x1125d6;if(_0x1dfeb4==_0x2ab67e(0x280))_0x1125d6=loginExpiry*0x3c*0x3e8;else _0x1125d6=devices[_0x4e1a67][_0x2ab67e(0x25c)]['expiry']*0x3c*0x3e8-(new Date()[_0x2ab67e(0x126)]()-devices[_0x4e1a67][_0x2ab67e(0x25c)][_0x2ab67e(0x1d1)]);if(devices[_0x4e1a67]['pidExpireLogin'])clearTimeout(devices[_0x4e1a67][_0x2ab67e(0x19b)]);devices[_0x4e1a67][_0x2ab67e(0x19b)]=setTimeout(()=>{const _0x524c66=_0x2ab67e;if(devices[_0x4e1a67][_0x524c66(0x296)])clearTimeout(devices[_0x4e1a67]['pidRefreshToken']);removeSocketListeners(_0x4e1a67),addBlacklist(_0x4e1a67),devices[_0x4e1a67][_0x524c66(0x25c)]=null,devices[_0x4e1a67]['telegram2FaApproval']=null,devices[_0x4e1a67]['access']['token']=null,logger[_0x524c66(0x135)]('Session\x20expired\x20for\x20user\x20...'+_0x4e1a67[_0x524c66(0x22c)](-0x8)),devices[_0x4e1a67][_0x524c66(0x26a)]=validateAccess(devices[_0x4e1a67][_0x524c66(0x26a)]['token'],_0x4e1a67),!(devices[_0x4e1a67][_0x524c66(0x26a)][_0x524c66(0x14b)]&&devices[_0x4e1a67][_0x524c66(0x26a)][_0x524c66(0x1b7)]=='login\x20not\x20required')&&(_0x1dfeb4==_0x524c66(0x280)?io['to'](_0x4e1a67)[_0x524c66(0x219)](_0x524c66(0x29a),{'access':{'allow':![],'reason':_0x524c66(0x2ae),'token':null}}):io['to'](_0x4e1a67)[_0x524c66(0x219)]('status',{'access':{'allow':![],'reason':_0x524c66(0x14e),'token':null}})),devices[_0x4e1a67][_0x524c66(0x26a)][_0x524c66(0x119)]=null;},_0x1125d6);}function setTokenRefresh(_0x1b5e4f){const _0x2eba68=_0xc1da20;if(devices[_0x1b5e4f][_0x2eba68(0x296)])clearTimeout(devices[_0x1b5e4f]['pidRefreshToken']);devices[_0x1b5e4f]['pidRefreshToken']=setTimeout(()=>{const _0x17e77e=_0x2eba68;getClientsWithUuid(_0x1b5e4f)[_0x17e77e(0x12a)]!=0x0?(devices[_0x1b5e4f][_0x17e77e(0x26a)]=refreshToken(_0x1b5e4f),io['to'](_0x1b5e4f)[_0x17e77e(0x219)]('status',{'status':_0x17e77e(0x20f),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1b5e4f][_0x17e77e(0x26a)],'externalip':devices[_0x1b5e4f]['ip'],'publicKey':secure[_0x17e77e(0x13f)],'validInstallation':validInstallation}),setTokenRefresh(_0x1b5e4f)):clearTimeout(devices[_0x1b5e4f]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x61c2be){const _0x3d902f=_0xc1da20,_0xdc0a16=getClient(_0x61c2be['id'])[_0x3d902f(0x184)];_0x61c2be[_0x3d902f(0x219)](_0x3d902f(0x174),config),_0x61c2be[_0x3d902f(0x219)]('settings',cleanSettings()),_0x61c2be['on']('add-bot',_0x12efb9=>{const _0x50e474=_0x3d902f;if(validateAccess(_0x12efb9,_0xdc0a16)['allow'])addBot();else logger['full'](_0x50e474(0x19d));}),_0x61c2be['on']('update-bot',(_0x42450c,_0xf06145)=>{const _0x3552e1=_0x3d902f;if(validateAccess(_0xf06145,_0xdc0a16)['allow'])toggleBot(_0x42450c[_0x3552e1(0x276)],_0x42450c[_0x3552e1(0x29a)],_0x42450c[_0x3552e1(0x222)]);else logger[_0x3552e1(0x2c8)](_0x3552e1(0x19a));}),_0x61c2be['on'](_0x3d902f(0x215),(_0x489726,_0x5a3dfe)=>{const _0x21cc39=_0x3d902f;if(validateAccess(_0x5a3dfe,_0xdc0a16)[_0x21cc39(0x14b)])toggleBotMode(_0x489726);else logger[_0x21cc39(0x2c8)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x61c2be['on'](_0x3d902f(0x142),(_0x5281e3,_0x3501b0)=>{const _0x48ef43=_0x3d902f;if(validateAccess(_0x3501b0,_0xdc0a16)['allow'])deleteBot(_0x5281e3);else logger['full'](_0x48ef43(0x191));}),_0x61c2be['on'](_0x3d902f(0x2b7),(_0x1497cd,_0x356442)=>{const _0x9ef8c2=_0x3d902f;if(validateAccess(_0x356442,_0xdc0a16)[_0x9ef8c2(0x14b)])storeSettings(_0x1497cd,!![]);else logger[_0x9ef8c2(0x2c8)](_0x9ef8c2(0x18f));}),_0x61c2be['on'](_0x3d902f(0x138),_0x25f7f7=>{const _0x19e012=_0x3d902f;if(validateAccess(_0x25f7f7,_0xdc0a16)[_0x19e012(0x14b)])updateBB('update');else logger[_0x19e012(0x2c8)](_0x19e012(0x132));}),_0x61c2be['on'](_0x3d902f(0x2b8),_0x2c71d7=>{const _0x4edf2a=_0x3d902f;if(validateAccess(_0x2c71d7,_0xdc0a16)[_0x4edf2a(0x14b)])updateBB('reinstall');else logger[_0x4edf2a(0x2c8)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x61c2be['on'](_0x3d902f(0x1b3),_0x15e05b=>{const _0x4dc863=_0x3d902f;if(validateAccess(_0x15e05b,_0xdc0a16)[_0x4dc863(0x14b)]){const _0x355b01=getClient(_0x61c2be['id']);if(_0x355b01)getBackupFiles(_0x355b01[_0x4dc863(0x184)]);else logger[_0x4dc863(0x2c8)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x4dc863(0x2c8)](_0x4dc863(0x272));}),_0x61c2be['on'](_0x3d902f(0x242),(_0x1cc954,_0x2b46d6)=>{if(validateAccess(_0x2b46d6,_0xdc0a16)['allow'])restoreBackupFile(_0x1cc954);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x61c2be['on'](_0x3d902f(0x29c),_0x46b67b=>{const _0x30fab6=_0x3d902f;if(validateAccess(_0x46b67b,_0xdc0a16)[_0x30fab6(0x14b)])getMessages();else logger[_0x30fab6(0x2c8)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x61c2be['on'](_0x3d902f(0x17b),(_0x554427,_0x301ded)=>{const _0x5b91e8=_0x3d902f;if(validateAccess(_0x301ded,_0xdc0a16)['allow'])confirmMessage(_0x554427);else logger[_0x5b91e8(0x2c8)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x61c2be['on'](_0x3d902f(0x278),_0x268d5e=>{const _0x52301e=_0x3d902f;if(validateAccess(_0x268d5e,_0xdc0a16)[_0x52301e(0x14b)]){if(devices[_0xdc0a16]['pidRefreshToken'])clearTimeout(devices[_0xdc0a16][_0x52301e(0x296)]);if(devices[_0xdc0a16][_0x52301e(0x19b)])clearTimeout(devices[_0xdc0a16][_0x52301e(0x19b)]);removeSocketListeners(getClient(_0x61c2be['id'])['uuid']),addBlacklist(_0xdc0a16),devices[_0xdc0a16][_0x52301e(0x25c)]=null,devices[_0xdc0a16][_0x52301e(0x167)]=null,devices[_0xdc0a16][_0x52301e(0x26a)][_0x52301e(0x119)]=null,logger[_0x52301e(0x135)](_0x52301e(0x27b)+_0xdc0a16['slice'](-0x8)),io['to'](getClient(_0x61c2be['id'])['uuid'])['emit'](_0x52301e(0x29a),{'access':{'allow':![],'reason':_0x52301e(0x1a7),'token':null}});}else logger[_0x52301e(0x2c8)](_0x52301e(0x23e));});}function initializeSocketBot(_0x1fd79c){const _0x4de54b=_0xc1da20,_0x4c5c76=getClient(_0x1fd79c['id'])[_0x4de54b(0x1c1)],_0x513fd8=getClient(_0x1fd79c['id'])['uuid'];_0x1fd79c['on'](_0x4de54b(0x2c7),(_0x1728a4,_0xb6dce6)=>{const _0x3bccde=_0x4de54b;if(validateAccess(_0xb6dce6,_0x513fd8)[_0x3bccde(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x3bccde(0x232)]({'function':_0x3bccde(0x178),'args':_0x1728a4});}else logger[_0x3bccde(0x2c8)](_0x3bccde(0x198));}),_0x1fd79c['on']('delete-alerts',(_0x4f40b2,_0x10da11)=>{const _0x5f5009=_0x4de54b;if(validateAccess(_0x10da11,_0x513fd8)[_0x5f5009(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x5f5009(0x232)]({'function':_0x5f5009(0x151),'args':_0x4f40b2});}else logger[_0x5f5009(0x2c8)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x1fd79c['on'](_0x4de54b(0x1eb),(_0x2dad99,_0x2ff250)=>{const _0x5956d7=_0x4de54b;if(validateAccess(_0x2ff250,_0x513fd8)[_0x5956d7(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x5956d7(0x232)]({'function':_0x5956d7(0x1d6),'args':_0x2dad99});}else logger[_0x5956d7(0x2c8)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1fd79c['on'](_0x4de54b(0x217),(_0x58c52e,_0x18d1d9)=>{const _0x23bb25=_0x4de54b;if(validateAccess(_0x18d1d9,_0x513fd8)[_0x23bb25(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x23bb25(0x232)]({'function':'storeConfiguration','args':_0x58c52e});}else logger['full'](_0x23bb25(0x235));}),_0x1fd79c['on'](_0x4de54b(0x1f4),(_0x39ea12,_0x9e709a)=>{const _0x4aa684=_0x4de54b;if(validateAccess(_0x9e709a,_0x513fd8)[_0x4aa684(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x4aa684(0x232)]({'function':_0x4aa684(0x240),'args':_0x39ea12});}else logger[_0x4aa684(0x2c8)](_0x4aa684(0x14c));}),_0x1fd79c['on']('store-fiat',(_0x171469,_0x27ed7a)=>{const _0x43fd62=_0x4de54b;if(validateAccess(_0x27ed7a,_0x513fd8)[_0x43fd62(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x43fd62(0x232)]({'function':_0x43fd62(0x2a8),'args':_0x171469});}else logger[_0x43fd62(0x2c8)](_0x43fd62(0x1b6));}),_0x1fd79c['on'](_0x4de54b(0x13a),_0x42247a=>{const _0x248d14=_0x4de54b;if(validateAccess(_0x42247a,_0x513fd8)[_0x248d14(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x248d14(0x232)]({'function':_0x248d14(0x2a0),'args':null});}else logger[_0x248d14(0x2c8)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x1fd79c['on'](_0x4de54b(0x15c),_0x264fd4=>{const _0x441ffe=_0x4de54b;if(validateAccess(_0x264fd4,_0x513fd8)[_0x441ffe(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x441ffe(0x232)]({'function':_0x441ffe(0x155),'args':null});}else logger[_0x441ffe(0x2c8)](_0x441ffe(0x2b6));}),_0x1fd79c['on'](_0x4de54b(0x292),(_0x3b03d8,_0x2e99b1)=>{const _0x2357cc=_0x4de54b;if(validateAccess(_0x2e99b1,_0x513fd8)[_0x2357cc(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x2357cc(0x232)]({'function':'placeOrder','args':_0x3b03d8});}else logger['full'](_0x2357cc(0x1b2));}),_0x1fd79c['on'](_0x4de54b(0x187),_0x3fa009=>{const _0x5c435c=_0x4de54b;if(validateAccess(_0x3fa009,_0x513fd8)[_0x5c435c(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76]['send']({'function':'cancelLoading','args':null});}else logger[_0x5c435c(0x2c8)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x1fd79c['on'](_0x4de54b(0x1b9),_0x323382=>{const _0x177619=_0x4de54b;if(validateAccess(_0x323382,_0x513fd8)[_0x177619(0x14b)]){if(pid[_0x4c5c76])pid[_0x4c5c76][_0x177619(0x232)]({'function':_0x177619(0x2cf),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x1fd79c['on'](_0x4de54b(0x138),_0x467231=>{const _0x5362e0=_0x4de54b;if(validateAccess(_0x467231,_0x513fd8)[_0x5362e0(0x14b)])updateBB(_0x5362e0(0x238));else logger[_0x5362e0(0x2c8)](_0x5362e0(0x132));}),_0x1fd79c['on'](_0x4de54b(0x29c),_0x41b46d=>{const _0xfb0801=_0x4de54b;if(validateAccess(_0x41b46d,_0x513fd8)[_0xfb0801(0x14b)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1fd79c['on'](_0x4de54b(0x17b),(_0x7ff0f2,_0x26d2ef)=>{const _0xc86ee4=_0x4de54b;if(validateAccess(_0x26d2ef,_0x513fd8)[_0xc86ee4(0x14b)])confirmMessage(_0x7ff0f2);else logger[_0xc86ee4(0x2c8)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1fd79c['on'](_0x4de54b(0x278),_0x4c0bd5=>{const _0x1435aa=_0x4de54b;if(validateAccess(_0x4c0bd5,_0x513fd8)[_0x1435aa(0x14b)]){if(devices[_0x513fd8][_0x1435aa(0x296)])clearTimeout(devices[_0x513fd8]['pidRefreshToken']);if(devices[_0x513fd8][_0x1435aa(0x19b)])clearTimeout(devices[_0x513fd8]['pidExpireLogin']);removeSocketListeners(getClient(_0x1fd79c['id'])['uuid']),addBlacklist(_0x513fd8),devices[_0x513fd8]['telegramIpApproval']=null,devices[_0x513fd8]['telegram2FaApproval']=null,devices[_0x513fd8][_0x1435aa(0x26a)][_0x1435aa(0x119)]=null,logger['debug'](_0x1435aa(0x27b)+_0x513fd8[_0x1435aa(0x22c)](-0x8)),io['to'](getClient(_0x1fd79c['id'])[_0x1435aa(0x184)])[_0x1435aa(0x219)](_0x1435aa(0x29a),{'access':{'allow':![],'reason':_0x1435aa(0x1a7),'token':null}});}else logger[_0x1435aa(0x2c8)](_0x1435aa(0x23e));});}function removeSocketListeners(_0x10aa2c){const _0x329037=_0xc1da20;getClientsWithUuid(_0x10aa2c)[_0x329037(0x2a4)](_0xb69d59=>{getSocket(_0xb69d59['id'])['removeAllListeners']();});}function cleanSettings(){const _0x489c3e=_0xc1da20;let _0x4fc86f=settings;return settings[_0x489c3e(0x271)]&&settings[_0x489c3e(0x271)]!=''&&(_0x4fc86f={..._0x4fc86f,'telegramToken':_0x489c3e(0x1a1)}),settings[_0x489c3e(0x1af)]&&settings['bbPassword']!=''&&(_0x4fc86f={..._0x4fc86f,'bbPassword':'************'}),(settings[_0x489c3e(0x1af)]&&settings[_0x489c3e(0x1af)]==_0x489c3e(0x143)||settings[_0x489c3e(0x271)]&&settings[_0x489c3e(0x271)]==_0x489c3e(0x143))&&(_0x4fc86f={..._0x4fc86f,'restored':{'password':settings[_0x489c3e(0x1af)]==_0x489c3e(0x143),'telegram':settings[_0x489c3e(0x271)]==_0x489c3e(0x143)}}),_0x4fc86f;}async function updateBB(_0x350fb0){const _0x2c855e=_0xc1da20;await backupConfigFiles(),installingUpdate=!![],config[_0x2c855e(0x2a4)](_0x2d1e78=>{restartBot(_0x2d1e78['botID']);}),logger[_0x2c855e(0x135)]('Starting\x20Balance\x20Bot\x20'+_0x350fb0);if(_0x350fb0=='update')process[_0x2c855e(0x232)]({'update':!![]},_0x4fc1a0=>{});else _0x350fb0==_0x2c855e(0x2be)&&process[_0x2c855e(0x232)]({'reinstall':!![]},_0x9899bb=>{});}function startBot(_0x2d18d0,_0x4b4955,_0x50a027){const _0x38887e=_0xc1da20;if(debugging)_0x2d18d0[_0x38887e(0x141)]('-d');let _0x39c9da=![];const _0x48f95f=_0x2d18d0[0x0];_0x4b4955={..._0x4b4955,'stdio':['inherit',_0x38887e(0x1fe),_0x38887e(0x1fe),_0x38887e(0x192)]},pid[_0x48f95f]=childProcess['fork'](botfile,_0x2d18d0,_0x4b4955),pid[_0x48f95f]['on'](_0x38887e(0x2a6),_0x257692=>{const _0x56a6d3=_0x38887e;switch(Object[_0x56a6d3(0x254)](_0x257692)[0x0]){case _0x56a6d3(0x25d):updateBotName(_0x48f95f,_0x257692[_0x56a6d3(0x25d)]);break;case'updatebotmanager':updateBotManager();break;case _0x56a6d3(0x29a):updateStatus(_0x48f95f,_0x257692[_0x56a6d3(0x29a)]);break;case _0x56a6d3(0x222):updateLive(_0x48f95f,_0x257692[_0x56a6d3(0x222)]);break;case _0x56a6d3(0x163):updateLive(_0x48f95f,_0x257692['started']),io['to'](_0x48f95f)[_0x56a6d3(0x219)]('status',{'access':{'allow':![],'reason':_0x56a6d3(0x24b),'token':null}});break;case _0x56a6d3(0x18e):_0x257692[_0x56a6d3(0x18e)]==_0x56a6d3(0x234)&&restartBot(_0x48f95f);_0x257692['stop']==_0x56a6d3(0x16d)&&toggleBot(_0x48f95f,_0x56a6d3(0x129),_0x56a6d3(0x193));break;case'telegram':sendTelegram(_0x48f95f,_0x257692[_0x56a6d3(0x2c2)]);break;case _0x56a6d3(0x120):sendTelegramMsg(_0x257692[_0x56a6d3(0x120)]);break;case _0x56a6d3(0x270):io['to'](_0x48f95f)[_0x56a6d3(0x219)](_0x257692[_0x56a6d3(0x270)],_0x257692[_0x56a6d3(0x1b8)]);break;}}),pid[_0x48f95f]['on'](_0x38887e(0x1f9),function(_0x3a6f93){if(_0x39c9da)return;_0x39c9da=!![],_0x50a027(_0x3a6f93);}),pid[_0x48f95f]['on'](_0x38887e(0x245),async function(_0x4f2171){const _0x56638d=_0x38887e;if(installingUpdate)return;if(_0x39c9da)return;_0x39c9da=!![],_0x50a027(null);const _0x253f08=dbConfig[_0x56638d(0x2d4)](_0x56638d(0x174))[_0x56638d(0x1d7)]({'botID':_0x48f95f})[_0x56638d(0x286)]();_0x253f08&&(_0x253f08[_0x56638d(0x29a)]==_0x56638d(0x21d)||_0x253f08[_0x56638d(0x29a)]==_0x56638d(0x26b))&&(await sleep(0x3e8),updateLive(_0x48f95f,_0x56638d(0x193)),logger[_0x56638d(0x2c8)]('Restarting\x20Bot\x20'+_0x48f95f),startBot([_0x48f95f,userID],{'cwd':bbpath},function(_0x374aee){const _0x1771b9=_0x56638d;if(_0x374aee)logger[_0x1771b9(0x2c8)](_0x374aee);}));});}function stopBot(_0x31ec3d){const _0x694a78=_0xc1da20;getClientsWithBotID(_0x31ec3d)['forEach'](_0x517806=>{const _0xa4a99=_0x509a;getSocket(_0x517806['id'])[_0xa4a99(0x1e1)](!![]),removeClient(_0x517806['id']);}),pid[_0x31ec3d]&&(pid[_0x31ec3d][_0x694a78(0x16d)](),pid[_0x31ec3d]=null);}function restartBot(_0x151476){const _0x545f4c=_0xc1da20;if(pid[_0x151476])pid[_0x151476][_0x545f4c(0x16d)]();}function addBot(){const _0x49cda4=_0xc1da20;let _0x4bb686;for(let _0x706101=0x1;_0x706101<0x3e9;_0x706101++){_0x4bb686=_0x706101[_0x49cda4(0x216)]()['padStart'](0x3,'0');let _0x10a831=config['find'](_0x408be4=>_0x408be4[_0x49cda4(0x276)]==_0x4bb686);if(!_0x10a831)break;}if(_0x4bb686==='1000'){logger['full'](_0x49cda4(0x2b9));return;}logger[_0x49cda4(0x2c8)](_0x49cda4(0x2c1)+_0x4bb686),dbConfig[_0x49cda4(0x2d4)](_0x49cda4(0x174))[_0x49cda4(0x141)]({'botID':_0x4bb686,'botname':'Bot\x20'+_0x4bb686,'status':_0x49cda4(0x26b),'live':''})[_0x49cda4(0x208)](),startBot([_0x4bb686,userID],{'cwd':bbpath},function(_0x48833e){if(_0x48833e)logger['full'](_0x48833e);}),config=getConfiguration(),io['to'](_0x49cda4(0x21a))[_0x49cda4(0x219)](_0x49cda4(0x174),config),broadcastToBots(_0x49cda4(0x174),JSON[_0x49cda4(0x264)](config));}function deleteBot(_0x51f880){const _0x5166a9=_0xc1da20;getClientsWithBotID(_0x51f880)['forEach'](_0x1e5447=>{const _0x183276=_0x509a;getSocket(_0x1e5447['id'])[_0x183276(0x1e1)](!![]),removeClient(_0x1e5447['id']);}),dbConfig[_0x5166a9(0x2d4)](_0x5166a9(0x174))[_0x5166a9(0x12c)]({'botID':_0x51f880})['write'](),logger[_0x5166a9(0x2c8)](_0x5166a9(0x16c)+_0x51f880),stopBot(_0x51f880);try{if(fs[_0x5166a9(0x1d5)](path[_0x5166a9(0x1a9)](configpath,_0x5166a9(0x224)+_0x51f880+_0x5166a9(0x23a))))fs[_0x5166a9(0x1e8)](path[_0x5166a9(0x1a9)](configpath,_0x5166a9(0x224)+_0x51f880+'-config.json'));if(fs[_0x5166a9(0x1d5)](path[_0x5166a9(0x1a9)](configpath,_0x5166a9(0x224)+_0x51f880+'-events.json')))fs[_0x5166a9(0x1e8)](path['join'](configpath,_0x5166a9(0x224)+_0x51f880+_0x5166a9(0x293)));if(fs['existsSync'](path[_0x5166a9(0x1a9)](configpath,_0x5166a9(0x224)+_0x51f880+'-performance.json')))fs['unlinkSync'](path[_0x5166a9(0x1a9)](configpath,_0x5166a9(0x224)+_0x51f880+_0x5166a9(0x123)));if(fs[_0x5166a9(0x1d5)](path['join'](configpath,_0x5166a9(0x224)+_0x51f880+_0x5166a9(0x287))))fs[_0x5166a9(0x1e8)](path[_0x5166a9(0x1a9)](configpath,_0x5166a9(0x224)+_0x51f880+_0x5166a9(0x287)));}catch(_0x3cdc2d){if(_0x3cdc2d)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x3cdc2d);}config=getConfiguration(),io['to'](_0x5166a9(0x21a))[_0x5166a9(0x219)](_0x5166a9(0x174),config),broadcastToBots(_0x5166a9(0x174),JSON[_0x5166a9(0x264)](config));}function toggleBot(_0x39696e,_0x1acd6b,_0x3f16b3){const _0x44fa20=_0xc1da20;dbConfig[_0x44fa20(0x2d4)]('bots')['find']({'botID':_0x39696e})['assign']({'status':_0x1acd6b})[_0x44fa20(0x1f0)]({'live':_0x3f16b3})[_0x44fa20(0x208)]();if(_0x1acd6b==_0x44fa20(0x21d)||_0x1acd6b=='new')logger['full'](_0x44fa20(0x133)+_0x39696e),startBot([_0x39696e,userID],{'cwd':bbpath},function(_0x276ba8){const _0x3ffd0b=_0x44fa20;if(_0x276ba8)logger[_0x3ffd0b(0x2c8)](_0x276ba8);});else(_0x1acd6b==_0x44fa20(0x129)||_0x1acd6b==_0x44fa20(0x29e))&&(logger['full']('Disabled\x20Bot\x20'+_0x39696e),stopBot(_0x39696e));config=getConfiguration(),io['to'](_0x44fa20(0x21a))[_0x44fa20(0x219)](_0x44fa20(0x174),config),broadcastToBots('bots',JSON[_0x44fa20(0x264)](config));}function toggleStatus(_0x30ae2c){const _0x4a4619=_0xc1da20;let _0x5b4018=dbConfig[_0x4a4619(0x2d4)](_0x4a4619(0x174))['find']({'botID':_0x30ae2c})[_0x4a4619(0x286)](),_0x42170a;if(_0x5b4018[_0x4a4619(0x29a)]==='enabled')_0x42170a='disabled';else{if(_0x5b4018[_0x4a4619(0x29a)]==='new')_0x42170a=_0x4a4619(0x29e);else{if(_0x5b4018[_0x4a4619(0x29a)]===_0x4a4619(0x29e))_0x42170a=_0x4a4619(0x26b);else{if(_0x5b4018[_0x4a4619(0x29a)]===_0x4a4619(0x129))_0x42170a=_0x4a4619(0x21d);}}}return _0x42170a;}function updateStatus(_0x19aa15,_0x24fd13){const _0x15ccd9=_0xc1da20;dbConfig[_0x15ccd9(0x2d4)](_0x15ccd9(0x174))[_0x15ccd9(0x1d7)]({'botID':_0x19aa15})[_0x15ccd9(0x1f0)]({'status':_0x24fd13})['write'](),config=getConfiguration(),io['to'](_0x15ccd9(0x21a))[_0x15ccd9(0x219)](_0x15ccd9(0x174),config),broadcastToBots('bots',JSON[_0x15ccd9(0x264)](config));}function updateLive(_0x36b640,_0x3695c1){const _0x5209b5=_0xc1da20;dbConfig[_0x5209b5(0x2d4)](_0x5209b5(0x174))['find']({'botID':_0x36b640})[_0x5209b5(0x1f0)]({'live':_0x3695c1})[_0x5209b5(0x208)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x5209b5(0x174),config),broadcastToBots(_0x5209b5(0x174),JSON['stringify'](config));}function updateBotName(_0x366240,_0x556210){const _0x309ba2=_0xc1da20;dbConfig[_0x309ba2(0x2d4)](_0x309ba2(0x174))[_0x309ba2(0x1d7)]({'botID':_0x366240})[_0x309ba2(0x1f0)]({'botname':_0x556210})[_0x309ba2(0x208)](),config=getConfiguration(),io['to'](_0x309ba2(0x21a))[_0x309ba2(0x219)](_0x309ba2(0x174),config),broadcastToBots(_0x309ba2(0x174),JSON[_0x309ba2(0x264)](config));}function updateBotManager(){const _0x505b3a=_0xc1da20;config=getConfiguration(),io['to'](_0x505b3a(0x21a))[_0x505b3a(0x219)](_0x505b3a(0x174),config),broadcastToBots(_0x505b3a(0x174),JSON[_0x505b3a(0x264)](config));}function toggleBotMode(_0x234fc3){const _0x4481c1=_0xc1da20;if(pid[_0x234fc3])pid[_0x234fc3]['send']({'function':'toggleBotMode','args':null});else{const _0x2694d8=configpath+_0x4481c1(0x224)+_0x234fc3+_0x4481c1(0x23a),_0x5a384d=fs[_0x4481c1(0x134)](_0x2694d8),_0xd6bd33=JSON[_0x4481c1(0x246)](_0x5a384d),_0x4a1d67=_0xd6bd33[_0x4481c1(0x1c1)][0x0][_0x4481c1(0x158)];_0xd6bd33[_0x4481c1(0x1c1)][0x0][_0x4481c1(0x158)]=!_0x4a1d67;const _0x5d9a28=JSON['stringify'](_0xd6bd33,null,0x2);fs['writeFileSync'](_0x2694d8,_0x5d9a28),config=getConfiguration(),io['to'](_0x4481c1(0x21a))[_0x4481c1(0x219)](_0x4481c1(0x174),config),broadcastToBots(_0x4481c1(0x174),JSON[_0x4481c1(0x264)](config));}}function telegramError(_0x5b245e){const _0x278ce5=_0xc1da20;logger[_0x278ce5(0x21f)](getTimeStamp()+_0x278ce5(0x159));}function validateTelegram(_0x50d2a5){const _0x5c4a8f=_0xc1da20;if(_0x50d2a5[_0x5c4a8f(0x2c0)][_0x5c4a8f(0x1d8)]!=settings['telegramUsername']&&'@'+_0x50d2a5['from'][_0x5c4a8f(0x1d8)]!=settings[_0x5c4a8f(0x26f)])return tgBot[_0x5c4a8f(0x2c3)](_0x50d2a5['chat']['id'],_0x5c4a8f(0x21e),{'parse_mode':_0x5c4a8f(0x199)})['catch'](_0x592459=>{telegramError(_0x592459);}),![];return!![];}async function initTelegram(){const _0x518a2a=_0xc1da20;if(tgBot)tgBot[_0x518a2a(0x24c)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x518a2a(0x271)],{'polling':!![]});let _0x308262=_0x518a2a(0x281);_0x308262+='\x0a',_0x308262+=_0x518a2a(0x231),_0x308262+='/disable\x20-\x20disable\x20notifications\x0a',_0x308262+=_0x518a2a(0x1c5),_0x308262+=_0x518a2a(0x152),_0x308262+=_0x518a2a(0x2bc),_0x308262+='/off\x20-\x20stop\x20bot(s)\x0a',_0x308262+=_0x518a2a(0x22f),_0x308262+=_0x518a2a(0x11f),_0x308262+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x308262+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x308262+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x308262+=_0x518a2a(0x160),_0x308262+=_0x518a2a(0x225),_0x308262+=_0x518a2a(0x26d);let _0xf2ea2e='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0xf2ea2e+='\x0a',_0xf2ea2e+=_0x308262,tgBot[_0x518a2a(0x1a4)](/\/start/,_0x5b7088=>{const _0x56f0fe=_0x518a2a;if(!validateTelegram(_0x5b7088))return;if(settings[_0x56f0fe(0x196)]!=_0x5b7088['chat']['id'])updateSetting(_0x56f0fe(0x196),_0x5b7088['chat']['id']);updateSetting(_0x56f0fe(0x23c),!![]),tgBot[_0x56f0fe(0x2c3)](_0x5b7088[_0x56f0fe(0x185)]['id'],_0xf2ea2e)[_0x56f0fe(0x18c)](_0x509536=>{telegramError(_0x509536);});}),tgBot['onText'](/\/enable/,_0x84099f=>{const _0x5b3ca0=_0x518a2a;if(!validateTelegram(_0x84099f))return;if(settings[_0x5b3ca0(0x196)]!=_0x84099f[_0x5b3ca0(0x185)]['id'])updateSetting(_0x5b3ca0(0x196),_0x84099f[_0x5b3ca0(0x185)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x5b3ca0(0x2c3)](_0x84099f['chat']['id'],_0x5b3ca0(0x285))[_0x5b3ca0(0x18c)](_0x2cbe25=>{telegramError(_0x2cbe25);});}),tgBot['onText'](/\/config/,async _0x5e5569=>{const _0x208ea4=_0x518a2a;if(!validateTelegram(_0x5e5569))return;tgBot['removeListener'](_0x208ea4(0x2bd)),tgBot[_0x208ea4(0x2c3)](_0x5e5569['chat']['id'],_0x208ea4(0x16e),{'reply_markup':{'inline_keyboard':[[{'text':_0x208ea4(0x255),'callback_data':'orders'},{'text':_0x208ea4(0x283),'callback_data':_0x208ea4(0x249)},{'text':_0x208ea4(0x1ba),'callback_data':'all'}]]}})[_0x208ea4(0x18c)](_0x369b88=>{telegramError(_0x369b88);}),tgBot['on'](_0x208ea4(0x2bd),async _0xd06ed7=>{const _0x268aeb=_0x208ea4,_0x3266de=_0xd06ed7[_0x268aeb(0x15e)],_0x16a99b=_0xd06ed7[_0x268aeb(0x2a6)];tgBot[_0x268aeb(0x233)](_0xd06ed7['id'])[_0x268aeb(0x150)](async()=>{const _0x5994bf=_0x268aeb;_0x3266de==_0x5994bf(0x250)&&(updateSetting('telegramEvents','orders'),updateSetting(_0x5994bf(0x23c),!![]),await tgBot[_0x5994bf(0x2c3)](_0x16a99b[_0x5994bf(0x185)]['id'],_0x5994bf(0x259))[_0x5994bf(0x18c)](_0x4ad9a5=>{telegramError(_0x4ad9a5);}));_0x3266de==_0x5994bf(0x249)&&(updateSetting('telegramEvents',_0x5994bf(0x249)),updateSetting('telegramEnabled',!![]),await tgBot[_0x5994bf(0x2c3)](_0x16a99b[_0x5994bf(0x185)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x5994bf(0x18c)](_0x2a9d45=>{telegramError(_0x2a9d45);}));_0x3266de==_0x5994bf(0x147)&&(updateSetting(_0x5994bf(0x2ba),_0x5994bf(0x147)),updateSetting(_0x5994bf(0x23c),!![]),await tgBot[_0x5994bf(0x2c3)](_0x16a99b[_0x5994bf(0x185)]['id'],_0x5994bf(0x201))['catch'](_0x401b27=>{telegramError(_0x401b27);}));if(!settings[_0x5994bf(0x196)])tgBot[_0x5994bf(0x2c3)](_0x16a99b[_0x5994bf(0x185)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x5994bf(0x18c)](_0x2cbfcd=>{telegramError(_0x2cbfcd);});}),tgBot[_0x268aeb(0x1c8)](_0x268aeb(0x2bd));});}),tgBot['onText'](/\/status/,_0x583ea8=>{const _0x3ef7f6=_0x518a2a;if(!validateTelegram(_0x583ea8))return;const _0x5a1cfe=getBotsWithMode();let _0x252496=_0x3ef7f6(0x171);config[_0x3ef7f6(0x2a4)](_0x3517b0=>{const _0x2308ef=_0x3ef7f6,_0x4e26a9=_0x5a1cfe[_0x2308ef(0x1d7)](_0x42879f=>_0x42879f[_0x2308ef(0x276)]==_0x3517b0[_0x2308ef(0x276)])[_0x2308ef(0x1a3)];_0x252496+=_0x2308ef(0x275)+_0x3517b0[_0x2308ef(0x276)]+':\x20'+_0x3517b0[_0x2308ef(0x29a)]+_0x2308ef(0x17c)+_0x4e26a9+'\x20|\x20'+_0x3517b0[_0x2308ef(0x222)]+'\x0a';}),_0x252496+='\x0a',_0x252496+=_0x3ef7f6(0x253),_0x252496+=!settings['telegramEnabled']?_0x3ef7f6(0x212):'Notifications\x20enabled\x0a',_0x252496+=settings[_0x3ef7f6(0x23c)]?settings[_0x3ef7f6(0x2ba)]=='all'?_0x3ef7f6(0x1de):_0x3ef7f6(0x261)+settings[_0x3ef7f6(0x2ba)]+'\x20only\x0a':'',tgBot[_0x3ef7f6(0x2c3)](_0x583ea8[_0x3ef7f6(0x185)]['id'],_0x252496,{'parse_mode':_0x3ef7f6(0x199)})['catch'](_0x2601ab=>{telegramError(_0x2601ab);});}),tgBot[_0x518a2a(0x1a4)](/\/restart/,_0x428129=>{const _0x4fc66d=_0x518a2a;if(!validateTelegram(_0x428129))return;tgBot[_0x4fc66d(0x1c8)](_0x4fc66d(0x2bd));const _0x310a6a=getEnabledBots();if(_0x310a6a[_0x4fc66d(0x12a)]==0x0)tgBot[_0x4fc66d(0x2c3)](_0x428129['chat']['id'],_0x4fc66d(0x16f))[_0x4fc66d(0x18c)](_0x190667=>{telegramError(_0x190667);});else{if(_0x310a6a[_0x4fc66d(0x12a)]>0x1)_0x310a6a[_0x4fc66d(0x141)]({'botID':_0x4fc66d(0x147)});let _0x84f010=[],_0x4b2a0f=[];const _0xbad79d=_0x310a6a[_0x4fc66d(0x12a)]%0x4==0x0||_0x310a6a[_0x4fc66d(0x12a)]%0x4==0x3||_0x310a6a['length']%0x3==0x1?0x4:0x3;let _0x593817=0x0;_0x310a6a['forEach']((_0x48c49c,_0x42843c)=>{const _0x37a6b6=_0x4fc66d;if(_0x42843c%_0xbad79d==0x0)_0x4b2a0f=[];_0x4b2a0f[_0x37a6b6(0x141)]({'text':_0x48c49c[_0x37a6b6(0x276)]==_0x37a6b6(0x147)?'All\x20bots':_0x37a6b6(0x275)+_0x48c49c['botID'],'callback_data':_0x48c49c[_0x37a6b6(0x276)]}),_0x42843c%_0xbad79d==0x0&&(_0x84f010[_0x593817]=_0x4b2a0f,_0x593817++);}),tgBot[_0x4fc66d(0x2c3)](_0x428129[_0x4fc66d(0x185)]['id'],_0x4fc66d(0x146),{'reply_markup':{'inline_keyboard':_0x84f010}})[_0x4fc66d(0x18c)](_0x5c1cf2=>{telegramError(_0x5c1cf2);}),tgBot['on'](_0x4fc66d(0x2bd),async _0x1f88d9=>{const _0x3a06e0=_0x4fc66d,_0x290810=_0x1f88d9[_0x3a06e0(0x15e)],_0x4ab745=_0x1f88d9[_0x3a06e0(0x2a6)];tgBot['answerCallbackQuery'](_0x1f88d9['id'])[_0x3a06e0(0x150)](async()=>{const _0x2d476b=_0x3a06e0;_0x290810==_0x2d476b(0x147)?config[_0x2d476b(0x2a4)](_0x345cf0=>{const _0x544ad8=_0x2d476b;restartBot(_0x345cf0[_0x544ad8(0x276)]);}):restartBot(_0x290810);}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/on/,_0x1bcf23=>{const _0xb81164=_0x518a2a;if(!validateTelegram(_0x1bcf23))return;tgBot[_0xb81164(0x1c8)](_0xb81164(0x2bd));const _0xcdf2f6=getDisabledBots();if(_0xcdf2f6[_0xb81164(0x12a)]==0x0)tgBot[_0xb81164(0x2c3)](_0x1bcf23[_0xb81164(0x185)]['id'],_0xb81164(0x258))[_0xb81164(0x18c)](_0x1ee992=>{telegramError(_0x1ee992);});else{if(_0xcdf2f6[_0xb81164(0x12a)]>0x1)_0xcdf2f6[_0xb81164(0x141)]({'botID':_0xb81164(0x147)});let _0x4e41d3=[],_0x95809e=[];const _0xb2b55d=_0xcdf2f6[_0xb81164(0x12a)]%0x4==0x0||_0xcdf2f6[_0xb81164(0x12a)]%0x4==0x3||_0xcdf2f6[_0xb81164(0x12a)]%0x3==0x1?0x4:0x3;let _0x4bcf0f=0x0;_0xcdf2f6[_0xb81164(0x2a4)]((_0x5ef635,_0x462cf4)=>{const _0x364a62=_0xb81164;if(_0x462cf4%_0xb2b55d==0x0)_0x95809e=[];_0x95809e[_0x364a62(0x141)]({'text':_0x5ef635[_0x364a62(0x276)]==_0x364a62(0x147)?_0x364a62(0x260):_0x364a62(0x275)+_0x5ef635[_0x364a62(0x276)],'callback_data':_0x5ef635[_0x364a62(0x276)]}),_0x462cf4%_0xb2b55d==0x0&&(_0x4e41d3[_0x4bcf0f]=_0x95809e,_0x4bcf0f++);}),tgBot[_0xb81164(0x2c3)](_0x1bcf23['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x4e41d3}})[_0xb81164(0x18c)](_0x1bb921=>{telegramError(_0x1bb921);}),tgBot['on'](_0xb81164(0x2bd),async _0x19c9dd=>{const _0x59bcea=_0xb81164,_0x5c4b02=_0x19c9dd[_0x59bcea(0x15e)],_0x299ebd=_0x19c9dd[_0x59bcea(0x2a6)];tgBot[_0x59bcea(0x233)](_0x19c9dd['id'])['then'](async()=>{const _0x5801f2=_0x59bcea;_0x5c4b02==_0x5801f2(0x147)?(tgBot['sendMessage'](_0x299ebd[_0x5801f2(0x185)]['id'],_0x5801f2(0x2ab))[_0x5801f2(0x18c)](_0xea77f5=>{telegramError(_0xea77f5);}),_0xcdf2f6[_0x5801f2(0x2a4)](_0x4102ed=>{const _0x329a65=_0x5801f2;if(_0x4102ed[_0x329a65(0x276)]!=_0x329a65(0x147))toggleBot(_0x4102ed[_0x329a65(0x276)],toggleStatus(_0x4102ed[_0x329a65(0x276)]),_0x329a65(0x193));})):(tgBot[_0x5801f2(0x2c3)](_0x299ebd[_0x5801f2(0x185)]['id'],_0x5801f2(0x1fa)+_0x5c4b02)[_0x5801f2(0x18c)](_0x9c1ee0=>{telegramError(_0x9c1ee0);}),toggleBot(_0x5c4b02,toggleStatus(_0x5c4b02),_0x5801f2(0x193)));}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x518a2a(0x1a4)](/\/off/,_0x27abf9=>{const _0x575307=_0x518a2a;if(!validateTelegram(_0x27abf9))return;tgBot['removeListener'](_0x575307(0x2bd));const _0x185181=getEnabledBots();if(_0x185181[_0x575307(0x12a)]==0x0)tgBot[_0x575307(0x2c3)](_0x27abf9[_0x575307(0x185)]['id'],_0x575307(0x16f))['catch'](_0x106404=>{telegramError(_0x106404);});else{if(_0x185181[_0x575307(0x12a)]>0x1)_0x185181['push']({'botID':'all'});let _0x1246b4=[],_0x5a3d4c=[];const _0x51659f=_0x185181[_0x575307(0x12a)]%0x4==0x0||_0x185181['length']%0x4==0x3||_0x185181[_0x575307(0x12a)]%0x3==0x1?0x4:0x3;let _0x2909a2=0x0;_0x185181[_0x575307(0x2a4)]((_0x2d9222,_0x2b533a)=>{const _0x4acc9b=_0x575307;if(_0x2b533a%_0x51659f==0x0)_0x5a3d4c=[];_0x5a3d4c[_0x4acc9b(0x141)]({'text':_0x2d9222['botID']==_0x4acc9b(0x147)?'All\x20bots':'Bot\x20'+_0x2d9222['botID'],'callback_data':_0x2d9222['botID']}),_0x2b533a%_0x51659f==0x0&&(_0x1246b4[_0x2909a2]=_0x5a3d4c,_0x2909a2++);}),tgBot[_0x575307(0x2c3)](_0x27abf9['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x1246b4}})[_0x575307(0x18c)](_0x6b2341=>{telegramError(_0x6b2341);}),tgBot['on']('callback_query',async _0x19614d=>{const _0x59d31a=_0x575307,_0x72a569=_0x19614d[_0x59d31a(0x15e)],_0x307b0e=_0x19614d[_0x59d31a(0x2a6)];tgBot[_0x59d31a(0x233)](_0x19614d['id'])[_0x59d31a(0x150)](async()=>{const _0x3aea26=_0x59d31a;_0x72a569=='all'?(tgBot[_0x3aea26(0x2c3)](_0x307b0e[_0x3aea26(0x185)]['id'],_0x3aea26(0x1e4))[_0x3aea26(0x18c)](_0x7598a8=>{telegramError(_0x7598a8);}),_0x185181[_0x3aea26(0x2a4)](_0x405f9f=>{const _0xdd2d5f=_0x3aea26;if(_0x405f9f['botID']!=_0xdd2d5f(0x147))toggleBot(_0x405f9f[_0xdd2d5f(0x276)],toggleStatus(_0x405f9f[_0xdd2d5f(0x276)]),_0xdd2d5f(0x193));})):(tgBot[_0x3aea26(0x2c3)](_0x307b0e[_0x3aea26(0x185)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x72a569)[_0x3aea26(0x18c)](_0x30714a=>{telegramError(_0x30714a);}),toggleBot(_0x72a569,toggleStatus(_0x72a569),_0x3aea26(0x193)));}),tgBot[_0x59d31a(0x1c8)](_0x59d31a(0x2bd));});}}),tgBot[_0x518a2a(0x1a4)](/\/metrics/,_0xbc8ee9=>{const _0x168c68=_0x518a2a;if(!validateTelegram(_0xbc8ee9))return;tgBot[_0x168c68(0x1c8)](_0x168c68(0x2bd));const _0x506792=getEnabledBots();if(_0x506792[_0x168c68(0x12a)]==0x0)tgBot[_0x168c68(0x2c3)](_0xbc8ee9[_0x168c68(0x185)]['id'],_0x168c68(0x16f))[_0x168c68(0x18c)](_0x42ec8b=>{telegramError(_0x42ec8b);});else{if(_0x506792[_0x168c68(0x12a)]>0x1){let _0x1d0149=[],_0x4750e4=[];const _0x3a44d5=_0x506792[_0x168c68(0x12a)]%0x4==0x0||_0x506792['length']%0x4==0x3||_0x506792['length']%0x3==0x1?0x4:0x3;let _0x5064fc=0x0;_0x506792['forEach']((_0x345a75,_0x301042)=>{const _0x4caa1a=_0x168c68;if(_0x301042%_0x3a44d5==0x0)_0x4750e4=[];_0x4750e4['push']({'text':_0x4caa1a(0x275)+_0x345a75[_0x4caa1a(0x276)],'callback_data':_0x345a75['botID']}),_0x301042%_0x3a44d5==0x0&&(_0x1d0149[_0x5064fc]=_0x4750e4,_0x5064fc++);}),tgBot['sendMessage'](_0xbc8ee9[_0x168c68(0x185)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x1d0149}})['catch'](_0x7e14bc=>{telegramError(_0x7e14bc);}),tgBot['on']('callback_query',async _0x353bdd=>{const _0x55e793=_0x168c68,_0x373893=_0x353bdd[_0x55e793(0x15e)],_0x5cf1de=_0x353bdd[_0x55e793(0x2a6)];tgBot['answerCallbackQuery'](_0x353bdd['id'])['then'](async()=>{const _0x5cc010=_0x55e793;if(pid[_0x373893])pid[_0x373893][_0x5cc010(0x232)]({'function':_0x5cc010(0x23f),'args':null});}),tgBot[_0x55e793(0x1c8)]('callback_query');});}else{const _0x3c8178=_0x506792[0x0][_0x168c68(0x276)];if(pid[_0x3c8178])pid[_0x3c8178]['send']({'function':_0x168c68(0x23f),'args':null});}}}),tgBot[_0x518a2a(0x1a4)](/\/portfolio/,_0x40f384=>{const _0x4b47b9=_0x518a2a;if(!validateTelegram(_0x40f384))return;tgBot[_0x4b47b9(0x1c8)](_0x4b47b9(0x2bd));const _0x5565c0=getEnabledBots();if(_0x5565c0[_0x4b47b9(0x12a)]==0x0)tgBot[_0x4b47b9(0x2c3)](_0x40f384['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x1bb523=>{telegramError(_0x1bb523);});else{if(_0x5565c0[_0x4b47b9(0x12a)]>0x1){let _0x49faa9=[],_0x45545c=[];const _0x1193ee=_0x5565c0[_0x4b47b9(0x12a)]%0x4==0x0||_0x5565c0[_0x4b47b9(0x12a)]%0x4==0x3||_0x5565c0[_0x4b47b9(0x12a)]%0x3==0x1?0x4:0x3;let _0x1c83e8=0x0;_0x5565c0[_0x4b47b9(0x2a4)]((_0x321bb6,_0x301dc4)=>{if(_0x301dc4%_0x1193ee==0x0)_0x45545c=[];_0x45545c['push']({'text':'Bot\x20'+_0x321bb6['botID'],'callback_data':_0x321bb6['botID']}),_0x301dc4%_0x1193ee==0x0&&(_0x49faa9[_0x1c83e8]=_0x45545c,_0x1c83e8++);}),tgBot[_0x4b47b9(0x2c3)](_0x40f384[_0x4b47b9(0x185)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x49faa9}})[_0x4b47b9(0x18c)](_0x147eaa=>{telegramError(_0x147eaa);}),tgBot['on'](_0x4b47b9(0x2bd),async _0x424e58=>{const _0x194249=_0x4b47b9,_0x40defc=_0x424e58[_0x194249(0x15e)],_0x397613=_0x424e58[_0x194249(0x2a6)];tgBot['answerCallbackQuery'](_0x424e58['id'])[_0x194249(0x150)](async()=>{const _0x39704c=_0x194249;if(pid[_0x40defc])pid[_0x40defc][_0x39704c(0x232)]({'function':_0x39704c(0x274),'args':null});}),tgBot['removeListener'](_0x194249(0x2bd));});}else{const _0x177fb1=_0x5565c0[0x0]['botID'];if(pid[_0x177fb1])pid[_0x177fb1]['send']({'function':_0x4b47b9(0x274),'args':null});}}}),tgBot['onText'](/\/update/,async _0x2692c0=>{const _0x1e8c5f=_0x518a2a;if(!validateTelegram(_0x2692c0))return;tgBot['removeListener'](_0x1e8c5f(0x2bd)),await getMessages();if(!updateAvailable)tgBot[_0x1e8c5f(0x2c3)](_0x2692c0[_0x1e8c5f(0x185)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x270e7b=>{telegramError(_0x270e7b);});else!validInstallation?tgBot[_0x1e8c5f(0x2c3)](_0x2692c0[_0x1e8c5f(0x185)]['id'],_0x1e8c5f(0x2cd))[_0x1e8c5f(0x18c)](_0x4825f8=>{telegramError(_0x4825f8);}):(tgBot['sendMessage'](_0x2692c0[_0x1e8c5f(0x185)]['id'],_0x1e8c5f(0x2d0),{'reply_markup':{'inline_keyboard':[[{'text':_0x1e8c5f(0x156),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0xebe404=>{telegramError(_0xebe404);}),tgBot['on'](_0x1e8c5f(0x2bd),async _0x1e73dd=>{const _0x1ca109=_0x1e8c5f,_0x1c0dc2=_0x1e73dd[_0x1ca109(0x15e)],_0x2ea84d=_0x1e73dd[_0x1ca109(0x2a6)];tgBot[_0x1ca109(0x233)](_0x1e73dd['id'])[_0x1ca109(0x150)](async()=>{const _0x5b323b=_0x1ca109;_0x1c0dc2=='yes'&&(await tgBot['sendMessage'](_0x2ea84d['chat']['id'],_0x5b323b(0x1f7))[_0x5b323b(0x18c)](_0x18fc2a=>{telegramError(_0x18fc2a);}),updateBB(_0x5b323b(0x238))),_0x1c0dc2=='no'&&await tgBot[_0x5b323b(0x2c3)](_0x2ea84d['chat']['id'],_0x5b323b(0x1bd))[_0x5b323b(0x18c)](_0xdc7c6c=>{telegramError(_0xdc7c6c);});}),tgBot[_0x1ca109(0x1c8)]('callback_query');}));}),tgBot[_0x518a2a(0x1a4)](/\/reinstall/,async _0x93de28=>{const _0x34c8c9=_0x518a2a;if(!validateTelegram(_0x93de28))return;tgBot['removeListener'](_0x34c8c9(0x2bd)),!validInstallation?tgBot[_0x34c8c9(0x2c3)](_0x93de28['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x34c8c9(0x18c)](_0x4d4aab=>{telegramError(_0x4d4aab);}):(tgBot[_0x34c8c9(0x2c3)](_0x93de28[_0x34c8c9(0x185)]['id'],_0x34c8c9(0x177),{'reply_markup':{'inline_keyboard':[[{'text':_0x34c8c9(0x156),'callback_data':_0x34c8c9(0x139)},{'text':'No','callback_data':'no'}]]}})[_0x34c8c9(0x18c)](_0x2dca66=>{telegramError(_0x2dca66);}),tgBot['on'](_0x34c8c9(0x2bd),async _0x515f2e=>{const _0x1d3e60=_0x34c8c9,_0x4a8b46=_0x515f2e['data'],_0x3dc995=_0x515f2e[_0x1d3e60(0x2a6)];tgBot[_0x1d3e60(0x233)](_0x515f2e['id'])['then'](async()=>{const _0xa82b92=_0x1d3e60;_0x4a8b46==_0xa82b92(0x139)&&(await tgBot[_0xa82b92(0x2c3)](_0x3dc995['chat']['id'],_0xa82b92(0x2d5))[_0xa82b92(0x18c)](_0x3e06a6=>{telegramError(_0x3e06a6);}),updateBB('reinstall')),_0x4a8b46=='no'&&await tgBot[_0xa82b92(0x2c3)](_0x3dc995[_0xa82b92(0x185)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0xa82b92(0x18c)](_0x576945=>{telegramError(_0x576945);});}),tgBot[_0x1d3e60(0x1c8)]('callback_query');}));}),tgBot[_0x518a2a(0x1a4)](/\/toggle/,_0x303bbe=>{const _0x4ec719=_0x518a2a;if(!validateTelegram(_0x303bbe))return;tgBot[_0x4ec719(0x1c8)](_0x4ec719(0x2bd));const _0x46b316=getBotsWithMode();if(_0x46b316[_0x4ec719(0x12a)]==0x0)tgBot[_0x4ec719(0x2c3)](_0x303bbe[_0x4ec719(0x185)]['id'],_0x4ec719(0x16f))[_0x4ec719(0x18c)](_0x4d0061=>{telegramError(_0x4d0061);});else{let _0xe8107d=[],_0xa2a464=[];const _0x84149b=0x2;let _0x34acac=0x0;_0x46b316['forEach']((_0x4f8ef2,_0x2bbf35)=>{const _0xedb7b9=_0x4ec719;if(_0x2bbf35%_0x84149b==0x0)_0xa2a464=[];_0xa2a464[_0xedb7b9(0x141)]({'text':_0xedb7b9(0x275)+_0x4f8ef2[_0xedb7b9(0x276)]+'\x20('+_0x4f8ef2[_0xedb7b9(0x1a3)]+')','callback_data':_0x4f8ef2[_0xedb7b9(0x276)]}),_0x2bbf35%_0x84149b==0x0&&(_0xe8107d[_0x34acac]=_0xa2a464,_0x34acac++);}),tgBot[_0x4ec719(0x2c3)](_0x303bbe[_0x4ec719(0x185)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0xe8107d}})[_0x4ec719(0x18c)](_0x211d54=>{telegramError(_0x211d54);}),tgBot['on'](_0x4ec719(0x2bd),async _0x4cb78d=>{const _0x210820=_0x4ec719,_0x1073bc=_0x4cb78d[_0x210820(0x15e)],_0x35adc5=_0x4cb78d[_0x210820(0x2a6)];tgBot[_0x210820(0x233)](_0x4cb78d['id'])[_0x210820(0x150)](async()=>{const _0x16e5b9=_0x210820,_0x13e87a=_0x46b316['find'](_0x249cae=>_0x249cae[_0x16e5b9(0x276)]==_0x1073bc),_0xf8d3f=_0x13e87a[_0x16e5b9(0x1a3)]=='auto'?_0x16e5b9(0x148):_0x16e5b9(0x20b);tgBot[_0x16e5b9(0x2c3)](_0x35adc5[_0x16e5b9(0x185)]['id'],_0x16e5b9(0x180)+_0x1073bc+_0x16e5b9(0x11d)+_0xf8d3f+_0x16e5b9(0x2bb))['catch'](_0x5f1880=>{telegramError(_0x5f1880);}),toggleBotMode(_0x1073bc);}),tgBot[_0x210820(0x1c8)](_0x210820(0x2bd));});}}),tgBot[_0x518a2a(0x1a4)](/\/names/,_0x11958a=>{const _0x7f5835=_0x518a2a;if(!validateTelegram(_0x11958a))return;let _0x1620b7='';config[_0x7f5835(0x2a4)](_0x283e16=>{const _0x48b884=_0x7f5835;_0x1620b7+='Bot\x20'+_0x283e16[_0x48b884(0x276)]+':\x20'+_0x283e16[_0x48b884(0x25d)]+'\x0a';}),tgBot[_0x7f5835(0x2c3)](_0x11958a['chat']['id'],_0x1620b7,{'parse_mode':'HTML'})['catch'](_0x2c792e=>{telegramError(_0x2c792e);});}),tgBot[_0x518a2a(0x1a4)](/\/disable/,_0x946ce9=>{const _0x1ddb44=_0x518a2a;if(!validateTelegram(_0x946ce9))return;tgBot[_0x1ddb44(0x2c3)](_0x946ce9[_0x1ddb44(0x185)]['id'],_0x1ddb44(0x19f))['catch'](_0x333d23=>{telegramError(_0x333d23);}),updateSetting(_0x1ddb44(0x23c),![]);}),tgBot['onText'](/\/help/,_0x24169d=>{const _0x2a89d4=_0x518a2a;if(!validateTelegram(_0x24169d))return;tgBot[_0x2a89d4(0x2c3)](_0x24169d[_0x2a89d4(0x185)]['id'],_0x308262)[_0x2a89d4(0x18c)](_0x1526c8=>{telegramError(_0x1526c8);});}),tgBot['on']('polling_error',_0x3e82ec=>{const _0x553737=_0x518a2a;_0x3e82ec[_0x553737(0x216)]()['includes'](_0x553737(0x183))&&(logger[_0x553737(0x2c8)](_0x553737(0x1f6)),tgBot[_0x553737(0x24c)](),tgBot=null,io['to'](_0x553737(0x21a))[_0x553737(0x219)](_0x553737(0x12d),_0x553737(0x1f6)));}),process[_0x518a2a(0x19c)](_0x518a2a(0x22e),()=>{const _0x31f711=_0x518a2a;if(tgBot)tgBot[_0x31f711(0x24c)]();process['exit'](0x1);}),process['once']('SIGTERM',()=>{const _0x5ebf28=_0x518a2a;if(tgBot)tgBot['stopPolling']();process[_0x5ebf28(0x245)](0x1);});}}function disableTelegram(){const _0x5195a6=_0xc1da20;tgBot&&(tgBot[_0x5195a6(0x24c)](),tgBot=null);}function sendTelegram(_0x9a0ced,_0x1e6f23){const _0x57b5f3=_0xc1da20;if(settings[_0x57b5f3(0x23c)]){if(settings[_0x57b5f3(0x2ba)]==_0x57b5f3(0x147)||(_0x1e6f23[_0x57b5f3(0x1b5)]==_0x57b5f3(0x1f9)||_0x1e6f23['type']=='warning'||_0x1e6f23[_0x57b5f3(0x1b5)]==_0x57b5f3(0x15b))&&settings[_0x57b5f3(0x2ba)]==_0x57b5f3(0x249)||_0x1e6f23[_0x57b5f3(0x1b5)]==_0x57b5f3(0x19e)&&settings['telegramEvents']==_0x57b5f3(0x250)){if(tgBot&&settings['telegramChatId']){if(_0x1e6f23['showname'])tgBot['sendMessage'](settings[_0x57b5f3(0x196)],_0x1e6f23['botname']+_0x57b5f3(0x289)+_0x1e6f23[_0x57b5f3(0x181)])[_0x57b5f3(0x18c)](_0x878a4b=>{telegramError(_0x878a4b);});else tgBot['sendMessage'](settings[_0x57b5f3(0x196)],_0x57b5f3(0x275)+_0x9a0ced+'\x20>\x20'+_0x1e6f23['event'])[_0x57b5f3(0x18c)](_0x5777a9=>{telegramError(_0x5777a9);});}}}}async function sendTelegramMsg(_0x56a83f,_0x2bd454='HTML'){const _0x1679ec=_0xc1da20;return settings[_0x1679ec(0x23c)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0x1679ec(0x196)],_0x56a83f,{'parse_mode':_0x2bd454})['catch'](_0x408b6e=>{telegramError(_0x408b6e);}),!![]):![];}function getDeviceWithIp(_0xc84da7){const _0x48ac12=_0xc1da20;return devices[_0x48ac12(0x1d7)](_0x52d223=>_0x52d223['ip']===_0xc84da7);}function temporaryAccess2FA(_0x167809,_0x5adb65){const _0x284858=_0xc1da20;let _0xaf3ac4=new Date(),_0x5a075c=![];if(lastIpApproval){if(_0xaf3ac4-lastIpApproval<0x1388)_0x5a075c=!![];}lastIpApproval=new Date();if(_0x5a075c)return;tgBot&&settings[_0x284858(0x196)]&&(tgBot['removeListener'](_0x284858(0x2bd)),tgBot[_0x284858(0x2c3)](settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x5adb65)[_0x284858(0x25b)]+_0x284858(0x149),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x284858(0x2c5),'callback_data':'5'},{'text':_0x284858(0x1cc),'callback_data':'15'},{'text':_0x284858(0x2c6),'callback_data':'30'},{'text':_0x284858(0x1e3),'callback_data':'reject'}]]}})[_0x284858(0x18c)](_0x55017f=>{telegramError(_0x55017f);}),tgBot['on'](_0x284858(0x2bd),async _0x7001e9=>{const _0x39c591=_0x284858,_0x20be5e=_0x7001e9[_0x39c591(0x15e)],_0x4908c9=_0x7001e9['message'];tgBot['answerCallbackQuery'](_0x7001e9['id'])[_0x39c591(0x150)](async()=>{const _0x253bda=_0x39c591;devices[_0x167809][_0x253bda(0x25c)]={'clientip':_0x5adb65,'timestamp':new Date()[_0x253bda(0x126)](),'expiry':_0x20be5e},_0x20be5e!='reject'?(await tgBot['sendMessage'](_0x4908c9['chat']['id'],'Access\x20enabled\x20for\x20'+_0x20be5e+_0x253bda(0x20d),{'parse_mode':'HTML'})[_0x253bda(0x18c)](_0x35a232=>{telegramError(_0x35a232);}),io['to'](_0x167809)[_0x253bda(0x219)](_0x253bda(0x29a),{'access':{'allow':![],'reason':_0x253bda(0x24b),'token':null}})):(await tgBot[_0x253bda(0x2c3)](_0x4908c9[_0x253bda(0x185)]['id'],_0x253bda(0x1c7))['catch'](_0x444d8d=>{telegramError(_0x444d8d);}),io['to'](_0x167809)[_0x253bda(0x219)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x39c591(0x1c8)](_0x39c591(0x2bd));}));}function loginAccess2FA(_0x137a04,_0x2521c7){const _0x207392=_0xc1da20;tgBot&&settings['telegramChatId']&&(tgBot[_0x207392(0x1c8)](_0x207392(0x2bd)),tgBot[_0x207392(0x2c3)](settings[_0x207392(0x196)],_0x207392(0x2b5)+normalizeIP(_0x2521c7)[_0x207392(0x25b)]+_0x207392(0x149),{'parse_mode':_0x207392(0x199),'reply_markup':{'inline_keyboard':[[{'text':_0x207392(0x251),'callback_data':loginExpiry},{'text':_0x207392(0x1e3),'callback_data':_0x207392(0x1e3)}]]}})[_0x207392(0x18c)](_0xd11f5b=>{telegramError(_0xd11f5b);}),tgBot['on'](_0x207392(0x2bd),async _0x43b18d=>{const _0x135611=_0x207392,_0x40e8da=_0x43b18d[_0x135611(0x15e)],_0x3045d8=_0x43b18d[_0x135611(0x2a6)];tgBot[_0x135611(0x233)](_0x43b18d['id'])[_0x135611(0x150)](async()=>{const _0x159404=_0x135611;devices[_0x137a04][_0x159404(0x167)]={'clientip':_0x2521c7,'timestamp':new Date()[_0x159404(0x126)](),'expiry':_0x40e8da},_0x40e8da!=_0x159404(0x1e3)?(await tgBot[_0x159404(0x2c3)](_0x3045d8['chat']['id'],_0x159404(0x16b),{'parse_mode':_0x159404(0x199)})[_0x159404(0x18c)](_0x2ef11f=>{telegramError(_0x2ef11f);}),io['to'](_0x137a04)['emit'](_0x159404(0x29a),{'access':{'allow':![],'reason':_0x159404(0x24b),'token':null}})):(await tgBot[_0x159404(0x2c3)](_0x3045d8[_0x159404(0x185)]['id'],_0x159404(0x14f))[_0x159404(0x18c)](_0x4c05e0=>{telegramError(_0x4c05e0);}),io['to'](_0x137a04)[_0x159404(0x219)](_0x159404(0x29a),{'access':{'allow':![],'reason':_0x159404(0x1a6),'token':null}}));}),tgBot[_0x135611(0x1c8)](_0x135611(0x2bd));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5742ae=_0xc1da20;return dbConfig[_0x5742ae(0x2d4)](_0x5742ae(0x174))[_0x5742ae(0x169)](_0x5742ae(0x276))['filter']({'status':_0x5742ae(0x21d)})[_0x5742ae(0x286)]()||[];}function getDisabledBots(){const _0x4a755e=_0xc1da20;return dbConfig['get'](_0x4a755e(0x174))[_0x4a755e(0x169)]('botID')[_0x4a755e(0x237)]({'status':_0x4a755e(0x129)})[_0x4a755e(0x286)]()||[];}function getBotAttributes(_0x529427){const _0x2d3e7d=_0xc1da20;let _0x3c5a5b={};const _0xe13672=configpath+_0x2d3e7d(0x224)+_0x529427+_0x2d3e7d(0x23a),_0x44e523=fs[_0x2d3e7d(0x1d5)](_0xe13672);if(_0x44e523){const _0x14d296=fs[_0x2d3e7d(0x134)](_0xe13672);try{const _0x30eb25=JSON['parse'](_0x14d296),_0x50a4fc=_0x30eb25?_0x30eb25['bot'][0x0][_0x2d3e7d(0x158)]:![];_0x3c5a5b[_0x2d3e7d(0x1a3)]=_0x50a4fc?_0x2d3e7d(0x20b):_0x2d3e7d(0x148),_0x3c5a5b[_0x2d3e7d(0x25d)]=_0x30eb25?_0x30eb25['bot'][0x0][_0x2d3e7d(0x25d)]:_0x2d3e7d(0x275)+_0x529427;}catch(_0x4465cc){_0x3c5a5b[_0x2d3e7d(0x1a3)]=_0x2d3e7d(0x148),_0x3c5a5b[_0x2d3e7d(0x25d)]=_0x2d3e7d(0x275)+_0x529427;}}else _0x3c5a5b[_0x2d3e7d(0x1a3)]=_0x2d3e7d(0x148),_0x3c5a5b[_0x2d3e7d(0x25d)]='Bot\x20'+_0x529427;return _0x3c5a5b;}function getBotsWithMode(){const _0x25a377=_0xc1da20,_0x1bb6df=dbConfig[_0x25a377(0x2d4)](_0x25a377(0x174))['sortBy'](_0x25a377(0x276))[_0x25a377(0x286)]()||[];return _0x1bb6df[_0x25a377(0x2a4)](_0x206a0b=>{const _0x45a6eb=_0x25a377;let _0x44a126=getBotAttributes(_0x206a0b[_0x45a6eb(0x276)]);_0x206a0b['mode']=_0x44a126[_0x45a6eb(0x1a3)];}),_0x1bb6df;}function getBotExchanges(){const _0xeb06df=_0xc1da20;let _0xf14e5a=[];const _0x146c28=dbConfig['get']('bots')[_0xeb06df(0x169)](_0xeb06df(0x276))['value']()||[];_0x146c28[_0xeb06df(0x2a4)](_0x2d9763=>{const _0x548713=_0xeb06df;if(_0x2d9763[_0x548713(0x29a)]==_0x548713(0x21d)){const _0x589474=configpath+_0x548713(0x224)+_0x2d9763[_0x548713(0x276)]+'-config.json',_0x57f144=fs['existsSync'](_0x589474);let _0x21ac1a;if(_0x57f144){const _0x559698=fs[_0x548713(0x134)](_0x589474);try{const _0x4a33cb=JSON['parse'](_0x559698);_0x21ac1a=_0x4a33cb?_0x4a33cb[_0x548713(0x1c1)][0x0][_0x548713(0x2d2)]:null;}catch(_0x140a3f){}}if(_0x21ac1a)_0xf14e5a[_0x548713(0x141)](_0x21ac1a);}});const _0x3f855c=[...new Set(_0xf14e5a)][_0xeb06df(0x124)]();return _0x3f855c;}async function initUser(){const _0xcdeb9e=_0xc1da20;if(!settings[_0xcdeb9e(0x11e)]){const _0x3aa67a=uuidRandom();mixpanel[_0xcdeb9e(0x15a)](_0x3aa67a),updateSetting('userid',_0x3aa67a);}}async function initSecure(){const _0x4c24cc=_0xc1da20;let _0xf9ad1=getSecure();if(!_0xf9ad1[_0x4c24cc(0x277)](_0x4c24cc(0x26e))){let _0x2fa300=await generateKeys();_0xf9ad1[_0x4c24cc(0x13f)]=_0x2fa300[_0x4c24cc(0x13f)],_0xf9ad1[_0x4c24cc(0x18b)]=_0x2fa300[_0x4c24cc(0x18b)],_0xf9ad1[_0x4c24cc(0x26e)]=crypto[_0x4c24cc(0x2ac)](0x20)[_0x4c24cc(0x216)]('hex');;storeSecure(_0xf9ad1);}}function getSettings(){const _0x444069=_0xc1da20;return dbSettings[_0x444069(0x2d4)](_0x444069(0x188))[_0x444069(0x286)]()||{};}function getSecure(){const _0x7c4bbd=_0xc1da20;return dbSecure[_0x7c4bbd(0x2d4)](_0x7c4bbd(0x1e7))[_0x7c4bbd(0x286)]()||{};}function getBlacklist(){const _0x5be3c9=_0xc1da20;return dbSecure['get'](_0x5be3c9(0x2a5))[_0x5be3c9(0x286)]()||[];}function broadcastToBots(_0x593fff,_0x5bb42f){const _0x4428de=_0xc1da20;config[_0x4428de(0x2a4)](_0x193355=>{const _0x23e51c=_0x4428de;if(_0x193355[_0x23e51c(0x29a)]==_0x23e51c(0x21d)&&_0x193355[_0x23e51c(0x222)]=='running'||_0x193355[_0x23e51c(0x29a)]=='new'&&_0x193355['live']==_0x23e51c(0x11c)){if(pid[_0x193355[_0x23e51c(0x276)]])pid[_0x193355[_0x23e51c(0x276)]][_0x23e51c(0x232)]({[_0x593fff]:_0x5bb42f});}});}function storeSettings(_0x1e5a57,_0xfbed68=![]){const _0x12b6c2=_0xc1da20;_0x1e5a57={...settings,..._0x1e5a57};if(_0xfbed68&&_0x1e5a57[_0x12b6c2(0x1af)]!='************'&&_0x1e5a57[_0x12b6c2(0x1af)]!=_0x12b6c2(0x143)&&_0x1e5a57['bbPassword']!=''){const _0x42b63e=crypt[_0x12b6c2(0x28a)](secure[_0x12b6c2(0x18b)],_0x1e5a57[_0x12b6c2(0x1af)])[_0x12b6c2(0x2a6)][_0x12b6c2(0x1a8)]('@')[0x0],_0x33c02b=bcrypt[_0x12b6c2(0x1ca)](_0x42b63e,saltRounds);_0x1e5a57={..._0x1e5a57,'bbPassword':_0x33c02b};}if(_0xfbed68&&_0x1e5a57['telegramToken']!=_0x12b6c2(0x1a1)&&_0x1e5a57[_0x12b6c2(0x271)]!=_0x12b6c2(0x143)&&_0x1e5a57[_0x12b6c2(0x271)]!=''){const _0x30c5ca=crypt['decrypt'](secure[_0x12b6c2(0x18b)],_0x1e5a57[_0x12b6c2(0x271)])[_0x12b6c2(0x2a6)][_0x12b6c2(0x1a8)]('@')[0x0];_0x1e5a57={..._0x1e5a57,'telegramToken':_0x30c5ca};}const _0x19f694=_0x1e5a57[_0x12b6c2(0x271)]!=_0x12b6c2(0x1a1)&&_0x1e5a57[_0x12b6c2(0x271)]!=settings[_0x12b6c2(0x271)]||_0x1e5a57[_0x12b6c2(0x26f)]!=settings[_0x12b6c2(0x26f)],_0x1c3846=_0x1e5a57[_0x12b6c2(0x271)]==''||_0x1e5a57[_0x12b6c2(0x26f)]=='';if(_0x19f694)_0x1e5a57[_0x12b6c2(0x2ba)]=_0x12b6c2(0x147);for(const [_0x5e660e,_0xd32a58]of Object[_0x12b6c2(0x256)](_0x1e5a57)){if(_0x5e660e==_0x12b6c2(0x271)&&_0xd32a58==_0x12b6c2(0x1a1)){_0x1e5a57[_0x12b6c2(0x271)]=settings['telegramToken'];continue;};if(_0x5e660e=='bbPassword'&&_0xd32a58==_0x12b6c2(0x1a1)){_0x1e5a57[_0x12b6c2(0x1af)]=settings[_0x12b6c2(0x1af)];continue;};dbSettings[_0x12b6c2(0x299)](_0x12b6c2(0x202)+_0x5e660e,_0xd32a58)[_0x12b6c2(0x208)]();}settings=_0x1e5a57,io['to']('botmanager')['emit'](_0x12b6c2(0x188),cleanSettings()),broadcastToBots(_0x12b6c2(0x2b1),settings[_0x12b6c2(0x2b1)]),broadcastToBots('onepagemode',settings['onepagemode']);if(_0x19f694&&!_0x1c3846)initTelegram();if(_0x19f694&&_0x1c3846)disableTelegram();getAllClients()['forEach'](_0x55e693=>{const _0x90d829=_0x12b6c2;getSocket(_0x55e693['id'])[_0x90d829(0x219)](_0x90d829(0x29a),{'access':{'allow':![],'reason':_0x90d829(0x24b),'token':null}});});}function updateSetting(_0xa69d3c,_0x5105a7){const _0x575587=_0xc1da20;dbSettings[_0x575587(0x299)](_0x575587(0x202)+_0xa69d3c,_0x5105a7)[_0x575587(0x208)](),settings=getSettings(),io['to']('botmanager')[_0x575587(0x219)](_0x575587(0x188),cleanSettings());}function storeSecure(_0x5851ea){const _0x4006fb=_0xc1da20;dbSecure[_0x4006fb(0x2d4)](_0x4006fb(0x1e7))['push'](_0x5851ea)[_0x4006fb(0x208)](),secure=_0x5851ea;}function addBlacklist(_0x20a0cf){const _0x2bb0e6=_0xc1da20;cleanBlacklist();let _0x494b52;devices[_0x20a0cf]['telegramIpApproval']?_0x494b52=Math[_0x2bb0e6(0x214)](devices[_0x20a0cf][_0x2bb0e6(0x25c)][_0x2bb0e6(0x21b)],loginExpiry):_0x494b52=loginExpiry,dbSecure[_0x2bb0e6(0x2d4)](_0x2bb0e6(0x2a5))[_0x2bb0e6(0x141)]({'expiry':new Date()[_0x2bb0e6(0x126)]()+_0x494b52*0x3c*0x3e8,'token':devices[_0x20a0cf][_0x2bb0e6(0x26a)][_0x2bb0e6(0x119)]})[_0x2bb0e6(0x208)](),blacklist=dbSecure[_0x2bb0e6(0x2d4)](_0x2bb0e6(0x2a5))['value']();}function cleanBlacklist(){const _0xf2491a=_0xc1da20;let _0x324fc1=dbSecure['get'](_0xf2491a(0x2a5))[_0xf2491a(0x28b)]()[_0xf2491a(0x286)](),_0x22539a=new Date()['getTime']();_0x324fc1['forEach'](_0x3ccb66=>{const _0x35a56=_0xf2491a;_0x3ccb66[_0x35a56(0x21b)]<_0x22539a&&dbSecure[_0x35a56(0x2d4)](_0x35a56(0x2a5))['remove']({'expiry':_0x3ccb66[_0x35a56(0x21b)]})['write']();});}function initStates(){const _0x44e43c=_0xc1da20;let _0x2644d5=getConfiguration();_0x2644d5[_0x44e43c(0x2a4)](_0x4d6b6b=>{const _0xf3fa29=_0x44e43c;_0x4d6b6b['live']=_0xf3fa29(0x193);}),storeConfiguration(_0x2644d5);}function onKeys(){const _0x37decd=new RSA();return new Promise(_0x1a6d5c=>{const _0x44fdbd=_0x509a;_0x37decd[_0x44fdbd(0x2d7)]()['then'](_0x3711fe=>{_0x1a6d5c(_0x3711fe);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x77b59f=_0xc1da20;let _0x571b43=getSettings(),_0x21f537=![];!_0x571b43['hasOwnProperty']('lastmsgtelegram')&&(_0x571b43['lastmsgtelegram']=0x0,_0x21f537=!![]);!_0x571b43[_0x77b59f(0x277)](_0x77b59f(0x1be))&&(_0x571b43[_0x77b59f(0x1be)]=0x0,_0x21f537=!![]);!_0x571b43['hasOwnProperty'](_0x77b59f(0x168))&&(_0x571b43[_0x77b59f(0x168)]=_0x77b59f(0x20e),_0x21f537=!![]);!_0x571b43[_0x77b59f(0x277)](_0x77b59f(0x25e))&&(_0x571b43['onepagemode']=![],_0x21f537=!![]);if(_0x21f537)storeSettings(_0x571b43);}function storeConfiguration(_0x34ebed){const _0x5a167a=_0xc1da20;dbConfig[_0x5a167a(0x2d4)](_0x5a167a(0x174))[_0x5a167a(0x12c)]()[_0x5a167a(0x208)](),_0x34ebed['forEach'](_0x35fbc0=>{const _0x2fd72d=_0x5a167a;delete _0x35fbc0[_0x2fd72d(0x1a3)];}),dbConfig[_0x5a167a(0x2d4)](_0x5a167a(0x174))['push'](..._0x34ebed)[_0x5a167a(0x208)](),config=_0x34ebed;}function _0x509a(_0x181283,_0xf0ba2c){const _0x4e7800=_0x7ccf();return _0x509a=function(_0x41af09,_0x10de65){_0x41af09=_0x41af09-0x119;let _0x7ccfd2=_0x4e7800[_0x41af09];return _0x7ccfd2;},_0x509a(_0x181283,_0xf0ba2c);}function resetPassword(){const _0x26bdc8=_0xc1da20;tgBot&&settings[_0x26bdc8(0x196)]&&(tgBot[_0x26bdc8(0x1c8)](_0x26bdc8(0x2bd)),tgBot[_0x26bdc8(0x2c3)](settings[_0x26bdc8(0x196)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x26bdc8(0x199),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x26bdc8(0x139)},{'text':'no','callback_data':'no'}]]}})[_0x26bdc8(0x18c)](_0x996c0e=>{telegramError(_0x996c0e);}),tgBot['on'](_0x26bdc8(0x2bd),async _0x149325=>{const _0x2d39e6=_0x26bdc8,_0x3d899f=_0x149325[_0x2d39e6(0x15e)],_0x3e7120=_0x149325[_0x2d39e6(0x2a6)];tgBot['answerCallbackQuery'](_0x149325['id'])[_0x2d39e6(0x150)](async()=>{const _0xc81653=_0x2d39e6;if(_0x3d899f!='no'){const _0x3a04fe=0xf,_0x44d3ca=_0xc81653(0x29b),_0x5213d6=Array[_0xc81653(0x2c0)](crypto['randomFillSync'](new Uint32Array(_0x3a04fe)))['map'](_0x3aabb4=>_0x44d3ca[_0x3aabb4%_0x44d3ca[_0xc81653(0x12a)]])[_0xc81653(0x1a9)](''),_0x223755=bcrypt[_0xc81653(0x1ca)](_0x5213d6,saltRounds);storeSettings({'bbPassword':_0x223755}),await tgBot[_0xc81653(0x2c3)](_0x3e7120['chat']['id'],_0xc81653(0x1c6)+_0x5213d6,{'parse_mode':'HTML'})[_0xc81653(0x18c)](_0x487651=>{telegramError(_0x487651);});}else await tgBot[_0xc81653(0x2c3)](_0x3e7120[_0xc81653(0x185)]['id'],'Password\x20reset\x20rejected')[_0xc81653(0x18c)](_0x4ba0ec=>{telegramError(_0x4ba0ec);});}),tgBot[_0x2d39e6(0x1c8)]('callback_query');}));}async function confirmRestore(_0x20e95b,_0x3ad781){const _0x21e90d=_0xc1da20;io['to']('botmanager')[_0x21e90d(0x219)](_0x21e90d(0x12d),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x21e90d(0x15b)),tgBot&&settings[_0x21e90d(0x196)]&&(tgBot[_0x21e90d(0x1c8)](_0x21e90d(0x2bd)),await tgBot['sendMessage'](settings[_0x21e90d(0x196)],_0x21e90d(0x2d1),{'parse_mode':_0x21e90d(0x199),'reply_markup':{'inline_keyboard':[[{'text':_0x21e90d(0x139),'callback_data':_0x21e90d(0x139)},{'text':'no','callback_data':'no'}]]}})[_0x21e90d(0x18c)](_0x1b3bff=>{telegramError(_0x1b3bff);}),tgBot['on']('callback_query',async _0x2ed033=>{const _0x3dbdbe=_0x21e90d,_0x5b495e=_0x2ed033[_0x3dbdbe(0x15e)],_0x5e703c=_0x2ed033[_0x3dbdbe(0x2a6)];tgBot[_0x3dbdbe(0x233)](_0x2ed033['id'])[_0x3dbdbe(0x150)](async()=>{const _0x2107ef=_0x3dbdbe;_0x5b495e==_0x2107ef(0x139)?(await tgBot[_0x2107ef(0x2c3)](_0x5e703c[_0x2107ef(0x185)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x2107ef(0x199)})[_0x2107ef(0x18c)](_0x2ea96c=>{telegramError(_0x2ea96c);}),unzipFile(_0x20e95b,_0x3ad781)):(logger[_0x2107ef(0x135)]('Restore\x20process\x20aborted'),await tgBot[_0x2107ef(0x2c3)](_0x5e703c['chat']['id'],_0x2107ef(0x153))['catch'](_0x4571ee=>{telegramError(_0x4571ee);}));}),tgBot[_0x3dbdbe(0x1c8)](_0x3dbdbe(0x2bd));}));}function getServerTime(){const _0x4e5d25=_0xc1da20,_0xef0de1=new Date();return _0xef0de1[_0x4e5d25(0x2a3)]()+'/'+(_0xef0de1[_0x4e5d25(0x1bb)]()+0x1)['toString']()[_0x4e5d25(0x28e)](0x2,'0')+'/'+_0xef0de1[_0x4e5d25(0x218)]()[_0x4e5d25(0x216)]()[_0x4e5d25(0x28e)](0x2,'0')+'\x20'+_0xef0de1[_0x4e5d25(0x125)]()[_0x4e5d25(0x216)]()[_0x4e5d25(0x28e)](0x2,'0')+':'+_0xef0de1['getMinutes']()[_0x4e5d25(0x216)]()['padStart'](0x2,'0')+':'+_0xef0de1[_0x4e5d25(0x14d)]()[_0x4e5d25(0x216)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1c2c1d=_0xc1da20,_0x24c5b2=shiftedTime();return _0x24c5b2['getFullYear']()+'/'+(_0x24c5b2['getMonth']()+0x1)['toString']()[_0x1c2c1d(0x28e)](0x2,'0')+'/'+_0x24c5b2[_0x1c2c1d(0x218)]()[_0x1c2c1d(0x216)]()[_0x1c2c1d(0x28e)](0x2,'0')+'\x20'+_0x24c5b2[_0x1c2c1d(0x125)]()[_0x1c2c1d(0x216)]()[_0x1c2c1d(0x28e)](0x2,'0')+':'+_0x24c5b2[_0x1c2c1d(0x173)]()[_0x1c2c1d(0x216)]()['padStart'](0x2,'0')+':'+_0x24c5b2['getSeconds']()[_0x1c2c1d(0x216)]()[_0x1c2c1d(0x28e)](0x2,'0');}function getCleanTimeStamp(){const _0x3b80bd=_0xc1da20,_0x1993a0=shiftedTime();return _0x1993a0[_0x3b80bd(0x2a3)]()+(_0x1993a0['getMonth']()+0x1)['toString']()[_0x3b80bd(0x28e)](0x2,'0')+_0x1993a0['getDate']()[_0x3b80bd(0x216)]()[_0x3b80bd(0x28e)](0x2,'0')+'-'+_0x1993a0[_0x3b80bd(0x125)]()[_0x3b80bd(0x216)]()[_0x3b80bd(0x28e)](0x2,'0')+_0x1993a0[_0x3b80bd(0x173)]()[_0x3b80bd(0x216)]()[_0x3b80bd(0x28e)](0x2,'0')+_0x1993a0[_0x3b80bd(0x14d)]()[_0x3b80bd(0x216)]()[_0x3b80bd(0x28e)](0x2,'0');}function shiftedTime(){const _0x5f38ca=_0xc1da20,_0x229b29=new Date();let _0x4be001=_0x229b29;if(settings[_0x5f38ca(0x2b1)]&&settings['timeshift']!==0x0)_0x4be001=fns[_0x5f38ca(0x1bf)](_0x229b29,{'hours':settings[_0x5f38ca(0x2b1)]});return _0x4be001;}function startScheduler(){const _0x883091=_0xc1da20,_0x282744=new Date()[_0x883091(0x1b4)](),_0x38a390=shiftedTime()[_0x883091(0x125)]();_0x38a390==0x4&&backupConfigFiles();_0x38a390==0x0&&rotateLogFiles();_0x282744%0x6==0x0&&triggerAnalytics();_0x282744%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x273e6e){const _0x5eb29a=_0xc1da20;logger[_0x5eb29a(0x135)](_0x5eb29a(0x1c9)+_0x273e6e);const _0x303ff0=getBotsWithMode();_0x303ff0['length']>0x0?confirmRestore(configbackuppath,_0x273e6e):unzipFile(configbackuppath,_0x273e6e);}async function getBackupFiles(_0x1736dc=null){const _0x841aae=_0xc1da20;let _0x596e9e=[],_0x2e86ef=fs[_0x841aae(0x195)](configbackuppath,{'withFileTypes':!![]});_0x2e86ef[_0x841aae(0x124)]((_0x518ab0,_0x1c9a6e)=>_0x518ab0[_0x841aae(0x137)]<_0x1c9a6e['name']?0x1:_0x1c9a6e[_0x841aae(0x137)]<_0x518ab0[_0x841aae(0x137)]?-0x1:0x0),_0x2e86ef[_0x841aae(0x2a4)](_0x235283=>{const _0x2816c6=_0x841aae;if(!_0x235283['isDirectory']()&&_0x235283[_0x2816c6(0x137)][_0x2816c6(0x145)](_0x2816c6(0x22a))&&_0x235283[_0x2816c6(0x137)][_0x2816c6(0x12e)](_0x2816c6(0x1fc))){const _0x371bd5=formatDate(fs[_0x2816c6(0x25f)](configbackuppath+_0x235283[_0x2816c6(0x137)])[_0x2816c6(0x2c4)]);_0x596e9e[_0x2816c6(0x141)]({'name':_0x235283[_0x2816c6(0x137)],'mtime':_0x371bd5});}});if(_0x1736dc)io['to'](_0x1736dc)[_0x841aae(0x219)]('backup-files',_0x596e9e);else return _0x596e9e;}async function backupConfigFiles(){const _0x10f746=_0xc1da20;await zipFiles(_0x10f746(0x1cf));const _0x5e0329=getCleanTimeStamp();fs[_0x10f746(0x203)](zippath+'backup-full.zip',configbackuppath+(_0x10f746(0x22a)+_0x5e0329+'.zip'));let _0x55c8e8=fs[_0x10f746(0x195)](configbackuppath,{'withFileTypes':!![]});_0x55c8e8['sort']((_0x54f864,_0x3053c2)=>_0x54f864[_0x10f746(0x137)]<_0x3053c2[_0x10f746(0x137)]?0x1:_0x3053c2[_0x10f746(0x137)]<_0x54f864[_0x10f746(0x137)]?-0x1:0x0),_0x55c8e8[_0x10f746(0x12a)]>maxBackups&&fs[_0x10f746(0x1e8)](configbackuppath+_0x55c8e8[maxBackups][_0x10f746(0x137)]);}function rotateLogFiles(){const _0x2f4f88=_0xc1da20,_0x3a469c=fs[_0x2f4f88(0x25f)](logspath+_0x2f4f88(0x220)),_0x9ee8b1=_0x3a469c['size']/0x400;if(_0x9ee8b1>0x64){let _0x164009=fs[_0x2f4f88(0x195)](logspath,{'withFileTypes':!![]});_0x164009[_0x2f4f88(0x124)]((_0x3f1d34,_0x2e3779)=>_0x3f1d34[_0x2f4f88(0x137)]<_0x2e3779['name']?0x1:_0x2e3779[_0x2f4f88(0x137)]<_0x3f1d34[_0x2f4f88(0x137)]?-0x1:0x0),_0x164009[_0x2f4f88(0x2a4)](_0x13bc32=>{const _0x47ac74=_0x2f4f88;if(_0x13bc32['name']==_0x47ac74(0x1e2))fs['copyFileSync'](logspath+_0x13bc32[_0x47ac74(0x137)],logspath+_0x47ac74(0x210));if(_0x13bc32[_0x47ac74(0x137)]==_0x47ac74(0x136))fs[_0x47ac74(0x203)](logspath+_0x13bc32[_0x47ac74(0x137)],logspath+_0x47ac74(0x1e2));_0x13bc32[_0x47ac74(0x137)]==_0x47ac74(0x220)&&(fs[_0x47ac74(0x203)](logspath+_0x13bc32['name'],logspath+_0x47ac74(0x136)),fs[_0x47ac74(0x2cc)](logspath+_0x13bc32[_0x47ac74(0x137)],''));});}}async function zipFiles(_0xe4e93b){const _0x34c471=_0xc1da20;let _0x4784c7;if(_0xe4e93b==_0x34c471(0x179))_0x4784c7=logspath;if(_0xe4e93b=='backup')_0x4784c7=configpath;if(_0xe4e93b==_0x34c471(0x1cf))_0x4784c7=configpath;let _0x3dd8ce=fs[_0x34c471(0x195)](_0x4784c7,{'withFileTypes':!![]});const _0x3442de=new require('node-zip')();_0x3dd8ce[_0x34c471(0x2a4)](_0x50d59c=>{const _0x437379=_0x34c471;if(!_0x50d59c['isDirectory']()){let _0x3c713e=fs[_0x437379(0x134)](_0x4784c7+_0x50d59c[_0x437379(0x137)]);if(_0xe4e93b==_0x437379(0x24e)){const _0x5767c7=/^bot-[0-9]{3}-config.json$/,_0x20769c=_0x5767c7[_0x437379(0x241)](_0x50d59c['name']);if(_0x20769c){const _0x5a86b7=JSON[_0x437379(0x246)](_0x3c713e);_0x5a86b7[_0x437379(0x1c1)][0x0]&&(_0x5a86b7[_0x437379(0x1c1)][0x0][_0x437379(0x164)]=_0x437379(0x143),_0x5a86b7[_0x437379(0x1c1)][0x0][_0x437379(0x2bf)]=_0x437379(0x143)),_0x3c713e=JSON[_0x437379(0x264)](_0x5a86b7,null,0x2);}if(_0x50d59c[_0x437379(0x137)]==_0x437379(0x1b0)){const _0x28bb41=JSON[_0x437379(0x246)](_0x3c713e);if(_0x28bb41[_0x437379(0x188)][_0x437379(0x190)])_0x28bb41[_0x437379(0x188)]['loginRequired']=![];if(_0x28bb41[_0x437379(0x188)][_0x437379(0x1af)])_0x28bb41['settings'][_0x437379(0x1af)]=_0x437379(0x143);if(_0x28bb41[_0x437379(0x188)][_0x437379(0x271)])_0x28bb41[_0x437379(0x188)]['telegramToken']=_0x437379(0x143);if(_0x28bb41[_0x437379(0x188)][_0x437379(0x196)])_0x28bb41[_0x437379(0x188)][_0x437379(0x196)]=null;_0x3c713e=JSON[_0x437379(0x264)](_0x28bb41,null,0x2);}if(_0x50d59c[_0x437379(0x137)]!=_0x437379(0x1aa))_0x3442de[_0x437379(0x2b3)](_0x50d59c['name'],_0x3c713e);}else _0x3442de['file'](_0x50d59c[_0x437379(0x137)],_0x3c713e);}});const _0x2f3528=_0x3442de[_0x34c471(0x1da)]({'base64':![],'compression':_0x34c471(0x288)});fs[_0x34c471(0x2cc)](zippath+(_0xe4e93b+_0x34c471(0x1fc)),_0x2f3528,_0x34c471(0x1ed));}async function unzipFile(_0x1f48e5,_0x399f4f){const _0x2cd32a=_0xc1da20;fs[_0x2cd32a(0x195)](configpath,{'withFileTypes':!![]})[_0x2cd32a(0x2a4)](_0x6bcaff=>{const _0x4ec34e=_0x2cd32a;if(!_0x6bcaff[_0x4ec34e(0x1c3)]())fs[_0x4ec34e(0x243)](configpath+_0x6bcaff['name']);});const _0x3c5903=fs[_0x2cd32a(0x134)](_0x1f48e5+_0x399f4f,_0x2cd32a(0x1ed)),_0x467aa5=new require(_0x2cd32a(0x22b))(_0x3c5903,{'base64':![],'checkCRC32':!![]});Object[_0x2cd32a(0x254)](_0x467aa5[_0x2cd32a(0x230)])[_0x2cd32a(0x2a4)](_0x5ceaf7=>{const _0x10dfbc=_0x2cd32a,_0x52e074=_0x467aa5[_0x10dfbc(0x230)][_0x5ceaf7];fs[_0x10dfbc(0x2cc)](configpath+_0x52e074['name'],_0x52e074[_0x10dfbc(0x294)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x2cd32a(0x2a4)](_0x595495=>{const _0x4c8d6a=_0x2cd32a;if(!_0x595495[_0x4c8d6a(0x1c3)]())fs['rmSync'](temppath+_0x595495['name']);}),logger[_0x2cd32a(0x135)]('Backup\x20file\x20unzipped\x20and\x20stored'),process['send']({'restore':!![]},_0x281031=>{});}async function getPublicIp(){const _0x248208=_0xc1da20;try{const _0x467843=await axios['get'](_0x248208(0x1e0));publicip=_0x467843[_0x248208(0x15e)]['ip'];}catch(_0x313e8b){}}async function triggerAnalytics(){const _0x284758=_0xc1da20;if(!publicip)await getPublicIp();const _0x18971f=getBotsWithMode();let _0x420b53=0x0;_0x18971f['forEach'](_0x531610=>{const _0x4a1b6b=_0x509a;if(_0x531610[_0x4a1b6b(0x29a)]===_0x4a1b6b(0x21d))_0x420b53++;});const _0x4998fd=getBotExchanges();mixpanel[_0x284758(0x1a0)](_0x284758(0x17f),{'distinct_id':settings[_0x284758(0x11e)],'ip':publicip,'version':serverversion,'numbots':_0x18971f[_0x284758(0x12a)],'numbotsenabled':_0x420b53,'exchanges':_0x4998fd});}async function getMessages(){const _0x15b796=_0xc1da20,_0x3a4a54='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4a7f7b=new GraphQLClient(_0x3a4a54),_0xc0b7ab={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x384be1=serverversion[_0x15b796(0x1a8)]('.'),_0x500448=_0x384be1[0x0]+'.'+_0x384be1[0x1],_0x2c8942=Math[_0x15b796(0x17d)](settings[_0x15b796(0x269)],settings['lastmsgemitted']),_0x37bbe2={'last':parseInt(_0x2c8942),'bbm':_0x500448},_0x157349=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3180a1;try{_0x3180a1=await _0x4a7f7b[_0x15b796(0x1ff)](_0x157349,_0x37bbe2,_0xc0b7ab);}catch(_0x1c1a9e){}if(_0x3180a1&&_0x3180a1['messages']){let _0x58c7f1=settings['lastmsgtelegram'];newMessages=[];for(const _0x2a597b of _0x3180a1[_0x15b796(0x268)]){newMessages['push'](_0x2a597b);if(_0x2a597b[_0x15b796(0x1f3)])updateSetting(_0x15b796(0x168),_0x2a597b[_0x15b796(0x1f3)]);let _0x3d880=_0x2a597b[_0x15b796(0x1f3)]?serverversion>=_0x2a597b[_0x15b796(0x1f3)]:![];if(!_0x3d880&&_0x2a597b['number']>_0x58c7f1){if(_0x2a597b['bbvReceive']==='any'||serverversion['startsWith'](_0x2a597b[_0x15b796(0x2b0)])){let _0x2de766=''+_0x2a597b[_0x15b796(0x2a1)]+'\x0a\x0a'+_0x2a597b[_0x15b796(0x2a6)];const _0x3c2434=await sendTelegramMsg(toTelegramMarkdown(_0x2de766),_0x15b796(0x221));if(_0x3c2434)_0x58c7f1=_0x2a597b[_0x15b796(0x244)];}}}updateAvailable=isNewerVersion(settings[_0x15b796(0x168)],serverversion),updateSetting(_0x15b796(0x269),_0x58c7f1),emitMessages();}}function emitMessages(){const _0x2cbb53=_0xc1da20,_0xa5d422=settings[_0x2cbb53(0x1be)];let _0x1832b0=[];newMessages[_0x2cbb53(0x2a4)](_0x1c22f0=>{const _0x262f73=_0x2cbb53;_0x1c22f0[_0x262f73(0x244)]>_0xa5d422&&_0x1832b0[_0x262f73(0x141)](_0x1c22f0);}),_0x1832b0['length']>0x0&&getAllClients()[_0x2cbb53(0x2a4)](_0x260080=>{const _0x30c3df=_0x2cbb53;getSocket(_0x260080['id'])[_0x30c3df(0x219)](_0x30c3df(0x2a6),_0x1832b0);});}function confirmMessage(_0x37e736){const _0x3e2ccd=_0xc1da20;updateSetting(_0x3e2ccd(0x1be),Number(_0x37e736));}function isNewerVersion(_0x435187,_0x904aa0){const _0x1a8304=_0xc1da20,_0x2c8421=_0x904aa0['split']('.'),_0x332d72=_0x435187[_0x1a8304(0x1a8)]('.');for(var _0x449442=0x0;_0x449442<_0x332d72['length'];_0x449442++){const _0x194934=~~_0x332d72[_0x449442],_0x1f52e7=~~_0x2c8421[_0x449442];if(_0x194934>_0x1f52e7)return!![];if(_0x194934<_0x1f52e7)return![];}return![];}function toTelegramMarkdown(_0x4a91c1){const _0xc408ca=_0xc1da20,_0x15f78d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x433ce4=/\*{2}(.+?)\*{2}/gim;return _0x4a91c1=_0x4a91c1[_0xc408ca(0x1f5)](_0x15f78d,_0xc408ca(0x27f))[_0xc408ca(0x1f5)](_0x433ce4,_0xc408ca(0x290)),_0x4a91c1;}async function validateConfigFile(){const _0x3e4d7a=_0xc1da20,_0x35eedc=dbConfig[_0x3e4d7a(0x2d4)]('bots')[_0x3e4d7a(0x169)]('botID')[_0x3e4d7a(0x286)]()||[];if(_0x35eedc['length']==0x0){let _0x53a5e9=0x0,_0x53c715=[];const _0x4b01bb=/^bot-([0-9]{3})-config.json$/,_0x477805=fs[_0x3e4d7a(0x195)](configpath);_0x477805['forEach'](_0x53c866=>{const _0x418426=_0x3e4d7a,_0x1fe3a2=_0x4b01bb[_0x418426(0x267)](_0x53c866);if(_0x1fe3a2){const _0x51ee1a=_0x1fe3a2[0x1];let _0x1c6d6f=getBotAttributes(_0x51ee1a);_0x53c715[_0x418426(0x141)]({'botID':_0x51ee1a,'botname':_0x1c6d6f[_0x418426(0x25d)],'status':_0x418426(0x129),'live':_0x418426(0x193)}),_0x53a5e9++;}}),_0x53a5e9!=0x0&&(dbConfig[_0x3e4d7a(0x2d4)](_0x3e4d7a(0x174))[_0x3e4d7a(0x1f0)](_0x53c715)['write'](),config=_0x53c715,restoredConfigFile=_0x53a5e9);}}async function restoreConfigNotify(_0x2332ce){const _0x3f7aab=_0xc1da20;let _0xd86aca;if(restoredConfigFile==0x1)_0xd86aca=_0x3f7aab(0x26c);else _0xd86aca=_0x3f7aab(0x211);if(_0x2332ce)io['to'](_0x3f7aab(0x21a))[_0x3f7aab(0x219)](_0x3f7aab(0x12d),_0xd86aca);else{logger[_0x3f7aab(0x21f)]('-----------------------------------------------------------------------------------'),logger[_0x3f7aab(0x21f)](_0xd86aca),logger[_0x3f7aab(0x21f)](_0x3f7aab(0x207)),logger[_0x3f7aab(0x21f)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x3f7aab(0x2ba)]!=_0x3f7aab(0x250))tgBot[_0x3f7aab(0x2c3)](settings[_0x3f7aab(0x196)],'Bot\x20Mgr\x20>\x20'+_0xd86aca)[_0x3f7aab(0x18c)](_0x55f710=>{telegramError(_0x55f710);});}}function validateCredentials(_0x4fb28e,_0x1f52fb){const _0xfb5cf8=_0xc1da20;if(_0x4fb28e['username']==settings['bbUsername']&&bcrypt[_0xfb5cf8(0x2af)](_0x4fb28e[_0xfb5cf8(0x121)],settings[_0xfb5cf8(0x1af)])){if(settings[_0xfb5cf8(0x122)])return{'allow':![],'reason':_0xfb5cf8(0x2ca),'token':null};else{const _0x40512a=generateLoginToken(_0x1f52fb);return{'allow':!![],'reason':_0xfb5cf8(0x263),'token':_0x40512a};}}else return{'allow':![],'reason':_0xfb5cf8(0x1a2),'token':null};}function refreshToken(_0x180c98){const _0x476724=_0xc1da20,_0x1448d9=generateLoginToken(_0x180c98);return{'allow':!![],'reason':_0x476724(0x263),'token':_0x1448d9};}function validateAccess(_0x65b2bb,_0x392e6f,_0x278482){const _0x58522a=_0xc1da20,_0x1e78b5=_0x278482?_0x278482:devices[_0x392e6f]['ip'];let _0x8d6992;const _0x305799=_0x12c789=>{const _0x5d7016=_0x509a;if(settings[_0x5d7016(0x190)]){if(settings[_0x5d7016(0x122)]){if(telegram2FaApproved(_0x392e6f)){const _0x345455=generateLoginToken(_0x392e6f);return{'allow':!![],'reason':_0x5d7016(0x2a2),'token':_0x345455};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x8d6992=validToken(_0x12c789,_0x392e6f),_0x8d6992['hasOwnProperty'](_0x5d7016(0x15b))?{'allow':!![],'reason':_0x5d7016(0x28f),'token':_0x12c789}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x5d7016(0x298),'token':null};};if(settings[_0x58522a(0x29d)]){let _0x233364=[...settings[_0x58522a(0x223)],'::1',_0x58522a(0x297),_0x58522a(0x22d)];if(_0x233364[_0x58522a(0x161)](_0x1e78b5))return _0x305799(_0x65b2bb);else{_0x8d6992=validToken(_0x65b2bb,_0x392e6f);if(_0x8d6992[_0x58522a(0x277)]('success'))return _0x305799(_0x65b2bb);else{if(telegramIpApproved(_0x392e6f)){const _0x43ee8e=generateToken(_0x392e6f);return _0x8d6992=_0x305799(_0x65b2bb),_0x8d6992[_0x58522a(0x14b)]?{'allow':!![],'reason':_0x58522a(0x144),'token':_0x43ee8e}:_0x8d6992;}else return settings[_0x58522a(0x2d3)]?{'allow':![],'reason':_0x58522a(0x170),'token':null}:{'allow':![],'reason':_0x58522a(0x18d),'token':null};}}}else return _0x305799(_0x65b2bb);}function timelyDecrypt(_0x5ecaf1,_0x3d6221=!![]){const _0x2efdac=_0xc1da20;if(_0x5ecaf1)try{const _0x5e23f1=crypt[_0x2efdac(0x28a)](secure['privateKey'],_0x5ecaf1)[_0x2efdac(0x2a6)],_0x2f8108=_0x5e23f1[_0x2efdac(0x1a8)]('@')[0x0],_0x27fc8f=_0x5e23f1[_0x2efdac(0x1a8)]('@')[0x1],_0x48bceb=new Date()[_0x2efdac(0x126)]();if(_0x3d6221){if(_0x48bceb-_0x27fc8f<maxSecretAge*0x3e8)return _0x2f8108;else return![];}else return _0x2f8108;}catch(_0x328120){return![];}else return![];}const validToken=(_0x45a0ef,_0x18c4ad)=>{const _0xc58bbc=_0xc1da20,_0x402074=devices[_0x18c4ad]['ip'];if(!_0x45a0ef)return{'error':_0xc58bbc(0x13c)};for(let _0x4055a6 of blacklist){if(_0x4055a6['token']==_0x45a0ef)return{'error':_0xc58bbc(0x131)};}let _0x1e2ea5;try{_0x1e2ea5=jwt['verify'](_0x45a0ef,secure[_0xc58bbc(0x26e)]+_0x18c4ad);}catch{return{'error':_0xc58bbc(0x27a)};}if(!_0x1e2ea5[_0xc58bbc(0x277)](_0xc58bbc(0x2b2))&&!_0x1e2ea5[_0xc58bbc(0x277)](_0xc58bbc(0x1d8))||!_0x1e2ea5[_0xc58bbc(0x277)](_0xc58bbc(0x130)))return{'error':_0xc58bbc(0x1fd)};if(!_0x1e2ea5['hasOwnProperty']('username')&&_0x1e2ea5[_0xc58bbc(0x277)](_0xc58bbc(0x2b2))){const {clientip:_0x23fc2c}=_0x1e2ea5;return _0x402074==_0x23fc2c?{'success':_0xc58bbc(0x23d)}:{'error':_0xc58bbc(0x1d3)};}else{if(_0x1e2ea5[_0xc58bbc(0x277)](_0xc58bbc(0x1d8))&&_0x1e2ea5[_0xc58bbc(0x277)](_0xc58bbc(0x2b2))){const {username:_0x4f314c,clientip:_0x1bb5ad}=_0x1e2ea5;return settings[_0xc58bbc(0x1ab)]==_0x4f314c&&_0x402074==_0x1bb5ad?{'success':_0xc58bbc(0x23d)}:{'error':_0xc58bbc(0x236)};}}},generateLoginToken=_0x5d140a=>{const _0x3f1d7a=_0xc1da20;if(_0x5d140a){const _0x4e5c76=devices[_0x5d140a]['ip'];return jwt[_0x3f1d7a(0x205)]({'username':settings[_0x3f1d7a(0x1ab)],'clientip':_0x4e5c76},secure['secret']+_0x5d140a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x13d098=>{const _0x37577a=_0xc1da20;if(_0x13d098){const _0xcc9488=devices[_0x13d098]['ip'];return jwt['sign']({'clientip':_0xcc9488},secure[_0x37577a(0x26e)]+_0x13d098,{'expiresIn':devices[_0x13d098][_0x37577a(0x25c)][_0x37577a(0x21b)]*0x3c});}else return![];},telegramIpApproved=_0x12b21b=>{const _0x3c3340=_0xc1da20;let _0x30430b=![];return devices[_0x12b21b][_0x3c3340(0x25c)]&&devices[_0x12b21b][_0x3c3340(0x25c)][_0x3c3340(0x21b)]!=_0x3c3340(0x1e3)&&(_0x30430b=devices[_0x12b21b][_0x3c3340(0x25c)]['clientip']==devices[_0x12b21b]['ip']&&new Date()[_0x3c3340(0x126)]()-devices[_0x12b21b]['telegramIpApproval']['timestamp']<devices[_0x12b21b][_0x3c3340(0x25c)][_0x3c3340(0x21b)]*0x3c*0x3e8),_0x30430b;},telegram2FaApproved=_0x4e37ed=>{const _0x4641a3=_0xc1da20;let _0x22f5f4=![];return devices[_0x4e37ed][_0x4641a3(0x167)]&&devices[_0x4e37ed][_0x4641a3(0x167)][_0x4641a3(0x21b)]!=_0x4641a3(0x1e3)&&(_0x22f5f4=devices[_0x4e37ed][_0x4641a3(0x167)]['clientip']==devices[_0x4e37ed]['ip']&&new Date()[_0x4641a3(0x126)]()-devices[_0x4e37ed][_0x4641a3(0x167)][_0x4641a3(0x1d1)]<devices[_0x4e37ed][_0x4641a3(0x167)][_0x4641a3(0x21b)]*0x3c*0x3e8),_0x22f5f4;},normalizeIP=_0x10f530=>{const _0x196331=_0xc1da20;let _0x3bc65c=null,_0x347590=null;if(ipaddr[_0x196331(0x291)](_0x10f530)){const _0x5c146d=ipaddr[_0x196331(0x246)](_0x10f530);_0x5c146d[_0x196331(0x28c)]()===_0x196331(0x24a)?(_0x5c146d['isIPv4MappedAddress']()&&(_0x3bc65c=_0x5c146d[_0x196331(0x200)]()['toString']()),_0x347590=_0x5c146d[_0x196331(0x216)]()):(_0x3bc65c=_0x5c146d[_0x196331(0x216)](),_0x347590=_0x5c146d[_0x196331(0x20a)]()['toString']());}return{'show':_0x3bc65c?_0x3bc65c:_0x347590,'store':_0x347590};};function formatDate(_0x4c95e1){const _0x34db96=_0xc1da20;return _0x4c95e1[_0x34db96(0x2a3)]()+'/'+(_0x4c95e1[_0x34db96(0x1bb)]()+0x1)[_0x34db96(0x216)]()[_0x34db96(0x28e)](0x2,'0')+'/'+_0x4c95e1[_0x34db96(0x218)]()[_0x34db96(0x216)]()[_0x34db96(0x28e)](0x2,'0')+'\x20'+_0x4c95e1[_0x34db96(0x125)]()['toString']()['padStart'](0x2,'0')+':'+_0x4c95e1[_0x34db96(0x173)]()[_0x34db96(0x216)]()['padStart'](0x2,'0')+':'+_0x4c95e1[_0x34db96(0x14d)]()['toString']()['padStart'](0x2,'0');}function sleep(_0x17149f){return new Promise(_0x597d21=>setTimeout(_0x597d21,_0x17149f));}