const _0x2d323a=_0x4f2b;(function(_0x2fd155,_0x27bfb0){const _0x59cb7e=_0x4f2b,_0x26e189=_0x2fd155();while(!![]){try{const _0x5e8a39=-parseInt(_0x59cb7e(0x12a))/0x1+parseInt(_0x59cb7e(0x1db))/0x2+-parseInt(_0x59cb7e(0x17f))/0x3+parseInt(_0x59cb7e(0x101))/0x4*(parseInt(_0x59cb7e(0xdd))/0x5)+parseInt(_0x59cb7e(0x25f))/0x6*(parseInt(_0x59cb7e(0xda))/0x7)+-parseInt(_0x59cb7e(0x1a0))/0x8+-parseInt(_0x59cb7e(0x1ab))/0x9;if(_0x5e8a39===_0x27bfb0)break;else _0x26e189['push'](_0x26e189['shift']());}catch(_0x4ab10b){_0x26e189['push'](_0x26e189['shift']());}}}(_0xb225,0x9eec0));const _0x4a9ba7=function(){let _0x13c707=!![];return function(_0x57a960,_0xb5cd88){const _0xbe0212=_0x13c707?function(){const _0x13e703=_0x4f2b;if(_0xb5cd88){const _0x20e3dd=_0xb5cd88[_0x13e703(0x214)](_0x57a960,arguments);return _0xb5cd88=null,_0x20e3dd;}}:function(){};return _0x13c707=![],_0xbe0212;};}(),_0x16b7ce=_0x4a9ba7(this,function(){const _0x33850f=_0x4f2b;return _0x16b7ce[_0x33850f(0x233)]()[_0x33850f(0x88)](_0x33850f(0x1ae))[_0x33850f(0x233)]()[_0x33850f(0xd7)](_0x16b7ce)['search'](_0x33850f(0x1ae));});_0x16b7ce();'use strict';process[_0x2d323a(0x204)][_0x2d323a(0x224)]=0x1;const childProcess=require(_0x2d323a(0x18b)),fs=require('fs'),fns=require(_0x2d323a(0x122)),low=require('lowdb'),FileSync=require(_0x2d323a(0xc2)),path=require(_0x2d323a(0x10a)),crypto=require(_0x2d323a(0x1a4)),Crypt=require(_0x2d323a(0x14d))['Crypt'],RSA=require(_0x2d323a(0x14d))[_0x2d323a(0x230)],bcrypt=require('bcryptjs'),jwt=require(_0x2d323a(0xec)),ipaddr=require(_0x2d323a(0xf2)),argv=require('yargs/yargs')(process[_0x2d323a(0x1d8)][_0x2d323a(0x13d)](0x2))['argv'],uuidRandom=require('uuid-random'),TelegramBot=require(_0x2d323a(0x217)),Mixpanel=require('mixpanel'),axios=require(_0x2d323a(0x24a)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x2d323a(0x20e)),fileUpload=require(_0x2d323a(0xb5)),PORT=argv[_0x2d323a(0x1d2)]||_0x2d323a(0x1c2),pattern=/^[0-9]{2,4}$/;!pattern[_0x2d323a(0x1de)](PORT)&&(console[_0x2d323a(0xb4)](_0x2d323a(0x97)+PORT+_0x2d323a(0x181)),process[_0x2d323a(0xad)](0x1));const HOST=argv[_0x2d323a(0x206)]||null,userID=argv[_0x2d323a(0x207)]||'',debugging=argv['d']||![];let bbpath='bb/',bbpath2='';const botfile=_0x2d323a(0x1fa),configfile=_0x2d323a(0x19c),settingsfile='bb-settings.json',securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x2d323a(0xfe)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2d323a(0x134)),configpath=userID?bbpath+_0x2d323a(0x195)+userID+'/':bbpath+_0x2d323a(0x195),configbackuppath=configpath+_0x2d323a(0x8c),logspath=userID?bbpath+_0x2d323a(0xa5)+userID+'/':bbpath+_0x2d323a(0xa5),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x2d323a(0x25e),loggerfile=fs[_0x2d323a(0xbb)](logspath+_0x2d323a(0x1c6),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x2d323a(0x115);!fs['existsSync'](configpath)&&fs[_0x2d323a(0x15c)](configpath);!fs[_0x2d323a(0xfe)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x2d323a(0xfe)](logspath)&&fs[_0x2d323a(0x15c)](logspath);!fs[_0x2d323a(0xfe)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x2d323a(0xfe)](temppath)&&fs[_0x2d323a(0x15c)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2d323a(0x1f6)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2d323a(0x1f6)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2d323a(0x1b3),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2d323a(0x1f6)]({'secure':{},'blacklist':[]})[_0x2d323a(0x1ce)]();let crypt=new Crypt({'md':_0x2d323a(0x135),'rsaStandard':_0x2d323a(0x160)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2d323a(0xe9)](_0x2d323a(0x179),{'host':_0x2d323a(0x15e)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2d323a(0x235)]&&settings['telegramToken']!=''&&settings[_0x2d323a(0x156)]&&settings[_0x2d323a(0x156)]!='')initTelegram();const logger={'screen':_0x486224=>{const _0x34f48a=_0x2d323a;console[_0x34f48a(0xb4)](_0x486224);},'simple':_0x1935b2=>{const _0x1eeec6=_0x2d323a;console[_0x1eeec6(0xb4)](_0x1935b2),loggerfile[_0x1eeec6(0x1ce)](util[_0x1eeec6(0xe3)](_0x1935b2)+'\x0a');},'full':async _0x2230aa=>{const _0x5a9785=_0x2d323a,_0x3c9cc2=getTimeStamp()+_0x5a9785(0x249)+_0x2230aa;console[_0x5a9785(0xb4)](_0x3c9cc2),loggerfile[_0x5a9785(0x1ce)](util['format'](_0x3c9cc2)+'\x0a');if(tgBot&&settings[_0x5a9785(0x17c)]&&settings['telegramEvents']!='orders')await tgBot[_0x5a9785(0xa2)](settings[_0x5a9785(0x17c)],_0x5a9785(0x133)+_0x2230aa)[_0x5a9785(0x8e)](_0x3dc3e9=>{telegramError(_0x3dc3e9);});},'debug':async(_0x5f2122,_0x49f6e0='')=>{const _0x484762=_0x2d323a,_0x4aaa00=getTimeStamp()+_0x484762(0x1c9)+_0x5f2122;if(debugging)console[_0x484762(0xb4)](_0x4aaa00);loggerfile[_0x484762(0x1ce)](util[_0x484762(0xe3)](_0x4aaa00)+'\x0a');if(_0x49f6e0){if(debugging)console[_0x484762(0xb4)](_0x49f6e0);loggerfile['write'](util['format'](_0x49f6e0)+'\x0a');}}};process['on'](_0x2d323a(0x15f),function(_0x5df0b4){const _0x4677d3=_0x2d323a;logger[_0x4677d3(0x18a)](_0x5df0b4);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x2d323a(0x184)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2d323a(0x219)),app=express(),http=require('http')[_0x2d323a(0x20a)](app);app[_0x2d323a(0x19f)](fileUpload({'useTempFiles':!![]})),app[_0x2d323a(0x202)](_0x2d323a(0x126),async(_0xb5f67b,_0x78c91)=>{const _0x3005f5=_0x2d323a,_0x12e571=_0xb5f67b[_0x3005f5(0x127)][_0x3005f5(0x198)],_0x104380=getClientsWithBotID(_0x3005f5(0x23f)),_0x2812a6=_0xb5f67b['headers']['uuid'],_0x1f1efa=timelyDecrypt(_0x2812a6,![]),_0x3cf933=_0x104380[_0x3005f5(0xc7)](_0x3f0e53=>_0x3f0e53[_0x3005f5(0xb1)]==_0x1f1efa);if(_0x3cf933){const _0xa96f2=normalizeIP(_0xb5f67b['socket'][_0x3005f5(0x24d)])[_0x3005f5(0xc9)],_0x5a72f5=_0xb5f67b[_0x3005f5(0x1f7)]['tkn'];if(validateAccess(_0x5a72f5,_0x1f1efa,_0xa96f2)[_0x3005f5(0x1ff)])_0x12e571==_0x3005f5(0x13b)&&await backupConfigFiles(),await zipFiles(_0x12e571),_0x78c91[_0x3005f5(0x8a)](zippath+(_0x12e571+'.zip'),_0x5d30e2=>{const _0x444507=_0x3005f5;_0x5d30e2&&(logger[_0x444507(0x1ec)](_0x444507(0x95)+_0x12e571),logger[_0x444507(0x18a)](_0x5d30e2));});else logger['full'](_0x3005f5(0x14c)+_0x12e571+_0x3005f5(0x241));}else logger[_0x3005f5(0x1ec)](_0x3005f5(0x14c)+_0x12e571+'\x20(2)');}),app[_0x2d323a(0x163)](_0x2d323a(0x23d),async(_0x5e04e0,_0x1c21bc)=>{const _0x4b1de1=_0x2d323a,_0x3d0302=getClientsWithBotID(_0x4b1de1(0x23f)),_0x3740b4=_0x5e04e0[_0x4b1de1(0x1f7)]['uuid'],_0x536771=timelyDecrypt(_0x3740b4,![]),_0x2fc592=_0x3d0302[_0x4b1de1(0xc7)](_0xfe10b=>_0xfe10b[_0x4b1de1(0xb1)]==_0x536771);logger[_0x4b1de1(0x100)](_0x4b1de1(0x142));if(_0x2fc592){const _0x35c79d=normalizeIP(_0x5e04e0[_0x4b1de1(0x131)]['remoteAddress'])[_0x4b1de1(0xc9)],_0x5d1b2a=_0x5e04e0[_0x4b1de1(0x1f7)]['tkn'];if(validateAccess(_0x5d1b2a,_0x536771,_0x35c79d)[_0x4b1de1(0x1ff)]){if(_0x5e04e0[_0x4b1de1(0x1b0)]){const _0x267e00=_0x5e04e0[_0x4b1de1(0x1b0)][_0x4b1de1(0x172)];await _0x267e00['mv'](temppath+_0x267e00[_0x4b1de1(0x1cb)]),_0x1c21bc['send']({'status':!![],'message':_0x4b1de1(0x216)});const _0x20bc36=getBotsWithMode();_0x20bc36[_0x4b1de1(0x1e5)]>0x0?confirmRestore(temppath,_0x267e00[_0x4b1de1(0x1cb)]):unzipFile(temppath,_0x267e00['name']);}}else logger[_0x4b1de1(0x1ec)](_0x4b1de1(0x1c5));}else logger[_0x4b1de1(0x1ec)](_0x4b1de1(0x22f));}),app[_0x2d323a(0x19f)](express['static'](path[_0x2d323a(0x15d)](__dirname,bbpath2,_0x2d323a(0x1dc)))),app[_0x2d323a(0x19f)](express[_0x2d323a(0x18f)](path[_0x2d323a(0x15d)](__dirname,bbpath2,'build'))),app[_0x2d323a(0x202)]('/',function(_0x4ff6c8,_0x264076){const _0x83f64b=_0x2d323a;_0x264076[_0x83f64b(0x112)](path['join'](__dirname,bbpath2,_0x83f64b(0x1dc),_0x83f64b(0x1f4)));}),app[_0x2d323a(0x202)]('/:bot',function(_0x2670c0,_0x55509b){const _0x28c534=_0x2d323a;_0x55509b[_0x28c534(0x112)](path['join'](__dirname,bbpath2,_0x28c534(0x151),_0x28c534(0x1f4)));}),app['get'](_0x2d323a(0x220),(_0x256ba6,_0x5dc23e)=>{const _0x139ba2=_0x2d323a;_0x5dc23e[_0x139ba2(0x112)](path['join'](__dirname,bbpath2,'build',_0x139ba2(0x1f4)));}),app[_0x2d323a(0x202)](_0x2d323a(0xdc),(_0x2c9dc9,_0x9478c3)=>{const _0x5cd797=_0x2d323a;_0x9478c3[_0x5cd797(0x112)](path[_0x5cd797(0x15d)](__dirname,bbpath2,'build','index.html'));}),app[_0x2d323a(0x202)](_0x2d323a(0x121),(_0x19afaa,_0x3b4e4a)=>{const _0x58c40a=_0x2d323a;_0x3b4e4a['sendFile'](path['join'](__dirname,bbpath2,_0x58c40a(0x151),_0x58c40a(0x1f4)));}),app[_0x2d323a(0x202)]('/:bot/history',(_0x4d4e2f,_0x9955cc)=>{const _0x199324=_0x2d323a;_0x9955cc[_0x199324(0x112)](path[_0x199324(0x15d)](__dirname,bbpath2,_0x199324(0x151),_0x199324(0x1f4)));}),app[_0x2d323a(0x202)]('/:bot/configuration',(_0x5fa016,_0x34a449)=>{const _0x1d95ac=_0x2d323a;_0x34a449['sendFile'](path[_0x1d95ac(0x15d)](__dirname,bbpath2,_0x1d95ac(0x151),_0x1d95ac(0x1f4)));}),app[_0x2d323a(0x202)](_0x2d323a(0x102),(_0x897fdd,_0xefe18d)=>{const _0xdcaf7c=_0x2d323a;_0xefe18d['sendFile'](path['join'](__dirname,bbpath2,_0xdcaf7c(0x151),_0xdcaf7c(0x1f4)));});function _0xb225(){const _0x5d0e11=['axios','cloneDeep','generate','remoteAddress','Unauthorized\x20attempt\x20to\x20add\x20bot','whitelistEnabled','Login\x20accepted','warning','node-zip','latestversion','handshake','temporary\x20access\x20timeout','getMonth','encryptedUuid','restart','timestamp','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','new-disabled','send','\x20minutes','zip/','42jtcrAh','search','isDirectory','download','store-settings','backup/','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','catch','listen','Unauthorized\x20attempt\x20to\x20get\x20events','new','mtime','sortBy','sort','Failed\x20to\x20download\x20','getSeconds','Error:\x20Invalid\x20argument\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','stopPolling','stop','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','getPortfolio','get-portfolio','stopped','getUTCHours','lastmsgtelegram','file','sendMessage','writeFileSync','split','logs/','then','get-starting-balances','Disabled\x20Bot\x20','once','clientip','telegramEnabled','emit','exit','manual','telegrammsg','password','uuid','readFileSync','toggle-bot-mode','log','express-fileupload','access','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','replace','endsWith','output-002.log','createWriteStream','Starting\x20new\x20bot\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','username','storeConfiguration','/enable\x20-\x20enable\x20notifications\x0a','chat','lowdb/adapters/FileSync','restore-backup-file','cancelLoading','event','Login\x20rejected','find','get-logs','store','temporary\x20access\x20not\x20allowed','forEach','\x20|\x20client:\x20...','getDate','login\x20not\x20required','::1','Restore\x20process\x20aborted','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','getFullYear','logout','Logged\x20out\x20user\x20...','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','constructor','Password\x20reset\x20rejected','output-003.log','1112062QQDojl','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/:bot/performance','607290GqZPRk','showConfig','generateKeyPairAsync','update-bb','bot-','add-bot','format','Password\x20has\x20been\x20reset\x20to:\x20','output-000.log','request','Error\x20while\x20deleting\x20config\x20files:\x20','compareSync','init','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','jsonwebtoken','all','getHours','update-bot','/on\x20-\x20start\x20bot(s)\x0a','assign','ipaddr.js','auth','kind','updatebotmanager','Notifications\x20enabled\x0a','padStart','Notifications\x20types:\x20','Unauthorized\x20attempt\x20to\x20log\x20out','removeListener','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Invalid\x20authentication\x20token\x20(1)','loginRequired','existsSync','bots','debug','4fWAdgA','/:bot/support','notification','storeHeadless','entries','connection','\x20>\x20','temporary\x20access\x20rejected',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','path','login','ipv6','botID','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','started','backup-full','*$1*','sendFile','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','/off\x20-\x20stop\x20bot(s)\x0a','temp/','Idling\x20bot\x20\x20\x20|\x20Bot\x20','number','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','parse','invalid\x20credentials','SIGINT','All\x20bots','kill','Starting\x20Balance\x20Bot\x20reinstallation','delete-bot','orders','/:bot/coins','date-fns','-----------------------------------------------------------------------------------','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','telegramEvents','/download/:type','params','max','add','975210hPlfcW','-results.json','Invalid\x20Telegram\x20token','settings','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','</b>\x20?','polling_error','socket','alerts','Bot\x20Mgr\x20>\x20','clients','sha256','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Starting\x20Balance\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','telegramIpApproval','2FA\x20required','backup','sendMetricsTelegram','slice','status','update','2FA\x20login\x20required','bbUsername','Backup\x20file\x20uploaded','Access\x20enabled\x20for\x20','1000','fork','************','-config.json','\x20|\x20user:\x20...','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','message','disabled','Unauthorized\x20attempt\x20to\x20download\x20','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20update\x20bot','bb-settings.json','reject','build','bbvNew','server','verify','value','telegramUsername','secure','-performance.json','***','<b>Balance\x20Bot\x20Status:</b>\x0a','bbPassword','mkdirSync','join','api-eu.mixpanel.com','uncaughtException','RSA-OAEP','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','logs','post','running','binary','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','get-backup-files','lastmsgemitted','match','2FA','deleteHistoryAlerts','getTime','::ffff:127.0.0.1','Session\x20expired\x20for\x20user\x20...','isIPv4MappedAddress','copyFileSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','backupfile','show-config','function','5\x20min','unlinkSync','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unauthorized\x20login\x20attempt\x20(timeout)','6b67f3d61ee94b8f5c80b4affef4c4d9','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','mode','telegramChatId','Restoring\x20bot(s)\x20from\x20backup','Markdown','362301FkpDZC','from',',\x20must\x20be\x20a\x204\x20digit\x20number','apiSecret','hashSync','version','No\x20authentication\x20token','headless','blacklist','telegram','any','simple','child_process','exec','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','127.0.0.1','static','showname','.zip','404\x20Not\x20Found','HTML','Temporary\x20access\x20rejected','config/','Ok,\x20will\x20send\x20order\x20notifications\x20only','removeAllListeners','type','\x20only\x0a','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20update\x20settings','bb-config.json','access\x20timeout','pidRefreshToken','use','4450184OQpVTM','publicKey','place-order','Notifications\x20disabled\x0a','crypto','set','expiry','30\x20min','Enabled\x20Bot\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','settings.','207819bJNTVE','Starting\x20bot\x20|\x20Bot\x20','onText','(((.+)+)+)+$','bb-secure.json','files','onepagemode','live','0.0.0','Restore\x20backup\x20file\x20','filter','disconnect','track','\x20|\x20','randomFillSync','order','title','resetHistory','storeFiat','exchange','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/status\x20-\x20show\x20bot(s)\x20status\x0a','Allow\x20login\x20from\x20IP\x20address\x20<b>','3000','map','callback_query','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','/output-000.log','botname','Orders',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','remove','name','answerCallbackQuery','Unauthorized\x20attempt\x20to\x20delete\x20alerts','write','No\x20bots\x20running\x20right\x20now','apiKey','temporary\x20token\x20generated','port','f2aRequired','telegram2FaApproval','getMinutes','enabled','initclient','argv','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','pidExpireLogin','2185530UiUJmJ','build2','Unauthorized\x20attempt\x20to\x20get\x20portfolio','test','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','getStartingBalances','2FA\x20login\x20token\x20generated','readdirSync','Notifications\x20enabled','auto','length','reinstall','push','min','Yes','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','hex','full','Starting\x20Balance\x20Bot\x20update','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Bot\x20','connected','success','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','index.html','sendPortfolioTelegram','defaults','headers','store-configuration','secret','bot.js','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','inherit','User\x20has\x20been\x20validated','referer','allow','15\x20min','data','get','yes','env','statSync','host','user','sign','startsWith','createServer','error','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','util','show','userid','timeshift','Alerts','toIPv4Address','apply','Invalid\x20username\x20or\x20IP\x20address','File\x20uploaded','node-telegram-bot-api','keys','express','logged\x20out','Ok,\x20will\x20send\x20alert\x20notifications\x20only','$1_$2_$3','reset-history','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/portfolio','login\x20required','toggleBotMode','reason','NTBA_FIX_319','includes','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','store-headless','/disable\x20-\x20disable\x20notifications\x0a','/update\x20-\x20update\x20Balance\x20Bot\x0a','login\x20token\x20generated','privateKey','stringify','token','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','RSA','decrypt','store-fiat','toString','hasOwnProperty','telegramToken','rmSync','delete-alerts','output-001.log','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','exp','sockets','/upload-backup','accept','botmanager','SIGTERM','\x20(1)','Unauthorized\x20attempt\x20to\x20get\x20messages','reload','bot','_data','bbvReceive','backup-full@','\x20mode',':\x20Bot\x20Mgr\x20>\x20'];_0xb225=function(){return _0x5d0e11;};return _0xb225();}if(HOST)http[_0x2d323a(0x8f)](PORT,HOST);else http[_0x2d323a(0x8f)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x9deb7a=_0x2d323a;logger[_0x9deb7a(0x18a)](''),logger[_0x9deb7a(0x18a)](_0x9deb7a(0x123)),await logger[_0x9deb7a(0x1ec)](_0x9deb7a(0x227)+PORT),logger['simple']('-----------------------------------------------------------------------------------');if(config[_0x9deb7a(0x1e5)]!=0x0)for(const _0x1aec8f of config){if(_0x1aec8f[_0x9deb7a(0x13e)]==_0x9deb7a(0x1d6)||_0x1aec8f[_0x9deb7a(0x13e)]==_0x9deb7a(0x91))await logger['full'](_0x9deb7a(0x1ac)+_0x1aec8f[_0x9deb7a(0x10d)]+_0x9deb7a(0x1b8)+_0x1aec8f[_0x9deb7a(0x1c7)]),startBot([_0x1aec8f['botID'],userID],{'cwd':bbpath},function(_0x31bc6){if(_0x31bc6)logger['full'](_0x31bc6);});else(_0x1aec8f[_0x9deb7a(0x13e)]==_0x9deb7a(0x14b)||_0x1aec8f['status']=='new-disabled')&&await logger[_0x9deb7a(0x1ec)](_0x9deb7a(0x116)+_0x1aec8f['botID']+_0x9deb7a(0x1b8)+_0x1aec8f[_0x9deb7a(0x1c7)]);}else!newBot&&logger[_0x9deb7a(0x18a)](_0x9deb7a(0x171));if(newBot)addBot();logger[_0x9deb7a(0x18a)](_0x9deb7a(0x123)),logger['simple']('');}function startSocket(){const _0x307f1e=_0x2d323a;io['on'](_0x307f1e(0x106),_0x363b43=>{const _0x98f718=_0x307f1e;let _0x592ee5,_0x40dbe0,_0x51dc7f,_0x45e0e5,_0x1d3c59;const _0x4b722f=_0x363b43[_0x98f718(0x254)][_0x98f718(0x1f7)][_0x98f718(0x1fe)];_0x40dbe0=_0x4b722f[_0x98f718(0x169)](/bot[0-9]{3}/);if(_0x40dbe0)_0x51dc7f=_0x40dbe0[0x0][_0x98f718(0x169)](/[0-9]{3}/);if(_0x51dc7f)_0x592ee5=_0x51dc7f[0x0];else _0x592ee5='botmanager';const _0x12b85a=_0x363b43[_0x98f718(0x254)][_0x98f718(0xf3)][_0x98f718(0x257)];if(!_0x12b85a)_0x363b43[_0x98f718(0xac)](_0x98f718(0x13e),{'publicKey':secure[_0x98f718(0x1a1)]});else{_0x45e0e5=timelyDecrypt(_0x12b85a,![]);if(!_0x45e0e5)_0x363b43[_0x98f718(0xac)](_0x98f718(0x13e),{'publicKey':secure[_0x98f718(0x1a1)]});else{_0x1d3c59=normalizeIP(_0x363b43['conn'][_0x98f718(0x24d)])[_0x98f718(0xc9)];if(!devices[_0x45e0e5])devices[_0x45e0e5]={'uuid':_0x45e0e5,'access':{'token':null}};devices[_0x45e0e5]['ip']=_0x1d3c59;const _0x6dfeea=addClient(_0x363b43['id'],_0x45e0e5,_0x592ee5);setAccess(_0x6dfeea),emitMessages(),_0x363b43['on'](_0x98f718(0x10b),_0x589ecc=>{const _0xc5a9ca=_0x98f718,_0x47c8b3=timelyDecrypt(_0x589ecc['password']);if(_0x47c8b3){_0x589ecc={'username':_0x589ecc['username'],'password':_0x47c8b3},devices[_0x45e0e5][_0xc5a9ca(0xb6)]=validateCredentials(_0x589ecc,_0x45e0e5);if(devices[_0x45e0e5][_0xc5a9ca(0xb6)][_0xc5a9ca(0x1ff)]==![]&&devices[_0x45e0e5][_0xc5a9ca(0xb6)][_0xc5a9ca(0x223)]==_0xc5a9ca(0x140))_0x363b43[_0xc5a9ca(0xac)](_0xc5a9ca(0x13e),{'access':devices[_0x45e0e5][_0xc5a9ca(0xb6)]}),loginAccess2FA(_0x45e0e5,_0x1d3c59);else{if(devices[_0x45e0e5][_0xc5a9ca(0xb6)][_0xc5a9ca(0x1ff)]==![]&&devices[_0x45e0e5][_0xc5a9ca(0xb6)][_0xc5a9ca(0x223)]=='invalid\x20credentials')_0x363b43['emit'](_0xc5a9ca(0x13e),{'access':devices[_0x45e0e5][_0xc5a9ca(0xb6)]});else devices[_0x45e0e5][_0xc5a9ca(0xb6)][_0xc5a9ca(0x1ff)]&&devices[_0x45e0e5][_0xc5a9ca(0xb6)][_0xc5a9ca(0x223)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x45e0e5)[_0xc5a9ca(0xcb)](_0x49a88f=>{setAccess(_0x49a88f);}),logger[_0xc5a9ca(0x100)]('Logged\x20in\x20user\x20...'+_0x45e0e5[_0xc5a9ca(0x13d)](-0x8)),setTokenRefresh(_0x45e0e5),setSessionTimeout(_0xc5a9ca(0x10b),_0x45e0e5));}}else logger['full'](_0xc5a9ca(0x178));}),_0x363b43['on']('reset-password',()=>{resetPassword();}),_0x363b43['on'](_0x98f718(0x1b6),_0x2158aa=>{removeClient(_0x363b43['id']);}),_0x592ee5==_0x98f718(0x23f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4c2363){const _0xa60345=_0x2d323a;if(_0x4c2363!='botmanager'&&config[_0xa60345(0x1d0)]!=''){if(pid[_0x4c2363])pid[_0x4c2363][_0xa60345(0x25c)]({'function':_0xa60345(0x1d7),'args':null});}_0x4c2363!=_0xa60345(0x23f)&&broadcastToBots('bots',JSON[_0xa60345(0x22d)](config));}function reloadBotManager(){const _0x6e5235=_0x2d323a;getClientsWithBotID(_0x6e5235(0x23f))[_0x6e5235(0xcb)](_0xc1ef36=>{const _0x55a3ef=_0x6e5235;getSocket(_0xc1ef36['id'])[_0x55a3ef(0xac)](_0x55a3ef(0x13e),{'access':{'allow':![],'reason':_0x55a3ef(0x243),'token':null}});});}function getSocket(_0x33f163){const _0x46b57c=_0x2d323a;return io[_0x46b57c(0x23c)][_0x46b57c(0x23c)][_0x46b57c(0x202)](_0x33f163);}function setAccess(_0x27aa39){const _0x551bf6=_0x2d323a,_0x4443e1=getSocket(_0x27aa39['id']),_0x200c79=_0x27aa39[_0x551bf6(0xb1)],_0x12054d=_0x27aa39['bot'];devices[_0x200c79][_0x551bf6(0xb6)]=validateAccess(devices[_0x200c79]['access']['token'],_0x200c79),logger[_0x551bf6(0x100)]('Setting\x20access:\x20'+devices[_0x200c79][_0x551bf6(0xb6)][_0x551bf6(0x223)]+_0x551bf6(0xcc)+_0x27aa39['id']['slice'](-0x8)+_0x551bf6(0x148)+_0x200c79[_0x551bf6(0x13d)](-0x8)),_0x4443e1['join'](_0x200c79);if(devices[_0x200c79][_0x551bf6(0xb6)][_0x551bf6(0x1ff)]){_0x4443e1['join'](_0x12054d);if(_0x12054d=='botmanager')initializeSocketBotManager(_0x4443e1);else initializeSocketBot(_0x4443e1);initClient(_0x12054d);}devices[_0x200c79][_0x551bf6(0xb6)]['token']&&devices[_0x200c79][_0x551bf6(0xb6)]['reason']==_0x551bf6(0x1d1)&&setSessionTimeout(_0x551bf6(0x16a),_0x200c79),devices[_0x200c79][_0x551bf6(0xb6)]['token']&&devices[_0x200c79][_0x551bf6(0xb6)]['reason']==_0x551bf6(0x1e1)&&setSessionTimeout(_0x551bf6(0x10b),_0x200c79),_0x4443e1[_0x551bf6(0xac)](_0x551bf6(0x13e),{'status':_0x27aa39[_0x551bf6(0x153)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x200c79][_0x551bf6(0xb6)],'externalip':devices[_0x200c79]['ip'],'publicKey':secure[_0x551bf6(0x1a1)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x200c79][_0x551bf6(0xb6)][_0x551bf6(0x1ff)]==![]&&devices[_0x200c79]['access'][_0x551bf6(0x223)]==_0x551bf6(0x13a)&&temporaryAccess2FA(_0x200c79,devices[_0x200c79]['ip']);}function setSessionTimeout(_0x3edfe9,_0x4e4a02){const _0xa271cf=_0x2d323a;let _0x1dbcf3;if(_0x3edfe9==_0xa271cf(0x10b))_0x1dbcf3=loginExpiry*0x3c*0x3e8;else _0x1dbcf3=devices[_0x4e4a02]['telegramIpApproval'][_0xa271cf(0x1a6)]*0x3c*0x3e8-(new Date()[_0xa271cf(0x16c)]()-devices[_0x4e4a02][_0xa271cf(0x139)][_0xa271cf(0x259)]);if(devices[_0x4e4a02][_0xa271cf(0x1da)])clearTimeout(devices[_0x4e4a02]['pidExpireLogin']);devices[_0x4e4a02][_0xa271cf(0x1da)]=setTimeout(()=>{const _0x44194c=_0xa271cf;if(devices[_0x4e4a02][_0x44194c(0x19e)])clearTimeout(devices[_0x4e4a02][_0x44194c(0x19e)]);removeSocketListeners(_0x4e4a02),addBlacklist(_0x4e4a02),devices[_0x4e4a02][_0x44194c(0x139)]=null,devices[_0x4e4a02][_0x44194c(0x1d4)]=null,devices[_0x4e4a02][_0x44194c(0xb6)]['token']=null,logger[_0x44194c(0x100)](_0x44194c(0x16e)+_0x4e4a02[_0x44194c(0x13d)](-0x8)),devices[_0x4e4a02][_0x44194c(0xb6)]=validateAccess(devices[_0x4e4a02][_0x44194c(0xb6)][_0x44194c(0x22e)],_0x4e4a02),!(devices[_0x4e4a02][_0x44194c(0xb6)][_0x44194c(0x1ff)]&&devices[_0x4e4a02]['access'][_0x44194c(0x223)]==_0x44194c(0xce))&&(_0x3edfe9==_0x44194c(0x10b)?io['to'](_0x4e4a02)[_0x44194c(0xac)](_0x44194c(0x13e),{'access':{'allow':![],'reason':_0x44194c(0x19d),'token':null}}):io['to'](_0x4e4a02)[_0x44194c(0xac)]('status',{'access':{'allow':![],'reason':_0x44194c(0x255),'token':null}})),devices[_0x4e4a02][_0x44194c(0xb6)][_0x44194c(0x22e)]=null;},_0x1dbcf3);}function setTokenRefresh(_0x250f9f){const _0x2f64d6=_0x2d323a;if(devices[_0x250f9f][_0x2f64d6(0x19e)])clearTimeout(devices[_0x250f9f][_0x2f64d6(0x19e)]);devices[_0x250f9f][_0x2f64d6(0x19e)]=setTimeout(()=>{const _0x37ccfb=_0x2f64d6;getClientsWithUuid(_0x250f9f)['length']!=0x0?(devices[_0x250f9f][_0x37ccfb(0xb6)]=refreshToken(_0x250f9f),io['to'](_0x250f9f)['emit'](_0x37ccfb(0x13e),{'status':_0x37ccfb(0x1f1),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x250f9f][_0x37ccfb(0xb6)],'externalip':devices[_0x250f9f]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x250f9f)):clearTimeout(devices[_0x250f9f][_0x37ccfb(0x19e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5da2ac){const _0x10dae6=_0x2d323a,_0x7b4622=getClient(_0x5da2ac['id'])[_0x10dae6(0xb1)];_0x5da2ac['emit'](_0x10dae6(0xff),config),_0x5da2ac[_0x10dae6(0xac)](_0x10dae6(0x12d),cleanSettings()),_0x5da2ac['on'](_0x10dae6(0xe2),_0x5696d1=>{const _0x133565=_0x10dae6;if(validateAccess(_0x5696d1,_0x7b4622)['allow'])addBot();else logger[_0x133565(0x1ec)](_0x133565(0x24e));}),_0x5da2ac['on'](_0x10dae6(0xef),(_0x21d94e,_0x510878)=>{const _0x457574=_0x10dae6;if(validateAccess(_0x510878,_0x7b4622)[_0x457574(0x1ff)])toggleBot(_0x21d94e[_0x457574(0x10d)],_0x21d94e['status'],_0x21d94e[_0x457574(0x1b2)]);else logger['full'](_0x457574(0x14e));}),_0x5da2ac['on'](_0x10dae6(0xb3),(_0x26dcdb,_0x91c618)=>{const _0x369bad=_0x10dae6;if(validateAccess(_0x91c618,_0x7b4622)[_0x369bad(0x1ff)])toggleBotMode(_0x26dcdb);else logger[_0x369bad(0x1ec)](_0x369bad(0x14e));}),_0x5da2ac['on'](_0x10dae6(0x11f),(_0x1fa6a0,_0x4f7630)=>{const _0x482fff=_0x10dae6;if(validateAccess(_0x4f7630,_0x7b4622)[_0x482fff(0x1ff)])deleteBot(_0x1fa6a0);else logger[_0x482fff(0x1ec)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x5da2ac['on'](_0x10dae6(0x8b),(_0x22bcea,_0x1a9ede)=>{const _0x5ac9e1=_0x10dae6;if(validateAccess(_0x1a9ede,_0x7b4622)[_0x5ac9e1(0x1ff)])storeSettings(_0x22bcea,!![]);else logger['full'](_0x5ac9e1(0x19b));}),_0x5da2ac['on'](_0x10dae6(0xe0),_0x1a536d=>{const _0x110e7f=_0x10dae6;if(validateAccess(_0x1a536d,_0x7b4622)[_0x110e7f(0x1ff)])updateBB(_0x110e7f(0x13f));else logger[_0x110e7f(0x1ec)](_0x110e7f(0x1fb));}),_0x5da2ac['on']('reinstall-bb',_0x3f5b51=>{const _0x2e6f1b=_0x10dae6;if(validateAccess(_0x3f5b51,_0x7b4622)[_0x2e6f1b(0x1ff)])updateBB(_0x2e6f1b(0x1e6));else logger[_0x2e6f1b(0x1ec)](_0x2e6f1b(0x21e));}),_0x5da2ac['on'](_0x10dae6(0x167),_0x3a657b=>{const _0x48e89e=_0x10dae6;if(validateAccess(_0x3a657b,_0x7b4622)[_0x48e89e(0x1ff)]){const _0x2c88c8=getClient(_0x5da2ac['id']);if(_0x2c88c8)getBackupFiles(_0x2c88c8[_0x48e89e(0xb1)]);else logger[_0x48e89e(0x1ec)](_0x48e89e(0x21f));}else logger[_0x48e89e(0x1ec)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x5da2ac['on'](_0x10dae6(0xc3),(_0x42fee8,_0x528939)=>{const _0x451240=_0x10dae6;if(validateAccess(_0x528939,_0x7b4622)[_0x451240(0x1ff)])restoreBackupFile(_0x42fee8);else logger[_0x451240(0x1ec)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5da2ac['on']('get-messages',_0x3b5ab4=>{if(validateAccess(_0x3b5ab4,_0x7b4622)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5da2ac['on']('confirm-message',(_0x2e34fb,_0x2a18f9)=>{const _0x5d8ab1=_0x10dae6;if(validateAccess(_0x2a18f9,_0x7b4622)[_0x5d8ab1(0x1ff)])confirmMessage(_0x2e34fb);else logger['full'](_0x5d8ab1(0xbd));}),_0x5da2ac['on'](_0x10dae6(0xd3),_0x35d29c=>{const _0x164ec4=_0x10dae6;if(validateAccess(_0x35d29c,_0x7b4622)[_0x164ec4(0x1ff)]){if(devices[_0x7b4622][_0x164ec4(0x19e)])clearTimeout(devices[_0x7b4622]['pidRefreshToken']);if(devices[_0x7b4622]['pidExpireLogin'])clearTimeout(devices[_0x7b4622][_0x164ec4(0x1da)]);removeSocketListeners(getClient(_0x5da2ac['id'])[_0x164ec4(0xb1)]),addBlacklist(_0x7b4622),devices[_0x7b4622][_0x164ec4(0x139)]=null,devices[_0x7b4622][_0x164ec4(0x1d4)]=null,devices[_0x7b4622][_0x164ec4(0xb6)]['token']=null,logger['debug'](_0x164ec4(0xd4)+_0x7b4622[_0x164ec4(0x13d)](-0x8)),io['to'](getClient(_0x5da2ac['id'])[_0x164ec4(0xb1)])['emit'](_0x164ec4(0x13e),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x164ec4(0x1ec)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x2de562){const _0xe0bdfe=_0x2d323a,_0x4b8ba4=getClient(_0x2de562['id'])[_0xe0bdfe(0x244)],_0x54c8da=getClient(_0x2de562['id'])[_0xe0bdfe(0xb1)];_0x2de562['on'](_0xe0bdfe(0xc8),(_0x49bcca,_0x4fe077)=>{const _0x1b1a64=_0xe0bdfe;if(validateAccess(_0x4fe077,_0x54c8da)[_0x1b1a64(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x1b1a64(0x25c)]({'function':'emitHistory','args':_0x49bcca});}else logger[_0x1b1a64(0x1ec)](_0x1b1a64(0x90));}),_0x2de562['on'](_0xe0bdfe(0x237),(_0x19eca8,_0x1182de)=>{const _0x3dd247=_0xe0bdfe;if(validateAccess(_0x1182de,_0x54c8da)[_0x3dd247(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x3dd247(0x25c)]({'function':_0x3dd247(0x16b),'args':_0x19eca8});}else logger[_0x3dd247(0x1ec)](_0x3dd247(0x1cd));}),_0x2de562['on'](_0xe0bdfe(0x9d),(_0x305a98,_0x4f11d3)=>{const _0xef22c3=_0xe0bdfe;if(validateAccess(_0x4f11d3,_0x54c8da)[_0xef22c3(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0xef22c3(0x25c)]({'function':_0xef22c3(0x9c),'args':_0x305a98});}else logger['full'](_0xef22c3(0x1dd));}),_0x2de562['on'](_0xe0bdfe(0x1f8),(_0x39dc4a,_0x50b8ec)=>{const _0x298669=_0xe0bdfe;if(validateAccess(_0x50b8ec,_0x54c8da)['allow']){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x298669(0x25c)]({'function':_0x298669(0xbf),'args':_0x39dc4a});}else logger[_0x298669(0x1ec)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2de562['on'](_0xe0bdfe(0x228),(_0x5866ef,_0x4f859f)=>{const _0x5650f4=_0xe0bdfe;if(validateAccess(_0x4f859f,_0x54c8da)['allow']){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x5650f4(0x25c)]({'function':_0x5650f4(0x104),'args':_0x5866ef});}else logger[_0x5650f4(0x1ec)](_0x5650f4(0x226));}),_0x2de562['on'](_0xe0bdfe(0x232),(_0x2e7319,_0x2e5b44)=>{const _0x568ad9=_0xe0bdfe;if(validateAccess(_0x2e5b44,_0x54c8da)[_0x568ad9(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x568ad9(0x25c)]({'function':_0x568ad9(0x1bd),'args':_0x2e7319});}else logger[_0x568ad9(0x1ec)](_0x568ad9(0x177));}),_0x2de562['on'](_0xe0bdfe(0x21d),_0x430bb5=>{const _0x49a6c7=_0xe0bdfe;if(validateAccess(_0x430bb5,_0x54c8da)['allow']){if(pid[_0x4b8ba4])pid[_0x4b8ba4]['send']({'function':_0x49a6c7(0x1bc),'args':null});}else logger[_0x49a6c7(0x1ec)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2de562['on'](_0xe0bdfe(0xa7),_0x38e28d=>{const _0x1f27a9=_0xe0bdfe;if(validateAccess(_0x38e28d,_0x54c8da)[_0x1f27a9(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4]['send']({'function':_0x1f27a9(0x1e0),'args':null});}else logger[_0x1f27a9(0x1ec)](_0x1f27a9(0x138));}),_0x2de562['on'](_0xe0bdfe(0x1a2),(_0xfc6eec,_0x41b68b)=>{const _0x1e266f=_0xe0bdfe;if(validateAccess(_0x41b68b,_0x54c8da)[_0x1e266f(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x1e266f(0x25c)]({'function':'placeOrder','args':_0xfc6eec});}else logger[_0x1e266f(0x1ec)](_0x1e266f(0xfb));}),_0x2de562['on']('cancel-loading',_0x297895=>{const _0x5ec8e4=_0xe0bdfe;if(validateAccess(_0x297895,_0x54c8da)[_0x5ec8e4(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x5ec8e4(0x25c)]({'function':_0x5ec8e4(0xc4),'args':null});}else logger[_0x5ec8e4(0x1ec)](_0x5ec8e4(0x10e));}),_0x2de562['on'](_0xe0bdfe(0x173),_0x32eaaf=>{const _0x2dc45a=_0xe0bdfe;if(validateAccess(_0x32eaaf,_0x54c8da)[_0x2dc45a(0x1ff)]){if(pid[_0x4b8ba4])pid[_0x4b8ba4][_0x2dc45a(0x25c)]({'function':_0x2dc45a(0xde),'args':null});}else logger['full'](_0x2dc45a(0xd6));}),_0x2de562['on'](_0xe0bdfe(0xe0),_0x2014f0=>{const _0x3f74f0=_0xe0bdfe;if(validateAccess(_0x2014f0,_0x54c8da)[_0x3f74f0(0x1ff)])updateBB(_0x3f74f0(0x13f));else logger[_0x3f74f0(0x1ec)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2de562['on']('get-messages',_0x18970d=>{const _0x55c4ee=_0xe0bdfe;if(validateAccess(_0x18970d,_0x54c8da)[_0x55c4ee(0x1ff)])getMessages();else logger[_0x55c4ee(0x1ec)](_0x55c4ee(0x242));}),_0x2de562['on']('confirm-message',(_0x4f6d98,_0x4beaec)=>{const _0x4e2e94=_0xe0bdfe;if(validateAccess(_0x4beaec,_0x54c8da)[_0x4e2e94(0x1ff)])confirmMessage(_0x4f6d98);else logger[_0x4e2e94(0x1ec)](_0x4e2e94(0xbd));}),_0x2de562['on'](_0xe0bdfe(0xd3),_0x4f3083=>{const _0x210201=_0xe0bdfe;if(validateAccess(_0x4f3083,_0x54c8da)['allow']){if(devices[_0x54c8da]['pidRefreshToken'])clearTimeout(devices[_0x54c8da][_0x210201(0x19e)]);if(devices[_0x54c8da][_0x210201(0x1da)])clearTimeout(devices[_0x54c8da]['pidExpireLogin']);removeSocketListeners(getClient(_0x2de562['id'])[_0x210201(0xb1)]),addBlacklist(_0x54c8da),devices[_0x54c8da][_0x210201(0x139)]=null,devices[_0x54c8da][_0x210201(0x1d4)]=null,devices[_0x54c8da][_0x210201(0xb6)][_0x210201(0x22e)]=null,logger[_0x210201(0x100)](_0x210201(0xd4)+_0x54c8da['slice'](-0x8)),io['to'](getClient(_0x2de562['id'])[_0x210201(0xb1)])[_0x210201(0xac)]('status',{'access':{'allow':![],'reason':_0x210201(0x21a),'token':null}});}else logger[_0x210201(0x1ec)](_0x210201(0xf9));});}function removeSocketListeners(_0x58f15f){const _0x5daca6=_0x2d323a;getClientsWithUuid(_0x58f15f)[_0x5daca6(0xcb)](_0x37a5c1=>{const _0x1c2bd4=_0x5daca6;getSocket(_0x37a5c1['id'])[_0x1c2bd4(0x197)]();});}function cleanSettings(){const _0x5d7e4c=_0x2d323a;let _0x550ac0=settings;return settings[_0x5d7e4c(0x235)]&&settings['telegramToken']!=''&&(_0x550ac0={..._0x550ac0,'telegramToken':'************'}),settings[_0x5d7e4c(0x15b)]&&settings[_0x5d7e4c(0x15b)]!=''&&(_0x550ac0={..._0x550ac0,'bbPassword':_0x5d7e4c(0x146)}),(settings['bbPassword']&&settings[_0x5d7e4c(0x15b)]==_0x5d7e4c(0x159)||settings['telegramToken']&&settings[_0x5d7e4c(0x235)]==_0x5d7e4c(0x159))&&(_0x550ac0={..._0x550ac0,'restored':{'password':settings['bbPassword']=='***','telegram':settings['telegramToken']==_0x5d7e4c(0x159)}}),_0x550ac0;}async function updateBB(_0x16576b){const _0x26a9ba=_0x2d323a;await backupConfigFiles(),installingUpdate=!![],config[_0x26a9ba(0xcb)](_0x1671cc=>{const _0x40c775=_0x26a9ba;restartBot(_0x1671cc[_0x40c775(0x10d)]);}),logger[_0x26a9ba(0x100)](_0x26a9ba(0x137)+_0x16576b);if(_0x16576b=='update')process[_0x26a9ba(0x25c)]({'update':!![]},_0x1953d0=>{});else _0x16576b==_0x26a9ba(0x1e6)&&process[_0x26a9ba(0x25c)]({'reinstall':!![]},_0x193ad9=>{});}function startBot(_0x552250,_0x21ed90,_0x17f203){const _0x3594b1=_0x2d323a;if(debugging)_0x552250['push']('-d');let _0x5c786a=![];const _0x5a44a7=_0x552250[0x0];_0x21ed90={..._0x21ed90,'stdio':[_0x3594b1(0x1fc),_0x3594b1(0x1fc),_0x3594b1(0x1fc),'ipc']},pid[_0x5a44a7]=childProcess[_0x3594b1(0x145)](botfile,_0x552250,_0x21ed90),pid[_0x5a44a7]['on'](_0x3594b1(0x14a),_0x2270d3=>{const _0x1dcc85=_0x3594b1;switch(Object['keys'](_0x2270d3)[0x0]){case'botname':updateBotName(_0x5a44a7,_0x2270d3[_0x1dcc85(0x1c7)]);break;case _0x1dcc85(0xf5):updateBotManager();break;case'status':updateStatus(_0x5a44a7,_0x2270d3['status']);break;case _0x1dcc85(0x1b2):updateLive(_0x5a44a7,_0x2270d3[_0x1dcc85(0x1b2)]);break;case _0x1dcc85(0x10f):updateLive(_0x5a44a7,_0x2270d3[_0x1dcc85(0x10f)]),io['to'](_0x5a44a7)[_0x1dcc85(0xac)](_0x1dcc85(0x13e),{'access':{'allow':![],'reason':_0x1dcc85(0x243),'token':null}});break;case _0x1dcc85(0x9a):_0x2270d3[_0x1dcc85(0x9a)]==_0x1dcc85(0x258)&&restartBot(_0x5a44a7);_0x2270d3[_0x1dcc85(0x9a)]==_0x1dcc85(0x11d)&&toggleBot(_0x5a44a7,_0x1dcc85(0x14b),_0x1dcc85(0x9e));break;case _0x1dcc85(0x188):sendTelegram(_0x5a44a7,_0x2270d3['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x2270d3[_0x1dcc85(0xaf)]);break;case _0x1dcc85(0x174):io['to'](_0x5a44a7)[_0x1dcc85(0xac)](_0x2270d3[_0x1dcc85(0x174)],_0x2270d3['args']);break;}}),pid[_0x5a44a7]['on'](_0x3594b1(0x20b),function(_0x1a2a79){if(_0x5c786a)return;_0x5c786a=!![],_0x17f203(_0x1a2a79);}),pid[_0x5a44a7]['on']('exit',async function(_0x117829){const _0x8e3ec7=_0x3594b1;if(installingUpdate)return;if(_0x5c786a)return;_0x5c786a=!![],_0x17f203(null);const _0x2620d6=dbConfig[_0x8e3ec7(0x202)](_0x8e3ec7(0xff))[_0x8e3ec7(0xc7)]({'botID':_0x5a44a7})[_0x8e3ec7(0x155)]();_0x2620d6&&(_0x2620d6[_0x8e3ec7(0x13e)]==_0x8e3ec7(0x1d6)||_0x2620d6[_0x8e3ec7(0x13e)]==_0x8e3ec7(0x91))&&(await sleep(0x3e8),updateLive(_0x5a44a7,_0x8e3ec7(0x9e)),logger[_0x8e3ec7(0x1ec)](_0x8e3ec7(0xd5)+_0x5a44a7),startBot([_0x5a44a7,userID],{'cwd':bbpath},function(_0x192b8a){const _0xb3ae3b=_0x8e3ec7;if(_0x192b8a)logger[_0xb3ae3b(0x1ec)](_0x192b8a);}));});}function stopBot(_0x58367a){const _0x41d004=_0x2d323a;getClientsWithBotID(_0x58367a)[_0x41d004(0xcb)](_0x2a6742=>{const _0x449d31=_0x41d004;getSocket(_0x2a6742['id'])[_0x449d31(0x1b6)](!![]),removeClient(_0x2a6742['id']);}),pid[_0x58367a]&&(pid[_0x58367a][_0x41d004(0x11d)](),pid[_0x58367a]=null);}function restartBot(_0xf8145b){const _0x1142a7=_0x2d323a;if(pid[_0xf8145b])pid[_0xf8145b][_0x1142a7(0x11d)]();}function addBot(){const _0x2c95ca=_0x2d323a;let _0x4e4ea2;for(let _0x4b0939=0x1;_0x4b0939<0x3e9;_0x4b0939++){_0x4e4ea2=_0x4b0939['toString']()['padStart'](0x3,'0');let _0xdec259=config['find'](_0x29bac2=>_0x29bac2[_0x2c95ca(0x10d)]==_0x4e4ea2);if(!_0xdec259)break;}if(_0x4e4ea2===_0x2c95ca(0x144)){logger[_0x2c95ca(0x1ec)](_0x2c95ca(0x12e));return;}logger['full'](_0x2c95ca(0xbc)+_0x4e4ea2),dbConfig[_0x2c95ca(0x202)](_0x2c95ca(0xff))[_0x2c95ca(0x1e7)]({'botID':_0x4e4ea2,'botname':_0x2c95ca(0x1f0)+_0x4e4ea2,'status':_0x2c95ca(0x91),'live':''})[_0x2c95ca(0x1ce)](),startBot([_0x4e4ea2,userID],{'cwd':bbpath},function(_0x3ab35a){const _0x32e6bb=_0x2c95ca;if(_0x3ab35a)logger[_0x32e6bb(0x1ec)](_0x3ab35a);}),config=getConfiguration(),io['to'](_0x2c95ca(0x23f))[_0x2c95ca(0xac)](_0x2c95ca(0xff),config),broadcastToBots(_0x2c95ca(0xff),JSON[_0x2c95ca(0x22d)](config));}function deleteBot(_0x3df0d1){const _0x2c14e5=_0x2d323a;getClientsWithBotID(_0x3df0d1)[_0x2c14e5(0xcb)](_0x32d1f3=>{getSocket(_0x32d1f3['id'])['disconnect'](!![]),removeClient(_0x32d1f3['id']);}),dbConfig[_0x2c14e5(0x202)](_0x2c14e5(0xff))['remove']({'botID':_0x3df0d1})[_0x2c14e5(0x1ce)](),logger[_0x2c14e5(0x1ec)]('Deleted\x20Bot\x20'+_0x3df0d1),stopBot(_0x3df0d1);try{if(fs[_0x2c14e5(0xfe)](path[_0x2c14e5(0x15d)](configpath,'bot-'+_0x3df0d1+'-config.json')))fs[_0x2c14e5(0x176)](path[_0x2c14e5(0x15d)](configpath,_0x2c14e5(0xe1)+_0x3df0d1+_0x2c14e5(0x147)));if(fs[_0x2c14e5(0xfe)](path['join'](configpath,_0x2c14e5(0xe1)+_0x3df0d1+'-events.json')))fs['unlinkSync'](path[_0x2c14e5(0x15d)](configpath,_0x2c14e5(0xe1)+_0x3df0d1+'-events.json'));if(fs[_0x2c14e5(0xfe)](path[_0x2c14e5(0x15d)](configpath,_0x2c14e5(0xe1)+_0x3df0d1+_0x2c14e5(0x158))))fs['unlinkSync'](path[_0x2c14e5(0x15d)](configpath,_0x2c14e5(0xe1)+_0x3df0d1+'-performance.json'));if(fs[_0x2c14e5(0xfe)](path['join'](configpath,_0x2c14e5(0xe1)+_0x3df0d1+_0x2c14e5(0x12b))))fs[_0x2c14e5(0x176)](path[_0x2c14e5(0x15d)](configpath,_0x2c14e5(0xe1)+_0x3df0d1+_0x2c14e5(0x12b)));}catch(_0x4631e4){if(_0x4631e4)logger[_0x2c14e5(0x1ec)](_0x2c14e5(0xe7),_0x4631e4);}config=getConfiguration(),io['to'](_0x2c14e5(0x23f))[_0x2c14e5(0xac)]('bots',config),broadcastToBots(_0x2c14e5(0xff),JSON[_0x2c14e5(0x22d)](config));}function toggleBot(_0x61fc73,_0x5d4d19,_0x19bee3){const _0x2e1089=_0x2d323a;dbConfig['get'](_0x2e1089(0xff))['find']({'botID':_0x61fc73})[_0x2e1089(0xf1)]({'status':_0x5d4d19})[_0x2e1089(0xf1)]({'live':_0x19bee3})['write']();if(_0x5d4d19==_0x2e1089(0x1d6)||_0x5d4d19==_0x2e1089(0x91))logger[_0x2e1089(0x1ec)](_0x2e1089(0x1a8)+_0x61fc73),startBot([_0x61fc73,userID],{'cwd':bbpath},function(_0x32deca){const _0x2afa2b=_0x2e1089;if(_0x32deca)logger[_0x2afa2b(0x1ec)](_0x32deca);});else(_0x5d4d19==_0x2e1089(0x14b)||_0x5d4d19==_0x2e1089(0x25b))&&(logger['full'](_0x2e1089(0xa8)+_0x61fc73),stopBot(_0x61fc73));config=getConfiguration(),io['to'](_0x2e1089(0x23f))[_0x2e1089(0xac)](_0x2e1089(0xff),config),broadcastToBots(_0x2e1089(0xff),JSON[_0x2e1089(0x22d)](config));}function toggleStatus(_0x1e5a56){const _0x1816a1=_0x2d323a;let _0x357054=dbConfig[_0x1816a1(0x202)](_0x1816a1(0xff))['find']({'botID':_0x1e5a56})['value'](),_0x1cd325;if(_0x357054[_0x1816a1(0x13e)]===_0x1816a1(0x1d6))_0x1cd325=_0x1816a1(0x14b);else{if(_0x357054[_0x1816a1(0x13e)]==='new')_0x1cd325=_0x1816a1(0x25b);else{if(_0x357054[_0x1816a1(0x13e)]===_0x1816a1(0x25b))_0x1cd325=_0x1816a1(0x91);else{if(_0x357054['status']==='disabled')_0x1cd325=_0x1816a1(0x1d6);}}}return _0x1cd325;}function updateStatus(_0x196ad3,_0x3cf04c){const _0x5983bf=_0x2d323a;dbConfig['get'](_0x5983bf(0xff))[_0x5983bf(0xc7)]({'botID':_0x196ad3})[_0x5983bf(0xf1)]({'status':_0x3cf04c})[_0x5983bf(0x1ce)](),config=getConfiguration(),io['to'](_0x5983bf(0x23f))['emit'](_0x5983bf(0xff),config),broadcastToBots('bots',JSON[_0x5983bf(0x22d)](config));}function updateLive(_0x3607b3,_0x19fdf9){const _0x566d1e=_0x2d323a;dbConfig[_0x566d1e(0x202)](_0x566d1e(0xff))['find']({'botID':_0x3607b3})['assign']({'live':_0x19fdf9})[_0x566d1e(0x1ce)](),config=getConfiguration(),io['to'](_0x566d1e(0x23f))[_0x566d1e(0xac)](_0x566d1e(0xff),config),broadcastToBots('bots',JSON[_0x566d1e(0x22d)](config));}function updateBotName(_0x2e6dd3,_0x5105b7){const _0x2f6c7c=_0x2d323a;dbConfig[_0x2f6c7c(0x202)](_0x2f6c7c(0xff))[_0x2f6c7c(0xc7)]({'botID':_0x2e6dd3})[_0x2f6c7c(0xf1)]({'botname':_0x5105b7})[_0x2f6c7c(0x1ce)](),config=getConfiguration(),io['to'](_0x2f6c7c(0x23f))['emit'](_0x2f6c7c(0xff),config),broadcastToBots('bots',JSON[_0x2f6c7c(0x22d)](config));}function updateBotManager(){const _0x3b331e=_0x2d323a;config=getConfiguration(),io['to'](_0x3b331e(0x23f))['emit'](_0x3b331e(0xff),config),broadcastToBots(_0x3b331e(0xff),JSON[_0x3b331e(0x22d)](config));}function toggleBotMode(_0x37c229){const _0x1fa602=_0x2d323a;if(pid[_0x37c229])pid[_0x37c229][_0x1fa602(0x25c)]({'function':_0x1fa602(0x222),'args':null});else{const _0x3534e1=configpath+_0x1fa602(0xe1)+_0x37c229+_0x1fa602(0x147),_0x49b321=fs[_0x1fa602(0xb2)](_0x3534e1),_0x7b7622=JSON[_0x1fa602(0x119)](_0x49b321),_0x44ecfc=_0x7b7622[_0x1fa602(0x244)][0x0][_0x1fa602(0x186)];_0x7b7622['bot'][0x0][_0x1fa602(0x186)]=!_0x44ecfc;const _0x36e039=JSON['stringify'](_0x7b7622,null,0x2);fs['writeFileSync'](_0x3534e1,_0x36e039),config=getConfiguration(),io['to'](_0x1fa602(0x23f))[_0x1fa602(0xac)]('bots',config),broadcastToBots(_0x1fa602(0xff),JSON[_0x1fa602(0x22d)](config));}}function telegramError(_0x28fc05){const _0x2e6561=_0x2d323a;logger[_0x2e6561(0x18a)](getTimeStamp()+_0x2e6561(0x109));}function validateTelegram(_0x28c132){const _0x5609ec=_0x2d323a;if(_0x28c132[_0x5609ec(0x180)]['username']!=settings[_0x5609ec(0x156)]&&'@'+_0x28c132[_0x5609ec(0x180)][_0x5609ec(0xbe)]!=settings[_0x5609ec(0x156)])return tgBot[_0x5609ec(0xa2)](_0x28c132[_0x5609ec(0xc1)]['id'],_0x5609ec(0x1df),{'parse_mode':_0x5609ec(0x193)})[_0x5609ec(0x8e)](_0x4aabe2=>{telegramError(_0x4aabe2);}),![];return!![];}async function initTelegram(){const _0x2de830=_0x2d323a;if(tgBot)tgBot[_0x2de830(0x99)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2de830(0x235)],{'polling':!![]});let _0x400384='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x400384+='\x0a',_0x400384+=_0x2de830(0xc0),_0x400384+=_0x2de830(0x229),_0x400384+=_0x2de830(0xb7),_0x400384+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x400384+=_0x2de830(0xf0),_0x400384+=_0x2de830(0x114),_0x400384+=_0x2de830(0x8d),_0x400384+='/names\x20-\x20show\x20bot\x20names\x0a',_0x400384+=_0x2de830(0x1c0),_0x400384+=_0x2de830(0x20d),_0x400384+=_0x2de830(0x9b),_0x400384+=_0x2de830(0x22a),_0x400384+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x400384+='/help\x20-\x20show\x20available\x20commands\x0a';let _0xf952ac=_0x2de830(0x1ea);_0xf952ac+='\x0a',_0xf952ac+=_0x400384,tgBot[_0x2de830(0x1ad)](/\/start/,_0x311628=>{const _0x79fecd=_0x2de830;if(!validateTelegram(_0x311628))return;if(settings[_0x79fecd(0x17c)]!=_0x311628[_0x79fecd(0xc1)]['id'])updateSetting(_0x79fecd(0x17c),_0x311628['chat']['id']);updateSetting(_0x79fecd(0xab),!![]),tgBot['sendMessage'](_0x311628[_0x79fecd(0xc1)]['id'],_0xf952ac)[_0x79fecd(0x8e)](_0x30fdb7=>{telegramError(_0x30fdb7);});}),tgBot['onText'](/\/enable/,_0x2d558c=>{const _0x457d90=_0x2de830;if(!validateTelegram(_0x2d558c))return;if(settings[_0x457d90(0x17c)]!=_0x2d558c[_0x457d90(0xc1)]['id'])updateSetting(_0x457d90(0x17c),_0x2d558c[_0x457d90(0xc1)]['id']);updateSetting(_0x457d90(0xab),!![]),tgBot['sendMessage'](_0x2d558c[_0x457d90(0xc1)]['id'],_0x457d90(0x1e3))['catch'](_0x24691a=>{telegramError(_0x24691a);});}),tgBot[_0x2de830(0x1ad)](/\/config/,async _0x396a11=>{const _0x282ea4=_0x2de830;if(!validateTelegram(_0x396a11))return;tgBot['removeListener'](_0x282ea4(0x1c4)),tgBot[_0x282ea4(0xa2)](_0x396a11['chat']['id'],_0x282ea4(0x23a),{'reply_markup':{'inline_keyboard':[[{'text':_0x282ea4(0x1c8),'callback_data':_0x282ea4(0x120)},{'text':_0x282ea4(0x212),'callback_data':_0x282ea4(0x132)},{'text':'All','callback_data':_0x282ea4(0xed)}]]}})[_0x282ea4(0x8e)](_0x17948c=>{telegramError(_0x17948c);}),tgBot['on']('callback_query',async _0x5f019b=>{const _0x5eb46c=_0x282ea4,_0x1deff8=_0x5f019b[_0x5eb46c(0x201)],_0x3bb448=_0x5f019b[_0x5eb46c(0x14a)];tgBot[_0x5eb46c(0x1cc)](_0x5f019b['id'])[_0x5eb46c(0xa6)](async()=>{const _0x4474ab=_0x5eb46c;_0x1deff8==_0x4474ab(0x120)&&(updateSetting('telegramEvents',_0x4474ab(0x120)),updateSetting(_0x4474ab(0xab),!![]),await tgBot['sendMessage'](_0x3bb448[_0x4474ab(0xc1)]['id'],_0x4474ab(0x196))[_0x4474ab(0x8e)](_0x4a4cfa=>{telegramError(_0x4a4cfa);}));_0x1deff8==_0x4474ab(0x132)&&(updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x4474ab(0xa2)](_0x3bb448['chat']['id'],_0x4474ab(0x21b))['catch'](_0x39f1ec=>{telegramError(_0x39f1ec);}));_0x1deff8==_0x4474ab(0xed)&&(updateSetting(_0x4474ab(0x125),_0x4474ab(0xed)),updateSetting(_0x4474ab(0xab),!![]),await tgBot[_0x4474ab(0xa2)](_0x3bb448[_0x4474ab(0xc1)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x4474ab(0x8e)](_0x350713=>{telegramError(_0x350713);}));if(!settings[_0x4474ab(0x17c)])tgBot[_0x4474ab(0xa2)](_0x3bb448[_0x4474ab(0xc1)]['id'],_0x4474ab(0xd1))['catch'](_0x454389=>{telegramError(_0x454389);});}),tgBot[_0x5eb46c(0xfa)]('callback_query');});}),tgBot[_0x2de830(0x1ad)](/\/status/,_0x1a7a40=>{const _0x52d530=_0x2de830;if(!validateTelegram(_0x1a7a40))return;const _0x1276d0=getBotsWithMode();let _0x4eef53=_0x52d530(0x15a);config[_0x52d530(0xcb)](_0x2156dd=>{const _0x4fec36=_0x52d530,_0x153817=_0x1276d0['find'](_0x2a2c8f=>_0x2a2c8f['botID']==_0x2156dd['botID'])[_0x4fec36(0x17b)];_0x4eef53+=_0x4fec36(0x1f0)+_0x2156dd[_0x4fec36(0x10d)]+':\x20'+_0x2156dd['status']+_0x4fec36(0x1b8)+_0x153817+_0x4fec36(0x1b8)+_0x2156dd[_0x4fec36(0x1b2)]+'\x0a';}),_0x4eef53+='\x0a',_0x4eef53+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4eef53+=!settings[_0x52d530(0xab)]?_0x52d530(0x1a3):_0x52d530(0xf6),_0x4eef53+=settings[_0x52d530(0xab)]?settings[_0x52d530(0x125)]==_0x52d530(0xed)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x52d530(0xf8)+settings[_0x52d530(0x125)]+_0x52d530(0x199):'',tgBot[_0x52d530(0xa2)](_0x1a7a40['chat']['id'],_0x4eef53,{'parse_mode':'HTML'})[_0x52d530(0x8e)](_0xc5d5d4=>{telegramError(_0xc5d5d4);});}),tgBot['onText'](/\/restart/,_0x399142=>{const _0xe21446=_0x2de830;if(!validateTelegram(_0x399142))return;tgBot['removeListener']('callback_query');const _0x4eb882=getEnabledBots();if(_0x4eb882['length']==0x0)tgBot[_0xe21446(0xa2)](_0x399142[_0xe21446(0xc1)]['id'],_0xe21446(0x1cf))['catch'](_0x304232=>{telegramError(_0x304232);});else{if(_0x4eb882['length']>0x1)_0x4eb882['push']({'botID':_0xe21446(0xed)});let _0xbfaa73=[],_0x319ed7=[];const _0x122c86=_0x4eb882[_0xe21446(0x1e5)]%0x4==0x0||_0x4eb882[_0xe21446(0x1e5)]%0x4==0x3||_0x4eb882[_0xe21446(0x1e5)]%0x3==0x1?0x4:0x3;let _0x1fd43=0x0;_0x4eb882[_0xe21446(0xcb)]((_0x352ab3,_0x595fbd)=>{const _0x5874c5=_0xe21446;if(_0x595fbd%_0x122c86==0x0)_0x319ed7=[];_0x319ed7[_0x5874c5(0x1e7)]({'text':_0x352ab3[_0x5874c5(0x10d)]==_0x5874c5(0xed)?_0x5874c5(0x11c):_0x5874c5(0x1f0)+_0x352ab3[_0x5874c5(0x10d)],'callback_data':_0x352ab3['botID']}),_0x595fbd%_0x122c86==0x0&&(_0xbfaa73[_0x1fd43]=_0x319ed7,_0x1fd43++);}),tgBot[_0xe21446(0xa2)](_0x399142[_0xe21446(0xc1)]['id'],_0xe21446(0x161),{'reply_markup':{'inline_keyboard':_0xbfaa73}})[_0xe21446(0x8e)](_0x11d8d2=>{telegramError(_0x11d8d2);}),tgBot['on'](_0xe21446(0x1c4),async _0xe4eeb8=>{const _0x49bbd3=_0xe21446,_0x1ca9cf=_0xe4eeb8[_0x49bbd3(0x201)],_0x24ed43=_0xe4eeb8[_0x49bbd3(0x14a)];tgBot[_0x49bbd3(0x1cc)](_0xe4eeb8['id'])[_0x49bbd3(0xa6)](async()=>{const _0x3609ec=_0x49bbd3;_0x1ca9cf==_0x3609ec(0xed)?config[_0x3609ec(0xcb)](_0x131021=>{const _0x283fa8=_0x3609ec;restartBot(_0x131021[_0x283fa8(0x10d)]);}):restartBot(_0x1ca9cf);}),tgBot[_0x49bbd3(0xfa)]('callback_query');});}}),tgBot[_0x2de830(0x1ad)](/\/on/,_0x22f6cc=>{const _0x24700c=_0x2de830;if(!validateTelegram(_0x22f6cc))return;tgBot[_0x24700c(0xfa)](_0x24700c(0x1c4));const _0x3df058=getDisabledBots();if(_0x3df058[_0x24700c(0x1e5)]==0x0)tgBot[_0x24700c(0xa2)](_0x22f6cc[_0x24700c(0xc1)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x24700c(0x8e)](_0x5c3852=>{telegramError(_0x5c3852);});else{if(_0x3df058[_0x24700c(0x1e5)]>0x1)_0x3df058[_0x24700c(0x1e7)]({'botID':_0x24700c(0xed)});let _0x1fbcdb=[],_0x41b39f=[];const _0x1f1ee8=_0x3df058[_0x24700c(0x1e5)]%0x4==0x0||_0x3df058[_0x24700c(0x1e5)]%0x4==0x3||_0x3df058[_0x24700c(0x1e5)]%0x3==0x1?0x4:0x3;let _0x3990e1=0x0;_0x3df058[_0x24700c(0xcb)]((_0x2f846c,_0x127df2)=>{const _0x173b12=_0x24700c;if(_0x127df2%_0x1f1ee8==0x0)_0x41b39f=[];_0x41b39f[_0x173b12(0x1e7)]({'text':_0x2f846c[_0x173b12(0x10d)]==_0x173b12(0xed)?_0x173b12(0x11c):_0x173b12(0x1f0)+_0x2f846c[_0x173b12(0x10d)],'callback_data':_0x2f846c['botID']}),_0x127df2%_0x1f1ee8==0x0&&(_0x1fbcdb[_0x3990e1]=_0x41b39f,_0x3990e1++);}),tgBot['sendMessage'](_0x22f6cc[_0x24700c(0xc1)]['id'],_0x24700c(0x18d),{'reply_markup':{'inline_keyboard':_0x1fbcdb}})[_0x24700c(0x8e)](_0x67fb7b=>{telegramError(_0x67fb7b);}),tgBot['on']('callback_query',async _0x224c67=>{const _0x5629dc=_0x24700c,_0x48d2e0=_0x224c67[_0x5629dc(0x201)],_0x545e56=_0x224c67[_0x5629dc(0x14a)];tgBot[_0x5629dc(0x1cc)](_0x224c67['id'])[_0x5629dc(0xa6)](async()=>{const _0x51536e=_0x5629dc;_0x48d2e0==_0x51536e(0xed)?(tgBot[_0x51536e(0xa2)](_0x545e56[_0x51536e(0xc1)]['id'],_0x51536e(0x1ee))[_0x51536e(0x8e)](_0x513dc5=>{telegramError(_0x513dc5);}),_0x3df058[_0x51536e(0xcb)](_0x2d127d=>{const _0x56051c=_0x51536e;if(_0x2d127d['botID']!=_0x56051c(0xed))toggleBot(_0x2d127d['botID'],toggleStatus(_0x2d127d[_0x56051c(0x10d)]),_0x56051c(0x9e));})):(tgBot[_0x51536e(0xa2)](_0x545e56[_0x51536e(0xc1)]['id'],_0x51536e(0x98)+_0x48d2e0)[_0x51536e(0x8e)](_0x357a52=>{telegramError(_0x357a52);}),toggleBot(_0x48d2e0,toggleStatus(_0x48d2e0),'stopped'));}),tgBot[_0x5629dc(0xfa)](_0x5629dc(0x1c4));});}}),tgBot[_0x2de830(0x1ad)](/\/off/,_0x4a7ec3=>{const _0x1002df=_0x2de830;if(!validateTelegram(_0x4a7ec3))return;tgBot[_0x1002df(0xfa)](_0x1002df(0x1c4));const _0x391d28=getEnabledBots();if(_0x391d28[_0x1002df(0x1e5)]==0x0)tgBot[_0x1002df(0xa2)](_0x4a7ec3['chat']['id'],_0x1002df(0x1cf))[_0x1002df(0x8e)](_0x4b78e3=>{telegramError(_0x4b78e3);});else{if(_0x391d28[_0x1002df(0x1e5)]>0x1)_0x391d28[_0x1002df(0x1e7)]({'botID':_0x1002df(0xed)});let _0x56c4d1=[],_0x32534f=[];const _0x4fa010=_0x391d28[_0x1002df(0x1e5)]%0x4==0x0||_0x391d28['length']%0x4==0x3||_0x391d28['length']%0x3==0x1?0x4:0x3;let _0xaec8c6=0x0;_0x391d28['forEach']((_0x218bb3,_0x157bd2)=>{const _0x59613d=_0x1002df;if(_0x157bd2%_0x4fa010==0x0)_0x32534f=[];_0x32534f[_0x59613d(0x1e7)]({'text':_0x218bb3[_0x59613d(0x10d)]=='all'?_0x59613d(0x11c):_0x59613d(0x1f0)+_0x218bb3[_0x59613d(0x10d)],'callback_data':_0x218bb3[_0x59613d(0x10d)]}),_0x157bd2%_0x4fa010==0x0&&(_0x56c4d1[_0xaec8c6]=_0x32534f,_0xaec8c6++);}),tgBot[_0x1002df(0xa2)](_0x4a7ec3[_0x1002df(0xc1)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x56c4d1}})[_0x1002df(0x8e)](_0x242597=>{telegramError(_0x242597);}),tgBot['on']('callback_query',async _0x31c5d8=>{const _0x15a417=_0x1002df,_0x2deed2=_0x31c5d8[_0x15a417(0x201)],_0x3c7115=_0x31c5d8[_0x15a417(0x14a)];tgBot[_0x15a417(0x1cc)](_0x31c5d8['id'])[_0x15a417(0xa6)](async()=>{const _0x5ae608=_0x15a417;_0x2deed2==_0x5ae608(0xed)?(tgBot['sendMessage'](_0x3c7115[_0x5ae608(0xc1)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x5ae608(0x8e)](_0x2bdc29=>{telegramError(_0x2bdc29);}),_0x391d28[_0x5ae608(0xcb)](_0x265bea=>{const _0x42da7b=_0x5ae608;if(_0x265bea[_0x42da7b(0x10d)]!='all')toggleBot(_0x265bea[_0x42da7b(0x10d)],toggleStatus(_0x265bea['botID']),_0x42da7b(0x9e));})):(tgBot['sendMessage'](_0x3c7115['chat']['id'],_0x5ae608(0x20c)+_0x2deed2)[_0x5ae608(0x8e)](_0x4f8ad9=>{telegramError(_0x4f8ad9);}),toggleBot(_0x2deed2,toggleStatus(_0x2deed2),_0x5ae608(0x9e)));}),tgBot[_0x15a417(0xfa)](_0x15a417(0x1c4));});}}),tgBot['onText'](/\/metrics/,_0x5ab77d=>{const _0x345ad2=_0x2de830;if(!validateTelegram(_0x5ab77d))return;tgBot[_0x345ad2(0xfa)](_0x345ad2(0x1c4));const _0x850f91=getEnabledBots();if(_0x850f91[_0x345ad2(0x1e5)]==0x0)tgBot[_0x345ad2(0xa2)](_0x5ab77d[_0x345ad2(0xc1)]['id'],_0x345ad2(0x1cf))['catch'](_0x4392b1=>{telegramError(_0x4392b1);});else{if(_0x850f91[_0x345ad2(0x1e5)]>0x1){let _0x244b56=[],_0x44e368=[];const _0x31eb6a=_0x850f91[_0x345ad2(0x1e5)]%0x4==0x0||_0x850f91[_0x345ad2(0x1e5)]%0x4==0x3||_0x850f91[_0x345ad2(0x1e5)]%0x3==0x1?0x4:0x3;let _0x47e3d5=0x0;_0x850f91[_0x345ad2(0xcb)]((_0x9baf07,_0x5e2894)=>{const _0x49dd0b=_0x345ad2;if(_0x5e2894%_0x31eb6a==0x0)_0x44e368=[];_0x44e368[_0x49dd0b(0x1e7)]({'text':_0x49dd0b(0x1f0)+_0x9baf07[_0x49dd0b(0x10d)],'callback_data':_0x9baf07[_0x49dd0b(0x10d)]}),_0x5e2894%_0x31eb6a==0x0&&(_0x244b56[_0x47e3d5]=_0x44e368,_0x47e3d5++);}),tgBot[_0x345ad2(0xa2)](_0x5ab77d[_0x345ad2(0xc1)]['id'],_0x345ad2(0x166),{'reply_markup':{'inline_keyboard':_0x244b56}})[_0x345ad2(0x8e)](_0x2a8135=>{telegramError(_0x2a8135);}),tgBot['on'](_0x345ad2(0x1c4),async _0x476157=>{const _0x2c25fd=_0x345ad2,_0x2e5093=_0x476157[_0x2c25fd(0x201)],_0x5720c3=_0x476157['message'];tgBot[_0x2c25fd(0x1cc)](_0x476157['id'])[_0x2c25fd(0xa6)](async()=>{const _0x39ed1d=_0x2c25fd;if(pid[_0x2e5093])pid[_0x2e5093][_0x39ed1d(0x25c)]({'function':_0x39ed1d(0x13c),'args':null});}),tgBot[_0x2c25fd(0xfa)](_0x2c25fd(0x1c4));});}else{const _0x370bdd=_0x850f91[0x0][_0x345ad2(0x10d)];if(pid[_0x370bdd])pid[_0x370bdd][_0x345ad2(0x25c)]({'function':_0x345ad2(0x13c),'args':null});}}}),tgBot[_0x2de830(0x1ad)](/\/portfolio/,_0x4b4e10=>{const _0x5e7f3b=_0x2de830;if(!validateTelegram(_0x4b4e10))return;tgBot[_0x5e7f3b(0xfa)]('callback_query');const _0x5a4056=getEnabledBots();if(_0x5a4056[_0x5e7f3b(0x1e5)]==0x0)tgBot[_0x5e7f3b(0xa2)](_0x4b4e10['chat']['id'],_0x5e7f3b(0x1cf))[_0x5e7f3b(0x8e)](_0x51e93e=>{telegramError(_0x51e93e);});else{if(_0x5a4056[_0x5e7f3b(0x1e5)]>0x1){let _0x39105e=[],_0x5018de=[];const _0xe8eea=_0x5a4056[_0x5e7f3b(0x1e5)]%0x4==0x0||_0x5a4056[_0x5e7f3b(0x1e5)]%0x4==0x3||_0x5a4056['length']%0x3==0x1?0x4:0x3;let _0xd1d921=0x0;_0x5a4056[_0x5e7f3b(0xcb)]((_0x24cf46,_0x5e8f6c)=>{const _0x47e472=_0x5e7f3b;if(_0x5e8f6c%_0xe8eea==0x0)_0x5018de=[];_0x5018de['push']({'text':_0x47e472(0x1f0)+_0x24cf46[_0x47e472(0x10d)],'callback_data':_0x24cf46[_0x47e472(0x10d)]}),_0x5e8f6c%_0xe8eea==0x0&&(_0x39105e[_0xd1d921]=_0x5018de,_0xd1d921++);}),tgBot[_0x5e7f3b(0xa2)](_0x4b4e10[_0x5e7f3b(0xc1)]['id'],_0x5e7f3b(0x25a),{'reply_markup':{'inline_keyboard':_0x39105e}})['catch'](_0x1d3c86=>{telegramError(_0x1d3c86);}),tgBot['on'](_0x5e7f3b(0x1c4),async _0x28f78d=>{const _0x558c53=_0x5e7f3b,_0x61d278=_0x28f78d['data'],_0x244bc3=_0x28f78d[_0x558c53(0x14a)];tgBot['answerCallbackQuery'](_0x28f78d['id'])[_0x558c53(0xa6)](async()=>{const _0x5ac957=_0x558c53;if(pid[_0x61d278])pid[_0x61d278][_0x5ac957(0x25c)]({'function':_0x5ac957(0x1f5),'args':null});}),tgBot[_0x558c53(0xfa)](_0x558c53(0x1c4));});}else{const _0x5279a6=_0x5a4056[0x0][_0x5e7f3b(0x10d)];if(pid[_0x5279a6])pid[_0x5279a6][_0x5e7f3b(0x25c)]({'function':_0x5e7f3b(0x1f5),'args':null});}}}),tgBot[_0x2de830(0x1ad)](/\/update/,async _0x1238ad=>{const _0x50c35d=_0x2de830;if(!validateTelegram(_0x1238ad))return;tgBot[_0x50c35d(0xfa)](_0x50c35d(0x1c4)),await getMessages();if(!updateAvailable)tgBot[_0x50c35d(0xa2)](_0x1238ad[_0x50c35d(0xc1)]['id'],_0x50c35d(0x136))[_0x50c35d(0x8e)](_0x99b034=>{telegramError(_0x99b034);});else!validInstallation?tgBot[_0x50c35d(0xa2)](_0x1238ad[_0x50c35d(0xc1)]['id'],_0x50c35d(0x118))[_0x50c35d(0x8e)](_0x496874=>{telegramError(_0x496874);}):(tgBot['sendMessage'](_0x1238ad[_0x50c35d(0xc1)]['id'],_0x50c35d(0x1bf),{'reply_markup':{'inline_keyboard':[[{'text':_0x50c35d(0x1e9),'callback_data':_0x50c35d(0x203)},{'text':'No','callback_data':'no'}]]}})[_0x50c35d(0x8e)](_0x2f094b=>{telegramError(_0x2f094b);}),tgBot['on'](_0x50c35d(0x1c4),async _0xdf6447=>{const _0x3f9039=_0x50c35d,_0x323dec=_0xdf6447[_0x3f9039(0x201)],_0x22aa1d=_0xdf6447[_0x3f9039(0x14a)];tgBot['answerCallbackQuery'](_0xdf6447['id'])[_0x3f9039(0xa6)](async()=>{const _0x5bb574=_0x3f9039;_0x323dec==_0x5bb574(0x203)&&(await tgBot[_0x5bb574(0xa2)](_0x22aa1d[_0x5bb574(0xc1)]['id'],_0x5bb574(0x1ed))[_0x5bb574(0x8e)](_0x278f9a=>{telegramError(_0x278f9a);}),updateBB(_0x5bb574(0x13f))),_0x323dec=='no'&&await tgBot[_0x5bb574(0xa2)](_0x22aa1d[_0x5bb574(0xc1)]['id'],_0x5bb574(0xea))[_0x5bb574(0x8e)](_0x33f14e=>{telegramError(_0x33f14e);});}),tgBot[_0x3f9039(0xfa)]('callback_query');}));}),tgBot[_0x2de830(0x1ad)](/\/reinstall/,async _0x52c2b5=>{const _0x46c5e7=_0x2de830;if(!validateTelegram(_0x52c2b5))return;tgBot[_0x46c5e7(0xfa)](_0x46c5e7(0x1c4)),!validInstallation?tgBot[_0x46c5e7(0xa2)](_0x52c2b5[_0x46c5e7(0xc1)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x46c5e7(0x8e)](_0x5c0b95=>{telegramError(_0x5c0b95);}):(tgBot['sendMessage'](_0x52c2b5['chat']['id'],_0x46c5e7(0xeb),{'reply_markup':{'inline_keyboard':[[{'text':_0x46c5e7(0x1e9),'callback_data':_0x46c5e7(0x203)},{'text':'No','callback_data':'no'}]]}})[_0x46c5e7(0x8e)](_0x53807a=>{telegramError(_0x53807a);}),tgBot['on'](_0x46c5e7(0x1c4),async _0x339f4b=>{const _0x378af0=_0x46c5e7,_0x45766b=_0x339f4b[_0x378af0(0x201)],_0x56ebac=_0x339f4b[_0x378af0(0x14a)];tgBot[_0x378af0(0x1cc)](_0x339f4b['id'])[_0x378af0(0xa6)](async()=>{const _0x11aba6=_0x378af0;_0x45766b==_0x11aba6(0x203)&&(await tgBot[_0x11aba6(0xa2)](_0x56ebac[_0x11aba6(0xc1)]['id'],_0x11aba6(0x11e))[_0x11aba6(0x8e)](_0x506d59=>{telegramError(_0x506d59);}),updateBB('reinstall')),_0x45766b=='no'&&await tgBot[_0x11aba6(0xa2)](_0x56ebac[_0x11aba6(0xc1)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x11aba6(0x8e)](_0x584998=>{telegramError(_0x584998);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x2de830(0x1ad)](/\/toggle/,_0x1c19b1=>{const _0x2c1736=_0x2de830;if(!validateTelegram(_0x1c19b1))return;tgBot[_0x2c1736(0xfa)]('callback_query');const _0x204a2b=getBotsWithMode();if(_0x204a2b['length']==0x0)tgBot[_0x2c1736(0xa2)](_0x1c19b1[_0x2c1736(0xc1)]['id'],_0x2c1736(0x1cf))[_0x2c1736(0x8e)](_0x2c5ee0=>{telegramError(_0x2c5ee0);});else{let _0x3b2f33=[],_0x19a86a=[];const _0x1b97fc=0x2;let _0x1549a4=0x0;_0x204a2b['forEach']((_0x2d45ed,_0x20212f)=>{const _0x313d08=_0x2c1736;if(_0x20212f%_0x1b97fc==0x0)_0x19a86a=[];_0x19a86a[_0x313d08(0x1e7)]({'text':'Bot\x20'+_0x2d45ed[_0x313d08(0x10d)]+'\x20('+_0x2d45ed[_0x313d08(0x17b)]+')','callback_data':_0x2d45ed[_0x313d08(0x10d)]}),_0x20212f%_0x1b97fc==0x0&&(_0x3b2f33[_0x1549a4]=_0x19a86a,_0x1549a4++);}),tgBot[_0x2c1736(0xa2)](_0x1c19b1[_0x2c1736(0xc1)]['id'],_0x2c1736(0x113),{'reply_markup':{'inline_keyboard':_0x3b2f33}})[_0x2c1736(0x8e)](_0x2cd811=>{telegramError(_0x2cd811);}),tgBot['on']('callback_query',async _0xa2b54a=>{const _0x40b9d2=_0x2c1736,_0x865cad=_0xa2b54a[_0x40b9d2(0x201)],_0x3b50aa=_0xa2b54a[_0x40b9d2(0x14a)];tgBot[_0x40b9d2(0x1cc)](_0xa2b54a['id'])[_0x40b9d2(0xa6)](async()=>{const _0x25807f=_0x40b9d2,_0x12eaf8=_0x204a2b['find'](_0x497610=>_0x497610[_0x25807f(0x10d)]==_0x865cad),_0x5cb23a=_0x12eaf8[_0x25807f(0x17b)]==_0x25807f(0x1e4)?_0x25807f(0xae):_0x25807f(0x1e4);tgBot[_0x25807f(0xa2)](_0x3b50aa[_0x25807f(0xc1)]['id'],_0x25807f(0x149)+_0x865cad+'\x20to\x20'+_0x5cb23a+_0x25807f(0x248))[_0x25807f(0x8e)](_0x8793b6=>{telegramError(_0x8793b6);}),toggleBotMode(_0x865cad);}),tgBot[_0x40b9d2(0xfa)](_0x40b9d2(0x1c4));});}}),tgBot['onText'](/\/names/,_0xc5289e=>{const _0x194537=_0x2de830;if(!validateTelegram(_0xc5289e))return;let _0x7d61f6='';config['forEach'](_0x5da194=>{const _0x327307=_0x4f2b;_0x7d61f6+=_0x327307(0x1f0)+_0x5da194['botID']+':\x20'+_0x5da194[_0x327307(0x1c7)]+'\x0a';}),tgBot[_0x194537(0xa2)](_0xc5289e['chat']['id'],_0x7d61f6,{'parse_mode':_0x194537(0x193)})[_0x194537(0x8e)](_0x36a03c=>{telegramError(_0x36a03c);});}),tgBot[_0x2de830(0x1ad)](/\/disable/,_0x61b797=>{const _0x1fa691=_0x2de830;if(!validateTelegram(_0x61b797))return;tgBot['sendMessage'](_0x61b797[_0x1fa691(0xc1)]['id'],'Notifications\x20disabled')[_0x1fa691(0x8e)](_0x562ff6=>{telegramError(_0x562ff6);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x125143=>{const _0x3cdde7=_0x2de830;if(!validateTelegram(_0x125143))return;tgBot[_0x3cdde7(0xa2)](_0x125143[_0x3cdde7(0xc1)]['id'],_0x400384)['catch'](_0x1303f2=>{telegramError(_0x1303f2);});}),tgBot['on'](_0x2de830(0x130),_0x11f4cb=>{const _0x471bbe=_0x2de830;_0x11f4cb[_0x471bbe(0x233)]()[_0x471bbe(0x225)](_0x471bbe(0x192))&&(logger[_0x471bbe(0x1ec)](_0x471bbe(0x12c)),tgBot[_0x471bbe(0x99)](),tgBot=null,io['to'](_0x471bbe(0x23f))['emit'](_0x471bbe(0x103),'Invalid\x20Telegram\x20token'));}),process[_0x2de830(0xa9)](_0x2de830(0x11b),()=>{const _0x444e17=_0x2de830;if(tgBot)tgBot[_0x444e17(0x99)]();process[_0x444e17(0xad)](0x1);}),process[_0x2de830(0xa9)](_0x2de830(0x240),()=>{const _0xae0346=_0x2de830;if(tgBot)tgBot[_0xae0346(0x99)]();process[_0xae0346(0xad)](0x1);});}}function disableTelegram(){const _0x223bfa=_0x2d323a;tgBot&&(tgBot[_0x223bfa(0x99)](),tgBot=null);}function sendTelegram(_0x6c9ad3,_0x1f95bc){const _0x56316c=_0x2d323a;if(settings[_0x56316c(0xab)]){if(settings[_0x56316c(0x125)]=='all'||(_0x1f95bc[_0x56316c(0x198)]==_0x56316c(0x20b)||_0x1f95bc[_0x56316c(0x198)]==_0x56316c(0x251)||_0x1f95bc[_0x56316c(0x198)]==_0x56316c(0x1f2))&&settings[_0x56316c(0x125)]==_0x56316c(0x132)||_0x1f95bc[_0x56316c(0x198)]==_0x56316c(0x1ba)&&settings['telegramEvents']==_0x56316c(0x120)){if(tgBot&&settings[_0x56316c(0x17c)]){if(_0x1f95bc[_0x56316c(0x190)])tgBot[_0x56316c(0xa2)](settings[_0x56316c(0x17c)],_0x1f95bc[_0x56316c(0x1c7)]+_0x56316c(0x107)+_0x1f95bc[_0x56316c(0xc5)])[_0x56316c(0x8e)](_0x40f578=>{telegramError(_0x40f578);});else tgBot['sendMessage'](settings['telegramChatId'],'Bot\x20'+_0x6c9ad3+'\x20>\x20'+_0x1f95bc['event'])[_0x56316c(0x8e)](_0x5d87e6=>{telegramError(_0x5d87e6);});}}}}async function sendTelegramMsg(_0x40ee85,_0x4953f7=_0x2d323a(0x193)){const _0x37ebc6=_0x2d323a;return settings[_0x37ebc6(0xab)]&&tgBot&&settings[_0x37ebc6(0x17c)]?(await tgBot[_0x37ebc6(0xa2)](settings[_0x37ebc6(0x17c)],_0x40ee85,{'parse_mode':_0x4953f7})[_0x37ebc6(0x8e)](_0x20e02a=>{telegramError(_0x20e02a);}),!![]):![];}function getDeviceWithIp(_0x52171f){return devices['find'](_0x358f81=>_0x358f81['ip']===_0x52171f);}function temporaryAccess2FA(_0x1e3db1,_0x277b9d){const _0x2e3e27=_0x2d323a;let _0x32bb25=new Date(),_0x952ee7=![];if(lastIpApproval){if(_0x32bb25-lastIpApproval<0x1388)_0x952ee7=!![];}lastIpApproval=new Date();if(_0x952ee7)return;tgBot&&settings[_0x2e3e27(0x17c)]&&(tgBot['removeListener'](_0x2e3e27(0x1c4)),tgBot[_0x2e3e27(0xa2)](settings[_0x2e3e27(0x17c)],_0x2e3e27(0x1d9)+normalizeIP(_0x277b9d)[_0x2e3e27(0x20f)]+_0x2e3e27(0x12f),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2e3e27(0x175),'callback_data':'5'},{'text':_0x2e3e27(0x200),'callback_data':'15'},{'text':_0x2e3e27(0x1a7),'callback_data':'30'},{'text':_0x2e3e27(0x150),'callback_data':_0x2e3e27(0x150)}]]}})[_0x2e3e27(0x8e)](_0x492e8a=>{telegramError(_0x492e8a);}),tgBot['on'](_0x2e3e27(0x1c4),async _0x10c807=>{const _0x760b48=_0x2e3e27,_0x4ccc2b=_0x10c807[_0x760b48(0x201)],_0x3dd3cf=_0x10c807[_0x760b48(0x14a)];tgBot[_0x760b48(0x1cc)](_0x10c807['id'])[_0x760b48(0xa6)](async()=>{const _0x1ebd14=_0x760b48;devices[_0x1e3db1][_0x1ebd14(0x139)]={'clientip':_0x277b9d,'timestamp':new Date()['getTime'](),'expiry':_0x4ccc2b},_0x4ccc2b!=_0x1ebd14(0x150)?(await tgBot[_0x1ebd14(0xa2)](_0x3dd3cf['chat']['id'],_0x1ebd14(0x143)+_0x4ccc2b+_0x1ebd14(0x25d),{'parse_mode':'HTML'})[_0x1ebd14(0x8e)](_0x232228=>{telegramError(_0x232228);}),io['to'](_0x1e3db1)[_0x1ebd14(0xac)](_0x1ebd14(0x13e),{'access':{'allow':![],'reason':_0x1ebd14(0x243),'token':null}})):(await tgBot['sendMessage'](_0x3dd3cf['chat']['id'],_0x1ebd14(0x194))[_0x1ebd14(0x8e)](_0x18e248=>{telegramError(_0x18e248);}),io['to'](_0x1e3db1)[_0x1ebd14(0xac)](_0x1ebd14(0x13e),{'access':{'allow':![],'reason':_0x1ebd14(0x108),'token':null}}));}),tgBot['removeListener'](_0x760b48(0x1c4));}));}function loginAccess2FA(_0x146582,_0x492db5){const _0x4525ec=_0x2d323a;tgBot&&settings[_0x4525ec(0x17c)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings[_0x4525ec(0x17c)],_0x4525ec(0x1c1)+normalizeIP(_0x492db5)[_0x4525ec(0x20f)]+_0x4525ec(0x12f),{'parse_mode':_0x4525ec(0x193),'reply_markup':{'inline_keyboard':[[{'text':_0x4525ec(0x23e),'callback_data':loginExpiry},{'text':'reject','callback_data':'reject'}]]}})[_0x4525ec(0x8e)](_0x1bfa38=>{telegramError(_0x1bfa38);}),tgBot['on'](_0x4525ec(0x1c4),async _0x487217=>{const _0x935d4f=_0x4525ec,_0x1dabee=_0x487217[_0x935d4f(0x201)],_0x5c0589=_0x487217['message'];tgBot['answerCallbackQuery'](_0x487217['id'])['then'](async()=>{const _0xb174b9=_0x935d4f;devices[_0x146582][_0xb174b9(0x1d4)]={'clientip':_0x492db5,'timestamp':new Date()[_0xb174b9(0x16c)](),'expiry':_0x1dabee},_0x1dabee!=_0xb174b9(0x150)?(await tgBot['sendMessage'](_0x5c0589[_0xb174b9(0xc1)]['id'],_0xb174b9(0x250),{'parse_mode':'HTML'})['catch'](_0x290f34=>{telegramError(_0x290f34);}),io['to'](_0x146582)[_0xb174b9(0xac)]('status',{'access':{'allow':![],'reason':_0xb174b9(0x243),'token':null}})):(await tgBot['sendMessage'](_0x5c0589['chat']['id'],_0xb174b9(0xc6))[_0xb174b9(0x8e)](_0x4d22a4=>{telegramError(_0x4d22a4);}),io['to'](_0x146582)[_0xb174b9(0xac)](_0xb174b9(0x13e),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x935d4f(0xfa)](_0x935d4f(0x1c4));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1db8dd=_0x2d323a;return dbConfig['get'](_0x1db8dd(0xff))[_0x1db8dd(0x93)]('botID')[_0x1db8dd(0x1b5)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x134896=_0x2d323a;return dbConfig[_0x134896(0x202)]('bots')[_0x134896(0x93)](_0x134896(0x10d))[_0x134896(0x1b5)]({'status':_0x134896(0x14b)})[_0x134896(0x155)]()||[];}function getBotAttributes(_0x1fb076){const _0x4c9c0b=_0x2d323a;let _0xad6bd2={};const _0x803bd3=configpath+_0x4c9c0b(0xe1)+_0x1fb076+_0x4c9c0b(0x147),_0x1b45b6=fs[_0x4c9c0b(0xfe)](_0x803bd3);if(_0x1b45b6){const _0x30cab5=fs[_0x4c9c0b(0xb2)](_0x803bd3);try{const _0x5abee8=JSON[_0x4c9c0b(0x119)](_0x30cab5),_0x37bb30=_0x5abee8?_0x5abee8[_0x4c9c0b(0x244)][0x0][_0x4c9c0b(0x186)]:![];_0xad6bd2[_0x4c9c0b(0x17b)]=_0x37bb30?_0x4c9c0b(0x1e4):'manual',_0xad6bd2[_0x4c9c0b(0x1c7)]=_0x5abee8?_0x5abee8[_0x4c9c0b(0x244)][0x0][_0x4c9c0b(0x1c7)]:'Bot\x20'+_0x1fb076;}catch(_0x43ba61){_0xad6bd2[_0x4c9c0b(0x17b)]=_0x4c9c0b(0xae),_0xad6bd2[_0x4c9c0b(0x1c7)]=_0x4c9c0b(0x1f0)+_0x1fb076;}}else _0xad6bd2['mode']='manual',_0xad6bd2[_0x4c9c0b(0x1c7)]='Bot\x20'+_0x1fb076;return _0xad6bd2;}function _0x4f2b(_0x28722e,_0x1a921c){const _0x7d3f9b=_0xb225();return _0x4f2b=function(_0x16b7ce,_0x4a9ba7){_0x16b7ce=_0x16b7ce-0x88;let _0xb2257b=_0x7d3f9b[_0x16b7ce];return _0xb2257b;},_0x4f2b(_0x28722e,_0x1a921c);}function getBotsWithMode(){const _0xb27c1d=_0x2d323a,_0x4f2645=dbConfig[_0xb27c1d(0x202)]('bots')[_0xb27c1d(0x93)]('botID')['value']()||[];return _0x4f2645[_0xb27c1d(0xcb)](_0x38a61b=>{const _0x356ab8=_0xb27c1d;let _0x19f540=getBotAttributes(_0x38a61b[_0x356ab8(0x10d)]);_0x38a61b[_0x356ab8(0x17b)]=_0x19f540['mode'];}),_0x4f2645;}function getBotExchanges(){const _0x38be5a=_0x2d323a;let _0x3c13f2=[];const _0x305751=dbConfig['get'](_0x38be5a(0xff))[_0x38be5a(0x93)](_0x38be5a(0x10d))['value']()||[];_0x305751[_0x38be5a(0xcb)](_0x28d1e0=>{const _0x1f5792=_0x38be5a;if(_0x28d1e0[_0x1f5792(0x13e)]==_0x1f5792(0x1d6)){const _0xae95a5=configpath+_0x1f5792(0xe1)+_0x28d1e0['botID']+'-config.json',_0x21dcd1=fs[_0x1f5792(0xfe)](_0xae95a5);let _0x58d165;if(_0x21dcd1){const _0x4d85ce=fs[_0x1f5792(0xb2)](_0xae95a5);try{const _0x568ab1=JSON[_0x1f5792(0x119)](_0x4d85ce);_0x58d165=_0x568ab1?_0x568ab1['bot'][0x0][_0x1f5792(0x1be)]:null;}catch(_0x4d9c09){}}if(_0x58d165)_0x3c13f2['push'](_0x58d165);}});const _0x12f250=[...new Set(_0x3c13f2)][_0x38be5a(0x94)]();return _0x12f250;}async function initUser(){const _0x533479=_0x2d323a;if(!settings['userid']){const _0x36e723=uuidRandom();mixpanel['alias'](_0x36e723),updateSetting(_0x533479(0x210),_0x36e723);}}async function initSecure(){const _0x3b00c5=_0x2d323a;let _0x22bedd=getSecure();if(!_0x22bedd['hasOwnProperty']('secret')){let _0x3e9e77=await generateKeys();_0x22bedd[_0x3b00c5(0x1a1)]=_0x3e9e77['publicKey'],_0x22bedd[_0x3b00c5(0x22c)]=_0x3e9e77[_0x3b00c5(0x22c)],_0x22bedd['secret']=crypto['randomBytes'](0x20)[_0x3b00c5(0x233)](_0x3b00c5(0x1eb));;storeSecure(_0x22bedd);}}function getSettings(){const _0x116830=_0x2d323a;return dbSettings['get'](_0x116830(0x12d))[_0x116830(0x155)]()||{};}function getSecure(){const _0x218e7b=_0x2d323a;return dbSecure[_0x218e7b(0x202)]('secure')[_0x218e7b(0x155)]()||{};}function getBlacklist(){const _0x39fc08=_0x2d323a;return dbSecure[_0x39fc08(0x202)](_0x39fc08(0x187))[_0x39fc08(0x155)]()||[];}function broadcastToBots(_0x2be104,_0x3a789d){const _0xf56a32=_0x2d323a;config[_0xf56a32(0xcb)](_0xcc6046=>{const _0x41e1ae=_0xf56a32;if(_0xcc6046[_0x41e1ae(0x13e)]==_0x41e1ae(0x1d6)&&_0xcc6046[_0x41e1ae(0x1b2)]==_0x41e1ae(0x164)||_0xcc6046[_0x41e1ae(0x13e)]=='new'&&_0xcc6046['live']==_0x41e1ae(0x164)){if(pid[_0xcc6046[_0x41e1ae(0x10d)]])pid[_0xcc6046[_0x41e1ae(0x10d)]][_0x41e1ae(0x25c)]({[_0x2be104]:_0x3a789d});}});}function storeSettings(_0x8a1104,_0x12a025=![]){const _0x2ec4e0=_0x2d323a;_0x8a1104={...settings,..._0x8a1104};if(_0x12a025&&_0x8a1104['bbPassword']!='************'&&_0x8a1104[_0x2ec4e0(0x15b)]!=_0x2ec4e0(0x159)&&_0x8a1104[_0x2ec4e0(0x15b)]!=''){const _0x31bdd4=crypt['decrypt'](secure[_0x2ec4e0(0x22c)],_0x8a1104[_0x2ec4e0(0x15b)])[_0x2ec4e0(0x14a)][_0x2ec4e0(0xa4)]('@')[0x0],_0x31ac56=bcrypt[_0x2ec4e0(0x183)](_0x31bdd4,saltRounds);_0x8a1104={..._0x8a1104,'bbPassword':_0x31ac56};}if(_0x12a025&&_0x8a1104[_0x2ec4e0(0x235)]!=_0x2ec4e0(0x146)&&_0x8a1104['telegramToken']!=_0x2ec4e0(0x159)&&_0x8a1104[_0x2ec4e0(0x235)]!=''){const _0x29f574=crypt[_0x2ec4e0(0x231)](secure[_0x2ec4e0(0x22c)],_0x8a1104[_0x2ec4e0(0x235)])['message'][_0x2ec4e0(0xa4)]('@')[0x0];_0x8a1104={..._0x8a1104,'telegramToken':_0x29f574};}const _0x395efd=_0x8a1104['telegramToken']!=_0x2ec4e0(0x146)&&_0x8a1104[_0x2ec4e0(0x235)]!=settings[_0x2ec4e0(0x235)]||_0x8a1104[_0x2ec4e0(0x156)]!=settings[_0x2ec4e0(0x156)],_0x2a42e6=_0x8a1104[_0x2ec4e0(0x235)]==''||_0x8a1104[_0x2ec4e0(0x156)]=='';if(_0x395efd)_0x8a1104[_0x2ec4e0(0x125)]=_0x2ec4e0(0xed);for(const [_0x1c7cac,_0x3795bd]of Object[_0x2ec4e0(0x105)](_0x8a1104)){if(_0x1c7cac=='telegramToken'&&_0x3795bd=='************'){_0x8a1104['telegramToken']=settings[_0x2ec4e0(0x235)];continue;};if(_0x1c7cac==_0x2ec4e0(0x15b)&&_0x3795bd==_0x2ec4e0(0x146)){_0x8a1104[_0x2ec4e0(0x15b)]=settings[_0x2ec4e0(0x15b)];continue;};dbSettings[_0x2ec4e0(0x1a5)]('settings.'+_0x1c7cac,_0x3795bd)[_0x2ec4e0(0x1ce)]();}settings=_0x8a1104,io['to']('botmanager')[_0x2ec4e0(0xac)]('settings',cleanSettings()),broadcastToBots(_0x2ec4e0(0x211),settings[_0x2ec4e0(0x211)]),broadcastToBots(_0x2ec4e0(0x1b1),settings[_0x2ec4e0(0x1b1)]);if(_0x395efd&&!_0x2a42e6)initTelegram();if(_0x395efd&&_0x2a42e6)disableTelegram();getAllClients()['forEach'](_0x410b5a=>{const _0x3f1443=_0x2ec4e0;getSocket(_0x410b5a['id'])['emit'](_0x3f1443(0x13e),{'access':{'allow':![],'reason':_0x3f1443(0x243),'token':null}});});}function updateSetting(_0x46a383,_0x3c1ffb){const _0x469fd6=_0x2d323a;dbSettings[_0x469fd6(0x1a5)](_0x469fd6(0x1aa)+_0x46a383,_0x3c1ffb)[_0x469fd6(0x1ce)](),settings=getSettings(),io['to']('botmanager')[_0x469fd6(0xac)]('settings',cleanSettings());}function storeSecure(_0x597f41){const _0x3b5534=_0x2d323a;dbSecure[_0x3b5534(0x202)](_0x3b5534(0x157))[_0x3b5534(0x1e7)](_0x597f41)[_0x3b5534(0x1ce)](),secure=_0x597f41;}function addBlacklist(_0x535b81){const _0x4694d2=_0x2d323a;cleanBlacklist();let _0x261736;devices[_0x535b81]['telegramIpApproval']?_0x261736=Math[_0x4694d2(0x128)](devices[_0x535b81][_0x4694d2(0x139)]['expiry'],loginExpiry):_0x261736=loginExpiry,dbSecure[_0x4694d2(0x202)]('blacklist')[_0x4694d2(0x1e7)]({'expiry':new Date()[_0x4694d2(0x16c)]()+_0x261736*0x3c*0x3e8,'token':devices[_0x535b81]['access'][_0x4694d2(0x22e)]})[_0x4694d2(0x1ce)](),blacklist=dbSecure[_0x4694d2(0x202)](_0x4694d2(0x187))['value']();}function cleanBlacklist(){const _0x289094=_0x2d323a;let _0x55ba4d=dbSecure['get'](_0x289094(0x187))[_0x289094(0x24b)]()[_0x289094(0x155)](),_0xc6cc76=new Date()['getTime']();_0x55ba4d[_0x289094(0xcb)](_0x148795=>{const _0x2b4dfb=_0x289094;_0x148795[_0x2b4dfb(0x1a6)]<_0xc6cc76&&dbSecure[_0x2b4dfb(0x202)]('blacklist')[_0x2b4dfb(0x1ca)]({'expiry':_0x148795[_0x2b4dfb(0x1a6)]})[_0x2b4dfb(0x1ce)]();});}function initStates(){const _0x2bfaa3=_0x2d323a;let _0x1cdfaf=getConfiguration();_0x1cdfaf[_0x2bfaa3(0xcb)](_0x475a28=>{const _0x2a4bbd=_0x2bfaa3;_0x475a28[_0x2a4bbd(0x1b2)]=_0x2a4bbd(0x9e);}),storeConfiguration(_0x1cdfaf);}function onKeys(){const _0x1aa61a=new RSA();return new Promise(_0x1d5868=>{const _0x1a0dce=_0x4f2b;_0x1aa61a[_0x1a0dce(0xdf)]()['then'](_0x4de8b1=>{_0x1d5868(_0x4de8b1);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5b6aef=_0x2d323a;let _0x5173d7=getSettings(),_0x795606=![];!_0x5173d7['hasOwnProperty'](_0x5b6aef(0xa0))&&(_0x5173d7[_0x5b6aef(0xa0)]=0x0,_0x795606=!![]);!_0x5173d7['hasOwnProperty']('lastmsgemitted')&&(_0x5173d7['lastmsgemitted']=0x0,_0x795606=!![]);!_0x5173d7[_0x5b6aef(0x234)](_0x5b6aef(0x253))&&(_0x5173d7[_0x5b6aef(0x253)]=_0x5b6aef(0x1b3),_0x795606=!![]);!_0x5173d7[_0x5b6aef(0x234)]('onepagemode')&&(_0x5173d7[_0x5b6aef(0x1b1)]=![],_0x795606=!![]);if(_0x795606)storeSettings(_0x5173d7);}function storeConfiguration(_0x4684f2){const _0x2fdfc9=_0x2d323a;dbConfig['get']('bots')[_0x2fdfc9(0x1ca)]()[_0x2fdfc9(0x1ce)](),_0x4684f2[_0x2fdfc9(0xcb)](_0x423b53=>{const _0x5bf9d8=_0x2fdfc9;delete _0x423b53[_0x5bf9d8(0x17b)];}),dbConfig[_0x2fdfc9(0x202)](_0x2fdfc9(0xff))[_0x2fdfc9(0x1e7)](..._0x4684f2)[_0x2fdfc9(0x1ce)](),config=_0x4684f2;}function resetPassword(){const _0x1490b7=_0x2d323a;tgBot&&settings['telegramChatId']&&(tgBot[_0x1490b7(0xfa)](_0x1490b7(0x1c4)),tgBot[_0x1490b7(0xa2)](settings['telegramChatId'],_0x1490b7(0xdb),{'parse_mode':_0x1490b7(0x193),'reply_markup':{'inline_keyboard':[[{'text':_0x1490b7(0x203),'callback_data':_0x1490b7(0x203)},{'text':'no','callback_data':'no'}]]}})[_0x1490b7(0x8e)](_0x42fb77=>{telegramError(_0x42fb77);}),tgBot['on'](_0x1490b7(0x1c4),async _0x1cd0e3=>{const _0x5a3ba8=_0x1490b7,_0xa97ae3=_0x1cd0e3[_0x5a3ba8(0x201)],_0x447800=_0x1cd0e3['message'];tgBot['answerCallbackQuery'](_0x1cd0e3['id'])[_0x5a3ba8(0xa6)](async()=>{const _0x2437c5=_0x5a3ba8;if(_0xa97ae3!='no'){const _0x2429d8=0xf,_0x775161='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x115809=Array[_0x2437c5(0x180)](crypto[_0x2437c5(0x1b9)](new Uint32Array(_0x2429d8)))[_0x2437c5(0x1c3)](_0xc5a0ca=>_0x775161[_0xc5a0ca%_0x775161[_0x2437c5(0x1e5)]])[_0x2437c5(0x15d)](''),_0x5f4589=bcrypt[_0x2437c5(0x183)](_0x115809,saltRounds);storeSettings({'bbPassword':_0x5f4589}),await tgBot[_0x2437c5(0xa2)](_0x447800[_0x2437c5(0xc1)]['id'],_0x2437c5(0xe4)+_0x115809,{'parse_mode':_0x2437c5(0x193)})[_0x2437c5(0x8e)](_0x347b7a=>{telegramError(_0x347b7a);});}else await tgBot[_0x2437c5(0xa2)](_0x447800[_0x2437c5(0xc1)]['id'],_0x2437c5(0xd8))[_0x2437c5(0x8e)](_0x206ebb=>{telegramError(_0x206ebb);});}),tgBot['removeListener']('callback_query');}));}async function confirmRestore(_0x5cfc9e,_0x47e287){const _0xc78a1a=_0x2d323a;io['to'](_0xc78a1a(0x23f))[_0xc78a1a(0xac)](_0xc78a1a(0x103),_0xc78a1a(0x124),'success'),tgBot&&settings[_0xc78a1a(0x17c)]&&(tgBot['removeListener']('callback_query'),await tgBot[_0xc78a1a(0xa2)](settings[_0xc78a1a(0x17c)],_0xc78a1a(0x1ef),{'parse_mode':_0xc78a1a(0x193),'reply_markup':{'inline_keyboard':[[{'text':_0xc78a1a(0x203),'callback_data':_0xc78a1a(0x203)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x132bd2=>{telegramError(_0x132bd2);}),tgBot['on'](_0xc78a1a(0x1c4),async _0xae3ac9=>{const _0x1913a1=_0xc78a1a,_0x56683c=_0xae3ac9[_0x1913a1(0x201)],_0x273436=_0xae3ac9[_0x1913a1(0x14a)];tgBot[_0x1913a1(0x1cc)](_0xae3ac9['id'])[_0x1913a1(0xa6)](async()=>{const _0x2aad02=_0x1913a1;_0x56683c==_0x2aad02(0x203)?(await tgBot['sendMessage'](_0x273436[_0x2aad02(0xc1)]['id'],_0x2aad02(0x17d),{'parse_mode':'HTML'})[_0x2aad02(0x8e)](_0x106a74=>{telegramError(_0x106a74);}),unzipFile(_0x5cfc9e,_0x47e287)):(logger[_0x2aad02(0x100)](_0x2aad02(0xd0)),await tgBot[_0x2aad02(0xa2)](_0x273436[_0x2aad02(0xc1)]['id'],_0x2aad02(0xd0))[_0x2aad02(0x8e)](_0x1e6151=>{telegramError(_0x1e6151);}));}),tgBot[_0x1913a1(0xfa)](_0x1913a1(0x1c4));}));}function getServerTime(){const _0x4bb80a=_0x2d323a,_0x3fb848=new Date();return _0x3fb848[_0x4bb80a(0xd2)]()+'/'+(_0x3fb848[_0x4bb80a(0x256)]()+0x1)[_0x4bb80a(0x233)]()[_0x4bb80a(0xf7)](0x2,'0')+'/'+_0x3fb848['getDate']()[_0x4bb80a(0x233)]()['padStart'](0x2,'0')+'\x20'+_0x3fb848[_0x4bb80a(0xee)]()[_0x4bb80a(0x233)]()['padStart'](0x2,'0')+':'+_0x3fb848[_0x4bb80a(0x1d5)]()['toString']()[_0x4bb80a(0xf7)](0x2,'0')+':'+_0x3fb848['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x385a88=_0x2d323a,_0x415277=shiftedTime();return _0x415277[_0x385a88(0xd2)]()+'/'+(_0x415277[_0x385a88(0x256)]()+0x1)[_0x385a88(0x233)]()[_0x385a88(0xf7)](0x2,'0')+'/'+_0x415277[_0x385a88(0xcd)]()[_0x385a88(0x233)]()[_0x385a88(0xf7)](0x2,'0')+'\x20'+_0x415277[_0x385a88(0xee)]()[_0x385a88(0x233)]()[_0x385a88(0xf7)](0x2,'0')+':'+_0x415277[_0x385a88(0x1d5)]()[_0x385a88(0x233)]()[_0x385a88(0xf7)](0x2,'0')+':'+_0x415277[_0x385a88(0x96)]()['toString']()[_0x385a88(0xf7)](0x2,'0');}function getCleanTimeStamp(){const _0x2f9c3e=_0x2d323a,_0xf2cc49=shiftedTime();return _0xf2cc49[_0x2f9c3e(0xd2)]()+(_0xf2cc49[_0x2f9c3e(0x256)]()+0x1)['toString']()[_0x2f9c3e(0xf7)](0x2,'0')+_0xf2cc49[_0x2f9c3e(0xcd)]()[_0x2f9c3e(0x233)]()[_0x2f9c3e(0xf7)](0x2,'0')+'-'+_0xf2cc49[_0x2f9c3e(0xee)]()[_0x2f9c3e(0x233)]()[_0x2f9c3e(0xf7)](0x2,'0')+_0xf2cc49[_0x2f9c3e(0x1d5)]()[_0x2f9c3e(0x233)]()[_0x2f9c3e(0xf7)](0x2,'0')+_0xf2cc49[_0x2f9c3e(0x96)]()[_0x2f9c3e(0x233)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x4a3844=_0x2d323a,_0x4da769=new Date();let _0x51b200=_0x4da769;if(settings[_0x4a3844(0x211)]&&settings[_0x4a3844(0x211)]!==0x0)_0x51b200=fns[_0x4a3844(0x129)](_0x4da769,{'hours':settings[_0x4a3844(0x211)]});return _0x51b200;}function startScheduler(){const _0x43987a=_0x2d323a,_0x445254=new Date()[_0x43987a(0x9f)](),_0xb47be2=shiftedTime()[_0x43987a(0xee)]();_0xb47be2==0x4&&backupConfigFiles();_0xb47be2==0x0&&rotateLogFiles();_0x445254%0x6==0x0&&triggerAnalytics();_0x445254%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3e7e4a){const _0x33dd25=_0x2d323a;logger['debug'](_0x33dd25(0x1b4)+_0x3e7e4a);const _0x5d3ca2=getBotsWithMode();_0x5d3ca2[_0x33dd25(0x1e5)]>0x0?confirmRestore(configbackuppath,_0x3e7e4a):unzipFile(configbackuppath,_0x3e7e4a);}async function getBackupFiles(_0x44ff1a=null){const _0x5c0ade=_0x2d323a;let _0x272152=[],_0x375270=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x375270['sort']((_0x55ffef,_0x154338)=>_0x55ffef[_0x5c0ade(0x1cb)]<_0x154338['name']?0x1:_0x154338['name']<_0x55ffef[_0x5c0ade(0x1cb)]?-0x1:0x0),_0x375270['forEach'](_0x3b94a3=>{const _0x3ded3d=_0x5c0ade;if(!_0x3b94a3[_0x3ded3d(0x89)]()&&_0x3b94a3[_0x3ded3d(0x1cb)]['startsWith'](_0x3ded3d(0x247))&&_0x3b94a3[_0x3ded3d(0x1cb)][_0x3ded3d(0xb9)](_0x3ded3d(0x191))){const _0x5463ca=formatDate(fs[_0x3ded3d(0x205)](configbackuppath+_0x3b94a3[_0x3ded3d(0x1cb)])[_0x3ded3d(0x92)]);_0x272152[_0x3ded3d(0x1e7)]({'name':_0x3b94a3[_0x3ded3d(0x1cb)],'mtime':_0x5463ca});}});if(_0x44ff1a)io['to'](_0x44ff1a)[_0x5c0ade(0xac)]('backup-files',_0x272152);else return _0x272152;}async function backupConfigFiles(){const _0x3f6f48=_0x2d323a;await zipFiles('backup-full');const _0x1c132c=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x1c132c+_0x3f6f48(0x191)));let _0x223ad4=fs[_0x3f6f48(0x1e2)](configbackuppath,{'withFileTypes':!![]});_0x223ad4[_0x3f6f48(0x94)]((_0x2d4970,_0x4ad7e6)=>_0x2d4970[_0x3f6f48(0x1cb)]<_0x4ad7e6[_0x3f6f48(0x1cb)]?0x1:_0x4ad7e6['name']<_0x2d4970[_0x3f6f48(0x1cb)]?-0x1:0x0),_0x223ad4[_0x3f6f48(0x1e5)]>maxBackups&&fs[_0x3f6f48(0x176)](configbackuppath+_0x223ad4[maxBackups][_0x3f6f48(0x1cb)]);}function rotateLogFiles(){const _0x4459a6=_0x2d323a,_0x4ac3ee=fs[_0x4459a6(0x205)](logspath+_0x4459a6(0xe5)),_0x334f48=_0x4ac3ee['size']/0x400;if(_0x334f48>0x64){let _0x2badf3=fs[_0x4459a6(0x1e2)](logspath,{'withFileTypes':!![]});_0x2badf3[_0x4459a6(0x94)]((_0x4a37ff,_0x5a2c1c)=>_0x4a37ff[_0x4459a6(0x1cb)]<_0x5a2c1c[_0x4459a6(0x1cb)]?0x1:_0x5a2c1c['name']<_0x4a37ff[_0x4459a6(0x1cb)]?-0x1:0x0),_0x2badf3[_0x4459a6(0xcb)](_0x907ecf=>{const _0x3d2985=_0x4459a6;if(_0x907ecf[_0x3d2985(0x1cb)]==_0x3d2985(0xba))fs[_0x3d2985(0x170)](logspath+_0x907ecf[_0x3d2985(0x1cb)],logspath+_0x3d2985(0xd9));if(_0x907ecf[_0x3d2985(0x1cb)]=='output-001.log')fs['copyFileSync'](logspath+_0x907ecf[_0x3d2985(0x1cb)],logspath+_0x3d2985(0xba));_0x907ecf[_0x3d2985(0x1cb)]==_0x3d2985(0xe5)&&(fs[_0x3d2985(0x170)](logspath+_0x907ecf[_0x3d2985(0x1cb)],logspath+_0x3d2985(0x238)),fs[_0x3d2985(0xa3)](logspath+_0x907ecf[_0x3d2985(0x1cb)],''));});}}async function zipFiles(_0x5d6364){const _0x11817a=_0x2d323a;let _0xe19cea;if(_0x5d6364==_0x11817a(0x162))_0xe19cea=logspath;if(_0x5d6364==_0x11817a(0x13b))_0xe19cea=configpath;if(_0x5d6364==_0x11817a(0x110))_0xe19cea=configpath;let _0x555d03=fs[_0x11817a(0x1e2)](_0xe19cea,{'withFileTypes':!![]});const _0xc992e5=new require(_0x11817a(0x252))();_0x555d03[_0x11817a(0xcb)](_0x4c60be=>{const _0x4ce52e=_0x11817a;if(!_0x4c60be[_0x4ce52e(0x89)]()){let _0x246cd0=fs['readFileSync'](_0xe19cea+_0x4c60be[_0x4ce52e(0x1cb)]);if(_0x5d6364==_0x4ce52e(0x13b)){const _0xf933f8=/^bot-[0-9]{3}-config.json$/,_0x3d9f71=_0xf933f8['test'](_0x4c60be[_0x4ce52e(0x1cb)]);if(_0x3d9f71){const _0x2d396d=JSON[_0x4ce52e(0x119)](_0x246cd0);_0x2d396d[_0x4ce52e(0x244)][0x0]&&(_0x2d396d[_0x4ce52e(0x244)][0x0]['apiKey']='***',_0x2d396d[_0x4ce52e(0x244)][0x0][_0x4ce52e(0x182)]=_0x4ce52e(0x159)),_0x246cd0=JSON[_0x4ce52e(0x22d)](_0x2d396d,null,0x2);}if(_0x4c60be[_0x4ce52e(0x1cb)]==_0x4ce52e(0x14f)){const _0x3226bf=JSON[_0x4ce52e(0x119)](_0x246cd0);if(_0x3226bf[_0x4ce52e(0x12d)][_0x4ce52e(0xfd)])_0x3226bf[_0x4ce52e(0x12d)][_0x4ce52e(0xfd)]=![];if(_0x3226bf[_0x4ce52e(0x12d)][_0x4ce52e(0x15b)])_0x3226bf['settings'][_0x4ce52e(0x15b)]=_0x4ce52e(0x159);if(_0x3226bf[_0x4ce52e(0x12d)][_0x4ce52e(0x235)])_0x3226bf[_0x4ce52e(0x12d)][_0x4ce52e(0x235)]=_0x4ce52e(0x159);if(_0x3226bf[_0x4ce52e(0x12d)][_0x4ce52e(0x17c)])_0x3226bf[_0x4ce52e(0x12d)]['telegramChatId']=null;_0x246cd0=JSON[_0x4ce52e(0x22d)](_0x3226bf,null,0x2);}if(_0x4c60be[_0x4ce52e(0x1cb)]!=_0x4ce52e(0x1af))_0xc992e5[_0x4ce52e(0xa1)](_0x4c60be[_0x4ce52e(0x1cb)],_0x246cd0);}else _0xc992e5['file'](_0x4c60be[_0x4ce52e(0x1cb)],_0x246cd0);}});const _0x235537=_0xc992e5[_0x11817a(0x24c)]({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x5d6364+_0x11817a(0x191)),_0x235537,_0x11817a(0x165));}async function unzipFile(_0x6b0f1f,_0x14a024){const _0x3104af=_0x2d323a;fs[_0x3104af(0x1e2)](configpath,{'withFileTypes':!![]})['forEach'](_0x7c8d4f=>{const _0x1b1b45=_0x3104af;if(!_0x7c8d4f['isDirectory']())fs[_0x1b1b45(0x236)](configpath+_0x7c8d4f[_0x1b1b45(0x1cb)]);});const _0xb11932=fs['readFileSync'](_0x6b0f1f+_0x14a024,_0x3104af(0x165)),_0x3578bc=new require(_0x3104af(0x252))(_0xb11932,{'base64':![],'checkCRC32':!![]});Object[_0x3104af(0x218)](_0x3578bc[_0x3104af(0x1b0)])[_0x3104af(0xcb)](_0x18b07b=>{const _0x2992b3=_0x3104af,_0x307153=_0x3578bc[_0x2992b3(0x1b0)][_0x18b07b];fs[_0x2992b3(0xa3)](configpath+_0x307153['name'],_0x307153[_0x2992b3(0x245)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x3104af(0xcb)](_0x2a9725=>{const _0x3f3a3e=_0x3104af;if(!_0x2a9725[_0x3f3a3e(0x89)]())fs[_0x3f3a3e(0x236)](temppath+_0x2a9725[_0x3f3a3e(0x1cb)]);}),logger[_0x3104af(0x100)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x3104af(0x25c)]({'restore':!![]},_0x33a542=>{});}async function getPublicIp(){const _0x388afd=_0x2d323a;try{const _0x5c7541=await axios[_0x388afd(0x202)](_0x388afd(0x19a));publicip=_0x5c7541[_0x388afd(0x201)]['ip'];}catch(_0x427bff){}}async function triggerAnalytics(){const _0x3c28e8=_0x2d323a;if(!publicip)await getPublicIp();const _0x3bab25=getBotsWithMode();let _0x493b89=0x0;_0x3bab25[_0x3c28e8(0xcb)](_0x19bbbb=>{const _0x5a0b74=_0x3c28e8;if(_0x19bbbb['status']===_0x5a0b74(0x1d6))_0x493b89++;});const _0x2db57b=getBotExchanges();mixpanel[_0x3c28e8(0x1b7)]('Server',{'distinct_id':settings[_0x3c28e8(0x210)],'ip':publicip,'version':serverversion,'numbots':_0x3bab25[_0x3c28e8(0x1e5)],'numbotsenabled':_0x493b89,'exchanges':_0x2db57b});}async function getMessages(){const _0x5873d0=_0x2d323a,_0x6029e=_0x5873d0(0x1a9),_0x2aaa1f=new GraphQLClient(_0x6029e),_0x209193={'authorization':_0x5873d0(0x239)},_0x3f208a=serverversion['split']('.'),_0x322f2e=_0x3f208a[0x0]+'.'+_0x3f208a[0x1],_0x596220=Math[_0x5873d0(0x1e8)](settings['lastmsgtelegram'],settings[_0x5873d0(0x168)]),_0x39c91c={'last':parseInt(_0x596220),'bbm':_0x322f2e},_0x5e5d03=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x29f3b6;try{_0x29f3b6=await _0x2aaa1f[_0x5873d0(0xe6)](_0x5e5d03,_0x39c91c,_0x209193);}catch(_0x5af3cc){}if(_0x29f3b6&&_0x29f3b6['messages']){let _0x425b55=settings['lastmsgtelegram'];newMessages=[];for(const _0x25f8c3 of _0x29f3b6['messages']){newMessages[_0x5873d0(0x1e7)](_0x25f8c3);if(_0x25f8c3[_0x5873d0(0x152)])updateSetting(_0x5873d0(0x253),_0x25f8c3['bbvNew']);let _0x32bceb=_0x25f8c3[_0x5873d0(0x152)]?serverversion>=_0x25f8c3['bbvNew']:![];if(!_0x32bceb&&_0x25f8c3[_0x5873d0(0x117)]>_0x425b55){if(_0x25f8c3[_0x5873d0(0x246)]===_0x5873d0(0x189)||serverversion[_0x5873d0(0x209)](_0x25f8c3[_0x5873d0(0x246)])){let _0x4cdeb3=''+_0x25f8c3[_0x5873d0(0x1bb)]+'\x0a\x0a'+_0x25f8c3[_0x5873d0(0x14a)];const _0x5d472a=await sendTelegramMsg(toTelegramMarkdown(_0x4cdeb3),_0x5873d0(0x17e));if(_0x5d472a)_0x425b55=_0x25f8c3['number'];}}}updateAvailable=isNewerVersion(settings[_0x5873d0(0x253)],serverversion),updateSetting(_0x5873d0(0xa0),_0x425b55),emitMessages();}}function emitMessages(){const _0x33359d=_0x2d323a,_0x12df18=settings[_0x33359d(0x168)];let _0x2a196a=[];newMessages[_0x33359d(0xcb)](_0x15b30b=>{const _0x43744b=_0x33359d;_0x15b30b[_0x43744b(0x117)]>_0x12df18&&_0x2a196a[_0x43744b(0x1e7)](_0x15b30b);}),_0x2a196a[_0x33359d(0x1e5)]>0x0&&getAllClients()[_0x33359d(0xcb)](_0x598ed6=>{const _0x5c20e3=_0x33359d;getSocket(_0x598ed6['id'])[_0x5c20e3(0xac)](_0x5c20e3(0x14a),_0x2a196a);});}function confirmMessage(_0xf30bfb){const _0x4257b4=_0x2d323a;updateSetting(_0x4257b4(0x168),Number(_0xf30bfb));}function isNewerVersion(_0x3033b1,_0x9019c2){const _0x34018c=_0x2d323a,_0x1686c2=_0x9019c2[_0x34018c(0xa4)]('.'),_0x6dae57=_0x3033b1[_0x34018c(0xa4)]('.');for(var _0x5e2e85=0x0;_0x5e2e85<_0x6dae57['length'];_0x5e2e85++){const _0x486309=~~_0x6dae57[_0x5e2e85],_0x1d5ed8=~~_0x1686c2[_0x5e2e85];if(_0x486309>_0x1d5ed8)return!![];if(_0x486309<_0x1d5ed8)return![];}return![];}function toTelegramMarkdown(_0x1b0a66){const _0xe9a831=_0x2d323a,_0x296b5f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5905a2=/\*{2}(.+?)\*{2}/gim;return _0x1b0a66=_0x1b0a66[_0xe9a831(0xb8)](_0x296b5f,_0xe9a831(0x21c))[_0xe9a831(0xb8)](_0x5905a2,_0xe9a831(0x111)),_0x1b0a66;}async function validateConfigFile(){const _0xb4d980=_0x2d323a,_0x27f8a8=dbConfig[_0xb4d980(0x202)](_0xb4d980(0xff))['sortBy']('botID')['value']()||[];if(_0x27f8a8[_0xb4d980(0x1e5)]==0x0){let _0x3d13c7=0x0,_0xced057=[];const _0x190bb6=/^bot-([0-9]{3})-config.json$/,_0x22a725=fs[_0xb4d980(0x1e2)](configpath);_0x22a725['forEach'](_0x737640=>{const _0x4b4d2e=_0xb4d980,_0x5ea48e=_0x190bb6[_0x4b4d2e(0x18c)](_0x737640);if(_0x5ea48e){const _0x23dba2=_0x5ea48e[0x1];let _0x35be78=getBotAttributes(_0x23dba2);_0xced057[_0x4b4d2e(0x1e7)]({'botID':_0x23dba2,'botname':_0x35be78[_0x4b4d2e(0x1c7)],'status':_0x4b4d2e(0x14b),'live':_0x4b4d2e(0x9e)}),_0x3d13c7++;}}),_0x3d13c7!=0x0&&(dbConfig[_0xb4d980(0x202)](_0xb4d980(0xff))[_0xb4d980(0xf1)](_0xced057)[_0xb4d980(0x1ce)](),config=_0xced057,restoredConfigFile=_0x3d13c7);}}async function restoreConfigNotify(_0x5a1f6a){const _0x4e6cdf=_0x2d323a;let _0x4cce5a;if(restoredConfigFile==0x1)_0x4cce5a=_0x4e6cdf(0x1f3);else _0x4cce5a=_0x4e6cdf(0x17a);if(_0x5a1f6a)io['to'](_0x4e6cdf(0x23f))[_0x4e6cdf(0xac)]('notification',_0x4cce5a);else{logger[_0x4e6cdf(0x18a)]('-----------------------------------------------------------------------------------'),logger[_0x4e6cdf(0x18a)](_0x4cce5a),logger[_0x4e6cdf(0x18a)]('-----------------------------------------------------------------------------------'),logger[_0x4e6cdf(0x18a)]('');if(tgBot&&settings[_0x4e6cdf(0x17c)]&&settings[_0x4e6cdf(0x125)]!=_0x4e6cdf(0x120))tgBot[_0x4e6cdf(0xa2)](settings[_0x4e6cdf(0x17c)],_0x4e6cdf(0x133)+_0x4cce5a)[_0x4e6cdf(0x8e)](_0x26c0cf=>{telegramError(_0x26c0cf);});}}function validateCredentials(_0x5489fd,_0x37ed2b){const _0x312a5e=_0x2d323a;if(_0x5489fd[_0x312a5e(0xbe)]==settings[_0x312a5e(0x141)]&&bcrypt[_0x312a5e(0xe8)](_0x5489fd[_0x312a5e(0xb0)],settings[_0x312a5e(0x15b)])){if(settings[_0x312a5e(0x1d3)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x25cd4b=generateLoginToken(_0x37ed2b);return{'allow':!![],'reason':_0x312a5e(0x22b),'token':_0x25cd4b};}}else return{'allow':![],'reason':_0x312a5e(0x11a),'token':null};}function refreshToken(_0x2572da){const _0x125d9c=generateLoginToken(_0x2572da);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x125d9c};}function validateAccess(_0x503af8,_0x252f34,_0x50312b){const _0x1299e1=_0x2d323a,_0x3f0c6a=_0x50312b?_0x50312b:devices[_0x252f34]['ip'];let _0x2f387c;const _0x52183f=_0x3628ac=>{const _0x3259c0=_0x4f2b;if(settings[_0x3259c0(0xfd)]){if(settings[_0x3259c0(0x1d3)]){if(telegram2FaApproved(_0x252f34)){const _0x247b25=generateLoginToken(_0x252f34);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x247b25};}else return{'allow':![],'reason':_0x3259c0(0x221),'token':null};}else return _0x2f387c=validToken(_0x3628ac,_0x252f34),_0x2f387c[_0x3259c0(0x234)](_0x3259c0(0x1f2))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3628ac}:{'allow':![],'reason':_0x3259c0(0x221),'token':null};}else return{'allow':!![],'reason':_0x3259c0(0xce),'token':null};};if(settings[_0x1299e1(0x24f)]){let _0x427de8=[...settings['whitelist'],_0x1299e1(0xcf),_0x1299e1(0x16d),_0x1299e1(0x18e)];if(_0x427de8[_0x1299e1(0x225)](_0x3f0c6a))return _0x52183f(_0x503af8);else{_0x2f387c=validToken(_0x503af8,_0x252f34);if(_0x2f387c[_0x1299e1(0x234)]('success'))return _0x52183f(_0x503af8);else{if(telegramIpApproved(_0x252f34)){const _0x24ff44=generateToken(_0x252f34);return _0x2f387c=_0x52183f(_0x503af8),_0x2f387c[_0x1299e1(0x1ff)]?{'allow':!![],'reason':_0x1299e1(0x1d1),'token':_0x24ff44}:_0x2f387c;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x1299e1(0x13a),'token':null}:{'allow':![],'reason':_0x1299e1(0xca),'token':null};}}}else return _0x52183f(_0x503af8);}function timelyDecrypt(_0x3e29c9,_0x104c5f=!![]){const _0x2d21bf=_0x2d323a;if(_0x3e29c9)try{const _0x44486c=crypt[_0x2d21bf(0x231)](secure[_0x2d21bf(0x22c)],_0x3e29c9)[_0x2d21bf(0x14a)],_0x576b5f=_0x44486c[_0x2d21bf(0xa4)]('@')[0x0],_0x35fd28=_0x44486c[_0x2d21bf(0xa4)]('@')[0x1],_0x34f71d=new Date()[_0x2d21bf(0x16c)]();if(_0x104c5f){if(_0x34f71d-_0x35fd28<maxSecretAge*0x3e8)return _0x576b5f;else return![];}else return _0x576b5f;}catch(_0x9cfd07){return![];}else return![];}const validToken=(_0xd32528,_0x5728e6)=>{const _0x33fc3f=_0x2d323a,_0x2377c5=devices[_0x5728e6]['ip'];if(!_0xd32528)return{'error':_0x33fc3f(0x185)};for(let _0x5752cd of blacklist){if(_0x5752cd['token']==_0xd32528)return{'error':'Token\x20blacklisted'};}let _0x1c23da;try{_0x1c23da=jwt[_0x33fc3f(0x154)](_0xd32528,secure[_0x33fc3f(0x1f9)]+_0x5728e6);}catch{return{'error':_0x33fc3f(0xfc)};}if(!_0x1c23da[_0x33fc3f(0x234)](_0x33fc3f(0xaa))&&!_0x1c23da[_0x33fc3f(0x234)](_0x33fc3f(0xbe))||!_0x1c23da[_0x33fc3f(0x234)](_0x33fc3f(0x23b)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x1c23da[_0x33fc3f(0x234)](_0x33fc3f(0xbe))&&_0x1c23da[_0x33fc3f(0x234)](_0x33fc3f(0xaa))){const {clientip:_0x2fccb6}=_0x1c23da;return _0x2377c5==_0x2fccb6?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x1c23da['hasOwnProperty'](_0x33fc3f(0xbe))&&_0x1c23da[_0x33fc3f(0x234)](_0x33fc3f(0xaa))){const {username:_0x47809b,clientip:_0x395636}=_0x1c23da;return settings[_0x33fc3f(0x141)]==_0x47809b&&_0x2377c5==_0x395636?{'success':_0x33fc3f(0x1fd)}:{'error':_0x33fc3f(0x215)};}}},generateLoginToken=_0x459129=>{const _0x6c9e84=_0x2d323a;if(_0x459129){const _0x54ba5e=devices[_0x459129]['ip'];return jwt[_0x6c9e84(0x208)]({'username':settings['bbUsername'],'clientip':_0x54ba5e},secure['secret']+_0x459129,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5a040b=>{const _0x500401=_0x2d323a;if(_0x5a040b){const _0x1a085d=devices[_0x5a040b]['ip'];return jwt[_0x500401(0x208)]({'clientip':_0x1a085d},secure[_0x500401(0x1f9)]+_0x5a040b,{'expiresIn':devices[_0x5a040b][_0x500401(0x139)][_0x500401(0x1a6)]*0x3c});}else return![];},telegramIpApproved=_0x5caa71=>{const _0x5c123a=_0x2d323a;let _0x33fe40=![];return devices[_0x5caa71]['telegramIpApproval']&&devices[_0x5caa71][_0x5c123a(0x139)][_0x5c123a(0x1a6)]!=_0x5c123a(0x150)&&(_0x33fe40=devices[_0x5caa71][_0x5c123a(0x139)][_0x5c123a(0xaa)]==devices[_0x5caa71]['ip']&&new Date()[_0x5c123a(0x16c)]()-devices[_0x5caa71][_0x5c123a(0x139)]['timestamp']<devices[_0x5caa71][_0x5c123a(0x139)]['expiry']*0x3c*0x3e8),_0x33fe40;},telegram2FaApproved=_0x3d35b6=>{const _0x1a5c5a=_0x2d323a;let _0x2d70b6=![];return devices[_0x3d35b6][_0x1a5c5a(0x1d4)]&&devices[_0x3d35b6][_0x1a5c5a(0x1d4)][_0x1a5c5a(0x1a6)]!=_0x1a5c5a(0x150)&&(_0x2d70b6=devices[_0x3d35b6][_0x1a5c5a(0x1d4)]['clientip']==devices[_0x3d35b6]['ip']&&new Date()[_0x1a5c5a(0x16c)]()-devices[_0x3d35b6][_0x1a5c5a(0x1d4)][_0x1a5c5a(0x259)]<devices[_0x3d35b6]['telegram2FaApproval'][_0x1a5c5a(0x1a6)]*0x3c*0x3e8),_0x2d70b6;},normalizeIP=_0x4d3197=>{const _0x20581b=_0x2d323a;let _0x3ceafa=null,_0x2f4266=null;if(ipaddr['isValid'](_0x4d3197)){const _0x4dba7f=ipaddr[_0x20581b(0x119)](_0x4d3197);_0x4dba7f[_0x20581b(0xf4)]()===_0x20581b(0x10c)?(_0x4dba7f[_0x20581b(0x16f)]()&&(_0x3ceafa=_0x4dba7f[_0x20581b(0x213)]()[_0x20581b(0x233)]()),_0x2f4266=_0x4dba7f[_0x20581b(0x233)]()):(_0x3ceafa=_0x4dba7f[_0x20581b(0x233)](),_0x2f4266=_0x4dba7f['toIPv4MappedAddress']()[_0x20581b(0x233)]());}return{'show':_0x3ceafa?_0x3ceafa:_0x2f4266,'store':_0x2f4266};};function formatDate(_0xd1929f){const _0x4bc3df=_0x2d323a;return _0xd1929f[_0x4bc3df(0xd2)]()+'/'+(_0xd1929f['getMonth']()+0x1)[_0x4bc3df(0x233)]()[_0x4bc3df(0xf7)](0x2,'0')+'/'+_0xd1929f[_0x4bc3df(0xcd)]()[_0x4bc3df(0x233)]()[_0x4bc3df(0xf7)](0x2,'0')+'\x20'+_0xd1929f['getHours']()[_0x4bc3df(0x233)]()[_0x4bc3df(0xf7)](0x2,'0')+':'+_0xd1929f[_0x4bc3df(0x1d5)]()['toString']()[_0x4bc3df(0xf7)](0x2,'0')+':'+_0xd1929f[_0x4bc3df(0x96)]()['toString']()[_0x4bc3df(0xf7)](0x2,'0');}function sleep(_0x221484){return new Promise(_0x33e725=>setTimeout(_0x33e725,_0x221484));}