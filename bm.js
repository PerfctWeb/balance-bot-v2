const _0x1d528a=_0x5715;(function(_0x3cf3fb,_0x7739bf){const _0x2345ca=_0x5715,_0x121a3f=_0x3cf3fb();while(!![]){try{const _0x41160b=parseInt(_0x2345ca(0x273))/0x1*(-parseInt(_0x2345ca(0x279))/0x2)+-parseInt(_0x2345ca(0x119))/0x3*(-parseInt(_0x2345ca(0x139))/0x4)+parseInt(_0x2345ca(0x28d))/0x5+-parseInt(_0x2345ca(0x13f))/0x6*(parseInt(_0x2345ca(0x1e9))/0x7)+parseInt(_0x2345ca(0x322))/0x8*(-parseInt(_0x2345ca(0x2bc))/0x9)+-parseInt(_0x2345ca(0x154))/0xa*(-parseInt(_0x2345ca(0x15a))/0xb)+parseInt(_0x2345ca(0x173))/0xc;if(_0x41160b===_0x7739bf)break;else _0x121a3f['push'](_0x121a3f['shift']());}catch(_0x5ebb86){_0x121a3f['push'](_0x121a3f['shift']());}}}(_0x4f6e,0xc7e8a));const _0x5a9bdd=function(){let _0x207b32=!![];return function(_0x4fa210,_0xe2ef69){const _0x1fcd37=_0x207b32?function(){const _0x507fa2=_0x5715;if(_0xe2ef69){const _0x54c5d8=_0xe2ef69[_0x507fa2(0x307)](_0x4fa210,arguments);return _0xe2ef69=null,_0x54c5d8;}}:function(){};return _0x207b32=![],_0x1fcd37;};}(),_0xc537bb=_0x5a9bdd(this,function(){const _0x22b79b=_0x5715;return _0xc537bb[_0x22b79b(0x215)]()[_0x22b79b(0x1d2)](_0x22b79b(0x314))['toString']()[_0x22b79b(0x270)](_0xc537bb)[_0x22b79b(0x1d2)](_0x22b79b(0x314));});_0xc537bb();'use strict';process[_0x1d528a(0x2c0)][_0x1d528a(0x301)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x1d528a(0x1af)),low=require(_0x1d528a(0x1f2)),FileSync=require(_0x1d528a(0x19f)),path=require('path'),crypto=require(_0x1d528a(0x24e)),Crypt=require('hybrid-crypto-js')[_0x1d528a(0x310)],RSA=require(_0x1d528a(0x142))[_0x1d528a(0x261)],bcrypt=require(_0x1d528a(0x2a5)),jwt=require(_0x1d528a(0x174)),ipaddr=require(_0x1d528a(0x10c)),argv=require(_0x1d528a(0x2a6))(process['argv'][_0x1d528a(0x2fa)](0x2))[_0x1d528a(0x191)],uuidRandom=require(_0x1d528a(0x2ac)),{Telegraf,Markup}=require(_0x1d528a(0x2c3)),Mixpanel=require(_0x1d528a(0x16c)),axios=require(_0x1d528a(0x25c)),{GraphQLClient,gql}=require(_0x1d528a(0x1ad)),util=require('util'),fileUpload=require(_0x1d528a(0x277)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x1d528a(0x2fd),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x1d528a(0x2c2)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x1d528a(0x161)),process[_0x1d528a(0x116)](0x1));const HOST=argv[_0x1d528a(0x14d)]||null,userID=argv[_0x1d528a(0x2e6)]||'',debugging=argv['d']||![],nodeversion=process[_0x1d528a(0x1b9)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x1d528a(0x223),configfile=_0x1d528a(0x17d),settingsfile=_0x1d528a(0x1e6),securefile=_0x1d528a(0x220),environment=require('./'+bbpath2+_0x1d528a(0x238))[_0x1d528a(0x2b4)]||_0x1d528a(0x31f),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x1d528a(0x133)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1d528a(0x27f)),configpath=userID?bbpath+_0x1d528a(0x1a4)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x1d528a(0x2d6),logspath=userID?bbpath+_0x1d528a(0x210)+userID+'/':bbpath+_0x1d528a(0x210),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x1d528a(0x176),loggerfile=fs[_0x1d528a(0x311)](logspath+_0x1d528a(0x16a),{'flags':'a'}),temppath=userID?bbpath+_0x1d528a(0x18e)+userID+'/':bbpath+'temp/';!fs[_0x1d528a(0x133)](configpath)&&fs[_0x1d528a(0x2c7)](configpath);!fs[_0x1d528a(0x133)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x1d528a(0x133)](logspath)&&fs[_0x1d528a(0x2c7)](logspath);!fs['existsSync'](zippath)&&fs[_0x1d528a(0x2c7)](zippath);!fs[_0x1d528a(0x133)](temppath)&&fs[_0x1d528a(0x2c7)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x1d528a(0x1de)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1d528a(0x2bd)]({'secure':{},'blacklist':[]})[_0x1d528a(0x1de)]();let crypt=new Crypt({'md':_0x1d528a(0x276),'rsaStandard':_0x1d528a(0x266)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1d528a(0x286)](_0x1d528a(0x269),{'host':_0x1d528a(0x30b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x1d528a(0x2b9)]!=''&&settings[_0x1d528a(0x2b9)]!=_0x1d528a(0x165))&&settings['telegramUsername']&&settings[_0x1d528a(0x2ea)]!='')initTelegram();const parseColor=(_0x14250a,_0x31a988)=>{const _0x2addb1=_0x1d528a,_0x540f06=/#[A-Z]{3}#/g;if(typeof _0x14250a==_0x2addb1(0x11d)){!_0x31a988?_0x14250a=_0x14250a[_0x2addb1(0x31e)](_0x540f06,''):(_0x14250a=_0x14250a[_0x2addb1(0x31e)](/#BLU#/g,_0x2addb1(0x28c)),_0x14250a=_0x14250a[_0x2addb1(0x31e)](/#RED#/g,'\x1b[31m'),_0x14250a=_0x14250a['replace'](/#YEL#/g,_0x2addb1(0x1c2)),_0x14250a=_0x14250a[_0x2addb1(0x31e)](/#MAG#/g,_0x2addb1(0x23b)),_0x14250a=_0x14250a[_0x2addb1(0x31e)](/#CYA#/g,_0x2addb1(0x2f0)),_0x14250a=_0x14250a['replace'](/#RES#/g,_0x2addb1(0x1cb)));;}return _0x14250a;},logger={'screen':_0x39d4e2=>{const _0x481c7a=_0x1d528a;console[_0x481c7a(0x2c2)](parseColor(_0x39d4e2,!![]));},'simple':_0x4b048a=>{const _0x16fa9a=_0x1d528a;console[_0x16fa9a(0x2c2)](parseColor(_0x4b048a,!![])),loggerfile[_0x16fa9a(0x1de)](util['format'](parseColor(_0x4b048a,![]))+'\x0a');},'full':async _0x4d7314=>{const _0x44736d=_0x1d528a,_0x2032df=getTimeStamp()+_0x44736d(0x115)+_0x4d7314;console[_0x44736d(0x2c2)](parseColor(_0x2032df,!![])),loggerfile[_0x44736d(0x1de)](util[_0x44736d(0x2ff)](parseColor(_0x2032df,![]))+'\x0a');if(tgBot&&settings[_0x44736d(0x256)]&&settings['telegramEvents']!=_0x44736d(0x18b))await sendTelegram(settings[_0x44736d(0x256)],_0x44736d(0x278)+parseColor(_0x4d7314,![]));},'debug':async(_0x4d1247,_0x3b20c9='')=>{const _0x348ed0=_0x1d528a,_0x2d7701=getTimeStamp()+_0x348ed0(0x265)+_0x4d1247;if(debugging)console['log'](parseColor(_0x2d7701,!![]));loggerfile['write'](util[_0x348ed0(0x2ff)](parseColor(_0x2d7701,![]))+'\x0a');if(_0x3b20c9){if(debugging)console['log'](_0x3b20c9);loggerfile[_0x348ed0(0x1de)](util['format'](_0x3b20c9)+'\x0a');}}};let terminating=![];process['on'](_0x1d528a(0x21c),function(_0x15999b){const _0x5dd646=_0x1d528a;_0x15999b['toString']()[_0x5dd646(0x2eb)](_0x5dd646(0x24f))?(logger[_0x5dd646(0x159)](_0x5dd646(0x29e)+_0x15999b[_0x5dd646(0x1b8)]+'#RES#'),process['send']({'terminate':!![]},_0x7bd2e6=>{})):logger[_0x5dd646(0x159)](_0x15999b);}),process['on'](_0x1d528a(0x116),()=>{const _0x35d11d=_0x1d528a;stopAllBots(),process[_0x35d11d(0x116)](0x0);}),process['on'](_0x1d528a(0x25d),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x1d528a(0x1c9),()=>{const _0x23c48d=_0x1d528a;stopAllBots(),process[_0x23c48d(0x116)](0x0);});function _0x5715(_0x2a6776,_0x204cda){const _0x4f1a93=_0x4f6e();return _0x5715=function(_0xc537bb,_0x5a9bdd){_0xc537bb=_0xc537bb-0x102;let _0x4f6e49=_0x4f1a93[_0xc537bb];return _0x4f6e49;},_0x5715(_0x2a6776,_0x204cda);}let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1d528a(0x238))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x1d528a(0x158))[_0x1d528a(0x1ba)](app);app[_0x1d528a(0x1f0)](fileUpload({'useTempFiles':!![]})),app[_0x1d528a(0x202)]('/download/:type',async(_0x4de9fe,_0x35f62a)=>{const _0x16ff87=_0x1d528a,_0x1870fc=_0x4de9fe[_0x16ff87(0x14e)][_0x16ff87(0x150)],_0x264973=getClientsWithBotID('botmanager'),_0xc7840c=_0x4de9fe[_0x16ff87(0x14a)]['uuid'],_0x952047=timelyDecrypt(_0xc7840c,![]),_0x2893f5=_0x264973[_0x16ff87(0x251)](_0x374888=>_0x374888[_0x16ff87(0x12f)]==_0x952047);if(_0x2893f5){const _0x11952d=normalizeIP(_0x4de9fe[_0x16ff87(0x230)][_0x16ff87(0x183)])[_0x16ff87(0x182)],_0x520a00=_0x4de9fe[_0x16ff87(0x14a)][_0x16ff87(0x25a)];if(validateAccess(_0x520a00,_0x952047,_0x11952d)[_0x16ff87(0x1eb)])_0x1870fc=='backup'&&await backupConfigFiles(),await zipFiles(_0x1870fc),_0x35f62a[_0x16ff87(0x1c8)](zippath+(_0x1870fc+_0x16ff87(0x2f2)),_0x4b9935=>{const _0x330340=_0x16ff87;_0x4b9935&&(logger['full'](_0x330340(0x2e9)+_0x1870fc),logger[_0x330340(0x159)](_0x4b9935));});else logger[_0x16ff87(0x31c)](_0x16ff87(0x1ea)+_0x1870fc+_0x16ff87(0x2de));}else logger['full'](_0x16ff87(0x1ea)+_0x1870fc+'\x20(2)');}),app[_0x1d528a(0x13c)](_0x1d528a(0x272),async(_0x34bc25,_0xf38a3f)=>{const _0x56304f=_0x1d528a,_0x4b9940=getClientsWithBotID(_0x56304f(0x15c)),_0x4cf728=_0x34bc25[_0x56304f(0x14a)][_0x56304f(0x12f)],_0x4e3128=timelyDecrypt(_0x4cf728,![]),_0x3d53c4=_0x4b9940[_0x56304f(0x251)](_0xb65639=>_0xb65639['uuid']==_0x4e3128);logger['debug'](_0x56304f(0x1c1));if(_0x3d53c4){const _0x413df6=normalizeIP(_0x34bc25[_0x56304f(0x230)][_0x56304f(0x183)])[_0x56304f(0x182)],_0x3e8bc1=_0x34bc25[_0x56304f(0x14a)]['tkn'];if(validateAccess(_0x3e8bc1,_0x4e3128,_0x413df6)['allow']){if(_0x34bc25[_0x56304f(0x2b6)]){const _0x19c92c=_0x34bc25[_0x56304f(0x2b6)][_0x56304f(0x22c)];await _0x19c92c['mv'](temppath+_0x19c92c[_0x56304f(0x242)]),_0xf38a3f[_0x56304f(0x2e0)]({'status':!![],'message':_0x56304f(0x126)});const _0x2e18e1=getBotsWithMode();_0x2e18e1[_0x56304f(0x30c)]>0x0?confirmRestore(temppath,_0x19c92c[_0x56304f(0x242)]):unzipFile(temppath,_0x19c92c[_0x56304f(0x242)]);}}else logger[_0x56304f(0x31c)](_0x56304f(0x2cf));}else logger[_0x56304f(0x31c)](_0x56304f(0x143));}),app[_0x1d528a(0x1f0)](express[_0x1d528a(0x144)](path['join'](__dirname,bbpath2,_0x1d528a(0x21a)))),app[_0x1d528a(0x1f0)](express['static'](path[_0x1d528a(0x1e3)](__dirname,bbpath2,'build'))),app[_0x1d528a(0x202)]('/',function(_0x147431,_0x58f81c){const _0x1d3266=_0x1d528a;_0x58f81c['sendFile'](path[_0x1d3266(0x1e3)](__dirname,bbpath2,'build2','index.html'));}),app[_0x1d528a(0x202)](_0x1d528a(0x252),function(_0x3ef024,_0x59d227){const _0x16eb4a=_0x1d528a;_0x59d227['sendFile'](path[_0x16eb4a(0x1e3)](__dirname,bbpath2,_0x16eb4a(0x171),'index.html'));}),app[_0x1d528a(0x202)](_0x1d528a(0x1f4),(_0x2434af,_0x256f5e)=>{const _0x3e747e=_0x1d528a;_0x256f5e[_0x3e747e(0x231)](path['join'](__dirname,bbpath2,_0x3e747e(0x171),_0x3e747e(0x200)));}),app['get'](_0x1d528a(0x27b),(_0x241530,_0x244739)=>{const _0x3ce2c9=_0x1d528a;_0x244739[_0x3ce2c9(0x231)](path[_0x3ce2c9(0x1e3)](__dirname,bbpath2,_0x3ce2c9(0x171),_0x3ce2c9(0x200)));}),app[_0x1d528a(0x202)](_0x1d528a(0x149),(_0x4ce6e7,_0x57142d)=>{const _0x403e2b=_0x1d528a;_0x57142d[_0x403e2b(0x231)](path[_0x403e2b(0x1e3)](__dirname,bbpath2,'build',_0x403e2b(0x200)));}),app[_0x1d528a(0x202)](_0x1d528a(0x243),(_0x3f9358,_0x52c387)=>{const _0x5e23d8=_0x1d528a;_0x52c387['sendFile'](path[_0x5e23d8(0x1e3)](__dirname,bbpath2,_0x5e23d8(0x171),_0x5e23d8(0x200)));}),app[_0x1d528a(0x202)](_0x1d528a(0x1fa),(_0x251d5d,_0x402860)=>{const _0x102903=_0x1d528a;_0x402860[_0x102903(0x231)](path[_0x102903(0x1e3)](__dirname,bbpath2,_0x102903(0x171),_0x102903(0x200)));}),app[_0x1d528a(0x202)](_0x1d528a(0x2f1),(_0x429a21,_0x33bb84)=>{const _0x5714bb=_0x1d528a;_0x33bb84['sendFile'](path[_0x5714bb(0x1e3)](__dirname,bbpath2,_0x5714bb(0x171),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x1d528a(0x2a2)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4088a1=_0x1d528a;let _0x3ed976=_0x4088a1(0x226);const _0x21eed5=networkInterfaces(),_0x16b432={};for(const _0x5d8cea of Object[_0x4088a1(0x298)](_0x21eed5)){for(const _0xb4fd4c of _0x21eed5[_0x5d8cea]){if((_0xb4fd4c[_0x4088a1(0x203)]=='IPv4'||_0xb4fd4c[_0x4088a1(0x203)]==0x4)&&!_0xb4fd4c[_0x4088a1(0x26f)]){const _0x1c81a4=ipaddr['parse'](_0xb4fd4c[_0x4088a1(0x31b)])['range']();_0x1c81a4!=_0x4088a1(0x2f4)&&(!_0x16b432[_0x5d8cea]&&(_0x16b432[_0x5d8cea]=[]),_0x16b432[_0x5d8cea][_0x4088a1(0x2af)](_0xb4fd4c[_0x4088a1(0x31b)]),_0x3ed976=_0xb4fd4c[_0x4088a1(0x31b)]);}}}return{'serverip':_0x3ed976,'netinterfaces':_0x16b432};}async function startServer(){const _0x535832=_0x1d528a,{serverip:_0xdc5ff9,netinterfaces:_0x43990c}=getServerIP();logger['simple'](''),logger[_0x535832(0x159)](_0x535832(0x236)),await logger[_0x535832(0x31c)](_0x535832(0x2b2)+serverversion+_0x535832(0x153)+(environment==_0x535832(0x163)?'(staging)':'')+'\x0a'+(_0x535832(0x127)+PORT+_0x535832(0x152))+(_0x535832(0x10b)+_0xdc5ff9+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x535832(0x236));if(config[_0x535832(0x30c)]!=0x0)for(const _0x2786df of config){const _0x41e404=_0x2786df[_0x535832(0x2bb)]==_0x535832(0x1f6)?'a':'m';if(_0x2786df[_0x535832(0x17e)]==_0x535832(0x12a)||_0x2786df[_0x535832(0x17e)]=='new')await logger[_0x535832(0x31c)](_0x535832(0x258)+_0x41e404+_0x535832(0x205)+_0x2786df[_0x535832(0x20f)]+_0x535832(0x10d)+_0x2786df[_0x535832(0x2c9)]),startBot([_0x2786df['botID'],userID],{'cwd':bbpath},function(_0x1fdf7c){const _0x464ae5=_0x535832;if(_0x1fdf7c)logger[_0x464ae5(0x31c)](_0x1fdf7c);});else(_0x2786df[_0x535832(0x17e)]==_0x535832(0x19a)||_0x2786df['status']==_0x535832(0x130))&&await logger[_0x535832(0x31c)](_0x535832(0x27d)+_0x41e404+')\x20\x20\x20|\x20Bot\x20'+_0x2786df[_0x535832(0x20f)]+_0x535832(0x10d)+_0x2786df[_0x535832(0x2c9)]);}else!newBot&&logger['simple'](_0x535832(0x281));if(newBot)addBot();logger[_0x535832(0x159)](_0x535832(0x236)),logger[_0x535832(0x159)](''),await logger['debug'](_0x535832(0x1e4)+nodeversion),await logger[_0x535832(0x12e)](_0x535832(0x2f7),_0x43990c);}function startSocket(){const _0x1ec583=_0x1d528a;io['on'](_0x1ec583(0x1a9),_0x5392b0=>{const _0x29b09f=_0x1ec583;let _0x472a6e,_0x5123bd,_0x4e7aea,_0x5066e0,_0x167098;const _0x94f0c7=_0x5392b0[_0x29b09f(0x23d)][_0x29b09f(0x14a)][_0x29b09f(0x1d0)];_0x5123bd=_0x94f0c7[_0x29b09f(0x262)](/bot[0-9]{3}/);if(_0x5123bd)_0x4e7aea=_0x5123bd[0x0][_0x29b09f(0x262)](/[0-9]{3}/);if(_0x4e7aea)_0x472a6e=_0x4e7aea[0x0];else _0x472a6e=_0x29b09f(0x15c);const _0x40ed41=_0x5392b0['handshake'][_0x29b09f(0x178)][_0x29b09f(0x10f)];if(!_0x40ed41)_0x5392b0[_0x29b09f(0x289)](_0x29b09f(0x17e),{'publicKey':secure[_0x29b09f(0x1b2)]});else{_0x5066e0=timelyDecrypt(_0x40ed41,![]);if(!_0x5066e0)_0x5392b0['emit'](_0x29b09f(0x17e),{'publicKey':secure[_0x29b09f(0x1b2)]});else{_0x167098=normalizeIP(_0x5392b0['conn'][_0x29b09f(0x183)])[_0x29b09f(0x182)];if(!devices[_0x5066e0])devices[_0x5066e0]={'uuid':_0x5066e0,'access':{'token':null}};devices[_0x5066e0]['ip']=_0x167098;const _0x3aefec=addClient(_0x5392b0['id'],_0x5066e0,_0x472a6e);setAccess(_0x3aefec),emitMessages(),_0x5392b0['on'](_0x29b09f(0x22d),_0x201e6c=>{const _0x3ea9bf=_0x29b09f,_0x53cb8d=timelyDecrypt(_0x201e6c[_0x3ea9bf(0x263)],!![],_0x3ea9bf(0x114));if(_0x53cb8d){_0x201e6c={'username':_0x201e6c[_0x3ea9bf(0x135)],'password':_0x53cb8d},devices[_0x5066e0][_0x3ea9bf(0x268)]=validateCredentials(_0x201e6c,_0x5066e0);if(devices[_0x5066e0][_0x3ea9bf(0x268)][_0x3ea9bf(0x1eb)]==![]&&devices[_0x5066e0]['access'][_0x3ea9bf(0x1dd)]==_0x3ea9bf(0x275))_0x5392b0[_0x3ea9bf(0x289)](_0x3ea9bf(0x17e),{'access':devices[_0x5066e0][_0x3ea9bf(0x268)]}),loginAccess2FA(_0x5066e0,_0x167098);else{if(devices[_0x5066e0][_0x3ea9bf(0x268)][_0x3ea9bf(0x1eb)]==![]&&devices[_0x5066e0][_0x3ea9bf(0x268)][_0x3ea9bf(0x1dd)]=='invalid\x20credentials')_0x5392b0[_0x3ea9bf(0x289)](_0x3ea9bf(0x17e),{'access':devices[_0x5066e0][_0x3ea9bf(0x268)]});else devices[_0x5066e0]['access']['allow']&&devices[_0x5066e0][_0x3ea9bf(0x268)][_0x3ea9bf(0x1dd)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5066e0)[_0x3ea9bf(0x317)](_0x375ad1=>{setAccess(_0x375ad1);}),logger[_0x3ea9bf(0x12e)](_0x3ea9bf(0x2ca)+_0x5066e0[_0x3ea9bf(0x2fa)](-0x8)),setTokenRefresh(_0x5066e0),setSessionTimeout('login',_0x5066e0));}}else logger[_0x3ea9bf(0x31c)](_0x3ea9bf(0x2aa));}),_0x5392b0['on'](_0x29b09f(0x245),()=>{resetPassword();}),_0x5392b0['on'](_0x29b09f(0x285),_0x33724a=>{removeClient(_0x5392b0['id']);}),_0x472a6e==_0x29b09f(0x15c)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x422ba8){const _0x15f57c=_0x1d528a;if(_0x422ba8!=_0x15f57c(0x15c)&&config[_0x15f57c(0x290)]!=''){if(pid[_0x422ba8])pid[_0x422ba8]['send']({'function':_0x15f57c(0x108),'args':null});}_0x422ba8!=_0x15f57c(0x15c)&&broadcastToBots('bots',JSON[_0x15f57c(0x208)](config));}function reloadBotManager(){const _0x15b072=_0x1d528a;getClientsWithBotID('botmanager')[_0x15b072(0x317)](_0xa6b7bb=>{const _0x227ea2=_0x15b072;getSocket(_0xa6b7bb['id'])[_0x227ea2(0x289)](_0x227ea2(0x17e),{'access':{'allow':![],'reason':_0x227ea2(0x2f3),'token':null}});});}function getSocket(_0x4d5a86){const _0x39a898=_0x1d528a;return io['sockets'][_0x39a898(0x218)]['get'](_0x4d5a86);}function setAccess(_0x5ead70){const _0x7227d7=_0x1d528a,_0x3c66ba=getSocket(_0x5ead70['id']),_0x4d692b=_0x5ead70['uuid'],_0x4b17ca=_0x5ead70['bot'];devices[_0x4d692b]['access']=validateAccess(devices[_0x4d692b]['access'][_0x7227d7(0x2ab)],_0x4d692b),logger[_0x7227d7(0x12e)](_0x7227d7(0x29a)+devices[_0x4d692b]['access'][_0x7227d7(0x1dd)]+_0x7227d7(0x2b5)+_0x5ead70['id'][_0x7227d7(0x2fa)](-0x8)+_0x7227d7(0x1db)+_0x4d692b[_0x7227d7(0x2fa)](-0x8)),_0x3c66ba[_0x7227d7(0x1e3)](_0x4d692b);if(devices[_0x4d692b][_0x7227d7(0x268)][_0x7227d7(0x1eb)]){_0x3c66ba[_0x7227d7(0x1e3)](_0x4b17ca);if(_0x4b17ca==_0x7227d7(0x15c))initializeSocketBotManager(_0x3c66ba);else initializeSocketBot(_0x3c66ba);initClient(_0x4b17ca);}devices[_0x4d692b][_0x7227d7(0x268)][_0x7227d7(0x2ab)]&&devices[_0x4d692b][_0x7227d7(0x268)][_0x7227d7(0x1dd)]==_0x7227d7(0x229)&&setSessionTimeout(_0x7227d7(0x1ec),_0x4d692b),devices[_0x4d692b][_0x7227d7(0x268)]['token']&&devices[_0x4d692b][_0x7227d7(0x268)][_0x7227d7(0x1dd)]==_0x7227d7(0x1ac)&&setSessionTimeout(_0x7227d7(0x22d),_0x4d692b),_0x3c66ba[_0x7227d7(0x289)](_0x7227d7(0x17e),{'status':_0x5ead70[_0x7227d7(0x105)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4d692b][_0x7227d7(0x268)],'externalip':devices[_0x4d692b]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x7227d7(0x11f)],'validInstallation':validInstallation}),devices[_0x4d692b]['access'][_0x7227d7(0x1eb)]==![]&&devices[_0x4d692b][_0x7227d7(0x268)][_0x7227d7(0x1dd)]=='2FA\x20required'&&temporaryAccess2FA(_0x4d692b,devices[_0x4d692b]['ip']);}function setSessionTimeout(_0xc79178,_0x3ed73f){const _0x3f4b77=_0x1d528a;let _0x33fe46;if(_0xc79178==_0x3f4b77(0x22d))_0x33fe46=loginExpiry*0x3c*0x3e8;else _0x33fe46=devices[_0x3ed73f]['telegramIpApproval'][_0x3f4b77(0x1f8)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x3ed73f][_0x3f4b77(0x22e)][_0x3f4b77(0x112)]);if(devices[_0x3ed73f][_0x3f4b77(0x2d8)])clearTimeout(devices[_0x3ed73f][_0x3f4b77(0x2d8)]);devices[_0x3ed73f][_0x3f4b77(0x2d8)]=setTimeout(()=>{const _0x568381=_0x3f4b77;if(devices[_0x3ed73f][_0x568381(0x283)])clearTimeout(devices[_0x3ed73f][_0x568381(0x283)]);removeSocketListeners(_0x3ed73f),addBlacklist(_0x3ed73f),devices[_0x3ed73f][_0x568381(0x22e)]=null,devices[_0x3ed73f]['telegram2FaApproval']=null,devices[_0x3ed73f][_0x568381(0x268)][_0x568381(0x2ab)]=null,logger[_0x568381(0x12e)]('Session\x20expired\x20for\x20user\x20...'+_0x3ed73f['slice'](-0x8)),devices[_0x3ed73f][_0x568381(0x268)]=validateAccess(devices[_0x3ed73f]['access'][_0x568381(0x2ab)],_0x3ed73f),!(devices[_0x3ed73f][_0x568381(0x268)][_0x568381(0x1eb)]&&devices[_0x3ed73f]['access'][_0x568381(0x1dd)]==_0x568381(0x22f))&&(_0xc79178==_0x568381(0x22d)?io['to'](_0x3ed73f)[_0x568381(0x289)](_0x568381(0x17e),{'access':{'allow':![],'reason':_0x568381(0x2c6),'token':null}}):io['to'](_0x3ed73f)['emit'](_0x568381(0x17e),{'access':{'allow':![],'reason':_0x568381(0x146),'token':null}})),devices[_0x3ed73f][_0x568381(0x268)][_0x568381(0x2ab)]=null;},_0x33fe46);}function setTokenRefresh(_0xbad35f){const _0x381d61=_0x1d528a;if(devices[_0xbad35f][_0x381d61(0x283)])clearTimeout(devices[_0xbad35f][_0x381d61(0x283)]);devices[_0xbad35f][_0x381d61(0x283)]=setTimeout(()=>{const _0x4c572c=_0x381d61;getClientsWithUuid(_0xbad35f)[_0x4c572c(0x30c)]!=0x0?(devices[_0xbad35f][_0x4c572c(0x268)]=refreshToken(_0xbad35f),io['to'](_0xbad35f)[_0x4c572c(0x289)](_0x4c572c(0x17e),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xbad35f][_0x4c572c(0x268)],'externalip':devices[_0xbad35f]['ip'],'publicKey':secure[_0x4c572c(0x1b2)],'validInstallation':validInstallation}),setTokenRefresh(_0xbad35f)):clearTimeout(devices[_0xbad35f][_0x4c572c(0x283)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x32632d){const _0x1f4827=_0x1d528a,_0x38172c=getClient(_0x32632d['id'])[_0x1f4827(0x12f)];_0x32632d['emit']('bots',config),_0x32632d[_0x1f4827(0x289)](_0x1f4827(0x1a7),cleanSettings()),_0x32632d['on'](_0x1f4827(0x1a1),_0x2094cc=>{const _0x5ca58e=_0x1f4827;if(validateAccess(_0x2094cc,_0x38172c)['allow'])addBot();else logger[_0x5ca58e(0x31c)](_0x5ca58e(0x1d8));}),_0x32632d['on']('update-bot',(_0x37ecf3,_0x218b82)=>{const _0x498ca1=_0x1f4827;if(validateAccess(_0x218b82,_0x38172c)['allow'])toggleBot(_0x37ecf3['botID'],_0x37ecf3[_0x498ca1(0x17e)],_0x37ecf3[_0x498ca1(0x1c3)]);else logger[_0x498ca1(0x31c)](_0x498ca1(0x313));}),_0x32632d['on'](_0x1f4827(0x2e7),(_0x7bd966,_0x2c120a)=>{const _0xa1400c=_0x1f4827;if(validateAccess(_0x2c120a,_0x38172c)[_0xa1400c(0x1eb)])toggleBotMode(_0x7bd966);else logger[_0xa1400c(0x31c)](_0xa1400c(0x313));}),_0x32632d['on']('delete-bot',(_0x14e428,_0x3b672c)=>{const _0x56261d=_0x1f4827;if(validateAccess(_0x3b672c,_0x38172c)[_0x56261d(0x1eb)])deleteBot(_0x14e428);else logger[_0x56261d(0x31c)](_0x56261d(0x2fe));}),_0x32632d['on']('store-settings',(_0x1c0e3e,_0x3a27de)=>{const _0xae7f76=_0x1f4827;if(validateAccess(_0x3a27de,_0x38172c)[_0xae7f76(0x1eb)])storeSettings(_0x1c0e3e,!![]);else logger[_0xae7f76(0x31c)](_0xae7f76(0x2cd));}),_0x32632d['on'](_0x1f4827(0x299),_0x5079cc=>{const _0x162a2f=_0x1f4827;if(validateAccess(_0x5079cc,_0x38172c)[_0x162a2f(0x1eb)])updateBB(_0x162a2f(0x172));else logger[_0x162a2f(0x31c)](_0x162a2f(0x188));}),_0x32632d['on'](_0x1f4827(0x1ff),_0xf98765=>{const _0x105e10=_0x1f4827;if(validateAccess(_0xf98765,_0x38172c)[_0x105e10(0x1eb)])updateBB(_0x105e10(0x11e));else logger[_0x105e10(0x31c)](_0x105e10(0x1bb));}),_0x32632d['on'](_0x1f4827(0x25b),_0x255099=>{const _0x25e950=_0x1f4827;if(validateAccess(_0x255099,_0x38172c)[_0x25e950(0x1eb)]){const _0xf74d5=getClient(_0x32632d['id']);if(_0xf74d5)getBackupFiles(_0xf74d5['uuid']);else logger[_0x25e950(0x31c)](_0x25e950(0x26e));}else logger[_0x25e950(0x31c)](_0x25e950(0x2a7));}),_0x32632d['on'](_0x1f4827(0x260),(_0x3d2d0d,_0x3cb54d)=>{const _0x3623b3=_0x1f4827;if(validateAccess(_0x3cb54d,_0x38172c)[_0x3623b3(0x1eb)])restoreBackupFile(_0x3d2d0d);else logger[_0x3623b3(0x31c)](_0x3623b3(0x235));}),_0x32632d['on'](_0x1f4827(0x151),_0x35a617=>{const _0x41ed28=_0x1f4827;if(validateAccess(_0x35a617,_0x38172c)[_0x41ed28(0x1eb)])getMessages();else logger[_0x41ed28(0x31c)](_0x41ed28(0x2d5));}),_0x32632d['on'](_0x1f4827(0x16b),(_0xee5f43,_0x1621fa)=>{const _0x628076=_0x1f4827;if(validateAccess(_0x1621fa,_0x38172c)[_0x628076(0x1eb)])confirmMessage(_0xee5f43);else logger['full'](_0x628076(0x117));}),_0x32632d['on'](_0x1f4827(0x15e),_0x30b925=>{const _0x3d6cba=_0x1f4827;if(validateAccess(_0x30b925,_0x38172c)[_0x3d6cba(0x1eb)]){if(devices[_0x38172c][_0x3d6cba(0x283)])clearTimeout(devices[_0x38172c][_0x3d6cba(0x283)]);if(devices[_0x38172c][_0x3d6cba(0x2d8)])clearTimeout(devices[_0x38172c][_0x3d6cba(0x2d8)]);removeSocketListeners(getClient(_0x32632d['id'])[_0x3d6cba(0x12f)]),addBlacklist(_0x38172c),devices[_0x38172c][_0x3d6cba(0x22e)]=null,devices[_0x38172c]['telegram2FaApproval']=null,devices[_0x38172c][_0x3d6cba(0x268)][_0x3d6cba(0x2ab)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x38172c[_0x3d6cba(0x2fa)](-0x8)),io['to'](getClient(_0x32632d['id'])[_0x3d6cba(0x12f)])[_0x3d6cba(0x289)](_0x3d6cba(0x17e),{'access':{'allow':![],'reason':_0x3d6cba(0x1d6),'token':null}});}else logger[_0x3d6cba(0x31c)](_0x3d6cba(0x121));});}function initializeSocketBot(_0x229c62){const _0x4be4df=_0x1d528a,_0x40b4b8=getClient(_0x229c62['id'])[_0x4be4df(0x2a1)],_0x4f4d4f=getClient(_0x229c62['id'])['uuid'];_0x229c62['on'](_0x4be4df(0x12d),(_0x50daed,_0x43f863)=>{const _0x144510=_0x4be4df;if(validateAccess(_0x43f863,_0x4f4d4f)[_0x144510(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8]['send']({'function':_0x144510(0x1aa),'args':_0x50daed});}else logger['full'](_0x144510(0x102));}),_0x229c62['on'](_0x4be4df(0x227),(_0x3a46e1,_0x213d84)=>{const _0x5e9978=_0x4be4df;if(validateAccess(_0x213d84,_0x4f4d4f)[_0x5e9978(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8]['send']({'function':_0x5e9978(0x113),'args':_0x3a46e1});}else logger[_0x5e9978(0x31c)](_0x5e9978(0x187));}),_0x229c62['on'](_0x4be4df(0x1d7),(_0x33b948,_0x532960)=>{const _0x3d1ffe=_0x4be4df;if(validateAccess(_0x532960,_0x4f4d4f)[_0x3d1ffe(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8]['send']({'function':_0x3d1ffe(0x1ab),'args':_0x33b948});}else logger[_0x3d1ffe(0x31c)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x229c62['on'](_0x4be4df(0x2c8),(_0x378416,_0x342b15)=>{const _0x23bf69=_0x4be4df;if(validateAccess(_0x342b15,_0x4f4d4f)[_0x23bf69(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8][_0x23bf69(0x2e0)]({'function':_0x23bf69(0x2f8),'args':_0x378416});}else logger[_0x23bf69(0x31c)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x229c62['on'](_0x4be4df(0x257),(_0x3a880c,_0x386aaa)=>{const _0x5da1d4=_0x4be4df;if(validateAccess(_0x386aaa,_0x4f4d4f)['allow']){if(pid[_0x40b4b8])pid[_0x40b4b8]['send']({'function':_0x5da1d4(0x132),'args':_0x3a880c});}else logger[_0x5da1d4(0x31c)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x229c62['on']('store-fiat',(_0xdcc95b,_0x3a173b)=>{const _0x6ed7b8=_0x4be4df;if(validateAccess(_0x3a173b,_0x4f4d4f)['allow']){if(pid[_0x40b4b8])pid[_0x40b4b8][_0x6ed7b8(0x2e0)]({'function':_0x6ed7b8(0x1b4),'args':_0xdcc95b});}else logger[_0x6ed7b8(0x31c)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x229c62['on'](_0x4be4df(0x211),_0x31cca7=>{const _0x1192c3=_0x4be4df;if(validateAccess(_0x31cca7,_0x4f4d4f)[_0x1192c3(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8][_0x1192c3(0x2e0)]({'function':'resetHistory','args':null});}else logger[_0x1192c3(0x31c)](_0x1192c3(0x20b));}),_0x229c62['on']('get-starting-balances',_0x32dd11=>{const _0x4dd4da=_0x4be4df;if(validateAccess(_0x32dd11,_0x4f4d4f)[_0x4dd4da(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8][_0x4dd4da(0x2e0)]({'function':_0x4dd4da(0x222),'args':null});}else logger['full'](_0x4dd4da(0x295));}),_0x229c62['on']('place-order',(_0x1a3a12,_0x626944)=>{const _0x3e91a9=_0x4be4df;if(validateAccess(_0x626944,_0x4f4d4f)[_0x3e91a9(0x1eb)]){if(pid[_0x40b4b8])pid[_0x40b4b8][_0x3e91a9(0x2e0)]({'function':_0x3e91a9(0x29f),'args':_0x1a3a12});}else logger[_0x3e91a9(0x31c)](_0x3e91a9(0x107));}),_0x229c62['on'](_0x4be4df(0x2be),_0x2bc789=>{const _0x530c07=_0x4be4df;if(validateAccess(_0x2bc789,_0x4f4d4f)['allow']){if(pid[_0x40b4b8])pid[_0x40b4b8]['send']({'function':_0x530c07(0x23c),'args':null});}else logger['full'](_0x530c07(0x1b5));}),_0x229c62['on'](_0x4be4df(0x129),_0x248182=>{const _0x291e02=_0x4be4df;if(validateAccess(_0x248182,_0x4f4d4f)['allow']){if(pid[_0x40b4b8])pid[_0x40b4b8][_0x291e02(0x2e0)]({'function':'showConfig','args':null});}else logger[_0x291e02(0x31c)](_0x291e02(0x1fc));}),_0x229c62['on'](_0x4be4df(0x299),_0x150b0d=>{const _0x657bc9=_0x4be4df;if(validateAccess(_0x150b0d,_0x4f4d4f)['allow'])updateBB(_0x657bc9(0x172));else logger[_0x657bc9(0x31c)](_0x657bc9(0x188));}),_0x229c62['on'](_0x4be4df(0x151),_0x15c32e=>{const _0x19a7f9=_0x4be4df;if(validateAccess(_0x15c32e,_0x4f4d4f)[_0x19a7f9(0x1eb)])getMessages();else logger[_0x19a7f9(0x31c)](_0x19a7f9(0x2d5));}),_0x229c62['on'](_0x4be4df(0x16b),(_0x36e491,_0x3b0359)=>{const _0x55cac7=_0x4be4df;if(validateAccess(_0x3b0359,_0x4f4d4f)[_0x55cac7(0x1eb)])confirmMessage(_0x36e491);else logger[_0x55cac7(0x31c)](_0x55cac7(0x117));}),_0x229c62['on'](_0x4be4df(0x15e),_0x9829b3=>{const _0x39b48b=_0x4be4df;if(validateAccess(_0x9829b3,_0x4f4d4f)[_0x39b48b(0x1eb)]){if(devices[_0x4f4d4f][_0x39b48b(0x283)])clearTimeout(devices[_0x4f4d4f][_0x39b48b(0x283)]);if(devices[_0x4f4d4f][_0x39b48b(0x2d8)])clearTimeout(devices[_0x4f4d4f]['pidExpireLogin']);removeSocketListeners(getClient(_0x229c62['id'])[_0x39b48b(0x12f)]),addBlacklist(_0x4f4d4f),devices[_0x4f4d4f][_0x39b48b(0x22e)]=null,devices[_0x4f4d4f]['telegram2FaApproval']=null,devices[_0x4f4d4f]['access'][_0x39b48b(0x2ab)]=null,logger[_0x39b48b(0x12e)](_0x39b48b(0x1fb)+_0x4f4d4f[_0x39b48b(0x2fa)](-0x8)),io['to'](getClient(_0x229c62['id'])['uuid'])[_0x39b48b(0x289)](_0x39b48b(0x17e),{'access':{'allow':![],'reason':_0x39b48b(0x1d6),'token':null}});}else logger[_0x39b48b(0x31c)](_0x39b48b(0x121));});}function removeSocketListeners(_0x3ae31b){const _0x324871=_0x1d528a;getClientsWithUuid(_0x3ae31b)[_0x324871(0x317)](_0x424deb=>{const _0x132ded=_0x324871;getSocket(_0x424deb['id'])[_0x132ded(0x17f)]();});}function cleanSettings(){const _0x1bca88=_0x1d528a;let _0x25a95b=settings;return settings[_0x1bca88(0x2b9)]&&settings[_0x1bca88(0x2b9)]!=''&&(_0x25a95b={..._0x25a95b,'telegramToken':'************'}),settings[_0x1bca88(0x1b7)]&&settings[_0x1bca88(0x1b7)]!=''&&(_0x25a95b={..._0x25a95b,'bbPassword':'************'}),settings['marketcapApi']&&settings[_0x1bca88(0x2d4)]!=''&&(_0x25a95b={..._0x25a95b,'marketcapApi':_0x1bca88(0x17c)}),(settings[_0x1bca88(0x1b7)]&&settings[_0x1bca88(0x1b7)]==_0x1bca88(0x165)||settings[_0x1bca88(0x2b9)]&&settings[_0x1bca88(0x2b9)]==_0x1bca88(0x165)||settings[_0x1bca88(0x2d4)]&&settings['marketcapApi']==_0x1bca88(0x165))&&(_0x25a95b={..._0x25a95b,'restored':{'password':settings[_0x1bca88(0x1b7)]==_0x1bca88(0x165),'telegram':settings['telegramToken']==_0x1bca88(0x165),'marketcap':settings[_0x1bca88(0x2d4)]==_0x1bca88(0x165)}}),_0x25a95b;}async function updateBB(_0x11dc5f){const _0xf987a6=_0x1d528a;await backupConfigFiles(),installingUpdate=!![],config[_0xf987a6(0x317)](_0x421ddb=>{const _0x38f10f=_0xf987a6;restartBot(_0x421ddb[_0x38f10f(0x20f)]);});if(_0x11dc5f==_0xf987a6(0x172))process[_0xf987a6(0x2e0)]({'update':!![],'environment':environment},_0x1ba9c3=>{});else _0x11dc5f==_0xf987a6(0x11e)&&process['send']({'reinstall':!![],'environment':environment},_0x4af9b9=>{});}function startBot(_0x277ccc,_0x52e76c,_0x3df1b9){const _0x3108b1=_0x1d528a;if(debugging)_0x277ccc[_0x3108b1(0x2af)]('-d');let _0x1ea9bc=![];const _0xf296b9=_0x277ccc[0x0];_0x52e76c={..._0x52e76c,'stdio':[_0x3108b1(0x1b3),_0x3108b1(0x1b3),'inherit','ipc']},pid[_0xf296b9]=childProcess[_0x3108b1(0x2fb)](botfile,_0x277ccc,_0x52e76c),pid[_0xf296b9]['on'](_0x3108b1(0x2b3),_0x5e4acc=>{const _0x5345bc=_0x3108b1;switch(Object[_0x5345bc(0x298)](_0x5e4acc)[0x0]){case _0x5345bc(0x2c9):updateBotName(_0xf296b9,_0x5e4acc[_0x5345bc(0x2c9)]);break;case _0x5345bc(0x206):updateBotManager();break;case'status':updateStatus(_0xf296b9,_0x5e4acc['status']);break;case _0x5345bc(0x1c3):updateLive(_0xf296b9,_0x5e4acc['live']);break;case'started':updateLive(_0xf296b9,_0x5e4acc[_0x5345bc(0x2d7)]),io['to'](_0xf296b9)[_0x5345bc(0x289)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x5345bc(0x177):_0x5e4acc[_0x5345bc(0x177)]=='restart'&&restartBot(_0xf296b9);_0x5e4acc[_0x5345bc(0x177)]==_0x5345bc(0x199)&&toggleBot(_0xf296b9,_0x5345bc(0x19a),_0x5345bc(0x147));break;case _0x5345bc(0x11a):sendTelegramBot(_0xf296b9,_0x5e4acc['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x5e4acc[_0x5345bc(0x1be)]);break;case'function':io['to'](_0xf296b9)['emit'](_0x5e4acc[_0x5345bc(0x20c)],_0x5e4acc[_0x5345bc(0x190)]);break;}}),pid[_0xf296b9]['on'](_0x3108b1(0x193),function(_0x5d5a57){if(_0x1ea9bc)return;_0x1ea9bc=!![],_0x3df1b9(_0x5d5a57);}),pid[_0xf296b9]['on'](_0x3108b1(0x116),async function(_0x31de82){const _0x11c91d=_0x3108b1;if(terminating)return;if(installingUpdate){logger[_0x11c91d(0x12e)](_0x11c91d(0x20e)),io[_0x11c91d(0x2e8)]();return;}if(_0x1ea9bc)return;_0x1ea9bc=!![],_0x3df1b9(null);const _0x10f58f=dbConfig[_0x11c91d(0x202)](_0x11c91d(0x106))['find']({'botID':_0xf296b9})['value']();_0x10f58f&&(_0x10f58f[_0x11c91d(0x17e)]==_0x11c91d(0x12a)||_0x10f58f[_0x11c91d(0x17e)]==_0x11c91d(0x155))&&(await sleep(0x3e8),updateLive(_0xf296b9,_0x11c91d(0x147)),_0x31de82==0x4d?logger[_0x11c91d(0x12e)](_0x11c91d(0x20d)+_0xf296b9):logger[_0x11c91d(0x31c)]('Restarting\x20Bot\x20'+_0xf296b9),startBot([_0xf296b9,userID],{'cwd':bbpath},function(_0x42366c){const _0x1b8314=_0x11c91d;if(_0x42366c)logger[_0x1b8314(0x31c)](_0x42366c);}));});}function stopBot(_0x115dc0){const _0x3179c6=_0x1d528a;getClientsWithBotID(_0x115dc0)['forEach'](_0x1dcbaa=>{const _0x52888f=_0x5715;getSocket(_0x1dcbaa['id'])[_0x52888f(0x285)](!![]),removeClient(_0x1dcbaa['id']);}),pid[_0x115dc0]&&(pid[_0x115dc0][_0x3179c6(0x199)](),pid[_0x115dc0]=null);}function stopAllBots(){const _0xd877cd=_0x1d528a;terminating=!![];const _0x3faafd=getEnabledBots();_0x3faafd[_0xd877cd(0x317)](_0x37e034=>{stopBot(_0x37e034['botID']);});}function restartBot(_0x1a43f3){const _0x2b0dad=_0x1d528a;if(pid[_0x1a43f3])pid[_0x1a43f3][_0x2b0dad(0x199)]();}function restartAllBots(){const _0x5d6281=getEnabledBots();_0x5d6281['forEach'](()=>{const _0x4d5863=_0x5715;broadcastToBots('function',_0x4d5863(0x109));});}function addBot(){const _0x4e4ebe=_0x1d528a;let _0x52baf9;for(let _0x38e03f=0x1;_0x38e03f<0x3e9;_0x38e03f++){_0x52baf9=_0x38e03f['toString']()['padStart'](0x3,'0');let _0x508c4e=config['find'](_0x1953d9=>_0x1953d9[_0x4e4ebe(0x20f)]==_0x52baf9);if(!_0x508c4e)break;}if(_0x52baf9==='1000'){logger[_0x4e4ebe(0x31c)](_0x4e4ebe(0x2e4));return;}logger['full'](_0x4e4ebe(0x31d)+_0x52baf9),dbConfig[_0x4e4ebe(0x202)](_0x4e4ebe(0x106))[_0x4e4ebe(0x2af)]({'botID':_0x52baf9,'botname':_0x4e4ebe(0x319)+_0x52baf9,'status':_0x4e4ebe(0x155),'live':''})[_0x4e4ebe(0x1de)](),startBot([_0x52baf9,userID],{'cwd':bbpath},function(_0x1c476d){const _0x14bc24=_0x4e4ebe;if(_0x1c476d)logger[_0x14bc24(0x31c)](_0x1c476d);}),config=getConfiguration(),io['to'](_0x4e4ebe(0x15c))[_0x4e4ebe(0x289)](_0x4e4ebe(0x106),config),broadcastToBots(_0x4e4ebe(0x106),JSON['stringify'](config));}function deleteBot(_0x5e1da1){const _0x50e4bd=_0x1d528a;getClientsWithBotID(_0x5e1da1)[_0x50e4bd(0x317)](_0x37fbc4=>{const _0x2a42b0=_0x50e4bd;getSocket(_0x37fbc4['id'])[_0x2a42b0(0x285)](!![]),removeClient(_0x37fbc4['id']);}),dbConfig[_0x50e4bd(0x202)](_0x50e4bd(0x106))[_0x50e4bd(0x1ae)]({'botID':_0x5e1da1})[_0x50e4bd(0x1de)](),logger[_0x50e4bd(0x31c)](_0x50e4bd(0x22b)+_0x5e1da1),stopBot(_0x5e1da1);try{if(fs[_0x50e4bd(0x133)](path['join'](configpath,_0x50e4bd(0x201)+_0x5e1da1+_0x50e4bd(0x267))))fs['unlinkSync'](path[_0x50e4bd(0x1e3)](configpath,_0x50e4bd(0x201)+_0x5e1da1+'-config.json'));if(fs['existsSync'](path['join'](configpath,_0x50e4bd(0x201)+_0x5e1da1+_0x50e4bd(0x16f))))fs[_0x50e4bd(0x308)](path[_0x50e4bd(0x1e3)](configpath,_0x50e4bd(0x201)+_0x5e1da1+_0x50e4bd(0x16f)));if(fs[_0x50e4bd(0x133)](path[_0x50e4bd(0x1e3)](configpath,_0x50e4bd(0x201)+_0x5e1da1+_0x50e4bd(0x131))))fs[_0x50e4bd(0x308)](path[_0x50e4bd(0x1e3)](configpath,'bot-'+_0x5e1da1+_0x50e4bd(0x131)));if(fs[_0x50e4bd(0x133)](path[_0x50e4bd(0x1e3)](configpath,_0x50e4bd(0x201)+_0x5e1da1+_0x50e4bd(0x280))))fs['unlinkSync'](path[_0x50e4bd(0x1e3)](configpath,'bot-'+_0x5e1da1+_0x50e4bd(0x280)));}catch(_0x39ba25){if(_0x39ba25)logger[_0x50e4bd(0x31c)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x39ba25);}config=getConfiguration(),io['to'](_0x50e4bd(0x15c))[_0x50e4bd(0x289)](_0x50e4bd(0x106),config),broadcastToBots(_0x50e4bd(0x106),JSON['stringify'](config));}function toggleBot(_0x4cffe6,_0x48ac06,_0x317ae2){const _0x39ff6f=_0x1d528a;dbConfig[_0x39ff6f(0x202)](_0x39ff6f(0x106))['find']({'botID':_0x4cffe6})[_0x39ff6f(0x134)]({'status':_0x48ac06})[_0x39ff6f(0x134)]({'live':_0x317ae2})[_0x39ff6f(0x1de)]();if(_0x48ac06==_0x39ff6f(0x12a)||_0x48ac06=='new')logger[_0x39ff6f(0x31c)](_0x39ff6f(0x197)+_0x4cffe6),startBot([_0x4cffe6,userID],{'cwd':bbpath},function(_0xe39b73){const _0x5aad11=_0x39ff6f;if(_0xe39b73)logger[_0x5aad11(0x31c)](_0xe39b73);});else(_0x48ac06==_0x39ff6f(0x19a)||_0x48ac06==_0x39ff6f(0x130))&&(logger[_0x39ff6f(0x31c)](_0x39ff6f(0x1bf)+_0x4cffe6),stopBot(_0x4cffe6));config=getConfiguration(),io['to'](_0x39ff6f(0x15c))[_0x39ff6f(0x289)](_0x39ff6f(0x106),config),broadcastToBots(_0x39ff6f(0x106),JSON[_0x39ff6f(0x208)](config));}function toggleStatus(_0x4f7e57){const _0x3a59e9=_0x1d528a;let _0x1d4338=dbConfig[_0x3a59e9(0x202)](_0x3a59e9(0x106))[_0x3a59e9(0x251)]({'botID':_0x4f7e57})['value'](),_0x1dfa48;if(_0x1d4338['status']===_0x3a59e9(0x12a))_0x1dfa48=_0x3a59e9(0x19a);else{if(_0x1d4338[_0x3a59e9(0x17e)]===_0x3a59e9(0x155))_0x1dfa48=_0x3a59e9(0x130);else{if(_0x1d4338[_0x3a59e9(0x17e)]==='new-disabled')_0x1dfa48=_0x3a59e9(0x155);else{if(_0x1d4338['status']===_0x3a59e9(0x19a))_0x1dfa48=_0x3a59e9(0x12a);}}}return _0x1dfa48;}function updateStatus(_0x3e4b96,_0x4e8590){const _0x25a969=_0x1d528a;dbConfig[_0x25a969(0x202)](_0x25a969(0x106))[_0x25a969(0x251)]({'botID':_0x3e4b96})['assign']({'status':_0x4e8590})[_0x25a969(0x1de)](),config=getConfiguration(),io['to'](_0x25a969(0x15c))[_0x25a969(0x289)](_0x25a969(0x106),config),broadcastToBots('bots',JSON[_0x25a969(0x208)](config));}function updateLive(_0x3829fd,_0x4e007d){const _0x4432ef=_0x1d528a;dbConfig[_0x4432ef(0x202)](_0x4432ef(0x106))['find']({'botID':_0x3829fd})[_0x4432ef(0x134)]({'live':_0x4e007d})[_0x4432ef(0x1de)](),config=getConfiguration(),io['to'](_0x4432ef(0x15c))[_0x4432ef(0x289)](_0x4432ef(0x106),config),broadcastToBots(_0x4432ef(0x106),JSON[_0x4432ef(0x208)](config));}function updateBotName(_0x2f0ac6,_0x153282){const _0x3f20f2=_0x1d528a;dbConfig[_0x3f20f2(0x202)](_0x3f20f2(0x106))[_0x3f20f2(0x251)]({'botID':_0x2f0ac6})[_0x3f20f2(0x134)]({'botname':_0x153282})[_0x3f20f2(0x1de)](),config=getConfiguration(),io['to'](_0x3f20f2(0x15c))[_0x3f20f2(0x289)](_0x3f20f2(0x106),config),broadcastToBots(_0x3f20f2(0x106),JSON[_0x3f20f2(0x208)](config));}function updateBotManager(){const _0x151d52=_0x1d528a;config=getConfiguration(),io['to'](_0x151d52(0x15c))[_0x151d52(0x289)]('bots',config),broadcastToBots(_0x151d52(0x106),JSON[_0x151d52(0x208)](config));}function toggleBotMode(_0x128015){const _0x325b7a=_0x1d528a;if(pid[_0x128015])pid[_0x128015][_0x325b7a(0x2e0)]({'function':_0x325b7a(0x237),'args':null});else{const _0x808877=configpath+_0x325b7a(0x201)+_0x128015+'-config.json',_0x2e0b06=fs[_0x325b7a(0x18d)](_0x808877),_0x41db10=JSON['parse'](_0x2e0b06),_0x298be6=_0x41db10['bot'][0x0][_0x325b7a(0x293)];_0x41db10[_0x325b7a(0x2a1)][0x0][_0x325b7a(0x293)]=!_0x298be6;const _0x46ea2d=JSON[_0x325b7a(0x208)](_0x41db10,null,0x2);fs[_0x325b7a(0x1d1)](_0x808877,_0x46ea2d),config=getConfiguration(),io['to']('botmanager')[_0x325b7a(0x289)](_0x325b7a(0x106),config),broadcastToBots(_0x325b7a(0x106),JSON['stringify'](config));}}function validateTelegram(_0x31e66b){const _0x331e29=_0x1d528a;if(_0x31e66b[_0x331e29(0x15f)]['username']!=settings[_0x331e29(0x2ea)]&&'@'+_0x31e66b[_0x331e29(0x15f)][_0x331e29(0x135)]!=settings['telegramUsername']||_0x31e66b[_0x331e29(0x15d)]['id']!=settings[_0x331e29(0x256)])return sendTelegram(_0x31e66b[_0x331e29(0x15d)]['id'],_0x331e29(0x1d4),{'parse_mode':_0x331e29(0x2bf)}),![];return!![];}async function initTelegram(){const _0x4f18dc=_0x1d528a;if(tgBot)tgBot[_0x4f18dc(0x177)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x4f18dc(0x2b9)]);let _0x42fde9=_0x4f18dc(0x204);_0x42fde9+='\x0a',_0x42fde9+=_0x4f18dc(0x1d5),_0x42fde9+=_0x4f18dc(0x2e1),_0x42fde9+=_0x4f18dc(0x305),_0x42fde9+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x42fde9+=_0x4f18dc(0x2da),_0x42fde9+=_0x4f18dc(0x27a),_0x42fde9+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x42fde9+=_0x4f18dc(0x315),_0x42fde9+=_0x4f18dc(0x239),_0x42fde9+=_0x4f18dc(0x140),_0x42fde9+=_0x4f18dc(0x1e0),_0x42fde9+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x42fde9+=_0x4f18dc(0x29b),_0x42fde9+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x1056b0='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1056b0+='\x0a',_0x1056b0+=_0x42fde9,tgBot[_0x4f18dc(0x137)]((_0xfbc3ad,_0x9f16b4)=>{const _0x229417=_0x4f18dc;logger[_0x229417(0x159)](getTimeStamp()+_0x229417(0x12b)),logger[_0x229417(0x12e)](_0x229417(0x1ed),_0xfbc3ad);}),tgBot[_0x4f18dc(0x1f0)](async(_0x5f892b,_0x4fbbf8)=>{const _0x1463a0=_0x4f18dc;if(!(!settings[_0x1463a0(0x256)]&&_0x5f892b[_0x1463a0(0x172)][_0x1463a0(0x2b3)][_0x1463a0(0x225)]==_0x1463a0(0x25f))){if(!validateTelegram(_0x5f892b))return;}_0x4fbbf8();}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x2b0),async _0x1f7ca5=>{const _0x493b0c=_0x4f18dc;if(!settings[_0x493b0c(0x256)])updateSetting(_0x493b0c(0x256),_0x1f7ca5[_0x493b0c(0x15d)]['id']);updateSetting(_0x493b0c(0x120),!![]);if(!validateTelegram(_0x1f7ca5))return;await sendTelegram(_0x1f7ca5[_0x493b0c(0x15d)]['id'],_0x1056b0);}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x309),async _0x51f1dd=>{const _0x2e02f4=_0x4f18dc;updateSetting(_0x2e02f4(0x120),!![]),await sendTelegram(_0x51f1dd['chat']['id'],_0x2e02f4(0x104));}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x2d1),async _0x123c0e=>{const _0x3188cb=_0x4f18dc;await sendTelegram(_0x123c0e[_0x3188cb(0x15d)]['id'],_0x3188cb(0x19b)),updateSetting(_0x3188cb(0x120),![]);}),tgBot[_0x4f18dc(0x2cb)]('config',async _0x512dc0=>{const _0x30d1a2=_0x4f18dc,_0x14276b=Markup[_0x30d1a2(0x212)]([Markup[_0x30d1a2(0x186)][_0x30d1a2(0x20a)]('Orders',_0x30d1a2(0x1c5)),Markup[_0x30d1a2(0x186)][_0x30d1a2(0x20a)](_0x30d1a2(0x181),_0x30d1a2(0x2c4)),Markup['button'][_0x30d1a2(0x20a)](_0x30d1a2(0x287),_0x30d1a2(0x13a))]);_0x512dc0[_0x30d1a2(0x30e)](_0x30d1a2(0x2ec),_0x14276b);}),tgBot[_0x4f18dc(0x24b)](_0x4f18dc(0x1c5),async _0x5c9b40=>{const _0x173d6d=_0x4f18dc;_0x5c9b40[_0x173d6d(0x1fe)](),updateSetting(_0x173d6d(0x320),_0x173d6d(0x18b)),updateSetting(_0x173d6d(0x120),!![]),await sendTelegram(_0x5c9b40[_0x173d6d(0x15d)]['id'],_0x173d6d(0x2e5));}),tgBot[_0x4f18dc(0x24b)]('config_alerts',async _0x3d5ea6=>{const _0x5b0dc3=_0x4f18dc;_0x3d5ea6[_0x5b0dc3(0x1fe)](),updateSetting(_0x5b0dc3(0x320),_0x5b0dc3(0x213)),updateSetting(_0x5b0dc3(0x120),!![]),await sendTelegram(_0x3d5ea6[_0x5b0dc3(0x15d)]['id'],_0x5b0dc3(0x18f));}),tgBot[_0x4f18dc(0x24b)](_0x4f18dc(0x13a),async _0x345acc=>{const _0x1a51d9=_0x4f18dc;_0x345acc[_0x1a51d9(0x1fe)](),updateSetting('telegramEvents',_0x1a51d9(0x122)),updateSetting(_0x1a51d9(0x120),!![]),await sendTelegram(_0x345acc['chat']['id'],_0x1a51d9(0x141));}),tgBot[_0x4f18dc(0x2cb)]('status',async _0x7f327e=>{const _0x27e8b1=_0x4f18dc,_0x1eeadc=getBotsWithMode();let _0x2b38e2=_0x27e8b1(0x27e);config[_0x27e8b1(0x317)](_0x1785c9=>{const _0x5162b7=_0x27e8b1,_0x35a14b=_0x1eeadc[_0x5162b7(0x251)](_0x2abad1=>_0x2abad1[_0x5162b7(0x20f)]==_0x1785c9[_0x5162b7(0x20f)])[_0x5162b7(0x2bb)];_0x2b38e2+='Bot\x20'+_0x1785c9[_0x5162b7(0x20f)]+':\x20'+_0x1785c9['status']+'\x20|\x20'+_0x35a14b+_0x5162b7(0x10d)+_0x1785c9[_0x5162b7(0x1c3)]+'\x0a';}),_0x2b38e2+='\x0a',_0x2b38e2+=_0x27e8b1(0x282),_0x2b38e2+=!settings[_0x27e8b1(0x120)]?_0x27e8b1(0x24c):'Notifications\x20enabled\x0a',_0x2b38e2+=settings[_0x27e8b1(0x120)]?settings[_0x27e8b1(0x320)]==_0x27e8b1(0x122)?_0x27e8b1(0x294):_0x27e8b1(0x1d9)+settings[_0x27e8b1(0x320)]+_0x27e8b1(0x169):'',await sendTelegram(_0x7f327e[_0x27e8b1(0x15d)]['id'],_0x2b38e2,{'parse_mode':_0x27e8b1(0x2bf)});}),tgBot[_0x4f18dc(0x2cb)]('restart',async _0x57b158=>{const _0x38f728=_0x4f18dc,_0x2df803=getEnabledBots();if(_0x2df803[_0x38f728(0x30c)]==0x0)await sendTelegram(_0x57b158[_0x38f728(0x15d)]['id'],_0x38f728(0x233));else{if(_0x2df803['length']>0x1)_0x2df803[_0x38f728(0x2af)]({'botID':'all'});let _0x134841=[],_0x5083be=[];const _0x244c9c=_0x2df803['length']%0x4==0x0||_0x2df803[_0x38f728(0x30c)]%0x4==0x3||_0x2df803['length']%0x3==0x1?0x4:0x3;let _0x3bad66=0x0;_0x2df803[_0x38f728(0x317)]((_0x386d8d,_0x11790c)=>{const _0x271899=_0x38f728;if(_0x11790c%_0x244c9c==0x0)_0x5083be=[];_0x5083be[_0x271899(0x2af)](Markup[_0x271899(0x186)][_0x271899(0x20a)](_0x386d8d[_0x271899(0x20f)]=='all'?'All\x20bots':_0x271899(0x319)+_0x386d8d['botID'],_0x271899(0x321)+_0x386d8d[_0x271899(0x20f)])),_0x11790c%_0x244c9c==0x0&&(_0x134841[_0x3bad66]=_0x5083be,_0x3bad66++);});const _0x5a3632=Markup[_0x38f728(0x212)](_0x134841);_0x57b158[_0x38f728(0x30e)](_0x38f728(0x195),_0x5a3632);}}),tgBot['action'](/restart_(.+)/,async _0x193b90=>{const _0xdd9938=_0x4f18dc,_0x341926=_0x193b90[_0xdd9938(0x262)][0x1];_0x193b90[_0xdd9938(0x1fe)](),_0x341926=='all'?config[_0xdd9938(0x317)](_0x466300=>{const _0x1cb9df=_0xdd9938;restartBot(_0x466300[_0x1cb9df(0x20f)]);}):restartBot(_0x341926);}),tgBot[_0x4f18dc(0x2cb)]('on',async _0x69d890=>{const _0x25f255=_0x4f18dc,_0x2972c0=getDisabledBots();if(_0x2972c0['length']==0x0)await sendTelegram(_0x69d890['chat']['id'],_0x25f255(0x23f));else{if(_0x2972c0[_0x25f255(0x30c)]>0x1)_0x2972c0[_0x25f255(0x2af)]({'botID':_0x25f255(0x122)});let _0x142ade=[],_0x3af65b=[];const _0x3679a2=_0x2972c0[_0x25f255(0x30c)]%0x4==0x0||_0x2972c0[_0x25f255(0x30c)]%0x4==0x3||_0x2972c0[_0x25f255(0x30c)]%0x3==0x1?0x4:0x3;let _0x17e9d9=0x0;_0x2972c0['forEach']((_0x165a6e,_0x1fbbcd)=>{const _0x4b8b79=_0x25f255;if(_0x1fbbcd%_0x3679a2==0x0)_0x3af65b=[];_0x3af65b[_0x4b8b79(0x2af)](Markup['button']['callback'](_0x165a6e[_0x4b8b79(0x20f)]==_0x4b8b79(0x122)?_0x4b8b79(0x316):_0x4b8b79(0x319)+_0x165a6e['botID'],_0x4b8b79(0x302)+_0x165a6e[_0x4b8b79(0x20f)])),_0x1fbbcd%_0x3679a2==0x0&&(_0x142ade[_0x17e9d9]=_0x3af65b,_0x17e9d9++);});const _0x201313=Markup[_0x25f255(0x212)](_0x142ade);_0x69d890[_0x25f255(0x30e)](_0x25f255(0x240),_0x201313);}}),tgBot[_0x4f18dc(0x24b)](/on_(.+)/,async _0x172659=>{const _0x374829=_0x4f18dc,_0x59601c=_0x172659[_0x374829(0x262)][0x1];_0x172659[_0x374829(0x1fe)]();if(_0x59601c==_0x374829(0x122)){const _0x4d0ae3=getDisabledBots();await sendTelegram(_0x172659[_0x374829(0x15d)]['id'],_0x374829(0x250)),_0x4d0ae3['forEach'](_0x262ddc=>{const _0xb216dd=_0x374829;if(_0x262ddc[_0xb216dd(0x20f)]!=_0xb216dd(0x122))toggleBot(_0x262ddc['botID'],toggleStatus(_0x262ddc[_0xb216dd(0x20f)]),_0xb216dd(0x147));});}else await sendTelegram(_0x172659[_0x374829(0x15d)]['id'],_0x374829(0x1f5)+_0x59601c),toggleBot(_0x59601c,toggleStatus(_0x59601c),_0x374829(0x147));}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x19e),async _0x54afbc=>{const _0x41945e=_0x4f18dc,_0x35d693=getEnabledBots();if(_0x35d693['length']==0x0)await sendTelegram(_0x54afbc[_0x41945e(0x15d)]['id'],_0x41945e(0x233));else{if(_0x35d693[_0x41945e(0x30c)]>0x1)_0x35d693[_0x41945e(0x2af)]({'botID':_0x41945e(0x122)});let _0x3f5384=[],_0x46dad8=[];const _0x38f641=_0x35d693['length']%0x4==0x0||_0x35d693['length']%0x4==0x3||_0x35d693[_0x41945e(0x30c)]%0x3==0x1?0x4:0x3;let _0x51019c=0x0;_0x35d693[_0x41945e(0x317)]((_0x2885fa,_0x2ee0b7)=>{const _0xc0cc85=_0x41945e;if(_0x2ee0b7%_0x38f641==0x0)_0x46dad8=[];_0x46dad8['push'](Markup['button'][_0xc0cc85(0x20a)](_0x2885fa[_0xc0cc85(0x20f)]==_0xc0cc85(0x122)?'All\x20bots':_0xc0cc85(0x319)+_0x2885fa[_0xc0cc85(0x20f)],_0xc0cc85(0x284)+_0x2885fa[_0xc0cc85(0x20f)])),_0x2ee0b7%_0x38f641==0x0&&(_0x3f5384[_0x51019c]=_0x46dad8,_0x51019c++);});const _0x4e8f1a=Markup['inlineKeyboard'](_0x3f5384);_0x54afbc[_0x41945e(0x30e)](_0x41945e(0x2f5),_0x4e8f1a);}}),tgBot['action'](/off_(.+)/,async _0x33bf8c=>{const _0x4b9595=_0x4f18dc,_0x17b5a2=_0x33bf8c['match'][0x1];_0x33bf8c['editMessageReplyMarkup']();if(_0x17b5a2==_0x4b9595(0x122)){const _0x48bef5=getEnabledBots();await sendTelegram(_0x33bf8c[_0x4b9595(0x15d)]['id'],_0x4b9595(0x292)),_0x48bef5[_0x4b9595(0x317)](_0x322f76=>{const _0x10236b=_0x4b9595;if(_0x322f76[_0x10236b(0x20f)]!=_0x10236b(0x122))toggleBot(_0x322f76['botID'],toggleStatus(_0x322f76[_0x10236b(0x20f)]),_0x10236b(0x147));});}else await sendTelegram(_0x33bf8c[_0x4b9595(0x15d)]['id'],_0x4b9595(0x1a3)+_0x17b5a2),toggleBot(_0x17b5a2,toggleStatus(_0x17b5a2),_0x4b9595(0x147));}),tgBot[_0x4f18dc(0x2cb)]('metrics',async _0x3cd7d4=>{const _0x3f1aae=_0x4f18dc,_0x3c576f=getEnabledBots();if(_0x3c576f[_0x3f1aae(0x30c)]==0x0)await sendTelegram(_0x3cd7d4[_0x3f1aae(0x15d)]['id'],_0x3f1aae(0x233));else{if(_0x3c576f['length']>0x1){let _0x2633f8=[],_0x2e57da=[];const _0x2b5bbe=_0x3c576f['length']%0x4==0x0||_0x3c576f[_0x3f1aae(0x30c)]%0x4==0x3||_0x3c576f['length']%0x3==0x1?0x4:0x3;let _0x342be6=0x0;_0x3c576f[_0x3f1aae(0x317)]((_0x48c220,_0xa7b1b1)=>{const _0xca9b1b=_0x3f1aae;if(_0xa7b1b1%_0x2b5bbe==0x0)_0x2e57da=[];_0x2e57da['push'](Markup[_0xca9b1b(0x186)]['callback'](_0xca9b1b(0x319)+_0x48c220[_0xca9b1b(0x20f)],_0xca9b1b(0x17b)+_0x48c220[_0xca9b1b(0x20f)])),_0xa7b1b1%_0x2b5bbe==0x0&&(_0x2633f8[_0x342be6]=_0x2e57da,_0x342be6++);});const _0x3ea1d6=Markup[_0x3f1aae(0x212)](_0x2633f8);_0x3cd7d4[_0x3f1aae(0x30e)](_0x3f1aae(0x23e),_0x3ea1d6);}else{const _0x102fb0=_0x3c576f[0x0]['botID'];if(pid[_0x102fb0])pid[_0x102fb0][_0x3f1aae(0x2e0)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x566270=>{const _0x1727fa=_0x4f18dc,_0x24e072=_0x566270[_0x1727fa(0x262)][0x1];_0x566270[_0x1727fa(0x1fe)]();if(pid[_0x24e072])pid[_0x24e072][_0x1727fa(0x2e0)]({'function':_0x1727fa(0x18a),'args':null});}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x15b),async _0x1c4680=>{const _0x32d736=_0x4f18dc,_0x46bcbf=getEnabledBots();if(_0x46bcbf[_0x32d736(0x30c)]==0x0)await sendTelegram(_0x1c4680[_0x32d736(0x15d)]['id'],_0x32d736(0x233));else{if(_0x46bcbf[_0x32d736(0x30c)]>0x1){let _0x461292=[],_0x25ebb3=[];const _0x2c838f=_0x46bcbf[_0x32d736(0x30c)]%0x4==0x0||_0x46bcbf[_0x32d736(0x30c)]%0x4==0x3||_0x46bcbf[_0x32d736(0x30c)]%0x3==0x1?0x4:0x3;let _0x16c538=0x0;_0x46bcbf[_0x32d736(0x317)]((_0x40a6d4,_0x5b939f)=>{const _0x1bbab4=_0x32d736;if(_0x5b939f%_0x2c838f==0x0)_0x25ebb3=[];_0x25ebb3[_0x1bbab4(0x2af)](Markup[_0x1bbab4(0x186)][_0x1bbab4(0x20a)](_0x1bbab4(0x319)+_0x40a6d4[_0x1bbab4(0x20f)],'portfolio_'+_0x40a6d4[_0x1bbab4(0x20f)])),_0x5b939f%_0x2c838f==0x0&&(_0x461292[_0x16c538]=_0x25ebb3,_0x16c538++);});const _0x2e4340=Markup[_0x32d736(0x212)](_0x461292);_0x1c4680[_0x32d736(0x30e)](_0x32d736(0x166),_0x2e4340);}else{const _0x498123=_0x46bcbf[0x0][_0x32d736(0x20f)];if(pid[_0x498123])pid[_0x498123]['send']({'function':_0x32d736(0x148),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x3d1750=>{const _0x23a4d4=_0x4f18dc,_0x379c98=_0x3d1750[_0x23a4d4(0x262)][0x1];_0x3d1750[_0x23a4d4(0x1fe)]();if(pid[_0x379c98])pid[_0x379c98][_0x23a4d4(0x2e0)]({'function':_0x23a4d4(0x148),'args':null});}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x172),async _0x287f1a=>{const _0x5af40c=_0x4f18dc;await getMessages();if(!updateAvailable)await sendTelegram(_0x287f1a['chat']['id'],_0x5af40c(0x234));else{if(!validInstallation)await sendTelegram(_0x287f1a[_0x5af40c(0x15d)]['id'],_0x5af40c(0x2e2));else{const _0x22884f=Markup[_0x5af40c(0x212)]([Markup['button'][_0x5af40c(0x20a)](_0x5af40c(0x2dc),_0x5af40c(0x1da)),Markup['button']['callback']('No',_0x5af40c(0x2cc))]);_0x287f1a['reply'](_0x5af40c(0x216),_0x22884f);}}}),tgBot[_0x4f18dc(0x24b)](/update_(.+)/,async _0x4eb81f=>{const _0x373f4a=_0x4f18dc,_0xd500e3=_0x4eb81f[_0x373f4a(0x262)][0x1];_0x4eb81f[_0x373f4a(0x1fe)](),_0xd500e3==_0x373f4a(0x145)&&(await sendTelegram(_0x4eb81f['chat']['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB('update')),_0xd500e3=='no'&&await sendTelegram(_0x4eb81f[_0x373f4a(0x15d)]['id'],_0x373f4a(0x11c));}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x11e),async _0x3eb227=>{const _0x28edc9=_0x4f18dc;if(!validInstallation)await sendTelegram(_0x3eb227[_0x28edc9(0x15d)]['id'],_0x28edc9(0x128));else{const _0x189fca=Markup[_0x28edc9(0x212)]([Markup[_0x28edc9(0x186)][_0x28edc9(0x20a)](_0x28edc9(0x2dc),'reinstall_yes'),Markup[_0x28edc9(0x186)][_0x28edc9(0x20a)]('No',_0x28edc9(0x156))]);_0x3eb227[_0x28edc9(0x30e)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x189fca);}}),tgBot['action'](/reinstall_(.+)/,async _0x1e46d3=>{const _0x2f3c6e=_0x4f18dc,_0x175b28=_0x1e46d3[_0x2f3c6e(0x262)][0x1];_0x1e46d3['editMessageReplyMarkup'](),_0x175b28==_0x2f3c6e(0x145)&&(await sendTelegram(_0x1e46d3[_0x2f3c6e(0x15d)]['id'],_0x2f3c6e(0x1b0)),updateBB('reinstall')),_0x175b28=='no'&&await sendTelegram(_0x1e46d3['chat']['id'],_0x2f3c6e(0x198));}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x2f6),async _0x4e6726=>{const _0x46eea4=_0x4f18dc,_0x283a88=getBotsWithMode();if(_0x283a88[_0x46eea4(0x30c)]==0x0)await sendTelegram(_0x4e6726[_0x46eea4(0x15d)]['id'],_0x46eea4(0x233));else{let _0x49b24e=[],_0x22f0f3=[];const _0x5e7114=0x2;let _0x1d62e7=0x0;_0x283a88['forEach']((_0x47d184,_0x4bcc14)=>{const _0x3580a5=_0x46eea4;if(_0x4bcc14%_0x5e7114==0x0)_0x22f0f3=[];_0x22f0f3[_0x3580a5(0x2af)](Markup['button'][_0x3580a5(0x20a)](_0x3580a5(0x319)+_0x47d184[_0x3580a5(0x20f)]+'\x20('+_0x47d184['mode']+')',_0x3580a5(0x2e3)+_0x47d184[_0x3580a5(0x20f)])),_0x4bcc14%_0x5e7114==0x0&&(_0x49b24e[_0x1d62e7]=_0x22f0f3,_0x1d62e7++);});const _0x8efc9b=Markup[_0x46eea4(0x212)](_0x49b24e);_0x4e6726[_0x46eea4(0x30e)](_0x46eea4(0x10a),_0x8efc9b);}}),tgBot[_0x4f18dc(0x24b)](/toggle_(.+)/,async _0x32e11b=>{const _0x130219=_0x4f18dc,_0x396579=_0x32e11b[_0x130219(0x262)][0x1];_0x32e11b[_0x130219(0x1fe)]();const _0x1b4fce=getBotsWithMode(),_0x5578ec=_0x1b4fce['find'](_0x148f4c=>_0x148f4c[_0x130219(0x20f)]==_0x396579),_0x328da5=_0x5578ec['mode']=='auto'?_0x130219(0x2d9):'auto';await sendTelegram(_0x32e11b['chat']['id'],_0x130219(0x196)+_0x396579+_0x130219(0x21d)+_0x328da5+_0x130219(0x24a)),toggleBotMode(_0x396579);}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x271),async _0x3064f7=>{const _0x18e782=_0x4f18dc;let _0x5c2d63='';config[_0x18e782(0x317)](_0x3e9106=>{const _0xdb6282=_0x18e782;_0x5c2d63+='Bot\x20'+_0x3e9106[_0xdb6282(0x20f)]+':\x20'+_0x3e9106[_0xdb6282(0x2c9)]+'\x0a';}),await sendTelegram(_0x3064f7['chat']['id'],_0x5c2d63,{'parse_mode':_0x18e782(0x2bf)});}),tgBot[_0x4f18dc(0x2cb)](_0x4f18dc(0x1df),async _0xc13a27=>{await sendTelegram(_0xc13a27['chat']['id'],_0x42fde9);}),process[_0x4f18dc(0x241)](_0x4f18dc(0x1c9),()=>tgBot[_0x4f18dc(0x177)](_0x4f18dc(0x1c9))),process[_0x4f18dc(0x241)](_0x4f18dc(0x25d),()=>tgBot[_0x4f18dc(0x177)](_0x4f18dc(0x25d))),tgBot[_0x4f18dc(0x30d)]();}}function disableTelegram(){const _0x1c244a=_0x1d528a;tgBot&&tgBot[_0x1c244a(0x177)]();}async function sendTelegram(_0x2dc0be,_0x40965a,_0x3671f0){const _0x13103d=_0x1d528a;_0x3671f0={..._0x3671f0,'disable_web_page_preview':!![]};try{await tgBot[_0x13103d(0x11a)][_0x13103d(0x1f3)](_0x2dc0be,_0x40965a,_0x3671f0);}catch(_0x2e9d65){console['log'](_0x13103d(0x1e5),_0x2e9d65);}}async function sendTelegramBot(_0xcea806,_0x59aecb){const _0x44e500=_0x1d528a;if(settings[_0x44e500(0x120)]){if(settings[_0x44e500(0x320)]==_0x44e500(0x122)||(_0x59aecb[_0x44e500(0x150)]==_0x44e500(0x193)||_0x59aecb['type']=='warning'||_0x59aecb[_0x44e500(0x150)]==_0x44e500(0x2a4))&&settings['telegramEvents']=='alerts'||_0x59aecb[_0x44e500(0x150)]=='order'&&settings[_0x44e500(0x320)]==_0x44e500(0x18b)){if(tgBot&&settings[_0x44e500(0x256)]){if(_0x59aecb[_0x44e500(0x2dd)])await sendTelegram(settings[_0x44e500(0x256)],_0x59aecb['botname']+_0x44e500(0x1dc)+_0x59aecb[_0x44e500(0x2a9)]);else await sendTelegram(settings['telegramChatId'],_0x44e500(0x319)+_0xcea806+'\x20>\x20'+_0x59aecb[_0x44e500(0x2a9)]);}}}}async function sendTelegramMsg(_0x17cef6,_0x2a6458=_0x1d528a(0x2bf)){const _0x368a33=_0x1d528a;return settings[_0x368a33(0x120)]&&tgBot&&settings[_0x368a33(0x256)]?(await sendTelegram(settings[_0x368a33(0x256)],_0x17cef6,{'parse_mode':_0x2a6458}),!![]):![];}function getDeviceWithIp(_0x3f64d9){const _0xc078c0=_0x1d528a;return devices[_0xc078c0(0x251)](_0x133c1e=>_0x133c1e['ip']===_0x3f64d9);}async function temporaryAccess2FA(_0x5cf664,_0x2d6add){const _0x20522a=_0x1d528a;let _0x2b94b8=new Date(),_0x1e2492=![];if(lastIpApproval){if(_0x2b94b8-lastIpApproval<0x1388)_0x1e2492=!![];}lastIpApproval=new Date();if(_0x1e2492)return;if(tgBot&&settings[_0x20522a(0x256)]){const _0xf58ecc=uuidRandom();tmpStorage[_0xf58ecc]={'uuid':_0x5cf664,'externalip':_0x2d6add};const _0x14ff76=Markup[_0x20522a(0x212)]([Markup[_0x20522a(0x186)][_0x20522a(0x20a)](_0x20522a(0x2df),'tempaccess_5_'+_0xf58ecc),Markup['button']['callback']('15\x20min',_0x20522a(0x1a6)+_0xf58ecc),Markup[_0x20522a(0x186)]['callback'](_0x20522a(0x18c),'tempaccess_30_'+_0xf58ecc),Markup['button']['callback']('reject',_0x20522a(0x26c)+_0xf58ecc)]);await sendTelegram(settings['telegramChatId'],_0x20522a(0x300)+normalizeIP(_0x2d6add)[_0x20522a(0x221)]+'\x20?',_0x14ff76),tgBot[_0x20522a(0x24b)](/tempaccess_(.+)_(.+)/,async _0x5d1252=>{const _0x35aa01=_0x20522a,_0x438c84=_0x5d1252[_0x35aa01(0x262)][0x1],_0x4ec830=_0x5d1252[_0x35aa01(0x262)][0x2],{uuid:_0x55a4b7,externalip:_0x3647bd}=tmpStorage[_0x4ec830];delete tmpStorage[_0x4ec830],_0x5d1252['editMessageReplyMarkup'](),devices[_0x55a4b7]['telegramIpApproval']={'clientip':_0x3647bd,'timestamp':new Date()['getTime'](),'expiry':_0x438c84},_0x438c84!=_0x35aa01(0x28b)?(await sendTelegram(_0x5d1252[_0x35aa01(0x15d)]['id'],_0x35aa01(0x110)+_0x438c84+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x55a4b7)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x5d1252[_0x35aa01(0x15d)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x55a4b7)[_0x35aa01(0x289)](_0x35aa01(0x17e),{'access':{'allow':![],'reason':_0x35aa01(0x14b),'token':null}}));});}}async function loginAccess2FA(_0x39e529,_0x1e631a){const _0x4f64a6=_0x1d528a;if(tgBot&&settings[_0x4f64a6(0x256)]){const _0x11047e=uuidRandom();tmpStorage[_0x11047e]={'uuid':_0x39e529,'externalip':_0x1e631a};const _0x753cdf=Markup[_0x4f64a6(0x212)]([Markup['button'][_0x4f64a6(0x20a)](_0x4f64a6(0x232),_0x4f64a6(0x175)+loginExpiry+'_'+_0x11047e),Markup['button'][_0x4f64a6(0x20a)](_0x4f64a6(0x28b),_0x4f64a6(0x259)+_0x11047e)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x1e631a)[_0x4f64a6(0x221)]+'\x20?',_0x753cdf),tgBot[_0x4f64a6(0x24b)](/login2fa_(.+)_(.+)/,async _0x406c1e=>{const _0x14d0d8=_0x4f64a6,_0x3386e8=_0x406c1e['match'][0x1],_0x45e2dc=_0x406c1e['match'][0x2],{uuid:_0x48d849,externalip:_0x4f1c39}=tmpStorage[_0x45e2dc];delete tmpStorage[_0x45e2dc],_0x406c1e[_0x14d0d8(0x1fe)](),devices[_0x48d849]['telegram2FaApproval']={'clientip':_0x4f1c39,'timestamp':new Date()[_0x14d0d8(0x29d)](),'expiry':_0x3386e8},_0x3386e8!=_0x14d0d8(0x28b)?(await sendTelegram(_0x406c1e[_0x14d0d8(0x15d)]['id'],_0x14d0d8(0x2c5),{'parse_mode':_0x14d0d8(0x2bf)}),io['to'](_0x48d849)[_0x14d0d8(0x289)](_0x14d0d8(0x17e),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x406c1e[_0x14d0d8(0x15d)]['id'],_0x14d0d8(0x138)),io['to'](_0x48d849)[_0x14d0d8(0x289)](_0x14d0d8(0x17e),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5ee722=_0x1d528a;return dbConfig[_0x5ee722(0x202)](_0x5ee722(0x106))[_0x5ee722(0x1b6)](_0x5ee722(0x20f))[_0x5ee722(0x1a5)]({'status':_0x5ee722(0x12a)})[_0x5ee722(0x12c)]()||[];}function getDisabledBots(){const _0x63da9e=_0x1d528a;return dbConfig[_0x63da9e(0x202)](_0x63da9e(0x106))[_0x63da9e(0x1b6)](_0x63da9e(0x20f))[_0x63da9e(0x1a5)]({'status':_0x63da9e(0x19a)})['value']()||[];}function getBotAttributes(_0x5965d9){const _0x37caa1=_0x1d528a;let _0x4a961f={};const _0x47e0f7=configpath+'bot-'+_0x5965d9+_0x37caa1(0x267),_0x4284cc=fs['existsSync'](_0x47e0f7);if(_0x4284cc){const _0x4789b6=fs[_0x37caa1(0x18d)](_0x47e0f7);try{const _0x4ab289=JSON[_0x37caa1(0x2a8)](_0x4789b6),_0x11cd58=_0x4ab289?_0x4ab289['bot'][0x0][_0x37caa1(0x293)]:![];_0x4a961f[_0x37caa1(0x2bb)]=_0x11cd58?'auto':_0x37caa1(0x2d9),_0x4a961f[_0x37caa1(0x2c9)]=_0x4ab289?_0x4ab289[_0x37caa1(0x2a1)][0x0][_0x37caa1(0x2c9)]:_0x37caa1(0x319)+_0x5965d9;}catch(_0x3003a7){_0x4a961f[_0x37caa1(0x2bb)]=_0x37caa1(0x2d9),_0x4a961f['botname']='Bot\x20'+_0x5965d9;}}else _0x4a961f[_0x37caa1(0x2bb)]=_0x37caa1(0x2d9),_0x4a961f[_0x37caa1(0x2c9)]=_0x37caa1(0x319)+_0x5965d9;return _0x4a961f;}function getBotsWithMode(){const _0x56b8e2=_0x1d528a,_0x97ef2=dbConfig[_0x56b8e2(0x202)]('bots')['sortBy'](_0x56b8e2(0x20f))[_0x56b8e2(0x12c)]()||[];return _0x97ef2[_0x56b8e2(0x317)](_0x1a5aaa=>{const _0x45be0b=_0x56b8e2;let _0x173643=getBotAttributes(_0x1a5aaa['botID']);_0x1a5aaa[_0x45be0b(0x2bb)]=_0x173643['mode'];}),_0x97ef2;}function getBotExchanges(){const _0x13840d=_0x1d528a;let _0x431b82=[];const _0xbf1105=dbConfig['get'](_0x13840d(0x106))['sortBy']('botID')['value']()||[];_0xbf1105[_0x13840d(0x317)](_0x399d47=>{const _0x1899e8=_0x13840d;if(_0x399d47['status']=='enabled'){const _0x203ff4=configpath+_0x1899e8(0x201)+_0x399d47[_0x1899e8(0x20f)]+_0x1899e8(0x267),_0x326374=fs[_0x1899e8(0x133)](_0x203ff4);let _0xf5bc29;if(_0x326374){const _0x2ee4cb=fs[_0x1899e8(0x18d)](_0x203ff4);try{const _0x5f33a5=JSON[_0x1899e8(0x2a8)](_0x2ee4cb);_0xf5bc29=_0x5f33a5?_0x5f33a5['bot'][0x0][_0x1899e8(0x1c7)]:null;}catch(_0x377e5c){}}if(_0xf5bc29)_0x431b82[_0x1899e8(0x2af)](_0xf5bc29);}});const _0x184fd6=[...new Set(_0x431b82)][_0x13840d(0x13e)]();return _0x184fd6;}async function initUser(){const _0x5e0b8d=_0x1d528a;if(!settings[_0x5e0b8d(0x11f)]){const _0x364f45=uuidRandom();mixpanel[_0x5e0b8d(0x185)](_0x364f45),updateSetting(_0x5e0b8d(0x11f),_0x364f45);}}async function initSecure(){const _0x14a380=_0x1d528a;let _0x103edd=getSecure();if(!_0x103edd[_0x14a380(0x16d)](_0x14a380(0x180))){let _0x30f8c2=await generateKeys();_0x103edd['publicKey']=_0x30f8c2[_0x14a380(0x1b2)],_0x103edd[_0x14a380(0x1bc)]=_0x30f8c2['privateKey'],_0x103edd['secret']=crypto[_0x14a380(0x21f)](0x20)['toString'](_0x14a380(0x25e));;storeSecure(_0x103edd);}}function getSettings(){const _0x126943=_0x1d528a;return dbSettings[_0x126943(0x202)](_0x126943(0x1a7))['value']()||{};}function getSecure(){const _0x4cdd3d=_0x1d528a;return dbSecure['get'](_0x4cdd3d(0x26a))['value']()||{};}function getBlacklist(){const _0x120a0d=_0x1d528a;return dbSecure[_0x120a0d(0x202)]('blacklist')['value']()||[];}function broadcastToBots(_0x339ea7,_0x27dc86){const _0x31fb4f=_0x1d528a;config[_0x31fb4f(0x317)](_0x36daa3=>{const _0x2c726a=_0x31fb4f;if(_0x36daa3[_0x2c726a(0x17e)]==_0x2c726a(0x12a)&&_0x36daa3[_0x2c726a(0x1c3)]==_0x2c726a(0x224)||_0x36daa3['status']==_0x2c726a(0x155)&&_0x36daa3['live']==_0x2c726a(0x224)){if(pid[_0x36daa3[_0x2c726a(0x20f)]])pid[_0x36daa3[_0x2c726a(0x20f)]][_0x2c726a(0x2e0)]({[_0x339ea7]:_0x27dc86});}});}async function storeSettings(_0x503ef3,_0x1140c8=![]){const _0x53ec53=_0x1d528a;_0x503ef3={...settings,..._0x503ef3};if(_0x1140c8&&_0x503ef3[_0x53ec53(0x1b7)]!='************'&&_0x503ef3[_0x53ec53(0x1b7)]!=_0x53ec53(0x165)&&_0x503ef3['bbPassword']!=''){const _0x1ce88e=crypt[_0x53ec53(0x1f7)](secure[_0x53ec53(0x1bc)],_0x503ef3[_0x53ec53(0x1b7)])[_0x53ec53(0x2b3)][_0x53ec53(0x14c)](_0x53ec53(0x114))[0x0],_0x254da4=bcrypt[_0x53ec53(0x2db)](_0x1ce88e,saltRounds);_0x503ef3={..._0x503ef3,'bbPassword':_0x254da4};}if(_0x1140c8&&_0x503ef3[_0x53ec53(0x2b9)]!=_0x53ec53(0x17c)&&_0x503ef3[_0x53ec53(0x2b9)]!='***'&&_0x503ef3['telegramToken']!=''){const _0x487842=crypt['decrypt'](secure[_0x53ec53(0x1bc)],_0x503ef3[_0x53ec53(0x2b9)])[_0x53ec53(0x2b3)][_0x53ec53(0x14c)]('|@|')[0x0];_0x503ef3={..._0x503ef3,'telegramToken':_0x487842};}if(_0x1140c8&&_0x503ef3['marketcapApi']!=_0x53ec53(0x17c)&&_0x503ef3[_0x53ec53(0x2d4)]!=_0x53ec53(0x165)&&_0x503ef3['marketcapApi']!=''){const _0x4a4942=crypt['decrypt'](secure[_0x53ec53(0x1bc)],_0x503ef3['marketcapApi'])[_0x53ec53(0x2b3)]['split'](_0x53ec53(0x114))[0x0];_0x503ef3={..._0x503ef3,'marketcapApi':_0x4a4942};}const _0x4df938=_0x503ef3[_0x53ec53(0x2b9)]!=_0x53ec53(0x17c)&&_0x503ef3[_0x53ec53(0x2b9)]!=settings[_0x53ec53(0x2b9)]||_0x503ef3[_0x53ec53(0x2ea)]!=settings[_0x53ec53(0x2ea)],_0x519867=_0x503ef3[_0x53ec53(0x2b9)]==''||_0x503ef3[_0x53ec53(0x2ea)]=='',_0x40f39c=_0x503ef3[_0x53ec53(0x2d4)]&&_0x503ef3['marketcapApi']!='************'&&_0x503ef3[_0x53ec53(0x2d4)]!=settings[_0x53ec53(0x2b9)];_0x4df938&&(_0x503ef3[_0x53ec53(0x256)]=null,_0x503ef3[_0x53ec53(0x320)]='all');for(const [_0x5aee86,_0x153fc2]of Object[_0x53ec53(0x14f)](_0x503ef3)){if(_0x5aee86==_0x53ec53(0x2b9)&&_0x153fc2==_0x53ec53(0x17c)){_0x503ef3['telegramToken']=settings['telegramToken'];continue;};if(_0x5aee86==_0x53ec53(0x1b7)&&_0x153fc2==_0x53ec53(0x17c)){_0x503ef3[_0x53ec53(0x1b7)]=settings[_0x53ec53(0x1b7)];continue;};if(_0x5aee86==_0x53ec53(0x2d4)&&_0x153fc2==_0x53ec53(0x17c)){_0x503ef3[_0x53ec53(0x2d4)]=settings[_0x53ec53(0x2d4)];continue;};dbSettings[_0x53ec53(0x10e)]('settings.'+_0x5aee86,_0x153fc2)[_0x53ec53(0x1de)]();}settings=_0x503ef3,io['to'](_0x53ec53(0x15c))['emit'](_0x53ec53(0x1a7),cleanSettings()),broadcastToBots('timeshift',settings[_0x53ec53(0x21b)]),broadcastToBots('onepagemode',settings[_0x53ec53(0x1b1)]),broadcastToBots(_0x53ec53(0x2d4),settings['marketcapApi']);if(_0x4df938&&!_0x519867)initTelegram();if(_0x4df938&&_0x519867)disableTelegram();getAllClients()[_0x53ec53(0x317)](_0x3f43e1=>{const _0x2c9656=_0x53ec53;getSocket(_0x3f43e1['id'])[_0x2c9656(0x289)](_0x2c9656(0x17e),{'access':{'allow':![],'reason':_0x2c9656(0x2f3),'token':null}});}),_0x40f39c&&(await sleep(0xbb8),testMarketcapApi(_0x503ef3[_0x53ec53(0x2d4)]));}async function testMarketcapApi(_0x2b15bc){const _0x85f7d7=_0x1d528a,_0x2a815e=[_0x85f7d7(0x2a3),_0x85f7d7(0x162)];try{await axios[_0x85f7d7(0x202)](_0x85f7d7(0x1cf),{'headers':{'X-CMC_PRO_API_KEY':_0x2b15bc},'params':{'symbol':_0x2a815e[_0x85f7d7(0x215)]()}});}catch(_0x54fd98){_0x54fd98[_0x85f7d7(0x215)]()[_0x85f7d7(0x2eb)]('status\x20code\x20401')?(io['to'](_0x85f7d7(0x15c))[_0x85f7d7(0x289)](_0x85f7d7(0x247),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x85f7d7(0x31c)](_0x85f7d7(0x1c6))):(io['to'](_0x85f7d7(0x15c))['emit']('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x85f7d7(0x31c)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x85f7d7(0x12e)]('Error\x20details:',_0x54fd98[_0x85f7d7(0x215)]()+_0x85f7d7(0x1ca)+_0x54fd98[_0x85f7d7(0x1c4)]));return;}logger[_0x85f7d7(0x12e)](_0x85f7d7(0x1a8));}function updateSetting(_0x1d26c6,_0x2e777c){const _0x3af9b2=_0x1d528a;dbSettings[_0x3af9b2(0x10e)](_0x3af9b2(0x297)+_0x1d26c6,_0x2e777c)[_0x3af9b2(0x1de)](),settings=getSettings(),io['to']('botmanager')[_0x3af9b2(0x289)](_0x3af9b2(0x1a7),cleanSettings());}function storeSecure(_0x61432b){const _0x363e2a=_0x1d528a;dbSecure['get'](_0x363e2a(0x26a))[_0x363e2a(0x2af)](_0x61432b)[_0x363e2a(0x1de)](),secure=_0x61432b;}function addBlacklist(_0x4c081f){const _0x73fc02=_0x1d528a;cleanBlacklist();let _0xc22b;devices[_0x4c081f][_0x73fc02(0x22e)]?_0xc22b=Math[_0x73fc02(0x244)](devices[_0x4c081f][_0x73fc02(0x22e)][_0x73fc02(0x1f8)],loginExpiry):_0xc22b=loginExpiry,dbSecure[_0x73fc02(0x202)](_0x73fc02(0x2ee))[_0x73fc02(0x2af)]({'expiry':new Date()[_0x73fc02(0x29d)]()+_0xc22b*0x3c*0x3e8,'token':devices[_0x4c081f][_0x73fc02(0x268)][_0x73fc02(0x2ab)]})[_0x73fc02(0x1de)](),blacklist=dbSecure[_0x73fc02(0x202)](_0x73fc02(0x2ee))[_0x73fc02(0x12c)]();}function cleanBlacklist(){const _0x26b8ce=_0x1d528a;let _0x37e2b9=dbSecure[_0x26b8ce(0x202)](_0x26b8ce(0x2ee))[_0x26b8ce(0x1f1)]()[_0x26b8ce(0x12c)](),_0x2f9b29=new Date()['getTime']();_0x37e2b9['forEach'](_0xa8b80f=>{const _0x2e0d87=_0x26b8ce;_0xa8b80f[_0x2e0d87(0x1f8)]<_0x2f9b29&&dbSecure[_0x2e0d87(0x202)](_0x2e0d87(0x2ee))[_0x2e0d87(0x1ae)]({'expiry':_0xa8b80f[_0x2e0d87(0x1f8)]})[_0x2e0d87(0x1de)]();});}function initStates(){let _0x16bc41=getConfiguration();_0x16bc41['forEach'](_0x528549=>{const _0x1aa571=_0x5715;_0x528549['live']=_0x1aa571(0x147);}),storeConfiguration(_0x16bc41);}function onKeys(){const _0x184614=new RSA();return new Promise(_0x570416=>{const _0x551f94=_0x5715;_0x184614['generateKeyPairAsync']()[_0x551f94(0x192)](_0x4d3d6c=>{_0x570416(_0x4d3d6c);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x11ee66=_0x1d528a;let _0x263b88=getSettings(),_0x4ebf52=![];!_0x263b88['hasOwnProperty'](_0x11ee66(0x303))&&(_0x263b88[_0x11ee66(0x303)]=0x0,_0x4ebf52=!![]);!_0x263b88[_0x11ee66(0x16d)](_0x11ee66(0x255))&&(_0x263b88[_0x11ee66(0x255)]=0x0,_0x4ebf52=!![]);!_0x263b88[_0x11ee66(0x16d)](_0x11ee66(0x2ae))&&(_0x263b88[_0x11ee66(0x2ae)]=_0x11ee66(0x248),_0x4ebf52=!![]);!_0x263b88[_0x11ee66(0x16d)]('onepagemode')&&(_0x263b88[_0x11ee66(0x1b1)]=![],_0x4ebf52=!![]);!_0x263b88[_0x11ee66(0x16d)]('marketcapApi')&&(_0x263b88[_0x11ee66(0x2d4)]='',_0x4ebf52=!![]);if(_0x4ebf52)storeSettings(_0x263b88);try{fs[_0x11ee66(0x304)](configbackuppath,{'withFileTypes':!![]})[_0x11ee66(0x317)](_0x2887ea=>{const _0x125e3c=_0x11ee66;if(!_0x2887ea[_0x125e3c(0x1c0)]()){if(!_0x2887ea[_0x125e3c(0x242)][_0x125e3c(0x228)](_0x125e3c(0x16e)))fs[_0x125e3c(0x308)](configbackuppath+_0x2887ea[_0x125e3c(0x242)]);}else fs[_0x125e3c(0x118)](configbackuppath+_0x2887ea[_0x125e3c(0x242)],{'recursive':!![]});});}catch(_0x186cda){logger['debug'](_0x11ee66(0x125),_0x186cda);}}function storeConfiguration(_0x48626d){const _0x23e0f1=_0x1d528a;dbConfig[_0x23e0f1(0x202)](_0x23e0f1(0x106))[_0x23e0f1(0x1ae)]()['write'](),dbConfig['get'](_0x23e0f1(0x106))[_0x23e0f1(0x2af)](..._0x48626d)[_0x23e0f1(0x1de)](),config=_0x48626d;}async function resetPassword(){const _0x311791=_0x1d528a;if(tgBot&&settings[_0x311791(0x256)]){const _0x1a9c12=Markup[_0x311791(0x212)]([Markup['button'][_0x311791(0x20a)]('yes',_0x311791(0x13b)),Markup['button']['callback']('no',_0x311791(0x19d))]);await sendTelegram(settings['telegramChatId'],_0x311791(0x1f9),_0x1a9c12),tgBot[_0x311791(0x24b)](/resetpw_(.+)/,async _0x260050=>{const _0xa45573=_0x311791,_0x1ec159=_0x260050[_0xa45573(0x262)][0x1];_0x260050['editMessageReplyMarkup']();if(_0x1ec159!='no'){const _0x2c82a2=0xf,_0x41a426=_0xa45573(0x2d3),_0x44eb2a=Array[_0xa45573(0x15f)](crypto[_0xa45573(0x1a2)](new Uint32Array(_0x2c82a2)))[_0xa45573(0x184)](_0xdd8fbe=>_0x41a426[_0xdd8fbe%_0x41a426[_0xa45573(0x30c)]])[_0xa45573(0x1e3)](''),_0x338173=bcrypt[_0xa45573(0x2db)](_0x44eb2a,saltRounds);storeSettings({'bbPassword':_0x338173}),await sendTelegram(_0x260050['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x44eb2a,{'parse_mode':_0xa45573(0x2bf)});}else await sendTelegram(_0x260050[_0xa45573(0x15d)]['id'],_0xa45573(0x28f));});}}async function confirmRestore(_0x494c2d,_0x5b15b8){const _0x51e9c0=_0x1d528a;io['to']('botmanager')['emit'](_0x51e9c0(0x247),_0x51e9c0(0x124),_0x51e9c0(0x2a4));if(tgBot&&settings[_0x51e9c0(0x256)]){const _0x357b24=uuidRandom();tmpStorage[_0x357b24]={'path':_0x494c2d,'filename':_0x5b15b8};const _0x5f1f01=Markup[_0x51e9c0(0x212)]([Markup['button'][_0x51e9c0(0x20a)](_0x51e9c0(0x145),'restore_yes_'+_0x357b24),Markup['button'][_0x51e9c0(0x20a)]('no',_0x51e9c0(0x1a0)+_0x357b24)]);await sendTelegram(settings[_0x51e9c0(0x256)],_0x51e9c0(0x274),_0x5f1f01),tgBot[_0x51e9c0(0x24b)](/restore_(.+)_(.+)/,async _0x5680aa=>{const _0x78b7d0=_0x51e9c0,_0x4cee24=_0x5680aa[_0x78b7d0(0x262)][0x1],_0x342a83=_0x5680aa['match'][0x2],{path:_0x5beb89,filename:_0x41e1d4}=tmpStorage[_0x342a83];delete tmpStorage[_0x342a83],_0x5680aa[_0x78b7d0(0x1fe)](),_0x4cee24==_0x78b7d0(0x145)?(logger[_0x78b7d0(0x12e)](_0x78b7d0(0x26b)),await sendTelegram(_0x5680aa[_0x78b7d0(0x15d)]['id'],_0x78b7d0(0x296),{'parse_mode':_0x78b7d0(0x2bf)}),unzipFile(_0x5beb89,_0x41e1d4)):(logger[_0x78b7d0(0x12e)](_0x78b7d0(0x2f9)),await sendTelegram(_0x5680aa[_0x78b7d0(0x15d)]['id'],_0x78b7d0(0x2f9)));});}}function getServerTime(){const _0x58a954=_0x1d528a,_0xa1aecb=new Date();return _0xa1aecb[_0x58a954(0x2ba)]()+'/'+(_0xa1aecb[_0x58a954(0x2b7)]()+0x1)[_0x58a954(0x215)]()[_0x58a954(0x2fc)](0x2,'0')+'/'+_0xa1aecb['getDate']()['toString']()[_0x58a954(0x2fc)](0x2,'0')+'\x20'+_0xa1aecb[_0x58a954(0x30a)]()['toString']()[_0x58a954(0x2fc)](0x2,'0')+':'+_0xa1aecb[_0x58a954(0x11b)]()['toString']()[_0x58a954(0x2fc)](0x2,'0')+':'+_0xa1aecb[_0x58a954(0x2b1)]()['toString']()[_0x58a954(0x2fc)](0x2,'0');}function getTimeStamp(){const _0x3321fd=_0x1d528a,_0x95a789=shiftedTime();return _0x95a789[_0x3321fd(0x2ba)]()+'/'+(_0x95a789[_0x3321fd(0x2b7)]()+0x1)[_0x3321fd(0x215)]()['padStart'](0x2,'0')+'/'+_0x95a789['getDate']()[_0x3321fd(0x215)]()['padStart'](0x2,'0')+'\x20'+_0x95a789[_0x3321fd(0x30a)]()[_0x3321fd(0x215)]()['padStart'](0x2,'0')+':'+_0x95a789[_0x3321fd(0x11b)]()[_0x3321fd(0x215)]()[_0x3321fd(0x2fc)](0x2,'0')+':'+_0x95a789[_0x3321fd(0x2b1)]()[_0x3321fd(0x215)]()[_0x3321fd(0x2fc)](0x2,'0');}function getCleanTimeStamp(){const _0x47512c=_0x1d528a,_0x55a58c=shiftedTime();return _0x55a58c['getFullYear']()+(_0x55a58c[_0x47512c(0x2b7)]()+0x1)[_0x47512c(0x215)]()[_0x47512c(0x2fc)](0x2,'0')+_0x55a58c[_0x47512c(0x29c)]()[_0x47512c(0x215)]()[_0x47512c(0x2fc)](0x2,'0')+'-'+_0x55a58c['getHours']()[_0x47512c(0x215)]()[_0x47512c(0x2fc)](0x2,'0')+_0x55a58c[_0x47512c(0x11b)]()[_0x47512c(0x215)]()[_0x47512c(0x2fc)](0x2,'0')+_0x55a58c[_0x47512c(0x2b1)]()['toString']()[_0x47512c(0x2fc)](0x2,'0');}function shiftedTime(){const _0x32c62a=_0x1d528a,_0x538066=new Date();let _0x3aea41=_0x538066;if(settings[_0x32c62a(0x21b)]&&settings[_0x32c62a(0x21b)]!==0x0)_0x3aea41=fns[_0x32c62a(0x26d)](_0x538066,{'hours':settings[_0x32c62a(0x21b)]});return _0x3aea41;}async function startScheduler(){const _0x30116b=_0x1d528a,_0x28e520=new Date()[_0x30116b(0x28a)](),_0x28a21d=shiftedTime()[_0x30116b(0x30a)]();_0x28a21d==0x4&&backupConfigFiles(),_0x28a21d==0x5&&restartAllBots(),_0x28a21d==0x0&&rotateLogFiles(),_0x28e520%0x6==0x0&&triggerAnalytics(),_0x28e520%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x22fedb){const _0x3633dc=_0x1d528a;logger[_0x3633dc(0x12e)](_0x3633dc(0x28e)+_0x22fedb);const _0xb7005c=getBotsWithMode();_0xb7005c[_0x3633dc(0x30c)]>0x0?confirmRestore(configbackuppath,_0x22fedb):unzipFile(configbackuppath,_0x22fedb);}async function getBackupFiles(_0x530b0c=null){const _0x287023=_0x1d528a;let _0x5043f9=[],_0x303b91=fs[_0x287023(0x304)](configbackuppath,{'withFileTypes':!![]});_0x303b91[_0x287023(0x13e)]((_0x4f83ec,_0x269ed0)=>_0x4f83ec[_0x287023(0x242)]<_0x269ed0[_0x287023(0x242)]?0x1:_0x269ed0['name']<_0x4f83ec[_0x287023(0x242)]?-0x1:0x0),_0x303b91[_0x287023(0x317)](_0x57900e=>{const _0x53a964=_0x287023;if(!_0x57900e[_0x53a964(0x1c0)]()&&_0x57900e[_0x53a964(0x242)][_0x53a964(0x228)]('backup-full@')&&_0x57900e[_0x53a964(0x242)]['endsWith']('.zip')){const _0x651821=formatDate(fs[_0x53a964(0x219)](configbackuppath+_0x57900e[_0x53a964(0x242)])[_0x53a964(0x217)]);_0x5043f9[_0x53a964(0x2af)]({'name':_0x57900e['name'],'mtime':_0x651821});}});if(_0x530b0c)io['to'](_0x530b0c)[_0x287023(0x289)](_0x287023(0x246),_0x5043f9);else return _0x5043f9;}async function backupConfigFiles(){const _0x50f551=_0x1d528a;await zipFiles(_0x50f551(0x194));const _0x320154=getCleanTimeStamp();fs[_0x50f551(0x1ce)](zippath+'backup-full.zip',configbackuppath+(_0x50f551(0x16e)+_0x320154+_0x50f551(0x2f2)));let _0x504962=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x504962[_0x50f551(0x13e)]((_0x1ff85c,_0x281bc6)=>_0x1ff85c[_0x50f551(0x242)]<_0x281bc6['name']?0x1:_0x281bc6[_0x50f551(0x242)]<_0x1ff85c[_0x50f551(0x242)]?-0x1:0x0),_0x504962[_0x50f551(0x30c)]>maxBackups&&fs[_0x50f551(0x308)](configbackuppath+_0x504962[_0x504962['length']-0x1][_0x50f551(0x242)]);}function rotateLogFiles(){const _0x543895=_0x1d528a,_0x5c8ac9=fs[_0x543895(0x219)](logspath+_0x543895(0x27c)),_0x591d09=_0x5c8ac9[_0x543895(0x2d0)]/0x400;if(_0x591d09>0x64){let _0xf92e8=fs[_0x543895(0x304)](logspath,{'withFileTypes':!![]});_0xf92e8[_0x543895(0x13e)]((_0x48528f,_0x5127c0)=>_0x48528f[_0x543895(0x242)]<_0x5127c0[_0x543895(0x242)]?0x1:_0x5127c0[_0x543895(0x242)]<_0x48528f['name']?-0x1:0x0),_0xf92e8[_0x543895(0x317)](_0x4a3e21=>{const _0x501341=_0x543895;if(_0x4a3e21[_0x501341(0x242)]==_0x501341(0x264))fs[_0x501341(0x1ce)](logspath+_0x4a3e21['name'],logspath+'output-003.log');if(_0x4a3e21[_0x501341(0x242)]==_0x501341(0x312))fs[_0x501341(0x1ce)](logspath+_0x4a3e21['name'],logspath+_0x501341(0x264));_0x4a3e21[_0x501341(0x242)]=='output-000.log'&&(fs[_0x501341(0x1ce)](logspath+_0x4a3e21[_0x501341(0x242)],logspath+_0x501341(0x312)),fs[_0x501341(0x1d1)](logspath+_0x4a3e21[_0x501341(0x242)],''));});}}async function zipFiles(_0x24d7bb){const _0x319b8e=_0x1d528a;let _0x330cfe;if(_0x24d7bb=='logs')_0x330cfe=logspath;if(_0x24d7bb==_0x319b8e(0x2b8))_0x330cfe=configpath;if(_0x24d7bb==_0x319b8e(0x194))_0x330cfe=configpath;let _0x369285=fs['readdirSync'](_0x330cfe,{'withFileTypes':!![]});const _0x469735=new require('node-zip')();_0x369285[_0x319b8e(0x317)](_0x1914e9=>{const _0x913fbb=_0x319b8e;if(!_0x1914e9[_0x913fbb(0x1c0)]()){let _0x34e8ab=fs[_0x913fbb(0x18d)](_0x330cfe+_0x1914e9[_0x913fbb(0x242)]);if(_0x24d7bb==_0x913fbb(0x2b8)){const _0x478bd4=/^bot-[0-9]{3}-config.json$/,_0x33c777=_0x478bd4[_0x913fbb(0x254)](_0x1914e9['name']);if(_0x33c777){const _0x46828f=JSON[_0x913fbb(0x2a8)](_0x34e8ab);if(_0x46828f[_0x913fbb(0x2a1)][0x0]){_0x46828f[_0x913fbb(0x2a1)][0x0][_0x913fbb(0x290)]='***',_0x46828f[_0x913fbb(0x2a1)][0x0][_0x913fbb(0x1d3)]=_0x913fbb(0x165);if(_0x46828f[_0x913fbb(0x2a1)][0x0][_0x913fbb(0x1ee)])_0x46828f[_0x913fbb(0x2a1)][0x0][_0x913fbb(0x1ee)]=_0x913fbb(0x165);}_0x34e8ab=JSON['stringify'](_0x46828f,null,0x2);}if(_0x1914e9[_0x913fbb(0x242)]==_0x913fbb(0x1e6)){const _0x3bf1e2=JSON[_0x913fbb(0x2a8)](_0x34e8ab);if(_0x3bf1e2['settings']['loginRequired'])_0x3bf1e2[_0x913fbb(0x1a7)][_0x913fbb(0x168)]=![];if(_0x3bf1e2[_0x913fbb(0x1a7)]['bbPassword'])_0x3bf1e2['settings']['bbPassword']=_0x913fbb(0x165);if(_0x3bf1e2[_0x913fbb(0x1a7)][_0x913fbb(0x2b9)])_0x3bf1e2['settings'][_0x913fbb(0x2b9)]=_0x913fbb(0x165);if(_0x3bf1e2['settings'][_0x913fbb(0x256)])_0x3bf1e2['settings'][_0x913fbb(0x256)]=null;if(_0x3bf1e2[_0x913fbb(0x1a7)][_0x913fbb(0x2d4)])_0x3bf1e2[_0x913fbb(0x1a7)]['marketcapApi']='***';_0x34e8ab=JSON[_0x913fbb(0x208)](_0x3bf1e2,null,0x2);}if(_0x1914e9[_0x913fbb(0x242)]!='bb-secure.json')_0x469735[_0x913fbb(0x209)](_0x1914e9[_0x913fbb(0x242)],_0x34e8ab);}else _0x469735[_0x913fbb(0x209)](_0x1914e9[_0x913fbb(0x242)],_0x34e8ab);}});const _0x103702=_0x469735[_0x319b8e(0x2ed)]({'base64':![],'compression':_0x319b8e(0x21e)});fs['writeFileSync'](zippath+(_0x24d7bb+'.zip'),_0x103702,_0x319b8e(0x1cd));}async function unzipFile(_0x2a1964,_0x4d92e1){const _0x29108b=_0x1d528a;fs[_0x29108b(0x304)](configpath,{'withFileTypes':!![]})[_0x29108b(0x317)](_0xa97eed=>{const _0x111005=_0x29108b;if(!_0xa97eed[_0x111005(0x1c0)]())fs[_0x111005(0x118)](configpath+_0xa97eed[_0x111005(0x242)]);});const _0x4418e7=fs[_0x29108b(0x18d)](_0x2a1964+_0x4d92e1,_0x29108b(0x1cd)),_0x1f3aee=new require('node-zip')(_0x4418e7,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x1f3aee['files'])['forEach'](_0x565967=>{const _0x4cb5b0=_0x29108b,_0x1184b7=_0x1f3aee[_0x4cb5b0(0x2b6)][_0x565967];fs[_0x4cb5b0(0x1d1)](configpath+_0x1184b7[_0x4cb5b0(0x242)],_0x1184b7[_0x4cb5b0(0x103)]);}),fs[_0x29108b(0x304)](temppath,{'withFileTypes':!![]})[_0x29108b(0x317)](_0x15ba65=>{const _0x323cf8=_0x29108b;if(!_0x15ba65[_0x323cf8(0x1c0)]())fs[_0x323cf8(0x118)](temppath+_0x15ba65[_0x323cf8(0x242)]);}),logger[_0x29108b(0x12e)](_0x29108b(0x249)),process[_0x29108b(0x2e0)]({'restore':!![]},_0x18ec7b=>{});}async function getPublicIp(){const _0x592db8=_0x1d528a;try{const _0x13c592=await axios[_0x592db8(0x202)](_0x592db8(0x24d));publicip=_0x13c592['data']['ip'];}catch(_0x362c2b){}}async function triggerAnalytics(){const _0x2bc4c8=_0x1d528a;if(!publicip)await getPublicIp();const _0x5d8823=getBotsWithMode();let _0xd5a577=0x0;_0x5d8823[_0x2bc4c8(0x317)](_0x423b54=>{const _0xeb0820=_0x2bc4c8;if(_0x423b54[_0xeb0820(0x17e)]===_0xeb0820(0x12a))_0xd5a577++;});const _0x3f00e6=getBotExchanges();mixpanel[_0x2bc4c8(0x318)](_0x2bc4c8(0x2c1),{'distinct_id':settings[_0x2bc4c8(0x11f)],'ip':publicip,'version':serverversion,'numbots':_0x5d8823[_0x2bc4c8(0x30c)],'numbotsenabled':_0xd5a577,'exchanges':_0x3f00e6,'environment':environment});}function _0x4f6e(){const _0x23bfc0=['internal','constructor','names','/upload-backup','3XHVMMv','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','2FA\x20login\x20required','sha256','express-fileupload','Bot\x20Mgr\x20>\x20','61290ojILay','/off\x20-\x20stop\x20bot(s)\x0a','/:bot/performance','output-000.log','Idling\x20(','<b>Balance\x20Bot\x20Status:</b>\x0a','clients','-results.json','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','<b>Telegram\x20Bot\x20Status:</b>\x0a','pidRefreshToken','off_','disconnect','init','All','f2aRequired','emit','getUTCHours','reject','\x1b[34m','5149910QYclBd','Restore\x20backup\x20file\x20','Password\x20reset\x20rejected','apiKey','Invalid\x20authentication\x20token\x20(2)','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','headless','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Restoring\x20bot(s)\x20from\x20backup','settings.','keys','update-bb','Setting\x20access:\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','getDate','getTime','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','placeOrder','clientip','bot','listen','BCT','success','bcryptjs','yargs/yargs','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','parse','event','Unauthorized\x20login\x20attempt\x20(timeout)','token','uuid-random','bbvNew','latestversion','push','start','getSeconds','Starting\x20#RED#Balance\x20Bot\x20v','message','environment','\x20|\x20client:\x20...','files','getMonth','backup','telegramToken','getFullYear','mode','549aryyho','defaults','cancel-loading','HTML','env','Server','log','telegraf','config_alerts','Login\x20accepted','access\x20timeout','mkdirSync','store-configuration','botname','Logged\x20in\x20user\x20...','command','update_no','Unauthorized\x20attempt\x20to\x20update\x20settings','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','size','disable','temporaryAccessAllowed','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','marketcapApi','Unauthorized\x20attempt\x20to\x20get\x20messages','backup/','started','pidExpireLogin','manual','/on\x20-\x20start\x20bot(s)\x0a','hashSync','Yes','showname','\x20(1)','5\x20min','send','/disable\x20-\x20disable\x20notifications\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','toggle_','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Ok,\x20will\x20send\x20order\x20notifications\x20only','user','toggle-bot-mode','close','Failed\x20to\x20download\x20','telegramUsername','includes','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','generate','blacklist','exp','\x1b[36m','/:bot/support','.zip','reload','private','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','toggle','Network\x20Interfaces:','storeConfiguration','Restore\x20process\x20aborted','slice','fork','padStart','3000','Unauthorized\x20attempt\x20to\x20delete\x20bot','format','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','NTBA_FIX_319','on_','lastmsgtelegram','readdirSync','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','title','apply','unlinkSync','enable','getHours','api-eu.mixpanel.com','length','launch','reply','sign','Crypt','createWriteStream','output-001.log','Unauthorized\x20attempt\x20to\x20update\x20bot','(((.+)+)+)+$','/names\x20-\x20show\x20bot\x20names\x0a','All\x20bots','forEach','track','Bot\x20','isIPv4MappedAddress','address','full','Starting\x20new\x20bot\x20|\x20Bot\x20','replace','production','telegramEvents','restart_','99928MzETeB','Unauthorized\x20attempt\x20to\x20get\x20events','_data','Notifications\x20enabled','server','bots','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','initclient','silentRestart','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','=>\x20Go\x20to\x20#CYA#http://','ipaddr.js','\x20|\x20','set','encryptedUuid','Access\x20enabled\x20for\x20','2FA\x20required','timestamp','deleteHistoryAlerts','|@|',':\x20Bot\x20Mgr\x20>\x20','exit','Unauthorized\x20attempt\x20to\x20confirm\x20message','rmSync','1223661AnCooi','telegram','getMinutes','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','string','reinstall','userid','telegramEnabled','Unauthorized\x20attempt\x20to\x20log\x20out','all','min','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Error\x20removing\x20old\x20backup\x20files:','File\x20uploaded','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','show-config','enabled',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','value','get-logs','debug','uuid','new-disabled','-performance.json','storeHeadless','existsSync','assign','username','verify','catch','Login\x20rejected','8tkQDfc','config_all','resetpw_yes','post','No\x20authentication\x20token','sort','1677996BqpdYE','/metrics\x20-\x20show\x20bot\x20performance\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','static','yes','temporary\x20access\x20timeout','stopped','sendPortfolioTelegram','/:bot/coins','headers','temporary\x20access\x20rejected','split','host','params','entries','type','get-messages','#RES#\x20if\x20running\x20locally\x0a','#RES#\x20','7300eOQnES','new','reinstall_no','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','http','simple','3311hVLNmI','portfolio','botmanager','chat','logout','from','Invalid\x20IP\x20address',',\x20must\x20be\x20a\x204\x20digit\x20number','ETH','staging','*$1*','***','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Token\x20blacklisted','loginRequired','\x20only\x0a','/output-000.log','confirm-message','mixpanel','hasOwnProperty','backup-full@','-events.json','Invalid\x20username\x20or\x20IP\x20address','build','update','8710680TBLKlp','jsonwebtoken','login2fa_','zip/','stop','auth','toIPv4Address','login\x20token\x20valid','metrics_','************','bb-config.json','status','removeAllListeners','secret','Alerts','store','remoteAddress','map','alias','button','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','isValid','sendMetricsTelegram','orders','30\x20min','readFileSync','temp/','Ok,\x20will\x20send\x20alert\x20notifications\x20only','args','argv','then','error','backup-full','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Enabled\x20Bot\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','kill','disabled','Notifications\x20disabled','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','resetpw_no','off','lowdb/adapters/FileSync','restore_no_','add-bot','randomFillSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','config/','filter','tempaccess_15_','settings','CoinMarketCap\x20API\x20key\x20validated','connection','emitHistory','getPortfolio','2FA\x20login\x20token\x20generated','graphql-request','remove','date-fns','Starting\x20Balance\x20Bot\x20reinstallation','onepagemode','publicKey','inherit','storeFiat','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','sortBy','bbPassword','port','versions','createServer','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','privateKey','kind','telegrammsg','Disabled\x20Bot\x20','isDirectory','Backup\x20file\x20uploaded','\x1b[33m','live','code','config_orders','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','exchange','download','SIGINT','\x20-\x20','\x1b[0m','bbvReceive','binary','copyFileSync','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','referer','writeFileSync','search','apiSecret','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/enable\x20-\x20enable\x20notifications\x0a','logged\x20out','get-portfolio','Unauthorized\x20attempt\x20to\x20add\x20bot','Notifications\x20types:\x20','update_yes','\x20|\x20user:\x20...','\x20>\x20','reason','write','help','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','login\x20token\x20generated','::ffff:127.0.0.1','join','Node.js\x20v','Telegram\x20error:','bb-settings.json','exec','bbUsername','28FtxvFP','Unauthorized\x20attempt\x20to\x20download\x20','allow','2FA','Telegraf\x20error:','apiPassword','telegram2FaApproval','use','cloneDeep','lowdb','sendMessage','/:bot/portfolio','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','auto','decrypt','expiry','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/:bot/configuration','Logged\x20out\x20user\x20...','Unauthorized\x20attempt\x20to\x20show\x20configuration','Invalid\x20authentication\x20token\x20(1)','editMessageReplyMarkup','reinstall-bb','index.html','bot-','get','family','You\x20can\x20use\x20the\x20following\x20commands:\x0a',')\x20|\x20Bot\x20','updatebotmanager','login\x20required','stringify','file','callback','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','function','Restarting\x20(silent)\x20Bot\x20','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','botID','logs/','reset-history','inlineKeyboard','alerts','temporary\x20access\x20not\x20allowed','toString','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','mtime','sockets','statSync','build2','timeshift','uncaughtException','\x20to\x20','DEFLATE','randomBytes','bb-secure.json','show','getStartingBalances','bot.js','running','text','[ip-address]','delete-alerts','startsWith','temporary\x20token\x20generated','number','Deleted\x20Bot\x20','backupfile','login','telegramIpApproval','login\x20not\x20required','socket','sendFile','accept','No\x20bots\x20running\x20right\x20now','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','-----------------------------------------------------------------------------------','toggleBotMode','version.json','/status\x20-\x20show\x20bot(s)\x20status\x0a','request','\x1b[35m','cancelLoading','handshake','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','All\x20bots\x20running\x20right\x20now','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','once','name','/:bot/history','max','reset-password','backup-files','notification','0.0.0','Backup\x20file\x20unzipped\x20and\x20stored','\x20mode','action','Notifications\x20disabled\x0a','https://api.ipify.org?format=json','crypto','address\x20already\x20in\x20use','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','find','/:bot','invalid\x20credentials','test','lastmsgemitted','telegramChatId','store-headless','Starting\x20(','login2fa_reject_','tkn','get-backup-files','axios','SIGTERM','hex','/start','restore-backup-file','RSA','match','password','output-002.log',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','RSA-OAEP','-config.json','access','6b67f3d61ee94b8f5c80b4affef4c4d9','secure','Restore\x20process\x20confirmed','tempaccess_reject_','add','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files'];_0x4f6e=function(){return _0x23bfc0;};return _0x4f6e();}async function getMessages(){const _0x4fbb77=_0x1d528a,_0x3fdfc0=_0x4fbb77(0x19c),_0x1ea9ba=new GraphQLClient(_0x3fdfc0),_0xf85479={'authorization':_0x4fbb77(0x2ce)},_0x35cd7d=serverversion[_0x4fbb77(0x14c)]('.'),_0x309d19=_0x35cd7d[0x0]+'.'+_0x35cd7d[0x1],_0xd51adb=Math[_0x4fbb77(0x123)](settings[_0x4fbb77(0x303)],settings[_0x4fbb77(0x255)]),_0x5268bc={'last':parseInt(_0xd51adb),'bbm':_0x309d19},_0x98228e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x373517;try{_0x373517=await _0x1ea9ba[_0x4fbb77(0x23a)](_0x98228e,_0x5268bc,_0xf85479);}catch(_0x45b1a5){}if(_0x373517&&_0x373517['messages']){let _0x1f4768=settings[_0x4fbb77(0x303)];newMessages=[];for(const _0x507495 of _0x373517['messages']){newMessages['push'](_0x507495);let _0x433a3e=![];_0x507495[_0x4fbb77(0x2ad)]&&(updateSetting('latestversion',_0x507495[_0x4fbb77(0x2ad)]),_0x433a3e=isNewerVersion(serverversion,_0x507495[_0x4fbb77(0x2ad)])||serverversion==_0x507495[_0x4fbb77(0x2ad)]);if(!_0x433a3e&&_0x507495[_0x4fbb77(0x22a)]>_0x1f4768){if(_0x507495[_0x4fbb77(0x1cc)]==='any'||serverversion[_0x4fbb77(0x228)](_0x507495[_0x4fbb77(0x1cc)])){let _0x380f70=''+_0x507495[_0x4fbb77(0x306)]+'\x0a\x0a'+_0x507495[_0x4fbb77(0x2b3)];const _0x3baa1a=await sendTelegramMsg(toTelegramMarkdown(_0x380f70),'Markdown');if(_0x3baa1a)_0x1f4768=_0x507495['number'];}}}updateAvailable=isNewerVersion(settings[_0x4fbb77(0x2ae)],serverversion),updateSetting('lastmsgtelegram',_0x1f4768),emitMessages();}}function emitMessages(){const _0x114a0d=_0x1d528a,_0x3f75e1=settings['lastmsgemitted'];let _0x2d8928=[];newMessages[_0x114a0d(0x317)](_0xa7b7d0=>{const _0x20a671=_0x114a0d;_0xa7b7d0[_0x20a671(0x22a)]>_0x3f75e1&&_0x2d8928['push'](_0xa7b7d0);}),_0x2d8928['length']>0x0&&getAllClients()[_0x114a0d(0x317)](_0x2e75d1=>{const _0x470d0b=_0x114a0d;getSocket(_0x2e75d1['id'])[_0x470d0b(0x289)]('message',_0x2d8928);});}function confirmMessage(_0x3e1054){updateSetting('lastmsgemitted',Number(_0x3e1054));}function isNewerVersion(_0x4dde07,_0x359f26){const _0x125678=_0x1d528a,_0x1dddf4=_0x359f26[_0x125678(0x14c)]('.'),_0x5418dc=_0x4dde07[_0x125678(0x14c)]('.');for(var _0x5859d2=0x0;_0x5859d2<_0x5418dc[_0x125678(0x30c)];_0x5859d2++){const _0x4ad702=~~_0x5418dc[_0x5859d2],_0x4e641c=~~_0x1dddf4[_0x5859d2];if(_0x4ad702>_0x4e641c)return!![];if(_0x4ad702<_0x4e641c)return![];}return![];}function toTelegramMarkdown(_0x5ab822){const _0x50585c=_0x1d528a,_0x1e641a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x268291=/\*{2}(.+?)\*{2}/gim;return _0x5ab822=_0x5ab822[_0x50585c(0x31e)](_0x1e641a,'$1_$2_$3')[_0x50585c(0x31e)](_0x268291,_0x50585c(0x164)),_0x5ab822;}async function validateConfigFile(){const _0x5eec81=_0x1d528a,_0x49b923=dbConfig[_0x5eec81(0x202)](_0x5eec81(0x106))[_0x5eec81(0x1b6)](_0x5eec81(0x20f))[_0x5eec81(0x12c)]()||[];if(_0x49b923[_0x5eec81(0x30c)]==0x0){let _0x4c874d=0x0,_0x537e92=[];const _0x4c97ba=/^bot-([0-9]{3})-config.json$/,_0x5b50ee=fs[_0x5eec81(0x304)](configpath);_0x5b50ee[_0x5eec81(0x317)](_0x255d60=>{const _0x229b6f=_0x5eec81,_0xf84c02=_0x4c97ba[_0x229b6f(0x1e7)](_0x255d60);if(_0xf84c02){const _0x2fd646=_0xf84c02[0x1];let _0x2926bc=getBotAttributes(_0x2fd646);_0x537e92['push']({'botID':_0x2fd646,'botname':_0x2926bc[_0x229b6f(0x2c9)],'status':_0x229b6f(0x19a),'live':_0x229b6f(0x147)}),_0x4c874d++;}}),_0x4c874d!=0x0&&(dbConfig['get']('bots')[_0x5eec81(0x134)](_0x537e92)['write'](),config=_0x537e92,restoredConfigFile=_0x4c874d);}}async function restoreConfigNotify(_0x290fa4){const _0x267076=_0x1d528a;let _0x2fdf6e;if(restoredConfigFile==0x1)_0x2fdf6e=_0x267076(0x157);else _0x2fdf6e='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x290fa4)io['to']('botmanager')['emit']('notification',_0x2fdf6e);else{logger[_0x267076(0x159)](_0x267076(0x236)),logger['simple'](_0x2fdf6e),logger['simple'](_0x267076(0x236)),logger[_0x267076(0x159)]('');if(tgBot&&settings[_0x267076(0x256)]&&settings['telegramEvents']!=_0x267076(0x18b))await sendTelegram(settings[_0x267076(0x256)],_0x267076(0x278)+_0x2fdf6e);}}function validateCredentials(_0x3a023b,_0x4ae61c){const _0x305d12=_0x1d528a;if(_0x3a023b[_0x305d12(0x135)]==settings[_0x305d12(0x1e8)]&&bcrypt['compareSync'](_0x3a023b[_0x305d12(0x263)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x305d12(0x275),'token':null};else{const _0x2e3697=generateLoginToken(_0x4ae61c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2e3697};}}else return{'allow':![],'reason':_0x305d12(0x253),'token':null};}function refreshToken(_0x517585){const _0x4072e1=_0x1d528a,_0x146956=generateLoginToken(_0x517585);return{'allow':!![],'reason':_0x4072e1(0x1e1),'token':_0x146956};}function validateAccess(_0x27ac72,_0xaff3b1,_0x27dc81){const _0xd92c5a=_0x1d528a,_0x440ca2=_0x27dc81?_0x27dc81:devices[_0xaff3b1]['ip'];let _0x5a2c91;const _0x2d2613=_0x50b539=>{const _0x53743d=_0x5715;if(settings['loginRequired']){if(settings[_0x53743d(0x288)]){if(telegram2FaApproved(_0xaff3b1)){const _0x18ffa6=generateLoginToken(_0xaff3b1);return{'allow':!![],'reason':_0x53743d(0x1ac),'token':_0x18ffa6};}else return{'allow':![],'reason':_0x53743d(0x207),'token':null};}else return _0x5a2c91=validToken(_0x50b539,_0xaff3b1),_0x5a2c91['hasOwnProperty'](_0x53743d(0x2a4))?{'allow':!![],'reason':_0x53743d(0x17a),'token':_0x50b539}:{'allow':![],'reason':_0x53743d(0x207),'token':null};}else return{'allow':!![],'reason':_0x53743d(0x22f),'token':null};};if(settings['whitelistEnabled']){let _0x236e7a=[...settings['whitelist'],'::1',_0xd92c5a(0x1e2),'127.0.0.1'];if(_0x236e7a[_0xd92c5a(0x2eb)](_0x440ca2))return _0x2d2613(_0x27ac72);else{_0x5a2c91=validToken(_0x27ac72,_0xaff3b1);if(_0x5a2c91['hasOwnProperty']('success'))return _0x2d2613(_0x27ac72);else{if(telegramIpApproved(_0xaff3b1)){const _0x1f881c=generateToken(_0xaff3b1);return _0x5a2c91=_0x2d2613(_0x27ac72),_0x5a2c91['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x1f881c}:_0x5a2c91;}else return settings[_0xd92c5a(0x2d2)]?{'allow':![],'reason':_0xd92c5a(0x111),'token':null}:{'allow':![],'reason':_0xd92c5a(0x214),'token':null};}}}else return _0x2d2613(_0x27ac72);}function timelyDecrypt(_0x3ab437,_0x1944c7,_0x161427='@'){const _0x11eddb=_0x1d528a;if(_0x3ab437)try{const _0x10ba08=crypt[_0x11eddb(0x1f7)](secure[_0x11eddb(0x1bc)],_0x3ab437)['message'],_0x573084=_0x10ba08[_0x11eddb(0x14c)](_0x161427)[0x0],_0x456ba7=_0x10ba08[_0x11eddb(0x14c)](_0x161427)[0x1],_0x43ce79=new Date()['getTime']();if(_0x1944c7){if(_0x43ce79-_0x456ba7<maxSecretAge*0x3e8)return _0x573084;else return![];}else return _0x573084;}catch(_0x35e64b){return![];}else return![];}const validToken=(_0x22255c,_0x44bdb7)=>{const _0x394bf2=_0x1d528a,_0x263959=devices[_0x44bdb7]['ip'];if(!_0x22255c)return{'error':_0x394bf2(0x13d)};for(let _0x706a8 of blacklist){if(_0x706a8['token']==_0x22255c)return{'error':_0x394bf2(0x167)};}let _0x80e28e;try{_0x80e28e=jwt[_0x394bf2(0x136)](_0x22255c,secure[_0x394bf2(0x180)]+_0x44bdb7);}catch{return{'error':_0x394bf2(0x1fd)};}if(!_0x80e28e['hasOwnProperty'](_0x394bf2(0x2a0))&&!_0x80e28e[_0x394bf2(0x16d)](_0x394bf2(0x135))||!_0x80e28e['hasOwnProperty'](_0x394bf2(0x2ef)))return{'error':_0x394bf2(0x291)};if(!_0x80e28e[_0x394bf2(0x16d)]('username')&&_0x80e28e[_0x394bf2(0x16d)](_0x394bf2(0x2a0))){const {clientip:_0x30bb9b}=_0x80e28e;return _0x263959==_0x30bb9b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x394bf2(0x160)};}else{if(_0x80e28e['hasOwnProperty']('username')&&_0x80e28e[_0x394bf2(0x16d)](_0x394bf2(0x2a0))){const {username:_0x9aa69c,clientip:_0x27ec34}=_0x80e28e;return settings[_0x394bf2(0x1e8)]==_0x9aa69c&&_0x263959==_0x27ec34?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x394bf2(0x170)};}}},generateLoginToken=_0x9b0460=>{const _0x4fadf2=_0x1d528a;if(_0x9b0460){const _0x100d58=devices[_0x9b0460]['ip'];return jwt[_0x4fadf2(0x30f)]({'username':settings[_0x4fadf2(0x1e8)],'clientip':_0x100d58},secure[_0x4fadf2(0x180)]+_0x9b0460,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x49b250=>{const _0x4d72e9=_0x1d528a;if(_0x49b250){const _0x24fdea=devices[_0x49b250]['ip'];return jwt[_0x4d72e9(0x30f)]({'clientip':_0x24fdea},secure[_0x4d72e9(0x180)]+_0x49b250,{'expiresIn':devices[_0x49b250][_0x4d72e9(0x22e)][_0x4d72e9(0x1f8)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x1fccdb=>{const _0x3748a9=_0x1d528a;let _0x31ce7f=![];return devices[_0x1fccdb][_0x3748a9(0x22e)]&&devices[_0x1fccdb][_0x3748a9(0x22e)][_0x3748a9(0x1f8)]!=_0x3748a9(0x28b)&&(_0x31ce7f=devices[_0x1fccdb][_0x3748a9(0x22e)][_0x3748a9(0x2a0)]==devices[_0x1fccdb]['ip']&&new Date()[_0x3748a9(0x29d)]()-devices[_0x1fccdb][_0x3748a9(0x22e)][_0x3748a9(0x112)]<devices[_0x1fccdb]['telegramIpApproval'][_0x3748a9(0x1f8)]*0x3c*0x3e8),_0x31ce7f;},telegram2FaApproved=_0x2d8f5b=>{const _0x5d9198=_0x1d528a;let _0xbe4a4b=![];return devices[_0x2d8f5b]['telegram2FaApproval']&&devices[_0x2d8f5b][_0x5d9198(0x1ef)][_0x5d9198(0x1f8)]!=_0x5d9198(0x28b)&&(_0xbe4a4b=devices[_0x2d8f5b][_0x5d9198(0x1ef)][_0x5d9198(0x2a0)]==devices[_0x2d8f5b]['ip']&&new Date()[_0x5d9198(0x29d)]()-devices[_0x2d8f5b][_0x5d9198(0x1ef)]['timestamp']<devices[_0x2d8f5b][_0x5d9198(0x1ef)][_0x5d9198(0x1f8)]*0x3c*0x3e8),_0xbe4a4b;},normalizeIP=_0x3fdbd0=>{const _0x775a71=_0x1d528a;let _0x268e6d=null,_0x4a63aa=null;if(ipaddr[_0x775a71(0x189)](_0x3fdbd0)){const _0x4a35a5=ipaddr[_0x775a71(0x2a8)](_0x3fdbd0);_0x4a35a5[_0x775a71(0x1bd)]()==='ipv6'?(_0x4a35a5[_0x775a71(0x31a)]()&&(_0x268e6d=_0x4a35a5[_0x775a71(0x179)]()[_0x775a71(0x215)]()),_0x4a63aa=_0x4a35a5[_0x775a71(0x215)]()):(_0x268e6d=_0x4a35a5[_0x775a71(0x215)](),_0x4a63aa=_0x4a35a5['toIPv4MappedAddress']()[_0x775a71(0x215)]());}return{'show':_0x268e6d?_0x268e6d:_0x4a63aa,'store':_0x4a63aa};};function formatDate(_0x3df5c0){const _0x468dd3=_0x1d528a;return _0x3df5c0[_0x468dd3(0x2ba)]()+'/'+(_0x3df5c0['getMonth']()+0x1)[_0x468dd3(0x215)]()[_0x468dd3(0x2fc)](0x2,'0')+'/'+_0x3df5c0[_0x468dd3(0x29c)]()[_0x468dd3(0x215)]()[_0x468dd3(0x2fc)](0x2,'0')+'\x20'+_0x3df5c0['getHours']()[_0x468dd3(0x215)]()[_0x468dd3(0x2fc)](0x2,'0')+':'+_0x3df5c0[_0x468dd3(0x11b)]()[_0x468dd3(0x215)]()[_0x468dd3(0x2fc)](0x2,'0')+':'+_0x3df5c0[_0x468dd3(0x2b1)]()[_0x468dd3(0x215)]()[_0x468dd3(0x2fc)](0x2,'0');}function sleep(_0x4dbb19){return new Promise(_0x59be0e=>setTimeout(_0x59be0e,_0x4dbb19));}