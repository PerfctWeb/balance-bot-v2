const _0x3cef30=_0x582a;(function(_0x7e69fe,_0x12c5cc){const _0x58cfed=_0x582a,_0x1e9599=_0x7e69fe();while(!![]){try{const _0xff12ec=-parseInt(_0x58cfed(0xd5))/0x1+parseInt(_0x58cfed(0x1f2))/0x2+parseInt(_0x58cfed(0xec))/0x3+-parseInt(_0x58cfed(0x12a))/0x4+parseInt(_0x58cfed(0x18f))/0x5*(-parseInt(_0x58cfed(0x1ca))/0x6)+parseInt(_0x58cfed(0x223))/0x7+parseInt(_0x58cfed(0x1be))/0x8*(-parseInt(_0x58cfed(0x1de))/0x9);if(_0xff12ec===_0x12c5cc)break;else _0x1e9599['push'](_0x1e9599['shift']());}catch(_0x4761b4){_0x1e9599['push'](_0x1e9599['shift']());}}}(_0x4d7f,0xb809b));const _0x40c91a=function(){let _0x434ab6=!![];return function(_0x3fa9d8,_0x4eea57){const _0x2e4777=_0x434ab6?function(){if(_0x4eea57){const _0x1f7d46=_0x4eea57['apply'](_0x3fa9d8,arguments);return _0x4eea57=null,_0x1f7d46;}}:function(){};return _0x434ab6=![],_0x2e4777;};}(),_0x4c5dd5=_0x40c91a(this,function(){const _0x4165ed=_0x582a;return _0x4c5dd5[_0x4165ed(0xbe)]()['search'](_0x4165ed(0x15e))['toString']()['constructor'](_0x4c5dd5)[_0x4165ed(0xb2)](_0x4165ed(0x15e));});_0x4c5dd5();'use strict';process[_0x3cef30(0x132)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3cef30(0xf1)),fs=require('fs'),fns=require(_0x3cef30(0x1dc)),low=require(_0x3cef30(0x228)),FileSync=require(_0x3cef30(0x103)),path=require(_0x3cef30(0x1d9)),crypto=require('crypto'),Crypt=require(_0x3cef30(0x10f))['Crypt'],RSA=require(_0x3cef30(0x10f))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x3cef30(0x105)),ipaddr=require(_0x3cef30(0x1b8)),argv=require(_0x3cef30(0x177))(process[_0x3cef30(0xb4)]['slice'](0x2))['argv'],uuidRandom=require(_0x3cef30(0x21e)),TelegramBot=require(_0x3cef30(0x1e9)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x3cef30(0x1bd)),util=require(_0x3cef30(0x22d)),fileUpload=require(_0x3cef30(0x187)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x3cef30(0x110)](PORT)&&(console[_0x3cef30(0x1b7)](_0x3cef30(0x10a)+PORT+_0x3cef30(0x11e)),process[_0x3cef30(0x229)](0x1));const HOST=argv[_0x3cef30(0x7a)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x3cef30(0x210)][_0x3cef30(0x18a)];let bbpath=_0x3cef30(0xe4),bbpath2='';function _0x582a(_0x12da5e,_0x3b2b82){const _0x815098=_0x4d7f();return _0x582a=function(_0x4c5dd5,_0x40c91a){_0x4c5dd5=_0x4c5dd5-0x6b;let _0x4d7f0d=_0x815098[_0x4c5dd5];return _0x4d7f0d;},_0x582a(_0x12da5e,_0x3b2b82);}const botfile=_0x3cef30(0x1ec),configfile=_0x3cef30(0x130),settingsfile='bb-settings.json',securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x3cef30(0x192)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x3cef30(0xff)+userID+'/':bbpath+_0x3cef30(0xff),configbackuppath=configpath+_0x3cef30(0x12d),logspath=userID?bbpath+_0x3cef30(0x117)+userID+'/':bbpath+_0x3cef30(0x117),zippath=userID?bbpath+_0x3cef30(0x1f5)+userID+'/':bbpath+_0x3cef30(0x1f5),loggerfile=fs[_0x3cef30(0x16f)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x3cef30(0xfd)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x3cef30(0x1ba)](configpath);function _0x4d7f(){const _0x310582=['pidRefreshToken','server','Starting\x20bot\x20|\x20Bot\x20','bb-settings.json','isValid','mode','Idling\x20bot\x20\x20\x20|\x20Bot\x20','join','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','backup','binary','settings.','output-000.log','token','log','ipaddr.js','Unauthorized\x20attempt\x20to\x20delete\x20bot','mkdirSync','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','graphql-request','1388792vuYUbT','value','request','login','address','stringify','Ok,\x20will\x20send\x20alert\x20notifications\x20only','botname','whitelistEnabled','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','backupfile','tkn','6BqUtiV','place-order','0.0.0','Unauthorized\x20attempt\x20to\x20download\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','kind','\x20only\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','showname','file','referer','Unauthorized\x20attempt\x20to\x20show\x20configuration','telegram','exp','string','path','Invalid\x20username\x20or\x20IP\x20address','function','date-fns','toggle-bot-mode','9ZPOjsV','bbPassword','Error\x20removing\x20old\x20backup\x20files:','bot','botmanager','family','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','then','chat','.zip','getPortfolio','node-telegram-bot-api','Unauthorized\x20attempt\x20to\x20update\x20bot','Bot\x20','bot.js','getStartingBalances','manual','/:bot/coins','filter','replace','1970846HKlDqT','sendFile','-events.json','zip/','keys','length','getFullYear','Server','2FA\x20required','login\x20token\x20generated','6b67f3d61ee94b8f5c80b4affef4c4d9','[ip-address]','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','updatebotmanager','disconnect','isDirectory','name','emit','/metrics\x20-\x20show\x20bot\x20performance\x0a','reason','min','statSync','bots','Invalid\x20Telegram\x20token','full','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','timestamp','Backup\x20file\x20unzipped\x20and\x20stored','store-configuration','expiry','versions','=>\x20Go\x20to\x20#CYA#http://','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','push','new','login\x20required','order','login\x20token\x20valid','Ok,\x20will\x20send\x20order\x20notifications\x20only','allow','\x1b[31m','Unauthorized\x20attempt\x20to\x20store\x20configuration','alias','uuid-random','unlinkSync','telegramEvents','endsWith','sign','8650831YvOdGq','\x1b[33m','reinstall-bb','resetHistory','sendMetricsTelegram','lowdb','exit','\x20minutes','node-zip','toIPv4Address','util','padStart','HTML','-results.json','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Setting\x20access:\x20',':\x20Bot\x20Mgr\x20>\x20','uuid','Invalid\x20IP\x20address','temporary\x20access\x20timeout','Invalid\x20authentication\x20token\x20(2)','Logged\x20out\x20user\x20...','send','Yes','exchange','all','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','get-messages','telegramEnabled','Notifications\x20enabled','</b>\x20?','polling_error','File\x20uploaded','success','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','auto','/:bot/configuration','All\x20bots\x20running\x20right\x20now','/:bot/performance','build2','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','auth','title','copyFileSync','rmSync','Unauthorized\x20attempt\x20to\x20confirm\x20message','temporary\x20token\x20generated','\x1b[34m','storeHeadless','alerts','exec','from','temporary\x20access\x20not\x20allowed','host','invalid\x20credentials','sendPortfolioTelegram','secure','handshake','readFileSync','version.json','delete-alerts','No\x20authentication\x20token','Token\x20blacklisted','once','Node.js\x20v','includes','size','event','confirm-message','/on\x20-\x20start\x20bot(s)\x0a','loginRequired','fork','headers','cloneDeep','socket.io','update-bb','pidExpireLogin','readdirSync','files','listen','update-bot','30\x20min','format','2FA\x20login\x20rejected','http','Starting\x20new\x20bot\x20|\x20Bot\x20','restore-backup-file','*$1*','Network\x20Interfaces:','slice','Notifications\x20disabled','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','orders','new-disabled','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','-performance.json','getMinutes','Failed\x20to\x20download\x20','\x20|\x20client:\x20...','Bot\x20Mgr\x20>\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','connected','/disable\x20-\x20disable\x20notifications\x0a','***','add','::ffff:127.0.0.1','version','/enable\x20-\x20enable\x20notifications\x0a','answerCallbackQuery','search','************','argv','lastmsgtelegram','/:bot/support','backup-files','apiPassword','5\x20min','timeshift','Restore\x20backup\x20file\x20','backup-full','/:bot/history','toString','bbUsername','-----------------------------------------------------------------------------------','2FA','secret','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','writeFileSync','username','decrypt','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','/:bot','simple','404\x20Not\x20Found','logged\x20out','telegramToken','set','privateKey','login\x20not\x20required','getTime','\x20|\x20user:\x20...','backup-full@','stopPolling','Restarting\x20Bot\x20','1226825PdhLZs','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','api-eu.mixpanel.com','#RES#\x0a','data','2FA\x20login\x20required','telegramIpApproval','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','sendMessage','apiKey','botID','Login\x20rejected','assign','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','bb/','toggleBotMode','live','socket','reinstall','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','\x20>\x20','\x20|\x20','3754992CtYYSR','telegramUsername','Starting\x20Balance\x20Bot\x20reinstallation','bb-secure.json','store-settings','child_process','Restore\x20process\x20aborted','getSeconds','enabled','<b>Balance\x20Bot\x20Status:</b>\x0a','sortBy','Unauthorized\x20attempt\x20to\x20update\x20settings','Invalid\x20authentication\x20token\x20(1)','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Markdown','post','delete-bot','temp/','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','config/','getUTCHours','internal','Unauthorized\x20attempt\x20to\x20log\x20out','lowdb/adapters/FileSync','Alerts','jsonwebtoken','kill','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','store-fiat','Error:\x20Invalid\x20argument\x20','yes','inherit','temporary\x20access\x20rejected','update','hybrid-crypto-js','test','use','getHours','show-config','::1','get-logs','get-portfolio','logs/','conn','forEach','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','All\x20bots','args','removeAllListeners',',\x20must\x20be\x20a\x204\x20digit\x20number','disabled','parse','verify','storeFiat','get','reset-password','All','\x20to\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','clientip','DEFLATE','4259072sWgBZj','No\x20bots\x20running\x20right\x20now','Starting\x20Balance\x20Bot\x20','backup/','blacklist','callback_query','bb-config.json','add-bot','env','getDate','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','ipv6','private','/download/:type','createServer','publicKey','headless','static','sort','Orders','removeListener','Your\x20installation\x20is\x20already\x20up\x20to\x20date','password','type','settings','onepagemode','defaults','access','startsWith','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20login\x20attempt\x20(timeout)','userid','onText','Notifications\x20types:\x20','write','/restart\x20-\x20restart\x20bot(s)\x0a','notification','mtime','bbvNew','ipc','Enabled\x20Bot\x20','/upload-backup','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Session\x20expired\x20for\x20user\x20...','Deleted\x20Bot\x20','build','output-003.log','/names\x20-\x20show\x20bot\x20names\x0a','1000','127.0.0.1','(((.+)+)+)+$','show','Notifications\x20enabled\x0a','initclient','Temporary\x20access\x20rejected','status','bot-','restart','User\x20has\x20been\x20validated','getMonth','messages','sha256','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','whitelist','Notifications\x20disabled\x0a','reload','bbvReceive','createWriteStream','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','deleteHistoryAlerts','message','backup-full.zip','hashSync','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','RSA-OAEP','yargs/yargs','debug','telegramChatId','showConfig','\x1b[35m','uncaughtException','isIPv4MappedAddress','logout','latestversion','track','Unauthorized\x20attempt\x20to\x20get\x20events','Access\x20enabled\x20for\x20','store','\x1b[36m','stopped','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','express-fileupload','SIGTERM','stop','node','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','index.html','hasOwnProperty','accept','1269545DrNGXC','output-002.log','remove','existsSync','Login\x20accepted','catch','telegrammsg','telegram2FaApproval','remoteAddress','lastmsgemitted','-config.json','placeOrder','number','find','encryptedUuid','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','split','map','reject','f2aRequired','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','2FA\x20login\x20token\x20generated','Password\x20has\x20been\x20reset\x20to:\x20','started','Backup\x20file\x20uploaded'];_0x4d7f=function(){return _0x310582;};return _0x4d7f();}!fs[_0x3cef30(0x192)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x3cef30(0x1ba)](logspath);!fs['existsSync'](zippath)&&fs[_0x3cef30(0x1ba)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3cef30(0x144)]({'bots':[]})[_0x3cef30(0x14e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3cef30(0x144)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3cef30(0x1cc),'onepagemode':![]}})[_0x3cef30(0x14e)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3cef30(0x144)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3cef30(0x169),'rsaStandard':_0x3cef30(0x176)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x3cef30(0x1fc),{'host':_0x3cef30(0xd8)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x3cef30(0xcc)]!=''&&settings[_0x3cef30(0xed)]&&settings[_0x3cef30(0xed)]!='')initTelegram();const parseColor=(_0x17b878,_0x5f04d6)=>{const _0x45e6b3=_0x3cef30,_0x5ab96f=/#[A-Z]{3}#/g;if(typeof _0x17b878==_0x45e6b3(0x1d8)){!_0x5f04d6?_0x17b878=_0x17b878[_0x45e6b3(0x1f1)](_0x5ab96f,''):(_0x17b878=_0x17b878[_0x45e6b3(0x1f1)](/#BLU#/g,_0x45e6b3(0x74)),_0x17b878=_0x17b878['replace'](/#RED#/g,_0x45e6b3(0x21b)),_0x17b878=_0x17b878['replace'](/#YEL#/g,_0x45e6b3(0x224)),_0x17b878=_0x17b878[_0x45e6b3(0x1f1)](/#MAG#/g,_0x45e6b3(0x17b)),_0x17b878=_0x17b878['replace'](/#CYA#/g,_0x45e6b3(0x184)),_0x17b878=_0x17b878[_0x45e6b3(0x1f1)](/#RES#/g,'\x1b[0m'));;}return _0x17b878;},logger={'screen':_0x4afb09=>{const _0x5a5e99=_0x3cef30;console[_0x5a5e99(0x1b7)](parseColor(_0x4afb09,!![]));},'simple':_0x1d07e3=>{const _0x28bd6f=_0x3cef30;console[_0x28bd6f(0x1b7)](parseColor(_0x1d07e3,!![])),loggerfile[_0x28bd6f(0x14e)](util[_0x28bd6f(0x97)](parseColor(_0x1d07e3,![]))+'\x0a');},'full':async _0x3a080b=>{const _0x4fb755=_0x3cef30,_0x9b311a=getTimeStamp()+_0x4fb755(0x233)+_0x3a080b;console[_0x4fb755(0x1b7)](parseColor(_0x9b311a,!![])),loggerfile[_0x4fb755(0x14e)](util[_0x4fb755(0x97)](parseColor(_0x9b311a,![]))+'\x0a');if(tgBot&&settings[_0x4fb755(0x179)]&&settings[_0x4fb755(0x220)]!=_0x4fb755(0xa1))await tgBot['sendMessage'](settings[_0x4fb755(0x179)],_0x4fb755(0xa8)+parseColor(_0x3a080b,![]))[_0x4fb755(0x194)](_0x497f06=>{telegramError(_0x497f06);});},'debug':async(_0x341e7f,_0x4a9d49='')=>{const _0x1a6481=_0x3cef30,_0x2b83a0=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x341e7f;if(debugging)console[_0x1a6481(0x1b7)](parseColor(_0x2b83a0,!![]));loggerfile[_0x1a6481(0x14e)](util[_0x1a6481(0x97)](parseColor(_0x2b83a0,![]))+'\x0a');if(_0x4a9d49){if(debugging)console[_0x1a6481(0x1b7)](_0x4a9d49);loggerfile[_0x1a6481(0x14e)](util['format'](_0x4a9d49)+'\x0a');}}};process['on'](_0x3cef30(0x17c),function(_0x2fa86f){const _0x2abece=_0x3cef30;logger[_0x2abece(0xc9)](_0x2fa86f);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3cef30(0x80))[_0x3cef30(0xaf)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x3cef30(0x99))[_0x3cef30(0x138)](app);app[_0x3cef30(0x111)](fileUpload({'useTempFiles':!![]})),app[_0x3cef30(0x123)](_0x3cef30(0x137),async(_0x54e2af,_0x4767f2)=>{const _0x27f78f=_0x3cef30,_0x5c90ea=_0x54e2af['params']['type'],_0x3b2c32=getClientsWithBotID(_0x27f78f(0x1e2)),_0x2ac1c6=_0x54e2af[_0x27f78f(0x8d)][_0x27f78f(0x234)],_0x5635e0=timelyDecrypt(_0x2ac1c6,![]),_0xb9fe25=_0x3b2c32['find'](_0x14f188=>_0x14f188['uuid']==_0x5635e0);if(_0xb9fe25){const _0x528e21=normalizeIP(_0x54e2af['socket'][_0x27f78f(0x197)])[_0x27f78f(0x183)],_0x2ee85e=_0x54e2af[_0x27f78f(0x8d)][_0x27f78f(0x1c9)];if(validateAccess(_0x2ee85e,_0x5635e0,_0x528e21)[_0x27f78f(0x21a)])_0x5c90ea==_0x27f78f(0x1b2)&&await backupConfigFiles(),await zipFiles(_0x5c90ea),_0x4767f2['download'](zippath+(_0x5c90ea+_0x27f78f(0x1e7)),_0x383bff=>{const _0x548430=_0x27f78f;_0x383bff&&(logger[_0x548430(0x20a)](_0x548430(0xa6)+_0x5c90ea),logger[_0x548430(0xc9)](_0x383bff));});else logger[_0x27f78f(0x20a)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x5c90ea+'\x20(1)');}else logger[_0x27f78f(0x20a)](_0x27f78f(0x1cd)+_0x5c90ea+'\x20(2)');}),app[_0x3cef30(0xfb)](_0x3cef30(0x155),async(_0xc32bbe,_0x2c0251)=>{const _0x2d3473=_0x3cef30,_0x1c406a=getClientsWithBotID(_0x2d3473(0x1e2)),_0x4c5c57=_0xc32bbe[_0x2d3473(0x8d)][_0x2d3473(0x234)],_0x16cdbd=timelyDecrypt(_0x4c5c57,![]),_0x4deb7c=_0x1c406a[_0x2d3473(0x19c)](_0x2e2496=>_0x2e2496[_0x2d3473(0x234)]==_0x16cdbd);logger[_0x2d3473(0x178)](_0x2d3473(0x1a8));if(_0x4deb7c){const _0x45fcdc=normalizeIP(_0xc32bbe[_0x2d3473(0xe7)][_0x2d3473(0x197)])[_0x2d3473(0x183)],_0x3c5cc5=_0xc32bbe[_0x2d3473(0x8d)][_0x2d3473(0x1c9)];if(validateAccess(_0x3c5cc5,_0x16cdbd,_0x45fcdc)[_0x2d3473(0x21a)]){if(_0xc32bbe[_0x2d3473(0x93)]){const _0x10d31b=_0xc32bbe['files'][_0x2d3473(0x1c8)];await _0x10d31b['mv'](temppath+_0x10d31b[_0x2d3473(0x202)]),_0x2c0251['send']({'status':!![],'message':_0x2d3473(0x243)});const _0x58aa81=getBotsWithMode();_0x58aa81['length']>0x0?confirmRestore(temppath,_0x10d31b[_0x2d3473(0x202)]):unzipFile(temppath,_0x10d31b[_0x2d3473(0x202)]);}}else logger[_0x2d3473(0x20a)](_0x2d3473(0x149));}else logger[_0x2d3473(0x20a)](_0x2d3473(0x107));}),app[_0x3cef30(0x111)](express[_0x3cef30(0x13b)](path[_0x3cef30(0x1b0)](__dirname,bbpath2,_0x3cef30(0x6c)))),app['use'](express[_0x3cef30(0x13b)](path['join'](__dirname,bbpath2,_0x3cef30(0x159)))),app[_0x3cef30(0x123)]('/',function(_0x5c7eef,_0x207f0f){const _0xefda35=_0x3cef30;_0x207f0f[_0xefda35(0x1f3)](path[_0xefda35(0x1b0)](__dirname,bbpath2,_0xefda35(0x6c),_0xefda35(0x18c)));}),app['get'](_0x3cef30(0xc8),function(_0x49fe9e,_0x5e3691){const _0x3d2b62=_0x3cef30;_0x5e3691[_0x3d2b62(0x1f3)](path['join'](__dirname,bbpath2,_0x3d2b62(0x159),_0x3d2b62(0x18c)));}),app[_0x3cef30(0x123)]('/:bot/portfolio',(_0x3c3d45,_0x46e113)=>{const _0x2c5b47=_0x3cef30;_0x46e113['sendFile'](path['join'](__dirname,bbpath2,_0x2c5b47(0x159),_0x2c5b47(0x18c)));}),app[_0x3cef30(0x123)](_0x3cef30(0x6b),(_0x20b0d0,_0x51a73d)=>{const _0x5a6c18=_0x3cef30;_0x51a73d[_0x5a6c18(0x1f3)](path[_0x5a6c18(0x1b0)](__dirname,bbpath2,_0x5a6c18(0x159),_0x5a6c18(0x18c)));}),app[_0x3cef30(0x123)](_0x3cef30(0x1ef),(_0xac398a,_0x11b3bb)=>{const _0x2ffbfa=_0x3cef30;_0x11b3bb[_0x2ffbfa(0x1f3)](path[_0x2ffbfa(0x1b0)](__dirname,bbpath2,_0x2ffbfa(0x159),_0x2ffbfa(0x18c)));}),app[_0x3cef30(0x123)](_0x3cef30(0xbd),(_0x565591,_0x1c0cf5)=>{const _0x5bdad0=_0x3cef30;_0x1c0cf5['sendFile'](path[_0x5bdad0(0x1b0)](__dirname,bbpath2,_0x5bdad0(0x159),_0x5bdad0(0x18c)));}),app[_0x3cef30(0x123)](_0x3cef30(0x247),(_0x37137e,_0x424740)=>{const _0x545b4e=_0x3cef30;_0x424740[_0x545b4e(0x1f3)](path['join'](__dirname,bbpath2,_0x545b4e(0x159),_0x545b4e(0x18c)));}),app[_0x3cef30(0x123)](_0x3cef30(0xb6),(_0x335269,_0x20b8e1)=>{const _0x41f478=_0x3cef30;_0x20b8e1['sendFile'](path['join'](__dirname,bbpath2,_0x41f478(0x159),_0x41f478(0x18c)));});if(HOST)http[_0x3cef30(0x94)](PORT,HOST);else http[_0x3cef30(0x94)](PORT);const io=require(_0x3cef30(0x8f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x9831a0=_0x3cef30;let _0x4c1fd3=_0x9831a0(0x1fd);const _0x34f8b0=networkInterfaces(),_0x89ffd3={};for(const _0x208356 of Object[_0x9831a0(0x1f6)](_0x34f8b0)){for(const _0x2656cd of _0x34f8b0[_0x208356]){if((_0x2656cd[_0x9831a0(0x1e3)]=='IPv4'||_0x2656cd[_0x9831a0(0x1e3)]==0x4)&&!_0x2656cd[_0x9831a0(0x101)]){const _0x1da6fe=ipaddr[_0x9831a0(0x120)](_0x2656cd[_0x9831a0(0x1c2)])['range']();_0x1da6fe!=_0x9831a0(0x136)&&(!_0x89ffd3[_0x208356]&&(_0x89ffd3[_0x208356]=[]),_0x89ffd3[_0x208356][_0x9831a0(0x214)](_0x2656cd[_0x9831a0(0x1c2)]),_0x4c1fd3=_0x2656cd[_0x9831a0(0x1c2)]);}}}return{'serverip':_0x4c1fd3,'netinterfaces':_0x89ffd3};}async function startServer(){const _0x388246=_0x3cef30,{serverip:_0x5b6480,netinterfaces:_0x5ab291}=getServerIP();logger['simple'](''),logger[_0x388246(0xc9)](_0x388246(0xc0)),await logger[_0x388246(0x20a)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x388246(0xd9)+(_0x388246(0xf9)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x388246(0x211)+_0x5b6480+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x388246(0xc9)](_0x388246(0xc0));if(config['length']!=0x0)for(const _0x1c314c of config){if(_0x1c314c[_0x388246(0x163)]==_0x388246(0xf4)||_0x1c314c['status']==_0x388246(0x215))await logger[_0x388246(0x20a)](_0x388246(0x1ab)+_0x1c314c[_0x388246(0xe0)]+_0x388246(0xeb)+_0x1c314c[_0x388246(0x1c5)]),startBot([_0x1c314c['botID'],userID],{'cwd':bbpath},function(_0x2c5a3b){if(_0x2c5a3b)logger['full'](_0x2c5a3b);});else(_0x1c314c[_0x388246(0x163)]=='disabled'||_0x1c314c[_0x388246(0x163)]==_0x388246(0xa2))&&await logger[_0x388246(0x20a)](_0x388246(0x1af)+_0x1c314c[_0x388246(0xe0)]+_0x388246(0xeb)+_0x1c314c[_0x388246(0x1c5)]);}else!newBot&&logger[_0x388246(0xc9)](_0x388246(0x1ce));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x388246(0xc9)](''),await logger[_0x388246(0x178)](_0x388246(0x85)+nodeversion),await logger[_0x388246(0x178)](_0x388246(0x9d),_0x5ab291);}function startSocket(){io['on']('connection',_0xd224b1=>{const _0x56874e=_0x582a;let _0x12c83e,_0xf8daeb,_0x5a123f,_0x51e917,_0x18a7c1;const _0x345b94=_0xd224b1[_0x56874e(0x7e)]['headers'][_0x56874e(0x1d4)];_0xf8daeb=_0x345b94['match'](/bot[0-9]{3}/);if(_0xf8daeb)_0x5a123f=_0xf8daeb[0x0]['match'](/[0-9]{3}/);if(_0x5a123f)_0x12c83e=_0x5a123f[0x0];else _0x12c83e='botmanager';const _0x18d3e0=_0xd224b1[_0x56874e(0x7e)][_0x56874e(0x6e)][_0x56874e(0x19d)];if(!_0x18d3e0)_0xd224b1[_0x56874e(0x203)]('status',{'publicKey':secure['publicKey']});else{_0x51e917=timelyDecrypt(_0x18d3e0,![]);if(!_0x51e917)_0xd224b1[_0x56874e(0x203)](_0x56874e(0x163),{'publicKey':secure['publicKey']});else{_0x18a7c1=normalizeIP(_0xd224b1[_0x56874e(0x118)][_0x56874e(0x197)])[_0x56874e(0x183)];if(!devices[_0x51e917])devices[_0x51e917]={'uuid':_0x51e917,'access':{'token':null}};devices[_0x51e917]['ip']=_0x18a7c1;const _0x13822c=addClient(_0xd224b1['id'],_0x51e917,_0x12c83e);setAccess(_0x13822c),emitMessages(),_0xd224b1['on'](_0x56874e(0x1c1),_0x1e4568=>{const _0x1b6604=_0x56874e,_0x278534=timelyDecrypt(_0x1e4568[_0x1b6604(0x140)]);if(_0x278534){_0x1e4568={'username':_0x1e4568['username'],'password':_0x278534},devices[_0x51e917][_0x1b6604(0x145)]=validateCredentials(_0x1e4568,_0x51e917);if(devices[_0x51e917][_0x1b6604(0x145)][_0x1b6604(0x21a)]==![]&&devices[_0x51e917][_0x1b6604(0x145)]['reason']==_0x1b6604(0xdb))_0xd224b1[_0x1b6604(0x203)](_0x1b6604(0x163),{'access':devices[_0x51e917][_0x1b6604(0x145)]}),loginAccess2FA(_0x51e917,_0x18a7c1);else{if(devices[_0x51e917][_0x1b6604(0x145)][_0x1b6604(0x21a)]==![]&&devices[_0x51e917][_0x1b6604(0x145)]['reason']==_0x1b6604(0x7b))_0xd224b1[_0x1b6604(0x203)](_0x1b6604(0x163),{'access':devices[_0x51e917]['access']});else devices[_0x51e917][_0x1b6604(0x145)][_0x1b6604(0x21a)]&&devices[_0x51e917][_0x1b6604(0x145)][_0x1b6604(0x205)]==_0x1b6604(0x1fb)&&(getClientsWithUuid(_0x51e917)[_0x1b6604(0x119)](_0xea0425=>{setAccess(_0xea0425);}),logger['debug'](_0x1b6604(0xd6)+_0x51e917[_0x1b6604(0x9e)](-0x8)),setTokenRefresh(_0x51e917),setSessionTimeout(_0x1b6604(0x1c1),_0x51e917));}}else logger[_0x1b6604(0x20a)](_0x1b6604(0x14a));}),_0xd224b1['on'](_0x56874e(0x124),()=>{resetPassword();}),_0xd224b1['on'](_0x56874e(0x200),_0x2cffda=>{removeClient(_0xd224b1['id']);}),_0x12c83e=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x56baba){const _0x3c20ca=_0x3cef30;if(_0x56baba!=_0x3c20ca(0x1e2)&&config['apiKey']!=''){if(pid[_0x56baba])pid[_0x56baba][_0x3c20ca(0x239)]({'function':_0x3c20ca(0x161),'args':null});}_0x56baba!='botmanager'&&broadcastToBots(_0x3c20ca(0x208),JSON[_0x3c20ca(0x1c3)](config));}function reloadBotManager(){const _0x54d356=_0x3cef30;getClientsWithBotID(_0x54d356(0x1e2))[_0x54d356(0x119)](_0x167366=>{const _0x163947=_0x54d356;getSocket(_0x167366['id'])[_0x163947(0x203)]('status',{'access':{'allow':![],'reason':_0x163947(0x16d),'token':null}});});}function getSocket(_0x1d2973){return io['sockets']['sockets']['get'](_0x1d2973);}function setAccess(_0x500c9f){const _0x5bd3fd=_0x3cef30,_0x814673=getSocket(_0x500c9f['id']),_0x558f8b=_0x500c9f[_0x5bd3fd(0x234)],_0x42c0e7=_0x500c9f[_0x5bd3fd(0x1e1)];devices[_0x558f8b][_0x5bd3fd(0x145)]=validateAccess(devices[_0x558f8b][_0x5bd3fd(0x145)][_0x5bd3fd(0x1b6)],_0x558f8b),logger[_0x5bd3fd(0x178)](_0x5bd3fd(0x232)+devices[_0x558f8b]['access'][_0x5bd3fd(0x205)]+_0x5bd3fd(0xa7)+_0x500c9f['id']['slice'](-0x8)+_0x5bd3fd(0xd1)+_0x558f8b[_0x5bd3fd(0x9e)](-0x8)),_0x814673[_0x5bd3fd(0x1b0)](_0x558f8b);if(devices[_0x558f8b]['access'][_0x5bd3fd(0x21a)]){_0x814673['join'](_0x42c0e7);if(_0x42c0e7=='botmanager')initializeSocketBotManager(_0x814673);else initializeSocketBot(_0x814673);initClient(_0x42c0e7);}devices[_0x558f8b][_0x5bd3fd(0x145)]['token']&&devices[_0x558f8b][_0x5bd3fd(0x145)][_0x5bd3fd(0x205)]==_0x5bd3fd(0x73)&&setSessionTimeout(_0x5bd3fd(0xc1),_0x558f8b),devices[_0x558f8b][_0x5bd3fd(0x145)][_0x5bd3fd(0x1b6)]&&devices[_0x558f8b][_0x5bd3fd(0x145)][_0x5bd3fd(0x205)]==_0x5bd3fd(0x1a5)&&setSessionTimeout(_0x5bd3fd(0x1c1),_0x558f8b),_0x814673[_0x5bd3fd(0x203)](_0x5bd3fd(0x163),{'status':_0x500c9f[_0x5bd3fd(0x1aa)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x558f8b][_0x5bd3fd(0x145)],'externalip':devices[_0x558f8b]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x558f8b][_0x5bd3fd(0x145)][_0x5bd3fd(0x21a)]==![]&&devices[_0x558f8b][_0x5bd3fd(0x145)][_0x5bd3fd(0x205)]==_0x5bd3fd(0x1fa)&&temporaryAccess2FA(_0x558f8b,devices[_0x558f8b]['ip']);}function setSessionTimeout(_0x42dca6,_0xedf8bf){const _0x2893b5=_0x3cef30;let _0x2636c4;if(_0x42dca6==_0x2893b5(0x1c1))_0x2636c4=loginExpiry*0x3c*0x3e8;else _0x2636c4=devices[_0xedf8bf][_0x2893b5(0xdc)][_0x2893b5(0x20f)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0xedf8bf][_0x2893b5(0xdc)][_0x2893b5(0x20c)]);if(devices[_0xedf8bf][_0x2893b5(0x91)])clearTimeout(devices[_0xedf8bf][_0x2893b5(0x91)]);devices[_0xedf8bf][_0x2893b5(0x91)]=setTimeout(()=>{const _0x354eab=_0x2893b5;if(devices[_0xedf8bf]['pidRefreshToken'])clearTimeout(devices[_0xedf8bf]['pidRefreshToken']);removeSocketListeners(_0xedf8bf),addBlacklist(_0xedf8bf),devices[_0xedf8bf][_0x354eab(0xdc)]=null,devices[_0xedf8bf][_0x354eab(0x196)]=null,devices[_0xedf8bf][_0x354eab(0x145)]['token']=null,logger[_0x354eab(0x178)](_0x354eab(0x157)+_0xedf8bf[_0x354eab(0x9e)](-0x8)),devices[_0xedf8bf][_0x354eab(0x145)]=validateAccess(devices[_0xedf8bf][_0x354eab(0x145)][_0x354eab(0x1b6)],_0xedf8bf),!(devices[_0xedf8bf][_0x354eab(0x145)][_0x354eab(0x21a)]&&devices[_0xedf8bf][_0x354eab(0x145)][_0x354eab(0x205)]==_0x354eab(0xcf))&&(_0x42dca6==_0x354eab(0x1c1)?io['to'](_0xedf8bf)['emit']('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xedf8bf)[_0x354eab(0x203)](_0x354eab(0x163),{'access':{'allow':![],'reason':_0x354eab(0x236),'token':null}})),devices[_0xedf8bf][_0x354eab(0x145)][_0x354eab(0x1b6)]=null;},_0x2636c4);}function setTokenRefresh(_0x2fa535){const _0x271412=_0x3cef30;if(devices[_0x2fa535]['pidRefreshToken'])clearTimeout(devices[_0x2fa535][_0x271412(0x1a9)]);devices[_0x2fa535][_0x271412(0x1a9)]=setTimeout(()=>{const _0xf4727a=_0x271412;getClientsWithUuid(_0x2fa535)[_0xf4727a(0x1f7)]!=0x0?(devices[_0x2fa535][_0xf4727a(0x145)]=refreshToken(_0x2fa535),io['to'](_0x2fa535)[_0xf4727a(0x203)](_0xf4727a(0x163),{'status':_0xf4727a(0xaa),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2fa535][_0xf4727a(0x145)],'externalip':devices[_0x2fa535]['ip'],'publicKey':secure[_0xf4727a(0x139)],'validInstallation':validInstallation}),setTokenRefresh(_0x2fa535)):clearTimeout(devices[_0x2fa535][_0xf4727a(0x1a9)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x517aaa){const _0x363e3c=_0x3cef30,_0x355915=getClient(_0x517aaa['id'])[_0x363e3c(0x234)];_0x517aaa['emit']('bots',config),_0x517aaa[_0x363e3c(0x203)]('settings',cleanSettings()),_0x517aaa['on'](_0x363e3c(0x131),_0xeafae1=>{const _0x135cf4=_0x363e3c;if(validateAccess(_0xeafae1,_0x355915)['allow'])addBot();else logger[_0x135cf4(0x20a)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x517aaa['on'](_0x363e3c(0x95),(_0x5ea266,_0x522740)=>{const _0x86cffd=_0x363e3c;if(validateAccess(_0x522740,_0x355915)[_0x86cffd(0x21a)])toggleBot(_0x5ea266[_0x86cffd(0xe0)],_0x5ea266[_0x86cffd(0x163)],_0x5ea266[_0x86cffd(0xe6)]);else logger[_0x86cffd(0x20a)](_0x86cffd(0x1ea));}),_0x517aaa['on'](_0x363e3c(0x1dd),(_0x243643,_0x56090d)=>{const _0x1df6e2=_0x363e3c;if(validateAccess(_0x56090d,_0x355915)['allow'])toggleBotMode(_0x243643);else logger[_0x1df6e2(0x20a)](_0x1df6e2(0x1ea));}),_0x517aaa['on'](_0x363e3c(0xfc),(_0x1676ea,_0x25ca6a)=>{const _0x43e6b7=_0x363e3c;if(validateAccess(_0x25ca6a,_0x355915)['allow'])deleteBot(_0x1676ea);else logger[_0x43e6b7(0x20a)](_0x43e6b7(0x1b9));}),_0x517aaa['on'](_0x363e3c(0xf0),(_0x596e1f,_0x34bdae)=>{const _0x15bce6=_0x363e3c;if(validateAccess(_0x34bdae,_0x355915)[_0x15bce6(0x21a)])storeSettings(_0x596e1f,!![]);else logger['full'](_0x15bce6(0xf7));}),_0x517aaa['on'](_0x363e3c(0x90),_0xe890bd=>{const _0x290f3c=_0x363e3c;if(validateAccess(_0xe890bd,_0x355915)['allow'])updateBB(_0x290f3c(0x10e));else logger[_0x290f3c(0x20a)](_0x290f3c(0x16a));}),_0x517aaa['on'](_0x363e3c(0x225),_0x15e7d4=>{const _0x39cfa9=_0x363e3c;if(validateAccess(_0x15e7d4,_0x355915)[_0x39cfa9(0x21a)])updateBB(_0x39cfa9(0xe8));else logger[_0x39cfa9(0x20a)](_0x39cfa9(0x6d));}),_0x517aaa['on']('get-backup-files',_0x39a7e3=>{const _0x4e4246=_0x363e3c;if(validateAccess(_0x39a7e3,_0x355915)[_0x4e4246(0x21a)]){const _0x157354=getClient(_0x517aaa['id']);if(_0x157354)getBackupFiles(_0x157354[_0x4e4246(0x234)]);else logger[_0x4e4246(0x20a)](_0x4e4246(0x148));}else logger['full'](_0x4e4246(0x156));}),_0x517aaa['on'](_0x363e3c(0x9b),(_0x21c38f,_0x18c8d9)=>{const _0x5707aa=_0x363e3c;if(validateAccess(_0x18c8d9,_0x355915)[_0x5707aa(0x21a)])restoreBackupFile(_0x21c38f);else logger[_0x5707aa(0x20a)](_0x5707aa(0x1a3));}),_0x517aaa['on'](_0x363e3c(0x23e),_0x33aca1=>{const _0x91c5bf=_0x363e3c;if(validateAccess(_0x33aca1,_0x355915)[_0x91c5bf(0x21a)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x517aaa['on'](_0x363e3c(0x89),(_0x17da37,_0x2b5deb)=>{const _0x13a1af=_0x363e3c;if(validateAccess(_0x2b5deb,_0x355915)[_0x13a1af(0x21a)])confirmMessage(_0x17da37);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x517aaa['on'](_0x363e3c(0x17e),_0x4ee356=>{const _0x1d46d7=_0x363e3c;if(validateAccess(_0x4ee356,_0x355915)[_0x1d46d7(0x21a)]){if(devices[_0x355915][_0x1d46d7(0x1a9)])clearTimeout(devices[_0x355915][_0x1d46d7(0x1a9)]);if(devices[_0x355915][_0x1d46d7(0x91)])clearTimeout(devices[_0x355915][_0x1d46d7(0x91)]);removeSocketListeners(getClient(_0x517aaa['id'])[_0x1d46d7(0x234)]),addBlacklist(_0x355915),devices[_0x355915]['telegramIpApproval']=null,devices[_0x355915][_0x1d46d7(0x196)]=null,devices[_0x355915]['access'][_0x1d46d7(0x1b6)]=null,logger[_0x1d46d7(0x178)](_0x1d46d7(0x238)+_0x355915['slice'](-0x8)),io['to'](getClient(_0x517aaa['id'])[_0x1d46d7(0x234)])[_0x1d46d7(0x203)](_0x1d46d7(0x163),{'access':{'allow':![],'reason':_0x1d46d7(0xcb),'token':null}});}else logger['full'](_0x1d46d7(0x102));});}function initializeSocketBot(_0x478ccb){const _0x7dbfa8=_0x3cef30,_0x767536=getClient(_0x478ccb['id'])[_0x7dbfa8(0x1e1)],_0x5495ef=getClient(_0x478ccb['id'])[_0x7dbfa8(0x234)];_0x478ccb['on'](_0x7dbfa8(0x115),(_0x254602,_0x5392e9)=>{const _0x2ae92b=_0x7dbfa8;if(validateAccess(_0x5392e9,_0x5495ef)[_0x2ae92b(0x21a)]){if(pid[_0x767536])pid[_0x767536][_0x2ae92b(0x239)]({'function':'emitHistory','args':_0x254602});}else logger[_0x2ae92b(0x20a)](_0x2ae92b(0x181));}),_0x478ccb['on'](_0x7dbfa8(0x81),(_0x1b1f91,_0x233c62)=>{const _0x41345d=_0x7dbfa8;if(validateAccess(_0x233c62,_0x5495ef)['allow']){if(pid[_0x767536])pid[_0x767536][_0x41345d(0x239)]({'function':_0x41345d(0x171),'args':_0x1b1f91});}else logger[_0x41345d(0x20a)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x478ccb['on'](_0x7dbfa8(0x116),(_0x4be719,_0x53e29d)=>{const _0x2cfa25=_0x7dbfa8;if(validateAccess(_0x53e29d,_0x5495ef)[_0x2cfa25(0x21a)]){if(pid[_0x767536])pid[_0x767536]['send']({'function':_0x2cfa25(0x1e8),'args':_0x4be719});}else logger[_0x2cfa25(0x20a)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x478ccb['on'](_0x7dbfa8(0x20e),(_0x111979,_0x496185)=>{const _0x4612de=_0x7dbfa8;if(validateAccess(_0x496185,_0x5495ef)['allow']){if(pid[_0x767536])pid[_0x767536][_0x4612de(0x239)]({'function':'storeConfiguration','args':_0x111979});}else logger['full'](_0x4612de(0x21c));}),_0x478ccb['on']('store-headless',(_0x9272d9,_0x62e5fa)=>{const _0x4a0866=_0x7dbfa8;if(validateAccess(_0x62e5fa,_0x5495ef)[_0x4a0866(0x21a)]){if(pid[_0x767536])pid[_0x767536][_0x4a0866(0x239)]({'function':_0x4a0866(0x75),'args':_0x9272d9});}else logger['full'](_0x4a0866(0x1b1));}),_0x478ccb['on'](_0x7dbfa8(0x109),(_0x30916e,_0x2ed629)=>{const _0x4a6d8a=_0x7dbfa8;if(validateAccess(_0x2ed629,_0x5495ef)[_0x4a6d8a(0x21a)]){if(pid[_0x767536])pid[_0x767536]['send']({'function':_0x4a6d8a(0x122),'args':_0x30916e});}else logger[_0x4a6d8a(0x20a)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x478ccb['on']('reset-history',_0x51ab38=>{const _0x40db34=_0x7dbfa8;if(validateAccess(_0x51ab38,_0x5495ef)[_0x40db34(0x21a)]){if(pid[_0x767536])pid[_0x767536][_0x40db34(0x239)]({'function':_0x40db34(0x226),'args':null});}else logger[_0x40db34(0x20a)](_0x40db34(0x134));}),_0x478ccb['on']('get-starting-balances',_0x3fe069=>{const _0x5919ea=_0x7dbfa8;if(validateAccess(_0x3fe069,_0x5495ef)[_0x5919ea(0x21a)]){if(pid[_0x767536])pid[_0x767536]['send']({'function':_0x5919ea(0x1ed),'args':null});}else logger[_0x5919ea(0x20a)](_0x5919ea(0x175));}),_0x478ccb['on'](_0x7dbfa8(0x1cb),(_0x4fc695,_0xd7dee5)=>{const _0x5986ec=_0x7dbfa8;if(validateAccess(_0xd7dee5,_0x5495ef)['allow']){if(pid[_0x767536])pid[_0x767536][_0x5986ec(0x239)]({'function':_0x5986ec(0x19a),'args':_0x4fc695});}else logger[_0x5986ec(0x20a)](_0x5986ec(0x23d));}),_0x478ccb['on']('cancel-loading',_0x56e2c4=>{const _0x5de5c4=_0x7dbfa8;if(validateAccess(_0x56e2c4,_0x5495ef)[_0x5de5c4(0x21a)]){if(pid[_0x767536])pid[_0x767536]['send']({'function':'cancelLoading','args':null});}else logger[_0x5de5c4(0x20a)](_0x5de5c4(0xd7));}),_0x478ccb['on'](_0x7dbfa8(0x113),_0x5b6364=>{const _0x2a97c7=_0x7dbfa8;if(validateAccess(_0x5b6364,_0x5495ef)['allow']){if(pid[_0x767536])pid[_0x767536]['send']({'function':_0x2a97c7(0x17a),'args':null});}else logger[_0x2a97c7(0x20a)](_0x2a97c7(0x1d5));}),_0x478ccb['on'](_0x7dbfa8(0x90),_0x480039=>{const _0x2fbbbb=_0x7dbfa8;if(validateAccess(_0x480039,_0x5495ef)[_0x2fbbbb(0x21a)])updateBB('update');else logger['full'](_0x2fbbbb(0x16a));}),_0x478ccb['on'](_0x7dbfa8(0x23e),_0x556101=>{const _0x219d21=_0x7dbfa8;if(validateAccess(_0x556101,_0x5495ef)[_0x219d21(0x21a)])getMessages();else logger[_0x219d21(0x20a)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x478ccb['on'](_0x7dbfa8(0x89),(_0x27b6f6,_0x44d9de)=>{const _0x4de17c=_0x7dbfa8;if(validateAccess(_0x44d9de,_0x5495ef)[_0x4de17c(0x21a)])confirmMessage(_0x27b6f6);else logger[_0x4de17c(0x20a)](_0x4de17c(0x72));}),_0x478ccb['on'](_0x7dbfa8(0x17e),_0x4d4da9=>{const _0x1c6b48=_0x7dbfa8;if(validateAccess(_0x4d4da9,_0x5495ef)['allow']){if(devices[_0x5495ef][_0x1c6b48(0x1a9)])clearTimeout(devices[_0x5495ef][_0x1c6b48(0x1a9)]);if(devices[_0x5495ef][_0x1c6b48(0x91)])clearTimeout(devices[_0x5495ef][_0x1c6b48(0x91)]);removeSocketListeners(getClient(_0x478ccb['id'])['uuid']),addBlacklist(_0x5495ef),devices[_0x5495ef][_0x1c6b48(0xdc)]=null,devices[_0x5495ef]['telegram2FaApproval']=null,devices[_0x5495ef][_0x1c6b48(0x145)]['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x5495ef[_0x1c6b48(0x9e)](-0x8)),io['to'](getClient(_0x478ccb['id'])[_0x1c6b48(0x234)])[_0x1c6b48(0x203)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x1c6b48(0x20a)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x277a95){const _0x3ab95b=_0x3cef30;getClientsWithUuid(_0x277a95)[_0x3ab95b(0x119)](_0x27f082=>{const _0x486786=_0x3ab95b;getSocket(_0x27f082['id'])[_0x486786(0x11d)]();});}function cleanSettings(){const _0x38899c=_0x3cef30;let _0x4d3706=settings;return settings['telegramToken']&&settings[_0x38899c(0xcc)]!=''&&(_0x4d3706={..._0x4d3706,'telegramToken':_0x38899c(0xb3)}),settings['bbPassword']&&settings[_0x38899c(0x1df)]!=''&&(_0x4d3706={..._0x4d3706,'bbPassword':_0x38899c(0xb3)}),(settings[_0x38899c(0x1df)]&&settings[_0x38899c(0x1df)]==_0x38899c(0xac)||settings[_0x38899c(0xcc)]&&settings['telegramToken']==_0x38899c(0xac))&&(_0x4d3706={..._0x4d3706,'restored':{'password':settings[_0x38899c(0x1df)]==_0x38899c(0xac),'telegram':settings['telegramToken']==_0x38899c(0xac)}}),_0x4d3706;}async function updateBB(_0x5cdbc0){const _0x3718a9=_0x3cef30;await backupConfigFiles(),installingUpdate=!![],config[_0x3718a9(0x119)](_0x5b5430=>{const _0x5a0a9c=_0x3718a9;restartBot(_0x5b5430[_0x5a0a9c(0xe0)]);}),logger['debug'](_0x3718a9(0x12c)+_0x5cdbc0);if(_0x5cdbc0==_0x3718a9(0x10e))process[_0x3718a9(0x239)]({'update':!![]},_0x1f193d=>{});else _0x5cdbc0==_0x3718a9(0xe8)&&process[_0x3718a9(0x239)]({'reinstall':!![]},_0x374448=>{});}function startBot(_0x170836,_0x45f4c7,_0x987223){const _0x5dc343=_0x3cef30;if(debugging)_0x170836[_0x5dc343(0x214)]('-d');let _0x2113dc=![];const _0x440b5c=_0x170836[0x0];_0x45f4c7={..._0x45f4c7,'stdio':[_0x5dc343(0x10c),'inherit',_0x5dc343(0x10c),_0x5dc343(0x153)]},pid[_0x440b5c]=childProcess[_0x5dc343(0x8c)](botfile,_0x170836,_0x45f4c7),pid[_0x440b5c]['on'](_0x5dc343(0x172),_0x2ad0be=>{const _0x3b412b=_0x5dc343;switch(Object[_0x3b412b(0x1f6)](_0x2ad0be)[0x0]){case _0x3b412b(0x1c5):updateBotName(_0x440b5c,_0x2ad0be[_0x3b412b(0x1c5)]);break;case _0x3b412b(0x1ff):updateBotManager();break;case _0x3b412b(0x163):updateStatus(_0x440b5c,_0x2ad0be[_0x3b412b(0x163)]);break;case _0x3b412b(0xe6):updateLive(_0x440b5c,_0x2ad0be[_0x3b412b(0xe6)]);break;case _0x3b412b(0x1a7):updateLive(_0x440b5c,_0x2ad0be[_0x3b412b(0x1a7)]),io['to'](_0x440b5c)[_0x3b412b(0x203)](_0x3b412b(0x163),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3b412b(0x189):_0x2ad0be[_0x3b412b(0x189)]==_0x3b412b(0x165)&&restartBot(_0x440b5c);_0x2ad0be[_0x3b412b(0x189)]==_0x3b412b(0x106)&&toggleBot(_0x440b5c,_0x3b412b(0x11f),'stopped');break;case _0x3b412b(0x1d6):sendTelegram(_0x440b5c,_0x2ad0be[_0x3b412b(0x1d6)]);break;case'telegrammsg':sendTelegramMsg(_0x2ad0be[_0x3b412b(0x195)]);break;case'function':io['to'](_0x440b5c)[_0x3b412b(0x203)](_0x2ad0be[_0x3b412b(0x1db)],_0x2ad0be[_0x3b412b(0x11c)]);break;}}),pid[_0x440b5c]['on']('error',function(_0x497b8e){if(_0x2113dc)return;_0x2113dc=!![],_0x987223(_0x497b8e);}),pid[_0x440b5c]['on']('exit',async function(_0x400863){const _0x226dc8=_0x5dc343;if(installingUpdate)return;if(_0x2113dc)return;_0x2113dc=!![],_0x987223(null);const _0x522fa6=dbConfig['get'](_0x226dc8(0x208))[_0x226dc8(0x19c)]({'botID':_0x440b5c})[_0x226dc8(0x1bf)]();_0x522fa6&&(_0x522fa6[_0x226dc8(0x163)]==_0x226dc8(0xf4)||_0x522fa6[_0x226dc8(0x163)]==_0x226dc8(0x215))&&(await sleep(0x3e8),updateLive(_0x440b5c,_0x226dc8(0x185)),logger[_0x226dc8(0x20a)](_0x226dc8(0xd4)+_0x440b5c),startBot([_0x440b5c,userID],{'cwd':bbpath},function(_0x155868){const _0x15fb3e=_0x226dc8;if(_0x155868)logger[_0x15fb3e(0x20a)](_0x155868);}));});}function stopBot(_0x102aed){const _0x134ed8=_0x3cef30;getClientsWithBotID(_0x102aed)['forEach'](_0x52b245=>{const _0x568d2f=_0x582a;getSocket(_0x52b245['id'])[_0x568d2f(0x200)](!![]),removeClient(_0x52b245['id']);}),pid[_0x102aed]&&(pid[_0x102aed][_0x134ed8(0x106)](),pid[_0x102aed]=null);}function restartBot(_0x449487){const _0x1aad2c=_0x3cef30;if(pid[_0x449487])pid[_0x449487][_0x1aad2c(0x106)]();}function addBot(){const _0x197154=_0x3cef30;let _0x1ede18;for(let _0x3d22e7=0x1;_0x3d22e7<0x3e9;_0x3d22e7++){_0x1ede18=_0x3d22e7['toString']()[_0x197154(0x22e)](0x3,'0');let _0x371c48=config[_0x197154(0x19c)](_0xdab1cd=>_0xdab1cd[_0x197154(0xe0)]==_0x1ede18);if(!_0x371c48)break;}if(_0x1ede18===_0x197154(0x15c)){logger[_0x197154(0x20a)](_0x197154(0x170));return;}logger[_0x197154(0x20a)](_0x197154(0x9a)+_0x1ede18),dbConfig['get'](_0x197154(0x208))['push']({'botID':_0x1ede18,'botname':'Bot\x20'+_0x1ede18,'status':_0x197154(0x215),'live':''})['write'](),startBot([_0x1ede18,userID],{'cwd':bbpath},function(_0x3619ba){const _0x20d877=_0x197154;if(_0x3619ba)logger[_0x20d877(0x20a)](_0x3619ba);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x197154(0x208),config),broadcastToBots(_0x197154(0x208),JSON[_0x197154(0x1c3)](config));}function deleteBot(_0x5e9b7c){const _0x51c53a=_0x3cef30;getClientsWithBotID(_0x5e9b7c)[_0x51c53a(0x119)](_0x180c33=>{getSocket(_0x180c33['id'])['disconnect'](!![]),removeClient(_0x180c33['id']);}),dbConfig[_0x51c53a(0x123)]('bots')[_0x51c53a(0x191)]({'botID':_0x5e9b7c})[_0x51c53a(0x14e)](),logger[_0x51c53a(0x20a)](_0x51c53a(0x158)+_0x5e9b7c),stopBot(_0x5e9b7c);try{if(fs[_0x51c53a(0x192)](path[_0x51c53a(0x1b0)](configpath,_0x51c53a(0x164)+_0x5e9b7c+_0x51c53a(0x199))))fs['unlinkSync'](path[_0x51c53a(0x1b0)](configpath,'bot-'+_0x5e9b7c+_0x51c53a(0x199)));if(fs['existsSync'](path[_0x51c53a(0x1b0)](configpath,_0x51c53a(0x164)+_0x5e9b7c+_0x51c53a(0x1f4))))fs[_0x51c53a(0x21f)](path[_0x51c53a(0x1b0)](configpath,_0x51c53a(0x164)+_0x5e9b7c+_0x51c53a(0x1f4)));if(fs[_0x51c53a(0x192)](path[_0x51c53a(0x1b0)](configpath,'bot-'+_0x5e9b7c+_0x51c53a(0xa4))))fs[_0x51c53a(0x21f)](path[_0x51c53a(0x1b0)](configpath,_0x51c53a(0x164)+_0x5e9b7c+_0x51c53a(0xa4)));if(fs['existsSync'](path[_0x51c53a(0x1b0)](configpath,_0x51c53a(0x164)+_0x5e9b7c+_0x51c53a(0x230))))fs[_0x51c53a(0x21f)](path[_0x51c53a(0x1b0)](configpath,_0x51c53a(0x164)+_0x5e9b7c+_0x51c53a(0x230)));}catch(_0x48f5ff){if(_0x48f5ff)logger[_0x51c53a(0x20a)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x48f5ff);}config=getConfiguration(),io['to'](_0x51c53a(0x1e2))[_0x51c53a(0x203)](_0x51c53a(0x208),config),broadcastToBots('bots',JSON[_0x51c53a(0x1c3)](config));}function toggleBot(_0x18b1b8,_0x330cc5,_0x5c28cc){const _0x34cf93=_0x3cef30;dbConfig['get'](_0x34cf93(0x208))[_0x34cf93(0x19c)]({'botID':_0x18b1b8})[_0x34cf93(0xe2)]({'status':_0x330cc5})['assign']({'live':_0x5c28cc})[_0x34cf93(0x14e)]();if(_0x330cc5==_0x34cf93(0xf4)||_0x330cc5=='new')logger[_0x34cf93(0x20a)](_0x34cf93(0x154)+_0x18b1b8),startBot([_0x18b1b8,userID],{'cwd':bbpath},function(_0x19cf58){const _0x3fa5f5=_0x34cf93;if(_0x19cf58)logger[_0x3fa5f5(0x20a)](_0x19cf58);});else(_0x330cc5==_0x34cf93(0x11f)||_0x330cc5=='new-disabled')&&(logger['full']('Disabled\x20Bot\x20'+_0x18b1b8),stopBot(_0x18b1b8));config=getConfiguration(),io['to'](_0x34cf93(0x1e2))['emit'](_0x34cf93(0x208),config),broadcastToBots(_0x34cf93(0x208),JSON['stringify'](config));}function toggleStatus(_0x1d7d2b){const _0x173525=_0x3cef30;let _0x257d8e=dbConfig[_0x173525(0x123)]('bots')['find']({'botID':_0x1d7d2b})['value'](),_0x1126f7;if(_0x257d8e[_0x173525(0x163)]==='enabled')_0x1126f7=_0x173525(0x11f);else{if(_0x257d8e[_0x173525(0x163)]===_0x173525(0x215))_0x1126f7=_0x173525(0xa2);else{if(_0x257d8e[_0x173525(0x163)]===_0x173525(0xa2))_0x1126f7='new';else{if(_0x257d8e['status']===_0x173525(0x11f))_0x1126f7=_0x173525(0xf4);}}}return _0x1126f7;}function updateStatus(_0x5c95c9,_0x594980){const _0x41680d=_0x3cef30;dbConfig['get'](_0x41680d(0x208))[_0x41680d(0x19c)]({'botID':_0x5c95c9})['assign']({'status':_0x594980})['write'](),config=getConfiguration(),io['to'](_0x41680d(0x1e2))[_0x41680d(0x203)]('bots',config),broadcastToBots(_0x41680d(0x208),JSON[_0x41680d(0x1c3)](config));}function updateLive(_0x1fb7de,_0x5833ab){const _0x4651fe=_0x3cef30;dbConfig['get']('bots')[_0x4651fe(0x19c)]({'botID':_0x1fb7de})[_0x4651fe(0xe2)]({'live':_0x5833ab})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x4651fe(0x203)](_0x4651fe(0x208),config),broadcastToBots(_0x4651fe(0x208),JSON[_0x4651fe(0x1c3)](config));}function updateBotName(_0x4c1df1,_0x5cae6b){const _0xcac1ef=_0x3cef30;dbConfig[_0xcac1ef(0x123)](_0xcac1ef(0x208))[_0xcac1ef(0x19c)]({'botID':_0x4c1df1})['assign']({'botname':_0x5cae6b})[_0xcac1ef(0x14e)](),config=getConfiguration(),io['to']('botmanager')[_0xcac1ef(0x203)](_0xcac1ef(0x208),config),broadcastToBots(_0xcac1ef(0x208),JSON[_0xcac1ef(0x1c3)](config));}function updateBotManager(){const _0x5f30a5=_0x3cef30;config=getConfiguration(),io['to']('botmanager')[_0x5f30a5(0x203)](_0x5f30a5(0x208),config),broadcastToBots(_0x5f30a5(0x208),JSON[_0x5f30a5(0x1c3)](config));}function toggleBotMode(_0x2c3615){const _0x405e7d=_0x3cef30;if(pid[_0x2c3615])pid[_0x2c3615][_0x405e7d(0x239)]({'function':_0x405e7d(0xe5),'args':null});else{const _0x4787db=configpath+_0x405e7d(0x164)+_0x2c3615+_0x405e7d(0x199),_0x35cd75=fs[_0x405e7d(0x7f)](_0x4787db),_0x4c9b49=JSON['parse'](_0x35cd75),_0x429a26=_0x4c9b49[_0x405e7d(0x1e1)][0x0]['headless'];_0x4c9b49[_0x405e7d(0x1e1)][0x0][_0x405e7d(0x13a)]=!_0x429a26;const _0x1164e5=JSON['stringify'](_0x4c9b49,null,0x2);fs[_0x405e7d(0xc4)](_0x4787db,_0x1164e5),config=getConfiguration(),io['to'](_0x405e7d(0x1e2))[_0x405e7d(0x203)](_0x405e7d(0x208),config),broadcastToBots(_0x405e7d(0x208),JSON[_0x405e7d(0x1c3)](config));}}function telegramError(_0x11b583){const _0x163c95=_0x3cef30;logger[_0x163c95(0xc9)](getTimeStamp()+_0x163c95(0x1a4));}function validateTelegram(_0x386a02){const _0x305b78=_0x3cef30;if(_0x386a02['from'][_0x305b78(0xc5)]!=settings[_0x305b78(0xed)]&&'@'+_0x386a02[_0x305b78(0x78)][_0x305b78(0xc5)]!=settings[_0x305b78(0xed)])return tgBot['sendMessage'](_0x386a02[_0x305b78(0x1e6)]['id'],_0x305b78(0xa0),{'parse_mode':_0x305b78(0x22f)})['catch'](_0x2d1fce=>{telegramError(_0x2d1fce);}),![];return!![];}async function initTelegram(){const _0x51078d=_0x3cef30;if(tgBot)tgBot[_0x51078d(0xd3)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x51078d(0xcc)],{'polling':!![]});let _0x1a6de2=_0x51078d(0x147);_0x1a6de2+='\x0a',_0x1a6de2+=_0x51078d(0xb0),_0x1a6de2+=_0x51078d(0xab),_0x1a6de2+=_0x51078d(0x1c7),_0x1a6de2+=_0x51078d(0x14f),_0x1a6de2+=_0x51078d(0x8a),_0x1a6de2+='/off\x20-\x20stop\x20bot(s)\x0a',_0x1a6de2+=_0x51078d(0x11a),_0x1a6de2+=_0x51078d(0x15b),_0x1a6de2+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1a6de2+=_0x51078d(0x204),_0x1a6de2+=_0x51078d(0xc7),_0x1a6de2+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1a6de2+=_0x51078d(0xdd),_0x1a6de2+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x4b3954=_0x51078d(0xa3);_0x4b3954+='\x0a',_0x4b3954+=_0x1a6de2,tgBot['onText'](/\/start/,_0x6e609d=>{const _0x3e7872=_0x51078d;if(!validateTelegram(_0x6e609d))return;if(settings[_0x3e7872(0x179)]!=_0x6e609d[_0x3e7872(0x1e6)]['id'])updateSetting(_0x3e7872(0x179),_0x6e609d[_0x3e7872(0x1e6)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x3e7872(0xde)](_0x6e609d[_0x3e7872(0x1e6)]['id'],_0x4b3954)[_0x3e7872(0x194)](_0x2b7a51=>{telegramError(_0x2b7a51);});}),tgBot['onText'](/\/enable/,_0x49ff02=>{const _0x2d8d1f=_0x51078d;if(!validateTelegram(_0x49ff02))return;if(settings[_0x2d8d1f(0x179)]!=_0x49ff02[_0x2d8d1f(0x1e6)]['id'])updateSetting('telegramChatId',_0x49ff02[_0x2d8d1f(0x1e6)]['id']);updateSetting(_0x2d8d1f(0x23f),!![]),tgBot[_0x2d8d1f(0xde)](_0x49ff02[_0x2d8d1f(0x1e6)]['id'],_0x2d8d1f(0x240))['catch'](_0x28ab61=>{telegramError(_0x28ab61);});}),tgBot['onText'](/\/config/,async _0x244536=>{const _0x17203d=_0x51078d;if(!validateTelegram(_0x244536))return;tgBot[_0x17203d(0x13e)]('callback_query'),tgBot[_0x17203d(0xde)](_0x244536[_0x17203d(0x1e6)]['id'],_0x17203d(0x212),{'reply_markup':{'inline_keyboard':[[{'text':_0x17203d(0x13d),'callback_data':'orders'},{'text':_0x17203d(0x104),'callback_data':_0x17203d(0x76)},{'text':_0x17203d(0x125),'callback_data':_0x17203d(0x23c)}]]}})[_0x17203d(0x194)](_0x344b98=>{telegramError(_0x344b98);}),tgBot['on'](_0x17203d(0x12f),async _0x26718e=>{const _0x22394c=_0x17203d,_0x4b7f91=_0x26718e[_0x22394c(0xda)],_0x4b180b=_0x26718e[_0x22394c(0x172)];tgBot['answerCallbackQuery'](_0x26718e['id'])['then'](async()=>{const _0x4d8d9d=_0x22394c;_0x4b7f91=='orders'&&(updateSetting(_0x4d8d9d(0x220),'orders'),updateSetting(_0x4d8d9d(0x23f),!![]),await tgBot[_0x4d8d9d(0xde)](_0x4b180b[_0x4d8d9d(0x1e6)]['id'],_0x4d8d9d(0x219))[_0x4d8d9d(0x194)](_0x424416=>{telegramError(_0x424416);}));_0x4b7f91==_0x4d8d9d(0x76)&&(updateSetting(_0x4d8d9d(0x220),_0x4d8d9d(0x76)),updateSetting(_0x4d8d9d(0x23f),!![]),await tgBot[_0x4d8d9d(0xde)](_0x4b180b['chat']['id'],_0x4d8d9d(0x1c4))['catch'](_0x5b2e69=>{telegramError(_0x5b2e69);}));_0x4b7f91==_0x4d8d9d(0x23c)&&(updateSetting(_0x4d8d9d(0x220),'all'),updateSetting(_0x4d8d9d(0x23f),!![]),await tgBot[_0x4d8d9d(0xde)](_0x4b180b['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x28778c=>{telegramError(_0x28778c);}));if(!settings[_0x4d8d9d(0x179)])tgBot[_0x4d8d9d(0xde)](_0x4b180b[_0x4d8d9d(0x1e6)]['id'],_0x4d8d9d(0xfe))[_0x4d8d9d(0x194)](_0x557276=>{telegramError(_0x557276);});}),tgBot[_0x22394c(0x13e)](_0x22394c(0x12f));});}),tgBot[_0x51078d(0x14c)](/\/status/,_0xffe2cd=>{const _0x4c29cc=_0x51078d;if(!validateTelegram(_0xffe2cd))return;const _0x4a3363=getBotsWithMode();let _0x70e749=_0x4c29cc(0xf5);config[_0x4c29cc(0x119)](_0x4d4e72=>{const _0x3e1a74=_0x4c29cc,_0x1f5d96=_0x4a3363['find'](_0x2787bb=>_0x2787bb['botID']==_0x4d4e72['botID'])[_0x3e1a74(0x1ae)];_0x70e749+=_0x3e1a74(0x1eb)+_0x4d4e72[_0x3e1a74(0xe0)]+':\x20'+_0x4d4e72[_0x3e1a74(0x163)]+'\x20|\x20'+_0x1f5d96+_0x3e1a74(0xeb)+_0x4d4e72['live']+'\x0a';}),_0x70e749+='\x0a',_0x70e749+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x70e749+=!settings[_0x4c29cc(0x23f)]?_0x4c29cc(0x16c):_0x4c29cc(0x160),_0x70e749+=settings[_0x4c29cc(0x23f)]?settings[_0x4c29cc(0x220)]==_0x4c29cc(0x23c)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x4c29cc(0x14d)+settings['telegramEvents']+_0x4c29cc(0x1d0):'',tgBot['sendMessage'](_0xffe2cd[_0x4c29cc(0x1e6)]['id'],_0x70e749,{'parse_mode':_0x4c29cc(0x22f)})['catch'](_0x16d1e9=>{telegramError(_0x16d1e9);});}),tgBot[_0x51078d(0x14c)](/\/restart/,_0x505b6c=>{const _0x5af3ea=_0x51078d;if(!validateTelegram(_0x505b6c))return;tgBot[_0x5af3ea(0x13e)](_0x5af3ea(0x12f));const _0x2d94ef=getEnabledBots();if(_0x2d94ef[_0x5af3ea(0x1f7)]==0x0)tgBot[_0x5af3ea(0xde)](_0x505b6c['chat']['id'],_0x5af3ea(0x12b))[_0x5af3ea(0x194)](_0x4622b9=>{telegramError(_0x4622b9);});else{if(_0x2d94ef[_0x5af3ea(0x1f7)]>0x1)_0x2d94ef[_0x5af3ea(0x214)]({'botID':_0x5af3ea(0x23c)});let _0x481cf6=[],_0x4ce520=[];const _0xee601d=_0x2d94ef[_0x5af3ea(0x1f7)]%0x4==0x0||_0x2d94ef[_0x5af3ea(0x1f7)]%0x4==0x3||_0x2d94ef[_0x5af3ea(0x1f7)]%0x3==0x1?0x4:0x3;let _0x3dcdc1=0x0;_0x2d94ef[_0x5af3ea(0x119)]((_0x19040b,_0x273eef)=>{const _0x3b9783=_0x5af3ea;if(_0x273eef%_0xee601d==0x0)_0x4ce520=[];_0x4ce520['push']({'text':_0x19040b[_0x3b9783(0xe0)]=='all'?_0x3b9783(0x11b):_0x3b9783(0x1eb)+_0x19040b[_0x3b9783(0xe0)],'callback_data':_0x19040b[_0x3b9783(0xe0)]}),_0x273eef%_0xee601d==0x0&&(_0x481cf6[_0x3dcdc1]=_0x4ce520,_0x3dcdc1++);}),tgBot[_0x5af3ea(0xde)](_0x505b6c[_0x5af3ea(0x1e6)]['id'],_0x5af3ea(0x186),{'reply_markup':{'inline_keyboard':_0x481cf6}})[_0x5af3ea(0x194)](_0x1f03ba=>{telegramError(_0x1f03ba);}),tgBot['on'](_0x5af3ea(0x12f),async _0x1dd3db=>{const _0x37efe0=_0x5af3ea,_0xc491af=_0x1dd3db[_0x37efe0(0xda)],_0x1feafd=_0x1dd3db[_0x37efe0(0x172)];tgBot[_0x37efe0(0xb1)](_0x1dd3db['id'])[_0x37efe0(0x1e5)](async()=>{const _0x469185=_0x37efe0;_0xc491af==_0x469185(0x23c)?config['forEach'](_0xf4e8b1=>{const _0x410919=_0x469185;restartBot(_0xf4e8b1[_0x410919(0xe0)]);}):restartBot(_0xc491af);}),tgBot[_0x37efe0(0x13e)]('callback_query');});}}),tgBot[_0x51078d(0x14c)](/\/on/,_0x54b01c=>{const _0x397cff=_0x51078d;if(!validateTelegram(_0x54b01c))return;tgBot['removeListener'](_0x397cff(0x12f));const _0x10bde4=getDisabledBots();if(_0x10bde4['length']==0x0)tgBot[_0x397cff(0xde)](_0x54b01c[_0x397cff(0x1e6)]['id'],_0x397cff(0x248))[_0x397cff(0x194)](_0x582774=>{telegramError(_0x582774);});else{if(_0x10bde4[_0x397cff(0x1f7)]>0x1)_0x10bde4[_0x397cff(0x214)]({'botID':_0x397cff(0x23c)});let _0x3954a8=[],_0x3a2339=[];const _0x506731=_0x10bde4[_0x397cff(0x1f7)]%0x4==0x0||_0x10bde4['length']%0x4==0x3||_0x10bde4[_0x397cff(0x1f7)]%0x3==0x1?0x4:0x3;let _0x4cc7ea=0x0;_0x10bde4[_0x397cff(0x119)]((_0x51e853,_0x4fe22a)=>{const _0x34ecab=_0x397cff;if(_0x4fe22a%_0x506731==0x0)_0x3a2339=[];_0x3a2339['push']({'text':_0x51e853[_0x34ecab(0xe0)]==_0x34ecab(0x23c)?_0x34ecab(0x11b):_0x34ecab(0x1eb)+_0x51e853[_0x34ecab(0xe0)],'callback_data':_0x51e853['botID']}),_0x4fe22a%_0x506731==0x0&&(_0x3954a8[_0x4cc7ea]=_0x3a2339,_0x4cc7ea++);}),tgBot[_0x397cff(0xde)](_0x54b01c['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x3954a8}})[_0x397cff(0x194)](_0x2aa029=>{telegramError(_0x2aa029);}),tgBot['on'](_0x397cff(0x12f),async _0x144cc4=>{const _0x5a47eb=_0x397cff,_0x257804=_0x144cc4[_0x5a47eb(0xda)],_0x24480d=_0x144cc4[_0x5a47eb(0x172)];tgBot[_0x5a47eb(0xb1)](_0x144cc4['id'])['then'](async()=>{const _0x20c562=_0x5a47eb;_0x257804==_0x20c562(0x23c)?(tgBot[_0x20c562(0xde)](_0x24480d[_0x20c562(0x1e6)]['id'],_0x20c562(0x127))['catch'](_0x39f166=>{telegramError(_0x39f166);}),_0x10bde4[_0x20c562(0x119)](_0xac821a=>{const _0x35aafa=_0x20c562;if(_0xac821a[_0x35aafa(0xe0)]!=_0x35aafa(0x23c))toggleBot(_0xac821a['botID'],toggleStatus(_0xac821a[_0x35aafa(0xe0)]),_0x35aafa(0x185));})):(tgBot[_0x20c562(0xde)](_0x24480d[_0x20c562(0x1e6)]['id'],_0x20c562(0xe9)+_0x257804)[_0x20c562(0x194)](_0x309766=>{telegramError(_0x309766);}),toggleBot(_0x257804,toggleStatus(_0x257804),_0x20c562(0x185)));}),tgBot[_0x5a47eb(0x13e)](_0x5a47eb(0x12f));});}}),tgBot['onText'](/\/off/,_0x2aa76e=>{const _0x471918=_0x51078d;if(!validateTelegram(_0x2aa76e))return;tgBot['removeListener']('callback_query');const _0x464c07=getEnabledBots();if(_0x464c07[_0x471918(0x1f7)]==0x0)tgBot[_0x471918(0xde)](_0x2aa76e[_0x471918(0x1e6)]['id'],_0x471918(0x12b))[_0x471918(0x194)](_0x3c5d49=>{telegramError(_0x3c5d49);});else{if(_0x464c07[_0x471918(0x1f7)]>0x1)_0x464c07['push']({'botID':_0x471918(0x23c)});let _0x44d891=[],_0x4ca34d=[];const _0x42ca87=_0x464c07[_0x471918(0x1f7)]%0x4==0x0||_0x464c07['length']%0x4==0x3||_0x464c07['length']%0x3==0x1?0x4:0x3;let _0x2b599f=0x0;_0x464c07[_0x471918(0x119)]((_0x198070,_0x6ef85a)=>{const _0xba92de=_0x471918;if(_0x6ef85a%_0x42ca87==0x0)_0x4ca34d=[];_0x4ca34d[_0xba92de(0x214)]({'text':_0x198070[_0xba92de(0xe0)]==_0xba92de(0x23c)?_0xba92de(0x11b):_0xba92de(0x1eb)+_0x198070[_0xba92de(0xe0)],'callback_data':_0x198070['botID']}),_0x6ef85a%_0x42ca87==0x0&&(_0x44d891[_0x2b599f]=_0x4ca34d,_0x2b599f++);}),tgBot[_0x471918(0xde)](_0x2aa76e[_0x471918(0x1e6)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x44d891}})[_0x471918(0x194)](_0x2721cf=>{telegramError(_0x2721cf);}),tgBot['on'](_0x471918(0x12f),async _0x2fe43a=>{const _0x3647eb=_0x471918,_0x25333b=_0x2fe43a[_0x3647eb(0xda)],_0x455cb6=_0x2fe43a[_0x3647eb(0x172)];tgBot[_0x3647eb(0xb1)](_0x2fe43a['id'])[_0x3647eb(0x1e5)](async()=>{const _0x618657=_0x3647eb;_0x25333b=='all'?(tgBot[_0x618657(0xde)](_0x455cb6['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x618657(0x194)](_0x4b3cf0=>{telegramError(_0x4b3cf0);}),_0x464c07[_0x618657(0x119)](_0x54453e=>{const _0x4f92e8=_0x618657;if(_0x54453e[_0x4f92e8(0xe0)]!=_0x4f92e8(0x23c))toggleBot(_0x54453e['botID'],toggleStatus(_0x54453e[_0x4f92e8(0xe0)]),_0x4f92e8(0x185));})):(tgBot[_0x618657(0xde)](_0x455cb6[_0x618657(0x1e6)]['id'],_0x618657(0x245)+_0x25333b)[_0x618657(0x194)](_0x3f1452=>{telegramError(_0x3f1452);}),toggleBot(_0x25333b,toggleStatus(_0x25333b),'stopped'));}),tgBot[_0x3647eb(0x13e)]('callback_query');});}}),tgBot['onText'](/\/metrics/,_0x55570d=>{const _0xed9c75=_0x51078d;if(!validateTelegram(_0x55570d))return;tgBot[_0xed9c75(0x13e)](_0xed9c75(0x12f));const _0x4ac2cd=getEnabledBots();if(_0x4ac2cd[_0xed9c75(0x1f7)]==0x0)tgBot[_0xed9c75(0xde)](_0x55570d[_0xed9c75(0x1e6)]['id'],_0xed9c75(0x12b))[_0xed9c75(0x194)](_0x51e8a1=>{telegramError(_0x51e8a1);});else{if(_0x4ac2cd[_0xed9c75(0x1f7)]>0x1){let _0x3d589b=[],_0xde7724=[];const _0x12a955=_0x4ac2cd[_0xed9c75(0x1f7)]%0x4==0x0||_0x4ac2cd['length']%0x4==0x3||_0x4ac2cd[_0xed9c75(0x1f7)]%0x3==0x1?0x4:0x3;let _0x1c4b6e=0x0;_0x4ac2cd[_0xed9c75(0x119)]((_0x3612a3,_0xd2e1f6)=>{const _0x2b4a9b=_0xed9c75;if(_0xd2e1f6%_0x12a955==0x0)_0xde7724=[];_0xde7724[_0x2b4a9b(0x214)]({'text':'Bot\x20'+_0x3612a3[_0x2b4a9b(0xe0)],'callback_data':_0x3612a3[_0x2b4a9b(0xe0)]}),_0xd2e1f6%_0x12a955==0x0&&(_0x3d589b[_0x1c4b6e]=_0xde7724,_0x1c4b6e++);}),tgBot[_0xed9c75(0xde)](_0x55570d['chat']['id'],_0xed9c75(0x1bc),{'reply_markup':{'inline_keyboard':_0x3d589b}})[_0xed9c75(0x194)](_0x56f92f=>{telegramError(_0x56f92f);}),tgBot['on'](_0xed9c75(0x12f),async _0x55fa87=>{const _0x108dde=_0xed9c75,_0x1cca19=_0x55fa87[_0x108dde(0xda)],_0x567f43=_0x55fa87['message'];tgBot[_0x108dde(0xb1)](_0x55fa87['id'])[_0x108dde(0x1e5)](async()=>{const _0xbb56ad=_0x108dde;if(pid[_0x1cca19])pid[_0x1cca19][_0xbb56ad(0x239)]({'function':_0xbb56ad(0x227),'args':null});}),tgBot[_0x108dde(0x13e)](_0x108dde(0x12f));});}else{const _0x3ebc82=_0x4ac2cd[0x0][_0xed9c75(0xe0)];if(pid[_0x3ebc82])pid[_0x3ebc82]['send']({'function':_0xed9c75(0x227),'args':null});}}}),tgBot[_0x51078d(0x14c)](/\/portfolio/,_0x8f4501=>{const _0x390c62=_0x51078d;if(!validateTelegram(_0x8f4501))return;tgBot['removeListener']('callback_query');const _0x494db9=getEnabledBots();if(_0x494db9[_0x390c62(0x1f7)]==0x0)tgBot[_0x390c62(0xde)](_0x8f4501[_0x390c62(0x1e6)]['id'],_0x390c62(0x12b))[_0x390c62(0x194)](_0x236936=>{telegramError(_0x236936);});else{if(_0x494db9[_0x390c62(0x1f7)]>0x1){let _0x52d3a4=[],_0x559ca6=[];const _0x508e33=_0x494db9[_0x390c62(0x1f7)]%0x4==0x0||_0x494db9[_0x390c62(0x1f7)]%0x4==0x3||_0x494db9[_0x390c62(0x1f7)]%0x3==0x1?0x4:0x3;let _0x527a7c=0x0;_0x494db9['forEach']((_0x5c38a0,_0xfc6a)=>{const _0x5398e5=_0x390c62;if(_0xfc6a%_0x508e33==0x0)_0x559ca6=[];_0x559ca6[_0x5398e5(0x214)]({'text':_0x5398e5(0x1eb)+_0x5c38a0[_0x5398e5(0xe0)],'callback_data':_0x5c38a0[_0x5398e5(0xe0)]}),_0xfc6a%_0x508e33==0x0&&(_0x52d3a4[_0x527a7c]=_0x559ca6,_0x527a7c++);}),tgBot[_0x390c62(0xde)](_0x8f4501['chat']['id'],_0x390c62(0x1d1),{'reply_markup':{'inline_keyboard':_0x52d3a4}})[_0x390c62(0x194)](_0x338654=>{telegramError(_0x338654);}),tgBot['on'](_0x390c62(0x12f),async _0x245281=>{const _0x2c2d93=_0x390c62,_0x231917=_0x245281['data'],_0x2a0e06=_0x245281[_0x2c2d93(0x172)];tgBot[_0x2c2d93(0xb1)](_0x245281['id'])[_0x2c2d93(0x1e5)](async()=>{const _0x1f3e9c=_0x2c2d93;if(pid[_0x231917])pid[_0x231917][_0x1f3e9c(0x239)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['removeListener'](_0x2c2d93(0x12f));});}else{const _0x1d1c43=_0x494db9[0x0][_0x390c62(0xe0)];if(pid[_0x1d1c43])pid[_0x1d1c43]['send']({'function':_0x390c62(0x7c),'args':null});}}}),tgBot['onText'](/\/update/,async _0x2fb43f=>{const _0x47cfe5=_0x51078d;if(!validateTelegram(_0x2fb43f))return;tgBot[_0x47cfe5(0x13e)](_0x47cfe5(0x12f)),await getMessages();if(!updateAvailable)tgBot[_0x47cfe5(0xde)](_0x2fb43f[_0x47cfe5(0x1e6)]['id'],_0x47cfe5(0x13f))[_0x47cfe5(0x194)](_0x331e8b=>{telegramError(_0x331e8b);});else!validInstallation?tgBot['sendMessage'](_0x2fb43f[_0x47cfe5(0x1e6)]['id'],_0x47cfe5(0xc3))['catch'](_0x48a161=>{telegramError(_0x48a161);}):(tgBot['sendMessage'](_0x2fb43f[_0x47cfe5(0x1e6)]['id'],_0x47cfe5(0x108),{'reply_markup':{'inline_keyboard':[[{'text':_0x47cfe5(0x23a),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x47cfe5(0x194)](_0x454eca=>{telegramError(_0x454eca);}),tgBot['on']('callback_query',async _0x1cf01d=>{const _0xce423a=_0x47cfe5,_0x48431b=_0x1cf01d[_0xce423a(0xda)],_0x56024c=_0x1cf01d[_0xce423a(0x172)];tgBot[_0xce423a(0xb1)](_0x1cf01d['id'])[_0xce423a(0x1e5)](async()=>{const _0x49d4ef=_0xce423a;_0x48431b==_0x49d4ef(0x10b)&&(await tgBot['sendMessage'](_0x56024c[_0x49d4ef(0x1e6)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x49d4ef(0x194)](_0x37a35a=>{telegramError(_0x37a35a);}),updateBB('update')),_0x48431b=='no'&&await tgBot[_0x49d4ef(0xde)](_0x56024c[_0x49d4ef(0x1e6)]['id'],_0x49d4ef(0x1e4))[_0x49d4ef(0x194)](_0x5bec96=>{telegramError(_0x5bec96);});}),tgBot['removeListener'](_0xce423a(0x12f));}));}),tgBot['onText'](/\/reinstall/,async _0xbf4207=>{const _0x47adf9=_0x51078d;if(!validateTelegram(_0xbf4207))return;tgBot['removeListener']('callback_query'),!validInstallation?tgBot[_0x47adf9(0xde)](_0xbf4207[_0x47adf9(0x1e6)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x47adf9(0x194)](_0x3c6c2f=>{telegramError(_0x3c6c2f);}):(tgBot['sendMessage'](_0xbf4207['chat']['id'],_0x47adf9(0x18b),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x47adf9(0x10b)},{'text':'No','callback_data':'no'}]]}})[_0x47adf9(0x194)](_0x4c744=>{telegramError(_0x4c744);}),tgBot['on'](_0x47adf9(0x12f),async _0x3e3e8a=>{const _0x3c959d=_0x47adf9,_0x4b14b4=_0x3e3e8a['data'],_0x2a9104=_0x3e3e8a[_0x3c959d(0x172)];tgBot[_0x3c959d(0xb1)](_0x3e3e8a['id'])[_0x3c959d(0x1e5)](async()=>{const _0x174501=_0x3c959d;_0x4b14b4==_0x174501(0x10b)&&(await tgBot[_0x174501(0xde)](_0x2a9104[_0x174501(0x1e6)]['id'],_0x174501(0xee))[_0x174501(0x194)](_0x2a868b=>{telegramError(_0x2a868b);}),updateBB(_0x174501(0xe8))),_0x4b14b4=='no'&&await tgBot['sendMessage'](_0x2a9104[_0x174501(0x1e6)]['id'],_0x174501(0x231))[_0x174501(0x194)](_0x42ba67=>{telegramError(_0x42ba67);});}),tgBot[_0x3c959d(0x13e)](_0x3c959d(0x12f));}));}),tgBot['onText'](/\/toggle/,_0x2ae35d=>{const _0x1f6248=_0x51078d;if(!validateTelegram(_0x2ae35d))return;tgBot[_0x1f6248(0x13e)](_0x1f6248(0x12f));const _0x574cde=getBotsWithMode();if(_0x574cde[_0x1f6248(0x1f7)]==0x0)tgBot[_0x1f6248(0xde)](_0x2ae35d[_0x1f6248(0x1e6)]['id'],_0x1f6248(0x12b))[_0x1f6248(0x194)](_0xb99254=>{telegramError(_0xb99254);});else{let _0x5cfe63=[],_0x469812=[];const _0x5bbd1a=0x2;let _0x10f5cf=0x0;_0x574cde['forEach']((_0x57fab6,_0x29a55d)=>{const _0x14bea8=_0x1f6248;if(_0x29a55d%_0x5bbd1a==0x0)_0x469812=[];_0x469812[_0x14bea8(0x214)]({'text':_0x14bea8(0x1eb)+_0x57fab6['botID']+'\x20('+_0x57fab6[_0x14bea8(0x1ae)]+')','callback_data':_0x57fab6[_0x14bea8(0xe0)]}),_0x29a55d%_0x5bbd1a==0x0&&(_0x5cfe63[_0x10f5cf]=_0x469812,_0x10f5cf++);}),tgBot[_0x1f6248(0xde)](_0x2ae35d[_0x1f6248(0x1e6)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x5cfe63}})['catch'](_0x1c75de=>{telegramError(_0x1c75de);}),tgBot['on']('callback_query',async _0x166d7f=>{const _0x3ad325=_0x1f6248,_0x4572fe=_0x166d7f[_0x3ad325(0xda)],_0xdf81e5=_0x166d7f['message'];tgBot[_0x3ad325(0xb1)](_0x166d7f['id'])['then'](async()=>{const _0x544cde=_0x3ad325,_0x5c4adb=_0x574cde['find'](_0x3eb90e=>_0x3eb90e[_0x544cde(0xe0)]==_0x4572fe),_0x4c7eb0=_0x5c4adb[_0x544cde(0x1ae)]==_0x544cde(0x246)?_0x544cde(0x1ee):_0x544cde(0x246);tgBot[_0x544cde(0xde)](_0xdf81e5['chat']['id'],_0x544cde(0x213)+_0x4572fe+_0x544cde(0x126)+_0x4c7eb0+'\x20mode')[_0x544cde(0x194)](_0x15edae=>{telegramError(_0x15edae);}),toggleBotMode(_0x4572fe);}),tgBot[_0x3ad325(0x13e)](_0x3ad325(0x12f));});}}),tgBot[_0x51078d(0x14c)](/\/names/,_0x55bccb=>{const _0x25e56a=_0x51078d;if(!validateTelegram(_0x55bccb))return;let _0x4052ea='';config[_0x25e56a(0x119)](_0x3bb02b=>{const _0x2f9bdf=_0x25e56a;_0x4052ea+='Bot\x20'+_0x3bb02b[_0x2f9bdf(0xe0)]+':\x20'+_0x3bb02b[_0x2f9bdf(0x1c5)]+'\x0a';}),tgBot[_0x25e56a(0xde)](_0x55bccb['chat']['id'],_0x4052ea,{'parse_mode':'HTML'})['catch'](_0x10ae49=>{telegramError(_0x10ae49);});}),tgBot['onText'](/\/disable/,_0x25e79a=>{const _0x3b199f=_0x51078d;if(!validateTelegram(_0x25e79a))return;tgBot[_0x3b199f(0xde)](_0x25e79a[_0x3b199f(0x1e6)]['id'],_0x3b199f(0x9f))[_0x3b199f(0x194)](_0x4f3a58=>{telegramError(_0x4f3a58);}),updateSetting(_0x3b199f(0x23f),![]);}),tgBot[_0x51078d(0x14c)](/\/help/,_0x47cf69=>{const _0x40096b=_0x51078d;if(!validateTelegram(_0x47cf69))return;tgBot[_0x40096b(0xde)](_0x47cf69[_0x40096b(0x1e6)]['id'],_0x1a6de2)[_0x40096b(0x194)](_0x29d136=>{telegramError(_0x29d136);});}),tgBot['on'](_0x51078d(0x242),_0x303f09=>{const _0x56bab0=_0x51078d;_0x303f09[_0x56bab0(0xbe)]()['includes'](_0x56bab0(0xca))&&(logger[_0x56bab0(0x20a)](_0x56bab0(0x209)),tgBot[_0x56bab0(0xd3)](),tgBot=null,io['to']('botmanager')[_0x56bab0(0x203)](_0x56bab0(0x150),_0x56bab0(0x209)));}),process[_0x51078d(0x84)]('SIGINT',()=>{const _0x3e8f16=_0x51078d;if(tgBot)tgBot[_0x3e8f16(0xd3)]();process[_0x3e8f16(0x229)](0x1);}),process[_0x51078d(0x84)](_0x51078d(0x188),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){const _0x2d3821=_0x3cef30;tgBot&&(tgBot[_0x2d3821(0xd3)](),tgBot=null);}function sendTelegram(_0x437eeb,_0x2df90e){const _0x20c5ea=_0x3cef30;if(settings[_0x20c5ea(0x23f)]){if(settings[_0x20c5ea(0x220)]==_0x20c5ea(0x23c)||(_0x2df90e[_0x20c5ea(0x141)]=='error'||_0x2df90e[_0x20c5ea(0x141)]=='warning'||_0x2df90e[_0x20c5ea(0x141)]=='success')&&settings[_0x20c5ea(0x220)]==_0x20c5ea(0x76)||_0x2df90e[_0x20c5ea(0x141)]==_0x20c5ea(0x217)&&settings[_0x20c5ea(0x220)]==_0x20c5ea(0xa1)){if(tgBot&&settings[_0x20c5ea(0x179)]){if(_0x2df90e[_0x20c5ea(0x1d2)])tgBot[_0x20c5ea(0xde)](settings[_0x20c5ea(0x179)],_0x2df90e['botname']+'\x20>\x20'+_0x2df90e['event'])['catch'](_0x183318=>{telegramError(_0x183318);});else tgBot[_0x20c5ea(0xde)](settings[_0x20c5ea(0x179)],_0x20c5ea(0x1eb)+_0x437eeb+_0x20c5ea(0xea)+_0x2df90e[_0x20c5ea(0x88)])[_0x20c5ea(0x194)](_0x439add=>{telegramError(_0x439add);});}}}}async function sendTelegramMsg(_0xe1563e,_0x3bdcd4=_0x3cef30(0x22f)){const _0x2db1cf=_0x3cef30;return settings[_0x2db1cf(0x23f)]&&tgBot&&settings[_0x2db1cf(0x179)]?(await tgBot[_0x2db1cf(0xde)](settings[_0x2db1cf(0x179)],_0xe1563e,{'parse_mode':_0x3bdcd4})[_0x2db1cf(0x194)](_0x8344ed=>{telegramError(_0x8344ed);}),!![]):![];}function getDeviceWithIp(_0x1f9011){return devices['find'](_0x2c8ab6=>_0x2c8ab6['ip']===_0x1f9011);}function temporaryAccess2FA(_0x1ddd55,_0x24c39e){const _0x4760f3=_0x3cef30;let _0x4ca821=new Date(),_0x53b7b9=![];if(lastIpApproval){if(_0x4ca821-lastIpApproval<0x1388)_0x53b7b9=!![];}lastIpApproval=new Date();if(_0x53b7b9)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x4760f3(0x13e)]('callback_query'),tgBot['sendMessage'](settings[_0x4760f3(0x179)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x24c39e)[_0x4760f3(0x15f)]+'</b>\x20?',{'parse_mode':_0x4760f3(0x22f),'reply_markup':{'inline_keyboard':[[{'text':_0x4760f3(0xb9),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x4760f3(0x96),'callback_data':'30'},{'text':_0x4760f3(0x1a1),'callback_data':_0x4760f3(0x1a1)}]]}})['catch'](_0x2e5d17=>{telegramError(_0x2e5d17);}),tgBot['on'](_0x4760f3(0x12f),async _0x9f5ae2=>{const _0x443529=_0x4760f3,_0x1198d2=_0x9f5ae2[_0x443529(0xda)],_0x1c7a77=_0x9f5ae2[_0x443529(0x172)];tgBot[_0x443529(0xb1)](_0x9f5ae2['id'])['then'](async()=>{const _0x54b9eb=_0x443529;devices[_0x1ddd55][_0x54b9eb(0xdc)]={'clientip':_0x24c39e,'timestamp':new Date()['getTime'](),'expiry':_0x1198d2},_0x1198d2!=_0x54b9eb(0x1a1)?(await tgBot['sendMessage'](_0x1c7a77[_0x54b9eb(0x1e6)]['id'],_0x54b9eb(0x182)+_0x1198d2+_0x54b9eb(0x22a),{'parse_mode':_0x54b9eb(0x22f)})[_0x54b9eb(0x194)](_0x4ae234=>{telegramError(_0x4ae234);}),io['to'](_0x1ddd55)[_0x54b9eb(0x203)](_0x54b9eb(0x163),{'access':{'allow':![],'reason':_0x54b9eb(0x16d),'token':null}})):(await tgBot['sendMessage'](_0x1c7a77['chat']['id'],_0x54b9eb(0x162))[_0x54b9eb(0x194)](_0x41487f=>{telegramError(_0x41487f);}),io['to'](_0x1ddd55)[_0x54b9eb(0x203)](_0x54b9eb(0x163),{'access':{'allow':![],'reason':_0x54b9eb(0x10d),'token':null}}));}),tgBot[_0x443529(0x13e)](_0x443529(0x12f));}));}function loginAccess2FA(_0x265f73,_0x147485){const _0x4f7e16=_0x3cef30;tgBot&&settings[_0x4f7e16(0x179)]&&(tgBot[_0x4f7e16(0x13e)]('callback_query'),tgBot[_0x4f7e16(0xde)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x147485)['show']+_0x4f7e16(0x241),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4f7e16(0x18e),'callback_data':loginExpiry},{'text':_0x4f7e16(0x1a1),'callback_data':_0x4f7e16(0x1a1)}]]}})[_0x4f7e16(0x194)](_0x1b91a3=>{telegramError(_0x1b91a3);}),tgBot['on'](_0x4f7e16(0x12f),async _0x1d04c6=>{const _0x507aa2=_0x4f7e16,_0x273ac7=_0x1d04c6['data'],_0x194b02=_0x1d04c6['message'];tgBot[_0x507aa2(0xb1)](_0x1d04c6['id'])[_0x507aa2(0x1e5)](async()=>{const _0xa5d61d=_0x507aa2;devices[_0x265f73][_0xa5d61d(0x196)]={'clientip':_0x147485,'timestamp':new Date()[_0xa5d61d(0xd0)](),'expiry':_0x273ac7},_0x273ac7!='reject'?(await tgBot['sendMessage'](_0x194b02[_0xa5d61d(0x1e6)]['id'],_0xa5d61d(0x193),{'parse_mode':'HTML'})['catch'](_0x407b7b=>{telegramError(_0x407b7b);}),io['to'](_0x265f73)['emit'](_0xa5d61d(0x163),{'access':{'allow':![],'reason':_0xa5d61d(0x16d),'token':null}})):(await tgBot[_0xa5d61d(0xde)](_0x194b02[_0xa5d61d(0x1e6)]['id'],_0xa5d61d(0xe1))[_0xa5d61d(0x194)](_0x50ede0=>{telegramError(_0x50ede0);}),io['to'](_0x265f73)['emit'](_0xa5d61d(0x163),{'access':{'allow':![],'reason':_0xa5d61d(0x98),'token':null}}));}),tgBot['removeListener'](_0x507aa2(0x12f));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5bec71=_0x3cef30;return dbConfig['get']('bots')[_0x5bec71(0xf6)](_0x5bec71(0xe0))[_0x5bec71(0x1f0)]({'status':_0x5bec71(0xf4)})['value']()||[];}function getDisabledBots(){const _0xdb98ee=_0x3cef30;return dbConfig[_0xdb98ee(0x123)]('bots')[_0xdb98ee(0xf6)](_0xdb98ee(0xe0))[_0xdb98ee(0x1f0)]({'status':'disabled'})[_0xdb98ee(0x1bf)]()||[];}function getBotAttributes(_0x397a8c){const _0x1f8f39=_0x3cef30;let _0x25db0a={};const _0x3bef10=configpath+'bot-'+_0x397a8c+'-config.json',_0x52a220=fs[_0x1f8f39(0x192)](_0x3bef10);if(_0x52a220){const _0x370514=fs['readFileSync'](_0x3bef10);try{const _0x132dfa=JSON[_0x1f8f39(0x120)](_0x370514),_0x1c570e=_0x132dfa?_0x132dfa['bot'][0x0]['headless']:![];_0x25db0a[_0x1f8f39(0x1ae)]=_0x1c570e?'auto':_0x1f8f39(0x1ee),_0x25db0a['botname']=_0x132dfa?_0x132dfa[_0x1f8f39(0x1e1)][0x0]['botname']:_0x1f8f39(0x1eb)+_0x397a8c;}catch(_0x1e41ff){_0x25db0a[_0x1f8f39(0x1ae)]=_0x1f8f39(0x1ee),_0x25db0a[_0x1f8f39(0x1c5)]='Bot\x20'+_0x397a8c;}}else _0x25db0a[_0x1f8f39(0x1ae)]=_0x1f8f39(0x1ee),_0x25db0a['botname']=_0x1f8f39(0x1eb)+_0x397a8c;return _0x25db0a;}function getBotsWithMode(){const _0xdbc390=_0x3cef30,_0x4bf7d0=dbConfig['get']('bots')[_0xdbc390(0xf6)]('botID')[_0xdbc390(0x1bf)]()||[];return _0x4bf7d0[_0xdbc390(0x119)](_0x1eb265=>{const _0x2ef198=_0xdbc390;let _0x40d15c=getBotAttributes(_0x1eb265[_0x2ef198(0xe0)]);_0x1eb265[_0x2ef198(0x1ae)]=_0x40d15c[_0x2ef198(0x1ae)];}),_0x4bf7d0;}function getBotExchanges(){const _0x44bc5e=_0x3cef30;let _0x2a8680=[];const _0x2e6208=dbConfig['get'](_0x44bc5e(0x208))['sortBy'](_0x44bc5e(0xe0))['value']()||[];_0x2e6208[_0x44bc5e(0x119)](_0x530a40=>{const _0x31dff4=_0x44bc5e;if(_0x530a40['status']==_0x31dff4(0xf4)){const _0x4d4350=configpath+'bot-'+_0x530a40[_0x31dff4(0xe0)]+'-config.json',_0x557edf=fs['existsSync'](_0x4d4350);let _0xd420e3;if(_0x557edf){const _0x4d8849=fs[_0x31dff4(0x7f)](_0x4d4350);try{const _0x27e8d0=JSON[_0x31dff4(0x120)](_0x4d8849);_0xd420e3=_0x27e8d0?_0x27e8d0[_0x31dff4(0x1e1)][0x0][_0x31dff4(0x23b)]:null;}catch(_0x51c57f){}}if(_0xd420e3)_0x2a8680['push'](_0xd420e3);}});const _0x25555d=[...new Set(_0x2a8680)][_0x44bc5e(0x13c)]();return _0x25555d;}async function initUser(){const _0x8df8bb=_0x3cef30;if(!settings[_0x8df8bb(0x14b)]){const _0x4591be=uuidRandom();mixpanel[_0x8df8bb(0x21d)](_0x4591be),updateSetting(_0x8df8bb(0x14b),_0x4591be);}}async function initSecure(){const _0x5eec04=_0x3cef30;let _0x3b0f92=getSecure();if(!_0x3b0f92[_0x5eec04(0x18d)](_0x5eec04(0xc2))){let _0x40a9a7=await generateKeys();_0x3b0f92[_0x5eec04(0x139)]=_0x40a9a7[_0x5eec04(0x139)],_0x3b0f92[_0x5eec04(0xce)]=_0x40a9a7[_0x5eec04(0xce)],_0x3b0f92[_0x5eec04(0xc2)]=crypto['randomBytes'](0x20)[_0x5eec04(0xbe)]('hex');;storeSecure(_0x3b0f92);}}function getSettings(){const _0x4c3c3a=_0x3cef30;return dbSettings[_0x4c3c3a(0x123)]('settings')[_0x4c3c3a(0x1bf)]()||{};}function getSecure(){const _0x362f01=_0x3cef30;return dbSecure[_0x362f01(0x123)]('secure')[_0x362f01(0x1bf)]()||{};}function getBlacklist(){const _0x1d8e10=_0x3cef30;return dbSecure['get'](_0x1d8e10(0x12e))['value']()||[];}function broadcastToBots(_0x3995c3,_0x354684){const _0x55a7fd=_0x3cef30;config[_0x55a7fd(0x119)](_0x1cc1cf=>{const _0x5cf55c=_0x55a7fd;if(_0x1cc1cf[_0x5cf55c(0x163)]==_0x5cf55c(0xf4)&&_0x1cc1cf[_0x5cf55c(0xe6)]=='running'||_0x1cc1cf[_0x5cf55c(0x163)]==_0x5cf55c(0x215)&&_0x1cc1cf[_0x5cf55c(0xe6)]=='running'){if(pid[_0x1cc1cf[_0x5cf55c(0xe0)]])pid[_0x1cc1cf[_0x5cf55c(0xe0)]]['send']({[_0x3995c3]:_0x354684});}});}function storeSettings(_0x1e3951,_0x4c8e06=![]){const _0x436b70=_0x3cef30;_0x1e3951={...settings,..._0x1e3951};if(_0x4c8e06&&_0x1e3951['bbPassword']!=_0x436b70(0xb3)&&_0x1e3951[_0x436b70(0x1df)]!=_0x436b70(0xac)&&_0x1e3951[_0x436b70(0x1df)]!=''){const _0x5ed856=crypt[_0x436b70(0xc6)](secure['privateKey'],_0x1e3951['bbPassword'])[_0x436b70(0x172)]['split']('@')[0x0],_0x69740d=bcrypt[_0x436b70(0x174)](_0x5ed856,saltRounds);_0x1e3951={..._0x1e3951,'bbPassword':_0x69740d};}if(_0x4c8e06&&_0x1e3951[_0x436b70(0xcc)]!=_0x436b70(0xb3)&&_0x1e3951['telegramToken']!=_0x436b70(0xac)&&_0x1e3951[_0x436b70(0xcc)]!=''){const _0xb24786=crypt[_0x436b70(0xc6)](secure[_0x436b70(0xce)],_0x1e3951[_0x436b70(0xcc)])[_0x436b70(0x172)]['split']('@')[0x0];_0x1e3951={..._0x1e3951,'telegramToken':_0xb24786};}const _0x460e95=_0x1e3951[_0x436b70(0xcc)]!='************'&&_0x1e3951[_0x436b70(0xcc)]!=settings[_0x436b70(0xcc)]||_0x1e3951[_0x436b70(0xed)]!=settings[_0x436b70(0xed)],_0x58db3e=_0x1e3951[_0x436b70(0xcc)]==''||_0x1e3951[_0x436b70(0xed)]=='';if(_0x460e95)_0x1e3951['telegramEvents']=_0x436b70(0x23c);for(const [_0x3f9259,_0x3a7546]of Object['entries'](_0x1e3951)){if(_0x3f9259==_0x436b70(0xcc)&&_0x3a7546==_0x436b70(0xb3)){_0x1e3951[_0x436b70(0xcc)]=settings[_0x436b70(0xcc)];continue;};if(_0x3f9259=='bbPassword'&&_0x3a7546==_0x436b70(0xb3)){_0x1e3951[_0x436b70(0x1df)]=settings[_0x436b70(0x1df)];continue;};dbSettings[_0x436b70(0xcd)](_0x436b70(0x1b4)+_0x3f9259,_0x3a7546)[_0x436b70(0x14e)]();}settings=_0x1e3951,io['to'](_0x436b70(0x1e2))[_0x436b70(0x203)](_0x436b70(0x142),cleanSettings()),broadcastToBots(_0x436b70(0xba),settings['timeshift']),broadcastToBots(_0x436b70(0x143),settings[_0x436b70(0x143)]);if(_0x460e95&&!_0x58db3e)initTelegram();if(_0x460e95&&_0x58db3e)disableTelegram();getAllClients()[_0x436b70(0x119)](_0x3d79d8=>{const _0x404a9c=_0x436b70;getSocket(_0x3d79d8['id'])['emit'](_0x404a9c(0x163),{'access':{'allow':![],'reason':_0x404a9c(0x16d),'token':null}});});}function updateSetting(_0x1c56e2,_0x556ffc){const _0x1d4a0f=_0x3cef30;dbSettings[_0x1d4a0f(0xcd)]('settings.'+_0x1c56e2,_0x556ffc)['write'](),settings=getSettings(),io['to'](_0x1d4a0f(0x1e2))[_0x1d4a0f(0x203)](_0x1d4a0f(0x142),cleanSettings());}function storeSecure(_0xc2f21a){const _0x420cbd=_0x3cef30;dbSecure[_0x420cbd(0x123)](_0x420cbd(0x7d))[_0x420cbd(0x214)](_0xc2f21a)[_0x420cbd(0x14e)](),secure=_0xc2f21a;}function addBlacklist(_0x3d7174){const _0x2ac8f1=_0x3cef30;cleanBlacklist();let _0x12a49b;devices[_0x3d7174][_0x2ac8f1(0xdc)]?_0x12a49b=Math['max'](devices[_0x3d7174][_0x2ac8f1(0xdc)][_0x2ac8f1(0x20f)],loginExpiry):_0x12a49b=loginExpiry,dbSecure[_0x2ac8f1(0x123)](_0x2ac8f1(0x12e))[_0x2ac8f1(0x214)]({'expiry':new Date()[_0x2ac8f1(0xd0)]()+_0x12a49b*0x3c*0x3e8,'token':devices[_0x3d7174][_0x2ac8f1(0x145)][_0x2ac8f1(0x1b6)]})[_0x2ac8f1(0x14e)](),blacklist=dbSecure[_0x2ac8f1(0x123)](_0x2ac8f1(0x12e))['value']();}function cleanBlacklist(){const _0xc18edc=_0x3cef30;let _0x1e8401=dbSecure[_0xc18edc(0x123)](_0xc18edc(0x12e))[_0xc18edc(0x8e)]()['value'](),_0x2e7272=new Date()[_0xc18edc(0xd0)]();_0x1e8401['forEach'](_0x17a028=>{const _0x23282d=_0xc18edc;_0x17a028[_0x23282d(0x20f)]<_0x2e7272&&dbSecure[_0x23282d(0x123)](_0x23282d(0x12e))[_0x23282d(0x191)]({'expiry':_0x17a028[_0x23282d(0x20f)]})['write']();});}function initStates(){const _0x321527=_0x3cef30;let _0x2002e7=getConfiguration();_0x2002e7[_0x321527(0x119)](_0x28ef8b=>{const _0x2462d5=_0x321527;_0x28ef8b[_0x2462d5(0xe6)]=_0x2462d5(0x185);}),storeConfiguration(_0x2002e7);}function onKeys(){const _0x4792c5=new RSA();return new Promise(_0x1913dc=>{const _0x1021ec=_0x582a;_0x4792c5['generateKeyPairAsync']()[_0x1021ec(0x1e5)](_0x2770aa=>{_0x1913dc(_0x2770aa);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x249ec5=_0x3cef30;let _0x34ef30=getSettings(),_0x436e0e=![];!_0x34ef30['hasOwnProperty'](_0x249ec5(0xb5))&&(_0x34ef30['lastmsgtelegram']=0x0,_0x436e0e=!![]);!_0x34ef30[_0x249ec5(0x18d)]('lastmsgemitted')&&(_0x34ef30[_0x249ec5(0x198)]=0x0,_0x436e0e=!![]);!_0x34ef30[_0x249ec5(0x18d)]('latestversion')&&(_0x34ef30[_0x249ec5(0x17f)]='0.0.0',_0x436e0e=!![]);!_0x34ef30[_0x249ec5(0x18d)](_0x249ec5(0x143))&&(_0x34ef30[_0x249ec5(0x143)]=![],_0x436e0e=!![]);if(_0x436e0e)storeSettings(_0x34ef30);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x249ec5(0x119)](_0x1dde01=>{const _0x398429=_0x249ec5;if(!_0x1dde01[_0x398429(0x201)]()){if(!_0x1dde01[_0x398429(0x202)][_0x398429(0x146)](_0x398429(0xd2)))fs['unlinkSync'](configbackuppath+_0x1dde01['name']);}else fs[_0x398429(0x71)](configbackuppath+_0x1dde01[_0x398429(0x202)],{'recursive':!![]});});}catch(_0x1c8602){logger[_0x249ec5(0x178)](_0x249ec5(0x1e0),_0x1c8602);}}function storeConfiguration(_0x166598){const _0x26d22c=_0x3cef30;dbConfig['get'](_0x26d22c(0x208))[_0x26d22c(0x191)]()[_0x26d22c(0x14e)](),_0x166598[_0x26d22c(0x119)](_0x3a36af=>{const _0x228341=_0x26d22c;delete _0x3a36af[_0x228341(0x1ae)];}),dbConfig[_0x26d22c(0x123)]('bots')['push'](..._0x166598)[_0x26d22c(0x14e)](),config=_0x166598;}function resetPassword(){const _0x559290=_0x3cef30;tgBot&&settings[_0x559290(0x179)]&&(tgBot['removeListener'](_0x559290(0x12f)),tgBot['sendMessage'](settings[_0x559290(0x179)],_0x559290(0x1fe),{'parse_mode':_0x559290(0x22f),'reply_markup':{'inline_keyboard':[[{'text':_0x559290(0x10b),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x559290(0x194)](_0x51f651=>{telegramError(_0x51f651);}),tgBot['on'](_0x559290(0x12f),async _0x1280a2=>{const _0x8b94a9=_0x559290,_0x4c4702=_0x1280a2[_0x8b94a9(0xda)],_0x1286f4=_0x1280a2[_0x8b94a9(0x172)];tgBot[_0x8b94a9(0xb1)](_0x1280a2['id'])[_0x8b94a9(0x1e5)](async()=>{const _0x37605d=_0x8b94a9;if(_0x4c4702!='no'){const _0x34e22c=0xf,_0x2f7eea=_0x37605d(0x20b),_0x9295ef=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x34e22c)))[_0x37605d(0x1a0)](_0x51cfd6=>_0x2f7eea[_0x51cfd6%_0x2f7eea[_0x37605d(0x1f7)]])[_0x37605d(0x1b0)](''),_0x1af3c5=bcrypt['hashSync'](_0x9295ef,saltRounds);storeSettings({'bbPassword':_0x1af3c5}),await tgBot[_0x37605d(0xde)](_0x1286f4['chat']['id'],_0x37605d(0x1a6)+_0x9295ef,{'parse_mode':_0x37605d(0x22f)})[_0x37605d(0x194)](_0x9cfcb3=>{telegramError(_0x9cfcb3);});}else await tgBot[_0x37605d(0xde)](_0x1286f4['chat']['id'],'Password\x20reset\x20rejected')[_0x37605d(0x194)](_0x4d812a=>{telegramError(_0x4d812a);});}),tgBot[_0x8b94a9(0x13e)]('callback_query');}));}async function confirmRestore(_0x58b19c,_0x2bfcf2){const _0x4cc0a2=_0x3cef30;io['to'](_0x4cc0a2(0x1e2))['emit'](_0x4cc0a2(0x150),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','success'),tgBot&&settings[_0x4cc0a2(0x179)]&&(tgBot[_0x4cc0a2(0x13e)]('callback_query'),await tgBot[_0x4cc0a2(0xde)](settings['telegramChatId'],_0x4cc0a2(0x1bb),{'parse_mode':_0x4cc0a2(0x22f),'reply_markup':{'inline_keyboard':[[{'text':_0x4cc0a2(0x10b),'callback_data':_0x4cc0a2(0x10b)},{'text':'no','callback_data':'no'}]]}})[_0x4cc0a2(0x194)](_0x3ddf61=>{telegramError(_0x3ddf61);}),tgBot['on'](_0x4cc0a2(0x12f),async _0x31b2ba=>{const _0x3bc7a4=_0x4cc0a2,_0x23d9ad=_0x31b2ba[_0x3bc7a4(0xda)],_0x1c6e83=_0x31b2ba[_0x3bc7a4(0x172)];tgBot[_0x3bc7a4(0xb1)](_0x31b2ba['id'])['then'](async()=>{const _0x66ad03=_0x3bc7a4;_0x23d9ad==_0x66ad03(0x10b)?(await tgBot[_0x66ad03(0xde)](_0x1c6e83['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x66ad03(0x22f)})[_0x66ad03(0x194)](_0x5828c3=>{telegramError(_0x5828c3);}),unzipFile(_0x58b19c,_0x2bfcf2)):(logger[_0x66ad03(0x178)](_0x66ad03(0xf2)),await tgBot[_0x66ad03(0xde)](_0x1c6e83[_0x66ad03(0x1e6)]['id'],_0x66ad03(0xf2))[_0x66ad03(0x194)](_0xe56788=>{telegramError(_0xe56788);}));}),tgBot[_0x3bc7a4(0x13e)](_0x3bc7a4(0x12f));}));}function getServerTime(){const _0x4b33b9=_0x3cef30,_0xf605e9=new Date();return _0xf605e9[_0x4b33b9(0x1f8)]()+'/'+(_0xf605e9[_0x4b33b9(0x167)]()+0x1)[_0x4b33b9(0xbe)]()[_0x4b33b9(0x22e)](0x2,'0')+'/'+_0xf605e9[_0x4b33b9(0x133)]()['toString']()[_0x4b33b9(0x22e)](0x2,'0')+'\x20'+_0xf605e9[_0x4b33b9(0x112)]()[_0x4b33b9(0xbe)]()[_0x4b33b9(0x22e)](0x2,'0')+':'+_0xf605e9[_0x4b33b9(0xa5)]()[_0x4b33b9(0xbe)]()[_0x4b33b9(0x22e)](0x2,'0')+':'+_0xf605e9[_0x4b33b9(0xf3)]()[_0x4b33b9(0xbe)]()[_0x4b33b9(0x22e)](0x2,'0');}function getTimeStamp(){const _0x5444c5=_0x3cef30,_0x1060bb=shiftedTime();return _0x1060bb['getFullYear']()+'/'+(_0x1060bb[_0x5444c5(0x167)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x1060bb[_0x5444c5(0x133)]()[_0x5444c5(0xbe)]()['padStart'](0x2,'0')+'\x20'+_0x1060bb[_0x5444c5(0x112)]()[_0x5444c5(0xbe)]()['padStart'](0x2,'0')+':'+_0x1060bb[_0x5444c5(0xa5)]()[_0x5444c5(0xbe)]()[_0x5444c5(0x22e)](0x2,'0')+':'+_0x1060bb[_0x5444c5(0xf3)]()['toString']()[_0x5444c5(0x22e)](0x2,'0');}function getCleanTimeStamp(){const _0x34d208=_0x3cef30,_0x99430e=shiftedTime();return _0x99430e['getFullYear']()+(_0x99430e['getMonth']()+0x1)[_0x34d208(0xbe)]()[_0x34d208(0x22e)](0x2,'0')+_0x99430e[_0x34d208(0x133)]()[_0x34d208(0xbe)]()['padStart'](0x2,'0')+'-'+_0x99430e['getHours']()[_0x34d208(0xbe)]()[_0x34d208(0x22e)](0x2,'0')+_0x99430e[_0x34d208(0xa5)]()[_0x34d208(0xbe)]()[_0x34d208(0x22e)](0x2,'0')+_0x99430e[_0x34d208(0xf3)]()[_0x34d208(0xbe)]()[_0x34d208(0x22e)](0x2,'0');}function shiftedTime(){const _0xedc86b=_0x3cef30,_0x28b1ff=new Date();let _0xef24f=_0x28b1ff;if(settings[_0xedc86b(0xba)]&&settings['timeshift']!==0x0)_0xef24f=fns[_0xedc86b(0xad)](_0x28b1ff,{'hours':settings[_0xedc86b(0xba)]});return _0xef24f;}function startScheduler(){const _0x5debba=_0x3cef30,_0x4790c4=new Date()[_0x5debba(0x100)](),_0x446717=shiftedTime()[_0x5debba(0x112)]();_0x446717==0x4&&backupConfigFiles();_0x446717==0x0&&rotateLogFiles();_0x4790c4%0x6==0x0&&triggerAnalytics();_0x4790c4%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x43b54c){const _0x83c2aa=_0x3cef30;logger[_0x83c2aa(0x178)](_0x83c2aa(0xbb)+_0x43b54c);const _0x315343=getBotsWithMode();_0x315343['length']>0x0?confirmRestore(configbackuppath,_0x43b54c):unzipFile(configbackuppath,_0x43b54c);}async function getBackupFiles(_0x4dd69c=null){const _0x5a99f7=_0x3cef30;let _0x273385=[],_0x44396d=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x44396d[_0x5a99f7(0x13c)]((_0x508ae1,_0x577d78)=>_0x508ae1[_0x5a99f7(0x202)]<_0x577d78[_0x5a99f7(0x202)]?0x1:_0x577d78[_0x5a99f7(0x202)]<_0x508ae1[_0x5a99f7(0x202)]?-0x1:0x0),_0x44396d['forEach'](_0x2a0d23=>{const _0x38a063=_0x5a99f7;if(!_0x2a0d23[_0x38a063(0x201)]()&&_0x2a0d23[_0x38a063(0x202)][_0x38a063(0x146)](_0x38a063(0xd2))&&_0x2a0d23['name'][_0x38a063(0x221)](_0x38a063(0x1e7))){const _0x39454b=formatDate(fs['statSync'](configbackuppath+_0x2a0d23[_0x38a063(0x202)])[_0x38a063(0x151)]);_0x273385[_0x38a063(0x214)]({'name':_0x2a0d23['name'],'mtime':_0x39454b});}});if(_0x4dd69c)io['to'](_0x4dd69c)[_0x5a99f7(0x203)](_0x5a99f7(0xb7),_0x273385);else return _0x273385;}async function backupConfigFiles(){const _0x12e354=_0x3cef30;await zipFiles(_0x12e354(0xbc));const _0x383239=getCleanTimeStamp();fs[_0x12e354(0x70)](zippath+_0x12e354(0x173),configbackuppath+(_0x12e354(0xd2)+_0x383239+_0x12e354(0x1e7)));let _0x1ea13d=fs[_0x12e354(0x92)](configbackuppath,{'withFileTypes':!![]});_0x1ea13d['sort']((_0x45dd55,_0x348907)=>_0x45dd55[_0x12e354(0x202)]<_0x348907['name']?0x1:_0x348907[_0x12e354(0x202)]<_0x45dd55[_0x12e354(0x202)]?-0x1:0x0),_0x1ea13d[_0x12e354(0x1f7)]>maxBackups&&fs[_0x12e354(0x21f)](configbackuppath+_0x1ea13d[maxBackups][_0x12e354(0x202)]);}function rotateLogFiles(){const _0x2d953e=_0x3cef30,_0x4d3a10=fs[_0x2d953e(0x207)](logspath+_0x2d953e(0x1b5)),_0x488c68=_0x4d3a10[_0x2d953e(0x87)]/0x400;if(_0x488c68>0x64){let _0x1bf5a5=fs[_0x2d953e(0x92)](logspath,{'withFileTypes':!![]});_0x1bf5a5[_0x2d953e(0x13c)]((_0x5e8af2,_0x4fa7a5)=>_0x5e8af2[_0x2d953e(0x202)]<_0x4fa7a5[_0x2d953e(0x202)]?0x1:_0x4fa7a5[_0x2d953e(0x202)]<_0x5e8af2[_0x2d953e(0x202)]?-0x1:0x0),_0x1bf5a5[_0x2d953e(0x119)](_0x3c208a=>{const _0xccbcd=_0x2d953e;if(_0x3c208a[_0xccbcd(0x202)]==_0xccbcd(0x190))fs['copyFileSync'](logspath+_0x3c208a[_0xccbcd(0x202)],logspath+_0xccbcd(0x15a));if(_0x3c208a[_0xccbcd(0x202)]=='output-001.log')fs['copyFileSync'](logspath+_0x3c208a['name'],logspath+_0xccbcd(0x190));_0x3c208a['name']==_0xccbcd(0x1b5)&&(fs['copyFileSync'](logspath+_0x3c208a['name'],logspath+'output-001.log'),fs[_0xccbcd(0xc4)](logspath+_0x3c208a[_0xccbcd(0x202)],''));});}}async function zipFiles(_0xc0d1c4){const _0x16966d=_0x3cef30;let _0x5735e7;if(_0xc0d1c4=='logs')_0x5735e7=logspath;if(_0xc0d1c4==_0x16966d(0x1b2))_0x5735e7=configpath;if(_0xc0d1c4=='backup-full')_0x5735e7=configpath;let _0xeb282c=fs[_0x16966d(0x92)](_0x5735e7,{'withFileTypes':!![]});const _0x4d8b1b=new require(_0x16966d(0x22b))();_0xeb282c[_0x16966d(0x119)](_0xbd22f5=>{const _0x11b01e=_0x16966d;if(!_0xbd22f5[_0x11b01e(0x201)]()){let _0x3140ad=fs[_0x11b01e(0x7f)](_0x5735e7+_0xbd22f5[_0x11b01e(0x202)]);if(_0xc0d1c4==_0x11b01e(0x1b2)){const _0x359fbf=/^bot-[0-9]{3}-config.json$/,_0x4040fb=_0x359fbf[_0x11b01e(0x110)](_0xbd22f5[_0x11b01e(0x202)]);if(_0x4040fb){const _0x464461=JSON[_0x11b01e(0x120)](_0x3140ad);if(_0x464461['bot'][0x0]){_0x464461['bot'][0x0][_0x11b01e(0xdf)]='***',_0x464461[_0x11b01e(0x1e1)][0x0]['apiSecret']=_0x11b01e(0xac);if(_0x464461[_0x11b01e(0x1e1)][0x0][_0x11b01e(0xb8)])_0x464461['bot'][0x0][_0x11b01e(0xb8)]=_0x11b01e(0xac);}_0x3140ad=JSON[_0x11b01e(0x1c3)](_0x464461,null,0x2);}if(_0xbd22f5[_0x11b01e(0x202)]==_0x11b01e(0x1ac)){const _0x21bc7f=JSON[_0x11b01e(0x120)](_0x3140ad);if(_0x21bc7f[_0x11b01e(0x142)][_0x11b01e(0x8b)])_0x21bc7f['settings'][_0x11b01e(0x8b)]=![];if(_0x21bc7f[_0x11b01e(0x142)][_0x11b01e(0x1df)])_0x21bc7f[_0x11b01e(0x142)][_0x11b01e(0x1df)]=_0x11b01e(0xac);if(_0x21bc7f[_0x11b01e(0x142)]['telegramToken'])_0x21bc7f['settings'][_0x11b01e(0xcc)]=_0x11b01e(0xac);if(_0x21bc7f[_0x11b01e(0x142)][_0x11b01e(0x179)])_0x21bc7f[_0x11b01e(0x142)][_0x11b01e(0x179)]=null;_0x3140ad=JSON[_0x11b01e(0x1c3)](_0x21bc7f,null,0x2);}if(_0xbd22f5['name']!=_0x11b01e(0xef))_0x4d8b1b['file'](_0xbd22f5['name'],_0x3140ad);}else _0x4d8b1b[_0x11b01e(0x1d3)](_0xbd22f5['name'],_0x3140ad);}});const _0x27489f=_0x4d8b1b['generate']({'base64':![],'compression':_0x16966d(0x129)});fs[_0x16966d(0xc4)](zippath+(_0xc0d1c4+'.zip'),_0x27489f,_0x16966d(0x1b3));}async function unzipFile(_0x44ffb8,_0x57ec45){const _0x3e04a3=_0x3cef30;fs[_0x3e04a3(0x92)](configpath,{'withFileTypes':!![]})[_0x3e04a3(0x119)](_0x4296ca=>{const _0x3db351=_0x3e04a3;if(!_0x4296ca[_0x3db351(0x201)]())fs['rmSync'](configpath+_0x4296ca[_0x3db351(0x202)]);});const _0x42b089=fs[_0x3e04a3(0x7f)](_0x44ffb8+_0x57ec45,'binary'),_0xf73e48=new require(_0x3e04a3(0x22b))(_0x42b089,{'base64':![],'checkCRC32':!![]});Object[_0x3e04a3(0x1f6)](_0xf73e48[_0x3e04a3(0x93)])[_0x3e04a3(0x119)](_0x18b2c7=>{const _0x479ec4=_0x3e04a3,_0x293ce2=_0xf73e48[_0x479ec4(0x93)][_0x18b2c7];fs['writeFileSync'](configpath+_0x293ce2[_0x479ec4(0x202)],_0x293ce2['_data']);}),fs[_0x3e04a3(0x92)](temppath,{'withFileTypes':!![]})['forEach'](_0x3790c6=>{const _0xfb247a=_0x3e04a3;if(!_0x3790c6[_0xfb247a(0x201)]())fs['rmSync'](temppath+_0x3790c6[_0xfb247a(0x202)]);}),logger['debug'](_0x3e04a3(0x20d)),process[_0x3e04a3(0x239)]({'restore':!![]},_0x593c70=>{});}async function getPublicIp(){const _0x120549=_0x3cef30;try{const _0x31c942=await axios['get']('https://api.ipify.org?format=json');publicip=_0x31c942[_0x120549(0xda)]['ip'];}catch(_0x364572){}}async function triggerAnalytics(){const _0x1d86b4=_0x3cef30;if(!publicip)await getPublicIp();const _0x16adaa=getBotsWithMode();let _0x441d3d=0x0;_0x16adaa[_0x1d86b4(0x119)](_0x438d40=>{const _0x1a849b=_0x1d86b4;if(_0x438d40['status']===_0x1a849b(0xf4))_0x441d3d++;});const _0x2ebb3c=getBotExchanges();mixpanel[_0x1d86b4(0x180)](_0x1d86b4(0x1f9),{'distinct_id':settings[_0x1d86b4(0x14b)],'ip':publicip,'version':serverversion,'numbots':_0x16adaa[_0x1d86b4(0x1f7)],'numbotsenabled':_0x441d3d,'exchanges':_0x2ebb3c});}async function getMessages(){const _0x41dc32=_0x3cef30,_0x114adf=_0x41dc32(0xe3),_0x5b7aad=new GraphQLClient(_0x114adf),_0x5e2c94={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5bfcf5=serverversion[_0x41dc32(0x19f)]('.'),_0x5e4933=_0x5bfcf5[0x0]+'.'+_0x5bfcf5[0x1],_0x38abd3=Math[_0x41dc32(0x206)](settings[_0x41dc32(0xb5)],settings[_0x41dc32(0x198)]),_0xf3e840={'last':parseInt(_0x38abd3),'bbm':_0x5e4933},_0x6d914e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x16f40b;try{_0x16f40b=await _0x5b7aad[_0x41dc32(0x1c0)](_0x6d914e,_0xf3e840,_0x5e2c94);}catch(_0x3fecb3){}if(_0x16f40b&&_0x16f40b[_0x41dc32(0x168)]){let _0x3e12e1=settings[_0x41dc32(0xb5)];newMessages=[];for(const _0x1ed166 of _0x16f40b['messages']){newMessages['push'](_0x1ed166);if(_0x1ed166[_0x41dc32(0x152)])updateSetting('latestversion',_0x1ed166[_0x41dc32(0x152)]);let _0x319e68=_0x1ed166['bbvNew']?serverversion>=_0x1ed166[_0x41dc32(0x152)]:![];if(!_0x319e68&&_0x1ed166[_0x41dc32(0x19b)]>_0x3e12e1){if(_0x1ed166[_0x41dc32(0x16e)]==='any'||serverversion['startsWith'](_0x1ed166[_0x41dc32(0x16e)])){let _0x575e9f=''+_0x1ed166[_0x41dc32(0x6f)]+'\x0a\x0a'+_0x1ed166[_0x41dc32(0x172)];const _0x75974e=await sendTelegramMsg(toTelegramMarkdown(_0x575e9f),_0x41dc32(0xfa));if(_0x75974e)_0x3e12e1=_0x1ed166[_0x41dc32(0x19b)];}}}updateAvailable=isNewerVersion(settings[_0x41dc32(0x17f)],serverversion),updateSetting(_0x41dc32(0xb5),_0x3e12e1),emitMessages();}}function emitMessages(){const _0x461ae6=_0x3cef30,_0x4646b2=settings[_0x461ae6(0x198)];let _0x2e7628=[];newMessages[_0x461ae6(0x119)](_0x31107c=>{const _0x5a8b0d=_0x461ae6;_0x31107c[_0x5a8b0d(0x19b)]>_0x4646b2&&_0x2e7628[_0x5a8b0d(0x214)](_0x31107c);}),_0x2e7628['length']>0x0&&getAllClients()[_0x461ae6(0x119)](_0x3623d9=>{const _0x544e65=_0x461ae6;getSocket(_0x3623d9['id'])[_0x544e65(0x203)](_0x544e65(0x172),_0x2e7628);});}function confirmMessage(_0x26bc03){const _0x4420a7=_0x3cef30;updateSetting(_0x4420a7(0x198),Number(_0x26bc03));}function isNewerVersion(_0x20e335,_0x12af1b){const _0x4b50a1=_0x3cef30,_0x4d452a=_0x12af1b['split']('.'),_0x21d36e=_0x20e335[_0x4b50a1(0x19f)]('.');for(var _0x48659e=0x0;_0x48659e<_0x21d36e[_0x4b50a1(0x1f7)];_0x48659e++){const _0x1544a3=~~_0x21d36e[_0x48659e],_0x784fbb=~~_0x4d452a[_0x48659e];if(_0x1544a3>_0x784fbb)return!![];if(_0x1544a3<_0x784fbb)return![];}return![];}function toTelegramMarkdown(_0x5f2aee){const _0x130a4d=_0x3cef30,_0x46bd4a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4b5d8c=/\*{2}(.+?)\*{2}/gim;return _0x5f2aee=_0x5f2aee['replace'](_0x46bd4a,'$1_$2_$3')[_0x130a4d(0x1f1)](_0x4b5d8c,_0x130a4d(0x9c)),_0x5f2aee;}async function validateConfigFile(){const _0x4e3dcc=_0x3cef30,_0x494312=dbConfig['get'](_0x4e3dcc(0x208))[_0x4e3dcc(0xf6)]('botID')[_0x4e3dcc(0x1bf)]()||[];if(_0x494312['length']==0x0){let _0x5b3f2a=0x0,_0x3b9e02=[];const _0x401f63=/^bot-([0-9]{3})-config.json$/,_0x48047b=fs[_0x4e3dcc(0x92)](configpath);_0x48047b[_0x4e3dcc(0x119)](_0x13bd27=>{const _0x5e1d6f=_0x4e3dcc,_0x4ca846=_0x401f63[_0x5e1d6f(0x77)](_0x13bd27);if(_0x4ca846){const _0x4b1101=_0x4ca846[0x1];let _0x516bec=getBotAttributes(_0x4b1101);_0x3b9e02[_0x5e1d6f(0x214)]({'botID':_0x4b1101,'botname':_0x516bec[_0x5e1d6f(0x1c5)],'status':_0x5e1d6f(0x11f),'live':_0x5e1d6f(0x185)}),_0x5b3f2a++;}}),_0x5b3f2a!=0x0&&(dbConfig[_0x4e3dcc(0x123)](_0x4e3dcc(0x208))[_0x4e3dcc(0xe2)](_0x3b9e02)['write'](),config=_0x3b9e02,restoredConfigFile=_0x5b3f2a);}}async function restoreConfigNotify(_0x186cec){const _0x3e5e2c=_0x3cef30;let _0xc7fac1;if(restoredConfigFile==0x1)_0xc7fac1=_0x3e5e2c(0xa9);else _0xc7fac1=_0x3e5e2c(0x19e);if(_0x186cec)io['to'](_0x3e5e2c(0x1e2))[_0x3e5e2c(0x203)](_0x3e5e2c(0x150),_0xc7fac1);else{logger[_0x3e5e2c(0xc9)](_0x3e5e2c(0xc0)),logger['simple'](_0xc7fac1),logger[_0x3e5e2c(0xc9)](_0x3e5e2c(0xc0)),logger[_0x3e5e2c(0xc9)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x3e5e2c(0x220)]!=_0x3e5e2c(0xa1))tgBot[_0x3e5e2c(0xde)](settings[_0x3e5e2c(0x179)],_0x3e5e2c(0xa8)+_0xc7fac1)[_0x3e5e2c(0x194)](_0x2c8561=>{telegramError(_0x2c8561);});}}function validateCredentials(_0x1750d7,_0x3c07c8){const _0x2cb9e5=_0x3cef30;if(_0x1750d7['username']==settings[_0x2cb9e5(0xbf)]&&bcrypt['compareSync'](_0x1750d7['password'],settings[_0x2cb9e5(0x1df)])){if(settings[_0x2cb9e5(0x1a2)])return{'allow':![],'reason':_0x2cb9e5(0xdb),'token':null};else{const _0x5bf920=generateLoginToken(_0x3c07c8);return{'allow':!![],'reason':_0x2cb9e5(0x1fb),'token':_0x5bf920};}}else return{'allow':![],'reason':_0x2cb9e5(0x7b),'token':null};}function refreshToken(_0x36060a){const _0x259c01=generateLoginToken(_0x36060a);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x259c01};}function validateAccess(_0x18e916,_0x41704c,_0x21f669){const _0x4e9dcb=_0x3cef30,_0x323fbc=_0x21f669?_0x21f669:devices[_0x41704c]['ip'];let _0x191bbb;const _0x443ed4=_0x362af8=>{const _0xc36ec3=_0x582a;if(settings[_0xc36ec3(0x8b)]){if(settings[_0xc36ec3(0x1a2)]){if(telegram2FaApproved(_0x41704c)){const _0x4c00f0=generateLoginToken(_0x41704c);return{'allow':!![],'reason':_0xc36ec3(0x1a5),'token':_0x4c00f0};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x191bbb=validToken(_0x362af8,_0x41704c),_0x191bbb[_0xc36ec3(0x18d)](_0xc36ec3(0x244))?{'allow':!![],'reason':_0xc36ec3(0x218),'token':_0x362af8}:{'allow':![],'reason':_0xc36ec3(0x216),'token':null};}else return{'allow':!![],'reason':_0xc36ec3(0xcf),'token':null};};if(settings[_0x4e9dcb(0x1c6)]){let _0x533b2f=[...settings[_0x4e9dcb(0x16b)],_0x4e9dcb(0x114),_0x4e9dcb(0xae),_0x4e9dcb(0x15d)];if(_0x533b2f[_0x4e9dcb(0x86)](_0x323fbc))return _0x443ed4(_0x18e916);else{_0x191bbb=validToken(_0x18e916,_0x41704c);if(_0x191bbb['hasOwnProperty']('success'))return _0x443ed4(_0x18e916);else{if(telegramIpApproved(_0x41704c)){const _0x20c93b=generateToken(_0x41704c);return _0x191bbb=_0x443ed4(_0x18e916),_0x191bbb[_0x4e9dcb(0x21a)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x20c93b}:_0x191bbb;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x4e9dcb(0x79),'token':null};}}}else return _0x443ed4(_0x18e916);}function timelyDecrypt(_0x58843d,_0x31173a=!![]){const _0x5550e6=_0x3cef30;if(_0x58843d)try{const _0x6a74a8=crypt[_0x5550e6(0xc6)](secure[_0x5550e6(0xce)],_0x58843d)[_0x5550e6(0x172)],_0x4ebe27=_0x6a74a8[_0x5550e6(0x19f)]('@')[0x0],_0x39ead3=_0x6a74a8['split']('@')[0x1],_0x4d87f5=new Date()[_0x5550e6(0xd0)]();if(_0x31173a){if(_0x4d87f5-_0x39ead3<maxSecretAge*0x3e8)return _0x4ebe27;else return![];}else return _0x4ebe27;}catch(_0xff1492){return![];}else return![];}const validToken=(_0x5c94b1,_0x2029ba)=>{const _0x21584d=_0x3cef30,_0x1cb6c3=devices[_0x2029ba]['ip'];if(!_0x5c94b1)return{'error':_0x21584d(0x82)};for(let _0x5b6e6e of blacklist){if(_0x5b6e6e[_0x21584d(0x1b6)]==_0x5c94b1)return{'error':_0x21584d(0x83)};}let _0x25d524;try{_0x25d524=jwt[_0x21584d(0x121)](_0x5c94b1,secure[_0x21584d(0xc2)]+_0x2029ba);}catch{return{'error':_0x21584d(0xf8)};}if(!_0x25d524[_0x21584d(0x18d)](_0x21584d(0x128))&&!_0x25d524[_0x21584d(0x18d)](_0x21584d(0xc5))||!_0x25d524[_0x21584d(0x18d)](_0x21584d(0x1d7)))return{'error':_0x21584d(0x237)};if(!_0x25d524[_0x21584d(0x18d)]('username')&&_0x25d524[_0x21584d(0x18d)](_0x21584d(0x128))){const {clientip:_0x5d1f9a}=_0x25d524;return _0x1cb6c3==_0x5d1f9a?{'success':_0x21584d(0x166)}:{'error':_0x21584d(0x235)};}else{if(_0x25d524[_0x21584d(0x18d)]('username')&&_0x25d524[_0x21584d(0x18d)]('clientip')){const {username:_0x3bc954,clientip:_0xfe52e8}=_0x25d524;return settings[_0x21584d(0xbf)]==_0x3bc954&&_0x1cb6c3==_0xfe52e8?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x21584d(0x1da)};}}},generateLoginToken=_0x355312=>{const _0x2b5a34=_0x3cef30;if(_0x355312){const _0x49201a=devices[_0x355312]['ip'];return jwt[_0x2b5a34(0x222)]({'username':settings[_0x2b5a34(0xbf)],'clientip':_0x49201a},secure[_0x2b5a34(0xc2)]+_0x355312,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x452b36=>{const _0x2af975=_0x3cef30;if(_0x452b36){const _0xb770c4=devices[_0x452b36]['ip'];return jwt[_0x2af975(0x222)]({'clientip':_0xb770c4},secure['secret']+_0x452b36,{'expiresIn':devices[_0x452b36][_0x2af975(0xdc)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x19dfec=>{const _0x1e9506=_0x3cef30;let _0x3a91d5=![];return devices[_0x19dfec][_0x1e9506(0xdc)]&&devices[_0x19dfec][_0x1e9506(0xdc)][_0x1e9506(0x20f)]!=_0x1e9506(0x1a1)&&(_0x3a91d5=devices[_0x19dfec][_0x1e9506(0xdc)][_0x1e9506(0x128)]==devices[_0x19dfec]['ip']&&new Date()['getTime']()-devices[_0x19dfec][_0x1e9506(0xdc)][_0x1e9506(0x20c)]<devices[_0x19dfec][_0x1e9506(0xdc)][_0x1e9506(0x20f)]*0x3c*0x3e8),_0x3a91d5;},telegram2FaApproved=_0x3c1138=>{const _0x2e9089=_0x3cef30;let _0x434166=![];return devices[_0x3c1138][_0x2e9089(0x196)]&&devices[_0x3c1138][_0x2e9089(0x196)][_0x2e9089(0x20f)]!=_0x2e9089(0x1a1)&&(_0x434166=devices[_0x3c1138]['telegram2FaApproval'][_0x2e9089(0x128)]==devices[_0x3c1138]['ip']&&new Date()[_0x2e9089(0xd0)]()-devices[_0x3c1138]['telegram2FaApproval']['timestamp']<devices[_0x3c1138][_0x2e9089(0x196)][_0x2e9089(0x20f)]*0x3c*0x3e8),_0x434166;},normalizeIP=_0x30c116=>{const _0x2b1368=_0x3cef30;let _0x4d48de=null,_0x3f6673=null;if(ipaddr[_0x2b1368(0x1ad)](_0x30c116)){const _0x65c8bc=ipaddr[_0x2b1368(0x120)](_0x30c116);_0x65c8bc[_0x2b1368(0x1cf)]()===_0x2b1368(0x135)?(_0x65c8bc[_0x2b1368(0x17d)]()&&(_0x4d48de=_0x65c8bc[_0x2b1368(0x22c)]()[_0x2b1368(0xbe)]()),_0x3f6673=_0x65c8bc[_0x2b1368(0xbe)]()):(_0x4d48de=_0x65c8bc[_0x2b1368(0xbe)](),_0x3f6673=_0x65c8bc['toIPv4MappedAddress']()['toString']());}return{'show':_0x4d48de?_0x4d48de:_0x3f6673,'store':_0x3f6673};};function formatDate(_0x1c63b3){const _0xf2d8d6=_0x3cef30;return _0x1c63b3[_0xf2d8d6(0x1f8)]()+'/'+(_0x1c63b3['getMonth']()+0x1)[_0xf2d8d6(0xbe)]()['padStart'](0x2,'0')+'/'+_0x1c63b3[_0xf2d8d6(0x133)]()[_0xf2d8d6(0xbe)]()[_0xf2d8d6(0x22e)](0x2,'0')+'\x20'+_0x1c63b3[_0xf2d8d6(0x112)]()[_0xf2d8d6(0xbe)]()['padStart'](0x2,'0')+':'+_0x1c63b3[_0xf2d8d6(0xa5)]()[_0xf2d8d6(0xbe)]()['padStart'](0x2,'0')+':'+_0x1c63b3['getSeconds']()[_0xf2d8d6(0xbe)]()[_0xf2d8d6(0x22e)](0x2,'0');}function sleep(_0x17f8e2){return new Promise(_0x280d8d=>setTimeout(_0x280d8d,_0x17f8e2));}