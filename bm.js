const _0x155e1c=_0x655b;(function(_0x1ea0e7,_0x3ab9c8){const _0x3019bb=_0x655b,_0x405f03=_0x1ea0e7();while(!![]){try{const _0x247f8c=parseInt(_0x3019bb(0x156))/0x1*(-parseInt(_0x3019bb(0xeb))/0x2)+parseInt(_0x3019bb(0x1ea))/0x3+parseInt(_0x3019bb(0x159))/0x4*(parseInt(_0x3019bb(0xd5))/0x5)+parseInt(_0x3019bb(0x19b))/0x6+-parseInt(_0x3019bb(0x1d7))/0x7*(-parseInt(_0x3019bb(0x105))/0x8)+-parseInt(_0x3019bb(0x17d))/0x9+parseInt(_0x3019bb(0x200))/0xa*(-parseInt(_0x3019bb(0xf4))/0xb);if(_0x247f8c===_0x3ab9c8)break;else _0x405f03['push'](_0x405f03['shift']());}catch(_0x5f1a43){_0x405f03['push'](_0x405f03['shift']());}}}(_0x8e1d,0x3d755));const _0x374bc9=function(){let _0x158031=!![];return function(_0x381ae2,_0x5ac749){const _0x493d8a=_0x158031?function(){const _0x3e1a8c=_0x655b;if(_0x5ac749){const _0x1ffe5d=_0x5ac749[_0x3e1a8c(0x20e)](_0x381ae2,arguments);return _0x5ac749=null,_0x1ffe5d;}}:function(){};return _0x158031=![],_0x493d8a;};}(),_0x144e6b=_0x374bc9(this,function(){const _0x5c950e=_0x655b;return _0x144e6b[_0x5c950e(0x187)]()[_0x5c950e(0x176)](_0x5c950e(0x117))[_0x5c950e(0x187)]()[_0x5c950e(0x13d)](_0x144e6b)[_0x5c950e(0x176)]('(((.+)+)+)+$');});_0x144e6b();'use strict';process['env'][_0x155e1c(0x1b2)]=0x1;const childProcess=require(_0x155e1c(0x202)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require('date-fns'),low=require(_0x155e1c(0x147)),path=require('path'),crypto=require(_0x155e1c(0xdc)),Crypt=require(_0x155e1c(0x1dd))[_0x155e1c(0x1d4)],RSA=require(_0x155e1c(0x1dd))[_0x155e1c(0xff)],bcrypt=require(_0x155e1c(0x1aa)),jwt=require(_0x155e1c(0xfd)),analyticsLib=require(_0x155e1c(0x18c))[_0x155e1c(0x12d)],googleAnalytics=require(_0x155e1c(0x215))[_0x155e1c(0x12d)],ipaddr=require(_0x155e1c(0x1d5)),argv=require(_0x155e1c(0xe6))(process[_0x155e1c(0x1a0)]['slice'](0x2))[_0x155e1c(0x1a0)],PORT=argv[_0x155e1c(0x175)]||_0x155e1c(0x1d1),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x155e1c(0x19f)](PORT))return console[_0x155e1c(0x19e)](_0x155e1c(0xf7)+PORT+_0x155e1c(0x11e)),process[_0x155e1c(0x1a2)](0x1);function _0x8e1d(){const _0x4dbc58=['test','argv','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','exit','all','getHours','timestamp','parse','pidRefreshToken','defaults','node-telegram-bot-api','bcryptjs','https://hodlerhacks.com','host','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','backup/','/off\x20-\x20stop\x20bot(s)\x0a','generateKeyPairAsync','NTBA_FIX_319','accept','answerCallbackQuery','bb-config.json','access\x20timeout','/:bot/coins','/:bot','telegramToken','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','disconnect','get','disabled','store','from','Alerts','exp','getPortfolio','sortBy','get-logs','delete-bot','sign','hasOwnProperty','::1','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','config/','find','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20store\x20configuration','update-bot','/on\x20-\x20start\x20bot(s)\x0a','map','3000','Bot\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Crypt','ipaddr.js','compareSync','14vZafIG','onText','All','15\x20min','botname','Unauthorized\x20attempt\x20to\x20update\x20settings','hybrid-crypto-js','/status\x20-\x20show\x20bot(s)\x20status\x0a','All\x20bots','emit','decrypt','secret','referer','Login\x20accepted','fork','privateKey','ipc','allow','forEach','1193922NzqHag','bot','Unauthorized\x20attempt\x20to\x20get\x20portfolio','placeOrder','127.0.0.1','unlinkSync','new','Login\x20rejected','send','logged\x20out','hex','assign','\x20minutes','Unauthorized\x20attempt\x20to\x20log\x20out','get-starting-balances','new-disabled','publicKey','toIPv4Address','getTime','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','type','verify','270RBPZev','hashSync','child_process','running','enabled\x20Bot\x20','padStart','join','settings','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','clientip','enabled','All\x20bots\x20running\x20right\x20now','keys','Invalid\x20username\x20or\x20IP\x20address','apply','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Unauthorized\x20attempt\x20to\x20delete\x20bot','showname','access','Invalid\x20authentication\x20token\x20(2)','store-configuration','@analytics/google-analytics','telegramEvents','secure','filter','\x20only\x0a','inherit','/:bot/portfolio','version','\x20>\x20','listen','handshake','expiry','success','isIPv4MappedAddress','timeshift','version.json',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','logout','headers','629435duEPQG','kill','Unauthorized\x20login\x20attempt\x20(timeout)','write','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','-results.json','error\x20while\x20deleting\x20config\x20files:\x20','crypto','isDirectory','message','loginRequired','createServer','\x20|\x20','remoteAddress','botmanager','pidExpireLogin','show','yargs/yargs','getMonth','2FA\x20required','-performance.json','value','1626fQSMhB','copyFileSync','Access\x20enabled\x20for\x20','login\x20not\x20required','bb-secure.json','reject','order','2FA\x20login\x20required','getDate','204336uvTDgH','sha256','bot.js','Error:\x20Invalid\x20argument\x20','token','connected','match','login\x20required','live','jsonwebtoken','reset-password','RSA','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','-----------------------------------------------------------------------------------','temporaryAccessAllowed','Invalid\x20Telegram\x20token','bbUsername','1802440XxVLSh','build','Unauthorized\x20attempt\x20to\x20update\x20bot','invalid\x20credentials','function','build2','f2aRequired','Notifications\x20disabled\x0a','add','page','use','chat','includes','set','getStartingBalances','orders','getUTCHours','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','(((.+)+)+)+$','temporary\x20token\x20generated','status','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegramIpApproval','Ok,\x20will\x20send\x20alert\x20notifications\x20only','place-order',',\x20must\x20be\x20a\x204\x20digit\x20number','getFullYear',':\x20Bot\x20Mgr\x20>\x20','************','uuid','bots','isValid','bot-','telegram2FaApproval','split','<b>Balance\x20Bot\x20status:</b>\x0a','username','telegramEnabled','telegramChatId','login\x20token\x20valid','default','/:bot/performance','Unauthorized\x20attempt\x20to\x20add\x20bot','stopped','removeListener','sendMessage','once','entries','remove','push','callback_query','1000','Balance\x20Bot','idling\x20bot\x20\x20\x20|\x20Bot\x20','get-portfolio','starting\x20bot\x20|\x20Bot\x20','constructor','storeHeadless','No\x20bots\x20running\x20right\x20now','update-bb','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','RSA-OAEP','getSeconds','login\x20token\x20generated','readdirSync','lowdb','removeAllListeners','initclient','apiKey','name','5\x20min','error','Unauthorized\x20attempt\x20to\x20get\x20logs','Orders','Temporary\x20access\x20rejected','connection','blacklist','whitelistEnabled','reason','2FA\x20login\x20token\x20generated','303fDHJuB','Invalid\x20IP\x20address','clients','4lRrfdK','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','index.html','Invalid\x20authentication\x20token\x20(1)','-events.json','::ffff:127.0.0.1','Token\x20blacklisted','reload','HTML','disabled\x20Bot\x20','cloneDeep','args','Notifications\x20disabled','existsSync','settings.','emitHistory','SIGTERM','conn','catch','password','2FA','-config.json','SIGINT','temporary\x20access\x20rejected','/:bot/history','restart','randomBytes','data','port','search','botID','Bot\x20Mgr\x20>\x20','Notifications\x20enabled','kind','then','temporary\x20access\x20not\x20allowed','2449764rjvUnh','30\x20min','stopPolling','You\x20can\x20use\x20the\x20following\x20commands:\x0a','sockets','telegram','telegramUsername','auth','No\x20authentication\x20token','stop','toString','/help\x20-\x20show\x20available\x20commands\x0a','whitelist','length','Notifications\x20types:\x20','analytics','sendFile','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','alerts','max','bbPassword','store-headless','restarting\x20Bot\x20','event','bb-settings.json','mkdirSync','Password\x20has\x20been\x20reset\x20to:\x20','login','User\x20has\x20been\x20validated','cancelLoading','1784094CnMCBH','</b>\x20?','starting\x20new\x20bot\x20|\x20Bot\x20','log'];_0x8e1d=function(){return _0x4dbc58;};return _0x8e1d();}const HOST=argv[_0x155e1c(0x1ac)]||null,userID=argv['user']||'';function _0x655b(_0xf74e41,_0x2a23a7){const _0x3691a9=_0x8e1d();return _0x655b=function(_0x144e6b,_0x374bc9){_0x144e6b=_0x144e6b-0xc3;let _0x8e1dff=_0x3691a9[_0x144e6b];return _0x8e1dff;},_0x655b(_0xf74e41,_0x2a23a7);}let bbpath='bb/',bbpath2='';const botfile=_0x155e1c(0xf6),configfile=_0x155e1c(0x1b5),settingsfile=_0x155e1c(0x195),securefile=_0x155e1c(0xef),validInstallation=fs['existsSync']('../install.js');!fs[_0x155e1c(0x166)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x155e1c(0x158)),configpath=userID?bbpath+_0x155e1c(0x1ca)+userID+'/':bbpath+_0x155e1c(0x1ca),configbackuppath=configpath+_0x155e1c(0x1af);!fs[_0x155e1c(0x166)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x155e1c(0x196)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x155e1c(0x1a8)]({'bots':[]})[_0x155e1c(0xd8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x155e1c(0x1a8)]({'settings':{'timeshift':0x0}})[_0x155e1c(0xd8)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x155e1c(0xd8)]();let crypt=new Crypt({'md':_0x155e1c(0xf5),'rsaStandard':_0x155e1c(0x143)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x155e1c(0xd1))[_0x155e1c(0xc9)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require('http')[_0x155e1c(0xe0)](app);app[_0x155e1c(0x10f)](express['static'](path[_0x155e1c(0x206)](__dirname,bbpath2,_0x155e1c(0x10a)))),app[_0x155e1c(0x10f)](express['static'](path[_0x155e1c(0x206)](__dirname,bbpath2,'build'))),app[_0x155e1c(0x1bc)]('/',function(_0x541dd9,_0x4a8bb5){const _0x37b459=_0x155e1c;_0x4a8bb5[_0x37b459(0x18d)](path[_0x37b459(0x206)](__dirname,bbpath2,_0x37b459(0x10a),'index.html'));}),app[_0x155e1c(0x1bc)](_0x155e1c(0x1b8),function(_0x1c3fca,_0x29c650){const _0x24c269=_0x155e1c;_0x29c650[_0x24c269(0x18d)](path['join'](__dirname,bbpath2,'build',_0x24c269(0x15b)));}),app['get'](_0x155e1c(0xc8),(_0x5d6a30,_0x40df57)=>{const _0x112d20=_0x155e1c;_0x40df57[_0x112d20(0x18d)](path['join'](__dirname,bbpath2,'build',_0x112d20(0x15b)));}),app[_0x155e1c(0x1bc)](_0x155e1c(0x12e),(_0x19c90e,_0x5c943c)=>{const _0xf6f366=_0x155e1c;_0x5c943c[_0xf6f366(0x18d)](path[_0xf6f366(0x206)](__dirname,bbpath2,'build',_0xf6f366(0x15b)));}),app[_0x155e1c(0x1bc)](_0x155e1c(0x1b7),(_0x38c20a,_0x311e19)=>{const _0x3b64a5=_0x155e1c;_0x311e19[_0x3b64a5(0x18d)](path['join'](__dirname,bbpath2,_0x3b64a5(0x106),_0x3b64a5(0x15b)));}),app[_0x155e1c(0x1bc)](_0x155e1c(0x171),(_0x19b2c8,_0x5cb72c)=>{const _0x24054b=_0x155e1c;_0x5cb72c[_0x24054b(0x18d)](path['join'](__dirname,bbpath2,_0x24054b(0x106),_0x24054b(0x15b)));}),app[_0x155e1c(0x1bc)]('/:bot/configuration',(_0x957101,_0x2e12c8)=>{const _0x2cac19=_0x155e1c;_0x2e12c8[_0x2cac19(0x18d)](path[_0x2cac19(0x206)](__dirname,bbpath2,_0x2cac19(0x106),_0x2cac19(0x15b)));}),app[_0x155e1c(0x1bc)]('/:bot/support',(_0x24ef5e,_0x4ce31e)=>{const _0x2f741e=_0x155e1c;_0x4ce31e['sendFile'](path[_0x2f741e(0x206)](__dirname,bbpath2,_0x2f741e(0x106),'index.html'));});if(HOST)http[_0x155e1c(0xcb)](PORT,HOST);else http[_0x155e1c(0xcb)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x155e1c(0x139),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x155e1c(0x1a9));let tgBot;if(settings[_0x155e1c(0x1b9)]&&settings[_0x155e1c(0x1b9)]!=''&&settings[_0x155e1c(0x183)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x586c12=_0x155e1c;console[_0x586c12(0x19e)](''),console[_0x586c12(0x19e)](_0x586c12(0x101)),logging(_0x586c12(0x208)+PORT),console['log'](_0x586c12(0x101));if(config['length']!=0x0)config[_0x586c12(0x1e9)](_0x16f1e3=>{const _0x979099=_0x586c12;if(_0x16f1e3['status']=='enabled'||_0x16f1e3[_0x979099(0x119)]==_0x979099(0x1f0))logging(_0x979099(0x13c)+_0x16f1e3[_0x979099(0x177)]+'\x20|\x20'+_0x16f1e3[_0x979099(0x1db)]),startBot([_0x16f1e3[_0x979099(0x177)],userID],{'cwd':bbpath},function(_0x3ed0bd){if(_0x3ed0bd)logging(_0x3ed0bd);});else(_0x16f1e3[_0x979099(0x119)]==_0x979099(0x1bd)||_0x16f1e3[_0x979099(0x119)]==_0x979099(0x1f9))&&logging(_0x979099(0x13a)+_0x16f1e3[_0x979099(0x177)]+_0x979099(0xe1)+_0x16f1e3['botname']);});else!newBot&&console[_0x586c12(0x19e)](_0x586c12(0xd9));if(newBot)addBot();console[_0x586c12(0x19e)](_0x586c12(0x101)),console[_0x586c12(0x19e)]('');}function startSocket(){const _0x5e1b42=_0x155e1c;io['on'](_0x5e1b42(0x151),_0x16f46b=>{const _0x2b754e=_0x5e1b42;let _0x4707d9,_0x3c28ab,_0xaaa8c5,_0x1ff098,_0x507fb3;const _0x25c6bb=_0x16f46b[_0x2b754e(0xcc)][_0x2b754e(0xd4)][_0x2b754e(0x1e3)];_0x3c28ab=_0x25c6bb[_0x2b754e(0xfa)](/bot[0-9]{3}/);if(_0x3c28ab)_0xaaa8c5=_0x3c28ab[0x0][_0x2b754e(0xfa)](/[0-9]{3}/);if(_0xaaa8c5)_0x4707d9=_0xaaa8c5[0x0];else _0x4707d9=_0x2b754e(0xe3);const _0x3a4d48=_0x16f46b[_0x2b754e(0xcc)][_0x2b754e(0x184)]['encryptedUuid'];if(!_0x3a4d48)_0x16f46b[_0x2b754e(0x1e0)]('status',{'publicKey':secure[_0x2b754e(0x1fa)]});else{_0x1ff098=timelyDecrypt(_0x3a4d48,![]);if(!_0x1ff098)_0x16f46b[_0x2b754e(0x1e0)](_0x2b754e(0x119),{'publicKey':secure[_0x2b754e(0x1fa)]});else{_0x507fb3=normalizeIP(_0x16f46b[_0x2b754e(0x16a)][_0x2b754e(0xe2)])[_0x2b754e(0x1be)];if(!devices[_0x1ff098])devices[_0x1ff098]={'uuid':_0x1ff098,'access':{'token':null}};devices[_0x1ff098]['ip']=_0x507fb3;const _0x1369ea=addClient(_0x16f46b['id'],_0x1ff098,_0x4707d9);setAccess(_0x1369ea),_0x16f46b['on'](_0x2b754e(0x198),_0x2fbc9d=>{const _0x291521=_0x2b754e,_0xf6bbcc=timelyDecrypt(_0x2fbc9d[_0x291521(0x16c)]);if(_0xf6bbcc){_0x2fbc9d={'username':_0x2fbc9d[_0x291521(0x129)],'password':_0xf6bbcc},devices[_0x1ff098]['access']=validateCredentials(_0x2fbc9d,_0x1ff098);if(devices[_0x1ff098]['access']['allow']==![]&&devices[_0x1ff098]['access'][_0x291521(0x154)]==_0x291521(0xf2))_0x16f46b[_0x291521(0x1e0)](_0x291521(0x119),{'access':devices[_0x1ff098][_0x291521(0x212)]}),loginAccess2FA(_0x1ff098,_0x507fb3);else{if(devices[_0x1ff098][_0x291521(0x212)]['allow']==![]&&devices[_0x1ff098][_0x291521(0x212)][_0x291521(0x154)]==_0x291521(0x108))_0x16f46b['emit'](_0x291521(0x119),{'access':devices[_0x1ff098][_0x291521(0x212)]});else devices[_0x1ff098]['access'][_0x291521(0x1e8)]&&devices[_0x1ff098][_0x291521(0x212)][_0x291521(0x154)]==_0x291521(0x145)&&(getClientsWithUuid(_0x1ff098)[_0x291521(0x1e9)](_0x3c02e4=>{setAccess(_0x3c02e4);}),setTokenRefresh(_0x1ff098),setSessionTimeout('login',_0x1ff098));}}else logging(_0x291521(0xd7));}),_0x16f46b['on'](_0x2b754e(0xfe),()=>{resetPassword();}),_0x16f46b['on'](_0x2b754e(0x1bb),_0x3d29b9=>{removeClient(_0x16f46b['id']);});}}});}function initClient(_0x16aa89){const _0x15b73c=_0x155e1c;if(_0x16aa89!=_0x15b73c(0xe3)&&config[_0x15b73c(0x14a)]!=''){if(pid[_0x16aa89])pid[_0x16aa89]['send']({'function':_0x15b73c(0x149),'args':null});}}function getSocket(_0x23506a){const _0x2aef77=_0x155e1c;return io[_0x2aef77(0x181)][_0x2aef77(0x181)][_0x2aef77(0x1bc)](_0x23506a);}function setAccess(_0x5ddb96){const _0xd3906a=_0x155e1c,_0x3ad43b=getSocket(_0x5ddb96['id']),_0x302959=_0x5ddb96[_0xd3906a(0x122)],_0x577f02=_0x5ddb96[_0xd3906a(0x1eb)];devices[_0x302959][_0xd3906a(0x212)]=validateAccess(devices[_0x302959]['access'][_0xd3906a(0xf8)],_0x302959),_0x3ad43b[_0xd3906a(0x206)](_0x302959);if(devices[_0x302959][_0xd3906a(0x212)]['allow']){_0x3ad43b[_0xd3906a(0x206)](_0x577f02);if(_0x577f02=='botmanager')initializeSocketBotManager(_0x3ad43b);else initializeSocketBot(_0x3ad43b);initClient(_0x577f02);}devices[_0x302959][_0xd3906a(0x212)][_0xd3906a(0xf8)]&&devices[_0x302959][_0xd3906a(0x212)][_0xd3906a(0x154)]==_0xd3906a(0x118)&&setSessionTimeout(_0xd3906a(0x16d),_0x302959),devices[_0x302959][_0xd3906a(0x212)][_0xd3906a(0xf8)]&&devices[_0x302959][_0xd3906a(0x212)][_0xd3906a(0x154)]==_0xd3906a(0x155)&&setSessionTimeout(_0xd3906a(0x198),_0x302959),_0x3ad43b[_0xd3906a(0x1e0)](_0xd3906a(0x119),{'status':_0x5ddb96['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x302959][_0xd3906a(0x212)],'externalip':devices[_0x302959]['ip'],'publicKey':secure[_0xd3906a(0x1fa)],'validInstallation':validInstallation}),devices[_0x302959][_0xd3906a(0x212)][_0xd3906a(0x1e8)]==![]&&devices[_0x302959][_0xd3906a(0x212)]['reason']==_0xd3906a(0xe8)&&temporaryAccess2FA(_0x302959,devices[_0x302959]['ip']);}function setSessionTimeout(_0x1d5233,_0x31d6f7){const _0x458dc4=_0x155e1c;let _0x4443a9;if(_0x1d5233=='login')_0x4443a9=loginExpiry*0x3c*0x3e8;else _0x4443a9=devices[_0x31d6f7][_0x458dc4(0x11b)]['expiry']*0x3c*0x3e8-(new Date()[_0x458dc4(0x1fc)]()-devices[_0x31d6f7]['telegramIpApproval'][_0x458dc4(0x1a5)]);if(devices[_0x31d6f7]['pidExpireLogin'])clearTimeout(devices[_0x31d6f7]['pidExpireLogin']);devices[_0x31d6f7][_0x458dc4(0xe4)]=setTimeout(()=>{const _0x2ad9a4=_0x458dc4;if(devices[_0x31d6f7][_0x2ad9a4(0x1a7)])clearTimeout(devices[_0x31d6f7]['pidRefreshToken']);removeSocketListeners(_0x31d6f7),addBlacklist(_0x31d6f7),devices[_0x31d6f7][_0x2ad9a4(0x11b)]=null,devices[_0x31d6f7][_0x2ad9a4(0x126)]=null,devices[_0x31d6f7][_0x2ad9a4(0x212)][_0x2ad9a4(0xf8)]=null,devices[_0x31d6f7][_0x2ad9a4(0x212)]=validateAccess(devices[_0x31d6f7]['access']['token'],_0x31d6f7),!(devices[_0x31d6f7][_0x2ad9a4(0x212)][_0x2ad9a4(0x1e8)]&&devices[_0x31d6f7][_0x2ad9a4(0x212)][_0x2ad9a4(0x154)]==_0x2ad9a4(0xee))&&(_0x1d5233==_0x2ad9a4(0x198)?io['to'](_0x31d6f7)['emit']('status',{'access':{'allow':![],'reason':_0x2ad9a4(0x1b6),'token':null}}):io['to'](_0x31d6f7)[_0x2ad9a4(0x1e0)]('status',{'access':{'allow':![],'reason':_0x2ad9a4(0x1cc),'token':null}})),devices[_0x31d6f7][_0x2ad9a4(0x212)]['token']=null;},_0x4443a9);}function setTokenRefresh(_0x12cf3f){const _0x3bd45d=_0x155e1c;if(devices[_0x12cf3f]['pidRefreshToken'])clearTimeout(devices[_0x12cf3f]['pidRefreshToken']);devices[_0x12cf3f][_0x3bd45d(0x1a7)]=setTimeout(()=>{const _0x4ff73e=_0x3bd45d;getClientsWithUuid(_0x12cf3f)[_0x4ff73e(0x18a)]!=0x0?(devices[_0x12cf3f]['access']=refreshToken(_0x12cf3f),io['to'](_0x12cf3f)[_0x4ff73e(0x1e0)](_0x4ff73e(0x119),{'status':_0x4ff73e(0xf9),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x12cf3f][_0x4ff73e(0x212)],'externalip':devices[_0x12cf3f]['ip'],'publicKey':secure[_0x4ff73e(0x1fa)],'validInstallation':validInstallation}),setTokenRefresh(_0x12cf3f)):clearTimeout(devices[_0x12cf3f][_0x4ff73e(0x1a7)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5337ba){const _0x590ab7=_0x155e1c,_0x431be0=getClient(_0x5337ba['id'])[_0x590ab7(0x122)];_0x5337ba['emit']('bots',config),_0x5337ba['emit'](_0x590ab7(0x207),cleanSettings()),_0x5337ba['on']('add-bot',_0x1ba5b5=>{const _0x9a3e21=_0x590ab7;if(validateAccess(_0x1ba5b5,_0x431be0)[_0x9a3e21(0x1e8)])addBot();else logging(_0x9a3e21(0x12f));}),_0x5337ba['on'](_0x590ab7(0x1ce),(_0x1da2d1,_0x4295ff)=>{const _0x40bcf4=_0x590ab7;if(validateAccess(_0x4295ff,_0x431be0)['allow'])toggleBot(_0x1da2d1['botID'],_0x1da2d1[_0x40bcf4(0x119)],_0x1da2d1[_0x40bcf4(0xfc)]);else logging(_0x40bcf4(0x107));}),_0x5337ba['on'](_0x590ab7(0x1c5),(_0x2215fc,_0x36bdf8)=>{const _0x5c789b=_0x590ab7;if(validateAccess(_0x36bdf8,_0x431be0)[_0x5c789b(0x1e8)])deleteBot(_0x2215fc);else logging(_0x5c789b(0x210));}),_0x5337ba['on']('store-settings',(_0x64e0c1,_0x570f25)=>{const _0x3c8504=_0x590ab7;if(validateAccess(_0x570f25,_0x431be0)['allow'])storeSettings(_0x64e0c1,!![]);else logging(_0x3c8504(0x1dc));}),_0x5337ba['on'](_0x590ab7(0x140),(_0x2f7c74,_0x20e9c6)=>{const _0xfa79b4=_0x590ab7;if(validateAccess(_0x20e9c6,_0x431be0)[_0xfa79b4(0x1e8)])updateBB();else logging(_0xfa79b4(0x1dc));}),_0x5337ba['on'](_0x590ab7(0xd3),_0x1b714a=>{const _0x270221=_0x590ab7;if(validateAccess(_0x1b714a,_0x431be0)['allow']){if(devices[_0x431be0][_0x270221(0x1a7)])clearTimeout(devices[_0x431be0]['pidRefreshToken']);if(devices[_0x431be0]['pidExpireLogin'])clearTimeout(devices[_0x431be0][_0x270221(0xe4)]);removeSocketListeners(getClient(_0x5337ba['id'])['uuid']),addBlacklist(_0x431be0),devices[_0x431be0][_0x270221(0x11b)]=null,devices[_0x431be0][_0x270221(0x126)]=null,devices[_0x431be0][_0x270221(0x212)]['token']=null,io['to'](getClient(_0x5337ba['id'])[_0x270221(0x122)])[_0x270221(0x1e0)](_0x270221(0x119),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x270221(0x1f7));});}function initializeSocketBot(_0xa453d7){const _0x3bb0a4=_0x155e1c,_0x20aa22=getClient(_0xa453d7['id'])[_0x3bb0a4(0x1eb)],_0x548718=getClient(_0xa453d7['id'])[_0x3bb0a4(0x122)];_0xa453d7['on'](_0x3bb0a4(0x1c4),(_0x444abd,_0x42d93e)=>{const _0x312f56=_0x3bb0a4;if(validateAccess(_0x42d93e,_0x548718)[_0x312f56(0x1e8)]){if(pid[_0x20aa22])pid[_0x20aa22][_0x312f56(0x1f2)]({'function':_0x312f56(0x168),'args':_0x444abd});}else logging(_0x312f56(0x14e));}),_0xa453d7['on'](_0x3bb0a4(0x13b),(_0x2d9629,_0x8696d7)=>{const _0x442a87=_0x3bb0a4;if(validateAccess(_0x8696d7,_0x548718)[_0x442a87(0x1e8)]){if(pid[_0x20aa22])pid[_0x20aa22][_0x442a87(0x1f2)]({'function':_0x442a87(0x1c2),'args':_0x2d9629});}else logging(_0x442a87(0x1ec));}),_0xa453d7['on'](_0x3bb0a4(0x214),(_0x5de985,_0x55a509)=>{const _0x3207e6=_0x3bb0a4;if(validateAccess(_0x55a509,_0x548718)[_0x3207e6(0x1e8)]){if(pid[_0x20aa22])pid[_0x20aa22][_0x3207e6(0x1f2)]({'function':'storeConfiguration','args':_0x5de985});}else logging(_0x3207e6(0x1cd));}),_0xa453d7['on'](_0x3bb0a4(0x192),(_0x939348,_0x952806)=>{const _0x605a25=_0x3bb0a4;if(validateAccess(_0x952806,_0x548718)['allow']){if(pid[_0x20aa22])pid[_0x20aa22]['send']({'function':_0x605a25(0x13e),'args':_0x939348});}else logging(_0x605a25(0x1fd));}),_0xa453d7['on'](_0x3bb0a4(0x1f8),_0x19505f=>{const _0x36dd87=_0x3bb0a4;if(validateAccess(_0x19505f,_0x548718)['allow']){if(pid[_0x20aa22])pid[_0x20aa22][_0x36dd87(0x1f2)]({'function':_0x36dd87(0x113),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0xa453d7['on'](_0x3bb0a4(0x11d),(_0x31e568,_0x14655d)=>{const _0x3e3f8f=_0x3bb0a4;if(validateAccess(_0x14655d,_0x548718)[_0x3e3f8f(0x1e8)]){if(pid[_0x20aa22])pid[_0x20aa22]['send']({'function':_0x3e3f8f(0x1ed),'args':_0x31e568});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0xa453d7['on']('cancel-loading',_0x1de925=>{const _0x5070b4=_0x3bb0a4;if(validateAccess(_0x1de925,_0x548718)['allow']){if(pid[_0x20aa22])pid[_0x20aa22][_0x5070b4(0x1f2)]({'function':_0x5070b4(0x19a),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xa453d7['on'](_0x3bb0a4(0xd3),_0x5c827e=>{const _0x40d237=_0x3bb0a4;if(validateAccess(_0x5c827e,_0x548718)[_0x40d237(0x1e8)]){if(devices[_0x548718]['pidRefreshToken'])clearTimeout(devices[_0x548718][_0x40d237(0x1a7)]);if(devices[_0x548718][_0x40d237(0xe4)])clearTimeout(devices[_0x548718][_0x40d237(0xe4)]);removeSocketListeners(getClient(_0xa453d7['id'])[_0x40d237(0x122)]),addBlacklist(_0x548718),devices[_0x548718]['telegramIpApproval']=null,devices[_0x548718]['telegram2FaApproval']=null,devices[_0x548718][_0x40d237(0x212)][_0x40d237(0xf8)]=null,io['to'](getClient(_0xa453d7['id'])[_0x40d237(0x122)])['emit'](_0x40d237(0x119),{'access':{'allow':![],'reason':_0x40d237(0x1f3),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x2cd580){getClientsWithUuid(_0x2cd580)['forEach'](_0x57b4f9=>{const _0x201991=_0x655b;getSocket(_0x57b4f9['id'])[_0x201991(0x148)]();});}function cleanSettings(){const _0x1fa15d=_0x155e1c;let _0xfa5942=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0xfa5942={..._0xfa5942,'telegramToken':_0x1fa15d(0x121)}),settings[_0x1fa15d(0x191)]&&settings[_0x1fa15d(0x191)]!=''&&(_0xfa5942={..._0xfa5942,'bbPassword':_0x1fa15d(0x121)}),_0xfa5942;}function updateBB(){const _0x5968da=_0x155e1c;installingUpdate=!![],config[_0x5968da(0x1e9)](_0x1f6032=>{const _0x5daaad=_0x5968da;restartBot(_0x1f6032[_0x5daaad(0x177)]);}),process[_0x5968da(0x1f2)]({'update':!![]},_0xa90510=>{});}function startBot(_0x4e6623,_0x1cb81a,_0x3466bd){const _0x498c37=_0x155e1c;let _0x4e7dcf=![];const _0x41c6d0=_0x4e6623[0x0];_0x1cb81a={..._0x1cb81a,'stdio':['inherit',_0x498c37(0xc7),_0x498c37(0xc7),_0x498c37(0x1e7)]},pid[_0x41c6d0]=childProcess[_0x498c37(0x1e5)](botfile,_0x4e6623,_0x1cb81a),pid[_0x41c6d0]['on'](_0x498c37(0xde),_0x2c793a=>{const _0x3cccd4=_0x498c37;switch(Object[_0x3cccd4(0x20c)](_0x2c793a)[0x0]){case _0x3cccd4(0x1db):updateBotName(_0x41c6d0,_0x2c793a[_0x3cccd4(0x1db)]);break;case _0x3cccd4(0x119):updateStatus(_0x41c6d0,_0x2c793a[_0x3cccd4(0x119)]);break;case'live':updateLive(_0x41c6d0,_0x2c793a[_0x3cccd4(0xfc)]);break;case'started':updateLive(_0x41c6d0,_0x2c793a['started']),io['to'](_0x41c6d0)[_0x3cccd4(0x1e0)]('status',{'access':{'allow':![],'reason':_0x3cccd4(0x160),'token':null}});break;case _0x3cccd4(0x186):_0x2c793a[_0x3cccd4(0x186)]==_0x3cccd4(0x172)&&restartBot(_0x41c6d0);_0x2c793a[_0x3cccd4(0x186)]==_0x3cccd4(0xd6)&&toggleBot(_0x41c6d0,_0x3cccd4(0x1bd),_0x3cccd4(0x130));break;case _0x3cccd4(0x182):sendTelegram(_0x41c6d0,_0x2c793a[_0x3cccd4(0x182)]);break;case _0x3cccd4(0x109):io['to'](_0x41c6d0)['emit'](_0x2c793a['function'],_0x2c793a[_0x3cccd4(0x164)]);break;}}),pid[_0x41c6d0]['on'](_0x498c37(0x14d),function(_0x48048d){if(_0x4e7dcf)return;_0x4e7dcf=!![],_0x3466bd(_0x48048d);}),pid[_0x41c6d0]['on'](_0x498c37(0x1a2),function(_0x53fc82){const _0x360f70=_0x498c37;if(installingUpdate)return;if(_0x4e7dcf)return;_0x4e7dcf=!![],_0x3466bd(null);const _0x1f4d45=dbConfig[_0x360f70(0x1bc)](_0x360f70(0x123))[_0x360f70(0x1cb)]({'botID':_0x41c6d0})['value']();_0x1f4d45&&(_0x1f4d45[_0x360f70(0x119)]=='enabled'||_0x1f4d45[_0x360f70(0x119)]==_0x360f70(0x1f0))&&(updateLive(_0x41c6d0,_0x360f70(0x130)),logging(_0x360f70(0x193)+_0x41c6d0),startBot([_0x41c6d0,userID],{'cwd':bbpath},function(_0x4de267){if(_0x4de267)logging(_0x4de267);}));});}function stopBot(_0x22c85f){const _0x2a3eab=_0x155e1c;getClientsWithBotID(_0x22c85f)[_0x2a3eab(0x1e9)](_0x15098d=>{getSocket(_0x15098d['id'])['disconnect'](!![]),removeClient(_0x15098d['id']);});if(pid[_0x22c85f])pid[_0x22c85f][_0x2a3eab(0xd6)]();}function restartBot(_0x53c0e3){if(pid[_0x53c0e3])pid[_0x53c0e3]['kill']();}function addBot(){const _0x3978b1=_0x155e1c;let _0xbf2ae;for(let _0x2a8d07=0x1;_0x2a8d07<0x3e9;_0x2a8d07++){_0xbf2ae=_0x2a8d07[_0x3978b1(0x187)]()[_0x3978b1(0x205)](0x3,'0');let _0x102c6c=config['find'](_0x56cd94=>_0x56cd94[_0x3978b1(0x177)]==_0xbf2ae);if(!_0x102c6c)break;}if(_0xbf2ae===_0x3978b1(0x138)){logging(_0x3978b1(0x11a));return;}logging(_0x3978b1(0x19d)+_0xbf2ae),dbConfig['get'](_0x3978b1(0x123))[_0x3978b1(0x136)]({'botID':_0xbf2ae,'botname':_0x3978b1(0x1d2)+_0xbf2ae,'status':_0x3978b1(0x1f0),'live':''})[_0x3978b1(0xd8)](),startBot([_0xbf2ae,userID],{'cwd':bbpath},function(_0xccd25c){if(_0xccd25c)logging(_0xccd25c);}),config=getConfiguration(),io['to'](_0x3978b1(0xe3))[_0x3978b1(0x1e0)](_0x3978b1(0x123),config);}function deleteBot(_0x24f277){const _0x105ca1=_0x155e1c;getClientsWithBotID(_0x24f277)['forEach'](_0x43a7e1=>{const _0x5d2a7f=_0x655b;getSocket(_0x43a7e1['id'])[_0x5d2a7f(0x1bb)](!![]),removeClient(_0x43a7e1['id']);}),dbConfig[_0x105ca1(0x1bc)](_0x105ca1(0x123))[_0x105ca1(0x135)]({'botID':_0x24f277})[_0x105ca1(0xd8)](),logging('deleted\x20Bot\x20'+_0x24f277),stopBot(_0x24f277);try{fs[_0x105ca1(0x1ef)](path[_0x105ca1(0x206)](configpath,_0x105ca1(0x125)+_0x24f277+_0x105ca1(0x16e))),fs['unlinkSync'](path['join'](configpath,_0x105ca1(0x125)+_0x24f277+_0x105ca1(0x15d))),fs[_0x105ca1(0x1ef)](path[_0x105ca1(0x206)](configpath,_0x105ca1(0x125)+_0x24f277+_0x105ca1(0xe9))),fs['unlinkSync'](path['join'](configpath,'bot-'+_0x24f277+_0x105ca1(0xda)));}catch(_0x32f478){if(_0x32f478)logging(_0x105ca1(0xdb),_0x32f478);}config=getConfiguration(),io['to'](_0x105ca1(0xe3))[_0x105ca1(0x1e0)](_0x105ca1(0x123),config);}function toggleBot(_0x48e4a7,_0x593f0f,_0x34ba97){const _0x492062=_0x155e1c;dbConfig['get'](_0x492062(0x123))['find']({'botID':_0x48e4a7})[_0x492062(0x1f5)]({'status':_0x593f0f})[_0x492062(0x1f5)]({'live':_0x34ba97})[_0x492062(0xd8)]();if(_0x593f0f==_0x492062(0x20a)||_0x593f0f=='new')logging(_0x492062(0x204)+_0x48e4a7),startBot([_0x48e4a7,userID],{'cwd':bbpath},function(_0x45e252){if(_0x45e252)logging(_0x45e252);});else(_0x593f0f==_0x492062(0x1bd)||_0x593f0f==_0x492062(0x1f9))&&(logging(_0x492062(0x162)+_0x48e4a7),stopBot(_0x48e4a7));config=getConfiguration(),io['to'](_0x492062(0xe3))[_0x492062(0x1e0)]('bots',config);}function toggleStatus(_0x2772aa){const _0x47a792=_0x155e1c;let _0x5de3a2=dbConfig['get'](_0x47a792(0x123))[_0x47a792(0x1cb)]({'botID':_0x2772aa})[_0x47a792(0xea)](),_0x16d552;if(_0x5de3a2[_0x47a792(0x119)]==='enabled')_0x16d552=_0x47a792(0x1bd);else{if(_0x5de3a2[_0x47a792(0x119)]==='new')_0x16d552=_0x47a792(0x1f9);else{if(_0x5de3a2[_0x47a792(0x119)]===_0x47a792(0x1f9))_0x16d552=_0x47a792(0x1f0);else{if(_0x5de3a2['status']===_0x47a792(0x1bd))_0x16d552='enabled';}}}return _0x16d552;}function updateStatus(_0x1fc61b,_0x3f0f70){const _0x553f5f=_0x155e1c;dbConfig[_0x553f5f(0x1bc)](_0x553f5f(0x123))[_0x553f5f(0x1cb)]({'botID':_0x1fc61b})['assign']({'status':_0x3f0f70})[_0x553f5f(0xd8)](),config=getConfiguration(),io['to'](_0x553f5f(0xe3))['emit']('bots',config);}function updateLive(_0x1df74d,_0xc45c29){const _0x143911=_0x155e1c;dbConfig[_0x143911(0x1bc)](_0x143911(0x123))['find']({'botID':_0x1df74d})['assign']({'live':_0xc45c29})[_0x143911(0xd8)](),config=getConfiguration(),io['to'](_0x143911(0xe3))[_0x143911(0x1e0)](_0x143911(0x123),config);}function updateBotName(_0x379164,_0x2cb4c4){const _0x154418=_0x155e1c;dbConfig[_0x154418(0x1bc)](_0x154418(0x123))[_0x154418(0x1cb)]({'botID':_0x379164})[_0x154418(0x1f5)]({'botname':_0x2cb4c4})[_0x154418(0xd8)](),config=getConfiguration(),io['to'](_0x154418(0xe3))['emit']('bots',config);}function telegramError(_0x3f2be0){const _0x17a1c1=_0x155e1c;console[_0x17a1c1(0x19e)](getTimeStamp()+_0x17a1c1(0xd2));}function validateTelegram(_0x313d81){const _0x17d471=_0x155e1c;if(_0x313d81['from'][_0x17d471(0x129)]!=settings[_0x17d471(0x183)]&&'@'+_0x313d81[_0x17d471(0x1bf)][_0x17d471(0x129)]!=settings[_0x17d471(0x183)])return tgBot[_0x17d471(0x132)](_0x313d81['chat']['id'],_0x17d471(0x1ae),{'parse_mode':_0x17d471(0x161)})[_0x17d471(0x16b)](_0x143eb0=>{telegramError(_0x143eb0);}),![];return!![];}async function initTelegram(){const _0x42e81a=_0x155e1c;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x42e81a(0x1b9)],{'polling':!![]});let _0x5b76d3=_0x42e81a(0x180);_0x5b76d3+='\x0a',_0x5b76d3+='/enable\x20-\x20enable\x20notifications\x0a',_0x5b76d3+='/disable\x20-\x20disable\x20notifications\x0a',_0x5b76d3+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5b76d3+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x5b76d3+=_0x42e81a(0x1cf),_0x5b76d3+=_0x42e81a(0x1b0),_0x5b76d3+=_0x42e81a(0x1de),_0x5b76d3+=_0x42e81a(0x188);let _0x509eaf='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x509eaf+='\x0a',_0x509eaf+=_0x5b76d3,tgBot[_0x42e81a(0x1d8)](/\/start/,_0x54c9b8=>{const _0x5cd334=_0x42e81a;if(!validateTelegram(_0x54c9b8))return;if(settings[_0x5cd334(0x12b)]!=_0x54c9b8[_0x5cd334(0x110)]['id'])updateSetting(_0x5cd334(0x12b),_0x54c9b8['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x5cd334(0x132)](_0x54c9b8[_0x5cd334(0x110)]['id'],_0x509eaf)[_0x5cd334(0x16b)](_0x49a119=>{telegramError(_0x49a119);});}),tgBot[_0x42e81a(0x1d8)](/\/enable/,_0x54d57d=>{const _0x9be4b6=_0x42e81a;if(!validateTelegram(_0x54d57d))return;if(settings[_0x9be4b6(0x12b)]!=_0x54d57d['chat']['id'])updateSetting(_0x9be4b6(0x12b),_0x54d57d['chat']['id']);updateSetting(_0x9be4b6(0x12a),!![]),tgBot[_0x9be4b6(0x132)](_0x54d57d[_0x9be4b6(0x110)]['id'],_0x9be4b6(0x179))['catch'](_0x4096cb=>{telegramError(_0x4096cb);});}),tgBot[_0x42e81a(0x1d8)](/\/config/,async _0x457ee0=>{const _0x23a3e8=_0x42e81a;if(!validateTelegram(_0x457ee0))return;tgBot['removeListener'](_0x23a3e8(0x137)),tgBot[_0x23a3e8(0x132)](_0x457ee0[_0x23a3e8(0x110)]['id'],_0x23a3e8(0x20f),{'reply_markup':{'inline_keyboard':[[{'text':_0x23a3e8(0x14f),'callback_data':'orders'},{'text':_0x23a3e8(0x1c0),'callback_data':_0x23a3e8(0x18f)},{'text':_0x23a3e8(0x1d9),'callback_data':_0x23a3e8(0x1a3)}]]}})[_0x23a3e8(0x16b)](_0x1c9e26=>{telegramError(_0x1c9e26);}),tgBot['on'](_0x23a3e8(0x137),async _0xcf40f3=>{const _0x1d212f=_0x23a3e8,_0x473288=_0xcf40f3['data'],_0x57be64=_0xcf40f3['message'];tgBot[_0x1d212f(0x1b4)](_0xcf40f3['id'])[_0x1d212f(0x17b)](async()=>{const _0x5e830f=_0x1d212f;_0x473288==_0x5e830f(0x114)&&(updateSetting(_0x5e830f(0xc3),_0x5e830f(0x114)),updateSetting(_0x5e830f(0x12a),!![]),await tgBot[_0x5e830f(0x132)](_0x57be64[_0x5e830f(0x110)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x5e830f(0x16b)](_0x5082c8=>{telegramError(_0x5082c8);}));_0x473288==_0x5e830f(0x18f)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x5e830f(0x12a),!![]),await tgBot[_0x5e830f(0x132)](_0x57be64[_0x5e830f(0x110)]['id'],_0x5e830f(0x11c))[_0x5e830f(0x16b)](_0x13e496=>{telegramError(_0x13e496);}));_0x473288==_0x5e830f(0x1a3)&&(updateSetting(_0x5e830f(0xc3),'all'),updateSetting(_0x5e830f(0x12a),!![]),await tgBot['sendMessage'](_0x57be64['chat']['id'],_0x5e830f(0x1ad))[_0x5e830f(0x16b)](_0x3f42ac=>{telegramError(_0x3f42ac);}));if(!settings['telegramChatId'])tgBot[_0x5e830f(0x132)](_0x57be64['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x5e830f(0x16b)](_0x3297e3=>{telegramError(_0x3297e3);});}),tgBot[_0x1d212f(0x131)](_0x1d212f(0x137));});}),tgBot['onText'](/\/status/,_0x53b9e7=>{const _0x53d6f9=_0x42e81a;if(!validateTelegram(_0x53b9e7))return;let _0x33f3f2=_0x53d6f9(0x128);config[_0x53d6f9(0x1e9)](_0x1566f7=>{const _0x1d7341=_0x53d6f9;_0x33f3f2+=_0x1d7341(0x1d2)+_0x1566f7['botID']+_0x1d7341(0xe1)+_0x1566f7[_0x1d7341(0x1db)]+':\x20'+_0x1566f7['status']+'\x20/\x20'+_0x1566f7['live']+'\x0a';}),_0x33f3f2+='\x0a',_0x33f3f2+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x33f3f2+=!settings[_0x53d6f9(0x12a)]?_0x53d6f9(0x10c):'Notifications\x20enabled\x0a',_0x33f3f2+=settings[_0x53d6f9(0x12a)]?settings[_0x53d6f9(0xc3)]==_0x53d6f9(0x1a3)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x53d6f9(0x18b)+settings['telegramEvents']+_0x53d6f9(0xc6):'',tgBot[_0x53d6f9(0x132)](_0x53b9e7[_0x53d6f9(0x110)]['id'],_0x33f3f2,{'parse_mode':_0x53d6f9(0x161)})[_0x53d6f9(0x16b)](_0x3f2f62=>{telegramError(_0x3f2f62);});}),tgBot['onText'](/\/restart/,_0x177e2e=>{const _0x11d910=_0x42e81a;if(!validateTelegram(_0x177e2e))return;tgBot[_0x11d910(0x131)](_0x11d910(0x137));const _0x25ed26=getEnabledBots();if(_0x25ed26[_0x11d910(0x18a)]==0x0)tgBot[_0x11d910(0x132)](_0x177e2e[_0x11d910(0x110)]['id'],_0x11d910(0x13f))[_0x11d910(0x16b)](_0x2fa396=>{telegramError(_0x2fa396);});else{if(_0x25ed26['length']>0x1)_0x25ed26[_0x11d910(0x136)]({'botID':_0x11d910(0x1a3)});let _0x2925c2=[],_0x38e5af=[];const _0x2263ef=_0x25ed26[_0x11d910(0x18a)]%0x4==0x0||_0x25ed26[_0x11d910(0x18a)]%0x4==0x3||_0x25ed26[_0x11d910(0x18a)]%0x3==0x1?0x4:0x3;let _0x41464b=0x0;_0x25ed26['forEach']((_0x3939db,_0x3d22a6)=>{const _0x249ba7=_0x11d910;if(_0x3d22a6%_0x2263ef==0x0)_0x38e5af=[];_0x38e5af[_0x249ba7(0x136)]({'text':_0x3939db[_0x249ba7(0x177)]=='all'?'All\x20bots':_0x249ba7(0x1d2)+_0x3939db[_0x249ba7(0x177)],'callback_data':_0x3939db[_0x249ba7(0x177)]}),_0x3d22a6%_0x2263ef==0x0&&(_0x2925c2[_0x41464b]=_0x38e5af,_0x41464b++);}),tgBot[_0x11d910(0x132)](_0x177e2e[_0x11d910(0x110)]['id'],_0x11d910(0x100),{'reply_markup':{'inline_keyboard':_0x2925c2}})[_0x11d910(0x16b)](_0xb866d2=>{telegramError(_0xb866d2);}),tgBot['on'](_0x11d910(0x137),async _0x40038f=>{const _0x5445ba=_0x11d910,_0x1d2b1f=_0x40038f[_0x5445ba(0x174)],_0x5740ba=_0x40038f[_0x5445ba(0xde)];tgBot['answerCallbackQuery'](_0x40038f['id'])[_0x5445ba(0x17b)](async()=>{const _0x260f70=_0x5445ba;if(_0x1d2b1f=='all'){if(settings[_0x260f70(0xc3)]==_0x260f70(0x114))tgBot[_0x260f70(0x132)](_0x5740ba['chat']['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')['catch'](_0x2fd66d=>{telegramError(_0x2fd66d);});config[_0x260f70(0x1e9)](_0x68d514=>{const _0x2f1d37=_0x260f70;restartBot(_0x68d514[_0x2f1d37(0x177)]);});}else{if(settings[_0x260f70(0xc3)]==_0x260f70(0x114))tgBot[_0x260f70(0x132)](_0x5740ba[_0x260f70(0x110)]['id'],_0x260f70(0x142)+_0x1d2b1f)[_0x260f70(0x16b)](_0x53a290=>{telegramError(_0x53a290);});restartBot(_0x1d2b1f);}}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/on/,_0x19c629=>{const _0x553ce5=_0x42e81a;if(!validateTelegram(_0x19c629))return;tgBot['removeListener'](_0x553ce5(0x137));const _0x27a22f=getDisabledBots();if(_0x27a22f[_0x553ce5(0x18a)]==0x0)tgBot[_0x553ce5(0x132)](_0x19c629['chat']['id'],_0x553ce5(0x20b))[_0x553ce5(0x16b)](_0x4402da=>{telegramError(_0x4402da);});else{if(_0x27a22f[_0x553ce5(0x18a)]>0x1)_0x27a22f[_0x553ce5(0x136)]({'botID':_0x553ce5(0x1a3)});let _0x1f207b=[],_0x161efb=[];const _0x5e0e96=_0x27a22f['length']%0x4==0x0||_0x27a22f[_0x553ce5(0x18a)]%0x4==0x3||_0x27a22f[_0x553ce5(0x18a)]%0x3==0x1?0x4:0x3;let _0x2fc9c=0x0;_0x27a22f[_0x553ce5(0x1e9)]((_0x4070d2,_0x4d3313)=>{const _0x34b601=_0x553ce5;if(_0x4d3313%_0x5e0e96==0x0)_0x161efb=[];_0x161efb[_0x34b601(0x136)]({'text':_0x4070d2[_0x34b601(0x177)]==_0x34b601(0x1a3)?_0x34b601(0x1df):'Bot\x20'+_0x4070d2[_0x34b601(0x177)],'callback_data':_0x4070d2['botID']}),_0x4d3313%_0x5e0e96==0x0&&(_0x1f207b[_0x2fc9c]=_0x161efb,_0x2fc9c++);}),tgBot['sendMessage'](_0x19c629['chat']['id'],_0x553ce5(0x1a1),{'reply_markup':{'inline_keyboard':_0x1f207b}})['catch'](_0xfcb5c2=>{telegramError(_0xfcb5c2);}),tgBot['on']('callback_query',async _0x364b72=>{const _0x14cd64=_0x553ce5,_0x14a2aa=_0x364b72['data'],_0x1c4bb7=_0x364b72['message'];tgBot[_0x14cd64(0x1b4)](_0x364b72['id'])[_0x14cd64(0x17b)](async()=>{const _0x518dcb=_0x14cd64;if(_0x14a2aa==_0x518dcb(0x1a3)){if(settings[_0x518dcb(0xc3)]==_0x518dcb(0x114))tgBot[_0x518dcb(0x132)](_0x1c4bb7[_0x518dcb(0x110)]['id'],_0x518dcb(0x15a))[_0x518dcb(0x16b)](_0xbfb23d=>{telegramError(_0xbfb23d);});_0x27a22f[_0x518dcb(0x1e9)](_0x47fb32=>{const _0x5b940f=_0x518dcb;if(_0x47fb32['botID']!='all')toggleBot(_0x47fb32[_0x5b940f(0x177)],toggleStatus(_0x47fb32[_0x5b940f(0x177)]),_0x5b940f(0x130));});}else{if(settings[_0x518dcb(0xc3)]==_0x518dcb(0x114))tgBot[_0x518dcb(0x132)](_0x1c4bb7[_0x518dcb(0x110)]['id'],_0x518dcb(0x1d3)+_0x14a2aa)['catch'](_0x1b0f69=>{telegramError(_0x1b0f69);});toggleBot(_0x14a2aa,toggleStatus(_0x14a2aa),_0x518dcb(0x130));}}),tgBot[_0x14cd64(0x131)](_0x14cd64(0x137));});}}),tgBot[_0x42e81a(0x1d8)](/\/off/,_0x26b81f=>{const _0x517a09=_0x42e81a;if(!validateTelegram(_0x26b81f))return;tgBot[_0x517a09(0x131)](_0x517a09(0x137));const _0x2f1839=getEnabledBots();if(_0x2f1839[_0x517a09(0x18a)]==0x0)tgBot[_0x517a09(0x132)](_0x26b81f[_0x517a09(0x110)]['id'],_0x517a09(0x13f))[_0x517a09(0x16b)](_0x4d5144=>{telegramError(_0x4d5144);});else{if(_0x2f1839['length']>0x1)_0x2f1839[_0x517a09(0x136)]({'botID':_0x517a09(0x1a3)});let _0x5ca3a3=[],_0x53fa7f=[];const _0x3c04d0=_0x2f1839['length']%0x4==0x0||_0x2f1839['length']%0x4==0x3||_0x2f1839[_0x517a09(0x18a)]%0x3==0x1?0x4:0x3;let _0xe2dc7a=0x0;_0x2f1839[_0x517a09(0x1e9)]((_0x289057,_0x5a98be)=>{const _0x147460=_0x517a09;if(_0x5a98be%_0x3c04d0==0x0)_0x53fa7f=[];_0x53fa7f[_0x147460(0x136)]({'text':_0x289057[_0x147460(0x177)]==_0x147460(0x1a3)?_0x147460(0x1df):_0x147460(0x1d2)+_0x289057[_0x147460(0x177)],'callback_data':_0x289057[_0x147460(0x177)]}),_0x5a98be%_0x3c04d0==0x0&&(_0x5ca3a3[_0xe2dc7a]=_0x53fa7f,_0xe2dc7a++);}),tgBot[_0x517a09(0x132)](_0x26b81f[_0x517a09(0x110)]['id'],_0x517a09(0x1c9),{'reply_markup':{'inline_keyboard':_0x5ca3a3}})[_0x517a09(0x16b)](_0x3d39aa=>{telegramError(_0x3d39aa);}),tgBot['on'](_0x517a09(0x137),async _0xfe028c=>{const _0x199029=_0x517a09,_0xb59f7a=_0xfe028c[_0x199029(0x174)],_0xd70a97=_0xfe028c[_0x199029(0xde)];tgBot[_0x199029(0x1b4)](_0xfe028c['id'])[_0x199029(0x17b)](async()=>{const _0x2d5e02=_0x199029;if(_0xb59f7a==_0x2d5e02(0x1a3)){if(settings[_0x2d5e02(0xc3)]==_0x2d5e02(0x114))tgBot[_0x2d5e02(0x132)](_0xd70a97['chat']['id'],_0x2d5e02(0x1ba))[_0x2d5e02(0x16b)](_0x20d76e=>{telegramError(_0x20d76e);});_0x2f1839[_0x2d5e02(0x1e9)](_0x16ad6a=>{const _0x147a35=_0x2d5e02;if(_0x16ad6a[_0x147a35(0x177)]!=_0x147a35(0x1a3))toggleBot(_0x16ad6a[_0x147a35(0x177)],toggleStatus(_0x16ad6a[_0x147a35(0x177)]),'stopped');});}else{if(settings[_0x2d5e02(0xc3)]==_0x2d5e02(0x114))tgBot[_0x2d5e02(0x132)](_0xd70a97[_0x2d5e02(0x110)]['id'],_0x2d5e02(0x18e)+_0xb59f7a)[_0x2d5e02(0x16b)](_0x1cb656=>{telegramError(_0x1cb656);});toggleBot(_0xb59f7a,toggleStatus(_0xb59f7a),'stopped');}}),tgBot[_0x199029(0x131)](_0x199029(0x137));});}}),tgBot[_0x42e81a(0x1d8)](/\/disable/,_0x11b812=>{const _0x5c3110=_0x42e81a;if(!validateTelegram(_0x11b812))return;tgBot[_0x5c3110(0x132)](_0x11b812['chat']['id'],_0x5c3110(0x165))[_0x5c3110(0x16b)](_0x3f70c3=>{telegramError(_0x3f70c3);}),updateSetting(_0x5c3110(0x12a),![]);}),tgBot['onText'](/\/help/,_0x3d425b=>{const _0x395d93=_0x42e81a;if(!validateTelegram(_0x3d425b))return;tgBot[_0x395d93(0x132)](_0x3d425b[_0x395d93(0x110)]['id'],_0x5b76d3)[_0x395d93(0x16b)](_0x2fc041=>{telegramError(_0x2fc041);});}),tgBot['on']('polling_error',_0x20dc93=>{const _0x3396f5=_0x42e81a;_0x20dc93[_0x3396f5(0x187)]()[_0x3396f5(0x111)]('404\x20Not\x20Found')&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x3396f5(0x17f)](),tgBot=null,io['to'](_0x3396f5(0xe3))[_0x3396f5(0x1e0)]('notification',_0x3396f5(0x103)));}),process[_0x42e81a(0x133)](_0x42e81a(0x16f),()=>{const _0x3fa7e3=_0x42e81a;if(tgBot)tgBot[_0x3fa7e3(0x17f)]();process[_0x3fa7e3(0x1a2)](0x1);}),process[_0x42e81a(0x133)](_0x42e81a(0x169),()=>{const _0x3ac369=_0x42e81a;if(tgBot)tgBot[_0x3ac369(0x17f)]();process[_0x3ac369(0x1a2)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x3b7bfd,_0x271dae){const _0x7671e4=_0x155e1c;if(settings[_0x7671e4(0x12a)]){if(settings[_0x7671e4(0xc3)]=='all'||(_0x271dae[_0x7671e4(0x1fe)]==_0x7671e4(0x14d)||_0x271dae[_0x7671e4(0x1fe)]==_0x7671e4(0xce))&&settings[_0x7671e4(0xc3)]=='alerts'||_0x271dae['type']==_0x7671e4(0xf1)&&settings['telegramEvents']==_0x7671e4(0x114)){if(tgBot&&settings['telegramChatId']){if(_0x271dae[_0x7671e4(0x211)])tgBot[_0x7671e4(0x132)](settings[_0x7671e4(0x12b)],_0x271dae[_0x7671e4(0x1db)]+_0x7671e4(0xca)+_0x271dae[_0x7671e4(0x194)])[_0x7671e4(0x16b)](_0x57b51c=>{telegramError(_0x57b51c);});else tgBot[_0x7671e4(0x132)](settings[_0x7671e4(0x12b)],'Bot\x20'+_0x3b7bfd+_0x7671e4(0xca)+_0x271dae[_0x7671e4(0x194)])[_0x7671e4(0x16b)](_0x3f2c9c=>{telegramError(_0x3f2c9c);});}}}}function getDeviceWithIp(_0x581826){const _0x85999f=_0x155e1c;return devices[_0x85999f(0x1cb)](_0x304f19=>_0x304f19['ip']===_0x581826);}function temporaryAccess2FA(_0x4501a7,_0x54aba7){const _0x2ba837=_0x155e1c;let _0x105273=new Date(),_0x5c2601=![];if(lastIpApproval){if(_0x105273-lastIpApproval<0x1388)_0x5c2601=!![];}lastIpApproval=new Date();if(_0x5c2601)return;tgBot&&settings[_0x2ba837(0x12b)]&&(tgBot['removeListener'](_0x2ba837(0x137)),tgBot[_0x2ba837(0x132)](settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x54aba7)[_0x2ba837(0xe5)]+_0x2ba837(0x19c),{'parse_mode':_0x2ba837(0x161),'reply_markup':{'inline_keyboard':[[{'text':_0x2ba837(0x14c),'callback_data':'5'},{'text':_0x2ba837(0x1da),'callback_data':'15'},{'text':_0x2ba837(0x17e),'callback_data':'30'},{'text':_0x2ba837(0xf0),'callback_data':_0x2ba837(0xf0)}]]}})[_0x2ba837(0x16b)](_0x161912=>{telegramError(_0x161912);}),tgBot['on'](_0x2ba837(0x137),async _0x2b626c=>{const _0x5a936e=_0x2ba837,_0x4120ef=_0x2b626c['data'],_0x55029a=_0x2b626c[_0x5a936e(0xde)];tgBot[_0x5a936e(0x1b4)](_0x2b626c['id'])[_0x5a936e(0x17b)](async()=>{const _0x2822c8=_0x5a936e;devices[_0x4501a7][_0x2822c8(0x11b)]={'clientip':_0x54aba7,'timestamp':new Date()[_0x2822c8(0x1fc)](),'expiry':_0x4120ef},_0x4120ef!=_0x2822c8(0xf0)?(await tgBot[_0x2822c8(0x132)](_0x55029a[_0x2822c8(0x110)]['id'],_0x2822c8(0xed)+_0x4120ef+_0x2822c8(0x1f6),{'parse_mode':_0x2822c8(0x161)})[_0x2822c8(0x16b)](_0x211ffc=>{telegramError(_0x211ffc);}),io['to'](_0x4501a7)[_0x2822c8(0x1e0)](_0x2822c8(0x119),{'access':{'allow':![],'reason':_0x2822c8(0x160),'token':null}})):(await tgBot[_0x2822c8(0x132)](_0x55029a[_0x2822c8(0x110)]['id'],_0x2822c8(0x150))[_0x2822c8(0x16b)](_0xea0eab=>{telegramError(_0xea0eab);}),io['to'](_0x4501a7)[_0x2822c8(0x1e0)]('status',{'access':{'allow':![],'reason':_0x2822c8(0x170),'token':null}}));}),tgBot['removeListener'](_0x5a936e(0x137));}));}function loginAccess2FA(_0x2acbfd,_0x29ef40){const _0x5431b9=_0x155e1c;tgBot&&settings[_0x5431b9(0x12b)]&&(tgBot[_0x5431b9(0x131)]('callback_query'),tgBot['sendMessage'](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x29ef40)[_0x5431b9(0xe5)]+_0x5431b9(0x19c),{'parse_mode':_0x5431b9(0x161),'reply_markup':{'inline_keyboard':[[{'text':_0x5431b9(0x1b3),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x5431b9(0xf0)}]]}})[_0x5431b9(0x16b)](_0x252389=>{telegramError(_0x252389);}),tgBot['on'](_0x5431b9(0x137),async _0x2e6c0c=>{const _0x13db49=_0x5431b9,_0x4ee475=_0x2e6c0c[_0x13db49(0x174)],_0xe0c3f4=_0x2e6c0c[_0x13db49(0xde)];tgBot['answerCallbackQuery'](_0x2e6c0c['id'])[_0x13db49(0x17b)](async()=>{const _0x30e9a7=_0x13db49;devices[_0x2acbfd][_0x30e9a7(0x126)]={'clientip':_0x29ef40,'timestamp':new Date()[_0x30e9a7(0x1fc)](),'expiry':_0x4ee475},_0x4ee475!='reject'?(await tgBot[_0x30e9a7(0x132)](_0xe0c3f4['chat']['id'],_0x30e9a7(0x1e4),{'parse_mode':_0x30e9a7(0x161)})['catch'](_0x4a7bd9=>{telegramError(_0x4a7bd9);}),io['to'](_0x2acbfd)['emit'](_0x30e9a7(0x119),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x30e9a7(0x132)](_0xe0c3f4[_0x30e9a7(0x110)]['id'],_0x30e9a7(0x1f1))['catch'](_0x408bbb=>{telegramError(_0x408bbb);}),io['to'](_0x2acbfd)['emit'](_0x30e9a7(0x119),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener']('callback_query');}));}function getConfiguration(){const _0x36bfac=_0x155e1c;return dbConfig[_0x36bfac(0x1bc)]('bots')[_0x36bfac(0x1c3)](_0x36bfac(0x177))[_0x36bfac(0xea)]()||[];}function getEnabledBots(){const _0x4abfa6=_0x155e1c;return dbConfig['get'](_0x4abfa6(0x123))[_0x4abfa6(0x1c3)](_0x4abfa6(0x177))[_0x4abfa6(0xc5)]({'status':_0x4abfa6(0x20a)})[_0x4abfa6(0xea)]()||[];}function getDisabledBots(){const _0x5e1172=_0x155e1c;return dbConfig[_0x5e1172(0x1bc)]('bots')[_0x5e1172(0x1c3)]('botID')[_0x5e1172(0xc5)]({'status':_0x5e1172(0x1bd)})[_0x5e1172(0xea)]()||[];}function getSettings(){const _0x555b43=_0x155e1c;return dbSettings[_0x555b43(0x1bc)]('settings')[_0x555b43(0xea)]()||{'timeshift':0x0};}function getSecure(){const _0x289b15=_0x155e1c;return dbSecure[_0x289b15(0x1bc)](_0x289b15(0xc4))[_0x289b15(0xea)]()||{};}function getBlacklist(){const _0x4f5ac6=_0x155e1c;return dbSecure[_0x4f5ac6(0x1bc)](_0x4f5ac6(0x152))[_0x4f5ac6(0xea)]()||[];}function broadcastToBots(_0x3400d8,_0x347dad){config['forEach'](_0x255933=>{const _0x32c734=_0x655b;if(_0x255933[_0x32c734(0x119)]=='enabled'&&_0x255933[_0x32c734(0xfc)]==_0x32c734(0x203)){if(pid[_0x255933[_0x32c734(0x177)]])pid[_0x255933[_0x32c734(0x177)]][_0x32c734(0x1f2)]({[_0x3400d8]:_0x347dad});}});}function storeSettings(_0x301e9d,_0xc2f31e=![]){const _0x29f7ae=_0x155e1c;_0x301e9d={...settings,..._0x301e9d};if(_0xc2f31e&&_0x301e9d[_0x29f7ae(0x191)]!='************'&&_0x301e9d[_0x29f7ae(0x191)]!=''){const _0x363129=crypt[_0x29f7ae(0x1e1)](secure[_0x29f7ae(0x1e6)],_0x301e9d[_0x29f7ae(0x191)])[_0x29f7ae(0xde)]['split']('@')[0x0],_0x2d09dd=bcrypt[_0x29f7ae(0x201)](_0x363129,saltRounds);_0x301e9d={..._0x301e9d,'bbPassword':_0x2d09dd};}if(_0xc2f31e&&_0x301e9d[_0x29f7ae(0x1b9)]!=_0x29f7ae(0x121)&&_0x301e9d[_0x29f7ae(0x1b9)]!=''){const _0x484bb2=crypt[_0x29f7ae(0x1e1)](secure[_0x29f7ae(0x1e6)],_0x301e9d[_0x29f7ae(0x1b9)])[_0x29f7ae(0xde)][_0x29f7ae(0x127)]('@')[0x0];_0x301e9d={..._0x301e9d,'telegramToken':_0x484bb2};}const _0x2c2a0b=_0x301e9d[_0x29f7ae(0x1b9)]!=_0x29f7ae(0x121)&&_0x301e9d[_0x29f7ae(0x1b9)]!=settings[_0x29f7ae(0x1b9)]||_0x301e9d[_0x29f7ae(0x183)]!=settings[_0x29f7ae(0x183)],_0x7c8a50=_0x301e9d[_0x29f7ae(0x1b9)]==''||_0x301e9d[_0x29f7ae(0x183)]=='';if(_0x2c2a0b)_0x301e9d[_0x29f7ae(0xc3)]=_0x29f7ae(0x1a3);for(const [_0x4f5ce2,_0x59e921]of Object[_0x29f7ae(0x134)](_0x301e9d)){if(_0x4f5ce2==_0x29f7ae(0x1b9)&&_0x59e921==_0x29f7ae(0x121)){_0x301e9d[_0x29f7ae(0x1b9)]=settings[_0x29f7ae(0x1b9)];continue;};if(_0x4f5ce2=='bbPassword'&&_0x59e921==_0x29f7ae(0x121)){_0x301e9d[_0x29f7ae(0x191)]=settings[_0x29f7ae(0x191)];continue;};dbSettings[_0x29f7ae(0x112)](_0x29f7ae(0x167)+_0x4f5ce2,_0x59e921)[_0x29f7ae(0xd8)]();}settings=_0x301e9d,io['to']('botmanager')[_0x29f7ae(0x1e0)](_0x29f7ae(0x207),cleanSettings()),broadcastToBots(_0x29f7ae(0xd0),settings[_0x29f7ae(0xd0)]);if(_0x2c2a0b&&!_0x7c8a50)initTelegram();if(_0x2c2a0b&&_0x7c8a50)disableTelegram();getAllClients()['forEach'](_0x54421b=>{const _0x18d5d8=_0x29f7ae;getSocket(_0x54421b['id'])[_0x18d5d8(0x1e0)](_0x18d5d8(0x119),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x1182c3,_0x43e422){const _0x8147e=_0x155e1c;dbSettings[_0x8147e(0x112)](_0x8147e(0x167)+_0x1182c3,_0x43e422)['write'](),settings=getSettings(),io['to'](_0x8147e(0xe3))[_0x8147e(0x1e0)](_0x8147e(0x207),cleanSettings());}function storeSecure(_0x1ec6f1){const _0x38bcb9=_0x155e1c;dbSecure[_0x38bcb9(0x1bc)]('secure')[_0x38bcb9(0x136)](_0x1ec6f1)[_0x38bcb9(0xd8)](),secure=_0x1ec6f1;}function addBlacklist(_0x1b5cae){const _0x1851a4=_0x155e1c;cleanBlacklist();let _0x50c306;devices[_0x1b5cae][_0x1851a4(0x11b)]?_0x50c306=Math[_0x1851a4(0x190)](devices[_0x1b5cae]['telegramIpApproval'][_0x1851a4(0xcd)],loginExpiry):_0x50c306=loginExpiry,dbSecure[_0x1851a4(0x1bc)](_0x1851a4(0x152))[_0x1851a4(0x136)]({'expiry':new Date()['getTime']()+_0x50c306*0x3c*0x3e8,'token':devices[_0x1b5cae][_0x1851a4(0x212)]['token']})[_0x1851a4(0xd8)](),blacklist=dbSecure[_0x1851a4(0x1bc)]('blacklist')[_0x1851a4(0xea)]();}function cleanBlacklist(){const _0x2f1f4f=_0x155e1c;let _0x526a86=dbSecure['get'](_0x2f1f4f(0x152))[_0x2f1f4f(0x163)]()[_0x2f1f4f(0xea)](),_0x3d3edc=new Date()[_0x2f1f4f(0x1fc)]();_0x526a86[_0x2f1f4f(0x1e9)](_0x591cc8=>{const _0x46bca3=_0x2f1f4f;_0x591cc8['expiry']<_0x3d3edc&&dbSecure[_0x46bca3(0x1bc)](_0x46bca3(0x152))[_0x46bca3(0x135)]({'expiry':_0x591cc8['expiry']})[_0x46bca3(0xd8)]();});}function initStates(){const _0x205a1c=_0x155e1c;let _0x427502=getConfiguration();_0x427502[_0x205a1c(0x1e9)](_0x36eddc=>{const _0x63570b=_0x205a1c;_0x36eddc['live']=_0x63570b(0x130);}),storeConfiguration(_0x427502);}function onKeys(){const _0x48f6e9=new RSA();return new Promise(_0x26d2e9=>{const _0x1a7e87=_0x655b;_0x48f6e9[_0x1a7e87(0x1b1)]()[_0x1a7e87(0x17b)](_0x2731b2=>{_0x26d2e9(_0x2731b2);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1abf4a=_0x155e1c;let _0x23ef5f=getConfiguration(),_0x4736d3=![];_0x23ef5f[_0x1abf4a(0x1e9)](_0x281371=>{const _0x1e6f09=_0x1abf4a;if(_0x281371[_0x1e6f09(0x119)]==_0x1e6f09(0x203))_0x281371['status']=_0x1e6f09(0x20a),_0x4736d3=!![];else _0x281371[_0x1e6f09(0x119)]==_0x1e6f09(0x130)&&(_0x281371[_0x1e6f09(0x119)]=_0x1e6f09(0x1bd),_0x4736d3=!![]);});if(_0x4736d3)storeConfiguration(_0x23ef5f);let _0x307e27=getSecure();if(!_0x307e27[_0x1abf4a(0x1c7)](_0x1abf4a(0x1e2))){let _0x576427=await generateKeys();_0x307e27[_0x1abf4a(0x1fa)]=_0x576427['publicKey'],_0x307e27[_0x1abf4a(0x1e6)]=_0x576427[_0x1abf4a(0x1e6)],_0x307e27[_0x1abf4a(0x1e2)]=crypto[_0x1abf4a(0x173)](0x20)[_0x1abf4a(0x187)](_0x1abf4a(0x1f4));;storeSecure(_0x307e27);}let _0x1673e8=getSettings();_0x4736d3=![];!_0x1673e8[_0x1abf4a(0x1c7)](_0x1abf4a(0xdf))&&(_0x1673e8[_0x1abf4a(0xdf)]=![],_0x1673e8['bbUsername']='',_0x1673e8[_0x1abf4a(0x191)]='',_0x1673e8['f2aRequired']=![],_0x4736d3=!![]);!_0x1673e8[_0x1abf4a(0x1c7)](_0x1abf4a(0x153))&&(_0x1673e8['whitelistEnabled']=![],_0x1673e8[_0x1abf4a(0x189)]=[],_0x1673e8[_0x1abf4a(0x102)]=![],_0x4736d3=!![]);if(!_0x1673e8[_0x1abf4a(0x1c7)](_0x1abf4a(0x12a))){if(_0x1673e8[_0x1abf4a(0x12b)])_0x1673e8[_0x1abf4a(0x12a)]=!![];else _0x1673e8['telegramEnabled']=![];_0x4736d3=!![];}if(_0x4736d3)storeSettings(_0x1673e8);}function storeConfiguration(_0x17d417){const _0xbbd747=_0x155e1c;dbConfig[_0xbbd747(0x1bc)](_0xbbd747(0x123))['remove']()[_0xbbd747(0xd8)](),dbConfig['get'](_0xbbd747(0x123))[_0xbbd747(0x136)](..._0x17d417)['write'](),config=_0x17d417;}function resetPassword(){const _0xb3334a=_0x155e1c;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0xb3334a(0x137)),tgBot['sendMessage'](settings[_0xb3334a(0x12b)],_0xb3334a(0x141),{'parse_mode':_0xb3334a(0x161),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0xb3334a(0x16b)](_0x167f89=>{telegramError(_0x167f89);}),tgBot['on'](_0xb3334a(0x137),async _0xe8c66f=>{const _0x2a66fe=_0xb3334a,_0x2d4e4e=_0xe8c66f[_0x2a66fe(0x174)],_0x51815b=_0xe8c66f[_0x2a66fe(0xde)];tgBot['answerCallbackQuery'](_0xe8c66f['id'])[_0x2a66fe(0x17b)](async()=>{const _0x1966d7=_0x2a66fe;if(_0x2d4e4e!='no'){const _0x207a46=0xf,_0x4b9017=_0x1966d7(0x116),_0x2ecf69=Array[_0x1966d7(0x1bf)](crypto['randomFillSync'](new Uint32Array(_0x207a46)))[_0x1966d7(0x1d0)](_0x47c5f0=>_0x4b9017[_0x47c5f0%_0x4b9017[_0x1966d7(0x18a)]])['join'](''),_0x4ce67e=bcrypt[_0x1966d7(0x201)](_0x2ecf69,saltRounds);storeSettings({'bbPassword':_0x4ce67e}),await tgBot['sendMessage'](_0x51815b[_0x1966d7(0x110)]['id'],_0x1966d7(0x197)+_0x2ecf69,{'parse_mode':'HTML'})[_0x1966d7(0x16b)](_0x5d0016=>{telegramError(_0x5d0016);});}else await tgBot[_0x1966d7(0x132)](_0x51815b[_0x1966d7(0x110)]['id'],'Password\x20reset\x20rejected')[_0x1966d7(0x16b)](_0x1d94f7=>{telegramError(_0x1d94f7);});}),tgBot[_0x2a66fe(0x131)](_0x2a66fe(0x137));}));}function logging(_0x5e60d7){const _0x52fd9a=_0x155e1c;console['log'](getTimeStamp()+_0x52fd9a(0x120)+_0x5e60d7);if(tgBot&&settings[_0x52fd9a(0x12b)]&&settings[_0x52fd9a(0xc3)]!=_0x52fd9a(0x114))tgBot[_0x52fd9a(0x132)](settings[_0x52fd9a(0x12b)],_0x52fd9a(0x178)+_0x5e60d7)['catch'](_0x569102=>{telegramError(_0x569102);});}function getServerTime(){const _0x5c3773=_0x155e1c,_0x39ffdb=new Date();return _0x39ffdb['getFullYear']()+'/'+(_0x39ffdb[_0x5c3773(0xe7)]()+0x1)['toString']()[_0x5c3773(0x205)](0x2,'0')+'/'+_0x39ffdb[_0x5c3773(0xf3)]()[_0x5c3773(0x187)]()['padStart'](0x2,'0')+'\x20'+_0x39ffdb[_0x5c3773(0x1a4)]()[_0x5c3773(0x187)]()[_0x5c3773(0x205)](0x2,'0')+':'+_0x39ffdb['getMinutes']()[_0x5c3773(0x187)]()[_0x5c3773(0x205)](0x2,'0')+':'+_0x39ffdb[_0x5c3773(0x144)]()[_0x5c3773(0x187)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x338c16=_0x155e1c,_0x2a04f6=shiftedTime();return _0x2a04f6[_0x338c16(0x11f)]()+'/'+(_0x2a04f6[_0x338c16(0xe7)]()+0x1)[_0x338c16(0x187)]()[_0x338c16(0x205)](0x2,'0')+'/'+_0x2a04f6[_0x338c16(0xf3)]()[_0x338c16(0x187)]()['padStart'](0x2,'0')+'\x20'+_0x2a04f6[_0x338c16(0x1a4)]()[_0x338c16(0x187)]()[_0x338c16(0x205)](0x2,'0')+':'+_0x2a04f6['getMinutes']()['toString']()[_0x338c16(0x205)](0x2,'0')+':'+_0x2a04f6[_0x338c16(0x144)]()[_0x338c16(0x187)]()[_0x338c16(0x205)](0x2,'0');}function shiftedTime(){const _0x464e1d=_0x155e1c,_0x6607ae=new Date();let _0x4a6bdc=_0x6607ae;if(settings[_0x464e1d(0xd0)]&&settings['timeshift']!==0x0)_0x4a6bdc=fns[_0x464e1d(0x10d)](_0x6607ae,{'hours':settings[_0x464e1d(0xd0)]});return _0x4a6bdc;}function startScheduler(){const _0x28f49e=_0x155e1c;let _0x26c2ea=new Date()[_0x28f49e(0x115)]();_0x26c2ea==0x1&&backupConfigFiles();_0x26c2ea==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x44fe93=_0x155e1c;fs[_0x44fe93(0x146)](configpath,{'withFileTypes':!![]})[_0x44fe93(0x1e9)](_0x3b49cc=>{const _0x214bb7=_0x44fe93;if(!_0x3b49cc[_0x214bb7(0xdd)]())fs[_0x214bb7(0xec)](configpath+_0x3b49cc[_0x214bb7(0x14b)],configbackuppath+_0x3b49cc[_0x214bb7(0x14b)]);});}function triggerAnalytics(){const _0x2ad68a=_0x155e1c;analytics[_0x2ad68a(0x10e)]({'title':'Balance\x20Bot\x20Server','href':_0x2ad68a(0x1ab),'path':'/v'+serverversion});}function validateCredentials(_0x4fac77,_0x5297fb){const _0x49250f=_0x155e1c;if(_0x4fac77['username']==settings[_0x49250f(0x104)]&&bcrypt[_0x49250f(0x1d6)](_0x4fac77[_0x49250f(0x16c)],settings[_0x49250f(0x191)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x49250f(0xf2),'token':null};else{const _0x4d223f=generateLoginToken(_0x5297fb);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4d223f};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x27c006){const _0x2bae1f=_0x155e1c,_0xe810f7=generateLoginToken(_0x27c006);return{'allow':!![],'reason':_0x2bae1f(0x145),'token':_0xe810f7};}function validateAccess(_0x1533f3,_0x5e4755){const _0x315466=_0x155e1c;let _0x44a285=devices[_0x5e4755]['ip'],_0x13ceca;const _0x167468=_0x130a99=>{const _0x992339=_0x655b;if(settings[_0x992339(0xdf)]){if(settings[_0x992339(0x10b)]){if(telegram2FaApproved(_0x5e4755)){const _0x1637ed=generateLoginToken(_0x5e4755);return{'allow':!![],'reason':_0x992339(0x155),'token':_0x1637ed};}else return{'allow':![],'reason':_0x992339(0xfb),'token':null};}else return _0x13ceca=validToken(_0x130a99,_0x5e4755),_0x13ceca[_0x992339(0x1c7)](_0x992339(0xce))?{'allow':!![],'reason':_0x992339(0x12c),'token':_0x130a99}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x315466(0x153)]){let _0x3692e3=[...settings[_0x315466(0x189)],_0x315466(0x1c8),_0x315466(0x15e),_0x315466(0x1ee)];if(_0x3692e3['includes'](_0x44a285))return _0x167468(_0x1533f3);else{_0x13ceca=validToken(_0x1533f3,_0x5e4755);if(_0x13ceca['hasOwnProperty']('success'))return _0x167468(_0x1533f3);else{if(telegramIpApproved(_0x5e4755)){const _0x13082e=generateToken(_0x5e4755);return _0x13ceca=_0x167468(_0x1533f3),_0x13ceca[_0x315466(0x1e8)]?{'allow':!![],'reason':_0x315466(0x118),'token':_0x13082e}:_0x13ceca;}else return settings[_0x315466(0x102)]?{'allow':![],'reason':_0x315466(0xe8),'token':null}:{'allow':![],'reason':_0x315466(0x17c),'token':null};}}}else return _0x167468(_0x1533f3);}function timelyDecrypt(_0x2f6e59,_0x80129b=!![]){const _0x15c73d=_0x155e1c;if(_0x2f6e59)try{const _0x1fbe97=crypt[_0x15c73d(0x1e1)](secure[_0x15c73d(0x1e6)],_0x2f6e59)[_0x15c73d(0xde)],_0x265589=_0x1fbe97['split']('@')[0x0],_0x57521f=_0x1fbe97[_0x15c73d(0x127)]('@')[0x1],_0x50f741=new Date()[_0x15c73d(0x1fc)]();if(_0x80129b){if(_0x50f741-_0x57521f<maxSecretAge*0x3e8)return _0x265589;else return![];}else return _0x265589;}catch(_0x2f7d9b){return![];}else return![];}const validToken=(_0x64a113,_0x96c8ab)=>{const _0x2812f8=_0x155e1c,_0x4178bd=devices[_0x96c8ab]['ip'];if(!_0x64a113)return{'error':_0x2812f8(0x185)};for(let _0x28bc0a of blacklist){if(_0x28bc0a[_0x2812f8(0xf8)]==_0x64a113)return{'error':_0x2812f8(0x15f)};}let _0x132275;try{_0x132275=jwt[_0x2812f8(0x1ff)](_0x64a113,secure[_0x2812f8(0x1e2)]+_0x96c8ab);}catch{return{'error':_0x2812f8(0x15c)};}if(!_0x132275['hasOwnProperty'](_0x2812f8(0x209))&&!_0x132275[_0x2812f8(0x1c7)]('username')||!_0x132275[_0x2812f8(0x1c7)](_0x2812f8(0x1c1)))return{'error':_0x2812f8(0x213)};if(!_0x132275['hasOwnProperty']('username')&&_0x132275[_0x2812f8(0x1c7)](_0x2812f8(0x209))){const {clientip:_0x2ca453}=_0x132275;return _0x4178bd==_0x2ca453?{'success':_0x2812f8(0x199)}:{'error':_0x2812f8(0x157)};}else{if(_0x132275[_0x2812f8(0x1c7)](_0x2812f8(0x129))&&_0x132275[_0x2812f8(0x1c7)](_0x2812f8(0x209))){const {username:_0x1fd1f9,clientip:_0x3e4bbc}=_0x132275;return settings[_0x2812f8(0x104)]==_0x1fd1f9&&_0x4178bd==_0x3e4bbc?{'success':_0x2812f8(0x199)}:{'error':_0x2812f8(0x20d)};}}},generateLoginToken=_0x7333ee=>{const _0x2a38a8=_0x155e1c;if(_0x7333ee){const _0x32aabe=devices[_0x7333ee]['ip'];return jwt[_0x2a38a8(0x1c6)]({'username':settings['bbUsername'],'clientip':_0x32aabe},secure['secret']+_0x7333ee,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1f6c1e=>{const _0x3d5191=_0x155e1c;if(_0x1f6c1e){const _0x4c4468=devices[_0x1f6c1e]['ip'];return jwt[_0x3d5191(0x1c6)]({'clientip':_0x4c4468},secure['secret']+_0x1f6c1e,{'expiresIn':devices[_0x1f6c1e]['telegramIpApproval'][_0x3d5191(0xcd)]*0x3c});}else return![];},telegramIpApproved=_0x3d20d4=>{const _0xcda9ce=_0x155e1c;let _0x58f37a=![];return devices[_0x3d20d4]['telegramIpApproval']&&devices[_0x3d20d4][_0xcda9ce(0x11b)]['expiry']!=_0xcda9ce(0xf0)&&(_0x58f37a=devices[_0x3d20d4][_0xcda9ce(0x11b)][_0xcda9ce(0x209)]==devices[_0x3d20d4]['ip']&&new Date()[_0xcda9ce(0x1fc)]()-devices[_0x3d20d4][_0xcda9ce(0x11b)][_0xcda9ce(0x1a5)]<devices[_0x3d20d4]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x58f37a;},telegram2FaApproved=_0x171c64=>{const _0x4ad67e=_0x155e1c;let _0x1f83f6=![];return devices[_0x171c64][_0x4ad67e(0x126)]&&devices[_0x171c64]['telegram2FaApproval'][_0x4ad67e(0xcd)]!=_0x4ad67e(0xf0)&&(_0x1f83f6=devices[_0x171c64][_0x4ad67e(0x126)]['clientip']==devices[_0x171c64]['ip']&&new Date()[_0x4ad67e(0x1fc)]()-devices[_0x171c64][_0x4ad67e(0x126)][_0x4ad67e(0x1a5)]<devices[_0x171c64][_0x4ad67e(0x126)][_0x4ad67e(0xcd)]*0x3c*0x3e8),_0x1f83f6;},normalizeIP=_0x9875b2=>{const _0x571701=_0x155e1c;let _0x2bc7ae=null,_0x28d6ad=null;if(ipaddr[_0x571701(0x124)](_0x9875b2)){const _0x386c17=ipaddr[_0x571701(0x1a6)](_0x9875b2);_0x386c17[_0x571701(0x17a)]()==='ipv6'?(_0x386c17[_0x571701(0xcf)]()&&(_0x2bc7ae=_0x386c17[_0x571701(0x1fb)]()['toString']()),_0x28d6ad=_0x386c17[_0x571701(0x187)]()):(_0x2bc7ae=_0x386c17[_0x571701(0x187)](),_0x28d6ad=_0x386c17['toIPv4MappedAddress']()['toString']());}return{'show':_0x2bc7ae?_0x2bc7ae:_0x28d6ad,'store':_0x28d6ad};};