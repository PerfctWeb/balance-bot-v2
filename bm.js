const _0x5e557c=_0x3723;(function(_0x222bcd,_0x39d970){const _0x5555da=_0x3723,_0x2b7562=_0x222bcd();while(!![]){try{const _0x3f253e=parseInt(_0x5555da(0x13b))/0x1*(-parseInt(_0x5555da(0xce))/0x2)+-parseInt(_0x5555da(0xd4))/0x3*(-parseInt(_0x5555da(0x164))/0x4)+-parseInt(_0x5555da(0x128))/0x5+parseInt(_0x5555da(0x165))/0x6+-parseInt(_0x5555da(0x12e))/0x7+parseInt(_0x5555da(0x265))/0x8*(parseInt(_0x5555da(0x1ea))/0x9)+parseInt(_0x5555da(0x12f))/0xa*(parseInt(_0x5555da(0x189))/0xb);if(_0x3f253e===_0x39d970)break;else _0x2b7562['push'](_0x2b7562['shift']());}catch(_0x5b5018){_0x2b7562['push'](_0x2b7562['shift']());}}}(_0x1076,0xf26a3));const _0x5b29ec=function(){let _0x13c5fe=!![];return function(_0x1daf1d,_0x1152cf){const _0x563978=_0x13c5fe?function(){const _0x20a2f7=_0x3723;if(_0x1152cf){const _0x2cedd4=_0x1152cf[_0x20a2f7(0x263)](_0x1daf1d,arguments);return _0x1152cf=null,_0x2cedd4;}}:function(){};return _0x13c5fe=![],_0x563978;};}(),_0x1084fd=_0x5b29ec(this,function(){const _0x5919d5=_0x3723;return _0x1084fd[_0x5919d5(0xc7)]()['search']('(((.+)+)+)+$')[_0x5919d5(0xc7)]()[_0x5919d5(0x19b)](_0x1084fd)['search'](_0x5919d5(0x17b));});_0x1084fd();'use strict';process[_0x5e557c(0x1b2)][_0x5e557c(0x9f)]=0x1;const childProcess=require(_0x5e557c(0xae)),fs=require('fs'),fns=require('date-fns'),low=require(_0x5e557c(0x1d5)),FileSync=require(_0x5e557c(0x156)),path=require(_0x5e557c(0x253)),crypto=require(_0x5e557c(0x149)),Crypt=require(_0x5e557c(0x16d))['Crypt'],RSA=require(_0x5e557c(0x16d))[_0x5e557c(0x245)],bcrypt=require(_0x5e557c(0x140)),jwt=require(_0x5e557c(0x151)),ipaddr=require(_0x5e557c(0x24a)),argv=require(_0x5e557c(0x166))(process[_0x5e557c(0x1ee)][_0x5e557c(0x135)](0x2))[_0x5e557c(0x1ee)],uuidRandom=require(_0x5e557c(0x1c3)),TelegramBot=require(_0x5e557c(0x15a)),Mixpanel=require('mixpanel'),axios=require(_0x5e557c(0x144)),{GraphQLClient,gql}=require(_0x5e557c(0x17d)),util=require(_0x5e557c(0x10e)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x5e557c(0x134)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x5e557c(0x1f8)](PORT)&&(console[_0x5e557c(0x175)](_0x5e557c(0x94)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x5e557c(0x1e1)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x5e557c(0xda)][_0x5e557c(0x208)],environment=require(_0x5e557c(0x158))[_0x5e557c(0x1fb)]||'production';let bbpath=_0x5e557c(0x115),bbpath2='';const botfile=_0x5e557c(0xc0),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x5e557c(0x114)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5e557c(0x183)),configpath=userID?bbpath+_0x5e557c(0xd0)+userID+'/':bbpath+_0x5e557c(0xd0),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x5e557c(0x181),zippath=userID?bbpath+_0x5e557c(0x12c)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x5e557c(0xa6)](logspath+_0x5e557c(0x8d),{'flags':'a'}),temppath=userID?bbpath+_0x5e557c(0x124)+userID+'/':bbpath+_0x5e557c(0x124);!fs['existsSync'](configpath)&&fs[_0x5e557c(0x170)](configpath);!fs[_0x5e557c(0x114)](configbackuppath)&&fs[_0x5e557c(0x170)](configbackuppath);!fs[_0x5e557c(0x114)](logspath)&&fs[_0x5e557c(0x170)](logspath);function _0x1076(){const _0x5ebd5b=['expiry','Error:\x20Invalid\x20argument\x20','telegramChatId','getHours','Unauthorized\x20attempt\x20to\x20delete\x20bot','\x20minutes','Unauthorized\x20attempt\x20to\x20store\x20configuration','logout','Unauthorized\x20attempt\x20to\x20get\x20portfolio','inherit','apiKey','2FA\x20required','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','exp','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Deleted\x20Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','temporary\x20token\x20generated','createWriteStream','timestamp','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','secret','Notifications\x20types:\x20','sendMetricsTelegram','store-configuration','Server','child_process','secure','stopPolling','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','storeHeadless','showConfig','uncaughtException','sha256','\x20|\x20user:\x20...','running','event','\x1b[33m','alerts','#RES#\x20if\x20running\x20on\x20server','(staging)','warning','update-bb','Restore\x20process\x20aborted','bot.js','Starting\x20bot\x20|\x20Bot\x20','stop','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','telegram2FaApproval','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','store-settings','toString','botID','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','sockets','reinstall','binary',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','12386TfhOgu','=>\x20Go\x20to\x20#CYA#http://','config/',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','\x1b[0m','Password\x20reset\x20rejected','3UFMYey','-events.json','place-order','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','join','disconnect','versions','debug','post','uuid','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','server','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','\x20only\x0a','message','getStartingBalances','sort','/names\x20-\x20show\x20bot\x20names\x0a','blacklist','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','temporary\x20access\x20rejected','/:bot/configuration','reinstall-bb','error','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20add\x20bot','delete-bot','removeListener','reject','botname','Starting\x20#RED#Balance\x20Bot\x20v','then','Restarting\x20Bot\x20','exec','map','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','unlinkSync','version.json','telegramToken','sendMessage','Error\x20removing\x20old\x20backup\x20files:','initclient','SIGINT','writeFileSync','output-002.log','from','track','callback_query','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','function','sendFile','Unauthorized\x20attempt\x20to\x20get\x20events','simple','name','verify','http','showname',':\x20Bot\x20Mgr\x20>\x20','util','output-003.log','show','randomFillSync','$1_$2_$3','backupfile','existsSync','bb/','handshake','connection','randomBytes','DEFLATE','backup-full@','telegramIpApproval','backup-full','getDate','6b67f3d61ee94b8f5c80b4affef4c4d9','Backup\x20file\x20unzipped\x20and\x20stored','Ok,\x20will\x20send\x20alert\x20notifications\x20only','getSeconds','files','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','temp/','/metrics\x20-\x20show\x20bot\x20performance\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','2FA','4397345odaVkg','mtime','generate','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','zip/','push','10834005DZrPra','275860zFvFWG','botmanager','full','size','-config.json','port','slice','stopped','enabled','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','File\x20uploaded','temporary\x20access\x20timeout','142rGORry','bbPassword','Temporary\x20access\x20rejected','cancel-loading','hashSync','bcryptjs','api-eu.mixpanel.com','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','sign','axios','Logged\x20out\x20user\x20...','reload','all','RSA-OAEP','crypto','Idling\x20bot\x20\x20\x20|\x20Bot\x20','.zip','statSync','Restore\x20backup\x20file\x20','Access\x20enabled\x20for\x20','latestversion','Token\x20blacklisted','jsonwebtoken','Notifications\x20disabled\x0a','-performance.json','</b>\x20?','allow','lowdb/adapters/FileSync','delete-alerts','./version.json','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','node-telegram-bot-api','disabled','build','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','access\x20timeout','split','encryptedUuid','yes','HTML','650272qJqXzc','11310834YYErZT','yargs/yargs','pidRefreshToken','#RES#\x20','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','generateKeyPairAsync','bots','includes','hybrid-crypto-js','number','0.0.0','mkdirSync','new-disabled','login\x20token\x20generated','request','invalid\x20credentials','log','type','isValid','token','Setting\x20access:\x20','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','(((.+)+)+)+$','::1','graphql-request','onText','once','assign','logs/','live','clients','auto','All\x20bots\x20running\x20right\x20now','apiPassword','All\x20bots','#RES#\x20if\x20running\x20locally\x0a','264qgwDzN','reason','send','bbvNew','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','messages','store-fiat','/:bot/coins','write','timeshift','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','tkn','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','startsWith','headers','match','/off\x20-\x20stop\x20bot(s)\x0a','constructor','storeConfiguration','file','/update\x20-\x20update\x20Balance\x20Bot\x0a','socket.io','getMonth','bb-settings.json','polling_error','value','defaults','login\x20not\x20required','access','1000','keys','telegramUsername','set','2FA\x20login\x20rejected','success','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Starting\x20Balance\x20Bot\x20update','toIPv4Address','/download/:type','/:bot','env','Unauthorized\x20attempt\x20to\x20get\x20messages','backup-full.zip','404\x20Not\x20Found','get-backup-files','backup-files','************','lastmsgtelegram','Alerts','pidExpireLogin','User\x20has\x20been\x20validated','30\x20min','started','cloneDeep','\x20mode','output-001.log','username','uuid-random','placeOrder','SIGTERM','/upload-backup','catch','alias','new','-----------------------------------------------------------------------------------','compareSync','*$1*','Node.js\x20v','publicKey','data','endsWith','readFileSync','15\x20min','headless','settings.','lowdb','telegramEnabled','telegrammsg','onepagemode','bot-','node-zip','Invalid\x20IP\x20address','restart','Login\x20rejected','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','address','add','host','index.html','5\x20min','auth','getFullYear','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getUTCHours','getPortfolio','14307750UimsVj','::ffff:127.0.0.1','[ip-address]','Unauthorized\x20attempt\x20to\x20update\x20bot','argv','/:bot/support','status','length','get','isIPv4MappedAddress','temporaryAccessAllowed','exit','Unauthorized\x20attempt\x20to\x20confirm\x20message','get-logs','test','Failed\x20to\x20download\x20','bot','environment','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','readdirSync','Notifications\x20disabled','bbvReceive','telegram','Allow\x20login\x20from\x20IP\x20address\x20<b>','password','Notifications\x20enabled','format','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','chat','toggleBotMode','node','decrypt','mode','\x1b[35m','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','manual','use','add-bot','range','storeFiat','sortBy','accept','Restoring\x20bot(s)\x20from\x20backup','login','hasOwnProperty','lastmsgemitted','resetHistory','rmSync','notification','replace','kill','removeAllListeners','loginRequired','get-messages','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getMinutes','Bot\x20Mgr\x20>\x20','\x20(2)','isDirectory','family','find','bbUsername','login\x20token\x20valid','output-000.log','No\x20authentication\x20token','\x1b[36m','referer','***','2FA\x20login\x20token\x20generated','login\x20required','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','hex','clientip','kind','f2aRequired','parse','/restart\x20-\x20restart\x20bot(s)\x0a','remoteAddress','store','remove','forEach','settings','/:bot/performance','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','bb-secure.json','Logged\x20in\x20user\x20...','Bot\x20','No\x20bots\x20running\x20right\x20now','internal','Unauthorized\x20attempt\x20to\x20log\x20out','privateKey','RSA','update','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','static','Backup\x20file\x20uploaded','ipaddr.js','\x20|\x20','userid','express','private','backup','orders','order','string','path','answerCallbackQuery','getTime','logs','copyFileSync','telegramEvents','version','Network\x20Interfaces:','listen','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','connected','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','store-headless','get-starting-balances','-results.json','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','apply','socket','8NbYdiH','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Login\x20accepted','\x20(1)','padStart','sendPortfolioTelegram','<b>Balance\x20Bot\x20Status:</b>\x0a','stringify','Unauthorized\x20attempt\x20to\x20download\x20','/output-000.log','127.0.0.1','conn','emit','filter','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?'];_0x1076=function(){return _0x5ebd5b;};return _0x1076();}!fs[_0x5e557c(0x114)](zippath)&&fs[_0x5e557c(0x170)](zippath);!fs[_0x5e557c(0x114)](temppath)&&fs[_0x5e557c(0x170)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5e557c(0x1a4)]({'bots':[]})[_0x5e557c(0x191)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5e557c(0x16f),'onepagemode':![]}})[_0x5e557c(0x191)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5e557c(0x1a4)]({'secure':{},'blacklist':[]})[_0x5e557c(0x191)]();let crypt=new Crypt({'md':_0x5e557c(0xb5),'rsaStandard':_0x5e557c(0x148)});function _0x3723(_0x4d8c28,_0x46a1c6){const _0x5479a0=_0x1076();return _0x3723=function(_0x1084fd,_0x5b29ec){_0x1084fd=_0x1084fd-0x8c;let _0x107631=_0x5479a0[_0x1084fd];return _0x107631;},_0x3723(_0x4d8c28,_0x46a1c6);}const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x5e557c(0x11e),{'host':_0x5e557c(0x141)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x5e557c(0xfa)]&&settings['telegramToken']!=''&&settings[_0x5e557c(0x1a9)]&&settings[_0x5e557c(0x1a9)]!='')initTelegram();const parseColor=(_0x577eea,_0x5645cf)=>{const _0x3a7666=_0x5e557c,_0x70810=/#[A-Z]{3}#/g;if(typeof _0x577eea==_0x3a7666(0x252)){!_0x5645cf?_0x577eea=_0x577eea[_0x3a7666(0x21b)](_0x70810,''):(_0x577eea=_0x577eea['replace'](/#BLU#/g,'\x1b[34m'),_0x577eea=_0x577eea['replace'](/#RED#/g,'\x1b[31m'),_0x577eea=_0x577eea['replace'](/#YEL#/g,_0x3a7666(0xb9)),_0x577eea=_0x577eea[_0x3a7666(0x21b)](/#MAG#/g,_0x3a7666(0x20b)),_0x577eea=_0x577eea[_0x3a7666(0x21b)](/#CYA#/g,_0x3a7666(0x22b)),_0x577eea=_0x577eea['replace'](/#RES#/g,_0x3a7666(0xd2)));;}return _0x577eea;},logger={'screen':_0x2b2605=>{const _0x2ae6c4=_0x5e557c;console[_0x2ae6c4(0x175)](parseColor(_0x2b2605,!![]));},'simple':_0x4d1cd8=>{const _0x3380a0=_0x5e557c;console[_0x3380a0(0x175)](parseColor(_0x4d1cd8,!![])),loggerfile[_0x3380a0(0x191)](util[_0x3380a0(0x204)](parseColor(_0x4d1cd8,![]))+'\x0a');},'full':async _0x23f43f=>{const _0xb7689=_0x5e557c,_0x283464=getTimeStamp()+_0xb7689(0x10d)+_0x23f43f;console['log'](parseColor(_0x283464,!![])),loggerfile[_0xb7689(0x191)](util['format'](parseColor(_0x283464,![]))+'\x0a');if(tgBot&&settings[_0xb7689(0x95)]&&settings[_0xb7689(0x258)]!='orders')await tgBot[_0xb7689(0xfb)](settings[_0xb7689(0x95)],_0xb7689(0x222)+parseColor(_0x23f43f,![]))[_0xb7689(0x1c7)](_0x309854=>{telegramError(_0x309854);});},'debug':async(_0x10aced,_0x5d74e3='')=>{const _0xee8cd4=_0x5e557c,_0x33126c=getTimeStamp()+_0xee8cd4(0xcd)+_0x10aced;if(debugging)console[_0xee8cd4(0x175)](parseColor(_0x33126c,!![]));loggerfile['write'](util[_0xee8cd4(0x204)](parseColor(_0x33126c,![]))+'\x0a');if(_0x5d74e3){if(debugging)console['log'](_0x5d74e3);loggerfile['write'](util[_0xee8cd4(0x204)](_0x5d74e3)+'\x0a');}}};process['on'](_0x5e557c(0xb4),function(_0x1edff5){const _0x1c8695=_0x5e557c;logger[_0x1c8695(0x108)](_0x1edff5);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5e557c(0xf9))[_0x5e557c(0x259)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5e557c(0x24d)),app=express(),http=require(_0x5e557c(0x10b))['createServer'](app);app[_0x5e557c(0x20e)](fileUpload({'useTempFiles':!![]})),app[_0x5e557c(0x1f2)](_0x5e557c(0x1b0),async(_0x28b786,_0x45abef)=>{const _0x44158b=_0x5e557c,_0x2940b0=_0x28b786['params'][_0x44158b(0x176)],_0x2ab1ac=getClientsWithBotID(_0x44158b(0x130)),_0x1753ac=_0x28b786[_0x44158b(0x198)]['uuid'],_0x5a5d45=timelyDecrypt(_0x1753ac,![]),_0xfa309=_0x2ab1ac[_0x44158b(0x226)](_0x57ef69=>_0x57ef69[_0x44158b(0xdd)]==_0x5a5d45);if(_0xfa309){const _0x468ae5=normalizeIP(_0x28b786[_0x44158b(0x264)][_0x44158b(0x237)])[_0x44158b(0x238)],_0x43b77d=_0x28b786[_0x44158b(0x198)]['tkn'];if(validateAccess(_0x43b77d,_0x5a5d45,_0x468ae5)[_0x44158b(0x155)])_0x2940b0==_0x44158b(0x24f)&&await backupConfigFiles(),await zipFiles(_0x2940b0),_0x45abef['download'](zippath+(_0x2940b0+'.zip'),_0x4f76d5=>{const _0x1d1350=_0x44158b;_0x4f76d5&&(logger[_0x1d1350(0x131)](_0x1d1350(0x1f9)+_0x2940b0),logger['simple'](_0x4f76d5));});else logger['full'](_0x44158b(0x8c)+_0x2940b0+_0x44158b(0x268));}else logger['full'](_0x44158b(0x8c)+_0x2940b0+_0x44158b(0x223));}),app[_0x5e557c(0xdc)](_0x5e557c(0x1c6),async(_0x21cb52,_0x328c78)=>{const _0x58437d=_0x5e557c,_0x1974b4=getClientsWithBotID(_0x58437d(0x130)),_0x3ab9b6=_0x21cb52[_0x58437d(0x198)][_0x58437d(0xdd)],_0x56155c=timelyDecrypt(_0x3ab9b6,![]),_0x5a9243=_0x1974b4[_0x58437d(0x226)](_0x56ef36=>_0x56ef36[_0x58437d(0xdd)]==_0x56155c);logger[_0x58437d(0xdb)](_0x58437d(0x249));if(_0x5a9243){const _0x50c388=normalizeIP(_0x21cb52['socket'][_0x58437d(0x237)])[_0x58437d(0x238)],_0x286088=_0x21cb52[_0x58437d(0x198)][_0x58437d(0x194)];if(validateAccess(_0x286088,_0x56155c,_0x50c388)['allow']){if(_0x21cb52['files']){const _0x5eb74b=_0x21cb52[_0x58437d(0x122)][_0x58437d(0x113)];await _0x5eb74b['mv'](temppath+_0x5eb74b[_0x58437d(0x109)]),_0x328c78[_0x58437d(0x18b)]({'status':!![],'message':_0x58437d(0x139)});const _0x5b32c8=getBotsWithMode();_0x5b32c8['length']>0x0?confirmRestore(temppath,_0x5eb74b['name']):unzipFile(temppath,_0x5eb74b['name']);}}else logger['full'](_0x58437d(0x1de));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x5e557c(0x20e)](express['static'](path['join'](__dirname,bbpath2,'build2'))),app[_0x5e557c(0x20e)](express[_0x5e557c(0x248)](path[_0x5e557c(0xd8)](__dirname,bbpath2,_0x5e557c(0x15c)))),app[_0x5e557c(0x1f2)]('/',function(_0x1d972a,_0x2a21c7){const _0x2b9a8a=_0x5e557c;_0x2a21c7[_0x2b9a8a(0x106)](path[_0x2b9a8a(0xd8)](__dirname,bbpath2,'build2',_0x2b9a8a(0x1e2)));}),app[_0x5e557c(0x1f2)](_0x5e557c(0x1b1),function(_0x58f756,_0x24f708){const _0x39d923=_0x5e557c;_0x24f708[_0x39d923(0x106)](path[_0x39d923(0xd8)](__dirname,bbpath2,'build',_0x39d923(0x1e2)));}),app[_0x5e557c(0x1f2)]('/:bot/portfolio',(_0x47a714,_0x238028)=>{const _0x23ac0c=_0x5e557c;_0x238028[_0x23ac0c(0x106)](path[_0x23ac0c(0xd8)](__dirname,bbpath2,_0x23ac0c(0x15c),_0x23ac0c(0x1e2)));}),app[_0x5e557c(0x1f2)](_0x5e557c(0x23c),(_0x58a359,_0x33a774)=>{const _0x150770=_0x5e557c;_0x33a774[_0x150770(0x106)](path[_0x150770(0xd8)](__dirname,bbpath2,_0x150770(0x15c),_0x150770(0x1e2)));}),app['get'](_0x5e557c(0x190),(_0x9c4b1,_0x2df81a)=>{const _0x3d37c1=_0x5e557c;_0x2df81a[_0x3d37c1(0x106)](path['join'](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/history',(_0x471aa1,_0x335643)=>{const _0x24f556=_0x5e557c;_0x335643[_0x24f556(0x106)](path[_0x24f556(0xd8)](__dirname,bbpath2,_0x24f556(0x15c),_0x24f556(0x1e2)));}),app[_0x5e557c(0x1f2)](_0x5e557c(0xe9),(_0x56a626,_0x560812)=>{const _0x122a07=_0x5e557c;_0x560812[_0x122a07(0x106)](path[_0x122a07(0xd8)](__dirname,bbpath2,_0x122a07(0x15c),_0x122a07(0x1e2)));}),app[_0x5e557c(0x1f2)](_0x5e557c(0x1ef),(_0x2e7740,_0x4748ff)=>{const _0x3f0488=_0x5e557c;_0x4748ff[_0x3f0488(0x106)](path[_0x3f0488(0xd8)](__dirname,bbpath2,_0x3f0488(0x15c),'index.html'));});if(HOST)http[_0x5e557c(0x25b)](PORT,HOST);else http[_0x5e557c(0x25b)](PORT);const io=require(_0x5e557c(0x19f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1a6ab2=_0x5e557c;let _0x2f05bd=_0x1a6ab2(0x1ec);const _0x311f87=networkInterfaces(),_0x46b809={};for(const _0x11b474 of Object[_0x1a6ab2(0x1a8)](_0x311f87)){for(const _0x4e19fb of _0x311f87[_0x11b474]){if((_0x4e19fb[_0x1a6ab2(0x225)]=='IPv4'||_0x4e19fb[_0x1a6ab2(0x225)]==0x4)&&!_0x4e19fb[_0x1a6ab2(0x242)]){const _0x38714a=ipaddr[_0x1a6ab2(0x235)](_0x4e19fb[_0x1a6ab2(0x1df)])[_0x1a6ab2(0x210)]();_0x38714a!=_0x1a6ab2(0x24e)&&(!_0x46b809[_0x11b474]&&(_0x46b809[_0x11b474]=[]),_0x46b809[_0x11b474][_0x1a6ab2(0x12d)](_0x4e19fb['address']),_0x2f05bd=_0x4e19fb[_0x1a6ab2(0x1df)]);}}}return{'serverip':_0x2f05bd,'netinterfaces':_0x46b809};}async function startServer(){const _0xea2e28=_0x5e557c,{serverip:_0x103262,netinterfaces:_0x21fe71}=getServerIP();logger[_0xea2e28(0x108)](''),logger[_0xea2e28(0x108)](_0xea2e28(0x1ca)),await logger[_0xea2e28(0x131)](_0xea2e28(0xf2)+serverversion+_0xea2e28(0x168)+(environment=='staging'?_0xea2e28(0xbc):'')+'\x0a'+(_0xea2e28(0x1e6)+PORT+_0xea2e28(0x188))+(_0xea2e28(0xcf)+_0x103262+':'+PORT+_0xea2e28(0xbb))),logger[_0xea2e28(0x108)]('-----------------------------------------------------------------------------------');if(config[_0xea2e28(0x1f1)]!=0x0)for(const _0x3934d2 of config){if(_0x3934d2['status']=='enabled'||_0x3934d2[_0xea2e28(0x1f0)]=='new')await logger[_0xea2e28(0x131)](_0xea2e28(0xc1)+_0x3934d2[_0xea2e28(0xc8)]+_0xea2e28(0x24b)+_0x3934d2[_0xea2e28(0xf1)]),startBot([_0x3934d2[_0xea2e28(0xc8)],userID],{'cwd':bbpath},function(_0xf7e204){const _0xeb161=_0xea2e28;if(_0xf7e204)logger[_0xeb161(0x131)](_0xf7e204);});else(_0x3934d2[_0xea2e28(0x1f0)]==_0xea2e28(0x15b)||_0x3934d2[_0xea2e28(0x1f0)]==_0xea2e28(0x171))&&await logger[_0xea2e28(0x131)](_0xea2e28(0x14a)+_0x3934d2[_0xea2e28(0xc8)]+_0xea2e28(0x24b)+_0x3934d2[_0xea2e28(0xf1)]);}else!newBot&&logger['simple'](_0xea2e28(0x123));if(newBot)addBot();logger[_0xea2e28(0x108)](_0xea2e28(0x1ca)),logger[_0xea2e28(0x108)](''),await logger[_0xea2e28(0xdb)](_0xea2e28(0x1cd)+nodeversion),await logger[_0xea2e28(0xdb)](_0xea2e28(0x25a),_0x21fe71);}function startSocket(){const _0x3dc373=_0x5e557c;io['on'](_0x3dc373(0x117),_0x52e40d=>{const _0x5d643e=_0x3dc373;let _0x4f0bba,_0x4c58e4,_0x54224b,_0x15a833,_0x56542d;const _0x4eb61b=_0x52e40d[_0x5d643e(0x116)][_0x5d643e(0x198)][_0x5d643e(0x22c)];_0x4c58e4=_0x4eb61b[_0x5d643e(0x199)](/bot[0-9]{3}/);if(_0x4c58e4)_0x54224b=_0x4c58e4[0x0][_0x5d643e(0x199)](/[0-9]{3}/);if(_0x54224b)_0x4f0bba=_0x54224b[0x0];else _0x4f0bba=_0x5d643e(0x130);const _0x3561ec=_0x52e40d[_0x5d643e(0x116)][_0x5d643e(0x1e4)][_0x5d643e(0x161)];if(!_0x3561ec)_0x52e40d[_0x5d643e(0x90)]('status',{'publicKey':secure['publicKey']});else{_0x15a833=timelyDecrypt(_0x3561ec,![]);if(!_0x15a833)_0x52e40d[_0x5d643e(0x90)](_0x5d643e(0x1f0),{'publicKey':secure['publicKey']});else{_0x56542d=normalizeIP(_0x52e40d[_0x5d643e(0x8f)][_0x5d643e(0x237)])[_0x5d643e(0x238)];if(!devices[_0x15a833])devices[_0x15a833]={'uuid':_0x15a833,'access':{'token':null}};devices[_0x15a833]['ip']=_0x56542d;const _0x45f003=addClient(_0x52e40d['id'],_0x15a833,_0x4f0bba);setAccess(_0x45f003),emitMessages(),_0x52e40d['on'](_0x5d643e(0x215),_0x5a3dbb=>{const _0x4945f4=_0x5d643e,_0x4c6380=timelyDecrypt(_0x5a3dbb[_0x4945f4(0x202)]);if(_0x4c6380){_0x5a3dbb={'username':_0x5a3dbb[_0x4945f4(0x1c2)],'password':_0x4c6380},devices[_0x15a833][_0x4945f4(0x1a6)]=validateCredentials(_0x5a3dbb,_0x15a833);if(devices[_0x15a833][_0x4945f4(0x1a6)][_0x4945f4(0x155)]==![]&&devices[_0x15a833]['access'][_0x4945f4(0x18a)]=='2FA\x20login\x20required')_0x52e40d[_0x4945f4(0x90)]('status',{'access':devices[_0x15a833]['access']}),loginAccess2FA(_0x15a833,_0x56542d);else{if(devices[_0x15a833][_0x4945f4(0x1a6)][_0x4945f4(0x155)]==![]&&devices[_0x15a833][_0x4945f4(0x1a6)][_0x4945f4(0x18a)]==_0x4945f4(0x174))_0x52e40d[_0x4945f4(0x90)](_0x4945f4(0x1f0),{'access':devices[_0x15a833][_0x4945f4(0x1a6)]});else devices[_0x15a833]['access'][_0x4945f4(0x155)]&&devices[_0x15a833][_0x4945f4(0x1a6)][_0x4945f4(0x18a)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x15a833)[_0x4945f4(0x23a)](_0x349648=>{setAccess(_0x349648);}),logger[_0x4945f4(0xdb)](_0x4945f4(0x23f)+_0x15a833[_0x4945f4(0x135)](-0x8)),setTokenRefresh(_0x15a833),setSessionTimeout(_0x4945f4(0x215),_0x15a833));}}else logger[_0x4945f4(0x131)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x52e40d['on']('reset-password',()=>{resetPassword();}),_0x52e40d['on'](_0x5d643e(0xd9),_0x539b83=>{removeClient(_0x52e40d['id']);}),_0x4f0bba==_0x5d643e(0x130)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x379f22){const _0x2c410e=_0x5e557c;if(_0x379f22!=_0x2c410e(0x130)&&config[_0x2c410e(0x9d)]!=''){if(pid[_0x379f22])pid[_0x379f22][_0x2c410e(0x18b)]({'function':_0x2c410e(0xfd),'args':null});}_0x379f22!=_0x2c410e(0x130)&&broadcastToBots(_0x2c410e(0x16b),JSON['stringify'](config));}function reloadBotManager(){const _0x36d435=_0x5e557c;getClientsWithBotID(_0x36d435(0x130))[_0x36d435(0x23a)](_0x3a13fb=>{const _0x52f0c8=_0x36d435;getSocket(_0x3a13fb['id'])[_0x52f0c8(0x90)](_0x52f0c8(0x1f0),{'access':{'allow':![],'reason':_0x52f0c8(0x146),'token':null}});});}function getSocket(_0x80b9c){const _0x4341cd=_0x5e557c;return io[_0x4341cd(0xca)][_0x4341cd(0xca)]['get'](_0x80b9c);}function setAccess(_0x7c9c99){const _0x1b6b0e=_0x5e557c,_0x59818e=getSocket(_0x7c9c99['id']),_0x46b416=_0x7c9c99[_0x1b6b0e(0xdd)],_0x449ede=_0x7c9c99[_0x1b6b0e(0x1fa)];devices[_0x46b416][_0x1b6b0e(0x1a6)]=validateAccess(devices[_0x46b416][_0x1b6b0e(0x1a6)]['token'],_0x46b416),logger[_0x1b6b0e(0xdb)](_0x1b6b0e(0x179)+devices[_0x46b416][_0x1b6b0e(0x1a6)][_0x1b6b0e(0x18a)]+'\x20|\x20client:\x20...'+_0x7c9c99['id'][_0x1b6b0e(0x135)](-0x8)+_0x1b6b0e(0xb6)+_0x46b416[_0x1b6b0e(0x135)](-0x8)),_0x59818e['join'](_0x46b416);if(devices[_0x46b416]['access'][_0x1b6b0e(0x155)]){_0x59818e[_0x1b6b0e(0xd8)](_0x449ede);if(_0x449ede==_0x1b6b0e(0x130))initializeSocketBotManager(_0x59818e);else initializeSocketBot(_0x59818e);initClient(_0x449ede);}devices[_0x46b416][_0x1b6b0e(0x1a6)]['token']&&devices[_0x46b416]['access'][_0x1b6b0e(0x18a)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x1b6b0e(0x127),_0x46b416),devices[_0x46b416][_0x1b6b0e(0x1a6)][_0x1b6b0e(0x178)]&&devices[_0x46b416][_0x1b6b0e(0x1a6)]['reason']==_0x1b6b0e(0x22e)&&setSessionTimeout('login',_0x46b416),_0x59818e[_0x1b6b0e(0x90)](_0x1b6b0e(0x1f0),{'status':_0x7c9c99[_0x1b6b0e(0xdf)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x46b416][_0x1b6b0e(0x1a6)],'externalip':devices[_0x46b416]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x1b6b0e(0x24c)],'validInstallation':validInstallation}),devices[_0x46b416][_0x1b6b0e(0x1a6)]['allow']==![]&&devices[_0x46b416][_0x1b6b0e(0x1a6)]['reason']==_0x1b6b0e(0x9e)&&temporaryAccess2FA(_0x46b416,devices[_0x46b416]['ip']);}function setSessionTimeout(_0x36ff7a,_0x377a27){const _0x5b7a96=_0x5e557c;let _0x3b23a7;if(_0x36ff7a==_0x5b7a96(0x215))_0x3b23a7=loginExpiry*0x3c*0x3e8;else _0x3b23a7=devices[_0x377a27]['telegramIpApproval'][_0x5b7a96(0x93)]*0x3c*0x3e8-(new Date()[_0x5b7a96(0x255)]()-devices[_0x377a27]['telegramIpApproval'][_0x5b7a96(0xa7)]);if(devices[_0x377a27][_0x5b7a96(0x1bb)])clearTimeout(devices[_0x377a27][_0x5b7a96(0x1bb)]);devices[_0x377a27]['pidExpireLogin']=setTimeout(()=>{const _0x1a7a2a=_0x5b7a96;if(devices[_0x377a27][_0x1a7a2a(0x167)])clearTimeout(devices[_0x377a27][_0x1a7a2a(0x167)]);removeSocketListeners(_0x377a27),addBlacklist(_0x377a27),devices[_0x377a27][_0x1a7a2a(0x11b)]=null,devices[_0x377a27][_0x1a7a2a(0xc4)]=null,devices[_0x377a27][_0x1a7a2a(0x1a6)]['token']=null,logger[_0x1a7a2a(0xdb)]('Session\x20expired\x20for\x20user\x20...'+_0x377a27[_0x1a7a2a(0x135)](-0x8)),devices[_0x377a27]['access']=validateAccess(devices[_0x377a27][_0x1a7a2a(0x1a6)]['token'],_0x377a27),!(devices[_0x377a27][_0x1a7a2a(0x1a6)]['allow']&&devices[_0x377a27]['access']['reason']=='login\x20not\x20required')&&(_0x36ff7a==_0x1a7a2a(0x215)?io['to'](_0x377a27)['emit'](_0x1a7a2a(0x1f0),{'access':{'allow':![],'reason':_0x1a7a2a(0x15f),'token':null}}):io['to'](_0x377a27)[_0x1a7a2a(0x90)](_0x1a7a2a(0x1f0),{'access':{'allow':![],'reason':_0x1a7a2a(0x13a),'token':null}})),devices[_0x377a27][_0x1a7a2a(0x1a6)][_0x1a7a2a(0x178)]=null;},_0x3b23a7);}function setTokenRefresh(_0x12f3cf){const _0x4cce96=_0x5e557c;if(devices[_0x12f3cf][_0x4cce96(0x167)])clearTimeout(devices[_0x12f3cf][_0x4cce96(0x167)]);devices[_0x12f3cf]['pidRefreshToken']=setTimeout(()=>{const _0x40953f=_0x4cce96;getClientsWithUuid(_0x12f3cf)[_0x40953f(0x1f1)]!=0x0?(devices[_0x12f3cf]['access']=refreshToken(_0x12f3cf),io['to'](_0x12f3cf)[_0x40953f(0x90)](_0x40953f(0x1f0),{'status':_0x40953f(0x25d),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x12f3cf][_0x40953f(0x1a6)],'externalip':devices[_0x12f3cf]['ip'],'publicKey':secure[_0x40953f(0x1ce)],'validInstallation':validInstallation}),setTokenRefresh(_0x12f3cf)):clearTimeout(devices[_0x12f3cf][_0x40953f(0x167)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2f1860){const _0x2dbc26=_0x5e557c,_0x513533=getClient(_0x2f1860['id'])[_0x2dbc26(0xdd)];_0x2f1860['emit'](_0x2dbc26(0x16b),config),_0x2f1860[_0x2dbc26(0x90)](_0x2dbc26(0x23b),cleanSettings()),_0x2f1860['on'](_0x2dbc26(0x20f),_0x236958=>{const _0x39b06c=_0x2dbc26;if(validateAccess(_0x236958,_0x513533)['allow'])addBot();else logger[_0x39b06c(0x131)](_0x39b06c(0xed));}),_0x2f1860['on']('update-bot',(_0x1e6a3f,_0x499b8e)=>{const _0x1f9c2d=_0x2dbc26;if(validateAccess(_0x499b8e,_0x513533)[_0x1f9c2d(0x155)])toggleBot(_0x1e6a3f[_0x1f9c2d(0xc8)],_0x1e6a3f[_0x1f9c2d(0x1f0)],_0x1e6a3f[_0x1f9c2d(0x182)]);else logger[_0x1f9c2d(0x131)](_0x1f9c2d(0x1ed));}),_0x2f1860['on']('toggle-bot-mode',(_0xdb178b,_0x3afc82)=>{const _0x243a5c=_0x2dbc26;if(validateAccess(_0x3afc82,_0x513533)['allow'])toggleBotMode(_0xdb178b);else logger[_0x243a5c(0x131)](_0x243a5c(0x1ed));}),_0x2f1860['on'](_0x2dbc26(0xee),(_0x3b867e,_0x561d4c)=>{const _0x1386c0=_0x2dbc26;if(validateAccess(_0x561d4c,_0x513533)['allow'])deleteBot(_0x3b867e);else logger['full'](_0x1386c0(0x97));}),_0x2f1860['on'](_0x2dbc26(0xc6),(_0x257c16,_0x5c055d)=>{const _0x539c75=_0x2dbc26;if(validateAccess(_0x5c055d,_0x513533)[_0x539c75(0x155)])storeSettings(_0x257c16,!![]);else logger[_0x539c75(0x131)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2f1860['on'](_0x2dbc26(0xbe),_0x5eab46=>{const _0x4acc8f=_0x2dbc26;if(validateAccess(_0x5eab46,_0x513533)[_0x4acc8f(0x155)])updateBB(_0x4acc8f(0x246));else logger[_0x4acc8f(0x131)](_0x4acc8f(0x193));}),_0x2f1860['on'](_0x2dbc26(0xea),_0x33a61d=>{const _0xdd667d=_0x2dbc26;if(validateAccess(_0x33a61d,_0x513533)[_0xdd667d(0x155)])updateBB('reinstall');else logger[_0xdd667d(0x131)](_0xdd667d(0x1ad));}),_0x2f1860['on'](_0x2dbc26(0x1b6),_0x5f2e9a=>{const _0x4b342=_0x2dbc26;if(validateAccess(_0x5f2e9a,_0x513533)[_0x4b342(0x155)]){const _0x4de1c0=getClient(_0x2f1860['id']);if(_0x4de1c0)getBackupFiles(_0x4de1c0[_0x4b342(0xdd)]);else logger[_0x4b342(0x131)](_0x4b342(0x15d));}else logger['full'](_0x4b342(0xc3));}),_0x2f1860['on']('restore-backup-file',(_0x3b61de,_0x302362)=>{const _0x26eac0=_0x2dbc26;if(validateAccess(_0x302362,_0x513533)['allow'])restoreBackupFile(_0x3b61de);else logger[_0x26eac0(0x131)](_0x26eac0(0xa0));}),_0x2f1860['on'](_0x2dbc26(0x21f),_0x51e3ca=>{const _0x36de6e=_0x2dbc26;if(validateAccess(_0x51e3ca,_0x513533)[_0x36de6e(0x155)])getMessages();else logger[_0x36de6e(0x131)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2f1860['on']('confirm-message',(_0x21dcac,_0x32c3db)=>{const _0x562fda=_0x2dbc26;if(validateAccess(_0x32c3db,_0x513533)[_0x562fda(0x155)])confirmMessage(_0x21dcac);else logger[_0x562fda(0x131)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2f1860['on'](_0x2dbc26(0x9a),_0x404749=>{const _0x5039a2=_0x2dbc26;if(validateAccess(_0x404749,_0x513533)[_0x5039a2(0x155)]){if(devices[_0x513533]['pidRefreshToken'])clearTimeout(devices[_0x513533][_0x5039a2(0x167)]);if(devices[_0x513533][_0x5039a2(0x1bb)])clearTimeout(devices[_0x513533][_0x5039a2(0x1bb)]);removeSocketListeners(getClient(_0x2f1860['id'])[_0x5039a2(0xdd)]),addBlacklist(_0x513533),devices[_0x513533][_0x5039a2(0x11b)]=null,devices[_0x513533][_0x5039a2(0xc4)]=null,devices[_0x513533][_0x5039a2(0x1a6)]['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x513533['slice'](-0x8)),io['to'](getClient(_0x2f1860['id'])['uuid'])['emit'](_0x5039a2(0x1f0),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5039a2(0x131)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x5cebd1){const _0x3aedd9=_0x5e557c,_0x125465=getClient(_0x5cebd1['id'])[_0x3aedd9(0x1fa)],_0x2d3cd7=getClient(_0x5cebd1['id'])['uuid'];_0x5cebd1['on'](_0x3aedd9(0x1f7),(_0x1494a8,_0x172959)=>{const _0x11a530=_0x3aedd9;if(validateAccess(_0x172959,_0x2d3cd7)[_0x11a530(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x11a530(0x18b)]({'function':'emitHistory','args':_0x1494a8});}else logger[_0x11a530(0x131)](_0x11a530(0x107));}),_0x5cebd1['on'](_0x3aedd9(0x157),(_0x4415d7,_0x37dcd9)=>{const _0x28c839=_0x3aedd9;if(validateAccess(_0x37dcd9,_0x2d3cd7)[_0x28c839(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x28c839(0x18b)]({'function':'deleteHistoryAlerts','args':_0x4415d7});}else logger[_0x28c839(0x131)](_0x28c839(0x266));}),_0x5cebd1['on']('get-portfolio',(_0x5d1d81,_0xcbf135)=>{const _0x42aac7=_0x3aedd9;if(validateAccess(_0xcbf135,_0x2d3cd7)[_0x42aac7(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x42aac7(0x18b)]({'function':_0x42aac7(0x1e9),'args':_0x5d1d81});}else logger[_0x42aac7(0x131)](_0x42aac7(0x9b));}),_0x5cebd1['on'](_0x3aedd9(0xac),(_0x335d3c,_0x30fbde)=>{const _0x122c95=_0x3aedd9;if(validateAccess(_0x30fbde,_0x2d3cd7)[_0x122c95(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x122c95(0x18b)]({'function':_0x122c95(0x19c),'args':_0x335d3c});}else logger[_0x122c95(0x131)](_0x122c95(0x99));}),_0x5cebd1['on'](_0x3aedd9(0x25f),(_0x384e0d,_0x4c28f9)=>{const _0x161277=_0x3aedd9;if(validateAccess(_0x4c28f9,_0x2d3cd7)[_0x161277(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x161277(0x18b)]({'function':_0x161277(0xb2),'args':_0x384e0d});}else logger[_0x161277(0x131)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x5cebd1['on'](_0x3aedd9(0x18f),(_0x4ecd23,_0x92afaa)=>{const _0x41d7aa=_0x3aedd9;if(validateAccess(_0x92afaa,_0x2d3cd7)[_0x41d7aa(0x155)]){if(pid[_0x125465])pid[_0x125465]['send']({'function':_0x41d7aa(0x211),'args':_0x4ecd23});}else logger[_0x41d7aa(0x131)](_0x41d7aa(0x1fc));}),_0x5cebd1['on']('reset-history',_0xc11013=>{const _0x11e898=_0x3aedd9;if(validateAccess(_0xc11013,_0x2d3cd7)[_0x11e898(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x11e898(0x18b)]({'function':_0x11e898(0x218),'args':null});}else logger['full'](_0x11e898(0x247));}),_0x5cebd1['on'](_0x3aedd9(0x260),_0x90b67c=>{const _0x22c87b=_0x3aedd9;if(validateAccess(_0x90b67c,_0x2d3cd7)[_0x22c87b(0x155)]){if(pid[_0x125465])pid[_0x125465][_0x22c87b(0x18b)]({'function':_0x22c87b(0xe3),'args':null});}else logger[_0x22c87b(0x131)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x5cebd1['on'](_0x3aedd9(0xd6),(_0x36593a,_0x40312a)=>{const _0x28d488=_0x3aedd9;if(validateAccess(_0x40312a,_0x2d3cd7)[_0x28d488(0x155)]){if(pid[_0x125465])pid[_0x125465]['send']({'function':_0x28d488(0x1c4),'args':_0x36593a});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5cebd1['on'](_0x3aedd9(0x13e),_0x73568=>{const _0x532073=_0x3aedd9;if(validateAccess(_0x73568,_0x2d3cd7)[_0x532073(0x155)]){if(pid[_0x125465])pid[_0x125465]['send']({'function':'cancelLoading','args':null});}else logger['full'](_0x532073(0x138));}),_0x5cebd1['on']('show-config',_0x1fc387=>{const _0x1a7bc2=_0x3aedd9;if(validateAccess(_0x1fc387,_0x2d3cd7)['allow']){if(pid[_0x125465])pid[_0x125465][_0x1a7bc2(0x18b)]({'function':_0x1a7bc2(0xb3),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x5cebd1['on'](_0x3aedd9(0xbe),_0x11d4ea=>{const _0x401020=_0x3aedd9;if(validateAccess(_0x11d4ea,_0x2d3cd7)[_0x401020(0x155)])updateBB(_0x401020(0x246));else logger[_0x401020(0x131)](_0x401020(0x193));}),_0x5cebd1['on'](_0x3aedd9(0x21f),_0x55d68f=>{const _0x57edea=_0x3aedd9;if(validateAccess(_0x55d68f,_0x2d3cd7)[_0x57edea(0x155)])getMessages();else logger[_0x57edea(0x131)](_0x57edea(0x1b3));}),_0x5cebd1['on']('confirm-message',(_0x163ae2,_0xfcd09d)=>{const _0x5ab64a=_0x3aedd9;if(validateAccess(_0xfcd09d,_0x2d3cd7)[_0x5ab64a(0x155)])confirmMessage(_0x163ae2);else logger['full'](_0x5ab64a(0x1f6));}),_0x5cebd1['on'](_0x3aedd9(0x9a),_0x2e023c=>{const _0x7a2f0=_0x3aedd9;if(validateAccess(_0x2e023c,_0x2d3cd7)[_0x7a2f0(0x155)]){if(devices[_0x2d3cd7]['pidRefreshToken'])clearTimeout(devices[_0x2d3cd7][_0x7a2f0(0x167)]);if(devices[_0x2d3cd7]['pidExpireLogin'])clearTimeout(devices[_0x2d3cd7][_0x7a2f0(0x1bb)]);removeSocketListeners(getClient(_0x5cebd1['id'])[_0x7a2f0(0xdd)]),addBlacklist(_0x2d3cd7),devices[_0x2d3cd7]['telegramIpApproval']=null,devices[_0x2d3cd7][_0x7a2f0(0xc4)]=null,devices[_0x2d3cd7]['access'][_0x7a2f0(0x178)]=null,logger[_0x7a2f0(0xdb)](_0x7a2f0(0x145)+_0x2d3cd7[_0x7a2f0(0x135)](-0x8)),io['to'](getClient(_0x5cebd1['id'])['uuid'])[_0x7a2f0(0x90)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x7a2f0(0x131)](_0x7a2f0(0x243));});}function removeSocketListeners(_0x40237c){getClientsWithUuid(_0x40237c)['forEach'](_0x34721c=>{const _0x1edd00=_0x3723;getSocket(_0x34721c['id'])[_0x1edd00(0x21d)]();});}function cleanSettings(){const _0x547bc8=_0x5e557c;let _0xad892d=settings;return settings[_0x547bc8(0xfa)]&&settings['telegramToken']!=''&&(_0xad892d={..._0xad892d,'telegramToken':_0x547bc8(0x1b8)}),settings[_0x547bc8(0x13c)]&&settings[_0x547bc8(0x13c)]!=''&&(_0xad892d={..._0xad892d,'bbPassword':_0x547bc8(0x1b8)}),(settings['bbPassword']&&settings['bbPassword']=='***'||settings[_0x547bc8(0xfa)]&&settings[_0x547bc8(0xfa)]==_0x547bc8(0x22d))&&(_0xad892d={..._0xad892d,'restored':{'password':settings[_0x547bc8(0x13c)]==_0x547bc8(0x22d),'telegram':settings['telegramToken']==_0x547bc8(0x22d)}}),_0xad892d;}async function updateBB(_0x5d1120){const _0x47013b=_0x5e557c;await backupConfigFiles(),installingUpdate=!![],config[_0x47013b(0x23a)](_0x4a36b1=>{const _0x5808ed=_0x47013b;restartBot(_0x4a36b1[_0x5808ed(0xc8)]);});if(_0x5d1120==_0x47013b(0x246))process[_0x47013b(0x18b)]({'update':!![],'environment':environment},_0x270c64=>{});else _0x5d1120==_0x47013b(0xcb)&&process[_0x47013b(0x18b)]({'reinstall':!![],'environment':environment},_0x683b55=>{});}function startBot(_0x32cb2a,_0x481c69,_0x192f2f){const _0x1bb1cb=_0x5e557c;if(debugging)_0x32cb2a[_0x1bb1cb(0x12d)]('-d');let _0x4adeb7=![];const _0x53c8bd=_0x32cb2a[0x0];_0x481c69={..._0x481c69,'stdio':[_0x1bb1cb(0x9c),'inherit','inherit','ipc']},pid[_0x53c8bd]=childProcess['fork'](botfile,_0x32cb2a,_0x481c69),pid[_0x53c8bd]['on']('message',_0x47f19e=>{const _0x391a1e=_0x1bb1cb;switch(Object['keys'](_0x47f19e)[0x0]){case _0x391a1e(0xf1):updateBotName(_0x53c8bd,_0x47f19e[_0x391a1e(0xf1)]);break;case'updatebotmanager':updateBotManager();break;case _0x391a1e(0x1f0):updateStatus(_0x53c8bd,_0x47f19e[_0x391a1e(0x1f0)]);break;case'live':updateLive(_0x53c8bd,_0x47f19e[_0x391a1e(0x182)]);break;case _0x391a1e(0x1be):updateLive(_0x53c8bd,_0x47f19e[_0x391a1e(0x1be)]),io['to'](_0x53c8bd)[_0x391a1e(0x90)](_0x391a1e(0x1f0),{'access':{'allow':![],'reason':_0x391a1e(0x146),'token':null}});break;case'stop':_0x47f19e[_0x391a1e(0xc2)]==_0x391a1e(0x1dc)&&restartBot(_0x53c8bd);_0x47f19e[_0x391a1e(0xc2)]==_0x391a1e(0x21c)&&toggleBot(_0x53c8bd,'disabled','stopped');break;case'telegram':sendTelegram(_0x53c8bd,_0x47f19e[_0x391a1e(0x200)]);break;case _0x391a1e(0x1d7):sendTelegramMsg(_0x47f19e[_0x391a1e(0x1d7)]);break;case _0x391a1e(0x105):io['to'](_0x53c8bd)[_0x391a1e(0x90)](_0x47f19e[_0x391a1e(0x105)],_0x47f19e['args']);break;}}),pid[_0x53c8bd]['on'](_0x1bb1cb(0xeb),function(_0x5afc04){if(_0x4adeb7)return;_0x4adeb7=!![],_0x192f2f(_0x5afc04);}),pid[_0x53c8bd]['on'](_0x1bb1cb(0x1f5),async function(_0x514d32){const _0x493067=_0x1bb1cb;if(installingUpdate)return;if(_0x4adeb7)return;_0x4adeb7=!![],_0x192f2f(null);const _0x5a5e9b=dbConfig['get']('bots')[_0x493067(0x226)]({'botID':_0x53c8bd})[_0x493067(0x1a3)]();_0x5a5e9b&&(_0x5a5e9b[_0x493067(0x1f0)]==_0x493067(0x137)||_0x5a5e9b[_0x493067(0x1f0)]==_0x493067(0x1c9))&&(await sleep(0x3e8),updateLive(_0x53c8bd,_0x493067(0x136)),logger[_0x493067(0x131)](_0x493067(0xf4)+_0x53c8bd),startBot([_0x53c8bd,userID],{'cwd':bbpath},function(_0x1186f7){if(_0x1186f7)logger['full'](_0x1186f7);}));});}function stopBot(_0x1a480e){const _0x477985=_0x5e557c;getClientsWithBotID(_0x1a480e)[_0x477985(0x23a)](_0x4f1a23=>{const _0x3cd125=_0x477985;getSocket(_0x4f1a23['id'])[_0x3cd125(0xd9)](!![]),removeClient(_0x4f1a23['id']);}),pid[_0x1a480e]&&(pid[_0x1a480e]['kill'](),pid[_0x1a480e]=null);}function restartBot(_0x3e7e6c){const _0x177bb4=_0x5e557c;if(pid[_0x3e7e6c])pid[_0x3e7e6c][_0x177bb4(0x21c)]();}function addBot(){const _0x8ad63c=_0x5e557c;let _0xc3205;for(let _0x52c6b0=0x1;_0x52c6b0<0x3e9;_0x52c6b0++){_0xc3205=_0x52c6b0[_0x8ad63c(0xc7)]()[_0x8ad63c(0x269)](0x3,'0');let _0x4401d4=config[_0x8ad63c(0x226)](_0x879770=>_0x879770[_0x8ad63c(0xc8)]==_0xc3205);if(!_0x4401d4)break;}if(_0xc3205===_0x8ad63c(0x1a7)){logger['full'](_0x8ad63c(0x220));return;}logger[_0x8ad63c(0x131)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0xc3205),dbConfig[_0x8ad63c(0x1f2)](_0x8ad63c(0x16b))['push']({'botID':_0xc3205,'botname':'Bot\x20'+_0xc3205,'status':_0x8ad63c(0x1c9),'live':''})[_0x8ad63c(0x191)](),startBot([_0xc3205,userID],{'cwd':bbpath},function(_0x54be34){const _0x3513b8=_0x8ad63c;if(_0x54be34)logger[_0x3513b8(0x131)](_0x54be34);}),config=getConfiguration(),io['to'](_0x8ad63c(0x130))[_0x8ad63c(0x90)](_0x8ad63c(0x16b),config),broadcastToBots(_0x8ad63c(0x16b),JSON[_0x8ad63c(0x26c)](config));}function deleteBot(_0x2cf8cf){const _0x453aae=_0x5e557c;getClientsWithBotID(_0x2cf8cf)[_0x453aae(0x23a)](_0x3f1ba9=>{getSocket(_0x3f1ba9['id'])['disconnect'](!![]),removeClient(_0x3f1ba9['id']);}),dbConfig['get']('bots')[_0x453aae(0x239)]({'botID':_0x2cf8cf})['write'](),logger[_0x453aae(0x131)](_0x453aae(0xa3)+_0x2cf8cf),stopBot(_0x2cf8cf);try{if(fs[_0x453aae(0x114)](path[_0x453aae(0xd8)](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0x133))))fs[_0x453aae(0xf8)](path[_0x453aae(0xd8)](configpath,'bot-'+_0x2cf8cf+'-config.json'));if(fs[_0x453aae(0x114)](path[_0x453aae(0xd8)](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0xd5))))fs[_0x453aae(0xf8)](path[_0x453aae(0xd8)](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0xd5)));if(fs[_0x453aae(0x114)](path['join'](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0x153))))fs['unlinkSync'](path['join'](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0x153)));if(fs[_0x453aae(0x114)](path[_0x453aae(0xd8)](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0x261))))fs[_0x453aae(0xf8)](path[_0x453aae(0xd8)](configpath,_0x453aae(0x1d9)+_0x2cf8cf+_0x453aae(0x261)));}catch(_0x38c9a6){if(_0x38c9a6)logger[_0x453aae(0x131)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x38c9a6);}config=getConfiguration(),io['to'](_0x453aae(0x130))[_0x453aae(0x90)](_0x453aae(0x16b),config),broadcastToBots(_0x453aae(0x16b),JSON[_0x453aae(0x26c)](config));}function toggleBot(_0x22b76b,_0x187f41,_0x43e84f){const _0x4521c9=_0x5e557c;dbConfig['get'](_0x4521c9(0x16b))[_0x4521c9(0x226)]({'botID':_0x22b76b})[_0x4521c9(0x180)]({'status':_0x187f41})[_0x4521c9(0x180)]({'live':_0x43e84f})[_0x4521c9(0x191)]();if(_0x187f41=='enabled'||_0x187f41==_0x4521c9(0x1c9))logger[_0x4521c9(0x131)]('Enabled\x20Bot\x20'+_0x22b76b),startBot([_0x22b76b,userID],{'cwd':bbpath},function(_0x348b7b){const _0x22b472=_0x4521c9;if(_0x348b7b)logger[_0x22b472(0x131)](_0x348b7b);});else(_0x187f41=='disabled'||_0x187f41==_0x4521c9(0x171))&&(logger['full']('Disabled\x20Bot\x20'+_0x22b76b),stopBot(_0x22b76b));config=getConfiguration(),io['to']('botmanager')[_0x4521c9(0x90)](_0x4521c9(0x16b),config),broadcastToBots('bots',JSON[_0x4521c9(0x26c)](config));}function toggleStatus(_0x41151a){const _0x3917b5=_0x5e557c;let _0x1c18c9=dbConfig[_0x3917b5(0x1f2)](_0x3917b5(0x16b))['find']({'botID':_0x41151a})[_0x3917b5(0x1a3)](),_0x5a102a;if(_0x1c18c9['status']===_0x3917b5(0x137))_0x5a102a='disabled';else{if(_0x1c18c9[_0x3917b5(0x1f0)]===_0x3917b5(0x1c9))_0x5a102a=_0x3917b5(0x171);else{if(_0x1c18c9[_0x3917b5(0x1f0)]===_0x3917b5(0x171))_0x5a102a=_0x3917b5(0x1c9);else{if(_0x1c18c9[_0x3917b5(0x1f0)]===_0x3917b5(0x15b))_0x5a102a=_0x3917b5(0x137);}}}return _0x5a102a;}function updateStatus(_0x34b64c,_0x1b20b5){const _0x55a98a=_0x5e557c;dbConfig[_0x55a98a(0x1f2)](_0x55a98a(0x16b))[_0x55a98a(0x226)]({'botID':_0x34b64c})[_0x55a98a(0x180)]({'status':_0x1b20b5})[_0x55a98a(0x191)](),config=getConfiguration(),io['to']('botmanager')[_0x55a98a(0x90)](_0x55a98a(0x16b),config),broadcastToBots(_0x55a98a(0x16b),JSON[_0x55a98a(0x26c)](config));}function updateLive(_0x355ca0,_0x1ea69e){const _0x37dda2=_0x5e557c;dbConfig[_0x37dda2(0x1f2)]('bots')[_0x37dda2(0x226)]({'botID':_0x355ca0})[_0x37dda2(0x180)]({'live':_0x1ea69e})[_0x37dda2(0x191)](),config=getConfiguration(),io['to'](_0x37dda2(0x130))['emit'](_0x37dda2(0x16b),config),broadcastToBots('bots',JSON[_0x37dda2(0x26c)](config));}function updateBotName(_0x569391,_0x576bb7){const _0x9de32b=_0x5e557c;dbConfig[_0x9de32b(0x1f2)](_0x9de32b(0x16b))[_0x9de32b(0x226)]({'botID':_0x569391})[_0x9de32b(0x180)]({'botname':_0x576bb7})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x9de32b(0x90)](_0x9de32b(0x16b),config),broadcastToBots('bots',JSON[_0x9de32b(0x26c)](config));}function updateBotManager(){const _0x44dcde=_0x5e557c;config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x44dcde(0x16b),JSON['stringify'](config));}function toggleBotMode(_0x518e23){const _0x3da7b7=_0x5e557c;if(pid[_0x518e23])pid[_0x518e23][_0x3da7b7(0x18b)]({'function':_0x3da7b7(0x207),'args':null});else{const _0x39d863=configpath+_0x3da7b7(0x1d9)+_0x518e23+_0x3da7b7(0x133),_0x10dff0=fs['readFileSync'](_0x39d863),_0x24df7c=JSON[_0x3da7b7(0x235)](_0x10dff0),_0x319f4b=_0x24df7c[_0x3da7b7(0x1fa)][0x0][_0x3da7b7(0x1d3)];_0x24df7c['bot'][0x0][_0x3da7b7(0x1d3)]=!_0x319f4b;const _0xadd6fd=JSON[_0x3da7b7(0x26c)](_0x24df7c,null,0x2);fs[_0x3da7b7(0xff)](_0x39d863,_0xadd6fd),config=getConfiguration(),io['to'](_0x3da7b7(0x130))['emit']('bots',config),broadcastToBots(_0x3da7b7(0x16b),JSON[_0x3da7b7(0x26c)](config));}}function telegramError(_0x5cd9fc){const _0x29b4d6=_0x5e557c;logger[_0x29b4d6(0x108)](getTimeStamp()+_0x29b4d6(0xd1));}function validateTelegram(_0x56a0a8){const _0x3f6090=_0x5e557c;if(_0x56a0a8[_0x3f6090(0x101)][_0x3f6090(0x1c2)]!=settings[_0x3f6090(0x1a9)]&&'@'+_0x56a0a8[_0x3f6090(0x101)]['username']!=settings['telegramUsername'])return tgBot[_0x3f6090(0xfb)](_0x56a0a8['chat']['id'],_0x3f6090(0xa2),{'parse_mode':'HTML'})[_0x3f6090(0x1c7)](_0x16f5fe=>{telegramError(_0x16f5fe);}),![];return!![];}async function initTelegram(){const _0x12c00f=_0x5e557c;if(tgBot)tgBot[_0x12c00f(0xb0)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x12c00f(0xfa)],{'polling':!![]});let _0x56ea98='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x56ea98+='\x0a',_0x56ea98+='/enable\x20-\x20enable\x20notifications\x0a',_0x56ea98+='/disable\x20-\x20disable\x20notifications\x0a',_0x56ea98+=_0x12c00f(0xc5),_0x56ea98+=_0x12c00f(0x236),_0x56ea98+='/on\x20-\x20start\x20bot(s)\x0a',_0x56ea98+=_0x12c00f(0x19a),_0x56ea98+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x56ea98+=_0x12c00f(0xe5),_0x56ea98+=_0x12c00f(0x126),_0x56ea98+=_0x12c00f(0x125),_0x56ea98+=_0x12c00f(0x169),_0x56ea98+=_0x12c00f(0x19e),_0x56ea98+=_0x12c00f(0xe0),_0x56ea98+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x4f6a2d=_0x12c00f(0x17a);_0x4f6a2d+='\x0a',_0x4f6a2d+=_0x56ea98,tgBot[_0x12c00f(0x17e)](/\/start/,_0x13b939=>{const _0x2911eb=_0x12c00f;if(!validateTelegram(_0x13b939))return;if(settings[_0x2911eb(0x95)]!=_0x13b939[_0x2911eb(0x206)]['id'])updateSetting(_0x2911eb(0x95),_0x13b939[_0x2911eb(0x206)]['id']);updateSetting(_0x2911eb(0x1d6),!![]),tgBot[_0x2911eb(0xfb)](_0x13b939[_0x2911eb(0x206)]['id'],_0x4f6a2d)['catch'](_0x45fbe9=>{telegramError(_0x45fbe9);});}),tgBot[_0x12c00f(0x17e)](/\/enable/,_0x85bf97=>{const _0x55267e=_0x12c00f;if(!validateTelegram(_0x85bf97))return;if(settings[_0x55267e(0x95)]!=_0x85bf97[_0x55267e(0x206)]['id'])updateSetting('telegramChatId',_0x85bf97[_0x55267e(0x206)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x55267e(0xfb)](_0x85bf97[_0x55267e(0x206)]['id'],_0x55267e(0x203))['catch'](_0x59c0e2=>{telegramError(_0x59c0e2);});}),tgBot[_0x12c00f(0x17e)](/\/config/,async _0x511953=>{const _0x2a2f0a=_0x12c00f;if(!validateTelegram(_0x511953))return;tgBot['removeListener'](_0x2a2f0a(0x103)),tgBot[_0x2a2f0a(0xfb)](_0x511953['chat']['id'],_0x2a2f0a(0x23d),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x2a2f0a(0x1ba),'callback_data':_0x2a2f0a(0xba)},{'text':'All','callback_data':_0x2a2f0a(0x147)}]]}})['catch'](_0xcfb285=>{telegramError(_0xcfb285);}),tgBot['on']('callback_query',async _0x20a839=>{const _0x32b21f=_0x2a2f0a,_0x10ef96=_0x20a839[_0x32b21f(0x1cf)],_0x761704=_0x20a839[_0x32b21f(0xe2)];tgBot[_0x32b21f(0x254)](_0x20a839['id'])[_0x32b21f(0xf3)](async()=>{const _0x30124d=_0x32b21f;_0x10ef96==_0x30124d(0x250)&&(updateSetting(_0x30124d(0x258),_0x30124d(0x250)),updateSetting(_0x30124d(0x1d6),!![]),await tgBot[_0x30124d(0xfb)](_0x761704['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x30124d(0x1c7)](_0x1897e2=>{telegramError(_0x1897e2);}));_0x10ef96==_0x30124d(0xba)&&(updateSetting(_0x30124d(0x258),_0x30124d(0xba)),updateSetting(_0x30124d(0x1d6),!![]),await tgBot['sendMessage'](_0x761704['chat']['id'],_0x30124d(0x120))['catch'](_0x5e3c63=>{telegramError(_0x5e3c63);}));_0x10ef96==_0x30124d(0x147)&&(updateSetting('telegramEvents',_0x30124d(0x147)),updateSetting('telegramEnabled',!![]),await tgBot[_0x30124d(0xfb)](_0x761704[_0x30124d(0x206)]['id'],_0x30124d(0xb1))[_0x30124d(0x1c7)](_0x1ecab7=>{telegramError(_0x1ecab7);}));if(!settings[_0x30124d(0x95)])tgBot[_0x30124d(0xfb)](_0x761704[_0x30124d(0x206)]['id'],_0x30124d(0x20c))['catch'](_0x37d182=>{telegramError(_0x37d182);});}),tgBot[_0x32b21f(0xef)](_0x32b21f(0x103));});}),tgBot[_0x12c00f(0x17e)](/\/status/,_0x4f2b82=>{const _0x569706=_0x12c00f;if(!validateTelegram(_0x4f2b82))return;const _0x20ad01=getBotsWithMode();let _0x4d44c9=_0x569706(0x26b);config[_0x569706(0x23a)](_0x2382b4=>{const _0x21504a=_0x569706,_0x2324ee=_0x20ad01['find'](_0x153276=>_0x153276[_0x21504a(0xc8)]==_0x2382b4['botID'])[_0x21504a(0x20a)];_0x4d44c9+=_0x21504a(0x240)+_0x2382b4[_0x21504a(0xc8)]+':\x20'+_0x2382b4['status']+_0x21504a(0x24b)+_0x2324ee+_0x21504a(0x24b)+_0x2382b4['live']+'\x0a';}),_0x4d44c9+='\x0a',_0x4d44c9+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4d44c9+=!settings[_0x569706(0x1d6)]?_0x569706(0x152):'Notifications\x20enabled\x0a',_0x4d44c9+=settings[_0x569706(0x1d6)]?settings[_0x569706(0x258)]==_0x569706(0x147)?_0x569706(0x15e):_0x569706(0xaa)+settings['telegramEvents']+_0x569706(0xe1):'',tgBot[_0x569706(0xfb)](_0x4f2b82[_0x569706(0x206)]['id'],_0x4d44c9,{'parse_mode':_0x569706(0x163)})[_0x569706(0x1c7)](_0x41ddc9=>{telegramError(_0x41ddc9);});}),tgBot['onText'](/\/restart/,_0xe78fc8=>{const _0x457e71=_0x12c00f;if(!validateTelegram(_0xe78fc8))return;tgBot[_0x457e71(0xef)](_0x457e71(0x103));const _0x1d9ef9=getEnabledBots();if(_0x1d9ef9[_0x457e71(0x1f1)]==0x0)tgBot[_0x457e71(0xfb)](_0xe78fc8[_0x457e71(0x206)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x457e71(0x1c7)](_0x427335=>{telegramError(_0x427335);});else{if(_0x1d9ef9[_0x457e71(0x1f1)]>0x1)_0x1d9ef9['push']({'botID':_0x457e71(0x147)});let _0x4d21c0=[],_0x5f4e10=[];const _0x3c18f2=_0x1d9ef9['length']%0x4==0x0||_0x1d9ef9[_0x457e71(0x1f1)]%0x4==0x3||_0x1d9ef9[_0x457e71(0x1f1)]%0x3==0x1?0x4:0x3;let _0x27fa3b=0x0;_0x1d9ef9[_0x457e71(0x23a)]((_0x4c0564,_0x3864fc)=>{const _0x24c073=_0x457e71;if(_0x3864fc%_0x3c18f2==0x0)_0x5f4e10=[];_0x5f4e10[_0x24c073(0x12d)]({'text':_0x4c0564['botID']==_0x24c073(0x147)?'All\x20bots':_0x24c073(0x240)+_0x4c0564[_0x24c073(0xc8)],'callback_data':_0x4c0564[_0x24c073(0xc8)]}),_0x3864fc%_0x3c18f2==0x0&&(_0x4d21c0[_0x27fa3b]=_0x5f4e10,_0x27fa3b++);}),tgBot[_0x457e71(0xfb)](_0xe78fc8[_0x457e71(0x206)]['id'],_0x457e71(0xe7),{'reply_markup':{'inline_keyboard':_0x4d21c0}})[_0x457e71(0x1c7)](_0x5dd837=>{telegramError(_0x5dd837);}),tgBot['on'](_0x457e71(0x103),async _0x79cb4c=>{const _0x9efe60=_0x457e71,_0x4b62d2=_0x79cb4c['data'],_0x3221f5=_0x79cb4c[_0x9efe60(0xe2)];tgBot[_0x9efe60(0x254)](_0x79cb4c['id'])[_0x9efe60(0xf3)](async()=>{const _0x454122=_0x9efe60;_0x4b62d2==_0x454122(0x147)?config[_0x454122(0x23a)](_0x18a0c9=>{const _0x32136d=_0x454122;restartBot(_0x18a0c9[_0x32136d(0xc8)]);}):restartBot(_0x4b62d2);}),tgBot[_0x9efe60(0xef)](_0x9efe60(0x103));});}}),tgBot[_0x12c00f(0x17e)](/\/on/,_0x2048db=>{const _0x19cd0d=_0x12c00f;if(!validateTelegram(_0x2048db))return;tgBot[_0x19cd0d(0xef)]('callback_query');const _0xc8e1d5=getDisabledBots();if(_0xc8e1d5[_0x19cd0d(0x1f1)]==0x0)tgBot[_0x19cd0d(0xfb)](_0x2048db['chat']['id'],_0x19cd0d(0x185))[_0x19cd0d(0x1c7)](_0x3fd52d=>{telegramError(_0x3fd52d);});else{if(_0xc8e1d5[_0x19cd0d(0x1f1)]>0x1)_0xc8e1d5[_0x19cd0d(0x12d)]({'botID':'all'});let _0x2e93be=[],_0x22c846=[];const _0x4a931a=_0xc8e1d5['length']%0x4==0x0||_0xc8e1d5[_0x19cd0d(0x1f1)]%0x4==0x3||_0xc8e1d5['length']%0x3==0x1?0x4:0x3;let _0x1f1afe=0x0;_0xc8e1d5[_0x19cd0d(0x23a)]((_0x825461,_0x2c7a2e)=>{const _0x4499f5=_0x19cd0d;if(_0x2c7a2e%_0x4a931a==0x0)_0x22c846=[];_0x22c846[_0x4499f5(0x12d)]({'text':_0x825461[_0x4499f5(0xc8)]==_0x4499f5(0x147)?_0x4499f5(0x187):_0x4499f5(0x240)+_0x825461['botID'],'callback_data':_0x825461[_0x4499f5(0xc8)]}),_0x2c7a2e%_0x4a931a==0x0&&(_0x2e93be[_0x1f1afe]=_0x22c846,_0x1f1afe++);}),tgBot['sendMessage'](_0x2048db[_0x19cd0d(0x206)]['id'],_0x19cd0d(0x262),{'reply_markup':{'inline_keyboard':_0x2e93be}})[_0x19cd0d(0x1c7)](_0x596026=>{telegramError(_0x596026);}),tgBot['on'](_0x19cd0d(0x103),async _0x26d9fc=>{const _0x442137=_0x19cd0d,_0x48ec4d=_0x26d9fc[_0x442137(0x1cf)],_0x3654d0=_0x26d9fc[_0x442137(0xe2)];tgBot['answerCallbackQuery'](_0x26d9fc['id'])[_0x442137(0xf3)](async()=>{const _0x1ea7bf=_0x442137;_0x48ec4d==_0x1ea7bf(0x147)?(tgBot['sendMessage'](_0x3654d0[_0x1ea7bf(0x206)]['id'],_0x1ea7bf(0x230))[_0x1ea7bf(0x1c7)](_0x3b92e5=>{telegramError(_0x3b92e5);}),_0xc8e1d5['forEach'](_0x5ae6ba=>{const _0xe3d109=_0x1ea7bf;if(_0x5ae6ba[_0xe3d109(0xc8)]!=_0xe3d109(0x147))toggleBot(_0x5ae6ba['botID'],toggleStatus(_0x5ae6ba['botID']),_0xe3d109(0x136));})):(tgBot[_0x1ea7bf(0xfb)](_0x3654d0['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x48ec4d)[_0x1ea7bf(0x1c7)](_0x16a73b=>{telegramError(_0x16a73b);}),toggleBot(_0x48ec4d,toggleStatus(_0x48ec4d),_0x1ea7bf(0x136)));}),tgBot[_0x442137(0xef)](_0x442137(0x103));});}}),tgBot['onText'](/\/off/,_0x47f966=>{const _0x4c7472=_0x12c00f;if(!validateTelegram(_0x47f966))return;tgBot[_0x4c7472(0xef)](_0x4c7472(0x103));const _0x29bd0b=getEnabledBots();if(_0x29bd0b[_0x4c7472(0x1f1)]==0x0)tgBot[_0x4c7472(0xfb)](_0x47f966[_0x4c7472(0x206)]['id'],_0x4c7472(0x241))['catch'](_0x35b2b9=>{telegramError(_0x35b2b9);});else{if(_0x29bd0b[_0x4c7472(0x1f1)]>0x1)_0x29bd0b[_0x4c7472(0x12d)]({'botID':_0x4c7472(0x147)});let _0x32cb99=[],_0x8e3624=[];const _0x329263=_0x29bd0b[_0x4c7472(0x1f1)]%0x4==0x0||_0x29bd0b[_0x4c7472(0x1f1)]%0x4==0x3||_0x29bd0b[_0x4c7472(0x1f1)]%0x3==0x1?0x4:0x3;let _0x7c1a93=0x0;_0x29bd0b['forEach']((_0x433b4c,_0x38f00e)=>{const _0x2305c0=_0x4c7472;if(_0x38f00e%_0x329263==0x0)_0x8e3624=[];_0x8e3624[_0x2305c0(0x12d)]({'text':_0x433b4c[_0x2305c0(0xc8)]==_0x2305c0(0x147)?'All\x20bots':_0x2305c0(0x240)+_0x433b4c[_0x2305c0(0xc8)],'callback_data':_0x433b4c[_0x2305c0(0xc8)]}),_0x38f00e%_0x329263==0x0&&(_0x32cb99[_0x7c1a93]=_0x8e3624,_0x7c1a93++);}),tgBot[_0x4c7472(0xfb)](_0x47f966[_0x4c7472(0x206)]['id'],_0x4c7472(0x92),{'reply_markup':{'inline_keyboard':_0x32cb99}})['catch'](_0x2ccf9d=>{telegramError(_0x2ccf9d);}),tgBot['on']('callback_query',async _0x37c58f=>{const _0x2f7f14=_0x4c7472,_0x505d64=_0x37c58f['data'],_0x3c3783=_0x37c58f['message'];tgBot[_0x2f7f14(0x254)](_0x37c58f['id'])['then'](async()=>{const _0x31bd34=_0x2f7f14;_0x505d64==_0x31bd34(0x147)?(tgBot[_0x31bd34(0xfb)](_0x3c3783[_0x31bd34(0x206)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x31bd34(0x1c7)](_0x11b31=>{telegramError(_0x11b31);}),_0x29bd0b['forEach'](_0xad1c39=>{const _0x365356=_0x31bd34;if(_0xad1c39['botID']!='all')toggleBot(_0xad1c39['botID'],toggleStatus(_0xad1c39[_0x365356(0xc8)]),_0x365356(0x136));})):(tgBot['sendMessage'](_0x3c3783[_0x31bd34(0x206)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x505d64)[_0x31bd34(0x1c7)](_0x3eb507=>{telegramError(_0x3eb507);}),toggleBot(_0x505d64,toggleStatus(_0x505d64),_0x31bd34(0x136)));}),tgBot[_0x2f7f14(0xef)]('callback_query');});}}),tgBot[_0x12c00f(0x17e)](/\/metrics/,_0x1a7ecb=>{const _0x7f40f8=_0x12c00f;if(!validateTelegram(_0x1a7ecb))return;tgBot[_0x7f40f8(0xef)]('callback_query');const _0x3568c5=getEnabledBots();if(_0x3568c5[_0x7f40f8(0x1f1)]==0x0)tgBot[_0x7f40f8(0xfb)](_0x1a7ecb['chat']['id'],_0x7f40f8(0x241))[_0x7f40f8(0x1c7)](_0x28d494=>{telegramError(_0x28d494);});else{if(_0x3568c5[_0x7f40f8(0x1f1)]>0x1){let _0x1f60eb=[],_0x48c589=[];const _0x337447=_0x3568c5['length']%0x4==0x0||_0x3568c5[_0x7f40f8(0x1f1)]%0x4==0x3||_0x3568c5[_0x7f40f8(0x1f1)]%0x3==0x1?0x4:0x3;let _0x4e53e7=0x0;_0x3568c5[_0x7f40f8(0x23a)]((_0x4a439d,_0x50386c)=>{const _0x415ecf=_0x7f40f8;if(_0x50386c%_0x337447==0x0)_0x48c589=[];_0x48c589['push']({'text':_0x415ecf(0x240)+_0x4a439d[_0x415ecf(0xc8)],'callback_data':_0x4a439d[_0x415ecf(0xc8)]}),_0x50386c%_0x337447==0x0&&(_0x1f60eb[_0x4e53e7]=_0x48c589,_0x4e53e7++);}),tgBot['sendMessage'](_0x1a7ecb[_0x7f40f8(0x206)]['id'],_0x7f40f8(0xc9),{'reply_markup':{'inline_keyboard':_0x1f60eb}})[_0x7f40f8(0x1c7)](_0xd5be32=>{telegramError(_0xd5be32);}),tgBot['on'](_0x7f40f8(0x103),async _0x2ec7aa=>{const _0x569be2=_0x7f40f8,_0x3d75ff=_0x2ec7aa[_0x569be2(0x1cf)],_0x22b2cf=_0x2ec7aa[_0x569be2(0xe2)];tgBot[_0x569be2(0x254)](_0x2ec7aa['id'])['then'](async()=>{const _0x5abfec=_0x569be2;if(pid[_0x3d75ff])pid[_0x3d75ff][_0x5abfec(0x18b)]({'function':_0x5abfec(0xab),'args':null});}),tgBot[_0x569be2(0xef)](_0x569be2(0x103));});}else{const _0x27fd57=_0x3568c5[0x0][_0x7f40f8(0xc8)];if(pid[_0x27fd57])pid[_0x27fd57][_0x7f40f8(0x18b)]({'function':_0x7f40f8(0xab),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x169d3e=>{const _0x3b1c6c=_0x12c00f;if(!validateTelegram(_0x169d3e))return;tgBot[_0x3b1c6c(0xef)]('callback_query');const _0x554f87=getEnabledBots();if(_0x554f87[_0x3b1c6c(0x1f1)]==0x0)tgBot[_0x3b1c6c(0xfb)](_0x169d3e[_0x3b1c6c(0x206)]['id'],_0x3b1c6c(0x241))[_0x3b1c6c(0x1c7)](_0x329785=>{telegramError(_0x329785);});else{if(_0x554f87['length']>0x1){let _0x4d2dea=[],_0x592e4e=[];const _0x2141a4=_0x554f87[_0x3b1c6c(0x1f1)]%0x4==0x0||_0x554f87[_0x3b1c6c(0x1f1)]%0x4==0x3||_0x554f87['length']%0x3==0x1?0x4:0x3;let _0x313d1e=0x0;_0x554f87[_0x3b1c6c(0x23a)]((_0x38fc4f,_0x59e819)=>{const _0x2d0186=_0x3b1c6c;if(_0x59e819%_0x2141a4==0x0)_0x592e4e=[];_0x592e4e[_0x2d0186(0x12d)]({'text':_0x2d0186(0x240)+_0x38fc4f[_0x2d0186(0xc8)],'callback_data':_0x38fc4f[_0x2d0186(0xc8)]}),_0x59e819%_0x2141a4==0x0&&(_0x4d2dea[_0x313d1e]=_0x592e4e,_0x313d1e++);}),tgBot[_0x3b1c6c(0xfb)](_0x169d3e[_0x3b1c6c(0x206)]['id'],_0x3b1c6c(0x104),{'reply_markup':{'inline_keyboard':_0x4d2dea}})['catch'](_0x4af39a=>{telegramError(_0x4af39a);}),tgBot['on'](_0x3b1c6c(0x103),async _0x28271a=>{const _0x545525=_0x3b1c6c,_0x421be=_0x28271a[_0x545525(0x1cf)],_0x366b51=_0x28271a[_0x545525(0xe2)];tgBot[_0x545525(0x254)](_0x28271a['id'])['then'](async()=>{const _0x2bb30e=_0x545525;if(pid[_0x421be])pid[_0x421be]['send']({'function':_0x2bb30e(0x26a),'args':null});}),tgBot[_0x545525(0xef)](_0x545525(0x103));});}else{const _0x4de3e7=_0x554f87[0x0][_0x3b1c6c(0xc8)];if(pid[_0x4de3e7])pid[_0x4de3e7][_0x3b1c6c(0x18b)]({'function':_0x3b1c6c(0x26a),'args':null});}}}),tgBot[_0x12c00f(0x17e)](/\/update/,async _0xa5d511=>{const _0x5cb044=_0x12c00f;if(!validateTelegram(_0xa5d511))return;tgBot[_0x5cb044(0xef)]('callback_query'),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0xa5d511[_0x5cb044(0x206)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x5cb044(0x1c7)](_0x2835ff=>{telegramError(_0x2835ff);});else!validInstallation?tgBot['sendMessage'](_0xa5d511['chat']['id'],_0x5cb044(0x205))[_0x5cb044(0x1c7)](_0x169262=>{telegramError(_0x169262);}):(tgBot[_0x5cb044(0xfb)](_0xa5d511[_0x5cb044(0x206)]['id'],_0x5cb044(0xa4),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x5cb044(0x162)},{'text':'No','callback_data':'no'}]]}})[_0x5cb044(0x1c7)](_0x1da483=>{telegramError(_0x1da483);}),tgBot['on'](_0x5cb044(0x103),async _0xfe6238=>{const _0x206b65=_0x5cb044,_0x399c37=_0xfe6238[_0x206b65(0x1cf)],_0x46ccc0=_0xfe6238[_0x206b65(0xe2)];tgBot[_0x206b65(0x254)](_0xfe6238['id'])[_0x206b65(0xf3)](async()=>{const _0x2048e8=_0x206b65;_0x399c37==_0x2048e8(0x162)&&(await tgBot[_0x2048e8(0xfb)](_0x46ccc0[_0x2048e8(0x206)]['id'],_0x2048e8(0x1ae))[_0x2048e8(0x1c7)](_0x50dfeb=>{telegramError(_0x50dfeb);}),updateBB(_0x2048e8(0x246))),_0x399c37=='no'&&await tgBot['sendMessage'](_0x46ccc0[_0x2048e8(0x206)]['id'],_0x2048e8(0xa8))[_0x2048e8(0x1c7)](_0x29e4f2=>{telegramError(_0x29e4f2);});}),tgBot[_0x206b65(0xef)]('callback_query');}));}),tgBot[_0x12c00f(0x17e)](/\/reinstall/,async _0x137721=>{const _0x2f9519=_0x12c00f;if(!validateTelegram(_0x137721))return;tgBot[_0x2f9519(0xef)](_0x2f9519(0x103)),!validInstallation?tgBot['sendMessage'](_0x137721['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x2f9519(0x1c7)](_0x4e2465=>{telegramError(_0x4e2465);}):(tgBot[_0x2f9519(0xfb)](_0x137721[_0x2f9519(0x206)]['id'],_0x2f9519(0x159),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x2f9519(0x162)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x3b0d22=>{telegramError(_0x3b0d22);}),tgBot['on'](_0x2f9519(0x103),async _0x169f9c=>{const _0x10f9e8=_0x2f9519,_0x12c321=_0x169f9c[_0x10f9e8(0x1cf)],_0x3a6b71=_0x169f9c[_0x10f9e8(0xe2)];tgBot[_0x10f9e8(0x254)](_0x169f9c['id'])[_0x10f9e8(0xf3)](async()=>{const _0x26f5f5=_0x10f9e8;_0x12c321==_0x26f5f5(0x162)&&(await tgBot[_0x26f5f5(0xfb)](_0x3a6b71[_0x26f5f5(0x206)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x26f5f5(0x1c7)](_0x1724a1=>{telegramError(_0x1724a1);}),updateBB(_0x26f5f5(0xcb))),_0x12c321=='no'&&await tgBot['sendMessage'](_0x3a6b71[_0x26f5f5(0x206)]['id'],_0x26f5f5(0x142))[_0x26f5f5(0x1c7)](_0x31a330=>{telegramError(_0x31a330);});}),tgBot[_0x10f9e8(0xef)](_0x10f9e8(0x103));}));}),tgBot[_0x12c00f(0x17e)](/\/toggle/,_0x2973aa=>{const _0x2becfe=_0x12c00f;if(!validateTelegram(_0x2973aa))return;tgBot['removeListener']('callback_query');const _0x12c88d=getBotsWithMode();if(_0x12c88d[_0x2becfe(0x1f1)]==0x0)tgBot[_0x2becfe(0xfb)](_0x2973aa[_0x2becfe(0x206)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x2becfe(0x1c7)](_0x39002b=>{telegramError(_0x39002b);});else{let _0x381584=[],_0x21dbed=[];const _0x21cf17=0x2;let _0x2db79d=0x0;_0x12c88d[_0x2becfe(0x23a)]((_0x519fdd,_0x22d557)=>{const _0x25ff0a=_0x2becfe;if(_0x22d557%_0x21cf17==0x0)_0x21dbed=[];_0x21dbed[_0x25ff0a(0x12d)]({'text':_0x25ff0a(0x240)+_0x519fdd['botID']+'\x20('+_0x519fdd[_0x25ff0a(0x20a)]+')','callback_data':_0x519fdd[_0x25ff0a(0xc8)]}),_0x22d557%_0x21cf17==0x0&&(_0x381584[_0x2db79d]=_0x21dbed,_0x2db79d++);}),tgBot[_0x2becfe(0xfb)](_0x2973aa[_0x2becfe(0x206)]['id'],_0x2becfe(0x25e),{'reply_markup':{'inline_keyboard':_0x381584}})[_0x2becfe(0x1c7)](_0x442d09=>{telegramError(_0x442d09);}),tgBot['on'](_0x2becfe(0x103),async _0x43b528=>{const _0x2f36ac=_0x2becfe,_0x3daad1=_0x43b528['data'],_0x59a00f=_0x43b528['message'];tgBot[_0x2f36ac(0x254)](_0x43b528['id'])['then'](async()=>{const _0x2eb871=_0x2f36ac,_0x157d33=_0x12c88d[_0x2eb871(0x226)](_0x18bd8c=>_0x18bd8c['botID']==_0x3daad1),_0x2e23d8=_0x157d33[_0x2eb871(0x20a)]==_0x2eb871(0x184)?_0x2eb871(0x20d):_0x2eb871(0x184);tgBot['sendMessage'](_0x59a00f[_0x2eb871(0x206)]['id'],_0x2eb871(0x196)+_0x3daad1+'\x20to\x20'+_0x2e23d8+_0x2eb871(0x1c0))[_0x2eb871(0x1c7)](_0x528c83=>{telegramError(_0x528c83);}),toggleBotMode(_0x3daad1);}),tgBot['removeListener'](_0x2f36ac(0x103));});}}),tgBot[_0x12c00f(0x17e)](/\/names/,_0x54bb95=>{const _0x403977=_0x12c00f;if(!validateTelegram(_0x54bb95))return;let _0xf2a664='';config[_0x403977(0x23a)](_0xf718c1=>{const _0x44b9f5=_0x403977;_0xf2a664+='Bot\x20'+_0xf718c1[_0x44b9f5(0xc8)]+':\x20'+_0xf718c1[_0x44b9f5(0xf1)]+'\x0a';}),tgBot[_0x403977(0xfb)](_0x54bb95[_0x403977(0x206)]['id'],_0xf2a664,{'parse_mode':_0x403977(0x163)})[_0x403977(0x1c7)](_0x46a916=>{telegramError(_0x46a916);});}),tgBot[_0x12c00f(0x17e)](/\/disable/,_0x1968b3=>{const _0x4f90e9=_0x12c00f;if(!validateTelegram(_0x1968b3))return;tgBot[_0x4f90e9(0xfb)](_0x1968b3[_0x4f90e9(0x206)]['id'],_0x4f90e9(0x1fe))[_0x4f90e9(0x1c7)](_0x12e079=>{telegramError(_0x12e079);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x289588=>{const _0x2afe64=_0x12c00f;if(!validateTelegram(_0x289588))return;tgBot[_0x2afe64(0xfb)](_0x289588[_0x2afe64(0x206)]['id'],_0x56ea98)['catch'](_0x1d42dc=>{telegramError(_0x1d42dc);});}),tgBot['on'](_0x12c00f(0x1a2),_0xfcb27c=>{const _0x2551e3=_0x12c00f;_0xfcb27c['toString']()[_0x2551e3(0x16c)](_0x2551e3(0x1b5))&&(logger[_0x2551e3(0x131)]('Invalid\x20Telegram\x20token'),tgBot[_0x2551e3(0xb0)](),tgBot=null,io['to']('botmanager')[_0x2551e3(0x90)](_0x2551e3(0x21a),'Invalid\x20Telegram\x20token'));}),process['once'](_0x12c00f(0xfe),()=>{const _0x311d09=_0x12c00f;if(tgBot)tgBot[_0x311d09(0xb0)]();process[_0x311d09(0x1f5)](0x1);}),process[_0x12c00f(0x17f)](_0x12c00f(0x1c5),()=>{const _0x2332b6=_0x12c00f;if(tgBot)tgBot[_0x2332b6(0xb0)]();process['exit'](0x1);});}}function disableTelegram(){const _0x1d6ebf=_0x5e557c;tgBot&&(tgBot[_0x1d6ebf(0xb0)](),tgBot=null);}function sendTelegram(_0x250474,_0x1e2568){const _0x17712e=_0x5e557c;if(settings['telegramEnabled']){if(settings['telegramEvents']=='all'||(_0x1e2568[_0x17712e(0x176)]==_0x17712e(0xeb)||_0x1e2568[_0x17712e(0x176)]==_0x17712e(0xbd)||_0x1e2568[_0x17712e(0x176)]==_0x17712e(0x1ac))&&settings['telegramEvents']==_0x17712e(0xba)||_0x1e2568[_0x17712e(0x176)]==_0x17712e(0x251)&&settings[_0x17712e(0x258)]==_0x17712e(0x250)){if(tgBot&&settings[_0x17712e(0x95)]){if(_0x1e2568[_0x17712e(0x10c)])tgBot[_0x17712e(0xfb)](settings[_0x17712e(0x95)],_0x1e2568['botname']+'\x20>\x20'+_0x1e2568['event'])['catch'](_0x24fdef=>{telegramError(_0x24fdef);});else tgBot['sendMessage'](settings['telegramChatId'],'Bot\x20'+_0x250474+'\x20>\x20'+_0x1e2568[_0x17712e(0xb8)])[_0x17712e(0x1c7)](_0x2e3a96=>{telegramError(_0x2e3a96);});}}}}async function sendTelegramMsg(_0x3ea48a,_0x10d221=_0x5e557c(0x163)){const _0x2919f5=_0x5e557c;return settings[_0x2919f5(0x1d6)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0x2919f5(0x95)],_0x3ea48a,{'parse_mode':_0x10d221})[_0x2919f5(0x1c7)](_0x1715a6=>{telegramError(_0x1715a6);}),!![]):![];}function getDeviceWithIp(_0x4c3f4d){const _0xdeb281=_0x5e557c;return devices[_0xdeb281(0x226)](_0x461bf2=>_0x461bf2['ip']===_0x4c3f4d);}function temporaryAccess2FA(_0x5e1eeb,_0x181f1c){const _0x5a409e=_0x5e557c;let _0x53e525=new Date(),_0x858ed6=![];if(lastIpApproval){if(_0x53e525-lastIpApproval<0x1388)_0x858ed6=!![];}lastIpApproval=new Date();if(_0x858ed6)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x5a409e(0xef)](_0x5a409e(0x103)),tgBot[_0x5a409e(0xfb)](settings[_0x5a409e(0x95)],_0x5a409e(0x12b)+normalizeIP(_0x181f1c)[_0x5a409e(0x110)]+_0x5a409e(0x154),{'parse_mode':_0x5a409e(0x163),'reply_markup':{'inline_keyboard':[[{'text':_0x5a409e(0x1e3),'callback_data':'5'},{'text':_0x5a409e(0x1d2),'callback_data':'15'},{'text':_0x5a409e(0x1bd),'callback_data':'30'},{'text':_0x5a409e(0xf0),'callback_data':'reject'}]]}})[_0x5a409e(0x1c7)](_0x244f4d=>{telegramError(_0x244f4d);}),tgBot['on'](_0x5a409e(0x103),async _0x37a927=>{const _0x41812c=_0x5a409e,_0x5f505a=_0x37a927[_0x41812c(0x1cf)],_0x5192c7=_0x37a927[_0x41812c(0xe2)];tgBot[_0x41812c(0x254)](_0x37a927['id'])[_0x41812c(0xf3)](async()=>{const _0x12d35b=_0x41812c;devices[_0x5e1eeb][_0x12d35b(0x11b)]={'clientip':_0x181f1c,'timestamp':new Date()[_0x12d35b(0x255)](),'expiry':_0x5f505a},_0x5f505a!=_0x12d35b(0xf0)?(await tgBot[_0x12d35b(0xfb)](_0x5192c7[_0x12d35b(0x206)]['id'],_0x12d35b(0x14e)+_0x5f505a+_0x12d35b(0x98),{'parse_mode':_0x12d35b(0x163)})['catch'](_0x12aafb=>{telegramError(_0x12aafb);}),io['to'](_0x5e1eeb)[_0x12d35b(0x90)](_0x12d35b(0x1f0),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x5192c7[_0x12d35b(0x206)]['id'],_0x12d35b(0x13d))[_0x12d35b(0x1c7)](_0xaef342=>{telegramError(_0xaef342);}),io['to'](_0x5e1eeb)[_0x12d35b(0x90)](_0x12d35b(0x1f0),{'access':{'allow':![],'reason':_0x12d35b(0xe8),'token':null}}));}),tgBot['removeListener'](_0x41812c(0x103));}));}function loginAccess2FA(_0x3ac1a3,_0xad559f){const _0x5dc8ee=_0x5e557c;tgBot&&settings[_0x5dc8ee(0x95)]&&(tgBot[_0x5dc8ee(0xef)]('callback_query'),tgBot[_0x5dc8ee(0xfb)](settings[_0x5dc8ee(0x95)],_0x5dc8ee(0x201)+normalizeIP(_0xad559f)['show']+'</b>\x20?',{'parse_mode':_0x5dc8ee(0x163),'reply_markup':{'inline_keyboard':[[{'text':_0x5dc8ee(0x213),'callback_data':loginExpiry},{'text':_0x5dc8ee(0xf0),'callback_data':_0x5dc8ee(0xf0)}]]}})[_0x5dc8ee(0x1c7)](_0x5c359d=>{telegramError(_0x5c359d);}),tgBot['on'](_0x5dc8ee(0x103),async _0x48f190=>{const _0x49930d=_0x5dc8ee,_0x31b596=_0x48f190['data'],_0x504424=_0x48f190[_0x49930d(0xe2)];tgBot['answerCallbackQuery'](_0x48f190['id'])[_0x49930d(0xf3)](async()=>{const _0x4a3fc5=_0x49930d;devices[_0x3ac1a3][_0x4a3fc5(0xc4)]={'clientip':_0xad559f,'timestamp':new Date()['getTime'](),'expiry':_0x31b596},_0x31b596!=_0x4a3fc5(0xf0)?(await tgBot[_0x4a3fc5(0xfb)](_0x504424[_0x4a3fc5(0x206)]['id'],_0x4a3fc5(0x267),{'parse_mode':'HTML'})[_0x4a3fc5(0x1c7)](_0x459eba=>{telegramError(_0x459eba);}),io['to'](_0x3ac1a3)[_0x4a3fc5(0x90)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x504424[_0x4a3fc5(0x206)]['id'],_0x4a3fc5(0x1dd))['catch'](_0x409986=>{telegramError(_0x409986);}),io['to'](_0x3ac1a3)[_0x4a3fc5(0x90)]('status',{'access':{'allow':![],'reason':_0x4a3fc5(0x1ab),'token':null}}));}),tgBot[_0x49930d(0xef)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xa2cb4a=_0x5e557c;return dbConfig[_0xa2cb4a(0x1f2)](_0xa2cb4a(0x16b))[_0xa2cb4a(0x212)](_0xa2cb4a(0xc8))[_0xa2cb4a(0x91)]({'status':_0xa2cb4a(0x137)})[_0xa2cb4a(0x1a3)]()||[];}function getDisabledBots(){const _0x19082a=_0x5e557c;return dbConfig[_0x19082a(0x1f2)]('bots')['sortBy'](_0x19082a(0xc8))[_0x19082a(0x91)]({'status':_0x19082a(0x15b)})[_0x19082a(0x1a3)]()||[];}function getBotAttributes(_0x2f724d){const _0x1792f8=_0x5e557c;let _0x113850={};const _0x1a9d8d=configpath+'bot-'+_0x2f724d+_0x1792f8(0x133),_0x45665f=fs[_0x1792f8(0x114)](_0x1a9d8d);if(_0x45665f){const _0x421d79=fs['readFileSync'](_0x1a9d8d);try{const _0x10459f=JSON[_0x1792f8(0x235)](_0x421d79),_0x347841=_0x10459f?_0x10459f[_0x1792f8(0x1fa)][0x0][_0x1792f8(0x1d3)]:![];_0x113850[_0x1792f8(0x20a)]=_0x347841?'auto':_0x1792f8(0x20d),_0x113850[_0x1792f8(0xf1)]=_0x10459f?_0x10459f['bot'][0x0][_0x1792f8(0xf1)]:_0x1792f8(0x240)+_0x2f724d;}catch(_0x90f7a){_0x113850[_0x1792f8(0x20a)]=_0x1792f8(0x20d),_0x113850[_0x1792f8(0xf1)]=_0x1792f8(0x240)+_0x2f724d;}}else _0x113850['mode']='manual',_0x113850[_0x1792f8(0xf1)]=_0x1792f8(0x240)+_0x2f724d;return _0x113850;}function getBotsWithMode(){const _0x1a1044=_0x5e557c,_0x50df5b=dbConfig[_0x1a1044(0x1f2)](_0x1a1044(0x16b))[_0x1a1044(0x212)](_0x1a1044(0xc8))[_0x1a1044(0x1a3)]()||[];return _0x50df5b[_0x1a1044(0x23a)](_0x577304=>{const _0x5907c5=_0x1a1044;let _0x3c98b1=getBotAttributes(_0x577304[_0x5907c5(0xc8)]);_0x577304[_0x5907c5(0x20a)]=_0x3c98b1[_0x5907c5(0x20a)];}),_0x50df5b;}function getBotExchanges(){const _0xe326f3=_0x5e557c;let _0x25b0a1=[];const _0x52f3b1=dbConfig['get']('bots')['sortBy'](_0xe326f3(0xc8))['value']()||[];_0x52f3b1[_0xe326f3(0x23a)](_0x463950=>{const _0xa8fdbb=_0xe326f3;if(_0x463950['status']==_0xa8fdbb(0x137)){const _0x4e0df=configpath+_0xa8fdbb(0x1d9)+_0x463950[_0xa8fdbb(0xc8)]+_0xa8fdbb(0x133),_0x2919ba=fs[_0xa8fdbb(0x114)](_0x4e0df);let _0x27c5f7;if(_0x2919ba){const _0x3528f5=fs[_0xa8fdbb(0x1d1)](_0x4e0df);try{const _0x3ca0bf=JSON['parse'](_0x3528f5);_0x27c5f7=_0x3ca0bf?_0x3ca0bf[_0xa8fdbb(0x1fa)][0x0]['exchange']:null;}catch(_0x236b06){}}if(_0x27c5f7)_0x25b0a1[_0xa8fdbb(0x12d)](_0x27c5f7);}});const _0x583490=[...new Set(_0x25b0a1)][_0xe326f3(0xe4)]();return _0x583490;}async function initUser(){const _0x5f4391=_0x5e557c;if(!settings[_0x5f4391(0x24c)]){const _0x1656eb=uuidRandom();mixpanel[_0x5f4391(0x1c8)](_0x1656eb),updateSetting(_0x5f4391(0x24c),_0x1656eb);}}async function initSecure(){const _0x51c07b=_0x5e557c;let _0x7e40ed=getSecure();if(!_0x7e40ed[_0x51c07b(0x216)](_0x51c07b(0xa9))){let _0x1c9e7a=await generateKeys();_0x7e40ed[_0x51c07b(0x1ce)]=_0x1c9e7a['publicKey'],_0x7e40ed[_0x51c07b(0x244)]=_0x1c9e7a['privateKey'],_0x7e40ed['secret']=crypto[_0x51c07b(0x118)](0x20)[_0x51c07b(0xc7)](_0x51c07b(0x231));;storeSecure(_0x7e40ed);}}function getSettings(){const _0x52fd2e=_0x5e557c;return dbSettings['get'](_0x52fd2e(0x23b))[_0x52fd2e(0x1a3)]()||{};}function getSecure(){const _0x44b891=_0x5e557c;return dbSecure[_0x44b891(0x1f2)](_0x44b891(0xaf))[_0x44b891(0x1a3)]()||{};}function getBlacklist(){const _0x3ed838=_0x5e557c;return dbSecure[_0x3ed838(0x1f2)](_0x3ed838(0xe6))['value']()||[];}function broadcastToBots(_0x155d20,_0x551298){const _0xba4a98=_0x5e557c;config[_0xba4a98(0x23a)](_0x3e977f=>{const _0x2a7813=_0xba4a98;if(_0x3e977f[_0x2a7813(0x1f0)]==_0x2a7813(0x137)&&_0x3e977f[_0x2a7813(0x182)]==_0x2a7813(0xb7)||_0x3e977f[_0x2a7813(0x1f0)]==_0x2a7813(0x1c9)&&_0x3e977f[_0x2a7813(0x182)]==_0x2a7813(0xb7)){if(pid[_0x3e977f[_0x2a7813(0xc8)]])pid[_0x3e977f[_0x2a7813(0xc8)]][_0x2a7813(0x18b)]({[_0x155d20]:_0x551298});}});}function storeSettings(_0x6ee4da,_0x30800f=![]){const _0x362df6=_0x5e557c;_0x6ee4da={...settings,..._0x6ee4da};if(_0x30800f&&_0x6ee4da['bbPassword']!=_0x362df6(0x1b8)&&_0x6ee4da[_0x362df6(0x13c)]!=_0x362df6(0x22d)&&_0x6ee4da[_0x362df6(0x13c)]!=''){const _0x184560=crypt[_0x362df6(0x209)](secure[_0x362df6(0x244)],_0x6ee4da[_0x362df6(0x13c)])['message']['split']('@')[0x0],_0x1316db=bcrypt[_0x362df6(0x13f)](_0x184560,saltRounds);_0x6ee4da={..._0x6ee4da,'bbPassword':_0x1316db};}if(_0x30800f&&_0x6ee4da[_0x362df6(0xfa)]!=_0x362df6(0x1b8)&&_0x6ee4da[_0x362df6(0xfa)]!=_0x362df6(0x22d)&&_0x6ee4da[_0x362df6(0xfa)]!=''){const _0x431805=crypt[_0x362df6(0x209)](secure[_0x362df6(0x244)],_0x6ee4da['telegramToken'])['message'][_0x362df6(0x160)]('@')[0x0];_0x6ee4da={..._0x6ee4da,'telegramToken':_0x431805};}const _0x56339c=_0x6ee4da[_0x362df6(0xfa)]!='************'&&_0x6ee4da[_0x362df6(0xfa)]!=settings[_0x362df6(0xfa)]||_0x6ee4da[_0x362df6(0x1a9)]!=settings[_0x362df6(0x1a9)],_0x123c81=_0x6ee4da[_0x362df6(0xfa)]==''||_0x6ee4da['telegramUsername']=='';if(_0x56339c)_0x6ee4da['telegramEvents']='all';for(const [_0x559271,_0x3fe2a5]of Object['entries'](_0x6ee4da)){if(_0x559271==_0x362df6(0xfa)&&_0x3fe2a5==_0x362df6(0x1b8)){_0x6ee4da[_0x362df6(0xfa)]=settings[_0x362df6(0xfa)];continue;};if(_0x559271==_0x362df6(0x13c)&&_0x3fe2a5==_0x362df6(0x1b8)){_0x6ee4da[_0x362df6(0x13c)]=settings[_0x362df6(0x13c)];continue;};dbSettings[_0x362df6(0x1aa)](_0x362df6(0x1d4)+_0x559271,_0x3fe2a5)[_0x362df6(0x191)]();}settings=_0x6ee4da,io['to'](_0x362df6(0x130))[_0x362df6(0x90)](_0x362df6(0x23b),cleanSettings()),broadcastToBots(_0x362df6(0x192),settings[_0x362df6(0x192)]),broadcastToBots(_0x362df6(0x1d8),settings['onepagemode']);if(_0x56339c&&!_0x123c81)initTelegram();if(_0x56339c&&_0x123c81)disableTelegram();getAllClients()[_0x362df6(0x23a)](_0x5a382f=>{const _0x265d8d=_0x362df6;getSocket(_0x5a382f['id'])[_0x265d8d(0x90)](_0x265d8d(0x1f0),{'access':{'allow':![],'reason':_0x265d8d(0x146),'token':null}});});}function updateSetting(_0x17eaa0,_0xd704f2){const _0x59d696=_0x5e557c;dbSettings['set']('settings.'+_0x17eaa0,_0xd704f2)[_0x59d696(0x191)](),settings=getSettings(),io['to'](_0x59d696(0x130))['emit'](_0x59d696(0x23b),cleanSettings());}function storeSecure(_0x104971){const _0x117eea=_0x5e557c;dbSecure['get'](_0x117eea(0xaf))[_0x117eea(0x12d)](_0x104971)[_0x117eea(0x191)](),secure=_0x104971;}function addBlacklist(_0x5773cc){const _0xe6ac2=_0x5e557c;cleanBlacklist();let _0x3c9250;devices[_0x5773cc][_0xe6ac2(0x11b)]?_0x3c9250=Math['max'](devices[_0x5773cc][_0xe6ac2(0x11b)][_0xe6ac2(0x93)],loginExpiry):_0x3c9250=loginExpiry,dbSecure[_0xe6ac2(0x1f2)](_0xe6ac2(0xe6))[_0xe6ac2(0x12d)]({'expiry':new Date()[_0xe6ac2(0x255)]()+_0x3c9250*0x3c*0x3e8,'token':devices[_0x5773cc][_0xe6ac2(0x1a6)][_0xe6ac2(0x178)]})[_0xe6ac2(0x191)](),blacklist=dbSecure[_0xe6ac2(0x1f2)](_0xe6ac2(0xe6))[_0xe6ac2(0x1a3)]();}function cleanBlacklist(){const _0x1fbbdb=_0x5e557c;let _0x31da15=dbSecure['get'](_0x1fbbdb(0xe6))[_0x1fbbdb(0x1bf)]()[_0x1fbbdb(0x1a3)](),_0xddcc79=new Date()[_0x1fbbdb(0x255)]();_0x31da15['forEach'](_0xc005ec=>{const _0x1d50fc=_0x1fbbdb;_0xc005ec[_0x1d50fc(0x93)]<_0xddcc79&&dbSecure['get'](_0x1d50fc(0xe6))[_0x1d50fc(0x239)]({'expiry':_0xc005ec[_0x1d50fc(0x93)]})['write']();});}function initStates(){const _0x27c733=_0x5e557c;let _0x47cf05=getConfiguration();_0x47cf05[_0x27c733(0x23a)](_0x20062e=>{const _0x46db2d=_0x27c733;_0x20062e[_0x46db2d(0x182)]=_0x46db2d(0x136);}),storeConfiguration(_0x47cf05);}function onKeys(){const _0x2e780d=new RSA();return new Promise(_0x197383=>{const _0x1f7257=_0x3723;_0x2e780d[_0x1f7257(0x16a)]()[_0x1f7257(0xf3)](_0x265dda=>{_0x197383(_0x265dda);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1285b6=_0x5e557c;let _0x2fa504=getSettings(),_0x3e32bd=![];!_0x2fa504[_0x1285b6(0x216)](_0x1285b6(0x1b9))&&(_0x2fa504[_0x1285b6(0x1b9)]=0x0,_0x3e32bd=!![]);!_0x2fa504['hasOwnProperty'](_0x1285b6(0x217))&&(_0x2fa504[_0x1285b6(0x217)]=0x0,_0x3e32bd=!![]);!_0x2fa504[_0x1285b6(0x216)](_0x1285b6(0x14f))&&(_0x2fa504[_0x1285b6(0x14f)]=_0x1285b6(0x16f),_0x3e32bd=!![]);!_0x2fa504['hasOwnProperty']('onepagemode')&&(_0x2fa504[_0x1285b6(0x1d8)]=![],_0x3e32bd=!![]);if(_0x3e32bd)storeSettings(_0x2fa504);try{fs[_0x1285b6(0x1fd)](configbackuppath,{'withFileTypes':!![]})[_0x1285b6(0x23a)](_0x2642cb=>{const _0x54a46d=_0x1285b6;if(!_0x2642cb[_0x54a46d(0x224)]()){if(!_0x2642cb[_0x54a46d(0x109)][_0x54a46d(0x197)](_0x54a46d(0x11a)))fs[_0x54a46d(0xf8)](configbackuppath+_0x2642cb['name']);}else fs[_0x54a46d(0x219)](configbackuppath+_0x2642cb[_0x54a46d(0x109)],{'recursive':!![]});});}catch(_0x5a8a26){logger[_0x1285b6(0xdb)](_0x1285b6(0xfc),_0x5a8a26);}}function storeConfiguration(_0x160f97){const _0x4253da=_0x5e557c;dbConfig[_0x4253da(0x1f2)](_0x4253da(0x16b))[_0x4253da(0x239)]()['write'](),_0x160f97[_0x4253da(0x23a)](_0x56f513=>{delete _0x56f513['mode'];}),dbConfig[_0x4253da(0x1f2)](_0x4253da(0x16b))[_0x4253da(0x12d)](..._0x160f97)[_0x4253da(0x191)](),config=_0x160f97;}function resetPassword(){const _0x2edcce=_0x5e557c;tgBot&&settings[_0x2edcce(0x95)]&&(tgBot[_0x2edcce(0xef)](_0x2edcce(0x103)),tgBot[_0x2edcce(0xfb)](settings[_0x2edcce(0x95)],_0x2edcce(0x18d),{'parse_mode':_0x2edcce(0x163),'reply_markup':{'inline_keyboard':[[{'text':_0x2edcce(0x162),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x2edcce(0x1c7)](_0x452d40=>{telegramError(_0x452d40);}),tgBot['on']('callback_query',async _0x1e1a6d=>{const _0x164ec4=_0x2edcce,_0x293798=_0x1e1a6d[_0x164ec4(0x1cf)],_0x54cf27=_0x1e1a6d[_0x164ec4(0xe2)];tgBot[_0x164ec4(0x254)](_0x1e1a6d['id'])[_0x164ec4(0xf3)](async()=>{const _0x5378c7=_0x164ec4;if(_0x293798!='no'){const _0x437650=0xf,_0x232de0='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x2d26d2=Array[_0x5378c7(0x101)](crypto[_0x5378c7(0x111)](new Uint32Array(_0x437650)))[_0x5378c7(0xf6)](_0x3a4897=>_0x232de0[_0x3a4897%_0x232de0[_0x5378c7(0x1f1)]])[_0x5378c7(0xd8)](''),_0x43c7c2=bcrypt[_0x5378c7(0x13f)](_0x2d26d2,saltRounds);storeSettings({'bbPassword':_0x43c7c2}),await tgBot[_0x5378c7(0xfb)](_0x54cf27[_0x5378c7(0x206)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x2d26d2,{'parse_mode':_0x5378c7(0x163)})[_0x5378c7(0x1c7)](_0x4c0ef6=>{telegramError(_0x4c0ef6);});}else await tgBot[_0x5378c7(0xfb)](_0x54cf27[_0x5378c7(0x206)]['id'],_0x5378c7(0xd3))['catch'](_0x4cf9c9=>{telegramError(_0x4cf9c9);});}),tgBot[_0x164ec4(0xef)](_0x164ec4(0x103));}));}async function confirmRestore(_0x508725,_0x38ad63){const _0x444774=_0x5e557c;io['to'](_0x444774(0x130))[_0x444774(0x90)](_0x444774(0x21a),_0x444774(0xd7),'success'),tgBot&&settings[_0x444774(0x95)]&&(tgBot['removeListener'](_0x444774(0x103)),await tgBot[_0x444774(0xfb)](settings[_0x444774(0x95)],_0x444774(0xf7),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x444774(0x162),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x444774(0x1c7)](_0x5adf53=>{telegramError(_0x5adf53);}),tgBot['on']('callback_query',async _0x1c22f1=>{const _0xdcdd4f=_0x444774,_0xdc21ec=_0x1c22f1[_0xdcdd4f(0x1cf)],_0x19da68=_0x1c22f1['message'];tgBot[_0xdcdd4f(0x254)](_0x1c22f1['id'])['then'](async()=>{const _0x4d408d=_0xdcdd4f;_0xdc21ec==_0x4d408d(0x162)?(await tgBot[_0x4d408d(0xfb)](_0x19da68[_0x4d408d(0x206)]['id'],_0x4d408d(0x214),{'parse_mode':_0x4d408d(0x163)})[_0x4d408d(0x1c7)](_0x477b1e=>{telegramError(_0x477b1e);}),unzipFile(_0x508725,_0x38ad63)):(logger[_0x4d408d(0xdb)](_0x4d408d(0xbf)),await tgBot[_0x4d408d(0xfb)](_0x19da68[_0x4d408d(0x206)]['id'],_0x4d408d(0xbf))[_0x4d408d(0x1c7)](_0x1bbae4=>{telegramError(_0x1bbae4);}));}),tgBot[_0xdcdd4f(0xef)]('callback_query');}));}function getServerTime(){const _0x44a969=_0x5e557c,_0x35746b=new Date();return _0x35746b['getFullYear']()+'/'+(_0x35746b[_0x44a969(0x1a0)]()+0x1)[_0x44a969(0xc7)]()[_0x44a969(0x269)](0x2,'0')+'/'+_0x35746b[_0x44a969(0x11d)]()[_0x44a969(0xc7)]()['padStart'](0x2,'0')+'\x20'+_0x35746b['getHours']()[_0x44a969(0xc7)]()[_0x44a969(0x269)](0x2,'0')+':'+_0x35746b['getMinutes']()[_0x44a969(0xc7)]()[_0x44a969(0x269)](0x2,'0')+':'+_0x35746b[_0x44a969(0x121)]()[_0x44a969(0xc7)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x238265=_0x5e557c,_0x29db05=shiftedTime();return _0x29db05[_0x238265(0x1e5)]()+'/'+(_0x29db05[_0x238265(0x1a0)]()+0x1)[_0x238265(0xc7)]()[_0x238265(0x269)](0x2,'0')+'/'+_0x29db05[_0x238265(0x11d)]()[_0x238265(0xc7)]()['padStart'](0x2,'0')+'\x20'+_0x29db05[_0x238265(0x96)]()['toString']()['padStart'](0x2,'0')+':'+_0x29db05[_0x238265(0x221)]()[_0x238265(0xc7)]()[_0x238265(0x269)](0x2,'0')+':'+_0x29db05[_0x238265(0x121)]()['toString']()[_0x238265(0x269)](0x2,'0');}function getCleanTimeStamp(){const _0x2ff025=_0x5e557c,_0x20f313=shiftedTime();return _0x20f313[_0x2ff025(0x1e5)]()+(_0x20f313[_0x2ff025(0x1a0)]()+0x1)[_0x2ff025(0xc7)]()['padStart'](0x2,'0')+_0x20f313['getDate']()[_0x2ff025(0xc7)]()[_0x2ff025(0x269)](0x2,'0')+'-'+_0x20f313[_0x2ff025(0x96)]()[_0x2ff025(0xc7)]()[_0x2ff025(0x269)](0x2,'0')+_0x20f313[_0x2ff025(0x221)]()['toString']()[_0x2ff025(0x269)](0x2,'0')+_0x20f313[_0x2ff025(0x121)]()[_0x2ff025(0xc7)]()[_0x2ff025(0x269)](0x2,'0');}function shiftedTime(){const _0x5e953b=_0x5e557c,_0x2044fc=new Date();let _0x18bcec=_0x2044fc;if(settings[_0x5e953b(0x192)]&&settings[_0x5e953b(0x192)]!==0x0)_0x18bcec=fns[_0x5e953b(0x1e0)](_0x2044fc,{'hours':settings[_0x5e953b(0x192)]});return _0x18bcec;}function startScheduler(){const _0x144fae=_0x5e557c,_0x1bf545=new Date()[_0x144fae(0x1e8)](),_0x166c89=shiftedTime()['getHours']();_0x166c89==0x4&&backupConfigFiles();_0x166c89==0x0&&rotateLogFiles();_0x1bf545%0x6==0x0&&triggerAnalytics();_0x1bf545%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x24d27a){const _0x2d6e17=_0x5e557c;logger[_0x2d6e17(0xdb)](_0x2d6e17(0x14d)+_0x24d27a);const _0x301566=getBotsWithMode();_0x301566[_0x2d6e17(0x1f1)]>0x0?confirmRestore(configbackuppath,_0x24d27a):unzipFile(configbackuppath,_0x24d27a);}async function getBackupFiles(_0x39ee16=null){const _0x27669c=_0x5e557c;let _0x402b95=[],_0x54c17a=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x54c17a[_0x27669c(0xe4)]((_0x2aa2c1,_0x22fb41)=>_0x2aa2c1[_0x27669c(0x109)]<_0x22fb41[_0x27669c(0x109)]?0x1:_0x22fb41['name']<_0x2aa2c1[_0x27669c(0x109)]?-0x1:0x0),_0x54c17a['forEach'](_0x215654=>{const _0x12d51c=_0x27669c;if(!_0x215654['isDirectory']()&&_0x215654[_0x12d51c(0x109)][_0x12d51c(0x197)](_0x12d51c(0x11a))&&_0x215654[_0x12d51c(0x109)][_0x12d51c(0x1d0)](_0x12d51c(0x14b))){const _0x42e78a=formatDate(fs['statSync'](configbackuppath+_0x215654[_0x12d51c(0x109)])[_0x12d51c(0x129)]);_0x402b95[_0x12d51c(0x12d)]({'name':_0x215654['name'],'mtime':_0x42e78a});}});if(_0x39ee16)io['to'](_0x39ee16)['emit'](_0x27669c(0x1b7),_0x402b95);else return _0x402b95;}async function backupConfigFiles(){const _0x362821=_0x5e557c;await zipFiles(_0x362821(0x11c));const _0x5d1751=getCleanTimeStamp();fs[_0x362821(0x257)](zippath+_0x362821(0x1b4),configbackuppath+(_0x362821(0x11a)+_0x5d1751+'.zip'));let _0x4f3fdc=fs[_0x362821(0x1fd)](configbackuppath,{'withFileTypes':!![]});_0x4f3fdc[_0x362821(0xe4)]((_0x975252,_0x265c7c)=>_0x975252[_0x362821(0x109)]<_0x265c7c[_0x362821(0x109)]?0x1:_0x265c7c[_0x362821(0x109)]<_0x975252[_0x362821(0x109)]?-0x1:0x0),_0x4f3fdc[_0x362821(0x1f1)]>maxBackups&&fs[_0x362821(0xf8)](configbackuppath+_0x4f3fdc[_0x4f3fdc[_0x362821(0x1f1)]-0x1]['name']);}function rotateLogFiles(){const _0x3ca62d=_0x5e557c,_0x4485fe=fs[_0x3ca62d(0x14c)](logspath+_0x3ca62d(0x229)),_0x442279=_0x4485fe[_0x3ca62d(0x132)]/0x400;if(_0x442279>0x64){let _0x385e4c=fs[_0x3ca62d(0x1fd)](logspath,{'withFileTypes':!![]});_0x385e4c[_0x3ca62d(0xe4)]((_0x380ebe,_0x1838ee)=>_0x380ebe[_0x3ca62d(0x109)]<_0x1838ee['name']?0x1:_0x1838ee[_0x3ca62d(0x109)]<_0x380ebe[_0x3ca62d(0x109)]?-0x1:0x0),_0x385e4c[_0x3ca62d(0x23a)](_0x3e2a0c=>{const _0x40b2ab=_0x3ca62d;if(_0x3e2a0c[_0x40b2ab(0x109)]=='output-002.log')fs['copyFileSync'](logspath+_0x3e2a0c[_0x40b2ab(0x109)],logspath+_0x40b2ab(0x10f));if(_0x3e2a0c[_0x40b2ab(0x109)]==_0x40b2ab(0x1c1))fs[_0x40b2ab(0x257)](logspath+_0x3e2a0c[_0x40b2ab(0x109)],logspath+_0x40b2ab(0x100));_0x3e2a0c[_0x40b2ab(0x109)]==_0x40b2ab(0x229)&&(fs[_0x40b2ab(0x257)](logspath+_0x3e2a0c['name'],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x3e2a0c[_0x40b2ab(0x109)],''));});}}async function zipFiles(_0x28b9da){const _0x214977=_0x5e557c;let _0x11b50d;if(_0x28b9da==_0x214977(0x256))_0x11b50d=logspath;if(_0x28b9da==_0x214977(0x24f))_0x11b50d=configpath;if(_0x28b9da=='backup-full')_0x11b50d=configpath;let _0x40798a=fs['readdirSync'](_0x11b50d,{'withFileTypes':!![]});const _0x39fba7=new require('node-zip')();_0x40798a['forEach'](_0x3970cc=>{const _0x3b0bae=_0x214977;if(!_0x3970cc[_0x3b0bae(0x224)]()){let _0x4b5b3b=fs[_0x3b0bae(0x1d1)](_0x11b50d+_0x3970cc[_0x3b0bae(0x109)]);if(_0x28b9da=='backup'){const _0x45c74f=/^bot-[0-9]{3}-config.json$/,_0x21b0a7=_0x45c74f[_0x3b0bae(0x1f8)](_0x3970cc['name']);if(_0x21b0a7){const _0x260f7c=JSON['parse'](_0x4b5b3b);if(_0x260f7c[_0x3b0bae(0x1fa)][0x0]){_0x260f7c[_0x3b0bae(0x1fa)][0x0]['apiKey']=_0x3b0bae(0x22d),_0x260f7c[_0x3b0bae(0x1fa)][0x0]['apiSecret']=_0x3b0bae(0x22d);if(_0x260f7c[_0x3b0bae(0x1fa)][0x0][_0x3b0bae(0x186)])_0x260f7c[_0x3b0bae(0x1fa)][0x0][_0x3b0bae(0x186)]=_0x3b0bae(0x22d);}_0x4b5b3b=JSON[_0x3b0bae(0x26c)](_0x260f7c,null,0x2);}if(_0x3970cc[_0x3b0bae(0x109)]==_0x3b0bae(0x1a1)){const _0x281047=JSON[_0x3b0bae(0x235)](_0x4b5b3b);if(_0x281047[_0x3b0bae(0x23b)][_0x3b0bae(0x21e)])_0x281047['settings'][_0x3b0bae(0x21e)]=![];if(_0x281047['settings'][_0x3b0bae(0x13c)])_0x281047[_0x3b0bae(0x23b)][_0x3b0bae(0x13c)]=_0x3b0bae(0x22d);if(_0x281047['settings'][_0x3b0bae(0xfa)])_0x281047[_0x3b0bae(0x23b)][_0x3b0bae(0xfa)]=_0x3b0bae(0x22d);if(_0x281047['settings'][_0x3b0bae(0x95)])_0x281047[_0x3b0bae(0x23b)]['telegramChatId']=null;_0x4b5b3b=JSON['stringify'](_0x281047,null,0x2);}if(_0x3970cc[_0x3b0bae(0x109)]!=_0x3b0bae(0x23e))_0x39fba7[_0x3b0bae(0x19d)](_0x3970cc[_0x3b0bae(0x109)],_0x4b5b3b);}else _0x39fba7[_0x3b0bae(0x19d)](_0x3970cc[_0x3b0bae(0x109)],_0x4b5b3b);}});const _0x361869=_0x39fba7[_0x214977(0x12a)]({'base64':![],'compression':_0x214977(0x119)});fs[_0x214977(0xff)](zippath+(_0x28b9da+_0x214977(0x14b)),_0x361869,_0x214977(0xcc));}async function unzipFile(_0x1823b9,_0x34758c){const _0x39c66d=_0x5e557c;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x39c66d(0x23a)](_0x2c17c0=>{const _0x5af9c4=_0x39c66d;if(!_0x2c17c0['isDirectory']())fs[_0x5af9c4(0x219)](configpath+_0x2c17c0[_0x5af9c4(0x109)]);});const _0x5039e0=fs[_0x39c66d(0x1d1)](_0x1823b9+_0x34758c,_0x39c66d(0xcc)),_0x44e10c=new require(_0x39c66d(0x1da))(_0x5039e0,{'base64':![],'checkCRC32':!![]});Object[_0x39c66d(0x1a8)](_0x44e10c[_0x39c66d(0x122)])[_0x39c66d(0x23a)](_0x217e78=>{const _0x1b3cd0=_0x39c66d,_0xad3e14=_0x44e10c['files'][_0x217e78];fs[_0x1b3cd0(0xff)](configpath+_0xad3e14[_0x1b3cd0(0x109)],_0xad3e14['_data']);}),fs[_0x39c66d(0x1fd)](temppath,{'withFileTypes':!![]})[_0x39c66d(0x23a)](_0x26fcc9=>{const _0x5a9342=_0x39c66d;if(!_0x26fcc9[_0x5a9342(0x224)]())fs[_0x5a9342(0x219)](temppath+_0x26fcc9['name']);}),logger[_0x39c66d(0xdb)](_0x39c66d(0x11f)),process[_0x39c66d(0x18b)]({'restore':!![]},_0x5990fb=>{});}async function getPublicIp(){const _0x4a839b=_0x5e557c;try{const _0x56b254=await axios[_0x4a839b(0x1f2)](_0x4a839b(0xec));publicip=_0x56b254[_0x4a839b(0x1cf)]['ip'];}catch(_0xb2fc21){}}async function triggerAnalytics(){const _0x50727f=_0x5e557c;if(!publicip)await getPublicIp();const _0x2bce67=getBotsWithMode();let _0x194e21=0x0;_0x2bce67['forEach'](_0x3180b0=>{const _0x48cb5c=_0x3723;if(_0x3180b0['status']===_0x48cb5c(0x137))_0x194e21++;});const _0x3dda7e=getBotExchanges();mixpanel[_0x50727f(0x102)](_0x50727f(0xad),{'distinct_id':settings[_0x50727f(0x24c)],'ip':publicip,'version':serverversion,'numbots':_0x2bce67['length'],'numbotsenabled':_0x194e21,'exchanges':_0x3dda7e});}async function getMessages(){const _0x330dc1=_0x5e557c,_0x47c627=_0x330dc1(0xde),_0x35badc=new GraphQLClient(_0x47c627),_0x2c0a27={'authorization':_0x330dc1(0x195)},_0x42717e=serverversion['split']('.'),_0x3a835b=_0x42717e[0x0]+'.'+_0x42717e[0x1],_0x2de9a3=Math['min'](settings[_0x330dc1(0x1b9)],settings[_0x330dc1(0x217)]),_0x18a9d0={'last':parseInt(_0x2de9a3),'bbm':_0x3a835b},_0x420db6=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5ca8f3;try{_0x5ca8f3=await _0x35badc[_0x330dc1(0x173)](_0x420db6,_0x18a9d0,_0x2c0a27);}catch(_0x24d7f7){}if(_0x5ca8f3&&_0x5ca8f3[_0x330dc1(0x18e)]){let _0x3eb84d=settings[_0x330dc1(0x1b9)];newMessages=[];for(const _0xf89eed of _0x5ca8f3[_0x330dc1(0x18e)]){newMessages[_0x330dc1(0x12d)](_0xf89eed);if(_0xf89eed[_0x330dc1(0x18c)])updateSetting('latestversion',_0xf89eed[_0x330dc1(0x18c)]);let _0x20b302=_0xf89eed[_0x330dc1(0x18c)]?serverversion>=_0xf89eed[_0x330dc1(0x18c)]:![];if(!_0x20b302&&_0xf89eed[_0x330dc1(0x16e)]>_0x3eb84d){if(_0xf89eed[_0x330dc1(0x1ff)]==='any'||serverversion['startsWith'](_0xf89eed[_0x330dc1(0x1ff)])){let _0x3dc1ce=''+_0xf89eed['title']+'\x0a\x0a'+_0xf89eed[_0x330dc1(0xe2)];const _0x60ad38=await sendTelegramMsg(toTelegramMarkdown(_0x3dc1ce),'Markdown');if(_0x60ad38)_0x3eb84d=_0xf89eed[_0x330dc1(0x16e)];}}}updateAvailable=isNewerVersion(settings[_0x330dc1(0x14f)],serverversion),updateSetting(_0x330dc1(0x1b9),_0x3eb84d),emitMessages();}}function emitMessages(){const _0x4d84bc=_0x5e557c,_0x5aad93=settings[_0x4d84bc(0x217)];let _0x1913fb=[];newMessages['forEach'](_0x2a30c0=>{const _0x5a9a7d=_0x4d84bc;_0x2a30c0[_0x5a9a7d(0x16e)]>_0x5aad93&&_0x1913fb[_0x5a9a7d(0x12d)](_0x2a30c0);}),_0x1913fb[_0x4d84bc(0x1f1)]>0x0&&getAllClients()['forEach'](_0x2557db=>{const _0x289d17=_0x4d84bc;getSocket(_0x2557db['id'])[_0x289d17(0x90)](_0x289d17(0xe2),_0x1913fb);});}function confirmMessage(_0x4f0411){const _0x46b36c=_0x5e557c;updateSetting(_0x46b36c(0x217),Number(_0x4f0411));}function isNewerVersion(_0x44ef0a,_0x33c9b9){const _0x595c49=_0x5e557c,_0x12bc92=_0x33c9b9[_0x595c49(0x160)]('.'),_0x4ab6b3=_0x44ef0a['split']('.');for(var _0x4ed4cb=0x0;_0x4ed4cb<_0x4ab6b3['length'];_0x4ed4cb++){const _0x363039=~~_0x4ab6b3[_0x4ed4cb],_0x53c657=~~_0x12bc92[_0x4ed4cb];if(_0x363039>_0x53c657)return!![];if(_0x363039<_0x53c657)return![];}return![];}function toTelegramMarkdown(_0x3c3ce3){const _0x404cfb=_0x5e557c,_0x5665d3=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x20a5f8=/\*{2}(.+?)\*{2}/gim;return _0x3c3ce3=_0x3c3ce3['replace'](_0x5665d3,_0x404cfb(0x112))[_0x404cfb(0x21b)](_0x20a5f8,_0x404cfb(0x1cc)),_0x3c3ce3;}async function validateConfigFile(){const _0x133fc0=_0x5e557c,_0x367485=dbConfig['get'](_0x133fc0(0x16b))['sortBy']('botID')['value']()||[];if(_0x367485[_0x133fc0(0x1f1)]==0x0){let _0x120f6a=0x0,_0x49048d=[];const _0x3b138c=/^bot-([0-9]{3})-config.json$/,_0x5a16ce=fs[_0x133fc0(0x1fd)](configpath);_0x5a16ce[_0x133fc0(0x23a)](_0x262b43=>{const _0x20b1e4=_0x133fc0,_0x483844=_0x3b138c[_0x20b1e4(0xf5)](_0x262b43);if(_0x483844){const _0x53d1f2=_0x483844[0x1];let _0x19bacd=getBotAttributes(_0x53d1f2);_0x49048d[_0x20b1e4(0x12d)]({'botID':_0x53d1f2,'botname':_0x19bacd[_0x20b1e4(0xf1)],'status':_0x20b1e4(0x15b),'live':'stopped'}),_0x120f6a++;}}),_0x120f6a!=0x0&&(dbConfig[_0x133fc0(0x1f2)](_0x133fc0(0x16b))['assign'](_0x49048d)[_0x133fc0(0x191)](),config=_0x49048d,restoredConfigFile=_0x120f6a);}}async function restoreConfigNotify(_0x49dcfa){const _0xdc4b93=_0x5e557c;let _0x4bb8fa;if(restoredConfigFile==0x1)_0x4bb8fa=_0xdc4b93(0x1e7);else _0x4bb8fa=_0xdc4b93(0x25c);if(_0x49dcfa)io['to']('botmanager')[_0xdc4b93(0x90)](_0xdc4b93(0x21a),_0x4bb8fa);else{logger[_0xdc4b93(0x108)](_0xdc4b93(0x1ca)),logger['simple'](_0x4bb8fa),logger['simple'](_0xdc4b93(0x1ca)),logger[_0xdc4b93(0x108)]('');if(tgBot&&settings[_0xdc4b93(0x95)]&&settings[_0xdc4b93(0x258)]!=_0xdc4b93(0x250))tgBot[_0xdc4b93(0xfb)](settings[_0xdc4b93(0x95)],'Bot\x20Mgr\x20>\x20'+_0x4bb8fa)[_0xdc4b93(0x1c7)](_0x4fa6cf=>{telegramError(_0x4fa6cf);});}}function validateCredentials(_0x9736d0,_0x57e87b){const _0x30aff7=_0x5e557c;if(_0x9736d0[_0x30aff7(0x1c2)]==settings[_0x30aff7(0x227)]&&bcrypt[_0x30aff7(0x1cb)](_0x9736d0[_0x30aff7(0x202)],settings[_0x30aff7(0x13c)])){if(settings[_0x30aff7(0x234)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4a5419=generateLoginToken(_0x57e87b);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4a5419};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x188867){const _0x3a1db2=_0x5e557c,_0x577486=generateLoginToken(_0x188867);return{'allow':!![],'reason':_0x3a1db2(0x172),'token':_0x577486};}function validateAccess(_0x247db6,_0x15b77e,_0x5e2ffb){const _0x2be9e2=_0x5e557c,_0x55e2f7=_0x5e2ffb?_0x5e2ffb:devices[_0x15b77e]['ip'];let _0x19343e;const _0xfc5452=_0x313c4f=>{const _0x1bc8ee=_0x3723;if(settings[_0x1bc8ee(0x21e)]){if(settings[_0x1bc8ee(0x234)]){if(telegram2FaApproved(_0x15b77e)){const _0x52aa74=generateLoginToken(_0x15b77e);return{'allow':!![],'reason':_0x1bc8ee(0x22e),'token':_0x52aa74};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x19343e=validToken(_0x313c4f,_0x15b77e),_0x19343e[_0x1bc8ee(0x216)](_0x1bc8ee(0x1ac))?{'allow':!![],'reason':_0x1bc8ee(0x228),'token':_0x313c4f}:{'allow':![],'reason':_0x1bc8ee(0x22f),'token':null};}else return{'allow':!![],'reason':_0x1bc8ee(0x1a5),'token':null};};if(settings['whitelistEnabled']){let _0x2c57ae=[...settings['whitelist'],_0x2be9e2(0x17c),_0x2be9e2(0x1eb),_0x2be9e2(0x8e)];if(_0x2c57ae['includes'](_0x55e2f7))return _0xfc5452(_0x247db6);else{_0x19343e=validToken(_0x247db6,_0x15b77e);if(_0x19343e['hasOwnProperty']('success'))return _0xfc5452(_0x247db6);else{if(telegramIpApproved(_0x15b77e)){const _0x327072=generateToken(_0x15b77e);return _0x19343e=_0xfc5452(_0x247db6),_0x19343e['allow']?{'allow':!![],'reason':_0x2be9e2(0xa5),'token':_0x327072}:_0x19343e;}else return settings[_0x2be9e2(0x1f4)]?{'allow':![],'reason':_0x2be9e2(0x9e),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0xfc5452(_0x247db6);}function timelyDecrypt(_0xfeb9ad,_0x9f50bc=!![]){const _0x5ab2be=_0x5e557c;if(_0xfeb9ad)try{const _0x540101=crypt[_0x5ab2be(0x209)](secure[_0x5ab2be(0x244)],_0xfeb9ad)[_0x5ab2be(0xe2)],_0x52de0c=_0x540101['split']('@')[0x0],_0x100aaa=_0x540101['split']('@')[0x1],_0xb7f37=new Date()[_0x5ab2be(0x255)]();if(_0x9f50bc){if(_0xb7f37-_0x100aaa<maxSecretAge*0x3e8)return _0x52de0c;else return![];}else return _0x52de0c;}catch(_0x3aaf3f){return![];}else return![];}const validToken=(_0x588ccd,_0x1d3d3e)=>{const _0x183a07=_0x5e557c,_0x6e5797=devices[_0x1d3d3e]['ip'];if(!_0x588ccd)return{'error':_0x183a07(0x22a)};for(let _0x35800d of blacklist){if(_0x35800d['token']==_0x588ccd)return{'error':_0x183a07(0x150)};}let _0x2e34f5;try{_0x2e34f5=jwt[_0x183a07(0x10a)](_0x588ccd,secure[_0x183a07(0xa9)]+_0x1d3d3e);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x2e34f5[_0x183a07(0x216)](_0x183a07(0x232))&&!_0x2e34f5['hasOwnProperty'](_0x183a07(0x1c2))||!_0x2e34f5[_0x183a07(0x216)](_0x183a07(0xa1)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x2e34f5['hasOwnProperty'](_0x183a07(0x1c2))&&_0x2e34f5[_0x183a07(0x216)](_0x183a07(0x232))){const {clientip:_0x5d59ef}=_0x2e34f5;return _0x6e5797==_0x5d59ef?{'success':_0x183a07(0x1bc)}:{'error':_0x183a07(0x1db)};}else{if(_0x2e34f5[_0x183a07(0x216)](_0x183a07(0x1c2))&&_0x2e34f5['hasOwnProperty']('clientip')){const {username:_0x3957fe,clientip:_0x247bc8}=_0x2e34f5;return settings['bbUsername']==_0x3957fe&&_0x6e5797==_0x247bc8?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x58b82e=>{const _0x4459ae=_0x5e557c;if(_0x58b82e){const _0x5d6f15=devices[_0x58b82e]['ip'];return jwt[_0x4459ae(0x143)]({'username':settings[_0x4459ae(0x227)],'clientip':_0x5d6f15},secure[_0x4459ae(0xa9)]+_0x58b82e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x11cf5d=>{const _0x294336=_0x5e557c;if(_0x11cf5d){const _0x23e0f4=devices[_0x11cf5d]['ip'];return jwt[_0x294336(0x143)]({'clientip':_0x23e0f4},secure['secret']+_0x11cf5d,{'expiresIn':devices[_0x11cf5d][_0x294336(0x11b)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x494594=>{const _0x160275=_0x5e557c;let _0x3565a6=![];return devices[_0x494594][_0x160275(0x11b)]&&devices[_0x494594][_0x160275(0x11b)][_0x160275(0x93)]!=_0x160275(0xf0)&&(_0x3565a6=devices[_0x494594][_0x160275(0x11b)][_0x160275(0x232)]==devices[_0x494594]['ip']&&new Date()[_0x160275(0x255)]()-devices[_0x494594][_0x160275(0x11b)][_0x160275(0xa7)]<devices[_0x494594]['telegramIpApproval'][_0x160275(0x93)]*0x3c*0x3e8),_0x3565a6;},telegram2FaApproved=_0x215d84=>{const _0x495bfb=_0x5e557c;let _0x1ae1e0=![];return devices[_0x215d84][_0x495bfb(0xc4)]&&devices[_0x215d84][_0x495bfb(0xc4)][_0x495bfb(0x93)]!=_0x495bfb(0xf0)&&(_0x1ae1e0=devices[_0x215d84][_0x495bfb(0xc4)]['clientip']==devices[_0x215d84]['ip']&&new Date()['getTime']()-devices[_0x215d84][_0x495bfb(0xc4)][_0x495bfb(0xa7)]<devices[_0x215d84][_0x495bfb(0xc4)][_0x495bfb(0x93)]*0x3c*0x3e8),_0x1ae1e0;},normalizeIP=_0x400add=>{const _0x456093=_0x5e557c;let _0x334cfb=null,_0x10bb6f=null;if(ipaddr[_0x456093(0x177)](_0x400add)){const _0x42a7fc=ipaddr[_0x456093(0x235)](_0x400add);_0x42a7fc[_0x456093(0x233)]()==='ipv6'?(_0x42a7fc[_0x456093(0x1f3)]()&&(_0x334cfb=_0x42a7fc[_0x456093(0x1af)]()[_0x456093(0xc7)]()),_0x10bb6f=_0x42a7fc[_0x456093(0xc7)]()):(_0x334cfb=_0x42a7fc[_0x456093(0xc7)](),_0x10bb6f=_0x42a7fc['toIPv4MappedAddress']()[_0x456093(0xc7)]());}return{'show':_0x334cfb?_0x334cfb:_0x10bb6f,'store':_0x10bb6f};};function formatDate(_0x47e961){const _0x1a8dbd=_0x5e557c;return _0x47e961['getFullYear']()+'/'+(_0x47e961[_0x1a8dbd(0x1a0)]()+0x1)[_0x1a8dbd(0xc7)]()[_0x1a8dbd(0x269)](0x2,'0')+'/'+_0x47e961['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x47e961[_0x1a8dbd(0x96)]()[_0x1a8dbd(0xc7)]()[_0x1a8dbd(0x269)](0x2,'0')+':'+_0x47e961[_0x1a8dbd(0x221)]()[_0x1a8dbd(0xc7)]()['padStart'](0x2,'0')+':'+_0x47e961[_0x1a8dbd(0x121)]()['toString']()[_0x1a8dbd(0x269)](0x2,'0');}function sleep(_0x417595){return new Promise(_0x584160=>setTimeout(_0x584160,_0x417595));}