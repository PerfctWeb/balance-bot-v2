const _0x38a6a5=_0x3515;(function(_0x1d657a,_0x37ef77){const _0x484f9b=_0x3515,_0x24f7e0=_0x1d657a();while(!![]){try{const _0x8577a5=parseInt(_0x484f9b(0x1b3))/0x1+-parseInt(_0x484f9b(0x258))/0x2+-parseInt(_0x484f9b(0x10e))/0x3*(-parseInt(_0x484f9b(0x2ba))/0x4)+-parseInt(_0x484f9b(0x2a6))/0x5*(parseInt(_0x484f9b(0x204))/0x6)+parseInt(_0x484f9b(0x28c))/0x7*(parseInt(_0x484f9b(0x2c0))/0x8)+-parseInt(_0x484f9b(0x2dc))/0x9+-parseInt(_0x484f9b(0x261))/0xa;if(_0x8577a5===_0x37ef77)break;else _0x24f7e0['push'](_0x24f7e0['shift']());}catch(_0x4eaa87){_0x24f7e0['push'](_0x24f7e0['shift']());}}}(_0x4b82,0xc1796));const _0x1f5694=function(){let _0x3124c4=!![];return function(_0x564a02,_0x4c9a82){const _0xeb7743=_0x3124c4?function(){if(_0x4c9a82){const _0x39ac27=_0x4c9a82['apply'](_0x564a02,arguments);return _0x4c9a82=null,_0x39ac27;}}:function(){};return _0x3124c4=![],_0xeb7743;};}(),_0x454a53=_0x1f5694(this,function(){const _0x1a9298=_0x3515;return _0x454a53[_0x1a9298(0x1b0)]()[_0x1a9298(0x283)]('(((.+)+)+)+$')['toString']()[_0x1a9298(0x2a1)](_0x454a53)[_0x1a9298(0x283)](_0x1a9298(0x212));});_0x454a53();'use strict';process[_0x38a6a5(0x2bf)][_0x38a6a5(0x1f9)]=0x1;const childProcess=require(_0x38a6a5(0x1ea)),fs=require('fs'),fns=require(_0x38a6a5(0x1e4)),low=require('lowdb'),FileSync=require(_0x38a6a5(0x2c9)),path=require('path'),crypto=require(_0x38a6a5(0x23b)),Crypt=require(_0x38a6a5(0x2e8))[_0x38a6a5(0x1bb)],RSA=require(_0x38a6a5(0x2e8))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x38a6a5(0x2f7)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x38a6a5(0x187)][_0x38a6a5(0x249)](0x2))[_0x38a6a5(0x187)],uuidRandom=require(_0x38a6a5(0x182)),{Telegraf,Markup}=require(_0x38a6a5(0x181)),Mixpanel=require(_0x38a6a5(0x25f)),axios=require(_0x38a6a5(0x233)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x38a6a5(0x1eb)),fileUpload=require(_0x38a6a5(0x168)),{networkInterfaces}=require('os'),PORT=argv[_0x38a6a5(0x221)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x38a6a5(0x157)](PORT)&&(console[_0x38a6a5(0x15d)](_0x38a6a5(0x242)+PORT+_0x38a6a5(0x292)),process[_0x38a6a5(0x239)](0x1));const HOST=argv[_0x38a6a5(0x231)]||null,userID=argv[_0x38a6a5(0x1cf)]||'',debugging=argv['d']||![],nodeversion=process[_0x38a6a5(0x27c)][_0x38a6a5(0x271)];let bbpath=_0x38a6a5(0x18e),bbpath2='';const botfile=_0x38a6a5(0x2b7),configfile=_0x38a6a5(0x19b),settingsfile=_0x38a6a5(0x1ef),securefile=_0x38a6a5(0x1e0),environment=require('./'+bbpath2+_0x38a6a5(0x2f3))[_0x38a6a5(0x27a)]||_0x38a6a5(0x15a),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x38a6a5(0x273)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x38a6a5(0x136)+userID+'/':bbpath+_0x38a6a5(0x136),configbackuppath=configpath+_0x38a6a5(0x154),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x38a6a5(0x1a9),zippath=userID?bbpath+_0x38a6a5(0x12b)+userID+'/':bbpath+_0x38a6a5(0x12b),loggerfile=fs[_0x38a6a5(0x1fe)](logspath+_0x38a6a5(0x1d0),{'flags':'a'}),temppath=userID?bbpath+_0x38a6a5(0x205)+userID+'/':bbpath+_0x38a6a5(0x205);!fs[_0x38a6a5(0x273)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x38a6a5(0x273)](configbackuppath)&&fs[_0x38a6a5(0x2a0)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x38a6a5(0x2a0)](logspath);!fs['existsSync'](zippath)&&fs[_0x38a6a5(0x2a0)](zippath);!fs[_0x38a6a5(0x273)](temppath)&&fs[_0x38a6a5(0x2a0)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x38a6a5(0x1ca)]({'bots':[]})[_0x38a6a5(0x142)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x38a6a5(0x1ca)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x38a6a5(0x178),'onepagemode':![],'marketcapApi':''}})[_0x38a6a5(0x142)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x38a6a5(0x1ca)]({'secure':{},'blacklist':[]})[_0x38a6a5(0x142)]();let crypt=new Crypt({'md':_0x38a6a5(0x2ce),'rsaStandard':_0x38a6a5(0x108)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x38a6a5(0x1af),{'host':_0x38a6a5(0x1cc)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x38a6a5(0x10f)]&&(settings[_0x38a6a5(0x10f)]!=''&&settings['telegramToken']!='***')&&settings[_0x38a6a5(0x2b3)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x2ecdef,_0x1726f5)=>{const _0x59be7c=_0x38a6a5,_0x346710=/#[A-Z]{3}#/g;if(typeof _0x2ecdef==_0x59be7c(0x11c)){!_0x1726f5?_0x2ecdef=_0x2ecdef['replace'](_0x346710,''):(_0x2ecdef=_0x2ecdef[_0x59be7c(0x228)](/#BLU#/g,'\x1b[34m'),_0x2ecdef=_0x2ecdef[_0x59be7c(0x228)](/#RED#/g,_0x59be7c(0x218)),_0x2ecdef=_0x2ecdef['replace'](/#YEL#/g,'\x1b[33m'),_0x2ecdef=_0x2ecdef[_0x59be7c(0x228)](/#MAG#/g,'\x1b[35m'),_0x2ecdef=_0x2ecdef[_0x59be7c(0x228)](/#CYA#/g,_0x59be7c(0x269)),_0x2ecdef=_0x2ecdef[_0x59be7c(0x228)](/#RES#/g,_0x59be7c(0x170)));;}return _0x2ecdef;},logger={'screen':_0x3add9b=>{const _0x394670=_0x38a6a5;console[_0x394670(0x15d)](parseColor(_0x3add9b,!![]));},'simple':_0x4c4a53=>{const _0x30cc5b=_0x38a6a5;console[_0x30cc5b(0x15d)](parseColor(_0x4c4a53,!![])),loggerfile['write'](util['format'](parseColor(_0x4c4a53,![]))+'\x0a');},'full':async _0x2ae55c=>{const _0x47ec68=_0x38a6a5,_0x45d9dd=getTimeStamp()+_0x47ec68(0x302)+_0x2ae55c;console['log'](parseColor(_0x45d9dd,!![])),loggerfile[_0x47ec68(0x142)](util[_0x47ec68(0x298)](parseColor(_0x45d9dd,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x47ec68(0x304)],_0x47ec68(0x12e)+parseColor(_0x2ae55c,![]));},'debug':async(_0x1c7d07,_0x45084b='')=>{const _0x335143=_0x38a6a5,_0x557b6b=getTimeStamp()+_0x335143(0x202)+_0x1c7d07;if(debugging)console[_0x335143(0x15d)](parseColor(_0x557b6b,!![]));loggerfile[_0x335143(0x142)](util[_0x335143(0x298)](parseColor(_0x557b6b,![]))+'\x0a');if(_0x45084b){if(debugging)console[_0x335143(0x15d)](_0x45084b);loggerfile['write'](util['format'](_0x45084b)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x1e4b51){const _0x5a50b8=_0x38a6a5;_0x1e4b51['toString']()[_0x5a50b8(0x284)](_0x5a50b8(0x2e6))?(logger[_0x5a50b8(0x180)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x1e4b51[_0x5a50b8(0x221)]+_0x5a50b8(0x144)),process[_0x5a50b8(0x14f)]({'terminate':!![]},_0x38c839=>{})):logger[_0x5a50b8(0x180)](_0x1e4b51);}),process['on'](_0x38a6a5(0x239),()=>{const _0x49035a=_0x38a6a5;stopAllBots(),process[_0x49035a(0x239)](0x0);}),process['on'](_0x38a6a5(0x2b0),()=>{const _0xcf03ac=_0x38a6a5;stopAllBots(),process[_0xcf03ac(0x239)](0x0);}),process['on'](_0x38a6a5(0x131),()=>{const _0x1edb29=_0x38a6a5;stopAllBots(),process[_0x1edb29(0x239)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x38a6a5(0x19c)),app=express(),http=require(_0x38a6a5(0x23a))[_0x38a6a5(0x134)](app);app[_0x38a6a5(0x297)](fileUpload({'useTempFiles':!![]})),app[_0x38a6a5(0x217)](_0x38a6a5(0x1f7),async(_0x55a09a,_0x36cab0)=>{const _0x178780=_0x38a6a5,_0x1d7eeb=_0x55a09a[_0x178780(0x24a)][_0x178780(0x22b)],_0x2e6533=getClientsWithBotID('botmanager'),_0x3eddf4=_0x55a09a['headers']['uuid'],_0x2d695e=timelyDecrypt(_0x3eddf4,![]),_0x3189ad=_0x2e6533[_0x178780(0x1c5)](_0x429b93=>_0x429b93[_0x178780(0x1fa)]==_0x2d695e);if(_0x3189ad){const _0x32b979=normalizeIP(_0x55a09a[_0x178780(0x16b)]['remoteAddress'])[_0x178780(0x2ff)],_0x1e5df5=_0x55a09a[_0x178780(0x1b4)][_0x178780(0x1b7)];if(validateAccess(_0x1e5df5,_0x2d695e,_0x32b979)[_0x178780(0x2e0)])_0x1d7eeb==_0x178780(0x2f5)&&await backupConfigFiles(),await zipFiles(_0x1d7eeb),_0x36cab0['download'](zippath+(_0x1d7eeb+_0x178780(0x1fc)),_0x2fd315=>{const _0x47d774=_0x178780;_0x2fd315&&(logger[_0x47d774(0x26b)]('Failed\x20to\x20download\x20'+_0x1d7eeb),logger['simple'](_0x2fd315));});else logger[_0x178780(0x26b)](_0x178780(0x192)+_0x1d7eeb+_0x178780(0x120));}else logger[_0x178780(0x26b)](_0x178780(0x192)+_0x1d7eeb+_0x178780(0x1ee));}),app[_0x38a6a5(0x2eb)]('/upload-backup',async(_0x5425e9,_0x1785c7)=>{const _0x22e2ec=_0x38a6a5,_0x17e26f=getClientsWithBotID(_0x22e2ec(0x2a8)),_0x299e87=_0x5425e9[_0x22e2ec(0x1b4)][_0x22e2ec(0x1fa)],_0x3e0966=timelyDecrypt(_0x299e87,![]),_0x2e3ee6=_0x17e26f[_0x22e2ec(0x1c5)](_0x50e85e=>_0x50e85e[_0x22e2ec(0x1fa)]==_0x3e0966);logger[_0x22e2ec(0x18f)](_0x22e2ec(0x16d));if(_0x2e3ee6){const _0xfe125f=normalizeIP(_0x5425e9['socket']['remoteAddress'])[_0x22e2ec(0x2ff)],_0xc77e58=_0x5425e9[_0x22e2ec(0x1b4)][_0x22e2ec(0x1b7)];if(validateAccess(_0xc77e58,_0x3e0966,_0xfe125f)['allow']){if(_0x5425e9[_0x22e2ec(0x21e)]){const _0x304a66=_0x5425e9['files'][_0x22e2ec(0x2b5)];await _0x304a66['mv'](temppath+_0x304a66[_0x22e2ec(0x281)]),_0x1785c7[_0x22e2ec(0x14f)]({'status':!![],'message':_0x22e2ec(0x135)});const _0x1aa519=getBotsWithMode();_0x1aa519['length']>0x0?confirmRestore(temppath,_0x304a66[_0x22e2ec(0x281)]):unzipFile(temppath,_0x304a66[_0x22e2ec(0x281)]);}}else logger[_0x22e2ec(0x26b)](_0x22e2ec(0x2cd));}else logger[_0x22e2ec(0x26b)](_0x22e2ec(0x1c7));}),app[_0x38a6a5(0x297)](express[_0x38a6a5(0x22f)](path[_0x38a6a5(0x14a)](__dirname,bbpath2,_0x38a6a5(0x160)))),app[_0x38a6a5(0x297)](express[_0x38a6a5(0x22f)](path[_0x38a6a5(0x14a)](__dirname,bbpath2,_0x38a6a5(0x112)))),app['get']('/',function(_0x48a561,_0x2c3fb0){const _0x1223d3=_0x38a6a5;_0x2c3fb0['sendFile'](path[_0x1223d3(0x14a)](__dirname,bbpath2,_0x1223d3(0x160),_0x1223d3(0x287)));}),app[_0x38a6a5(0x217)]('/:bot',function(_0x4c39e4,_0x533f22){const _0x21f606=_0x38a6a5;_0x533f22[_0x21f606(0x1d3)](path[_0x21f606(0x14a)](__dirname,bbpath2,_0x21f606(0x112),_0x21f606(0x287)));}),app[_0x38a6a5(0x217)]('/:bot/portfolio',(_0x571c9c,_0x230669)=>{const _0x193993=_0x38a6a5;_0x230669[_0x193993(0x1d3)](path[_0x193993(0x14a)](__dirname,bbpath2,_0x193993(0x112),_0x193993(0x287)));}),app[_0x38a6a5(0x217)](_0x38a6a5(0x28b),(_0x556f99,_0x118e0c)=>{const _0x1626e4=_0x38a6a5;_0x118e0c[_0x1626e4(0x1d3)](path[_0x1626e4(0x14a)](__dirname,bbpath2,_0x1626e4(0x112),_0x1626e4(0x287)));}),app[_0x38a6a5(0x217)](_0x38a6a5(0x1fd),(_0x50e9b9,_0x332731)=>{const _0x48e61e=_0x38a6a5;_0x332731['sendFile'](path[_0x48e61e(0x14a)](__dirname,bbpath2,_0x48e61e(0x112),_0x48e61e(0x287)));}),app[_0x38a6a5(0x217)](_0x38a6a5(0x1a6),(_0x4af5f0,_0x4c5ee1)=>{const _0x12b048=_0x38a6a5;_0x4c5ee1['sendFile'](path['join'](__dirname,bbpath2,_0x12b048(0x112),'index.html'));}),app[_0x38a6a5(0x217)](_0x38a6a5(0x213),(_0x4bc3e7,_0x40b30b)=>{const _0x1adc5f=_0x38a6a5;_0x40b30b['sendFile'](path[_0x1adc5f(0x14a)](__dirname,bbpath2,_0x1adc5f(0x112),_0x1adc5f(0x287)));}),app['get'](_0x38a6a5(0x235),(_0x1b0d86,_0x177cdc)=>{const _0x2930b2=_0x38a6a5;_0x177cdc[_0x2930b2(0x1d3)](path[_0x2930b2(0x14a)](__dirname,bbpath2,_0x2930b2(0x112),_0x2930b2(0x287)));});function _0x4b82(){const _0x107974=['logs/','conn','order','<b>Telegram\x20Bot\x20Status:</b>\x0a','login\x20token\x20valid','Unauthorized\x20attempt\x20to\x20show\x20configuration','6b67f3d61ee94b8f5c80b4affef4c4d9','toString','max','Your\x20installation\x20is\x20already\x20up\x20to\x20date','1535095CjoibL','headers','reinstall','***','tkn','access\x20timeout','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Password\x20reset\x20rejected','Crypt','Unauthorized\x20attempt\x20to\x20update\x20bot','Restore\x20backup\x20file\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','privateKey','all','onepagemode','running','reload','\x20only\x0a','find','botID','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Setting\x20access:\x20','telegramIpApproval','defaults','resetHistory','api-eu.mixpanel.com','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','user','/output-000.log','alerts','telegrammsg','sendFile','live','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','new','_data','reply','mode','You\x20can\x20use\x20the\x20following\x20commands:\x0a','secure','config_orders','publicKey','Invalid\x20IP\x20address','(staging)','bb-secure.json','Enabled\x20Bot\x20','clientip','No\x20bots\x20running\x20right\x20now','date-fns','reinstall_no','getTime','any',')\x20|\x20Bot\x20','hashSync','child_process','util','storeHeadless','Unauthorized\x20attempt\x20to\x20store\x20configuration','\x20(2)','bb-settings.json','tempaccess_30_','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','getHours','Unauthorized\x20attempt\x20to\x20get\x20messages','portfolio_','disabled','/download/:type','Restoring\x20bot(s)\x20from\x20backup','NTBA_FIX_319','uuid','message','.zip','/:bot/coins','createWriteStream','Bot\x20','temporary\x20access\x20rejected','exp',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','bot-','594zdDvzP','temp/','copyFileSync','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','binary','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','getPortfolio','split','status','inherit','Notifications\x20disabled\x0a','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','telegram2FaApproval','number','(((.+)+)+)+$','/:bot/configuration','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','getMinutes','secret','get','\x1b[31m','loginRequired','internal','store-fiat','endsWith','output-003.log','files','size','messages','port','Error\x20details:','min','/enable\x20-\x20enable\x20notifications\x0a','config_alerts','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','inlineKeyboard','replace','marketcapApi','telegram','type','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','range','restore_no_','static','Access\x20enabled\x20for\x20','host','tempaccess_15_','axios','output-001.log','/:bot/support','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Network\x20Interfaces:','sign','exit','http','crypto','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20confirm\x20message','exchange','storeConfiguration','lastmsgtelegram','tempaccess_5_','Error:\x20Invalid\x20argument\x20','botname','unlinkSync','storeFiat','-events.json','cancelLoading','logout','slice','params','disconnect','lastmsgemitted','2FA\x20login\x20token\x20generated','toggle_','f2aRequired','parse','forEach','isDirectory','Ok,\x20will\x20send\x20alert\x20notifications\x20only','bbvNew','temporary\x20access\x20not\x20allowed','timeshift','stringify','1730522IpwnEp','startsWith','login\x20token\x20generated','store-settings','/status\x20-\x20show\x20bot(s)\x20status\x0a','toggle','reset-history','mixpanel','event','11560350SOLPgM','catch','IPv4','add-bot','delete-alerts','temporary\x20token\x20generated','bbPassword','filter','\x1b[36m','telegramEvents','full','DEFLATE','Invalid\x20authentication\x20token\x20(2)','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Markdown','reason','node','Logged\x20in\x20user\x20...','existsSync','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','statSync','/disable\x20-\x20disable\x20notifications\x0a','$1_$2_$3','update','then','environment','button','versions','orders','temporaryAccessAllowed','timestamp','removeAllListeners','name','decrypt','search','includes','accept','Error\x20removing\x20old\x20backup\x20files:','index.html','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','stopped','pidExpireLogin','/:bot/performance','60921krytPf','placeOrder','#RES#\x20if\x20running\x20on\x20server','token','enabled','pidRefreshToken',',\x20must\x20be\x20a\x204\x20digit\x20number','Logged\x20out\x20user\x20...','Starting\x20(','function','sendMetricsTelegram','use','format','apiKey','-config.json','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','set','/restart\x20-\x20restart\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','mkdirSync','constructor','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','reinstall-bb','\x20>\x20','backup-files','8495jhLKLo','getFullYear','botmanager','Alerts','|@|','show-config','All\x20bots','store-headless','login2fa_','\x20mode','SIGTERM','off_','kill','telegramUsername','Starting\x20#RED#Balance\x20Bot\x20v','backupfile','showConfig','bot.js','Invalid\x20authentication\x20token\x20(1)','verify','5284QiDmTQ','rmSync','success','access','close','env','1376LkIJNN','blacklist','node-zip','update_yes','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','getDate','bots','output-000.log','new-disabled','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','settings.','userid','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','sha256','auto','from','2FA\x20login\x20required','cancel-loading','disable','#RES#\x20if\x20running\x20locally\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','settings','yes','config_all','30\x20min','hasOwnProperty','bbUsername','3386979gEEqxb','bot','file','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','allow','callback','headless','[ip-address]','Allow\x20login\x20from\x20IP\x20address\x20','2FA\x20login\x20rejected','address\x20already\x20in\x20use','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','hybrid-crypto-js','once','Unauthorized\x20attempt\x20to\x20delete\x20alerts','post','User\x20has\x20been\x20validated','referer','Notifications\x20types:\x20','get-logs','getMonth','exec','server','version.json','HTML','backup','randomFillSync','jsonwebtoken','\x20to\x20','handshake','restart','telegramEnabled','data','value','login','store','-----------------------------------------------------------------------------------','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',':\x20Bot\x20Mgr\x20>\x20','compareSync','telegramChatId','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','backup-full','deleteHistoryAlerts','length','get-messages','sendMessage','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20get\x20events','remoteAddress','Server','RSA-OAEP','track','output-002.log','Node.js\x20v','readFileSync','resetpw_yes','741VrbMuD','telegramToken','Unauthorized\x20login\x20attempt\x20(timeout)','portfolio','build','launch','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/off\x20-\x20stop\x20bot(s)\x0a','Notifications\x20disabled','/help\x20-\x20show\x20available\x20commands\x0a','manual','CoinMarketCap\x20API\x20key\x20validated','metrics_','Temporary\x20access\x20rejected','string','error','bbvReceive','map','\x20(1)','sortBy','password','fork','status\x20code\x20401','address','stop','chat','title','keys','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','zip/','get-backup-files','show','Bot\x20Mgr\x20>\x20','sendPortfolioTelegram','Yes','SIGINT','sockets','\x20-\x20','createServer','File\x20uploaded','config/','args','Starting\x20new\x20bot\x20|\x20Bot\x20','toggle-bot-mode','2FA','ipc','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','username','Unauthorized\x20attempt\x20to\x20update\x20settings','5\x20min','::ffff:127.0.0.1','mtime','write','Notifications\x20enabled\x0a','#RES#','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','entries','login2fa_reject_','alias','join','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','listen','notification','update-bot','send','\x20minutes','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','All\x20bots\x20running\x20right\x20now','Backup\x20file\x20unzipped\x20and\x20stored','backup/','Session\x20expired\x20for\x20user\x20...','private','test','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','/names\x20-\x20show\x20bot\x20names\x0a','production','editMessageReplyMarkup','invalid\x20credentials','log','warning','Unauthorized\x20attempt\x20to\x20log\x20out','build2','padStart','reinstall_yes','sort','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','************','Starting\x20Balance\x20Bot\x20update','match','express-fileupload','family','expiry','socket','Unauthorized\x20attempt\x20to\x20delete\x20bot','Backup\x20file\x20uploaded','<b>Balance\x20Bot\x20Status:</b>\x0a','cloneDeep','\x1b[0m','Starting\x20Balance\x20Bot\x20reinstallation','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','push','-performance.json','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','readdirSync','reject','0.0.0','ipv6','All','Unauthorized\x20attempt\x20to\x20add\x20bot','remove','started','assign','action','simple','telegraf','uuid-random','ETH','login\x20not\x20required','emit','-results.json','argv','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','backup-full@','restore-backup-file','=>\x20Go\x20to\x20#CYA#http://','latestversion','randomBytes','bb/','debug','Token\x20blacklisted','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Unauthorized\x20attempt\x20to\x20download\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','::1','writeFileSync','add','#RES#\x20',')\x20\x20\x20|\x20Bot\x20','2FA\x20required','tempaccess_reject_','bb-config.json','express','confirm-message','emitHistory','Restore\x20process\x20confirmed','\x20|\x20','command','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','toIPv4Address','logged\x20out','getSeconds','/:bot/history','enable','apiPassword'];_0x4b82=function(){return _0x107974;};return _0x4b82();}if(HOST)http[_0x38a6a5(0x14c)](PORT,HOST);else http[_0x38a6a5(0x14c)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x11627d=_0x38a6a5;let _0x3cc4b5=_0x11627d(0x2e3);const _0x405a1d=networkInterfaces(),_0x6636ad={};for(const _0x27e221 of Object[_0x11627d(0x129)](_0x405a1d)){for(const _0x370791 of _0x405a1d[_0x27e221]){if((_0x370791['family']==_0x11627d(0x263)||_0x370791[_0x11627d(0x169)]==0x4)&&!_0x370791[_0x11627d(0x21a)]){const _0x4e6c2e=ipaddr[_0x11627d(0x250)](_0x370791[_0x11627d(0x125)])[_0x11627d(0x22d)]();_0x4e6c2e!=_0x11627d(0x156)&&(!_0x6636ad[_0x27e221]&&(_0x6636ad[_0x27e221]=[]),_0x6636ad[_0x27e221][_0x11627d(0x173)](_0x370791['address']),_0x3cc4b5=_0x370791['address']);}}}return{'serverip':_0x3cc4b5,'netinterfaces':_0x6636ad};}async function startServer(){const _0x2d4344=_0x38a6a5,{serverip:_0x3f1eed,netinterfaces:_0x2875ac}=getServerIP();logger[_0x2d4344(0x180)](''),logger['simple'](_0x2d4344(0x300)),await logger[_0x2d4344(0x26b)](_0x2d4344(0x2b4)+serverversion+_0x2d4344(0x197)+(environment=='staging'?_0x2d4344(0x1df):'')+'\x0a'+(_0x2d4344(0x188)+PORT+_0x2d4344(0x2d4))+(_0x2d4344(0x18b)+_0x3f1eed+':'+PORT+_0x2d4344(0x28e))),logger['simple'](_0x2d4344(0x300));if(config[_0x2d4344(0x101)]!=0x0)for(const _0x5c66ef of config){const _0x401e83=_0x5c66ef[_0x2d4344(0x1d9)]==_0x2d4344(0x2cf)?'a':'m';if(_0x5c66ef[_0x2d4344(0x20c)]=='enabled'||_0x5c66ef[_0x2d4344(0x20c)]==_0x2d4344(0x1d6))await logger[_0x2d4344(0x26b)](_0x2d4344(0x294)+_0x401e83+_0x2d4344(0x1e8)+_0x5c66ef[_0x2d4344(0x1c6)]+_0x2d4344(0x1a0)+_0x5c66ef[_0x2d4344(0x243)]),startBot([_0x5c66ef['botID'],userID],{'cwd':bbpath},function(_0x237fc4){if(_0x237fc4)logger['full'](_0x237fc4);});else(_0x5c66ef[_0x2d4344(0x20c)]==_0x2d4344(0x1f6)||_0x5c66ef[_0x2d4344(0x20c)]==_0x2d4344(0x2c8))&&await logger[_0x2d4344(0x26b)]('Idling\x20('+_0x401e83+_0x2d4344(0x198)+_0x5c66ef[_0x2d4344(0x1c6)]+_0x2d4344(0x1a0)+_0x5c66ef[_0x2d4344(0x243)]);}else!newBot&&logger[_0x2d4344(0x180)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x2d4344(0x180)](''),await logger[_0x2d4344(0x18f)](_0x2d4344(0x10b)+nodeversion),await logger[_0x2d4344(0x18f)](_0x2d4344(0x237),_0x2875ac);}function startSocket(){io['on']('connection',_0x2a0412=>{const _0x55031e=_0x3515;let _0x3590d8,_0x293af5,_0x33f4db,_0x2b7b6b,_0x10bf3e;const _0x5afba1=_0x2a0412['handshake'][_0x55031e(0x1b4)][_0x55031e(0x2ed)];_0x293af5=_0x5afba1[_0x55031e(0x167)](/bot[0-9]{3}/);if(_0x293af5)_0x33f4db=_0x293af5[0x0]['match'](/[0-9]{3}/);if(_0x33f4db)_0x3590d8=_0x33f4db[0x0];else _0x3590d8=_0x55031e(0x2a8);const _0x5a626c=_0x2a0412[_0x55031e(0x2f9)]['auth']['encryptedUuid'];if(!_0x5a626c)_0x2a0412['emit'](_0x55031e(0x20c),{'publicKey':secure[_0x55031e(0x1dd)]});else{_0x2b7b6b=timelyDecrypt(_0x5a626c,![]);if(!_0x2b7b6b)_0x2a0412[_0x55031e(0x185)](_0x55031e(0x20c),{'publicKey':secure[_0x55031e(0x1dd)]});else{_0x10bf3e=normalizeIP(_0x2a0412[_0x55031e(0x1aa)][_0x55031e(0x106)])['store'];if(!devices[_0x2b7b6b])devices[_0x2b7b6b]={'uuid':_0x2b7b6b,'access':{'token':null}};devices[_0x2b7b6b]['ip']=_0x10bf3e;const _0x43777e=addClient(_0x2a0412['id'],_0x2b7b6b,_0x3590d8);setAccess(_0x43777e),emitMessages(),_0x2a0412['on'](_0x55031e(0x2fe),_0x1d4b2c=>{const _0x57c299=_0x55031e,_0x34afbd=timelyDecrypt(_0x1d4b2c[_0x57c299(0x122)],!![],'|@|');if(_0x34afbd){_0x1d4b2c={'username':_0x1d4b2c[_0x57c299(0x13d)],'password':_0x34afbd},devices[_0x2b7b6b][_0x57c299(0x2bd)]=validateCredentials(_0x1d4b2c,_0x2b7b6b);if(devices[_0x2b7b6b][_0x57c299(0x2bd)][_0x57c299(0x2e0)]==![]&&devices[_0x2b7b6b]['access'][_0x57c299(0x270)]==_0x57c299(0x2d1))_0x2a0412[_0x57c299(0x185)]('status',{'access':devices[_0x2b7b6b][_0x57c299(0x2bd)]}),loginAccess2FA(_0x2b7b6b,_0x10bf3e);else{if(devices[_0x2b7b6b]['access'][_0x57c299(0x2e0)]==![]&&devices[_0x2b7b6b]['access'][_0x57c299(0x270)]==_0x57c299(0x15c))_0x2a0412[_0x57c299(0x185)](_0x57c299(0x20c),{'access':devices[_0x2b7b6b][_0x57c299(0x2bd)]});else devices[_0x2b7b6b][_0x57c299(0x2bd)][_0x57c299(0x2e0)]&&devices[_0x2b7b6b][_0x57c299(0x2bd)][_0x57c299(0x270)]==_0x57c299(0x25a)&&(getClientsWithUuid(_0x2b7b6b)[_0x57c299(0x251)](_0x214335=>{setAccess(_0x214335);}),logger[_0x57c299(0x18f)](_0x57c299(0x272)+_0x2b7b6b['slice'](-0x8)),setTokenRefresh(_0x2b7b6b),setSessionTimeout('login',_0x2b7b6b));}}else logger[_0x57c299(0x26b)](_0x57c299(0x110));}),_0x2a0412['on']('reset-password',()=>{resetPassword();}),_0x2a0412['on'](_0x55031e(0x24b),_0x42e6e0=>{removeClient(_0x2a0412['id']);}),_0x3590d8==_0x55031e(0x2a8)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x34d650){const _0x1bdcff=_0x38a6a5;if(_0x34d650!=_0x1bdcff(0x2a8)&&config[_0x1bdcff(0x299)]!=''){if(pid[_0x34d650])pid[_0x34d650][_0x1bdcff(0x14f)]({'function':'initclient','args':null});}_0x34d650!='botmanager'&&broadcastToBots(_0x1bdcff(0x2c6),JSON['stringify'](config));}function reloadBotManager(){const _0x4edecc=_0x38a6a5;getClientsWithBotID(_0x4edecc(0x2a8))[_0x4edecc(0x251)](_0x597d35=>{const _0x23c788=_0x4edecc;getSocket(_0x597d35['id'])[_0x23c788(0x185)](_0x23c788(0x20c),{'access':{'allow':![],'reason':_0x23c788(0x1c3),'token':null}});});}function getSocket(_0x236f64){const _0x382c78=_0x38a6a5;return io[_0x382c78(0x132)][_0x382c78(0x132)][_0x382c78(0x217)](_0x236f64);}function setAccess(_0x4e4e65){const _0x32b92c=_0x38a6a5,_0x3d3076=getSocket(_0x4e4e65['id']),_0x2d12ed=_0x4e4e65[_0x32b92c(0x1fa)],_0x8de33e=_0x4e4e65[_0x32b92c(0x2dd)];devices[_0x2d12ed][_0x32b92c(0x2bd)]=validateAccess(devices[_0x2d12ed][_0x32b92c(0x2bd)][_0x32b92c(0x28f)],_0x2d12ed),logger[_0x32b92c(0x18f)](_0x32b92c(0x1c8)+devices[_0x2d12ed]['access'][_0x32b92c(0x270)]+'\x20|\x20client:\x20...'+_0x4e4e65['id'][_0x32b92c(0x249)](-0x8)+'\x20|\x20user:\x20...'+_0x2d12ed[_0x32b92c(0x249)](-0x8)),_0x3d3076[_0x32b92c(0x14a)](_0x2d12ed);if(devices[_0x2d12ed][_0x32b92c(0x2bd)][_0x32b92c(0x2e0)]){_0x3d3076[_0x32b92c(0x14a)](_0x8de33e);if(_0x8de33e==_0x32b92c(0x2a8))initializeSocketBotManager(_0x3d3076);else initializeSocketBot(_0x3d3076);initClient(_0x8de33e);}devices[_0x2d12ed]['access'][_0x32b92c(0x28f)]&&devices[_0x2d12ed]['access'][_0x32b92c(0x270)]==_0x32b92c(0x266)&&setSessionTimeout(_0x32b92c(0x13a),_0x2d12ed),devices[_0x2d12ed][_0x32b92c(0x2bd)][_0x32b92c(0x28f)]&&devices[_0x2d12ed]['access'][_0x32b92c(0x270)]==_0x32b92c(0x24d)&&setSessionTimeout('login',_0x2d12ed),_0x3d3076['emit']('status',{'status':_0x4e4e65[_0x32b92c(0x2f2)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2d12ed][_0x32b92c(0x2bd)],'externalip':devices[_0x2d12ed]['ip'],'publicKey':secure[_0x32b92c(0x1dd)],'userid':settings[_0x32b92c(0x2cc)],'validInstallation':validInstallation}),devices[_0x2d12ed]['access']['allow']==![]&&devices[_0x2d12ed][_0x32b92c(0x2bd)][_0x32b92c(0x270)]=='2FA\x20required'&&temporaryAccess2FA(_0x2d12ed,devices[_0x2d12ed]['ip']);}function setSessionTimeout(_0x37befa,_0x56ee0c){const _0x5d2f57=_0x38a6a5;let _0x96fff1;if(_0x37befa==_0x5d2f57(0x2fe))_0x96fff1=loginExpiry*0x3c*0x3e8;else _0x96fff1=devices[_0x56ee0c][_0x5d2f57(0x1c9)]['expiry']*0x3c*0x3e8-(new Date()[_0x5d2f57(0x1e6)]()-devices[_0x56ee0c][_0x5d2f57(0x1c9)][_0x5d2f57(0x27f)]);if(devices[_0x56ee0c][_0x5d2f57(0x28a)])clearTimeout(devices[_0x56ee0c][_0x5d2f57(0x28a)]);devices[_0x56ee0c][_0x5d2f57(0x28a)]=setTimeout(()=>{const _0x2304fc=_0x5d2f57;if(devices[_0x56ee0c]['pidRefreshToken'])clearTimeout(devices[_0x56ee0c][_0x2304fc(0x291)]);removeSocketListeners(_0x56ee0c),addBlacklist(_0x56ee0c),devices[_0x56ee0c][_0x2304fc(0x1c9)]=null,devices[_0x56ee0c]['telegram2FaApproval']=null,devices[_0x56ee0c]['access'][_0x2304fc(0x28f)]=null,logger[_0x2304fc(0x18f)](_0x2304fc(0x155)+_0x56ee0c[_0x2304fc(0x249)](-0x8)),devices[_0x56ee0c][_0x2304fc(0x2bd)]=validateAccess(devices[_0x56ee0c][_0x2304fc(0x2bd)][_0x2304fc(0x28f)],_0x56ee0c),!(devices[_0x56ee0c][_0x2304fc(0x2bd)]['allow']&&devices[_0x56ee0c][_0x2304fc(0x2bd)][_0x2304fc(0x270)]=='login\x20not\x20required')&&(_0x37befa=='login'?io['to'](_0x56ee0c)[_0x2304fc(0x185)]('status',{'access':{'allow':![],'reason':_0x2304fc(0x1b8),'token':null}}):io['to'](_0x56ee0c)[_0x2304fc(0x185)](_0x2304fc(0x20c),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x56ee0c][_0x2304fc(0x2bd)]['token']=null;},_0x96fff1);}function setTokenRefresh(_0x1b8f95){const _0x5af1c5=_0x38a6a5;if(devices[_0x1b8f95][_0x5af1c5(0x291)])clearTimeout(devices[_0x1b8f95][_0x5af1c5(0x291)]);devices[_0x1b8f95][_0x5af1c5(0x291)]=setTimeout(()=>{const _0x3a45a5=_0x5af1c5;getClientsWithUuid(_0x1b8f95)[_0x3a45a5(0x101)]!=0x0?(devices[_0x1b8f95][_0x3a45a5(0x2bd)]=refreshToken(_0x1b8f95),io['to'](_0x1b8f95)[_0x3a45a5(0x185)](_0x3a45a5(0x20c),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1b8f95][_0x3a45a5(0x2bd)],'externalip':devices[_0x1b8f95]['ip'],'publicKey':secure[_0x3a45a5(0x1dd)],'validInstallation':validInstallation}),setTokenRefresh(_0x1b8f95)):clearTimeout(devices[_0x1b8f95]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5467e4){const _0x54e147=_0x38a6a5,_0x56fd5d=getClient(_0x5467e4['id'])[_0x54e147(0x1fa)];_0x5467e4[_0x54e147(0x185)](_0x54e147(0x2c6),config),_0x5467e4[_0x54e147(0x185)](_0x54e147(0x2d6),cleanSettings()),_0x5467e4['on'](_0x54e147(0x264),_0x55cd70=>{const _0x3667f7=_0x54e147;if(validateAccess(_0x55cd70,_0x56fd5d)[_0x3667f7(0x2e0)])addBot();else logger[_0x3667f7(0x26b)](_0x3667f7(0x17b));}),_0x5467e4['on'](_0x54e147(0x14e),(_0x47c241,_0x1209fa)=>{const _0x5e8fde=_0x54e147;if(validateAccess(_0x1209fa,_0x56fd5d)[_0x5e8fde(0x2e0)])toggleBot(_0x47c241[_0x5e8fde(0x1c6)],_0x47c241[_0x5e8fde(0x20c)],_0x47c241[_0x5e8fde(0x1d4)]);else logger['full'](_0x5e8fde(0x1bc));}),_0x5467e4['on'](_0x54e147(0x139),(_0x10303d,_0x50416b)=>{const _0x5a06e3=_0x54e147;if(validateAccess(_0x50416b,_0x56fd5d)[_0x5a06e3(0x2e0)])toggleBotMode(_0x10303d);else logger[_0x5a06e3(0x26b)](_0x5a06e3(0x1bc));}),_0x5467e4['on']('delete-bot',(_0x2db79f,_0x38a022)=>{const _0x47e82a=_0x54e147;if(validateAccess(_0x38a022,_0x56fd5d)[_0x47e82a(0x2e0)])deleteBot(_0x2db79f);else logger['full'](_0x47e82a(0x16c));}),_0x5467e4['on'](_0x54e147(0x25b),(_0x53b2b6,_0x26ddd8)=>{const _0x48381c=_0x54e147;if(validateAccess(_0x26ddd8,_0x56fd5d)[_0x48381c(0x2e0)])storeSettings(_0x53b2b6,!![]);else logger[_0x48381c(0x26b)](_0x48381c(0x13e));}),_0x5467e4['on']('update-bb',_0x2b69f2=>{const _0x339fed=_0x54e147;if(validateAccess(_0x2b69f2,_0x56fd5d)[_0x339fed(0x2e0)])updateBB('update');else logger[_0x339fed(0x26b)](_0x339fed(0x2c4));}),_0x5467e4['on'](_0x54e147(0x2a3),_0x310526=>{const _0x344016=_0x54e147;if(validateAccess(_0x310526,_0x56fd5d)[_0x344016(0x2e0)])updateBB('reinstall');else logger['full']('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x5467e4['on'](_0x54e147(0x12c),_0x23545a=>{const _0x240a30=_0x54e147;if(validateAccess(_0x23545a,_0x56fd5d)[_0x240a30(0x2e0)]){const _0xa51d20=getClient(_0x5467e4['id']);if(_0xa51d20)getBackupFiles(_0xa51d20[_0x240a30(0x1fa)]);else logger[_0x240a30(0x26b)](_0x240a30(0x114));}else logger[_0x240a30(0x26b)](_0x240a30(0x2ca));}),_0x5467e4['on'](_0x54e147(0x18a),(_0x18ef50,_0x4f6901)=>{const _0x1ec13f=_0x54e147;if(validateAccess(_0x4f6901,_0x56fd5d)[_0x1ec13f(0x2e0)])restoreBackupFile(_0x18ef50);else logger[_0x1ec13f(0x26b)](_0x1ec13f(0x2e7));}),_0x5467e4['on']('get-messages',_0x14b24f=>{const _0x2bc188=_0x54e147;if(validateAccess(_0x14b24f,_0x56fd5d)[_0x2bc188(0x2e0)])getMessages();else logger['full'](_0x2bc188(0x1f4));}),_0x5467e4['on']('confirm-message',(_0x463e5f,_0x37b21b)=>{const _0x4d628f=_0x54e147;if(validateAccess(_0x37b21b,_0x56fd5d)[_0x4d628f(0x2e0)])confirmMessage(_0x463e5f);else logger[_0x4d628f(0x26b)](_0x4d628f(0x23d));}),_0x5467e4['on'](_0x54e147(0x248),_0x1ab861=>{const _0x47fcde=_0x54e147;if(validateAccess(_0x1ab861,_0x56fd5d)[_0x47fcde(0x2e0)]){if(devices[_0x56fd5d][_0x47fcde(0x291)])clearTimeout(devices[_0x56fd5d][_0x47fcde(0x291)]);if(devices[_0x56fd5d][_0x47fcde(0x28a)])clearTimeout(devices[_0x56fd5d][_0x47fcde(0x28a)]);removeSocketListeners(getClient(_0x5467e4['id'])[_0x47fcde(0x1fa)]),addBlacklist(_0x56fd5d),devices[_0x56fd5d]['telegramIpApproval']=null,devices[_0x56fd5d][_0x47fcde(0x210)]=null,devices[_0x56fd5d]['access'][_0x47fcde(0x28f)]=null,logger[_0x47fcde(0x18f)]('Logged\x20out\x20user\x20...'+_0x56fd5d[_0x47fcde(0x249)](-0x8)),io['to'](getClient(_0x5467e4['id'])['uuid'])[_0x47fcde(0x185)](_0x47fcde(0x20c),{'access':{'allow':![],'reason':_0x47fcde(0x1a4),'token':null}});}else logger[_0x47fcde(0x26b)](_0x47fcde(0x15f));});}function initializeSocketBot(_0x522d38){const _0x3a80ff=_0x38a6a5,_0xd4744=getClient(_0x522d38['id'])[_0x3a80ff(0x2dd)],_0x4d695d=getClient(_0x522d38['id'])[_0x3a80ff(0x1fa)];_0x522d38['on'](_0x3a80ff(0x2ef),(_0x5c5aec,_0x4765a7)=>{const _0x5536e3=_0x3a80ff;if(validateAccess(_0x4765a7,_0x4d695d)[_0x5536e3(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x5536e3(0x14f)]({'function':_0x5536e3(0x19e),'args':_0x5c5aec});}else logger[_0x5536e3(0x26b)](_0x5536e3(0x105));}),_0x522d38['on'](_0x3a80ff(0x265),(_0x40b031,_0xdfbf0d)=>{const _0x3728fe=_0x3a80ff;if(validateAccess(_0xdfbf0d,_0x4d695d)[_0x3728fe(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x3728fe(0x14f)]({'function':_0x3728fe(0x100),'args':_0x40b031});}else logger[_0x3728fe(0x26b)](_0x3728fe(0x2ea));}),_0x522d38['on']('get-portfolio',(_0xa7afd1,_0x43dc9a)=>{const _0x3d122f=_0x3a80ff;if(validateAccess(_0x43dc9a,_0x4d695d)[_0x3d122f(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x3d122f(0x14f)]({'function':_0x3d122f(0x20a),'args':_0xa7afd1});}else logger[_0x3d122f(0x26b)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x522d38['on']('store-configuration',(_0x651580,_0x2b40ab)=>{const _0x51004a=_0x3a80ff;if(validateAccess(_0x2b40ab,_0x4d695d)['allow']){if(pid[_0xd4744])pid[_0xd4744]['send']({'function':_0x51004a(0x23f),'args':_0x651580});}else logger['full'](_0x51004a(0x1ed));}),_0x522d38['on'](_0x3a80ff(0x2ad),(_0xe97ab4,_0x24c5b1)=>{const _0x439599=_0x3a80ff;if(validateAccess(_0x24c5b1,_0x4d695d)['allow']){if(pid[_0xd4744])pid[_0xd4744][_0x439599(0x14f)]({'function':_0x439599(0x1ec),'args':_0xe97ab4});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x522d38['on'](_0x3a80ff(0x21b),(_0x252e1d,_0x1b7b70)=>{const _0xa906bc=_0x3a80ff;if(validateAccess(_0x1b7b70,_0x4d695d)['allow']){if(pid[_0xd4744])pid[_0xd4744]['send']({'function':_0xa906bc(0x245),'args':_0x252e1d});}else logger['full'](_0xa906bc(0x1f2));}),_0x522d38['on'](_0x3a80ff(0x25e),_0x9b153e=>{const _0x24eda0=_0x3a80ff;if(validateAccess(_0x9b153e,_0x4d695d)[_0x24eda0(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744]['send']({'function':_0x24eda0(0x1cb),'args':null});}else logger[_0x24eda0(0x26b)](_0x24eda0(0x164));}),_0x522d38['on']('get-starting-balances',_0x549470=>{const _0x5ba41d=_0x3a80ff;if(validateAccess(_0x549470,_0x4d695d)[_0x5ba41d(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x5ba41d(0x14f)]({'function':'getStartingBalances','args':null});}else logger[_0x5ba41d(0x26b)](_0x5ba41d(0x158));}),_0x522d38['on']('place-order',(_0x2e2199,_0xa0b079)=>{const _0x937d3e=_0x3a80ff;if(validateAccess(_0xa0b079,_0x4d695d)[_0x937d3e(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x937d3e(0x14f)]({'function':_0x937d3e(0x28d),'args':_0x2e2199});}else logger['full'](_0x937d3e(0x2df));}),_0x522d38['on'](_0x3a80ff(0x2d2),_0x532968=>{const _0x1c83c4=_0x3a80ff;if(validateAccess(_0x532968,_0x4d695d)[_0x1c83c4(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x1c83c4(0x14f)]({'function':_0x1c83c4(0x247),'args':null});}else logger[_0x1c83c4(0x26b)](_0x1c83c4(0x1a2));}),_0x522d38['on'](_0x3a80ff(0x2ab),_0x4fd8f4=>{const _0x36c832=_0x3a80ff;if(validateAccess(_0x4fd8f4,_0x4d695d)[_0x36c832(0x2e0)]){if(pid[_0xd4744])pid[_0xd4744][_0x36c832(0x14f)]({'function':_0x36c832(0x2b6),'args':null});}else logger[_0x36c832(0x26b)](_0x36c832(0x1ae));}),_0x522d38['on']('update-bb',_0x235722=>{const _0x142046=_0x3a80ff;if(validateAccess(_0x235722,_0x4d695d)['allow'])updateBB(_0x142046(0x278));else logger[_0x142046(0x26b)](_0x142046(0x2c4));}),_0x522d38['on'](_0x3a80ff(0x102),_0x3c2d07=>{const _0x8d40c2=_0x3a80ff;if(validateAccess(_0x3c2d07,_0x4d695d)[_0x8d40c2(0x2e0)])getMessages();else logger[_0x8d40c2(0x26b)](_0x8d40c2(0x1f4));}),_0x522d38['on'](_0x3a80ff(0x19d),(_0x5eca46,_0x5eae4a)=>{const _0x483d17=_0x3a80ff;if(validateAccess(_0x5eae4a,_0x4d695d)['allow'])confirmMessage(_0x5eca46);else logger[_0x483d17(0x26b)](_0x483d17(0x23d));}),_0x522d38['on']('logout',_0x341447=>{const _0x1d528b=_0x3a80ff;if(validateAccess(_0x341447,_0x4d695d)[_0x1d528b(0x2e0)]){if(devices[_0x4d695d][_0x1d528b(0x291)])clearTimeout(devices[_0x4d695d][_0x1d528b(0x291)]);if(devices[_0x4d695d][_0x1d528b(0x28a)])clearTimeout(devices[_0x4d695d][_0x1d528b(0x28a)]);removeSocketListeners(getClient(_0x522d38['id'])[_0x1d528b(0x1fa)]),addBlacklist(_0x4d695d),devices[_0x4d695d]['telegramIpApproval']=null,devices[_0x4d695d]['telegram2FaApproval']=null,devices[_0x4d695d][_0x1d528b(0x2bd)][_0x1d528b(0x28f)]=null,logger[_0x1d528b(0x18f)](_0x1d528b(0x293)+_0x4d695d[_0x1d528b(0x249)](-0x8)),io['to'](getClient(_0x522d38['id'])['uuid'])[_0x1d528b(0x185)](_0x1d528b(0x20c),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x1d528b(0x26b)](_0x1d528b(0x15f));});}function removeSocketListeners(_0x292a66){getClientsWithUuid(_0x292a66)['forEach'](_0x26a463=>{const _0x414d4a=_0x3515;getSocket(_0x26a463['id'])[_0x414d4a(0x280)]();});}function cleanSettings(){const _0x544de7=_0x38a6a5;let _0xe3cd01=settings;return settings[_0x544de7(0x10f)]&&settings[_0x544de7(0x10f)]!=''&&(_0xe3cd01={..._0xe3cd01,'telegramToken':_0x544de7(0x165)}),settings[_0x544de7(0x267)]&&settings[_0x544de7(0x267)]!=''&&(_0xe3cd01={..._0xe3cd01,'bbPassword':'************'}),settings[_0x544de7(0x229)]&&settings[_0x544de7(0x229)]!=''&&(_0xe3cd01={..._0xe3cd01,'marketcapApi':_0x544de7(0x165)}),(settings[_0x544de7(0x267)]&&settings[_0x544de7(0x267)]==_0x544de7(0x1b6)||settings[_0x544de7(0x10f)]&&settings[_0x544de7(0x10f)]==_0x544de7(0x1b6)||settings[_0x544de7(0x229)]&&settings['marketcapApi']==_0x544de7(0x1b6))&&(_0xe3cd01={..._0xe3cd01,'restored':{'password':settings[_0x544de7(0x267)]=='***','telegram':settings[_0x544de7(0x10f)]==_0x544de7(0x1b6),'marketcap':settings['marketcapApi']==_0x544de7(0x1b6)}}),_0xe3cd01;}async function updateBB(_0x5e3661){const _0x542fc1=_0x38a6a5;await backupConfigFiles(),installingUpdate=!![],config[_0x542fc1(0x251)](_0x57feb7=>{const _0x20ed94=_0x542fc1;restartBot(_0x57feb7[_0x20ed94(0x1c6)]);});if(_0x5e3661==_0x542fc1(0x278))process[_0x542fc1(0x14f)]({'update':!![],'environment':environment},_0xbf1b66=>{});else _0x5e3661==_0x542fc1(0x1b5)&&process[_0x542fc1(0x14f)]({'reinstall':!![],'environment':environment},_0x55ce40=>{});}function startBot(_0x274191,_0x27a578,_0x235b1f){const _0x362ecc=_0x38a6a5;if(debugging)_0x274191['push']('-d');let _0xca6b85=![];const _0x39c623=_0x274191[0x0];_0x27a578={..._0x27a578,'stdio':[_0x362ecc(0x20d),_0x362ecc(0x20d),'inherit',_0x362ecc(0x13b)]},pid[_0x39c623]=childProcess[_0x362ecc(0x123)](botfile,_0x274191,_0x27a578),pid[_0x39c623]['on'](_0x362ecc(0x1fb),_0x43259b=>{const _0x2a3509=_0x362ecc;switch(Object['keys'](_0x43259b)[0x0]){case'botname':updateBotName(_0x39c623,_0x43259b['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x2a3509(0x20c):updateStatus(_0x39c623,_0x43259b['status']);break;case _0x2a3509(0x1d4):updateLive(_0x39c623,_0x43259b[_0x2a3509(0x1d4)]);break;case _0x2a3509(0x17d):updateLive(_0x39c623,_0x43259b[_0x2a3509(0x17d)]),io['to'](_0x39c623)[_0x2a3509(0x185)](_0x2a3509(0x20c),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x2a3509(0x126):_0x43259b[_0x2a3509(0x126)]==_0x2a3509(0x2fa)&&restartBot(_0x39c623);_0x43259b['stop']==_0x2a3509(0x2b2)&&toggleBot(_0x39c623,_0x2a3509(0x1f6),'stopped');break;case _0x2a3509(0x22a):sendTelegramBot(_0x39c623,_0x43259b['telegram']);break;case _0x2a3509(0x1d2):sendTelegramMsg(_0x43259b[_0x2a3509(0x1d2)]);break;case _0x2a3509(0x295):io['to'](_0x39c623)[_0x2a3509(0x185)](_0x43259b[_0x2a3509(0x295)],_0x43259b[_0x2a3509(0x137)]);break;}}),pid[_0x39c623]['on'](_0x362ecc(0x11d),function(_0x4a7d91){if(_0xca6b85)return;_0xca6b85=!![],_0x235b1f(_0x4a7d91);}),pid[_0x39c623]['on'](_0x362ecc(0x239),async function(_0x471587){const _0x218b6a=_0x362ecc;if(terminating)return;if(installingUpdate){logger[_0x218b6a(0x18f)](_0x218b6a(0x274)),io[_0x218b6a(0x2be)]();return;}if(_0xca6b85)return;_0xca6b85=!![],_0x235b1f(null);const _0x1e2d73=dbConfig['get'](_0x218b6a(0x2c6))['find']({'botID':_0x39c623})[_0x218b6a(0x2fd)]();_0x1e2d73&&(_0x1e2d73['status']==_0x218b6a(0x290)||_0x1e2d73['status']==_0x218b6a(0x1d6))&&(await sleep(0x3e8),updateLive(_0x39c623,_0x218b6a(0x289)),logger[_0x218b6a(0x26b)]('Restarting\x20Bot\x20'+_0x39c623),startBot([_0x39c623,userID],{'cwd':bbpath},function(_0xbb5e9f){if(_0xbb5e9f)logger['full'](_0xbb5e9f);}));});}function stopBot(_0x2baa82){const _0x1ae9d0=_0x38a6a5;getClientsWithBotID(_0x2baa82)['forEach'](_0x3018cf=>{const _0x217c3f=_0x3515;getSocket(_0x3018cf['id'])[_0x217c3f(0x24b)](!![]),removeClient(_0x3018cf['id']);}),pid[_0x2baa82]&&(pid[_0x2baa82][_0x1ae9d0(0x2b2)](),pid[_0x2baa82]=null);}function stopAllBots(){const _0x23abda=_0x38a6a5;terminating=!![];const _0x3b782d=getEnabledBots();_0x3b782d[_0x23abda(0x251)](_0x45a6c2=>{const _0x10f5b5=_0x23abda;stopBot(_0x45a6c2[_0x10f5b5(0x1c6)]);});}function restartBot(_0x58608f){const _0x553c5d=_0x38a6a5;if(pid[_0x58608f])pid[_0x58608f][_0x553c5d(0x2b2)]();}function addBot(){const _0x53df48=_0x38a6a5;let _0x5531f2;for(let _0x51cdb3=0x1;_0x51cdb3<0x3e9;_0x51cdb3++){_0x5531f2=_0x51cdb3[_0x53df48(0x1b0)]()[_0x53df48(0x161)](0x3,'0');let _0x5748c9=config['find'](_0x5e4817=>_0x5e4817[_0x53df48(0x1c6)]==_0x5531f2);if(!_0x5748c9)break;}if(_0x5531f2==='1000'){logger['full'](_0x53df48(0x14b));return;}logger['full'](_0x53df48(0x138)+_0x5531f2),dbConfig['get'](_0x53df48(0x2c6))[_0x53df48(0x173)]({'botID':_0x5531f2,'botname':_0x53df48(0x1ff)+_0x5531f2,'status':_0x53df48(0x1d6),'live':''})['write'](),startBot([_0x5531f2,userID],{'cwd':bbpath},function(_0x31e3ad){const _0x538aee=_0x53df48;if(_0x31e3ad)logger[_0x538aee(0x26b)](_0x31e3ad);}),config=getConfiguration(),io['to'](_0x53df48(0x2a8))[_0x53df48(0x185)](_0x53df48(0x2c6),config),broadcastToBots(_0x53df48(0x2c6),JSON[_0x53df48(0x257)](config));}function deleteBot(_0x59e975){const _0x1df9c7=_0x38a6a5;getClientsWithBotID(_0x59e975)['forEach'](_0x2a8398=>{const _0x1623de=_0x3515;getSocket(_0x2a8398['id'])[_0x1623de(0x24b)](!![]),removeClient(_0x2a8398['id']);}),dbConfig[_0x1df9c7(0x217)](_0x1df9c7(0x2c6))[_0x1df9c7(0x17c)]({'botID':_0x59e975})[_0x1df9c7(0x142)](),logger[_0x1df9c7(0x26b)]('Deleted\x20Bot\x20'+_0x59e975),stopBot(_0x59e975);try{if(fs[_0x1df9c7(0x273)](path[_0x1df9c7(0x14a)](configpath,_0x1df9c7(0x203)+_0x59e975+_0x1df9c7(0x29a))))fs['unlinkSync'](path['join'](configpath,_0x1df9c7(0x203)+_0x59e975+_0x1df9c7(0x29a)));if(fs[_0x1df9c7(0x273)](path[_0x1df9c7(0x14a)](configpath,_0x1df9c7(0x203)+_0x59e975+_0x1df9c7(0x246))))fs[_0x1df9c7(0x244)](path[_0x1df9c7(0x14a)](configpath,_0x1df9c7(0x203)+_0x59e975+'-events.json'));if(fs[_0x1df9c7(0x273)](path[_0x1df9c7(0x14a)](configpath,_0x1df9c7(0x203)+_0x59e975+_0x1df9c7(0x174))))fs[_0x1df9c7(0x244)](path[_0x1df9c7(0x14a)](configpath,_0x1df9c7(0x203)+_0x59e975+'-performance.json'));if(fs[_0x1df9c7(0x273)](path['join'](configpath,_0x1df9c7(0x203)+_0x59e975+_0x1df9c7(0x186))))fs[_0x1df9c7(0x244)](path[_0x1df9c7(0x14a)](configpath,_0x1df9c7(0x203)+_0x59e975+_0x1df9c7(0x186)));}catch(_0x23663b){if(_0x23663b)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x23663b);}config=getConfiguration(),io['to'](_0x1df9c7(0x2a8))[_0x1df9c7(0x185)]('bots',config),broadcastToBots(_0x1df9c7(0x2c6),JSON[_0x1df9c7(0x257)](config));}function toggleBot(_0x395e25,_0x852e64,_0x437b2b){const _0x195b1c=_0x38a6a5;dbConfig[_0x195b1c(0x217)](_0x195b1c(0x2c6))[_0x195b1c(0x1c5)]({'botID':_0x395e25})['assign']({'status':_0x852e64})[_0x195b1c(0x17e)]({'live':_0x437b2b})[_0x195b1c(0x142)]();if(_0x852e64==_0x195b1c(0x290)||_0x852e64==_0x195b1c(0x1d6))logger[_0x195b1c(0x26b)](_0x195b1c(0x1e1)+_0x395e25),startBot([_0x395e25,userID],{'cwd':bbpath},function(_0x5e5980){const _0x4cfe6d=_0x195b1c;if(_0x5e5980)logger[_0x4cfe6d(0x26b)](_0x5e5980);});else(_0x852e64==_0x195b1c(0x1f6)||_0x852e64==_0x195b1c(0x2c8))&&(logger[_0x195b1c(0x26b)]('Disabled\x20Bot\x20'+_0x395e25),stopBot(_0x395e25));config=getConfiguration(),io['to']('botmanager')[_0x195b1c(0x185)](_0x195b1c(0x2c6),config),broadcastToBots(_0x195b1c(0x2c6),JSON[_0x195b1c(0x257)](config));}function toggleStatus(_0x3b004f){const _0x3fa35e=_0x38a6a5;let _0x40e7de=dbConfig[_0x3fa35e(0x217)](_0x3fa35e(0x2c6))[_0x3fa35e(0x1c5)]({'botID':_0x3b004f})['value'](),_0x6f7441;if(_0x40e7de[_0x3fa35e(0x20c)]===_0x3fa35e(0x290))_0x6f7441=_0x3fa35e(0x1f6);else{if(_0x40e7de['status']===_0x3fa35e(0x1d6))_0x6f7441=_0x3fa35e(0x2c8);else{if(_0x40e7de[_0x3fa35e(0x20c)]===_0x3fa35e(0x2c8))_0x6f7441=_0x3fa35e(0x1d6);else{if(_0x40e7de[_0x3fa35e(0x20c)]==='disabled')_0x6f7441=_0x3fa35e(0x290);}}}return _0x6f7441;}function updateStatus(_0x5eefae,_0x24cc58){const _0x1cdb57=_0x38a6a5;dbConfig['get'](_0x1cdb57(0x2c6))[_0x1cdb57(0x1c5)]({'botID':_0x5eefae})[_0x1cdb57(0x17e)]({'status':_0x24cc58})[_0x1cdb57(0x142)](),config=getConfiguration(),io['to'](_0x1cdb57(0x2a8))[_0x1cdb57(0x185)](_0x1cdb57(0x2c6),config),broadcastToBots(_0x1cdb57(0x2c6),JSON[_0x1cdb57(0x257)](config));}function updateLive(_0x2bdc1b,_0x30ae92){const _0x59880f=_0x38a6a5;dbConfig['get'](_0x59880f(0x2c6))[_0x59880f(0x1c5)]({'botID':_0x2bdc1b})[_0x59880f(0x17e)]({'live':_0x30ae92})[_0x59880f(0x142)](),config=getConfiguration(),io['to'](_0x59880f(0x2a8))[_0x59880f(0x185)](_0x59880f(0x2c6),config),broadcastToBots(_0x59880f(0x2c6),JSON[_0x59880f(0x257)](config));}function updateBotName(_0x156150,_0x43d90f){const _0x49ecae=_0x38a6a5;dbConfig[_0x49ecae(0x217)](_0x49ecae(0x2c6))[_0x49ecae(0x1c5)]({'botID':_0x156150})[_0x49ecae(0x17e)]({'botname':_0x43d90f})[_0x49ecae(0x142)](),config=getConfiguration(),io['to'](_0x49ecae(0x2a8))[_0x49ecae(0x185)](_0x49ecae(0x2c6),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x42a7ec=_0x38a6a5;config=getConfiguration(),io['to'](_0x42a7ec(0x2a8))['emit']('bots',config),broadcastToBots(_0x42a7ec(0x2c6),JSON[_0x42a7ec(0x257)](config));}function toggleBotMode(_0xd91af5){const _0xc8821c=_0x38a6a5;if(pid[_0xd91af5])pid[_0xd91af5][_0xc8821c(0x14f)]({'function':'toggleBotMode','args':null});else{const _0x300714=configpath+'bot-'+_0xd91af5+'-config.json',_0x127929=fs[_0xc8821c(0x10c)](_0x300714),_0x2c7bb8=JSON['parse'](_0x127929),_0x1fe2f6=_0x2c7bb8[_0xc8821c(0x2dd)][0x0][_0xc8821c(0x2e2)];_0x2c7bb8[_0xc8821c(0x2dd)][0x0]['headless']=!_0x1fe2f6;const _0x3c7625=JSON['stringify'](_0x2c7bb8,null,0x2);fs[_0xc8821c(0x195)](_0x300714,_0x3c7625),config=getConfiguration(),io['to']('botmanager')[_0xc8821c(0x185)](_0xc8821c(0x2c6),config),broadcastToBots(_0xc8821c(0x2c6),JSON[_0xc8821c(0x257)](config));}}function validateTelegram(_0x554950){const _0x1c69f6=_0x38a6a5;if(_0x554950[_0x1c69f6(0x2d0)][_0x1c69f6(0x13d)]!=settings[_0x1c69f6(0x2b3)]&&'@'+_0x554950['from'][_0x1c69f6(0x13d)]!=settings[_0x1c69f6(0x2b3)]||_0x554950[_0x1c69f6(0x127)]['id']!=settings[_0x1c69f6(0x304)])return sendTelegram(_0x554950[_0x1c69f6(0x127)]['id'],_0x1c69f6(0x1cd),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x3f516d=_0x38a6a5;if(tgBot)tgBot[_0x3f516d(0x126)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x3589b6=_0x3f516d(0x1da);_0x3589b6+='\x0a',_0x3589b6+=_0x3f516d(0x224),_0x3589b6+=_0x3f516d(0x276),_0x3589b6+=_0x3f516d(0x1b9),_0x3589b6+=_0x3f516d(0x29e),_0x3589b6+='/on\x20-\x20start\x20bot(s)\x0a',_0x3589b6+=_0x3f516d(0x115),_0x3589b6+=_0x3f516d(0x151),_0x3589b6+=_0x3f516d(0x159),_0x3589b6+=_0x3f516d(0x25c),_0x3589b6+=_0x3f516d(0x193),_0x3589b6+=_0x3f516d(0x207),_0x3589b6+=_0x3f516d(0x146),_0x3589b6+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x3589b6+=_0x3f516d(0x117);let _0x70ad62=_0x3f516d(0x20f);_0x70ad62+='\x0a',_0x70ad62+=_0x3589b6,tgBot[_0x3f516d(0x262)]((_0x2fd850,_0x5f487a)=>{const _0x8f80be=_0x3f516d;logger['simple'](getTimeStamp()+_0x8f80be(0x1ce)),logger[_0x8f80be(0x18f)]('Telegraf\x20error:',_0x2fd850);}),tgBot[_0x3f516d(0x297)](async(_0x2f766c,_0x3eb121)=>{const _0x9541cf=_0x3f516d;if(!(!settings[_0x9541cf(0x304)]&&_0x2f766c[_0x9541cf(0x278)][_0x9541cf(0x1fb)]['text']=='/start')){if(!validateTelegram(_0x2f766c))return;}_0x3eb121();}),tgBot[_0x3f516d(0x1a1)]('start',async _0x21a729=>{const _0x1825bd=_0x3f516d;if(!settings[_0x1825bd(0x304)])updateSetting(_0x1825bd(0x304),_0x21a729[_0x1825bd(0x127)]['id']);updateSetting(_0x1825bd(0x2fb),!![]);if(!validateTelegram(_0x21a729))return;await sendTelegram(_0x21a729['chat']['id'],_0x70ad62);}),tgBot['command'](_0x3f516d(0x1a7),async _0x28b793=>{const _0x2127e1=_0x3f516d;updateSetting(_0x2127e1(0x2fb),!![]),await sendTelegram(_0x28b793[_0x2127e1(0x127)]['id'],'Notifications\x20enabled');}),tgBot['command'](_0x3f516d(0x2d3),async _0x94ae7e=>{const _0x5eda02=_0x3f516d;await sendTelegram(_0x94ae7e[_0x5eda02(0x127)]['id'],_0x5eda02(0x116)),updateSetting(_0x5eda02(0x2fb),![]);}),tgBot[_0x3f516d(0x1a1)]('config',async _0x49d13b=>{const _0x4f21a1=_0x3f516d,_0x4b932d=Markup[_0x4f21a1(0x227)]([Markup[_0x4f21a1(0x27b)][_0x4f21a1(0x2e1)]('Orders',_0x4f21a1(0x1dc)),Markup[_0x4f21a1(0x27b)][_0x4f21a1(0x2e1)](_0x4f21a1(0x2a9),'config_alerts'),Markup[_0x4f21a1(0x27b)]['callback'](_0x4f21a1(0x17a),_0x4f21a1(0x2d8))]);_0x49d13b[_0x4f21a1(0x1d8)](_0x4f21a1(0x12a),_0x4b932d);}),tgBot[_0x3f516d(0x17f)](_0x3f516d(0x1dc),async _0x47ab52=>{const _0x7ff99e=_0x3f516d;_0x47ab52['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x7ff99e(0x27d)),updateSetting(_0x7ff99e(0x2fb),!![]),await sendTelegram(_0x47ab52['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x3f516d(0x17f)](_0x3f516d(0x225),async _0x3b001c=>{const _0x11cbbe=_0x3f516d;_0x3b001c['editMessageReplyMarkup'](),updateSetting(_0x11cbbe(0x26a),_0x11cbbe(0x1d1)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3b001c[_0x11cbbe(0x127)]['id'],_0x11cbbe(0x253));}),tgBot[_0x3f516d(0x17f)]('config_all',async _0x5216a3=>{const _0x33bdcd=_0x3f516d;_0x5216a3[_0x33bdcd(0x15b)](),updateSetting(_0x33bdcd(0x26a),_0x33bdcd(0x1c0)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5216a3[_0x33bdcd(0x127)]['id'],_0x33bdcd(0x1f1));}),tgBot[_0x3f516d(0x1a1)]('status',async _0x50a4a0=>{const _0xce9614=_0x3f516d,_0x10235e=getBotsWithMode();let _0x9e750a=_0xce9614(0x16e);config['forEach'](_0x2560f6=>{const _0xeaaf9e=_0xce9614,_0x498770=_0x10235e['find'](_0x48a86a=>_0x48a86a[_0xeaaf9e(0x1c6)]==_0x2560f6[_0xeaaf9e(0x1c6)])[_0xeaaf9e(0x1d9)];_0x9e750a+=_0xeaaf9e(0x1ff)+_0x2560f6[_0xeaaf9e(0x1c6)]+':\x20'+_0x2560f6['status']+_0xeaaf9e(0x1a0)+_0x498770+_0xeaaf9e(0x1a0)+_0x2560f6[_0xeaaf9e(0x1d4)]+'\x0a';}),_0x9e750a+='\x0a',_0x9e750a+=_0xce9614(0x1ac),_0x9e750a+=!settings[_0xce9614(0x2fb)]?_0xce9614(0x20e):_0xce9614(0x143),_0x9e750a+=settings[_0xce9614(0x2fb)]?settings[_0xce9614(0x26a)]==_0xce9614(0x1c0)?_0xce9614(0x104):_0xce9614(0x2ee)+settings[_0xce9614(0x26a)]+_0xce9614(0x1c4):'',await sendTelegram(_0x50a4a0[_0xce9614(0x127)]['id'],_0x9e750a,{'parse_mode':_0xce9614(0x2f4)});}),tgBot[_0x3f516d(0x1a1)]('restart',async _0xd8d1af=>{const _0x87276d=_0x3f516d,_0x1c15a6=getEnabledBots();if(_0x1c15a6[_0x87276d(0x101)]==0x0)await sendTelegram(_0xd8d1af[_0x87276d(0x127)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1c15a6[_0x87276d(0x101)]>0x1)_0x1c15a6[_0x87276d(0x173)]({'botID':'all'});let _0x1845ab=[],_0xa0deaa=[];const _0xbf8046=_0x1c15a6[_0x87276d(0x101)]%0x4==0x0||_0x1c15a6[_0x87276d(0x101)]%0x4==0x3||_0x1c15a6[_0x87276d(0x101)]%0x3==0x1?0x4:0x3;let _0x2540ba=0x0;_0x1c15a6[_0x87276d(0x251)]((_0x156947,_0x23fe0b)=>{const _0xcf65cc=_0x87276d;if(_0x23fe0b%_0xbf8046==0x0)_0xa0deaa=[];_0xa0deaa[_0xcf65cc(0x173)](Markup['button'][_0xcf65cc(0x2e1)](_0x156947[_0xcf65cc(0x1c6)]==_0xcf65cc(0x1c0)?_0xcf65cc(0x2ac):_0xcf65cc(0x1ff)+_0x156947[_0xcf65cc(0x1c6)],'restart_'+_0x156947['botID'])),_0x23fe0b%_0xbf8046==0x0&&(_0x1845ab[_0x2540ba]=_0xa0deaa,_0x2540ba++);});const _0x2acd4f=Markup[_0x87276d(0x227)](_0x1845ab);_0xd8d1af[_0x87276d(0x1d8)](_0x87276d(0x301),_0x2acd4f);}}),tgBot['action'](/restart_(.+)/,async _0x140236=>{const _0x98e84d=_0x3f516d,_0x5f514b=_0x140236[_0x98e84d(0x167)][0x1];_0x140236[_0x98e84d(0x15b)](),_0x5f514b=='all'?config[_0x98e84d(0x251)](_0x4767d3=>{const _0x42cd0a=_0x98e84d;restartBot(_0x4767d3[_0x42cd0a(0x1c6)]);}):restartBot(_0x5f514b);}),tgBot['command']('on',async _0x1f6fa5=>{const _0x3c4e52=_0x3f516d,_0x79cf6c=getDisabledBots();if(_0x79cf6c[_0x3c4e52(0x101)]==0x0)await sendTelegram(_0x1f6fa5[_0x3c4e52(0x127)]['id'],_0x3c4e52(0x152));else{if(_0x79cf6c[_0x3c4e52(0x101)]>0x1)_0x79cf6c['push']({'botID':_0x3c4e52(0x1c0)});let _0x1a937a=[],_0x55a07a=[];const _0x58e2ec=_0x79cf6c['length']%0x4==0x0||_0x79cf6c[_0x3c4e52(0x101)]%0x4==0x3||_0x79cf6c[_0x3c4e52(0x101)]%0x3==0x1?0x4:0x3;let _0x29b968=0x0;_0x79cf6c['forEach']((_0x4c1774,_0x533748)=>{const _0x4dc69e=_0x3c4e52;if(_0x533748%_0x58e2ec==0x0)_0x55a07a=[];_0x55a07a['push'](Markup[_0x4dc69e(0x27b)][_0x4dc69e(0x2e1)](_0x4c1774[_0x4dc69e(0x1c6)]=='all'?_0x4dc69e(0x2ac):_0x4dc69e(0x1ff)+_0x4c1774[_0x4dc69e(0x1c6)],'on_'+_0x4c1774['botID'])),_0x533748%_0x58e2ec==0x0&&(_0x1a937a[_0x29b968]=_0x55a07a,_0x29b968++);});const _0x3e5fa7=Markup[_0x3c4e52(0x227)](_0x1a937a);_0x1f6fa5[_0x3c4e52(0x1d8)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x3e5fa7);}}),tgBot[_0x3f516d(0x17f)](/on_(.+)/,async _0x133886=>{const _0x52f615=_0x3f516d,_0x509e88=_0x133886[_0x52f615(0x167)][0x1];_0x133886[_0x52f615(0x15b)]();if(_0x509e88==_0x52f615(0x1c0)){const _0x174fc7=getDisabledBots();await sendTelegram(_0x133886[_0x52f615(0x127)]['id'],_0x52f615(0x29c)),_0x174fc7[_0x52f615(0x251)](_0x401b52=>{const _0xae92e4=_0x52f615;if(_0x401b52[_0xae92e4(0x1c6)]!=_0xae92e4(0x1c0))toggleBot(_0x401b52[_0xae92e4(0x1c6)],toggleStatus(_0x401b52[_0xae92e4(0x1c6)]),_0xae92e4(0x289));});}else await sendTelegram(_0x133886[_0x52f615(0x127)]['id'],_0x52f615(0x288)+_0x509e88),toggleBot(_0x509e88,toggleStatus(_0x509e88),_0x52f615(0x289));}),tgBot['command']('off',async _0x85a025=>{const _0x40eac8=_0x3f516d,_0x5c15cf=getEnabledBots();if(_0x5c15cf[_0x40eac8(0x101)]==0x0)await sendTelegram(_0x85a025[_0x40eac8(0x127)]['id'],_0x40eac8(0x1e3));else{if(_0x5c15cf['length']>0x1)_0x5c15cf[_0x40eac8(0x173)]({'botID':_0x40eac8(0x1c0)});let _0xa865df=[],_0x3d5006=[];const _0x2f7a06=_0x5c15cf[_0x40eac8(0x101)]%0x4==0x0||_0x5c15cf[_0x40eac8(0x101)]%0x4==0x3||_0x5c15cf['length']%0x3==0x1?0x4:0x3;let _0x3cbaa5=0x0;_0x5c15cf[_0x40eac8(0x251)]((_0x4232d0,_0x370a63)=>{const _0x4399e8=_0x40eac8;if(_0x370a63%_0x2f7a06==0x0)_0x3d5006=[];_0x3d5006[_0x4399e8(0x173)](Markup[_0x4399e8(0x27b)][_0x4399e8(0x2e1)](_0x4232d0[_0x4399e8(0x1c6)]=='all'?_0x4399e8(0x2ac):_0x4399e8(0x1ff)+_0x4232d0[_0x4399e8(0x1c6)],_0x4399e8(0x2b1)+_0x4232d0['botID'])),_0x370a63%_0x2f7a06==0x0&&(_0xa865df[_0x3cbaa5]=_0x3d5006,_0x3cbaa5++);});const _0x44364c=Markup['inlineKeyboard'](_0xa865df);_0x85a025[_0x40eac8(0x1d8)](_0x40eac8(0x1be),_0x44364c);}}),tgBot[_0x3f516d(0x17f)](/off_(.+)/,async _0x214641=>{const _0x50e6a7=_0x3f516d,_0x1deaec=_0x214641[_0x50e6a7(0x167)][0x1];_0x214641['editMessageReplyMarkup']();if(_0x1deaec==_0x50e6a7(0x1c0)){const _0x4704fd=getEnabledBots();await sendTelegram(_0x214641[_0x50e6a7(0x127)]['id'],_0x50e6a7(0x305)),_0x4704fd[_0x50e6a7(0x251)](_0x29af84=>{const _0x128132=_0x50e6a7;if(_0x29af84[_0x128132(0x1c6)]!=_0x128132(0x1c0))toggleBot(_0x29af84[_0x128132(0x1c6)],toggleStatus(_0x29af84[_0x128132(0x1c6)]),'stopped');});}else await sendTelegram(_0x214641[_0x50e6a7(0x127)]['id'],_0x50e6a7(0x29f)+_0x1deaec),toggleBot(_0x1deaec,toggleStatus(_0x1deaec),_0x50e6a7(0x289));}),tgBot[_0x3f516d(0x1a1)]('metrics',async _0x1b1f68=>{const _0x22fcd7=_0x3f516d,_0x2f1376=getEnabledBots();if(_0x2f1376[_0x22fcd7(0x101)]==0x0)await sendTelegram(_0x1b1f68[_0x22fcd7(0x127)]['id'],_0x22fcd7(0x1e3));else{if(_0x2f1376[_0x22fcd7(0x101)]>0x1){let _0x19d9f0=[],_0x29f0cb=[];const _0x29e700=_0x2f1376[_0x22fcd7(0x101)]%0x4==0x0||_0x2f1376[_0x22fcd7(0x101)]%0x4==0x3||_0x2f1376[_0x22fcd7(0x101)]%0x3==0x1?0x4:0x3;let _0x1faae1=0x0;_0x2f1376[_0x22fcd7(0x251)]((_0x3af210,_0x28adf8)=>{const _0x20d3de=_0x22fcd7;if(_0x28adf8%_0x29e700==0x0)_0x29f0cb=[];_0x29f0cb[_0x20d3de(0x173)](Markup['button'][_0x20d3de(0x2e1)](_0x20d3de(0x1ff)+_0x3af210[_0x20d3de(0x1c6)],_0x20d3de(0x11a)+_0x3af210[_0x20d3de(0x1c6)])),_0x28adf8%_0x29e700==0x0&&(_0x19d9f0[_0x1faae1]=_0x29f0cb,_0x1faae1++);});const _0x2ca35c=Markup[_0x22fcd7(0x227)](_0x19d9f0);_0x1b1f68[_0x22fcd7(0x1d8)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x2ca35c);}else{const _0x57b912=_0x2f1376[0x0][_0x22fcd7(0x1c6)];if(pid[_0x57b912])pid[_0x57b912][_0x22fcd7(0x14f)]({'function':_0x22fcd7(0x296),'args':null});}}}),tgBot[_0x3f516d(0x17f)](/metrics_(.+)/,async _0x56a29d=>{const _0x5ef409=_0x3f516d,_0xc69efb=_0x56a29d[_0x5ef409(0x167)][0x1];_0x56a29d[_0x5ef409(0x15b)]();if(pid[_0xc69efb])pid[_0xc69efb][_0x5ef409(0x14f)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x3f516d(0x111),async _0x15e30d=>{const _0x3e6ed8=_0x3f516d,_0x338c4f=getEnabledBots();if(_0x338c4f[_0x3e6ed8(0x101)]==0x0)await sendTelegram(_0x15e30d[_0x3e6ed8(0x127)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x338c4f[_0x3e6ed8(0x101)]>0x1){let _0x15e183=[],_0x28cbdb=[];const _0x3c409e=_0x338c4f[_0x3e6ed8(0x101)]%0x4==0x0||_0x338c4f[_0x3e6ed8(0x101)]%0x4==0x3||_0x338c4f[_0x3e6ed8(0x101)]%0x3==0x1?0x4:0x3;let _0x4da8c2=0x0;_0x338c4f[_0x3e6ed8(0x251)]((_0x46602f,_0x3925c3)=>{const _0x508f53=_0x3e6ed8;if(_0x3925c3%_0x3c409e==0x0)_0x28cbdb=[];_0x28cbdb[_0x508f53(0x173)](Markup[_0x508f53(0x27b)][_0x508f53(0x2e1)](_0x508f53(0x1ff)+_0x46602f[_0x508f53(0x1c6)],_0x508f53(0x1f5)+_0x46602f['botID'])),_0x3925c3%_0x3c409e==0x0&&(_0x15e183[_0x4da8c2]=_0x28cbdb,_0x4da8c2++);});const _0x386e22=Markup[_0x3e6ed8(0x227)](_0x15e183);_0x15e30d[_0x3e6ed8(0x1d8)](_0x3e6ed8(0x13c),_0x386e22);}else{const _0x560968=_0x338c4f[0x0][_0x3e6ed8(0x1c6)];if(pid[_0x560968])pid[_0x560968][_0x3e6ed8(0x14f)]({'function':_0x3e6ed8(0x12f),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x271307=>{const _0x42af86=_0x3f516d,_0x3ed1f2=_0x271307['match'][0x1];_0x271307['editMessageReplyMarkup']();if(pid[_0x3ed1f2])pid[_0x3ed1f2][_0x42af86(0x14f)]({'function':_0x42af86(0x12f),'args':null});}),tgBot[_0x3f516d(0x1a1)](_0x3f516d(0x278),async _0xed441b=>{const _0x1d47cc=_0x3f516d;await getMessages();if(!updateAvailable)await sendTelegram(_0xed441b[_0x1d47cc(0x127)]['id'],_0x1d47cc(0x1b2));else{if(!validInstallation)await sendTelegram(_0xed441b['chat']['id'],_0x1d47cc(0x191));else{const _0x3cfe1b=Markup[_0x1d47cc(0x227)]([Markup[_0x1d47cc(0x27b)][_0x1d47cc(0x2e1)](_0x1d47cc(0x130),_0x1d47cc(0x2c3)),Markup[_0x1d47cc(0x27b)][_0x1d47cc(0x2e1)]('No','update_no')]);_0xed441b[_0x1d47cc(0x1d8)](_0x1d47cc(0x209),_0x3cfe1b);}}}),tgBot[_0x3f516d(0x17f)](/update_(.+)/,async _0x3e1933=>{const _0x307441=_0x3f516d,_0x483764=_0x3e1933['match'][0x1];_0x3e1933[_0x307441(0x15b)](),_0x483764=='yes'&&(await sendTelegram(_0x3e1933['chat']['id'],_0x307441(0x166)),updateBB(_0x307441(0x278))),_0x483764=='no'&&await sendTelegram(_0x3e1933[_0x307441(0x127)]['id'],_0x307441(0x29b));}),tgBot['command']('reinstall',async _0x1cf789=>{const _0x438358=_0x3f516d;if(!validInstallation)await sendTelegram(_0x1cf789[_0x438358(0x127)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x50bad2=Markup[_0x438358(0x227)]([Markup[_0x438358(0x27b)][_0x438358(0x2e1)]('Yes',_0x438358(0x162)),Markup['button'][_0x438358(0x2e1)]('No',_0x438358(0x1e5))]);_0x1cf789[_0x438358(0x1d8)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x50bad2);}}),tgBot['action'](/reinstall_(.+)/,async _0x20c32e=>{const _0x1f05be=_0x3f516d,_0x1f7fef=_0x20c32e['match'][0x1];_0x20c32e['editMessageReplyMarkup'](),_0x1f7fef==_0x1f05be(0x2d7)&&(await sendTelegram(_0x20c32e[_0x1f05be(0x127)]['id'],_0x1f05be(0x171)),updateBB(_0x1f05be(0x1b5))),_0x1f7fef=='no'&&await sendTelegram(_0x20c32e['chat']['id'],_0x1f05be(0x214));}),tgBot['command'](_0x3f516d(0x25d),async _0x4d6bf4=>{const _0x2f6ff3=_0x3f516d,_0x475107=getBotsWithMode();if(_0x475107[_0x2f6ff3(0x101)]==0x0)await sendTelegram(_0x4d6bf4[_0x2f6ff3(0x127)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x284d57=[],_0xe2374f=[];const _0x38afb1=0x2;let _0x14793d=0x0;_0x475107[_0x2f6ff3(0x251)]((_0x40c73b,_0x5f39ce)=>{const _0x32b425=_0x2f6ff3;if(_0x5f39ce%_0x38afb1==0x0)_0xe2374f=[];_0xe2374f[_0x32b425(0x173)](Markup[_0x32b425(0x27b)]['callback'](_0x32b425(0x1ff)+_0x40c73b['botID']+'\x20('+_0x40c73b[_0x32b425(0x1d9)]+')',_0x32b425(0x24e)+_0x40c73b['botID'])),_0x5f39ce%_0x38afb1==0x0&&(_0x284d57[_0x14793d]=_0xe2374f,_0x14793d++);});const _0x2f8b63=Markup[_0x2f6ff3(0x227)](_0x284d57);_0x4d6bf4[_0x2f6ff3(0x1d8)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x2f8b63);}}),tgBot[_0x3f516d(0x17f)](/toggle_(.+)/,async _0x35d672=>{const _0x254579=_0x3f516d,_0x309d0b=_0x35d672['match'][0x1];_0x35d672[_0x254579(0x15b)]();const _0x12fa74=getBotsWithMode(),_0x140cda=_0x12fa74[_0x254579(0x1c5)](_0xe939cc=>_0xe939cc[_0x254579(0x1c6)]==_0x309d0b),_0x2e102f=_0x140cda[_0x254579(0x1d9)]==_0x254579(0x2cf)?_0x254579(0x118):_0x254579(0x2cf);await sendTelegram(_0x35d672[_0x254579(0x127)]['id'],_0x254579(0x175)+_0x309d0b+_0x254579(0x2f8)+_0x2e102f+_0x254579(0x2af)),toggleBotMode(_0x309d0b);}),tgBot[_0x3f516d(0x1a1)]('names',async _0x378f74=>{const _0x1fb2c7=_0x3f516d;let _0x3bdb43='';config[_0x1fb2c7(0x251)](_0x51fb9d=>{const _0x26a3dc=_0x1fb2c7;_0x3bdb43+='Bot\x20'+_0x51fb9d[_0x26a3dc(0x1c6)]+':\x20'+_0x51fb9d[_0x26a3dc(0x243)]+'\x0a';}),await sendTelegram(_0x378f74[_0x1fb2c7(0x127)]['id'],_0x3bdb43,{'parse_mode':_0x1fb2c7(0x2f4)});}),tgBot['command']('help',async _0x51e385=>{const _0x21b2c3=_0x3f516d;await sendTelegram(_0x51e385[_0x21b2c3(0x127)]['id'],_0x3589b6);}),process[_0x3f516d(0x2e9)]('SIGINT',()=>tgBot['stop'](_0x3f516d(0x131))),process[_0x3f516d(0x2e9)](_0x3f516d(0x2b0),()=>tgBot[_0x3f516d(0x126)](_0x3f516d(0x2b0))),tgBot[_0x3f516d(0x113)]();}}function disableTelegram(){const _0x5b118c=_0x38a6a5;tgBot&&tgBot[_0x5b118c(0x126)]();}async function sendTelegram(_0x46d995,_0x1050c2,_0x5da528){const _0xea8cf0=_0x38a6a5;_0x5da528={..._0x5da528,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0xea8cf0(0x103)](_0x46d995,_0x1050c2,_0x5da528);}catch(_0x1595f5){console['log']('Telegram\x20error:',_0x1595f5);}}async function sendTelegramBot(_0x282853,_0x5b3c70){const _0x34ae1f=_0x38a6a5;if(settings[_0x34ae1f(0x2fb)]){if(settings[_0x34ae1f(0x26a)]==_0x34ae1f(0x1c0)||(_0x5b3c70['type']==_0x34ae1f(0x11d)||_0x5b3c70[_0x34ae1f(0x22b)]==_0x34ae1f(0x15e)||_0x5b3c70[_0x34ae1f(0x22b)]==_0x34ae1f(0x2bc))&&settings[_0x34ae1f(0x26a)]==_0x34ae1f(0x1d1)||_0x5b3c70[_0x34ae1f(0x22b)]==_0x34ae1f(0x1ab)&&settings[_0x34ae1f(0x26a)]==_0x34ae1f(0x27d)){if(tgBot&&settings[_0x34ae1f(0x304)]){if(_0x5b3c70['showname'])await sendTelegram(settings[_0x34ae1f(0x304)],_0x5b3c70[_0x34ae1f(0x243)]+_0x34ae1f(0x2a4)+_0x5b3c70['event']);else await sendTelegram(settings[_0x34ae1f(0x304)],_0x34ae1f(0x1ff)+_0x282853+_0x34ae1f(0x2a4)+_0x5b3c70[_0x34ae1f(0x260)]);}}}}async function sendTelegramMsg(_0x1c2114,_0x1ba7d0=_0x38a6a5(0x2f4)){const _0x2325c5=_0x38a6a5;return settings[_0x2325c5(0x2fb)]&&tgBot&&settings[_0x2325c5(0x304)]?(await sendTelegram(settings['telegramChatId'],_0x1c2114,{'parse_mode':_0x1ba7d0}),!![]):![];}function getDeviceWithIp(_0x15029d){const _0x2b5278=_0x38a6a5;return devices[_0x2b5278(0x1c5)](_0x430864=>_0x430864['ip']===_0x15029d);}async function temporaryAccess2FA(_0x2c2abf,_0x32c1f8){const _0x41677f=_0x38a6a5;let _0x5ebeec=new Date(),_0x59a5bb=![];if(lastIpApproval){if(_0x5ebeec-lastIpApproval<0x1388)_0x59a5bb=!![];}lastIpApproval=new Date();if(_0x59a5bb)return;if(tgBot&&settings['telegramChatId']){const _0x488868=uuidRandom();tmpStorage[_0x488868]={'uuid':_0x2c2abf,'externalip':_0x32c1f8};const _0x3d6275=Markup[_0x41677f(0x227)]([Markup[_0x41677f(0x27b)][_0x41677f(0x2e1)](_0x41677f(0x13f),_0x41677f(0x241)+_0x488868),Markup[_0x41677f(0x27b)]['callback']('15\x20min',_0x41677f(0x232)+_0x488868),Markup['button']['callback'](_0x41677f(0x2d9),_0x41677f(0x1f0)+_0x488868),Markup[_0x41677f(0x27b)][_0x41677f(0x2e1)](_0x41677f(0x177),_0x41677f(0x19a)+_0x488868)]);await sendTelegram(settings[_0x41677f(0x304)],_0x41677f(0x145)+normalizeIP(_0x32c1f8)['show']+'\x20?',_0x3d6275),tgBot[_0x41677f(0x17f)](/tempaccess_(.+)_(.+)/,async _0x5ddedc=>{const _0x4f2bec=_0x41677f,_0x5f0ff0=_0x5ddedc['match'][0x1],_0x1d4b2f=_0x5ddedc[_0x4f2bec(0x167)][0x2],{uuid:_0x1b56a2,externalip:_0x134ffb}=tmpStorage[_0x1d4b2f];delete tmpStorage[_0x1d4b2f],_0x5ddedc[_0x4f2bec(0x15b)](),devices[_0x1b56a2][_0x4f2bec(0x1c9)]={'clientip':_0x134ffb,'timestamp':new Date()[_0x4f2bec(0x1e6)](),'expiry':_0x5f0ff0},_0x5f0ff0!='reject'?(await sendTelegram(_0x5ddedc[_0x4f2bec(0x127)]['id'],_0x4f2bec(0x230)+_0x5f0ff0+_0x4f2bec(0x150),{'parse_mode':_0x4f2bec(0x2f4)}),io['to'](_0x1b56a2)[_0x4f2bec(0x185)](_0x4f2bec(0x20c),{'access':{'allow':![],'reason':_0x4f2bec(0x1c3),'token':null}})):(await sendTelegram(_0x5ddedc[_0x4f2bec(0x127)]['id'],_0x4f2bec(0x11b)),io['to'](_0x1b56a2)[_0x4f2bec(0x185)](_0x4f2bec(0x20c),{'access':{'allow':![],'reason':_0x4f2bec(0x200),'token':null}}));});}}async function loginAccess2FA(_0x2583b3,_0x4c4985){const _0x2c00cf=_0x38a6a5;if(tgBot&&settings[_0x2c00cf(0x304)]){const _0x5ac074=uuidRandom();tmpStorage[_0x5ac074]={'uuid':_0x2583b3,'externalip':_0x4c4985};const _0x280d11=Markup['inlineKeyboard']([Markup['button'][_0x2c00cf(0x2e1)](_0x2c00cf(0x285),_0x2c00cf(0x2ae)+loginExpiry+'_'+_0x5ac074),Markup['button'][_0x2c00cf(0x2e1)](_0x2c00cf(0x177),_0x2c00cf(0x148)+_0x5ac074)]);await sendTelegram(settings['telegramChatId'],_0x2c00cf(0x2e4)+normalizeIP(_0x4c4985)[_0x2c00cf(0x12d)]+'\x20?',_0x280d11),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x949985=>{const _0x690154=_0x2c00cf,_0x329925=_0x949985[_0x690154(0x167)][0x1],_0xa81abf=_0x949985[_0x690154(0x167)][0x2],{uuid:_0x253828,externalip:_0x4ea957}=tmpStorage[_0xa81abf];delete tmpStorage[_0xa81abf],_0x949985[_0x690154(0x15b)](),devices[_0x253828][_0x690154(0x210)]={'clientip':_0x4ea957,'timestamp':new Date()[_0x690154(0x1e6)](),'expiry':_0x329925},_0x329925!=_0x690154(0x177)?(await sendTelegram(_0x949985['chat']['id'],'Login\x20accepted',{'parse_mode':_0x690154(0x2f4)}),io['to'](_0x253828)[_0x690154(0x185)](_0x690154(0x20c),{'access':{'allow':![],'reason':_0x690154(0x1c3),'token':null}})):(await sendTelegram(_0x949985[_0x690154(0x127)]['id'],'Login\x20rejected'),io['to'](_0x253828)[_0x690154(0x185)](_0x690154(0x20c),{'access':{'allow':![],'reason':_0x690154(0x2e5),'token':null}}));});}}function _0x3515(_0x5cd4b5,_0x11f81b){const _0x2ed544=_0x4b82();return _0x3515=function(_0x454a53,_0x1f5694){_0x454a53=_0x454a53-0xff;let _0x4b82b5=_0x2ed544[_0x454a53];return _0x4b82b5;},_0x3515(_0x5cd4b5,_0x11f81b);}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4c961f=_0x38a6a5;return dbConfig[_0x4c961f(0x217)](_0x4c961f(0x2c6))[_0x4c961f(0x121)](_0x4c961f(0x1c6))[_0x4c961f(0x268)]({'status':_0x4c961f(0x290)})['value']()||[];}function getDisabledBots(){const _0x4663a1=_0x38a6a5;return dbConfig[_0x4663a1(0x217)](_0x4663a1(0x2c6))['sortBy'](_0x4663a1(0x1c6))[_0x4663a1(0x268)]({'status':_0x4663a1(0x1f6)})[_0x4663a1(0x2fd)]()||[];}function getBotAttributes(_0xbb58c4){const _0x4a78f5=_0x38a6a5;let _0x380505={};const _0x297932=configpath+_0x4a78f5(0x203)+_0xbb58c4+_0x4a78f5(0x29a),_0x18a28b=fs['existsSync'](_0x297932);if(_0x18a28b){const _0x141adb=fs[_0x4a78f5(0x10c)](_0x297932);try{const _0x11a565=JSON[_0x4a78f5(0x250)](_0x141adb),_0x4bd6a3=_0x11a565?_0x11a565[_0x4a78f5(0x2dd)][0x0]['headless']:![];_0x380505[_0x4a78f5(0x1d9)]=_0x4bd6a3?'auto':_0x4a78f5(0x118),_0x380505[_0x4a78f5(0x243)]=_0x11a565?_0x11a565[_0x4a78f5(0x2dd)][0x0]['botname']:_0x4a78f5(0x1ff)+_0xbb58c4;}catch(_0x2808d1){_0x380505[_0x4a78f5(0x1d9)]=_0x4a78f5(0x118),_0x380505[_0x4a78f5(0x243)]='Bot\x20'+_0xbb58c4;}}else _0x380505[_0x4a78f5(0x1d9)]=_0x4a78f5(0x118),_0x380505[_0x4a78f5(0x243)]='Bot\x20'+_0xbb58c4;return _0x380505;}function getBotsWithMode(){const _0x1e3f6b=_0x38a6a5,_0xd23c6b=dbConfig[_0x1e3f6b(0x217)](_0x1e3f6b(0x2c6))[_0x1e3f6b(0x121)](_0x1e3f6b(0x1c6))[_0x1e3f6b(0x2fd)]()||[];return _0xd23c6b[_0x1e3f6b(0x251)](_0x4f0180=>{const _0x500767=_0x1e3f6b;let _0x3fae00=getBotAttributes(_0x4f0180[_0x500767(0x1c6)]);_0x4f0180[_0x500767(0x1d9)]=_0x3fae00[_0x500767(0x1d9)];}),_0xd23c6b;}function getBotExchanges(){const _0xd086ce=_0x38a6a5;let _0x5ceed9=[];const _0x1e2beb=dbConfig[_0xd086ce(0x217)](_0xd086ce(0x2c6))[_0xd086ce(0x121)](_0xd086ce(0x1c6))[_0xd086ce(0x2fd)]()||[];_0x1e2beb['forEach'](_0x1d5667=>{const _0xe7b12a=_0xd086ce;if(_0x1d5667[_0xe7b12a(0x20c)]==_0xe7b12a(0x290)){const _0xbfc90=configpath+_0xe7b12a(0x203)+_0x1d5667[_0xe7b12a(0x1c6)]+'-config.json',_0xc94f2a=fs[_0xe7b12a(0x273)](_0xbfc90);let _0x3f22d9;if(_0xc94f2a){const _0x37f0ea=fs[_0xe7b12a(0x10c)](_0xbfc90);try{const _0x189217=JSON['parse'](_0x37f0ea);_0x3f22d9=_0x189217?_0x189217[_0xe7b12a(0x2dd)][0x0][_0xe7b12a(0x23e)]:null;}catch(_0x579c66){}}if(_0x3f22d9)_0x5ceed9[_0xe7b12a(0x173)](_0x3f22d9);}});const _0x500624=[...new Set(_0x5ceed9)][_0xd086ce(0x163)]();return _0x500624;}async function initUser(){const _0x30e9c0=_0x38a6a5;if(!settings[_0x30e9c0(0x2cc)]){const _0x3df68f=uuidRandom();mixpanel[_0x30e9c0(0x149)](_0x3df68f),updateSetting('userid',_0x3df68f);}}async function initSecure(){const _0x26de46=_0x38a6a5;let _0x568189=getSecure();if(!_0x568189[_0x26de46(0x2da)](_0x26de46(0x216))){let _0x2b2870=await generateKeys();_0x568189['publicKey']=_0x2b2870[_0x26de46(0x1dd)],_0x568189['privateKey']=_0x2b2870[_0x26de46(0x1bf)],_0x568189[_0x26de46(0x216)]=crypto[_0x26de46(0x18d)](0x20)[_0x26de46(0x1b0)]('hex');;storeSecure(_0x568189);}}function getSettings(){const _0x2bcbcd=_0x38a6a5;return dbSettings[_0x2bcbcd(0x217)](_0x2bcbcd(0x2d6))[_0x2bcbcd(0x2fd)]()||{};}function getSecure(){const _0x4539bd=_0x38a6a5;return dbSecure[_0x4539bd(0x217)](_0x4539bd(0x1db))[_0x4539bd(0x2fd)]()||{};}function getBlacklist(){const _0x1f1742=_0x38a6a5;return dbSecure['get'](_0x1f1742(0x2c1))[_0x1f1742(0x2fd)]()||[];}function broadcastToBots(_0x11d114,_0x2e019a){const _0x210bed=_0x38a6a5;config[_0x210bed(0x251)](_0x4339e4=>{const _0xce3acd=_0x210bed;if(_0x4339e4[_0xce3acd(0x20c)]=='enabled'&&_0x4339e4['live']==_0xce3acd(0x1c2)||_0x4339e4[_0xce3acd(0x20c)]=='new'&&_0x4339e4['live']==_0xce3acd(0x1c2)){if(pid[_0x4339e4[_0xce3acd(0x1c6)]])pid[_0x4339e4[_0xce3acd(0x1c6)]]['send']({[_0x11d114]:_0x2e019a});}});}async function storeSettings(_0x3742fe,_0x45494d=![]){const _0x3acc99=_0x38a6a5;_0x3742fe={...settings,..._0x3742fe};if(_0x45494d&&_0x3742fe['bbPassword']!=_0x3acc99(0x165)&&_0x3742fe[_0x3acc99(0x267)]!='***'&&_0x3742fe[_0x3acc99(0x267)]!=''){const _0x3c76c1=crypt[_0x3acc99(0x282)](secure[_0x3acc99(0x1bf)],_0x3742fe[_0x3acc99(0x267)])[_0x3acc99(0x1fb)]['split'](_0x3acc99(0x2aa))[0x0],_0xa8d43b=bcrypt[_0x3acc99(0x1e9)](_0x3c76c1,saltRounds);_0x3742fe={..._0x3742fe,'bbPassword':_0xa8d43b};}if(_0x45494d&&_0x3742fe[_0x3acc99(0x10f)]!='************'&&_0x3742fe[_0x3acc99(0x10f)]!=_0x3acc99(0x1b6)&&_0x3742fe[_0x3acc99(0x10f)]!=''){const _0x4a9595=crypt[_0x3acc99(0x282)](secure[_0x3acc99(0x1bf)],_0x3742fe[_0x3acc99(0x10f)])[_0x3acc99(0x1fb)][_0x3acc99(0x20b)](_0x3acc99(0x2aa))[0x0];_0x3742fe={..._0x3742fe,'telegramToken':_0x4a9595};}if(_0x45494d&&_0x3742fe['marketcapApi']!=_0x3acc99(0x165)&&_0x3742fe['marketcapApi']!=_0x3acc99(0x1b6)&&_0x3742fe['marketcapApi']!=''){const _0x40e29c=crypt[_0x3acc99(0x282)](secure[_0x3acc99(0x1bf)],_0x3742fe[_0x3acc99(0x229)])[_0x3acc99(0x1fb)][_0x3acc99(0x20b)](_0x3acc99(0x2aa))[0x0];_0x3742fe={..._0x3742fe,'marketcapApi':_0x40e29c};}const _0x4f6567=_0x3742fe['telegramToken']!=_0x3acc99(0x165)&&_0x3742fe[_0x3acc99(0x10f)]!=settings['telegramToken']||_0x3742fe[_0x3acc99(0x2b3)]!=settings['telegramUsername'],_0xd8dd=_0x3742fe[_0x3acc99(0x10f)]==''||_0x3742fe[_0x3acc99(0x2b3)]=='',_0x1e858a=_0x3742fe['marketcapApi']&&_0x3742fe['marketcapApi']!=_0x3acc99(0x165)&&_0x3742fe[_0x3acc99(0x229)]!=settings['telegramToken'];_0x4f6567&&(_0x3742fe['telegramChatId']=null,_0x3742fe['telegramEvents']=_0x3acc99(0x1c0));for(const [_0x1aa492,_0x181312]of Object[_0x3acc99(0x147)](_0x3742fe)){if(_0x1aa492==_0x3acc99(0x10f)&&_0x181312=='************'){_0x3742fe[_0x3acc99(0x10f)]=settings[_0x3acc99(0x10f)];continue;};if(_0x1aa492==_0x3acc99(0x267)&&_0x181312==_0x3acc99(0x165)){_0x3742fe[_0x3acc99(0x267)]=settings[_0x3acc99(0x267)];continue;};if(_0x1aa492==_0x3acc99(0x229)&&_0x181312==_0x3acc99(0x165)){_0x3742fe[_0x3acc99(0x229)]=settings[_0x3acc99(0x229)];continue;};dbSettings['set'](_0x3acc99(0x2cb)+_0x1aa492,_0x181312)[_0x3acc99(0x142)]();}settings=_0x3742fe,io['to'](_0x3acc99(0x2a8))['emit'](_0x3acc99(0x2d6),cleanSettings()),broadcastToBots(_0x3acc99(0x256),settings[_0x3acc99(0x256)]),broadcastToBots(_0x3acc99(0x1c1),settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x3acc99(0x229)]);if(_0x4f6567&&!_0xd8dd)initTelegram();if(_0x4f6567&&_0xd8dd)disableTelegram();getAllClients()[_0x3acc99(0x251)](_0x593fc7=>{const _0x3cc2a1=_0x3acc99;getSocket(_0x593fc7['id'])[_0x3cc2a1(0x185)](_0x3cc2a1(0x20c),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x1e858a&&(await sleep(0xbb8),testMarketcapApi(_0x3742fe[_0x3acc99(0x229)]));}async function testMarketcapApi(_0x4af727){const _0x4711e8=_0x38a6a5,_0x45038e=['BCT',_0x4711e8(0x183)];try{await axios['get']('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x4af727},'params':{'symbol':_0x45038e['toString']()}});}catch(_0x511819){_0x511819[_0x4711e8(0x1b0)]()[_0x4711e8(0x284)](_0x4711e8(0x124))?(io['to'](_0x4711e8(0x2a8))[_0x4711e8(0x185)](_0x4711e8(0x14d),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x4711e8(0x26b)](_0x4711e8(0x26e))):(io['to'](_0x4711e8(0x2a8))[_0x4711e8(0x185)](_0x4711e8(0x14d),_0x4711e8(0x172)),logger[_0x4711e8(0x26b)](_0x4711e8(0x172)),logger[_0x4711e8(0x18f)](_0x4711e8(0x222),_0x511819[_0x4711e8(0x1b0)]()+_0x4711e8(0x133)+_0x511819['code']));return;}logger[_0x4711e8(0x18f)](_0x4711e8(0x119));}function updateSetting(_0x1e1d73,_0x485bf9){const _0x53dd6e=_0x38a6a5;dbSettings[_0x53dd6e(0x29d)](_0x53dd6e(0x2cb)+_0x1e1d73,_0x485bf9)[_0x53dd6e(0x142)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x53dd6e(0x2d6),cleanSettings());}function storeSecure(_0x232184){const _0xc61c81=_0x38a6a5;dbSecure[_0xc61c81(0x217)](_0xc61c81(0x1db))['push'](_0x232184)['write'](),secure=_0x232184;}function addBlacklist(_0x54c713){const _0x5852c3=_0x38a6a5;cleanBlacklist();let _0x29b813;devices[_0x54c713][_0x5852c3(0x1c9)]?_0x29b813=Math[_0x5852c3(0x1b1)](devices[_0x54c713][_0x5852c3(0x1c9)][_0x5852c3(0x16a)],loginExpiry):_0x29b813=loginExpiry,dbSecure[_0x5852c3(0x217)](_0x5852c3(0x2c1))[_0x5852c3(0x173)]({'expiry':new Date()['getTime']()+_0x29b813*0x3c*0x3e8,'token':devices[_0x54c713][_0x5852c3(0x2bd)][_0x5852c3(0x28f)]})[_0x5852c3(0x142)](),blacklist=dbSecure[_0x5852c3(0x217)]('blacklist')[_0x5852c3(0x2fd)]();}function cleanBlacklist(){const _0x3d7393=_0x38a6a5;let _0x367f57=dbSecure[_0x3d7393(0x217)]('blacklist')[_0x3d7393(0x16f)]()[_0x3d7393(0x2fd)](),_0x39b9b2=new Date()[_0x3d7393(0x1e6)]();_0x367f57[_0x3d7393(0x251)](_0x5556dc=>{const _0x1d7b81=_0x3d7393;_0x5556dc[_0x1d7b81(0x16a)]<_0x39b9b2&&dbSecure['get'](_0x1d7b81(0x2c1))[_0x1d7b81(0x17c)]({'expiry':_0x5556dc[_0x1d7b81(0x16a)]})[_0x1d7b81(0x142)]();});}function initStates(){const _0x4d7225=_0x38a6a5;let _0x161798=getConfiguration();_0x161798[_0x4d7225(0x251)](_0x4e101f=>{const _0x2ed7dc=_0x4d7225;_0x4e101f[_0x2ed7dc(0x1d4)]=_0x2ed7dc(0x289);}),storeConfiguration(_0x161798);}function onKeys(){const _0x4c0825=new RSA();return new Promise(_0x314cd2=>{const _0x10e71e=_0x3515;_0x4c0825['generateKeyPairAsync']()[_0x10e71e(0x279)](_0x3c78d0=>{_0x314cd2(_0x3c78d0);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x44c09d=_0x38a6a5;let _0x14b169=getSettings(),_0x5683d6=![];!_0x14b169[_0x44c09d(0x2da)]('lastmsgtelegram')&&(_0x14b169[_0x44c09d(0x240)]=0x0,_0x5683d6=!![]);!_0x14b169[_0x44c09d(0x2da)](_0x44c09d(0x24c))&&(_0x14b169[_0x44c09d(0x24c)]=0x0,_0x5683d6=!![]);!_0x14b169[_0x44c09d(0x2da)](_0x44c09d(0x18c))&&(_0x14b169[_0x44c09d(0x18c)]=_0x44c09d(0x178),_0x5683d6=!![]);!_0x14b169['hasOwnProperty'](_0x44c09d(0x1c1))&&(_0x14b169[_0x44c09d(0x1c1)]=![],_0x5683d6=!![]);!_0x14b169[_0x44c09d(0x2da)](_0x44c09d(0x229))&&(_0x14b169[_0x44c09d(0x229)]='',_0x5683d6=!![]);if(_0x5683d6)storeSettings(_0x14b169);try{fs[_0x44c09d(0x176)](configbackuppath,{'withFileTypes':!![]})[_0x44c09d(0x251)](_0x2d3e75=>{const _0x472884=_0x44c09d;if(!_0x2d3e75['isDirectory']()){if(!_0x2d3e75[_0x472884(0x281)][_0x472884(0x259)](_0x472884(0x189)))fs[_0x472884(0x244)](configbackuppath+_0x2d3e75[_0x472884(0x281)]);}else fs[_0x472884(0x2bb)](configbackuppath+_0x2d3e75[_0x472884(0x281)],{'recursive':!![]});});}catch(_0x5900e5){logger['debug'](_0x44c09d(0x286),_0x5900e5);}}function storeConfiguration(_0x461d65){const _0xf6b61a=_0x38a6a5;dbConfig[_0xf6b61a(0x217)](_0xf6b61a(0x2c6))[_0xf6b61a(0x17c)]()[_0xf6b61a(0x142)](),dbConfig[_0xf6b61a(0x217)](_0xf6b61a(0x2c6))[_0xf6b61a(0x173)](..._0x461d65)[_0xf6b61a(0x142)](),config=_0x461d65;}async function resetPassword(){const _0x42177b=_0x38a6a5;if(tgBot&&settings[_0x42177b(0x304)]){const _0x2ef96f=Markup['inlineKeyboard']([Markup[_0x42177b(0x27b)][_0x42177b(0x2e1)]('yes',_0x42177b(0x10d)),Markup[_0x42177b(0x27b)][_0x42177b(0x2e1)]('no','resetpw_no')]);await sendTelegram(settings[_0x42177b(0x304)],_0x42177b(0x2a2),_0x2ef96f),tgBot[_0x42177b(0x17f)](/resetpw_(.+)/,async _0x3a23d9=>{const _0x47fa64=_0x42177b,_0x48a12c=_0x3a23d9[_0x47fa64(0x167)][0x1];_0x3a23d9[_0x47fa64(0x15b)]();if(_0x48a12c!='no'){const _0x4feb0d=0xf,_0x38e18b=_0x47fa64(0x236),_0x58e316=Array[_0x47fa64(0x2d0)](crypto[_0x47fa64(0x2f6)](new Uint32Array(_0x4feb0d)))[_0x47fa64(0x11f)](_0x292dfa=>_0x38e18b[_0x292dfa%_0x38e18b['length']])[_0x47fa64(0x14a)](''),_0x24d0a2=bcrypt[_0x47fa64(0x1e9)](_0x58e316,saltRounds);storeSettings({'bbPassword':_0x24d0a2}),await sendTelegram(_0x3a23d9[_0x47fa64(0x127)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x58e316,{'parse_mode':'HTML'});}else await sendTelegram(_0x3a23d9[_0x47fa64(0x127)]['id'],_0x47fa64(0x1ba));});}}async function confirmRestore(_0x17feba,_0x37ca7d){const _0x2c8126=_0x38a6a5;io['to']('botmanager')[_0x2c8126(0x185)](_0x2c8126(0x14d),_0x2c8126(0x226),_0x2c8126(0x2bc));if(tgBot&&settings[_0x2c8126(0x304)]){const _0x26ce43=uuidRandom();tmpStorage[_0x26ce43]={'path':_0x17feba,'filename':_0x37ca7d};const _0x481b21=Markup[_0x2c8126(0x227)]([Markup[_0x2c8126(0x27b)][_0x2c8126(0x2e1)](_0x2c8126(0x2d7),'restore_yes_'+_0x26ce43),Markup[_0x2c8126(0x27b)][_0x2c8126(0x2e1)]('no',_0x2c8126(0x22e)+_0x26ce43)]);await sendTelegram(settings['telegramChatId'],_0x2c8126(0x2d5),_0x481b21),tgBot[_0x2c8126(0x17f)](/restore_(.+)_(.+)/,async _0x40880e=>{const _0x1da321=_0x2c8126,_0x3f26a2=_0x40880e[_0x1da321(0x167)][0x1],_0x4d1ecf=_0x40880e[_0x1da321(0x167)][0x2],{path:_0x3bcff8,filename:_0x2cab65}=tmpStorage[_0x4d1ecf];delete tmpStorage[_0x4d1ecf],_0x40880e[_0x1da321(0x15b)](),_0x3f26a2==_0x1da321(0x2d7)?(logger[_0x1da321(0x18f)](_0x1da321(0x19f)),await sendTelegram(_0x40880e[_0x1da321(0x127)]['id'],_0x1da321(0x1f8),{'parse_mode':_0x1da321(0x2f4)}),unzipFile(_0x3bcff8,_0x2cab65)):(logger[_0x1da321(0x18f)]('Restore\x20process\x20aborted'),await sendTelegram(_0x40880e[_0x1da321(0x127)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x284c8b=_0x38a6a5,_0x575f8a=new Date();return _0x575f8a[_0x284c8b(0x2a7)]()+'/'+(_0x575f8a['getMonth']()+0x1)['toString']()[_0x284c8b(0x161)](0x2,'0')+'/'+_0x575f8a[_0x284c8b(0x2c5)]()[_0x284c8b(0x1b0)]()['padStart'](0x2,'0')+'\x20'+_0x575f8a[_0x284c8b(0x1f3)]()[_0x284c8b(0x1b0)]()[_0x284c8b(0x161)](0x2,'0')+':'+_0x575f8a[_0x284c8b(0x215)]()[_0x284c8b(0x1b0)]()[_0x284c8b(0x161)](0x2,'0')+':'+_0x575f8a['getSeconds']()[_0x284c8b(0x1b0)]()[_0x284c8b(0x161)](0x2,'0');}function getTimeStamp(){const _0x21c6a5=_0x38a6a5,_0x3b2ed3=shiftedTime();return _0x3b2ed3[_0x21c6a5(0x2a7)]()+'/'+(_0x3b2ed3['getMonth']()+0x1)[_0x21c6a5(0x1b0)]()[_0x21c6a5(0x161)](0x2,'0')+'/'+_0x3b2ed3['getDate']()[_0x21c6a5(0x1b0)]()[_0x21c6a5(0x161)](0x2,'0')+'\x20'+_0x3b2ed3[_0x21c6a5(0x1f3)]()['toString']()[_0x21c6a5(0x161)](0x2,'0')+':'+_0x3b2ed3[_0x21c6a5(0x215)]()[_0x21c6a5(0x1b0)]()[_0x21c6a5(0x161)](0x2,'0')+':'+_0x3b2ed3['getSeconds']()[_0x21c6a5(0x1b0)]()[_0x21c6a5(0x161)](0x2,'0');}function getCleanTimeStamp(){const _0x4af038=_0x38a6a5,_0x206803=shiftedTime();return _0x206803[_0x4af038(0x2a7)]()+(_0x206803[_0x4af038(0x2f0)]()+0x1)[_0x4af038(0x1b0)]()[_0x4af038(0x161)](0x2,'0')+_0x206803['getDate']()['toString']()['padStart'](0x2,'0')+'-'+_0x206803[_0x4af038(0x1f3)]()['toString']()['padStart'](0x2,'0')+_0x206803['getMinutes']()[_0x4af038(0x1b0)]()[_0x4af038(0x161)](0x2,'0')+_0x206803[_0x4af038(0x1a5)]()[_0x4af038(0x1b0)]()[_0x4af038(0x161)](0x2,'0');}function shiftedTime(){const _0x55682a=_0x38a6a5,_0x75546c=new Date();let _0x1c3345=_0x75546c;if(settings['timeshift']&&settings[_0x55682a(0x256)]!==0x0)_0x1c3345=fns[_0x55682a(0x196)](_0x75546c,{'hours':settings['timeshift']});return _0x1c3345;}async function startScheduler(){const _0x431d1e=_0x38a6a5,_0xacbb4f=new Date()['getUTCHours'](),_0x1d8f5e=shiftedTime()[_0x431d1e(0x1f3)]();_0x1d8f5e==0x4&&backupConfigFiles(),_0x1d8f5e==0x0&&rotateLogFiles(),_0xacbb4f%0x6==0x0&&triggerAnalytics(),_0xacbb4f%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x3fa889){const _0x359ba3=_0x38a6a5;logger['debug'](_0x359ba3(0x1bd)+_0x3fa889);const _0x2a7602=getBotsWithMode();_0x2a7602[_0x359ba3(0x101)]>0x0?confirmRestore(configbackuppath,_0x3fa889):unzipFile(configbackuppath,_0x3fa889);}async function getBackupFiles(_0x3f891b=null){const _0x489307=_0x38a6a5;let _0x173804=[],_0x1dc375=fs[_0x489307(0x176)](configbackuppath,{'withFileTypes':!![]});_0x1dc375[_0x489307(0x163)]((_0x1561ac,_0x375aee)=>_0x1561ac[_0x489307(0x281)]<_0x375aee['name']?0x1:_0x375aee[_0x489307(0x281)]<_0x1561ac[_0x489307(0x281)]?-0x1:0x0),_0x1dc375[_0x489307(0x251)](_0x5ec01c=>{const _0x34468c=_0x489307;if(!_0x5ec01c[_0x34468c(0x252)]()&&_0x5ec01c['name'][_0x34468c(0x259)](_0x34468c(0x189))&&_0x5ec01c[_0x34468c(0x281)][_0x34468c(0x21c)](_0x34468c(0x1fc))){const _0x3c958b=formatDate(fs[_0x34468c(0x275)](configbackuppath+_0x5ec01c[_0x34468c(0x281)])[_0x34468c(0x141)]);_0x173804[_0x34468c(0x173)]({'name':_0x5ec01c[_0x34468c(0x281)],'mtime':_0x3c958b});}});if(_0x3f891b)io['to'](_0x3f891b)[_0x489307(0x185)](_0x489307(0x2a5),_0x173804);else return _0x173804;}async function backupConfigFiles(){const _0x25c38f=_0x38a6a5;await zipFiles(_0x25c38f(0xff));const _0x2cb046=getCleanTimeStamp();fs[_0x25c38f(0x206)](zippath+'backup-full.zip',configbackuppath+(_0x25c38f(0x189)+_0x2cb046+'.zip'));let _0x4c1692=fs[_0x25c38f(0x176)](configbackuppath,{'withFileTypes':!![]});_0x4c1692['sort']((_0x5a472b,_0x446bd7)=>_0x5a472b[_0x25c38f(0x281)]<_0x446bd7[_0x25c38f(0x281)]?0x1:_0x446bd7['name']<_0x5a472b[_0x25c38f(0x281)]?-0x1:0x0),_0x4c1692[_0x25c38f(0x101)]>maxBackups&&fs[_0x25c38f(0x244)](configbackuppath+_0x4c1692[_0x4c1692['length']-0x1][_0x25c38f(0x281)]);}function rotateLogFiles(){const _0x2ed334=_0x38a6a5,_0x586f13=fs[_0x2ed334(0x275)](logspath+_0x2ed334(0x2c7)),_0x59e697=_0x586f13[_0x2ed334(0x21f)]/0x400;if(_0x59e697>0x64){let _0x19730b=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x19730b[_0x2ed334(0x163)]((_0x2bc662,_0x16a094)=>_0x2bc662[_0x2ed334(0x281)]<_0x16a094['name']?0x1:_0x16a094['name']<_0x2bc662[_0x2ed334(0x281)]?-0x1:0x0),_0x19730b[_0x2ed334(0x251)](_0x46da17=>{const _0x4c09dc=_0x2ed334;if(_0x46da17[_0x4c09dc(0x281)]==_0x4c09dc(0x10a))fs['copyFileSync'](logspath+_0x46da17['name'],logspath+_0x4c09dc(0x21d));if(_0x46da17[_0x4c09dc(0x281)]==_0x4c09dc(0x234))fs[_0x4c09dc(0x206)](logspath+_0x46da17[_0x4c09dc(0x281)],logspath+_0x4c09dc(0x10a));_0x46da17['name']==_0x4c09dc(0x2c7)&&(fs[_0x4c09dc(0x206)](logspath+_0x46da17[_0x4c09dc(0x281)],logspath+'output-001.log'),fs[_0x4c09dc(0x195)](logspath+_0x46da17[_0x4c09dc(0x281)],''));});}}async function zipFiles(_0x5b8dd5){const _0x64242e=_0x38a6a5;let _0xe05442;if(_0x5b8dd5=='logs')_0xe05442=logspath;if(_0x5b8dd5=='backup')_0xe05442=configpath;if(_0x5b8dd5==_0x64242e(0xff))_0xe05442=configpath;let _0xded427=fs[_0x64242e(0x176)](_0xe05442,{'withFileTypes':!![]});const _0x4231fa=new require(_0x64242e(0x2c2))();_0xded427['forEach'](_0x4eac2f=>{const _0x23a319=_0x64242e;if(!_0x4eac2f['isDirectory']()){let _0x3e1824=fs[_0x23a319(0x10c)](_0xe05442+_0x4eac2f[_0x23a319(0x281)]);if(_0x5b8dd5==_0x23a319(0x2f5)){const _0x249cb4=/^bot-[0-9]{3}-config.json$/,_0x532c10=_0x249cb4[_0x23a319(0x157)](_0x4eac2f[_0x23a319(0x281)]);if(_0x532c10){const _0xfa3c06=JSON[_0x23a319(0x250)](_0x3e1824);if(_0xfa3c06[_0x23a319(0x2dd)][0x0]){_0xfa3c06[_0x23a319(0x2dd)][0x0]['apiKey']=_0x23a319(0x1b6),_0xfa3c06[_0x23a319(0x2dd)][0x0]['apiSecret']='***';if(_0xfa3c06[_0x23a319(0x2dd)][0x0]['apiPassword'])_0xfa3c06['bot'][0x0][_0x23a319(0x1a8)]=_0x23a319(0x1b6);}_0x3e1824=JSON[_0x23a319(0x257)](_0xfa3c06,null,0x2);}if(_0x4eac2f['name']==_0x23a319(0x1ef)){const _0x42c797=JSON[_0x23a319(0x250)](_0x3e1824);if(_0x42c797['settings']['loginRequired'])_0x42c797[_0x23a319(0x2d6)][_0x23a319(0x219)]=![];if(_0x42c797['settings'][_0x23a319(0x267)])_0x42c797[_0x23a319(0x2d6)]['bbPassword']=_0x23a319(0x1b6);if(_0x42c797[_0x23a319(0x2d6)][_0x23a319(0x10f)])_0x42c797[_0x23a319(0x2d6)][_0x23a319(0x10f)]=_0x23a319(0x1b6);if(_0x42c797['settings'][_0x23a319(0x304)])_0x42c797[_0x23a319(0x2d6)][_0x23a319(0x304)]=null;if(_0x42c797['settings'][_0x23a319(0x229)])_0x42c797['settings'][_0x23a319(0x229)]=_0x23a319(0x1b6);_0x3e1824=JSON[_0x23a319(0x257)](_0x42c797,null,0x2);}if(_0x4eac2f['name']!='bb-secure.json')_0x4231fa[_0x23a319(0x2de)](_0x4eac2f[_0x23a319(0x281)],_0x3e1824);}else _0x4231fa[_0x23a319(0x2de)](_0x4eac2f[_0x23a319(0x281)],_0x3e1824);}});const _0x5c3759=_0x4231fa['generate']({'base64':![],'compression':_0x64242e(0x26c)});fs[_0x64242e(0x195)](zippath+(_0x5b8dd5+_0x64242e(0x1fc)),_0x5c3759,_0x64242e(0x208));}async function unzipFile(_0x1818f7,_0x2c0ca3){const _0x4633ee=_0x38a6a5;fs[_0x4633ee(0x176)](configpath,{'withFileTypes':!![]})[_0x4633ee(0x251)](_0x547946=>{const _0x523fd5=_0x4633ee;if(!_0x547946[_0x523fd5(0x252)]())fs[_0x523fd5(0x2bb)](configpath+_0x547946['name']);});const _0x57d0a0=fs[_0x4633ee(0x10c)](_0x1818f7+_0x2c0ca3,_0x4633ee(0x208)),_0x2868e8=new require(_0x4633ee(0x2c2))(_0x57d0a0,{'base64':![],'checkCRC32':!![]});Object[_0x4633ee(0x129)](_0x2868e8[_0x4633ee(0x21e)])[_0x4633ee(0x251)](_0x169cda=>{const _0x180105=_0x4633ee,_0x3aea0c=_0x2868e8[_0x180105(0x21e)][_0x169cda];fs[_0x180105(0x195)](configpath+_0x3aea0c[_0x180105(0x281)],_0x3aea0c[_0x180105(0x1d7)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x4633ee(0x251)](_0x3b1062=>{if(!_0x3b1062['isDirectory']())fs['rmSync'](temppath+_0x3b1062['name']);}),logger['debug'](_0x4633ee(0x153)),process['send']({'restore':!![]},_0x1d0cf9=>{});}async function getPublicIp(){const _0x982d82=_0x38a6a5;try{const _0x26b3fc=await axios[_0x982d82(0x217)]('https://api.ipify.org?format=json');publicip=_0x26b3fc[_0x982d82(0x2fc)]['ip'];}catch(_0x326dc5){}}async function triggerAnalytics(){const _0x5d28cb=_0x38a6a5;if(!publicip)await getPublicIp();const _0x50d352=getBotsWithMode();let _0xfe9546=0x0;_0x50d352[_0x5d28cb(0x251)](_0x5726e6=>{const _0x13b725=_0x5d28cb;if(_0x5726e6[_0x13b725(0x20c)]===_0x13b725(0x290))_0xfe9546++;});const _0x42fe83=getBotExchanges();mixpanel[_0x5d28cb(0x109)](_0x5d28cb(0x107),{'distinct_id':settings[_0x5d28cb(0x2cc)],'ip':publicip,'version':serverversion,'numbots':_0x50d352[_0x5d28cb(0x101)],'numbotsenabled':_0xfe9546,'exchanges':_0x42fe83,'environment':environment});}async function getMessages(){const _0x3f472d=_0x38a6a5,_0x5e8c20='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4ec406=new GraphQLClient(_0x5e8c20),_0x36cd21={'authorization':_0x3f472d(0x1d5)},_0x279d90=serverversion['split']('.'),_0x2a20ee=_0x279d90[0x0]+'.'+_0x279d90[0x1],_0x11a54b=Math[_0x3f472d(0x223)](settings[_0x3f472d(0x240)],settings[_0x3f472d(0x24c)]),_0x41fbf7={'last':parseInt(_0x11a54b),'bbm':_0x2a20ee},_0x4955f7=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4ee2f8;try{_0x4ee2f8=await _0x4ec406['request'](_0x4955f7,_0x41fbf7,_0x36cd21);}catch(_0x26834c){}if(_0x4ee2f8&&_0x4ee2f8[_0x3f472d(0x220)]){let _0x4db0b9=settings['lastmsgtelegram'];newMessages=[];for(const _0x504d8f of _0x4ee2f8[_0x3f472d(0x220)]){newMessages[_0x3f472d(0x173)](_0x504d8f);let _0x209588=![];_0x504d8f[_0x3f472d(0x254)]&&(updateSetting('latestversion',_0x504d8f[_0x3f472d(0x254)]),_0x209588=isNewerVersion(serverversion,_0x504d8f[_0x3f472d(0x254)])||serverversion==_0x504d8f[_0x3f472d(0x254)]);if(!_0x209588&&_0x504d8f[_0x3f472d(0x211)]>_0x4db0b9){if(_0x504d8f[_0x3f472d(0x11e)]===_0x3f472d(0x1e7)||serverversion[_0x3f472d(0x259)](_0x504d8f[_0x3f472d(0x11e)])){let _0x51a5d6=''+_0x504d8f[_0x3f472d(0x128)]+'\x0a\x0a'+_0x504d8f[_0x3f472d(0x1fb)];const _0x380d0b=await sendTelegramMsg(toTelegramMarkdown(_0x51a5d6),_0x3f472d(0x26f));if(_0x380d0b)_0x4db0b9=_0x504d8f[_0x3f472d(0x211)];}}}updateAvailable=isNewerVersion(settings[_0x3f472d(0x18c)],serverversion),updateSetting('lastmsgtelegram',_0x4db0b9),emitMessages();}}function emitMessages(){const _0x1d9ced=_0x38a6a5,_0x2d45ea=settings[_0x1d9ced(0x24c)];let _0x1a481f=[];newMessages[_0x1d9ced(0x251)](_0x471dfd=>{const _0x423b2e=_0x1d9ced;_0x471dfd[_0x423b2e(0x211)]>_0x2d45ea&&_0x1a481f[_0x423b2e(0x173)](_0x471dfd);}),_0x1a481f['length']>0x0&&getAllClients()['forEach'](_0x54a72e=>{const _0x5c1632=_0x1d9ced;getSocket(_0x54a72e['id'])[_0x5c1632(0x185)]('message',_0x1a481f);});}function confirmMessage(_0x3a9ca8){updateSetting('lastmsgemitted',Number(_0x3a9ca8));}function isNewerVersion(_0x2881d5,_0x211347){const _0x2ad503=_0x38a6a5,_0x4a2ae9=_0x211347['split']('.'),_0x4820d0=_0x2881d5[_0x2ad503(0x20b)]('.');for(var _0xb1be34=0x0;_0xb1be34<_0x4820d0[_0x2ad503(0x101)];_0xb1be34++){const _0xa63bf2=~~_0x4820d0[_0xb1be34],_0x6caddf=~~_0x4a2ae9[_0xb1be34];if(_0xa63bf2>_0x6caddf)return!![];if(_0xa63bf2<_0x6caddf)return![];}return![];}function toTelegramMarkdown(_0x964507){const _0x55c760=_0x38a6a5,_0x5180a1=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x44f0b1=/\*{2}(.+?)\*{2}/gim;return _0x964507=_0x964507[_0x55c760(0x228)](_0x5180a1,_0x55c760(0x277))[_0x55c760(0x228)](_0x44f0b1,'*$1*'),_0x964507;}async function validateConfigFile(){const _0x5c5b93=_0x38a6a5,_0x4de2f3=dbConfig['get']('bots')[_0x5c5b93(0x121)]('botID')['value']()||[];if(_0x4de2f3['length']==0x0){let _0x40ff8d=0x0,_0x3a6ac7=[];const _0x3d52fc=/^bot-([0-9]{3})-config.json$/,_0x445371=fs[_0x5c5b93(0x176)](configpath);_0x445371[_0x5c5b93(0x251)](_0x5f390c=>{const _0x3fb82a=_0x5c5b93,_0x351923=_0x3d52fc[_0x3fb82a(0x2f1)](_0x5f390c);if(_0x351923){const _0x53b395=_0x351923[0x1];let _0x573754=getBotAttributes(_0x53b395);_0x3a6ac7[_0x3fb82a(0x173)]({'botID':_0x53b395,'botname':_0x573754[_0x3fb82a(0x243)],'status':_0x3fb82a(0x1f6),'live':_0x3fb82a(0x289)}),_0x40ff8d++;}}),_0x40ff8d!=0x0&&(dbConfig[_0x5c5b93(0x217)]('bots')[_0x5c5b93(0x17e)](_0x3a6ac7)['write'](),config=_0x3a6ac7,restoredConfigFile=_0x40ff8d);}}async function restoreConfigNotify(_0x4b67ff){const _0x583d0a=_0x38a6a5;let _0x4683e4;if(restoredConfigFile==0x1)_0x4683e4=_0x583d0a(0x22c);else _0x4683e4=_0x583d0a(0x23c);if(_0x4b67ff)io['to']('botmanager')[_0x583d0a(0x185)](_0x583d0a(0x14d),_0x4683e4);else{logger['simple'](_0x583d0a(0x300)),logger[_0x583d0a(0x180)](_0x4683e4),logger['simple'](_0x583d0a(0x300)),logger['simple']('');if(tgBot&&settings[_0x583d0a(0x304)]&&settings[_0x583d0a(0x26a)]!=_0x583d0a(0x27d))await sendTelegram(settings[_0x583d0a(0x304)],_0x583d0a(0x12e)+_0x4683e4);}}function validateCredentials(_0x3bdab0,_0x238dc7){const _0x576a58=_0x38a6a5;if(_0x3bdab0[_0x576a58(0x13d)]==settings[_0x576a58(0x2db)]&&bcrypt[_0x576a58(0x303)](_0x3bdab0[_0x576a58(0x122)],settings[_0x576a58(0x267)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x576a58(0x2d1),'token':null};else{const _0x54c934=generateLoginToken(_0x238dc7);return{'allow':!![],'reason':_0x576a58(0x25a),'token':_0x54c934};}}else return{'allow':![],'reason':_0x576a58(0x15c),'token':null};}function refreshToken(_0x3889dc){const _0x1aad47=_0x38a6a5,_0x24fc75=generateLoginToken(_0x3889dc);return{'allow':!![],'reason':_0x1aad47(0x25a),'token':_0x24fc75};}function validateAccess(_0x274990,_0x2828d7,_0x2fc4d7){const _0x3bb873=_0x38a6a5,_0x5cad75=_0x2fc4d7?_0x2fc4d7:devices[_0x2828d7]['ip'];let _0x205e15;const _0xd44ff4=_0x480a21=>{const _0xa88bf7=_0x3515;if(settings[_0xa88bf7(0x219)]){if(settings[_0xa88bf7(0x24f)]){if(telegram2FaApproved(_0x2828d7)){const _0x3cf18a=generateLoginToken(_0x2828d7);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x3cf18a};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x205e15=validToken(_0x480a21,_0x2828d7),_0x205e15['hasOwnProperty'](_0xa88bf7(0x2bc))?{'allow':!![],'reason':_0xa88bf7(0x1ad),'token':_0x480a21}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0xa88bf7(0x184),'token':null};};if(settings['whitelistEnabled']){let _0x412033=[...settings['whitelist'],_0x3bb873(0x194),_0x3bb873(0x140),'127.0.0.1'];if(_0x412033[_0x3bb873(0x284)](_0x5cad75))return _0xd44ff4(_0x274990);else{_0x205e15=validToken(_0x274990,_0x2828d7);if(_0x205e15[_0x3bb873(0x2da)](_0x3bb873(0x2bc)))return _0xd44ff4(_0x274990);else{if(telegramIpApproved(_0x2828d7)){const _0x3349d3=generateToken(_0x2828d7);return _0x205e15=_0xd44ff4(_0x274990),_0x205e15[_0x3bb873(0x2e0)]?{'allow':!![],'reason':_0x3bb873(0x266),'token':_0x3349d3}:_0x205e15;}else return settings[_0x3bb873(0x27e)]?{'allow':![],'reason':_0x3bb873(0x199),'token':null}:{'allow':![],'reason':_0x3bb873(0x255),'token':null};}}}else return _0xd44ff4(_0x274990);}function timelyDecrypt(_0x36cbd6,_0x4c8094,_0x51112e='@'){const _0x1f0147=_0x38a6a5;if(_0x36cbd6)try{const _0x4b028c=crypt['decrypt'](secure['privateKey'],_0x36cbd6)['message'],_0x5ca647=_0x4b028c['split'](_0x51112e)[0x0],_0x16d5df=_0x4b028c[_0x1f0147(0x20b)](_0x51112e)[0x1],_0x5cdc86=new Date()['getTime']();if(_0x4c8094){if(_0x5cdc86-_0x16d5df<maxSecretAge*0x3e8)return _0x5ca647;else return![];}else return _0x5ca647;}catch(_0x1856d0){return![];}else return![];}const validToken=(_0x43c47b,_0x5dfc50)=>{const _0x4f8efa=_0x38a6a5,_0x56487b=devices[_0x5dfc50]['ip'];if(!_0x43c47b)return{'error':'No\x20authentication\x20token'};for(let _0x587fc6 of blacklist){if(_0x587fc6[_0x4f8efa(0x28f)]==_0x43c47b)return{'error':_0x4f8efa(0x190)};}let _0x54eb0f;try{_0x54eb0f=jwt[_0x4f8efa(0x2b9)](_0x43c47b,secure[_0x4f8efa(0x216)]+_0x5dfc50);}catch{return{'error':_0x4f8efa(0x2b8)};}if(!_0x54eb0f[_0x4f8efa(0x2da)](_0x4f8efa(0x1e2))&&!_0x54eb0f['hasOwnProperty']('username')||!_0x54eb0f[_0x4f8efa(0x2da)](_0x4f8efa(0x201)))return{'error':_0x4f8efa(0x26d)};if(!_0x54eb0f['hasOwnProperty']('username')&&_0x54eb0f[_0x4f8efa(0x2da)](_0x4f8efa(0x1e2))){const {clientip:_0x42aed9}=_0x54eb0f;return _0x56487b==_0x42aed9?{'success':_0x4f8efa(0x2ec)}:{'error':_0x4f8efa(0x1de)};}else{if(_0x54eb0f['hasOwnProperty'](_0x4f8efa(0x13d))&&_0x54eb0f[_0x4f8efa(0x2da)](_0x4f8efa(0x1e2))){const {username:_0x1b11b9,clientip:_0x549961}=_0x54eb0f;return settings['bbUsername']==_0x1b11b9&&_0x56487b==_0x549961?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x43b28e=>{const _0x3319d8=_0x38a6a5;if(_0x43b28e){const _0x33c7bc=devices[_0x43b28e]['ip'];return jwt[_0x3319d8(0x238)]({'username':settings[_0x3319d8(0x2db)],'clientip':_0x33c7bc},secure[_0x3319d8(0x216)]+_0x43b28e,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x14403d=>{const _0x122376=_0x38a6a5;if(_0x14403d){const _0x4790db=devices[_0x14403d]['ip'];return jwt['sign']({'clientip':_0x4790db},secure[_0x122376(0x216)]+_0x14403d,{'expiresIn':devices[_0x14403d]['telegramIpApproval'][_0x122376(0x16a)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3e40a5=>{const _0x43609f=_0x38a6a5;let _0x171033=![];return devices[_0x3e40a5][_0x43609f(0x1c9)]&&devices[_0x3e40a5][_0x43609f(0x1c9)]['expiry']!=_0x43609f(0x177)&&(_0x171033=devices[_0x3e40a5]['telegramIpApproval'][_0x43609f(0x1e2)]==devices[_0x3e40a5]['ip']&&new Date()[_0x43609f(0x1e6)]()-devices[_0x3e40a5][_0x43609f(0x1c9)][_0x43609f(0x27f)]<devices[_0x3e40a5][_0x43609f(0x1c9)][_0x43609f(0x16a)]*0x3c*0x3e8),_0x171033;},telegram2FaApproved=_0x26ccff=>{const _0x108512=_0x38a6a5;let _0x50078d=![];return devices[_0x26ccff][_0x108512(0x210)]&&devices[_0x26ccff]['telegram2FaApproval'][_0x108512(0x16a)]!=_0x108512(0x177)&&(_0x50078d=devices[_0x26ccff][_0x108512(0x210)][_0x108512(0x1e2)]==devices[_0x26ccff]['ip']&&new Date()['getTime']()-devices[_0x26ccff][_0x108512(0x210)][_0x108512(0x27f)]<devices[_0x26ccff]['telegram2FaApproval'][_0x108512(0x16a)]*0x3c*0x3e8),_0x50078d;},normalizeIP=_0x38cc6e=>{const _0x7dbbea=_0x38a6a5;let _0x50d284=null,_0x2adb8f=null;if(ipaddr['isValid'](_0x38cc6e)){const _0x37ec22=ipaddr[_0x7dbbea(0x250)](_0x38cc6e);_0x37ec22['kind']()===_0x7dbbea(0x179)?(_0x37ec22['isIPv4MappedAddress']()&&(_0x50d284=_0x37ec22[_0x7dbbea(0x1a3)]()[_0x7dbbea(0x1b0)]()),_0x2adb8f=_0x37ec22['toString']()):(_0x50d284=_0x37ec22['toString'](),_0x2adb8f=_0x37ec22['toIPv4MappedAddress']()[_0x7dbbea(0x1b0)]());}return{'show':_0x50d284?_0x50d284:_0x2adb8f,'store':_0x2adb8f};};function formatDate(_0x350e63){const _0x417ade=_0x38a6a5;return _0x350e63[_0x417ade(0x2a7)]()+'/'+(_0x350e63[_0x417ade(0x2f0)]()+0x1)[_0x417ade(0x1b0)]()[_0x417ade(0x161)](0x2,'0')+'/'+_0x350e63[_0x417ade(0x2c5)]()[_0x417ade(0x1b0)]()[_0x417ade(0x161)](0x2,'0')+'\x20'+_0x350e63['getHours']()[_0x417ade(0x1b0)]()[_0x417ade(0x161)](0x2,'0')+':'+_0x350e63[_0x417ade(0x215)]()[_0x417ade(0x1b0)]()[_0x417ade(0x161)](0x2,'0')+':'+_0x350e63[_0x417ade(0x1a5)]()[_0x417ade(0x1b0)]()['padStart'](0x2,'0');}function sleep(_0x42687f){return new Promise(_0x482c5e=>setTimeout(_0x482c5e,_0x42687f));}