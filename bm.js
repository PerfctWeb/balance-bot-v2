const _0x30df4d=_0x5805;(function(_0x2defcd,_0x14772a){const _0x18ee77=_0x5805,_0x2253e6=_0x2defcd();while(!![]){try{const _0x317601=parseInt(_0x18ee77(0x25b))/0x1+parseInt(_0x18ee77(0xcb))/0x2+parseInt(_0x18ee77(0x1c1))/0x3*(-parseInt(_0x18ee77(0xc8))/0x4)+-parseInt(_0x18ee77(0x155))/0x5*(-parseInt(_0x18ee77(0xef))/0x6)+-parseInt(_0x18ee77(0x1e3))/0x7+-parseInt(_0x18ee77(0xae))/0x8+parseInt(_0x18ee77(0x15d))/0x9;if(_0x317601===_0x14772a)break;else _0x2253e6['push'](_0x2253e6['shift']());}catch(_0x31e771){_0x2253e6['push'](_0x2253e6['shift']());}}}(_0x4c9d,0x1dac1));const _0x4784cd=function(){let _0x56bed4=!![];return function(_0x24a3ff,_0x15e219){const _0x3a0a73=_0x56bed4?function(){const _0xf5bf3=_0x5805;if(_0x15e219){const _0x100cfb=_0x15e219[_0xf5bf3(0x14f)](_0x24a3ff,arguments);return _0x15e219=null,_0x100cfb;}}:function(){};return _0x56bed4=![],_0x3a0a73;};}(),_0x2a9a4a=_0x4784cd(this,function(){const _0x34d71b=_0x5805;return _0x2a9a4a[_0x34d71b(0x1af)]()[_0x34d71b(0x84)](_0x34d71b(0xcf))['toString']()['constructor'](_0x2a9a4a)['search'](_0x34d71b(0xcf));});function _0x5805(_0x32c71b,_0x34b1b4){const _0x3ed3a4=_0x4c9d();return _0x5805=function(_0x2a9a4a,_0x4784cd){_0x2a9a4a=_0x2a9a4a-0x6f;let _0x4c9d8d=_0x3ed3a4[_0x2a9a4a];return _0x4c9d8d;},_0x5805(_0x32c71b,_0x34b1b4);}_0x2a9a4a();'use strict';process[_0x30df4d(0x1b2)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x30df4d(0x204)),fs=require('fs'),fns=require(_0x30df4d(0x1ed)),low=require(_0x30df4d(0x1cf)),FileSync=require(_0x30df4d(0xb4)),path=require('path'),crypto=require(_0x30df4d(0x236)),Crypt=require('hybrid-crypto-js')[_0x30df4d(0x1b4)],RSA=require(_0x30df4d(0x162))[_0x30df4d(0xe5)],bcrypt=require(_0x30df4d(0xeb)),jwt=require(_0x30df4d(0x255)),ipaddr=require(_0x30df4d(0xa8)),argv=require(_0x30df4d(0x1ac))(process[_0x30df4d(0xd7)]['slice'](0x2))[_0x30df4d(0xd7)],uuidRandom=require(_0x30df4d(0x12d)),TelegramBot=require(_0x30df4d(0x1fa)),Mixpanel=require(_0x30df4d(0x140)),axios=require(_0x30df4d(0x232)),{GraphQLClient,gql}=require(_0x30df4d(0x244)),util=require(_0x30df4d(0x245)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x30df4d(0x7d)]||_0x30df4d(0x190),pattern=/^[0-9]{2,4}$/;!pattern[_0x30df4d(0x227)](PORT)&&(console[_0x30df4d(0x197)](_0x30df4d(0x126)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x30df4d(0x148)](0x1));const HOST=argv[_0x30df4d(0xdd)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x30df4d(0xf0)][_0x30df4d(0x137)];let bbpath=_0x30df4d(0x105),bbpath2='';const botfile='bot.js',configfile=_0x30df4d(0x1a3),settingsfile=_0x30df4d(0x1be),securefile=_0x30df4d(0xaf),environment=require('./'+bbpath2+_0x30df4d(0x12b))[_0x30df4d(0x1e6)]||_0x30df4d(0x13a),maxBackups=0xa;let validInstallation=!![];!fs[_0x30df4d(0x16d)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x30df4d(0x22d)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x30df4d(0xba),configbackuppath=configpath+_0x30df4d(0xb7),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x30df4d(0xea),zippath=userID?bbpath+_0x30df4d(0x1de)+userID+'/':bbpath+_0x30df4d(0x1de),loggerfile=fs[_0x30df4d(0x184)](logspath+_0x30df4d(0x252),{'flags':'a'}),temppath=userID?bbpath+_0x30df4d(0x247)+userID+'/':bbpath+_0x30df4d(0x247);!fs[_0x30df4d(0x16d)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x30df4d(0x16d)](configbackuppath)&&fs[_0x30df4d(0x9d)](configbackuppath);!fs[_0x30df4d(0x16d)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x30df4d(0x16d)](zippath)&&fs[_0x30df4d(0x9d)](zippath);!fs[_0x30df4d(0x16d)](temppath)&&fs[_0x30df4d(0x9d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x30df4d(0x1b6)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x30df4d(0x201)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x30df4d(0x192),'onepagemode':![]}})[_0x30df4d(0x1b6)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x30df4d(0x201)]({'secure':{},'blacklist':[]})[_0x30df4d(0x1b6)]();let crypt=new Crypt({'md':_0x30df4d(0x1f5),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x30df4d(0x1bc)](_0x30df4d(0x11b),{'host':_0x30df4d(0x133)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x30df4d(0x23b)]!=''&&settings['telegramUsername']&&settings[_0x30df4d(0x21d)]!='')initTelegram();const parseColor=(_0x3cba3a,_0x300be2)=>{const _0x374c84=_0x30df4d,_0x321e40=/#[A-Z]{3}#/g;if(typeof _0x3cba3a=='string'){!_0x300be2?_0x3cba3a=_0x3cba3a[_0x374c84(0xd9)](_0x321e40,''):(_0x3cba3a=_0x3cba3a['replace'](/#BLU#/g,'\x1b[34m'),_0x3cba3a=_0x3cba3a['replace'](/#RED#/g,_0x374c84(0x21c)),_0x3cba3a=_0x3cba3a[_0x374c84(0xd9)](/#YEL#/g,_0x374c84(0x218)),_0x3cba3a=_0x3cba3a[_0x374c84(0xd9)](/#MAG#/g,'\x1b[35m'),_0x3cba3a=_0x3cba3a['replace'](/#CYA#/g,_0x374c84(0x1b3)),_0x3cba3a=_0x3cba3a['replace'](/#RES#/g,_0x374c84(0x1f2)));;}return _0x3cba3a;},logger={'screen':_0x54876f=>{const _0x2c0b40=_0x30df4d;console[_0x2c0b40(0x197)](parseColor(_0x54876f,!![]));},'simple':_0x262b6e=>{const _0x287e17=_0x30df4d;console[_0x287e17(0x197)](parseColor(_0x262b6e,!![])),loggerfile[_0x287e17(0x1b6)](util[_0x287e17(0xc5)](parseColor(_0x262b6e,![]))+'\x0a');},'full':async _0x28c2bd=>{const _0x58a97c=_0x30df4d,_0x13ff0f=getTimeStamp()+_0x58a97c(0x1f4)+_0x28c2bd;console[_0x58a97c(0x197)](parseColor(_0x13ff0f,!![])),loggerfile['write'](util['format'](parseColor(_0x13ff0f,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x58a97c(0xd0)]!=_0x58a97c(0xb1))await tgBot[_0x58a97c(0x12c)](settings[_0x58a97c(0xee)],_0x58a97c(0x120)+parseColor(_0x28c2bd,![]))[_0x58a97c(0x23c)](_0x384bed=>{telegramError(_0x384bed);});},'debug':async(_0x119a9d,_0x52cf63='')=>{const _0x2d0640=_0x30df4d,_0x428618=getTimeStamp()+_0x2d0640(0x125)+_0x119a9d;if(debugging)console[_0x2d0640(0x197)](parseColor(_0x428618,!![]));loggerfile[_0x2d0640(0x1b6)](util['format'](parseColor(_0x428618,![]))+'\x0a');if(_0x52cf63){if(debugging)console[_0x2d0640(0x197)](_0x52cf63);loggerfile[_0x2d0640(0x1b6)](util[_0x2d0640(0xc5)](_0x52cf63)+'\x0a');}}};process['on'](_0x30df4d(0xe0),function(_0x351d7f){const _0x1ee02e=_0x30df4d;logger[_0x1ee02e(0xed)](_0x351d7f);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x30df4d(0x12b))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x30df4d(0xa3)),app=express(),http=require(_0x30df4d(0x1c8))[_0x30df4d(0x1f0)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x30df4d(0x23f)](_0x30df4d(0x1bd),async(_0x5bd67b,_0x4cc50f)=>{const _0x1882a4=_0x30df4d,_0x855e27=_0x5bd67b[_0x1882a4(0xb6)][_0x1882a4(0x78)],_0x3073eb=getClientsWithBotID(_0x1882a4(0x19c)),_0x35ca31=_0x5bd67b[_0x1882a4(0xd8)][_0x1882a4(0x223)],_0x555ec4=timelyDecrypt(_0x35ca31,![]),_0x120778=_0x3073eb[_0x1882a4(0x150)](_0x52a592=>_0x52a592[_0x1882a4(0x223)]==_0x555ec4);if(_0x120778){const _0x4c5db4=normalizeIP(_0x5bd67b[_0x1882a4(0x181)][_0x1882a4(0x24b)])[_0x1882a4(0x11d)],_0x2352ec=_0x5bd67b[_0x1882a4(0xd8)][_0x1882a4(0xf7)];if(validateAccess(_0x2352ec,_0x555ec4,_0x4c5db4)[_0x1882a4(0x14a)])_0x855e27==_0x1882a4(0x13d)&&await backupConfigFiles(),await zipFiles(_0x855e27),_0x4cc50f[_0x1882a4(0x14d)](zippath+(_0x855e27+_0x1882a4(0x14c)),_0x4c6c78=>{const _0x18448c=_0x1882a4;_0x4c6c78&&(logger[_0x18448c(0x8c)]('Failed\x20to\x20download\x20'+_0x855e27),logger['simple'](_0x4c6c78));});else logger[_0x1882a4(0x8c)](_0x1882a4(0xc3)+_0x855e27+_0x1882a4(0xa7));}else logger[_0x1882a4(0x8c)](_0x1882a4(0xc3)+_0x855e27+_0x1882a4(0xb9));}),app[_0x30df4d(0x206)](_0x30df4d(0xf6),async(_0x1500f6,_0x34fe7e)=>{const _0x22d1c5=_0x30df4d,_0x4aaa0a=getClientsWithBotID(_0x22d1c5(0x19c)),_0x20ba5e=_0x1500f6[_0x22d1c5(0xd8)][_0x22d1c5(0x223)],_0x262c56=timelyDecrypt(_0x20ba5e,![]),_0x5b57ef=_0x4aaa0a[_0x22d1c5(0x150)](_0x4ffcd3=>_0x4ffcd3[_0x22d1c5(0x223)]==_0x262c56);logger[_0x22d1c5(0x92)]('Backup\x20file\x20uploaded');if(_0x5b57ef){const _0x3a0ce1=normalizeIP(_0x1500f6['socket']['remoteAddress'])[_0x22d1c5(0x11d)],_0x2da2e6=_0x1500f6[_0x22d1c5(0xd8)][_0x22d1c5(0xf7)];if(validateAccess(_0x2da2e6,_0x262c56,_0x3a0ce1)[_0x22d1c5(0x14a)]){if(_0x1500f6[_0x22d1c5(0x17f)]){const _0x485c0a=_0x1500f6[_0x22d1c5(0x17f)][_0x22d1c5(0x1c0)];await _0x485c0a['mv'](temppath+_0x485c0a['name']),_0x34fe7e[_0x22d1c5(0x1c4)]({'status':!![],'message':_0x22d1c5(0x199)});const _0xa223e8=getBotsWithMode();_0xa223e8['length']>0x0?confirmRestore(temppath,_0x485c0a[_0x22d1c5(0x1e7)]):unzipFile(temppath,_0x485c0a[_0x22d1c5(0x1e7)]);}}else logger[_0x22d1c5(0x8c)](_0x22d1c5(0x154));}else logger[_0x22d1c5(0x8c)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x30df4d(0x152)](path[_0x30df4d(0x15e)](__dirname,bbpath2,_0x30df4d(0x16b)))),app[_0x30df4d(0x1cd)](express['static'](path[_0x30df4d(0x15e)](__dirname,bbpath2,_0x30df4d(0x71)))),app[_0x30df4d(0x23f)]('/',function(_0x48bb3e,_0x46d6f6){const _0x746259=_0x30df4d;_0x46d6f6[_0x746259(0x144)](path[_0x746259(0x15e)](__dirname,bbpath2,_0x746259(0x16b),_0x746259(0x1e4)));}),app[_0x30df4d(0x23f)](_0x30df4d(0x123),function(_0x3eff4d,_0x50ad00){const _0xa0f3a=_0x30df4d;_0x50ad00[_0xa0f3a(0x144)](path[_0xa0f3a(0x15e)](__dirname,bbpath2,_0xa0f3a(0x71),'index.html'));}),app[_0x30df4d(0x23f)](_0x30df4d(0x12a),(_0x502215,_0x408170)=>{const _0x5dff53=_0x30df4d;_0x408170[_0x5dff53(0x144)](path[_0x5dff53(0x15e)](__dirname,bbpath2,_0x5dff53(0x71),_0x5dff53(0x1e4)));}),app[_0x30df4d(0x23f)]('/:bot/performance',(_0x1621fd,_0x22fd2c)=>{const _0x400697=_0x30df4d;_0x22fd2c[_0x400697(0x144)](path[_0x400697(0x15e)](__dirname,bbpath2,_0x400697(0x71),'index.html'));}),app[_0x30df4d(0x23f)](_0x30df4d(0x14b),(_0x5e370f,_0x219101)=>{const _0x4820d0=_0x30df4d;_0x219101[_0x4820d0(0x144)](path[_0x4820d0(0x15e)](__dirname,bbpath2,_0x4820d0(0x71),_0x4820d0(0x1e4)));}),app[_0x30df4d(0x23f)](_0x30df4d(0x1e1),(_0x28f0a3,_0x4c386d)=>{const _0x1f974b=_0x30df4d;_0x4c386d[_0x1f974b(0x144)](path['join'](__dirname,bbpath2,_0x1f974b(0x71),_0x1f974b(0x1e4)));}),app[_0x30df4d(0x23f)](_0x30df4d(0x8d),(_0x5599cf,_0x2d2662)=>{const _0x55ad61=_0x30df4d;_0x2d2662[_0x55ad61(0x144)](path['join'](__dirname,bbpath2,_0x55ad61(0x71),_0x55ad61(0x1e4)));}),app[_0x30df4d(0x23f)](_0x30df4d(0xa9),(_0x5993ad,_0x5bb42d)=>{const _0x411d9f=_0x30df4d;_0x5bb42d[_0x411d9f(0x144)](path['join'](__dirname,bbpath2,_0x411d9f(0x71),_0x411d9f(0x1e4)));});if(HOST)http[_0x30df4d(0x70)](PORT,HOST);else http['listen'](PORT);const io=require(_0x30df4d(0x156))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x587a59=_0x30df4d;let _0xff7c04=_0x587a59(0x18d);const _0x567185=networkInterfaces(),_0x40a89d={};for(const _0x1cd75e of Object[_0x587a59(0x1df)](_0x567185)){for(const _0x1504e2 of _0x567185[_0x1cd75e]){if((_0x1504e2['family']==_0x587a59(0x146)||_0x1504e2['family']==0x4)&&!_0x1504e2[_0x587a59(0x22e)]){const _0x3034b4=ipaddr[_0x587a59(0xd6)](_0x1504e2[_0x587a59(0x251)])[_0x587a59(0x1d7)]();_0x3034b4!=_0x587a59(0xd1)&&(!_0x40a89d[_0x1cd75e]&&(_0x40a89d[_0x1cd75e]=[]),_0x40a89d[_0x1cd75e]['push'](_0x1504e2[_0x587a59(0x251)]),_0xff7c04=_0x1504e2[_0x587a59(0x251)]);}}}return{'serverip':_0xff7c04,'netinterfaces':_0x40a89d};}async function startServer(){const _0x1db52d=_0x30df4d,{serverip:_0x2c98fe,netinterfaces:_0x48eddc}=getServerIP();logger[_0x1db52d(0xed)](''),logger[_0x1db52d(0xed)](_0x1db52d(0x113)),await logger[_0x1db52d(0x8c)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x1db52d(0x157)+(environment=='staging'?_0x1db52d(0x13e):'')+'\x0a'+(_0x1db52d(0x7a)+PORT+_0x1db52d(0xb5))+(_0x1db52d(0x17a)+_0x2c98fe+':'+PORT+_0x1db52d(0x250))),logger[_0x1db52d(0xed)](_0x1db52d(0x113));if(config[_0x1db52d(0xfe)]!=0x0)for(const _0x22ef7c of config){if(_0x22ef7c[_0x1db52d(0x195)]==_0x1db52d(0xe4)||_0x22ef7c[_0x1db52d(0x195)]==_0x1db52d(0x257))await logger['full'](_0x1db52d(0xb8)+_0x22ef7c['botID']+_0x1db52d(0x24a)+_0x22ef7c['botname']),startBot([_0x22ef7c['botID'],userID],{'cwd':bbpath},function(_0x1f126f){if(_0x1f126f)logger['full'](_0x1f126f);});else(_0x22ef7c[_0x1db52d(0x195)]==_0x1db52d(0x14e)||_0x22ef7c['status']==_0x1db52d(0xda))&&await logger[_0x1db52d(0x8c)](_0x1db52d(0x1d8)+_0x22ef7c[_0x1db52d(0x1a9)]+_0x1db52d(0x24a)+_0x22ef7c[_0x1db52d(0x196)]);}else!newBot&&logger[_0x1db52d(0xed)](_0x1db52d(0x88));if(newBot)addBot();logger[_0x1db52d(0xed)](_0x1db52d(0x113)),logger['simple'](''),await logger[_0x1db52d(0x92)](_0x1db52d(0x111)+nodeversion),await logger[_0x1db52d(0x92)]('Network\x20Interfaces:',_0x48eddc);}function startSocket(){const _0x2f3084=_0x30df4d;io['on'](_0x2f3084(0x90),_0x5e6668=>{const _0x18c70d=_0x2f3084;let _0x568ad3,_0x4effaa,_0x14720a,_0x4b89d1,_0x4e0002;const _0x27fc4d=_0x5e6668[_0x18c70d(0xac)][_0x18c70d(0xd8)][_0x18c70d(0x225)];_0x4effaa=_0x27fc4d[_0x18c70d(0x77)](/bot[0-9]{3}/);if(_0x4effaa)_0x14720a=_0x4effaa[0x0][_0x18c70d(0x77)](/[0-9]{3}/);if(_0x14720a)_0x568ad3=_0x14720a[0x0];else _0x568ad3='botmanager';const _0x238498=_0x5e6668[_0x18c70d(0xac)]['auth'][_0x18c70d(0x16f)];if(!_0x238498)_0x5e6668[_0x18c70d(0x1e8)](_0x18c70d(0x195),{'publicKey':secure[_0x18c70d(0xe7)]});else{_0x4b89d1=timelyDecrypt(_0x238498,![]);if(!_0x4b89d1)_0x5e6668[_0x18c70d(0x1e8)](_0x18c70d(0x195),{'publicKey':secure['publicKey']});else{_0x4e0002=normalizeIP(_0x5e6668[_0x18c70d(0x11e)]['remoteAddress'])[_0x18c70d(0x11d)];if(!devices[_0x4b89d1])devices[_0x4b89d1]={'uuid':_0x4b89d1,'access':{'token':null}};devices[_0x4b89d1]['ip']=_0x4e0002;const _0x492ff8=addClient(_0x5e6668['id'],_0x4b89d1,_0x568ad3);setAccess(_0x492ff8),emitMessages(),_0x5e6668['on'](_0x18c70d(0x210),_0x43c64d=>{const _0x41876c=_0x18c70d,_0x48c6ba=timelyDecrypt(_0x43c64d[_0x41876c(0xb3)]);if(_0x48c6ba){_0x43c64d={'username':_0x43c64d[_0x41876c(0x256)],'password':_0x48c6ba},devices[_0x4b89d1][_0x41876c(0xf3)]=validateCredentials(_0x43c64d,_0x4b89d1);if(devices[_0x4b89d1][_0x41876c(0xf3)][_0x41876c(0x14a)]==![]&&devices[_0x4b89d1][_0x41876c(0xf3)][_0x41876c(0x107)]==_0x41876c(0x81))_0x5e6668['emit'](_0x41876c(0x195),{'access':devices[_0x4b89d1]['access']}),loginAccess2FA(_0x4b89d1,_0x4e0002);else{if(devices[_0x4b89d1][_0x41876c(0xf3)][_0x41876c(0x14a)]==![]&&devices[_0x4b89d1]['access'][_0x41876c(0x107)]==_0x41876c(0x1b1))_0x5e6668[_0x41876c(0x1e8)](_0x41876c(0x195),{'access':devices[_0x4b89d1][_0x41876c(0xf3)]});else devices[_0x4b89d1]['access'][_0x41876c(0x14a)]&&devices[_0x4b89d1][_0x41876c(0xf3)][_0x41876c(0x107)]==_0x41876c(0x248)&&(getClientsWithUuid(_0x4b89d1)[_0x41876c(0x1ce)](_0x279a0a=>{setAccess(_0x279a0a);}),logger['debug'](_0x41876c(0x16c)+_0x4b89d1[_0x41876c(0x9f)](-0x8)),setTokenRefresh(_0x4b89d1),setSessionTimeout(_0x41876c(0x210),_0x4b89d1));}}else logger[_0x41876c(0x8c)](_0x41876c(0xf5));}),_0x5e6668['on'](_0x18c70d(0x147),()=>{resetPassword();}),_0x5e6668['on']('disconnect',_0x2902af=>{removeClient(_0x5e6668['id']);}),_0x568ad3==_0x18c70d(0x19c)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xb82df7){const _0x14d102=_0x30df4d;if(_0xb82df7!='botmanager'&&config['apiKey']!=''){if(pid[_0xb82df7])pid[_0xb82df7][_0x14d102(0x1c4)]({'function':_0x14d102(0x203),'args':null});}_0xb82df7!='botmanager'&&broadcastToBots('bots',JSON[_0x14d102(0x1dc)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x3b6c80=>{const _0x5933dc=_0x5805;getSocket(_0x3b6c80['id'])[_0x5933dc(0x1e8)]('status',{'access':{'allow':![],'reason':_0x5933dc(0x1d6),'token':null}});});}function getSocket(_0x4432d0){const _0x5c7568=_0x30df4d;return io[_0x5c7568(0x9a)]['sockets'][_0x5c7568(0x23f)](_0x4432d0);}function setAccess(_0x38589f){const _0x25d2b4=_0x30df4d,_0x315ae8=getSocket(_0x38589f['id']),_0x5368a2=_0x38589f[_0x25d2b4(0x223)],_0x2a4609=_0x38589f[_0x25d2b4(0x208)];devices[_0x5368a2][_0x25d2b4(0xf3)]=validateAccess(devices[_0x5368a2][_0x25d2b4(0xf3)][_0x25d2b4(0x20c)],_0x5368a2),logger['debug']('Setting\x20access:\x20'+devices[_0x5368a2][_0x25d2b4(0xf3)][_0x25d2b4(0x107)]+_0x25d2b4(0x11c)+_0x38589f['id'][_0x25d2b4(0x9f)](-0x8)+_0x25d2b4(0x142)+_0x5368a2[_0x25d2b4(0x9f)](-0x8)),_0x315ae8[_0x25d2b4(0x15e)](_0x5368a2);if(devices[_0x5368a2][_0x25d2b4(0xf3)]['allow']){_0x315ae8[_0x25d2b4(0x15e)](_0x2a4609);if(_0x2a4609==_0x25d2b4(0x19c))initializeSocketBotManager(_0x315ae8);else initializeSocketBot(_0x315ae8);initClient(_0x2a4609);}devices[_0x5368a2][_0x25d2b4(0xf3)][_0x25d2b4(0x20c)]&&devices[_0x5368a2][_0x25d2b4(0xf3)][_0x25d2b4(0x107)]==_0x25d2b4(0xbd)&&setSessionTimeout(_0x25d2b4(0x82),_0x5368a2),devices[_0x5368a2][_0x25d2b4(0xf3)][_0x25d2b4(0x20c)]&&devices[_0x5368a2][_0x25d2b4(0xf3)][_0x25d2b4(0x107)]==_0x25d2b4(0xb0)&&setSessionTimeout(_0x25d2b4(0x210),_0x5368a2),_0x315ae8[_0x25d2b4(0x1e8)](_0x25d2b4(0x195),{'status':_0x38589f['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5368a2][_0x25d2b4(0xf3)],'externalip':devices[_0x5368a2]['ip'],'publicKey':secure[_0x25d2b4(0xe7)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x5368a2][_0x25d2b4(0xf3)]['allow']==![]&&devices[_0x5368a2]['access']['reason']==_0x25d2b4(0x1ab)&&temporaryAccess2FA(_0x5368a2,devices[_0x5368a2]['ip']);}function setSessionTimeout(_0x264329,_0x189088){const _0x954751=_0x30df4d;let _0x4580c1;if(_0x264329==_0x954751(0x210))_0x4580c1=loginExpiry*0x3c*0x3e8;else _0x4580c1=devices[_0x189088][_0x954751(0x161)][_0x954751(0x7c)]*0x3c*0x3e8-(new Date()[_0x954751(0x13b)]()-devices[_0x189088][_0x954751(0x161)]['timestamp']);if(devices[_0x189088]['pidExpireLogin'])clearTimeout(devices[_0x189088][_0x954751(0x1fd)]);devices[_0x189088][_0x954751(0x1fd)]=setTimeout(()=>{const _0x5dd811=_0x954751;if(devices[_0x189088][_0x5dd811(0x1d9)])clearTimeout(devices[_0x189088][_0x5dd811(0x1d9)]);removeSocketListeners(_0x189088),addBlacklist(_0x189088),devices[_0x189088][_0x5dd811(0x161)]=null,devices[_0x189088][_0x5dd811(0x8f)]=null,devices[_0x189088][_0x5dd811(0xf3)]['token']=null,logger[_0x5dd811(0x92)](_0x5dd811(0x129)+_0x189088['slice'](-0x8)),devices[_0x189088][_0x5dd811(0xf3)]=validateAccess(devices[_0x189088][_0x5dd811(0xf3)][_0x5dd811(0x20c)],_0x189088),!(devices[_0x189088][_0x5dd811(0xf3)][_0x5dd811(0x14a)]&&devices[_0x189088][_0x5dd811(0xf3)][_0x5dd811(0x107)]=='login\x20not\x20required')&&(_0x264329==_0x5dd811(0x210)?io['to'](_0x189088)[_0x5dd811(0x1e8)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x189088)[_0x5dd811(0x1e8)](_0x5dd811(0x195),{'access':{'allow':![],'reason':_0x5dd811(0x17b),'token':null}})),devices[_0x189088][_0x5dd811(0xf3)][_0x5dd811(0x20c)]=null;},_0x4580c1);}function setTokenRefresh(_0x3e60cc){const _0x2f7d9f=_0x30df4d;if(devices[_0x3e60cc][_0x2f7d9f(0x1d9)])clearTimeout(devices[_0x3e60cc][_0x2f7d9f(0x1d9)]);devices[_0x3e60cc][_0x2f7d9f(0x1d9)]=setTimeout(()=>{const _0x3d0c8a=_0x2f7d9f;getClientsWithUuid(_0x3e60cc)[_0x3d0c8a(0xfe)]!=0x0?(devices[_0x3e60cc][_0x3d0c8a(0xf3)]=refreshToken(_0x3e60cc),io['to'](_0x3e60cc)[_0x3d0c8a(0x1e8)](_0x3d0c8a(0x195),{'status':_0x3d0c8a(0x15b),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3e60cc][_0x3d0c8a(0xf3)],'externalip':devices[_0x3e60cc]['ip'],'publicKey':secure[_0x3d0c8a(0xe7)],'validInstallation':validInstallation}),setTokenRefresh(_0x3e60cc)):clearTimeout(devices[_0x3e60cc][_0x3d0c8a(0x1d9)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x232569){const _0x32109f=_0x30df4d,_0x3077ed=getClient(_0x232569['id'])['uuid'];_0x232569[_0x32109f(0x1e8)](_0x32109f(0x23e),config),_0x232569[_0x32109f(0x1e8)](_0x32109f(0x13f),cleanSettings()),_0x232569['on'](_0x32109f(0x1c3),_0x195dae=>{const _0x17a220=_0x32109f;if(validateAccess(_0x195dae,_0x3077ed)[_0x17a220(0x14a)])addBot();else logger['full'](_0x17a220(0x241));}),_0x232569['on'](_0x32109f(0x1d4),(_0x5315dd,_0x288468)=>{const _0x17121f=_0x32109f;if(validateAccess(_0x288468,_0x3077ed)['allow'])toggleBot(_0x5315dd[_0x17121f(0x1a9)],_0x5315dd[_0x17121f(0x195)],_0x5315dd['live']);else logger[_0x17121f(0x8c)](_0x17121f(0x79));}),_0x232569['on'](_0x32109f(0x167),(_0x5155d0,_0xf92385)=>{const _0x2a048b=_0x32109f;if(validateAccess(_0xf92385,_0x3077ed)[_0x2a048b(0x14a)])toggleBotMode(_0x5155d0);else logger[_0x2a048b(0x8c)](_0x2a048b(0x79));}),_0x232569['on']('delete-bot',(_0x5145d3,_0x2e25c0)=>{const _0x2f34cc=_0x32109f;if(validateAccess(_0x2e25c0,_0x3077ed)['allow'])deleteBot(_0x5145d3);else logger['full'](_0x2f34cc(0x246));}),_0x232569['on'](_0x32109f(0x12f),(_0x2dae1a,_0xc40f2c)=>{const _0x24bf00=_0x32109f;if(validateAccess(_0xc40f2c,_0x3077ed)[_0x24bf00(0x14a)])storeSettings(_0x2dae1a,!![]);else logger[_0x24bf00(0x8c)](_0x24bf00(0x124));}),_0x232569['on']('update-bb',_0x8e47af=>{const _0x46da6c=_0x32109f;if(validateAccess(_0x8e47af,_0x3077ed)[_0x46da6c(0x14a)])updateBB(_0x46da6c(0x138));else logger[_0x46da6c(0x8c)](_0x46da6c(0x243));}),_0x232569['on']('reinstall-bb',_0x5b1c62=>{const _0x39a9ca=_0x32109f;if(validateAccess(_0x5b1c62,_0x3077ed)[_0x39a9ca(0x14a)])updateBB(_0x39a9ca(0x24e));else logger[_0x39a9ca(0x8c)](_0x39a9ca(0x1cc));}),_0x232569['on']('get-backup-files',_0xc80d33=>{const _0x30af04=_0x32109f;if(validateAccess(_0xc80d33,_0x3077ed)[_0x30af04(0x14a)]){const _0x4c6721=getClient(_0x232569['id']);if(_0x4c6721)getBackupFiles(_0x4c6721[_0x30af04(0x223)]);else logger['full'](_0x30af04(0x25d));}else logger[_0x30af04(0x8c)](_0x30af04(0x1f8));}),_0x232569['on'](_0x32109f(0x180),(_0x5447f4,_0x36dd31)=>{const _0x4e422e=_0x32109f;if(validateAccess(_0x36dd31,_0x3077ed)[_0x4e422e(0x14a)])restoreBackupFile(_0x5447f4);else logger['full'](_0x4e422e(0xbf));}),_0x232569['on'](_0x32109f(0x1bb),_0x2da025=>{const _0x468811=_0x32109f;if(validateAccess(_0x2da025,_0x3077ed)['allow'])getMessages();else logger[_0x468811(0x8c)](_0x468811(0x11f));}),_0x232569['on'](_0x32109f(0x13c),(_0x275fd9,_0x44474f)=>{const _0x16dfb9=_0x32109f;if(validateAccess(_0x44474f,_0x3077ed)['allow'])confirmMessage(_0x275fd9);else logger[_0x16dfb9(0x8c)](_0x16dfb9(0x175));}),_0x232569['on']('logout',_0x2ea58b=>{const _0x5e1c34=_0x32109f;if(validateAccess(_0x2ea58b,_0x3077ed)[_0x5e1c34(0x14a)]){if(devices[_0x3077ed][_0x5e1c34(0x1d9)])clearTimeout(devices[_0x3077ed][_0x5e1c34(0x1d9)]);if(devices[_0x3077ed]['pidExpireLogin'])clearTimeout(devices[_0x3077ed]['pidExpireLogin']);removeSocketListeners(getClient(_0x232569['id'])[_0x5e1c34(0x223)]),addBlacklist(_0x3077ed),devices[_0x3077ed][_0x5e1c34(0x161)]=null,devices[_0x3077ed][_0x5e1c34(0x8f)]=null,devices[_0x3077ed][_0x5e1c34(0xf3)][_0x5e1c34(0x20c)]=null,logger[_0x5e1c34(0x92)](_0x5e1c34(0x238)+_0x3077ed[_0x5e1c34(0x9f)](-0x8)),io['to'](getClient(_0x232569['id'])[_0x5e1c34(0x223)])['emit'](_0x5e1c34(0x195),{'access':{'allow':![],'reason':_0x5e1c34(0x8e),'token':null}});}else logger[_0x5e1c34(0x8c)](_0x5e1c34(0x145));});}function initializeSocketBot(_0x561dfa){const _0xd471c7=_0x30df4d,_0x39892f=getClient(_0x561dfa['id'])[_0xd471c7(0x208)],_0x5a90f5=getClient(_0x561dfa['id'])[_0xd471c7(0x223)];_0x561dfa['on'](_0xd471c7(0x183),(_0x1a7fde,_0x2d12eb)=>{const _0x8c465d=_0xd471c7;if(validateAccess(_0x2d12eb,_0x5a90f5)[_0x8c465d(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x8c465d(0x1c4)]({'function':_0x8c465d(0xb2),'args':_0x1a7fde});}else logger[_0x8c465d(0x8c)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x561dfa['on']('delete-alerts',(_0x41278b,_0x2a86bc)=>{const _0x266c36=_0xd471c7;if(validateAccess(_0x2a86bc,_0x5a90f5)[_0x266c36(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x266c36(0x1c4)]({'function':_0x266c36(0x114),'args':_0x41278b});}else logger['full'](_0x266c36(0x259));}),_0x561dfa['on'](_0xd471c7(0x103),(_0x4e32fd,_0x2d1666)=>{const _0x98b231=_0xd471c7;if(validateAccess(_0x2d1666,_0x5a90f5)['allow']){if(pid[_0x39892f])pid[_0x39892f][_0x98b231(0x1c4)]({'function':_0x98b231(0x165),'args':_0x4e32fd});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x561dfa['on'](_0xd471c7(0x100),(_0x468f20,_0x2e9f74)=>{const _0x21c143=_0xd471c7;if(validateAccess(_0x2e9f74,_0x5a90f5)[_0x21c143(0x14a)]){if(pid[_0x39892f])pid[_0x39892f]['send']({'function':_0x21c143(0x221),'args':_0x468f20});}else logger[_0x21c143(0x8c)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x561dfa['on'](_0xd471c7(0xf9),(_0x391b2b,_0x34d059)=>{const _0x18af7d=_0xd471c7;if(validateAccess(_0x34d059,_0x5a90f5)[_0x18af7d(0x14a)]){if(pid[_0x39892f])pid[_0x39892f]['send']({'function':_0x18af7d(0x1db),'args':_0x391b2b});}else logger[_0x18af7d(0x8c)](_0x18af7d(0x130));}),_0x561dfa['on'](_0xd471c7(0x209),(_0x40c53e,_0x960a59)=>{const _0x389a10=_0xd471c7;if(validateAccess(_0x960a59,_0x5a90f5)[_0x389a10(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x389a10(0x1c4)]({'function':_0x389a10(0xec),'args':_0x40c53e});}else logger[_0x389a10(0x8c)](_0x389a10(0x168));}),_0x561dfa['on'](_0xd471c7(0x1d3),_0x1ae542=>{const _0x3f26e6=_0xd471c7;if(validateAccess(_0x1ae542,_0x5a90f5)['allow']){if(pid[_0x39892f])pid[_0x39892f][_0x3f26e6(0x1c4)]({'function':_0x3f26e6(0x10a),'args':null});}else logger[_0x3f26e6(0x8c)](_0x3f26e6(0x15c));}),_0x561dfa['on']('get-starting-balances',_0x3d13b1=>{const _0x2e964b=_0xd471c7;if(validateAccess(_0x3d13b1,_0x5a90f5)[_0x2e964b(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x2e964b(0x1c4)]({'function':_0x2e964b(0x1f6),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x561dfa['on'](_0xd471c7(0x136),(_0x24e484,_0x2910df)=>{const _0x58eac8=_0xd471c7;if(validateAccess(_0x2910df,_0x5a90f5)[_0x58eac8(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x58eac8(0x1c4)]({'function':_0x58eac8(0x182),'args':_0x24e484});}else logger[_0x58eac8(0x8c)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x561dfa['on'](_0xd471c7(0xc4),_0x428594=>{const _0x37ee61=_0xd471c7;if(validateAccess(_0x428594,_0x5a90f5)[_0x37ee61(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x37ee61(0x1c4)]({'function':_0x37ee61(0x176),'args':null});}else logger[_0x37ee61(0x8c)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x561dfa['on'](_0xd471c7(0x21f),_0x745715=>{const _0x52baad=_0xd471c7;if(validateAccess(_0x745715,_0x5a90f5)[_0x52baad(0x14a)]){if(pid[_0x39892f])pid[_0x39892f][_0x52baad(0x1c4)]({'function':'showConfig','args':null});}else logger[_0x52baad(0x8c)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x561dfa['on']('update-bb',_0x4c2849=>{const _0x134612=_0xd471c7;if(validateAccess(_0x4c2849,_0x5a90f5)[_0x134612(0x14a)])updateBB(_0x134612(0x138));else logger[_0x134612(0x8c)](_0x134612(0x243));}),_0x561dfa['on']('get-messages',_0xbf5388=>{const _0x144a70=_0xd471c7;if(validateAccess(_0xbf5388,_0x5a90f5)['allow'])getMessages();else logger[_0x144a70(0x8c)](_0x144a70(0x11f));}),_0x561dfa['on'](_0xd471c7(0x13c),(_0x5488e,_0x1b54c)=>{if(validateAccess(_0x1b54c,_0x5a90f5)['allow'])confirmMessage(_0x5488e);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x561dfa['on'](_0xd471c7(0x9e),_0x503a1e=>{const _0x4e5dd3=_0xd471c7;if(validateAccess(_0x503a1e,_0x5a90f5)[_0x4e5dd3(0x14a)]){if(devices[_0x5a90f5][_0x4e5dd3(0x1d9)])clearTimeout(devices[_0x5a90f5][_0x4e5dd3(0x1d9)]);if(devices[_0x5a90f5][_0x4e5dd3(0x1fd)])clearTimeout(devices[_0x5a90f5]['pidExpireLogin']);removeSocketListeners(getClient(_0x561dfa['id'])['uuid']),addBlacklist(_0x5a90f5),devices[_0x5a90f5][_0x4e5dd3(0x161)]=null,devices[_0x5a90f5][_0x4e5dd3(0x8f)]=null,devices[_0x5a90f5][_0x4e5dd3(0xf3)][_0x4e5dd3(0x20c)]=null,logger[_0x4e5dd3(0x92)](_0x4e5dd3(0x238)+_0x5a90f5[_0x4e5dd3(0x9f)](-0x8)),io['to'](getClient(_0x561dfa['id'])[_0x4e5dd3(0x223)])['emit']('status',{'access':{'allow':![],'reason':_0x4e5dd3(0x8e),'token':null}});}else logger[_0x4e5dd3(0x8c)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x5b0167){const _0x4ac080=_0x30df4d;getClientsWithUuid(_0x5b0167)[_0x4ac080(0x1ce)](_0x34b23b=>{getSocket(_0x34b23b['id'])['removeAllListeners']();});}function cleanSettings(){const _0x46c25c=_0x30df4d;let _0x410844=settings;return settings[_0x46c25c(0x23b)]&&settings['telegramToken']!=''&&(_0x410844={..._0x410844,'telegramToken':_0x46c25c(0x98)}),settings[_0x46c25c(0x242)]&&settings[_0x46c25c(0x242)]!=''&&(_0x410844={..._0x410844,'bbPassword':_0x46c25c(0x98)}),(settings['bbPassword']&&settings[_0x46c25c(0x242)]==_0x46c25c(0xf4)||settings[_0x46c25c(0x23b)]&&settings[_0x46c25c(0x23b)]==_0x46c25c(0xf4))&&(_0x410844={..._0x410844,'restored':{'password':settings['bbPassword']==_0x46c25c(0xf4),'telegram':settings[_0x46c25c(0x23b)]==_0x46c25c(0xf4)}}),_0x410844;}async function updateBB(_0xd3cec){const _0xa9b82c=_0x30df4d;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x30c74b=>{restartBot(_0x30c74b['botID']);});if(_0xd3cec=='update')process[_0xa9b82c(0x1c4)]({'update':!![],'environment':environment},_0x364907=>{});else _0xd3cec==_0xa9b82c(0x24e)&&process['send']({'reinstall':!![],'environment':environment},_0x262fa1=>{});}function startBot(_0x3f4cfa,_0x4b46da,_0x5c8315){const _0x41ef0c=_0x30df4d;if(debugging)_0x3f4cfa[_0x41ef0c(0x85)]('-d');let _0xe68634=![];const _0x422951=_0x3f4cfa[0x0];_0x4b46da={..._0x4b46da,'stdio':['inherit',_0x41ef0c(0xd5),'inherit',_0x41ef0c(0x141)]},pid[_0x422951]=childProcess['fork'](botfile,_0x3f4cfa,_0x4b46da),pid[_0x422951]['on']('message',_0x564299=>{const _0x4df09c=_0x41ef0c;switch(Object[_0x4df09c(0x1df)](_0x564299)[0x0]){case'botname':updateBotName(_0x422951,_0x564299['botname']);break;case _0x4df09c(0xe8):updateBotManager();break;case _0x4df09c(0x195):updateStatus(_0x422951,_0x564299[_0x4df09c(0x195)]);break;case _0x4df09c(0xd4):updateLive(_0x422951,_0x564299[_0x4df09c(0xd4)]);break;case _0x4df09c(0x187):updateLive(_0x422951,_0x564299[_0x4df09c(0x187)]),io['to'](_0x422951)[_0x4df09c(0x1e8)]('status',{'access':{'allow':![],'reason':_0x4df09c(0x1d6),'token':null}});break;case _0x4df09c(0xad):_0x564299[_0x4df09c(0xad)]==_0x4df09c(0x1d5)&&restartBot(_0x422951);_0x564299[_0x4df09c(0xad)]=='kill'&&toggleBot(_0x422951,'disabled',_0x4df09c(0x19a));break;case _0x4df09c(0x1a4):sendTelegram(_0x422951,_0x564299[_0x4df09c(0x1a4)]);break;case _0x4df09c(0x164):sendTelegramMsg(_0x564299[_0x4df09c(0x164)]);break;case _0x4df09c(0xc0):io['to'](_0x422951)[_0x4df09c(0x1e8)](_0x564299[_0x4df09c(0xc0)],_0x564299[_0x4df09c(0xdb)]);break;}}),pid[_0x422951]['on'](_0x41ef0c(0x15f),function(_0x44660){if(_0xe68634)return;_0xe68634=!![],_0x5c8315(_0x44660);}),pid[_0x422951]['on']('exit',async function(_0x3fb166){const _0x5cd4f1=_0x41ef0c;if(installingUpdate)return;if(_0xe68634)return;_0xe68634=!![],_0x5c8315(null);const _0x2bbf50=dbConfig[_0x5cd4f1(0x23f)](_0x5cd4f1(0x23e))[_0x5cd4f1(0x150)]({'botID':_0x422951})['value']();_0x2bbf50&&(_0x2bbf50[_0x5cd4f1(0x195)]==_0x5cd4f1(0xe4)||_0x2bbf50[_0x5cd4f1(0x195)]=='new')&&(await sleep(0x3e8),updateLive(_0x422951,'stopped'),logger[_0x5cd4f1(0x8c)](_0x5cd4f1(0x110)+_0x422951),startBot([_0x422951,userID],{'cwd':bbpath},function(_0x52829d){const _0x406cb3=_0x5cd4f1;if(_0x52829d)logger[_0x406cb3(0x8c)](_0x52829d);}));});}function stopBot(_0x4a66ae){const _0x1ef25c=_0x30df4d;getClientsWithBotID(_0x4a66ae)[_0x1ef25c(0x1ce)](_0x4cfe28=>{getSocket(_0x4cfe28['id'])['disconnect'](!![]),removeClient(_0x4cfe28['id']);}),pid[_0x4a66ae]&&(pid[_0x4a66ae][_0x1ef25c(0x24c)](),pid[_0x4a66ae]=null);}function restartBot(_0x3651ce){const _0x1c495a=_0x30df4d;if(pid[_0x3651ce])pid[_0x3651ce][_0x1c495a(0x24c)]();}function addBot(){const _0x4274c5=_0x30df4d;let _0x1ba6cd;for(let _0x353dc6=0x1;_0x353dc6<0x3e9;_0x353dc6++){_0x1ba6cd=_0x353dc6[_0x4274c5(0x1af)]()[_0x4274c5(0x83)](0x3,'0');let _0x16b899=config[_0x4274c5(0x150)](_0x408d3f=>_0x408d3f[_0x4274c5(0x1a9)]==_0x1ba6cd);if(!_0x16b899)break;}if(_0x1ba6cd===_0x4274c5(0xab)){logger[_0x4274c5(0x8c)](_0x4274c5(0x8a));return;}logger[_0x4274c5(0x8c)](_0x4274c5(0x99)+_0x1ba6cd),dbConfig[_0x4274c5(0x23f)]('bots')[_0x4274c5(0x85)]({'botID':_0x1ba6cd,'botname':'Bot\x20'+_0x1ba6cd,'status':'new','live':''})[_0x4274c5(0x1b6)](),startBot([_0x1ba6cd,userID],{'cwd':bbpath},function(_0x4c9107){const _0x2afc68=_0x4274c5;if(_0x4c9107)logger[_0x2afc68(0x8c)](_0x4c9107);}),config=getConfiguration(),io['to']('botmanager')[_0x4274c5(0x1e8)]('bots',config),broadcastToBots(_0x4274c5(0x23e),JSON[_0x4274c5(0x1dc)](config));}function deleteBot(_0x21c720){const _0x48fbb9=_0x30df4d;getClientsWithBotID(_0x21c720)[_0x48fbb9(0x1ce)](_0x17af5=>{getSocket(_0x17af5['id'])['disconnect'](!![]),removeClient(_0x17af5['id']);}),dbConfig['get']('bots')['remove']({'botID':_0x21c720})[_0x48fbb9(0x1b6)](),logger['full'](_0x48fbb9(0x86)+_0x21c720),stopBot(_0x21c720);try{if(fs[_0x48fbb9(0x16d)](path[_0x48fbb9(0x15e)](configpath,_0x48fbb9(0x1e0)+_0x21c720+_0x48fbb9(0x20d))))fs[_0x48fbb9(0x23d)](path[_0x48fbb9(0x15e)](configpath,_0x48fbb9(0x1e0)+_0x21c720+_0x48fbb9(0x20d)));if(fs[_0x48fbb9(0x16d)](path[_0x48fbb9(0x15e)](configpath,_0x48fbb9(0x1e0)+_0x21c720+_0x48fbb9(0x211))))fs[_0x48fbb9(0x23d)](path[_0x48fbb9(0x15e)](configpath,_0x48fbb9(0x1e0)+_0x21c720+_0x48fbb9(0x211)));if(fs[_0x48fbb9(0x16d)](path[_0x48fbb9(0x15e)](configpath,_0x48fbb9(0x1e0)+_0x21c720+'-performance.json')))fs[_0x48fbb9(0x23d)](path['join'](configpath,_0x48fbb9(0x1e0)+_0x21c720+'-performance.json'));if(fs[_0x48fbb9(0x16d)](path[_0x48fbb9(0x15e)](configpath,_0x48fbb9(0x1e0)+_0x21c720+_0x48fbb9(0xcc))))fs[_0x48fbb9(0x23d)](path['join'](configpath,'bot-'+_0x21c720+_0x48fbb9(0xcc)));}catch(_0x1047d7){if(_0x1047d7)logger[_0x48fbb9(0x8c)](_0x48fbb9(0x1eb),_0x1047d7);}config=getConfiguration(),io['to'](_0x48fbb9(0x19c))['emit']('bots',config),broadcastToBots(_0x48fbb9(0x23e),JSON['stringify'](config));}function toggleBot(_0x1b828a,_0x5cb85f,_0x7cb8f8){const _0x300853=_0x30df4d;dbConfig['get'](_0x300853(0x23e))[_0x300853(0x150)]({'botID':_0x1b828a})[_0x300853(0x12e)]({'status':_0x5cb85f})[_0x300853(0x12e)]({'live':_0x7cb8f8})[_0x300853(0x1b6)]();if(_0x5cb85f==_0x300853(0xe4)||_0x5cb85f==_0x300853(0x257))logger[_0x300853(0x8c)](_0x300853(0x22c)+_0x1b828a),startBot([_0x1b828a,userID],{'cwd':bbpath},function(_0x2184b2){const _0x5bef52=_0x300853;if(_0x2184b2)logger[_0x5bef52(0x8c)](_0x2184b2);});else(_0x5cb85f=='disabled'||_0x5cb85f==_0x300853(0xda))&&(logger[_0x300853(0x8c)]('Disabled\x20Bot\x20'+_0x1b828a),stopBot(_0x1b828a));config=getConfiguration(),io['to'](_0x300853(0x19c))[_0x300853(0x1e8)](_0x300853(0x23e),config),broadcastToBots(_0x300853(0x23e),JSON[_0x300853(0x1dc)](config));}function toggleStatus(_0x25220b){const _0x41b375=_0x30df4d;let _0x4957ca=dbConfig[_0x41b375(0x23f)](_0x41b375(0x23e))[_0x41b375(0x150)]({'botID':_0x25220b})[_0x41b375(0x73)](),_0xbaddaf;if(_0x4957ca[_0x41b375(0x195)]===_0x41b375(0xe4))_0xbaddaf=_0x41b375(0x14e);else{if(_0x4957ca[_0x41b375(0x195)]===_0x41b375(0x257))_0xbaddaf=_0x41b375(0xda);else{if(_0x4957ca['status']===_0x41b375(0xda))_0xbaddaf=_0x41b375(0x257);else{if(_0x4957ca[_0x41b375(0x195)]==='disabled')_0xbaddaf=_0x41b375(0xe4);}}}return _0xbaddaf;}function updateStatus(_0xcd873d,_0xa01b30){const _0x2e96cb=_0x30df4d;dbConfig[_0x2e96cb(0x23f)]('bots')[_0x2e96cb(0x150)]({'botID':_0xcd873d})[_0x2e96cb(0x12e)]({'status':_0xa01b30})[_0x2e96cb(0x1b6)](),config=getConfiguration(),io['to']('botmanager')[_0x2e96cb(0x1e8)](_0x2e96cb(0x23e),config),broadcastToBots(_0x2e96cb(0x23e),JSON[_0x2e96cb(0x1dc)](config));}function updateLive(_0x4637e4,_0x34fa3a){const _0x5e82ab=_0x30df4d;dbConfig[_0x5e82ab(0x23f)](_0x5e82ab(0x23e))[_0x5e82ab(0x150)]({'botID':_0x4637e4})[_0x5e82ab(0x12e)]({'live':_0x34fa3a})[_0x5e82ab(0x1b6)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON[_0x5e82ab(0x1dc)](config));}function updateBotName(_0x2c7392,_0x4c0035){const _0x593c4e=_0x30df4d;dbConfig[_0x593c4e(0x23f)](_0x593c4e(0x23e))[_0x593c4e(0x150)]({'botID':_0x2c7392})[_0x593c4e(0x12e)]({'botname':_0x4c0035})[_0x593c4e(0x1b6)](),config=getConfiguration(),io['to']('botmanager')[_0x593c4e(0x1e8)](_0x593c4e(0x23e),config),broadcastToBots(_0x593c4e(0x23e),JSON['stringify'](config));}function updateBotManager(){const _0x541dc2=_0x30df4d;config=getConfiguration(),io['to']('botmanager')[_0x541dc2(0x1e8)](_0x541dc2(0x23e),config),broadcastToBots(_0x541dc2(0x23e),JSON[_0x541dc2(0x1dc)](config));}function toggleBotMode(_0x16395c){const _0x286d14=_0x30df4d;if(pid[_0x16395c])pid[_0x16395c][_0x286d14(0x1c4)]({'function':'toggleBotMode','args':null});else{const _0x51bc92=configpath+_0x286d14(0x1e0)+_0x16395c+'-config.json',_0x270bae=fs[_0x286d14(0x226)](_0x51bc92),_0x4a4881=JSON['parse'](_0x270bae),_0x31f5df=_0x4a4881[_0x286d14(0x208)][0x0]['headless'];_0x4a4881['bot'][0x0]['headless']=!_0x31f5df;const _0x26553e=JSON['stringify'](_0x4a4881,null,0x2);fs[_0x286d14(0x74)](_0x51bc92,_0x26553e),config=getConfiguration(),io['to'](_0x286d14(0x19c))['emit'](_0x286d14(0x23e),config),broadcastToBots(_0x286d14(0x23e),JSON[_0x286d14(0x1dc)](config));}}function telegramError(_0xa0e595){const _0xae953e=_0x30df4d;logger[_0xae953e(0xed)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0xbd7949){const _0x17e472=_0x30df4d;if(_0xbd7949[_0x17e472(0x20e)][_0x17e472(0x256)]!=settings[_0x17e472(0x21d)]&&'@'+_0xbd7949['from'][_0x17e472(0x256)]!=settings[_0x17e472(0x21d)])return tgBot[_0x17e472(0x12c)](_0xbd7949[_0x17e472(0x1fb)]['id'],_0x17e472(0x94),{'parse_mode':_0x17e472(0x1ee)})[_0x17e472(0x23c)](_0x2c2031=>{telegramError(_0x2c2031);}),![];return!![];}async function initTelegram(){const _0x2d4b18=_0x30df4d;if(tgBot)tgBot[_0x2d4b18(0x102)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x250371=_0x2d4b18(0xc1);_0x250371+='\x0a',_0x250371+=_0x2d4b18(0x174),_0x250371+=_0x2d4b18(0x19d),_0x250371+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x250371+=_0x2d4b18(0xf1),_0x250371+='/on\x20-\x20start\x20bot(s)\x0a',_0x250371+=_0x2d4b18(0x132),_0x250371+=_0x2d4b18(0x1d0),_0x250371+=_0x2d4b18(0xa0),_0x250371+=_0x2d4b18(0x1a7),_0x250371+=_0x2d4b18(0x119),_0x250371+=_0x2d4b18(0x9b),_0x250371+=_0x2d4b18(0x177),_0x250371+=_0x2d4b18(0x1b8),_0x250371+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x21d7a5=_0x2d4b18(0x93);_0x21d7a5+='\x0a',_0x21d7a5+=_0x250371,tgBot[_0x2d4b18(0x131)](/\/start/,_0x275e42=>{const _0x3941b6=_0x2d4b18;if(!validateTelegram(_0x275e42))return;if(settings[_0x3941b6(0xee)]!=_0x275e42[_0x3941b6(0x1fb)]['id'])updateSetting('telegramChatId',_0x275e42['chat']['id']);updateSetting(_0x3941b6(0x1ba),!![]),tgBot[_0x3941b6(0x12c)](_0x275e42['chat']['id'],_0x21d7a5)[_0x3941b6(0x23c)](_0x42df33=>{telegramError(_0x42df33);});}),tgBot['onText'](/\/enable/,_0x2b7015=>{const _0x1a6c17=_0x2d4b18;if(!validateTelegram(_0x2b7015))return;if(settings['telegramChatId']!=_0x2b7015['chat']['id'])updateSetting(_0x1a6c17(0xee),_0x2b7015[_0x1a6c17(0x1fb)]['id']);updateSetting(_0x1a6c17(0x1ba),!![]),tgBot['sendMessage'](_0x2b7015['chat']['id'],_0x1a6c17(0x20f))[_0x1a6c17(0x23c)](_0x535b79=>{telegramError(_0x535b79);});}),tgBot[_0x2d4b18(0x131)](/\/config/,async _0x4e5b23=>{const _0x1ca85e=_0x2d4b18;if(!validateTelegram(_0x4e5b23))return;tgBot['removeListener'](_0x1ca85e(0x207)),tgBot['sendMessage'](_0x4e5b23[_0x1ca85e(0x1fb)]['id'],_0x1ca85e(0xe9),{'reply_markup':{'inline_keyboard':[[{'text':_0x1ca85e(0x1f7),'callback_data':_0x1ca85e(0xb1)},{'text':_0x1ca85e(0x224),'callback_data':_0x1ca85e(0x239)},{'text':_0x1ca85e(0x202),'callback_data':_0x1ca85e(0x1d1)}]]}})['catch'](_0x1bbf63=>{telegramError(_0x1bbf63);}),tgBot['on'](_0x1ca85e(0x207),async _0x496ec7=>{const _0x1d8c16=_0x1ca85e,_0x4e234c=_0x496ec7['data'],_0x225592=_0x496ec7[_0x1d8c16(0x233)];tgBot['answerCallbackQuery'](_0x496ec7['id'])[_0x1d8c16(0xde)](async()=>{const _0x1c1b16=_0x1d8c16;_0x4e234c==_0x1c1b16(0xb1)&&(updateSetting(_0x1c1b16(0xd0),_0x1c1b16(0xb1)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1c1b16(0x12c)](_0x225592[_0x1c1b16(0x1fb)]['id'],_0x1c1b16(0x249))[_0x1c1b16(0x23c)](_0x3025b2=>{telegramError(_0x3025b2);}));_0x4e234c==_0x1c1b16(0x239)&&(updateSetting(_0x1c1b16(0xd0),_0x1c1b16(0x239)),updateSetting(_0x1c1b16(0x1ba),!![]),await tgBot[_0x1c1b16(0x12c)](_0x225592['chat']['id'],_0x1c1b16(0x1e9))[_0x1c1b16(0x23c)](_0x288c2e=>{telegramError(_0x288c2e);}));_0x4e234c==_0x1c1b16(0x1d1)&&(updateSetting('telegramEvents',_0x1c1b16(0x1d1)),updateSetting(_0x1c1b16(0x1ba),!![]),await tgBot[_0x1c1b16(0x12c)](_0x225592[_0x1c1b16(0x1fb)]['id'],_0x1c1b16(0x1b0))[_0x1c1b16(0x23c)](_0x189d16=>{telegramError(_0x189d16);}));if(!settings['telegramChatId'])tgBot[_0x1c1b16(0x12c)](_0x225592[_0x1c1b16(0x1fb)]['id'],_0x1c1b16(0x229))[_0x1c1b16(0x23c)](_0x1e23d4=>{telegramError(_0x1e23d4);});}),tgBot['removeListener'](_0x1d8c16(0x207));});}),tgBot[_0x2d4b18(0x131)](/\/status/,_0x48bfb5=>{const _0x1b7879=_0x2d4b18;if(!validateTelegram(_0x48bfb5))return;const _0x44edd2=getBotsWithMode();let _0x45c677=_0x1b7879(0x254);config[_0x1b7879(0x1ce)](_0x509c3d=>{const _0x5f374c=_0x1b7879,_0x3e79b2=_0x44edd2[_0x5f374c(0x150)](_0x2006a9=>_0x2006a9[_0x5f374c(0x1a9)]==_0x509c3d[_0x5f374c(0x1a9)])[_0x5f374c(0x8b)];_0x45c677+=_0x5f374c(0x19b)+_0x509c3d[_0x5f374c(0x1a9)]+':\x20'+_0x509c3d[_0x5f374c(0x195)]+'\x20|\x20'+_0x3e79b2+_0x5f374c(0x24a)+_0x509c3d['live']+'\x0a';}),_0x45c677+='\x0a',_0x45c677+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x45c677+=!settings['telegramEnabled']?_0x1b7879(0x21b):_0x1b7879(0x18c),_0x45c677+=settings[_0x1b7879(0x1ba)]?settings[_0x1b7879(0xd0)]==_0x1b7879(0x1d1)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x1b7879(0x1b7)+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0x1b7879(0x12c)](_0x48bfb5['chat']['id'],_0x45c677,{'parse_mode':'HTML'})['catch'](_0x131111=>{telegramError(_0x131111);});}),tgBot[_0x2d4b18(0x131)](/\/restart/,_0x197e27=>{const _0x543a30=_0x2d4b18;if(!validateTelegram(_0x197e27))return;tgBot[_0x543a30(0x1b9)]('callback_query');const _0x2c62e3=getEnabledBots();if(_0x2c62e3[_0x543a30(0xfe)]==0x0)tgBot['sendMessage'](_0x197e27[_0x543a30(0x1fb)]['id'],_0x543a30(0x171))['catch'](_0x5c8615=>{telegramError(_0x5c8615);});else{if(_0x2c62e3[_0x543a30(0xfe)]>0x1)_0x2c62e3[_0x543a30(0x85)]({'botID':'all'});let _0x2121dc=[],_0x159e4b=[];const _0x444b37=_0x2c62e3[_0x543a30(0xfe)]%0x4==0x0||_0x2c62e3[_0x543a30(0xfe)]%0x4==0x3||_0x2c62e3[_0x543a30(0xfe)]%0x3==0x1?0x4:0x3;let _0xe8b01b=0x0;_0x2c62e3[_0x543a30(0x1ce)]((_0x6550ef,_0x21cd98)=>{const _0x138c37=_0x543a30;if(_0x21cd98%_0x444b37==0x0)_0x159e4b=[];_0x159e4b[_0x138c37(0x85)]({'text':_0x6550ef[_0x138c37(0x1a9)]==_0x138c37(0x1d1)?_0x138c37(0x258):'Bot\x20'+_0x6550ef['botID'],'callback_data':_0x6550ef[_0x138c37(0x1a9)]}),_0x21cd98%_0x444b37==0x0&&(_0x2121dc[_0xe8b01b]=_0x159e4b,_0xe8b01b++);}),tgBot['sendMessage'](_0x197e27[_0x543a30(0x1fb)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x2121dc}})[_0x543a30(0x23c)](_0x2f99ab=>{telegramError(_0x2f99ab);}),tgBot['on'](_0x543a30(0x207),async _0x171cdf=>{const _0x3e4fd2=_0x543a30,_0xcf42ce=_0x171cdf[_0x3e4fd2(0x75)],_0x33dbda=_0x171cdf['message'];tgBot[_0x3e4fd2(0xe1)](_0x171cdf['id'])[_0x3e4fd2(0xde)](async()=>{const _0x78cb21=_0x3e4fd2;_0xcf42ce==_0x78cb21(0x1d1)?config[_0x78cb21(0x1ce)](_0x5ea528=>{const _0x1ae054=_0x78cb21;restartBot(_0x5ea528[_0x1ae054(0x1a9)]);}):restartBot(_0xcf42ce);}),tgBot[_0x3e4fd2(0x1b9)](_0x3e4fd2(0x207));});}}),tgBot[_0x2d4b18(0x131)](/\/on/,_0x3f27f8=>{const _0x575ddb=_0x2d4b18;if(!validateTelegram(_0x3f27f8))return;tgBot[_0x575ddb(0x1b9)](_0x575ddb(0x207));const _0x16e1e1=getDisabledBots();if(_0x16e1e1[_0x575ddb(0xfe)]==0x0)tgBot['sendMessage'](_0x3f27f8[_0x575ddb(0x1fb)]['id'],_0x575ddb(0x109))['catch'](_0x208b3e=>{telegramError(_0x208b3e);});else{if(_0x16e1e1[_0x575ddb(0xfe)]>0x1)_0x16e1e1[_0x575ddb(0x85)]({'botID':'all'});let _0x9afc4c=[],_0x353329=[];const _0x2f6087=_0x16e1e1[_0x575ddb(0xfe)]%0x4==0x0||_0x16e1e1['length']%0x4==0x3||_0x16e1e1[_0x575ddb(0xfe)]%0x3==0x1?0x4:0x3;let _0xeda899=0x0;_0x16e1e1[_0x575ddb(0x1ce)]((_0x11b82c,_0x319576)=>{const _0x3beb8e=_0x575ddb;if(_0x319576%_0x2f6087==0x0)_0x353329=[];_0x353329['push']({'text':_0x11b82c[_0x3beb8e(0x1a9)]==_0x3beb8e(0x1d1)?_0x3beb8e(0x258):_0x3beb8e(0x19b)+_0x11b82c[_0x3beb8e(0x1a9)],'callback_data':_0x11b82c[_0x3beb8e(0x1a9)]}),_0x319576%_0x2f6087==0x0&&(_0x9afc4c[_0xeda899]=_0x353329,_0xeda899++);}),tgBot[_0x575ddb(0x12c)](_0x3f27f8['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x9afc4c}})[_0x575ddb(0x23c)](_0x5e48e7=>{telegramError(_0x5e48e7);}),tgBot['on'](_0x575ddb(0x207),async _0x347184=>{const _0x3e0878=_0x575ddb,_0x277f0d=_0x347184['data'],_0x3598cf=_0x347184[_0x3e0878(0x233)];tgBot[_0x3e0878(0xe1)](_0x347184['id'])['then'](async()=>{const _0x3714b3=_0x3e0878;_0x277f0d=='all'?(tgBot[_0x3714b3(0x12c)](_0x3598cf[_0x3714b3(0x1fb)]['id'],_0x3714b3(0xdc))[_0x3714b3(0x23c)](_0x2ef1f4=>{telegramError(_0x2ef1f4);}),_0x16e1e1['forEach'](_0x1f0035=>{const _0x263264=_0x3714b3;if(_0x1f0035[_0x263264(0x1a9)]!='all')toggleBot(_0x1f0035['botID'],toggleStatus(_0x1f0035['botID']),'stopped');})):(tgBot['sendMessage'](_0x3598cf[_0x3714b3(0x1fb)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x277f0d)[_0x3714b3(0x23c)](_0x536832=>{telegramError(_0x536832);}),toggleBot(_0x277f0d,toggleStatus(_0x277f0d),_0x3714b3(0x19a)));}),tgBot[_0x3e0878(0x1b9)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x2b4960=>{const _0x1d94ea=_0x2d4b18;if(!validateTelegram(_0x2b4960))return;tgBot[_0x1d94ea(0x1b9)](_0x1d94ea(0x207));const _0x42a5f2=getEnabledBots();if(_0x42a5f2[_0x1d94ea(0xfe)]==0x0)tgBot[_0x1d94ea(0x12c)](_0x2b4960['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x1d94ea(0x23c)](_0x1707e3=>{telegramError(_0x1707e3);});else{if(_0x42a5f2['length']>0x1)_0x42a5f2['push']({'botID':'all'});let _0x2c59a7=[],_0x2bb01e=[];const _0x23c8ef=_0x42a5f2['length']%0x4==0x0||_0x42a5f2[_0x1d94ea(0xfe)]%0x4==0x3||_0x42a5f2[_0x1d94ea(0xfe)]%0x3==0x1?0x4:0x3;let _0xf243ec=0x0;_0x42a5f2[_0x1d94ea(0x1ce)]((_0x101f1d,_0x37e252)=>{const _0x550fa1=_0x1d94ea;if(_0x37e252%_0x23c8ef==0x0)_0x2bb01e=[];_0x2bb01e[_0x550fa1(0x85)]({'text':_0x101f1d[_0x550fa1(0x1a9)]==_0x550fa1(0x1d1)?_0x550fa1(0x258):'Bot\x20'+_0x101f1d['botID'],'callback_data':_0x101f1d[_0x550fa1(0x1a9)]}),_0x37e252%_0x23c8ef==0x0&&(_0x2c59a7[_0xf243ec]=_0x2bb01e,_0xf243ec++);}),tgBot['sendMessage'](_0x2b4960[_0x1d94ea(0x1fb)]['id'],_0x1d94ea(0x159),{'reply_markup':{'inline_keyboard':_0x2c59a7}})[_0x1d94ea(0x23c)](_0x1f3f23=>{telegramError(_0x1f3f23);}),tgBot['on'](_0x1d94ea(0x207),async _0x1e0eb1=>{const _0x513b08=_0x1d94ea,_0x17b37d=_0x1e0eb1[_0x513b08(0x75)],_0x153592=_0x1e0eb1[_0x513b08(0x233)];tgBot[_0x513b08(0xe1)](_0x1e0eb1['id'])[_0x513b08(0xde)](async()=>{const _0x1ff82b=_0x513b08;_0x17b37d=='all'?(tgBot['sendMessage'](_0x153592[_0x1ff82b(0x1fb)]['id'],_0x1ff82b(0x97))['catch'](_0x1c2394=>{telegramError(_0x1c2394);}),_0x42a5f2[_0x1ff82b(0x1ce)](_0x18ae86=>{const _0x5dcce6=_0x1ff82b;if(_0x18ae86[_0x5dcce6(0x1a9)]!=_0x5dcce6(0x1d1))toggleBot(_0x18ae86[_0x5dcce6(0x1a9)],toggleStatus(_0x18ae86[_0x5dcce6(0x1a9)]),_0x5dcce6(0x19a));})):(tgBot['sendMessage'](_0x153592['chat']['id'],_0x1ff82b(0x215)+_0x17b37d)[_0x1ff82b(0x23c)](_0x4770a7=>{telegramError(_0x4770a7);}),toggleBot(_0x17b37d,toggleStatus(_0x17b37d),_0x1ff82b(0x19a)));}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x2d4b18(0x131)](/\/metrics/,_0xb040=>{const _0x3ed946=_0x2d4b18;if(!validateTelegram(_0xb040))return;tgBot['removeListener'](_0x3ed946(0x207));const _0x2f6b5b=getEnabledBots();if(_0x2f6b5b['length']==0x0)tgBot['sendMessage'](_0xb040[_0x3ed946(0x1fb)]['id'],_0x3ed946(0x171))[_0x3ed946(0x23c)](_0x239f7e=>{telegramError(_0x239f7e);});else{if(_0x2f6b5b[_0x3ed946(0xfe)]>0x1){let _0x300b0c=[],_0x5ec5e6=[];const _0x55d898=_0x2f6b5b['length']%0x4==0x0||_0x2f6b5b[_0x3ed946(0xfe)]%0x4==0x3||_0x2f6b5b[_0x3ed946(0xfe)]%0x3==0x1?0x4:0x3;let _0x294980=0x0;_0x2f6b5b['forEach']((_0x4781ed,_0x23f541)=>{const _0x134e10=_0x3ed946;if(_0x23f541%_0x55d898==0x0)_0x5ec5e6=[];_0x5ec5e6[_0x134e10(0x85)]({'text':_0x134e10(0x19b)+_0x4781ed[_0x134e10(0x1a9)],'callback_data':_0x4781ed[_0x134e10(0x1a9)]}),_0x23f541%_0x55d898==0x0&&(_0x300b0c[_0x294980]=_0x5ec5e6,_0x294980++);}),tgBot[_0x3ed946(0x12c)](_0xb040[_0x3ed946(0x1fb)]['id'],_0x3ed946(0x72),{'reply_markup':{'inline_keyboard':_0x300b0c}})[_0x3ed946(0x23c)](_0x1e5b3e=>{telegramError(_0x1e5b3e);}),tgBot['on'](_0x3ed946(0x207),async _0x3bc53c=>{const _0x54467b=_0x3ed946,_0x3acbc7=_0x3bc53c[_0x54467b(0x75)],_0x6160ad=_0x3bc53c[_0x54467b(0x233)];tgBot['answerCallbackQuery'](_0x3bc53c['id'])['then'](async()=>{const _0x300792=_0x54467b;if(pid[_0x3acbc7])pid[_0x3acbc7][_0x300792(0x1c4)]({'function':_0x300792(0x237),'args':null});}),tgBot['removeListener'](_0x54467b(0x207));});}else{const _0xce60f5=_0x2f6b5b[0x0][_0x3ed946(0x1a9)];if(pid[_0xce60f5])pid[_0xce60f5]['send']({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2d4b18(0x131)](/\/portfolio/,_0x3fedd9=>{const _0x346725=_0x2d4b18;if(!validateTelegram(_0x3fedd9))return;tgBot['removeListener'](_0x346725(0x207));const _0x3ed429=getEnabledBots();if(_0x3ed429[_0x346725(0xfe)]==0x0)tgBot[_0x346725(0x12c)](_0x3fedd9[_0x346725(0x1fb)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x346725(0x23c)](_0x53ff67=>{telegramError(_0x53ff67);});else{if(_0x3ed429[_0x346725(0xfe)]>0x1){let _0x2dc13c=[],_0x6380c5=[];const _0x19936a=_0x3ed429[_0x346725(0xfe)]%0x4==0x0||_0x3ed429[_0x346725(0xfe)]%0x4==0x3||_0x3ed429[_0x346725(0xfe)]%0x3==0x1?0x4:0x3;let _0x2e4e3d=0x0;_0x3ed429['forEach']((_0x2384cd,_0x399cb5)=>{const _0x462630=_0x346725;if(_0x399cb5%_0x19936a==0x0)_0x6380c5=[];_0x6380c5[_0x462630(0x85)]({'text':_0x462630(0x19b)+_0x2384cd['botID'],'callback_data':_0x2384cd[_0x462630(0x1a9)]}),_0x399cb5%_0x19936a==0x0&&(_0x2dc13c[_0x2e4e3d]=_0x6380c5,_0x2e4e3d++);}),tgBot[_0x346725(0x12c)](_0x3fedd9['chat']['id'],_0x346725(0x115),{'reply_markup':{'inline_keyboard':_0x2dc13c}})[_0x346725(0x23c)](_0x1d1675=>{telegramError(_0x1d1675);}),tgBot['on']('callback_query',async _0x3cb32f=>{const _0x797d2d=_0x346725,_0x2e15fd=_0x3cb32f[_0x797d2d(0x75)],_0x24907b=_0x3cb32f[_0x797d2d(0x233)];tgBot[_0x797d2d(0xe1)](_0x3cb32f['id'])[_0x797d2d(0xde)](async()=>{const _0x2f1cfd=_0x797d2d;if(pid[_0x2e15fd])pid[_0x2e15fd][_0x2f1cfd(0x1c4)]({'function':_0x2f1cfd(0x1a0),'args':null});}),tgBot[_0x797d2d(0x1b9)]('callback_query');});}else{const _0x51940e=_0x3ed429[0x0][_0x346725(0x1a9)];if(pid[_0x51940e])pid[_0x51940e][_0x346725(0x1c4)]({'function':_0x346725(0x1a0),'args':null});}}}),tgBot['onText'](/\/update/,async _0x5bd15d=>{const _0x1e83c8=_0x2d4b18;if(!validateTelegram(_0x5bd15d))return;tgBot[_0x1e83c8(0x1b9)](_0x1e83c8(0x207)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x5bd15d[_0x1e83c8(0x1fb)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x1e83c8(0x23c)](_0x4a3d34=>{telegramError(_0x4a3d34);});else!validInstallation?tgBot[_0x1e83c8(0x12c)](_0x5bd15d[_0x1e83c8(0x1fb)]['id'],_0x1e83c8(0x19f))['catch'](_0x3af0be=>{telegramError(_0x3af0be);}):(tgBot['sendMessage'](_0x5bd15d['chat']['id'],_0x1e83c8(0xce),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x1e83c8(0x122)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x1e6842=>{telegramError(_0x1e6842);}),tgBot['on'](_0x1e83c8(0x207),async _0x20a26a=>{const _0x52ab64=_0x1e83c8,_0x26e3c3=_0x20a26a[_0x52ab64(0x75)],_0xf681dc=_0x20a26a[_0x52ab64(0x233)];tgBot[_0x52ab64(0xe1)](_0x20a26a['id'])[_0x52ab64(0xde)](async()=>{const _0x5a9e10=_0x52ab64;_0x26e3c3==_0x5a9e10(0x122)&&(await tgBot[_0x5a9e10(0x12c)](_0xf681dc[_0x5a9e10(0x1fb)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x5a9e10(0x23c)](_0x3e981c=>{telegramError(_0x3e981c);}),updateBB(_0x5a9e10(0x138))),_0x26e3c3=='no'&&await tgBot[_0x5a9e10(0x12c)](_0xf681dc[_0x5a9e10(0x1fb)]['id'],_0x5a9e10(0x1c7))['catch'](_0x39ffcc=>{telegramError(_0x39ffcc);});}),tgBot[_0x52ab64(0x1b9)](_0x52ab64(0x207));}));}),tgBot[_0x2d4b18(0x131)](/\/reinstall/,async _0x49a79b=>{const _0x25dfb0=_0x2d4b18;if(!validateTelegram(_0x49a79b))return;tgBot[_0x25dfb0(0x1b9)](_0x25dfb0(0x207)),!validInstallation?tgBot[_0x25dfb0(0x12c)](_0x49a79b['chat']['id'],_0x25dfb0(0x22f))[_0x25dfb0(0x23c)](_0x4e9b99=>{telegramError(_0x4e9b99);}):(tgBot[_0x25dfb0(0x12c)](_0x49a79b[_0x25dfb0(0x1fb)]['id'],_0x25dfb0(0x1ad),{'reply_markup':{'inline_keyboard':[[{'text':_0x25dfb0(0x1cb),'callback_data':_0x25dfb0(0x122)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x246565=>{telegramError(_0x246565);}),tgBot['on']('callback_query',async _0x1c99ed=>{const _0x3e2468=_0x25dfb0,_0x88d810=_0x1c99ed[_0x3e2468(0x75)],_0x5bc084=_0x1c99ed['message'];tgBot[_0x3e2468(0xe1)](_0x1c99ed['id'])['then'](async()=>{const _0x5c342e=_0x3e2468;_0x88d810==_0x5c342e(0x122)&&(await tgBot['sendMessage'](_0x5bc084[_0x5c342e(0x1fb)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x5c342e(0x23c)](_0x18d697=>{telegramError(_0x18d697);}),updateBB(_0x5c342e(0x24e))),_0x88d810=='no'&&await tgBot[_0x5c342e(0x12c)](_0x5bc084[_0x5c342e(0x1fb)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')['catch'](_0x2de9f4=>{telegramError(_0x2de9f4);});}),tgBot['removeListener'](_0x3e2468(0x207));}));}),tgBot[_0x2d4b18(0x131)](/\/toggle/,_0x2f436b=>{const _0x5b9d7f=_0x2d4b18;if(!validateTelegram(_0x2f436b))return;tgBot[_0x5b9d7f(0x1b9)](_0x5b9d7f(0x207));const _0x31a070=getBotsWithMode();if(_0x31a070['length']==0x0)tgBot[_0x5b9d7f(0x12c)](_0x2f436b[_0x5b9d7f(0x1fb)]['id'],_0x5b9d7f(0x171))['catch'](_0x2b80e9=>{telegramError(_0x2b80e9);});else{let _0x14432f=[],_0x50112a=[];const _0x387515=0x2;let _0x429fcb=0x0;_0x31a070[_0x5b9d7f(0x1ce)]((_0x319ab0,_0x307c7e)=>{const _0x380812=_0x5b9d7f;if(_0x307c7e%_0x387515==0x0)_0x50112a=[];_0x50112a[_0x380812(0x85)]({'text':_0x380812(0x19b)+_0x319ab0[_0x380812(0x1a9)]+'\x20('+_0x319ab0[_0x380812(0x8b)]+')','callback_data':_0x319ab0[_0x380812(0x1a9)]}),_0x307c7e%_0x387515==0x0&&(_0x14432f[_0x429fcb]=_0x50112a,_0x429fcb++);}),tgBot['sendMessage'](_0x2f436b[_0x5b9d7f(0x1fb)]['id'],_0x5b9d7f(0xbe),{'reply_markup':{'inline_keyboard':_0x14432f}})['catch'](_0x3a1654=>{telegramError(_0x3a1654);}),tgBot['on'](_0x5b9d7f(0x207),async _0x98d56a=>{const _0x3155b2=_0x5b9d7f,_0x7ecbb1=_0x98d56a[_0x3155b2(0x75)],_0x22332e=_0x98d56a[_0x3155b2(0x233)];tgBot[_0x3155b2(0xe1)](_0x98d56a['id'])['then'](async()=>{const _0x36d2a0=_0x3155b2,_0x1dd4e5=_0x31a070['find'](_0x359859=>_0x359859[_0x36d2a0(0x1a9)]==_0x7ecbb1),_0x47ed9b=_0x1dd4e5[_0x36d2a0(0x8b)]==_0x36d2a0(0x1da)?_0x36d2a0(0x1a2):_0x36d2a0(0x1da);tgBot[_0x36d2a0(0x12c)](_0x22332e[_0x36d2a0(0x1fb)]['id'],_0x36d2a0(0x18a)+_0x7ecbb1+_0x36d2a0(0x170)+_0x47ed9b+_0x36d2a0(0x139))[_0x36d2a0(0x23c)](_0x434eb2=>{telegramError(_0x434eb2);}),toggleBotMode(_0x7ecbb1);}),tgBot[_0x3155b2(0x1b9)](_0x3155b2(0x207));});}}),tgBot[_0x2d4b18(0x131)](/\/names/,_0x1620f7=>{const _0xe0e0a6=_0x2d4b18;if(!validateTelegram(_0x1620f7))return;let _0x1ac670='';config[_0xe0e0a6(0x1ce)](_0x1398fa=>{const _0x3b4899=_0xe0e0a6;_0x1ac670+=_0x3b4899(0x19b)+_0x1398fa[_0x3b4899(0x1a9)]+':\x20'+_0x1398fa[_0x3b4899(0x196)]+'\x0a';}),tgBot[_0xe0e0a6(0x12c)](_0x1620f7[_0xe0e0a6(0x1fb)]['id'],_0x1ac670,{'parse_mode':_0xe0e0a6(0x1ee)})[_0xe0e0a6(0x23c)](_0xd89016=>{telegramError(_0xd89016);});}),tgBot[_0x2d4b18(0x131)](/\/disable/,_0x1c5662=>{const _0x4989bb=_0x2d4b18;if(!validateTelegram(_0x1c5662))return;tgBot[_0x4989bb(0x12c)](_0x1c5662['chat']['id'],_0x4989bb(0xbc))[_0x4989bb(0x23c)](_0x229140=>{telegramError(_0x229140);}),updateSetting(_0x4989bb(0x1ba),![]);}),tgBot[_0x2d4b18(0x131)](/\/help/,_0x1652ef=>{const _0x2aa6e8=_0x2d4b18;if(!validateTelegram(_0x1652ef))return;tgBot['sendMessage'](_0x1652ef[_0x2aa6e8(0x1fb)]['id'],_0x250371)[_0x2aa6e8(0x23c)](_0x24df4f=>{telegramError(_0x24df4f);});}),tgBot['on']('polling_error',_0x1547c9=>{const _0x1a1e49=_0x2d4b18;_0x1547c9['toString']()[_0x1a1e49(0xaa)](_0x1a1e49(0xc9))&&(logger[_0x1a1e49(0x8c)](_0x1a1e49(0x1a1)),tgBot[_0x1a1e49(0x102)](),tgBot=null,io['to'](_0x1a1e49(0x19c))[_0x1a1e49(0x1e8)]('notification',_0x1a1e49(0x1a1)));}),process[_0x2d4b18(0x16a)](_0x2d4b18(0x143),()=>{const _0xd0f695=_0x2d4b18;if(tgBot)tgBot[_0xd0f695(0x102)]();process[_0xd0f695(0x148)](0x1);}),process[_0x2d4b18(0x16a)](_0x2d4b18(0xca),()=>{const _0x1273b7=_0x2d4b18;if(tgBot)tgBot[_0x1273b7(0x102)]();process['exit'](0x1);});}}function disableTelegram(){const _0x5b813f=_0x30df4d;tgBot&&(tgBot[_0x5b813f(0x102)](),tgBot=null);}function sendTelegram(_0x6e8496,_0x3300eb){const _0x5847b8=_0x30df4d;if(settings[_0x5847b8(0x1ba)]){if(settings[_0x5847b8(0xd0)]==_0x5847b8(0x1d1)||(_0x3300eb[_0x5847b8(0x78)]==_0x5847b8(0x15f)||_0x3300eb[_0x5847b8(0x78)]==_0x5847b8(0x24d)||_0x3300eb['type']=='success')&&settings[_0x5847b8(0xd0)]==_0x5847b8(0x239)||_0x3300eb[_0x5847b8(0x78)]==_0x5847b8(0x240)&&settings[_0x5847b8(0xd0)]==_0x5847b8(0xb1)){if(tgBot&&settings['telegramChatId']){if(_0x3300eb[_0x5847b8(0x104)])tgBot[_0x5847b8(0x12c)](settings['telegramChatId'],_0x3300eb[_0x5847b8(0x196)]+_0x5847b8(0x135)+_0x3300eb[_0x5847b8(0x230)])[_0x5847b8(0x23c)](_0x5e8c8b=>{telegramError(_0x5e8c8b);});else tgBot[_0x5847b8(0x12c)](settings[_0x5847b8(0xee)],_0x5847b8(0x19b)+_0x6e8496+_0x5847b8(0x135)+_0x3300eb[_0x5847b8(0x230)])[_0x5847b8(0x23c)](_0x4cda59=>{telegramError(_0x4cda59);});}}}}async function sendTelegramMsg(_0x3add67,_0x3da9fc=_0x30df4d(0x1ee)){const _0x56a8ba=_0x30df4d;return settings['telegramEnabled']&&tgBot&&settings[_0x56a8ba(0xee)]?(await tgBot[_0x56a8ba(0x12c)](settings[_0x56a8ba(0xee)],_0x3add67,{'parse_mode':_0x3da9fc})[_0x56a8ba(0x23c)](_0x44ba7f=>{telegramError(_0x44ba7f);}),!![]):![];}function getDeviceWithIp(_0xcf3ef){const _0x515c05=_0x30df4d;return devices[_0x515c05(0x150)](_0x59631b=>_0x59631b['ip']===_0xcf3ef);}function temporaryAccess2FA(_0x2de491,_0x52c91c){const _0x4a319f=_0x30df4d;let _0x23c892=new Date(),_0x1ec560=![];if(lastIpApproval){if(_0x23c892-lastIpApproval<0x1388)_0x1ec560=!![];}lastIpApproval=new Date();if(_0x1ec560)return;tgBot&&settings[_0x4a319f(0xee)]&&(tgBot[_0x4a319f(0x1b9)]('callback_query'),tgBot[_0x4a319f(0x12c)](settings[_0x4a319f(0xee)],_0x4a319f(0x1a6)+normalizeIP(_0x52c91c)[_0x4a319f(0x23a)]+_0x4a319f(0xfa),{'parse_mode':_0x4a319f(0x1ee),'reply_markup':{'inline_keyboard':[[{'text':_0x4a319f(0x1e5),'callback_data':'5'},{'text':_0x4a319f(0xfd),'callback_data':'15'},{'text':_0x4a319f(0xd3),'callback_data':'30'},{'text':_0x4a319f(0x128),'callback_data':_0x4a319f(0x128)}]]}})['catch'](_0x45a788=>{telegramError(_0x45a788);}),tgBot['on'](_0x4a319f(0x207),async _0x3bf21a=>{const _0x2a4a8d=_0x4a319f,_0x167340=_0x3bf21a['data'],_0x51273f=_0x3bf21a[_0x2a4a8d(0x233)];tgBot[_0x2a4a8d(0xe1)](_0x3bf21a['id'])['then'](async()=>{const _0x313e40=_0x2a4a8d;devices[_0x2de491][_0x313e40(0x161)]={'clientip':_0x52c91c,'timestamp':new Date()['getTime'](),'expiry':_0x167340},_0x167340!=_0x313e40(0x128)?(await tgBot[_0x313e40(0x12c)](_0x51273f[_0x313e40(0x1fb)]['id'],_0x313e40(0x80)+_0x167340+_0x313e40(0x163),{'parse_mode':_0x313e40(0x1ee)})[_0x313e40(0x23c)](_0x5ddfc9=>{telegramError(_0x5ddfc9);}),io['to'](_0x2de491)[_0x313e40(0x1e8)](_0x313e40(0x195),{'access':{'allow':![],'reason':_0x313e40(0x1d6),'token':null}})):(await tgBot[_0x313e40(0x12c)](_0x51273f['chat']['id'],_0x313e40(0xa5))[_0x313e40(0x23c)](_0x3ff11c=>{telegramError(_0x3ff11c);}),io['to'](_0x2de491)[_0x313e40(0x1e8)](_0x313e40(0x195),{'access':{'allow':![],'reason':_0x313e40(0x253),'token':null}}));}),tgBot[_0x2a4a8d(0x1b9)](_0x2a4a8d(0x207));}));}function loginAccess2FA(_0x56ac0a,_0x24b457){const _0x2ca68e=_0x30df4d;tgBot&&settings[_0x2ca68e(0xee)]&&(tgBot[_0x2ca68e(0x1b9)](_0x2ca68e(0x207)),tgBot[_0x2ca68e(0x12c)](settings[_0x2ca68e(0xee)],_0x2ca68e(0x118)+normalizeIP(_0x24b457)[_0x2ca68e(0x23a)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2ca68e(0xbb),'callback_data':loginExpiry},{'text':_0x2ca68e(0x128),'callback_data':_0x2ca68e(0x128)}]]}})[_0x2ca68e(0x23c)](_0x31c905=>{telegramError(_0x31c905);}),tgBot['on'](_0x2ca68e(0x207),async _0xda1d09=>{const _0xf14eb1=_0x2ca68e,_0x3e3a0f=_0xda1d09['data'],_0x1eaa91=_0xda1d09[_0xf14eb1(0x233)];tgBot[_0xf14eb1(0xe1)](_0xda1d09['id'])['then'](async()=>{const _0x58548e=_0xf14eb1;devices[_0x56ac0a][_0x58548e(0x8f)]={'clientip':_0x24b457,'timestamp':new Date()[_0x58548e(0x13b)](),'expiry':_0x3e3a0f},_0x3e3a0f!=_0x58548e(0x128)?(await tgBot[_0x58548e(0x12c)](_0x1eaa91[_0x58548e(0x1fb)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0x58548e(0x23c)](_0x3b3d77=>{telegramError(_0x3b3d77);}),io['to'](_0x56ac0a)[_0x58548e(0x1e8)](_0x58548e(0x195),{'access':{'allow':![],'reason':_0x58548e(0x1d6),'token':null}})):(await tgBot[_0x58548e(0x12c)](_0x1eaa91[_0x58548e(0x1fb)]['id'],_0x58548e(0x6f))['catch'](_0x2c0d0a=>{telegramError(_0x2c0d0a);}),io['to'](_0x56ac0a)[_0x58548e(0x1e8)](_0x58548e(0x195),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0xf14eb1(0x1b9)](_0xf14eb1(0x207));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4aac11=_0x30df4d;return dbConfig[_0x4aac11(0x23f)](_0x4aac11(0x23e))[_0x4aac11(0xa2)](_0x4aac11(0x1a9))['filter']({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x28f91a=_0x30df4d;return dbConfig['get'](_0x28f91a(0x23e))[_0x28f91a(0xa2)](_0x28f91a(0x1a9))[_0x28f91a(0x25a)]({'status':_0x28f91a(0x14e)})[_0x28f91a(0x73)]()||[];}function getBotAttributes(_0x359c02){const _0x4ffc2e=_0x30df4d;let _0x4816ae={};const _0x33926b=configpath+'bot-'+_0x359c02+_0x4ffc2e(0x20d),_0x128eb7=fs[_0x4ffc2e(0x16d)](_0x33926b);if(_0x128eb7){const _0x360c63=fs['readFileSync'](_0x33926b);try{const _0x4b0b12=JSON['parse'](_0x360c63),_0x1bf3a3=_0x4b0b12?_0x4b0b12[_0x4ffc2e(0x208)][0x0][_0x4ffc2e(0x1c2)]:![];_0x4816ae[_0x4ffc2e(0x8b)]=_0x1bf3a3?'auto':_0x4ffc2e(0x1a2),_0x4816ae[_0x4ffc2e(0x196)]=_0x4b0b12?_0x4b0b12['bot'][0x0][_0x4ffc2e(0x196)]:_0x4ffc2e(0x19b)+_0x359c02;}catch(_0x2a4e4b){_0x4816ae[_0x4ffc2e(0x8b)]=_0x4ffc2e(0x1a2),_0x4816ae['botname']=_0x4ffc2e(0x19b)+_0x359c02;}}else _0x4816ae[_0x4ffc2e(0x8b)]='manual',_0x4816ae[_0x4ffc2e(0x196)]=_0x4ffc2e(0x19b)+_0x359c02;return _0x4816ae;}function getBotsWithMode(){const _0x30e598=_0x30df4d,_0x2d7d37=dbConfig[_0x30e598(0x23f)](_0x30e598(0x23e))[_0x30e598(0xa2)](_0x30e598(0x1a9))['value']()||[];return _0x2d7d37[_0x30e598(0x1ce)](_0xf26da3=>{const _0x17c772=_0x30e598;let _0x857020=getBotAttributes(_0xf26da3['botID']);_0xf26da3[_0x17c772(0x8b)]=_0x857020[_0x17c772(0x8b)];}),_0x2d7d37;}function getBotExchanges(){const _0x216e33=_0x30df4d;let _0x518cef=[];const _0x341f3e=dbConfig['get']('bots')['sortBy'](_0x216e33(0x1a9))[_0x216e33(0x73)]()||[];_0x341f3e[_0x216e33(0x1ce)](_0x15603d=>{const _0x12ed08=_0x216e33;if(_0x15603d[_0x12ed08(0x195)]==_0x12ed08(0xe4)){const _0x290904=configpath+_0x12ed08(0x1e0)+_0x15603d[_0x12ed08(0x1a9)]+'-config.json',_0x540e92=fs[_0x12ed08(0x16d)](_0x290904);let _0x5a1865;if(_0x540e92){const _0x479e98=fs[_0x12ed08(0x226)](_0x290904);try{const _0xa7d49d=JSON['parse'](_0x479e98);_0x5a1865=_0xa7d49d?_0xa7d49d['bot'][0x0][_0x12ed08(0xff)]:null;}catch(_0x506675){}}if(_0x5a1865)_0x518cef[_0x12ed08(0x85)](_0x5a1865);}});const _0x2fd57a=[...new Set(_0x518cef)][_0x216e33(0x10d)]();return _0x2fd57a;}async function initUser(){const _0x32a95d=_0x30df4d;if(!settings[_0x32a95d(0x95)]){const _0x2e4fb9=uuidRandom();mixpanel[_0x32a95d(0x1ef)](_0x2e4fb9),updateSetting(_0x32a95d(0x95),_0x2e4fb9);}}async function initSecure(){const _0x254990=_0x30df4d;let _0x54a175=getSecure();if(!_0x54a175[_0x254990(0xa6)]('secret')){let _0x30822e=await generateKeys();_0x54a175[_0x254990(0xe7)]=_0x30822e['publicKey'],_0x54a175[_0x254990(0x219)]=_0x30822e[_0x254990(0x219)],_0x54a175[_0x254990(0x116)]=crypto[_0x254990(0x216)](0x20)[_0x254990(0x1af)](_0x254990(0x188));;storeSecure(_0x54a175);}}function getSettings(){const _0xae4989=_0x30df4d;return dbSettings[_0xae4989(0x23f)](_0xae4989(0x13f))['value']()||{};}function getSecure(){const _0x11bacf=_0x30df4d;return dbSecure[_0x11bacf(0x23f)](_0x11bacf(0x1a5))[_0x11bacf(0x73)]()||{};}function getBlacklist(){const _0x22e7b6=_0x30df4d;return dbSecure[_0x22e7b6(0x23f)]('blacklist')[_0x22e7b6(0x73)]()||[];}function broadcastToBots(_0x2d1315,_0x2843b0){const _0x406a10=_0x30df4d;config[_0x406a10(0x1ce)](_0x86a4fb=>{const _0x659123=_0x406a10;if(_0x86a4fb[_0x659123(0x195)]==_0x659123(0xe4)&&_0x86a4fb[_0x659123(0xd4)]==_0x659123(0x117)||_0x86a4fb[_0x659123(0x195)]==_0x659123(0x257)&&_0x86a4fb[_0x659123(0xd4)]==_0x659123(0x117)){if(pid[_0x86a4fb['botID']])pid[_0x86a4fb['botID']][_0x659123(0x1c4)]({[_0x2d1315]:_0x2843b0});}});}function storeSettings(_0x19e3dd,_0x4fb4ac=![]){const _0x48167f=_0x30df4d;_0x19e3dd={...settings,..._0x19e3dd};if(_0x4fb4ac&&_0x19e3dd['bbPassword']!='************'&&_0x19e3dd[_0x48167f(0x242)]!=_0x48167f(0xf4)&&_0x19e3dd['bbPassword']!=''){const _0xe90f92=crypt[_0x48167f(0x22a)](secure[_0x48167f(0x219)],_0x19e3dd[_0x48167f(0x242)])[_0x48167f(0x233)][_0x48167f(0x205)]('@')[0x0],_0x136b79=bcrypt[_0x48167f(0x185)](_0xe90f92,saltRounds);_0x19e3dd={..._0x19e3dd,'bbPassword':_0x136b79};}if(_0x4fb4ac&&_0x19e3dd[_0x48167f(0x23b)]!=_0x48167f(0x98)&&_0x19e3dd['telegramToken']!=_0x48167f(0xf4)&&_0x19e3dd['telegramToken']!=''){const _0x4f42da=crypt[_0x48167f(0x22a)](secure[_0x48167f(0x219)],_0x19e3dd[_0x48167f(0x23b)])[_0x48167f(0x233)][_0x48167f(0x205)]('@')[0x0];_0x19e3dd={..._0x19e3dd,'telegramToken':_0x4f42da};}const _0x1644b2=_0x19e3dd[_0x48167f(0x23b)]!=_0x48167f(0x98)&&_0x19e3dd['telegramToken']!=settings[_0x48167f(0x23b)]||_0x19e3dd[_0x48167f(0x21d)]!=settings[_0x48167f(0x21d)],_0x34adf3=_0x19e3dd[_0x48167f(0x23b)]==''||_0x19e3dd['telegramUsername']=='';if(_0x1644b2)_0x19e3dd[_0x48167f(0xd0)]=_0x48167f(0x1d1);for(const [_0x1b9553,_0x2e4b88]of Object[_0x48167f(0x189)](_0x19e3dd)){if(_0x1b9553==_0x48167f(0x23b)&&_0x2e4b88==_0x48167f(0x98)){_0x19e3dd[_0x48167f(0x23b)]=settings[_0x48167f(0x23b)];continue;};if(_0x1b9553==_0x48167f(0x242)&&_0x2e4b88==_0x48167f(0x98)){_0x19e3dd[_0x48167f(0x242)]=settings[_0x48167f(0x242)];continue;};dbSettings[_0x48167f(0x18b)]('settings.'+_0x1b9553,_0x2e4b88)['write']();}settings=_0x19e3dd,io['to'](_0x48167f(0x19c))[_0x48167f(0x1e8)](_0x48167f(0x13f),cleanSettings()),broadcastToBots(_0x48167f(0xc2),settings[_0x48167f(0xc2)]),broadcastToBots(_0x48167f(0x153),settings['onepagemode']);if(_0x1644b2&&!_0x34adf3)initTelegram();if(_0x1644b2&&_0x34adf3)disableTelegram();getAllClients()['forEach'](_0x10ac7e=>{const _0x3b2b06=_0x48167f;getSocket(_0x10ac7e['id'])[_0x3b2b06(0x1e8)](_0x3b2b06(0x195),{'access':{'allow':![],'reason':_0x3b2b06(0x1d6),'token':null}});});}function updateSetting(_0x3193e1,_0x589a03){const _0x3dfa69=_0x30df4d;dbSettings[_0x3dfa69(0x18b)](_0x3dfa69(0x198)+_0x3193e1,_0x589a03)[_0x3dfa69(0x1b6)](),settings=getSettings(),io['to'](_0x3dfa69(0x19c))[_0x3dfa69(0x1e8)](_0x3dfa69(0x13f),cleanSettings());}function storeSecure(_0x1a77aa){const _0x86b316=_0x30df4d;dbSecure[_0x86b316(0x23f)]('secure')['push'](_0x1a77aa)[_0x86b316(0x1b6)](),secure=_0x1a77aa;}function addBlacklist(_0x1f0030){const _0x240b4c=_0x30df4d;cleanBlacklist();let _0xbde517;devices[_0x1f0030][_0x240b4c(0x161)]?_0xbde517=Math['max'](devices[_0x1f0030][_0x240b4c(0x161)][_0x240b4c(0x7c)],loginExpiry):_0xbde517=loginExpiry,dbSecure['get']('blacklist')[_0x240b4c(0x85)]({'expiry':new Date()[_0x240b4c(0x13b)]()+_0xbde517*0x3c*0x3e8,'token':devices[_0x1f0030][_0x240b4c(0xf3)][_0x240b4c(0x20c)]})[_0x240b4c(0x1b6)](),blacklist=dbSecure[_0x240b4c(0x23f)](_0x240b4c(0x1ff))['value']();}function cleanBlacklist(){const _0x23131f=_0x30df4d;let _0x1aa7b0=dbSecure[_0x23131f(0x23f)](_0x23131f(0x1ff))[_0x23131f(0x1c5)]()[_0x23131f(0x73)](),_0x18c42f=new Date()['getTime']();_0x1aa7b0['forEach'](_0x50d90f=>{const _0x598ce0=_0x23131f;_0x50d90f['expiry']<_0x18c42f&&dbSecure['get'](_0x598ce0(0x1ff))[_0x598ce0(0x220)]({'expiry':_0x50d90f['expiry']})[_0x598ce0(0x1b6)]();});}function initStates(){let _0x4bfc6a=getConfiguration();_0x4bfc6a['forEach'](_0x5166cb=>{const _0x347473=_0x5805;_0x5166cb[_0x347473(0xd4)]='stopped';}),storeConfiguration(_0x4bfc6a);}function onKeys(){const _0x3ddda8=new RSA();return new Promise(_0x41a0bd=>{const _0x30ac39=_0x5805;_0x3ddda8[_0x30ac39(0x106)]()[_0x30ac39(0xde)](_0x4b36b2=>{_0x41a0bd(_0x4b36b2);});});}async function generateKeys(){return await onKeys();}function _0x4c9d(){const _0x2114e3=['environment','name','emit','Ok,\x20will\x20send\x20alert\x20notifications\x20only','toIPv4Address','Error\x20while\x20deleting\x20config\x20files:\x20','getMonth','date-fns','HTML','alias','createServer','bbvReceive','\x1b[0m','temporaryAccessAllowed',':\x20Bot\x20Mgr\x20>\x20','sha256','getStartingBalances','Orders','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','isIPv4MappedAddress','node-telegram-bot-api','chat','title','pidExpireLogin','randomFillSync','blacklist','latestversion','defaults','All','initclient','child_process','split','post','callback_query','bot','store-fiat','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','getFullYear','token','-config.json','from','Notifications\x20enabled','login','-events.json','Backup\x20file\x20unzipped\x20and\x20stored','request','apiPassword','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','randomBytes','Server','\x1b[33m','privateKey','No\x20authentication\x20token','Notifications\x20disabled\x0a','\x1b[31m','telegramUsername','apiKey','show-config','remove','storeConfiguration','exp','uuid','Alerts','referer','readFileSync','test','binary','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','decrypt','backup-full@','Enabled\x20Bot\x20','clients','internal','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','event','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','axios','message','Invalid\x20IP\x20address','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','crypto','sendMetricsTelegram','Logged\x20out\x20user\x20...','alerts','show','telegramToken','catch','unlinkSync','bots','get','order','Unauthorized\x20attempt\x20to\x20add\x20bot','bbPassword','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','graphql-request','util','Unauthorized\x20attempt\x20to\x20delete\x20bot','temp/','login\x20token\x20generated','Ok,\x20will\x20send\x20order\x20notifications\x20only','\x20|\x20','remoteAddress','kill','warning','reinstall','Invalid\x20authentication\x20token\x20(2)','#RES#\x20if\x20running\x20on\x20server','address','/output-000.log','temporary\x20access\x20rejected','<b>Balance\x20Bot\x20Status:</b>\x0a','jsonwebtoken','username','new','All\x20bots','Unauthorized\x20attempt\x20to\x20delete\x20alerts','filter','60360vGLzil','Invalid\x20username\x20or\x20IP\x20address','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Login\x20rejected','listen','build','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','value','writeFileSync','data','apiSecret','match','type','Unauthorized\x20attempt\x20to\x20update\x20bot','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','expiry','port','rmSync','generate','Access\x20enabled\x20for\x20','2FA\x20login\x20required','2FA','padStart','search','push','Deleted\x20Bot\x20','messages','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Markdown','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','mode','full','/:bot/configuration','logged\x20out','telegram2FaApproval','connection','$1_$2_$3','debug','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','userid','loginRequired','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','************','Starting\x20new\x20bot\x20|\x20Bot\x20','sockets','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','clientip','mkdirSync','logout','slice','/names\x20-\x20show\x20bot\x20names\x0a','size','sortBy','express','output-003.log','Temporary\x20access\x20rejected','hasOwnProperty','\x20(1)','ipaddr.js','/:bot/support','includes','1000','handshake','stop','980168HEcHgs','bb-secure.json','2FA\x20login\x20token\x20generated','orders','emitHistory','password','lowdb/adapters/FileSync','#RES#\x20if\x20running\x20locally\x0a','params','backup/','Starting\x20bot\x20|\x20Bot\x20','\x20(2)','config/','accept','Notifications\x20disabled','temporary\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','function','You\x20can\x20use\x20the\x20following\x20commands:\x0a','timeshift','Unauthorized\x20attempt\x20to\x20download\x20','cancel-loading','format','getUTCHours','Restore\x20process\x20aborted','306876NHzMPv','404\x20Not\x20Found','SIGTERM','193828WyRAAE','-results.json','isValid','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','(((.+)+)+)+$','telegramEvents','private','::1','30\x20min','live','inherit','parse','argv','headers','replace','new-disabled','args','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','host','then','Restoring\x20bot(s)\x20from\x20backup','uncaughtException','answerCallbackQuery','whitelistEnabled','logs','enabled','RSA','f2aRequired','publicKey','updatebotmanager','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','logs/','bcryptjs','storeFiat','simple','telegramChatId','174QTrxpS','versions','/restart\x20-\x20restart\x20bot(s)\x0a','number','access','***','Unauthorized\x20login\x20attempt\x20(timeout)','/upload-backup','tkn','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','store-headless','</b>\x20?','readdirSync','backup-files','15\x20min','length','exchange','store-configuration','lastmsgemitted','stopPolling','get-portfolio','showname','bb/','generateKeyPairAsync','reason','output-002.log','All\x20bots\x20running\x20right\x20now','resetHistory','lastmsgtelegram','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','sort','isDirectory','sign','Restarting\x20Bot\x20','Node.js\x20v','DEFLATE','-----------------------------------------------------------------------------------','deleteHistoryAlerts','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','secret','running','Allow\x20login\x20from\x20IP\x20address\x20<b>','/metrics\x20-\x20show\x20bot\x20performance\x0a','add','6b67f3d61ee94b8f5c80b4affef4c4d9','\x20|\x20client:\x20...','store','conn','Unauthorized\x20attempt\x20to\x20get\x20messages','Bot\x20Mgr\x20>\x20','output-000.log','yes','/:bot','Unauthorized\x20attempt\x20to\x20update\x20settings',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Error:\x20Invalid\x20argument\x20','compareSync','reject','Session\x20expired\x20for\x20user\x20...','/:bot/portfolio','version.json','sendMessage','uuid-random','assign','store-settings','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','onText','/off\x20-\x20stop\x20bot(s)\x0a','api-eu.mixpanel.com','file','\x20>\x20','place-order','node','update','\x20mode','production','getTime','confirm-message','backup','(staging)','settings','mixpanel','ipc','\x20|\x20user:\x20...','SIGINT','sendFile','Unauthorized\x20attempt\x20to\x20log\x20out','IPv4','reset-password','exit','Restore\x20backup\x20file\x20','allow','/:bot/coins','.zip','download','disabled','apply','find','login\x20token\x20valid','static','onepagemode','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','13375MwysdE','socket.io','#RES#\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','temporary\x20access\x20not\x20allowed','connected','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','2669715SXNUxz','join','error','https://api.ipify.org?format=json','telegramIpApproval','hybrid-crypto-js','\x20minutes','telegrammsg','getPortfolio','Error\x20removing\x20old\x20backup\x20files:','toggle-bot-mode','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','getMinutes','once','build2','Logged\x20in\x20user\x20...','existsSync','mtime','encryptedUuid','\x20to\x20','No\x20bots\x20running\x20right\x20now','getHours','getSeconds','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','cancelLoading','/update\x20-\x20update\x20Balance\x20Bot\x0a','success','output-001.log','=>\x20Go\x20to\x20#CYA#http://','temporary\x20access\x20timeout','ipv6','copyFileSync','kind','files','restore-backup-file','socket','placeOrder','get-logs','createWriteStream','hashSync','getDate','started','hex','entries','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','set','Notifications\x20enabled\x0a','[ip-address]','bbvNew','exec','3000','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','0.0.0','statSync','timestamp','status','botname','log','settings.','File\x20uploaded','stopped','Bot\x20','botmanager','/disable\x20-\x20disable\x20notifications\x0a','map','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','sendPortfolioTelegram','Invalid\x20Telegram\x20token','manual','bb-config.json','telegram','secure','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/status\x20-\x20show\x20bot(s)\x20status\x0a','127.0.0.1','botID','startsWith','2FA\x20required','yargs/yargs','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','User\x20has\x20been\x20validated','toString','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','invalid\x20credentials','env','\x1b[36m','Crypt','min','write','Notifications\x20types:\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','removeListener','telegramEnabled','get-messages','init','/download/:type','bb-settings.json','backup-full','backupfile','3fNtCiu','headless','add-bot','send','cloneDeep','*$1*','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','http','endsWith','toIPv4MappedAddress','Yes','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','use','forEach','lowdb','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','all','backup-full.zip','reset-history','update-bot','restart','reload','range','Idling\x20bot\x20\x20\x20|\x20Bot\x20','pidRefreshToken','auto','storeHeadless','stringify','_data','zip/','keys','bot-','/:bot/history','Password\x20has\x20been\x20reset\x20to:\x20','1474949bWvNTA','index.html','5\x20min'];_0x4c9d=function(){return _0x2114e3;};return _0x4c9d();}async function oneTimeMigration(){const _0x399d16=_0x30df4d;let _0xe441e6=getSettings(),_0x79198f=![];!_0xe441e6[_0x399d16(0xa6)]('lastmsgtelegram')&&(_0xe441e6[_0x399d16(0x10b)]=0x0,_0x79198f=!![]);!_0xe441e6[_0x399d16(0xa6)](_0x399d16(0x101))&&(_0xe441e6[_0x399d16(0x101)]=0x0,_0x79198f=!![]);!_0xe441e6[_0x399d16(0xa6)](_0x399d16(0x200))&&(_0xe441e6[_0x399d16(0x200)]='0.0.0',_0x79198f=!![]);!_0xe441e6[_0x399d16(0xa6)]('onepagemode')&&(_0xe441e6[_0x399d16(0x153)]=![],_0x79198f=!![]);if(_0x79198f)storeSettings(_0xe441e6);try{fs[_0x399d16(0xfb)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x3d2b1b=>{const _0x366ebc=_0x399d16;if(!_0x3d2b1b[_0x366ebc(0x10e)]()){if(!_0x3d2b1b[_0x366ebc(0x1e7)][_0x366ebc(0x1aa)](_0x366ebc(0x22b)))fs[_0x366ebc(0x23d)](configbackuppath+_0x3d2b1b[_0x366ebc(0x1e7)]);}else fs[_0x366ebc(0x7e)](configbackuppath+_0x3d2b1b['name'],{'recursive':!![]});});}catch(_0x5dca4c){logger[_0x399d16(0x92)](_0x399d16(0x166),_0x5dca4c);}}function storeConfiguration(_0x4b5160){const _0x53de1a=_0x30df4d;dbConfig[_0x53de1a(0x23f)](_0x53de1a(0x23e))[_0x53de1a(0x220)]()[_0x53de1a(0x1b6)](),_0x4b5160['forEach'](_0x3699c9=>{const _0x256e08=_0x53de1a;delete _0x3699c9[_0x256e08(0x8b)];}),dbConfig[_0x53de1a(0x23f)]('bots')[_0x53de1a(0x85)](..._0x4b5160)[_0x53de1a(0x1b6)](),config=_0x4b5160;}function resetPassword(){const _0xe06cd8=_0x30df4d;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0xe06cd8(0x207)),tgBot[_0xe06cd8(0x12c)](settings[_0xe06cd8(0xee)],_0xe06cd8(0x191),{'parse_mode':_0xe06cd8(0x1ee),'reply_markup':{'inline_keyboard':[[{'text':_0xe06cd8(0x122),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0xe06cd8(0x23c)](_0x3b5f05=>{telegramError(_0x3b5f05);}),tgBot['on'](_0xe06cd8(0x207),async _0x34acbe=>{const _0x26384f=_0xe06cd8,_0xa11647=_0x34acbe[_0x26384f(0x75)],_0x186204=_0x34acbe[_0x26384f(0x233)];tgBot[_0x26384f(0xe1)](_0x34acbe['id'])[_0x26384f(0xde)](async()=>{const _0x8e1ca9=_0x26384f;if(_0xa11647!='no'){const _0x3bddd7=0xf,_0x23e5d1=_0x8e1ca9(0x158),_0x2f2007=Array[_0x8e1ca9(0x20e)](crypto[_0x8e1ca9(0x1fe)](new Uint32Array(_0x3bddd7)))[_0x8e1ca9(0x19e)](_0x54b09d=>_0x23e5d1[_0x54b09d%_0x23e5d1[_0x8e1ca9(0xfe)]])['join'](''),_0x32a047=bcrypt[_0x8e1ca9(0x185)](_0x2f2007,saltRounds);storeSettings({'bbPassword':_0x32a047}),await tgBot[_0x8e1ca9(0x12c)](_0x186204[_0x8e1ca9(0x1fb)]['id'],_0x8e1ca9(0x1e2)+_0x2f2007,{'parse_mode':_0x8e1ca9(0x1ee)})[_0x8e1ca9(0x23c)](_0x3be3f4=>{telegramError(_0x3be3f4);});}else await tgBot['sendMessage'](_0x186204[_0x8e1ca9(0x1fb)]['id'],'Password\x20reset\x20rejected')[_0x8e1ca9(0x23c)](_0x44dbed=>{telegramError(_0x44dbed);});}),tgBot[_0x26384f(0x1b9)](_0x26384f(0x207));}));}async function confirmRestore(_0x3dab18,_0x36d0ef){const _0x53fc2c=_0x30df4d;io['to']('botmanager')['emit']('notification',_0x53fc2c(0xf8),_0x53fc2c(0x178)),tgBot&&settings[_0x53fc2c(0xee)]&&(tgBot['removeListener'](_0x53fc2c(0x207)),await tgBot[_0x53fc2c(0x12c)](settings[_0x53fc2c(0xee)],_0x53fc2c(0x10c),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x53fc2c(0x122),'callback_data':_0x53fc2c(0x122)},{'text':'no','callback_data':'no'}]]}})[_0x53fc2c(0x23c)](_0x3b78de=>{telegramError(_0x3b78de);}),tgBot['on'](_0x53fc2c(0x207),async _0x257ffa=>{const _0x31e0cd=_0x53fc2c,_0x588eef=_0x257ffa['data'],_0x173dc9=_0x257ffa[_0x31e0cd(0x233)];tgBot[_0x31e0cd(0xe1)](_0x257ffa['id'])[_0x31e0cd(0xde)](async()=>{const _0x447727=_0x31e0cd;_0x588eef==_0x447727(0x122)?(await tgBot[_0x447727(0x12c)](_0x173dc9[_0x447727(0x1fb)]['id'],_0x447727(0xdf),{'parse_mode':_0x447727(0x1ee)})[_0x447727(0x23c)](_0x1e929f=>{telegramError(_0x1e929f);}),unzipFile(_0x3dab18,_0x36d0ef)):(logger['debug']('Restore\x20process\x20aborted'),await tgBot[_0x447727(0x12c)](_0x173dc9[_0x447727(0x1fb)]['id'],_0x447727(0xc7))[_0x447727(0x23c)](_0x26a502=>{telegramError(_0x26a502);}));}),tgBot[_0x31e0cd(0x1b9)](_0x31e0cd(0x207));}));}function getServerTime(){const _0x465a73=_0x30df4d,_0x36f498=new Date();return _0x36f498['getFullYear']()+'/'+(_0x36f498[_0x465a73(0x1ec)]()+0x1)[_0x465a73(0x1af)]()[_0x465a73(0x83)](0x2,'0')+'/'+_0x36f498[_0x465a73(0x186)]()[_0x465a73(0x1af)]()[_0x465a73(0x83)](0x2,'0')+'\x20'+_0x36f498[_0x465a73(0x172)]()[_0x465a73(0x1af)]()[_0x465a73(0x83)](0x2,'0')+':'+_0x36f498['getMinutes']()[_0x465a73(0x1af)]()[_0x465a73(0x83)](0x2,'0')+':'+_0x36f498[_0x465a73(0x173)]()[_0x465a73(0x1af)]()[_0x465a73(0x83)](0x2,'0');}function getTimeStamp(){const _0x3d3fb6=_0x30df4d,_0x1dd493=shiftedTime();return _0x1dd493[_0x3d3fb6(0x20b)]()+'/'+(_0x1dd493[_0x3d3fb6(0x1ec)]()+0x1)['toString']()[_0x3d3fb6(0x83)](0x2,'0')+'/'+_0x1dd493[_0x3d3fb6(0x186)]()[_0x3d3fb6(0x1af)]()[_0x3d3fb6(0x83)](0x2,'0')+'\x20'+_0x1dd493[_0x3d3fb6(0x172)]()['toString']()['padStart'](0x2,'0')+':'+_0x1dd493[_0x3d3fb6(0x169)]()[_0x3d3fb6(0x1af)]()[_0x3d3fb6(0x83)](0x2,'0')+':'+_0x1dd493['getSeconds']()[_0x3d3fb6(0x1af)]()[_0x3d3fb6(0x83)](0x2,'0');}function getCleanTimeStamp(){const _0x934bb0=_0x30df4d,_0x107f6f=shiftedTime();return _0x107f6f[_0x934bb0(0x20b)]()+(_0x107f6f[_0x934bb0(0x1ec)]()+0x1)['toString']()[_0x934bb0(0x83)](0x2,'0')+_0x107f6f[_0x934bb0(0x186)]()[_0x934bb0(0x1af)]()[_0x934bb0(0x83)](0x2,'0')+'-'+_0x107f6f[_0x934bb0(0x172)]()['toString']()[_0x934bb0(0x83)](0x2,'0')+_0x107f6f['getMinutes']()[_0x934bb0(0x1af)]()[_0x934bb0(0x83)](0x2,'0')+_0x107f6f['getSeconds']()[_0x934bb0(0x1af)]()[_0x934bb0(0x83)](0x2,'0');}function shiftedTime(){const _0x2876ff=_0x30df4d,_0x37343c=new Date();let _0x23c1b3=_0x37343c;if(settings[_0x2876ff(0xc2)]&&settings[_0x2876ff(0xc2)]!==0x0)_0x23c1b3=fns[_0x2876ff(0x11a)](_0x37343c,{'hours':settings[_0x2876ff(0xc2)]});return _0x23c1b3;}function startScheduler(){const _0x265f21=_0x30df4d,_0x449c32=new Date()[_0x265f21(0xc6)](),_0x203809=shiftedTime()['getHours']();_0x203809==0x4&&backupConfigFiles();_0x203809==0x0&&rotateLogFiles();_0x449c32%0x6==0x0&&triggerAnalytics();_0x449c32%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4eafeb){const _0x33aa1d=_0x30df4d;logger[_0x33aa1d(0x92)](_0x33aa1d(0x149)+_0x4eafeb);const _0x3da967=getBotsWithMode();_0x3da967[_0x33aa1d(0xfe)]>0x0?confirmRestore(configbackuppath,_0x4eafeb):unzipFile(configbackuppath,_0x4eafeb);}async function getBackupFiles(_0x31d3f7=null){const _0x42e234=_0x30df4d;let _0x341496=[],_0xd08fa4=fs[_0x42e234(0xfb)](configbackuppath,{'withFileTypes':!![]});_0xd08fa4[_0x42e234(0x10d)]((_0x385552,_0x5ccec5)=>_0x385552[_0x42e234(0x1e7)]<_0x5ccec5[_0x42e234(0x1e7)]?0x1:_0x5ccec5[_0x42e234(0x1e7)]<_0x385552['name']?-0x1:0x0),_0xd08fa4[_0x42e234(0x1ce)](_0x4f4b30=>{const _0x1ed79f=_0x42e234;if(!_0x4f4b30[_0x1ed79f(0x10e)]()&&_0x4f4b30[_0x1ed79f(0x1e7)]['startsWith'](_0x1ed79f(0x22b))&&_0x4f4b30[_0x1ed79f(0x1e7)][_0x1ed79f(0x1c9)](_0x1ed79f(0x14c))){const _0x588088=formatDate(fs[_0x1ed79f(0x193)](configbackuppath+_0x4f4b30['name'])[_0x1ed79f(0x16e)]);_0x341496[_0x1ed79f(0x85)]({'name':_0x4f4b30['name'],'mtime':_0x588088});}});if(_0x31d3f7)io['to'](_0x31d3f7)[_0x42e234(0x1e8)](_0x42e234(0xfc),_0x341496);else return _0x341496;}async function backupConfigFiles(){const _0x25f819=_0x30df4d;await zipFiles(_0x25f819(0x1bf));const _0x2b2850=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x25f819(0x1d2),configbackuppath+('backup-full@'+_0x2b2850+_0x25f819(0x14c)));let _0xf72c84=fs[_0x25f819(0xfb)](configbackuppath,{'withFileTypes':!![]});_0xf72c84[_0x25f819(0x10d)]((_0x2c0f04,_0x45db3e)=>_0x2c0f04['name']<_0x45db3e[_0x25f819(0x1e7)]?0x1:_0x45db3e[_0x25f819(0x1e7)]<_0x2c0f04[_0x25f819(0x1e7)]?-0x1:0x0),_0xf72c84[_0x25f819(0xfe)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0xf72c84[_0xf72c84['length']-0x1][_0x25f819(0x1e7)]);}function rotateLogFiles(){const _0x302f51=_0x30df4d,_0x2ead93=fs['statSync'](logspath+_0x302f51(0x121)),_0x6b1a99=_0x2ead93[_0x302f51(0xa1)]/0x400;if(_0x6b1a99>0x64){let _0x526a35=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x526a35['sort']((_0x5b241d,_0x49f383)=>_0x5b241d['name']<_0x49f383['name']?0x1:_0x49f383[_0x302f51(0x1e7)]<_0x5b241d[_0x302f51(0x1e7)]?-0x1:0x0),_0x526a35[_0x302f51(0x1ce)](_0x5cda04=>{const _0xc62fce=_0x302f51;if(_0x5cda04[_0xc62fce(0x1e7)]==_0xc62fce(0x108))fs[_0xc62fce(0x17d)](logspath+_0x5cda04[_0xc62fce(0x1e7)],logspath+_0xc62fce(0xa4));if(_0x5cda04[_0xc62fce(0x1e7)]=='output-001.log')fs[_0xc62fce(0x17d)](logspath+_0x5cda04[_0xc62fce(0x1e7)],logspath+_0xc62fce(0x108));_0x5cda04[_0xc62fce(0x1e7)]==_0xc62fce(0x121)&&(fs[_0xc62fce(0x17d)](logspath+_0x5cda04['name'],logspath+_0xc62fce(0x179)),fs[_0xc62fce(0x74)](logspath+_0x5cda04[_0xc62fce(0x1e7)],''));});}}async function zipFiles(_0x4f76e7){const _0xf970fc=_0x30df4d;let _0x54dce2;if(_0x4f76e7==_0xf970fc(0xe3))_0x54dce2=logspath;if(_0x4f76e7==_0xf970fc(0x13d))_0x54dce2=configpath;if(_0x4f76e7==_0xf970fc(0x1bf))_0x54dce2=configpath;let _0x2a7cff=fs[_0xf970fc(0xfb)](_0x54dce2,{'withFileTypes':!![]});const _0x3798cf=new require('node-zip')();_0x2a7cff[_0xf970fc(0x1ce)](_0x5ac08c=>{const _0x5b5f8b=_0xf970fc;if(!_0x5ac08c[_0x5b5f8b(0x10e)]()){let _0xdbaac4=fs['readFileSync'](_0x54dce2+_0x5ac08c[_0x5b5f8b(0x1e7)]);if(_0x4f76e7=='backup'){const _0x23ca20=/^bot-[0-9]{3}-config.json$/,_0x265bf6=_0x23ca20[_0x5b5f8b(0x227)](_0x5ac08c[_0x5b5f8b(0x1e7)]);if(_0x265bf6){const _0x2db759=JSON[_0x5b5f8b(0xd6)](_0xdbaac4);if(_0x2db759[_0x5b5f8b(0x208)][0x0]){_0x2db759[_0x5b5f8b(0x208)][0x0][_0x5b5f8b(0x21e)]=_0x5b5f8b(0xf4),_0x2db759[_0x5b5f8b(0x208)][0x0][_0x5b5f8b(0x76)]=_0x5b5f8b(0xf4);if(_0x2db759['bot'][0x0]['apiPassword'])_0x2db759[_0x5b5f8b(0x208)][0x0][_0x5b5f8b(0x214)]=_0x5b5f8b(0xf4);}_0xdbaac4=JSON[_0x5b5f8b(0x1dc)](_0x2db759,null,0x2);}if(_0x5ac08c[_0x5b5f8b(0x1e7)]==_0x5b5f8b(0x1be)){const _0x535a8d=JSON[_0x5b5f8b(0xd6)](_0xdbaac4);if(_0x535a8d[_0x5b5f8b(0x13f)][_0x5b5f8b(0x96)])_0x535a8d[_0x5b5f8b(0x13f)][_0x5b5f8b(0x96)]=![];if(_0x535a8d['settings']['bbPassword'])_0x535a8d[_0x5b5f8b(0x13f)][_0x5b5f8b(0x242)]=_0x5b5f8b(0xf4);if(_0x535a8d['settings']['telegramToken'])_0x535a8d['settings']['telegramToken']=_0x5b5f8b(0xf4);if(_0x535a8d[_0x5b5f8b(0x13f)][_0x5b5f8b(0xee)])_0x535a8d[_0x5b5f8b(0x13f)][_0x5b5f8b(0xee)]=null;_0xdbaac4=JSON[_0x5b5f8b(0x1dc)](_0x535a8d,null,0x2);}if(_0x5ac08c['name']!=_0x5b5f8b(0xaf))_0x3798cf[_0x5b5f8b(0x134)](_0x5ac08c[_0x5b5f8b(0x1e7)],_0xdbaac4);}else _0x3798cf[_0x5b5f8b(0x134)](_0x5ac08c['name'],_0xdbaac4);}});const _0x2e4b56=_0x3798cf[_0xf970fc(0x7f)]({'base64':![],'compression':_0xf970fc(0x112)});fs[_0xf970fc(0x74)](zippath+(_0x4f76e7+_0xf970fc(0x14c)),_0x2e4b56,_0xf970fc(0x228));}async function unzipFile(_0x4c86fd,_0x5a31c5){const _0x5c7ed4=_0x30df4d;fs[_0x5c7ed4(0xfb)](configpath,{'withFileTypes':!![]})[_0x5c7ed4(0x1ce)](_0x4c6c81=>{const _0x17173b=_0x5c7ed4;if(!_0x4c6c81['isDirectory']())fs[_0x17173b(0x7e)](configpath+_0x4c6c81[_0x17173b(0x1e7)]);});const _0x2b645e=fs[_0x5c7ed4(0x226)](_0x4c86fd+_0x5a31c5,'binary'),_0x3eb363=new require('node-zip')(_0x2b645e,{'base64':![],'checkCRC32':!![]});Object[_0x5c7ed4(0x1df)](_0x3eb363[_0x5c7ed4(0x17f)])['forEach'](_0x449ae6=>{const _0x37da84=_0x5c7ed4,_0x224604=_0x3eb363[_0x37da84(0x17f)][_0x449ae6];fs[_0x37da84(0x74)](configpath+_0x224604[_0x37da84(0x1e7)],_0x224604[_0x37da84(0x1dd)]);}),fs[_0x5c7ed4(0xfb)](temppath,{'withFileTypes':!![]})[_0x5c7ed4(0x1ce)](_0x592763=>{const _0x25fc4b=_0x5c7ed4;if(!_0x592763[_0x25fc4b(0x10e)]())fs[_0x25fc4b(0x7e)](temppath+_0x592763[_0x25fc4b(0x1e7)]);}),logger[_0x5c7ed4(0x92)](_0x5c7ed4(0x212)),process[_0x5c7ed4(0x1c4)]({'restore':!![]},_0x139c3f=>{});}async function getPublicIp(){const _0x58916f=_0x30df4d;try{const _0xe23011=await axios['get'](_0x58916f(0x160));publicip=_0xe23011[_0x58916f(0x75)]['ip'];}catch(_0x27812d){}}async function triggerAnalytics(){const _0xbe88a8=_0x30df4d;if(!publicip)await getPublicIp();const _0x41f884=getBotsWithMode();let _0x205521=0x0;_0x41f884[_0xbe88a8(0x1ce)](_0x133d9c=>{const _0x5e92d9=_0xbe88a8;if(_0x133d9c[_0x5e92d9(0x195)]==='enabled')_0x205521++;});const _0x527f76=getBotExchanges();mixpanel['track'](_0xbe88a8(0x217),{'distinct_id':settings[_0xbe88a8(0x95)],'ip':publicip,'version':serverversion,'numbots':_0x41f884[_0xbe88a8(0xfe)],'numbotsenabled':_0x205521,'exchanges':_0x527f76,'environment':environment});}async function getMessages(){const _0x4395c3=_0x30df4d,_0x5e9120=_0x4395c3(0x20a),_0xc83949=new GraphQLClient(_0x5e9120),_0x295475={'authorization':_0x4395c3(0x7b)},_0x310d75=serverversion[_0x4395c3(0x205)]('.'),_0x494503=_0x310d75[0x0]+'.'+_0x310d75[0x1],_0x545378=Math[_0x4395c3(0x1b5)](settings[_0x4395c3(0x10b)],settings[_0x4395c3(0x101)]),_0x29fb1d={'last':parseInt(_0x545378),'bbm':_0x494503},_0xd84a4d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x6a3c48;try{_0x6a3c48=await _0xc83949[_0x4395c3(0x213)](_0xd84a4d,_0x29fb1d,_0x295475);}catch(_0x4bbfb5){}if(_0x6a3c48&&_0x6a3c48[_0x4395c3(0x87)]){let _0x114266=settings[_0x4395c3(0x10b)];newMessages=[];for(const _0x318bb9 of _0x6a3c48[_0x4395c3(0x87)]){newMessages[_0x4395c3(0x85)](_0x318bb9);let _0x342025=![];_0x318bb9[_0x4395c3(0x18e)]&&(updateSetting(_0x4395c3(0x200),_0x318bb9[_0x4395c3(0x18e)]),_0x342025=isNewerVersion(serverversion,_0x318bb9[_0x4395c3(0x18e)])||serverversion==_0x318bb9[_0x4395c3(0x18e)]);if(!_0x342025&&_0x318bb9['number']>_0x114266){if(_0x318bb9['bbvReceive']==='any'||serverversion[_0x4395c3(0x1aa)](_0x318bb9[_0x4395c3(0x1f1)])){let _0x112da8=''+_0x318bb9[_0x4395c3(0x1fc)]+'\x0a\x0a'+_0x318bb9[_0x4395c3(0x233)];const _0xf43567=await sendTelegramMsg(toTelegramMarkdown(_0x112da8),_0x4395c3(0x89));if(_0xf43567)_0x114266=_0x318bb9[_0x4395c3(0xf2)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x4395c3(0x10b),_0x114266),emitMessages();}}function emitMessages(){const _0x3b2fad=_0x30df4d,_0x13e359=settings[_0x3b2fad(0x101)];let _0x234f57=[];newMessages[_0x3b2fad(0x1ce)](_0x7d831b=>{const _0x1fb5fd=_0x3b2fad;_0x7d831b['number']>_0x13e359&&_0x234f57[_0x1fb5fd(0x85)](_0x7d831b);}),_0x234f57[_0x3b2fad(0xfe)]>0x0&&getAllClients()[_0x3b2fad(0x1ce)](_0x4b1319=>{const _0x5a71f2=_0x3b2fad;getSocket(_0x4b1319['id'])[_0x5a71f2(0x1e8)](_0x5a71f2(0x233),_0x234f57);});}function confirmMessage(_0x2fb882){const _0x4f6388=_0x30df4d;updateSetting(_0x4f6388(0x101),Number(_0x2fb882));}function isNewerVersion(_0x2c6009,_0x27a46f){const _0x3452b8=_0x30df4d,_0x3cac20=_0x27a46f[_0x3452b8(0x205)]('.'),_0x31b466=_0x2c6009[_0x3452b8(0x205)]('.');for(var _0x1ad278=0x0;_0x1ad278<_0x31b466[_0x3452b8(0xfe)];_0x1ad278++){const _0xdd2e4e=~~_0x31b466[_0x1ad278],_0x251f3f=~~_0x3cac20[_0x1ad278];if(_0xdd2e4e>_0x251f3f)return!![];if(_0xdd2e4e<_0x251f3f)return![];}return![];}function toTelegramMarkdown(_0x170ed5){const _0x408c06=_0x30df4d,_0x2a6924=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xa47599=/\*{2}(.+?)\*{2}/gim;return _0x170ed5=_0x170ed5[_0x408c06(0xd9)](_0x2a6924,_0x408c06(0x91))['replace'](_0xa47599,_0x408c06(0x1c6)),_0x170ed5;}async function validateConfigFile(){const _0x50761a=_0x30df4d,_0x1512f0=dbConfig['get'](_0x50761a(0x23e))['sortBy'](_0x50761a(0x1a9))['value']()||[];if(_0x1512f0[_0x50761a(0xfe)]==0x0){let _0x9810db=0x0,_0x30e1a7=[];const _0x6aa0e2=/^bot-([0-9]{3})-config.json$/,_0x268490=fs[_0x50761a(0xfb)](configpath);_0x268490[_0x50761a(0x1ce)](_0x34b0b3=>{const _0x55e790=_0x50761a,_0x1b5872=_0x6aa0e2[_0x55e790(0x18f)](_0x34b0b3);if(_0x1b5872){const _0x21c71b=_0x1b5872[0x1];let _0x4f3063=getBotAttributes(_0x21c71b);_0x30e1a7[_0x55e790(0x85)]({'botID':_0x21c71b,'botname':_0x4f3063['botname'],'status':'disabled','live':'stopped'}),_0x9810db++;}}),_0x9810db!=0x0&&(dbConfig[_0x50761a(0x23f)]('bots')['assign'](_0x30e1a7)[_0x50761a(0x1b6)](),config=_0x30e1a7,restoredConfigFile=_0x9810db);}}async function restoreConfigNotify(_0x5cde65){const _0x20e019=_0x30df4d;let _0x1da47a;if(restoredConfigFile==0x1)_0x1da47a=_0x20e019(0x231);else _0x1da47a=_0x20e019(0x235);if(_0x5cde65)io['to'](_0x20e019(0x19c))[_0x20e019(0x1e8)]('notification',_0x1da47a);else{logger[_0x20e019(0xed)](_0x20e019(0x113)),logger[_0x20e019(0xed)](_0x1da47a),logger[_0x20e019(0xed)](_0x20e019(0x113)),logger[_0x20e019(0xed)]('');if(tgBot&&settings[_0x20e019(0xee)]&&settings['telegramEvents']!=_0x20e019(0xb1))tgBot[_0x20e019(0x12c)](settings['telegramChatId'],_0x20e019(0x120)+_0x1da47a)['catch'](_0x2f3904=>{telegramError(_0x2f3904);});}}function validateCredentials(_0x3d92b8,_0x5c85fc){const _0x14be24=_0x30df4d;if(_0x3d92b8[_0x14be24(0x256)]==settings['bbUsername']&&bcrypt[_0x14be24(0x127)](_0x3d92b8[_0x14be24(0xb3)],settings[_0x14be24(0x242)])){if(settings[_0x14be24(0xe6)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0xf3233b=generateLoginToken(_0x5c85fc);return{'allow':!![],'reason':_0x14be24(0x248),'token':_0xf3233b};}}else return{'allow':![],'reason':_0x14be24(0x1b1),'token':null};}function refreshToken(_0x44b224){const _0x2e4094=_0x30df4d,_0x5ec775=generateLoginToken(_0x44b224);return{'allow':!![],'reason':_0x2e4094(0x248),'token':_0x5ec775};}function validateAccess(_0xe7f956,_0x4fcddb,_0x2939b1){const _0x5c0704=_0x30df4d,_0x3d9758=_0x2939b1?_0x2939b1:devices[_0x4fcddb]['ip'];let _0xc65abe;const _0x103dcd=_0x1cdeb1=>{const _0x4cfdb2=_0x5805;if(settings[_0x4cfdb2(0x96)]){if(settings[_0x4cfdb2(0xe6)]){if(telegram2FaApproved(_0x4fcddb)){const _0x32f234=generateLoginToken(_0x4fcddb);return{'allow':!![],'reason':_0x4cfdb2(0xb0),'token':_0x32f234};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0xc65abe=validToken(_0x1cdeb1,_0x4fcddb),_0xc65abe[_0x4cfdb2(0xa6)](_0x4cfdb2(0x178))?{'allow':!![],'reason':_0x4cfdb2(0x151),'token':_0x1cdeb1}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x5c0704(0xe2)]){let _0x114ae5=[...settings['whitelist'],_0x5c0704(0xd2),'::ffff:127.0.0.1',_0x5c0704(0x1a8)];if(_0x114ae5[_0x5c0704(0xaa)](_0x3d9758))return _0x103dcd(_0xe7f956);else{_0xc65abe=validToken(_0xe7f956,_0x4fcddb);if(_0xc65abe[_0x5c0704(0xa6)](_0x5c0704(0x178)))return _0x103dcd(_0xe7f956);else{if(telegramIpApproved(_0x4fcddb)){const _0x2efebd=generateToken(_0x4fcddb);return _0xc65abe=_0x103dcd(_0xe7f956),_0xc65abe[_0x5c0704(0x14a)]?{'allow':!![],'reason':_0x5c0704(0xbd),'token':_0x2efebd}:_0xc65abe;}else return settings[_0x5c0704(0x1f3)]?{'allow':![],'reason':_0x5c0704(0x1ab),'token':null}:{'allow':![],'reason':_0x5c0704(0x15a),'token':null};}}}else return _0x103dcd(_0xe7f956);}function timelyDecrypt(_0x5ad009,_0x1c4e45=!![]){const _0x5167c4=_0x30df4d;if(_0x5ad009)try{const _0x45f710=crypt[_0x5167c4(0x22a)](secure[_0x5167c4(0x219)],_0x5ad009)[_0x5167c4(0x233)],_0x50fc50=_0x45f710[_0x5167c4(0x205)]('@')[0x0],_0x11f0f4=_0x45f710[_0x5167c4(0x205)]('@')[0x1],_0x3d30b2=new Date()[_0x5167c4(0x13b)]();if(_0x1c4e45){if(_0x3d30b2-_0x11f0f4<maxSecretAge*0x3e8)return _0x50fc50;else return![];}else return _0x50fc50;}catch(_0x57e3ca){return![];}else return![];}const validToken=(_0x5b6e29,_0x3a503b)=>{const _0x233ab4=_0x30df4d,_0x1b694a=devices[_0x3a503b]['ip'];if(!_0x5b6e29)return{'error':_0x233ab4(0x21a)};for(let _0x18d282 of blacklist){if(_0x18d282[_0x233ab4(0x20c)]==_0x5b6e29)return{'error':'Token\x20blacklisted'};}let _0x5bae11;try{_0x5bae11=jwt['verify'](_0x5b6e29,secure[_0x233ab4(0x116)]+_0x3a503b);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5bae11['hasOwnProperty'](_0x233ab4(0x9c))&&!_0x5bae11[_0x233ab4(0xa6)](_0x233ab4(0x256))||!_0x5bae11[_0x233ab4(0xa6)](_0x233ab4(0x222)))return{'error':_0x233ab4(0x24f)};if(!_0x5bae11[_0x233ab4(0xa6)](_0x233ab4(0x256))&&_0x5bae11[_0x233ab4(0xa6)]('clientip')){const {clientip:_0x35907f}=_0x5bae11;return _0x1b694a==_0x35907f?{'success':_0x233ab4(0x1ae)}:{'error':_0x233ab4(0x234)};}else{if(_0x5bae11[_0x233ab4(0xa6)](_0x233ab4(0x256))&&_0x5bae11['hasOwnProperty'](_0x233ab4(0x9c))){const {username:_0x1d8a49,clientip:_0x4f2621}=_0x5bae11;return settings['bbUsername']==_0x1d8a49&&_0x1b694a==_0x4f2621?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x233ab4(0x25c)};}}},generateLoginToken=_0x4462fd=>{const _0x19c224=_0x30df4d;if(_0x4462fd){const _0x33b803=devices[_0x4462fd]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x33b803},secure[_0x19c224(0x116)]+_0x4462fd,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2dae8c=>{const _0x683cc7=_0x30df4d;if(_0x2dae8c){const _0x167b0c=devices[_0x2dae8c]['ip'];return jwt[_0x683cc7(0x10f)]({'clientip':_0x167b0c},secure[_0x683cc7(0x116)]+_0x2dae8c,{'expiresIn':devices[_0x2dae8c][_0x683cc7(0x161)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x50dcbb=>{const _0x3da1a1=_0x30df4d;let _0x362d59=![];return devices[_0x50dcbb][_0x3da1a1(0x161)]&&devices[_0x50dcbb]['telegramIpApproval'][_0x3da1a1(0x7c)]!=_0x3da1a1(0x128)&&(_0x362d59=devices[_0x50dcbb][_0x3da1a1(0x161)][_0x3da1a1(0x9c)]==devices[_0x50dcbb]['ip']&&new Date()[_0x3da1a1(0x13b)]()-devices[_0x50dcbb][_0x3da1a1(0x161)][_0x3da1a1(0x194)]<devices[_0x50dcbb][_0x3da1a1(0x161)][_0x3da1a1(0x7c)]*0x3c*0x3e8),_0x362d59;},telegram2FaApproved=_0x15ae16=>{const _0x5443ae=_0x30df4d;let _0x48b6f1=![];return devices[_0x15ae16]['telegram2FaApproval']&&devices[_0x15ae16][_0x5443ae(0x8f)][_0x5443ae(0x7c)]!=_0x5443ae(0x128)&&(_0x48b6f1=devices[_0x15ae16][_0x5443ae(0x8f)][_0x5443ae(0x9c)]==devices[_0x15ae16]['ip']&&new Date()['getTime']()-devices[_0x15ae16][_0x5443ae(0x8f)][_0x5443ae(0x194)]<devices[_0x15ae16][_0x5443ae(0x8f)][_0x5443ae(0x7c)]*0x3c*0x3e8),_0x48b6f1;},normalizeIP=_0x2a8855=>{const _0x3a8532=_0x30df4d;let _0x24ce6c=null,_0x19589f=null;if(ipaddr[_0x3a8532(0xcd)](_0x2a8855)){const _0x135dc2=ipaddr[_0x3a8532(0xd6)](_0x2a8855);_0x135dc2[_0x3a8532(0x17e)]()===_0x3a8532(0x17c)?(_0x135dc2[_0x3a8532(0x1f9)]()&&(_0x24ce6c=_0x135dc2[_0x3a8532(0x1ea)]()[_0x3a8532(0x1af)]()),_0x19589f=_0x135dc2['toString']()):(_0x24ce6c=_0x135dc2[_0x3a8532(0x1af)](),_0x19589f=_0x135dc2[_0x3a8532(0x1ca)]()[_0x3a8532(0x1af)]());}return{'show':_0x24ce6c?_0x24ce6c:_0x19589f,'store':_0x19589f};};function formatDate(_0x3acb83){const _0x2a519c=_0x30df4d;return _0x3acb83[_0x2a519c(0x20b)]()+'/'+(_0x3acb83[_0x2a519c(0x1ec)]()+0x1)[_0x2a519c(0x1af)]()[_0x2a519c(0x83)](0x2,'0')+'/'+_0x3acb83[_0x2a519c(0x186)]()['toString']()[_0x2a519c(0x83)](0x2,'0')+'\x20'+_0x3acb83[_0x2a519c(0x172)]()['toString']()[_0x2a519c(0x83)](0x2,'0')+':'+_0x3acb83[_0x2a519c(0x169)]()['toString']()[_0x2a519c(0x83)](0x2,'0')+':'+_0x3acb83['getSeconds']()[_0x2a519c(0x1af)]()[_0x2a519c(0x83)](0x2,'0');}function sleep(_0x550d31){return new Promise(_0x5bc047=>setTimeout(_0x5bc047,_0x550d31));}