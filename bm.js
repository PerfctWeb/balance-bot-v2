const _0x51d13a=_0x5321;(function(_0x28e684,_0x3025ef){const _0x26c4ac=_0x5321,_0x4fd337=_0x28e684();while(!![]){try{const _0x34c783=-parseInt(_0x26c4ac(0x150))/0x1+parseInt(_0x26c4ac(0x313))/0x2*(-parseInt(_0x26c4ac(0x1a2))/0x3)+-parseInt(_0x26c4ac(0x29f))/0x4*(parseInt(_0x26c4ac(0x17e))/0x5)+parseInt(_0x26c4ac(0x1c4))/0x6+-parseInt(_0x26c4ac(0x2ff))/0x7+-parseInt(_0x26c4ac(0x1b9))/0x8*(parseInt(_0x26c4ac(0x183))/0x9)+parseInt(_0x26c4ac(0x280))/0xa;if(_0x34c783===_0x3025ef)break;else _0x4fd337['push'](_0x4fd337['shift']());}catch(_0xd8c628){_0x4fd337['push'](_0x4fd337['shift']());}}}(_0x242d,0x4de3a));const _0x466cd5=function(){let _0x40908f=!![];return function(_0x474009,_0x248e09){const _0x5b8560=_0x40908f?function(){const _0x134427=_0x5321;if(_0x248e09){const _0x4395d4=_0x248e09[_0x134427(0x167)](_0x474009,arguments);return _0x248e09=null,_0x4395d4;}}:function(){};return _0x40908f=![],_0x5b8560;};}(),_0x53a672=_0x466cd5(this,function(){const _0x3a5ccc=_0x5321;return _0x53a672[_0x3a5ccc(0x1ec)]()[_0x3a5ccc(0x2d6)](_0x3a5ccc(0x2ab))['toString']()['constructor'](_0x53a672)['search'](_0x3a5ccc(0x2ab));});_0x53a672();'use strict';process[_0x51d13a(0x1f6)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x51d13a(0x21e)),fs=require('fs'),fns=require(_0x51d13a(0x1c6)),low=require(_0x51d13a(0x2af)),FileSync=require(_0x51d13a(0x279)),path=require(_0x51d13a(0x2a2)),crypto=require(_0x51d13a(0x203)),Crypt=require('hybrid-crypto-js')[_0x51d13a(0x27e)],RSA=require(_0x51d13a(0x1e3))['RSA'],bcrypt=require(_0x51d13a(0x170)),jwt=require(_0x51d13a(0x24b)),ipaddr=require('ipaddr.js'),argv=require(_0x51d13a(0x227))(process[_0x51d13a(0x2cc)][_0x51d13a(0x27d)](0x2))[_0x51d13a(0x2cc)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x51d13a(0x270)),Mixpanel=require(_0x51d13a(0x24a)),axios=require(_0x51d13a(0x318)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x51d13a(0x285)),fileUpload=require(_0x51d13a(0x311)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x51d13a(0x236)](PORT)&&(console[_0x51d13a(0x23c)](_0x51d13a(0x186)+PORT+_0x51d13a(0x15f)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x51d13a(0x2de)]['node'];let bbpath=_0x51d13a(0x2e7),bbpath2='';const botfile=_0x51d13a(0x1f9),configfile=_0x51d13a(0x27f),settingsfile=_0x51d13a(0x2dd),securefile='bb-secure.json',environment=require('./'+bbpath2+'version.json')['environment']||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x51d13a(0x1a3)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x51d13a(0x16a)),configpath=userID?bbpath+_0x51d13a(0x189)+userID+'/':bbpath+_0x51d13a(0x189),configbackuppath=configpath+_0x51d13a(0x288),logspath=userID?bbpath+_0x51d13a(0x2a6)+userID+'/':bbpath+_0x51d13a(0x2a6),zippath=userID?bbpath+_0x51d13a(0x327)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x51d13a(0x312)](logspath+_0x51d13a(0x295),{'flags':'a'}),temppath=userID?bbpath+_0x51d13a(0x2fc)+userID+'/':bbpath+_0x51d13a(0x2fc);!fs[_0x51d13a(0x1a3)](configpath)&&fs[_0x51d13a(0x1b0)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x51d13a(0x1a3)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x51d13a(0x1a3)](zippath)&&fs[_0x51d13a(0x1b0)](zippath);!fs[_0x51d13a(0x1a3)](temppath)&&fs[_0x51d13a(0x1b0)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x51d13a(0x2bf)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x51d13a(0x2bf)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x51d13a(0x209),'onepagemode':![]}})[_0x51d13a(0x1c9)]();function _0x242d(){const _0x386f87=['stopped','userid','add-bot','startsWith','Restoring\x20bot(s)\x20from\x20backup','verify','reason','output-001.log','get-backup-files','track','chat','Login\x20rejected','/output-000.log','clientip','sort','answerCallbackQuery','find','=>\x20Go\x20to\x20#CYA#http://','show-config','download','fork','publicKey','377896BUcmEx','uuid','All\x20bots','path','Unauthorized\x20attempt\x20to\x20log\x20out','binary','cancel-loading','logs/','getMinutes','init','full','args','(((.+)+)+)+$','-results.json','Error\x20removing\x20old\x20backup\x20files:','timestamp','lowdb','reject','\x1b[0m','sockets','bbUsername','api-eu.mixpanel.com','placeOrder','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','alerts','address','Restore\x20process\x20aborted','telegramUsername','Unauthorized\x20attempt\x20to\x20delete\x20bot','accept',':\x20Bot\x20Mgr\x20>\x20','forEach','defaults','getSeconds','<b>Telegram\x20Bot\x20Status:</b>\x0a','sha256','restore-backup-file','access\x20timeout','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','confirm-message','Starting\x20#RED#Balance\x20Bot\x20v','/metrics\x20-\x20show\x20bot\x20performance\x0a','number','static','login\x20not\x20required','argv','404\x20Not\x20Found','compareSync','stringify','orders','update-bb','params','\x1b[33m','All','value','search','/:bot','username','backup','$1_$2_$3','Bot\x20','connected','bb-settings.json','versions','*$1*','disconnect','pidRefreshToken','Notifications\x20enabled','Unauthorized\x20attempt\x20to\x20show\x20configuration','ipv6','reset-history','yes','bb/','HTML','reinstall','\x20only\x0a','kill','entries','Orders','update-bot',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','min','apiSecret','privateKey','decrypt','data','login\x20required','build2','***','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','SIGINT','\x1b[31m','mode','temp/','allow','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','2548140JahcPA','\x20minutes','version','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','backup-full@','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Restore\x20backup\x20file\x20','2FA\x20login\x20token\x20generated','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','add','format','split','No\x20bots\x20running\x20right\x20now','telegramChatId','max','/download/:type','sortBy','express-fileupload','createWriteStream','250YWUhrZ','Session\x20expired\x20for\x20user\x20...','order','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','axios','readdirSync','sendMetricsTelegram','sign','#RES#\x20if\x20running\x20on\x20server','logout','Unauthorized\x20attempt\x20to\x20download\x20','127.0.0.1','lastmsgtelegram','get-messages','loginRequired','request','/upload-backup','storeFiat','emitHistory','zip/','store-configuration','onepagemode','store-settings','timeshift','/:bot/support','sendFile','Unauthorized\x20attempt\x20to\x20get\x20messages','15\x20min','getTime','77494yLTYfq','inherit','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','\x20to\x20','socket.io','headers','getDate','show','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','backup-full.zip','toIPv4MappedAddress','string','bb-secure.json','\x20|\x20user:\x20...',',\x20must\x20be\x20a\x204\x20digit\x20number','apiKey','************','debug','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Allow\x20login\x20from\x20IP\x20address\x20<b>','No\x20authentication\x20token','f2aRequired','apply','Alerts','event','clients','Invalid\x20authentication\x20token\x20(1)','bot','server','sendMessage','new-disabled','bcryptjs','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','store-fiat','node-zip','post','bbvReceive','type','backup-full','Unauthorized\x20attempt\x20to\x20get\x20portfolio','writeFileSync','Disabled\x20Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','User\x20has\x20been\x20validated','running','10ZRykLq','Bot\x20Mgr\x20>\x20','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/on\x20-\x20start\x20bot(s)\x0a','31914fLYmXO','tkn','bbvNew','Error:\x20Invalid\x20argument\x20','telegramEvents','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','config/','Error\x20while\x20deleting\x20config\x20files:\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','RSA-OAEP','Notifications\x20enabled\x0a','1000','index.html','push','delete-bot','disabled','output-003.log','telegram2FaApproval','Starting\x20bot\x20|\x20Bot\x20','\x1b[36m','output-000.log','once','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','randomFillSync','auth','exp','match','message','secret','/:bot/history','settings','2619igYONM','existsSync','send','get-portfolio','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Unauthorized\x20attempt\x20to\x20delete\x20alerts','whitelistEnabled','remove','Notifications\x20disabled\x0a','getHours','access','/help\x20-\x20show\x20available\x20commands\x0a','resetHistory','manual','mkdirSync','exchange','bot-','store','botID','deleteHistoryAlerts','all','getFullYear','filter','1400GbfErq','simple','notification','stop','Invalid\x20authentication\x20token\x20(2)','started','\x1b[35m','temporary\x20access\x20rejected','cloneDeep','conn','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','3716286dlQZNq','Notifications\x20types:\x20','date-fns','Unauthorized\x20attempt\x20to\x20update\x20bot','reload','write','temporary\x20token\x20generated','logs','Ok,\x20will\x20send\x20alert\x20notifications\x20only','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','whitelist','telegramEnabled','onText','expiry','listen','size','/disable\x20-\x20disable\x20notifications\x0a','telegramToken','rmSync','readFileSync','Yes','ipc','function','/names\x20-\x20show\x20bot\x20names\x0a','Unauthorized\x20login\x20attempt\x20(timeout)','/:bot/coins','then','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','status','botname','keys','hybrid-crypto-js','blacklist','use','</b>\x20?','.zip','Unauthorized\x20attempt\x20to\x20get\x20events','restart','telegram','live','toString','IPv4','Password\x20has\x20been\x20reset\x20to:\x20','auto','Unauthorized\x20attempt\x20to\x20confirm\x20message','padStart','remoteAddress','staging','/status\x20-\x20show\x20bot(s)\x20status\x0a','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','env','login\x20token\x20generated','(staging)','bot.js','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','30\x20min','polling_error','\x20|\x20client:\x20...','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','express','backup-files','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Logged\x20in\x20user\x20...','crypto','exit','callback_query','login','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Backup\x20file\x20unzipped\x20and\x20stored','0.0.0','name','success','/:bot/configuration','getUTCHours','backupfile','/restart\x20-\x20restart\x20bot(s)\x0a','settings.','https://api.ipify.org?format=json','place-order','storeConfiguration','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','2FA\x20required','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Invalid\x20Telegram\x20token','getPortfolio','unlinkSync','showConfig','pidExpireLogin','isDirectory','error','child_process','hex','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','isIPv4MappedAddress','::1','Backup\x20file\x20uploaded','\x20|\x20','getMonth','secure','yargs/yargs','catch','::ffff:127.0.0.1','Starting\x20Balance\x20Bot\x20reinstallation','-----------------------------------------------------------------------------------','handshake','headless','token','build','get','copyFileSync','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','/enable\x20-\x20enable\x20notifications\x0a','emit','SIGTERM','test','apiPassword','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','2FA\x20login\x20required','bbPassword','telegramIpApproval','log','enabled','<b>Balance\x20Bot\x20Status:</b>\x0a','private','hashSync','parse','encryptedUuid','replace','temporaryAccessAllowed','statSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','cancelLoading','showname','mixpanel','jsonwebtoken','\x20>\x20','includes','uncaughtException','randomBytes','messages','Login\x20accepted','socket','new','Node.js\x20v','#RES#\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','family','6b67f3d61ee94b8f5c80b4affef4c4d9','output-002.log','assign','password','-config.json','Unauthorized\x20attempt\x20to\x20update\x20settings','latestversion','All\x20bots\x20running\x20right\x20now','invalid\x20credentials','Token\x20blacklisted','hasOwnProperty','generate','delete-alerts','-events.json','get-logs','Setting\x20access:\x20','isValid','from','_data','join','-performance.json','lastmsgemitted','botmanager','logged\x20out','node-telegram-bot-api','stopPolling','files','update','bots','Idling\x20bot\x20\x20\x20|\x20Bot\x20','toggleBotMode','Invalid\x20IP\x20address','alias','lowdb/adapters/FileSync','createServer','reinstall-bb','\x20mode','slice','Crypt','bb-config.json','10597900tobyeT','endsWith','updatebotmanager','length','telegrammsg','util','removeListener','[ip-address]','backup/'];_0x242d=function(){return _0x386f87;};return _0x242d();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x51d13a(0x2bf)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x51d13a(0x2c2),'rsaStandard':_0x51d13a(0x18c)});const saltRounds=0xa,mixpanel=Mixpanel[_0x51d13a(0x2a8)](_0x51d13a(0x258),{'host':_0x51d13a(0x2b4)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x51d13a(0x1d5)]!=''&&settings[_0x51d13a(0x2ba)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x40edf0,_0x5296c0)=>{const _0xe748ad=_0x51d13a,_0x27e3e4=/#[A-Z]{3}#/g;if(typeof _0x40edf0==_0xe748ad(0x15c)){!_0x5296c0?_0x40edf0=_0x40edf0['replace'](_0x27e3e4,''):(_0x40edf0=_0x40edf0[_0xe748ad(0x243)](/#BLU#/g,'\x1b[34m'),_0x40edf0=_0x40edf0['replace'](/#RED#/g,_0xe748ad(0x2fa)),_0x40edf0=_0x40edf0[_0xe748ad(0x243)](/#YEL#/g,_0xe748ad(0x2d3)),_0x40edf0=_0x40edf0[_0xe748ad(0x243)](/#MAG#/g,_0xe748ad(0x1bf)),_0x40edf0=_0x40edf0[_0xe748ad(0x243)](/#CYA#/g,_0xe748ad(0x196)),_0x40edf0=_0x40edf0[_0xe748ad(0x243)](/#RES#/g,_0xe748ad(0x2b1)));;}return _0x40edf0;},logger={'screen':_0x2b6822=>{const _0x31b7e8=_0x51d13a;console[_0x31b7e8(0x23c)](parseColor(_0x2b6822,!![]));},'simple':_0x39b61a=>{const _0xd2fc28=_0x51d13a;console['log'](parseColor(_0x39b61a,!![])),loggerfile[_0xd2fc28(0x1c9)](util[_0xd2fc28(0x30a)](parseColor(_0x39b61a,![]))+'\x0a');},'full':async _0x3b38cd=>{const _0x2f8f4b=_0x51d13a,_0x171d63=getTimeStamp()+_0x2f8f4b(0x2bd)+_0x3b38cd;console['log'](parseColor(_0x171d63,!![])),loggerfile[_0x2f8f4b(0x1c9)](util['format'](parseColor(_0x171d63,![]))+'\x0a');if(tgBot&&settings[_0x2f8f4b(0x30d)]&&settings[_0x2f8f4b(0x187)]!=_0x2f8f4b(0x2d0))await tgBot[_0x2f8f4b(0x16e)](settings['telegramChatId'],_0x2f8f4b(0x17f)+parseColor(_0x3b38cd,![]))[_0x2f8f4b(0x228)](_0x590a21=>{telegramError(_0x590a21);});},'debug':async(_0x557e3d,_0x307420='')=>{const _0x2c29f7=_0x51d13a,_0x424237=getTimeStamp()+_0x2c29f7(0x2ef)+_0x557e3d;if(debugging)console[_0x2c29f7(0x23c)](parseColor(_0x424237,!![]));loggerfile[_0x2c29f7(0x1c9)](util['format'](parseColor(_0x424237,![]))+'\x0a');if(_0x307420){if(debugging)console['log'](_0x307420);loggerfile['write'](util[_0x2c29f7(0x30a)](_0x307420)+'\x0a');}}};process['on'](_0x51d13a(0x24e),function(_0x10e9a0){const _0x13e6fb=_0x51d13a;logger[_0x13e6fb(0x1ba)](_0x10e9a0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x51d13a(0x301)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x51d13a(0x1ff)),app=express(),http=require('http')[_0x51d13a(0x27a)](app);app[_0x51d13a(0x1e5)](fileUpload({'useTempFiles':!![]})),app['get'](_0x51d13a(0x30f),async(_0x9174bb,_0x4859d7)=>{const _0x280431=_0x51d13a,_0x1c9f32=_0x9174bb[_0x280431(0x2d2)][_0x280431(0x176)],_0x16de1b=getClientsWithBotID(_0x280431(0x26e)),_0x42ed52=_0x9174bb['headers'][_0x280431(0x2a0)],_0x208d9a=timelyDecrypt(_0x42ed52,![]),_0x23e54f=_0x16de1b[_0x280431(0x299)](_0xf60f29=>_0xf60f29[_0x280431(0x2a0)]==_0x208d9a);if(_0x23e54f){const _0x2e3cca=normalizeIP(_0x9174bb[_0x280431(0x252)][_0x280431(0x1f2)])[_0x280431(0x1b3)],_0x1ec7fd=_0x9174bb[_0x280431(0x155)]['tkn'];if(validateAccess(_0x1ec7fd,_0x208d9a,_0x2e3cca)['allow'])_0x1c9f32==_0x280431(0x2d9)&&await backupConfigFiles(),await zipFiles(_0x1c9f32),_0x4859d7[_0x280431(0x29c)](zippath+(_0x1c9f32+_0x280431(0x1e7)),_0x590e74=>{const _0xab6c39=_0x280431;_0x590e74&&(logger[_0xab6c39(0x2a9)](_0xab6c39(0x180)+_0x1c9f32),logger[_0xab6c39(0x1ba)](_0x590e74));});else logger['full'](_0x280431(0x31e)+_0x1c9f32+'\x20(1)');}else logger[_0x280431(0x2a9)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1c9f32+'\x20(2)');}),app[_0x51d13a(0x174)](_0x51d13a(0x324),async(_0x1e7b00,_0x4656e5)=>{const _0x459dd0=_0x51d13a,_0x3c744c=getClientsWithBotID('botmanager'),_0x3cbe67=_0x1e7b00[_0x459dd0(0x155)][_0x459dd0(0x2a0)],_0x4c4c23=timelyDecrypt(_0x3cbe67,![]),_0x69de9e=_0x3c744c['find'](_0x2ecef3=>_0x2ecef3[_0x459dd0(0x2a0)]==_0x4c4c23);logger['debug'](_0x459dd0(0x223));if(_0x69de9e){const _0x1cd68a=normalizeIP(_0x1e7b00[_0x459dd0(0x252)][_0x459dd0(0x1f2)])[_0x459dd0(0x1b3)],_0x458cb2=_0x1e7b00[_0x459dd0(0x155)][_0x459dd0(0x184)];if(validateAccess(_0x458cb2,_0x4c4c23,_0x1cd68a)['allow']){if(_0x1e7b00[_0x459dd0(0x272)]){const _0x50e909=_0x1e7b00['files'][_0x459dd0(0x20e)];await _0x50e909['mv'](temppath+_0x50e909[_0x459dd0(0x20a)]),_0x4656e5['send']({'status':!![],'message':'File\x20uploaded'});const _0x5cf12d=getBotsWithMode();_0x5cf12d[_0x459dd0(0x283)]>0x0?confirmRestore(temppath,_0x50e909[_0x459dd0(0x20a)]):unzipFile(temppath,_0x50e909['name']);}}else logger[_0x459dd0(0x2a9)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x459dd0(0x220));}),app[_0x51d13a(0x1e5)](express[_0x51d13a(0x2ca)](path[_0x51d13a(0x26b)](__dirname,bbpath2,'build2'))),app[_0x51d13a(0x1e5)](express[_0x51d13a(0x2ca)](path['join'](__dirname,bbpath2,_0x51d13a(0x22f)))),app[_0x51d13a(0x230)]('/',function(_0x458775,_0x1b2182){const _0x375686=_0x51d13a;_0x1b2182['sendFile'](path[_0x375686(0x26b)](__dirname,bbpath2,_0x375686(0x2f6),'index.html'));}),app['get'](_0x51d13a(0x2d7),function(_0x4e6827,_0x30de85){const _0x4bc73b=_0x51d13a;_0x30de85[_0x4bc73b(0x32d)](path[_0x4bc73b(0x26b)](__dirname,bbpath2,_0x4bc73b(0x22f),_0x4bc73b(0x18f)));}),app[_0x51d13a(0x230)]('/:bot/portfolio',(_0x33b1e1,_0x526786)=>{const _0x3f25c2=_0x51d13a;_0x526786[_0x3f25c2(0x32d)](path[_0x3f25c2(0x26b)](__dirname,bbpath2,'build',_0x3f25c2(0x18f)));}),app[_0x51d13a(0x230)]('/:bot/performance',(_0xc70d72,_0x2db6c9)=>{const _0x126297=_0x51d13a;_0x2db6c9[_0x126297(0x32d)](path[_0x126297(0x26b)](__dirname,bbpath2,_0x126297(0x22f),_0x126297(0x18f)));}),app[_0x51d13a(0x230)](_0x51d13a(0x1dd),(_0x9ad5d,_0x3b9fbc)=>{const _0x499f93=_0x51d13a;_0x3b9fbc[_0x499f93(0x32d)](path[_0x499f93(0x26b)](__dirname,bbpath2,_0x499f93(0x22f),'index.html'));}),app[_0x51d13a(0x230)](_0x51d13a(0x1a0),(_0x3720c3,_0x203c0d)=>{const _0x30ccac=_0x51d13a;_0x203c0d[_0x30ccac(0x32d)](path[_0x30ccac(0x26b)](__dirname,bbpath2,'build',_0x30ccac(0x18f)));}),app[_0x51d13a(0x230)](_0x51d13a(0x20c),(_0x2830b2,_0x488e63)=>{const _0x2c3df6=_0x51d13a;_0x488e63[_0x2c3df6(0x32d)](path['join'](__dirname,bbpath2,'build',_0x2c3df6(0x18f)));}),app[_0x51d13a(0x230)](_0x51d13a(0x32c),(_0xf33f95,_0x181cd8)=>{const _0x4afc5a=_0x51d13a;_0x181cd8[_0x4afc5a(0x32d)](path[_0x4afc5a(0x26b)](__dirname,bbpath2,_0x4afc5a(0x22f),_0x4afc5a(0x18f)));});if(HOST)http[_0x51d13a(0x1d2)](PORT,HOST);else http[_0x51d13a(0x1d2)](PORT);const io=require(_0x51d13a(0x154))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1532d7=_0x51d13a;let _0x2aaa7d=_0x1532d7(0x287);const _0x9b1de0=networkInterfaces(),_0x374d4d={};for(const _0x30074c of Object['keys'](_0x9b1de0)){for(const _0x1f4c4a of _0x9b1de0[_0x30074c]){if((_0x1f4c4a[_0x1532d7(0x257)]==_0x1532d7(0x1ed)||_0x1f4c4a[_0x1532d7(0x257)]==0x4)&&!_0x1f4c4a['internal']){const _0x2dba2d=ipaddr[_0x1532d7(0x241)](_0x1f4c4a[_0x1532d7(0x2b8)])['range']();_0x2dba2d!=_0x1532d7(0x23f)&&(!_0x374d4d[_0x30074c]&&(_0x374d4d[_0x30074c]=[]),_0x374d4d[_0x30074c][_0x1532d7(0x190)](_0x1f4c4a[_0x1532d7(0x2b8)]),_0x2aaa7d=_0x1f4c4a[_0x1532d7(0x2b8)]);}}}return{'serverip':_0x2aaa7d,'netinterfaces':_0x374d4d};}async function startServer(){const _0x5414a9=_0x51d13a,{serverip:_0x29fbc2,netinterfaces:_0x237a51}=getServerIP();logger[_0x5414a9(0x1ba)](''),logger[_0x5414a9(0x1ba)](_0x5414a9(0x22b)),await logger[_0x5414a9(0x2a9)](_0x5414a9(0x2c7)+serverversion+_0x5414a9(0x255)+(environment==_0x5414a9(0x1f3)?_0x5414a9(0x1f8):'')+'\x0a'+(_0x5414a9(0x2f8)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x5414a9(0x29a)+_0x29fbc2+':'+PORT+_0x5414a9(0x31c))),logger[_0x5414a9(0x1ba)](_0x5414a9(0x22b));if(config['length']!=0x0)for(const _0x499bed of config){if(_0x499bed[_0x5414a9(0x1e0)]==_0x5414a9(0x23d)||_0x499bed[_0x5414a9(0x1e0)]=='new')await logger[_0x5414a9(0x2a9)](_0x5414a9(0x195)+_0x499bed[_0x5414a9(0x1b4)]+_0x5414a9(0x224)+_0x499bed['botname']),startBot([_0x499bed[_0x5414a9(0x1b4)],userID],{'cwd':bbpath},function(_0x1d21ac){const _0x271a8d=_0x5414a9;if(_0x1d21ac)logger[_0x271a8d(0x2a9)](_0x1d21ac);});else(_0x499bed[_0x5414a9(0x1e0)]=='disabled'||_0x499bed[_0x5414a9(0x1e0)]==_0x5414a9(0x16f))&&await logger[_0x5414a9(0x2a9)](_0x5414a9(0x275)+_0x499bed[_0x5414a9(0x1b4)]+_0x5414a9(0x224)+_0x499bed[_0x5414a9(0x1e1)]);}else!newBot&&logger[_0x5414a9(0x1ba)](_0x5414a9(0x1fa));if(newBot)addBot();logger[_0x5414a9(0x1ba)](_0x5414a9(0x22b)),logger[_0x5414a9(0x1ba)](''),await logger[_0x5414a9(0x162)](_0x5414a9(0x254)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x237a51);}function startSocket(){io['on']('connection',_0x2fbd06=>{const _0x413ae2=_0x5321;let _0x616ad6,_0x4f02e6,_0x4ff12d,_0xbc85be,_0x103c0a;const _0x4d432f=_0x2fbd06[_0x413ae2(0x22c)][_0x413ae2(0x155)]['referer'];_0x4f02e6=_0x4d432f['match'](/bot[0-9]{3}/);if(_0x4f02e6)_0x4ff12d=_0x4f02e6[0x0][_0x413ae2(0x19d)](/[0-9]{3}/);if(_0x4ff12d)_0x616ad6=_0x4ff12d[0x0];else _0x616ad6='botmanager';const _0x3152de=_0x2fbd06[_0x413ae2(0x22c)][_0x413ae2(0x19b)][_0x413ae2(0x242)];if(!_0x3152de)_0x2fbd06['emit'](_0x413ae2(0x1e0),{'publicKey':secure[_0x413ae2(0x29e)]});else{_0xbc85be=timelyDecrypt(_0x3152de,![]);if(!_0xbc85be)_0x2fbd06[_0x413ae2(0x234)]('status',{'publicKey':secure[_0x413ae2(0x29e)]});else{_0x103c0a=normalizeIP(_0x2fbd06[_0x413ae2(0x1c2)]['remoteAddress'])['store'];if(!devices[_0xbc85be])devices[_0xbc85be]={'uuid':_0xbc85be,'access':{'token':null}};devices[_0xbc85be]['ip']=_0x103c0a;const _0x38fb7f=addClient(_0x2fbd06['id'],_0xbc85be,_0x616ad6);setAccess(_0x38fb7f),emitMessages(),_0x2fbd06['on'](_0x413ae2(0x206),_0xc2a92f=>{const _0x1b94e6=_0x413ae2,_0x3ab6aa=timelyDecrypt(_0xc2a92f[_0x1b94e6(0x25b)]);if(_0x3ab6aa){_0xc2a92f={'username':_0xc2a92f[_0x1b94e6(0x2d8)],'password':_0x3ab6aa},devices[_0xbc85be][_0x1b94e6(0x1ac)]=validateCredentials(_0xc2a92f,_0xbc85be);if(devices[_0xbc85be]['access']['allow']==![]&&devices[_0xbc85be][_0x1b94e6(0x1ac)][_0x1b94e6(0x28f)]==_0x1b94e6(0x239))_0x2fbd06['emit']('status',{'access':devices[_0xbc85be]['access']}),loginAccess2FA(_0xbc85be,_0x103c0a);else{if(devices[_0xbc85be][_0x1b94e6(0x1ac)][_0x1b94e6(0x2fd)]==![]&&devices[_0xbc85be]['access'][_0x1b94e6(0x28f)]==_0x1b94e6(0x260))_0x2fbd06[_0x1b94e6(0x234)](_0x1b94e6(0x1e0),{'access':devices[_0xbc85be][_0x1b94e6(0x1ac)]});else devices[_0xbc85be]['access'][_0x1b94e6(0x2fd)]&&devices[_0xbc85be]['access'][_0x1b94e6(0x28f)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0xbc85be)[_0x1b94e6(0x2be)](_0x24671c=>{setAccess(_0x24671c);}),logger[_0x1b94e6(0x162)](_0x1b94e6(0x202)+_0xbc85be[_0x1b94e6(0x27d)](-0x8)),setTokenRefresh(_0xbc85be),setSessionTimeout(_0x1b94e6(0x206),_0xbc85be));}}else logger[_0x1b94e6(0x2a9)](_0x1b94e6(0x1dc));}),_0x2fbd06['on']('reset-password',()=>{resetPassword();}),_0x2fbd06['on']('disconnect',_0x2463d5=>{removeClient(_0x2fbd06['id']);}),_0x616ad6=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x568d5f){const _0x2887f7=_0x51d13a;if(_0x568d5f!=_0x2887f7(0x26e)&&config[_0x2887f7(0x160)]!=''){if(pid[_0x568d5f])pid[_0x568d5f][_0x2887f7(0x1a4)]({'function':'initclient','args':null});}_0x568d5f!=_0x2887f7(0x26e)&&broadcastToBots('bots',JSON[_0x2887f7(0x2cf)](config));}function reloadBotManager(){const _0x5e9630=_0x51d13a;getClientsWithBotID(_0x5e9630(0x26e))['forEach'](_0x2df412=>{const _0x25326f=_0x5e9630;getSocket(_0x2df412['id'])[_0x25326f(0x234)](_0x25326f(0x1e0),{'access':{'allow':![],'reason':_0x25326f(0x1c8),'token':null}});});}function getSocket(_0x515178){const _0x28bd57=_0x51d13a;return io[_0x28bd57(0x2b2)][_0x28bd57(0x2b2)]['get'](_0x515178);}function setAccess(_0x67e064){const _0x49b1c5=_0x51d13a,_0x3f861d=getSocket(_0x67e064['id']),_0x401040=_0x67e064['uuid'],_0x1febc4=_0x67e064[_0x49b1c5(0x16c)];devices[_0x401040][_0x49b1c5(0x1ac)]=validateAccess(devices[_0x401040][_0x49b1c5(0x1ac)][_0x49b1c5(0x22e)],_0x401040),logger[_0x49b1c5(0x162)](_0x49b1c5(0x267)+devices[_0x401040][_0x49b1c5(0x1ac)]['reason']+_0x49b1c5(0x1fd)+_0x67e064['id'][_0x49b1c5(0x27d)](-0x8)+_0x49b1c5(0x15e)+_0x401040[_0x49b1c5(0x27d)](-0x8)),_0x3f861d['join'](_0x401040);if(devices[_0x401040][_0x49b1c5(0x1ac)][_0x49b1c5(0x2fd)]){_0x3f861d['join'](_0x1febc4);if(_0x1febc4==_0x49b1c5(0x26e))initializeSocketBotManager(_0x3f861d);else initializeSocketBot(_0x3f861d);initClient(_0x1febc4);}devices[_0x401040]['access'][_0x49b1c5(0x22e)]&&devices[_0x401040][_0x49b1c5(0x1ac)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x401040),devices[_0x401040]['access'][_0x49b1c5(0x22e)]&&devices[_0x401040][_0x49b1c5(0x1ac)]['reason']==_0x49b1c5(0x307)&&setSessionTimeout(_0x49b1c5(0x206),_0x401040),_0x3f861d[_0x49b1c5(0x234)](_0x49b1c5(0x1e0),{'status':_0x67e064[_0x49b1c5(0x16d)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x401040][_0x49b1c5(0x1ac)],'externalip':devices[_0x401040]['ip'],'publicKey':secure[_0x49b1c5(0x29e)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x401040][_0x49b1c5(0x1ac)][_0x49b1c5(0x2fd)]==![]&&devices[_0x401040][_0x49b1c5(0x1ac)]['reason']==_0x49b1c5(0x215)&&temporaryAccess2FA(_0x401040,devices[_0x401040]['ip']);}function setSessionTimeout(_0x289d1f,_0x142687){const _0x4361c8=_0x51d13a;let _0x369f74;if(_0x289d1f=='login')_0x369f74=loginExpiry*0x3c*0x3e8;else _0x369f74=devices[_0x142687][_0x4361c8(0x23b)][_0x4361c8(0x1d1)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x142687][_0x4361c8(0x23b)][_0x4361c8(0x2ae)]);if(devices[_0x142687][_0x4361c8(0x21b)])clearTimeout(devices[_0x142687][_0x4361c8(0x21b)]);devices[_0x142687][_0x4361c8(0x21b)]=setTimeout(()=>{const _0x36bfe=_0x4361c8;if(devices[_0x142687][_0x36bfe(0x2e1)])clearTimeout(devices[_0x142687]['pidRefreshToken']);removeSocketListeners(_0x142687),addBlacklist(_0x142687),devices[_0x142687][_0x36bfe(0x23b)]=null,devices[_0x142687][_0x36bfe(0x194)]=null,devices[_0x142687][_0x36bfe(0x1ac)][_0x36bfe(0x22e)]=null,logger[_0x36bfe(0x162)](_0x36bfe(0x314)+_0x142687[_0x36bfe(0x27d)](-0x8)),devices[_0x142687]['access']=validateAccess(devices[_0x142687][_0x36bfe(0x1ac)][_0x36bfe(0x22e)],_0x142687),!(devices[_0x142687][_0x36bfe(0x1ac)][_0x36bfe(0x2fd)]&&devices[_0x142687][_0x36bfe(0x1ac)]['reason']==_0x36bfe(0x2cb))&&(_0x289d1f=='login'?io['to'](_0x142687)[_0x36bfe(0x234)](_0x36bfe(0x1e0),{'access':{'allow':![],'reason':_0x36bfe(0x2c4),'token':null}}):io['to'](_0x142687)[_0x36bfe(0x234)](_0x36bfe(0x1e0),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x142687][_0x36bfe(0x1ac)]['token']=null;},_0x369f74);}function setTokenRefresh(_0x537651){const _0x500694=_0x51d13a;if(devices[_0x537651][_0x500694(0x2e1)])clearTimeout(devices[_0x537651]['pidRefreshToken']);devices[_0x537651][_0x500694(0x2e1)]=setTimeout(()=>{const _0x14e826=_0x500694;getClientsWithUuid(_0x537651)[_0x14e826(0x283)]!=0x0?(devices[_0x537651][_0x14e826(0x1ac)]=refreshToken(_0x537651),io['to'](_0x537651)['emit'](_0x14e826(0x1e0),{'status':_0x14e826(0x2dc),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x537651][_0x14e826(0x1ac)],'externalip':devices[_0x537651]['ip'],'publicKey':secure[_0x14e826(0x29e)],'validInstallation':validInstallation}),setTokenRefresh(_0x537651)):clearTimeout(devices[_0x537651]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2e2d09){const _0x1d208d=_0x51d13a,_0x2bcf52=getClient(_0x2e2d09['id'])[_0x1d208d(0x2a0)];_0x2e2d09['emit'](_0x1d208d(0x274),config),_0x2e2d09[_0x1d208d(0x234)](_0x1d208d(0x1a1),cleanSettings()),_0x2e2d09['on'](_0x1d208d(0x28b),_0x206607=>{const _0x7d2fa7=_0x1d208d;if(validateAccess(_0x206607,_0x2bcf52)[_0x7d2fa7(0x2fd)])addBot();else logger[_0x7d2fa7(0x2a9)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2e2d09['on'](_0x1d208d(0x2ee),(_0x4bc830,_0x4d345f)=>{const _0x2016c2=_0x1d208d;if(validateAccess(_0x4d345f,_0x2bcf52)[_0x2016c2(0x2fd)])toggleBot(_0x4bc830[_0x2016c2(0x1b4)],_0x4bc830['status'],_0x4bc830[_0x2016c2(0x1eb)]);else logger['full'](_0x2016c2(0x1c7));}),_0x2e2d09['on']('toggle-bot-mode',(_0x11126e,_0x531405)=>{const _0x4afe63=_0x1d208d;if(validateAccess(_0x531405,_0x2bcf52)[_0x4afe63(0x2fd)])toggleBotMode(_0x11126e);else logger['full'](_0x4afe63(0x1c7));}),_0x2e2d09['on'](_0x1d208d(0x191),(_0x572a2c,_0x366e8b)=>{const _0x996788=_0x1d208d;if(validateAccess(_0x366e8b,_0x2bcf52)['allow'])deleteBot(_0x572a2c);else logger['full'](_0x996788(0x2bb));}),_0x2e2d09['on'](_0x1d208d(0x32a),(_0xbb887b,_0xe5e9a8)=>{const _0x3708fa=_0x1d208d;if(validateAccess(_0xe5e9a8,_0x2bcf52)[_0x3708fa(0x2fd)])storeSettings(_0xbb887b,!![]);else logger['full'](_0x3708fa(0x25d));}),_0x2e2d09['on']('update-bb',_0x251066=>{if(validateAccess(_0x251066,_0x2bcf52)['allow'])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2e2d09['on'](_0x1d208d(0x27b),_0x18bee4=>{const _0x333c4e=_0x1d208d;if(validateAccess(_0x18bee4,_0x2bcf52)['allow'])updateBB(_0x333c4e(0x2e9));else logger[_0x333c4e(0x2a9)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x2e2d09['on'](_0x1d208d(0x291),_0x5c9960=>{const _0x59db3c=_0x1d208d;if(validateAccess(_0x5c9960,_0x2bcf52)[_0x59db3c(0x2fd)]){const _0x12f7bc=getClient(_0x2e2d09['id']);if(_0x12f7bc)getBackupFiles(_0x12f7bc[_0x59db3c(0x2a0)]);else logger[_0x59db3c(0x2a9)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x2e2d09['on'](_0x1d208d(0x2c3),(_0x3e0373,_0x185041)=>{const _0x3ca38f=_0x1d208d;if(validateAccess(_0x185041,_0x2bcf52)[_0x3ca38f(0x2fd)])restoreBackupFile(_0x3e0373);else logger[_0x3ca38f(0x2a9)](_0x3ca38f(0x302));}),_0x2e2d09['on'](_0x1d208d(0x321),_0xcd53d1=>{const _0x43240d=_0x1d208d;if(validateAccess(_0xcd53d1,_0x2bcf52)['allow'])getMessages();else logger[_0x43240d(0x2a9)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2e2d09['on']('confirm-message',(_0x35adad,_0x323546)=>{const _0x288cd5=_0x1d208d;if(validateAccess(_0x323546,_0x2bcf52)['allow'])confirmMessage(_0x35adad);else logger[_0x288cd5(0x2a9)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2e2d09['on'](_0x1d208d(0x31d),_0x28a169=>{const _0x8f1cf1=_0x1d208d;if(validateAccess(_0x28a169,_0x2bcf52)[_0x8f1cf1(0x2fd)]){if(devices[_0x2bcf52][_0x8f1cf1(0x2e1)])clearTimeout(devices[_0x2bcf52][_0x8f1cf1(0x2e1)]);if(devices[_0x2bcf52][_0x8f1cf1(0x21b)])clearTimeout(devices[_0x2bcf52]['pidExpireLogin']);removeSocketListeners(getClient(_0x2e2d09['id'])['uuid']),addBlacklist(_0x2bcf52),devices[_0x2bcf52][_0x8f1cf1(0x23b)]=null,devices[_0x2bcf52][_0x8f1cf1(0x194)]=null,devices[_0x2bcf52][_0x8f1cf1(0x1ac)][_0x8f1cf1(0x22e)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x2bcf52[_0x8f1cf1(0x27d)](-0x8)),io['to'](getClient(_0x2e2d09['id'])[_0x8f1cf1(0x2a0)])[_0x8f1cf1(0x234)](_0x8f1cf1(0x1e0),{'access':{'allow':![],'reason':_0x8f1cf1(0x26f),'token':null}});}else logger[_0x8f1cf1(0x2a9)](_0x8f1cf1(0x2a3));});}function initializeSocketBot(_0x3a27cc){const _0x1411e2=_0x51d13a,_0x5a6a90=getClient(_0x3a27cc['id'])[_0x1411e2(0x16c)],_0x4c54ef=getClient(_0x3a27cc['id'])[_0x1411e2(0x2a0)];_0x3a27cc['on'](_0x1411e2(0x266),(_0x3ed532,_0x36dc6a)=>{const _0x34ba5a=_0x1411e2;if(validateAccess(_0x36dc6a,_0x4c54ef)[_0x34ba5a(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x34ba5a(0x1a4)]({'function':_0x34ba5a(0x326),'args':_0x3ed532});}else logger[_0x34ba5a(0x2a9)](_0x34ba5a(0x1e8));}),_0x3a27cc['on'](_0x1411e2(0x264),(_0xb47d50,_0x1fa7af)=>{const _0x393960=_0x1411e2;if(validateAccess(_0x1fa7af,_0x4c54ef)[_0x393960(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x393960(0x1a4)]({'function':_0x393960(0x1b5),'args':_0xb47d50});}else logger[_0x393960(0x2a9)](_0x393960(0x1a7));}),_0x3a27cc['on'](_0x1411e2(0x1a5),(_0x1474d1,_0x3f0860)=>{const _0x5e98c7=_0x1411e2;if(validateAccess(_0x3f0860,_0x4c54ef)[_0x5e98c7(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90]['send']({'function':_0x5e98c7(0x218),'args':_0x1474d1});}else logger[_0x5e98c7(0x2a9)](_0x5e98c7(0x178));}),_0x3a27cc['on'](_0x1411e2(0x328),(_0x4acc40,_0x311f77)=>{const _0x3e7971=_0x1411e2;if(validateAccess(_0x311f77,_0x4c54ef)[_0x3e7971(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x3e7971(0x1a4)]({'function':_0x3e7971(0x213),'args':_0x4acc40});}else logger[_0x3e7971(0x2a9)](_0x3e7971(0x256));}),_0x3a27cc['on']('store-headless',(_0x3cca5c,_0x4c289d)=>{const _0x400c99=_0x1411e2;if(validateAccess(_0x4c289d,_0x4c54ef)[_0x400c99(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x400c99(0x1a4)]({'function':'storeHeadless','args':_0x3cca5c});}else logger[_0x400c99(0x2a9)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3a27cc['on'](_0x1411e2(0x172),(_0x48b9cc,_0x446ba1)=>{const _0x3cdaae=_0x1411e2;if(validateAccess(_0x446ba1,_0x4c54ef)[_0x3cdaae(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x3cdaae(0x1a4)]({'function':_0x3cdaae(0x325),'args':_0x48b9cc});}else logger[_0x3cdaae(0x2a9)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x3a27cc['on'](_0x1411e2(0x2e5),_0x3a77ca=>{const _0x126ba1=_0x1411e2;if(validateAccess(_0x3a77ca,_0x4c54ef)[_0x126ba1(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x126ba1(0x1a4)]({'function':_0x126ba1(0x1ae),'args':null});}else logger[_0x126ba1(0x2a9)](_0x126ba1(0x171));}),_0x3a27cc['on']('get-starting-balances',_0x47e272=>{const _0x3a1848=_0x1411e2;if(validateAccess(_0x47e272,_0x4c54ef)['allow']){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x3a1848(0x1a4)]({'function':'getStartingBalances','args':null});}else logger[_0x3a1848(0x2a9)](_0x3a1848(0x232));}),_0x3a27cc['on'](_0x1411e2(0x212),(_0x26116d,_0x1751f3)=>{const _0x33108d=_0x1411e2;if(validateAccess(_0x1751f3,_0x4c54ef)[_0x33108d(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x33108d(0x1a4)]({'function':_0x33108d(0x2b5),'args':_0x26116d});}else logger[_0x33108d(0x2a9)](_0x33108d(0x199));}),_0x3a27cc['on'](_0x1411e2(0x2a5),_0x550f81=>{const _0x354389=_0x1411e2;if(validateAccess(_0x550f81,_0x4c54ef)['allow']){if(pid[_0x5a6a90])pid[_0x5a6a90][_0x354389(0x1a4)]({'function':_0x354389(0x248),'args':null});}else logger[_0x354389(0x2a9)](_0x354389(0x181));}),_0x3a27cc['on'](_0x1411e2(0x29b),_0x563f41=>{const _0x3fbc7e=_0x1411e2;if(validateAccess(_0x563f41,_0x4c54ef)[_0x3fbc7e(0x2fd)]){if(pid[_0x5a6a90])pid[_0x5a6a90]['send']({'function':_0x3fbc7e(0x21a),'args':null});}else logger[_0x3fbc7e(0x2a9)](_0x3fbc7e(0x2e3));}),_0x3a27cc['on'](_0x1411e2(0x2d1),_0x1070f4=>{const _0x5c769e=_0x1411e2;if(validateAccess(_0x1070f4,_0x4c54ef)[_0x5c769e(0x2fd)])updateBB(_0x5c769e(0x273));else logger[_0x5c769e(0x2a9)](_0x5c769e(0x2c5));}),_0x3a27cc['on'](_0x1411e2(0x321),_0x505c4c=>{const _0x317ddf=_0x1411e2;if(validateAccess(_0x505c4c,_0x4c54ef)[_0x317ddf(0x2fd)])getMessages();else logger['full'](_0x317ddf(0x14d));}),_0x3a27cc['on'](_0x1411e2(0x2c6),(_0x5df637,_0x4f4a58)=>{const _0x2dc94b=_0x1411e2;if(validateAccess(_0x4f4a58,_0x4c54ef)[_0x2dc94b(0x2fd)])confirmMessage(_0x5df637);else logger[_0x2dc94b(0x2a9)](_0x2dc94b(0x1f0));}),_0x3a27cc['on'](_0x1411e2(0x31d),_0x32e8a8=>{const _0x483a17=_0x1411e2;if(validateAccess(_0x32e8a8,_0x4c54ef)[_0x483a17(0x2fd)]){if(devices[_0x4c54ef][_0x483a17(0x2e1)])clearTimeout(devices[_0x4c54ef][_0x483a17(0x2e1)]);if(devices[_0x4c54ef]['pidExpireLogin'])clearTimeout(devices[_0x4c54ef]['pidExpireLogin']);removeSocketListeners(getClient(_0x3a27cc['id'])[_0x483a17(0x2a0)]),addBlacklist(_0x4c54ef),devices[_0x4c54ef]['telegramIpApproval']=null,devices[_0x4c54ef][_0x483a17(0x194)]=null,devices[_0x4c54ef][_0x483a17(0x1ac)][_0x483a17(0x22e)]=null,logger[_0x483a17(0x162)]('Logged\x20out\x20user\x20...'+_0x4c54ef[_0x483a17(0x27d)](-0x8)),io['to'](getClient(_0x3a27cc['id'])['uuid'])[_0x483a17(0x234)](_0x483a17(0x1e0),{'access':{'allow':![],'reason':_0x483a17(0x26f),'token':null}});}else logger[_0x483a17(0x2a9)](_0x483a17(0x2a3));});}function removeSocketListeners(_0x1d35a9){const _0x2e2f22=_0x51d13a;getClientsWithUuid(_0x1d35a9)[_0x2e2f22(0x2be)](_0x3a7357=>{getSocket(_0x3a7357['id'])['removeAllListeners']();});}function cleanSettings(){const _0x11e262=_0x51d13a;let _0x21e8c2=settings;return settings['telegramToken']&&settings[_0x11e262(0x1d5)]!=''&&(_0x21e8c2={..._0x21e8c2,'telegramToken':_0x11e262(0x161)}),settings[_0x11e262(0x23a)]&&settings[_0x11e262(0x23a)]!=''&&(_0x21e8c2={..._0x21e8c2,'bbPassword':_0x11e262(0x161)}),(settings[_0x11e262(0x23a)]&&settings[_0x11e262(0x23a)]==_0x11e262(0x2f7)||settings[_0x11e262(0x1d5)]&&settings['telegramToken']=='***')&&(_0x21e8c2={..._0x21e8c2,'restored':{'password':settings[_0x11e262(0x23a)]==_0x11e262(0x2f7),'telegram':settings[_0x11e262(0x1d5)]=='***'}}),_0x21e8c2;}async function updateBB(_0x285a00){const _0x3b676b=_0x51d13a;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x53db5f=>{const _0x2d5d1f=_0x5321;restartBot(_0x53db5f[_0x2d5d1f(0x1b4)]);});if(_0x285a00==_0x3b676b(0x273))process[_0x3b676b(0x1a4)]({'update':!![],'environment':environment},_0x522722=>{});else _0x285a00==_0x3b676b(0x2e9)&&process['send']({'reinstall':!![],'environment':environment},_0x2c045a=>{});}function startBot(_0x4e7da5,_0x1ecbee,_0x4e167f){const _0x2f36d7=_0x51d13a;if(debugging)_0x4e7da5[_0x2f36d7(0x190)]('-d');let _0x4fd030=![];const _0x9fcdcb=_0x4e7da5[0x0];_0x1ecbee={..._0x1ecbee,'stdio':[_0x2f36d7(0x151),_0x2f36d7(0x151),_0x2f36d7(0x151),_0x2f36d7(0x1d9)]},pid[_0x9fcdcb]=childProcess[_0x2f36d7(0x29d)](botfile,_0x4e7da5,_0x1ecbee),pid[_0x9fcdcb]['on']('message',_0xd2a9d6=>{const _0x4d4346=_0x2f36d7;switch(Object[_0x4d4346(0x1e2)](_0xd2a9d6)[0x0]){case _0x4d4346(0x1e1):updateBotName(_0x9fcdcb,_0xd2a9d6['botname']);break;case _0x4d4346(0x282):updateBotManager();break;case _0x4d4346(0x1e0):updateStatus(_0x9fcdcb,_0xd2a9d6[_0x4d4346(0x1e0)]);break;case'live':updateLive(_0x9fcdcb,_0xd2a9d6['live']);break;case'started':updateLive(_0x9fcdcb,_0xd2a9d6[_0x4d4346(0x1be)]),io['to'](_0x9fcdcb)[_0x4d4346(0x234)](_0x4d4346(0x1e0),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x4d4346(0x1bc):_0xd2a9d6['stop']==_0x4d4346(0x1e9)&&restartBot(_0x9fcdcb);_0xd2a9d6[_0x4d4346(0x1bc)]=='kill'&&toggleBot(_0x9fcdcb,_0x4d4346(0x192),_0x4d4346(0x289));break;case'telegram':sendTelegram(_0x9fcdcb,_0xd2a9d6[_0x4d4346(0x1ea)]);break;case'telegrammsg':sendTelegramMsg(_0xd2a9d6[_0x4d4346(0x284)]);break;case'function':io['to'](_0x9fcdcb)[_0x4d4346(0x234)](_0xd2a9d6[_0x4d4346(0x1da)],_0xd2a9d6[_0x4d4346(0x2aa)]);break;}}),pid[_0x9fcdcb]['on'](_0x2f36d7(0x21d),function(_0x449ed1){if(_0x4fd030)return;_0x4fd030=!![],_0x4e167f(_0x449ed1);}),pid[_0x9fcdcb]['on'](_0x2f36d7(0x204),async function(_0x3db61a){const _0x5d2561=_0x2f36d7;if(installingUpdate)return;if(_0x4fd030)return;_0x4fd030=!![],_0x4e167f(null);const _0x19bc79=dbConfig['get'](_0x5d2561(0x274))[_0x5d2561(0x299)]({'botID':_0x9fcdcb})[_0x5d2561(0x2d5)]();_0x19bc79&&(_0x19bc79[_0x5d2561(0x1e0)]==_0x5d2561(0x23d)||_0x19bc79[_0x5d2561(0x1e0)]==_0x5d2561(0x253))&&(await sleep(0x3e8),updateLive(_0x9fcdcb,'stopped'),logger[_0x5d2561(0x2a9)]('Restarting\x20Bot\x20'+_0x9fcdcb),startBot([_0x9fcdcb,userID],{'cwd':bbpath},function(_0x46bf13){const _0x2af89b=_0x5d2561;if(_0x46bf13)logger[_0x2af89b(0x2a9)](_0x46bf13);}));});}function stopBot(_0x1cc6a6){const _0xd702c3=_0x51d13a;getClientsWithBotID(_0x1cc6a6)[_0xd702c3(0x2be)](_0xe4d600=>{const _0x235562=_0xd702c3;getSocket(_0xe4d600['id'])[_0x235562(0x2e0)](!![]),removeClient(_0xe4d600['id']);}),pid[_0x1cc6a6]&&(pid[_0x1cc6a6][_0xd702c3(0x2eb)](),pid[_0x1cc6a6]=null);}function restartBot(_0x431c98){const _0x1ea6b0=_0x51d13a;if(pid[_0x431c98])pid[_0x431c98][_0x1ea6b0(0x2eb)]();}function addBot(){const _0x35e802=_0x51d13a;let _0x4181af;for(let _0x29c9f6=0x1;_0x29c9f6<0x3e9;_0x29c9f6++){_0x4181af=_0x29c9f6['toString']()[_0x35e802(0x1f1)](0x3,'0');let _0xf956c3=config['find'](_0x397980=>_0x397980['botID']==_0x4181af);if(!_0xf956c3)break;}if(_0x4181af===_0x35e802(0x18e)){logger[_0x35e802(0x2a9)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x35e802(0x2a9)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x4181af),dbConfig[_0x35e802(0x230)](_0x35e802(0x274))[_0x35e802(0x190)]({'botID':_0x4181af,'botname':_0x35e802(0x2db)+_0x4181af,'status':_0x35e802(0x253),'live':''})['write'](),startBot([_0x4181af,userID],{'cwd':bbpath},function(_0x563b28){const _0x4be698=_0x35e802;if(_0x563b28)logger[_0x4be698(0x2a9)](_0x563b28);}),config=getConfiguration(),io['to'](_0x35e802(0x26e))[_0x35e802(0x234)](_0x35e802(0x274),config),broadcastToBots(_0x35e802(0x274),JSON[_0x35e802(0x2cf)](config));}function deleteBot(_0x4ad0a5){const _0x289d03=_0x51d13a;getClientsWithBotID(_0x4ad0a5)[_0x289d03(0x2be)](_0xad1737=>{const _0x2ffc16=_0x289d03;getSocket(_0xad1737['id'])[_0x2ffc16(0x2e0)](!![]),removeClient(_0xad1737['id']);}),dbConfig['get']('bots')[_0x289d03(0x1a9)]({'botID':_0x4ad0a5})['write'](),logger[_0x289d03(0x2a9)]('Deleted\x20Bot\x20'+_0x4ad0a5),stopBot(_0x4ad0a5);try{if(fs[_0x289d03(0x1a3)](path[_0x289d03(0x26b)](configpath,'bot-'+_0x4ad0a5+_0x289d03(0x25c))))fs['unlinkSync'](path[_0x289d03(0x26b)](configpath,'bot-'+_0x4ad0a5+_0x289d03(0x25c)));if(fs[_0x289d03(0x1a3)](path[_0x289d03(0x26b)](configpath,'bot-'+_0x4ad0a5+_0x289d03(0x265))))fs[_0x289d03(0x219)](path['join'](configpath,_0x289d03(0x1b2)+_0x4ad0a5+_0x289d03(0x265)));if(fs[_0x289d03(0x1a3)](path[_0x289d03(0x26b)](configpath,'bot-'+_0x4ad0a5+_0x289d03(0x26c))))fs['unlinkSync'](path[_0x289d03(0x26b)](configpath,_0x289d03(0x1b2)+_0x4ad0a5+'-performance.json'));if(fs['existsSync'](path['join'](configpath,_0x289d03(0x1b2)+_0x4ad0a5+_0x289d03(0x2ac))))fs[_0x289d03(0x219)](path['join'](configpath,_0x289d03(0x1b2)+_0x4ad0a5+_0x289d03(0x2ac)));}catch(_0x23a4c5){if(_0x23a4c5)logger[_0x289d03(0x2a9)](_0x289d03(0x18a),_0x23a4c5);}config=getConfiguration(),io['to'](_0x289d03(0x26e))[_0x289d03(0x234)](_0x289d03(0x274),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x501818,_0x10082,_0x12dfbb){const _0x4bcbae=_0x51d13a;dbConfig['get'](_0x4bcbae(0x274))[_0x4bcbae(0x299)]({'botID':_0x501818})[_0x4bcbae(0x25a)]({'status':_0x10082})[_0x4bcbae(0x25a)]({'live':_0x12dfbb})[_0x4bcbae(0x1c9)]();if(_0x10082==_0x4bcbae(0x23d)||_0x10082==_0x4bcbae(0x253))logger[_0x4bcbae(0x2a9)]('Enabled\x20Bot\x20'+_0x501818),startBot([_0x501818,userID],{'cwd':bbpath},function(_0x58b88a){if(_0x58b88a)logger['full'](_0x58b88a);});else(_0x10082==_0x4bcbae(0x192)||_0x10082==_0x4bcbae(0x16f))&&(logger[_0x4bcbae(0x2a9)](_0x4bcbae(0x17a)+_0x501818),stopBot(_0x501818));config=getConfiguration(),io['to'](_0x4bcbae(0x26e))['emit'](_0x4bcbae(0x274),config),broadcastToBots(_0x4bcbae(0x274),JSON[_0x4bcbae(0x2cf)](config));}function toggleStatus(_0x48431d){const _0x2f9c6b=_0x51d13a;let _0x44bd1b=dbConfig[_0x2f9c6b(0x230)](_0x2f9c6b(0x274))['find']({'botID':_0x48431d})[_0x2f9c6b(0x2d5)](),_0x28ce15;if(_0x44bd1b[_0x2f9c6b(0x1e0)]===_0x2f9c6b(0x23d))_0x28ce15=_0x2f9c6b(0x192);else{if(_0x44bd1b[_0x2f9c6b(0x1e0)]===_0x2f9c6b(0x253))_0x28ce15='new-disabled';else{if(_0x44bd1b[_0x2f9c6b(0x1e0)]==='new-disabled')_0x28ce15=_0x2f9c6b(0x253);else{if(_0x44bd1b[_0x2f9c6b(0x1e0)]==='disabled')_0x28ce15=_0x2f9c6b(0x23d);}}}return _0x28ce15;}function updateStatus(_0x37347d,_0x4c821a){const _0x3c0e2b=_0x51d13a;dbConfig[_0x3c0e2b(0x230)]('bots')[_0x3c0e2b(0x299)]({'botID':_0x37347d})['assign']({'status':_0x4c821a})['write'](),config=getConfiguration(),io['to'](_0x3c0e2b(0x26e))[_0x3c0e2b(0x234)](_0x3c0e2b(0x274),config),broadcastToBots(_0x3c0e2b(0x274),JSON['stringify'](config));}function updateLive(_0x271621,_0x2fcb15){const _0x2d4518=_0x51d13a;dbConfig[_0x2d4518(0x230)]('bots')[_0x2d4518(0x299)]({'botID':_0x271621})[_0x2d4518(0x25a)]({'live':_0x2fcb15})[_0x2d4518(0x1c9)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x9fcf31,_0xcd2587){const _0x214a15=_0x51d13a;dbConfig[_0x214a15(0x230)](_0x214a15(0x274))[_0x214a15(0x299)]({'botID':_0x9fcf31})[_0x214a15(0x25a)]({'botname':_0xcd2587})[_0x214a15(0x1c9)](),config=getConfiguration(),io['to'](_0x214a15(0x26e))[_0x214a15(0x234)](_0x214a15(0x274),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x2d1413=_0x51d13a;config=getConfiguration(),io['to'](_0x2d1413(0x26e))[_0x2d1413(0x234)]('bots',config),broadcastToBots(_0x2d1413(0x274),JSON[_0x2d1413(0x2cf)](config));}function toggleBotMode(_0x411b8e){const _0x146ba4=_0x51d13a;if(pid[_0x411b8e])pid[_0x411b8e]['send']({'function':_0x146ba4(0x276),'args':null});else{const _0x4dffe7=configpath+_0x146ba4(0x1b2)+_0x411b8e+'-config.json',_0x5c5d0b=fs['readFileSync'](_0x4dffe7),_0x406f09=JSON[_0x146ba4(0x241)](_0x5c5d0b),_0x3b879=_0x406f09[_0x146ba4(0x16c)][0x0][_0x146ba4(0x22d)];_0x406f09[_0x146ba4(0x16c)][0x0][_0x146ba4(0x22d)]=!_0x3b879;const _0x41a56d=JSON[_0x146ba4(0x2cf)](_0x406f09,null,0x2);fs[_0x146ba4(0x179)](_0x4dffe7,_0x41a56d),config=getConfiguration(),io['to'](_0x146ba4(0x26e))['emit']('bots',config),broadcastToBots(_0x146ba4(0x274),JSON[_0x146ba4(0x2cf)](config));}}function telegramError(_0x2be00f){const _0x24aa7e=_0x51d13a;logger[_0x24aa7e(0x1ba)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x2562b7){const _0x13d23a=_0x51d13a;if(_0x2562b7[_0x13d23a(0x269)][_0x13d23a(0x2d8)]!=settings[_0x13d23a(0x2ba)]&&'@'+_0x2562b7[_0x13d23a(0x269)][_0x13d23a(0x2d8)]!=settings[_0x13d23a(0x2ba)])return tgBot[_0x13d23a(0x16e)](_0x2562b7[_0x13d23a(0x293)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x13d23a(0x2e8)})[_0x13d23a(0x228)](_0x4001ab=>{telegramError(_0x4001ab);}),![];return!![];}async function initTelegram(){const _0xd74392=_0x51d13a;if(tgBot)tgBot[_0xd74392(0x271)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xd74392(0x1d5)],{'polling':!![]});let _0x52f985=_0xd74392(0x246);_0x52f985+='\x0a',_0x52f985+=_0xd74392(0x233),_0x52f985+=_0xd74392(0x1d4),_0x52f985+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x52f985+=_0xd74392(0x20f),_0x52f985+=_0xd74392(0x182),_0x52f985+='/off\x20-\x20stop\x20bot(s)\x0a',_0x52f985+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x52f985+=_0xd74392(0x1db),_0x52f985+=_0xd74392(0x1f4),_0x52f985+=_0xd74392(0x2c8),_0x52f985+=_0xd74392(0x305),_0x52f985+=_0xd74392(0x18b),_0x52f985+=_0xd74392(0x308),_0x52f985+=_0xd74392(0x1ad);let _0x5b5971='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x5b5971+='\x0a',_0x5b5971+=_0x52f985,tgBot[_0xd74392(0x1d0)](/\/start/,_0x481403=>{const _0xb71330=_0xd74392;if(!validateTelegram(_0x481403))return;if(settings['telegramChatId']!=_0x481403['chat']['id'])updateSetting(_0xb71330(0x30d),_0x481403[_0xb71330(0x293)]['id']);updateSetting(_0xb71330(0x1cf),!![]),tgBot['sendMessage'](_0x481403[_0xb71330(0x293)]['id'],_0x5b5971)[_0xb71330(0x228)](_0x235345=>{telegramError(_0x235345);});}),tgBot[_0xd74392(0x1d0)](/\/enable/,_0x2c2fdc=>{const _0x349e66=_0xd74392;if(!validateTelegram(_0x2c2fdc))return;if(settings[_0x349e66(0x30d)]!=_0x2c2fdc[_0x349e66(0x293)]['id'])updateSetting(_0x349e66(0x30d),_0x2c2fdc[_0x349e66(0x293)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x2c2fdc['chat']['id'],_0x349e66(0x2e2))[_0x349e66(0x228)](_0x4df60d=>{telegramError(_0x4df60d);});}),tgBot['onText'](/\/config/,async _0x30a5a7=>{const _0x5a3f5c=_0xd74392;if(!validateTelegram(_0x30a5a7))return;tgBot[_0x5a3f5c(0x286)]('callback_query'),tgBot['sendMessage'](_0x30a5a7['chat']['id'],_0x5a3f5c(0x1f5),{'reply_markup':{'inline_keyboard':[[{'text':_0x5a3f5c(0x2ed),'callback_data':'orders'},{'text':_0x5a3f5c(0x168),'callback_data':'alerts'},{'text':_0x5a3f5c(0x2d4),'callback_data':_0x5a3f5c(0x1b6)}]]}})['catch'](_0x18aba0=>{telegramError(_0x18aba0);}),tgBot['on']('callback_query',async _0x3f34e3=>{const _0x3f5e27=_0x5a3f5c,_0x1a9db1=_0x3f34e3[_0x3f5e27(0x2f4)],_0x2ab2a1=_0x3f34e3[_0x3f5e27(0x19e)];tgBot[_0x3f5e27(0x298)](_0x3f34e3['id'])[_0x3f5e27(0x1de)](async()=>{const _0x471445=_0x3f5e27;_0x1a9db1=='orders'&&(updateSetting('telegramEvents','orders'),updateSetting(_0x471445(0x1cf),!![]),await tgBot['sendMessage'](_0x2ab2a1[_0x471445(0x293)]['id'],_0x471445(0x317))['catch'](_0x513992=>{telegramError(_0x513992);}));_0x1a9db1==_0x471445(0x2b7)&&(updateSetting(_0x471445(0x187),'alerts'),updateSetting(_0x471445(0x1cf),!![]),await tgBot[_0x471445(0x16e)](_0x2ab2a1[_0x471445(0x293)]['id'],_0x471445(0x1cc))['catch'](_0x1bbc1a=>{telegramError(_0x1bbc1a);}));_0x1a9db1==_0x471445(0x1b6)&&(updateSetting('telegramEvents',_0x471445(0x1b6)),updateSetting(_0x471445(0x1cf),!![]),await tgBot[_0x471445(0x16e)](_0x2ab2a1['chat']['id'],_0x471445(0x2b6))['catch'](_0x1a56a6=>{telegramError(_0x1a56a6);}));if(!settings['telegramChatId'])tgBot[_0x471445(0x16e)](_0x2ab2a1[_0x471445(0x293)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x552dec=>{telegramError(_0x552dec);});}),tgBot[_0x3f5e27(0x286)](_0x3f5e27(0x205));});}),tgBot[_0xd74392(0x1d0)](/\/status/,_0x4a633c=>{const _0x30ca83=_0xd74392;if(!validateTelegram(_0x4a633c))return;const _0x4783de=getBotsWithMode();let _0x15f350=_0x30ca83(0x23e);config[_0x30ca83(0x2be)](_0x5299e5=>{const _0x53a4ce=_0x30ca83,_0x22ccbd=_0x4783de[_0x53a4ce(0x299)](_0x164261=>_0x164261[_0x53a4ce(0x1b4)]==_0x5299e5[_0x53a4ce(0x1b4)])[_0x53a4ce(0x2fb)];_0x15f350+=_0x53a4ce(0x2db)+_0x5299e5[_0x53a4ce(0x1b4)]+':\x20'+_0x5299e5['status']+_0x53a4ce(0x224)+_0x22ccbd+_0x53a4ce(0x224)+_0x5299e5['live']+'\x0a';}),_0x15f350+='\x0a',_0x15f350+=_0x30ca83(0x2c1),_0x15f350+=!settings[_0x30ca83(0x1cf)]?_0x30ca83(0x1aa):_0x30ca83(0x18d),_0x15f350+=settings[_0x30ca83(0x1cf)]?settings[_0x30ca83(0x187)]==_0x30ca83(0x1b6)?_0x30ca83(0x159):_0x30ca83(0x1c5)+settings[_0x30ca83(0x187)]+_0x30ca83(0x2ea):'',tgBot[_0x30ca83(0x16e)](_0x4a633c[_0x30ca83(0x293)]['id'],_0x15f350,{'parse_mode':_0x30ca83(0x2e8)})[_0x30ca83(0x228)](_0x1228a1=>{telegramError(_0x1228a1);});}),tgBot[_0xd74392(0x1d0)](/\/restart/,_0x31a9ee=>{const _0x165e67=_0xd74392;if(!validateTelegram(_0x31a9ee))return;tgBot[_0x165e67(0x286)](_0x165e67(0x205));const _0xd79728=getEnabledBots();if(_0xd79728['length']==0x0)tgBot[_0x165e67(0x16e)](_0x31a9ee[_0x165e67(0x293)]['id'],_0x165e67(0x30c))['catch'](_0x447483=>{telegramError(_0x447483);});else{if(_0xd79728[_0x165e67(0x283)]>0x1)_0xd79728[_0x165e67(0x190)]({'botID':_0x165e67(0x1b6)});let _0x2650af=[],_0xab611d=[];const _0xa2864=_0xd79728[_0x165e67(0x283)]%0x4==0x0||_0xd79728[_0x165e67(0x283)]%0x4==0x3||_0xd79728[_0x165e67(0x283)]%0x3==0x1?0x4:0x3;let _0xce76ee=0x0;_0xd79728[_0x165e67(0x2be)]((_0x3f059c,_0x4d793b)=>{const _0x5cfc91=_0x165e67;if(_0x4d793b%_0xa2864==0x0)_0xab611d=[];_0xab611d[_0x5cfc91(0x190)]({'text':_0x3f059c['botID']==_0x5cfc91(0x1b6)?_0x5cfc91(0x2a1):_0x5cfc91(0x2db)+_0x3f059c[_0x5cfc91(0x1b4)],'callback_data':_0x3f059c['botID']}),_0x4d793b%_0xa2864==0x0&&(_0x2650af[_0xce76ee]=_0xab611d,_0xce76ee++);}),tgBot[_0x165e67(0x16e)](_0x31a9ee['chat']['id'],_0x165e67(0x1c3),{'reply_markup':{'inline_keyboard':_0x2650af}})[_0x165e67(0x228)](_0x484ad7=>{telegramError(_0x484ad7);}),tgBot['on'](_0x165e67(0x205),async _0x1f8ffd=>{const _0x3da70c=_0x165e67,_0x144164=_0x1f8ffd[_0x3da70c(0x2f4)],_0x33592e=_0x1f8ffd[_0x3da70c(0x19e)];tgBot[_0x3da70c(0x298)](_0x1f8ffd['id'])[_0x3da70c(0x1de)](async()=>{const _0x324602=_0x3da70c;_0x144164==_0x324602(0x1b6)?config[_0x324602(0x2be)](_0x2bd1ed=>{restartBot(_0x2bd1ed['botID']);}):restartBot(_0x144164);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0xd74392(0x1d0)](/\/on/,_0x23aa0c=>{const _0x3e63c5=_0xd74392;if(!validateTelegram(_0x23aa0c))return;tgBot[_0x3e63c5(0x286)](_0x3e63c5(0x205));const _0x2a5089=getDisabledBots();if(_0x2a5089[_0x3e63c5(0x283)]==0x0)tgBot['sendMessage'](_0x23aa0c[_0x3e63c5(0x293)]['id'],_0x3e63c5(0x25f))[_0x3e63c5(0x228)](_0x5b93c6=>{telegramError(_0x5b93c6);});else{if(_0x2a5089[_0x3e63c5(0x283)]>0x1)_0x2a5089[_0x3e63c5(0x190)]({'botID':_0x3e63c5(0x1b6)});let _0x5a4d78=[],_0x246ccb=[];const _0x1996ee=_0x2a5089[_0x3e63c5(0x283)]%0x4==0x0||_0x2a5089['length']%0x4==0x3||_0x2a5089[_0x3e63c5(0x283)]%0x3==0x1?0x4:0x3;let _0x5d3810=0x0;_0x2a5089[_0x3e63c5(0x2be)]((_0x583f3b,_0x2a4750)=>{const _0x5be8bd=_0x3e63c5;if(_0x2a4750%_0x1996ee==0x0)_0x246ccb=[];_0x246ccb[_0x5be8bd(0x190)]({'text':_0x583f3b[_0x5be8bd(0x1b4)]==_0x5be8bd(0x1b6)?'All\x20bots':_0x5be8bd(0x2db)+_0x583f3b[_0x5be8bd(0x1b4)],'callback_data':_0x583f3b[_0x5be8bd(0x1b4)]}),_0x2a4750%_0x1996ee==0x0&&(_0x5a4d78[_0x5d3810]=_0x246ccb,_0x5d3810++);}),tgBot[_0x3e63c5(0x16e)](_0x23aa0c[_0x3e63c5(0x293)]['id'],_0x3e63c5(0x207),{'reply_markup':{'inline_keyboard':_0x5a4d78}})[_0x3e63c5(0x228)](_0x409933=>{telegramError(_0x409933);}),tgBot['on'](_0x3e63c5(0x205),async _0x2789b=>{const _0x2d1e71=_0x3e63c5,_0x159c28=_0x2789b[_0x2d1e71(0x2f4)],_0x6d4db8=_0x2789b['message'];tgBot[_0x2d1e71(0x298)](_0x2789b['id'])['then'](async()=>{const _0x8ba9d3=_0x2d1e71;_0x159c28==_0x8ba9d3(0x1b6)?(tgBot[_0x8ba9d3(0x16e)](_0x6d4db8[_0x8ba9d3(0x293)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x5953f9=>{telegramError(_0x5953f9);}),_0x2a5089[_0x8ba9d3(0x2be)](_0x315b83=>{const _0x4168f7=_0x8ba9d3;if(_0x315b83[_0x4168f7(0x1b4)]!=_0x4168f7(0x1b6))toggleBot(_0x315b83[_0x4168f7(0x1b4)],toggleStatus(_0x315b83[_0x4168f7(0x1b4)]),'stopped');})):(tgBot[_0x8ba9d3(0x16e)](_0x6d4db8[_0x8ba9d3(0x293)]['id'],_0x8ba9d3(0x214)+_0x159c28)[_0x8ba9d3(0x228)](_0x229bf4=>{telegramError(_0x229bf4);}),toggleBot(_0x159c28,toggleStatus(_0x159c28),_0x8ba9d3(0x289)));}),tgBot[_0x2d1e71(0x286)]('callback_query');});}}),tgBot[_0xd74392(0x1d0)](/\/off/,_0x3722b9=>{const _0x2cdbc6=_0xd74392;if(!validateTelegram(_0x3722b9))return;tgBot[_0x2cdbc6(0x286)](_0x2cdbc6(0x205));const _0x4db661=getEnabledBots();if(_0x4db661[_0x2cdbc6(0x283)]==0x0)tgBot[_0x2cdbc6(0x16e)](_0x3722b9[_0x2cdbc6(0x293)]['id'],_0x2cdbc6(0x30c))[_0x2cdbc6(0x228)](_0x1331a6=>{telegramError(_0x1331a6);});else{if(_0x4db661['length']>0x1)_0x4db661[_0x2cdbc6(0x190)]({'botID':_0x2cdbc6(0x1b6)});let _0x34869a=[],_0x3feb79=[];const _0x5149cd=_0x4db661[_0x2cdbc6(0x283)]%0x4==0x0||_0x4db661[_0x2cdbc6(0x283)]%0x4==0x3||_0x4db661[_0x2cdbc6(0x283)]%0x3==0x1?0x4:0x3;let _0x4d303e=0x0;_0x4db661[_0x2cdbc6(0x2be)]((_0x20ecef,_0x323a1d)=>{const _0x1db037=_0x2cdbc6;if(_0x323a1d%_0x5149cd==0x0)_0x3feb79=[];_0x3feb79[_0x1db037(0x190)]({'text':_0x20ecef['botID']==_0x1db037(0x1b6)?_0x1db037(0x2a1):_0x1db037(0x2db)+_0x20ecef[_0x1db037(0x1b4)],'callback_data':_0x20ecef[_0x1db037(0x1b4)]}),_0x323a1d%_0x5149cd==0x0&&(_0x34869a[_0x4d303e]=_0x3feb79,_0x4d303e++);}),tgBot[_0x2cdbc6(0x16e)](_0x3722b9[_0x2cdbc6(0x293)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x34869a}})[_0x2cdbc6(0x228)](_0x472b16=>{telegramError(_0x472b16);}),tgBot['on'](_0x2cdbc6(0x205),async _0x4b7eaf=>{const _0x4ff978=_0x2cdbc6,_0x2c0b0d=_0x4b7eaf['data'],_0x3c52bc=_0x4b7eaf[_0x4ff978(0x19e)];tgBot[_0x4ff978(0x298)](_0x4b7eaf['id'])[_0x4ff978(0x1de)](async()=>{const _0xc4c49=_0x4ff978;_0x2c0b0d==_0xc4c49(0x1b6)?(tgBot[_0xc4c49(0x16e)](_0x3c52bc[_0xc4c49(0x293)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x34fcdb=>{telegramError(_0x34fcdb);}),_0x4db661[_0xc4c49(0x2be)](_0x3db413=>{const _0x5b0dd7=_0xc4c49;if(_0x3db413[_0x5b0dd7(0x1b4)]!='all')toggleBot(_0x3db413[_0x5b0dd7(0x1b4)],toggleStatus(_0x3db413['botID']),_0x5b0dd7(0x289));})):(tgBot[_0xc4c49(0x16e)](_0x3c52bc[_0xc4c49(0x293)]['id'],_0xc4c49(0x316)+_0x2c0b0d)[_0xc4c49(0x228)](_0x4c15ef=>{telegramError(_0x4c15ef);}),toggleBot(_0x2c0b0d,toggleStatus(_0x2c0b0d),'stopped'));}),tgBot[_0x4ff978(0x286)](_0x4ff978(0x205));});}}),tgBot['onText'](/\/metrics/,_0x5c7f25=>{const _0x4013ac=_0xd74392;if(!validateTelegram(_0x5c7f25))return;tgBot[_0x4013ac(0x286)](_0x4013ac(0x205));const _0x5b7c7d=getEnabledBots();if(_0x5b7c7d[_0x4013ac(0x283)]==0x0)tgBot['sendMessage'](_0x5c7f25[_0x4013ac(0x293)]['id'],_0x4013ac(0x30c))[_0x4013ac(0x228)](_0x248c85=>{telegramError(_0x248c85);});else{if(_0x5b7c7d['length']>0x1){let _0x19128b=[],_0x4a1b19=[];const _0x166e02=_0x5b7c7d[_0x4013ac(0x283)]%0x4==0x0||_0x5b7c7d[_0x4013ac(0x283)]%0x4==0x3||_0x5b7c7d[_0x4013ac(0x283)]%0x3==0x1?0x4:0x3;let _0x519889=0x0;_0x5b7c7d[_0x4013ac(0x2be)]((_0x28a9fa,_0x432236)=>{const _0x36637d=_0x4013ac;if(_0x432236%_0x166e02==0x0)_0x4a1b19=[];_0x4a1b19['push']({'text':_0x36637d(0x2db)+_0x28a9fa['botID'],'callback_data':_0x28a9fa[_0x36637d(0x1b4)]}),_0x432236%_0x166e02==0x0&&(_0x19128b[_0x519889]=_0x4a1b19,_0x519889++);}),tgBot[_0x4013ac(0x16e)](_0x5c7f25[_0x4013ac(0x293)]['id'],_0x4013ac(0x1df),{'reply_markup':{'inline_keyboard':_0x19128b}})[_0x4013ac(0x228)](_0x39a981=>{telegramError(_0x39a981);}),tgBot['on'](_0x4013ac(0x205),async _0x4c1606=>{const _0x217669=_0x4013ac,_0x2f3b29=_0x4c1606['data'],_0x563c49=_0x4c1606[_0x217669(0x19e)];tgBot['answerCallbackQuery'](_0x4c1606['id'])[_0x217669(0x1de)](async()=>{const _0x365107=_0x217669;if(pid[_0x2f3b29])pid[_0x2f3b29][_0x365107(0x1a4)]({'function':_0x365107(0x31a),'args':null});}),tgBot[_0x217669(0x286)](_0x217669(0x205));});}else{const _0x15f470=_0x5b7c7d[0x0]['botID'];if(pid[_0x15f470])pid[_0x15f470][_0x4013ac(0x1a4)]({'function':_0x4013ac(0x31a),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x4f3b12=>{const _0x2b41c8=_0xd74392;if(!validateTelegram(_0x4f3b12))return;tgBot[_0x2b41c8(0x286)](_0x2b41c8(0x205));const _0x36d4e0=getEnabledBots();if(_0x36d4e0['length']==0x0)tgBot['sendMessage'](_0x4f3b12[_0x2b41c8(0x293)]['id'],_0x2b41c8(0x30c))['catch'](_0x420f5b=>{telegramError(_0x420f5b);});else{if(_0x36d4e0[_0x2b41c8(0x283)]>0x1){let _0x4e15eb=[],_0x38a121=[];const _0x4640ff=_0x36d4e0[_0x2b41c8(0x283)]%0x4==0x0||_0x36d4e0[_0x2b41c8(0x283)]%0x4==0x3||_0x36d4e0[_0x2b41c8(0x283)]%0x3==0x1?0x4:0x3;let _0xe0a80a=0x0;_0x36d4e0[_0x2b41c8(0x2be)]((_0x48b182,_0x127cbe)=>{const _0x22e982=_0x2b41c8;if(_0x127cbe%_0x4640ff==0x0)_0x38a121=[];_0x38a121[_0x22e982(0x190)]({'text':'Bot\x20'+_0x48b182['botID'],'callback_data':_0x48b182[_0x22e982(0x1b4)]}),_0x127cbe%_0x4640ff==0x0&&(_0x4e15eb[_0xe0a80a]=_0x38a121,_0xe0a80a++);}),tgBot[_0x2b41c8(0x16e)](_0x4f3b12[_0x2b41c8(0x293)]['id'],_0x2b41c8(0x247),{'reply_markup':{'inline_keyboard':_0x4e15eb}})['catch'](_0x220298=>{telegramError(_0x220298);}),tgBot['on'](_0x2b41c8(0x205),async _0xd991fe=>{const _0x4eb1b3=_0x2b41c8,_0x50bbaf=_0xd991fe[_0x4eb1b3(0x2f4)],_0x38ef04=_0xd991fe[_0x4eb1b3(0x19e)];tgBot['answerCallbackQuery'](_0xd991fe['id'])[_0x4eb1b3(0x1de)](async()=>{if(pid[_0x50bbaf])pid[_0x50bbaf]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x4eb1b3(0x286)]('callback_query');});}else{const _0x224c44=_0x36d4e0[0x0][_0x2b41c8(0x1b4)];if(pid[_0x224c44])pid[_0x224c44][_0x2b41c8(0x1a4)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0xd74392(0x1d0)](/\/update/,async _0x11f427=>{const _0x1ac7ea=_0xd74392;if(!validateTelegram(_0x11f427))return;tgBot[_0x1ac7ea(0x286)](_0x1ac7ea(0x205)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x11f427['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x1ac7ea(0x228)](_0x12d928=>{telegramError(_0x12d928);});else!validInstallation?tgBot[_0x1ac7ea(0x16e)](_0x11f427[_0x1ac7ea(0x293)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x1ac7ea(0x228)](_0x415923=>{telegramError(_0x415923);}):(tgBot[_0x1ac7ea(0x16e)](_0x11f427['chat']['id'],_0x1ac7ea(0x17b),{'reply_markup':{'inline_keyboard':[[{'text':_0x1ac7ea(0x1d8),'callback_data':_0x1ac7ea(0x2e6)},{'text':'No','callback_data':'no'}]]}})[_0x1ac7ea(0x228)](_0x46cdac=>{telegramError(_0x46cdac);}),tgBot['on']('callback_query',async _0x49b7b6=>{const _0x365fd7=_0x1ac7ea,_0x4ee12a=_0x49b7b6[_0x365fd7(0x2f4)],_0x3756f6=_0x49b7b6[_0x365fd7(0x19e)];tgBot[_0x365fd7(0x298)](_0x49b7b6['id'])[_0x365fd7(0x1de)](async()=>{const _0x1ba918=_0x365fd7;_0x4ee12a==_0x1ba918(0x2e6)&&(await tgBot[_0x1ba918(0x16e)](_0x3756f6[_0x1ba918(0x293)]['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0x550e7d=>{telegramError(_0x550e7d);}),updateBB('update')),_0x4ee12a=='no'&&await tgBot[_0x1ba918(0x16e)](_0x3756f6[_0x1ba918(0x293)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x1ba918(0x228)](_0x514164=>{telegramError(_0x514164);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0xd74392(0x1d0)](/\/reinstall/,async _0x14dca3=>{const _0x58b245=_0xd74392;if(!validateTelegram(_0x14dca3))return;tgBot[_0x58b245(0x286)](_0x58b245(0x205)),!validInstallation?tgBot[_0x58b245(0x16e)](_0x14dca3[_0x58b245(0x293)]['id'],_0x58b245(0x158))['catch'](_0x137a04=>{telegramError(_0x137a04);}):(tgBot[_0x58b245(0x16e)](_0x14dca3[_0x58b245(0x293)]['id'],_0x58b245(0x201),{'reply_markup':{'inline_keyboard':[[{'text':_0x58b245(0x1d8),'callback_data':_0x58b245(0x2e6)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x6d98e0=>{telegramError(_0x6d98e0);}),tgBot['on'](_0x58b245(0x205),async _0x2c2a6a=>{const _0x2262f4=_0x58b245,_0x32c427=_0x2c2a6a[_0x2262f4(0x2f4)],_0x4329b1=_0x2c2a6a[_0x2262f4(0x19e)];tgBot[_0x2262f4(0x298)](_0x2c2a6a['id'])[_0x2262f4(0x1de)](async()=>{const _0x1d3eb8=_0x2262f4;_0x32c427==_0x1d3eb8(0x2e6)&&(await tgBot[_0x1d3eb8(0x16e)](_0x4329b1['chat']['id'],_0x1d3eb8(0x22a))[_0x1d3eb8(0x228)](_0x59b860=>{telegramError(_0x59b860);}),updateBB(_0x1d3eb8(0x2e9))),_0x32c427=='no'&&await tgBot['sendMessage'](_0x4329b1[_0x1d3eb8(0x293)]['id'],_0x1d3eb8(0x238))[_0x1d3eb8(0x228)](_0x1da5a8=>{telegramError(_0x1da5a8);});}),tgBot[_0x2262f4(0x286)](_0x2262f4(0x205));}));}),tgBot[_0xd74392(0x1d0)](/\/toggle/,_0x3ce09c=>{const _0x1bb71d=_0xd74392;if(!validateTelegram(_0x3ce09c))return;tgBot[_0x1bb71d(0x286)](_0x1bb71d(0x205));const _0x8134f2=getBotsWithMode();if(_0x8134f2[_0x1bb71d(0x283)]==0x0)tgBot[_0x1bb71d(0x16e)](_0x3ce09c[_0x1bb71d(0x293)]['id'],_0x1bb71d(0x30c))[_0x1bb71d(0x228)](_0x46920a=>{telegramError(_0x46920a);});else{let _0x481777=[],_0x255259=[];const _0x298abe=0x2;let _0x74af85=0x0;_0x8134f2['forEach']((_0x3e8ce,_0x6d605e)=>{const _0x39fec1=_0x1bb71d;if(_0x6d605e%_0x298abe==0x0)_0x255259=[];_0x255259[_0x39fec1(0x190)]({'text':'Bot\x20'+_0x3e8ce[_0x39fec1(0x1b4)]+'\x20('+_0x3e8ce[_0x39fec1(0x2fb)]+')','callback_data':_0x3e8ce[_0x39fec1(0x1b4)]}),_0x6d605e%_0x298abe==0x0&&(_0x481777[_0x74af85]=_0x255259,_0x74af85++);}),tgBot[_0x1bb71d(0x16e)](_0x3ce09c[_0x1bb71d(0x293)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x481777}})[_0x1bb71d(0x228)](_0x251991=>{telegramError(_0x251991);}),tgBot['on'](_0x1bb71d(0x205),async _0x5ec040=>{const _0x3c0ce6=_0x1bb71d,_0x25dafc=_0x5ec040[_0x3c0ce6(0x2f4)],_0x5a1684=_0x5ec040[_0x3c0ce6(0x19e)];tgBot[_0x3c0ce6(0x298)](_0x5ec040['id'])[_0x3c0ce6(0x1de)](async()=>{const _0x440ccd=_0x3c0ce6,_0x13927d=_0x8134f2['find'](_0x2711a9=>_0x2711a9['botID']==_0x25dafc),_0x403049=_0x13927d[_0x440ccd(0x2fb)]==_0x440ccd(0x1ef)?'manual':_0x440ccd(0x1ef);tgBot[_0x440ccd(0x16e)](_0x5a1684[_0x440ccd(0x293)]['id'],_0x440ccd(0x152)+_0x25dafc+_0x440ccd(0x153)+_0x403049+_0x440ccd(0x27c))[_0x440ccd(0x228)](_0x3c6a0c=>{telegramError(_0x3c6a0c);}),toggleBotMode(_0x25dafc);}),tgBot[_0x3c0ce6(0x286)](_0x3c0ce6(0x205));});}}),tgBot[_0xd74392(0x1d0)](/\/names/,_0x1c7fd9=>{const _0x42ead5=_0xd74392;if(!validateTelegram(_0x1c7fd9))return;let _0x3761eb='';config[_0x42ead5(0x2be)](_0x45a67f=>{const _0x41d76e=_0x42ead5;_0x3761eb+=_0x41d76e(0x2db)+_0x45a67f[_0x41d76e(0x1b4)]+':\x20'+_0x45a67f[_0x41d76e(0x1e1)]+'\x0a';}),tgBot[_0x42ead5(0x16e)](_0x1c7fd9[_0x42ead5(0x293)]['id'],_0x3761eb,{'parse_mode':_0x42ead5(0x2e8)})[_0x42ead5(0x228)](_0x27af60=>{telegramError(_0x27af60);});}),tgBot[_0xd74392(0x1d0)](/\/disable/,_0x5d2f1b=>{const _0x4a01a7=_0xd74392;if(!validateTelegram(_0x5d2f1b))return;tgBot['sendMessage'](_0x5d2f1b[_0x4a01a7(0x293)]['id'],'Notifications\x20disabled')[_0x4a01a7(0x228)](_0x296993=>{telegramError(_0x296993);}),updateSetting(_0x4a01a7(0x1cf),![]);}),tgBot[_0xd74392(0x1d0)](/\/help/,_0x4660a3=>{const _0x5ce734=_0xd74392;if(!validateTelegram(_0x4660a3))return;tgBot[_0x5ce734(0x16e)](_0x4660a3['chat']['id'],_0x52f985)[_0x5ce734(0x228)](_0x2d055e=>{telegramError(_0x2d055e);});}),tgBot['on'](_0xd74392(0x1fc),_0x253fbb=>{const _0x46a0b1=_0xd74392;_0x253fbb[_0x46a0b1(0x1ec)]()[_0x46a0b1(0x24d)](_0x46a0b1(0x2cd))&&(logger[_0x46a0b1(0x2a9)]('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null,io['to'](_0x46a0b1(0x26e))['emit'](_0x46a0b1(0x1bb),_0x46a0b1(0x217)));}),process[_0xd74392(0x198)](_0xd74392(0x2f9),()=>{const _0x2e9d23=_0xd74392;if(tgBot)tgBot['stopPolling']();process[_0x2e9d23(0x204)](0x1);}),process[_0xd74392(0x198)](_0xd74392(0x235),()=>{const _0x4fd900=_0xd74392;if(tgBot)tgBot[_0x4fd900(0x271)]();process[_0x4fd900(0x204)](0x1);});}}function disableTelegram(){const _0x302ca4=_0x51d13a;tgBot&&(tgBot[_0x302ca4(0x271)](),tgBot=null);}function sendTelegram(_0x223c93,_0x19eb5a){const _0x249b5d=_0x51d13a;if(settings[_0x249b5d(0x1cf)]){if(settings['telegramEvents']=='all'||(_0x19eb5a['type']==_0x249b5d(0x21d)||_0x19eb5a[_0x249b5d(0x176)]=='warning'||_0x19eb5a[_0x249b5d(0x176)]=='success')&&settings[_0x249b5d(0x187)]=='alerts'||_0x19eb5a[_0x249b5d(0x176)]==_0x249b5d(0x315)&&settings[_0x249b5d(0x187)]==_0x249b5d(0x2d0)){if(tgBot&&settings[_0x249b5d(0x30d)]){if(_0x19eb5a[_0x249b5d(0x249)])tgBot[_0x249b5d(0x16e)](settings[_0x249b5d(0x30d)],_0x19eb5a['botname']+_0x249b5d(0x24c)+_0x19eb5a[_0x249b5d(0x169)])[_0x249b5d(0x228)](_0xa7c6e0=>{telegramError(_0xa7c6e0);});else tgBot[_0x249b5d(0x16e)](settings['telegramChatId'],_0x249b5d(0x2db)+_0x223c93+_0x249b5d(0x24c)+_0x19eb5a[_0x249b5d(0x169)])[_0x249b5d(0x228)](_0x1ba6d0=>{telegramError(_0x1ba6d0);});}}}}async function sendTelegramMsg(_0x5d4c91,_0x247a53=_0x51d13a(0x2e8)){const _0x14975c=_0x51d13a;return settings[_0x14975c(0x1cf)]&&tgBot&&settings[_0x14975c(0x30d)]?(await tgBot[_0x14975c(0x16e)](settings[_0x14975c(0x30d)],_0x5d4c91,{'parse_mode':_0x247a53})[_0x14975c(0x228)](_0x7abbe7=>{telegramError(_0x7abbe7);}),!![]):![];}function getDeviceWithIp(_0x47b9fa){const _0x51f9ca=_0x51d13a;return devices[_0x51f9ca(0x299)](_0x404133=>_0x404133['ip']===_0x47b9fa);}function temporaryAccess2FA(_0x13d7b6,_0x3c81f1){const _0x5037c6=_0x51d13a;let _0x209165=new Date(),_0x32483b=![];if(lastIpApproval){if(_0x209165-lastIpApproval<0x1388)_0x32483b=!![];}lastIpApproval=new Date();if(_0x32483b)return;tgBot&&settings[_0x5037c6(0x30d)]&&(tgBot[_0x5037c6(0x286)](_0x5037c6(0x205)),tgBot['sendMessage'](settings[_0x5037c6(0x30d)],_0x5037c6(0x163)+normalizeIP(_0x3c81f1)[_0x5037c6(0x157)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x5037c6(0x14e),'callback_data':'15'},{'text':_0x5037c6(0x1fb),'callback_data':'30'},{'text':_0x5037c6(0x2b0),'callback_data':_0x5037c6(0x2b0)}]]}})[_0x5037c6(0x228)](_0x50515a=>{telegramError(_0x50515a);}),tgBot['on'](_0x5037c6(0x205),async _0x5bd87f=>{const _0x3fbd00=_0x5037c6,_0x18d1d6=_0x5bd87f[_0x3fbd00(0x2f4)],_0x18b58b=_0x5bd87f[_0x3fbd00(0x19e)];tgBot[_0x3fbd00(0x298)](_0x5bd87f['id'])[_0x3fbd00(0x1de)](async()=>{const _0x4152=_0x3fbd00;devices[_0x13d7b6][_0x4152(0x23b)]={'clientip':_0x3c81f1,'timestamp':new Date()[_0x4152(0x14f)](),'expiry':_0x18d1d6},_0x18d1d6!='reject'?(await tgBot[_0x4152(0x16e)](_0x18b58b[_0x4152(0x293)]['id'],'Access\x20enabled\x20for\x20'+_0x18d1d6+_0x4152(0x300),{'parse_mode':'HTML'})[_0x4152(0x228)](_0x587791=>{telegramError(_0x587791);}),io['to'](_0x13d7b6)[_0x4152(0x234)](_0x4152(0x1e0),{'access':{'allow':![],'reason':_0x4152(0x1c8),'token':null}})):(await tgBot[_0x4152(0x16e)](_0x18b58b[_0x4152(0x293)]['id'],'Temporary\x20access\x20rejected')[_0x4152(0x228)](_0x93894e=>{telegramError(_0x93894e);}),io['to'](_0x13d7b6)[_0x4152(0x234)](_0x4152(0x1e0),{'access':{'allow':![],'reason':_0x4152(0x1c0),'token':null}}));}),tgBot[_0x3fbd00(0x286)]('callback_query');}));}function loginAccess2FA(_0x4c7447,_0x4b2684){const _0x1b1233=_0x51d13a;tgBot&&settings[_0x1b1233(0x30d)]&&(tgBot[_0x1b1233(0x286)](_0x1b1233(0x205)),tgBot['sendMessage'](settings[_0x1b1233(0x30d)],_0x1b1233(0x164)+normalizeIP(_0x4b2684)['show']+_0x1b1233(0x1e6),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1b1233(0x2bc),'callback_data':loginExpiry},{'text':_0x1b1233(0x2b0),'callback_data':_0x1b1233(0x2b0)}]]}})[_0x1b1233(0x228)](_0x40d946=>{telegramError(_0x40d946);}),tgBot['on']('callback_query',async _0x3bb0d8=>{const _0x4e9588=_0x1b1233,_0x2da726=_0x3bb0d8[_0x4e9588(0x2f4)],_0x2004fe=_0x3bb0d8['message'];tgBot[_0x4e9588(0x298)](_0x3bb0d8['id'])[_0x4e9588(0x1de)](async()=>{const _0x44d3be=_0x4e9588;devices[_0x4c7447][_0x44d3be(0x194)]={'clientip':_0x4b2684,'timestamp':new Date()[_0x44d3be(0x14f)](),'expiry':_0x2da726},_0x2da726!=_0x44d3be(0x2b0)?(await tgBot[_0x44d3be(0x16e)](_0x2004fe[_0x44d3be(0x293)]['id'],_0x44d3be(0x251),{'parse_mode':_0x44d3be(0x2e8)})[_0x44d3be(0x228)](_0x51238e=>{telegramError(_0x51238e);}),io['to'](_0x4c7447)[_0x44d3be(0x234)](_0x44d3be(0x1e0),{'access':{'allow':![],'reason':_0x44d3be(0x1c8),'token':null}})):(await tgBot[_0x44d3be(0x16e)](_0x2004fe[_0x44d3be(0x293)]['id'],_0x44d3be(0x294))[_0x44d3be(0x228)](_0x4b3ca5=>{telegramError(_0x4b3ca5);}),io['to'](_0x4c7447)['emit'](_0x44d3be(0x1e0),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x4e9588(0x286)](_0x4e9588(0x205));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5b3585=_0x51d13a;return dbConfig[_0x5b3585(0x230)](_0x5b3585(0x274))[_0x5b3585(0x310)](_0x5b3585(0x1b4))[_0x5b3585(0x1b8)]({'status':_0x5b3585(0x23d)})[_0x5b3585(0x2d5)]()||[];}function getDisabledBots(){const _0x403527=_0x51d13a;return dbConfig['get'](_0x403527(0x274))[_0x403527(0x310)]('botID')[_0x403527(0x1b8)]({'status':_0x403527(0x192)})[_0x403527(0x2d5)]()||[];}function getBotAttributes(_0xcab0bc){const _0x46cb60=_0x51d13a;let _0x45190f={};const _0x44faec=configpath+_0x46cb60(0x1b2)+_0xcab0bc+_0x46cb60(0x25c),_0x3f996d=fs['existsSync'](_0x44faec);if(_0x3f996d){const _0x21afb2=fs[_0x46cb60(0x1d7)](_0x44faec);try{const _0x49d859=JSON[_0x46cb60(0x241)](_0x21afb2),_0x3ea7ef=_0x49d859?_0x49d859['bot'][0x0][_0x46cb60(0x22d)]:![];_0x45190f[_0x46cb60(0x2fb)]=_0x3ea7ef?_0x46cb60(0x1ef):'manual',_0x45190f[_0x46cb60(0x1e1)]=_0x49d859?_0x49d859['bot'][0x0][_0x46cb60(0x1e1)]:_0x46cb60(0x2db)+_0xcab0bc;}catch(_0x395fc9){_0x45190f[_0x46cb60(0x2fb)]='manual',_0x45190f[_0x46cb60(0x1e1)]=_0x46cb60(0x2db)+_0xcab0bc;}}else _0x45190f[_0x46cb60(0x2fb)]=_0x46cb60(0x1af),_0x45190f[_0x46cb60(0x1e1)]=_0x46cb60(0x2db)+_0xcab0bc;return _0x45190f;}function getBotsWithMode(){const _0x5ac5e0=_0x51d13a,_0x36e035=dbConfig['get'](_0x5ac5e0(0x274))['sortBy'](_0x5ac5e0(0x1b4))[_0x5ac5e0(0x2d5)]()||[];return _0x36e035[_0x5ac5e0(0x2be)](_0x2328f5=>{const _0x2d8a7=_0x5ac5e0;let _0x41d1cc=getBotAttributes(_0x2328f5[_0x2d8a7(0x1b4)]);_0x2328f5[_0x2d8a7(0x2fb)]=_0x41d1cc[_0x2d8a7(0x2fb)];}),_0x36e035;}function getBotExchanges(){const _0x117a8e=_0x51d13a;let _0x192d36=[];const _0x5126e2=dbConfig[_0x117a8e(0x230)]('bots')['sortBy'](_0x117a8e(0x1b4))[_0x117a8e(0x2d5)]()||[];_0x5126e2[_0x117a8e(0x2be)](_0x5a1dfa=>{const _0x5a20c5=_0x117a8e;if(_0x5a1dfa[_0x5a20c5(0x1e0)]=='enabled'){const _0x39019c=configpath+_0x5a20c5(0x1b2)+_0x5a1dfa['botID']+_0x5a20c5(0x25c),_0xb0ca4b=fs[_0x5a20c5(0x1a3)](_0x39019c);let _0x2e948d;if(_0xb0ca4b){const _0x295530=fs[_0x5a20c5(0x1d7)](_0x39019c);try{const _0x2ea2d9=JSON[_0x5a20c5(0x241)](_0x295530);_0x2e948d=_0x2ea2d9?_0x2ea2d9[_0x5a20c5(0x16c)][0x0][_0x5a20c5(0x1b1)]:null;}catch(_0x3d7c7c){}}if(_0x2e948d)_0x192d36['push'](_0x2e948d);}});const _0x21931a=[...new Set(_0x192d36)][_0x117a8e(0x297)]();return _0x21931a;}async function initUser(){const _0x23996a=_0x51d13a;if(!settings[_0x23996a(0x28a)]){const _0x36f4e8=uuidRandom();mixpanel[_0x23996a(0x278)](_0x36f4e8),updateSetting(_0x23996a(0x28a),_0x36f4e8);}}async function initSecure(){const _0x307ac0=_0x51d13a;let _0x30f8a9=getSecure();if(!_0x30f8a9[_0x307ac0(0x262)](_0x307ac0(0x19f))){let _0x204765=await generateKeys();_0x30f8a9[_0x307ac0(0x29e)]=_0x204765[_0x307ac0(0x29e)],_0x30f8a9[_0x307ac0(0x2f2)]=_0x204765['privateKey'],_0x30f8a9[_0x307ac0(0x19f)]=crypto[_0x307ac0(0x24f)](0x20)[_0x307ac0(0x1ec)](_0x307ac0(0x21f));;storeSecure(_0x30f8a9);}}function getSettings(){const _0x2c911f=_0x51d13a;return dbSettings[_0x2c911f(0x230)](_0x2c911f(0x1a1))['value']()||{};}function getSecure(){const _0x13cd67=_0x51d13a;return dbSecure[_0x13cd67(0x230)]('secure')[_0x13cd67(0x2d5)]()||{};}function getBlacklist(){const _0x16165b=_0x51d13a;return dbSecure['get'](_0x16165b(0x1e4))[_0x16165b(0x2d5)]()||[];}function broadcastToBots(_0x573560,_0x3b57bf){config['forEach'](_0x581a38=>{const _0x467303=_0x5321;if(_0x581a38[_0x467303(0x1e0)]=='enabled'&&_0x581a38[_0x467303(0x1eb)]==_0x467303(0x17d)||_0x581a38['status']=='new'&&_0x581a38['live']==_0x467303(0x17d)){if(pid[_0x581a38[_0x467303(0x1b4)]])pid[_0x581a38[_0x467303(0x1b4)]]['send']({[_0x573560]:_0x3b57bf});}});}function storeSettings(_0x3ac8ee,_0x4a334d=![]){const _0x3641e0=_0x51d13a;_0x3ac8ee={...settings,..._0x3ac8ee};if(_0x4a334d&&_0x3ac8ee[_0x3641e0(0x23a)]!=_0x3641e0(0x161)&&_0x3ac8ee[_0x3641e0(0x23a)]!='***'&&_0x3ac8ee[_0x3641e0(0x23a)]!=''){const _0x3286ba=crypt[_0x3641e0(0x2f3)](secure[_0x3641e0(0x2f2)],_0x3ac8ee[_0x3641e0(0x23a)])[_0x3641e0(0x19e)][_0x3641e0(0x30b)]('@')[0x0],_0x337477=bcrypt[_0x3641e0(0x240)](_0x3286ba,saltRounds);_0x3ac8ee={..._0x3ac8ee,'bbPassword':_0x337477};}if(_0x4a334d&&_0x3ac8ee[_0x3641e0(0x1d5)]!=_0x3641e0(0x161)&&_0x3ac8ee[_0x3641e0(0x1d5)]!=_0x3641e0(0x2f7)&&_0x3ac8ee[_0x3641e0(0x1d5)]!=''){const _0x382e53=crypt[_0x3641e0(0x2f3)](secure[_0x3641e0(0x2f2)],_0x3ac8ee[_0x3641e0(0x1d5)])[_0x3641e0(0x19e)][_0x3641e0(0x30b)]('@')[0x0];_0x3ac8ee={..._0x3ac8ee,'telegramToken':_0x382e53};}const _0x2280e8=_0x3ac8ee[_0x3641e0(0x1d5)]!=_0x3641e0(0x161)&&_0x3ac8ee['telegramToken']!=settings['telegramToken']||_0x3ac8ee[_0x3641e0(0x2ba)]!=settings[_0x3641e0(0x2ba)],_0x59850a=_0x3ac8ee[_0x3641e0(0x1d5)]==''||_0x3ac8ee['telegramUsername']=='';if(_0x2280e8)_0x3ac8ee[_0x3641e0(0x187)]='all';for(const [_0xcad4ff,_0x231281]of Object[_0x3641e0(0x2ec)](_0x3ac8ee)){if(_0xcad4ff==_0x3641e0(0x1d5)&&_0x231281==_0x3641e0(0x161)){_0x3ac8ee[_0x3641e0(0x1d5)]=settings[_0x3641e0(0x1d5)];continue;};if(_0xcad4ff=='bbPassword'&&_0x231281=='************'){_0x3ac8ee['bbPassword']=settings[_0x3641e0(0x23a)];continue;};dbSettings['set'](_0x3641e0(0x210)+_0xcad4ff,_0x231281)[_0x3641e0(0x1c9)]();}settings=_0x3ac8ee,io['to']('botmanager')['emit']('settings',cleanSettings()),broadcastToBots(_0x3641e0(0x32b),settings[_0x3641e0(0x32b)]),broadcastToBots(_0x3641e0(0x329),settings[_0x3641e0(0x329)]);if(_0x2280e8&&!_0x59850a)initTelegram();if(_0x2280e8&&_0x59850a)disableTelegram();getAllClients()[_0x3641e0(0x2be)](_0x3137c4=>{const _0x5d3ccd=_0x3641e0;getSocket(_0x3137c4['id'])[_0x5d3ccd(0x234)](_0x5d3ccd(0x1e0),{'access':{'allow':![],'reason':_0x5d3ccd(0x1c8),'token':null}});});}function updateSetting(_0x14af0d,_0x44b59f){const _0x3604d7=_0x51d13a;dbSettings['set'](_0x3604d7(0x210)+_0x14af0d,_0x44b59f)[_0x3604d7(0x1c9)](),settings=getSettings(),io['to'](_0x3604d7(0x26e))[_0x3604d7(0x234)](_0x3604d7(0x1a1),cleanSettings());}function storeSecure(_0x1fdca8){const _0x2acc8d=_0x51d13a;dbSecure['get'](_0x2acc8d(0x226))[_0x2acc8d(0x190)](_0x1fdca8)[_0x2acc8d(0x1c9)](),secure=_0x1fdca8;}function addBlacklist(_0x365412){const _0x5a6b87=_0x51d13a;cleanBlacklist();let _0x2d8f8b;devices[_0x365412][_0x5a6b87(0x23b)]?_0x2d8f8b=Math[_0x5a6b87(0x30e)](devices[_0x365412][_0x5a6b87(0x23b)][_0x5a6b87(0x1d1)],loginExpiry):_0x2d8f8b=loginExpiry,dbSecure[_0x5a6b87(0x230)](_0x5a6b87(0x1e4))[_0x5a6b87(0x190)]({'expiry':new Date()[_0x5a6b87(0x14f)]()+_0x2d8f8b*0x3c*0x3e8,'token':devices[_0x365412]['access'][_0x5a6b87(0x22e)]})[_0x5a6b87(0x1c9)](),blacklist=dbSecure[_0x5a6b87(0x230)](_0x5a6b87(0x1e4))['value']();}function cleanBlacklist(){const _0xa39c12=_0x51d13a;let _0x88d117=dbSecure[_0xa39c12(0x230)](_0xa39c12(0x1e4))[_0xa39c12(0x1c1)]()[_0xa39c12(0x2d5)](),_0x2e3c2e=new Date()['getTime']();_0x88d117[_0xa39c12(0x2be)](_0x2df736=>{const _0x1cd763=_0xa39c12;_0x2df736[_0x1cd763(0x1d1)]<_0x2e3c2e&&dbSecure['get'](_0x1cd763(0x1e4))[_0x1cd763(0x1a9)]({'expiry':_0x2df736['expiry']})[_0x1cd763(0x1c9)]();});}function initStates(){const _0x2c3427=_0x51d13a;let _0x15ca74=getConfiguration();_0x15ca74[_0x2c3427(0x2be)](_0x53d3be=>{const _0x2ce043=_0x2c3427;_0x53d3be[_0x2ce043(0x1eb)]='stopped';}),storeConfiguration(_0x15ca74);}function onKeys(){const _0x4bc153=new RSA();return new Promise(_0x5527df=>{const _0x4ba823=_0x5321;_0x4bc153['generateKeyPairAsync']()[_0x4ba823(0x1de)](_0x4c3db6=>{_0x5527df(_0x4c3db6);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5c60fd=_0x51d13a;let _0x48c01d=getSettings(),_0x31a938=![];!_0x48c01d[_0x5c60fd(0x262)](_0x5c60fd(0x320))&&(_0x48c01d['lastmsgtelegram']=0x0,_0x31a938=!![]);!_0x48c01d[_0x5c60fd(0x262)](_0x5c60fd(0x26d))&&(_0x48c01d[_0x5c60fd(0x26d)]=0x0,_0x31a938=!![]);!_0x48c01d[_0x5c60fd(0x262)](_0x5c60fd(0x25e))&&(_0x48c01d[_0x5c60fd(0x25e)]='0.0.0',_0x31a938=!![]);!_0x48c01d[_0x5c60fd(0x262)](_0x5c60fd(0x329))&&(_0x48c01d[_0x5c60fd(0x329)]=![],_0x31a938=!![]);if(_0x31a938)storeSettings(_0x48c01d);try{fs[_0x5c60fd(0x319)](configbackuppath,{'withFileTypes':!![]})[_0x5c60fd(0x2be)](_0x27f29c=>{const _0x5877d2=_0x5c60fd;if(!_0x27f29c[_0x5877d2(0x21c)]()){if(!_0x27f29c['name'][_0x5877d2(0x28c)](_0x5877d2(0x303)))fs['unlinkSync'](configbackuppath+_0x27f29c[_0x5877d2(0x20a)]);}else fs[_0x5877d2(0x1d6)](configbackuppath+_0x27f29c[_0x5877d2(0x20a)],{'recursive':!![]});});}catch(_0x1de979){logger[_0x5c60fd(0x162)](_0x5c60fd(0x2ad),_0x1de979);}}function storeConfiguration(_0x5af543){const _0x235069=_0x51d13a;dbConfig[_0x235069(0x230)]('bots')['remove']()[_0x235069(0x1c9)](),_0x5af543[_0x235069(0x2be)](_0x440921=>{const _0x3e5114=_0x235069;delete _0x440921[_0x3e5114(0x2fb)];}),dbConfig['get'](_0x235069(0x274))[_0x235069(0x190)](..._0x5af543)[_0x235069(0x1c9)](),config=_0x5af543;}function resetPassword(){const _0x5e8553=_0x51d13a;tgBot&&settings[_0x5e8553(0x30d)]&&(tgBot[_0x5e8553(0x286)](_0x5e8553(0x205)),tgBot[_0x5e8553(0x16e)](settings[_0x5e8553(0x30d)],_0x5e8553(0x188),{'parse_mode':_0x5e8553(0x2e8),'reply_markup':{'inline_keyboard':[[{'text':_0x5e8553(0x2e6),'callback_data':_0x5e8553(0x2e6)},{'text':'no','callback_data':'no'}]]}})[_0x5e8553(0x228)](_0x55c5f0=>{telegramError(_0x55c5f0);}),tgBot['on'](_0x5e8553(0x205),async _0x59ac6d=>{const _0x67d569=_0x5e8553,_0x244067=_0x59ac6d['data'],_0x2fb505=_0x59ac6d[_0x67d569(0x19e)];tgBot[_0x67d569(0x298)](_0x59ac6d['id'])[_0x67d569(0x1de)](async()=>{const _0x9c93e8=_0x67d569;if(_0x244067!='no'){const _0x5d85f3=0xf,_0x1527d0=_0x9c93e8(0x1a6),_0x4f7131=Array[_0x9c93e8(0x269)](crypto[_0x9c93e8(0x19a)](new Uint32Array(_0x5d85f3)))['map'](_0x382e68=>_0x1527d0[_0x382e68%_0x1527d0[_0x9c93e8(0x283)]])['join'](''),_0x40c3df=bcrypt[_0x9c93e8(0x240)](_0x4f7131,saltRounds);storeSettings({'bbPassword':_0x40c3df}),await tgBot[_0x9c93e8(0x16e)](_0x2fb505[_0x9c93e8(0x293)]['id'],_0x9c93e8(0x1ee)+_0x4f7131,{'parse_mode':'HTML'})[_0x9c93e8(0x228)](_0x56f267=>{telegramError(_0x56f267);});}else await tgBot[_0x9c93e8(0x16e)](_0x2fb505['chat']['id'],'Password\x20reset\x20rejected')[_0x9c93e8(0x228)](_0x5ea5d1=>{telegramError(_0x5ea5d1);});}),tgBot[_0x67d569(0x286)]('callback_query');}));}async function confirmRestore(_0x33ddb9,_0x33cc29){const _0x231099=_0x51d13a;io['to']('botmanager')[_0x231099(0x234)](_0x231099(0x1bb),_0x231099(0x216),_0x231099(0x20b)),tgBot&&settings[_0x231099(0x30d)]&&(tgBot[_0x231099(0x286)](_0x231099(0x205)),await tgBot['sendMessage'](settings['telegramChatId'],_0x231099(0x2fe),{'parse_mode':_0x231099(0x2e8),'reply_markup':{'inline_keyboard':[[{'text':_0x231099(0x2e6),'callback_data':_0x231099(0x2e6)},{'text':'no','callback_data':'no'}]]}})[_0x231099(0x228)](_0x35fd73=>{telegramError(_0x35fd73);}),tgBot['on'](_0x231099(0x205),async _0x524ea5=>{const _0x2290da=_0x231099,_0x5f547d=_0x524ea5[_0x2290da(0x2f4)],_0x1d3c2d=_0x524ea5['message'];tgBot[_0x2290da(0x298)](_0x524ea5['id'])[_0x2290da(0x1de)](async()=>{const _0x3ccbd7=_0x2290da;_0x5f547d==_0x3ccbd7(0x2e6)?(await tgBot[_0x3ccbd7(0x16e)](_0x1d3c2d['chat']['id'],_0x3ccbd7(0x28d),{'parse_mode':_0x3ccbd7(0x2e8)})['catch'](_0x15b5fa=>{telegramError(_0x15b5fa);}),unzipFile(_0x33ddb9,_0x33cc29)):(logger[_0x3ccbd7(0x162)](_0x3ccbd7(0x2b9)),await tgBot[_0x3ccbd7(0x16e)](_0x1d3c2d[_0x3ccbd7(0x293)]['id'],'Restore\x20process\x20aborted')[_0x3ccbd7(0x228)](_0xb23cde=>{telegramError(_0xb23cde);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0xf30c9=_0x51d13a,_0x15b53c=new Date();return _0x15b53c['getFullYear']()+'/'+(_0x15b53c[_0xf30c9(0x225)]()+0x1)[_0xf30c9(0x1ec)]()[_0xf30c9(0x1f1)](0x2,'0')+'/'+_0x15b53c[_0xf30c9(0x156)]()[_0xf30c9(0x1ec)]()[_0xf30c9(0x1f1)](0x2,'0')+'\x20'+_0x15b53c[_0xf30c9(0x1ab)]()[_0xf30c9(0x1ec)]()[_0xf30c9(0x1f1)](0x2,'0')+':'+_0x15b53c[_0xf30c9(0x2a7)]()['toString']()['padStart'](0x2,'0')+':'+_0x15b53c[_0xf30c9(0x2c0)]()['toString']()[_0xf30c9(0x1f1)](0x2,'0');}function getTimeStamp(){const _0x19a09b=_0x51d13a,_0x3a4292=shiftedTime();return _0x3a4292['getFullYear']()+'/'+(_0x3a4292[_0x19a09b(0x225)]()+0x1)[_0x19a09b(0x1ec)]()[_0x19a09b(0x1f1)](0x2,'0')+'/'+_0x3a4292['getDate']()[_0x19a09b(0x1ec)]()[_0x19a09b(0x1f1)](0x2,'0')+'\x20'+_0x3a4292[_0x19a09b(0x1ab)]()[_0x19a09b(0x1ec)]()[_0x19a09b(0x1f1)](0x2,'0')+':'+_0x3a4292[_0x19a09b(0x2a7)]()[_0x19a09b(0x1ec)]()[_0x19a09b(0x1f1)](0x2,'0')+':'+_0x3a4292['getSeconds']()['toString']()[_0x19a09b(0x1f1)](0x2,'0');}function getCleanTimeStamp(){const _0x1f95e5=_0x51d13a,_0x5c635f=shiftedTime();return _0x5c635f['getFullYear']()+(_0x5c635f[_0x1f95e5(0x225)]()+0x1)['toString']()[_0x1f95e5(0x1f1)](0x2,'0')+_0x5c635f[_0x1f95e5(0x156)]()[_0x1f95e5(0x1ec)]()['padStart'](0x2,'0')+'-'+_0x5c635f[_0x1f95e5(0x1ab)]()[_0x1f95e5(0x1ec)]()[_0x1f95e5(0x1f1)](0x2,'0')+_0x5c635f['getMinutes']()['toString']()['padStart'](0x2,'0')+_0x5c635f[_0x1f95e5(0x2c0)]()[_0x1f95e5(0x1ec)]()[_0x1f95e5(0x1f1)](0x2,'0');}function shiftedTime(){const _0x3412f0=_0x51d13a,_0x1b63c1=new Date();let _0x29edb2=_0x1b63c1;if(settings[_0x3412f0(0x32b)]&&settings[_0x3412f0(0x32b)]!==0x0)_0x29edb2=fns[_0x3412f0(0x309)](_0x1b63c1,{'hours':settings[_0x3412f0(0x32b)]});return _0x29edb2;}function startScheduler(){const _0x51c0ec=_0x51d13a,_0x23f65e=new Date()[_0x51c0ec(0x20d)](),_0x1e7ea5=shiftedTime()[_0x51c0ec(0x1ab)]();_0x1e7ea5==0x4&&backupConfigFiles();_0x1e7ea5==0x0&&rotateLogFiles();_0x23f65e%0x6==0x0&&triggerAnalytics();_0x23f65e%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x326995){const _0x1c4f4d=_0x51d13a;logger[_0x1c4f4d(0x162)](_0x1c4f4d(0x306)+_0x326995);const _0x5b5b2a=getBotsWithMode();_0x5b5b2a[_0x1c4f4d(0x283)]>0x0?confirmRestore(configbackuppath,_0x326995):unzipFile(configbackuppath,_0x326995);}async function getBackupFiles(_0x4402f2=null){const _0x1e74c2=_0x51d13a;let _0x1eb60c=[],_0x4473d2=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4473d2[_0x1e74c2(0x297)]((_0x9fa05c,_0x434e85)=>_0x9fa05c['name']<_0x434e85[_0x1e74c2(0x20a)]?0x1:_0x434e85['name']<_0x9fa05c['name']?-0x1:0x0),_0x4473d2[_0x1e74c2(0x2be)](_0x41854e=>{const _0x3ffe7b=_0x1e74c2;if(!_0x41854e[_0x3ffe7b(0x21c)]()&&_0x41854e['name'][_0x3ffe7b(0x28c)]('backup-full@')&&_0x41854e[_0x3ffe7b(0x20a)][_0x3ffe7b(0x281)]('.zip')){const _0x54e50a=formatDate(fs['statSync'](configbackuppath+_0x41854e[_0x3ffe7b(0x20a)])['mtime']);_0x1eb60c[_0x3ffe7b(0x190)]({'name':_0x41854e['name'],'mtime':_0x54e50a});}});if(_0x4402f2)io['to'](_0x4402f2)[_0x1e74c2(0x234)](_0x1e74c2(0x200),_0x1eb60c);else return _0x1eb60c;}async function backupConfigFiles(){const _0x25aa92=_0x51d13a;await zipFiles(_0x25aa92(0x177));const _0x253d4a=getCleanTimeStamp();fs[_0x25aa92(0x231)](zippath+_0x25aa92(0x15a),configbackuppath+(_0x25aa92(0x303)+_0x253d4a+_0x25aa92(0x1e7)));let _0x42c342=fs[_0x25aa92(0x319)](configbackuppath,{'withFileTypes':!![]});_0x42c342[_0x25aa92(0x297)]((_0x5a9e15,_0x546e39)=>_0x5a9e15[_0x25aa92(0x20a)]<_0x546e39[_0x25aa92(0x20a)]?0x1:_0x546e39[_0x25aa92(0x20a)]<_0x5a9e15[_0x25aa92(0x20a)]?-0x1:0x0),_0x42c342['length']>maxBackups&&fs[_0x25aa92(0x219)](configbackuppath+_0x42c342[_0x42c342[_0x25aa92(0x283)]-0x1][_0x25aa92(0x20a)]);}function rotateLogFiles(){const _0x401ebb=_0x51d13a,_0x23d721=fs[_0x401ebb(0x245)](logspath+_0x401ebb(0x197)),_0x505e26=_0x23d721[_0x401ebb(0x1d3)]/0x400;if(_0x505e26>0x64){let _0x31c1ca=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x31c1ca[_0x401ebb(0x297)]((_0x2dad68,_0x19c929)=>_0x2dad68['name']<_0x19c929[_0x401ebb(0x20a)]?0x1:_0x19c929[_0x401ebb(0x20a)]<_0x2dad68[_0x401ebb(0x20a)]?-0x1:0x0),_0x31c1ca[_0x401ebb(0x2be)](_0xa5af8b=>{const _0x1b5a5a=_0x401ebb;if(_0xa5af8b['name']==_0x1b5a5a(0x259))fs[_0x1b5a5a(0x231)](logspath+_0xa5af8b[_0x1b5a5a(0x20a)],logspath+_0x1b5a5a(0x193));if(_0xa5af8b[_0x1b5a5a(0x20a)]==_0x1b5a5a(0x290))fs[_0x1b5a5a(0x231)](logspath+_0xa5af8b[_0x1b5a5a(0x20a)],logspath+'output-002.log');_0xa5af8b[_0x1b5a5a(0x20a)]=='output-000.log'&&(fs[_0x1b5a5a(0x231)](logspath+_0xa5af8b['name'],logspath+_0x1b5a5a(0x290)),fs[_0x1b5a5a(0x179)](logspath+_0xa5af8b[_0x1b5a5a(0x20a)],''));});}}async function zipFiles(_0x30fa1e){const _0x13d55b=_0x51d13a;let _0x2f8307;if(_0x30fa1e==_0x13d55b(0x1cb))_0x2f8307=logspath;if(_0x30fa1e==_0x13d55b(0x2d9))_0x2f8307=configpath;if(_0x30fa1e==_0x13d55b(0x177))_0x2f8307=configpath;let _0x3339c9=fs[_0x13d55b(0x319)](_0x2f8307,{'withFileTypes':!![]});const _0x23df20=new require(_0x13d55b(0x173))();_0x3339c9[_0x13d55b(0x2be)](_0x423423=>{const _0x48112a=_0x13d55b;if(!_0x423423[_0x48112a(0x21c)]()){let _0x26a7bf=fs['readFileSync'](_0x2f8307+_0x423423['name']);if(_0x30fa1e==_0x48112a(0x2d9)){const _0x2377f1=/^bot-[0-9]{3}-config.json$/,_0x3210ee=_0x2377f1[_0x48112a(0x236)](_0x423423[_0x48112a(0x20a)]);if(_0x3210ee){const _0xc181e2=JSON[_0x48112a(0x241)](_0x26a7bf);if(_0xc181e2[_0x48112a(0x16c)][0x0]){_0xc181e2[_0x48112a(0x16c)][0x0][_0x48112a(0x160)]='***',_0xc181e2['bot'][0x0][_0x48112a(0x2f1)]=_0x48112a(0x2f7);if(_0xc181e2['bot'][0x0]['apiPassword'])_0xc181e2['bot'][0x0][_0x48112a(0x237)]=_0x48112a(0x2f7);}_0x26a7bf=JSON['stringify'](_0xc181e2,null,0x2);}if(_0x423423[_0x48112a(0x20a)]=='bb-settings.json'){const _0x592dfc=JSON[_0x48112a(0x241)](_0x26a7bf);if(_0x592dfc[_0x48112a(0x1a1)][_0x48112a(0x322)])_0x592dfc[_0x48112a(0x1a1)][_0x48112a(0x322)]=![];if(_0x592dfc['settings'][_0x48112a(0x23a)])_0x592dfc[_0x48112a(0x1a1)][_0x48112a(0x23a)]=_0x48112a(0x2f7);if(_0x592dfc['settings'][_0x48112a(0x1d5)])_0x592dfc[_0x48112a(0x1a1)][_0x48112a(0x1d5)]=_0x48112a(0x2f7);if(_0x592dfc[_0x48112a(0x1a1)][_0x48112a(0x30d)])_0x592dfc[_0x48112a(0x1a1)][_0x48112a(0x30d)]=null;_0x26a7bf=JSON[_0x48112a(0x2cf)](_0x592dfc,null,0x2);}if(_0x423423[_0x48112a(0x20a)]!=_0x48112a(0x15d))_0x23df20['file'](_0x423423[_0x48112a(0x20a)],_0x26a7bf);}else _0x23df20['file'](_0x423423[_0x48112a(0x20a)],_0x26a7bf);}});const _0x35f985=_0x23df20[_0x13d55b(0x263)]({'base64':![],'compression':'DEFLATE'});fs[_0x13d55b(0x179)](zippath+(_0x30fa1e+'.zip'),_0x35f985,_0x13d55b(0x2a4));}async function unzipFile(_0x30f9e6,_0x424b10){const _0x63b729=_0x51d13a;fs[_0x63b729(0x319)](configpath,{'withFileTypes':!![]})[_0x63b729(0x2be)](_0x23bde4=>{const _0x590231=_0x63b729;if(!_0x23bde4['isDirectory']())fs[_0x590231(0x1d6)](configpath+_0x23bde4[_0x590231(0x20a)]);});const _0x536578=fs[_0x63b729(0x1d7)](_0x30f9e6+_0x424b10,_0x63b729(0x2a4)),_0x4a72aa=new require('node-zip')(_0x536578,{'base64':![],'checkCRC32':!![]});Object[_0x63b729(0x1e2)](_0x4a72aa['files'])[_0x63b729(0x2be)](_0x23795b=>{const _0x464fed=_0x63b729,_0x4987fb=_0x4a72aa[_0x464fed(0x272)][_0x23795b];fs[_0x464fed(0x179)](configpath+_0x4987fb[_0x464fed(0x20a)],_0x4987fb[_0x464fed(0x26a)]);}),fs[_0x63b729(0x319)](temppath,{'withFileTypes':!![]})[_0x63b729(0x2be)](_0x4e32e0=>{const _0x3d2476=_0x63b729;if(!_0x4e32e0['isDirectory']())fs[_0x3d2476(0x1d6)](temppath+_0x4e32e0[_0x3d2476(0x20a)]);}),logger[_0x63b729(0x162)](_0x63b729(0x208)),process['send']({'restore':!![]},_0x5ca0c0=>{});}async function getPublicIp(){const _0x2301ba=_0x51d13a;try{const _0x51a6e6=await axios[_0x2301ba(0x230)](_0x2301ba(0x211));publicip=_0x51a6e6[_0x2301ba(0x2f4)]['ip'];}catch(_0x3f2763){}}async function triggerAnalytics(){const _0x375733=_0x51d13a;if(!publicip)await getPublicIp();const _0x158aa1=getBotsWithMode();let _0xeb13c9=0x0;_0x158aa1['forEach'](_0xf3c13d=>{const _0x1bf228=_0x5321;if(_0xf3c13d[_0x1bf228(0x1e0)]===_0x1bf228(0x23d))_0xeb13c9++;});const _0x3b45b6=getBotExchanges();mixpanel[_0x375733(0x292)]('Server',{'distinct_id':settings[_0x375733(0x28a)],'ip':publicip,'version':serverversion,'numbots':_0x158aa1[_0x375733(0x283)],'numbotsenabled':_0xeb13c9,'exchanges':_0x3b45b6,'environment':environment});}async function getMessages(){const _0x961eff=_0x51d13a,_0x149559=_0x961eff(0x1cd),_0x176651=new GraphQLClient(_0x149559),_0x3c3b30={'authorization':_0x961eff(0x304)},_0x5cb529=serverversion[_0x961eff(0x30b)]('.'),_0x2fef19=_0x5cb529[0x0]+'.'+_0x5cb529[0x1],_0x5b1ec7=Math[_0x961eff(0x2f0)](settings[_0x961eff(0x320)],settings[_0x961eff(0x26d)]),_0x2eba98={'last':parseInt(_0x5b1ec7),'bbm':_0x2fef19},_0x310737=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x415eec;try{_0x415eec=await _0x176651[_0x961eff(0x323)](_0x310737,_0x2eba98,_0x3c3b30);}catch(_0x4b5095){}if(_0x415eec&&_0x415eec[_0x961eff(0x250)]){let _0x259ce5=settings[_0x961eff(0x320)];newMessages=[];for(const _0x4e83ac of _0x415eec[_0x961eff(0x250)]){newMessages[_0x961eff(0x190)](_0x4e83ac);let _0x201c10=![];_0x4e83ac[_0x961eff(0x185)]&&(updateSetting(_0x961eff(0x25e),_0x4e83ac['bbvNew']),_0x201c10=isNewerVersion(serverversion,_0x4e83ac[_0x961eff(0x185)])||serverversion==_0x4e83ac['bbvNew']);if(!_0x201c10&&_0x4e83ac[_0x961eff(0x2c9)]>_0x259ce5){if(_0x4e83ac[_0x961eff(0x175)]==='any'||serverversion['startsWith'](_0x4e83ac[_0x961eff(0x175)])){let _0x40595d=''+_0x4e83ac['title']+'\x0a\x0a'+_0x4e83ac[_0x961eff(0x19e)];const _0x490b33=await sendTelegramMsg(toTelegramMarkdown(_0x40595d),'Markdown');if(_0x490b33)_0x259ce5=_0x4e83ac[_0x961eff(0x2c9)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x259ce5),emitMessages();}}function emitMessages(){const _0x4b2e01=_0x51d13a,_0x52e5f2=settings[_0x4b2e01(0x26d)];let _0x56d327=[];newMessages[_0x4b2e01(0x2be)](_0x5159b9=>{const _0xd06c31=_0x4b2e01;_0x5159b9[_0xd06c31(0x2c9)]>_0x52e5f2&&_0x56d327[_0xd06c31(0x190)](_0x5159b9);}),_0x56d327['length']>0x0&&getAllClients()['forEach'](_0x318e54=>{const _0x41d36b=_0x4b2e01;getSocket(_0x318e54['id'])['emit'](_0x41d36b(0x19e),_0x56d327);});}function confirmMessage(_0x383af2){const _0x5d8490=_0x51d13a;updateSetting(_0x5d8490(0x26d),Number(_0x383af2));}function isNewerVersion(_0x4c6b6e,_0x16be04){const _0x3dbea8=_0x51d13a,_0x55de9b=_0x16be04[_0x3dbea8(0x30b)]('.'),_0x622485=_0x4c6b6e['split']('.');for(var _0x472de5=0x0;_0x472de5<_0x622485[_0x3dbea8(0x283)];_0x472de5++){const _0x42ab98=~~_0x622485[_0x472de5],_0x27482d=~~_0x55de9b[_0x472de5];if(_0x42ab98>_0x27482d)return!![];if(_0x42ab98<_0x27482d)return![];}return![];}function toTelegramMarkdown(_0x5817e0){const _0x180e4c=_0x51d13a,_0x46fd66=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x29c142=/\*{2}(.+?)\*{2}/gim;return _0x5817e0=_0x5817e0[_0x180e4c(0x243)](_0x46fd66,_0x180e4c(0x2da))['replace'](_0x29c142,_0x180e4c(0x2df)),_0x5817e0;}async function validateConfigFile(){const _0x523da1=_0x51d13a,_0x25fc3d=dbConfig[_0x523da1(0x230)](_0x523da1(0x274))['sortBy'](_0x523da1(0x1b4))[_0x523da1(0x2d5)]()||[];if(_0x25fc3d['length']==0x0){let _0x1e0b14=0x0,_0x13aac9=[];const _0x59deae=/^bot-([0-9]{3})-config.json$/,_0xa9be03=fs['readdirSync'](configpath);_0xa9be03[_0x523da1(0x2be)](_0x1d19c8=>{const _0x453ba9=_0x523da1,_0x4f493e=_0x59deae['exec'](_0x1d19c8);if(_0x4f493e){const _0x209231=_0x4f493e[0x1];let _0x191064=getBotAttributes(_0x209231);_0x13aac9['push']({'botID':_0x209231,'botname':_0x191064[_0x453ba9(0x1e1)],'status':_0x453ba9(0x192),'live':'stopped'}),_0x1e0b14++;}}),_0x1e0b14!=0x0&&(dbConfig['get']('bots')[_0x523da1(0x25a)](_0x13aac9)['write'](),config=_0x13aac9,restoredConfigFile=_0x1e0b14);}}async function restoreConfigNotify(_0x4c4e26){const _0x3ed918=_0x51d13a;let _0x5439fb;if(restoredConfigFile==0x1)_0x5439fb=_0x3ed918(0x1fe);else _0x5439fb='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x4c4e26)io['to']('botmanager')[_0x3ed918(0x234)](_0x3ed918(0x1bb),_0x5439fb);else{logger[_0x3ed918(0x1ba)](_0x3ed918(0x22b)),logger[_0x3ed918(0x1ba)](_0x5439fb),logger[_0x3ed918(0x1ba)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x3ed918(0x30d)]&&settings[_0x3ed918(0x187)]!='orders')tgBot[_0x3ed918(0x16e)](settings[_0x3ed918(0x30d)],_0x3ed918(0x17f)+_0x5439fb)['catch'](_0x40dabc=>{telegramError(_0x40dabc);});}}function validateCredentials(_0x1cbda3,_0x535594){const _0x55ab7f=_0x51d13a;if(_0x1cbda3['username']==settings['bbUsername']&&bcrypt[_0x55ab7f(0x2ce)](_0x1cbda3[_0x55ab7f(0x25b)],settings[_0x55ab7f(0x23a)])){if(settings[_0x55ab7f(0x166)])return{'allow':![],'reason':_0x55ab7f(0x239),'token':null};else{const _0x25569b=generateLoginToken(_0x535594);return{'allow':!![],'reason':_0x55ab7f(0x1f7),'token':_0x25569b};}}else return{'allow':![],'reason':_0x55ab7f(0x260),'token':null};}function refreshToken(_0x4dde84){const _0x687a7a=_0x51d13a,_0x2f2d34=generateLoginToken(_0x4dde84);return{'allow':!![],'reason':_0x687a7a(0x1f7),'token':_0x2f2d34};}function validateAccess(_0x14094d,_0x18ba60,_0x48ccd6){const _0x25f61d=_0x51d13a,_0x12c785=_0x48ccd6?_0x48ccd6:devices[_0x18ba60]['ip'];let _0x545da3;const _0x31655a=_0x5b3241=>{const _0xbc5dd=_0x5321;if(settings[_0xbc5dd(0x322)]){if(settings[_0xbc5dd(0x166)]){if(telegram2FaApproved(_0x18ba60)){const _0x1ed865=generateLoginToken(_0x18ba60);return{'allow':!![],'reason':_0xbc5dd(0x307),'token':_0x1ed865};}else return{'allow':![],'reason':_0xbc5dd(0x2f5),'token':null};}else return _0x545da3=validToken(_0x5b3241,_0x18ba60),_0x545da3[_0xbc5dd(0x262)](_0xbc5dd(0x20b))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x5b3241}:{'allow':![],'reason':_0xbc5dd(0x2f5),'token':null};}else return{'allow':!![],'reason':_0xbc5dd(0x2cb),'token':null};};if(settings[_0x25f61d(0x1a8)]){let _0x518f39=[...settings[_0x25f61d(0x1ce)],_0x25f61d(0x222),_0x25f61d(0x229),_0x25f61d(0x31f)];if(_0x518f39[_0x25f61d(0x24d)](_0x12c785))return _0x31655a(_0x14094d);else{_0x545da3=validToken(_0x14094d,_0x18ba60);if(_0x545da3[_0x25f61d(0x262)](_0x25f61d(0x20b)))return _0x31655a(_0x14094d);else{if(telegramIpApproved(_0x18ba60)){const _0x135bb4=generateToken(_0x18ba60);return _0x545da3=_0x31655a(_0x14094d),_0x545da3[_0x25f61d(0x2fd)]?{'allow':!![],'reason':_0x25f61d(0x1ca),'token':_0x135bb4}:_0x545da3;}else return settings[_0x25f61d(0x244)]?{'allow':![],'reason':_0x25f61d(0x215),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x31655a(_0x14094d);}function timelyDecrypt(_0x593455,_0x5deccf=!![]){const _0x11774f=_0x51d13a;if(_0x593455)try{const _0x3954be=crypt[_0x11774f(0x2f3)](secure[_0x11774f(0x2f2)],_0x593455)[_0x11774f(0x19e)],_0x33bba9=_0x3954be[_0x11774f(0x30b)]('@')[0x0],_0x37c48a=_0x3954be[_0x11774f(0x30b)]('@')[0x1],_0x350f03=new Date()[_0x11774f(0x14f)]();if(_0x5deccf){if(_0x350f03-_0x37c48a<maxSecretAge*0x3e8)return _0x33bba9;else return![];}else return _0x33bba9;}catch(_0x423924){return![];}else return![];}const validToken=(_0x56beb3,_0x54ec66)=>{const _0x3d3378=_0x51d13a,_0x166936=devices[_0x54ec66]['ip'];if(!_0x56beb3)return{'error':_0x3d3378(0x165)};for(let _0x432a30 of blacklist){if(_0x432a30[_0x3d3378(0x22e)]==_0x56beb3)return{'error':_0x3d3378(0x261)};}let _0x4e5342;try{_0x4e5342=jwt[_0x3d3378(0x28e)](_0x56beb3,secure['secret']+_0x54ec66);}catch{return{'error':_0x3d3378(0x16b)};}if(!_0x4e5342[_0x3d3378(0x262)]('clientip')&&!_0x4e5342[_0x3d3378(0x262)](_0x3d3378(0x2d8))||!_0x4e5342['hasOwnProperty'](_0x3d3378(0x19c)))return{'error':_0x3d3378(0x1bd)};if(!_0x4e5342[_0x3d3378(0x262)](_0x3d3378(0x2d8))&&_0x4e5342[_0x3d3378(0x262)]('clientip')){const {clientip:_0x9ff8f2}=_0x4e5342;return _0x166936==_0x9ff8f2?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3d3378(0x277)};}else{if(_0x4e5342[_0x3d3378(0x262)](_0x3d3378(0x2d8))&&_0x4e5342[_0x3d3378(0x262)](_0x3d3378(0x296))){const {username:_0x26aecf,clientip:_0x59b2f2}=_0x4e5342;return settings['bbUsername']==_0x26aecf&&_0x166936==_0x59b2f2?{'success':_0x3d3378(0x17c)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x4281ff=>{const _0x27f513=_0x51d13a;if(_0x4281ff){const _0x5959de=devices[_0x4281ff]['ip'];return jwt[_0x27f513(0x31b)]({'username':settings[_0x27f513(0x2b3)],'clientip':_0x5959de},secure[_0x27f513(0x19f)]+_0x4281ff,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x3bdd13=>{const _0x373983=_0x51d13a;if(_0x3bdd13){const _0x3f2815=devices[_0x3bdd13]['ip'];return jwt['sign']({'clientip':_0x3f2815},secure[_0x373983(0x19f)]+_0x3bdd13,{'expiresIn':devices[_0x3bdd13][_0x373983(0x23b)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x2d11a8=>{const _0x3ce070=_0x51d13a;let _0x244045=![];return devices[_0x2d11a8]['telegramIpApproval']&&devices[_0x2d11a8][_0x3ce070(0x23b)][_0x3ce070(0x1d1)]!='reject'&&(_0x244045=devices[_0x2d11a8][_0x3ce070(0x23b)][_0x3ce070(0x296)]==devices[_0x2d11a8]['ip']&&new Date()['getTime']()-devices[_0x2d11a8][_0x3ce070(0x23b)][_0x3ce070(0x2ae)]<devices[_0x2d11a8][_0x3ce070(0x23b)][_0x3ce070(0x1d1)]*0x3c*0x3e8),_0x244045;},telegram2FaApproved=_0x4ec0af=>{const _0x400fe2=_0x51d13a;let _0x3e80eb=![];return devices[_0x4ec0af][_0x400fe2(0x194)]&&devices[_0x4ec0af][_0x400fe2(0x194)]['expiry']!=_0x400fe2(0x2b0)&&(_0x3e80eb=devices[_0x4ec0af][_0x400fe2(0x194)][_0x400fe2(0x296)]==devices[_0x4ec0af]['ip']&&new Date()['getTime']()-devices[_0x4ec0af]['telegram2FaApproval']['timestamp']<devices[_0x4ec0af][_0x400fe2(0x194)][_0x400fe2(0x1d1)]*0x3c*0x3e8),_0x3e80eb;},normalizeIP=_0x27bf3f=>{const _0x5cc898=_0x51d13a;let _0x410b94=null,_0xb71b64=null;if(ipaddr[_0x5cc898(0x268)](_0x27bf3f)){const _0x5cf9d4=ipaddr['parse'](_0x27bf3f);_0x5cf9d4['kind']()===_0x5cc898(0x2e4)?(_0x5cf9d4[_0x5cc898(0x221)]()&&(_0x410b94=_0x5cf9d4['toIPv4Address']()[_0x5cc898(0x1ec)]()),_0xb71b64=_0x5cf9d4['toString']()):(_0x410b94=_0x5cf9d4['toString'](),_0xb71b64=_0x5cf9d4[_0x5cc898(0x15b)]()[_0x5cc898(0x1ec)]());}return{'show':_0x410b94?_0x410b94:_0xb71b64,'store':_0xb71b64};};function _0x5321(_0x1ddad8,_0x3f03d9){const _0x3d393c=_0x242d();return _0x5321=function(_0x53a672,_0x466cd5){_0x53a672=_0x53a672-0x14d;let _0x242de9=_0x3d393c[_0x53a672];return _0x242de9;},_0x5321(_0x1ddad8,_0x3f03d9);}function formatDate(_0x2b908f){const _0x1f8308=_0x51d13a;return _0x2b908f[_0x1f8308(0x1b7)]()+'/'+(_0x2b908f[_0x1f8308(0x225)]()+0x1)[_0x1f8308(0x1ec)]()[_0x1f8308(0x1f1)](0x2,'0')+'/'+_0x2b908f[_0x1f8308(0x156)]()[_0x1f8308(0x1ec)]()['padStart'](0x2,'0')+'\x20'+_0x2b908f[_0x1f8308(0x1ab)]()['toString']()[_0x1f8308(0x1f1)](0x2,'0')+':'+_0x2b908f[_0x1f8308(0x2a7)]()[_0x1f8308(0x1ec)]()[_0x1f8308(0x1f1)](0x2,'0')+':'+_0x2b908f[_0x1f8308(0x2c0)]()['toString']()['padStart'](0x2,'0');}function sleep(_0x3f70ed){return new Promise(_0x3f3a62=>setTimeout(_0x3f3a62,_0x3f70ed));}