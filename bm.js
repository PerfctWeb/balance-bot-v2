const _0x4b0ff4=_0x4eba;(function(_0x1eb83d,_0x469788){const _0x40d7e5=_0x4eba,_0x259a84=_0x1eb83d();while(!![]){try{const _0x13c5fb=parseInt(_0x40d7e5(0x2d1))/0x1+-parseInt(_0x40d7e5(0x2fa))/0x2+-parseInt(_0x40d7e5(0x16d))/0x3+parseInt(_0x40d7e5(0x25a))/0x4*(parseInt(_0x40d7e5(0x331))/0x5)+-parseInt(_0x40d7e5(0x328))/0x6*(-parseInt(_0x40d7e5(0x1b9))/0x7)+-parseInt(_0x40d7e5(0x29a))/0x8+parseInt(_0x40d7e5(0x1ea))/0x9*(parseInt(_0x40d7e5(0x2a6))/0xa);if(_0x13c5fb===_0x469788)break;else _0x259a84['push'](_0x259a84['shift']());}catch(_0x14cf89){_0x259a84['push'](_0x259a84['shift']());}}}(_0x1375,0x21933));const _0x4a00ef=function(){let _0x5bea73=!![];return function(_0x7c673a,_0x524dd7){const _0x1d2ed7=_0x5bea73?function(){const _0x154794=_0x4eba;if(_0x524dd7){const _0x584830=_0x524dd7[_0x154794(0x2a3)](_0x7c673a,arguments);return _0x524dd7=null,_0x584830;}}:function(){};return _0x5bea73=![],_0x1d2ed7;};}(),_0x5187d5=_0x4a00ef(this,function(){const _0x14a2d2=_0x4eba;return _0x5187d5[_0x14a2d2(0x291)]()[_0x14a2d2(0x1cf)](_0x14a2d2(0x265))[_0x14a2d2(0x291)]()[_0x14a2d2(0x263)](_0x5187d5)[_0x14a2d2(0x1cf)](_0x14a2d2(0x265));});_0x5187d5();'use strict';process[_0x4b0ff4(0x312)][_0x4b0ff4(0x1fc)]=0x1;const childProcess=require(_0x4b0ff4(0x164)),fs=require('fs'),fns=require(_0x4b0ff4(0x275)),low=require(_0x4b0ff4(0x20c)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x4b0ff4(0x1e2)),Crypt=require(_0x4b0ff4(0x310))[_0x4b0ff4(0x242)],RSA=require(_0x4b0ff4(0x310))['RSA'],bcrypt=require(_0x4b0ff4(0x23d)),jwt=require(_0x4b0ff4(0x1c7)),ipaddr=require('ipaddr.js'),argv=require(_0x4b0ff4(0x231))(process[_0x4b0ff4(0x2dd)][_0x4b0ff4(0x2c9)](0x2))[_0x4b0ff4(0x2dd)],uuidRandom=require('uuid-random'),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x4b0ff4(0x2ad)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x4b0ff4(0x2e2)),{networkInterfaces}=require('os'),PORT=argv[_0x4b0ff4(0x1e3)]||_0x4b0ff4(0x26d),pattern=/^[0-9]{2,4}$/;!pattern[_0x4b0ff4(0x15c)](PORT)&&(console[_0x4b0ff4(0x2e9)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x4b0ff4(0x21c)),process[_0x4b0ff4(0x257)](0x1));const HOST=argv['host']||null,userID=argv[_0x4b0ff4(0x1be)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x4b0ff4(0x323)];let bbpath=_0x4b0ff4(0x1e0),bbpath2='';const botfile='bot.js',configfile=_0x4b0ff4(0x1de),settingsfile='bb-settings.json',securefile=_0x4b0ff4(0x31c),environment=require('./'+bbpath2+_0x4b0ff4(0x194))[_0x4b0ff4(0x171)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x4b0ff4(0x1a7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4b0ff4(0x2c5)),configpath=userID?bbpath+_0x4b0ff4(0x229)+userID+'/':bbpath+_0x4b0ff4(0x229),configbackuppath=configpath+_0x4b0ff4(0x169),logspath=userID?bbpath+_0x4b0ff4(0x1b7)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x4b0ff4(0x2d0)+userID+'/':bbpath+_0x4b0ff4(0x2d0),loggerfile=fs[_0x4b0ff4(0x2d9)](logspath+_0x4b0ff4(0x21a),{'flags':'a'}),temppath=userID?bbpath+_0x4b0ff4(0x189)+userID+'/':bbpath+_0x4b0ff4(0x189);!fs[_0x4b0ff4(0x1a7)](configpath)&&fs[_0x4b0ff4(0x2ec)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4b0ff4(0x1a7)](logspath)&&fs[_0x4b0ff4(0x2ec)](logspath);!fs[_0x4b0ff4(0x1a7)](zippath)&&fs[_0x4b0ff4(0x2ec)](zippath);function _0x4eba(_0x226998,_0x580a02){const _0x3f047c=_0x1375();return _0x4eba=function(_0x5187d5,_0x4a00ef){_0x5187d5=_0x5187d5-0x15a;let _0x13759b=_0x3f047c[_0x5187d5];return _0x13759b;},_0x4eba(_0x226998,_0x580a02);}!fs[_0x4b0ff4(0x1a7)](temppath)&&fs[_0x4b0ff4(0x2ec)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4b0ff4(0x17b)]({'bots':[]})[_0x4b0ff4(0x309)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4b0ff4(0x17b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4b0ff4(0x185),'onepagemode':![]}})[_0x4b0ff4(0x309)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4b0ff4(0x17b)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x4b0ff4(0x19c),'rsaStandard':_0x4b0ff4(0x213)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4b0ff4(0x22e)](_0x4b0ff4(0x2f8),{'host':_0x4b0ff4(0x17d)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4b0ff4(0x195)]&&settings[_0x4b0ff4(0x195)]!=''&&settings[_0x4b0ff4(0x322)]&&settings[_0x4b0ff4(0x322)]!='')initTelegram();const parseColor=(_0x532e23,_0x44de72)=>{const _0xda8ba5=_0x4b0ff4,_0xb77603=/#[A-Z]{3}#/g;if(typeof _0x532e23==_0xda8ba5(0x28d)){!_0x44de72?_0x532e23=_0x532e23[_0xda8ba5(0x207)](_0xb77603,''):(_0x532e23=_0x532e23[_0xda8ba5(0x207)](/#BLU#/g,_0xda8ba5(0x330)),_0x532e23=_0x532e23[_0xda8ba5(0x207)](/#RED#/g,_0xda8ba5(0x1d6)),_0x532e23=_0x532e23['replace'](/#YEL#/g,_0xda8ba5(0x251)),_0x532e23=_0x532e23['replace'](/#MAG#/g,_0xda8ba5(0x295)),_0x532e23=_0x532e23[_0xda8ba5(0x207)](/#CYA#/g,'\x1b[36m'),_0x532e23=_0x532e23['replace'](/#RES#/g,_0xda8ba5(0x318)));;}return _0x532e23;},logger={'screen':_0x373e67=>{console['log'](parseColor(_0x373e67,!![]));},'simple':_0x1b22ee=>{const _0xcb8ec3=_0x4b0ff4;console[_0xcb8ec3(0x2e9)](parseColor(_0x1b22ee,!![])),loggerfile['write'](util['format'](parseColor(_0x1b22ee,![]))+'\x0a');},'full':async _0x10d053=>{const _0x2bb7d6=_0x4b0ff4,_0x47188e=getTimeStamp()+_0x2bb7d6(0x256)+_0x10d053;console[_0x2bb7d6(0x2e9)](parseColor(_0x47188e,!![])),loggerfile['write'](util[_0x2bb7d6(0x177)](parseColor(_0x47188e,![]))+'\x0a');if(tgBot&&settings[_0x2bb7d6(0x1af)]&&settings[_0x2bb7d6(0x2e3)]!='orders')await tgBot[_0x2bb7d6(0x253)](settings[_0x2bb7d6(0x1af)],_0x2bb7d6(0x15d)+parseColor(_0x10d053,![]))[_0x2bb7d6(0x319)](_0x23503f=>{telegramError(_0x23503f);});},'debug':async(_0x1e4d3b,_0x4a0ef4='')=>{const _0x539c23=_0x4b0ff4,_0x23b6b6=getTimeStamp()+_0x539c23(0x1ad)+_0x1e4d3b;if(debugging)console['log'](parseColor(_0x23b6b6,!![]));loggerfile[_0x539c23(0x309)](util[_0x539c23(0x177)](parseColor(_0x23b6b6,![]))+'\x0a');if(_0x4a0ef4){if(debugging)console[_0x539c23(0x2e9)](_0x4a0ef4);loggerfile[_0x539c23(0x309)](util[_0x539c23(0x177)](_0x4a0ef4)+'\x0a');}}};process['on'](_0x4b0ff4(0x240),function(_0x31c5d1){logger['simple'](_0x31c5d1);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4b0ff4(0x194))[_0x4b0ff4(0x2ac)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4b0ff4(0x2ca)),app=express(),http=require(_0x4b0ff4(0x1c4))[_0x4b0ff4(0x197)](app);app[_0x4b0ff4(0x2db)](fileUpload({'useTempFiles':!![]})),app[_0x4b0ff4(0x244)]('/download/:type',async(_0x555664,_0x51bf82)=>{const _0x56c3dd=_0x4b0ff4,_0x90d4b1=_0x555664[_0x56c3dd(0x2d4)][_0x56c3dd(0x243)],_0x595f82=getClientsWithBotID(_0x56c3dd(0x31f)),_0x1d2a11=_0x555664[_0x56c3dd(0x179)][_0x56c3dd(0x15a)],_0x40c45b=timelyDecrypt(_0x1d2a11,![]),_0x477653=_0x595f82[_0x56c3dd(0x254)](_0x3ab96b=>_0x3ab96b[_0x56c3dd(0x15a)]==_0x40c45b);if(_0x477653){const _0x15d157=normalizeIP(_0x555664['socket'][_0x56c3dd(0x298)])[_0x56c3dd(0x1db)],_0x1d7f7e=_0x555664[_0x56c3dd(0x179)][_0x56c3dd(0x1bf)];if(validateAccess(_0x1d7f7e,_0x40c45b,_0x15d157)['allow'])_0x90d4b1=='backup'&&await backupConfigFiles(),await zipFiles(_0x90d4b1),_0x51bf82[_0x56c3dd(0x1d0)](zippath+(_0x90d4b1+_0x56c3dd(0x2cf)),_0x931c4a=>{const _0x3fa85b=_0x56c3dd;_0x931c4a&&(logger[_0x3fa85b(0x27e)](_0x3fa85b(0x23e)+_0x90d4b1),logger[_0x3fa85b(0x2a0)](_0x931c4a));});else logger[_0x56c3dd(0x27e)](_0x56c3dd(0x270)+_0x90d4b1+_0x56c3dd(0x220));}else logger[_0x56c3dd(0x27e)](_0x56c3dd(0x270)+_0x90d4b1+'\x20(2)');}),app[_0x4b0ff4(0x222)](_0x4b0ff4(0x255),async(_0x2050fc,_0x1857c4)=>{const _0x1735a9=_0x4b0ff4,_0x42d68e=getClientsWithBotID(_0x1735a9(0x31f)),_0x2eabc1=_0x2050fc['headers'][_0x1735a9(0x15a)],_0x583eb3=timelyDecrypt(_0x2eabc1,![]),_0x228f98=_0x42d68e[_0x1735a9(0x254)](_0x324297=>_0x324297[_0x1735a9(0x15a)]==_0x583eb3);logger[_0x1735a9(0x33c)](_0x1735a9(0x1a8));if(_0x228f98){const _0x3f595c=normalizeIP(_0x2050fc[_0x1735a9(0x181)]['remoteAddress'])[_0x1735a9(0x1db)],_0x3b15da=_0x2050fc[_0x1735a9(0x179)][_0x1735a9(0x1bf)];if(validateAccess(_0x3b15da,_0x583eb3,_0x3f595c)[_0x1735a9(0x19e)]){if(_0x2050fc[_0x1735a9(0x2ab)]){const _0x1020e1=_0x2050fc[_0x1735a9(0x2ab)]['backupfile'];await _0x1020e1['mv'](temppath+_0x1020e1[_0x1735a9(0x30c)]),_0x1857c4[_0x1735a9(0x184)]({'status':!![],'message':_0x1735a9(0x187)});const _0xf88545=getBotsWithMode();_0xf88545[_0x1735a9(0x247)]>0x0?confirmRestore(temppath,_0x1020e1[_0x1735a9(0x30c)]):unzipFile(temppath,_0x1020e1['name']);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x1735a9(0x27e)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express['static'](path[_0x4b0ff4(0x2ff)](__dirname,bbpath2,_0x4b0ff4(0x313)))),app[_0x4b0ff4(0x2db)](express[_0x4b0ff4(0x2e5)](path[_0x4b0ff4(0x2ff)](__dirname,bbpath2,_0x4b0ff4(0x25b)))),app[_0x4b0ff4(0x244)]('/',function(_0x2b6a04,_0x35441f){const _0x4ad69a=_0x4b0ff4;_0x35441f[_0x4ad69a(0x18b)](path['join'](__dirname,bbpath2,_0x4ad69a(0x313),_0x4ad69a(0x324)));}),app[_0x4b0ff4(0x244)](_0x4b0ff4(0x2ef),function(_0x457bab,_0x358354){const _0x11fbb8=_0x4b0ff4;_0x358354[_0x11fbb8(0x18b)](path['join'](__dirname,bbpath2,_0x11fbb8(0x25b),_0x11fbb8(0x324)));}),app['get'](_0x4b0ff4(0x1d5),(_0x20574e,_0x2a149e)=>{const _0x25b9f8=_0x4b0ff4;_0x2a149e[_0x25b9f8(0x18b)](path[_0x25b9f8(0x2ff)](__dirname,bbpath2,_0x25b9f8(0x25b),_0x25b9f8(0x324)));}),app['get'](_0x4b0ff4(0x1b6),(_0x3bddb9,_0x7318c7)=>{const _0x5ecbde=_0x4b0ff4;_0x7318c7[_0x5ecbde(0x18b)](path[_0x5ecbde(0x2ff)](__dirname,bbpath2,'build',_0x5ecbde(0x324)));}),app[_0x4b0ff4(0x244)](_0x4b0ff4(0x1c6),(_0x3081ad,_0x1eb3f7)=>{const _0x167484=_0x4b0ff4;_0x1eb3f7[_0x167484(0x18b)](path[_0x167484(0x2ff)](__dirname,bbpath2,_0x167484(0x25b),_0x167484(0x324)));}),app[_0x4b0ff4(0x244)](_0x4b0ff4(0x28e),(_0x39eb63,_0x4c9456)=>{const _0x329626=_0x4b0ff4;_0x4c9456[_0x329626(0x18b)](path[_0x329626(0x2ff)](__dirname,bbpath2,_0x329626(0x25b),_0x329626(0x324)));}),app[_0x4b0ff4(0x244)](_0x4b0ff4(0x224),(_0x3d305c,_0x5ad49d)=>{const _0x46cc3f=_0x4b0ff4;_0x5ad49d[_0x46cc3f(0x18b)](path['join'](__dirname,bbpath2,_0x46cc3f(0x25b),'index.html'));}),app[_0x4b0ff4(0x244)](_0x4b0ff4(0x307),(_0x3a7bd7,_0x5bb032)=>{const _0x359e13=_0x4b0ff4;_0x5bb032['sendFile'](path[_0x359e13(0x2ff)](__dirname,bbpath2,_0x359e13(0x25b),_0x359e13(0x324)));});if(HOST)http[_0x4b0ff4(0x32d)](PORT,HOST);else http[_0x4b0ff4(0x32d)](PORT);const io=require(_0x4b0ff4(0x2f5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4757cc=_0x4b0ff4;let _0x253d1f=_0x4757cc(0x218);const _0x4ba0d9=networkInterfaces(),_0x25a530={};for(const _0x440776 of Object[_0x4757cc(0x20b)](_0x4ba0d9)){for(const _0x25b20f of _0x4ba0d9[_0x440776]){if((_0x25b20f[_0x4757cc(0x193)]==_0x4757cc(0x327)||_0x25b20f['family']==0x4)&&!_0x25b20f[_0x4757cc(0x336)]){const _0x14ddb7=ipaddr['parse'](_0x25b20f[_0x4757cc(0x19d)])[_0x4757cc(0x33f)]();_0x14ddb7!='private'&&(!_0x25a530[_0x440776]&&(_0x25a530[_0x440776]=[]),_0x25a530[_0x440776][_0x4757cc(0x2b0)](_0x25b20f[_0x4757cc(0x19d)]),_0x253d1f=_0x25b20f[_0x4757cc(0x19d)]);}}}return{'serverip':_0x253d1f,'netinterfaces':_0x25a530};}async function startServer(){const _0x57a4ae=_0x4b0ff4,{serverip:_0x144ad7,netinterfaces:_0x234ffa}=getServerIP();logger[_0x57a4ae(0x2a0)](''),logger['simple'](_0x57a4ae(0x1bb)),await logger[_0x57a4ae(0x27e)](_0x57a4ae(0x1bc)+serverversion+_0x57a4ae(0x1e1)+(environment==_0x57a4ae(0x297)?_0x57a4ae(0x19a):'')+'\x0a'+(_0x57a4ae(0x29f)+PORT+_0x57a4ae(0x199))+(_0x57a4ae(0x163)+_0x144ad7+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x57a4ae(0x2a0)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x3a48b7 of config){if(_0x3a48b7[_0x57a4ae(0x2bc)]==_0x57a4ae(0x26f)||_0x3a48b7['status']=='new')await logger[_0x57a4ae(0x27e)](_0x57a4ae(0x1c5)+_0x3a48b7[_0x57a4ae(0x248)]+_0x57a4ae(0x17e)+_0x3a48b7['botname']),startBot([_0x3a48b7['botID'],userID],{'cwd':bbpath},function(_0x4284bf){const _0x285adf=_0x57a4ae;if(_0x4284bf)logger[_0x285adf(0x27e)](_0x4284bf);});else(_0x3a48b7['status']==_0x57a4ae(0x2dc)||_0x3a48b7[_0x57a4ae(0x2bc)]==_0x57a4ae(0x18e))&&await logger[_0x57a4ae(0x27e)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x3a48b7[_0x57a4ae(0x248)]+'\x20|\x20'+_0x3a48b7[_0x57a4ae(0x2b3)]);}else!newBot&&logger[_0x57a4ae(0x2a0)](_0x57a4ae(0x209));if(newBot)addBot();logger[_0x57a4ae(0x2a0)](_0x57a4ae(0x1bb)),logger[_0x57a4ae(0x2a0)](''),await logger[_0x57a4ae(0x33c)](_0x57a4ae(0x333)+nodeversion),await logger[_0x57a4ae(0x33c)](_0x57a4ae(0x258),_0x234ffa);}function startSocket(){const _0x1e9db3=_0x4b0ff4;io['on'](_0x1e9db3(0x2e4),_0x180626=>{const _0x2da59c=_0x1e9db3;let _0x58f7b5,_0x4e5b35,_0xb9707f,_0x24deee,_0x14ec8b;const _0x1baa42=_0x180626[_0x2da59c(0x314)]['headers'][_0x2da59c(0x22a)];_0x4e5b35=_0x1baa42['match'](/bot[0-9]{3}/);if(_0x4e5b35)_0xb9707f=_0x4e5b35[0x0][_0x2da59c(0x1d8)](/[0-9]{3}/);if(_0xb9707f)_0x58f7b5=_0xb9707f[0x0];else _0x58f7b5=_0x2da59c(0x31f);const _0x594ee2=_0x180626[_0x2da59c(0x314)]['auth']['encryptedUuid'];if(!_0x594ee2)_0x180626['emit'](_0x2da59c(0x2bc),{'publicKey':secure['publicKey']});else{_0x24deee=timelyDecrypt(_0x594ee2,![]);if(!_0x24deee)_0x180626[_0x2da59c(0x1f2)](_0x2da59c(0x2bc),{'publicKey':secure[_0x2da59c(0x16b)]});else{_0x14ec8b=normalizeIP(_0x180626['conn']['remoteAddress'])['store'];if(!devices[_0x24deee])devices[_0x24deee]={'uuid':_0x24deee,'access':{'token':null}};devices[_0x24deee]['ip']=_0x14ec8b;const _0x3a155e=addClient(_0x180626['id'],_0x24deee,_0x58f7b5);setAccess(_0x3a155e),emitMessages(),_0x180626['on'](_0x2da59c(0x345),_0x1d9b3f=>{const _0x4115e9=_0x2da59c,_0x5d9e8a=timelyDecrypt(_0x1d9b3f[_0x4115e9(0x2bf)]);if(_0x5d9e8a){_0x1d9b3f={'username':_0x1d9b3f[_0x4115e9(0x2df)],'password':_0x5d9e8a},devices[_0x24deee][_0x4115e9(0x245)]=validateCredentials(_0x1d9b3f,_0x24deee);if(devices[_0x24deee]['access']['allow']==![]&&devices[_0x24deee]['access'][_0x4115e9(0x293)]==_0x4115e9(0x27b))_0x180626[_0x4115e9(0x1f2)]('status',{'access':devices[_0x24deee]['access']}),loginAccess2FA(_0x24deee,_0x14ec8b);else{if(devices[_0x24deee][_0x4115e9(0x245)][_0x4115e9(0x19e)]==![]&&devices[_0x24deee][_0x4115e9(0x245)][_0x4115e9(0x293)]=='invalid\x20credentials')_0x180626['emit'](_0x4115e9(0x2bc),{'access':devices[_0x24deee]['access']});else devices[_0x24deee][_0x4115e9(0x245)][_0x4115e9(0x19e)]&&devices[_0x24deee][_0x4115e9(0x245)][_0x4115e9(0x293)]==_0x4115e9(0x264)&&(getClientsWithUuid(_0x24deee)[_0x4115e9(0x305)](_0x17e641=>{setAccess(_0x17e641);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x24deee['slice'](-0x8)),setTokenRefresh(_0x24deee),setSessionTimeout(_0x4115e9(0x345),_0x24deee));}}else logger[_0x4115e9(0x27e)](_0x4115e9(0x302));}),_0x180626['on']('reset-password',()=>{resetPassword();}),_0x180626['on'](_0x2da59c(0x20a),_0x51e525=>{removeClient(_0x180626['id']);}),_0x58f7b5==_0x2da59c(0x31f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5a1df8){const _0x251ae6=_0x4b0ff4;if(_0x5a1df8!=_0x251ae6(0x31f)&&config[_0x251ae6(0x214)]!=''){if(pid[_0x5a1df8])pid[_0x5a1df8]['send']({'function':_0x251ae6(0x1e9),'args':null});}_0x5a1df8!=_0x251ae6(0x31f)&&broadcastToBots(_0x251ae6(0x22c),JSON['stringify'](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x3bafec=>{const _0x4a4d15=_0x4eba;getSocket(_0x3bafec['id'])[_0x4a4d15(0x1f2)](_0x4a4d15(0x2bc),{'access':{'allow':![],'reason':_0x4a4d15(0x175),'token':null}});});}function getSocket(_0x27ca11){const _0x1873b3=_0x4b0ff4;return io[_0x1873b3(0x342)][_0x1873b3(0x342)][_0x1873b3(0x244)](_0x27ca11);}function setAccess(_0x1a50a1){const _0x4cb3c2=_0x4b0ff4,_0x208ed7=getSocket(_0x1a50a1['id']),_0x4a0ac6=_0x1a50a1[_0x4cb3c2(0x15a)],_0x312f21=_0x1a50a1[_0x4cb3c2(0x2a9)];devices[_0x4a0ac6][_0x4cb3c2(0x245)]=validateAccess(devices[_0x4a0ac6][_0x4cb3c2(0x245)]['token'],_0x4a0ac6),logger[_0x4cb3c2(0x33c)]('Setting\x20access:\x20'+devices[_0x4a0ac6]['access']['reason']+_0x4cb3c2(0x238)+_0x1a50a1['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x4a0ac6[_0x4cb3c2(0x2c9)](-0x8)),_0x208ed7[_0x4cb3c2(0x2ff)](_0x4a0ac6);if(devices[_0x4a0ac6][_0x4cb3c2(0x245)][_0x4cb3c2(0x19e)]){_0x208ed7['join'](_0x312f21);if(_0x312f21==_0x4cb3c2(0x31f))initializeSocketBotManager(_0x208ed7);else initializeSocketBot(_0x208ed7);initClient(_0x312f21);}devices[_0x4a0ac6][_0x4cb3c2(0x245)][_0x4cb3c2(0x1d3)]&&devices[_0x4a0ac6][_0x4cb3c2(0x245)]['reason']==_0x4cb3c2(0x1cb)&&setSessionTimeout(_0x4cb3c2(0x18a),_0x4a0ac6),devices[_0x4a0ac6][_0x4cb3c2(0x245)][_0x4cb3c2(0x1d3)]&&devices[_0x4a0ac6][_0x4cb3c2(0x245)]['reason']==_0x4cb3c2(0x2b5)&&setSessionTimeout('login',_0x4a0ac6),_0x208ed7[_0x4cb3c2(0x1f2)](_0x4cb3c2(0x2bc),{'status':_0x1a50a1[_0x4cb3c2(0x31d)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4a0ac6][_0x4cb3c2(0x245)],'externalip':devices[_0x4a0ac6]['ip'],'publicKey':secure[_0x4cb3c2(0x16b)],'userid':settings[_0x4cb3c2(0x2c1)],'validInstallation':validInstallation}),devices[_0x4a0ac6][_0x4cb3c2(0x245)][_0x4cb3c2(0x19e)]==![]&&devices[_0x4a0ac6][_0x4cb3c2(0x245)][_0x4cb3c2(0x293)]=='2FA\x20required'&&temporaryAccess2FA(_0x4a0ac6,devices[_0x4a0ac6]['ip']);}function setSessionTimeout(_0x2b959a,_0x53b87b){const _0x441893=_0x4b0ff4;let _0xe78909;if(_0x2b959a==_0x441893(0x345))_0xe78909=loginExpiry*0x3c*0x3e8;else _0xe78909=devices[_0x53b87b][_0x441893(0x1a2)][_0x441893(0x17a)]*0x3c*0x3e8-(new Date()[_0x441893(0x306)]()-devices[_0x53b87b][_0x441893(0x1a2)][_0x441893(0x1da)]);if(devices[_0x53b87b]['pidExpireLogin'])clearTimeout(devices[_0x53b87b][_0x441893(0x2b9)]);devices[_0x53b87b][_0x441893(0x2b9)]=setTimeout(()=>{const _0x785751=_0x441893;if(devices[_0x53b87b][_0x785751(0x2fd)])clearTimeout(devices[_0x53b87b][_0x785751(0x2fd)]);removeSocketListeners(_0x53b87b),addBlacklist(_0x53b87b),devices[_0x53b87b]['telegramIpApproval']=null,devices[_0x53b87b]['telegram2FaApproval']=null,devices[_0x53b87b]['access'][_0x785751(0x1d3)]=null,logger['debug'](_0x785751(0x2f4)+_0x53b87b[_0x785751(0x2c9)](-0x8)),devices[_0x53b87b][_0x785751(0x245)]=validateAccess(devices[_0x53b87b][_0x785751(0x245)][_0x785751(0x1d3)],_0x53b87b),!(devices[_0x53b87b][_0x785751(0x245)]['allow']&&devices[_0x53b87b][_0x785751(0x245)][_0x785751(0x293)]==_0x785751(0x1ef))&&(_0x2b959a==_0x785751(0x345)?io['to'](_0x53b87b)[_0x785751(0x1f2)](_0x785751(0x2bc),{'access':{'allow':![],'reason':_0x785751(0x15e),'token':null}}):io['to'](_0x53b87b)[_0x785751(0x1f2)](_0x785751(0x2bc),{'access':{'allow':![],'reason':_0x785751(0x227),'token':null}})),devices[_0x53b87b]['access'][_0x785751(0x1d3)]=null;},_0xe78909);}function setTokenRefresh(_0x2d5829){const _0x164929=_0x4b0ff4;if(devices[_0x2d5829][_0x164929(0x2fd)])clearTimeout(devices[_0x2d5829]['pidRefreshToken']);devices[_0x2d5829]['pidRefreshToken']=setTimeout(()=>{const _0x348173=_0x164929;getClientsWithUuid(_0x2d5829)[_0x348173(0x247)]!=0x0?(devices[_0x2d5829][_0x348173(0x245)]=refreshToken(_0x2d5829),io['to'](_0x2d5829)[_0x348173(0x1f2)]('status',{'status':_0x348173(0x279),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2d5829][_0x348173(0x245)],'externalip':devices[_0x2d5829]['ip'],'publicKey':secure[_0x348173(0x16b)],'validInstallation':validInstallation}),setTokenRefresh(_0x2d5829)):clearTimeout(devices[_0x2d5829][_0x348173(0x2fd)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4df355){const _0x3f182d=_0x4b0ff4,_0x4d191a=getClient(_0x4df355['id'])['uuid'];_0x4df355['emit'](_0x3f182d(0x22c),config),_0x4df355[_0x3f182d(0x1f2)]('settings',cleanSettings()),_0x4df355['on'](_0x3f182d(0x24d),_0x25f034=>{const _0xa74be3=_0x3f182d;if(validateAccess(_0x25f034,_0x4d191a)[_0xa74be3(0x19e)])addBot();else logger[_0xa74be3(0x27e)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4df355['on']('update-bot',(_0x399b1e,_0x17e737)=>{const _0x29dfbf=_0x3f182d;if(validateAccess(_0x17e737,_0x4d191a)[_0x29dfbf(0x19e)])toggleBot(_0x399b1e[_0x29dfbf(0x248)],_0x399b1e['status'],_0x399b1e[_0x29dfbf(0x1f7)]);else logger[_0x29dfbf(0x27e)](_0x29dfbf(0x2a5));}),_0x4df355['on']('toggle-bot-mode',(_0xbc8588,_0x10abd0)=>{const _0x5ae151=_0x3f182d;if(validateAccess(_0x10abd0,_0x4d191a)[_0x5ae151(0x19e)])toggleBotMode(_0xbc8588);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4df355['on'](_0x3f182d(0x246),(_0x1a1c87,_0x58a86d)=>{const _0x31245b=_0x3f182d;if(validateAccess(_0x58a86d,_0x4d191a)['allow'])deleteBot(_0x1a1c87);else logger[_0x31245b(0x27e)](_0x31245b(0x281));}),_0x4df355['on']('store-settings',(_0x203983,_0x3bbac3)=>{const _0x299a65=_0x3f182d;if(validateAccess(_0x3bbac3,_0x4d191a)[_0x299a65(0x19e)])storeSettings(_0x203983,!![]);else logger[_0x299a65(0x27e)](_0x299a65(0x1c8));}),_0x4df355['on'](_0x3f182d(0x28a),_0x3491d0=>{const _0xddcc1e=_0x3f182d;if(validateAccess(_0x3491d0,_0x4d191a)[_0xddcc1e(0x19e)])updateBB(_0xddcc1e(0x30a));else logger[_0xddcc1e(0x27e)](_0xddcc1e(0x290));}),_0x4df355['on'](_0x3f182d(0x1b1),_0x43ff37=>{const _0x2c464e=_0x3f182d;if(validateAccess(_0x43ff37,_0x4d191a)[_0x2c464e(0x19e)])updateBB(_0x2c464e(0x321));else logger[_0x2c464e(0x27e)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4df355['on'](_0x3f182d(0x20f),_0x174265=>{const _0x1669a8=_0x3f182d;if(validateAccess(_0x174265,_0x4d191a)[_0x1669a8(0x19e)]){const _0x4e59a3=getClient(_0x4df355['id']);if(_0x4e59a3)getBackupFiles(_0x4e59a3['uuid']);else logger[_0x1669a8(0x27e)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x1669a8(0x27e)](_0x1669a8(0x1e5));}),_0x4df355['on'](_0x3f182d(0x2d3),(_0x5b5bb6,_0x4ca8b3)=>{const _0x4e812d=_0x3f182d;if(validateAccess(_0x4ca8b3,_0x4d191a)[_0x4e812d(0x19e)])restoreBackupFile(_0x5b5bb6);else logger[_0x4e812d(0x27e)](_0x4e812d(0x284));}),_0x4df355['on'](_0x3f182d(0x308),_0x6a8d3a=>{const _0x18afab=_0x3f182d;if(validateAccess(_0x6a8d3a,_0x4d191a)[_0x18afab(0x19e)])getMessages();else logger[_0x18afab(0x27e)](_0x18afab(0x2d7));}),_0x4df355['on']('confirm-message',(_0x422f0c,_0x48b9ed)=>{const _0x26c864=_0x3f182d;if(validateAccess(_0x48b9ed,_0x4d191a)[_0x26c864(0x19e)])confirmMessage(_0x422f0c);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4df355['on'](_0x3f182d(0x1dd),_0x3c8c4a=>{const _0x429776=_0x3f182d;if(validateAccess(_0x3c8c4a,_0x4d191a)[_0x429776(0x19e)]){if(devices[_0x4d191a][_0x429776(0x2fd)])clearTimeout(devices[_0x4d191a]['pidRefreshToken']);if(devices[_0x4d191a][_0x429776(0x2b9)])clearTimeout(devices[_0x4d191a][_0x429776(0x2b9)]);removeSocketListeners(getClient(_0x4df355['id'])[_0x429776(0x15a)]),addBlacklist(_0x4d191a),devices[_0x4d191a][_0x429776(0x1a2)]=null,devices[_0x4d191a][_0x429776(0x22f)]=null,devices[_0x4d191a][_0x429776(0x245)][_0x429776(0x1d3)]=null,logger[_0x429776(0x33c)]('Logged\x20out\x20user\x20...'+_0x4d191a[_0x429776(0x2c9)](-0x8)),io['to'](getClient(_0x4df355['id'])[_0x429776(0x15a)])[_0x429776(0x1f2)](_0x429776(0x2bc),{'access':{'allow':![],'reason':_0x429776(0x230),'token':null}});}else logger['full'](_0x429776(0x1f9));});}function initializeSocketBot(_0x34d38c){const _0x4f4523=_0x4b0ff4,_0x1af8fe=getClient(_0x34d38c['id'])[_0x4f4523(0x2a9)],_0x526420=getClient(_0x34d38c['id'])['uuid'];_0x34d38c['on']('get-logs',(_0x38e8dc,_0x2f5971)=>{const _0x2316f6=_0x4f4523;if(validateAccess(_0x2f5971,_0x526420)[_0x2316f6(0x19e)]){if(pid[_0x1af8fe])pid[_0x1af8fe][_0x2316f6(0x184)]({'function':_0x2316f6(0x1d1),'args':_0x38e8dc});}else logger['full'](_0x2316f6(0x2c0));}),_0x34d38c['on'](_0x4f4523(0x30d),(_0x1bf827,_0x554787)=>{const _0xae83ef=_0x4f4523;if(validateAccess(_0x554787,_0x526420)[_0xae83ef(0x19e)]){if(pid[_0x1af8fe])pid[_0x1af8fe]['send']({'function':_0xae83ef(0x2d2),'args':_0x1bf827});}else logger[_0xae83ef(0x27e)](_0xae83ef(0x2bd));}),_0x34d38c['on'](_0x4f4523(0x1ec),(_0x4aa0a0,_0x18c391)=>{const _0x39aa19=_0x4f4523;if(validateAccess(_0x18c391,_0x526420)[_0x39aa19(0x19e)]){if(pid[_0x1af8fe])pid[_0x1af8fe][_0x39aa19(0x184)]({'function':_0x39aa19(0x21f),'args':_0x4aa0a0});}else logger['full'](_0x39aa19(0x20d));}),_0x34d38c['on'](_0x4f4523(0x277),(_0x2923aa,_0x5244f9)=>{const _0x116783=_0x4f4523;if(validateAccess(_0x5244f9,_0x526420)['allow']){if(pid[_0x1af8fe])pid[_0x1af8fe][_0x116783(0x184)]({'function':'storeConfiguration','args':_0x2923aa});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x34d38c['on'](_0x4f4523(0x2e1),(_0x36ea33,_0x1430ee)=>{const _0xc51e3e=_0x4f4523;if(validateAccess(_0x1430ee,_0x526420)[_0xc51e3e(0x19e)]){if(pid[_0x1af8fe])pid[_0x1af8fe][_0xc51e3e(0x184)]({'function':_0xc51e3e(0x1cd),'args':_0x36ea33});}else logger[_0xc51e3e(0x27e)](_0xc51e3e(0x268));}),_0x34d38c['on'](_0x4f4523(0x32e),(_0x2d75b0,_0x45085a)=>{const _0x21f58e=_0x4f4523;if(validateAccess(_0x45085a,_0x526420)[_0x21f58e(0x19e)]){if(pid[_0x1af8fe])pid[_0x1af8fe]['send']({'function':_0x21f58e(0x2e7),'args':_0x2d75b0});}else logger['full'](_0x21f58e(0x339));}),_0x34d38c['on'](_0x4f4523(0x2f0),_0x2b5fd6=>{const _0x4993e9=_0x4f4523;if(validateAccess(_0x2b5fd6,_0x526420)['allow']){if(pid[_0x1af8fe])pid[_0x1af8fe][_0x4993e9(0x184)]({'function':_0x4993e9(0x2c7),'args':null});}else logger['full'](_0x4993e9(0x1ce));}),_0x34d38c['on'](_0x4f4523(0x182),_0x3d891b=>{const _0x10f16d=_0x4f4523;if(validateAccess(_0x3d891b,_0x526420)['allow']){if(pid[_0x1af8fe])pid[_0x1af8fe]['send']({'function':'getStartingBalances','args':null});}else logger[_0x10f16d(0x27e)](_0x10f16d(0x329));}),_0x34d38c['on'](_0x4f4523(0x2b8),(_0x5534ea,_0x4fd383)=>{const _0x2605ce=_0x4f4523;if(validateAccess(_0x4fd383,_0x526420)[_0x2605ce(0x19e)]){if(pid[_0x1af8fe])pid[_0x1af8fe]['send']({'function':_0x2605ce(0x2c2),'args':_0x5534ea});}else logger[_0x2605ce(0x27e)](_0x2605ce(0x271));}),_0x34d38c['on'](_0x4f4523(0x215),_0x4467fe=>{const _0x1bda05=_0x4f4523;if(validateAccess(_0x4467fe,_0x526420)['allow']){if(pid[_0x1af8fe])pid[_0x1af8fe][_0x1bda05(0x184)]({'function':_0x1bda05(0x27f),'args':null});}else logger[_0x1bda05(0x27e)](_0x1bda05(0x301));}),_0x34d38c['on'](_0x4f4523(0x25c),_0x7b8a8c=>{const _0x4ee4d3=_0x4f4523;if(validateAccess(_0x7b8a8c,_0x526420)['allow']){if(pid[_0x1af8fe])pid[_0x1af8fe][_0x4ee4d3(0x184)]({'function':'showConfig','args':null});}else logger['full'](_0x4ee4d3(0x31e));}),_0x34d38c['on'](_0x4f4523(0x28a),_0x3ec624=>{const _0x2dc2d1=_0x4f4523;if(validateAccess(_0x3ec624,_0x526420)[_0x2dc2d1(0x19e)])updateBB('update');else logger['full'](_0x2dc2d1(0x290));}),_0x34d38c['on']('get-messages',_0x5b7dc5=>{const _0x28c37e=_0x4f4523;if(validateAccess(_0x5b7dc5,_0x526420)['allow'])getMessages();else logger[_0x28c37e(0x27e)](_0x28c37e(0x2d7));}),_0x34d38c['on'](_0x4f4523(0x2ea),(_0x52973f,_0x534666)=>{const _0x5be50a=_0x4f4523;if(validateAccess(_0x534666,_0x526420)[_0x5be50a(0x19e)])confirmMessage(_0x52973f);else logger[_0x5be50a(0x27e)](_0x5be50a(0x19f));}),_0x34d38c['on'](_0x4f4523(0x1dd),_0x4efd03=>{const _0xaccc08=_0x4f4523;if(validateAccess(_0x4efd03,_0x526420)['allow']){if(devices[_0x526420]['pidRefreshToken'])clearTimeout(devices[_0x526420]['pidRefreshToken']);if(devices[_0x526420][_0xaccc08(0x2b9)])clearTimeout(devices[_0x526420]['pidExpireLogin']);removeSocketListeners(getClient(_0x34d38c['id'])['uuid']),addBlacklist(_0x526420),devices[_0x526420][_0xaccc08(0x1a2)]=null,devices[_0x526420][_0xaccc08(0x22f)]=null,devices[_0x526420][_0xaccc08(0x245)][_0xaccc08(0x1d3)]=null,logger[_0xaccc08(0x33c)](_0xaccc08(0x29c)+_0x526420['slice'](-0x8)),io['to'](getClient(_0x34d38c['id'])[_0xaccc08(0x15a)])[_0xaccc08(0x1f2)]('status',{'access':{'allow':![],'reason':_0xaccc08(0x230),'token':null}});}else logger['full'](_0xaccc08(0x1f9));});}function removeSocketListeners(_0x58e1e1){const _0x2560f3=_0x4b0ff4;getClientsWithUuid(_0x58e1e1)[_0x2560f3(0x305)](_0x2a8084=>{const _0x377433=_0x2560f3;getSocket(_0x2a8084['id'])[_0x377433(0x160)]();});}function cleanSettings(){const _0x2ee5a2=_0x4b0ff4;let _0x51809b=settings;return settings['telegramToken']&&settings[_0x2ee5a2(0x195)]!=''&&(_0x51809b={..._0x51809b,'telegramToken':_0x2ee5a2(0x2de)}),settings[_0x2ee5a2(0x1ee)]&&settings[_0x2ee5a2(0x1ee)]!=''&&(_0x51809b={..._0x51809b,'bbPassword':_0x2ee5a2(0x2de)}),(settings[_0x2ee5a2(0x1ee)]&&settings[_0x2ee5a2(0x1ee)]=='***'||settings[_0x2ee5a2(0x195)]&&settings[_0x2ee5a2(0x195)]==_0x2ee5a2(0x162))&&(_0x51809b={..._0x51809b,'restored':{'password':settings[_0x2ee5a2(0x1ee)]==_0x2ee5a2(0x162),'telegram':settings[_0x2ee5a2(0x195)]==_0x2ee5a2(0x162)}}),_0x51809b;}async function updateBB(_0x181cde){const _0x4af768=_0x4b0ff4;await backupConfigFiles(),installingUpdate=!![],config[_0x4af768(0x305)](_0xf3065c=>{restartBot(_0xf3065c['botID']);});if(_0x181cde==_0x4af768(0x30a))process[_0x4af768(0x184)]({'update':!![],'environment':environment},_0x4696a4=>{});else _0x181cde==_0x4af768(0x321)&&process[_0x4af768(0x184)]({'reinstall':!![],'environment':environment},_0x500e0f=>{});}function startBot(_0x9475d3,_0x519f65,_0x173732){const _0x4ab7f8=_0x4b0ff4;if(debugging)_0x9475d3[_0x4ab7f8(0x2b0)]('-d');let _0x3cdb53=![];const _0x2b3424=_0x9475d3[0x0];_0x519f65={..._0x519f65,'stdio':['inherit','inherit',_0x4ab7f8(0x203),_0x4ab7f8(0x188)]},pid[_0x2b3424]=childProcess[_0x4ab7f8(0x32a)](botfile,_0x9475d3,_0x519f65),pid[_0x2b3424]['on']('message',_0x31c29b=>{const _0x5048fb=_0x4ab7f8;switch(Object[_0x5048fb(0x20b)](_0x31c29b)[0x0]){case _0x5048fb(0x2b3):updateBotName(_0x2b3424,_0x31c29b['botname']);break;case _0x5048fb(0x28c):updateBotManager();break;case _0x5048fb(0x2bc):updateStatus(_0x2b3424,_0x31c29b[_0x5048fb(0x2bc)]);break;case _0x5048fb(0x1f7):updateLive(_0x2b3424,_0x31c29b[_0x5048fb(0x1f7)]);break;case _0x5048fb(0x23a):updateLive(_0x2b3424,_0x31c29b[_0x5048fb(0x23a)]),io['to'](_0x2b3424)[_0x5048fb(0x1f2)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x31c29b[_0x5048fb(0x2b2)]==_0x5048fb(0x217)&&restartBot(_0x2b3424);_0x31c29b[_0x5048fb(0x2b2)]==_0x5048fb(0x1f4)&&toggleBot(_0x2b3424,_0x5048fb(0x2dc),_0x5048fb(0x1b3));break;case'telegram':sendTelegram(_0x2b3424,_0x31c29b[_0x5048fb(0x273)]);break;case _0x5048fb(0x269):sendTelegramMsg(_0x31c29b[_0x5048fb(0x269)]);break;case _0x5048fb(0x206):io['to'](_0x2b3424)[_0x5048fb(0x1f2)](_0x31c29b[_0x5048fb(0x206)],_0x31c29b[_0x5048fb(0x16f)]);break;}}),pid[_0x2b3424]['on'](_0x4ab7f8(0x304),function(_0xc97982){if(_0x3cdb53)return;_0x3cdb53=!![],_0x173732(_0xc97982);}),pid[_0x2b3424]['on'](_0x4ab7f8(0x257),async function(_0x442bcb){const _0x47ed09=_0x4ab7f8;if(installingUpdate)return;if(_0x3cdb53)return;_0x3cdb53=!![],_0x173732(null);const _0x3eb3d5=dbConfig['get'](_0x47ed09(0x22c))[_0x47ed09(0x254)]({'botID':_0x2b3424})['value']();_0x3eb3d5&&(_0x3eb3d5[_0x47ed09(0x2bc)]==_0x47ed09(0x26f)||_0x3eb3d5[_0x47ed09(0x2bc)]==_0x47ed09(0x326))&&(await sleep(0x3e8),updateLive(_0x2b3424,'stopped'),logger[_0x47ed09(0x27e)](_0x47ed09(0x261)+_0x2b3424),startBot([_0x2b3424,userID],{'cwd':bbpath},function(_0x53c2f4){if(_0x53c2f4)logger['full'](_0x53c2f4);}));});}function stopBot(_0x114f82){const _0x10c201=_0x4b0ff4;getClientsWithBotID(_0x114f82)['forEach'](_0xe9f244=>{const _0x3f0f66=_0x4eba;getSocket(_0xe9f244['id'])[_0x3f0f66(0x20a)](!![]),removeClient(_0xe9f244['id']);}),pid[_0x114f82]&&(pid[_0x114f82][_0x10c201(0x1f4)](),pid[_0x114f82]=null);}function restartBot(_0x3cb686){const _0x1e9773=_0x4b0ff4;if(pid[_0x3cb686])pid[_0x3cb686][_0x1e9773(0x1f4)]();}function addBot(){const _0x1926b5=_0x4b0ff4;let _0x19da3;for(let _0x23c4e8=0x1;_0x23c4e8<0x3e9;_0x23c4e8++){_0x19da3=_0x23c4e8[_0x1926b5(0x291)]()[_0x1926b5(0x23f)](0x3,'0');let _0x3014f2=config['find'](_0x208f57=>_0x208f57[_0x1926b5(0x248)]==_0x19da3);if(!_0x3014f2)break;}if(_0x19da3==='1000'){logger[_0x1926b5(0x27e)](_0x1926b5(0x2b6));return;}logger['full'](_0x1926b5(0x2eb)+_0x19da3),dbConfig[_0x1926b5(0x244)](_0x1926b5(0x22c))[_0x1926b5(0x2b0)]({'botID':_0x19da3,'botname':'Bot\x20'+_0x19da3,'status':'new','live':''})['write'](),startBot([_0x19da3,userID],{'cwd':bbpath},function(_0x362059){if(_0x362059)logger['full'](_0x362059);}),config=getConfiguration(),io['to'](_0x1926b5(0x31f))[_0x1926b5(0x1f2)](_0x1926b5(0x22c),config),broadcastToBots(_0x1926b5(0x22c),JSON[_0x1926b5(0x260)](config));}function deleteBot(_0x115ef6){const _0x24a7d2=_0x4b0ff4;getClientsWithBotID(_0x115ef6)[_0x24a7d2(0x305)](_0x1e9c37=>{const _0x1dc6ff=_0x24a7d2;getSocket(_0x1e9c37['id'])[_0x1dc6ff(0x20a)](!![]),removeClient(_0x1e9c37['id']);}),dbConfig[_0x24a7d2(0x244)](_0x24a7d2(0x22c))[_0x24a7d2(0x1c9)]({'botID':_0x115ef6})[_0x24a7d2(0x309)](),logger['full'](_0x24a7d2(0x241)+_0x115ef6),stopBot(_0x115ef6);try{if(fs['existsSync'](path['join'](configpath,_0x24a7d2(0x21b)+_0x115ef6+_0x24a7d2(0x200))))fs['unlinkSync'](path[_0x24a7d2(0x2ff)](configpath,'bot-'+_0x115ef6+'-config.json'));if(fs[_0x24a7d2(0x1a7)](path[_0x24a7d2(0x2ff)](configpath,_0x24a7d2(0x21b)+_0x115ef6+_0x24a7d2(0x24c))))fs['unlinkSync'](path['join'](configpath,_0x24a7d2(0x21b)+_0x115ef6+_0x24a7d2(0x24c)));if(fs[_0x24a7d2(0x1a7)](path['join'](configpath,_0x24a7d2(0x21b)+_0x115ef6+_0x24a7d2(0x315))))fs['unlinkSync'](path[_0x24a7d2(0x2ff)](configpath,_0x24a7d2(0x21b)+_0x115ef6+_0x24a7d2(0x315)));if(fs[_0x24a7d2(0x1a7)](path[_0x24a7d2(0x2ff)](configpath,_0x24a7d2(0x21b)+_0x115ef6+'-results.json')))fs[_0x24a7d2(0x18d)](path[_0x24a7d2(0x2ff)](configpath,_0x24a7d2(0x21b)+_0x115ef6+_0x24a7d2(0x266)));}catch(_0x1d7f03){if(_0x1d7f03)logger[_0x24a7d2(0x27e)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x1d7f03);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x24a7d2(0x22c),config),broadcastToBots(_0x24a7d2(0x22c),JSON[_0x24a7d2(0x260)](config));}function toggleBot(_0x3d4777,_0x126649,_0x1feb56){const _0x319a3e=_0x4b0ff4;dbConfig['get'](_0x319a3e(0x22c))[_0x319a3e(0x254)]({'botID':_0x3d4777})['assign']({'status':_0x126649})[_0x319a3e(0x33e)]({'live':_0x1feb56})[_0x319a3e(0x309)]();if(_0x126649=='enabled'||_0x126649==_0x319a3e(0x326))logger[_0x319a3e(0x27e)]('Enabled\x20Bot\x20'+_0x3d4777),startBot([_0x3d4777,userID],{'cwd':bbpath},function(_0x5435d8){const _0x2ad0b7=_0x319a3e;if(_0x5435d8)logger[_0x2ad0b7(0x27e)](_0x5435d8);});else(_0x126649==_0x319a3e(0x2dc)||_0x126649==_0x319a3e(0x18e))&&(logger[_0x319a3e(0x27e)]('Disabled\x20Bot\x20'+_0x3d4777),stopBot(_0x3d4777));config=getConfiguration(),io['to'](_0x319a3e(0x31f))[_0x319a3e(0x1f2)](_0x319a3e(0x22c),config),broadcastToBots(_0x319a3e(0x22c),JSON[_0x319a3e(0x260)](config));}function toggleStatus(_0x58e723){const _0x1b8c27=_0x4b0ff4;let _0x409f42=dbConfig['get'](_0x1b8c27(0x22c))[_0x1b8c27(0x254)]({'botID':_0x58e723})[_0x1b8c27(0x172)](),_0x148c9a;if(_0x409f42[_0x1b8c27(0x2bc)]===_0x1b8c27(0x26f))_0x148c9a='disabled';else{if(_0x409f42[_0x1b8c27(0x2bc)]===_0x1b8c27(0x326))_0x148c9a=_0x1b8c27(0x18e);else{if(_0x409f42[_0x1b8c27(0x2bc)]===_0x1b8c27(0x18e))_0x148c9a=_0x1b8c27(0x326);else{if(_0x409f42['status']===_0x1b8c27(0x2dc))_0x148c9a=_0x1b8c27(0x26f);}}}return _0x148c9a;}function updateStatus(_0x12c2ab,_0x467ff1){const _0x26d80=_0x4b0ff4;dbConfig[_0x26d80(0x244)](_0x26d80(0x22c))[_0x26d80(0x254)]({'botID':_0x12c2ab})[_0x26d80(0x33e)]({'status':_0x467ff1})[_0x26d80(0x309)](),config=getConfiguration(),io['to'](_0x26d80(0x31f))['emit'](_0x26d80(0x22c),config),broadcastToBots(_0x26d80(0x22c),JSON[_0x26d80(0x260)](config));}function updateLive(_0x561c64,_0x431a3a){const _0x4c771f=_0x4b0ff4;dbConfig['get']('bots')[_0x4c771f(0x254)]({'botID':_0x561c64})[_0x4c771f(0x33e)]({'live':_0x431a3a})[_0x4c771f(0x309)](),config=getConfiguration(),io['to'](_0x4c771f(0x31f))['emit'](_0x4c771f(0x22c),config),broadcastToBots(_0x4c771f(0x22c),JSON[_0x4c771f(0x260)](config));}function updateBotName(_0x34f174,_0x120484){const _0x2bd9de=_0x4b0ff4;dbConfig[_0x2bd9de(0x244)](_0x2bd9de(0x22c))[_0x2bd9de(0x254)]({'botID':_0x34f174})[_0x2bd9de(0x33e)]({'botname':_0x120484})[_0x2bd9de(0x309)](),config=getConfiguration(),io['to'](_0x2bd9de(0x31f))[_0x2bd9de(0x1f2)](_0x2bd9de(0x22c),config),broadcastToBots(_0x2bd9de(0x22c),JSON[_0x2bd9de(0x260)](config));}function updateBotManager(){const _0x389a97=_0x4b0ff4;config=getConfiguration(),io['to'](_0x389a97(0x31f))[_0x389a97(0x1f2)](_0x389a97(0x22c),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x485680){const _0x3f8b67=_0x4b0ff4;if(pid[_0x485680])pid[_0x485680]['send']({'function':_0x3f8b67(0x29b),'args':null});else{const _0x9b2d10=configpath+_0x3f8b67(0x21b)+_0x485680+'-config.json',_0x2dcf56=fs[_0x3f8b67(0x33d)](_0x9b2d10),_0x496423=JSON[_0x3f8b67(0x2be)](_0x2dcf56),_0x405ab8=_0x496423[_0x3f8b67(0x2a9)][0x0][_0x3f8b67(0x1b8)];_0x496423['bot'][0x0]['headless']=!_0x405ab8;const _0x2d79f5=JSON['stringify'](_0x496423,null,0x2);fs[_0x3f8b67(0x1e7)](_0x9b2d10,_0x2d79f5),config=getConfiguration(),io['to'](_0x3f8b67(0x31f))['emit'](_0x3f8b67(0x22c),config),broadcastToBots('bots',JSON[_0x3f8b67(0x260)](config));}}function telegramError(_0x99ad1){const _0x20bcb7=_0x4b0ff4;logger['simple'](getTimeStamp()+_0x20bcb7(0x205));}function validateTelegram(_0x2946d8){const _0x3c958e=_0x4b0ff4;if(_0x2946d8['from'][_0x3c958e(0x2df)]!=settings['telegramUsername']&&'@'+_0x2946d8[_0x3c958e(0x161)]['username']!=settings[_0x3c958e(0x322)])return tgBot[_0x3c958e(0x253)](_0x2946d8[_0x3c958e(0x31b)]['id'],_0x3c958e(0x176),{'parse_mode':_0x3c958e(0x2a7)})[_0x3c958e(0x319)](_0xc47b2e=>{telegramError(_0xc47b2e);}),![];return!![];}async function initTelegram(){const _0x44128d=_0x4b0ff4;if(tgBot)tgBot[_0x44128d(0x311)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x44128d(0x195)],{'polling':!![]});let _0x3caa6f=_0x44128d(0x26c);_0x3caa6f+='\x0a',_0x3caa6f+=_0x44128d(0x296),_0x3caa6f+=_0x44128d(0x22b),_0x3caa6f+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x3caa6f+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3caa6f+=_0x44128d(0x1ab),_0x3caa6f+=_0x44128d(0x1a9),_0x3caa6f+=_0x44128d(0x2fe),_0x3caa6f+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3caa6f+=_0x44128d(0x2fc),_0x3caa6f+=_0x44128d(0x2cd),_0x3caa6f+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3caa6f+=_0x44128d(0x19b),_0x3caa6f+=_0x44128d(0x23b),_0x3caa6f+=_0x44128d(0x1e8);let _0x332ccc='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x332ccc+='\x0a',_0x332ccc+=_0x3caa6f,tgBot[_0x44128d(0x334)](/\/start/,_0x39d264=>{const _0x2f9cf7=_0x44128d;if(!validateTelegram(_0x39d264))return;if(settings[_0x2f9cf7(0x1af)]!=_0x39d264[_0x2f9cf7(0x31b)]['id'])updateSetting(_0x2f9cf7(0x1af),_0x39d264[_0x2f9cf7(0x31b)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x2f9cf7(0x253)](_0x39d264[_0x2f9cf7(0x31b)]['id'],_0x332ccc)[_0x2f9cf7(0x319)](_0x431db7=>{telegramError(_0x431db7);});}),tgBot[_0x44128d(0x334)](/\/enable/,_0x210887=>{const _0x4383e2=_0x44128d;if(!validateTelegram(_0x210887))return;if(settings[_0x4383e2(0x1af)]!=_0x210887[_0x4383e2(0x31b)]['id'])updateSetting(_0x4383e2(0x1af),_0x210887['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x210887[_0x4383e2(0x31b)]['id'],_0x4383e2(0x1b4))[_0x4383e2(0x319)](_0x3d192c=>{telegramError(_0x3d192c);});}),tgBot[_0x44128d(0x334)](/\/config/,async _0x291966=>{const _0xd62720=_0x44128d;if(!validateTelegram(_0x291966))return;tgBot[_0xd62720(0x2f7)](_0xd62720(0x20e)),tgBot[_0xd62720(0x253)](_0x291966['chat']['id'],_0xd62720(0x15f),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0xd62720(0x2ae)},{'text':_0xd62720(0x23c),'callback_data':_0xd62720(0x2a8)},{'text':_0xd62720(0x267),'callback_data':'all'}]]}})[_0xd62720(0x319)](_0xe27590=>{telegramError(_0xe27590);}),tgBot['on'](_0xd62720(0x20e),async _0xb9845d=>{const _0xf8038d=_0xd62720,_0x243fe3=_0xb9845d[_0xf8038d(0x2c4)],_0x563a6b=_0xb9845d['message'];tgBot['answerCallbackQuery'](_0xb9845d['id'])[_0xf8038d(0x1ff)](async()=>{const _0x11493c=_0xf8038d;_0x243fe3==_0x11493c(0x2ae)&&(updateSetting('telegramEvents',_0x11493c(0x2ae)),updateSetting(_0x11493c(0x26e),!![]),await tgBot['sendMessage'](_0x563a6b[_0x11493c(0x31b)]['id'],_0x11493c(0x288))[_0x11493c(0x319)](_0x4cede2=>{telegramError(_0x4cede2);}));_0x243fe3==_0x11493c(0x2a8)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x11493c(0x26e),!![]),await tgBot[_0x11493c(0x253)](_0x563a6b[_0x11493c(0x31b)]['id'],_0x11493c(0x338))[_0x11493c(0x319)](_0x5305dd=>{telegramError(_0x5305dd);}));_0x243fe3==_0x11493c(0x24f)&&(updateSetting(_0x11493c(0x2e3),_0x11493c(0x24f)),updateSetting('telegramEnabled',!![]),await tgBot[_0x11493c(0x253)](_0x563a6b[_0x11493c(0x31b)]['id'],_0x11493c(0x29d))[_0x11493c(0x319)](_0x77d0bd=>{telegramError(_0x77d0bd);}));if(!settings[_0x11493c(0x1af)])tgBot[_0x11493c(0x253)](_0x563a6b[_0x11493c(0x31b)]['id'],_0x11493c(0x2ce))[_0x11493c(0x319)](_0x40c9cd=>{telegramError(_0x40c9cd);});}),tgBot[_0xf8038d(0x2f7)](_0xf8038d(0x20e));});}),tgBot[_0x44128d(0x334)](/\/status/,_0x56a1d0=>{const _0x170669=_0x44128d;if(!validateTelegram(_0x56a1d0))return;const _0x10a84f=getBotsWithMode();let _0x6a9790=_0x170669(0x192);config[_0x170669(0x305)](_0x33404b=>{const _0x148ff7=_0x170669,_0x102c22=_0x10a84f['find'](_0x26eec0=>_0x26eec0[_0x148ff7(0x248)]==_0x33404b[_0x148ff7(0x248)])[_0x148ff7(0x250)];_0x6a9790+=_0x148ff7(0x18f)+_0x33404b[_0x148ff7(0x248)]+':\x20'+_0x33404b[_0x148ff7(0x2bc)]+_0x148ff7(0x17e)+_0x102c22+_0x148ff7(0x17e)+_0x33404b['live']+'\x0a';}),_0x6a9790+='\x0a',_0x6a9790+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x6a9790+=!settings[_0x170669(0x26e)]?_0x170669(0x340):_0x170669(0x1ca),_0x6a9790+=settings[_0x170669(0x26e)]?settings[_0x170669(0x2e3)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x170669(0x1dc)+settings[_0x170669(0x2e3)]+_0x170669(0x2a1):'',tgBot[_0x170669(0x253)](_0x56a1d0[_0x170669(0x31b)]['id'],_0x6a9790,{'parse_mode':_0x170669(0x2a7)})[_0x170669(0x319)](_0x1de84c=>{telegramError(_0x1de84c);});}),tgBot[_0x44128d(0x334)](/\/restart/,_0x17177e=>{const _0x12a918=_0x44128d;if(!validateTelegram(_0x17177e))return;tgBot[_0x12a918(0x2f7)](_0x12a918(0x20e));const _0x568144=getEnabledBots();if(_0x568144['length']==0x0)tgBot[_0x12a918(0x253)](_0x17177e[_0x12a918(0x31b)]['id'],_0x12a918(0x2c8))[_0x12a918(0x319)](_0x52758f=>{telegramError(_0x52758f);});else{if(_0x568144[_0x12a918(0x247)]>0x1)_0x568144[_0x12a918(0x2b0)]({'botID':_0x12a918(0x24f)});let _0x248ee8=[],_0x40b2e7=[];const _0x5856ab=_0x568144['length']%0x4==0x0||_0x568144[_0x12a918(0x247)]%0x4==0x3||_0x568144[_0x12a918(0x247)]%0x3==0x1?0x4:0x3;let _0x2b3894=0x0;_0x568144['forEach']((_0x13d036,_0x8acac2)=>{const _0x96eb22=_0x12a918;if(_0x8acac2%_0x5856ab==0x0)_0x40b2e7=[];_0x40b2e7[_0x96eb22(0x2b0)]({'text':_0x13d036['botID']==_0x96eb22(0x24f)?'All\x20bots':_0x96eb22(0x18f)+_0x13d036[_0x96eb22(0x248)],'callback_data':_0x13d036['botID']}),_0x8acac2%_0x5856ab==0x0&&(_0x248ee8[_0x2b3894]=_0x40b2e7,_0x2b3894++);}),tgBot[_0x12a918(0x253)](_0x17177e[_0x12a918(0x31b)]['id'],_0x12a918(0x294),{'reply_markup':{'inline_keyboard':_0x248ee8}})[_0x12a918(0x319)](_0x42614b=>{telegramError(_0x42614b);}),tgBot['on'](_0x12a918(0x20e),async _0xf88d0=>{const _0x46a02b=_0x12a918,_0x11a569=_0xf88d0[_0x46a02b(0x2c4)],_0x32f493=_0xf88d0['message'];tgBot['answerCallbackQuery'](_0xf88d0['id'])[_0x46a02b(0x1ff)](async()=>{const _0xa3b8df=_0x46a02b;_0x11a569==_0xa3b8df(0x24f)?config[_0xa3b8df(0x305)](_0x50fde8=>{const _0x19b52b=_0xa3b8df;restartBot(_0x50fde8[_0x19b52b(0x248)]);}):restartBot(_0x11a569);}),tgBot['removeListener'](_0x46a02b(0x20e));});}}),tgBot[_0x44128d(0x334)](/\/on/,_0x13043c=>{const _0x51ce0d=_0x44128d;if(!validateTelegram(_0x13043c))return;tgBot[_0x51ce0d(0x2f7)](_0x51ce0d(0x20e));const _0x4d1797=getDisabledBots();if(_0x4d1797[_0x51ce0d(0x247)]==0x0)tgBot['sendMessage'](_0x13043c[_0x51ce0d(0x31b)]['id'],_0x51ce0d(0x1d2))[_0x51ce0d(0x319)](_0x26ed15=>{telegramError(_0x26ed15);});else{if(_0x4d1797[_0x51ce0d(0x247)]>0x1)_0x4d1797[_0x51ce0d(0x2b0)]({'botID':_0x51ce0d(0x24f)});let _0x30fc46=[],_0x50d37f=[];const _0x3f8db8=_0x4d1797[_0x51ce0d(0x247)]%0x4==0x0||_0x4d1797['length']%0x4==0x3||_0x4d1797[_0x51ce0d(0x247)]%0x3==0x1?0x4:0x3;let _0x472eac=0x0;_0x4d1797[_0x51ce0d(0x305)]((_0x262d7c,_0x475d9a)=>{const _0x4a41d3=_0x51ce0d;if(_0x475d9a%_0x3f8db8==0x0)_0x50d37f=[];_0x50d37f['push']({'text':_0x262d7c['botID']==_0x4a41d3(0x24f)?_0x4a41d3(0x234):_0x4a41d3(0x18f)+_0x262d7c[_0x4a41d3(0x248)],'callback_data':_0x262d7c[_0x4a41d3(0x248)]}),_0x475d9a%_0x3f8db8==0x0&&(_0x30fc46[_0x472eac]=_0x50d37f,_0x472eac++);}),tgBot[_0x51ce0d(0x253)](_0x13043c[_0x51ce0d(0x31b)]['id'],_0x51ce0d(0x211),{'reply_markup':{'inline_keyboard':_0x30fc46}})[_0x51ce0d(0x319)](_0x518e90=>{telegramError(_0x518e90);}),tgBot['on'](_0x51ce0d(0x20e),async _0x123e9d=>{const _0x51446a=_0x51ce0d,_0x3bec43=_0x123e9d[_0x51446a(0x2c4)],_0x5dbf14=_0x123e9d[_0x51446a(0x2da)];tgBot[_0x51446a(0x1a3)](_0x123e9d['id'])[_0x51446a(0x1ff)](async()=>{const _0x327d2b=_0x51446a;_0x3bec43==_0x327d2b(0x24f)?(tgBot[_0x327d2b(0x253)](_0x5dbf14[_0x327d2b(0x31b)]['id'],_0x327d2b(0x300))[_0x327d2b(0x319)](_0x55cdb8=>{telegramError(_0x55cdb8);}),_0x4d1797[_0x327d2b(0x305)](_0x26d67b=>{const _0x3e7575=_0x327d2b;if(_0x26d67b[_0x3e7575(0x248)]!=_0x3e7575(0x24f))toggleBot(_0x26d67b[_0x3e7575(0x248)],toggleStatus(_0x26d67b[_0x3e7575(0x248)]),_0x3e7575(0x1b3));})):(tgBot[_0x327d2b(0x253)](_0x5dbf14['chat']['id'],_0x327d2b(0x24e)+_0x3bec43)[_0x327d2b(0x319)](_0x40dee6=>{telegramError(_0x40dee6);}),toggleBot(_0x3bec43,toggleStatus(_0x3bec43),_0x327d2b(0x1b3)));}),tgBot[_0x51446a(0x2f7)]('callback_query');});}}),tgBot[_0x44128d(0x334)](/\/off/,_0x14809e=>{const _0x39d6a3=_0x44128d;if(!validateTelegram(_0x14809e))return;tgBot[_0x39d6a3(0x2f7)](_0x39d6a3(0x20e));const _0x5512cb=getEnabledBots();if(_0x5512cb[_0x39d6a3(0x247)]==0x0)tgBot['sendMessage'](_0x14809e['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x39d6a3(0x319)](_0x5a4370=>{telegramError(_0x5a4370);});else{if(_0x5512cb['length']>0x1)_0x5512cb['push']({'botID':_0x39d6a3(0x24f)});let _0x39a862=[],_0x477305=[];const _0x4a36a7=_0x5512cb['length']%0x4==0x0||_0x5512cb[_0x39d6a3(0x247)]%0x4==0x3||_0x5512cb[_0x39d6a3(0x247)]%0x3==0x1?0x4:0x3;let _0x5277cc=0x0;_0x5512cb[_0x39d6a3(0x305)]((_0x59a3e4,_0x53ea21)=>{const _0x2c49e9=_0x39d6a3;if(_0x53ea21%_0x4a36a7==0x0)_0x477305=[];_0x477305[_0x2c49e9(0x2b0)]({'text':_0x59a3e4[_0x2c49e9(0x248)]=='all'?_0x2c49e9(0x234):_0x2c49e9(0x18f)+_0x59a3e4['botID'],'callback_data':_0x59a3e4['botID']}),_0x53ea21%_0x4a36a7==0x0&&(_0x39a862[_0x5277cc]=_0x477305,_0x5277cc++);}),tgBot[_0x39d6a3(0x253)](_0x14809e[_0x39d6a3(0x31b)]['id'],_0x39d6a3(0x166),{'reply_markup':{'inline_keyboard':_0x39a862}})[_0x39d6a3(0x319)](_0x1e7fc0=>{telegramError(_0x1e7fc0);}),tgBot['on']('callback_query',async _0x4d6606=>{const _0x214089=_0x39d6a3,_0x3bdbb5=_0x4d6606[_0x214089(0x2c4)],_0x30029b=_0x4d6606[_0x214089(0x2da)];tgBot[_0x214089(0x1a3)](_0x4d6606['id'])[_0x214089(0x1ff)](async()=>{const _0x9ce05=_0x214089;_0x3bdbb5==_0x9ce05(0x24f)?(tgBot['sendMessage'](_0x30029b[_0x9ce05(0x31b)]['id'],_0x9ce05(0x236))[_0x9ce05(0x319)](_0x22e22c=>{telegramError(_0x22e22c);}),_0x5512cb[_0x9ce05(0x305)](_0x437e24=>{const _0x567d6a=_0x9ce05;if(_0x437e24[_0x567d6a(0x248)]!=_0x567d6a(0x24f))toggleBot(_0x437e24['botID'],toggleStatus(_0x437e24['botID']),'stopped');})):(tgBot[_0x9ce05(0x253)](_0x30029b['chat']['id'],_0x9ce05(0x299)+_0x3bdbb5)[_0x9ce05(0x319)](_0xd52c47=>{telegramError(_0xd52c47);}),toggleBot(_0x3bdbb5,toggleStatus(_0x3bdbb5),_0x9ce05(0x1b3)));}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/metrics/,_0x32d7f0=>{const _0x4c81de=_0x44128d;if(!validateTelegram(_0x32d7f0))return;tgBot[_0x4c81de(0x2f7)](_0x4c81de(0x20e));const _0x22908c=getEnabledBots();if(_0x22908c[_0x4c81de(0x247)]==0x0)tgBot[_0x4c81de(0x253)](_0x32d7f0[_0x4c81de(0x31b)]['id'],_0x4c81de(0x2c8))['catch'](_0x504602=>{telegramError(_0x504602);});else{if(_0x22908c['length']>0x1){let _0x15b937=[],_0x38e787=[];const _0x303e6d=_0x22908c[_0x4c81de(0x247)]%0x4==0x0||_0x22908c[_0x4c81de(0x247)]%0x4==0x3||_0x22908c['length']%0x3==0x1?0x4:0x3;let _0x55ee0c=0x0;_0x22908c[_0x4c81de(0x305)]((_0x43710a,_0x2d616f)=>{const _0x164206=_0x4c81de;if(_0x2d616f%_0x303e6d==0x0)_0x38e787=[];_0x38e787[_0x164206(0x2b0)]({'text':_0x164206(0x18f)+_0x43710a[_0x164206(0x248)],'callback_data':_0x43710a['botID']}),_0x2d616f%_0x303e6d==0x0&&(_0x15b937[_0x55ee0c]=_0x38e787,_0x55ee0c++);}),tgBot[_0x4c81de(0x253)](_0x32d7f0[_0x4c81de(0x31b)]['id'],_0x4c81de(0x1a4),{'reply_markup':{'inline_keyboard':_0x15b937}})[_0x4c81de(0x319)](_0x44446f=>{telegramError(_0x44446f);}),tgBot['on'](_0x4c81de(0x20e),async _0x31bbb4=>{const _0x1feb0e=_0x4c81de,_0x7bdf21=_0x31bbb4[_0x1feb0e(0x2c4)],_0x205d92=_0x31bbb4[_0x1feb0e(0x2da)];tgBot[_0x1feb0e(0x1a3)](_0x31bbb4['id'])[_0x1feb0e(0x1ff)](async()=>{const _0x3a3930=_0x1feb0e;if(pid[_0x7bdf21])pid[_0x7bdf21][_0x3a3930(0x184)]({'function':_0x3a3930(0x2b1),'args':null});}),tgBot[_0x1feb0e(0x2f7)](_0x1feb0e(0x20e));});}else{const _0x5255a6=_0x22908c[0x0][_0x4c81de(0x248)];if(pid[_0x5255a6])pid[_0x5255a6][_0x4c81de(0x184)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x44128d(0x334)](/\/portfolio/,_0x47db15=>{const _0x5ccf26=_0x44128d;if(!validateTelegram(_0x47db15))return;tgBot[_0x5ccf26(0x2f7)]('callback_query');const _0x3ac168=getEnabledBots();if(_0x3ac168['length']==0x0)tgBot[_0x5ccf26(0x253)](_0x47db15[_0x5ccf26(0x31b)]['id'],_0x5ccf26(0x2c8))[_0x5ccf26(0x319)](_0x339ddc=>{telegramError(_0x339ddc);});else{if(_0x3ac168['length']>0x1){let _0x1f1463=[],_0x27ad2b=[];const _0x21972f=_0x3ac168[_0x5ccf26(0x247)]%0x4==0x0||_0x3ac168[_0x5ccf26(0x247)]%0x4==0x3||_0x3ac168[_0x5ccf26(0x247)]%0x3==0x1?0x4:0x3;let _0xc682b7=0x0;_0x3ac168[_0x5ccf26(0x305)]((_0x387918,_0x13ba72)=>{const _0x92c8b1=_0x5ccf26;if(_0x13ba72%_0x21972f==0x0)_0x27ad2b=[];_0x27ad2b[_0x92c8b1(0x2b0)]({'text':_0x92c8b1(0x18f)+_0x387918['botID'],'callback_data':_0x387918[_0x92c8b1(0x248)]}),_0x13ba72%_0x21972f==0x0&&(_0x1f1463[_0xc682b7]=_0x27ad2b,_0xc682b7++);}),tgBot[_0x5ccf26(0x253)](_0x47db15[_0x5ccf26(0x31b)]['id'],_0x5ccf26(0x1f1),{'reply_markup':{'inline_keyboard':_0x1f1463}})[_0x5ccf26(0x319)](_0x56d2fc=>{telegramError(_0x56d2fc);}),tgBot['on'](_0x5ccf26(0x20e),async _0x37c18a=>{const _0x3b7aa9=_0x5ccf26,_0x1becd2=_0x37c18a[_0x3b7aa9(0x2c4)],_0x11c8f4=_0x37c18a['message'];tgBot[_0x3b7aa9(0x1a3)](_0x37c18a['id'])[_0x3b7aa9(0x1ff)](async()=>{const _0x1e0cbd=_0x3b7aa9;if(pid[_0x1becd2])pid[_0x1becd2][_0x1e0cbd(0x184)]({'function':_0x1e0cbd(0x24a),'args':null});}),tgBot[_0x3b7aa9(0x2f7)](_0x3b7aa9(0x20e));});}else{const _0x201ad7=_0x3ac168[0x0][_0x5ccf26(0x248)];if(pid[_0x201ad7])pid[_0x201ad7][_0x5ccf26(0x184)]({'function':_0x5ccf26(0x24a),'args':null});}}}),tgBot[_0x44128d(0x334)](/\/update/,async _0x3c6da1=>{const _0x24dcde=_0x44128d;if(!validateTelegram(_0x3c6da1))return;tgBot[_0x24dcde(0x2f7)](_0x24dcde(0x20e)),await getMessages();if(!updateAvailable)tgBot[_0x24dcde(0x253)](_0x3c6da1[_0x24dcde(0x31b)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x24dcde(0x319)](_0x14ab1c=>{telegramError(_0x14ab1c);});else!validInstallation?tgBot['sendMessage'](_0x3c6da1[_0x24dcde(0x31b)]['id'],_0x24dcde(0x1a0))['catch'](_0x1c6915=>{telegramError(_0x1c6915);}):(tgBot[_0x24dcde(0x253)](_0x3c6da1[_0x24dcde(0x31b)]['id'],_0x24dcde(0x18c),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x24dcde(0x25f)},{'text':'No','callback_data':'no'}]]}})[_0x24dcde(0x319)](_0x3b6ae4=>{telegramError(_0x3b6ae4);}),tgBot['on'](_0x24dcde(0x20e),async _0x4c510f=>{const _0x1f2f9a=_0x24dcde,_0x301ede=_0x4c510f['data'],_0x5bcdb5=_0x4c510f[_0x1f2f9a(0x2da)];tgBot[_0x1f2f9a(0x1a3)](_0x4c510f['id'])[_0x1f2f9a(0x1ff)](async()=>{const _0x404da4=_0x1f2f9a;_0x301ede==_0x404da4(0x25f)&&(await tgBot[_0x404da4(0x253)](_0x5bcdb5['chat']['id'],_0x404da4(0x212))[_0x404da4(0x319)](_0x4bbd54=>{telegramError(_0x4bbd54);}),updateBB(_0x404da4(0x30a))),_0x301ede=='no'&&await tgBot['sendMessage'](_0x5bcdb5['chat']['id'],_0x404da4(0x190))[_0x404da4(0x319)](_0x4130a5=>{telegramError(_0x4130a5);});}),tgBot['removeListener'](_0x1f2f9a(0x20e));}));}),tgBot['onText'](/\/reinstall/,async _0x4fff6a=>{const _0xf1b20=_0x44128d;if(!validateTelegram(_0x4fff6a))return;tgBot[_0xf1b20(0x2f7)]('callback_query'),!validInstallation?tgBot[_0xf1b20(0x253)](_0x4fff6a['chat']['id'],_0xf1b20(0x168))['catch'](_0x26fa9b=>{telegramError(_0x26fa9b);}):(tgBot['sendMessage'](_0x4fff6a[_0xf1b20(0x31b)]['id'],_0xf1b20(0x1d7),{'reply_markup':{'inline_keyboard':[[{'text':_0xf1b20(0x1d9),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0xf1b20(0x319)](_0x556b76=>{telegramError(_0x556b76);}),tgBot['on'](_0xf1b20(0x20e),async _0x58c04d=>{const _0x5b54a6=_0xf1b20,_0x1f3ab4=_0x58c04d[_0x5b54a6(0x2c4)],_0x10d509=_0x58c04d[_0x5b54a6(0x2da)];tgBot[_0x5b54a6(0x1a3)](_0x58c04d['id'])['then'](async()=>{const _0x5c321e=_0x5b54a6;_0x1f3ab4=='yes'&&(await tgBot[_0x5c321e(0x253)](_0x10d509[_0x5c321e(0x31b)]['id'],_0x5c321e(0x21d))[_0x5c321e(0x319)](_0x4a8183=>{telegramError(_0x4a8183);}),updateBB('reinstall')),_0x1f3ab4=='no'&&await tgBot[_0x5c321e(0x253)](_0x10d509[_0x5c321e(0x31b)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x5c321e(0x319)](_0x204293=>{telegramError(_0x204293);});}),tgBot[_0x5b54a6(0x2f7)](_0x5b54a6(0x20e));}));}),tgBot[_0x44128d(0x334)](/\/toggle/,_0x39eeb5=>{const _0x2e7437=_0x44128d;if(!validateTelegram(_0x39eeb5))return;tgBot[_0x2e7437(0x2f7)](_0x2e7437(0x20e));const _0x36a94c=getBotsWithMode();if(_0x36a94c['length']==0x0)tgBot[_0x2e7437(0x253)](_0x39eeb5[_0x2e7437(0x31b)]['id'],_0x2e7437(0x2c8))[_0x2e7437(0x319)](_0x378bcc=>{telegramError(_0x378bcc);});else{let _0x3fcb2e=[],_0x5e7335=[];const _0x44049d=0x2;let _0x4df1a7=0x0;_0x36a94c[_0x2e7437(0x305)]((_0x1aa605,_0x106857)=>{const _0x1ec402=_0x2e7437;if(_0x106857%_0x44049d==0x0)_0x5e7335=[];_0x5e7335[_0x1ec402(0x2b0)]({'text':_0x1ec402(0x18f)+_0x1aa605[_0x1ec402(0x248)]+'\x20('+_0x1aa605['mode']+')','callback_data':_0x1aa605[_0x1ec402(0x248)]}),_0x106857%_0x44049d==0x0&&(_0x3fcb2e[_0x4df1a7]=_0x5e7335,_0x4df1a7++);}),tgBot[_0x2e7437(0x253)](_0x39eeb5['chat']['id'],_0x2e7437(0x2aa),{'reply_markup':{'inline_keyboard':_0x3fcb2e}})[_0x2e7437(0x319)](_0x3184e7=>{telegramError(_0x3184e7);}),tgBot['on']('callback_query',async _0x5af5a6=>{const _0x261585=_0x2e7437,_0x5e2b67=_0x5af5a6['data'],_0x2ee08e=_0x5af5a6[_0x261585(0x2da)];tgBot[_0x261585(0x1a3)](_0x5af5a6['id'])[_0x261585(0x1ff)](async()=>{const _0x39fdc6=_0x261585,_0x2fb99a=_0x36a94c[_0x39fdc6(0x254)](_0x5d081a=>_0x5d081a[_0x39fdc6(0x248)]==_0x5e2b67),_0x3390e7=_0x2fb99a[_0x39fdc6(0x250)]==_0x39fdc6(0x1b0)?'manual':_0x39fdc6(0x1b0);tgBot[_0x39fdc6(0x253)](_0x2ee08e[_0x39fdc6(0x31b)]['id'],_0x39fdc6(0x317)+_0x5e2b67+'\x20to\x20'+_0x3390e7+_0x39fdc6(0x1f0))[_0x39fdc6(0x319)](_0x55ed05=>{telegramError(_0x55ed05);}),toggleBotMode(_0x5e2b67);}),tgBot[_0x261585(0x2f7)](_0x261585(0x20e));});}}),tgBot[_0x44128d(0x334)](/\/names/,_0x56078c=>{const _0x51bbc7=_0x44128d;if(!validateTelegram(_0x56078c))return;let _0x127536='';config[_0x51bbc7(0x305)](_0x239bf2=>{const _0x1fbe3d=_0x51bbc7;_0x127536+=_0x1fbe3d(0x18f)+_0x239bf2[_0x1fbe3d(0x248)]+':\x20'+_0x239bf2[_0x1fbe3d(0x2b3)]+'\x0a';}),tgBot[_0x51bbc7(0x253)](_0x56078c[_0x51bbc7(0x31b)]['id'],_0x127536,{'parse_mode':_0x51bbc7(0x2a7)})[_0x51bbc7(0x319)](_0x33db8a=>{telegramError(_0x33db8a);});}),tgBot[_0x44128d(0x334)](/\/disable/,_0x59f506=>{const _0x41dc82=_0x44128d;if(!validateTelegram(_0x59f506))return;tgBot[_0x41dc82(0x253)](_0x59f506['chat']['id'],_0x41dc82(0x32f))['catch'](_0x292114=>{telegramError(_0x292114);}),updateSetting(_0x41dc82(0x26e),![]);}),tgBot[_0x44128d(0x334)](/\/help/,_0x8e8a4b=>{const _0x2c149e=_0x44128d;if(!validateTelegram(_0x8e8a4b))return;tgBot[_0x2c149e(0x253)](_0x8e8a4b[_0x2c149e(0x31b)]['id'],_0x3caa6f)[_0x2c149e(0x319)](_0x4507fd=>{telegramError(_0x4507fd);});}),tgBot['on']('polling_error',_0x3ea362=>{const _0x6f6d97=_0x44128d;_0x3ea362[_0x6f6d97(0x291)]()[_0x6f6d97(0x30f)](_0x6f6d97(0x25e))&&(logger[_0x6f6d97(0x27e)](_0x6f6d97(0x280)),tgBot[_0x6f6d97(0x311)](),tgBot=null,io['to'](_0x6f6d97(0x31f))[_0x6f6d97(0x1f2)](_0x6f6d97(0x341),_0x6f6d97(0x280)));}),process['once']('SIGINT',()=>{const _0xc7a446=_0x44128d;if(tgBot)tgBot[_0xc7a446(0x311)]();process[_0xc7a446(0x257)](0x1);}),process[_0x44128d(0x1b2)](_0x44128d(0x282),()=>{const _0x922e6a=_0x44128d;if(tgBot)tgBot[_0x922e6a(0x311)]();process['exit'](0x1);});}}function disableTelegram(){const _0x22d63e=_0x4b0ff4;tgBot&&(tgBot[_0x22d63e(0x311)](),tgBot=null);}function sendTelegram(_0x4296a6,_0x14597d){const _0x13d31e=_0x4b0ff4;if(settings[_0x13d31e(0x26e)]){if(settings['telegramEvents']=='all'||(_0x14597d['type']==_0x13d31e(0x304)||_0x14597d[_0x13d31e(0x243)]==_0x13d31e(0x2e0)||_0x14597d['type']=='success')&&settings[_0x13d31e(0x2e3)]==_0x13d31e(0x2a8)||_0x14597d[_0x13d31e(0x243)]=='order'&&settings[_0x13d31e(0x2e3)]=='orders'){if(tgBot&&settings[_0x13d31e(0x1af)]){if(_0x14597d['showname'])tgBot[_0x13d31e(0x253)](settings[_0x13d31e(0x1af)],_0x14597d[_0x13d31e(0x2b3)]+'\x20>\x20'+_0x14597d['event'])['catch'](_0x3c42cc=>{telegramError(_0x3c42cc);});else tgBot[_0x13d31e(0x253)](settings['telegramChatId'],_0x13d31e(0x18f)+_0x4296a6+_0x13d31e(0x1a5)+_0x14597d[_0x13d31e(0x1fd)])['catch'](_0x45f8b3=>{telegramError(_0x45f8b3);});}}}}async function sendTelegramMsg(_0x255fab,_0x5230c9=_0x4b0ff4(0x2a7)){const _0x188858=_0x4b0ff4;return settings['telegramEnabled']&&tgBot&&settings[_0x188858(0x1af)]?(await tgBot[_0x188858(0x253)](settings[_0x188858(0x1af)],_0x255fab,{'parse_mode':_0x5230c9})[_0x188858(0x319)](_0x206a62=>{telegramError(_0x206a62);}),!![]):![];}function getDeviceWithIp(_0x3d8222){const _0x794b55=_0x4b0ff4;return devices[_0x794b55(0x254)](_0x1f0ab5=>_0x1f0ab5['ip']===_0x3d8222);}function temporaryAccess2FA(_0x150483,_0xb0c757){const _0x244f71=_0x4b0ff4;let _0xe8b2f0=new Date(),_0x20166a=![];if(lastIpApproval){if(_0xe8b2f0-lastIpApproval<0x1388)_0x20166a=!![];}lastIpApproval=new Date();if(_0x20166a)return;tgBot&&settings[_0x244f71(0x1af)]&&(tgBot['removeListener'](_0x244f71(0x20e)),tgBot[_0x244f71(0x253)](settings[_0x244f71(0x1af)],_0x244f71(0x226)+normalizeIP(_0xb0c757)[_0x244f71(0x221)]+_0x244f71(0x1d4),{'parse_mode':_0x244f71(0x2a7),'reply_markup':{'inline_keyboard':[[{'text':_0x244f71(0x1bd),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x244f71(0x178),'callback_data':'30'},{'text':'reject','callback_data':_0x244f71(0x1ac)}]]}})[_0x244f71(0x319)](_0x4c3b12=>{telegramError(_0x4c3b12);}),tgBot['on'](_0x244f71(0x20e),async _0x574e76=>{const _0x3646eb=_0x244f71,_0x566709=_0x574e76[_0x3646eb(0x2c4)],_0x4d70cb=_0x574e76[_0x3646eb(0x2da)];tgBot['answerCallbackQuery'](_0x574e76['id'])[_0x3646eb(0x1ff)](async()=>{const _0x565898=_0x3646eb;devices[_0x150483][_0x565898(0x1a2)]={'clientip':_0xb0c757,'timestamp':new Date()[_0x565898(0x306)](),'expiry':_0x566709},_0x566709!=_0x565898(0x1ac)?(await tgBot[_0x565898(0x253)](_0x4d70cb[_0x565898(0x31b)]['id'],_0x565898(0x27c)+_0x566709+_0x565898(0x27a),{'parse_mode':_0x565898(0x2a7)})[_0x565898(0x319)](_0x241dff=>{telegramError(_0x241dff);}),io['to'](_0x150483)['emit'](_0x565898(0x2bc),{'access':{'allow':![],'reason':_0x565898(0x175),'token':null}})):(await tgBot['sendMessage'](_0x4d70cb[_0x565898(0x31b)]['id'],_0x565898(0x2a2))[_0x565898(0x319)](_0x50fdba=>{telegramError(_0x50fdba);}),io['to'](_0x150483)[_0x565898(0x1f2)]('status',{'access':{'allow':![],'reason':_0x565898(0x2e8),'token':null}}));}),tgBot['removeListener'](_0x3646eb(0x20e));}));}function loginAccess2FA(_0x53b60c,_0x545c59){const _0x1532b3=_0x4b0ff4;tgBot&&settings['telegramChatId']&&(tgBot[_0x1532b3(0x2f7)]('callback_query'),tgBot[_0x1532b3(0x253)](settings[_0x1532b3(0x1af)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x545c59)[_0x1532b3(0x221)]+'</b>\x20?',{'parse_mode':_0x1532b3(0x2a7),'reply_markup':{'inline_keyboard':[[{'text':_0x1532b3(0x2d5),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x1532b3(0x1ac)}]]}})['catch'](_0x42b061=>{telegramError(_0x42b061);}),tgBot['on'](_0x1532b3(0x20e),async _0x41ff4f=>{const _0x559469=_0x1532b3,_0x5872b6=_0x41ff4f['data'],_0x15fbfa=_0x41ff4f[_0x559469(0x2da)];tgBot[_0x559469(0x1a3)](_0x41ff4f['id'])[_0x559469(0x1ff)](async()=>{const _0xfe1891=_0x559469;devices[_0x53b60c][_0xfe1891(0x22f)]={'clientip':_0x545c59,'timestamp':new Date()[_0xfe1891(0x306)](),'expiry':_0x5872b6},_0x5872b6!=_0xfe1891(0x1ac)?(await tgBot['sendMessage'](_0x15fbfa['chat']['id'],_0xfe1891(0x22d),{'parse_mode':_0xfe1891(0x2a7)})['catch'](_0x39b2b2=>{telegramError(_0x39b2b2);}),io['to'](_0x53b60c)[_0xfe1891(0x1f2)](_0xfe1891(0x2bc),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0xfe1891(0x253)](_0x15fbfa[_0xfe1891(0x31b)]['id'],_0xfe1891(0x2f3))[_0xfe1891(0x319)](_0x5c946d=>{telegramError(_0x5c946d);}),io['to'](_0x53b60c)[_0xfe1891(0x1f2)](_0xfe1891(0x2bc),{'access':{'allow':![],'reason':_0xfe1891(0x26a),'token':null}}));}),tgBot[_0x559469(0x2f7)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4de71a=_0x4b0ff4;return dbConfig[_0x4de71a(0x244)]('bots')[_0x4de71a(0x2b7)](_0x4de71a(0x248))['filter']({'status':_0x4de71a(0x26f)})[_0x4de71a(0x172)]()||[];}function getDisabledBots(){const _0x49832d=_0x4b0ff4;return dbConfig['get'](_0x49832d(0x22c))['sortBy'](_0x49832d(0x248))[_0x49832d(0x32c)]({'status':_0x49832d(0x2dc)})[_0x49832d(0x172)]()||[];}function getBotAttributes(_0x58ceac){const _0x253e4d=_0x4b0ff4;let _0x4d4844={};const _0x2d3a7d=configpath+_0x253e4d(0x21b)+_0x58ceac+_0x253e4d(0x200),_0x299a05=fs['existsSync'](_0x2d3a7d);if(_0x299a05){const _0x3af92c=fs['readFileSync'](_0x2d3a7d);try{const _0xfbd6c6=JSON[_0x253e4d(0x2be)](_0x3af92c),_0x51f11c=_0xfbd6c6?_0xfbd6c6[_0x253e4d(0x2a9)][0x0]['headless']:![];_0x4d4844[_0x253e4d(0x250)]=_0x51f11c?_0x253e4d(0x1b0):_0x253e4d(0x16e),_0x4d4844[_0x253e4d(0x2b3)]=_0xfbd6c6?_0xfbd6c6[_0x253e4d(0x2a9)][0x0]['botname']:'Bot\x20'+_0x58ceac;}catch(_0x125191){_0x4d4844['mode']='manual',_0x4d4844[_0x253e4d(0x2b3)]=_0x253e4d(0x18f)+_0x58ceac;}}else _0x4d4844[_0x253e4d(0x250)]=_0x253e4d(0x16e),_0x4d4844[_0x253e4d(0x2b3)]=_0x253e4d(0x18f)+_0x58ceac;return _0x4d4844;}function getBotsWithMode(){const _0x4b7693=_0x4b0ff4,_0x487cd5=dbConfig[_0x4b7693(0x244)](_0x4b7693(0x22c))['sortBy'](_0x4b7693(0x248))[_0x4b7693(0x172)]()||[];return _0x487cd5[_0x4b7693(0x305)](_0xc638d7=>{const _0x5b1278=_0x4b7693;let _0xc446bd=getBotAttributes(_0xc638d7['botID']);_0xc638d7[_0x5b1278(0x250)]=_0xc446bd['mode'];}),_0x487cd5;}function getBotExchanges(){const _0x3d2768=_0x4b0ff4;let _0x2e28cd=[];const _0x12d4ff=dbConfig[_0x3d2768(0x244)](_0x3d2768(0x22c))[_0x3d2768(0x2b7)](_0x3d2768(0x248))[_0x3d2768(0x172)]()||[];_0x12d4ff[_0x3d2768(0x305)](_0xf86211=>{const _0x7dbfd7=_0x3d2768;if(_0xf86211[_0x7dbfd7(0x2bc)]=='enabled'){const _0x21a8de=configpath+_0x7dbfd7(0x21b)+_0xf86211[_0x7dbfd7(0x248)]+_0x7dbfd7(0x200),_0x3cc617=fs[_0x7dbfd7(0x1a7)](_0x21a8de);let _0x384705;if(_0x3cc617){const _0x4cedac=fs[_0x7dbfd7(0x33d)](_0x21a8de);try{const _0x4ddc5f=JSON[_0x7dbfd7(0x2be)](_0x4cedac);_0x384705=_0x4ddc5f?_0x4ddc5f['bot'][0x0][_0x7dbfd7(0x2ba)]:null;}catch(_0x533d6b){}}if(_0x384705)_0x2e28cd[_0x7dbfd7(0x2b0)](_0x384705);}});const _0x3fccbd=[...new Set(_0x2e28cd)]['sort']();return _0x3fccbd;}async function initUser(){const _0x4473e9=_0x4b0ff4;if(!settings['userid']){const _0x311703=uuidRandom();mixpanel[_0x4473e9(0x1a6)](_0x311703),updateSetting('userid',_0x311703);}}async function initSecure(){const _0x422831=_0x4b0ff4;let _0x338f22=getSecure();if(!_0x338f22[_0x422831(0x28b)]('secret')){let _0x410b86=await generateKeys();_0x338f22[_0x422831(0x16b)]=_0x410b86[_0x422831(0x16b)],_0x338f22[_0x422831(0x337)]=_0x410b86[_0x422831(0x337)],_0x338f22['secret']=crypto[_0x422831(0x1df)](0x20)['toString'](_0x422831(0x165));;storeSecure(_0x338f22);}}function getSettings(){const _0x42625f=_0x4b0ff4;return dbSettings[_0x42625f(0x244)](_0x42625f(0x1fa))[_0x42625f(0x172)]()||{};}function getSecure(){const _0x258999=_0x4b0ff4;return dbSecure[_0x258999(0x244)]('secure')[_0x258999(0x172)]()||{};}function getBlacklist(){const _0x589f2a=_0x4b0ff4;return dbSecure['get'](_0x589f2a(0x30b))[_0x589f2a(0x172)]()||[];}function broadcastToBots(_0x364823,_0x3eeccf){const _0x4c4709=_0x4b0ff4;config[_0x4c4709(0x305)](_0x57e139=>{const _0x2cdaca=_0x4c4709;if(_0x57e139[_0x2cdaca(0x2bc)]==_0x2cdaca(0x26f)&&_0x57e139['live']==_0x2cdaca(0x26b)||_0x57e139['status']==_0x2cdaca(0x326)&&_0x57e139[_0x2cdaca(0x1f7)]==_0x2cdaca(0x26b)){if(pid[_0x57e139[_0x2cdaca(0x248)]])pid[_0x57e139[_0x2cdaca(0x248)]][_0x2cdaca(0x184)]({[_0x364823]:_0x3eeccf});}});}function storeSettings(_0x567067,_0x16744b=![]){const _0x430f56=_0x4b0ff4;_0x567067={...settings,..._0x567067};if(_0x16744b&&_0x567067[_0x430f56(0x1ee)]!=_0x430f56(0x2de)&&_0x567067[_0x430f56(0x1ee)]!=_0x430f56(0x162)&&_0x567067['bbPassword']!=''){const _0x1a7357=crypt[_0x430f56(0x1f3)](secure[_0x430f56(0x337)],_0x567067[_0x430f56(0x1ee)])[_0x430f56(0x2da)]['split']('@')[0x0],_0x1c5d54=bcrypt[_0x430f56(0x208)](_0x1a7357,saltRounds);_0x567067={..._0x567067,'bbPassword':_0x1c5d54};}if(_0x16744b&&_0x567067[_0x430f56(0x195)]!=_0x430f56(0x2de)&&_0x567067[_0x430f56(0x195)]!=_0x430f56(0x162)&&_0x567067['telegramToken']!=''){const _0xebce1b=crypt[_0x430f56(0x1f3)](secure[_0x430f56(0x337)],_0x567067[_0x430f56(0x195)])['message'][_0x430f56(0x17f)]('@')[0x0];_0x567067={..._0x567067,'telegramToken':_0xebce1b};}const _0x513c7b=_0x567067[_0x430f56(0x195)]!=_0x430f56(0x2de)&&_0x567067['telegramToken']!=settings[_0x430f56(0x195)]||_0x567067['telegramUsername']!=settings[_0x430f56(0x322)],_0x54ab46=_0x567067[_0x430f56(0x195)]==''||_0x567067[_0x430f56(0x322)]=='';if(_0x513c7b)_0x567067[_0x430f56(0x2e3)]=_0x430f56(0x24f);for(const [_0x412808,_0xd880c]of Object[_0x430f56(0x186)](_0x567067)){if(_0x412808==_0x430f56(0x195)&&_0xd880c==_0x430f56(0x2de)){_0x567067[_0x430f56(0x195)]=settings['telegramToken'];continue;};if(_0x412808==_0x430f56(0x1ee)&&_0xd880c==_0x430f56(0x2de)){_0x567067[_0x430f56(0x1ee)]=settings[_0x430f56(0x1ee)];continue;};dbSettings[_0x430f56(0x196)](_0x430f56(0x29e)+_0x412808,_0xd880c)['write']();}settings=_0x567067,io['to'](_0x430f56(0x31f))[_0x430f56(0x1f2)]('settings',cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x430f56(0x24b),settings[_0x430f56(0x24b)]);if(_0x513c7b&&!_0x54ab46)initTelegram();if(_0x513c7b&&_0x54ab46)disableTelegram();getAllClients()[_0x430f56(0x305)](_0x4dd311=>{const _0x5e6470=_0x430f56;getSocket(_0x4dd311['id'])['emit']('status',{'access':{'allow':![],'reason':_0x5e6470(0x175),'token':null}});});}function updateSetting(_0x1f80f2,_0x1114a8){const _0x36c879=_0x4b0ff4;dbSettings[_0x36c879(0x196)](_0x36c879(0x29e)+_0x1f80f2,_0x1114a8)[_0x36c879(0x309)](),settings=getSettings(),io['to']('botmanager')[_0x36c879(0x1f2)](_0x36c879(0x1fa),cleanSettings());}function storeSecure(_0x435ef4){const _0x46329d=_0x4b0ff4;dbSecure['get'](_0x46329d(0x21e))[_0x46329d(0x2b0)](_0x435ef4)[_0x46329d(0x309)](),secure=_0x435ef4;}function _0x1375(){const _0x266d58=['test','Bot\x20Mgr\x20>\x20','access\x20timeout','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','removeAllListeners','from','***','=>\x20Go\x20to\x20#CYA#http://','child_process','hex','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','bbvNew','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','backup/','isValid','publicKey','endsWith','615180iilRzt','manual','args','output-002.log','environment','value','getUTCHours','getSeconds','reload','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','format','30\x20min','headers','expiry','defaults','Server','api-eu.mixpanel.com','\x20|\x20','split','::ffff:127.0.0.1','socket','get-starting-balances','backup-full.zip','send','0.0.0','entries','File\x20uploaded','ipc','temp/','2FA','sendFile','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','unlinkSync','new-disabled','Bot\x20','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','timeshift','<b>Balance\x20Bot\x20Status:</b>\x0a','family','version.json','telegramToken','set','createServer','min','#RES#\x20if\x20running\x20locally\x0a','(staging)','/update\x20-\x20update\x20Balance\x20Bot\x0a','sha256','address','allow','Unauthorized\x20attempt\x20to\x20confirm\x20message','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','backup-full','telegramIpApproval','answerCallbackQuery','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','\x20>\x20','alias','existsSync','Backup\x20file\x20uploaded','/off\x20-\x20stop\x20bot(s)\x0a','getDate','/on\x20-\x20start\x20bot(s)\x0a','reject',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','randomFillSync','telegramChatId','auto','reinstall-bb','once','stopped','Notifications\x20enabled','whitelist','/:bot/performance','logs/','headless','9065xlwEJX','exec','-----------------------------------------------------------------------------------','Starting\x20#RED#Balance\x20Bot\x20v','5\x20min','user','tkn','Restore\x20process\x20aborted','invalid\x20credentials','any','clientip','http','Starting\x20bot\x20|\x20Bot\x20','/:bot/coins','jsonwebtoken','Unauthorized\x20attempt\x20to\x20update\x20settings','remove','Notifications\x20enabled\x0a','temporary\x20token\x20generated','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','storeHeadless','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','search','download','emitHistory','All\x20bots\x20running\x20right\x20now','token','</b>\x20?','/:bot/portfolio','\x1b[31m','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','match','Yes','timestamp','store','Notifications\x20types:\x20','logout','bb-config.json','randomBytes','bb/','#RES#\x20','crypto','port','add','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','sign','writeFileSync','/help\x20-\x20show\x20available\x20commands\x0a','initclient','1269RqAsZa','output-000.log','get-portfolio','size','bbPassword','login\x20not\x20required','\x20mode','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','emit','decrypt','kill','secret','$1_$2_$3','live','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20attempt\x20to\x20log\x20out','settings','file','NTBA_FIX_319','event','Invalid\x20authentication\x20token\x20(2)','then','-config.json','backup-full@','copyFileSync','inherit','readdirSync',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','function','replace','hashSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','disconnect','keys','lowdb','Unauthorized\x20attempt\x20to\x20get\x20portfolio','callback_query','get-backup-files','max','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Starting\x20Balance\x20Bot\x20update','RSA-OAEP','apiKey','cancel-loading','compareSync','restart','[ip-address]','getHours','/output-000.log','bot-',',\x20must\x20be\x20a\x204\x20digit\x20number','Starting\x20Balance\x20Bot\x20reinstallation','secure','getPortfolio','\x20(1)','show','post','Password\x20has\x20been\x20reset\x20to:\x20','/:bot/configuration','Token\x20blacklisted','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','temporary\x20access\x20timeout','bbvReceive','config/','referer','/disable\x20-\x20disable\x20notifications\x0a','bots','Login\x20accepted','init','telegram2FaApproval','logged\x20out','yargs/yargs','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','login\x20token\x20valid','All\x20bots','bb-settings.json','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','f2aRequired','\x20|\x20client:\x20...','isDirectory','started','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Alerts','bcryptjs','Failed\x20to\x20download\x20','padStart','uncaughtException','Deleted\x20Bot\x20','Crypt','type','get','access','delete-bot','length','botID','success','sendPortfolioTelegram','onepagemode','-events.json','add-bot','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','all','mode','\x1b[33m','toIPv4MappedAddress','sendMessage','find','/upload-backup',':\x20Bot\x20Mgr\x20>\x20','exit','Network\x20Interfaces:','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','4PPGJsA','build','show-config','rmSync','404\x20Not\x20Found','yes','stringify','Restarting\x20Bot\x20','statSync','constructor','login\x20token\x20generated','(((.+)+)+)+$','-results.json','All','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','telegrammsg','2FA\x20login\x20rejected','running','You\x20can\x20use\x20the\x20following\x20commands:\x0a','3000','telegramEnabled','enabled','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','number','telegram','startsWith','date-fns','User\x20has\x20been\x20validated','store-configuration','exp','connected','\x20minutes','2FA\x20login\x20required','Access\x20enabled\x20for\x20','lastmsgtelegram','full','cancelLoading','Invalid\x20Telegram\x20token','Unauthorized\x20attempt\x20to\x20delete\x20bot','SIGTERM','Markdown','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Password\x20reset\x20rejected','ipv6','getFullYear','Ok,\x20will\x20send\x20order\x20notifications\x20only','login\x20required','update-bb','hasOwnProperty','updatebotmanager','string','/:bot/history','kind','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','toString','output-001.log','reason','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','\x1b[35m','/enable\x20-\x20enable\x20notifications\x0a','staging','remoteAddress','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','952104HrwLOJ','toggleBotMode','Logged\x20out\x20user\x20...','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','settings.','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','simple','\x20only\x0a','Temporary\x20access\x20rejected','apply','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Unauthorized\x20attempt\x20to\x20update\x20bot','13670XnVDGp','HTML','alerts','bot','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','files','version','axios','orders','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','push','sendMetricsTelegram','stop','botname','backup','2FA\x20login\x20token\x20generated','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','sortBy','place-order','pidExpireLogin','exchange','latestversion','status','Unauthorized\x20attempt\x20to\x20delete\x20alerts','parse','password','Unauthorized\x20attempt\x20to\x20get\x20events','userid','placeOrder','apiSecret','data','clients','map','resetHistory','No\x20bots\x20running\x20right\x20now','slice','express','temporary\x20access\x20not\x20allowed','Restoring\x20bot(s)\x20from\x20backup','/metrics\x20-\x20show\x20bot\x20performance\x0a','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','.zip','zip/','177413KJaKzP','deleteHistoryAlerts','restore-backup-file','params','accept','loginRequired','Unauthorized\x20attempt\x20to\x20get\x20messages','messages','createWriteStream','message','use','disabled','argv','************','username','warning','store-headless','express-fileupload','telegramEvents','connection','static','getMonth','storeFiat','temporary\x20access\x20rejected','log','confirm-message','Starting\x20new\x20bot\x20|\x20Bot\x20','mkdirSync','::1','Invalid\x20username\x20or\x20IP\x20address','/:bot','reset-history','apiPassword','isIPv4MappedAddress','Login\x20rejected','Session\x20expired\x20for\x20user\x20...','socket.io','Backup\x20file\x20unzipped\x20and\x20stored','removeListener','6b67f3d61ee94b8f5c80b4affef4c4d9','bbUsername','103370AHxMIQ','mtime','/status\x20-\x20show\x20bot(s)\x20status\x0a','pidRefreshToken','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','join','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Unauthorized\x20login\x20attempt\x20(timeout)','lastmsgemitted','error','forEach','getTime','/:bot/support','get-messages','write','update','blacklist','name','delete-alerts','backup-files','includes','hybrid-crypto-js','stopPolling','env','build2','handshake','-performance.json','generateKeyPairAsync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','\x1b[0m','catch','output-003.log','chat','bb-secure.json','server','Unauthorized\x20attempt\x20to\x20show\x20configuration','botmanager','Restore\x20backup\x20file\x20','reinstall','telegramUsername','node','index.html','sort','new','IPv4','654NisNav','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','fork','getMinutes','filter','listen','store-fiat','Notifications\x20disabled','\x1b[34m','9830dHGHjc','temporaryAccessAllowed','Node.js\x20v','onText','title','internal','privateKey','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Invalid\x20IP\x20address','debug','readFileSync','assign','range','Notifications\x20disabled\x0a','notification','sockets','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','toIPv4Address','login','uuid','binary'];_0x1375=function(){return _0x266d58;};return _0x1375();}function addBlacklist(_0x7367c4){const _0x1d6e22=_0x4b0ff4;cleanBlacklist();let _0x1bed1e;devices[_0x7367c4][_0x1d6e22(0x1a2)]?_0x1bed1e=Math[_0x1d6e22(0x210)](devices[_0x7367c4][_0x1d6e22(0x1a2)][_0x1d6e22(0x17a)],loginExpiry):_0x1bed1e=loginExpiry,dbSecure['get'](_0x1d6e22(0x30b))[_0x1d6e22(0x2b0)]({'expiry':new Date()[_0x1d6e22(0x306)]()+_0x1bed1e*0x3c*0x3e8,'token':devices[_0x7367c4][_0x1d6e22(0x245)][_0x1d6e22(0x1d3)]})['write'](),blacklist=dbSecure['get'](_0x1d6e22(0x30b))[_0x1d6e22(0x172)]();}function cleanBlacklist(){const _0x54f909=_0x4b0ff4;let _0x4d705e=dbSecure[_0x54f909(0x244)]('blacklist')['cloneDeep']()[_0x54f909(0x172)](),_0x11d343=new Date()[_0x54f909(0x306)]();_0x4d705e[_0x54f909(0x305)](_0xade281=>{const _0x5e38b9=_0x54f909;_0xade281['expiry']<_0x11d343&&dbSecure[_0x5e38b9(0x244)]('blacklist')['remove']({'expiry':_0xade281[_0x5e38b9(0x17a)]})['write']();});}function initStates(){const _0x151238=_0x4b0ff4;let _0x102193=getConfiguration();_0x102193[_0x151238(0x305)](_0x2a9375=>{const _0x255898=_0x151238;_0x2a9375['live']=_0x255898(0x1b3);}),storeConfiguration(_0x102193);}function onKeys(){const _0x5d98a6=new RSA();return new Promise(_0x10cb7e=>{const _0x2f4ebf=_0x4eba;_0x5d98a6[_0x2f4ebf(0x316)]()[_0x2f4ebf(0x1ff)](_0x36e75b=>{_0x10cb7e(_0x36e75b);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x527152=_0x4b0ff4;let _0x5c50b6=getSettings(),_0x1dba8c=![];!_0x5c50b6['hasOwnProperty'](_0x527152(0x27d))&&(_0x5c50b6['lastmsgtelegram']=0x0,_0x1dba8c=!![]);!_0x5c50b6['hasOwnProperty']('lastmsgemitted')&&(_0x5c50b6[_0x527152(0x303)]=0x0,_0x1dba8c=!![]);!_0x5c50b6[_0x527152(0x28b)]('latestversion')&&(_0x5c50b6[_0x527152(0x2bb)]=_0x527152(0x185),_0x1dba8c=!![]);!_0x5c50b6['hasOwnProperty'](_0x527152(0x24b))&&(_0x5c50b6[_0x527152(0x24b)]=![],_0x1dba8c=!![]);if(_0x1dba8c)storeSettings(_0x5c50b6);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x527152(0x305)](_0x44651d=>{const _0x2dca12=_0x527152;if(!_0x44651d[_0x2dca12(0x239)]()){if(!_0x44651d['name']['startsWith'](_0x2dca12(0x201)))fs[_0x2dca12(0x18d)](configbackuppath+_0x44651d[_0x2dca12(0x30c)]);}else fs[_0x2dca12(0x25d)](configbackuppath+_0x44651d[_0x2dca12(0x30c)],{'recursive':!![]});});}catch(_0xe1da89){logger[_0x527152(0x33c)]('Error\x20removing\x20old\x20backup\x20files:',_0xe1da89);}}function storeConfiguration(_0x2b503e){const _0x30bb9b=_0x4b0ff4;dbConfig[_0x30bb9b(0x244)](_0x30bb9b(0x22c))[_0x30bb9b(0x1c9)]()['write'](),_0x2b503e['forEach'](_0x2fc22a=>{const _0x2064aa=_0x30bb9b;delete _0x2fc22a[_0x2064aa(0x250)];}),dbConfig[_0x30bb9b(0x244)]('bots')[_0x30bb9b(0x2b0)](..._0x2b503e)['write'](),config=_0x2b503e;}function resetPassword(){const _0x3ceb78=_0x4b0ff4;tgBot&&settings[_0x3ceb78(0x1af)]&&(tgBot['removeListener'](_0x3ceb78(0x20e)),tgBot[_0x3ceb78(0x253)](settings['telegramChatId'],_0x3ceb78(0x33a),{'parse_mode':_0x3ceb78(0x2a7),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3ceb78(0x25f)},{'text':'no','callback_data':'no'}]]}})['catch'](_0xa475f=>{telegramError(_0xa475f);}),tgBot['on'](_0x3ceb78(0x20e),async _0x953da2=>{const _0x56b011=_0x3ceb78,_0x3fb7e0=_0x953da2['data'],_0x148ead=_0x953da2['message'];tgBot[_0x56b011(0x1a3)](_0x953da2['id'])['then'](async()=>{const _0x3eb3f6=_0x56b011;if(_0x3fb7e0!='no'){const _0x3ca221=0xf,_0x5c8129=_0x3eb3f6(0x2af),_0x2c8eb2=Array[_0x3eb3f6(0x161)](crypto[_0x3eb3f6(0x1ae)](new Uint32Array(_0x3ca221)))[_0x3eb3f6(0x2c6)](_0x43ce7c=>_0x5c8129[_0x43ce7c%_0x5c8129[_0x3eb3f6(0x247)]])[_0x3eb3f6(0x2ff)](''),_0x2d4619=bcrypt[_0x3eb3f6(0x208)](_0x2c8eb2,saltRounds);storeSettings({'bbPassword':_0x2d4619}),await tgBot[_0x3eb3f6(0x253)](_0x148ead[_0x3eb3f6(0x31b)]['id'],_0x3eb3f6(0x223)+_0x2c8eb2,{'parse_mode':_0x3eb3f6(0x2a7)})[_0x3eb3f6(0x319)](_0x5ace4c=>{telegramError(_0x5ace4c);});}else await tgBot[_0x3eb3f6(0x253)](_0x148ead[_0x3eb3f6(0x31b)]['id'],_0x3eb3f6(0x285))[_0x3eb3f6(0x319)](_0x161fd0=>{telegramError(_0x161fd0);});}),tgBot[_0x56b011(0x2f7)](_0x56b011(0x20e));}));}async function confirmRestore(_0x75fbd1,_0x193797){const _0xfce40f=_0x4b0ff4;io['to']('botmanager')[_0xfce40f(0x1f2)](_0xfce40f(0x341),_0xfce40f(0x1cc),_0xfce40f(0x249)),tgBot&&settings[_0xfce40f(0x1af)]&&(tgBot[_0xfce40f(0x2f7)](_0xfce40f(0x20e)),await tgBot[_0xfce40f(0x253)](settings[_0xfce40f(0x1af)],_0xfce40f(0x343),{'parse_mode':_0xfce40f(0x2a7),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0xfce40f(0x25f)},{'text':'no','callback_data':'no'}]]}})[_0xfce40f(0x319)](_0x24a59a=>{telegramError(_0x24a59a);}),tgBot['on']('callback_query',async _0x26e514=>{const _0x4f44e4=_0xfce40f,_0x480cb9=_0x26e514[_0x4f44e4(0x2c4)],_0x973a77=_0x26e514[_0x4f44e4(0x2da)];tgBot[_0x4f44e4(0x1a3)](_0x26e514['id'])[_0x4f44e4(0x1ff)](async()=>{const _0x1281a5=_0x4f44e4;_0x480cb9==_0x1281a5(0x25f)?(await tgBot[_0x1281a5(0x253)](_0x973a77[_0x1281a5(0x31b)]['id'],_0x1281a5(0x2cc),{'parse_mode':_0x1281a5(0x2a7)})[_0x1281a5(0x319)](_0x849b25=>{telegramError(_0x849b25);}),unzipFile(_0x75fbd1,_0x193797)):(logger[_0x1281a5(0x33c)](_0x1281a5(0x1c0)),await tgBot[_0x1281a5(0x253)](_0x973a77['chat']['id'],_0x1281a5(0x1c0))[_0x1281a5(0x319)](_0x68f56d=>{telegramError(_0x68f56d);}));}),tgBot[_0x4f44e4(0x2f7)](_0x4f44e4(0x20e));}));}function getServerTime(){const _0x32e4ff=_0x4b0ff4,_0x30050e=new Date();return _0x30050e['getFullYear']()+'/'+(_0x30050e[_0x32e4ff(0x2e6)]()+0x1)[_0x32e4ff(0x291)]()[_0x32e4ff(0x23f)](0x2,'0')+'/'+_0x30050e['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x30050e[_0x32e4ff(0x219)]()['toString']()[_0x32e4ff(0x23f)](0x2,'0')+':'+_0x30050e['getMinutes']()['toString']()[_0x32e4ff(0x23f)](0x2,'0')+':'+_0x30050e['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x553d64=_0x4b0ff4,_0x27493a=shiftedTime();return _0x27493a[_0x553d64(0x287)]()+'/'+(_0x27493a['getMonth']()+0x1)[_0x553d64(0x291)]()[_0x553d64(0x23f)](0x2,'0')+'/'+_0x27493a['getDate']()[_0x553d64(0x291)]()[_0x553d64(0x23f)](0x2,'0')+'\x20'+_0x27493a[_0x553d64(0x219)]()[_0x553d64(0x291)]()['padStart'](0x2,'0')+':'+_0x27493a[_0x553d64(0x32b)]()[_0x553d64(0x291)]()[_0x553d64(0x23f)](0x2,'0')+':'+_0x27493a['getSeconds']()[_0x553d64(0x291)]()[_0x553d64(0x23f)](0x2,'0');}function getCleanTimeStamp(){const _0x107135=_0x4b0ff4,_0x3d5f2b=shiftedTime();return _0x3d5f2b['getFullYear']()+(_0x3d5f2b['getMonth']()+0x1)[_0x107135(0x291)]()[_0x107135(0x23f)](0x2,'0')+_0x3d5f2b['getDate']()['toString']()[_0x107135(0x23f)](0x2,'0')+'-'+_0x3d5f2b[_0x107135(0x219)]()['toString']()['padStart'](0x2,'0')+_0x3d5f2b[_0x107135(0x32b)]()['toString']()['padStart'](0x2,'0')+_0x3d5f2b[_0x107135(0x174)]()[_0x107135(0x291)]()[_0x107135(0x23f)](0x2,'0');}function shiftedTime(){const _0x57b8ba=_0x4b0ff4,_0x27eec9=new Date();let _0x2b1182=_0x27eec9;if(settings[_0x57b8ba(0x191)]&&settings['timeshift']!==0x0)_0x2b1182=fns[_0x57b8ba(0x1e4)](_0x27eec9,{'hours':settings[_0x57b8ba(0x191)]});return _0x2b1182;}function startScheduler(){const _0x1ba384=_0x4b0ff4,_0x22a9bc=new Date()[_0x1ba384(0x173)](),_0xa32974=shiftedTime()['getHours']();_0xa32974==0x4&&backupConfigFiles();_0xa32974==0x0&&rotateLogFiles();_0x22a9bc%0x6==0x0&&triggerAnalytics();_0x22a9bc%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1e9cc3){const _0x5a3b5a=_0x4b0ff4;logger[_0x5a3b5a(0x33c)](_0x5a3b5a(0x320)+_0x1e9cc3);const _0x533c8c=getBotsWithMode();_0x533c8c[_0x5a3b5a(0x247)]>0x0?confirmRestore(configbackuppath,_0x1e9cc3):unzipFile(configbackuppath,_0x1e9cc3);}async function getBackupFiles(_0x3a59a7=null){const _0x2d1111=_0x4b0ff4;let _0x58a79b=[],_0x557bcb=fs[_0x2d1111(0x204)](configbackuppath,{'withFileTypes':!![]});_0x557bcb[_0x2d1111(0x325)]((_0x3123eb,_0x3df301)=>_0x3123eb['name']<_0x3df301[_0x2d1111(0x30c)]?0x1:_0x3df301[_0x2d1111(0x30c)]<_0x3123eb[_0x2d1111(0x30c)]?-0x1:0x0),_0x557bcb[_0x2d1111(0x305)](_0x237b58=>{const _0x5dd6af=_0x2d1111;if(!_0x237b58[_0x5dd6af(0x239)]()&&_0x237b58[_0x5dd6af(0x30c)]['startsWith']('backup-full@')&&_0x237b58[_0x5dd6af(0x30c)][_0x5dd6af(0x16c)](_0x5dd6af(0x2cf))){const _0x29e2dc=formatDate(fs[_0x5dd6af(0x262)](configbackuppath+_0x237b58[_0x5dd6af(0x30c)])[_0x5dd6af(0x2fb)]);_0x58a79b[_0x5dd6af(0x2b0)]({'name':_0x237b58['name'],'mtime':_0x29e2dc});}});if(_0x3a59a7)io['to'](_0x3a59a7)[_0x2d1111(0x1f2)](_0x2d1111(0x30e),_0x58a79b);else return _0x58a79b;}async function backupConfigFiles(){const _0x5297d9=_0x4b0ff4;await zipFiles(_0x5297d9(0x1a1));const _0x5c5c39=getCleanTimeStamp();fs[_0x5297d9(0x202)](zippath+_0x5297d9(0x183),configbackuppath+(_0x5297d9(0x201)+_0x5c5c39+'.zip'));let _0xd10cd3=fs[_0x5297d9(0x204)](configbackuppath,{'withFileTypes':!![]});_0xd10cd3[_0x5297d9(0x325)]((_0x2eae08,_0x41f9cc)=>_0x2eae08['name']<_0x41f9cc['name']?0x1:_0x41f9cc[_0x5297d9(0x30c)]<_0x2eae08[_0x5297d9(0x30c)]?-0x1:0x0),_0xd10cd3[_0x5297d9(0x247)]>maxBackups&&fs[_0x5297d9(0x18d)](configbackuppath+_0xd10cd3[_0xd10cd3['length']-0x1][_0x5297d9(0x30c)]);}function rotateLogFiles(){const _0x2b6fea=_0x4b0ff4,_0x74979d=fs[_0x2b6fea(0x262)](logspath+_0x2b6fea(0x1eb)),_0x30c8cd=_0x74979d[_0x2b6fea(0x1ed)]/0x400;if(_0x30c8cd>0x64){let _0x47711a=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x47711a[_0x2b6fea(0x325)]((_0x32d243,_0x111dda)=>_0x32d243[_0x2b6fea(0x30c)]<_0x111dda[_0x2b6fea(0x30c)]?0x1:_0x111dda[_0x2b6fea(0x30c)]<_0x32d243[_0x2b6fea(0x30c)]?-0x1:0x0),_0x47711a[_0x2b6fea(0x305)](_0x371c95=>{const _0x49ed12=_0x2b6fea;if(_0x371c95[_0x49ed12(0x30c)]==_0x49ed12(0x170))fs[_0x49ed12(0x202)](logspath+_0x371c95[_0x49ed12(0x30c)],logspath+_0x49ed12(0x31a));if(_0x371c95[_0x49ed12(0x30c)]=='output-001.log')fs[_0x49ed12(0x202)](logspath+_0x371c95[_0x49ed12(0x30c)],logspath+_0x49ed12(0x170));_0x371c95[_0x49ed12(0x30c)]==_0x49ed12(0x1eb)&&(fs[_0x49ed12(0x202)](logspath+_0x371c95[_0x49ed12(0x30c)],logspath+_0x49ed12(0x292)),fs[_0x49ed12(0x1e7)](logspath+_0x371c95[_0x49ed12(0x30c)],''));});}}async function zipFiles(_0x5b729e){const _0xabdbfd=_0x4b0ff4;let _0x186770;if(_0x5b729e=='logs')_0x186770=logspath;if(_0x5b729e==_0xabdbfd(0x2b4))_0x186770=configpath;if(_0x5b729e==_0xabdbfd(0x1a1))_0x186770=configpath;let _0x43e457=fs[_0xabdbfd(0x204)](_0x186770,{'withFileTypes':!![]});const _0x15e98b=new require('node-zip')();_0x43e457[_0xabdbfd(0x305)](_0x44d0d1=>{const _0x4c3294=_0xabdbfd;if(!_0x44d0d1[_0x4c3294(0x239)]()){let _0x49cb96=fs['readFileSync'](_0x186770+_0x44d0d1[_0x4c3294(0x30c)]);if(_0x5b729e=='backup'){const _0x5821ce=/^bot-[0-9]{3}-config.json$/,_0x11ad5f=_0x5821ce[_0x4c3294(0x15c)](_0x44d0d1[_0x4c3294(0x30c)]);if(_0x11ad5f){const _0x4bf5f0=JSON[_0x4c3294(0x2be)](_0x49cb96);if(_0x4bf5f0[_0x4c3294(0x2a9)][0x0]){_0x4bf5f0[_0x4c3294(0x2a9)][0x0][_0x4c3294(0x214)]=_0x4c3294(0x162),_0x4bf5f0[_0x4c3294(0x2a9)][0x0][_0x4c3294(0x2c3)]='***';if(_0x4bf5f0[_0x4c3294(0x2a9)][0x0]['apiPassword'])_0x4bf5f0[_0x4c3294(0x2a9)][0x0][_0x4c3294(0x2f1)]=_0x4c3294(0x162);}_0x49cb96=JSON[_0x4c3294(0x260)](_0x4bf5f0,null,0x2);}if(_0x44d0d1[_0x4c3294(0x30c)]==_0x4c3294(0x235)){const _0x5cd643=JSON[_0x4c3294(0x2be)](_0x49cb96);if(_0x5cd643[_0x4c3294(0x1fa)][_0x4c3294(0x2d6)])_0x5cd643[_0x4c3294(0x1fa)][_0x4c3294(0x2d6)]=![];if(_0x5cd643[_0x4c3294(0x1fa)]['bbPassword'])_0x5cd643[_0x4c3294(0x1fa)][_0x4c3294(0x1ee)]='***';if(_0x5cd643['settings'][_0x4c3294(0x195)])_0x5cd643['settings'][_0x4c3294(0x195)]=_0x4c3294(0x162);if(_0x5cd643[_0x4c3294(0x1fa)][_0x4c3294(0x1af)])_0x5cd643[_0x4c3294(0x1fa)][_0x4c3294(0x1af)]=null;_0x49cb96=JSON[_0x4c3294(0x260)](_0x5cd643,null,0x2);}if(_0x44d0d1[_0x4c3294(0x30c)]!=_0x4c3294(0x31c))_0x15e98b[_0x4c3294(0x1fb)](_0x44d0d1[_0x4c3294(0x30c)],_0x49cb96);}else _0x15e98b[_0x4c3294(0x1fb)](_0x44d0d1[_0x4c3294(0x30c)],_0x49cb96);}});const _0x5dd4cd=_0x15e98b['generate']({'base64':![],'compression':'DEFLATE'});fs[_0xabdbfd(0x1e7)](zippath+(_0x5b729e+_0xabdbfd(0x2cf)),_0x5dd4cd,_0xabdbfd(0x15b));}async function unzipFile(_0x305d48,_0x231fbb){const _0x4534d6=_0x4b0ff4;fs[_0x4534d6(0x204)](configpath,{'withFileTypes':!![]})['forEach'](_0x34f55b=>{const _0x1b9eb9=_0x4534d6;if(!_0x34f55b[_0x1b9eb9(0x239)]())fs[_0x1b9eb9(0x25d)](configpath+_0x34f55b[_0x1b9eb9(0x30c)]);});const _0x5aac24=fs['readFileSync'](_0x305d48+_0x231fbb,_0x4534d6(0x15b)),_0x446362=new require('node-zip')(_0x5aac24,{'base64':![],'checkCRC32':!![]});Object[_0x4534d6(0x20b)](_0x446362[_0x4534d6(0x2ab)])['forEach'](_0x555614=>{const _0x54f2dc=_0x4534d6,_0x2a8c0c=_0x446362['files'][_0x555614];fs[_0x54f2dc(0x1e7)](configpath+_0x2a8c0c['name'],_0x2a8c0c['_data']);}),fs[_0x4534d6(0x204)](temppath,{'withFileTypes':!![]})[_0x4534d6(0x305)](_0x31e00d=>{const _0x1f1df7=_0x4534d6;if(!_0x31e00d[_0x1f1df7(0x239)]())fs['rmSync'](temppath+_0x31e00d[_0x1f1df7(0x30c)]);}),logger[_0x4534d6(0x33c)](_0x4534d6(0x2f6)),process[_0x4534d6(0x184)]({'restore':!![]},_0x115931=>{});}async function getPublicIp(){const _0x4e1f94=_0x4b0ff4;try{const _0x2229d0=await axios[_0x4e1f94(0x244)]('https://api.ipify.org?format=json');publicip=_0x2229d0[_0x4e1f94(0x2c4)]['ip'];}catch(_0x343523){}}async function triggerAnalytics(){const _0x55282a=_0x4b0ff4;if(!publicip)await getPublicIp();const _0x33094a=getBotsWithMode();let _0x168052=0x0;_0x33094a[_0x55282a(0x305)](_0x2cbc4e=>{const _0x3af00e=_0x55282a;if(_0x2cbc4e[_0x3af00e(0x2bc)]===_0x3af00e(0x26f))_0x168052++;});const _0x169478=getBotExchanges();mixpanel['track'](_0x55282a(0x17c),{'distinct_id':settings[_0x55282a(0x2c1)],'ip':publicip,'version':serverversion,'numbots':_0x33094a[_0x55282a(0x247)],'numbotsenabled':_0x168052,'exchanges':_0x169478,'environment':environment});}async function getMessages(){const _0xcf463=_0x4b0ff4,_0x352af6=_0xcf463(0x2a4),_0x50c347=new GraphQLClient(_0x352af6),_0x1a87fe={'authorization':_0xcf463(0x259)},_0xdb7c1c=serverversion[_0xcf463(0x17f)]('.'),_0x3057f8=_0xdb7c1c[0x0]+'.'+_0xdb7c1c[0x1],_0x53d49f=Math[_0xcf463(0x198)](settings[_0xcf463(0x27d)],settings['lastmsgemitted']),_0x25e663={'last':parseInt(_0x53d49f),'bbm':_0x3057f8},_0x3e3f5d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x243a39;try{_0x243a39=await _0x50c347['request'](_0x3e3f5d,_0x25e663,_0x1a87fe);}catch(_0x785217){}if(_0x243a39&&_0x243a39[_0xcf463(0x2d8)]){let _0x47c030=settings[_0xcf463(0x27d)];newMessages=[];for(const _0x292bb0 of _0x243a39[_0xcf463(0x2d8)]){newMessages['push'](_0x292bb0);let _0x10e0d7=![];_0x292bb0[_0xcf463(0x167)]&&(updateSetting(_0xcf463(0x2bb),_0x292bb0[_0xcf463(0x167)]),_0x10e0d7=isNewerVersion(serverversion,_0x292bb0[_0xcf463(0x167)])||serverversion==_0x292bb0[_0xcf463(0x167)]);if(!_0x10e0d7&&_0x292bb0[_0xcf463(0x272)]>_0x47c030){if(_0x292bb0[_0xcf463(0x228)]===_0xcf463(0x1c2)||serverversion[_0xcf463(0x274)](_0x292bb0[_0xcf463(0x228)])){let _0x1ad975=''+_0x292bb0[_0xcf463(0x335)]+'\x0a\x0a'+_0x292bb0['message'];const _0x1adf96=await sendTelegramMsg(toTelegramMarkdown(_0x1ad975),_0xcf463(0x283));if(_0x1adf96)_0x47c030=_0x292bb0[_0xcf463(0x272)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0xcf463(0x27d),_0x47c030),emitMessages();}}function emitMessages(){const _0xfe7ac1=_0x4b0ff4,_0x493e7d=settings[_0xfe7ac1(0x303)];let _0x314a0f=[];newMessages[_0xfe7ac1(0x305)](_0x5101e9=>{const _0xd1be68=_0xfe7ac1;_0x5101e9[_0xd1be68(0x272)]>_0x493e7d&&_0x314a0f['push'](_0x5101e9);}),_0x314a0f[_0xfe7ac1(0x247)]>0x0&&getAllClients()[_0xfe7ac1(0x305)](_0x231fc9=>{const _0x3b74d9=_0xfe7ac1;getSocket(_0x231fc9['id'])['emit'](_0x3b74d9(0x2da),_0x314a0f);});}function confirmMessage(_0x39915c){const _0x3b9dc7=_0x4b0ff4;updateSetting(_0x3b9dc7(0x303),Number(_0x39915c));}function isNewerVersion(_0x3e03be,_0x422866){const _0x1aac3e=_0x4b0ff4,_0x1f3d95=_0x422866[_0x1aac3e(0x17f)]('.'),_0xe624c=_0x3e03be[_0x1aac3e(0x17f)]('.');for(var _0x4741a0=0x0;_0x4741a0<_0xe624c['length'];_0x4741a0++){const _0x3bec4f=~~_0xe624c[_0x4741a0],_0x35cda4=~~_0x1f3d95[_0x4741a0];if(_0x3bec4f>_0x35cda4)return!![];if(_0x3bec4f<_0x35cda4)return![];}return![];}function toTelegramMarkdown(_0x1e54fe){const _0x32e59d=_0x4b0ff4,_0x11a39a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x517f1c=/\*{2}(.+?)\*{2}/gim;return _0x1e54fe=_0x1e54fe[_0x32e59d(0x207)](_0x11a39a,_0x32e59d(0x1f6))[_0x32e59d(0x207)](_0x517f1c,'*$1*'),_0x1e54fe;}async function validateConfigFile(){const _0x410072=_0x4b0ff4,_0x581ae0=dbConfig['get'](_0x410072(0x22c))[_0x410072(0x2b7)](_0x410072(0x248))[_0x410072(0x172)]()||[];if(_0x581ae0['length']==0x0){let _0xff6556=0x0,_0x41864f=[];const _0x2861dd=/^bot-([0-9]{3})-config.json$/,_0x361671=fs[_0x410072(0x204)](configpath);_0x361671[_0x410072(0x305)](_0x513d63=>{const _0x103535=_0x410072,_0x4774e1=_0x2861dd[_0x103535(0x1ba)](_0x513d63);if(_0x4774e1){const _0x216c42=_0x4774e1[0x1];let _0x3a75bf=getBotAttributes(_0x216c42);_0x41864f[_0x103535(0x2b0)]({'botID':_0x216c42,'botname':_0x3a75bf[_0x103535(0x2b3)],'status':_0x103535(0x2dc),'live':'stopped'}),_0xff6556++;}}),_0xff6556!=0x0&&(dbConfig[_0x410072(0x244)](_0x410072(0x22c))[_0x410072(0x33e)](_0x41864f)[_0x410072(0x309)](),config=_0x41864f,restoredConfigFile=_0xff6556);}}async function restoreConfigNotify(_0x23bb9a){const _0x1dd506=_0x4b0ff4;let _0x531cb3;if(restoredConfigFile==0x1)_0x531cb3=_0x1dd506(0x1f8);else _0x531cb3=_0x1dd506(0x232);if(_0x23bb9a)io['to'](_0x1dd506(0x31f))['emit'](_0x1dd506(0x341),_0x531cb3);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x1dd506(0x2a0)](_0x531cb3),logger[_0x1dd506(0x2a0)](_0x1dd506(0x1bb)),logger['simple']('');if(tgBot&&settings[_0x1dd506(0x1af)]&&settings[_0x1dd506(0x2e3)]!='orders')tgBot[_0x1dd506(0x253)](settings[_0x1dd506(0x1af)],_0x1dd506(0x15d)+_0x531cb3)[_0x1dd506(0x319)](_0x507e32=>{telegramError(_0x507e32);});}}function validateCredentials(_0x321546,_0x1833ce){const _0x12ac51=_0x4b0ff4;if(_0x321546[_0x12ac51(0x2df)]==settings['bbUsername']&&bcrypt[_0x12ac51(0x216)](_0x321546[_0x12ac51(0x2bf)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x12ac51(0x27b),'token':null};else{const _0x5a0d46=generateLoginToken(_0x1833ce);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5a0d46};}}else return{'allow':![],'reason':_0x12ac51(0x1c1),'token':null};}function refreshToken(_0x432ebb){const _0xbf069a=_0x4b0ff4,_0x411675=generateLoginToken(_0x432ebb);return{'allow':!![],'reason':_0xbf069a(0x264),'token':_0x411675};}function validateAccess(_0x5e059e,_0x27f786,_0xe3ebe1){const _0x377826=_0x4b0ff4,_0x61ee8d=_0xe3ebe1?_0xe3ebe1:devices[_0x27f786]['ip'];let _0x4b8d2e;const _0x354cbd=_0x2e27be=>{const _0x9c7caf=_0x4eba;if(settings[_0x9c7caf(0x2d6)]){if(settings[_0x9c7caf(0x237)]){if(telegram2FaApproved(_0x27f786)){const _0x18fb41=generateLoginToken(_0x27f786);return{'allow':!![],'reason':_0x9c7caf(0x2b5),'token':_0x18fb41};}else return{'allow':![],'reason':_0x9c7caf(0x289),'token':null};}else return _0x4b8d2e=validToken(_0x2e27be,_0x27f786),_0x4b8d2e[_0x9c7caf(0x28b)]('success')?{'allow':!![],'reason':_0x9c7caf(0x233),'token':_0x2e27be}:{'allow':![],'reason':_0x9c7caf(0x289),'token':null};}else return{'allow':!![],'reason':_0x9c7caf(0x1ef),'token':null};};if(settings['whitelistEnabled']){let _0x31f758=[...settings[_0x377826(0x1b5)],_0x377826(0x2ed),_0x377826(0x180),'127.0.0.1'];if(_0x31f758[_0x377826(0x30f)](_0x61ee8d))return _0x354cbd(_0x5e059e);else{_0x4b8d2e=validToken(_0x5e059e,_0x27f786);if(_0x4b8d2e[_0x377826(0x28b)]('success'))return _0x354cbd(_0x5e059e);else{if(telegramIpApproved(_0x27f786)){const _0x1ba6c3=generateToken(_0x27f786);return _0x4b8d2e=_0x354cbd(_0x5e059e),_0x4b8d2e[_0x377826(0x19e)]?{'allow':!![],'reason':_0x377826(0x1cb),'token':_0x1ba6c3}:_0x4b8d2e;}else return settings[_0x377826(0x332)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x377826(0x2cb),'token':null};}}}else return _0x354cbd(_0x5e059e);}function timelyDecrypt(_0x174a0e,_0x2d0b49=!![]){const _0x487016=_0x4b0ff4;if(_0x174a0e)try{const _0x2539f8=crypt[_0x487016(0x1f3)](secure[_0x487016(0x337)],_0x174a0e)['message'],_0x5a5f07=_0x2539f8[_0x487016(0x17f)]('@')[0x0],_0x5ce065=_0x2539f8['split']('@')[0x1],_0x10de20=new Date()['getTime']();if(_0x2d0b49){if(_0x10de20-_0x5ce065<maxSecretAge*0x3e8)return _0x5a5f07;else return![];}else return _0x5a5f07;}catch(_0x110bb9){return![];}else return![];}const validToken=(_0xde034a,_0x2c8e79)=>{const _0x1c0d3c=_0x4b0ff4,_0xfa6b82=devices[_0x2c8e79]['ip'];if(!_0xde034a)return{'error':'No\x20authentication\x20token'};for(let _0x111fa7 of blacklist){if(_0x111fa7[_0x1c0d3c(0x1d3)]==_0xde034a)return{'error':_0x1c0d3c(0x225)};}let _0x25d525;try{_0x25d525=jwt['verify'](_0xde034a,secure[_0x1c0d3c(0x1f5)]+_0x2c8e79);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x25d525['hasOwnProperty']('clientip')&&!_0x25d525['hasOwnProperty'](_0x1c0d3c(0x2df))||!_0x25d525[_0x1c0d3c(0x28b)](_0x1c0d3c(0x278)))return{'error':_0x1c0d3c(0x1fe)};if(!_0x25d525[_0x1c0d3c(0x28b)](_0x1c0d3c(0x2df))&&_0x25d525[_0x1c0d3c(0x28b)]('clientip')){const {clientip:_0x446d0b}=_0x25d525;return _0xfa6b82==_0x446d0b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1c0d3c(0x33b)};}else{if(_0x25d525[_0x1c0d3c(0x28b)](_0x1c0d3c(0x2df))&&_0x25d525[_0x1c0d3c(0x28b)](_0x1c0d3c(0x1c3))){const {username:_0x1212e8,clientip:_0x1e56c3}=_0x25d525;return settings[_0x1c0d3c(0x2f9)]==_0x1212e8&&_0xfa6b82==_0x1e56c3?{'success':_0x1c0d3c(0x276)}:{'error':_0x1c0d3c(0x2ee)};}}},generateLoginToken=_0x583461=>{const _0x101e22=_0x4b0ff4;if(_0x583461){const _0x874fd7=devices[_0x583461]['ip'];return jwt[_0x101e22(0x1e6)]({'username':settings[_0x101e22(0x2f9)],'clientip':_0x874fd7},secure['secret']+_0x583461,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5c51cf=>{const _0xdbdbde=_0x4b0ff4;if(_0x5c51cf){const _0x3b0b8f=devices[_0x5c51cf]['ip'];return jwt[_0xdbdbde(0x1e6)]({'clientip':_0x3b0b8f},secure[_0xdbdbde(0x1f5)]+_0x5c51cf,{'expiresIn':devices[_0x5c51cf][_0xdbdbde(0x1a2)][_0xdbdbde(0x17a)]*0x3c});}else return![];},telegramIpApproved=_0x4453fb=>{const _0x380144=_0x4b0ff4;let _0x315bc1=![];return devices[_0x4453fb][_0x380144(0x1a2)]&&devices[_0x4453fb]['telegramIpApproval'][_0x380144(0x17a)]!=_0x380144(0x1ac)&&(_0x315bc1=devices[_0x4453fb]['telegramIpApproval'][_0x380144(0x1c3)]==devices[_0x4453fb]['ip']&&new Date()['getTime']()-devices[_0x4453fb][_0x380144(0x1a2)]['timestamp']<devices[_0x4453fb]['telegramIpApproval'][_0x380144(0x17a)]*0x3c*0x3e8),_0x315bc1;},telegram2FaApproved=_0x4b75fe=>{const _0x3bb5d7=_0x4b0ff4;let _0x275b21=![];return devices[_0x4b75fe][_0x3bb5d7(0x22f)]&&devices[_0x4b75fe][_0x3bb5d7(0x22f)][_0x3bb5d7(0x17a)]!=_0x3bb5d7(0x1ac)&&(_0x275b21=devices[_0x4b75fe][_0x3bb5d7(0x22f)][_0x3bb5d7(0x1c3)]==devices[_0x4b75fe]['ip']&&new Date()['getTime']()-devices[_0x4b75fe][_0x3bb5d7(0x22f)][_0x3bb5d7(0x1da)]<devices[_0x4b75fe][_0x3bb5d7(0x22f)][_0x3bb5d7(0x17a)]*0x3c*0x3e8),_0x275b21;},normalizeIP=_0x2ccbd2=>{const _0x59f647=_0x4b0ff4;let _0x3ec491=null,_0x583d37=null;if(ipaddr[_0x59f647(0x16a)](_0x2ccbd2)){const _0x408f50=ipaddr[_0x59f647(0x2be)](_0x2ccbd2);_0x408f50[_0x59f647(0x28f)]()===_0x59f647(0x286)?(_0x408f50[_0x59f647(0x2f2)]()&&(_0x3ec491=_0x408f50[_0x59f647(0x344)]()[_0x59f647(0x291)]()),_0x583d37=_0x408f50['toString']()):(_0x3ec491=_0x408f50[_0x59f647(0x291)](),_0x583d37=_0x408f50[_0x59f647(0x252)]()[_0x59f647(0x291)]());}return{'show':_0x3ec491?_0x3ec491:_0x583d37,'store':_0x583d37};};function formatDate(_0x2b529a){const _0x724bd3=_0x4b0ff4;return _0x2b529a[_0x724bd3(0x287)]()+'/'+(_0x2b529a[_0x724bd3(0x2e6)]()+0x1)[_0x724bd3(0x291)]()[_0x724bd3(0x23f)](0x2,'0')+'/'+_0x2b529a[_0x724bd3(0x1aa)]()['toString']()[_0x724bd3(0x23f)](0x2,'0')+'\x20'+_0x2b529a[_0x724bd3(0x219)]()[_0x724bd3(0x291)]()['padStart'](0x2,'0')+':'+_0x2b529a[_0x724bd3(0x32b)]()['toString']()[_0x724bd3(0x23f)](0x2,'0')+':'+_0x2b529a[_0x724bd3(0x174)]()['toString']()[_0x724bd3(0x23f)](0x2,'0');}function sleep(_0x1e1f0f){return new Promise(_0x3fbb1b=>setTimeout(_0x3fbb1b,_0x1e1f0f));}