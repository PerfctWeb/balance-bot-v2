const _0x39fa01=_0x4860;(function(_0x3e82b8,_0x250d7c){const _0x268ab4=_0x4860,_0x1ca1da=_0x3e82b8();while(!![]){try{const _0x5c9786=-parseInt(_0x268ab4(0x231))/0x1+parseInt(_0x268ab4(0x241))/0x2+-parseInt(_0x268ab4(0x216))/0x3*(parseInt(_0x268ab4(0x2b0))/0x4)+-parseInt(_0x268ab4(0x23f))/0x5*(parseInt(_0x268ab4(0x205))/0x6)+parseInt(_0x268ab4(0x1af))/0x7*(parseInt(_0x268ab4(0x2d1))/0x8)+parseInt(_0x268ab4(0x17b))/0x9*(-parseInt(_0x268ab4(0x2a6))/0xa)+parseInt(_0x268ab4(0x1f8))/0xb*(parseInt(_0x268ab4(0x24f))/0xc);if(_0x5c9786===_0x250d7c)break;else _0x1ca1da['push'](_0x1ca1da['shift']());}catch(_0x4be11b){_0x1ca1da['push'](_0x1ca1da['shift']());}}}(_0x2719,0x45f42));const _0x275e88=function(){let _0x2fb960=!![];return function(_0x2fa75f,_0x59eaac){const _0x330bdf=_0x2fb960?function(){const _0x3c1510=_0x4860;if(_0x59eaac){const _0x5f0836=_0x59eaac[_0x3c1510(0x287)](_0x2fa75f,arguments);return _0x59eaac=null,_0x5f0836;}}:function(){};return _0x2fb960=![],_0x330bdf;};}(),_0x20d365=_0x275e88(this,function(){const _0x3e003d=_0x4860;return _0x20d365[_0x3e003d(0x254)]()[_0x3e003d(0x299)](_0x3e003d(0x180))['toString']()[_0x3e003d(0x194)](_0x20d365)[_0x3e003d(0x299)](_0x3e003d(0x180));});_0x20d365();'use strict';process[_0x39fa01(0x257)][_0x39fa01(0x198)]=0x1;const childProcess=require(_0x39fa01(0x2dc)),FileSync=require(_0x39fa01(0x2cb)),fs=require('fs'),fns=require(_0x39fa01(0x19f)),low=require(_0x39fa01(0x2b6)),path=require(_0x39fa01(0x1b1)),crypto=require('crypto'),Crypt=require(_0x39fa01(0x23c))['Crypt'],RSA=require(_0x39fa01(0x23c))['RSA'],bcrypt=require(_0x39fa01(0x1e2)),jwt=require(_0x39fa01(0x2ad)),{Analytics}=require(_0x39fa01(0x24b)),googleAnalyticsV3Plugin=require(_0x39fa01(0x20d))[_0x39fa01(0x24e)],ipaddr=require('ipaddr.js'),argv=require(_0x39fa01(0x16e))(process[_0x39fa01(0x1f3)][_0x39fa01(0x174)](0x2))[_0x39fa01(0x1f3)],uuidRandom=require(_0x39fa01(0x182)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x39fa01(0x281)),PORT=argv[_0x39fa01(0x16f)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x39fa01(0x191)](PORT)&&(console['log'](_0x39fa01(0x1a5)+PORT+_0x39fa01(0x19e)),process['exit'](0x1));const HOST=argv[_0x39fa01(0x209)]||null,userID=argv[_0x39fa01(0x270)]||'';let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x39fa01(0x1e7),securefile=_0x39fa01(0x1d1);function _0x2719(){const _0x32f17b=['write','/enable\x20-\x20enable\x20notifications\x0a','store-configuration','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','uuid','-----------------------------------------------------------------------------------','assign','Ok,\x20will\x20send\x20order\x20notifications\x20only','entries','Unauthorized\x20attempt\x20to\x20delete\x20bot','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bot-','number','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','bbUsername','length','login\x20token\x20generated','get','Password\x20has\x20been\x20reset\x20to:\x20','encryptedUuid','toIPv4MappedAddress','temporary\x20token\x20generated','toggleBotMode','auth','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','restarting\x20Bot\x20','join','clientip','bb-secure.json','deleteHistoryAlerts','from','storeHeadless','store','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','parse','show','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','2FA\x20login\x20rejected','starting\x20bot\x20|\x20Bot\x20','temporaryAccessAllowed','stopped','copyFileSync','replace','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','reset-password','bcryptjs','botmanager','placeOrder','bbvNew','args','bb-settings.json','sendMessage','expiry','writeFileSync','https://hodlerhacks.com','getDate','compareSync','Bot\x20Mgr\x20>\x20','http','onText','chat','Bot\x20','argv','HTML','disconnect','hasOwnProperty','privateKey','22YFuGOJ','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','removeListener','data','Invalid\x20authentication\x20token\x20(1)','initclient','No\x20authentication\x20token','version','\x20minutes','alerts','build','/on\x20-\x20start\x20bot(s)\x0a','login\x20token\x20valid','6nRYPdI','started','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20bot','host','bots','token','sendPortfolioTelegram','@analytics/google-analytics-v3','get-portfolio','All\x20bots','timeshift','kind','delete-alerts','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','settings.','\x20only\x0a','18FnFVTD','status','allow','-results.json','lastmsgtelegram','botID','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Ok,\x20will\x20send\x20alert\x20notifications\x20only','toggle-bot-mode','access','</b>\x20?','/disable\x20-\x20disable\x20notifications\x0a','loginRequired','<b>Balance\x20Bot\x20Status:</b>\x0a','value','::1','isValid','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','Allow\x20login\x20from\x20IP\x20address\x20<b>','stop','sockets','secure','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','server','enabled','socket.io','telegramIpApproval','365163LoXdCZ','split','callback_query','logout','enabled\x20Bot\x20','handshake','pidRefreshToken','event','reject','apiKey','kill','hybrid-crypto-js','telegram2FaApproval','padStart','1831895LKupfX','botname','982658cHesZs','readFileSync','Unauthorized\x20attempt\x20to\x20add\x20bot','whitelistEnabled','reason','exp','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','title','existsSync','Invalid\x20authentication\x20token\x20(2)','analytics','yes','whitelist','default','6651156ahMixd','getMonth','Unauthorized\x20attempt\x20to\x20log\x20out','generateKeyPairAsync','::ffff:127.0.0.1','toString','getUTCHours','set','env','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20get\x20portfolio','backup/','Login\x20rejected','getFullYear','Unauthorized\x20attempt\x20to\x20confirm\x20message','messages','telegramUsername','add-bot','place-order','randomUUID','decrypt','SIGINT','answerCallbackQuery','createServer','exit','all','defaults','Password\x20reset\x20rejected','getSeconds','User\x20has\x20been\x20validated','removeAllListeners','error\x20while\x20deleting\x20config\x20files:\x20','startsWith','user','verify','mkdirSync','-config.json','getPortfolio','Unauthorized\x20attempt\x20to\x20delete\x20alerts','send','unlinkSync','message','telegrammsg','telegramToken','lastmsgemitted','orders','log','map','sortBy','delete-bot','graphql-request','Orders','sendFile','manual','/:bot/coins','emitHistory','apply','clients','Unauthorized\x20attempt\x20to\x20get\x20messages','SIGTERM','bbvReceive','node-telegram-bot-api','userid','match','config/','conn','logged\x20out','/names\x20-\x20show\x20bot\x20names\x0a','/:bot/support','5\x20min','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','getMinutes','new','hashSync','search','2FA','All\x20bots\x20running\x20right\x20now','Invalid\x20IP\x20address','index.html','isIPv4MappedAddress','headless','new-disabled','notification','cancelLoading','login','secret','disabled','189580lVzvfN','get-logs','Notifications\x20types:\x20','idling\x20bot\x20\x20\x20|\x20Bot\x20','0.0.0','type','express','jsonwebtoken','forEach','catch','377144lbSiXT','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','/restart\x20-\x20restart\x20bot(s)\x0a','accept','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','lowdb','/:bot/portfolio','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','telegramEnabled','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20update\x20settings','1000','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Notifications\x20disabled\x0a','store-headless','-events.json','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','readdirSync','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','bbPassword','Yes','access\x20timeout','store-settings','min','push','name','lowdb/adapters/FileSync','getTime','telegram','inherit','\x20>\x20','confirm-message','8lcBAlJ','/off\x20-\x20stop\x20bot(s)\x0a','password','temporary\x20access\x20rejected','publicKey','\x20|\x20','storeConfiguration','login\x20not\x20required','bot','login\x20required','request','child_process','polling_error','error','Access\x20enabled\x20for\x20','find','includes','2FA\x20required','-performance.json','function','disabled\x20Bot\x20','Balance\x20Bot\x20Server','sha256','updatebotmanager','then','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','pidExpireLogin','yargs/yargs','port','UA-192771731-1','blacklist','connected','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','slice','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','init','Starting\x20Balance\x20Bot\x20update','restart','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','f2aRequired','9imJUlQ','latestversion','emit','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','(((.+)+)+)+$','stringify','uuid-random','reload','auto','deleted\x20Bot\x20','listen','remove','*$1*','Token\x20blacklisted','sign','Invalid\x20Telegram\x20token','15\x20min','************','timestamp','telegramChatId','showname','test','temporary\x20access\x20not\x20allowed','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','constructor','toIPv4Address','Unauthorized\x20attempt\x20to\x20get\x20logs',':\x20Bot\x20Mgr\x20>\x20','NTBA_FIX_319','version.json','username','/:bot/performance','mode','success',',\x20must\x20be\x20a\x204\x20digit\x20number','date-fns','$1_$2_$3','settings','6b67f3d61ee94b8f5c80b4affef4c4d9','stopPolling','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Error:\x20Invalid\x20argument\x20','live','telegramEvents','<b>Telegram\x20Bot\x20Status:</b>\x0a','running','build2','get-starting-balances','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','getHours','Notifications\x20disabled','20237yBSxvY','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','path','temporary\x20access\x20timeout','filter'];_0x2719=function(){return _0x32f17b;};return _0x2719();}let validInstallation=!![];!fs[_0x39fa01(0x249)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x39fa01(0x288)),configpath=userID?bbpath+_0x39fa01(0x28f)+userID+'/':bbpath+_0x39fa01(0x28f),configbackuppath=configpath+_0x39fa01(0x25a);!fs[_0x39fa01(0x249)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x39fa01(0x249)](configbackuppath)&&fs[_0x39fa01(0x272)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x39fa01(0x269)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2),adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x39fa01(0x269)]({'secure':{},'blacklist':[]})[_0x39fa01(0x1b4)]();let crypt=new Crypt({'md':_0x39fa01(0x2e7),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x39fa01(0x176)](_0x39fa01(0x1a2),{'host':'api-eu.mixpanel.com'}),analytics=Analytics({'app':'Balance\x20Bot','plugins':[googleAnalyticsV3Plugin({'trackingId':_0x39fa01(0x170)})]});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x39fa01(0x199))[_0x39fa01(0x1ff)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x39fa01(0x2ac)),app=express(),http=require(_0x39fa01(0x1ef))[_0x39fa01(0x266)](app);app['use'](express['static'](path[_0x39fa01(0x1cf)](__dirname,bbpath2,_0x39fa01(0x1aa)))),app['use'](express['static'](path['join'](__dirname,bbpath2,_0x39fa01(0x202)))),app[_0x39fa01(0x1c5)]('/',function(_0x2f70bc,_0x6a2283){const _0x315933=_0x39fa01;_0x6a2283[_0x315933(0x283)](path['join'](__dirname,bbpath2,_0x315933(0x1aa),'index.html'));}),app[_0x39fa01(0x1c5)]('/:bot',function(_0x45cffc,_0x145e1b){const _0x2821ce=_0x39fa01;_0x145e1b[_0x2821ce(0x283)](path[_0x2821ce(0x1cf)](__dirname,bbpath2,_0x2821ce(0x202),_0x2821ce(0x29d)));}),app[_0x39fa01(0x1c5)](_0x39fa01(0x2b7),(_0x5332b9,_0x4261e4)=>{const _0x38b3ec=_0x39fa01;_0x4261e4[_0x38b3ec(0x283)](path[_0x38b3ec(0x1cf)](__dirname,bbpath2,_0x38b3ec(0x202),_0x38b3ec(0x29d)));}),app[_0x39fa01(0x1c5)](_0x39fa01(0x19b),(_0x3b4a7d,_0x4f59e5)=>{const _0x12b38f=_0x39fa01;_0x4f59e5[_0x12b38f(0x283)](path[_0x12b38f(0x1cf)](__dirname,bbpath2,_0x12b38f(0x202),_0x12b38f(0x29d)));}),app[_0x39fa01(0x1c5)](_0x39fa01(0x285),(_0x325852,_0x466eec)=>{const _0x1e5914=_0x39fa01;_0x466eec[_0x1e5914(0x283)](path[_0x1e5914(0x1cf)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/history',(_0x4cd944,_0xa740ed)=>{const _0x341166=_0x39fa01;_0xa740ed[_0x341166(0x283)](path[_0x341166(0x1cf)](__dirname,bbpath2,'build',_0x341166(0x29d)));}),app[_0x39fa01(0x1c5)]('/:bot/configuration',(_0x33faad,_0x22077b)=>{const _0x465a99=_0x39fa01;_0x22077b[_0x465a99(0x283)](path[_0x465a99(0x1cf)](__dirname,bbpath2,_0x465a99(0x202),_0x465a99(0x29d)));}),app[_0x39fa01(0x1c5)](_0x39fa01(0x293),(_0xd5a28,_0x3c6da6)=>{const _0x170f76=_0x39fa01;_0x3c6da6['sendFile'](path[_0x170f76(0x1cf)](__dirname,bbpath2,_0x170f76(0x202),'index.html'));});if(HOST)http[_0x39fa01(0x186)](PORT,HOST);else http[_0x39fa01(0x186)](PORT);const io=require(_0x39fa01(0x22f))(http,{});oneTimeMigration(),cleanBlacklist();const TelegramBot=require(_0x39fa01(0x28c)),{allowedNodeEnvironmentFlags}=require('process');let tgBot;if(settings['telegramToken']&&settings[_0x39fa01(0x27a)]!=''&&settings[_0x39fa01(0x25f)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler(),triggerAnalytics(!![]),getMessages();function startServer(){const _0x388058=_0x39fa01;console[_0x388058(0x27d)](''),console[_0x388058(0x27d)](_0x388058(0x1b9)),logging(_0x388058(0x2c3)+PORT),console[_0x388058(0x27d)](_0x388058(0x1b9));if(config['length']!=0x0)config[_0x388058(0x2ae)](_0x29454d=>{const _0x1d851e=_0x388058;if(_0x29454d[_0x1d851e(0x217)]=='enabled'||_0x29454d['status']==_0x1d851e(0x297))logging(_0x1d851e(0x1db)+_0x29454d[_0x1d851e(0x21b)]+_0x1d851e(0x2d6)+_0x29454d['botname']),startBot([_0x29454d['botID'],userID],{'cwd':bbpath},function(_0x4de505){if(_0x4de505)logging(_0x4de505);});else(_0x29454d[_0x1d851e(0x217)]==_0x1d851e(0x2a5)||_0x29454d[_0x1d851e(0x217)]==_0x1d851e(0x2a0))&&logging(_0x1d851e(0x2a9)+_0x29454d[_0x1d851e(0x21b)]+_0x1d851e(0x2d6)+_0x29454d['botname']);});else!newBot&&console[_0x388058(0x27d)](_0x388058(0x2c1));if(newBot)addBot();console[_0x388058(0x27d)](_0x388058(0x1b9)),console[_0x388058(0x27d)]('');}function startSocket(){io['on']('connection',_0x34d253=>{const _0x4da8fc=_0x4860;let _0x13d0bb,_0x9e8229,_0x32e65e,_0xe22ee0,_0xe76812;const _0x14f269=_0x34d253['handshake']['headers']['referer'];_0x9e8229=_0x14f269[_0x4da8fc(0x28e)](/bot[0-9]{3}/);if(_0x9e8229)_0x32e65e=_0x9e8229[0x0]['match'](/[0-9]{3}/);if(_0x32e65e)_0x13d0bb=_0x32e65e[0x0];else _0x13d0bb=_0x4da8fc(0x1e3);const _0x60ccc0=_0x34d253[_0x4da8fc(0x236)][_0x4da8fc(0x1cb)][_0x4da8fc(0x1c7)];if(!_0x60ccc0)_0x34d253[_0x4da8fc(0x17d)]('status',{'publicKey':secure[_0x4da8fc(0x2d5)]});else{_0xe22ee0=timelyDecrypt(_0x60ccc0,![]);if(!_0xe22ee0)_0x34d253['emit'](_0x4da8fc(0x217),{'publicKey':secure[_0x4da8fc(0x2d5)]});else{_0xe76812=normalizeIP(_0x34d253[_0x4da8fc(0x290)]['remoteAddress'])[_0x4da8fc(0x1d5)];if(!devices[_0xe22ee0])devices[_0xe22ee0]={'uuid':_0xe22ee0,'access':{'token':null}};devices[_0xe22ee0]['ip']=_0xe76812;const _0x360ffd=addClient(_0x34d253['id'],_0xe22ee0,_0x13d0bb);setAccess(_0x360ffd),emitMessages(),_0x34d253['on'](_0x4da8fc(0x2a3),_0x1bba53=>{const _0x1149c1=_0x4da8fc,_0x234da2=timelyDecrypt(_0x1bba53[_0x1149c1(0x2d3)]);if(_0x234da2){_0x1bba53={'username':_0x1bba53[_0x1149c1(0x19a)],'password':_0x234da2},devices[_0xe22ee0][_0x1149c1(0x21f)]=validateCredentials(_0x1bba53,_0xe22ee0);if(devices[_0xe22ee0][_0x1149c1(0x21f)][_0x1149c1(0x218)]==![]&&devices[_0xe22ee0][_0x1149c1(0x21f)][_0x1149c1(0x245)]=='2FA\x20login\x20required')_0x34d253['emit']('status',{'access':devices[_0xe22ee0][_0x1149c1(0x21f)]}),loginAccess2FA(_0xe22ee0,_0xe76812);else{if(devices[_0xe22ee0][_0x1149c1(0x21f)][_0x1149c1(0x218)]==![]&&devices[_0xe22ee0][_0x1149c1(0x21f)]['reason']=='invalid\x20credentials')_0x34d253[_0x1149c1(0x17d)](_0x1149c1(0x217),{'access':devices[_0xe22ee0][_0x1149c1(0x21f)]});else devices[_0xe22ee0][_0x1149c1(0x21f)][_0x1149c1(0x218)]&&devices[_0xe22ee0][_0x1149c1(0x21f)][_0x1149c1(0x245)]==_0x1149c1(0x1c4)&&(getClientsWithUuid(_0xe22ee0)[_0x1149c1(0x2ae)](_0x4ccf75=>{setAccess(_0x4ccf75);}),setTokenRefresh(_0xe22ee0),setSessionTimeout(_0x1149c1(0x2a3),_0xe22ee0));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x34d253['on'](_0x4da8fc(0x1e1),()=>{resetPassword();}),_0x34d253['on'](_0x4da8fc(0x1f5),_0x1d09e2=>{removeClient(_0x34d253['id']);});}}});}function initClient(_0x3cac8){const _0x39ea03=_0x39fa01;if(_0x3cac8!='botmanager'&&config[_0x39ea03(0x23a)]!=''){if(pid[_0x3cac8])pid[_0x3cac8]['send']({'function':_0x39ea03(0x1fd),'args':null});}}function getSocket(_0x423278){const _0x26a512=_0x39fa01;return io[_0x26a512(0x22a)][_0x26a512(0x22a)][_0x26a512(0x1c5)](_0x423278);}function setAccess(_0x540db8){const _0x5efbe4=_0x39fa01,_0x4a6a0d=getSocket(_0x540db8['id']),_0x19d3b8=_0x540db8[_0x5efbe4(0x1b8)],_0x2e1723=_0x540db8[_0x5efbe4(0x2d9)];devices[_0x19d3b8][_0x5efbe4(0x21f)]=validateAccess(devices[_0x19d3b8]['access'][_0x5efbe4(0x20b)],_0x19d3b8),_0x4a6a0d[_0x5efbe4(0x1cf)](_0x19d3b8);if(devices[_0x19d3b8][_0x5efbe4(0x21f)][_0x5efbe4(0x218)]){_0x4a6a0d[_0x5efbe4(0x1cf)](_0x2e1723);if(_0x2e1723==_0x5efbe4(0x1e3))initializeSocketBotManager(_0x4a6a0d);else initializeSocketBot(_0x4a6a0d);initClient(_0x2e1723);}devices[_0x19d3b8][_0x5efbe4(0x21f)][_0x5efbe4(0x20b)]&&devices[_0x19d3b8]['access'][_0x5efbe4(0x245)]==_0x5efbe4(0x1c9)&&setSessionTimeout(_0x5efbe4(0x29a),_0x19d3b8),devices[_0x19d3b8][_0x5efbe4(0x21f)][_0x5efbe4(0x20b)]&&devices[_0x19d3b8][_0x5efbe4(0x21f)][_0x5efbe4(0x245)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x5efbe4(0x2a3),_0x19d3b8),_0x4a6a0d['emit'](_0x5efbe4(0x217),{'status':_0x540db8[_0x5efbe4(0x22d)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x19d3b8]['access'],'externalip':devices[_0x19d3b8]['ip'],'publicKey':secure[_0x5efbe4(0x2d5)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x19d3b8][_0x5efbe4(0x21f)]['allow']==![]&&devices[_0x19d3b8][_0x5efbe4(0x21f)][_0x5efbe4(0x245)]==_0x5efbe4(0x2e2)&&temporaryAccess2FA(_0x19d3b8,devices[_0x19d3b8]['ip']);}function setSessionTimeout(_0x627790,_0x4241b7){const _0x398ee7=_0x39fa01;let _0x357a4c;if(_0x627790==_0x398ee7(0x2a3))_0x357a4c=loginExpiry*0x3c*0x3e8;else _0x357a4c=devices[_0x4241b7][_0x398ee7(0x230)]['expiry']*0x3c*0x3e8-(new Date()[_0x398ee7(0x2cc)]()-devices[_0x4241b7][_0x398ee7(0x230)][_0x398ee7(0x18e)]);if(devices[_0x4241b7][_0x398ee7(0x2eb)])clearTimeout(devices[_0x4241b7][_0x398ee7(0x2eb)]);devices[_0x4241b7][_0x398ee7(0x2eb)]=setTimeout(()=>{const _0x2e48f7=_0x398ee7;if(devices[_0x4241b7][_0x2e48f7(0x237)])clearTimeout(devices[_0x4241b7][_0x2e48f7(0x237)]);removeSocketListeners(_0x4241b7),addBlacklist(_0x4241b7),devices[_0x4241b7][_0x2e48f7(0x230)]=null,devices[_0x4241b7][_0x2e48f7(0x23d)]=null,devices[_0x4241b7][_0x2e48f7(0x21f)][_0x2e48f7(0x20b)]=null,devices[_0x4241b7][_0x2e48f7(0x21f)]=validateAccess(devices[_0x4241b7][_0x2e48f7(0x21f)][_0x2e48f7(0x20b)],_0x4241b7),!(devices[_0x4241b7][_0x2e48f7(0x21f)][_0x2e48f7(0x218)]&&devices[_0x4241b7][_0x2e48f7(0x21f)][_0x2e48f7(0x245)]==_0x2e48f7(0x2d8))&&(_0x627790=='login'?io['to'](_0x4241b7)['emit']('status',{'access':{'allow':![],'reason':_0x2e48f7(0x2c6),'token':null}}):io['to'](_0x4241b7)[_0x2e48f7(0x17d)](_0x2e48f7(0x217),{'access':{'allow':![],'reason':_0x2e48f7(0x1b2),'token':null}})),devices[_0x4241b7][_0x2e48f7(0x21f)][_0x2e48f7(0x20b)]=null;},_0x357a4c);}function setTokenRefresh(_0x4f6166){const _0x5f4d85=_0x39fa01;if(devices[_0x4f6166]['pidRefreshToken'])clearTimeout(devices[_0x4f6166][_0x5f4d85(0x237)]);devices[_0x4f6166][_0x5f4d85(0x237)]=setTimeout(()=>{const _0x156709=_0x5f4d85;getClientsWithUuid(_0x4f6166)['length']!=0x0?(devices[_0x4f6166][_0x156709(0x21f)]=refreshToken(_0x4f6166),io['to'](_0x4f6166)[_0x156709(0x17d)](_0x156709(0x217),{'status':_0x156709(0x172),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4f6166][_0x156709(0x21f)],'externalip':devices[_0x4f6166]['ip'],'publicKey':secure[_0x156709(0x2d5)],'validInstallation':validInstallation}),setTokenRefresh(_0x4f6166)):clearTimeout(devices[_0x4f6166][_0x156709(0x237)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1e0350){const _0x2abfe9=_0x39fa01,_0x10d40c=getClient(_0x1e0350['id'])['uuid'];_0x1e0350[_0x2abfe9(0x17d)](_0x2abfe9(0x20a),config),_0x1e0350[_0x2abfe9(0x17d)](_0x2abfe9(0x1a1),cleanSettings()),_0x1e0350['on'](_0x2abfe9(0x260),_0x38bbf4=>{const _0x11c4d=_0x2abfe9;if(validateAccess(_0x38bbf4,_0x10d40c)['allow'])addBot();else logging(_0x11c4d(0x243));}),_0x1e0350['on']('update-bot',(_0x3ac94b,_0x331aac)=>{const _0x578ccf=_0x2abfe9;if(validateAccess(_0x331aac,_0x10d40c)[_0x578ccf(0x218)])toggleBot(_0x3ac94b['botID'],_0x3ac94b[_0x578ccf(0x217)],_0x3ac94b['live']);else logging(_0x578ccf(0x208));}),_0x1e0350['on'](_0x2abfe9(0x21e),(_0x4ecd7c,_0x3dc54f)=>{const _0xe33f6b=_0x2abfe9;if(validateAccess(_0x3dc54f,_0x10d40c)['allow'])toggleBotMode(_0x4ecd7c);else logging(_0xe33f6b(0x208));}),_0x1e0350['on'](_0x2abfe9(0x280),(_0x409fe7,_0x30edc7)=>{const _0x3d4744=_0x2abfe9;if(validateAccess(_0x30edc7,_0x10d40c)[_0x3d4744(0x218)])deleteBot(_0x409fe7);else logging(_0x3d4744(0x1bd));}),_0x1e0350['on'](_0x2abfe9(0x2c7),(_0x5e4baf,_0x5ace4e)=>{const _0x25a752=_0x2abfe9;if(validateAccess(_0x5ace4e,_0x10d40c)[_0x25a752(0x218)])storeSettings(_0x5e4baf,!![]);else logging(_0x25a752(0x2bb));}),_0x1e0350['on']('update-bb',_0x1e8cbd=>{const _0x16a3d0=_0x2abfe9;if(validateAccess(_0x1e8cbd,_0x10d40c)['allow'])updateBB();else logging(_0x16a3d0(0x2b5));}),_0x1e0350['on']('get-messages',_0x271692=>{const _0x24bbee=_0x2abfe9;if(validateAccess(_0x271692,_0x10d40c)[_0x24bbee(0x218)])getMessages();else logging('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1e0350['on'](_0x2abfe9(0x2d0),(_0x18fdb3,_0x162b77)=>{const _0x51ca1b=_0x2abfe9;if(validateAccess(_0x162b77,_0x10d40c)[_0x51ca1b(0x218)])confirmMessage(_0x18fdb3);else logging(_0x51ca1b(0x25d));}),_0x1e0350['on'](_0x2abfe9(0x234),_0x35b082=>{const _0x2be39f=_0x2abfe9;if(validateAccess(_0x35b082,_0x10d40c)[_0x2be39f(0x218)]){if(devices[_0x10d40c][_0x2be39f(0x237)])clearTimeout(devices[_0x10d40c][_0x2be39f(0x237)]);if(devices[_0x10d40c][_0x2be39f(0x2eb)])clearTimeout(devices[_0x10d40c][_0x2be39f(0x2eb)]);removeSocketListeners(getClient(_0x1e0350['id'])[_0x2be39f(0x1b8)]),addBlacklist(_0x10d40c),devices[_0x10d40c][_0x2be39f(0x230)]=null,devices[_0x10d40c][_0x2be39f(0x23d)]=null,devices[_0x10d40c]['access']['token']=null,io['to'](getClient(_0x1e0350['id'])['uuid'])[_0x2be39f(0x17d)](_0x2be39f(0x217),{'access':{'allow':![],'reason':_0x2be39f(0x291),'token':null}});}else logging(_0x2be39f(0x251));});}function initializeSocketBot(_0x21ab02){const _0x2fc571=_0x39fa01,_0x2bf257=getClient(_0x21ab02['id'])[_0x2fc571(0x2d9)],_0x4fd53f=getClient(_0x21ab02['id'])[_0x2fc571(0x1b8)];_0x21ab02['on'](_0x2fc571(0x2a7),(_0x3e0f72,_0xce8dd7)=>{const _0x34d073=_0x2fc571;if(validateAccess(_0xce8dd7,_0x4fd53f)[_0x34d073(0x218)]){if(pid[_0x2bf257])pid[_0x2bf257][_0x34d073(0x276)]({'function':_0x34d073(0x286),'args':_0x3e0f72});}else logging(_0x34d073(0x196));}),_0x21ab02['on'](_0x2fc571(0x212),(_0x327c25,_0x206917)=>{const _0xbcd9c1=_0x2fc571;if(validateAccess(_0x206917,_0x4fd53f)[_0xbcd9c1(0x218)]){if(pid[_0x2bf257])pid[_0x2bf257][_0xbcd9c1(0x276)]({'function':_0xbcd9c1(0x1d2),'args':_0x327c25});}else logging(_0xbcd9c1(0x275));}),_0x21ab02['on'](_0x2fc571(0x20e),(_0x4f1f05,_0x226507)=>{const _0xb97a8a=_0x2fc571;if(validateAccess(_0x226507,_0x4fd53f)['allow']){if(pid[_0x2bf257])pid[_0x2bf257][_0xb97a8a(0x276)]({'function':_0xb97a8a(0x274),'args':_0x4f1f05});}else logging(_0xb97a8a(0x259));}),_0x21ab02['on'](_0x2fc571(0x1b6),(_0x4af9d6,_0x13cd99)=>{const _0x561f66=_0x2fc571;if(validateAccess(_0x13cd99,_0x4fd53f)['allow']){if(pid[_0x2bf257])pid[_0x2bf257][_0x561f66(0x276)]({'function':_0x561f66(0x2d7),'args':_0x4af9d6});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x21ab02['on'](_0x2fc571(0x2bf),(_0x11a58e,_0x69b23)=>{const _0x10cb07=_0x2fc571;if(validateAccess(_0x69b23,_0x4fd53f)[_0x10cb07(0x218)]){if(pid[_0x2bf257])pid[_0x2bf257][_0x10cb07(0x276)]({'function':_0x10cb07(0x1d4),'args':_0x11a58e});}else logging(_0x10cb07(0x179));}),_0x21ab02['on'](_0x2fc571(0x1ab),_0x466cce=>{const _0x23c141=_0x2fc571;if(validateAccess(_0x466cce,_0x4fd53f)['allow']){if(pid[_0x2bf257])pid[_0x2bf257]['send']({'function':'getStartingBalances','args':null});}else logging(_0x23c141(0x1a4));}),_0x21ab02['on'](_0x2fc571(0x261),(_0x4a5770,_0x20010d)=>{const _0x4718c5=_0x2fc571;if(validateAccess(_0x20010d,_0x4fd53f)['allow']){if(pid[_0x2bf257])pid[_0x2bf257][_0x4718c5(0x276)]({'function':_0x4718c5(0x1e4),'args':_0x4a5770});}else logging(_0x4718c5(0x247));}),_0x21ab02['on']('cancel-loading',_0x41f3d4=>{const _0x3c66a6=_0x2fc571;if(validateAccess(_0x41f3d4,_0x4fd53f)['allow']){if(pid[_0x2bf257])pid[_0x2bf257][_0x3c66a6(0x276)]({'function':_0x3c66a6(0x2a2),'args':null});}else logging(_0x3c66a6(0x1c1));}),_0x21ab02['on']('get-messages',_0x3a10c0=>{const _0x1045d3=_0x2fc571;if(validateAccess(_0x3a10c0,_0x4fd53f)[_0x1045d3(0x218)])getMessages();else logging(_0x1045d3(0x289));}),_0x21ab02['on'](_0x2fc571(0x2d0),(_0x2f4b61,_0x4fa7fb)=>{if(validateAccess(_0x4fa7fb,_0x4fd53f)['allow'])confirmMessage(_0x2f4b61);else logging('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x21ab02['on']('logout',_0x40bb54=>{const _0x52b2e6=_0x2fc571;if(validateAccess(_0x40bb54,_0x4fd53f)['allow']){if(devices[_0x4fd53f][_0x52b2e6(0x237)])clearTimeout(devices[_0x4fd53f][_0x52b2e6(0x237)]);if(devices[_0x4fd53f][_0x52b2e6(0x2eb)])clearTimeout(devices[_0x4fd53f]['pidExpireLogin']);removeSocketListeners(getClient(_0x21ab02['id'])[_0x52b2e6(0x1b8)]),addBlacklist(_0x4fd53f),devices[_0x4fd53f][_0x52b2e6(0x230)]=null,devices[_0x4fd53f][_0x52b2e6(0x23d)]=null,devices[_0x4fd53f][_0x52b2e6(0x21f)][_0x52b2e6(0x20b)]=null,io['to'](getClient(_0x21ab02['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x52b2e6(0x291),'token':null}});}else logging(_0x52b2e6(0x251));});}function removeSocketListeners(_0x199f7f){const _0x2993d1=_0x39fa01;getClientsWithUuid(_0x199f7f)[_0x2993d1(0x2ae)](_0x35832d=>{const _0x4d362e=_0x2993d1;getSocket(_0x35832d['id'])[_0x4d362e(0x26d)]();});}function cleanSettings(){const _0x2a98be=_0x39fa01;let _0x396fc0=settings;return settings[_0x2a98be(0x27a)]&&settings['telegramToken']!=''&&(_0x396fc0={..._0x396fc0,'telegramToken':_0x2a98be(0x18d)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x396fc0={..._0x396fc0,'bbPassword':_0x2a98be(0x18d)}),_0x396fc0;}function updateBB(){const _0x523765=_0x39fa01;installingUpdate=!![],config[_0x523765(0x2ae)](_0x3e0761=>{const _0x59ba8a=_0x523765;restartBot(_0x3e0761[_0x59ba8a(0x21b)]);}),process[_0x523765(0x276)]({'update':!![]},_0x15bdae=>{});}function startBot(_0x6f29e2,_0x31b022,_0x3d8d96){const _0xe85e3f=_0x39fa01;let _0x38b491=![];const _0x3e3df0=_0x6f29e2[0x0];_0x31b022={..._0x31b022,'stdio':[_0xe85e3f(0x2ce),'inherit','inherit','ipc']},pid[_0x3e3df0]=childProcess['fork'](botfile,_0x6f29e2,_0x31b022),pid[_0x3e3df0]['on'](_0xe85e3f(0x278),_0x8f7902=>{const _0x5c6f89=_0xe85e3f;switch(Object['keys'](_0x8f7902)[0x0]){case'botname':updateBotName(_0x3e3df0,_0x8f7902[_0x5c6f89(0x240)]);break;case _0x5c6f89(0x2e8):updateBotManager();break;case _0x5c6f89(0x217):updateStatus(_0x3e3df0,_0x8f7902[_0x5c6f89(0x217)]);break;case _0x5c6f89(0x1a6):updateLive(_0x3e3df0,_0x8f7902[_0x5c6f89(0x1a6)]);break;case _0x5c6f89(0x206):updateLive(_0x3e3df0,_0x8f7902[_0x5c6f89(0x206)]),io['to'](_0x3e3df0)[_0x5c6f89(0x17d)](_0x5c6f89(0x217),{'access':{'allow':![],'reason':_0x5c6f89(0x183),'token':null}});break;case _0x5c6f89(0x229):_0x8f7902[_0x5c6f89(0x229)]==_0x5c6f89(0x178)&&restartBot(_0x3e3df0);_0x8f7902[_0x5c6f89(0x229)]==_0x5c6f89(0x23b)&&toggleBot(_0x3e3df0,_0x5c6f89(0x2a5),_0x5c6f89(0x1dd));break;case _0x5c6f89(0x2cd):sendTelegram(_0x3e3df0,_0x8f7902[_0x5c6f89(0x2cd)]);break;case _0x5c6f89(0x279):sendTelegramMsg(_0x8f7902[_0x5c6f89(0x279)]);break;case _0x5c6f89(0x2e4):io['to'](_0x3e3df0)['emit'](_0x8f7902[_0x5c6f89(0x2e4)],_0x8f7902[_0x5c6f89(0x1e6)]);break;}}),pid[_0x3e3df0]['on']('error',function(_0x4329db){if(_0x38b491)return;_0x38b491=!![],_0x3d8d96(_0x4329db);}),pid[_0x3e3df0]['on'](_0xe85e3f(0x267),function(_0x296ed9){const _0x377a84=_0xe85e3f;if(installingUpdate)return;if(_0x38b491)return;_0x38b491=!![],_0x3d8d96(null);const _0xee97db=dbConfig[_0x377a84(0x1c5)]('bots')[_0x377a84(0x2e0)]({'botID':_0x3e3df0})['value']();_0xee97db&&(_0xee97db[_0x377a84(0x217)]==_0x377a84(0x22e)||_0xee97db['status']==_0x377a84(0x297))&&(updateLive(_0x3e3df0,'stopped'),logging(_0x377a84(0x1ce)+_0x3e3df0),startBot([_0x3e3df0,userID],{'cwd':bbpath},function(_0x731664){if(_0x731664)logging(_0x731664);}));});}function stopBot(_0xd8d65a){const _0x2bf287=_0x39fa01;getClientsWithBotID(_0xd8d65a)['forEach'](_0x63c9a5=>{getSocket(_0x63c9a5['id'])['disconnect'](!![]),removeClient(_0x63c9a5['id']);}),pid[_0xd8d65a]&&(pid[_0xd8d65a][_0x2bf287(0x23b)](),pid[_0xd8d65a]=null);}function restartBot(_0x2e4ac3){const _0x32c79c=_0x39fa01;if(pid[_0x2e4ac3])pid[_0x2e4ac3][_0x32c79c(0x23b)]();}function addBot(){const _0x3e61fd=_0x39fa01;let _0x700ed9;for(let _0x2028c3=0x1;_0x2028c3<0x3e9;_0x2028c3++){_0x700ed9=_0x2028c3[_0x3e61fd(0x254)]()[_0x3e61fd(0x23e)](0x3,'0');let _0x13f310=config['find'](_0x5202c2=>_0x5202c2['botID']==_0x700ed9);if(!_0x13f310)break;}if(_0x700ed9===_0x3e61fd(0x2bc)){logging(_0x3e61fd(0x1be));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x700ed9),dbConfig[_0x3e61fd(0x1c5)](_0x3e61fd(0x20a))[_0x3e61fd(0x2c9)]({'botID':_0x700ed9,'botname':_0x3e61fd(0x1f2)+_0x700ed9,'status':_0x3e61fd(0x297),'live':''})[_0x3e61fd(0x1b4)](),startBot([_0x700ed9,userID],{'cwd':bbpath},function(_0x3c6339){if(_0x3c6339)logging(_0x3c6339);}),config=getConfiguration(),io['to'](_0x3e61fd(0x1e3))[_0x3e61fd(0x17d)](_0x3e61fd(0x20a),config);}function deleteBot(_0x235d8b){const _0x1766d5=_0x39fa01;getClientsWithBotID(_0x235d8b)['forEach'](_0x546597=>{const _0x48e4d6=_0x4860;getSocket(_0x546597['id'])[_0x48e4d6(0x1f5)](!![]),removeClient(_0x546597['id']);}),dbConfig['get']('bots')['remove']({'botID':_0x235d8b})[_0x1766d5(0x1b4)](),logging(_0x1766d5(0x185)+_0x235d8b),stopBot(_0x235d8b);try{fs[_0x1766d5(0x277)](path['join'](configpath,'bot-'+_0x235d8b+'-config.json')),fs[_0x1766d5(0x277)](path[_0x1766d5(0x1cf)](configpath,_0x1766d5(0x1bf)+_0x235d8b+_0x1766d5(0x2c0))),fs[_0x1766d5(0x277)](path[_0x1766d5(0x1cf)](configpath,_0x1766d5(0x1bf)+_0x235d8b+_0x1766d5(0x2e3))),fs[_0x1766d5(0x277)](path[_0x1766d5(0x1cf)](configpath,_0x1766d5(0x1bf)+_0x235d8b+_0x1766d5(0x219)));}catch(_0x554d3a){if(_0x554d3a)logging(_0x1766d5(0x26e),_0x554d3a);}config=getConfiguration(),io['to'](_0x1766d5(0x1e3))['emit'](_0x1766d5(0x20a),config);}function toggleBot(_0x391569,_0x3e8017,_0x238f16){const _0x57c2a7=_0x39fa01;dbConfig[_0x57c2a7(0x1c5)](_0x57c2a7(0x20a))[_0x57c2a7(0x2e0)]({'botID':_0x391569})[_0x57c2a7(0x1ba)]({'status':_0x3e8017})['assign']({'live':_0x238f16})['write']();if(_0x3e8017=='enabled'||_0x3e8017==_0x57c2a7(0x297))logging(_0x57c2a7(0x235)+_0x391569),startBot([_0x391569,userID],{'cwd':bbpath},function(_0x3bae03){if(_0x3bae03)logging(_0x3bae03);});else(_0x3e8017==_0x57c2a7(0x2a5)||_0x3e8017==_0x57c2a7(0x2a0))&&(logging(_0x57c2a7(0x2e5)+_0x391569),stopBot(_0x391569));config=getConfiguration(),io['to']('botmanager')[_0x57c2a7(0x17d)](_0x57c2a7(0x20a),config);}function toggleStatus(_0x4fa287){const _0x2408bf=_0x39fa01;let _0x1a33e4=dbConfig[_0x2408bf(0x1c5)](_0x2408bf(0x20a))[_0x2408bf(0x2e0)]({'botID':_0x4fa287})['value'](),_0x42ac7b;if(_0x1a33e4[_0x2408bf(0x217)]==='enabled')_0x42ac7b=_0x2408bf(0x2a5);else{if(_0x1a33e4[_0x2408bf(0x217)]===_0x2408bf(0x297))_0x42ac7b='new-disabled';else{if(_0x1a33e4[_0x2408bf(0x217)]==='new-disabled')_0x42ac7b=_0x2408bf(0x297);else{if(_0x1a33e4['status']===_0x2408bf(0x2a5))_0x42ac7b='enabled';}}}return _0x42ac7b;}function updateStatus(_0x129ee7,_0x372a74){const _0x2bf43b=_0x39fa01;dbConfig[_0x2bf43b(0x1c5)]('bots')[_0x2bf43b(0x2e0)]({'botID':_0x129ee7})[_0x2bf43b(0x1ba)]({'status':_0x372a74})[_0x2bf43b(0x1b4)](),config=getConfiguration(),io['to']('botmanager')[_0x2bf43b(0x17d)](_0x2bf43b(0x20a),config);}function updateLive(_0xf9c928,_0x5e92df){const _0x5df5c1=_0x39fa01;dbConfig[_0x5df5c1(0x1c5)](_0x5df5c1(0x20a))[_0x5df5c1(0x2e0)]({'botID':_0xf9c928})[_0x5df5c1(0x1ba)]({'live':_0x5e92df})[_0x5df5c1(0x1b4)](),config=getConfiguration(),io['to'](_0x5df5c1(0x1e3))[_0x5df5c1(0x17d)](_0x5df5c1(0x20a),config);}function updateBotName(_0x51c15e,_0x30e4ad){const _0x3f7303=_0x39fa01;dbConfig[_0x3f7303(0x1c5)](_0x3f7303(0x20a))['find']({'botID':_0x51c15e})['assign']({'botname':_0x30e4ad})[_0x3f7303(0x1b4)](),config=getConfiguration(),io['to'](_0x3f7303(0x1e3))[_0x3f7303(0x17d)](_0x3f7303(0x20a),config);}function updateBotManager(){const _0x448df7=_0x39fa01;config=getConfiguration(),io['to'](_0x448df7(0x1e3))[_0x448df7(0x17d)](_0x448df7(0x20a),config);}function toggleBotMode(_0x3a8a8d){const _0x28efdb=_0x39fa01;if(pid[_0x3a8a8d])pid[_0x3a8a8d][_0x28efdb(0x276)]({'function':_0x28efdb(0x1ca),'args':null});else{const _0x15a502=configpath+_0x28efdb(0x1bf)+_0x3a8a8d+_0x28efdb(0x273),_0x17c9ac=fs[_0x28efdb(0x242)](_0x15a502),_0xe53d1d=JSON[_0x28efdb(0x1d7)](_0x17c9ac),_0x4841d1=_0xe53d1d[_0x28efdb(0x2d9)][0x0]['headless'];_0xe53d1d[_0x28efdb(0x2d9)][0x0]['headless']=!_0x4841d1;const _0x2fb557=JSON[_0x28efdb(0x181)](_0xe53d1d,null,0x2);fs[_0x28efdb(0x1ea)](_0x15a502,_0x2fb557),config=getConfiguration(),io['to'](_0x28efdb(0x1e3))['emit'](_0x28efdb(0x20a),config);}}function telegramError(_0x21b45c){const _0x141db5=_0x39fa01;console[_0x141db5(0x27d)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x5bada3){const _0x3ff3d1=_0x39fa01;if(_0x5bada3[_0x3ff3d1(0x1d3)][_0x3ff3d1(0x19a)]!=settings[_0x3ff3d1(0x25f)]&&'@'+_0x5bada3['from'][_0x3ff3d1(0x19a)]!=settings['telegramUsername'])return tgBot[_0x3ff3d1(0x1e8)](_0x5bada3[_0x3ff3d1(0x1f1)]['id'],_0x3ff3d1(0x17f),{'parse_mode':'HTML'})[_0x3ff3d1(0x2af)](_0x56580e=>{telegramError(_0x56580e);}),![];return!![];}async function initTelegram(){const _0x561190=_0x39fa01;if(tgBot)tgBot[_0x561190(0x1a3)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x561190(0x27a)],{'polling':!![]});let _0xf755d2=_0x561190(0x2b4);_0xf755d2+='\x0a',_0xf755d2+=_0x561190(0x1b5),_0xf755d2+=_0x561190(0x221),_0xf755d2+=_0x561190(0x22c),_0xf755d2+=_0x561190(0x2b2),_0xf755d2+=_0x561190(0x203),_0xf755d2+=_0x561190(0x2d2),_0xf755d2+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0xf755d2+=_0x561190(0x292),_0xf755d2+=_0x561190(0x1cd),_0xf755d2+=_0x561190(0x1b0),_0xf755d2+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0xf755d2+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x577aa5=_0x561190(0x1cc);_0x577aa5+='\x0a',_0x577aa5+=_0xf755d2,tgBot[_0x561190(0x1f0)](/\/start/,_0x4a46f9=>{const _0x31b14b=_0x561190;if(!validateTelegram(_0x4a46f9))return;if(settings[_0x31b14b(0x18f)]!=_0x4a46f9['chat']['id'])updateSetting('telegramChatId',_0x4a46f9[_0x31b14b(0x1f1)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x31b14b(0x1e8)](_0x4a46f9[_0x31b14b(0x1f1)]['id'],_0x577aa5)[_0x31b14b(0x2af)](_0x1c2f35=>{telegramError(_0x1c2f35);});}),tgBot[_0x561190(0x1f0)](/\/enable/,_0x11d715=>{const _0x9e5d92=_0x561190;if(!validateTelegram(_0x11d715))return;if(settings[_0x9e5d92(0x18f)]!=_0x11d715[_0x9e5d92(0x1f1)]['id'])updateSetting(_0x9e5d92(0x18f),_0x11d715['chat']['id']);updateSetting(_0x9e5d92(0x2b9),!![]),tgBot[_0x9e5d92(0x1e8)](_0x11d715['chat']['id'],'Notifications\x20enabled')[_0x9e5d92(0x2af)](_0x3d139f=>{telegramError(_0x3d139f);});}),tgBot['onText'](/\/config/,async _0x2141fb=>{const _0x579796=_0x561190;if(!validateTelegram(_0x2141fb))return;tgBot[_0x579796(0x1fa)](_0x579796(0x233)),tgBot[_0x579796(0x1e8)](_0x2141fb[_0x579796(0x1f1)]['id'],_0x579796(0x1d6),{'reply_markup':{'inline_keyboard':[[{'text':_0x579796(0x282),'callback_data':'orders'},{'text':'Alerts','callback_data':_0x579796(0x201)},{'text':'All','callback_data':_0x579796(0x268)}]]}})[_0x579796(0x2af)](_0x433ffb=>{telegramError(_0x433ffb);}),tgBot['on'](_0x579796(0x233),async _0x3603ef=>{const _0x50fa34=_0x579796,_0x4ec2fc=_0x3603ef['data'],_0x20985c=_0x3603ef[_0x50fa34(0x278)];tgBot[_0x50fa34(0x265)](_0x3603ef['id'])[_0x50fa34(0x2e9)](async()=>{const _0x560c6e=_0x50fa34;_0x4ec2fc==_0x560c6e(0x27c)&&(updateSetting(_0x560c6e(0x1a7),_0x560c6e(0x27c)),updateSetting(_0x560c6e(0x2b9),!![]),await tgBot[_0x560c6e(0x1e8)](_0x20985c[_0x560c6e(0x1f1)]['id'],_0x560c6e(0x1bb))[_0x560c6e(0x2af)](_0x5297a8=>{telegramError(_0x5297a8);}));_0x4ec2fc==_0x560c6e(0x201)&&(updateSetting(_0x560c6e(0x1a7),_0x560c6e(0x201)),updateSetting(_0x560c6e(0x2b9),!![]),await tgBot[_0x560c6e(0x1e8)](_0x20985c[_0x560c6e(0x1f1)]['id'],_0x560c6e(0x21d))[_0x560c6e(0x2af)](_0x479988=>{telegramError(_0x479988);}));_0x4ec2fc=='all'&&(updateSetting(_0x560c6e(0x1a7),_0x560c6e(0x268)),updateSetting('telegramEnabled',!![]),await tgBot[_0x560c6e(0x1e8)](_0x20985c[_0x560c6e(0x1f1)]['id'],_0x560c6e(0x21c))[_0x560c6e(0x2af)](_0x11f3e1=>{telegramError(_0x11f3e1);}));if(!settings[_0x560c6e(0x18f)])tgBot[_0x560c6e(0x1e8)](_0x20985c[_0x560c6e(0x1f1)]['id'],_0x560c6e(0x1f9))[_0x560c6e(0x2af)](_0x4ac6cc=>{telegramError(_0x4ac6cc);});}),tgBot['removeListener']('callback_query');});}),tgBot[_0x561190(0x1f0)](/\/status/,_0x275b3a=>{const _0x359b2e=_0x561190;if(!validateTelegram(_0x275b3a))return;const _0xe9711f=getBotsWithMode();let _0x1d370d=_0x359b2e(0x223);config[_0x359b2e(0x2ae)](_0xcd7b7c=>{const _0x48fdf2=_0x359b2e,_0x1c329a=_0xe9711f[_0x48fdf2(0x2e0)](_0x29cb9b=>_0x29cb9b[_0x48fdf2(0x21b)]==_0xcd7b7c[_0x48fdf2(0x21b)])[_0x48fdf2(0x19c)];_0x1d370d+=_0x48fdf2(0x1f2)+_0xcd7b7c[_0x48fdf2(0x21b)]+':\x20'+_0xcd7b7c['status']+_0x48fdf2(0x2d6)+_0x1c329a+'\x20|\x20'+_0xcd7b7c['live']+'\x0a';}),_0x1d370d+='\x0a',_0x1d370d+=_0x359b2e(0x1a8),_0x1d370d+=!settings['telegramEnabled']?_0x359b2e(0x2be):'Notifications\x20enabled\x0a',_0x1d370d+=settings[_0x359b2e(0x2b9)]?settings[_0x359b2e(0x1a7)]=='all'?_0x359b2e(0x1ac):_0x359b2e(0x2a8)+settings[_0x359b2e(0x1a7)]+_0x359b2e(0x215):'',tgBot[_0x359b2e(0x1e8)](_0x275b3a[_0x359b2e(0x1f1)]['id'],_0x1d370d,{'parse_mode':_0x359b2e(0x1f4)})[_0x359b2e(0x2af)](_0x491b53=>{telegramError(_0x491b53);});}),tgBot[_0x561190(0x1f0)](/\/restart/,_0x5ae652=>{const _0x55578c=_0x561190;if(!validateTelegram(_0x5ae652))return;tgBot[_0x55578c(0x1fa)]('callback_query');const _0x577168=getEnabledBots();if(_0x577168[_0x55578c(0x1c3)]==0x0)tgBot[_0x55578c(0x1e8)](_0x5ae652['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x55578c(0x2af)](_0x407687=>{telegramError(_0x407687);});else{if(_0x577168[_0x55578c(0x1c3)]>0x1)_0x577168['push']({'botID':_0x55578c(0x268)});let _0x21abf1=[],_0x551669=[];const _0x4d27fd=_0x577168['length']%0x4==0x0||_0x577168[_0x55578c(0x1c3)]%0x4==0x3||_0x577168[_0x55578c(0x1c3)]%0x3==0x1?0x4:0x3;let _0x35a4e4=0x0;_0x577168['forEach']((_0x1a6b48,_0x2411d4)=>{const _0x1f4a31=_0x55578c;if(_0x2411d4%_0x4d27fd==0x0)_0x551669=[];_0x551669['push']({'text':_0x1a6b48['botID']==_0x1f4a31(0x268)?_0x1f4a31(0x20f):'Bot\x20'+_0x1a6b48['botID'],'callback_data':_0x1a6b48[_0x1f4a31(0x21b)]}),_0x2411d4%_0x4d27fd==0x0&&(_0x21abf1[_0x35a4e4]=_0x551669,_0x35a4e4++);}),tgBot[_0x55578c(0x1e8)](_0x5ae652[_0x55578c(0x1f1)]['id'],_0x55578c(0x1b7),{'reply_markup':{'inline_keyboard':_0x21abf1}})[_0x55578c(0x2af)](_0x24b5c6=>{telegramError(_0x24b5c6);}),tgBot['on'](_0x55578c(0x233),async _0x2d6a30=>{const _0x4f7e69=_0x55578c,_0x188dfd=_0x2d6a30[_0x4f7e69(0x1fb)],_0x47d354=_0x2d6a30[_0x4f7e69(0x278)];tgBot[_0x4f7e69(0x265)](_0x2d6a30['id'])['then'](async()=>{const _0x30c306=_0x4f7e69;_0x188dfd==_0x30c306(0x268)?(tgBot[_0x30c306(0x1e8)](_0x47d354[_0x30c306(0x1f1)]['id'],_0x30c306(0x227))[_0x30c306(0x2af)](_0x3b3c6d=>{telegramError(_0x3b3c6d);}),config[_0x30c306(0x2ae)](_0x4109ab=>{restartBot(_0x4109ab['botID']);})):(tgBot[_0x30c306(0x1e8)](_0x47d354[_0x30c306(0x1f1)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x188dfd)[_0x30c306(0x2af)](_0x4a96c6=>{telegramError(_0x4a96c6);}),restartBot(_0x188dfd));}),tgBot[_0x4f7e69(0x1fa)]('callback_query');});}}),tgBot[_0x561190(0x1f0)](/\/on/,_0x8aa733=>{const _0x3490d9=_0x561190;if(!validateTelegram(_0x8aa733))return;tgBot[_0x3490d9(0x1fa)]('callback_query');const _0x936d87=getDisabledBots();if(_0x936d87[_0x3490d9(0x1c3)]==0x0)tgBot['sendMessage'](_0x8aa733[_0x3490d9(0x1f1)]['id'],_0x3490d9(0x29b))[_0x3490d9(0x2af)](_0x2547e2=>{telegramError(_0x2547e2);});else{if(_0x936d87['length']>0x1)_0x936d87[_0x3490d9(0x2c9)]({'botID':'all'});let _0x283936=[],_0x48b41a=[];const _0xc413cc=_0x936d87[_0x3490d9(0x1c3)]%0x4==0x0||_0x936d87['length']%0x4==0x3||_0x936d87[_0x3490d9(0x1c3)]%0x3==0x1?0x4:0x3;let _0x13241e=0x0;_0x936d87['forEach']((_0x2755fe,_0x5c82ae)=>{const _0xdf024c=_0x3490d9;if(_0x5c82ae%_0xc413cc==0x0)_0x48b41a=[];_0x48b41a['push']({'text':_0x2755fe[_0xdf024c(0x21b)]==_0xdf024c(0x268)?_0xdf024c(0x20f):'Bot\x20'+_0x2755fe['botID'],'callback_data':_0x2755fe['botID']}),_0x5c82ae%_0xc413cc==0x0&&(_0x283936[_0x13241e]=_0x48b41a,_0x13241e++);}),tgBot[_0x3490d9(0x1e8)](_0x8aa733[_0x3490d9(0x1f1)]['id'],_0x3490d9(0x1e0),{'reply_markup':{'inline_keyboard':_0x283936}})[_0x3490d9(0x2af)](_0x6bb489=>{telegramError(_0x6bb489);}),tgBot['on'](_0x3490d9(0x233),async _0xad219=>{const _0x21f6d4=_0x3490d9,_0x2b8700=_0xad219['data'],_0x6e02ed=_0xad219[_0x21f6d4(0x278)];tgBot['answerCallbackQuery'](_0xad219['id'])[_0x21f6d4(0x2e9)](async()=>{const _0x54b1b4=_0x21f6d4;_0x2b8700=='all'?(tgBot[_0x54b1b4(0x1e8)](_0x6e02ed['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x54b1b4(0x2af)](_0x332010=>{telegramError(_0x332010);}),_0x936d87[_0x54b1b4(0x2ae)](_0x349c81=>{const _0x5e2273=_0x54b1b4;if(_0x349c81[_0x5e2273(0x21b)]!=_0x5e2273(0x268))toggleBot(_0x349c81[_0x5e2273(0x21b)],toggleStatus(_0x349c81[_0x5e2273(0x21b)]),_0x5e2273(0x1dd));})):(tgBot[_0x54b1b4(0x1e8)](_0x6e02ed[_0x54b1b4(0x1f1)]['id'],_0x54b1b4(0x173)+_0x2b8700)['catch'](_0x3920d5=>{telegramError(_0x3920d5);}),toggleBot(_0x2b8700,toggleStatus(_0x2b8700),_0x54b1b4(0x1dd)));}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x561190(0x1f0)](/\/off/,_0x3ab565=>{const _0x5e13ef=_0x561190;if(!validateTelegram(_0x3ab565))return;tgBot['removeListener'](_0x5e13ef(0x233));const _0x19e52e=getEnabledBots();if(_0x19e52e[_0x5e13ef(0x1c3)]==0x0)tgBot[_0x5e13ef(0x1e8)](_0x3ab565[_0x5e13ef(0x1f1)]['id'],_0x5e13ef(0x258))['catch'](_0x339fa3=>{telegramError(_0x339fa3);});else{if(_0x19e52e[_0x5e13ef(0x1c3)]>0x1)_0x19e52e[_0x5e13ef(0x2c9)]({'botID':_0x5e13ef(0x268)});let _0x2c0de1=[],_0x5f3d6a=[];const _0x860006=_0x19e52e['length']%0x4==0x0||_0x19e52e[_0x5e13ef(0x1c3)]%0x4==0x3||_0x19e52e['length']%0x3==0x1?0x4:0x3;let _0x5006fa=0x0;_0x19e52e['forEach']((_0x1f2e30,_0x2c4a28)=>{const _0xd29fa9=_0x5e13ef;if(_0x2c4a28%_0x860006==0x0)_0x5f3d6a=[];_0x5f3d6a['push']({'text':_0x1f2e30['botID']=='all'?_0xd29fa9(0x20f):'Bot\x20'+_0x1f2e30[_0xd29fa9(0x21b)],'callback_data':_0x1f2e30[_0xd29fa9(0x21b)]}),_0x2c4a28%_0x860006==0x0&&(_0x2c0de1[_0x5006fa]=_0x5f3d6a,_0x5006fa++);}),tgBot[_0x5e13ef(0x1e8)](_0x3ab565[_0x5e13ef(0x1f1)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x2c0de1}})[_0x5e13ef(0x2af)](_0x30b61c=>{telegramError(_0x30b61c);}),tgBot['on'](_0x5e13ef(0x233),async _0x55bb21=>{const _0x563315=_0x5e13ef,_0x440ad2=_0x55bb21['data'],_0xf42354=_0x55bb21[_0x563315(0x278)];tgBot[_0x563315(0x265)](_0x55bb21['id'])[_0x563315(0x2e9)](async()=>{const _0x51614d=_0x563315;_0x440ad2=='all'?(tgBot[_0x51614d(0x1e8)](_0xf42354[_0x51614d(0x1f1)]['id'],_0x51614d(0x17e))[_0x51614d(0x2af)](_0x5b027a=>{telegramError(_0x5b027a);}),_0x19e52e['forEach'](_0x3ef7a5=>{const _0x4593a4=_0x51614d;if(_0x3ef7a5[_0x4593a4(0x21b)]!=_0x4593a4(0x268))toggleBot(_0x3ef7a5['botID'],toggleStatus(_0x3ef7a5[_0x4593a4(0x21b)]),_0x4593a4(0x1dd));})):(tgBot[_0x51614d(0x1e8)](_0xf42354[_0x51614d(0x1f1)]['id'],_0x51614d(0x193)+_0x440ad2)[_0x51614d(0x2af)](_0xd70814=>{telegramError(_0xd70814);}),toggleBot(_0x440ad2,toggleStatus(_0x440ad2),'stopped'));}),tgBot[_0x563315(0x1fa)](_0x563315(0x233));});}}),tgBot['onText'](/\/portfolio/,_0x67f510=>{const _0x3888d7=_0x561190;if(!validateTelegram(_0x67f510))return;tgBot[_0x3888d7(0x1fa)](_0x3888d7(0x233));const _0x65bd65=getEnabledBots();if(_0x65bd65[_0x3888d7(0x1c3)]==0x0)tgBot[_0x3888d7(0x1e8)](_0x67f510[_0x3888d7(0x1f1)]['id'],_0x3888d7(0x258))[_0x3888d7(0x2af)](_0x1ebcf4=>{telegramError(_0x1ebcf4);});else{if(_0x65bd65[_0x3888d7(0x1c3)]>0x1){let _0x13521f=[],_0x8d1ee7=[];const _0x28daea=_0x65bd65[_0x3888d7(0x1c3)]%0x4==0x0||_0x65bd65['length']%0x4==0x3||_0x65bd65[_0x3888d7(0x1c3)]%0x3==0x1?0x4:0x3;let _0x4b4330=0x0;_0x65bd65[_0x3888d7(0x2ae)]((_0x3b994d,_0x53f3fc)=>{const _0x5d93b2=_0x3888d7;if(_0x53f3fc%_0x28daea==0x0)_0x8d1ee7=[];_0x8d1ee7[_0x5d93b2(0x2c9)]({'text':_0x5d93b2(0x1f2)+_0x3b994d[_0x5d93b2(0x21b)],'callback_data':_0x3b994d[_0x5d93b2(0x21b)]}),_0x53f3fc%_0x28daea==0x0&&(_0x13521f[_0x4b4330]=_0x8d1ee7,_0x4b4330++);}),tgBot[_0x3888d7(0x1e8)](_0x67f510[_0x3888d7(0x1f1)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x13521f}})[_0x3888d7(0x2af)](_0x3b94fe=>{telegramError(_0x3b94fe);}),tgBot['on']('callback_query',async _0x5d11c0=>{const _0x3f4ee3=_0x3888d7,_0x973342=_0x5d11c0[_0x3f4ee3(0x1fb)],_0x49a95e=_0x5d11c0[_0x3f4ee3(0x278)];tgBot[_0x3f4ee3(0x265)](_0x5d11c0['id'])[_0x3f4ee3(0x2e9)](async()=>{if(pid[_0x973342])pid[_0x973342]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x3f4ee3(0x1fa)]('callback_query');});}else{const _0x1ac9fa=_0x65bd65[0x0][_0x3888d7(0x21b)];if(pid[_0x1ac9fa])pid[_0x1ac9fa]['send']({'function':_0x3888d7(0x20c),'args':null});}}}),tgBot[_0x561190(0x1f0)](/\/update/,async _0x18ccbb=>{const _0x596686=_0x561190;if(!validateTelegram(_0x18ccbb))return;tgBot[_0x596686(0x1fa)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x596686(0x1e8)](_0x18ccbb[_0x596686(0x1f1)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x596686(0x2af)](_0x4e2e2a=>{telegramError(_0x4e2e2a);});else!validInstallation?tgBot['sendMessage'](_0x18ccbb[_0x596686(0x1f1)]['id'],_0x596686(0x1d9))[_0x596686(0x2af)](_0x43c16b=>{telegramError(_0x43c16b);}):(tgBot[_0x596686(0x1e8)](_0x18ccbb[_0x596686(0x1f1)]['id'],_0x596686(0x2bd),{'reply_markup':{'inline_keyboard':[[{'text':_0x596686(0x2c5),'callback_data':_0x596686(0x24c)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x3ee5ce=>{telegramError(_0x3ee5ce);}),tgBot['on'](_0x596686(0x233),async _0x1948be=>{const _0x4dbf94=_0x596686,_0x3e7841=_0x1948be[_0x4dbf94(0x1fb)],_0x18b0c1=_0x1948be['message'];tgBot[_0x4dbf94(0x265)](_0x1948be['id'])[_0x4dbf94(0x2e9)](async()=>{const _0x1a461a=_0x4dbf94;_0x3e7841==_0x1a461a(0x24c)&&(await tgBot['sendMessage'](_0x18b0c1[_0x1a461a(0x1f1)]['id'],_0x1a461a(0x177))['catch'](_0x178d03=>{telegramError(_0x178d03);}),updateBB());_0x3e7841=='no'&&await tgBot[_0x1a461a(0x1e8)](_0x18b0c1[_0x1a461a(0x1f1)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x1a461a(0x2af)](_0x40469a=>{telegramError(_0x40469a);});if(!settings[_0x1a461a(0x18f)])tgBot[_0x1a461a(0x1e8)](_0x18b0c1[_0x1a461a(0x1f1)]['id'],_0x1a461a(0x1f9))[_0x1a461a(0x2af)](_0x47c2bc=>{telegramError(_0x47c2bc);});}),tgBot[_0x4dbf94(0x1fa)]('callback_query');}));}),tgBot[_0x561190(0x1f0)](/\/toggle/,_0x47c716=>{const _0x43f6e0=_0x561190;if(!validateTelegram(_0x47c716))return;tgBot[_0x43f6e0(0x1fa)](_0x43f6e0(0x233));const _0x378591=getBotsWithMode();if(_0x378591[_0x43f6e0(0x1c3)]==0x0)tgBot[_0x43f6e0(0x1e8)](_0x47c716[_0x43f6e0(0x1f1)]['id'],_0x43f6e0(0x258))[_0x43f6e0(0x2af)](_0x27ddcc=>{telegramError(_0x27ddcc);});else{let _0x4bd7b6=[],_0x3db10b=[];const _0x54e581=0x2;let _0x6b9c9d=0x0;_0x378591[_0x43f6e0(0x2ae)]((_0x4d3c9e,_0x5c8f29)=>{const _0x3ed62c=_0x43f6e0;if(_0x5c8f29%_0x54e581==0x0)_0x3db10b=[];_0x3db10b[_0x3ed62c(0x2c9)]({'text':_0x3ed62c(0x1f2)+_0x4d3c9e[_0x3ed62c(0x21b)]+'\x20('+_0x4d3c9e[_0x3ed62c(0x19c)]+')','callback_data':_0x4d3c9e[_0x3ed62c(0x21b)]}),_0x5c8f29%_0x54e581==0x0&&(_0x4bd7b6[_0x6b9c9d]=_0x3db10b,_0x6b9c9d++);}),tgBot['sendMessage'](_0x47c716[_0x43f6e0(0x1f1)]['id'],_0x43f6e0(0x295),{'reply_markup':{'inline_keyboard':_0x4bd7b6}})[_0x43f6e0(0x2af)](_0x35994b=>{telegramError(_0x35994b);}),tgBot['on'](_0x43f6e0(0x233),async _0x506677=>{const _0x9b637b=_0x43f6e0,_0x5c33e9=_0x506677[_0x9b637b(0x1fb)],_0x4c0850=_0x506677[_0x9b637b(0x278)];tgBot[_0x9b637b(0x265)](_0x506677['id'])['then'](async()=>{const _0x196f4b=_0x9b637b,_0x5836a3=_0x378591[_0x196f4b(0x2e0)](_0x1d5dfc=>_0x1d5dfc[_0x196f4b(0x21b)]==_0x5c33e9),_0x5a83fb=_0x5836a3[_0x196f4b(0x19c)]=='auto'?_0x196f4b(0x284):_0x196f4b(0x184);tgBot[_0x196f4b(0x1e8)](_0x4c0850[_0x196f4b(0x1f1)]['id'],_0x196f4b(0x207)+_0x5c33e9+'\x20to\x20'+_0x5a83fb+'\x20mode')[_0x196f4b(0x2af)](_0x1e3de1=>{telegramError(_0x1e3de1);}),toggleBotMode(_0x5c33e9);}),tgBot[_0x9b637b(0x1fa)]('callback_query');});}}),tgBot[_0x561190(0x1f0)](/\/names/,_0x4ff810=>{const _0xbce67d=_0x561190;if(!validateTelegram(_0x4ff810))return;let _0x36c379='';config[_0xbce67d(0x2ae)](_0x158fb9=>{const _0x202e76=_0xbce67d;_0x36c379+='Bot\x20'+_0x158fb9['botID']+':\x20'+_0x158fb9[_0x202e76(0x240)]+'\x0a';}),tgBot[_0xbce67d(0x1e8)](_0x4ff810[_0xbce67d(0x1f1)]['id'],_0x36c379,{'parse_mode':'HTML'})[_0xbce67d(0x2af)](_0x26df80=>{telegramError(_0x26df80);});}),tgBot[_0x561190(0x1f0)](/\/disable/,_0x3e262c=>{const _0x3ed84c=_0x561190;if(!validateTelegram(_0x3e262c))return;tgBot[_0x3ed84c(0x1e8)](_0x3e262c[_0x3ed84c(0x1f1)]['id'],_0x3ed84c(0x1ae))[_0x3ed84c(0x2af)](_0x543ab5=>{telegramError(_0x543ab5);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x561190(0x1f0)](/\/help/,_0x38e229=>{const _0x185c54=_0x561190;if(!validateTelegram(_0x38e229))return;tgBot[_0x185c54(0x1e8)](_0x38e229[_0x185c54(0x1f1)]['id'],_0xf755d2)[_0x185c54(0x2af)](_0x31e1f2=>{telegramError(_0x31e1f2);});}),tgBot['on'](_0x561190(0x2dd),_0x167f57=>{const _0x34f1ff=_0x561190;_0x167f57['toString']()[_0x34f1ff(0x2e1)]('404\x20Not\x20Found')&&(logging(_0x34f1ff(0x18b)),tgBot[_0x34f1ff(0x1a3)](),tgBot=null,io['to']('botmanager')[_0x34f1ff(0x17d)](_0x34f1ff(0x2a1),_0x34f1ff(0x18b)));}),process['once'](_0x561190(0x264),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process['once'](_0x561190(0x28a),()=>{const _0x10fed9=_0x561190;if(tgBot)tgBot[_0x10fed9(0x1a3)]();process[_0x10fed9(0x267)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x58beed,_0x590673){const _0x3aece5=_0x39fa01;if(settings[_0x3aece5(0x2b9)]){if(settings[_0x3aece5(0x1a7)]==_0x3aece5(0x268)||(_0x590673['type']==_0x3aece5(0x2de)||_0x590673[_0x3aece5(0x2ab)]==_0x3aece5(0x19d))&&settings[_0x3aece5(0x1a7)]==_0x3aece5(0x201)||_0x590673['type']=='order'&&settings[_0x3aece5(0x1a7)]==_0x3aece5(0x27c)){if(tgBot&&settings[_0x3aece5(0x18f)]){if(_0x590673[_0x3aece5(0x190)])tgBot['sendMessage'](settings[_0x3aece5(0x18f)],_0x590673[_0x3aece5(0x240)]+_0x3aece5(0x2cf)+_0x590673[_0x3aece5(0x238)])[_0x3aece5(0x2af)](_0xecf5b1=>{telegramError(_0xecf5b1);});else tgBot[_0x3aece5(0x1e8)](settings[_0x3aece5(0x18f)],_0x3aece5(0x1f2)+_0x58beed+_0x3aece5(0x2cf)+_0x590673[_0x3aece5(0x238)])[_0x3aece5(0x2af)](_0x5d7179=>{telegramError(_0x5d7179);});}}}}async function sendTelegramMsg(_0x189329,_0x2a2049=_0x39fa01(0x1f4)){const _0x16fd95=_0x39fa01;return settings[_0x16fd95(0x2b9)]&&tgBot&&settings[_0x16fd95(0x18f)]?(await tgBot['sendMessage'](settings[_0x16fd95(0x18f)],_0x189329,{'parse_mode':_0x2a2049})[_0x16fd95(0x2af)](_0x5d5c99=>{telegramError(_0x5d5c99);}),!![]):![];}function getDeviceWithIp(_0x21e6ea){return devices['find'](_0x2a17f9=>_0x2a17f9['ip']===_0x21e6ea);}function _0x4860(_0x27ae9e,_0xfc6700){const _0xa7028a=_0x2719();return _0x4860=function(_0x20d365,_0x275e88){_0x20d365=_0x20d365-0x16e;let _0x27198a=_0xa7028a[_0x20d365];return _0x27198a;},_0x4860(_0x27ae9e,_0xfc6700);}function temporaryAccess2FA(_0x2d36f8,_0x2b6aa5){const _0x38698b=_0x39fa01;let _0x575be1=new Date(),_0x209425=![];if(lastIpApproval){if(_0x575be1-lastIpApproval<0x1388)_0x209425=!![];}lastIpApproval=new Date();if(_0x209425)return;tgBot&&settings[_0x38698b(0x18f)]&&(tgBot[_0x38698b(0x1fa)]('callback_query'),tgBot['sendMessage'](settings[_0x38698b(0x18f)],_0x38698b(0x213)+normalizeIP(_0x2b6aa5)['show']+_0x38698b(0x220),{'parse_mode':_0x38698b(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x38698b(0x294),'callback_data':'5'},{'text':_0x38698b(0x18c),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x38698b(0x239),'callback_data':_0x38698b(0x239)}]]}})[_0x38698b(0x2af)](_0x45a012=>{telegramError(_0x45a012);}),tgBot['on'](_0x38698b(0x233),async _0x5a309f=>{const _0x57820b=_0x38698b,_0x573f14=_0x5a309f[_0x57820b(0x1fb)],_0x4b18b5=_0x5a309f[_0x57820b(0x278)];tgBot[_0x57820b(0x265)](_0x5a309f['id'])[_0x57820b(0x2e9)](async()=>{const _0x11837c=_0x57820b;devices[_0x2d36f8][_0x11837c(0x230)]={'clientip':_0x2b6aa5,'timestamp':new Date()[_0x11837c(0x2cc)](),'expiry':_0x573f14},_0x573f14!=_0x11837c(0x239)?(await tgBot[_0x11837c(0x1e8)](_0x4b18b5[_0x11837c(0x1f1)]['id'],_0x11837c(0x2df)+_0x573f14+_0x11837c(0x200),{'parse_mode':_0x11837c(0x1f4)})[_0x11837c(0x2af)](_0x46b8d1=>{telegramError(_0x46b8d1);}),io['to'](_0x2d36f8)['emit'](_0x11837c(0x217),{'access':{'allow':![],'reason':_0x11837c(0x183),'token':null}})):(await tgBot[_0x11837c(0x1e8)](_0x4b18b5[_0x11837c(0x1f1)]['id'],'Temporary\x20access\x20rejected')[_0x11837c(0x2af)](_0xf8b4b3=>{telegramError(_0xf8b4b3);}),io['to'](_0x2d36f8)[_0x11837c(0x17d)]('status',{'access':{'allow':![],'reason':_0x11837c(0x2d4),'token':null}}));}),tgBot[_0x57820b(0x1fa)](_0x57820b(0x233));}));}function loginAccess2FA(_0x14b11d,_0xb1132c){const _0x546183=_0x39fa01;tgBot&&settings[_0x546183(0x18f)]&&(tgBot['removeListener'](_0x546183(0x233)),tgBot['sendMessage'](settings[_0x546183(0x18f)],_0x546183(0x228)+normalizeIP(_0xb1132c)[_0x546183(0x1d8)]+_0x546183(0x220),{'parse_mode':_0x546183(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x546183(0x2b3),'callback_data':loginExpiry},{'text':_0x546183(0x239),'callback_data':_0x546183(0x239)}]]}})[_0x546183(0x2af)](_0x48c89f=>{telegramError(_0x48c89f);}),tgBot['on'](_0x546183(0x233),async _0x185e4f=>{const _0x1c3f04=_0x546183,_0x3779a4=_0x185e4f[_0x1c3f04(0x1fb)],_0x2e0803=_0x185e4f[_0x1c3f04(0x278)];tgBot[_0x1c3f04(0x265)](_0x185e4f['id'])[_0x1c3f04(0x2e9)](async()=>{const _0x5b8298=_0x1c3f04;devices[_0x14b11d][_0x5b8298(0x23d)]={'clientip':_0xb1132c,'timestamp':new Date()[_0x5b8298(0x2cc)](),'expiry':_0x3779a4},_0x3779a4!=_0x5b8298(0x239)?(await tgBot[_0x5b8298(0x1e8)](_0x2e0803[_0x5b8298(0x1f1)]['id'],'Login\x20accepted',{'parse_mode':_0x5b8298(0x1f4)})[_0x5b8298(0x2af)](_0x45e0d0=>{telegramError(_0x45e0d0);}),io['to'](_0x14b11d)['emit'](_0x5b8298(0x217),{'access':{'allow':![],'reason':_0x5b8298(0x183),'token':null}})):(await tgBot[_0x5b8298(0x1e8)](_0x2e0803[_0x5b8298(0x1f1)]['id'],_0x5b8298(0x25b))[_0x5b8298(0x2af)](_0x237496=>{telegramError(_0x237496);}),io['to'](_0x14b11d)[_0x5b8298(0x17d)]('status',{'access':{'allow':![],'reason':_0x5b8298(0x1da),'token':null}}));}),tgBot['removeListener'](_0x1c3f04(0x233));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x419b07=_0x39fa01;return dbConfig[_0x419b07(0x1c5)]('bots')[_0x419b07(0x27f)](_0x419b07(0x21b))[_0x419b07(0x1b3)]({'status':_0x419b07(0x22e)})[_0x419b07(0x224)]()||[];}function getDisabledBots(){const _0x1c87c3=_0x39fa01;return dbConfig[_0x1c87c3(0x1c5)](_0x1c87c3(0x20a))['sortBy'](_0x1c87c3(0x21b))[_0x1c87c3(0x1b3)]({'status':_0x1c87c3(0x2a5)})['value']()||[];}function getBotsWithMode(){const _0x3c8e3b=_0x39fa01,_0x2a68ce=dbConfig[_0x3c8e3b(0x1c5)](_0x3c8e3b(0x20a))[_0x3c8e3b(0x27f)](_0x3c8e3b(0x21b))[_0x3c8e3b(0x224)]()||[];return _0x2a68ce[_0x3c8e3b(0x2ae)](_0x200a66=>{const _0xee8d02=_0x3c8e3b,_0x18a554=configpath+_0xee8d02(0x1bf)+_0x200a66['botID']+'-config.json',_0x47ca54=fs['existsSync'](_0x18a554);if(_0x47ca54){const _0x2f27c0=fs['readFileSync'](_0x18a554);try{const _0x4303de=JSON[_0xee8d02(0x1d7)](_0x2f27c0),_0x5e2616=_0x4303de?_0x4303de[_0xee8d02(0x2d9)][0x0][_0xee8d02(0x29f)]:![];_0x200a66['mode']=_0x5e2616?'auto':'manual';}catch(_0x170ed6){_0x200a66['mode']=_0xee8d02(0x284);}}else _0x200a66[_0xee8d02(0x19c)]=_0xee8d02(0x284);}),_0x2a68ce;}function getSettings(){const _0x88ca26=_0x39fa01;let _0x191e6f=dbSettings['get'](_0x88ca26(0x1a1))[_0x88ca26(0x224)]();if(!_0x191e6f){const _0x54c3fa=crypto[_0x88ca26(0x262)]();mixpanel['alias'](_0x54c3fa),_0x191e6f={'timeshift':0x0,'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x88ca26(0x2aa),'userid':_0x54c3fa},dbSettings[_0x88ca26(0x1c5)](_0x88ca26(0x1a1))[_0x88ca26(0x2c9)](_0x191e6f)[_0x88ca26(0x1b4)]();}return _0x191e6f;}function getSecure(){const _0x11c059=_0x39fa01;return dbSecure[_0x11c059(0x1c5)](_0x11c059(0x22b))[_0x11c059(0x224)]()||{};}function getBlacklist(){const _0x573940=_0x39fa01;return dbSecure['get'](_0x573940(0x171))[_0x573940(0x224)]()||[];}function broadcastToBots(_0x5013b0,_0x576dc6){const _0x4901b9=_0x39fa01;config[_0x4901b9(0x2ae)](_0xb91552=>{const _0x10da89=_0x4901b9;if(_0xb91552[_0x10da89(0x217)]==_0x10da89(0x22e)&&_0xb91552[_0x10da89(0x1a6)]==_0x10da89(0x1a9)){if(pid[_0xb91552['botID']])pid[_0xb91552[_0x10da89(0x21b)]][_0x10da89(0x276)]({[_0x5013b0]:_0x576dc6});}});}function storeSettings(_0x4f4169,_0xe8c908=![]){const _0x4f38aa=_0x39fa01;_0x4f4169={...settings,..._0x4f4169};if(_0xe8c908&&_0x4f4169[_0x4f38aa(0x2c4)]!='************'&&_0x4f4169[_0x4f38aa(0x2c4)]!=''){const _0x164fac=crypt[_0x4f38aa(0x263)](secure[_0x4f38aa(0x1f7)],_0x4f4169[_0x4f38aa(0x2c4)])['message'][_0x4f38aa(0x232)]('@')[0x0],_0x46e523=bcrypt[_0x4f38aa(0x298)](_0x164fac,saltRounds);_0x4f4169={..._0x4f4169,'bbPassword':_0x46e523};}if(_0xe8c908&&_0x4f4169[_0x4f38aa(0x27a)]!=_0x4f38aa(0x18d)&&_0x4f4169[_0x4f38aa(0x27a)]!=''){const _0x7ca142=crypt[_0x4f38aa(0x263)](secure['privateKey'],_0x4f4169[_0x4f38aa(0x27a)])[_0x4f38aa(0x278)][_0x4f38aa(0x232)]('@')[0x0];_0x4f4169={..._0x4f4169,'telegramToken':_0x7ca142};}const _0x246d58=_0x4f4169[_0x4f38aa(0x27a)]!=_0x4f38aa(0x18d)&&_0x4f4169[_0x4f38aa(0x27a)]!=settings[_0x4f38aa(0x27a)]||_0x4f4169['telegramUsername']!=settings[_0x4f38aa(0x25f)],_0x3429cd=_0x4f4169[_0x4f38aa(0x27a)]==''||_0x4f4169[_0x4f38aa(0x25f)]=='';if(_0x246d58)_0x4f4169[_0x4f38aa(0x1a7)]=_0x4f38aa(0x268);for(const [_0x126d8d,_0x5795e2]of Object[_0x4f38aa(0x1bc)](_0x4f4169)){if(_0x126d8d==_0x4f38aa(0x27a)&&_0x5795e2==_0x4f38aa(0x18d)){_0x4f4169[_0x4f38aa(0x27a)]=settings[_0x4f38aa(0x27a)];continue;};if(_0x126d8d==_0x4f38aa(0x2c4)&&_0x5795e2==_0x4f38aa(0x18d)){_0x4f4169[_0x4f38aa(0x2c4)]=settings[_0x4f38aa(0x2c4)];continue;};dbSettings[_0x4f38aa(0x256)](_0x4f38aa(0x214)+_0x126d8d,_0x5795e2)[_0x4f38aa(0x1b4)]();}settings=_0x4f4169,io['to'](_0x4f38aa(0x1e3))[_0x4f38aa(0x17d)](_0x4f38aa(0x1a1),cleanSettings()),broadcastToBots(_0x4f38aa(0x210),settings[_0x4f38aa(0x210)]);if(_0x246d58&&!_0x3429cd)initTelegram();if(_0x246d58&&_0x3429cd)disableTelegram();getAllClients()[_0x4f38aa(0x2ae)](_0x340ca8=>{const _0x16afc0=_0x4f38aa;getSocket(_0x340ca8['id'])[_0x16afc0(0x17d)](_0x16afc0(0x217),{'access':{'allow':![],'reason':_0x16afc0(0x183),'token':null}});});}function updateSetting(_0x511c42,_0x593e4e){const _0x28124b=_0x39fa01;dbSettings[_0x28124b(0x256)](_0x28124b(0x214)+_0x511c42,_0x593e4e)[_0x28124b(0x1b4)](),settings=getSettings(),io['to'](_0x28124b(0x1e3))[_0x28124b(0x17d)]('settings',cleanSettings());}function storeSecure(_0x2f69da){const _0x596c88=_0x39fa01;dbSecure[_0x596c88(0x1c5)]('secure')['push'](_0x2f69da)['write'](),secure=_0x2f69da;}function addBlacklist(_0x3131cf){const _0x22a2a9=_0x39fa01;cleanBlacklist();let _0x521a7f;devices[_0x3131cf]['telegramIpApproval']?_0x521a7f=Math['max'](devices[_0x3131cf][_0x22a2a9(0x230)][_0x22a2a9(0x1e9)],loginExpiry):_0x521a7f=loginExpiry,dbSecure[_0x22a2a9(0x1c5)]('blacklist')[_0x22a2a9(0x2c9)]({'expiry':new Date()[_0x22a2a9(0x2cc)]()+_0x521a7f*0x3c*0x3e8,'token':devices[_0x3131cf]['access']['token']})[_0x22a2a9(0x1b4)](),blacklist=dbSecure[_0x22a2a9(0x1c5)](_0x22a2a9(0x171))['value']();}function cleanBlacklist(){const _0x32cfd3=_0x39fa01;let _0x3ac7c8=dbSecure[_0x32cfd3(0x1c5)](_0x32cfd3(0x171))['cloneDeep']()['value'](),_0x492471=new Date()[_0x32cfd3(0x2cc)]();_0x3ac7c8['forEach'](_0xf30132=>{const _0xade4b3=_0x32cfd3;_0xf30132[_0xade4b3(0x1e9)]<_0x492471&&dbSecure[_0xade4b3(0x1c5)]('blacklist')[_0xade4b3(0x187)]({'expiry':_0xf30132[_0xade4b3(0x1e9)]})[_0xade4b3(0x1b4)]();});}function initStates(){const _0x1c8293=_0x39fa01;let _0xacd4e6=getConfiguration();_0xacd4e6[_0x1c8293(0x2ae)](_0x139802=>{const _0x539e53=_0x1c8293;_0x139802[_0x539e53(0x1a6)]=_0x539e53(0x1dd);}),storeConfiguration(_0xacd4e6);}function onKeys(){const _0x49c966=new RSA();return new Promise(_0x45bdaa=>{const _0x2bc448=_0x4860;_0x49c966[_0x2bc448(0x252)]()[_0x2bc448(0x2e9)](_0x29abf6=>{_0x45bdaa(_0x29abf6);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1735e8=_0x39fa01;let _0x2dc657=getSettings(),_0x2a3b21=![];!_0x2dc657['hasOwnProperty'](_0x1735e8(0x21a))&&(_0x2dc657[_0x1735e8(0x21a)]=0x0,_0x2a3b21=!![]);!_0x2dc657[_0x1735e8(0x1f6)]('lastmsgemitted')&&(_0x2dc657[_0x1735e8(0x27b)]=0x0,_0x2a3b21=!![]);!_0x2dc657[_0x1735e8(0x1f6)](_0x1735e8(0x17c))&&(_0x2dc657['latestversion']=_0x1735e8(0x2aa),_0x2a3b21=!![]);!_0x2dc657[_0x1735e8(0x1f6)](_0x1735e8(0x28d))&&(_0x2dc657['userid']=uuidRandom(),mixpanel['alias'](_0x2dc657[_0x1735e8(0x28d)]),_0x2a3b21=!![]);if(_0x2a3b21)storeSettings(_0x2dc657);}function storeConfiguration(_0x1fea67){const _0x59ea0f=_0x39fa01;dbConfig[_0x59ea0f(0x1c5)](_0x59ea0f(0x20a))[_0x59ea0f(0x187)]()[_0x59ea0f(0x1b4)](),_0x1fea67[_0x59ea0f(0x2ae)](_0x53090e=>{delete _0x53090e['mode'];}),dbConfig[_0x59ea0f(0x1c5)](_0x59ea0f(0x20a))[_0x59ea0f(0x2c9)](..._0x1fea67)[_0x59ea0f(0x1b4)](),config=_0x1fea67;}function resetPassword(){const _0x5785b9=_0x39fa01;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x5785b9(0x233)),tgBot[_0x5785b9(0x1e8)](settings[_0x5785b9(0x18f)],_0x5785b9(0x2ea),{'parse_mode':_0x5785b9(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x5785b9(0x24c),'callback_data':_0x5785b9(0x24c)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x4e9340=>{telegramError(_0x4e9340);}),tgBot['on']('callback_query',async _0x4ca990=>{const _0x2189b9=_0x5785b9,_0x24b204=_0x4ca990[_0x2189b9(0x1fb)],_0x1465e1=_0x4ca990[_0x2189b9(0x278)];tgBot[_0x2189b9(0x265)](_0x4ca990['id'])[_0x2189b9(0x2e9)](async()=>{const _0x285171=_0x2189b9;if(_0x24b204!='no'){const _0x128963=0xf,_0x1e560d=_0x285171(0x175),_0x6d9a1c=Array[_0x285171(0x1d3)](crypto['randomFillSync'](new Uint32Array(_0x128963)))[_0x285171(0x27e)](_0x55659b=>_0x1e560d[_0x55659b%_0x1e560d[_0x285171(0x1c3)]])['join'](''),_0x147331=bcrypt[_0x285171(0x298)](_0x6d9a1c,saltRounds);storeSettings({'bbPassword':_0x147331}),await tgBot[_0x285171(0x1e8)](_0x1465e1[_0x285171(0x1f1)]['id'],_0x285171(0x1c6)+_0x6d9a1c,{'parse_mode':_0x285171(0x1f4)})[_0x285171(0x2af)](_0x408856=>{telegramError(_0x408856);});}else await tgBot[_0x285171(0x1e8)](_0x1465e1['chat']['id'],_0x285171(0x26a))[_0x285171(0x2af)](_0x5282ca=>{telegramError(_0x5282ca);});}),tgBot[_0x2189b9(0x1fa)](_0x2189b9(0x233));}));}function logging(_0x1bf7e0){const _0x361f1e=_0x39fa01;console[_0x361f1e(0x27d)](getTimeStamp()+_0x361f1e(0x197)+_0x1bf7e0);if(tgBot&&settings[_0x361f1e(0x18f)]&&settings['telegramEvents']!=_0x361f1e(0x27c))tgBot[_0x361f1e(0x1e8)](settings[_0x361f1e(0x18f)],_0x361f1e(0x1ee)+_0x1bf7e0)[_0x361f1e(0x2af)](_0x31153a=>{telegramError(_0x31153a);});}function getServerTime(){const _0x312d5a=_0x39fa01,_0x8b798c=new Date();return _0x8b798c[_0x312d5a(0x25c)]()+'/'+(_0x8b798c[_0x312d5a(0x250)]()+0x1)[_0x312d5a(0x254)]()['padStart'](0x2,'0')+'/'+_0x8b798c[_0x312d5a(0x1ec)]()['toString']()[_0x312d5a(0x23e)](0x2,'0')+'\x20'+_0x8b798c[_0x312d5a(0x1ad)]()[_0x312d5a(0x254)]()[_0x312d5a(0x23e)](0x2,'0')+':'+_0x8b798c[_0x312d5a(0x296)]()[_0x312d5a(0x254)]()[_0x312d5a(0x23e)](0x2,'0')+':'+_0x8b798c['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1c543b=_0x39fa01,_0x46616a=shiftedTime();return _0x46616a[_0x1c543b(0x25c)]()+'/'+(_0x46616a[_0x1c543b(0x250)]()+0x1)[_0x1c543b(0x254)]()[_0x1c543b(0x23e)](0x2,'0')+'/'+_0x46616a[_0x1c543b(0x1ec)]()['toString']()[_0x1c543b(0x23e)](0x2,'0')+'\x20'+_0x46616a['getHours']()[_0x1c543b(0x254)]()[_0x1c543b(0x23e)](0x2,'0')+':'+_0x46616a[_0x1c543b(0x296)]()[_0x1c543b(0x254)]()['padStart'](0x2,'0')+':'+_0x46616a[_0x1c543b(0x26b)]()[_0x1c543b(0x254)]()[_0x1c543b(0x23e)](0x2,'0');}function shiftedTime(){const _0x16932b=_0x39fa01,_0x2e88d8=new Date();let _0x4dc54a=_0x2e88d8;if(settings[_0x16932b(0x210)]&&settings[_0x16932b(0x210)]!==0x0)_0x4dc54a=fns['add'](_0x2e88d8,{'hours':settings[_0x16932b(0x210)]});return _0x4dc54a;}function startScheduler(){const _0x2685f3=_0x39fa01;let _0x36ac7b=new Date()[_0x2685f3(0x255)]();_0x36ac7b==0x1&&backupConfigFiles();_0x36ac7b==0x9&&triggerAnalytics();_0x36ac7b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x110136=_0x39fa01;fs[_0x110136(0x2c2)](configpath,{'withFileTypes':!![]})[_0x110136(0x2ae)](_0x41360b=>{const _0x11597f=_0x110136;if(!_0x41360b['isDirectory']())fs[_0x11597f(0x1de)](configpath+_0x41360b['name'],configbackuppath+_0x41360b[_0x11597f(0x2ca)]);});}async function getPublicIp(){const _0x4b6d95=_0x39fa01;try{const _0x2438f9=await axios[_0x4b6d95(0x1c5)]('https://api.ipify.org?format=json');publicip=_0x2438f9[_0x4b6d95(0x1fb)]['ip'];}catch(_0x265df1){}}async function triggerAnalytics(_0x40d96c=![]){const _0x31fc9c=_0x39fa01;if(!publicip)await getPublicIp();const _0x194539=getBotsWithMode();let _0x22d7d8=0x0;_0x194539[_0x31fc9c(0x2ae)](_0x5e170a=>{const _0x2311a6=_0x31fc9c;if(_0x5e170a[_0x2311a6(0x217)]===_0x2311a6(0x22e))_0x22d7d8++;}),mixpanel['track']('Server',{'distinct_id':settings[_0x31fc9c(0x28d)],'ip':publicip,'version':serverversion,'numbots':_0x194539[_0x31fc9c(0x1c3)],'numbotsenabled':_0x22d7d8}),!_0x40d96c&&analytics['page']({'title':_0x31fc9c(0x2e6),'href':_0x31fc9c(0x1eb),'path':'/v'+serverversion});}async function getMessages(){const _0xd846c6=_0x39fa01,_0x30f052=_0xd846c6(0x2b1),_0x8002b7=new GraphQLClient(_0x30f052),_0x55c722={'authorization':_0xd846c6(0x2b8)},_0x137ace=serverversion[_0xd846c6(0x232)]('.'),_0x4c3d63=_0x137ace[0x0]+'.'+_0x137ace[0x1],_0xec15b9=Math[_0xd846c6(0x2c8)](settings[_0xd846c6(0x21a)],settings[_0xd846c6(0x27b)]),_0xd9e12e={'last':parseInt(_0xec15b9),'bbm':_0x4c3d63},_0x4bce72=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x495ac6;try{_0x495ac6=await _0x8002b7[_0xd846c6(0x2db)](_0x4bce72,_0xd9e12e,_0x55c722);}catch(_0xc82ef9){}if(_0x495ac6&&_0x495ac6[_0xd846c6(0x25e)]){let _0x3d8440=settings['lastmsgtelegram'];for(const _0x14f6e1 of _0x495ac6[_0xd846c6(0x25e)]){newMessages[_0xd846c6(0x2c9)](_0x14f6e1);if(_0x14f6e1[_0xd846c6(0x1e5)])updateSetting('latestversion',_0x14f6e1[_0xd846c6(0x1e5)]);let _0x443069=_0x14f6e1[_0xd846c6(0x1e5)]?serverversion>=_0x14f6e1[_0xd846c6(0x1e5)]:![];if(!_0x443069&&_0x14f6e1[_0xd846c6(0x1c0)]>_0x3d8440){if(_0x14f6e1[_0xd846c6(0x28b)]==='any'||serverversion[_0xd846c6(0x26f)](_0x14f6e1[_0xd846c6(0x28b)])){let _0x562e82=''+_0x14f6e1[_0xd846c6(0x248)]+'\x0a\x0a'+_0x14f6e1[_0xd846c6(0x278)];const _0x304673=await sendTelegramMsg(toTelegramMarkdown(_0x562e82),'Markdown');if(_0x304673)_0x3d8440=_0x14f6e1[_0xd846c6(0x1c0)];}}}updateAvailable=isNewerVersion(settings[_0xd846c6(0x17c)],serverversion),updateSetting(_0xd846c6(0x21a),_0x3d8440),emitMessages();}}function emitMessages(){const _0x171404=_0x39fa01,_0x536441=settings[_0x171404(0x27b)];let _0x3f6e1b=[];newMessages[_0x171404(0x2ae)](_0x5b7db2=>{const _0x355467=_0x171404;_0x5b7db2[_0x355467(0x1c0)]>_0x536441&&_0x3f6e1b[_0x355467(0x2c9)](_0x5b7db2);}),_0x3f6e1b['length']>0x0&&getAllClients()['forEach'](_0xa50b60=>{getSocket(_0xa50b60['id'])['emit']('message',_0x3f6e1b);});}function confirmMessage(_0x5c397c){const _0x57a9ca=_0x39fa01;updateSetting(_0x57a9ca(0x27b),Number(_0x5c397c));}function isNewerVersion(_0xedcacb,_0x320238){const _0x3ead80=_0x39fa01,_0x3652c5=_0x320238[_0x3ead80(0x232)]('.'),_0x1fac10=_0xedcacb[_0x3ead80(0x232)]('.');for(var _0x1c5889=0x0;_0x1c5889<_0x1fac10[_0x3ead80(0x1c3)];_0x1c5889++){const _0x31d574=~~_0x1fac10[_0x1c5889],_0x48ae7f=~~_0x3652c5[_0x1c5889];if(_0x31d574>_0x48ae7f)return!![];if(_0x31d574<_0x48ae7f)return![];}return![];}function toTelegramMarkdown(_0x109bf6){const _0x4b8115=_0x39fa01,_0x1e13ea=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4fe682=/\*{2}(.+?)\*{2}/gim;return _0x109bf6=_0x109bf6[_0x4b8115(0x1df)](_0x1e13ea,_0x4b8115(0x1a0))['replace'](_0x4fe682,_0x4b8115(0x188)),_0x109bf6;}function validateCredentials(_0x70bb6d,_0x420137){const _0x2d8b20=_0x39fa01;if(_0x70bb6d[_0x2d8b20(0x19a)]==settings[_0x2d8b20(0x1c2)]&&bcrypt[_0x2d8b20(0x1ed)](_0x70bb6d['password'],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4655b1=generateLoginToken(_0x420137);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4655b1};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x3bc5e3){const _0x3f8bf5=_0x39fa01,_0xa1e466=generateLoginToken(_0x3bc5e3);return{'allow':!![],'reason':_0x3f8bf5(0x1c4),'token':_0xa1e466};}function validateAccess(_0x12a2e1,_0x9b3d12){const _0x4ad605=_0x39fa01;let _0x58d0fc=devices[_0x9b3d12]['ip'],_0x2cb1fb;const _0x1cb48e=_0x39e667=>{const _0x20ac9d=_0x4860;if(settings[_0x20ac9d(0x222)]){if(settings[_0x20ac9d(0x17a)]){if(telegram2FaApproved(_0x9b3d12)){const _0x255855=generateLoginToken(_0x9b3d12);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x255855};}else return{'allow':![],'reason':_0x20ac9d(0x2da),'token':null};}else return _0x2cb1fb=validToken(_0x39e667,_0x9b3d12),_0x2cb1fb[_0x20ac9d(0x1f6)]('success')?{'allow':!![],'reason':_0x20ac9d(0x204),'token':_0x39e667}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x20ac9d(0x2d8),'token':null};};if(settings[_0x4ad605(0x244)]){let _0x57e6f0=[...settings[_0x4ad605(0x24d)],_0x4ad605(0x225),_0x4ad605(0x253),'127.0.0.1'];if(_0x57e6f0['includes'](_0x58d0fc))return _0x1cb48e(_0x12a2e1);else{_0x2cb1fb=validToken(_0x12a2e1,_0x9b3d12);if(_0x2cb1fb['hasOwnProperty'](_0x4ad605(0x19d)))return _0x1cb48e(_0x12a2e1);else{if(telegramIpApproved(_0x9b3d12)){const _0x16ae3f=generateToken(_0x9b3d12);return _0x2cb1fb=_0x1cb48e(_0x12a2e1),_0x2cb1fb[_0x4ad605(0x218)]?{'allow':!![],'reason':_0x4ad605(0x1c9),'token':_0x16ae3f}:_0x2cb1fb;}else return settings[_0x4ad605(0x1dc)]?{'allow':![],'reason':_0x4ad605(0x2e2),'token':null}:{'allow':![],'reason':_0x4ad605(0x192),'token':null};}}}else return _0x1cb48e(_0x12a2e1);}function timelyDecrypt(_0xbd091c,_0x5570d2=!![]){const _0x329e1e=_0x39fa01;if(_0xbd091c)try{const _0xa67d58=crypt[_0x329e1e(0x263)](secure[_0x329e1e(0x1f7)],_0xbd091c)[_0x329e1e(0x278)],_0x16614a=_0xa67d58[_0x329e1e(0x232)]('@')[0x0],_0x36db82=_0xa67d58[_0x329e1e(0x232)]('@')[0x1],_0x36de6b=new Date()[_0x329e1e(0x2cc)]();if(_0x5570d2){if(_0x36de6b-_0x36db82<maxSecretAge*0x3e8)return _0x16614a;else return![];}else return _0x16614a;}catch(_0xb6b082){return![];}else return![];}const validToken=(_0x22c605,_0x4f5062)=>{const _0x16275e=_0x39fa01,_0x3601b3=devices[_0x4f5062]['ip'];if(!_0x22c605)return{'error':_0x16275e(0x1fe)};for(let _0x4953d2 of blacklist){if(_0x4953d2[_0x16275e(0x20b)]==_0x22c605)return{'error':_0x16275e(0x189)};}let _0x59069f;try{_0x59069f=jwt[_0x16275e(0x271)](_0x22c605,secure[_0x16275e(0x2a4)]+_0x4f5062);}catch{return{'error':_0x16275e(0x1fc)};}if(!_0x59069f[_0x16275e(0x1f6)](_0x16275e(0x1d0))&&!_0x59069f[_0x16275e(0x1f6)](_0x16275e(0x19a))||!_0x59069f[_0x16275e(0x1f6)](_0x16275e(0x246)))return{'error':_0x16275e(0x24a)};if(!_0x59069f[_0x16275e(0x1f6)]('username')&&_0x59069f[_0x16275e(0x1f6)]('clientip')){const {clientip:_0x2cb8ba}=_0x59069f;return _0x3601b3==_0x2cb8ba?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x16275e(0x29c)};}else{if(_0x59069f['hasOwnProperty'](_0x16275e(0x19a))&&_0x59069f[_0x16275e(0x1f6)]('clientip')){const {username:_0x3d31f0,clientip:_0x1952d5}=_0x59069f;return settings['bbUsername']==_0x3d31f0&&_0x3601b3==_0x1952d5?{'success':_0x16275e(0x26c)}:{'error':_0x16275e(0x2ba)};}}},generateLoginToken=_0x578aa8=>{const _0x43c335=_0x39fa01;if(_0x578aa8){const _0x16587c=devices[_0x578aa8]['ip'];return jwt['sign']({'username':settings[_0x43c335(0x1c2)],'clientip':_0x16587c},secure['secret']+_0x578aa8,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5c59b9=>{const _0x5e0046=_0x39fa01;if(_0x5c59b9){const _0x61c66b=devices[_0x5c59b9]['ip'];return jwt[_0x5e0046(0x18a)]({'clientip':_0x61c66b},secure[_0x5e0046(0x2a4)]+_0x5c59b9,{'expiresIn':devices[_0x5c59b9]['telegramIpApproval'][_0x5e0046(0x1e9)]*0x3c});}else return![];},telegramIpApproved=_0x296dc5=>{const _0x43db90=_0x39fa01;let _0x208b54=![];return devices[_0x296dc5][_0x43db90(0x230)]&&devices[_0x296dc5][_0x43db90(0x230)][_0x43db90(0x1e9)]!=_0x43db90(0x239)&&(_0x208b54=devices[_0x296dc5][_0x43db90(0x230)][_0x43db90(0x1d0)]==devices[_0x296dc5]['ip']&&new Date()[_0x43db90(0x2cc)]()-devices[_0x296dc5]['telegramIpApproval'][_0x43db90(0x18e)]<devices[_0x296dc5][_0x43db90(0x230)][_0x43db90(0x1e9)]*0x3c*0x3e8),_0x208b54;},telegram2FaApproved=_0x3c8ad2=>{const _0x4cb228=_0x39fa01;let _0x417585=![];return devices[_0x3c8ad2]['telegram2FaApproval']&&devices[_0x3c8ad2]['telegram2FaApproval'][_0x4cb228(0x1e9)]!=_0x4cb228(0x239)&&(_0x417585=devices[_0x3c8ad2][_0x4cb228(0x23d)]['clientip']==devices[_0x3c8ad2]['ip']&&new Date()[_0x4cb228(0x2cc)]()-devices[_0x3c8ad2][_0x4cb228(0x23d)][_0x4cb228(0x18e)]<devices[_0x3c8ad2][_0x4cb228(0x23d)][_0x4cb228(0x1e9)]*0x3c*0x3e8),_0x417585;},normalizeIP=_0x37b3cc=>{const _0x1b6285=_0x39fa01;let _0x5084a8=null,_0x3d49e8=null;if(ipaddr[_0x1b6285(0x226)](_0x37b3cc)){const _0x7a68e7=ipaddr[_0x1b6285(0x1d7)](_0x37b3cc);_0x7a68e7[_0x1b6285(0x211)]()==='ipv6'?(_0x7a68e7[_0x1b6285(0x29e)]()&&(_0x5084a8=_0x7a68e7[_0x1b6285(0x195)]()[_0x1b6285(0x254)]()),_0x3d49e8=_0x7a68e7[_0x1b6285(0x254)]()):(_0x5084a8=_0x7a68e7['toString'](),_0x3d49e8=_0x7a68e7[_0x1b6285(0x1c8)]()['toString']());}return{'show':_0x5084a8?_0x5084a8:_0x3d49e8,'store':_0x3d49e8};};function sleep(_0x38b6cd){return new Promise(_0x428f98=>setTimeout(_0x428f98,_0x38b6cd));}