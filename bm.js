const _0x423760=_0x2929;(function(_0x502372,_0x226e2b){const _0x50dd45=_0x2929,_0x3ac8bf=_0x502372();while(!![]){try{const _0x1efcc9=-parseInt(_0x50dd45(0x1cf))/0x1*(parseInt(_0x50dd45(0x2e9))/0x2)+-parseInt(_0x50dd45(0x2fa))/0x3+parseInt(_0x50dd45(0x1dd))/0x4+-parseInt(_0x50dd45(0x28d))/0x5*(-parseInt(_0x50dd45(0x2aa))/0x6)+parseInt(_0x50dd45(0x25b))/0x7+-parseInt(_0x50dd45(0x2e8))/0x8+parseInt(_0x50dd45(0x1da))/0x9*(-parseInt(_0x50dd45(0x1b1))/0xa);if(_0x1efcc9===_0x226e2b)break;else _0x3ac8bf['push'](_0x3ac8bf['shift']());}catch(_0x424a00){_0x3ac8bf['push'](_0x3ac8bf['shift']());}}}(_0x2060,0x1f7af));const _0x4a62ad=function(){let _0x4a43c2=!![];return function(_0x3e9984,_0x2cd7b3){const _0x2ed1de=_0x4a43c2?function(){const _0x34c1fe=_0x2929;if(_0x2cd7b3){const _0x434b28=_0x2cd7b3[_0x34c1fe(0x218)](_0x3e9984,arguments);return _0x2cd7b3=null,_0x434b28;}}:function(){};return _0x4a43c2=![],_0x2ed1de;};}(),_0x4e08d8=_0x4a62ad(this,function(){const _0x4f4cbd=_0x2929;return _0x4e08d8[_0x4f4cbd(0x205)]()[_0x4f4cbd(0x1ae)](_0x4f4cbd(0x186))[_0x4f4cbd(0x205)]()['constructor'](_0x4e08d8)[_0x4f4cbd(0x1ae)](_0x4f4cbd(0x186));});_0x4e08d8();'use strict';process[_0x423760(0x1a3)][_0x423760(0x212)]=0x1;const childProcess=require(_0x423760(0x12f)),fs=require('fs'),fns=require('date-fns'),low=require(_0x423760(0x2e4)),FileSync=require(_0x423760(0x203)),path=require(_0x423760(0x2f1)),crypto=require(_0x423760(0x151)),Crypt=require('hybrid-crypto-js')[_0x423760(0x201)],RSA=require(_0x423760(0x2ab))['RSA'],bcrypt=require(_0x423760(0x27d)),jwt=require('jsonwebtoken'),ipaddr=require(_0x423760(0x13a)),argv=require('yargs/yargs')(process[_0x423760(0x1ee)][_0x423760(0x24c)](0x2))[_0x423760(0x1ee)],uuidRandom=require(_0x423760(0x27b)),TelegramBot=require(_0x423760(0x23d)),Mixpanel=require(_0x423760(0x280)),axios=require(_0x423760(0x150)),{GraphQLClient,gql}=require(_0x423760(0x230)),util=require(_0x423760(0x2e3)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x423760(0x11d)]||_0x423760(0x29b),pattern=/^[0-9]{2,4}$/;!pattern[_0x423760(0x1e3)](PORT)&&(console[_0x423760(0x17f)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x423760(0x2e6)),process[_0x423760(0x184)](0x1));const HOST=argv[_0x423760(0x1ac)]||null,userID=argv[_0x423760(0x1b9)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x423760(0x1dc)];let bbpath=_0x423760(0x2b1),bbpath2='';const botfile=_0x423760(0x123),configfile=_0x423760(0x2d1),settingsfile=_0x423760(0x158),securefile=_0x423760(0x1ed),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x423760(0x216)),configpath=userID?bbpath+_0x423760(0x134)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x423760(0x29d)+userID+'/':bbpath+_0x423760(0x29d),zippath=userID?bbpath+_0x423760(0x13e)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x423760(0x13d)+userID+'/':bbpath+_0x423760(0x13d);!fs[_0x423760(0x195)](configpath)&&fs[_0x423760(0x255)](configpath);!fs[_0x423760(0x195)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x423760(0x195)](logspath)&&fs[_0x423760(0x255)](logspath);!fs[_0x423760(0x195)](zippath)&&fs[_0x423760(0x255)](zippath);!fs[_0x423760(0x195)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x423760(0x2cf)]({'bots':[]})[_0x423760(0x237)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x423760(0x286),'onepagemode':![]}})[_0x423760(0x237)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x423760(0x237)]();let crypt=new Crypt({'md':_0x423760(0x209),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x423760(0x1ad)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;function _0x2929(_0x592bee,_0x1d7647){const _0x1de158=_0x2060();return _0x2929=function(_0x4e08d8,_0x4a62ad){_0x4e08d8=_0x4e08d8-0x11c;let _0x20604f=_0x1de158[_0x4e08d8];return _0x20604f;},_0x2929(_0x592bee,_0x1d7647);}if(settings['telegramToken']&&settings[_0x423760(0x213)]!=''&&settings[_0x423760(0x1a7)]&&settings[_0x423760(0x1a7)]!='')initTelegram();const parseColor=(_0x1cae6d,_0x34edc5)=>{const _0x34f7db=_0x423760,_0x182dd0=/#[A-Z]{3}#/g;!_0x34edc5?_0x1cae6d=_0x1cae6d[_0x34f7db(0x11f)](_0x182dd0,''):(_0x1cae6d=_0x1cae6d[_0x34f7db(0x11f)](/#BLU#/g,'\x1b[34m'),_0x1cae6d=_0x1cae6d[_0x34f7db(0x11f)](/#RED#/g,_0x34f7db(0x1f3)),_0x1cae6d=_0x1cae6d[_0x34f7db(0x11f)](/#YEL#/g,_0x34f7db(0x2d9)),_0x1cae6d=_0x1cae6d[_0x34f7db(0x11f)](/#RES#/g,_0x34f7db(0x2e5)));;return _0x1cae6d;},logger={'screen':_0x3811a7=>{const _0x405930=_0x423760;console[_0x405930(0x17f)](parseColor(_0x3811a7,!![]));},'simple':_0x26b0c9=>{const _0x4475b0=_0x423760;console['log'](parseColor(_0x26b0c9,!![])),loggerfile[_0x4475b0(0x237)](util[_0x4475b0(0x289)](parseColor(_0x26b0c9,![]))+'\x0a');},'full':async _0x4ba361=>{const _0x15be1b=_0x423760,_0x381819=getTimeStamp()+_0x15be1b(0x2ca)+_0x4ba361;console[_0x15be1b(0x17f)](parseColor(_0x381819,!![])),loggerfile[_0x15be1b(0x237)](util[_0x15be1b(0x289)](parseColor(_0x381819,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x15be1b(0x141))await tgBot['sendMessage'](settings[_0x15be1b(0x130)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x4ba361,![]))[_0x15be1b(0x2b0)](_0x31de3a=>{telegramError(_0x31de3a);});},'debug':async(_0x29163c,_0x2f49ea='')=>{const _0x25359e=_0x423760,_0x297553=getTimeStamp()+_0x25359e(0x2f4)+_0x29163c;if(debugging)console[_0x25359e(0x17f)](parseColor(_0x297553,!![]));loggerfile[_0x25359e(0x237)](util[_0x25359e(0x289)](parseColor(_0x297553,![]))+'\x0a');if(_0x2f49ea){if(debugging)console[_0x25359e(0x17f)](_0x2f49ea);loggerfile[_0x25359e(0x237)](util[_0x25359e(0x289)](_0x2f49ea)+'\x0a');}}};process['on'](_0x423760(0x1f2),function(_0x1aeb7d){const _0x311121=_0x423760;logger[_0x311121(0x199)](_0x1aeb7d);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x423760(0x234))[_0x423760(0x188)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x423760(0x258))[_0x423760(0x147)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x423760(0x263)](_0x423760(0x2b6),async(_0x3d206c,_0x5d90f4)=>{const _0x510aa1=_0x423760,_0x13c5f4=_0x3d206c[_0x510aa1(0x2ce)][_0x510aa1(0x240)],_0x1cee5c=getClientsWithBotID(_0x510aa1(0x298)),_0x1eb3e8=_0x3d206c[_0x510aa1(0x2b4)][_0x510aa1(0x1d2)],_0x330b69=timelyDecrypt(_0x1eb3e8,![]),_0x17f77e=_0x1cee5c[_0x510aa1(0x23c)](_0x30e3eb=>_0x30e3eb[_0x510aa1(0x1d2)]==_0x330b69);if(_0x17f77e){const _0x13ac4e=normalizeIP(_0x3d206c[_0x510aa1(0x1c4)][_0x510aa1(0x1fd)])['store'],_0x18c6b6=_0x3d206c[_0x510aa1(0x2b4)][_0x510aa1(0x2ba)];if(validateAccess(_0x18c6b6,_0x330b69,_0x13ac4e)[_0x510aa1(0x29e)])_0x13c5f4=='backup'&&await backupConfigFiles(),await zipFiles(_0x13c5f4),_0x5d90f4[_0x510aa1(0x21d)](zippath+(_0x13c5f4+'.zip'),_0x4f693f=>{const _0x33b771=_0x510aa1;_0x4f693f&&(logger['full'](_0x33b771(0x1db)+_0x13c5f4),logger[_0x33b771(0x199)](_0x4f693f));});else logger[_0x510aa1(0x282)](_0x510aa1(0x2ea)+_0x13c5f4+'\x20(1)');}else logger[_0x510aa1(0x282)](_0x510aa1(0x2ea)+_0x13c5f4+'\x20(2)');}),app['post']('/upload-backup',async(_0x31e64d,_0x35c79a)=>{const _0x3f1176=_0x423760,_0x40b5e2=getClientsWithBotID('botmanager'),_0x410a9d=_0x31e64d['headers'][_0x3f1176(0x1d2)],_0x5d7231=timelyDecrypt(_0x410a9d,![]),_0x5bab09=_0x40b5e2['find'](_0x42c84a=>_0x42c84a[_0x3f1176(0x1d2)]==_0x5d7231);logger['debug'](_0x3f1176(0x269));if(_0x5bab09){const _0x49a74c=normalizeIP(_0x31e64d[_0x3f1176(0x1c4)]['remoteAddress'])[_0x3f1176(0x15d)],_0x589714=_0x31e64d['headers'][_0x3f1176(0x2ba)];if(validateAccess(_0x589714,_0x5d7231,_0x49a74c)[_0x3f1176(0x29e)]){if(_0x31e64d[_0x3f1176(0x277)]){const _0x2229c3=_0x31e64d['files'][_0x3f1176(0x157)];await _0x2229c3['mv'](temppath+_0x2229c3[_0x3f1176(0x241)]),_0x35c79a[_0x3f1176(0x2a3)]({'status':!![],'message':_0x3f1176(0x1f8)});const _0x41f4ee=getBotsWithMode();_0x41f4ee[_0x3f1176(0x15b)]>0x0?confirmRestore(temppath,_0x2229c3[_0x3f1176(0x241)]):unzipFile(temppath,_0x2229c3[_0x3f1176(0x241)]);}}else logger['full'](_0x3f1176(0x126));}else logger[_0x3f1176(0x282)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x423760(0x152)](path['join'](__dirname,bbpath2,_0x423760(0x1f9)))),app['use'](express[_0x423760(0x152)](path[_0x423760(0x2cd)](__dirname,bbpath2,_0x423760(0x1bd)))),app[_0x423760(0x263)]('/',function(_0x3aa8d6,_0x69dad1){const _0x819103=_0x423760;_0x69dad1[_0x819103(0x170)](path[_0x819103(0x2cd)](__dirname,bbpath2,_0x819103(0x1f9),'index.html'));}),app[_0x423760(0x263)](_0x423760(0x24a),function(_0x4b25c6,_0x3e82ea){const _0x599639=_0x423760;_0x3e82ea[_0x599639(0x170)](path[_0x599639(0x2cd)](__dirname,bbpath2,'build',_0x599639(0x1eb)));}),app[_0x423760(0x263)](_0x423760(0x16e),(_0x432de4,_0x41031e)=>{const _0x3c6089=_0x423760;_0x41031e['sendFile'](path[_0x3c6089(0x2cd)](__dirname,bbpath2,_0x3c6089(0x1bd),'index.html'));}),app[_0x423760(0x263)]('/:bot/performance',(_0x1dfe63,_0x5cf6c8)=>{const _0xcdf159=_0x423760;_0x5cf6c8[_0xcdf159(0x170)](path['join'](__dirname,bbpath2,'build',_0xcdf159(0x1eb)));}),app['get'](_0x423760(0x2d2),(_0x1a4d11,_0x1b123e)=>{const _0x2e7c16=_0x423760;_0x1b123e['sendFile'](path[_0x2e7c16(0x2cd)](__dirname,bbpath2,_0x2e7c16(0x1bd),_0x2e7c16(0x1eb)));}),app['get']('/:bot/history',(_0x139f36,_0x4b98a8)=>{const _0xa04a79=_0x423760;_0x4b98a8[_0xa04a79(0x170)](path[_0xa04a79(0x2cd)](__dirname,bbpath2,_0xa04a79(0x1bd),'index.html'));}),app[_0x423760(0x263)]('/:bot/configuration',(_0x5e182a,_0x21aa20)=>{const _0xcfb07d=_0x423760;_0x21aa20['sendFile'](path[_0xcfb07d(0x2cd)](__dirname,bbpath2,_0xcfb07d(0x1bd),_0xcfb07d(0x1eb)));}),app[_0x423760(0x263)](_0x423760(0x15c),(_0x524bb1,_0x2cfba9)=>{const _0x167dd5=_0x423760;_0x2cfba9['sendFile'](path[_0x167dd5(0x2cd)](__dirname,bbpath2,_0x167dd5(0x1bd),_0x167dd5(0x1eb)));});if(HOST)http[_0x423760(0x24f)](PORT,HOST);else http[_0x423760(0x24f)](PORT);const io=require(_0x423760(0x1e9))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2c2c76=_0x423760;let _0x540bfe=_0x2c2c76(0x193);const _0x10b1d4=networkInterfaces(),_0x9f0f7={};for(const _0x233863 of Object[_0x2c2c76(0x2f8)](_0x10b1d4)){for(const _0x3e2ada of _0x10b1d4[_0x233863]){if((_0x3e2ada[_0x2c2c76(0x155)]=='IPv4'||_0x3e2ada[_0x2c2c76(0x155)]==0x4)&&!_0x3e2ada[_0x2c2c76(0x1a8)]){const _0x2b3a27=ipaddr['parse'](_0x3e2ada[_0x2c2c76(0x148)])[_0x2c2c76(0x2c0)]();_0x2b3a27!=_0x2c2c76(0x2d7)&&(!_0x9f0f7[_0x233863]&&(_0x9f0f7[_0x233863]=[]),_0x9f0f7[_0x233863][_0x2c2c76(0x131)](_0x3e2ada['address']),_0x540bfe=_0x3e2ada[_0x2c2c76(0x148)]);}}}return{'serverip':_0x540bfe,'results':_0x9f0f7};}async function startServer(){const _0x579457=_0x423760,{serverip:_0x5519e7,netinterfaces:_0x142dc7}=getServerIP();logger[_0x579457(0x199)](''),logger[_0x579457(0x199)](_0x579457(0x2eb)),await logger[_0x579457(0x282)](_0x579457(0x2d4)+serverversion+_0x579457(0x2f6)+(_0x579457(0x27e)+PORT+_0x579457(0x12a))+(_0x579457(0x206)+_0x5519e7+':'+PORT+_0x579457(0x291))),logger['simple']('-----------------------------------------------------------------------------------');if(config[_0x579457(0x15b)]!=0x0)for(const _0x5acd5d of config){if(_0x5acd5d[_0x579457(0x14a)]==_0x579457(0x12b)||_0x5acd5d[_0x579457(0x14a)]==_0x579457(0x197))await logger[_0x579457(0x282)](_0x579457(0x2db)+_0x5acd5d[_0x579457(0x22c)]+_0x579457(0x2a0)+_0x5acd5d[_0x579457(0x1b2)]),startBot([_0x5acd5d['botID'],userID],{'cwd':bbpath},function(_0x3e73dd){const _0x284db3=_0x579457;if(_0x3e73dd)logger[_0x284db3(0x282)](_0x3e73dd);});else(_0x5acd5d[_0x579457(0x14a)]==_0x579457(0x202)||_0x5acd5d[_0x579457(0x14a)]==_0x579457(0x245))&&await logger[_0x579457(0x282)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x5acd5d[_0x579457(0x22c)]+_0x579457(0x2a0)+_0x5acd5d[_0x579457(0x1b2)]);}else!newBot&&logger[_0x579457(0x199)](_0x579457(0x161));if(newBot)addBot();logger[_0x579457(0x199)](_0x579457(0x2eb)),logger[_0x579457(0x199)](''),await logger[_0x579457(0x223)](_0x579457(0x246)+nodeversion),await logger[_0x579457(0x223)](_0x579457(0x21a),_0x142dc7);}function startSocket(){const _0x117522=_0x423760;io['on'](_0x117522(0x18f),_0x5e0ab5=>{const _0x23c1e8=_0x117522;let _0x17fe4b,_0x287b61,_0xad8d2d,_0x82dab7,_0x53c9fd;const _0x19d6d8=_0x5e0ab5[_0x23c1e8(0x181)][_0x23c1e8(0x2b4)][_0x23c1e8(0x210)];_0x287b61=_0x19d6d8[_0x23c1e8(0x1c1)](/bot[0-9]{3}/);if(_0x287b61)_0xad8d2d=_0x287b61[0x0]['match'](/[0-9]{3}/);if(_0xad8d2d)_0x17fe4b=_0xad8d2d[0x0];else _0x17fe4b=_0x23c1e8(0x298);const _0x19696e=_0x5e0ab5[_0x23c1e8(0x181)][_0x23c1e8(0x1d0)][_0x23c1e8(0x162)];if(!_0x19696e)_0x5e0ab5[_0x23c1e8(0x174)](_0x23c1e8(0x14a),{'publicKey':secure[_0x23c1e8(0x2be)]});else{_0x82dab7=timelyDecrypt(_0x19696e,![]);if(!_0x82dab7)_0x5e0ab5[_0x23c1e8(0x174)]('status',{'publicKey':secure[_0x23c1e8(0x2be)]});else{_0x53c9fd=normalizeIP(_0x5e0ab5[_0x23c1e8(0x2a9)]['remoteAddress'])[_0x23c1e8(0x15d)];if(!devices[_0x82dab7])devices[_0x82dab7]={'uuid':_0x82dab7,'access':{'token':null}};devices[_0x82dab7]['ip']=_0x53c9fd;const _0x3d7909=addClient(_0x5e0ab5['id'],_0x82dab7,_0x17fe4b);setAccess(_0x3d7909),emitMessages(),_0x5e0ab5['on']('login',_0xa1396d=>{const _0x1fbd47=_0x23c1e8,_0x5d71cb=timelyDecrypt(_0xa1396d['password']);if(_0x5d71cb){_0xa1396d={'username':_0xa1396d[_0x1fbd47(0x25e)],'password':_0x5d71cb},devices[_0x82dab7][_0x1fbd47(0x143)]=validateCredentials(_0xa1396d,_0x82dab7);if(devices[_0x82dab7][_0x1fbd47(0x143)]['allow']==![]&&devices[_0x82dab7][_0x1fbd47(0x143)]['reason']==_0x1fbd47(0x22e))_0x5e0ab5[_0x1fbd47(0x174)](_0x1fbd47(0x14a),{'access':devices[_0x82dab7][_0x1fbd47(0x143)]}),loginAccess2FA(_0x82dab7,_0x53c9fd);else{if(devices[_0x82dab7][_0x1fbd47(0x143)][_0x1fbd47(0x29e)]==![]&&devices[_0x82dab7][_0x1fbd47(0x143)][_0x1fbd47(0x1c5)]==_0x1fbd47(0x1d3))_0x5e0ab5['emit'](_0x1fbd47(0x14a),{'access':devices[_0x82dab7]['access']});else devices[_0x82dab7][_0x1fbd47(0x143)]['allow']&&devices[_0x82dab7][_0x1fbd47(0x143)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x82dab7)['forEach'](_0x428af6=>{setAccess(_0x428af6);}),logger[_0x1fbd47(0x223)](_0x1fbd47(0x250)+_0x82dab7[_0x1fbd47(0x24c)](-0x8)),setTokenRefresh(_0x82dab7),setSessionTimeout('login',_0x82dab7));}}else logger[_0x1fbd47(0x282)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x5e0ab5['on'](_0x23c1e8(0x1b5),()=>{resetPassword();}),_0x5e0ab5['on'](_0x23c1e8(0x2cb),_0x50e56a=>{removeClient(_0x5e0ab5['id']);}),_0x17fe4b==_0x23c1e8(0x298)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1e1a73){const _0x3d5361=_0x423760;if(_0x1e1a73!=_0x3d5361(0x298)&&config[_0x3d5361(0x200)]!=''){if(pid[_0x1e1a73])pid[_0x1e1a73][_0x3d5361(0x2a3)]({'function':_0x3d5361(0x278),'args':null});}_0x1e1a73!=_0x3d5361(0x298)&&broadcastToBots(_0x3d5361(0x179),JSON['stringify'](config));}function reloadBotManager(){const _0x72640b=_0x423760;getClientsWithBotID(_0x72640b(0x298))[_0x72640b(0x2b5)](_0x38f961=>{const _0x40f45c=_0x72640b;getSocket(_0x38f961['id'])['emit'](_0x40f45c(0x14a),{'access':{'allow':![],'reason':_0x40f45c(0x275),'token':null}});});}function getSocket(_0x396307){const _0x5b57fe=_0x423760;return io[_0x5b57fe(0x25a)]['sockets'][_0x5b57fe(0x263)](_0x396307);}function setAccess(_0x184bcc){const _0x2cf28f=_0x423760,_0x5b7760=getSocket(_0x184bcc['id']),_0x15f15a=_0x184bcc['uuid'],_0x31ca90=_0x184bcc['bot'];devices[_0x15f15a]['access']=validateAccess(devices[_0x15f15a]['access'][_0x2cf28f(0x15a)],_0x15f15a),logger['debug'](_0x2cf28f(0x1ba)+devices[_0x15f15a][_0x2cf28f(0x143)]['reason']+_0x2cf28f(0x190)+_0x184bcc['id'][_0x2cf28f(0x24c)](-0x8)+_0x2cf28f(0x2b8)+_0x15f15a['slice'](-0x8)),_0x5b7760[_0x2cf28f(0x2cd)](_0x15f15a);if(devices[_0x15f15a][_0x2cf28f(0x143)][_0x2cf28f(0x29e)]){_0x5b7760[_0x2cf28f(0x2cd)](_0x31ca90);if(_0x31ca90==_0x2cf28f(0x298))initializeSocketBotManager(_0x5b7760);else initializeSocketBot(_0x5b7760);initClient(_0x31ca90);}devices[_0x15f15a][_0x2cf28f(0x143)][_0x2cf28f(0x15a)]&&devices[_0x15f15a][_0x2cf28f(0x143)][_0x2cf28f(0x1c5)]==_0x2cf28f(0x19b)&&setSessionTimeout(_0x2cf28f(0x2b3),_0x15f15a),devices[_0x15f15a][_0x2cf28f(0x143)]['token']&&devices[_0x15f15a][_0x2cf28f(0x143)][_0x2cf28f(0x1c5)]==_0x2cf28f(0x27a)&&setSessionTimeout(_0x2cf28f(0x1e0),_0x15f15a),_0x5b7760[_0x2cf28f(0x174)](_0x2cf28f(0x14a),{'status':_0x184bcc['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x15f15a][_0x2cf28f(0x143)],'externalip':devices[_0x15f15a]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x2cf28f(0x132)],'validInstallation':validInstallation}),devices[_0x15f15a][_0x2cf28f(0x143)][_0x2cf28f(0x29e)]==![]&&devices[_0x15f15a][_0x2cf28f(0x143)][_0x2cf28f(0x1c5)]=='2FA\x20required'&&temporaryAccess2FA(_0x15f15a,devices[_0x15f15a]['ip']);}function setSessionTimeout(_0x29df1a,_0x7c4f47){const _0x30602f=_0x423760;let _0x4aa89d;if(_0x29df1a=='login')_0x4aa89d=loginExpiry*0x3c*0x3e8;else _0x4aa89d=devices[_0x7c4f47]['telegramIpApproval'][_0x30602f(0x1f7)]*0x3c*0x3e8-(new Date()[_0x30602f(0x2c4)]()-devices[_0x7c4f47][_0x30602f(0x18d)]['timestamp']);if(devices[_0x7c4f47][_0x30602f(0x1ab)])clearTimeout(devices[_0x7c4f47][_0x30602f(0x1ab)]);devices[_0x7c4f47][_0x30602f(0x1ab)]=setTimeout(()=>{const _0x151dee=_0x30602f;if(devices[_0x7c4f47][_0x151dee(0x21f)])clearTimeout(devices[_0x7c4f47][_0x151dee(0x21f)]);removeSocketListeners(_0x7c4f47),addBlacklist(_0x7c4f47),devices[_0x7c4f47][_0x151dee(0x18d)]=null,devices[_0x7c4f47][_0x151dee(0x1fc)]=null,devices[_0x7c4f47][_0x151dee(0x143)][_0x151dee(0x15a)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x7c4f47[_0x151dee(0x24c)](-0x8)),devices[_0x7c4f47][_0x151dee(0x143)]=validateAccess(devices[_0x7c4f47][_0x151dee(0x143)][_0x151dee(0x15a)],_0x7c4f47),!(devices[_0x7c4f47]['access'][_0x151dee(0x29e)]&&devices[_0x7c4f47][_0x151dee(0x143)][_0x151dee(0x1c5)]==_0x151dee(0x256))&&(_0x29df1a==_0x151dee(0x1e0)?io['to'](_0x7c4f47)[_0x151dee(0x174)](_0x151dee(0x14a),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x7c4f47)[_0x151dee(0x174)](_0x151dee(0x14a),{'access':{'allow':![],'reason':_0x151dee(0x163),'token':null}})),devices[_0x7c4f47][_0x151dee(0x143)][_0x151dee(0x15a)]=null;},_0x4aa89d);}function setTokenRefresh(_0x293af1){const _0x94344=_0x423760;if(devices[_0x293af1]['pidRefreshToken'])clearTimeout(devices[_0x293af1][_0x94344(0x21f)]);devices[_0x293af1][_0x94344(0x21f)]=setTimeout(()=>{const _0x4019ff=_0x94344;getClientsWithUuid(_0x293af1)['length']!=0x0?(devices[_0x293af1][_0x4019ff(0x143)]=refreshToken(_0x293af1),io['to'](_0x293af1)['emit'](_0x4019ff(0x14a),{'status':_0x4019ff(0x18b),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x293af1]['access'],'externalip':devices[_0x293af1]['ip'],'publicKey':secure[_0x4019ff(0x2be)],'validInstallation':validInstallation}),setTokenRefresh(_0x293af1)):clearTimeout(devices[_0x293af1][_0x4019ff(0x21f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xbd1682){const _0x3cee95=_0x423760,_0x5cf140=getClient(_0xbd1682['id'])[_0x3cee95(0x1d2)];_0xbd1682[_0x3cee95(0x174)]('bots',config),_0xbd1682[_0x3cee95(0x174)](_0x3cee95(0x1b4),cleanSettings()),_0xbd1682['on'](_0x3cee95(0x2c3),_0x2074c6=>{const _0x2cf28b=_0x3cee95;if(validateAccess(_0x2074c6,_0x5cf140)[_0x2cf28b(0x29e)])addBot();else logger['full'](_0x2cf28b(0x167));}),_0xbd1682['on'](_0x3cee95(0x1ff),(_0x3b0232,_0x25a270)=>{const _0x535797=_0x3cee95;if(validateAccess(_0x25a270,_0x5cf140)[_0x535797(0x29e)])toggleBot(_0x3b0232[_0x535797(0x22c)],_0x3b0232['status'],_0x3b0232['live']);else logger[_0x535797(0x282)](_0x535797(0x2f7));}),_0xbd1682['on']('toggle-bot-mode',(_0x2ce3fe,_0x2510a3)=>{const _0x7f37a3=_0x3cee95;if(validateAccess(_0x2510a3,_0x5cf140)['allow'])toggleBotMode(_0x2ce3fe);else logger[_0x7f37a3(0x282)](_0x7f37a3(0x2f7));}),_0xbd1682['on']('delete-bot',(_0x418419,_0x3c5487)=>{const _0x57be07=_0x3cee95;if(validateAccess(_0x3c5487,_0x5cf140)[_0x57be07(0x29e)])deleteBot(_0x418419);else logger[_0x57be07(0x282)](_0x57be07(0x19a));}),_0xbd1682['on'](_0x3cee95(0x189),(_0x5d635d,_0x15767a)=>{const _0x184905=_0x3cee95;if(validateAccess(_0x15767a,_0x5cf140)[_0x184905(0x29e)])storeSettings(_0x5d635d,!![]);else logger['full'](_0x184905(0x129));}),_0xbd1682['on'](_0x3cee95(0x2e7),_0x199553=>{const _0x10adae=_0x3cee95;if(validateAccess(_0x199553,_0x5cf140)['allow'])updateBB(_0x10adae(0x1bf));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0xbd1682['on']('reinstall-bb',_0x38ddec=>{const _0x1749c5=_0x3cee95;if(validateAccess(_0x38ddec,_0x5cf140)['allow'])updateBB(_0x1749c5(0x176));else logger[_0x1749c5(0x282)](_0x1749c5(0x2f9));}),_0xbd1682['on'](_0x3cee95(0x138),_0x454b50=>{const _0x4d6202=_0x3cee95;if(validateAccess(_0x454b50,_0x5cf140)[_0x4d6202(0x29e)]){const _0x1a3358=getClient(_0xbd1682['id']);if(_0x1a3358)getBackupFiles(_0x1a3358[_0x4d6202(0x1d2)]);else logger[_0x4d6202(0x282)](_0x4d6202(0x2c9));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0xbd1682['on']('restore-backup-file',(_0x51daaa,_0x57f59e)=>{const _0x3f4b59=_0x3cee95;if(validateAccess(_0x57f59e,_0x5cf140)[_0x3f4b59(0x29e)])restoreBackupFile(_0x51daaa);else logger['full'](_0x3f4b59(0x2ad));}),_0xbd1682['on']('get-messages',_0x349e35=>{const _0x571123=_0x3cee95;if(validateAccess(_0x349e35,_0x5cf140)[_0x571123(0x29e)])getMessages();else logger[_0x571123(0x282)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xbd1682['on']('confirm-message',(_0x859239,_0x5efa6e)=>{const _0x7a67e5=_0x3cee95;if(validateAccess(_0x5efa6e,_0x5cf140)['allow'])confirmMessage(_0x859239);else logger[_0x7a67e5(0x282)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xbd1682['on']('logout',_0x5cf923=>{const _0x37c67a=_0x3cee95;if(validateAccess(_0x5cf923,_0x5cf140)[_0x37c67a(0x29e)]){if(devices[_0x5cf140][_0x37c67a(0x21f)])clearTimeout(devices[_0x5cf140][_0x37c67a(0x21f)]);if(devices[_0x5cf140][_0x37c67a(0x1ab)])clearTimeout(devices[_0x5cf140][_0x37c67a(0x1ab)]);removeSocketListeners(getClient(_0xbd1682['id'])[_0x37c67a(0x1d2)]),addBlacklist(_0x5cf140),devices[_0x5cf140][_0x37c67a(0x18d)]=null,devices[_0x5cf140][_0x37c67a(0x1fc)]=null,devices[_0x5cf140]['access']['token']=null,logger[_0x37c67a(0x223)]('Logged\x20out\x20user\x20...'+_0x5cf140[_0x37c67a(0x24c)](-0x8)),io['to'](getClient(_0xbd1682['id'])['uuid'])[_0x37c67a(0x174)]('status',{'access':{'allow':![],'reason':_0x37c67a(0x299),'token':null}});}else logger[_0x37c67a(0x282)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x399bad){const _0x11206f=_0x423760,_0x10189d=getClient(_0x399bad['id'])[_0x11206f(0x1ca)],_0x343152=getClient(_0x399bad['id'])[_0x11206f(0x1d2)];_0x399bad['on'](_0x11206f(0x2c8),(_0x3371c8,_0x5eccb9)=>{const _0x17177c=_0x11206f;if(validateAccess(_0x5eccb9,_0x343152)['allow']){if(pid[_0x10189d])pid[_0x10189d][_0x17177c(0x2a3)]({'function':_0x17177c(0x29c),'args':_0x3371c8});}else logger[_0x17177c(0x282)](_0x17177c(0x217));}),_0x399bad['on'](_0x11206f(0x1f4),(_0x2f43c4,_0x4e2db1)=>{const _0x13b731=_0x11206f;if(validateAccess(_0x4e2db1,_0x343152)[_0x13b731(0x29e)]){if(pid[_0x10189d])pid[_0x10189d][_0x13b731(0x2a3)]({'function':_0x13b731(0x1ef),'args':_0x2f43c4});}else logger[_0x13b731(0x282)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x399bad['on'](_0x11206f(0x284),(_0x4d20ea,_0x126833)=>{const _0x2e20bf=_0x11206f;if(validateAccess(_0x126833,_0x343152)[_0x2e20bf(0x29e)]){if(pid[_0x10189d])pid[_0x10189d][_0x2e20bf(0x2a3)]({'function':_0x2e20bf(0x196),'args':_0x4d20ea});}else logger['full'](_0x2e20bf(0x2e2));}),_0x399bad['on'](_0x11206f(0x1a6),(_0x5f91d2,_0x54e55f)=>{const _0xa37027=_0x11206f;if(validateAccess(_0x54e55f,_0x343152)['allow']){if(pid[_0x10189d])pid[_0x10189d][_0xa37027(0x2a3)]({'function':'storeConfiguration','args':_0x5f91d2});}else logger[_0xa37027(0x282)](_0xa37027(0x295));}),_0x399bad['on']('store-headless',(_0xede621,_0x153c16)=>{const _0x333a70=_0x11206f;if(validateAccess(_0x153c16,_0x343152)[_0x333a70(0x29e)]){if(pid[_0x10189d])pid[_0x10189d]['send']({'function':_0x333a70(0x1e2),'args':_0xede621});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x399bad['on']('store-fiat',(_0x281dc1,_0x4ab14b)=>{const _0x3386f9=_0x11206f;if(validateAccess(_0x4ab14b,_0x343152)['allow']){if(pid[_0x10189d])pid[_0x10189d][_0x3386f9(0x2a3)]({'function':'storeFiat','args':_0x281dc1});}else logger[_0x3386f9(0x282)](_0x3386f9(0x1aa));}),_0x399bad['on'](_0x11206f(0x227),_0x4e7fbe=>{const _0x24c01a=_0x11206f;if(validateAccess(_0x4e7fbe,_0x343152)['allow']){if(pid[_0x10189d])pid[_0x10189d][_0x24c01a(0x2a3)]({'function':_0x24c01a(0x2de),'args':null});}else logger[_0x24c01a(0x282)](_0x24c01a(0x252));}),_0x399bad['on'](_0x11206f(0x20f),_0x202413=>{const _0x14f4ee=_0x11206f;if(validateAccess(_0x202413,_0x343152)['allow']){if(pid[_0x10189d])pid[_0x10189d]['send']({'function':_0x14f4ee(0x207),'args':null});}else logger[_0x14f4ee(0x282)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x399bad['on'](_0x11206f(0x25d),(_0x5e5252,_0x34bebe)=>{const _0xb71d8c=_0x11206f;if(validateAccess(_0x34bebe,_0x343152)[_0xb71d8c(0x29e)]){if(pid[_0x10189d])pid[_0x10189d][_0xb71d8c(0x2a3)]({'function':_0xb71d8c(0x2ee),'args':_0x5e5252});}else logger[_0xb71d8c(0x282)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x399bad['on'](_0x11206f(0x297),_0x3e7188=>{const _0x2d0ea4=_0x11206f;if(validateAccess(_0x3e7188,_0x343152)['allow']){if(pid[_0x10189d])pid[_0x10189d]['send']({'function':_0x2d0ea4(0x14d),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x399bad['on']('show-config',_0x1ad30d=>{const _0x9a96be=_0x11206f;if(validateAccess(_0x1ad30d,_0x343152)[_0x9a96be(0x29e)]){if(pid[_0x10189d])pid[_0x10189d]['send']({'function':_0x9a96be(0x2bc),'args':null});}else logger['full'](_0x9a96be(0x2f2));}),_0x399bad['on'](_0x11206f(0x2e7),_0x41c75f=>{const _0x4a7525=_0x11206f;if(validateAccess(_0x41c75f,_0x343152)[_0x4a7525(0x29e)])updateBB(_0x4a7525(0x1bf));else logger[_0x4a7525(0x282)](_0x4a7525(0x1d4));}),_0x399bad['on'](_0x11206f(0x25c),_0x34740f=>{const _0x575db8=_0x11206f;if(validateAccess(_0x34740f,_0x343152)[_0x575db8(0x29e)])getMessages();else logger[_0x575db8(0x282)](_0x575db8(0x293));}),_0x399bad['on'](_0x11206f(0x1d8),(_0x464e5c,_0x3a5306)=>{const _0x827715=_0x11206f;if(validateAccess(_0x3a5306,_0x343152)[_0x827715(0x29e)])confirmMessage(_0x464e5c);else logger['full'](_0x827715(0x19c));}),_0x399bad['on'](_0x11206f(0x26f),_0x4a5cca=>{const _0x4568a5=_0x11206f;if(validateAccess(_0x4a5cca,_0x343152)[_0x4568a5(0x29e)]){if(devices[_0x343152][_0x4568a5(0x21f)])clearTimeout(devices[_0x343152][_0x4568a5(0x21f)]);if(devices[_0x343152][_0x4568a5(0x1ab)])clearTimeout(devices[_0x343152][_0x4568a5(0x1ab)]);removeSocketListeners(getClient(_0x399bad['id'])[_0x4568a5(0x1d2)]),addBlacklist(_0x343152),devices[_0x343152][_0x4568a5(0x18d)]=null,devices[_0x343152][_0x4568a5(0x1fc)]=null,devices[_0x343152][_0x4568a5(0x143)][_0x4568a5(0x15a)]=null,logger['debug'](_0x4568a5(0x1c7)+_0x343152[_0x4568a5(0x24c)](-0x8)),io['to'](getClient(_0x399bad['id'])['uuid'])['emit'](_0x4568a5(0x14a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x4568a5(0x282)](_0x4568a5(0x1d9));});}function removeSocketListeners(_0xa7386c){const _0x120b1a=_0x423760;getClientsWithUuid(_0xa7386c)[_0x120b1a(0x2b5)](_0x2106ae=>{const _0x292e6c=_0x120b1a;getSocket(_0x2106ae['id'])[_0x292e6c(0x2a5)]();});}function cleanSettings(){const _0x1a3e23=_0x423760;let _0x1f8c38=settings;return settings[_0x1a3e23(0x213)]&&settings[_0x1a3e23(0x213)]!=''&&(_0x1f8c38={..._0x1f8c38,'telegramToken':_0x1a3e23(0x1c9)}),settings[_0x1a3e23(0x182)]&&settings[_0x1a3e23(0x182)]!=''&&(_0x1f8c38={..._0x1f8c38,'bbPassword':_0x1a3e23(0x1c9)}),(settings['bbPassword']&&settings['bbPassword']==_0x1a3e23(0x2bb)||settings[_0x1a3e23(0x213)]&&settings[_0x1a3e23(0x213)]=='***')&&(_0x1f8c38={..._0x1f8c38,'restored':{'password':settings['bbPassword']=='***','telegram':settings['telegramToken']==_0x1a3e23(0x2bb)}}),_0x1f8c38;}async function updateBB(_0x2961c9){const _0x56f474=_0x423760;await backupConfigFiles(),installingUpdate=!![],config[_0x56f474(0x2b5)](_0x576277=>{const _0x4dd586=_0x56f474;restartBot(_0x576277[_0x4dd586(0x22c)]);}),logger['debug'](_0x56f474(0x287)+_0x2961c9);if(_0x2961c9==_0x56f474(0x1bf))process[_0x56f474(0x2a3)]({'update':!![]},_0x31e4e1=>{});else _0x2961c9==_0x56f474(0x176)&&process[_0x56f474(0x2a3)]({'reinstall':!![]},_0x5d36d1=>{});}function startBot(_0x3bc7dc,_0x399680,_0x37cc51){const _0x5bcea6=_0x423760;if(debugging)_0x3bc7dc[_0x5bcea6(0x131)]('-d');let _0x229e93=![];const _0x53449c=_0x3bc7dc[0x0];_0x399680={..._0x399680,'stdio':[_0x5bcea6(0x281),_0x5bcea6(0x281),_0x5bcea6(0x281),'ipc']},pid[_0x53449c]=childProcess[_0x5bcea6(0x1a4)](botfile,_0x3bc7dc,_0x399680),pid[_0x53449c]['on']('message',_0xb7b213=>{const _0x5371da=_0x5bcea6;switch(Object['keys'](_0xb7b213)[0x0]){case _0x5371da(0x1b2):updateBotName(_0x53449c,_0xb7b213['botname']);break;case _0x5371da(0x208):updateBotManager();break;case _0x5371da(0x14a):updateStatus(_0x53449c,_0xb7b213[_0x5371da(0x14a)]);break;case _0x5371da(0x135):updateLive(_0x53449c,_0xb7b213['live']);break;case'started':updateLive(_0x53449c,_0xb7b213[_0x5371da(0x279)]),io['to'](_0x53449c)[_0x5371da(0x174)](_0x5371da(0x14a),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0xb7b213[_0x5371da(0x25f)]=='restart'&&restartBot(_0x53449c);_0xb7b213[_0x5371da(0x25f)]=='kill'&&toggleBot(_0x53449c,'disabled',_0x5371da(0x244));break;case _0x5371da(0x1d1):sendTelegram(_0x53449c,_0xb7b213[_0x5371da(0x1d1)]);break;case _0x5371da(0x274):sendTelegramMsg(_0xb7b213['telegrammsg']);break;case _0x5371da(0x204):io['to'](_0x53449c)[_0x5371da(0x174)](_0xb7b213['function'],_0xb7b213[_0x5371da(0x1cd)]);break;}}),pid[_0x53449c]['on'](_0x5bcea6(0x165),function(_0x5e227e){if(_0x229e93)return;_0x229e93=!![],_0x37cc51(_0x5e227e);}),pid[_0x53449c]['on'](_0x5bcea6(0x184),async function(_0x27626f){const _0x459194=_0x5bcea6;if(installingUpdate)return;if(_0x229e93)return;_0x229e93=!![],_0x37cc51(null);const _0x540f70=dbConfig['get'](_0x459194(0x179))[_0x459194(0x23c)]({'botID':_0x53449c})['value']();_0x540f70&&(_0x540f70['status']==_0x459194(0x12b)||_0x540f70['status']==_0x459194(0x197))&&(await sleep(0x3e8),updateLive(_0x53449c,'stopped'),logger['full']('Restarting\x20Bot\x20'+_0x53449c),startBot([_0x53449c,userID],{'cwd':bbpath},function(_0xb25de4){const _0x1adff5=_0x459194;if(_0xb25de4)logger[_0x1adff5(0x282)](_0xb25de4);}));});}function stopBot(_0x141d4c){const _0x30ebe0=_0x423760;getClientsWithBotID(_0x141d4c)[_0x30ebe0(0x2b5)](_0x21fc78=>{getSocket(_0x21fc78['id'])['disconnect'](!![]),removeClient(_0x21fc78['id']);}),pid[_0x141d4c]&&(pid[_0x141d4c][_0x30ebe0(0x194)](),pid[_0x141d4c]=null);}function restartBot(_0x5c2f46){const _0x355a8e=_0x423760;if(pid[_0x5c2f46])pid[_0x5c2f46][_0x355a8e(0x194)]();}function addBot(){const _0x1de390=_0x423760;let _0x429978;for(let _0x5c5a4d=0x1;_0x5c5a4d<0x3e9;_0x5c5a4d++){_0x429978=_0x5c5a4d[_0x1de390(0x205)]()[_0x1de390(0x19e)](0x3,'0');let _0x3e7fc4=config['find'](_0x334314=>_0x334314[_0x1de390(0x22c)]==_0x429978);if(!_0x3e7fc4)break;}if(_0x429978===_0x1de390(0x226)){logger[_0x1de390(0x282)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x1de390(0x282)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x429978),dbConfig[_0x1de390(0x263)](_0x1de390(0x179))[_0x1de390(0x131)]({'botID':_0x429978,'botname':'Bot\x20'+_0x429978,'status':_0x1de390(0x197),'live':''})[_0x1de390(0x237)](),startBot([_0x429978,userID],{'cwd':bbpath},function(_0x3c48f5){const _0x484d39=_0x1de390;if(_0x3c48f5)logger[_0x484d39(0x282)](_0x3c48f5);}),config=getConfiguration(),io['to'](_0x1de390(0x298))[_0x1de390(0x174)]('bots',config),broadcastToBots(_0x1de390(0x179),JSON[_0x1de390(0x1de)](config));}function deleteBot(_0x3de6a6){const _0xd312d9=_0x423760;getClientsWithBotID(_0x3de6a6)['forEach'](_0xfa8eaa=>{getSocket(_0xfa8eaa['id'])['disconnect'](!![]),removeClient(_0xfa8eaa['id']);}),dbConfig['get'](_0xd312d9(0x179))[_0xd312d9(0x2dc)]({'botID':_0x3de6a6})[_0xd312d9(0x237)](),logger['full'](_0xd312d9(0x2a2)+_0x3de6a6),stopBot(_0x3de6a6);try{if(fs[_0xd312d9(0x195)](path['join'](configpath,'bot-'+_0x3de6a6+_0xd312d9(0x2ec))))fs[_0xd312d9(0x294)](path[_0xd312d9(0x2cd)](configpath,_0xd312d9(0x24b)+_0x3de6a6+_0xd312d9(0x2ec)));if(fs['existsSync'](path[_0xd312d9(0x2cd)](configpath,'bot-'+_0x3de6a6+_0xd312d9(0x261))))fs[_0xd312d9(0x294)](path[_0xd312d9(0x2cd)](configpath,_0xd312d9(0x24b)+_0x3de6a6+'-events.json'));if(fs[_0xd312d9(0x195)](path['join'](configpath,'bot-'+_0x3de6a6+'-performance.json')))fs[_0xd312d9(0x294)](path[_0xd312d9(0x2cd)](configpath,_0xd312d9(0x24b)+_0x3de6a6+_0xd312d9(0x1fb)));if(fs[_0xd312d9(0x195)](path[_0xd312d9(0x2cd)](configpath,'bot-'+_0x3de6a6+_0xd312d9(0x1bb))))fs[_0xd312d9(0x294)](path['join'](configpath,_0xd312d9(0x24b)+_0x3de6a6+_0xd312d9(0x1bb)));}catch(_0x5bb174){if(_0x5bb174)logger[_0xd312d9(0x282)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x5bb174);}config=getConfiguration(),io['to'](_0xd312d9(0x298))['emit'](_0xd312d9(0x179),config),broadcastToBots(_0xd312d9(0x179),JSON['stringify'](config));}function toggleBot(_0xae0c23,_0x2118fd,_0x1f333b){const _0x5321dc=_0x423760;dbConfig[_0x5321dc(0x263)]('bots')['find']({'botID':_0xae0c23})['assign']({'status':_0x2118fd})[_0x5321dc(0x139)]({'live':_0x1f333b})[_0x5321dc(0x237)]();if(_0x2118fd==_0x5321dc(0x12b)||_0x2118fd==_0x5321dc(0x197))logger[_0x5321dc(0x282)](_0x5321dc(0x2f5)+_0xae0c23),startBot([_0xae0c23,userID],{'cwd':bbpath},function(_0x366f7c){if(_0x366f7c)logger['full'](_0x366f7c);});else(_0x2118fd==_0x5321dc(0x202)||_0x2118fd==_0x5321dc(0x245))&&(logger[_0x5321dc(0x282)](_0x5321dc(0x140)+_0xae0c23),stopBot(_0xae0c23));config=getConfiguration(),io['to'](_0x5321dc(0x298))[_0x5321dc(0x174)]('bots',config),broadcastToBots(_0x5321dc(0x179),JSON['stringify'](config));}function toggleStatus(_0xe0ef76){const _0x365a05=_0x423760;let _0x29c99d=dbConfig['get'](_0x365a05(0x179))[_0x365a05(0x23c)]({'botID':_0xe0ef76})['value'](),_0x48c2f5;if(_0x29c99d[_0x365a05(0x14a)]===_0x365a05(0x12b))_0x48c2f5=_0x365a05(0x202);else{if(_0x29c99d[_0x365a05(0x14a)]===_0x365a05(0x197))_0x48c2f5=_0x365a05(0x245);else{if(_0x29c99d[_0x365a05(0x14a)]===_0x365a05(0x245))_0x48c2f5='new';else{if(_0x29c99d[_0x365a05(0x14a)]==='disabled')_0x48c2f5='enabled';}}}return _0x48c2f5;}function updateStatus(_0x5d53cb,_0x37920e){const _0x260fba=_0x423760;dbConfig[_0x260fba(0x263)](_0x260fba(0x179))['find']({'botID':_0x5d53cb})[_0x260fba(0x139)]({'status':_0x37920e})['write'](),config=getConfiguration(),io['to'](_0x260fba(0x298))[_0x260fba(0x174)]('bots',config),broadcastToBots('bots',JSON[_0x260fba(0x1de)](config));}function updateLive(_0x174e88,_0xd26472){const _0x29a896=_0x423760;dbConfig[_0x29a896(0x263)]('bots')['find']({'botID':_0x174e88})[_0x29a896(0x139)]({'live':_0xd26472})[_0x29a896(0x237)](),config=getConfiguration(),io['to'](_0x29a896(0x298))['emit'](_0x29a896(0x179),config),broadcastToBots('bots',JSON[_0x29a896(0x1de)](config));}function updateBotName(_0x423495,_0x29f063){const _0x3c3176=_0x423760;dbConfig[_0x3c3176(0x263)](_0x3c3176(0x179))[_0x3c3176(0x23c)]({'botID':_0x423495})[_0x3c3176(0x139)]({'botname':_0x29f063})[_0x3c3176(0x237)](),config=getConfiguration(),io['to'](_0x3c3176(0x298))['emit'](_0x3c3176(0x179),config),broadcastToBots(_0x3c3176(0x179),JSON[_0x3c3176(0x1de)](config));}function updateBotManager(){const _0x3df568=_0x423760;config=getConfiguration(),io['to'](_0x3df568(0x298))[_0x3df568(0x174)](_0x3df568(0x179),config),broadcastToBots(_0x3df568(0x179),JSON[_0x3df568(0x1de)](config));}function toggleBotMode(_0xe45597){const _0x3d78c3=_0x423760;if(pid[_0xe45597])pid[_0xe45597][_0x3d78c3(0x2a3)]({'function':'toggleBotMode','args':null});else{const _0x411685=configpath+'bot-'+_0xe45597+_0x3d78c3(0x2ec),_0x3fe19d=fs['readFileSync'](_0x411685),_0x3678e2=JSON[_0x3d78c3(0x13b)](_0x3fe19d),_0x1be2d2=_0x3678e2['bot'][0x0][_0x3d78c3(0x2f3)];_0x3678e2['bot'][0x0][_0x3d78c3(0x2f3)]=!_0x1be2d2;const _0x3542de=JSON[_0x3d78c3(0x1de)](_0x3678e2,null,0x2);fs['writeFileSync'](_0x411685,_0x3542de),config=getConfiguration(),io['to'](_0x3d78c3(0x298))[_0x3d78c3(0x174)]('bots',config),broadcastToBots(_0x3d78c3(0x179),JSON[_0x3d78c3(0x1de)](config));}}function telegramError(_0x4f8017){const _0x58ea48=_0x423760;logger[_0x58ea48(0x199)](getTimeStamp()+_0x58ea48(0x11e));}function validateTelegram(_0x35cd87){const _0x34f850=_0x423760;if(_0x35cd87['from'][_0x34f850(0x25e)]!=settings[_0x34f850(0x1a7)]&&'@'+_0x35cd87[_0x34f850(0x133)]['username']!=settings[_0x34f850(0x1a7)])return tgBot[_0x34f850(0x191)](_0x35cd87['chat']['id'],_0x34f850(0x159),{'parse_mode':_0x34f850(0x20b)})[_0x34f850(0x2b0)](_0x4148b3=>{telegramError(_0x4148b3);}),![];return!![];}async function initTelegram(){const _0x491dc9=_0x423760;if(tgBot)tgBot[_0x491dc9(0x271)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x491dc9(0x213)],{'polling':!![]});let _0x10c36b=_0x491dc9(0x27f);_0x10c36b+='\x0a',_0x10c36b+=_0x491dc9(0x2a7),_0x10c36b+=_0x491dc9(0x222),_0x10c36b+=_0x491dc9(0x2fc),_0x10c36b+=_0x491dc9(0x142),_0x10c36b+='/on\x20-\x20start\x20bot(s)\x0a',_0x10c36b+=_0x491dc9(0x1ec),_0x10c36b+=_0x491dc9(0x198),_0x10c36b+='/names\x20-\x20show\x20bot\x20names\x0a',_0x10c36b+=_0x491dc9(0x1cc),_0x10c36b+=_0x491dc9(0x2a8),_0x10c36b+=_0x491dc9(0x192),_0x10c36b+=_0x491dc9(0x122),_0x10c36b+=_0x491dc9(0x1f0),_0x10c36b+=_0x491dc9(0x2bf);let _0x43e36b='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x43e36b+='\x0a',_0x43e36b+=_0x10c36b,tgBot[_0x491dc9(0x2a6)](/\/start/,_0x3408af=>{const _0x4e837f=_0x491dc9;if(!validateTelegram(_0x3408af))return;if(settings[_0x4e837f(0x130)]!=_0x3408af['chat']['id'])updateSetting('telegramChatId',_0x3408af['chat']['id']);updateSetting(_0x4e837f(0x2df),!![]),tgBot[_0x4e837f(0x191)](_0x3408af[_0x4e837f(0x1fa)]['id'],_0x43e36b)[_0x4e837f(0x2b0)](_0x32b559=>{telegramError(_0x32b559);});}),tgBot[_0x491dc9(0x2a6)](/\/enable/,_0x4ef99b=>{const _0x514372=_0x491dc9;if(!validateTelegram(_0x4ef99b))return;if(settings[_0x514372(0x130)]!=_0x4ef99b[_0x514372(0x1fa)]['id'])updateSetting(_0x514372(0x130),_0x4ef99b[_0x514372(0x1fa)]['id']);updateSetting(_0x514372(0x2df),!![]),tgBot[_0x514372(0x191)](_0x4ef99b[_0x514372(0x1fa)]['id'],_0x514372(0x249))[_0x514372(0x2b0)](_0x6179fc=>{telegramError(_0x6179fc);});}),tgBot['onText'](/\/config/,async _0x51230f=>{const _0xd5e1a6=_0x491dc9;if(!validateTelegram(_0x51230f))return;tgBot[_0xd5e1a6(0x262)]('callback_query'),tgBot['sendMessage'](_0x51230f['chat']['id'],_0xd5e1a6(0x247),{'reply_markup':{'inline_keyboard':[[{'text':_0xd5e1a6(0x2b9),'callback_data':'orders'},{'text':_0xd5e1a6(0x220),'callback_data':_0xd5e1a6(0x177)},{'text':_0xd5e1a6(0x1af),'callback_data':_0xd5e1a6(0x2d8)}]]}})['catch'](_0x3de7cb=>{telegramError(_0x3de7cb);}),tgBot['on']('callback_query',async _0x4b4a6a=>{const _0x38f65d=_0xd5e1a6,_0x2c2621=_0x4b4a6a[_0x38f65d(0x2da)],_0x1a21e8=_0x4b4a6a[_0x38f65d(0x1b0)];tgBot[_0x38f65d(0x285)](_0x4b4a6a['id'])['then'](async()=>{const _0x483577=_0x38f65d;_0x2c2621=='orders'&&(updateSetting(_0x483577(0x296),_0x483577(0x141)),updateSetting(_0x483577(0x2df),!![]),await tgBot[_0x483577(0x191)](_0x1a21e8[_0x483577(0x1fa)]['id'],_0x483577(0x21b))[_0x483577(0x2b0)](_0x1eae6b=>{telegramError(_0x1eae6b);}));_0x2c2621=='alerts'&&(updateSetting(_0x483577(0x296),'alerts'),updateSetting(_0x483577(0x2df),!![]),await tgBot[_0x483577(0x191)](_0x1a21e8[_0x483577(0x1fa)]['id'],_0x483577(0x29a))[_0x483577(0x2b0)](_0xc59d75=>{telegramError(_0xc59d75);}));_0x2c2621==_0x483577(0x2d8)&&(updateSetting(_0x483577(0x296),_0x483577(0x2d8)),updateSetting(_0x483577(0x2df),!![]),await tgBot[_0x483577(0x191)](_0x1a21e8[_0x483577(0x1fa)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x483577(0x2b0)](_0x1b611a=>{telegramError(_0x1b611a);}));if(!settings[_0x483577(0x130)])tgBot[_0x483577(0x191)](_0x1a21e8['chat']['id'],_0x483577(0x243))[_0x483577(0x2b0)](_0x2f2086=>{telegramError(_0x2f2086);});}),tgBot['removeListener'](_0x38f65d(0x16f));});}),tgBot[_0x491dc9(0x2a6)](/\/status/,_0x1c7c84=>{const _0x2985f4=_0x491dc9;if(!validateTelegram(_0x1c7c84))return;const _0x4c6481=getBotsWithMode();let _0x4fcece=_0x2985f4(0x221);config[_0x2985f4(0x2b5)](_0x2ead5b=>{const _0x458616=_0x2985f4,_0x2b9975=_0x4c6481[_0x458616(0x23c)](_0x3da9f9=>_0x3da9f9['botID']==_0x2ead5b[_0x458616(0x22c)])[_0x458616(0x268)];_0x4fcece+=_0x458616(0x20a)+_0x2ead5b['botID']+':\x20'+_0x2ead5b[_0x458616(0x14a)]+'\x20|\x20'+_0x2b9975+_0x458616(0x2a0)+_0x2ead5b['live']+'\x0a';}),_0x4fcece+='\x0a',_0x4fcece+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4fcece+=!settings[_0x2985f4(0x2df)]?_0x2985f4(0x128):'Notifications\x20enabled\x0a',_0x4fcece+=settings[_0x2985f4(0x2df)]?settings['telegramEvents']==_0x2985f4(0x2d8)?_0x2985f4(0x2d0):'Notifications\x20types:\x20'+settings[_0x2985f4(0x296)]+_0x2985f4(0x18a):'',tgBot['sendMessage'](_0x1c7c84[_0x2985f4(0x1fa)]['id'],_0x4fcece,{'parse_mode':'HTML'})['catch'](_0x358e91=>{telegramError(_0x358e91);});}),tgBot[_0x491dc9(0x2a6)](/\/restart/,_0x4a51cd=>{const _0x174975=_0x491dc9;if(!validateTelegram(_0x4a51cd))return;tgBot['removeListener']('callback_query');const _0x188d6a=getEnabledBots();if(_0x188d6a[_0x174975(0x15b)]==0x0)tgBot[_0x174975(0x191)](_0x4a51cd[_0x174975(0x1fa)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x174975(0x2b0)](_0x1a3e2e=>{telegramError(_0x1a3e2e);});else{if(_0x188d6a[_0x174975(0x15b)]>0x1)_0x188d6a[_0x174975(0x131)]({'botID':_0x174975(0x2d8)});let _0x4a3512=[],_0x1f03b2=[];const _0x59de78=_0x188d6a[_0x174975(0x15b)]%0x4==0x0||_0x188d6a[_0x174975(0x15b)]%0x4==0x3||_0x188d6a[_0x174975(0x15b)]%0x3==0x1?0x4:0x3;let _0x263662=0x0;_0x188d6a['forEach']((_0x5d5f2f,_0x2db10a)=>{const _0x176c71=_0x174975;if(_0x2db10a%_0x59de78==0x0)_0x1f03b2=[];_0x1f03b2[_0x176c71(0x131)]({'text':_0x5d5f2f[_0x176c71(0x22c)]==_0x176c71(0x2d8)?_0x176c71(0x273):_0x176c71(0x20a)+_0x5d5f2f['botID'],'callback_data':_0x5d5f2f[_0x176c71(0x22c)]}),_0x2db10a%_0x59de78==0x0&&(_0x4a3512[_0x263662]=_0x1f03b2,_0x263662++);}),tgBot[_0x174975(0x191)](_0x4a51cd[_0x174975(0x1fa)]['id'],_0x174975(0x166),{'reply_markup':{'inline_keyboard':_0x4a3512}})[_0x174975(0x2b0)](_0x4378d6=>{telegramError(_0x4378d6);}),tgBot['on'](_0x174975(0x16f),async _0x469935=>{const _0x2cca9e=_0x174975,_0x3cd276=_0x469935[_0x2cca9e(0x2da)],_0x2d7e8e=_0x469935[_0x2cca9e(0x1b0)];tgBot[_0x2cca9e(0x285)](_0x469935['id'])[_0x2cca9e(0x235)](async()=>{const _0x13837e=_0x2cca9e;_0x3cd276==_0x13837e(0x2d8)?config['forEach'](_0x54b61b=>{const _0x27e886=_0x13837e;restartBot(_0x54b61b[_0x27e886(0x22c)]);}):restartBot(_0x3cd276);}),tgBot[_0x2cca9e(0x262)](_0x2cca9e(0x16f));});}}),tgBot[_0x491dc9(0x2a6)](/\/on/,_0x10858e=>{const _0x1a3a5e=_0x491dc9;if(!validateTelegram(_0x10858e))return;tgBot['removeListener'](_0x1a3a5e(0x16f));const _0x26ad7a=getDisabledBots();if(_0x26ad7a['length']==0x0)tgBot['sendMessage'](_0x10858e['chat']['id'],_0x1a3a5e(0x26e))['catch'](_0x51fe70=>{telegramError(_0x51fe70);});else{if(_0x26ad7a[_0x1a3a5e(0x15b)]>0x1)_0x26ad7a['push']({'botID':'all'});let _0x2beffe=[],_0x5d200d=[];const _0x597c5a=_0x26ad7a[_0x1a3a5e(0x15b)]%0x4==0x0||_0x26ad7a[_0x1a3a5e(0x15b)]%0x4==0x3||_0x26ad7a['length']%0x3==0x1?0x4:0x3;let _0x5e1e40=0x0;_0x26ad7a[_0x1a3a5e(0x2b5)]((_0x20f43a,_0x110938)=>{const _0x234152=_0x1a3a5e;if(_0x110938%_0x597c5a==0x0)_0x5d200d=[];_0x5d200d[_0x234152(0x131)]({'text':_0x20f43a['botID']==_0x234152(0x2d8)?_0x234152(0x273):_0x234152(0x20a)+_0x20f43a[_0x234152(0x22c)],'callback_data':_0x20f43a[_0x234152(0x22c)]}),_0x110938%_0x597c5a==0x0&&(_0x2beffe[_0x5e1e40]=_0x5d200d,_0x5e1e40++);}),tgBot['sendMessage'](_0x10858e[_0x1a3a5e(0x1fa)]['id'],_0x1a3a5e(0x2d6),{'reply_markup':{'inline_keyboard':_0x2beffe}})['catch'](_0xfb45b4=>{telegramError(_0xfb45b4);}),tgBot['on'](_0x1a3a5e(0x16f),async _0x2721a3=>{const _0x5ca6e3=_0x1a3a5e,_0x216bc8=_0x2721a3[_0x5ca6e3(0x2da)],_0x208c1f=_0x2721a3[_0x5ca6e3(0x1b0)];tgBot[_0x5ca6e3(0x285)](_0x2721a3['id'])[_0x5ca6e3(0x235)](async()=>{const _0x4d4b67=_0x5ca6e3;_0x216bc8==_0x4d4b67(0x2d8)?(tgBot[_0x4d4b67(0x191)](_0x208c1f['chat']['id'],_0x4d4b67(0x1c8))[_0x4d4b67(0x2b0)](_0x593278=>{telegramError(_0x593278);}),_0x26ad7a[_0x4d4b67(0x2b5)](_0x53f3cd=>{const _0xc0a758=_0x4d4b67;if(_0x53f3cd['botID']!=_0xc0a758(0x2d8))toggleBot(_0x53f3cd[_0xc0a758(0x22c)],toggleStatus(_0x53f3cd[_0xc0a758(0x22c)]),_0xc0a758(0x244));})):(tgBot['sendMessage'](_0x208c1f[_0x4d4b67(0x1fa)]['id'],_0x4d4b67(0x20d)+_0x216bc8)[_0x4d4b67(0x2b0)](_0x94213b=>{telegramError(_0x94213b);}),toggleBot(_0x216bc8,toggleStatus(_0x216bc8),'stopped'));}),tgBot[_0x5ca6e3(0x262)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x4b7157=>{const _0x123645=_0x491dc9;if(!validateTelegram(_0x4b7157))return;tgBot[_0x123645(0x262)]('callback_query');const _0x177df1=getEnabledBots();if(_0x177df1[_0x123645(0x15b)]==0x0)tgBot[_0x123645(0x191)](_0x4b7157[_0x123645(0x1fa)]['id'],_0x123645(0x11c))[_0x123645(0x2b0)](_0x33f8a2=>{telegramError(_0x33f8a2);});else{if(_0x177df1['length']>0x1)_0x177df1[_0x123645(0x131)]({'botID':'all'});let _0x59e030=[],_0x4784a6=[];const _0x521e37=_0x177df1[_0x123645(0x15b)]%0x4==0x0||_0x177df1[_0x123645(0x15b)]%0x4==0x3||_0x177df1[_0x123645(0x15b)]%0x3==0x1?0x4:0x3;let _0x38384a=0x0;_0x177df1[_0x123645(0x2b5)]((_0x2e8221,_0x297601)=>{const _0x4be556=_0x123645;if(_0x297601%_0x521e37==0x0)_0x4784a6=[];_0x4784a6['push']({'text':_0x2e8221[_0x4be556(0x22c)]=='all'?_0x4be556(0x273):'Bot\x20'+_0x2e8221['botID'],'callback_data':_0x2e8221[_0x4be556(0x22c)]}),_0x297601%_0x521e37==0x0&&(_0x59e030[_0x38384a]=_0x4784a6,_0x38384a++);}),tgBot[_0x123645(0x191)](_0x4b7157[_0x123645(0x1fa)]['id'],_0x123645(0x239),{'reply_markup':{'inline_keyboard':_0x59e030}})[_0x123645(0x2b0)](_0x32cd3b=>{telegramError(_0x32cd3b);}),tgBot['on'](_0x123645(0x16f),async _0x3f45ca=>{const _0x23e1f0=_0x123645,_0x51b272=_0x3f45ca['data'],_0x1332e1=_0x3f45ca['message'];tgBot[_0x23e1f0(0x285)](_0x3f45ca['id'])[_0x23e1f0(0x235)](async()=>{const _0xe078c4=_0x23e1f0;_0x51b272=='all'?(tgBot['sendMessage'](_0x1332e1[_0xe078c4(0x1fa)]['id'],_0xe078c4(0x2b7))[_0xe078c4(0x2b0)](_0x30236b=>{telegramError(_0x30236b);}),_0x177df1[_0xe078c4(0x2b5)](_0x4e7db7=>{const _0x5be1c2=_0xe078c4;if(_0x4e7db7[_0x5be1c2(0x22c)]!=_0x5be1c2(0x2d8))toggleBot(_0x4e7db7[_0x5be1c2(0x22c)],toggleStatus(_0x4e7db7[_0x5be1c2(0x22c)]),_0x5be1c2(0x244));})):(tgBot[_0xe078c4(0x191)](_0x1332e1[_0xe078c4(0x1fa)]['id'],_0xe078c4(0x1df)+_0x51b272)[_0xe078c4(0x2b0)](_0x1dfe94=>{telegramError(_0x1dfe94);}),toggleBot(_0x51b272,toggleStatus(_0x51b272),_0xe078c4(0x244)));}),tgBot[_0x23e1f0(0x262)](_0x23e1f0(0x16f));});}}),tgBot['onText'](/\/metrics/,_0x5d73c5=>{const _0x1df3a2=_0x491dc9;if(!validateTelegram(_0x5d73c5))return;tgBot['removeListener'](_0x1df3a2(0x16f));const _0x2dd1eb=getEnabledBots();if(_0x2dd1eb[_0x1df3a2(0x15b)]==0x0)tgBot[_0x1df3a2(0x191)](_0x5d73c5[_0x1df3a2(0x1fa)]['id'],_0x1df3a2(0x11c))[_0x1df3a2(0x2b0)](_0x1e4225=>{telegramError(_0x1e4225);});else{if(_0x2dd1eb['length']>0x1){let _0x403583=[],_0x3e77a5=[];const _0x4041df=_0x2dd1eb[_0x1df3a2(0x15b)]%0x4==0x0||_0x2dd1eb['length']%0x4==0x3||_0x2dd1eb[_0x1df3a2(0x15b)]%0x3==0x1?0x4:0x3;let _0x1db961=0x0;_0x2dd1eb[_0x1df3a2(0x2b5)]((_0x67badd,_0x587f9c)=>{const _0x11453d=_0x1df3a2;if(_0x587f9c%_0x4041df==0x0)_0x3e77a5=[];_0x3e77a5['push']({'text':_0x11453d(0x20a)+_0x67badd[_0x11453d(0x22c)],'callback_data':_0x67badd[_0x11453d(0x22c)]}),_0x587f9c%_0x4041df==0x0&&(_0x403583[_0x1db961]=_0x3e77a5,_0x1db961++);}),tgBot['sendMessage'](_0x5d73c5[_0x1df3a2(0x1fa)]['id'],_0x1df3a2(0x13f),{'reply_markup':{'inline_keyboard':_0x403583}})[_0x1df3a2(0x2b0)](_0xf7968b=>{telegramError(_0xf7968b);}),tgBot['on'](_0x1df3a2(0x16f),async _0x337328=>{const _0x369ec9=_0x1df3a2,_0x1c6b52=_0x337328[_0x369ec9(0x2da)],_0x520669=_0x337328[_0x369ec9(0x1b0)];tgBot[_0x369ec9(0x285)](_0x337328['id'])[_0x369ec9(0x235)](async()=>{const _0x4e5d67=_0x369ec9;if(pid[_0x1c6b52])pid[_0x1c6b52][_0x4e5d67(0x2a3)]({'function':_0x4e5d67(0x17b),'args':null});}),tgBot[_0x369ec9(0x262)]('callback_query');});}else{const _0x5393d8=_0x2dd1eb[0x0][_0x1df3a2(0x22c)];if(pid[_0x5393d8])pid[_0x5393d8][_0x1df3a2(0x2a3)]({'function':_0x1df3a2(0x17b),'args':null});}}}),tgBot[_0x491dc9(0x2a6)](/\/portfolio/,_0x1c765a=>{const _0x250607=_0x491dc9;if(!validateTelegram(_0x1c765a))return;tgBot[_0x250607(0x262)]('callback_query');const _0x16071f=getEnabledBots();if(_0x16071f[_0x250607(0x15b)]==0x0)tgBot[_0x250607(0x191)](_0x1c765a[_0x250607(0x1fa)]['id'],_0x250607(0x11c))[_0x250607(0x2b0)](_0x2258ff=>{telegramError(_0x2258ff);});else{if(_0x16071f[_0x250607(0x15b)]>0x1){let _0x20338c=[],_0x140b8c=[];const _0x29168a=_0x16071f['length']%0x4==0x0||_0x16071f['length']%0x4==0x3||_0x16071f[_0x250607(0x15b)]%0x3==0x1?0x4:0x3;let _0x1e7627=0x0;_0x16071f['forEach']((_0x4b9ce6,_0xea8146)=>{const _0x4c12d=_0x250607;if(_0xea8146%_0x29168a==0x0)_0x140b8c=[];_0x140b8c[_0x4c12d(0x131)]({'text':_0x4c12d(0x20a)+_0x4b9ce6['botID'],'callback_data':_0x4b9ce6[_0x4c12d(0x22c)]}),_0xea8146%_0x29168a==0x0&&(_0x20338c[_0x1e7627]=_0x140b8c,_0x1e7627++);}),tgBot[_0x250607(0x191)](_0x1c765a[_0x250607(0x1fa)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x20338c}})['catch'](_0x4e60cc=>{telegramError(_0x4e60cc);}),tgBot['on']('callback_query',async _0x2c0cb7=>{const _0x4d0317=_0x250607,_0x1c9b07=_0x2c0cb7[_0x4d0317(0x2da)],_0x3a6246=_0x2c0cb7['message'];tgBot[_0x4d0317(0x285)](_0x2c0cb7['id'])[_0x4d0317(0x235)](async()=>{const _0x5a895a=_0x4d0317;if(pid[_0x1c9b07])pid[_0x1c9b07][_0x5a895a(0x2a3)]({'function':_0x5a895a(0x22d),'args':null});}),tgBot[_0x4d0317(0x262)](_0x4d0317(0x16f));});}else{const _0x15d035=_0x16071f[0x0]['botID'];if(pid[_0x15d035])pid[_0x15d035][_0x250607(0x2a3)]({'function':_0x250607(0x22d),'args':null});}}}),tgBot[_0x491dc9(0x2a6)](/\/update/,async _0x4f9ed4=>{const _0x22b089=_0x491dc9;if(!validateTelegram(_0x4f9ed4))return;tgBot[_0x22b089(0x262)](_0x22b089(0x16f)),await getMessages();if(!updateAvailable)tgBot[_0x22b089(0x191)](_0x4f9ed4['chat']['id'],_0x22b089(0x12e))[_0x22b089(0x2b0)](_0x3a3cf3=>{telegramError(_0x3a3cf3);});else!validInstallation?tgBot['sendMessage'](_0x4f9ed4['chat']['id'],_0x22b089(0x29f))[_0x22b089(0x2b0)](_0x2ce19e=>{telegramError(_0x2ce19e);}):(tgBot[_0x22b089(0x191)](_0x4f9ed4[_0x22b089(0x1fa)]['id'],_0x22b089(0x20c),{'reply_markup':{'inline_keyboard':[[{'text':_0x22b089(0x1f5),'callback_data':_0x22b089(0x23a)},{'text':'No','callback_data':'no'}]]}})[_0x22b089(0x2b0)](_0x5533c2=>{telegramError(_0x5533c2);}),tgBot['on'](_0x22b089(0x16f),async _0x3a2fad=>{const _0x4c6f0c=_0x22b089,_0x396636=_0x3a2fad[_0x4c6f0c(0x2da)],_0x7b3e33=_0x3a2fad['message'];tgBot[_0x4c6f0c(0x285)](_0x3a2fad['id'])[_0x4c6f0c(0x235)](async()=>{const _0xc5f73c=_0x4c6f0c;_0x396636==_0xc5f73c(0x23a)&&(await tgBot['sendMessage'](_0x7b3e33[_0xc5f73c(0x1fa)]['id'],_0xc5f73c(0x1ea))[_0xc5f73c(0x2b0)](_0x92ce85=>{telegramError(_0x92ce85);}),updateBB(_0xc5f73c(0x1bf))),_0x396636=='no'&&await tgBot[_0xc5f73c(0x191)](_0x7b3e33['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0xc5f73c(0x2b0)](_0x2c114e=>{telegramError(_0x2c114e);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x491dc9(0x2a6)](/\/reinstall/,async _0x93173d=>{const _0x83466d=_0x491dc9;if(!validateTelegram(_0x93173d))return;tgBot['removeListener'](_0x83466d(0x16f)),!validInstallation?tgBot[_0x83466d(0x191)](_0x93173d[_0x83466d(0x1fa)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x83466d(0x2b0)](_0xb45376=>{telegramError(_0xb45376);}):(tgBot[_0x83466d(0x191)](_0x93173d['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x83466d(0x1f5),'callback_data':_0x83466d(0x23a)},{'text':'No','callback_data':'no'}]]}})[_0x83466d(0x2b0)](_0x225cb4=>{telegramError(_0x225cb4);}),tgBot['on']('callback_query',async _0x268b96=>{const _0xd9839d=_0x83466d,_0x2bd432=_0x268b96[_0xd9839d(0x2da)],_0x1567bd=_0x268b96[_0xd9839d(0x1b0)];tgBot[_0xd9839d(0x285)](_0x268b96['id'])['then'](async()=>{const _0x269a0c=_0xd9839d;_0x2bd432==_0x269a0c(0x23a)&&(await tgBot[_0x269a0c(0x191)](_0x1567bd[_0x269a0c(0x1fa)]['id'],_0x269a0c(0x160))['catch'](_0x1096b4=>{telegramError(_0x1096b4);}),updateBB(_0x269a0c(0x176))),_0x2bd432=='no'&&await tgBot['sendMessage'](_0x1567bd[_0x269a0c(0x1fa)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x269a0c(0x2b0)](_0x4e286e=>{telegramError(_0x4e286e);});}),tgBot[_0xd9839d(0x262)](_0xd9839d(0x16f));}));}),tgBot['onText'](/\/toggle/,_0x4d5084=>{const _0x3a43b2=_0x491dc9;if(!validateTelegram(_0x4d5084))return;tgBot[_0x3a43b2(0x262)](_0x3a43b2(0x16f));const _0x5bdd9d=getBotsWithMode();if(_0x5bdd9d['length']==0x0)tgBot[_0x3a43b2(0x191)](_0x4d5084['chat']['id'],_0x3a43b2(0x11c))[_0x3a43b2(0x2b0)](_0x4ee84c=>{telegramError(_0x4ee84c);});else{let _0x44008c=[],_0x44f700=[];const _0x3e088a=0x2;let _0x223032=0x0;_0x5bdd9d[_0x3a43b2(0x2b5)]((_0x4705b4,_0xd7150b)=>{const _0x265b11=_0x3a43b2;if(_0xd7150b%_0x3e088a==0x0)_0x44f700=[];_0x44f700[_0x265b11(0x131)]({'text':'Bot\x20'+_0x4705b4[_0x265b11(0x22c)]+'\x20('+_0x4705b4[_0x265b11(0x268)]+')','callback_data':_0x4705b4[_0x265b11(0x22c)]}),_0xd7150b%_0x3e088a==0x0&&(_0x44008c[_0x223032]=_0x44f700,_0x223032++);}),tgBot[_0x3a43b2(0x191)](_0x4d5084['chat']['id'],_0x3a43b2(0x292),{'reply_markup':{'inline_keyboard':_0x44008c}})[_0x3a43b2(0x2b0)](_0x2b967e=>{telegramError(_0x2b967e);}),tgBot['on']('callback_query',async _0x58c195=>{const _0x3247bf=_0x3a43b2,_0x58d70d=_0x58c195[_0x3247bf(0x2da)],_0x12efd8=_0x58c195[_0x3247bf(0x1b0)];tgBot[_0x3247bf(0x285)](_0x58c195['id'])[_0x3247bf(0x235)](async()=>{const _0x5f2595=_0x3247bf,_0x261f08=_0x5bdd9d[_0x5f2595(0x23c)](_0x5d06b8=>_0x5d06b8[_0x5f2595(0x22c)]==_0x58d70d),_0x4c769c=_0x261f08['mode']=='auto'?_0x5f2595(0x17d):_0x5f2595(0x1c6);tgBot['sendMessage'](_0x12efd8[_0x5f2595(0x1fa)]['id'],_0x5f2595(0x2bd)+_0x58d70d+_0x5f2595(0x1ce)+_0x4c769c+_0x5f2595(0x2c7))['catch'](_0x51c912=>{telegramError(_0x51c912);}),toggleBotMode(_0x58d70d);}),tgBot[_0x3247bf(0x262)]('callback_query');});}}),tgBot[_0x491dc9(0x2a6)](/\/names/,_0x5246e9=>{const _0x54ff9a=_0x491dc9;if(!validateTelegram(_0x5246e9))return;let _0x2147ce='';config['forEach'](_0x25921e=>{const _0x2060b8=_0x2929;_0x2147ce+=_0x2060b8(0x20a)+_0x25921e[_0x2060b8(0x22c)]+':\x20'+_0x25921e['botname']+'\x0a';}),tgBot[_0x54ff9a(0x191)](_0x5246e9[_0x54ff9a(0x1fa)]['id'],_0x2147ce,{'parse_mode':_0x54ff9a(0x20b)})[_0x54ff9a(0x2b0)](_0x1e29a4=>{telegramError(_0x1e29a4);});}),tgBot[_0x491dc9(0x2a6)](/\/disable/,_0x13a481=>{const _0x116913=_0x491dc9;if(!validateTelegram(_0x13a481))return;tgBot[_0x116913(0x191)](_0x13a481[_0x116913(0x1fa)]['id'],_0x116913(0x2c6))['catch'](_0x52a6fe=>{telegramError(_0x52a6fe);}),updateSetting(_0x116913(0x2df),![]);}),tgBot[_0x491dc9(0x2a6)](/\/help/,_0x5ac95f=>{const _0x273079=_0x491dc9;if(!validateTelegram(_0x5ac95f))return;tgBot[_0x273079(0x191)](_0x5ac95f[_0x273079(0x1fa)]['id'],_0x10c36b)['catch'](_0x3ab086=>{telegramError(_0x3ab086);});}),tgBot['on'](_0x491dc9(0x1e8),_0x50deac=>{const _0x15ef8c=_0x491dc9;_0x50deac[_0x15ef8c(0x205)]()[_0x15ef8c(0x2dd)](_0x15ef8c(0x1a1))&&(logger[_0x15ef8c(0x282)](_0x15ef8c(0x259)),tgBot[_0x15ef8c(0x271)](),tgBot=null,io['to']('botmanager')[_0x15ef8c(0x174)](_0x15ef8c(0x28f),_0x15ef8c(0x259)));}),process[_0x491dc9(0x1b8)](_0x491dc9(0x1a2),()=>{const _0x2be423=_0x491dc9;if(tgBot)tgBot[_0x2be423(0x271)]();process[_0x2be423(0x184)](0x1);}),process[_0x491dc9(0x1b8)]('SIGTERM',()=>{const _0x1be57b=_0x491dc9;if(tgBot)tgBot[_0x1be57b(0x271)]();process[_0x1be57b(0x184)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x230bef,_0x459856){const _0x39ef9a=_0x423760;if(settings[_0x39ef9a(0x2df)]){if(settings[_0x39ef9a(0x296)]==_0x39ef9a(0x2d8)||(_0x459856['type']==_0x39ef9a(0x165)||_0x459856[_0x39ef9a(0x240)]==_0x39ef9a(0x2b2)||_0x459856[_0x39ef9a(0x240)]==_0x39ef9a(0x215))&&settings[_0x39ef9a(0x296)]=='alerts'||_0x459856['type']=='order'&&settings['telegramEvents']==_0x39ef9a(0x141)){if(tgBot&&settings[_0x39ef9a(0x130)]){if(_0x459856[_0x39ef9a(0x1e4)])tgBot['sendMessage'](settings[_0x39ef9a(0x130)],_0x459856[_0x39ef9a(0x1b2)]+_0x39ef9a(0x2fb)+_0x459856[_0x39ef9a(0x1fe)])[_0x39ef9a(0x2b0)](_0x269191=>{telegramError(_0x269191);});else tgBot[_0x39ef9a(0x191)](settings['telegramChatId'],_0x39ef9a(0x20a)+_0x230bef+_0x39ef9a(0x2fb)+_0x459856[_0x39ef9a(0x1fe)])[_0x39ef9a(0x2b0)](_0x55e43b=>{telegramError(_0x55e43b);});}}}}async function sendTelegramMsg(_0xb0b5cc,_0x484240='HTML'){const _0x10508b=_0x423760;return settings[_0x10508b(0x2df)]&&tgBot&&settings[_0x10508b(0x130)]?(await tgBot['sendMessage'](settings[_0x10508b(0x130)],_0xb0b5cc,{'parse_mode':_0x484240})[_0x10508b(0x2b0)](_0x3571ce=>{telegramError(_0x3571ce);}),!![]):![];}function getDeviceWithIp(_0x59c981){const _0x388a00=_0x423760;return devices[_0x388a00(0x23c)](_0x3b1d1f=>_0x3b1d1f['ip']===_0x59c981);}function temporaryAccess2FA(_0x3e6c58,_0x499c3c){const _0x5506a5=_0x423760;let _0x23164b=new Date(),_0x12ee90=![];if(lastIpApproval){if(_0x23164b-lastIpApproval<0x1388)_0x12ee90=!![];}lastIpApproval=new Date();if(_0x12ee90)return;tgBot&&settings[_0x5506a5(0x130)]&&(tgBot[_0x5506a5(0x262)]('callback_query'),tgBot['sendMessage'](settings[_0x5506a5(0x130)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x499c3c)['show']+'</b>\x20?',{'parse_mode':_0x5506a5(0x20b),'reply_markup':{'inline_keyboard':[[{'text':_0x5506a5(0x28c),'callback_data':'5'},{'text':_0x5506a5(0x1a9),'callback_data':'15'},{'text':_0x5506a5(0x24d),'callback_data':'30'},{'text':_0x5506a5(0x23f),'callback_data':_0x5506a5(0x23f)}]]}})['catch'](_0x465391=>{telegramError(_0x465391);}),tgBot['on'](_0x5506a5(0x16f),async _0x45dd1c=>{const _0x3bd62c=_0x5506a5,_0x414859=_0x45dd1c['data'],_0x42a388=_0x45dd1c[_0x3bd62c(0x1b0)];tgBot[_0x3bd62c(0x285)](_0x45dd1c['id'])[_0x3bd62c(0x235)](async()=>{const _0x57aba7=_0x3bd62c;devices[_0x3e6c58][_0x57aba7(0x18d)]={'clientip':_0x499c3c,'timestamp':new Date()[_0x57aba7(0x2c4)](),'expiry':_0x414859},_0x414859!=_0x57aba7(0x23f)?(await tgBot[_0x57aba7(0x191)](_0x42a388[_0x57aba7(0x1fa)]['id'],'Access\x20enabled\x20for\x20'+_0x414859+_0x57aba7(0x21c),{'parse_mode':_0x57aba7(0x20b)})[_0x57aba7(0x2b0)](_0x2160b5=>{telegramError(_0x2160b5);}),io['to'](_0x3e6c58)[_0x57aba7(0x174)](_0x57aba7(0x14a),{'access':{'allow':![],'reason':_0x57aba7(0x275),'token':null}})):(await tgBot[_0x57aba7(0x191)](_0x42a388[_0x57aba7(0x1fa)]['id'],_0x57aba7(0x272))['catch'](_0x48d9d1=>{telegramError(_0x48d9d1);}),io['to'](_0x3e6c58)['emit']('status',{'access':{'allow':![],'reason':_0x57aba7(0x12c),'token':null}}));}),tgBot[_0x3bd62c(0x262)](_0x3bd62c(0x16f));}));}function loginAccess2FA(_0x55c822,_0x44d657){const _0x3be219=_0x423760;tgBot&&settings[_0x3be219(0x130)]&&(tgBot[_0x3be219(0x262)](_0x3be219(0x16f)),tgBot['sendMessage'](settings[_0x3be219(0x130)],_0x3be219(0x276)+normalizeIP(_0x44d657)[_0x3be219(0x1cb)]+_0x3be219(0x1e7),{'parse_mode':_0x3be219(0x20b),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x3be219(0x23f),'callback_data':'reject'}]]}})['catch'](_0x4a4851=>{telegramError(_0x4a4851);}),tgBot['on'](_0x3be219(0x16f),async _0x5c0117=>{const _0xe05553=_0x3be219,_0x3d5c42=_0x5c0117[_0xe05553(0x2da)],_0x4325eb=_0x5c0117[_0xe05553(0x1b0)];tgBot[_0xe05553(0x285)](_0x5c0117['id'])[_0xe05553(0x235)](async()=>{const _0x4299d9=_0xe05553;devices[_0x55c822][_0x4299d9(0x1fc)]={'clientip':_0x44d657,'timestamp':new Date()[_0x4299d9(0x2c4)](),'expiry':_0x3d5c42},_0x3d5c42!='reject'?(await tgBot[_0x4299d9(0x191)](_0x4325eb['chat']['id'],_0x4299d9(0x2ae),{'parse_mode':_0x4299d9(0x20b)})[_0x4299d9(0x2b0)](_0x26a7ca=>{telegramError(_0x26a7ca);}),io['to'](_0x55c822)[_0x4299d9(0x174)](_0x4299d9(0x14a),{'access':{'allow':![],'reason':_0x4299d9(0x275),'token':null}})):(await tgBot[_0x4299d9(0x191)](_0x4325eb['chat']['id'],_0x4299d9(0x22a))['catch'](_0x4cdbe2=>{telegramError(_0x4cdbe2);}),io['to'](_0x55c822)[_0x4299d9(0x174)](_0x4299d9(0x14a),{'access':{'allow':![],'reason':_0x4299d9(0x21e),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x17cece=_0x423760;return dbConfig[_0x17cece(0x263)](_0x17cece(0x179))[_0x17cece(0x2e1)](_0x17cece(0x22c))[_0x17cece(0x125)]({'status':_0x17cece(0x12b)})['value']()||[];}function getDisabledBots(){const _0x5e5e66=_0x423760;return dbConfig[_0x5e5e66(0x263)]('bots')['sortBy']('botID')['filter']({'status':_0x5e5e66(0x202)})[_0x5e5e66(0x1b3)]()||[];}function getBotAttributes(_0x1b5404){const _0x5f1a99=_0x423760;let _0x20a4ab={};const _0x5ee2da=configpath+_0x5f1a99(0x24b)+_0x1b5404+'-config.json',_0x3683a0=fs['existsSync'](_0x5ee2da);if(_0x3683a0){const _0x4a2150=fs['readFileSync'](_0x5ee2da);try{const _0x5d44db=JSON[_0x5f1a99(0x13b)](_0x4a2150),_0x50cbc2=_0x5d44db?_0x5d44db[_0x5f1a99(0x1ca)][0x0][_0x5f1a99(0x2f3)]:![];_0x20a4ab[_0x5f1a99(0x268)]=_0x50cbc2?_0x5f1a99(0x1c6):_0x5f1a99(0x17d),_0x20a4ab[_0x5f1a99(0x1b2)]=_0x5d44db?_0x5d44db[_0x5f1a99(0x1ca)][0x0][_0x5f1a99(0x1b2)]:_0x5f1a99(0x20a)+_0x1b5404;}catch(_0x35c535){_0x20a4ab[_0x5f1a99(0x268)]='manual',_0x20a4ab[_0x5f1a99(0x1b2)]=_0x5f1a99(0x20a)+_0x1b5404;}}else _0x20a4ab['mode']=_0x5f1a99(0x17d),_0x20a4ab[_0x5f1a99(0x1b2)]=_0x5f1a99(0x20a)+_0x1b5404;return _0x20a4ab;}function getBotsWithMode(){const _0x41fbd1=_0x423760,_0x418451=dbConfig['get'](_0x41fbd1(0x179))[_0x41fbd1(0x2e1)]('botID')['value']()||[];return _0x418451[_0x41fbd1(0x2b5)](_0x324c9b=>{const _0x10a7be=_0x41fbd1;let _0x1b3e2d=getBotAttributes(_0x324c9b[_0x10a7be(0x22c)]);_0x324c9b[_0x10a7be(0x268)]=_0x1b3e2d[_0x10a7be(0x268)];}),_0x418451;}function getBotExchanges(){const _0x338985=_0x423760;let _0x5d81c7=[];const _0x278a14=dbConfig[_0x338985(0x263)](_0x338985(0x179))['sortBy'](_0x338985(0x22c))[_0x338985(0x1b3)]()||[];_0x278a14[_0x338985(0x2b5)](_0x3fec9a=>{const _0x175abc=_0x338985;if(_0x3fec9a[_0x175abc(0x14a)]==_0x175abc(0x12b)){const _0xa97032=configpath+'bot-'+_0x3fec9a[_0x175abc(0x22c)]+'-config.json',_0x1f82e=fs[_0x175abc(0x195)](_0xa97032);let _0x5dfc0b;if(_0x1f82e){const _0x3d5b26=fs[_0x175abc(0x1b6)](_0xa97032);try{const _0x5a8cb7=JSON[_0x175abc(0x13b)](_0x3d5b26);_0x5dfc0b=_0x5a8cb7?_0x5a8cb7[_0x175abc(0x1ca)][0x0][_0x175abc(0x28e)]:null;}catch(_0x2fee03){}}if(_0x5dfc0b)_0x5d81c7[_0x175abc(0x131)](_0x5dfc0b);}});const _0x4aa757=[...new Set(_0x5d81c7)]['sort']();return _0x4aa757;}async function initUser(){const _0x5947a1=_0x423760;if(!settings[_0x5947a1(0x132)]){const _0x58f10e=uuidRandom();mixpanel[_0x5947a1(0x26c)](_0x58f10e),updateSetting(_0x5947a1(0x132),_0x58f10e);}}async function initSecure(){const _0x4fa139=_0x423760;let _0xde0fe=getSecure();if(!_0xde0fe['hasOwnProperty'](_0x4fa139(0x136))){let _0x3d2771=await generateKeys();_0xde0fe['publicKey']=_0x3d2771[_0x4fa139(0x2be)],_0xde0fe['privateKey']=_0x3d2771[_0x4fa139(0x27c)],_0xde0fe[_0x4fa139(0x136)]=crypto[_0x4fa139(0x225)](0x20)['toString'](_0x4fa139(0x2f0));;storeSecure(_0xde0fe);}}function getSettings(){const _0x3cf35d=_0x423760;return dbSettings[_0x3cf35d(0x263)](_0x3cf35d(0x1b4))[_0x3cf35d(0x1b3)]()||{};}function getSecure(){const _0x148405=_0x423760;return dbSecure['get']('secure')[_0x148405(0x1b3)]()||{};}function getBlacklist(){const _0x1317e0=_0x423760;return dbSecure['get'](_0x1317e0(0x14c))[_0x1317e0(0x1b3)]()||[];}function broadcastToBots(_0x17a579,_0x33ccd4){const _0x831008=_0x423760;config[_0x831008(0x2b5)](_0x3e7e34=>{const _0x273607=_0x831008;if(_0x3e7e34['status']=='enabled'&&_0x3e7e34[_0x273607(0x135)]==_0x273607(0x2cc)||_0x3e7e34[_0x273607(0x14a)]=='new'&&_0x3e7e34[_0x273607(0x135)]=='running'){if(pid[_0x3e7e34[_0x273607(0x22c)]])pid[_0x3e7e34['botID']][_0x273607(0x2a3)]({[_0x17a579]:_0x33ccd4});}});}function storeSettings(_0x5e0beb,_0x1c3fc8=![]){const _0x3baf64=_0x423760;_0x5e0beb={...settings,..._0x5e0beb};if(_0x1c3fc8&&_0x5e0beb[_0x3baf64(0x182)]!=_0x3baf64(0x1c9)&&_0x5e0beb['bbPassword']!='***'&&_0x5e0beb['bbPassword']!=''){const _0x5838b3=crypt['decrypt'](secure[_0x3baf64(0x27c)],_0x5e0beb['bbPassword'])[_0x3baf64(0x1b0)][_0x3baf64(0x2ed)]('@')[0x0],_0x306ff2=bcrypt[_0x3baf64(0x149)](_0x5838b3,saltRounds);_0x5e0beb={..._0x5e0beb,'bbPassword':_0x306ff2};}if(_0x1c3fc8&&_0x5e0beb[_0x3baf64(0x213)]!=_0x3baf64(0x1c9)&&_0x5e0beb[_0x3baf64(0x213)]!='***'&&_0x5e0beb[_0x3baf64(0x213)]!=''){const _0x40daa6=crypt[_0x3baf64(0x214)](secure[_0x3baf64(0x27c)],_0x5e0beb[_0x3baf64(0x213)])[_0x3baf64(0x1b0)][_0x3baf64(0x2ed)]('@')[0x0];_0x5e0beb={..._0x5e0beb,'telegramToken':_0x40daa6};}const _0x28e4ff=_0x5e0beb[_0x3baf64(0x213)]!=_0x3baf64(0x1c9)&&_0x5e0beb[_0x3baf64(0x213)]!=settings['telegramToken']||_0x5e0beb[_0x3baf64(0x1a7)]!=settings['telegramUsername'],_0x29cd6a=_0x5e0beb[_0x3baf64(0x213)]==''||_0x5e0beb[_0x3baf64(0x1a7)]=='';if(_0x28e4ff)_0x5e0beb[_0x3baf64(0x296)]=_0x3baf64(0x2d8);for(const [_0x292734,_0xdd07a7]of Object[_0x3baf64(0x15e)](_0x5e0beb)){if(_0x292734=='telegramToken'&&_0xdd07a7==_0x3baf64(0x1c9)){_0x5e0beb[_0x3baf64(0x213)]=settings[_0x3baf64(0x213)];continue;};if(_0x292734==_0x3baf64(0x182)&&_0xdd07a7=='************'){_0x5e0beb[_0x3baf64(0x182)]=settings[_0x3baf64(0x182)];continue;};dbSettings[_0x3baf64(0x1a5)](_0x3baf64(0x28a)+_0x292734,_0xdd07a7)[_0x3baf64(0x237)]();}settings=_0x5e0beb,io['to']('botmanager')[_0x3baf64(0x174)]('settings',cleanSettings()),broadcastToBots(_0x3baf64(0x137),settings[_0x3baf64(0x137)]),broadcastToBots(_0x3baf64(0x1a0),settings[_0x3baf64(0x1a0)]);if(_0x28e4ff&&!_0x29cd6a)initTelegram();if(_0x28e4ff&&_0x29cd6a)disableTelegram();getAllClients()[_0x3baf64(0x2b5)](_0x58f1d9=>{const _0x35d4b6=_0x3baf64;getSocket(_0x58f1d9['id'])[_0x35d4b6(0x174)](_0x35d4b6(0x14a),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x483281,_0x364f2d){const _0x4553f0=_0x423760;dbSettings[_0x4553f0(0x1a5)](_0x4553f0(0x28a)+_0x483281,_0x364f2d)[_0x4553f0(0x237)](),settings=getSettings(),io['to'](_0x4553f0(0x298))[_0x4553f0(0x174)](_0x4553f0(0x1b4),cleanSettings());}function storeSecure(_0x425606){const _0x4f3e81=_0x423760;dbSecure['get'](_0x4f3e81(0x12d))['push'](_0x425606)[_0x4f3e81(0x237)](),secure=_0x425606;}function addBlacklist(_0x6c5838){const _0x2c2a7d=_0x423760;cleanBlacklist();let _0x4d27c2;devices[_0x6c5838]['telegramIpApproval']?_0x4d27c2=Math[_0x2c2a7d(0x17e)](devices[_0x6c5838][_0x2c2a7d(0x18d)][_0x2c2a7d(0x1f7)],loginExpiry):_0x4d27c2=loginExpiry,dbSecure['get']('blacklist')[_0x2c2a7d(0x131)]({'expiry':new Date()['getTime']()+_0x4d27c2*0x3c*0x3e8,'token':devices[_0x6c5838]['access'][_0x2c2a7d(0x15a)]})['write'](),blacklist=dbSecure['get'](_0x2c2a7d(0x14c))[_0x2c2a7d(0x1b3)]();}function _0x2060(){const _0x567c87=['blacklist','cancelLoading','sign','Backup\x20file\x20unzipped\x20and\x20stored','axios','crypto','static','https://api.ipify.org?format=json','title','family','Restoring\x20bot(s)\x20from\x20backup','backupfile','bb-settings.json','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','token','length','/:bot/support','store','entries','node-zip','Starting\x20Balance\x20Bot\x20reinstallation','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','encryptedUuid','temporary\x20access\x20timeout','password','error','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20add\x20bot','getMinutes','DEFLATE','writeFileSync','clientip','readdirSync','endsWith','/:bot/portfolio','callback_query','sendFile','compareSync','User\x20has\x20been\x20validated','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','emit','any','reinstall','alerts','latestversion','bots','rmSync','sendMetricsTelegram','timestamp','manual','max','log','file','handshake','bbPassword','backup-files','exit','sort','(((.+)+)+)+$','127.0.0.1','version','store-settings','\x20only\x0a','connected','verify','telegramIpApproval','_data','connection','\x20|\x20client:\x20...','sendMessage','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','[ip-address]','kill','existsSync','getPortfolio','new','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','simple','Unauthorized\x20attempt\x20to\x20delete\x20bot','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20confirm\x20message','cloneDeep','padStart','messages','onepagemode','404\x20Not\x20Found','SIGINT','env','fork','set','store-configuration','telegramUsername','internal','15\x20min','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','pidExpireLogin','host','init','search','All','message','50QpVKtQ','botname','value','settings','reset-password','readFileSync','bbvNew','once','user','Setting\x20access:\x20','-results.json','Invalid\x20authentication\x20token\x20(2)','build','getFullYear','update','login\x20required','match','::ffff:127.0.0.1','Restore\x20backup\x20file\x20','socket','reason','auto','Logged\x20out\x20user\x20...','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','************','bot','show','/status\x20-\x20show\x20bot(s)\x20status\x0a','args','\x20to\x20','12SQZCgp','auth','telegram','uuid','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','request','isDirectory','bbvReceive','confirm-message','Unauthorized\x20attempt\x20to\x20log\x20out','300735ggftCo','Failed\x20to\x20download\x20','node','703848wUVfOu','stringify','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','login','backup-full.zip','storeHeadless','test','showname','getSeconds','2FA\x20required','</b>\x20?','polling_error','socket.io','Starting\x20Balance\x20Bot\x20update','index.html','/off\x20-\x20stop\x20bot(s)\x0a','bb-secure.json','argv','deleteHistoryAlerts','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','lastmsgtelegram','uncaughtException','\x1b[31m','delete-alerts','Yes','.zip','expiry','File\x20uploaded','build2','chat','-performance.json','telegram2FaApproval','remoteAddress','event','update-bot','apiKey','Crypt','disabled','lowdb/adapters/FileSync','function','toString','=>\x20Go\x20to\x20#BLU#http://','getStartingBalances','updatebotmanager','sha256','Bot\x20','HTML','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Server','get-starting-balances','referer','isIPv4MappedAddress','NTBA_FIX_319','telegramToken','decrypt','success','clients','Unauthorized\x20attempt\x20to\x20get\x20events','apply','exp','Network\x20Interfaces:','Ok,\x20will\x20send\x20order\x20notifications\x20only','\x20minutes','download','2FA\x20login\x20rejected','pidRefreshToken','Alerts','<b>Balance\x20Bot\x20Status:</b>\x0a','/disable\x20-\x20disable\x20notifications\x0a','debug','statSync','randomBytes','1000','reset-history','loginRequired','login\x20token\x20generated','Login\x20rejected','apiSecret','botID','sendPortfolioTelegram','2FA\x20login\x20required','getHours','graphql-request','getMonth','Invalid\x20IP\x20address','output-003.log','version.json','then','generateKeyPairAsync','write','output-000.log','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','yes','output-001.log','find','node-telegram-bot-api','toIPv4Address','reject','type','name','f2aRequired','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','stopped','new-disabled','Node.js\x20v','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Token\x20blacklisted','Notifications\x20enabled','/:bot','bot-','slice','30\x20min','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','listen','Logged\x20in\x20user\x20...','startsWith','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','::1','logs','mkdirSync','login\x20not\x20required','kind','http','Invalid\x20Telegram\x20token','sockets','1641633BqBeJh','get-messages','place-order','username','stop','Bot\x20Mgr\x20>\x20','-events.json','removeListener','get','exec','hasOwnProperty','backup-full@','Password\x20has\x20been\x20reset\x20to:\x20','mode','Backup\x20file\x20uploaded','output-002.log','randomFillSync','alias','$1_$2_$3','All\x20bots\x20running\x20right\x20now','logout','Password\x20reset\x20rejected','stopPolling','Temporary\x20access\x20rejected','All\x20bots','telegrammsg','reload','Allow\x20login\x20from\x20IP\x20address\x20<b>','files','initclient','started','2FA\x20login\x20token\x20generated','uuid-random','privateKey','bcryptjs','=>\x20Go\x20to\x20#BLU#http://127.0.0.1:','You\x20can\x20use\x20the\x20following\x20commands:\x0a','mixpanel','inherit','full','lastmsgemitted','get-portfolio','answerCallbackQuery','0.0.0','Starting\x20Balance\x20Bot\x20','apiPassword','format','settings.','getDate','5\x20min','210EYBFtF','exchange','notification','copyFileSync','#RES#\x20if\x20running\x20on\x20server','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Unauthorized\x20attempt\x20to\x20get\x20messages','unlinkSync','Unauthorized\x20attempt\x20to\x20store\x20configuration','telegramEvents','cancel-loading','botmanager','logged\x20out','Ok,\x20will\x20send\x20alert\x20notifications\x20only','3000','emitHistory','logs/','allow','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','\x20|\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Deleted\x20Bot\x20','send','isValid','removeAllListeners','onText','/enable\x20-\x20enable\x20notifications\x0a','/metrics\x20-\x20show\x20bot\x20performance\x0a','conn','32688IZQvvR','hybrid-crypto-js','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Login\x20accepted','temporary\x20access\x20not\x20allowed','catch','bb/','warning','2FA','headers','forEach','/download/:type','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','\x20|\x20user:\x20...','Orders','tkn','***','showConfig','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','publicKey','/help\x20-\x20show\x20available\x20commands\x0a','range','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','login\x20token\x20valid','add-bot','getTime','*$1*','Notifications\x20disabled','\x20mode','get-logs','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files',':\x20Bot\x20Mgr\x20>\x20','disconnect','running','join','params','defaults','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','bb-config.json','/:bot/coins','Restore\x20process\x20aborted','Starting\x20#RED#Balance\x20Bot\x20v','mtime','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','private','all','\x1b[33m','data','Starting\x20bot\x20|\x20Bot\x20','remove','includes','resetHistory','telegramEnabled','Markdown','sortBy','Unauthorized\x20attempt\x20to\x20get\x20portfolio','util','lowdb','\x1b[0m',',\x20must\x20be\x20a\x204\x20digit\x20number','update-bb','1512352ZTxhdn','5998TsrkyO','Unauthorized\x20attempt\x20to\x20download\x20','-----------------------------------------------------------------------------------','-config.json','split','placeOrder','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','hex','path','Unauthorized\x20attempt\x20to\x20show\x20configuration','headless',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Enabled\x20Bot\x20','#RES#\x0a','Unauthorized\x20attempt\x20to\x20update\x20bot','keys','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','354741UJzjWR','\x20>\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','No\x20bots\x20running\x20right\x20now','port',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','replace','binary','Invalid\x20authentication\x20token\x20(1)','/update\x20-\x20update\x20Balance\x20Bot\x0a','bot.js','backup','filter','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','whitelistEnabled','Notifications\x20disabled\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','#RES#\x20if\x20running\x20locally\x0a','enabled','temporary\x20access\x20rejected','secure','Your\x20installation\x20is\x20already\x20up\x20to\x20date','child_process','telegramChatId','push','userid','from','config/','live','secret','timeshift','get-backup-files','assign','ipaddr.js','parse','track','temp/','zip/','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Disabled\x20Bot\x20','orders','/restart\x20-\x20restart\x20bot(s)\x0a','access','number','Invalid\x20username\x20or\x20IP\x20address','bbUsername','createServer','address','hashSync','status','map'];_0x2060=function(){return _0x567c87;};return _0x2060();}function cleanBlacklist(){const _0x3fd1b5=_0x423760;let _0x4c9d82=dbSecure[_0x3fd1b5(0x263)](_0x3fd1b5(0x14c))[_0x3fd1b5(0x19d)]()[_0x3fd1b5(0x1b3)](),_0x536a06=new Date()[_0x3fd1b5(0x2c4)]();_0x4c9d82[_0x3fd1b5(0x2b5)](_0x597747=>{const _0x4b2742=_0x3fd1b5;_0x597747[_0x4b2742(0x1f7)]<_0x536a06&&dbSecure[_0x4b2742(0x263)]('blacklist')[_0x4b2742(0x2dc)]({'expiry':_0x597747[_0x4b2742(0x1f7)]})['write']();});}function initStates(){const _0x1d562e=_0x423760;let _0x58e752=getConfiguration();_0x58e752[_0x1d562e(0x2b5)](_0x179758=>{const _0x3f9319=_0x1d562e;_0x179758[_0x3f9319(0x135)]=_0x3f9319(0x244);}),storeConfiguration(_0x58e752);}function onKeys(){const _0x520d5b=new RSA();return new Promise(_0x246779=>{const _0x5c3fbc=_0x2929;_0x520d5b[_0x5c3fbc(0x236)]()[_0x5c3fbc(0x235)](_0x4e8400=>{_0x246779(_0x4e8400);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4286bb=_0x423760;let _0x690f9b=getSettings(),_0x46f561=![];!_0x690f9b[_0x4286bb(0x265)](_0x4286bb(0x1f1))&&(_0x690f9b[_0x4286bb(0x1f1)]=0x0,_0x46f561=!![]);!_0x690f9b[_0x4286bb(0x265)](_0x4286bb(0x283))&&(_0x690f9b[_0x4286bb(0x283)]=0x0,_0x46f561=!![]);!_0x690f9b[_0x4286bb(0x265)](_0x4286bb(0x178))&&(_0x690f9b['latestversion']=_0x4286bb(0x286),_0x46f561=!![]);!_0x690f9b[_0x4286bb(0x265)](_0x4286bb(0x1a0))&&(_0x690f9b[_0x4286bb(0x1a0)]=![],_0x46f561=!![]);if(_0x46f561)storeSettings(_0x690f9b);}function storeConfiguration(_0x16d9bc){const _0x2f00fb=_0x423760;dbConfig[_0x2f00fb(0x263)]('bots')[_0x2f00fb(0x2dc)]()[_0x2f00fb(0x237)](),_0x16d9bc[_0x2f00fb(0x2b5)](_0x32914d=>{const _0x4d951d=_0x2f00fb;delete _0x32914d[_0x4d951d(0x268)];}),dbConfig['get'](_0x2f00fb(0x179))['push'](..._0x16d9bc)[_0x2f00fb(0x237)](),config=_0x16d9bc;}function resetPassword(){const _0x5426b2=_0x423760;tgBot&&settings[_0x5426b2(0x130)]&&(tgBot['removeListener'](_0x5426b2(0x16f)),tgBot['sendMessage'](settings['telegramChatId'],_0x5426b2(0x2c1),{'parse_mode':_0x5426b2(0x20b),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x5426b2(0x23a)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1abef0=>{telegramError(_0x1abef0);}),tgBot['on'](_0x5426b2(0x16f),async _0x2bc258=>{const _0x55572b=_0x5426b2,_0xdf141d=_0x2bc258[_0x55572b(0x2da)],_0x5a865a=_0x2bc258[_0x55572b(0x1b0)];tgBot[_0x55572b(0x285)](_0x2bc258['id'])[_0x55572b(0x235)](async()=>{const _0x42d81b=_0x55572b;if(_0xdf141d!='no'){const _0x1a502c=0xf,_0x55fc52=_0x42d81b(0x2ef),_0x1a6d16=Array[_0x42d81b(0x133)](crypto[_0x42d81b(0x26b)](new Uint32Array(_0x1a502c)))[_0x42d81b(0x14b)](_0x37b3af=>_0x55fc52[_0x37b3af%_0x55fc52['length']])['join'](''),_0x5022c1=bcrypt[_0x42d81b(0x149)](_0x1a6d16,saltRounds);storeSettings({'bbPassword':_0x5022c1}),await tgBot['sendMessage'](_0x5a865a[_0x42d81b(0x1fa)]['id'],_0x42d81b(0x267)+_0x1a6d16,{'parse_mode':'HTML'})[_0x42d81b(0x2b0)](_0x53f5bd=>{telegramError(_0x53f5bd);});}else await tgBot[_0x42d81b(0x191)](_0x5a865a[_0x42d81b(0x1fa)]['id'],_0x42d81b(0x270))['catch'](_0x27d608=>{telegramError(_0x27d608);});}),tgBot[_0x55572b(0x262)](_0x55572b(0x16f));}));}async function confirmRestore(_0x1351c6,_0x2374bb){const _0x23d77a=_0x423760;io['to']('botmanager')[_0x23d77a(0x174)](_0x23d77a(0x28f),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x23d77a(0x215)),tgBot&&settings[_0x23d77a(0x130)]&&(tgBot[_0x23d77a(0x262)](_0x23d77a(0x16f)),await tgBot['sendMessage'](settings[_0x23d77a(0x130)],_0x23d77a(0x2a1),{'parse_mode':_0x23d77a(0x20b),'reply_markup':{'inline_keyboard':[[{'text':_0x23d77a(0x23a),'callback_data':_0x23d77a(0x23a)},{'text':'no','callback_data':'no'}]]}})[_0x23d77a(0x2b0)](_0x19f2f1=>{telegramError(_0x19f2f1);}),tgBot['on']('callback_query',async _0x2bb70f=>{const _0x44168a=_0x23d77a,_0x192a18=_0x2bb70f['data'],_0x449d4f=_0x2bb70f[_0x44168a(0x1b0)];tgBot[_0x44168a(0x285)](_0x2bb70f['id'])[_0x44168a(0x235)](async()=>{const _0x87581=_0x44168a;_0x192a18==_0x87581(0x23a)?(await tgBot['sendMessage'](_0x449d4f['chat']['id'],_0x87581(0x156),{'parse_mode':_0x87581(0x20b)})[_0x87581(0x2b0)](_0x13327b=>{telegramError(_0x13327b);}),unzipFile(_0x1351c6,_0x2374bb)):(logger['debug'](_0x87581(0x2d3)),await tgBot[_0x87581(0x191)](_0x449d4f[_0x87581(0x1fa)]['id'],_0x87581(0x2d3))[_0x87581(0x2b0)](_0x2f02d3=>{telegramError(_0x2f02d3);}));}),tgBot[_0x44168a(0x262)](_0x44168a(0x16f));}));}function getServerTime(){const _0x3d2d4a=_0x423760,_0x28ec26=new Date();return _0x28ec26[_0x3d2d4a(0x1be)]()+'/'+(_0x28ec26['getMonth']()+0x1)['toString']()[_0x3d2d4a(0x19e)](0x2,'0')+'/'+_0x28ec26['getDate']()[_0x3d2d4a(0x205)]()[_0x3d2d4a(0x19e)](0x2,'0')+'\x20'+_0x28ec26[_0x3d2d4a(0x22f)]()[_0x3d2d4a(0x205)]()['padStart'](0x2,'0')+':'+_0x28ec26[_0x3d2d4a(0x168)]()[_0x3d2d4a(0x205)]()['padStart'](0x2,'0')+':'+_0x28ec26[_0x3d2d4a(0x1e5)]()[_0x3d2d4a(0x205)]()[_0x3d2d4a(0x19e)](0x2,'0');}function getTimeStamp(){const _0x3041bd=_0x423760,_0x18809a=shiftedTime();return _0x18809a[_0x3041bd(0x1be)]()+'/'+(_0x18809a['getMonth']()+0x1)[_0x3041bd(0x205)]()[_0x3041bd(0x19e)](0x2,'0')+'/'+_0x18809a[_0x3041bd(0x28b)]()[_0x3041bd(0x205)]()[_0x3041bd(0x19e)](0x2,'0')+'\x20'+_0x18809a[_0x3041bd(0x22f)]()[_0x3041bd(0x205)]()['padStart'](0x2,'0')+':'+_0x18809a['getMinutes']()[_0x3041bd(0x205)]()[_0x3041bd(0x19e)](0x2,'0')+':'+_0x18809a[_0x3041bd(0x1e5)]()[_0x3041bd(0x205)]()[_0x3041bd(0x19e)](0x2,'0');}function getCleanTimeStamp(){const _0x1c303e=_0x423760,_0x1572e7=shiftedTime();return _0x1572e7[_0x1c303e(0x1be)]()+(_0x1572e7[_0x1c303e(0x231)]()+0x1)[_0x1c303e(0x205)]()[_0x1c303e(0x19e)](0x2,'0')+_0x1572e7[_0x1c303e(0x28b)]()[_0x1c303e(0x205)]()[_0x1c303e(0x19e)](0x2,'0')+'-'+_0x1572e7[_0x1c303e(0x22f)]()[_0x1c303e(0x205)]()[_0x1c303e(0x19e)](0x2,'0')+_0x1572e7['getMinutes']()[_0x1c303e(0x205)]()['padStart'](0x2,'0')+_0x1572e7[_0x1c303e(0x1e5)]()[_0x1c303e(0x205)]()[_0x1c303e(0x19e)](0x2,'0');}function shiftedTime(){const _0xc75f13=_0x423760,_0xcdb9b7=new Date();let _0x4b8250=_0xcdb9b7;if(settings[_0xc75f13(0x137)]&&settings[_0xc75f13(0x137)]!==0x0)_0x4b8250=fns['add'](_0xcdb9b7,{'hours':settings[_0xc75f13(0x137)]});return _0x4b8250;}function startScheduler(){const _0x33d89d=_0x423760,_0x3e7a2a=new Date()['getUTCHours'](),_0x4aa77e=shiftedTime()[_0x33d89d(0x22f)]();_0x4aa77e==0x4&&backupConfigFiles();_0x4aa77e==0x0&&rotateLogFiles();_0x3e7a2a%0x6==0x0&&triggerAnalytics();_0x3e7a2a%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x40d332){const _0x550816=_0x423760;logger['debug'](_0x550816(0x1c3)+_0x40d332);const _0x4481a0=getBotsWithMode();_0x4481a0[_0x550816(0x15b)]>0x0?confirmRestore(configbackuppath,_0x40d332):unzipFile(configbackuppath,_0x40d332);}async function getBackupFiles(_0x47ade6=null){const _0x14f97c=_0x423760;let _0x5685c9=[],_0x17286c=fs[_0x14f97c(0x16c)](configbackuppath,{'withFileTypes':!![]});_0x17286c['sort']((_0x5419f2,_0x54012b)=>_0x5419f2['name']<_0x54012b[_0x14f97c(0x241)]?0x1:_0x54012b['name']<_0x5419f2[_0x14f97c(0x241)]?-0x1:0x0),_0x17286c[_0x14f97c(0x2b5)](_0x513276=>{const _0x409b6d=_0x14f97c;if(!_0x513276['isDirectory']()&&_0x513276['name'][_0x409b6d(0x251)](_0x409b6d(0x266))&&_0x513276[_0x409b6d(0x241)][_0x409b6d(0x16d)]('.zip')){const _0x332d12=formatDate(fs[_0x409b6d(0x224)](configbackuppath+_0x513276['name'])[_0x409b6d(0x2d5)]);_0x5685c9[_0x409b6d(0x131)]({'name':_0x513276[_0x409b6d(0x241)],'mtime':_0x332d12});}});if(_0x47ade6)io['to'](_0x47ade6)[_0x14f97c(0x174)](_0x14f97c(0x183),_0x5685c9);else return _0x5685c9;}async function backupConfigFiles(){const _0x3794cc=_0x423760;await zipFiles('backup-full');const _0x595d4e=getCleanTimeStamp();fs[_0x3794cc(0x290)](zippath+_0x3794cc(0x1e1),configbackuppath+('backup-full@'+_0x595d4e+_0x3794cc(0x1f6)));let _0x483798=fs[_0x3794cc(0x16c)](configbackuppath,{'withFileTypes':!![]});_0x483798['sort']((_0x4c7005,_0x25054f)=>_0x4c7005[_0x3794cc(0x241)]<_0x25054f[_0x3794cc(0x241)]?0x1:_0x25054f['name']<_0x4c7005[_0x3794cc(0x241)]?-0x1:0x0),_0x483798[_0x3794cc(0x15b)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x483798[maxBackups][_0x3794cc(0x241)]);}function rotateLogFiles(){const _0x313642=_0x423760,_0x134866=fs['statSync'](logspath+_0x313642(0x238)),_0x468dd7=_0x134866['size']/0x400;if(_0x468dd7>0x64){let _0x1ceba6=fs[_0x313642(0x16c)](logspath,{'withFileTypes':!![]});_0x1ceba6[_0x313642(0x185)]((_0x2db6cd,_0x2659ff)=>_0x2db6cd[_0x313642(0x241)]<_0x2659ff[_0x313642(0x241)]?0x1:_0x2659ff[_0x313642(0x241)]<_0x2db6cd[_0x313642(0x241)]?-0x1:0x0),_0x1ceba6['forEach'](_0xca627f=>{const _0x5f239a=_0x313642;if(_0xca627f['name']==_0x5f239a(0x26a))fs[_0x5f239a(0x290)](logspath+_0xca627f[_0x5f239a(0x241)],logspath+_0x5f239a(0x233));if(_0xca627f[_0x5f239a(0x241)]==_0x5f239a(0x23b))fs['copyFileSync'](logspath+_0xca627f['name'],logspath+'output-002.log');_0xca627f[_0x5f239a(0x241)]==_0x5f239a(0x238)&&(fs['copyFileSync'](logspath+_0xca627f[_0x5f239a(0x241)],logspath+_0x5f239a(0x23b)),fs['writeFileSync'](logspath+_0xca627f[_0x5f239a(0x241)],''));});}}async function zipFiles(_0x107527){const _0x3de4eb=_0x423760;let _0x25501;if(_0x107527==_0x3de4eb(0x254))_0x25501=logspath;if(_0x107527==_0x3de4eb(0x124))_0x25501=configpath;if(_0x107527=='backup-full')_0x25501=configpath;let _0x280ec8=fs[_0x3de4eb(0x16c)](_0x25501,{'withFileTypes':!![]});const _0x40e4fc=new require(_0x3de4eb(0x15f))();_0x280ec8['forEach'](_0x553bb2=>{const _0x14297c=_0x3de4eb;if(!_0x553bb2[_0x14297c(0x1d6)]()){let _0x2fe621=fs[_0x14297c(0x1b6)](_0x25501+_0x553bb2[_0x14297c(0x241)]);if(_0x107527==_0x14297c(0x124)){const _0x526f5f=/^bot-[0-9]{3}-config.json$/,_0x49a5a5=_0x526f5f['test'](_0x553bb2['name']);if(_0x49a5a5){const _0x37aec1=JSON[_0x14297c(0x13b)](_0x2fe621);if(_0x37aec1[_0x14297c(0x1ca)][0x0]){_0x37aec1[_0x14297c(0x1ca)][0x0]['apiKey']=_0x14297c(0x2bb),_0x37aec1[_0x14297c(0x1ca)][0x0][_0x14297c(0x22b)]=_0x14297c(0x2bb);if(_0x37aec1[_0x14297c(0x1ca)][0x0][_0x14297c(0x288)])_0x37aec1[_0x14297c(0x1ca)][0x0][_0x14297c(0x288)]=_0x14297c(0x2bb);}_0x2fe621=JSON[_0x14297c(0x1de)](_0x37aec1,null,0x2);}if(_0x553bb2[_0x14297c(0x241)]==_0x14297c(0x158)){const _0xf37a27=JSON[_0x14297c(0x13b)](_0x2fe621);if(_0xf37a27[_0x14297c(0x1b4)][_0x14297c(0x228)])_0xf37a27[_0x14297c(0x1b4)][_0x14297c(0x228)]=![];if(_0xf37a27['settings'][_0x14297c(0x182)])_0xf37a27['settings'][_0x14297c(0x182)]=_0x14297c(0x2bb);if(_0xf37a27[_0x14297c(0x1b4)][_0x14297c(0x213)])_0xf37a27[_0x14297c(0x1b4)][_0x14297c(0x213)]='***';if(_0xf37a27[_0x14297c(0x1b4)]['telegramChatId'])_0xf37a27['settings'][_0x14297c(0x130)]=null;_0x2fe621=JSON[_0x14297c(0x1de)](_0xf37a27,null,0x2);}if(_0x553bb2['name']!=_0x14297c(0x1ed))_0x40e4fc[_0x14297c(0x180)](_0x553bb2[_0x14297c(0x241)],_0x2fe621);}else _0x40e4fc[_0x14297c(0x180)](_0x553bb2[_0x14297c(0x241)],_0x2fe621);}});const _0x53ddec=_0x40e4fc['generate']({'base64':![],'compression':_0x3de4eb(0x169)});fs[_0x3de4eb(0x16a)](zippath+(_0x107527+_0x3de4eb(0x1f6)),_0x53ddec,_0x3de4eb(0x120));}async function unzipFile(_0xa338df,_0x4b5215){const _0x591c7c=_0x423760;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x591c7c(0x2b5)](_0x7281cf=>{const _0xfe11a=_0x591c7c;if(!_0x7281cf[_0xfe11a(0x1d6)]())fs[_0xfe11a(0x17a)](configpath+_0x7281cf[_0xfe11a(0x241)]);});const _0x2ae7d3=fs['readFileSync'](_0xa338df+_0x4b5215,_0x591c7c(0x120)),_0x227360=new require('node-zip')(_0x2ae7d3,{'base64':![],'checkCRC32':!![]});Object[_0x591c7c(0x2f8)](_0x227360[_0x591c7c(0x277)])[_0x591c7c(0x2b5)](_0x12b575=>{const _0x15b291=_0x591c7c,_0xb740a3=_0x227360[_0x15b291(0x277)][_0x12b575];fs[_0x15b291(0x16a)](configpath+_0xb740a3[_0x15b291(0x241)],_0xb740a3[_0x15b291(0x18e)]);}),fs[_0x591c7c(0x16c)](temppath,{'withFileTypes':!![]})[_0x591c7c(0x2b5)](_0x5ef8f9=>{const _0x4a2e3b=_0x591c7c;if(!_0x5ef8f9[_0x4a2e3b(0x1d6)]())fs[_0x4a2e3b(0x17a)](temppath+_0x5ef8f9['name']);}),logger['debug'](_0x591c7c(0x14f)),process['send']({'restore':!![]},_0x2299cc=>{});}async function getPublicIp(){const _0x543616=_0x423760;try{const _0x35b3fe=await axios[_0x543616(0x263)](_0x543616(0x153));publicip=_0x35b3fe[_0x543616(0x2da)]['ip'];}catch(_0x4f9814){}}async function triggerAnalytics(){const _0x38c642=_0x423760;if(!publicip)await getPublicIp();const _0x5efeb4=getBotsWithMode();let _0x4dc37d=0x0;_0x5efeb4[_0x38c642(0x2b5)](_0x196840=>{const _0x5810d2=_0x38c642;if(_0x196840['status']===_0x5810d2(0x12b))_0x4dc37d++;});const _0xf89d02=getBotExchanges();mixpanel[_0x38c642(0x13c)](_0x38c642(0x20e),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x5efeb4[_0x38c642(0x15b)],'numbotsenabled':_0x4dc37d,'exchanges':_0xf89d02});}async function getMessages(){const _0x27c118=_0x423760,_0xc318f9=_0x27c118(0x2ac),_0x127be7=new GraphQLClient(_0xc318f9),_0x413221={'authorization':_0x27c118(0x24e)},_0x43c2f8=serverversion[_0x27c118(0x2ed)]('.'),_0x555c38=_0x43c2f8[0x0]+'.'+_0x43c2f8[0x1],_0x43a749=Math['min'](settings[_0x27c118(0x1f1)],settings[_0x27c118(0x283)]),_0x593bfd={'last':parseInt(_0x43a749),'bbm':_0x555c38},_0xc0a0de=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x22fb7d;try{_0x22fb7d=await _0x127be7[_0x27c118(0x1d5)](_0xc0a0de,_0x593bfd,_0x413221);}catch(_0x1576c1){}if(_0x22fb7d&&_0x22fb7d[_0x27c118(0x19f)]){let _0x18cc4e=settings[_0x27c118(0x1f1)];newMessages=[];for(const _0x4b3fee of _0x22fb7d[_0x27c118(0x19f)]){newMessages['push'](_0x4b3fee);if(_0x4b3fee[_0x27c118(0x1b7)])updateSetting(_0x27c118(0x178),_0x4b3fee[_0x27c118(0x1b7)]);let _0x45a988=_0x4b3fee[_0x27c118(0x1b7)]?serverversion>=_0x4b3fee['bbvNew']:![];if(!_0x45a988&&_0x4b3fee['number']>_0x18cc4e){if(_0x4b3fee[_0x27c118(0x1d7)]===_0x27c118(0x175)||serverversion['startsWith'](_0x4b3fee[_0x27c118(0x1d7)])){let _0x2d87e8=''+_0x4b3fee[_0x27c118(0x154)]+'\x0a\x0a'+_0x4b3fee['message'];const _0x2915b3=await sendTelegramMsg(toTelegramMarkdown(_0x2d87e8),_0x27c118(0x2e0));if(_0x2915b3)_0x18cc4e=_0x4b3fee[_0x27c118(0x144)];}}}updateAvailable=isNewerVersion(settings[_0x27c118(0x178)],serverversion),updateSetting(_0x27c118(0x1f1),_0x18cc4e),emitMessages();}}function emitMessages(){const _0x288dfc=_0x423760,_0x5a21fd=settings[_0x288dfc(0x283)];let _0x16adf3=[];newMessages['forEach'](_0x2a673f=>{const _0x10400d=_0x288dfc;_0x2a673f[_0x10400d(0x144)]>_0x5a21fd&&_0x16adf3[_0x10400d(0x131)](_0x2a673f);}),_0x16adf3[_0x288dfc(0x15b)]>0x0&&getAllClients()[_0x288dfc(0x2b5)](_0x2fc859=>{const _0x42b486=_0x288dfc;getSocket(_0x2fc859['id'])[_0x42b486(0x174)](_0x42b486(0x1b0),_0x16adf3);});}function confirmMessage(_0x578ce1){updateSetting('lastmsgemitted',Number(_0x578ce1));}function isNewerVersion(_0x3d11bb,_0x30ebfa){const _0xf49469=_0x423760,_0x99ce7b=_0x30ebfa[_0xf49469(0x2ed)]('.'),_0xfcf23f=_0x3d11bb['split']('.');for(var _0x384650=0x0;_0x384650<_0xfcf23f[_0xf49469(0x15b)];_0x384650++){const _0x11f3cd=~~_0xfcf23f[_0x384650],_0x25f96e=~~_0x99ce7b[_0x384650];if(_0x11f3cd>_0x25f96e)return!![];if(_0x11f3cd<_0x25f96e)return![];}return![];}function toTelegramMarkdown(_0x32cfd){const _0x1b7254=_0x423760,_0xc682c1=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x157827=/\*{2}(.+?)\*{2}/gim;return _0x32cfd=_0x32cfd[_0x1b7254(0x11f)](_0xc682c1,_0x1b7254(0x26d))[_0x1b7254(0x11f)](_0x157827,_0x1b7254(0x2c5)),_0x32cfd;}async function validateConfigFile(){const _0x79cad0=_0x423760,_0x1825e7=dbConfig[_0x79cad0(0x263)](_0x79cad0(0x179))[_0x79cad0(0x2e1)]('botID')[_0x79cad0(0x1b3)]()||[];if(_0x1825e7[_0x79cad0(0x15b)]==0x0){let _0x2ec4e2=0x0,_0x507098=[];const _0x5d56b2=/^bot-([0-9]{3})-config.json$/,_0x38829d=fs[_0x79cad0(0x16c)](configpath);_0x38829d[_0x79cad0(0x2b5)](_0x2a17cb=>{const _0x363f5e=_0x79cad0,_0xe08f94=_0x5d56b2[_0x363f5e(0x264)](_0x2a17cb);if(_0xe08f94){const _0x3f39ad=_0xe08f94[0x1];let _0x42abfb=getBotAttributes(_0x3f39ad);_0x507098[_0x363f5e(0x131)]({'botID':_0x3f39ad,'botname':_0x42abfb['botname'],'status':_0x363f5e(0x202),'live':_0x363f5e(0x244)}),_0x2ec4e2++;}}),_0x2ec4e2!=0x0&&(dbConfig[_0x79cad0(0x263)](_0x79cad0(0x179))[_0x79cad0(0x139)](_0x507098)[_0x79cad0(0x237)](),config=_0x507098,restoredConfigFile=_0x2ec4e2);}}async function restoreConfigNotify(_0xb9604f){const _0x955a3e=_0x423760;let _0xb26135;if(restoredConfigFile==0x1)_0xb26135=_0x955a3e(0x173);else _0xb26135='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xb9604f)io['to'](_0x955a3e(0x298))[_0x955a3e(0x174)](_0x955a3e(0x28f),_0xb26135);else{logger[_0x955a3e(0x199)](_0x955a3e(0x2eb)),logger[_0x955a3e(0x199)](_0xb26135),logger[_0x955a3e(0x199)](_0x955a3e(0x2eb)),logger[_0x955a3e(0x199)]('');if(tgBot&&settings[_0x955a3e(0x130)]&&settings[_0x955a3e(0x296)]!=_0x955a3e(0x141))tgBot[_0x955a3e(0x191)](settings[_0x955a3e(0x130)],_0x955a3e(0x260)+_0xb26135)[_0x955a3e(0x2b0)](_0x4bfff2=>{telegramError(_0x4bfff2);});}}function validateCredentials(_0x3523e7,_0x1a7cda){const _0x3ccf48=_0x423760;if(_0x3523e7[_0x3ccf48(0x25e)]==settings[_0x3ccf48(0x146)]&&bcrypt[_0x3ccf48(0x171)](_0x3523e7[_0x3ccf48(0x164)],settings['bbPassword'])){if(settings[_0x3ccf48(0x242)])return{'allow':![],'reason':_0x3ccf48(0x22e),'token':null};else{const _0x156329=generateLoginToken(_0x1a7cda);return{'allow':!![],'reason':_0x3ccf48(0x229),'token':_0x156329};}}else return{'allow':![],'reason':_0x3ccf48(0x1d3),'token':null};}function refreshToken(_0x5887fc){const _0x101d09=_0x423760,_0x38f110=generateLoginToken(_0x5887fc);return{'allow':!![],'reason':_0x101d09(0x229),'token':_0x38f110};}function validateAccess(_0x462a6e,_0x40e98a,_0x2ce043){const _0x8b2fe6=_0x423760,_0x59799c=_0x2ce043?_0x2ce043:devices[_0x40e98a]['ip'];let _0x59f3c5;const _0x39a864=_0x30cb1e=>{const _0x37403e=_0x2929;if(settings[_0x37403e(0x228)]){if(settings[_0x37403e(0x242)]){if(telegram2FaApproved(_0x40e98a)){const _0x1217ab=generateLoginToken(_0x40e98a);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1217ab};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x59f3c5=validToken(_0x30cb1e,_0x40e98a),_0x59f3c5[_0x37403e(0x265)](_0x37403e(0x215))?{'allow':!![],'reason':_0x37403e(0x2c2),'token':_0x30cb1e}:{'allow':![],'reason':_0x37403e(0x1c0),'token':null};}else return{'allow':!![],'reason':_0x37403e(0x256),'token':null};};if(settings[_0x8b2fe6(0x127)]){let _0x2676c4=[...settings['whitelist'],_0x8b2fe6(0x253),_0x8b2fe6(0x1c2),_0x8b2fe6(0x187)];if(_0x2676c4[_0x8b2fe6(0x2dd)](_0x59799c))return _0x39a864(_0x462a6e);else{_0x59f3c5=validToken(_0x462a6e,_0x40e98a);if(_0x59f3c5[_0x8b2fe6(0x265)](_0x8b2fe6(0x215)))return _0x39a864(_0x462a6e);else{if(telegramIpApproved(_0x40e98a)){const _0x69f250=generateToken(_0x40e98a);return _0x59f3c5=_0x39a864(_0x462a6e),_0x59f3c5['allow']?{'allow':!![],'reason':_0x8b2fe6(0x19b),'token':_0x69f250}:_0x59f3c5;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x8b2fe6(0x1e6),'token':null}:{'allow':![],'reason':_0x8b2fe6(0x2af),'token':null};}}}else return _0x39a864(_0x462a6e);}function timelyDecrypt(_0x562e73,_0x396238=!![]){const _0x56c221=_0x423760;if(_0x562e73)try{const _0x5da689=crypt[_0x56c221(0x214)](secure[_0x56c221(0x27c)],_0x562e73)['message'],_0x6b1cdd=_0x5da689[_0x56c221(0x2ed)]('@')[0x0],_0x5f4377=_0x5da689[_0x56c221(0x2ed)]('@')[0x1],_0x2f5d5e=new Date()[_0x56c221(0x2c4)]();if(_0x396238){if(_0x2f5d5e-_0x5f4377<maxSecretAge*0x3e8)return _0x6b1cdd;else return![];}else return _0x6b1cdd;}catch(_0x2d09cc){return![];}else return![];}const validToken=(_0x4a6c6d,_0x3ffe55)=>{const _0x194ddd=_0x423760,_0x2a25aa=devices[_0x3ffe55]['ip'];if(!_0x4a6c6d)return{'error':'No\x20authentication\x20token'};for(let _0x259f03 of blacklist){if(_0x259f03[_0x194ddd(0x15a)]==_0x4a6c6d)return{'error':_0x194ddd(0x248)};}let _0x23c258;try{_0x23c258=jwt[_0x194ddd(0x18c)](_0x4a6c6d,secure[_0x194ddd(0x136)]+_0x3ffe55);}catch{return{'error':_0x194ddd(0x121)};}if(!_0x23c258['hasOwnProperty'](_0x194ddd(0x16b))&&!_0x23c258[_0x194ddd(0x265)](_0x194ddd(0x25e))||!_0x23c258[_0x194ddd(0x265)](_0x194ddd(0x219)))return{'error':_0x194ddd(0x1bc)};if(!_0x23c258[_0x194ddd(0x265)](_0x194ddd(0x25e))&&_0x23c258[_0x194ddd(0x265)]('clientip')){const {clientip:_0x27d1e3}=_0x23c258;return _0x2a25aa==_0x27d1e3?{'success':_0x194ddd(0x172)}:{'error':_0x194ddd(0x232)};}else{if(_0x23c258[_0x194ddd(0x265)](_0x194ddd(0x25e))&&_0x23c258[_0x194ddd(0x265)]('clientip')){const {username:_0x42153d,clientip:_0x3c5e14}=_0x23c258;return settings[_0x194ddd(0x146)]==_0x42153d&&_0x2a25aa==_0x3c5e14?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x194ddd(0x145)};}}},generateLoginToken=_0x56f38b=>{const _0x3d8898=_0x423760;if(_0x56f38b){const _0x2ae5b8=devices[_0x56f38b]['ip'];return jwt[_0x3d8898(0x14e)]({'username':settings[_0x3d8898(0x146)],'clientip':_0x2ae5b8},secure['secret']+_0x56f38b,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2fe66b=>{const _0x2f3813=_0x423760;if(_0x2fe66b){const _0x5f12b7=devices[_0x2fe66b]['ip'];return jwt[_0x2f3813(0x14e)]({'clientip':_0x5f12b7},secure[_0x2f3813(0x136)]+_0x2fe66b,{'expiresIn':devices[_0x2fe66b]['telegramIpApproval'][_0x2f3813(0x1f7)]*0x3c});}else return![];},telegramIpApproved=_0x244e5e=>{const _0x3f07bb=_0x423760;let _0x3f8cb4=![];return devices[_0x244e5e][_0x3f07bb(0x18d)]&&devices[_0x244e5e][_0x3f07bb(0x18d)][_0x3f07bb(0x1f7)]!=_0x3f07bb(0x23f)&&(_0x3f8cb4=devices[_0x244e5e]['telegramIpApproval']['clientip']==devices[_0x244e5e]['ip']&&new Date()[_0x3f07bb(0x2c4)]()-devices[_0x244e5e][_0x3f07bb(0x18d)][_0x3f07bb(0x17c)]<devices[_0x244e5e][_0x3f07bb(0x18d)]['expiry']*0x3c*0x3e8),_0x3f8cb4;},telegram2FaApproved=_0x201a87=>{const _0x2e49f7=_0x423760;let _0x5c4e70=![];return devices[_0x201a87][_0x2e49f7(0x1fc)]&&devices[_0x201a87]['telegram2FaApproval'][_0x2e49f7(0x1f7)]!=_0x2e49f7(0x23f)&&(_0x5c4e70=devices[_0x201a87][_0x2e49f7(0x1fc)][_0x2e49f7(0x16b)]==devices[_0x201a87]['ip']&&new Date()[_0x2e49f7(0x2c4)]()-devices[_0x201a87]['telegram2FaApproval']['timestamp']<devices[_0x201a87][_0x2e49f7(0x1fc)][_0x2e49f7(0x1f7)]*0x3c*0x3e8),_0x5c4e70;},normalizeIP=_0x12a91b=>{const _0x447ddc=_0x423760;let _0xd50210=null,_0x4b31f9=null;if(ipaddr[_0x447ddc(0x2a4)](_0x12a91b)){const _0x4a4950=ipaddr[_0x447ddc(0x13b)](_0x12a91b);_0x4a4950[_0x447ddc(0x257)]()==='ipv6'?(_0x4a4950[_0x447ddc(0x211)]()&&(_0xd50210=_0x4a4950[_0x447ddc(0x23e)]()['toString']()),_0x4b31f9=_0x4a4950[_0x447ddc(0x205)]()):(_0xd50210=_0x4a4950[_0x447ddc(0x205)](),_0x4b31f9=_0x4a4950['toIPv4MappedAddress']()['toString']());}return{'show':_0xd50210?_0xd50210:_0x4b31f9,'store':_0x4b31f9};};function formatDate(_0x2dad71){const _0x53a4f3=_0x423760;return _0x2dad71[_0x53a4f3(0x1be)]()+'/'+(_0x2dad71[_0x53a4f3(0x231)]()+0x1)[_0x53a4f3(0x205)]()[_0x53a4f3(0x19e)](0x2,'0')+'/'+_0x2dad71[_0x53a4f3(0x28b)]()[_0x53a4f3(0x205)]()[_0x53a4f3(0x19e)](0x2,'0')+'\x20'+_0x2dad71[_0x53a4f3(0x22f)]()[_0x53a4f3(0x205)]()[_0x53a4f3(0x19e)](0x2,'0')+':'+_0x2dad71[_0x53a4f3(0x168)]()[_0x53a4f3(0x205)]()[_0x53a4f3(0x19e)](0x2,'0')+':'+_0x2dad71[_0x53a4f3(0x1e5)]()[_0x53a4f3(0x205)]()[_0x53a4f3(0x19e)](0x2,'0');}function sleep(_0x202992){return new Promise(_0x435a69=>setTimeout(_0x435a69,_0x202992));}