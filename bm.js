const _0x3d19d6=_0x14ad;(function(_0x48bbc1,_0x3a2d6f){const _0x2b2c02=_0x14ad,_0xd8a17d=_0x48bbc1();while(!![]){try{const _0x5ada13=parseInt(_0x2b2c02(0x170))/0x1*(parseInt(_0x2b2c02(0x1f0))/0x2)+-parseInt(_0x2b2c02(0x136))/0x3+parseInt(_0x2b2c02(0x1d7))/0x4+parseInt(_0x2b2c02(0xea))/0x5+-parseInt(_0x2b2c02(0x1c0))/0x6+parseInt(_0x2b2c02(0x12a))/0x7+parseInt(_0x2b2c02(0x200))/0x8*(-parseInt(_0x2b2c02(0x1a3))/0x9);if(_0x5ada13===_0x3a2d6f)break;else _0xd8a17d['push'](_0xd8a17d['shift']());}catch(_0x1bc7ec){_0xd8a17d['push'](_0xd8a17d['shift']());}}}(_0x30d7,0x7a319));const _0x3ec274=function(){let _0x4be8e6=!![];return function(_0x512c17,_0x37bd28){const _0x37db05=_0x4be8e6?function(){const _0x4c85ec=_0x14ad;if(_0x37bd28){const _0x53becb=_0x37bd28[_0x4c85ec(0x129)](_0x512c17,arguments);return _0x37bd28=null,_0x53becb;}}:function(){};return _0x4be8e6=![],_0x37db05;};}(),_0xb1ae5e=_0x3ec274(this,function(){const _0x3bde2a=_0x14ad;return _0xb1ae5e[_0x3bde2a(0x124)]()[_0x3bde2a(0x15a)](_0x3bde2a(0xfb))[_0x3bde2a(0x124)]()['constructor'](_0xb1ae5e)[_0x3bde2a(0x15a)](_0x3bde2a(0xfb));});_0xb1ae5e();'use strict';process[_0x3d19d6(0xd6)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3d19d6(0x15f)),fs=require('fs'),fns=require(_0x3d19d6(0x1e8)),low=require(_0x3d19d6(0x1d1)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x3d19d6(0xff)),crypto=require(_0x3d19d6(0x147)),Crypt=require('hybrid-crypto-js')[_0x3d19d6(0x12b)],RSA=require(_0x3d19d6(0x125))[_0x3d19d6(0xdb)],bcrypt=require(_0x3d19d6(0x12e)),jwt=require(_0x3d19d6(0x20a)),ipaddr=require(_0x3d19d6(0x11b)),argv=require(_0x3d19d6(0x231))(process['argv']['slice'](0x2))[_0x3d19d6(0x100)],uuidRandom=require(_0x3d19d6(0x19a)),TelegramBot=require(_0x3d19d6(0x177)),Mixpanel=require('mixpanel'),axios=require(_0x3d19d6(0xf4)),{GraphQLClient,gql}=require(_0x3d19d6(0x15c)),util=require('util'),PORT=argv[_0x3d19d6(0xf1)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x3d19d6(0x133)](PORT)&&(console[_0x3d19d6(0x1b4)](_0x3d19d6(0x244)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x3d19d6(0xd1)](0x1));const HOST=argv['host']||null,userID=argv[_0x3d19d6(0x218)]||'';let bbpath=_0x3d19d6(0x229),bbpath2='';const botfile='bot.js',configfile=_0x3d19d6(0x127),settingsfile='bb-settings.json',securefile=_0x3d19d6(0x10d);let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3d19d6(0x1db)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x3d19d6(0x1ba),configbackuppath=configpath+_0x3d19d6(0xd5),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x3d19d6(0x109)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x3d19d6(0x18e)](logspath+_0x3d19d6(0x21e),{'flags':'a'});!fs[_0x3d19d6(0x1c3)](configpath)&&fs[_0x3d19d6(0x204)](configpath);!fs[_0x3d19d6(0x1c3)](configbackuppath)&&fs[_0x3d19d6(0x204)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x3d19d6(0x204)](logspath);!fs[_0x3d19d6(0x1c3)](zippath)&&fs[_0x3d19d6(0x204)](zippath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3d19d6(0x1dc)]({'bots':[]})[_0x3d19d6(0xe3)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3d19d6(0x239)}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3d19d6(0x1dc)]({'secure':{},'blacklist':[]})[_0x3d19d6(0xe3)]();let crypt=new Crypt({'md':_0x3d19d6(0x142),'rsaStandard':_0x3d19d6(0x180)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x3d19d6(0x193),{'host':_0x3d19d6(0x153)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;function _0x14ad(_0x53a2bd,_0x200d88){const _0x19e75b=_0x30d7();return _0x14ad=function(_0xb1ae5e,_0x3ec274){_0xb1ae5e=_0xb1ae5e-0xba;let _0x30d7fc=_0x19e75b[_0xb1ae5e];return _0x30d7fc;},_0x14ad(_0x53a2bd,_0x200d88);}if(settings['telegramToken']&&settings[_0x3d19d6(0xc7)]!=''&&settings[_0x3d19d6(0xf0)]&&settings[_0x3d19d6(0xf0)]!='')initTelegram();const logger={'screen':_0x5f1a0e=>{const _0x544d0a=_0x3d19d6;console[_0x544d0a(0x1b4)](_0x5f1a0e);},'simple':_0x7e413b=>{const _0x4a9298=_0x3d19d6;console['log'](_0x7e413b),loggerfile[_0x4a9298(0xe3)](util[_0x4a9298(0x13a)](_0x7e413b)+'\x0a');},'full':async _0x560894=>{const _0x116845=_0x3d19d6,_0xb6c7d4=getTimeStamp()+_0x116845(0x143)+_0x560894;console[_0x116845(0x1b4)](_0xb6c7d4),loggerfile['write'](util[_0x116845(0x13a)](_0xb6c7d4)+'\x0a');if(tgBot&&settings[_0x116845(0x21b)]&&settings[_0x116845(0x128)]!=_0x116845(0x17f))await tgBot['sendMessage'](settings[_0x116845(0x21b)],_0x116845(0x1ef)+_0x560894)[_0x116845(0x241)](_0x5475da=>{telegramError(_0x5475da);});}};process['on'](_0x3d19d6(0x176),function(_0x41509e){logger['simple'](_0x41509e);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3d19d6(0x1af))[_0x3d19d6(0x1f8)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3d19d6(0x173)),app=express(),http=require(_0x3d19d6(0x1e9))[_0x3d19d6(0xdc)](app);app[_0x3d19d6(0x21c)]('/download/:type',async(_0x1ce00b,_0x39f705)=>{const _0x33f539=_0x3d19d6,_0x12ac3c=_0x1ce00b[_0x33f539(0x18b)][_0x33f539(0x194)],_0x3e439b=getClientsWithBotID(_0x33f539(0xda)),_0x4b46f1=_0x1ce00b[_0x33f539(0x15e)][_0x33f539(0x13d)],_0x4b0a77=timelyDecrypt(_0x4b46f1,![]),_0x4bb580=_0x3e439b[_0x33f539(0x17b)](_0x297b5c=>_0x297b5c[_0x33f539(0x13d)]==_0x4b0a77);if(_0x4bb580){const _0x19325e=normalizeIP(_0x1ce00b[_0x33f539(0xd8)][_0x33f539(0xfc)])[_0x33f539(0x121)],_0x111e1f=_0x1ce00b[_0x33f539(0x15e)]['tkn'];if(validateAccess(_0x111e1f,_0x4b0a77,_0x19325e)['allow'])await zipFiles(_0x12ac3c),_0x39f705[_0x33f539(0x1a9)](zippath+(_0x12ac3c+'.zip'),_0x1f9572=>{const _0x1afc25=_0x33f539;_0x1f9572&&(logger[_0x1afc25(0x10a)](_0x1afc25(0x1cd)+_0x12ac3c),logger['simple'](_0x1f9572));});else logger[_0x33f539(0x10a)](_0x33f539(0xdd)+_0x12ac3c+_0x33f539(0x22e));}else logger[_0x33f539(0x10a)](_0x33f539(0xdd)+_0x12ac3c+'\x20(2)');}),app[_0x3d19d6(0x139)](express[_0x3d19d6(0x106)](path[_0x3d19d6(0x201)](__dirname,bbpath2,_0x3d19d6(0x148)))),app[_0x3d19d6(0x139)](express[_0x3d19d6(0x106)](path[_0x3d19d6(0x201)](__dirname,bbpath2,_0x3d19d6(0x1aa)))),app[_0x3d19d6(0x21c)]('/',function(_0x2e3b00,_0x44ca55){const _0x481eac=_0x3d19d6;_0x44ca55[_0x481eac(0x19d)](path[_0x481eac(0x201)](__dirname,bbpath2,_0x481eac(0x148),_0x481eac(0xdf)));}),app[_0x3d19d6(0x21c)](_0x3d19d6(0x1ea),function(_0x494414,_0x1a27a1){const _0x58e68e=_0x3d19d6;_0x1a27a1['sendFile'](path[_0x58e68e(0x201)](__dirname,bbpath2,_0x58e68e(0x1aa),_0x58e68e(0xdf)));}),app[_0x3d19d6(0x21c)](_0x3d19d6(0x16f),(_0x521934,_0xbc7475)=>{const _0x1fe2a4=_0x3d19d6;_0xbc7475[_0x1fe2a4(0x19d)](path[_0x1fe2a4(0x201)](__dirname,bbpath2,_0x1fe2a4(0x1aa),'index.html'));}),app[_0x3d19d6(0x21c)](_0x3d19d6(0x233),(_0x1adc8d,_0x5dbd4c)=>{const _0x309726=_0x3d19d6;_0x5dbd4c[_0x309726(0x19d)](path['join'](__dirname,bbpath2,'build',_0x309726(0xdf)));}),app[_0x3d19d6(0x21c)](_0x3d19d6(0xe6),(_0x3fafb9,_0x1ad5d7)=>{const _0x167eba=_0x3d19d6;_0x1ad5d7[_0x167eba(0x19d)](path['join'](__dirname,bbpath2,_0x167eba(0x1aa),_0x167eba(0xdf)));}),app[_0x3d19d6(0x21c)](_0x3d19d6(0x118),(_0x249e63,_0x2d05a1)=>{const _0x1fe889=_0x3d19d6;_0x2d05a1[_0x1fe889(0x19d)](path[_0x1fe889(0x201)](__dirname,bbpath2,_0x1fe889(0x1aa),_0x1fe889(0xdf)));}),app[_0x3d19d6(0x21c)](_0x3d19d6(0x138),(_0x55b958,_0x2b1176)=>{const _0x39a363=_0x3d19d6;_0x2b1176[_0x39a363(0x19d)](path[_0x39a363(0x201)](__dirname,bbpath2,_0x39a363(0x1aa),'index.html'));}),app[_0x3d19d6(0x21c)]('/:bot/support',(_0x12a723,_0x4761a9)=>{const _0x32495e=_0x3d19d6;_0x4761a9['sendFile'](path[_0x32495e(0x201)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x3d19d6(0x236)](PORT,HOST);else http['listen'](PORT);const io=require(_0x3d19d6(0xe5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages();}async function startServer(){const _0x4fee6d=_0x3d19d6;logger['simple'](''),logger[_0x4fee6d(0xc0)](_0x4fee6d(0x10b)),await logger[_0x4fee6d(0x10a)]('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),logger[_0x4fee6d(0xc0)](_0x4fee6d(0x10b));if(config[_0x4fee6d(0xba)]!=0x0)for(const _0x1cba63 of config){if(_0x1cba63[_0x4fee6d(0x1a8)]=='enabled'||_0x1cba63['status']==_0x4fee6d(0x196))await logger[_0x4fee6d(0x10a)](_0x4fee6d(0x1fa)+_0x1cba63[_0x4fee6d(0x1c1)]+_0x4fee6d(0xd7)+_0x1cba63[_0x4fee6d(0x1c7)]),startBot([_0x1cba63[_0x4fee6d(0x1c1)],userID],{'cwd':bbpath},function(_0x2b715b){if(_0x2b715b)logger['full'](_0x2b715b);});else(_0x1cba63[_0x4fee6d(0x1a8)]=='disabled'||_0x1cba63[_0x4fee6d(0x1a8)]==_0x4fee6d(0x209))&&await logger[_0x4fee6d(0x10a)]('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x1cba63[_0x4fee6d(0x1c1)]+_0x4fee6d(0xd7)+_0x1cba63['botname']);}else!newBot&&logger[_0x4fee6d(0xc0)](_0x4fee6d(0x17c));if(newBot)addBot();logger[_0x4fee6d(0xc0)](_0x4fee6d(0x10b)),logger[_0x4fee6d(0xc0)]('');}function startSocket(){const _0x1036b6=_0x3d19d6;io['on'](_0x1036b6(0x1bc),_0x1465f3=>{const _0x5bc6d8=_0x1036b6;let _0xbcb0b6,_0x2beb4f,_0x2598b8,_0x1376ee,_0x11a913;const _0x33650b=_0x1465f3[_0x5bc6d8(0x1ab)]['headers'][_0x5bc6d8(0x13e)];_0x2beb4f=_0x33650b[_0x5bc6d8(0x126)](/bot[0-9]{3}/);if(_0x2beb4f)_0x2598b8=_0x2beb4f[0x0][_0x5bc6d8(0x126)](/[0-9]{3}/);if(_0x2598b8)_0xbcb0b6=_0x2598b8[0x0];else _0xbcb0b6='botmanager';const _0x73979=_0x1465f3[_0x5bc6d8(0x1ab)][_0x5bc6d8(0x164)][_0x5bc6d8(0x195)];if(!_0x73979)_0x1465f3[_0x5bc6d8(0x16c)](_0x5bc6d8(0x1a8),{'publicKey':secure[_0x5bc6d8(0xe8)]});else{_0x1376ee=timelyDecrypt(_0x73979,![]);if(!_0x1376ee)_0x1465f3['emit'](_0x5bc6d8(0x1a8),{'publicKey':secure['publicKey']});else{_0x11a913=normalizeIP(_0x1465f3['conn'][_0x5bc6d8(0xfc)])['store'];if(!devices[_0x1376ee])devices[_0x1376ee]={'uuid':_0x1376ee,'access':{'token':null}};devices[_0x1376ee]['ip']=_0x11a913;const _0x3103e5=addClient(_0x1465f3['id'],_0x1376ee,_0xbcb0b6);setAccess(_0x3103e5),emitMessages(),_0x1465f3['on'](_0x5bc6d8(0x1c8),_0x3ac763=>{const _0x440701=_0x5bc6d8,_0x3aec3b=timelyDecrypt(_0x3ac763[_0x440701(0x1ff)]);if(_0x3aec3b){_0x3ac763={'username':_0x3ac763[_0x440701(0x1bb)],'password':_0x3aec3b},devices[_0x1376ee][_0x440701(0x1f1)]=validateCredentials(_0x3ac763,_0x1376ee);if(devices[_0x1376ee]['access'][_0x440701(0x20f)]==![]&&devices[_0x1376ee][_0x440701(0x1f1)]['reason']==_0x440701(0x178))_0x1465f3[_0x440701(0x16c)]('status',{'access':devices[_0x1376ee][_0x440701(0x1f1)]}),loginAccess2FA(_0x1376ee,_0x11a913);else{if(devices[_0x1376ee][_0x440701(0x1f1)][_0x440701(0x20f)]==![]&&devices[_0x1376ee][_0x440701(0x1f1)][_0x440701(0x189)]==_0x440701(0x1b0))_0x1465f3[_0x440701(0x16c)](_0x440701(0x1a8),{'access':devices[_0x1376ee]['access']});else devices[_0x1376ee]['access'][_0x440701(0x20f)]&&devices[_0x1376ee]['access'][_0x440701(0x189)]==_0x440701(0xf9)&&(getClientsWithUuid(_0x1376ee)[_0x440701(0x228)](_0x4fd77b=>{setAccess(_0x4fd77b);}),setTokenRefresh(_0x1376ee),setSessionTimeout(_0x440701(0x1c8),_0x1376ee));}}else logger[_0x440701(0x10a)](_0x440701(0x16a));}),_0x1465f3['on'](_0x5bc6d8(0x144),()=>{resetPassword();}),_0x1465f3['on'](_0x5bc6d8(0xbf),_0x214763=>{removeClient(_0x1465f3['id']);}),_0xbcb0b6==_0x5bc6d8(0xda)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x19dd46){const _0x5c95a5=_0x3d19d6;if(_0x19dd46!=_0x5c95a5(0xda)&&config[_0x5c95a5(0x1b7)]!=''){if(pid[_0x19dd46])pid[_0x19dd46][_0x5c95a5(0xc6)]({'function':_0x5c95a5(0x1d0),'args':null});}}function getSocket(_0x4c0780){const _0xe20f3=_0x3d19d6;return io[_0xe20f3(0x1ee)]['sockets']['get'](_0x4c0780);}function setAccess(_0x5ceec7){const _0x309742=_0x3d19d6,_0x1ddaab=getSocket(_0x5ceec7['id']),_0x48a5a9=_0x5ceec7[_0x309742(0x13d)],_0x308f41=_0x5ceec7[_0x309742(0x14c)];devices[_0x48a5a9]['access']=validateAccess(devices[_0x48a5a9][_0x309742(0x1f1)][_0x309742(0x18d)],_0x48a5a9),_0x1ddaab[_0x309742(0x201)](_0x48a5a9);if(devices[_0x48a5a9][_0x309742(0x1f1)]['allow']){_0x1ddaab['join'](_0x308f41);if(_0x308f41=='botmanager')initializeSocketBotManager(_0x1ddaab);else initializeSocketBot(_0x1ddaab);initClient(_0x308f41);}devices[_0x48a5a9]['access']['token']&&devices[_0x48a5a9][_0x309742(0x1f1)][_0x309742(0x189)]==_0x309742(0x1a1)&&setSessionTimeout(_0x309742(0x225),_0x48a5a9),devices[_0x48a5a9][_0x309742(0x1f1)][_0x309742(0x18d)]&&devices[_0x48a5a9][_0x309742(0x1f1)][_0x309742(0x189)]==_0x309742(0x13c)&&setSessionTimeout(_0x309742(0x1c8),_0x48a5a9),_0x1ddaab[_0x309742(0x16c)](_0x309742(0x1a8),{'status':_0x5ceec7['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x48a5a9]['access'],'externalip':devices[_0x48a5a9]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x48a5a9]['access'][_0x309742(0x20f)]==![]&&devices[_0x48a5a9]['access'][_0x309742(0x189)]=='2FA\x20required'&&temporaryAccess2FA(_0x48a5a9,devices[_0x48a5a9]['ip']);}function setSessionTimeout(_0x13a67f,_0x386036){const _0x3a7a72=_0x3d19d6;let _0x31b0cd;if(_0x13a67f=='login')_0x31b0cd=loginExpiry*0x3c*0x3e8;else _0x31b0cd=devices[_0x386036]['telegramIpApproval'][_0x3a7a72(0x242)]*0x3c*0x3e8-(new Date()[_0x3a7a72(0x203)]()-devices[_0x386036][_0x3a7a72(0x1de)][_0x3a7a72(0x140)]);if(devices[_0x386036][_0x3a7a72(0x1d8)])clearTimeout(devices[_0x386036][_0x3a7a72(0x1d8)]);devices[_0x386036][_0x3a7a72(0x1d8)]=setTimeout(()=>{const _0x281399=_0x3a7a72;if(devices[_0x386036][_0x281399(0x18f)])clearTimeout(devices[_0x386036][_0x281399(0x18f)]);removeSocketListeners(_0x386036),addBlacklist(_0x386036),devices[_0x386036][_0x281399(0x1de)]=null,devices[_0x386036][_0x281399(0x169)]=null,devices[_0x386036][_0x281399(0x1f1)]['token']=null,devices[_0x386036]['access']=validateAccess(devices[_0x386036]['access'][_0x281399(0x18d)],_0x386036),!(devices[_0x386036][_0x281399(0x1f1)]['allow']&&devices[_0x386036][_0x281399(0x1f1)][_0x281399(0x189)]==_0x281399(0x1f9))&&(_0x13a67f=='login'?io['to'](_0x386036)[_0x281399(0x16c)]('status',{'access':{'allow':![],'reason':_0x281399(0x21d),'token':null}}):io['to'](_0x386036)[_0x281399(0x16c)](_0x281399(0x1a8),{'access':{'allow':![],'reason':_0x281399(0x13f),'token':null}})),devices[_0x386036][_0x281399(0x1f1)]['token']=null;},_0x31b0cd);}function setTokenRefresh(_0x86ebb2){const _0xd1cbfd=_0x3d19d6;if(devices[_0x86ebb2]['pidRefreshToken'])clearTimeout(devices[_0x86ebb2]['pidRefreshToken']);devices[_0x86ebb2][_0xd1cbfd(0x18f)]=setTimeout(()=>{const _0x121672=_0xd1cbfd;getClientsWithUuid(_0x86ebb2)['length']!=0x0?(devices[_0x86ebb2][_0x121672(0x1f1)]=refreshToken(_0x86ebb2),io['to'](_0x86ebb2)['emit'](_0x121672(0x1a8),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x86ebb2][_0x121672(0x1f1)],'externalip':devices[_0x86ebb2]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x86ebb2)):clearTimeout(devices[_0x86ebb2][_0x121672(0x18f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5273c7){const _0x53e761=_0x3d19d6,_0x3d2616=getClient(_0x5273c7['id'])['uuid'];_0x5273c7[_0x53e761(0x16c)](_0x53e761(0x197),config),_0x5273c7['emit'](_0x53e761(0x238),cleanSettings()),_0x5273c7['on'](_0x53e761(0x1e2),_0x126527=>{const _0x24e30b=_0x53e761;if(validateAccess(_0x126527,_0x3d2616)[_0x24e30b(0x20f)])addBot();else logger[_0x24e30b(0x10a)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x5273c7['on']('update-bot',(_0x32298e,_0x52c31b)=>{const _0x26d0a4=_0x53e761;if(validateAccess(_0x52c31b,_0x3d2616)['allow'])toggleBot(_0x32298e['botID'],_0x32298e[_0x26d0a4(0x1a8)],_0x32298e[_0x26d0a4(0x19b)]);else logger[_0x26d0a4(0x10a)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x5273c7['on'](_0x53e761(0x174),(_0x1ea329,_0x428b26)=>{const _0x2d0ea9=_0x53e761;if(validateAccess(_0x428b26,_0x3d2616)['allow'])toggleBotMode(_0x1ea329);else logger[_0x2d0ea9(0x10a)](_0x2d0ea9(0x227));}),_0x5273c7['on'](_0x53e761(0x22d),(_0x2210df,_0x2d30ab)=>{const _0x5a95ab=_0x53e761;if(validateAccess(_0x2d30ab,_0x3d2616)[_0x5a95ab(0x20f)])deleteBot(_0x2210df);else logger['full'](_0x5a95ab(0xcd));}),_0x5273c7['on'](_0x53e761(0x12f),(_0x3262de,_0xd2ea27)=>{const _0x360672=_0x53e761;if(validateAccess(_0xd2ea27,_0x3d2616)[_0x360672(0x20f)])storeSettings(_0x3262de,!![]);else logger[_0x360672(0x10a)](_0x360672(0x208));}),_0x5273c7['on'](_0x53e761(0x163),_0x3f2f72=>{const _0x4f7441=_0x53e761;if(validateAccess(_0x3f2f72,_0x3d2616)[_0x4f7441(0x20f)])updateBB();else logger['full'](_0x4f7441(0x17d));}),_0x5273c7['on']('get-messages',_0x2d3732=>{const _0x233f5a=_0x53e761;if(validateAccess(_0x2d3732,_0x3d2616)[_0x233f5a(0x20f)])getMessages();else logger[_0x233f5a(0x10a)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5273c7['on'](_0x53e761(0x171),(_0x3e5a08,_0x23a43a)=>{const _0x38fd16=_0x53e761;if(validateAccess(_0x23a43a,_0x3d2616)['allow'])confirmMessage(_0x3e5a08);else logger[_0x38fd16(0x10a)](_0x38fd16(0xe2));}),_0x5273c7['on'](_0x53e761(0x16d),_0x46153f=>{const _0x4b40b5=_0x53e761;if(validateAccess(_0x46153f,_0x3d2616)[_0x4b40b5(0x20f)]){if(devices[_0x3d2616][_0x4b40b5(0x18f)])clearTimeout(devices[_0x3d2616][_0x4b40b5(0x18f)]);if(devices[_0x3d2616]['pidExpireLogin'])clearTimeout(devices[_0x3d2616]['pidExpireLogin']);removeSocketListeners(getClient(_0x5273c7['id'])['uuid']),addBlacklist(_0x3d2616),devices[_0x3d2616][_0x4b40b5(0x1de)]=null,devices[_0x3d2616][_0x4b40b5(0x169)]=null,devices[_0x3d2616][_0x4b40b5(0x1f1)]['token']=null,io['to'](getClient(_0x5273c7['id'])['uuid'])[_0x4b40b5(0x16c)]('status',{'access':{'allow':![],'reason':_0x4b40b5(0x1c9),'token':null}});}else logger[_0x4b40b5(0x10a)](_0x4b40b5(0x234));});}function initializeSocketBot(_0x2b6e7f){const _0x1c38c9=_0x3d19d6,_0x26ec36=getClient(_0x2b6e7f['id'])[_0x1c38c9(0x14c)],_0x29e1ae=getClient(_0x2b6e7f['id'])['uuid'];_0x2b6e7f['on'](_0x1c38c9(0x1ce),(_0x16779f,_0x363f26)=>{const _0x25519c=_0x1c38c9;if(validateAccess(_0x363f26,_0x29e1ae)[_0x25519c(0x20f)]){if(pid[_0x26ec36])pid[_0x26ec36]['send']({'function':_0x25519c(0x151),'args':_0x16779f});}else logger[_0x25519c(0x10a)](_0x25519c(0x17a));}),_0x2b6e7f['on'](_0x1c38c9(0xd0),(_0x236966,_0x1aef12)=>{const _0x122f3d=_0x1c38c9;if(validateAccess(_0x1aef12,_0x29e1ae)['allow']){if(pid[_0x26ec36])pid[_0x26ec36]['send']({'function':'deleteHistoryAlerts','args':_0x236966});}else logger[_0x122f3d(0x10a)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2b6e7f['on'](_0x1c38c9(0xf8),(_0x1a7745,_0x3fbb28)=>{const _0x457e73=_0x1c38c9;if(validateAccess(_0x3fbb28,_0x29e1ae)[_0x457e73(0x20f)]){if(pid[_0x26ec36])pid[_0x26ec36]['send']({'function':_0x457e73(0x20b),'args':_0x1a7745});}else logger[_0x457e73(0x10a)](_0x457e73(0x1e5));}),_0x2b6e7f['on'](_0x1c38c9(0x1ed),(_0x260be3,_0x144565)=>{const _0x48c113=_0x1c38c9;if(validateAccess(_0x144565,_0x29e1ae)[_0x48c113(0x20f)]){if(pid[_0x26ec36])pid[_0x26ec36][_0x48c113(0xc6)]({'function':_0x48c113(0x230),'args':_0x260be3});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2b6e7f['on']('store-headless',(_0x2f73ba,_0x4a2e0b)=>{const _0x38f558=_0x1c38c9;if(validateAccess(_0x4a2e0b,_0x29e1ae)[_0x38f558(0x20f)]){if(pid[_0x26ec36])pid[_0x26ec36][_0x38f558(0xc6)]({'function':_0x38f558(0x1eb),'args':_0x2f73ba});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x2b6e7f['on'](_0x1c38c9(0x217),_0x191e47=>{const _0x2591a8=_0x1c38c9;if(validateAccess(_0x191e47,_0x29e1ae)[_0x2591a8(0x20f)]){if(pid[_0x26ec36])pid[_0x26ec36][_0x2591a8(0xc6)]({'function':_0x2591a8(0x1d4),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2b6e7f['on']('place-order',(_0x1a5a93,_0x42053d)=>{const _0x265a33=_0x1c38c9;if(validateAccess(_0x42053d,_0x29e1ae)[_0x265a33(0x20f)]){if(pid[_0x26ec36])pid[_0x26ec36][_0x265a33(0xc6)]({'function':_0x265a33(0x19c),'args':_0x1a5a93});}else logger['full'](_0x265a33(0x199));}),_0x2b6e7f['on'](_0x1c38c9(0x150),_0x4b18b1=>{const _0x1050dc=_0x1c38c9;if(validateAccess(_0x4b18b1,_0x29e1ae)['allow']){if(pid[_0x26ec36])pid[_0x26ec36][_0x1050dc(0xc6)]({'function':_0x1050dc(0x223),'args':null});}else logger[_0x1050dc(0x10a)](_0x1050dc(0xd3));}),_0x2b6e7f['on'](_0x1c38c9(0x163),_0x3f99c1=>{const _0x5058e4=_0x1c38c9;if(validateAccess(_0x3f99c1,_0x29e1ae)[_0x5058e4(0x20f)])updateBB();else logger[_0x5058e4(0x10a)](_0x5058e4(0x17d));}),_0x2b6e7f['on'](_0x1c38c9(0x1df),_0x1a47fd=>{const _0x247184=_0x1c38c9;if(validateAccess(_0x1a47fd,_0x29e1ae)[_0x247184(0x20f)])getMessages();else logger['full'](_0x247184(0x1f6));}),_0x2b6e7f['on'](_0x1c38c9(0x171),(_0x3ed99b,_0x563e8c)=>{const _0x267c85=_0x1c38c9;if(validateAccess(_0x563e8c,_0x29e1ae)[_0x267c85(0x20f)])confirmMessage(_0x3ed99b);else logger['full'](_0x267c85(0xe2));}),_0x2b6e7f['on'](_0x1c38c9(0x16d),_0x3dd5ad=>{const _0x4899c3=_0x1c38c9;if(validateAccess(_0x3dd5ad,_0x29e1ae)[_0x4899c3(0x20f)]){if(devices[_0x29e1ae][_0x4899c3(0x18f)])clearTimeout(devices[_0x29e1ae][_0x4899c3(0x18f)]);if(devices[_0x29e1ae]['pidExpireLogin'])clearTimeout(devices[_0x29e1ae][_0x4899c3(0x1d8)]);removeSocketListeners(getClient(_0x2b6e7f['id'])[_0x4899c3(0x13d)]),addBlacklist(_0x29e1ae),devices[_0x29e1ae][_0x4899c3(0x1de)]=null,devices[_0x29e1ae]['telegram2FaApproval']=null,devices[_0x29e1ae]['access']['token']=null,io['to'](getClient(_0x2b6e7f['id'])[_0x4899c3(0x13d)])[_0x4899c3(0x16c)](_0x4899c3(0x1a8),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x4899c3(0x234));});}function removeSocketListeners(_0x879dbf){getClientsWithUuid(_0x879dbf)['forEach'](_0x504ae9=>{const _0x78eafd=_0x14ad;getSocket(_0x504ae9['id'])[_0x78eafd(0x1ec)]();});}function cleanSettings(){const _0x6dd210=_0x3d19d6;let _0x7e73c8=settings;return settings[_0x6dd210(0xc7)]&&settings['telegramToken']!=''&&(_0x7e73c8={..._0x7e73c8,'telegramToken':_0x6dd210(0x16b)}),settings[_0x6dd210(0x1fe)]&&settings[_0x6dd210(0x1fe)]!=''&&(_0x7e73c8={..._0x7e73c8,'bbPassword':'************'}),_0x7e73c8;}function updateBB(){installingUpdate=!![],config['forEach'](_0x1eee25=>{const _0x479275=_0x14ad;restartBot(_0x1eee25[_0x479275(0x1c1)]);}),process['send']({'update':!![]},_0x20cc57=>{});}function startBot(_0xcb608,_0x117255,_0x3ca95c){const _0x5992b6=_0x3d19d6;let _0x559421=![];const _0x495825=_0xcb608[0x0];_0x117255={..._0x117255,'stdio':[_0x5992b6(0x10e),'inherit','inherit','ipc']},pid[_0x495825]=childProcess[_0x5992b6(0x1f4)](botfile,_0xcb608,_0x117255),pid[_0x495825]['on'](_0x5992b6(0x175),_0x48652e=>{const _0xa21ca7=_0x5992b6;switch(Object[_0xa21ca7(0xbc)](_0x48652e)[0x0]){case _0xa21ca7(0x1c7):updateBotName(_0x495825,_0x48652e['botname']);break;case'updatebotmanager':updateBotManager();break;case _0xa21ca7(0x1a8):updateStatus(_0x495825,_0x48652e[_0xa21ca7(0x1a8)]);break;case _0xa21ca7(0x19b):updateLive(_0x495825,_0x48652e['live']);break;case'started':updateLive(_0x495825,_0x48652e[_0xa21ca7(0x1c5)]),io['to'](_0x495825)[_0xa21ca7(0x16c)](_0xa21ca7(0x1a8),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0xa21ca7(0x107):_0x48652e[_0xa21ca7(0x107)]=='restart'&&restartBot(_0x495825);_0x48652e['stop']==_0xa21ca7(0x11a)&&toggleBot(_0x495825,_0xa21ca7(0x235),_0xa21ca7(0xf6));break;case'telegram':sendTelegram(_0x495825,_0x48652e[_0xa21ca7(0x167)]);break;case _0xa21ca7(0x115):sendTelegramMsg(_0x48652e['telegrammsg']);break;case _0xa21ca7(0x155):io['to'](_0x495825)[_0xa21ca7(0x16c)](_0x48652e[_0xa21ca7(0x155)],_0x48652e[_0xa21ca7(0xe7)]);break;}}),pid[_0x495825]['on']('error',function(_0xe0329f){if(_0x559421)return;_0x559421=!![],_0x3ca95c(_0xe0329f);}),pid[_0x495825]['on'](_0x5992b6(0xd1),async function(_0x176a41){const _0x43dec9=_0x5992b6;if(installingUpdate)return;if(_0x559421)return;_0x559421=!![],_0x3ca95c(null);const _0x3015b8=dbConfig[_0x43dec9(0x21c)](_0x43dec9(0x197))[_0x43dec9(0x17b)]({'botID':_0x495825})[_0x43dec9(0xfd)]();_0x3015b8&&(_0x3015b8[_0x43dec9(0x1a8)]==_0x43dec9(0x185)||_0x3015b8['status']=='new')&&(await sleep(0x3e8),updateLive(_0x495825,_0x43dec9(0xf6)),logger['full'](_0x43dec9(0x172)+_0x495825),startBot([_0x495825,userID],{'cwd':bbpath},function(_0x17ecbf){if(_0x17ecbf)logger['full'](_0x17ecbf);}));});}function stopBot(_0x2e7660){getClientsWithBotID(_0x2e7660)['forEach'](_0x8cfb73=>{const _0x10ecc2=_0x14ad;getSocket(_0x8cfb73['id'])[_0x10ecc2(0xbf)](!![]),removeClient(_0x8cfb73['id']);}),pid[_0x2e7660]&&(pid[_0x2e7660]['kill'](),pid[_0x2e7660]=null);}function restartBot(_0x2020a9){const _0x1f54ad=_0x3d19d6;if(pid[_0x2020a9])pid[_0x2020a9][_0x1f54ad(0x11a)]();}function addBot(){const _0x20b65d=_0x3d19d6;let _0x17c5a3;for(let _0x43a90b=0x1;_0x43a90b<0x3e9;_0x43a90b++){_0x17c5a3=_0x43a90b[_0x20b65d(0x124)]()[_0x20b65d(0xe9)](0x3,'0');let _0x130350=config[_0x20b65d(0x17b)](_0x2f97c4=>_0x2f97c4[_0x20b65d(0x1c1)]==_0x17c5a3);if(!_0x130350)break;}if(_0x17c5a3===_0x20b65d(0x15b)){logger[_0x20b65d(0x10a)](_0x20b65d(0x222));return;}logger[_0x20b65d(0x10a)]('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x17c5a3),dbConfig[_0x20b65d(0x21c)](_0x20b65d(0x197))[_0x20b65d(0x11c)]({'botID':_0x17c5a3,'botname':'Bot\x20'+_0x17c5a3,'status':_0x20b65d(0x196),'live':''})[_0x20b65d(0xe3)](),startBot([_0x17c5a3,userID],{'cwd':bbpath},function(_0x330632){const _0x26829c=_0x20b65d;if(_0x330632)logger[_0x26829c(0x10a)](_0x330632);}),config=getConfiguration(),io['to']('botmanager')[_0x20b65d(0x16c)](_0x20b65d(0x197),config);}function deleteBot(_0x3fec83){const _0x1bae98=_0x3d19d6;getClientsWithBotID(_0x3fec83)[_0x1bae98(0x228)](_0x1732f6=>{const _0x5531b9=_0x1bae98;getSocket(_0x1732f6['id'])[_0x5531b9(0xbf)](!![]),removeClient(_0x1732f6['id']);}),dbConfig['get'](_0x1bae98(0x197))['remove']({'botID':_0x3fec83})[_0x1bae98(0xe3)](),logger[_0x1bae98(0x10a)]('deleted\x20Bot\x20'+_0x3fec83),stopBot(_0x3fec83);try{fs[_0x1bae98(0x182)](path[_0x1bae98(0x201)](configpath,_0x1bae98(0x1b1)+_0x3fec83+_0x1bae98(0x237))),fs['unlinkSync'](path[_0x1bae98(0x201)](configpath,_0x1bae98(0x1b1)+_0x3fec83+_0x1bae98(0x1d9))),fs[_0x1bae98(0x182)](path['join'](configpath,_0x1bae98(0x1b1)+_0x3fec83+_0x1bae98(0x1b6))),fs[_0x1bae98(0x182)](path['join'](configpath,'bot-'+_0x3fec83+'-results.json'));}catch(_0x3d17b1){if(_0x3d17b1)logger[_0x1bae98(0x10a)](_0x1bae98(0xec),_0x3d17b1);}config=getConfiguration(),io['to'](_0x1bae98(0xda))['emit'](_0x1bae98(0x197),config);}function toggleBot(_0x189446,_0x3dbf45,_0x2b0aa5){const _0x5f16f5=_0x3d19d6;dbConfig[_0x5f16f5(0x21c)](_0x5f16f5(0x197))[_0x5f16f5(0x17b)]({'botID':_0x189446})['assign']({'status':_0x3dbf45})[_0x5f16f5(0x116)]({'live':_0x2b0aa5})['write']();if(_0x3dbf45==_0x5f16f5(0x185)||_0x3dbf45=='new')logger[_0x5f16f5(0x10a)]('enabled\x20Bot\x20'+_0x189446),startBot([_0x189446,userID],{'cwd':bbpath},function(_0x1f505d){const _0xced698=_0x5f16f5;if(_0x1f505d)logger[_0xced698(0x10a)](_0x1f505d);});else(_0x3dbf45==_0x5f16f5(0x235)||_0x3dbf45==_0x5f16f5(0x209))&&(logger[_0x5f16f5(0x10a)]('disabled\x20Bot\x20'+_0x189446),stopBot(_0x189446));config=getConfiguration(),io['to'](_0x5f16f5(0xda))[_0x5f16f5(0x16c)](_0x5f16f5(0x197),config);}function toggleStatus(_0x5e502d){const _0x5a1aa4=_0x3d19d6;let _0x11a73f=dbConfig['get'](_0x5a1aa4(0x197))[_0x5a1aa4(0x17b)]({'botID':_0x5e502d})[_0x5a1aa4(0xfd)](),_0x5c6273;if(_0x11a73f[_0x5a1aa4(0x1a8)]==='enabled')_0x5c6273=_0x5a1aa4(0x235);else{if(_0x11a73f['status']===_0x5a1aa4(0x196))_0x5c6273='new-disabled';else{if(_0x11a73f['status']==='new-disabled')_0x5c6273=_0x5a1aa4(0x196);else{if(_0x11a73f['status']==='disabled')_0x5c6273=_0x5a1aa4(0x185);}}}return _0x5c6273;}function updateStatus(_0x2588fe,_0x2354f8){const _0x2eeeb4=_0x3d19d6;dbConfig[_0x2eeeb4(0x21c)](_0x2eeeb4(0x197))[_0x2eeeb4(0x17b)]({'botID':_0x2588fe})[_0x2eeeb4(0x116)]({'status':_0x2354f8})[_0x2eeeb4(0xe3)](),config=getConfiguration(),io['to']('botmanager')[_0x2eeeb4(0x16c)](_0x2eeeb4(0x197),config);}function updateLive(_0x3f7a90,_0x5370ef){const _0x1c5622=_0x3d19d6;dbConfig['get']('bots')[_0x1c5622(0x17b)]({'botID':_0x3f7a90})['assign']({'live':_0x5370ef})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x1c5622(0x16c)]('bots',config);}function updateBotName(_0x479939,_0x534da9){const _0xa54ee3=_0x3d19d6;dbConfig[_0xa54ee3(0x21c)](_0xa54ee3(0x197))[_0xa54ee3(0x17b)]({'botID':_0x479939})[_0xa54ee3(0x116)]({'botname':_0x534da9})['write'](),config=getConfiguration(),io['to'](_0xa54ee3(0xda))[_0xa54ee3(0x16c)]('bots',config);}function updateBotManager(){const _0x1aefe2=_0x3d19d6;config=getConfiguration(),io['to']('botmanager')[_0x1aefe2(0x16c)](_0x1aefe2(0x197),config);}function toggleBotMode(_0x51e6a1){const _0x5465e6=_0x3d19d6;if(pid[_0x51e6a1])pid[_0x51e6a1][_0x5465e6(0xc6)]({'function':_0x5465e6(0x198),'args':null});else{const _0x53776f=configpath+_0x5465e6(0x1b1)+_0x51e6a1+_0x5465e6(0x237),_0x2e187e=fs[_0x5465e6(0x224)](_0x53776f),_0x1f7470=JSON['parse'](_0x2e187e),_0x369d68=_0x1f7470['bot'][0x0]['headless'];_0x1f7470[_0x5465e6(0x14c)][0x0]['headless']=!_0x369d68;const _0x4f2fe1=JSON['stringify'](_0x1f7470,null,0x2);fs[_0x5465e6(0x1a4)](_0x53776f,_0x4f2fe1),config=getConfiguration(),io['to'](_0x5465e6(0xda))[_0x5465e6(0x16c)]('bots',config);}}function telegramError(_0x54bd45){const _0x5863f4=_0x3d19d6;logger[_0x5863f4(0xc0)](getTimeStamp()+_0x5863f4(0xfa));}function validateTelegram(_0x1aae6b){const _0x568421=_0x3d19d6;if(_0x1aae6b[_0x568421(0x14b)][_0x568421(0x1bb)]!=settings['telegramUsername']&&'@'+_0x1aae6b[_0x568421(0x14b)]['username']!=settings[_0x568421(0xf0)])return tgBot['sendMessage'](_0x1aae6b[_0x568421(0x12c)]['id'],_0x568421(0x11f),{'parse_mode':_0x568421(0x1fd)})['catch'](_0xe6b6e0=>{telegramError(_0xe6b6e0);}),![];return!![];}async function initTelegram(){const _0x51206b=_0x3d19d6;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3d3c40=_0x51206b(0x1f3);_0x3d3c40+='\x0a',_0x3d3c40+=_0x51206b(0x1ac),_0x3d3c40+=_0x51206b(0x102),_0x3d3c40+=_0x51206b(0xd4),_0x3d3c40+=_0x51206b(0x23c),_0x3d3c40+=_0x51206b(0x1a0),_0x3d3c40+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3d3c40+=_0x51206b(0x188),_0x3d3c40+=_0x51206b(0x158),_0x3d3c40+=_0x51206b(0x101),_0x3d3c40+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3d3c40+=_0x51206b(0x1fb),_0x3d3c40+=_0x51206b(0xcf);let _0x1d70ca=_0x51206b(0x14e);_0x1d70ca+='\x0a',_0x1d70ca+=_0x3d3c40,tgBot['onText'](/\/start/,_0x1ce1f4=>{const _0x5a5d6e=_0x51206b;if(!validateTelegram(_0x1ce1f4))return;if(settings[_0x5a5d6e(0x21b)]!=_0x1ce1f4[_0x5a5d6e(0x12c)]['id'])updateSetting(_0x5a5d6e(0x21b),_0x1ce1f4[_0x5a5d6e(0x12c)]['id']);updateSetting(_0x5a5d6e(0x111),!![]),tgBot[_0x5a5d6e(0x213)](_0x1ce1f4['chat']['id'],_0x1d70ca)[_0x5a5d6e(0x241)](_0x6f3680=>{telegramError(_0x6f3680);});}),tgBot['onText'](/\/enable/,_0x4ca713=>{const _0x37c327=_0x51206b;if(!validateTelegram(_0x4ca713))return;if(settings[_0x37c327(0x21b)]!=_0x4ca713['chat']['id'])updateSetting(_0x37c327(0x21b),_0x4ca713[_0x37c327(0x12c)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x4ca713['chat']['id'],_0x37c327(0x214))[_0x37c327(0x241)](_0x4ceb36=>{telegramError(_0x4ceb36);});}),tgBot['onText'](/\/config/,async _0x5d5270=>{const _0x9f5809=_0x51206b;if(!validateTelegram(_0x5d5270))return;tgBot[_0x9f5809(0x1fc)]('callback_query'),tgBot['sendMessage'](_0x5d5270[_0x9f5809(0x12c)]['id'],_0x9f5809(0x14a),{'reply_markup':{'inline_keyboard':[[{'text':_0x9f5809(0x22c),'callback_data':'orders'},{'text':_0x9f5809(0x181),'callback_data':_0x9f5809(0x146)},{'text':_0x9f5809(0x135),'callback_data':_0x9f5809(0x1ca)}]]}})[_0x9f5809(0x241)](_0x1af561=>{telegramError(_0x1af561);}),tgBot['on'](_0x9f5809(0x232),async _0x3c6d64=>{const _0x1cc6d0=_0x9f5809,_0x2d5f6c=_0x3c6d64[_0x1cc6d0(0x108)],_0x4d1139=_0x3c6d64[_0x1cc6d0(0x175)];tgBot[_0x1cc6d0(0xf3)](_0x3c6d64['id'])[_0x1cc6d0(0x1a7)](async()=>{const _0xecbd09=_0x1cc6d0;_0x2d5f6c=='orders'&&(updateSetting(_0xecbd09(0x128),'orders'),updateSetting(_0xecbd09(0x111),!![]),await tgBot[_0xecbd09(0x213)](_0x4d1139[_0xecbd09(0x12c)]['id'],_0xecbd09(0x137))[_0xecbd09(0x241)](_0x23e8a7=>{telegramError(_0x23e8a7);}));_0x2d5f6c==_0xecbd09(0x146)&&(updateSetting(_0xecbd09(0x128),_0xecbd09(0x146)),updateSetting(_0xecbd09(0x111),!![]),await tgBot[_0xecbd09(0x213)](_0x4d1139['chat']['id'],_0xecbd09(0x156))[_0xecbd09(0x241)](_0x458f9c=>{telegramError(_0x458f9c);}));_0x2d5f6c=='all'&&(updateSetting(_0xecbd09(0x128),_0xecbd09(0x1ca)),updateSetting(_0xecbd09(0x111),!![]),await tgBot[_0xecbd09(0x213)](_0x4d1139[_0xecbd09(0x12c)]['id'],_0xecbd09(0x23f))[_0xecbd09(0x241)](_0x2048bd=>{telegramError(_0x2048bd);}));if(!settings[_0xecbd09(0x21b)])tgBot[_0xecbd09(0x213)](_0x4d1139[_0xecbd09(0x12c)]['id'],_0xecbd09(0x16e))['catch'](_0x2be565=>{telegramError(_0x2be565);});}),tgBot[_0x1cc6d0(0x1fc)](_0x1cc6d0(0x232));});}),tgBot[_0x51206b(0x212)](/\/status/,_0x2720bc=>{const _0x16338c=_0x51206b;if(!validateTelegram(_0x2720bc))return;const _0x44bd29=getBotsWithMode();let _0x3b29e7=_0x16338c(0x1ae);config[_0x16338c(0x228)](_0x3901cc=>{const _0x278ae1=_0x16338c,_0x484691=_0x44bd29[_0x278ae1(0x17b)](_0x4a263a=>_0x4a263a[_0x278ae1(0x1c1)]==_0x3901cc[_0x278ae1(0x1c1)])[_0x278ae1(0x183)];_0x3b29e7+='Bot\x20'+_0x3901cc[_0x278ae1(0x1c1)]+':\x20'+_0x3901cc[_0x278ae1(0x1a8)]+'\x20|\x20'+_0x484691+_0x278ae1(0xd7)+_0x3901cc[_0x278ae1(0x19b)]+'\x0a';}),_0x3b29e7+='\x0a',_0x3b29e7+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x3b29e7+=!settings[_0x16338c(0x111)]?'Notifications\x20disabled\x0a':_0x16338c(0x22f),_0x3b29e7+=settings[_0x16338c(0x111)]?settings[_0x16338c(0x128)]==_0x16338c(0x1ca)?_0x16338c(0x220):'Notifications\x20types:\x20'+settings[_0x16338c(0x128)]+_0x16338c(0xde):'',tgBot[_0x16338c(0x213)](_0x2720bc['chat']['id'],_0x3b29e7,{'parse_mode':_0x16338c(0x1fd)})[_0x16338c(0x241)](_0x3094c2=>{telegramError(_0x3094c2);});}),tgBot['onText'](/\/restart/,_0x327539=>{const _0x19c1f2=_0x51206b;if(!validateTelegram(_0x327539))return;tgBot[_0x19c1f2(0x1fc)](_0x19c1f2(0x232));const _0x2c1966=getEnabledBots();if(_0x2c1966[_0x19c1f2(0xba)]==0x0)tgBot['sendMessage'](_0x327539[_0x19c1f2(0x12c)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x19c1f2(0x241)](_0x57bfb8=>{telegramError(_0x57bfb8);});else{if(_0x2c1966[_0x19c1f2(0xba)]>0x1)_0x2c1966[_0x19c1f2(0x11c)]({'botID':_0x19c1f2(0x1ca)});let _0x156050=[],_0x483f50=[];const _0x36ce14=_0x2c1966['length']%0x4==0x0||_0x2c1966[_0x19c1f2(0xba)]%0x4==0x3||_0x2c1966['length']%0x3==0x1?0x4:0x3;let _0x478567=0x0;_0x2c1966[_0x19c1f2(0x228)]((_0x16b316,_0x31cef0)=>{const _0x4d179d=_0x19c1f2;if(_0x31cef0%_0x36ce14==0x0)_0x483f50=[];_0x483f50[_0x4d179d(0x11c)]({'text':_0x16b316[_0x4d179d(0x1c1)]==_0x4d179d(0x1ca)?'All\x20bots':_0x4d179d(0x240)+_0x16b316['botID'],'callback_data':_0x16b316[_0x4d179d(0x1c1)]}),_0x31cef0%_0x36ce14==0x0&&(_0x156050[_0x478567]=_0x483f50,_0x478567++);}),tgBot['sendMessage'](_0x327539[_0x19c1f2(0x12c)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x156050}})[_0x19c1f2(0x241)](_0x5d7f8e=>{telegramError(_0x5d7f8e);}),tgBot['on'](_0x19c1f2(0x232),async _0x475704=>{const _0x524d5f=_0x19c1f2,_0x148840=_0x475704[_0x524d5f(0x108)],_0x63f937=_0x475704[_0x524d5f(0x175)];tgBot[_0x524d5f(0xf3)](_0x475704['id'])[_0x524d5f(0x1a7)](async()=>{const _0xc95bf2=_0x524d5f;_0x148840==_0xc95bf2(0x1ca)?config[_0xc95bf2(0x228)](_0x37f5e5=>{const _0x298c0b=_0xc95bf2;restartBot(_0x37f5e5[_0x298c0b(0x1c1)]);}):restartBot(_0x148840);}),tgBot[_0x524d5f(0x1fc)](_0x524d5f(0x232));});}}),tgBot[_0x51206b(0x212)](/\/on/,_0x4459bf=>{const _0x21806d=_0x51206b;if(!validateTelegram(_0x4459bf))return;tgBot['removeListener'](_0x21806d(0x232));const _0x4b83f9=getDisabledBots();if(_0x4b83f9[_0x21806d(0xba)]==0x0)tgBot['sendMessage'](_0x4459bf[_0x21806d(0x12c)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x21806d(0x241)](_0x51dcc0=>{telegramError(_0x51dcc0);});else{if(_0x4b83f9['length']>0x1)_0x4b83f9[_0x21806d(0x11c)]({'botID':_0x21806d(0x1ca)});let _0x204531=[],_0x548e47=[];const _0xa9ffd8=_0x4b83f9[_0x21806d(0xba)]%0x4==0x0||_0x4b83f9[_0x21806d(0xba)]%0x4==0x3||_0x4b83f9['length']%0x3==0x1?0x4:0x3;let _0x400181=0x0;_0x4b83f9['forEach']((_0x5424fb,_0x1477e1)=>{const _0x25b0a9=_0x21806d;if(_0x1477e1%_0xa9ffd8==0x0)_0x548e47=[];_0x548e47[_0x25b0a9(0x11c)]({'text':_0x5424fb['botID']==_0x25b0a9(0x1ca)?_0x25b0a9(0x105):_0x25b0a9(0x240)+_0x5424fb[_0x25b0a9(0x1c1)],'callback_data':_0x5424fb['botID']}),_0x1477e1%_0xa9ffd8==0x0&&(_0x204531[_0x400181]=_0x548e47,_0x400181++);}),tgBot[_0x21806d(0x213)](_0x4459bf[_0x21806d(0x12c)]['id'],_0x21806d(0x1b8),{'reply_markup':{'inline_keyboard':_0x204531}})['catch'](_0x38ea07=>{telegramError(_0x38ea07);}),tgBot['on']('callback_query',async _0x1154fe=>{const _0x1f1f9a=_0x21806d,_0x27eec3=_0x1154fe[_0x1f1f9a(0x108)],_0x3df26f=_0x1154fe[_0x1f1f9a(0x175)];tgBot[_0x1f1f9a(0xf3)](_0x1154fe['id'])[_0x1f1f9a(0x1a7)](async()=>{const _0x4f654a=_0x1f1f9a;_0x27eec3==_0x4f654a(0x1ca)?(tgBot[_0x4f654a(0x213)](_0x3df26f['chat']['id'],_0x4f654a(0x23e))[_0x4f654a(0x241)](_0x55ae6d=>{telegramError(_0x55ae6d);}),_0x4b83f9[_0x4f654a(0x228)](_0x23bca5=>{const _0x49a3f6=_0x4f654a;if(_0x23bca5[_0x49a3f6(0x1c1)]!='all')toggleBot(_0x23bca5[_0x49a3f6(0x1c1)],toggleStatus(_0x23bca5[_0x49a3f6(0x1c1)]),'stopped');})):(tgBot[_0x4f654a(0x213)](_0x3df26f[_0x4f654a(0x12c)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x27eec3)['catch'](_0x4f75ec=>{telegramError(_0x4f75ec);}),toggleBot(_0x27eec3,toggleStatus(_0x27eec3),'stopped'));}),tgBot[_0x1f1f9a(0x1fc)]('callback_query');});}}),tgBot[_0x51206b(0x212)](/\/off/,_0x2485b3=>{const _0x35bea9=_0x51206b;if(!validateTelegram(_0x2485b3))return;tgBot[_0x35bea9(0x1fc)](_0x35bea9(0x232));const _0x24c440=getEnabledBots();if(_0x24c440[_0x35bea9(0xba)]==0x0)tgBot[_0x35bea9(0x213)](_0x2485b3[_0x35bea9(0x12c)]['id'],_0x35bea9(0x1c2))['catch'](_0x2ce42a=>{telegramError(_0x2ce42a);});else{if(_0x24c440[_0x35bea9(0xba)]>0x1)_0x24c440[_0x35bea9(0x11c)]({'botID':_0x35bea9(0x1ca)});let _0x1e8238=[],_0x8ab849=[];const _0x329560=_0x24c440[_0x35bea9(0xba)]%0x4==0x0||_0x24c440[_0x35bea9(0xba)]%0x4==0x3||_0x24c440[_0x35bea9(0xba)]%0x3==0x1?0x4:0x3;let _0x7281a7=0x0;_0x24c440[_0x35bea9(0x228)]((_0x405d03,_0x2468db)=>{const _0xb4ee75=_0x35bea9;if(_0x2468db%_0x329560==0x0)_0x8ab849=[];_0x8ab849[_0xb4ee75(0x11c)]({'text':_0x405d03[_0xb4ee75(0x1c1)]==_0xb4ee75(0x1ca)?_0xb4ee75(0x105):_0xb4ee75(0x240)+_0x405d03[_0xb4ee75(0x1c1)],'callback_data':_0x405d03[_0xb4ee75(0x1c1)]}),_0x2468db%_0x329560==0x0&&(_0x1e8238[_0x7281a7]=_0x8ab849,_0x7281a7++);}),tgBot['sendMessage'](_0x2485b3[_0x35bea9(0x12c)]['id'],_0x35bea9(0x1e0),{'reply_markup':{'inline_keyboard':_0x1e8238}})[_0x35bea9(0x241)](_0x3344ac=>{telegramError(_0x3344ac);}),tgBot['on'](_0x35bea9(0x232),async _0x43768f=>{const _0x1e664b=_0x35bea9,_0x2e68bb=_0x43768f['data'],_0x572f02=_0x43768f[_0x1e664b(0x175)];tgBot[_0x1e664b(0xf3)](_0x43768f['id'])[_0x1e664b(0x1a7)](async()=>{const _0x274ed8=_0x1e664b;_0x2e68bb==_0x274ed8(0x1ca)?(tgBot[_0x274ed8(0x213)](_0x572f02[_0x274ed8(0x12c)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x274ed8(0x241)](_0x1f77a8=>{telegramError(_0x1f77a8);}),_0x24c440[_0x274ed8(0x228)](_0x39dd20=>{const _0x47d0e2=_0x274ed8;if(_0x39dd20[_0x47d0e2(0x1c1)]!=_0x47d0e2(0x1ca))toggleBot(_0x39dd20['botID'],toggleStatus(_0x39dd20[_0x47d0e2(0x1c1)]),_0x47d0e2(0xf6));})):(tgBot['sendMessage'](_0x572f02[_0x274ed8(0x12c)]['id'],_0x274ed8(0xed)+_0x2e68bb)[_0x274ed8(0x241)](_0x3bdb13=>{telegramError(_0x3bdb13);}),toggleBot(_0x2e68bb,toggleStatus(_0x2e68bb),_0x274ed8(0xf6)));}),tgBot[_0x1e664b(0x1fc)](_0x1e664b(0x232));});}}),tgBot[_0x51206b(0x212)](/\/portfolio/,_0x1fdb80=>{const _0x6047d0=_0x51206b;if(!validateTelegram(_0x1fdb80))return;tgBot[_0x6047d0(0x1fc)](_0x6047d0(0x232));const _0x1c37d4=getEnabledBots();if(_0x1c37d4['length']==0x0)tgBot[_0x6047d0(0x213)](_0x1fdb80['chat']['id'],_0x6047d0(0x1c2))['catch'](_0x46d75b=>{telegramError(_0x46d75b);});else{if(_0x1c37d4[_0x6047d0(0xba)]>0x1){let _0x29d8cc=[],_0x41731e=[];const _0x2cc860=_0x1c37d4[_0x6047d0(0xba)]%0x4==0x0||_0x1c37d4['length']%0x4==0x3||_0x1c37d4[_0x6047d0(0xba)]%0x3==0x1?0x4:0x3;let _0x17d532=0x0;_0x1c37d4[_0x6047d0(0x228)]((_0x1b44ca,_0x6175c0)=>{const _0x118c9f=_0x6047d0;if(_0x6175c0%_0x2cc860==0x0)_0x41731e=[];_0x41731e[_0x118c9f(0x11c)]({'text':'Bot\x20'+_0x1b44ca[_0x118c9f(0x1c1)],'callback_data':_0x1b44ca['botID']}),_0x6175c0%_0x2cc860==0x0&&(_0x29d8cc[_0x17d532]=_0x41731e,_0x17d532++);}),tgBot[_0x6047d0(0x213)](_0x1fdb80['chat']['id'],_0x6047d0(0x1cb),{'reply_markup':{'inline_keyboard':_0x29d8cc}})[_0x6047d0(0x241)](_0x42e265=>{telegramError(_0x42e265);}),tgBot['on']('callback_query',async _0x2cd4ec=>{const _0x2bdeee=_0x6047d0,_0x306952=_0x2cd4ec[_0x2bdeee(0x108)],_0x3ff0a9=_0x2cd4ec[_0x2bdeee(0x175)];tgBot[_0x2bdeee(0xf3)](_0x2cd4ec['id'])[_0x2bdeee(0x1a7)](async()=>{const _0x175afe=_0x2bdeee;if(pid[_0x306952])pid[_0x306952][_0x175afe(0xc6)]({'function':_0x175afe(0x1b2),'args':null});}),tgBot[_0x2bdeee(0x1fc)](_0x2bdeee(0x232));});}else{const _0x199ff2=_0x1c37d4[0x0][_0x6047d0(0x1c1)];if(pid[_0x199ff2])pid[_0x199ff2][_0x6047d0(0xc6)]({'function':_0x6047d0(0x1b2),'args':null});}}}),tgBot[_0x51206b(0x212)](/\/update/,async _0x357232=>{const _0x480e41=_0x51206b;if(!validateTelegram(_0x357232))return;tgBot[_0x480e41(0x1fc)](_0x480e41(0x232)),await getMessages();if(!updateAvailable)tgBot[_0x480e41(0x213)](_0x357232['chat']['id'],_0x480e41(0x114))['catch'](_0x2975dc=>{telegramError(_0x2975dc);});else!validInstallation?tgBot[_0x480e41(0x213)](_0x357232[_0x480e41(0x12c)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x480e41(0x241)](_0x4a96f1=>{telegramError(_0x4a96f1);}):(tgBot[_0x480e41(0x213)](_0x357232[_0x480e41(0x12c)]['id'],_0x480e41(0x1b9),{'reply_markup':{'inline_keyboard':[[{'text':_0x480e41(0x159),'callback_data':_0x480e41(0xef)},{'text':'No','callback_data':'no'}]]}})[_0x480e41(0x241)](_0x3f8c30=>{telegramError(_0x3f8c30);}),tgBot['on'](_0x480e41(0x232),async _0x3fded0=>{const _0x3ebff3=_0x480e41,_0x591099=_0x3fded0[_0x3ebff3(0x108)],_0x5f3e5c=_0x3fded0[_0x3ebff3(0x175)];tgBot[_0x3ebff3(0xf3)](_0x3fded0['id'])['then'](async()=>{const _0x469fa8=_0x3ebff3;_0x591099==_0x469fa8(0xef)&&(await tgBot[_0x469fa8(0x213)](_0x5f3e5c['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x469fa8(0x241)](_0x32ccba=>{telegramError(_0x32ccba);}),updateBB());_0x591099=='no'&&await tgBot[_0x469fa8(0x213)](_0x5f3e5c[_0x469fa8(0x12c)]['id'],_0x469fa8(0x22a))[_0x469fa8(0x241)](_0x5e1159=>{telegramError(_0x5e1159);});if(!settings['telegramChatId'])tgBot[_0x469fa8(0x213)](_0x5f3e5c[_0x469fa8(0x12c)]['id'],_0x469fa8(0x16e))[_0x469fa8(0x241)](_0x488524=>{telegramError(_0x488524);});}),tgBot[_0x3ebff3(0x1fc)]('callback_query');}));}),tgBot[_0x51206b(0x212)](/\/toggle/,_0x11b7c4=>{const _0x338a9c=_0x51206b;if(!validateTelegram(_0x11b7c4))return;tgBot['removeListener'](_0x338a9c(0x232));const _0x296dee=getBotsWithMode();if(_0x296dee[_0x338a9c(0xba)]==0x0)tgBot[_0x338a9c(0x213)](_0x11b7c4[_0x338a9c(0x12c)]['id'],_0x338a9c(0x1c2))[_0x338a9c(0x241)](_0x4fcffb=>{telegramError(_0x4fcffb);});else{let _0x359ea1=[],_0x4173a0=[];const _0x7727f2=0x2;let _0x41e0d5=0x0;_0x296dee['forEach']((_0x5593bf,_0x2f9a5d)=>{const _0x47d4ef=_0x338a9c;if(_0x2f9a5d%_0x7727f2==0x0)_0x4173a0=[];_0x4173a0[_0x47d4ef(0x11c)]({'text':_0x47d4ef(0x240)+_0x5593bf[_0x47d4ef(0x1c1)]+'\x20('+_0x5593bf[_0x47d4ef(0x183)]+')','callback_data':_0x5593bf['botID']}),_0x2f9a5d%_0x7727f2==0x0&&(_0x359ea1[_0x41e0d5]=_0x4173a0,_0x41e0d5++);}),tgBot[_0x338a9c(0x213)](_0x11b7c4[_0x338a9c(0x12c)]['id'],_0x338a9c(0x226),{'reply_markup':{'inline_keyboard':_0x359ea1}})[_0x338a9c(0x241)](_0x2387d5=>{telegramError(_0x2387d5);}),tgBot['on'](_0x338a9c(0x232),async _0x88aa70=>{const _0x2a971a=_0x338a9c,_0x567436=_0x88aa70[_0x2a971a(0x108)],_0x3e9b04=_0x88aa70['message'];tgBot[_0x2a971a(0xf3)](_0x88aa70['id'])[_0x2a971a(0x1a7)](async()=>{const _0x505341=_0x2a971a,_0x433af7=_0x296dee['find'](_0x595062=>_0x595062['botID']==_0x567436),_0x432af5=_0x433af7['mode']=='auto'?_0x505341(0xeb):_0x505341(0xfe);tgBot[_0x505341(0x213)](_0x3e9b04['chat']['id'],_0x505341(0x113)+_0x567436+'\x20to\x20'+_0x432af5+_0x505341(0xce))[_0x505341(0x241)](_0x13a4b3=>{telegramError(_0x13a4b3);}),toggleBotMode(_0x567436);}),tgBot[_0x2a971a(0x1fc)](_0x2a971a(0x232));});}}),tgBot[_0x51206b(0x212)](/\/names/,_0x5e5910=>{const _0x13b50c=_0x51206b;if(!validateTelegram(_0x5e5910))return;let _0x443d50='';config[_0x13b50c(0x228)](_0x1f608d=>{const _0x2db65b=_0x13b50c;_0x443d50+=_0x2db65b(0x240)+_0x1f608d[_0x2db65b(0x1c1)]+':\x20'+_0x1f608d[_0x2db65b(0x1c7)]+'\x0a';}),tgBot[_0x13b50c(0x213)](_0x5e5910[_0x13b50c(0x12c)]['id'],_0x443d50,{'parse_mode':_0x13b50c(0x1fd)})[_0x13b50c(0x241)](_0x1be6cb=>{telegramError(_0x1be6cb);});}),tgBot[_0x51206b(0x212)](/\/disable/,_0x1e96fc=>{const _0xf8cd94=_0x51206b;if(!validateTelegram(_0x1e96fc))return;tgBot[_0xf8cd94(0x213)](_0x1e96fc[_0xf8cd94(0x12c)]['id'],_0xf8cd94(0xc2))['catch'](_0x397416=>{telegramError(_0x397416);}),updateSetting(_0xf8cd94(0x111),![]);}),tgBot['onText'](/\/help/,_0x180bd5=>{const _0x1030eb=_0x51206b;if(!validateTelegram(_0x180bd5))return;tgBot[_0x1030eb(0x213)](_0x180bd5['chat']['id'],_0x3d3c40)['catch'](_0x3bb216=>{telegramError(_0x3bb216);});}),tgBot['on'](_0x51206b(0x1f7),_0x575b27=>{const _0x4af09d=_0x51206b;_0x575b27[_0x4af09d(0x124)]()[_0x4af09d(0xee)]('404\x20Not\x20Found')&&(logger[_0x4af09d(0x10a)](_0x4af09d(0x19e)),tgBot[_0x4af09d(0x19f)](),tgBot=null,io['to'](_0x4af09d(0xda))[_0x4af09d(0x16c)]('notification',_0x4af09d(0x19e)));}),process[_0x51206b(0x13b)](_0x51206b(0x20e),()=>{const _0x3931ee=_0x51206b;if(tgBot)tgBot[_0x3931ee(0x19f)]();process[_0x3931ee(0xd1)](0x1);}),process[_0x51206b(0x13b)](_0x51206b(0x162),()=>{const _0x228ab0=_0x51206b;if(tgBot)tgBot[_0x228ab0(0x19f)]();process[_0x228ab0(0xd1)](0x1);});}}function disableTelegram(){const _0x5e4357=_0x3d19d6;tgBot&&(tgBot[_0x5e4357(0x19f)](),tgBot=null);}function sendTelegram(_0x2c3ea2,_0x2eadfe){const _0x321485=_0x3d19d6;if(settings[_0x321485(0x111)]){if(settings[_0x321485(0x128)]==_0x321485(0x1ca)||(_0x2eadfe[_0x321485(0x194)]==_0x321485(0x134)||_0x2eadfe[_0x321485(0x194)]==_0x321485(0x23d))&&settings[_0x321485(0x128)]=='alerts'||_0x2eadfe[_0x321485(0x194)]==_0x321485(0x1e4)&&settings['telegramEvents']==_0x321485(0x17f)){if(tgBot&&settings[_0x321485(0x21b)]){if(_0x2eadfe[_0x321485(0x210)])tgBot['sendMessage'](settings[_0x321485(0x21b)],_0x2eadfe[_0x321485(0x1c7)]+'\x20>\x20'+_0x2eadfe[_0x321485(0x20d)])[_0x321485(0x241)](_0x7ceee6=>{telegramError(_0x7ceee6);});else tgBot[_0x321485(0x213)](settings[_0x321485(0x21b)],_0x321485(0x240)+_0x2c3ea2+_0x321485(0xc5)+_0x2eadfe[_0x321485(0x20d)])[_0x321485(0x241)](_0x49e956=>{telegramError(_0x49e956);});}}}}async function sendTelegramMsg(_0x27a9fb,_0x356e74=_0x3d19d6(0x1fd)){const _0x5451fd=_0x3d19d6;return settings[_0x5451fd(0x111)]&&tgBot&&settings[_0x5451fd(0x21b)]?(await tgBot[_0x5451fd(0x213)](settings[_0x5451fd(0x21b)],_0x27a9fb,{'parse_mode':_0x356e74})[_0x5451fd(0x241)](_0x523bbb=>{telegramError(_0x523bbb);}),!![]):![];}function getDeviceWithIp(_0x5c809b){const _0x13891f=_0x3d19d6;return devices[_0x13891f(0x17b)](_0x5931fe=>_0x5931fe['ip']===_0x5c809b);}function temporaryAccess2FA(_0xe1f1c,_0x6cc7c8){const _0x2cf57f=_0x3d19d6;let _0x3aaa68=new Date(),_0x5ac8af=![];if(lastIpApproval){if(_0x3aaa68-lastIpApproval<0x1388)_0x5ac8af=!![];}lastIpApproval=new Date();if(_0x5ac8af)return;tgBot&&settings[_0x2cf57f(0x21b)]&&(tgBot[_0x2cf57f(0x1fc)](_0x2cf57f(0x232)),tgBot['sendMessage'](settings[_0x2cf57f(0x21b)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x6cc7c8)[_0x2cf57f(0x1a5)]+_0x2cf57f(0x10c),{'parse_mode':_0x2cf57f(0x1fd),'reply_markup':{'inline_keyboard':[[{'text':_0x2cf57f(0x1e3),'callback_data':'5'},{'text':_0x2cf57f(0xc1),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x2cf57f(0x112),'callback_data':'reject'}]]}})['catch'](_0x859422=>{telegramError(_0x859422);}),tgBot['on'](_0x2cf57f(0x232),async _0x2613a8=>{const _0x21ddc9=_0x2cf57f,_0xfaca43=_0x2613a8[_0x21ddc9(0x108)],_0x1f1dd3=_0x2613a8[_0x21ddc9(0x175)];tgBot[_0x21ddc9(0xf3)](_0x2613a8['id'])[_0x21ddc9(0x1a7)](async()=>{const _0x761c8=_0x21ddc9;devices[_0xe1f1c]['telegramIpApproval']={'clientip':_0x6cc7c8,'timestamp':new Date()[_0x761c8(0x203)](),'expiry':_0xfaca43},_0xfaca43!='reject'?(await tgBot[_0x761c8(0x213)](_0x1f1dd3[_0x761c8(0x12c)]['id'],'Access\x20enabled\x20for\x20'+_0xfaca43+'\x20minutes',{'parse_mode':_0x761c8(0x1fd)})[_0x761c8(0x241)](_0x4dcbf7=>{telegramError(_0x4dcbf7);}),io['to'](_0xe1f1c)[_0x761c8(0x16c)](_0x761c8(0x1a8),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x761c8(0x213)](_0x1f1dd3[_0x761c8(0x12c)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x263f8d=>{telegramError(_0x263f8d);}),io['to'](_0xe1f1c)['emit'](_0x761c8(0x1a8),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x21ddc9(0x1fc)](_0x21ddc9(0x232));}));}function loginAccess2FA(_0x1689f7,_0x5a398b){const _0x59339c=_0x3d19d6;tgBot&&settings[_0x59339c(0x21b)]&&(tgBot[_0x59339c(0x1fc)](_0x59339c(0x232)),tgBot['sendMessage'](settings['telegramChatId'],_0x59339c(0x1bf)+normalizeIP(_0x5a398b)[_0x59339c(0x1a5)]+'</b>\x20?',{'parse_mode':_0x59339c(0x1fd),'reply_markup':{'inline_keyboard':[[{'text':_0x59339c(0x1a6),'callback_data':loginExpiry},{'text':_0x59339c(0x112),'callback_data':_0x59339c(0x112)}]]}})[_0x59339c(0x241)](_0x32522e=>{telegramError(_0x32522e);}),tgBot['on']('callback_query',async _0xad6f0a=>{const _0x4dfdc5=_0x59339c,_0x1d7684=_0xad6f0a[_0x4dfdc5(0x108)],_0x138b2d=_0xad6f0a['message'];tgBot[_0x4dfdc5(0xf3)](_0xad6f0a['id'])[_0x4dfdc5(0x1a7)](async()=>{const _0x306549=_0x4dfdc5;devices[_0x1689f7][_0x306549(0x169)]={'clientip':_0x5a398b,'timestamp':new Date()['getTime'](),'expiry':_0x1d7684},_0x1d7684!=_0x306549(0x112)?(await tgBot[_0x306549(0x213)](_0x138b2d[_0x306549(0x12c)]['id'],_0x306549(0x104),{'parse_mode':'HTML'})[_0x306549(0x241)](_0x51e122=>{telegramError(_0x51e122);}),io['to'](_0x1689f7)[_0x306549(0x16c)](_0x306549(0x1a8),{'access':{'allow':![],'reason':_0x306549(0x166),'token':null}})):(await tgBot[_0x306549(0x213)](_0x138b2d['chat']['id'],_0x306549(0x119))[_0x306549(0x241)](_0x1ac8c7=>{telegramError(_0x1ac8c7);}),io['to'](_0x1689f7)[_0x306549(0x16c)](_0x306549(0x1a8),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x4dfdc5(0x1fc)](_0x4dfdc5(0x232));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4c58f4=_0x3d19d6;return dbConfig[_0x4c58f4(0x21c)](_0x4c58f4(0x197))['sortBy']('botID')['filter']({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x150360=_0x3d19d6;return dbConfig['get'](_0x150360(0x197))[_0x150360(0x23b)]('botID')[_0x150360(0x206)]({'status':_0x150360(0x235)})[_0x150360(0xfd)]()||[];}function getBotAttributes(_0x459a08){const _0x4b694f=_0x3d19d6;let _0x2218c3={};const _0x5ea5a3=configpath+_0x4b694f(0x1b1)+_0x459a08+_0x4b694f(0x237),_0x20913f=fs[_0x4b694f(0x1c3)](_0x5ea5a3);if(_0x20913f){const _0x50ccd0=fs[_0x4b694f(0x224)](_0x5ea5a3);try{const _0xce86e2=JSON[_0x4b694f(0x21a)](_0x50ccd0),_0x528da3=_0xce86e2?_0xce86e2[_0x4b694f(0x14c)][0x0][_0x4b694f(0xbe)]:![];_0x2218c3[_0x4b694f(0x183)]=_0x528da3?'auto':'manual',_0x2218c3[_0x4b694f(0x1c7)]=_0xce86e2?_0xce86e2[_0x4b694f(0x14c)][0x0][_0x4b694f(0x1c7)]:_0x4b694f(0x240)+_0x459a08;}catch(_0x26d204){_0x2218c3[_0x4b694f(0x183)]='manual',_0x2218c3['botname']='Bot\x20'+_0x459a08;}}else _0x2218c3['mode']=_0x4b694f(0xeb),_0x2218c3[_0x4b694f(0x1c7)]=_0x4b694f(0x240)+_0x459a08;return _0x2218c3;}function getBotsWithMode(){const _0x52996a=_0x3d19d6,_0x1d0cc4=dbConfig[_0x52996a(0x21c)](_0x52996a(0x197))[_0x52996a(0x23b)](_0x52996a(0x1c1))[_0x52996a(0xfd)]()||[];return _0x1d0cc4[_0x52996a(0x228)](_0x3add2c=>{const _0x462778=_0x52996a;let _0x298a97=getBotAttributes(_0x3add2c[_0x462778(0x1c1)]);_0x3add2c[_0x462778(0x183)]=_0x298a97[_0x462778(0x183)];}),_0x1d0cc4;}async function initUser(){const _0x14ad93=_0x3d19d6;if(!settings[_0x14ad93(0x18c)]){const _0x280062=uuidRandom();mixpanel[_0x14ad93(0xf2)](_0x280062),updateSetting('userid',_0x280062);}}async function initSecure(){const _0x32ac32=_0x3d19d6;let _0x547967=getSecure();if(!_0x547967['hasOwnProperty'](_0x32ac32(0x1cc))){let _0x25908c=await generateKeys();_0x547967[_0x32ac32(0xe8)]=_0x25908c['publicKey'],_0x547967['privateKey']=_0x25908c[_0x32ac32(0x1d3)],_0x547967[_0x32ac32(0x1cc)]=crypto['randomBytes'](0x20)[_0x32ac32(0x124)](_0x32ac32(0x165));;storeSecure(_0x547967);}}function getSettings(){const _0x46e379=_0x3d19d6;return dbSettings[_0x46e379(0x21c)](_0x46e379(0x238))[_0x46e379(0xfd)]()||{};}function getSecure(){const _0x3bbbd9=_0x3d19d6;return dbSecure[_0x3bbbd9(0x21c)](_0x3bbbd9(0xc4))['value']()||{};}function getBlacklist(){const _0x23c60d=_0x3d19d6;return dbSecure[_0x23c60d(0x21c)](_0x23c60d(0xd2))[_0x23c60d(0xfd)]()||[];}function broadcastToBots(_0x4c6dda,_0xf837a3){const _0x55b9b7=_0x3d19d6;config[_0x55b9b7(0x228)](_0x25d6b2=>{const _0x155e87=_0x55b9b7;if(_0x25d6b2[_0x155e87(0x1a8)]==_0x155e87(0x185)&&_0x25d6b2[_0x155e87(0x19b)]=='running'){if(pid[_0x25d6b2[_0x155e87(0x1c1)]])pid[_0x25d6b2[_0x155e87(0x1c1)]][_0x155e87(0xc6)]({[_0x4c6dda]:_0xf837a3});}});}function storeSettings(_0x224110,_0x1ca517=![]){const _0x4e0d66=_0x3d19d6;_0x224110={...settings,..._0x224110};if(_0x1ca517&&_0x224110[_0x4e0d66(0x1fe)]!=_0x4e0d66(0x16b)&&_0x224110[_0x4e0d66(0x1fe)]!=''){const _0xdb5177=crypt[_0x4e0d66(0x243)](secure[_0x4e0d66(0x1d3)],_0x224110['bbPassword'])['message']['split']('@')[0x0],_0x5ecbff=bcrypt[_0x4e0d66(0x14d)](_0xdb5177,saltRounds);_0x224110={..._0x224110,'bbPassword':_0x5ecbff};}if(_0x1ca517&&_0x224110[_0x4e0d66(0xc7)]!=_0x4e0d66(0x16b)&&_0x224110[_0x4e0d66(0xc7)]!=''){const _0x42e6ff=crypt['decrypt'](secure['privateKey'],_0x224110[_0x4e0d66(0xc7)])[_0x4e0d66(0x175)][_0x4e0d66(0x20c)]('@')[0x0];_0x224110={..._0x224110,'telegramToken':_0x42e6ff};}const _0x5a228e=_0x224110[_0x4e0d66(0xc7)]!=_0x4e0d66(0x16b)&&_0x224110[_0x4e0d66(0xc7)]!=settings[_0x4e0d66(0xc7)]||_0x224110[_0x4e0d66(0xf0)]!=settings[_0x4e0d66(0xf0)],_0x3afb44=_0x224110[_0x4e0d66(0xc7)]==''||_0x224110[_0x4e0d66(0xf0)]=='';if(_0x5a228e)_0x224110[_0x4e0d66(0x128)]='all';for(const [_0x489429,_0x3c3601]of Object['entries'](_0x224110)){if(_0x489429==_0x4e0d66(0xc7)&&_0x3c3601=='************'){_0x224110[_0x4e0d66(0xc7)]=settings[_0x4e0d66(0xc7)];continue;};if(_0x489429=='bbPassword'&&_0x3c3601==_0x4e0d66(0x16b)){_0x224110[_0x4e0d66(0x1fe)]=settings[_0x4e0d66(0x1fe)];continue;};dbSettings[_0x4e0d66(0x1f2)](_0x4e0d66(0x1b3)+_0x489429,_0x3c3601)[_0x4e0d66(0xe3)]();}settings=_0x224110,io['to']('botmanager')[_0x4e0d66(0x16c)]('settings',cleanSettings()),broadcastToBots(_0x4e0d66(0x1ad),settings['timeshift']);if(_0x5a228e&&!_0x3afb44)initTelegram();if(_0x5a228e&&_0x3afb44)disableTelegram();getAllClients()[_0x4e0d66(0x228)](_0x5808db=>{const _0x2c0c23=_0x4e0d66;getSocket(_0x5808db['id'])[_0x2c0c23(0x16c)](_0x2c0c23(0x1a8),{'access':{'allow':![],'reason':_0x2c0c23(0x166),'token':null}});});}function updateSetting(_0xf1855b,_0x5c0a22){const _0x3cd060=_0x3d19d6;dbSettings['set'](_0x3cd060(0x1b3)+_0xf1855b,_0x5c0a22)['write'](),settings=getSettings(),io['to'](_0x3cd060(0xda))[_0x3cd060(0x16c)](_0x3cd060(0x238),cleanSettings());}function storeSecure(_0x28cff9){const _0x331bf7=_0x3d19d6;dbSecure[_0x331bf7(0x21c)](_0x331bf7(0xc4))['push'](_0x28cff9)[_0x331bf7(0xe3)](),secure=_0x28cff9;}function addBlacklist(_0x2a8719){const _0x1878e6=_0x3d19d6;cleanBlacklist();let _0x3bd4ba;devices[_0x2a8719][_0x1878e6(0x1de)]?_0x3bd4ba=Math[_0x1878e6(0x11e)](devices[_0x2a8719][_0x1878e6(0x1de)][_0x1878e6(0x242)],loginExpiry):_0x3bd4ba=loginExpiry,dbSecure[_0x1878e6(0x21c)](_0x1878e6(0xd2))[_0x1878e6(0x11c)]({'expiry':new Date()[_0x1878e6(0x203)]()+_0x3bd4ba*0x3c*0x3e8,'token':devices[_0x2a8719][_0x1878e6(0x1f1)]['token']})[_0x1878e6(0xe3)](),blacklist=dbSecure[_0x1878e6(0x21c)](_0x1878e6(0xd2))[_0x1878e6(0xfd)]();}function cleanBlacklist(){const _0x859f71=_0x3d19d6;let _0x37a2f9=dbSecure['get'](_0x859f71(0xd2))[_0x859f71(0x17e)]()[_0x859f71(0xfd)](),_0x807cc6=new Date()[_0x859f71(0x203)]();_0x37a2f9[_0x859f71(0x228)](_0x3e56b1=>{const _0x139cb7=_0x859f71;_0x3e56b1[_0x139cb7(0x242)]<_0x807cc6&&dbSecure[_0x139cb7(0x21c)](_0x139cb7(0xd2))['remove']({'expiry':_0x3e56b1[_0x139cb7(0x242)]})[_0x139cb7(0xe3)]();});}function initStates(){const _0x1eec2d=_0x3d19d6;let _0x52f186=getConfiguration();_0x52f186[_0x1eec2d(0x228)](_0x32cc57=>{const _0x212a58=_0x1eec2d;_0x32cc57['live']=_0x212a58(0xf6);}),storeConfiguration(_0x52f186);}function onKeys(){const _0x2a1472=new RSA();return new Promise(_0x1e7709=>{const _0x21eb81=_0x14ad;_0x2a1472[_0x21eb81(0x22b)]()[_0x21eb81(0x1a7)](_0xd8afb6=>{_0x1e7709(_0xd8afb6);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0xe7ccfd=_0x3d19d6;let _0xc4c15b=getSettings(),_0x53f8f7=![];!_0xc4c15b[_0xe7ccfd(0x122)](_0xe7ccfd(0x152))&&(_0xc4c15b[_0xe7ccfd(0x152)]=0x0,_0x53f8f7=!![]);!_0xc4c15b[_0xe7ccfd(0x122)](_0xe7ccfd(0xf7))&&(_0xc4c15b['lastmsgemitted']=0x0,_0x53f8f7=!![]);!_0xc4c15b['hasOwnProperty']('latestversion')&&(_0xc4c15b[_0xe7ccfd(0x23a)]=_0xe7ccfd(0x239),_0x53f8f7=!![]);if(_0x53f8f7)storeSettings(_0xc4c15b);}function storeConfiguration(_0xdcd12c){const _0x542755=_0x3d19d6;dbConfig[_0x542755(0x21c)](_0x542755(0x197))['remove']()[_0x542755(0xe3)](),_0xdcd12c['forEach'](_0x22b967=>{const _0x2efdcc=_0x542755;delete _0x22b967[_0x2efdcc(0x183)];}),dbConfig[_0x542755(0x21c)](_0x542755(0x197))[_0x542755(0x11c)](..._0xdcd12c)[_0x542755(0xe3)](),config=_0xdcd12c;}function resetPassword(){const _0x2a9021=_0x3d19d6;tgBot&&settings[_0x2a9021(0x21b)]&&(tgBot[_0x2a9021(0x1fc)]('callback_query'),tgBot[_0x2a9021(0x213)](settings[_0x2a9021(0x21b)],_0x2a9021(0x1d5),{'parse_mode':_0x2a9021(0x1fd),'reply_markup':{'inline_keyboard':[[{'text':_0x2a9021(0xef),'callback_data':_0x2a9021(0xef)},{'text':'no','callback_data':'no'}]]}})[_0x2a9021(0x241)](_0x4ea992=>{telegramError(_0x4ea992);}),tgBot['on'](_0x2a9021(0x232),async _0x1415df=>{const _0x20e508=_0x2a9021,_0x5897aa=_0x1415df[_0x20e508(0x108)],_0x3879f8=_0x1415df['message'];tgBot[_0x20e508(0xf3)](_0x1415df['id'])['then'](async()=>{const _0x354fd2=_0x20e508;if(_0x5897aa!='no'){const _0x329f25=0xf,_0x4363e4=_0x354fd2(0x221),_0x170122=Array[_0x354fd2(0x14b)](crypto[_0x354fd2(0x191)](new Uint32Array(_0x329f25)))[_0x354fd2(0x1e6)](_0x74e481=>_0x4363e4[_0x74e481%_0x4363e4[_0x354fd2(0xba)]])[_0x354fd2(0x201)](''),_0x4f4885=bcrypt[_0x354fd2(0x14d)](_0x170122,saltRounds);storeSettings({'bbPassword':_0x4f4885}),await tgBot[_0x354fd2(0x213)](_0x3879f8[_0x354fd2(0x12c)]['id'],_0x354fd2(0xf5)+_0x170122,{'parse_mode':'HTML'})[_0x354fd2(0x241)](_0x55ab16=>{telegramError(_0x55ab16);});}else await tgBot['sendMessage'](_0x3879f8[_0x354fd2(0x12c)]['id'],'Password\x20reset\x20rejected')[_0x354fd2(0x241)](_0x46b143=>{telegramError(_0x46b143);});}),tgBot[_0x20e508(0x1fc)](_0x20e508(0x232));}));}function getServerTime(){const _0x233227=_0x3d19d6,_0x38674b=new Date();return _0x38674b[_0x233227(0x154)]()+'/'+(_0x38674b[_0x233227(0x157)]()+0x1)['toString']()[_0x233227(0xe9)](0x2,'0')+'/'+_0x38674b['getDate']()[_0x233227(0x124)]()[_0x233227(0xe9)](0x2,'0')+'\x20'+_0x38674b[_0x233227(0x219)]()['toString']()['padStart'](0x2,'0')+':'+_0x38674b[_0x233227(0xbd)]()[_0x233227(0x124)]()[_0x233227(0xe9)](0x2,'0')+':'+_0x38674b[_0x233227(0x123)]()[_0x233227(0x124)]()[_0x233227(0xe9)](0x2,'0');}function getTimeStamp(){const _0x75d8b3=_0x3d19d6,_0x4c7d14=shiftedTime();return _0x4c7d14[_0x75d8b3(0x154)]()+'/'+(_0x4c7d14[_0x75d8b3(0x157)]()+0x1)[_0x75d8b3(0x124)]()[_0x75d8b3(0xe9)](0x2,'0')+'/'+_0x4c7d14[_0x75d8b3(0xe0)]()[_0x75d8b3(0x124)]()[_0x75d8b3(0xe9)](0x2,'0')+'\x20'+_0x4c7d14[_0x75d8b3(0x219)]()[_0x75d8b3(0x124)]()[_0x75d8b3(0xe9)](0x2,'0')+':'+_0x4c7d14[_0x75d8b3(0xbd)]()[_0x75d8b3(0x124)]()[_0x75d8b3(0xe9)](0x2,'0')+':'+_0x4c7d14[_0x75d8b3(0x123)]()['toString']()[_0x75d8b3(0xe9)](0x2,'0');}function shiftedTime(){const _0x1c5a0f=_0x3d19d6,_0x41fe6f=new Date();let _0x2fc5db=_0x41fe6f;if(settings[_0x1c5a0f(0x1ad)]&&settings[_0x1c5a0f(0x1ad)]!==0x0)_0x2fc5db=fns[_0x1c5a0f(0x179)](_0x41fe6f,{'hours':settings[_0x1c5a0f(0x1ad)]});return _0x2fc5db;}function startScheduler(){const _0x41a231=_0x3d19d6,_0xbfe871=new Date()[_0x41a231(0x1e1)](),_0x3460b1=new Date()['getHours']()+settings[_0x41a231(0x1ad)];_0x3460b1==0x4&&backupConfigFiles();_0x3460b1==0x0&&rotateLogFiles();_0xbfe871%0x6==0x0&&triggerAnalytics();_0xbfe871%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x14d4a9=_0x3d19d6;fs[_0x14d4a9(0x1da)](configpath,{'withFileTypes':!![]})['forEach'](_0x523db2=>{const _0x4ebc17=_0x14d4a9;if(!_0x523db2['isDirectory']())fs[_0x4ebc17(0x131)](configpath+_0x523db2['name'],configbackuppath+_0x523db2[_0x4ebc17(0x1c4)]);});}function rotateLogFiles(){const _0x1ef1be=_0x3d19d6;let _0x38b4d8=fs[_0x1ef1be(0x1da)](logspath,{'withFileTypes':!![]});_0x38b4d8[_0x1ef1be(0x207)]((_0x1dcb0d,_0x36e4d2)=>_0x1dcb0d['name']<_0x36e4d2[_0x1ef1be(0x1c4)]?0x1:_0x36e4d2[_0x1ef1be(0x1c4)]<_0x1dcb0d['name']?-0x1:0x0),_0x38b4d8[_0x1ef1be(0x228)](_0x51303d=>{const _0x4e9725=_0x1ef1be;if(_0x51303d[_0x4e9725(0x1c4)]==_0x4e9725(0xc3))fs['copyFileSync'](logspath+_0x51303d[_0x4e9725(0x1c4)],logspath+_0x4e9725(0x117));if(_0x51303d[_0x4e9725(0x1c4)]==_0x4e9725(0x168))fs[_0x4e9725(0x131)](logspath+_0x51303d[_0x4e9725(0x1c4)],logspath+_0x4e9725(0xc3));_0x51303d[_0x4e9725(0x1c4)]=='output-000.log'&&(fs[_0x4e9725(0x131)](logspath+_0x51303d[_0x4e9725(0x1c4)],logspath+_0x4e9725(0x168)),fs['writeFileSync'](logspath+_0x51303d[_0x4e9725(0x1c4)],''));});}async function zipFiles(_0x39a8de){const _0x48192a=_0x3d19d6;let _0x1ca5ee;if(_0x39a8de==_0x48192a(0x211))_0x1ca5ee=logspath;if(_0x39a8de==_0x48192a(0x1bd))_0x1ca5ee=configpath;let _0xbcbadb=fs['readdirSync'](_0x1ca5ee,{'withFileTypes':!![]});const _0x3be33d=new require('node-zip')();_0xbcbadb['forEach'](_0x58875d=>{const _0x48f727=_0x48192a;if(!_0x58875d[_0x48f727(0x190)]()){let _0x35ad3b=fs['readFileSync'](_0x1ca5ee+_0x58875d['name']);const _0x1009bd=/^bot-[0-9]{3}-config.json$/,_0x68e318=_0x1009bd[_0x48f727(0x133)](_0x58875d[_0x48f727(0x1c4)]);if(_0x68e318){const _0x3cc4fd=JSON[_0x48f727(0x21a)](_0x35ad3b);_0x3cc4fd[_0x48f727(0x14c)][0x0][_0x48f727(0x1b7)]=_0x48f727(0x1dd),_0x3cc4fd['bot'][0x0]['apiSecret']='***',_0x35ad3b=JSON[_0x48f727(0x110)](_0x3cc4fd,null,0x2);}if(_0x58875d[_0x48f727(0x1c4)]=='bb-settings.json'){const _0x4014cd=JSON['parse'](_0x35ad3b);if(_0x4014cd[_0x48f727(0x238)][_0x48f727(0x1fe)])_0x4014cd[_0x48f727(0x238)][_0x48f727(0x1fe)]=_0x48f727(0x1dd);if(_0x4014cd[_0x48f727(0x238)]['telegramToken'])_0x4014cd['settings'][_0x48f727(0xc7)]=_0x48f727(0x1dd);if(_0x4014cd[_0x48f727(0x238)]['telegramChatId'])_0x4014cd[_0x48f727(0x238)][_0x48f727(0x21b)]=_0x48f727(0x1dd);_0x35ad3b=JSON[_0x48f727(0x110)](_0x4014cd,null,0x2);}if(_0x58875d[_0x48f727(0x1c4)]!=_0x48f727(0x10d))_0x3be33d[_0x48f727(0xcc)](_0x58875d[_0x48f727(0x1c4)],_0x35ad3b);}});const _0x41f655=_0x3be33d[_0x48192a(0x215)]({'base64':![],'compression':_0x48192a(0xc9)});fs[_0x48192a(0x1a4)](zippath+(_0x39a8de+_0x48192a(0x12d)),_0x41f655,'binary');}async function getPublicIp(){const _0x5df620=_0x3d19d6;try{const _0x56b43a=await axios['get'](_0x5df620(0x160));publicip=_0x56b43a[_0x5df620(0x108)]['ip'];}catch(_0x543cc3){}}async function triggerAnalytics(){const _0x1cc39f=_0x3d19d6;if(!publicip)await getPublicIp();const _0x44520e=getBotsWithMode();let _0x4303be=0x0;_0x44520e[_0x1cc39f(0x228)](_0x5ed2d=>{if(_0x5ed2d['status']==='enabled')_0x4303be++;}),mixpanel['track']('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x44520e[_0x1cc39f(0xba)],'numbotsenabled':_0x4303be});}async function getMessages(){const _0x51533a=_0x3d19d6,_0x50d389=_0x51533a(0xcb),_0x1031c9=new GraphQLClient(_0x50d389),_0x214fcc={'authorization':_0x51533a(0x15d)},_0x1f7fa1=serverversion[_0x51533a(0x20c)]('.'),_0x5ddfea=_0x1f7fa1[0x0]+'.'+_0x1f7fa1[0x1],_0x26ccaa=Math['min'](settings['lastmsgtelegram'],settings[_0x51533a(0xf7)]),_0x225dc9={'last':parseInt(_0x26ccaa),'bbm':_0x5ddfea},_0xaa2cdc=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4e59d9;try{_0x4e59d9=await _0x1031c9['request'](_0xaa2cdc,_0x225dc9,_0x214fcc);}catch(_0x48917f){}if(_0x4e59d9&&_0x4e59d9[_0x51533a(0x192)]){let _0x4e84f6=settings['lastmsgtelegram'];newMessages=[];for(const _0x20aaf5 of _0x4e59d9['messages']){newMessages[_0x51533a(0x11c)](_0x20aaf5);if(_0x20aaf5[_0x51533a(0x11d)])updateSetting(_0x51533a(0x23a),_0x20aaf5[_0x51533a(0x11d)]);let _0x3f5c3e=_0x20aaf5[_0x51533a(0x11d)]?serverversion>=_0x20aaf5[_0x51533a(0x11d)]:![];if(!_0x3f5c3e&&_0x20aaf5[_0x51533a(0x18a)]>_0x4e84f6){if(_0x20aaf5['bbvReceive']===_0x51533a(0x1e7)||serverversion[_0x51533a(0x132)](_0x20aaf5[_0x51533a(0x21f)])){let _0x8e409d=''+_0x20aaf5['title']+'\x0a\x0a'+_0x20aaf5['message'];const _0x4f8606=await sendTelegramMsg(toTelegramMarkdown(_0x8e409d),_0x51533a(0x1a2));if(_0x4f8606)_0x4e84f6=_0x20aaf5[_0x51533a(0x18a)];}}}updateAvailable=isNewerVersion(settings[_0x51533a(0x23a)],serverversion),updateSetting(_0x51533a(0x152),_0x4e84f6),emitMessages();}}function emitMessages(){const _0x4baa3f=_0x3d19d6,_0x499e28=settings['lastmsgemitted'];let _0x5b3686=[];newMessages[_0x4baa3f(0x228)](_0x31a0a8=>{const _0xcab39d=_0x4baa3f;_0x31a0a8['number']>_0x499e28&&_0x5b3686[_0xcab39d(0x11c)](_0x31a0a8);}),_0x5b3686[_0x4baa3f(0xba)]>0x0&&getAllClients()[_0x4baa3f(0x228)](_0x463c8a=>{const _0x1a2dc9=_0x4baa3f;getSocket(_0x463c8a['id'])['emit'](_0x1a2dc9(0x175),_0x5b3686);});}function confirmMessage(_0x248afb){updateSetting('lastmsgemitted',Number(_0x248afb));}function _0x30d7(){const _0x432257=['Invalid\x20authentication\x20token\x20(2)','Allow\x20login\x20from\x20IP\x20address\x20<b>','4614210gjYckC','botID','No\x20bots\x20running\x20right\x20now','existsSync','name','started','::1','botname','login','logged\x20out','all','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','secret','Failed\x20to\x20download\x20','get-logs','whitelist','initclient','lowdb','notification','privateKey','getStartingBalances','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','temporaryAccessAllowed','3065232PrYrYU','pidExpireLogin','-events.json','readdirSync','clients','defaults','***','telegramIpApproval','get-messages','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','getUTCHours','add-bot','5\x20min','order','Unauthorized\x20attempt\x20to\x20get\x20portfolio','map','any','date-fns','http','/:bot','storeHeadless','removeAllListeners','store-configuration','sockets','Bot\x20Mgr\x20>\x20','2vbhfFM','access','set','You\x20can\x20use\x20the\x20following\x20commands:\x0a','fork','whitelistEnabled','Unauthorized\x20attempt\x20to\x20get\x20messages','polling_error','version','login\x20not\x20required','starting\x20bot\x20|\x20Bot\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','removeListener','HTML','bbPassword','password','5813032mIglAw','join','login\x20token\x20valid','getTime','mkdirSync','No\x20authentication\x20token','filter','sort','Unauthorized\x20attempt\x20to\x20update\x20settings','new-disabled','jsonwebtoken','getPortfolio','split','event','SIGINT','allow','showname','logs','onText','sendMessage','Notifications\x20enabled','generate','bbUsername','get-starting-balances','user','getHours','parse','telegramChatId','get','access\x20timeout','/output-000.log','bbvReceive','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','cancelLoading','readFileSync','2FA','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Unauthorized\x20attempt\x20to\x20update\x20bot','forEach','bb/','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','generateKeyPairAsync','Orders','delete-bot','\x20(1)','Notifications\x20enabled\x0a','storeConfiguration','yargs/yargs','callback_query','/:bot/performance','Unauthorized\x20attempt\x20to\x20log\x20out','disabled','listen','-config.json','settings','0.0.0','latestversion','sortBy','/restart\x20-\x20restart\x20bot(s)\x0a','success','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Bot\x20','catch','expiry','decrypt','Error:\x20Invalid\x20argument\x20','2FA\x20required','length','Invalid\x20username\x20or\x20IP\x20address','keys','getMinutes','headless','disconnect','simple','15\x20min','Notifications\x20disabled','output-002.log','secure','\x20>\x20','send','telegramToken','replace','DEFLATE','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','file','Unauthorized\x20attempt\x20to\x20delete\x20bot','\x20mode','/help\x20-\x20show\x20available\x20commands\x0a','delete-alerts','exit','blacklist','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','backup/','env','\x20|\x20','socket','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','botmanager','RSA','createServer','Unauthorized\x20attempt\x20to\x20download\x20','\x20only\x0a','index.html','getDate','*$1*','Unauthorized\x20attempt\x20to\x20confirm\x20message','write','sign','socket.io','/:bot/coins','args','publicKey','padStart','3762530OKfTNS','manual','error\x20while\x20deleting\x20config\x20files:\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','includes','yes','telegramUsername','port','alias','answerCallbackQuery','axios','Password\x20has\x20been\x20reset\x20to:\x20','stopped','lastmsgemitted','get-portfolio','login\x20token\x20generated',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','(((.+)+)+)+$','remoteAddress','value','auto','path','argv','/status\x20-\x20show\x20bot(s)\x20status\x0a','/disable\x20-\x20disable\x20notifications\x0a','Invalid\x20IP\x20address','Login\x20accepted','All\x20bots','static','stop','data','zip/','full','-----------------------------------------------------------------------------------','</b>\x20?','bb-secure.json','inherit','User\x20has\x20been\x20validated','stringify','telegramEnabled','reject','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','telegrammsg','assign','output-003.log','/:bot/history','Login\x20rejected','kill','ipaddr.js','push','bbvNew','max','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','verify','store','hasOwnProperty','getSeconds','toString','hybrid-crypto-js','match','bb-config.json','telegramEvents','apply','3687698QrECpE','Crypt','chat','.zip','bcryptjs','store-settings','Invalid\x20authentication\x20token\x20(1)','copyFileSync','startsWith','test','error','All','757989HESsgk','Ok,\x20will\x20send\x20order\x20notifications\x20only','/:bot/configuration','use','format','once','2FA\x20login\x20token\x20generated','uuid','referer','temporary\x20access\x20timeout','timestamp','compareSync','sha256',':\x20Bot\x20Mgr\x20>\x20','reset-password','isIPv4MappedAddress','alerts','crypto','build2','exec','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','from','bot','hashSync','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','f2aRequired','cancel-loading','emitHistory','lastmsgtelegram','api-eu.mixpanel.com','getFullYear','function','Ok,\x20will\x20send\x20alert\x20notifications\x20only','getMonth','/names\x20-\x20show\x20bot\x20names\x0a','Yes','search','1000','graphql-request','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','headers','child_process','https://api.ipify.org?format=json','127.0.0.1','SIGTERM','update-bb','auth','hex','reload','telegram','output-001.log','telegram2FaApproval','Unauthorized\x20login\x20attempt\x20(timeout)','************','emit','logout','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','/:bot/portfolio','203204BRRUyQ','confirm-message','restarting\x20Bot\x20','express','toggle-bot-mode','message','uncaughtException','node-telegram-bot-api','2FA\x20login\x20required','add','Unauthorized\x20attempt\x20to\x20get\x20logs','find','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','cloneDeep','orders','RSA-OAEP','Alerts','unlinkSync','mode','clientip','enabled','Token\x20blacklisted','kind','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','reason','number','params','userid','token','createWriteStream','pidRefreshToken','isDirectory','randomFillSync','messages','6b67f3d61ee94b8f5c80b4affef4c4d9','type','encryptedUuid','new','bots','toggleBotMode','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','uuid-random','live','placeOrder','sendFile','Invalid\x20Telegram\x20token','stopPolling','/on\x20-\x20start\x20bot(s)\x0a','temporary\x20token\x20generated','Markdown','9etvlUl','writeFileSync','show','accept','then','status','download','build','handshake','/enable\x20-\x20enable\x20notifications\x0a','timeshift','<b>Balance\x20Bot\x20Status:</b>\x0a','version.json','invalid\x20credentials','bot-','sendPortfolioTelegram','settings.','log','login\x20required','-performance.json','apiKey','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','config/','username','connection','backup'];_0x30d7=function(){return _0x432257;};return _0x30d7();}function isNewerVersion(_0x47a950,_0x3a5ff1){const _0x46906b=_0x3d19d6,_0x584ff3=_0x3a5ff1[_0x46906b(0x20c)]('.'),_0x1e505e=_0x47a950[_0x46906b(0x20c)]('.');for(var _0x592309=0x0;_0x592309<_0x1e505e['length'];_0x592309++){const _0x55e428=~~_0x1e505e[_0x592309],_0x29a2bd=~~_0x584ff3[_0x592309];if(_0x55e428>_0x29a2bd)return!![];if(_0x55e428<_0x29a2bd)return![];}return![];}function toTelegramMarkdown(_0x3ae6b5){const _0x38f88c=_0x3d19d6,_0x47d6b5=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x143444=/\*{2}(.+?)\*{2}/gim;return _0x3ae6b5=_0x3ae6b5['replace'](_0x47d6b5,'$1_$2_$3')[_0x38f88c(0xc8)](_0x143444,_0x38f88c(0xe1)),_0x3ae6b5;}async function validateConfigFile(){const _0x2f17b3=_0x3d19d6,_0x3fe7a6=dbConfig[_0x2f17b3(0x21c)]('bots')[_0x2f17b3(0x23b)](_0x2f17b3(0x1c1))[_0x2f17b3(0xfd)]()||[];if(_0x3fe7a6[_0x2f17b3(0xba)]==0x0){let _0xa4b212=0x0,_0x2cf87c=[];const _0x2a4676=/^bot-([0-9]{3})-config.json$/,_0x25188c=fs[_0x2f17b3(0x1da)](configpath);_0x25188c[_0x2f17b3(0x228)](_0x13bad6=>{const _0x38ccc0=_0x2f17b3,_0x42f0cf=_0x2a4676[_0x38ccc0(0x149)](_0x13bad6);if(_0x42f0cf){const _0x5e6581=_0x42f0cf[0x1];let _0x29714d=getBotAttributes(_0x5e6581);_0x2cf87c[_0x38ccc0(0x11c)]({'botID':_0x5e6581,'botname':_0x29714d[_0x38ccc0(0x1c7)],'status':_0x38ccc0(0x235),'live':'stopped'}),_0xa4b212++;}}),_0xa4b212!=0x0&&(dbConfig[_0x2f17b3(0x21c)](_0x2f17b3(0x197))[_0x2f17b3(0x116)](_0x2cf87c)[_0x2f17b3(0xe3)](),config=_0x2cf87c,restoredConfigFile=_0xa4b212);}}async function restoreConfigNotify(_0x52e1f8){const _0x56128b=_0x3d19d6;let _0x3b03bc;if(restoredConfigFile==0x1)_0x3b03bc=_0x56128b(0xca);else _0x3b03bc=_0x56128b(0xd9);if(_0x52e1f8)io['to'](_0x56128b(0xda))['emit'](_0x56128b(0x1d2),_0x3b03bc);else{logger[_0x56128b(0xc0)](_0x56128b(0x10b)),logger[_0x56128b(0xc0)](_0x3b03bc),logger[_0x56128b(0xc0)](_0x56128b(0x10b)),logger[_0x56128b(0xc0)]('');if(tgBot&&settings[_0x56128b(0x21b)]&&settings[_0x56128b(0x128)]!='orders')tgBot[_0x56128b(0x213)](settings[_0x56128b(0x21b)],'Bot\x20Mgr\x20>\x20'+_0x3b03bc)[_0x56128b(0x241)](_0xd88eb3=>{telegramError(_0xd88eb3);});}}function validateCredentials(_0x3cf1d1,_0x134ccc){const _0x117b7d=_0x3d19d6;if(_0x3cf1d1[_0x117b7d(0x1bb)]==settings['bbUsername']&&bcrypt[_0x117b7d(0x141)](_0x3cf1d1['password'],settings[_0x117b7d(0x1fe)])){if(settings[_0x117b7d(0x14f)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x976146=generateLoginToken(_0x134ccc);return{'allow':!![],'reason':_0x117b7d(0xf9),'token':_0x976146};}}else return{'allow':![],'reason':_0x117b7d(0x1b0),'token':null};}function refreshToken(_0x11c521){const _0x47aa54=_0x3d19d6,_0x150536=generateLoginToken(_0x11c521);return{'allow':!![],'reason':_0x47aa54(0xf9),'token':_0x150536};}function validateAccess(_0x825051,_0x31188c,_0x276f9e){const _0x1a9e94=_0x3d19d6,_0x447934=_0x276f9e?_0x276f9e:devices[_0x31188c]['ip'];let _0x58d95d;const _0x1d02c1=_0x19ae6a=>{const _0x27b696=_0x14ad;if(settings['loginRequired']){if(settings[_0x27b696(0x14f)]){if(telegram2FaApproved(_0x31188c)){const _0x1adda0=generateLoginToken(_0x31188c);return{'allow':!![],'reason':_0x27b696(0x13c),'token':_0x1adda0};}else return{'allow':![],'reason':_0x27b696(0x1b5),'token':null};}else return _0x58d95d=validToken(_0x19ae6a,_0x31188c),_0x58d95d['hasOwnProperty'](_0x27b696(0x23d))?{'allow':!![],'reason':_0x27b696(0x202),'token':_0x19ae6a}:{'allow':![],'reason':_0x27b696(0x1b5),'token':null};}else return{'allow':!![],'reason':_0x27b696(0x1f9),'token':null};};if(settings[_0x1a9e94(0x1f5)]){let _0x25c169=[...settings[_0x1a9e94(0x1cf)],_0x1a9e94(0x1c6),'::ffff:127.0.0.1',_0x1a9e94(0x161)];if(_0x25c169[_0x1a9e94(0xee)](_0x447934))return _0x1d02c1(_0x825051);else{_0x58d95d=validToken(_0x825051,_0x31188c);if(_0x58d95d[_0x1a9e94(0x122)](_0x1a9e94(0x23d)))return _0x1d02c1(_0x825051);else{if(telegramIpApproved(_0x31188c)){const _0xa3606=generateToken(_0x31188c);return _0x58d95d=_0x1d02c1(_0x825051),_0x58d95d[_0x1a9e94(0x20f)]?{'allow':!![],'reason':_0x1a9e94(0x1a1),'token':_0xa3606}:_0x58d95d;}else return settings[_0x1a9e94(0x1d6)]?{'allow':![],'reason':_0x1a9e94(0x245),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x1d02c1(_0x825051);}function timelyDecrypt(_0x4cc285,_0x2a15ed=!![]){const _0xa4f196=_0x3d19d6;if(_0x4cc285)try{const _0x36c3fa=crypt[_0xa4f196(0x243)](secure[_0xa4f196(0x1d3)],_0x4cc285)[_0xa4f196(0x175)],_0x13a20d=_0x36c3fa[_0xa4f196(0x20c)]('@')[0x0],_0x23a129=_0x36c3fa[_0xa4f196(0x20c)]('@')[0x1],_0xea847e=new Date()[_0xa4f196(0x203)]();if(_0x2a15ed){if(_0xea847e-_0x23a129<maxSecretAge*0x3e8)return _0x13a20d;else return![];}else return _0x13a20d;}catch(_0x2121db){return![];}else return![];}const validToken=(_0x31a83e,_0x8265dc)=>{const _0x123309=_0x3d19d6,_0x56b3f0=devices[_0x8265dc]['ip'];if(!_0x31a83e)return{'error':_0x123309(0x205)};for(let _0x5bd904 of blacklist){if(_0x5bd904['token']==_0x31a83e)return{'error':_0x123309(0x186)};}let _0x1019ef;try{_0x1019ef=jwt[_0x123309(0x120)](_0x31a83e,secure[_0x123309(0x1cc)]+_0x8265dc);}catch{return{'error':_0x123309(0x130)};}if(!_0x1019ef[_0x123309(0x122)](_0x123309(0x184))&&!_0x1019ef[_0x123309(0x122)]('username')||!_0x1019ef['hasOwnProperty']('exp'))return{'error':_0x123309(0x1be)};if(!_0x1019ef[_0x123309(0x122)](_0x123309(0x1bb))&&_0x1019ef[_0x123309(0x122)](_0x123309(0x184))){const {clientip:_0x1c1997}=_0x1019ef;return _0x56b3f0==_0x1c1997?{'success':_0x123309(0x10f)}:{'error':_0x123309(0x103)};}else{if(_0x1019ef[_0x123309(0x122)]('username')&&_0x1019ef[_0x123309(0x122)](_0x123309(0x184))){const {username:_0x55cdf5,clientip:_0xac63d6}=_0x1019ef;return settings[_0x123309(0x216)]==_0x55cdf5&&_0x56b3f0==_0xac63d6?{'success':_0x123309(0x10f)}:{'error':_0x123309(0xbb)};}}},generateLoginToken=_0x156fc3=>{const _0x45000e=_0x3d19d6;if(_0x156fc3){const _0x38d54b=devices[_0x156fc3]['ip'];return jwt[_0x45000e(0xe4)]({'username':settings['bbUsername'],'clientip':_0x38d54b},secure['secret']+_0x156fc3,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xb0ad1a=>{const _0x5d423f=_0x3d19d6;if(_0xb0ad1a){const _0x533aef=devices[_0xb0ad1a]['ip'];return jwt[_0x5d423f(0xe4)]({'clientip':_0x533aef},secure[_0x5d423f(0x1cc)]+_0xb0ad1a,{'expiresIn':devices[_0xb0ad1a][_0x5d423f(0x1de)][_0x5d423f(0x242)]*0x3c});}else return![];},telegramIpApproved=_0x339bab=>{const _0xc6b4df=_0x3d19d6;let _0x2384a5=![];return devices[_0x339bab][_0xc6b4df(0x1de)]&&devices[_0x339bab][_0xc6b4df(0x1de)][_0xc6b4df(0x242)]!='reject'&&(_0x2384a5=devices[_0x339bab][_0xc6b4df(0x1de)][_0xc6b4df(0x184)]==devices[_0x339bab]['ip']&&new Date()[_0xc6b4df(0x203)]()-devices[_0x339bab][_0xc6b4df(0x1de)][_0xc6b4df(0x140)]<devices[_0x339bab][_0xc6b4df(0x1de)][_0xc6b4df(0x242)]*0x3c*0x3e8),_0x2384a5;},telegram2FaApproved=_0x52e68c=>{const _0x5d96d3=_0x3d19d6;let _0x121869=![];return devices[_0x52e68c][_0x5d96d3(0x169)]&&devices[_0x52e68c]['telegram2FaApproval']['expiry']!=_0x5d96d3(0x112)&&(_0x121869=devices[_0x52e68c][_0x5d96d3(0x169)]['clientip']==devices[_0x52e68c]['ip']&&new Date()['getTime']()-devices[_0x52e68c][_0x5d96d3(0x169)][_0x5d96d3(0x140)]<devices[_0x52e68c][_0x5d96d3(0x169)][_0x5d96d3(0x242)]*0x3c*0x3e8),_0x121869;},normalizeIP=_0x235b8b=>{const _0xc348ac=_0x3d19d6;let _0x365a9f=null,_0x367878=null;if(ipaddr['isValid'](_0x235b8b)){const _0x17573a=ipaddr[_0xc348ac(0x21a)](_0x235b8b);_0x17573a[_0xc348ac(0x187)]()==='ipv6'?(_0x17573a[_0xc348ac(0x145)]()&&(_0x365a9f=_0x17573a['toIPv4Address']()[_0xc348ac(0x124)]()),_0x367878=_0x17573a['toString']()):(_0x365a9f=_0x17573a[_0xc348ac(0x124)](),_0x367878=_0x17573a['toIPv4MappedAddress']()['toString']());}return{'show':_0x365a9f?_0x365a9f:_0x367878,'store':_0x367878};};function sleep(_0x1fc249){return new Promise(_0x5abcf0=>setTimeout(_0x5abcf0,_0x1fc249));}