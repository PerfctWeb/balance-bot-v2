const _0x2acf75=_0x485e;(function(_0x54a909,_0x1399d5){const _0x3e8b83=_0x485e,_0xfd5ee9=_0x54a909();while(!![]){try{const _0x498221=parseInt(_0x3e8b83(0x1af))/0x1*(parseInt(_0x3e8b83(0x2de))/0x2)+-parseInt(_0x3e8b83(0x20f))/0x3*(parseInt(_0x3e8b83(0x1e0))/0x4)+parseInt(_0x3e8b83(0x1f9))/0x5+-parseInt(_0x3e8b83(0x2c5))/0x6*(-parseInt(_0x3e8b83(0x258))/0x7)+-parseInt(_0x3e8b83(0x19f))/0x8+parseInt(_0x3e8b83(0x1ad))/0x9+parseInt(_0x3e8b83(0x295))/0xa*(-parseInt(_0x3e8b83(0x257))/0xb);if(_0x498221===_0x1399d5)break;else _0xfd5ee9['push'](_0xfd5ee9['shift']());}catch(_0x5112d9){_0xfd5ee9['push'](_0xfd5ee9['shift']());}}}(_0x419f,0x331d1));const _0x3a7933=function(){let _0x5be63f=!![];return function(_0x138822,_0x3bb390){const _0xc62447=_0x5be63f?function(){if(_0x3bb390){const _0x569a5e=_0x3bb390['apply'](_0x138822,arguments);return _0x3bb390=null,_0x569a5e;}}:function(){};return _0x5be63f=![],_0xc62447;};}(),_0x2ae383=_0x3a7933(this,function(){const _0x15e0b1=_0x485e;return _0x2ae383[_0x15e0b1(0x2ae)]()[_0x15e0b1(0x20d)](_0x15e0b1(0x147))[_0x15e0b1(0x2ae)]()[_0x15e0b1(0x129)](_0x2ae383)['search'](_0x15e0b1(0x147));});_0x2ae383();'use strict';process[_0x2acf75(0x15e)][_0x2acf75(0x209)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x2acf75(0x22e)),low=require(_0x2acf75(0x2cb)),FileSync=require(_0x2acf75(0x2d6)),path=require(_0x2acf75(0x2b9)),crypto=require(_0x2acf75(0x1fc)),Crypt=require('hybrid-crypto-js')[_0x2acf75(0x29a)],RSA=require(_0x2acf75(0x2f1))[_0x2acf75(0x27c)],bcrypt=require(_0x2acf75(0x156)),jwt=require(_0x2acf75(0x210)),ipaddr=require(_0x2acf75(0x269)),argv=require(_0x2acf75(0x175))(process[_0x2acf75(0x1b4)][_0x2acf75(0x1f5)](0x2))[_0x2acf75(0x1b4)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x2acf75(0x13f)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x2acf75(0x157)),util=require(_0x2acf75(0x1ea)),fileUpload=require(_0x2acf75(0x24e)),PORT=argv[_0x2acf75(0x179)]||_0x2acf75(0x1c6),pattern=/^[0-9]{2,4}$/;!pattern[_0x2acf75(0x15d)](PORT)&&(console['log'](_0x2acf75(0x266)+PORT+_0x2acf75(0x224)),process['exit'](0x1));const HOST=argv[_0x2acf75(0x2e7)]||null,userID=argv[_0x2acf75(0x2d0)]||'',debugging=argv['d']||![];let bbpath=_0x2acf75(0x29f),bbpath2='';const botfile=_0x2acf75(0x181),configfile='bb-config.json',settingsfile=_0x2acf75(0x2e0),securefile=_0x2acf75(0x245),maxBackups=0xa;let validInstallation=!![];!fs[_0x2acf75(0x12a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2acf75(0x174)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x2acf75(0x290),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x2acf75(0x29b)+userID+'/':bbpath+_0x2acf75(0x29b),zippath=userID?bbpath+_0x2acf75(0x256)+userID+'/':bbpath+_0x2acf75(0x256),loggerfile=fs[_0x2acf75(0x1a0)](logspath+_0x2acf75(0x2a6),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x2acf75(0x1d9);!fs[_0x2acf75(0x12a)](configpath)&&fs[_0x2acf75(0x236)](configpath);!fs[_0x2acf75(0x12a)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x2acf75(0x12a)](logspath)&&fs[_0x2acf75(0x236)](logspath);!fs[_0x2acf75(0x12a)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x2acf75(0x12a)](temppath)&&fs[_0x2acf75(0x236)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2acf75(0x1d5)]({'bots':[]})[_0x2acf75(0x23d)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2acf75(0x1d5)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x2acf75(0x23d)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2acf75(0x1d5)]({'secure':{},'blacklist':[]})[_0x2acf75(0x23d)]();let crypt=new Crypt({'md':_0x2acf75(0x142),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x2acf75(0x244)](_0x2acf75(0x1b5),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2acf75(0x2b0)]&&settings[_0x2acf75(0x2b0)]!=''&&settings[_0x2acf75(0x1eb)]&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x11d626=>{const _0x41d37c=_0x2acf75;console[_0x41d37c(0x126)](_0x11d626);},'simple':_0x5c4bc3=>{const _0xffbd77=_0x2acf75;console[_0xffbd77(0x126)](_0x5c4bc3),loggerfile[_0xffbd77(0x23d)](util[_0xffbd77(0x265)](_0x5c4bc3)+'\x0a');},'full':async _0x36e298=>{const _0x16bb9a=_0x2acf75,_0x55892e=getTimeStamp()+_0x16bb9a(0x2a1)+_0x36e298;console[_0x16bb9a(0x126)](_0x55892e),loggerfile[_0x16bb9a(0x23d)](util[_0x16bb9a(0x265)](_0x55892e)+'\x0a');if(tgBot&&settings[_0x16bb9a(0x273)]&&settings['telegramEvents']!='orders')await tgBot['sendMessage'](settings[_0x16bb9a(0x273)],_0x16bb9a(0x19c)+_0x36e298)[_0x16bb9a(0x1ae)](_0x5cf3ab=>{telegramError(_0x5cf3ab);});},'debug':async(_0x280986,_0x462bd1='')=>{const _0x459a7f=_0x2acf75,_0x43ba80=getTimeStamp()+_0x459a7f(0x229)+_0x280986;if(debugging)console[_0x459a7f(0x126)](_0x43ba80);loggerfile['write'](util[_0x459a7f(0x265)](_0x43ba80)+'\x0a');if(_0x462bd1){if(debugging)console['log'](_0x462bd1);loggerfile[_0x459a7f(0x23d)](util['format'](_0x462bd1)+'\x0a');}}};process['on']('uncaughtException',function(_0xf9a924){const _0x4877c1=_0x2acf75;logger[_0x4877c1(0x132)](_0xf9a924);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2acf75(0x144))[_0x2acf75(0x2ef)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2acf75(0x192)),app=express(),http=require(_0x2acf75(0x186))[_0x2acf75(0x1ee)](app);app[_0x2acf75(0x1c8)](fileUpload({'useTempFiles':!![]})),app[_0x2acf75(0x183)](_0x2acf75(0x235),async(_0x16298e,_0x4a32d4)=>{const _0x3d8e3d=_0x2acf75,_0x948fc1=_0x16298e[_0x3d8e3d(0x262)][_0x3d8e3d(0x247)],_0xf559ee=getClientsWithBotID(_0x3d8e3d(0x275)),_0x70aa12=_0x16298e[_0x3d8e3d(0x1d2)][_0x3d8e3d(0x15c)],_0x645444=timelyDecrypt(_0x70aa12,![]),_0x46496d=_0xf559ee[_0x3d8e3d(0x2d7)](_0x2a11c2=>_0x2a11c2[_0x3d8e3d(0x15c)]==_0x645444);if(_0x46496d){const _0x331812=normalizeIP(_0x16298e[_0x3d8e3d(0x25c)]['remoteAddress'])[_0x3d8e3d(0x2cd)],_0x47c39a=_0x16298e[_0x3d8e3d(0x1d2)][_0x3d8e3d(0x2b5)];if(validateAccess(_0x47c39a,_0x645444,_0x331812)[_0x3d8e3d(0x1c9)])_0x948fc1=='backup'&&await backupConfigFiles(),await zipFiles(_0x948fc1),_0x4a32d4[_0x3d8e3d(0x25b)](zippath+(_0x948fc1+_0x3d8e3d(0x2bf)),_0x2e524c=>{const _0x2bf852=_0x3d8e3d;_0x2e524c&&(logger['full'](_0x2bf852(0x288)+_0x948fc1),logger[_0x2bf852(0x132)](_0x2e524c));});else logger[_0x3d8e3d(0x172)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x948fc1+'\x20(1)');}else logger[_0x3d8e3d(0x172)](_0x3d8e3d(0x2be)+_0x948fc1+_0x3d8e3d(0x2bd));}),app[_0x2acf75(0x222)](_0x2acf75(0x169),async(_0x539ccf,_0x33eb35)=>{const _0x57277b=_0x2acf75,_0x1ea9b4=getClientsWithBotID('botmanager'),_0x547ae2=_0x539ccf[_0x57277b(0x1d2)]['uuid'],_0x5b0b3c=timelyDecrypt(_0x547ae2,![]),_0x5457d2=_0x1ea9b4[_0x57277b(0x2d7)](_0x497a68=>_0x497a68[_0x57277b(0x15c)]==_0x5b0b3c);logger['debug'](_0x57277b(0x121));if(_0x5457d2){const _0x2d68e6=normalizeIP(_0x539ccf[_0x57277b(0x25c)][_0x57277b(0x232)])[_0x57277b(0x2cd)],_0x27608f=_0x539ccf['headers'][_0x57277b(0x2b5)];if(validateAccess(_0x27608f,_0x5b0b3c,_0x2d68e6)[_0x57277b(0x1c9)]){if(_0x539ccf[_0x57277b(0x27d)]){const _0x35da9d=_0x539ccf[_0x57277b(0x27d)][_0x57277b(0x162)];await _0x35da9d['mv'](temppath+_0x35da9d[_0x57277b(0x280)]),_0x33eb35[_0x57277b(0x2ea)]({'status':!![],'message':'File\x20uploaded'});const _0x436cfa=getBotsWithMode();_0x436cfa[_0x57277b(0x1d3)]>0x0?confirmRestore(temppath,_0x35da9d[_0x57277b(0x280)]):unzipFile(temppath,_0x35da9d[_0x57277b(0x280)]);}}else logger[_0x57277b(0x172)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x57277b(0x172)](_0x57277b(0x25a));}),app[_0x2acf75(0x1c8)](express[_0x2acf75(0x2d8)](path['join'](__dirname,bbpath2,_0x2acf75(0x149)))),app[_0x2acf75(0x1c8)](express[_0x2acf75(0x2d8)](path[_0x2acf75(0x22b)](__dirname,bbpath2,_0x2acf75(0x196)))),app[_0x2acf75(0x183)]('/',function(_0x885cee,_0x52bb2c){const _0x22237d=_0x2acf75;_0x52bb2c[_0x22237d(0x282)](path[_0x22237d(0x22b)](__dirname,bbpath2,'build2',_0x22237d(0x2f2)));}),app[_0x2acf75(0x183)]('/:bot',function(_0x395097,_0x3597ca){const _0x29f624=_0x2acf75;_0x3597ca[_0x29f624(0x282)](path[_0x29f624(0x22b)](__dirname,bbpath2,_0x29f624(0x196),_0x29f624(0x2f2)));}),app['get']('/:bot/portfolio',(_0x2fdbdb,_0x5ebf71)=>{const _0x114451=_0x2acf75;_0x5ebf71['sendFile'](path[_0x114451(0x22b)](__dirname,bbpath2,_0x114451(0x196),_0x114451(0x2f2)));}),app[_0x2acf75(0x183)](_0x2acf75(0x2e1),(_0x3defcb,_0x1211d0)=>{const _0x248963=_0x2acf75;_0x1211d0['sendFile'](path[_0x248963(0x22b)](__dirname,bbpath2,_0x248963(0x196),'index.html'));}),app[_0x2acf75(0x183)](_0x2acf75(0x2c1),(_0x4f5007,_0x442919)=>{const _0x21c033=_0x2acf75;_0x442919[_0x21c033(0x282)](path['join'](__dirname,bbpath2,_0x21c033(0x196),_0x21c033(0x2f2)));}),app[_0x2acf75(0x183)](_0x2acf75(0x24b),(_0x4c5807,_0x7bcc72)=>{const _0x146fc3=_0x2acf75;_0x7bcc72[_0x146fc3(0x282)](path[_0x146fc3(0x22b)](__dirname,bbpath2,_0x146fc3(0x196),_0x146fc3(0x2f2)));}),app[_0x2acf75(0x183)](_0x2acf75(0x18e),(_0x5c0d8c,_0x8de9d6)=>{const _0x3b32ce=_0x2acf75;_0x8de9d6[_0x3b32ce(0x282)](path[_0x3b32ce(0x22b)](__dirname,bbpath2,_0x3b32ce(0x196),'index.html'));}),app[_0x2acf75(0x183)](_0x2acf75(0x237),(_0x54b4ad,_0x5c2778)=>{const _0x47f7a9=_0x2acf75;_0x5c2778[_0x47f7a9(0x282)](path['join'](__dirname,bbpath2,_0x47f7a9(0x196),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x2acf75(0x195))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x574884=_0x2acf75;logger[_0x574884(0x132)](''),logger[_0x574884(0x132)](_0x574884(0x1b8)),await logger['full']('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),logger[_0x574884(0x132)]('-----------------------------------------------------------------------------------');if(config[_0x574884(0x1d3)]!=0x0)for(const _0x329c71 of config){if(_0x329c71['status']==_0x574884(0x134)||_0x329c71[_0x574884(0x205)]==_0x574884(0x2a3))await logger['full'](_0x574884(0x260)+_0x329c71[_0x574884(0x2a2)]+_0x574884(0x1fe)+_0x329c71[_0x574884(0x2c3)]),startBot([_0x329c71[_0x574884(0x2a2)],userID],{'cwd':bbpath},function(_0x13da91){if(_0x13da91)logger['full'](_0x13da91);});else(_0x329c71[_0x574884(0x205)]==_0x574884(0x1a7)||_0x329c71[_0x574884(0x205)]==_0x574884(0x2d1))&&await logger[_0x574884(0x172)](_0x574884(0x271)+_0x329c71[_0x574884(0x2a2)]+_0x574884(0x1fe)+_0x329c71['botname']);}else!newBot&&logger[_0x574884(0x132)](_0x574884(0x1c7));if(newBot)addBot();logger[_0x574884(0x132)](_0x574884(0x1b8)),logger[_0x574884(0x132)]('');}function startSocket(){const _0x486024=_0x2acf75;io['on'](_0x486024(0x16e),_0x39e9cb=>{const _0x54bdf3=_0x486024;let _0x1758ce,_0x135318,_0x3fcc7d,_0x5d6370,_0x2ef597;const _0xa23f00=_0x39e9cb[_0x54bdf3(0x219)][_0x54bdf3(0x1d2)][_0x54bdf3(0x136)];_0x135318=_0xa23f00[_0x54bdf3(0x1d8)](/bot[0-9]{3}/);if(_0x135318)_0x3fcc7d=_0x135318[0x0][_0x54bdf3(0x1d8)](/[0-9]{3}/);if(_0x3fcc7d)_0x1758ce=_0x3fcc7d[0x0];else _0x1758ce='botmanager';const _0x304020=_0x39e9cb[_0x54bdf3(0x219)][_0x54bdf3(0x27f)][_0x54bdf3(0x255)];if(!_0x304020)_0x39e9cb[_0x54bdf3(0x17b)](_0x54bdf3(0x205),{'publicKey':secure['publicKey']});else{_0x5d6370=timelyDecrypt(_0x304020,![]);if(!_0x5d6370)_0x39e9cb[_0x54bdf3(0x17b)](_0x54bdf3(0x205),{'publicKey':secure[_0x54bdf3(0x152)]});else{_0x2ef597=normalizeIP(_0x39e9cb[_0x54bdf3(0x163)][_0x54bdf3(0x232)])[_0x54bdf3(0x2cd)];if(!devices[_0x5d6370])devices[_0x5d6370]={'uuid':_0x5d6370,'access':{'token':null}};devices[_0x5d6370]['ip']=_0x2ef597;const _0x260151=addClient(_0x39e9cb['id'],_0x5d6370,_0x1758ce);setAccess(_0x260151),emitMessages(),_0x39e9cb['on'](_0x54bdf3(0x176),_0xbddf2d=>{const _0x2b283d=_0x54bdf3,_0x3f7dcd=timelyDecrypt(_0xbddf2d[_0x2b283d(0x2b3)]);if(_0x3f7dcd){_0xbddf2d={'username':_0xbddf2d['username'],'password':_0x3f7dcd},devices[_0x5d6370][_0x2b283d(0x233)]=validateCredentials(_0xbddf2d,_0x5d6370);if(devices[_0x5d6370][_0x2b283d(0x233)]['allow']==![]&&devices[_0x5d6370][_0x2b283d(0x233)][_0x2b283d(0x299)]==_0x2b283d(0x173))_0x39e9cb['emit'](_0x2b283d(0x205),{'access':devices[_0x5d6370][_0x2b283d(0x233)]}),loginAccess2FA(_0x5d6370,_0x2ef597);else{if(devices[_0x5d6370][_0x2b283d(0x233)][_0x2b283d(0x1c9)]==![]&&devices[_0x5d6370][_0x2b283d(0x233)][_0x2b283d(0x299)]=='invalid\x20credentials')_0x39e9cb[_0x2b283d(0x17b)](_0x2b283d(0x205),{'access':devices[_0x5d6370][_0x2b283d(0x233)]});else devices[_0x5d6370]['access'][_0x2b283d(0x1c9)]&&devices[_0x5d6370][_0x2b283d(0x233)][_0x2b283d(0x299)]==_0x2b283d(0x25d)&&(getClientsWithUuid(_0x5d6370)[_0x2b283d(0x2a0)](_0x3bfdf2=>{setAccess(_0x3bfdf2);}),logger[_0x2b283d(0x26b)](_0x2b283d(0x1d1)+_0x5d6370[_0x2b283d(0x1f5)](-0x8)),setTokenRefresh(_0x5d6370),setSessionTimeout('login',_0x5d6370));}}else logger['full'](_0x2b283d(0x17c));}),_0x39e9cb['on'](_0x54bdf3(0x1c2),()=>{resetPassword();}),_0x39e9cb['on'](_0x54bdf3(0x20b),_0x3bbfd6=>{removeClient(_0x39e9cb['id']);}),_0x1758ce==_0x54bdf3(0x275)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5a48ef){const _0x378c9b=_0x2acf75;if(_0x5a48ef!='botmanager'&&config[_0x378c9b(0x26f)]!=''){if(pid[_0x5a48ef])pid[_0x5a48ef][_0x378c9b(0x2ea)]({'function':_0x378c9b(0x1e1),'args':null});}_0x5a48ef!=_0x378c9b(0x275)&&broadcastToBots(_0x378c9b(0x122),JSON['stringify'](config));}function reloadBotManager(){const _0x488f88=_0x2acf75;getClientsWithBotID(_0x488f88(0x275))[_0x488f88(0x2a0)](_0x506bba=>{const _0x1b9e1c=_0x488f88;getSocket(_0x506bba['id'])[_0x1b9e1c(0x17b)](_0x1b9e1c(0x205),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x1967da){const _0x106445=_0x2acf75;return io[_0x106445(0x2ca)]['sockets'][_0x106445(0x183)](_0x1967da);}function setAccess(_0x13de15){const _0x5e98c4=_0x2acf75,_0x12793a=getSocket(_0x13de15['id']),_0x32853a=_0x13de15[_0x5e98c4(0x15c)],_0x4eccaf=_0x13de15['bot'];devices[_0x32853a]['access']=validateAccess(devices[_0x32853a][_0x5e98c4(0x233)][_0x5e98c4(0x1b1)],_0x32853a),logger[_0x5e98c4(0x26b)](_0x5e98c4(0x26a)+devices[_0x32853a][_0x5e98c4(0x233)][_0x5e98c4(0x299)]+_0x5e98c4(0x2ee)+_0x13de15['id'][_0x5e98c4(0x1f5)](-0x8)+'\x20|\x20user:\x20...'+_0x32853a[_0x5e98c4(0x1f5)](-0x8)),_0x12793a[_0x5e98c4(0x22b)](_0x32853a);if(devices[_0x32853a][_0x5e98c4(0x233)]['allow']){_0x12793a[_0x5e98c4(0x22b)](_0x4eccaf);if(_0x4eccaf=='botmanager')initializeSocketBotManager(_0x12793a);else initializeSocketBot(_0x12793a);initClient(_0x4eccaf);}devices[_0x32853a][_0x5e98c4(0x233)][_0x5e98c4(0x1b1)]&&devices[_0x32853a][_0x5e98c4(0x233)]['reason']==_0x5e98c4(0x296)&&setSessionTimeout(_0x5e98c4(0x286),_0x32853a),devices[_0x32853a][_0x5e98c4(0x233)]['token']&&devices[_0x32853a][_0x5e98c4(0x233)][_0x5e98c4(0x299)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x5e98c4(0x176),_0x32853a),_0x12793a['emit'](_0x5e98c4(0x205),{'status':_0x13de15[_0x5e98c4(0x216)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x32853a][_0x5e98c4(0x233)],'externalip':devices[_0x32853a]['ip'],'publicKey':secure[_0x5e98c4(0x152)],'userid':settings[_0x5e98c4(0x201)],'validInstallation':validInstallation}),devices[_0x32853a][_0x5e98c4(0x233)][_0x5e98c4(0x1c9)]==![]&&devices[_0x32853a][_0x5e98c4(0x233)][_0x5e98c4(0x299)]==_0x5e98c4(0x18b)&&temporaryAccess2FA(_0x32853a,devices[_0x32853a]['ip']);}function setSessionTimeout(_0x29e7d1,_0x4d9b81){const _0x2d7d77=_0x2acf75;let _0x422291;if(_0x29e7d1=='login')_0x422291=loginExpiry*0x3c*0x3e8;else _0x422291=devices[_0x4d9b81][_0x2d7d77(0x25f)][_0x2d7d77(0x1cd)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x4d9b81]['telegramIpApproval'][_0x2d7d77(0x1f3)]);if(devices[_0x4d9b81][_0x2d7d77(0x2c7)])clearTimeout(devices[_0x4d9b81][_0x2d7d77(0x2c7)]);devices[_0x4d9b81]['pidExpireLogin']=setTimeout(()=>{const _0x290027=_0x2d7d77;if(devices[_0x4d9b81][_0x290027(0x2a9)])clearTimeout(devices[_0x4d9b81][_0x290027(0x2a9)]);removeSocketListeners(_0x4d9b81),addBlacklist(_0x4d9b81),devices[_0x4d9b81][_0x290027(0x25f)]=null,devices[_0x4d9b81][_0x290027(0x193)]=null,devices[_0x4d9b81]['access']['token']=null,logger[_0x290027(0x26b)]('Session\x20expired\x20for\x20user\x20...'+_0x4d9b81[_0x290027(0x1f5)](-0x8)),devices[_0x4d9b81][_0x290027(0x233)]=validateAccess(devices[_0x4d9b81][_0x290027(0x233)][_0x290027(0x1b1)],_0x4d9b81),!(devices[_0x4d9b81][_0x290027(0x233)][_0x290027(0x1c9)]&&devices[_0x4d9b81][_0x290027(0x233)][_0x290027(0x299)]==_0x290027(0x242))&&(_0x29e7d1==_0x290027(0x176)?io['to'](_0x4d9b81)['emit'](_0x290027(0x205),{'access':{'allow':![],'reason':_0x290027(0x1aa),'token':null}}):io['to'](_0x4d9b81)['emit'](_0x290027(0x205),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4d9b81][_0x290027(0x233)][_0x290027(0x1b1)]=null;},_0x422291);}function setTokenRefresh(_0xa52ef6){const _0x4cdeb8=_0x2acf75;if(devices[_0xa52ef6][_0x4cdeb8(0x2a9)])clearTimeout(devices[_0xa52ef6]['pidRefreshToken']);devices[_0xa52ef6][_0x4cdeb8(0x2a9)]=setTimeout(()=>{const _0x2aee78=_0x4cdeb8;getClientsWithUuid(_0xa52ef6)[_0x2aee78(0x1d3)]!=0x0?(devices[_0xa52ef6][_0x2aee78(0x233)]=refreshToken(_0xa52ef6),io['to'](_0xa52ef6)[_0x2aee78(0x17b)](_0x2aee78(0x205),{'status':_0x2aee78(0x1b9),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xa52ef6][_0x2aee78(0x233)],'externalip':devices[_0xa52ef6]['ip'],'publicKey':secure[_0x2aee78(0x152)],'validInstallation':validInstallation}),setTokenRefresh(_0xa52ef6)):clearTimeout(devices[_0xa52ef6]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4d5301){const _0x38daee=_0x2acf75,_0x4726d2=getClient(_0x4d5301['id'])[_0x38daee(0x15c)];_0x4d5301[_0x38daee(0x17b)]('bots',config),_0x4d5301[_0x38daee(0x17b)]('settings',cleanSettings()),_0x4d5301['on'](_0x38daee(0x137),_0x198595=>{const _0x207fd4=_0x38daee;if(validateAccess(_0x198595,_0x4726d2)[_0x207fd4(0x1c9)])addBot();else logger[_0x207fd4(0x172)](_0x207fd4(0x231));}),_0x4d5301['on']('update-bot',(_0x5ca454,_0x55fe8b)=>{const _0x82a2a9=_0x38daee;if(validateAccess(_0x55fe8b,_0x4726d2)[_0x82a2a9(0x1c9)])toggleBot(_0x5ca454[_0x82a2a9(0x2a2)],_0x5ca454[_0x82a2a9(0x205)],_0x5ca454['live']);else logger[_0x82a2a9(0x172)](_0x82a2a9(0x150));}),_0x4d5301['on'](_0x38daee(0x207),(_0x305a85,_0x438b40)=>{const _0x4f64b8=_0x38daee;if(validateAccess(_0x438b40,_0x4726d2)[_0x4f64b8(0x1c9)])toggleBotMode(_0x305a85);else logger['full'](_0x4f64b8(0x150));}),_0x4d5301['on'](_0x38daee(0x221),(_0x290c7c,_0xa11d24)=>{const _0x4325a5=_0x38daee;if(validateAccess(_0xa11d24,_0x4726d2)['allow'])deleteBot(_0x290c7c);else logger['full'](_0x4325a5(0x155));}),_0x4d5301['on'](_0x38daee(0x2ad),(_0x423e07,_0x2cd712)=>{const _0x18f6d4=_0x38daee;if(validateAccess(_0x2cd712,_0x4726d2)[_0x18f6d4(0x1c9)])storeSettings(_0x423e07,!![]);else logger[_0x18f6d4(0x172)](_0x18f6d4(0x1dc));}),_0x4d5301['on']('update-bb',_0x58909d=>{const _0x40ef4a=_0x38daee;if(validateAccess(_0x58909d,_0x4726d2)[_0x40ef4a(0x1c9)])updateBB('update');else logger[_0x40ef4a(0x172)](_0x40ef4a(0x267));}),_0x4d5301['on'](_0x38daee(0x164),_0x3f4657=>{const _0x5f0a8f=_0x38daee;if(validateAccess(_0x3f4657,_0x4726d2)['allow'])updateBB(_0x5f0a8f(0x20a));else logger[_0x5f0a8f(0x172)](_0x5f0a8f(0x204));}),_0x4d5301['on'](_0x38daee(0x18d),_0x10dd89=>{const _0x5affce=_0x38daee;if(validateAccess(_0x10dd89,_0x4726d2)[_0x5affce(0x1c9)]){const _0x229b05=getClient(_0x4d5301['id']);if(_0x229b05)getBackupFiles(_0x229b05[_0x5affce(0x15c)]);else logger[_0x5affce(0x172)](_0x5affce(0x2a7));}else logger[_0x5affce(0x172)](_0x5affce(0x2c9));}),_0x4d5301['on']('restore-backup-file',(_0x4685d8,_0x482255)=>{const _0x273c2b=_0x38daee;if(validateAccess(_0x482255,_0x4726d2)['allow'])restoreBackupFile(_0x4685d8);else logger[_0x273c2b(0x172)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x4d5301['on'](_0x38daee(0x263),_0x2f6f99=>{const _0x2574b4=_0x38daee;if(validateAccess(_0x2f6f99,_0x4726d2)['allow'])getMessages();else logger[_0x2574b4(0x172)](_0x2574b4(0x2bc));}),_0x4d5301['on'](_0x38daee(0x1a5),(_0x229543,_0x111cc2)=>{const _0x35ba9f=_0x38daee;if(validateAccess(_0x111cc2,_0x4726d2)[_0x35ba9f(0x1c9)])confirmMessage(_0x229543);else logger[_0x35ba9f(0x172)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4d5301['on'](_0x38daee(0x240),_0xcda0d5=>{const _0x3c0647=_0x38daee;if(validateAccess(_0xcda0d5,_0x4726d2)[_0x3c0647(0x1c9)]){if(devices[_0x4726d2]['pidRefreshToken'])clearTimeout(devices[_0x4726d2][_0x3c0647(0x2a9)]);if(devices[_0x4726d2]['pidExpireLogin'])clearTimeout(devices[_0x4726d2][_0x3c0647(0x2c7)]);removeSocketListeners(getClient(_0x4d5301['id'])[_0x3c0647(0x15c)]),addBlacklist(_0x4726d2),devices[_0x4726d2][_0x3c0647(0x25f)]=null,devices[_0x4726d2][_0x3c0647(0x193)]=null,devices[_0x4726d2]['access'][_0x3c0647(0x1b1)]=null,logger[_0x3c0647(0x26b)](_0x3c0647(0x250)+_0x4726d2[_0x3c0647(0x1f5)](-0x8)),io['to'](getClient(_0x4d5301['id'])[_0x3c0647(0x15c)])[_0x3c0647(0x17b)](_0x3c0647(0x205),{'access':{'allow':![],'reason':_0x3c0647(0x1c4),'token':null}});}else logger[_0x3c0647(0x172)](_0x3c0647(0x1da));});}function initializeSocketBot(_0x3a4e30){const _0x43bd3b=_0x2acf75,_0x1e4a2b=getClient(_0x3a4e30['id'])[_0x43bd3b(0x14e)],_0x21fd48=getClient(_0x3a4e30['id'])[_0x43bd3b(0x15c)];_0x3a4e30['on']('get-logs',(_0x2f6e60,_0x173622)=>{const _0x2d673e=_0x43bd3b;if(validateAccess(_0x173622,_0x21fd48)[_0x2d673e(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x2d673e(0x2ea)]({'function':_0x2d673e(0x249),'args':_0x2f6e60});}else logger['full'](_0x2d673e(0x2e4));}),_0x3a4e30['on'](_0x43bd3b(0x18a),(_0x4a89ad,_0x4c21ff)=>{const _0x4b2331=_0x43bd3b;if(validateAccess(_0x4c21ff,_0x21fd48)[_0x4b2331(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x4b2331(0x2ea)]({'function':'deleteHistoryAlerts','args':_0x4a89ad});}else logger['full'](_0x4b2331(0x153));}),_0x3a4e30['on'](_0x43bd3b(0x297),(_0x3a6a1c,_0x54bee1)=>{const _0x4bcc4b=_0x43bd3b;if(validateAccess(_0x54bee1,_0x21fd48)[_0x4bcc4b(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x4bcc4b(0x2ea)]({'function':_0x4bcc4b(0x120),'args':_0x3a6a1c});}else logger[_0x4bcc4b(0x172)](_0x4bcc4b(0x131));}),_0x3a4e30['on'](_0x43bd3b(0x1f8),(_0x13429d,_0x2a6973)=>{const _0x17d422=_0x43bd3b;if(validateAccess(_0x2a6973,_0x21fd48)[_0x17d422(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b]['send']({'function':_0x17d422(0x20e),'args':_0x13429d});}else logger['full'](_0x17d422(0x187));}),_0x3a4e30['on'](_0x43bd3b(0x18c),(_0x66ab89,_0xaded97)=>{const _0x322c80=_0x43bd3b;if(validateAccess(_0xaded97,_0x21fd48)[_0x322c80(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x322c80(0x2ea)]({'function':_0x322c80(0x274),'args':_0x66ab89});}else logger[_0x322c80(0x172)](_0x322c80(0x188));}),_0x3a4e30['on']('store-fiat',(_0x356b12,_0x13f64c)=>{const _0x358f4c=_0x43bd3b;if(validateAccess(_0x13f64c,_0x21fd48)[_0x358f4c(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b]['send']({'function':_0x358f4c(0x16c),'args':_0x356b12});}else logger['full'](_0x358f4c(0x2db));}),_0x3a4e30['on'](_0x43bd3b(0x14b),_0x6131d0=>{const _0x59db23=_0x43bd3b;if(validateAccess(_0x6131d0,_0x21fd48)[_0x59db23(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b]['send']({'function':'resetHistory','args':null});}else logger['full'](_0x59db23(0x12b));}),_0x3a4e30['on']('get-starting-balances',_0x14346f=>{const _0x2be009=_0x43bd3b;if(validateAccess(_0x14346f,_0x21fd48)[_0x2be009(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b]['send']({'function':'getStartingBalances','args':null});}else logger[_0x2be009(0x172)](_0x2be009(0x14f));}),_0x3a4e30['on'](_0x43bd3b(0x225),(_0x4d7948,_0x11a598)=>{const _0x203e48=_0x43bd3b;if(validateAccess(_0x11a598,_0x21fd48)['allow']){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x203e48(0x2ea)]({'function':_0x203e48(0x281),'args':_0x4d7948});}else logger[_0x203e48(0x172)](_0x203e48(0x239));}),_0x3a4e30['on']('cancel-loading',_0x847c07=>{const _0x3d0655=_0x43bd3b;if(validateAccess(_0x847c07,_0x21fd48)[_0x3d0655(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x3d0655(0x2ea)]({'function':_0x3d0655(0x23e),'args':null});}else logger['full'](_0x3d0655(0x292));}),_0x3a4e30['on']('show-config',_0x14bb7b=>{const _0x382600=_0x43bd3b;if(validateAccess(_0x14bb7b,_0x21fd48)[_0x382600(0x1c9)]){if(pid[_0x1e4a2b])pid[_0x1e4a2b][_0x382600(0x2ea)]({'function':_0x382600(0x1a1),'args':null});}else logger['full'](_0x382600(0x213));}),_0x3a4e30['on']('update-bb',_0x5be9f5=>{const _0x416152=_0x43bd3b;if(validateAccess(_0x5be9f5,_0x21fd48)['allow'])updateBB(_0x416152(0x1fa));else logger[_0x416152(0x172)](_0x416152(0x267));}),_0x3a4e30['on'](_0x43bd3b(0x263),_0x2132ba=>{const _0x2c8d6c=_0x43bd3b;if(validateAccess(_0x2132ba,_0x21fd48)[_0x2c8d6c(0x1c9)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3a4e30['on'](_0x43bd3b(0x1a5),(_0x2b29b9,_0x148ef1)=>{const _0xc9fd01=_0x43bd3b;if(validateAccess(_0x148ef1,_0x21fd48)[_0xc9fd01(0x1c9)])confirmMessage(_0x2b29b9);else logger['full'](_0xc9fd01(0x29c));}),_0x3a4e30['on'](_0x43bd3b(0x240),_0x479c80=>{const _0x33b860=_0x43bd3b;if(validateAccess(_0x479c80,_0x21fd48)[_0x33b860(0x1c9)]){if(devices[_0x21fd48]['pidRefreshToken'])clearTimeout(devices[_0x21fd48][_0x33b860(0x2a9)]);if(devices[_0x21fd48][_0x33b860(0x2c7)])clearTimeout(devices[_0x21fd48][_0x33b860(0x2c7)]);removeSocketListeners(getClient(_0x3a4e30['id'])[_0x33b860(0x15c)]),addBlacklist(_0x21fd48),devices[_0x21fd48][_0x33b860(0x25f)]=null,devices[_0x21fd48][_0x33b860(0x193)]=null,devices[_0x21fd48][_0x33b860(0x233)][_0x33b860(0x1b1)]=null,logger[_0x33b860(0x26b)](_0x33b860(0x250)+_0x21fd48[_0x33b860(0x1f5)](-0x8)),io['to'](getClient(_0x3a4e30['id'])[_0x33b860(0x15c)])['emit'](_0x33b860(0x205),{'access':{'allow':![],'reason':_0x33b860(0x1c4),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x394b81){const _0x9e2a40=_0x2acf75;getClientsWithUuid(_0x394b81)[_0x9e2a40(0x2a0)](_0x4dee0d=>{const _0x15d134=_0x9e2a40;getSocket(_0x4dee0d['id'])[_0x15d134(0x1f4)]();});}function cleanSettings(){const _0x2d37b5=_0x2acf75;let _0x13af23=settings;return settings[_0x2d37b5(0x2b0)]&&settings['telegramToken']!=''&&(_0x13af23={..._0x13af23,'telegramToken':_0x2d37b5(0x2c0)}),settings[_0x2d37b5(0x227)]&&settings[_0x2d37b5(0x227)]!=''&&(_0x13af23={..._0x13af23,'bbPassword':_0x2d37b5(0x2c0)}),(settings[_0x2d37b5(0x227)]&&settings[_0x2d37b5(0x227)]=='***'||settings['telegramToken']&&settings[_0x2d37b5(0x2b0)]=='***')&&(_0x13af23={..._0x13af23,'restored':{'password':settings[_0x2d37b5(0x227)]==_0x2d37b5(0x1f6),'telegram':settings[_0x2d37b5(0x2b0)]==_0x2d37b5(0x1f6)}}),_0x13af23;}async function updateBB(_0x3b1382){const _0x2220c2=_0x2acf75;await backupConfigFiles(),installingUpdate=!![],config[_0x2220c2(0x2a0)](_0x391a10=>{const _0x43bb3b=_0x2220c2;restartBot(_0x391a10[_0x43bb3b(0x2a2)]);}),logger[_0x2220c2(0x26b)](_0x2220c2(0x1fd)+_0x3b1382);if(_0x3b1382==_0x2220c2(0x1fa))process[_0x2220c2(0x2ea)]({'update':!![]},_0x1edb7b=>{});else _0x3b1382=='reinstall'&&process['send']({'reinstall':!![]},_0x35ebba=>{});}function startBot(_0x145618,_0x25e838,_0x2b93ab){const _0x54d2f7=_0x2acf75;if(debugging)_0x145618['push']('-d');let _0x5d0dae=![];const _0x8e6cd0=_0x145618[0x0];_0x25e838={..._0x25e838,'stdio':[_0x54d2f7(0x1a8),'inherit','inherit',_0x54d2f7(0x234)]},pid[_0x8e6cd0]=childProcess[_0x54d2f7(0x1c0)](botfile,_0x145618,_0x25e838),pid[_0x8e6cd0]['on'](_0x54d2f7(0x2af),_0x116bd9=>{const _0x2c30f6=_0x54d2f7;switch(Object[_0x2c30f6(0x1b6)](_0x116bd9)[0x0]){case _0x2c30f6(0x2c3):updateBotName(_0x8e6cd0,_0x116bd9[_0x2c30f6(0x2c3)]);break;case'updatebotmanager':updateBotManager();break;case _0x2c30f6(0x205):updateStatus(_0x8e6cd0,_0x116bd9[_0x2c30f6(0x205)]);break;case _0x2c30f6(0x2c6):updateLive(_0x8e6cd0,_0x116bd9[_0x2c30f6(0x2c6)]);break;case _0x2c30f6(0x2f0):updateLive(_0x8e6cd0,_0x116bd9['started']),io['to'](_0x8e6cd0)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x2c30f6(0x1e8):_0x116bd9['stop']=='restart'&&restartBot(_0x8e6cd0);_0x116bd9['stop']==_0x2c30f6(0x24c)&&toggleBot(_0x8e6cd0,_0x2c30f6(0x1a7),'stopped');break;case'telegram':sendTelegram(_0x8e6cd0,_0x116bd9[_0x2c30f6(0x1c1)]);break;case _0x2c30f6(0x2ce):sendTelegramMsg(_0x116bd9[_0x2c30f6(0x2ce)]);break;case _0x2c30f6(0x14a):io['to'](_0x8e6cd0)[_0x2c30f6(0x17b)](_0x116bd9[_0x2c30f6(0x14a)],_0x116bd9[_0x2c30f6(0x1ff)]);break;}}),pid[_0x8e6cd0]['on'](_0x54d2f7(0x2a8),function(_0x227a81){if(_0x5d0dae)return;_0x5d0dae=!![],_0x2b93ab(_0x227a81);}),pid[_0x8e6cd0]['on'](_0x54d2f7(0x1f1),async function(_0x32896a){const _0x3be516=_0x54d2f7;if(installingUpdate)return;if(_0x5d0dae)return;_0x5d0dae=!![],_0x2b93ab(null);const _0x52b97d=dbConfig['get'](_0x3be516(0x122))['find']({'botID':_0x8e6cd0})[_0x3be516(0x2cf)]();_0x52b97d&&(_0x52b97d['status']==_0x3be516(0x134)||_0x52b97d[_0x3be516(0x205)]=='new')&&(await sleep(0x3e8),updateLive(_0x8e6cd0,_0x3be516(0x1bb)),logger[_0x3be516(0x172)](_0x3be516(0x277)+_0x8e6cd0),startBot([_0x8e6cd0,userID],{'cwd':bbpath},function(_0xfddd44){const _0x10cf0a=_0x3be516;if(_0xfddd44)logger[_0x10cf0a(0x172)](_0xfddd44);}));});}function stopBot(_0x1631c7){const _0xad2a9c=_0x2acf75;getClientsWithBotID(_0x1631c7)[_0xad2a9c(0x2a0)](_0x7491cd=>{const _0x4fa87c=_0xad2a9c;getSocket(_0x7491cd['id'])[_0x4fa87c(0x20b)](!![]),removeClient(_0x7491cd['id']);}),pid[_0x1631c7]&&(pid[_0x1631c7][_0xad2a9c(0x24c)](),pid[_0x1631c7]=null);}function restartBot(_0x3a7c2a){const _0x45c53b=_0x2acf75;if(pid[_0x3a7c2a])pid[_0x3a7c2a][_0x45c53b(0x24c)]();}function addBot(){const _0x392ab6=_0x2acf75;let _0x2d3beb;for(let _0x225093=0x1;_0x225093<0x3e9;_0x225093++){_0x2d3beb=_0x225093[_0x392ab6(0x2ae)]()[_0x392ab6(0x2f3)](0x3,'0');let _0x10ba1=config[_0x392ab6(0x2d7)](_0x5d4019=>_0x5d4019[_0x392ab6(0x2a2)]==_0x2d3beb);if(!_0x10ba1)break;}if(_0x2d3beb===_0x392ab6(0x294)){logger['full']('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x392ab6(0x172)]('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x2d3beb),dbConfig[_0x392ab6(0x183)](_0x392ab6(0x122))[_0x392ab6(0x2b4)]({'botID':_0x2d3beb,'botname':'Bot\x20'+_0x2d3beb,'status':_0x392ab6(0x2a3),'live':''})[_0x392ab6(0x23d)](),startBot([_0x2d3beb,userID],{'cwd':bbpath},function(_0x553122){const _0x575f2e=_0x392ab6;if(_0x553122)logger[_0x575f2e(0x172)](_0x553122);}),config=getConfiguration(),io['to'](_0x392ab6(0x275))[_0x392ab6(0x17b)](_0x392ab6(0x122),config),broadcastToBots(_0x392ab6(0x122),JSON[_0x392ab6(0x2c4)](config));}function deleteBot(_0x3bb644){const _0x50c299=_0x2acf75;getClientsWithBotID(_0x3bb644)['forEach'](_0x22802b=>{const _0x65c9d5=_0x485e;getSocket(_0x22802b['id'])[_0x65c9d5(0x20b)](!![]),removeClient(_0x22802b['id']);}),dbConfig['get'](_0x50c299(0x122))[_0x50c299(0x1de)]({'botID':_0x3bb644})[_0x50c299(0x23d)](),logger[_0x50c299(0x172)]('deleted\x20Bot\x20'+_0x3bb644),stopBot(_0x3bb644);try{if(fs['existsSync'](path['join'](configpath,_0x50c299(0x21f)+_0x3bb644+'-config.json')))fs['unlinkSync'](path[_0x50c299(0x22b)](configpath,_0x50c299(0x21f)+_0x3bb644+_0x50c299(0x279)));if(fs[_0x50c299(0x12a)](path[_0x50c299(0x22b)](configpath,_0x50c299(0x21f)+_0x3bb644+_0x50c299(0x214))))fs[_0x50c299(0x1bf)](path['join'](configpath,'bot-'+_0x3bb644+_0x50c299(0x214)));if(fs[_0x50c299(0x12a)](path[_0x50c299(0x22b)](configpath,_0x50c299(0x21f)+_0x3bb644+_0x50c299(0x12e))))fs[_0x50c299(0x1bf)](path[_0x50c299(0x22b)](configpath,'bot-'+_0x3bb644+_0x50c299(0x12e)));if(fs[_0x50c299(0x12a)](path[_0x50c299(0x22b)](configpath,_0x50c299(0x21f)+_0x3bb644+'-results.json')))fs[_0x50c299(0x1bf)](path[_0x50c299(0x22b)](configpath,_0x50c299(0x21f)+_0x3bb644+_0x50c299(0x1d4)));}catch(_0x52d1b1){if(_0x52d1b1)logger[_0x50c299(0x172)](_0x50c299(0x1f7),_0x52d1b1);}config=getConfiguration(),io['to'](_0x50c299(0x275))['emit'](_0x50c299(0x122),config),broadcastToBots(_0x50c299(0x122),JSON['stringify'](config));}function toggleBot(_0x26dbc7,_0x5a153a,_0x4f61ab){const _0x37c462=_0x2acf75;dbConfig['get']('bots')[_0x37c462(0x2d7)]({'botID':_0x26dbc7})[_0x37c462(0x13c)]({'status':_0x5a153a})[_0x37c462(0x13c)]({'live':_0x4f61ab})[_0x37c462(0x23d)]();if(_0x5a153a==_0x37c462(0x134)||_0x5a153a==_0x37c462(0x2a3))logger[_0x37c462(0x172)](_0x37c462(0x124)+_0x26dbc7),startBot([_0x26dbc7,userID],{'cwd':bbpath},function(_0x576041){const _0x24ab45=_0x37c462;if(_0x576041)logger[_0x24ab45(0x172)](_0x576041);});else(_0x5a153a==_0x37c462(0x1a7)||_0x5a153a==_0x37c462(0x2d1))&&(logger[_0x37c462(0x172)]('disabled\x20Bot\x20'+_0x26dbc7),stopBot(_0x26dbc7));config=getConfiguration(),io['to'](_0x37c462(0x275))[_0x37c462(0x17b)](_0x37c462(0x122),config),broadcastToBots(_0x37c462(0x122),JSON[_0x37c462(0x2c4)](config));}function toggleStatus(_0x3ef1d8){const _0x5c7e93=_0x2acf75;let _0x53a80b=dbConfig[_0x5c7e93(0x183)](_0x5c7e93(0x122))[_0x5c7e93(0x2d7)]({'botID':_0x3ef1d8})[_0x5c7e93(0x2cf)](),_0x6893a7;if(_0x53a80b[_0x5c7e93(0x205)]==='enabled')_0x6893a7=_0x5c7e93(0x1a7);else{if(_0x53a80b[_0x5c7e93(0x205)]==='new')_0x6893a7=_0x5c7e93(0x2d1);else{if(_0x53a80b['status']===_0x5c7e93(0x2d1))_0x6893a7='new';else{if(_0x53a80b[_0x5c7e93(0x205)]===_0x5c7e93(0x1a7))_0x6893a7=_0x5c7e93(0x134);}}}return _0x6893a7;}function updateStatus(_0x287100,_0x2542cb){const _0x3ee08a=_0x2acf75;dbConfig[_0x3ee08a(0x183)](_0x3ee08a(0x122))['find']({'botID':_0x287100})['assign']({'status':_0x2542cb})[_0x3ee08a(0x23d)](),config=getConfiguration(),io['to'](_0x3ee08a(0x275))['emit'](_0x3ee08a(0x122),config),broadcastToBots('bots',JSON[_0x3ee08a(0x2c4)](config));}function updateLive(_0x1b0303,_0x249246){const _0x50e460=_0x2acf75;dbConfig[_0x50e460(0x183)](_0x50e460(0x122))['find']({'botID':_0x1b0303})['assign']({'live':_0x249246})[_0x50e460(0x23d)](),config=getConfiguration(),io['to'](_0x50e460(0x275))['emit'](_0x50e460(0x122),config),broadcastToBots(_0x50e460(0x122),JSON[_0x50e460(0x2c4)](config));}function updateBotName(_0x5f31b2,_0x4e7447){const _0x43e9e8=_0x2acf75;dbConfig['get']('bots')[_0x43e9e8(0x2d7)]({'botID':_0x5f31b2})['assign']({'botname':_0x4e7447})[_0x43e9e8(0x23d)](),config=getConfiguration(),io['to'](_0x43e9e8(0x275))[_0x43e9e8(0x17b)]('bots',config),broadcastToBots(_0x43e9e8(0x122),JSON[_0x43e9e8(0x2c4)](config));}function updateBotManager(){const _0x48b188=_0x2acf75;config=getConfiguration(),io['to'](_0x48b188(0x275))[_0x48b188(0x17b)]('bots',config),broadcastToBots(_0x48b188(0x122),JSON[_0x48b188(0x2c4)](config));}function toggleBotMode(_0x2ad4ab){const _0x5c0c0f=_0x2acf75;if(pid[_0x2ad4ab])pid[_0x2ad4ab][_0x5c0c0f(0x2ea)]({'function':_0x5c0c0f(0x202),'args':null});else{const _0x473c8c=configpath+_0x5c0c0f(0x21f)+_0x2ad4ab+_0x5c0c0f(0x279),_0x4a8ceb=fs[_0x5c0c0f(0x270)](_0x473c8c),_0x44f297=JSON[_0x5c0c0f(0x2ac)](_0x4a8ceb),_0x15f72f=_0x44f297[_0x5c0c0f(0x14e)][0x0][_0x5c0c0f(0x1cc)];_0x44f297['bot'][0x0][_0x5c0c0f(0x1cc)]=!_0x15f72f;const _0x47d616=JSON[_0x5c0c0f(0x2c4)](_0x44f297,null,0x2);fs[_0x5c0c0f(0x206)](_0x473c8c,_0x47d616),config=getConfiguration(),io['to']('botmanager')[_0x5c0c0f(0x17b)](_0x5c0c0f(0x122),config),broadcastToBots(_0x5c0c0f(0x122),JSON[_0x5c0c0f(0x2c4)](config));}}function telegramError(_0x1382eb){const _0x38bfb2=_0x2acf75;logger[_0x38bfb2(0x132)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x3f1a41){const _0x102860=_0x2acf75;if(_0x3f1a41[_0x102860(0x197)][_0x102860(0x1f2)]!=settings[_0x102860(0x1eb)]&&'@'+_0x3f1a41[_0x102860(0x197)][_0x102860(0x1f2)]!=settings[_0x102860(0x1eb)])return tgBot['sendMessage'](_0x3f1a41[_0x102860(0x1e3)]['id'],_0x102860(0x19d),{'parse_mode':_0x102860(0x1df)})['catch'](_0x16318d=>{telegramError(_0x16318d);}),![];return!![];}async function initTelegram(){const _0x521a5b=_0x2acf75;if(tgBot)tgBot[_0x521a5b(0x2e8)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x521a5b(0x2b0)],{'polling':!![]});let _0x537572=_0x521a5b(0x2b7);_0x537572+='\x0a',_0x537572+=_0x521a5b(0x198),_0x537572+=_0x521a5b(0x158),_0x537572+=_0x521a5b(0x167),_0x537572+=_0x521a5b(0x1db),_0x537572+=_0x521a5b(0x218),_0x537572+=_0x521a5b(0x24a),_0x537572+=_0x521a5b(0x143),_0x537572+='/names\x20-\x20show\x20bot\x20names\x0a',_0x537572+=_0x521a5b(0x23f),_0x537572+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x537572+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x537572+=_0x521a5b(0x16b),_0x537572+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x537572+=_0x521a5b(0x1d6);let _0x16ae0a=_0x521a5b(0x171);_0x16ae0a+='\x0a',_0x16ae0a+=_0x537572,tgBot['onText'](/\/start/,_0x33c689=>{const _0x8fa9bb=_0x521a5b;if(!validateTelegram(_0x33c689))return;if(settings[_0x8fa9bb(0x273)]!=_0x33c689[_0x8fa9bb(0x1e3)]['id'])updateSetting(_0x8fa9bb(0x273),_0x33c689[_0x8fa9bb(0x1e3)]['id']);updateSetting(_0x8fa9bb(0x27e),!![]),tgBot[_0x8fa9bb(0x189)](_0x33c689[_0x8fa9bb(0x1e3)]['id'],_0x16ae0a)[_0x8fa9bb(0x1ae)](_0x1de5df=>{telegramError(_0x1de5df);});}),tgBot[_0x521a5b(0x2e6)](/\/enable/,_0x2515dd=>{const _0x573f00=_0x521a5b;if(!validateTelegram(_0x2515dd))return;if(settings[_0x573f00(0x273)]!=_0x2515dd['chat']['id'])updateSetting(_0x573f00(0x273),_0x2515dd[_0x573f00(0x1e3)]['id']);updateSetting(_0x573f00(0x27e),!![]),tgBot['sendMessage'](_0x2515dd[_0x573f00(0x1e3)]['id'],'Notifications\x20enabled')[_0x573f00(0x1ae)](_0xddb934=>{telegramError(_0xddb934);});}),tgBot[_0x521a5b(0x2e6)](/\/config/,async _0x2ee3a6=>{const _0x1143ff=_0x521a5b;if(!validateTelegram(_0x2ee3a6))return;tgBot[_0x1143ff(0x13e)](_0x1143ff(0x25e)),tgBot[_0x1143ff(0x189)](_0x2ee3a6[_0x1143ff(0x1e3)]['id'],_0x1143ff(0x26d),{'reply_markup':{'inline_keyboard':[[{'text':_0x1143ff(0x2b2),'callback_data':_0x1143ff(0x1e7)},{'text':'Alerts','callback_data':_0x1143ff(0x1bc)},{'text':_0x1143ff(0x1fb),'callback_data':_0x1143ff(0x17e)}]]}})['catch'](_0x2a3c48=>{telegramError(_0x2a3c48);}),tgBot['on'](_0x1143ff(0x25e),async _0x5ba673=>{const _0x487549=_0x1143ff,_0x25c405=_0x5ba673[_0x487549(0x2d9)],_0x6cf988=_0x5ba673[_0x487549(0x2af)];tgBot[_0x487549(0x138)](_0x5ba673['id'])[_0x487549(0x170)](async()=>{const _0x522a42=_0x487549;_0x25c405==_0x522a42(0x1e7)&&(updateSetting('telegramEvents','orders'),updateSetting(_0x522a42(0x27e),!![]),await tgBot[_0x522a42(0x189)](_0x6cf988[_0x522a42(0x1e3)]['id'],_0x522a42(0x278))[_0x522a42(0x1ae)](_0x26e201=>{telegramError(_0x26e201);}));_0x25c405==_0x522a42(0x1bc)&&(updateSetting(_0x522a42(0x28e),_0x522a42(0x1bc)),updateSetting(_0x522a42(0x27e),!![]),await tgBot[_0x522a42(0x189)](_0x6cf988['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x522a42(0x1ae)](_0x388b38=>{telegramError(_0x388b38);}));_0x25c405==_0x522a42(0x17e)&&(updateSetting('telegramEvents',_0x522a42(0x17e)),updateSetting(_0x522a42(0x27e),!![]),await tgBot[_0x522a42(0x189)](_0x6cf988['chat']['id'],_0x522a42(0x13a))['catch'](_0xafb0d6=>{telegramError(_0xafb0d6);}));if(!settings[_0x522a42(0x273)])tgBot['sendMessage'](_0x6cf988['chat']['id'],_0x522a42(0x2ba))[_0x522a42(0x1ae)](_0x490376=>{telegramError(_0x490376);});}),tgBot[_0x487549(0x13e)]('callback_query');});}),tgBot[_0x521a5b(0x2e6)](/\/status/,_0x1a1b24=>{const _0x48952a=_0x521a5b;if(!validateTelegram(_0x1a1b24))return;const _0x25b1fd=getBotsWithMode();let _0x4ed085=_0x48952a(0x191);config[_0x48952a(0x2a0)](_0x52dfbd=>{const _0x49cdee=_0x48952a,_0x55709a=_0x25b1fd['find'](_0x2cdec9=>_0x2cdec9['botID']==_0x52dfbd[_0x49cdee(0x2a2)])[_0x49cdee(0x2ed)];_0x4ed085+=_0x49cdee(0x2cc)+_0x52dfbd[_0x49cdee(0x2a2)]+':\x20'+_0x52dfbd[_0x49cdee(0x205)]+_0x49cdee(0x1fe)+_0x55709a+'\x20|\x20'+_0x52dfbd[_0x49cdee(0x2c6)]+'\x0a';}),_0x4ed085+='\x0a',_0x4ed085+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4ed085+=!settings[_0x48952a(0x27e)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x4ed085+=settings[_0x48952a(0x27e)]?settings[_0x48952a(0x28e)]==_0x48952a(0x17e)?_0x48952a(0x21b):_0x48952a(0x1e4)+settings[_0x48952a(0x28e)]+_0x48952a(0x1b2):'',tgBot['sendMessage'](_0x1a1b24['chat']['id'],_0x4ed085,{'parse_mode':'HTML'})[_0x48952a(0x1ae)](_0x2a822f=>{telegramError(_0x2a822f);});}),tgBot['onText'](/\/restart/,_0x331dd3=>{const _0x20194c=_0x521a5b;if(!validateTelegram(_0x331dd3))return;tgBot[_0x20194c(0x13e)](_0x20194c(0x25e));const _0x320e8a=getEnabledBots();if(_0x320e8a[_0x20194c(0x1d3)]==0x0)tgBot[_0x20194c(0x189)](_0x331dd3[_0x20194c(0x1e3)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x20194c(0x1ae)](_0x40c7a8=>{telegramError(_0x40c7a8);});else{if(_0x320e8a[_0x20194c(0x1d3)]>0x1)_0x320e8a['push']({'botID':_0x20194c(0x17e)});let _0x599af6=[],_0x480453=[];const _0x17577a=_0x320e8a[_0x20194c(0x1d3)]%0x4==0x0||_0x320e8a[_0x20194c(0x1d3)]%0x4==0x3||_0x320e8a['length']%0x3==0x1?0x4:0x3;let _0x566d7a=0x0;_0x320e8a[_0x20194c(0x2a0)]((_0x5d36a7,_0x3023d5)=>{const _0x21dc24=_0x20194c;if(_0x3023d5%_0x17577a==0x0)_0x480453=[];_0x480453[_0x21dc24(0x2b4)]({'text':_0x5d36a7[_0x21dc24(0x2a2)]==_0x21dc24(0x17e)?_0x21dc24(0x289):_0x21dc24(0x2cc)+_0x5d36a7['botID'],'callback_data':_0x5d36a7['botID']}),_0x3023d5%_0x17577a==0x0&&(_0x599af6[_0x566d7a]=_0x480453,_0x566d7a++);}),tgBot[_0x20194c(0x189)](_0x331dd3[_0x20194c(0x1e3)]['id'],_0x20194c(0x230),{'reply_markup':{'inline_keyboard':_0x599af6}})[_0x20194c(0x1ae)](_0x374224=>{telegramError(_0x374224);}),tgBot['on'](_0x20194c(0x25e),async _0x44ad73=>{const _0x51c887=_0x20194c,_0x22187a=_0x44ad73[_0x51c887(0x2d9)],_0x3cc4c5=_0x44ad73[_0x51c887(0x2af)];tgBot[_0x51c887(0x138)](_0x44ad73['id'])['then'](async()=>{const _0x4cae2d=_0x51c887;_0x22187a==_0x4cae2d(0x17e)?config[_0x4cae2d(0x2a0)](_0x26056f=>{const _0x3c7b15=_0x4cae2d;restartBot(_0x26056f[_0x3c7b15(0x2a2)]);}):restartBot(_0x22187a);}),tgBot[_0x51c887(0x13e)]('callback_query');});}}),tgBot[_0x521a5b(0x2e6)](/\/on/,_0x27f127=>{const _0x4588c5=_0x521a5b;if(!validateTelegram(_0x27f127))return;tgBot[_0x4588c5(0x13e)](_0x4588c5(0x25e));const _0x4ec8a4=getDisabledBots();if(_0x4ec8a4[_0x4588c5(0x1d3)]==0x0)tgBot[_0x4588c5(0x189)](_0x27f127[_0x4588c5(0x1e3)]['id'],_0x4588c5(0x2b6))[_0x4588c5(0x1ae)](_0x3ef9b7=>{telegramError(_0x3ef9b7);});else{if(_0x4ec8a4[_0x4588c5(0x1d3)]>0x1)_0x4ec8a4['push']({'botID':_0x4588c5(0x17e)});let _0x3952e6=[],_0x5214c0=[];const _0x5f295e=_0x4ec8a4[_0x4588c5(0x1d3)]%0x4==0x0||_0x4ec8a4[_0x4588c5(0x1d3)]%0x4==0x3||_0x4ec8a4[_0x4588c5(0x1d3)]%0x3==0x1?0x4:0x3;let _0x5f0cea=0x0;_0x4ec8a4['forEach']((_0x4af768,_0x8d985c)=>{const _0x1bd32b=_0x4588c5;if(_0x8d985c%_0x5f295e==0x0)_0x5214c0=[];_0x5214c0[_0x1bd32b(0x2b4)]({'text':_0x4af768[_0x1bd32b(0x2a2)]=='all'?_0x1bd32b(0x289):_0x1bd32b(0x2cc)+_0x4af768[_0x1bd32b(0x2a2)],'callback_data':_0x4af768[_0x1bd32b(0x2a2)]}),_0x8d985c%_0x5f295e==0x0&&(_0x3952e6[_0x5f0cea]=_0x5214c0,_0x5f0cea++);}),tgBot['sendMessage'](_0x27f127['chat']['id'],_0x4588c5(0x178),{'reply_markup':{'inline_keyboard':_0x3952e6}})['catch'](_0x413872=>{telegramError(_0x413872);}),tgBot['on'](_0x4588c5(0x25e),async _0x2dd16a=>{const _0x18d562=_0x4588c5,_0x2922de=_0x2dd16a[_0x18d562(0x2d9)],_0x548534=_0x2dd16a[_0x18d562(0x2af)];tgBot['answerCallbackQuery'](_0x2dd16a['id'])[_0x18d562(0x170)](async()=>{const _0x3062db=_0x18d562;_0x2922de==_0x3062db(0x17e)?(tgBot[_0x3062db(0x189)](_0x548534[_0x3062db(0x1e3)]['id'],_0x3062db(0x298))[_0x3062db(0x1ae)](_0x4233a6=>{telegramError(_0x4233a6);}),_0x4ec8a4['forEach'](_0x8b69e9=>{const _0x172b53=_0x3062db;if(_0x8b69e9[_0x172b53(0x2a2)]!=_0x172b53(0x17e))toggleBot(_0x8b69e9[_0x172b53(0x2a2)],toggleStatus(_0x8b69e9['botID']),'stopped');})):(tgBot[_0x3062db(0x189)](_0x548534[_0x3062db(0x1e3)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x2922de)['catch'](_0x5dd5f3=>{telegramError(_0x5dd5f3);}),toggleBot(_0x2922de,toggleStatus(_0x2922de),_0x3062db(0x1bb)));}),tgBot['removeListener'](_0x18d562(0x25e));});}}),tgBot['onText'](/\/off/,_0x24c367=>{const _0x3639b9=_0x521a5b;if(!validateTelegram(_0x24c367))return;tgBot[_0x3639b9(0x13e)](_0x3639b9(0x25e));const _0x41caf3=getEnabledBots();if(_0x41caf3[_0x3639b9(0x1d3)]==0x0)tgBot[_0x3639b9(0x189)](_0x24c367[_0x3639b9(0x1e3)]['id'],_0x3639b9(0x1a4))['catch'](_0x1b6892=>{telegramError(_0x1b6892);});else{if(_0x41caf3[_0x3639b9(0x1d3)]>0x1)_0x41caf3[_0x3639b9(0x2b4)]({'botID':'all'});let _0x2a1539=[],_0xcfebc=[];const _0x808471=_0x41caf3[_0x3639b9(0x1d3)]%0x4==0x0||_0x41caf3[_0x3639b9(0x1d3)]%0x4==0x3||_0x41caf3['length']%0x3==0x1?0x4:0x3;let _0x3ea11e=0x0;_0x41caf3[_0x3639b9(0x2a0)]((_0x13c0e4,_0x89ea67)=>{const _0x2a6ca9=_0x3639b9;if(_0x89ea67%_0x808471==0x0)_0xcfebc=[];_0xcfebc[_0x2a6ca9(0x2b4)]({'text':_0x13c0e4[_0x2a6ca9(0x2a2)]=='all'?'All\x20bots':_0x2a6ca9(0x2cc)+_0x13c0e4[_0x2a6ca9(0x2a2)],'callback_data':_0x13c0e4[_0x2a6ca9(0x2a2)]}),_0x89ea67%_0x808471==0x0&&(_0x2a1539[_0x3ea11e]=_0xcfebc,_0x3ea11e++);}),tgBot[_0x3639b9(0x189)](_0x24c367[_0x3639b9(0x1e3)]['id'],_0x3639b9(0x12c),{'reply_markup':{'inline_keyboard':_0x2a1539}})[_0x3639b9(0x1ae)](_0x44ea56=>{telegramError(_0x44ea56);}),tgBot['on'](_0x3639b9(0x25e),async _0x29dcda=>{const _0x7b37=_0x3639b9,_0x2cf81d=_0x29dcda['data'],_0x237144=_0x29dcda[_0x7b37(0x2af)];tgBot['answerCallbackQuery'](_0x29dcda['id'])[_0x7b37(0x170)](async()=>{const _0x42d4f1=_0x7b37;_0x2cf81d==_0x42d4f1(0x17e)?(tgBot[_0x42d4f1(0x189)](_0x237144['chat']['id'],_0x42d4f1(0x2b1))[_0x42d4f1(0x1ae)](_0x1c38a9=>{telegramError(_0x1c38a9);}),_0x41caf3[_0x42d4f1(0x2a0)](_0x280885=>{const _0xa6062b=_0x42d4f1;if(_0x280885[_0xa6062b(0x2a2)]!=_0xa6062b(0x17e))toggleBot(_0x280885[_0xa6062b(0x2a2)],toggleStatus(_0x280885[_0xa6062b(0x2a2)]),_0xa6062b(0x1bb));})):(tgBot['sendMessage'](_0x237144[_0x42d4f1(0x1e3)]['id'],_0x42d4f1(0x21c)+_0x2cf81d)[_0x42d4f1(0x1ae)](_0x261df0=>{telegramError(_0x261df0);}),toggleBot(_0x2cf81d,toggleStatus(_0x2cf81d),_0x42d4f1(0x1bb)));}),tgBot['removeListener'](_0x7b37(0x25e));});}}),tgBot[_0x521a5b(0x2e6)](/\/metrics/,_0x5772c4=>{const _0x140392=_0x521a5b;if(!validateTelegram(_0x5772c4))return;tgBot[_0x140392(0x13e)](_0x140392(0x25e));const _0x368acc=getEnabledBots();if(_0x368acc[_0x140392(0x1d3)]==0x0)tgBot[_0x140392(0x189)](_0x5772c4['chat']['id'],_0x140392(0x1a4))[_0x140392(0x1ae)](_0x457e94=>{telegramError(_0x457e94);});else{if(_0x368acc[_0x140392(0x1d3)]>0x1){let _0x4fde59=[],_0x45ec18=[];const _0x17ffd4=_0x368acc['length']%0x4==0x0||_0x368acc[_0x140392(0x1d3)]%0x4==0x3||_0x368acc[_0x140392(0x1d3)]%0x3==0x1?0x4:0x3;let _0x15dd3e=0x0;_0x368acc['forEach']((_0x677d00,_0xe5829f)=>{const _0x3bb044=_0x140392;if(_0xe5829f%_0x17ffd4==0x0)_0x45ec18=[];_0x45ec18[_0x3bb044(0x2b4)]({'text':_0x3bb044(0x2cc)+_0x677d00[_0x3bb044(0x2a2)],'callback_data':_0x677d00[_0x3bb044(0x2a2)]}),_0xe5829f%_0x17ffd4==0x0&&(_0x4fde59[_0x15dd3e]=_0x45ec18,_0x15dd3e++);}),tgBot[_0x140392(0x189)](_0x5772c4[_0x140392(0x1e3)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x4fde59}})['catch'](_0x15f6a1=>{telegramError(_0x15f6a1);}),tgBot['on']('callback_query',async _0x418a54=>{const _0x16c1ad=_0x140392,_0x161085=_0x418a54[_0x16c1ad(0x2d9)],_0x3b39a3=_0x418a54[_0x16c1ad(0x2af)];tgBot[_0x16c1ad(0x138)](_0x418a54['id'])[_0x16c1ad(0x170)](async()=>{const _0x5edadd=_0x16c1ad;if(pid[_0x161085])pid[_0x161085][_0x5edadd(0x2ea)]({'function':_0x5edadd(0x21a),'args':null});}),tgBot[_0x16c1ad(0x13e)](_0x16c1ad(0x25e));});}else{const _0x3bac91=_0x368acc[0x0][_0x140392(0x2a2)];if(pid[_0x3bac91])pid[_0x3bac91]['send']({'function':_0x140392(0x21a),'args':null});}}}),tgBot[_0x521a5b(0x2e6)](/\/portfolio/,_0x92ff80=>{const _0x514582=_0x521a5b;if(!validateTelegram(_0x92ff80))return;tgBot[_0x514582(0x13e)](_0x514582(0x25e));const _0x568d86=getEnabledBots();if(_0x568d86['length']==0x0)tgBot[_0x514582(0x189)](_0x92ff80['chat']['id'],_0x514582(0x1a4))[_0x514582(0x1ae)](_0x321cc5=>{telegramError(_0x321cc5);});else{if(_0x568d86[_0x514582(0x1d3)]>0x1){let _0x252f7a=[],_0x3c3f31=[];const _0x4019d3=_0x568d86['length']%0x4==0x0||_0x568d86[_0x514582(0x1d3)]%0x4==0x3||_0x568d86[_0x514582(0x1d3)]%0x3==0x1?0x4:0x3;let _0x584158=0x0;_0x568d86['forEach']((_0x386eee,_0x2a24dd)=>{const _0x7be06c=_0x514582;if(_0x2a24dd%_0x4019d3==0x0)_0x3c3f31=[];_0x3c3f31[_0x7be06c(0x2b4)]({'text':_0x7be06c(0x2cc)+_0x386eee['botID'],'callback_data':_0x386eee['botID']}),_0x2a24dd%_0x4019d3==0x0&&(_0x252f7a[_0x584158]=_0x3c3f31,_0x584158++);}),tgBot[_0x514582(0x189)](_0x92ff80[_0x514582(0x1e3)]['id'],_0x514582(0x141),{'reply_markup':{'inline_keyboard':_0x252f7a}})[_0x514582(0x1ae)](_0x191ae6=>{telegramError(_0x191ae6);}),tgBot['on'](_0x514582(0x25e),async _0x2c585f=>{const _0x52fd46=_0x514582,_0x2ed25d=_0x2c585f[_0x52fd46(0x2d9)],_0x27fbe8=_0x2c585f[_0x52fd46(0x2af)];tgBot[_0x52fd46(0x138)](_0x2c585f['id'])[_0x52fd46(0x170)](async()=>{const _0x2ce2ea=_0x52fd46;if(pid[_0x2ed25d])pid[_0x2ed25d][_0x2ce2ea(0x2ea)]({'function':_0x2ce2ea(0x28d),'args':null});}),tgBot[_0x52fd46(0x13e)](_0x52fd46(0x25e));});}else{const _0x596410=_0x568d86[0x0][_0x514582(0x2a2)];if(pid[_0x596410])pid[_0x596410]['send']({'function':_0x514582(0x28d),'args':null});}}}),tgBot['onText'](/\/update/,async _0x5d9e0a=>{const _0x56095b=_0x521a5b;if(!validateTelegram(_0x5d9e0a))return;tgBot[_0x56095b(0x13e)](_0x56095b(0x25e)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x5d9e0a[_0x56095b(0x1e3)]['id'],_0x56095b(0x14d))[_0x56095b(0x1ae)](_0x274cb9=>{telegramError(_0x274cb9);});else!validInstallation?tgBot[_0x56095b(0x189)](_0x5d9e0a['chat']['id'],_0x56095b(0x1cb))[_0x56095b(0x1ae)](_0x1c2196=>{telegramError(_0x1c2196);}):(tgBot['sendMessage'](_0x5d9e0a[_0x56095b(0x1e3)]['id'],_0x56095b(0x128),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x56095b(0x2a5)},{'text':'No','callback_data':'no'}]]}})[_0x56095b(0x1ae)](_0x37acf3=>{telegramError(_0x37acf3);}),tgBot['on'](_0x56095b(0x25e),async _0x5a8db0=>{const _0xb3815f=_0x56095b,_0x1b5c7b=_0x5a8db0[_0xb3815f(0x2d9)],_0x5e3a84=_0x5a8db0[_0xb3815f(0x2af)];tgBot[_0xb3815f(0x138)](_0x5a8db0['id'])[_0xb3815f(0x170)](async()=>{const _0x102df0=_0xb3815f;_0x1b5c7b==_0x102df0(0x2a5)&&(await tgBot['sendMessage'](_0x5e3a84[_0x102df0(0x1e3)]['id'],_0x102df0(0x16f))[_0x102df0(0x1ae)](_0x1b1b12=>{telegramError(_0x1b1b12);}),updateBB(_0x102df0(0x1fa))),_0x1b5c7b=='no'&&await tgBot[_0x102df0(0x189)](_0x5e3a84[_0x102df0(0x1e3)]['id'],_0x102df0(0x2bb))['catch'](_0x340bc2=>{telegramError(_0x340bc2);});}),tgBot[_0xb3815f(0x13e)]('callback_query');}));}),tgBot['onText'](/\/reinstall/,async _0x1122b0=>{const _0x3cf999=_0x521a5b;if(!validateTelegram(_0x1122b0))return;tgBot[_0x3cf999(0x13e)](_0x3cf999(0x25e)),!validInstallation?tgBot[_0x3cf999(0x189)](_0x1122b0['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x3cf999(0x1ae)](_0x1589f1=>{telegramError(_0x1589f1);}):(tgBot[_0x3cf999(0x189)](_0x1122b0[_0x3cf999(0x1e3)]['id'],_0x3cf999(0x28f),{'reply_markup':{'inline_keyboard':[[{'text':_0x3cf999(0x2c8),'callback_data':_0x3cf999(0x2a5)},{'text':'No','callback_data':'no'}]]}})[_0x3cf999(0x1ae)](_0x1b8c1a=>{telegramError(_0x1b8c1a);}),tgBot['on']('callback_query',async _0x2cc752=>{const _0x1beb8d=_0x3cf999,_0x48f0b8=_0x2cc752['data'],_0x1f83d1=_0x2cc752[_0x1beb8d(0x2af)];tgBot[_0x1beb8d(0x138)](_0x2cc752['id'])['then'](async()=>{const _0x2dee64=_0x1beb8d;_0x48f0b8==_0x2dee64(0x2a5)&&(await tgBot[_0x2dee64(0x189)](_0x1f83d1['chat']['id'],_0x2dee64(0x293))['catch'](_0x4538=>{telegramError(_0x4538);}),updateBB(_0x2dee64(0x20a))),_0x48f0b8=='no'&&await tgBot['sendMessage'](_0x1f83d1[_0x2dee64(0x1e3)]['id'],_0x2dee64(0x22f))[_0x2dee64(0x1ae)](_0x44af82=>{telegramError(_0x44af82);});}),tgBot[_0x1beb8d(0x13e)](_0x1beb8d(0x25e));}));}),tgBot[_0x521a5b(0x2e6)](/\/toggle/,_0x4a5ebc=>{const _0x1f2db3=_0x521a5b;if(!validateTelegram(_0x4a5ebc))return;tgBot['removeListener'](_0x1f2db3(0x25e));const _0x4e908c=getBotsWithMode();if(_0x4e908c[_0x1f2db3(0x1d3)]==0x0)tgBot[_0x1f2db3(0x189)](_0x4a5ebc[_0x1f2db3(0x1e3)]['id'],_0x1f2db3(0x1a4))[_0x1f2db3(0x1ae)](_0xdfdb25=>{telegramError(_0xdfdb25);});else{let _0x42ff66=[],_0x440291=[];const _0x500e96=0x2;let _0x23b5af=0x0;_0x4e908c['forEach']((_0x1a4e91,_0x3b0b4c)=>{const _0x25bdcc=_0x1f2db3;if(_0x3b0b4c%_0x500e96==0x0)_0x440291=[];_0x440291[_0x25bdcc(0x2b4)]({'text':_0x25bdcc(0x2cc)+_0x1a4e91['botID']+'\x20('+_0x1a4e91[_0x25bdcc(0x2ed)]+')','callback_data':_0x1a4e91[_0x25bdcc(0x2a2)]}),_0x3b0b4c%_0x500e96==0x0&&(_0x42ff66[_0x23b5af]=_0x440291,_0x23b5af++);}),tgBot[_0x1f2db3(0x189)](_0x4a5ebc['chat']['id'],_0x1f2db3(0x2b8),{'reply_markup':{'inline_keyboard':_0x42ff66}})['catch'](_0x3df9fc=>{telegramError(_0x3df9fc);}),tgBot['on']('callback_query',async _0x5bb2b0=>{const _0x5d7378=_0x1f2db3,_0x5371dd=_0x5bb2b0[_0x5d7378(0x2d9)],_0x13bdc1=_0x5bb2b0[_0x5d7378(0x2af)];tgBot[_0x5d7378(0x138)](_0x5bb2b0['id'])[_0x5d7378(0x170)](async()=>{const _0xfb5941=_0x5d7378,_0x323d8e=_0x4e908c[_0xfb5941(0x2d7)](_0x3c4a96=>_0x3c4a96[_0xfb5941(0x2a2)]==_0x5371dd),_0x357f77=_0x323d8e[_0xfb5941(0x2ed)]==_0xfb5941(0x1c5)?_0xfb5941(0x16d):_0xfb5941(0x1c5);tgBot[_0xfb5941(0x189)](_0x13bdc1[_0xfb5941(0x1e3)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x5371dd+_0xfb5941(0x12f)+_0x357f77+_0xfb5941(0x165))['catch'](_0x2c12b3=>{telegramError(_0x2c12b3);}),toggleBotMode(_0x5371dd);}),tgBot[_0x5d7378(0x13e)](_0x5d7378(0x25e));});}}),tgBot[_0x521a5b(0x2e6)](/\/names/,_0x47c96c=>{const _0x27fd23=_0x521a5b;if(!validateTelegram(_0x47c96c))return;let _0x1c9e4b='';config['forEach'](_0x588c17=>{_0x1c9e4b+='Bot\x20'+_0x588c17['botID']+':\x20'+_0x588c17['botname']+'\x0a';}),tgBot[_0x27fd23(0x189)](_0x47c96c[_0x27fd23(0x1e3)]['id'],_0x1c9e4b,{'parse_mode':_0x27fd23(0x1df)})[_0x27fd23(0x1ae)](_0xa71ac5=>{telegramError(_0xa71ac5);});}),tgBot[_0x521a5b(0x2e6)](/\/disable/,_0x43b4c9=>{const _0x4c8d3f=_0x521a5b;if(!validateTelegram(_0x43b4c9))return;tgBot[_0x4c8d3f(0x189)](_0x43b4c9[_0x4c8d3f(0x1e3)]['id'],_0x4c8d3f(0x2dc))[_0x4c8d3f(0x1ae)](_0x23bbe2=>{telegramError(_0x23bbe2);}),updateSetting(_0x4c8d3f(0x27e),![]);}),tgBot[_0x521a5b(0x2e6)](/\/help/,_0x4be7d9=>{const _0x3619ab=_0x521a5b;if(!validateTelegram(_0x4be7d9))return;tgBot[_0x3619ab(0x189)](_0x4be7d9[_0x3619ab(0x1e3)]['id'],_0x537572)[_0x3619ab(0x1ae)](_0x1be0d1=>{telegramError(_0x1be0d1);});}),tgBot['on'](_0x521a5b(0x15b),_0x5573ec=>{const _0x5b184c=_0x521a5b;_0x5573ec[_0x5b184c(0x2ae)]()['includes'](_0x5b184c(0x2d5))&&(logger[_0x5b184c(0x172)](_0x5b184c(0x291)),tgBot[_0x5b184c(0x2e8)](),tgBot=null,io['to'](_0x5b184c(0x275))[_0x5b184c(0x17b)](_0x5b184c(0x220),_0x5b184c(0x291)));}),process[_0x521a5b(0x2da)](_0x521a5b(0x180),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x521a5b(0x2da)](_0x521a5b(0x200),()=>{const _0x43115e=_0x521a5b;if(tgBot)tgBot[_0x43115e(0x2e8)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x28df2a,_0x1bb732){const _0x32df2c=_0x2acf75;if(settings[_0x32df2c(0x27e)]){if(settings[_0x32df2c(0x28e)]=='all'||(_0x1bb732[_0x32df2c(0x247)]==_0x32df2c(0x2a8)||_0x1bb732['type']==_0x32df2c(0x2ab)||_0x1bb732[_0x32df2c(0x247)]==_0x32df2c(0x168))&&settings[_0x32df2c(0x28e)]=='alerts'||_0x1bb732[_0x32df2c(0x247)]==_0x32df2c(0x23c)&&settings[_0x32df2c(0x28e)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x1bb732['showname'])tgBot['sendMessage'](settings[_0x32df2c(0x273)],_0x1bb732[_0x32df2c(0x2c3)]+_0x32df2c(0x226)+_0x1bb732[_0x32df2c(0x28c)])['catch'](_0x1b1035=>{telegramError(_0x1b1035);});else tgBot[_0x32df2c(0x189)](settings[_0x32df2c(0x273)],_0x32df2c(0x2cc)+_0x28df2a+_0x32df2c(0x226)+_0x1bb732['event'])[_0x32df2c(0x1ae)](_0x26255e=>{telegramError(_0x26255e);});}}}}async function sendTelegramMsg(_0x2ca9c1,_0xf741b7=_0x2acf75(0x1df)){const _0x428a04=_0x2acf75;return settings[_0x428a04(0x27e)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x428a04(0x189)](settings[_0x428a04(0x273)],_0x2ca9c1,{'parse_mode':_0xf741b7})[_0x428a04(0x1ae)](_0x235455=>{telegramError(_0x235455);}),!![]):![];}function getDeviceWithIp(_0x99f808){const _0x415f70=_0x2acf75;return devices[_0x415f70(0x2d7)](_0xd09cdf=>_0xd09cdf['ip']===_0x99f808);}function temporaryAccess2FA(_0x285261,_0x41f928){const _0x4abee6=_0x2acf75;let _0x1e139a=new Date(),_0x6a0523=![];if(lastIpApproval){if(_0x1e139a-lastIpApproval<0x1388)_0x6a0523=!![];}lastIpApproval=new Date();if(_0x6a0523)return;tgBot&&settings[_0x4abee6(0x273)]&&(tgBot[_0x4abee6(0x13e)]('callback_query'),tgBot[_0x4abee6(0x189)](settings[_0x4abee6(0x273)],_0x4abee6(0x215)+normalizeIP(_0x41f928)['show']+_0x4abee6(0x284),{'parse_mode':_0x4abee6(0x1df),'reply_markup':{'inline_keyboard':[[{'text':_0x4abee6(0x19b),'callback_data':'5'},{'text':_0x4abee6(0x1f0),'callback_data':'15'},{'text':_0x4abee6(0x11f),'callback_data':'30'},{'text':_0x4abee6(0x1ce),'callback_data':_0x4abee6(0x1ce)}]]}})[_0x4abee6(0x1ae)](_0x42492f=>{telegramError(_0x42492f);}),tgBot['on'](_0x4abee6(0x25e),async _0xd22038=>{const _0x5c4152=_0x4abee6,_0x439ff2=_0xd22038[_0x5c4152(0x2d9)],_0x337a5b=_0xd22038['message'];tgBot[_0x5c4152(0x138)](_0xd22038['id'])[_0x5c4152(0x170)](async()=>{const _0x1d9ad2=_0x5c4152;devices[_0x285261][_0x1d9ad2(0x25f)]={'clientip':_0x41f928,'timestamp':new Date()['getTime'](),'expiry':_0x439ff2},_0x439ff2!=_0x1d9ad2(0x1ce)?(await tgBot[_0x1d9ad2(0x189)](_0x337a5b[_0x1d9ad2(0x1e3)]['id'],_0x1d9ad2(0x1ed)+_0x439ff2+_0x1d9ad2(0x190),{'parse_mode':'HTML'})[_0x1d9ad2(0x1ae)](_0x5970d4=>{telegramError(_0x5970d4);}),io['to'](_0x285261)[_0x1d9ad2(0x17b)](_0x1d9ad2(0x205),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x1d9ad2(0x189)](_0x337a5b[_0x1d9ad2(0x1e3)]['id'],'Temporary\x20access\x20rejected')[_0x1d9ad2(0x1ae)](_0x2b2f4a=>{telegramError(_0x2b2f4a);}),io['to'](_0x285261)['emit'](_0x1d9ad2(0x205),{'access':{'allow':![],'reason':_0x1d9ad2(0x130),'token':null}}));}),tgBot[_0x5c4152(0x13e)](_0x5c4152(0x25e));}));}function loginAccess2FA(_0x519339,_0x261fc0){const _0x14fa8e=_0x2acf75;tgBot&&settings[_0x14fa8e(0x273)]&&(tgBot['removeListener'](_0x14fa8e(0x25e)),tgBot[_0x14fa8e(0x189)](settings[_0x14fa8e(0x273)],_0x14fa8e(0x22d)+normalizeIP(_0x261fc0)[_0x14fa8e(0x14c)]+_0x14fa8e(0x284),{'parse_mode':_0x14fa8e(0x1df),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x14fa8e(0x1ce),'callback_data':'reject'}]]}})[_0x14fa8e(0x1ae)](_0x3bc9ee=>{telegramError(_0x3bc9ee);}),tgBot['on'](_0x14fa8e(0x25e),async _0x344b86=>{const _0x5b5b75=_0x14fa8e,_0x15a6da=_0x344b86[_0x5b5b75(0x2d9)],_0x2b1b1a=_0x344b86[_0x5b5b75(0x2af)];tgBot[_0x5b5b75(0x138)](_0x344b86['id'])['then'](async()=>{const _0xe22c28=_0x5b5b75;devices[_0x519339][_0xe22c28(0x193)]={'clientip':_0x261fc0,'timestamp':new Date()[_0xe22c28(0x1a2)](),'expiry':_0x15a6da},_0x15a6da!='reject'?(await tgBot[_0xe22c28(0x189)](_0x2b1b1a['chat']['id'],_0xe22c28(0x1e6),{'parse_mode':_0xe22c28(0x1df)})['catch'](_0x4e28b7=>{telegramError(_0x4e28b7);}),io['to'](_0x519339)[_0xe22c28(0x17b)](_0xe22c28(0x205),{'access':{'allow':![],'reason':_0xe22c28(0x1c3),'token':null}})):(await tgBot[_0xe22c28(0x189)](_0x2b1b1a[_0xe22c28(0x1e3)]['id'],_0xe22c28(0x12d))['catch'](_0x3d3c08=>{telegramError(_0x3d3c08);}),io['to'](_0x519339)['emit']('status',{'access':{'allow':![],'reason':_0xe22c28(0x145),'token':null}}));}),tgBot[_0x5b5b75(0x13e)](_0x5b5b75(0x25e));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x548c11=_0x2acf75;return dbConfig[_0x548c11(0x183)](_0x548c11(0x122))[_0x548c11(0x22c)](_0x548c11(0x2a2))[_0x548c11(0x1e2)]({'status':_0x548c11(0x134)})['value']()||[];}function getDisabledBots(){const _0x5b34d2=_0x2acf75;return dbConfig[_0x5b34d2(0x183)](_0x5b34d2(0x122))['sortBy'](_0x5b34d2(0x2a2))[_0x5b34d2(0x1e2)]({'status':_0x5b34d2(0x1a7)})['value']()||[];}function getBotAttributes(_0x1b92eb){const _0x5f29d9=_0x2acf75;let _0x7bf89b={};const _0x422342=configpath+_0x5f29d9(0x21f)+_0x1b92eb+_0x5f29d9(0x279),_0x3e24be=fs[_0x5f29d9(0x12a)](_0x422342);if(_0x3e24be){const _0x33f9cb=fs[_0x5f29d9(0x270)](_0x422342);try{const _0x106096=JSON[_0x5f29d9(0x2ac)](_0x33f9cb),_0x5646dc=_0x106096?_0x106096[_0x5f29d9(0x14e)][0x0][_0x5f29d9(0x1cc)]:![];_0x7bf89b[_0x5f29d9(0x2ed)]=_0x5646dc?'auto':'manual',_0x7bf89b[_0x5f29d9(0x2c3)]=_0x106096?_0x106096[_0x5f29d9(0x14e)][0x0][_0x5f29d9(0x2c3)]:_0x5f29d9(0x2cc)+_0x1b92eb;}catch(_0x43bd56){_0x7bf89b[_0x5f29d9(0x2ed)]=_0x5f29d9(0x16d),_0x7bf89b['botname']=_0x5f29d9(0x2cc)+_0x1b92eb;}}else _0x7bf89b[_0x5f29d9(0x2ed)]=_0x5f29d9(0x16d),_0x7bf89b[_0x5f29d9(0x2c3)]=_0x5f29d9(0x2cc)+_0x1b92eb;return _0x7bf89b;}function getBotsWithMode(){const _0x530f7e=_0x2acf75,_0x2194c7=dbConfig['get']('bots')[_0x530f7e(0x22c)]('botID')[_0x530f7e(0x2cf)]()||[];return _0x2194c7[_0x530f7e(0x2a0)](_0x4f6d95=>{const _0x59ccd1=_0x530f7e;let _0x1319a5=getBotAttributes(_0x4f6d95[_0x59ccd1(0x2a2)]);_0x4f6d95[_0x59ccd1(0x2ed)]=_0x1319a5[_0x59ccd1(0x2ed)];}),_0x2194c7;}function getBotExchanges(){const _0x11586a=_0x2acf75;let _0x59d7c1=[];const _0x2e4994=dbConfig['get']('bots')[_0x11586a(0x22c)](_0x11586a(0x2a2))[_0x11586a(0x2cf)]()||[];_0x2e4994['forEach'](_0x795678=>{const _0xb2c6b7=_0x11586a;if(_0x795678[_0xb2c6b7(0x205)]==_0xb2c6b7(0x134)){const _0x2606a2=configpath+_0xb2c6b7(0x21f)+_0x795678[_0xb2c6b7(0x2a2)]+_0xb2c6b7(0x279),_0x5dfec2=fs[_0xb2c6b7(0x12a)](_0x2606a2);let _0x121d2d;if(_0x5dfec2){const _0x2ce658=fs[_0xb2c6b7(0x270)](_0x2606a2);try{const _0x357a1f=JSON[_0xb2c6b7(0x2ac)](_0x2ce658);_0x121d2d=_0x357a1f?_0x357a1f[_0xb2c6b7(0x14e)][0x0]['exchange']:null;}catch(_0x5360f1){}}if(_0x121d2d)_0x59d7c1['push'](_0x121d2d);}});const _0x496b36=[...new Set(_0x59d7c1)][_0x11586a(0x177)]();return _0x496b36;}async function initUser(){const _0x2371ab=_0x2acf75;if(!settings[_0x2371ab(0x201)]){const _0x5de75e=uuidRandom();mixpanel[_0x2371ab(0x1b7)](_0x5de75e),updateSetting(_0x2371ab(0x201),_0x5de75e);}}async function initSecure(){const _0x19c44c=_0x2acf75;let _0x48def7=getSecure();if(!_0x48def7[_0x19c44c(0x2d2)]('secret')){let _0x374537=await generateKeys();_0x48def7[_0x19c44c(0x152)]=_0x374537[_0x19c44c(0x152)],_0x48def7[_0x19c44c(0x20c)]=_0x374537[_0x19c44c(0x20c)],_0x48def7[_0x19c44c(0x2eb)]=crypto['randomBytes'](0x20)[_0x19c44c(0x2ae)](_0x19c44c(0x276));;storeSecure(_0x48def7);}}function getSettings(){const _0x16534e=_0x2acf75;return dbSettings[_0x16534e(0x183)](_0x16534e(0x159))[_0x16534e(0x2cf)]()||{};}function getSecure(){const _0x2b2253=_0x2acf75;return dbSecure[_0x2b2253(0x183)](_0x2b2253(0x16a))[_0x2b2253(0x2cf)]()||{};}function getBlacklist(){const _0x303105=_0x2acf75;return dbSecure[_0x303105(0x183)](_0x303105(0x212))[_0x303105(0x2cf)]()||[];}function broadcastToBots(_0x308459,_0x63ed11){const _0x1f501d=_0x2acf75;config[_0x1f501d(0x2a0)](_0x4509d4=>{const _0x425d8b=_0x1f501d;if(_0x4509d4[_0x425d8b(0x205)]=='enabled'&&_0x4509d4[_0x425d8b(0x2c6)]==_0x425d8b(0x253)){if(pid[_0x4509d4[_0x425d8b(0x2a2)]])pid[_0x4509d4[_0x425d8b(0x2a2)]][_0x425d8b(0x2ea)]({[_0x308459]:_0x63ed11});}});}function storeSettings(_0x1403dc,_0x5047b5=![]){const _0x480a20=_0x2acf75;_0x1403dc={...settings,..._0x1403dc};if(_0x5047b5&&_0x1403dc['bbPassword']!=_0x480a20(0x2c0)&&_0x1403dc[_0x480a20(0x227)]!=_0x480a20(0x1f6)&&_0x1403dc[_0x480a20(0x227)]!=''){const _0x5382dc=crypt['decrypt'](secure[_0x480a20(0x20c)],_0x1403dc[_0x480a20(0x227)])['message'][_0x480a20(0x1ef)]('@')[0x0],_0x3c617d=bcrypt[_0x480a20(0x15f)](_0x5382dc,saltRounds);_0x1403dc={..._0x1403dc,'bbPassword':_0x3c617d};}if(_0x5047b5&&_0x1403dc[_0x480a20(0x2b0)]!='************'&&_0x1403dc['telegramToken']!=_0x480a20(0x1f6)&&_0x1403dc[_0x480a20(0x2b0)]!=''){const _0x59e936=crypt[_0x480a20(0x1bd)](secure['privateKey'],_0x1403dc['telegramToken'])[_0x480a20(0x2af)][_0x480a20(0x1ef)]('@')[0x0];_0x1403dc={..._0x1403dc,'telegramToken':_0x59e936};}const _0x34705e=_0x1403dc[_0x480a20(0x2b0)]!='************'&&_0x1403dc[_0x480a20(0x2b0)]!=settings[_0x480a20(0x2b0)]||_0x1403dc[_0x480a20(0x1eb)]!=settings[_0x480a20(0x1eb)],_0x24faa9=_0x1403dc[_0x480a20(0x2b0)]==''||_0x1403dc[_0x480a20(0x1eb)]=='';if(_0x34705e)_0x1403dc[_0x480a20(0x28e)]=_0x480a20(0x17e);for(const [_0x286ff5,_0x23d77b]of Object[_0x480a20(0x24f)](_0x1403dc)){if(_0x286ff5==_0x480a20(0x2b0)&&_0x23d77b=='************'){_0x1403dc['telegramToken']=settings[_0x480a20(0x2b0)];continue;};if(_0x286ff5==_0x480a20(0x227)&&_0x23d77b==_0x480a20(0x2c0)){_0x1403dc[_0x480a20(0x227)]=settings[_0x480a20(0x227)];continue;};dbSettings[_0x480a20(0x29d)]('settings.'+_0x286ff5,_0x23d77b)['write']();}settings=_0x1403dc,io['to'](_0x480a20(0x275))[_0x480a20(0x17b)]('settings',cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x480a20(0x264),settings[_0x480a20(0x264)]);if(_0x34705e&&!_0x24faa9)initTelegram();if(_0x34705e&&_0x24faa9)disableTelegram();getAllClients()[_0x480a20(0x2a0)](_0x27694c=>{const _0x2b2a0f=_0x480a20;getSocket(_0x27694c['id'])[_0x2b2a0f(0x17b)](_0x2b2a0f(0x205),{'access':{'allow':![],'reason':_0x2b2a0f(0x1c3),'token':null}});});}function updateSetting(_0x93edd3,_0x4b9902){const _0x11b992=_0x2acf75;dbSettings[_0x11b992(0x29d)](_0x11b992(0x194)+_0x93edd3,_0x4b9902)[_0x11b992(0x23d)](),settings=getSettings(),io['to'](_0x11b992(0x275))[_0x11b992(0x17b)](_0x11b992(0x159),cleanSettings());}function storeSecure(_0x13a4bb){const _0x408ed=_0x2acf75;dbSecure[_0x408ed(0x183)](_0x408ed(0x16a))['push'](_0x13a4bb)[_0x408ed(0x23d)](),secure=_0x13a4bb;}function addBlacklist(_0x2960d3){const _0x2767cb=_0x2acf75;cleanBlacklist();let _0xaa7e87;devices[_0x2960d3][_0x2767cb(0x25f)]?_0xaa7e87=Math[_0x2767cb(0x15a)](devices[_0x2960d3][_0x2767cb(0x25f)][_0x2767cb(0x1cd)],loginExpiry):_0xaa7e87=loginExpiry,dbSecure['get']('blacklist')[_0x2767cb(0x2b4)]({'expiry':new Date()[_0x2767cb(0x1a2)]()+_0xaa7e87*0x3c*0x3e8,'token':devices[_0x2960d3][_0x2767cb(0x233)]['token']})[_0x2767cb(0x23d)](),blacklist=dbSecure[_0x2767cb(0x183)](_0x2767cb(0x212))['value']();}function _0x419f(){const _0x5a3148=['slice','***','error\x20while\x20deleting\x20config\x20files:\x20','store-configuration','631345xJaVPd','update','All','crypto','Starting\x20Balance\x20Bot\x20','\x20|\x20','args','SIGTERM','userid','toggleBotMode','backup-full@','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','status','writeFileSync','toggle-bot-mode','output-000.log','NTBA_FIX_319','reinstall','disconnect','privateKey','search','storeConfiguration','650562EscOKV','jsonwebtoken','isValid','blacklist','Unauthorized\x20attempt\x20to\x20show\x20configuration','-events.json','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','server','temporaryAccessAllowed','/on\x20-\x20start\x20bot(s)\x0a','handshake','sendMetricsTelegram','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','https://api.ipify.org?format=json','backup','bot-','notification','delete-bot','post','replace',',\x20must\x20be\x20a\x204\x20digit\x20number','place-order','\x20>\x20','bbPassword','kind',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','endsWith','join','sortBy','Allow\x20login\x20from\x20IP\x20address\x20<b>','date-fns','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20add\x20bot','remoteAddress','access','ipc','/download/:type','mkdirSync','/:bot/support','compareSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','output-003.log','lastmsgtelegram','order','write','cancelLoading','/status\x20-\x20show\x20bot(s)\x20status\x0a','logout','lastmsgemitted','login\x20not\x20required','clientip','init','bb-secure.json','Invalid\x20username\x20or\x20IP\x20address','type','output-002.log','emitHistory','/off\x20-\x20stop\x20bot(s)\x0a','/:bot/history','kill','login\x20required','express-fileupload','entries','Logged\x20out\x20user\x20...','copyFileSync','User\x20has\x20been\x20validated','running','node-zip','encryptedUuid','zip/','1793cnxGLN','7phSiFc','map','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','download','socket','login\x20token\x20generated','callback_query','telegramIpApproval','starting\x20bot\x20|\x20Bot\x20','Restoring\x20bot(s)\x20from\x20backup','params','get-messages','onepagemode','format','Error:\x20Invalid\x20argument\x20','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','No\x20authentication\x20token','ipaddr.js','Setting\x20access:\x20','debug','number','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','apiKey','readFileSync','idling\x20bot\x20\x20\x20|\x20Bot\x20','mtime','telegramChatId','storeHeadless','botmanager','hex','restarting\x20Bot\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','-config.json','login\x20token\x20valid','any','RSA','files','telegramEnabled','auth','name','placeOrder','sendFile','DEFLATE','</b>\x20?','127.0.0.1','2FA','binary','Failed\x20to\x20download\x20','All\x20bots','exp','whitelistEnabled','event','sendPortfolioTelegram','telegramEvents','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','config/','Invalid\x20Telegram\x20token','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Starting\x20Balance\x20Bot\x20reinstallation','1000','1890PlxefM','temporary\x20token\x20generated','get-portfolio','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','reason','Crypt','logs/','Unauthorized\x20attempt\x20to\x20confirm\x20message','set','Markdown','bb/','forEach',':\x20Bot\x20Mgr\x20>\x20','botID','new','Invalid\x20IP\x20address','yes','/output-000.log','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','error','pidRefreshToken','track','warning','parse','store-settings','toString','message','telegramToken','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Orders','password','push','tkn','All\x20bots\x20running\x20right\x20now','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','path','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20(2)','Unauthorized\x20attempt\x20to\x20download\x20','.zip','************','/:bot/coins','add','botname','stringify','1381182cONiDU','live','pidExpireLogin','Yes','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','sockets','lowdb','Bot\x20','store','telegrammsg','value','user','new-disabled','hasOwnProperty','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','404\x20Not\x20Found','lowdb/adapters/FileSync','find','static','data','once','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Notifications\x20disabled','min','646882oGFJuF','rmSync','bb-settings.json','/:bot/performance','getHours','Server','Unauthorized\x20attempt\x20to\x20get\x20events','_data','onText','host','stopPolling','bbUsername','send','secret','Backup\x20file\x20unzipped\x20and\x20stored','mode','\x20|\x20client:\x20...','version','started','hybrid-crypto-js','index.html','padStart','30\x20min','getPortfolio','Backup\x20file\x20uploaded','bots','getMinutes','enabled\x20Bot\x20','getSeconds','log','backup-full.zip','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','constructor','existsSync','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Login\x20rejected','-performance.json','\x20to\x20','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20portfolio','simple','sign','enabled','includes','referer','add-bot','answerCallbackQuery','verify','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','assign','request','removeListener','node-telegram-bot-api','toIPv4MappedAddress','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','sha256','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','version.json','2FA\x20login\x20rejected','*$1*','(((.+)+)+)+$','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','build2','function','reset-history','show','Your\x20installation\x20is\x20already\x20up\x20to\x20date','bot','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20update\x20bot','bbvReceive','publicKey','Unauthorized\x20attempt\x20to\x20delete\x20alerts','toIPv4Address','Unauthorized\x20attempt\x20to\x20delete\x20bot','bcryptjs','graphql-request','/disable\x20-\x20disable\x20notifications\x0a','settings','max','polling_error','uuid','test','env','hashSync','getFullYear','statSync','backupfile','conn','reinstall-bb','\x20mode','isDirectory','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','success','/upload-backup','secure','/update\x20-\x20update\x20Balance\x20Bot\x0a','storeFiat','manual','connection','Starting\x20Balance\x20Bot\x20update','then','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','full','2FA\x20login\x20required','clients','yargs/yargs','login','sort','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','port','Restore\x20process\x20aborted','emit','Unauthorized\x20login\x20attempt\x20(timeout)','backup-full','all','Invalid\x20authentication\x20token\x20(1)','SIGINT','bot.js','cloneDeep','get','randomFillSync','isIPv4MappedAddress','http','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','sendMessage','delete-alerts','2FA\x20required','store-headless','get-backup-files','/:bot/configuration','readdirSync','\x20minutes','<b>Balance\x20Bot\x20Status:</b>\x0a','express','telegram2FaApproval','settings.','socket.io','build','from','/enable\x20-\x20enable\x20notifications\x0a','file','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','5\x20min','Bot\x20Mgr\x20>\x20','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','invalid\x20credentials','3203544zLAhpw','createWriteStream','showConfig','getTime','startsWith','No\x20bots\x20running\x20right\x20now','confirm-message','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','disabled','inherit','latestversion','access\x20timeout','size','::1','1598022kcKPhM','catch','1bMhplk','output-001.log','token','\x20only\x0a','bbvNew','argv','6b67f3d61ee94b8f5c80b4affef4c4d9','keys','alias','-----------------------------------------------------------------------------------','connected','temporary\x20access\x20not\x20allowed','stopped','alerts','decrypt','Invalid\x20authentication\x20token\x20(2)','unlinkSync','fork','telegram','reset-password','reload','logged\x20out','auto','3000','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','use','allow','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','headless','expiry','reject','getMonth','loginRequired','Logged\x20in\x20user\x20...','headers','length','-results.json','defaults','/help\x20-\x20show\x20available\x20commands\x0a','apiSecret','match','temp/','Unauthorized\x20attempt\x20to\x20log\x20out','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','backup-files','remove','HTML','4cpBJxD','initclient','filter','chat','Notifications\x20types:\x20','getDate','Login\x20accepted','orders','stop','title','util','telegramUsername','2FA\x20login\x20token\x20generated','Access\x20enabled\x20for\x20','createServer','split','15\x20min','exit','username','timestamp','removeAllListeners'];_0x419f=function(){return _0x5a3148;};return _0x419f();}function cleanBlacklist(){const _0x297bb7=_0x2acf75;let _0x55942c=dbSecure[_0x297bb7(0x183)](_0x297bb7(0x212))[_0x297bb7(0x182)]()['value'](),_0x1c1567=new Date()[_0x297bb7(0x1a2)]();_0x55942c[_0x297bb7(0x2a0)](_0x5d3387=>{const _0x5d9478=_0x297bb7;_0x5d3387[_0x5d9478(0x1cd)]<_0x1c1567&&dbSecure[_0x5d9478(0x183)](_0x5d9478(0x212))['remove']({'expiry':_0x5d3387['expiry']})['write']();});}function initStates(){const _0x3842b8=_0x2acf75;let _0x28792b=getConfiguration();_0x28792b[_0x3842b8(0x2a0)](_0xd932e6=>{const _0x2cd154=_0x3842b8;_0xd932e6[_0x2cd154(0x2c6)]=_0x2cd154(0x1bb);}),storeConfiguration(_0x28792b);}function onKeys(){const _0x10083e=new RSA();return new Promise(_0x534437=>{const _0x523b14=_0x485e;_0x10083e['generateKeyPairAsync']()[_0x523b14(0x170)](_0x29ec1e=>{_0x534437(_0x29ec1e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5d629f=_0x2acf75;let _0x4546b2=getSettings(),_0x314335=![];!_0x4546b2['hasOwnProperty'](_0x5d629f(0x23b))&&(_0x4546b2['lastmsgtelegram']=0x0,_0x314335=!![]);!_0x4546b2[_0x5d629f(0x2d2)](_0x5d629f(0x241))&&(_0x4546b2[_0x5d629f(0x241)]=0x0,_0x314335=!![]);!_0x4546b2[_0x5d629f(0x2d2)](_0x5d629f(0x1a9))&&(_0x4546b2[_0x5d629f(0x1a9)]='0.0.0',_0x314335=!![]);!_0x4546b2[_0x5d629f(0x2d2)](_0x5d629f(0x264))&&(_0x4546b2[_0x5d629f(0x264)]=![],_0x314335=!![]);if(_0x314335)storeSettings(_0x4546b2);}function storeConfiguration(_0x357018){const _0x20dedb=_0x2acf75;dbConfig[_0x20dedb(0x183)](_0x20dedb(0x122))[_0x20dedb(0x1de)]()[_0x20dedb(0x23d)](),_0x357018[_0x20dedb(0x2a0)](_0x52a9d1=>{const _0x4a6995=_0x20dedb;delete _0x52a9d1[_0x4a6995(0x2ed)];}),dbConfig['get'](_0x20dedb(0x122))['push'](..._0x357018)[_0x20dedb(0x23d)](),config=_0x357018;}function resetPassword(){const _0x264a41=_0x2acf75;tgBot&&settings[_0x264a41(0x273)]&&(tgBot[_0x264a41(0x13e)]('callback_query'),tgBot[_0x264a41(0x189)](settings[_0x264a41(0x273)],_0x264a41(0x2d4),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x264a41(0x2a5)},{'text':'no','callback_data':'no'}]]}})[_0x264a41(0x1ae)](_0x47cb66=>{telegramError(_0x47cb66);}),tgBot['on'](_0x264a41(0x25e),async _0x3ed74d=>{const _0x18f0c2=_0x264a41,_0x230ab6=_0x3ed74d[_0x18f0c2(0x2d9)],_0x143003=_0x3ed74d[_0x18f0c2(0x2af)];tgBot['answerCallbackQuery'](_0x3ed74d['id'])['then'](async()=>{const _0x224533=_0x18f0c2;if(_0x230ab6!='no'){const _0x3953f2=0xf,_0x4bad55=_0x224533(0x1ca),_0x4ad328=Array[_0x224533(0x197)](crypto[_0x224533(0x184)](new Uint32Array(_0x3953f2)))[_0x224533(0x259)](_0x2b086e=>_0x4bad55[_0x2b086e%_0x4bad55['length']])['join'](''),_0xaed46e=bcrypt[_0x224533(0x15f)](_0x4ad328,saltRounds);storeSettings({'bbPassword':_0xaed46e}),await tgBot[_0x224533(0x189)](_0x143003[_0x224533(0x1e3)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x4ad328,{'parse_mode':_0x224533(0x1df)})[_0x224533(0x1ae)](_0x417a3c=>{telegramError(_0x417a3c);});}else await tgBot[_0x224533(0x189)](_0x143003[_0x224533(0x1e3)]['id'],'Password\x20reset\x20rejected')[_0x224533(0x1ae)](_0x321e25=>{telegramError(_0x321e25);});}),tgBot[_0x18f0c2(0x13e)](_0x18f0c2(0x25e));}));}async function confirmRestore(_0x4c6267,_0x3008ad){const _0x3e7fdd=_0x2acf75;io['to'](_0x3e7fdd(0x275))[_0x3e7fdd(0x17b)](_0x3e7fdd(0x220),_0x3e7fdd(0x2d3),_0x3e7fdd(0x168)),tgBot&&settings[_0x3e7fdd(0x273)]&&(tgBot[_0x3e7fdd(0x13e)](_0x3e7fdd(0x25e)),await tgBot[_0x3e7fdd(0x189)](settings['telegramChatId'],_0x3e7fdd(0x13b),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3e7fdd(0x2a5),'callback_data':_0x3e7fdd(0x2a5)},{'text':'no','callback_data':'no'}]]}})[_0x3e7fdd(0x1ae)](_0x31a780=>{telegramError(_0x31a780);}),tgBot['on'](_0x3e7fdd(0x25e),async _0x204342=>{const _0x17c220=_0x3e7fdd,_0x193df0=_0x204342[_0x17c220(0x2d9)],_0x2db8dc=_0x204342[_0x17c220(0x2af)];tgBot[_0x17c220(0x138)](_0x204342['id'])[_0x17c220(0x170)](async()=>{const _0x35f72b=_0x17c220;_0x193df0=='yes'?(await tgBot[_0x35f72b(0x189)](_0x2db8dc[_0x35f72b(0x1e3)]['id'],_0x35f72b(0x261),{'parse_mode':'HTML'})['catch'](_0x169008=>{telegramError(_0x169008);}),unzipFile(_0x4c6267,_0x3008ad)):(logger[_0x35f72b(0x26b)](_0x35f72b(0x17a)),await tgBot['sendMessage'](_0x2db8dc[_0x35f72b(0x1e3)]['id'],_0x35f72b(0x17a))[_0x35f72b(0x1ae)](_0x5adbcf=>{telegramError(_0x5adbcf);}));}),tgBot[_0x17c220(0x13e)](_0x17c220(0x25e));}));}function getServerTime(){const _0x14f35a=_0x2acf75,_0x5c85ba=new Date();return _0x5c85ba[_0x14f35a(0x160)]()+'/'+(_0x5c85ba['getMonth']()+0x1)[_0x14f35a(0x2ae)]()['padStart'](0x2,'0')+'/'+_0x5c85ba[_0x14f35a(0x1e5)]()[_0x14f35a(0x2ae)]()[_0x14f35a(0x2f3)](0x2,'0')+'\x20'+_0x5c85ba[_0x14f35a(0x2e2)]()['toString']()[_0x14f35a(0x2f3)](0x2,'0')+':'+_0x5c85ba['getMinutes']()[_0x14f35a(0x2ae)]()[_0x14f35a(0x2f3)](0x2,'0')+':'+_0x5c85ba[_0x14f35a(0x125)]()[_0x14f35a(0x2ae)]()[_0x14f35a(0x2f3)](0x2,'0');}function getTimeStamp(){const _0x1ed0a3=_0x2acf75,_0x188c48=shiftedTime();return _0x188c48[_0x1ed0a3(0x160)]()+'/'+(_0x188c48[_0x1ed0a3(0x1cf)]()+0x1)[_0x1ed0a3(0x2ae)]()[_0x1ed0a3(0x2f3)](0x2,'0')+'/'+_0x188c48[_0x1ed0a3(0x1e5)]()['toString']()[_0x1ed0a3(0x2f3)](0x2,'0')+'\x20'+_0x188c48[_0x1ed0a3(0x2e2)]()[_0x1ed0a3(0x2ae)]()['padStart'](0x2,'0')+':'+_0x188c48['getMinutes']()['toString']()[_0x1ed0a3(0x2f3)](0x2,'0')+':'+_0x188c48[_0x1ed0a3(0x125)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x18a78c=_0x2acf75,_0x116dc3=shiftedTime();return _0x116dc3[_0x18a78c(0x160)]()+(_0x116dc3[_0x18a78c(0x1cf)]()+0x1)['toString']()[_0x18a78c(0x2f3)](0x2,'0')+_0x116dc3[_0x18a78c(0x1e5)]()[_0x18a78c(0x2ae)]()[_0x18a78c(0x2f3)](0x2,'0')+'-'+_0x116dc3[_0x18a78c(0x2e2)]()[_0x18a78c(0x2ae)]()[_0x18a78c(0x2f3)](0x2,'0')+_0x116dc3[_0x18a78c(0x123)]()[_0x18a78c(0x2ae)]()[_0x18a78c(0x2f3)](0x2,'0')+_0x116dc3[_0x18a78c(0x125)]()[_0x18a78c(0x2ae)]()[_0x18a78c(0x2f3)](0x2,'0');}function shiftedTime(){const _0x14fab2=_0x2acf75,_0x28e03a=new Date();let _0x415410=_0x28e03a;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x415410=fns[_0x14fab2(0x2c2)](_0x28e03a,{'hours':settings['timeshift']});return _0x415410;}function startScheduler(){const _0x589a13=_0x2acf75,_0x28eac0=new Date()['getUTCHours'](),_0x4d0b1d=shiftedTime()[_0x589a13(0x2e2)]();_0x4d0b1d==0x4&&backupConfigFiles();_0x4d0b1d==0x0&&rotateLogFiles();_0x28eac0%0x6==0x0&&triggerAnalytics();_0x28eac0%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5bce82){const _0x14f227=_0x2acf75;logger[_0x14f227(0x26b)]('Restore\x20backup\x20file\x20'+_0x5bce82);const _0x54432c=getBotsWithMode();_0x54432c[_0x14f227(0x1d3)]>0x0?confirmRestore(configbackuppath,_0x5bce82):unzipFile(configbackuppath,_0x5bce82);}async function getBackupFiles(_0x823dc=null){const _0x2c17b8=_0x2acf75;let _0x4ce5cb=[],_0x112221=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x112221['sort']((_0x58500e,_0x115706)=>_0x58500e[_0x2c17b8(0x280)]<_0x115706['name']?0x1:_0x115706[_0x2c17b8(0x280)]<_0x58500e[_0x2c17b8(0x280)]?-0x1:0x0),_0x112221['forEach'](_0xa1d4f5=>{const _0x396e95=_0x2c17b8;if(!_0xa1d4f5[_0x396e95(0x166)]()&&_0xa1d4f5['name'][_0x396e95(0x1a3)]('backup-full@')&&_0xa1d4f5[_0x396e95(0x280)][_0x396e95(0x22a)](_0x396e95(0x2bf))){const _0x3cd081=formatDate(fs[_0x396e95(0x161)](configbackuppath+_0xa1d4f5[_0x396e95(0x280)])[_0x396e95(0x272)]);_0x4ce5cb[_0x396e95(0x2b4)]({'name':_0xa1d4f5[_0x396e95(0x280)],'mtime':_0x3cd081});}});if(_0x823dc)io['to'](_0x823dc)['emit'](_0x2c17b8(0x1dd),_0x4ce5cb);else return _0x4ce5cb;}async function backupConfigFiles(){const _0x4b38b7=_0x2acf75;await zipFiles(_0x4b38b7(0x17d));const _0x1d00ce=getCleanTimeStamp();fs[_0x4b38b7(0x251)](zippath+_0x4b38b7(0x127),configbackuppath+(_0x4b38b7(0x203)+_0x1d00ce+'.zip'));let _0x4ac29c=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4ac29c[_0x4b38b7(0x177)]((_0x22c6d2,_0x1ec124)=>_0x22c6d2[_0x4b38b7(0x280)]<_0x1ec124[_0x4b38b7(0x280)]?0x1:_0x1ec124['name']<_0x22c6d2[_0x4b38b7(0x280)]?-0x1:0x0),_0x4ac29c[_0x4b38b7(0x1d3)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4ac29c[maxBackups]['name']);}function rotateLogFiles(){const _0x13b644=_0x2acf75,_0xffd4da=fs[_0x13b644(0x161)](logspath+_0x13b644(0x208)),_0x157b1f=_0xffd4da[_0x13b644(0x1ab)]/0x400;if(_0x157b1f>0x64){let _0xa1e7f8=fs[_0x13b644(0x18f)](logspath,{'withFileTypes':!![]});_0xa1e7f8[_0x13b644(0x177)]((_0x503d22,_0x2241cc)=>_0x503d22[_0x13b644(0x280)]<_0x2241cc[_0x13b644(0x280)]?0x1:_0x2241cc[_0x13b644(0x280)]<_0x503d22[_0x13b644(0x280)]?-0x1:0x0),_0xa1e7f8['forEach'](_0x45dd96=>{const _0x38dd9b=_0x13b644;if(_0x45dd96[_0x38dd9b(0x280)]=='output-002.log')fs['copyFileSync'](logspath+_0x45dd96[_0x38dd9b(0x280)],logspath+_0x38dd9b(0x23a));if(_0x45dd96['name']==_0x38dd9b(0x1b0))fs[_0x38dd9b(0x251)](logspath+_0x45dd96[_0x38dd9b(0x280)],logspath+_0x38dd9b(0x248));_0x45dd96['name']==_0x38dd9b(0x208)&&(fs[_0x38dd9b(0x251)](logspath+_0x45dd96[_0x38dd9b(0x280)],logspath+_0x38dd9b(0x1b0)),fs[_0x38dd9b(0x206)](logspath+_0x45dd96[_0x38dd9b(0x280)],''));});}}async function zipFiles(_0x339bb1){const _0x572001=_0x2acf75;let _0x96311c;if(_0x339bb1=='logs')_0x96311c=logspath;if(_0x339bb1==_0x572001(0x21e))_0x96311c=configpath;if(_0x339bb1==_0x572001(0x17d))_0x96311c=configpath;let _0x103c60=fs[_0x572001(0x18f)](_0x96311c,{'withFileTypes':!![]});const _0x40fd9f=new require(_0x572001(0x254))();_0x103c60[_0x572001(0x2a0)](_0x2ef4f0=>{const _0x40dee1=_0x572001;if(!_0x2ef4f0[_0x40dee1(0x166)]()){let _0x5bd2f7=fs[_0x40dee1(0x270)](_0x96311c+_0x2ef4f0[_0x40dee1(0x280)]);if(_0x339bb1==_0x40dee1(0x21e)){const _0x48c6f7=/^bot-[0-9]{3}-config.json$/,_0x498af5=_0x48c6f7[_0x40dee1(0x15d)](_0x2ef4f0[_0x40dee1(0x280)]);if(_0x498af5){const _0x41098e=JSON[_0x40dee1(0x2ac)](_0x5bd2f7);_0x41098e[_0x40dee1(0x14e)][0x0]&&(_0x41098e['bot'][0x0][_0x40dee1(0x26f)]=_0x40dee1(0x1f6),_0x41098e[_0x40dee1(0x14e)][0x0][_0x40dee1(0x1d7)]=_0x40dee1(0x1f6)),_0x5bd2f7=JSON[_0x40dee1(0x2c4)](_0x41098e,null,0x2);}if(_0x2ef4f0[_0x40dee1(0x280)]==_0x40dee1(0x2e0)){const _0x115a43=JSON[_0x40dee1(0x2ac)](_0x5bd2f7);if(_0x115a43['settings'][_0x40dee1(0x1d0)])_0x115a43[_0x40dee1(0x159)][_0x40dee1(0x1d0)]=![];if(_0x115a43[_0x40dee1(0x159)][_0x40dee1(0x227)])_0x115a43[_0x40dee1(0x159)][_0x40dee1(0x227)]=_0x40dee1(0x1f6);if(_0x115a43[_0x40dee1(0x159)]['telegramToken'])_0x115a43[_0x40dee1(0x159)][_0x40dee1(0x2b0)]='***';if(_0x115a43[_0x40dee1(0x159)][_0x40dee1(0x273)])_0x115a43[_0x40dee1(0x159)][_0x40dee1(0x273)]=null;_0x5bd2f7=JSON['stringify'](_0x115a43,null,0x2);}if(_0x2ef4f0['name']!='bb-secure.json')_0x40fd9f[_0x40dee1(0x199)](_0x2ef4f0['name'],_0x5bd2f7);}else _0x40fd9f['file'](_0x2ef4f0['name'],_0x5bd2f7);}});const _0x5a7b14=_0x40fd9f['generate']({'base64':![],'compression':_0x572001(0x283)});fs[_0x572001(0x206)](zippath+(_0x339bb1+_0x572001(0x2bf)),_0x5a7b14,_0x572001(0x287));}async function unzipFile(_0x423b0c,_0x5946fb){const _0x3558b5=_0x2acf75;fs[_0x3558b5(0x18f)](configpath,{'withFileTypes':!![]})['forEach'](_0x381630=>{const _0x4a24ec=_0x3558b5;if(!_0x381630[_0x4a24ec(0x166)]())fs[_0x4a24ec(0x2df)](configpath+_0x381630[_0x4a24ec(0x280)]);});const _0x1ef6f2=fs['readFileSync'](_0x423b0c+_0x5946fb,_0x3558b5(0x287)),_0x551dc2=new require(_0x3558b5(0x254))(_0x1ef6f2,{'base64':![],'checkCRC32':!![]});Object[_0x3558b5(0x1b6)](_0x551dc2[_0x3558b5(0x27d)])['forEach'](_0x4bd5b2=>{const _0x4b0244=_0x3558b5,_0x571b09=_0x551dc2[_0x4b0244(0x27d)][_0x4bd5b2];fs[_0x4b0244(0x206)](configpath+_0x571b09[_0x4b0244(0x280)],_0x571b09[_0x4b0244(0x2e5)]);}),fs[_0x3558b5(0x18f)](temppath,{'withFileTypes':!![]})['forEach'](_0x1b5e46=>{const _0x3327bd=_0x3558b5;if(!_0x1b5e46[_0x3327bd(0x166)]())fs[_0x3327bd(0x2df)](temppath+_0x1b5e46['name']);}),logger[_0x3558b5(0x26b)](_0x3558b5(0x2ec)),process[_0x3558b5(0x2ea)]({'restore':!![]},_0x431cb8=>{});}async function getPublicIp(){const _0x648cc9=_0x2acf75;try{const _0x28d43c=await axios[_0x648cc9(0x183)](_0x648cc9(0x21d));publicip=_0x28d43c['data']['ip'];}catch(_0x39424c){}}async function triggerAnalytics(){const _0x35e48e=_0x2acf75;if(!publicip)await getPublicIp();const _0x334fc2=getBotsWithMode();let _0x5c3a3=0x0;_0x334fc2[_0x35e48e(0x2a0)](_0x427b70=>{const _0x1a3b9e=_0x35e48e;if(_0x427b70['status']===_0x1a3b9e(0x134))_0x5c3a3++;});const _0x3c4425=getBotExchanges();mixpanel[_0x35e48e(0x2aa)](_0x35e48e(0x2e3),{'distinct_id':settings[_0x35e48e(0x201)],'ip':publicip,'version':serverversion,'numbots':_0x334fc2[_0x35e48e(0x1d3)],'numbotsenabled':_0x5c3a3,'exchanges':_0x3c4425});}async function getMessages(){const _0x3218ec=_0x2acf75,_0x424fc2=_0x3218ec(0x19a),_0x25cb7e=new GraphQLClient(_0x424fc2),_0x272fa5={'authorization':_0x3218ec(0x26e)},_0x22cd5f=serverversion[_0x3218ec(0x1ef)]('.'),_0xa2812d=_0x22cd5f[0x0]+'.'+_0x22cd5f[0x1],_0x439eec=Math[_0x3218ec(0x2dd)](settings[_0x3218ec(0x23b)],settings['lastmsgemitted']),_0x5da729={'last':parseInt(_0x439eec),'bbm':_0xa2812d},_0x203f1a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2ddcb2;try{_0x2ddcb2=await _0x25cb7e[_0x3218ec(0x13d)](_0x203f1a,_0x5da729,_0x272fa5);}catch(_0x26cf3f){}if(_0x2ddcb2&&_0x2ddcb2['messages']){let _0x13de9b=settings[_0x3218ec(0x23b)];newMessages=[];for(const _0x35a787 of _0x2ddcb2['messages']){newMessages[_0x3218ec(0x2b4)](_0x35a787);if(_0x35a787['bbvNew'])updateSetting(_0x3218ec(0x1a9),_0x35a787[_0x3218ec(0x1b3)]);let _0x2ab381=_0x35a787[_0x3218ec(0x1b3)]?serverversion>=_0x35a787[_0x3218ec(0x1b3)]:![];if(!_0x2ab381&&_0x35a787[_0x3218ec(0x26c)]>_0x13de9b){if(_0x35a787['bbvReceive']===_0x3218ec(0x27b)||serverversion[_0x3218ec(0x1a3)](_0x35a787[_0x3218ec(0x151)])){let _0x1085f9=''+_0x35a787[_0x3218ec(0x1e9)]+'\x0a\x0a'+_0x35a787[_0x3218ec(0x2af)];const _0x3488cb=await sendTelegramMsg(toTelegramMarkdown(_0x1085f9),_0x3218ec(0x29e));if(_0x3488cb)_0x13de9b=_0x35a787[_0x3218ec(0x26c)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x3218ec(0x23b),_0x13de9b),emitMessages();}}function emitMessages(){const _0xee7fdb=_0x2acf75,_0x304d33=settings['lastmsgemitted'];let _0x33ee37=[];newMessages[_0xee7fdb(0x2a0)](_0x5ccb26=>{const _0xfb19e6=_0xee7fdb;_0x5ccb26[_0xfb19e6(0x26c)]>_0x304d33&&_0x33ee37[_0xfb19e6(0x2b4)](_0x5ccb26);}),_0x33ee37[_0xee7fdb(0x1d3)]>0x0&&getAllClients()['forEach'](_0x532aad=>{const _0x38184d=_0xee7fdb;getSocket(_0x532aad['id'])[_0x38184d(0x17b)](_0x38184d(0x2af),_0x33ee37);});}function confirmMessage(_0x4ebacd){const _0x150fca=_0x2acf75;updateSetting(_0x150fca(0x241),Number(_0x4ebacd));}function isNewerVersion(_0x3d8fb3,_0x3b5d68){const _0x1d897f=_0x2acf75,_0x303ac6=_0x3b5d68[_0x1d897f(0x1ef)]('.'),_0x212f7d=_0x3d8fb3[_0x1d897f(0x1ef)]('.');for(var _0x3bac67=0x0;_0x3bac67<_0x212f7d[_0x1d897f(0x1d3)];_0x3bac67++){const _0x261a77=~~_0x212f7d[_0x3bac67],_0x8b1e6c=~~_0x303ac6[_0x3bac67];if(_0x261a77>_0x8b1e6c)return!![];if(_0x261a77<_0x8b1e6c)return![];}return![];}function toTelegramMarkdown(_0x5ef8da){const _0x9f0c70=_0x2acf75,_0x200a7c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4935d4=/\*{2}(.+?)\*{2}/gim;return _0x5ef8da=_0x5ef8da[_0x9f0c70(0x223)](_0x200a7c,'$1_$2_$3')[_0x9f0c70(0x223)](_0x4935d4,_0x9f0c70(0x146)),_0x5ef8da;}async function validateConfigFile(){const _0xa4e7d1=_0x2acf75,_0x231716=dbConfig['get'](_0xa4e7d1(0x122))[_0xa4e7d1(0x22c)]('botID')[_0xa4e7d1(0x2cf)]()||[];if(_0x231716[_0xa4e7d1(0x1d3)]==0x0){let _0x3693f8=0x0,_0x271e36=[];const _0x2d723a=/^bot-([0-9]{3})-config.json$/,_0x1fe38d=fs[_0xa4e7d1(0x18f)](configpath);_0x1fe38d['forEach'](_0x393e4d=>{const _0x283fa7=_0xa4e7d1,_0x4b5ec8=_0x2d723a['exec'](_0x393e4d);if(_0x4b5ec8){const _0x1f36c4=_0x4b5ec8[0x1];let _0x1cfa9b=getBotAttributes(_0x1f36c4);_0x271e36[_0x283fa7(0x2b4)]({'botID':_0x1f36c4,'botname':_0x1cfa9b[_0x283fa7(0x2c3)],'status':'disabled','live':_0x283fa7(0x1bb)}),_0x3693f8++;}}),_0x3693f8!=0x0&&(dbConfig['get'](_0xa4e7d1(0x122))[_0xa4e7d1(0x13c)](_0x271e36)[_0xa4e7d1(0x23d)](),config=_0x271e36,restoredConfigFile=_0x3693f8);}}async function restoreConfigNotify(_0x1dd8fc){const _0x55ad9e=_0x2acf75;let _0x1f0c78;if(restoredConfigFile==0x1)_0x1f0c78=_0x55ad9e(0x148);else _0x1f0c78=_0x55ad9e(0x1a6);if(_0x1dd8fc)io['to'](_0x55ad9e(0x275))[_0x55ad9e(0x17b)]('notification',_0x1f0c78);else{logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](_0x1f0c78),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x55ad9e(0x132)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x55ad9e(0x28e)]!=_0x55ad9e(0x1e7))tgBot[_0x55ad9e(0x189)](settings['telegramChatId'],_0x55ad9e(0x19c)+_0x1f0c78)[_0x55ad9e(0x1ae)](_0x4aa481=>{telegramError(_0x4aa481);});}}function _0x485e(_0x4cdc11,_0x5b4438){const _0x2b0076=_0x419f();return _0x485e=function(_0x2ae383,_0x3a7933){_0x2ae383=_0x2ae383-0x11f;let _0x419fbe=_0x2b0076[_0x2ae383];return _0x419fbe;},_0x485e(_0x4cdc11,_0x5b4438);}function validateCredentials(_0x52ada6,_0x73b644){const _0x112f38=_0x2acf75;if(_0x52ada6[_0x112f38(0x1f2)]==settings[_0x112f38(0x2e9)]&&bcrypt[_0x112f38(0x238)](_0x52ada6[_0x112f38(0x2b3)],settings[_0x112f38(0x227)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x112f38(0x173),'token':null};else{const _0x1748f0=generateLoginToken(_0x73b644);return{'allow':!![],'reason':_0x112f38(0x25d),'token':_0x1748f0};}}else return{'allow':![],'reason':_0x112f38(0x19e),'token':null};}function refreshToken(_0x11ad35){const _0x1e6968=generateLoginToken(_0x11ad35);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1e6968};}function validateAccess(_0x2c4152,_0x42eb57,_0x150611){const _0x46fcdc=_0x2acf75,_0x709f33=_0x150611?_0x150611:devices[_0x42eb57]['ip'];let _0x26ac0c;const _0x29451e=_0x1da89e=>{const _0xd51de1=_0x485e;if(settings[_0xd51de1(0x1d0)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x42eb57)){const _0x134924=generateLoginToken(_0x42eb57);return{'allow':!![],'reason':_0xd51de1(0x1ec),'token':_0x134924};}else return{'allow':![],'reason':_0xd51de1(0x24d),'token':null};}else return _0x26ac0c=validToken(_0x1da89e,_0x42eb57),_0x26ac0c[_0xd51de1(0x2d2)]('success')?{'allow':!![],'reason':_0xd51de1(0x27a),'token':_0x1da89e}:{'allow':![],'reason':_0xd51de1(0x24d),'token':null};}else return{'allow':!![],'reason':_0xd51de1(0x242),'token':null};};if(settings[_0x46fcdc(0x28b)]){let _0x2237c0=[...settings['whitelist'],_0x46fcdc(0x1ac),'::ffff:127.0.0.1',_0x46fcdc(0x285)];if(_0x2237c0[_0x46fcdc(0x135)](_0x709f33))return _0x29451e(_0x2c4152);else{_0x26ac0c=validToken(_0x2c4152,_0x42eb57);if(_0x26ac0c[_0x46fcdc(0x2d2)](_0x46fcdc(0x168)))return _0x29451e(_0x2c4152);else{if(telegramIpApproved(_0x42eb57)){const _0x1f07c8=generateToken(_0x42eb57);return _0x26ac0c=_0x29451e(_0x2c4152),_0x26ac0c[_0x46fcdc(0x1c9)]?{'allow':!![],'reason':_0x46fcdc(0x296),'token':_0x1f07c8}:_0x26ac0c;}else return settings[_0x46fcdc(0x217)]?{'allow':![],'reason':_0x46fcdc(0x18b),'token':null}:{'allow':![],'reason':_0x46fcdc(0x1ba),'token':null};}}}else return _0x29451e(_0x2c4152);}function timelyDecrypt(_0x3d49f1,_0x4d79b1=!![]){const _0x62d70c=_0x2acf75;if(_0x3d49f1)try{const _0x2be72d=crypt[_0x62d70c(0x1bd)](secure['privateKey'],_0x3d49f1)[_0x62d70c(0x2af)],_0x87792=_0x2be72d['split']('@')[0x0],_0x2b8257=_0x2be72d[_0x62d70c(0x1ef)]('@')[0x1],_0x50556c=new Date()['getTime']();if(_0x4d79b1){if(_0x50556c-_0x2b8257<maxSecretAge*0x3e8)return _0x87792;else return![];}else return _0x87792;}catch(_0xd065e2){return![];}else return![];}const validToken=(_0x384e2d,_0x2b9705)=>{const _0x493275=_0x2acf75,_0x115e37=devices[_0x2b9705]['ip'];if(!_0x384e2d)return{'error':_0x493275(0x268)};for(let _0x485e7d of blacklist){if(_0x485e7d['token']==_0x384e2d)return{'error':'Token\x20blacklisted'};}let _0x43b267;try{_0x43b267=jwt[_0x493275(0x139)](_0x384e2d,secure[_0x493275(0x2eb)]+_0x2b9705);}catch{return{'error':_0x493275(0x17f)};}if(!_0x43b267[_0x493275(0x2d2)]('clientip')&&!_0x43b267[_0x493275(0x2d2)](_0x493275(0x1f2))||!_0x43b267['hasOwnProperty'](_0x493275(0x28a)))return{'error':_0x493275(0x1be)};if(!_0x43b267['hasOwnProperty']('username')&&_0x43b267[_0x493275(0x2d2)](_0x493275(0x243))){const {clientip:_0x329b9c}=_0x43b267;return _0x115e37==_0x329b9c?{'success':_0x493275(0x252)}:{'error':_0x493275(0x2a4)};}else{if(_0x43b267['hasOwnProperty'](_0x493275(0x1f2))&&_0x43b267[_0x493275(0x2d2)](_0x493275(0x243))){const {username:_0x2f0d0e,clientip:_0xef790e}=_0x43b267;return settings[_0x493275(0x2e9)]==_0x2f0d0e&&_0x115e37==_0xef790e?{'success':_0x493275(0x252)}:{'error':_0x493275(0x246)};}}},generateLoginToken=_0x3066ec=>{const _0x381988=_0x2acf75;if(_0x3066ec){const _0x5ccc85=devices[_0x3066ec]['ip'];return jwt[_0x381988(0x133)]({'username':settings[_0x381988(0x2e9)],'clientip':_0x5ccc85},secure[_0x381988(0x2eb)]+_0x3066ec,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5e851c=>{const _0x50c521=_0x2acf75;if(_0x5e851c){const _0x315345=devices[_0x5e851c]['ip'];return jwt['sign']({'clientip':_0x315345},secure[_0x50c521(0x2eb)]+_0x5e851c,{'expiresIn':devices[_0x5e851c]['telegramIpApproval'][_0x50c521(0x1cd)]*0x3c});}else return![];},telegramIpApproved=_0x1ffa5b=>{const _0x19087d=_0x2acf75;let _0x205bf9=![];return devices[_0x1ffa5b]['telegramIpApproval']&&devices[_0x1ffa5b][_0x19087d(0x25f)][_0x19087d(0x1cd)]!=_0x19087d(0x1ce)&&(_0x205bf9=devices[_0x1ffa5b]['telegramIpApproval'][_0x19087d(0x243)]==devices[_0x1ffa5b]['ip']&&new Date()[_0x19087d(0x1a2)]()-devices[_0x1ffa5b][_0x19087d(0x25f)]['timestamp']<devices[_0x1ffa5b]['telegramIpApproval'][_0x19087d(0x1cd)]*0x3c*0x3e8),_0x205bf9;},telegram2FaApproved=_0x355b09=>{const _0x23d97f=_0x2acf75;let _0x232c94=![];return devices[_0x355b09][_0x23d97f(0x193)]&&devices[_0x355b09]['telegram2FaApproval'][_0x23d97f(0x1cd)]!=_0x23d97f(0x1ce)&&(_0x232c94=devices[_0x355b09]['telegram2FaApproval'][_0x23d97f(0x243)]==devices[_0x355b09]['ip']&&new Date()[_0x23d97f(0x1a2)]()-devices[_0x355b09][_0x23d97f(0x193)][_0x23d97f(0x1f3)]<devices[_0x355b09]['telegram2FaApproval'][_0x23d97f(0x1cd)]*0x3c*0x3e8),_0x232c94;},normalizeIP=_0x231460=>{const _0x175156=_0x2acf75;let _0x2132e5=null,_0x117a3d=null;if(ipaddr[_0x175156(0x211)](_0x231460)){const _0x5c7edd=ipaddr[_0x175156(0x2ac)](_0x231460);_0x5c7edd[_0x175156(0x228)]()==='ipv6'?(_0x5c7edd[_0x175156(0x185)]()&&(_0x2132e5=_0x5c7edd[_0x175156(0x154)]()[_0x175156(0x2ae)]()),_0x117a3d=_0x5c7edd[_0x175156(0x2ae)]()):(_0x2132e5=_0x5c7edd[_0x175156(0x2ae)](),_0x117a3d=_0x5c7edd[_0x175156(0x140)]()[_0x175156(0x2ae)]());}return{'show':_0x2132e5?_0x2132e5:_0x117a3d,'store':_0x117a3d};};function formatDate(_0x21cf11){const _0xf5c3a7=_0x2acf75;return _0x21cf11[_0xf5c3a7(0x160)]()+'/'+(_0x21cf11[_0xf5c3a7(0x1cf)]()+0x1)[_0xf5c3a7(0x2ae)]()[_0xf5c3a7(0x2f3)](0x2,'0')+'/'+_0x21cf11[_0xf5c3a7(0x1e5)]()[_0xf5c3a7(0x2ae)]()[_0xf5c3a7(0x2f3)](0x2,'0')+'\x20'+_0x21cf11[_0xf5c3a7(0x2e2)]()[_0xf5c3a7(0x2ae)]()['padStart'](0x2,'0')+':'+_0x21cf11[_0xf5c3a7(0x123)]()[_0xf5c3a7(0x2ae)]()[_0xf5c3a7(0x2f3)](0x2,'0')+':'+_0x21cf11[_0xf5c3a7(0x125)]()[_0xf5c3a7(0x2ae)]()['padStart'](0x2,'0');}function sleep(_0x139a36){return new Promise(_0x284c34=>setTimeout(_0x284c34,_0x139a36));}