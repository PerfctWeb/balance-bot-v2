const _0x58d92a=_0x3b94;(function(_0x14e325,_0x2a66f7){const _0x4b2b84=_0x3b94,_0x3a14e7=_0x14e325();while(!![]){try{const _0x13aae7=parseInt(_0x4b2b84(0x222))/0x1*(-parseInt(_0x4b2b84(0x3bb))/0x2)+parseInt(_0x4b2b84(0x2e4))/0x3+parseInt(_0x4b2b84(0x27e))/0x4+-parseInt(_0x4b2b84(0x3a5))/0x5*(parseInt(_0x4b2b84(0x25b))/0x6)+parseInt(_0x4b2b84(0x384))/0x7+parseInt(_0x4b2b84(0x306))/0x8+-parseInt(_0x4b2b84(0x202))/0x9;if(_0x13aae7===_0x2a66f7)break;else _0x3a14e7['push'](_0x3a14e7['shift']());}catch(_0x20dd17){_0x3a14e7['push'](_0x3a14e7['shift']());}}}(_0x2a05,0x7487f));const _0xa08c6b=function(){let _0x1ce287=!![];return function(_0x222409,_0x214476){const _0x2da36b=_0x1ce287?function(){const _0x539009=_0x3b94;if(_0x214476){const _0x3f647e=_0x214476[_0x539009(0x2f6)](_0x222409,arguments);return _0x214476=null,_0x3f647e;}}:function(){};return _0x1ce287=![],_0x2da36b;};}(),_0x513158=_0xa08c6b(this,function(){const _0x59abc5=_0x3b94;return _0x513158[_0x59abc5(0x323)]()[_0x59abc5(0x39b)](_0x59abc5(0x1da))[_0x59abc5(0x323)]()[_0x59abc5(0x341)](_0x513158)[_0x59abc5(0x39b)](_0x59abc5(0x1da));});_0x513158();'use strict';process[_0x58d92a(0x298)][_0x58d92a(0x3aa)]=0x1;const childProcess=require(_0x58d92a(0x393)),fs=require('fs'),fns=require(_0x58d92a(0x25d)),low=require(_0x58d92a(0x3ad)),FileSync=require(_0x58d92a(0x38a)),path=require(_0x58d92a(0x26c)),crypto=require(_0x58d92a(0x274)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x58d92a(0x1ed))[_0x58d92a(0x2d2)],bcrypt=require(_0x58d92a(0x395)),jwt=require(_0x58d92a(0x376)),ipaddr=require(_0x58d92a(0x396)),argv=require(_0x58d92a(0x2b1))(process[_0x58d92a(0x285)]['slice'](0x2))[_0x58d92a(0x285)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x58d92a(0x229)),Mixpanel=require(_0x58d92a(0x3cf)),axios=require(_0x58d92a(0x2c5)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x58d92a(0x361)),fileUpload=require(_0x58d92a(0x3ca)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x58d92a(0x2ec)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x58d92a(0x246)),process[_0x58d92a(0x307)](0x1));const HOST=argv['host']||null,userID=argv[_0x58d92a(0x24f)]||'',debugging=argv['d']||![],nodeversion=process[_0x58d92a(0x348)][_0x58d92a(0x314)];let bbpath=_0x58d92a(0x2ce),bbpath2='';const botfile=_0x58d92a(0x360),configfile='bb-config.json',settingsfile=_0x58d92a(0x1e2),securefile=_0x58d92a(0x29d),environment=require('./'+bbpath2+'version.json')[_0x58d92a(0x342)]||_0x58d92a(0x271),maxBackups=0xa;let validInstallation=!![];!fs[_0x58d92a(0x324)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x58d92a(0x22a)),configpath=userID?bbpath+_0x58d92a(0x3c3)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x58d92a(0x317),logspath=userID?bbpath+_0x58d92a(0x32d)+userID+'/':bbpath+_0x58d92a(0x32d),zippath=userID?bbpath+_0x58d92a(0x347)+userID+'/':bbpath+_0x58d92a(0x347),loggerfile=fs[_0x58d92a(0x2b0)](logspath+_0x58d92a(0x397),{'flags':'a'}),temppath=userID?bbpath+_0x58d92a(0x318)+userID+'/':bbpath+_0x58d92a(0x318);!fs[_0x58d92a(0x324)](configpath)&&fs[_0x58d92a(0x2ee)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x58d92a(0x2ee)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x58d92a(0x2ee)](logspath);!fs['existsSync'](zippath)&&fs[_0x58d92a(0x2ee)](zippath);!fs[_0x58d92a(0x324)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x58d92a(0x333)]({'bots':[]})[_0x58d92a(0x281)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x58d92a(0x333)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x58d92a(0x35a),'onepagemode':![]}})[_0x58d92a(0x281)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x58d92a(0x333)]({'secure':{},'blacklist':[]})[_0x58d92a(0x281)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x58d92a(0x20e)});const saltRounds=0xa,mixpanel=Mixpanel[_0x58d92a(0x350)](_0x58d92a(0x305),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x58d92a(0x1f7)]&&(settings[_0x58d92a(0x1f7)]!=''&&settings['telegramToken']!='***')&&settings[_0x58d92a(0x3d8)]&&settings[_0x58d92a(0x3d8)]!='')initTelegram();const parseColor=(_0x476422,_0x16e968)=>{const _0x3620cd=_0x58d92a,_0x19ab11=/#[A-Z]{3}#/g;if(typeof _0x476422==_0x3620cd(0x2a3)){!_0x16e968?_0x476422=_0x476422[_0x3620cd(0x329)](_0x19ab11,''):(_0x476422=_0x476422[_0x3620cd(0x329)](/#BLU#/g,_0x3620cd(0x1fd)),_0x476422=_0x476422[_0x3620cd(0x329)](/#RED#/g,_0x3620cd(0x3b9)),_0x476422=_0x476422[_0x3620cd(0x329)](/#YEL#/g,_0x3620cd(0x21f)),_0x476422=_0x476422[_0x3620cd(0x329)](/#MAG#/g,_0x3620cd(0x34c)),_0x476422=_0x476422[_0x3620cd(0x329)](/#CYA#/g,_0x3620cd(0x2fc)),_0x476422=_0x476422[_0x3620cd(0x329)](/#RES#/g,_0x3620cd(0x1e9)));;}return _0x476422;},logger={'screen':_0x4f8f68=>{console['log'](parseColor(_0x4f8f68,!![]));},'simple':_0x40be2f=>{const _0x50e330=_0x58d92a;console[_0x50e330(0x2ec)](parseColor(_0x40be2f,!![])),loggerfile[_0x50e330(0x281)](util[_0x50e330(0x2c7)](parseColor(_0x40be2f,![]))+'\x0a');},'full':async _0x2ac79c=>{const _0x35b1f1=_0x58d92a,_0x5b33db=getTimeStamp()+_0x35b1f1(0x3c2)+_0x2ac79c;console[_0x35b1f1(0x2ec)](parseColor(_0x5b33db,!![])),loggerfile['write'](util['format'](parseColor(_0x5b33db,![]))+'\x0a');if(tgBot&&settings[_0x35b1f1(0x322)]&&settings[_0x35b1f1(0x331)]!=_0x35b1f1(0x213))await sendTelegram(settings['telegramChatId'],_0x35b1f1(0x304)+parseColor(_0x2ac79c,![]));},'debug':async(_0x25501d,_0x2bd2c5='')=>{const _0x115702=_0x58d92a,_0x4a55aa=getTimeStamp()+_0x115702(0x2ba)+_0x25501d;if(debugging)console[_0x115702(0x2ec)](parseColor(_0x4a55aa,!![]));loggerfile[_0x115702(0x281)](util[_0x115702(0x2c7)](parseColor(_0x4a55aa,![]))+'\x0a');if(_0x2bd2c5){if(debugging)console[_0x115702(0x2ec)](_0x2bd2c5);loggerfile[_0x115702(0x281)](util[_0x115702(0x2c7)](_0x2bd2c5)+'\x0a');}}};let terminating=![];process['on'](_0x58d92a(0x32a),function(_0xbd8c21){logger['simple'](_0xbd8c21);}),process['on'](_0x58d92a(0x307),()=>{const _0x4c1d06=_0x58d92a;stopAllBots(),process[_0x4c1d06(0x307)](0x0);}),process['on'](_0x58d92a(0x2ad),()=>{const _0x4ff2d0=_0x58d92a;stopAllBots(),process[_0x4ff2d0(0x307)](0x0);}),process['on'](_0x58d92a(0x308),()=>{const _0x4c3fae=_0x58d92a;stopAllBots(),process[_0x4c3fae(0x307)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x58d92a(0x254)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x58d92a(0x232)),app=express(),http=require(_0x58d92a(0x31d))[_0x58d92a(0x231)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x58d92a(0x283)](_0x58d92a(0x2a4),async(_0x316187,_0x1fd518)=>{const _0x52d69a=_0x58d92a,_0x6e7354=_0x316187[_0x52d69a(0x24b)][_0x52d69a(0x367)],_0x40f177=getClientsWithBotID('botmanager'),_0x598926=_0x316187[_0x52d69a(0x31f)]['uuid'],_0x51471c=timelyDecrypt(_0x598926,![]),_0x32f6c2=_0x40f177[_0x52d69a(0x3ba)](_0x58f960=>_0x58f960[_0x52d69a(0x23a)]==_0x51471c);if(_0x32f6c2){const _0xccbd1a=normalizeIP(_0x316187[_0x52d69a(0x21e)]['remoteAddress'])[_0x52d69a(0x391)],_0x3ced1f=_0x316187[_0x52d69a(0x31f)]['tkn'];if(validateAccess(_0x3ced1f,_0x51471c,_0xccbd1a)[_0x52d69a(0x31c)])_0x6e7354==_0x52d69a(0x2cf)&&await backupConfigFiles(),await zipFiles(_0x6e7354),_0x1fd518[_0x52d69a(0x34f)](zippath+(_0x6e7354+_0x52d69a(0x3d6)),_0x576f8b=>{const _0x455a15=_0x52d69a;_0x576f8b&&(logger[_0x455a15(0x238)]('Failed\x20to\x20download\x20'+_0x6e7354),logger['simple'](_0x576f8b));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x6e7354+_0x52d69a(0x2fe));}else logger[_0x52d69a(0x238)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x6e7354+_0x52d69a(0x21d));}),app[_0x58d92a(0x354)]('/upload-backup',async(_0x315247,_0x1e8207)=>{const _0x2f7e6a=_0x58d92a,_0x3256cd=getClientsWithBotID('botmanager'),_0x130636=_0x315247[_0x2f7e6a(0x31f)][_0x2f7e6a(0x23a)],_0x1b228c=timelyDecrypt(_0x130636,![]),_0x24ead6=_0x3256cd['find'](_0x43043c=>_0x43043c[_0x2f7e6a(0x23a)]==_0x1b228c);logger[_0x2f7e6a(0x359)](_0x2f7e6a(0x37b));if(_0x24ead6){const _0x367748=normalizeIP(_0x315247[_0x2f7e6a(0x21e)][_0x2f7e6a(0x2cd)])['store'],_0x4c772f=_0x315247['headers'][_0x2f7e6a(0x3a7)];if(validateAccess(_0x4c772f,_0x1b228c,_0x367748)[_0x2f7e6a(0x31c)]){if(_0x315247[_0x2f7e6a(0x3d4)]){const _0x26ef45=_0x315247['files'][_0x2f7e6a(0x39d)];await _0x26ef45['mv'](temppath+_0x26ef45['name']),_0x1e8207['send']({'status':!![],'message':_0x2f7e6a(0x1e3)});const _0x3cefbe=getBotsWithMode();_0x3cefbe['length']>0x0?confirmRestore(temppath,_0x26ef45[_0x2f7e6a(0x355)]):unzipFile(temppath,_0x26ef45[_0x2f7e6a(0x355)]);}}else logger[_0x2f7e6a(0x238)](_0x2f7e6a(0x2c1));}else logger[_0x2f7e6a(0x238)](_0x2f7e6a(0x33a));}),app[_0x58d92a(0x2bb)](express[_0x58d92a(0x1fe)](path['join'](__dirname,bbpath2,_0x58d92a(0x258)))),app[_0x58d92a(0x2bb)](express[_0x58d92a(0x1fe)](path[_0x58d92a(0x345)](__dirname,bbpath2,_0x58d92a(0x302)))),app[_0x58d92a(0x283)]('/',function(_0x3ba2d2,_0x207d40){const _0x25793a=_0x58d92a;_0x207d40[_0x25793a(0x24c)](path[_0x25793a(0x345)](__dirname,bbpath2,_0x25793a(0x258),_0x25793a(0x3d9)));}),app[_0x58d92a(0x283)](_0x58d92a(0x259),function(_0x2f2c55,_0x50f9cd){const _0x20df96=_0x58d92a;_0x50f9cd[_0x20df96(0x24c)](path[_0x20df96(0x345)](__dirname,bbpath2,_0x20df96(0x302),_0x20df96(0x3d9)));}),app[_0x58d92a(0x283)]('/:bot/portfolio',(_0x4460e9,_0x5199b3)=>{const _0x1f3756=_0x58d92a;_0x5199b3[_0x1f3756(0x24c)](path[_0x1f3756(0x345)](__dirname,bbpath2,_0x1f3756(0x302),'index.html'));}),app[_0x58d92a(0x283)](_0x58d92a(0x27b),(_0x348d45,_0x529686)=>{const _0x4cab8a=_0x58d92a;_0x529686['sendFile'](path['join'](__dirname,bbpath2,_0x4cab8a(0x302),'index.html'));}),app['get'](_0x58d92a(0x29b),(_0x1b1051,_0xdde037)=>{const _0x2d177f=_0x58d92a;_0xdde037[_0x2d177f(0x24c)](path['join'](__dirname,bbpath2,_0x2d177f(0x302),_0x2d177f(0x3d9)));}),app[_0x58d92a(0x283)](_0x58d92a(0x269),(_0x5b0dad,_0x22d2fe)=>{const _0x4ad148=_0x58d92a;_0x22d2fe[_0x4ad148(0x24c)](path[_0x4ad148(0x345)](__dirname,bbpath2,_0x4ad148(0x302),_0x4ad148(0x3d9)));}),app[_0x58d92a(0x283)](_0x58d92a(0x2af),(_0x30c991,_0x3cd5c4)=>{_0x3cd5c4['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x58d92a(0x283)]('/:bot/support',(_0x445438,_0x352610)=>{const _0x62c04d=_0x58d92a;_0x352610['sendFile'](path['join'](__dirname,bbpath2,_0x62c04d(0x302),_0x62c04d(0x3d9)));});if(HOST)http['listen'](PORT,HOST);else http[_0x58d92a(0x1fb)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x38af2e=_0x58d92a;let _0xf0146=_0x38af2e(0x24d);const _0x361a64=networkInterfaces(),_0x4f4757={};for(const _0x226d79 of Object[_0x38af2e(0x379)](_0x361a64)){for(const _0x137a31 of _0x361a64[_0x226d79]){if((_0x137a31['family']==_0x38af2e(0x39e)||_0x137a31[_0x38af2e(0x357)]==0x4)&&!_0x137a31['internal']){const _0x3c5550=ipaddr[_0x38af2e(0x2e0)](_0x137a31[_0x38af2e(0x3d2)])[_0x38af2e(0x28e)]();_0x3c5550!=_0x38af2e(0x1e5)&&(!_0x4f4757[_0x226d79]&&(_0x4f4757[_0x226d79]=[]),_0x4f4757[_0x226d79]['push'](_0x137a31[_0x38af2e(0x3d2)]),_0xf0146=_0x137a31['address']);}}}return{'serverip':_0xf0146,'netinterfaces':_0x4f4757};}async function startServer(){const _0x1e8cfb=_0x58d92a,{serverip:_0x354ac9,netinterfaces:_0x1a55a5}=getServerIP();logger[_0x1e8cfb(0x21a)](''),logger['simple'](_0x1e8cfb(0x237)),await logger[_0x1e8cfb(0x238)](_0x1e8cfb(0x3b5)+serverversion+'#RES#\x20'+(environment==_0x1e8cfb(0x381)?_0x1e8cfb(0x245):'')+'\x0a'+(_0x1e8cfb(0x3d5)+PORT+_0x1e8cfb(0x36b))+('=>\x20Go\x20to\x20#CYA#http://'+_0x354ac9+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple']('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x4bba1a of config){const _0x1ba67c=_0x4bba1a[_0x1e8cfb(0x205)]==_0x1e8cfb(0x373)?'a':'m';if(_0x4bba1a['status']==_0x1e8cfb(0x369)||_0x4bba1a[_0x1e8cfb(0x211)]==_0x1e8cfb(0x330))await logger[_0x1e8cfb(0x238)](_0x1e8cfb(0x35d)+_0x1ba67c+_0x1e8cfb(0x2c0)+_0x4bba1a[_0x1e8cfb(0x35f)]+_0x1e8cfb(0x1f2)+_0x4bba1a['botname']),startBot([_0x4bba1a[_0x1e8cfb(0x35f)],userID],{'cwd':bbpath},function(_0x2ca035){const _0x761030=_0x1e8cfb;if(_0x2ca035)logger[_0x761030(0x238)](_0x2ca035);});else(_0x4bba1a['status']=='disabled'||_0x4bba1a[_0x1e8cfb(0x211)]=='new-disabled')&&await logger['full'](_0x1e8cfb(0x316)+_0x1ba67c+_0x1e8cfb(0x35e)+_0x4bba1a[_0x1e8cfb(0x35f)]+'\x20|\x20'+_0x4bba1a[_0x1e8cfb(0x2d9)]);}else!newBot&&logger[_0x1e8cfb(0x21a)](_0x1e8cfb(0x214));if(newBot)addBot();logger[_0x1e8cfb(0x21a)]('-----------------------------------------------------------------------------------'),logger[_0x1e8cfb(0x21a)](''),await logger['debug'](_0x1e8cfb(0x253)+nodeversion),await logger['debug'](_0x1e8cfb(0x346),_0x1a55a5);}function startSocket(){const _0x136f19=_0x58d92a;io['on'](_0x136f19(0x372),_0x3e0370=>{const _0x892f2c=_0x136f19;let _0x1fa1a5,_0x67f87a,_0x1d9556,_0x17a24a,_0x462408;const _0x5373d0=_0x3e0370['handshake']['headers'][_0x892f2c(0x2bf)];_0x67f87a=_0x5373d0[_0x892f2c(0x292)](/bot[0-9]{3}/);if(_0x67f87a)_0x1d9556=_0x67f87a[0x0]['match'](/[0-9]{3}/);if(_0x1d9556)_0x1fa1a5=_0x1d9556[0x0];else _0x1fa1a5='botmanager';const _0x43e839=_0x3e0370['handshake'][_0x892f2c(0x2b7)][_0x892f2c(0x22b)];if(!_0x43e839)_0x3e0370[_0x892f2c(0x334)](_0x892f2c(0x211),{'publicKey':secure[_0x892f2c(0x2f4)]});else{_0x17a24a=timelyDecrypt(_0x43e839,![]);if(!_0x17a24a)_0x3e0370[_0x892f2c(0x334)](_0x892f2c(0x211),{'publicKey':secure[_0x892f2c(0x2f4)]});else{_0x462408=normalizeIP(_0x3e0370['conn']['remoteAddress'])[_0x892f2c(0x391)];if(!devices[_0x17a24a])devices[_0x17a24a]={'uuid':_0x17a24a,'access':{'token':null}};devices[_0x17a24a]['ip']=_0x462408;const _0x16846e=addClient(_0x3e0370['id'],_0x17a24a,_0x1fa1a5);setAccess(_0x16846e),emitMessages(),_0x3e0370['on'](_0x892f2c(0x371),_0x53a314=>{const _0x1637ba=_0x892f2c,_0x546c94=timelyDecrypt(_0x53a314['password']);if(_0x546c94){_0x53a314={'username':_0x53a314[_0x1637ba(0x2e5)],'password':_0x546c94},devices[_0x17a24a][_0x1637ba(0x268)]=validateCredentials(_0x53a314,_0x17a24a);if(devices[_0x17a24a]['access'][_0x1637ba(0x31c)]==![]&&devices[_0x17a24a][_0x1637ba(0x268)][_0x1637ba(0x30a)]==_0x1637ba(0x26f))_0x3e0370[_0x1637ba(0x334)](_0x1637ba(0x211),{'access':devices[_0x17a24a][_0x1637ba(0x268)]}),loginAccess2FA(_0x17a24a,_0x462408);else{if(devices[_0x17a24a][_0x1637ba(0x268)][_0x1637ba(0x31c)]==![]&&devices[_0x17a24a][_0x1637ba(0x268)][_0x1637ba(0x30a)]==_0x1637ba(0x296))_0x3e0370[_0x1637ba(0x334)]('status',{'access':devices[_0x17a24a][_0x1637ba(0x268)]});else devices[_0x17a24a][_0x1637ba(0x268)][_0x1637ba(0x31c)]&&devices[_0x17a24a][_0x1637ba(0x268)][_0x1637ba(0x30a)]==_0x1637ba(0x352)&&(getClientsWithUuid(_0x17a24a)[_0x1637ba(0x37c)](_0x4a3d1f=>{setAccess(_0x4a3d1f);}),logger[_0x1637ba(0x359)]('Logged\x20in\x20user\x20...'+_0x17a24a[_0x1637ba(0x291)](-0x8)),setTokenRefresh(_0x17a24a),setSessionTimeout(_0x1637ba(0x371),_0x17a24a));}}else logger[_0x1637ba(0x238)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x3e0370['on']('reset-password',()=>{resetPassword();}),_0x3e0370['on'](_0x892f2c(0x252),_0x351146=>{removeClient(_0x3e0370['id']);}),_0x1fa1a5==_0x892f2c(0x2a6)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x20804a){const _0x5ba85d=_0x58d92a;if(_0x20804a!=_0x5ba85d(0x2a6)&&config[_0x5ba85d(0x2e7)]!=''){if(pid[_0x20804a])pid[_0x20804a][_0x5ba85d(0x358)]({'function':_0x5ba85d(0x28b),'args':null});}_0x20804a!=_0x5ba85d(0x2a6)&&broadcastToBots(_0x5ba85d(0x33c),JSON[_0x5ba85d(0x34a)](config));}function reloadBotManager(){const _0x1cd2e0=_0x58d92a;getClientsWithBotID(_0x1cd2e0(0x2a6))[_0x1cd2e0(0x37c)](_0x1c925a=>{const _0x394903=_0x1cd2e0;getSocket(_0x1c925a['id'])[_0x394903(0x334)](_0x394903(0x211),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x46e543){return io['sockets']['sockets']['get'](_0x46e543);}function setAccess(_0x2a7a39){const _0x597d69=_0x58d92a,_0xd6eab0=getSocket(_0x2a7a39['id']),_0x41b613=_0x2a7a39[_0x597d69(0x23a)],_0x196932=_0x2a7a39[_0x597d69(0x1dc)];devices[_0x41b613][_0x597d69(0x268)]=validateAccess(devices[_0x41b613][_0x597d69(0x268)][_0x597d69(0x2eb)],_0x41b613),logger['debug']('Setting\x20access:\x20'+devices[_0x41b613]['access']['reason']+'\x20|\x20client:\x20...'+_0x2a7a39['id'][_0x597d69(0x291)](-0x8)+_0x597d69(0x31e)+_0x41b613[_0x597d69(0x291)](-0x8)),_0xd6eab0[_0x597d69(0x345)](_0x41b613);if(devices[_0x41b613][_0x597d69(0x268)]['allow']){_0xd6eab0['join'](_0x196932);if(_0x196932==_0x597d69(0x2a6))initializeSocketBotManager(_0xd6eab0);else initializeSocketBot(_0xd6eab0);initClient(_0x196932);}devices[_0x41b613][_0x597d69(0x268)][_0x597d69(0x2eb)]&&devices[_0x41b613]['access'][_0x597d69(0x30a)]==_0x597d69(0x38b)&&setSessionTimeout(_0x597d69(0x1ea),_0x41b613),devices[_0x41b613]['access']['token']&&devices[_0x41b613][_0x597d69(0x268)][_0x597d69(0x30a)]==_0x597d69(0x32f)&&setSessionTimeout(_0x597d69(0x371),_0x41b613),_0xd6eab0['emit'](_0x597d69(0x211),{'status':_0x2a7a39[_0x597d69(0x23d)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x41b613][_0x597d69(0x268)],'externalip':devices[_0x41b613]['ip'],'publicKey':secure[_0x597d69(0x2f4)],'userid':settings[_0x597d69(0x251)],'validInstallation':validInstallation}),devices[_0x41b613][_0x597d69(0x268)][_0x597d69(0x31c)]==![]&&devices[_0x41b613][_0x597d69(0x268)][_0x597d69(0x30a)]=='2FA\x20required'&&temporaryAccess2FA(_0x41b613,devices[_0x41b613]['ip']);}function setSessionTimeout(_0x49019b,_0x1d0171){const _0x1a39c0=_0x58d92a;let _0x4fc442;if(_0x49019b==_0x1a39c0(0x371))_0x4fc442=loginExpiry*0x3c*0x3e8;else _0x4fc442=devices[_0x1d0171]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x1a39c0(0x242)]()-devices[_0x1d0171]['telegramIpApproval'][_0x1a39c0(0x38d)]);if(devices[_0x1d0171]['pidExpireLogin'])clearTimeout(devices[_0x1d0171][_0x1a39c0(0x300)]);devices[_0x1d0171][_0x1a39c0(0x300)]=setTimeout(()=>{const _0x163c8c=_0x1a39c0;if(devices[_0x1d0171][_0x163c8c(0x2c9)])clearTimeout(devices[_0x1d0171][_0x163c8c(0x2c9)]);removeSocketListeners(_0x1d0171),addBlacklist(_0x1d0171),devices[_0x1d0171]['telegramIpApproval']=null,devices[_0x1d0171][_0x163c8c(0x1f6)]=null,devices[_0x1d0171][_0x163c8c(0x268)][_0x163c8c(0x2eb)]=null,logger[_0x163c8c(0x359)]('Session\x20expired\x20for\x20user\x20...'+_0x1d0171[_0x163c8c(0x291)](-0x8)),devices[_0x1d0171]['access']=validateAccess(devices[_0x1d0171][_0x163c8c(0x268)][_0x163c8c(0x2eb)],_0x1d0171),!(devices[_0x1d0171][_0x163c8c(0x268)]['allow']&&devices[_0x1d0171][_0x163c8c(0x268)][_0x163c8c(0x30a)]=='login\x20not\x20required')&&(_0x49019b=='login'?io['to'](_0x1d0171)[_0x163c8c(0x334)](_0x163c8c(0x211),{'access':{'allow':![],'reason':_0x163c8c(0x266),'token':null}}):io['to'](_0x1d0171)[_0x163c8c(0x334)]('status',{'access':{'allow':![],'reason':_0x163c8c(0x311),'token':null}})),devices[_0x1d0171]['access'][_0x163c8c(0x2eb)]=null;},_0x4fc442);}function setTokenRefresh(_0x4b997c){const _0x2b72fd=_0x58d92a;if(devices[_0x4b997c][_0x2b72fd(0x2c9)])clearTimeout(devices[_0x4b997c][_0x2b72fd(0x2c9)]);devices[_0x4b997c]['pidRefreshToken']=setTimeout(()=>{const _0x498276=_0x2b72fd;getClientsWithUuid(_0x4b997c)[_0x498276(0x353)]!=0x0?(devices[_0x4b997c]['access']=refreshToken(_0x4b997c),io['to'](_0x4b997c)[_0x498276(0x334)](_0x498276(0x211),{'status':_0x498276(0x227),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4b997c][_0x498276(0x268)],'externalip':devices[_0x4b997c]['ip'],'publicKey':secure[_0x498276(0x2f4)],'validInstallation':validInstallation}),setTokenRefresh(_0x4b997c)):clearTimeout(devices[_0x4b997c][_0x498276(0x2c9)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3b46ae){const _0x283870=_0x58d92a,_0x1ce549=getClient(_0x3b46ae['id'])['uuid'];_0x3b46ae[_0x283870(0x334)]('bots',config),_0x3b46ae['emit'](_0x283870(0x1e4),cleanSettings()),_0x3b46ae['on'](_0x283870(0x20c),_0x492a0c=>{const _0x5b4c07=_0x283870;if(validateAccess(_0x492a0c,_0x1ce549)[_0x5b4c07(0x31c)])addBot();else logger[_0x5b4c07(0x238)](_0x5b4c07(0x386));}),_0x3b46ae['on']('update-bot',(_0x49f56d,_0x50eb6d)=>{const _0x24a0b8=_0x283870;if(validateAccess(_0x50eb6d,_0x1ce549)['allow'])toggleBot(_0x49f56d[_0x24a0b8(0x35f)],_0x49f56d[_0x24a0b8(0x211)],_0x49f56d[_0x24a0b8(0x34b)]);else logger[_0x24a0b8(0x238)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3b46ae['on']('toggle-bot-mode',(_0x2e6edc,_0xa4931d)=>{const _0x5ac7dc=_0x283870;if(validateAccess(_0xa4931d,_0x1ce549)[_0x5ac7dc(0x31c)])toggleBotMode(_0x2e6edc);else logger[_0x5ac7dc(0x238)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3b46ae['on'](_0x283870(0x2df),(_0x5424f7,_0x5de9ba)=>{const _0x53e68e=_0x283870;if(validateAccess(_0x5de9ba,_0x1ce549)['allow'])deleteBot(_0x5424f7);else logger[_0x53e68e(0x238)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x3b46ae['on'](_0x283870(0x3d3),(_0x25a29a,_0x2755b6)=>{const _0x37f98d=_0x283870;if(validateAccess(_0x2755b6,_0x1ce549)[_0x37f98d(0x31c)])storeSettings(_0x25a29a,!![]);else logger[_0x37f98d(0x238)](_0x37f98d(0x2fd));}),_0x3b46ae['on'](_0x283870(0x36a),_0x7d17a8=>{const _0x596d13=_0x283870;if(validateAccess(_0x7d17a8,_0x1ce549)[_0x596d13(0x31c)])updateBB(_0x596d13(0x2d1));else logger[_0x596d13(0x238)](_0x596d13(0x273));}),_0x3b46ae['on'](_0x283870(0x2d3),_0x6d10e8=>{const _0x12334a=_0x283870;if(validateAccess(_0x6d10e8,_0x1ce549)[_0x12334a(0x31c)])updateBB(_0x12334a(0x315));else logger[_0x12334a(0x238)](_0x12334a(0x2da));}),_0x3b46ae['on'](_0x283870(0x257),_0x2c755d=>{const _0x2b65a5=_0x283870;if(validateAccess(_0x2c755d,_0x1ce549)['allow']){const _0x18f2e6=getClient(_0x3b46ae['id']);if(_0x18f2e6)getBackupFiles(_0x18f2e6['uuid']);else logger[_0x2b65a5(0x238)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x2b65a5(0x238)](_0x2b65a5(0x30f));}),_0x3b46ae['on'](_0x283870(0x2fb),(_0x58a7d9,_0x484718)=>{const _0x5b35f0=_0x283870;if(validateAccess(_0x484718,_0x1ce549)[_0x5b35f0(0x31c)])restoreBackupFile(_0x58a7d9);else logger[_0x5b35f0(0x238)](_0x5b35f0(0x1fa));}),_0x3b46ae['on'](_0x283870(0x3c9),_0x2d1d35=>{const _0x1e0bb6=_0x283870;if(validateAccess(_0x2d1d35,_0x1ce549)[_0x1e0bb6(0x31c)])getMessages();else logger[_0x1e0bb6(0x238)](_0x1e0bb6(0x363));}),_0x3b46ae['on'](_0x283870(0x383),(_0x232d71,_0x33ab34)=>{const _0x276de0=_0x283870;if(validateAccess(_0x33ab34,_0x1ce549)[_0x276de0(0x31c)])confirmMessage(_0x232d71);else logger[_0x276de0(0x238)](_0x276de0(0x2dc));}),_0x3b46ae['on'](_0x283870(0x2e2),_0x5bcfce=>{const _0x2b7361=_0x283870;if(validateAccess(_0x5bcfce,_0x1ce549)[_0x2b7361(0x31c)]){if(devices[_0x1ce549][_0x2b7361(0x2c9)])clearTimeout(devices[_0x1ce549][_0x2b7361(0x2c9)]);if(devices[_0x1ce549][_0x2b7361(0x300)])clearTimeout(devices[_0x1ce549][_0x2b7361(0x300)]);removeSocketListeners(getClient(_0x3b46ae['id'])[_0x2b7361(0x23a)]),addBlacklist(_0x1ce549),devices[_0x1ce549][_0x2b7361(0x28a)]=null,devices[_0x1ce549][_0x2b7361(0x1f6)]=null,devices[_0x1ce549]['access']['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x1ce549['slice'](-0x8)),io['to'](getClient(_0x3b46ae['id'])[_0x2b7361(0x23a)])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x2b7361(0x22d));});}function initializeSocketBot(_0x309ed8){const _0x2ad5d6=_0x58d92a,_0x207ffb=getClient(_0x309ed8['id'])['bot'],_0x5b4f1f=getClient(_0x309ed8['id'])[_0x2ad5d6(0x23a)];_0x309ed8['on'](_0x2ad5d6(0x343),(_0x47f2c0,_0xaffe73)=>{const _0x1f9c8c=_0x2ad5d6;if(validateAccess(_0xaffe73,_0x5b4f1f)[_0x1f9c8c(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb][_0x1f9c8c(0x358)]({'function':_0x1f9c8c(0x309),'args':_0x47f2c0});}else logger[_0x1f9c8c(0x238)](_0x1f9c8c(0x30b));}),_0x309ed8['on'](_0x2ad5d6(0x287),(_0x3840c9,_0x3a6532)=>{const _0x408f1b=_0x2ad5d6;if(validateAccess(_0x3a6532,_0x5b4f1f)['allow']){if(pid[_0x207ffb])pid[_0x207ffb][_0x408f1b(0x358)]({'function':_0x408f1b(0x2a8),'args':_0x3840c9});}else logger[_0x408f1b(0x238)](_0x408f1b(0x230));}),_0x309ed8['on'](_0x2ad5d6(0x3da),(_0x3a6fa8,_0x380694)=>{const _0x55a3af=_0x2ad5d6;if(validateAccess(_0x380694,_0x5b4f1f)[_0x55a3af(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb]['send']({'function':_0x55a3af(0x3ce),'args':_0x3a6fa8});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x309ed8['on']('store-configuration',(_0x449f4b,_0x1e2e89)=>{const _0x26a363=_0x2ad5d6;if(validateAccess(_0x1e2e89,_0x5b4f1f)[_0x26a363(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb][_0x26a363(0x358)]({'function':_0x26a363(0x3c6),'args':_0x449f4b});}else logger[_0x26a363(0x238)](_0x26a363(0x3ae));}),_0x309ed8['on'](_0x2ad5d6(0x221),(_0x241e70,_0x1f0ec4)=>{const _0x48717c=_0x2ad5d6;if(validateAccess(_0x1f0ec4,_0x5b4f1f)['allow']){if(pid[_0x207ffb])pid[_0x207ffb][_0x48717c(0x358)]({'function':_0x48717c(0x377),'args':_0x241e70});}else logger[_0x48717c(0x238)](_0x48717c(0x226));}),_0x309ed8['on'](_0x2ad5d6(0x295),(_0x56426e,_0x610871)=>{const _0x3805d6=_0x2ad5d6;if(validateAccess(_0x610871,_0x5b4f1f)['allow']){if(pid[_0x207ffb])pid[_0x207ffb]['send']({'function':_0x3805d6(0x27a),'args':_0x56426e});}else logger[_0x3805d6(0x238)](_0x3805d6(0x3a9));}),_0x309ed8['on'](_0x2ad5d6(0x3b2),_0x21c758=>{const _0x2a87d5=_0x2ad5d6;if(validateAccess(_0x21c758,_0x5b4f1f)[_0x2a87d5(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb][_0x2a87d5(0x358)]({'function':'resetHistory','args':null});}else logger[_0x2a87d5(0x238)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x309ed8['on'](_0x2ad5d6(0x247),_0x52ccc3=>{const _0x137a4c=_0x2ad5d6;if(validateAccess(_0x52ccc3,_0x5b4f1f)[_0x137a4c(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb][_0x137a4c(0x358)]({'function':'getStartingBalances','args':null});}else logger[_0x137a4c(0x238)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x309ed8['on'](_0x2ad5d6(0x1f0),(_0x1801a8,_0x3335b5)=>{const _0x563e4c=_0x2ad5d6;if(validateAccess(_0x3335b5,_0x5b4f1f)[_0x563e4c(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb][_0x563e4c(0x358)]({'function':_0x563e4c(0x23c),'args':_0x1801a8});}else logger[_0x563e4c(0x238)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x309ed8['on']('cancel-loading',_0x578d96=>{const _0x2fa489=_0x2ad5d6;if(validateAccess(_0x578d96,_0x5b4f1f)[_0x2fa489(0x31c)]){if(pid[_0x207ffb])pid[_0x207ffb][_0x2fa489(0x358)]({'function':_0x2fa489(0x2aa),'args':null});}else logger[_0x2fa489(0x238)](_0x2fa489(0x1f8));}),_0x309ed8['on'](_0x2ad5d6(0x3bc),_0xade7=>{const _0x629202=_0x2ad5d6;if(validateAccess(_0xade7,_0x5b4f1f)['allow']){if(pid[_0x207ffb])pid[_0x207ffb][_0x629202(0x358)]({'function':_0x629202(0x2c6),'args':null});}else logger['full'](_0x629202(0x288));}),_0x309ed8['on']('update-bb',_0x355f51=>{const _0x8152d1=_0x2ad5d6;if(validateAccess(_0x355f51,_0x5b4f1f)[_0x8152d1(0x31c)])updateBB('update');else logger[_0x8152d1(0x238)](_0x8152d1(0x273));}),_0x309ed8['on']('get-messages',_0x1116f0=>{const _0x3a7940=_0x2ad5d6;if(validateAccess(_0x1116f0,_0x5b4f1f)[_0x3a7940(0x31c)])getMessages();else logger[_0x3a7940(0x238)](_0x3a7940(0x363));}),_0x309ed8['on'](_0x2ad5d6(0x383),(_0x4a2ea4,_0x4c8e9f)=>{const _0x381ff3=_0x2ad5d6;if(validateAccess(_0x4c8e9f,_0x5b4f1f)[_0x381ff3(0x31c)])confirmMessage(_0x4a2ea4);else logger[_0x381ff3(0x238)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x309ed8['on'](_0x2ad5d6(0x2e2),_0x50ce27=>{const _0x1b8d26=_0x2ad5d6;if(validateAccess(_0x50ce27,_0x5b4f1f)[_0x1b8d26(0x31c)]){if(devices[_0x5b4f1f][_0x1b8d26(0x2c9)])clearTimeout(devices[_0x5b4f1f][_0x1b8d26(0x2c9)]);if(devices[_0x5b4f1f][_0x1b8d26(0x300)])clearTimeout(devices[_0x5b4f1f][_0x1b8d26(0x300)]);removeSocketListeners(getClient(_0x309ed8['id'])[_0x1b8d26(0x23a)]),addBlacklist(_0x5b4f1f),devices[_0x5b4f1f]['telegramIpApproval']=null,devices[_0x5b4f1f][_0x1b8d26(0x1f6)]=null,devices[_0x5b4f1f]['access'][_0x1b8d26(0x2eb)]=null,logger[_0x1b8d26(0x359)](_0x1b8d26(0x217)+_0x5b4f1f[_0x1b8d26(0x291)](-0x8)),io['to'](getClient(_0x309ed8['id'])[_0x1b8d26(0x23a)])[_0x1b8d26(0x334)](_0x1b8d26(0x211),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x1b8d26(0x238)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4aaaa6){const _0x527690=_0x58d92a;getClientsWithUuid(_0x4aaaa6)[_0x527690(0x37c)](_0x258834=>{const _0x1eb2c7=_0x527690;getSocket(_0x258834['id'])[_0x1eb2c7(0x35b)]();});}function cleanSettings(){const _0x514da7=_0x58d92a;let _0x17dd2b=settings;return settings[_0x514da7(0x1f7)]&&settings['telegramToken']!=''&&(_0x17dd2b={..._0x17dd2b,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x514da7(0x394)]!=''&&(_0x17dd2b={..._0x17dd2b,'bbPassword':_0x514da7(0x2ca)}),(settings[_0x514da7(0x394)]&&settings['bbPassword']==_0x514da7(0x272)||settings[_0x514da7(0x1f7)]&&settings['telegramToken']==_0x514da7(0x272))&&(_0x17dd2b={..._0x17dd2b,'restored':{'password':settings['bbPassword']==_0x514da7(0x272),'telegram':settings['telegramToken']=='***'}}),_0x17dd2b;}async function updateBB(_0x56783a){const _0x4c9c4d=_0x58d92a;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0xee3a6=>{const _0x28123e=_0x3b94;restartBot(_0xee3a6[_0x28123e(0x35f)]);});if(_0x56783a==_0x4c9c4d(0x2d1))process[_0x4c9c4d(0x358)]({'update':!![],'environment':environment},_0x14a529=>{});else _0x56783a==_0x4c9c4d(0x315)&&process['send']({'reinstall':!![],'environment':environment},_0xd3b4e=>{});}function startBot(_0x2e129b,_0x3e69e3,_0x35fe72){const _0x4ff896=_0x58d92a;if(debugging)_0x2e129b['push']('-d');let _0xde04a2=![];const _0x416fc8=_0x2e129b[0x0];_0x3e69e3={..._0x3e69e3,'stdio':[_0x4ff896(0x3a2),_0x4ff896(0x3a2),_0x4ff896(0x3a2),_0x4ff896(0x3cd)]},pid[_0x416fc8]=childProcess[_0x4ff896(0x265)](botfile,_0x2e129b,_0x3e69e3),pid[_0x416fc8]['on'](_0x4ff896(0x312),_0x58f93f=>{const _0x2e19f3=_0x4ff896;switch(Object[_0x2e19f3(0x379)](_0x58f93f)[0x0]){case'botname':updateBotName(_0x416fc8,_0x58f93f[_0x2e19f3(0x2d9)]);break;case _0x2e19f3(0x297):updateBotManager();break;case _0x2e19f3(0x211):updateStatus(_0x416fc8,_0x58f93f['status']);break;case _0x2e19f3(0x34b):updateLive(_0x416fc8,_0x58f93f[_0x2e19f3(0x34b)]);break;case'started':updateLive(_0x416fc8,_0x58f93f[_0x2e19f3(0x240)]),io['to'](_0x416fc8)[_0x2e19f3(0x334)](_0x2e19f3(0x211),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x2e19f3(0x335):_0x58f93f[_0x2e19f3(0x335)]==_0x2e19f3(0x1f4)&&restartBot(_0x416fc8);_0x58f93f['stop']==_0x2e19f3(0x2c2)&&toggleBot(_0x416fc8,_0x2e19f3(0x362),_0x2e19f3(0x328));break;case _0x2e19f3(0x36c):sendTelegramBot(_0x416fc8,_0x58f93f['telegram']);break;case _0x2e19f3(0x20f):sendTelegramMsg(_0x58f93f[_0x2e19f3(0x20f)]);break;case'function':io['to'](_0x416fc8)[_0x2e19f3(0x334)](_0x58f93f[_0x2e19f3(0x23f)],_0x58f93f[_0x2e19f3(0x2ed)]);break;}}),pid[_0x416fc8]['on'](_0x4ff896(0x290),function(_0x24c889){if(_0xde04a2)return;_0xde04a2=!![],_0x35fe72(_0x24c889);}),pid[_0x416fc8]['on'](_0x4ff896(0x307),async function(_0x6928f6){const _0x29cef9=_0x4ff896;if(terminating)return;if(installingUpdate){logger['debug'](_0x29cef9(0x36f)),io[_0x29cef9(0x234)]();return;}if(_0xde04a2)return;_0xde04a2=!![],_0x35fe72(null);const _0x47ad99=dbConfig[_0x29cef9(0x283)](_0x29cef9(0x33c))[_0x29cef9(0x3ba)]({'botID':_0x416fc8})[_0x29cef9(0x2b8)]();_0x47ad99&&(_0x47ad99[_0x29cef9(0x211)]==_0x29cef9(0x369)||_0x47ad99[_0x29cef9(0x211)]=='new')&&(await sleep(0x3e8),updateLive(_0x416fc8,_0x29cef9(0x328)),logger[_0x29cef9(0x238)]('Restarting\x20Bot\x20'+_0x416fc8),startBot([_0x416fc8,userID],{'cwd':bbpath},function(_0x1a0b17){const _0x15a1fe=_0x29cef9;if(_0x1a0b17)logger[_0x15a1fe(0x238)](_0x1a0b17);}));});}function stopBot(_0x4e2954){const _0x24fbc6=_0x58d92a;getClientsWithBotID(_0x4e2954)['forEach'](_0x3840ed=>{const _0x134921=_0x3b94;getSocket(_0x3840ed['id'])[_0x134921(0x252)](!![]),removeClient(_0x3840ed['id']);}),pid[_0x4e2954]&&(pid[_0x4e2954][_0x24fbc6(0x2c2)](),pid[_0x4e2954]=null);}function _0x3b94(_0x1ef032,_0x2cd3d5){const _0x5b49c7=_0x2a05();return _0x3b94=function(_0x513158,_0xa08c6b){_0x513158=_0x513158-0x1da;let _0x2a057f=_0x5b49c7[_0x513158];return _0x2a057f;},_0x3b94(_0x1ef032,_0x2cd3d5);}function stopAllBots(){terminating=!![];const _0x23febf=getEnabledBots();_0x23febf['forEach'](_0x55c830=>{stopBot(_0x55c830['botID']);});}function restartBot(_0x3db7e2){if(pid[_0x3db7e2])pid[_0x3db7e2]['kill']();}function addBot(){const _0x454f5f=_0x58d92a;let _0x369f75;for(let _0x15edce=0x1;_0x15edce<0x3e9;_0x15edce++){_0x369f75=_0x15edce['toString']()[_0x454f5f(0x260)](0x3,'0');let _0x472f4a=config[_0x454f5f(0x3ba)](_0x211e7a=>_0x211e7a[_0x454f5f(0x35f)]==_0x369f75);if(!_0x472f4a)break;}if(_0x369f75==='1000'){logger[_0x454f5f(0x238)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x454f5f(0x238)](_0x454f5f(0x289)+_0x369f75),dbConfig[_0x454f5f(0x283)](_0x454f5f(0x33c))['push']({'botID':_0x369f75,'botname':_0x454f5f(0x37f)+_0x369f75,'status':'new','live':''})['write'](),startBot([_0x369f75,userID],{'cwd':bbpath},function(_0x151157){const _0x2379a5=_0x454f5f;if(_0x151157)logger[_0x2379a5(0x238)](_0x151157);}),config=getConfiguration(),io['to'](_0x454f5f(0x2a6))[_0x454f5f(0x334)](_0x454f5f(0x33c),config),broadcastToBots(_0x454f5f(0x33c),JSON['stringify'](config));}function deleteBot(_0x5b0258){const _0xb7dac3=_0x58d92a;getClientsWithBotID(_0x5b0258)[_0xb7dac3(0x37c)](_0x5248a2=>{const _0x4b3773=_0xb7dac3;getSocket(_0x5248a2['id'])[_0x4b3773(0x252)](!![]),removeClient(_0x5248a2['id']);}),dbConfig['get']('bots')[_0xb7dac3(0x332)]({'botID':_0x5b0258})[_0xb7dac3(0x281)](),logger[_0xb7dac3(0x238)](_0xb7dac3(0x256)+_0x5b0258),stopBot(_0x5b0258);try{if(fs[_0xb7dac3(0x324)](path['join'](configpath,_0xb7dac3(0x365)+_0x5b0258+'-config.json')))fs[_0xb7dac3(0x1f9)](path[_0xb7dac3(0x345)](configpath,_0xb7dac3(0x365)+_0x5b0258+'-config.json'));if(fs['existsSync'](path['join'](configpath,_0xb7dac3(0x365)+_0x5b0258+'-events.json')))fs[_0xb7dac3(0x1f9)](path[_0xb7dac3(0x345)](configpath,'bot-'+_0x5b0258+_0xb7dac3(0x3b4)));if(fs[_0xb7dac3(0x324)](path[_0xb7dac3(0x345)](configpath,_0xb7dac3(0x365)+_0x5b0258+_0xb7dac3(0x279))))fs[_0xb7dac3(0x1f9)](path[_0xb7dac3(0x345)](configpath,'bot-'+_0x5b0258+'-performance.json'));if(fs[_0xb7dac3(0x324)](path['join'](configpath,_0xb7dac3(0x365)+_0x5b0258+_0xb7dac3(0x1f1))))fs[_0xb7dac3(0x1f9)](path[_0xb7dac3(0x345)](configpath,_0xb7dac3(0x365)+_0x5b0258+_0xb7dac3(0x1f1)));}catch(_0x44579a){if(_0x44579a)logger[_0xb7dac3(0x238)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x44579a);}config=getConfiguration(),io['to'](_0xb7dac3(0x2a6))[_0xb7dac3(0x334)](_0xb7dac3(0x33c),config),broadcastToBots(_0xb7dac3(0x33c),JSON[_0xb7dac3(0x34a)](config));}function toggleBot(_0x16a5f5,_0x24fb65,_0x496e40){const _0xbb95e0=_0x58d92a;dbConfig[_0xbb95e0(0x283)](_0xbb95e0(0x33c))['find']({'botID':_0x16a5f5})[_0xbb95e0(0x2ae)]({'status':_0x24fb65})[_0xbb95e0(0x2ae)]({'live':_0x496e40})[_0xbb95e0(0x281)]();if(_0x24fb65==_0xbb95e0(0x369)||_0x24fb65==_0xbb95e0(0x330))logger[_0xbb95e0(0x238)](_0xbb95e0(0x33e)+_0x16a5f5),startBot([_0x16a5f5,userID],{'cwd':bbpath},function(_0x1b27d5){const _0x5ed5eb=_0xbb95e0;if(_0x1b27d5)logger[_0x5ed5eb(0x238)](_0x1b27d5);});else(_0x24fb65=='disabled'||_0x24fb65=='new-disabled')&&(logger[_0xbb95e0(0x238)](_0xbb95e0(0x3a4)+_0x16a5f5),stopBot(_0x16a5f5));config=getConfiguration(),io['to'](_0xbb95e0(0x2a6))['emit'](_0xbb95e0(0x33c),config),broadcastToBots('bots',JSON[_0xbb95e0(0x34a)](config));}function toggleStatus(_0x5e826c){const _0x58e9fc=_0x58d92a;let _0xd7b931=dbConfig['get'](_0x58e9fc(0x33c))[_0x58e9fc(0x3ba)]({'botID':_0x5e826c})['value'](),_0x227aa4;if(_0xd7b931[_0x58e9fc(0x211)]==='enabled')_0x227aa4=_0x58e9fc(0x362);else{if(_0xd7b931['status']===_0x58e9fc(0x330))_0x227aa4=_0x58e9fc(0x2b2);else{if(_0xd7b931[_0x58e9fc(0x211)]===_0x58e9fc(0x2b2))_0x227aa4=_0x58e9fc(0x330);else{if(_0xd7b931[_0x58e9fc(0x211)]===_0x58e9fc(0x362))_0x227aa4='enabled';}}}return _0x227aa4;}function updateStatus(_0x17b6c9,_0x280726){const _0x3637ef=_0x58d92a;dbConfig[_0x3637ef(0x283)](_0x3637ef(0x33c))[_0x3637ef(0x3ba)]({'botID':_0x17b6c9})[_0x3637ef(0x2ae)]({'status':_0x280726})[_0x3637ef(0x281)](),config=getConfiguration(),io['to'](_0x3637ef(0x2a6))[_0x3637ef(0x334)](_0x3637ef(0x33c),config),broadcastToBots(_0x3637ef(0x33c),JSON[_0x3637ef(0x34a)](config));}function updateLive(_0x139128,_0x4c01c1){const _0x4032a9=_0x58d92a;dbConfig['get'](_0x4032a9(0x33c))[_0x4032a9(0x3ba)]({'botID':_0x139128})['assign']({'live':_0x4c01c1})[_0x4032a9(0x281)](),config=getConfiguration(),io['to']('botmanager')[_0x4032a9(0x334)](_0x4032a9(0x33c),config),broadcastToBots(_0x4032a9(0x33c),JSON[_0x4032a9(0x34a)](config));}function updateBotName(_0x3555d9,_0x263d1a){const _0x3612d5=_0x58d92a;dbConfig[_0x3612d5(0x283)](_0x3612d5(0x33c))['find']({'botID':_0x3555d9})[_0x3612d5(0x2ae)]({'botname':_0x263d1a})[_0x3612d5(0x281)](),config=getConfiguration(),io['to']('botmanager')[_0x3612d5(0x334)](_0x3612d5(0x33c),config),broadcastToBots(_0x3612d5(0x33c),JSON['stringify'](config));}function updateBotManager(){const _0x50922d=_0x58d92a;config=getConfiguration(),io['to'](_0x50922d(0x2a6))[_0x50922d(0x334)](_0x50922d(0x33c),config),broadcastToBots(_0x50922d(0x33c),JSON[_0x50922d(0x34a)](config));}function toggleBotMode(_0x211320){const _0x271a75=_0x58d92a;if(pid[_0x211320])pid[_0x211320][_0x271a75(0x358)]({'function':_0x271a75(0x207),'args':null});else{const _0x1dd41f=configpath+'bot-'+_0x211320+'-config.json',_0x170333=fs[_0x271a75(0x344)](_0x1dd41f),_0xf76a88=JSON[_0x271a75(0x2e0)](_0x170333),_0x3f3050=_0xf76a88[_0x271a75(0x1dc)][0x0][_0x271a75(0x3c7)];_0xf76a88[_0x271a75(0x1dc)][0x0][_0x271a75(0x3c7)]=!_0x3f3050;const _0x2a45b6=JSON[_0x271a75(0x34a)](_0xf76a88,null,0x2);fs['writeFileSync'](_0x1dd41f,_0x2a45b6),config=getConfiguration(),io['to'](_0x271a75(0x2a6))['emit'](_0x271a75(0x33c),config),broadcastToBots(_0x271a75(0x33c),JSON[_0x271a75(0x34a)](config));}}function validateTelegram(_0x5d5782){const _0xc71813=_0x58d92a;if(_0x5d5782[_0xc71813(0x3db)][_0xc71813(0x2e5)]!=settings[_0xc71813(0x3d8)]&&'@'+_0x5d5782[_0xc71813(0x3db)][_0xc71813(0x2e5)]!=settings[_0xc71813(0x3d8)]||_0x5d5782['chat']['id']!=settings[_0xc71813(0x322)])return sendTelegram(_0x5d5782[_0xc71813(0x235)]['id'],_0xc71813(0x26b),{'parse_mode':_0xc71813(0x2b4)}),![];return!![];}async function initTelegram(){const _0x257d48=_0x58d92a;if(tgBot)tgBot[_0x257d48(0x335)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x257d48(0x1f7)]);let _0x4f84d3=_0x257d48(0x2e6);_0x4f84d3+='\x0a',_0x4f84d3+=_0x257d48(0x24e),_0x4f84d3+=_0x257d48(0x23e),_0x4f84d3+=_0x257d48(0x2c8),_0x4f84d3+=_0x257d48(0x2f1),_0x4f84d3+=_0x257d48(0x370),_0x4f84d3+=_0x257d48(0x261),_0x4f84d3+=_0x257d48(0x241),_0x4f84d3+=_0x257d48(0x27c),_0x4f84d3+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x4f84d3+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x4f84d3+=_0x257d48(0x1f5),_0x4f84d3+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x4f84d3+=_0x257d48(0x3cb),_0x4f84d3+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2ce258='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2ce258+='\x0a',_0x2ce258+=_0x4f84d3,tgBot[_0x257d48(0x225)]((_0x819a54,_0x3cf638)=>{const _0x2c2b43=_0x257d48;logger[_0x2c2b43(0x21a)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x2c2b43(0x359)](_0x2c2b43(0x204),_0x819a54);}),tgBot[_0x257d48(0x2bb)](async(_0xddc70e,_0x514296)=>{const _0x4f14b6=_0x257d48;if(!(!settings['telegramChatId']&&_0xddc70e['update'][_0x4f14b6(0x312)][_0x4f14b6(0x28c)]=='/start')){if(!validateTelegram(_0xddc70e))return;}_0x514296();}),tgBot[_0x257d48(0x325)](_0x257d48(0x2f9),async _0x5b8194=>{const _0x56442a=_0x257d48;if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x5b8194[_0x56442a(0x235)]['id']);updateSetting(_0x56442a(0x29a),!![]);if(!validateTelegram(_0x5b8194))return;await sendTelegram(_0x5b8194[_0x56442a(0x235)]['id'],_0x2ce258);}),tgBot[_0x257d48(0x325)]('enable',async _0x54b7d0=>{const _0x3bbc97=_0x257d48;updateSetting(_0x3bbc97(0x29a),!![]),await sendTelegram(_0x54b7d0['chat']['id'],_0x3bbc97(0x313));}),tgBot[_0x257d48(0x325)](_0x257d48(0x276),async _0x43bad8=>{const _0x3352c4=_0x257d48;await sendTelegram(_0x43bad8[_0x3352c4(0x235)]['id'],_0x3352c4(0x26d)),updateSetting(_0x3352c4(0x29a),![]);}),tgBot[_0x257d48(0x325)]('config',async _0x3b9871=>{const _0x4c00b2=_0x257d48,_0x5f1c90=Markup['inlineKeyboard']([Markup[_0x4c00b2(0x28d)][_0x4c00b2(0x3ab)]('Orders',_0x4c00b2(0x37e)),Markup[_0x4c00b2(0x28d)][_0x4c00b2(0x3ab)](_0x4c00b2(0x208),'config_alerts'),Markup[_0x4c00b2(0x28d)][_0x4c00b2(0x3ab)]('All','config_all')]);_0x3b9871[_0x4c00b2(0x3c1)](_0x4c00b2(0x364),_0x5f1c90);}),tgBot[_0x257d48(0x1e7)](_0x257d48(0x37e),async _0x3ba5b4=>{const _0x526afc=_0x257d48;_0x3ba5b4['editMessageReplyMarkup'](),updateSetting(_0x526afc(0x331),_0x526afc(0x213)),updateSetting(_0x526afc(0x29a),!![]),await sendTelegram(_0x3ba5b4['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x257d48(0x1e7)](_0x257d48(0x27f),async _0x14dd5e=>{const _0x1ae1b3=_0x257d48;_0x14dd5e[_0x1ae1b3(0x2ef)](),updateSetting(_0x1ae1b3(0x331),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x14dd5e['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x257d48(0x1e7)](_0x257d48(0x236),async _0x1ddc7e=>{const _0x322432=_0x257d48;_0x1ddc7e['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x322432(0x3b8)),updateSetting(_0x322432(0x29a),!![]),await sendTelegram(_0x1ddc7e['chat']['id'],_0x322432(0x2bc));}),tgBot[_0x257d48(0x325)]('status',async _0x312183=>{const _0xed2a56=_0x257d48,_0xc68d36=getBotsWithMode();let _0x7270aa='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x102b32=>{const _0xb4066e=_0x3b94,_0x34c7d4=_0xc68d36['find'](_0x3caaf3=>_0x3caaf3['botID']==_0x102b32['botID'])[_0xb4066e(0x205)];_0x7270aa+=_0xb4066e(0x37f)+_0x102b32[_0xb4066e(0x35f)]+':\x20'+_0x102b32[_0xb4066e(0x211)]+_0xb4066e(0x1f2)+_0x34c7d4+_0xb4066e(0x1f2)+_0x102b32[_0xb4066e(0x34b)]+'\x0a';}),_0x7270aa+='\x0a',_0x7270aa+=_0xed2a56(0x1de),_0x7270aa+=!settings[_0xed2a56(0x29a)]?_0xed2a56(0x22e):'Notifications\x20enabled\x0a',_0x7270aa+=settings[_0xed2a56(0x29a)]?settings['telegramEvents']==_0xed2a56(0x3b8)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0xed2a56(0x1ef)+settings[_0xed2a56(0x331)]+_0xed2a56(0x23b):'',await sendTelegram(_0x312183[_0xed2a56(0x235)]['id'],_0x7270aa,{'parse_mode':_0xed2a56(0x2b4)});}),tgBot[_0x257d48(0x325)]('restart',async _0x2ad5b2=>{const _0x17e0ae=_0x257d48,_0x47155=getEnabledBots();if(_0x47155[_0x17e0ae(0x353)]==0x0)await sendTelegram(_0x2ad5b2[_0x17e0ae(0x235)]['id'],_0x17e0ae(0x215));else{if(_0x47155['length']>0x1)_0x47155[_0x17e0ae(0x39a)]({'botID':_0x17e0ae(0x3b8)});let _0x2d8d75=[],_0x4a5333=[];const _0x4bd26d=_0x47155['length']%0x4==0x0||_0x47155[_0x17e0ae(0x353)]%0x4==0x3||_0x47155[_0x17e0ae(0x353)]%0x3==0x1?0x4:0x3;let _0x31d573=0x0;_0x47155[_0x17e0ae(0x37c)]((_0x31ab9e,_0x2954ae)=>{const _0x5d7e76=_0x17e0ae;if(_0x2954ae%_0x4bd26d==0x0)_0x4a5333=[];_0x4a5333[_0x5d7e76(0x39a)](Markup[_0x5d7e76(0x28d)][_0x5d7e76(0x3ab)](_0x31ab9e[_0x5d7e76(0x35f)]==_0x5d7e76(0x3b8)?_0x5d7e76(0x389):_0x5d7e76(0x37f)+_0x31ab9e[_0x5d7e76(0x35f)],'restart_'+_0x31ab9e[_0x5d7e76(0x35f)])),_0x2954ae%_0x4bd26d==0x0&&(_0x2d8d75[_0x31d573]=_0x4a5333,_0x31d573++);});const _0x545c3a=Markup[_0x17e0ae(0x218)](_0x2d8d75);_0x2ad5b2[_0x17e0ae(0x3c1)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x545c3a);}}),tgBot[_0x257d48(0x1e7)](/restart_(.+)/,async _0x2fd0b9=>{const _0x5cd1e4=_0x257d48,_0x515274=_0x2fd0b9[_0x5cd1e4(0x292)][0x1];_0x2fd0b9[_0x5cd1e4(0x2ef)](),_0x515274==_0x5cd1e4(0x3b8)?config[_0x5cd1e4(0x37c)](_0x401cce=>{restartBot(_0x401cce['botID']);}):restartBot(_0x515274);}),tgBot['command']('on',async _0x417dfb=>{const _0x42daff=_0x257d48,_0x1856b6=getDisabledBots();if(_0x1856b6[_0x42daff(0x353)]==0x0)await sendTelegram(_0x417dfb[_0x42daff(0x235)]['id'],_0x42daff(0x1df));else{if(_0x1856b6[_0x42daff(0x353)]>0x1)_0x1856b6[_0x42daff(0x39a)]({'botID':'all'});let _0x41ef3a=[],_0x3e784b=[];const _0x55dd22=_0x1856b6['length']%0x4==0x0||_0x1856b6['length']%0x4==0x3||_0x1856b6[_0x42daff(0x353)]%0x3==0x1?0x4:0x3;let _0x14e1ef=0x0;_0x1856b6['forEach']((_0x571725,_0x14f07e)=>{const _0x1e5844=_0x42daff;if(_0x14f07e%_0x55dd22==0x0)_0x3e784b=[];_0x3e784b['push'](Markup[_0x1e5844(0x28d)]['callback'](_0x571725[_0x1e5844(0x35f)]=='all'?_0x1e5844(0x389):_0x1e5844(0x37f)+_0x571725[_0x1e5844(0x35f)],_0x1e5844(0x1e8)+_0x571725[_0x1e5844(0x35f)])),_0x14f07e%_0x55dd22==0x0&&(_0x41ef3a[_0x14e1ef]=_0x3e784b,_0x14e1ef++);});const _0x3fa5fa=Markup[_0x42daff(0x218)](_0x41ef3a);_0x417dfb['reply'](_0x42daff(0x2d0),_0x3fa5fa);}}),tgBot[_0x257d48(0x1e7)](/on_(.+)/,async _0x1ab599=>{const _0x5658c3=_0x257d48,_0xe064cc=_0x1ab599[_0x5658c3(0x292)][0x1];_0x1ab599[_0x5658c3(0x2ef)]();if(_0xe064cc=='all'){const _0xb1b275=getDisabledBots();await sendTelegram(_0x1ab599['chat']['id'],_0x5658c3(0x39f)),_0xb1b275[_0x5658c3(0x37c)](_0x4957ed=>{const _0x587938=_0x5658c3;if(_0x4957ed[_0x587938(0x35f)]!=_0x587938(0x3b8))toggleBot(_0x4957ed['botID'],toggleStatus(_0x4957ed[_0x587938(0x35f)]),_0x587938(0x328));});}else await sendTelegram(_0x1ab599[_0x5658c3(0x235)]['id'],_0x5658c3(0x2de)+_0xe064cc),toggleBot(_0xe064cc,toggleStatus(_0xe064cc),'stopped');}),tgBot[_0x257d48(0x325)](_0x257d48(0x38f),async _0xd4c22b=>{const _0x8643d0=_0x257d48,_0x9e6c35=getEnabledBots();if(_0x9e6c35['length']==0x0)await sendTelegram(_0xd4c22b[_0x8643d0(0x235)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x9e6c35[_0x8643d0(0x353)]>0x1)_0x9e6c35[_0x8643d0(0x39a)]({'botID':_0x8643d0(0x3b8)});let _0x441797=[],_0x471650=[];const _0x3a9d74=_0x9e6c35[_0x8643d0(0x353)]%0x4==0x0||_0x9e6c35[_0x8643d0(0x353)]%0x4==0x3||_0x9e6c35[_0x8643d0(0x353)]%0x3==0x1?0x4:0x3;let _0x1f8937=0x0;_0x9e6c35[_0x8643d0(0x37c)]((_0x53952f,_0x467e89)=>{const _0x569c9e=_0x8643d0;if(_0x467e89%_0x3a9d74==0x0)_0x471650=[];_0x471650[_0x569c9e(0x39a)](Markup[_0x569c9e(0x28d)][_0x569c9e(0x3ab)](_0x53952f[_0x569c9e(0x35f)]==_0x569c9e(0x3b8)?_0x569c9e(0x389):_0x569c9e(0x37f)+_0x53952f[_0x569c9e(0x35f)],_0x569c9e(0x255)+_0x53952f['botID'])),_0x467e89%_0x3a9d74==0x0&&(_0x441797[_0x1f8937]=_0x471650,_0x1f8937++);});const _0x3c9b64=Markup[_0x8643d0(0x218)](_0x441797);_0xd4c22b['reply'](_0x8643d0(0x3a3),_0x3c9b64);}}),tgBot[_0x257d48(0x1e7)](/off_(.+)/,async _0x5b260b=>{const _0x3026f6=_0x257d48,_0x911385=_0x5b260b['match'][0x1];_0x5b260b[_0x3026f6(0x2ef)]();if(_0x911385==_0x3026f6(0x3b8)){const _0x490d82=getEnabledBots();await sendTelegram(_0x5b260b['chat']['id'],_0x3026f6(0x2ab)),_0x490d82['forEach'](_0x3f6ba8=>{const _0x1c1357=_0x3026f6;if(_0x3f6ba8[_0x1c1357(0x35f)]!=_0x1c1357(0x3b8))toggleBot(_0x3f6ba8['botID'],toggleStatus(_0x3f6ba8[_0x1c1357(0x35f)]),_0x1c1357(0x328));});}else await sendTelegram(_0x5b260b[_0x3026f6(0x235)]['id'],_0x3026f6(0x27d)+_0x911385),toggleBot(_0x911385,toggleStatus(_0x911385),_0x3026f6(0x328));}),tgBot[_0x257d48(0x325)](_0x257d48(0x3a1),async _0x45be7e=>{const _0x593655=_0x257d48,_0x52c9f0=getEnabledBots();if(_0x52c9f0[_0x593655(0x353)]==0x0)await sendTelegram(_0x45be7e[_0x593655(0x235)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x52c9f0[_0x593655(0x353)]>0x1){let _0x658b37=[],_0x32d807=[];const _0x609f18=_0x52c9f0[_0x593655(0x353)]%0x4==0x0||_0x52c9f0[_0x593655(0x353)]%0x4==0x3||_0x52c9f0['length']%0x3==0x1?0x4:0x3;let _0x54c782=0x0;_0x52c9f0[_0x593655(0x37c)]((_0x4ca749,_0x45a1a)=>{const _0xfb57af=_0x593655;if(_0x45a1a%_0x609f18==0x0)_0x32d807=[];_0x32d807['push'](Markup[_0xfb57af(0x28d)][_0xfb57af(0x3ab)]('Bot\x20'+_0x4ca749[_0xfb57af(0x35f)],_0xfb57af(0x2cb)+_0x4ca749[_0xfb57af(0x35f)])),_0x45a1a%_0x609f18==0x0&&(_0x658b37[_0x54c782]=_0x32d807,_0x54c782++);});const _0x22fe8b=Markup[_0x593655(0x218)](_0x658b37);_0x45be7e[_0x593655(0x3c1)](_0x593655(0x375),_0x22fe8b);}else{const _0x2bee49=_0x52c9f0[0x0][_0x593655(0x35f)];if(pid[_0x2bee49])pid[_0x2bee49]['send']({'function':_0x593655(0x3d7),'args':null});}}}),tgBot[_0x257d48(0x1e7)](/metrics_(.+)/,async _0x2e9f20=>{const _0x477e0b=_0x257d48,_0x2ce6d1=_0x2e9f20[_0x477e0b(0x292)][0x1];_0x2e9f20['editMessageReplyMarkup']();if(pid[_0x2ce6d1])pid[_0x2ce6d1]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x257d48(0x325)](_0x257d48(0x338),async _0x478498=>{const _0x175fed=_0x257d48,_0x55a06d=getEnabledBots();if(_0x55a06d[_0x175fed(0x353)]==0x0)await sendTelegram(_0x478498[_0x175fed(0x235)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x55a06d[_0x175fed(0x353)]>0x1){let _0x1ac1d2=[],_0xd99f9c=[];const _0x3af76c=_0x55a06d[_0x175fed(0x353)]%0x4==0x0||_0x55a06d['length']%0x4==0x3||_0x55a06d['length']%0x3==0x1?0x4:0x3;let _0x61b13c=0x0;_0x55a06d[_0x175fed(0x37c)]((_0x15bfaf,_0xdf3364)=>{const _0x45fc3a=_0x175fed;if(_0xdf3364%_0x3af76c==0x0)_0xd99f9c=[];_0xd99f9c['push'](Markup[_0x45fc3a(0x28d)][_0x45fc3a(0x3ab)](_0x45fc3a(0x37f)+_0x15bfaf[_0x45fc3a(0x35f)],'portfolio_'+_0x15bfaf[_0x45fc3a(0x35f)])),_0xdf3364%_0x3af76c==0x0&&(_0x1ac1d2[_0x61b13c]=_0xd99f9c,_0x61b13c++);});const _0x439204=Markup[_0x175fed(0x218)](_0x1ac1d2);_0x478498['reply'](_0x175fed(0x30c),_0x439204);}else{const _0x497bc1=_0x55a06d[0x0]['botID'];if(pid[_0x497bc1])pid[_0x497bc1][_0x175fed(0x358)]({'function':_0x175fed(0x319),'args':null});}}}),tgBot[_0x257d48(0x1e7)](/portfolio_(.+)/,async _0xfb807e=>{const _0x387464=_0x257d48,_0x45c93e=_0xfb807e[_0x387464(0x292)][0x1];_0xfb807e[_0x387464(0x2ef)]();if(pid[_0x45c93e])pid[_0x45c93e]['send']({'function':_0x387464(0x319),'args':null});}),tgBot['command']('update',async _0x1fb463=>{const _0x3115b1=_0x257d48;await getMessages();if(!updateAvailable)await sendTelegram(_0x1fb463[_0x3115b1(0x235)]['id'],_0x3115b1(0x327));else{if(!validInstallation)await sendTelegram(_0x1fb463[_0x3115b1(0x235)]['id'],_0x3115b1(0x20a));else{const _0x108c24=Markup[_0x3115b1(0x218)]([Markup[_0x3115b1(0x28d)][_0x3115b1(0x3ab)](_0x3115b1(0x21b),_0x3115b1(0x33b)),Markup[_0x3115b1(0x28d)][_0x3115b1(0x3ab)]('No',_0x3115b1(0x366))]);_0x1fb463[_0x3115b1(0x3c1)](_0x3115b1(0x36d),_0x108c24);}}}),tgBot[_0x257d48(0x1e7)](/update_(.+)/,async _0x3ef5c7=>{const _0x5a93c1=_0x257d48,_0x59bc6c=_0x3ef5c7['match'][0x1];_0x3ef5c7['editMessageReplyMarkup'](),_0x59bc6c==_0x5a93c1(0x1db)&&(await sendTelegram(_0x3ef5c7['chat']['id'],_0x5a93c1(0x339)),updateBB(_0x5a93c1(0x2d1))),_0x59bc6c=='no'&&await sendTelegram(_0x3ef5c7[_0x5a93c1(0x235)]['id'],_0x5a93c1(0x277));}),tgBot[_0x257d48(0x325)](_0x257d48(0x315),async _0x528e75=>{const _0x511243=_0x257d48;if(!validInstallation)await sendTelegram(_0x528e75[_0x511243(0x235)]['id'],_0x511243(0x3bf));else{const _0x33716b=Markup[_0x511243(0x218)]([Markup['button']['callback']('Yes',_0x511243(0x1f3)),Markup[_0x511243(0x28d)][_0x511243(0x3ab)]('No',_0x511243(0x337))]);_0x528e75[_0x511243(0x3c1)](_0x511243(0x25f),_0x33716b);}}),tgBot['action'](/reinstall_(.+)/,async _0x3a6374=>{const _0x13c43f=_0x257d48,_0x25740d=_0x3a6374[_0x13c43f(0x292)][0x1];_0x3a6374[_0x13c43f(0x2ef)](),_0x25740d==_0x13c43f(0x1db)&&(await sendTelegram(_0x3a6374[_0x13c43f(0x235)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x25740d=='no'&&await sendTelegram(_0x3a6374['chat']['id'],_0x13c43f(0x387));}),tgBot['command'](_0x257d48(0x1fc),async _0x4a829f=>{const _0x311916=_0x257d48,_0xf715ca=getBotsWithMode();if(_0xf715ca[_0x311916(0x353)]==0x0)await sendTelegram(_0x4a829f['chat']['id'],_0x311916(0x215));else{let _0x3a8e61=[],_0x3365c1=[];const _0x20740a=0x2;let _0x355481=0x0;_0xf715ca[_0x311916(0x37c)]((_0x167742,_0x530b37)=>{const _0xd8fbf3=_0x311916;if(_0x530b37%_0x20740a==0x0)_0x3365c1=[];_0x3365c1['push'](Markup[_0xd8fbf3(0x28d)]['callback'](_0xd8fbf3(0x37f)+_0x167742['botID']+'\x20('+_0x167742['mode']+')',_0xd8fbf3(0x294)+_0x167742['botID'])),_0x530b37%_0x20740a==0x0&&(_0x3a8e61[_0x355481]=_0x3365c1,_0x355481++);});const _0x1c5ef7=Markup[_0x311916(0x218)](_0x3a8e61);_0x4a829f[_0x311916(0x3c1)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x1c5ef7);}}),tgBot[_0x257d48(0x1e7)](/toggle_(.+)/,async _0x21e48f=>{const _0x3735f0=_0x257d48,_0xf2eeca=_0x21e48f[_0x3735f0(0x292)][0x1];_0x21e48f[_0x3735f0(0x2ef)]();const _0x10b7b2=getBotsWithMode(),_0xae0309=_0x10b7b2[_0x3735f0(0x3ba)](_0x28c7fa=>_0x28c7fa[_0x3735f0(0x35f)]==_0xf2eeca),_0x5bcc78=_0xae0309[_0x3735f0(0x205)]=='auto'?_0x3735f0(0x26a):_0x3735f0(0x373);await sendTelegram(_0x21e48f['chat']['id'],_0x3735f0(0x299)+_0xf2eeca+'\x20to\x20'+_0x5bcc78+_0x3735f0(0x37d)),toggleBotMode(_0xf2eeca);}),tgBot[_0x257d48(0x325)](_0x257d48(0x250),async _0x25c9e3=>{const _0x1801c7=_0x257d48;let _0x1a1560='';config[_0x1801c7(0x37c)](_0x2effeb=>{const _0x27c8ae=_0x1801c7;_0x1a1560+='Bot\x20'+_0x2effeb[_0x27c8ae(0x35f)]+':\x20'+_0x2effeb[_0x27c8ae(0x2d9)]+'\x0a';}),await sendTelegram(_0x25c9e3[_0x1801c7(0x235)]['id'],_0x1a1560,{'parse_mode':'HTML'});}),tgBot[_0x257d48(0x325)](_0x257d48(0x220),async _0x3dc10d=>{const _0xbd0fb9=_0x257d48;await sendTelegram(_0x3dc10d[_0xbd0fb9(0x235)]['id'],_0x4f84d3);}),process[_0x257d48(0x3be)](_0x257d48(0x308),()=>tgBot[_0x257d48(0x335)]('SIGINT')),process['once']('SIGTERM',()=>tgBot[_0x257d48(0x335)](_0x257d48(0x2ad))),tgBot[_0x257d48(0x2e1)]();}}function disableTelegram(){const _0x3982c9=_0x58d92a;tgBot&&tgBot[_0x3982c9(0x335)]();}async function sendTelegram(_0x45e311,_0x2b1937,_0x4a31c7){const _0x1e17cb=_0x58d92a;try{await tgBot[_0x1e17cb(0x36c)][_0x1e17cb(0x32c)](_0x45e311,_0x2b1937,_0x4a31c7);}catch(_0x460e51){console[_0x1e17cb(0x2ec)](_0x1e17cb(0x243),_0x460e51);}}async function sendTelegramBot(_0x4335a8,_0x4fd732){const _0x30c292=_0x58d92a;if(settings['telegramEnabled']){if(settings[_0x30c292(0x331)]==_0x30c292(0x3b8)||(_0x4fd732[_0x30c292(0x367)]=='error'||_0x4fd732[_0x30c292(0x367)]==_0x30c292(0x209)||_0x4fd732['type']=='success')&&settings['telegramEvents']==_0x30c292(0x31a)||_0x4fd732[_0x30c292(0x367)]==_0x30c292(0x301)&&settings[_0x30c292(0x331)]=='orders'){if(tgBot&&settings[_0x30c292(0x322)]){if(_0x4fd732['showname'])await sendTelegram(settings[_0x30c292(0x322)],_0x4fd732['botname']+_0x30c292(0x22f)+_0x4fd732[_0x30c292(0x385)]);else await sendTelegram(settings['telegramChatId'],_0x30c292(0x37f)+_0x4335a8+_0x30c292(0x22f)+_0x4fd732[_0x30c292(0x385)]);}}}}async function sendTelegramMsg(_0x34cc37,_0x357258=_0x58d92a(0x2b4)){const _0x2abd0d=_0x58d92a;return settings[_0x2abd0d(0x29a)]&&tgBot&&settings[_0x2abd0d(0x322)]?(await sendTelegram(settings[_0x2abd0d(0x322)],_0x34cc37,{'parse_mode':_0x357258}),!![]):![];}function getDeviceWithIp(_0x194fd1){const _0x5afbdd=_0x58d92a;return devices[_0x5afbdd(0x3ba)](_0x425298=>_0x425298['ip']===_0x194fd1);}async function temporaryAccess2FA(_0x2c5d7a,_0x721d00){const _0x390466=_0x58d92a;let _0x18c2a5=new Date(),_0x1d9013=![];if(lastIpApproval){if(_0x18c2a5-lastIpApproval<0x1388)_0x1d9013=!![];}lastIpApproval=new Date();if(_0x1d9013)return;if(tgBot&&settings[_0x390466(0x322)]){const _0x47b610=uuidRandom();tmpStorage[_0x47b610]={'uuid':_0x2c5d7a,'externalip':_0x721d00};const _0x3e5d4b=Markup[_0x390466(0x218)]([Markup[_0x390466(0x28d)][_0x390466(0x3ab)](_0x390466(0x1e6),_0x390466(0x3a0)+_0x47b610),Markup['button']['callback'](_0x390466(0x2f8),'tempaccess_15_'+_0x47b610),Markup['button'][_0x390466(0x3ab)]('30\x20min',_0x390466(0x2e9)+_0x47b610),Markup['button']['callback']('reject','tempaccess_reject_'+_0x47b610)]);await sendTelegram(settings[_0x390466(0x322)],_0x390466(0x33d)+normalizeIP(_0x721d00)['show']+'\x20?',_0x3e5d4b),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x1766c7=>{const _0x493b08=_0x390466,_0x2ab18e=_0x1766c7[_0x493b08(0x292)][0x1],_0x2cb9a2=_0x1766c7[_0x493b08(0x292)][0x2],{uuid:_0x62f3cd,externalip:_0x3f2881}=tmpStorage[_0x2cb9a2];delete tmpStorage[_0x2cb9a2],_0x1766c7[_0x493b08(0x2ef)](),devices[_0x62f3cd][_0x493b08(0x28a)]={'clientip':_0x3f2881,'timestamp':new Date()[_0x493b08(0x242)](),'expiry':_0x2ab18e},_0x2ab18e!='reject'?(await sendTelegram(_0x1766c7[_0x493b08(0x235)]['id'],_0x493b08(0x2b3)+_0x2ab18e+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x62f3cd)[_0x493b08(0x334)]('status',{'access':{'allow':![],'reason':_0x493b08(0x2d4),'token':null}})):(await sendTelegram(_0x1766c7[_0x493b08(0x235)]['id'],_0x493b08(0x280)),io['to'](_0x62f3cd)[_0x493b08(0x334)](_0x493b08(0x211),{'access':{'allow':![],'reason':_0x493b08(0x26e),'token':null}}));});}}async function loginAccess2FA(_0x4c6a13,_0x1aa351){const _0x27e8a1=_0x58d92a;if(tgBot&&settings[_0x27e8a1(0x322)]){const _0x15a690=uuidRandom();tmpStorage[_0x15a690]={'uuid':_0x4c6a13,'externalip':_0x1aa351};const _0x3cd029=Markup[_0x27e8a1(0x218)]([Markup[_0x27e8a1(0x28d)][_0x27e8a1(0x3ab)]('accept',_0x27e8a1(0x20d)+loginExpiry+'_'+_0x15a690),Markup['button']['callback']('reject',_0x27e8a1(0x2be)+_0x15a690)]);await sendTelegram(settings['telegramChatId'],_0x27e8a1(0x39c)+normalizeIP(_0x1aa351)['show']+'\x20?',_0x3cd029),tgBot[_0x27e8a1(0x1e7)](/login2fa_(.+)_(.+)/,async _0x1d9f37=>{const _0xfa6752=_0x27e8a1,_0x38607b=_0x1d9f37[_0xfa6752(0x292)][0x1],_0x2a8dd8=_0x1d9f37['match'][0x2],{uuid:_0x3a9972,externalip:_0x3c4ca5}=tmpStorage[_0x2a8dd8];delete tmpStorage[_0x2a8dd8],_0x1d9f37['editMessageReplyMarkup'](),devices[_0x3a9972][_0xfa6752(0x1f6)]={'clientip':_0x3c4ca5,'timestamp':new Date()[_0xfa6752(0x242)](),'expiry':_0x38607b},_0x38607b!=_0xfa6752(0x278)?(await sendTelegram(_0x1d9f37[_0xfa6752(0x235)]['id'],'Login\x20accepted',{'parse_mode':_0xfa6752(0x2b4)}),io['to'](_0x3a9972)[_0xfa6752(0x334)](_0xfa6752(0x211),{'access':{'allow':![],'reason':_0xfa6752(0x2d4),'token':null}})):(await sendTelegram(_0x1d9f37[_0xfa6752(0x235)]['id'],_0xfa6752(0x3c8)),io['to'](_0x3a9972)['emit'](_0xfa6752(0x211),{'access':{'allow':![],'reason':_0xfa6752(0x340),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x52435b=_0x58d92a;return dbConfig[_0x52435b(0x283)](_0x52435b(0x33c))[_0x52435b(0x275)]('botID')[_0x52435b(0x25e)]({'status':_0x52435b(0x369)})[_0x52435b(0x2b8)]()||[];}function getDisabledBots(){const _0x232a5d=_0x58d92a;return dbConfig['get'](_0x232a5d(0x33c))[_0x232a5d(0x275)](_0x232a5d(0x35f))[_0x232a5d(0x25e)]({'status':'disabled'})[_0x232a5d(0x2b8)]()||[];}function getBotAttributes(_0x12e3ff){const _0x53fc65=_0x58d92a;let _0x37a901={};const _0x35c755=configpath+_0x53fc65(0x365)+_0x12e3ff+_0x53fc65(0x1ec),_0x45ca1f=fs[_0x53fc65(0x324)](_0x35c755);if(_0x45ca1f){const _0x1fd1b7=fs[_0x53fc65(0x344)](_0x35c755);try{const _0x55c4ea=JSON[_0x53fc65(0x2e0)](_0x1fd1b7),_0x27f7c0=_0x55c4ea?_0x55c4ea[_0x53fc65(0x1dc)][0x0][_0x53fc65(0x3c7)]:![];_0x37a901[_0x53fc65(0x205)]=_0x27f7c0?_0x53fc65(0x373):_0x53fc65(0x26a),_0x37a901[_0x53fc65(0x2d9)]=_0x55c4ea?_0x55c4ea[_0x53fc65(0x1dc)][0x0][_0x53fc65(0x2d9)]:_0x53fc65(0x37f)+_0x12e3ff;}catch(_0x199fa4){_0x37a901[_0x53fc65(0x205)]=_0x53fc65(0x26a),_0x37a901[_0x53fc65(0x2d9)]=_0x53fc65(0x37f)+_0x12e3ff;}}else _0x37a901[_0x53fc65(0x205)]=_0x53fc65(0x26a),_0x37a901[_0x53fc65(0x2d9)]=_0x53fc65(0x37f)+_0x12e3ff;return _0x37a901;}function getBotsWithMode(){const _0x4da3ac=_0x58d92a,_0x392ab1=dbConfig[_0x4da3ac(0x283)]('bots')[_0x4da3ac(0x275)](_0x4da3ac(0x35f))['value']()||[];return _0x392ab1['forEach'](_0x9d6d5b=>{const _0x301615=_0x4da3ac;let _0x1cb205=getBotAttributes(_0x9d6d5b['botID']);_0x9d6d5b['mode']=_0x1cb205[_0x301615(0x205)];}),_0x392ab1;}function getBotExchanges(){const _0x44dbf3=_0x58d92a;let _0x58a147=[];const _0x1bdd64=dbConfig[_0x44dbf3(0x283)](_0x44dbf3(0x33c))[_0x44dbf3(0x275)](_0x44dbf3(0x35f))['value']()||[];_0x1bdd64['forEach'](_0x123194=>{const _0xb011c1=_0x44dbf3;if(_0x123194[_0xb011c1(0x211)]=='enabled'){const _0xafd619=configpath+'bot-'+_0x123194[_0xb011c1(0x35f)]+'-config.json',_0x2e4c83=fs['existsSync'](_0xafd619);let _0x4aa5e7;if(_0x2e4c83){const _0x1b6ad5=fs[_0xb011c1(0x344)](_0xafd619);try{const _0x49c572=JSON[_0xb011c1(0x2e0)](_0x1b6ad5);_0x4aa5e7=_0x49c572?_0x49c572['bot'][0x0]['exchange']:null;}catch(_0x42c9fa){}}if(_0x4aa5e7)_0x58a147[_0xb011c1(0x39a)](_0x4aa5e7);}});const _0x5618cf=[...new Set(_0x58a147)][_0x44dbf3(0x2a2)]();return _0x5618cf;}async function initUser(){const _0x33cef8=_0x58d92a;if(!settings[_0x33cef8(0x251)]){const _0x2742b5=uuidRandom();mixpanel[_0x33cef8(0x29e)](_0x2742b5),updateSetting(_0x33cef8(0x251),_0x2742b5);}}async function initSecure(){const _0x4510f1=_0x58d92a;let _0x3ebe46=getSecure();if(!_0x3ebe46[_0x4510f1(0x2a9)](_0x4510f1(0x2f5))){let _0x18a42b=await generateKeys();_0x3ebe46['publicKey']=_0x18a42b[_0x4510f1(0x2f4)],_0x3ebe46[_0x4510f1(0x37a)]=_0x18a42b[_0x4510f1(0x37a)],_0x3ebe46[_0x4510f1(0x2f5)]=crypto[_0x4510f1(0x2db)](0x20)[_0x4510f1(0x323)](_0x4510f1(0x2f2));;storeSecure(_0x3ebe46);}}function getSettings(){const _0x3b5fba=_0x58d92a;return dbSettings[_0x3b5fba(0x283)](_0x3b5fba(0x1e4))[_0x3b5fba(0x2b8)]()||{};}function getSecure(){const _0x1fb99d=_0x58d92a;return dbSecure[_0x1fb99d(0x283)](_0x1fb99d(0x1e1))['value']()||{};}function getBlacklist(){const _0x808bfd=_0x58d92a;return dbSecure['get']('blacklist')[_0x808bfd(0x2b8)]()||[];}function broadcastToBots(_0x1c8672,_0x5b70ce){const _0x171dae=_0x58d92a;config[_0x171dae(0x37c)](_0x66374a=>{const _0x42e9da=_0x171dae;if(_0x66374a[_0x42e9da(0x211)]==_0x42e9da(0x369)&&_0x66374a[_0x42e9da(0x34b)]=='running'||_0x66374a['status']==_0x42e9da(0x330)&&_0x66374a[_0x42e9da(0x34b)]==_0x42e9da(0x336)){if(pid[_0x66374a[_0x42e9da(0x35f)]])pid[_0x66374a['botID']][_0x42e9da(0x358)]({[_0x1c8672]:_0x5b70ce});}});}function storeSettings(_0x4da9a9,_0x53e32f=![]){const _0x1217c1=_0x58d92a;_0x4da9a9={...settings,..._0x4da9a9};if(_0x53e32f&&_0x4da9a9[_0x1217c1(0x394)]!=_0x1217c1(0x2ca)&&_0x4da9a9[_0x1217c1(0x394)]!=_0x1217c1(0x272)&&_0x4da9a9[_0x1217c1(0x394)]!=''){const _0x15c2a7=crypt[_0x1217c1(0x3b6)](secure['privateKey'],_0x4da9a9['bbPassword'])[_0x1217c1(0x312)][_0x1217c1(0x267)]('@')[0x0],_0x3900a6=bcrypt[_0x1217c1(0x3a8)](_0x15c2a7,saltRounds);_0x4da9a9={..._0x4da9a9,'bbPassword':_0x3900a6};}if(_0x53e32f&&_0x4da9a9[_0x1217c1(0x1f7)]!='************'&&_0x4da9a9[_0x1217c1(0x1f7)]!=_0x1217c1(0x272)&&_0x4da9a9[_0x1217c1(0x1f7)]!=''){const _0x548a03=crypt['decrypt'](secure[_0x1217c1(0x37a)],_0x4da9a9['telegramToken'])[_0x1217c1(0x312)]['split']('@')[0x0];_0x4da9a9={..._0x4da9a9,'telegramToken':_0x548a03};}const _0x5248bb=_0x4da9a9[_0x1217c1(0x1f7)]!=_0x1217c1(0x2ca)&&_0x4da9a9[_0x1217c1(0x1f7)]!=settings[_0x1217c1(0x1f7)]||_0x4da9a9[_0x1217c1(0x3d8)]!=settings[_0x1217c1(0x3d8)],_0x15ff9c=_0x4da9a9[_0x1217c1(0x1f7)]==''||_0x4da9a9['telegramUsername']=='';_0x5248bb&&(_0x4da9a9[_0x1217c1(0x322)]=null,_0x4da9a9[_0x1217c1(0x331)]=_0x1217c1(0x3b8));for(const [_0xf791a6,_0x5ae5a5]of Object['entries'](_0x4da9a9)){if(_0xf791a6=='telegramToken'&&_0x5ae5a5=='************'){_0x4da9a9['telegramToken']=settings[_0x1217c1(0x1f7)];continue;};if(_0xf791a6==_0x1217c1(0x394)&&_0x5ae5a5==_0x1217c1(0x2ca)){_0x4da9a9[_0x1217c1(0x394)]=settings['bbPassword'];continue;};dbSettings[_0x1217c1(0x3b0)]('settings.'+_0xf791a6,_0x5ae5a5)[_0x1217c1(0x281)]();}settings=_0x4da9a9,io['to'](_0x1217c1(0x2a6))[_0x1217c1(0x334)]('settings',cleanSettings()),broadcastToBots(_0x1217c1(0x200),settings[_0x1217c1(0x200)]),broadcastToBots(_0x1217c1(0x24a),settings['onepagemode']);if(_0x5248bb&&!_0x15ff9c)initTelegram();if(_0x5248bb&&_0x15ff9c)disableTelegram();getAllClients()[_0x1217c1(0x37c)](_0x403e59=>{const _0x3f0feb=_0x1217c1;getSocket(_0x403e59['id'])[_0x3f0feb(0x334)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x1b0026,_0x156cf4){const _0x3368be=_0x58d92a;dbSettings[_0x3368be(0x3b0)](_0x3368be(0x25c)+_0x1b0026,_0x156cf4)[_0x3368be(0x281)](),settings=getSettings(),io['to'](_0x3368be(0x2a6))[_0x3368be(0x334)](_0x3368be(0x1e4),cleanSettings());}function storeSecure(_0x3d393c){const _0x4cf228=_0x58d92a;dbSecure[_0x4cf228(0x283)](_0x4cf228(0x1e1))[_0x4cf228(0x39a)](_0x3d393c)[_0x4cf228(0x281)](),secure=_0x3d393c;}function addBlacklist(_0x4fb376){const _0x5c79d2=_0x58d92a;cleanBlacklist();let _0x2d0d13;devices[_0x4fb376][_0x5c79d2(0x28a)]?_0x2d0d13=Math[_0x5c79d2(0x224)](devices[_0x4fb376][_0x5c79d2(0x28a)][_0x5c79d2(0x2cc)],loginExpiry):_0x2d0d13=loginExpiry,dbSecure[_0x5c79d2(0x283)](_0x5c79d2(0x29c))[_0x5c79d2(0x39a)]({'expiry':new Date()[_0x5c79d2(0x242)]()+_0x2d0d13*0x3c*0x3e8,'token':devices[_0x4fb376][_0x5c79d2(0x268)]['token']})[_0x5c79d2(0x281)](),blacklist=dbSecure[_0x5c79d2(0x283)](_0x5c79d2(0x29c))[_0x5c79d2(0x2b8)]();}function cleanBlacklist(){const _0x1fad01=_0x58d92a;let _0x3e0408=dbSecure['get']('blacklist')[_0x1fad01(0x33f)]()[_0x1fad01(0x2b8)](),_0x375cfa=new Date()[_0x1fad01(0x242)]();_0x3e0408['forEach'](_0x230fe2=>{const _0x3d528e=_0x1fad01;_0x230fe2['expiry']<_0x375cfa&&dbSecure[_0x3d528e(0x283)]('blacklist')[_0x3d528e(0x332)]({'expiry':_0x230fe2['expiry']})[_0x3d528e(0x281)]();});}function initStates(){const _0x34caef=_0x58d92a;let _0x374333=getConfiguration();_0x374333[_0x34caef(0x37c)](_0x5b743e=>{const _0x4b824e=_0x34caef;_0x5b743e['live']=_0x4b824e(0x328);}),storeConfiguration(_0x374333);}function onKeys(){const _0x57db3a=new RSA();return new Promise(_0x3c17ed=>{const _0x35fc4a=_0x3b94;_0x57db3a[_0x35fc4a(0x2a1)]()['then'](_0x34ee93=>{_0x3c17ed(_0x34ee93);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1b53f3=_0x58d92a;let _0x54b7e2=getSettings(),_0xd86497=![];!_0x54b7e2[_0x1b53f3(0x2a9)]('lastmsgtelegram')&&(_0x54b7e2['lastmsgtelegram']=0x0,_0xd86497=!![]);!_0x54b7e2['hasOwnProperty'](_0x1b53f3(0x3a6))&&(_0x54b7e2['lastmsgemitted']=0x0,_0xd86497=!![]);!_0x54b7e2[_0x1b53f3(0x2a9)]('latestversion')&&(_0x54b7e2[_0x1b53f3(0x35c)]=_0x1b53f3(0x35a),_0xd86497=!![]);!_0x54b7e2[_0x1b53f3(0x2a9)](_0x1b53f3(0x24a))&&(_0x54b7e2[_0x1b53f3(0x24a)]=![],_0xd86497=!![]);if(_0xd86497)storeSettings(_0x54b7e2);try{fs[_0x1b53f3(0x380)](configbackuppath,{'withFileTypes':!![]})[_0x1b53f3(0x37c)](_0x5268f0=>{const _0x5aad27=_0x1b53f3;if(!_0x5268f0[_0x5aad27(0x2fa)]()){if(!_0x5268f0[_0x5aad27(0x355)][_0x5aad27(0x320)](_0x5aad27(0x2d8)))fs[_0x5aad27(0x1f9)](configbackuppath+_0x5268f0['name']);}else fs['rmSync'](configbackuppath+_0x5268f0['name'],{'recursive':!![]});});}catch(_0x1535c5){logger[_0x1b53f3(0x359)](_0x1b53f3(0x368),_0x1535c5);}}function storeConfiguration(_0x348695){const _0x590d26=_0x58d92a;dbConfig[_0x590d26(0x283)](_0x590d26(0x33c))[_0x590d26(0x332)]()['write'](),dbConfig['get'](_0x590d26(0x33c))[_0x590d26(0x39a)](..._0x348695)[_0x590d26(0x281)](),config=_0x348695;}async function resetPassword(){const _0x28cf1c=_0x58d92a;if(tgBot&&settings[_0x28cf1c(0x322)]){const _0x8e8d5b=Markup[_0x28cf1c(0x218)]([Markup['button'][_0x28cf1c(0x3ab)](_0x28cf1c(0x1db),_0x28cf1c(0x2a0)),Markup[_0x28cf1c(0x28d)][_0x28cf1c(0x3ab)]('no',_0x28cf1c(0x34d))]);await sendTelegram(settings['telegramChatId'],_0x28cf1c(0x2e8),_0x8e8d5b),tgBot[_0x28cf1c(0x1e7)](/resetpw_(.+)/,async _0xdfcee3=>{const _0x4ba5fa=_0x28cf1c,_0x473496=_0xdfcee3[_0x4ba5fa(0x292)][0x1];_0xdfcee3[_0x4ba5fa(0x2ef)]();if(_0x473496!='no'){const _0xdcb0d2=0xf,_0x4655b1=_0x4ba5fa(0x1dd),_0x2d65d3=Array['from'](crypto[_0x4ba5fa(0x264)](new Uint32Array(_0xdcb0d2)))['map'](_0x3e2905=>_0x4655b1[_0x3e2905%_0x4655b1[_0x4ba5fa(0x353)]])[_0x4ba5fa(0x345)](''),_0x4bf980=bcrypt[_0x4ba5fa(0x3a8)](_0x2d65d3,saltRounds);storeSettings({'bbPassword':_0x4bf980}),await sendTelegram(_0xdfcee3['chat']['id'],_0x4ba5fa(0x382)+_0x2d65d3,{'parse_mode':_0x4ba5fa(0x2b4)});}else await sendTelegram(_0xdfcee3[_0x4ba5fa(0x235)]['id'],_0x4ba5fa(0x326));});}}async function confirmRestore(_0x3aa5a5,_0x3f68c2){const _0xcdf354=_0x58d92a;io['to'](_0xcdf354(0x2a6))[_0xcdf354(0x334)]('notification',_0xcdf354(0x34e),_0xcdf354(0x2c4));if(tgBot&&settings[_0xcdf354(0x322)]){const _0x32a02a=uuidRandom();tmpStorage[_0x32a02a]={'path':_0x3aa5a5,'filename':_0x3f68c2};const _0x8599b1=Markup[_0xcdf354(0x218)]([Markup['button'][_0xcdf354(0x3ab)](_0xcdf354(0x1db),_0xcdf354(0x2a5)+_0x32a02a),Markup[_0xcdf354(0x28d)][_0xcdf354(0x3ab)]('no',_0xcdf354(0x216)+_0x32a02a)]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x8599b1),tgBot[_0xcdf354(0x1e7)](/restore_(.+)_(.+)/,async _0x371772=>{const _0x6d54f0=_0xcdf354,_0x1b9b2b=_0x371772[_0x6d54f0(0x292)][0x1],_0x564a8b=_0x371772['match'][0x2],{path:_0x588a96,filename:_0xbb3e67}=tmpStorage[_0x564a8b];delete tmpStorage[_0x564a8b],_0x371772[_0x6d54f0(0x2ef)](),_0x1b9b2b==_0x6d54f0(0x1db)?(logger[_0x6d54f0(0x359)](_0x6d54f0(0x3af)),await sendTelegram(_0x371772[_0x6d54f0(0x235)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x6d54f0(0x2b4)}),unzipFile(_0x588a96,_0xbb3e67)):(logger['debug'](_0x6d54f0(0x244)),await sendTelegram(_0x371772[_0x6d54f0(0x235)]['id'],_0x6d54f0(0x244)));});}}function getServerTime(){const _0x8bbbca=_0x58d92a,_0x4c2687=new Date();return _0x4c2687['getFullYear']()+'/'+(_0x4c2687[_0x8bbbca(0x2b5)]()+0x1)[_0x8bbbca(0x323)]()['padStart'](0x2,'0')+'/'+_0x4c2687[_0x8bbbca(0x3ac)]()[_0x8bbbca(0x323)]()[_0x8bbbca(0x260)](0x2,'0')+'\x20'+_0x4c2687[_0x8bbbca(0x25a)]()[_0x8bbbca(0x323)]()[_0x8bbbca(0x260)](0x2,'0')+':'+_0x4c2687[_0x8bbbca(0x212)]()[_0x8bbbca(0x323)]()[_0x8bbbca(0x260)](0x2,'0')+':'+_0x4c2687[_0x8bbbca(0x2d5)]()['toString']()[_0x8bbbca(0x260)](0x2,'0');}function getTimeStamp(){const _0x52bc01=_0x58d92a,_0x389f48=shiftedTime();return _0x389f48[_0x52bc01(0x1e0)]()+'/'+(_0x389f48['getMonth']()+0x1)['toString']()[_0x52bc01(0x260)](0x2,'0')+'/'+_0x389f48[_0x52bc01(0x3ac)]()[_0x52bc01(0x323)]()[_0x52bc01(0x260)](0x2,'0')+'\x20'+_0x389f48[_0x52bc01(0x25a)]()['toString']()[_0x52bc01(0x260)](0x2,'0')+':'+_0x389f48[_0x52bc01(0x212)]()[_0x52bc01(0x323)]()[_0x52bc01(0x260)](0x2,'0')+':'+_0x389f48[_0x52bc01(0x2d5)]()['toString']()[_0x52bc01(0x260)](0x2,'0');}function getCleanTimeStamp(){const _0x5bc52c=_0x58d92a,_0x393cc7=shiftedTime();return _0x393cc7[_0x5bc52c(0x1e0)]()+(_0x393cc7[_0x5bc52c(0x2b5)]()+0x1)[_0x5bc52c(0x323)]()[_0x5bc52c(0x260)](0x2,'0')+_0x393cc7[_0x5bc52c(0x3ac)]()[_0x5bc52c(0x323)]()['padStart'](0x2,'0')+'-'+_0x393cc7[_0x5bc52c(0x25a)]()[_0x5bc52c(0x323)]()[_0x5bc52c(0x260)](0x2,'0')+_0x393cc7[_0x5bc52c(0x212)]()[_0x5bc52c(0x323)]()[_0x5bc52c(0x260)](0x2,'0')+_0x393cc7[_0x5bc52c(0x2d5)]()['toString']()[_0x5bc52c(0x260)](0x2,'0');}function shiftedTime(){const _0x2343b5=_0x58d92a,_0x753531=new Date();let _0x34c4a4=_0x753531;if(settings['timeshift']&&settings[_0x2343b5(0x200)]!==0x0)_0x34c4a4=fns[_0x2343b5(0x206)](_0x753531,{'hours':settings['timeshift']});return _0x34c4a4;}function startScheduler(){const _0x4595dc=_0x58d92a,_0xb3c2dc=new Date()[_0x4595dc(0x30d)](),_0x4c7353=shiftedTime()[_0x4595dc(0x25a)]();_0x4c7353==0x4&&backupConfigFiles();_0x4c7353==0x0&&rotateLogFiles();_0xb3c2dc%0x6==0x0&&triggerAnalytics();_0xb3c2dc%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x56d581){const _0x226825=_0x58d92a;logger[_0x226825(0x359)]('Restore\x20backup\x20file\x20'+_0x56d581);const _0x1b7db4=getBotsWithMode();_0x1b7db4[_0x226825(0x353)]>0x0?confirmRestore(configbackuppath,_0x56d581):unzipFile(configbackuppath,_0x56d581);}async function getBackupFiles(_0x5ee379=null){const _0x2ed08a=_0x58d92a;let _0xc52d9d=[],_0x199f37=fs[_0x2ed08a(0x380)](configbackuppath,{'withFileTypes':!![]});_0x199f37[_0x2ed08a(0x2a2)]((_0x4a15ee,_0x413604)=>_0x4a15ee['name']<_0x413604[_0x2ed08a(0x355)]?0x1:_0x413604[_0x2ed08a(0x355)]<_0x4a15ee[_0x2ed08a(0x355)]?-0x1:0x0),_0x199f37[_0x2ed08a(0x37c)](_0x1aa363=>{const _0x5e57b7=_0x2ed08a;if(!_0x1aa363[_0x5e57b7(0x2fa)]()&&_0x1aa363['name'][_0x5e57b7(0x320)](_0x5e57b7(0x2d8))&&_0x1aa363['name'][_0x5e57b7(0x388)](_0x5e57b7(0x3d6))){const _0xb21358=formatDate(fs['statSync'](configbackuppath+_0x1aa363[_0x5e57b7(0x355)])[_0x5e57b7(0x2ac)]);_0xc52d9d[_0x5e57b7(0x39a)]({'name':_0x1aa363[_0x5e57b7(0x355)],'mtime':_0xb21358});}});if(_0x5ee379)io['to'](_0x5ee379)[_0x2ed08a(0x334)](_0x2ed08a(0x2e3),_0xc52d9d);else return _0xc52d9d;}async function backupConfigFiles(){const _0x430557=_0x58d92a;await zipFiles(_0x430557(0x262));const _0x53ae8e=getCleanTimeStamp();fs[_0x430557(0x29f)](zippath+_0x430557(0x2b9),configbackuppath+(_0x430557(0x2d8)+_0x53ae8e+_0x430557(0x3d6)));let _0x5d9f89=fs[_0x430557(0x380)](configbackuppath,{'withFileTypes':!![]});_0x5d9f89[_0x430557(0x2a2)]((_0x3d7b77,_0x2d9867)=>_0x3d7b77[_0x430557(0x355)]<_0x2d9867['name']?0x1:_0x2d9867[_0x430557(0x355)]<_0x3d7b77[_0x430557(0x355)]?-0x1:0x0),_0x5d9f89[_0x430557(0x353)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x5d9f89[_0x5d9f89['length']-0x1][_0x430557(0x355)]);}function rotateLogFiles(){const _0xbd4167=_0x58d92a,_0x4a6816=fs[_0xbd4167(0x3bd)](logspath+_0xbd4167(0x3b1)),_0x193d2e=_0x4a6816[_0xbd4167(0x2ea)]/0x400;if(_0x193d2e>0x64){let _0x59682a=fs[_0xbd4167(0x380)](logspath,{'withFileTypes':!![]});_0x59682a[_0xbd4167(0x2a2)]((_0x5d5438,_0x4f2e48)=>_0x5d5438['name']<_0x4f2e48['name']?0x1:_0x4f2e48[_0xbd4167(0x355)]<_0x5d5438[_0xbd4167(0x355)]?-0x1:0x0),_0x59682a[_0xbd4167(0x37c)](_0x1874dc=>{const _0x4eba77=_0xbd4167;if(_0x1874dc[_0x4eba77(0x355)]==_0x4eba77(0x356))fs[_0x4eba77(0x29f)](logspath+_0x1874dc['name'],logspath+_0x4eba77(0x28f));if(_0x1874dc[_0x4eba77(0x355)]==_0x4eba77(0x3c5))fs[_0x4eba77(0x29f)](logspath+_0x1874dc[_0x4eba77(0x355)],logspath+_0x4eba77(0x356));_0x1874dc[_0x4eba77(0x355)]==_0x4eba77(0x3b1)&&(fs['copyFileSync'](logspath+_0x1874dc[_0x4eba77(0x355)],logspath+_0x4eba77(0x3c5)),fs[_0x4eba77(0x22c)](logspath+_0x1874dc[_0x4eba77(0x355)],''));});}}async function zipFiles(_0x22b782){const _0x187805=_0x58d92a;let _0x2692a6;if(_0x22b782==_0x187805(0x2d7))_0x2692a6=logspath;if(_0x22b782==_0x187805(0x2cf))_0x2692a6=configpath;if(_0x22b782==_0x187805(0x262))_0x2692a6=configpath;let _0x19ebf5=fs['readdirSync'](_0x2692a6,{'withFileTypes':!![]});const _0x4baefc=new require(_0x187805(0x30e))();_0x19ebf5[_0x187805(0x37c)](_0x2c9b0a=>{const _0x2bdecb=_0x187805;if(!_0x2c9b0a[_0x2bdecb(0x2fa)]()){let _0x1b665b=fs[_0x2bdecb(0x344)](_0x2692a6+_0x2c9b0a['name']);if(_0x22b782==_0x2bdecb(0x2cf)){const _0x506011=/^bot-[0-9]{3}-config.json$/,_0x368ad7=_0x506011[_0x2bdecb(0x310)](_0x2c9b0a[_0x2bdecb(0x355)]);if(_0x368ad7){const _0x2fd0bd=JSON[_0x2bdecb(0x2e0)](_0x1b665b);if(_0x2fd0bd['bot'][0x0]){_0x2fd0bd[_0x2bdecb(0x1dc)][0x0][_0x2bdecb(0x2e7)]='***',_0x2fd0bd['bot'][0x0][_0x2bdecb(0x398)]='***';if(_0x2fd0bd[_0x2bdecb(0x1dc)][0x0][_0x2bdecb(0x2c3)])_0x2fd0bd['bot'][0x0][_0x2bdecb(0x2c3)]='***';}_0x1b665b=JSON[_0x2bdecb(0x34a)](_0x2fd0bd,null,0x2);}if(_0x2c9b0a['name']==_0x2bdecb(0x1e2)){const _0x3f4319=JSON[_0x2bdecb(0x2e0)](_0x1b665b);if(_0x3f4319['settings']['loginRequired'])_0x3f4319[_0x2bdecb(0x1e4)]['loginRequired']=![];if(_0x3f4319[_0x2bdecb(0x1e4)][_0x2bdecb(0x394)])_0x3f4319[_0x2bdecb(0x1e4)][_0x2bdecb(0x394)]=_0x2bdecb(0x272);if(_0x3f4319[_0x2bdecb(0x1e4)][_0x2bdecb(0x1f7)])_0x3f4319['settings'][_0x2bdecb(0x1f7)]=_0x2bdecb(0x272);if(_0x3f4319[_0x2bdecb(0x1e4)]['telegramChatId'])_0x3f4319[_0x2bdecb(0x1e4)][_0x2bdecb(0x322)]=null;_0x1b665b=JSON[_0x2bdecb(0x34a)](_0x3f4319,null,0x2);}if(_0x2c9b0a[_0x2bdecb(0x355)]!=_0x2bdecb(0x29d))_0x4baefc[_0x2bdecb(0x378)](_0x2c9b0a[_0x2bdecb(0x355)],_0x1b665b);}else _0x4baefc[_0x2bdecb(0x378)](_0x2c9b0a[_0x2bdecb(0x355)],_0x1b665b);}});const _0xe44b75=_0x4baefc[_0x187805(0x3b3)]({'base64':![],'compression':_0x187805(0x36e)});fs[_0x187805(0x22c)](zippath+(_0x22b782+_0x187805(0x3d6)),_0xe44b75,_0x187805(0x38c));}async function unzipFile(_0x535a88,_0x4f5b85){const _0x3a7214=_0x58d92a;fs[_0x3a7214(0x380)](configpath,{'withFileTypes':!![]})['forEach'](_0x15a77a=>{const _0x340992=_0x3a7214;if(!_0x15a77a[_0x340992(0x2fa)]())fs['rmSync'](configpath+_0x15a77a[_0x340992(0x355)]);});const _0x10727c=fs[_0x3a7214(0x344)](_0x535a88+_0x4f5b85,'binary'),_0x4403d8=new require(_0x3a7214(0x30e))(_0x10727c,{'base64':![],'checkCRC32':!![]});Object[_0x3a7214(0x379)](_0x4403d8[_0x3a7214(0x3d4)])[_0x3a7214(0x37c)](_0x4357e2=>{const _0x33f054=_0x3a7214,_0x240aab=_0x4403d8[_0x33f054(0x3d4)][_0x4357e2];fs[_0x33f054(0x22c)](configpath+_0x240aab['name'],_0x240aab['_data']);}),fs[_0x3a7214(0x380)](temppath,{'withFileTypes':!![]})['forEach'](_0x49c6bd=>{const _0x37b008=_0x3a7214;if(!_0x49c6bd[_0x37b008(0x2fa)]())fs[_0x37b008(0x2bd)](temppath+_0x49c6bd[_0x37b008(0x355)]);}),logger[_0x3a7214(0x359)](_0x3a7214(0x392)),process[_0x3a7214(0x358)]({'restore':!![]},_0x37f177=>{});}async function getPublicIp(){const _0x337991=_0x58d92a;try{const _0x451912=await axios[_0x337991(0x283)](_0x337991(0x2f3));publicip=_0x451912[_0x337991(0x293)]['ip'];}catch(_0x528ead){}}async function triggerAnalytics(){const _0x2fe0cf=_0x58d92a;if(!publicip)await getPublicIp();const _0x3a21a2=getBotsWithMode();let _0x1e06aa=0x0;_0x3a21a2['forEach'](_0x206c78=>{const _0x236b06=_0x3b94;if(_0x206c78[_0x236b06(0x211)]==='enabled')_0x1e06aa++;});const _0x44bda7=getBotExchanges();mixpanel[_0x2fe0cf(0x3c4)](_0x2fe0cf(0x2a7),{'distinct_id':settings[_0x2fe0cf(0x251)],'ip':publicip,'version':serverversion,'numbots':_0x3a21a2[_0x2fe0cf(0x353)],'numbotsenabled':_0x1e06aa,'exchanges':_0x44bda7,'environment':environment});}async function getMessages(){const _0x4a2a45=_0x58d92a,_0x12bea3=_0x4a2a45(0x282),_0x44acbc=new GraphQLClient(_0x12bea3),_0xd2bd15={'authorization':_0x4a2a45(0x2f7)},_0x12c90f=serverversion['split']('.'),_0x49c5fa=_0x12c90f[0x0]+'.'+_0x12c90f[0x1],_0x5615b4=Math[_0x4a2a45(0x399)](settings[_0x4a2a45(0x303)],settings['lastmsgemitted']),_0x1ceec1={'last':parseInt(_0x5615b4),'bbm':_0x49c5fa},_0x176121=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x168ff9;try{_0x168ff9=await _0x44acbc[_0x4a2a45(0x2ff)](_0x176121,_0x1ceec1,_0xd2bd15);}catch(_0x4a7ae0){}if(_0x168ff9&&_0x168ff9[_0x4a2a45(0x2d6)]){let _0x1740e4=settings[_0x4a2a45(0x303)];newMessages=[];for(const _0x48ad94 of _0x168ff9[_0x4a2a45(0x2d6)]){newMessages['push'](_0x48ad94);let _0x3319ef=![];_0x48ad94[_0x4a2a45(0x20b)]&&(updateSetting('latestversion',_0x48ad94[_0x4a2a45(0x20b)]),_0x3319ef=isNewerVersion(serverversion,_0x48ad94['bbvNew'])||serverversion==_0x48ad94[_0x4a2a45(0x20b)]);if(!_0x3319ef&&_0x48ad94[_0x4a2a45(0x2dd)]>_0x1740e4){if(_0x48ad94[_0x4a2a45(0x219)]==='any'||serverversion[_0x4a2a45(0x320)](_0x48ad94[_0x4a2a45(0x219)])){let _0x21abca=''+_0x48ad94['title']+'\x0a\x0a'+_0x48ad94[_0x4a2a45(0x312)];const _0x7b2aa4=await sendTelegramMsg(toTelegramMarkdown(_0x21abca),_0x4a2a45(0x321));if(_0x7b2aa4)_0x1740e4=_0x48ad94['number'];}}}updateAvailable=isNewerVersion(settings[_0x4a2a45(0x35c)],serverversion),updateSetting(_0x4a2a45(0x303),_0x1740e4),emitMessages();}}function emitMessages(){const _0x21031c=_0x58d92a,_0x4dda9b=settings[_0x21031c(0x3a6)];let _0x1b92a2=[];newMessages['forEach'](_0x47c281=>{const _0x595931=_0x21031c;_0x47c281[_0x595931(0x2dd)]>_0x4dda9b&&_0x1b92a2['push'](_0x47c281);}),_0x1b92a2['length']>0x0&&getAllClients()[_0x21031c(0x37c)](_0x15bcfe=>{const _0xc3f61f=_0x21031c;getSocket(_0x15bcfe['id'])['emit'](_0xc3f61f(0x312),_0x1b92a2);});}function confirmMessage(_0x42d310){const _0x4c34f8=_0x58d92a;updateSetting(_0x4c34f8(0x3a6),Number(_0x42d310));}function isNewerVersion(_0x564f89,_0xaf2118){const _0x595240=_0x58d92a,_0x4e8c09=_0xaf2118[_0x595240(0x267)]('.'),_0x51b0e6=_0x564f89['split']('.');for(var _0x2b496d=0x0;_0x2b496d<_0x51b0e6[_0x595240(0x353)];_0x2b496d++){const _0x428d34=~~_0x51b0e6[_0x2b496d],_0x27e7cc=~~_0x4e8c09[_0x2b496d];if(_0x428d34>_0x27e7cc)return!![];if(_0x428d34<_0x27e7cc)return![];}return![];}function toTelegramMarkdown(_0x48da2e){const _0x282aac=_0x58d92a,_0xb1c097=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x263814=/\*{2}(.+?)\*{2}/gim;return _0x48da2e=_0x48da2e['replace'](_0xb1c097,_0x282aac(0x3c0))[_0x282aac(0x329)](_0x263814,_0x282aac(0x32b)),_0x48da2e;}async function validateConfigFile(){const _0x560239=_0x58d92a,_0x585e1a=dbConfig[_0x560239(0x283)](_0x560239(0x33c))['sortBy']('botID')[_0x560239(0x2b8)]()||[];if(_0x585e1a[_0x560239(0x353)]==0x0){let _0x5d54e1=0x0,_0x11e113=[];const _0xd08f86=/^bot-([0-9]{3})-config.json$/,_0x58b438=fs[_0x560239(0x380)](configpath);_0x58b438['forEach'](_0x2a15e2=>{const _0x48a062=_0x560239,_0x586ef2=_0xd08f86[_0x48a062(0x248)](_0x2a15e2);if(_0x586ef2){const _0x40037e=_0x586ef2[0x1];let _0x1286b0=getBotAttributes(_0x40037e);_0x11e113['push']({'botID':_0x40037e,'botname':_0x1286b0[_0x48a062(0x2d9)],'status':_0x48a062(0x362),'live':_0x48a062(0x328)}),_0x5d54e1++;}}),_0x5d54e1!=0x0&&(dbConfig[_0x560239(0x283)]('bots')[_0x560239(0x2ae)](_0x11e113)[_0x560239(0x281)](),config=_0x11e113,restoredConfigFile=_0x5d54e1);}}async function restoreConfigNotify(_0x3772ec){const _0x2c212a=_0x58d92a;let _0xd54f99;if(restoredConfigFile==0x1)_0xd54f99='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0xd54f99=_0x2c212a(0x3cc);if(_0x3772ec)io['to'](_0x2c212a(0x2a6))[_0x2c212a(0x334)](_0x2c212a(0x3d0),_0xd54f99);else{logger[_0x2c212a(0x21a)](_0x2c212a(0x237)),logger[_0x2c212a(0x21a)](_0xd54f99),logger[_0x2c212a(0x21a)]('-----------------------------------------------------------------------------------'),logger[_0x2c212a(0x21a)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x2c212a(0x331)]!='orders')await sendTelegram(settings['telegramChatId'],_0x2c212a(0x304)+_0xd54f99);}}function validateCredentials(_0xff5ae6,_0xcdb37b){const _0x338f39=_0x58d92a;if(_0xff5ae6[_0x338f39(0x2e5)]==settings[_0x338f39(0x21c)]&&bcrypt[_0x338f39(0x203)](_0xff5ae6[_0x338f39(0x1eb)],settings[_0x338f39(0x394)])){if(settings[_0x338f39(0x223)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x508943=generateLoginToken(_0xcdb37b);return{'allow':!![],'reason':_0x338f39(0x352),'token':_0x508943};}}else return{'allow':![],'reason':_0x338f39(0x296),'token':null};}function refreshToken(_0x4b58b3){const _0x5367cc=_0x58d92a,_0x30fae4=generateLoginToken(_0x4b58b3);return{'allow':!![],'reason':_0x5367cc(0x352),'token':_0x30fae4};}function validateAccess(_0x4bbb16,_0x40881a,_0x5cf368){const _0x5020b3=_0x58d92a,_0x3f1a52=_0x5cf368?_0x5cf368:devices[_0x40881a]['ip'];let _0x2ddafd;const _0x3263e2=_0x198288=>{const _0x2a8252=_0x3b94;if(settings[_0x2a8252(0x351)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x40881a)){const _0x148cc6=generateLoginToken(_0x40881a);return{'allow':!![],'reason':_0x2a8252(0x32f),'token':_0x148cc6};}else return{'allow':![],'reason':_0x2a8252(0x31b),'token':null};}else return _0x2ddafd=validToken(_0x198288,_0x40881a),_0x2ddafd[_0x2a8252(0x2a9)](_0x2a8252(0x2c4))?{'allow':!![],'reason':_0x2a8252(0x32e),'token':_0x198288}:{'allow':![],'reason':_0x2a8252(0x31b),'token':null};}else return{'allow':!![],'reason':_0x2a8252(0x228),'token':null};};if(settings[_0x5020b3(0x349)]){let _0x4c0cbf=[...settings['whitelist'],_0x5020b3(0x249),_0x5020b3(0x390),_0x5020b3(0x3d1)];if(_0x4c0cbf[_0x5020b3(0x2f0)](_0x3f1a52))return _0x3263e2(_0x4bbb16);else{_0x2ddafd=validToken(_0x4bbb16,_0x40881a);if(_0x2ddafd['hasOwnProperty'](_0x5020b3(0x2c4)))return _0x3263e2(_0x4bbb16);else{if(telegramIpApproved(_0x40881a)){const _0x5928ab=generateToken(_0x40881a);return _0x2ddafd=_0x3263e2(_0x4bbb16),_0x2ddafd[_0x5020b3(0x31c)]?{'allow':!![],'reason':_0x5020b3(0x38b),'token':_0x5928ab}:_0x2ddafd;}else return settings[_0x5020b3(0x3b7)]?{'allow':![],'reason':_0x5020b3(0x286),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x3263e2(_0x4bbb16);}function timelyDecrypt(_0x103a66,_0x189426=!![]){const _0x17152d=_0x58d92a;if(_0x103a66)try{const _0xfaf271=crypt[_0x17152d(0x3b6)](secure[_0x17152d(0x37a)],_0x103a66)[_0x17152d(0x312)],_0x25a136=_0xfaf271['split']('@')[0x0],_0x59b41d=_0xfaf271[_0x17152d(0x267)]('@')[0x1],_0x261df1=new Date()[_0x17152d(0x242)]();if(_0x189426){if(_0x261df1-_0x59b41d<maxSecretAge*0x3e8)return _0x25a136;else return![];}else return _0x25a136;}catch(_0x10812a){return![];}else return![];}function _0x2a05(){const _0x51b177=['apply','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','15\x20min','start','isDirectory','restore-backup-file','\x1b[36m','Unauthorized\x20attempt\x20to\x20update\x20settings','\x20(1)','request','pidExpireLogin','order','build','lastmsgtelegram','Bot\x20Mgr\x20>\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','1993688wXRneL','exit','SIGINT','emitHistory','reason','Unauthorized\x20attempt\x20to\x20get\x20events','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','getUTCHours','node-zip','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','test','temporary\x20access\x20timeout','message','Notifications\x20enabled','node','reinstall','Idling\x20(','backup/','temp/','sendPortfolioTelegram','alerts','login\x20required','allow','http','\x20|\x20user:\x20...','headers','startsWith','Markdown','telegramChatId','toString','existsSync','command','Password\x20reset\x20rejected','Your\x20installation\x20is\x20already\x20up\x20to\x20date','stopped','replace','uncaughtException','*$1*','sendMessage','logs/','login\x20token\x20valid','2FA\x20login\x20token\x20generated','new','telegramEvents','remove','defaults','emit','stop','running','reinstall_no','portfolio','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','update_yes','bots','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Enabled\x20Bot\x20','cloneDeep','2FA\x20login\x20rejected','constructor','environment','get-logs','readFileSync','join','Network\x20Interfaces:','zip/','versions','whitelistEnabled','stringify','live','\x1b[35m','resetpw_no','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','download','init','loginRequired','login\x20token\x20generated','length','post','name','output-002.log','family','send','debug','0.0.0','removeAllListeners','latestversion','Starting\x20(',')\x20\x20\x20|\x20Bot\x20','botID','bot.js','util','disabled','Unauthorized\x20attempt\x20to\x20get\x20messages','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','bot-','update_no','type','Error\x20removing\x20old\x20backup\x20files:','enabled','update-bb','#RES#\x20if\x20running\x20locally\x0a','telegram','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','DEFLATE','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','/on\x20-\x20start\x20bot(s)\x0a','login','connection','auto','isValid','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','jsonwebtoken','storeHeadless','file','keys','privateKey','Backup\x20file\x20uploaded','forEach','\x20mode','config_orders','Bot\x20','readdirSync','staging','Password\x20has\x20been\x20reset\x20to:\x20','confirm-message','1270003vsWTqc','event','Unauthorized\x20attempt\x20to\x20add\x20bot','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','endsWith','All\x20bots','lowdb/adapters/FileSync','temporary\x20token\x20generated','binary','timestamp','Token\x20blacklisted','off','::ffff:127.0.0.1','store','Backup\x20file\x20unzipped\x20and\x20stored','child_process','bbPassword','bcryptjs','ipaddr.js','/output-000.log','apiSecret','min','push','search','Allow\x20login\x20from\x20IP\x20address\x20','backupfile','IPv4','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','tempaccess_5_','metrics','inherit','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Disabled\x20Bot\x20','10wizgNA','lastmsgemitted','tkn','hashSync','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','NTBA_FIX_319','callback','getDate','lowdb','Unauthorized\x20attempt\x20to\x20store\x20configuration','Restore\x20process\x20confirmed','set','output-000.log','reset-history','generate','-events.json','Starting\x20#RED#Balance\x20Bot\x20v','decrypt','temporaryAccessAllowed','all','\x1b[31m','find','4412GoEyfN','show-config','statSync','once','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','$1_$2_$3','reply',':\x20Bot\x20Mgr\x20>\x20','config/','track','output-001.log','storeConfiguration','headless','Login\x20rejected','get-messages','express-fileupload','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','ipc','getPortfolio','mixpanel','notification','127.0.0.1','address','store-settings','files','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','.zip','sendMetricsTelegram','telegramUsername','index.html','get-portfolio','from','(((.+)+)+)+$','yes','bot','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','<b>Telegram\x20Bot\x20Status:</b>\x0a','All\x20bots\x20running\x20right\x20now','getFullYear','secure','bb-settings.json','File\x20uploaded','settings','private','5\x20min','action','on_','\x1b[0m','2FA','password','-config.json','hybrid-crypto-js','sign','Notifications\x20types:\x20','place-order','-results.json','\x20|\x20','reinstall_yes','restart','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','telegram2FaApproval','telegramToken','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','unlinkSync','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','listen','toggle','\x1b[34m','static','verify','timeshift','toIPv4MappedAddress','6299874lTmLzd','compareSync','Telegraf\x20error:','mode','add','toggleBotMode','Alerts','warning','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','bbvNew','add-bot','login2fa_','RSA-OAEP','telegrammsg','Invalid\x20authentication\x20token\x20(1)','status','getMinutes','orders','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','No\x20bots\x20running\x20right\x20now','restore_no_','Logged\x20out\x20user\x20...','inlineKeyboard','bbvReceive','simple','Yes','bbUsername','\x20(2)','socket','\x1b[33m','help','store-headless','206QWJCmW','f2aRequired','max','catch','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','connected','login\x20not\x20required','telegraf','clients','encryptedUuid','writeFileSync','Unauthorized\x20attempt\x20to\x20log\x20out','Notifications\x20disabled\x0a','\x20>\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','createServer','express','exp','close','chat','config_all','-----------------------------------------------------------------------------------','full','clientip','uuid','\x20only\x0a','placeOrder','server','/disable\x20-\x20disable\x20notifications\x0a','function','started','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','getTime','Telegram\x20error:','Restore\x20process\x20aborted','(staging)',',\x20must\x20be\x20a\x204\x20digit\x20number','get-starting-balances','exec','::1','onepagemode','params','sendFile','[ip-address]','/enable\x20-\x20enable\x20notifications\x0a','user','names','userid','disconnect','Node.js\x20v','version','off_','Deleted\x20Bot\x20','get-backup-files','build2','/:bot','getHours','747876kiQgnR','settings.','date-fns','filter','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','padStart','/off\x20-\x20stop\x20bot(s)\x0a','backup-full','Invalid\x20authentication\x20token\x20(2)','randomFillSync','fork','access\x20timeout','split','access','/:bot/history','manual','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','path','Notifications\x20disabled','temporary\x20access\x20rejected','2FA\x20login\x20required','No\x20authentication\x20token','production','***','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','crypto','sortBy','disable','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','reject','-performance.json','storeFiat','/:bot/performance','/names\x20-\x20show\x20bot\x20names\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','3404428ePANQS','config_alerts','Temporary\x20access\x20rejected','write','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','get','User\x20has\x20been\x20validated','argv','2FA\x20required','delete-alerts','Unauthorized\x20attempt\x20to\x20show\x20configuration','Starting\x20new\x20bot\x20|\x20Bot\x20','telegramIpApproval','initclient','text','button','range','output-003.log','error','slice','match','data','toggle_','store-fiat','invalid\x20credentials','updatebotmanager','env','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','telegramEnabled','/:bot/coins','blacklist','bb-secure.json','alias','copyFileSync','resetpw_yes','generateKeyPairAsync','sort','string','/download/:type','restore_yes_','botmanager','Server','deleteHistoryAlerts','hasOwnProperty','cancelLoading','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','mtime','SIGTERM','assign','/:bot/configuration','createWriteStream','yargs/yargs','new-disabled','Access\x20enabled\x20for\x20','HTML','getMonth','Invalid\x20IP\x20address','auth','value','backup-full.zip',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','use','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','rmSync','login2fa_reject_','referer',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','kill','apiPassword','success','axios','showConfig','format','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','pidRefreshToken','************','metrics_','expiry','remoteAddress','bb/','backup','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','update','RSA','reinstall-bb','reload','getSeconds','messages','logs','backup-full@','botname','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','randomBytes','Unauthorized\x20attempt\x20to\x20confirm\x20message','number','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','delete-bot','parse','launch','logout','backup-files','1797834cYyUMc','username','You\x20can\x20use\x20the\x20following\x20commands:\x0a','apiKey','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','tempaccess_30_','size','token','log','args','mkdirSync','editMessageReplyMarkup','includes','/restart\x20-\x20restart\x20bot(s)\x0a','hex','https://api.ipify.org?format=json','publicKey','secret'];_0x2a05=function(){return _0x51b177;};return _0x2a05();}const validToken=(_0x2eb0c8,_0x295805)=>{const _0x2a3836=_0x58d92a,_0x270786=devices[_0x295805]['ip'];if(!_0x2eb0c8)return{'error':_0x2a3836(0x270)};for(let _0x4cc820 of blacklist){if(_0x4cc820[_0x2a3836(0x2eb)]==_0x2eb0c8)return{'error':_0x2a3836(0x38e)};}let _0x4c1bff;try{_0x4c1bff=jwt[_0x2a3836(0x1ff)](_0x2eb0c8,secure['secret']+_0x295805);}catch{return{'error':_0x2a3836(0x210)};}if(!_0x4c1bff[_0x2a3836(0x2a9)](_0x2a3836(0x239))&&!_0x4c1bff[_0x2a3836(0x2a9)](_0x2a3836(0x2e5))||!_0x4c1bff['hasOwnProperty'](_0x2a3836(0x233)))return{'error':_0x2a3836(0x263)};if(!_0x4c1bff[_0x2a3836(0x2a9)](_0x2a3836(0x2e5))&&_0x4c1bff[_0x2a3836(0x2a9)](_0x2a3836(0x239))){const {clientip:_0x1ce8e0}=_0x4c1bff;return _0x270786==_0x1ce8e0?{'success':_0x2a3836(0x284)}:{'error':_0x2a3836(0x2b6)};}else{if(_0x4c1bff[_0x2a3836(0x2a9)](_0x2a3836(0x2e5))&&_0x4c1bff[_0x2a3836(0x2a9)](_0x2a3836(0x239))){const {username:_0xe67893,clientip:_0x228a0f}=_0x4c1bff;return settings['bbUsername']==_0xe67893&&_0x270786==_0x228a0f?{'success':_0x2a3836(0x284)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x19c951=>{const _0x59be6e=_0x58d92a;if(_0x19c951){const _0x26c238=devices[_0x19c951]['ip'];return jwt[_0x59be6e(0x1ee)]({'username':settings[_0x59be6e(0x21c)],'clientip':_0x26c238},secure['secret']+_0x19c951,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x140388=>{const _0x52b4a1=_0x58d92a;if(_0x140388){const _0x3b70c4=devices[_0x140388]['ip'];return jwt[_0x52b4a1(0x1ee)]({'clientip':_0x3b70c4},secure[_0x52b4a1(0x2f5)]+_0x140388,{'expiresIn':devices[_0x140388]['telegramIpApproval'][_0x52b4a1(0x2cc)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x410b7f=>{const _0x2f4ffe=_0x58d92a;let _0x3bc036=![];return devices[_0x410b7f][_0x2f4ffe(0x28a)]&&devices[_0x410b7f][_0x2f4ffe(0x28a)][_0x2f4ffe(0x2cc)]!=_0x2f4ffe(0x278)&&(_0x3bc036=devices[_0x410b7f][_0x2f4ffe(0x28a)]['clientip']==devices[_0x410b7f]['ip']&&new Date()[_0x2f4ffe(0x242)]()-devices[_0x410b7f]['telegramIpApproval']['timestamp']<devices[_0x410b7f][_0x2f4ffe(0x28a)]['expiry']*0x3c*0x3e8),_0x3bc036;},telegram2FaApproved=_0x5e23b2=>{const _0xd99050=_0x58d92a;let _0x4a8cf8=![];return devices[_0x5e23b2]['telegram2FaApproval']&&devices[_0x5e23b2][_0xd99050(0x1f6)][_0xd99050(0x2cc)]!=_0xd99050(0x278)&&(_0x4a8cf8=devices[_0x5e23b2][_0xd99050(0x1f6)][_0xd99050(0x239)]==devices[_0x5e23b2]['ip']&&new Date()[_0xd99050(0x242)]()-devices[_0x5e23b2]['telegram2FaApproval'][_0xd99050(0x38d)]<devices[_0x5e23b2][_0xd99050(0x1f6)][_0xd99050(0x2cc)]*0x3c*0x3e8),_0x4a8cf8;},normalizeIP=_0xffc8cc=>{const _0x452ab7=_0x58d92a;let _0x1e734d=null,_0x11645a=null;if(ipaddr[_0x452ab7(0x374)](_0xffc8cc)){const _0x1f9fef=ipaddr[_0x452ab7(0x2e0)](_0xffc8cc);_0x1f9fef['kind']()==='ipv6'?(_0x1f9fef['isIPv4MappedAddress']()&&(_0x1e734d=_0x1f9fef['toIPv4Address']()[_0x452ab7(0x323)]()),_0x11645a=_0x1f9fef[_0x452ab7(0x323)]()):(_0x1e734d=_0x1f9fef[_0x452ab7(0x323)](),_0x11645a=_0x1f9fef[_0x452ab7(0x201)]()[_0x452ab7(0x323)]());}return{'show':_0x1e734d?_0x1e734d:_0x11645a,'store':_0x11645a};};function formatDate(_0x47e537){const _0x25b2a3=_0x58d92a;return _0x47e537[_0x25b2a3(0x1e0)]()+'/'+(_0x47e537[_0x25b2a3(0x2b5)]()+0x1)[_0x25b2a3(0x323)]()[_0x25b2a3(0x260)](0x2,'0')+'/'+_0x47e537[_0x25b2a3(0x3ac)]()[_0x25b2a3(0x323)]()[_0x25b2a3(0x260)](0x2,'0')+'\x20'+_0x47e537['getHours']()['toString']()[_0x25b2a3(0x260)](0x2,'0')+':'+_0x47e537[_0x25b2a3(0x212)]()[_0x25b2a3(0x323)]()['padStart'](0x2,'0')+':'+_0x47e537[_0x25b2a3(0x2d5)]()[_0x25b2a3(0x323)]()[_0x25b2a3(0x260)](0x2,'0');}function sleep(_0x362f33){return new Promise(_0x10bc0d=>setTimeout(_0x10bc0d,_0x362f33));}