const _0x67c83f=_0x5c0c;(function(_0x1f38a2,_0x131741){const _0x5de55f=_0x5c0c,_0x114768=_0x1f38a2();while(!![]){try{const _0x345dd4=-parseInt(_0x5de55f(0x246))/0x1+parseInt(_0x5de55f(0x371))/0x2+-parseInt(_0x5de55f(0x2ba))/0x3*(-parseInt(_0x5de55f(0x38f))/0x4)+parseInt(_0x5de55f(0x2d3))/0x5+-parseInt(_0x5de55f(0x1dd))/0x6+parseInt(_0x5de55f(0x1c0))/0x7+-parseInt(_0x5de55f(0x346))/0x8*(-parseInt(_0x5de55f(0x32d))/0x9);if(_0x345dd4===_0x131741)break;else _0x114768['push'](_0x114768['shift']());}catch(_0x31b893){_0x114768['push'](_0x114768['shift']());}}}(_0x5b22,0x1fb58));const _0x399b4f=function(){let _0x5d358e=!![];return function(_0x158d0c,_0x37a6b9){const _0x4a3c3f=_0x5d358e?function(){const _0x1b9a23=_0x5c0c;if(_0x37a6b9){const _0x5e90d4=_0x37a6b9[_0x1b9a23(0x26d)](_0x158d0c,arguments);return _0x37a6b9=null,_0x5e90d4;}}:function(){};return _0x5d358e=![],_0x4a3c3f;};}(),_0x3b495e=_0x399b4f(this,function(){const _0xcf63da=_0x5c0c;return _0x3b495e[_0xcf63da(0x2ec)]()['search'](_0xcf63da(0x352))[_0xcf63da(0x2ec)]()['constructor'](_0x3b495e)[_0xcf63da(0x34d)](_0xcf63da(0x352));});_0x3b495e();'use strict';process['env'][_0x67c83f(0x223)]=0x1;const childProcess=require(_0x67c83f(0x297)),fs=require('fs'),fns=require(_0x67c83f(0x20c)),low=require(_0x67c83f(0x27c)),FileSync=require(_0x67c83f(0x35a)),path=require(_0x67c83f(0x280)),crypto=require('crypto'),forge=require(_0x67c83f(0x1a9)),bcrypt=require(_0x67c83f(0x38a)),jwt=require(_0x67c83f(0x335)),ipaddr=require('ipaddr.js'),argv=require(_0x67c83f(0x1fe))(process[_0x67c83f(0x387)][_0x67c83f(0x1ab)](0x2))[_0x67c83f(0x387)],uuidRandom=require(_0x67c83f(0x347)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x67c83f(0x244)),axios=require('axios'),{GraphQLClient,gql}=require(_0x67c83f(0x182)),util=require(_0x67c83f(0x2c5)),fileUpload=require(_0x67c83f(0x370)),{networkInterfaces}=require('os'),JSZip=require(_0x67c83f(0x354)),PORT=argv[_0x67c83f(0x24f)]||_0x67c83f(0x37b),pattern=/^[0-9]{2,4}$/;!pattern[_0x67c83f(0x261)](PORT)&&(console[_0x67c83f(0x22c)](_0x67c83f(0x2a1)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x67c83f(0x399)](0x1));const HOST=argv[_0x67c83f(0x369)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x67c83f(0x18c)]['node'];let bbpath=_0x67c83f(0x253),bbpath2='';const botfile='bot.js',configfile=_0x67c83f(0x193),settingsfile='bb-settings.json',securefile=_0x67c83f(0x339),environment=require('./'+bbpath2+_0x67c83f(0x389))[_0x67c83f(0x1ff)]||_0x67c83f(0x274),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x67c83f(0x230)),configpath=userID?bbpath+_0x67c83f(0x32b)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x67c83f(0x1d0)+userID+'/':bbpath+_0x67c83f(0x1d0),zippath=userID?bbpath+_0x67c83f(0x33c)+userID+'/':bbpath+_0x67c83f(0x33c),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x67c83f(0x301)+userID+'/':bbpath+_0x67c83f(0x301);!fs[_0x67c83f(0x1ed)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x67c83f(0x1ed)](configbackuppath)&&fs[_0x67c83f(0x290)](configbackuppath);!fs[_0x67c83f(0x1ed)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x67c83f(0x1ed)](zippath)&&fs[_0x67c83f(0x290)](zippath);!fs[_0x67c83f(0x1ed)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x67c83f(0x356)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x67c83f(0x349)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x67c83f(0x1ec),'onepagemode':![],'marketcapApi':''}})[_0x67c83f(0x356)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x67c83f(0x349)]({'secure':{},'blacklist':[]})[_0x67c83f(0x356)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x67c83f(0x329)](_0x67c83f(0x25f),{'host':_0x67c83f(0x21b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x67c83f(0x220)]!=''&&settings[_0x67c83f(0x220)]!=_0x67c83f(0x194))&&settings[_0x67c83f(0x376)]&&settings[_0x67c83f(0x376)]!='')initTelegram();const parseColor=(_0x580888,_0x23af27)=>{const _0x4e7833=_0x67c83f,_0x5cd473=/#[A-Z]{3}#/g;if(typeof _0x580888==_0x4e7833(0x1c3)){!_0x23af27?_0x580888=_0x580888[_0x4e7833(0x1be)](_0x5cd473,''):(_0x580888=_0x580888[_0x4e7833(0x1be)](/#BLU#/g,_0x4e7833(0x203)),_0x580888=_0x580888[_0x4e7833(0x1be)](/#RED#/g,'\x1b[31m'),_0x580888=_0x580888[_0x4e7833(0x1be)](/#YEL#/g,_0x4e7833(0x1d7)),_0x580888=_0x580888[_0x4e7833(0x1be)](/#MAG#/g,_0x4e7833(0x326)),_0x580888=_0x580888[_0x4e7833(0x1be)](/#CYA#/g,_0x4e7833(0x25a)),_0x580888=_0x580888['replace'](/#RES#/g,_0x4e7833(0x186)));;}return _0x580888;},logger={'screen':_0x4ec966=>{const _0x1786ef=_0x67c83f;console[_0x1786ef(0x22c)](parseColor(_0x4ec966,!![]));},'simple':_0x3412f6=>{const _0x33d686=_0x67c83f;console['log'](parseColor(_0x3412f6,!![])),loggerfile[_0x33d686(0x356)](util[_0x33d686(0x2d7)](parseColor(_0x3412f6,![]))+'\x0a');},'full':async _0x766079=>{const _0x4ef8fd=_0x67c83f,_0x23ae4f=getTimeStamp()+_0x4ef8fd(0x1b2)+_0x766079;console[_0x4ef8fd(0x22c)](parseColor(_0x23ae4f,!![])),loggerfile['write'](util[_0x4ef8fd(0x2d7)](parseColor(_0x23ae4f,![]))+'\x0a');if(tgBot&&settings[_0x4ef8fd(0x184)]&&settings['telegramEvents']!=_0x4ef8fd(0x1ef))await sendTelegram(settings[_0x4ef8fd(0x184)],_0x4ef8fd(0x23e)+parseColor(_0x766079,![]));},'debug':async(_0x35f10f,_0x2285e1='')=>{const _0x58cbea=_0x67c83f,_0x43b04b=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x35f10f;if(debugging)console['log'](parseColor(_0x43b04b,!![]));loggerfile[_0x58cbea(0x356)](util['format'](parseColor(_0x43b04b,![]))+'\x0a');if(_0x2285e1){if(debugging)console[_0x58cbea(0x22c)](_0x2285e1);loggerfile['write'](util[_0x58cbea(0x2d7)](_0x2285e1)+'\x0a');}}};let terminating=![];process['on'](_0x67c83f(0x26a),function(_0x2affa1){const _0x26ef55=_0x67c83f;_0x2affa1['toString']()[_0x26ef55(0x392)]('address\x20already\x20in\x20use')?(logger['simple']('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x2affa1[_0x26ef55(0x24f)]+'#RES#'),process[_0x26ef55(0x198)]({'terminate':!![]},_0x5c6429=>{})):logger['simple'](_0x2affa1);}),process['on']('exit',()=>{const _0x1b4999=_0x67c83f;stopAllBots(),process[_0x1b4999(0x399)](0x0);}),process['on'](_0x67c83f(0x328),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x67c83f(0x307),()=>{const _0x1e4a9d=_0x67c83f;stopAllBots(),process[_0x1e4a9d(0x399)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x67c83f(0x389))[_0x67c83f(0x18d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x67c83f(0x239)),app=express(),http=require('http')['createServer'](app);app[_0x67c83f(0x218)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x5b1493,_0x258920)=>{const _0x5cd9eb=_0x67c83f,_0x1586b4=_0x5b1493[_0x5cd9eb(0x213)][_0x5cd9eb(0x373)],_0x12c4df=getClientsWithBotID(_0x5cd9eb(0x2db)),_0x252bd2=_0x5b1493['headers'][_0x5cd9eb(0x2d2)],_0xe6e81=timelyDecrypt(_0x252bd2,![]),_0x474c10=_0x12c4df['find'](_0x5c9048=>_0x5c9048[_0x5cd9eb(0x2d2)]==_0xe6e81);if(_0x474c10){const _0x1144c6=normalizeIP(_0x5b1493[_0x5cd9eb(0x252)]['remoteAddress'])['store'],_0x927238=_0x5b1493[_0x5cd9eb(0x260)]['tkn'];if(validateAccess(_0x927238,_0xe6e81,_0x1144c6)[_0x5cd9eb(0x1d5)])_0x1586b4==_0x5cd9eb(0x2ab)&&await backupConfigFiles(),await zipFiles(_0x1586b4),_0x258920[_0x5cd9eb(0x231)](zippath+(_0x1586b4+_0x5cd9eb(0x2a9)),_0x49ead5=>{const _0x41d699=_0x5cd9eb;_0x49ead5&&(logger[_0x41d699(0x234)](_0x41d699(0x2aa)+_0x1586b4),logger[_0x41d699(0x38b)](_0x49ead5));});else logger[_0x5cd9eb(0x234)](_0x5cd9eb(0x1e8)+_0x1586b4+_0x5cd9eb(0x33e));}else logger[_0x5cd9eb(0x234)](_0x5cd9eb(0x1e8)+_0x1586b4+_0x5cd9eb(0x30e));}),app[_0x67c83f(0x286)](_0x67c83f(0x248),async(_0x1219b3,_0x4542f9)=>{const _0x5149ae=_0x67c83f,_0x24ce5c=getClientsWithBotID('botmanager'),_0x283d1c=_0x1219b3['headers'][_0x5149ae(0x2d2)],_0x32bcb3=timelyDecrypt(_0x283d1c,![]),_0x1502c2=_0x24ce5c[_0x5149ae(0x214)](_0x47a4ff=>_0x47a4ff[_0x5149ae(0x2d2)]==_0x32bcb3);logger[_0x5149ae(0x32e)]('Backup\x20file\x20uploaded');if(_0x1502c2){const _0x4dad83=normalizeIP(_0x1219b3[_0x5149ae(0x252)][_0x5149ae(0x24a)])[_0x5149ae(0x320)],_0x44a573=_0x1219b3[_0x5149ae(0x260)][_0x5149ae(0x2f3)];if(validateAccess(_0x44a573,_0x32bcb3,_0x4dad83)['allow']){if(_0x1219b3[_0x5149ae(0x288)]){const _0x468cea=_0x1219b3[_0x5149ae(0x288)]['backupfile'];await _0x468cea['mv'](temppath+_0x468cea[_0x5149ae(0x2fb)]),_0x4542f9[_0x5149ae(0x198)]({'status':!![],'message':_0x5149ae(0x24d)});const _0x1a2c83=getBotsWithMode();_0x1a2c83[_0x5149ae(0x1a7)]>0x0?confirmRestore(temppath,_0x468cea[_0x5149ae(0x2fb)]):unzipFile(temppath,_0x468cea['name']);}}else logger[_0x5149ae(0x234)](_0x5149ae(0x202));}else logger[_0x5149ae(0x234)](_0x5149ae(0x1cb));}),app[_0x67c83f(0x218)](express[_0x67c83f(0x2ad)](path[_0x67c83f(0x190)](__dirname,bbpath2,_0x67c83f(0x20d)))),app[_0x67c83f(0x218)](express['static'](path[_0x67c83f(0x190)](__dirname,bbpath2,_0x67c83f(0x264)))),app[_0x67c83f(0x372)]('/',function(_0x42a3e8,_0x507c52){const _0xeee1=_0x67c83f;_0x507c52[_0xeee1(0x1c1)](path['join'](__dirname,bbpath2,_0xeee1(0x20d),_0xeee1(0x341)));}),app[_0x67c83f(0x372)](_0x67c83f(0x37f),function(_0x110ad0,_0x308b69){const _0x24d015=_0x67c83f;_0x308b69[_0x24d015(0x1c1)](path[_0x24d015(0x190)](__dirname,bbpath2,_0x24d015(0x264),_0x24d015(0x341)));}),app[_0x67c83f(0x372)](_0x67c83f(0x26b),(_0x23db07,_0x574f7c)=>{const _0x22367e=_0x67c83f;_0x574f7c[_0x22367e(0x1c1)](path[_0x22367e(0x190)](__dirname,bbpath2,_0x22367e(0x264),_0x22367e(0x341)));}),app[_0x67c83f(0x372)](_0x67c83f(0x33b),(_0x2702ab,_0x3714c4)=>{const _0x374cbc=_0x67c83f;_0x3714c4[_0x374cbc(0x1c1)](path[_0x374cbc(0x190)](__dirname,bbpath2,_0x374cbc(0x264),'index.html'));}),app['get']('/:bot/coins',(_0x185c0c,_0x4df384)=>{const _0x3a7022=_0x67c83f;_0x4df384[_0x3a7022(0x1c1)](path['join'](__dirname,bbpath2,'build',_0x3a7022(0x341)));}),app['get'](_0x67c83f(0x247),(_0x1712a5,_0x651ea9)=>{const _0x39f8f9=_0x67c83f;_0x651ea9[_0x39f8f9(0x1c1)](path[_0x39f8f9(0x190)](__dirname,bbpath2,_0x39f8f9(0x264),_0x39f8f9(0x341)));}),app[_0x67c83f(0x372)](_0x67c83f(0x1da),(_0x48c43a,_0x432309)=>{const _0x54426a=_0x67c83f;_0x432309[_0x54426a(0x1c1)](path['join'](__dirname,bbpath2,_0x54426a(0x264),_0x54426a(0x341)));}),app[_0x67c83f(0x372)](_0x67c83f(0x2a2),(_0x14750b,_0x59e0a7)=>{const _0x53aa16=_0x67c83f;_0x59e0a7[_0x53aa16(0x1c1)](path['join'](__dirname,bbpath2,_0x53aa16(0x264),'index.html'));});if(HOST)http[_0x67c83f(0x1f9)](PORT,HOST);else http[_0x67c83f(0x1f9)](PORT);function _0x5b22(){const _0x22020a=['address','login\x20token\x20valid','size','Starting\x20#RED#Balance\x20Bot\x20v','listen','telegramEnabled','keys','Notifications\x20disabled\x0a','loadAsync','yargs/yargs','environment','delete-alerts','cloneDeep','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','\x1b[34m','set','/off\x20-\x20stop\x20bot(s)\x0a','copyFileSync','from','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','botname','Unauthorized\x20attempt\x20to\x20update\x20bot','Yes','date-fns','build2','accept','privateKeyToPem','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','IPv4','/update\x20-\x20update\x20Balance\x20Bot\x0a','params','find','bbvReceive','No\x20authentication\x20token',')\x20|\x20Bot\x20','use','/start','manual','api-eu.mixpanel.com','reinstall_no','mode','|@|','off_','telegramToken','reject','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','NTBA_FIX_319','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','storeConfiguration','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20delete\x20alerts','value','2FA\x20login\x20token\x20generated','remove','log','headless','showConfig','pidExpireLogin','clients','download','Error\x20details:','auto','full','placeOrder','DEFLATE','restore-backup-file','filter','express','disabled','Invalid\x20username\x20or\x20IP\x20address','Access\x20enabled\x20for\x20','connection','Bot\x20Mgr\x20>\x20','bb-settings.json','private','getMonth','blacklist','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','mixpanel','password','145975TQEUpN','/:bot/history','/upload-backup','emitHistory','remoteAddress','once','Telegram\x20error:','File\x20uploaded','add','port','getDate','tempaccess_30_','socket','bb/','add-bot','/metrics\x20-\x20show\x20bot\x20performance\x0a','server','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','conn','output-001.log','\x1b[36m','storeHeadless','getTime','showname','Error\x20while\x20deleting\x20config\x20files:\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','headers','test','bot','telegram2FaApproval','build','publicKeyToPem','randomFillSync','\x20>\x20','generateAsync','stopped','uncaughtException','/:bot/portfolio','2FA\x20login\x20rejected','apply','enabled','messages','all','close','expiry','temporary\x20access\x20rejected','production','-----------------------------------------------------------------------------------','padStart','parse','rsa','referer','secure','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','lowdb','token','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Your\x20installation\x20is\x20already\x20up\x20to\x20date','path','update-bot','reinstall_yes','login2fa_reject_','toggle_','-events.json','post','Telegraf\x20error:','files','enable','Ok,\x20will\x20send\x20order\x20notifications\x20only','privateKeyFromPem','pki','reset-history','auth','bbPassword','mkdirSync','started','new','/help\x20-\x20show\x20available\x20commands\x0a','writeFileSync','restore_no_','Bot\x20','child_process','login\x20not\x20required','reply','toIPv4Address','emit','alias','15\x20min','mtime','getHours','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Error:\x20Invalid\x20argument\x20','/:bot/support','logged\x20out','************','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','restore_yes_','-config.json','.zip','Failed\x20to\x20download\x20','backup','onepagemode','static','reinstall','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','<b>Telegram\x20Bot\x20Status:</b>\x0a','latestversion','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','unlinkSync','temporary\x20access\x20not\x20allowed','telegramEvents','Logged\x20out\x20user\x20...','decode64','pidRefreshToken','portfolio_','6ChTguB','binary','telegram','any','\x20|\x20','metrics','access','settings.','inherit','Setting\x20access:\x20','status\x20code\x20401','util','ETH','::1','reason','portfolio','assign','rmSync','place-order','args','\x20only\x0a','Restore\x20backup\x20file\x20','update-bb','lastmsgemitted','uuid','452305qjxcYc','randomBytes','telegrammsg','BCT','format','#RES#\x20if\x20running\x20on\x20server','restart_','5\x20min','botmanager','new-disabled','cancelLoading','restart','lastmsgtelegram','entries','login\x20token\x20generated','127.0.0.1','tempaccess_5_','reload','sockets','getUTCHours','updatebotmanager','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','isValid','get-portfolio','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','toString','temporary\x20token\x20generated','update_yes','exp','hashSync','$1_$2_$3','disconnect','tkn','config_alerts','backup-full','Idling\x20(','userid','order','\x20-\x20','privateKey','name','toggle','=>\x20Go\x20to\x20#CYA#http://','Deleted\x20Bot\x20','1000','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','temp/','output-000.log','stringify','status','get-starting-balances','marketcapApi','SIGINT','readdirSync','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20update\x20settings','Error\x20removing\x20old\x20backup\x20files:','Restore\x20process\x20aborted','function','\x20(2)','kind','map','kill','2FA\x20login\x20required','callback','Password\x20has\x20been\x20reset\x20to:\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','sortBy','Unauthorized\x20attempt\x20to\x20delete\x20bot','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','store-headless','No\x20bots\x20running\x20right\x20now','hex','code','bot-','output-002.log','startsWith','store','connected','button','/on\x20-\x20start\x20bot(s)\x0a','decrypt','getSeconds','\x1b[35m','success','SIGTERM','init','file','config/','botID','684leJpcH','debug','_nsps','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Token\x20blacklisted','Allow\x20login\x20from\x20IP\x20address\x20','invalid\x20credentials','socket.io','jsonwebtoken','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','-performance.json','HTML','bb-secure.json','whitelist','/:bot/performance','zip/','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20(1)','update','getMinutes','index.html','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','error','login\x20required','message','12008bmXHQM','uuid-random','f2aRequired','defaults','All','catch','bbUsername','search','Starting\x20Balance\x20Bot\x20reinstallation',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','timestamp','alerts','(((.+)+)+)+$','match','jszip','Unauthorized\x20attempt\x20to\x20get\x20events','write','split','getFullYear','apiPassword','lowdb/adapters/FileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','backup-files','action','config_orders','notification','logout','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Unauthorized\x20attempt\x20to\x20confirm\x20message','on_','editMessageReplyMarkup','confirm-message','Alerts','toIPv4MappedAddress','push','host','username','hasOwnProperty','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','live','(staging)','publicKey','express-fileupload','161022dpoORK','get','type','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','clientip','telegramUsername','backup-full.zip','-results.json','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20add\x20bot','3000','<b>Balance\x20Bot\x20Status:</b>\x0a','Starting\x20Balance\x20Bot\x20update','store-settings','/:bot','show','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','::ffff:127.0.0.1','loginRequired','settings','reset-password','resetHistory','argv','Backup\x20file\x20unzipped\x20and\x20stored','version.json','bcryptjs','simple','sign','2FA\x20required','encryptedUuid','103892KDgGsH','sha256','CoinMarketCap\x20API\x20key\x20validated','includes','get-messages','create','Starting\x20new\x20bot\x20|\x20Bot\x20','family','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','store-fiat','exit','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','login','forEach','start','graphql-request','Login\x20rejected','telegramChatId','get-backup-files','\x1b[0m','/enable\x20-\x20enable\x20notifications\x0a','Enabled\x20Bot\x20','generateKeyPair','Invalid\x20IP\x20address','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','versions','version','*$1*','internal','join','sort','Notifications\x20disabled','bb-config.json','***','config_all','/restart\x20-\x20restart\x20bot(s)\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','send','resetpw_yes','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','\x20to\x20','bbvNew','access\x20timeout','timeshift','/disable\x20-\x20disable\x20notifications\x0a','handshake','Notifications\x20types:\x20','event','data','logs','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','apiSecret','length','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','node-forge','chat','slice','fork','Unauthorized\x20attempt\x20to\x20store\x20configuration','bots','verify','#RES#\x20if\x20running\x20locally\x0a','#RES#\x20',':\x20Bot\x20Mgr\x20>\x20','All\x20bots','\x20mode','readFileSync','backup-full@','ipc','/status\x20-\x20show\x20bot(s)\x20status\x0a','tempaccess_15_','whitelistEnabled','getPortfolio','Invalid\x20authentication\x20token\x20(1)','login2fa_','replace','sendPortfolioTelegram','700070OblPiT','sendFile','number','string','Orders','Unauthorized\x20attempt\x20to\x20show\x20configuration','stop','Disabled\x20Bot\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','title','inlineKeyboard','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','isDirectory','reinstall-bb','yes','exchange','logs/','async','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Unauthorized\x20attempt\x20to\x20log\x20out','allow','command','\x1b[33m','telegramIpApproval','running','/:bot/configuration','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','sendMetricsTelegram','966894ICEwww','apiKey','sendMessage','Unauthorized\x20attempt\x20to\x20get\x20portfolio','help','\x20minutes','Node.js\x20v','[ip-address]','You\x20can\x20use\x20the\x20following\x20commands:\x0a','delete-bot','disable','Unauthorized\x20attempt\x20to\x20download\x20','2FA','cancel-loading','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','0.0.0','existsSync','off','orders','secret','Network\x20Interfaces:','removeAllListeners','endsWith','30\x20min'];_0x5b22=function(){return _0x22020a;};return _0x5b22();}const io=require(_0x67c83f(0x334))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x332a32=_0x67c83f;let _0xb34d22=_0x332a32(0x1e4);const _0x5892b8=networkInterfaces(),_0xe50576={};for(const _0x24e7c5 of Object['keys'](_0x5892b8)){for(const _0x2ca329 of _0x5892b8[_0x24e7c5]){if((_0x2ca329[_0x332a32(0x396)]==_0x332a32(0x211)||_0x2ca329[_0x332a32(0x396)]==0x4)&&!_0x2ca329[_0x332a32(0x18f)]){const _0xf3e3c0=ipaddr['parse'](_0x2ca329[_0x332a32(0x1f5)])['range']();_0xf3e3c0!=_0x332a32(0x240)&&(!_0xe50576[_0x24e7c5]&&(_0xe50576[_0x24e7c5]=[]),_0xe50576[_0x24e7c5]['push'](_0x2ca329['address']),_0xb34d22=_0x2ca329['address']);}}}return{'serverip':_0xb34d22,'netinterfaces':_0xe50576};}async function startServer(){const _0x42f2b0=_0x67c83f,{serverip:_0x2ba131,netinterfaces:_0x540ed0}=getServerIP();logger[_0x42f2b0(0x38b)](''),logger[_0x42f2b0(0x38b)](_0x42f2b0(0x275)),await logger[_0x42f2b0(0x234)](_0x42f2b0(0x1f8)+serverversion+_0x42f2b0(0x1b1)+(environment=='staging'?_0x42f2b0(0x36e):'')+'\x0a'+(_0x42f2b0(0x318)+PORT+_0x42f2b0(0x1b0))+(_0x42f2b0(0x2fd)+_0x2ba131+':'+PORT+_0x42f2b0(0x2d8))),logger[_0x42f2b0(0x38b)](_0x42f2b0(0x275));if(config[_0x42f2b0(0x1a7)]!=0x0)for(const _0x40d2d2 of config){const _0xda5803=_0x40d2d2[_0x42f2b0(0x21d)]=='auto'?'a':'m';if(_0x40d2d2[_0x42f2b0(0x304)]==_0x42f2b0(0x26e)||_0x40d2d2[_0x42f2b0(0x304)]==_0x42f2b0(0x292))await logger['full']('Starting\x20('+_0xda5803+_0x42f2b0(0x217)+_0x40d2d2[_0x42f2b0(0x32c)]+_0x42f2b0(0x2be)+_0x40d2d2['botname']),startBot([_0x40d2d2[_0x42f2b0(0x32c)],userID],{'cwd':bbpath},function(_0x151d35){const _0x9716c0=_0x42f2b0;if(_0x151d35)logger[_0x9716c0(0x234)](_0x151d35);});else(_0x40d2d2['status']==_0x42f2b0(0x23a)||_0x40d2d2[_0x42f2b0(0x304)]==_0x42f2b0(0x2dc))&&await logger[_0x42f2b0(0x234)](_0x42f2b0(0x2f6)+_0xda5803+')\x20\x20\x20|\x20Bot\x20'+_0x40d2d2[_0x42f2b0(0x32c)]+_0x42f2b0(0x2be)+_0x40d2d2[_0x42f2b0(0x209)]);}else!newBot&&logger[_0x42f2b0(0x38b)](_0x42f2b0(0x315));if(newBot)addBot();logger[_0x42f2b0(0x38b)](_0x42f2b0(0x275)),logger[_0x42f2b0(0x38b)](''),await logger[_0x42f2b0(0x32e)](_0x42f2b0(0x1e3)+nodeversion),await logger[_0x42f2b0(0x32e)](_0x42f2b0(0x1f1),_0x540ed0);}function startSocket(){const _0x9b1bbb=_0x67c83f;io['on'](_0x9b1bbb(0x23d),_0x47cd5d=>{const _0x1110e=_0x9b1bbb;let _0x15703b,_0x5e4970,_0x5328f9,_0x5b4c55,_0xa1fd5b;const _0x4059cc=_0x47cd5d[_0x1110e(0x1a0)]['headers'][_0x1110e(0x279)];_0x5e4970=_0x4059cc[_0x1110e(0x353)](/bot[0-9]{3}/);if(_0x5e4970)_0x5328f9=_0x5e4970[0x0][_0x1110e(0x353)](/[0-9]{3}/);if(_0x5328f9)_0x15703b=_0x5328f9[0x0];else _0x15703b=_0x1110e(0x2db);const _0x28bdd4=_0x47cd5d[_0x1110e(0x1a0)][_0x1110e(0x28e)][_0x1110e(0x38e)];if(!_0x28bdd4)_0x47cd5d['emit'](_0x1110e(0x304),{'publicKey':secure[_0x1110e(0x36f)]});else{_0x5b4c55=timelyDecrypt(_0x28bdd4,![]);if(!_0x5b4c55)_0x47cd5d[_0x1110e(0x29b)]('status',{'publicKey':secure[_0x1110e(0x36f)]});else{_0xa1fd5b=normalizeIP(_0x47cd5d[_0x1110e(0x258)][_0x1110e(0x24a)])[_0x1110e(0x320)];if(!devices[_0x5b4c55])devices[_0x5b4c55]={'uuid':_0x5b4c55,'access':{'token':null}};devices[_0x5b4c55]['ip']=_0xa1fd5b;const _0x390028=addClient(_0x47cd5d['id'],_0x5b4c55,_0x15703b);setAccess(_0x390028),emitMessages(),_0x47cd5d['on'](_0x1110e(0x39b),_0xb33afc=>{const _0x560abf=_0x1110e,_0x5a8b9f=timelyDecrypt(_0xb33afc[_0x560abf(0x245)],!![],_0x560abf(0x21e));if(_0x5a8b9f){_0xb33afc={'username':_0xb33afc[_0x560abf(0x36a)],'password':_0x5a8b9f},devices[_0x5b4c55][_0x560abf(0x2c0)]=validateCredentials(_0xb33afc,_0x5b4c55);if(devices[_0x5b4c55]['access'][_0x560abf(0x1d5)]==![]&&devices[_0x5b4c55][_0x560abf(0x2c0)]['reason']==_0x560abf(0x312))_0x47cd5d[_0x560abf(0x29b)](_0x560abf(0x304),{'access':devices[_0x5b4c55][_0x560abf(0x2c0)]}),loginAccess2FA(_0x5b4c55,_0xa1fd5b);else{if(devices[_0x5b4c55][_0x560abf(0x2c0)]['allow']==![]&&devices[_0x5b4c55]['access'][_0x560abf(0x2c8)]==_0x560abf(0x333))_0x47cd5d[_0x560abf(0x29b)](_0x560abf(0x304),{'access':devices[_0x5b4c55]['access']});else devices[_0x5b4c55][_0x560abf(0x2c0)][_0x560abf(0x1d5)]&&devices[_0x5b4c55][_0x560abf(0x2c0)][_0x560abf(0x2c8)]==_0x560abf(0x2e1)&&(getClientsWithUuid(_0x5b4c55)[_0x560abf(0x39c)](_0x292637=>{setAccess(_0x292637);}),logger[_0x560abf(0x32e)]('Logged\x20in\x20user\x20...'+_0x5b4c55[_0x560abf(0x1ab)](-0x8)),setTokenRefresh(_0x5b4c55),setSessionTimeout(_0x560abf(0x39b),_0x5b4c55));}}else logger[_0x560abf(0x234)](_0x560abf(0x309));}),_0x47cd5d['on'](_0x1110e(0x385),()=>{resetPassword();}),_0x47cd5d['on'](_0x1110e(0x2f2),_0xcf0f59=>{removeClient(_0x47cd5d['id']);}),_0x15703b==_0x1110e(0x2db)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x540751){const _0x2edb63=_0x67c83f;if(_0x540751!='botmanager'&&config[_0x2edb63(0x1de)]!=''){if(pid[_0x540751])pid[_0x540751][_0x2edb63(0x198)]({'function':'initclient','args':null});}_0x540751!=_0x2edb63(0x2db)&&broadcastToBots(_0x2edb63(0x1ae),JSON[_0x2edb63(0x303)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x1e672a=>{const _0x371242=_0x5c0c;getSocket(_0x1e672a['id'])[_0x371242(0x29b)](_0x371242(0x304),{'access':{'allow':![],'reason':_0x371242(0x2e4),'token':null}});});}function getSocket(_0x34116b){const _0x45f99a=_0x67c83f,_0x2e50e2=io[_0x45f99a(0x32f)][_0x45f99a(0x372)]('/');return _0x2e50e2[_0x45f99a(0x2e5)]['get'](_0x34116b);}function setAccess(_0x10cb8b){const _0x19f0f6=_0x67c83f,_0x2557ce=getSocket(_0x10cb8b['id']),_0xca596f=_0x10cb8b[_0x19f0f6(0x2d2)],_0x4a9026=_0x10cb8b[_0x19f0f6(0x262)];devices[_0xca596f][_0x19f0f6(0x2c0)]=validateAccess(devices[_0xca596f][_0x19f0f6(0x2c0)][_0x19f0f6(0x27d)],_0xca596f),logger[_0x19f0f6(0x32e)](_0x19f0f6(0x2c3)+devices[_0xca596f]['access']['reason']+'\x20|\x20client:\x20...'+_0x10cb8b['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0xca596f[_0x19f0f6(0x1ab)](-0x8)),_0x2557ce[_0x19f0f6(0x190)](_0xca596f);if(devices[_0xca596f][_0x19f0f6(0x2c0)]['allow']){_0x2557ce[_0x19f0f6(0x190)](_0x4a9026);if(_0x4a9026=='botmanager')initializeSocketBotManager(_0x2557ce);else initializeSocketBot(_0x2557ce);initClient(_0x4a9026);}devices[_0xca596f]['access'][_0x19f0f6(0x27d)]&&devices[_0xca596f]['access'][_0x19f0f6(0x2c8)]==_0x19f0f6(0x2ed)&&setSessionTimeout(_0x19f0f6(0x1e9),_0xca596f),devices[_0xca596f][_0x19f0f6(0x2c0)]['token']&&devices[_0xca596f][_0x19f0f6(0x2c0)][_0x19f0f6(0x2c8)]==_0x19f0f6(0x22a)&&setSessionTimeout(_0x19f0f6(0x39b),_0xca596f),_0x2557ce['emit']('status',{'status':_0x10cb8b[_0x19f0f6(0x256)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xca596f]['access'],'externalip':devices[_0xca596f]['ip'],'publicKey':secure[_0x19f0f6(0x36f)],'userid':settings[_0x19f0f6(0x2f7)],'validInstallation':validInstallation}),devices[_0xca596f]['access'][_0x19f0f6(0x1d5)]==![]&&devices[_0xca596f]['access'][_0x19f0f6(0x2c8)]==_0x19f0f6(0x38d)&&temporaryAccess2FA(_0xca596f,devices[_0xca596f]['ip']);}function setSessionTimeout(_0x25dd31,_0x4cfdbb){const _0x8ef9c8=_0x67c83f;let _0x2d008;if(_0x25dd31==_0x8ef9c8(0x39b))_0x2d008=loginExpiry*0x3c*0x3e8;else _0x2d008=devices[_0x4cfdbb][_0x8ef9c8(0x1d8)][_0x8ef9c8(0x272)]*0x3c*0x3e8-(new Date()[_0x8ef9c8(0x25c)]()-devices[_0x4cfdbb][_0x8ef9c8(0x1d8)][_0x8ef9c8(0x350)]);if(devices[_0x4cfdbb][_0x8ef9c8(0x22f)])clearTimeout(devices[_0x4cfdbb]['pidExpireLogin']);devices[_0x4cfdbb][_0x8ef9c8(0x22f)]=setTimeout(()=>{const _0x3aef03=_0x8ef9c8;if(devices[_0x4cfdbb][_0x3aef03(0x2b8)])clearTimeout(devices[_0x4cfdbb][_0x3aef03(0x2b8)]);removeSocketListeners(_0x4cfdbb),addBlacklist(_0x4cfdbb),devices[_0x4cfdbb]['telegramIpApproval']=null,devices[_0x4cfdbb][_0x3aef03(0x263)]=null,devices[_0x4cfdbb][_0x3aef03(0x2c0)]['token']=null,logger[_0x3aef03(0x32e)]('Session\x20expired\x20for\x20user\x20...'+_0x4cfdbb[_0x3aef03(0x1ab)](-0x8)),devices[_0x4cfdbb][_0x3aef03(0x2c0)]=validateAccess(devices[_0x4cfdbb][_0x3aef03(0x2c0)][_0x3aef03(0x27d)],_0x4cfdbb),!(devices[_0x4cfdbb][_0x3aef03(0x2c0)][_0x3aef03(0x1d5)]&&devices[_0x4cfdbb][_0x3aef03(0x2c0)]['reason']==_0x3aef03(0x298))&&(_0x25dd31==_0x3aef03(0x39b)?io['to'](_0x4cfdbb)[_0x3aef03(0x29b)](_0x3aef03(0x304),{'access':{'allow':![],'reason':_0x3aef03(0x19d),'token':null}}):io['to'](_0x4cfdbb)[_0x3aef03(0x29b)](_0x3aef03(0x304),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4cfdbb]['access'][_0x3aef03(0x27d)]=null;},_0x2d008);}function setTokenRefresh(_0xbaca46){const _0x2ee65b=_0x67c83f;if(devices[_0xbaca46][_0x2ee65b(0x2b8)])clearTimeout(devices[_0xbaca46][_0x2ee65b(0x2b8)]);devices[_0xbaca46]['pidRefreshToken']=setTimeout(()=>{const _0x50c7a5=_0x2ee65b;getClientsWithUuid(_0xbaca46)['length']!=0x0?(devices[_0xbaca46][_0x50c7a5(0x2c0)]=refreshToken(_0xbaca46),io['to'](_0xbaca46)[_0x50c7a5(0x29b)](_0x50c7a5(0x304),{'status':_0x50c7a5(0x321),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xbaca46]['access'],'externalip':devices[_0xbaca46]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0xbaca46)):clearTimeout(devices[_0xbaca46]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x407039){const _0x4593ab=_0x67c83f,_0x2a3a4d=getClient(_0x407039['id'])[_0x4593ab(0x2d2)];_0x407039[_0x4593ab(0x29b)](_0x4593ab(0x1ae),config),_0x407039[_0x4593ab(0x29b)](_0x4593ab(0x384),cleanSettings()),_0x407039['on'](_0x4593ab(0x254),_0x47828d=>{const _0x1ee7de=_0x4593ab;if(validateAccess(_0x47828d,_0x2a3a4d)[_0x1ee7de(0x1d5)])addBot();else logger[_0x1ee7de(0x234)](_0x1ee7de(0x37a));}),_0x407039['on'](_0x4593ab(0x281),(_0x56b322,_0x26cada)=>{const _0x595a1e=_0x4593ab;if(validateAccess(_0x26cada,_0x2a3a4d)[_0x595a1e(0x1d5)])toggleBot(_0x56b322[_0x595a1e(0x32c)],_0x56b322['status'],_0x56b322[_0x595a1e(0x36d)]);else logger[_0x595a1e(0x234)](_0x595a1e(0x20a));}),_0x407039['on']('toggle-bot-mode',(_0xe63b07,_0x3e617f)=>{const _0xc1e0c7=_0x4593ab;if(validateAccess(_0x3e617f,_0x2a3a4d)['allow'])toggleBotMode(_0xe63b07);else logger['full'](_0xc1e0c7(0x20a));}),_0x407039['on'](_0x4593ab(0x1e6),(_0x41c0d0,_0x4abcb3)=>{const _0xb72912=_0x4593ab;if(validateAccess(_0x4abcb3,_0x2a3a4d)['allow'])deleteBot(_0x41c0d0);else logger[_0xb72912(0x234)](_0xb72912(0x317));}),_0x407039['on'](_0x4593ab(0x37e),(_0x3be87c,_0x4660a4)=>{const _0x3507c3=_0x4593ab;if(validateAccess(_0x4660a4,_0x2a3a4d)[_0x3507c3(0x1d5)])storeSettings(_0x3be87c,!![]);else logger[_0x3507c3(0x234)](_0x3507c3(0x30a));}),_0x407039['on']('update-bb',_0x2ec9ef=>{const _0x44a364=_0x4593ab;if(validateAccess(_0x2ec9ef,_0x2a3a4d)['allow'])updateBB(_0x44a364(0x33f));else logger[_0x44a364(0x234)](_0x44a364(0x243));}),_0x407039['on'](_0x4593ab(0x1cd),_0x5856d9=>{const _0x4ab83f=_0x4593ab;if(validateAccess(_0x5856d9,_0x2a3a4d)[_0x4ab83f(0x1d5)])updateBB('reinstall');else logger[_0x4ab83f(0x234)](_0x4ab83f(0x397));}),_0x407039['on'](_0x4593ab(0x185),_0x593b46=>{const _0x1b6c24=_0x4593ab;if(validateAccess(_0x593b46,_0x2a3a4d)['allow']){const _0x4b2782=getClient(_0x407039['id']);if(_0x4b2782)getBackupFiles(_0x4b2782[_0x1b6c24(0x2d2)]);else logger[_0x1b6c24(0x234)](_0x1b6c24(0x18b));}else logger[_0x1b6c24(0x234)](_0x1b6c24(0x222));}),_0x407039['on'](_0x4593ab(0x237),(_0x36b797,_0x2e28a3)=>{const _0x170776=_0x4593ab;if(validateAccess(_0x2e28a3,_0x2a3a4d)[_0x170776(0x1d5)])restoreBackupFile(_0x36b797);else logger[_0x170776(0x234)](_0x170776(0x210));}),_0x407039['on'](_0x4593ab(0x393),_0xab6817=>{const _0x2ed46b=_0x4593ab;if(validateAccess(_0xab6817,_0x2a3a4d)[_0x2ed46b(0x1d5)])getMessages();else logger['full'](_0x2ed46b(0x33d));}),_0x407039['on'](_0x4593ab(0x365),(_0x293304,_0x51b58b)=>{const _0x1feeb7=_0x4593ab;if(validateAccess(_0x51b58b,_0x2a3a4d)[_0x1feeb7(0x1d5)])confirmMessage(_0x293304);else logger[_0x1feeb7(0x234)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x407039['on'](_0x4593ab(0x360),_0x581023=>{const _0x3de43e=_0x4593ab;if(validateAccess(_0x581023,_0x2a3a4d)[_0x3de43e(0x1d5)]){if(devices[_0x2a3a4d][_0x3de43e(0x2b8)])clearTimeout(devices[_0x2a3a4d][_0x3de43e(0x2b8)]);if(devices[_0x2a3a4d]['pidExpireLogin'])clearTimeout(devices[_0x2a3a4d]['pidExpireLogin']);removeSocketListeners(getClient(_0x407039['id'])['uuid']),addBlacklist(_0x2a3a4d),devices[_0x2a3a4d][_0x3de43e(0x1d8)]=null,devices[_0x2a3a4d][_0x3de43e(0x263)]=null,devices[_0x2a3a4d][_0x3de43e(0x2c0)][_0x3de43e(0x27d)]=null,logger[_0x3de43e(0x32e)]('Logged\x20out\x20user\x20...'+_0x2a3a4d['slice'](-0x8)),io['to'](getClient(_0x407039['id'])[_0x3de43e(0x2d2)])[_0x3de43e(0x29b)]('status',{'access':{'allow':![],'reason':_0x3de43e(0x2a3),'token':null}});}else logger[_0x3de43e(0x234)](_0x3de43e(0x1d4));});}function initializeSocketBot(_0x55980b){const _0x578e05=_0x67c83f,_0x25534c=getClient(_0x55980b['id'])[_0x578e05(0x262)],_0x2277a4=getClient(_0x55980b['id'])[_0x578e05(0x2d2)];_0x55980b['on']('get-logs',(_0x5ab071,_0xbf72c5)=>{const _0x435bbc=_0x578e05;if(validateAccess(_0xbf72c5,_0x2277a4)[_0x435bbc(0x1d5)]){if(pid[_0x25534c])pid[_0x25534c][_0x435bbc(0x198)]({'function':_0x435bbc(0x249),'args':_0x5ab071});}else logger['full'](_0x435bbc(0x355));}),_0x55980b['on'](_0x578e05(0x200),(_0x4fc668,_0x2b6db9)=>{const _0x906008=_0x578e05;if(validateAccess(_0x2b6db9,_0x2277a4)[_0x906008(0x1d5)]){if(pid[_0x25534c])pid[_0x25534c][_0x906008(0x198)]({'function':'deleteHistoryAlerts','args':_0x4fc668});}else logger[_0x906008(0x234)](_0x906008(0x228));}),_0x55980b['on'](_0x578e05(0x2ea),(_0xe36e56,_0x242c05)=>{const _0x543447=_0x578e05;if(validateAccess(_0x242c05,_0x2277a4)['allow']){if(pid[_0x25534c])pid[_0x25534c][_0x543447(0x198)]({'function':_0x543447(0x1bb),'args':_0xe36e56});}else logger['full'](_0x543447(0x1e0));}),_0x55980b['on']('store-configuration',(_0x29f60e,_0x33aa3a)=>{const _0x23f18e=_0x578e05;if(validateAccess(_0x33aa3a,_0x2277a4)['allow']){if(pid[_0x25534c])pid[_0x25534c][_0x23f18e(0x198)]({'function':_0x23f18e(0x226),'args':_0x29f60e});}else logger[_0x23f18e(0x234)](_0x23f18e(0x1ad));}),_0x55980b['on'](_0x578e05(0x319),(_0x98d50d,_0x17e3f2)=>{const _0x368863=_0x578e05;if(validateAccess(_0x17e3f2,_0x2277a4)[_0x368863(0x1d5)]){if(pid[_0x25534c])pid[_0x25534c]['send']({'function':_0x368863(0x25b),'args':_0x98d50d});}else logger[_0x368863(0x234)](_0x368863(0x342));}),_0x55980b['on'](_0x578e05(0x398),(_0x3133e8,_0x494d19)=>{const _0x52809b=_0x578e05;if(validateAccess(_0x494d19,_0x2277a4)['allow']){if(pid[_0x25534c])pid[_0x25534c][_0x52809b(0x198)]({'function':'storeFiat','args':_0x3133e8});}else logger[_0x52809b(0x234)](_0x52809b(0x374));}),_0x55980b['on'](_0x578e05(0x28d),_0x465b93=>{const _0x5c3cfd=_0x578e05;if(validateAccess(_0x465b93,_0x2277a4)[_0x5c3cfd(0x1d5)]){if(pid[_0x25534c])pid[_0x25534c][_0x5c3cfd(0x198)]({'function':_0x5c3cfd(0x386),'args':null});}else logger[_0x5c3cfd(0x234)](_0x5c3cfd(0x1eb));}),_0x55980b['on'](_0x578e05(0x305),_0x273e96=>{const _0x4183b4=_0x578e05;if(validateAccess(_0x273e96,_0x2277a4)[_0x4183b4(0x1d5)]){if(pid[_0x25534c])pid[_0x25534c][_0x4183b4(0x198)]({'function':'getStartingBalances','args':null});}else logger[_0x4183b4(0x234)](_0x4183b4(0x2eb));}),_0x55980b['on'](_0x578e05(0x2cc),(_0x41bf9e,_0xc51b68)=>{const _0x401eff=_0x578e05;if(validateAccess(_0xc51b68,_0x2277a4)[_0x401eff(0x1d5)]){if(pid[_0x25534c])pid[_0x25534c][_0x401eff(0x198)]({'function':_0x401eff(0x235),'args':_0x41bf9e});}else logger[_0x401eff(0x234)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x55980b['on'](_0x578e05(0x1ea),_0x20d7db=>{const _0xcd5494=_0x578e05;if(validateAccess(_0x20d7db,_0x2277a4)['allow']){if(pid[_0x25534c])pid[_0x25534c][_0xcd5494(0x198)]({'function':_0xcd5494(0x2dd),'args':null});}else logger['full'](_0xcd5494(0x39a));}),_0x55980b['on']('show-config',_0x42e335=>{const _0x3c586b=_0x578e05;if(validateAccess(_0x42e335,_0x2277a4)['allow']){if(pid[_0x25534c])pid[_0x25534c][_0x3c586b(0x198)]({'function':_0x3c586b(0x22e),'args':null});}else logger[_0x3c586b(0x234)](_0x3c586b(0x1c5));}),_0x55980b['on'](_0x578e05(0x2d0),_0x5f5bc4=>{const _0x44ea55=_0x578e05;if(validateAccess(_0x5f5bc4,_0x2277a4)[_0x44ea55(0x1d5)])updateBB(_0x44ea55(0x33f));else logger[_0x44ea55(0x234)](_0x44ea55(0x243));}),_0x55980b['on']('get-messages',_0x2f8075=>{const _0x56b26e=_0x578e05;if(validateAccess(_0x2f8075,_0x2277a4)[_0x56b26e(0x1d5)])getMessages();else logger[_0x56b26e(0x234)](_0x56b26e(0x33d));}),_0x55980b['on'](_0x578e05(0x365),(_0x55a24c,_0x1162c0)=>{const _0x8cb997=_0x578e05;if(validateAccess(_0x1162c0,_0x2277a4)[_0x8cb997(0x1d5)])confirmMessage(_0x55a24c);else logger['full'](_0x8cb997(0x362));}),_0x55980b['on'](_0x578e05(0x360),_0x1aef7e=>{const _0x2d4a5e=_0x578e05;if(validateAccess(_0x1aef7e,_0x2277a4)[_0x2d4a5e(0x1d5)]){if(devices[_0x2277a4][_0x2d4a5e(0x2b8)])clearTimeout(devices[_0x2277a4][_0x2d4a5e(0x2b8)]);if(devices[_0x2277a4][_0x2d4a5e(0x22f)])clearTimeout(devices[_0x2277a4][_0x2d4a5e(0x22f)]);removeSocketListeners(getClient(_0x55980b['id'])[_0x2d4a5e(0x2d2)]),addBlacklist(_0x2277a4),devices[_0x2277a4]['telegramIpApproval']=null,devices[_0x2277a4][_0x2d4a5e(0x263)]=null,devices[_0x2277a4]['access']['token']=null,logger[_0x2d4a5e(0x32e)](_0x2d4a5e(0x2b6)+_0x2277a4['slice'](-0x8)),io['to'](getClient(_0x55980b['id'])['uuid'])[_0x2d4a5e(0x29b)](_0x2d4a5e(0x304),{'access':{'allow':![],'reason':_0x2d4a5e(0x2a3),'token':null}});}else logger[_0x2d4a5e(0x234)](_0x2d4a5e(0x1d4));});}function removeSocketListeners(_0x298c6b){getClientsWithUuid(_0x298c6b)['forEach'](_0xeb3c9c=>{const _0x2a2e15=_0x5c0c;getSocket(_0xeb3c9c['id'])[_0x2a2e15(0x1f2)]();});}function cleanSettings(){const _0x12f182=_0x67c83f;let _0x2f68e5=settings;return settings[_0x12f182(0x220)]&&settings[_0x12f182(0x220)]!=''&&(_0x2f68e5={..._0x2f68e5,'telegramToken':_0x12f182(0x2a4)}),settings[_0x12f182(0x28f)]&&settings[_0x12f182(0x28f)]!=''&&(_0x2f68e5={..._0x2f68e5,'bbPassword':_0x12f182(0x2a4)}),settings[_0x12f182(0x306)]&&settings[_0x12f182(0x306)]!=''&&(_0x2f68e5={..._0x2f68e5,'marketcapApi':_0x12f182(0x2a4)}),(settings['bbPassword']&&settings[_0x12f182(0x28f)]==_0x12f182(0x194)||settings['telegramToken']&&settings[_0x12f182(0x220)]=='***'||settings[_0x12f182(0x306)]&&settings[_0x12f182(0x306)]==_0x12f182(0x194))&&(_0x2f68e5={..._0x2f68e5,'restored':{'password':settings[_0x12f182(0x28f)]==_0x12f182(0x194),'telegram':settings['telegramToken']==_0x12f182(0x194),'marketcap':settings[_0x12f182(0x306)]==_0x12f182(0x194)}}),_0x2f68e5;}async function updateBB(_0x4317a2){const _0x1b342c=_0x67c83f;await backupConfigFiles(),installingUpdate=!![],config[_0x1b342c(0x39c)](_0x5c8a5f=>{restartBot(_0x5c8a5f['botID']);});if(_0x4317a2==_0x1b342c(0x33f))process['send']({'update':!![],'environment':environment},_0x1558f4=>{});else _0x4317a2==_0x1b342c(0x2ae)&&process['send']({'reinstall':!![],'environment':environment},_0x2f30ba=>{});}function startBot(_0x3f15aa,_0x489f9a,_0x36e34f){const _0x359653=_0x67c83f;if(debugging)_0x3f15aa['push']('-d');let _0x13a265=![];const _0x35d3f1=_0x3f15aa[0x0];_0x489f9a={..._0x489f9a,'stdio':[_0x359653(0x2c2),'inherit','inherit',_0x359653(0x1b7)]},pid[_0x35d3f1]=childProcess[_0x359653(0x1ac)](botfile,_0x3f15aa,_0x489f9a),pid[_0x35d3f1]['on'](_0x359653(0x345),_0x1ccb88=>{const _0x4ca8f9=_0x359653;switch(Object['keys'](_0x1ccb88)[0x0]){case _0x4ca8f9(0x209):updateBotName(_0x35d3f1,_0x1ccb88[_0x4ca8f9(0x209)]);break;case _0x4ca8f9(0x2e7):updateBotManager();break;case'status':updateStatus(_0x35d3f1,_0x1ccb88['status']);break;case _0x4ca8f9(0x36d):updateLive(_0x35d3f1,_0x1ccb88['live']);break;case'started':updateLive(_0x35d3f1,_0x1ccb88[_0x4ca8f9(0x291)]),io['to'](_0x35d3f1)[_0x4ca8f9(0x29b)](_0x4ca8f9(0x304),{'access':{'allow':![],'reason':_0x4ca8f9(0x2e4),'token':null}});break;case _0x4ca8f9(0x1c6):_0x1ccb88[_0x4ca8f9(0x1c6)]==_0x4ca8f9(0x2de)&&restartBot(_0x35d3f1);_0x1ccb88[_0x4ca8f9(0x1c6)]==_0x4ca8f9(0x311)&&toggleBot(_0x35d3f1,_0x4ca8f9(0x23a),'stopped');break;case _0x4ca8f9(0x2bc):sendTelegramBot(_0x35d3f1,_0x1ccb88[_0x4ca8f9(0x2bc)]);break;case _0x4ca8f9(0x2d5):sendTelegramMsg(_0x1ccb88[_0x4ca8f9(0x2d5)]);break;case _0x4ca8f9(0x30d):io['to'](_0x35d3f1)[_0x4ca8f9(0x29b)](_0x1ccb88[_0x4ca8f9(0x30d)],_0x1ccb88[_0x4ca8f9(0x2cd)]);break;}}),pid[_0x35d3f1]['on']('error',function(_0x183a06){if(_0x13a265)return;_0x13a265=!![],_0x36e34f(_0x183a06);}),pid[_0x35d3f1]['on']('exit',async function(_0x4daba3){const _0x130f11=_0x359653;if(terminating)return;if(installingUpdate){io[_0x130f11(0x271)]();return;}if(_0x13a265)return;_0x13a265=!![],_0x36e34f(null);const _0x207454=dbConfig['get'](_0x130f11(0x1ae))[_0x130f11(0x214)]({'botID':_0x35d3f1})[_0x130f11(0x229)]();_0x207454&&(_0x207454[_0x130f11(0x304)]==_0x130f11(0x26e)||_0x207454[_0x130f11(0x304)]=='new')&&(await sleep(0x3e8),updateLive(_0x35d3f1,'stopped'),logger[_0x130f11(0x234)]('Restarting\x20Bot\x20'+_0x35d3f1),startBot([_0x35d3f1,userID],{'cwd':bbpath},function(_0x52affb){if(_0x52affb)logger['full'](_0x52affb);}));});}function stopBot(_0x4070db){const _0x343c0c=_0x67c83f;getClientsWithBotID(_0x4070db)[_0x343c0c(0x39c)](_0x1270a0=>{const _0x166d4c=_0x343c0c;getSocket(_0x1270a0['id'])[_0x166d4c(0x2f2)](!![]),removeClient(_0x1270a0['id']);}),pid[_0x4070db]&&(pid[_0x4070db]['kill'](),pid[_0x4070db]=null);}function stopAllBots(){const _0x2fbdea=_0x67c83f;terminating=!![];const _0x5021e7=getEnabledBots();_0x5021e7[_0x2fbdea(0x39c)](_0x53f283=>{const _0xe3d8d6=_0x2fbdea;stopBot(_0x53f283[_0xe3d8d6(0x32c)]);});}function restartBot(_0x4ac928){if(pid[_0x4ac928])pid[_0x4ac928]['kill']();}function addBot(){const _0x5c6fb4=_0x67c83f;let _0x484ce5;for(let _0x1e372a=0x1;_0x1e372a<0x3e9;_0x1e372a++){_0x484ce5=_0x1e372a[_0x5c6fb4(0x2ec)]()[_0x5c6fb4(0x276)](0x3,'0');let _0x520ab0=config[_0x5c6fb4(0x214)](_0x443e51=>_0x443e51['botID']==_0x484ce5);if(!_0x520ab0)break;}if(_0x484ce5===_0x5c6fb4(0x2ff)){logger[_0x5c6fb4(0x234)](_0x5c6fb4(0x2a6));return;}logger[_0x5c6fb4(0x234)](_0x5c6fb4(0x395)+_0x484ce5),dbConfig['get'](_0x5c6fb4(0x1ae))[_0x5c6fb4(0x368)]({'botID':_0x484ce5,'botname':_0x5c6fb4(0x296)+_0x484ce5,'status':'new','live':''})['write'](),startBot([_0x484ce5,userID],{'cwd':bbpath},function(_0x1fe80e){const _0xb838d4=_0x5c6fb4;if(_0x1fe80e)logger[_0xb838d4(0x234)](_0x1fe80e);}),config=getConfiguration(),io['to'](_0x5c6fb4(0x2db))[_0x5c6fb4(0x29b)](_0x5c6fb4(0x1ae),config),broadcastToBots(_0x5c6fb4(0x1ae),JSON[_0x5c6fb4(0x303)](config));}function deleteBot(_0x456a1a){const _0x88bd55=_0x67c83f;getClientsWithBotID(_0x456a1a)[_0x88bd55(0x39c)](_0x3b26f4=>{getSocket(_0x3b26f4['id'])['disconnect'](!![]),removeClient(_0x3b26f4['id']);}),dbConfig[_0x88bd55(0x372)](_0x88bd55(0x1ae))[_0x88bd55(0x22b)]({'botID':_0x456a1a})['write'](),logger[_0x88bd55(0x234)](_0x88bd55(0x2fe)+_0x456a1a),stopBot(_0x456a1a);try{if(fs[_0x88bd55(0x1ed)](path[_0x88bd55(0x190)](configpath,_0x88bd55(0x31d)+_0x456a1a+_0x88bd55(0x2a8))))fs[_0x88bd55(0x2b3)](path[_0x88bd55(0x190)](configpath,_0x88bd55(0x31d)+_0x456a1a+_0x88bd55(0x2a8)));if(fs[_0x88bd55(0x1ed)](path[_0x88bd55(0x190)](configpath,_0x88bd55(0x31d)+_0x456a1a+_0x88bd55(0x285))))fs['unlinkSync'](path['join'](configpath,_0x88bd55(0x31d)+_0x456a1a+_0x88bd55(0x285)));if(fs['existsSync'](path[_0x88bd55(0x190)](configpath,_0x88bd55(0x31d)+_0x456a1a+'-performance.json')))fs[_0x88bd55(0x2b3)](path[_0x88bd55(0x190)](configpath,_0x88bd55(0x31d)+_0x456a1a+_0x88bd55(0x337)));if(fs[_0x88bd55(0x1ed)](path['join'](configpath,_0x88bd55(0x31d)+_0x456a1a+_0x88bd55(0x378))))fs[_0x88bd55(0x2b3)](path['join'](configpath,_0x88bd55(0x31d)+_0x456a1a+'-results.json'));}catch(_0x1f88ea){if(_0x1f88ea)logger[_0x88bd55(0x234)](_0x88bd55(0x25e),_0x1f88ea);}config=getConfiguration(),io['to'](_0x88bd55(0x2db))[_0x88bd55(0x29b)](_0x88bd55(0x1ae),config),broadcastToBots(_0x88bd55(0x1ae),JSON[_0x88bd55(0x303)](config));}function toggleBot(_0x1c0399,_0x4eeffc,_0x3924e1){const _0x53b8e0=_0x67c83f;dbConfig[_0x53b8e0(0x372)](_0x53b8e0(0x1ae))[_0x53b8e0(0x214)]({'botID':_0x1c0399})[_0x53b8e0(0x2ca)]({'status':_0x4eeffc})[_0x53b8e0(0x2ca)]({'live':_0x3924e1})['write']();if(_0x4eeffc=='enabled'||_0x4eeffc==_0x53b8e0(0x292))logger[_0x53b8e0(0x234)](_0x53b8e0(0x188)+_0x1c0399),startBot([_0x1c0399,userID],{'cwd':bbpath},function(_0x4b44e7){const _0x51e5bd=_0x53b8e0;if(_0x4b44e7)logger[_0x51e5bd(0x234)](_0x4b44e7);});else(_0x4eeffc=='disabled'||_0x4eeffc==_0x53b8e0(0x2dc))&&(logger[_0x53b8e0(0x234)](_0x53b8e0(0x1c7)+_0x1c0399),stopBot(_0x1c0399));config=getConfiguration(),io['to'](_0x53b8e0(0x2db))['emit'](_0x53b8e0(0x1ae),config),broadcastToBots(_0x53b8e0(0x1ae),JSON[_0x53b8e0(0x303)](config));}function toggleStatus(_0x44a3a6){const _0x4b97ae=_0x67c83f;let _0x490161=dbConfig[_0x4b97ae(0x372)]('bots')[_0x4b97ae(0x214)]({'botID':_0x44a3a6})[_0x4b97ae(0x229)](),_0x38f4da;if(_0x490161['status']===_0x4b97ae(0x26e))_0x38f4da=_0x4b97ae(0x23a);else{if(_0x490161[_0x4b97ae(0x304)]==='new')_0x38f4da='new-disabled';else{if(_0x490161[_0x4b97ae(0x304)]===_0x4b97ae(0x2dc))_0x38f4da=_0x4b97ae(0x292);else{if(_0x490161[_0x4b97ae(0x304)]===_0x4b97ae(0x23a))_0x38f4da=_0x4b97ae(0x26e);}}}return _0x38f4da;}function updateStatus(_0x37dee5,_0x4ea547){const _0x11d4dc=_0x67c83f;dbConfig['get'](_0x11d4dc(0x1ae))['find']({'botID':_0x37dee5})[_0x11d4dc(0x2ca)]({'status':_0x4ea547})[_0x11d4dc(0x356)](),config=getConfiguration(),io['to'](_0x11d4dc(0x2db))['emit'](_0x11d4dc(0x1ae),config),broadcastToBots(_0x11d4dc(0x1ae),JSON[_0x11d4dc(0x303)](config));}function updateLive(_0x50e9df,_0x37d1d5){const _0x4058d1=_0x67c83f;dbConfig[_0x4058d1(0x372)](_0x4058d1(0x1ae))[_0x4058d1(0x214)]({'botID':_0x50e9df})[_0x4058d1(0x2ca)]({'live':_0x37d1d5})[_0x4058d1(0x356)](),config=getConfiguration(),io['to'](_0x4058d1(0x2db))['emit'](_0x4058d1(0x1ae),config),broadcastToBots(_0x4058d1(0x1ae),JSON['stringify'](config));}function updateBotName(_0x3412ae,_0x9c7c61){const _0x4fb544=_0x67c83f;dbConfig[_0x4fb544(0x372)](_0x4fb544(0x1ae))[_0x4fb544(0x214)]({'botID':_0x3412ae})[_0x4fb544(0x2ca)]({'botname':_0x9c7c61})[_0x4fb544(0x356)](),config=getConfiguration(),io['to'](_0x4fb544(0x2db))['emit'](_0x4fb544(0x1ae),config),broadcastToBots('bots',JSON[_0x4fb544(0x303)](config));}function updateBotManager(){const _0x34952d=_0x67c83f;config=getConfiguration(),io['to']('botmanager')[_0x34952d(0x29b)](_0x34952d(0x1ae),config),broadcastToBots(_0x34952d(0x1ae),JSON['stringify'](config));}function toggleBotMode(_0x1b55c1){const _0xf61f25=_0x67c83f;if(pid[_0x1b55c1])pid[_0x1b55c1][_0xf61f25(0x198)]({'function':'toggleBotMode','args':null});else{const _0x4c4636=configpath+_0xf61f25(0x31d)+_0x1b55c1+'-config.json',_0x57071d=fs[_0xf61f25(0x1b5)](_0x4c4636),_0x32ad45=JSON['parse'](_0x57071d),_0xbc491c=_0x32ad45['bot'][0x0][_0xf61f25(0x22d)];_0x32ad45[_0xf61f25(0x262)][0x0][_0xf61f25(0x22d)]=!_0xbc491c;const _0x3d4c80=JSON['stringify'](_0x32ad45,null,0x2);fs[_0xf61f25(0x294)](_0x4c4636,_0x3d4c80),config=getConfiguration(),io['to']('botmanager')[_0xf61f25(0x29b)](_0xf61f25(0x1ae),config),broadcastToBots(_0xf61f25(0x1ae),JSON['stringify'](config));}}function validateTelegram(_0x71f15){const _0x5d53d3=_0x67c83f;if(_0x71f15[_0x5d53d3(0x207)][_0x5d53d3(0x36a)]!=settings['telegramUsername']&&'@'+_0x71f15['from'][_0x5d53d3(0x36a)]!=settings[_0x5d53d3(0x376)]||_0x71f15[_0x5d53d3(0x1aa)]['id']!=settings['telegramChatId'])return sendTelegram(_0x71f15[_0x5d53d3(0x1aa)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x5d53d3(0x338)}),![];return!![];}async function initTelegram(){const _0x5d698b=_0x67c83f;if(tgBot)tgBot[_0x5d698b(0x1c6)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x5d698b(0x220)]);let _0x3d05f2=_0x5d698b(0x1e5);_0x3d05f2+='\x0a',_0x3d05f2+=_0x5d698b(0x187),_0x3d05f2+=_0x5d698b(0x19f),_0x3d05f2+=_0x5d698b(0x1a8),_0x3d05f2+=_0x5d698b(0x196),_0x3d05f2+=_0x5d698b(0x323),_0x3d05f2+=_0x5d698b(0x205),_0x3d05f2+=_0x5d698b(0x381),_0x3d05f2+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3d05f2+=_0x5d698b(0x1b8),_0x3d05f2+=_0x5d698b(0x255),_0x3d05f2+=_0x5d698b(0x225),_0x3d05f2+=_0x5d698b(0x212),_0x3d05f2+=_0x5d698b(0x1c8),_0x3d05f2+=_0x5d698b(0x293);let _0x332a48=_0x5d698b(0x300);_0x332a48+='\x0a',_0x332a48+=_0x3d05f2,tgBot[_0x5d698b(0x34b)]((_0x8e756c,_0x25f0cd)=>{const _0xc1c03d=_0x5d698b;logger[_0xc1c03d(0x38b)](getTimeStamp()+_0xc1c03d(0x34f)),logger[_0xc1c03d(0x32e)](_0xc1c03d(0x287),_0x8e756c);}),tgBot[_0x5d698b(0x218)](async(_0x356d4d,_0x56a2c3)=>{const _0x30dae0=_0x5d698b;if(!(!settings[_0x30dae0(0x184)]&&_0x356d4d[_0x30dae0(0x33f)][_0x30dae0(0x345)]['text']==_0x30dae0(0x219))){if(!validateTelegram(_0x356d4d))return;}_0x56a2c3();}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x181),async _0x52ac3d=>{const _0x3c63f7=_0x5d698b;if(!settings[_0x3c63f7(0x184)])updateSetting(_0x3c63f7(0x184),_0x52ac3d[_0x3c63f7(0x1aa)]['id']);updateSetting(_0x3c63f7(0x1fa),!![]);if(!validateTelegram(_0x52ac3d))return;await sendTelegram(_0x52ac3d['chat']['id'],_0x332a48);}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x289),async _0x21f81a=>{const _0x42dcea=_0x5d698b;updateSetting(_0x42dcea(0x1fa),!![]),await sendTelegram(_0x21f81a[_0x42dcea(0x1aa)]['id'],'Notifications\x20enabled');}),tgBot['command'](_0x5d698b(0x1e7),async _0x2551a9=>{const _0x1a0284=_0x5d698b;await sendTelegram(_0x2551a9[_0x1a0284(0x1aa)]['id'],_0x1a0284(0x192)),updateSetting(_0x1a0284(0x1fa),![]);}),tgBot[_0x5d698b(0x1d6)]('config',async _0x38621b=>{const _0x57e6cb=_0x5d698b,_0x3f1659=Markup[_0x57e6cb(0x1ca)]([Markup[_0x57e6cb(0x322)][_0x57e6cb(0x313)](_0x57e6cb(0x1c4),_0x57e6cb(0x35e)),Markup['button'][_0x57e6cb(0x313)](_0x57e6cb(0x366),_0x57e6cb(0x2f4)),Markup[_0x57e6cb(0x322)][_0x57e6cb(0x313)](_0x57e6cb(0x34a),_0x57e6cb(0x195))]);_0x38621b['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x3f1659);}),tgBot[_0x5d698b(0x35d)](_0x5d698b(0x35e),async _0x46b36e=>{const _0x4d0705=_0x5d698b;_0x46b36e[_0x4d0705(0x364)](),updateSetting(_0x4d0705(0x2b5),_0x4d0705(0x1ef)),updateSetting(_0x4d0705(0x1fa),!![]),await sendTelegram(_0x46b36e['chat']['id'],_0x4d0705(0x28a));}),tgBot[_0x5d698b(0x35d)](_0x5d698b(0x2f4),async _0x547b9a=>{const _0x257d4e=_0x5d698b;_0x547b9a[_0x257d4e(0x364)](),updateSetting('telegramEvents','alerts'),updateSetting(_0x257d4e(0x1fa),!![]),await sendTelegram(_0x547b9a['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x5d698b(0x35d)](_0x5d698b(0x195),async _0x1fc905=>{const _0x167074=_0x5d698b;_0x1fc905[_0x167074(0x364)](),updateSetting('telegramEvents',_0x167074(0x270)),updateSetting(_0x167074(0x1fa),!![]),await sendTelegram(_0x1fc905['chat']['id'],_0x167074(0x2a5));}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x304),async _0x3f6407=>{const _0x5b9632=_0x5d698b,_0x5c6df9=getBotsWithMode();let _0x5f2cbb=_0x5b9632(0x37c);config[_0x5b9632(0x39c)](_0x3015f3=>{const _0x217f67=_0x5b9632,_0x180719=_0x5c6df9[_0x217f67(0x214)](_0x5a7dda=>_0x5a7dda['botID']==_0x3015f3[_0x217f67(0x32c)])['mode'];_0x5f2cbb+=_0x217f67(0x296)+_0x3015f3['botID']+':\x20'+_0x3015f3[_0x217f67(0x304)]+_0x217f67(0x2be)+_0x180719+_0x217f67(0x2be)+_0x3015f3['live']+'\x0a';}),_0x5f2cbb+='\x0a',_0x5f2cbb+=_0x5b9632(0x2b0),_0x5f2cbb+=!settings[_0x5b9632(0x1fa)]?_0x5b9632(0x1fc):'Notifications\x20enabled\x0a',_0x5f2cbb+=settings[_0x5b9632(0x1fa)]?settings['telegramEvents']==_0x5b9632(0x270)?_0x5b9632(0x19a):_0x5b9632(0x1a1)+settings[_0x5b9632(0x2b5)]+_0x5b9632(0x2ce):'',await sendTelegram(_0x3f6407[_0x5b9632(0x1aa)]['id'],_0x5f2cbb,{'parse_mode':_0x5b9632(0x338)});}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x2de),async _0x4d385c=>{const _0xcc9577=_0x5d698b,_0x2e5e01=getEnabledBots();if(_0x2e5e01[_0xcc9577(0x1a7)]==0x0)await sendTelegram(_0x4d385c['chat']['id'],_0xcc9577(0x31a));else{if(_0x2e5e01[_0xcc9577(0x1a7)]>0x1)_0x2e5e01[_0xcc9577(0x368)]({'botID':_0xcc9577(0x270)});let _0x10853e=[],_0x17c6c7=[];const _0xf0355c=_0x2e5e01['length']%0x4==0x0||_0x2e5e01[_0xcc9577(0x1a7)]%0x4==0x3||_0x2e5e01[_0xcc9577(0x1a7)]%0x3==0x1?0x4:0x3;let _0xe96cbf=0x0;_0x2e5e01[_0xcc9577(0x39c)]((_0x3c43ec,_0x3b9774)=>{const _0x243671=_0xcc9577;if(_0x3b9774%_0xf0355c==0x0)_0x17c6c7=[];_0x17c6c7[_0x243671(0x368)](Markup[_0x243671(0x322)][_0x243671(0x313)](_0x3c43ec[_0x243671(0x32c)]==_0x243671(0x270)?_0x243671(0x1b3):_0x243671(0x296)+_0x3c43ec[_0x243671(0x32c)],_0x243671(0x2d9)+_0x3c43ec[_0x243671(0x32c)])),_0x3b9774%_0xf0355c==0x0&&(_0x10853e[_0xe96cbf]=_0x17c6c7,_0xe96cbf++);});const _0x5e461b=Markup[_0xcc9577(0x1ca)](_0x10853e);_0x4d385c[_0xcc9577(0x299)](_0xcc9577(0x1a5),_0x5e461b);}}),tgBot[_0x5d698b(0x35d)](/restart_(.+)/,async _0x29becb=>{const _0x4eff96=_0x5d698b,_0x411043=_0x29becb[_0x4eff96(0x353)][0x1];_0x29becb[_0x4eff96(0x364)](),_0x411043=='all'?config[_0x4eff96(0x39c)](_0x326be6=>{const _0x20890d=_0x4eff96;restartBot(_0x326be6[_0x20890d(0x32c)]);}):restartBot(_0x411043);}),tgBot['command']('on',async _0x1e0f91=>{const _0x351a38=_0x5d698b,_0x247a08=getDisabledBots();if(_0x247a08[_0x351a38(0x1a7)]==0x0)await sendTelegram(_0x1e0f91[_0x351a38(0x1aa)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x247a08['length']>0x1)_0x247a08['push']({'botID':'all'});let _0x317cf0=[],_0x2c15a9=[];const _0x20590d=_0x247a08[_0x351a38(0x1a7)]%0x4==0x0||_0x247a08[_0x351a38(0x1a7)]%0x4==0x3||_0x247a08[_0x351a38(0x1a7)]%0x3==0x1?0x4:0x3;let _0x305c75=0x0;_0x247a08['forEach']((_0x733282,_0x182d23)=>{const _0x1e17ca=_0x351a38;if(_0x182d23%_0x20590d==0x0)_0x2c15a9=[];_0x2c15a9[_0x1e17ca(0x368)](Markup['button'][_0x1e17ca(0x313)](_0x733282[_0x1e17ca(0x32c)]=='all'?_0x1e17ca(0x1b3):_0x1e17ca(0x296)+_0x733282[_0x1e17ca(0x32c)],_0x1e17ca(0x363)+_0x733282['botID'])),_0x182d23%_0x20590d==0x0&&(_0x317cf0[_0x305c75]=_0x2c15a9,_0x305c75++);});const _0x2fb511=Markup[_0x351a38(0x1ca)](_0x317cf0);_0x1e0f91[_0x351a38(0x299)](_0x351a38(0x2a0),_0x2fb511);}}),tgBot[_0x5d698b(0x35d)](/on_(.+)/,async _0x4d97a8=>{const _0x907bff=_0x5d698b,_0x56d374=_0x4d97a8['match'][0x1];_0x4d97a8[_0x907bff(0x364)]();if(_0x56d374==_0x907bff(0x270)){const _0x17afbe=getDisabledBots();await sendTelegram(_0x4d97a8[_0x907bff(0x1aa)]['id'],_0x907bff(0x227)),_0x17afbe[_0x907bff(0x39c)](_0x22cf38=>{const _0x3bfc39=_0x907bff;if(_0x22cf38[_0x3bfc39(0x32c)]!='all')toggleBot(_0x22cf38[_0x3bfc39(0x32c)],toggleStatus(_0x22cf38[_0x3bfc39(0x32c)]),_0x3bfc39(0x269));});}else await sendTelegram(_0x4d97a8['chat']['id'],_0x907bff(0x330)+_0x56d374),toggleBot(_0x56d374,toggleStatus(_0x56d374),'stopped');}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x1ee),async _0x58f5fb=>{const _0x379010=_0x5d698b,_0x3eb80a=getEnabledBots();if(_0x3eb80a['length']==0x0)await sendTelegram(_0x58f5fb[_0x379010(0x1aa)]['id'],_0x379010(0x31a));else{if(_0x3eb80a[_0x379010(0x1a7)]>0x1)_0x3eb80a[_0x379010(0x368)]({'botID':_0x379010(0x270)});let _0x5f0ef9=[],_0x5e99a5=[];const _0x1d62e9=_0x3eb80a[_0x379010(0x1a7)]%0x4==0x0||_0x3eb80a[_0x379010(0x1a7)]%0x4==0x3||_0x3eb80a['length']%0x3==0x1?0x4:0x3;let _0x39505b=0x0;_0x3eb80a[_0x379010(0x39c)]((_0x5c202c,_0x446fe6)=>{const _0x148bbb=_0x379010;if(_0x446fe6%_0x1d62e9==0x0)_0x5e99a5=[];_0x5e99a5[_0x148bbb(0x368)](Markup[_0x148bbb(0x322)][_0x148bbb(0x313)](_0x5c202c[_0x148bbb(0x32c)]==_0x148bbb(0x270)?_0x148bbb(0x1b3):'Bot\x20'+_0x5c202c[_0x148bbb(0x32c)],_0x148bbb(0x21f)+_0x5c202c[_0x148bbb(0x32c)])),_0x446fe6%_0x1d62e9==0x0&&(_0x5f0ef9[_0x39505b]=_0x5e99a5,_0x39505b++);});const _0x4f382d=Markup['inlineKeyboard'](_0x5f0ef9);_0x58f5fb[_0x379010(0x299)](_0x379010(0x208),_0x4f382d);}}),tgBot['action'](/off_(.+)/,async _0x18e93f=>{const _0x2ad4d5=_0x5d698b,_0x569650=_0x18e93f['match'][0x1];_0x18e93f[_0x2ad4d5(0x364)]();if(_0x569650==_0x2ad4d5(0x270)){const _0x11c5ba=getEnabledBots();await sendTelegram(_0x18e93f[_0x2ad4d5(0x1aa)]['id'],_0x2ad4d5(0x2b2)),_0x11c5ba[_0x2ad4d5(0x39c)](_0x38e78c=>{const _0x159300=_0x2ad4d5;if(_0x38e78c['botID']!=_0x159300(0x270))toggleBot(_0x38e78c[_0x159300(0x32c)],toggleStatus(_0x38e78c[_0x159300(0x32c)]),'stopped');});}else await sendTelegram(_0x18e93f['chat']['id'],_0x2ad4d5(0x1db)+_0x569650),toggleBot(_0x569650,toggleStatus(_0x569650),_0x2ad4d5(0x269));}),tgBot['command'](_0x5d698b(0x2bf),async _0x26c8b9=>{const _0x38e5e8=_0x5d698b,_0x202439=getEnabledBots();if(_0x202439[_0x38e5e8(0x1a7)]==0x0)await sendTelegram(_0x26c8b9['chat']['id'],_0x38e5e8(0x31a));else{if(_0x202439[_0x38e5e8(0x1a7)]>0x1){let _0xe47b93=[],_0x305028=[];const _0x2e08d9=_0x202439['length']%0x4==0x0||_0x202439[_0x38e5e8(0x1a7)]%0x4==0x3||_0x202439['length']%0x3==0x1?0x4:0x3;let _0x1612d9=0x0;_0x202439[_0x38e5e8(0x39c)]((_0xb25d5,_0x4e984d)=>{const _0x53b078=_0x38e5e8;if(_0x4e984d%_0x2e08d9==0x0)_0x305028=[];_0x305028[_0x53b078(0x368)](Markup['button'][_0x53b078(0x313)]('Bot\x20'+_0xb25d5[_0x53b078(0x32c)],'metrics_'+_0xb25d5[_0x53b078(0x32c)])),_0x4e984d%_0x2e08d9==0x0&&(_0xe47b93[_0x1612d9]=_0x305028,_0x1612d9++);});const _0x38a837=Markup[_0x38e5e8(0x1ca)](_0xe47b93);_0x26c8b9[_0x38e5e8(0x299)](_0x38e5e8(0x257),_0x38a837);}else{const _0x47deb7=_0x202439[0x0][_0x38e5e8(0x32c)];if(pid[_0x47deb7])pid[_0x47deb7][_0x38e5e8(0x198)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x5d698b(0x35d)](/metrics_(.+)/,async _0x715b1=>{const _0x45304d=_0x5d698b,_0x3f5099=_0x715b1['match'][0x1];_0x715b1[_0x45304d(0x364)]();if(pid[_0x3f5099])pid[_0x3f5099][_0x45304d(0x198)]({'function':_0x45304d(0x1dc),'args':null});}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x2c9),async _0x7e2355=>{const _0x295703=_0x5d698b,_0x2075d0=getEnabledBots();if(_0x2075d0[_0x295703(0x1a7)]==0x0)await sendTelegram(_0x7e2355[_0x295703(0x1aa)]['id'],_0x295703(0x31a));else{if(_0x2075d0[_0x295703(0x1a7)]>0x1){let _0x2c0ddd=[],_0xbfa212=[];const _0x4db9d4=_0x2075d0[_0x295703(0x1a7)]%0x4==0x0||_0x2075d0[_0x295703(0x1a7)]%0x4==0x3||_0x2075d0[_0x295703(0x1a7)]%0x3==0x1?0x4:0x3;let _0x32a92d=0x0;_0x2075d0[_0x295703(0x39c)]((_0x12d844,_0x37a46f)=>{const _0x24ec2=_0x295703;if(_0x37a46f%_0x4db9d4==0x0)_0xbfa212=[];_0xbfa212[_0x24ec2(0x368)](Markup['button'][_0x24ec2(0x313)](_0x24ec2(0x296)+_0x12d844[_0x24ec2(0x32c)],_0x24ec2(0x2b9)+_0x12d844['botID'])),_0x37a46f%_0x4db9d4==0x0&&(_0x2c0ddd[_0x32a92d]=_0xbfa212,_0x32a92d++);});const _0x27b954=Markup['inlineKeyboard'](_0x2c0ddd);_0x7e2355[_0x295703(0x299)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x27b954);}else{const _0x58710e=_0x2075d0[0x0][_0x295703(0x32c)];if(pid[_0x58710e])pid[_0x58710e][_0x295703(0x198)]({'function':_0x295703(0x1bf),'args':null});}}}),tgBot[_0x5d698b(0x35d)](/portfolio_(.+)/,async _0x35eafc=>{const _0x4fd041=_0x5d698b,_0x2ba757=_0x35eafc[_0x4fd041(0x353)][0x1];_0x35eafc[_0x4fd041(0x364)]();if(pid[_0x2ba757])pid[_0x2ba757][_0x4fd041(0x198)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x33f),async _0x55ee93=>{const _0x5857e5=_0x5d698b;await getMessages();if(!updateAvailable)await sendTelegram(_0x55ee93['chat']['id'],_0x5857e5(0x27f));else{if(!validInstallation)await sendTelegram(_0x55ee93[_0x5857e5(0x1aa)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x5ef745=Markup[_0x5857e5(0x1ca)]([Markup[_0x5857e5(0x322)]['callback'](_0x5857e5(0x20b),_0x5857e5(0x2ee)),Markup[_0x5857e5(0x322)][_0x5857e5(0x313)]('No','update_no')]);_0x55ee93[_0x5857e5(0x299)](_0x5857e5(0x224),_0x5ef745);}}}),tgBot['action'](/update_(.+)/,async _0x3dd09a=>{const _0x153f0d=_0x5d698b,_0x555021=_0x3dd09a['match'][0x1];_0x3dd09a['editMessageReplyMarkup'](),_0x555021==_0x153f0d(0x1ce)&&(await sendTelegram(_0x3dd09a[_0x153f0d(0x1aa)]['id'],_0x153f0d(0x37d)),updateBB('update')),_0x555021=='no'&&await sendTelegram(_0x3dd09a[_0x153f0d(0x1aa)]['id'],_0x153f0d(0x36c));}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x2ae),async _0x279237=>{const _0x29e4d6=_0x5d698b;if(!validInstallation)await sendTelegram(_0x279237[_0x29e4d6(0x1aa)]['id'],_0x29e4d6(0x2e8));else{const _0x378812=Markup[_0x29e4d6(0x1ca)]([Markup[_0x29e4d6(0x322)]['callback'](_0x29e4d6(0x20b),_0x29e4d6(0x282)),Markup[_0x29e4d6(0x322)][_0x29e4d6(0x313)]('No',_0x29e4d6(0x21c))]);_0x279237['reply'](_0x29e4d6(0x2af),_0x378812);}}),tgBot[_0x5d698b(0x35d)](/reinstall_(.+)/,async _0xdc805b=>{const _0x259857=_0x5d698b,_0x25d6b7=_0xdc805b[_0x259857(0x353)][0x1];_0xdc805b['editMessageReplyMarkup'](),_0x25d6b7==_0x259857(0x1ce)&&(await sendTelegram(_0xdc805b['chat']['id'],_0x259857(0x34e)),updateBB(_0x259857(0x2ae))),_0x25d6b7=='no'&&await sendTelegram(_0xdc805b[_0x259857(0x1aa)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x2fc),async _0x1db7fe=>{const _0x526c7e=_0x5d698b,_0x51b38e=getBotsWithMode();if(_0x51b38e[_0x526c7e(0x1a7)]==0x0)await sendTelegram(_0x1db7fe[_0x526c7e(0x1aa)]['id'],_0x526c7e(0x31a));else{let _0x53dae4=[],_0x2ff27c=[];const _0xf5c271=0x2;let _0x254752=0x0;_0x51b38e['forEach']((_0x3f8705,_0x544545)=>{const _0x527165=_0x526c7e;if(_0x544545%_0xf5c271==0x0)_0x2ff27c=[];_0x2ff27c[_0x527165(0x368)](Markup['button'][_0x527165(0x313)]('Bot\x20'+_0x3f8705[_0x527165(0x32c)]+'\x20('+_0x3f8705[_0x527165(0x21d)]+')',_0x527165(0x284)+_0x3f8705['botID'])),_0x544545%_0xf5c271==0x0&&(_0x53dae4[_0x254752]=_0x2ff27c,_0x254752++);});const _0x228737=Markup[_0x526c7e(0x1ca)](_0x53dae4);_0x1db7fe['reply'](_0x526c7e(0x35b),_0x228737);}}),tgBot[_0x5d698b(0x35d)](/toggle_(.+)/,async _0x587807=>{const _0x205281=_0x5d698b,_0x3ad9d0=_0x587807[_0x205281(0x353)][0x1];_0x587807['editMessageReplyMarkup']();const _0x56e989=getBotsWithMode(),_0x465220=_0x56e989['find'](_0x42a9b1=>_0x42a9b1[_0x205281(0x32c)]==_0x3ad9d0),_0x27570a=_0x465220['mode']==_0x205281(0x233)?'manual':_0x205281(0x233);await sendTelegram(_0x587807[_0x205281(0x1aa)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3ad9d0+_0x205281(0x19b)+_0x27570a+_0x205281(0x1b4)),toggleBotMode(_0x3ad9d0);}),tgBot['command']('names',async _0x3dbc87=>{const _0x2b8d04=_0x5d698b;let _0xedf57d='';config['forEach'](_0xcda122=>{const _0x1978a9=_0x5c0c;_0xedf57d+=_0x1978a9(0x296)+_0xcda122[_0x1978a9(0x32c)]+':\x20'+_0xcda122[_0x1978a9(0x209)]+'\x0a';}),await sendTelegram(_0x3dbc87[_0x2b8d04(0x1aa)]['id'],_0xedf57d,{'parse_mode':_0x2b8d04(0x338)});}),tgBot[_0x5d698b(0x1d6)](_0x5d698b(0x1e1),async _0x5977a2=>{await sendTelegram(_0x5977a2['chat']['id'],_0x3d05f2);}),process[_0x5d698b(0x24b)](_0x5d698b(0x307),()=>tgBot[_0x5d698b(0x1c6)](_0x5d698b(0x307))),process[_0x5d698b(0x24b)]('SIGTERM',()=>tgBot[_0x5d698b(0x1c6)](_0x5d698b(0x328))),tgBot['launch']();}}function disableTelegram(){const _0x251029=_0x67c83f;tgBot&&tgBot[_0x251029(0x1c6)]();}async function sendTelegram(_0x1114b9,_0x40fbf5,_0x3959db){const _0x1f05d7=_0x67c83f;_0x3959db={..._0x3959db,'disable_web_page_preview':!![]};try{await tgBot[_0x1f05d7(0x2bc)][_0x1f05d7(0x1df)](_0x1114b9,_0x40fbf5,_0x3959db);}catch(_0x55dad9){console[_0x1f05d7(0x22c)](_0x1f05d7(0x24c),_0x55dad9);}}async function sendTelegramBot(_0x2bb8b6,_0x3779bc){const _0x5b09a9=_0x67c83f;if(settings['telegramEnabled']){if(settings[_0x5b09a9(0x2b5)]=='all'||(_0x3779bc[_0x5b09a9(0x373)]==_0x5b09a9(0x343)||_0x3779bc[_0x5b09a9(0x373)]=='warning'||_0x3779bc[_0x5b09a9(0x373)]==_0x5b09a9(0x327))&&settings[_0x5b09a9(0x2b5)]==_0x5b09a9(0x351)||_0x3779bc[_0x5b09a9(0x373)]==_0x5b09a9(0x2f8)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x5b09a9(0x184)]){if(_0x3779bc[_0x5b09a9(0x25d)])await sendTelegram(settings['telegramChatId'],_0x3779bc[_0x5b09a9(0x209)]+_0x5b09a9(0x267)+_0x3779bc[_0x5b09a9(0x1a2)]);else await sendTelegram(settings[_0x5b09a9(0x184)],_0x5b09a9(0x296)+_0x2bb8b6+'\x20>\x20'+_0x3779bc[_0x5b09a9(0x1a2)]);}}}}async function sendTelegramMsg(_0x28ae1b,_0x4a4589=_0x67c83f(0x338)){const _0x437670=_0x67c83f;return settings[_0x437670(0x1fa)]&&tgBot&&settings[_0x437670(0x184)]?(await sendTelegram(settings[_0x437670(0x184)],_0x28ae1b,{'parse_mode':_0x4a4589}),!![]):![];}function getDeviceWithIp(_0x40b80c){const _0x2ddfc7=_0x67c83f;return devices[_0x2ddfc7(0x214)](_0x541ef2=>_0x541ef2['ip']===_0x40b80c);}async function temporaryAccess2FA(_0x326e18,_0x4b3d00){const _0x50bba9=_0x67c83f;let _0x24fef8=new Date(),_0x27aba7=![];if(lastIpApproval){if(_0x24fef8-lastIpApproval<0x1388)_0x27aba7=!![];}lastIpApproval=new Date();if(_0x27aba7)return;if(tgBot&&settings[_0x50bba9(0x184)]){const _0x5cda0e=uuidRandom();tmpStorage[_0x5cda0e]={'uuid':_0x326e18,'externalip':_0x4b3d00};const _0xe90919=Markup['inlineKeyboard']([Markup[_0x50bba9(0x322)][_0x50bba9(0x313)](_0x50bba9(0x2da),_0x50bba9(0x2e3)+_0x5cda0e),Markup[_0x50bba9(0x322)][_0x50bba9(0x313)](_0x50bba9(0x29d),_0x50bba9(0x1b9)+_0x5cda0e),Markup[_0x50bba9(0x322)][_0x50bba9(0x313)](_0x50bba9(0x1f4),_0x50bba9(0x251)+_0x5cda0e),Markup[_0x50bba9(0x322)][_0x50bba9(0x313)](_0x50bba9(0x221),'tempaccess_reject_'+_0x5cda0e)]);await sendTelegram(settings[_0x50bba9(0x184)],_0x50bba9(0x27b)+normalizeIP(_0x4b3d00)[_0x50bba9(0x380)]+'\x20?',_0xe90919),tgBot[_0x50bba9(0x35d)](/tempaccess_(.+)_(.+)/,async _0x5ec1c2=>{const _0x13b6f6=_0x50bba9,_0x4d00f7=_0x5ec1c2[_0x13b6f6(0x353)][0x1],_0x11e842=_0x5ec1c2[_0x13b6f6(0x353)][0x2],{uuid:_0x50f680,externalip:_0x2a921d}=tmpStorage[_0x11e842];delete tmpStorage[_0x11e842],_0x5ec1c2['editMessageReplyMarkup'](),devices[_0x50f680]['telegramIpApproval']={'clientip':_0x2a921d,'timestamp':new Date()[_0x13b6f6(0x25c)](),'expiry':_0x4d00f7},_0x4d00f7!='reject'?(await sendTelegram(_0x5ec1c2[_0x13b6f6(0x1aa)]['id'],_0x13b6f6(0x23c)+_0x4d00f7+_0x13b6f6(0x1e2),{'parse_mode':_0x13b6f6(0x338)}),io['to'](_0x50f680)[_0x13b6f6(0x29b)]('status',{'access':{'allow':![],'reason':_0x13b6f6(0x2e4),'token':null}})):(await sendTelegram(_0x5ec1c2[_0x13b6f6(0x1aa)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x50f680)[_0x13b6f6(0x29b)]('status',{'access':{'allow':![],'reason':_0x13b6f6(0x273),'token':null}}));});}}async function loginAccess2FA(_0x3da638,_0xaf697e){const _0x2d09bf=_0x67c83f;if(tgBot&&settings['telegramChatId']){const _0x340e0d=uuidRandom();tmpStorage[_0x340e0d]={'uuid':_0x3da638,'externalip':_0xaf697e};const _0x35b63b=Markup['inlineKeyboard']([Markup[_0x2d09bf(0x322)]['callback'](_0x2d09bf(0x20e),_0x2d09bf(0x1bd)+loginExpiry+'_'+_0x340e0d),Markup[_0x2d09bf(0x322)]['callback']('reject',_0x2d09bf(0x283)+_0x340e0d)]);await sendTelegram(settings['telegramChatId'],_0x2d09bf(0x332)+normalizeIP(_0xaf697e)[_0x2d09bf(0x380)]+'\x20?',_0x35b63b),tgBot[_0x2d09bf(0x35d)](/login2fa_(.+)_(.+)/,async _0x2e43cf=>{const _0x112a1d=_0x2d09bf,_0x2d76d1=_0x2e43cf[_0x112a1d(0x353)][0x1],_0x153d2b=_0x2e43cf['match'][0x2],{uuid:_0x56ab8b,externalip:_0xb19fc8}=tmpStorage[_0x153d2b];delete tmpStorage[_0x153d2b],_0x2e43cf[_0x112a1d(0x364)](),devices[_0x56ab8b][_0x112a1d(0x263)]={'clientip':_0xb19fc8,'timestamp':new Date()[_0x112a1d(0x25c)](),'expiry':_0x2d76d1},_0x2d76d1!=_0x112a1d(0x221)?(await sendTelegram(_0x2e43cf[_0x112a1d(0x1aa)]['id'],'Login\x20accepted',{'parse_mode':_0x112a1d(0x338)}),io['to'](_0x56ab8b)[_0x112a1d(0x29b)](_0x112a1d(0x304),{'access':{'allow':![],'reason':_0x112a1d(0x2e4),'token':null}})):(await sendTelegram(_0x2e43cf[_0x112a1d(0x1aa)]['id'],_0x112a1d(0x183)),io['to'](_0x56ab8b)[_0x112a1d(0x29b)](_0x112a1d(0x304),{'access':{'allow':![],'reason':_0x112a1d(0x26c),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x116fe4=_0x67c83f;return dbConfig[_0x116fe4(0x372)](_0x116fe4(0x1ae))[_0x116fe4(0x316)](_0x116fe4(0x32c))[_0x116fe4(0x238)]({'status':_0x116fe4(0x26e)})[_0x116fe4(0x229)]()||[];}function getDisabledBots(){const _0x2f1f44=_0x67c83f;return dbConfig[_0x2f1f44(0x372)](_0x2f1f44(0x1ae))[_0x2f1f44(0x316)](_0x2f1f44(0x32c))['filter']({'status':_0x2f1f44(0x23a)})[_0x2f1f44(0x229)]()||[];}function getBotAttributes(_0x306d3f){const _0x41ab9c=_0x67c83f;let _0x11e30c={};const _0x1dcc67=configpath+_0x41ab9c(0x31d)+_0x306d3f+'-config.json',_0x50993b=fs[_0x41ab9c(0x1ed)](_0x1dcc67);if(_0x50993b){const _0x3f53ce=fs[_0x41ab9c(0x1b5)](_0x1dcc67);try{const _0x2d1b25=JSON[_0x41ab9c(0x277)](_0x3f53ce),_0x8b11c7=_0x2d1b25?_0x2d1b25[_0x41ab9c(0x262)][0x0][_0x41ab9c(0x22d)]:![];_0x11e30c[_0x41ab9c(0x21d)]=_0x8b11c7?'auto':'manual',_0x11e30c[_0x41ab9c(0x209)]=_0x2d1b25?_0x2d1b25[_0x41ab9c(0x262)][0x0]['botname']:'Bot\x20'+_0x306d3f;}catch(_0x4a1d14){_0x11e30c['mode']='manual',_0x11e30c[_0x41ab9c(0x209)]=_0x41ab9c(0x296)+_0x306d3f;}}else _0x11e30c[_0x41ab9c(0x21d)]=_0x41ab9c(0x21a),_0x11e30c[_0x41ab9c(0x209)]='Bot\x20'+_0x306d3f;return _0x11e30c;}function _0x5c0c(_0x637910,_0x2677a1){const _0x20ea39=_0x5b22();return _0x5c0c=function(_0x3b495e,_0x399b4f){_0x3b495e=_0x3b495e-0x181;let _0x5b22a9=_0x20ea39[_0x3b495e];return _0x5b22a9;},_0x5c0c(_0x637910,_0x2677a1);}function getBotsWithMode(){const _0x5c5320=_0x67c83f,_0x4336a2=dbConfig['get']('bots')[_0x5c5320(0x316)]('botID')[_0x5c5320(0x229)]()||[];return _0x4336a2[_0x5c5320(0x39c)](_0x351120=>{const _0x1291b4=_0x5c5320;let _0x980eef=getBotAttributes(_0x351120[_0x1291b4(0x32c)]);_0x351120[_0x1291b4(0x21d)]=_0x980eef['mode'];}),_0x4336a2;}function getBotExchanges(){const _0x56e527=_0x67c83f;let _0x2a1c3c=[];const _0x3c70fc=dbConfig[_0x56e527(0x372)](_0x56e527(0x1ae))[_0x56e527(0x316)]('botID')[_0x56e527(0x229)]()||[];_0x3c70fc['forEach'](_0x293cac=>{const _0x39e221=_0x56e527;if(_0x293cac['status']==_0x39e221(0x26e)){const _0x18b9c3=configpath+_0x39e221(0x31d)+_0x293cac[_0x39e221(0x32c)]+'-config.json',_0x2443dd=fs['existsSync'](_0x18b9c3);let _0x8a8860;if(_0x2443dd){const _0x26465b=fs[_0x39e221(0x1b5)](_0x18b9c3);try{const _0xe6441e=JSON[_0x39e221(0x277)](_0x26465b);_0x8a8860=_0xe6441e?_0xe6441e[_0x39e221(0x262)][0x0][_0x39e221(0x1cf)]:null;}catch(_0x5c938c){}}if(_0x8a8860)_0x2a1c3c[_0x39e221(0x368)](_0x8a8860);}});const _0xc48133=[...new Set(_0x2a1c3c)][_0x56e527(0x191)]();return _0xc48133;}async function initUser(){const _0x34acbe=_0x67c83f;if(!settings[_0x34acbe(0x2f7)]){const _0x1b2885=uuidRandom();mixpanel[_0x34acbe(0x29c)](_0x1b2885),updateSetting(_0x34acbe(0x2f7),_0x1b2885);}}async function initSecure(){const _0x322aa3=_0x67c83f;let _0x245c99=getSecure();if(!_0x245c99[_0x322aa3(0x36b)](_0x322aa3(0x1f0))){let _0x31b5e=await generateKeys();_0x245c99[_0x322aa3(0x36f)]=_0x31b5e[_0x322aa3(0x36f)],_0x245c99[_0x322aa3(0x2fa)]=_0x31b5e['privateKey'],_0x245c99['secret']=crypto[_0x322aa3(0x2d4)](0x20)[_0x322aa3(0x2ec)](_0x322aa3(0x31b));;storeSecure(_0x245c99);}}function getSettings(){const _0x19451c=_0x67c83f;return dbSettings['get'](_0x19451c(0x384))['value']()||{};}function getSecure(){const _0x97b236=_0x67c83f;return dbSecure[_0x97b236(0x372)](_0x97b236(0x27a))['value']()||{};}function getBlacklist(){const _0x393259=_0x67c83f;return dbSecure['get']('blacklist')[_0x393259(0x229)]()||[];}function broadcastToBots(_0x43133e,_0x4e65ab){config['forEach'](_0x5913d4=>{const _0x21737e=_0x5c0c;if(_0x5913d4[_0x21737e(0x304)]=='enabled'&&_0x5913d4[_0x21737e(0x36d)]==_0x21737e(0x1d9)||_0x5913d4[_0x21737e(0x304)]==_0x21737e(0x292)&&_0x5913d4[_0x21737e(0x36d)]==_0x21737e(0x1d9)){if(pid[_0x5913d4[_0x21737e(0x32c)]])pid[_0x5913d4[_0x21737e(0x32c)]][_0x21737e(0x198)]({[_0x43133e]:_0x4e65ab});}});}async function storeSettings(_0x2a3784,_0x229572=![]){const _0x11f837=_0x67c83f;_0x2a3784={...settings,..._0x2a3784};if(_0x229572&&_0x2a3784[_0x11f837(0x28f)]!=_0x11f837(0x2a4)&&_0x2a3784[_0x11f837(0x28f)]!=_0x11f837(0x194)&&_0x2a3784[_0x11f837(0x28f)]!=''){const _0xc0899f=decryptRSA(secure[_0x11f837(0x2fa)],_0x2a3784['bbPassword'])[_0x11f837(0x357)](_0x11f837(0x21e))[0x0],_0x2f83d5=bcrypt[_0x11f837(0x2f0)](_0xc0899f,saltRounds);_0x2a3784={..._0x2a3784,'bbPassword':_0x2f83d5};}if(_0x229572&&_0x2a3784[_0x11f837(0x220)]!=_0x11f837(0x2a4)&&_0x2a3784[_0x11f837(0x220)]!=_0x11f837(0x194)&&_0x2a3784['telegramToken']!=''){const _0xd0b8c4=decryptRSA(secure[_0x11f837(0x2fa)],_0x2a3784['telegramToken'])[_0x11f837(0x357)]('|@|')[0x0];_0x2a3784={..._0x2a3784,'telegramToken':_0xd0b8c4};}if(_0x229572&&_0x2a3784[_0x11f837(0x306)]!=_0x11f837(0x2a4)&&_0x2a3784[_0x11f837(0x306)]!=_0x11f837(0x194)&&_0x2a3784['marketcapApi']!=''){const _0x32c105=decryptRSA(secure[_0x11f837(0x2fa)],_0x2a3784[_0x11f837(0x306)])['split'](_0x11f837(0x21e))[0x0];_0x2a3784={..._0x2a3784,'marketcapApi':_0x32c105};}const _0xeb505a=_0x2a3784[_0x11f837(0x220)]!='************'&&_0x2a3784['telegramToken']!=settings[_0x11f837(0x220)]||_0x2a3784[_0x11f837(0x376)]!=settings['telegramUsername'],_0x443c67=_0x2a3784[_0x11f837(0x220)]==''||_0x2a3784[_0x11f837(0x376)]=='',_0x1d82d5=_0x2a3784['marketcapApi']&&_0x2a3784[_0x11f837(0x306)]!='************'&&_0x2a3784[_0x11f837(0x306)]!=settings[_0x11f837(0x220)];_0xeb505a&&(_0x2a3784['telegramChatId']=null,_0x2a3784[_0x11f837(0x2b5)]=_0x11f837(0x270));for(const [_0x4f7ffa,_0x288099]of Object[_0x11f837(0x2e0)](_0x2a3784)){if(_0x4f7ffa==_0x11f837(0x220)&&_0x288099==_0x11f837(0x2a4)){_0x2a3784[_0x11f837(0x220)]=settings[_0x11f837(0x220)];continue;};if(_0x4f7ffa=='bbPassword'&&_0x288099==_0x11f837(0x2a4)){_0x2a3784['bbPassword']=settings['bbPassword'];continue;};if(_0x4f7ffa=='marketcapApi'&&_0x288099==_0x11f837(0x2a4)){_0x2a3784[_0x11f837(0x306)]=settings[_0x11f837(0x306)];continue;};dbSettings[_0x11f837(0x204)](_0x11f837(0x2c1)+_0x4f7ffa,_0x288099)[_0x11f837(0x356)]();}settings=_0x2a3784,io['to'](_0x11f837(0x2db))['emit'](_0x11f837(0x384),cleanSettings()),broadcastToBots(_0x11f837(0x19e),settings['timeshift']),broadcastToBots('onepagemode',settings[_0x11f837(0x2ac)]),broadcastToBots(_0x11f837(0x306),settings[_0x11f837(0x306)]);if(_0xeb505a&&!_0x443c67)initTelegram();if(_0xeb505a&&_0x443c67)disableTelegram();getAllClients()[_0x11f837(0x39c)](_0x5c65da=>{const _0x46a680=_0x11f837;getSocket(_0x5c65da['id'])[_0x46a680(0x29b)](_0x46a680(0x304),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x1d82d5&&(await sleep(0xbb8),testMarketcapApi(_0x2a3784[_0x11f837(0x306)]));}async function testMarketcapApi(_0x470278){const _0x4f2640=_0x67c83f,_0xbf7fd4=[_0x4f2640(0x2d6),_0x4f2640(0x2c6)];try{await axios[_0x4f2640(0x372)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x470278},'params':{'symbol':_0xbf7fd4[_0x4f2640(0x2ec)]()}});}catch(_0x509312){_0x509312['toString']()[_0x4f2640(0x392)](_0x4f2640(0x2c4))?(io['to'](_0x4f2640(0x2db))[_0x4f2640(0x29b)](_0x4f2640(0x35f),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x4f2640(0x234)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x4f2640(0x2db))[_0x4f2640(0x29b)]('notification',_0x4f2640(0x27e)),logger[_0x4f2640(0x234)](_0x4f2640(0x27e)),logger[_0x4f2640(0x32e)](_0x4f2640(0x232),_0x509312[_0x4f2640(0x2ec)]()+_0x4f2640(0x2f9)+_0x509312[_0x4f2640(0x31c)]));return;}logger[_0x4f2640(0x32e)](_0x4f2640(0x391));}function updateSetting(_0x4e0c9d,_0x201ea5){const _0x188eb6=_0x67c83f;dbSettings['set'](_0x188eb6(0x2c1)+_0x4e0c9d,_0x201ea5)[_0x188eb6(0x356)](),settings=getSettings(),io['to'](_0x188eb6(0x2db))[_0x188eb6(0x29b)](_0x188eb6(0x384),cleanSettings());}function storeSecure(_0x1ca60f){const _0x460d08=_0x67c83f;dbSecure[_0x460d08(0x372)](_0x460d08(0x27a))[_0x460d08(0x368)](_0x1ca60f)[_0x460d08(0x356)](),secure=_0x1ca60f;}function addBlacklist(_0x1e2c10){const _0x5d8f88=_0x67c83f;cleanBlacklist();let _0x3bf87e;devices[_0x1e2c10][_0x5d8f88(0x1d8)]?_0x3bf87e=Math['max'](devices[_0x1e2c10][_0x5d8f88(0x1d8)][_0x5d8f88(0x272)],loginExpiry):_0x3bf87e=loginExpiry,dbSecure[_0x5d8f88(0x372)](_0x5d8f88(0x242))[_0x5d8f88(0x368)]({'expiry':new Date()[_0x5d8f88(0x25c)]()+_0x3bf87e*0x3c*0x3e8,'token':devices[_0x1e2c10][_0x5d8f88(0x2c0)][_0x5d8f88(0x27d)]})[_0x5d8f88(0x356)](),blacklist=dbSecure[_0x5d8f88(0x372)](_0x5d8f88(0x242))[_0x5d8f88(0x229)]();}function cleanBlacklist(){const _0x31aabf=_0x67c83f;let _0x546e5=dbSecure[_0x31aabf(0x372)](_0x31aabf(0x242))[_0x31aabf(0x201)]()[_0x31aabf(0x229)](),_0x2b6877=new Date()[_0x31aabf(0x25c)]();_0x546e5['forEach'](_0x41ab3c=>{const _0x5c050a=_0x31aabf;_0x41ab3c[_0x5c050a(0x272)]<_0x2b6877&&dbSecure[_0x5c050a(0x372)](_0x5c050a(0x242))[_0x5c050a(0x22b)]({'expiry':_0x41ab3c[_0x5c050a(0x272)]})['write']();});}function initStates(){let _0x14185c=getConfiguration();_0x14185c['forEach'](_0x14438d=>{const _0x4fd0a0=_0x5c0c;_0x14438d[_0x4fd0a0(0x36d)]=_0x4fd0a0(0x269);}),storeConfiguration(_0x14185c);}async function generateKeys(){const _0x59ba3f=_0x67c83f,_0x3a0bd9=forge[_0x59ba3f(0x28c)][_0x59ba3f(0x278)][_0x59ba3f(0x189)]({'bits':0x1000,'e':0x10001}),_0x35637f=forge[_0x59ba3f(0x28c)][_0x59ba3f(0x20f)](_0x3a0bd9[_0x59ba3f(0x2fa)]),_0x44a14c=forge[_0x59ba3f(0x28c)][_0x59ba3f(0x265)](_0x3a0bd9[_0x59ba3f(0x36f)]);return{'privateKey':_0x35637f,'publicKey':_0x44a14c};}async function oneTimeMigration(){const _0x58bf9f=_0x67c83f;let _0x6d2b5d=getSettings(),_0x4585a7=![];!_0x6d2b5d[_0x58bf9f(0x36b)](_0x58bf9f(0x2df))&&(_0x6d2b5d[_0x58bf9f(0x2df)]=0x0,_0x4585a7=!![]);!_0x6d2b5d[_0x58bf9f(0x36b)](_0x58bf9f(0x2d1))&&(_0x6d2b5d[_0x58bf9f(0x2d1)]=0x0,_0x4585a7=!![]);!_0x6d2b5d[_0x58bf9f(0x36b)](_0x58bf9f(0x2b1))&&(_0x6d2b5d[_0x58bf9f(0x2b1)]=_0x58bf9f(0x1ec),_0x4585a7=!![]);!_0x6d2b5d['hasOwnProperty'](_0x58bf9f(0x2ac))&&(_0x6d2b5d[_0x58bf9f(0x2ac)]=![],_0x4585a7=!![]);!_0x6d2b5d[_0x58bf9f(0x36b)]('marketcapApi')&&(_0x6d2b5d[_0x58bf9f(0x306)]='',_0x4585a7=!![]);if(_0x4585a7)storeSettings(_0x6d2b5d);try{fs[_0x58bf9f(0x308)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x3427bd=>{const _0x1c3fd2=_0x58bf9f;if(!_0x3427bd[_0x1c3fd2(0x1cc)]()){if(!_0x3427bd['name'][_0x1c3fd2(0x31f)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x3427bd[_0x1c3fd2(0x2fb)]);}else fs['rmSync'](configbackuppath+_0x3427bd[_0x1c3fd2(0x2fb)],{'recursive':!![]});});}catch(_0x10d3c5){logger[_0x58bf9f(0x32e)](_0x58bf9f(0x30b),_0x10d3c5);}}function storeConfiguration(_0x2d995f){const _0x3d0e5f=_0x67c83f;dbConfig[_0x3d0e5f(0x372)](_0x3d0e5f(0x1ae))[_0x3d0e5f(0x22b)]()['write'](),dbConfig[_0x3d0e5f(0x372)](_0x3d0e5f(0x1ae))[_0x3d0e5f(0x368)](..._0x2d995f)[_0x3d0e5f(0x356)](),config=_0x2d995f;}async function resetPassword(){const _0x13d9f7=_0x67c83f;if(tgBot&&settings[_0x13d9f7(0x184)]){const _0x5e1b9a=Markup['inlineKeyboard']([Markup[_0x13d9f7(0x322)]['callback'](_0x13d9f7(0x1ce),_0x13d9f7(0x199)),Markup[_0x13d9f7(0x322)][_0x13d9f7(0x313)]('no','resetpw_no')]);await sendTelegram(settings[_0x13d9f7(0x184)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x5e1b9a),tgBot[_0x13d9f7(0x35d)](/resetpw_(.+)/,async _0x433835=>{const _0x4bc7f8=_0x13d9f7,_0x2a153d=_0x433835[_0x4bc7f8(0x353)][0x1];_0x433835[_0x4bc7f8(0x364)]();if(_0x2a153d!='no'){const _0x53f013=0xf,_0x556692=_0x4bc7f8(0x1d3),_0x5c23ae=Array[_0x4bc7f8(0x207)](crypto[_0x4bc7f8(0x266)](new Uint32Array(_0x53f013)))[_0x4bc7f8(0x310)](_0x8f3651=>_0x556692[_0x8f3651%_0x556692[_0x4bc7f8(0x1a7)]])['join'](''),_0x1a5701=bcrypt[_0x4bc7f8(0x2f0)](_0x5c23ae,saltRounds);storeSettings({'bbPassword':_0x1a5701}),await sendTelegram(_0x433835[_0x4bc7f8(0x1aa)]['id'],_0x4bc7f8(0x314)+_0x5c23ae,{'parse_mode':_0x4bc7f8(0x338)});}else await sendTelegram(_0x433835[_0x4bc7f8(0x1aa)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x4cc955,_0xe6b4d5){const _0x1eaa25=_0x67c83f;io['to']('botmanager')['emit'](_0x1eaa25(0x35f),_0x1eaa25(0x361),'success');if(tgBot&&settings[_0x1eaa25(0x184)]){const _0x18d6b8=uuidRandom();tmpStorage[_0x18d6b8]={'path':_0x4cc955,'filename':_0xe6b4d5};const _0x5a8bbf=Markup[_0x1eaa25(0x1ca)]([Markup['button'][_0x1eaa25(0x313)](_0x1eaa25(0x1ce),_0x1eaa25(0x2a7)+_0x18d6b8),Markup[_0x1eaa25(0x322)][_0x1eaa25(0x313)]('no',_0x1eaa25(0x295)+_0x18d6b8)]);await sendTelegram(settings[_0x1eaa25(0x184)],_0x1eaa25(0x1d2),_0x5a8bbf),tgBot[_0x1eaa25(0x35d)](/restore_(.+)_(.+)/,async _0x498fa3=>{const _0x340ff1=_0x1eaa25,_0x1b50b1=_0x498fa3['match'][0x1],_0x2f0c85=_0x498fa3[_0x340ff1(0x353)][0x2],{path:_0x1581cb,filename:_0x84e753}=tmpStorage[_0x2f0c85];delete tmpStorage[_0x2f0c85],_0x498fa3[_0x340ff1(0x364)](),_0x1b50b1==_0x340ff1(0x1ce)?(logger[_0x340ff1(0x32e)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x498fa3[_0x340ff1(0x1aa)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x340ff1(0x338)}),unzipFile(_0x1581cb,_0x84e753)):(logger[_0x340ff1(0x32e)](_0x340ff1(0x30c)),await sendTelegram(_0x498fa3['chat']['id'],_0x340ff1(0x30c)));});}}function getServerTime(){const _0x1d2e24=_0x67c83f,_0x5b6e02=new Date();return _0x5b6e02[_0x1d2e24(0x358)]()+'/'+(_0x5b6e02[_0x1d2e24(0x241)]()+0x1)[_0x1d2e24(0x2ec)]()[_0x1d2e24(0x276)](0x2,'0')+'/'+_0x5b6e02[_0x1d2e24(0x250)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x5b6e02['getHours']()['toString']()[_0x1d2e24(0x276)](0x2,'0')+':'+_0x5b6e02['getMinutes']()[_0x1d2e24(0x2ec)]()[_0x1d2e24(0x276)](0x2,'0')+':'+_0x5b6e02[_0x1d2e24(0x325)]()[_0x1d2e24(0x2ec)]()[_0x1d2e24(0x276)](0x2,'0');}function getTimeStamp(){const _0x642164=_0x67c83f,_0x129d7e=shiftedTime();return _0x129d7e[_0x642164(0x358)]()+'/'+(_0x129d7e['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x129d7e[_0x642164(0x250)]()[_0x642164(0x2ec)]()['padStart'](0x2,'0')+'\x20'+_0x129d7e[_0x642164(0x29f)]()[_0x642164(0x2ec)]()[_0x642164(0x276)](0x2,'0')+':'+_0x129d7e['getMinutes']()[_0x642164(0x2ec)]()['padStart'](0x2,'0')+':'+_0x129d7e[_0x642164(0x325)]()[_0x642164(0x2ec)]()[_0x642164(0x276)](0x2,'0');}function getCleanTimeStamp(){const _0x481fbe=_0x67c83f,_0x526fb2=shiftedTime();return _0x526fb2[_0x481fbe(0x358)]()+(_0x526fb2[_0x481fbe(0x241)]()+0x1)[_0x481fbe(0x2ec)]()['padStart'](0x2,'0')+_0x526fb2[_0x481fbe(0x250)]()[_0x481fbe(0x2ec)]()['padStart'](0x2,'0')+'-'+_0x526fb2[_0x481fbe(0x29f)]()[_0x481fbe(0x2ec)]()[_0x481fbe(0x276)](0x2,'0')+_0x526fb2[_0x481fbe(0x340)]()[_0x481fbe(0x2ec)]()[_0x481fbe(0x276)](0x2,'0')+_0x526fb2[_0x481fbe(0x325)]()[_0x481fbe(0x2ec)]()[_0x481fbe(0x276)](0x2,'0');}function shiftedTime(){const _0x1086ee=_0x67c83f,_0x522fc8=new Date();let _0x3f2405=_0x522fc8;if(settings[_0x1086ee(0x19e)]&&settings[_0x1086ee(0x19e)]!==0x0)_0x3f2405=fns[_0x1086ee(0x24e)](_0x522fc8,{'hours':settings[_0x1086ee(0x19e)]});return _0x3f2405;}async function startScheduler(){const _0x4d154a=_0x67c83f,_0x532238=new Date()[_0x4d154a(0x2e6)](),_0x31ee1f=shiftedTime()[_0x4d154a(0x29f)]();_0x31ee1f==0x4&&backupConfigFiles(),_0x31ee1f==0x0&&rotateLogFiles(),_0x532238%0x6==0x0&&triggerAnalytics(),_0x532238%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x124255){const _0x5e3b47=_0x67c83f;logger[_0x5e3b47(0x32e)](_0x5e3b47(0x2cf)+_0x124255);const _0x24321d=getBotsWithMode();_0x24321d[_0x5e3b47(0x1a7)]>0x0?confirmRestore(configbackuppath,_0x124255):unzipFile(configbackuppath,_0x124255);}async function getBackupFiles(_0x8b1259=null){const _0x1fd152=_0x67c83f;let _0x223bdb=[],_0x5ad896=fs[_0x1fd152(0x308)](configbackuppath,{'withFileTypes':!![]});_0x5ad896['sort']((_0x205a4e,_0x4ab34c)=>_0x205a4e[_0x1fd152(0x2fb)]<_0x4ab34c[_0x1fd152(0x2fb)]?0x1:_0x4ab34c[_0x1fd152(0x2fb)]<_0x205a4e[_0x1fd152(0x2fb)]?-0x1:0x0),_0x5ad896[_0x1fd152(0x39c)](_0x3c11e7=>{const _0x397db6=_0x1fd152;if(!_0x3c11e7[_0x397db6(0x1cc)]()&&_0x3c11e7[_0x397db6(0x2fb)]['startsWith'](_0x397db6(0x1b6))&&_0x3c11e7[_0x397db6(0x2fb)][_0x397db6(0x1f3)]('.zip')){const _0x5b07a2=formatDate(fs['statSync'](configbackuppath+_0x3c11e7[_0x397db6(0x2fb)])[_0x397db6(0x29e)]);_0x223bdb[_0x397db6(0x368)]({'name':_0x3c11e7['name'],'mtime':_0x5b07a2});}});if(_0x8b1259)io['to'](_0x8b1259)['emit'](_0x1fd152(0x35c),_0x223bdb);else return _0x223bdb;}async function backupConfigFiles(){const _0x243277=_0x67c83f;await zipFiles(_0x243277(0x2f5));const _0x54211b=getCleanTimeStamp();fs[_0x243277(0x206)](zippath+_0x243277(0x377),configbackuppath+(_0x243277(0x1b6)+_0x54211b+_0x243277(0x2a9)));let _0x41893d=fs[_0x243277(0x308)](configbackuppath,{'withFileTypes':!![]});_0x41893d[_0x243277(0x191)]((_0x31e32d,_0x1bc87e)=>_0x31e32d[_0x243277(0x2fb)]<_0x1bc87e['name']?0x1:_0x1bc87e[_0x243277(0x2fb)]<_0x31e32d[_0x243277(0x2fb)]?-0x1:0x0),_0x41893d[_0x243277(0x1a7)]>maxBackups&&fs[_0x243277(0x2b3)](configbackuppath+_0x41893d[_0x41893d['length']-0x1][_0x243277(0x2fb)]);}function rotateLogFiles(){const _0x41a662=_0x67c83f,_0x5173f4=fs['statSync'](logspath+_0x41a662(0x302)),_0x533359=_0x5173f4[_0x41a662(0x1f7)]/0x400;if(_0x533359>0x64){let _0x4c7bd2=fs[_0x41a662(0x308)](logspath,{'withFileTypes':!![]});_0x4c7bd2[_0x41a662(0x191)]((_0x4cdd87,_0x14694f)=>_0x4cdd87[_0x41a662(0x2fb)]<_0x14694f[_0x41a662(0x2fb)]?0x1:_0x14694f['name']<_0x4cdd87[_0x41a662(0x2fb)]?-0x1:0x0),_0x4c7bd2[_0x41a662(0x39c)](_0x4dd294=>{const _0x22e4f8=_0x41a662;if(_0x4dd294[_0x22e4f8(0x2fb)]==_0x22e4f8(0x31e))fs['copyFileSync'](logspath+_0x4dd294[_0x22e4f8(0x2fb)],logspath+'output-003.log');if(_0x4dd294[_0x22e4f8(0x2fb)]==_0x22e4f8(0x259))fs[_0x22e4f8(0x206)](logspath+_0x4dd294[_0x22e4f8(0x2fb)],logspath+_0x22e4f8(0x31e));_0x4dd294[_0x22e4f8(0x2fb)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x4dd294[_0x22e4f8(0x2fb)],logspath+'output-001.log'),fs[_0x22e4f8(0x294)](logspath+_0x4dd294[_0x22e4f8(0x2fb)],''));});}}async function zipFiles(_0x48f05a){const _0x2e8ea1=_0x67c83f;let _0x332950;if(_0x48f05a==_0x2e8ea1(0x1a4))_0x332950=logspath;if(_0x48f05a==_0x2e8ea1(0x2ab))_0x332950=configpath;if(_0x48f05a==_0x2e8ea1(0x2f5))_0x332950=configpath;let _0x1a94ef=fs[_0x2e8ea1(0x308)](_0x332950,{'withFileTypes':!![]});const _0x41f44b=new JSZip();_0x1a94ef[_0x2e8ea1(0x39c)](_0x6e1739=>{const _0x389ab1=_0x2e8ea1;if(!_0x6e1739[_0x389ab1(0x1cc)]()){let _0x13adb1=fs[_0x389ab1(0x1b5)](_0x332950+_0x6e1739[_0x389ab1(0x2fb)]);if(_0x48f05a==_0x389ab1(0x2ab)){const _0x558f7e=/^bot-[0-9]{3}-config.json$/,_0x23ae0e=_0x558f7e['test'](_0x6e1739[_0x389ab1(0x2fb)]);if(_0x23ae0e){const _0x180c0a=JSON[_0x389ab1(0x277)](_0x13adb1);if(_0x180c0a[_0x389ab1(0x262)][0x0]){_0x180c0a[_0x389ab1(0x262)][0x0][_0x389ab1(0x1de)]=_0x389ab1(0x194),_0x180c0a[_0x389ab1(0x262)][0x0][_0x389ab1(0x1a6)]=_0x389ab1(0x194);if(_0x180c0a['bot'][0x0][_0x389ab1(0x359)])_0x180c0a[_0x389ab1(0x262)][0x0]['apiPassword']=_0x389ab1(0x194);}_0x13adb1=JSON['stringify'](_0x180c0a,null,0x2);}if(_0x6e1739[_0x389ab1(0x2fb)]==_0x389ab1(0x23f)){const _0x4b45ca=JSON[_0x389ab1(0x277)](_0x13adb1);if(_0x4b45ca[_0x389ab1(0x384)][_0x389ab1(0x383)])_0x4b45ca['settings']['loginRequired']=![];if(_0x4b45ca[_0x389ab1(0x384)]['bbPassword'])_0x4b45ca[_0x389ab1(0x384)][_0x389ab1(0x28f)]=_0x389ab1(0x194);if(_0x4b45ca[_0x389ab1(0x384)]['telegramToken'])_0x4b45ca['settings']['telegramToken']=_0x389ab1(0x194);if(_0x4b45ca[_0x389ab1(0x384)][_0x389ab1(0x184)])_0x4b45ca[_0x389ab1(0x384)][_0x389ab1(0x184)]=null;if(_0x4b45ca[_0x389ab1(0x384)]['marketcapApi'])_0x4b45ca[_0x389ab1(0x384)][_0x389ab1(0x306)]=_0x389ab1(0x194);_0x13adb1=JSON[_0x389ab1(0x303)](_0x4b45ca,null,0x2);}if(_0x6e1739[_0x389ab1(0x2fb)]!=_0x389ab1(0x339))_0x41f44b[_0x389ab1(0x32a)](_0x6e1739[_0x389ab1(0x2fb)],_0x13adb1);}else _0x41f44b['file'](_0x6e1739[_0x389ab1(0x2fb)],_0x13adb1);}});const _0x2df29d=await _0x41f44b[_0x2e8ea1(0x268)]({'type':_0x2e8ea1(0x1c3),'base64':![],'compression':_0x2e8ea1(0x236)});fs[_0x2e8ea1(0x294)](zippath+(_0x48f05a+_0x2e8ea1(0x2a9)),_0x2df29d,'binary');}async function unzipFile(_0x52b664,_0x3c24cc){const _0x315c9f=_0x67c83f;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x34fd17=>{const _0x4db2f3=_0x5c0c;if(!_0x34fd17[_0x4db2f3(0x1cc)]())fs[_0x4db2f3(0x2cb)](configpath+_0x34fd17[_0x4db2f3(0x2fb)]);});const _0x39045e=fs[_0x315c9f(0x1b5)](_0x52b664+_0x3c24cc,_0x315c9f(0x2bb)),_0x55b322=await JSZip[_0x315c9f(0x1fd)](_0x39045e,{'base64':![],'checkCRC32':!![]});for(const _0x3bd744 of Object[_0x315c9f(0x1fb)](_0x55b322[_0x315c9f(0x288)])){const _0x5323c1=_0x55b322[_0x315c9f(0x288)][_0x3bd744],_0x3f3a90=await _0x5323c1[_0x315c9f(0x1d1)](_0x315c9f(0x1c3));fs[_0x315c9f(0x294)](configpath+_0x5323c1[_0x315c9f(0x2fb)],_0x3f3a90);}fs[_0x315c9f(0x308)](temppath,{'withFileTypes':!![]})[_0x315c9f(0x39c)](_0x4c7661=>{const _0x5afba0=_0x315c9f;if(!_0x4c7661[_0x5afba0(0x1cc)]())fs[_0x5afba0(0x2cb)](temppath+_0x4c7661[_0x5afba0(0x2fb)]);}),logger[_0x315c9f(0x32e)](_0x315c9f(0x388)),process[_0x315c9f(0x198)]({'restore':!![]},_0x2d578a=>{});}async function getPublicIp(){const _0x35573b=_0x67c83f;try{const _0x107376=await axios[_0x35573b(0x372)]('https://api.ipify.org?format=json');publicip=_0x107376[_0x35573b(0x1a3)]['ip'];}catch(_0x3f9600){}}async function triggerAnalytics(){const _0x5dcc04=_0x67c83f;if(!publicip)await getPublicIp();const _0xb8c1d4=getBotsWithMode();let _0xf00582=0x0;_0xb8c1d4['forEach'](_0x1dd479=>{const _0x8ff3a7=_0x5c0c;if(_0x1dd479[_0x8ff3a7(0x304)]===_0x8ff3a7(0x26e))_0xf00582++;});const _0x45d3ab=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x5dcc04(0x2f7)],'ip':publicip,'version':serverversion,'numbots':_0xb8c1d4[_0x5dcc04(0x1a7)],'numbotsenabled':_0xf00582,'exchanges':_0x45d3ab,'environment':environment});}async function getMessages(){const _0x108791=_0x67c83f,_0xf09936='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x1611e5=new GraphQLClient(_0xf09936),_0xe564d1={'authorization':_0x108791(0x336)},_0x3122aa=serverversion[_0x108791(0x357)]('.'),_0x114b0d=_0x3122aa[0x0]+'.'+_0x3122aa[0x1],_0x2884b2=Math['min'](settings[_0x108791(0x2df)],settings['lastmsgemitted']),_0x25b251={'last':parseInt(_0x2884b2),'bbm':_0x114b0d},_0xc5fae1=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1760ca;try{_0x1760ca=await _0x1611e5['request'](_0xc5fae1,_0x25b251,_0xe564d1);}catch(_0x271f1e){}if(_0x1760ca&&_0x1760ca[_0x108791(0x26f)]){let _0x55a454=settings[_0x108791(0x2df)];newMessages=[];for(const _0x14ff42 of _0x1760ca[_0x108791(0x26f)]){newMessages[_0x108791(0x368)](_0x14ff42);let _0x57fe21=![];_0x14ff42['bbvNew']&&(updateSetting(_0x108791(0x2b1),_0x14ff42[_0x108791(0x19c)]),_0x57fe21=isNewerVersion(serverversion,_0x14ff42[_0x108791(0x19c)])||serverversion==_0x14ff42['bbvNew']);if(!_0x57fe21&&_0x14ff42[_0x108791(0x1c2)]>_0x55a454){if(_0x14ff42[_0x108791(0x215)]===_0x108791(0x2bd)||serverversion['startsWith'](_0x14ff42[_0x108791(0x215)])){let _0x2a7b85=''+_0x14ff42[_0x108791(0x1c9)]+'\x0a\x0a'+_0x14ff42[_0x108791(0x345)];const _0x391945=await sendTelegramMsg(toTelegramMarkdown(_0x2a7b85),'Markdown');if(_0x391945)_0x55a454=_0x14ff42[_0x108791(0x1c2)];}}}updateAvailable=isNewerVersion(settings[_0x108791(0x2b1)],serverversion),updateSetting(_0x108791(0x2df),_0x55a454),emitMessages();}}function emitMessages(){const _0x39b3bb=_0x67c83f,_0x3c35b6=settings[_0x39b3bb(0x2d1)];let _0x31c0a3=[];newMessages['forEach'](_0x3e2c06=>{const _0x5cd506=_0x39b3bb;_0x3e2c06[_0x5cd506(0x1c2)]>_0x3c35b6&&_0x31c0a3[_0x5cd506(0x368)](_0x3e2c06);}),_0x31c0a3[_0x39b3bb(0x1a7)]>0x0&&getAllClients()[_0x39b3bb(0x39c)](_0x2a00d6=>{getSocket(_0x2a00d6['id'])['emit']('message',_0x31c0a3);});}function confirmMessage(_0x33d703){const _0x2717f8=_0x67c83f;updateSetting(_0x2717f8(0x2d1),Number(_0x33d703));}function isNewerVersion(_0x33dc6d,_0x491804){const _0x307c06=_0x67c83f,_0x5375b9=_0x491804[_0x307c06(0x357)]('.'),_0x32b6f3=_0x33dc6d[_0x307c06(0x357)]('.');for(var _0x3674d5=0x0;_0x3674d5<_0x32b6f3['length'];_0x3674d5++){const _0xba4f37=~~_0x32b6f3[_0x3674d5],_0x1a55ff=~~_0x5375b9[_0x3674d5];if(_0xba4f37>_0x1a55ff)return!![];if(_0xba4f37<_0x1a55ff)return![];}return![];}function toTelegramMarkdown(_0x5eaf0f){const _0x2f35e5=_0x67c83f,_0x3e82bc=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x38bde6=/\*{2}(.+?)\*{2}/gim;return _0x5eaf0f=_0x5eaf0f[_0x2f35e5(0x1be)](_0x3e82bc,_0x2f35e5(0x2f1))[_0x2f35e5(0x1be)](_0x38bde6,_0x2f35e5(0x18e)),_0x5eaf0f;}async function validateConfigFile(){const _0x2f0acc=_0x67c83f,_0x54e17f=dbConfig[_0x2f0acc(0x372)](_0x2f0acc(0x1ae))[_0x2f0acc(0x316)](_0x2f0acc(0x32c))[_0x2f0acc(0x229)]()||[];if(_0x54e17f[_0x2f0acc(0x1a7)]==0x0){let _0x1a2ac2=0x0,_0x1e857b=[];const _0x4d609d=/^bot-([0-9]{3})-config.json$/,_0x5ba3a8=fs[_0x2f0acc(0x308)](configpath);_0x5ba3a8['forEach'](_0x39ef06=>{const _0x4e1d38=_0x2f0acc,_0x1598f9=_0x4d609d['exec'](_0x39ef06);if(_0x1598f9){const _0x11e9f9=_0x1598f9[0x1];let _0x1e29e2=getBotAttributes(_0x11e9f9);_0x1e857b[_0x4e1d38(0x368)]({'botID':_0x11e9f9,'botname':_0x1e29e2[_0x4e1d38(0x209)],'status':_0x4e1d38(0x23a),'live':'stopped'}),_0x1a2ac2++;}}),_0x1a2ac2!=0x0&&(dbConfig['get'](_0x2f0acc(0x1ae))[_0x2f0acc(0x2ca)](_0x1e857b)['write'](),config=_0x1e857b,restoredConfigFile=_0x1a2ac2);}}async function restoreConfigNotify(_0x4f616a){const _0x4e4c49=_0x67c83f;let _0x26ff7a;if(restoredConfigFile==0x1)_0x26ff7a='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x26ff7a=_0x4e4c49(0x197);if(_0x4f616a)io['to']('botmanager')[_0x4e4c49(0x29b)](_0x4e4c49(0x35f),_0x26ff7a);else{logger[_0x4e4c49(0x38b)](_0x4e4c49(0x275)),logger[_0x4e4c49(0x38b)](_0x26ff7a),logger[_0x4e4c49(0x38b)]('-----------------------------------------------------------------------------------'),logger[_0x4e4c49(0x38b)]('');if(tgBot&&settings[_0x4e4c49(0x184)]&&settings[_0x4e4c49(0x2b5)]!=_0x4e4c49(0x1ef))await sendTelegram(settings['telegramChatId'],_0x4e4c49(0x23e)+_0x26ff7a);}}function decryptRSA(_0x5b3861,_0x2c6060){const _0x4653cd=_0x67c83f,_0x1565d8=forge[_0x4653cd(0x28c)][_0x4653cd(0x28b)](_0x5b3861),_0x328b9a=_0x1565d8[_0x4653cd(0x324)](forge[_0x4653cd(0x2c5)][_0x4653cd(0x2b7)](_0x2c6060),'RSA-OAEP',{'md':forge['md'][_0x4653cd(0x390)][_0x4653cd(0x394)](),'mgf1':{'md':forge['md']['sha256']['create']()}});return _0x328b9a;}function validateCredentials(_0x3adf82,_0x44884c){const _0x2eac74=_0x67c83f;if(_0x3adf82['username']==settings['bbUsername']&&bcrypt['compareSync'](_0x3adf82[_0x2eac74(0x245)],settings[_0x2eac74(0x28f)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x2eac74(0x312),'token':null};else{const _0x50ae88=generateLoginToken(_0x44884c);return{'allow':!![],'reason':_0x2eac74(0x2e1),'token':_0x50ae88};}}else return{'allow':![],'reason':_0x2eac74(0x333),'token':null};}function refreshToken(_0x226470){const _0x376588=_0x67c83f,_0x4e03e9=generateLoginToken(_0x226470);return{'allow':!![],'reason':_0x376588(0x2e1),'token':_0x4e03e9};}function validateAccess(_0x20a86f,_0x14cb07,_0x129e7b){const _0x17abf6=_0x67c83f,_0x1c47c2=_0x129e7b?_0x129e7b:devices[_0x14cb07]['ip'];let _0x127b94;const _0x43a870=_0x71a169=>{const _0x5c7355=_0x5c0c;if(settings['loginRequired']){if(settings[_0x5c7355(0x348)]){if(telegram2FaApproved(_0x14cb07)){const _0x54d6fe=generateLoginToken(_0x14cb07);return{'allow':!![],'reason':_0x5c7355(0x22a),'token':_0x54d6fe};}else return{'allow':![],'reason':_0x5c7355(0x344),'token':null};}else return _0x127b94=validToken(_0x71a169,_0x14cb07),_0x127b94[_0x5c7355(0x36b)](_0x5c7355(0x327))?{'allow':!![],'reason':_0x5c7355(0x1f6),'token':_0x71a169}:{'allow':![],'reason':_0x5c7355(0x344),'token':null};}else return{'allow':!![],'reason':_0x5c7355(0x298),'token':null};};if(settings[_0x17abf6(0x1ba)]){let _0x38a51=[...settings[_0x17abf6(0x33a)],_0x17abf6(0x2c7),_0x17abf6(0x382),_0x17abf6(0x2e2)];if(_0x38a51[_0x17abf6(0x392)](_0x1c47c2))return _0x43a870(_0x20a86f);else{_0x127b94=validToken(_0x20a86f,_0x14cb07);if(_0x127b94[_0x17abf6(0x36b)](_0x17abf6(0x327)))return _0x43a870(_0x20a86f);else{if(telegramIpApproved(_0x14cb07)){const _0x4ae720=generateToken(_0x14cb07);return _0x127b94=_0x43a870(_0x20a86f),_0x127b94['allow']?{'allow':!![],'reason':_0x17abf6(0x2ed),'token':_0x4ae720}:_0x127b94;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x17abf6(0x2b4),'token':null};}}}else return _0x43a870(_0x20a86f);}function timelyDecrypt(_0x2dde38,_0x43d961,_0x1e22a0='@'){const _0xb9c79e=_0x67c83f;if(_0x2dde38)try{const _0x1fbd63=decryptRSA(secure[_0xb9c79e(0x2fa)],_0x2dde38),_0x5819f6=_0x1fbd63[_0xb9c79e(0x357)](_0x1e22a0)[0x0],_0x316f6a=_0x1fbd63['split'](_0x1e22a0)[0x1],_0x20577f=new Date()[_0xb9c79e(0x25c)]();if(_0x43d961){if(_0x20577f-_0x316f6a<maxSecretAge*0x3e8)return _0x5819f6;else return![];}else return _0x5819f6;}catch(_0x1bd7ef){return![];}else return![];}const validToken=(_0x46ae56,_0x15a534)=>{const _0x4fa8c9=_0x67c83f,_0x1142e2=devices[_0x15a534]['ip'];if(!_0x46ae56)return{'error':_0x4fa8c9(0x216)};for(let _0x3b0276 of blacklist){if(_0x3b0276[_0x4fa8c9(0x27d)]==_0x46ae56)return{'error':_0x4fa8c9(0x331)};}let _0x38990c;try{_0x38990c=jwt[_0x4fa8c9(0x1af)](_0x46ae56,secure[_0x4fa8c9(0x1f0)]+_0x15a534);}catch{return{'error':_0x4fa8c9(0x1bc)};}if(!_0x38990c['hasOwnProperty'](_0x4fa8c9(0x375))&&!_0x38990c[_0x4fa8c9(0x36b)](_0x4fa8c9(0x36a))||!_0x38990c[_0x4fa8c9(0x36b)](_0x4fa8c9(0x2ef)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x38990c['hasOwnProperty'](_0x4fa8c9(0x36a))&&_0x38990c[_0x4fa8c9(0x36b)]('clientip')){const {clientip:_0x2dd4ff}=_0x38990c;return _0x1142e2==_0x2dd4ff?{'success':_0x4fa8c9(0x379)}:{'error':_0x4fa8c9(0x18a)};}else{if(_0x38990c['hasOwnProperty']('username')&&_0x38990c[_0x4fa8c9(0x36b)](_0x4fa8c9(0x375))){const {username:_0x198466,clientip:_0x1c2920}=_0x38990c;return settings[_0x4fa8c9(0x34c)]==_0x198466&&_0x1142e2==_0x1c2920?{'success':_0x4fa8c9(0x379)}:{'error':_0x4fa8c9(0x23b)};}}},generateLoginToken=_0x2a8a7d=>{const _0x530987=_0x67c83f;if(_0x2a8a7d){const _0xac76f0=devices[_0x2a8a7d]['ip'];return jwt[_0x530987(0x38c)]({'username':settings[_0x530987(0x34c)],'clientip':_0xac76f0},secure[_0x530987(0x1f0)]+_0x2a8a7d,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x594e4e=>{const _0x2cc60f=_0x67c83f;if(_0x594e4e){const _0x2cd664=devices[_0x594e4e]['ip'];return jwt[_0x2cc60f(0x38c)]({'clientip':_0x2cd664},secure[_0x2cc60f(0x1f0)]+_0x594e4e,{'expiresIn':devices[_0x594e4e][_0x2cc60f(0x1d8)][_0x2cc60f(0x272)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x2f2dd5=>{const _0x5016ca=_0x67c83f;let _0x30cd53=![];return devices[_0x2f2dd5][_0x5016ca(0x1d8)]&&devices[_0x2f2dd5][_0x5016ca(0x1d8)][_0x5016ca(0x272)]!=_0x5016ca(0x221)&&(_0x30cd53=devices[_0x2f2dd5][_0x5016ca(0x1d8)][_0x5016ca(0x375)]==devices[_0x2f2dd5]['ip']&&new Date()['getTime']()-devices[_0x2f2dd5][_0x5016ca(0x1d8)]['timestamp']<devices[_0x2f2dd5][_0x5016ca(0x1d8)]['expiry']*0x3c*0x3e8),_0x30cd53;},telegram2FaApproved=_0x12c1b6=>{const _0x177b91=_0x67c83f;let _0x2fb742=![];return devices[_0x12c1b6][_0x177b91(0x263)]&&devices[_0x12c1b6][_0x177b91(0x263)][_0x177b91(0x272)]!=_0x177b91(0x221)&&(_0x2fb742=devices[_0x12c1b6][_0x177b91(0x263)][_0x177b91(0x375)]==devices[_0x12c1b6]['ip']&&new Date()[_0x177b91(0x25c)]()-devices[_0x12c1b6][_0x177b91(0x263)][_0x177b91(0x350)]<devices[_0x12c1b6]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x2fb742;},normalizeIP=_0x1ce477=>{const _0x174633=_0x67c83f;let _0x2d2a98=null,_0x466a7d=null;if(ipaddr[_0x174633(0x2e9)](_0x1ce477)){const _0x5e8b5a=ipaddr[_0x174633(0x277)](_0x1ce477);_0x5e8b5a[_0x174633(0x30f)]()==='ipv6'?(_0x5e8b5a['isIPv4MappedAddress']()&&(_0x2d2a98=_0x5e8b5a[_0x174633(0x29a)]()[_0x174633(0x2ec)]()),_0x466a7d=_0x5e8b5a[_0x174633(0x2ec)]()):(_0x2d2a98=_0x5e8b5a[_0x174633(0x2ec)](),_0x466a7d=_0x5e8b5a[_0x174633(0x367)]()['toString']());}return{'show':_0x2d2a98?_0x2d2a98:_0x466a7d,'store':_0x466a7d};};function formatDate(_0x593087){const _0x4d326d=_0x67c83f;return _0x593087[_0x4d326d(0x358)]()+'/'+(_0x593087[_0x4d326d(0x241)]()+0x1)[_0x4d326d(0x2ec)]()[_0x4d326d(0x276)](0x2,'0')+'/'+_0x593087[_0x4d326d(0x250)]()[_0x4d326d(0x2ec)]()[_0x4d326d(0x276)](0x2,'0')+'\x20'+_0x593087[_0x4d326d(0x29f)]()[_0x4d326d(0x2ec)]()[_0x4d326d(0x276)](0x2,'0')+':'+_0x593087['getMinutes']()['toString']()[_0x4d326d(0x276)](0x2,'0')+':'+_0x593087[_0x4d326d(0x325)]()[_0x4d326d(0x2ec)]()[_0x4d326d(0x276)](0x2,'0');}function sleep(_0x21a9a3){return new Promise(_0x293b2b=>setTimeout(_0x293b2b,_0x21a9a3));}