const _0x3d299f=_0x53da;(function(_0x53ac4b,_0x51419d){const _0x316493=_0x53da,_0x4f2182=_0x53ac4b();while(!![]){try{const _0x30894b=-parseInt(_0x316493(0x1e5))/0x1*(parseInt(_0x316493(0x1eb))/0x2)+-parseInt(_0x316493(0x166))/0x3+-parseInt(_0x316493(0x174))/0x4*(-parseInt(_0x316493(0x128))/0x5)+parseInt(_0x316493(0x1e2))/0x6*(parseInt(_0x316493(0x24d))/0x7)+-parseInt(_0x316493(0x234))/0x8+parseInt(_0x316493(0x224))/0x9+parseInt(_0x316493(0xf8))/0xa*(parseInt(_0x316493(0x14d))/0xb);if(_0x30894b===_0x51419d)break;else _0x4f2182['push'](_0x4f2182['shift']());}catch(_0x47c4ba){_0x4f2182['push'](_0x4f2182['shift']());}}}(_0x5e1f,0x857d9));const _0x2eb568=function(){let _0x41544e=!![];return function(_0x54c166,_0x56666f){const _0x15086a=_0x41544e?function(){const _0x175785=_0x53da;if(_0x56666f){const _0x32b509=_0x56666f[_0x175785(0x1f8)](_0x54c166,arguments);return _0x56666f=null,_0x32b509;}}:function(){};return _0x41544e=![],_0x15086a;};}(),_0x15fb87=_0x2eb568(this,function(){const _0xe33d59=_0x53da;return _0x15fb87[_0xe33d59(0x244)]()[_0xe33d59(0x1b5)](_0xe33d59(0x193))[_0xe33d59(0x244)]()['constructor'](_0x15fb87)[_0xe33d59(0x1b5)](_0xe33d59(0x193));});_0x15fb87();'use strict';process[_0x3d299f(0xd2)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x3d299f(0x26b)),low=require(_0x3d299f(0x23e)),FileSync=require(_0x3d299f(0x1be)),path=require(_0x3d299f(0x299)),crypto=require(_0x3d299f(0x182)),Crypt=require(_0x3d299f(0x141))[_0x3d299f(0x1e6)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x3d299f(0x28d)),jwt=require(_0x3d299f(0x1c2)),ipaddr=require('ipaddr.js'),argv=require(_0x3d299f(0x117))(process[_0x3d299f(0x155)][_0x3d299f(0x204)](0x2))[_0x3d299f(0x155)],uuidRandom=require(_0x3d299f(0x1a4)),TelegramBot=require(_0x3d299f(0x144)),Mixpanel=require(_0x3d299f(0x1f5)),axios=require(_0x3d299f(0x111)),{GraphQLClient,gql}=require(_0x3d299f(0x167)),util=require('util'),fileUpload=require('express-fileupload'),PORT=argv[_0x3d299f(0xe3)]||_0x3d299f(0x27f),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x3d299f(0x1b6)](_0x3d299f(0xe9)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x3d299f(0x272)](0x1));const HOST=argv[_0x3d299f(0x257)]||null,userID=argv[_0x3d299f(0x238)]||'',debugging=argv['d']||![];let bbpath=_0x3d299f(0x126),bbpath2='';const botfile=_0x3d299f(0xe8),configfile=_0x3d299f(0x219),settingsfile=_0x3d299f(0x226),securefile=_0x3d299f(0x260),maxBackups=0xa;let validInstallation=!![];!fs[_0x3d299f(0x210)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3d299f(0x23c)),configpath=userID?bbpath+_0x3d299f(0x1cd)+userID+'/':bbpath+_0x3d299f(0x1cd),configbackuppath=configpath+_0x3d299f(0x143),logspath=userID?bbpath+_0x3d299f(0x296)+userID+'/':bbpath+_0x3d299f(0x296),zippath=userID?bbpath+_0x3d299f(0x17f)+userID+'/':bbpath+_0x3d299f(0x17f),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x3d299f(0x208);!fs[_0x3d299f(0x210)](configpath)&&fs[_0x3d299f(0x293)](configpath);!fs[_0x3d299f(0x210)](configbackuppath)&&fs[_0x3d299f(0x293)](configbackuppath);!fs[_0x3d299f(0x210)](logspath)&&fs[_0x3d299f(0x293)](logspath);!fs[_0x3d299f(0x210)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x3d299f(0x210)](temppath)&&fs[_0x3d299f(0x293)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3d299f(0x11e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3d299f(0x1a3),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x3d299f(0x198)]();let crypt=new Crypt({'md':_0x3d299f(0x1ca),'rsaStandard':_0x3d299f(0x25d)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3d299f(0x11c)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x3d299f(0x230)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3d299f(0x135)]&&settings[_0x3d299f(0x135)]!=''&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x484f06=>{const _0x228f2f=_0x3d299f;console[_0x228f2f(0x1b6)](_0x484f06);},'simple':_0x375b04=>{const _0xc690d1=_0x3d299f;console[_0xc690d1(0x1b6)](_0x375b04),loggerfile['write'](util[_0xc690d1(0x171)](_0x375b04)+'\x0a');},'full':async _0x56d443=>{const _0x4074e8=_0x3d299f,_0x243d8f=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x56d443;console['log'](_0x243d8f),loggerfile[_0x4074e8(0x198)](util[_0x4074e8(0x171)](_0x243d8f)+'\x0a');if(tgBot&&settings[_0x4074e8(0x140)]&&settings['telegramEvents']!=_0x4074e8(0x108))await tgBot[_0x4074e8(0x267)](settings[_0x4074e8(0x140)],_0x4074e8(0xf6)+_0x56d443)[_0x4074e8(0x277)](_0x2c1211=>{telegramError(_0x2c1211);});},'debug':async(_0x60bfc5,_0x14ce01='')=>{const _0x376b6a=_0x3d299f,_0x290317=getTimeStamp()+_0x376b6a(0x22e)+_0x60bfc5;if(debugging)console['log'](_0x290317);loggerfile[_0x376b6a(0x198)](util[_0x376b6a(0x171)](_0x290317)+'\x0a');if(_0x14ce01){if(debugging)console['log'](_0x14ce01);loggerfile[_0x376b6a(0x198)](util['format'](_0x14ce01)+'\x0a');}}};process['on'](_0x3d299f(0x13a),function(_0x576305){logger['simple'](_0x576305);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3d299f(0x136)),app=express(),http=require(_0x3d299f(0x216))[_0x3d299f(0xeb)](app);app[_0x3d299f(0x287)](fileUpload({'useTempFiles':!![]})),app[_0x3d299f(0xf3)]('/download/:type',async(_0x16563a,_0x361004)=>{const _0x503145=_0x3d299f,_0x3bfd49=_0x16563a['params'][_0x503145(0xd7)],_0x3456cb=getClientsWithBotID('botmanager'),_0x4e7fa2=_0x16563a[_0x503145(0x228)][_0x503145(0x1a0)],_0x521dce=timelyDecrypt(_0x4e7fa2,![]),_0x13bd7f=_0x3456cb[_0x503145(0x181)](_0x355b0b=>_0x355b0b[_0x503145(0x1a0)]==_0x521dce);if(_0x13bd7f){const _0x49d52c=normalizeIP(_0x16563a[_0x503145(0xf9)][_0x503145(0x1ab)])[_0x503145(0x1cc)],_0x35e973=_0x16563a[_0x503145(0x228)]['tkn'];if(validateAccess(_0x35e973,_0x521dce,_0x49d52c)[_0x503145(0xf5)])_0x3bfd49==_0x503145(0xe4)&&await backupConfigFiles(),await zipFiles(_0x3bfd49),_0x361004[_0x503145(0x18b)](zippath+(_0x3bfd49+_0x503145(0x20c)),_0x4bc5c9=>{const _0x4764f5=_0x503145;_0x4bc5c9&&(logger[_0x4764f5(0xd6)]('Failed\x20to\x20download\x20'+_0x3bfd49),logger[_0x4764f5(0x243)](_0x4bc5c9));});else logger[_0x503145(0xd6)](_0x503145(0xd4)+_0x3bfd49+_0x503145(0xe2));}else logger[_0x503145(0xd6)](_0x503145(0xd4)+_0x3bfd49+'\x20(2)');}),app[_0x3d299f(0x27b)](_0x3d299f(0x186),async(_0x967e46,_0x53a942)=>{const _0x151c0d=_0x3d299f,_0x11cb7d=getClientsWithBotID(_0x151c0d(0x18f)),_0x1ab550=_0x967e46[_0x151c0d(0x228)]['uuid'],_0xe25ea1=timelyDecrypt(_0x1ab550,![]),_0x544e92=_0x11cb7d[_0x151c0d(0x181)](_0x22228a=>_0x22228a[_0x151c0d(0x1a0)]==_0xe25ea1);logger[_0x151c0d(0x189)](_0x151c0d(0x232));if(_0x544e92){const _0x5e6589=normalizeIP(_0x967e46[_0x151c0d(0xf9)][_0x151c0d(0x1ab)])['store'],_0x12af79=_0x967e46['headers'][_0x151c0d(0x1e9)];if(validateAccess(_0x12af79,_0xe25ea1,_0x5e6589)[_0x151c0d(0xf5)]){if(_0x967e46[_0x151c0d(0x107)]){const _0x786eca=_0x967e46[_0x151c0d(0x107)][_0x151c0d(0x259)];await _0x786eca['mv'](temppath+_0x786eca[_0x151c0d(0x1a1)]),_0x53a942[_0x151c0d(0x158)]({'status':!![],'message':_0x151c0d(0x22b)});const _0x2eef6=getBotsWithMode();_0x2eef6[_0x151c0d(0x1bb)]>0x0?confirmRestore(temppath,_0x786eca[_0x151c0d(0x1a1)]):unzipFile(temppath,_0x786eca[_0x151c0d(0x1a1)]);}}else logger[_0x151c0d(0xd6)](_0x151c0d(0x127));}else logger[_0x151c0d(0xd6)](_0x151c0d(0x176));}),app[_0x3d299f(0x287)](express[_0x3d299f(0xf1)](path[_0x3d299f(0x1dd)](__dirname,bbpath2,_0x3d299f(0x29a)))),app[_0x3d299f(0x287)](express['static'](path[_0x3d299f(0x1dd)](__dirname,bbpath2,_0x3d299f(0x16e)))),app[_0x3d299f(0xf3)]('/',function(_0x408f20,_0x104f3b){const _0x5a2e11=_0x3d299f;_0x104f3b[_0x5a2e11(0x163)](path['join'](__dirname,bbpath2,_0x5a2e11(0x29a),_0x5a2e11(0xd0)));}),app['get'](_0x3d299f(0x25f),function(_0xb5ed9b,_0x138ec8){const _0x325ea8=_0x3d299f;_0x138ec8['sendFile'](path[_0x325ea8(0x1dd)](__dirname,bbpath2,_0x325ea8(0x16e),_0x325ea8(0xd0)));}),app[_0x3d299f(0xf3)](_0x3d299f(0x1c7),(_0x587581,_0x5ee4b4)=>{const _0x2a3994=_0x3d299f;_0x5ee4b4[_0x2a3994(0x163)](path['join'](__dirname,bbpath2,_0x2a3994(0x16e),_0x2a3994(0xd0)));}),app[_0x3d299f(0xf3)](_0x3d299f(0x195),(_0x5ae7b5,_0x3b5302)=>{const _0x53943a=_0x3d299f;_0x3b5302[_0x53943a(0x163)](path['join'](__dirname,bbpath2,_0x53943a(0x16e),_0x53943a(0xd0)));}),app[_0x3d299f(0xf3)](_0x3d299f(0x240),(_0x2e318d,_0x2d4728)=>{const _0x220912=_0x3d299f;_0x2d4728[_0x220912(0x163)](path['join'](__dirname,bbpath2,'build',_0x220912(0xd0)));}),app[_0x3d299f(0xf3)](_0x3d299f(0x24b),(_0x20abd2,_0x24f7ef)=>{const _0x5b06ab=_0x3d299f;_0x24f7ef[_0x5b06ab(0x163)](path[_0x5b06ab(0x1dd)](__dirname,bbpath2,_0x5b06ab(0x16e),'index.html'));}),app[_0x3d299f(0xf3)](_0x3d299f(0x1f9),(_0x5298db,_0x3183e9)=>{const _0x3327b4=_0x3d299f;_0x3183e9[_0x3327b4(0x163)](path['join'](__dirname,bbpath2,_0x3327b4(0x16e),_0x3327b4(0xd0)));}),app[_0x3d299f(0xf3)](_0x3d299f(0xea),(_0x445ea0,_0x2d5c5b)=>{const _0x105b08=_0x3d299f;_0x2d5c5b[_0x105b08(0x163)](path[_0x105b08(0x1dd)](__dirname,bbpath2,_0x105b08(0x16e),_0x105b08(0xd0)));});if(HOST)http[_0x3d299f(0x1f1)](PORT,HOST);else http[_0x3d299f(0x1f1)](PORT);const io=require(_0x3d299f(0x16f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x4d9593=_0x3d299f;logger[_0x4d9593(0x243)](''),logger[_0x4d9593(0x243)](_0x4d9593(0x14b)),await logger[_0x4d9593(0xd6)](_0x4d9593(0x239)+PORT),logger[_0x4d9593(0x243)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x4dec6c of config){if(_0x4dec6c[_0x4d9593(0x1bc)]==_0x4d9593(0x1af)||_0x4dec6c['status']==_0x4d9593(0x11b))await logger['full']('Starting\x20bot\x20|\x20Bot\x20'+_0x4dec6c[_0x4d9593(0x14a)]+_0x4d9593(0x29b)+_0x4dec6c[_0x4d9593(0x269)]),startBot([_0x4dec6c[_0x4d9593(0x14a)],userID],{'cwd':bbpath},function(_0x4f2a7a){const _0x39b69a=_0x4d9593;if(_0x4f2a7a)logger[_0x39b69a(0xd6)](_0x4f2a7a);});else(_0x4dec6c[_0x4d9593(0x1bc)]=='disabled'||_0x4dec6c[_0x4d9593(0x1bc)]==_0x4d9593(0x1fc))&&await logger['full'](_0x4d9593(0x1e1)+_0x4dec6c[_0x4d9593(0x14a)]+'\x20|\x20'+_0x4dec6c[_0x4d9593(0x269)]);}else!newBot&&logger[_0x4d9593(0x243)](_0x4d9593(0x1c6));if(newBot)addBot();logger[_0x4d9593(0x243)](_0x4d9593(0x14b)),logger['simple']('');}function startSocket(){io['on']('connection',_0x25ab1b=>{const _0x1e84bb=_0x53da;let _0x446d00,_0x50e570,_0x50589d,_0x2f9933,_0x108792;const _0x12bb36=_0x25ab1b[_0x1e84bb(0x12d)][_0x1e84bb(0x228)]['referer'];_0x50e570=_0x12bb36[_0x1e84bb(0x290)](/bot[0-9]{3}/);if(_0x50e570)_0x50589d=_0x50e570[0x0][_0x1e84bb(0x290)](/[0-9]{3}/);if(_0x50589d)_0x446d00=_0x50589d[0x0];else _0x446d00=_0x1e84bb(0x18f);const _0x3e8283=_0x25ab1b[_0x1e84bb(0x12d)][_0x1e84bb(0x18e)][_0x1e84bb(0x15f)];if(!_0x3e8283)_0x25ab1b['emit'](_0x1e84bb(0x1bc),{'publicKey':secure[_0x1e84bb(0x134)]});else{_0x2f9933=timelyDecrypt(_0x3e8283,![]);if(!_0x2f9933)_0x25ab1b['emit'](_0x1e84bb(0x1bc),{'publicKey':secure[_0x1e84bb(0x134)]});else{_0x108792=normalizeIP(_0x25ab1b[_0x1e84bb(0x1f7)][_0x1e84bb(0x1ab)])[_0x1e84bb(0x1cc)];if(!devices[_0x2f9933])devices[_0x2f9933]={'uuid':_0x2f9933,'access':{'token':null}};devices[_0x2f9933]['ip']=_0x108792;const _0x293977=addClient(_0x25ab1b['id'],_0x2f9933,_0x446d00);setAccess(_0x293977),emitMessages(),_0x25ab1b['on'](_0x1e84bb(0x291),_0x34ea82=>{const _0x55da7e=_0x1e84bb,_0x2e8ee3=timelyDecrypt(_0x34ea82['password']);if(_0x2e8ee3){_0x34ea82={'username':_0x34ea82[_0x55da7e(0x1ae)],'password':_0x2e8ee3},devices[_0x2f9933]['access']=validateCredentials(_0x34ea82,_0x2f9933);if(devices[_0x2f9933][_0x55da7e(0x249)][_0x55da7e(0xf5)]==![]&&devices[_0x2f9933][_0x55da7e(0x249)][_0x55da7e(0x1aa)]==_0x55da7e(0x1fe))_0x25ab1b[_0x55da7e(0x21d)](_0x55da7e(0x1bc),{'access':devices[_0x2f9933][_0x55da7e(0x249)]}),loginAccess2FA(_0x2f9933,_0x108792);else{if(devices[_0x2f9933]['access'][_0x55da7e(0xf5)]==![]&&devices[_0x2f9933][_0x55da7e(0x249)][_0x55da7e(0x1aa)]==_0x55da7e(0x1ac))_0x25ab1b[_0x55da7e(0x21d)](_0x55da7e(0x1bc),{'access':devices[_0x2f9933][_0x55da7e(0x249)]});else devices[_0x2f9933]['access']['allow']&&devices[_0x2f9933]['access'][_0x55da7e(0x1aa)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x2f9933)['forEach'](_0x426872=>{setAccess(_0x426872);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x2f9933[_0x55da7e(0x204)](-0x8)),setTokenRefresh(_0x2f9933),setSessionTimeout(_0x55da7e(0x291),_0x2f9933));}}else logger[_0x55da7e(0xd6)](_0x55da7e(0x19a));}),_0x25ab1b['on'](_0x1e84bb(0x24e),()=>{resetPassword();}),_0x25ab1b['on'](_0x1e84bb(0x280),_0x1ab293=>{removeClient(_0x25ab1b['id']);}),_0x446d00==_0x1e84bb(0x18f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2a70fd){const _0x39daf6=_0x3d299f;if(_0x2a70fd!='botmanager'&&config['apiKey']!=''){if(pid[_0x2a70fd])pid[_0x2a70fd][_0x39daf6(0x158)]({'function':'initclient','args':null});}_0x2a70fd!=_0x39daf6(0x18f)&&broadcastToBots(_0x39daf6(0x1f2),JSON[_0x39daf6(0x124)](config));}function reloadBotManager(){const _0x466df2=_0x3d299f;getClientsWithBotID(_0x466df2(0x18f))[_0x466df2(0x142)](_0x4fc5b5=>{const _0x2dcff7=_0x466df2;getSocket(_0x4fc5b5['id'])[_0x2dcff7(0x21d)](_0x2dcff7(0x1bc),{'access':{'allow':![],'reason':_0x2dcff7(0x15d),'token':null}});});}function getSocket(_0x285eb5){const _0x24c878=_0x3d299f;return io[_0x24c878(0x233)][_0x24c878(0x233)][_0x24c878(0xf3)](_0x285eb5);}function setAccess(_0x3ec3ce){const _0x43e199=_0x3d299f,_0x5c8805=getSocket(_0x3ec3ce['id']),_0x50f55d=_0x3ec3ce[_0x43e199(0x1a0)],_0x3bb8c6=_0x3ec3ce[_0x43e199(0x23f)];devices[_0x50f55d]['access']=validateAccess(devices[_0x50f55d][_0x43e199(0x249)]['token'],_0x50f55d),logger[_0x43e199(0x189)](_0x43e199(0xf2)+devices[_0x50f55d][_0x43e199(0x249)][_0x43e199(0x1aa)]+_0x43e199(0x22d)+_0x3ec3ce['id']['slice'](-0x8)+_0x43e199(0xda)+_0x50f55d['slice'](-0x8)),_0x5c8805[_0x43e199(0x1dd)](_0x50f55d);if(devices[_0x50f55d][_0x43e199(0x249)]['allow']){_0x5c8805[_0x43e199(0x1dd)](_0x3bb8c6);if(_0x3bb8c6==_0x43e199(0x18f))initializeSocketBotManager(_0x5c8805);else initializeSocketBot(_0x5c8805);initClient(_0x3bb8c6);}devices[_0x50f55d][_0x43e199(0x249)][_0x43e199(0x256)]&&devices[_0x50f55d]['access']['reason']=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x50f55d),devices[_0x50f55d][_0x43e199(0x249)][_0x43e199(0x256)]&&devices[_0x50f55d]['access'][_0x43e199(0x1aa)]==_0x43e199(0x129)&&setSessionTimeout('login',_0x50f55d),_0x5c8805[_0x43e199(0x21d)](_0x43e199(0x1bc),{'status':_0x3ec3ce['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x50f55d][_0x43e199(0x249)],'externalip':devices[_0x50f55d]['ip'],'publicKey':secure[_0x43e199(0x134)],'userid':settings[_0x43e199(0x1da)],'validInstallation':validInstallation}),devices[_0x50f55d][_0x43e199(0x249)][_0x43e199(0xf5)]==![]&&devices[_0x50f55d][_0x43e199(0x249)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x50f55d,devices[_0x50f55d]['ip']);}function setSessionTimeout(_0x28963b,_0x47281c){const _0x2363e2=_0x3d299f;let _0x4b158b;if(_0x28963b==_0x2363e2(0x291))_0x4b158b=loginExpiry*0x3c*0x3e8;else _0x4b158b=devices[_0x47281c]['telegramIpApproval'][_0x2363e2(0x27e)]*0x3c*0x3e8-(new Date()[_0x2363e2(0x1e4)]()-devices[_0x47281c][_0x2363e2(0x1d2)][_0x2363e2(0x106)]);if(devices[_0x47281c]['pidExpireLogin'])clearTimeout(devices[_0x47281c][_0x2363e2(0x25b)]);devices[_0x47281c]['pidExpireLogin']=setTimeout(()=>{const _0x43443d=_0x2363e2;if(devices[_0x47281c][_0x43443d(0x1db)])clearTimeout(devices[_0x47281c]['pidRefreshToken']);removeSocketListeners(_0x47281c),addBlacklist(_0x47281c),devices[_0x47281c][_0x43443d(0x1d2)]=null,devices[_0x47281c][_0x43443d(0xdf)]=null,devices[_0x47281c][_0x43443d(0x249)]['token']=null,logger[_0x43443d(0x189)]('Session\x20expired\x20for\x20user\x20...'+_0x47281c['slice'](-0x8)),devices[_0x47281c][_0x43443d(0x249)]=validateAccess(devices[_0x47281c][_0x43443d(0x249)]['token'],_0x47281c),!(devices[_0x47281c]['access'][_0x43443d(0xf5)]&&devices[_0x47281c][_0x43443d(0x249)]['reason']==_0x43443d(0x1e8))&&(_0x28963b=='login'?io['to'](_0x47281c)[_0x43443d(0x21d)](_0x43443d(0x1bc),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x47281c)[_0x43443d(0x21d)](_0x43443d(0x1bc),{'access':{'allow':![],'reason':_0x43443d(0x1c8),'token':null}})),devices[_0x47281c]['access'][_0x43443d(0x256)]=null;},_0x4b158b);}function setTokenRefresh(_0x49ccad){const _0x30f319=_0x3d299f;if(devices[_0x49ccad][_0x30f319(0x1db)])clearTimeout(devices[_0x49ccad][_0x30f319(0x1db)]);devices[_0x49ccad]['pidRefreshToken']=setTimeout(()=>{const _0x2f44a1=_0x30f319;getClientsWithUuid(_0x49ccad)[_0x2f44a1(0x1bb)]!=0x0?(devices[_0x49ccad][_0x2f44a1(0x249)]=refreshToken(_0x49ccad),io['to'](_0x49ccad)[_0x2f44a1(0x21d)](_0x2f44a1(0x1bc),{'status':_0x2f44a1(0x13e),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x49ccad][_0x2f44a1(0x249)],'externalip':devices[_0x49ccad]['ip'],'publicKey':secure[_0x2f44a1(0x134)],'validInstallation':validInstallation}),setTokenRefresh(_0x49ccad)):clearTimeout(devices[_0x49ccad][_0x2f44a1(0x1db)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4f0964){const _0x408672=_0x3d299f,_0x425698=getClient(_0x4f0964['id'])[_0x408672(0x1a0)];_0x4f0964[_0x408672(0x21d)](_0x408672(0x1f2),config),_0x4f0964[_0x408672(0x21d)](_0x408672(0x179),cleanSettings()),_0x4f0964['on'](_0x408672(0x13f),_0x132745=>{if(validateAccess(_0x132745,_0x425698)['allow'])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4f0964['on'](_0x408672(0x200),(_0x525e0c,_0x21a582)=>{const _0x59f7ec=_0x408672;if(validateAccess(_0x21a582,_0x425698)[_0x59f7ec(0xf5)])toggleBot(_0x525e0c[_0x59f7ec(0x14a)],_0x525e0c[_0x59f7ec(0x1bc)],_0x525e0c['live']);else logger[_0x59f7ec(0xd6)](_0x59f7ec(0x1d5));}),_0x4f0964['on'](_0x408672(0x1de),(_0x48b74c,_0x334573)=>{const _0x4b3e79=_0x408672;if(validateAccess(_0x334573,_0x425698)[_0x4b3e79(0xf5)])toggleBotMode(_0x48b74c);else logger['full'](_0x4b3e79(0x1d5));}),_0x4f0964['on']('delete-bot',(_0x5a33a2,_0x31927b)=>{if(validateAccess(_0x31927b,_0x425698)['allow'])deleteBot(_0x5a33a2);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4f0964['on'](_0x408672(0x125),(_0x53d203,_0x263007)=>{const _0x1f7c52=_0x408672;if(validateAccess(_0x263007,_0x425698)['allow'])storeSettings(_0x53d203,!![]);else logger[_0x1f7c52(0xd6)](_0x1f7c52(0x109));}),_0x4f0964['on'](_0x408672(0x1fd),_0x3018d8=>{const _0x37c753=_0x408672;if(validateAccess(_0x3018d8,_0x425698)[_0x37c753(0xf5)])updateBB('update');else logger[_0x37c753(0xd6)](_0x37c753(0x268));}),_0x4f0964['on'](_0x408672(0x1c5),_0x1e1739=>{const _0xe5bf38=_0x408672;if(validateAccess(_0x1e1739,_0x425698)[_0xe5bf38(0xf5)])updateBB(_0xe5bf38(0x1b3));else logger['full'](_0xe5bf38(0x120));}),_0x4f0964['on'](_0x408672(0x162),_0x2d3119=>{const _0x14c6a0=_0x408672;if(validateAccess(_0x2d3119,_0x425698)[_0x14c6a0(0xf5)]){const _0xc71e1a=getClient(_0x4f0964['id']);if(_0xc71e1a)getBackupFiles(_0xc71e1a['uuid']);else logger[_0x14c6a0(0xd6)](_0x14c6a0(0x138));}else logger['full'](_0x14c6a0(0x150));}),_0x4f0964['on']('restore-backup-file',(_0xce3b82,_0x21761a)=>{const _0x33ce3b=_0x408672;if(validateAccess(_0x21761a,_0x425698)[_0x33ce3b(0xf5)])restoreBackupFile(_0xce3b82);else logger[_0x33ce3b(0xd6)](_0x33ce3b(0x15b));}),_0x4f0964['on'](_0x408672(0x105),_0x415f41=>{const _0x3189cc=_0x408672;if(validateAccess(_0x415f41,_0x425698)[_0x3189cc(0xf5)])getMessages();else logger[_0x3189cc(0xd6)](_0x3189cc(0x22f));}),_0x4f0964['on'](_0x408672(0x1ee),(_0x406862,_0x482a95)=>{const _0x138fc1=_0x408672;if(validateAccess(_0x482a95,_0x425698)[_0x138fc1(0xf5)])confirmMessage(_0x406862);else logger[_0x138fc1(0xd6)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4f0964['on'](_0x408672(0x264),_0x1bb78a=>{const _0x40c9da=_0x408672;if(validateAccess(_0x1bb78a,_0x425698)[_0x40c9da(0xf5)]){if(devices[_0x425698][_0x40c9da(0x1db)])clearTimeout(devices[_0x425698][_0x40c9da(0x1db)]);if(devices[_0x425698]['pidExpireLogin'])clearTimeout(devices[_0x425698][_0x40c9da(0x25b)]);removeSocketListeners(getClient(_0x4f0964['id'])[_0x40c9da(0x1a0)]),addBlacklist(_0x425698),devices[_0x425698][_0x40c9da(0x1d2)]=null,devices[_0x425698][_0x40c9da(0xdf)]=null,devices[_0x425698][_0x40c9da(0x249)][_0x40c9da(0x256)]=null,logger[_0x40c9da(0x189)](_0x40c9da(0x266)+_0x425698['slice'](-0x8)),io['to'](getClient(_0x4f0964['id'])[_0x40c9da(0x1a0)])[_0x40c9da(0x21d)](_0x40c9da(0x1bc),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x40c9da(0xd6)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x5694bd){const _0x30c20a=_0x3d299f,_0x1d9e92=getClient(_0x5694bd['id'])[_0x30c20a(0x23f)],_0x1b31e5=getClient(_0x5694bd['id'])[_0x30c20a(0x1a0)];_0x5694bd['on'](_0x30c20a(0xd8),(_0x29e9ad,_0x3758e5)=>{const _0x214c8d=_0x30c20a;if(validateAccess(_0x3758e5,_0x1b31e5)['allow']){if(pid[_0x1d9e92])pid[_0x1d9e92]['send']({'function':'emitHistory','args':_0x29e9ad});}else logger[_0x214c8d(0xd6)](_0x214c8d(0x1ed));}),_0x5694bd['on']('delete-alerts',(_0x5aee36,_0x4c8562)=>{const _0x5635f9=_0x30c20a;if(validateAccess(_0x4c8562,_0x1b31e5)[_0x5635f9(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92]['send']({'function':'deleteHistoryAlerts','args':_0x5aee36});}else logger['full'](_0x5635f9(0x149));}),_0x5694bd['on']('get-portfolio',(_0xa24861,_0x33427c)=>{const _0x5a8a76=_0x30c20a;if(validateAccess(_0x33427c,_0x1b31e5)[_0x5a8a76(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92]['send']({'function':_0x5a8a76(0x251),'args':_0xa24861});}else logger[_0x5a8a76(0xd6)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x5694bd['on'](_0x30c20a(0xce),(_0x7a3eaf,_0x5c016c)=>{const _0x341103=_0x30c20a;if(validateAccess(_0x5c016c,_0x1b31e5)[_0x341103(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92][_0x341103(0x158)]({'function':'storeConfiguration','args':_0x7a3eaf});}else logger['full'](_0x341103(0xf7));}),_0x5694bd['on'](_0x30c20a(0xdb),(_0x39e5fe,_0x4858ef)=>{const _0xca99d3=_0x30c20a;if(validateAccess(_0x4858ef,_0x1b31e5)[_0xca99d3(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92][_0xca99d3(0x158)]({'function':_0xca99d3(0x214),'args':_0x39e5fe});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x5694bd['on']('store-fiat',(_0x2cc324,_0x17200d)=>{const _0x10c8f5=_0x30c20a;if(validateAccess(_0x17200d,_0x1b31e5)[_0x10c8f5(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92]['send']({'function':_0x10c8f5(0x1fb),'args':_0x2cc324});}else logger[_0x10c8f5(0xd6)](_0x10c8f5(0x172));}),_0x5694bd['on'](_0x30c20a(0x113),_0x60f521=>{const _0x504001=_0x30c20a;if(validateAccess(_0x60f521,_0x1b31e5)[_0x504001(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92][_0x504001(0x158)]({'function':_0x504001(0x20f),'args':null});}else logger['full'](_0x504001(0x175));}),_0x5694bd['on'](_0x30c20a(0x1b7),_0x10fad3=>{const _0x729c09=_0x30c20a;if(validateAccess(_0x10fad3,_0x1b31e5)[_0x729c09(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92][_0x729c09(0x158)]({'function':_0x729c09(0xd3),'args':null});}else logger[_0x729c09(0xd6)](_0x729c09(0x156));}),_0x5694bd['on']('place-order',(_0x1a785c,_0x286c0d)=>{const _0x1b8ba8=_0x30c20a;if(validateAccess(_0x286c0d,_0x1b31e5)[_0x1b8ba8(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92][_0x1b8ba8(0x158)]({'function':_0x1b8ba8(0x28c),'args':_0x1a785c});}else logger[_0x1b8ba8(0xd6)](_0x1b8ba8(0x199));}),_0x5694bd['on']('cancel-loading',_0x10272a=>{const _0x172b04=_0x30c20a;if(validateAccess(_0x10272a,_0x1b31e5)['allow']){if(pid[_0x1d9e92])pid[_0x1d9e92][_0x172b04(0x158)]({'function':'cancelLoading','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5694bd['on'](_0x30c20a(0x15c),_0x1dd6f7=>{const _0x1c1cf7=_0x30c20a;if(validateAccess(_0x1dd6f7,_0x1b31e5)[_0x1c1cf7(0xf5)]){if(pid[_0x1d9e92])pid[_0x1d9e92][_0x1c1cf7(0x158)]({'function':_0x1c1cf7(0x215),'args':null});}else logger[_0x1c1cf7(0xd6)](_0x1c1cf7(0x1d4));}),_0x5694bd['on'](_0x30c20a(0x1fd),_0x1f169a=>{const _0x28028e=_0x30c20a;if(validateAccess(_0x1f169a,_0x1b31e5)['allow'])updateBB(_0x28028e(0x245));else logger[_0x28028e(0xd6)](_0x28028e(0x268));}),_0x5694bd['on'](_0x30c20a(0x105),_0x32f5cb=>{const _0x35a9a6=_0x30c20a;if(validateAccess(_0x32f5cb,_0x1b31e5)[_0x35a9a6(0xf5)])getMessages();else logger[_0x35a9a6(0xd6)](_0x35a9a6(0x22f));}),_0x5694bd['on'](_0x30c20a(0x1ee),(_0x5c97fd,_0x26b03a)=>{const _0x281c64=_0x30c20a;if(validateAccess(_0x26b03a,_0x1b31e5)['allow'])confirmMessage(_0x5c97fd);else logger[_0x281c64(0xd6)](_0x281c64(0x10b));}),_0x5694bd['on'](_0x30c20a(0x264),_0x40de74=>{const _0x19eea4=_0x30c20a;if(validateAccess(_0x40de74,_0x1b31e5)[_0x19eea4(0xf5)]){if(devices[_0x1b31e5][_0x19eea4(0x1db)])clearTimeout(devices[_0x1b31e5][_0x19eea4(0x1db)]);if(devices[_0x1b31e5][_0x19eea4(0x25b)])clearTimeout(devices[_0x1b31e5][_0x19eea4(0x25b)]);removeSocketListeners(getClient(_0x5694bd['id'])[_0x19eea4(0x1a0)]),addBlacklist(_0x1b31e5),devices[_0x1b31e5][_0x19eea4(0x1d2)]=null,devices[_0x1b31e5][_0x19eea4(0xdf)]=null,devices[_0x1b31e5][_0x19eea4(0x249)][_0x19eea4(0x256)]=null,logger[_0x19eea4(0x189)](_0x19eea4(0x266)+_0x1b31e5[_0x19eea4(0x204)](-0x8)),io['to'](getClient(_0x5694bd['id'])['uuid'])['emit'](_0x19eea4(0x1bc),{'access':{'allow':![],'reason':_0x19eea4(0x25a),'token':null}});}else logger[_0x19eea4(0xd6)](_0x19eea4(0x1b0));});}function removeSocketListeners(_0x45802a){getClientsWithUuid(_0x45802a)['forEach'](_0x186d6c=>{const _0x7ca396=_0x53da;getSocket(_0x186d6c['id'])[_0x7ca396(0x1b9)]();});}function cleanSettings(){const _0x194f85=_0x3d299f;let _0x2cce1f=settings;return settings[_0x194f85(0x135)]&&settings[_0x194f85(0x135)]!=''&&(_0x2cce1f={..._0x2cce1f,'telegramToken':_0x194f85(0x1d8)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x2cce1f={..._0x2cce1f,'bbPassword':_0x194f85(0x1d8)}),(settings['bbPassword']&&settings[_0x194f85(0x183)]==_0x194f85(0xff)||settings[_0x194f85(0x135)]&&settings[_0x194f85(0x135)]==_0x194f85(0xff))&&(_0x2cce1f={..._0x2cce1f,'restored':{'password':settings['bbPassword']==_0x194f85(0xff),'telegram':settings[_0x194f85(0x135)]==_0x194f85(0xff)}}),_0x2cce1f;}async function updateBB(_0x5d6e86){const _0x251ba2=_0x3d299f;await backupConfigFiles(),installingUpdate=!![],config[_0x251ba2(0x142)](_0x4657b0=>{restartBot(_0x4657b0['botID']);}),logger['debug'](_0x251ba2(0x13d)+_0x5d6e86);if(_0x5d6e86==_0x251ba2(0x245))process['send']({'update':!![]},_0x31998a=>{});else _0x5d6e86==_0x251ba2(0x1b3)&&process[_0x251ba2(0x158)]({'reinstall':!![]},_0x5b4b5e=>{});}function startBot(_0x4b5d8b,_0x4947c8,_0x41f067){const _0x2e3f1f=_0x3d299f;if(debugging)_0x4b5d8b[_0x2e3f1f(0x1ef)]('-d');let _0x361a49=![];const _0xfec8e=_0x4b5d8b[0x0];_0x4947c8={..._0x4947c8,'stdio':[_0x2e3f1f(0xdd),'inherit',_0x2e3f1f(0xdd),_0x2e3f1f(0x225)]},pid[_0xfec8e]=childProcess[_0x2e3f1f(0x271)](botfile,_0x4b5d8b,_0x4947c8),pid[_0xfec8e]['on'](_0x2e3f1f(0x22c),_0x36cd9c=>{const _0x30142b=_0x2e3f1f;switch(Object[_0x30142b(0x248)](_0x36cd9c)[0x0]){case _0x30142b(0x269):updateBotName(_0xfec8e,_0x36cd9c[_0x30142b(0x269)]);break;case'updatebotmanager':updateBotManager();break;case _0x30142b(0x1bc):updateStatus(_0xfec8e,_0x36cd9c['status']);break;case _0x30142b(0x184):updateLive(_0xfec8e,_0x36cd9c[_0x30142b(0x184)]);break;case _0x30142b(0x116):updateLive(_0xfec8e,_0x36cd9c['started']),io['to'](_0xfec8e)['emit'](_0x30142b(0x1bc),{'access':{'allow':![],'reason':_0x30142b(0x15d),'token':null}});break;case _0x30142b(0x1ba):_0x36cd9c['stop']=='restart'&&restartBot(_0xfec8e);_0x36cd9c['stop']==_0x30142b(0x1c1)&&toggleBot(_0xfec8e,_0x30142b(0x1ea),_0x30142b(0x202));break;case'telegram':sendTelegram(_0xfec8e,_0x36cd9c[_0x30142b(0x258)]);break;case _0x30142b(0xe6):sendTelegramMsg(_0x36cd9c[_0x30142b(0xe6)]);break;case _0x30142b(0x282):io['to'](_0xfec8e)[_0x30142b(0x21d)](_0x36cd9c[_0x30142b(0x282)],_0x36cd9c[_0x30142b(0x170)]);break;}}),pid[_0xfec8e]['on'](_0x2e3f1f(0x1ad),function(_0x581ac3){if(_0x361a49)return;_0x361a49=!![],_0x41f067(_0x581ac3);}),pid[_0xfec8e]['on'](_0x2e3f1f(0x272),async function(_0x2e4664){const _0x1815cb=_0x2e3f1f;if(installingUpdate)return;if(_0x361a49)return;_0x361a49=!![],_0x41f067(null);const _0x2c52ff=dbConfig[_0x1815cb(0xf3)](_0x1815cb(0x1f2))[_0x1815cb(0x181)]({'botID':_0xfec8e})[_0x1815cb(0x25c)]();_0x2c52ff&&(_0x2c52ff[_0x1815cb(0x1bc)]==_0x1815cb(0x1af)||_0x2c52ff[_0x1815cb(0x1bc)]=='new')&&(await sleep(0x3e8),updateLive(_0xfec8e,_0x1815cb(0x202)),logger[_0x1815cb(0xd6)](_0x1815cb(0x154)+_0xfec8e),startBot([_0xfec8e,userID],{'cwd':bbpath},function(_0x3e57d9){const _0x4504b8=_0x1815cb;if(_0x3e57d9)logger[_0x4504b8(0xd6)](_0x3e57d9);}));});}function stopBot(_0x75755f){const _0x2455a5=_0x3d299f;getClientsWithBotID(_0x75755f)[_0x2455a5(0x142)](_0x2a7f59=>{getSocket(_0x2a7f59['id'])['disconnect'](!![]),removeClient(_0x2a7f59['id']);}),pid[_0x75755f]&&(pid[_0x75755f][_0x2455a5(0x1c1)](),pid[_0x75755f]=null);}function restartBot(_0x5c0b5f){const _0x1f92fb=_0x3d299f;if(pid[_0x5c0b5f])pid[_0x5c0b5f][_0x1f92fb(0x1c1)]();}function addBot(){const _0x1500f0=_0x3d299f;let _0x563543;for(let _0x4810b3=0x1;_0x4810b3<0x3e9;_0x4810b3++){_0x563543=_0x4810b3[_0x1500f0(0x244)]()['padStart'](0x3,'0');let _0x1adff5=config[_0x1500f0(0x181)](_0x58f763=>_0x58f763['botID']==_0x563543);if(!_0x1adff5)break;}if(_0x563543===_0x1500f0(0xd9)){logger['full'](_0x1500f0(0x10a));return;}logger[_0x1500f0(0xd6)](_0x1500f0(0x18a)+_0x563543),dbConfig['get'](_0x1500f0(0x1f2))[_0x1500f0(0x1ef)]({'botID':_0x563543,'botname':'Bot\x20'+_0x563543,'status':'new','live':''})[_0x1500f0(0x198)](),startBot([_0x563543,userID],{'cwd':bbpath},function(_0x4b9124){const _0x20decc=_0x1500f0;if(_0x4b9124)logger[_0x20decc(0xd6)](_0x4b9124);}),config=getConfiguration(),io['to'](_0x1500f0(0x18f))[_0x1500f0(0x21d)]('bots',config),broadcastToBots(_0x1500f0(0x1f2),JSON[_0x1500f0(0x124)](config));}function deleteBot(_0x4d3a45){const _0x1575e6=_0x3d299f;getClientsWithBotID(_0x4d3a45)[_0x1575e6(0x142)](_0x26e1c4=>{const _0x3fe231=_0x1575e6;getSocket(_0x26e1c4['id'])[_0x3fe231(0x280)](!![]),removeClient(_0x26e1c4['id']);}),dbConfig['get'](_0x1575e6(0x1f2))[_0x1575e6(0x24a)]({'botID':_0x4d3a45})[_0x1575e6(0x198)](),logger[_0x1575e6(0xd6)](_0x1575e6(0x1dc)+_0x4d3a45),stopBot(_0x4d3a45);try{if(fs[_0x1575e6(0x210)](path['join'](configpath,_0x1575e6(0x284)+_0x4d3a45+_0x1575e6(0x12b))))fs[_0x1575e6(0xe7)](path[_0x1575e6(0x1dd)](configpath,_0x1575e6(0x284)+_0x4d3a45+_0x1575e6(0x12b)));if(fs[_0x1575e6(0x210)](path[_0x1575e6(0x1dd)](configpath,'bot-'+_0x4d3a45+_0x1575e6(0x1d6))))fs['unlinkSync'](path[_0x1575e6(0x1dd)](configpath,'bot-'+_0x4d3a45+_0x1575e6(0x1d6)));if(fs[_0x1575e6(0x210)](path[_0x1575e6(0x1dd)](configpath,_0x1575e6(0x284)+_0x4d3a45+'-performance.json')))fs['unlinkSync'](path[_0x1575e6(0x1dd)](configpath,'bot-'+_0x4d3a45+'-performance.json'));if(fs[_0x1575e6(0x210)](path[_0x1575e6(0x1dd)](configpath,_0x1575e6(0x284)+_0x4d3a45+_0x1575e6(0x261))))fs[_0x1575e6(0xe7)](path[_0x1575e6(0x1dd)](configpath,_0x1575e6(0x284)+_0x4d3a45+_0x1575e6(0x261)));}catch(_0x45dbe2){if(_0x45dbe2)logger[_0x1575e6(0xd6)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x45dbe2);}config=getConfiguration(),io['to']('botmanager')[_0x1575e6(0x21d)](_0x1575e6(0x1f2),config),broadcastToBots(_0x1575e6(0x1f2),JSON[_0x1575e6(0x124)](config));}function toggleBot(_0x4b4e3f,_0x462343,_0x5c7149){const _0x275628=_0x3d299f;dbConfig[_0x275628(0xf3)]('bots')[_0x275628(0x181)]({'botID':_0x4b4e3f})[_0x275628(0x11a)]({'status':_0x462343})['assign']({'live':_0x5c7149})['write']();if(_0x462343==_0x275628(0x1af)||_0x462343=='new')logger['full'](_0x275628(0x139)+_0x4b4e3f),startBot([_0x4b4e3f,userID],{'cwd':bbpath},function(_0x385213){if(_0x385213)logger['full'](_0x385213);});else(_0x462343==_0x275628(0x1ea)||_0x462343==_0x275628(0x1fc))&&(logger[_0x275628(0xd6)](_0x275628(0x279)+_0x4b4e3f),stopBot(_0x4b4e3f));config=getConfiguration(),io['to'](_0x275628(0x18f))[_0x275628(0x21d)](_0x275628(0x1f2),config),broadcastToBots(_0x275628(0x1f2),JSON['stringify'](config));}function toggleStatus(_0x55a314){const _0x1ac42f=_0x3d299f;let _0x5d06ea=dbConfig[_0x1ac42f(0xf3)]('bots')[_0x1ac42f(0x181)]({'botID':_0x55a314})[_0x1ac42f(0x25c)](),_0x592601;if(_0x5d06ea[_0x1ac42f(0x1bc)]===_0x1ac42f(0x1af))_0x592601=_0x1ac42f(0x1ea);else{if(_0x5d06ea[_0x1ac42f(0x1bc)]===_0x1ac42f(0x11b))_0x592601=_0x1ac42f(0x1fc);else{if(_0x5d06ea[_0x1ac42f(0x1bc)]===_0x1ac42f(0x1fc))_0x592601=_0x1ac42f(0x11b);else{if(_0x5d06ea[_0x1ac42f(0x1bc)]==='disabled')_0x592601=_0x1ac42f(0x1af);}}}return _0x592601;}function updateStatus(_0xe889eb,_0x38da77){const _0x2476fc=_0x3d299f;dbConfig[_0x2476fc(0xf3)]('bots')[_0x2476fc(0x181)]({'botID':_0xe889eb})[_0x2476fc(0x11a)]({'status':_0x38da77})[_0x2476fc(0x198)](),config=getConfiguration(),io['to'](_0x2476fc(0x18f))['emit'](_0x2476fc(0x1f2),config),broadcastToBots('bots',JSON[_0x2476fc(0x124)](config));}function updateLive(_0x26299d,_0x5e03ec){const _0x49e73e=_0x3d299f;dbConfig[_0x49e73e(0xf3)]('bots')[_0x49e73e(0x181)]({'botID':_0x26299d})['assign']({'live':_0x5e03ec})[_0x49e73e(0x198)](),config=getConfiguration(),io['to'](_0x49e73e(0x18f))[_0x49e73e(0x21d)](_0x49e73e(0x1f2),config),broadcastToBots(_0x49e73e(0x1f2),JSON[_0x49e73e(0x124)](config));}function updateBotName(_0xc89f8,_0x1d6d81){const _0x17af08=_0x3d299f;dbConfig[_0x17af08(0xf3)](_0x17af08(0x1f2))['find']({'botID':_0xc89f8})['assign']({'botname':_0x1d6d81})[_0x17af08(0x198)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x17af08(0x1f2),config),broadcastToBots(_0x17af08(0x1f2),JSON['stringify'](config));}function updateBotManager(){const _0x197ad0=_0x3d299f;config=getConfiguration(),io['to'](_0x197ad0(0x18f))[_0x197ad0(0x21d)](_0x197ad0(0x1f2),config),broadcastToBots(_0x197ad0(0x1f2),JSON[_0x197ad0(0x124)](config));}function toggleBotMode(_0x47fae7){const _0x2451cb=_0x3d299f;if(pid[_0x47fae7])pid[_0x47fae7][_0x2451cb(0x158)]({'function':_0x2451cb(0x1cb),'args':null});else{const _0x284950=configpath+'bot-'+_0x47fae7+_0x2451cb(0x12b),_0x13ce92=fs[_0x2451cb(0x26a)](_0x284950),_0xf557b0=JSON['parse'](_0x13ce92),_0x123a61=_0xf557b0[_0x2451cb(0x23f)][0x0][_0x2451cb(0x16b)];_0xf557b0[_0x2451cb(0x23f)][0x0]['headless']=!_0x123a61;const _0x23f18d=JSON[_0x2451cb(0x124)](_0xf557b0,null,0x2);fs[_0x2451cb(0x246)](_0x284950,_0x23f18d),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x2451cb(0x1f2),JSON['stringify'](config));}}function telegramError(_0x34d1b0){const _0x46d46e=_0x3d299f;logger[_0x46d46e(0x243)](getTimeStamp()+_0x46d46e(0x1cf));}function validateTelegram(_0x289655){const _0x5db74c=_0x3d299f;if(_0x289655[_0x5db74c(0x292)][_0x5db74c(0x1ae)]!=settings[_0x5db74c(0x169)]&&'@'+_0x289655[_0x5db74c(0x292)][_0x5db74c(0x1ae)]!=settings['telegramUsername'])return tgBot[_0x5db74c(0x267)](_0x289655[_0x5db74c(0x285)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x5db74c(0xfb)})[_0x5db74c(0x277)](_0x470b5f=>{telegramError(_0x470b5f);}),![];return!![];}async function initTelegram(){const _0x83ee0a=_0x3d299f;if(tgBot)tgBot[_0x83ee0a(0x17e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x83ee0a(0x135)],{'polling':!![]});let _0x1f4310=_0x83ee0a(0x28b);_0x1f4310+='\x0a',_0x1f4310+=_0x83ee0a(0xd5),_0x1f4310+=_0x83ee0a(0x28e),_0x1f4310+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x1f4310+=_0x83ee0a(0xed),_0x1f4310+=_0x83ee0a(0x227),_0x1f4310+=_0x83ee0a(0x1c4),_0x1f4310+=_0x83ee0a(0x19b),_0x1f4310+=_0x83ee0a(0x22a),_0x1f4310+=_0x83ee0a(0x26c),_0x1f4310+=_0x83ee0a(0x26f),_0x1f4310+=_0x83ee0a(0x26d),_0x1f4310+=_0x83ee0a(0xf0),_0x1f4310+=_0x83ee0a(0x19e),_0x1f4310+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x56ef0a=_0x83ee0a(0x223);_0x56ef0a+='\x0a',_0x56ef0a+=_0x1f4310,tgBot[_0x83ee0a(0xe1)](/\/start/,_0x3630e7=>{const _0x3c256b=_0x83ee0a;if(!validateTelegram(_0x3630e7))return;if(settings[_0x3c256b(0x140)]!=_0x3630e7[_0x3c256b(0x285)]['id'])updateSetting(_0x3c256b(0x140),_0x3630e7['chat']['id']);updateSetting(_0x3c256b(0x133),!![]),tgBot['sendMessage'](_0x3630e7[_0x3c256b(0x285)]['id'],_0x56ef0a)[_0x3c256b(0x277)](_0x2d952f=>{telegramError(_0x2d952f);});}),tgBot[_0x83ee0a(0xe1)](/\/enable/,_0x1ced3f=>{const _0x2c798b=_0x83ee0a;if(!validateTelegram(_0x1ced3f))return;if(settings[_0x2c798b(0x140)]!=_0x1ced3f[_0x2c798b(0x285)]['id'])updateSetting('telegramChatId',_0x1ced3f[_0x2c798b(0x285)]['id']);updateSetting(_0x2c798b(0x133),!![]),tgBot[_0x2c798b(0x267)](_0x1ced3f['chat']['id'],_0x2c798b(0x161))[_0x2c798b(0x277)](_0x44edcc=>{telegramError(_0x44edcc);});}),tgBot[_0x83ee0a(0xe1)](/\/config/,async _0x548d93=>{const _0x536202=_0x83ee0a;if(!validateTelegram(_0x548d93))return;tgBot[_0x536202(0x250)](_0x536202(0x1b4)),tgBot[_0x536202(0x267)](_0x548d93[_0x536202(0x285)]['id'],_0x536202(0x221),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x536202(0x108)},{'text':_0x536202(0x1d9),'callback_data':_0x536202(0x17d)},{'text':_0x536202(0x21c),'callback_data':_0x536202(0x1b1)}]]}})[_0x536202(0x277)](_0x5a520c=>{telegramError(_0x5a520c);}),tgBot['on']('callback_query',async _0xa0a8e0=>{const _0x2fe0ab=_0x536202,_0x1451e6=_0xa0a8e0['data'],_0x47f966=_0xa0a8e0['message'];tgBot['answerCallbackQuery'](_0xa0a8e0['id'])['then'](async()=>{const _0x49e171=_0x53da;_0x1451e6==_0x49e171(0x108)&&(updateSetting(_0x49e171(0x1bd),'orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x49e171(0x267)](_0x47f966[_0x49e171(0x285)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x51c0db=>{telegramError(_0x51c0db);}));_0x1451e6==_0x49e171(0x17d)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x49e171(0x133),!![]),await tgBot[_0x49e171(0x267)](_0x47f966[_0x49e171(0x285)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x49e171(0x277)](_0x5e4aa2=>{telegramError(_0x5e4aa2);}));_0x1451e6==_0x49e171(0x1b1)&&(updateSetting('telegramEvents','all'),updateSetting(_0x49e171(0x133),!![]),await tgBot[_0x49e171(0x267)](_0x47f966['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x353624=>{telegramError(_0x353624);}));if(!settings[_0x49e171(0x140)])tgBot[_0x49e171(0x267)](_0x47f966[_0x49e171(0x285)]['id'],_0x49e171(0x26e))[_0x49e171(0x277)](_0x5001b3=>{telegramError(_0x5001b3);});}),tgBot[_0x2fe0ab(0x250)](_0x2fe0ab(0x1b4));});}),tgBot['onText'](/\/status/,_0x8b714f=>{const _0x2798fb=_0x83ee0a;if(!validateTelegram(_0x8b714f))return;const _0x50f359=getBotsWithMode();let _0x313c51=_0x2798fb(0x1a6);config[_0x2798fb(0x142)](_0x2fb36d=>{const _0x41388f=_0x2798fb,_0x61749=_0x50f359[_0x41388f(0x181)](_0x1b99bc=>_0x1b99bc[_0x41388f(0x14a)]==_0x2fb36d[_0x41388f(0x14a)])['mode'];_0x313c51+='Bot\x20'+_0x2fb36d[_0x41388f(0x14a)]+':\x20'+_0x2fb36d['status']+_0x41388f(0x29b)+_0x61749+_0x41388f(0x29b)+_0x2fb36d[_0x41388f(0x184)]+'\x0a';}),_0x313c51+='\x0a',_0x313c51+=_0x2798fb(0x191),_0x313c51+=!settings[_0x2798fb(0x133)]?'Notifications\x20disabled\x0a':_0x2798fb(0x114),_0x313c51+=settings[_0x2798fb(0x133)]?settings['telegramEvents']==_0x2798fb(0x1b1)?_0x2798fb(0xfa):'Notifications\x20types:\x20'+settings[_0x2798fb(0x1bd)]+_0x2798fb(0x16c):'',tgBot[_0x2798fb(0x267)](_0x8b714f[_0x2798fb(0x285)]['id'],_0x313c51,{'parse_mode':_0x2798fb(0xfb)})['catch'](_0x39856c=>{telegramError(_0x39856c);});}),tgBot[_0x83ee0a(0xe1)](/\/restart/,_0x4b46c4=>{const _0x29bc47=_0x83ee0a;if(!validateTelegram(_0x4b46c4))return;tgBot['removeListener']('callback_query');const _0x3f19a6=getEnabledBots();if(_0x3f19a6[_0x29bc47(0x1bb)]==0x0)tgBot[_0x29bc47(0x267)](_0x4b46c4['chat']['id'],_0x29bc47(0x11d))[_0x29bc47(0x277)](_0x1291b1=>{telegramError(_0x1291b1);});else{if(_0x3f19a6[_0x29bc47(0x1bb)]>0x1)_0x3f19a6[_0x29bc47(0x1ef)]({'botID':_0x29bc47(0x1b1)});let _0x2f0cd1=[],_0x22c319=[];const _0x185981=_0x3f19a6[_0x29bc47(0x1bb)]%0x4==0x0||_0x3f19a6[_0x29bc47(0x1bb)]%0x4==0x3||_0x3f19a6[_0x29bc47(0x1bb)]%0x3==0x1?0x4:0x3;let _0x5c0411=0x0;_0x3f19a6[_0x29bc47(0x142)]((_0x921749,_0x29e355)=>{const _0x18c642=_0x29bc47;if(_0x29e355%_0x185981==0x0)_0x22c319=[];_0x22c319[_0x18c642(0x1ef)]({'text':_0x921749['botID']==_0x18c642(0x1b1)?_0x18c642(0x188):_0x18c642(0xdc)+_0x921749['botID'],'callback_data':_0x921749['botID']}),_0x29e355%_0x185981==0x0&&(_0x2f0cd1[_0x5c0411]=_0x22c319,_0x5c0411++);}),tgBot[_0x29bc47(0x267)](_0x4b46c4[_0x29bc47(0x285)]['id'],_0x29bc47(0x1d3),{'reply_markup':{'inline_keyboard':_0x2f0cd1}})['catch'](_0x1b5c24=>{telegramError(_0x1b5c24);}),tgBot['on'](_0x29bc47(0x1b4),async _0x458125=>{const _0x113e5d=_0x29bc47,_0x3ef7a0=_0x458125[_0x113e5d(0x159)],_0x284b76=_0x458125[_0x113e5d(0x22c)];tgBot[_0x113e5d(0x187)](_0x458125['id'])['then'](async()=>{_0x3ef7a0=='all'?config['forEach'](_0x452bea=>{const _0x46dc75=_0x53da;restartBot(_0x452bea[_0x46dc75(0x14a)]);}):restartBot(_0x3ef7a0);}),tgBot[_0x113e5d(0x250)](_0x113e5d(0x1b4));});}}),tgBot[_0x83ee0a(0xe1)](/\/on/,_0x7e4f9f=>{const _0x14e26b=_0x83ee0a;if(!validateTelegram(_0x7e4f9f))return;tgBot[_0x14e26b(0x250)](_0x14e26b(0x1b4));const _0x6f7d4e=getDisabledBots();if(_0x6f7d4e[_0x14e26b(0x1bb)]==0x0)tgBot[_0x14e26b(0x267)](_0x7e4f9f[_0x14e26b(0x285)]['id'],_0x14e26b(0x1e3))[_0x14e26b(0x277)](_0x607759=>{telegramError(_0x607759);});else{if(_0x6f7d4e['length']>0x1)_0x6f7d4e[_0x14e26b(0x1ef)]({'botID':_0x14e26b(0x1b1)});let _0x4138bf=[],_0xd3ec8f=[];const _0x583849=_0x6f7d4e[_0x14e26b(0x1bb)]%0x4==0x0||_0x6f7d4e[_0x14e26b(0x1bb)]%0x4==0x3||_0x6f7d4e[_0x14e26b(0x1bb)]%0x3==0x1?0x4:0x3;let _0x2083e4=0x0;_0x6f7d4e[_0x14e26b(0x142)]((_0x5ee7b6,_0x5a610d)=>{const _0xbb5802=_0x14e26b;if(_0x5a610d%_0x583849==0x0)_0xd3ec8f=[];_0xd3ec8f['push']({'text':_0x5ee7b6[_0xbb5802(0x14a)]=='all'?_0xbb5802(0x188):_0xbb5802(0xdc)+_0x5ee7b6[_0xbb5802(0x14a)],'callback_data':_0x5ee7b6[_0xbb5802(0x14a)]}),_0x5a610d%_0x583849==0x0&&(_0x4138bf[_0x2083e4]=_0xd3ec8f,_0x2083e4++);}),tgBot[_0x14e26b(0x267)](_0x7e4f9f['chat']['id'],_0x14e26b(0x262),{'reply_markup':{'inline_keyboard':_0x4138bf}})[_0x14e26b(0x277)](_0x4ca3b5=>{telegramError(_0x4ca3b5);}),tgBot['on']('callback_query',async _0x3510=>{const _0x4152ce=_0x14e26b,_0xb331c5=_0x3510[_0x4152ce(0x159)],_0x7e1a00=_0x3510[_0x4152ce(0x22c)];tgBot[_0x4152ce(0x187)](_0x3510['id'])[_0x4152ce(0x20b)](async()=>{const _0xb63b92=_0x4152ce;_0xb331c5==_0xb63b92(0x1b1)?(tgBot[_0xb63b92(0x267)](_0x7e1a00[_0xb63b92(0x285)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0xb63b92(0x277)](_0x1b59a6=>{telegramError(_0x1b59a6);}),_0x6f7d4e['forEach'](_0xbce71e=>{const _0x3912ae=_0xb63b92;if(_0xbce71e[_0x3912ae(0x14a)]!=_0x3912ae(0x1b1))toggleBot(_0xbce71e[_0x3912ae(0x14a)],toggleStatus(_0xbce71e[_0x3912ae(0x14a)]),_0x3912ae(0x202));})):(tgBot['sendMessage'](_0x7e1a00[_0xb63b92(0x285)]['id'],_0xb63b92(0xd1)+_0xb331c5)['catch'](_0x1f7250=>{telegramError(_0x1f7250);}),toggleBot(_0xb331c5,toggleStatus(_0xb331c5),'stopped'));}),tgBot[_0x4152ce(0x250)](_0x4152ce(0x1b4));});}}),tgBot[_0x83ee0a(0xe1)](/\/off/,_0x138e48=>{const _0xb317fe=_0x83ee0a;if(!validateTelegram(_0x138e48))return;tgBot['removeListener'](_0xb317fe(0x1b4));const _0x50b15d=getEnabledBots();if(_0x50b15d[_0xb317fe(0x1bb)]==0x0)tgBot['sendMessage'](_0x138e48[_0xb317fe(0x285)]['id'],'No\x20bots\x20running\x20right\x20now')[_0xb317fe(0x277)](_0x2b3d21=>{telegramError(_0x2b3d21);});else{if(_0x50b15d['length']>0x1)_0x50b15d[_0xb317fe(0x1ef)]({'botID':'all'});let _0x4adb11=[],_0x3a4ef4=[];const _0x2cc056=_0x50b15d[_0xb317fe(0x1bb)]%0x4==0x0||_0x50b15d['length']%0x4==0x3||_0x50b15d[_0xb317fe(0x1bb)]%0x3==0x1?0x4:0x3;let _0x4c1337=0x0;_0x50b15d[_0xb317fe(0x142)]((_0x534a09,_0x1c2736)=>{const _0x345601=_0xb317fe;if(_0x1c2736%_0x2cc056==0x0)_0x3a4ef4=[];_0x3a4ef4[_0x345601(0x1ef)]({'text':_0x534a09[_0x345601(0x14a)]==_0x345601(0x1b1)?_0x345601(0x188):_0x345601(0xdc)+_0x534a09[_0x345601(0x14a)],'callback_data':_0x534a09[_0x345601(0x14a)]}),_0x1c2736%_0x2cc056==0x0&&(_0x4adb11[_0x4c1337]=_0x3a4ef4,_0x4c1337++);}),tgBot[_0xb317fe(0x267)](_0x138e48[_0xb317fe(0x285)]['id'],_0xb317fe(0x21f),{'reply_markup':{'inline_keyboard':_0x4adb11}})[_0xb317fe(0x277)](_0xdc0d23=>{telegramError(_0xdc0d23);}),tgBot['on'](_0xb317fe(0x1b4),async _0xf7400e=>{const _0xd7c504=_0xb317fe,_0x3c9b31=_0xf7400e[_0xd7c504(0x159)],_0x4f1bd7=_0xf7400e[_0xd7c504(0x22c)];tgBot[_0xd7c504(0x187)](_0xf7400e['id'])[_0xd7c504(0x20b)](async()=>{const _0x13abda=_0xd7c504;_0x3c9b31=='all'?(tgBot[_0x13abda(0x267)](_0x4f1bd7[_0x13abda(0x285)]['id'],_0x13abda(0x157))[_0x13abda(0x277)](_0x2f1748=>{telegramError(_0x2f1748);}),_0x50b15d[_0x13abda(0x142)](_0x4b67d3=>{const _0x40901d=_0x13abda;if(_0x4b67d3[_0x40901d(0x14a)]!=_0x40901d(0x1b1))toggleBot(_0x4b67d3['botID'],toggleStatus(_0x4b67d3[_0x40901d(0x14a)]),_0x40901d(0x202));})):(tgBot[_0x13abda(0x267)](_0x4f1bd7['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x3c9b31)[_0x13abda(0x277)](_0x2baf68=>{telegramError(_0x2baf68);}),toggleBot(_0x3c9b31,toggleStatus(_0x3c9b31),_0x13abda(0x202)));}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x83ee0a(0xe1)](/\/metrics/,_0x34fef0=>{const _0x485895=_0x83ee0a;if(!validateTelegram(_0x34fef0))return;tgBot[_0x485895(0x250)](_0x485895(0x1b4));const _0x25226c=getEnabledBots();if(_0x25226c[_0x485895(0x1bb)]==0x0)tgBot[_0x485895(0x267)](_0x34fef0[_0x485895(0x285)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x485895(0x277)](_0x28cb40=>{telegramError(_0x28cb40);});else{if(_0x25226c[_0x485895(0x1bb)]>0x1){let _0x342632=[],_0x4f34d2=[];const _0x4aab6a=_0x25226c[_0x485895(0x1bb)]%0x4==0x0||_0x25226c[_0x485895(0x1bb)]%0x4==0x3||_0x25226c[_0x485895(0x1bb)]%0x3==0x1?0x4:0x3;let _0x2386a9=0x0;_0x25226c['forEach']((_0x1124dc,_0x554422)=>{const _0x5c6dc0=_0x485895;if(_0x554422%_0x4aab6a==0x0)_0x4f34d2=[];_0x4f34d2[_0x5c6dc0(0x1ef)]({'text':_0x5c6dc0(0xdc)+_0x1124dc[_0x5c6dc0(0x14a)],'callback_data':_0x1124dc[_0x5c6dc0(0x14a)]}),_0x554422%_0x4aab6a==0x0&&(_0x342632[_0x2386a9]=_0x4f34d2,_0x2386a9++);}),tgBot[_0x485895(0x267)](_0x34fef0[_0x485895(0x285)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x342632}})[_0x485895(0x277)](_0x2384d6=>{telegramError(_0x2384d6);}),tgBot['on'](_0x485895(0x1b4),async _0x5337d3=>{const _0x4670a4=_0x485895,_0x7da342=_0x5337d3[_0x4670a4(0x159)],_0x2d1971=_0x5337d3[_0x4670a4(0x22c)];tgBot[_0x4670a4(0x187)](_0x5337d3['id'])['then'](async()=>{const _0x30b87b=_0x4670a4;if(pid[_0x7da342])pid[_0x7da342]['send']({'function':_0x30b87b(0x145),'args':null});}),tgBot[_0x4670a4(0x250)](_0x4670a4(0x1b4));});}else{const _0x397ac6=_0x25226c[0x0][_0x485895(0x14a)];if(pid[_0x397ac6])pid[_0x397ac6][_0x485895(0x158)]({'function':_0x485895(0x145),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x344d69=>{const _0x3ff8bb=_0x83ee0a;if(!validateTelegram(_0x344d69))return;tgBot[_0x3ff8bb(0x250)]('callback_query');const _0x41c0fc=getEnabledBots();if(_0x41c0fc['length']==0x0)tgBot[_0x3ff8bb(0x267)](_0x344d69[_0x3ff8bb(0x285)]['id'],_0x3ff8bb(0x11d))[_0x3ff8bb(0x277)](_0x2d9e1b=>{telegramError(_0x2d9e1b);});else{if(_0x41c0fc['length']>0x1){let _0x1d6d4b=[],_0x5115da=[];const _0x449b88=_0x41c0fc[_0x3ff8bb(0x1bb)]%0x4==0x0||_0x41c0fc[_0x3ff8bb(0x1bb)]%0x4==0x3||_0x41c0fc[_0x3ff8bb(0x1bb)]%0x3==0x1?0x4:0x3;let _0x2f0a2d=0x0;_0x41c0fc[_0x3ff8bb(0x142)]((_0x4ac2b7,_0x47d27d)=>{const _0x14841e=_0x3ff8bb;if(_0x47d27d%_0x449b88==0x0)_0x5115da=[];_0x5115da[_0x14841e(0x1ef)]({'text':_0x14841e(0xdc)+_0x4ac2b7[_0x14841e(0x14a)],'callback_data':_0x4ac2b7['botID']}),_0x47d27d%_0x449b88==0x0&&(_0x1d6d4b[_0x2f0a2d]=_0x5115da,_0x2f0a2d++);}),tgBot[_0x3ff8bb(0x267)](_0x344d69['chat']['id'],_0x3ff8bb(0x112),{'reply_markup':{'inline_keyboard':_0x1d6d4b}})[_0x3ff8bb(0x277)](_0x1df5c9=>{telegramError(_0x1df5c9);}),tgBot['on']('callback_query',async _0x1c0447=>{const _0x178a52=_0x3ff8bb,_0x653e5a=_0x1c0447[_0x178a52(0x159)],_0x42ca9c=_0x1c0447[_0x178a52(0x22c)];tgBot[_0x178a52(0x187)](_0x1c0447['id'])[_0x178a52(0x20b)](async()=>{const _0x5defb1=_0x178a52;if(pid[_0x653e5a])pid[_0x653e5a][_0x5defb1(0x158)]({'function':_0x5defb1(0x205),'args':null});}),tgBot[_0x178a52(0x250)](_0x178a52(0x1b4));});}else{const _0x303dfe=_0x41c0fc[0x0][_0x3ff8bb(0x14a)];if(pid[_0x303dfe])pid[_0x303dfe][_0x3ff8bb(0x158)]({'function':_0x3ff8bb(0x205),'args':null});}}}),tgBot[_0x83ee0a(0xe1)](/\/update/,async _0x2bcfe4=>{const _0x35a742=_0x83ee0a;if(!validateTelegram(_0x2bcfe4))return;tgBot[_0x35a742(0x250)](_0x35a742(0x1b4)),await getMessages();if(!updateAvailable)tgBot[_0x35a742(0x267)](_0x2bcfe4['chat']['id'],_0x35a742(0x173))[_0x35a742(0x277)](_0x2960be=>{telegramError(_0x2960be);});else!validInstallation?tgBot['sendMessage'](_0x2bcfe4[_0x35a742(0x285)]['id'],_0x35a742(0x168))[_0x35a742(0x277)](_0x28828f=>{telegramError(_0x28828f);}):(tgBot[_0x35a742(0x267)](_0x2bcfe4[_0x35a742(0x285)]['id'],_0x35a742(0x27c),{'reply_markup':{'inline_keyboard':[[{'text':_0x35a742(0x28f),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x35a742(0x277)](_0x484477=>{telegramError(_0x484477);}),tgBot['on']('callback_query',async _0x287fbd=>{const _0xf35512=_0x35a742,_0x26d889=_0x287fbd[_0xf35512(0x159)],_0x505848=_0x287fbd[_0xf35512(0x22c)];tgBot[_0xf35512(0x187)](_0x287fbd['id'])[_0xf35512(0x20b)](async()=>{const _0xfe81a7=_0xf35512;_0x26d889==_0xfe81a7(0x10e)&&(await tgBot[_0xfe81a7(0x267)](_0x505848[_0xfe81a7(0x285)]['id'],_0xfe81a7(0x164))[_0xfe81a7(0x277)](_0xa74773=>{telegramError(_0xa74773);}),updateBB(_0xfe81a7(0x245))),_0x26d889=='no'&&await tgBot[_0xfe81a7(0x267)](_0x505848[_0xfe81a7(0x285)]['id'],_0xfe81a7(0x196))[_0xfe81a7(0x277)](_0x1e47cd=>{telegramError(_0x1e47cd);});}),tgBot[_0xf35512(0x250)](_0xf35512(0x1b4));}));}),tgBot[_0x83ee0a(0xe1)](/\/reinstall/,async _0x279882=>{const _0x2b6986=_0x83ee0a;if(!validateTelegram(_0x279882))return;tgBot[_0x2b6986(0x250)]('callback_query'),!validInstallation?tgBot[_0x2b6986(0x267)](_0x279882[_0x2b6986(0x285)]['id'],_0x2b6986(0x23b))['catch'](_0x97f31d=>{telegramError(_0x97f31d);}):(tgBot[_0x2b6986(0x267)](_0x279882[_0x2b6986(0x285)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x2b6986(0x28f),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x2b6986(0x277)](_0x113dbf=>{telegramError(_0x113dbf);}),tgBot['on'](_0x2b6986(0x1b4),async _0x2dc8e5=>{const _0x5ae615=_0x2b6986,_0x333181=_0x2dc8e5['data'],_0x29b2ce=_0x2dc8e5[_0x5ae615(0x22c)];tgBot['answerCallbackQuery'](_0x2dc8e5['id'])['then'](async()=>{const _0x256a6f=_0x5ae615;_0x333181=='yes'&&(await tgBot[_0x256a6f(0x267)](_0x29b2ce['chat']['id'],_0x256a6f(0x220))[_0x256a6f(0x277)](_0x22fea3=>{telegramError(_0x22fea3);}),updateBB(_0x256a6f(0x1b3))),_0x333181=='no'&&await tgBot['sendMessage'](_0x29b2ce[_0x256a6f(0x285)]['id'],_0x256a6f(0x160))['catch'](_0x4a8f8c=>{telegramError(_0x4a8f8c);});}),tgBot[_0x5ae615(0x250)]('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x1c86e5=>{const _0x165476=_0x83ee0a;if(!validateTelegram(_0x1c86e5))return;tgBot['removeListener'](_0x165476(0x1b4));const _0x1d83b4=getBotsWithMode();if(_0x1d83b4[_0x165476(0x1bb)]==0x0)tgBot[_0x165476(0x267)](_0x1c86e5[_0x165476(0x285)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x165476(0x277)](_0x231a09=>{telegramError(_0x231a09);});else{let _0x5e8533=[],_0x3f2fec=[];const _0x12a7a5=0x2;let _0x610117=0x0;_0x1d83b4[_0x165476(0x142)]((_0x272710,_0xb4ac87)=>{const _0xab32=_0x165476;if(_0xb4ac87%_0x12a7a5==0x0)_0x3f2fec=[];_0x3f2fec[_0xab32(0x1ef)]({'text':'Bot\x20'+_0x272710[_0xab32(0x14a)]+'\x20('+_0x272710[_0xab32(0x23d)]+')','callback_data':_0x272710[_0xab32(0x14a)]}),_0xb4ac87%_0x12a7a5==0x0&&(_0x5e8533[_0x610117]=_0x3f2fec,_0x610117++);}),tgBot[_0x165476(0x267)](_0x1c86e5[_0x165476(0x285)]['id'],_0x165476(0x212),{'reply_markup':{'inline_keyboard':_0x5e8533}})['catch'](_0x48fdb8=>{telegramError(_0x48fdb8);}),tgBot['on'](_0x165476(0x1b4),async _0x28c669=>{const _0x12e1e0=_0x165476,_0x46ddba=_0x28c669[_0x12e1e0(0x159)],_0x5d6564=_0x28c669[_0x12e1e0(0x22c)];tgBot[_0x12e1e0(0x187)](_0x28c669['id'])[_0x12e1e0(0x20b)](async()=>{const _0x2867bf=_0x12e1e0,_0x5b97af=_0x1d83b4[_0x2867bf(0x181)](_0x89eb15=>_0x89eb15[_0x2867bf(0x14a)]==_0x46ddba),_0x4a4b93=_0x5b97af[_0x2867bf(0x23d)]=='auto'?_0x2867bf(0x165):_0x2867bf(0x201);tgBot['sendMessage'](_0x5d6564[_0x2867bf(0x285)]['id'],_0x2867bf(0x275)+_0x46ddba+_0x2867bf(0x151)+_0x4a4b93+_0x2867bf(0x137))[_0x2867bf(0x277)](_0x22226c=>{telegramError(_0x22226c);}),toggleBotMode(_0x46ddba);}),tgBot['removeListener'](_0x12e1e0(0x1b4));});}}),tgBot['onText'](/\/names/,_0x209c17=>{const _0x4a8c88=_0x83ee0a;if(!validateTelegram(_0x209c17))return;let _0x415f5d='';config['forEach'](_0x3ae02d=>{const _0x5b6626=_0x53da;_0x415f5d+=_0x5b6626(0xdc)+_0x3ae02d[_0x5b6626(0x14a)]+':\x20'+_0x3ae02d['botname']+'\x0a';}),tgBot[_0x4a8c88(0x267)](_0x209c17[_0x4a8c88(0x285)]['id'],_0x415f5d,{'parse_mode':_0x4a8c88(0xfb)})['catch'](_0x3d032f=>{telegramError(_0x3d032f);});}),tgBot[_0x83ee0a(0xe1)](/\/disable/,_0x1aed81=>{const _0x517ca6=_0x83ee0a;if(!validateTelegram(_0x1aed81))return;tgBot[_0x517ca6(0x267)](_0x1aed81[_0x517ca6(0x285)]['id'],_0x517ca6(0x123))['catch'](_0x292cd2=>{telegramError(_0x292cd2);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x83ee0a(0xe1)](/\/help/,_0x3fd5b1=>{if(!validateTelegram(_0x3fd5b1))return;tgBot['sendMessage'](_0x3fd5b1['chat']['id'],_0x1f4310)['catch'](_0x4ee21e=>{telegramError(_0x4ee21e);});}),tgBot['on'](_0x83ee0a(0x130),_0x4f8d53=>{const _0x13d2c0=_0x83ee0a;_0x4f8d53[_0x13d2c0(0x244)]()['includes'](_0x13d2c0(0x1d7))&&(logger['full'](_0x13d2c0(0x1df)),tgBot[_0x13d2c0(0x17e)](),tgBot=null,io['to']('botmanager')[_0x13d2c0(0x21d)]('notification',_0x13d2c0(0x1df)));}),process[_0x83ee0a(0x152)](_0x83ee0a(0x118),()=>{const _0x5d50bc=_0x83ee0a;if(tgBot)tgBot[_0x5d50bc(0x17e)]();process['exit'](0x1);}),process[_0x83ee0a(0x152)](_0x83ee0a(0x1fa),()=>{const _0xc14f71=_0x83ee0a;if(tgBot)tgBot[_0xc14f71(0x17e)]();process[_0xc14f71(0x272)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x500e0d,_0x40bff2){const _0x782ac1=_0x3d299f;if(settings[_0x782ac1(0x133)]){if(settings[_0x782ac1(0x1bd)]==_0x782ac1(0x1b1)||(_0x40bff2[_0x782ac1(0xd7)]==_0x782ac1(0x1ad)||_0x40bff2[_0x782ac1(0xd7)]==_0x782ac1(0x254)||_0x40bff2[_0x782ac1(0xd7)]=='success')&&settings['telegramEvents']==_0x782ac1(0x17d)||_0x40bff2['type']==_0x782ac1(0xfe)&&settings[_0x782ac1(0x1bd)]==_0x782ac1(0x108)){if(tgBot&&settings['telegramChatId']){if(_0x40bff2[_0x782ac1(0x1d0)])tgBot['sendMessage'](settings[_0x782ac1(0x140)],_0x40bff2['botname']+_0x782ac1(0x242)+_0x40bff2[_0x782ac1(0x12a)])[_0x782ac1(0x277)](_0x8c5dc2=>{telegramError(_0x8c5dc2);});else tgBot[_0x782ac1(0x267)](settings[_0x782ac1(0x140)],_0x782ac1(0xdc)+_0x500e0d+_0x782ac1(0x242)+_0x40bff2[_0x782ac1(0x12a)])['catch'](_0x339f1e=>{telegramError(_0x339f1e);});}}}}async function sendTelegramMsg(_0x1b1403,_0x22a443=_0x3d299f(0xfb)){const _0x4e7925=_0x3d299f;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0x4e7925(0x140)],_0x1b1403,{'parse_mode':_0x22a443})[_0x4e7925(0x277)](_0x4e5fa5=>{telegramError(_0x4e5fa5);}),!![]):![];}function getDeviceWithIp(_0x1d40a8){return devices['find'](_0x3aa700=>_0x3aa700['ip']===_0x1d40a8);}function temporaryAccess2FA(_0x5d76c1,_0x8e76cf){const _0xa88e44=_0x3d299f;let _0x318bac=new Date(),_0x180cc1=![];if(lastIpApproval){if(_0x318bac-lastIpApproval<0x1388)_0x180cc1=!![];}lastIpApproval=new Date();if(_0x180cc1)return;tgBot&&settings['telegramChatId']&&(tgBot[_0xa88e44(0x250)](_0xa88e44(0x1b4)),tgBot[_0xa88e44(0x267)](settings[_0xa88e44(0x140)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x8e76cf)['show']+_0xa88e44(0x17a),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0xa88e44(0x207),'callback_data':'5'},{'text':_0xa88e44(0x253),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0xa88e44(0x1ff),'callback_data':_0xa88e44(0x1ff)}]]}})['catch'](_0x17ffd3=>{telegramError(_0x17ffd3);}),tgBot['on']('callback_query',async _0x220a88=>{const _0x1acc78=_0xa88e44,_0x3bb570=_0x220a88[_0x1acc78(0x159)],_0x315098=_0x220a88['message'];tgBot[_0x1acc78(0x187)](_0x220a88['id'])[_0x1acc78(0x20b)](async()=>{const _0x18451f=_0x1acc78;devices[_0x5d76c1][_0x18451f(0x1d2)]={'clientip':_0x8e76cf,'timestamp':new Date()['getTime'](),'expiry':_0x3bb570},_0x3bb570!=_0x18451f(0x1ff)?(await tgBot[_0x18451f(0x267)](_0x315098[_0x18451f(0x285)]['id'],_0x18451f(0x180)+_0x3bb570+_0x18451f(0x12e),{'parse_mode':_0x18451f(0xfb)})['catch'](_0x304b8d=>{telegramError(_0x304b8d);}),io['to'](_0x5d76c1)[_0x18451f(0x21d)](_0x18451f(0x1bc),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x18451f(0x267)](_0x315098[_0x18451f(0x285)]['id'],_0x18451f(0x190))['catch'](_0x3a3fb1=>{telegramError(_0x3a3fb1);}),io['to'](_0x5d76c1)[_0x18451f(0x21d)](_0x18451f(0x1bc),{'access':{'allow':![],'reason':_0x18451f(0x1bf),'token':null}}));}),tgBot[_0x1acc78(0x250)](_0x1acc78(0x1b4));}));}function loginAccess2FA(_0x53a825,_0x44ab12){const _0x186494=_0x3d299f;tgBot&&settings[_0x186494(0x140)]&&(tgBot[_0x186494(0x250)](_0x186494(0x1b4)),tgBot[_0x186494(0x267)](settings['telegramChatId'],_0x186494(0xde)+normalizeIP(_0x44ab12)[_0x186494(0x222)]+_0x186494(0x17a),{'parse_mode':_0x186494(0xfb),'reply_markup':{'inline_keyboard':[[{'text':_0x186494(0x1a7),'callback_data':loginExpiry},{'text':_0x186494(0x1ff),'callback_data':_0x186494(0x1ff)}]]}})[_0x186494(0x277)](_0x3af105=>{telegramError(_0x3af105);}),tgBot['on'](_0x186494(0x1b4),async _0x3e6d7c=>{const _0x349b8c=_0x186494,_0x52ffde=_0x3e6d7c[_0x349b8c(0x159)],_0x379a19=_0x3e6d7c[_0x349b8c(0x22c)];tgBot[_0x349b8c(0x187)](_0x3e6d7c['id'])[_0x349b8c(0x20b)](async()=>{const _0x153fc4=_0x349b8c;devices[_0x53a825][_0x153fc4(0xdf)]={'clientip':_0x44ab12,'timestamp':new Date()[_0x153fc4(0x1e4)](),'expiry':_0x52ffde},_0x52ffde!='reject'?(await tgBot[_0x153fc4(0x267)](_0x379a19['chat']['id'],_0x153fc4(0x153),{'parse_mode':'HTML'})['catch'](_0x562099=>{telegramError(_0x562099);}),io['to'](_0x53a825)[_0x153fc4(0x21d)](_0x153fc4(0x1bc),{'access':{'allow':![],'reason':_0x153fc4(0x15d),'token':null}})):(await tgBot[_0x153fc4(0x267)](_0x379a19[_0x153fc4(0x285)]['id'],_0x153fc4(0xee))[_0x153fc4(0x277)](_0x55aae9=>{telegramError(_0x55aae9);}),io['to'](_0x53a825)[_0x153fc4(0x21d)](_0x153fc4(0x1bc),{'access':{'allow':![],'reason':_0x153fc4(0x1f3),'token':null}}));}),tgBot[_0x349b8c(0x250)](_0x349b8c(0x1b4));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x52ac6f=_0x3d299f;return dbConfig[_0x52ac6f(0xf3)](_0x52ac6f(0x1f2))[_0x52ac6f(0x229)](_0x52ac6f(0x14a))[_0x52ac6f(0x278)]({'status':'enabled'})[_0x52ac6f(0x25c)]()||[];}function getDisabledBots(){const _0x4d2401=_0x3d299f;return dbConfig['get'](_0x4d2401(0x1f2))[_0x4d2401(0x229)](_0x4d2401(0x14a))[_0x4d2401(0x278)]({'status':'disabled'})[_0x4d2401(0x25c)]()||[];}function getBotAttributes(_0x21d4df){const _0x4148c0=_0x3d299f;let _0x2d76ea={};const _0x482954=configpath+_0x4148c0(0x284)+_0x21d4df+_0x4148c0(0x12b),_0x13ab66=fs['existsSync'](_0x482954);if(_0x13ab66){const _0x4a8dd9=fs[_0x4148c0(0x26a)](_0x482954);try{const _0x2be736=JSON[_0x4148c0(0x18d)](_0x4a8dd9),_0x17ea8c=_0x2be736?_0x2be736[_0x4148c0(0x23f)][0x0]['headless']:![];_0x2d76ea[_0x4148c0(0x23d)]=_0x17ea8c?_0x4148c0(0x201):_0x4148c0(0x165),_0x2d76ea['botname']=_0x2be736?_0x2be736[_0x4148c0(0x23f)][0x0][_0x4148c0(0x269)]:'Bot\x20'+_0x21d4df;}catch(_0x26569b){_0x2d76ea[_0x4148c0(0x23d)]=_0x4148c0(0x165),_0x2d76ea[_0x4148c0(0x269)]='Bot\x20'+_0x21d4df;}}else _0x2d76ea['mode']=_0x4148c0(0x165),_0x2d76ea[_0x4148c0(0x269)]=_0x4148c0(0xdc)+_0x21d4df;return _0x2d76ea;}function getBotsWithMode(){const _0x5adbf9=_0x3d299f,_0x140e6c=dbConfig[_0x5adbf9(0xf3)](_0x5adbf9(0x1f2))[_0x5adbf9(0x229)](_0x5adbf9(0x14a))['value']()||[];return _0x140e6c[_0x5adbf9(0x142)](_0x35b82d=>{const _0x3b9027=_0x5adbf9;let _0x501f8f=getBotAttributes(_0x35b82d[_0x3b9027(0x14a)]);_0x35b82d[_0x3b9027(0x23d)]=_0x501f8f['mode'];}),_0x140e6c;}function getBotExchanges(){const _0x480397=_0x3d299f;let _0x16d268=[];const _0x24dfdf=dbConfig[_0x480397(0xf3)](_0x480397(0x1f2))[_0x480397(0x229)](_0x480397(0x14a))[_0x480397(0x25c)]()||[];_0x24dfdf[_0x480397(0x142)](_0x218616=>{const _0x9da2ae=_0x480397;if(_0x218616[_0x9da2ae(0x1bc)]=='enabled'){const _0xd8ae2b=configpath+_0x9da2ae(0x284)+_0x218616['botID']+_0x9da2ae(0x12b),_0x5c1a36=fs[_0x9da2ae(0x210)](_0xd8ae2b);let _0x8466bb;if(_0x5c1a36){const _0x2dd764=fs[_0x9da2ae(0x26a)](_0xd8ae2b);try{const _0x466af0=JSON[_0x9da2ae(0x18d)](_0x2dd764);_0x8466bb=_0x466af0?_0x466af0['bot'][0x0][_0x9da2ae(0x178)]:null;}catch(_0x1c365d){}}if(_0x8466bb)_0x16d268[_0x9da2ae(0x1ef)](_0x8466bb);}});const _0x482f3f=[...new Set(_0x16d268)]['sort']();return _0x482f3f;}async function initUser(){const _0x25a052=_0x3d299f;if(!settings[_0x25a052(0x1da)]){const _0x235aea=uuidRandom();mixpanel[_0x25a052(0x19d)](_0x235aea),updateSetting(_0x25a052(0x1da),_0x235aea);}}async function initSecure(){const _0x5d36de=_0x3d299f;let _0x260ad1=getSecure();if(!_0x260ad1[_0x5d36de(0x288)](_0x5d36de(0x15e))){let _0x1a3120=await generateKeys();_0x260ad1[_0x5d36de(0x134)]=_0x1a3120[_0x5d36de(0x134)],_0x260ad1[_0x5d36de(0x24f)]=_0x1a3120[_0x5d36de(0x24f)],_0x260ad1[_0x5d36de(0x15e)]=crypto['randomBytes'](0x20)[_0x5d36de(0x244)](_0x5d36de(0x231));;storeSecure(_0x260ad1);}}function getSettings(){const _0x5a6485=_0x3d299f;return dbSettings[_0x5a6485(0xf3)](_0x5a6485(0x179))[_0x5a6485(0x25c)]()||{};}function getSecure(){const _0x20088f=_0x3d299f;return dbSecure['get']('secure')[_0x20088f(0x25c)]()||{};}function getBlacklist(){const _0x151157=_0x3d299f;return dbSecure[_0x151157(0xf3)]('blacklist')[_0x151157(0x25c)]()||[];}function broadcastToBots(_0x3ed0c3,_0x1c5735){const _0x30c71f=_0x3d299f;config[_0x30c71f(0x142)](_0x4cb481=>{const _0x1c6e61=_0x30c71f;if(_0x4cb481['status']=='enabled'&&_0x4cb481['live']==_0x1c6e61(0x13c)||_0x4cb481[_0x1c6e61(0x1bc)]==_0x1c6e61(0x11b)&&_0x4cb481[_0x1c6e61(0x184)]==_0x1c6e61(0x13c)){if(pid[_0x4cb481[_0x1c6e61(0x14a)]])pid[_0x4cb481[_0x1c6e61(0x14a)]][_0x1c6e61(0x158)]({[_0x3ed0c3]:_0x1c5735});}});}function storeSettings(_0x1fe8e2,_0x21b502=![]){const _0xb56cc0=_0x3d299f;_0x1fe8e2={...settings,..._0x1fe8e2};if(_0x21b502&&_0x1fe8e2[_0xb56cc0(0x183)]!=_0xb56cc0(0x1d8)&&_0x1fe8e2[_0xb56cc0(0x183)]!=_0xb56cc0(0xff)&&_0x1fe8e2[_0xb56cc0(0x183)]!=''){const _0x3a02a6=crypt[_0xb56cc0(0x1c0)](secure['privateKey'],_0x1fe8e2[_0xb56cc0(0x183)])[_0xb56cc0(0x22c)][_0xb56cc0(0x270)]('@')[0x0],_0xc0c7d2=bcrypt['hashSync'](_0x3a02a6,saltRounds);_0x1fe8e2={..._0x1fe8e2,'bbPassword':_0xc0c7d2};}if(_0x21b502&&_0x1fe8e2[_0xb56cc0(0x135)]!=_0xb56cc0(0x1d8)&&_0x1fe8e2[_0xb56cc0(0x135)]!=_0xb56cc0(0xff)&&_0x1fe8e2[_0xb56cc0(0x135)]!=''){const _0x4a2b13=crypt[_0xb56cc0(0x1c0)](secure[_0xb56cc0(0x24f)],_0x1fe8e2[_0xb56cc0(0x135)])[_0xb56cc0(0x22c)]['split']('@')[0x0];_0x1fe8e2={..._0x1fe8e2,'telegramToken':_0x4a2b13};}const _0x455f2d=_0x1fe8e2['telegramToken']!=_0xb56cc0(0x1d8)&&_0x1fe8e2['telegramToken']!=settings[_0xb56cc0(0x135)]||_0x1fe8e2[_0xb56cc0(0x169)]!=settings[_0xb56cc0(0x169)],_0x391e4c=_0x1fe8e2['telegramToken']==''||_0x1fe8e2[_0xb56cc0(0x169)]=='';if(_0x455f2d)_0x1fe8e2[_0xb56cc0(0x1bd)]=_0xb56cc0(0x1b1);for(const [_0x523430,_0x3955f3]of Object[_0xb56cc0(0x27d)](_0x1fe8e2)){if(_0x523430==_0xb56cc0(0x135)&&_0x3955f3==_0xb56cc0(0x1d8)){_0x1fe8e2[_0xb56cc0(0x135)]=settings[_0xb56cc0(0x135)];continue;};if(_0x523430=='bbPassword'&&_0x3955f3==_0xb56cc0(0x1d8)){_0x1fe8e2[_0xb56cc0(0x183)]=settings['bbPassword'];continue;};dbSettings[_0xb56cc0(0x16a)](_0xb56cc0(0x1a8)+_0x523430,_0x3955f3)['write']();}settings=_0x1fe8e2,io['to'](_0xb56cc0(0x18f))[_0xb56cc0(0x21d)](_0xb56cc0(0x179),cleanSettings()),broadcastToBots(_0xb56cc0(0x11f),settings[_0xb56cc0(0x11f)]),broadcastToBots(_0xb56cc0(0x1e0),settings[_0xb56cc0(0x1e0)]);if(_0x455f2d&&!_0x391e4c)initTelegram();if(_0x455f2d&&_0x391e4c)disableTelegram();getAllClients()[_0xb56cc0(0x142)](_0x16f3e0=>{const _0x345b37=_0xb56cc0;getSocket(_0x16f3e0['id'])[_0x345b37(0x21d)](_0x345b37(0x1bc),{'access':{'allow':![],'reason':_0x345b37(0x15d),'token':null}});});}function updateSetting(_0x19557e,_0x4983fc){const _0x29d70c=_0x3d299f;dbSettings['set'](_0x29d70c(0x1a8)+_0x19557e,_0x4983fc)['write'](),settings=getSettings(),io['to'](_0x29d70c(0x18f))[_0x29d70c(0x21d)]('settings',cleanSettings());}function storeSecure(_0x3e2f4d){const _0x58dc5e=_0x3d299f;dbSecure[_0x58dc5e(0xf3)](_0x58dc5e(0xfd))[_0x58dc5e(0x1ef)](_0x3e2f4d)[_0x58dc5e(0x198)](),secure=_0x3e2f4d;}function addBlacklist(_0xe9bb9a){const _0x4f8d45=_0x3d299f;cleanBlacklist();let _0x14eedd;devices[_0xe9bb9a][_0x4f8d45(0x1d2)]?_0x14eedd=Math[_0x4f8d45(0xef)](devices[_0xe9bb9a][_0x4f8d45(0x1d2)][_0x4f8d45(0x27e)],loginExpiry):_0x14eedd=loginExpiry,dbSecure[_0x4f8d45(0xf3)](_0x4f8d45(0x1a9))[_0x4f8d45(0x1ef)]({'expiry':new Date()['getTime']()+_0x14eedd*0x3c*0x3e8,'token':devices[_0xe9bb9a][_0x4f8d45(0x249)][_0x4f8d45(0x256)]})[_0x4f8d45(0x198)](),blacklist=dbSecure['get'](_0x4f8d45(0x1a9))[_0x4f8d45(0x25c)]();}function cleanBlacklist(){const _0x5a7db1=_0x3d299f;let _0x17c89e=dbSecure[_0x5a7db1(0xf3)](_0x5a7db1(0x1a9))[_0x5a7db1(0x177)]()['value'](),_0x4165cd=new Date()[_0x5a7db1(0x1e4)]();_0x17c89e[_0x5a7db1(0x142)](_0x59a10a=>{const _0x4df3ca=_0x5a7db1;_0x59a10a['expiry']<_0x4165cd&&dbSecure[_0x4df3ca(0xf3)](_0x4df3ca(0x1a9))[_0x4df3ca(0x24a)]({'expiry':_0x59a10a[_0x4df3ca(0x27e)]})[_0x4df3ca(0x198)]();});}function initStates(){const _0x2d0895=_0x3d299f;let _0x30fdaa=getConfiguration();_0x30fdaa[_0x2d0895(0x142)](_0x3256fb=>{const _0x3fb3c0=_0x2d0895;_0x3256fb[_0x3fb3c0(0x184)]=_0x3fb3c0(0x202);}),storeConfiguration(_0x30fdaa);}function onKeys(){const _0x483f72=new RSA();return new Promise(_0xcf1e5d=>{const _0x71f92=_0x53da;_0x483f72[_0x71f92(0x237)]()[_0x71f92(0x20b)](_0x24a5be=>{_0xcf1e5d(_0x24a5be);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2a0d73=_0x3d299f;let _0x249ee6=getSettings(),_0x43d388=![];!_0x249ee6['hasOwnProperty'](_0x2a0d73(0x101))&&(_0x249ee6[_0x2a0d73(0x101)]=0x0,_0x43d388=!![]);!_0x249ee6[_0x2a0d73(0x288)](_0x2a0d73(0x23a))&&(_0x249ee6[_0x2a0d73(0x23a)]=0x0,_0x43d388=!![]);!_0x249ee6[_0x2a0d73(0x288)](_0x2a0d73(0x194))&&(_0x249ee6[_0x2a0d73(0x194)]=_0x2a0d73(0x1a3),_0x43d388=!![]);!_0x249ee6[_0x2a0d73(0x288)](_0x2a0d73(0x1e0))&&(_0x249ee6[_0x2a0d73(0x1e0)]=![],_0x43d388=!![]);if(_0x43d388)storeSettings(_0x249ee6);}function storeConfiguration(_0x4326e9){const _0x40739d=_0x3d299f;dbConfig[_0x40739d(0xf3)]('bots')[_0x40739d(0x24a)]()[_0x40739d(0x198)](),_0x4326e9[_0x40739d(0x142)](_0x5a670b=>{const _0x2be07a=_0x40739d;delete _0x5a670b[_0x2be07a(0x23d)];}),dbConfig['get'](_0x40739d(0x1f2))[_0x40739d(0x1ef)](..._0x4326e9)[_0x40739d(0x198)](),config=_0x4326e9;}function resetPassword(){const _0x3fea61=_0x3d299f;tgBot&&settings['telegramChatId']&&(tgBot[_0x3fea61(0x250)](_0x3fea61(0x1b4)),tgBot[_0x3fea61(0x267)](settings[_0x3fea61(0x140)],_0x3fea61(0x235),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3fea61(0x10e)},{'text':'no','callback_data':'no'}]]}})[_0x3fea61(0x277)](_0x1b9230=>{telegramError(_0x1b9230);}),tgBot['on'](_0x3fea61(0x1b4),async _0x1b333c=>{const _0x30221f=_0x3fea61,_0x540106=_0x1b333c[_0x30221f(0x159)],_0x571787=_0x1b333c['message'];tgBot[_0x30221f(0x187)](_0x1b333c['id'])['then'](async()=>{const _0x28e143=_0x30221f;if(_0x540106!='no'){const _0x44d8c3=0xf,_0x2ca59f=_0x28e143(0x17b),_0x2dad90=Array[_0x28e143(0x292)](crypto[_0x28e143(0x25e)](new Uint32Array(_0x44d8c3)))['map'](_0x79d968=>_0x2ca59f[_0x79d968%_0x2ca59f[_0x28e143(0x1bb)]])['join'](''),_0x3ab7e3=bcrypt[_0x28e143(0x21b)](_0x2dad90,saltRounds);storeSettings({'bbPassword':_0x3ab7e3}),await tgBot[_0x28e143(0x267)](_0x571787[_0x28e143(0x285)]['id'],_0x28e143(0xf4)+_0x2dad90,{'parse_mode':_0x28e143(0xfb)})[_0x28e143(0x277)](_0x3ad29b=>{telegramError(_0x3ad29b);});}else await tgBot[_0x28e143(0x267)](_0x571787['chat']['id'],_0x28e143(0x294))[_0x28e143(0x277)](_0x39e9cd=>{telegramError(_0x39e9cd);});}),tgBot[_0x30221f(0x250)](_0x30221f(0x1b4));}));}async function confirmRestore(_0xcd2c44,_0x20c6be){const _0x32e388=_0x3d299f;io['to']('botmanager')[_0x32e388(0x21d)]('notification',_0x32e388(0x211),'success'),tgBot&&settings[_0x32e388(0x140)]&&(tgBot[_0x32e388(0x250)](_0x32e388(0x1b4)),await tgBot['sendMessage'](settings[_0x32e388(0x140)],_0x32e388(0x132),{'parse_mode':_0x32e388(0xfb),'reply_markup':{'inline_keyboard':[[{'text':_0x32e388(0x10e),'callback_data':_0x32e388(0x10e)},{'text':'no','callback_data':'no'}]]}})[_0x32e388(0x277)](_0xeec33=>{telegramError(_0xeec33);}),tgBot['on'](_0x32e388(0x1b4),async _0x4c6402=>{const _0x1d4a42=_0x32e388,_0x3bf999=_0x4c6402[_0x1d4a42(0x159)],_0x54da03=_0x4c6402[_0x1d4a42(0x22c)];tgBot[_0x1d4a42(0x187)](_0x4c6402['id'])[_0x1d4a42(0x20b)](async()=>{const _0xa1b13c=_0x1d4a42;_0x3bf999==_0xa1b13c(0x10e)?(await tgBot[_0xa1b13c(0x267)](_0x54da03[_0xa1b13c(0x285)]['id'],_0xa1b13c(0x13b),{'parse_mode':_0xa1b13c(0xfb)})[_0xa1b13c(0x277)](_0x81026d=>{telegramError(_0x81026d);}),unzipFile(_0xcd2c44,_0x20c6be)):(logger['debug'](_0xa1b13c(0x297)),await tgBot['sendMessage'](_0x54da03[_0xa1b13c(0x285)]['id'],'Restore\x20process\x20aborted')[_0xa1b13c(0x277)](_0x2a66be=>{telegramError(_0x2a66be);}));}),tgBot[_0x1d4a42(0x250)](_0x1d4a42(0x1b4));}));}function getServerTime(){const _0x57f000=_0x3d299f,_0xf4737a=new Date();return _0xf4737a[_0x57f000(0x1a2)]()+'/'+(_0xf4737a['getMonth']()+0x1)[_0x57f000(0x244)]()[_0x57f000(0x131)](0x2,'0')+'/'+_0xf4737a[_0x57f000(0x20a)]()[_0x57f000(0x244)]()['padStart'](0x2,'0')+'\x20'+_0xf4737a['getHours']()[_0x57f000(0x244)]()[_0x57f000(0x131)](0x2,'0')+':'+_0xf4737a[_0x57f000(0x12c)]()[_0x57f000(0x244)]()[_0x57f000(0x131)](0x2,'0')+':'+_0xf4737a['getSeconds']()[_0x57f000(0x244)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x30f683=_0x3d299f,_0x6c7a03=shiftedTime();return _0x6c7a03[_0x30f683(0x1a2)]()+'/'+(_0x6c7a03[_0x30f683(0xe0)]()+0x1)[_0x30f683(0x244)]()[_0x30f683(0x131)](0x2,'0')+'/'+_0x6c7a03[_0x30f683(0x20a)]()[_0x30f683(0x244)]()[_0x30f683(0x131)](0x2,'0')+'\x20'+_0x6c7a03['getHours']()[_0x30f683(0x244)]()[_0x30f683(0x131)](0x2,'0')+':'+_0x6c7a03[_0x30f683(0x12c)]()['toString']()[_0x30f683(0x131)](0x2,'0')+':'+_0x6c7a03[_0x30f683(0x265)]()[_0x30f683(0x244)]()[_0x30f683(0x131)](0x2,'0');}function getCleanTimeStamp(){const _0x58d2dc=_0x3d299f,_0x384a0c=shiftedTime();return _0x384a0c[_0x58d2dc(0x1a2)]()+(_0x384a0c['getMonth']()+0x1)[_0x58d2dc(0x244)]()[_0x58d2dc(0x131)](0x2,'0')+_0x384a0c[_0x58d2dc(0x20a)]()[_0x58d2dc(0x244)]()[_0x58d2dc(0x131)](0x2,'0')+'-'+_0x384a0c[_0x58d2dc(0x217)]()[_0x58d2dc(0x244)]()[_0x58d2dc(0x131)](0x2,'0')+_0x384a0c['getMinutes']()[_0x58d2dc(0x244)]()[_0x58d2dc(0x131)](0x2,'0')+_0x384a0c[_0x58d2dc(0x265)]()[_0x58d2dc(0x244)]()[_0x58d2dc(0x131)](0x2,'0');}function shiftedTime(){const _0x3dccc6=_0x3d299f,_0x44ad31=new Date();let _0x1f8b88=_0x44ad31;if(settings[_0x3dccc6(0x11f)]&&settings[_0x3dccc6(0x11f)]!==0x0)_0x1f8b88=fns['add'](_0x44ad31,{'hours':settings['timeshift']});return _0x1f8b88;}function startScheduler(){const _0x57a281=_0x3d299f,_0x9d701b=new Date()[_0x57a281(0x236)](),_0x372781=shiftedTime()[_0x57a281(0x217)]();_0x372781==0x4&&backupConfigFiles();_0x372781==0x0&&rotateLogFiles();_0x9d701b%0x6==0x0&&triggerAnalytics();_0x9d701b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4d3312){const _0x54734b=_0x3d299f;logger[_0x54734b(0x189)](_0x54734b(0x21e)+_0x4d3312);const _0x50b1e0=getBotsWithMode();_0x50b1e0[_0x54734b(0x1bb)]>0x0?confirmRestore(configbackuppath,_0x4d3312):unzipFile(configbackuppath,_0x4d3312);}async function getBackupFiles(_0x160fcc=null){const _0x46e446=_0x3d299f;let _0x167606=[],_0x3517a4=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3517a4[_0x46e446(0x1f0)]((_0x4c5783,_0x22478c)=>_0x4c5783[_0x46e446(0x1a1)]<_0x22478c[_0x46e446(0x1a1)]?0x1:_0x22478c[_0x46e446(0x1a1)]<_0x4c5783[_0x46e446(0x1a1)]?-0x1:0x0),_0x3517a4[_0x46e446(0x142)](_0x444fb8=>{const _0x126456=_0x46e446;if(!_0x444fb8[_0x126456(0x1b8)]()&&_0x444fb8['name'][_0x126456(0x18c)](_0x126456(0x20d))&&_0x444fb8[_0x126456(0x1a1)][_0x126456(0x295)](_0x126456(0x20c))){const _0x58334e=formatDate(fs[_0x126456(0x1f6)](configbackuppath+_0x444fb8['name'])[_0x126456(0x10f)]);_0x167606[_0x126456(0x1ef)]({'name':_0x444fb8[_0x126456(0x1a1)],'mtime':_0x58334e});}});if(_0x160fcc)io['to'](_0x160fcc)[_0x46e446(0x21d)]('backup-files',_0x167606);else return _0x167606;}async function backupConfigFiles(){const _0x3b0e50=_0x3d299f;await zipFiles(_0x3b0e50(0x104));const _0x1ba61d=getCleanTimeStamp();fs[_0x3b0e50(0x289)](zippath+_0x3b0e50(0x283),configbackuppath+('backup-full@'+_0x1ba61d+_0x3b0e50(0x20c)));let _0x265dc4=fs[_0x3b0e50(0x14e)](configbackuppath,{'withFileTypes':!![]});_0x265dc4['sort']((_0x20a65b,_0x387a6b)=>_0x20a65b[_0x3b0e50(0x1a1)]<_0x387a6b['name']?0x1:_0x387a6b[_0x3b0e50(0x1a1)]<_0x20a65b[_0x3b0e50(0x1a1)]?-0x1:0x0),_0x265dc4[_0x3b0e50(0x1bb)]>maxBackups&&fs[_0x3b0e50(0xe7)](configbackuppath+_0x265dc4[maxBackups][_0x3b0e50(0x1a1)]);}function rotateLogFiles(){const _0x34da5b=_0x3d299f,_0x4a8c89=fs['statSync'](logspath+_0x34da5b(0x147)),_0x165091=_0x4a8c89[_0x34da5b(0x247)]/0x400;if(_0x165091>0x64){let _0x4f0c2a=fs[_0x34da5b(0x14e)](logspath,{'withFileTypes':!![]});_0x4f0c2a[_0x34da5b(0x1f0)]((_0x35b335,_0x544dc0)=>_0x35b335['name']<_0x544dc0[_0x34da5b(0x1a1)]?0x1:_0x544dc0[_0x34da5b(0x1a1)]<_0x35b335[_0x34da5b(0x1a1)]?-0x1:0x0),_0x4f0c2a['forEach'](_0x51cad4=>{const _0x23ce96=_0x34da5b;if(_0x51cad4[_0x23ce96(0x1a1)]=='output-002.log')fs[_0x23ce96(0x289)](logspath+_0x51cad4[_0x23ce96(0x1a1)],logspath+_0x23ce96(0x28a));if(_0x51cad4[_0x23ce96(0x1a1)]==_0x23ce96(0x17c))fs['copyFileSync'](logspath+_0x51cad4[_0x23ce96(0x1a1)],logspath+_0x23ce96(0xec));_0x51cad4[_0x23ce96(0x1a1)]=='output-000.log'&&(fs[_0x23ce96(0x289)](logspath+_0x51cad4[_0x23ce96(0x1a1)],logspath+_0x23ce96(0x17c)),fs['writeFileSync'](logspath+_0x51cad4[_0x23ce96(0x1a1)],''));});}}async function zipFiles(_0x515e3a){const _0x19f01d=_0x3d299f;let _0xcaee68;if(_0x515e3a==_0x19f01d(0x298))_0xcaee68=logspath;if(_0x515e3a==_0x19f01d(0xe4))_0xcaee68=configpath;if(_0x515e3a=='backup-full')_0xcaee68=configpath;let _0x196b8b=fs['readdirSync'](_0xcaee68,{'withFileTypes':!![]});const _0x28affb=new require(_0x19f01d(0x16d))();_0x196b8b[_0x19f01d(0x142)](_0x2a06d5=>{const _0x494043=_0x19f01d;if(!_0x2a06d5['isDirectory']()){let _0x4d5510=fs['readFileSync'](_0xcaee68+_0x2a06d5[_0x494043(0x1a1)]);if(_0x515e3a==_0x494043(0xe4)){const _0x5e42d6=/^bot-[0-9]{3}-config.json$/,_0x2af74a=_0x5e42d6[_0x494043(0x241)](_0x2a06d5['name']);if(_0x2af74a){const _0x95277f=JSON[_0x494043(0x18d)](_0x4d5510);_0x95277f[_0x494043(0x23f)][0x0]&&(_0x95277f[_0x494043(0x23f)][0x0]['apiKey']=_0x494043(0xff),_0x95277f[_0x494043(0x23f)][0x0]['apiSecret']=_0x494043(0xff)),_0x4d5510=JSON['stringify'](_0x95277f,null,0x2);}if(_0x2a06d5[_0x494043(0x1a1)]=='bb-settings.json'){const _0x1e2a12=JSON[_0x494043(0x18d)](_0x4d5510);if(_0x1e2a12[_0x494043(0x179)][_0x494043(0x15a)])_0x1e2a12[_0x494043(0x179)][_0x494043(0x15a)]=![];if(_0x1e2a12['settings'][_0x494043(0x183)])_0x1e2a12[_0x494043(0x179)][_0x494043(0x183)]=_0x494043(0xff);if(_0x1e2a12[_0x494043(0x179)][_0x494043(0x135)])_0x1e2a12[_0x494043(0x179)]['telegramToken']=_0x494043(0xff);if(_0x1e2a12[_0x494043(0x179)][_0x494043(0x140)])_0x1e2a12[_0x494043(0x179)][_0x494043(0x140)]=null;_0x4d5510=JSON['stringify'](_0x1e2a12,null,0x2);}if(_0x2a06d5[_0x494043(0x1a1)]!=_0x494043(0x260))_0x28affb[_0x494043(0x213)](_0x2a06d5[_0x494043(0x1a1)],_0x4d5510);}else _0x28affb[_0x494043(0x213)](_0x2a06d5[_0x494043(0x1a1)],_0x4d5510);}});const _0x5108a4=_0x28affb[_0x19f01d(0x19c)]({'base64':![],'compression':'DEFLATE'});fs[_0x19f01d(0x246)](zippath+(_0x515e3a+_0x19f01d(0x20c)),_0x5108a4,_0x19f01d(0x102));}async function unzipFile(_0x23e1ca,_0x56c115){const _0x4806c4=_0x3d299f;fs[_0x4806c4(0x14e)](configpath,{'withFileTypes':!![]})[_0x4806c4(0x142)](_0x2d0b66=>{const _0x492802=_0x4806c4;if(!_0x2d0b66[_0x492802(0x1b8)]())fs[_0x492802(0x110)](configpath+_0x2d0b66[_0x492802(0x1a1)]);});const _0x1122ff=fs[_0x4806c4(0x26a)](_0x23e1ca+_0x56c115,_0x4806c4(0x102)),_0x11e65a=new require(_0x4806c4(0x16d))(_0x1122ff,{'base64':![],'checkCRC32':!![]});Object[_0x4806c4(0x248)](_0x11e65a[_0x4806c4(0x107)])[_0x4806c4(0x142)](_0x47be6f=>{const _0x3796ab=_0x4806c4,_0x530d9b=_0x11e65a[_0x3796ab(0x107)][_0x47be6f];fs['writeFileSync'](configpath+_0x530d9b[_0x3796ab(0x1a1)],_0x530d9b[_0x3796ab(0x185)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x4806c4(0x142)](_0x2a7420=>{const _0x3a6a4c=_0x4806c4;if(!_0x2a7420['isDirectory']())fs[_0x3a6a4c(0x110)](temppath+_0x2a7420[_0x3a6a4c(0x1a1)]);}),logger[_0x4806c4(0x189)](_0x4806c4(0x146)),process[_0x4806c4(0x158)]({'restore':!![]},_0x2454e9=>{});}async function getPublicIp(){const _0x55da94=_0x3d299f;try{const _0xfbfd50=await axios[_0x55da94(0xf3)](_0x55da94(0x12f));publicip=_0xfbfd50[_0x55da94(0x159)]['ip'];}catch(_0x55dc5c){}}async function triggerAnalytics(){const _0x5b4a51=_0x3d299f;if(!publicip)await getPublicIp();const _0x1d5c77=getBotsWithMode();let _0x2015b6=0x0;_0x1d5c77['forEach'](_0x5bec5c=>{const _0x2fafe1=_0x53da;if(_0x5bec5c[_0x2fafe1(0x1bc)]===_0x2fafe1(0x1af))_0x2015b6++;});const _0x541ddd=getBotExchanges();mixpanel[_0x5b4a51(0x252)]('Server',{'distinct_id':settings[_0x5b4a51(0x1da)],'ip':publicip,'version':serverversion,'numbots':_0x1d5c77['length'],'numbotsenabled':_0x2015b6,'exchanges':_0x541ddd});}async function getMessages(){const _0x495287=_0x3d299f,_0x152d16=_0x495287(0x1ec),_0x12ba17=new GraphQLClient(_0x152d16),_0x53eb0e={'authorization':_0x495287(0x273)},_0x1a5039=serverversion[_0x495287(0x270)]('.'),_0x2a2df6=_0x1a5039[0x0]+'.'+_0x1a5039[0x1],_0x540c53=Math['min'](settings[_0x495287(0x101)],settings[_0x495287(0x23a)]),_0xdafcd6={'last':parseInt(_0x540c53),'bbm':_0x2a2df6},_0x30505f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2e8b10;try{_0x2e8b10=await _0x12ba17[_0x495287(0x10c)](_0x30505f,_0xdafcd6,_0x53eb0e);}catch(_0x595e16){}if(_0x2e8b10&&_0x2e8b10[_0x495287(0x24c)]){let _0x312095=settings[_0x495287(0x101)];newMessages=[];for(const _0xf2bc4e of _0x2e8b10['messages']){newMessages['push'](_0xf2bc4e);if(_0xf2bc4e[_0x495287(0x197)])updateSetting(_0x495287(0x194),_0xf2bc4e['bbvNew']);let _0x3d2b05=_0xf2bc4e['bbvNew']?serverversion>=_0xf2bc4e['bbvNew']:![];if(!_0x3d2b05&&_0xf2bc4e[_0x495287(0x1c9)]>_0x312095){if(_0xf2bc4e[_0x495287(0x1e7)]===_0x495287(0x119)||serverversion[_0x495287(0x18c)](_0xf2bc4e[_0x495287(0x1e7)])){let _0x41e7cf=''+_0xf2bc4e['title']+'\x0a\x0a'+_0xf2bc4e[_0x495287(0x22c)];const _0x1bb6b5=await sendTelegramMsg(toTelegramMarkdown(_0x41e7cf),_0x495287(0x263));if(_0x1bb6b5)_0x312095=_0xf2bc4e[_0x495287(0x1c9)];}}}updateAvailable=isNewerVersion(settings[_0x495287(0x194)],serverversion),updateSetting('lastmsgtelegram',_0x312095),emitMessages();}}function emitMessages(){const _0x4ed797=_0x3d299f,_0x1077df=settings[_0x4ed797(0x23a)];let _0x1ddff1=[];newMessages[_0x4ed797(0x142)](_0x456d69=>{const _0x2c23e6=_0x4ed797;_0x456d69['number']>_0x1077df&&_0x1ddff1[_0x2c23e6(0x1ef)](_0x456d69);}),_0x1ddff1[_0x4ed797(0x1bb)]>0x0&&getAllClients()['forEach'](_0x53d81d=>{const _0x5a1cf5=_0x4ed797;getSocket(_0x53d81d['id'])[_0x5a1cf5(0x21d)](_0x5a1cf5(0x22c),_0x1ddff1);});}function confirmMessage(_0x4558c2){const _0x343fc2=_0x3d299f;updateSetting(_0x343fc2(0x23a),Number(_0x4558c2));}function isNewerVersion(_0x3b6810,_0x390b12){const _0xde95e7=_0x3d299f,_0x1832a1=_0x390b12[_0xde95e7(0x270)]('.'),_0x611a8a=_0x3b6810['split']('.');for(var _0xc0cc7b=0x0;_0xc0cc7b<_0x611a8a[_0xde95e7(0x1bb)];_0xc0cc7b++){const _0x532921=~~_0x611a8a[_0xc0cc7b],_0x4552ee=~~_0x1832a1[_0xc0cc7b];if(_0x532921>_0x4552ee)return!![];if(_0x532921<_0x4552ee)return![];}return![];}function toTelegramMarkdown(_0x878a8){const _0x55adb5=_0x3d299f,_0x4a2a1e=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xde73e9=/\*{2}(.+?)\*{2}/gim;return _0x878a8=_0x878a8[_0x55adb5(0x1a5)](_0x4a2a1e,_0x55adb5(0x100))[_0x55adb5(0x1a5)](_0xde73e9,_0x55adb5(0x276)),_0x878a8;}async function validateConfigFile(){const _0xfb3f9b=_0x3d299f,_0x583f24=dbConfig['get'](_0xfb3f9b(0x1f2))[_0xfb3f9b(0x229)](_0xfb3f9b(0x14a))['value']()||[];if(_0x583f24[_0xfb3f9b(0x1bb)]==0x0){let _0x5d4bea=0x0,_0x424182=[];const _0x43982b=/^bot-([0-9]{3})-config.json$/,_0x5c8df4=fs[_0xfb3f9b(0x14e)](configpath);_0x5c8df4[_0xfb3f9b(0x142)](_0xffdf19=>{const _0x1a3108=_0xfb3f9b,_0x5d1883=_0x43982b['exec'](_0xffdf19);if(_0x5d1883){const _0x3759ba=_0x5d1883[0x1];let _0x2a03ea=getBotAttributes(_0x3759ba);_0x424182[_0x1a3108(0x1ef)]({'botID':_0x3759ba,'botname':_0x2a03ea['botname'],'status':_0x1a3108(0x1ea),'live':_0x1a3108(0x202)}),_0x5d4bea++;}}),_0x5d4bea!=0x0&&(dbConfig['get'](_0xfb3f9b(0x1f2))[_0xfb3f9b(0x11a)](_0x424182)[_0xfb3f9b(0x198)](),config=_0x424182,restoredConfigFile=_0x5d4bea);}}function _0x53da(_0x52f628,_0x130b1f){const _0x41223c=_0x5e1f();return _0x53da=function(_0x15fb87,_0x2eb568){_0x15fb87=_0x15fb87-0xce;let _0x5e1fb3=_0x41223c[_0x15fb87];return _0x5e1fb3;},_0x53da(_0x52f628,_0x130b1f);}function _0x5e1f(){const _0x39d8b1=['3291376KxdZMN','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','getUTCHours','generateKeyPairAsync','user','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','lastmsgemitted','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','clients','mode','lowdb','bot','/:bot/coins','test','\x20>\x20','simple','toString','update','writeFileSync','size','keys','access','remove','/:bot/history','messages','63kXGVqj','reset-password','privateKey','removeListener','getPortfolio','track','15\x20min','warning','Token\x20blacklisted','token','host','telegram','backupfile','logged\x20out','pidExpireLogin','value','RSA-OAEP','randomFillSync','/:bot','bb-secure.json','-results.json','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Markdown','logout','getSeconds','Logged\x20out\x20user\x20...','sendMessage','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','botname','readFileSync','date-fns','/status\x20-\x20show\x20bot(s)\x20status\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','/metrics\x20-\x20show\x20bot\x20performance\x0a','split','fork','exit','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','login\x20required','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','*$1*','catch','filter','Disabled\x20Bot\x20','ipv6','post','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','entries','expiry','3000','disconnect','includes','function','backup-full.zip','bot-','chat','Invalid\x20IP\x20address','use','hasOwnProperty','copyFileSync','output-003.log','You\x20can\x20use\x20the\x20following\x20commands:\x0a','placeOrder','bcryptjs','/disable\x20-\x20disable\x20notifications\x0a','Yes','match','login','from','mkdirSync','Password\x20reset\x20rejected','endsWith','logs/','Restore\x20process\x20aborted','logs','path','build2','\x20|\x20','store-configuration','temporaryAccessAllowed','index.html','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','env','getStartingBalances','Unauthorized\x20attempt\x20to\x20download\x20','/enable\x20-\x20enable\x20notifications\x0a','full','type','get-logs','1000','\x20|\x20user:\x20...','store-headless','Bot\x20','inherit','Allow\x20login\x20from\x20IP\x20address\x20<b>','telegram2FaApproval','getMonth','onText','\x20(1)','port','backup','No\x20authentication\x20token','telegrammsg','unlinkSync','bot.js','Error:\x20Invalid\x20argument\x20','/:bot/support','createServer','output-002.log','/restart\x20-\x20restart\x20bot(s)\x0a','Login\x20rejected','max','/update\x20-\x20update\x20Balance\x20Bot\x0a','static','Setting\x20access:\x20','get','Password\x20has\x20been\x20reset\x20to:\x20','allow','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','20zbBfaF','socket','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','HTML','Invalid\x20authentication\x20token\x20(2)','secure','order','***','$1_$2_$3','lastmsgtelegram','binary','toIPv4MappedAddress','backup-full','get-messages','timestamp','files','orders','Unauthorized\x20attempt\x20to\x20update\x20settings','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20confirm\x20message','request','isIPv4MappedAddress','yes','mtime','rmSync','axios','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','reset-history','Notifications\x20enabled\x0a','Invalid\x20authentication\x20token\x20(1)','started','yargs/yargs','SIGINT','any','assign','new','init','No\x20bots\x20running\x20right\x20now','defaults','timeshift','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','clientip','login\x20token\x20valid','Notifications\x20disabled','stringify','store-settings','bb/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','110RoNkbK','2FA\x20login\x20token\x20generated','event','-config.json','getMinutes','handshake','\x20minutes','https://api.ipify.org?format=json','polling_error','padStart','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','telegramEnabled','publicKey','telegramToken','express','\x20mode','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Enabled\x20Bot\x20','uncaughtException','Restoring\x20bot(s)\x20from\x20backup','running','Starting\x20Balance\x20Bot\x20','connected','add-bot','telegramChatId','hybrid-crypto-js','forEach','backup/','node-telegram-bot-api','sendMetricsTelegram','Backup\x20file\x20unzipped\x20and\x20stored','output-000.log','bbUsername','Unauthorized\x20attempt\x20to\x20delete\x20alerts','botID','-----------------------------------------------------------------------------------','exp','7599273vqhclo','readdirSync','whitelist','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x20to\x20','once','Login\x20accepted','Restarting\x20Bot\x20','argv','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','send','data','loginRequired','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','show-config','reload','secret','encryptedUuid','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Notifications\x20enabled','get-backup-files','sendFile','Starting\x20Balance\x20Bot\x20update','manual','1884036OAaZBG','graphql-request','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','telegramUsername','set','headless','\x20only\x0a','node-zip','build','socket.io','args','format','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Your\x20installation\x20is\x20already\x20up\x20to\x20date','59824XGLiUL','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','cloneDeep','exchange','settings','</b>\x20?','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','output-001.log','alerts','stopPolling','zip/','Access\x20enabled\x20for\x20','find','crypto','bbPassword','live','_data','/upload-backup','answerCallbackQuery','All\x20bots','debug','Starting\x20new\x20bot\x20|\x20Bot\x20','download','startsWith','parse','auth','botmanager','Temporary\x20access\x20rejected','<b>Telegram\x20Bot\x20Status:</b>\x0a','User\x20has\x20been\x20validated','(((.+)+)+)+$','latestversion','/:bot/performance','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','bbvNew','write','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20login\x20attempt\x20(timeout)','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','generate','alias','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','whitelistEnabled','uuid','name','getFullYear','0.0.0','uuid-random','replace','<b>Balance\x20Bot\x20Status:</b>\x0a','accept','settings.','blacklist','reason','remoteAddress','invalid\x20credentials','error','username','enabled','Unauthorized\x20attempt\x20to\x20log\x20out','all','isValid','reinstall','callback_query','search','log','get-starting-balances','isDirectory','removeAllListeners','stop','length','status','telegramEvents','lowdb/adapters/FileSync','temporary\x20access\x20rejected','decrypt','kill','jsonwebtoken','Invalid\x20username\x20or\x20IP\x20address','/off\x20-\x20stop\x20bot(s)\x0a','reinstall-bb','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/:bot/portfolio','temporary\x20access\x20timeout','number','sha256','toggleBotMode','store','config/','password',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','showname','verify','telegramIpApproval','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20bot','-events.json','404\x20Not\x20Found','************','Alerts','userid','pidRefreshToken','Deleted\x20Bot\x20','join','toggle-bot-mode','Invalid\x20Telegram\x20token','onepagemode','Idling\x20bot\x20\x20\x20|\x20Bot\x20','222870tlDHsL','All\x20bots\x20running\x20right\x20now','getTime','893643PjPWAM','Crypt','bbvReceive','login\x20not\x20required','tkn','disabled','2QXxFIF','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Unauthorized\x20attempt\x20to\x20get\x20events','confirm-message','push','sort','listen','bots','2FA\x20login\x20rejected','f2aRequired','mixpanel','statSync','conn','apply','/:bot/configuration','SIGTERM','storeFiat','new-disabled','update-bb','2FA\x20login\x20required','reject','update-bot','auto','stopped','sign','slice','sendPortfolioTelegram','::1','5\x20min','temp/','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getDate','then','.zip','backup-full@','toIPv4Address','resetHistory','existsSync','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','file','storeHeadless','showConfig','http','getHours','compareSync','bb-config.json','2FA\x20required','hashSync','All','emit','Restore\x20backup\x20file\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Starting\x20Balance\x20Bot\x20reinstallation','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','show','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','3913479PWmuvO','ipc','bb-settings.json','/on\x20-\x20start\x20bot(s)\x0a','headers','sortBy','/names\x20-\x20show\x20bot\x20names\x0a','File\x20uploaded','message','\x20|\x20client:\x20...',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','api-eu.mixpanel.com','hex','Backup\x20file\x20uploaded','sockets'];_0x5e1f=function(){return _0x39d8b1;};return _0x5e1f();}async function restoreConfigNotify(_0x231e0a){const _0x4f612d=_0x3d299f;let _0x2217e5;if(restoredConfigFile==0x1)_0x2217e5=_0x4f612d(0x209);else _0x2217e5='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x231e0a)io['to'](_0x4f612d(0x18f))[_0x4f612d(0x21d)]('notification',_0x2217e5);else{logger[_0x4f612d(0x243)](_0x4f612d(0x14b)),logger['simple'](_0x2217e5),logger[_0x4f612d(0x243)](_0x4f612d(0x14b)),logger[_0x4f612d(0x243)]('');if(tgBot&&settings[_0x4f612d(0x140)]&&settings['telegramEvents']!=_0x4f612d(0x108))tgBot['sendMessage'](settings[_0x4f612d(0x140)],'Bot\x20Mgr\x20>\x20'+_0x2217e5)[_0x4f612d(0x277)](_0x59f6c0=>{telegramError(_0x59f6c0);});}}function validateCredentials(_0x3c29be,_0x6777a0){const _0x2d833b=_0x3d299f;if(_0x3c29be[_0x2d833b(0x1ae)]==settings[_0x2d833b(0x148)]&&bcrypt[_0x2d833b(0x218)](_0x3c29be[_0x2d833b(0x1ce)],settings['bbPassword'])){if(settings[_0x2d833b(0x1f4)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x30eb9=generateLoginToken(_0x6777a0);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x30eb9};}}else return{'allow':![],'reason':_0x2d833b(0x1ac),'token':null};}function refreshToken(_0x47dca5){const _0x14ae0f=generateLoginToken(_0x47dca5);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x14ae0f};}function validateAccess(_0x515a64,_0x44dbc5,_0xae93f7){const _0x3b8d7d=_0x3d299f,_0x31648b=_0xae93f7?_0xae93f7:devices[_0x44dbc5]['ip'];let _0x4cf6d0;const _0x333c2f=_0x2cf59c=>{const _0x562fb4=_0x53da;if(settings['loginRequired']){if(settings[_0x562fb4(0x1f4)]){if(telegram2FaApproved(_0x44dbc5)){const _0x432f78=generateLoginToken(_0x44dbc5);return{'allow':!![],'reason':_0x562fb4(0x129),'token':_0x432f78};}else return{'allow':![],'reason':_0x562fb4(0x274),'token':null};}else return _0x4cf6d0=validToken(_0x2cf59c,_0x44dbc5),_0x4cf6d0[_0x562fb4(0x288)]('success')?{'allow':!![],'reason':_0x562fb4(0x122),'token':_0x2cf59c}:{'allow':![],'reason':_0x562fb4(0x274),'token':null};}else return{'allow':!![],'reason':_0x562fb4(0x1e8),'token':null};};if(settings[_0x3b8d7d(0x19f)]){let _0x227ab1=[...settings[_0x3b8d7d(0x14f)],_0x3b8d7d(0x206),'::ffff:127.0.0.1','127.0.0.1'];if(_0x227ab1[_0x3b8d7d(0x281)](_0x31648b))return _0x333c2f(_0x515a64);else{_0x4cf6d0=validToken(_0x515a64,_0x44dbc5);if(_0x4cf6d0['hasOwnProperty']('success'))return _0x333c2f(_0x515a64);else{if(telegramIpApproved(_0x44dbc5)){const _0x10d781=generateToken(_0x44dbc5);return _0x4cf6d0=_0x333c2f(_0x515a64),_0x4cf6d0[_0x3b8d7d(0xf5)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x10d781}:_0x4cf6d0;}else return settings[_0x3b8d7d(0xcf)]?{'allow':![],'reason':_0x3b8d7d(0x21a),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x333c2f(_0x515a64);}function timelyDecrypt(_0x44546a,_0x599cd8=!![]){const _0x3f5592=_0x3d299f;if(_0x44546a)try{const _0x5f4fc5=crypt[_0x3f5592(0x1c0)](secure[_0x3f5592(0x24f)],_0x44546a)[_0x3f5592(0x22c)],_0x63485e=_0x5f4fc5[_0x3f5592(0x270)]('@')[0x0],_0x218dd4=_0x5f4fc5[_0x3f5592(0x270)]('@')[0x1],_0x229e13=new Date()[_0x3f5592(0x1e4)]();if(_0x599cd8){if(_0x229e13-_0x218dd4<maxSecretAge*0x3e8)return _0x63485e;else return![];}else return _0x63485e;}catch(_0x116cc9){return![];}else return![];}const validToken=(_0x243a94,_0x209bd9)=>{const _0x2f6306=_0x3d299f,_0x2a0c0b=devices[_0x209bd9]['ip'];if(!_0x243a94)return{'error':_0x2f6306(0xe5)};for(let _0x5a4610 of blacklist){if(_0x5a4610[_0x2f6306(0x256)]==_0x243a94)return{'error':_0x2f6306(0x255)};}let _0x4b5c19;try{_0x4b5c19=jwt[_0x2f6306(0x1d1)](_0x243a94,secure[_0x2f6306(0x15e)]+_0x209bd9);}catch{return{'error':_0x2f6306(0x115)};}if(!_0x4b5c19[_0x2f6306(0x288)](_0x2f6306(0x121))&&!_0x4b5c19['hasOwnProperty'](_0x2f6306(0x1ae))||!_0x4b5c19[_0x2f6306(0x288)](_0x2f6306(0x14c)))return{'error':_0x2f6306(0xfc)};if(!_0x4b5c19[_0x2f6306(0x288)]('username')&&_0x4b5c19[_0x2f6306(0x288)](_0x2f6306(0x121))){const {clientip:_0x1b22bf}=_0x4b5c19;return _0x2a0c0b==_0x1b22bf?{'success':_0x2f6306(0x192)}:{'error':_0x2f6306(0x286)};}else{if(_0x4b5c19['hasOwnProperty'](_0x2f6306(0x1ae))&&_0x4b5c19['hasOwnProperty']('clientip')){const {username:_0x7b905f,clientip:_0x73c7ba}=_0x4b5c19;return settings['bbUsername']==_0x7b905f&&_0x2a0c0b==_0x73c7ba?{'success':_0x2f6306(0x192)}:{'error':_0x2f6306(0x1c3)};}}},generateLoginToken=_0x19f946=>{const _0x395dff=_0x3d299f;if(_0x19f946){const _0x20f811=devices[_0x19f946]['ip'];return jwt[_0x395dff(0x203)]({'username':settings[_0x395dff(0x148)],'clientip':_0x20f811},secure['secret']+_0x19f946,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2d9bd3=>{const _0x39c9cc=_0x3d299f;if(_0x2d9bd3){const _0x2df17c=devices[_0x2d9bd3]['ip'];return jwt[_0x39c9cc(0x203)]({'clientip':_0x2df17c},secure['secret']+_0x2d9bd3,{'expiresIn':devices[_0x2d9bd3][_0x39c9cc(0x1d2)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x32c4c0=>{const _0x5e9b2c=_0x3d299f;let _0x5e6e9a=![];return devices[_0x32c4c0][_0x5e9b2c(0x1d2)]&&devices[_0x32c4c0][_0x5e9b2c(0x1d2)][_0x5e9b2c(0x27e)]!=_0x5e9b2c(0x1ff)&&(_0x5e6e9a=devices[_0x32c4c0][_0x5e9b2c(0x1d2)][_0x5e9b2c(0x121)]==devices[_0x32c4c0]['ip']&&new Date()[_0x5e9b2c(0x1e4)]()-devices[_0x32c4c0][_0x5e9b2c(0x1d2)][_0x5e9b2c(0x106)]<devices[_0x32c4c0][_0x5e9b2c(0x1d2)][_0x5e9b2c(0x27e)]*0x3c*0x3e8),_0x5e6e9a;},telegram2FaApproved=_0x384bbc=>{const _0x5d832b=_0x3d299f;let _0x3a13fd=![];return devices[_0x384bbc][_0x5d832b(0xdf)]&&devices[_0x384bbc]['telegram2FaApproval'][_0x5d832b(0x27e)]!='reject'&&(_0x3a13fd=devices[_0x384bbc][_0x5d832b(0xdf)][_0x5d832b(0x121)]==devices[_0x384bbc]['ip']&&new Date()['getTime']()-devices[_0x384bbc]['telegram2FaApproval']['timestamp']<devices[_0x384bbc][_0x5d832b(0xdf)][_0x5d832b(0x27e)]*0x3c*0x3e8),_0x3a13fd;},normalizeIP=_0x637d3=>{const _0x37a767=_0x3d299f;let _0x8aa628=null,_0x15ff7f=null;if(ipaddr[_0x37a767(0x1b2)](_0x637d3)){const _0x513d36=ipaddr['parse'](_0x637d3);_0x513d36['kind']()===_0x37a767(0x27a)?(_0x513d36[_0x37a767(0x10d)]()&&(_0x8aa628=_0x513d36[_0x37a767(0x20e)]()[_0x37a767(0x244)]()),_0x15ff7f=_0x513d36[_0x37a767(0x244)]()):(_0x8aa628=_0x513d36['toString'](),_0x15ff7f=_0x513d36[_0x37a767(0x103)]()[_0x37a767(0x244)]());}return{'show':_0x8aa628?_0x8aa628:_0x15ff7f,'store':_0x15ff7f};};function formatDate(_0x573240){const _0x551e3a=_0x3d299f;return _0x573240[_0x551e3a(0x1a2)]()+'/'+(_0x573240[_0x551e3a(0xe0)]()+0x1)[_0x551e3a(0x244)]()[_0x551e3a(0x131)](0x2,'0')+'/'+_0x573240[_0x551e3a(0x20a)]()['toString']()[_0x551e3a(0x131)](0x2,'0')+'\x20'+_0x573240[_0x551e3a(0x217)]()[_0x551e3a(0x244)]()[_0x551e3a(0x131)](0x2,'0')+':'+_0x573240[_0x551e3a(0x12c)]()[_0x551e3a(0x244)]()['padStart'](0x2,'0')+':'+_0x573240[_0x551e3a(0x265)]()[_0x551e3a(0x244)]()[_0x551e3a(0x131)](0x2,'0');}function sleep(_0x1c831a){return new Promise(_0x127c9c=>setTimeout(_0x127c9c,_0x1c831a));}