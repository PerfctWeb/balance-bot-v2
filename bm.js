const _0x2d307a=_0x4644;(function(_0x2cd17c,_0x32a758){const _0x510c78=_0x4644,_0x416849=_0x2cd17c();while(!![]){try{const _0x269d89=parseInt(_0x510c78(0xe9))/0x1+-parseInt(_0x510c78(0x150))/0x2+-parseInt(_0x510c78(0x16a))/0x3+-parseInt(_0x510c78(0x164))/0x4+-parseInt(_0x510c78(0x1b4))/0x5*(parseInt(_0x510c78(0x202))/0x6)+-parseInt(_0x510c78(0x14c))/0x7*(-parseInt(_0x510c78(0xeb))/0x8)+parseInt(_0x510c78(0x15a))/0x9;if(_0x269d89===_0x32a758)break;else _0x416849['push'](_0x416849['shift']());}catch(_0x5ec05f){_0x416849['push'](_0x416849['shift']());}}}(_0x4970,0x9f797));const _0x26944d=function(){let _0x25025b=!![];return function(_0x51fff5,_0x20c973){const _0x169066=_0x25025b?function(){const _0x138d5e=_0x4644;if(_0x20c973){const _0x57bbb9=_0x20c973[_0x138d5e(0x129)](_0x51fff5,arguments);return _0x20c973=null,_0x57bbb9;}}:function(){};return _0x25025b=![],_0x169066;};}(),_0x9dad8a=_0x26944d(this,function(){const _0x4e31d9=_0x4644;return _0x9dad8a[_0x4e31d9(0x11d)]()[_0x4e31d9(0x182)](_0x4e31d9(0x124))[_0x4e31d9(0x11d)]()[_0x4e31d9(0x1dc)](_0x9dad8a)['search'](_0x4e31d9(0x124));});_0x9dad8a();'use strict';process[_0x2d307a(0x1d3)][_0x2d307a(0x19f)]=0x1;const childProcess=require('child_process'),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require(_0x2d307a(0x1f4)),low=require(_0x2d307a(0x13f)),path=require(_0x2d307a(0xde)),crypto=require(_0x2d307a(0x189)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x2d307a(0x165))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x2d307a(0x10a)),analyticsLib=require(_0x2d307a(0x1aa))[_0x2d307a(0x1e3)],googleAnalytics=require(_0x2d307a(0x183))[_0x2d307a(0x1e3)],ipaddr=require(_0x2d307a(0x1f1)),argv=require(_0x2d307a(0x1b0))(process['argv'][_0x2d307a(0x1ce)](0x2))[_0x2d307a(0x1c4)],PORT=argv['port']||_0x2d307a(0x1b1),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x2d307a(0x1ae)](PORT))return console[_0x2d307a(0x110)](_0x2d307a(0x1eb)+PORT+_0x2d307a(0x125)),process['exit'](0x1);const HOST=argv[_0x2d307a(0x118)]||null,userID=argv[_0x2d307a(0x19b)]||'';let bbpath=_0x2d307a(0x1c5),bbpath2='';const botfile=_0x2d307a(0x1f5),configfile=_0x2d307a(0x1a4),settingsfile=_0x2d307a(0xe8),securefile='bb-secure.json';!fs[_0x2d307a(0x20e)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2d307a(0xcc)),configpath=userID?bbpath+_0x2d307a(0x213)+userID+'/':bbpath+_0x2d307a(0x213),configbackuppath=configpath+_0x2d307a(0x1ee);!fs[_0x2d307a(0x20e)](configpath)&&fs[_0x2d307a(0x20d)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x2d307a(0x20d)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2d307a(0x132)]({'bots':[]})[_0x2d307a(0x1bb)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})['write']();function _0x4970(){const _0x1e11c9=['stopped','20398MhgxaU','User\x20has\x20been\x20validated','hashSync','Unauthorized\x20attempt\x20to\x20update\x20bot','2415474aUFjik','\x20|\x20','/:bot/configuration','f2aRequired','telegramIpApproval','bots','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20get\x20logs','assign','show','22546341tOrHlZ','-----------------------------------------------------------------------------------','Ok,\x20will\x20send\x20alert\x20notifications\x20only','join','compareSync','then','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','connected','build','Invalid\x20authentication\x20token\x20(2)','3866912hukQtU','hybrid-crypto-js','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','temporary\x20access\x20timeout','version','logout','2153511EQvuJo','Login\x20accepted','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','exit','sign','getTime','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','message','\x20/\x20','chat','sockets','page','/off\x20-\x20stop\x20bot(s)\x0a','login\x20required','telegram2FaApproval','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','once','starting\x20bot\x20|\x20Bot\x20','botID','telegramUsername','Unauthorized\x20attempt\x20to\x20get\x20portfolio','forEach','push','Unauthorized\x20attempt\x20to\x20add\x20bot','search','@analytics/google-analytics','-results.json','</b>\x20?','kill','botmanager','bbPassword','crypto','index.html','includes','Invalid\x20username\x20or\x20IP\x20address','live','-config.json','getSeconds','1000','127.0.0.1','telegram','emitHistory','Notifications\x20disabled\x0a','whitelistEnabled','Password\x20reset\x20rejected','filter','remove','split','sortBy','user','accept','uuid','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','NTBA_FIX_319','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','unlinkSync','getFullYear','static','bb-config.json','placeOrder','blacklist','initclient','sendMessage','login\x20token\x20valid','analytics','restarting\x20Bot\x20','hex','/:bot/portfolio','test','storeHeadless','yargs/yargs','3000','/:bot/history','isDirectory','497155WPYwoN','alerts','polling_error','onText','<b>Telegram\x20bot\x20status:</b>\x0a','/:bot/support','pidExpireLogin','write','reload','Invalid\x20authentication\x20token\x20(1)','2FA\x20required','add-bot','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20','catch','padStart','argv','bb/','/status\x20-\x20show\x20bot(s)\x20status\x0a','cancelLoading','toIPv4Address','version.json','store','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','orders','slice','\x20only\x0a','running','cancel-loading','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','env','Invalid\x20IP\x20address','getDate','Balance\x20Bot\x20Server','getMonth','http','secret','build2','whitelist','constructor','update-bb','timeshift','enabled\x20Bot\x20','access\x20timeout','404\x20Not\x20Found','started','default','stopPolling','settings.','exp','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','reason','settings','2FA\x20login\x20rejected','Error:\x20Invalid\x20argument\x20','::ffff:127.0.0.1','node-telegram-bot-api','backup/','2FA\x20login\x20required',':\x20Bot\x20Mgr\x20>\x20','ipaddr.js','delete-bot','HTML','date-fns','bot.js','SIGTERM','Orders','getHours','All\x20bots','all','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','error\x20while\x20deleting\x20config\x20files:\x20','emit','secure','length','inherit','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','12JyyzRt','restart','2FA','access','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','success','username','store-headless','server','Notifications\x20enabled','Notifications\x20disabled','mkdirSync','existsSync','All','answerCallbackQuery','value','handshake','config/','telegramToken','isValid','status','disabled\x20Bot\x20','token','UA-192771731-1','clients','15\x20min','randomBytes','login\x20not\x20required','telegramChatId','No\x20bots\x20running\x20right\x20now',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Unauthorized\x20attempt\x20to\x20delete\x20bot','update-bot','Unauthorized\x20attempt\x20to\x20log\x20out','starting\x20new\x20bot\x20|\x20Bot\x20','enabled','createServer','apiKey','add','reject','callback_query','new','path','Notifications\x20enabled\x0a','Invalid\x20Telegram\x20token','use','find','get-starting-balances','No\x20authentication\x20token','temporary\x20token\x20generated','login\x20token\x20generated','fork','bb-settings.json','155214DbIbvU','notification','2976INgGLe','************','stop','disconnect','removeListener','name','store-settings','get-logs','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','All\x20bots\x20running\x20right\x20now','send','timestamp','allow','Bot\x20','clientip','readdirSync','reset-password','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','\x20>\x20','match','Login\x20rejected','Ok,\x20will\x20send\x20order\x20notifications\x20only','pidRefreshToken','Unauthorized\x20attempt\x20to\x20update\x20settings','set','socket.io','sendFile','2FA\x20login\x20token\x20generated','removeAllListeners','loginRequired','RSA-OAEP','jsonwebtoken','telegramEnabled','ipv6','Balance\x20Bot','max','yes','log','expiry','type','copyFileSync','data','decrypt','Unauthorized\x20attempt\x20to\x20store\x20configuration','bot','host','from','isIPv4MappedAddress','ipc','connection','toString','temporaryAccessAllowed','/help\x20-\x20show\x20available\x20commands\x0a','bot-','publicKey','temporary\x20access\x20rejected','/:bot','(((.+)+)+)+$',',\x20must\x20be\x20a\x204\x20digit\x20number','password','::1','function','apply','order','/disable\x20-\x20disable\x20notifications\x0a','error','headers','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','place-order','Allow\x20login\x20from\x20IP\x20address\x20<b>','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','defaults','bbUsername','login','/enable\x20-\x20enable\x20notifications\x0a','getUTCHours','5\x20min','privateKey','idling\x20bot\x20\x20\x20|\x20Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getMinutes','cloneDeep','disabled','get','lowdb','showname','getStartingBalances','https://hodlerhacks.com','/restart\x20-\x20restart\x20bot(s)\x0a','args','botname','telegramEvents','/:bot/coins','map','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','hasOwnProperty'];_0x4970=function(){return _0x1e11c9;};return _0x4970();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2d307a(0x132)]({'secure':{},'blacklist':[]})[_0x2d307a(0x1bb)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x2d307a(0x109)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2d307a(0x1c9))[_0x2d307a(0x168)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0x2d307a(0x1d8))[_0x2d307a(0xd8)](app);app[_0x2d307a(0xe1)](express[_0x2d307a(0x1a3)](path[_0x2d307a(0x15d)](__dirname,bbpath2,'build2'))),app['use'](express[_0x2d307a(0x1a3)](path[_0x2d307a(0x15d)](__dirname,bbpath2,_0x2d307a(0x162)))),app[_0x2d307a(0x13e)]('/',function(_0x5d4c5d,_0x232c43){const _0x241189=_0x2d307a;_0x232c43[_0x241189(0x105)](path['join'](__dirname,bbpath2,_0x241189(0x1da),_0x241189(0x18a)));}),app['get'](_0x2d307a(0x123),function(_0x261a75,_0x8d7d3b){const _0x569758=_0x2d307a;_0x8d7d3b[_0x569758(0x105)](path['join'](__dirname,bbpath2,_0x569758(0x162),_0x569758(0x18a)));}),app[_0x2d307a(0x13e)](_0x2d307a(0x1ad),(_0x360d4b,_0x372ad6)=>{const _0x377bbb=_0x2d307a;_0x372ad6[_0x377bbb(0x105)](path[_0x377bbb(0x15d)](__dirname,bbpath2,_0x377bbb(0x162),'index.html'));}),app[_0x2d307a(0x13e)]('/:bot/performance',(_0xa8e14c,_0x3f5851)=>{const _0x96089=_0x2d307a;_0x3f5851[_0x96089(0x105)](path[_0x96089(0x15d)](__dirname,bbpath2,_0x96089(0x162),_0x96089(0x18a)));}),app[_0x2d307a(0x13e)](_0x2d307a(0x147),(_0x61e831,_0x668f54)=>{const _0x250dfd=_0x2d307a;_0x668f54['sendFile'](path[_0x250dfd(0x15d)](__dirname,bbpath2,'build',_0x250dfd(0x18a)));}),app['get'](_0x2d307a(0x1b2),(_0x3a0c37,_0x2724c2)=>{const _0x290e9d=_0x2d307a;_0x2724c2[_0x290e9d(0x105)](path[_0x290e9d(0x15d)](__dirname,bbpath2,_0x290e9d(0x162),_0x290e9d(0x18a)));}),app[_0x2d307a(0x13e)](_0x2d307a(0x152),(_0x2fda85,_0x292af6)=>{const _0x33051e=_0x2d307a;_0x292af6['sendFile'](path['join'](__dirname,bbpath2,_0x33051e(0x162),_0x33051e(0x18a)));}),app[_0x2d307a(0x13e)](_0x2d307a(0x1b9),(_0x199703,_0x5b093e)=>{const _0x19104c=_0x2d307a;_0x5b093e[_0x19104c(0x105)](path[_0x19104c(0x15d)](__dirname,bbpath2,'build','index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x2d307a(0x104))(http,{}),analytics=analyticsLib({'app':_0x2d307a(0x10d),'plugins':[googleAnalytics({'trackingId':_0x2d307a(0xcb)})]}),TelegramBot=require(_0x2d307a(0x1ed));let tgBot;if(settings[_0x2d307a(0x214)]&&settings[_0x2d307a(0x214)]!=''&&settings['telegramUsername']&&settings[_0x2d307a(0x17d)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x554c34=_0x2d307a;console['log'](''),console['log'](_0x554c34(0x15b)),logging(_0x554c34(0x19e)+PORT),console[_0x554c34(0x110)](_0x554c34(0x15b));if(config['length']!=0x0)config[_0x554c34(0x17f)](_0x2a532c=>{const _0x47e12c=_0x554c34;if(_0x2a532c[_0x47e12c(0xc8)]==_0x47e12c(0xd7)||_0x2a532c[_0x47e12c(0xc8)]==_0x47e12c(0xdd))logging(_0x47e12c(0x17b)+_0x2a532c[_0x47e12c(0x17c)]+_0x47e12c(0x151)+_0x2a532c['botname']),startBot([_0x2a532c['botID'],userID],{'cwd':bbpath},function(_0x31c0c6){if(_0x31c0c6)logging(_0x31c0c6);});else(_0x2a532c[_0x47e12c(0xc8)]==_0x47e12c(0x13d)||_0x2a532c[_0x47e12c(0xc8)]=='new-disabled')&&logging(_0x47e12c(0x139)+_0x2a532c['botID']+'\x20|\x20'+_0x2a532c[_0x47e12c(0x145)]);});else!newBot&&console[_0x554c34(0x110)](_0x554c34(0x1cb));if(newBot)addBot();console[_0x554c34(0x110)]('-----------------------------------------------------------------------------------'),console[_0x554c34(0x110)]('');}function startSocket(){const _0x3c8b5d=_0x2d307a;io['on'](_0x3c8b5d(0x11c),_0x170357=>{const _0x181aae=_0x3c8b5d;let _0xe2eb02,_0x49ad10,_0x161d05,_0x3a1f22,_0x521b18;const _0x362626=_0x170357[_0x181aae(0x212)][_0x181aae(0x12d)]['referer'];_0x49ad10=_0x362626[_0x181aae(0xfe)](/bot[0-9]{3}/);if(_0x49ad10)_0x161d05=_0x49ad10[0x0][_0x181aae(0xfe)](/[0-9]{3}/);if(_0x161d05)_0xe2eb02=_0x161d05[0x0];else _0xe2eb02='botmanager';const _0x2edcf6=_0x170357[_0x181aae(0x212)]['auth']['encryptedUuid'];if(!_0x2edcf6)_0x170357['emit'](_0x181aae(0xc8),{'publicKey':secure[_0x181aae(0x121)]});else{_0x3a1f22=timelyDecrypt(_0x2edcf6,![]);if(!_0x3a1f22)_0x170357[_0x181aae(0x1fd)]('status',{'publicKey':secure[_0x181aae(0x121)]});else{_0x521b18=normalizeIP(_0x170357['conn']['remoteAddress'])[_0x181aae(0x1ca)];if(!devices[_0x3a1f22])devices[_0x3a1f22]={'uuid':_0x3a1f22,'access':{'token':null}};devices[_0x3a1f22]['ip']=_0x521b18;const _0x5262db=addClient(_0x170357['id'],_0x3a1f22,_0xe2eb02);setAccess(_0x5262db),_0x170357['on'](_0x181aae(0x134),_0x21286b=>{const _0x3490ae=_0x181aae,_0x305a82=timelyDecrypt(_0x21286b[_0x3490ae(0x126)]);if(_0x305a82){_0x21286b={'username':_0x21286b['username'],'password':_0x305a82},devices[_0x3a1f22]['access']=validateCredentials(_0x21286b,_0x3a1f22);if(devices[_0x3a1f22][_0x3490ae(0x205)][_0x3490ae(0xf7)]==![]&&devices[_0x3a1f22]['access'][_0x3490ae(0x1e8)]==_0x3490ae(0x1ef))_0x170357[_0x3490ae(0x1fd)](_0x3490ae(0xc8),{'access':devices[_0x3a1f22][_0x3490ae(0x205)]}),loginAccess2FA(_0x3a1f22,_0x521b18);else{if(devices[_0x3a1f22][_0x3490ae(0x205)][_0x3490ae(0xf7)]==![]&&devices[_0x3a1f22][_0x3490ae(0x205)]['reason']=='invalid\x20credentials')_0x170357['emit']('status',{'access':devices[_0x3a1f22][_0x3490ae(0x205)]});else devices[_0x3a1f22]['access'][_0x3490ae(0xf7)]&&devices[_0x3a1f22][_0x3490ae(0x205)]['reason']==_0x3490ae(0xe6)&&(getClientsWithUuid(_0x3a1f22)[_0x3490ae(0x17f)](_0x2b3ed6=>{setAccess(_0x2b3ed6);}),setTokenRefresh(_0x3a1f22),setSessionTimeout(_0x3490ae(0x134),_0x3a1f22));}}else logging(_0x3490ae(0x1c0));}),_0x170357['on'](_0x181aae(0xfb),()=>{resetPassword();}),_0x170357['on'](_0x181aae(0xee),_0x3f74f6=>{removeClient(_0x170357['id']);});}}});}function initClient(_0x240ce7){const _0x4c8a19=_0x2d307a;if(_0x240ce7!='botmanager'&&config[_0x4c8a19(0xd9)]!=''){if(pid[_0x240ce7])pid[_0x240ce7][_0x4c8a19(0xf5)]({'function':_0x4c8a19(0x1a7),'args':null});}}function getSocket(_0x5380d3){const _0x39848f=_0x2d307a;return io[_0x39848f(0x174)][_0x39848f(0x174)][_0x39848f(0x13e)](_0x5380d3);}function setAccess(_0x527045){const _0x3ceb24=_0x2d307a,_0xbcd107=getSocket(_0x527045['id']),_0x4e345e=_0x527045[_0x3ceb24(0x19d)],_0x32efe5=_0x527045[_0x3ceb24(0x117)];devices[_0x4e345e]['access']=validateAccess(devices[_0x4e345e][_0x3ceb24(0x205)]['token'],_0x4e345e),_0xbcd107['join'](_0x4e345e);if(devices[_0x4e345e][_0x3ceb24(0x205)][_0x3ceb24(0xf7)]){_0xbcd107[_0x3ceb24(0x15d)](_0x32efe5);if(_0x32efe5==_0x3ceb24(0x187))initializeSocketBotManager(_0xbcd107);else initializeSocketBot(_0xbcd107);initClient(_0x32efe5);}devices[_0x4e345e][_0x3ceb24(0x205)][_0x3ceb24(0xca)]&&devices[_0x4e345e][_0x3ceb24(0x205)][_0x3ceb24(0x1e8)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3ceb24(0x204),_0x4e345e),devices[_0x4e345e]['access'][_0x3ceb24(0xca)]&&devices[_0x4e345e]['access']['reason']==_0x3ceb24(0x106)&&setSessionTimeout('login',_0x4e345e),_0xbcd107[_0x3ceb24(0x1fd)](_0x3ceb24(0xc8),{'status':_0x527045[_0x3ceb24(0x20a)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4e345e][_0x3ceb24(0x205)],'externalip':devices[_0x4e345e]['ip'],'publicKey':secure[_0x3ceb24(0x121)]}),devices[_0x4e345e][_0x3ceb24(0x205)][_0x3ceb24(0xf7)]==![]&&devices[_0x4e345e][_0x3ceb24(0x205)]['reason']==_0x3ceb24(0x1be)&&temporaryAccess2FA(_0x4e345e,devices[_0x4e345e]['ip']);}function setSessionTimeout(_0x45fae6,_0x4e09bf){const _0xd46048=_0x2d307a;let _0xf2ae46;if(_0x45fae6=='login')_0xf2ae46=loginExpiry*0x3c*0x3e8;else _0xf2ae46=devices[_0x4e09bf]['telegramIpApproval'][_0xd46048(0x111)]*0x3c*0x3e8-(new Date()[_0xd46048(0x16f)]()-devices[_0x4e09bf]['telegramIpApproval'][_0xd46048(0xf6)]);if(devices[_0x4e09bf]['pidExpireLogin'])clearTimeout(devices[_0x4e09bf][_0xd46048(0x1ba)]);devices[_0x4e09bf][_0xd46048(0x1ba)]=setTimeout(()=>{const _0x3863ee=_0xd46048;if(devices[_0x4e09bf]['pidRefreshToken'])clearTimeout(devices[_0x4e09bf][_0x3863ee(0x101)]);removeSocketListeners(_0x4e09bf),addBlacklist(_0x4e09bf),devices[_0x4e09bf][_0x3863ee(0x154)]=null,devices[_0x4e09bf][_0x3863ee(0x178)]=null,devices[_0x4e09bf][_0x3863ee(0x205)][_0x3863ee(0xca)]=null,devices[_0x4e09bf][_0x3863ee(0x205)]=validateAccess(devices[_0x4e09bf][_0x3863ee(0x205)][_0x3863ee(0xca)],_0x4e09bf),!(devices[_0x4e09bf]['access'][_0x3863ee(0xf7)]&&devices[_0x4e09bf][_0x3863ee(0x205)]['reason']==_0x3863ee(0xcf))&&(_0x45fae6==_0x3863ee(0x134)?io['to'](_0x4e09bf)[_0x3863ee(0x1fd)](_0x3863ee(0xc8),{'access':{'allow':![],'reason':_0x3863ee(0x1e0),'token':null}}):io['to'](_0x4e09bf)['emit'](_0x3863ee(0xc8),{'access':{'allow':![],'reason':_0x3863ee(0x167),'token':null}})),devices[_0x4e09bf]['access']['token']=null;},_0xf2ae46);}function setTokenRefresh(_0x16c9b2){const _0x4dadff=_0x2d307a;if(devices[_0x16c9b2][_0x4dadff(0x101)])clearTimeout(devices[_0x16c9b2]['pidRefreshToken']);devices[_0x16c9b2][_0x4dadff(0x101)]=setTimeout(()=>{const _0x387ac5=_0x4dadff;getClientsWithUuid(_0x16c9b2)['length']!=0x0?(devices[_0x16c9b2][_0x387ac5(0x205)]=refreshToken(_0x16c9b2),io['to'](_0x16c9b2)[_0x387ac5(0x1fd)](_0x387ac5(0xc8),{'status':_0x387ac5(0x161),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x16c9b2][_0x387ac5(0x205)],'externalip':devices[_0x16c9b2]['ip'],'publicKey':secure[_0x387ac5(0x121)]}),setTokenRefresh(_0x16c9b2)):clearTimeout(devices[_0x16c9b2][_0x387ac5(0x101)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3ff887){const _0x263959=_0x2d307a,_0x5db222=getClient(_0x3ff887['id'])[_0x263959(0x19d)];_0x3ff887[_0x263959(0x1fd)]('bots',config),_0x3ff887['emit']('settings',cleanSettings()),_0x3ff887['on'](_0x263959(0x1bf),_0x55084c=>{const _0x2f72ed=_0x263959;if(validateAccess(_0x55084c,_0x5db222)[_0x2f72ed(0xf7)])addBot();else logging(_0x2f72ed(0x181));}),_0x3ff887['on'](_0x263959(0xd4),(_0x4c7e6f,_0xb30c3c)=>{const _0x1061f6=_0x263959;if(validateAccess(_0xb30c3c,_0x5db222)[_0x1061f6(0xf7)])toggleBot(_0x4c7e6f[_0x1061f6(0x17c)],_0x4c7e6f[_0x1061f6(0xc8)],_0x4c7e6f[_0x1061f6(0x18d)]);else logging(_0x1061f6(0x14f));}),_0x3ff887['on'](_0x263959(0x1f2),(_0xbd62be,_0x5db8c3)=>{const _0x9cf817=_0x263959;if(validateAccess(_0x5db8c3,_0x5db222)[_0x9cf817(0xf7)])deleteBot(_0xbd62be);else logging(_0x9cf817(0xd3));}),_0x3ff887['on'](_0x263959(0xf1),(_0x2c4b16,_0x224b46)=>{const _0x1882db=_0x263959;if(validateAccess(_0x224b46,_0x5db222)[_0x1882db(0xf7)])storeSettings(_0x2c4b16,!![]);else logging(_0x1882db(0x102));}),_0x3ff887['on'](_0x263959(0x1dd),(_0x4252c9,_0x36234d)=>{const _0x5b5028=_0x263959;if(validateAccess(_0x36234d,_0x5db222)[_0x5b5028(0xf7)])updateBB();else logging(_0x5b5028(0x102));}),_0x3ff887['on'](_0x263959(0x169),_0x451e2a=>{const _0xa232a2=_0x263959;if(validateAccess(_0x451e2a,_0x5db222)[_0xa232a2(0xf7)]){if(devices[_0x5db222][_0xa232a2(0x101)])clearTimeout(devices[_0x5db222][_0xa232a2(0x101)]);if(devices[_0x5db222][_0xa232a2(0x1ba)])clearTimeout(devices[_0x5db222]['pidExpireLogin']);removeSocketListeners(getClient(_0x3ff887['id'])['uuid']),addBlacklist(_0x5db222),devices[_0x5db222][_0xa232a2(0x154)]=null,devices[_0x5db222]['telegram2FaApproval']=null,devices[_0x5db222][_0xa232a2(0x205)][_0xa232a2(0xca)]=null,io['to'](getClient(_0x3ff887['id'])[_0xa232a2(0x19d)])[_0xa232a2(0x1fd)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0xa232a2(0xd5));});}function initializeSocketBot(_0x3b027f){const _0x427a0c=_0x2d307a,_0x6422fd=getClient(_0x3b027f['id'])[_0x427a0c(0x117)],_0xeafaa2=getClient(_0x3b027f['id'])['uuid'];_0x3b027f['on'](_0x427a0c(0xf2),(_0x35a2e5,_0x5ea9b0)=>{const _0x570747=_0x427a0c;if(validateAccess(_0x5ea9b0,_0xeafaa2)[_0x570747(0xf7)]){if(pid[_0x6422fd])pid[_0x6422fd][_0x570747(0xf5)]({'function':_0x570747(0x193),'args':_0x35a2e5});}else logging(_0x570747(0x157));}),_0x3b027f['on']('get-portfolio',(_0x49643d,_0x1ab746)=>{const _0x3645f2=_0x427a0c;if(validateAccess(_0x1ab746,_0xeafaa2)[_0x3645f2(0xf7)]){if(pid[_0x6422fd])pid[_0x6422fd][_0x3645f2(0xf5)]({'function':'getPortfolio','args':_0x49643d});}else logging(_0x3645f2(0x17e));}),_0x3b027f['on']('store-configuration',(_0x12467c,_0xf66308)=>{const _0x5797a3=_0x427a0c;if(validateAccess(_0xf66308,_0xeafaa2)['allow']){if(pid[_0x6422fd])pid[_0x6422fd]['send']({'function':'storeConfiguration','args':_0x12467c});}else logging(_0x5797a3(0x116));}),_0x3b027f['on'](_0x427a0c(0x209),(_0x545544,_0x29eee9)=>{const _0x4aa0f0=_0x427a0c;if(validateAccess(_0x29eee9,_0xeafaa2)[_0x4aa0f0(0xf7)]){if(pid[_0x6422fd])pid[_0x6422fd][_0x4aa0f0(0xf5)]({'function':_0x4aa0f0(0x1af),'args':_0x545544});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3b027f['on'](_0x427a0c(0xe3),_0x5baea0=>{const _0xddf1c5=_0x427a0c;if(validateAccess(_0x5baea0,_0xeafaa2)[_0xddf1c5(0xf7)]){if(pid[_0x6422fd])pid[_0x6422fd][_0xddf1c5(0xf5)]({'function':_0xddf1c5(0x141),'args':null});}else logging(_0xddf1c5(0x206));}),_0x3b027f['on'](_0x427a0c(0x12f),(_0x62fc04,_0x595cf8)=>{const _0x2b81bc=_0x427a0c;if(validateAccess(_0x595cf8,_0xeafaa2)[_0x2b81bc(0xf7)]){if(pid[_0x6422fd])pid[_0x6422fd]['send']({'function':_0x2b81bc(0x1a5),'args':_0x62fc04});}else logging(_0x2b81bc(0x12e));}),_0x3b027f['on'](_0x427a0c(0x1d1),_0x29d95c=>{const _0x5f03ca=_0x427a0c;if(validateAccess(_0x29d95c,_0xeafaa2)[_0x5f03ca(0xf7)]){if(pid[_0x6422fd])pid[_0x6422fd][_0x5f03ca(0xf5)]({'function':_0x5f03ca(0x1c7),'args':null});}else logging(_0x5f03ca(0x1d2));}),_0x3b027f['on']('logout',_0x189163=>{const _0x187333=_0x427a0c;if(validateAccess(_0x189163,_0xeafaa2)[_0x187333(0xf7)]){if(devices[_0xeafaa2][_0x187333(0x101)])clearTimeout(devices[_0xeafaa2][_0x187333(0x101)]);if(devices[_0xeafaa2]['pidExpireLogin'])clearTimeout(devices[_0xeafaa2][_0x187333(0x1ba)]);removeSocketListeners(getClient(_0x3b027f['id'])['uuid']),addBlacklist(_0xeafaa2),devices[_0xeafaa2]['telegramIpApproval']=null,devices[_0xeafaa2][_0x187333(0x178)]=null,devices[_0xeafaa2][_0x187333(0x205)][_0x187333(0xca)]=null,io['to'](getClient(_0x3b027f['id'])[_0x187333(0x19d)])[_0x187333(0x1fd)](_0x187333(0xc8),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x187333(0xd5));});}function removeSocketListeners(_0xa4e73){const _0x3c9d97=_0x2d307a;getClientsWithUuid(_0xa4e73)[_0x3c9d97(0x17f)](_0x43707c=>{const _0x518c74=_0x3c9d97;getSocket(_0x43707c['id'])[_0x518c74(0x107)]();});}function cleanSettings(){const _0x180049=_0x2d307a;let _0x1f64d3=settings;return settings[_0x180049(0x214)]&&settings[_0x180049(0x214)]!=''&&(_0x1f64d3={..._0x1f64d3,'telegramToken':_0x180049(0xec)}),settings[_0x180049(0x188)]&&settings['bbPassword']!=''&&(_0x1f64d3={..._0x1f64d3,'bbPassword':_0x180049(0xec)}),_0x1f64d3;}function updateBB(){const _0x310985=_0x2d307a;installingUpdate=!![],config[_0x310985(0x17f)](_0x48c450=>{const _0x3f0c96=_0x310985;if(pid[_0x48c450[_0x3f0c96(0x17c)]])pid[_0x48c450['botID']]['kill']();}),process['send']({'update':!![]},_0x194821=>{});}function startBot(_0x42b531,_0x606d39,_0x5b0ede){const _0x42cc8c=_0x2d307a;let _0x35f028=![];const _0x1cfd6d=_0x42b531[0x0];_0x606d39={..._0x606d39,'stdio':[_0x42cc8c(0x200),_0x42cc8c(0x200),_0x42cc8c(0x200),_0x42cc8c(0x11b)]},pid[_0x1cfd6d]=childProcess[_0x42cc8c(0xe7)](botfile,_0x42b531,_0x606d39),pid[_0x1cfd6d]['on'](_0x42cc8c(0x171),_0x35b147=>{const _0x556d6d=_0x42cc8c;switch(Object['keys'](_0x35b147)[0x0]){case _0x556d6d(0x145):updateBotName(_0x1cfd6d,_0x35b147[_0x556d6d(0x145)]);break;case _0x556d6d(0xc8):updateStatus(_0x1cfd6d,_0x35b147['status']);break;case _0x556d6d(0x18d):updateLive(_0x1cfd6d,_0x35b147[_0x556d6d(0x18d)]);break;case _0x556d6d(0x1e2):updateLive(_0x1cfd6d,_0x35b147[_0x556d6d(0x1e2)]),io['to'](_0x1cfd6d)[_0x556d6d(0x1fd)](_0x556d6d(0xc8),{'access':{'allow':![],'reason':_0x556d6d(0x1bc),'token':null}});break;case _0x556d6d(0xed):_0x35b147[_0x556d6d(0xed)]==_0x556d6d(0x203)&&stopBot(_0x1cfd6d);_0x35b147[_0x556d6d(0xed)]==_0x556d6d(0x186)&&toggleBot(_0x1cfd6d,_0x556d6d(0x13d),_0x556d6d(0x14b));break;case _0x556d6d(0x192):sendTelegram(_0x1cfd6d,_0x35b147[_0x556d6d(0x192)]);break;case _0x556d6d(0x128):io['to'](_0x1cfd6d)[_0x556d6d(0x1fd)](_0x35b147['function'],_0x35b147[_0x556d6d(0x144)]);break;}}),pid[_0x1cfd6d]['on'](_0x42cc8c(0x12c),function(_0xe2c7ae){if(_0x35f028)return;_0x35f028=!![],_0x5b0ede(_0xe2c7ae);}),pid[_0x1cfd6d]['on'](_0x42cc8c(0x16d),function(_0x216115){const _0x54ca0d=_0x42cc8c;if(installingUpdate)return;if(_0x35f028)return;_0x35f028=!![],_0x5b0ede(null);const _0xd18d38=dbConfig[_0x54ca0d(0x13e)](_0x54ca0d(0x155))['find']({'botID':_0x1cfd6d})[_0x54ca0d(0x211)]();_0xd18d38&&(_0xd18d38[_0x54ca0d(0xc8)]==_0x54ca0d(0xd7)||_0xd18d38[_0x54ca0d(0xc8)]==_0x54ca0d(0xdd))&&(updateLive(_0x1cfd6d,_0x54ca0d(0x14b)),logging(_0x54ca0d(0x1ab)+_0x1cfd6d),startBot([_0x1cfd6d,userID],{'cwd':bbpath},function(_0xe18eec){if(_0xe18eec)logging(_0xe18eec);}));});}function stopBot(_0x2e1480){const _0x59dad2=_0x2d307a;getClientsWithBotID(_0x2e1480)[_0x59dad2(0x17f)](_0x1c8cbd=>{getSocket(_0x1c8cbd['id'])['disconnect'](!![]),removeClient(_0x1c8cbd['id']);});if(pid[_0x2e1480])pid[_0x2e1480][_0x59dad2(0x186)]();}function addBot(){const _0x51ab7b=_0x2d307a;let _0x458a1e;for(let _0x5e98cd=0x1;_0x5e98cd<0x3e9;_0x5e98cd++){_0x458a1e=_0x5e98cd['toString']()[_0x51ab7b(0x1c3)](0x3,'0');let _0x488888=config[_0x51ab7b(0xe2)](_0x5e1acc=>_0x5e1acc['botID']==_0x458a1e);if(!_0x488888)break;}if(_0x458a1e===_0x51ab7b(0x190)){logging(_0x51ab7b(0x149));return;}logging(_0x51ab7b(0xd6)+_0x458a1e),dbConfig[_0x51ab7b(0x13e)]('bots')['push']({'botID':_0x458a1e,'botname':_0x51ab7b(0xf8)+_0x458a1e,'status':_0x51ab7b(0xdd),'live':''})[_0x51ab7b(0x1bb)](),startBot([_0x458a1e,userID],{'cwd':bbpath},function(_0x3f58bc){if(_0x3f58bc)logging(_0x3f58bc);}),config=getConfiguration(),io['to']('botmanager')[_0x51ab7b(0x1fd)](_0x51ab7b(0x155),config);}function deleteBot(_0x4c36f0){const _0x28cb7e=_0x2d307a;getClientsWithBotID(_0x4c36f0)[_0x28cb7e(0x17f)](_0x11f995=>{const _0x39d7ec=_0x28cb7e;getSocket(_0x11f995['id'])[_0x39d7ec(0xee)](!![]),removeClient(_0x11f995['id']);}),dbConfig[_0x28cb7e(0x13e)](_0x28cb7e(0x155))['remove']({'botID':_0x4c36f0})[_0x28cb7e(0x1bb)](),logging('deleted\x20Bot\x20'+_0x4c36f0),stopBot(_0x4c36f0);try{fs[_0x28cb7e(0x1a1)](path[_0x28cb7e(0x15d)](configpath,'bot-'+_0x4c36f0+_0x28cb7e(0x18e))),fs['unlinkSync'](path['join'](configpath,_0x28cb7e(0x120)+_0x4c36f0+'-events.json')),fs[_0x28cb7e(0x1a1)](path['join'](configpath,_0x28cb7e(0x120)+_0x4c36f0+'-performance.json')),fs[_0x28cb7e(0x1a1)](path[_0x28cb7e(0x15d)](configpath,_0x28cb7e(0x120)+_0x4c36f0+_0x28cb7e(0x184)));}catch(_0x449d16){if(_0x449d16)logging(_0x28cb7e(0x1fc),_0x449d16);}config=getConfiguration(),io['to'](_0x28cb7e(0x187))[_0x28cb7e(0x1fd)](_0x28cb7e(0x155),config);}function toggleBot(_0x35b232,_0x572c18,_0x4b8baf){const _0x1968d4=_0x2d307a;dbConfig[_0x1968d4(0x13e)]('bots')[_0x1968d4(0xe2)]({'botID':_0x35b232})[_0x1968d4(0x158)]({'status':_0x572c18})['assign']({'live':_0x4b8baf})[_0x1968d4(0x1bb)]();if(_0x572c18==_0x1968d4(0xd7)||_0x572c18==_0x1968d4(0xdd))logging(_0x1968d4(0x1df)+_0x35b232),startBot([_0x35b232,userID],{'cwd':bbpath},function(_0x3f2e77){if(_0x3f2e77)logging(_0x3f2e77);});else(_0x572c18=='disabled'||_0x572c18=='new-disabled')&&(logging(_0x1968d4(0xc9)+_0x35b232),stopBot(_0x35b232));config=getConfiguration(),io['to'](_0x1968d4(0x187))[_0x1968d4(0x1fd)](_0x1968d4(0x155),config);}function toggleStatus(_0x1a5e05){const _0x3b4558=_0x2d307a;let _0x9aa0ad=dbConfig['get']('bots')['find']({'botID':_0x1a5e05})['value'](),_0x33afdc;if(_0x9aa0ad[_0x3b4558(0xc8)]===_0x3b4558(0xd7))_0x33afdc='disabled';else{if(_0x9aa0ad[_0x3b4558(0xc8)]===_0x3b4558(0xdd))_0x33afdc='new-disabled';else{if(_0x9aa0ad[_0x3b4558(0xc8)]==='new-disabled')_0x33afdc=_0x3b4558(0xdd);else{if(_0x9aa0ad[_0x3b4558(0xc8)]===_0x3b4558(0x13d))_0x33afdc=_0x3b4558(0xd7);}}}return _0x33afdc;}function updateStatus(_0x2cd77c,_0x2d0cc3){const _0x204898=_0x2d307a;dbConfig[_0x204898(0x13e)](_0x204898(0x155))[_0x204898(0xe2)]({'botID':_0x2cd77c})[_0x204898(0x158)]({'status':_0x2d0cc3})[_0x204898(0x1bb)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x204898(0x155),config);}function updateLive(_0x1ffe30,_0x29c226){const _0x17c493=_0x2d307a;dbConfig[_0x17c493(0x13e)](_0x17c493(0x155))[_0x17c493(0xe2)]({'botID':_0x1ffe30})[_0x17c493(0x158)]({'live':_0x29c226})[_0x17c493(0x1bb)](),config=getConfiguration(),io['to'](_0x17c493(0x187))[_0x17c493(0x1fd)]('bots',config);}function updateBotName(_0x5a52cc,_0x3b745c){const _0x591ecf=_0x2d307a;dbConfig['get'](_0x591ecf(0x155))[_0x591ecf(0xe2)]({'botID':_0x5a52cc})['assign']({'botname':_0x3b745c})['write'](),config=getConfiguration(),io['to'](_0x591ecf(0x187))[_0x591ecf(0x1fd)]('bots',config);}function telegramError(_0x3df002){const _0x461faf=_0x2d307a;console[_0x461faf(0x110)](getTimeStamp()+_0x461faf(0xd2));}function validateTelegram(_0x4484bb){const _0x269c1f=_0x2d307a;if(_0x4484bb[_0x269c1f(0x119)][_0x269c1f(0x208)]!=settings['telegramUsername']&&'@'+_0x4484bb[_0x269c1f(0x119)]['username']!=settings[_0x269c1f(0x17d)])return tgBot[_0x269c1f(0x1a8)](_0x4484bb['chat']['id'],_0x269c1f(0x1fb),{'parse_mode':_0x269c1f(0x1f3)})[_0x269c1f(0x1c2)](_0xfbc696=>{telegramError(_0xfbc696);}),![];return!![];}async function initTelegram(){const _0x436b8d=_0x2d307a;if(tgBot)tgBot[_0x436b8d(0x1e4)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x436b8d(0x214)],{'polling':!![]});let _0x9bfbd0='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x9bfbd0+='\x0a',_0x9bfbd0+=_0x436b8d(0x135),_0x9bfbd0+=_0x436b8d(0x12b),_0x9bfbd0+=_0x436b8d(0x1cc),_0x9bfbd0+=_0x436b8d(0x143),_0x9bfbd0+='/on\x20-\x20start\x20bot(s)\x0a',_0x9bfbd0+=_0x436b8d(0x176),_0x9bfbd0+=_0x436b8d(0x1c6),_0x9bfbd0+=_0x436b8d(0x11f);let _0x1934de=_0x436b8d(0x166);_0x1934de+='\x0a',_0x1934de+=_0x9bfbd0,tgBot[_0x436b8d(0x1b7)](/\/start/,_0x1c6580=>{const _0x3d6c2b=_0x436b8d;if(!validateTelegram(_0x1c6580))return;if(settings[_0x3d6c2b(0xd0)]!=_0x1c6580[_0x3d6c2b(0x173)]['id'])updateSetting(_0x3d6c2b(0xd0),_0x1c6580['chat']['id']);updateSetting(_0x3d6c2b(0x10b),!![]),tgBot[_0x3d6c2b(0x1a8)](_0x1c6580[_0x3d6c2b(0x173)]['id'],_0x1934de)[_0x3d6c2b(0x1c2)](_0x5aaca1=>{telegramError(_0x5aaca1);});}),tgBot[_0x436b8d(0x1b7)](/\/enable/,_0x3071fc=>{const _0x1961ea=_0x436b8d;if(!validateTelegram(_0x3071fc))return;if(settings['telegramChatId']!=_0x3071fc['chat']['id'])updateSetting('telegramChatId',_0x3071fc[_0x1961ea(0x173)]['id']);updateSetting(_0x1961ea(0x10b),!![]),tgBot[_0x1961ea(0x1a8)](_0x3071fc['chat']['id'],_0x1961ea(0x20b))[_0x1961ea(0x1c2)](_0x38ff3e=>{telegramError(_0x38ff3e);});}),tgBot[_0x436b8d(0x1b7)](/\/config/,async _0x845b99=>{const _0x53f634=_0x436b8d;if(!validateTelegram(_0x845b99))return;tgBot[_0x53f634(0xef)](_0x53f634(0xdc)),tgBot['sendMessage'](_0x845b99[_0x53f634(0x173)]['id'],_0x53f634(0x179),{'reply_markup':{'inline_keyboard':[[{'text':_0x53f634(0x1f7),'callback_data':_0x53f634(0x1cd)},{'text':'Alerts','callback_data':_0x53f634(0x1b5)},{'text':_0x53f634(0x20f),'callback_data':'all'}]]}})[_0x53f634(0x1c2)](_0x3e6e37=>{telegramError(_0x3e6e37);}),tgBot['on'](_0x53f634(0xdc),async _0x74850c=>{const _0x58cc56=_0x53f634,_0x2eab7f=_0x74850c[_0x58cc56(0x114)],_0x2b641d=_0x74850c[_0x58cc56(0x171)];tgBot['answerCallbackQuery'](_0x74850c['id'])[_0x58cc56(0x15f)](async()=>{const _0x43013c=_0x58cc56;_0x2eab7f==_0x43013c(0x1cd)&&(updateSetting(_0x43013c(0x146),_0x43013c(0x1cd)),updateSetting(_0x43013c(0x10b),!![]),await tgBot[_0x43013c(0x1a8)](_0x2b641d['chat']['id'],_0x43013c(0x100))[_0x43013c(0x1c2)](_0x41f7d7=>{telegramError(_0x41f7d7);}));_0x2eab7f=='alerts'&&(updateSetting(_0x43013c(0x146),_0x43013c(0x1b5)),updateSetting(_0x43013c(0x10b),!![]),await tgBot['sendMessage'](_0x2b641d['chat']['id'],_0x43013c(0x15c))['catch'](_0x1c94eb=>{telegramError(_0x1c94eb);}));_0x2eab7f==_0x43013c(0x1fa)&&(updateSetting(_0x43013c(0x146),'all'),updateSetting(_0x43013c(0x10b),!![]),await tgBot[_0x43013c(0x1a8)](_0x2b641d[_0x43013c(0x173)]['id'],_0x43013c(0xf3))['catch'](_0x3d0134=>{telegramError(_0x3d0134);}));if(!settings[_0x43013c(0xd0)])tgBot[_0x43013c(0x1a8)](_0x2b641d['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x488728=>{telegramError(_0x488728);});}),tgBot[_0x58cc56(0xef)](_0x58cc56(0xdc));});}),tgBot[_0x436b8d(0x1b7)](/\/status/,_0x3e9bc3=>{const _0x3782e6=_0x436b8d;if(!validateTelegram(_0x3e9bc3))return;let _0x3a8496='<b>Balance\x20Bot\x20status:</b>\x0a';config[_0x3782e6(0x17f)](_0x23eefa=>{const _0x186c52=_0x3782e6;_0x3a8496+=_0x186c52(0xf8)+_0x23eefa[_0x186c52(0x17c)]+_0x186c52(0x151)+_0x23eefa[_0x186c52(0x145)]+':\x20'+_0x23eefa[_0x186c52(0xc8)]+_0x186c52(0x172)+_0x23eefa[_0x186c52(0x18d)]+'\x0a';}),_0x3a8496+='\x0a',_0x3a8496+=_0x3782e6(0x1b8),_0x3a8496+=!settings[_0x3782e6(0x10b)]?_0x3782e6(0x194):_0x3782e6(0xdf),_0x3a8496+=settings[_0x3782e6(0x10b)]?settings['telegramEvents']==_0x3782e6(0x1fa)?_0x3782e6(0x1a0):'Notifications\x20types:\x20'+settings[_0x3782e6(0x146)]+_0x3782e6(0x1cf):'',tgBot[_0x3782e6(0x1a8)](_0x3e9bc3[_0x3782e6(0x173)]['id'],_0x3a8496,{'parse_mode':_0x3782e6(0x1f3)})[_0x3782e6(0x1c2)](_0x2a96c4=>{telegramError(_0x2a96c4);});}),tgBot['onText'](/\/restart/,_0x17843e=>{const _0x45ed8c=_0x436b8d;if(!validateTelegram(_0x17843e))return;tgBot[_0x45ed8c(0xef)]('callback_query');const _0x7f4188=getEnabledBots();if(_0x7f4188['length']==0x0)tgBot[_0x45ed8c(0x1a8)](_0x17843e['chat']['id'],_0x45ed8c(0xd1))[_0x45ed8c(0x1c2)](_0x4ae3fe=>{telegramError(_0x4ae3fe);});else{if(_0x7f4188[_0x45ed8c(0x1ff)]>0x1)_0x7f4188[_0x45ed8c(0x180)]({'botID':_0x45ed8c(0x1fa)});let _0x2b0223=[],_0x30d1bc=[];const _0x255a60=_0x7f4188[_0x45ed8c(0x1ff)]%0x4==0x0||_0x7f4188[_0x45ed8c(0x1ff)]%0x4==0x3||_0x7f4188[_0x45ed8c(0x1ff)]%0x3==0x1?0x4:0x3;let _0x414b1d=0x0;_0x7f4188[_0x45ed8c(0x17f)]((_0x387ce3,_0x537661)=>{const _0x1b9e58=_0x45ed8c;if(_0x537661%_0x255a60==0x0)_0x30d1bc=[];_0x30d1bc['push']({'text':_0x387ce3[_0x1b9e58(0x17c)]==_0x1b9e58(0x1fa)?'All\x20bots':'Bot\x20'+_0x387ce3['botID'],'callback_data':_0x387ce3[_0x1b9e58(0x17c)]}),_0x537661%_0x255a60==0x0&&(_0x2b0223[_0x414b1d]=_0x30d1bc,_0x414b1d++);}),tgBot[_0x45ed8c(0x1a8)](_0x17843e[_0x45ed8c(0x173)]['id'],_0x45ed8c(0x13a),{'reply_markup':{'inline_keyboard':_0x2b0223}})[_0x45ed8c(0x1c2)](_0x4a8f8a=>{telegramError(_0x4a8f8a);}),tgBot['on']('callback_query',async _0x1c5013=>{const _0x5ca752=_0x45ed8c,_0x32977f=_0x1c5013[_0x5ca752(0x114)],_0x1f852f=_0x1c5013[_0x5ca752(0x171)];tgBot['answerCallbackQuery'](_0x1c5013['id'])['then'](async()=>{const _0x4106cb=_0x5ca752;if(_0x32977f==_0x4106cb(0x1fa)){if(settings[_0x4106cb(0x146)]=='orders')tgBot[_0x4106cb(0x1a8)](_0x1f852f[_0x4106cb(0x173)]['id'],_0x4106cb(0x170))[_0x4106cb(0x1c2)](_0x1c2da0=>{telegramError(_0x1c2da0);});config[_0x4106cb(0x17f)](_0x254cea=>{stopBot(_0x254cea['botID']);});}else{if(settings[_0x4106cb(0x146)]==_0x4106cb(0x1cd))tgBot[_0x4106cb(0x1a8)](_0x1f852f[_0x4106cb(0x173)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x32977f)[_0x4106cb(0x1c2)](_0x467e45=>{telegramError(_0x467e45);});stopBot(_0x32977f);}}),tgBot[_0x5ca752(0xef)](_0x5ca752(0xdc));});}}),tgBot[_0x436b8d(0x1b7)](/\/on/,_0x5e5d39=>{const _0xf358d5=_0x436b8d;if(!validateTelegram(_0x5e5d39))return;tgBot[_0xf358d5(0xef)](_0xf358d5(0xdc));const _0x1be525=getDisabledBots();if(_0x1be525[_0xf358d5(0x1ff)]==0x0)tgBot[_0xf358d5(0x1a8)](_0x5e5d39['chat']['id'],_0xf358d5(0xf4))[_0xf358d5(0x1c2)](_0x2584c7=>{telegramError(_0x2584c7);});else{if(_0x1be525[_0xf358d5(0x1ff)]>0x1)_0x1be525['push']({'botID':_0xf358d5(0x1fa)});let _0xb2ff89=[],_0x31f596=[];const _0x49b576=_0x1be525['length']%0x4==0x0||_0x1be525[_0xf358d5(0x1ff)]%0x4==0x3||_0x1be525[_0xf358d5(0x1ff)]%0x3==0x1?0x4:0x3;let _0x448e93=0x0;_0x1be525[_0xf358d5(0x17f)]((_0x502350,_0x1db331)=>{const _0x3ed840=_0xf358d5;if(_0x1db331%_0x49b576==0x0)_0x31f596=[];_0x31f596[_0x3ed840(0x180)]({'text':_0x502350[_0x3ed840(0x17c)]==_0x3ed840(0x1fa)?'All\x20bots':_0x3ed840(0xf8)+_0x502350['botID'],'callback_data':_0x502350[_0x3ed840(0x17c)]}),_0x1db331%_0x49b576==0x0&&(_0xb2ff89[_0x448e93]=_0x31f596,_0x448e93++);}),tgBot[_0xf358d5(0x1a8)](_0x5e5d39[_0xf358d5(0x173)]['id'],_0xf358d5(0xfc),{'reply_markup':{'inline_keyboard':_0xb2ff89}})[_0xf358d5(0x1c2)](_0x224274=>{telegramError(_0x224274);}),tgBot['on'](_0xf358d5(0xdc),async _0x4b7e3c=>{const _0x3c89c3=_0xf358d5,_0x1a7fb2=_0x4b7e3c[_0x3c89c3(0x114)],_0x331620=_0x4b7e3c[_0x3c89c3(0x171)];tgBot[_0x3c89c3(0x210)](_0x4b7e3c['id'])['then'](async()=>{const _0x402086=_0x3c89c3;if(_0x1a7fb2=='all'){if(settings[_0x402086(0x146)]=='orders')tgBot[_0x402086(0x1a8)](_0x331620[_0x402086(0x173)]['id'],_0x402086(0x201))[_0x402086(0x1c2)](_0x46cf62=>{telegramError(_0x46cf62);});_0x1be525[_0x402086(0x17f)](_0x455f2b=>{const _0x33f4c9=_0x402086;if(_0x455f2b[_0x33f4c9(0x17c)]!='all')toggleBot(_0x455f2b['botID'],toggleStatus(_0x455f2b[_0x33f4c9(0x17c)]),_0x33f4c9(0x14b));});}else{if(settings[_0x402086(0x146)]==_0x402086(0x1cd))tgBot['sendMessage'](_0x331620[_0x402086(0x173)]['id'],_0x402086(0x131)+_0x1a7fb2)[_0x402086(0x1c2)](_0x42ea52=>{telegramError(_0x42ea52);});toggleBot(_0x1a7fb2,toggleStatus(_0x1a7fb2),_0x402086(0x14b));}}),tgBot[_0x3c89c3(0xef)](_0x3c89c3(0xdc));});}}),tgBot[_0x436b8d(0x1b7)](/\/off/,_0x2df3eb=>{const _0x48216d=_0x436b8d;if(!validateTelegram(_0x2df3eb))return;tgBot[_0x48216d(0xef)](_0x48216d(0xdc));const _0x3f68a5=getEnabledBots();if(_0x3f68a5[_0x48216d(0x1ff)]==0x0)tgBot['sendMessage'](_0x2df3eb[_0x48216d(0x173)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0xf1c29a=>{telegramError(_0xf1c29a);});else{if(_0x3f68a5[_0x48216d(0x1ff)]>0x1)_0x3f68a5[_0x48216d(0x180)]({'botID':_0x48216d(0x1fa)});let _0x4fa3d0=[],_0x267414=[];const _0xa665c=_0x3f68a5['length']%0x4==0x0||_0x3f68a5['length']%0x4==0x3||_0x3f68a5[_0x48216d(0x1ff)]%0x3==0x1?0x4:0x3;let _0x1a193b=0x0;_0x3f68a5[_0x48216d(0x17f)]((_0x31c885,_0x56274e)=>{const _0x26836c=_0x48216d;if(_0x56274e%_0xa665c==0x0)_0x267414=[];_0x267414[_0x26836c(0x180)]({'text':_0x31c885[_0x26836c(0x17c)]==_0x26836c(0x1fa)?_0x26836c(0x1f9):_0x26836c(0xf8)+_0x31c885[_0x26836c(0x17c)],'callback_data':_0x31c885['botID']}),_0x56274e%_0xa665c==0x0&&(_0x4fa3d0[_0x1a193b]=_0x267414,_0x1a193b++);}),tgBot[_0x48216d(0x1a8)](_0x2df3eb['chat']['id'],_0x48216d(0x160),{'reply_markup':{'inline_keyboard':_0x4fa3d0}})[_0x48216d(0x1c2)](_0xf1d818=>{telegramError(_0xf1d818);}),tgBot['on'](_0x48216d(0xdc),async _0xc44218=>{const _0x13e833=_0x48216d,_0x3110c5=_0xc44218[_0x13e833(0x114)],_0x56e919=_0xc44218['message'];tgBot['answerCallbackQuery'](_0xc44218['id'])[_0x13e833(0x15f)](async()=>{const _0x42ee6e=_0x13e833;if(_0x3110c5=='all'){if(settings[_0x42ee6e(0x146)]=='orders')tgBot[_0x42ee6e(0x1a8)](_0x56e919['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x42ee6e(0x1c2)](_0x300c96=>{telegramError(_0x300c96);});_0x3f68a5[_0x42ee6e(0x17f)](_0x1df202=>{const _0x1dd791=_0x42ee6e;if(_0x1df202['botID']!=_0x1dd791(0x1fa))toggleBot(_0x1df202[_0x1dd791(0x17c)],toggleStatus(_0x1df202['botID']),_0x1dd791(0x14b));});}else{if(settings[_0x42ee6e(0x146)]==_0x42ee6e(0x1cd))tgBot['sendMessage'](_0x56e919[_0x42ee6e(0x173)]['id'],_0x42ee6e(0x16c)+_0x3110c5)['catch'](_0x43cc2a=>{telegramError(_0x43cc2a);});toggleBot(_0x3110c5,toggleStatus(_0x3110c5),_0x42ee6e(0x14b));}}),tgBot['removeListener'](_0x13e833(0xdc));});}}),tgBot[_0x436b8d(0x1b7)](/\/disable/,_0x319db7=>{const _0x15cab9=_0x436b8d;if(!validateTelegram(_0x319db7))return;tgBot[_0x15cab9(0x1a8)](_0x319db7[_0x15cab9(0x173)]['id'],_0x15cab9(0x20c))[_0x15cab9(0x1c2)](_0x19c53e=>{telegramError(_0x19c53e);}),updateSetting(_0x15cab9(0x10b),![]);}),tgBot['onText'](/\/help/,_0x1a4e4c=>{const _0x17cb12=_0x436b8d;if(!validateTelegram(_0x1a4e4c))return;tgBot[_0x17cb12(0x1a8)](_0x1a4e4c['chat']['id'],_0x9bfbd0)['catch'](_0x1abfe8=>{telegramError(_0x1abfe8);});}),tgBot['on'](_0x436b8d(0x1b6),_0x586751=>{const _0x67e200=_0x436b8d;_0x586751['toString']()[_0x67e200(0x18b)](_0x67e200(0x1e1))&&(logging(_0x67e200(0xe0)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x67e200(0x1fd)](_0x67e200(0xea),'Invalid\x20Telegram\x20token'));}),process[_0x436b8d(0x17a)]('SIGINT',()=>{const _0x1875d7=_0x436b8d;if(tgBot)tgBot[_0x1875d7(0x1e4)]();process[_0x1875d7(0x16d)](0x1);}),process[_0x436b8d(0x17a)](_0x436b8d(0x1f6),()=>{const _0x4b7809=_0x436b8d;if(tgBot)tgBot[_0x4b7809(0x1e4)]();process[_0x4b7809(0x16d)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1e2e0d,_0x6c67c1){const _0x130d55=_0x2d307a;if(settings[_0x130d55(0x10b)]){if(settings['telegramEvents']=='all'||(_0x6c67c1[_0x130d55(0x112)]=='error'||_0x6c67c1['type']=='success')&&settings[_0x130d55(0x146)]==_0x130d55(0x1b5)||_0x6c67c1[_0x130d55(0x112)]==_0x130d55(0x12a)&&settings[_0x130d55(0x146)]==_0x130d55(0x1cd)){if(tgBot&&settings[_0x130d55(0xd0)]){if(_0x6c67c1[_0x130d55(0x140)])tgBot[_0x130d55(0x1a8)](settings[_0x130d55(0xd0)],_0x6c67c1['botname']+_0x130d55(0xfd)+_0x6c67c1['event'])[_0x130d55(0x1c2)](_0x491599=>{telegramError(_0x491599);});else tgBot['sendMessage'](settings['telegramChatId'],_0x130d55(0xf8)+_0x1e2e0d+_0x130d55(0xfd)+_0x6c67c1['event'])[_0x130d55(0x1c2)](_0x421373=>{telegramError(_0x421373);});}}}}function getDeviceWithIp(_0x203bbc){const _0x5a9479=_0x2d307a;return devices[_0x5a9479(0xe2)](_0x134823=>_0x134823['ip']===_0x203bbc);}function temporaryAccess2FA(_0x27f9c3,_0xdf0e8f){const _0x12e319=_0x2d307a;let _0xbd9fa6=new Date(),_0x3e41b2=![];if(lastIpApproval){if(_0xbd9fa6-lastIpApproval<0x1388)_0x3e41b2=!![];}lastIpApproval=new Date();if(_0x3e41b2)return;tgBot&&settings[_0x12e319(0xd0)]&&(tgBot['removeListener'](_0x12e319(0xdc)),tgBot[_0x12e319(0x1a8)](settings['telegramChatId'],_0x12e319(0x1e7)+normalizeIP(_0xdf0e8f)['show']+_0x12e319(0x185),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x12e319(0x137),'callback_data':'5'},{'text':_0x12e319(0xcd),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':_0x12e319(0xdb)}]]}})['catch'](_0xf1f792=>{telegramError(_0xf1f792);}),tgBot['on'](_0x12e319(0xdc),async _0x471da8=>{const _0x2ef37e=_0x12e319,_0x15922=_0x471da8['data'],_0x36e8fe=_0x471da8[_0x2ef37e(0x171)];tgBot['answerCallbackQuery'](_0x471da8['id'])['then'](async()=>{const _0xb6ac2d=_0x2ef37e;devices[_0x27f9c3][_0xb6ac2d(0x154)]={'clientip':_0xdf0e8f,'timestamp':new Date()[_0xb6ac2d(0x16f)](),'expiry':_0x15922},_0x15922!=_0xb6ac2d(0xdb)?(await tgBot[_0xb6ac2d(0x1a8)](_0x36e8fe[_0xb6ac2d(0x173)]['id'],'Access\x20enabled\x20for\x20'+_0x15922+'\x20minutes',{'parse_mode':'HTML'})[_0xb6ac2d(0x1c2)](_0x4f1f91=>{telegramError(_0x4f1f91);}),io['to'](_0x27f9c3)['emit'](_0xb6ac2d(0xc8),{'access':{'allow':![],'reason':_0xb6ac2d(0x1bc),'token':null}})):(await tgBot[_0xb6ac2d(0x1a8)](_0x36e8fe[_0xb6ac2d(0x173)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x468fde=>{telegramError(_0x468fde);}),io['to'](_0x27f9c3)['emit'](_0xb6ac2d(0xc8),{'access':{'allow':![],'reason':_0xb6ac2d(0x122),'token':null}}));}),tgBot['removeListener'](_0x2ef37e(0xdc));}));}function loginAccess2FA(_0x151e8b,_0x260f71){const _0x1d7da3=_0x2d307a;tgBot&&settings[_0x1d7da3(0xd0)]&&(tgBot[_0x1d7da3(0xef)](_0x1d7da3(0xdc)),tgBot[_0x1d7da3(0x1a8)](settings[_0x1d7da3(0xd0)],_0x1d7da3(0x130)+normalizeIP(_0x260f71)[_0x1d7da3(0x159)]+_0x1d7da3(0x185),{'parse_mode':_0x1d7da3(0x1f3),'reply_markup':{'inline_keyboard':[[{'text':_0x1d7da3(0x19c),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x1d7da3(0xdb)}]]}})[_0x1d7da3(0x1c2)](_0x3daa61=>{telegramError(_0x3daa61);}),tgBot['on'](_0x1d7da3(0xdc),async _0x2207a4=>{const _0x2ca5c6=_0x1d7da3,_0x5b7aec=_0x2207a4['data'],_0x4e06c4=_0x2207a4['message'];tgBot[_0x2ca5c6(0x210)](_0x2207a4['id'])['then'](async()=>{const _0x28d683=_0x2ca5c6;devices[_0x151e8b][_0x28d683(0x178)]={'clientip':_0x260f71,'timestamp':new Date()['getTime'](),'expiry':_0x5b7aec},_0x5b7aec!='reject'?(await tgBot['sendMessage'](_0x4e06c4[_0x28d683(0x173)]['id'],_0x28d683(0x16b),{'parse_mode':_0x28d683(0x1f3)})['catch'](_0x26cef9=>{telegramError(_0x26cef9);}),io['to'](_0x151e8b)['emit'](_0x28d683(0xc8),{'access':{'allow':![],'reason':_0x28d683(0x1bc),'token':null}})):(await tgBot['sendMessage'](_0x4e06c4[_0x28d683(0x173)]['id'],_0x28d683(0xff))[_0x28d683(0x1c2)](_0x3b67d1=>{telegramError(_0x3b67d1);}),io['to'](_0x151e8b)[_0x28d683(0x1fd)](_0x28d683(0xc8),{'access':{'allow':![],'reason':_0x28d683(0x1ea),'token':null}}));}),tgBot[_0x2ca5c6(0xef)](_0x2ca5c6(0xdc));}));}function getConfiguration(){const _0xc75a50=_0x2d307a;return dbConfig[_0xc75a50(0x13e)](_0xc75a50(0x155))['sortBy'](_0xc75a50(0x17c))[_0xc75a50(0x211)]()||[];}function getEnabledBots(){const _0x507382=_0x2d307a;return dbConfig[_0x507382(0x13e)](_0x507382(0x155))[_0x507382(0x19a)](_0x507382(0x17c))[_0x507382(0x197)]({'status':_0x507382(0xd7)})[_0x507382(0x211)]()||[];}function getDisabledBots(){const _0x4d961b=_0x2d307a;return dbConfig[_0x4d961b(0x13e)](_0x4d961b(0x155))[_0x4d961b(0x19a)](_0x4d961b(0x17c))[_0x4d961b(0x197)]({'status':'disabled'})['value']()||[];}function getSettings(){const _0x211d4e=_0x2d307a;return dbSettings[_0x211d4e(0x13e)](_0x211d4e(0x1e9))[_0x211d4e(0x211)]()||{'timeshift':0x0};}function getSecure(){const _0x4f0f80=_0x2d307a;return dbSecure[_0x4f0f80(0x13e)](_0x4f0f80(0x1fe))[_0x4f0f80(0x211)]()||{};}function getBlacklist(){const _0x3d1b22=_0x2d307a;return dbSecure[_0x3d1b22(0x13e)](_0x3d1b22(0x1a6))['value']()||[];}function broadcastToBots(_0x285c4f,_0x380b1a){config['forEach'](_0x47ebf8=>{const _0x51bd51=_0x4644;if(_0x47ebf8[_0x51bd51(0xc8)]==_0x51bd51(0xd7)&&_0x47ebf8[_0x51bd51(0x18d)]==_0x51bd51(0x1d0)){if(pid[_0x47ebf8[_0x51bd51(0x17c)]])pid[_0x47ebf8[_0x51bd51(0x17c)]][_0x51bd51(0xf5)]({[_0x285c4f]:_0x380b1a});}});}function storeSettings(_0x5b0376,_0x16d143=![]){const _0x5af65f=_0x2d307a;_0x5b0376={...settings,..._0x5b0376};if(_0x16d143&&_0x5b0376['bbPassword']!=_0x5af65f(0xec)&&_0x5b0376[_0x5af65f(0x188)]!=''){const _0x152bef=crypt[_0x5af65f(0x115)](secure[_0x5af65f(0x138)],_0x5b0376['bbPassword'])[_0x5af65f(0x171)][_0x5af65f(0x199)]('@')[0x0],_0x3aefe9=bcrypt[_0x5af65f(0x14e)](_0x152bef,saltRounds);_0x5b0376={..._0x5b0376,'bbPassword':_0x3aefe9};}if(_0x16d143&&_0x5b0376[_0x5af65f(0x214)]!=_0x5af65f(0xec)&&_0x5b0376[_0x5af65f(0x214)]!=''){const _0x1fb584=crypt[_0x5af65f(0x115)](secure[_0x5af65f(0x138)],_0x5b0376[_0x5af65f(0x214)])[_0x5af65f(0x171)][_0x5af65f(0x199)]('@')[0x0];_0x5b0376={..._0x5b0376,'telegramToken':_0x1fb584};}const _0x135d8e=_0x5b0376[_0x5af65f(0x214)]!='************'&&_0x5b0376[_0x5af65f(0x214)]!=settings[_0x5af65f(0x214)]||_0x5b0376[_0x5af65f(0x17d)]!=settings[_0x5af65f(0x17d)],_0x5584e9=_0x5b0376[_0x5af65f(0x214)]==''||_0x5b0376[_0x5af65f(0x17d)]=='';if(_0x135d8e)_0x5b0376[_0x5af65f(0x146)]='all';for(const [_0x4543ee,_0x3cba30]of Object['entries'](_0x5b0376)){if(_0x4543ee==_0x5af65f(0x214)&&_0x3cba30=='************'){_0x5b0376['telegramToken']=settings[_0x5af65f(0x214)];continue;};if(_0x4543ee=='bbPassword'&&_0x3cba30=='************'){_0x5b0376[_0x5af65f(0x188)]=settings[_0x5af65f(0x188)];continue;};dbSettings[_0x5af65f(0x103)]('settings.'+_0x4543ee,_0x3cba30)[_0x5af65f(0x1bb)]();}settings=_0x5b0376,io['to'](_0x5af65f(0x187))[_0x5af65f(0x1fd)](_0x5af65f(0x1e9),cleanSettings()),broadcastToBots(_0x5af65f(0x1de),settings[_0x5af65f(0x1de)]);if(_0x135d8e&&!_0x5584e9)initTelegram();if(_0x135d8e&&_0x5584e9)disableTelegram();getAllClients()['forEach'](_0x304089=>{const _0x4e7d5a=_0x5af65f;getSocket(_0x304089['id'])[_0x4e7d5a(0x1fd)](_0x4e7d5a(0xc8),{'access':{'allow':![],'reason':_0x4e7d5a(0x1bc),'token':null}});});}function updateSetting(_0x59b927,_0x4d7b47){const _0x348ae2=_0x2d307a;dbSettings[_0x348ae2(0x103)](_0x348ae2(0x1e5)+_0x59b927,_0x4d7b47)['write'](),settings=getSettings(),io['to'](_0x348ae2(0x187))[_0x348ae2(0x1fd)](_0x348ae2(0x1e9),cleanSettings());}function storeSecure(_0x493e0d){const _0x300def=_0x2d307a;dbSecure[_0x300def(0x13e)](_0x300def(0x1fe))[_0x300def(0x180)](_0x493e0d)[_0x300def(0x1bb)](),secure=_0x493e0d;}function addBlacklist(_0x152be3){const _0x631cd5=_0x2d307a;cleanBlacklist();let _0x32abc6;devices[_0x152be3][_0x631cd5(0x154)]?_0x32abc6=Math[_0x631cd5(0x10e)](devices[_0x152be3][_0x631cd5(0x154)][_0x631cd5(0x111)],loginExpiry):_0x32abc6=loginExpiry,dbSecure[_0x631cd5(0x13e)](_0x631cd5(0x1a6))[_0x631cd5(0x180)]({'expiry':new Date()['getTime']()+_0x32abc6*0x3c*0x3e8,'token':devices[_0x152be3]['access'][_0x631cd5(0xca)]})[_0x631cd5(0x1bb)](),blacklist=dbSecure[_0x631cd5(0x13e)](_0x631cd5(0x1a6))['value']();}function cleanBlacklist(){const _0x35699b=_0x2d307a;let _0x38a921=dbSecure[_0x35699b(0x13e)](_0x35699b(0x1a6))[_0x35699b(0x13c)]()['value'](),_0x3ca3a1=new Date()[_0x35699b(0x16f)]();_0x38a921[_0x35699b(0x17f)](_0x56eec8=>{const _0x460cf8=_0x35699b;_0x56eec8[_0x460cf8(0x111)]<_0x3ca3a1&&dbSecure[_0x460cf8(0x13e)]('blacklist')[_0x460cf8(0x198)]({'expiry':_0x56eec8[_0x460cf8(0x111)]})['write']();});}function initStates(){let _0xa574fd=getConfiguration();_0xa574fd['forEach'](_0x3d32b4=>{const _0x4eb0ae=_0x4644;_0x3d32b4[_0x4eb0ae(0x18d)]=_0x4eb0ae(0x14b);}),storeConfiguration(_0xa574fd);}function onKeys(){const _0x40981b=new RSA();return new Promise(_0x22871a=>{const _0x1b6e99=_0x4644;_0x40981b['generateKeyPairAsync']()[_0x1b6e99(0x15f)](_0x12197a=>{_0x22871a(_0x12197a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x50c1e1=_0x2d307a;let _0x14e546=getConfiguration(),_0x3deeb2=![];_0x14e546[_0x50c1e1(0x17f)](_0x332bd2=>{const _0xf6655f=_0x50c1e1;if(_0x332bd2[_0xf6655f(0xc8)]==_0xf6655f(0x1d0))_0x332bd2[_0xf6655f(0xc8)]=_0xf6655f(0xd7),_0x3deeb2=!![];else _0x332bd2[_0xf6655f(0xc8)]==_0xf6655f(0x14b)&&(_0x332bd2[_0xf6655f(0xc8)]='disabled',_0x3deeb2=!![]);});if(_0x3deeb2)storeConfiguration(_0x14e546);let _0x45dd04=getSecure();if(!_0x45dd04['hasOwnProperty']('secret')){let _0x8047a1=await generateKeys();_0x45dd04[_0x50c1e1(0x121)]=_0x8047a1[_0x50c1e1(0x121)],_0x45dd04[_0x50c1e1(0x138)]=_0x8047a1[_0x50c1e1(0x138)],_0x45dd04[_0x50c1e1(0x1d9)]=crypto[_0x50c1e1(0xce)](0x20)[_0x50c1e1(0x11d)](_0x50c1e1(0x1ac));;storeSecure(_0x45dd04);}let _0x150a09=getSettings();_0x3deeb2=![];!_0x150a09[_0x50c1e1(0x14a)]('loginRequired')&&(_0x150a09[_0x50c1e1(0x108)]=![],_0x150a09[_0x50c1e1(0x133)]='',_0x150a09['bbPassword']='',_0x150a09[_0x50c1e1(0x153)]=![],_0x3deeb2=!![]);!_0x150a09[_0x50c1e1(0x14a)](_0x50c1e1(0x195))&&(_0x150a09[_0x50c1e1(0x195)]=![],_0x150a09[_0x50c1e1(0x1db)]=[],_0x150a09[_0x50c1e1(0x11e)]=![],_0x3deeb2=!![]);if(!_0x150a09['hasOwnProperty'](_0x50c1e1(0x10b))){if(_0x150a09['telegramChatId'])_0x150a09[_0x50c1e1(0x10b)]=!![];else _0x150a09[_0x50c1e1(0x10b)]=![];_0x3deeb2=!![];}if(_0x3deeb2)storeSettings(_0x150a09);}function storeConfiguration(_0x395914){const _0x5f5a2f=_0x2d307a;dbConfig['get'](_0x5f5a2f(0x155))[_0x5f5a2f(0x198)]()[_0x5f5a2f(0x1bb)](),dbConfig[_0x5f5a2f(0x13e)](_0x5f5a2f(0x155))[_0x5f5a2f(0x180)](..._0x395914)['write'](),config=_0x395914;}function resetPassword(){const _0x574c59=_0x2d307a;tgBot&&settings[_0x574c59(0xd0)]&&(tgBot[_0x574c59(0xef)]('callback_query'),tgBot[_0x574c59(0x1a8)](settings[_0x574c59(0xd0)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x574c59(0x1f3),'reply_markup':{'inline_keyboard':[[{'text':_0x574c59(0x10f),'callback_data':_0x574c59(0x10f)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2a76b3=>{telegramError(_0x2a76b3);}),tgBot['on'](_0x574c59(0xdc),async _0x3389e3=>{const _0x4579f7=_0x574c59,_0x4504b9=_0x3389e3[_0x4579f7(0x114)],_0x546bb1=_0x3389e3['message'];tgBot[_0x4579f7(0x210)](_0x3389e3['id'])['then'](async()=>{const _0x5da5dc=_0x4579f7;if(_0x4504b9!='no'){const _0x27bb3b=0xf,_0x211396='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x475085=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x27bb3b)))[_0x5da5dc(0x148)](_0x246a81=>_0x211396[_0x246a81%_0x211396[_0x5da5dc(0x1ff)]])['join'](''),_0x34fbef=bcrypt[_0x5da5dc(0x14e)](_0x475085,saltRounds);storeSettings({'bbPassword':_0x34fbef}),await tgBot[_0x5da5dc(0x1a8)](_0x546bb1['chat']['id'],_0x5da5dc(0x156)+_0x475085,{'parse_mode':'HTML'})[_0x5da5dc(0x1c2)](_0x10379c=>{telegramError(_0x10379c);});}else await tgBot[_0x5da5dc(0x1a8)](_0x546bb1['chat']['id'],_0x5da5dc(0x196))[_0x5da5dc(0x1c2)](_0x2c9e96=>{telegramError(_0x2c9e96);});}),tgBot[_0x4579f7(0xef)](_0x4579f7(0xdc));}));}function logging(_0x498b63){const _0x3ec8c1=_0x2d307a;console['log'](getTimeStamp()+_0x3ec8c1(0x1f0)+_0x498b63);if(tgBot&&settings['telegramChatId']&&settings[_0x3ec8c1(0x146)]!=_0x3ec8c1(0x1cd))tgBot[_0x3ec8c1(0x1a8)](settings[_0x3ec8c1(0xd0)],_0x3ec8c1(0x1c1)+_0x498b63)[_0x3ec8c1(0x1c2)](_0x3b7c10=>{telegramError(_0x3b7c10);});}function getServerTime(){const _0x3e8be7=_0x2d307a,_0x478ddd=new Date();return _0x478ddd[_0x3e8be7(0x1a2)]()+'/'+(_0x478ddd[_0x3e8be7(0x1d7)]()+0x1)[_0x3e8be7(0x11d)]()[_0x3e8be7(0x1c3)](0x2,'0')+'/'+_0x478ddd[_0x3e8be7(0x1d5)]()[_0x3e8be7(0x11d)]()[_0x3e8be7(0x1c3)](0x2,'0')+'\x20'+_0x478ddd[_0x3e8be7(0x1f8)]()[_0x3e8be7(0x11d)]()[_0x3e8be7(0x1c3)](0x2,'0')+':'+_0x478ddd[_0x3e8be7(0x13b)]()[_0x3e8be7(0x11d)]()[_0x3e8be7(0x1c3)](0x2,'0')+':'+_0x478ddd['getSeconds']()[_0x3e8be7(0x11d)]()[_0x3e8be7(0x1c3)](0x2,'0');}function _0x4644(_0xcc2619,_0x4d33c7){const _0x4cd57b=_0x4970();return _0x4644=function(_0x9dad8a,_0x26944d){_0x9dad8a=_0x9dad8a-0xc7;let _0x497071=_0x4cd57b[_0x9dad8a];return _0x497071;},_0x4644(_0xcc2619,_0x4d33c7);}function getTimeStamp(){const _0x32318f=_0x2d307a,_0x5d2019=shiftedTime();return _0x5d2019[_0x32318f(0x1a2)]()+'/'+(_0x5d2019['getMonth']()+0x1)[_0x32318f(0x11d)]()[_0x32318f(0x1c3)](0x2,'0')+'/'+_0x5d2019['getDate']()[_0x32318f(0x11d)]()[_0x32318f(0x1c3)](0x2,'0')+'\x20'+_0x5d2019[_0x32318f(0x1f8)]()[_0x32318f(0x11d)]()['padStart'](0x2,'0')+':'+_0x5d2019[_0x32318f(0x13b)]()[_0x32318f(0x11d)]()[_0x32318f(0x1c3)](0x2,'0')+':'+_0x5d2019[_0x32318f(0x18f)]()[_0x32318f(0x11d)]()[_0x32318f(0x1c3)](0x2,'0');}function shiftedTime(){const _0x1a2977=_0x2d307a,_0x1cdd5e=new Date();let _0x165317=_0x1cdd5e;if(settings['timeshift']&&settings[_0x1a2977(0x1de)]!==0x0)_0x165317=fns[_0x1a2977(0xda)](_0x1cdd5e,{'hours':settings['timeshift']});return _0x165317;}function startScheduler(){const _0x12e136=_0x2d307a;let _0x323557=new Date()[_0x12e136(0x136)]();_0x323557==0x1&&backupConfigFiles();_0x323557==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x5ad53f=_0x2d307a;fs[_0x5ad53f(0xfa)](configpath,{'withFileTypes':!![]})['forEach'](_0x502f21=>{const _0x146f96=_0x5ad53f;if(!_0x502f21[_0x146f96(0x1b3)]())fs[_0x146f96(0x113)](configpath+_0x502f21['name'],configbackuppath+_0x502f21[_0x146f96(0xf0)]);});}function triggerAnalytics(){const _0x3701c5=_0x2d307a;analytics[_0x3701c5(0x175)]({'title':_0x3701c5(0x1d6),'href':_0x3701c5(0x142),'path':'/v'+serverversion});}function validateCredentials(_0x1f650e,_0x5409c8){const _0x485419=_0x2d307a;if(_0x1f650e[_0x485419(0x208)]==settings[_0x485419(0x133)]&&bcrypt[_0x485419(0x15e)](_0x1f650e[_0x485419(0x126)],settings[_0x485419(0x188)])){if(settings[_0x485419(0x153)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4086c3=generateLoginToken(_0x5409c8);return{'allow':!![],'reason':_0x485419(0xe6),'token':_0x4086c3};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x446469){const _0x1435a6=generateLoginToken(_0x446469);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1435a6};}function validateAccess(_0x5c6a01,_0x399b92){const _0x5344e0=_0x2d307a;let _0x43f1b8=devices[_0x399b92]['ip'],_0x4592cd;const _0x5cc02d=_0x4b6a5f=>{const _0x40178a=_0x4644;if(settings[_0x40178a(0x108)]){if(settings[_0x40178a(0x153)]){if(telegram2FaApproved(_0x399b92)){const _0x56b1e0=generateLoginToken(_0x399b92);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x56b1e0};}else return{'allow':![],'reason':_0x40178a(0x177),'token':null};}else return _0x4592cd=validToken(_0x4b6a5f,_0x399b92),_0x4592cd[_0x40178a(0x14a)](_0x40178a(0x207))?{'allow':!![],'reason':_0x40178a(0x1a9),'token':_0x4b6a5f}:{'allow':![],'reason':_0x40178a(0x177),'token':null};}else return{'allow':!![],'reason':_0x40178a(0xcf),'token':null};};if(settings['whitelistEnabled']){let _0x17e52f=[...settings['whitelist'],_0x5344e0(0x127),_0x5344e0(0x1ec),_0x5344e0(0x191)];if(_0x17e52f[_0x5344e0(0x18b)](_0x43f1b8))return _0x5cc02d(_0x5c6a01);else{_0x4592cd=validToken(_0x5c6a01,_0x399b92);if(_0x4592cd[_0x5344e0(0x14a)]('success'))return _0x5cc02d(_0x5c6a01);else{if(telegramIpApproved(_0x399b92)){const _0x54e8f3=generateToken(_0x399b92);return _0x4592cd=_0x5cc02d(_0x5c6a01),_0x4592cd['allow']?{'allow':!![],'reason':_0x5344e0(0xe5),'token':_0x54e8f3}:_0x4592cd;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5cc02d(_0x5c6a01);}function timelyDecrypt(_0x222fcd,_0x227d53=!![]){const _0x57ca4b=_0x2d307a;if(_0x222fcd)try{const _0x21ef75=crypt[_0x57ca4b(0x115)](secure[_0x57ca4b(0x138)],_0x222fcd)['message'],_0x2379dc=_0x21ef75[_0x57ca4b(0x199)]('@')[0x0],_0x249cc3=_0x21ef75[_0x57ca4b(0x199)]('@')[0x1],_0x44fb86=new Date()[_0x57ca4b(0x16f)]();if(_0x227d53){if(_0x44fb86-_0x249cc3<maxSecretAge*0x3e8)return _0x2379dc;else return![];}else return _0x2379dc;}catch(_0x994442){return![];}else return![];}const validToken=(_0x3626c2,_0x3c0041)=>{const _0x1883fb=_0x2d307a,_0x2e968f=devices[_0x3c0041]['ip'];if(!_0x3626c2)return{'error':_0x1883fb(0xe4)};for(let _0x43de11 of blacklist){if(_0x43de11[_0x1883fb(0xca)]==_0x3626c2)return{'error':'Token\x20blacklisted'};}let _0x1d6ad3;try{_0x1d6ad3=jwt['verify'](_0x3626c2,secure[_0x1883fb(0x1d9)]+_0x3c0041);}catch{return{'error':_0x1883fb(0x1bd)};}if(!_0x1d6ad3[_0x1883fb(0x14a)](_0x1883fb(0xf9))&&!_0x1d6ad3[_0x1883fb(0x14a)](_0x1883fb(0x208))||!_0x1d6ad3[_0x1883fb(0x14a)](_0x1883fb(0x1e6)))return{'error':_0x1883fb(0x163)};if(!_0x1d6ad3[_0x1883fb(0x14a)](_0x1883fb(0x208))&&_0x1d6ad3[_0x1883fb(0x14a)]('clientip')){const {clientip:_0x4bcfe0}=_0x1d6ad3;return _0x2e968f==_0x4bcfe0?{'success':_0x1883fb(0x14d)}:{'error':_0x1883fb(0x1d4)};}else{if(_0x1d6ad3[_0x1883fb(0x14a)](_0x1883fb(0x208))&&_0x1d6ad3['hasOwnProperty'](_0x1883fb(0xf9))){const {username:_0x434bd6,clientip:_0x77d8a0}=_0x1d6ad3;return settings[_0x1883fb(0x133)]==_0x434bd6&&_0x2e968f==_0x77d8a0?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1883fb(0x18c)};}}},generateLoginToken=_0x141c33=>{const _0xedefd3=_0x2d307a;if(_0x141c33){const _0x4d82c7=devices[_0x141c33]['ip'];return jwt[_0xedefd3(0x16e)]({'username':settings[_0xedefd3(0x133)],'clientip':_0x4d82c7},secure[_0xedefd3(0x1d9)]+_0x141c33,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x592172=>{const _0x3f1277=_0x2d307a;if(_0x592172){const _0x223c6b=devices[_0x592172]['ip'];return jwt[_0x3f1277(0x16e)]({'clientip':_0x223c6b},secure[_0x3f1277(0x1d9)]+_0x592172,{'expiresIn':devices[_0x592172]['telegramIpApproval']['expiry']*0x3c});}else return![];},telegramIpApproved=_0x3fd2d9=>{const _0x514b40=_0x2d307a;let _0x61d6e4=![];return devices[_0x3fd2d9]['telegramIpApproval']&&devices[_0x3fd2d9]['telegramIpApproval']['expiry']!=_0x514b40(0xdb)&&(_0x61d6e4=devices[_0x3fd2d9]['telegramIpApproval'][_0x514b40(0xf9)]==devices[_0x3fd2d9]['ip']&&new Date()['getTime']()-devices[_0x3fd2d9][_0x514b40(0x154)]['timestamp']<devices[_0x3fd2d9][_0x514b40(0x154)][_0x514b40(0x111)]*0x3c*0x3e8),_0x61d6e4;},telegram2FaApproved=_0x50b5e1=>{const _0x4e37fd=_0x2d307a;let _0x4dbbc4=![];return devices[_0x50b5e1]['telegram2FaApproval']&&devices[_0x50b5e1][_0x4e37fd(0x178)][_0x4e37fd(0x111)]!=_0x4e37fd(0xdb)&&(_0x4dbbc4=devices[_0x50b5e1]['telegram2FaApproval'][_0x4e37fd(0xf9)]==devices[_0x50b5e1]['ip']&&new Date()[_0x4e37fd(0x16f)]()-devices[_0x50b5e1]['telegram2FaApproval'][_0x4e37fd(0xf6)]<devices[_0x50b5e1][_0x4e37fd(0x178)][_0x4e37fd(0x111)]*0x3c*0x3e8),_0x4dbbc4;},normalizeIP=_0x1d9023=>{const _0x26dc65=_0x2d307a;let _0x291bdc=null,_0x316ead=null;if(ipaddr[_0x26dc65(0xc7)](_0x1d9023)){const _0x1448b0=ipaddr['parse'](_0x1d9023);_0x1448b0['kind']()===_0x26dc65(0x10c)?(_0x1448b0[_0x26dc65(0x11a)]()&&(_0x291bdc=_0x1448b0[_0x26dc65(0x1c8)]()[_0x26dc65(0x11d)]()),_0x316ead=_0x1448b0[_0x26dc65(0x11d)]()):(_0x291bdc=_0x1448b0[_0x26dc65(0x11d)](),_0x316ead=_0x1448b0['toIPv4MappedAddress']()[_0x26dc65(0x11d)]());}return{'show':_0x291bdc?_0x291bdc:_0x316ead,'store':_0x316ead};};