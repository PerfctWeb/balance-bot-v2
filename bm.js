const _0x10db24=_0x40a5;(function(_0x55efaa,_0x427a4e){const _0x42145d=_0x40a5,_0x32ceeb=_0x55efaa();while(!![]){try{const _0x2d4f35=-parseInt(_0x42145d(0xa9))/0x1*(parseInt(_0x42145d(0x100))/0x2)+parseInt(_0x42145d(0x172))/0x3*(parseInt(_0x42145d(0xae))/0x4)+-parseInt(_0x42145d(0xd7))/0x5*(-parseInt(_0x42145d(0x154))/0x6)+parseInt(_0x42145d(0xa2))/0x7*(parseInt(_0x42145d(0x197))/0x8)+-parseInt(_0x42145d(0x151))/0x9*(parseInt(_0x42145d(0x140))/0xa)+-parseInt(_0x42145d(0xc4))/0xb+-parseInt(_0x42145d(0x176))/0xc*(-parseInt(_0x42145d(0x1a4))/0xd);if(_0x2d4f35===_0x427a4e)break;else _0x32ceeb['push'](_0x32ceeb['shift']());}catch(_0x468e5b){_0x32ceeb['push'](_0x32ceeb['shift']());}}}(_0x2149,0xb2223));const _0x483a8e=function(){let _0x2068e4=!![];return function(_0x7e948e,_0x1816f2){const _0x32a18a=_0x2068e4?function(){const _0x5de3ac=_0x40a5;if(_0x1816f2){const _0x1abb02=_0x1816f2[_0x5de3ac(0x147)](_0x7e948e,arguments);return _0x1816f2=null,_0x1abb02;}}:function(){};return _0x2068e4=![],_0x32a18a;};}(),_0xbedb6a=_0x483a8e(this,function(){const _0x1b769d=_0x40a5;return _0xbedb6a['toString']()['search'](_0x1b769d(0x10b))[_0x1b769d(0x11d)]()[_0x1b769d(0xa0)](_0xbedb6a)[_0x1b769d(0xa4)]('(((.+)+)+)+$');});_0xbedb6a();'use strict';process['env'][_0x10db24(0x169)]=0x1;const childProcess=require(_0x10db24(0xc3)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require('date-fns'),low=require(_0x10db24(0x87)),path=require(_0x10db24(0x128)),crypto=require(_0x10db24(0x174)),Crypt=require(_0x10db24(0x146))[_0x10db24(0x157)],RSA=require(_0x10db24(0x146))['RSA'],bcrypt=require(_0x10db24(0x10a)),jwt=require(_0x10db24(0xf0)),analyticsLib=require(_0x10db24(0xec))[_0x10db24(0xf1)],googleAnalytics=require(_0x10db24(0xdf))[_0x10db24(0xf1)],ipaddr=require(_0x10db24(0xa5)),argv=require(_0x10db24(0xe4))(process[_0x10db24(0xb3)]['slice'](0x2))['argv'],PORT=argv[_0x10db24(0x1c0)]||_0x10db24(0x131),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x10db24(0x17e)](PORT))return console[_0x10db24(0x130)](_0x10db24(0x1a8)+PORT+_0x10db24(0x10c)),process[_0x10db24(0x186)](0x1);const HOST=argv[_0x10db24(0x1a9)]||null,userID=argv[_0x10db24(0x91)]||'';function _0x2149(){const _0x5be2b5=['stopPolling','Unauthorized\x20attempt\x20to\x20get\x20logs','type','username','argv','/on\x20-\x20start\x20bot(s)\x0a','SIGTERM','data','verify','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','bbUsername','pidRefreshToken','keys','No\x20authentication\x20token','secret','toIPv4Address','sign','delete-alerts','referer','whitelistEnabled','child_process','871717pirjfb','-performance.json','telegramUsername','show','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','/restart\x20-\x20restart\x20bot(s)\x0a','stop','getHours','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegram2FaApproval','telegramIpApproval','Unauthorized\x20attempt\x20to\x20add\x20bot','use','write','reason','getFullYear','You\x20can\x20use\x20the\x20following\x20commands:\x0a','token','bb-secure.json','5LGHtwr','decrypt','node-telegram-bot-api','server','enabled\x20Bot\x20','index.html','orders','Unauthorized\x20attempt\x20to\x20log\x20out','@analytics/google-analytics','login\x20token\x20generated','<b>Balance\x20Bot\x20status:</b>\x0a','f2aRequired','************','yargs/yargs','conn','kind','remove','ipc','max','access','2FA\x20required','analytics','add-bot','allow','compareSync','jsonwebtoken','default','All\x20bots\x20running\x20right\x20now','sortBy','yes','getStartingBalances','find','timestamp','answerCallbackQuery','defaults','invalid\x20credentials','uuid','/disable\x20-\x20disable\x20notifications\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','then','build','6WAIzcm','/status\x20-\x20show\x20bot(s)\x20status\x0a','chat','emit','store-headless','new','::ffff:127.0.0.1','hex','order','value','bcryptjs','(((.+)+)+)+$',',\x20must\x20be\x20a\x204\x20digit\x20number','getSeconds','settings.','Balance\x20Bot\x20Server','logout','All','temporary\x20token\x20generated','handshake','static','bb/','new-disabled','telegramEnabled','assign','showname','Notifications\x20disabled','send','onText','toString','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','telegramToken','filter','randomBytes','update-bb','\x20|\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','callback_query','settings','path','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','polling_error','reload','::1','-----------------------------------------------------------------------------------','place-order','get-starting-balances','log','3000','parse','whitelist','access\x20timeout','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','2FA\x20login\x20required','randomFillSync','Invalid\x20authentication\x20token\x20(2)','<b>Telegram\x20bot\x20status:</b>\x0a','telegram','cancel-loading','disconnect','logged\x20out','expiry','readdirSync','20UXxXZf','event','stopped','generateKeyPairAsync','join','telegramChatId','hybrid-crypto-js','apply','store','2FA\x20login\x20token\x20generated','from','connected','enabled','Notifications\x20enabled\x0a','add','bot','idling\x20bot\x20\x20\x20|\x20Bot\x20','5025906wQYHQj','https://hodlerhacks.com','Orders','1068666FFlVDl','page','secure','Crypt','deleteHistoryAlerts','publicKey','backup/','error','starting\x20bot\x20|\x20Bot\x20','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','version.json','reject','timeshift','404\x20Not\x20Found','disabled','</b>\x20?','login\x20token\x20valid','get-logs','listen','started','botname','NTBA_FIX_319','Invalid\x20Telegram\x20token','\x20/\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','bbPassword','bot-','getMonth','live','62943OPODwV','Login\x20rejected','crypto','Notifications\x20enabled','9552108hOVaDI',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','inherit','/:bot/history','password','Ok,\x20will\x20send\x20order\x20notifications\x20only','emitHistory','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','test','update-bot','message','remoteAddress','-events.json','push','get','storeHeadless','exit','removeListener','getMinutes','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','mkdirSync','Bot\x20','/:bot/support','includes','privateKey','1000','accept','get-portfolio','storeConfiguration','getDate','sendMessage','blacklist','map','56HflvXn','Bot\x20Mgr\x20>\x20','connection','split','Unauthorized\x20attempt\x20to\x20update\x20settings','bb-settings.json','function','fork','clientip','/help\x20-\x20show\x20available\x20commands\x0a','reset-password','disabled\x20Bot\x20','store-configuration','13acrHCD','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','\x20only\x0a','HTML','Error:\x20Invalid\x20argument\x20','host','createServer','express','getTime','RSA-OAEP','match','success','Invalid\x20authentication\x20token\x20(1)','sockets','sendFile','../install.js','running','login\x20required','alerts','Unauthorized\x20attempt\x20to\x20get\x20portfolio','config/','sha256','Alerts','length','All\x20bots','Unauthorized\x20attempt\x20to\x20update\x20bot','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','login','port','status','temporaryAccessAllowed','isIPv4MappedAddress','cancelLoading','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','once','existsSync','args','notification','hashSync','catch','build2','deleted\x20Bot\x20','apiKey','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','padStart','lowdb','telegramEvents','getUTCHours','temporary\x20access\x20not\x20allowed','name','entries','/:bot/performance','botmanager','unlinkSync','http','user','hasOwnProperty','bots','Notifications\x20disabled\x0a','version','kill','restart','No\x20bots\x20running\x20right\x20now','login\x20not\x20required','2FA\x20login\x20rejected','isDirectory','getPortfolio','SIGINT','delete-bot','copyFileSync','constructor','forEach','1168293Ydeziz','set','search','ipaddr.js','Allow\x20login\x20from\x20IP\x20address\x20<b>','pidExpireLogin','loginRequired','135164OggxPZ','all','bot.js','Notifications\x20types:\x20','botID','36wkYZlN'];_0x2149=function(){return _0x5be2b5;};return _0x2149();}let bbpath=_0x10db24(0x115),bbpath2='';const botfile=_0x10db24(0xab),configfile='bb-config.json',settingsfile=_0x10db24(0x19c),securefile=_0x10db24(0xd6),validInstallation=fs[_0x10db24(0x7d)](_0x10db24(0x1b3));!fs['existsSync'](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x10db24(0x1b8)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x10db24(0x15a);!fs['existsSync'](configpath)&&fs[_0x10db24(0x18a)](configpath);!fs[_0x10db24(0x7d)](configbackuppath)&&fs[_0x10db24(0x18a)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x10db24(0xf9)]({'bots':[]})[_0x10db24(0xd1)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x10db24(0xf9)]({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x10db24(0xf9)]({'secure':{},'blacklist':[]})[_0x10db24(0xd1)]();let crypt=new Crypt({'md':_0x10db24(0x1b9),'rsaStandard':_0x10db24(0x1ad)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x10db24(0x15e))[_0x10db24(0x95)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x10db24(0x1ab)),app=express(),http=require(_0x10db24(0x90))[_0x10db24(0x1aa)](app);app[_0x10db24(0xd0)](express['static'](path['join'](__dirname,bbpath2,_0x10db24(0x82)))),app[_0x10db24(0xd0)](express[_0x10db24(0x114)](path[_0x10db24(0x144)](__dirname,bbpath2,_0x10db24(0xff)))),app[_0x10db24(0x184)]('/',function(_0x38e2a9,_0x9b70ec){const _0x36e118=_0x10db24;_0x9b70ec['sendFile'](path[_0x36e118(0x144)](__dirname,bbpath2,_0x36e118(0x82),_0x36e118(0xdc)));}),app['get']('/:bot',function(_0x342467,_0x7dc05d){const _0x20dd9f=_0x10db24;_0x7dc05d[_0x20dd9f(0x1b2)](path[_0x20dd9f(0x144)](__dirname,bbpath2,'build',_0x20dd9f(0xdc)));}),app['get']('/:bot/portfolio',(_0xfaba20,_0x192c21)=>{const _0x2f35af=_0x10db24;_0x192c21[_0x2f35af(0x1b2)](path['join'](__dirname,bbpath2,_0x2f35af(0xff),_0x2f35af(0xdc)));}),app[_0x10db24(0x184)](_0x10db24(0x8d),(_0x4094f1,_0x115a01)=>{const _0x2cec9b=_0x10db24;_0x115a01[_0x2cec9b(0x1b2)](path[_0x2cec9b(0x144)](__dirname,bbpath2,_0x2cec9b(0xff),_0x2cec9b(0xdc)));}),app[_0x10db24(0x184)]('/:bot/coins',(_0x344f36,_0x1f1b81)=>{const _0xfd4759=_0x10db24;_0x1f1b81['sendFile'](path[_0xfd4759(0x144)](__dirname,bbpath2,_0xfd4759(0xff),'index.html'));}),app['get'](_0x10db24(0x179),(_0x600f25,_0x329a01)=>{const _0x12e031=_0x10db24;_0x329a01[_0x12e031(0x1b2)](path[_0x12e031(0x144)](__dirname,bbpath2,_0x12e031(0xff),_0x12e031(0xdc)));}),app[_0x10db24(0x184)]('/:bot/configuration',(_0x2a7fc9,_0x41cfe3)=>{_0x41cfe3['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x10db24(0x18c),(_0x15f814,_0x53fe91)=>{const _0x149fff=_0x10db24;_0x53fe91[_0x149fff(0x1b2)](path[_0x149fff(0x144)](__dirname,bbpath2,_0x149fff(0xff),_0x149fff(0xdc)));});if(HOST)http[_0x10db24(0x166)](PORT,HOST);else http[_0x10db24(0x166)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x10db24(0xd9));let tgBot;if(settings[_0x10db24(0x120)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x10db24(0xc6)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x553a75=_0x10db24;console[_0x553a75(0x130)](''),console[_0x553a75(0x130)]('-----------------------------------------------------------------------------------'),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console['log'](_0x553a75(0x12d));if(config[_0x553a75(0x1bb)]!=0x0)config[_0x553a75(0xa1)](_0x2aac0a=>{const _0x2081ed=_0x553a75;if(_0x2aac0a[_0x2081ed(0x1c1)]==_0x2081ed(0x14c)||_0x2aac0a[_0x2081ed(0x1c1)]==_0x2081ed(0x105))logging(_0x2081ed(0x15c)+_0x2aac0a['botID']+_0x2081ed(0x124)+_0x2aac0a[_0x2081ed(0x168)]),startBot([_0x2aac0a[_0x2081ed(0xad)],userID],{'cwd':bbpath},function(_0x479a61){if(_0x479a61)logging(_0x479a61);});else(_0x2aac0a[_0x2081ed(0x1c1)]==_0x2081ed(0x162)||_0x2aac0a[_0x2081ed(0x1c1)]==_0x2081ed(0x116))&&logging(_0x2081ed(0x150)+_0x2aac0a[_0x2081ed(0xad)]+_0x2081ed(0x124)+_0x2aac0a[_0x2081ed(0x168)]);});else!newBot&&console[_0x553a75(0x130)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x553a75(0x130)](_0x553a75(0x12d)),console[_0x553a75(0x130)]('');}function startSocket(){const _0x4a1cb8=_0x10db24;io['on'](_0x4a1cb8(0x199),_0x463a8e=>{const _0x5eff27=_0x4a1cb8;let _0x13fa27,_0x319014,_0x5cab87,_0x220e76,_0x866046;const _0x492009=_0x463a8e['handshake']['headers'][_0x5eff27(0xc1)];_0x319014=_0x492009[_0x5eff27(0x1ae)](/bot[0-9]{3}/);if(_0x319014)_0x5cab87=_0x319014[0x0][_0x5eff27(0x1ae)](/[0-9]{3}/);if(_0x5cab87)_0x13fa27=_0x5cab87[0x0];else _0x13fa27=_0x5eff27(0x8e);const _0x3dfd34=_0x463a8e[_0x5eff27(0x113)]['auth']['encryptedUuid'];if(!_0x3dfd34)_0x463a8e[_0x5eff27(0x103)](_0x5eff27(0x1c1),{'publicKey':secure[_0x5eff27(0x159)]});else{_0x220e76=timelyDecrypt(_0x3dfd34,![]);if(!_0x220e76)_0x463a8e['emit']('status',{'publicKey':secure['publicKey']});else{_0x866046=normalizeIP(_0x463a8e[_0x5eff27(0xe5)][_0x5eff27(0x181)])[_0x5eff27(0x148)];if(!devices[_0x220e76])devices[_0x220e76]={'uuid':_0x220e76,'access':{'token':null}};devices[_0x220e76]['ip']=_0x866046;const _0x3917a7=addClient(_0x463a8e['id'],_0x220e76,_0x13fa27);setAccess(_0x3917a7),_0x463a8e['on']('login',_0x3c193f=>{const _0x14d2fc=_0x5eff27,_0x4c3dc0=timelyDecrypt(_0x3c193f['password']);if(_0x4c3dc0){_0x3c193f={'username':_0x3c193f[_0x14d2fc(0xb2)],'password':_0x4c3dc0},devices[_0x220e76][_0x14d2fc(0xea)]=validateCredentials(_0x3c193f,_0x220e76);if(devices[_0x220e76][_0x14d2fc(0xea)][_0x14d2fc(0xee)]==![]&&devices[_0x220e76][_0x14d2fc(0xea)][_0x14d2fc(0xd2)]==_0x14d2fc(0x136))_0x463a8e[_0x14d2fc(0x103)](_0x14d2fc(0x1c1),{'access':devices[_0x220e76]['access']}),loginAccess2FA(_0x220e76,_0x866046);else{if(devices[_0x220e76][_0x14d2fc(0xea)][_0x14d2fc(0xee)]==![]&&devices[_0x220e76]['access']['reason']==_0x14d2fc(0xfa))_0x463a8e[_0x14d2fc(0x103)](_0x14d2fc(0x1c1),{'access':devices[_0x220e76][_0x14d2fc(0xea)]});else devices[_0x220e76]['access'][_0x14d2fc(0xee)]&&devices[_0x220e76][_0x14d2fc(0xea)]['reason']==_0x14d2fc(0xe0)&&(getClientsWithUuid(_0x220e76)[_0x14d2fc(0xa1)](_0x31e9d6=>{setAccess(_0x31e9d6);}),setTokenRefresh(_0x220e76),setSessionTimeout(_0x14d2fc(0x1bf),_0x220e76));}}else logging(_0x14d2fc(0x11e));}),_0x463a8e['on'](_0x5eff27(0x1a1),()=>{resetPassword();}),_0x463a8e['on'](_0x5eff27(0x13c),_0x2c7e4e=>{removeClient(_0x463a8e['id']);});}}});}function initClient(_0x38683b){const _0x5721ca=_0x10db24;if(_0x38683b!=_0x5721ca(0x8e)&&config[_0x5721ca(0x84)]!=''){if(pid[_0x38683b])pid[_0x38683b]['send']({'function':'initclient','args':null});}}function getSocket(_0x53765){const _0x1b1317=_0x10db24;return io['sockets'][_0x1b1317(0x1b1)]['get'](_0x53765);}function setAccess(_0x2b2920){const _0x5dbf4e=_0x10db24,_0x5cca0d=getSocket(_0x2b2920['id']),_0x4b397f=_0x2b2920[_0x5dbf4e(0xfb)],_0x3537f8=_0x2b2920[_0x5dbf4e(0x14f)];devices[_0x4b397f]['access']=validateAccess(devices[_0x4b397f]['access'][_0x5dbf4e(0xd5)],_0x4b397f),_0x5cca0d[_0x5dbf4e(0x144)](_0x4b397f);if(devices[_0x4b397f]['access'][_0x5dbf4e(0xee)]){_0x5cca0d[_0x5dbf4e(0x144)](_0x3537f8);if(_0x3537f8=='botmanager')initializeSocketBotManager(_0x5cca0d);else initializeSocketBot(_0x5cca0d);initClient(_0x3537f8);}devices[_0x4b397f]['access'][_0x5dbf4e(0xd5)]&&devices[_0x4b397f][_0x5dbf4e(0xea)][_0x5dbf4e(0xd2)]=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x4b397f),devices[_0x4b397f]['access']['token']&&devices[_0x4b397f][_0x5dbf4e(0xea)]['reason']==_0x5dbf4e(0x149)&&setSessionTimeout(_0x5dbf4e(0x1bf),_0x4b397f),_0x5cca0d[_0x5dbf4e(0x103)](_0x5dbf4e(0x1c1),{'status':_0x2b2920[_0x5dbf4e(0xda)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4b397f][_0x5dbf4e(0xea)],'externalip':devices[_0x4b397f]['ip'],'publicKey':secure[_0x5dbf4e(0x159)],'validInstallation':validInstallation}),devices[_0x4b397f][_0x5dbf4e(0xea)]['allow']==![]&&devices[_0x4b397f]['access']['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x4b397f,devices[_0x4b397f]['ip']);}function setSessionTimeout(_0x3c95f2,_0xf52458){const _0x53939b=_0x10db24;let _0x509f0c;if(_0x3c95f2==_0x53939b(0x1bf))_0x509f0c=loginExpiry*0x3c*0x3e8;else _0x509f0c=devices[_0xf52458][_0x53939b(0xce)][_0x53939b(0x13e)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0xf52458]['telegramIpApproval'][_0x53939b(0xf7)]);if(devices[_0xf52458][_0x53939b(0xa7)])clearTimeout(devices[_0xf52458][_0x53939b(0xa7)]);devices[_0xf52458][_0x53939b(0xa7)]=setTimeout(()=>{const _0x5d5917=_0x53939b;if(devices[_0xf52458][_0x5d5917(0xba)])clearTimeout(devices[_0xf52458]['pidRefreshToken']);removeSocketListeners(_0xf52458),addBlacklist(_0xf52458),devices[_0xf52458][_0x5d5917(0xce)]=null,devices[_0xf52458]['telegram2FaApproval']=null,devices[_0xf52458]['access'][_0x5d5917(0xd5)]=null,devices[_0xf52458][_0x5d5917(0xea)]=validateAccess(devices[_0xf52458]['access'][_0x5d5917(0xd5)],_0xf52458),!(devices[_0xf52458][_0x5d5917(0xea)]['allow']&&devices[_0xf52458]['access']['reason']=='login\x20not\x20required')&&(_0x3c95f2==_0x5d5917(0x1bf)?io['to'](_0xf52458)[_0x5d5917(0x103)]('status',{'access':{'allow':![],'reason':_0x5d5917(0x134),'token':null}}):io['to'](_0xf52458)['emit'](_0x5d5917(0x1c1),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0xf52458]['access'][_0x5d5917(0xd5)]=null;},_0x509f0c);}function setTokenRefresh(_0x4185a0){const _0x5f4732=_0x10db24;if(devices[_0x4185a0][_0x5f4732(0xba)])clearTimeout(devices[_0x4185a0][_0x5f4732(0xba)]);devices[_0x4185a0][_0x5f4732(0xba)]=setTimeout(()=>{const _0xe487ce=_0x5f4732;getClientsWithUuid(_0x4185a0)[_0xe487ce(0x1bb)]!=0x0?(devices[_0x4185a0][_0xe487ce(0xea)]=refreshToken(_0x4185a0),io['to'](_0x4185a0)[_0xe487ce(0x103)](_0xe487ce(0x1c1),{'status':_0xe487ce(0x14b),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4185a0][_0xe487ce(0xea)],'externalip':devices[_0x4185a0]['ip'],'publicKey':secure[_0xe487ce(0x159)],'validInstallation':validInstallation}),setTokenRefresh(_0x4185a0)):clearTimeout(devices[_0x4185a0][_0xe487ce(0xba)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1a7089){const _0x232af3=_0x10db24,_0x3b3f0f=getClient(_0x1a7089['id'])[_0x232af3(0xfb)];_0x1a7089[_0x232af3(0x103)](_0x232af3(0x93),config),_0x1a7089['emit'](_0x232af3(0x127),cleanSettings()),_0x1a7089['on'](_0x232af3(0xed),_0x5b5d69=>{const _0xa0fc44=_0x232af3;if(validateAccess(_0x5b5d69,_0x3b3f0f)[_0xa0fc44(0xee)])addBot();else logging(_0xa0fc44(0xcf));}),_0x1a7089['on'](_0x232af3(0x17f),(_0x3c7fb6,_0x12659f)=>{const _0x41fbde=_0x232af3;if(validateAccess(_0x12659f,_0x3b3f0f)[_0x41fbde(0xee)])toggleBot(_0x3c7fb6[_0x41fbde(0xad)],_0x3c7fb6['status'],_0x3c7fb6[_0x41fbde(0x171)]);else logging(_0x41fbde(0x1bd));}),_0x1a7089['on'](_0x232af3(0x9e),(_0xa2ff09,_0x1f0522)=>{const _0x443969=_0x232af3;if(validateAccess(_0x1f0522,_0x3b3f0f)[_0x443969(0xee)])deleteBot(_0xa2ff09);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1a7089['on']('store-settings',(_0x144410,_0x19d594)=>{const _0x40b66a=_0x232af3;if(validateAccess(_0x19d594,_0x3b3f0f)['allow'])storeSettings(_0x144410,!![]);else logging(_0x40b66a(0x19b));}),_0x1a7089['on'](_0x232af3(0x123),(_0x39d4bd,_0x496e1d)=>{const _0x491df8=_0x232af3;if(validateAccess(_0x496e1d,_0x3b3f0f)['allow'])updateBB();else logging(_0x491df8(0x19b));}),_0x1a7089['on'](_0x232af3(0x110),_0x1f5bd8=>{const _0xe7d9fb=_0x232af3;if(validateAccess(_0x1f5bd8,_0x3b3f0f)[_0xe7d9fb(0xee)]){if(devices[_0x3b3f0f]['pidRefreshToken'])clearTimeout(devices[_0x3b3f0f]['pidRefreshToken']);if(devices[_0x3b3f0f][_0xe7d9fb(0xa7)])clearTimeout(devices[_0x3b3f0f][_0xe7d9fb(0xa7)]);removeSocketListeners(getClient(_0x1a7089['id'])[_0xe7d9fb(0xfb)]),addBlacklist(_0x3b3f0f),devices[_0x3b3f0f][_0xe7d9fb(0xce)]=null,devices[_0x3b3f0f]['telegram2FaApproval']=null,devices[_0x3b3f0f][_0xe7d9fb(0xea)][_0xe7d9fb(0xd5)]=null,io['to'](getClient(_0x1a7089['id'])[_0xe7d9fb(0xfb)])[_0xe7d9fb(0x103)](_0xe7d9fb(0x1c1),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0xe7d9fb(0xde));});}function initializeSocketBot(_0x5a94aa){const _0x360f28=_0x10db24,_0x2495fd=getClient(_0x5a94aa['id'])[_0x360f28(0x14f)],_0x20d084=getClient(_0x5a94aa['id'])[_0x360f28(0xfb)];_0x5a94aa['on'](_0x360f28(0x165),(_0x4098fa,_0x3b100d)=>{const _0x36043f=_0x360f28;if(validateAccess(_0x3b100d,_0x20d084)[_0x36043f(0xee)]){if(pid[_0x2495fd])pid[_0x2495fd]['send']({'function':_0x36043f(0x17c),'args':_0x4098fa});}else logging(_0x36043f(0xb0));}),_0x5a94aa['on'](_0x360f28(0xc0),(_0x26f86e,_0x3a4fdc)=>{const _0x508fbf=_0x360f28;if(validateAccess(_0x3a4fdc,_0x20d084)[_0x508fbf(0xee)]){if(pid[_0x2495fd])pid[_0x2495fd]['send']({'function':_0x508fbf(0x158),'args':_0x26f86e});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5a94aa['on'](_0x360f28(0x191),(_0x317e3e,_0x392db1)=>{const _0x5035e1=_0x360f28;if(validateAccess(_0x392db1,_0x20d084)[_0x5035e1(0xee)]){if(pid[_0x2495fd])pid[_0x2495fd][_0x5035e1(0x11b)]({'function':_0x5035e1(0x9c),'args':_0x317e3e});}else logging(_0x5035e1(0x1b7));}),_0x5a94aa['on'](_0x360f28(0x1a3),(_0x922336,_0x2dd741)=>{const _0x4e8ad4=_0x360f28;if(validateAccess(_0x2dd741,_0x20d084)['allow']){if(pid[_0x2495fd])pid[_0x2495fd][_0x4e8ad4(0x11b)]({'function':_0x4e8ad4(0x192),'args':_0x922336});}else logging(_0x4e8ad4(0x125));}),_0x5a94aa['on'](_0x360f28(0x104),(_0x3c051a,_0x219a87)=>{const _0x1d2ecc=_0x360f28;if(validateAccess(_0x219a87,_0x20d084)['allow']){if(pid[_0x2495fd])pid[_0x2495fd][_0x1d2ecc(0x11b)]({'function':_0x1d2ecc(0x185),'args':_0x3c051a});}else logging(_0x1d2ecc(0x1a5));}),_0x5a94aa['on'](_0x360f28(0x12f),_0xba22d2=>{const _0x1e73ef=_0x360f28;if(validateAccess(_0xba22d2,_0x20d084)[_0x1e73ef(0xee)]){if(pid[_0x2495fd])pid[_0x2495fd][_0x1e73ef(0x11b)]({'function':_0x1e73ef(0xf5),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x5a94aa['on'](_0x360f28(0x12e),(_0xb18e02,_0x5018f2)=>{const _0x57551f=_0x360f28;if(validateAccess(_0x5018f2,_0x20d084)[_0x57551f(0xee)]){if(pid[_0x2495fd])pid[_0x2495fd][_0x57551f(0x11b)]({'function':'placeOrder','args':_0xb18e02});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5a94aa['on'](_0x360f28(0x13b),_0x298a02=>{const _0x1da112=_0x360f28;if(validateAccess(_0x298a02,_0x20d084)[_0x1da112(0xee)]){if(pid[_0x2495fd])pid[_0x2495fd]['send']({'function':_0x1da112(0x7a),'args':null});}else logging(_0x1da112(0x135));}),_0x5a94aa['on']('logout',_0xd45ee5=>{const _0x306966=_0x360f28;if(validateAccess(_0xd45ee5,_0x20d084)[_0x306966(0xee)]){if(devices[_0x20d084][_0x306966(0xba)])clearTimeout(devices[_0x20d084][_0x306966(0xba)]);if(devices[_0x20d084][_0x306966(0xa7)])clearTimeout(devices[_0x20d084][_0x306966(0xa7)]);removeSocketListeners(getClient(_0x5a94aa['id'])[_0x306966(0xfb)]),addBlacklist(_0x20d084),devices[_0x20d084][_0x306966(0xce)]=null,devices[_0x20d084][_0x306966(0xcd)]=null,devices[_0x20d084][_0x306966(0xea)][_0x306966(0xd5)]=null,io['to'](getClient(_0x5a94aa['id'])[_0x306966(0xfb)])['emit'](_0x306966(0x1c1),{'access':{'allow':![],'reason':_0x306966(0x13d),'token':null}});}else logging(_0x306966(0xde));});}function removeSocketListeners(_0x4140a2){getClientsWithUuid(_0x4140a2)['forEach'](_0x52c582=>{getSocket(_0x52c582['id'])['removeAllListeners']();});}function cleanSettings(){const _0x8ae6b=_0x10db24;let _0x1a451f=settings;return settings[_0x8ae6b(0x120)]&&settings[_0x8ae6b(0x120)]!=''&&(_0x1a451f={..._0x1a451f,'telegramToken':_0x8ae6b(0xe3)}),settings[_0x8ae6b(0x16e)]&&settings[_0x8ae6b(0x16e)]!=''&&(_0x1a451f={..._0x1a451f,'bbPassword':_0x8ae6b(0xe3)}),_0x1a451f;}function updateBB(){const _0x2b0a18=_0x10db24;installingUpdate=!![],config[_0x2b0a18(0xa1)](_0x100620=>{const _0x17f3be=_0x2b0a18;restartBot(_0x100620[_0x17f3be(0xad)]);}),process['send']({'update':!![]},_0x2d83b4=>{});}function startBot(_0x4235e7,_0x49e037,_0x429be6){const _0xed5514=_0x10db24;let _0x30fed4=![];const _0x246d9=_0x4235e7[0x0];_0x49e037={..._0x49e037,'stdio':[_0xed5514(0x178),_0xed5514(0x178),_0xed5514(0x178),_0xed5514(0xe8)]},pid[_0x246d9]=childProcess[_0xed5514(0x19e)](botfile,_0x4235e7,_0x49e037),pid[_0x246d9]['on'](_0xed5514(0x180),_0x2d2f86=>{const _0x48bed8=_0xed5514;switch(Object[_0x48bed8(0xbb)](_0x2d2f86)[0x0]){case _0x48bed8(0x168):updateBotName(_0x246d9,_0x2d2f86[_0x48bed8(0x168)]);break;case'status':updateStatus(_0x246d9,_0x2d2f86[_0x48bed8(0x1c1)]);break;case'live':updateLive(_0x246d9,_0x2d2f86['live']);break;case _0x48bed8(0x167):updateLive(_0x246d9,_0x2d2f86[_0x48bed8(0x167)]),io['to'](_0x246d9)[_0x48bed8(0x103)](_0x48bed8(0x1c1),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x48bed8(0xca):_0x2d2f86[_0x48bed8(0xca)]==_0x48bed8(0x97)&&restartBot(_0x246d9);_0x2d2f86[_0x48bed8(0xca)]=='kill'&&toggleBot(_0x246d9,_0x48bed8(0x162),_0x48bed8(0x142));break;case _0x48bed8(0x13a):sendTelegram(_0x246d9,_0x2d2f86[_0x48bed8(0x13a)]);break;case _0x48bed8(0x19d):io['to'](_0x246d9)['emit'](_0x2d2f86['function'],_0x2d2f86[_0x48bed8(0x7e)]);break;}}),pid[_0x246d9]['on'](_0xed5514(0x15b),function(_0x8780fd){if(_0x30fed4)return;_0x30fed4=!![],_0x429be6(_0x8780fd);}),pid[_0x246d9]['on'](_0xed5514(0x186),function(_0x2538b6){const _0xfc0af7=_0xed5514;if(installingUpdate)return;if(_0x30fed4)return;_0x30fed4=!![],_0x429be6(null);const _0x4954a8=dbConfig['get'](_0xfc0af7(0x93))[_0xfc0af7(0xf6)]({'botID':_0x246d9})[_0xfc0af7(0x109)]();_0x4954a8&&(_0x4954a8[_0xfc0af7(0x1c1)]=='enabled'||_0x4954a8[_0xfc0af7(0x1c1)]==_0xfc0af7(0x105))&&(updateLive(_0x246d9,_0xfc0af7(0x142)),logging('restarting\x20Bot\x20'+_0x246d9),startBot([_0x246d9,userID],{'cwd':bbpath},function(_0x4468f6){if(_0x4468f6)logging(_0x4468f6);}));});}function stopBot(_0x586a4d){const _0x7d8dc0=_0x10db24;getClientsWithBotID(_0x586a4d)[_0x7d8dc0(0xa1)](_0x384442=>{const _0x25034f=_0x7d8dc0;getSocket(_0x384442['id'])[_0x25034f(0x13c)](!![]),removeClient(_0x384442['id']);});if(pid[_0x586a4d])pid[_0x586a4d][_0x7d8dc0(0x96)]();}function restartBot(_0x4e84a9){const _0x2aab46=_0x10db24;if(pid[_0x4e84a9])pid[_0x4e84a9][_0x2aab46(0x96)]();}function addBot(){const _0x4160fb=_0x10db24;let _0x28381b;for(let _0x28cc3c=0x1;_0x28cc3c<0x3e9;_0x28cc3c++){_0x28381b=_0x28cc3c[_0x4160fb(0x11d)]()['padStart'](0x3,'0');let _0x2f6956=config['find'](_0x1fca44=>_0x1fca44[_0x4160fb(0xad)]==_0x28381b);if(!_0x2f6956)break;}if(_0x28381b===_0x4160fb(0x18f)){logging(_0x4160fb(0xcc));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x28381b),dbConfig[_0x4160fb(0x184)](_0x4160fb(0x93))[_0x4160fb(0x183)]({'botID':_0x28381b,'botname':_0x4160fb(0x18b)+_0x28381b,'status':_0x4160fb(0x105),'live':''})[_0x4160fb(0xd1)](),startBot([_0x28381b,userID],{'cwd':bbpath},function(_0x256e78){if(_0x256e78)logging(_0x256e78);}),config=getConfiguration(),io['to'](_0x4160fb(0x8e))[_0x4160fb(0x103)](_0x4160fb(0x93),config);}function deleteBot(_0x2a2d23){const _0x54ca23=_0x10db24;getClientsWithBotID(_0x2a2d23)[_0x54ca23(0xa1)](_0x41880c=>{const _0x4a4ebc=_0x54ca23;getSocket(_0x41880c['id'])[_0x4a4ebc(0x13c)](!![]),removeClient(_0x41880c['id']);}),dbConfig[_0x54ca23(0x184)]('bots')['remove']({'botID':_0x2a2d23})[_0x54ca23(0xd1)](),logging(_0x54ca23(0x83)+_0x2a2d23),stopBot(_0x2a2d23);try{fs['unlinkSync'](path[_0x54ca23(0x144)](configpath,_0x54ca23(0x16f)+_0x2a2d23+'-config.json')),fs[_0x54ca23(0x8f)](path[_0x54ca23(0x144)](configpath,_0x54ca23(0x16f)+_0x2a2d23+_0x54ca23(0x182))),fs[_0x54ca23(0x8f)](path[_0x54ca23(0x144)](configpath,'bot-'+_0x2a2d23+_0x54ca23(0xc5))),fs[_0x54ca23(0x8f)](path[_0x54ca23(0x144)](configpath,_0x54ca23(0x16f)+_0x2a2d23+'-results.json'));}catch(_0x798176){if(_0x798176)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x798176);}config=getConfiguration(),io['to'](_0x54ca23(0x8e))[_0x54ca23(0x103)](_0x54ca23(0x93),config);}function toggleBot(_0x478aef,_0x4d271d,_0xfca19e){const _0x1e311c=_0x10db24;dbConfig[_0x1e311c(0x184)](_0x1e311c(0x93))[_0x1e311c(0xf6)]({'botID':_0x478aef})[_0x1e311c(0x118)]({'status':_0x4d271d})[_0x1e311c(0x118)]({'live':_0xfca19e})[_0x1e311c(0xd1)]();if(_0x4d271d=='enabled'||_0x4d271d==_0x1e311c(0x105))logging(_0x1e311c(0xdb)+_0x478aef),startBot([_0x478aef,userID],{'cwd':bbpath},function(_0x580897){if(_0x580897)logging(_0x580897);});else(_0x4d271d==_0x1e311c(0x162)||_0x4d271d==_0x1e311c(0x116))&&(logging(_0x1e311c(0x1a2)+_0x478aef),stopBot(_0x478aef));config=getConfiguration(),io['to'](_0x1e311c(0x8e))['emit']('bots',config);}function toggleStatus(_0x48285f){const _0x4f68e4=_0x10db24;let _0x59b87d=dbConfig[_0x4f68e4(0x184)]('bots')[_0x4f68e4(0xf6)]({'botID':_0x48285f})[_0x4f68e4(0x109)](),_0xdc6b61;if(_0x59b87d[_0x4f68e4(0x1c1)]===_0x4f68e4(0x14c))_0xdc6b61='disabled';else{if(_0x59b87d['status']===_0x4f68e4(0x105))_0xdc6b61=_0x4f68e4(0x116);else{if(_0x59b87d[_0x4f68e4(0x1c1)]==='new-disabled')_0xdc6b61=_0x4f68e4(0x105);else{if(_0x59b87d[_0x4f68e4(0x1c1)]===_0x4f68e4(0x162))_0xdc6b61=_0x4f68e4(0x14c);}}}return _0xdc6b61;}function updateStatus(_0x35965e,_0xc36f2c){const _0x15013f=_0x10db24;dbConfig[_0x15013f(0x184)](_0x15013f(0x93))[_0x15013f(0xf6)]({'botID':_0x35965e})['assign']({'status':_0xc36f2c})['write'](),config=getConfiguration(),io['to'](_0x15013f(0x8e))['emit'](_0x15013f(0x93),config);}function updateLive(_0x5f1b4e,_0x357000){const _0x327e89=_0x10db24;dbConfig[_0x327e89(0x184)](_0x327e89(0x93))[_0x327e89(0xf6)]({'botID':_0x5f1b4e})[_0x327e89(0x118)]({'live':_0x357000})[_0x327e89(0xd1)](),config=getConfiguration(),io['to'](_0x327e89(0x8e))[_0x327e89(0x103)](_0x327e89(0x93),config);}function updateBotName(_0x538f3d,_0x610c94){const _0x2001d0=_0x10db24;dbConfig['get'](_0x2001d0(0x93))[_0x2001d0(0xf6)]({'botID':_0x538f3d})[_0x2001d0(0x118)]({'botname':_0x610c94})[_0x2001d0(0xd1)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x2001d0(0x93),config);}function telegramError(_0x25ef0f){const _0x4ae42c=_0x10db24;console[_0x4ae42c(0x130)](getTimeStamp()+_0x4ae42c(0x177));}function validateTelegram(_0x4ed0df){const _0x46c59c=_0x10db24;if(_0x4ed0df[_0x46c59c(0x14a)]['username']!=settings[_0x46c59c(0xc6)]&&'@'+_0x4ed0df[_0x46c59c(0x14a)]['username']!=settings['telegramUsername'])return tgBot[_0x46c59c(0x194)](_0x4ed0df[_0x46c59c(0x102)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x46c59c(0x1a7)})[_0x46c59c(0x81)](_0x4efa6d=>{telegramError(_0x4efa6d);}),![];return!![];}async function initTelegram(){const _0x1807a9=_0x10db24;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1807a9(0x120)],{'polling':!![]});let _0x470913=_0x1807a9(0xd4);_0x470913+='\x0a',_0x470913+='/enable\x20-\x20enable\x20notifications\x0a',_0x470913+=_0x1807a9(0xfc),_0x470913+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x470913+=_0x1807a9(0xc9),_0x470913+=_0x1807a9(0xb4),_0x470913+='/off\x20-\x20stop\x20bot(s)\x0a',_0x470913+=_0x1807a9(0x101),_0x470913+=_0x1807a9(0x1a0);let _0x1d18af=_0x1807a9(0x15d);_0x1d18af+='\x0a',_0x1d18af+=_0x470913,tgBot['onText'](/\/start/,_0xa64a2=>{const _0x3ebb90=_0x1807a9;if(!validateTelegram(_0xa64a2))return;if(settings[_0x3ebb90(0x145)]!=_0xa64a2['chat']['id'])updateSetting(_0x3ebb90(0x145),_0xa64a2[_0x3ebb90(0x102)]['id']);updateSetting(_0x3ebb90(0x117),!![]),tgBot[_0x3ebb90(0x194)](_0xa64a2['chat']['id'],_0x1d18af)[_0x3ebb90(0x81)](_0x49f71c=>{telegramError(_0x49f71c);});}),tgBot['onText'](/\/enable/,_0x4e17e3=>{const _0x48d42f=_0x1807a9;if(!validateTelegram(_0x4e17e3))return;if(settings[_0x48d42f(0x145)]!=_0x4e17e3[_0x48d42f(0x102)]['id'])updateSetting(_0x48d42f(0x145),_0x4e17e3[_0x48d42f(0x102)]['id']);updateSetting(_0x48d42f(0x117),!![]),tgBot[_0x48d42f(0x194)](_0x4e17e3[_0x48d42f(0x102)]['id'],_0x48d42f(0x175))[_0x48d42f(0x81)](_0x355b42=>{telegramError(_0x355b42);});}),tgBot[_0x1807a9(0x11c)](/\/config/,async _0x1dcce5=>{const _0x147ead=_0x1807a9;if(!validateTelegram(_0x1dcce5))return;tgBot[_0x147ead(0x187)](_0x147ead(0x126)),tgBot[_0x147ead(0x194)](_0x1dcce5[_0x147ead(0x102)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x147ead(0x153),'callback_data':_0x147ead(0xdd)},{'text':_0x147ead(0x1ba),'callback_data':_0x147ead(0x1b6)},{'text':_0x147ead(0x111),'callback_data':_0x147ead(0xaa)}]]}})[_0x147ead(0x81)](_0x43daf3=>{telegramError(_0x43daf3);}),tgBot['on']('callback_query',async _0x51872f=>{const _0x38ec8c=_0x147ead,_0x296226=_0x51872f['data'],_0x2a56b9=_0x51872f['message'];tgBot[_0x38ec8c(0xf8)](_0x51872f['id'])['then'](async()=>{const _0x39300a=_0x38ec8c;_0x296226==_0x39300a(0xdd)&&(updateSetting(_0x39300a(0x88),_0x39300a(0xdd)),updateSetting('telegramEnabled',!![]),await tgBot[_0x39300a(0x194)](_0x2a56b9[_0x39300a(0x102)]['id'],_0x39300a(0x17b))[_0x39300a(0x81)](_0x4e1744=>{telegramError(_0x4e1744);}));_0x296226==_0x39300a(0x1b6)&&(updateSetting(_0x39300a(0x88),_0x39300a(0x1b6)),updateSetting('telegramEnabled',!![]),await tgBot[_0x39300a(0x194)](_0x2a56b9['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x39300a(0x81)](_0x3f1fe4=>{telegramError(_0x3f1fe4);}));_0x296226==_0x39300a(0xaa)&&(updateSetting(_0x39300a(0x88),_0x39300a(0xaa)),updateSetting(_0x39300a(0x117),!![]),await tgBot[_0x39300a(0x194)](_0x2a56b9[_0x39300a(0x102)]['id'],_0x39300a(0x1be))['catch'](_0x1e51d1=>{telegramError(_0x1e51d1);}));if(!settings[_0x39300a(0x145)])tgBot[_0x39300a(0x194)](_0x2a56b9[_0x39300a(0x102)]['id'],_0x39300a(0x85))[_0x39300a(0x81)](_0x504a58=>{telegramError(_0x504a58);});}),tgBot['removeListener'](_0x38ec8c(0x126));});}),tgBot[_0x1807a9(0x11c)](/\/status/,_0xf19fd=>{const _0x4c055e=_0x1807a9;if(!validateTelegram(_0xf19fd))return;let _0x122560=_0x4c055e(0xe1);config[_0x4c055e(0xa1)](_0x256e70=>{const _0x41a599=_0x4c055e;_0x122560+=_0x41a599(0x18b)+_0x256e70[_0x41a599(0xad)]+'\x20|\x20'+_0x256e70['botname']+':\x20'+_0x256e70[_0x41a599(0x1c1)]+_0x41a599(0x16b)+_0x256e70[_0x41a599(0x171)]+'\x0a';}),_0x122560+='\x0a',_0x122560+=_0x4c055e(0x139),_0x122560+=!settings['telegramEnabled']?_0x4c055e(0x94):_0x4c055e(0x14d),_0x122560+=settings[_0x4c055e(0x117)]?settings[_0x4c055e(0x88)]==_0x4c055e(0xaa)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x4c055e(0xac)+settings[_0x4c055e(0x88)]+_0x4c055e(0x1a6):'',tgBot[_0x4c055e(0x194)](_0xf19fd[_0x4c055e(0x102)]['id'],_0x122560,{'parse_mode':_0x4c055e(0x1a7)})['catch'](_0x5a49c9=>{telegramError(_0x5a49c9);});}),tgBot[_0x1807a9(0x11c)](/\/restart/,_0xcff522=>{const _0x4b8bf3=_0x1807a9;if(!validateTelegram(_0xcff522))return;tgBot[_0x4b8bf3(0x187)](_0x4b8bf3(0x126));const _0x386c23=getEnabledBots();if(_0x386c23[_0x4b8bf3(0x1bb)]==0x0)tgBot[_0x4b8bf3(0x194)](_0xcff522[_0x4b8bf3(0x102)]['id'],_0x4b8bf3(0x98))[_0x4b8bf3(0x81)](_0x3a1fc5=>{telegramError(_0x3a1fc5);});else{if(_0x386c23[_0x4b8bf3(0x1bb)]>0x1)_0x386c23['push']({'botID':'all'});let _0x5cfb58=[],_0x4af3d0=[];const _0x5b83e5=_0x386c23[_0x4b8bf3(0x1bb)]%0x4==0x0||_0x386c23[_0x4b8bf3(0x1bb)]%0x4==0x3||_0x386c23[_0x4b8bf3(0x1bb)]%0x3==0x1?0x4:0x3;let _0x241fc4=0x0;_0x386c23[_0x4b8bf3(0xa1)]((_0x14f3dd,_0x48c700)=>{const _0x1abe35=_0x4b8bf3;if(_0x48c700%_0x5b83e5==0x0)_0x4af3d0=[];_0x4af3d0['push']({'text':_0x14f3dd['botID']==_0x1abe35(0xaa)?_0x1abe35(0x1bc):_0x1abe35(0x18b)+_0x14f3dd[_0x1abe35(0xad)],'callback_data':_0x14f3dd[_0x1abe35(0xad)]}),_0x48c700%_0x5b83e5==0x0&&(_0x5cfb58[_0x241fc4]=_0x4af3d0,_0x241fc4++);}),tgBot['sendMessage'](_0xcff522[_0x4b8bf3(0x102)]['id'],_0x4b8bf3(0x16c),{'reply_markup':{'inline_keyboard':_0x5cfb58}})['catch'](_0x1abb7d=>{telegramError(_0x1abb7d);}),tgBot['on']('callback_query',async _0x20f988=>{const _0x47b3fc=_0x4b8bf3,_0x2e7cbf=_0x20f988[_0x47b3fc(0xb6)],_0x47f7dd=_0x20f988[_0x47b3fc(0x180)];tgBot[_0x47b3fc(0xf8)](_0x20f988['id'])[_0x47b3fc(0xfe)](async()=>{const _0x4cae43=_0x47b3fc;if(_0x2e7cbf==_0x4cae43(0xaa)){if(settings[_0x4cae43(0x88)]=='orders')tgBot['sendMessage'](_0x47f7dd[_0x4cae43(0x102)]['id'],_0x4cae43(0x16d))['catch'](_0x494740=>{telegramError(_0x494740);});config['forEach'](_0xceeedd=>{const _0x45f8d4=_0x4cae43;restartBot(_0xceeedd[_0x45f8d4(0xad)]);});}else{if(settings['telegramEvents']=='orders')tgBot[_0x4cae43(0x194)](_0x47f7dd[_0x4cae43(0x102)]['id'],_0x4cae43(0xb8)+_0x2e7cbf)[_0x4cae43(0x81)](_0x3d19fe=>{telegramError(_0x3d19fe);});restartBot(_0x2e7cbf);}}),tgBot[_0x47b3fc(0x187)]('callback_query');});}}),tgBot[_0x1807a9(0x11c)](/\/on/,_0x1d9d27=>{const _0x584d56=_0x1807a9;if(!validateTelegram(_0x1d9d27))return;tgBot[_0x584d56(0x187)](_0x584d56(0x126));const _0x5344da=getDisabledBots();if(_0x5344da['length']==0x0)tgBot[_0x584d56(0x194)](_0x1d9d27[_0x584d56(0x102)]['id'],_0x584d56(0xf2))[_0x584d56(0x81)](_0x3e7b49=>{telegramError(_0x3e7b49);});else{if(_0x5344da[_0x584d56(0x1bb)]>0x1)_0x5344da[_0x584d56(0x183)]({'botID':_0x584d56(0xaa)});let _0x5a6e78=[],_0x1cb2fc=[];const _0x37ab52=_0x5344da['length']%0x4==0x0||_0x5344da[_0x584d56(0x1bb)]%0x4==0x3||_0x5344da[_0x584d56(0x1bb)]%0x3==0x1?0x4:0x3;let _0x2c1ec7=0x0;_0x5344da['forEach']((_0x1653c4,_0x30f5ce)=>{const _0x56c7c2=_0x584d56;if(_0x30f5ce%_0x37ab52==0x0)_0x1cb2fc=[];_0x1cb2fc[_0x56c7c2(0x183)]({'text':_0x1653c4[_0x56c7c2(0xad)]==_0x56c7c2(0xaa)?'All\x20bots':_0x56c7c2(0x18b)+_0x1653c4['botID'],'callback_data':_0x1653c4[_0x56c7c2(0xad)]}),_0x30f5ce%_0x37ab52==0x0&&(_0x5a6e78[_0x2c1ec7]=_0x1cb2fc,_0x2c1ec7++);}),tgBot[_0x584d56(0x194)](_0x1d9d27[_0x584d56(0x102)]['id'],_0x584d56(0x189),{'reply_markup':{'inline_keyboard':_0x5a6e78}})[_0x584d56(0x81)](_0x45500a=>{telegramError(_0x45500a);}),tgBot['on'](_0x584d56(0x126),async _0x39a417=>{const _0xc5187e=_0x584d56,_0x29b56f=_0x39a417[_0xc5187e(0xb6)],_0x382161=_0x39a417[_0xc5187e(0x180)];tgBot[_0xc5187e(0xf8)](_0x39a417['id'])[_0xc5187e(0xfe)](async()=>{const _0x295fde=_0xc5187e;if(_0x29b56f=='all'){if(settings[_0x295fde(0x88)]=='orders')tgBot[_0x295fde(0x194)](_0x382161[_0x295fde(0x102)]['id'],_0x295fde(0xc8))[_0x295fde(0x81)](_0x4771bb=>{telegramError(_0x4771bb);});_0x5344da[_0x295fde(0xa1)](_0x4ee1ba=>{const _0x241a32=_0x295fde;if(_0x4ee1ba[_0x241a32(0xad)]!=_0x241a32(0xaa))toggleBot(_0x4ee1ba['botID'],toggleStatus(_0x4ee1ba[_0x241a32(0xad)]),_0x241a32(0x142));});}else{if(settings['telegramEvents']==_0x295fde(0xdd))tgBot[_0x295fde(0x194)](_0x382161[_0x295fde(0x102)]['id'],_0x295fde(0x17d)+_0x29b56f)[_0x295fde(0x81)](_0x31901=>{telegramError(_0x31901);});toggleBot(_0x29b56f,toggleStatus(_0x29b56f),_0x295fde(0x142));}}),tgBot[_0xc5187e(0x187)](_0xc5187e(0x126));});}}),tgBot['onText'](/\/off/,_0x4dcc57=>{const _0x2a2f57=_0x1807a9;if(!validateTelegram(_0x4dcc57))return;tgBot[_0x2a2f57(0x187)](_0x2a2f57(0x126));const _0x2c90a2=getEnabledBots();if(_0x2c90a2[_0x2a2f57(0x1bb)]==0x0)tgBot[_0x2a2f57(0x194)](_0x4dcc57[_0x2a2f57(0x102)]['id'],_0x2a2f57(0x98))['catch'](_0x446770=>{telegramError(_0x446770);});else{if(_0x2c90a2[_0x2a2f57(0x1bb)]>0x1)_0x2c90a2['push']({'botID':'all'});let _0x23defb=[],_0x15746d=[];const _0x4de8f2=_0x2c90a2[_0x2a2f57(0x1bb)]%0x4==0x0||_0x2c90a2[_0x2a2f57(0x1bb)]%0x4==0x3||_0x2c90a2[_0x2a2f57(0x1bb)]%0x3==0x1?0x4:0x3;let _0x203705=0x0;_0x2c90a2[_0x2a2f57(0xa1)]((_0x4f3bd1,_0x122aa6)=>{const _0x54790c=_0x2a2f57;if(_0x122aa6%_0x4de8f2==0x0)_0x15746d=[];_0x15746d[_0x54790c(0x183)]({'text':_0x4f3bd1['botID']==_0x54790c(0xaa)?'All\x20bots':_0x54790c(0x18b)+_0x4f3bd1[_0x54790c(0xad)],'callback_data':_0x4f3bd1['botID']}),_0x122aa6%_0x4de8f2==0x0&&(_0x23defb[_0x203705]=_0x15746d,_0x203705++);}),tgBot[_0x2a2f57(0x194)](_0x4dcc57[_0x2a2f57(0x102)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x23defb}})[_0x2a2f57(0x81)](_0x37a8cb=>{telegramError(_0x37a8cb);}),tgBot['on'](_0x2a2f57(0x126),async _0x4287fa=>{const _0x3f0442=_0x2a2f57,_0x5a95b6=_0x4287fa[_0x3f0442(0xb6)],_0x51e514=_0x4287fa[_0x3f0442(0x180)];tgBot[_0x3f0442(0xf8)](_0x4287fa['id'])[_0x3f0442(0xfe)](async()=>{const _0x50ff4b=_0x3f0442;if(_0x5a95b6==_0x50ff4b(0xaa)){if(settings['telegramEvents']==_0x50ff4b(0xdd))tgBot[_0x50ff4b(0x194)](_0x51e514[_0x50ff4b(0x102)]['id'],_0x50ff4b(0x11f))['catch'](_0x3b1ae6=>{telegramError(_0x3b1ae6);});_0x2c90a2[_0x50ff4b(0xa1)](_0x463b72=>{const _0x1534d1=_0x50ff4b;if(_0x463b72['botID']!='all')toggleBot(_0x463b72[_0x1534d1(0xad)],toggleStatus(_0x463b72[_0x1534d1(0xad)]),_0x1534d1(0x142));});}else{if(settings[_0x50ff4b(0x88)]==_0x50ff4b(0xdd))tgBot[_0x50ff4b(0x194)](_0x51e514['chat']['id'],_0x50ff4b(0x7b)+_0x5a95b6)['catch'](_0xc6dd40=>{telegramError(_0xc6dd40);});toggleBot(_0x5a95b6,toggleStatus(_0x5a95b6),_0x50ff4b(0x142));}}),tgBot[_0x3f0442(0x187)]('callback_query');});}}),tgBot[_0x1807a9(0x11c)](/\/disable/,_0x7ec83d=>{const _0x42c1e=_0x1807a9;if(!validateTelegram(_0x7ec83d))return;tgBot['sendMessage'](_0x7ec83d[_0x42c1e(0x102)]['id'],_0x42c1e(0x11a))[_0x42c1e(0x81)](_0x4c01cd=>{telegramError(_0x4c01cd);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x156b38=>{const _0x21095a=_0x1807a9;if(!validateTelegram(_0x156b38))return;tgBot['sendMessage'](_0x156b38[_0x21095a(0x102)]['id'],_0x470913)['catch'](_0x126cf3=>{telegramError(_0x126cf3);});}),tgBot['on'](_0x1807a9(0x12a),_0x23ad37=>{const _0x329ba6=_0x1807a9;_0x23ad37[_0x329ba6(0x11d)]()[_0x329ba6(0x18d)](_0x329ba6(0x161))&&(logging(_0x329ba6(0x16a)),tgBot[_0x329ba6(0xaf)](),tgBot=null,io['to'](_0x329ba6(0x8e))[_0x329ba6(0x103)](_0x329ba6(0x7f),_0x329ba6(0x16a)));}),process['once'](_0x1807a9(0x9d),()=>{const _0x7d9cb3=_0x1807a9;if(tgBot)tgBot[_0x7d9cb3(0xaf)]();process[_0x7d9cb3(0x186)](0x1);}),process[_0x1807a9(0x7c)](_0x1807a9(0xb5),()=>{const _0x18b061=_0x1807a9;if(tgBot)tgBot[_0x18b061(0xaf)]();process[_0x18b061(0x186)](0x1);});}}function disableTelegram(){const _0xada8ef=_0x10db24;tgBot&&(tgBot[_0xada8ef(0xaf)](),tgBot=null);}function sendTelegram(_0x1e76d4,_0x134a6e){const _0x490a35=_0x10db24;if(settings[_0x490a35(0x117)]){if(settings[_0x490a35(0x88)]==_0x490a35(0xaa)||(_0x134a6e['type']==_0x490a35(0x15b)||_0x134a6e[_0x490a35(0xb1)]=='success')&&settings[_0x490a35(0x88)]==_0x490a35(0x1b6)||_0x134a6e[_0x490a35(0xb1)]==_0x490a35(0x108)&&settings[_0x490a35(0x88)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x134a6e[_0x490a35(0x119)])tgBot[_0x490a35(0x194)](settings[_0x490a35(0x145)],_0x134a6e['botname']+'\x20>\x20'+_0x134a6e[_0x490a35(0x141)])['catch'](_0x3397df=>{telegramError(_0x3397df);});else tgBot[_0x490a35(0x194)](settings[_0x490a35(0x145)],_0x490a35(0x18b)+_0x1e76d4+'\x20>\x20'+_0x134a6e[_0x490a35(0x141)])[_0x490a35(0x81)](_0x24ec7d=>{telegramError(_0x24ec7d);});}}}}function getDeviceWithIp(_0x8e929a){const _0x926b22=_0x10db24;return devices[_0x926b22(0xf6)](_0x3a8ada=>_0x3a8ada['ip']===_0x8e929a);}function temporaryAccess2FA(_0x18f6c6,_0x407463){const _0x81a172=_0x10db24;let _0x596e11=new Date(),_0x3a5512=![];if(lastIpApproval){if(_0x596e11-lastIpApproval<0x1388)_0x3a5512=!![];}lastIpApproval=new Date();if(_0x3a5512)return;tgBot&&settings[_0x81a172(0x145)]&&(tgBot[_0x81a172(0x187)](_0x81a172(0x126)),tgBot[_0x81a172(0x194)](settings[_0x81a172(0x145)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x407463)['show']+_0x81a172(0x163),{'parse_mode':_0x81a172(0x1a7),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x81a172(0x15f),'callback_data':'reject'}]]}})['catch'](_0x55e33b=>{telegramError(_0x55e33b);}),tgBot['on'](_0x81a172(0x126),async _0xfe99d1=>{const _0x2a571e=_0x81a172,_0xe4014d=_0xfe99d1[_0x2a571e(0xb6)],_0x2c7b28=_0xfe99d1[_0x2a571e(0x180)];tgBot['answerCallbackQuery'](_0xfe99d1['id'])[_0x2a571e(0xfe)](async()=>{const _0xdf4752=_0x2a571e;devices[_0x18f6c6][_0xdf4752(0xce)]={'clientip':_0x407463,'timestamp':new Date()['getTime'](),'expiry':_0xe4014d},_0xe4014d!=_0xdf4752(0x15f)?(await tgBot['sendMessage'](_0x2c7b28[_0xdf4752(0x102)]['id'],'Access\x20enabled\x20for\x20'+_0xe4014d+'\x20minutes',{'parse_mode':_0xdf4752(0x1a7)})[_0xdf4752(0x81)](_0x170e19=>{telegramError(_0x170e19);}),io['to'](_0x18f6c6)[_0xdf4752(0x103)](_0xdf4752(0x1c1),{'access':{'allow':![],'reason':_0xdf4752(0x12b),'token':null}})):(await tgBot[_0xdf4752(0x194)](_0x2c7b28[_0xdf4752(0x102)]['id'],'Temporary\x20access\x20rejected')[_0xdf4752(0x81)](_0x4540a8=>{telegramError(_0x4540a8);}),io['to'](_0x18f6c6)[_0xdf4752(0x103)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot['removeListener']('callback_query');}));}function _0x40a5(_0x1507ed,_0x2a27b0){const _0x13b28c=_0x2149();return _0x40a5=function(_0xbedb6a,_0x483a8e){_0xbedb6a=_0xbedb6a-0x7a;let _0x21494b=_0x13b28c[_0xbedb6a];return _0x21494b;},_0x40a5(_0x1507ed,_0x2a27b0);}function loginAccess2FA(_0x139f75,_0x3bcd06){const _0x366c7d=_0x10db24;tgBot&&settings[_0x366c7d(0x145)]&&(tgBot[_0x366c7d(0x187)](_0x366c7d(0x126)),tgBot['sendMessage'](settings[_0x366c7d(0x145)],_0x366c7d(0xa6)+normalizeIP(_0x3bcd06)[_0x366c7d(0xc7)]+_0x366c7d(0x163),{'parse_mode':_0x366c7d(0x1a7),'reply_markup':{'inline_keyboard':[[{'text':_0x366c7d(0x190),'callback_data':loginExpiry},{'text':_0x366c7d(0x15f),'callback_data':'reject'}]]}})['catch'](_0x31fcae=>{telegramError(_0x31fcae);}),tgBot['on'](_0x366c7d(0x126),async _0x42967f=>{const _0x38e991=_0x366c7d,_0x396404=_0x42967f[_0x38e991(0xb6)],_0x2c203c=_0x42967f[_0x38e991(0x180)];tgBot[_0x38e991(0xf8)](_0x42967f['id'])[_0x38e991(0xfe)](async()=>{const _0x383e44=_0x38e991;devices[_0x139f75][_0x383e44(0xcd)]={'clientip':_0x3bcd06,'timestamp':new Date()[_0x383e44(0x1ac)](),'expiry':_0x396404},_0x396404!=_0x383e44(0x15f)?(await tgBot[_0x383e44(0x194)](_0x2c203c[_0x383e44(0x102)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0x383e44(0x81)](_0x2d9918=>{telegramError(_0x2d9918);}),io['to'](_0x139f75)[_0x383e44(0x103)]('status',{'access':{'allow':![],'reason':_0x383e44(0x12b),'token':null}})):(await tgBot[_0x383e44(0x194)](_0x2c203c['chat']['id'],_0x383e44(0x173))['catch'](_0xb8735a=>{telegramError(_0xb8735a);}),io['to'](_0x139f75)[_0x383e44(0x103)](_0x383e44(0x1c1),{'access':{'allow':![],'reason':_0x383e44(0x9a),'token':null}}));}),tgBot[_0x38e991(0x187)](_0x38e991(0x126));}));}function getConfiguration(){const _0x509b64=_0x10db24;return dbConfig[_0x509b64(0x184)](_0x509b64(0x93))[_0x509b64(0xf3)](_0x509b64(0xad))[_0x509b64(0x109)]()||[];}function getEnabledBots(){const _0x11f739=_0x10db24;return dbConfig[_0x11f739(0x184)](_0x11f739(0x93))['sortBy'](_0x11f739(0xad))[_0x11f739(0x121)]({'status':'enabled'})[_0x11f739(0x109)]()||[];}function getDisabledBots(){const _0x1647e4=_0x10db24;return dbConfig[_0x1647e4(0x184)](_0x1647e4(0x93))[_0x1647e4(0xf3)](_0x1647e4(0xad))['filter']({'status':_0x1647e4(0x162)})['value']()||[];}function getSettings(){const _0xc23967=_0x10db24;return dbSettings[_0xc23967(0x184)](_0xc23967(0x127))[_0xc23967(0x109)]()||{'timeshift':0x0};}function getSecure(){const _0x4d9ce3=_0x10db24;return dbSecure[_0x4d9ce3(0x184)]('secure')['value']()||{};}function getBlacklist(){const _0x14a83e=_0x10db24;return dbSecure['get'](_0x14a83e(0x195))[_0x14a83e(0x109)]()||[];}function broadcastToBots(_0x450f4a,_0x337a7b){config['forEach'](_0x3d38fb=>{const _0x1bff9f=_0x40a5;if(_0x3d38fb[_0x1bff9f(0x1c1)]==_0x1bff9f(0x14c)&&_0x3d38fb[_0x1bff9f(0x171)]==_0x1bff9f(0x1b4)){if(pid[_0x3d38fb[_0x1bff9f(0xad)]])pid[_0x3d38fb['botID']][_0x1bff9f(0x11b)]({[_0x450f4a]:_0x337a7b});}});}function storeSettings(_0xa732b,_0x2c3203=![]){const _0x1ce0a2=_0x10db24;_0xa732b={...settings,..._0xa732b};if(_0x2c3203&&_0xa732b['bbPassword']!=_0x1ce0a2(0xe3)&&_0xa732b[_0x1ce0a2(0x16e)]!=''){const _0x5ee736=crypt[_0x1ce0a2(0xd8)](secure[_0x1ce0a2(0x18e)],_0xa732b[_0x1ce0a2(0x16e)])[_0x1ce0a2(0x180)][_0x1ce0a2(0x19a)]('@')[0x0],_0x1fc026=bcrypt[_0x1ce0a2(0x80)](_0x5ee736,saltRounds);_0xa732b={..._0xa732b,'bbPassword':_0x1fc026};}if(_0x2c3203&&_0xa732b[_0x1ce0a2(0x120)]!=_0x1ce0a2(0xe3)&&_0xa732b['telegramToken']!=''){const _0x4ccbde=crypt['decrypt'](secure[_0x1ce0a2(0x18e)],_0xa732b[_0x1ce0a2(0x120)])[_0x1ce0a2(0x180)][_0x1ce0a2(0x19a)]('@')[0x0];_0xa732b={..._0xa732b,'telegramToken':_0x4ccbde};}const _0xc85531=_0xa732b[_0x1ce0a2(0x120)]!=_0x1ce0a2(0xe3)&&_0xa732b['telegramToken']!=settings[_0x1ce0a2(0x120)]||_0xa732b['telegramUsername']!=settings[_0x1ce0a2(0xc6)],_0x4a7b6e=_0xa732b[_0x1ce0a2(0x120)]==''||_0xa732b[_0x1ce0a2(0xc6)]=='';if(_0xc85531)_0xa732b[_0x1ce0a2(0x88)]=_0x1ce0a2(0xaa);for(const [_0x1ff727,_0x3b84c6]of Object[_0x1ce0a2(0x8c)](_0xa732b)){if(_0x1ff727=='telegramToken'&&_0x3b84c6=='************'){_0xa732b[_0x1ce0a2(0x120)]=settings['telegramToken'];continue;};if(_0x1ff727==_0x1ce0a2(0x16e)&&_0x3b84c6==_0x1ce0a2(0xe3)){_0xa732b[_0x1ce0a2(0x16e)]=settings[_0x1ce0a2(0x16e)];continue;};dbSettings[_0x1ce0a2(0xa3)](_0x1ce0a2(0x10e)+_0x1ff727,_0x3b84c6)[_0x1ce0a2(0xd1)]();}settings=_0xa732b,io['to'](_0x1ce0a2(0x8e))['emit'](_0x1ce0a2(0x127),cleanSettings()),broadcastToBots(_0x1ce0a2(0x160),settings['timeshift']);if(_0xc85531&&!_0x4a7b6e)initTelegram();if(_0xc85531&&_0x4a7b6e)disableTelegram();getAllClients()[_0x1ce0a2(0xa1)](_0x46654d=>{const _0x3292b1=_0x1ce0a2;getSocket(_0x46654d['id'])[_0x3292b1(0x103)](_0x3292b1(0x1c1),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x15dce6,_0x5e3d4b){const _0x165648=_0x10db24;dbSettings[_0x165648(0xa3)](_0x165648(0x10e)+_0x15dce6,_0x5e3d4b)['write'](),settings=getSettings(),io['to']('botmanager')[_0x165648(0x103)](_0x165648(0x127),cleanSettings());}function storeSecure(_0x450888){const _0x35579d=_0x10db24;dbSecure[_0x35579d(0x184)](_0x35579d(0x156))['push'](_0x450888)[_0x35579d(0xd1)](),secure=_0x450888;}function addBlacklist(_0x555936){const _0x37e94f=_0x10db24;cleanBlacklist();let _0x3a160;devices[_0x555936][_0x37e94f(0xce)]?_0x3a160=Math[_0x37e94f(0xe9)](devices[_0x555936][_0x37e94f(0xce)]['expiry'],loginExpiry):_0x3a160=loginExpiry,dbSecure[_0x37e94f(0x184)](_0x37e94f(0x195))['push']({'expiry':new Date()['getTime']()+_0x3a160*0x3c*0x3e8,'token':devices[_0x555936][_0x37e94f(0xea)][_0x37e94f(0xd5)]})['write'](),blacklist=dbSecure[_0x37e94f(0x184)](_0x37e94f(0x195))[_0x37e94f(0x109)]();}function cleanBlacklist(){const _0x3663c4=_0x10db24;let _0x411509=dbSecure[_0x3663c4(0x184)](_0x3663c4(0x195))['cloneDeep']()[_0x3663c4(0x109)](),_0x5be462=new Date()['getTime']();_0x411509[_0x3663c4(0xa1)](_0x1e54fd=>{const _0x23727f=_0x3663c4;_0x1e54fd['expiry']<_0x5be462&&dbSecure[_0x23727f(0x184)](_0x23727f(0x195))[_0x23727f(0xe7)]({'expiry':_0x1e54fd[_0x23727f(0x13e)]})[_0x23727f(0xd1)]();});}function initStates(){const _0xcea34f=_0x10db24;let _0x994c35=getConfiguration();_0x994c35[_0xcea34f(0xa1)](_0x46f321=>{const _0x232d26=_0xcea34f;_0x46f321[_0x232d26(0x171)]='stopped';}),storeConfiguration(_0x994c35);}function onKeys(){const _0x309b23=new RSA();return new Promise(_0x65fe05=>{const _0x53afe7=_0x40a5;_0x309b23[_0x53afe7(0x143)]()[_0x53afe7(0xfe)](_0x13a4af=>{_0x65fe05(_0x13a4af);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1dbd71=_0x10db24;let _0x18d213=getConfiguration(),_0x264dcc=![];_0x18d213[_0x1dbd71(0xa1)](_0x1ed12d=>{const _0x221f51=_0x1dbd71;if(_0x1ed12d[_0x221f51(0x1c1)]==_0x221f51(0x1b4))_0x1ed12d[_0x221f51(0x1c1)]='enabled',_0x264dcc=!![];else _0x1ed12d[_0x221f51(0x1c1)]=='stopped'&&(_0x1ed12d[_0x221f51(0x1c1)]=_0x221f51(0x162),_0x264dcc=!![]);});if(_0x264dcc)storeConfiguration(_0x18d213);let _0x554bf4=getSecure();if(!_0x554bf4[_0x1dbd71(0x92)](_0x1dbd71(0xbd))){let _0x4893e2=await generateKeys();_0x554bf4['publicKey']=_0x4893e2[_0x1dbd71(0x159)],_0x554bf4['privateKey']=_0x4893e2[_0x1dbd71(0x18e)],_0x554bf4[_0x1dbd71(0xbd)]=crypto[_0x1dbd71(0x122)](0x20)['toString'](_0x1dbd71(0x107));;storeSecure(_0x554bf4);}let _0x4f3315=getSettings();_0x264dcc=![];!_0x4f3315[_0x1dbd71(0x92)](_0x1dbd71(0xa8))&&(_0x4f3315[_0x1dbd71(0xa8)]=![],_0x4f3315[_0x1dbd71(0xb9)]='',_0x4f3315[_0x1dbd71(0x16e)]='',_0x4f3315[_0x1dbd71(0xe2)]=![],_0x264dcc=!![]);!_0x4f3315[_0x1dbd71(0x92)](_0x1dbd71(0xc2))&&(_0x4f3315[_0x1dbd71(0xc2)]=![],_0x4f3315[_0x1dbd71(0x133)]=[],_0x4f3315[_0x1dbd71(0x1c2)]=![],_0x264dcc=!![]);if(!_0x4f3315[_0x1dbd71(0x92)]('telegramEnabled')){if(_0x4f3315[_0x1dbd71(0x145)])_0x4f3315[_0x1dbd71(0x117)]=!![];else _0x4f3315[_0x1dbd71(0x117)]=![];_0x264dcc=!![];}if(_0x264dcc)storeSettings(_0x4f3315);}function storeConfiguration(_0x34c860){const _0x221035=_0x10db24;dbConfig['get'](_0x221035(0x93))['remove']()['write'](),dbConfig[_0x221035(0x184)](_0x221035(0x93))[_0x221035(0x183)](..._0x34c860)['write'](),config=_0x34c860;}function resetPassword(){const _0xfee7fa=_0x10db24;tgBot&&settings[_0xfee7fa(0x145)]&&(tgBot['removeListener']('callback_query'),tgBot[_0xfee7fa(0x194)](settings['telegramChatId'],_0xfee7fa(0x129),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0xfee7fa(0xf4),'callback_data':_0xfee7fa(0xf4)},{'text':'no','callback_data':'no'}]]}})[_0xfee7fa(0x81)](_0x833ca=>{telegramError(_0x833ca);}),tgBot['on'](_0xfee7fa(0x126),async _0x5069fa=>{const _0x3ae6b9=_0xfee7fa,_0x3171a7=_0x5069fa[_0x3ae6b9(0xb6)],_0x38c856=_0x5069fa[_0x3ae6b9(0x180)];tgBot[_0x3ae6b9(0xf8)](_0x5069fa['id'])['then'](async()=>{const _0x361004=_0x3ae6b9;if(_0x3171a7!='no'){const _0x12d2d4=0xf,_0x2e6a4c=_0x361004(0xfd),_0x2b115e=Array[_0x361004(0x14a)](crypto[_0x361004(0x137)](new Uint32Array(_0x12d2d4)))[_0x361004(0x196)](_0x3d1938=>_0x2e6a4c[_0x3d1938%_0x2e6a4c[_0x361004(0x1bb)]])['join'](''),_0x2bcb7d=bcrypt[_0x361004(0x80)](_0x2b115e,saltRounds);storeSettings({'bbPassword':_0x2bcb7d}),await tgBot[_0x361004(0x194)](_0x38c856['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x2b115e,{'parse_mode':_0x361004(0x1a7)})[_0x361004(0x81)](_0x207a96=>{telegramError(_0x207a96);});}else await tgBot['sendMessage'](_0x38c856[_0x361004(0x102)]['id'],'Password\x20reset\x20rejected')[_0x361004(0x81)](_0x4953a4=>{telegramError(_0x4953a4);});}),tgBot[_0x3ae6b9(0x187)](_0x3ae6b9(0x126));}));}function logging(_0xa05c8e){const _0x3b5c6e=_0x10db24;console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0xa05c8e);if(tgBot&&settings[_0x3b5c6e(0x145)]&&settings[_0x3b5c6e(0x88)]!=_0x3b5c6e(0xdd))tgBot[_0x3b5c6e(0x194)](settings['telegramChatId'],_0x3b5c6e(0x198)+_0xa05c8e)[_0x3b5c6e(0x81)](_0x46ea8c=>{telegramError(_0x46ea8c);});}function getServerTime(){const _0x181448=_0x10db24,_0x2f084b=new Date();return _0x2f084b[_0x181448(0xd3)]()+'/'+(_0x2f084b[_0x181448(0x170)]()+0x1)[_0x181448(0x11d)]()[_0x181448(0x86)](0x2,'0')+'/'+_0x2f084b[_0x181448(0x193)]()[_0x181448(0x11d)]()['padStart'](0x2,'0')+'\x20'+_0x2f084b['getHours']()['toString']()[_0x181448(0x86)](0x2,'0')+':'+_0x2f084b[_0x181448(0x188)]()[_0x181448(0x11d)]()[_0x181448(0x86)](0x2,'0')+':'+_0x2f084b[_0x181448(0x10d)]()[_0x181448(0x11d)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x460d90=_0x10db24,_0x31ca94=shiftedTime();return _0x31ca94['getFullYear']()+'/'+(_0x31ca94[_0x460d90(0x170)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x31ca94[_0x460d90(0x193)]()[_0x460d90(0x11d)]()[_0x460d90(0x86)](0x2,'0')+'\x20'+_0x31ca94[_0x460d90(0xcb)]()[_0x460d90(0x11d)]()[_0x460d90(0x86)](0x2,'0')+':'+_0x31ca94['getMinutes']()[_0x460d90(0x11d)]()[_0x460d90(0x86)](0x2,'0')+':'+_0x31ca94[_0x460d90(0x10d)]()[_0x460d90(0x11d)]()[_0x460d90(0x86)](0x2,'0');}function shiftedTime(){const _0x13cc0c=_0x10db24,_0x23ddd9=new Date();let _0xc22f48=_0x23ddd9;if(settings['timeshift']&&settings[_0x13cc0c(0x160)]!==0x0)_0xc22f48=fns[_0x13cc0c(0x14e)](_0x23ddd9,{'hours':settings[_0x13cc0c(0x160)]});return _0xc22f48;}function startScheduler(){const _0xea1b00=_0x10db24;let _0x5b8797=new Date()[_0xea1b00(0x89)]();_0x5b8797==0x1&&backupConfigFiles();_0x5b8797==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x570e2a=_0x10db24;fs[_0x570e2a(0x13f)](configpath,{'withFileTypes':!![]})['forEach'](_0x5ead26=>{const _0x3ecb25=_0x570e2a;if(!_0x5ead26[_0x3ecb25(0x9b)]())fs[_0x3ecb25(0x9f)](configpath+_0x5ead26[_0x3ecb25(0x8b)],configbackuppath+_0x5ead26[_0x3ecb25(0x8b)]);});}function triggerAnalytics(){const _0x291102=_0x10db24;analytics[_0x291102(0x155)]({'title':_0x291102(0x10f),'href':_0x291102(0x152),'path':'/v'+serverversion});}function validateCredentials(_0x5e6567,_0x17d31a){const _0x1c7403=_0x10db24;if(_0x5e6567[_0x1c7403(0xb2)]==settings[_0x1c7403(0xb9)]&&bcrypt[_0x1c7403(0xef)](_0x5e6567[_0x1c7403(0x17a)],settings[_0x1c7403(0x16e)])){if(settings[_0x1c7403(0xe2)])return{'allow':![],'reason':_0x1c7403(0x136),'token':null};else{const _0x27c41b=generateLoginToken(_0x17d31a);return{'allow':!![],'reason':_0x1c7403(0xe0),'token':_0x27c41b};}}else return{'allow':![],'reason':_0x1c7403(0xfa),'token':null};}function refreshToken(_0x43f10d){const _0x3c4380=generateLoginToken(_0x43f10d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3c4380};}function validateAccess(_0x101eca,_0x203c2e){const _0x5f384e=_0x10db24;let _0x321001=devices[_0x203c2e]['ip'],_0x8d6df2;const _0x2d240c=_0xe438f3=>{const _0x172d46=_0x40a5;if(settings[_0x172d46(0xa8)]){if(settings[_0x172d46(0xe2)]){if(telegram2FaApproved(_0x203c2e)){const _0x34608a=generateLoginToken(_0x203c2e);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x34608a};}else return{'allow':![],'reason':_0x172d46(0x1b5),'token':null};}else return _0x8d6df2=validToken(_0xe438f3,_0x203c2e),_0x8d6df2[_0x172d46(0x92)](_0x172d46(0x1af))?{'allow':!![],'reason':_0x172d46(0x164),'token':_0xe438f3}:{'allow':![],'reason':_0x172d46(0x1b5),'token':null};}else return{'allow':!![],'reason':_0x172d46(0x99),'token':null};};if(settings[_0x5f384e(0xc2)]){let _0x1a8fe8=[...settings[_0x5f384e(0x133)],_0x5f384e(0x12c),_0x5f384e(0x106),'127.0.0.1'];if(_0x1a8fe8['includes'](_0x321001))return _0x2d240c(_0x101eca);else{_0x8d6df2=validToken(_0x101eca,_0x203c2e);if(_0x8d6df2[_0x5f384e(0x92)](_0x5f384e(0x1af)))return _0x2d240c(_0x101eca);else{if(telegramIpApproved(_0x203c2e)){const _0x342215=generateToken(_0x203c2e);return _0x8d6df2=_0x2d240c(_0x101eca),_0x8d6df2[_0x5f384e(0xee)]?{'allow':!![],'reason':_0x5f384e(0x112),'token':_0x342215}:_0x8d6df2;}else return settings[_0x5f384e(0x1c2)]?{'allow':![],'reason':_0x5f384e(0xeb),'token':null}:{'allow':![],'reason':_0x5f384e(0x8a),'token':null};}}}else return _0x2d240c(_0x101eca);}function timelyDecrypt(_0x58f701,_0x550b63=!![]){const _0xfa65d=_0x10db24;if(_0x58f701)try{const _0x2cba42=crypt['decrypt'](secure[_0xfa65d(0x18e)],_0x58f701)[_0xfa65d(0x180)],_0x4b44ed=_0x2cba42[_0xfa65d(0x19a)]('@')[0x0],_0x116931=_0x2cba42['split']('@')[0x1],_0x15a6ab=new Date()[_0xfa65d(0x1ac)]();if(_0x550b63){if(_0x15a6ab-_0x116931<maxSecretAge*0x3e8)return _0x4b44ed;else return![];}else return _0x4b44ed;}catch(_0x7a2819){return![];}else return![];}const validToken=(_0xdad564,_0x266784)=>{const _0x818bd3=_0x10db24,_0x141dbd=devices[_0x266784]['ip'];if(!_0xdad564)return{'error':_0x818bd3(0xbc)};for(let _0x81d080 of blacklist){if(_0x81d080[_0x818bd3(0xd5)]==_0xdad564)return{'error':'Token\x20blacklisted'};}let _0x3c1ba6;try{_0x3c1ba6=jwt[_0x818bd3(0xb7)](_0xdad564,secure[_0x818bd3(0xbd)]+_0x266784);}catch{return{'error':_0x818bd3(0x1b0)};}if(!_0x3c1ba6[_0x818bd3(0x92)](_0x818bd3(0x19f))&&!_0x3c1ba6[_0x818bd3(0x92)](_0x818bd3(0xb2))||!_0x3c1ba6[_0x818bd3(0x92)]('exp'))return{'error':_0x818bd3(0x138)};if(!_0x3c1ba6[_0x818bd3(0x92)](_0x818bd3(0xb2))&&_0x3c1ba6[_0x818bd3(0x92)](_0x818bd3(0x19f))){const {clientip:_0x40bec}=_0x3c1ba6;return _0x141dbd==_0x40bec?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x3c1ba6[_0x818bd3(0x92)](_0x818bd3(0xb2))&&_0x3c1ba6[_0x818bd3(0x92)]('clientip')){const {username:_0x26e12d,clientip:_0x51b8bb}=_0x3c1ba6;return settings[_0x818bd3(0xb9)]==_0x26e12d&&_0x141dbd==_0x51b8bb?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x58bd6c=>{const _0x38bea1=_0x10db24;if(_0x58bd6c){const _0x223695=devices[_0x58bd6c]['ip'];return jwt[_0x38bea1(0xbf)]({'username':settings[_0x38bea1(0xb9)],'clientip':_0x223695},secure[_0x38bea1(0xbd)]+_0x58bd6c,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x25df3d=>{const _0xff00b8=_0x10db24;if(_0x25df3d){const _0x3395c2=devices[_0x25df3d]['ip'];return jwt[_0xff00b8(0xbf)]({'clientip':_0x3395c2},secure['secret']+_0x25df3d,{'expiresIn':devices[_0x25df3d][_0xff00b8(0xce)][_0xff00b8(0x13e)]*0x3c});}else return![];},telegramIpApproved=_0x2cd8bf=>{const _0x215690=_0x10db24;let _0x51c430=![];return devices[_0x2cd8bf][_0x215690(0xce)]&&devices[_0x2cd8bf][_0x215690(0xce)][_0x215690(0x13e)]!=_0x215690(0x15f)&&(_0x51c430=devices[_0x2cd8bf][_0x215690(0xce)][_0x215690(0x19f)]==devices[_0x2cd8bf]['ip']&&new Date()[_0x215690(0x1ac)]()-devices[_0x2cd8bf][_0x215690(0xce)][_0x215690(0xf7)]<devices[_0x2cd8bf][_0x215690(0xce)][_0x215690(0x13e)]*0x3c*0x3e8),_0x51c430;},telegram2FaApproved=_0x1b08ef=>{const _0x5d62fd=_0x10db24;let _0x38afd0=![];return devices[_0x1b08ef][_0x5d62fd(0xcd)]&&devices[_0x1b08ef]['telegram2FaApproval'][_0x5d62fd(0x13e)]!=_0x5d62fd(0x15f)&&(_0x38afd0=devices[_0x1b08ef][_0x5d62fd(0xcd)][_0x5d62fd(0x19f)]==devices[_0x1b08ef]['ip']&&new Date()[_0x5d62fd(0x1ac)]()-devices[_0x1b08ef][_0x5d62fd(0xcd)]['timestamp']<devices[_0x1b08ef][_0x5d62fd(0xcd)][_0x5d62fd(0x13e)]*0x3c*0x3e8),_0x38afd0;},normalizeIP=_0x211715=>{const _0x1dcbed=_0x10db24;let _0x3b5668=null,_0x208b3a=null;if(ipaddr['isValid'](_0x211715)){const _0x12c685=ipaddr[_0x1dcbed(0x132)](_0x211715);_0x12c685[_0x1dcbed(0xe6)]()==='ipv6'?(_0x12c685[_0x1dcbed(0x1c3)]()&&(_0x3b5668=_0x12c685[_0x1dcbed(0xbe)]()[_0x1dcbed(0x11d)]()),_0x208b3a=_0x12c685[_0x1dcbed(0x11d)]()):(_0x3b5668=_0x12c685['toString'](),_0x208b3a=_0x12c685['toIPv4MappedAddress']()[_0x1dcbed(0x11d)]());}return{'show':_0x3b5668?_0x3b5668:_0x208b3a,'store':_0x208b3a};};