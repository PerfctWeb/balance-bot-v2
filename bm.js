const _0x59e1df=_0x4818;(function(_0x5f5bb4,_0xdf108a){const _0x202422=_0x4818,_0x18d68e=_0x5f5bb4();while(!![]){try{const _0x495637=-parseInt(_0x202422(0x2ee))/0x1*(parseInt(_0x202422(0x1d4))/0x2)+-parseInt(_0x202422(0x2f3))/0x3*(-parseInt(_0x202422(0x2a1))/0x4)+-parseInt(_0x202422(0x299))/0x5+parseInt(_0x202422(0x2cb))/0x6+parseInt(_0x202422(0x2df))/0x7*(parseInt(_0x202422(0x152))/0x8)+-parseInt(_0x202422(0x2fd))/0x9+parseInt(_0x202422(0x1ba))/0xa*(parseInt(_0x202422(0x1a9))/0xb);if(_0x495637===_0xdf108a)break;else _0x18d68e['push'](_0x18d68e['shift']());}catch(_0xb73e61){_0x18d68e['push'](_0x18d68e['shift']());}}}(_0x2738,0xab66c));const _0x4fb5e9=function(){let _0x461486=!![];return function(_0x3fbdf7,_0x3ab6d9){const _0x2467f5=_0x461486?function(){if(_0x3ab6d9){const _0x468807=_0x3ab6d9['apply'](_0x3fbdf7,arguments);return _0x3ab6d9=null,_0x468807;}}:function(){};return _0x461486=![],_0x2467f5;};}(),_0x561141=_0x4fb5e9(this,function(){const _0x22b976=_0x4818;return _0x561141[_0x22b976(0x23e)]()[_0x22b976(0x221)](_0x22b976(0x1be))[_0x22b976(0x23e)]()[_0x22b976(0x284)](_0x561141)[_0x22b976(0x221)]('(((.+)+)+)+$');});_0x561141();'use strict';process[_0x59e1df(0x19f)][_0x59e1df(0x244)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require(_0x59e1df(0x28d)),path=require(_0x59e1df(0x2b2)),crypto=require(_0x59e1df(0x165)),Crypt=require(_0x59e1df(0x296))[_0x59e1df(0x2f9)],RSA=require(_0x59e1df(0x296))[_0x59e1df(0x245)],bcrypt=require(_0x59e1df(0x2be)),jwt=require(_0x59e1df(0x273)),ipaddr=require('ipaddr.js'),argv=require(_0x59e1df(0x309))(process['argv'][_0x59e1df(0x1f2)](0x2))[_0x59e1df(0x25f)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x59e1df(0x198)),Mixpanel=require(_0x59e1df(0x1c6)),axios=require(_0x59e1df(0x1a1)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x59e1df(0x252)),fileUpload=require(_0x59e1df(0x16d)),{networkInterfaces}=require('os'),PORT=argv[_0x59e1df(0x2e0)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x59e1df(0x1c3)](PORT)&&(console['log'](_0x59e1df(0x233)+PORT+_0x59e1df(0x1e3)),process['exit'](0x1));const HOST=argv[_0x59e1df(0x1dd)]||null,userID=argv[_0x59e1df(0x2b7)]||'',debugging=argv['d']||![],nodeversion=process[_0x59e1df(0x161)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x59e1df(0x1c7),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x59e1df(0x26e),maxBackups=0xa;let validInstallation=!![];!fs[_0x59e1df(0x25c)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x59e1df(0x2db)),configpath=userID?bbpath+_0x59e1df(0x1e6)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x59e1df(0x2f2)+userID+'/':bbpath+_0x59e1df(0x2f2),zippath=userID?bbpath+_0x59e1df(0x2d4)+userID+'/':bbpath+_0x59e1df(0x2d4),loggerfile=fs[_0x59e1df(0x174)](logspath+_0x59e1df(0x303),{'flags':'a'}),temppath=userID?bbpath+_0x59e1df(0x2a0)+userID+'/':bbpath+'temp/';!fs[_0x59e1df(0x25c)](configpath)&&fs[_0x59e1df(0x160)](configpath);!fs[_0x59e1df(0x25c)](configbackuppath)&&fs[_0x59e1df(0x160)](configbackuppath);!fs[_0x59e1df(0x25c)](logspath)&&fs[_0x59e1df(0x160)](logspath);function _0x2738(){const _0x14b31e=['success','answerCallbackQuery','login\x20token\x20valid','.zip','notification','getSeconds','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','mode','reset-history','login\x20required','telegramToken','inherit','/off\x20-\x20stop\x20bot(s)\x0a','http','temporary\x20access\x20timeout','uncaughtException','telegrammsg','Logged\x20out\x20user\x20...','delete-bot','2FA\x20login\x20rejected','Ok,\x20will\x20send\x20order\x20notifications\x20only','bot','bbUsername','clientip','32216DkxAPw','***','bot-','showConfig','tkn','replace','private','************','map','updatebotmanager','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','\x1b[33m','Alerts','mkdirSync','versions','sendMessage','output-001.log','sendFile','crypto','secret','exec','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Deleted\x20Bot\x20','getDate','Invalid\x20authentication\x20token\x20(1)','Token\x20blacklisted','express-fileupload','store-configuration','startsWith','alerts','2FA\x20login\x20required','restart','randomBytes','createWriteStream','warning','storeConfiguration','IPv4','function','timeshift','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20>\x20','filter','pidExpireLogin','from','deleteHistoryAlerts','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','getMonth','show-config','stopPolling','debug','backup','manual','removeListener','access\x20timeout','includes','node-zip','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','endsWith','pidRefreshToken','Idling\x20bot\x20\x20\x20|\x20Bot\x20','settings','get-backup-files','socket','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','2FA','simple','confirm-message','User\x20has\x20been\x20validated','build','node-telegram-bot-api','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','allow','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','format','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','env','yes','axios','output-002.log','Notifications\x20types:\x20','\x20(1)','params','botID','temporary\x20access\x20not\x20allowed','1000','1002254GQzDVG','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','30\x20min','sign','reload','once','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','auto','/download/:type','/:bot/performance','Unauthorized\x20attempt\x20to\x20delete\x20alerts','statSync','/enable\x20-\x20enable\x20notifications\x0a','\x20mode','0.0.0','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bots','250AcdRpR','listen','No\x20authentication\x20token','showname','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20update\x20settings','message','Login\x20rejected','status','test','entries','verify','mixpanel','bot.js','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','<b>Balance\x20Bot\x20Status:</b>\x0a','404\x20Not\x20Found','catch','sendPortfolioTelegram','</b>\x20?','toIPv4Address','server','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','reason','stringify','*$1*','95478oGUlZr','get-messages','All\x20bots\x20running\x20right\x20now','temporaryAccessAllowed','Unauthorized\x20attempt\x20to\x20confirm\x20message','Backup\x20file\x20unzipped\x20and\x20stored','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','expiry','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','host','sortBy','File\x20uploaded','/update\x20-\x20update\x20Balance\x20Bot\x0a','send','logs',',\x20must\x20be\x20a\x204\x20digit\x20number','\x20only\x0a','files','config/','number','assign','type','add-bot','Failed\x20to\x20download\x20','decrypt','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','add','post','sendMetricsTelegram','output-003.log','slice','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','delete-alerts','find','orders','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','get-logs','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','remove','stopped','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20show\x20configuration','callback_query','Access\x20enabled\x20for\x20','blacklist','hex','invalid\x20credentials','full','remoteAddress','uuid','isValid','-config.json','set','Orders','exchange','/upload-backup','onText','string','stop','-results.json','Notifications\x20enabled\x0a','rmSync','unlinkSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegramChatId','exit','sort','Unauthorized\x20attempt\x20to\x20download\x20','title','reinstall','update-bb','Password\x20reset\x20rejected','getPortfolio','storeHeadless','\x20|\x20client:\x20...','sockets','search','botname','temporary\x20token\x20generated','toggleBotMode','::ffff:127.0.0.1','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','\x1b[31m','new-disabled','getHours','backup-full.zip','get','getFullYear','write','keys','privateKey','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','=>\x20Go\x20to\x20#CYA#http://','headers','Error:\x20Invalid\x20argument\x20','bbvNew','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','-events.json','#RES#\x20if\x20running\x20locally\x0a','emit','Login\x20accepted','any','reset-password','parse','order','toString','address','https://api.ipify.org?format=json','writeFileSync','SIGINT','family','NTBA_FIX_319','RSA','5\x20min','chat','kill','whitelistEnabled','value','settings.','hasOwnProperty','conn','ipv6','accept','Allow\x20login\x20from\x20IP\x20address\x20<b>','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','util','Bot\x20','defaults','download','alias','toggle-bot-mode','reject','update-bot','enabled','error','existsSync',':\x20Bot\x20Mgr\x20>\x20','temporary\x20access\x20rejected','argv','lastmsgtelegram','Node.js\x20v','telegramUsername','handshake','\x1b[0m','Temporary\x20access\x20rejected','store','then','Server','data','latestversion','secure','length','Network\x20Interfaces:','bb-secure.json','readFileSync','telegram2FaApproval','access','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','jsonwebtoken','Logged\x20in\x20user\x20...','/:bot/coins','backup-full@','telegramIpApproval','apiKey','-performance.json','6b67f3d61ee94b8f5c80b4affef4c4d9','event','All','Notifications\x20disabled\x0a','backup-full','backup-files','/help\x20-\x20show\x20available\x20commands\x0a','isDirectory','bbvReceive','Unauthorized\x20attempt\x20to\x20store\x20configuration','constructor','build2','token','\x20|\x20','readdirSync','binary','all','userid','createServer','lowdb/adapters/FileSync','getUTCHours','new','Unauthorized\x20attempt\x20to\x20delete\x20bot','Ok,\x20will\x20send\x20alert\x20notifications\x20only','show','$1_$2_$3','Starting\x20Balance\x20Bot\x20','init','hybrid-crypto-js','use','apiSecret','6713205NLQFDX','f2aRequired','api-eu.mixpanel.com','file','Invalid\x20Telegram\x20token','[ip-address]','password','temp/','12pVGmwW','timestamp','telegramEnabled','Setting\x20access:\x20','_data','2FA\x20login\x20token\x20generated','match','push','Restore\x20process\x20aborted','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','\x1b[34m','apiPassword','Invalid\x20username\x20or\x20IP\x20address','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','15\x20min','All\x20bots','path','storeFiat','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20update\x20bot','botmanager','user','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','login','isIPv4MappedAddress','telegram','\x1b[35m','/names\x20-\x20show\x20bot\x20names\x0a','bcryptjs','/status\x20-\x20show\x20bot(s)\x20status\x0a','Starting\x20new\x20bot\x20|\x20Bot\x20','initclient','forEach','Enabled\x20Bot\x20','size','headless','getTime','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','loginRequired','socket.io','onepagemode','342078ULVjjH','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','<b>Telegram\x20Bot\x20Status:</b>\x0a','username','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','whitelist','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Bot\x20Mgr\x20>\x20','No\x20bots\x20running\x20right\x20now','zip/','live','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','join','ipc','logged\x20out','store-settings','clients','name','index.html','fork','154OrrYLE','port','Unauthorized\x20attempt\x20to\x20log\x20out','Error\x20while\x20deleting\x20config\x20files:\x20','/:bot/support','update','place-order','messages','Restarting\x20Bot\x20','padStart','Starting\x20#RED#Balance\x20Bot\x20v','request','compareSync','telegramEvents','lastmsgemitted','15nQmmqx','getMinutes','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','#RES#\x0a','logs/','536790kSEbwo','copyFileSync','/:bot','exp','-----------------------------------------------------------------------------------','publicKey','Crypt','\x1b[36m','Yes','hashSync','1795149PFTDIz','get-portfolio','2FA\x20required','HTML','disabled','logout','/output-000.log','disconnect','log','cancel-loading','split','randomFillSync','yargs/yargs','version','bbPassword','static','bb-settings.json'];_0x2738=function(){return _0x14b31e;};return _0x2738();}!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x59e1df(0x25c)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x59e1df(0x254)]({'bots':[]})[_0x59e1df(0x22d)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x59e1df(0x254)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x59e1df(0x254)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x59e1df(0x295)](_0x59e1df(0x27a),{'host':_0x59e1df(0x29b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x59e1df(0x144)]&&settings['telegramToken']!=''&&settings[_0x59e1df(0x262)]&&settings[_0x59e1df(0x262)]!='')initTelegram();const parseColor=(_0x4a23a5,_0x318c70)=>{const _0x5722ee=_0x59e1df,_0x3b115c=/#[A-Z]{3}#/g;if(typeof _0x4a23a5==_0x5722ee(0x20d)){!_0x318c70?_0x4a23a5=_0x4a23a5['replace'](_0x3b115c,''):(_0x4a23a5=_0x4a23a5[_0x5722ee(0x157)](/#BLU#/g,_0x5722ee(0x2ab)),_0x4a23a5=_0x4a23a5[_0x5722ee(0x157)](/#RED#/g,_0x5722ee(0x227)),_0x4a23a5=_0x4a23a5[_0x5722ee(0x157)](/#YEL#/g,_0x5722ee(0x15e)),_0x4a23a5=_0x4a23a5['replace'](/#MAG#/g,_0x5722ee(0x2bc)),_0x4a23a5=_0x4a23a5[_0x5722ee(0x157)](/#CYA#/g,_0x5722ee(0x2fa)),_0x4a23a5=_0x4a23a5[_0x5722ee(0x157)](/#RES#/g,_0x5722ee(0x264)));;}return _0x4a23a5;},logger={'screen':_0x3e683b=>{const _0x198eaf=_0x59e1df;console[_0x198eaf(0x305)](parseColor(_0x3e683b,!![]));},'simple':_0x4e4f0e=>{const _0x2221c4=_0x59e1df;console[_0x2221c4(0x305)](parseColor(_0x4e4f0e,!![])),loggerfile[_0x2221c4(0x22d)](util[_0x2221c4(0x19d)](parseColor(_0x4e4f0e,![]))+'\x0a');},'full':async _0x333f7f=>{const _0x308bf9=_0x59e1df,_0x1cb313=getTimeStamp()+_0x308bf9(0x25d)+_0x333f7f;console[_0x308bf9(0x305)](parseColor(_0x1cb313,!![])),loggerfile[_0x308bf9(0x22d)](util[_0x308bf9(0x19d)](parseColor(_0x1cb313,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x308bf9(0x1f6))await tgBot[_0x308bf9(0x162)](settings['telegramChatId'],_0x308bf9(0x2d2)+parseColor(_0x333f7f,![]))[_0x308bf9(0x1cb)](_0x2607ec=>{telegramError(_0x2607ec);});},'debug':async(_0x3fe34d,_0x1715a6='')=>{const _0x46bc87=_0x59e1df,_0x5b2e58=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x3fe34d;if(debugging)console[_0x46bc87(0x305)](parseColor(_0x5b2e58,!![]));loggerfile[_0x46bc87(0x22d)](util[_0x46bc87(0x19d)](parseColor(_0x5b2e58,![]))+'\x0a');if(_0x1715a6){if(debugging)console[_0x46bc87(0x305)](_0x1715a6);loggerfile[_0x46bc87(0x22d)](util[_0x46bc87(0x19d)](_0x1715a6)+'\x0a');}}};process['on'](_0x59e1df(0x149),function(_0x5d4d95){logger['simple'](_0x5d4d95);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x59e1df(0x30a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x4818(_0x454cc8,_0x3432cc){const _0x507f8a=_0x2738();return _0x4818=function(_0x561141,_0x4fb5e9){_0x561141=_0x561141-0x137;let _0x273890=_0x507f8a[_0x561141];return _0x273890;},_0x4818(_0x454cc8,_0x3432cc);}const express=require('express'),app=express(),http=require(_0x59e1df(0x147))[_0x59e1df(0x28c)](app);app[_0x59e1df(0x297)](fileUpload({'useTempFiles':!![]})),app['get'](_0x59e1df(0x1b1),async(_0x2395a0,_0x591cf7)=>{const _0x2850a5=_0x59e1df,_0x33b291=_0x2395a0[_0x2850a5(0x1a5)][_0x2850a5(0x1e9)],_0x38f67e=getClientsWithBotID(_0x2850a5(0x2b6)),_0x17e62e=_0x2395a0[_0x2850a5(0x232)][_0x2850a5(0x205)],_0x19db04=timelyDecrypt(_0x17e62e,![]),_0x38243f=_0x38f67e['find'](_0x1f6262=>_0x1f6262['uuid']==_0x19db04);if(_0x38243f){const _0x4bcfff=normalizeIP(_0x2395a0[_0x2850a5(0x191)][_0x2850a5(0x204)])[_0x2850a5(0x266)],_0x7ea723=_0x2395a0[_0x2850a5(0x232)][_0x2850a5(0x156)];if(validateAccess(_0x7ea723,_0x19db04,_0x4bcfff)[_0x2850a5(0x19b)])_0x33b291==_0x2850a5(0x185)&&await backupConfigFiles(),await zipFiles(_0x33b291),_0x591cf7[_0x2850a5(0x255)](zippath+(_0x33b291+_0x2850a5(0x13d)),_0x50662f=>{const _0x16c668=_0x2850a5;_0x50662f&&(logger[_0x16c668(0x203)](_0x16c668(0x1eb)+_0x33b291),logger[_0x16c668(0x194)](_0x50662f));});else logger[_0x2850a5(0x203)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x33b291+_0x2850a5(0x1a4));}else logger[_0x2850a5(0x203)](_0x2850a5(0x218)+_0x33b291+'\x20(2)');}),app[_0x59e1df(0x1ef)](_0x59e1df(0x20b),async(_0x5c760f,_0x3ef3fa)=>{const _0x3f3b4e=_0x59e1df,_0xc16fee=getClientsWithBotID('botmanager'),_0x25dfd1=_0x5c760f[_0x3f3b4e(0x232)]['uuid'],_0x293725=timelyDecrypt(_0x25dfd1,![]),_0x628180=_0xc16fee[_0x3f3b4e(0x1f5)](_0x266be9=>_0x266be9[_0x3f3b4e(0x205)]==_0x293725);logger['debug']('Backup\x20file\x20uploaded');if(_0x628180){const _0x462632=normalizeIP(_0x5c760f[_0x3f3b4e(0x191)][_0x3f3b4e(0x204)])[_0x3f3b4e(0x266)],_0xc4824d=_0x5c760f[_0x3f3b4e(0x232)][_0x3f3b4e(0x156)];if(validateAccess(_0xc4824d,_0x293725,_0x462632)[_0x3f3b4e(0x19b)]){if(_0x5c760f[_0x3f3b4e(0x1e5)]){const _0x4aefa4=_0x5c760f['files']['backupfile'];await _0x4aefa4['mv'](temppath+_0x4aefa4['name']),_0x3ef3fa[_0x3f3b4e(0x1e1)]({'status':!![],'message':_0x3f3b4e(0x1df)});const _0x1bbd84=getBotsWithMode();_0x1bbd84[_0x3f3b4e(0x26c)]>0x0?confirmRestore(temppath,_0x4aefa4['name']):unzipFile(temppath,_0x4aefa4[_0x3f3b4e(0x2dc)]);}}else logger['full'](_0x3f3b4e(0x19e));}else logger[_0x3f3b4e(0x203)](_0x3f3b4e(0x15c));}),app[_0x59e1df(0x297)](express[_0x59e1df(0x138)](path[_0x59e1df(0x2d7)](__dirname,bbpath2,'build2'))),app[_0x59e1df(0x297)](express[_0x59e1df(0x138)](path['join'](__dirname,bbpath2,'build'))),app['get']('/',function(_0x3be9bc,_0x508c2b){const _0x512c90=_0x59e1df;_0x508c2b[_0x512c90(0x164)](path[_0x512c90(0x2d7)](__dirname,bbpath2,_0x512c90(0x285),_0x512c90(0x2dd)));}),app[_0x59e1df(0x22b)](_0x59e1df(0x2f5),function(_0x2326ad,_0x572dbd){const _0x353719=_0x59e1df;_0x572dbd[_0x353719(0x164)](path[_0x353719(0x2d7)](__dirname,bbpath2,_0x353719(0x197),'index.html'));}),app['get']('/:bot/portfolio',(_0x2bd678,_0x3f895b)=>{const _0x3ca9b7=_0x59e1df;_0x3f895b[_0x3ca9b7(0x164)](path[_0x3ca9b7(0x2d7)](__dirname,bbpath2,_0x3ca9b7(0x197),'index.html'));}),app[_0x59e1df(0x22b)](_0x59e1df(0x1b2),(_0xf9b987,_0x562014)=>{const _0x505485=_0x59e1df;_0x562014[_0x505485(0x164)](path[_0x505485(0x2d7)](__dirname,bbpath2,_0x505485(0x197),_0x505485(0x2dd)));}),app['get'](_0x59e1df(0x275),(_0x568130,_0x5018d2)=>{const _0x302cf6=_0x59e1df;_0x5018d2['sendFile'](path[_0x302cf6(0x2d7)](__dirname,bbpath2,_0x302cf6(0x197),'index.html'));}),app[_0x59e1df(0x22b)]('/:bot/history',(_0x486783,_0x8ba6ef)=>{const _0xc91110=_0x59e1df;_0x8ba6ef[_0xc91110(0x164)](path['join'](__dirname,bbpath2,'build',_0xc91110(0x2dd)));}),app[_0x59e1df(0x22b)]('/:bot/configuration',(_0x190044,_0x2c9bd1)=>{const _0x180065=_0x59e1df;_0x2c9bd1[_0x180065(0x164)](path[_0x180065(0x2d7)](__dirname,bbpath2,_0x180065(0x197),_0x180065(0x2dd)));}),app['get'](_0x59e1df(0x2e3),(_0xd71b3e,_0x7b7c7d)=>{const _0x3bc4e=_0x59e1df;_0x7b7c7d['sendFile'](path['join'](__dirname,bbpath2,'build',_0x3bc4e(0x2dd)));});if(HOST)http[_0x59e1df(0x1bb)](PORT,HOST);else http['listen'](PORT);const io=require(_0x59e1df(0x2c9))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x92f1ff=_0x59e1df;let _0x3ebec7=_0x92f1ff(0x29e);const _0x2d3623=networkInterfaces(),_0x486f8f={};for(const _0x5a4469 of Object[_0x92f1ff(0x22e)](_0x2d3623)){for(const _0x431982 of _0x2d3623[_0x5a4469]){if((_0x431982[_0x92f1ff(0x243)]==_0x92f1ff(0x177)||_0x431982[_0x92f1ff(0x243)]==0x4)&&!_0x431982['internal']){const _0x41eb04=ipaddr[_0x92f1ff(0x23c)](_0x431982[_0x92f1ff(0x23f)])['range']();_0x41eb04!=_0x92f1ff(0x158)&&(!_0x486f8f[_0x5a4469]&&(_0x486f8f[_0x5a4469]=[]),_0x486f8f[_0x5a4469]['push'](_0x431982['address']),_0x3ebec7=_0x431982[_0x92f1ff(0x23f)]);}}}return{'serverip':_0x3ebec7,'netinterfaces':_0x486f8f};}async function startServer(){const _0x37b99c=_0x59e1df,{serverip:_0x7aa677,netinterfaces:_0x57b3a7}=getServerIP();logger[_0x37b99c(0x194)](''),logger[_0x37b99c(0x194)](_0x37b99c(0x2f7)),await logger[_0x37b99c(0x203)](_0x37b99c(0x2e9)+serverversion+_0x37b99c(0x2f1)+(_0x37b99c(0x192)+PORT+_0x37b99c(0x237))+(_0x37b99c(0x231)+_0x7aa677+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x37b99c(0x194)]('-----------------------------------------------------------------------------------');if(config[_0x37b99c(0x26c)]!=0x0)for(const _0x393510 of config){if(_0x393510[_0x37b99c(0x1c2)]=='enabled'||_0x393510[_0x37b99c(0x1c2)]=='new')await logger[_0x37b99c(0x203)]('Starting\x20bot\x20|\x20Bot\x20'+_0x393510[_0x37b99c(0x1a6)]+_0x37b99c(0x287)+_0x393510[_0x37b99c(0x222)]),startBot([_0x393510[_0x37b99c(0x1a6)],userID],{'cwd':bbpath},function(_0x31757c){if(_0x31757c)logger['full'](_0x31757c);});else(_0x393510[_0x37b99c(0x1c2)]=='disabled'||_0x393510[_0x37b99c(0x1c2)]==_0x37b99c(0x228))&&await logger['full'](_0x37b99c(0x18e)+_0x393510[_0x37b99c(0x1a6)]+_0x37b99c(0x287)+_0x393510[_0x37b99c(0x222)]);}else!newBot&&logger['simple'](_0x37b99c(0x1aa));if(newBot)addBot();logger[_0x37b99c(0x194)](_0x37b99c(0x2f7)),logger[_0x37b99c(0x194)](''),await logger[_0x37b99c(0x184)](_0x37b99c(0x261)+nodeversion),await logger[_0x37b99c(0x184)](_0x37b99c(0x26d),_0x57b3a7);}function startSocket(){io['on']('connection',_0x502a73=>{const _0x4f7f16=_0x4818;let _0x7d57f3,_0x3efa60,_0xfe1214,_0x5c248a,_0x5a81a3;const _0x1ff5ba=_0x502a73['handshake'][_0x4f7f16(0x232)]['referer'];_0x3efa60=_0x1ff5ba[_0x4f7f16(0x2a7)](/bot[0-9]{3}/);if(_0x3efa60)_0xfe1214=_0x3efa60[0x0][_0x4f7f16(0x2a7)](/[0-9]{3}/);if(_0xfe1214)_0x7d57f3=_0xfe1214[0x0];else _0x7d57f3=_0x4f7f16(0x2b6);const _0x50c701=_0x502a73[_0x4f7f16(0x263)]['auth']['encryptedUuid'];if(!_0x50c701)_0x502a73[_0x4f7f16(0x238)]('status',{'publicKey':secure[_0x4f7f16(0x2f8)]});else{_0x5c248a=timelyDecrypt(_0x50c701,![]);if(!_0x5c248a)_0x502a73[_0x4f7f16(0x238)](_0x4f7f16(0x1c2),{'publicKey':secure['publicKey']});else{_0x5a81a3=normalizeIP(_0x502a73[_0x4f7f16(0x24d)][_0x4f7f16(0x204)])[_0x4f7f16(0x266)];if(!devices[_0x5c248a])devices[_0x5c248a]={'uuid':_0x5c248a,'access':{'token':null}};devices[_0x5c248a]['ip']=_0x5a81a3;const _0x1bd1a5=addClient(_0x502a73['id'],_0x5c248a,_0x7d57f3);setAccess(_0x1bd1a5),emitMessages(),_0x502a73['on']('login',_0x5bc264=>{const _0x4b2b6e=_0x4f7f16,_0x5dbcfd=timelyDecrypt(_0x5bc264[_0x4b2b6e(0x29f)]);if(_0x5dbcfd){_0x5bc264={'username':_0x5bc264[_0x4b2b6e(0x2ce)],'password':_0x5dbcfd},devices[_0x5c248a][_0x4b2b6e(0x271)]=validateCredentials(_0x5bc264,_0x5c248a);if(devices[_0x5c248a][_0x4b2b6e(0x271)][_0x4b2b6e(0x19b)]==![]&&devices[_0x5c248a]['access']['reason']==_0x4b2b6e(0x171))_0x502a73['emit'](_0x4b2b6e(0x1c2),{'access':devices[_0x5c248a][_0x4b2b6e(0x271)]}),loginAccess2FA(_0x5c248a,_0x5a81a3);else{if(devices[_0x5c248a][_0x4b2b6e(0x271)][_0x4b2b6e(0x19b)]==![]&&devices[_0x5c248a][_0x4b2b6e(0x271)][_0x4b2b6e(0x1d1)]==_0x4b2b6e(0x202))_0x502a73[_0x4b2b6e(0x238)](_0x4b2b6e(0x1c2),{'access':devices[_0x5c248a][_0x4b2b6e(0x271)]});else devices[_0x5c248a][_0x4b2b6e(0x271)][_0x4b2b6e(0x19b)]&&devices[_0x5c248a][_0x4b2b6e(0x271)][_0x4b2b6e(0x1d1)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5c248a)[_0x4b2b6e(0x2c2)](_0x450040=>{setAccess(_0x450040);}),logger[_0x4b2b6e(0x184)](_0x4b2b6e(0x274)+_0x5c248a['slice'](-0x8)),setTokenRefresh(_0x5c248a),setSessionTimeout('login',_0x5c248a));}}else logger[_0x4b2b6e(0x203)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x502a73['on'](_0x4f7f16(0x23b),()=>{resetPassword();}),_0x502a73['on'](_0x4f7f16(0x304),_0x4b7e91=>{removeClient(_0x502a73['id']);}),_0x7d57f3==_0x4f7f16(0x2b6)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x17b58b){const _0x3b8902=_0x59e1df;if(_0x17b58b!=_0x3b8902(0x2b6)&&config['apiKey']!=''){if(pid[_0x17b58b])pid[_0x17b58b][_0x3b8902(0x1e1)]({'function':_0x3b8902(0x2c1),'args':null});}_0x17b58b!=_0x3b8902(0x2b6)&&broadcastToBots('bots',JSON[_0x3b8902(0x1d2)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0xe97324=>{const _0x3a0447=_0x4818;getSocket(_0xe97324['id'])['emit'](_0x3a0447(0x1c2),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x388736){const _0x12d6ad=_0x59e1df;return io[_0x12d6ad(0x220)][_0x12d6ad(0x220)][_0x12d6ad(0x22b)](_0x388736);}function setAccess(_0x519741){const _0xfa7c21=_0x59e1df,_0x4cfac5=getSocket(_0x519741['id']),_0x4ef8a2=_0x519741[_0xfa7c21(0x205)],_0x217e17=_0x519741['bot'];devices[_0x4ef8a2]['access']=validateAccess(devices[_0x4ef8a2][_0xfa7c21(0x271)][_0xfa7c21(0x286)],_0x4ef8a2),logger[_0xfa7c21(0x184)](_0xfa7c21(0x2a4)+devices[_0x4ef8a2][_0xfa7c21(0x271)]['reason']+_0xfa7c21(0x21f)+_0x519741['id']['slice'](-0x8)+_0xfa7c21(0x1fc)+_0x4ef8a2['slice'](-0x8)),_0x4cfac5[_0xfa7c21(0x2d7)](_0x4ef8a2);if(devices[_0x4ef8a2]['access'][_0xfa7c21(0x19b)]){_0x4cfac5['join'](_0x217e17);if(_0x217e17=='botmanager')initializeSocketBotManager(_0x4cfac5);else initializeSocketBot(_0x4cfac5);initClient(_0x217e17);}devices[_0x4ef8a2]['access'][_0xfa7c21(0x286)]&&devices[_0x4ef8a2]['access'][_0xfa7c21(0x1d1)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0xfa7c21(0x193),_0x4ef8a2),devices[_0x4ef8a2][_0xfa7c21(0x271)][_0xfa7c21(0x286)]&&devices[_0x4ef8a2]['access'][_0xfa7c21(0x1d1)]==_0xfa7c21(0x2a6)&&setSessionTimeout(_0xfa7c21(0x2b9),_0x4ef8a2),_0x4cfac5[_0xfa7c21(0x238)]('status',{'status':_0x519741[_0xfa7c21(0x1cf)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4ef8a2][_0xfa7c21(0x271)],'externalip':devices[_0x4ef8a2]['ip'],'publicKey':secure[_0xfa7c21(0x2f8)],'userid':settings[_0xfa7c21(0x28b)],'validInstallation':validInstallation}),devices[_0x4ef8a2]['access'][_0xfa7c21(0x19b)]==![]&&devices[_0x4ef8a2][_0xfa7c21(0x271)][_0xfa7c21(0x1d1)]==_0xfa7c21(0x2ff)&&temporaryAccess2FA(_0x4ef8a2,devices[_0x4ef8a2]['ip']);}function setSessionTimeout(_0x4443e6,_0x4de42e){const _0x4fc0ad=_0x59e1df;let _0x47f725;if(_0x4443e6=='login')_0x47f725=loginExpiry*0x3c*0x3e8;else _0x47f725=devices[_0x4de42e]['telegramIpApproval'][_0x4fc0ad(0x1db)]*0x3c*0x3e8-(new Date()[_0x4fc0ad(0x2c6)]()-devices[_0x4de42e]['telegramIpApproval']['timestamp']);if(devices[_0x4de42e][_0x4fc0ad(0x17d)])clearTimeout(devices[_0x4de42e][_0x4fc0ad(0x17d)]);devices[_0x4de42e][_0x4fc0ad(0x17d)]=setTimeout(()=>{const _0x311656=_0x4fc0ad;if(devices[_0x4de42e][_0x311656(0x18d)])clearTimeout(devices[_0x4de42e][_0x311656(0x18d)]);removeSocketListeners(_0x4de42e),addBlacklist(_0x4de42e),devices[_0x4de42e]['telegramIpApproval']=null,devices[_0x4de42e]['telegram2FaApproval']=null,devices[_0x4de42e][_0x311656(0x271)][_0x311656(0x286)]=null,logger[_0x311656(0x184)]('Session\x20expired\x20for\x20user\x20...'+_0x4de42e['slice'](-0x8)),devices[_0x4de42e]['access']=validateAccess(devices[_0x4de42e]['access'][_0x311656(0x286)],_0x4de42e),!(devices[_0x4de42e][_0x311656(0x271)]['allow']&&devices[_0x4de42e][_0x311656(0x271)][_0x311656(0x1d1)]=='login\x20not\x20required')&&(_0x4443e6==_0x311656(0x2b9)?io['to'](_0x4de42e)[_0x311656(0x238)](_0x311656(0x1c2),{'access':{'allow':![],'reason':_0x311656(0x188),'token':null}}):io['to'](_0x4de42e)[_0x311656(0x238)](_0x311656(0x1c2),{'access':{'allow':![],'reason':_0x311656(0x148),'token':null}})),devices[_0x4de42e][_0x311656(0x271)][_0x311656(0x286)]=null;},_0x47f725);}function setTokenRefresh(_0x50764e){const _0x1d86e6=_0x59e1df;if(devices[_0x50764e][_0x1d86e6(0x18d)])clearTimeout(devices[_0x50764e][_0x1d86e6(0x18d)]);devices[_0x50764e]['pidRefreshToken']=setTimeout(()=>{const _0x242860=_0x1d86e6;getClientsWithUuid(_0x50764e)[_0x242860(0x26c)]!=0x0?(devices[_0x50764e][_0x242860(0x271)]=refreshToken(_0x50764e),io['to'](_0x50764e)[_0x242860(0x238)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x50764e][_0x242860(0x271)],'externalip':devices[_0x50764e]['ip'],'publicKey':secure[_0x242860(0x2f8)],'validInstallation':validInstallation}),setTokenRefresh(_0x50764e)):clearTimeout(devices[_0x50764e][_0x242860(0x18d)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x27abda){const _0x32a470=_0x59e1df,_0x1db8a0=getClient(_0x27abda['id'])['uuid'];_0x27abda['emit'](_0x32a470(0x1b9),config),_0x27abda['emit'](_0x32a470(0x18f),cleanSettings()),_0x27abda['on'](_0x32a470(0x1ea),_0x471b40=>{const _0x564ab6=_0x32a470;if(validateAccess(_0x471b40,_0x1db8a0)[_0x564ab6(0x19b)])addBot();else logger[_0x564ab6(0x203)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x27abda['on'](_0x32a470(0x259),(_0x16a89a,_0x2f7ed8)=>{const _0x162730=_0x32a470;if(validateAccess(_0x2f7ed8,_0x1db8a0)[_0x162730(0x19b)])toggleBot(_0x16a89a[_0x162730(0x1a6)],_0x16a89a[_0x162730(0x1c2)],_0x16a89a[_0x162730(0x2d5)]);else logger[_0x162730(0x203)](_0x162730(0x2b5));}),_0x27abda['on'](_0x32a470(0x257),(_0xc0bd3d,_0x31e7ce)=>{const _0x4ce9a8=_0x32a470;if(validateAccess(_0x31e7ce,_0x1db8a0)[_0x4ce9a8(0x19b)])toggleBotMode(_0xc0bd3d);else logger[_0x4ce9a8(0x203)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x27abda['on'](_0x32a470(0x14c),(_0x21df5f,_0x5b6020)=>{const _0x3c4bfb=_0x32a470;if(validateAccess(_0x5b6020,_0x1db8a0)[_0x3c4bfb(0x19b)])deleteBot(_0x21df5f);else logger['full'](_0x3c4bfb(0x290));}),_0x27abda['on'](_0x32a470(0x2da),(_0x2770cd,_0x2dad36)=>{const _0x4d04a0=_0x32a470;if(validateAccess(_0x2dad36,_0x1db8a0)[_0x4d04a0(0x19b)])storeSettings(_0x2770cd,!![]);else logger[_0x4d04a0(0x203)](_0x4d04a0(0x1bf));}),_0x27abda['on'](_0x32a470(0x21b),_0x840ace=>{const _0x3dd548=_0x32a470;if(validateAccess(_0x840ace,_0x1db8a0)[_0x3dd548(0x19b)])updateBB(_0x3dd548(0x2e4));else logger[_0x3dd548(0x203)](_0x3dd548(0x15d));}),_0x27abda['on']('reinstall-bb',_0x4fae17=>{const _0x515abf=_0x32a470;if(validateAccess(_0x4fae17,_0x1db8a0)[_0x515abf(0x19b)])updateBB(_0x515abf(0x21a));else logger[_0x515abf(0x203)](_0x515abf(0x2b4));}),_0x27abda['on'](_0x32a470(0x190),_0xa1f34a=>{const _0x5ca954=_0x32a470;if(validateAccess(_0xa1f34a,_0x1db8a0)[_0x5ca954(0x19b)]){const _0x2c652a=getClient(_0x27abda['id']);if(_0x2c652a)getBackupFiles(_0x2c652a[_0x5ca954(0x205)]);else logger[_0x5ca954(0x203)](_0x5ca954(0x2cf));}else logger[_0x5ca954(0x203)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x27abda['on']('restore-backup-file',(_0x3aa0c4,_0x339639)=>{const _0x20ed6a=_0x32a470;if(validateAccess(_0x339639,_0x1db8a0)[_0x20ed6a(0x19b)])restoreBackupFile(_0x3aa0c4);else logger['full'](_0x20ed6a(0x19c));}),_0x27abda['on'](_0x32a470(0x1d5),_0x3cb27c=>{const _0x2a09a6=_0x32a470;if(validateAccess(_0x3cb27c,_0x1db8a0)[_0x2a09a6(0x19b)])getMessages();else logger['full'](_0x2a09a6(0x17a));}),_0x27abda['on'](_0x32a470(0x195),(_0x515731,_0x16725e)=>{const _0x4b5cf2=_0x32a470;if(validateAccess(_0x16725e,_0x1db8a0)[_0x4b5cf2(0x19b)])confirmMessage(_0x515731);else logger[_0x4b5cf2(0x203)](_0x4b5cf2(0x1d8));}),_0x27abda['on']('logout',_0x207e05=>{const _0x5f12c5=_0x32a470;if(validateAccess(_0x207e05,_0x1db8a0)['allow']){if(devices[_0x1db8a0][_0x5f12c5(0x18d)])clearTimeout(devices[_0x1db8a0]['pidRefreshToken']);if(devices[_0x1db8a0][_0x5f12c5(0x17d)])clearTimeout(devices[_0x1db8a0][_0x5f12c5(0x17d)]);removeSocketListeners(getClient(_0x27abda['id'])[_0x5f12c5(0x205)]),addBlacklist(_0x1db8a0),devices[_0x1db8a0]['telegramIpApproval']=null,devices[_0x1db8a0][_0x5f12c5(0x270)]=null,devices[_0x1db8a0][_0x5f12c5(0x271)][_0x5f12c5(0x286)]=null,logger[_0x5f12c5(0x184)](_0x5f12c5(0x14b)+_0x1db8a0[_0x5f12c5(0x1f2)](-0x8)),io['to'](getClient(_0x27abda['id'])[_0x5f12c5(0x205)])[_0x5f12c5(0x238)](_0x5f12c5(0x1c2),{'access':{'allow':![],'reason':_0x5f12c5(0x2d9),'token':null}});}else logger[_0x5f12c5(0x203)](_0x5f12c5(0x2e1));});}function initializeSocketBot(_0xa77d10){const _0xbc855d=_0x59e1df,_0x13e716=getClient(_0xa77d10['id'])[_0xbc855d(0x14f)],_0x5e01e5=getClient(_0xa77d10['id'])['uuid'];_0xa77d10['on'](_0xbc855d(0x1f8),(_0x171078,_0xecb1ad)=>{const _0x3891aa=_0xbc855d;if(validateAccess(_0xecb1ad,_0x5e01e5)[_0x3891aa(0x19b)]){if(pid[_0x13e716])pid[_0x13e716][_0x3891aa(0x1e1)]({'function':'emitHistory','args':_0x171078});}else logger[_0x3891aa(0x203)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0xa77d10['on'](_0xbc855d(0x1f4),(_0x584a55,_0x2e4b64)=>{const _0x1eaa6b=_0xbc855d;if(validateAccess(_0x2e4b64,_0x5e01e5)[_0x1eaa6b(0x19b)]){if(pid[_0x13e716])pid[_0x13e716][_0x1eaa6b(0x1e1)]({'function':_0x1eaa6b(0x17f),'args':_0x584a55});}else logger[_0x1eaa6b(0x203)](_0x1eaa6b(0x1b3));}),_0xa77d10['on'](_0xbc855d(0x2fe),(_0x42934e,_0x57e100)=>{const _0xb1f546=_0xbc855d;if(validateAccess(_0x57e100,_0x5e01e5)[_0xb1f546(0x19b)]){if(pid[_0x13e716])pid[_0x13e716][_0xb1f546(0x1e1)]({'function':_0xb1f546(0x21d),'args':_0x42934e});}else logger[_0xb1f546(0x203)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0xa77d10['on'](_0xbc855d(0x16e),(_0xd36ca8,_0x1a23df)=>{const _0x3c7a33=_0xbc855d;if(validateAccess(_0x1a23df,_0x5e01e5)[_0x3c7a33(0x19b)]){if(pid[_0x13e716])pid[_0x13e716]['send']({'function':_0x3c7a33(0x176),'args':_0xd36ca8});}else logger[_0x3c7a33(0x203)](_0x3c7a33(0x283));}),_0xa77d10['on']('store-headless',(_0x4e3bb6,_0x4e5f56)=>{const _0x37ecbc=_0xbc855d;if(validateAccess(_0x4e5f56,_0x5e01e5)['allow']){if(pid[_0x13e716])pid[_0x13e716][_0x37ecbc(0x1e1)]({'function':_0x37ecbc(0x21e),'args':_0x4e3bb6});}else logger['full'](_0x37ecbc(0x168));}),_0xa77d10['on']('store-fiat',(_0x262a72,_0x1d6add)=>{const _0x85a9e=_0xbc855d;if(validateAccess(_0x1d6add,_0x5e01e5)['allow']){if(pid[_0x13e716])pid[_0x13e716][_0x85a9e(0x1e1)]({'function':_0x85a9e(0x2b3),'args':_0x262a72});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0xa77d10['on'](_0xbc855d(0x142),_0x167955=>{const _0x5538e5=_0xbc855d;if(validateAccess(_0x167955,_0x5e01e5)[_0x5538e5(0x19b)]){if(pid[_0x13e716])pid[_0x13e716]['send']({'function':'resetHistory','args':null});}else logger['full'](_0x5538e5(0x2cc));}),_0xa77d10['on']('get-starting-balances',_0x133fd4=>{const _0x276e3b=_0xbc855d;if(validateAccess(_0x133fd4,_0x5e01e5)[_0x276e3b(0x19b)]){if(pid[_0x13e716])pid[_0x13e716][_0x276e3b(0x1e1)]({'function':'getStartingBalances','args':null});}else logger[_0x276e3b(0x203)](_0x276e3b(0x1d0));}),_0xa77d10['on'](_0xbc855d(0x2e5),(_0x1f5447,_0x97476f)=>{const _0x23eff7=_0xbc855d;if(validateAccess(_0x97476f,_0x5e01e5)['allow']){if(pid[_0x13e716])pid[_0x13e716][_0x23eff7(0x1e1)]({'function':'placeOrder','args':_0x1f5447});}else logger[_0x23eff7(0x203)](_0x23eff7(0x1ed));}),_0xa77d10['on'](_0xbc855d(0x306),_0x1f41df=>{const _0x561bbe=_0xbc855d;if(validateAccess(_0x1f41df,_0x5e01e5)[_0x561bbe(0x19b)]){if(pid[_0x13e716])pid[_0x13e716]['send']({'function':'cancelLoading','args':null});}else logger[_0x561bbe(0x203)](_0x561bbe(0x235));}),_0xa77d10['on'](_0xbc855d(0x182),_0x2e4a7a=>{const _0x104543=_0xbc855d;if(validateAccess(_0x2e4a7a,_0x5e01e5)['allow']){if(pid[_0x13e716])pid[_0x13e716][_0x104543(0x1e1)]({'function':_0x104543(0x155),'args':null});}else logger[_0x104543(0x203)](_0x104543(0x1fd));}),_0xa77d10['on'](_0xbc855d(0x21b),_0x43fe0b=>{const _0x3d829f=_0xbc855d;if(validateAccess(_0x43fe0b,_0x5e01e5)[_0x3d829f(0x19b)])updateBB(_0x3d829f(0x2e4));else logger[_0x3d829f(0x203)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0xa77d10['on'](_0xbc855d(0x1d5),_0x412e14=>{const _0x5720d3=_0xbc855d;if(validateAccess(_0x412e14,_0x5e01e5)[_0x5720d3(0x19b)])getMessages();else logger[_0x5720d3(0x203)](_0x5720d3(0x17a));}),_0xa77d10['on'](_0xbc855d(0x195),(_0x37e44f,_0x37a47c)=>{const _0x2760d4=_0xbc855d;if(validateAccess(_0x37a47c,_0x5e01e5)[_0x2760d4(0x19b)])confirmMessage(_0x37e44f);else logger[_0x2760d4(0x203)](_0x2760d4(0x1d8));}),_0xa77d10['on'](_0xbc855d(0x302),_0x6060e0=>{const _0x52c83a=_0xbc855d;if(validateAccess(_0x6060e0,_0x5e01e5)['allow']){if(devices[_0x5e01e5]['pidRefreshToken'])clearTimeout(devices[_0x5e01e5][_0x52c83a(0x18d)]);if(devices[_0x5e01e5][_0x52c83a(0x17d)])clearTimeout(devices[_0x5e01e5][_0x52c83a(0x17d)]);removeSocketListeners(getClient(_0xa77d10['id'])[_0x52c83a(0x205)]),addBlacklist(_0x5e01e5),devices[_0x5e01e5]['telegramIpApproval']=null,devices[_0x5e01e5][_0x52c83a(0x270)]=null,devices[_0x5e01e5][_0x52c83a(0x271)][_0x52c83a(0x286)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x5e01e5[_0x52c83a(0x1f2)](-0x8)),io['to'](getClient(_0xa77d10['id'])[_0x52c83a(0x205)])[_0x52c83a(0x238)](_0x52c83a(0x1c2),{'access':{'allow':![],'reason':_0x52c83a(0x2d9),'token':null}});}else logger[_0x52c83a(0x203)](_0x52c83a(0x2e1));});}function removeSocketListeners(_0x1535b6){const _0x37ca22=_0x59e1df;getClientsWithUuid(_0x1535b6)[_0x37ca22(0x2c2)](_0x3bbab7=>{getSocket(_0x3bbab7['id'])['removeAllListeners']();});}function cleanSettings(){const _0x21ab86=_0x59e1df;let _0x3c1a74=settings;return settings[_0x21ab86(0x144)]&&settings[_0x21ab86(0x144)]!=''&&(_0x3c1a74={..._0x3c1a74,'telegramToken':_0x21ab86(0x159)}),settings[_0x21ab86(0x137)]&&settings[_0x21ab86(0x137)]!=''&&(_0x3c1a74={..._0x3c1a74,'bbPassword':'************'}),(settings[_0x21ab86(0x137)]&&settings[_0x21ab86(0x137)]==_0x21ab86(0x153)||settings[_0x21ab86(0x144)]&&settings[_0x21ab86(0x144)]==_0x21ab86(0x153))&&(_0x3c1a74={..._0x3c1a74,'restored':{'password':settings[_0x21ab86(0x137)]==_0x21ab86(0x153),'telegram':settings[_0x21ab86(0x144)]==_0x21ab86(0x153)}}),_0x3c1a74;}async function updateBB(_0x35253c){const _0xf28d0c=_0x59e1df;await backupConfigFiles(),installingUpdate=!![],config[_0xf28d0c(0x2c2)](_0x1d5371=>{restartBot(_0x1d5371['botID']);}),logger[_0xf28d0c(0x184)](_0xf28d0c(0x294)+_0x35253c);if(_0x35253c==_0xf28d0c(0x2e4))process['send']({'update':!![]},_0x508a44=>{});else _0x35253c=='reinstall'&&process[_0xf28d0c(0x1e1)]({'reinstall':!![]},_0x59aa7a=>{});}function startBot(_0x21316e,_0x86cd8c,_0x372341){const _0x17ecb4=_0x59e1df;if(debugging)_0x21316e[_0x17ecb4(0x2a8)]('-d');let _0x233726=![];const _0x2a97c6=_0x21316e[0x0];_0x86cd8c={..._0x86cd8c,'stdio':[_0x17ecb4(0x145),_0x17ecb4(0x145),_0x17ecb4(0x145),_0x17ecb4(0x2d8)]},pid[_0x2a97c6]=childProcess[_0x17ecb4(0x2de)](botfile,_0x21316e,_0x86cd8c),pid[_0x2a97c6]['on'](_0x17ecb4(0x1c0),_0x34c286=>{const _0x309a20=_0x17ecb4;switch(Object[_0x309a20(0x22e)](_0x34c286)[0x0]){case _0x309a20(0x222):updateBotName(_0x2a97c6,_0x34c286[_0x309a20(0x222)]);break;case _0x309a20(0x15b):updateBotManager();break;case _0x309a20(0x1c2):updateStatus(_0x2a97c6,_0x34c286[_0x309a20(0x1c2)]);break;case _0x309a20(0x2d5):updateLive(_0x2a97c6,_0x34c286[_0x309a20(0x2d5)]);break;case'started':updateLive(_0x2a97c6,_0x34c286['started']),io['to'](_0x2a97c6)[_0x309a20(0x238)](_0x309a20(0x1c2),{'access':{'allow':![],'reason':_0x309a20(0x1ad),'token':null}});break;case'stop':_0x34c286[_0x309a20(0x20e)]==_0x309a20(0x172)&&restartBot(_0x2a97c6);_0x34c286['stop']==_0x309a20(0x248)&&toggleBot(_0x2a97c6,_0x309a20(0x301),_0x309a20(0x1fb));break;case _0x309a20(0x2bb):sendTelegram(_0x2a97c6,_0x34c286[_0x309a20(0x2bb)]);break;case _0x309a20(0x14a):sendTelegramMsg(_0x34c286[_0x309a20(0x14a)]);break;case _0x309a20(0x178):io['to'](_0x2a97c6)[_0x309a20(0x238)](_0x34c286[_0x309a20(0x178)],_0x34c286['args']);break;}}),pid[_0x2a97c6]['on']('error',function(_0x44f149){if(_0x233726)return;_0x233726=!![],_0x372341(_0x44f149);}),pid[_0x2a97c6]['on'](_0x17ecb4(0x216),async function(_0x4b06cd){const _0x2bd02b=_0x17ecb4;if(installingUpdate)return;if(_0x233726)return;_0x233726=!![],_0x372341(null);const _0xe0d67b=dbConfig[_0x2bd02b(0x22b)](_0x2bd02b(0x1b9))[_0x2bd02b(0x1f5)]({'botID':_0x2a97c6})['value']();_0xe0d67b&&(_0xe0d67b[_0x2bd02b(0x1c2)]=='enabled'||_0xe0d67b[_0x2bd02b(0x1c2)]=='new')&&(await sleep(0x3e8),updateLive(_0x2a97c6,_0x2bd02b(0x1fb)),logger[_0x2bd02b(0x203)](_0x2bd02b(0x2e7)+_0x2a97c6),startBot([_0x2a97c6,userID],{'cwd':bbpath},function(_0x38d5f4){const _0x815f61=_0x2bd02b;if(_0x38d5f4)logger[_0x815f61(0x203)](_0x38d5f4);}));});}function stopBot(_0x1a7451){const _0x497833=_0x59e1df;getClientsWithBotID(_0x1a7451)[_0x497833(0x2c2)](_0x52d990=>{const _0x2a4c91=_0x497833;getSocket(_0x52d990['id'])[_0x2a4c91(0x304)](!![]),removeClient(_0x52d990['id']);}),pid[_0x1a7451]&&(pid[_0x1a7451][_0x497833(0x248)](),pid[_0x1a7451]=null);}function restartBot(_0x2ed3bc){if(pid[_0x2ed3bc])pid[_0x2ed3bc]['kill']();}function addBot(){const _0xdce630=_0x59e1df;let _0x7db6d7;for(let _0x722bbd=0x1;_0x722bbd<0x3e9;_0x722bbd++){_0x7db6d7=_0x722bbd[_0xdce630(0x23e)]()[_0xdce630(0x2e8)](0x3,'0');let _0x4573f3=config[_0xdce630(0x1f5)](_0x7acaa5=>_0x7acaa5[_0xdce630(0x1a6)]==_0x7db6d7);if(!_0x4573f3)break;}if(_0x7db6d7===_0xdce630(0x1a8)){logger[_0xdce630(0x203)](_0xdce630(0x1b8));return;}logger[_0xdce630(0x203)](_0xdce630(0x2c0)+_0x7db6d7),dbConfig['get']('bots')['push']({'botID':_0x7db6d7,'botname':_0xdce630(0x253)+_0x7db6d7,'status':_0xdce630(0x28f),'live':''})['write'](),startBot([_0x7db6d7,userID],{'cwd':bbpath},function(_0x13407b){if(_0x13407b)logger['full'](_0x13407b);}),config=getConfiguration(),io['to'](_0xdce630(0x2b6))['emit'](_0xdce630(0x1b9),config),broadcastToBots('bots',JSON[_0xdce630(0x1d2)](config));}function deleteBot(_0x43d839){const _0x455691=_0x59e1df;getClientsWithBotID(_0x43d839)[_0x455691(0x2c2)](_0x35ec60=>{const _0x2edaa6=_0x455691;getSocket(_0x35ec60['id'])[_0x2edaa6(0x304)](!![]),removeClient(_0x35ec60['id']);}),dbConfig['get'](_0x455691(0x1b9))['remove']({'botID':_0x43d839})['write'](),logger['full'](_0x455691(0x169)+_0x43d839),stopBot(_0x43d839);try{if(fs[_0x455691(0x25c)](path[_0x455691(0x2d7)](configpath,_0x455691(0x154)+_0x43d839+'-config.json')))fs[_0x455691(0x212)](path[_0x455691(0x2d7)](configpath,_0x455691(0x154)+_0x43d839+_0x455691(0x207)));if(fs[_0x455691(0x25c)](path['join'](configpath,'bot-'+_0x43d839+'-events.json')))fs['unlinkSync'](path['join'](configpath,_0x455691(0x154)+_0x43d839+_0x455691(0x236)));if(fs[_0x455691(0x25c)](path[_0x455691(0x2d7)](configpath,_0x455691(0x154)+_0x43d839+_0x455691(0x279))))fs[_0x455691(0x212)](path[_0x455691(0x2d7)](configpath,'bot-'+_0x43d839+'-performance.json'));if(fs[_0x455691(0x25c)](path[_0x455691(0x2d7)](configpath,_0x455691(0x154)+_0x43d839+_0x455691(0x20f))))fs[_0x455691(0x212)](path[_0x455691(0x2d7)](configpath,_0x455691(0x154)+_0x43d839+_0x455691(0x20f)));}catch(_0x6133ee){if(_0x6133ee)logger[_0x455691(0x203)](_0x455691(0x2e2),_0x6133ee);}config=getConfiguration(),io['to'](_0x455691(0x2b6))[_0x455691(0x238)]('bots',config),broadcastToBots(_0x455691(0x1b9),JSON['stringify'](config));}function toggleBot(_0x47b689,_0x434fe1,_0x4471cf){const _0x139fbb=_0x59e1df;dbConfig[_0x139fbb(0x22b)](_0x139fbb(0x1b9))['find']({'botID':_0x47b689})[_0x139fbb(0x1e8)]({'status':_0x434fe1})['assign']({'live':_0x4471cf})[_0x139fbb(0x22d)]();if(_0x434fe1==_0x139fbb(0x25a)||_0x434fe1==_0x139fbb(0x28f))logger[_0x139fbb(0x203)](_0x139fbb(0x2c3)+_0x47b689),startBot([_0x47b689,userID],{'cwd':bbpath},function(_0x4e12f7){const _0xc67572=_0x139fbb;if(_0x4e12f7)logger[_0xc67572(0x203)](_0x4e12f7);});else(_0x434fe1==_0x139fbb(0x301)||_0x434fe1==_0x139fbb(0x228))&&(logger[_0x139fbb(0x203)]('Disabled\x20Bot\x20'+_0x47b689),stopBot(_0x47b689));config=getConfiguration(),io['to'](_0x139fbb(0x2b6))[_0x139fbb(0x238)](_0x139fbb(0x1b9),config),broadcastToBots(_0x139fbb(0x1b9),JSON[_0x139fbb(0x1d2)](config));}function toggleStatus(_0x31fccb){const _0x70acb0=_0x59e1df;let _0x22404a=dbConfig[_0x70acb0(0x22b)](_0x70acb0(0x1b9))[_0x70acb0(0x1f5)]({'botID':_0x31fccb})[_0x70acb0(0x24a)](),_0x160413;if(_0x22404a[_0x70acb0(0x1c2)]===_0x70acb0(0x25a))_0x160413=_0x70acb0(0x301);else{if(_0x22404a['status']===_0x70acb0(0x28f))_0x160413=_0x70acb0(0x228);else{if(_0x22404a[_0x70acb0(0x1c2)]===_0x70acb0(0x228))_0x160413=_0x70acb0(0x28f);else{if(_0x22404a[_0x70acb0(0x1c2)]===_0x70acb0(0x301))_0x160413=_0x70acb0(0x25a);}}}return _0x160413;}function updateStatus(_0x5d1b91,_0x28fa98){const _0x3a05d9=_0x59e1df;dbConfig['get']('bots')[_0x3a05d9(0x1f5)]({'botID':_0x5d1b91})[_0x3a05d9(0x1e8)]({'status':_0x28fa98})['write'](),config=getConfiguration(),io['to'](_0x3a05d9(0x2b6))[_0x3a05d9(0x238)](_0x3a05d9(0x1b9),config),broadcastToBots(_0x3a05d9(0x1b9),JSON[_0x3a05d9(0x1d2)](config));}function updateLive(_0xd609c9,_0x1db03d){const _0x355a49=_0x59e1df;dbConfig[_0x355a49(0x22b)](_0x355a49(0x1b9))[_0x355a49(0x1f5)]({'botID':_0xd609c9})[_0x355a49(0x1e8)]({'live':_0x1db03d})[_0x355a49(0x22d)](),config=getConfiguration(),io['to'](_0x355a49(0x2b6))[_0x355a49(0x238)]('bots',config),broadcastToBots('bots',JSON[_0x355a49(0x1d2)](config));}function updateBotName(_0xebc7d5,_0x556a3b){const _0x1212a4=_0x59e1df;dbConfig[_0x1212a4(0x22b)](_0x1212a4(0x1b9))[_0x1212a4(0x1f5)]({'botID':_0xebc7d5})[_0x1212a4(0x1e8)]({'botname':_0x556a3b})[_0x1212a4(0x22d)](),config=getConfiguration(),io['to'](_0x1212a4(0x2b6))[_0x1212a4(0x238)]('bots',config),broadcastToBots(_0x1212a4(0x1b9),JSON[_0x1212a4(0x1d2)](config));}function updateBotManager(){const _0x35a5ea=_0x59e1df;config=getConfiguration(),io['to'](_0x35a5ea(0x2b6))['emit'](_0x35a5ea(0x1b9),config),broadcastToBots(_0x35a5ea(0x1b9),JSON[_0x35a5ea(0x1d2)](config));}function toggleBotMode(_0x34d805){const _0x2558de=_0x59e1df;if(pid[_0x34d805])pid[_0x34d805][_0x2558de(0x1e1)]({'function':_0x2558de(0x224),'args':null});else{const _0xaaffea=configpath+_0x2558de(0x154)+_0x34d805+'-config.json',_0x2c4a7a=fs['readFileSync'](_0xaaffea),_0x13af65=JSON[_0x2558de(0x23c)](_0x2c4a7a),_0x3f532f=_0x13af65['bot'][0x0][_0x2558de(0x2c5)];_0x13af65['bot'][0x0]['headless']=!_0x3f532f;const _0x1606c4=JSON[_0x2558de(0x1d2)](_0x13af65,null,0x2);fs[_0x2558de(0x241)](_0xaaffea,_0x1606c4),config=getConfiguration(),io['to']('botmanager')[_0x2558de(0x238)]('bots',config),broadcastToBots(_0x2558de(0x1b9),JSON[_0x2558de(0x1d2)](config));}}function telegramError(_0x1ed31a){const _0x41c45e=_0x59e1df;logger[_0x41c45e(0x194)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x473eea){const _0x2ae7aa=_0x59e1df;if(_0x473eea[_0x2ae7aa(0x17e)]['username']!=settings['telegramUsername']&&'@'+_0x473eea['from'][_0x2ae7aa(0x2ce)]!=settings[_0x2ae7aa(0x262)])return tgBot['sendMessage'](_0x473eea[_0x2ae7aa(0x247)]['id'],_0x2ae7aa(0x199),{'parse_mode':_0x2ae7aa(0x300)})[_0x2ae7aa(0x1cb)](_0x3edb02=>{telegramError(_0x3edb02);}),![];return!![];}async function initTelegram(){const _0x442194=_0x59e1df;if(tgBot)tgBot[_0x442194(0x183)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x4434b7=_0x442194(0x214);_0x4434b7+='\x0a',_0x4434b7+=_0x442194(0x1b5),_0x4434b7+='/disable\x20-\x20disable\x20notifications\x0a',_0x4434b7+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4434b7+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x4434b7+='/on\x20-\x20start\x20bot(s)\x0a',_0x4434b7+=_0x442194(0x146),_0x4434b7+=_0x442194(0x140),_0x4434b7+=_0x442194(0x2bd),_0x4434b7+=_0x442194(0x2bf),_0x4434b7+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x4434b7+=_0x442194(0x230),_0x4434b7+=_0x442194(0x1e0),_0x4434b7+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x4434b7+=_0x442194(0x280);let _0x42173f=_0x442194(0x2aa);_0x42173f+='\x0a',_0x42173f+=_0x4434b7,tgBot[_0x442194(0x20c)](/\/start/,_0x4de69f=>{const _0x258958=_0x442194;if(!validateTelegram(_0x4de69f))return;if(settings[_0x258958(0x215)]!=_0x4de69f[_0x258958(0x247)]['id'])updateSetting('telegramChatId',_0x4de69f[_0x258958(0x247)]['id']);updateSetting(_0x258958(0x2a3),!![]),tgBot[_0x258958(0x162)](_0x4de69f[_0x258958(0x247)]['id'],_0x42173f)[_0x258958(0x1cb)](_0x1ce855=>{telegramError(_0x1ce855);});}),tgBot['onText'](/\/enable/,_0x479374=>{const _0x639ed9=_0x442194;if(!validateTelegram(_0x479374))return;if(settings[_0x639ed9(0x215)]!=_0x479374[_0x639ed9(0x247)]['id'])updateSetting(_0x639ed9(0x215),_0x479374[_0x639ed9(0x247)]['id']);updateSetting(_0x639ed9(0x2a3),!![]),tgBot[_0x639ed9(0x162)](_0x479374[_0x639ed9(0x247)]['id'],'Notifications\x20enabled')[_0x639ed9(0x1cb)](_0x3b4c14=>{telegramError(_0x3b4c14);});}),tgBot[_0x442194(0x20c)](/\/config/,async _0x1d2601=>{const _0x5db841=_0x442194;if(!validateTelegram(_0x1d2601))return;tgBot[_0x5db841(0x187)]('callback_query'),tgBot[_0x5db841(0x162)](_0x1d2601['chat']['id'],_0x5db841(0x2d1),{'reply_markup':{'inline_keyboard':[[{'text':_0x5db841(0x209),'callback_data':'orders'},{'text':_0x5db841(0x15f),'callback_data':'alerts'},{'text':_0x5db841(0x27c),'callback_data':_0x5db841(0x28a)}]]}})['catch'](_0x35bae6=>{telegramError(_0x35bae6);}),tgBot['on'](_0x5db841(0x1fe),async _0x5473ab=>{const _0x496ad9=_0x5db841,_0x37260c=_0x5473ab[_0x496ad9(0x269)],_0x2c3ea4=_0x5473ab[_0x496ad9(0x1c0)];tgBot[_0x496ad9(0x13b)](_0x5473ab['id'])[_0x496ad9(0x267)](async()=>{const _0x4d3bb8=_0x496ad9;_0x37260c=='orders'&&(updateSetting(_0x4d3bb8(0x2ec),_0x4d3bb8(0x1f6)),updateSetting('telegramEnabled',!![]),await tgBot[_0x4d3bb8(0x162)](_0x2c3ea4[_0x4d3bb8(0x247)]['id'],_0x4d3bb8(0x14e))['catch'](_0x139160=>{telegramError(_0x139160);}));_0x37260c==_0x4d3bb8(0x170)&&(updateSetting(_0x4d3bb8(0x2ec),_0x4d3bb8(0x170)),updateSetting(_0x4d3bb8(0x2a3),!![]),await tgBot['sendMessage'](_0x2c3ea4[_0x4d3bb8(0x247)]['id'],_0x4d3bb8(0x291))[_0x4d3bb8(0x1cb)](_0x4de788=>{telegramError(_0x4de788);}));_0x37260c==_0x4d3bb8(0x28a)&&(updateSetting(_0x4d3bb8(0x2ec),_0x4d3bb8(0x28a)),updateSetting(_0x4d3bb8(0x2a3),!![]),await tgBot['sendMessage'](_0x2c3ea4['chat']['id'],_0x4d3bb8(0x18b))[_0x4d3bb8(0x1cb)](_0x566e31=>{telegramError(_0x566e31);}));if(!settings[_0x4d3bb8(0x215)])tgBot[_0x4d3bb8(0x162)](_0x2c3ea4[_0x4d3bb8(0x247)]['id'],_0x4d3bb8(0x272))[_0x4d3bb8(0x1cb)](_0x55c129=>{telegramError(_0x55c129);});}),tgBot[_0x496ad9(0x187)](_0x496ad9(0x1fe));});}),tgBot[_0x442194(0x20c)](/\/status/,_0x525920=>{const _0x387524=_0x442194;if(!validateTelegram(_0x525920))return;const _0x478196=getBotsWithMode();let _0x3c27f4=_0x387524(0x1c9);config[_0x387524(0x2c2)](_0x2ed25b=>{const _0x543846=_0x387524,_0x8d167e=_0x478196[_0x543846(0x1f5)](_0x27998e=>_0x27998e[_0x543846(0x1a6)]==_0x2ed25b['botID'])[_0x543846(0x141)];_0x3c27f4+=_0x543846(0x253)+_0x2ed25b[_0x543846(0x1a6)]+':\x20'+_0x2ed25b[_0x543846(0x1c2)]+_0x543846(0x287)+_0x8d167e+'\x20|\x20'+_0x2ed25b[_0x543846(0x2d5)]+'\x0a';}),_0x3c27f4+='\x0a',_0x3c27f4+=_0x387524(0x2cd),_0x3c27f4+=!settings[_0x387524(0x2a3)]?_0x387524(0x27d):_0x387524(0x210),_0x3c27f4+=settings[_0x387524(0x2a3)]?settings[_0x387524(0x2ec)]==_0x387524(0x28a)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x387524(0x1a3)+settings[_0x387524(0x2ec)]+_0x387524(0x1e4):'',tgBot[_0x387524(0x162)](_0x525920[_0x387524(0x247)]['id'],_0x3c27f4,{'parse_mode':_0x387524(0x300)})[_0x387524(0x1cb)](_0x283ad8=>{telegramError(_0x283ad8);});}),tgBot[_0x442194(0x20c)](/\/restart/,_0x3281f0=>{const _0xa8690c=_0x442194;if(!validateTelegram(_0x3281f0))return;tgBot[_0xa8690c(0x187)]('callback_query');const _0x58d707=getEnabledBots();if(_0x58d707[_0xa8690c(0x26c)]==0x0)tgBot[_0xa8690c(0x162)](_0x3281f0[_0xa8690c(0x247)]['id'],_0xa8690c(0x2d3))[_0xa8690c(0x1cb)](_0xa080b8=>{telegramError(_0xa080b8);});else{if(_0x58d707['length']>0x1)_0x58d707[_0xa8690c(0x2a8)]({'botID':_0xa8690c(0x28a)});let _0x4bf8de=[],_0x5162eb=[];const _0x46d9db=_0x58d707[_0xa8690c(0x26c)]%0x4==0x0||_0x58d707['length']%0x4==0x3||_0x58d707[_0xa8690c(0x26c)]%0x3==0x1?0x4:0x3;let _0x13527e=0x0;_0x58d707[_0xa8690c(0x2c2)]((_0x516c7b,_0x539c39)=>{const _0x507847=_0xa8690c;if(_0x539c39%_0x46d9db==0x0)_0x5162eb=[];_0x5162eb[_0x507847(0x2a8)]({'text':_0x516c7b[_0x507847(0x1a6)]==_0x507847(0x28a)?_0x507847(0x2b1):_0x507847(0x253)+_0x516c7b[_0x507847(0x1a6)],'callback_data':_0x516c7b[_0x507847(0x1a6)]}),_0x539c39%_0x46d9db==0x0&&(_0x4bf8de[_0x13527e]=_0x5162eb,_0x13527e++);}),tgBot[_0xa8690c(0x162)](_0x3281f0[_0xa8690c(0x247)]['id'],_0xa8690c(0x2d6),{'reply_markup':{'inline_keyboard':_0x4bf8de}})[_0xa8690c(0x1cb)](_0x62e4ba=>{telegramError(_0x62e4ba);}),tgBot['on']('callback_query',async _0x45f78b=>{const _0x620391=_0xa8690c,_0x5d388c=_0x45f78b[_0x620391(0x269)],_0x1f23b6=_0x45f78b[_0x620391(0x1c0)];tgBot[_0x620391(0x13b)](_0x45f78b['id'])['then'](async()=>{const _0x450001=_0x620391;_0x5d388c==_0x450001(0x28a)?config[_0x450001(0x2c2)](_0x37a20d=>{restartBot(_0x37a20d['botID']);}):restartBot(_0x5d388c);}),tgBot['removeListener'](_0x620391(0x1fe));});}}),tgBot[_0x442194(0x20c)](/\/on/,_0xf335a7=>{const _0x127376=_0x442194;if(!validateTelegram(_0xf335a7))return;tgBot['removeListener'](_0x127376(0x1fe));const _0x328463=getDisabledBots();if(_0x328463[_0x127376(0x26c)]==0x0)tgBot[_0x127376(0x162)](_0xf335a7['chat']['id'],_0x127376(0x1d6))[_0x127376(0x1cb)](_0x4dd1e9=>{telegramError(_0x4dd1e9);});else{if(_0x328463[_0x127376(0x26c)]>0x1)_0x328463['push']({'botID':'all'});let _0x53bb08=[],_0x9f9af3=[];const _0x529b56=_0x328463[_0x127376(0x26c)]%0x4==0x0||_0x328463[_0x127376(0x26c)]%0x4==0x3||_0x328463[_0x127376(0x26c)]%0x3==0x1?0x4:0x3;let _0x4117fe=0x0;_0x328463[_0x127376(0x2c2)]((_0x43731b,_0x4a8370)=>{const _0x5464e0=_0x127376;if(_0x4a8370%_0x529b56==0x0)_0x9f9af3=[];_0x9f9af3[_0x5464e0(0x2a8)]({'text':_0x43731b['botID']==_0x5464e0(0x28a)?_0x5464e0(0x2b1):_0x5464e0(0x253)+_0x43731b[_0x5464e0(0x1a6)],'callback_data':_0x43731b['botID']}),_0x4a8370%_0x529b56==0x0&&(_0x53bb08[_0x4117fe]=_0x9f9af3,_0x4117fe++);}),tgBot[_0x127376(0x162)](_0xf335a7[_0x127376(0x247)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x53bb08}})[_0x127376(0x1cb)](_0x45ba42=>{telegramError(_0x45ba42);}),tgBot['on'](_0x127376(0x1fe),async _0x158a70=>{const _0x31ef6a=_0x127376,_0x5288e9=_0x158a70['data'],_0x23dc24=_0x158a70[_0x31ef6a(0x1c0)];tgBot['answerCallbackQuery'](_0x158a70['id'])[_0x31ef6a(0x267)](async()=>{const _0x4b1535=_0x31ef6a;_0x5288e9=='all'?(tgBot[_0x4b1535(0x162)](_0x23dc24[_0x4b1535(0x247)]['id'],_0x4b1535(0x2af))[_0x4b1535(0x1cb)](_0x4e5d38=>{telegramError(_0x4e5d38);}),_0x328463[_0x4b1535(0x2c2)](_0x58247c=>{const _0xcdb59f=_0x4b1535;if(_0x58247c[_0xcdb59f(0x1a6)]!=_0xcdb59f(0x28a))toggleBot(_0x58247c['botID'],toggleStatus(_0x58247c[_0xcdb59f(0x1a6)]),_0xcdb59f(0x1fb));})):(tgBot[_0x4b1535(0x162)](_0x23dc24[_0x4b1535(0x247)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x5288e9)[_0x4b1535(0x1cb)](_0xa2eefa=>{telegramError(_0xa2eefa);}),toggleBot(_0x5288e9,toggleStatus(_0x5288e9),_0x4b1535(0x1fb)));}),tgBot['removeListener'](_0x31ef6a(0x1fe));});}}),tgBot['onText'](/\/off/,_0x47c91c=>{const _0x571a8d=_0x442194;if(!validateTelegram(_0x47c91c))return;tgBot['removeListener'](_0x571a8d(0x1fe));const _0x247f49=getEnabledBots();if(_0x247f49[_0x571a8d(0x26c)]==0x0)tgBot['sendMessage'](_0x47c91c[_0x571a8d(0x247)]['id'],_0x571a8d(0x2d3))[_0x571a8d(0x1cb)](_0x4384ec=>{telegramError(_0x4384ec);});else{if(_0x247f49[_0x571a8d(0x26c)]>0x1)_0x247f49[_0x571a8d(0x2a8)]({'botID':'all'});let _0x5b3ef6=[],_0x3ba0c7=[];const _0x33a236=_0x247f49['length']%0x4==0x0||_0x247f49[_0x571a8d(0x26c)]%0x4==0x3||_0x247f49['length']%0x3==0x1?0x4:0x3;let _0x5addfa=0x0;_0x247f49['forEach']((_0x460a25,_0x5c27f5)=>{const _0x4d547a=_0x571a8d;if(_0x5c27f5%_0x33a236==0x0)_0x3ba0c7=[];_0x3ba0c7['push']({'text':_0x460a25[_0x4d547a(0x1a6)]=='all'?_0x4d547a(0x2b1):_0x4d547a(0x253)+_0x460a25['botID'],'callback_data':_0x460a25[_0x4d547a(0x1a6)]}),_0x5c27f5%_0x33a236==0x0&&(_0x5b3ef6[_0x5addfa]=_0x3ba0c7,_0x5addfa++);}),tgBot[_0x571a8d(0x162)](_0x47c91c[_0x571a8d(0x247)]['id'],_0x571a8d(0x2f0),{'reply_markup':{'inline_keyboard':_0x5b3ef6}})[_0x571a8d(0x1cb)](_0x48bd0a=>{telegramError(_0x48bd0a);}),tgBot['on']('callback_query',async _0x317653=>{const _0x4316f5=_0x571a8d,_0x34957b=_0x317653[_0x4316f5(0x269)],_0x3b261c=_0x317653[_0x4316f5(0x1c0)];tgBot[_0x4316f5(0x13b)](_0x317653['id'])[_0x4316f5(0x267)](async()=>{const _0x494c89=_0x4316f5;_0x34957b=='all'?(tgBot[_0x494c89(0x162)](_0x3b261c[_0x494c89(0x247)]['id'],_0x494c89(0x2c7))[_0x494c89(0x1cb)](_0x14f0ff=>{telegramError(_0x14f0ff);}),_0x247f49[_0x494c89(0x2c2)](_0x4a97c8=>{const _0x8de44b=_0x494c89;if(_0x4a97c8[_0x8de44b(0x1a6)]!=_0x8de44b(0x28a))toggleBot(_0x4a97c8['botID'],toggleStatus(_0x4a97c8[_0x8de44b(0x1a6)]),'stopped');})):(tgBot[_0x494c89(0x162)](_0x3b261c[_0x494c89(0x247)]['id'],_0x494c89(0x1da)+_0x34957b)[_0x494c89(0x1cb)](_0x18fc86=>{telegramError(_0x18fc86);}),toggleBot(_0x34957b,toggleStatus(_0x34957b),_0x494c89(0x1fb)));}),tgBot[_0x4316f5(0x187)](_0x4316f5(0x1fe));});}}),tgBot[_0x442194(0x20c)](/\/metrics/,_0x2249ea=>{const _0x53aa45=_0x442194;if(!validateTelegram(_0x2249ea))return;tgBot['removeListener'](_0x53aa45(0x1fe));const _0x4d2e7f=getEnabledBots();if(_0x4d2e7f[_0x53aa45(0x26c)]==0x0)tgBot[_0x53aa45(0x162)](_0x2249ea[_0x53aa45(0x247)]['id'],_0x53aa45(0x2d3))[_0x53aa45(0x1cb)](_0x427993=>{telegramError(_0x427993);});else{if(_0x4d2e7f[_0x53aa45(0x26c)]>0x1){let _0x5db5f7=[],_0x15c73b=[];const _0x5a3c7c=_0x4d2e7f[_0x53aa45(0x26c)]%0x4==0x0||_0x4d2e7f['length']%0x4==0x3||_0x4d2e7f['length']%0x3==0x1?0x4:0x3;let _0x20a3a5=0x0;_0x4d2e7f[_0x53aa45(0x2c2)]((_0x25241a,_0xab28d1)=>{const _0x2aa6d5=_0x53aa45;if(_0xab28d1%_0x5a3c7c==0x0)_0x15c73b=[];_0x15c73b['push']({'text':_0x2aa6d5(0x253)+_0x25241a[_0x2aa6d5(0x1a6)],'callback_data':_0x25241a['botID']}),_0xab28d1%_0x5a3c7c==0x0&&(_0x5db5f7[_0x20a3a5]=_0x15c73b,_0x20a3a5++);}),tgBot[_0x53aa45(0x162)](_0x2249ea[_0x53aa45(0x247)]['id'],_0x53aa45(0x213),{'reply_markup':{'inline_keyboard':_0x5db5f7}})[_0x53aa45(0x1cb)](_0x1372b0=>{telegramError(_0x1372b0);}),tgBot['on']('callback_query',async _0xbfe066=>{const _0x4f2ece=_0x53aa45,_0x1fa820=_0xbfe066[_0x4f2ece(0x269)],_0x2ce22d=_0xbfe066[_0x4f2ece(0x1c0)];tgBot[_0x4f2ece(0x13b)](_0xbfe066['id'])[_0x4f2ece(0x267)](async()=>{const _0x3979d2=_0x4f2ece;if(pid[_0x1fa820])pid[_0x1fa820]['send']({'function':_0x3979d2(0x1f0),'args':null});}),tgBot[_0x4f2ece(0x187)](_0x4f2ece(0x1fe));});}else{const _0x1bbfe1=_0x4d2e7f[0x0][_0x53aa45(0x1a6)];if(pid[_0x1bbfe1])pid[_0x1bbfe1][_0x53aa45(0x1e1)]({'function':_0x53aa45(0x1f0),'args':null});}}}),tgBot[_0x442194(0x20c)](/\/portfolio/,_0x5953a4=>{const _0x3d1fd5=_0x442194;if(!validateTelegram(_0x5953a4))return;tgBot[_0x3d1fd5(0x187)]('callback_query');const _0x522dcb=getEnabledBots();if(_0x522dcb[_0x3d1fd5(0x26c)]==0x0)tgBot['sendMessage'](_0x5953a4[_0x3d1fd5(0x247)]['id'],_0x3d1fd5(0x2d3))[_0x3d1fd5(0x1cb)](_0x5166de=>{telegramError(_0x5166de);});else{if(_0x522dcb[_0x3d1fd5(0x26c)]>0x1){let _0x58e931=[],_0x493db6=[];const _0x38eae7=_0x522dcb[_0x3d1fd5(0x26c)]%0x4==0x0||_0x522dcb['length']%0x4==0x3||_0x522dcb[_0x3d1fd5(0x26c)]%0x3==0x1?0x4:0x3;let _0x48dad2=0x0;_0x522dcb[_0x3d1fd5(0x2c2)]((_0x1f0d2c,_0xb84962)=>{const _0x221d90=_0x3d1fd5;if(_0xb84962%_0x38eae7==0x0)_0x493db6=[];_0x493db6[_0x221d90(0x2a8)]({'text':'Bot\x20'+_0x1f0d2c[_0x221d90(0x1a6)],'callback_data':_0x1f0d2c['botID']}),_0xb84962%_0x38eae7==0x0&&(_0x58e931[_0x48dad2]=_0x493db6,_0x48dad2++);}),tgBot[_0x3d1fd5(0x162)](_0x5953a4[_0x3d1fd5(0x247)]['id'],_0x3d1fd5(0x1af),{'reply_markup':{'inline_keyboard':_0x58e931}})[_0x3d1fd5(0x1cb)](_0x15a5d4=>{telegramError(_0x15a5d4);}),tgBot['on'](_0x3d1fd5(0x1fe),async _0x3fb1e8=>{const _0x1ffa33=_0x3d1fd5,_0x464ae0=_0x3fb1e8[_0x1ffa33(0x269)],_0x2ba08e=_0x3fb1e8['message'];tgBot[_0x1ffa33(0x13b)](_0x3fb1e8['id'])[_0x1ffa33(0x267)](async()=>{const _0x24c6c1=_0x1ffa33;if(pid[_0x464ae0])pid[_0x464ae0]['send']({'function':_0x24c6c1(0x1cc),'args':null});}),tgBot[_0x1ffa33(0x187)](_0x1ffa33(0x1fe));});}else{const _0x588f8e=_0x522dcb[0x0][_0x3d1fd5(0x1a6)];if(pid[_0x588f8e])pid[_0x588f8e][_0x3d1fd5(0x1e1)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x442194(0x20c)](/\/update/,async _0x57df53=>{const _0x458a92=_0x442194;if(!validateTelegram(_0x57df53))return;tgBot['removeListener'](_0x458a92(0x1fe)),await getMessages();if(!updateAvailable)tgBot[_0x458a92(0x162)](_0x57df53[_0x458a92(0x247)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x20be17=>{telegramError(_0x20be17);});else!validInstallation?tgBot['sendMessage'](_0x57df53[_0x458a92(0x247)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')['catch'](_0x26828b=>{telegramError(_0x26828b);}):(tgBot[_0x458a92(0x162)](_0x57df53[_0x458a92(0x247)]['id'],_0x458a92(0x1f7),{'reply_markup':{'inline_keyboard':[[{'text':_0x458a92(0x2fb),'callback_data':_0x458a92(0x1a0)},{'text':'No','callback_data':'no'}]]}})[_0x458a92(0x1cb)](_0x5618d5=>{telegramError(_0x5618d5);}),tgBot['on'](_0x458a92(0x1fe),async _0x7955c9=>{const _0x28c53a=_0x458a92,_0x133ff8=_0x7955c9[_0x28c53a(0x269)],_0x1c8273=_0x7955c9[_0x28c53a(0x1c0)];tgBot[_0x28c53a(0x13b)](_0x7955c9['id'])[_0x28c53a(0x267)](async()=>{const _0x9c2b28=_0x28c53a;_0x133ff8=='yes'&&(await tgBot['sendMessage'](_0x1c8273['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x9c2b28(0x1cb)](_0x53f4e7=>{telegramError(_0x53f4e7);}),updateBB('update')),_0x133ff8=='no'&&await tgBot['sendMessage'](_0x1c8273[_0x9c2b28(0x247)]['id'],_0x9c2b28(0x180))['catch'](_0x1745e1=>{telegramError(_0x1745e1);});}),tgBot[_0x28c53a(0x187)](_0x28c53a(0x1fe));}));}),tgBot['onText'](/\/reinstall/,async _0x370e16=>{const _0xa18e65=_0x442194;if(!validateTelegram(_0x370e16))return;tgBot['removeListener'](_0xa18e65(0x1fe)),!validInstallation?tgBot[_0xa18e65(0x162)](_0x370e16[_0xa18e65(0x247)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0xa18e65(0x1cb)](_0x2e5615=>{telegramError(_0x2e5615);}):(tgBot[_0xa18e65(0x162)](_0x370e16[_0xa18e65(0x247)]['id'],_0xa18e65(0x226),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0xa18e65(0x1a0)},{'text':'No','callback_data':'no'}]]}})[_0xa18e65(0x1cb)](_0x2e8a29=>{telegramError(_0x2e8a29);}),tgBot['on'](_0xa18e65(0x1fe),async _0x586467=>{const _0x48b2b5=_0xa18e65,_0x1f88a4=_0x586467[_0x48b2b5(0x269)],_0x769111=_0x586467[_0x48b2b5(0x1c0)];tgBot[_0x48b2b5(0x13b)](_0x586467['id'])[_0x48b2b5(0x267)](async()=>{const _0x5cef18=_0x48b2b5;_0x1f88a4=='yes'&&(await tgBot[_0x5cef18(0x162)](_0x769111[_0x5cef18(0x247)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x5cef18(0x1cb)](_0x4e642a=>{telegramError(_0x4e642a);}),updateBB('reinstall')),_0x1f88a4=='no'&&await tgBot[_0x5cef18(0x162)](_0x769111[_0x5cef18(0x247)]['id'],_0x5cef18(0x1f3))[_0x5cef18(0x1cb)](_0x11a725=>{telegramError(_0x11a725);});}),tgBot['removeListener'](_0x48b2b5(0x1fe));}));}),tgBot[_0x442194(0x20c)](/\/toggle/,_0x3ca4a2=>{const _0x28ec88=_0x442194;if(!validateTelegram(_0x3ca4a2))return;tgBot[_0x28ec88(0x187)]('callback_query');const _0x3f45c9=getBotsWithMode();if(_0x3f45c9[_0x28ec88(0x26c)]==0x0)tgBot[_0x28ec88(0x162)](_0x3ca4a2['chat']['id'],_0x28ec88(0x2d3))[_0x28ec88(0x1cb)](_0x1f327f=>{telegramError(_0x1f327f);});else{let _0x43366f=[],_0x487834=[];const _0x5a7748=0x2;let _0x3e11c2=0x0;_0x3f45c9[_0x28ec88(0x2c2)]((_0x16ac57,_0x32f564)=>{const _0x5044e5=_0x28ec88;if(_0x32f564%_0x5a7748==0x0)_0x487834=[];_0x487834['push']({'text':_0x5044e5(0x253)+_0x16ac57[_0x5044e5(0x1a6)]+'\x20('+_0x16ac57[_0x5044e5(0x141)]+')','callback_data':_0x16ac57[_0x5044e5(0x1a6)]}),_0x32f564%_0x5a7748==0x0&&(_0x43366f[_0x3e11c2]=_0x487834,_0x3e11c2++);}),tgBot[_0x28ec88(0x162)](_0x3ca4a2[_0x28ec88(0x247)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x43366f}})[_0x28ec88(0x1cb)](_0x20e12a=>{telegramError(_0x20e12a);}),tgBot['on'](_0x28ec88(0x1fe),async _0x2df212=>{const _0x2fa10b=_0x28ec88,_0x386824=_0x2df212[_0x2fa10b(0x269)],_0x1b3c6c=_0x2df212['message'];tgBot[_0x2fa10b(0x13b)](_0x2df212['id'])[_0x2fa10b(0x267)](async()=>{const _0x39f453=_0x2fa10b,_0x5be0f3=_0x3f45c9[_0x39f453(0x1f5)](_0x426071=>_0x426071[_0x39f453(0x1a6)]==_0x386824),_0x25979e=_0x5be0f3[_0x39f453(0x141)]==_0x39f453(0x1b0)?'manual':_0x39f453(0x1b0);tgBot[_0x39f453(0x162)](_0x1b3c6c[_0x39f453(0x247)]['id'],_0x39f453(0x1f9)+_0x386824+'\x20to\x20'+_0x25979e+_0x39f453(0x1b6))[_0x39f453(0x1cb)](_0x23c3e7=>{telegramError(_0x23c3e7);}),toggleBotMode(_0x386824);}),tgBot[_0x2fa10b(0x187)](_0x2fa10b(0x1fe));});}}),tgBot['onText'](/\/names/,_0x968981=>{const _0x5dc1c9=_0x442194;if(!validateTelegram(_0x968981))return;let _0x4e5236='';config[_0x5dc1c9(0x2c2)](_0x41d515=>{const _0x439b07=_0x5dc1c9;_0x4e5236+=_0x439b07(0x253)+_0x41d515[_0x439b07(0x1a6)]+':\x20'+_0x41d515[_0x439b07(0x222)]+'\x0a';}),tgBot[_0x5dc1c9(0x162)](_0x968981['chat']['id'],_0x4e5236,{'parse_mode':_0x5dc1c9(0x300)})['catch'](_0x99f18c=>{telegramError(_0x99f18c);});}),tgBot[_0x442194(0x20c)](/\/disable/,_0x13e0a3=>{const _0x116d74=_0x442194;if(!validateTelegram(_0x13e0a3))return;tgBot['sendMessage'](_0x13e0a3[_0x116d74(0x247)]['id'],'Notifications\x20disabled')[_0x116d74(0x1cb)](_0x3774e3=>{telegramError(_0x3774e3);}),updateSetting(_0x116d74(0x2a3),![]);}),tgBot[_0x442194(0x20c)](/\/help/,_0x3201fe=>{const _0x2891b8=_0x442194;if(!validateTelegram(_0x3201fe))return;tgBot[_0x2891b8(0x162)](_0x3201fe[_0x2891b8(0x247)]['id'],_0x4434b7)['catch'](_0x19d6c=>{telegramError(_0x19d6c);});}),tgBot['on']('polling_error',_0xdfc56=>{const _0x597f86=_0x442194;_0xdfc56['toString']()[_0x597f86(0x189)](_0x597f86(0x1ca))&&(logger[_0x597f86(0x203)](_0x597f86(0x29d)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x597f86(0x2b6))[_0x597f86(0x238)](_0x597f86(0x13e),_0x597f86(0x29d)));}),process[_0x442194(0x1ae)](_0x442194(0x242),()=>{const _0xc68f9d=_0x442194;if(tgBot)tgBot[_0xc68f9d(0x183)]();process[_0xc68f9d(0x216)](0x1);}),process['once']('SIGTERM',()=>{const _0x55706a=_0x442194;if(tgBot)tgBot[_0x55706a(0x183)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x244781,_0x12a50b){const _0x27b477=_0x59e1df;if(settings[_0x27b477(0x2a3)]){if(settings[_0x27b477(0x2ec)]=='all'||(_0x12a50b['type']==_0x27b477(0x25b)||_0x12a50b[_0x27b477(0x1e9)]==_0x27b477(0x175)||_0x12a50b[_0x27b477(0x1e9)]==_0x27b477(0x13a))&&settings[_0x27b477(0x2ec)]=='alerts'||_0x12a50b['type']==_0x27b477(0x23d)&&settings[_0x27b477(0x2ec)]==_0x27b477(0x1f6)){if(tgBot&&settings[_0x27b477(0x215)]){if(_0x12a50b[_0x27b477(0x1bd)])tgBot[_0x27b477(0x162)](settings[_0x27b477(0x215)],_0x12a50b[_0x27b477(0x222)]+_0x27b477(0x17b)+_0x12a50b[_0x27b477(0x27b)])[_0x27b477(0x1cb)](_0x1e7a56=>{telegramError(_0x1e7a56);});else tgBot[_0x27b477(0x162)](settings['telegramChatId'],'Bot\x20'+_0x244781+_0x27b477(0x17b)+_0x12a50b['event'])[_0x27b477(0x1cb)](_0x296064=>{telegramError(_0x296064);});}}}}async function sendTelegramMsg(_0x31f3ab,_0x180077=_0x59e1df(0x300)){const _0x4642ea=_0x59e1df;return settings[_0x4642ea(0x2a3)]&&tgBot&&settings[_0x4642ea(0x215)]?(await tgBot[_0x4642ea(0x162)](settings[_0x4642ea(0x215)],_0x31f3ab,{'parse_mode':_0x180077})[_0x4642ea(0x1cb)](_0x18db41=>{telegramError(_0x18db41);}),!![]):![];}function getDeviceWithIp(_0x16ea43){const _0x2d88c3=_0x59e1df;return devices[_0x2d88c3(0x1f5)](_0x233db5=>_0x233db5['ip']===_0x16ea43);}function temporaryAccess2FA(_0x52fd0c,_0xf8f6e3){const _0x5afdb1=_0x59e1df;let _0x159e7f=new Date(),_0x4473bb=![];if(lastIpApproval){if(_0x159e7f-lastIpApproval<0x1388)_0x4473bb=!![];}lastIpApproval=new Date();if(_0x4473bb)return;tgBot&&settings[_0x5afdb1(0x215)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings[_0x5afdb1(0x215)],_0x5afdb1(0x2ae)+normalizeIP(_0xf8f6e3)[_0x5afdb1(0x292)]+'</b>\x20?',{'parse_mode':_0x5afdb1(0x300),'reply_markup':{'inline_keyboard':[[{'text':_0x5afdb1(0x246),'callback_data':'5'},{'text':_0x5afdb1(0x2b0),'callback_data':'15'},{'text':_0x5afdb1(0x1ab),'callback_data':'30'},{'text':'reject','callback_data':_0x5afdb1(0x258)}]]}})[_0x5afdb1(0x1cb)](_0x15b93e=>{telegramError(_0x15b93e);}),tgBot['on'](_0x5afdb1(0x1fe),async _0x56f971=>{const _0x20f733=_0x5afdb1,_0x4ad4a1=_0x56f971[_0x20f733(0x269)],_0x55f581=_0x56f971['message'];tgBot['answerCallbackQuery'](_0x56f971['id'])[_0x20f733(0x267)](async()=>{const _0x47f5d3=_0x20f733;devices[_0x52fd0c][_0x47f5d3(0x277)]={'clientip':_0xf8f6e3,'timestamp':new Date()[_0x47f5d3(0x2c6)](),'expiry':_0x4ad4a1},_0x4ad4a1!=_0x47f5d3(0x258)?(await tgBot['sendMessage'](_0x55f581[_0x47f5d3(0x247)]['id'],_0x47f5d3(0x1ff)+_0x4ad4a1+'\x20minutes',{'parse_mode':_0x47f5d3(0x300)})[_0x47f5d3(0x1cb)](_0x531285=>{telegramError(_0x531285);}),io['to'](_0x52fd0c)[_0x47f5d3(0x238)](_0x47f5d3(0x1c2),{'access':{'allow':![],'reason':_0x47f5d3(0x1ad),'token':null}})):(await tgBot[_0x47f5d3(0x162)](_0x55f581[_0x47f5d3(0x247)]['id'],_0x47f5d3(0x265))['catch'](_0x35a54e=>{telegramError(_0x35a54e);}),io['to'](_0x52fd0c)['emit'](_0x47f5d3(0x1c2),{'access':{'allow':![],'reason':_0x47f5d3(0x25e),'token':null}}));}),tgBot['removeListener'](_0x20f733(0x1fe));}));}function loginAccess2FA(_0x57b378,_0x41a45a){const _0x4418db=_0x59e1df;tgBot&&settings['telegramChatId']&&(tgBot[_0x4418db(0x187)](_0x4418db(0x1fe)),tgBot['sendMessage'](settings[_0x4418db(0x215)],_0x4418db(0x250)+normalizeIP(_0x41a45a)[_0x4418db(0x292)]+_0x4418db(0x1cd),{'parse_mode':_0x4418db(0x300),'reply_markup':{'inline_keyboard':[[{'text':_0x4418db(0x24f),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x4418db(0x258)}]]}})['catch'](_0x2e9afc=>{telegramError(_0x2e9afc);}),tgBot['on'](_0x4418db(0x1fe),async _0x404702=>{const _0x3a26d8=_0x4418db,_0x202973=_0x404702[_0x3a26d8(0x269)],_0x255497=_0x404702[_0x3a26d8(0x1c0)];tgBot[_0x3a26d8(0x13b)](_0x404702['id'])[_0x3a26d8(0x267)](async()=>{const _0xc132db=_0x3a26d8;devices[_0x57b378][_0xc132db(0x270)]={'clientip':_0x41a45a,'timestamp':new Date()[_0xc132db(0x2c6)](),'expiry':_0x202973},_0x202973!=_0xc132db(0x258)?(await tgBot['sendMessage'](_0x255497[_0xc132db(0x247)]['id'],_0xc132db(0x239),{'parse_mode':'HTML'})['catch'](_0x209dc8=>{telegramError(_0x209dc8);}),io['to'](_0x57b378)[_0xc132db(0x238)](_0xc132db(0x1c2),{'access':{'allow':![],'reason':_0xc132db(0x1ad),'token':null}})):(await tgBot[_0xc132db(0x162)](_0x255497[_0xc132db(0x247)]['id'],_0xc132db(0x1c1))[_0xc132db(0x1cb)](_0x420529=>{telegramError(_0x420529);}),io['to'](_0x57b378)['emit'](_0xc132db(0x1c2),{'access':{'allow':![],'reason':_0xc132db(0x14d),'token':null}}));}),tgBot[_0x3a26d8(0x187)](_0x3a26d8(0x1fe));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4f1468=_0x59e1df;return dbConfig['get'](_0x4f1468(0x1b9))['sortBy'](_0x4f1468(0x1a6))[_0x4f1468(0x17c)]({'status':_0x4f1468(0x25a)})['value']()||[];}function getDisabledBots(){const _0x18399d=_0x59e1df;return dbConfig['get'](_0x18399d(0x1b9))['sortBy']('botID')[_0x18399d(0x17c)]({'status':'disabled'})[_0x18399d(0x24a)]()||[];}function getBotAttributes(_0x14eab1){const _0x2b5895=_0x59e1df;let _0x3772a9={};const _0x210b8f=configpath+_0x2b5895(0x154)+_0x14eab1+'-config.json',_0x21bcbf=fs[_0x2b5895(0x25c)](_0x210b8f);if(_0x21bcbf){const _0x4e2d73=fs[_0x2b5895(0x26f)](_0x210b8f);try{const _0x43da6b=JSON[_0x2b5895(0x23c)](_0x4e2d73),_0x390cc5=_0x43da6b?_0x43da6b[_0x2b5895(0x14f)][0x0][_0x2b5895(0x2c5)]:![];_0x3772a9[_0x2b5895(0x141)]=_0x390cc5?_0x2b5895(0x1b0):'manual',_0x3772a9['botname']=_0x43da6b?_0x43da6b['bot'][0x0][_0x2b5895(0x222)]:'Bot\x20'+_0x14eab1;}catch(_0xd32d98){_0x3772a9[_0x2b5895(0x141)]=_0x2b5895(0x186),_0x3772a9[_0x2b5895(0x222)]='Bot\x20'+_0x14eab1;}}else _0x3772a9['mode']=_0x2b5895(0x186),_0x3772a9[_0x2b5895(0x222)]=_0x2b5895(0x253)+_0x14eab1;return _0x3772a9;}function getBotsWithMode(){const _0x48ac35=_0x59e1df,_0x3ce0f7=dbConfig['get'](_0x48ac35(0x1b9))['sortBy'](_0x48ac35(0x1a6))[_0x48ac35(0x24a)]()||[];return _0x3ce0f7['forEach'](_0x2a1064=>{const _0x4b2e32=_0x48ac35;let _0x122fb0=getBotAttributes(_0x2a1064[_0x4b2e32(0x1a6)]);_0x2a1064['mode']=_0x122fb0[_0x4b2e32(0x141)];}),_0x3ce0f7;}function getBotExchanges(){const _0x10aedd=_0x59e1df;let _0x51b086=[];const _0x2f58c1=dbConfig[_0x10aedd(0x22b)](_0x10aedd(0x1b9))['sortBy'](_0x10aedd(0x1a6))[_0x10aedd(0x24a)]()||[];_0x2f58c1['forEach'](_0x4db051=>{const _0x191949=_0x10aedd;if(_0x4db051[_0x191949(0x1c2)]==_0x191949(0x25a)){const _0x5cae12=configpath+_0x191949(0x154)+_0x4db051[_0x191949(0x1a6)]+_0x191949(0x207),_0x177139=fs[_0x191949(0x25c)](_0x5cae12);let _0x52b772;if(_0x177139){const _0x59b67f=fs[_0x191949(0x26f)](_0x5cae12);try{const _0x511009=JSON[_0x191949(0x23c)](_0x59b67f);_0x52b772=_0x511009?_0x511009['bot'][0x0][_0x191949(0x20a)]:null;}catch(_0x633adb){}}if(_0x52b772)_0x51b086[_0x191949(0x2a8)](_0x52b772);}});const _0x49be84=[...new Set(_0x51b086)][_0x10aedd(0x217)]();return _0x49be84;}async function initUser(){const _0x4b0127=_0x59e1df;if(!settings[_0x4b0127(0x28b)]){const _0x103e4e=uuidRandom();mixpanel[_0x4b0127(0x256)](_0x103e4e),updateSetting(_0x4b0127(0x28b),_0x103e4e);}}async function initSecure(){const _0x43cebc=_0x59e1df;let _0x41e0ef=getSecure();if(!_0x41e0ef[_0x43cebc(0x24c)]('secret')){let _0xb061f0=await generateKeys();_0x41e0ef['publicKey']=_0xb061f0[_0x43cebc(0x2f8)],_0x41e0ef[_0x43cebc(0x22f)]=_0xb061f0[_0x43cebc(0x22f)],_0x41e0ef[_0x43cebc(0x166)]=crypto[_0x43cebc(0x173)](0x20)[_0x43cebc(0x23e)](_0x43cebc(0x201));;storeSecure(_0x41e0ef);}}function getSettings(){const _0x33df02=_0x59e1df;return dbSettings['get'](_0x33df02(0x18f))[_0x33df02(0x24a)]()||{};}function getSecure(){const _0x20d6bb=_0x59e1df;return dbSecure[_0x20d6bb(0x22b)]('secure')[_0x20d6bb(0x24a)]()||{};}function getBlacklist(){const _0x2e8ab9=_0x59e1df;return dbSecure[_0x2e8ab9(0x22b)]('blacklist')[_0x2e8ab9(0x24a)]()||[];}function broadcastToBots(_0x1fe88c,_0x3f7d4d){const _0x4299d4=_0x59e1df;config[_0x4299d4(0x2c2)](_0x9006d0=>{const _0x1c3d89=_0x4299d4;if(_0x9006d0[_0x1c3d89(0x1c2)]==_0x1c3d89(0x25a)&&_0x9006d0['live']=='running'||_0x9006d0[_0x1c3d89(0x1c2)]==_0x1c3d89(0x28f)&&_0x9006d0[_0x1c3d89(0x2d5)]=='running'){if(pid[_0x9006d0[_0x1c3d89(0x1a6)]])pid[_0x9006d0['botID']][_0x1c3d89(0x1e1)]({[_0x1fe88c]:_0x3f7d4d});}});}function storeSettings(_0x2adf74,_0x31a1af=![]){const _0x5694e8=_0x59e1df;_0x2adf74={...settings,..._0x2adf74};if(_0x31a1af&&_0x2adf74[_0x5694e8(0x137)]!=_0x5694e8(0x159)&&_0x2adf74[_0x5694e8(0x137)]!=_0x5694e8(0x153)&&_0x2adf74['bbPassword']!=''){const _0x1b9e47=crypt[_0x5694e8(0x1ec)](secure[_0x5694e8(0x22f)],_0x2adf74['bbPassword'])['message'][_0x5694e8(0x307)]('@')[0x0],_0x1db4cf=bcrypt[_0x5694e8(0x2fc)](_0x1b9e47,saltRounds);_0x2adf74={..._0x2adf74,'bbPassword':_0x1db4cf};}if(_0x31a1af&&_0x2adf74[_0x5694e8(0x144)]!=_0x5694e8(0x159)&&_0x2adf74[_0x5694e8(0x144)]!='***'&&_0x2adf74['telegramToken']!=''){const _0xce9d6e=crypt[_0x5694e8(0x1ec)](secure[_0x5694e8(0x22f)],_0x2adf74['telegramToken'])[_0x5694e8(0x1c0)]['split']('@')[0x0];_0x2adf74={..._0x2adf74,'telegramToken':_0xce9d6e};}const _0x58ea92=_0x2adf74[_0x5694e8(0x144)]!=_0x5694e8(0x159)&&_0x2adf74[_0x5694e8(0x144)]!=settings[_0x5694e8(0x144)]||_0x2adf74['telegramUsername']!=settings[_0x5694e8(0x262)],_0x1f3582=_0x2adf74[_0x5694e8(0x144)]==''||_0x2adf74[_0x5694e8(0x262)]=='';if(_0x58ea92)_0x2adf74[_0x5694e8(0x2ec)]='all';for(const [_0x5c4026,_0x540f77]of Object[_0x5694e8(0x1c4)](_0x2adf74)){if(_0x5c4026==_0x5694e8(0x144)&&_0x540f77==_0x5694e8(0x159)){_0x2adf74['telegramToken']=settings[_0x5694e8(0x144)];continue;};if(_0x5c4026=='bbPassword'&&_0x540f77=='************'){_0x2adf74['bbPassword']=settings[_0x5694e8(0x137)];continue;};dbSettings[_0x5694e8(0x208)](_0x5694e8(0x24b)+_0x5c4026,_0x540f77)['write']();}settings=_0x2adf74,io['to'](_0x5694e8(0x2b6))[_0x5694e8(0x238)](_0x5694e8(0x18f),cleanSettings()),broadcastToBots(_0x5694e8(0x179),settings[_0x5694e8(0x179)]),broadcastToBots('onepagemode',settings[_0x5694e8(0x2ca)]);if(_0x58ea92&&!_0x1f3582)initTelegram();if(_0x58ea92&&_0x1f3582)disableTelegram();getAllClients()['forEach'](_0x2ba468=>{const _0x1274a2=_0x5694e8;getSocket(_0x2ba468['id'])[_0x1274a2(0x238)](_0x1274a2(0x1c2),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x458cea,_0x480595){const _0x2e2519=_0x59e1df;dbSettings['set'](_0x2e2519(0x24b)+_0x458cea,_0x480595)['write'](),settings=getSettings(),io['to'](_0x2e2519(0x2b6))[_0x2e2519(0x238)](_0x2e2519(0x18f),cleanSettings());}function storeSecure(_0xfb6244){const _0x57a4e5=_0x59e1df;dbSecure[_0x57a4e5(0x22b)](_0x57a4e5(0x26b))['push'](_0xfb6244)[_0x57a4e5(0x22d)](),secure=_0xfb6244;}function addBlacklist(_0x47e077){const _0x2f1843=_0x59e1df;cleanBlacklist();let _0x2fbd75;devices[_0x47e077][_0x2f1843(0x277)]?_0x2fbd75=Math['max'](devices[_0x47e077][_0x2f1843(0x277)][_0x2f1843(0x1db)],loginExpiry):_0x2fbd75=loginExpiry,dbSecure[_0x2f1843(0x22b)](_0x2f1843(0x200))[_0x2f1843(0x2a8)]({'expiry':new Date()[_0x2f1843(0x2c6)]()+_0x2fbd75*0x3c*0x3e8,'token':devices[_0x47e077]['access'][_0x2f1843(0x286)]})['write'](),blacklist=dbSecure[_0x2f1843(0x22b)](_0x2f1843(0x200))[_0x2f1843(0x24a)]();}function cleanBlacklist(){const _0x55a37d=_0x59e1df;let _0x4f7416=dbSecure[_0x55a37d(0x22b)](_0x55a37d(0x200))['cloneDeep']()[_0x55a37d(0x24a)](),_0x4453a7=new Date()[_0x55a37d(0x2c6)]();_0x4f7416['forEach'](_0xe62484=>{const _0x4852a7=_0x55a37d;_0xe62484['expiry']<_0x4453a7&&dbSecure[_0x4852a7(0x22b)](_0x4852a7(0x200))[_0x4852a7(0x1fa)]({'expiry':_0xe62484[_0x4852a7(0x1db)]})[_0x4852a7(0x22d)]();});}function initStates(){let _0x29b726=getConfiguration();_0x29b726['forEach'](_0x1da70f=>{const _0x32e465=_0x4818;_0x1da70f[_0x32e465(0x2d5)]='stopped';}),storeConfiguration(_0x29b726);}function onKeys(){const _0x124db0=new RSA();return new Promise(_0x1e6a34=>{_0x124db0['generateKeyPairAsync']()['then'](_0x199446=>{_0x1e6a34(_0x199446);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5032a9=_0x59e1df;let _0x53b0c4=getSettings(),_0x5671aa=![];!_0x53b0c4[_0x5032a9(0x24c)](_0x5032a9(0x260))&&(_0x53b0c4[_0x5032a9(0x260)]=0x0,_0x5671aa=!![]);!_0x53b0c4['hasOwnProperty'](_0x5032a9(0x2ed))&&(_0x53b0c4['lastmsgemitted']=0x0,_0x5671aa=!![]);!_0x53b0c4[_0x5032a9(0x24c)]('latestversion')&&(_0x53b0c4['latestversion']=_0x5032a9(0x1b7),_0x5671aa=!![]);!_0x53b0c4['hasOwnProperty'](_0x5032a9(0x2ca))&&(_0x53b0c4[_0x5032a9(0x2ca)]=![],_0x5671aa=!![]);if(_0x5671aa)storeSettings(_0x53b0c4);}function storeConfiguration(_0x43534e){const _0x506755=_0x59e1df;dbConfig['get'](_0x506755(0x1b9))[_0x506755(0x1fa)]()[_0x506755(0x22d)](),_0x43534e[_0x506755(0x2c2)](_0x30de9a=>{const _0x547460=_0x506755;delete _0x30de9a[_0x547460(0x141)];}),dbConfig[_0x506755(0x22b)](_0x506755(0x1b9))[_0x506755(0x2a8)](..._0x43534e)[_0x506755(0x22d)](),config=_0x43534e;}function resetPassword(){const _0x2318bd=_0x59e1df;tgBot&&settings['telegramChatId']&&(tgBot[_0x2318bd(0x187)](_0x2318bd(0x1fe)),tgBot[_0x2318bd(0x162)](settings[_0x2318bd(0x215)],_0x2318bd(0x2b8),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x45284f=>{telegramError(_0x45284f);}),tgBot['on'](_0x2318bd(0x1fe),async _0x3dbc46=>{const _0x11795a=_0x2318bd,_0x34bbfa=_0x3dbc46[_0x11795a(0x269)],_0x426375=_0x3dbc46[_0x11795a(0x1c0)];tgBot['answerCallbackQuery'](_0x3dbc46['id'])[_0x11795a(0x267)](async()=>{const _0x6227e=_0x11795a;if(_0x34bbfa!='no'){const _0x279d2d=0xf,_0x2ebe96='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x429a6f=Array['from'](crypto[_0x6227e(0x308)](new Uint32Array(_0x279d2d)))[_0x6227e(0x15a)](_0x463873=>_0x2ebe96[_0x463873%_0x2ebe96[_0x6227e(0x26c)]])['join'](''),_0xbd69e7=bcrypt[_0x6227e(0x2fc)](_0x429a6f,saltRounds);storeSettings({'bbPassword':_0xbd69e7}),await tgBot[_0x6227e(0x162)](_0x426375[_0x6227e(0x247)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x429a6f,{'parse_mode':_0x6227e(0x300)})[_0x6227e(0x1cb)](_0x1dfc5b=>{telegramError(_0x1dfc5b);});}else await tgBot[_0x6227e(0x162)](_0x426375[_0x6227e(0x247)]['id'],_0x6227e(0x21c))[_0x6227e(0x1cb)](_0x5595ed=>{telegramError(_0x5595ed);});}),tgBot['removeListener'](_0x11795a(0x1fe));}));}async function confirmRestore(_0x48cbb9,_0x39fb93){const _0x4bd674=_0x59e1df;io['to'](_0x4bd674(0x2b6))[_0x4bd674(0x238)](_0x4bd674(0x13e),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x4bd674(0x13a)),tgBot&&settings[_0x4bd674(0x215)]&&(tgBot[_0x4bd674(0x187)]('callback_query'),await tgBot[_0x4bd674(0x162)](settings[_0x4bd674(0x215)],_0x4bd674(0x1c8),{'parse_mode':_0x4bd674(0x300),'reply_markup':{'inline_keyboard':[[{'text':_0x4bd674(0x1a0),'callback_data':_0x4bd674(0x1a0)},{'text':'no','callback_data':'no'}]]}})[_0x4bd674(0x1cb)](_0x238641=>{telegramError(_0x238641);}),tgBot['on']('callback_query',async _0x4ec509=>{const _0x2ed1ff=_0x4bd674,_0x9b7b3e=_0x4ec509['data'],_0xc61323=_0x4ec509[_0x2ed1ff(0x1c0)];tgBot[_0x2ed1ff(0x13b)](_0x4ec509['id'])[_0x2ed1ff(0x267)](async()=>{const _0x130b32=_0x2ed1ff;_0x9b7b3e=='yes'?(await tgBot[_0x130b32(0x162)](_0xc61323['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x130b32(0x300)})[_0x130b32(0x1cb)](_0x442c3e=>{telegramError(_0x442c3e);}),unzipFile(_0x48cbb9,_0x39fb93)):(logger['debug'](_0x130b32(0x2a9)),await tgBot[_0x130b32(0x162)](_0xc61323[_0x130b32(0x247)]['id'],'Restore\x20process\x20aborted')[_0x130b32(0x1cb)](_0x37de2f=>{telegramError(_0x37de2f);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x1c827f=_0x59e1df,_0x4318b4=new Date();return _0x4318b4[_0x1c827f(0x22c)]()+'/'+(_0x4318b4['getMonth']()+0x1)[_0x1c827f(0x23e)]()[_0x1c827f(0x2e8)](0x2,'0')+'/'+_0x4318b4[_0x1c827f(0x16a)]()[_0x1c827f(0x23e)]()[_0x1c827f(0x2e8)](0x2,'0')+'\x20'+_0x4318b4[_0x1c827f(0x229)]()[_0x1c827f(0x23e)]()[_0x1c827f(0x2e8)](0x2,'0')+':'+_0x4318b4['getMinutes']()[_0x1c827f(0x23e)]()['padStart'](0x2,'0')+':'+_0x4318b4['getSeconds']()['toString']()[_0x1c827f(0x2e8)](0x2,'0');}function getTimeStamp(){const _0x3d14cf=_0x59e1df,_0x44545a=shiftedTime();return _0x44545a[_0x3d14cf(0x22c)]()+'/'+(_0x44545a[_0x3d14cf(0x181)]()+0x1)[_0x3d14cf(0x23e)]()[_0x3d14cf(0x2e8)](0x2,'0')+'/'+_0x44545a[_0x3d14cf(0x16a)]()[_0x3d14cf(0x23e)]()[_0x3d14cf(0x2e8)](0x2,'0')+'\x20'+_0x44545a[_0x3d14cf(0x229)]()['toString']()[_0x3d14cf(0x2e8)](0x2,'0')+':'+_0x44545a['getMinutes']()[_0x3d14cf(0x23e)]()['padStart'](0x2,'0')+':'+_0x44545a[_0x3d14cf(0x13f)]()[_0x3d14cf(0x23e)]()[_0x3d14cf(0x2e8)](0x2,'0');}function getCleanTimeStamp(){const _0x582773=_0x59e1df,_0x35a843=shiftedTime();return _0x35a843[_0x582773(0x22c)]()+(_0x35a843[_0x582773(0x181)]()+0x1)[_0x582773(0x23e)]()[_0x582773(0x2e8)](0x2,'0')+_0x35a843[_0x582773(0x16a)]()['toString']()['padStart'](0x2,'0')+'-'+_0x35a843['getHours']()[_0x582773(0x23e)]()[_0x582773(0x2e8)](0x2,'0')+_0x35a843[_0x582773(0x2ef)]()[_0x582773(0x23e)]()[_0x582773(0x2e8)](0x2,'0')+_0x35a843[_0x582773(0x13f)]()[_0x582773(0x23e)]()[_0x582773(0x2e8)](0x2,'0');}function shiftedTime(){const _0x205871=_0x59e1df,_0x127ef4=new Date();let _0x3cf154=_0x127ef4;if(settings[_0x205871(0x179)]&&settings[_0x205871(0x179)]!==0x0)_0x3cf154=fns[_0x205871(0x1ee)](_0x127ef4,{'hours':settings['timeshift']});return _0x3cf154;}function startScheduler(){const _0x3178e8=_0x59e1df,_0x3ce73e=new Date()[_0x3178e8(0x28e)](),_0x1e8b6b=shiftedTime()[_0x3178e8(0x229)]();_0x1e8b6b==0x4&&backupConfigFiles();_0x1e8b6b==0x0&&rotateLogFiles();_0x3ce73e%0x6==0x0&&triggerAnalytics();_0x3ce73e%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3a37df){const _0x18a0f3=_0x59e1df;logger[_0x18a0f3(0x184)]('Restore\x20backup\x20file\x20'+_0x3a37df);const _0x490ba8=getBotsWithMode();_0x490ba8[_0x18a0f3(0x26c)]>0x0?confirmRestore(configbackuppath,_0x3a37df):unzipFile(configbackuppath,_0x3a37df);}async function getBackupFiles(_0x425357=null){const _0x55c23e=_0x59e1df;let _0x19910e=[],_0x44f2ac=fs[_0x55c23e(0x288)](configbackuppath,{'withFileTypes':!![]});_0x44f2ac[_0x55c23e(0x217)]((_0x3fd902,_0x437d5d)=>_0x3fd902[_0x55c23e(0x2dc)]<_0x437d5d[_0x55c23e(0x2dc)]?0x1:_0x437d5d[_0x55c23e(0x2dc)]<_0x3fd902[_0x55c23e(0x2dc)]?-0x1:0x0),_0x44f2ac[_0x55c23e(0x2c2)](_0x11321d=>{const _0x519582=_0x55c23e;if(!_0x11321d[_0x519582(0x281)]()&&_0x11321d[_0x519582(0x2dc)]['startsWith'](_0x519582(0x276))&&_0x11321d[_0x519582(0x2dc)][_0x519582(0x18c)](_0x519582(0x13d))){const _0x255b75=formatDate(fs['statSync'](configbackuppath+_0x11321d[_0x519582(0x2dc)])['mtime']);_0x19910e[_0x519582(0x2a8)]({'name':_0x11321d[_0x519582(0x2dc)],'mtime':_0x255b75});}});if(_0x425357)io['to'](_0x425357)[_0x55c23e(0x238)](_0x55c23e(0x27f),_0x19910e);else return _0x19910e;}async function backupConfigFiles(){const _0x10d50f=_0x59e1df;await zipFiles(_0x10d50f(0x27e));const _0xe0e110=getCleanTimeStamp();fs[_0x10d50f(0x2f4)](zippath+_0x10d50f(0x22a),configbackuppath+(_0x10d50f(0x276)+_0xe0e110+_0x10d50f(0x13d)));let _0x350188=fs[_0x10d50f(0x288)](configbackuppath,{'withFileTypes':!![]});_0x350188[_0x10d50f(0x217)]((_0x5138bb,_0x43660c)=>_0x5138bb[_0x10d50f(0x2dc)]<_0x43660c[_0x10d50f(0x2dc)]?0x1:_0x43660c[_0x10d50f(0x2dc)]<_0x5138bb[_0x10d50f(0x2dc)]?-0x1:0x0),_0x350188['length']>maxBackups&&fs[_0x10d50f(0x212)](configbackuppath+_0x350188[maxBackups][_0x10d50f(0x2dc)]);}function rotateLogFiles(){const _0x5ce820=_0x59e1df,_0x5b7c7f=fs[_0x5ce820(0x1b4)](logspath+'output-000.log'),_0x4ac569=_0x5b7c7f[_0x5ce820(0x2c4)]/0x400;if(_0x4ac569>0x64){let _0x484ec9=fs[_0x5ce820(0x288)](logspath,{'withFileTypes':!![]});_0x484ec9[_0x5ce820(0x217)]((_0x18f893,_0x250bb4)=>_0x18f893[_0x5ce820(0x2dc)]<_0x250bb4[_0x5ce820(0x2dc)]?0x1:_0x250bb4[_0x5ce820(0x2dc)]<_0x18f893[_0x5ce820(0x2dc)]?-0x1:0x0),_0x484ec9[_0x5ce820(0x2c2)](_0x32035d=>{const _0x39a6f1=_0x5ce820;if(_0x32035d['name']==_0x39a6f1(0x1a2))fs[_0x39a6f1(0x2f4)](logspath+_0x32035d[_0x39a6f1(0x2dc)],logspath+_0x39a6f1(0x1f1));if(_0x32035d[_0x39a6f1(0x2dc)]=='output-001.log')fs[_0x39a6f1(0x2f4)](logspath+_0x32035d[_0x39a6f1(0x2dc)],logspath+_0x39a6f1(0x1a2));_0x32035d[_0x39a6f1(0x2dc)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x32035d[_0x39a6f1(0x2dc)],logspath+_0x39a6f1(0x163)),fs[_0x39a6f1(0x241)](logspath+_0x32035d[_0x39a6f1(0x2dc)],''));});}}async function zipFiles(_0x14c143){const _0x378b0b=_0x59e1df;let _0x132577;if(_0x14c143==_0x378b0b(0x1e2))_0x132577=logspath;if(_0x14c143==_0x378b0b(0x185))_0x132577=configpath;if(_0x14c143==_0x378b0b(0x27e))_0x132577=configpath;let _0x121f4f=fs[_0x378b0b(0x288)](_0x132577,{'withFileTypes':!![]});const _0x24ed34=new require(_0x378b0b(0x18a))();_0x121f4f[_0x378b0b(0x2c2)](_0x3e56b4=>{const _0x20520b=_0x378b0b;if(!_0x3e56b4[_0x20520b(0x281)]()){let _0x1e58db=fs[_0x20520b(0x26f)](_0x132577+_0x3e56b4['name']);if(_0x14c143==_0x20520b(0x185)){const _0x4bd054=/^bot-[0-9]{3}-config.json$/,_0x3c3761=_0x4bd054['test'](_0x3e56b4['name']);if(_0x3c3761){const _0xf6e726=JSON[_0x20520b(0x23c)](_0x1e58db);if(_0xf6e726[_0x20520b(0x14f)][0x0]){_0xf6e726['bot'][0x0][_0x20520b(0x278)]=_0x20520b(0x153),_0xf6e726[_0x20520b(0x14f)][0x0][_0x20520b(0x298)]=_0x20520b(0x153);if(_0xf6e726[_0x20520b(0x14f)][0x0][_0x20520b(0x2ac)])_0xf6e726[_0x20520b(0x14f)][0x0][_0x20520b(0x2ac)]=_0x20520b(0x153);}_0x1e58db=JSON['stringify'](_0xf6e726,null,0x2);}if(_0x3e56b4[_0x20520b(0x2dc)]==_0x20520b(0x139)){const _0x3960d4=JSON[_0x20520b(0x23c)](_0x1e58db);if(_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x2c8)])_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x2c8)]=![];if(_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x137)])_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x137)]=_0x20520b(0x153);if(_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x144)])_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x144)]=_0x20520b(0x153);if(_0x3960d4[_0x20520b(0x18f)][_0x20520b(0x215)])_0x3960d4['settings'][_0x20520b(0x215)]=null;_0x1e58db=JSON[_0x20520b(0x1d2)](_0x3960d4,null,0x2);}if(_0x3e56b4['name']!=_0x20520b(0x26e))_0x24ed34[_0x20520b(0x29c)](_0x3e56b4[_0x20520b(0x2dc)],_0x1e58db);}else _0x24ed34['file'](_0x3e56b4['name'],_0x1e58db);}});const _0x1155fe=_0x24ed34['generate']({'base64':![],'compression':'DEFLATE'});fs[_0x378b0b(0x241)](zippath+(_0x14c143+_0x378b0b(0x13d)),_0x1155fe,_0x378b0b(0x289));}async function unzipFile(_0x1afe9c,_0x3a92ce){const _0x3441f7=_0x59e1df;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x2ad853=>{const _0x123558=_0x4818;if(!_0x2ad853[_0x123558(0x281)]())fs[_0x123558(0x211)](configpath+_0x2ad853[_0x123558(0x2dc)]);});const _0x4b4d60=fs[_0x3441f7(0x26f)](_0x1afe9c+_0x3a92ce,_0x3441f7(0x289)),_0x3e2b86=new require(_0x3441f7(0x18a))(_0x4b4d60,{'base64':![],'checkCRC32':!![]});Object[_0x3441f7(0x22e)](_0x3e2b86[_0x3441f7(0x1e5)])[_0x3441f7(0x2c2)](_0x384d24=>{const _0x116a8c=_0x3441f7,_0x5d7484=_0x3e2b86[_0x116a8c(0x1e5)][_0x384d24];fs['writeFileSync'](configpath+_0x5d7484[_0x116a8c(0x2dc)],_0x5d7484[_0x116a8c(0x2a5)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x3441f7(0x2c2)](_0x186f65=>{const _0x10b8c6=_0x3441f7;if(!_0x186f65[_0x10b8c6(0x281)]())fs[_0x10b8c6(0x211)](temppath+_0x186f65[_0x10b8c6(0x2dc)]);}),logger[_0x3441f7(0x184)](_0x3441f7(0x1d9)),process[_0x3441f7(0x1e1)]({'restore':!![]},_0x5035cf=>{});}async function getPublicIp(){const _0x2605b2=_0x59e1df;try{const _0x241161=await axios[_0x2605b2(0x22b)](_0x2605b2(0x240));publicip=_0x241161[_0x2605b2(0x269)]['ip'];}catch(_0x5545be){}}async function triggerAnalytics(){const _0x2210b9=_0x59e1df;if(!publicip)await getPublicIp();const _0x35fcdb=getBotsWithMode();let _0x4c10b5=0x0;_0x35fcdb['forEach'](_0x393c57=>{const _0x3c5624=_0x4818;if(_0x393c57[_0x3c5624(0x1c2)]===_0x3c5624(0x25a))_0x4c10b5++;});const _0x2fd078=getBotExchanges();mixpanel['track'](_0x2210b9(0x268),{'distinct_id':settings[_0x2210b9(0x28b)],'ip':publicip,'version':serverversion,'numbots':_0x35fcdb['length'],'numbotsenabled':_0x4c10b5,'exchanges':_0x2fd078});}async function getMessages(){const _0x5c900b=_0x59e1df,_0x6fb835=_0x5c900b(0x1dc),_0x22af05=new GraphQLClient(_0x6fb835),_0x209e14={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x3d6313=serverversion['split']('.'),_0x519b22=_0x3d6313[0x0]+'.'+_0x3d6313[0x1],_0x336773=Math['min'](settings[_0x5c900b(0x260)],settings[_0x5c900b(0x2ed)]),_0x3409bc={'last':parseInt(_0x336773),'bbm':_0x519b22},_0x45ae7c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x73cbe7;try{_0x73cbe7=await _0x22af05[_0x5c900b(0x2ea)](_0x45ae7c,_0x3409bc,_0x209e14);}catch(_0x561c88){}if(_0x73cbe7&&_0x73cbe7[_0x5c900b(0x2e6)]){let _0x464ee3=settings[_0x5c900b(0x260)];newMessages=[];for(const _0x41533c of _0x73cbe7[_0x5c900b(0x2e6)]){newMessages['push'](_0x41533c);if(_0x41533c['bbvNew'])updateSetting(_0x5c900b(0x26a),_0x41533c[_0x5c900b(0x234)]);let _0x543e3b=_0x41533c[_0x5c900b(0x234)]?serverversion>=_0x41533c[_0x5c900b(0x234)]:![];if(!_0x543e3b&&_0x41533c[_0x5c900b(0x1e7)]>_0x464ee3){if(_0x41533c[_0x5c900b(0x282)]===_0x5c900b(0x23a)||serverversion[_0x5c900b(0x16f)](_0x41533c['bbvReceive'])){let _0x1cd06f=''+_0x41533c[_0x5c900b(0x219)]+'\x0a\x0a'+_0x41533c[_0x5c900b(0x1c0)];const _0x81bc35=await sendTelegramMsg(toTelegramMarkdown(_0x1cd06f),'Markdown');if(_0x81bc35)_0x464ee3=_0x41533c[_0x5c900b(0x1e7)];}}}updateAvailable=isNewerVersion(settings[_0x5c900b(0x26a)],serverversion),updateSetting(_0x5c900b(0x260),_0x464ee3),emitMessages();}}function emitMessages(){const _0x51e2f4=_0x59e1df,_0x4a8b1f=settings[_0x51e2f4(0x2ed)];let _0xf8a207=[];newMessages[_0x51e2f4(0x2c2)](_0x1ebd34=>{const _0x19ec4d=_0x51e2f4;_0x1ebd34[_0x19ec4d(0x1e7)]>_0x4a8b1f&&_0xf8a207[_0x19ec4d(0x2a8)](_0x1ebd34);}),_0xf8a207[_0x51e2f4(0x26c)]>0x0&&getAllClients()[_0x51e2f4(0x2c2)](_0x212511=>{const _0x454c23=_0x51e2f4;getSocket(_0x212511['id'])[_0x454c23(0x238)](_0x454c23(0x1c0),_0xf8a207);});}function confirmMessage(_0x593444){updateSetting('lastmsgemitted',Number(_0x593444));}function isNewerVersion(_0x20239c,_0x415fab){const _0x55b376=_0x59e1df,_0x2a1289=_0x415fab[_0x55b376(0x307)]('.'),_0x5af2eb=_0x20239c[_0x55b376(0x307)]('.');for(var _0x547224=0x0;_0x547224<_0x5af2eb['length'];_0x547224++){const _0xb0aaaf=~~_0x5af2eb[_0x547224],_0x189b1d=~~_0x2a1289[_0x547224];if(_0xb0aaaf>_0x189b1d)return!![];if(_0xb0aaaf<_0x189b1d)return![];}return![];}function toTelegramMarkdown(_0x46e684){const _0x1dc8a9=_0x59e1df,_0x2865a8=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x131eae=/\*{2}(.+?)\*{2}/gim;return _0x46e684=_0x46e684[_0x1dc8a9(0x157)](_0x2865a8,_0x1dc8a9(0x293))['replace'](_0x131eae,_0x1dc8a9(0x1d3)),_0x46e684;}async function validateConfigFile(){const _0x481aec=_0x59e1df,_0x4f3680=dbConfig[_0x481aec(0x22b)](_0x481aec(0x1b9))[_0x481aec(0x1de)](_0x481aec(0x1a6))[_0x481aec(0x24a)]()||[];if(_0x4f3680['length']==0x0){let _0x580ac9=0x0,_0x1e35b7=[];const _0x549c=/^bot-([0-9]{3})-config.json$/,_0x38ea80=fs[_0x481aec(0x288)](configpath);_0x38ea80[_0x481aec(0x2c2)](_0x39e16c=>{const _0xc4c83c=_0x481aec,_0x2b3599=_0x549c[_0xc4c83c(0x167)](_0x39e16c);if(_0x2b3599){const _0x4c37ac=_0x2b3599[0x1];let _0xb32416=getBotAttributes(_0x4c37ac);_0x1e35b7[_0xc4c83c(0x2a8)]({'botID':_0x4c37ac,'botname':_0xb32416[_0xc4c83c(0x222)],'status':_0xc4c83c(0x301),'live':_0xc4c83c(0x1fb)}),_0x580ac9++;}}),_0x580ac9!=0x0&&(dbConfig[_0x481aec(0x22b)]('bots')[_0x481aec(0x1e8)](_0x1e35b7)[_0x481aec(0x22d)](),config=_0x1e35b7,restoredConfigFile=_0x580ac9);}}async function restoreConfigNotify(_0x1693f0){const _0x50c860=_0x59e1df;let _0xa19c61;if(restoredConfigFile==0x1)_0xa19c61=_0x50c860(0x19a);else _0xa19c61=_0x50c860(0x251);if(_0x1693f0)io['to'](_0x50c860(0x2b6))[_0x50c860(0x238)](_0x50c860(0x13e),_0xa19c61);else{logger['simple'](_0x50c860(0x2f7)),logger[_0x50c860(0x194)](_0xa19c61),logger[_0x50c860(0x194)](_0x50c860(0x2f7)),logger[_0x50c860(0x194)]('');if(tgBot&&settings[_0x50c860(0x215)]&&settings['telegramEvents']!=_0x50c860(0x1f6))tgBot[_0x50c860(0x162)](settings[_0x50c860(0x215)],_0x50c860(0x2d2)+_0xa19c61)[_0x50c860(0x1cb)](_0x163b29=>{telegramError(_0x163b29);});}}function validateCredentials(_0x3a78a1,_0x35e4a2){const _0x5d8b4d=_0x59e1df;if(_0x3a78a1[_0x5d8b4d(0x2ce)]==settings[_0x5d8b4d(0x150)]&&bcrypt[_0x5d8b4d(0x2eb)](_0x3a78a1[_0x5d8b4d(0x29f)],settings[_0x5d8b4d(0x137)])){if(settings[_0x5d8b4d(0x29a)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x1cff1c=generateLoginToken(_0x35e4a2);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1cff1c};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x22905f){const _0x283b87=generateLoginToken(_0x22905f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x283b87};}function validateAccess(_0x3fecea,_0x1e693f,_0xb7c651){const _0x2cba54=_0x59e1df,_0x18a054=_0xb7c651?_0xb7c651:devices[_0x1e693f]['ip'];let _0x443491;const _0x6eae03=_0x2958d1=>{const _0x540de1=_0x4818;if(settings[_0x540de1(0x2c8)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1e693f)){const _0x5de3b0=generateLoginToken(_0x1e693f);return{'allow':!![],'reason':_0x540de1(0x2a6),'token':_0x5de3b0};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x443491=validToken(_0x2958d1,_0x1e693f),_0x443491[_0x540de1(0x24c)](_0x540de1(0x13a))?{'allow':!![],'reason':_0x540de1(0x13c),'token':_0x2958d1}:{'allow':![],'reason':_0x540de1(0x143),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x2cba54(0x249)]){let _0x18cd27=[...settings[_0x2cba54(0x2d0)],'::1',_0x2cba54(0x225),'127.0.0.1'];if(_0x18cd27[_0x2cba54(0x189)](_0x18a054))return _0x6eae03(_0x3fecea);else{_0x443491=validToken(_0x3fecea,_0x1e693f);if(_0x443491['hasOwnProperty'](_0x2cba54(0x13a)))return _0x6eae03(_0x3fecea);else{if(telegramIpApproved(_0x1e693f)){const _0x332de6=generateToken(_0x1e693f);return _0x443491=_0x6eae03(_0x3fecea),_0x443491[_0x2cba54(0x19b)]?{'allow':!![],'reason':_0x2cba54(0x223),'token':_0x332de6}:_0x443491;}else return settings[_0x2cba54(0x1d7)]?{'allow':![],'reason':_0x2cba54(0x2ff),'token':null}:{'allow':![],'reason':_0x2cba54(0x1a7),'token':null};}}}else return _0x6eae03(_0x3fecea);}function timelyDecrypt(_0x49059f,_0x1db1e6=!![]){const _0x10033c=_0x59e1df;if(_0x49059f)try{const _0x5b4ced=crypt[_0x10033c(0x1ec)](secure[_0x10033c(0x22f)],_0x49059f)[_0x10033c(0x1c0)],_0x569faa=_0x5b4ced[_0x10033c(0x307)]('@')[0x0],_0x42daa8=_0x5b4ced[_0x10033c(0x307)]('@')[0x1],_0x559863=new Date()[_0x10033c(0x2c6)]();if(_0x1db1e6){if(_0x559863-_0x42daa8<maxSecretAge*0x3e8)return _0x569faa;else return![];}else return _0x569faa;}catch(_0x3c0270){return![];}else return![];}const validToken=(_0x3a1330,_0x526a9e)=>{const _0xb7656a=_0x59e1df,_0x2a038b=devices[_0x526a9e]['ip'];if(!_0x3a1330)return{'error':_0xb7656a(0x1bc)};for(let _0x1e70b9 of blacklist){if(_0x1e70b9[_0xb7656a(0x286)]==_0x3a1330)return{'error':_0xb7656a(0x16c)};}let _0x3806e1;try{_0x3806e1=jwt[_0xb7656a(0x1c5)](_0x3a1330,secure[_0xb7656a(0x166)]+_0x526a9e);}catch{return{'error':_0xb7656a(0x16b)};}if(!_0x3806e1[_0xb7656a(0x24c)](_0xb7656a(0x151))&&!_0x3806e1[_0xb7656a(0x24c)](_0xb7656a(0x2ce))||!_0x3806e1[_0xb7656a(0x24c)](_0xb7656a(0x2f6)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3806e1[_0xb7656a(0x24c)]('username')&&_0x3806e1[_0xb7656a(0x24c)](_0xb7656a(0x151))){const {clientip:_0x4bb491}=_0x3806e1;return _0x2a038b==_0x4bb491?{'success':_0xb7656a(0x196)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x3806e1[_0xb7656a(0x24c)](_0xb7656a(0x2ce))&&_0x3806e1[_0xb7656a(0x24c)](_0xb7656a(0x151))){const {username:_0x22b022,clientip:_0xca2109}=_0x3806e1;return settings['bbUsername']==_0x22b022&&_0x2a038b==_0xca2109?{'success':_0xb7656a(0x196)}:{'error':_0xb7656a(0x2ad)};}}},generateLoginToken=_0x891619=>{const _0x33d9af=_0x59e1df;if(_0x891619){const _0x54f927=devices[_0x891619]['ip'];return jwt[_0x33d9af(0x1ac)]({'username':settings['bbUsername'],'clientip':_0x54f927},secure['secret']+_0x891619,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4d2084=>{const _0x5af5a9=_0x59e1df;if(_0x4d2084){const _0x2a5882=devices[_0x4d2084]['ip'];return jwt[_0x5af5a9(0x1ac)]({'clientip':_0x2a5882},secure[_0x5af5a9(0x166)]+_0x4d2084,{'expiresIn':devices[_0x4d2084]['telegramIpApproval'][_0x5af5a9(0x1db)]*0x3c});}else return![];},telegramIpApproved=_0x5ceb74=>{const _0x1c6a59=_0x59e1df;let _0x3d9453=![];return devices[_0x5ceb74][_0x1c6a59(0x277)]&&devices[_0x5ceb74][_0x1c6a59(0x277)][_0x1c6a59(0x1db)]!=_0x1c6a59(0x258)&&(_0x3d9453=devices[_0x5ceb74][_0x1c6a59(0x277)][_0x1c6a59(0x151)]==devices[_0x5ceb74]['ip']&&new Date()[_0x1c6a59(0x2c6)]()-devices[_0x5ceb74][_0x1c6a59(0x277)][_0x1c6a59(0x2a2)]<devices[_0x5ceb74][_0x1c6a59(0x277)]['expiry']*0x3c*0x3e8),_0x3d9453;},telegram2FaApproved=_0x4dd8af=>{const _0x46a2b9=_0x59e1df;let _0x46574b=![];return devices[_0x4dd8af][_0x46a2b9(0x270)]&&devices[_0x4dd8af][_0x46a2b9(0x270)][_0x46a2b9(0x1db)]!=_0x46a2b9(0x258)&&(_0x46574b=devices[_0x4dd8af][_0x46a2b9(0x270)][_0x46a2b9(0x151)]==devices[_0x4dd8af]['ip']&&new Date()[_0x46a2b9(0x2c6)]()-devices[_0x4dd8af][_0x46a2b9(0x270)][_0x46a2b9(0x2a2)]<devices[_0x4dd8af][_0x46a2b9(0x270)][_0x46a2b9(0x1db)]*0x3c*0x3e8),_0x46574b;},normalizeIP=_0x351b98=>{const _0x556c78=_0x59e1df;let _0x156e37=null,_0x390592=null;if(ipaddr[_0x556c78(0x206)](_0x351b98)){const _0x18e82a=ipaddr[_0x556c78(0x23c)](_0x351b98);_0x18e82a['kind']()===_0x556c78(0x24e)?(_0x18e82a[_0x556c78(0x2ba)]()&&(_0x156e37=_0x18e82a[_0x556c78(0x1ce)]()['toString']()),_0x390592=_0x18e82a['toString']()):(_0x156e37=_0x18e82a['toString'](),_0x390592=_0x18e82a['toIPv4MappedAddress']()[_0x556c78(0x23e)]());}return{'show':_0x156e37?_0x156e37:_0x390592,'store':_0x390592};};function formatDate(_0x5956bb){const _0x2a128d=_0x59e1df;return _0x5956bb[_0x2a128d(0x22c)]()+'/'+(_0x5956bb[_0x2a128d(0x181)]()+0x1)[_0x2a128d(0x23e)]()[_0x2a128d(0x2e8)](0x2,'0')+'/'+_0x5956bb[_0x2a128d(0x16a)]()[_0x2a128d(0x23e)]()[_0x2a128d(0x2e8)](0x2,'0')+'\x20'+_0x5956bb[_0x2a128d(0x229)]()[_0x2a128d(0x23e)]()['padStart'](0x2,'0')+':'+_0x5956bb[_0x2a128d(0x2ef)]()[_0x2a128d(0x23e)]()[_0x2a128d(0x2e8)](0x2,'0')+':'+_0x5956bb[_0x2a128d(0x13f)]()['toString']()[_0x2a128d(0x2e8)](0x2,'0');}function sleep(_0x13f591){return new Promise(_0x8bfdb5=>setTimeout(_0x8bfdb5,_0x13f591));}