const _0x4d3bba=_0x43c8;(function(_0x1c3c90,_0x1aabd4){const _0xb04cf3=_0x43c8,_0xcd4468=_0x1c3c90();while(!![]){try{const _0x966693=parseInt(_0xb04cf3(0x369))/0x1*(parseInt(_0xb04cf3(0x2dc))/0x2)+-parseInt(_0xb04cf3(0x27e))/0x3*(parseInt(_0xb04cf3(0x227))/0x4)+-parseInt(_0xb04cf3(0x281))/0x5+-parseInt(_0xb04cf3(0x1ca))/0x6+-parseInt(_0xb04cf3(0x330))/0x7*(-parseInt(_0xb04cf3(0x37e))/0x8)+-parseInt(_0xb04cf3(0x25e))/0x9*(parseInt(_0xb04cf3(0x2b0))/0xa)+parseInt(_0xb04cf3(0x2bb))/0xb;if(_0x966693===_0x1aabd4)break;else _0xcd4468['push'](_0xcd4468['shift']());}catch(_0x4408e3){_0xcd4468['push'](_0xcd4468['shift']());}}}(_0x356b,0xe8642));const _0x278931=function(){let _0x1a2303=!![];return function(_0x2f8e7f,_0x2c4e7a){const _0x168ae4=_0x1a2303?function(){const _0x1e330a=_0x43c8;if(_0x2c4e7a){const _0x220081=_0x2c4e7a[_0x1e330a(0x1f3)](_0x2f8e7f,arguments);return _0x2c4e7a=null,_0x220081;}}:function(){};return _0x1a2303=![],_0x168ae4;};}(),_0x591c71=_0x278931(this,function(){const _0x575f80=_0x43c8;return _0x591c71['toString']()[_0x575f80(0x1dd)](_0x575f80(0x274))[_0x575f80(0x256)]()[_0x575f80(0x2fa)](_0x591c71)[_0x575f80(0x1dd)](_0x575f80(0x274));});_0x591c71();'use strict';process[_0x4d3bba(0x264)][_0x4d3bba(0x298)]=0x1;const childProcess=require(_0x4d3bba(0x214)),fs=require('fs'),fns=require(_0x4d3bba(0x34f)),low=require(_0x4d3bba(0x3ae)),FileSync=require(_0x4d3bba(0x370)),path=require(_0x4d3bba(0x37f)),crypto=require(_0x4d3bba(0x277)),Crypt=require(_0x4d3bba(0x263))[_0x4d3bba(0x3c2)],RSA=require(_0x4d3bba(0x263))[_0x4d3bba(0x21a)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x4d3bba(0x20a)),argv=require(_0x4d3bba(0x1d5))(process['argv'][_0x4d3bba(0x3a1)](0x2))[_0x4d3bba(0x2ce)],uuidRandom=require(_0x4d3bba(0x2d9)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x4d3bba(0x210)),axios=require(_0x4d3bba(0x27f)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x4d3bba(0x328)),fileUpload=require(_0x4d3bba(0x29e)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x4d3bba(0x2e5),pattern=/^[0-9]{2,4}$/;!pattern[_0x4d3bba(0x221)](PORT)&&(console[_0x4d3bba(0x3b6)](_0x4d3bba(0x1c1)+PORT+_0x4d3bba(0x337)),process[_0x4d3bba(0x23e)](0x1));const HOST=argv['host']||null,userID=argv[_0x4d3bba(0x30f)]||'',debugging=argv['d']||![],nodeversion=process[_0x4d3bba(0x2dd)][_0x4d3bba(0x346)];let bbpath=_0x4d3bba(0x31f),bbpath2='';const botfile=_0x4d3bba(0x358),configfile='bb-config.json',settingsfile=_0x4d3bba(0x394),securefile=_0x4d3bba(0x24a),environment=require('./'+bbpath2+_0x4d3bba(0x28d))[_0x4d3bba(0x290)]||_0x4d3bba(0x26d),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4d3bba(0x3ba)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4d3bba(0x2cb)),configpath=userID?bbpath+_0x4d3bba(0x3bf)+userID+'/':bbpath+_0x4d3bba(0x3bf),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x4d3bba(0x2c6),zippath=userID?bbpath+_0x4d3bba(0x1f1)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x4d3bba(0x2cd)](logspath+_0x4d3bba(0x243),{'flags':'a'}),temppath=userID?bbpath+_0x4d3bba(0x2fc)+userID+'/':bbpath+_0x4d3bba(0x2fc);!fs['existsSync'](configpath)&&fs[_0x4d3bba(0x276)](configpath);!fs[_0x4d3bba(0x3ba)](configbackuppath)&&fs[_0x4d3bba(0x276)](configbackuppath);!fs[_0x4d3bba(0x3ba)](logspath)&&fs[_0x4d3bba(0x276)](logspath);!fs[_0x4d3bba(0x3ba)](zippath)&&fs[_0x4d3bba(0x276)](zippath);!fs[_0x4d3bba(0x3ba)](temppath)&&fs[_0x4d3bba(0x276)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x4d3bba(0x2d0)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4d3bba(0x2b9)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4d3bba(0x216),'onepagemode':![],'marketcapApi':''}})[_0x4d3bba(0x2d0)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4d3bba(0x2b9)]({'secure':{},'blacklist':[]})[_0x4d3bba(0x2d0)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x4d3bba(0x226)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x4d3bba(0x2a7)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4d3bba(0x3c4)]&&(settings[_0x4d3bba(0x3c4)]!=''&&settings[_0x4d3bba(0x3c4)]!=_0x4d3bba(0x2f7))&&settings[_0x4d3bba(0x377)]&&settings[_0x4d3bba(0x377)]!='')initTelegram();const parseColor=(_0x56a54e,_0x189cde)=>{const _0x4c6e76=_0x4d3bba,_0x37ec68=/#[A-Z]{3}#/g;if(typeof _0x56a54e==_0x4c6e76(0x348)){!_0x189cde?_0x56a54e=_0x56a54e[_0x4c6e76(0x1f6)](_0x37ec68,''):(_0x56a54e=_0x56a54e[_0x4c6e76(0x1f6)](/#BLU#/g,'\x1b[34m'),_0x56a54e=_0x56a54e[_0x4c6e76(0x1f6)](/#RED#/g,_0x4c6e76(0x292)),_0x56a54e=_0x56a54e['replace'](/#YEL#/g,_0x4c6e76(0x1e4)),_0x56a54e=_0x56a54e['replace'](/#MAG#/g,_0x4c6e76(0x23a)),_0x56a54e=_0x56a54e[_0x4c6e76(0x1f6)](/#CYA#/g,_0x4c6e76(0x2cc)),_0x56a54e=_0x56a54e['replace'](/#RES#/g,'\x1b[0m'));;}return _0x56a54e;},logger={'screen':_0x55143a=>{const _0x3fe7f6=_0x4d3bba;console[_0x3fe7f6(0x3b6)](parseColor(_0x55143a,!![]));},'simple':_0x42d3ca=>{const _0x5a822b=_0x4d3bba;console['log'](parseColor(_0x42d3ca,!![])),loggerfile[_0x5a822b(0x2d0)](util['format'](parseColor(_0x42d3ca,![]))+'\x0a');},'full':async _0x5477d7=>{const _0x1400ec=_0x4d3bba,_0x523a3d=getTimeStamp()+_0x1400ec(0x36e)+_0x5477d7;console['log'](parseColor(_0x523a3d,!![])),loggerfile[_0x1400ec(0x2d0)](util[_0x1400ec(0x324)](parseColor(_0x523a3d,![]))+'\x0a');if(tgBot&&settings[_0x1400ec(0x1eb)]&&settings[_0x1400ec(0x398)]!=_0x1400ec(0x335))await sendTelegram(settings[_0x1400ec(0x1eb)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x5477d7,![]));},'debug':async(_0x5ff69e,_0x28a3ec='')=>{const _0x18adee=_0x4d3bba,_0x43d711=getTimeStamp()+_0x18adee(0x308)+_0x5ff69e;if(debugging)console[_0x18adee(0x3b6)](parseColor(_0x43d711,!![]));loggerfile[_0x18adee(0x2d0)](util['format'](parseColor(_0x43d711,![]))+'\x0a');if(_0x28a3ec){if(debugging)console['log'](_0x28a3ec);loggerfile[_0x18adee(0x2d0)](util[_0x18adee(0x324)](_0x28a3ec)+'\x0a');}}};let terminating=![];process['on'](_0x4d3bba(0x268),function(_0x3a3a95){const _0x5a6a4b=_0x4d3bba;_0x3a3a95['toString']()[_0x5a6a4b(0x350)](_0x5a6a4b(0x287))?(logger[_0x5a6a4b(0x2cf)](_0x5a6a4b(0x248)+_0x3a3a95[_0x5a6a4b(0x1f5)]+_0x5a6a4b(0x1e7)),process['send']({'terminate':!![]},_0x4b760d=>{})):logger['simple'](_0x3a3a95);}),process['on'](_0x4d3bba(0x23e),()=>{const _0x425732=_0x4d3bba;stopAllBots(),process[_0x425732(0x23e)](0x0);}),process['on'](_0x4d3bba(0x201),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x380086=_0x4d3bba;stopAllBots(),process[_0x380086(0x23e)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4d3bba(0x28d))[_0x4d3bba(0x30c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4d3bba(0x2f8)),app=express(),http=require(_0x4d3bba(0x25a))[_0x4d3bba(0x211)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x4d3bba(0x329)](_0x4d3bba(0x2f6),async(_0xd8eaf8,_0x1bf363)=>{const _0x2dedd5=_0x4d3bba,_0x36216b=_0xd8eaf8[_0x2dedd5(0x2c3)][_0x2dedd5(0x35a)],_0x5cf6a5=getClientsWithBotID('botmanager'),_0x55cfb6=_0xd8eaf8[_0x2dedd5(0x1f9)]['uuid'],_0x41d15a=timelyDecrypt(_0x55cfb6,![]),_0x1365c8=_0x5cf6a5[_0x2dedd5(0x289)](_0x1e6ed6=>_0x1e6ed6['uuid']==_0x41d15a);if(_0x1365c8){const _0x290b3f=normalizeIP(_0xd8eaf8[_0x2dedd5(0x203)]['remoteAddress'])[_0x2dedd5(0x21f)],_0x457024=_0xd8eaf8[_0x2dedd5(0x1f9)][_0x2dedd5(0x228)];if(validateAccess(_0x457024,_0x41d15a,_0x290b3f)[_0x2dedd5(0x1e2)])_0x36216b==_0x2dedd5(0x1c0)&&await backupConfigFiles(),await zipFiles(_0x36216b),_0x1bf363['download'](zippath+(_0x36216b+_0x2dedd5(0x1fc)),_0x128995=>{const _0x429960=_0x2dedd5;_0x128995&&(logger[_0x429960(0x23c)](_0x429960(0x2de)+_0x36216b),logger[_0x429960(0x2cf)](_0x128995));});else logger[_0x2dedd5(0x23c)](_0x2dedd5(0x26a)+_0x36216b+_0x2dedd5(0x230));}else logger[_0x2dedd5(0x23c)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x36216b+_0x2dedd5(0x2d5));}),app['post']('/upload-backup',async(_0x2a2732,_0x3cc898)=>{const _0x4ea9d2=_0x4d3bba,_0x1274aa=getClientsWithBotID(_0x4ea9d2(0x1da)),_0x21e90a=_0x2a2732[_0x4ea9d2(0x1f9)][_0x4ea9d2(0x374)],_0xebbfa=timelyDecrypt(_0x21e90a,![]),_0x5152cd=_0x1274aa[_0x4ea9d2(0x289)](_0x7deca3=>_0x7deca3[_0x4ea9d2(0x374)]==_0xebbfa);logger[_0x4ea9d2(0x28a)]('Backup\x20file\x20uploaded');if(_0x5152cd){const _0x28bd32=normalizeIP(_0x2a2732[_0x4ea9d2(0x203)][_0x4ea9d2(0x204)])[_0x4ea9d2(0x21f)],_0x5e5fb3=_0x2a2732['headers'][_0x4ea9d2(0x228)];if(validateAccess(_0x5e5fb3,_0xebbfa,_0x28bd32)[_0x4ea9d2(0x1e2)]){if(_0x2a2732[_0x4ea9d2(0x385)]){const _0xc1cb21=_0x2a2732['files'][_0x4ea9d2(0x30e)];await _0xc1cb21['mv'](temppath+_0xc1cb21[_0x4ea9d2(0x242)]),_0x3cc898[_0x4ea9d2(0x351)]({'status':!![],'message':_0x4ea9d2(0x21c)});const _0x4d5cf3=getBotsWithMode();_0x4d5cf3[_0x4ea9d2(0x36d)]>0x0?confirmRestore(temppath,_0xc1cb21[_0x4ea9d2(0x242)]):unzipFile(temppath,_0xc1cb21['name']);}}else logger['full'](_0x4ea9d2(0x2c9));}else logger[_0x4ea9d2(0x23c)](_0x4ea9d2(0x208));}),app['use'](express[_0x4d3bba(0x2e2)](path[_0x4d3bba(0x2a4)](__dirname,bbpath2,'build2'))),app['use'](express['static'](path[_0x4d3bba(0x2a4)](__dirname,bbpath2,_0x4d3bba(0x32c)))),app[_0x4d3bba(0x329)]('/',function(_0x4cef1b,_0x1093ac){const _0x2357bf=_0x4d3bba;_0x1093ac[_0x2357bf(0x279)](path[_0x2357bf(0x2a4)](__dirname,bbpath2,'build2',_0x2357bf(0x2a6)));}),app[_0x4d3bba(0x329)](_0x4d3bba(0x313),function(_0x19ef03,_0x5df319){const _0x3d591c=_0x4d3bba;_0x5df319[_0x3d591c(0x279)](path[_0x3d591c(0x2a4)](__dirname,bbpath2,'build',_0x3d591c(0x2a6)));}),app['get'](_0x4d3bba(0x352),(_0x46288f,_0x17f86e)=>{const _0x468e78=_0x4d3bba;_0x17f86e[_0x468e78(0x279)](path[_0x468e78(0x2a4)](__dirname,bbpath2,_0x468e78(0x32c),_0x468e78(0x2a6)));}),app[_0x4d3bba(0x329)](_0x4d3bba(0x266),(_0x21ff9e,_0x4dd747)=>{const _0x3b2e8b=_0x4d3bba;_0x4dd747['sendFile'](path[_0x3b2e8b(0x2a4)](__dirname,bbpath2,_0x3b2e8b(0x32c),_0x3b2e8b(0x2a6)));}),app[_0x4d3bba(0x329)](_0x4d3bba(0x258),(_0x2edcbd,_0xa27f8)=>{const _0x5621fc=_0x4d3bba;_0xa27f8['sendFile'](path['join'](__dirname,bbpath2,_0x5621fc(0x32c),_0x5621fc(0x2a6)));}),app[_0x4d3bba(0x329)](_0x4d3bba(0x284),(_0x12e640,_0x54c24d)=>{const _0x2d70d4=_0x4d3bba;_0x54c24d['sendFile'](path[_0x2d70d4(0x2a4)](__dirname,bbpath2,_0x2d70d4(0x32c),_0x2d70d4(0x2a6)));}),app[_0x4d3bba(0x329)](_0x4d3bba(0x1ea),(_0x4950bb,_0x337b84)=>{const _0x55abaa=_0x4d3bba;_0x337b84[_0x55abaa(0x279)](path[_0x55abaa(0x2a4)](__dirname,bbpath2,_0x55abaa(0x32c),_0x55abaa(0x2a6)));}),app[_0x4d3bba(0x329)](_0x4d3bba(0x260),(_0x5b8329,_0x2bb9b1)=>{const _0x89cf84=_0x4d3bba;_0x2bb9b1['sendFile'](path[_0x89cf84(0x2a4)](__dirname,bbpath2,_0x89cf84(0x32c),_0x89cf84(0x2a6)));});if(HOST)http[_0x4d3bba(0x321)](PORT,HOST);else http[_0x4d3bba(0x321)](PORT);const io=require('socket.io')(http,{});function _0x356b(){const _0x496131=['versions','Failed\x20to\x20download\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','inlineKeyboard','delete-bot','static','blacklist','get-backup-files','3000','Token\x20blacklisted','rmSync','secret','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','padStart','Unauthorized\x20attempt\x20to\x20delete\x20alerts','bbUsername','isDirectory','1000','forEach','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','stopped','connected','All\x20bots\x20running\x20right\x20now','apiPassword','/enable\x20-\x20enable\x20notifications\x0a','/download/:type','***','express','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','constructor','logged\x20out','temp/','login\x20token\x20valid','mtime','Login\x20accepted','sockets','deleteHistoryAlerts','store-settings','Invalid\x20authentication\x20token\x20(1)','initclient','restore-backup-file','split','generate',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','/start','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','version','invalid\x20credentials','backupfile','user','toggle_','names','reset-history','/:bot','Notifications\x20disabled','You\x20can\x20use\x20the\x20following\x20commands:\x0a','command','Bot\x20Mgr\x20>\x20','ETH','store-headless','size','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Markdown','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','lastmsgemitted','bb/','button','listen','(staging)','storeHeadless','format','Backup\x20file\x20unzipped\x20and\x20stored','Unauthorized\x20attempt\x20to\x20update\x20settings','HTML','util','get','backup-full','any','build','\x20|\x20','fork','remove','721fHZVpK','Bot\x20','status','toIPv4MappedAddress',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','orders','enabled',',\x20must\x20be\x20a\x204\x20digit\x20number','bbPassword','launch','portfolio','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','login\x20not\x20required','push','address','started','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','username','assign','reinstall_no','off','node','Idling\x20(','string','BCT','sendPortfolioTelegram','update_no','storeFiat','-results.json','place-order','date-fns','includes','send','/:bot/portfolio','pidRefreshToken','text','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','bots','all','bot.js','-config.json','type','lastmsgtelegram','success','showConfig','Restore\x20process\x20aborted','entries','then','getHours','\x20|\x20user:\x20...','new-disabled','delete-alerts','telegram2FaApproval','2FA\x20required','once','\x20-\x20','9RfajiB','emit','resetpw_no','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','length',':\x20Bot\x20Mgr\x20>\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','lowdb/adapters/FileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','All\x20bots','generateKeyPairAsync','uuid','settings','Starting\x20Balance\x20Bot\x20update','telegramUsername','Unauthorized\x20attempt\x20to\x20log\x20out','decrypt','temporary\x20token\x20generated','randomFillSync','marketcapApi','getSeconds','20144qJPDTz','path','keys','Network\x20Interfaces:','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','restore_yes_','mode','files','Telegram\x20error:','new','botname','number','callback','getFullYear','/names\x20-\x20show\x20bot\x20names\x0a','loginRequired','showname','parse','reason','chat','sortBy','isValid','bb-settings.json','login\x20token\x20generated','auto','No\x20authentication\x20token','telegramEvents','warning','toggle','-----------------------------------------------------------------------------------','config_orders','alerts','confirm-message','endsWith','Login\x20rejected','slice','Unauthorized\x20attempt\x20to\x20store\x20configuration','yes','2FA\x20login\x20token\x20generated','restore_no_','Telegraf\x20error:','output-002.log','code','Enabled\x20Bot\x20','request','clientip','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Notifications\x20enabled','lowdb','track','hex','config','get-portfolio','Starting\x20Balance\x20Bot\x20reinstallation','pidExpireLogin','Invalid\x20username\x20or\x20IP\x20address','log','publicKey','botID','copyFileSync','existsSync','onepagemode','disable','https://api.ipify.org?format=json','*$1*','config/','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','::1','Crypt','data','telegramToken','whitelist','whitelistEnabled','\x20>\x20','backup','Error:\x20Invalid\x20argument\x20','portfolio_','telegramEnabled','login','privateKey','<b>Balance\x20Bot\x20Status:</b>\x0a','expiry','temporary\x20access\x20timeout','-performance.json','2190600zFuSQO','Node.js\x20v','get-messages','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','inherit','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','/help\x20-\x20show\x20available\x20commands\x0a','************','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','yargs/yargs','conn','notification','binary','Invalid\x20IP\x20address','botmanager','password','running','search','/update\x20-\x20update\x20Balance\x20Bot\x0a','Setting\x20access:\x20','function','::ffff:127.0.0.1','allow','filter','\x1b[33m','User\x20has\x20been\x20validated','telegramIpApproval','#RES#','sign','store-configuration','/:bot/configuration','telegramChatId','help','\x20mode','access','output-001.log','Restore\x20process\x20confirmed','zip/','placeOrder','apply','sort','port','replace','output-000.log','updatebotmanager','headers','temporaryAccessAllowed','unlinkSync','.zip','-events.json','max','get-logs','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','SIGTERM','Starting\x20new\x20bot\x20|\x20Bot\x20','socket','remoteAddress','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','f2aRequired','backup-files','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','ipaddr.js','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','/off\x20-\x20stop\x20bot(s)\x0a','Restarting\x20Bot\x20','timeshift','status\x20code\x20401','mixpanel','createServer','Server','match','child_process','<b>Telegram\x20Bot\x20Status:</b>\x0a','0.0.0','disabled','restart','temporary\x20access\x20rejected','RSA','apiSecret','File\x20uploaded','Notifications\x20enabled\x0a','apiKey','store','manual','test','family','file','timestamp','Allow\x20login\x20from\x20IP\x20address\x20','init','546452FEAqst','tkn','config_alerts','reply','headless','reinstall-bb','show-config','Logged\x20in\x20user\x20...','SIGINT','\x20(1)','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Temporary\x20access\x20rejected','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','getStartingBalances','use','ipc','set','sendMessage','reinstall_yes','\x1b[35m','toIPv4Address','full','value','exit','Unauthorized\x20attempt\x20to\x20update\x20bot','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','messages','name','/output-000.log','Disabled\x20Bot\x20','error','Unauthorized\x20attempt\x20to\x20confirm\x20message','Unauthorized\x20attempt\x20to\x20get\x20events','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','|@|','bb-secure.json','getTime','secure','Access\x20enabled\x20for\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','latestversion','add','editMessageReplyMarkup','update_yes','reject','exec','exchange','toString','off_','/:bot/coins','Deleted\x20Bot\x20','http','Restore\x20backup\x20file\x20','stop','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','8028EsYPvQ','kind','/:bot/support','alias','2FA\x20login\x20required','hybrid-crypto-js','env','temporary\x20access\x20not\x20allowed','/:bot/performance','30\x20min','uncaughtException','handshake','Unauthorized\x20attempt\x20to\x20download\x20','update-bb','writeFileSync','production','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Ok,\x20will\x20send\x20alert\x20notifications\x20only','metrics','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getMonth','live','(((.+)+)+)+$','\x20minutes','mkdirSync','crypto','getPortfolio','sendFile','/disable\x20-\x20disable\x20notifications\x0a','_data','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','33eGAncz','axios','config_all','7928070yIuTeY','hashSync','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/:bot/history','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Yes','address\x20already\x20in\x20use','bot','find','debug','reload','silentRestart','version.json','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20get\x20portfolio','environment','action','\x1b[31m','telegrammsg','message','getDate','readFileSync','catch','NTBA_FIX_319','tempaccess_30_',')\x20|\x20Bot\x20','accept','reset-password','stringify','express-fileupload','encryptedUuid','\x20only\x0a','randomBytes','Password\x20reset\x20rejected','readdirSync','join','#RES#\x20if\x20running\x20locally\x0a','index.html','api-eu.mixpanel.com','login2fa_reject_','disconnect','Unauthorized\x20attempt\x20to\x20get\x20messages','Restarting\x20(silent)\x20Bot\x20','No\x20bots\x20running\x20right\x20now','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getMinutes','bbvNew','7840dKibde','telegram','token','127.0.0.1','show','IPv4','hasOwnProperty','Starting\x20#RED#Balance\x20Bot\x20v','reinstall','defaults','emitHistory','51221236ymQlgi','cancel-loading','Your\x20installation\x20is\x20already\x20up\x20to\x20date','node-zip','removeAllListeners','bbvReceive','startsWith','settings.','params','userid','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','logs/','resetpw_yes','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','order','clients','\x1b[36m','createWriteStream','argv','simple','write','backup-full@','kill','Password\x20has\x20been\x20reset\x20to:\x20','ipv6','\x20(2)','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','add-bot','bot-','uuid-random','private','update','41962CRqrAm'];_0x356b=function(){return _0x496131;};return _0x356b();}init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xab6773=_0x4d3bba;let _0x45a9bf='[ip-address]';const _0x4fe2fa=networkInterfaces(),_0x13a6ac={};for(const _0x260b9d of Object[_0xab6773(0x380)](_0x4fe2fa)){for(const _0x2275c9 of _0x4fe2fa[_0x260b9d]){if((_0x2275c9[_0xab6773(0x222)]==_0xab6773(0x2b5)||_0x2275c9['family']==0x4)&&!_0x2275c9['internal']){const _0x50e1a0=ipaddr[_0xab6773(0x38f)](_0x2275c9['address'])['range']();_0x50e1a0!=_0xab6773(0x2da)&&(!_0x13a6ac[_0x260b9d]&&(_0x13a6ac[_0x260b9d]=[]),_0x13a6ac[_0x260b9d][_0xab6773(0x33d)](_0x2275c9['address']),_0x45a9bf=_0x2275c9[_0xab6773(0x33e)]);}}}return{'serverip':_0x45a9bf,'netinterfaces':_0x13a6ac};}async function startServer(){const _0x40b99e=_0x4d3bba,{serverip:_0x35d020,netinterfaces:_0x484f0f}=getServerIP();logger[_0x40b99e(0x2cf)](''),logger[_0x40b99e(0x2cf)]('-----------------------------------------------------------------------------------'),await logger[_0x40b99e(0x23c)](_0x40b99e(0x2b7)+serverversion+'#RES#\x20'+(environment=='staging'?_0x40b99e(0x322):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x40b99e(0x2a5))+('=>\x20Go\x20to\x20#CYA#http://'+_0x35d020+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x40b99e(0x2cf)](_0x40b99e(0x39b));if(config[_0x40b99e(0x36d)]!=0x0)for(const _0x1d49e6 of config){const _0x3150a3=_0x1d49e6['mode']=='auto'?'a':'m';if(_0x1d49e6[_0x40b99e(0x332)]==_0x40b99e(0x336)||_0x1d49e6[_0x40b99e(0x332)]==_0x40b99e(0x387))await logger[_0x40b99e(0x23c)]('Starting\x20('+_0x3150a3+_0x40b99e(0x29a)+_0x1d49e6[_0x40b99e(0x3b8)]+'\x20|\x20'+_0x1d49e6[_0x40b99e(0x388)]),startBot([_0x1d49e6['botID'],userID],{'cwd':bbpath},function(_0xd45539){const _0x519b6e=_0x40b99e;if(_0xd45539)logger[_0x519b6e(0x23c)](_0xd45539);});else(_0x1d49e6[_0x40b99e(0x332)]==_0x40b99e(0x217)||_0x1d49e6['status']==_0x40b99e(0x363))&&await logger[_0x40b99e(0x23c)](_0x40b99e(0x347)+_0x3150a3+')\x20\x20\x20|\x20Bot\x20'+_0x1d49e6['botID']+_0x40b99e(0x32d)+_0x1d49e6['botname']);}else!newBot&&logger['simple'](_0x40b99e(0x2ad));if(newBot)addBot();logger[_0x40b99e(0x2cf)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x40b99e(0x28a)](_0x40b99e(0x1cb)+nodeversion),await logger[_0x40b99e(0x28a)](_0x40b99e(0x381),_0x484f0f);}function startSocket(){io['on']('connection',_0x2ca0c9=>{const _0x15c6b4=_0x43c8;let _0x2a27af,_0x107302,_0x2e4415,_0x246432,_0x384765;const _0x273824=_0x2ca0c9['handshake'][_0x15c6b4(0x1f9)]['referer'];_0x107302=_0x273824[_0x15c6b4(0x213)](/bot[0-9]{3}/);if(_0x107302)_0x2e4415=_0x107302[0x0][_0x15c6b4(0x213)](/[0-9]{3}/);if(_0x2e4415)_0x2a27af=_0x2e4415[0x0];else _0x2a27af=_0x15c6b4(0x1da);const _0x2e61ff=_0x2ca0c9[_0x15c6b4(0x269)]['auth'][_0x15c6b4(0x29f)];if(!_0x2e61ff)_0x2ca0c9[_0x15c6b4(0x36a)](_0x15c6b4(0x332),{'publicKey':secure[_0x15c6b4(0x3b7)]});else{_0x246432=timelyDecrypt(_0x2e61ff,![]);if(!_0x246432)_0x2ca0c9[_0x15c6b4(0x36a)](_0x15c6b4(0x332),{'publicKey':secure['publicKey']});else{_0x384765=normalizeIP(_0x2ca0c9[_0x15c6b4(0x1d6)][_0x15c6b4(0x204)])[_0x15c6b4(0x21f)];if(!devices[_0x246432])devices[_0x246432]={'uuid':_0x246432,'access':{'token':null}};devices[_0x246432]['ip']=_0x384765;const _0x25715d=addClient(_0x2ca0c9['id'],_0x246432,_0x2a27af);setAccess(_0x25715d),emitMessages(),_0x2ca0c9['on']('login',_0xd389c=>{const _0x7a09e9=_0x15c6b4,_0x42661c=timelyDecrypt(_0xd389c[_0x7a09e9(0x1db)],!![],'|@|');if(_0x42661c){_0xd389c={'username':_0xd389c[_0x7a09e9(0x342)],'password':_0x42661c},devices[_0x246432][_0x7a09e9(0x1ee)]=validateCredentials(_0xd389c,_0x246432);if(devices[_0x246432][_0x7a09e9(0x1ee)][_0x7a09e9(0x1e2)]==![]&&devices[_0x246432]['access'][_0x7a09e9(0x390)]==_0x7a09e9(0x262))_0x2ca0c9[_0x7a09e9(0x36a)](_0x7a09e9(0x332),{'access':devices[_0x246432][_0x7a09e9(0x1ee)]}),loginAccess2FA(_0x246432,_0x384765);else{if(devices[_0x246432][_0x7a09e9(0x1ee)]['allow']==![]&&devices[_0x246432][_0x7a09e9(0x1ee)][_0x7a09e9(0x390)]==_0x7a09e9(0x30d))_0x2ca0c9[_0x7a09e9(0x36a)](_0x7a09e9(0x332),{'access':devices[_0x246432]['access']});else devices[_0x246432][_0x7a09e9(0x1ee)][_0x7a09e9(0x1e2)]&&devices[_0x246432][_0x7a09e9(0x1ee)][_0x7a09e9(0x390)]==_0x7a09e9(0x395)&&(getClientsWithUuid(_0x246432)[_0x7a09e9(0x2ef)](_0x40476f=>{setAccess(_0x40476f);}),logger[_0x7a09e9(0x28a)](_0x7a09e9(0x22e)+_0x246432[_0x7a09e9(0x3a1)](-0x8)),setTokenRefresh(_0x246432),setSessionTimeout(_0x7a09e9(0x1c4),_0x246432));}}else logger[_0x7a09e9(0x23c)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2ca0c9['on'](_0x15c6b4(0x29c),()=>{resetPassword();}),_0x2ca0c9['on'](_0x15c6b4(0x2a9),_0x189d83=>{removeClient(_0x2ca0c9['id']);}),_0x2a27af==_0x15c6b4(0x1da)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x51f27d){const _0x3a9aeb=_0x4d3bba;if(_0x51f27d!=_0x3a9aeb(0x1da)&&config[_0x3a9aeb(0x21e)]!=''){if(pid[_0x51f27d])pid[_0x51f27d][_0x3a9aeb(0x351)]({'function':_0x3a9aeb(0x304),'args':null});}_0x51f27d!=_0x3a9aeb(0x1da)&&broadcastToBots(_0x3a9aeb(0x356),JSON[_0x3a9aeb(0x29d)](config));}function reloadBotManager(){const _0x1f6e69=_0x4d3bba;getClientsWithBotID('botmanager')[_0x1f6e69(0x2ef)](_0x4b731b=>{const _0x402a99=_0x1f6e69;getSocket(_0x4b731b['id'])['emit'](_0x402a99(0x332),{'access':{'allow':![],'reason':_0x402a99(0x28b),'token':null}});});}function getSocket(_0x90c366){const _0x2d5dc6=_0x4d3bba;return io[_0x2d5dc6(0x300)][_0x2d5dc6(0x300)][_0x2d5dc6(0x329)](_0x90c366);}function setAccess(_0x21b0cb){const _0x27a6f4=_0x4d3bba,_0x162e2b=getSocket(_0x21b0cb['id']),_0x427d27=_0x21b0cb[_0x27a6f4(0x374)],_0x59d918=_0x21b0cb['bot'];devices[_0x427d27][_0x27a6f4(0x1ee)]=validateAccess(devices[_0x427d27][_0x27a6f4(0x1ee)]['token'],_0x427d27),logger[_0x27a6f4(0x28a)](_0x27a6f4(0x1df)+devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x390)]+'\x20|\x20client:\x20...'+_0x21b0cb['id'][_0x27a6f4(0x3a1)](-0x8)+_0x27a6f4(0x362)+_0x427d27[_0x27a6f4(0x3a1)](-0x8)),_0x162e2b[_0x27a6f4(0x2a4)](_0x427d27);if(devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x1e2)]){_0x162e2b['join'](_0x59d918);if(_0x59d918=='botmanager')initializeSocketBotManager(_0x162e2b);else initializeSocketBot(_0x162e2b);initClient(_0x59d918);}devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x2b2)]&&devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x390)]==_0x27a6f4(0x37a)&&setSessionTimeout('2FA',_0x427d27),devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x2b2)]&&devices[_0x427d27][_0x27a6f4(0x1ee)]['reason']==_0x27a6f4(0x3a4)&&setSessionTimeout('login',_0x427d27),_0x162e2b[_0x27a6f4(0x36a)](_0x27a6f4(0x332),{'status':_0x21b0cb['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x427d27][_0x27a6f4(0x1ee)],'externalip':devices[_0x427d27]['ip'],'publicKey':secure[_0x27a6f4(0x3b7)],'userid':settings[_0x27a6f4(0x2c4)],'validInstallation':validInstallation}),devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x1e2)]==![]&&devices[_0x427d27][_0x27a6f4(0x1ee)][_0x27a6f4(0x390)]==_0x27a6f4(0x366)&&temporaryAccess2FA(_0x427d27,devices[_0x427d27]['ip']);}function setSessionTimeout(_0x1c13dd,_0x379da6){const _0x5c1adb=_0x4d3bba;let _0x114ef7;if(_0x1c13dd==_0x5c1adb(0x1c4))_0x114ef7=loginExpiry*0x3c*0x3e8;else _0x114ef7=devices[_0x379da6][_0x5c1adb(0x1e6)]['expiry']*0x3c*0x3e8-(new Date()[_0x5c1adb(0x24b)]()-devices[_0x379da6]['telegramIpApproval'][_0x5c1adb(0x224)]);if(devices[_0x379da6][_0x5c1adb(0x3b4)])clearTimeout(devices[_0x379da6]['pidExpireLogin']);devices[_0x379da6]['pidExpireLogin']=setTimeout(()=>{const _0x31a524=_0x5c1adb;if(devices[_0x379da6][_0x31a524(0x353)])clearTimeout(devices[_0x379da6][_0x31a524(0x353)]);removeSocketListeners(_0x379da6),addBlacklist(_0x379da6),devices[_0x379da6][_0x31a524(0x1e6)]=null,devices[_0x379da6][_0x31a524(0x365)]=null,devices[_0x379da6][_0x31a524(0x1ee)][_0x31a524(0x2b2)]=null,logger[_0x31a524(0x28a)]('Session\x20expired\x20for\x20user\x20...'+_0x379da6[_0x31a524(0x3a1)](-0x8)),devices[_0x379da6][_0x31a524(0x1ee)]=validateAccess(devices[_0x379da6]['access'][_0x31a524(0x2b2)],_0x379da6),!(devices[_0x379da6][_0x31a524(0x1ee)]['allow']&&devices[_0x379da6][_0x31a524(0x1ee)][_0x31a524(0x390)]==_0x31a524(0x33c))&&(_0x1c13dd=='login'?io['to'](_0x379da6)[_0x31a524(0x36a)](_0x31a524(0x332),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x379da6)['emit']('status',{'access':{'allow':![],'reason':_0x31a524(0x1c8),'token':null}})),devices[_0x379da6][_0x31a524(0x1ee)]['token']=null;},_0x114ef7);}function setTokenRefresh(_0x36e785){const _0x53d851=_0x4d3bba;if(devices[_0x36e785][_0x53d851(0x353)])clearTimeout(devices[_0x36e785][_0x53d851(0x353)]);devices[_0x36e785]['pidRefreshToken']=setTimeout(()=>{const _0xace22f=_0x53d851;getClientsWithUuid(_0x36e785)['length']!=0x0?(devices[_0x36e785][_0xace22f(0x1ee)]=refreshToken(_0x36e785),io['to'](_0x36e785)[_0xace22f(0x36a)](_0xace22f(0x332),{'status':_0xace22f(0x2f2),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x36e785][_0xace22f(0x1ee)],'externalip':devices[_0x36e785]['ip'],'publicKey':secure[_0xace22f(0x3b7)],'validInstallation':validInstallation}),setTokenRefresh(_0x36e785)):clearTimeout(devices[_0x36e785][_0xace22f(0x353)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x319135){const _0xbe30f7=_0x4d3bba,_0x183eec=getClient(_0x319135['id'])[_0xbe30f7(0x374)];_0x319135[_0xbe30f7(0x36a)](_0xbe30f7(0x356),config),_0x319135[_0xbe30f7(0x36a)]('settings',cleanSettings()),_0x319135['on'](_0xbe30f7(0x2d7),_0x439de3=>{const _0x3892c2=_0xbe30f7;if(validateAccess(_0x439de3,_0x183eec)[_0x3892c2(0x1e2)])addBot();else logger[_0x3892c2(0x23c)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x319135['on']('update-bot',(_0x97ccb5,_0x1c0c59)=>{const _0xdc9a8c=_0xbe30f7;if(validateAccess(_0x1c0c59,_0x183eec)[_0xdc9a8c(0x1e2)])toggleBot(_0x97ccb5[_0xdc9a8c(0x3b8)],_0x97ccb5[_0xdc9a8c(0x332)],_0x97ccb5['live']);else logger[_0xdc9a8c(0x23c)](_0xdc9a8c(0x23f));}),_0x319135['on']('toggle-bot-mode',(_0x492884,_0x1c2e75)=>{const _0x582f04=_0xbe30f7;if(validateAccess(_0x1c2e75,_0x183eec)[_0x582f04(0x1e2)])toggleBotMode(_0x492884);else logger[_0x582f04(0x23c)](_0x582f04(0x23f));}),_0x319135['on'](_0xbe30f7(0x2e1),(_0x37d76b,_0x3ebd8a)=>{const _0x97fd79=_0xbe30f7;if(validateAccess(_0x3ebd8a,_0x183eec)[_0x97fd79(0x1e2)])deleteBot(_0x37d76b);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x319135['on'](_0xbe30f7(0x302),(_0x238a57,_0x2a9cae)=>{const _0x28ba7a=_0xbe30f7;if(validateAccess(_0x2a9cae,_0x183eec)[_0x28ba7a(0x1e2)])storeSettings(_0x238a57,!![]);else logger['full'](_0x28ba7a(0x326));}),_0x319135['on'](_0xbe30f7(0x26b),_0x4b97d8=>{const _0x5c56b4=_0xbe30f7;if(validateAccess(_0x4b97d8,_0x183eec)[_0x5c56b4(0x1e2)])updateBB(_0x5c56b4(0x2db));else logger[_0x5c56b4(0x23c)](_0x5c56b4(0x1d3));}),_0x319135['on'](_0xbe30f7(0x22c),_0x31953a=>{const _0x5b33f5=_0xbe30f7;if(validateAccess(_0x31953a,_0x183eec)[_0x5b33f5(0x1e2)])updateBB(_0x5b33f5(0x2b8));else logger[_0x5b33f5(0x23c)](_0x5b33f5(0x27d));}),_0x319135['on'](_0xbe30f7(0x2e4),_0x9fe331=>{const _0x598c20=_0xbe30f7;if(validateAccess(_0x9fe331,_0x183eec)['allow']){const _0x26ad48=getClient(_0x319135['id']);if(_0x26ad48)getBackupFiles(_0x26ad48[_0x598c20(0x374)]);else logger['full'](_0x598c20(0x1d4));}else logger['full'](_0x598c20(0x26e));}),_0x319135['on'](_0xbe30f7(0x305),(_0x318f8e,_0xf325a7)=>{const _0x3efc69=_0xbe30f7;if(validateAccess(_0xf325a7,_0x183eec)[_0x3efc69(0x1e2)])restoreBackupFile(_0x318f8e);else logger[_0x3efc69(0x23c)](_0x3efc69(0x340));}),_0x319135['on'](_0xbe30f7(0x1cc),_0x5ed080=>{const _0x578670=_0xbe30f7;if(validateAccess(_0x5ed080,_0x183eec)[_0x578670(0x1e2)])getMessages();else logger[_0x578670(0x23c)](_0x578670(0x2aa));}),_0x319135['on'](_0xbe30f7(0x39e),(_0x432361,_0x3dd1ac)=>{const _0x7c182c=_0xbe30f7;if(validateAccess(_0x3dd1ac,_0x183eec)[_0x7c182c(0x1e2)])confirmMessage(_0x432361);else logger[_0x7c182c(0x23c)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x319135['on']('logout',_0xef079e=>{const _0x155d70=_0xbe30f7;if(validateAccess(_0xef079e,_0x183eec)['allow']){if(devices[_0x183eec][_0x155d70(0x353)])clearTimeout(devices[_0x183eec][_0x155d70(0x353)]);if(devices[_0x183eec]['pidExpireLogin'])clearTimeout(devices[_0x183eec]['pidExpireLogin']);removeSocketListeners(getClient(_0x319135['id'])[_0x155d70(0x374)]),addBlacklist(_0x183eec),devices[_0x183eec]['telegramIpApproval']=null,devices[_0x183eec][_0x155d70(0x365)]=null,devices[_0x183eec][_0x155d70(0x1ee)][_0x155d70(0x2b2)]=null,logger[_0x155d70(0x28a)]('Logged\x20out\x20user\x20...'+_0x183eec[_0x155d70(0x3a1)](-0x8)),io['to'](getClient(_0x319135['id'])[_0x155d70(0x374)])[_0x155d70(0x36a)](_0x155d70(0x332),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x155d70(0x23c)](_0x155d70(0x378));});}function initializeSocketBot(_0x48ebbe){const _0x48ba25=_0x4d3bba,_0x5555d1=getClient(_0x48ebbe['id'])['bot'],_0x5cd8ea=getClient(_0x48ebbe['id'])['uuid'];_0x48ebbe['on'](_0x48ba25(0x1ff),(_0x470cdc,_0x477dd6)=>{const _0x47291a=_0x48ba25;if(validateAccess(_0x477dd6,_0x5cd8ea)[_0x47291a(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1]['send']({'function':_0x47291a(0x2ba),'args':_0x470cdc});}else logger[_0x47291a(0x23c)](_0x47291a(0x247));}),_0x48ebbe['on'](_0x48ba25(0x364),(_0x1a933b,_0x3ec126)=>{const _0x374590=_0x48ba25;if(validateAccess(_0x3ec126,_0x5cd8ea)[_0x374590(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1]['send']({'function':_0x374590(0x301),'args':_0x1a933b});}else logger[_0x374590(0x23c)](_0x374590(0x2eb));}),_0x48ebbe['on'](_0x48ba25(0x3b2),(_0x1efcae,_0x506060)=>{const _0x5946ee=_0x48ba25;if(validateAccess(_0x506060,_0x5cd8ea)['allow']){if(pid[_0x5555d1])pid[_0x5555d1]['send']({'function':_0x5946ee(0x278),'args':_0x1efcae});}else logger[_0x5946ee(0x23c)](_0x5946ee(0x28f));}),_0x48ebbe['on'](_0x48ba25(0x1e9),(_0x31e0a5,_0x235b32)=>{const _0x49490a=_0x48ba25;if(validateAccess(_0x235b32,_0x5cd8ea)[_0x49490a(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x49490a(0x351)]({'function':'storeConfiguration','args':_0x31e0a5});}else logger[_0x49490a(0x23c)](_0x49490a(0x3a2));}),_0x48ebbe['on'](_0x48ba25(0x319),(_0x5dbb38,_0x2e5a36)=>{const _0x470c41=_0x48ba25;if(validateAccess(_0x2e5a36,_0x5cd8ea)[_0x470c41(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x470c41(0x351)]({'function':_0x470c41(0x323),'args':_0x5dbb38});}else logger[_0x470c41(0x23c)](_0x470c41(0x271));}),_0x48ebbe['on']('store-fiat',(_0x31b626,_0x49b0f9)=>{const _0x58b7e0=_0x48ba25;if(validateAccess(_0x49b0f9,_0x5cd8ea)[_0x58b7e0(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x58b7e0(0x351)]({'function':_0x58b7e0(0x34c),'args':_0x31b626});}else logger[_0x58b7e0(0x23c)](_0x58b7e0(0x2c8));}),_0x48ebbe['on'](_0x48ba25(0x312),_0x49bab7=>{const _0x54a3b4=_0x48ba25;if(validateAccess(_0x49bab7,_0x5cd8ea)[_0x54a3b4(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x54a3b4(0x351)]({'function':'resetHistory','args':null});}else logger[_0x54a3b4(0x23c)](_0x54a3b4(0x28e));}),_0x48ebbe['on']('get-starting-balances',_0x138d5e=>{const _0x5e5f97=_0x48ba25;if(validateAccess(_0x138d5e,_0x5cd8ea)[_0x5e5f97(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x5e5f97(0x351)]({'function':_0x5e5f97(0x234),'args':null});}else logger[_0x5e5f97(0x23c)](_0x5e5f97(0x2c5));}),_0x48ebbe['on'](_0x48ba25(0x34e),(_0x4ae485,_0x23d4ea)=>{const _0x433ae8=_0x48ba25;if(validateAccess(_0x23d4ea,_0x5cd8ea)[_0x433ae8(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x433ae8(0x351)]({'function':_0x433ae8(0x1f2),'args':_0x4ae485});}else logger[_0x433ae8(0x23c)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x48ebbe['on'](_0x48ba25(0x2bc),_0x252399=>{const _0x1edea5=_0x48ba25;if(validateAccess(_0x252399,_0x5cd8ea)[_0x1edea5(0x1e2)]){if(pid[_0x5555d1])pid[_0x5555d1][_0x1edea5(0x351)]({'function':'cancelLoading','args':null});}else logger[_0x1edea5(0x23c)](_0x1edea5(0x283));}),_0x48ebbe['on'](_0x48ba25(0x22d),_0x59c81f=>{const _0x56bb1c=_0x48ba25;if(validateAccess(_0x59c81f,_0x5cd8ea)['allow']){if(pid[_0x5555d1])pid[_0x5555d1][_0x56bb1c(0x351)]({'function':_0x56bb1c(0x35d),'args':null});}else logger[_0x56bb1c(0x23c)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x48ebbe['on']('update-bb',_0x217cc1=>{const _0x414842=_0x48ba25;if(validateAccess(_0x217cc1,_0x5cd8ea)[_0x414842(0x1e2)])updateBB(_0x414842(0x2db));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x48ebbe['on'](_0x48ba25(0x1cc),_0x503230=>{const _0x3026d5=_0x48ba25;if(validateAccess(_0x503230,_0x5cd8ea)[_0x3026d5(0x1e2)])getMessages();else logger[_0x3026d5(0x23c)](_0x3026d5(0x2aa));}),_0x48ebbe['on'](_0x48ba25(0x39e),(_0x4450cd,_0x531a7e)=>{const _0x3bf88a=_0x48ba25;if(validateAccess(_0x531a7e,_0x5cd8ea)[_0x3bf88a(0x1e2)])confirmMessage(_0x4450cd);else logger[_0x3bf88a(0x23c)](_0x3bf88a(0x246));}),_0x48ebbe['on']('logout',_0xe9208f=>{const _0x567b43=_0x48ba25;if(validateAccess(_0xe9208f,_0x5cd8ea)[_0x567b43(0x1e2)]){if(devices[_0x5cd8ea][_0x567b43(0x353)])clearTimeout(devices[_0x5cd8ea]['pidRefreshToken']);if(devices[_0x5cd8ea][_0x567b43(0x3b4)])clearTimeout(devices[_0x5cd8ea][_0x567b43(0x3b4)]);removeSocketListeners(getClient(_0x48ebbe['id'])['uuid']),addBlacklist(_0x5cd8ea),devices[_0x5cd8ea]['telegramIpApproval']=null,devices[_0x5cd8ea][_0x567b43(0x365)]=null,devices[_0x5cd8ea][_0x567b43(0x1ee)][_0x567b43(0x2b2)]=null,logger[_0x567b43(0x28a)]('Logged\x20out\x20user\x20...'+_0x5cd8ea[_0x567b43(0x3a1)](-0x8)),io['to'](getClient(_0x48ebbe['id'])[_0x567b43(0x374)])[_0x567b43(0x36a)](_0x567b43(0x332),{'access':{'allow':![],'reason':_0x567b43(0x2fb),'token':null}});}else logger['full'](_0x567b43(0x378));});}function removeSocketListeners(_0x370e4f){const _0x1040b7=_0x4d3bba;getClientsWithUuid(_0x370e4f)[_0x1040b7(0x2ef)](_0x791df2=>{const _0x1172d3=_0x1040b7;getSocket(_0x791df2['id'])[_0x1172d3(0x2bf)]();});}function cleanSettings(){const _0x5a716e=_0x4d3bba;let _0x53b221=settings;return settings[_0x5a716e(0x3c4)]&&settings[_0x5a716e(0x3c4)]!=''&&(_0x53b221={..._0x53b221,'telegramToken':_0x5a716e(0x1d1)}),settings[_0x5a716e(0x338)]&&settings[_0x5a716e(0x338)]!=''&&(_0x53b221={..._0x53b221,'bbPassword':'************'}),settings[_0x5a716e(0x37c)]&&settings[_0x5a716e(0x37c)]!=''&&(_0x53b221={..._0x53b221,'marketcapApi':'************'}),(settings[_0x5a716e(0x338)]&&settings['bbPassword']==_0x5a716e(0x2f7)||settings[_0x5a716e(0x3c4)]&&settings[_0x5a716e(0x3c4)]==_0x5a716e(0x2f7)||settings['marketcapApi']&&settings[_0x5a716e(0x37c)]==_0x5a716e(0x2f7))&&(_0x53b221={..._0x53b221,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x5a716e(0x3c4)]==_0x5a716e(0x2f7),'marketcap':settings[_0x5a716e(0x37c)]=='***'}}),_0x53b221;}async function updateBB(_0xd7bbfa){const _0x2bbd0b=_0x4d3bba;await backupConfigFiles(),installingUpdate=!![],config[_0x2bbd0b(0x2ef)](_0x3ab88e=>{restartBot(_0x3ab88e['botID']);});if(_0xd7bbfa=='update')process[_0x2bbd0b(0x351)]({'update':!![],'environment':environment},_0x1c8716=>{});else _0xd7bbfa=='reinstall'&&process[_0x2bbd0b(0x351)]({'reinstall':!![],'environment':environment},_0xd6d6a6=>{});}function startBot(_0x35b88d,_0x331ded,_0x328d93){const _0x2c5073=_0x4d3bba;if(debugging)_0x35b88d['push']('-d');let _0x41e8f4=![];const _0x3c50c4=_0x35b88d[0x0];_0x331ded={..._0x331ded,'stdio':[_0x2c5073(0x1ce),_0x2c5073(0x1ce),_0x2c5073(0x1ce),_0x2c5073(0x236)]},pid[_0x3c50c4]=childProcess[_0x2c5073(0x32e)](botfile,_0x35b88d,_0x331ded),pid[_0x3c50c4]['on'](_0x2c5073(0x294),_0x5a45ab=>{const _0x13ea59=_0x2c5073;switch(Object[_0x13ea59(0x380)](_0x5a45ab)[0x0]){case _0x13ea59(0x388):updateBotName(_0x3c50c4,_0x5a45ab['botname']);break;case _0x13ea59(0x1f8):updateBotManager();break;case _0x13ea59(0x332):updateStatus(_0x3c50c4,_0x5a45ab[_0x13ea59(0x332)]);break;case _0x13ea59(0x273):updateLive(_0x3c50c4,_0x5a45ab[_0x13ea59(0x273)]);break;case'started':updateLive(_0x3c50c4,_0x5a45ab[_0x13ea59(0x33f)]),io['to'](_0x3c50c4)[_0x13ea59(0x36a)](_0x13ea59(0x332),{'access':{'allow':![],'reason':_0x13ea59(0x28b),'token':null}});break;case _0x13ea59(0x25c):_0x5a45ab[_0x13ea59(0x25c)]==_0x13ea59(0x218)&&restartBot(_0x3c50c4);_0x5a45ab['stop']==_0x13ea59(0x2d2)&&toggleBot(_0x3c50c4,_0x13ea59(0x217),_0x13ea59(0x2f1));break;case'telegram':sendTelegramBot(_0x3c50c4,_0x5a45ab[_0x13ea59(0x2b1)]);break;case _0x13ea59(0x293):sendTelegramMsg(_0x5a45ab[_0x13ea59(0x293)]);break;case _0x13ea59(0x1e0):io['to'](_0x3c50c4)[_0x13ea59(0x36a)](_0x5a45ab[_0x13ea59(0x1e0)],_0x5a45ab['args']);break;}}),pid[_0x3c50c4]['on']('error',function(_0x22ea2d){if(_0x41e8f4)return;_0x41e8f4=!![],_0x328d93(_0x22ea2d);}),pid[_0x3c50c4]['on']('exit',async function(_0x45687f){const _0x1a9b02=_0x2c5073;if(terminating)return;if(installingUpdate){logger[_0x1a9b02(0x28a)](_0x1a9b02(0x2e9)),io['close']();return;}if(_0x41e8f4)return;_0x41e8f4=!![],_0x328d93(null);const _0x85e6fd=dbConfig['get'](_0x1a9b02(0x356))[_0x1a9b02(0x289)]({'botID':_0x3c50c4})[_0x1a9b02(0x23d)]();_0x85e6fd&&(_0x85e6fd[_0x1a9b02(0x332)]==_0x1a9b02(0x336)||_0x85e6fd[_0x1a9b02(0x332)]=='new')&&(await sleep(0x3e8),updateLive(_0x3c50c4,_0x1a9b02(0x2f1)),_0x45687f==0x4d?logger[_0x1a9b02(0x28a)](_0x1a9b02(0x2ab)+_0x3c50c4):logger['full'](_0x1a9b02(0x20d)+_0x3c50c4),startBot([_0x3c50c4,userID],{'cwd':bbpath},function(_0x4af188){const _0x278491=_0x1a9b02;if(_0x4af188)logger[_0x278491(0x23c)](_0x4af188);}));});}function stopBot(_0x5e1f48){const _0x5dd529=_0x4d3bba;getClientsWithBotID(_0x5e1f48)[_0x5dd529(0x2ef)](_0x54df65=>{const _0x43ab09=_0x5dd529;getSocket(_0x54df65['id'])[_0x43ab09(0x2a9)](!![]),removeClient(_0x54df65['id']);}),pid[_0x5e1f48]&&(pid[_0x5e1f48][_0x5dd529(0x2d2)](),pid[_0x5e1f48]=null);}function stopAllBots(){const _0x564013=_0x4d3bba;terminating=!![];const _0x46c609=getEnabledBots();_0x46c609[_0x564013(0x2ef)](_0x490b4f=>{const _0x28215c=_0x564013;stopBot(_0x490b4f[_0x28215c(0x3b8)]);});}function restartBot(_0x7cd309){const _0x43b660=_0x4d3bba;if(pid[_0x7cd309])pid[_0x7cd309][_0x43b660(0x2d2)]();}function restartAllBots(){const _0x4e87e5=getEnabledBots();_0x4e87e5['forEach'](()=>{const _0x4c4be2=_0x43c8;broadcastToBots(_0x4c4be2(0x1e0),_0x4c4be2(0x28c));});}function addBot(){const _0x35f26f=_0x4d3bba;let _0x1d9120;for(let _0x542213=0x1;_0x542213<0x3e9;_0x542213++){_0x1d9120=_0x542213[_0x35f26f(0x256)]()[_0x35f26f(0x2ea)](0x3,'0');let _0x2aa24e=config[_0x35f26f(0x289)](_0x338d4b=>_0x338d4b['botID']==_0x1d9120);if(!_0x2aa24e)break;}if(_0x1d9120===_0x35f26f(0x2ee)){logger[_0x35f26f(0x23c)](_0x35f26f(0x2d6));return;}logger[_0x35f26f(0x23c)](_0x35f26f(0x202)+_0x1d9120),dbConfig[_0x35f26f(0x329)](_0x35f26f(0x356))['push']({'botID':_0x1d9120,'botname':_0x35f26f(0x331)+_0x1d9120,'status':_0x35f26f(0x387),'live':''})[_0x35f26f(0x2d0)](),startBot([_0x1d9120,userID],{'cwd':bbpath},function(_0x33554a){const _0x26cd0b=_0x35f26f;if(_0x33554a)logger[_0x26cd0b(0x23c)](_0x33554a);}),config=getConfiguration(),io['to'](_0x35f26f(0x1da))[_0x35f26f(0x36a)](_0x35f26f(0x356),config),broadcastToBots(_0x35f26f(0x356),JSON[_0x35f26f(0x29d)](config));}function deleteBot(_0x5a8edd){const _0x16d451=_0x4d3bba;getClientsWithBotID(_0x5a8edd)[_0x16d451(0x2ef)](_0x5b5b0b=>{const _0xd37393=_0x16d451;getSocket(_0x5b5b0b['id'])[_0xd37393(0x2a9)](!![]),removeClient(_0x5b5b0b['id']);}),dbConfig['get']('bots')['remove']({'botID':_0x5a8edd})[_0x16d451(0x2d0)](),logger['full'](_0x16d451(0x259)+_0x5a8edd),stopBot(_0x5a8edd);try{if(fs[_0x16d451(0x3ba)](path['join'](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x359))))fs['unlinkSync'](path[_0x16d451(0x2a4)](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x359)));if(fs[_0x16d451(0x3ba)](path[_0x16d451(0x2a4)](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x1fd))))fs[_0x16d451(0x1fb)](path[_0x16d451(0x2a4)](configpath,_0x16d451(0x2d8)+_0x5a8edd+'-events.json'));if(fs[_0x16d451(0x3ba)](path[_0x16d451(0x2a4)](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x1c9))))fs[_0x16d451(0x1fb)](path[_0x16d451(0x2a4)](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x1c9)));if(fs[_0x16d451(0x3ba)](path[_0x16d451(0x2a4)](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x34d))))fs[_0x16d451(0x1fb)](path['join'](configpath,_0x16d451(0x2d8)+_0x5a8edd+_0x16d451(0x34d)));}catch(_0x31a45e){if(_0x31a45e)logger[_0x16d451(0x23c)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x31a45e);}config=getConfiguration(),io['to']('botmanager')[_0x16d451(0x36a)](_0x16d451(0x356),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x4a7ab2,_0x308893,_0xb8108e){const _0x622459=_0x4d3bba;dbConfig[_0x622459(0x329)](_0x622459(0x356))[_0x622459(0x289)]({'botID':_0x4a7ab2})[_0x622459(0x343)]({'status':_0x308893})[_0x622459(0x343)]({'live':_0xb8108e})['write']();if(_0x308893=='enabled'||_0x308893==_0x622459(0x387))logger[_0x622459(0x23c)](_0x622459(0x3a9)+_0x4a7ab2),startBot([_0x4a7ab2,userID],{'cwd':bbpath},function(_0x237de8){const _0x254d2a=_0x622459;if(_0x237de8)logger[_0x254d2a(0x23c)](_0x237de8);});else(_0x308893==_0x622459(0x217)||_0x308893==_0x622459(0x363))&&(logger[_0x622459(0x23c)](_0x622459(0x244)+_0x4a7ab2),stopBot(_0x4a7ab2));config=getConfiguration(),io['to']('botmanager')[_0x622459(0x36a)](_0x622459(0x356),config),broadcastToBots('bots',JSON[_0x622459(0x29d)](config));}function toggleStatus(_0x270b97){const _0x500b22=_0x4d3bba;let _0x3f2dbe=dbConfig[_0x500b22(0x329)](_0x500b22(0x356))[_0x500b22(0x289)]({'botID':_0x270b97})[_0x500b22(0x23d)](),_0x38fbd0;if(_0x3f2dbe['status']==='enabled')_0x38fbd0=_0x500b22(0x217);else{if(_0x3f2dbe[_0x500b22(0x332)]==='new')_0x38fbd0=_0x500b22(0x363);else{if(_0x3f2dbe['status']==='new-disabled')_0x38fbd0=_0x500b22(0x387);else{if(_0x3f2dbe[_0x500b22(0x332)]===_0x500b22(0x217))_0x38fbd0=_0x500b22(0x336);}}}return _0x38fbd0;}function updateStatus(_0xf76107,_0x3d058d){const _0x461432=_0x4d3bba;dbConfig[_0x461432(0x329)](_0x461432(0x356))[_0x461432(0x289)]({'botID':_0xf76107})[_0x461432(0x343)]({'status':_0x3d058d})[_0x461432(0x2d0)](),config=getConfiguration(),io['to']('botmanager')[_0x461432(0x36a)](_0x461432(0x356),config),broadcastToBots(_0x461432(0x356),JSON['stringify'](config));}function updateLive(_0x6b9724,_0x14dd72){const _0x290f95=_0x4d3bba;dbConfig['get']('bots')[_0x290f95(0x289)]({'botID':_0x6b9724})[_0x290f95(0x343)]({'live':_0x14dd72})[_0x290f95(0x2d0)](),config=getConfiguration(),io['to']('botmanager')[_0x290f95(0x36a)](_0x290f95(0x356),config),broadcastToBots(_0x290f95(0x356),JSON[_0x290f95(0x29d)](config));}function updateBotName(_0x4ba2b6,_0x4cb5bf){const _0x40ded7=_0x4d3bba;dbConfig[_0x40ded7(0x329)](_0x40ded7(0x356))[_0x40ded7(0x289)]({'botID':_0x4ba2b6})[_0x40ded7(0x343)]({'botname':_0x4cb5bf})[_0x40ded7(0x2d0)](),config=getConfiguration(),io['to'](_0x40ded7(0x1da))[_0x40ded7(0x36a)](_0x40ded7(0x356),config),broadcastToBots(_0x40ded7(0x356),JSON[_0x40ded7(0x29d)](config));}function updateBotManager(){const _0x5aec5c=_0x4d3bba;config=getConfiguration(),io['to']('botmanager')[_0x5aec5c(0x36a)](_0x5aec5c(0x356),config),broadcastToBots(_0x5aec5c(0x356),JSON[_0x5aec5c(0x29d)](config));}function toggleBotMode(_0x2e56ee){const _0x4603a0=_0x4d3bba;if(pid[_0x2e56ee])pid[_0x2e56ee][_0x4603a0(0x351)]({'function':'toggleBotMode','args':null});else{const _0x29dbe3=configpath+'bot-'+_0x2e56ee+_0x4603a0(0x359),_0x3a6da4=fs[_0x4603a0(0x296)](_0x29dbe3),_0x4fd739=JSON['parse'](_0x3a6da4),_0x4def9c=_0x4fd739[_0x4603a0(0x288)][0x0][_0x4603a0(0x22b)];_0x4fd739[_0x4603a0(0x288)][0x0][_0x4603a0(0x22b)]=!_0x4def9c;const _0x2871cb=JSON['stringify'](_0x4fd739,null,0x2);fs[_0x4603a0(0x26c)](_0x29dbe3,_0x2871cb),config=getConfiguration(),io['to']('botmanager')[_0x4603a0(0x36a)](_0x4603a0(0x356),config),broadcastToBots('bots',JSON[_0x4603a0(0x29d)](config));}}function validateTelegram(_0x2f90da){const _0x550d37=_0x4d3bba;if(_0x2f90da['from'][_0x550d37(0x342)]!=settings['telegramUsername']&&'@'+_0x2f90da['from'][_0x550d37(0x342)]!=settings['telegramUsername']||_0x2f90da['chat']['id']!=settings[_0x550d37(0x1eb)])return sendTelegram(_0x2f90da[_0x550d37(0x391)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x550d37(0x327)}),![];return!![];}async function initTelegram(){const _0x4bb37b=_0x4d3bba;if(tgBot)tgBot[_0x4bb37b(0x25c)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x4bb37b(0x3c4)]);let _0x25a00e=_0x4bb37b(0x315);_0x25a00e+='\x0a',_0x25a00e+=_0x4bb37b(0x2f5),_0x25a00e+=_0x4bb37b(0x27a),_0x25a00e+=_0x4bb37b(0x205),_0x25a00e+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x25a00e+='/on\x20-\x20start\x20bot(s)\x0a',_0x25a00e+=_0x4bb37b(0x20c),_0x25a00e+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x25a00e+=_0x4bb37b(0x38c),_0x25a00e+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x25a00e+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x25a00e+=_0x4bb37b(0x285),_0x25a00e+=_0x4bb37b(0x1de),_0x25a00e+=_0x4bb37b(0x31b),_0x25a00e+=_0x4bb37b(0x1d0);let _0x5e5c6c='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x5e5c6c+='\x0a',_0x5e5c6c+=_0x25a00e,tgBot[_0x4bb37b(0x297)]((_0x350bd3,_0x340f5c)=>{const _0x348229=_0x4bb37b;logger[_0x348229(0x2cf)](getTimeStamp()+_0x348229(0x334)),logger['debug'](_0x348229(0x3a6),_0x350bd3);}),tgBot[_0x4bb37b(0x235)](async(_0x47b816,_0x59c216)=>{const _0x2046e7=_0x4bb37b;if(!(!settings[_0x2046e7(0x1eb)]&&_0x47b816['update'][_0x2046e7(0x294)][_0x2046e7(0x354)]==_0x2046e7(0x30a))){if(!validateTelegram(_0x47b816))return;}_0x59c216();}),tgBot[_0x4bb37b(0x316)]('start',async _0x133404=>{const _0x5e8d69=_0x4bb37b;if(!settings[_0x5e8d69(0x1eb)])updateSetting(_0x5e8d69(0x1eb),_0x133404['chat']['id']);updateSetting(_0x5e8d69(0x1c3),!![]);if(!validateTelegram(_0x133404))return;await sendTelegram(_0x133404[_0x5e8d69(0x391)]['id'],_0x5e5c6c);}),tgBot[_0x4bb37b(0x316)]('enable',async _0x7456b0=>{const _0x413d81=_0x4bb37b;updateSetting(_0x413d81(0x1c3),!![]),await sendTelegram(_0x7456b0[_0x413d81(0x391)]['id'],_0x413d81(0x3ad));}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x3bc),async _0x4b6f8a=>{const _0x3c0b5f=_0x4bb37b;await sendTelegram(_0x4b6f8a['chat']['id'],_0x3c0b5f(0x314)),updateSetting('telegramEnabled',![]);}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x3b1),async _0x3900f1=>{const _0x3987b6=_0x4bb37b,_0x3b838b=Markup[_0x3987b6(0x2e0)]([Markup[_0x3987b6(0x320)][_0x3987b6(0x38a)]('Orders',_0x3987b6(0x39c)),Markup['button'][_0x3987b6(0x38a)]('Alerts','config_alerts'),Markup['button'][_0x3987b6(0x38a)]('All','config_all')]);_0x3900f1[_0x3987b6(0x22a)](_0x3987b6(0x200),_0x3b838b);}),tgBot[_0x4bb37b(0x291)]('config_orders',async _0x6a3a=>{const _0x3faab3=_0x4bb37b;_0x6a3a['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x3faab3(0x335)),updateSetting(_0x3faab3(0x1c3),!![]),await sendTelegram(_0x6a3a[_0x3faab3(0x391)]['id'],_0x3faab3(0x36f));}),tgBot[_0x4bb37b(0x291)](_0x4bb37b(0x229),async _0x492d54=>{const _0x274a35=_0x4bb37b;_0x492d54['editMessageReplyMarkup'](),updateSetting(_0x274a35(0x398),_0x274a35(0x39d)),updateSetting(_0x274a35(0x1c3),!![]),await sendTelegram(_0x492d54['chat']['id'],_0x274a35(0x26f));}),tgBot['action'](_0x4bb37b(0x280),async _0x1c1e07=>{const _0x349f43=_0x4bb37b;_0x1c1e07['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x349f43(0x357)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1c1e07[_0x349f43(0x391)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x4bb37b(0x316)]('status',async _0x400bd5=>{const _0x4a4f06=_0x4bb37b,_0x276569=getBotsWithMode();let _0x339d95=_0x4a4f06(0x1c6);config['forEach'](_0x4197b8=>{const _0x38ff21=_0x4a4f06,_0x114b0f=_0x276569[_0x38ff21(0x289)](_0x17b819=>_0x17b819[_0x38ff21(0x3b8)]==_0x4197b8[_0x38ff21(0x3b8)])[_0x38ff21(0x384)];_0x339d95+='Bot\x20'+_0x4197b8[_0x38ff21(0x3b8)]+':\x20'+_0x4197b8['status']+_0x38ff21(0x32d)+_0x114b0f+_0x38ff21(0x32d)+_0x4197b8[_0x38ff21(0x273)]+'\x0a';}),_0x339d95+='\x0a',_0x339d95+=_0x4a4f06(0x215),_0x339d95+=!settings[_0x4a4f06(0x1c3)]?'Notifications\x20disabled\x0a':_0x4a4f06(0x21d),_0x339d95+=settings['telegramEnabled']?settings[_0x4a4f06(0x398)]==_0x4a4f06(0x357)?_0x4a4f06(0x382):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x4a4f06(0x2a0):'',await sendTelegram(_0x400bd5['chat']['id'],_0x339d95,{'parse_mode':_0x4a4f06(0x327)});}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x218),async _0x4bfa58=>{const _0x1b9200=_0x4bb37b,_0xc33fe2=getEnabledBots();if(_0xc33fe2['length']==0x0)await sendTelegram(_0x4bfa58[_0x1b9200(0x391)]['id'],_0x1b9200(0x2ac));else{if(_0xc33fe2[_0x1b9200(0x36d)]>0x1)_0xc33fe2[_0x1b9200(0x33d)]({'botID':_0x1b9200(0x357)});let _0x4ace84=[],_0x23817d=[];const _0x39e8f0=_0xc33fe2[_0x1b9200(0x36d)]%0x4==0x0||_0xc33fe2[_0x1b9200(0x36d)]%0x4==0x3||_0xc33fe2[_0x1b9200(0x36d)]%0x3==0x1?0x4:0x3;let _0x433884=0x0;_0xc33fe2['forEach']((_0x25b41b,_0x14485d)=>{const _0x496e93=_0x1b9200;if(_0x14485d%_0x39e8f0==0x0)_0x23817d=[];_0x23817d[_0x496e93(0x33d)](Markup[_0x496e93(0x320)][_0x496e93(0x38a)](_0x25b41b[_0x496e93(0x3b8)]=='all'?_0x496e93(0x372):_0x496e93(0x331)+_0x25b41b[_0x496e93(0x3b8)],'restart_'+_0x25b41b[_0x496e93(0x3b8)])),_0x14485d%_0x39e8f0==0x0&&(_0x4ace84[_0x433884]=_0x23817d,_0x433884++);});const _0x251b68=Markup[_0x1b9200(0x2e0)](_0x4ace84);_0x4bfa58[_0x1b9200(0x22a)](_0x1b9200(0x3ac),_0x251b68);}}),tgBot[_0x4bb37b(0x291)](/restart_(.+)/,async _0x4d0ba9=>{const _0x1490bb=_0x4bb37b,_0x872540=_0x4d0ba9[_0x1490bb(0x213)][0x1];_0x4d0ba9[_0x1490bb(0x251)](),_0x872540==_0x1490bb(0x357)?config[_0x1490bb(0x2ef)](_0x171eaf=>{const _0x1fed06=_0x1490bb;restartBot(_0x171eaf[_0x1fed06(0x3b8)]);}):restartBot(_0x872540);}),tgBot[_0x4bb37b(0x316)]('on',async _0x5a8c44=>{const _0x12f9c0=_0x4bb37b,_0x228017=getDisabledBots();if(_0x228017[_0x12f9c0(0x36d)]==0x0)await sendTelegram(_0x5a8c44[_0x12f9c0(0x391)]['id'],_0x12f9c0(0x2f3));else{if(_0x228017['length']>0x1)_0x228017['push']({'botID':_0x12f9c0(0x357)});let _0x1137ac=[],_0x3628b2=[];const _0x5e80b0=_0x228017[_0x12f9c0(0x36d)]%0x4==0x0||_0x228017[_0x12f9c0(0x36d)]%0x4==0x3||_0x228017[_0x12f9c0(0x36d)]%0x3==0x1?0x4:0x3;let _0x50fbd1=0x0;_0x228017[_0x12f9c0(0x2ef)]((_0xaa1d78,_0x38fa93)=>{const _0x30f9c9=_0x12f9c0;if(_0x38fa93%_0x5e80b0==0x0)_0x3628b2=[];_0x3628b2[_0x30f9c9(0x33d)](Markup[_0x30f9c9(0x320)][_0x30f9c9(0x38a)](_0xaa1d78[_0x30f9c9(0x3b8)]==_0x30f9c9(0x357)?_0x30f9c9(0x372):'Bot\x20'+_0xaa1d78[_0x30f9c9(0x3b8)],'on_'+_0xaa1d78[_0x30f9c9(0x3b8)])),_0x38fa93%_0x5e80b0==0x0&&(_0x1137ac[_0x50fbd1]=_0x3628b2,_0x50fbd1++);});const _0x4be1b2=Markup[_0x12f9c0(0x2e0)](_0x1137ac);_0x5a8c44[_0x12f9c0(0x22a)](_0x12f9c0(0x31d),_0x4be1b2);}}),tgBot[_0x4bb37b(0x291)](/on_(.+)/,async _0x589b7e=>{const _0x358c03=_0x4bb37b,_0x1f3035=_0x589b7e[_0x358c03(0x213)][0x1];_0x589b7e[_0x358c03(0x251)]();if(_0x1f3035==_0x358c03(0x357)){const _0xec94f1=getDisabledBots();await sendTelegram(_0x589b7e[_0x358c03(0x391)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0xec94f1[_0x358c03(0x2ef)](_0x54c38c=>{const _0x5e8423=_0x358c03;if(_0x54c38c['botID']!=_0x5e8423(0x357))toggleBot(_0x54c38c[_0x5e8423(0x3b8)],toggleStatus(_0x54c38c[_0x5e8423(0x3b8)]),_0x5e8423(0x2f1));});}else await sendTelegram(_0x589b7e['chat']['id'],_0x358c03(0x209)+_0x1f3035),toggleBot(_0x1f3035,toggleStatus(_0x1f3035),_0x358c03(0x2f1));}),tgBot['command'](_0x4bb37b(0x345),async _0x1e251a=>{const _0x1176aa=_0x4bb37b,_0xe8b5bb=getEnabledBots();if(_0xe8b5bb['length']==0x0)await sendTelegram(_0x1e251a[_0x1176aa(0x391)]['id'],_0x1176aa(0x2ac));else{if(_0xe8b5bb[_0x1176aa(0x36d)]>0x1)_0xe8b5bb[_0x1176aa(0x33d)]({'botID':_0x1176aa(0x357)});let _0x307532=[],_0x200037=[];const _0x43ce57=_0xe8b5bb[_0x1176aa(0x36d)]%0x4==0x0||_0xe8b5bb[_0x1176aa(0x36d)]%0x4==0x3||_0xe8b5bb[_0x1176aa(0x36d)]%0x3==0x1?0x4:0x3;let _0x237bcc=0x0;_0xe8b5bb[_0x1176aa(0x2ef)]((_0x38ba89,_0x2244a4)=>{const _0x38072d=_0x1176aa;if(_0x2244a4%_0x43ce57==0x0)_0x200037=[];_0x200037['push'](Markup['button']['callback'](_0x38ba89[_0x38072d(0x3b8)]==_0x38072d(0x357)?'All\x20bots':'Bot\x20'+_0x38ba89[_0x38072d(0x3b8)],_0x38072d(0x257)+_0x38ba89[_0x38072d(0x3b8)])),_0x2244a4%_0x43ce57==0x0&&(_0x307532[_0x237bcc]=_0x200037,_0x237bcc++);});const _0x208ee3=Markup[_0x1176aa(0x2e0)](_0x307532);_0x1e251a[_0x1176aa(0x22a)](_0x1176aa(0x371),_0x208ee3);}}),tgBot['action'](/off_(.+)/,async _0x4cec02=>{const _0x17fe35=_0x4bb37b,_0x5a0c6a=_0x4cec02[_0x17fe35(0x213)][0x1];_0x4cec02[_0x17fe35(0x251)]();if(_0x5a0c6a=='all'){const _0x55ffb5=getEnabledBots();await sendTelegram(_0x4cec02[_0x17fe35(0x391)]['id'],_0x17fe35(0x36c)),_0x55ffb5['forEach'](_0x13440b=>{const _0x294a5e=_0x17fe35;if(_0x13440b[_0x294a5e(0x3b8)]!='all')toggleBot(_0x13440b[_0x294a5e(0x3b8)],toggleStatus(_0x13440b[_0x294a5e(0x3b8)]),_0x294a5e(0x2f1));});}else await sendTelegram(_0x4cec02[_0x17fe35(0x391)]['id'],_0x17fe35(0x33b)+_0x5a0c6a),toggleBot(_0x5a0c6a,toggleStatus(_0x5a0c6a),_0x17fe35(0x2f1));}),tgBot['command'](_0x4bb37b(0x270),async _0x3054f6=>{const _0x41b4f5=_0x4bb37b,_0x56eaf2=getEnabledBots();if(_0x56eaf2[_0x41b4f5(0x36d)]==0x0)await sendTelegram(_0x3054f6[_0x41b4f5(0x391)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x56eaf2['length']>0x1){let _0x1843cb=[],_0x662a0c=[];const _0x38cc08=_0x56eaf2[_0x41b4f5(0x36d)]%0x4==0x0||_0x56eaf2['length']%0x4==0x3||_0x56eaf2[_0x41b4f5(0x36d)]%0x3==0x1?0x4:0x3;let _0x42d5d2=0x0;_0x56eaf2[_0x41b4f5(0x2ef)]((_0x52f35e,_0x49c808)=>{const _0x4037fe=_0x41b4f5;if(_0x49c808%_0x38cc08==0x0)_0x662a0c=[];_0x662a0c[_0x4037fe(0x33d)](Markup[_0x4037fe(0x320)][_0x4037fe(0x38a)](_0x4037fe(0x331)+_0x52f35e[_0x4037fe(0x3b8)],'metrics_'+_0x52f35e['botID'])),_0x49c808%_0x38cc08==0x0&&(_0x1843cb[_0x42d5d2]=_0x662a0c,_0x42d5d2++);});const _0x425cd0=Markup['inlineKeyboard'](_0x1843cb);_0x3054f6[_0x41b4f5(0x22a)](_0x41b4f5(0x24e),_0x425cd0);}else{const _0x13cefd=_0x56eaf2[0x0][_0x41b4f5(0x3b8)];if(pid[_0x13cefd])pid[_0x13cefd][_0x41b4f5(0x351)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x4bb37b(0x291)](/metrics_(.+)/,async _0x23e236=>{const _0x25f4b7=_0x4bb37b,_0x1f5ac3=_0x23e236[_0x25f4b7(0x213)][0x1];_0x23e236[_0x25f4b7(0x251)]();if(pid[_0x1f5ac3])pid[_0x1f5ac3][_0x25f4b7(0x351)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x33a),async _0x49ab5c=>{const _0x22bc58=_0x4bb37b,_0x92a6a6=getEnabledBots();if(_0x92a6a6['length']==0x0)await sendTelegram(_0x49ab5c['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x92a6a6[_0x22bc58(0x36d)]>0x1){let _0x22f295=[],_0x39748e=[];const _0x2d99d0=_0x92a6a6[_0x22bc58(0x36d)]%0x4==0x0||_0x92a6a6[_0x22bc58(0x36d)]%0x4==0x3||_0x92a6a6[_0x22bc58(0x36d)]%0x3==0x1?0x4:0x3;let _0x6ea74e=0x0;_0x92a6a6[_0x22bc58(0x2ef)]((_0x59d8d0,_0x4e24b5)=>{const _0x357002=_0x22bc58;if(_0x4e24b5%_0x2d99d0==0x0)_0x39748e=[];_0x39748e[_0x357002(0x33d)](Markup['button'][_0x357002(0x38a)](_0x357002(0x331)+_0x59d8d0[_0x357002(0x3b8)],_0x357002(0x1c2)+_0x59d8d0[_0x357002(0x3b8)])),_0x4e24b5%_0x2d99d0==0x0&&(_0x22f295[_0x6ea74e]=_0x39748e,_0x6ea74e++);});const _0x2a43d1=Markup[_0x22bc58(0x2e0)](_0x22f295);_0x49ab5c[_0x22bc58(0x22a)](_0x22bc58(0x355),_0x2a43d1);}else{const _0x1c62ce=_0x92a6a6[0x0][_0x22bc58(0x3b8)];if(pid[_0x1c62ce])pid[_0x1c62ce][_0x22bc58(0x351)]({'function':_0x22bc58(0x34a),'args':null});}}}),tgBot[_0x4bb37b(0x291)](/portfolio_(.+)/,async _0xabdb1c=>{const _0x4ac103=_0x4bb37b,_0x1edd21=_0xabdb1c[_0x4ac103(0x213)][0x1];_0xabdb1c[_0x4ac103(0x251)]();if(pid[_0x1edd21])pid[_0x1edd21]['send']({'function':_0x4ac103(0x34a),'args':null});}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x2db),async _0x152e24=>{const _0x3eb4dd=_0x4bb37b;await getMessages();if(!updateAvailable)await sendTelegram(_0x152e24[_0x3eb4dd(0x391)]['id'],_0x3eb4dd(0x2bd));else{if(!validInstallation)await sendTelegram(_0x152e24['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x319a4d=Markup['inlineKeyboard']([Markup[_0x3eb4dd(0x320)][_0x3eb4dd(0x38a)]('Yes',_0x3eb4dd(0x252)),Markup[_0x3eb4dd(0x320)][_0x3eb4dd(0x38a)]('No',_0x3eb4dd(0x34b))]);_0x152e24['reply'](_0x3eb4dd(0x25d),_0x319a4d);}}}),tgBot['action'](/update_(.+)/,async _0x119892=>{const _0x5096a3=_0x4bb37b,_0x2d0a4=_0x119892['match'][0x1];_0x119892[_0x5096a3(0x251)](),_0x2d0a4==_0x5096a3(0x3a3)&&(await sendTelegram(_0x119892[_0x5096a3(0x391)]['id'],_0x5096a3(0x376)),updateBB(_0x5096a3(0x2db))),_0x2d0a4=='no'&&await sendTelegram(_0x119892[_0x5096a3(0x391)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot['command'](_0x4bb37b(0x2b8),async _0x275978=>{const _0x13224b=_0x4bb37b;if(!validInstallation)await sendTelegram(_0x275978[_0x13224b(0x391)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x959ee1=Markup[_0x13224b(0x2e0)]([Markup['button']['callback'](_0x13224b(0x286),_0x13224b(0x239)),Markup['button'][_0x13224b(0x38a)]('No',_0x13224b(0x344))]);_0x275978['reply'](_0x13224b(0x2f0),_0x959ee1);}}),tgBot['action'](/reinstall_(.+)/,async _0x17c1e0=>{const _0x5183d9=_0x4bb37b,_0x53a11c=_0x17c1e0['match'][0x1];_0x17c1e0['editMessageReplyMarkup'](),_0x53a11c==_0x5183d9(0x3a3)&&(await sendTelegram(_0x17c1e0['chat']['id'],_0x5183d9(0x3b3)),updateBB(_0x5183d9(0x2b8))),_0x53a11c=='no'&&await sendTelegram(_0x17c1e0[_0x5183d9(0x391)]['id'],_0x5183d9(0x309));}),tgBot['command'](_0x4bb37b(0x39a),async _0x5766df=>{const _0x6dd55c=_0x4bb37b,_0x43446b=getBotsWithMode();if(_0x43446b['length']==0x0)await sendTelegram(_0x5766df[_0x6dd55c(0x391)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x187356=[],_0x555941=[];const _0x3b1363=0x2;let _0x3871b5=0x0;_0x43446b[_0x6dd55c(0x2ef)]((_0x823c90,_0x480d4c)=>{const _0x284492=_0x6dd55c;if(_0x480d4c%_0x3b1363==0x0)_0x555941=[];_0x555941[_0x284492(0x33d)](Markup['button'][_0x284492(0x38a)](_0x284492(0x331)+_0x823c90[_0x284492(0x3b8)]+'\x20('+_0x823c90[_0x284492(0x384)]+')',_0x284492(0x310)+_0x823c90[_0x284492(0x3b8)])),_0x480d4c%_0x3b1363==0x0&&(_0x187356[_0x3871b5]=_0x555941,_0x3871b5++);});const _0x1267b3=Markup['inlineKeyboard'](_0x187356);_0x5766df[_0x6dd55c(0x22a)](_0x6dd55c(0x341),_0x1267b3);}}),tgBot[_0x4bb37b(0x291)](/toggle_(.+)/,async _0x273c10=>{const _0x45b194=_0x4bb37b,_0x322917=_0x273c10[_0x45b194(0x213)][0x1];_0x273c10[_0x45b194(0x251)]();const _0x20f073=getBotsWithMode(),_0x4c9ea5=_0x20f073[_0x45b194(0x289)](_0x92411c=>_0x92411c[_0x45b194(0x3b8)]==_0x322917),_0x3d7485=_0x4c9ea5[_0x45b194(0x384)]=='auto'?_0x45b194(0x220):_0x45b194(0x396);await sendTelegram(_0x273c10[_0x45b194(0x391)]['id'],_0x45b194(0x1cf)+_0x322917+'\x20to\x20'+_0x3d7485+_0x45b194(0x1ed)),toggleBotMode(_0x322917);}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x311),async _0x325ed5=>{const _0x10bfbc=_0x4bb37b;let _0x26b9f3='';config['forEach'](_0x28460f=>{const _0x3fbdba=_0x43c8;_0x26b9f3+='Bot\x20'+_0x28460f[_0x3fbdba(0x3b8)]+':\x20'+_0x28460f[_0x3fbdba(0x388)]+'\x0a';}),await sendTelegram(_0x325ed5[_0x10bfbc(0x391)]['id'],_0x26b9f3,{'parse_mode':_0x10bfbc(0x327)});}),tgBot[_0x4bb37b(0x316)](_0x4bb37b(0x1ec),async _0xbaea44=>{await sendTelegram(_0xbaea44['chat']['id'],_0x25a00e);}),process['once'](_0x4bb37b(0x22f),()=>tgBot[_0x4bb37b(0x25c)]('SIGINT')),process[_0x4bb37b(0x367)](_0x4bb37b(0x201),()=>tgBot['stop'](_0x4bb37b(0x201))),tgBot[_0x4bb37b(0x339)]();}}function disableTelegram(){const _0x45604c=_0x4d3bba;tgBot&&tgBot[_0x45604c(0x25c)]();}async function sendTelegram(_0x1ec5b9,_0x101f01,_0x12b602){const _0x140d57=_0x4d3bba;_0x12b602={..._0x12b602,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x140d57(0x238)](_0x1ec5b9,_0x101f01,_0x12b602);}catch(_0x4b17bf){console[_0x140d57(0x3b6)](_0x140d57(0x386),_0x4b17bf);}}async function sendTelegramBot(_0x4924e0,_0x2526c5){const _0xaf2e66=_0x4d3bba;if(settings[_0xaf2e66(0x1c3)]){if(settings[_0xaf2e66(0x398)]==_0xaf2e66(0x357)||(_0x2526c5[_0xaf2e66(0x35a)]==_0xaf2e66(0x245)||_0x2526c5[_0xaf2e66(0x35a)]==_0xaf2e66(0x399)||_0x2526c5[_0xaf2e66(0x35a)]==_0xaf2e66(0x35c))&&settings['telegramEvents']==_0xaf2e66(0x39d)||_0x2526c5[_0xaf2e66(0x35a)]==_0xaf2e66(0x2ca)&&settings[_0xaf2e66(0x398)]==_0xaf2e66(0x335)){if(tgBot&&settings[_0xaf2e66(0x1eb)]){if(_0x2526c5[_0xaf2e66(0x38e)])await sendTelegram(settings[_0xaf2e66(0x1eb)],_0x2526c5[_0xaf2e66(0x388)]+_0xaf2e66(0x1bf)+_0x2526c5['event']);else await sendTelegram(settings[_0xaf2e66(0x1eb)],_0xaf2e66(0x331)+_0x4924e0+_0xaf2e66(0x1bf)+_0x2526c5['event']);}}}}async function sendTelegramMsg(_0x20bf81,_0x354cc1=_0x4d3bba(0x327)){const _0x2f9700=_0x4d3bba;return settings[_0x2f9700(0x1c3)]&&tgBot&&settings[_0x2f9700(0x1eb)]?(await sendTelegram(settings[_0x2f9700(0x1eb)],_0x20bf81,{'parse_mode':_0x354cc1}),!![]):![];}function getDeviceWithIp(_0x55732d){const _0x2bdbe7=_0x4d3bba;return devices[_0x2bdbe7(0x289)](_0x2796c5=>_0x2796c5['ip']===_0x55732d);}async function temporaryAccess2FA(_0x50fdc5,_0x375988){const _0x459ecb=_0x4d3bba;let _0x91e10=new Date(),_0x20bdac=![];if(lastIpApproval){if(_0x91e10-lastIpApproval<0x1388)_0x20bdac=!![];}lastIpApproval=new Date();if(_0x20bdac)return;if(tgBot&&settings['telegramChatId']){const _0x4e22c1=uuidRandom();tmpStorage[_0x4e22c1]={'uuid':_0x50fdc5,'externalip':_0x375988};const _0x2bf9b3=Markup[_0x459ecb(0x2e0)]([Markup[_0x459ecb(0x320)][_0x459ecb(0x38a)]('5\x20min','tempaccess_5_'+_0x4e22c1),Markup[_0x459ecb(0x320)][_0x459ecb(0x38a)]('15\x20min','tempaccess_15_'+_0x4e22c1),Markup[_0x459ecb(0x320)][_0x459ecb(0x38a)](_0x459ecb(0x267),_0x459ecb(0x299)+_0x4e22c1),Markup['button'][_0x459ecb(0x38a)]('reject','tempaccess_reject_'+_0x4e22c1)]);await sendTelegram(settings[_0x459ecb(0x1eb)],_0x459ecb(0x233)+normalizeIP(_0x375988)[_0x459ecb(0x2b4)]+'\x20?',_0x2bf9b3),tgBot[_0x459ecb(0x291)](/tempaccess_(.+)_(.+)/,async _0x54db8a=>{const _0x12c676=_0x459ecb,_0x4065ff=_0x54db8a['match'][0x1],_0x13c4a5=_0x54db8a[_0x12c676(0x213)][0x2],{uuid:_0x3b8966,externalip:_0x50e9f6}=tmpStorage[_0x13c4a5];delete tmpStorage[_0x13c4a5],_0x54db8a[_0x12c676(0x251)](),devices[_0x3b8966][_0x12c676(0x1e6)]={'clientip':_0x50e9f6,'timestamp':new Date()['getTime'](),'expiry':_0x4065ff},_0x4065ff!=_0x12c676(0x253)?(await sendTelegram(_0x54db8a[_0x12c676(0x391)]['id'],_0x12c676(0x24d)+_0x4065ff+_0x12c676(0x275),{'parse_mode':_0x12c676(0x327)}),io['to'](_0x3b8966)['emit'](_0x12c676(0x332),{'access':{'allow':![],'reason':_0x12c676(0x28b),'token':null}})):(await sendTelegram(_0x54db8a[_0x12c676(0x391)]['id'],_0x12c676(0x232)),io['to'](_0x3b8966)[_0x12c676(0x36a)]('status',{'access':{'allow':![],'reason':_0x12c676(0x219),'token':null}}));});}}async function loginAccess2FA(_0x368d45,_0xfe41ef){const _0x1a9cef=_0x4d3bba;if(tgBot&&settings[_0x1a9cef(0x1eb)]){const _0x1f8852=uuidRandom();tmpStorage[_0x1f8852]={'uuid':_0x368d45,'externalip':_0xfe41ef};const _0x51582e=Markup[_0x1a9cef(0x2e0)]([Markup[_0x1a9cef(0x320)][_0x1a9cef(0x38a)](_0x1a9cef(0x29b),'login2fa_'+loginExpiry+'_'+_0x1f8852),Markup[_0x1a9cef(0x320)]['callback'](_0x1a9cef(0x253),_0x1a9cef(0x2a8)+_0x1f8852)]);await sendTelegram(settings[_0x1a9cef(0x1eb)],_0x1a9cef(0x225)+normalizeIP(_0xfe41ef)[_0x1a9cef(0x2b4)]+'\x20?',_0x51582e),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x473272=>{const _0x3b9f9d=_0x1a9cef,_0x385f64=_0x473272[_0x3b9f9d(0x213)][0x1],_0x1379d1=_0x473272[_0x3b9f9d(0x213)][0x2],{uuid:_0x4e8e31,externalip:_0x41e81d}=tmpStorage[_0x1379d1];delete tmpStorage[_0x1379d1],_0x473272[_0x3b9f9d(0x251)](),devices[_0x4e8e31][_0x3b9f9d(0x365)]={'clientip':_0x41e81d,'timestamp':new Date()[_0x3b9f9d(0x24b)](),'expiry':_0x385f64},_0x385f64!=_0x3b9f9d(0x253)?(await sendTelegram(_0x473272[_0x3b9f9d(0x391)]['id'],_0x3b9f9d(0x2ff),{'parse_mode':_0x3b9f9d(0x327)}),io['to'](_0x4e8e31)[_0x3b9f9d(0x36a)](_0x3b9f9d(0x332),{'access':{'allow':![],'reason':_0x3b9f9d(0x28b),'token':null}})):(await sendTelegram(_0x473272[_0x3b9f9d(0x391)]['id'],_0x3b9f9d(0x3a0)),io['to'](_0x4e8e31)[_0x3b9f9d(0x36a)](_0x3b9f9d(0x332),{'access':{'allow':![],'reason':_0x3b9f9d(0x1d2),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3a3351=_0x4d3bba;return dbConfig[_0x3a3351(0x329)](_0x3a3351(0x356))[_0x3a3351(0x392)]('botID')[_0x3a3351(0x1e3)]({'status':_0x3a3351(0x336)})['value']()||[];}function getDisabledBots(){const _0x2409a0=_0x4d3bba;return dbConfig['get'](_0x2409a0(0x356))[_0x2409a0(0x392)](_0x2409a0(0x3b8))['filter']({'status':_0x2409a0(0x217)})[_0x2409a0(0x23d)]()||[];}function getBotAttributes(_0x19c794){const _0x28bac4=_0x4d3bba;let _0x2c214e={};const _0x498255=configpath+_0x28bac4(0x2d8)+_0x19c794+'-config.json',_0x37eb76=fs['existsSync'](_0x498255);if(_0x37eb76){const _0x58de1a=fs[_0x28bac4(0x296)](_0x498255);try{const _0x334cdc=JSON['parse'](_0x58de1a),_0x2da5a0=_0x334cdc?_0x334cdc[_0x28bac4(0x288)][0x0][_0x28bac4(0x22b)]:![];_0x2c214e[_0x28bac4(0x384)]=_0x2da5a0?_0x28bac4(0x396):'manual',_0x2c214e[_0x28bac4(0x388)]=_0x334cdc?_0x334cdc['bot'][0x0][_0x28bac4(0x388)]:_0x28bac4(0x331)+_0x19c794;}catch(_0xf6451d){_0x2c214e[_0x28bac4(0x384)]=_0x28bac4(0x220),_0x2c214e[_0x28bac4(0x388)]=_0x28bac4(0x331)+_0x19c794;}}else _0x2c214e[_0x28bac4(0x384)]=_0x28bac4(0x220),_0x2c214e[_0x28bac4(0x388)]=_0x28bac4(0x331)+_0x19c794;return _0x2c214e;}function getBotsWithMode(){const _0x1430c6=_0x4d3bba,_0x2f3f1b=dbConfig['get'](_0x1430c6(0x356))['sortBy'](_0x1430c6(0x3b8))[_0x1430c6(0x23d)]()||[];return _0x2f3f1b[_0x1430c6(0x2ef)](_0x588409=>{const _0x28ab77=_0x1430c6;let _0x62fa33=getBotAttributes(_0x588409[_0x28ab77(0x3b8)]);_0x588409[_0x28ab77(0x384)]=_0x62fa33['mode'];}),_0x2f3f1b;}function getBotExchanges(){const _0x21d70b=_0x4d3bba;let _0x442225=[];const _0x755e50=dbConfig[_0x21d70b(0x329)](_0x21d70b(0x356))['sortBy'](_0x21d70b(0x3b8))[_0x21d70b(0x23d)]()||[];_0x755e50[_0x21d70b(0x2ef)](_0x29e50e=>{const _0x22d9f8=_0x21d70b;if(_0x29e50e['status']==_0x22d9f8(0x336)){const _0x4a54cb=configpath+'bot-'+_0x29e50e['botID']+_0x22d9f8(0x359),_0xd8f565=fs[_0x22d9f8(0x3ba)](_0x4a54cb);let _0x55a9ac;if(_0xd8f565){const _0xd81c93=fs['readFileSync'](_0x4a54cb);try{const _0x4a8033=JSON[_0x22d9f8(0x38f)](_0xd81c93);_0x55a9ac=_0x4a8033?_0x4a8033[_0x22d9f8(0x288)][0x0][_0x22d9f8(0x255)]:null;}catch(_0x2d2f8e){}}if(_0x55a9ac)_0x442225[_0x22d9f8(0x33d)](_0x55a9ac);}});const _0x411274=[...new Set(_0x442225)][_0x21d70b(0x1f4)]();return _0x411274;}async function initUser(){const _0x14cbb2=_0x4d3bba;if(!settings['userid']){const _0x4f1453=uuidRandom();mixpanel[_0x14cbb2(0x261)](_0x4f1453),updateSetting(_0x14cbb2(0x2c4),_0x4f1453);}}async function initSecure(){const _0xe8b5f4=_0x4d3bba;let _0x498bda=getSecure();if(!_0x498bda[_0xe8b5f4(0x2b6)](_0xe8b5f4(0x2e8))){let _0x3a3f2f=await generateKeys();_0x498bda['publicKey']=_0x3a3f2f['publicKey'],_0x498bda['privateKey']=_0x3a3f2f[_0xe8b5f4(0x1c5)],_0x498bda[_0xe8b5f4(0x2e8)]=crypto[_0xe8b5f4(0x2a1)](0x20)['toString'](_0xe8b5f4(0x3b0));;storeSecure(_0x498bda);}}function getSettings(){const _0x18e2a6=_0x4d3bba;return dbSettings['get'](_0x18e2a6(0x375))['value']()||{};}function getSecure(){const _0x302b4e=_0x4d3bba;return dbSecure[_0x302b4e(0x329)](_0x302b4e(0x24c))[_0x302b4e(0x23d)]()||{};}function getBlacklist(){const _0x4bea35=_0x4d3bba;return dbSecure[_0x4bea35(0x329)](_0x4bea35(0x2e3))[_0x4bea35(0x23d)]()||[];}function broadcastToBots(_0x54304c,_0x520039){config['forEach'](_0x48718d=>{const _0x26f59b=_0x43c8;if(_0x48718d[_0x26f59b(0x332)]==_0x26f59b(0x336)&&_0x48718d[_0x26f59b(0x273)]==_0x26f59b(0x1dc)||_0x48718d[_0x26f59b(0x332)]==_0x26f59b(0x387)&&_0x48718d['live']==_0x26f59b(0x1dc)){if(pid[_0x48718d[_0x26f59b(0x3b8)]])pid[_0x48718d[_0x26f59b(0x3b8)]][_0x26f59b(0x351)]({[_0x54304c]:_0x520039});}});}async function storeSettings(_0x39c02e,_0x335820=![]){const _0x9ac6f1=_0x4d3bba;_0x39c02e={...settings,..._0x39c02e};if(_0x335820&&_0x39c02e[_0x9ac6f1(0x338)]!=_0x9ac6f1(0x1d1)&&_0x39c02e['bbPassword']!='***'&&_0x39c02e[_0x9ac6f1(0x338)]!=''){const _0x2d36f7=crypt[_0x9ac6f1(0x379)](secure[_0x9ac6f1(0x1c5)],_0x39c02e[_0x9ac6f1(0x338)])[_0x9ac6f1(0x294)][_0x9ac6f1(0x306)](_0x9ac6f1(0x249))[0x0],_0x567523=bcrypt[_0x9ac6f1(0x282)](_0x2d36f7,saltRounds);_0x39c02e={..._0x39c02e,'bbPassword':_0x567523};}if(_0x335820&&_0x39c02e[_0x9ac6f1(0x3c4)]!=_0x9ac6f1(0x1d1)&&_0x39c02e['telegramToken']!=_0x9ac6f1(0x2f7)&&_0x39c02e[_0x9ac6f1(0x3c4)]!=''){const _0x64948e=crypt['decrypt'](secure[_0x9ac6f1(0x1c5)],_0x39c02e[_0x9ac6f1(0x3c4)])['message'][_0x9ac6f1(0x306)](_0x9ac6f1(0x249))[0x0];_0x39c02e={..._0x39c02e,'telegramToken':_0x64948e};}if(_0x335820&&_0x39c02e['marketcapApi']!='************'&&_0x39c02e['marketcapApi']!=_0x9ac6f1(0x2f7)&&_0x39c02e['marketcapApi']!=''){const _0x1e2396=crypt[_0x9ac6f1(0x379)](secure[_0x9ac6f1(0x1c5)],_0x39c02e['marketcapApi'])[_0x9ac6f1(0x294)][_0x9ac6f1(0x306)](_0x9ac6f1(0x249))[0x0];_0x39c02e={..._0x39c02e,'marketcapApi':_0x1e2396};}const _0x1fe436=_0x39c02e['telegramToken']!=_0x9ac6f1(0x1d1)&&_0x39c02e[_0x9ac6f1(0x3c4)]!=settings[_0x9ac6f1(0x3c4)]||_0x39c02e[_0x9ac6f1(0x377)]!=settings[_0x9ac6f1(0x377)],_0x315524=_0x39c02e['telegramToken']==''||_0x39c02e[_0x9ac6f1(0x377)]=='',_0x36e1cb=_0x39c02e[_0x9ac6f1(0x37c)]&&_0x39c02e[_0x9ac6f1(0x37c)]!='************'&&_0x39c02e[_0x9ac6f1(0x37c)]!=settings[_0x9ac6f1(0x3c4)];_0x1fe436&&(_0x39c02e[_0x9ac6f1(0x1eb)]=null,_0x39c02e[_0x9ac6f1(0x398)]=_0x9ac6f1(0x357));for(const [_0x424b08,_0x4a7e95]of Object[_0x9ac6f1(0x35f)](_0x39c02e)){if(_0x424b08=='telegramToken'&&_0x4a7e95==_0x9ac6f1(0x1d1)){_0x39c02e[_0x9ac6f1(0x3c4)]=settings[_0x9ac6f1(0x3c4)];continue;};if(_0x424b08==_0x9ac6f1(0x338)&&_0x4a7e95==_0x9ac6f1(0x1d1)){_0x39c02e[_0x9ac6f1(0x338)]=settings[_0x9ac6f1(0x338)];continue;};if(_0x424b08==_0x9ac6f1(0x37c)&&_0x4a7e95=='************'){_0x39c02e['marketcapApi']=settings[_0x9ac6f1(0x37c)];continue;};dbSettings[_0x9ac6f1(0x237)]('settings.'+_0x424b08,_0x4a7e95)['write']();}settings=_0x39c02e,io['to']('botmanager')[_0x9ac6f1(0x36a)](_0x9ac6f1(0x375),cleanSettings()),broadcastToBots(_0x9ac6f1(0x20e),settings['timeshift']),broadcastToBots(_0x9ac6f1(0x3bb),settings[_0x9ac6f1(0x3bb)]),broadcastToBots('marketcapApi',settings[_0x9ac6f1(0x37c)]);if(_0x1fe436&&!_0x315524)initTelegram();if(_0x1fe436&&_0x315524)disableTelegram();getAllClients()[_0x9ac6f1(0x2ef)](_0xd698f6=>{const _0x3db090=_0x9ac6f1;getSocket(_0xd698f6['id'])[_0x3db090(0x36a)](_0x3db090(0x332),{'access':{'allow':![],'reason':_0x3db090(0x28b),'token':null}});}),_0x36e1cb&&(await sleep(0xbb8),testMarketcapApi(_0x39c02e[_0x9ac6f1(0x37c)]));}async function testMarketcapApi(_0x44e34d){const _0x296008=_0x4d3bba,_0x4316f3=[_0x296008(0x349),_0x296008(0x318)];try{await axios[_0x296008(0x329)](_0x296008(0x20b),{'headers':{'X-CMC_PRO_API_KEY':_0x44e34d},'params':{'symbol':_0x4316f3[_0x296008(0x256)]()}});}catch(_0x23f7ec){_0x23f7ec[_0x296008(0x256)]()[_0x296008(0x350)](_0x296008(0x20f))?(io['to'](_0x296008(0x1da))['emit']('notification','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger['full'](_0x296008(0x2df))):(io['to'](_0x296008(0x1da))[_0x296008(0x36a)](_0x296008(0x1d7),_0x296008(0x240)),logger[_0x296008(0x23c)](_0x296008(0x240)),logger[_0x296008(0x28a)]('Error\x20details:',_0x23f7ec[_0x296008(0x256)]()+_0x296008(0x368)+_0x23f7ec[_0x296008(0x3a8)]));return;}logger[_0x296008(0x28a)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x19251c,_0x518eac){const _0x3fcf28=_0x4d3bba;dbSettings[_0x3fcf28(0x237)](_0x3fcf28(0x2c2)+_0x19251c,_0x518eac)[_0x3fcf28(0x2d0)](),settings=getSettings(),io['to'](_0x3fcf28(0x1da))[_0x3fcf28(0x36a)]('settings',cleanSettings());}function storeSecure(_0x206e20){const _0x596ff9=_0x4d3bba;dbSecure['get'](_0x596ff9(0x24c))[_0x596ff9(0x33d)](_0x206e20)[_0x596ff9(0x2d0)](),secure=_0x206e20;}function addBlacklist(_0x42d397){const _0x705665=_0x4d3bba;cleanBlacklist();let _0x352697;devices[_0x42d397]['telegramIpApproval']?_0x352697=Math[_0x705665(0x1fe)](devices[_0x42d397][_0x705665(0x1e6)][_0x705665(0x1c7)],loginExpiry):_0x352697=loginExpiry,dbSecure[_0x705665(0x329)](_0x705665(0x2e3))['push']({'expiry':new Date()[_0x705665(0x24b)]()+_0x352697*0x3c*0x3e8,'token':devices[_0x42d397]['access'][_0x705665(0x2b2)]})[_0x705665(0x2d0)](),blacklist=dbSecure['get'](_0x705665(0x2e3))[_0x705665(0x23d)]();}function cleanBlacklist(){const _0x4237a6=_0x4d3bba;let _0x4cabfb=dbSecure['get'](_0x4237a6(0x2e3))['cloneDeep']()['value'](),_0x5c030c=new Date()[_0x4237a6(0x24b)]();_0x4cabfb['forEach'](_0x57f2c8=>{const _0x47b939=_0x4237a6;_0x57f2c8[_0x47b939(0x1c7)]<_0x5c030c&&dbSecure[_0x47b939(0x329)]('blacklist')['remove']({'expiry':_0x57f2c8[_0x47b939(0x1c7)]})[_0x47b939(0x2d0)]();});}function initStates(){const _0x35b443=_0x4d3bba;let _0x6d1d68=getConfiguration();_0x6d1d68[_0x35b443(0x2ef)](_0x38ae14=>{const _0x2b9c18=_0x35b443;_0x38ae14[_0x2b9c18(0x273)]=_0x2b9c18(0x2f1);}),storeConfiguration(_0x6d1d68);}function onKeys(){const _0x2aea94=new RSA();return new Promise(_0x555270=>{const _0x463a01=_0x43c8;_0x2aea94[_0x463a01(0x373)]()[_0x463a01(0x360)](_0x561a2d=>{_0x555270(_0x561a2d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0xc924b0=_0x4d3bba;let _0x4482a1=getSettings(),_0x23071e=![];!_0x4482a1[_0xc924b0(0x2b6)](_0xc924b0(0x35b))&&(_0x4482a1[_0xc924b0(0x35b)]=0x0,_0x23071e=!![]);!_0x4482a1[_0xc924b0(0x2b6)]('lastmsgemitted')&&(_0x4482a1[_0xc924b0(0x31e)]=0x0,_0x23071e=!![]);!_0x4482a1[_0xc924b0(0x2b6)](_0xc924b0(0x24f))&&(_0x4482a1[_0xc924b0(0x24f)]=_0xc924b0(0x216),_0x23071e=!![]);!_0x4482a1[_0xc924b0(0x2b6)](_0xc924b0(0x3bb))&&(_0x4482a1[_0xc924b0(0x3bb)]=![],_0x23071e=!![]);!_0x4482a1[_0xc924b0(0x2b6)](_0xc924b0(0x37c))&&(_0x4482a1[_0xc924b0(0x37c)]='',_0x23071e=!![]);if(_0x23071e)storeSettings(_0x4482a1);try{fs[_0xc924b0(0x2a3)](configbackuppath,{'withFileTypes':!![]})[_0xc924b0(0x2ef)](_0x9de936=>{const _0xc9138=_0xc924b0;if(!_0x9de936[_0xc9138(0x2ed)]()){if(!_0x9de936[_0xc9138(0x242)][_0xc9138(0x2c1)](_0xc9138(0x2d1)))fs[_0xc9138(0x1fb)](configbackuppath+_0x9de936[_0xc9138(0x242)]);}else fs[_0xc9138(0x2e7)](configbackuppath+_0x9de936[_0xc9138(0x242)],{'recursive':!![]});});}catch(_0x1d8a51){logger[_0xc924b0(0x28a)]('Error\x20removing\x20old\x20backup\x20files:',_0x1d8a51);}}function storeConfiguration(_0x63231b){const _0x3deb54=_0x4d3bba;dbConfig['get'](_0x3deb54(0x356))[_0x3deb54(0x32f)]()[_0x3deb54(0x2d0)](),dbConfig['get']('bots')[_0x3deb54(0x33d)](..._0x63231b)[_0x3deb54(0x2d0)](),config=_0x63231b;}async function resetPassword(){const _0x34726a=_0x4d3bba;if(tgBot&&settings[_0x34726a(0x1eb)]){const _0x33cd3e=Markup[_0x34726a(0x2e0)]([Markup[_0x34726a(0x320)][_0x34726a(0x38a)]('yes',_0x34726a(0x2c7)),Markup[_0x34726a(0x320)][_0x34726a(0x38a)]('no',_0x34726a(0x36b))]);await sendTelegram(settings[_0x34726a(0x1eb)],_0x34726a(0x3c0),_0x33cd3e),tgBot[_0x34726a(0x291)](/resetpw_(.+)/,async _0x55f898=>{const _0x25e72b=_0x34726a,_0x723119=_0x55f898['match'][0x1];_0x55f898[_0x25e72b(0x251)]();if(_0x723119!='no'){const _0x3f6bfc=0xf,_0x1cdb58='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x459063=Array['from'](crypto[_0x25e72b(0x37b)](new Uint32Array(_0x3f6bfc)))['map'](_0xdc8eb1=>_0x1cdb58[_0xdc8eb1%_0x1cdb58[_0x25e72b(0x36d)]])['join'](''),_0x1b6747=bcrypt[_0x25e72b(0x282)](_0x459063,saltRounds);storeSettings({'bbPassword':_0x1b6747}),await sendTelegram(_0x55f898[_0x25e72b(0x391)]['id'],_0x25e72b(0x2d3)+_0x459063,{'parse_mode':_0x25e72b(0x327)});}else await sendTelegram(_0x55f898[_0x25e72b(0x391)]['id'],_0x25e72b(0x2a2));});}}async function confirmRestore(_0x4f0498,_0x472aa4){const _0x48ce67=_0x4d3bba;io['to']('botmanager')[_0x48ce67(0x36a)](_0x48ce67(0x1d7),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x48ce67(0x35c));if(tgBot&&settings[_0x48ce67(0x1eb)]){const _0x4caef7=uuidRandom();tmpStorage[_0x4caef7]={'path':_0x4f0498,'filename':_0x472aa4};const _0xa583a7=Markup[_0x48ce67(0x2e0)]([Markup['button'][_0x48ce67(0x38a)](_0x48ce67(0x3a3),_0x48ce67(0x383)+_0x4caef7),Markup['button']['callback']('no',_0x48ce67(0x3a5)+_0x4caef7)]);await sendTelegram(settings[_0x48ce67(0x1eb)],_0x48ce67(0x231),_0xa583a7),tgBot[_0x48ce67(0x291)](/restore_(.+)_(.+)/,async _0x59280d=>{const _0x270ad8=_0x48ce67,_0x2a2b46=_0x59280d[_0x270ad8(0x213)][0x1],_0x2f6319=_0x59280d[_0x270ad8(0x213)][0x2],{path:_0x219023,filename:_0x556915}=tmpStorage[_0x2f6319];delete tmpStorage[_0x2f6319],_0x59280d[_0x270ad8(0x251)](),_0x2a2b46=='yes'?(logger[_0x270ad8(0x28a)](_0x270ad8(0x1f0)),await sendTelegram(_0x59280d[_0x270ad8(0x391)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x270ad8(0x327)}),unzipFile(_0x219023,_0x556915)):(logger['debug'](_0x270ad8(0x35e)),await sendTelegram(_0x59280d[_0x270ad8(0x391)]['id'],_0x270ad8(0x35e)));});}}function getServerTime(){const _0x16a055=_0x4d3bba,_0x38e127=new Date();return _0x38e127[_0x16a055(0x38b)]()+'/'+(_0x38e127[_0x16a055(0x272)]()+0x1)[_0x16a055(0x256)]()[_0x16a055(0x2ea)](0x2,'0')+'/'+_0x38e127[_0x16a055(0x295)]()['toString']()[_0x16a055(0x2ea)](0x2,'0')+'\x20'+_0x38e127[_0x16a055(0x361)]()[_0x16a055(0x256)]()['padStart'](0x2,'0')+':'+_0x38e127['getMinutes']()[_0x16a055(0x256)]()[_0x16a055(0x2ea)](0x2,'0')+':'+_0x38e127[_0x16a055(0x37d)]()['toString']()[_0x16a055(0x2ea)](0x2,'0');}function getTimeStamp(){const _0x45c276=_0x4d3bba,_0xc51f2e=shiftedTime();return _0xc51f2e[_0x45c276(0x38b)]()+'/'+(_0xc51f2e[_0x45c276(0x272)]()+0x1)[_0x45c276(0x256)]()[_0x45c276(0x2ea)](0x2,'0')+'/'+_0xc51f2e[_0x45c276(0x295)]()[_0x45c276(0x256)]()[_0x45c276(0x2ea)](0x2,'0')+'\x20'+_0xc51f2e[_0x45c276(0x361)]()['toString']()[_0x45c276(0x2ea)](0x2,'0')+':'+_0xc51f2e[_0x45c276(0x2ae)]()[_0x45c276(0x256)]()[_0x45c276(0x2ea)](0x2,'0')+':'+_0xc51f2e[_0x45c276(0x37d)]()[_0x45c276(0x256)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x2c8fbe=_0x4d3bba,_0x3bd8bc=shiftedTime();return _0x3bd8bc[_0x2c8fbe(0x38b)]()+(_0x3bd8bc['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+_0x3bd8bc['getDate']()[_0x2c8fbe(0x256)]()[_0x2c8fbe(0x2ea)](0x2,'0')+'-'+_0x3bd8bc[_0x2c8fbe(0x361)]()[_0x2c8fbe(0x256)]()[_0x2c8fbe(0x2ea)](0x2,'0')+_0x3bd8bc[_0x2c8fbe(0x2ae)]()['toString']()[_0x2c8fbe(0x2ea)](0x2,'0')+_0x3bd8bc[_0x2c8fbe(0x37d)]()[_0x2c8fbe(0x256)]()[_0x2c8fbe(0x2ea)](0x2,'0');}function shiftedTime(){const _0x3f2fc7=_0x4d3bba,_0x5286ab=new Date();let _0x122912=_0x5286ab;if(settings[_0x3f2fc7(0x20e)]&&settings[_0x3f2fc7(0x20e)]!==0x0)_0x122912=fns[_0x3f2fc7(0x250)](_0x5286ab,{'hours':settings['timeshift']});return _0x122912;}async function startScheduler(){const _0x213760=new Date()['getUTCHours'](),_0x414262=shiftedTime()['getHours']();_0x414262==0x4&&backupConfigFiles(),_0x414262==0x0&&rotateLogFiles(),_0x213760%0x6==0x0&&triggerAnalytics(),_0x213760%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x314bd5){const _0x590853=_0x4d3bba;logger[_0x590853(0x28a)](_0x590853(0x25b)+_0x314bd5);const _0x5719b3=getBotsWithMode();_0x5719b3[_0x590853(0x36d)]>0x0?confirmRestore(configbackuppath,_0x314bd5):unzipFile(configbackuppath,_0x314bd5);}async function getBackupFiles(_0x83e722=null){const _0x5ba995=_0x4d3bba;let _0x243c77=[],_0x3791e7=fs[_0x5ba995(0x2a3)](configbackuppath,{'withFileTypes':!![]});_0x3791e7[_0x5ba995(0x1f4)]((_0x4d18db,_0x33de88)=>_0x4d18db[_0x5ba995(0x242)]<_0x33de88[_0x5ba995(0x242)]?0x1:_0x33de88[_0x5ba995(0x242)]<_0x4d18db['name']?-0x1:0x0),_0x3791e7[_0x5ba995(0x2ef)](_0x3c2d8b=>{const _0x1b6adf=_0x5ba995;if(!_0x3c2d8b[_0x1b6adf(0x2ed)]()&&_0x3c2d8b[_0x1b6adf(0x242)][_0x1b6adf(0x2c1)](_0x1b6adf(0x2d1))&&_0x3c2d8b[_0x1b6adf(0x242)][_0x1b6adf(0x39f)]('.zip')){const _0x148f89=formatDate(fs['statSync'](configbackuppath+_0x3c2d8b[_0x1b6adf(0x242)])[_0x1b6adf(0x2fe)]);_0x243c77[_0x1b6adf(0x33d)]({'name':_0x3c2d8b['name'],'mtime':_0x148f89});}});if(_0x83e722)io['to'](_0x83e722)[_0x5ba995(0x36a)](_0x5ba995(0x207),_0x243c77);else return _0x243c77;}async function backupConfigFiles(){const _0x4d697f=_0x4d3bba;await zipFiles(_0x4d697f(0x32a));const _0x49a6e8=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x4d697f(0x2d1)+_0x49a6e8+'.zip'));let _0x3a0e75=fs[_0x4d697f(0x2a3)](configbackuppath,{'withFileTypes':!![]});_0x3a0e75[_0x4d697f(0x1f4)]((_0x4c3f69,_0xa956f6)=>_0x4c3f69[_0x4d697f(0x242)]<_0xa956f6[_0x4d697f(0x242)]?0x1:_0xa956f6[_0x4d697f(0x242)]<_0x4c3f69[_0x4d697f(0x242)]?-0x1:0x0),_0x3a0e75[_0x4d697f(0x36d)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x3a0e75[_0x3a0e75[_0x4d697f(0x36d)]-0x1]['name']);}function rotateLogFiles(){const _0x571598=_0x4d3bba,_0x40f91c=fs['statSync'](logspath+_0x571598(0x1f7)),_0x130f28=_0x40f91c[_0x571598(0x31a)]/0x400;if(_0x130f28>0x64){let _0x3a6302=fs[_0x571598(0x2a3)](logspath,{'withFileTypes':!![]});_0x3a6302[_0x571598(0x1f4)]((_0x597b9b,_0x389649)=>_0x597b9b[_0x571598(0x242)]<_0x389649[_0x571598(0x242)]?0x1:_0x389649['name']<_0x597b9b[_0x571598(0x242)]?-0x1:0x0),_0x3a6302['forEach'](_0x4d9ca3=>{const _0x4e448b=_0x571598;if(_0x4d9ca3[_0x4e448b(0x242)]=='output-002.log')fs[_0x4e448b(0x3b9)](logspath+_0x4d9ca3[_0x4e448b(0x242)],logspath+'output-003.log');if(_0x4d9ca3[_0x4e448b(0x242)]==_0x4e448b(0x1ef))fs[_0x4e448b(0x3b9)](logspath+_0x4d9ca3['name'],logspath+_0x4e448b(0x3a7));_0x4d9ca3[_0x4e448b(0x242)]==_0x4e448b(0x1f7)&&(fs['copyFileSync'](logspath+_0x4d9ca3[_0x4e448b(0x242)],logspath+_0x4e448b(0x1ef)),fs[_0x4e448b(0x26c)](logspath+_0x4d9ca3[_0x4e448b(0x242)],''));});}}async function zipFiles(_0x2a61bc){const _0x53cf94=_0x4d3bba;let _0x6d8839;if(_0x2a61bc=='logs')_0x6d8839=logspath;if(_0x2a61bc==_0x53cf94(0x1c0))_0x6d8839=configpath;if(_0x2a61bc==_0x53cf94(0x32a))_0x6d8839=configpath;let _0x827996=fs[_0x53cf94(0x2a3)](_0x6d8839,{'withFileTypes':!![]});const _0x457e2a=new require(_0x53cf94(0x2be))();_0x827996[_0x53cf94(0x2ef)](_0x3c1863=>{const _0x34e1d6=_0x53cf94;if(!_0x3c1863[_0x34e1d6(0x2ed)]()){let _0x497b4c=fs[_0x34e1d6(0x296)](_0x6d8839+_0x3c1863['name']);if(_0x2a61bc==_0x34e1d6(0x1c0)){const _0x4f282c=/^bot-[0-9]{3}-config.json$/,_0x38eecb=_0x4f282c[_0x34e1d6(0x221)](_0x3c1863['name']);if(_0x38eecb){const _0x4cf5b3=JSON[_0x34e1d6(0x38f)](_0x497b4c);if(_0x4cf5b3[_0x34e1d6(0x288)][0x0]){_0x4cf5b3['bot'][0x0]['apiKey']='***',_0x4cf5b3[_0x34e1d6(0x288)][0x0][_0x34e1d6(0x21b)]='***';if(_0x4cf5b3[_0x34e1d6(0x288)][0x0]['apiPassword'])_0x4cf5b3[_0x34e1d6(0x288)][0x0][_0x34e1d6(0x2f4)]=_0x34e1d6(0x2f7);}_0x497b4c=JSON['stringify'](_0x4cf5b3,null,0x2);}if(_0x3c1863['name']==_0x34e1d6(0x394)){const _0x512df6=JSON[_0x34e1d6(0x38f)](_0x497b4c);if(_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x38d)])_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x38d)]=![];if(_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x338)])_0x512df6['settings'][_0x34e1d6(0x338)]='***';if(_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x3c4)])_0x512df6['settings'][_0x34e1d6(0x3c4)]=_0x34e1d6(0x2f7);if(_0x512df6[_0x34e1d6(0x375)]['telegramChatId'])_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x1eb)]=null;if(_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x37c)])_0x512df6[_0x34e1d6(0x375)][_0x34e1d6(0x37c)]='***';_0x497b4c=JSON['stringify'](_0x512df6,null,0x2);}if(_0x3c1863['name']!='bb-secure.json')_0x457e2a['file'](_0x3c1863[_0x34e1d6(0x242)],_0x497b4c);}else _0x457e2a[_0x34e1d6(0x223)](_0x3c1863[_0x34e1d6(0x242)],_0x497b4c);}});const _0x27fc4e=_0x457e2a[_0x53cf94(0x307)]({'base64':![],'compression':'DEFLATE'});fs[_0x53cf94(0x26c)](zippath+(_0x2a61bc+'.zip'),_0x27fc4e,'binary');}function _0x43c8(_0x55d428,_0x451fda){const _0x110bed=_0x356b();return _0x43c8=function(_0x591c71,_0x278931){_0x591c71=_0x591c71-0x1bf;let _0x356bd7=_0x110bed[_0x591c71];return _0x356bd7;},_0x43c8(_0x55d428,_0x451fda);}async function unzipFile(_0x3ff5d8,_0x5431b2){const _0x1a7a07=_0x4d3bba;fs[_0x1a7a07(0x2a3)](configpath,{'withFileTypes':!![]})[_0x1a7a07(0x2ef)](_0x4b5448=>{const _0x4f537c=_0x1a7a07;if(!_0x4b5448['isDirectory']())fs[_0x4f537c(0x2e7)](configpath+_0x4b5448[_0x4f537c(0x242)]);});const _0x1123d4=fs[_0x1a7a07(0x296)](_0x3ff5d8+_0x5431b2,_0x1a7a07(0x1d8)),_0xec67fd=new require(_0x1a7a07(0x2be))(_0x1123d4,{'base64':![],'checkCRC32':!![]});Object[_0x1a7a07(0x380)](_0xec67fd[_0x1a7a07(0x385)])['forEach'](_0x42b162=>{const _0x585c4a=_0x1a7a07,_0x475d35=_0xec67fd['files'][_0x42b162];fs[_0x585c4a(0x26c)](configpath+_0x475d35[_0x585c4a(0x242)],_0x475d35[_0x585c4a(0x27b)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x1a7a07(0x2ef)](_0x4135d7=>{const _0x3b7c9c=_0x1a7a07;if(!_0x4135d7[_0x3b7c9c(0x2ed)]())fs['rmSync'](temppath+_0x4135d7[_0x3b7c9c(0x242)]);}),logger[_0x1a7a07(0x28a)](_0x1a7a07(0x325)),process[_0x1a7a07(0x351)]({'restore':!![]},_0x561133=>{});}async function getPublicIp(){const _0x24ffcd=_0x4d3bba;try{const _0x8316ef=await axios[_0x24ffcd(0x329)](_0x24ffcd(0x3bd));publicip=_0x8316ef[_0x24ffcd(0x3c3)]['ip'];}catch(_0x3c99c1){}}async function triggerAnalytics(){const _0x1ed0b5=_0x4d3bba;if(!publicip)await getPublicIp();const _0xcfc37f=getBotsWithMode();let _0xd13c86=0x0;_0xcfc37f['forEach'](_0x295315=>{const _0x390b0f=_0x43c8;if(_0x295315['status']===_0x390b0f(0x336))_0xd13c86++;});const _0x1f3203=getBotExchanges();mixpanel[_0x1ed0b5(0x3af)](_0x1ed0b5(0x212),{'distinct_id':settings[_0x1ed0b5(0x2c4)],'ip':publicip,'version':serverversion,'numbots':_0xcfc37f[_0x1ed0b5(0x36d)],'numbotsenabled':_0xd13c86,'exchanges':_0x1f3203,'environment':environment});}async function getMessages(){const _0x4a9e55=_0x4d3bba,_0x427e42=_0x4a9e55(0x1cd),_0x4a1beb=new GraphQLClient(_0x427e42),_0x219762={'authorization':_0x4a9e55(0x30b)},_0x4a81c0=serverversion['split']('.'),_0x5262a7=_0x4a81c0[0x0]+'.'+_0x4a81c0[0x1],_0x22ed39=Math['min'](settings[_0x4a9e55(0x35b)],settings[_0x4a9e55(0x31e)]),_0x51f887={'last':parseInt(_0x22ed39),'bbm':_0x5262a7},_0x24cab1=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5250c6;try{_0x5250c6=await _0x4a1beb[_0x4a9e55(0x3aa)](_0x24cab1,_0x51f887,_0x219762);}catch(_0x1999de){}if(_0x5250c6&&_0x5250c6[_0x4a9e55(0x241)]){let _0x42dd0f=settings[_0x4a9e55(0x35b)];newMessages=[];for(const _0x9003aa of _0x5250c6[_0x4a9e55(0x241)]){newMessages[_0x4a9e55(0x33d)](_0x9003aa);let _0x26ba53=![];_0x9003aa[_0x4a9e55(0x2af)]&&(updateSetting(_0x4a9e55(0x24f),_0x9003aa[_0x4a9e55(0x2af)]),_0x26ba53=isNewerVersion(serverversion,_0x9003aa[_0x4a9e55(0x2af)])||serverversion==_0x9003aa[_0x4a9e55(0x2af)]);if(!_0x26ba53&&_0x9003aa[_0x4a9e55(0x389)]>_0x42dd0f){if(_0x9003aa[_0x4a9e55(0x2c0)]===_0x4a9e55(0x32b)||serverversion[_0x4a9e55(0x2c1)](_0x9003aa['bbvReceive'])){let _0x275899=''+_0x9003aa['title']+'\x0a\x0a'+_0x9003aa[_0x4a9e55(0x294)];const _0x55c105=await sendTelegramMsg(toTelegramMarkdown(_0x275899),_0x4a9e55(0x31c));if(_0x55c105)_0x42dd0f=_0x9003aa['number'];}}}updateAvailable=isNewerVersion(settings[_0x4a9e55(0x24f)],serverversion),updateSetting(_0x4a9e55(0x35b),_0x42dd0f),emitMessages();}}function emitMessages(){const _0x5f1484=_0x4d3bba,_0x5341ae=settings[_0x5f1484(0x31e)];let _0x36abb5=[];newMessages[_0x5f1484(0x2ef)](_0x27daee=>{const _0x4c0089=_0x5f1484;_0x27daee[_0x4c0089(0x389)]>_0x5341ae&&_0x36abb5[_0x4c0089(0x33d)](_0x27daee);}),_0x36abb5[_0x5f1484(0x36d)]>0x0&&getAllClients()[_0x5f1484(0x2ef)](_0x527bd7=>{const _0x17d90b=_0x5f1484;getSocket(_0x527bd7['id'])[_0x17d90b(0x36a)](_0x17d90b(0x294),_0x36abb5);});}function confirmMessage(_0x3088ab){const _0x1dfd58=_0x4d3bba;updateSetting(_0x1dfd58(0x31e),Number(_0x3088ab));}function isNewerVersion(_0x2fe68c,_0x267764){const _0x3df1d9=_0x4d3bba,_0x294131=_0x267764[_0x3df1d9(0x306)]('.'),_0x1d4075=_0x2fe68c[_0x3df1d9(0x306)]('.');for(var _0x2de01c=0x0;_0x2de01c<_0x1d4075[_0x3df1d9(0x36d)];_0x2de01c++){const _0x547dac=~~_0x1d4075[_0x2de01c],_0x34af7e=~~_0x294131[_0x2de01c];if(_0x547dac>_0x34af7e)return!![];if(_0x547dac<_0x34af7e)return![];}return![];}function toTelegramMarkdown(_0x5dd11b){const _0x57c27c=_0x4d3bba,_0x2160b4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x12d0fd=/\*{2}(.+?)\*{2}/gim;return _0x5dd11b=_0x5dd11b[_0x57c27c(0x1f6)](_0x2160b4,'$1_$2_$3')[_0x57c27c(0x1f6)](_0x12d0fd,_0x57c27c(0x3be)),_0x5dd11b;}async function validateConfigFile(){const _0x3614dd=_0x4d3bba,_0x12ac5e=dbConfig[_0x3614dd(0x329)](_0x3614dd(0x356))[_0x3614dd(0x392)](_0x3614dd(0x3b8))['value']()||[];if(_0x12ac5e[_0x3614dd(0x36d)]==0x0){let _0x5c51c2=0x0,_0x3084ad=[];const _0x38ce66=/^bot-([0-9]{3})-config.json$/,_0x1d49e7=fs[_0x3614dd(0x2a3)](configpath);_0x1d49e7['forEach'](_0x556157=>{const _0x4ebbbc=_0x3614dd,_0x78e9af=_0x38ce66[_0x4ebbbc(0x254)](_0x556157);if(_0x78e9af){const _0x51589e=_0x78e9af[0x1];let _0x1970e7=getBotAttributes(_0x51589e);_0x3084ad['push']({'botID':_0x51589e,'botname':_0x1970e7[_0x4ebbbc(0x388)],'status':_0x4ebbbc(0x217),'live':_0x4ebbbc(0x2f1)}),_0x5c51c2++;}}),_0x5c51c2!=0x0&&(dbConfig['get'](_0x3614dd(0x356))[_0x3614dd(0x343)](_0x3084ad)[_0x3614dd(0x2d0)](),config=_0x3084ad,restoredConfigFile=_0x5c51c2);}}async function restoreConfigNotify(_0x2b2d3e){const _0xeaa4aa=_0x4d3bba;let _0x377d36;if(restoredConfigFile==0x1)_0x377d36='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x377d36=_0xeaa4aa(0x2f9);if(_0x2b2d3e)io['to']('botmanager')[_0xeaa4aa(0x36a)](_0xeaa4aa(0x1d7),_0x377d36);else{logger[_0xeaa4aa(0x2cf)](_0xeaa4aa(0x39b)),logger[_0xeaa4aa(0x2cf)](_0x377d36),logger[_0xeaa4aa(0x2cf)]('-----------------------------------------------------------------------------------'),logger[_0xeaa4aa(0x2cf)]('');if(tgBot&&settings[_0xeaa4aa(0x1eb)]&&settings['telegramEvents']!=_0xeaa4aa(0x335))await sendTelegram(settings[_0xeaa4aa(0x1eb)],_0xeaa4aa(0x317)+_0x377d36);}}function validateCredentials(_0x3ac873,_0x6a1313){const _0x31c2ec=_0x4d3bba;if(_0x3ac873[_0x31c2ec(0x342)]==settings[_0x31c2ec(0x2ec)]&&bcrypt['compareSync'](_0x3ac873[_0x31c2ec(0x1db)],settings[_0x31c2ec(0x338)])){if(settings[_0x31c2ec(0x206)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x366f73=generateLoginToken(_0x6a1313);return{'allow':!![],'reason':_0x31c2ec(0x395),'token':_0x366f73};}}else return{'allow':![],'reason':_0x31c2ec(0x30d),'token':null};}function refreshToken(_0x25cb40){const _0x29334d=_0x4d3bba,_0x490801=generateLoginToken(_0x25cb40);return{'allow':!![],'reason':_0x29334d(0x395),'token':_0x490801};}function validateAccess(_0xd0327f,_0x248ba6,_0x4293b9){const _0x34c67f=_0x4d3bba,_0x55aeb2=_0x4293b9?_0x4293b9:devices[_0x248ba6]['ip'];let _0x255a77;const _0x10a33c=_0x50e2ba=>{const _0x212d6a=_0x43c8;if(settings[_0x212d6a(0x38d)]){if(settings[_0x212d6a(0x206)]){if(telegram2FaApproved(_0x248ba6)){const _0x181296=generateLoginToken(_0x248ba6);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x181296};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x255a77=validToken(_0x50e2ba,_0x248ba6),_0x255a77['hasOwnProperty'](_0x212d6a(0x35c))?{'allow':!![],'reason':_0x212d6a(0x2fd),'token':_0x50e2ba}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x212d6a(0x33c),'token':null};};if(settings[_0x34c67f(0x3c6)]){let _0x471133=[...settings[_0x34c67f(0x3c5)],_0x34c67f(0x3c1),_0x34c67f(0x1e1),_0x34c67f(0x2b3)];if(_0x471133[_0x34c67f(0x350)](_0x55aeb2))return _0x10a33c(_0xd0327f);else{_0x255a77=validToken(_0xd0327f,_0x248ba6);if(_0x255a77[_0x34c67f(0x2b6)](_0x34c67f(0x35c)))return _0x10a33c(_0xd0327f);else{if(telegramIpApproved(_0x248ba6)){const _0x8269e9=generateToken(_0x248ba6);return _0x255a77=_0x10a33c(_0xd0327f),_0x255a77[_0x34c67f(0x1e2)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x8269e9}:_0x255a77;}else return settings[_0x34c67f(0x1fa)]?{'allow':![],'reason':_0x34c67f(0x366),'token':null}:{'allow':![],'reason':_0x34c67f(0x265),'token':null};}}}else return _0x10a33c(_0xd0327f);}function timelyDecrypt(_0x4e347b,_0x51032e,_0x527da2='@'){const _0x518264=_0x4d3bba;if(_0x4e347b)try{const _0x2333c8=crypt[_0x518264(0x379)](secure[_0x518264(0x1c5)],_0x4e347b)[_0x518264(0x294)],_0xb61ce8=_0x2333c8[_0x518264(0x306)](_0x527da2)[0x0],_0x280564=_0x2333c8['split'](_0x527da2)[0x1],_0x2274c6=new Date()['getTime']();if(_0x51032e){if(_0x2274c6-_0x280564<maxSecretAge*0x3e8)return _0xb61ce8;else return![];}else return _0xb61ce8;}catch(_0x448e7d){return![];}else return![];}const validToken=(_0x4fd4d7,_0x1a3516)=>{const _0x479643=_0x4d3bba,_0x17a02a=devices[_0x1a3516]['ip'];if(!_0x4fd4d7)return{'error':_0x479643(0x397)};for(let _0x414492 of blacklist){if(_0x414492[_0x479643(0x2b2)]==_0x4fd4d7)return{'error':_0x479643(0x2e6)};}let _0x33042e;try{_0x33042e=jwt['verify'](_0x4fd4d7,secure['secret']+_0x1a3516);}catch{return{'error':_0x479643(0x303)};}if(!_0x33042e['hasOwnProperty']('clientip')&&!_0x33042e[_0x479643(0x2b6)](_0x479643(0x342))||!_0x33042e[_0x479643(0x2b6)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x33042e[_0x479643(0x2b6)](_0x479643(0x342))&&_0x33042e[_0x479643(0x2b6)](_0x479643(0x3ab))){const {clientip:_0x215b4b}=_0x33042e;return _0x17a02a==_0x215b4b?{'success':_0x479643(0x1e5)}:{'error':_0x479643(0x1d9)};}else{if(_0x33042e[_0x479643(0x2b6)](_0x479643(0x342))&&_0x33042e[_0x479643(0x2b6)](_0x479643(0x3ab))){const {username:_0x38fd5d,clientip:_0x57906d}=_0x33042e;return settings[_0x479643(0x2ec)]==_0x38fd5d&&_0x17a02a==_0x57906d?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x479643(0x3b5)};}}},generateLoginToken=_0x1b5a38=>{const _0xdcb1df=_0x4d3bba;if(_0x1b5a38){const _0x385ebf=devices[_0x1b5a38]['ip'];return jwt[_0xdcb1df(0x1e8)]({'username':settings[_0xdcb1df(0x2ec)],'clientip':_0x385ebf},secure[_0xdcb1df(0x2e8)]+_0x1b5a38,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x534236=>{const _0x6f7f47=_0x4d3bba;if(_0x534236){const _0x2fba83=devices[_0x534236]['ip'];return jwt[_0x6f7f47(0x1e8)]({'clientip':_0x2fba83},secure['secret']+_0x534236,{'expiresIn':devices[_0x534236][_0x6f7f47(0x1e6)][_0x6f7f47(0x1c7)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x38e9c8=>{const _0xaa83bd=_0x4d3bba;let _0x32fe0a=![];return devices[_0x38e9c8][_0xaa83bd(0x1e6)]&&devices[_0x38e9c8][_0xaa83bd(0x1e6)][_0xaa83bd(0x1c7)]!=_0xaa83bd(0x253)&&(_0x32fe0a=devices[_0x38e9c8][_0xaa83bd(0x1e6)]['clientip']==devices[_0x38e9c8]['ip']&&new Date()['getTime']()-devices[_0x38e9c8][_0xaa83bd(0x1e6)][_0xaa83bd(0x224)]<devices[_0x38e9c8][_0xaa83bd(0x1e6)]['expiry']*0x3c*0x3e8),_0x32fe0a;},telegram2FaApproved=_0x1e6f35=>{const _0x51fa5b=_0x4d3bba;let _0x19922b=![];return devices[_0x1e6f35]['telegram2FaApproval']&&devices[_0x1e6f35]['telegram2FaApproval'][_0x51fa5b(0x1c7)]!=_0x51fa5b(0x253)&&(_0x19922b=devices[_0x1e6f35][_0x51fa5b(0x365)][_0x51fa5b(0x3ab)]==devices[_0x1e6f35]['ip']&&new Date()[_0x51fa5b(0x24b)]()-devices[_0x1e6f35][_0x51fa5b(0x365)][_0x51fa5b(0x224)]<devices[_0x1e6f35][_0x51fa5b(0x365)]['expiry']*0x3c*0x3e8),_0x19922b;},normalizeIP=_0x27484b=>{const _0x1c0c51=_0x4d3bba;let _0x3446f8=null,_0x5a7d6b=null;if(ipaddr[_0x1c0c51(0x393)](_0x27484b)){const _0x2b391c=ipaddr['parse'](_0x27484b);_0x2b391c[_0x1c0c51(0x25f)]()===_0x1c0c51(0x2d4)?(_0x2b391c[_0x1c0c51(0x27c)]()&&(_0x3446f8=_0x2b391c[_0x1c0c51(0x23b)]()[_0x1c0c51(0x256)]()),_0x5a7d6b=_0x2b391c[_0x1c0c51(0x256)]()):(_0x3446f8=_0x2b391c[_0x1c0c51(0x256)](),_0x5a7d6b=_0x2b391c[_0x1c0c51(0x333)]()[_0x1c0c51(0x256)]());}return{'show':_0x3446f8?_0x3446f8:_0x5a7d6b,'store':_0x5a7d6b};};function formatDate(_0x4937d4){const _0x13b5ea=_0x4d3bba;return _0x4937d4[_0x13b5ea(0x38b)]()+'/'+(_0x4937d4[_0x13b5ea(0x272)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x4937d4[_0x13b5ea(0x295)]()[_0x13b5ea(0x256)]()[_0x13b5ea(0x2ea)](0x2,'0')+'\x20'+_0x4937d4[_0x13b5ea(0x361)]()[_0x13b5ea(0x256)]()[_0x13b5ea(0x2ea)](0x2,'0')+':'+_0x4937d4['getMinutes']()['toString']()[_0x13b5ea(0x2ea)](0x2,'0')+':'+_0x4937d4['getSeconds']()[_0x13b5ea(0x256)]()[_0x13b5ea(0x2ea)](0x2,'0');}function sleep(_0x98fc4d){return new Promise(_0x519985=>setTimeout(_0x519985,_0x98fc4d));}