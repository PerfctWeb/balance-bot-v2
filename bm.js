const _0x1f002e=_0x1851;(function(_0xd90f25,_0x134aa1){const _0x375967=_0x1851,_0x45f783=_0xd90f25();while(!![]){try{const _0xd6c05a=parseInt(_0x375967(0x246))/0x1+-parseInt(_0x375967(0x28b))/0x2*(-parseInt(_0x375967(0x3a6))/0x3)+-parseInt(_0x375967(0x3af))/0x4+parseInt(_0x375967(0x1ec))/0x5*(parseInt(_0x375967(0x289))/0x6)+parseInt(_0x375967(0x344))/0x7*(parseInt(_0x375967(0x37b))/0x8)+parseInt(_0x375967(0x2b7))/0x9*(parseInt(_0x375967(0x2b1))/0xa)+-parseInt(_0x375967(0x295))/0xb;if(_0xd6c05a===_0x134aa1)break;else _0x45f783['push'](_0x45f783['shift']());}catch(_0x3712e1){_0x45f783['push'](_0x45f783['shift']());}}}(_0x4b8d,0xa4db8));const _0x577247=function(){let _0x36fc46=!![];return function(_0x76b973,_0x37d545){const _0x207b1b=_0x36fc46?function(){const _0x124c7f=_0x1851;if(_0x37d545){const _0x74aa66=_0x37d545[_0x124c7f(0x39f)](_0x76b973,arguments);return _0x37d545=null,_0x74aa66;}}:function(){};return _0x36fc46=![],_0x207b1b;};}(),_0xe04bab=_0x577247(this,function(){const _0x236bbe=_0x1851;return _0xe04bab[_0x236bbe(0x396)]()[_0x236bbe(0x37c)](_0x236bbe(0x224))[_0x236bbe(0x396)]()[_0x236bbe(0x33e)](_0xe04bab)[_0x236bbe(0x37c)](_0x236bbe(0x224));});_0xe04bab();'use strict';process[_0x1f002e(0x39d)][_0x1f002e(0x275)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x1f002e(0x276)),low=require(_0x1f002e(0x38f)),FileSync=require(_0x1f002e(0x3ac)),path=require(_0x1f002e(0x391)),crypto=require(_0x1f002e(0x319)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require('hybrid-crypto-js')[_0x1f002e(0x229)],bcrypt=require(_0x1f002e(0x248)),jwt=require('jsonwebtoken'),ipaddr=require(_0x1f002e(0x38d)),argv=require(_0x1f002e(0x369))(process[_0x1f002e(0x37a)][_0x1f002e(0x371)](0x2))[_0x1f002e(0x37a)],uuidRandom=require(_0x1f002e(0x3be)),TelegramBot=require(_0x1f002e(0x2b6)),Mixpanel=require(_0x1f002e(0x3a1)),axios=require(_0x1f002e(0x24e)),{GraphQLClient,gql}=require(_0x1f002e(0x388)),util=require(_0x1f002e(0x3bf)),fileUpload=require(_0x1f002e(0x330)),{networkInterfaces}=require('os'),PORT=argv[_0x1f002e(0x26d)]||_0x1f002e(0x2ee),pattern=/^[0-9]{2,4}$/;!pattern[_0x1f002e(0x2f5)](PORT)&&(console['log'](_0x1f002e(0x346)+PORT+_0x1f002e(0x215)),process[_0x1f002e(0x262)](0x1));const HOST=argv[_0x1f002e(0x2b8)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x1f002e(0x25a)]['node'],environment=require(_0x1f002e(0x2e8))[_0x1f002e(0x28e)]||_0x1f002e(0x210);let bbpath=_0x1f002e(0x322),bbpath2='';const botfile=_0x1f002e(0x214),configfile=_0x1f002e(0x235),settingsfile=_0x1f002e(0x219),securefile=_0x1f002e(0x397),maxBackups=0xa;let validInstallation=!![];!fs[_0x1f002e(0x266)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1f002e(0x333)),configpath=userID?bbpath+_0x1f002e(0x394)+userID+'/':bbpath+_0x1f002e(0x394),configbackuppath=configpath+_0x1f002e(0x241),logspath=userID?bbpath+_0x1f002e(0x36c)+userID+'/':bbpath+_0x1f002e(0x36c),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x1f002e(0x2a7)](logspath+_0x1f002e(0x2c9),{'flags':'a'}),temppath=userID?bbpath+_0x1f002e(0x1db)+userID+'/':bbpath+_0x1f002e(0x1db);!fs[_0x1f002e(0x266)](configpath)&&fs[_0x1f002e(0x3c2)](configpath);function _0x1851(_0x12374a,_0x9218b4){const _0x2e8db4=_0x4b8d();return _0x1851=function(_0xe04bab,_0x577247){_0xe04bab=_0xe04bab-0x1db;let _0x4b8d12=_0x2e8db4[_0xe04bab];return _0x4b8d12;},_0x1851(_0x12374a,_0x9218b4);}!fs[_0x1f002e(0x266)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x1f002e(0x266)](logspath)&&fs[_0x1f002e(0x3c2)](logspath);!fs[_0x1f002e(0x266)](zippath)&&fs[_0x1f002e(0x3c2)](zippath);!fs[_0x1f002e(0x266)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1f002e(0x383)]({'bots':[]})[_0x1f002e(0x399)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x1f002e(0x399)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x1f002e(0x399)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x1f002e(0x2d2)});function _0x4b8d(){const _0x6cf62f=['-results.json','readdirSync','axios','temporary\x20token\x20generated','encryptedUuid','ipv6','Disabled\x20Bot\x20','track','Unauthorized\x20attempt\x20to\x20get\x20messages','2FA\x20login\x20required','order','emitHistory','-events.json','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','versions','telegramEnabled','rmSync','bot-','chat','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','status','add','exit','updatebotmanager','Bot\x20','Node.js\x20v','existsSync','Invalid\x20authentication\x20token\x20(1)','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Backup\x20file\x20uploaded','disconnect','success','update-bb','port','showConfig','stopped','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','\x20only\x0a','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','format','#RES#\x20if\x20running\x20locally\x0a','NTBA_FIX_319','date-fns','restore-backup-file','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Unauthorized\x20attempt\x20to\x20get\x20events','telegramEvents','getHours','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','new','botname','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','DEFLATE','https://api.ipify.org?format=json','login\x20required','/update\x20-\x20update\x20Balance\x20Bot\x0a','cloneDeep','/help\x20-\x20show\x20available\x20commands\x0a','Notifications\x20types:\x20','access\x20timeout','641964yikyEf','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','32906EAMgCt','Login\x20accepted','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','environment','Idling\x20bot\x20\x20\x20|\x20Bot\x20','build2','***','headless','allow','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','32132562HonPID','************','keys','telegrammsg','file','randomBytes','apiPassword','timestamp','use','2FA','backup-full@','Failed\x20to\x20download\x20','function','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','bot','confirm-message','loginRequired','createWriteStream','hashSync','Bot\x20Mgr\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','toIPv4Address','backup-files','Starting\x20#RED#Balance\x20Bot\x20v','find','login\x20not\x20required','toIPv4MappedAddress','10598670rjTJDF','min','compareSync','30\x20min','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','node-telegram-bot-api','9PzDxdg','host','warning','onText','clientip','address','initclient','remoteAddress','static','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Token\x20blacklisted','started','storeFiat','show','deleteHistoryAlerts','generate','Unauthorized\x20attempt\x20to\x20log\x20out','settings.','/output-000.log','Notifications\x20enabled\x0a','uuid','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20update\x20bot','/:bot/support','reinstall-bb','[ip-address]','family','RSA-OAEP','$1_$2_$3','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','staging','error','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','answerCallbackQuery','\x20(1)','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','bbUsername','logged\x20out','\x20minutes','manual','Unauthorized\x20attempt\x20to\x20show\x20configuration','split','get','pidExpireLogin','logout','parse','max','getTime','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','./version.json','whitelist','/status\x20-\x20show\x20bot(s)\x20status\x0a','getPortfolio','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','connected','3000','Invalid\x20username\x20or\x20IP\x20address','Password\x20has\x20been\x20reset\x20to:\x20','/off\x20-\x20stop\x20bot(s)\x0a','(staging)','push','output-002.log','test','sockets','update','2FA\x20login\x20rejected','\x1b[31m','output-001.log','output-000.log','fork','telegramToken','All\x20bots\x20running\x20right\x20now','No\x20bots\x20running\x20right\x20now','Starting\x20Balance\x20Bot\x20reinstallation','Error\x20removing\x20old\x20backup\x20files:','ipc','Allow\x20login\x20from\x20IP\x20address\x20<b>','lastmsgtelegram','endsWith','secure','polling_error','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','privateKey','writeFileSync','=>\x20Go\x20to\x20#CYA#http://','auth','assign','/enable\x20-\x20enable\x20notifications\x0a','Restore\x20backup\x20file\x20','sendFile','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','showname','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegram2FaApproval','sortBy','#RES#\x20if\x20running\x20on\x20server','get-backup-files','Ok,\x20will\x20send\x20alert\x20notifications\x20only','crypto','send','reject','remove','reason','stringify','reinstall','settings','telegramChatId','bb/','reset-history','http','listen','placeOrder','notification','/names\x20-\x20show\x20bot\x20names\x0a','show-config','Starting\x20new\x20bot\x20|\x20Bot\x20','padStart','readFileSync','/:bot/coins','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','set','express-fileupload','name','pidRefreshToken','clients','reload','handshake','Unauthorized\x20attempt\x20to\x20confirm\x20message','Access\x20enabled\x20for\x20','User\x20has\x20been\x20validated','getSeconds','yes','/:bot/history','init','unlinkSync','constructor','Yes','bots','whitelistEnabled','\x20mode','removeListener','3409WubTOf','enabled','Error:\x20Invalid\x20argument\x20','from','hasOwnProperty','login\x20token\x20generated','lastmsgemitted','Notifications\x20disabled','all','replace',':\x20Bot\x20Mgr\x20>\x20','username','running','api-eu.mixpanel.com','generateKeyPairAsync','tkn','\x20>\x20','Invalid\x20IP\x20address','expiry','/upload-backup','/on\x20-\x20start\x20bot(s)\x0a','map','Unauthorized\x20attempt\x20to\x20delete\x20bot','message','onepagemode','binary','Restore\x20process\x20aborted','restart','stop','store-headless','mtime','catch','\x1b[0m','telegram','mode','Restarting\x20Bot\x20','uncaughtException','yargs/yargs','exp','socket','logs/','2FA\x20login\x20token\x20generated','All','copyFileSync','referer','slice','log','apiKey','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','.zip','getUTCHours','/:bot/performance','get-portfolio','express','argv','13096TBoWRj','search','getStartingBalances','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','\x20|\x20client:\x20...','store-fiat','match','filter','defaults','</b>\x20?','backup','conn','then','graphql-request','::1','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','password','/:bot/portfolio','ipaddr.js','Orders','lowdb','simple','path','hex','place-order','config/','toggleBotMode','toString','bb-secure.json','createServer','write','\x20(2)','Starting\x20bot\x20|\x20Bot\x20','number','env','telegramUsername','apply','sign','mixpanel','inherit','callback_query','SIGINT','store-configuration','213CbwSYn','Unauthorized\x20attempt\x20to\x20download\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','Restoring\x20bot(s)\x20from\x20backup','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','0.0.0','lowdb/adapters/FileSync','kill','params','4532952CvQWOv','any','toggle-bot-mode','All\x20bots','#RES#\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','join','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20add\x20bot','f2aRequired','backup-full','Starting\x20Balance\x20Bot\x20update','invalid\x20credentials','Logged\x20out\x20user\x20...','uuid-random','util','version','debug','mkdirSync','\x20|\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','alias','storeHeadless','bbvReceive','temp/','secret','Notifications\x20enabled','blacklist','getFullYear','decrypt','timeshift','2FA\x20required','token','Server','bbvNew',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Invalid\x20Telegram\x20token','forEach','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','get-messages','Error\x20while\x20deleting\x20config\x20files:\x20','25HzLJDr','HTML','new-disabled','127.0.0.1','store','startsWith','kind','/disable\x20-\x20disable\x20notifications\x0a','-----------------------------------------------------------------------------------','index.html','login','reset-password','isIPv4MappedAddress','stopPolling','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','type','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','<b>Telegram\x20Bot\x20Status:</b>\x0a','Setting\x20access:\x20','files','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','telegramIpApproval','\x1b[33m','1000','getDate','disabled','botID','Unauthorized\x20attempt\x20to\x20get\x20portfolio','latestversion','isDirectory','Deleted\x20Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','temporary\x20access\x20not\x20allowed','Unauthorized\x20login\x20attempt\x20(timeout)','resetHistory','production','download','get-logs','Logged\x20in\x20user\x20...','bot.js',',\x20must\x20be\x20a\x204\x20digit\x20number','length','5\x20min','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bb-settings.json','orders','getMonth','\x1b[35m','statSync','sendMessage','headers','logs','sort','/:bot','Invalid\x20authentication\x20token\x20(2)','(((.+)+)+)+$','update-bot','getMinutes','access','build','RSA','size','value','Session\x20expired\x20for\x20user\x20...','exchange','auto','includes','bbPassword','-performance.json','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','alerts','live','bb-config.json','post','data','Notifications\x20disabled\x0a','userid','-config.json','node-zip','SIGTERM','\x1b[36m','verify','full','event','backup/','messages','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','emit','botmanager','1169417ocivaf','once','bcryptjs','<b>Balance\x20Bot\x20Status:</b>\x0a','publicKey','sendPortfolioTelegram'];_0x4b8d=function(){return _0x6cf62f;};return _0x4b8d();}const saltRounds=0xa,mixpanel=Mixpanel[_0x1f002e(0x33c)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x1f002e(0x351)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1f002e(0x2fd)]&&settings[_0x1f002e(0x2fd)]!=''&&settings[_0x1f002e(0x39e)]&&settings[_0x1f002e(0x39e)]!='')initTelegram();const parseColor=(_0x54a9ac,_0x3e3e40)=>{const _0x5bf3be=_0x1f002e,_0x35f39a=/#[A-Z]{3}#/g;if(typeof _0x54a9ac=='string'){!_0x3e3e40?_0x54a9ac=_0x54a9ac[_0x5bf3be(0x34d)](_0x35f39a,''):(_0x54a9ac=_0x54a9ac['replace'](/#BLU#/g,'\x1b[34m'),_0x54a9ac=_0x54a9ac[_0x5bf3be(0x34d)](/#RED#/g,_0x5bf3be(0x2f9)),_0x54a9ac=_0x54a9ac[_0x5bf3be(0x34d)](/#YEL#/g,_0x5bf3be(0x202)),_0x54a9ac=_0x54a9ac[_0x5bf3be(0x34d)](/#MAG#/g,_0x5bf3be(0x21c)),_0x54a9ac=_0x54a9ac[_0x5bf3be(0x34d)](/#CYA#/g,_0x5bf3be(0x23d)),_0x54a9ac=_0x54a9ac[_0x5bf3be(0x34d)](/#RES#/g,_0x5bf3be(0x364)));;}return _0x54a9ac;},logger={'screen':_0x516614=>{console['log'](parseColor(_0x516614,!![]));},'simple':_0x101af1=>{const _0x449370=_0x1f002e;console['log'](parseColor(_0x101af1,!![])),loggerfile[_0x449370(0x399)](util[_0x449370(0x273)](parseColor(_0x101af1,![]))+'\x0a');},'full':async _0x35bb8c=>{const _0xfed19=_0x1f002e,_0x231d6e=getTimeStamp()+_0xfed19(0x34e)+_0x35bb8c;console[_0xfed19(0x372)](parseColor(_0x231d6e,!![])),loggerfile[_0xfed19(0x399)](util[_0xfed19(0x273)](parseColor(_0x231d6e,![]))+'\x0a');if(tgBot&&settings[_0xfed19(0x321)]&&settings[_0xfed19(0x27a)]!=_0xfed19(0x21a))await tgBot[_0xfed19(0x21e)](settings[_0xfed19(0x321)],_0xfed19(0x2a9)+parseColor(_0x35bb8c,![]))[_0xfed19(0x363)](_0x13bf94=>{telegramError(_0x13bf94);});},'debug':async(_0x16b247,_0x15c895='')=>{const _0x1a5f77=_0x1f002e,_0x25eb88=getTimeStamp()+_0x1a5f77(0x1e6)+_0x16b247;if(debugging)console[_0x1a5f77(0x372)](parseColor(_0x25eb88,!![]));loggerfile[_0x1a5f77(0x399)](util[_0x1a5f77(0x273)](parseColor(_0x25eb88,![]))+'\x0a');if(_0x15c895){if(debugging)console[_0x1a5f77(0x372)](_0x15c895);loggerfile['write'](util['format'](_0x15c895)+'\x0a');}}};process['on'](_0x1f002e(0x368),function(_0x399204){logger['simple'](_0x399204);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1f002e(0x3c0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1f002e(0x379)),app=express(),http=require(_0x1f002e(0x324))[_0x1f002e(0x398)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x1f002e(0x2e1)]('/download/:type',async(_0x311ddd,_0x59a4a0)=>{const _0x234b3b=_0x1f002e,_0x4106b6=_0x311ddd[_0x234b3b(0x3ae)][_0x234b3b(0x1fb)],_0x4eae44=getClientsWithBotID(_0x234b3b(0x245)),_0x408410=_0x311ddd[_0x234b3b(0x21f)][_0x234b3b(0x2cb)],_0xaabd7f=timelyDecrypt(_0x408410,![]),_0x2f55f4=_0x4eae44[_0x234b3b(0x2ae)](_0x51a2bc=>_0x51a2bc[_0x234b3b(0x2cb)]==_0xaabd7f);if(_0x2f55f4){const _0x31053c=normalizeIP(_0x311ddd[_0x234b3b(0x36b)]['remoteAddress'])[_0x234b3b(0x1f0)],_0x4d504b=_0x311ddd[_0x234b3b(0x21f)][_0x234b3b(0x353)];if(validateAccess(_0x4d504b,_0xaabd7f,_0x31053c)[_0x234b3b(0x293)])_0x4106b6==_0x234b3b(0x385)&&await backupConfigFiles(),await zipFiles(_0x4106b6),_0x59a4a0[_0x234b3b(0x211)](zippath+(_0x4106b6+'.zip'),_0x21333d=>{const _0x45cc36=_0x234b3b;_0x21333d&&(logger[_0x45cc36(0x23f)](_0x45cc36(0x2a0)+_0x4106b6),logger[_0x45cc36(0x390)](_0x21333d));});else logger[_0x234b3b(0x23f)](_0x234b3b(0x3a7)+_0x4106b6+_0x234b3b(0x2d9));}else logger[_0x234b3b(0x23f)](_0x234b3b(0x3a7)+_0x4106b6+_0x234b3b(0x39a));}),app[_0x1f002e(0x236)](_0x1f002e(0x357),async(_0x57998e,_0x2c4c49)=>{const _0xc3cf95=_0x1f002e,_0x234793=getClientsWithBotID('botmanager'),_0x3ee547=_0x57998e[_0xc3cf95(0x21f)][_0xc3cf95(0x2cb)],_0x457d43=timelyDecrypt(_0x3ee547,![]),_0x2c2a23=_0x234793[_0xc3cf95(0x2ae)](_0x2c6428=>_0x2c6428[_0xc3cf95(0x2cb)]==_0x457d43);logger[_0xc3cf95(0x3c1)](_0xc3cf95(0x269));if(_0x2c2a23){const _0x4636f9=normalizeIP(_0x57998e[_0xc3cf95(0x36b)][_0xc3cf95(0x2be)])['store'],_0x20d639=_0x57998e[_0xc3cf95(0x21f)][_0xc3cf95(0x353)];if(validateAccess(_0x20d639,_0x457d43,_0x4636f9)[_0xc3cf95(0x293)]){if(_0x57998e[_0xc3cf95(0x1ff)]){const _0xd3e90c=_0x57998e[_0xc3cf95(0x1ff)]['backupfile'];await _0xd3e90c['mv'](temppath+_0xd3e90c['name']),_0x2c4c49[_0xc3cf95(0x31a)]({'status':!![],'message':'File\x20uploaded'});const _0x17f4e0=getBotsWithMode();_0x17f4e0['length']>0x0?confirmRestore(temppath,_0xd3e90c[_0xc3cf95(0x331)]):unzipFile(temppath,_0xd3e90c[_0xc3cf95(0x331)]);}}else logger[_0xc3cf95(0x23f)](_0xc3cf95(0x1fc));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x1f002e(0x29d)](express[_0x1f002e(0x2bf)](path[_0x1f002e(0x3b6)](__dirname,bbpath2,_0x1f002e(0x290)))),app['use'](express[_0x1f002e(0x2bf)](path[_0x1f002e(0x3b6)](__dirname,bbpath2,_0x1f002e(0x228)))),app[_0x1f002e(0x2e1)]('/',function(_0x44a425,_0x517854){const _0x11f9c2=_0x1f002e;_0x517854['sendFile'](path[_0x11f9c2(0x3b6)](__dirname,bbpath2,'build2',_0x11f9c2(0x1f5)));}),app[_0x1f002e(0x2e1)](_0x1f002e(0x222),function(_0x14166f,_0x1ca429){const _0x472311=_0x1f002e;_0x1ca429['sendFile'](path[_0x472311(0x3b6)](__dirname,bbpath2,_0x472311(0x228),_0x472311(0x1f5)));}),app['get'](_0x1f002e(0x38c),(_0x2db868,_0x17cf34)=>{const _0xdb706c=_0x1f002e;_0x17cf34[_0xdb706c(0x310)](path[_0xdb706c(0x3b6)](__dirname,bbpath2,_0xdb706c(0x228),_0xdb706c(0x1f5)));}),app[_0x1f002e(0x2e1)](_0x1f002e(0x377),(_0x44a112,_0x411d09)=>{const _0x59760d=_0x1f002e;_0x411d09['sendFile'](path['join'](__dirname,bbpath2,_0x59760d(0x228),'index.html'));}),app[_0x1f002e(0x2e1)](_0x1f002e(0x32d),(_0x4477fb,_0x25e1b2)=>{const _0x5d423e=_0x1f002e;_0x25e1b2[_0x5d423e(0x310)](path[_0x5d423e(0x3b6)](__dirname,bbpath2,_0x5d423e(0x228),_0x5d423e(0x1f5)));}),app[_0x1f002e(0x2e1)](_0x1f002e(0x33b),(_0x48ad48,_0x370489)=>{const _0xbd2494=_0x1f002e;_0x370489[_0xbd2494(0x310)](path['join'](__dirname,bbpath2,_0xbd2494(0x228),_0xbd2494(0x1f5)));}),app[_0x1f002e(0x2e1)]('/:bot/configuration',(_0x3e733c,_0xea83fd)=>{const _0x2b2351=_0x1f002e;_0xea83fd['sendFile'](path[_0x2b2351(0x3b6)](__dirname,bbpath2,_0x2b2351(0x228),_0x2b2351(0x1f5)));}),app[_0x1f002e(0x2e1)](_0x1f002e(0x2ce),(_0x45daa8,_0x83f4aa)=>{const _0x301765=_0x1f002e;_0x83f4aa['sendFile'](path[_0x301765(0x3b6)](__dirname,bbpath2,_0x301765(0x228),_0x301765(0x1f5)));});if(HOST)http[_0x1f002e(0x325)](PORT,HOST);else http[_0x1f002e(0x325)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x14943b=_0x1f002e;let _0x3e8d98=_0x14943b(0x2d0);const _0x415ec7=networkInterfaces(),_0x502db3={};for(const _0x31f8bd of Object[_0x14943b(0x297)](_0x415ec7)){for(const _0x2c3363 of _0x415ec7[_0x31f8bd]){if((_0x2c3363[_0x14943b(0x2d1)]=='IPv4'||_0x2c3363[_0x14943b(0x2d1)]==0x4)&&!_0x2c3363['internal']){const _0x3b1452=ipaddr[_0x14943b(0x2e4)](_0x2c3363['address'])['range']();_0x3b1452!='private'&&(!_0x502db3[_0x31f8bd]&&(_0x502db3[_0x31f8bd]=[]),_0x502db3[_0x31f8bd][_0x14943b(0x2f3)](_0x2c3363[_0x14943b(0x2bc)]),_0x3e8d98=_0x2c3363[_0x14943b(0x2bc)]);}}}return{'serverip':_0x3e8d98,'netinterfaces':_0x502db3};}async function startServer(){const _0x283332=_0x1f002e,{serverip:_0x149bed,netinterfaces:_0x307c88}=getServerIP();logger[_0x283332(0x390)](''),logger['simple'](_0x283332(0x1f4)),await logger[_0x283332(0x23f)](_0x283332(0x2ad)+serverversion+_0x283332(0x3b3)+(environment==_0x283332(0x2d5)?_0x283332(0x2f2):'')+'\x0a'+(_0x283332(0x2da)+PORT+_0x283332(0x274))+(_0x283332(0x30b)+_0x149bed+':'+PORT+_0x283332(0x316))),logger[_0x283332(0x390)]('-----------------------------------------------------------------------------------');if(config[_0x283332(0x216)]!=0x0)for(const _0x647d5d of config){if(_0x647d5d[_0x283332(0x260)]==_0x283332(0x345)||_0x647d5d[_0x283332(0x260)]==_0x283332(0x27d))await logger[_0x283332(0x23f)](_0x283332(0x39b)+_0x647d5d[_0x283332(0x206)]+'\x20|\x20'+_0x647d5d[_0x283332(0x27e)]),startBot([_0x647d5d[_0x283332(0x206)],userID],{'cwd':bbpath},function(_0x3af4e7){const _0x513426=_0x283332;if(_0x3af4e7)logger[_0x513426(0x23f)](_0x3af4e7);});else(_0x647d5d['status']==_0x283332(0x205)||_0x647d5d[_0x283332(0x260)]==_0x283332(0x1ee))&&await logger['full'](_0x283332(0x28f)+_0x647d5d[_0x283332(0x206)]+_0x283332(0x3c3)+_0x647d5d[_0x283332(0x27e)]);}else!newBot&&logger[_0x283332(0x390)](_0x283332(0x218));if(newBot)addBot();logger[_0x283332(0x390)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x283332(0x3c1)](_0x283332(0x265)+nodeversion),await logger[_0x283332(0x3c1)]('Network\x20Interfaces:',_0x307c88);}function startSocket(){io['on']('connection',_0x3b1f33=>{const _0x3f491d=_0x1851;let _0x4ccbb1,_0x129ee3,_0x21cd17,_0x35c604,_0x1634d3;const _0x4749c2=_0x3b1f33[_0x3f491d(0x335)]['headers'][_0x3f491d(0x370)];_0x129ee3=_0x4749c2[_0x3f491d(0x381)](/bot[0-9]{3}/);if(_0x129ee3)_0x21cd17=_0x129ee3[0x0]['match'](/[0-9]{3}/);if(_0x21cd17)_0x4ccbb1=_0x21cd17[0x0];else _0x4ccbb1=_0x3f491d(0x245);const _0x4f1bc7=_0x3b1f33[_0x3f491d(0x335)][_0x3f491d(0x30c)][_0x3f491d(0x250)];if(!_0x4f1bc7)_0x3b1f33[_0x3f491d(0x244)](_0x3f491d(0x260),{'publicKey':secure[_0x3f491d(0x24a)]});else{_0x35c604=timelyDecrypt(_0x4f1bc7,![]);if(!_0x35c604)_0x3b1f33['emit'](_0x3f491d(0x260),{'publicKey':secure[_0x3f491d(0x24a)]});else{_0x1634d3=normalizeIP(_0x3b1f33[_0x3f491d(0x386)][_0x3f491d(0x2be)])[_0x3f491d(0x1f0)];if(!devices[_0x35c604])devices[_0x35c604]={'uuid':_0x35c604,'access':{'token':null}};devices[_0x35c604]['ip']=_0x1634d3;const _0x4beb6b=addClient(_0x3b1f33['id'],_0x35c604,_0x4ccbb1);setAccess(_0x4beb6b),emitMessages(),_0x3b1f33['on']('login',_0xf77365=>{const _0x14a926=_0x3f491d,_0x4bdfd5=timelyDecrypt(_0xf77365['password']);if(_0x4bdfd5){_0xf77365={'username':_0xf77365[_0x14a926(0x34f)],'password':_0x4bdfd5},devices[_0x35c604][_0x14a926(0x227)]=validateCredentials(_0xf77365,_0x35c604);if(devices[_0x35c604]['access'][_0x14a926(0x293)]==![]&&devices[_0x35c604][_0x14a926(0x227)][_0x14a926(0x31d)]==_0x14a926(0x255))_0x3b1f33[_0x14a926(0x244)](_0x14a926(0x260),{'access':devices[_0x35c604][_0x14a926(0x227)]}),loginAccess2FA(_0x35c604,_0x1634d3);else{if(devices[_0x35c604][_0x14a926(0x227)][_0x14a926(0x293)]==![]&&devices[_0x35c604]['access'][_0x14a926(0x31d)]==_0x14a926(0x3bc))_0x3b1f33[_0x14a926(0x244)](_0x14a926(0x260),{'access':devices[_0x35c604][_0x14a926(0x227)]});else devices[_0x35c604][_0x14a926(0x227)]['allow']&&devices[_0x35c604]['access'][_0x14a926(0x31d)]==_0x14a926(0x349)&&(getClientsWithUuid(_0x35c604)[_0x14a926(0x1e8)](_0x10aca2=>{setAccess(_0x10aca2);}),logger[_0x14a926(0x3c1)](_0x14a926(0x213)+_0x35c604[_0x14a926(0x371)](-0x8)),setTokenRefresh(_0x35c604),setSessionTimeout(_0x14a926(0x1f6),_0x35c604));}}else logger[_0x14a926(0x23f)](_0x14a926(0x20e));}),_0x3b1f33['on'](_0x3f491d(0x1f7),()=>{resetPassword();}),_0x3b1f33['on'](_0x3f491d(0x26a),_0x2dd528=>{removeClient(_0x3b1f33['id']);}),_0x4ccbb1==_0x3f491d(0x245)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5e4512){const _0x5edf0c=_0x1f002e;if(_0x5e4512!=_0x5edf0c(0x245)&&config[_0x5edf0c(0x373)]!=''){if(pid[_0x5e4512])pid[_0x5e4512][_0x5edf0c(0x31a)]({'function':_0x5edf0c(0x2bd),'args':null});}_0x5e4512!=_0x5edf0c(0x245)&&broadcastToBots(_0x5edf0c(0x340),JSON[_0x5edf0c(0x31e)](config));}function reloadBotManager(){const _0x4408a5=_0x1f002e;getClientsWithBotID(_0x4408a5(0x245))[_0x4408a5(0x1e8)](_0x502761=>{const _0x126dcc=_0x4408a5;getSocket(_0x502761['id'])[_0x126dcc(0x244)](_0x126dcc(0x260),{'access':{'allow':![],'reason':_0x126dcc(0x334),'token':null}});});}function getSocket(_0xf95e6){const _0x3251e8=_0x1f002e;return io['sockets'][_0x3251e8(0x2f6)][_0x3251e8(0x2e1)](_0xf95e6);}function setAccess(_0x116171){const _0x45a719=_0x1f002e,_0x1512fa=getSocket(_0x116171['id']),_0x58cf0b=_0x116171[_0x45a719(0x2cb)],_0x2e67fc=_0x116171['bot'];devices[_0x58cf0b][_0x45a719(0x227)]=validateAccess(devices[_0x58cf0b]['access'][_0x45a719(0x1e3)],_0x58cf0b),logger['debug'](_0x45a719(0x1fe)+devices[_0x58cf0b][_0x45a719(0x227)][_0x45a719(0x31d)]+_0x45a719(0x37f)+_0x116171['id'][_0x45a719(0x371)](-0x8)+'\x20|\x20user:\x20...'+_0x58cf0b[_0x45a719(0x371)](-0x8)),_0x1512fa[_0x45a719(0x3b6)](_0x58cf0b);if(devices[_0x58cf0b][_0x45a719(0x227)][_0x45a719(0x293)]){_0x1512fa['join'](_0x2e67fc);if(_0x2e67fc=='botmanager')initializeSocketBotManager(_0x1512fa);else initializeSocketBot(_0x1512fa);initClient(_0x2e67fc);}devices[_0x58cf0b][_0x45a719(0x227)][_0x45a719(0x1e3)]&&devices[_0x58cf0b][_0x45a719(0x227)][_0x45a719(0x31d)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x45a719(0x29e),_0x58cf0b),devices[_0x58cf0b]['access'][_0x45a719(0x1e3)]&&devices[_0x58cf0b][_0x45a719(0x227)]['reason']==_0x45a719(0x36d)&&setSessionTimeout(_0x45a719(0x1f6),_0x58cf0b),_0x1512fa[_0x45a719(0x244)](_0x45a719(0x260),{'status':_0x116171['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x58cf0b][_0x45a719(0x227)],'externalip':devices[_0x58cf0b]['ip'],'publicKey':secure[_0x45a719(0x24a)],'userid':settings[_0x45a719(0x239)],'validInstallation':validInstallation}),devices[_0x58cf0b][_0x45a719(0x227)][_0x45a719(0x293)]==![]&&devices[_0x58cf0b][_0x45a719(0x227)]['reason']==_0x45a719(0x1e2)&&temporaryAccess2FA(_0x58cf0b,devices[_0x58cf0b]['ip']);}function setSessionTimeout(_0x10e1a5,_0x53f201){const _0xfdab61=_0x1f002e;let _0x547cda;if(_0x10e1a5==_0xfdab61(0x1f6))_0x547cda=loginExpiry*0x3c*0x3e8;else _0x547cda=devices[_0x53f201][_0xfdab61(0x201)]['expiry']*0x3c*0x3e8-(new Date()[_0xfdab61(0x2e6)]()-devices[_0x53f201]['telegramIpApproval'][_0xfdab61(0x29c)]);if(devices[_0x53f201][_0xfdab61(0x2e2)])clearTimeout(devices[_0x53f201][_0xfdab61(0x2e2)]);devices[_0x53f201]['pidExpireLogin']=setTimeout(()=>{const _0x3a9970=_0xfdab61;if(devices[_0x53f201]['pidRefreshToken'])clearTimeout(devices[_0x53f201][_0x3a9970(0x332)]);removeSocketListeners(_0x53f201),addBlacklist(_0x53f201),devices[_0x53f201][_0x3a9970(0x201)]=null,devices[_0x53f201]['telegram2FaApproval']=null,devices[_0x53f201][_0x3a9970(0x227)]['token']=null,logger[_0x3a9970(0x3c1)](_0x3a9970(0x22c)+_0x53f201[_0x3a9970(0x371)](-0x8)),devices[_0x53f201][_0x3a9970(0x227)]=validateAccess(devices[_0x53f201][_0x3a9970(0x227)][_0x3a9970(0x1e3)],_0x53f201),!(devices[_0x53f201][_0x3a9970(0x227)][_0x3a9970(0x293)]&&devices[_0x53f201]['access'][_0x3a9970(0x31d)]==_0x3a9970(0x2af))&&(_0x10e1a5==_0x3a9970(0x1f6)?io['to'](_0x53f201)[_0x3a9970(0x244)]('status',{'access':{'allow':![],'reason':_0x3a9970(0x288),'token':null}}):io['to'](_0x53f201)[_0x3a9970(0x244)](_0x3a9970(0x260),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x53f201]['access'][_0x3a9970(0x1e3)]=null;},_0x547cda);}function setTokenRefresh(_0x1d8cf7){if(devices[_0x1d8cf7]['pidRefreshToken'])clearTimeout(devices[_0x1d8cf7]['pidRefreshToken']);devices[_0x1d8cf7]['pidRefreshToken']=setTimeout(()=>{const _0x1f3836=_0x1851;getClientsWithUuid(_0x1d8cf7)[_0x1f3836(0x216)]!=0x0?(devices[_0x1d8cf7][_0x1f3836(0x227)]=refreshToken(_0x1d8cf7),io['to'](_0x1d8cf7)[_0x1f3836(0x244)](_0x1f3836(0x260),{'status':_0x1f3836(0x2ed),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1d8cf7][_0x1f3836(0x227)],'externalip':devices[_0x1d8cf7]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x1d8cf7)):clearTimeout(devices[_0x1d8cf7][_0x1f3836(0x332)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2feaf1){const _0x16235b=_0x1f002e,_0x77497d=getClient(_0x2feaf1['id'])['uuid'];_0x2feaf1[_0x16235b(0x244)]('bots',config),_0x2feaf1[_0x16235b(0x244)](_0x16235b(0x320),cleanSettings()),_0x2feaf1['on']('add-bot',_0x5b6045=>{const _0x4c0b84=_0x16235b;if(validateAccess(_0x5b6045,_0x77497d)[_0x4c0b84(0x293)])addBot();else logger['full'](_0x4c0b84(0x3b8));}),_0x2feaf1['on'](_0x16235b(0x225),(_0xba9e0b,_0x3bbca5)=>{const _0x556810=_0x16235b;if(validateAccess(_0x3bbca5,_0x77497d)[_0x556810(0x293)])toggleBot(_0xba9e0b[_0x556810(0x206)],_0xba9e0b[_0x556810(0x260)],_0xba9e0b[_0x556810(0x234)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2feaf1['on'](_0x16235b(0x3b1),(_0x3e7b56,_0x128f6f)=>{const _0x2d83ef=_0x16235b;if(validateAccess(_0x128f6f,_0x77497d)[_0x2d83ef(0x293)])toggleBotMode(_0x3e7b56);else logger[_0x2d83ef(0x23f)](_0x2d83ef(0x2cd));}),_0x2feaf1['on']('delete-bot',(_0x37da95,_0x22d84a)=>{const _0x3e37e1=_0x16235b;if(validateAccess(_0x22d84a,_0x77497d)[_0x3e37e1(0x293)])deleteBot(_0x37da95);else logger[_0x3e37e1(0x23f)](_0x3e37e1(0x35a));}),_0x2feaf1['on']('store-settings',(_0x123eb2,_0x22af62)=>{const _0x4b0f65=_0x16235b;if(validateAccess(_0x22af62,_0x77497d)[_0x4b0f65(0x293)])storeSettings(_0x123eb2,!![]);else logger[_0x4b0f65(0x23f)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2feaf1['on'](_0x16235b(0x26c),_0x2f1f3e=>{const _0x5994db=_0x16235b;if(validateAccess(_0x2f1f3e,_0x77497d)[_0x5994db(0x293)])updateBB(_0x5994db(0x2f7));else logger['full'](_0x5994db(0x2a2));}),_0x2feaf1['on'](_0x16235b(0x2cf),_0x533839=>{const _0x5a73dd=_0x16235b;if(validateAccess(_0x533839,_0x77497d)[_0x5a73dd(0x293)])updateBB(_0x5a73dd(0x31f));else logger[_0x5a73dd(0x23f)](_0x5a73dd(0x2c0));}),_0x2feaf1['on'](_0x16235b(0x317),_0x38ff37=>{const _0x4a5d8f=_0x16235b;if(validateAccess(_0x38ff37,_0x77497d)['allow']){const _0x1e228f=getClient(_0x2feaf1['id']);if(_0x1e228f)getBackupFiles(_0x1e228f[_0x4a5d8f(0x2cb)]);else logger[_0x4a5d8f(0x23f)](_0x4a5d8f(0x272));}else logger[_0x4a5d8f(0x23f)](_0x4a5d8f(0x3b7));}),_0x2feaf1['on'](_0x16235b(0x277),(_0x5430bf,_0x561b39)=>{const _0x2709e0=_0x16235b;if(validateAccess(_0x561b39,_0x77497d)[_0x2709e0(0x293)])restoreBackupFile(_0x5430bf);else logger[_0x2709e0(0x23f)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x2feaf1['on'](_0x16235b(0x1ea),_0x224163=>{const _0xbac33d=_0x16235b;if(validateAccess(_0x224163,_0x77497d)['allow'])getMessages();else logger['full'](_0xbac33d(0x254));}),_0x2feaf1['on'](_0x16235b(0x2a5),(_0x109ddb,_0xe570c)=>{const _0x2578e6=_0x16235b;if(validateAccess(_0xe570c,_0x77497d)[_0x2578e6(0x293)])confirmMessage(_0x109ddb);else logger[_0x2578e6(0x23f)](_0x2578e6(0x336));}),_0x2feaf1['on'](_0x16235b(0x2e3),_0x27c7bb=>{const _0x14824a=_0x16235b;if(validateAccess(_0x27c7bb,_0x77497d)[_0x14824a(0x293)]){if(devices[_0x77497d][_0x14824a(0x332)])clearTimeout(devices[_0x77497d][_0x14824a(0x332)]);if(devices[_0x77497d]['pidExpireLogin'])clearTimeout(devices[_0x77497d][_0x14824a(0x2e2)]);removeSocketListeners(getClient(_0x2feaf1['id'])['uuid']),addBlacklist(_0x77497d),devices[_0x77497d][_0x14824a(0x201)]=null,devices[_0x77497d][_0x14824a(0x314)]=null,devices[_0x77497d][_0x14824a(0x227)]['token']=null,logger['debug'](_0x14824a(0x3bd)+_0x77497d['slice'](-0x8)),io['to'](getClient(_0x2feaf1['id'])['uuid'])[_0x14824a(0x244)]('status',{'access':{'allow':![],'reason':_0x14824a(0x2dc),'token':null}});}else logger['full'](_0x14824a(0x2c7));});}function initializeSocketBot(_0x45c8c3){const _0x467426=_0x1f002e,_0xa81b2d=getClient(_0x45c8c3['id'])[_0x467426(0x2a4)],_0xe246a=getClient(_0x45c8c3['id'])['uuid'];_0x45c8c3['on'](_0x467426(0x212),(_0xf7a4d1,_0x172a7a)=>{const _0x4e12dd=_0x467426;if(validateAccess(_0x172a7a,_0xe246a)[_0x4e12dd(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d]['send']({'function':_0x4e12dd(0x257),'args':_0xf7a4d1});}else logger[_0x4e12dd(0x23f)](_0x4e12dd(0x279));}),_0x45c8c3['on']('delete-alerts',(_0x48f808,_0x4a36ce)=>{const _0x1c47a8=_0x467426;if(validateAccess(_0x4a36ce,_0xe246a)['allow']){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x1c47a8(0x31a)]({'function':_0x1c47a8(0x2c5),'args':_0x48f808});}else logger[_0x1c47a8(0x23f)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x45c8c3['on'](_0x467426(0x378),(_0x49671f,_0x398d16)=>{const _0x1cd88b=_0x467426;if(validateAccess(_0x398d16,_0xe246a)[_0x1cd88b(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x1cd88b(0x31a)]({'function':_0x1cd88b(0x2eb),'args':_0x49671f});}else logger[_0x1cd88b(0x23f)](_0x1cd88b(0x207));}),_0x45c8c3['on'](_0x467426(0x3a5),(_0x4c01bb,_0x264746)=>{const _0x311eca=_0x467426;if(validateAccess(_0x264746,_0xe246a)[_0x311eca(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x311eca(0x31a)]({'function':'storeConfiguration','args':_0x4c01bb});}else logger[_0x311eca(0x23f)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x45c8c3['on'](_0x467426(0x361),(_0xf2e6ba,_0x41a9e8)=>{const _0x5a72bb=_0x467426;if(validateAccess(_0x41a9e8,_0xe246a)['allow']){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x5a72bb(0x31a)]({'function':_0x5a72bb(0x3c6),'args':_0xf2e6ba});}else logger[_0x5a72bb(0x23f)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x45c8c3['on'](_0x467426(0x380),(_0x4f0508,_0x8ad08)=>{const _0x45cb78=_0x467426;if(validateAccess(_0x8ad08,_0xe246a)[_0x45cb78(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x45cb78(0x31a)]({'function':_0x45cb78(0x2c3),'args':_0x4f0508});}else logger[_0x45cb78(0x23f)](_0x45cb78(0x2b5));}),_0x45c8c3['on'](_0x467426(0x323),_0x2cd212=>{const _0xc94686=_0x467426;if(validateAccess(_0x2cd212,_0xe246a)[_0xc94686(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d][_0xc94686(0x31a)]({'function':_0xc94686(0x20f),'args':null});}else logger[_0xc94686(0x23f)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x45c8c3['on']('get-starting-balances',_0x1ac19d=>{const _0x24e69c=_0x467426;if(validateAccess(_0x1ac19d,_0xe246a)[_0x24e69c(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d]['send']({'function':_0x24e69c(0x37d),'args':null});}else logger['full'](_0x24e69c(0x25f));}),_0x45c8c3['on'](_0x467426(0x393),(_0x57707f,_0x1b9d9f)=>{const _0x4f2e1e=_0x467426;if(validateAccess(_0x1b9d9f,_0xe246a)['allow']){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x4f2e1e(0x31a)]({'function':_0x4f2e1e(0x326),'args':_0x57707f});}else logger[_0x4f2e1e(0x23f)](_0x4f2e1e(0x268));}),_0x45c8c3['on']('cancel-loading',_0x1abbc2=>{const _0x5df606=_0x467426;if(validateAccess(_0x1abbc2,_0xe246a)[_0x5df606(0x293)]){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x5df606(0x31a)]({'function':'cancelLoading','args':null});}else logger[_0x5df606(0x23f)](_0x5df606(0x308));}),_0x45c8c3['on'](_0x467426(0x329),_0x1434e5=>{const _0x348834=_0x467426;if(validateAccess(_0x1434e5,_0xe246a)['allow']){if(pid[_0xa81b2d])pid[_0xa81b2d][_0x348834(0x31a)]({'function':_0x348834(0x26e),'args':null});}else logger[_0x348834(0x23f)](_0x348834(0x2df));}),_0x45c8c3['on'](_0x467426(0x26c),_0x2da906=>{const _0xb69bf7=_0x467426;if(validateAccess(_0x2da906,_0xe246a)[_0xb69bf7(0x293)])updateBB(_0xb69bf7(0x2f7));else logger['full'](_0xb69bf7(0x2a2));}),_0x45c8c3['on']('get-messages',_0x26a636=>{const _0x30164e=_0x467426;if(validateAccess(_0x26a636,_0xe246a)[_0x30164e(0x293)])getMessages();else logger[_0x30164e(0x23f)](_0x30164e(0x254));}),_0x45c8c3['on']('confirm-message',(_0xaf487b,_0x378ce4)=>{const _0x122840=_0x467426;if(validateAccess(_0x378ce4,_0xe246a)[_0x122840(0x293)])confirmMessage(_0xaf487b);else logger[_0x122840(0x23f)](_0x122840(0x336));}),_0x45c8c3['on'](_0x467426(0x2e3),_0x539c83=>{const _0x4df56b=_0x467426;if(validateAccess(_0x539c83,_0xe246a)['allow']){if(devices[_0xe246a][_0x4df56b(0x332)])clearTimeout(devices[_0xe246a][_0x4df56b(0x332)]);if(devices[_0xe246a][_0x4df56b(0x2e2)])clearTimeout(devices[_0xe246a]['pidExpireLogin']);removeSocketListeners(getClient(_0x45c8c3['id'])[_0x4df56b(0x2cb)]),addBlacklist(_0xe246a),devices[_0xe246a]['telegramIpApproval']=null,devices[_0xe246a]['telegram2FaApproval']=null,devices[_0xe246a][_0x4df56b(0x227)]['token']=null,logger[_0x4df56b(0x3c1)]('Logged\x20out\x20user\x20...'+_0xe246a['slice'](-0x8)),io['to'](getClient(_0x45c8c3['id'])[_0x4df56b(0x2cb)])[_0x4df56b(0x244)](_0x4df56b(0x260),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x4df56b(0x2c7));});}function removeSocketListeners(_0x5a2490){getClientsWithUuid(_0x5a2490)['forEach'](_0x1b77ec=>{getSocket(_0x1b77ec['id'])['removeAllListeners']();});}function cleanSettings(){const _0x4c5695=_0x1f002e;let _0x3178d3=settings;return settings['telegramToken']&&settings[_0x4c5695(0x2fd)]!=''&&(_0x3178d3={..._0x3178d3,'telegramToken':_0x4c5695(0x296)}),settings[_0x4c5695(0x230)]&&settings['bbPassword']!=''&&(_0x3178d3={..._0x3178d3,'bbPassword':_0x4c5695(0x296)}),(settings[_0x4c5695(0x230)]&&settings[_0x4c5695(0x230)]==_0x4c5695(0x291)||settings['telegramToken']&&settings[_0x4c5695(0x2fd)]==_0x4c5695(0x291))&&(_0x3178d3={..._0x3178d3,'restored':{'password':settings[_0x4c5695(0x230)]==_0x4c5695(0x291),'telegram':settings['telegramToken']==_0x4c5695(0x291)}}),_0x3178d3;}async function updateBB(_0x36d38e){const _0x12c481=_0x1f002e;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x44cecd=>{restartBot(_0x44cecd['botID']);});if(_0x36d38e==_0x12c481(0x2f7))process['send']({'update':!![],'environment':environment},_0x25716e=>{});else _0x36d38e==_0x12c481(0x31f)&&process[_0x12c481(0x31a)]({'reinstall':!![],'environment':environment},_0x3a3f=>{});}function startBot(_0x1968c8,_0x1fc8c6,_0x310966){const _0x4c44d0=_0x1f002e;if(debugging)_0x1968c8['push']('-d');let _0x274fb3=![];const _0x1becd1=_0x1968c8[0x0];_0x1fc8c6={..._0x1fc8c6,'stdio':[_0x4c44d0(0x3a2),_0x4c44d0(0x3a2),_0x4c44d0(0x3a2),_0x4c44d0(0x302)]},pid[_0x1becd1]=childProcess[_0x4c44d0(0x2fc)](botfile,_0x1968c8,_0x1fc8c6),pid[_0x1becd1]['on']('message',_0x749473=>{const _0x3a0307=_0x4c44d0;switch(Object[_0x3a0307(0x297)](_0x749473)[0x0]){case _0x3a0307(0x27e):updateBotName(_0x1becd1,_0x749473['botname']);break;case _0x3a0307(0x263):updateBotManager();break;case'status':updateStatus(_0x1becd1,_0x749473[_0x3a0307(0x260)]);break;case _0x3a0307(0x234):updateLive(_0x1becd1,_0x749473[_0x3a0307(0x234)]);break;case _0x3a0307(0x2c2):updateLive(_0x1becd1,_0x749473[_0x3a0307(0x2c2)]),io['to'](_0x1becd1)['emit'](_0x3a0307(0x260),{'access':{'allow':![],'reason':_0x3a0307(0x334),'token':null}});break;case _0x3a0307(0x360):_0x749473[_0x3a0307(0x360)]==_0x3a0307(0x35f)&&restartBot(_0x1becd1);_0x749473[_0x3a0307(0x360)]==_0x3a0307(0x3ad)&&toggleBot(_0x1becd1,_0x3a0307(0x205),_0x3a0307(0x26f));break;case _0x3a0307(0x365):sendTelegram(_0x1becd1,_0x749473['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x749473[_0x3a0307(0x298)]);break;case _0x3a0307(0x2a1):io['to'](_0x1becd1)['emit'](_0x749473[_0x3a0307(0x2a1)],_0x749473['args']);break;}}),pid[_0x1becd1]['on'](_0x4c44d0(0x2d6),function(_0x424492){if(_0x274fb3)return;_0x274fb3=!![],_0x310966(_0x424492);}),pid[_0x1becd1]['on'](_0x4c44d0(0x262),async function(_0x4aa290){const _0x378104=_0x4c44d0;if(installingUpdate)return;if(_0x274fb3)return;_0x274fb3=!![],_0x310966(null);const _0x3c20f1=dbConfig[_0x378104(0x2e1)]('bots')[_0x378104(0x2ae)]({'botID':_0x1becd1})[_0x378104(0x22b)]();_0x3c20f1&&(_0x3c20f1[_0x378104(0x260)]=='enabled'||_0x3c20f1['status']==_0x378104(0x27d))&&(await sleep(0x3e8),updateLive(_0x1becd1,'stopped'),logger[_0x378104(0x23f)](_0x378104(0x367)+_0x1becd1),startBot([_0x1becd1,userID],{'cwd':bbpath},function(_0x2bff2b){if(_0x2bff2b)logger['full'](_0x2bff2b);}));});}function stopBot(_0x8c9450){const _0x3267a4=_0x1f002e;getClientsWithBotID(_0x8c9450)[_0x3267a4(0x1e8)](_0x1dc5b2=>{const _0xa242fc=_0x3267a4;getSocket(_0x1dc5b2['id'])[_0xa242fc(0x26a)](!![]),removeClient(_0x1dc5b2['id']);}),pid[_0x8c9450]&&(pid[_0x8c9450][_0x3267a4(0x3ad)](),pid[_0x8c9450]=null);}function restartBot(_0x4e69ea){const _0x29b195=_0x1f002e;if(pid[_0x4e69ea])pid[_0x4e69ea][_0x29b195(0x3ad)]();}function addBot(){const _0x13a70f=_0x1f002e;let _0x474c56;for(let _0x31ef12=0x1;_0x31ef12<0x3e9;_0x31ef12++){_0x474c56=_0x31ef12['toString']()[_0x13a70f(0x32b)](0x3,'0');let _0x3f1a2f=config[_0x13a70f(0x2ae)](_0xf4110e=>_0xf4110e[_0x13a70f(0x206)]==_0x474c56);if(!_0x3f1a2f)break;}if(_0x474c56===_0x13a70f(0x203)){logger['full'](_0x13a70f(0x374));return;}logger[_0x13a70f(0x23f)](_0x13a70f(0x32a)+_0x474c56),dbConfig[_0x13a70f(0x2e1)](_0x13a70f(0x340))['push']({'botID':_0x474c56,'botname':_0x13a70f(0x264)+_0x474c56,'status':_0x13a70f(0x27d),'live':''})['write'](),startBot([_0x474c56,userID],{'cwd':bbpath},function(_0xe0de70){const _0x424763=_0x13a70f;if(_0xe0de70)logger[_0x424763(0x23f)](_0xe0de70);}),config=getConfiguration(),io['to'](_0x13a70f(0x245))[_0x13a70f(0x244)](_0x13a70f(0x340),config),broadcastToBots(_0x13a70f(0x340),JSON[_0x13a70f(0x31e)](config));}function deleteBot(_0x1a22f1){const _0x24f91f=_0x1f002e;getClientsWithBotID(_0x1a22f1)['forEach'](_0x21053e=>{const _0x4f84b6=_0x1851;getSocket(_0x21053e['id'])[_0x4f84b6(0x26a)](!![]),removeClient(_0x21053e['id']);}),dbConfig[_0x24f91f(0x2e1)](_0x24f91f(0x340))['remove']({'botID':_0x1a22f1})[_0x24f91f(0x399)](),logger[_0x24f91f(0x23f)](_0x24f91f(0x20a)+_0x1a22f1),stopBot(_0x1a22f1);try{if(fs['existsSync'](path[_0x24f91f(0x3b6)](configpath,_0x24f91f(0x25d)+_0x1a22f1+'-config.json')))fs[_0x24f91f(0x33d)](path['join'](configpath,_0x24f91f(0x25d)+_0x1a22f1+_0x24f91f(0x23a)));if(fs[_0x24f91f(0x266)](path[_0x24f91f(0x3b6)](configpath,_0x24f91f(0x25d)+_0x1a22f1+_0x24f91f(0x258))))fs['unlinkSync'](path[_0x24f91f(0x3b6)](configpath,'bot-'+_0x1a22f1+_0x24f91f(0x258)));if(fs['existsSync'](path[_0x24f91f(0x3b6)](configpath,_0x24f91f(0x25d)+_0x1a22f1+_0x24f91f(0x231))))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x1a22f1+_0x24f91f(0x231)));if(fs[_0x24f91f(0x266)](path[_0x24f91f(0x3b6)](configpath,_0x24f91f(0x25d)+_0x1a22f1+_0x24f91f(0x24c))))fs[_0x24f91f(0x33d)](path['join'](configpath,'bot-'+_0x1a22f1+_0x24f91f(0x24c)));}catch(_0x283ef4){if(_0x283ef4)logger['full'](_0x24f91f(0x1eb),_0x283ef4);}config=getConfiguration(),io['to'](_0x24f91f(0x245))[_0x24f91f(0x244)](_0x24f91f(0x340),config),broadcastToBots(_0x24f91f(0x340),JSON[_0x24f91f(0x31e)](config));}function toggleBot(_0x470b9d,_0x1f0ec2,_0x353fa5){const _0x3c1ed9=_0x1f002e;dbConfig['get'](_0x3c1ed9(0x340))[_0x3c1ed9(0x2ae)]({'botID':_0x470b9d})[_0x3c1ed9(0x30d)]({'status':_0x1f0ec2})[_0x3c1ed9(0x30d)]({'live':_0x353fa5})['write']();if(_0x1f0ec2==_0x3c1ed9(0x345)||_0x1f0ec2==_0x3c1ed9(0x27d))logger[_0x3c1ed9(0x23f)]('Enabled\x20Bot\x20'+_0x470b9d),startBot([_0x470b9d,userID],{'cwd':bbpath},function(_0x164186){const _0x392bfc=_0x3c1ed9;if(_0x164186)logger[_0x392bfc(0x23f)](_0x164186);});else(_0x1f0ec2=='disabled'||_0x1f0ec2==_0x3c1ed9(0x1ee))&&(logger['full'](_0x3c1ed9(0x252)+_0x470b9d),stopBot(_0x470b9d));config=getConfiguration(),io['to'](_0x3c1ed9(0x245))[_0x3c1ed9(0x244)]('bots',config),broadcastToBots(_0x3c1ed9(0x340),JSON[_0x3c1ed9(0x31e)](config));}function toggleStatus(_0xe018c4){const _0x130d6d=_0x1f002e;let _0x5c1f52=dbConfig['get'](_0x130d6d(0x340))[_0x130d6d(0x2ae)]({'botID':_0xe018c4})[_0x130d6d(0x22b)](),_0x2de761;if(_0x5c1f52[_0x130d6d(0x260)]===_0x130d6d(0x345))_0x2de761=_0x130d6d(0x205);else{if(_0x5c1f52[_0x130d6d(0x260)]==='new')_0x2de761=_0x130d6d(0x1ee);else{if(_0x5c1f52[_0x130d6d(0x260)]===_0x130d6d(0x1ee))_0x2de761='new';else{if(_0x5c1f52[_0x130d6d(0x260)]===_0x130d6d(0x205))_0x2de761=_0x130d6d(0x345);}}}return _0x2de761;}function updateStatus(_0x57b230,_0x1b5a8f){const _0x21724f=_0x1f002e;dbConfig[_0x21724f(0x2e1)](_0x21724f(0x340))[_0x21724f(0x2ae)]({'botID':_0x57b230})[_0x21724f(0x30d)]({'status':_0x1b5a8f})['write'](),config=getConfiguration(),io['to'](_0x21724f(0x245))[_0x21724f(0x244)](_0x21724f(0x340),config),broadcastToBots(_0x21724f(0x340),JSON[_0x21724f(0x31e)](config));}function updateLive(_0x21c2a5,_0x11290){const _0x590850=_0x1f002e;dbConfig[_0x590850(0x2e1)](_0x590850(0x340))[_0x590850(0x2ae)]({'botID':_0x21c2a5})[_0x590850(0x30d)]({'live':_0x11290})[_0x590850(0x399)](),config=getConfiguration(),io['to'](_0x590850(0x245))['emit']('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x1ece08,_0x402109){const _0x22a1d9=_0x1f002e;dbConfig[_0x22a1d9(0x2e1)](_0x22a1d9(0x340))['find']({'botID':_0x1ece08})[_0x22a1d9(0x30d)]({'botname':_0x402109})[_0x22a1d9(0x399)](),config=getConfiguration(),io['to'](_0x22a1d9(0x245))[_0x22a1d9(0x244)](_0x22a1d9(0x340),config),broadcastToBots(_0x22a1d9(0x340),JSON['stringify'](config));}function updateBotManager(){const _0x42b3ac=_0x1f002e;config=getConfiguration(),io['to'](_0x42b3ac(0x245))[_0x42b3ac(0x244)](_0x42b3ac(0x340),config),broadcastToBots(_0x42b3ac(0x340),JSON['stringify'](config));}function toggleBotMode(_0x22f8c9){const _0x582ed2=_0x1f002e;if(pid[_0x22f8c9])pid[_0x22f8c9]['send']({'function':_0x582ed2(0x395),'args':null});else{const _0x1ce5eb=configpath+_0x582ed2(0x25d)+_0x22f8c9+_0x582ed2(0x23a),_0x56287a=fs[_0x582ed2(0x32c)](_0x1ce5eb),_0x58d8d6=JSON['parse'](_0x56287a),_0x8740ec=_0x58d8d6[_0x582ed2(0x2a4)][0x0][_0x582ed2(0x292)];_0x58d8d6[_0x582ed2(0x2a4)][0x0]['headless']=!_0x8740ec;const _0x42d294=JSON[_0x582ed2(0x31e)](_0x58d8d6,null,0x2);fs[_0x582ed2(0x30a)](_0x1ce5eb,_0x42d294),config=getConfiguration(),io['to'](_0x582ed2(0x245))[_0x582ed2(0x244)](_0x582ed2(0x340),config),broadcastToBots(_0x582ed2(0x340),JSON[_0x582ed2(0x31e)](config));}}function telegramError(_0xa026a4){const _0x4b5d21=_0x1f002e;logger['simple'](getTimeStamp()+_0x4b5d21(0x2a3));}function validateTelegram(_0x2ac281){const _0x96d6b4=_0x1f002e;if(_0x2ac281[_0x96d6b4(0x347)][_0x96d6b4(0x34f)]!=settings['telegramUsername']&&'@'+_0x2ac281[_0x96d6b4(0x347)][_0x96d6b4(0x34f)]!=settings['telegramUsername'])return tgBot[_0x96d6b4(0x21e)](_0x2ac281[_0x96d6b4(0x25e)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x96d6b4(0x363)](_0xb4f38a=>{telegramError(_0xb4f38a);}),![];return!![];}async function initTelegram(){const _0x412c30=_0x1f002e;if(tgBot)tgBot[_0x412c30(0x1f9)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3578e0=_0x412c30(0x313);_0x3578e0+='\x0a',_0x3578e0+=_0x412c30(0x30e),_0x3578e0+=_0x412c30(0x1f3),_0x3578e0+=_0x412c30(0x3aa),_0x3578e0+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3578e0+=_0x412c30(0x358),_0x3578e0+=_0x412c30(0x2f1),_0x3578e0+=_0x412c30(0x2d7),_0x3578e0+=_0x412c30(0x328),_0x3578e0+=_0x412c30(0x2ea),_0x3578e0+=_0x412c30(0x3a8),_0x3578e0+=_0x412c30(0x2d4),_0x3578e0+=_0x412c30(0x284),_0x3578e0+=_0x412c30(0x259),_0x3578e0+=_0x412c30(0x286);let _0x5d59b3=_0x412c30(0x27c);_0x5d59b3+='\x0a',_0x5d59b3+=_0x3578e0,tgBot[_0x412c30(0x2ba)](/\/start/,_0xa666e8=>{const _0x3defa8=_0x412c30;if(!validateTelegram(_0xa666e8))return;if(settings[_0x3defa8(0x321)]!=_0xa666e8[_0x3defa8(0x25e)]['id'])updateSetting(_0x3defa8(0x321),_0xa666e8[_0x3defa8(0x25e)]['id']);updateSetting(_0x3defa8(0x25b),!![]),tgBot[_0x3defa8(0x21e)](_0xa666e8[_0x3defa8(0x25e)]['id'],_0x5d59b3)['catch'](_0x4530eb=>{telegramError(_0x4530eb);});}),tgBot['onText'](/\/enable/,_0x4780d5=>{const _0x27b695=_0x412c30;if(!validateTelegram(_0x4780d5))return;if(settings[_0x27b695(0x321)]!=_0x4780d5[_0x27b695(0x25e)]['id'])updateSetting(_0x27b695(0x321),_0x4780d5[_0x27b695(0x25e)]['id']);updateSetting(_0x27b695(0x25b),!![]),tgBot[_0x27b695(0x21e)](_0x4780d5[_0x27b695(0x25e)]['id'],_0x27b695(0x1dd))[_0x27b695(0x363)](_0x514cc5=>{telegramError(_0x514cc5);});}),tgBot['onText'](/\/config/,async _0x2ee076=>{const _0x7d5bec=_0x412c30;if(!validateTelegram(_0x2ee076))return;tgBot[_0x7d5bec(0x343)]('callback_query'),tgBot[_0x7d5bec(0x21e)](_0x2ee076[_0x7d5bec(0x25e)]['id'],_0x7d5bec(0x37e),{'reply_markup':{'inline_keyboard':[[{'text':_0x7d5bec(0x38e),'callback_data':_0x7d5bec(0x21a)},{'text':'Alerts','callback_data':_0x7d5bec(0x233)},{'text':_0x7d5bec(0x36e),'callback_data':_0x7d5bec(0x34c)}]]}})[_0x7d5bec(0x363)](_0x57a3e3=>{telegramError(_0x57a3e3);}),tgBot['on']('callback_query',async _0x1130f4=>{const _0x32eb05=_0x7d5bec,_0x46faba=_0x1130f4[_0x32eb05(0x237)],_0x57b9b9=_0x1130f4['message'];tgBot['answerCallbackQuery'](_0x1130f4['id'])['then'](async()=>{const _0x52752b=_0x32eb05;_0x46faba=='orders'&&(updateSetting(_0x52752b(0x27a),_0x52752b(0x21a)),updateSetting(_0x52752b(0x25b),!![]),await tgBot['sendMessage'](_0x57b9b9[_0x52752b(0x25e)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x52752b(0x363)](_0x43f79e=>{telegramError(_0x43f79e);}));_0x46faba==_0x52752b(0x233)&&(updateSetting('telegramEvents',_0x52752b(0x233)),updateSetting(_0x52752b(0x25b),!![]),await tgBot[_0x52752b(0x21e)](_0x57b9b9[_0x52752b(0x25e)]['id'],_0x52752b(0x318))[_0x52752b(0x363)](_0xa1814c=>{telegramError(_0xa1814c);}));_0x46faba=='all'&&(updateSetting('telegramEvents',_0x52752b(0x34c)),updateSetting(_0x52752b(0x25b),!![]),await tgBot[_0x52752b(0x21e)](_0x57b9b9[_0x52752b(0x25e)]['id'],_0x52752b(0x32e))[_0x52752b(0x363)](_0x25912c=>{telegramError(_0x25912c);}));if(!settings[_0x52752b(0x321)])tgBot[_0x52752b(0x21e)](_0x57b9b9[_0x52752b(0x25e)]['id'],_0x52752b(0x1fa))[_0x52752b(0x363)](_0xb7b63f=>{telegramError(_0xb7b63f);});}),tgBot[_0x32eb05(0x343)]('callback_query');});}),tgBot[_0x412c30(0x2ba)](/\/status/,_0x1080a7=>{const _0x4babcb=_0x412c30;if(!validateTelegram(_0x1080a7))return;const _0x5ea91d=getBotsWithMode();let _0x1768d9=_0x4babcb(0x249);config['forEach'](_0x392b23=>{const _0x1b7bfe=_0x4babcb,_0x53ef79=_0x5ea91d[_0x1b7bfe(0x2ae)](_0x55636d=>_0x55636d['botID']==_0x392b23[_0x1b7bfe(0x206)])[_0x1b7bfe(0x366)];_0x1768d9+='Bot\x20'+_0x392b23[_0x1b7bfe(0x206)]+':\x20'+_0x392b23[_0x1b7bfe(0x260)]+'\x20|\x20'+_0x53ef79+'\x20|\x20'+_0x392b23[_0x1b7bfe(0x234)]+'\x0a';}),_0x1768d9+='\x0a',_0x1768d9+=_0x4babcb(0x1fd),_0x1768d9+=!settings[_0x4babcb(0x25b)]?_0x4babcb(0x238):_0x4babcb(0x2ca),_0x1768d9+=settings[_0x4babcb(0x25b)]?settings[_0x4babcb(0x27a)]==_0x4babcb(0x34c)?_0x4babcb(0x27f):_0x4babcb(0x287)+settings[_0x4babcb(0x27a)]+_0x4babcb(0x271):'',tgBot[_0x4babcb(0x21e)](_0x1080a7['chat']['id'],_0x1768d9,{'parse_mode':'HTML'})[_0x4babcb(0x363)](_0x6f7693=>{telegramError(_0x6f7693);});}),tgBot['onText'](/\/restart/,_0x4a2552=>{const _0x1dd103=_0x412c30;if(!validateTelegram(_0x4a2552))return;tgBot[_0x1dd103(0x343)](_0x1dd103(0x3a3));const _0xf61e19=getEnabledBots();if(_0xf61e19[_0x1dd103(0x216)]==0x0)tgBot[_0x1dd103(0x21e)](_0x4a2552['chat']['id'],_0x1dd103(0x2ff))['catch'](_0x33c509=>{telegramError(_0x33c509);});else{if(_0xf61e19[_0x1dd103(0x216)]>0x1)_0xf61e19[_0x1dd103(0x2f3)]({'botID':'all'});let _0x432149=[],_0x3b3982=[];const _0x49d48f=_0xf61e19['length']%0x4==0x0||_0xf61e19[_0x1dd103(0x216)]%0x4==0x3||_0xf61e19[_0x1dd103(0x216)]%0x3==0x1?0x4:0x3;let _0x15cb70=0x0;_0xf61e19[_0x1dd103(0x1e8)]((_0x5d9e73,_0x130d31)=>{const _0x50ce67=_0x1dd103;if(_0x130d31%_0x49d48f==0x0)_0x3b3982=[];_0x3b3982[_0x50ce67(0x2f3)]({'text':_0x5d9e73[_0x50ce67(0x206)]==_0x50ce67(0x34c)?_0x50ce67(0x3b2):_0x50ce67(0x264)+_0x5d9e73[_0x50ce67(0x206)],'callback_data':_0x5d9e73[_0x50ce67(0x206)]}),_0x130d31%_0x49d48f==0x0&&(_0x432149[_0x15cb70]=_0x3b3982,_0x15cb70++);}),tgBot[_0x1dd103(0x21e)](_0x4a2552['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x432149}})[_0x1dd103(0x363)](_0x13c704=>{telegramError(_0x13c704);}),tgBot['on'](_0x1dd103(0x3a3),async _0x1d976b=>{const _0x204fa3=_0x1dd103,_0x48d136=_0x1d976b[_0x204fa3(0x237)],_0x1580ad=_0x1d976b[_0x204fa3(0x35b)];tgBot[_0x204fa3(0x2d8)](_0x1d976b['id'])[_0x204fa3(0x387)](async()=>{const _0x445778=_0x204fa3;_0x48d136==_0x445778(0x34c)?config['forEach'](_0x13e9a4=>{const _0x39c543=_0x445778;restartBot(_0x13e9a4[_0x39c543(0x206)]);}):restartBot(_0x48d136);}),tgBot[_0x204fa3(0x343)](_0x204fa3(0x3a3));});}}),tgBot['onText'](/\/on/,_0xf90ff2=>{const _0x2f3167=_0x412c30;if(!validateTelegram(_0xf90ff2))return;tgBot[_0x2f3167(0x343)](_0x2f3167(0x3a3));const _0x4f30d2=getDisabledBots();if(_0x4f30d2['length']==0x0)tgBot[_0x2f3167(0x21e)](_0xf90ff2['chat']['id'],_0x2f3167(0x2fe))[_0x2f3167(0x363)](_0x1c8bd9=>{telegramError(_0x1c8bd9);});else{if(_0x4f30d2[_0x2f3167(0x216)]>0x1)_0x4f30d2[_0x2f3167(0x2f3)]({'botID':_0x2f3167(0x34c)});let _0x53bb37=[],_0x4fe672=[];const _0x34b824=_0x4f30d2[_0x2f3167(0x216)]%0x4==0x0||_0x4f30d2[_0x2f3167(0x216)]%0x4==0x3||_0x4f30d2[_0x2f3167(0x216)]%0x3==0x1?0x4:0x3;let _0x345aaf=0x0;_0x4f30d2[_0x2f3167(0x1e8)]((_0x1c2952,_0x4bf68d)=>{const _0x150e16=_0x2f3167;if(_0x4bf68d%_0x34b824==0x0)_0x4fe672=[];_0x4fe672['push']({'text':_0x1c2952[_0x150e16(0x206)]==_0x150e16(0x34c)?'All\x20bots':_0x150e16(0x264)+_0x1c2952[_0x150e16(0x206)],'callback_data':_0x1c2952[_0x150e16(0x206)]}),_0x4bf68d%_0x34b824==0x0&&(_0x53bb37[_0x345aaf]=_0x4fe672,_0x345aaf++);}),tgBot['sendMessage'](_0xf90ff2['chat']['id'],_0x2f3167(0x2aa),{'reply_markup':{'inline_keyboard':_0x53bb37}})[_0x2f3167(0x363)](_0x2fe2de=>{telegramError(_0x2fe2de);}),tgBot['on'](_0x2f3167(0x3a3),async _0x5491a7=>{const _0x540d15=_0x2f3167,_0x7ede86=_0x5491a7[_0x540d15(0x237)],_0x52a0a4=_0x5491a7['message'];tgBot[_0x540d15(0x2d8)](_0x5491a7['id'])[_0x540d15(0x387)](async()=>{const _0x37a18e=_0x540d15;_0x7ede86==_0x37a18e(0x34c)?(tgBot[_0x37a18e(0x21e)](_0x52a0a4[_0x37a18e(0x25e)]['id'],_0x37a18e(0x28d))['catch'](_0x182e64=>{telegramError(_0x182e64);}),_0x4f30d2['forEach'](_0x3e905a=>{const _0x2d3b4c=_0x37a18e;if(_0x3e905a[_0x2d3b4c(0x206)]!=_0x2d3b4c(0x34c))toggleBot(_0x3e905a['botID'],toggleStatus(_0x3e905a[_0x2d3b4c(0x206)]),'stopped');})):(tgBot[_0x37a18e(0x21e)](_0x52a0a4[_0x37a18e(0x25e)]['id'],_0x37a18e(0x38a)+_0x7ede86)[_0x37a18e(0x363)](_0x35d614=>{telegramError(_0x35d614);}),toggleBot(_0x7ede86,toggleStatus(_0x7ede86),_0x37a18e(0x26f)));}),tgBot['removeListener'](_0x540d15(0x3a3));});}}),tgBot[_0x412c30(0x2ba)](/\/off/,_0x287876=>{const _0x1a0a1c=_0x412c30;if(!validateTelegram(_0x287876))return;tgBot[_0x1a0a1c(0x343)]('callback_query');const _0x437cd8=getEnabledBots();if(_0x437cd8[_0x1a0a1c(0x216)]==0x0)tgBot['sendMessage'](_0x287876['chat']['id'],_0x1a0a1c(0x2ff))[_0x1a0a1c(0x363)](_0x1fcb50=>{telegramError(_0x1fcb50);});else{if(_0x437cd8[_0x1a0a1c(0x216)]>0x1)_0x437cd8['push']({'botID':_0x1a0a1c(0x34c)});let _0x5884ff=[],_0x3550cc=[];const _0x3ae7fb=_0x437cd8[_0x1a0a1c(0x216)]%0x4==0x0||_0x437cd8['length']%0x4==0x3||_0x437cd8[_0x1a0a1c(0x216)]%0x3==0x1?0x4:0x3;let _0x3a910c=0x0;_0x437cd8[_0x1a0a1c(0x1e8)]((_0x3553e6,_0x1b198a)=>{const _0x11c0cd=_0x1a0a1c;if(_0x1b198a%_0x3ae7fb==0x0)_0x3550cc=[];_0x3550cc[_0x11c0cd(0x2f3)]({'text':_0x3553e6[_0x11c0cd(0x206)]==_0x11c0cd(0x34c)?_0x11c0cd(0x3b2):_0x11c0cd(0x264)+_0x3553e6['botID'],'callback_data':_0x3553e6[_0x11c0cd(0x206)]}),_0x1b198a%_0x3ae7fb==0x0&&(_0x5884ff[_0x3a910c]=_0x3550cc,_0x3a910c++);}),tgBot['sendMessage'](_0x287876['chat']['id'],_0x1a0a1c(0x20b),{'reply_markup':{'inline_keyboard':_0x5884ff}})[_0x1a0a1c(0x363)](_0x5ce6d1=>{telegramError(_0x5ce6d1);}),tgBot['on'](_0x1a0a1c(0x3a3),async _0x45d034=>{const _0x243dfe=_0x1a0a1c,_0x160ef9=_0x45d034[_0x243dfe(0x237)],_0x29113e=_0x45d034['message'];tgBot['answerCallbackQuery'](_0x45d034['id'])[_0x243dfe(0x387)](async()=>{const _0x477790=_0x243dfe;_0x160ef9==_0x477790(0x34c)?(tgBot[_0x477790(0x21e)](_0x29113e[_0x477790(0x25e)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x612a5a=>{telegramError(_0x612a5a);}),_0x437cd8[_0x477790(0x1e8)](_0x58e33d=>{const _0x4fc0ec=_0x477790;if(_0x58e33d[_0x4fc0ec(0x206)]!=_0x4fc0ec(0x34c))toggleBot(_0x58e33d[_0x4fc0ec(0x206)],toggleStatus(_0x58e33d['botID']),_0x4fc0ec(0x26f));})):(tgBot[_0x477790(0x21e)](_0x29113e[_0x477790(0x25e)]['id'],_0x477790(0x3c4)+_0x160ef9)[_0x477790(0x363)](_0x15b5c5=>{telegramError(_0x15b5c5);}),toggleBot(_0x160ef9,toggleStatus(_0x160ef9),_0x477790(0x26f)));}),tgBot[_0x243dfe(0x343)]('callback_query');});}}),tgBot['onText'](/\/metrics/,_0x2452ea=>{const _0xd1c9d1=_0x412c30;if(!validateTelegram(_0x2452ea))return;tgBot[_0xd1c9d1(0x343)](_0xd1c9d1(0x3a3));const _0x29a9de=getEnabledBots();if(_0x29a9de[_0xd1c9d1(0x216)]==0x0)tgBot[_0xd1c9d1(0x21e)](_0x2452ea['chat']['id'],_0xd1c9d1(0x2ff))[_0xd1c9d1(0x363)](_0x211a24=>{telegramError(_0x211a24);});else{if(_0x29a9de[_0xd1c9d1(0x216)]>0x1){let _0x2c98cc=[],_0x49a378=[];const _0x59aeca=_0x29a9de[_0xd1c9d1(0x216)]%0x4==0x0||_0x29a9de[_0xd1c9d1(0x216)]%0x4==0x3||_0x29a9de[_0xd1c9d1(0x216)]%0x3==0x1?0x4:0x3;let _0x4c9744=0x0;_0x29a9de[_0xd1c9d1(0x1e8)]((_0x59fda8,_0x3bbc42)=>{const _0xaeb193=_0xd1c9d1;if(_0x3bbc42%_0x59aeca==0x0)_0x49a378=[];_0x49a378[_0xaeb193(0x2f3)]({'text':_0xaeb193(0x264)+_0x59fda8[_0xaeb193(0x206)],'callback_data':_0x59fda8[_0xaeb193(0x206)]}),_0x3bbc42%_0x59aeca==0x0&&(_0x2c98cc[_0x4c9744]=_0x49a378,_0x4c9744++);}),tgBot[_0xd1c9d1(0x21e)](_0x2452ea['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x2c98cc}})['catch'](_0x56e274=>{telegramError(_0x56e274);}),tgBot['on'](_0xd1c9d1(0x3a3),async _0x156fea=>{const _0x5e1e5a=_0xd1c9d1,_0x425937=_0x156fea[_0x5e1e5a(0x237)],_0x34fe8c=_0x156fea[_0x5e1e5a(0x35b)];tgBot[_0x5e1e5a(0x2d8)](_0x156fea['id'])['then'](async()=>{const _0x3d11b1=_0x5e1e5a;if(pid[_0x425937])pid[_0x425937][_0x3d11b1(0x31a)]({'function':_0x3d11b1(0x2cc),'args':null});}),tgBot[_0x5e1e5a(0x343)](_0x5e1e5a(0x3a3));});}else{const _0x5202d2=_0x29a9de[0x0]['botID'];if(pid[_0x5202d2])pid[_0x5202d2]['send']({'function':_0xd1c9d1(0x2cc),'args':null});}}}),tgBot[_0x412c30(0x2ba)](/\/portfolio/,_0xc98313=>{const _0x1e7ac0=_0x412c30;if(!validateTelegram(_0xc98313))return;tgBot[_0x1e7ac0(0x343)]('callback_query');const _0x14cff4=getEnabledBots();if(_0x14cff4['length']==0x0)tgBot[_0x1e7ac0(0x21e)](_0xc98313[_0x1e7ac0(0x25e)]['id'],_0x1e7ac0(0x2ff))[_0x1e7ac0(0x363)](_0x164eb0=>{telegramError(_0x164eb0);});else{if(_0x14cff4[_0x1e7ac0(0x216)]>0x1){let _0x4238c9=[],_0x5ab438=[];const _0x4674b4=_0x14cff4[_0x1e7ac0(0x216)]%0x4==0x0||_0x14cff4['length']%0x4==0x3||_0x14cff4['length']%0x3==0x1?0x4:0x3;let _0x557d96=0x0;_0x14cff4[_0x1e7ac0(0x1e8)]((_0x3a05a7,_0x4ff0ca)=>{const _0x222721=_0x1e7ac0;if(_0x4ff0ca%_0x4674b4==0x0)_0x5ab438=[];_0x5ab438[_0x222721(0x2f3)]({'text':_0x222721(0x264)+_0x3a05a7[_0x222721(0x206)],'callback_data':_0x3a05a7[_0x222721(0x206)]}),_0x4ff0ca%_0x4674b4==0x0&&(_0x4238c9[_0x557d96]=_0x5ab438,_0x557d96++);}),tgBot['sendMessage'](_0xc98313[_0x1e7ac0(0x25e)]['id'],_0x1e7ac0(0x243),{'reply_markup':{'inline_keyboard':_0x4238c9}})[_0x1e7ac0(0x363)](_0x1ae83b=>{telegramError(_0x1ae83b);}),tgBot['on'](_0x1e7ac0(0x3a3),async _0x1953f3=>{const _0x3b996a=_0x1e7ac0,_0x4443a0=_0x1953f3[_0x3b996a(0x237)],_0x1222a1=_0x1953f3[_0x3b996a(0x35b)];tgBot[_0x3b996a(0x2d8)](_0x1953f3['id'])[_0x3b996a(0x387)](async()=>{const _0x3ab967=_0x3b996a;if(pid[_0x4443a0])pid[_0x4443a0][_0x3ab967(0x31a)]({'function':_0x3ab967(0x24b),'args':null});}),tgBot[_0x3b996a(0x343)](_0x3b996a(0x3a3));});}else{const _0x240c10=_0x14cff4[0x0][_0x1e7ac0(0x206)];if(pid[_0x240c10])pid[_0x240c10]['send']({'function':_0x1e7ac0(0x24b),'args':null});}}}),tgBot[_0x412c30(0x2ba)](/\/update/,async _0x57f343=>{const _0x39c1ae=_0x412c30;if(!validateTelegram(_0x57f343))return;tgBot['removeListener'](_0x39c1ae(0x3a3)),await getMessages();if(!updateAvailable)tgBot[_0x39c1ae(0x21e)](_0x57f343[_0x39c1ae(0x25e)]['id'],_0x39c1ae(0x3b4))['catch'](_0x191e0a=>{telegramError(_0x191e0a);});else!validInstallation?tgBot[_0x39c1ae(0x21e)](_0x57f343['chat']['id'],_0x39c1ae(0x278))[_0x39c1ae(0x363)](_0x3ef269=>{telegramError(_0x3ef269);}):(tgBot[_0x39c1ae(0x21e)](_0x57f343[_0x39c1ae(0x25e)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x39c1ae(0x33f),'callback_data':_0x39c1ae(0x33a)},{'text':'No','callback_data':'no'}]]}})[_0x39c1ae(0x363)](_0x70cd9d=>{telegramError(_0x70cd9d);}),tgBot['on'](_0x39c1ae(0x3a3),async _0x2a84cd=>{const _0x4ec4be=_0x39c1ae,_0x41d3dd=_0x2a84cd[_0x4ec4be(0x237)],_0x3ea671=_0x2a84cd[_0x4ec4be(0x35b)];tgBot[_0x4ec4be(0x2d8)](_0x2a84cd['id'])[_0x4ec4be(0x387)](async()=>{const _0x1c7bf4=_0x4ec4be;_0x41d3dd=='yes'&&(await tgBot[_0x1c7bf4(0x21e)](_0x3ea671[_0x1c7bf4(0x25e)]['id'],_0x1c7bf4(0x3bb))['catch'](_0x39f2d7=>{telegramError(_0x39f2d7);}),updateBB('update')),_0x41d3dd=='no'&&await tgBot[_0x1c7bf4(0x21e)](_0x3ea671[_0x1c7bf4(0x25e)]['id'],_0x1c7bf4(0x2ec))['catch'](_0x116398=>{telegramError(_0x116398);});}),tgBot[_0x4ec4be(0x343)](_0x4ec4be(0x3a3));}));}),tgBot[_0x412c30(0x2ba)](/\/reinstall/,async _0x377572=>{const _0x52ae6b=_0x412c30;if(!validateTelegram(_0x377572))return;tgBot[_0x52ae6b(0x343)](_0x52ae6b(0x3a3)),!validInstallation?tgBot['sendMessage'](_0x377572[_0x52ae6b(0x25e)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x52ae6b(0x363)](_0x239957=>{telegramError(_0x239957);}):(tgBot[_0x52ae6b(0x21e)](_0x377572[_0x52ae6b(0x25e)]['id'],_0x52ae6b(0x280),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x52ae6b(0x33a)},{'text':'No','callback_data':'no'}]]}})['catch'](_0xada870=>{telegramError(_0xada870);}),tgBot['on'](_0x52ae6b(0x3a3),async _0x4debcd=>{const _0x486bd0=_0x52ae6b,_0x3ecdfd=_0x4debcd[_0x486bd0(0x237)],_0x5820c8=_0x4debcd['message'];tgBot['answerCallbackQuery'](_0x4debcd['id'])[_0x486bd0(0x387)](async()=>{const _0x425ee7=_0x486bd0;_0x3ecdfd==_0x425ee7(0x33a)&&(await tgBot[_0x425ee7(0x21e)](_0x5820c8['chat']['id'],_0x425ee7(0x300))[_0x425ee7(0x363)](_0x25e2a0=>{telegramError(_0x25e2a0);}),updateBB(_0x425ee7(0x31f))),_0x3ecdfd=='no'&&await tgBot['sendMessage'](_0x5820c8[_0x425ee7(0x25e)]['id'],_0x425ee7(0x270))['catch'](_0x58eb4a=>{telegramError(_0x58eb4a);});}),tgBot['removeListener'](_0x486bd0(0x3a3));}));}),tgBot[_0x412c30(0x2ba)](/\/toggle/,_0x2ef484=>{const _0x37102b=_0x412c30;if(!validateTelegram(_0x2ef484))return;tgBot[_0x37102b(0x343)](_0x37102b(0x3a3));const _0x57c6d5=getBotsWithMode();if(_0x57c6d5[_0x37102b(0x216)]==0x0)tgBot[_0x37102b(0x21e)](_0x2ef484['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x37102b(0x363)](_0x5b2c3d=>{telegramError(_0x5b2c3d);});else{let _0x52cb37=[],_0x2ebaf0=[];const _0x4565e9=0x2;let _0x191d3d=0x0;_0x57c6d5[_0x37102b(0x1e8)]((_0x1c3d5,_0x36b213)=>{const _0x15e3e7=_0x37102b;if(_0x36b213%_0x4565e9==0x0)_0x2ebaf0=[];_0x2ebaf0[_0x15e3e7(0x2f3)]({'text':'Bot\x20'+_0x1c3d5['botID']+'\x20('+_0x1c3d5['mode']+')','callback_data':_0x1c3d5[_0x15e3e7(0x206)]}),_0x36b213%_0x4565e9==0x0&&(_0x52cb37[_0x191d3d]=_0x2ebaf0,_0x191d3d++);}),tgBot['sendMessage'](_0x2ef484['chat']['id'],_0x37102b(0x311),{'reply_markup':{'inline_keyboard':_0x52cb37}})[_0x37102b(0x363)](_0x45d372=>{telegramError(_0x45d372);}),tgBot['on']('callback_query',async _0x2552d1=>{const _0xb877dc=_0x37102b,_0xaad5fc=_0x2552d1[_0xb877dc(0x237)],_0x3ae342=_0x2552d1[_0xb877dc(0x35b)];tgBot[_0xb877dc(0x2d8)](_0x2552d1['id'])[_0xb877dc(0x387)](async()=>{const _0x74b344=_0xb877dc,_0x5499a5=_0x57c6d5[_0x74b344(0x2ae)](_0x4d403=>_0x4d403['botID']==_0xaad5fc),_0x3ab5b8=_0x5499a5[_0x74b344(0x366)]==_0x74b344(0x22e)?'manual':'auto';tgBot[_0x74b344(0x21e)](_0x3ae342[_0x74b344(0x25e)]['id'],_0x74b344(0x20c)+_0xaad5fc+'\x20to\x20'+_0x3ab5b8+_0x74b344(0x342))[_0x74b344(0x363)](_0x54a1a1=>{telegramError(_0x54a1a1);}),toggleBotMode(_0xaad5fc);}),tgBot[_0xb877dc(0x343)](_0xb877dc(0x3a3));});}}),tgBot[_0x412c30(0x2ba)](/\/names/,_0x2109ff=>{const _0x154e7c=_0x412c30;if(!validateTelegram(_0x2109ff))return;let _0x34ec79='';config[_0x154e7c(0x1e8)](_0x2816f5=>{const _0x2e2cd2=_0x154e7c;_0x34ec79+=_0x2e2cd2(0x264)+_0x2816f5['botID']+':\x20'+_0x2816f5[_0x2e2cd2(0x27e)]+'\x0a';}),tgBot[_0x154e7c(0x21e)](_0x2109ff[_0x154e7c(0x25e)]['id'],_0x34ec79,{'parse_mode':'HTML'})[_0x154e7c(0x363)](_0x1072ab=>{telegramError(_0x1072ab);});}),tgBot[_0x412c30(0x2ba)](/\/disable/,_0x203746=>{const _0x1b7af3=_0x412c30;if(!validateTelegram(_0x203746))return;tgBot[_0x1b7af3(0x21e)](_0x203746[_0x1b7af3(0x25e)]['id'],_0x1b7af3(0x34b))[_0x1b7af3(0x363)](_0x10f47d=>{telegramError(_0x10f47d);}),updateSetting(_0x1b7af3(0x25b),![]);}),tgBot[_0x412c30(0x2ba)](/\/help/,_0x17b8c4=>{const _0xfa404=_0x412c30;if(!validateTelegram(_0x17b8c4))return;tgBot['sendMessage'](_0x17b8c4[_0xfa404(0x25e)]['id'],_0x3578e0)[_0xfa404(0x363)](_0x1deadc=>{telegramError(_0x1deadc);});}),tgBot['on'](_0x412c30(0x307),_0x1aeb79=>{const _0x3c202f=_0x412c30;_0x1aeb79['toString']()['includes']('404\x20Not\x20Found')&&(logger[_0x3c202f(0x23f)](_0x3c202f(0x1e7)),tgBot[_0x3c202f(0x1f9)](),tgBot=null,io['to']('botmanager')[_0x3c202f(0x244)](_0x3c202f(0x327),_0x3c202f(0x1e7)));}),process['once'](_0x412c30(0x3a4),()=>{const _0x925942=_0x412c30;if(tgBot)tgBot[_0x925942(0x1f9)]();process['exit'](0x1);}),process[_0x412c30(0x247)](_0x412c30(0x23c),()=>{const _0x1a4171=_0x412c30;if(tgBot)tgBot[_0x1a4171(0x1f9)]();process[_0x1a4171(0x262)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0xdeff9f,_0x597233){const _0x3cbb1e=_0x1f002e;if(settings[_0x3cbb1e(0x25b)]){if(settings[_0x3cbb1e(0x27a)]==_0x3cbb1e(0x34c)||(_0x597233['type']==_0x3cbb1e(0x2d6)||_0x597233[_0x3cbb1e(0x1fb)]==_0x3cbb1e(0x2b9)||_0x597233[_0x3cbb1e(0x1fb)]==_0x3cbb1e(0x26b))&&settings[_0x3cbb1e(0x27a)]==_0x3cbb1e(0x233)||_0x597233['type']==_0x3cbb1e(0x256)&&settings[_0x3cbb1e(0x27a)]==_0x3cbb1e(0x21a)){if(tgBot&&settings['telegramChatId']){if(_0x597233[_0x3cbb1e(0x312)])tgBot[_0x3cbb1e(0x21e)](settings[_0x3cbb1e(0x321)],_0x597233[_0x3cbb1e(0x27e)]+'\x20>\x20'+_0x597233[_0x3cbb1e(0x240)])[_0x3cbb1e(0x363)](_0x187062=>{telegramError(_0x187062);});else tgBot['sendMessage'](settings['telegramChatId'],_0x3cbb1e(0x264)+_0xdeff9f+_0x3cbb1e(0x354)+_0x597233['event'])['catch'](_0x1d20a7=>{telegramError(_0x1d20a7);});}}}}async function sendTelegramMsg(_0xd80fa9,_0x582ecb=_0x1f002e(0x1ed)){const _0x3e6603=_0x1f002e;return settings['telegramEnabled']&&tgBot&&settings[_0x3e6603(0x321)]?(await tgBot[_0x3e6603(0x21e)](settings[_0x3e6603(0x321)],_0xd80fa9,{'parse_mode':_0x582ecb})[_0x3e6603(0x363)](_0x3623bb=>{telegramError(_0x3623bb);}),!![]):![];}function getDeviceWithIp(_0x5193fb){const _0x38a29c=_0x1f002e;return devices[_0x38a29c(0x2ae)](_0x16e3f6=>_0x16e3f6['ip']===_0x5193fb);}function temporaryAccess2FA(_0x305e0f,_0x4f3226){const _0x296f9d=_0x1f002e;let _0x33e1bc=new Date(),_0x2aee52=![];if(lastIpApproval){if(_0x33e1bc-lastIpApproval<0x1388)_0x2aee52=!![];}lastIpApproval=new Date();if(_0x2aee52)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x296f9d(0x343)](_0x296f9d(0x3a3)),tgBot['sendMessage'](settings[_0x296f9d(0x321)],_0x296f9d(0x232)+normalizeIP(_0x4f3226)[_0x296f9d(0x2c4)]+_0x296f9d(0x384),{'parse_mode':_0x296f9d(0x1ed),'reply_markup':{'inline_keyboard':[[{'text':_0x296f9d(0x217),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x296f9d(0x2b4),'callback_data':'30'},{'text':_0x296f9d(0x31b),'callback_data':'reject'}]]}})[_0x296f9d(0x363)](_0x5bc61b=>{telegramError(_0x5bc61b);}),tgBot['on'](_0x296f9d(0x3a3),async _0x472efa=>{const _0x27fd11=_0x296f9d,_0x577bb1=_0x472efa[_0x27fd11(0x237)],_0x10928a=_0x472efa['message'];tgBot[_0x27fd11(0x2d8)](_0x472efa['id'])['then'](async()=>{const _0x58c69e=_0x27fd11;devices[_0x305e0f][_0x58c69e(0x201)]={'clientip':_0x4f3226,'timestamp':new Date()['getTime'](),'expiry':_0x577bb1},_0x577bb1!=_0x58c69e(0x31b)?(await tgBot[_0x58c69e(0x21e)](_0x10928a[_0x58c69e(0x25e)]['id'],_0x58c69e(0x337)+_0x577bb1+_0x58c69e(0x2dd),{'parse_mode':_0x58c69e(0x1ed)})['catch'](_0x5747c1=>{telegramError(_0x5747c1);}),io['to'](_0x305e0f)[_0x58c69e(0x244)]('status',{'access':{'allow':![],'reason':_0x58c69e(0x334),'token':null}})):(await tgBot[_0x58c69e(0x21e)](_0x10928a[_0x58c69e(0x25e)]['id'],'Temporary\x20access\x20rejected')[_0x58c69e(0x363)](_0x25e606=>{telegramError(_0x25e606);}),io['to'](_0x305e0f)[_0x58c69e(0x244)](_0x58c69e(0x260),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x27fd11(0x343)](_0x27fd11(0x3a3));}));}function loginAccess2FA(_0x33d819,_0x589b38){const _0x4250e1=_0x1f002e;tgBot&&settings[_0x4250e1(0x321)]&&(tgBot[_0x4250e1(0x343)](_0x4250e1(0x3a3)),tgBot[_0x4250e1(0x21e)](settings[_0x4250e1(0x321)],_0x4250e1(0x303)+normalizeIP(_0x589b38)['show']+_0x4250e1(0x384),{'parse_mode':_0x4250e1(0x1ed),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x4250e1(0x31b)}]]}})[_0x4250e1(0x363)](_0x43c0d6=>{telegramError(_0x43c0d6);}),tgBot['on'](_0x4250e1(0x3a3),async _0x78c10d=>{const _0x350fa7=_0x4250e1,_0x5bc979=_0x78c10d[_0x350fa7(0x237)],_0x218ec4=_0x78c10d[_0x350fa7(0x35b)];tgBot['answerCallbackQuery'](_0x78c10d['id'])[_0x350fa7(0x387)](async()=>{const _0x4ccdb4=_0x350fa7;devices[_0x33d819]['telegram2FaApproval']={'clientip':_0x589b38,'timestamp':new Date()[_0x4ccdb4(0x2e6)](),'expiry':_0x5bc979},_0x5bc979!=_0x4ccdb4(0x31b)?(await tgBot[_0x4ccdb4(0x21e)](_0x218ec4[_0x4ccdb4(0x25e)]['id'],_0x4ccdb4(0x28c),{'parse_mode':_0x4ccdb4(0x1ed)})[_0x4ccdb4(0x363)](_0xa923c4=>{telegramError(_0xa923c4);}),io['to'](_0x33d819)['emit'](_0x4ccdb4(0x260),{'access':{'allow':![],'reason':_0x4ccdb4(0x334),'token':null}})):(await tgBot[_0x4ccdb4(0x21e)](_0x218ec4['chat']['id'],'Login\x20rejected')[_0x4ccdb4(0x363)](_0x148a46=>{telegramError(_0x148a46);}),io['to'](_0x33d819)[_0x4ccdb4(0x244)](_0x4ccdb4(0x260),{'access':{'allow':![],'reason':_0x4ccdb4(0x2f8),'token':null}}));}),tgBot['removeListener'](_0x350fa7(0x3a3));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3e3e51=_0x1f002e;return dbConfig[_0x3e3e51(0x2e1)](_0x3e3e51(0x340))[_0x3e3e51(0x315)](_0x3e3e51(0x206))[_0x3e3e51(0x382)]({'status':_0x3e3e51(0x345)})['value']()||[];}function getDisabledBots(){const _0x43b308=_0x1f002e;return dbConfig[_0x43b308(0x2e1)](_0x43b308(0x340))[_0x43b308(0x315)]('botID')['filter']({'status':_0x43b308(0x205)})[_0x43b308(0x22b)]()||[];}function getBotAttributes(_0x22ca7b){const _0x564287=_0x1f002e;let _0x10039d={};const _0x22671a=configpath+_0x564287(0x25d)+_0x22ca7b+_0x564287(0x23a),_0x177c06=fs[_0x564287(0x266)](_0x22671a);if(_0x177c06){const _0x50dbd3=fs['readFileSync'](_0x22671a);try{const _0x3a3b9c=JSON['parse'](_0x50dbd3),_0x4902bc=_0x3a3b9c?_0x3a3b9c[_0x564287(0x2a4)][0x0][_0x564287(0x292)]:![];_0x10039d['mode']=_0x4902bc?_0x564287(0x22e):_0x564287(0x2de),_0x10039d[_0x564287(0x27e)]=_0x3a3b9c?_0x3a3b9c[_0x564287(0x2a4)][0x0]['botname']:_0x564287(0x264)+_0x22ca7b;}catch(_0xd9cd2){_0x10039d[_0x564287(0x366)]='manual',_0x10039d['botname']=_0x564287(0x264)+_0x22ca7b;}}else _0x10039d[_0x564287(0x366)]=_0x564287(0x2de),_0x10039d[_0x564287(0x27e)]=_0x564287(0x264)+_0x22ca7b;return _0x10039d;}function getBotsWithMode(){const _0x534155=_0x1f002e,_0x12baee=dbConfig[_0x534155(0x2e1)](_0x534155(0x340))[_0x534155(0x315)](_0x534155(0x206))[_0x534155(0x22b)]()||[];return _0x12baee[_0x534155(0x1e8)](_0xbd571e=>{const _0x346f61=_0x534155;let _0x2481ac=getBotAttributes(_0xbd571e['botID']);_0xbd571e['mode']=_0x2481ac[_0x346f61(0x366)];}),_0x12baee;}function getBotExchanges(){const _0x356b72=_0x1f002e;let _0x576bd1=[];const _0x43bea2=dbConfig[_0x356b72(0x2e1)](_0x356b72(0x340))[_0x356b72(0x315)](_0x356b72(0x206))[_0x356b72(0x22b)]()||[];_0x43bea2[_0x356b72(0x1e8)](_0x5c1e68=>{const _0x18453f=_0x356b72;if(_0x5c1e68[_0x18453f(0x260)]=='enabled'){const _0x381511=configpath+_0x18453f(0x25d)+_0x5c1e68['botID']+_0x18453f(0x23a),_0x26e75f=fs[_0x18453f(0x266)](_0x381511);let _0x1e6d60;if(_0x26e75f){const _0x573660=fs['readFileSync'](_0x381511);try{const _0x5d164c=JSON[_0x18453f(0x2e4)](_0x573660);_0x1e6d60=_0x5d164c?_0x5d164c[_0x18453f(0x2a4)][0x0][_0x18453f(0x22d)]:null;}catch(_0x1d5cbf){}}if(_0x1e6d60)_0x576bd1['push'](_0x1e6d60);}});const _0x2fd216=[...new Set(_0x576bd1)][_0x356b72(0x221)]();return _0x2fd216;}async function initUser(){const _0x13064c=_0x1f002e;if(!settings['userid']){const _0x5804cf=uuidRandom();mixpanel[_0x13064c(0x3c5)](_0x5804cf),updateSetting(_0x13064c(0x239),_0x5804cf);}}async function initSecure(){const _0x209e17=_0x1f002e;let _0x59b0d8=getSecure();if(!_0x59b0d8[_0x209e17(0x348)](_0x209e17(0x1dc))){let _0x415596=await generateKeys();_0x59b0d8[_0x209e17(0x24a)]=_0x415596['publicKey'],_0x59b0d8['privateKey']=_0x415596[_0x209e17(0x309)],_0x59b0d8[_0x209e17(0x1dc)]=crypto[_0x209e17(0x29a)](0x20)['toString'](_0x209e17(0x392));;storeSecure(_0x59b0d8);}}function getSettings(){const _0x584d4f=_0x1f002e;return dbSettings['get'](_0x584d4f(0x320))[_0x584d4f(0x22b)]()||{};}function getSecure(){const _0x5b4185=_0x1f002e;return dbSecure['get'](_0x5b4185(0x306))['value']()||{};}function getBlacklist(){const _0xe26e90=_0x1f002e;return dbSecure[_0xe26e90(0x2e1)](_0xe26e90(0x1de))['value']()||[];}function broadcastToBots(_0x59393b,_0x180074){const _0x2c7895=_0x1f002e;config[_0x2c7895(0x1e8)](_0x1340c3=>{const _0xc48e94=_0x2c7895;if(_0x1340c3[_0xc48e94(0x260)]==_0xc48e94(0x345)&&_0x1340c3[_0xc48e94(0x234)]=='running'||_0x1340c3['status']==_0xc48e94(0x27d)&&_0x1340c3[_0xc48e94(0x234)]==_0xc48e94(0x350)){if(pid[_0x1340c3['botID']])pid[_0x1340c3[_0xc48e94(0x206)]]['send']({[_0x59393b]:_0x180074});}});}function storeSettings(_0x321e0a,_0x3b1949=![]){const _0x5b09fe=_0x1f002e;_0x321e0a={...settings,..._0x321e0a};if(_0x3b1949&&_0x321e0a[_0x5b09fe(0x230)]!=_0x5b09fe(0x296)&&_0x321e0a[_0x5b09fe(0x230)]!='***'&&_0x321e0a['bbPassword']!=''){const _0x1e4ceb=crypt['decrypt'](secure[_0x5b09fe(0x309)],_0x321e0a[_0x5b09fe(0x230)])[_0x5b09fe(0x35b)]['split']('@')[0x0],_0x179826=bcrypt['hashSync'](_0x1e4ceb,saltRounds);_0x321e0a={..._0x321e0a,'bbPassword':_0x179826};}if(_0x3b1949&&_0x321e0a[_0x5b09fe(0x2fd)]!=_0x5b09fe(0x296)&&_0x321e0a[_0x5b09fe(0x2fd)]!=_0x5b09fe(0x291)&&_0x321e0a[_0x5b09fe(0x2fd)]!=''){const _0x29f64d=crypt['decrypt'](secure[_0x5b09fe(0x309)],_0x321e0a[_0x5b09fe(0x2fd)])['message']['split']('@')[0x0];_0x321e0a={..._0x321e0a,'telegramToken':_0x29f64d};}const _0x3b06af=_0x321e0a[_0x5b09fe(0x2fd)]!=_0x5b09fe(0x296)&&_0x321e0a[_0x5b09fe(0x2fd)]!=settings[_0x5b09fe(0x2fd)]||_0x321e0a[_0x5b09fe(0x39e)]!=settings[_0x5b09fe(0x39e)],_0x146f4a=_0x321e0a[_0x5b09fe(0x2fd)]==''||_0x321e0a[_0x5b09fe(0x39e)]=='';if(_0x3b06af)_0x321e0a[_0x5b09fe(0x27a)]=_0x5b09fe(0x34c);for(const [_0x251b28,_0x334d08]of Object['entries'](_0x321e0a)){if(_0x251b28==_0x5b09fe(0x2fd)&&_0x334d08==_0x5b09fe(0x296)){_0x321e0a[_0x5b09fe(0x2fd)]=settings[_0x5b09fe(0x2fd)];continue;};if(_0x251b28==_0x5b09fe(0x230)&&_0x334d08==_0x5b09fe(0x296)){_0x321e0a['bbPassword']=settings[_0x5b09fe(0x230)];continue;};dbSettings[_0x5b09fe(0x32f)](_0x5b09fe(0x2c8)+_0x251b28,_0x334d08)[_0x5b09fe(0x399)]();}settings=_0x321e0a,io['to']('botmanager')[_0x5b09fe(0x244)](_0x5b09fe(0x320),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x5b09fe(0x35c),settings[_0x5b09fe(0x35c)]);if(_0x3b06af&&!_0x146f4a)initTelegram();if(_0x3b06af&&_0x146f4a)disableTelegram();getAllClients()['forEach'](_0x35abb2=>{const _0x4c741c=_0x5b09fe;getSocket(_0x35abb2['id'])[_0x4c741c(0x244)](_0x4c741c(0x260),{'access':{'allow':![],'reason':_0x4c741c(0x334),'token':null}});});}function updateSetting(_0x5e41af,_0x3474a){const _0x43b108=_0x1f002e;dbSettings[_0x43b108(0x32f)]('settings.'+_0x5e41af,_0x3474a)['write'](),settings=getSettings(),io['to'](_0x43b108(0x245))[_0x43b108(0x244)](_0x43b108(0x320),cleanSettings());}function storeSecure(_0x17a02f){dbSecure['get']('secure')['push'](_0x17a02f)['write'](),secure=_0x17a02f;}function addBlacklist(_0xf00821){const _0x3449c7=_0x1f002e;cleanBlacklist();let _0x55e670;devices[_0xf00821][_0x3449c7(0x201)]?_0x55e670=Math[_0x3449c7(0x2e5)](devices[_0xf00821][_0x3449c7(0x201)][_0x3449c7(0x356)],loginExpiry):_0x55e670=loginExpiry,dbSecure[_0x3449c7(0x2e1)]('blacklist')['push']({'expiry':new Date()[_0x3449c7(0x2e6)]()+_0x55e670*0x3c*0x3e8,'token':devices[_0xf00821][_0x3449c7(0x227)][_0x3449c7(0x1e3)]})[_0x3449c7(0x399)](),blacklist=dbSecure['get'](_0x3449c7(0x1de))['value']();}function cleanBlacklist(){const _0x23fe70=_0x1f002e;let _0x25f88d=dbSecure['get'](_0x23fe70(0x1de))[_0x23fe70(0x285)]()[_0x23fe70(0x22b)](),_0xe3db01=new Date()[_0x23fe70(0x2e6)]();_0x25f88d[_0x23fe70(0x1e8)](_0x543a3c=>{const _0x1bc50d=_0x23fe70;_0x543a3c[_0x1bc50d(0x356)]<_0xe3db01&&dbSecure[_0x1bc50d(0x2e1)](_0x1bc50d(0x1de))[_0x1bc50d(0x31c)]({'expiry':_0x543a3c[_0x1bc50d(0x356)]})[_0x1bc50d(0x399)]();});}function initStates(){const _0x35f146=_0x1f002e;let _0x11d3a8=getConfiguration();_0x11d3a8[_0x35f146(0x1e8)](_0x1f7733=>{const _0x3f5a03=_0x35f146;_0x1f7733[_0x3f5a03(0x234)]='stopped';}),storeConfiguration(_0x11d3a8);}function onKeys(){const _0xe971c=new RSA();return new Promise(_0x33f971=>{const _0x5c4f83=_0x1851;_0xe971c[_0x5c4f83(0x352)]()[_0x5c4f83(0x387)](_0xca63b0=>{_0x33f971(_0xca63b0);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5b7595=_0x1f002e;let _0x42d7c8=getSettings(),_0x5a480b=![];!_0x42d7c8[_0x5b7595(0x348)](_0x5b7595(0x304))&&(_0x42d7c8[_0x5b7595(0x304)]=0x0,_0x5a480b=!![]);!_0x42d7c8[_0x5b7595(0x348)](_0x5b7595(0x34a))&&(_0x42d7c8[_0x5b7595(0x34a)]=0x0,_0x5a480b=!![]);!_0x42d7c8[_0x5b7595(0x348)]('latestversion')&&(_0x42d7c8[_0x5b7595(0x208)]=_0x5b7595(0x3ab),_0x5a480b=!![]);!_0x42d7c8[_0x5b7595(0x348)]('onepagemode')&&(_0x42d7c8[_0x5b7595(0x35c)]=![],_0x5a480b=!![]);if(_0x5a480b)storeSettings(_0x42d7c8);try{fs[_0x5b7595(0x24d)](configbackuppath,{'withFileTypes':!![]})[_0x5b7595(0x1e8)](_0x55e4be=>{const _0x1addd0=_0x5b7595;if(!_0x55e4be[_0x1addd0(0x209)]()){if(!_0x55e4be[_0x1addd0(0x331)][_0x1addd0(0x1f1)](_0x1addd0(0x29f)))fs[_0x1addd0(0x33d)](configbackuppath+_0x55e4be['name']);}else fs[_0x1addd0(0x25c)](configbackuppath+_0x55e4be['name'],{'recursive':!![]});});}catch(_0x5766e2){logger['debug'](_0x5b7595(0x301),_0x5766e2);}}function storeConfiguration(_0x544956){const _0x4916fa=_0x1f002e;dbConfig['get'](_0x4916fa(0x340))[_0x4916fa(0x31c)]()[_0x4916fa(0x399)](),_0x544956[_0x4916fa(0x1e8)](_0x25cb37=>{const _0x52b98a=_0x4916fa;delete _0x25cb37[_0x52b98a(0x366)];}),dbConfig['get'](_0x4916fa(0x340))[_0x4916fa(0x2f3)](..._0x544956)[_0x4916fa(0x399)](),config=_0x544956;}function resetPassword(){const _0x159b44=_0x1f002e;tgBot&&settings[_0x159b44(0x321)]&&(tgBot[_0x159b44(0x343)](_0x159b44(0x3a3)),tgBot[_0x159b44(0x21e)](settings[_0x159b44(0x321)],_0x159b44(0x2e7),{'parse_mode':_0x159b44(0x1ed),'reply_markup':{'inline_keyboard':[[{'text':_0x159b44(0x33a),'callback_data':_0x159b44(0x33a)},{'text':'no','callback_data':'no'}]]}})[_0x159b44(0x363)](_0xe841b8=>{telegramError(_0xe841b8);}),tgBot['on']('callback_query',async _0x146b2e=>{const _0x195dc0=_0x159b44,_0x1f7882=_0x146b2e['data'],_0x23a445=_0x146b2e[_0x195dc0(0x35b)];tgBot['answerCallbackQuery'](_0x146b2e['id'])[_0x195dc0(0x387)](async()=>{const _0x5354cb=_0x195dc0;if(_0x1f7882!='no'){const _0x2497f8=0xf,_0x3e48d4='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x429949=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x2497f8)))[_0x5354cb(0x359)](_0x327d2b=>_0x3e48d4[_0x327d2b%_0x3e48d4[_0x5354cb(0x216)]])[_0x5354cb(0x3b6)](''),_0x27ca60=bcrypt[_0x5354cb(0x2a8)](_0x429949,saltRounds);storeSettings({'bbPassword':_0x27ca60}),await tgBot[_0x5354cb(0x21e)](_0x23a445[_0x5354cb(0x25e)]['id'],_0x5354cb(0x2f0)+_0x429949,{'parse_mode':_0x5354cb(0x1ed)})[_0x5354cb(0x363)](_0x1b9844=>{telegramError(_0x1b9844);});}else await tgBot[_0x5354cb(0x21e)](_0x23a445[_0x5354cb(0x25e)]['id'],'Password\x20reset\x20rejected')['catch'](_0x36c8bf=>{telegramError(_0x36c8bf);});}),tgBot[_0x195dc0(0x343)](_0x195dc0(0x3a3));}));}async function confirmRestore(_0x158573,_0x454203){const _0x5753f3=_0x1f002e;io['to'](_0x5753f3(0x245))['emit'](_0x5753f3(0x327),_0x5753f3(0x28a),_0x5753f3(0x26b)),tgBot&&settings[_0x5753f3(0x321)]&&(tgBot[_0x5753f3(0x343)](_0x5753f3(0x3a3)),await tgBot[_0x5753f3(0x21e)](settings[_0x5753f3(0x321)],_0x5753f3(0x200),{'parse_mode':_0x5753f3(0x1ed),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x5753f3(0x33a)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2febf9=>{telegramError(_0x2febf9);}),tgBot['on']('callback_query',async _0x569d10=>{const _0x3187c1=_0x5753f3,_0x5ad0b5=_0x569d10[_0x3187c1(0x237)],_0x16b848=_0x569d10['message'];tgBot['answerCallbackQuery'](_0x569d10['id'])[_0x3187c1(0x387)](async()=>{const _0x41cc69=_0x3187c1;_0x5ad0b5==_0x41cc69(0x33a)?(await tgBot[_0x41cc69(0x21e)](_0x16b848[_0x41cc69(0x25e)]['id'],_0x41cc69(0x3a9),{'parse_mode':_0x41cc69(0x1ed)})[_0x41cc69(0x363)](_0x44d2e5=>{telegramError(_0x44d2e5);}),unzipFile(_0x158573,_0x454203)):(logger['debug'](_0x41cc69(0x35e)),await tgBot[_0x41cc69(0x21e)](_0x16b848[_0x41cc69(0x25e)]['id'],_0x41cc69(0x35e))[_0x41cc69(0x363)](_0x38972b=>{telegramError(_0x38972b);}));}),tgBot['removeListener'](_0x3187c1(0x3a3));}));}function getServerTime(){const _0x7a4492=_0x1f002e,_0x4d0ed1=new Date();return _0x4d0ed1['getFullYear']()+'/'+(_0x4d0ed1[_0x7a4492(0x21b)]()+0x1)[_0x7a4492(0x396)]()[_0x7a4492(0x32b)](0x2,'0')+'/'+_0x4d0ed1[_0x7a4492(0x204)]()[_0x7a4492(0x396)]()['padStart'](0x2,'0')+'\x20'+_0x4d0ed1[_0x7a4492(0x27b)]()[_0x7a4492(0x396)]()[_0x7a4492(0x32b)](0x2,'0')+':'+_0x4d0ed1[_0x7a4492(0x226)]()[_0x7a4492(0x396)]()[_0x7a4492(0x32b)](0x2,'0')+':'+_0x4d0ed1[_0x7a4492(0x339)]()[_0x7a4492(0x396)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x399b88=_0x1f002e,_0x3356a9=shiftedTime();return _0x3356a9['getFullYear']()+'/'+(_0x3356a9[_0x399b88(0x21b)]()+0x1)[_0x399b88(0x396)]()[_0x399b88(0x32b)](0x2,'0')+'/'+_0x3356a9[_0x399b88(0x204)]()['toString']()[_0x399b88(0x32b)](0x2,'0')+'\x20'+_0x3356a9[_0x399b88(0x27b)]()[_0x399b88(0x396)]()['padStart'](0x2,'0')+':'+_0x3356a9['getMinutes']()[_0x399b88(0x396)]()[_0x399b88(0x32b)](0x2,'0')+':'+_0x3356a9[_0x399b88(0x339)]()[_0x399b88(0x396)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x18eeac=_0x1f002e,_0x1ed0df=shiftedTime();return _0x1ed0df['getFullYear']()+(_0x1ed0df['getMonth']()+0x1)[_0x18eeac(0x396)]()[_0x18eeac(0x32b)](0x2,'0')+_0x1ed0df[_0x18eeac(0x204)]()[_0x18eeac(0x396)]()[_0x18eeac(0x32b)](0x2,'0')+'-'+_0x1ed0df[_0x18eeac(0x27b)]()[_0x18eeac(0x396)]()[_0x18eeac(0x32b)](0x2,'0')+_0x1ed0df[_0x18eeac(0x226)]()[_0x18eeac(0x396)]()[_0x18eeac(0x32b)](0x2,'0')+_0x1ed0df[_0x18eeac(0x339)]()[_0x18eeac(0x396)]()[_0x18eeac(0x32b)](0x2,'0');}function shiftedTime(){const _0x3a3ff3=_0x1f002e,_0x3d13af=new Date();let _0x2d73e1=_0x3d13af;if(settings[_0x3a3ff3(0x1e1)]&&settings['timeshift']!==0x0)_0x2d73e1=fns[_0x3a3ff3(0x261)](_0x3d13af,{'hours':settings[_0x3a3ff3(0x1e1)]});return _0x2d73e1;}function startScheduler(){const _0xf027be=_0x1f002e,_0x3b8a5f=new Date()[_0xf027be(0x376)](),_0x41fd2d=shiftedTime()[_0xf027be(0x27b)]();_0x41fd2d==0x4&&backupConfigFiles();_0x41fd2d==0x0&&rotateLogFiles();_0x3b8a5f%0x6==0x0&&triggerAnalytics();_0x3b8a5f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1ed67e){const _0x414223=_0x1f002e;logger[_0x414223(0x3c1)](_0x414223(0x30f)+_0x1ed67e);const _0x4427e3=getBotsWithMode();_0x4427e3[_0x414223(0x216)]>0x0?confirmRestore(configbackuppath,_0x1ed67e):unzipFile(configbackuppath,_0x1ed67e);}async function getBackupFiles(_0x1ef9d8=null){const _0x45cdf5=_0x1f002e;let _0x3f6374=[],_0x1ce4e2=fs[_0x45cdf5(0x24d)](configbackuppath,{'withFileTypes':!![]});_0x1ce4e2[_0x45cdf5(0x221)]((_0x2aeb95,_0x6d1f36)=>_0x2aeb95[_0x45cdf5(0x331)]<_0x6d1f36[_0x45cdf5(0x331)]?0x1:_0x6d1f36[_0x45cdf5(0x331)]<_0x2aeb95['name']?-0x1:0x0),_0x1ce4e2[_0x45cdf5(0x1e8)](_0xc2a919=>{const _0x553d32=_0x45cdf5;if(!_0xc2a919['isDirectory']()&&_0xc2a919[_0x553d32(0x331)][_0x553d32(0x1f1)](_0x553d32(0x29f))&&_0xc2a919[_0x553d32(0x331)][_0x553d32(0x305)](_0x553d32(0x375))){const _0x45a36e=formatDate(fs[_0x553d32(0x21d)](configbackuppath+_0xc2a919['name'])[_0x553d32(0x362)]);_0x3f6374[_0x553d32(0x2f3)]({'name':_0xc2a919[_0x553d32(0x331)],'mtime':_0x45a36e});}});if(_0x1ef9d8)io['to'](_0x1ef9d8)['emit'](_0x45cdf5(0x2ac),_0x3f6374);else return _0x3f6374;}async function backupConfigFiles(){const _0x2b16fc=_0x1f002e;await zipFiles(_0x2b16fc(0x3ba));const _0x1551be=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x2b16fc(0x29f)+_0x1551be+_0x2b16fc(0x375)));let _0x541a8a=fs[_0x2b16fc(0x24d)](configbackuppath,{'withFileTypes':!![]});_0x541a8a['sort']((_0x44e1bb,_0x584278)=>_0x44e1bb[_0x2b16fc(0x331)]<_0x584278['name']?0x1:_0x584278[_0x2b16fc(0x331)]<_0x44e1bb[_0x2b16fc(0x331)]?-0x1:0x0),_0x541a8a[_0x2b16fc(0x216)]>maxBackups&&fs[_0x2b16fc(0x33d)](configbackuppath+_0x541a8a[_0x541a8a[_0x2b16fc(0x216)]-0x1]['name']);}function rotateLogFiles(){const _0x492235=_0x1f002e,_0x3aebe0=fs['statSync'](logspath+_0x492235(0x2fb)),_0x45f11e=_0x3aebe0[_0x492235(0x22a)]/0x400;if(_0x45f11e>0x64){let _0xf11a27=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0xf11a27['sort']((_0x3f3702,_0x36439c)=>_0x3f3702['name']<_0x36439c[_0x492235(0x331)]?0x1:_0x36439c[_0x492235(0x331)]<_0x3f3702[_0x492235(0x331)]?-0x1:0x0),_0xf11a27['forEach'](_0x332356=>{const _0x4972fd=_0x492235;if(_0x332356[_0x4972fd(0x331)]=='output-002.log')fs[_0x4972fd(0x36f)](logspath+_0x332356[_0x4972fd(0x331)],logspath+'output-003.log');if(_0x332356[_0x4972fd(0x331)]==_0x4972fd(0x2fa))fs[_0x4972fd(0x36f)](logspath+_0x332356['name'],logspath+_0x4972fd(0x2f4));_0x332356['name']=='output-000.log'&&(fs[_0x4972fd(0x36f)](logspath+_0x332356[_0x4972fd(0x331)],logspath+_0x4972fd(0x2fa)),fs[_0x4972fd(0x30a)](logspath+_0x332356[_0x4972fd(0x331)],''));});}}async function zipFiles(_0x5065cc){const _0x3fe63e=_0x1f002e;let _0x4e1b26;if(_0x5065cc==_0x3fe63e(0x220))_0x4e1b26=logspath;if(_0x5065cc==_0x3fe63e(0x385))_0x4e1b26=configpath;if(_0x5065cc==_0x3fe63e(0x3ba))_0x4e1b26=configpath;let _0x34f8eb=fs[_0x3fe63e(0x24d)](_0x4e1b26,{'withFileTypes':!![]});const _0x53d8b8=new require(_0x3fe63e(0x23b))();_0x34f8eb[_0x3fe63e(0x1e8)](_0x3c9da5=>{const _0x51c79a=_0x3fe63e;if(!_0x3c9da5['isDirectory']()){let _0xd3229d=fs['readFileSync'](_0x4e1b26+_0x3c9da5[_0x51c79a(0x331)]);if(_0x5065cc==_0x51c79a(0x385)){const _0x425b57=/^bot-[0-9]{3}-config.json$/,_0x43204e=_0x425b57[_0x51c79a(0x2f5)](_0x3c9da5[_0x51c79a(0x331)]);if(_0x43204e){const _0x40cb1d=JSON[_0x51c79a(0x2e4)](_0xd3229d);if(_0x40cb1d[_0x51c79a(0x2a4)][0x0]){_0x40cb1d[_0x51c79a(0x2a4)][0x0]['apiKey']='***',_0x40cb1d[_0x51c79a(0x2a4)][0x0]['apiSecret']=_0x51c79a(0x291);if(_0x40cb1d['bot'][0x0][_0x51c79a(0x29b)])_0x40cb1d[_0x51c79a(0x2a4)][0x0][_0x51c79a(0x29b)]=_0x51c79a(0x291);}_0xd3229d=JSON[_0x51c79a(0x31e)](_0x40cb1d,null,0x2);}if(_0x3c9da5[_0x51c79a(0x331)]==_0x51c79a(0x219)){const _0x3442ff=JSON['parse'](_0xd3229d);if(_0x3442ff[_0x51c79a(0x320)][_0x51c79a(0x2a6)])_0x3442ff[_0x51c79a(0x320)][_0x51c79a(0x2a6)]=![];if(_0x3442ff[_0x51c79a(0x320)][_0x51c79a(0x230)])_0x3442ff[_0x51c79a(0x320)][_0x51c79a(0x230)]=_0x51c79a(0x291);if(_0x3442ff[_0x51c79a(0x320)]['telegramToken'])_0x3442ff[_0x51c79a(0x320)][_0x51c79a(0x2fd)]='***';if(_0x3442ff[_0x51c79a(0x320)][_0x51c79a(0x321)])_0x3442ff[_0x51c79a(0x320)]['telegramChatId']=null;_0xd3229d=JSON[_0x51c79a(0x31e)](_0x3442ff,null,0x2);}if(_0x3c9da5[_0x51c79a(0x331)]!=_0x51c79a(0x397))_0x53d8b8[_0x51c79a(0x299)](_0x3c9da5[_0x51c79a(0x331)],_0xd3229d);}else _0x53d8b8[_0x51c79a(0x299)](_0x3c9da5[_0x51c79a(0x331)],_0xd3229d);}});const _0x18650=_0x53d8b8[_0x3fe63e(0x2c6)]({'base64':![],'compression':_0x3fe63e(0x281)});fs[_0x3fe63e(0x30a)](zippath+(_0x5065cc+_0x3fe63e(0x375)),_0x18650,_0x3fe63e(0x35d));}async function unzipFile(_0x39f6f1,_0x107476){const _0x55f21e=_0x1f002e;fs[_0x55f21e(0x24d)](configpath,{'withFileTypes':!![]})['forEach'](_0x183348=>{const _0x9f518c=_0x55f21e;if(!_0x183348[_0x9f518c(0x209)]())fs[_0x9f518c(0x25c)](configpath+_0x183348[_0x9f518c(0x331)]);});const _0x43e71f=fs['readFileSync'](_0x39f6f1+_0x107476,_0x55f21e(0x35d)),_0x7d8c6b=new require(_0x55f21e(0x23b))(_0x43e71f,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x7d8c6b['files'])[_0x55f21e(0x1e8)](_0x1d0051=>{const _0x2776c1=_0x55f21e,_0x1c5a6b=_0x7d8c6b['files'][_0x1d0051];fs[_0x2776c1(0x30a)](configpath+_0x1c5a6b[_0x2776c1(0x331)],_0x1c5a6b['_data']);}),fs[_0x55f21e(0x24d)](temppath,{'withFileTypes':!![]})['forEach'](_0x5a9333=>{const _0x4de39b=_0x55f21e;if(!_0x5a9333[_0x4de39b(0x209)]())fs[_0x4de39b(0x25c)](temppath+_0x5a9333[_0x4de39b(0x331)]);}),logger[_0x55f21e(0x3c1)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x55f21e(0x31a)]({'restore':!![]},_0xae47e0=>{});}async function getPublicIp(){const _0x115616=_0x1f002e;try{const _0x24ca96=await axios[_0x115616(0x2e1)](_0x115616(0x282));publicip=_0x24ca96[_0x115616(0x237)]['ip'];}catch(_0x510de4){}}async function triggerAnalytics(){const _0x2f8e3c=_0x1f002e;if(!publicip)await getPublicIp();const _0xd7bfff=getBotsWithMode();let _0x36310f=0x0;_0xd7bfff['forEach'](_0x16fc04=>{const _0xfbda2f=_0x1851;if(_0x16fc04[_0xfbda2f(0x260)]==='enabled')_0x36310f++;});const _0x4694e9=getBotExchanges();mixpanel[_0x2f8e3c(0x253)](_0x2f8e3c(0x1e4),{'distinct_id':settings[_0x2f8e3c(0x239)],'ip':publicip,'version':serverversion,'numbots':_0xd7bfff[_0x2f8e3c(0x216)],'numbotsenabled':_0x36310f,'exchanges':_0x4694e9});}async function getMessages(){const _0x75440a=_0x1f002e,_0x3ba612='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x135355=new GraphQLClient(_0x3ba612),_0x487a49={'authorization':_0x75440a(0x3b5)},_0x1b6d2a=serverversion[_0x75440a(0x2e0)]('.'),_0x5b2e15=_0x1b6d2a[0x0]+'.'+_0x1b6d2a[0x1],_0x5dc222=Math[_0x75440a(0x2b2)](settings[_0x75440a(0x304)],settings[_0x75440a(0x34a)]),_0x3eeb38={'last':parseInt(_0x5dc222),'bbm':_0x5b2e15},_0x39c979=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1161fa;try{_0x1161fa=await _0x135355['request'](_0x39c979,_0x3eeb38,_0x487a49);}catch(_0x1de524){}if(_0x1161fa&&_0x1161fa[_0x75440a(0x242)]){let _0xc44567=settings[_0x75440a(0x304)];newMessages=[];for(const _0x4ee658 of _0x1161fa[_0x75440a(0x242)]){newMessages[_0x75440a(0x2f3)](_0x4ee658);let _0x2cad82=![];_0x4ee658[_0x75440a(0x1e5)]&&(updateSetting(_0x75440a(0x208),_0x4ee658[_0x75440a(0x1e5)]),_0x2cad82=isNewerVersion(serverversion,_0x4ee658[_0x75440a(0x1e5)])||serverversion==_0x4ee658[_0x75440a(0x1e5)]);if(!_0x2cad82&&_0x4ee658['number']>_0xc44567){if(_0x4ee658[_0x75440a(0x3c7)]===_0x75440a(0x3b0)||serverversion[_0x75440a(0x1f1)](_0x4ee658[_0x75440a(0x3c7)])){let _0x541536=''+_0x4ee658['title']+'\x0a\x0a'+_0x4ee658[_0x75440a(0x35b)];const _0x52d118=await sendTelegramMsg(toTelegramMarkdown(_0x541536),'Markdown');if(_0x52d118)_0xc44567=_0x4ee658[_0x75440a(0x39c)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x75440a(0x304),_0xc44567),emitMessages();}}function emitMessages(){const _0x2cf3ba=_0x1f002e,_0x4d3e5c=settings[_0x2cf3ba(0x34a)];let _0x101439=[];newMessages[_0x2cf3ba(0x1e8)](_0x138c50=>{const _0x2321b4=_0x2cf3ba;_0x138c50[_0x2321b4(0x39c)]>_0x4d3e5c&&_0x101439[_0x2321b4(0x2f3)](_0x138c50);}),_0x101439[_0x2cf3ba(0x216)]>0x0&&getAllClients()[_0x2cf3ba(0x1e8)](_0x5309ea=>{const _0x165b08=_0x2cf3ba;getSocket(_0x5309ea['id'])[_0x165b08(0x244)](_0x165b08(0x35b),_0x101439);});}function confirmMessage(_0x5eb44a){const _0x387b14=_0x1f002e;updateSetting(_0x387b14(0x34a),Number(_0x5eb44a));}function isNewerVersion(_0x1773ed,_0xb38b3d){const _0x49b8bb=_0x1f002e,_0x2fd19c=_0xb38b3d[_0x49b8bb(0x2e0)]('.'),_0x30d4da=_0x1773ed['split']('.');for(var _0x45aeb7=0x0;_0x45aeb7<_0x30d4da[_0x49b8bb(0x216)];_0x45aeb7++){const _0x3ae661=~~_0x30d4da[_0x45aeb7],_0x176c9f=~~_0x2fd19c[_0x45aeb7];if(_0x3ae661>_0x176c9f)return!![];if(_0x3ae661<_0x176c9f)return![];}return![];}function toTelegramMarkdown(_0x68ed10){const _0xd61bb0=_0x1f002e,_0x5576d1=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4fb47b=/\*{2}(.+?)\*{2}/gim;return _0x68ed10=_0x68ed10[_0xd61bb0(0x34d)](_0x5576d1,_0xd61bb0(0x2d3))[_0xd61bb0(0x34d)](_0x4fb47b,'*$1*'),_0x68ed10;}async function validateConfigFile(){const _0x5f07f5=_0x1f002e,_0x5a81b5=dbConfig[_0x5f07f5(0x2e1)]('bots')['sortBy'](_0x5f07f5(0x206))[_0x5f07f5(0x22b)]()||[];if(_0x5a81b5[_0x5f07f5(0x216)]==0x0){let _0x33f661=0x0,_0x5f5bfa=[];const _0x1ee3b5=/^bot-([0-9]{3})-config.json$/,_0x4d12d2=fs[_0x5f07f5(0x24d)](configpath);_0x4d12d2[_0x5f07f5(0x1e8)](_0x12b263=>{const _0x535d1e=_0x5f07f5,_0x45cb00=_0x1ee3b5['exec'](_0x12b263);if(_0x45cb00){const _0x3af859=_0x45cb00[0x1];let _0x57efa9=getBotAttributes(_0x3af859);_0x5f5bfa[_0x535d1e(0x2f3)]({'botID':_0x3af859,'botname':_0x57efa9[_0x535d1e(0x27e)],'status':'disabled','live':_0x535d1e(0x26f)}),_0x33f661++;}}),_0x33f661!=0x0&&(dbConfig[_0x5f07f5(0x2e1)]('bots')[_0x5f07f5(0x30d)](_0x5f5bfa)['write'](),config=_0x5f5bfa,restoredConfigFile=_0x33f661);}}async function restoreConfigNotify(_0x476623){const _0x578059=_0x1f002e;let _0x14059;if(restoredConfigFile==0x1)_0x14059=_0x578059(0x1e9);else _0x14059=_0x578059(0x294);if(_0x476623)io['to']('botmanager')[_0x578059(0x244)]('notification',_0x14059);else{logger[_0x578059(0x390)](_0x578059(0x1f4)),logger[_0x578059(0x390)](_0x14059),logger[_0x578059(0x390)](_0x578059(0x1f4)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x578059(0x27a)]!=_0x578059(0x21a))tgBot[_0x578059(0x21e)](settings[_0x578059(0x321)],_0x578059(0x2a9)+_0x14059)[_0x578059(0x363)](_0x2a989b=>{telegramError(_0x2a989b);});}}function validateCredentials(_0x47506e,_0x49d789){const _0x526472=_0x1f002e;if(_0x47506e[_0x526472(0x34f)]==settings[_0x526472(0x2db)]&&bcrypt[_0x526472(0x2b3)](_0x47506e[_0x526472(0x38b)],settings['bbPassword'])){if(settings[_0x526472(0x3b9)])return{'allow':![],'reason':_0x526472(0x255),'token':null};else{const _0x455084=generateLoginToken(_0x49d789);return{'allow':!![],'reason':_0x526472(0x349),'token':_0x455084};}}else return{'allow':![],'reason':_0x526472(0x3bc),'token':null};}function refreshToken(_0x2aace1){const _0x281ede=_0x1f002e,_0x10ec24=generateLoginToken(_0x2aace1);return{'allow':!![],'reason':_0x281ede(0x349),'token':_0x10ec24};}function validateAccess(_0x544df6,_0x24b243,_0x33bf90){const _0xb468c7=_0x1f002e,_0x3a6f58=_0x33bf90?_0x33bf90:devices[_0x24b243]['ip'];let _0xce0a39;const _0x40e037=_0x442368=>{const _0xcc3eeb=_0x1851;if(settings[_0xcc3eeb(0x2a6)]){if(settings[_0xcc3eeb(0x3b9)]){if(telegram2FaApproved(_0x24b243)){const _0x32d003=generateLoginToken(_0x24b243);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x32d003};}else return{'allow':![],'reason':_0xcc3eeb(0x283),'token':null};}else return _0xce0a39=validToken(_0x442368,_0x24b243),_0xce0a39['hasOwnProperty'](_0xcc3eeb(0x26b))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x442368}:{'allow':![],'reason':_0xcc3eeb(0x283),'token':null};}else return{'allow':!![],'reason':_0xcc3eeb(0x2af),'token':null};};if(settings[_0xb468c7(0x341)]){let _0x519f15=[...settings[_0xb468c7(0x2e9)],_0xb468c7(0x389),'::ffff:127.0.0.1',_0xb468c7(0x1ef)];if(_0x519f15[_0xb468c7(0x22f)](_0x3a6f58))return _0x40e037(_0x544df6);else{_0xce0a39=validToken(_0x544df6,_0x24b243);if(_0xce0a39[_0xb468c7(0x348)](_0xb468c7(0x26b)))return _0x40e037(_0x544df6);else{if(telegramIpApproved(_0x24b243)){const _0x25ffc4=generateToken(_0x24b243);return _0xce0a39=_0x40e037(_0x544df6),_0xce0a39['allow']?{'allow':!![],'reason':_0xb468c7(0x24f),'token':_0x25ffc4}:_0xce0a39;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0xb468c7(0x1e2),'token':null}:{'allow':![],'reason':_0xb468c7(0x20d),'token':null};}}}else return _0x40e037(_0x544df6);}function timelyDecrypt(_0x496a59,_0xd3bbdb=!![]){const _0x394a09=_0x1f002e;if(_0x496a59)try{const _0x3520ea=crypt[_0x394a09(0x1e0)](secure[_0x394a09(0x309)],_0x496a59)[_0x394a09(0x35b)],_0x157cab=_0x3520ea['split']('@')[0x0],_0x5030e5=_0x3520ea[_0x394a09(0x2e0)]('@')[0x1],_0x448341=new Date()['getTime']();if(_0xd3bbdb){if(_0x448341-_0x5030e5<maxSecretAge*0x3e8)return _0x157cab;else return![];}else return _0x157cab;}catch(_0x1fc5d3){return![];}else return![];}const validToken=(_0x53c80d,_0x41faab)=>{const _0x19e7c9=_0x1f002e,_0x199350=devices[_0x41faab]['ip'];if(!_0x53c80d)return{'error':'No\x20authentication\x20token'};for(let _0x2bfdd4 of blacklist){if(_0x2bfdd4['token']==_0x53c80d)return{'error':_0x19e7c9(0x2c1)};}let _0x369182;try{_0x369182=jwt[_0x19e7c9(0x23e)](_0x53c80d,secure['secret']+_0x41faab);}catch{return{'error':_0x19e7c9(0x267)};}if(!_0x369182[_0x19e7c9(0x348)](_0x19e7c9(0x2bb))&&!_0x369182[_0x19e7c9(0x348)](_0x19e7c9(0x34f))||!_0x369182[_0x19e7c9(0x348)](_0x19e7c9(0x36a)))return{'error':_0x19e7c9(0x223)};if(!_0x369182[_0x19e7c9(0x348)](_0x19e7c9(0x34f))&&_0x369182[_0x19e7c9(0x348)](_0x19e7c9(0x2bb))){const {clientip:_0x4e9080}=_0x369182;return _0x199350==_0x4e9080?{'success':_0x19e7c9(0x338)}:{'error':_0x19e7c9(0x355)};}else{if(_0x369182['hasOwnProperty']('username')&&_0x369182[_0x19e7c9(0x348)](_0x19e7c9(0x2bb))){const {username:_0x5ec68d,clientip:_0x1c4891}=_0x369182;return settings['bbUsername']==_0x5ec68d&&_0x199350==_0x1c4891?{'success':_0x19e7c9(0x338)}:{'error':_0x19e7c9(0x2ef)};}}},generateLoginToken=_0x27ae98=>{const _0x41b21b=_0x1f002e;if(_0x27ae98){const _0x388653=devices[_0x27ae98]['ip'];return jwt['sign']({'username':settings[_0x41b21b(0x2db)],'clientip':_0x388653},secure[_0x41b21b(0x1dc)]+_0x27ae98,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x6a1430=>{const _0x4468eb=_0x1f002e;if(_0x6a1430){const _0x3246e0=devices[_0x6a1430]['ip'];return jwt[_0x4468eb(0x3a0)]({'clientip':_0x3246e0},secure['secret']+_0x6a1430,{'expiresIn':devices[_0x6a1430][_0x4468eb(0x201)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x568e31=>{const _0x53258a=_0x1f002e;let _0x1c6f89=![];return devices[_0x568e31][_0x53258a(0x201)]&&devices[_0x568e31][_0x53258a(0x201)][_0x53258a(0x356)]!=_0x53258a(0x31b)&&(_0x1c6f89=devices[_0x568e31][_0x53258a(0x201)]['clientip']==devices[_0x568e31]['ip']&&new Date()[_0x53258a(0x2e6)]()-devices[_0x568e31][_0x53258a(0x201)][_0x53258a(0x29c)]<devices[_0x568e31][_0x53258a(0x201)][_0x53258a(0x356)]*0x3c*0x3e8),_0x1c6f89;},telegram2FaApproved=_0x140cc8=>{const _0x4a7af3=_0x1f002e;let _0x2eb611=![];return devices[_0x140cc8][_0x4a7af3(0x314)]&&devices[_0x140cc8]['telegram2FaApproval'][_0x4a7af3(0x356)]!='reject'&&(_0x2eb611=devices[_0x140cc8][_0x4a7af3(0x314)][_0x4a7af3(0x2bb)]==devices[_0x140cc8]['ip']&&new Date()['getTime']()-devices[_0x140cc8][_0x4a7af3(0x314)][_0x4a7af3(0x29c)]<devices[_0x140cc8][_0x4a7af3(0x314)]['expiry']*0x3c*0x3e8),_0x2eb611;},normalizeIP=_0x502340=>{const _0x4939c9=_0x1f002e;let _0x1fec22=null,_0x162813=null;if(ipaddr['isValid'](_0x502340)){const _0x50a4f6=ipaddr['parse'](_0x502340);_0x50a4f6[_0x4939c9(0x1f2)]()===_0x4939c9(0x251)?(_0x50a4f6[_0x4939c9(0x1f8)]()&&(_0x1fec22=_0x50a4f6[_0x4939c9(0x2ab)]()[_0x4939c9(0x396)]()),_0x162813=_0x50a4f6[_0x4939c9(0x396)]()):(_0x1fec22=_0x50a4f6[_0x4939c9(0x396)](),_0x162813=_0x50a4f6[_0x4939c9(0x2b0)]()[_0x4939c9(0x396)]());}return{'show':_0x1fec22?_0x1fec22:_0x162813,'store':_0x162813};};function formatDate(_0x103c22){const _0x203849=_0x1f002e;return _0x103c22[_0x203849(0x1df)]()+'/'+(_0x103c22['getMonth']()+0x1)[_0x203849(0x396)]()['padStart'](0x2,'0')+'/'+_0x103c22[_0x203849(0x204)]()[_0x203849(0x396)]()['padStart'](0x2,'0')+'\x20'+_0x103c22['getHours']()[_0x203849(0x396)]()['padStart'](0x2,'0')+':'+_0x103c22[_0x203849(0x226)]()['toString']()[_0x203849(0x32b)](0x2,'0')+':'+_0x103c22[_0x203849(0x339)]()['toString']()[_0x203849(0x32b)](0x2,'0');}function sleep(_0x5cf202){return new Promise(_0x4203d7=>setTimeout(_0x4203d7,_0x5cf202));}