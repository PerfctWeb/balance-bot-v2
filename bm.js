const _0x17b685=_0x3e75;(function(_0x15d007,_0x1e34f8){const _0x27ecc3=_0x3e75,_0x53b913=_0x15d007();while(!![]){try{const _0x51f75d=-parseInt(_0x27ecc3(0x36d))/0x1*(-parseInt(_0x27ecc3(0x25c))/0x2)+-parseInt(_0x27ecc3(0x243))/0x3*(parseInt(_0x27ecc3(0x367))/0x4)+-parseInt(_0x27ecc3(0x34d))/0x5+parseInt(_0x27ecc3(0x32f))/0x6*(parseInt(_0x27ecc3(0x2c6))/0x7)+parseInt(_0x27ecc3(0x1d2))/0x8+-parseInt(_0x27ecc3(0x265))/0x9+-parseInt(_0x27ecc3(0x1be))/0xa*(-parseInt(_0x27ecc3(0x200))/0xb);if(_0x51f75d===_0x1e34f8)break;else _0x53b913['push'](_0x53b913['shift']());}catch(_0x3970cd){_0x53b913['push'](_0x53b913['shift']());}}}(_0x54a8,0x8e474));const _0x1b6060=function(){let _0x34a598=!![];return function(_0x3de994,_0x1115ed){const _0x1c52a5=_0x34a598?function(){const _0x4fbb51=_0x3e75;if(_0x1115ed){const _0x1400ee=_0x1115ed[_0x4fbb51(0x362)](_0x3de994,arguments);return _0x1115ed=null,_0x1400ee;}}:function(){};return _0x34a598=![],_0x1c52a5;};}(),_0x5f0c9b=_0x1b6060(this,function(){const _0x56979e=_0x3e75;return _0x5f0c9b[_0x56979e(0x27a)]()[_0x56979e(0x273)](_0x56979e(0x261))[_0x56979e(0x27a)]()[_0x56979e(0x202)](_0x5f0c9b)['search'](_0x56979e(0x261));});_0x5f0c9b();'use strict';process[_0x17b685(0x226)][_0x17b685(0x233)]=0x1;const childProcess=require(_0x17b685(0x1f1)),fs=require('fs'),fns=require(_0x17b685(0x35c)),low=require(_0x17b685(0x2cf)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x17b685(0x222)),crypto=require(_0x17b685(0x1c0)),Crypt=require(_0x17b685(0x31e))['Crypt'],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x17b685(0x214)),jwt=require(_0x17b685(0x208)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x17b685(0x346)]['slice'](0x2))[_0x17b685(0x346)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x17b685(0x246)),Mixpanel=require(_0x17b685(0x2ef)),axios=require(_0x17b685(0x253)),{GraphQLClient,gql}=require(_0x17b685(0x26c)),util=require(_0x17b685(0x35a)),fileUpload=require(_0x17b685(0x301)),{networkInterfaces}=require('os'),PORT=argv[_0x17b685(0x248)]||'3000',pattern=/^[0-9]{2,4}$/;function _0x54a8(){const _0x191961=['function','bots','clientip','readdirSync','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getMinutes','temporaryAccessAllowed','removeAllListeners','auto','live','IPv4','11KOUKRx','login\x20required','constructor','DEFLATE','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','orders','bb/','userid','jsonwebtoken','\x1b[36m','Deleted\x20Bot\x20','telegramChatId','Idling\x20bot\x20\x20\x20|\x20Bot\x20','get-starting-balances','/off\x20-\x20stop\x20bot(s)\x0a','Starting\x20Balance\x20Bot\x20reinstallation','\x20minutes','logs/','update-bot','isDirectory','bcryptjs','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','message','kill','telegramIpApproval','lastmsgemitted','version.json','6b67f3d61ee94b8f5c80b4affef4c4d9','stringify','binary','Starting\x20#RED#Balance\x20Bot\x20v','staging','callback_query','login\x20not\x20required','path','Unauthorized\x20attempt\x20to\x20download\x20','disconnect','join','env','debug','get-messages','Yes','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','enabled','new','socket','toggle-bot-mode','sign','show','output-000.log','store-fiat','NTBA_FIX_319','[ip-address]','number','Starting\x20Balance\x20Bot\x20update','unlinkSync','min','All\x20bots','family','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','storeHeadless','access\x20timeout','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','telegram2FaApproval','Logged\x20in\x20user\x20...','0.0.0','once','183HAvlwI','messages','allow','node-telegram-bot-api','</b>\x20?','port','onepagemode','Starting\x20bot\x20|\x20Bot\x20','telegramEnabled','sockets','reject','Session\x20expired\x20for\x20user\x20...','find','replace','.zip','backup-full.zip','axios','timeshift','http','tkn','15\x20min','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','max','temp/','latestversion','8qWvZEp','length','padStart','f2aRequired','cancel-loading','(((.+)+)+)+$','rmSync','output-002.log','readFileSync','8348886hllBYW','show-config','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','initclient','bb-secure.json','zip/','from','graphql-request','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','/:bot/configuration','Error\x20while\x20deleting\x20config\x20files:\x20','emit','polling_error','search','getSeconds','chat','getFullYear','bbPassword',',\x20must\x20be\x20a\x204\x20digit\x20number','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','toString','resetHistory','\x20>\x20','alerts','password','************','\x20to\x20','/status\x20-\x20show\x20bot(s)\x20status\x0a','User\x20has\x20been\x20validated','file','/:bot/history','build2','split','Invalid\x20Telegram\x20token','Alerts','All','/upload-backup','isIPv4MappedAddress','Unauthorized\x20login\x20attempt\x20(timeout)','sort','sendMessage','exec','sendMetricsTelegram',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20attempt\x20to\x20confirm\x20message','invalid\x20credentials','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','telegramToken','Unauthorized\x20attempt\x20to\x20delete\x20bot','keys','private','Notifications\x20enabled','apiSecret','Restoring\x20bot(s)\x20from\x20backup','files','config/','secure','status','reason','format','backup','name','Node.js\x20v','Unauthorized\x20attempt\x20to\x20get\x20events','#RES#\x20if\x20running\x20on\x20server','init','reinstall','event','emitHistory','notification','/names\x20-\x20show\x20bot\x20names\x0a','reload','args','disabled','temporary\x20access\x20timeout','<b>Telegram\x20Bot\x20Status:</b>\x0a','No\x20authentication\x20token','startsWith','sendFile','settings.','privateKey','login\x20token\x20valid','File\x20uploaded','removeListener','connection','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','remoteAddress','bbvReceive','pidExpireLogin','download','headless','Logged\x20out\x20user\x20...','mode','temporary\x20access\x20rejected','randomBytes','7OhmJLh','update-bb','backup-files','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Notifications\x20disabled\x0a','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','getTime','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','lowdb','manual','endsWith','/:bot/support','HTML','generateKeyPairAsync','data','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','\x1b[35m','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','answerCallbackQuery','size','pidRefreshToken','\x1b[0m','copyFileSync','started','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','toIPv4Address','\x1b[31m','stopPolling','You\x20can\x20use\x20the\x20following\x20commands:\x0a','push','sortBy','Ok,\x20will\x20send\x20alert\x20notifications\x20only','new-disabled','warning','confirm-message','map','settings','Unauthorized\x20attempt\x20to\x20get\x20messages','/on\x20-\x20start\x20bot(s)\x0a','cloneDeep','mixpanel','string','test','store-headless','expiry','existsSync','store-configuration','::ffff:127.0.0.1','showname','/output-000.log','then','Notifications\x20disabled','bbUsername','Markdown','write','apiKey','get','botmanager','express-fileupload','referer','yes','add','forEach','#RES#\x20','login','telegram','publicKey','assign','listen','logout','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','decrypt','getMonth','includes','Unauthorized\x20attempt\x20to\x20log\x20out','clients','inherit','stopped','toggleBotMode','Unauthorized\x20attempt\x20to\x20update\x20bot','backup-full','user','token','/restart\x20-\x20restart\x20bot(s)\x0a','get-backup-files','=>\x20Go\x20to\x20#CYA#http://','connected','hybrid-crypto-js','track','bot','compareSync','RSA-OAEP','SIGINT','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','-config.json','bot-','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','defaults','uuid','host','remove','<b>Balance\x20Bot\x20Status:</b>\x0a','ipv6','-events.json','3372126lTLVkB','*$1*','any','encryptedUuid','Restore\x20backup\x20file\x20','statSync','log','Invalid\x20IP\x20address','static','address','fork','/update\x20-\x20update\x20Balance\x20Bot\x0a','type','updatebotmanager','writeFileSync','request','(staging)','hasOwnProperty','auth','full','getHours','loginRequired','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','argv','bb-settings.json','\x20|\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','slice','Unauthorized\x20attempt\x20to\x20delete\x20alerts','ipc','2426325DjimBh','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','storeFiat','randomFillSync','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','reset-password','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','127.0.0.1','get-logs','store-settings','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','all','Restarting\x20Bot\x20','util','match','date-fns','Allow\x20login\x20from\x20IP\x20address\x20<b>','/disable\x20-\x20disable\x20notifications\x0a','getDate','node','delete-bot','apply','Access\x20enabled\x20for\x20','#RES#\x20if\x20running\x20locally\x0a','2FA\x20login\x20required','index.html','28844lrgsXx','value','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','onText','secret','parse','128195ETwurR','Password\x20has\x20been\x20reset\x20to:\x20','Starting\x20new\x20bot\x20|\x20Bot\x20','send','entries','Unauthorized\x20attempt\x20to\x20add\x20bot','telegrammsg','headers','mkdirSync','order','hashSync','update','login\x20token\x20generated','filter','No\x20bots\x20running\x20right\x20now','backup/','place-order','30\x20min','logged\x20out','telegramEvents','***','stop','blacklist','Enabled\x20Bot\x20','catch','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','use','backupfile','environment','title','-----------------------------------------------------------------------------------','temporary\x20token\x20generated','exp','uncaughtException','success','5342660joXlWi','2FA\x20login\x20token\x20generated','crypto','/download/:type','placeOrder','sendPortfolioTelegram','Invalid\x20authentication\x20token\x20(2)','Restore\x20process\x20aborted','5\x20min','backup-full@','telegramUsername','Failed\x20to\x20download\x20','get-portfolio',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','All\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','internal','username','simple','timestamp','6611960QhfUno','botID','handshake','/:bot','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','range','bbvNew','restart','Token\x20blacklisted','Bot\x20','-results.json','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','reinstall-bb','Ok,\x20will\x20send\x20order\x20notifications\x20only','node-zip','running','Your\x20installation\x20is\x20already\x20up\x20to\x20date','-performance.json','\x20mode','botname','params','reset-history','exit','/:bot/performance','production','whitelist','access','\x20only\x0a','lastmsgtelegram','api-eu.mixpanel.com','store','child_process','apiPassword','build','output-001.log'];_0x54a8=function(){return _0x191961;};return _0x54a8();}!pattern[_0x17b685(0x2f1)](PORT)&&(console[_0x17b685(0x335)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x17b685(0x278)),process['exit'](0x1));const HOST=argv[_0x17b685(0x32a)]||null,userID=argv[_0x17b685(0x318)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x17b685(0x360)];let bbpath=_0x17b685(0x206),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x17b685(0x347),securefile=_0x17b685(0x269),environment=require('./'+bbpath2+_0x17b685(0x21a))[_0x17b685(0x1b7)]||_0x17b685(0x1ea),maxBackups=0xa;let validInstallation=!![];!fs[_0x17b685(0x2f4)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x17b685(0x312)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x17b685(0x29e),configbackuppath=configpath+_0x17b685(0x1aa),logspath=userID?bbpath+_0x17b685(0x211)+userID+'/':bbpath+_0x17b685(0x211),zippath=userID?bbpath+_0x17b685(0x26a)+userID+'/':bbpath+_0x17b685(0x26a),loggerfile=fs['createWriteStream'](logspath+_0x17b685(0x2f8),{'flags':'a'}),temppath=userID?bbpath+_0x17b685(0x25a)+userID+'/':bbpath+'temp/';!fs[_0x17b685(0x2f4)](configpath)&&fs[_0x17b685(0x1a3)](configpath);!fs[_0x17b685(0x2f4)](configbackuppath)&&fs[_0x17b685(0x1a3)](configbackuppath);!fs[_0x17b685(0x2f4)](logspath)&&fs[_0x17b685(0x1a3)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs[_0x17b685(0x1a3)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x17b685(0x328)]({'bots':[]})[_0x17b685(0x2fd)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x17b685(0x328)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x17b685(0x241),'onepagemode':![]}})[_0x17b685(0x2fd)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x17b685(0x328)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x17b685(0x322)});const saltRounds=0xa,mixpanel=Mixpanel[_0x17b685(0x2a8)](_0x17b685(0x21b),{'host':_0x17b685(0x1ef)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x17b685(0x296)]&&settings['telegramToken']!=''&&settings[_0x17b685(0x1c8)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x1e8d8e,_0x532082)=>{const _0x1919e3=_0x17b685,_0x2ec5e0=/#[A-Z]{3}#/g;if(typeof _0x1e8d8e==_0x1919e3(0x2f0)){!_0x532082?_0x1e8d8e=_0x1e8d8e[_0x1919e3(0x250)](_0x2ec5e0,''):(_0x1e8d8e=_0x1e8d8e[_0x1919e3(0x250)](/#BLU#/g,'\x1b[34m'),_0x1e8d8e=_0x1e8d8e[_0x1919e3(0x250)](/#RED#/g,_0x1919e3(0x2e1)),_0x1e8d8e=_0x1e8d8e['replace'](/#YEL#/g,'\x1b[33m'),_0x1e8d8e=_0x1e8d8e[_0x1919e3(0x250)](/#MAG#/g,_0x1919e3(0x2d7)),_0x1e8d8e=_0x1e8d8e[_0x1919e3(0x250)](/#CYA#/g,_0x1919e3(0x209)),_0x1e8d8e=_0x1e8d8e[_0x1919e3(0x250)](/#RES#/g,_0x1919e3(0x2dc)));;}return _0x1e8d8e;},logger={'screen':_0x15cfb6=>{const _0x3f66c9=_0x17b685;console[_0x3f66c9(0x335)](parseColor(_0x15cfb6,!![]));},'simple':_0xb9e54e=>{const _0x1ec8e6=_0x17b685;console['log'](parseColor(_0xb9e54e,!![])),loggerfile['write'](util[_0x1ec8e6(0x2a2)](parseColor(_0xb9e54e,![]))+'\x0a');},'full':async _0x130bb2=>{const _0x1a14fa=_0x17b685,_0x4d6f61=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x130bb2;console[_0x1a14fa(0x335)](parseColor(_0x4d6f61,!![])),loggerfile[_0x1a14fa(0x2fd)](util[_0x1a14fa(0x2a2)](parseColor(_0x4d6f61,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x1a14fa(0x1ae)]!='orders')await tgBot['sendMessage'](settings[_0x1a14fa(0x20b)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x130bb2,![]))[_0x1a14fa(0x1b3)](_0x5340d6=>{telegramError(_0x5340d6);});},'debug':async(_0x3fa0bb,_0x53a1e3='')=>{const _0x48e0c7=_0x17b685,_0x75baf1=getTimeStamp()+_0x48e0c7(0x1cb)+_0x3fa0bb;if(debugging)console['log'](parseColor(_0x75baf1,!![]));loggerfile['write'](util[_0x48e0c7(0x2a2)](parseColor(_0x75baf1,![]))+'\x0a');if(_0x53a1e3){if(debugging)console['log'](_0x53a1e3);loggerfile[_0x48e0c7(0x2fd)](util[_0x48e0c7(0x2a2)](_0x53a1e3)+'\x0a');}}};process['on'](_0x17b685(0x1bc),function(_0xcf7e59){const _0x194916=_0x17b685;logger[_0x194916(0x1d0)](_0xcf7e59);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x17b685(0x255))['createServer'](app);app[_0x17b685(0x1b5)](fileUpload({'useTempFiles':!![]})),app[_0x17b685(0x2ff)](_0x17b685(0x1c1),async(_0x22ad5d,_0x3d6109)=>{const _0x2ed1d9=_0x17b685,_0x5b597c=_0x22ad5d[_0x2ed1d9(0x1e6)]['type'],_0x3136a4=getClientsWithBotID(_0x2ed1d9(0x300)),_0x3aef6d=_0x22ad5d[_0x2ed1d9(0x1a2)]['uuid'],_0x416727=timelyDecrypt(_0x3aef6d,![]),_0x1edc5f=_0x3136a4['find'](_0x1be75a=>_0x1be75a[_0x2ed1d9(0x329)]==_0x416727);if(_0x1edc5f){const _0x12f7af=normalizeIP(_0x22ad5d[_0x2ed1d9(0x22d)][_0x2ed1d9(0x2bd)])[_0x2ed1d9(0x1f0)],_0x596252=_0x22ad5d[_0x2ed1d9(0x1a2)]['tkn'];if(validateAccess(_0x596252,_0x416727,_0x12f7af)['allow'])_0x5b597c==_0x2ed1d9(0x2a3)&&await backupConfigFiles(),await zipFiles(_0x5b597c),_0x3d6109[_0x2ed1d9(0x2c0)](zippath+(_0x5b597c+_0x2ed1d9(0x251)),_0x1cb59d=>{const _0x20a157=_0x2ed1d9;_0x1cb59d&&(logger[_0x20a157(0x342)](_0x20a157(0x1c9)+_0x5b597c),logger[_0x20a157(0x1d0)](_0x1cb59d));});else logger['full'](_0x2ed1d9(0x223)+_0x5b597c+'\x20(1)');}else logger[_0x2ed1d9(0x342)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x5b597c+'\x20(2)');}),app['post'](_0x17b685(0x28a),async(_0x3391b3,_0x32d607)=>{const _0x3d5174=_0x17b685,_0x31b3e0=getClientsWithBotID(_0x3d5174(0x300)),_0x15add0=_0x3391b3['headers']['uuid'],_0x8eaa9d=timelyDecrypt(_0x15add0,![]),_0x1c90b7=_0x31b3e0[_0x3d5174(0x24f)](_0xa77f55=>_0xa77f55[_0x3d5174(0x329)]==_0x8eaa9d);logger[_0x3d5174(0x227)]('Backup\x20file\x20uploaded');if(_0x1c90b7){const _0x2249e3=normalizeIP(_0x3391b3[_0x3d5174(0x22d)][_0x3d5174(0x2bd)])[_0x3d5174(0x1f0)],_0x412e29=_0x3391b3['headers'][_0x3d5174(0x256)];if(validateAccess(_0x412e29,_0x8eaa9d,_0x2249e3)[_0x3d5174(0x245)]){if(_0x3391b3[_0x3d5174(0x29d)]){const _0x229f75=_0x3391b3[_0x3d5174(0x29d)][_0x3d5174(0x1b6)];await _0x229f75['mv'](temppath+_0x229f75[_0x3d5174(0x2a4)]),_0x32d607[_0x3d5174(0x370)]({'status':!![],'message':_0x3d5174(0x2b9)});const _0xf05fcf=getBotsWithMode();_0xf05fcf['length']>0x0?confirmRestore(temppath,_0x229f75[_0x3d5174(0x2a4)]):unzipFile(temppath,_0x229f75[_0x3d5174(0x2a4)]);}}else logger['full'](_0x3d5174(0x204));}else logger[_0x3d5174(0x342)](_0x3d5174(0x345));}),app[_0x17b685(0x1b5)](express[_0x17b685(0x337)](path['join'](__dirname,bbpath2,'build2'))),app[_0x17b685(0x1b5)](express[_0x17b685(0x337)](path['join'](__dirname,bbpath2,'build'))),app[_0x17b685(0x2ff)]('/',function(_0xb3ad51,_0x5ab70e){const _0x2ffb49=_0x17b685;_0x5ab70e[_0x2ffb49(0x2b5)](path[_0x2ffb49(0x225)](__dirname,bbpath2,_0x2ffb49(0x285),_0x2ffb49(0x366)));}),app['get'](_0x17b685(0x1d5),function(_0x29df0e,_0x4d5e0c){const _0x221d2e=_0x17b685;_0x4d5e0c['sendFile'](path[_0x221d2e(0x225)](__dirname,bbpath2,_0x221d2e(0x1f3),_0x221d2e(0x366)));}),app[_0x17b685(0x2ff)]('/:bot/portfolio',(_0x49cd7b,_0x391f20)=>{const _0x14a38a=_0x17b685;_0x391f20['sendFile'](path[_0x14a38a(0x225)](__dirname,bbpath2,'build','index.html'));}),app[_0x17b685(0x2ff)](_0x17b685(0x1e9),(_0x57831c,_0x370f27)=>{const _0x5da31d=_0x17b685;_0x370f27[_0x5da31d(0x2b5)](path[_0x5da31d(0x225)](__dirname,bbpath2,_0x5da31d(0x1f3),_0x5da31d(0x366)));}),app[_0x17b685(0x2ff)]('/:bot/coins',(_0x318d6d,_0x38fa44)=>{const _0x1b96de=_0x17b685;_0x38fa44[_0x1b96de(0x2b5)](path[_0x1b96de(0x225)](__dirname,bbpath2,_0x1b96de(0x1f3),_0x1b96de(0x366)));}),app[_0x17b685(0x2ff)](_0x17b685(0x284),(_0x3bce5a,_0x12d3e2)=>{const _0x180b22=_0x17b685;_0x12d3e2[_0x180b22(0x2b5)](path[_0x180b22(0x225)](__dirname,bbpath2,'build',_0x180b22(0x366)));}),app[_0x17b685(0x2ff)](_0x17b685(0x26f),(_0x212dfa,_0xbe99b5)=>{const _0x53073c=_0x17b685;_0xbe99b5[_0x53073c(0x2b5)](path['join'](__dirname,bbpath2,_0x53073c(0x1f3),_0x53073c(0x366)));}),app['get'](_0x17b685(0x2d2),(_0x453342,_0x491edd)=>{const _0x594f5a=_0x17b685;_0x491edd[_0x594f5a(0x2b5)](path['join'](__dirname,bbpath2,_0x594f5a(0x1f3),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x17b685(0x30b)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x44fcb5=_0x17b685;let _0x155b05=_0x44fcb5(0x234);const _0x4eb5dc=networkInterfaces(),_0x16e128={};for(const _0xa13eb2 of Object[_0x44fcb5(0x298)](_0x4eb5dc)){for(const _0x1adfb4 of _0x4eb5dc[_0xa13eb2]){if((_0x1adfb4[_0x44fcb5(0x23a)]==_0x44fcb5(0x1ff)||_0x1adfb4['family']==0x4)&&!_0x1adfb4[_0x44fcb5(0x1ce)]){const _0x173111=ipaddr[_0x44fcb5(0x36c)](_0x1adfb4[_0x44fcb5(0x338)])[_0x44fcb5(0x1d7)]();_0x173111!=_0x44fcb5(0x299)&&(!_0x16e128[_0xa13eb2]&&(_0x16e128[_0xa13eb2]=[]),_0x16e128[_0xa13eb2][_0x44fcb5(0x2e4)](_0x1adfb4[_0x44fcb5(0x338)]),_0x155b05=_0x1adfb4[_0x44fcb5(0x338)]);}}}return{'serverip':_0x155b05,'netinterfaces':_0x16e128};}async function startServer(){const _0x5b1c77=_0x17b685,{serverip:_0x1bb8a9,netinterfaces:_0x54bfd6}=getServerIP();logger[_0x5b1c77(0x1d0)](''),logger[_0x5b1c77(0x1d0)](_0x5b1c77(0x1b9)),await logger['full'](_0x5b1c77(0x21e)+serverversion+_0x5b1c77(0x306)+(environment==_0x5b1c77(0x21f)?_0x5b1c77(0x33f):'')+'\x0a'+(_0x5b1c77(0x279)+PORT+_0x5b1c77(0x364))+(_0x5b1c77(0x31c)+_0x1bb8a9+':'+PORT+_0x5b1c77(0x2a7))),logger[_0x5b1c77(0x1d0)](_0x5b1c77(0x1b9));if(config[_0x5b1c77(0x25d)]!=0x0)for(const _0x133228 of config){if(_0x133228[_0x5b1c77(0x2a0)]=='enabled'||_0x133228['status']==_0x5b1c77(0x22c))await logger['full'](_0x5b1c77(0x24a)+_0x133228['botID']+_0x5b1c77(0x348)+_0x133228[_0x5b1c77(0x1e5)]),startBot([_0x133228[_0x5b1c77(0x1d3)],userID],{'cwd':bbpath},function(_0x3bdad3){const _0x194392=_0x5b1c77;if(_0x3bdad3)logger[_0x194392(0x342)](_0x3bdad3);});else(_0x133228['status']==_0x5b1c77(0x2b0)||_0x133228[_0x5b1c77(0x2a0)]=='new-disabled')&&await logger['full'](_0x5b1c77(0x20c)+_0x133228[_0x5b1c77(0x1d3)]+_0x5b1c77(0x348)+_0x133228[_0x5b1c77(0x1e5)]);}else!newBot&&logger[_0x5b1c77(0x1d0)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x5b1c77(0x1d0)]('-----------------------------------------------------------------------------------'),logger[_0x5b1c77(0x1d0)](''),await logger[_0x5b1c77(0x227)](_0x5b1c77(0x2a5)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x54bfd6);}function startSocket(){const _0x14b7f3=_0x17b685;io['on'](_0x14b7f3(0x2bb),_0x5118a1=>{const _0x312081=_0x14b7f3;let _0x3ec48d,_0x1a37de,_0xc4864f,_0x3f3f59,_0x38ad33;const _0x27e063=_0x5118a1[_0x312081(0x1d4)][_0x312081(0x1a2)][_0x312081(0x302)];_0x1a37de=_0x27e063[_0x312081(0x35b)](/bot[0-9]{3}/);if(_0x1a37de)_0xc4864f=_0x1a37de[0x0][_0x312081(0x35b)](/[0-9]{3}/);if(_0xc4864f)_0x3ec48d=_0xc4864f[0x0];else _0x3ec48d='botmanager';const _0x259404=_0x5118a1['handshake'][_0x312081(0x341)][_0x312081(0x332)];if(!_0x259404)_0x5118a1[_0x312081(0x271)]('status',{'publicKey':secure[_0x312081(0x309)]});else{_0x3f3f59=timelyDecrypt(_0x259404,![]);if(!_0x3f3f59)_0x5118a1['emit'](_0x312081(0x2a0),{'publicKey':secure[_0x312081(0x309)]});else{_0x38ad33=normalizeIP(_0x5118a1['conn'][_0x312081(0x2bd)])['store'];if(!devices[_0x3f3f59])devices[_0x3f3f59]={'uuid':_0x3f3f59,'access':{'token':null}};devices[_0x3f3f59]['ip']=_0x38ad33;const _0x50fa6f=addClient(_0x5118a1['id'],_0x3f3f59,_0x3ec48d);setAccess(_0x50fa6f),emitMessages(),_0x5118a1['on'](_0x312081(0x307),_0x25d1b9=>{const _0x2d696f=_0x312081,_0x4206f0=timelyDecrypt(_0x25d1b9[_0x2d696f(0x27e)]);if(_0x4206f0){_0x25d1b9={'username':_0x25d1b9[_0x2d696f(0x1cf)],'password':_0x4206f0},devices[_0x3f3f59][_0x2d696f(0x1ec)]=validateCredentials(_0x25d1b9,_0x3f3f59);if(devices[_0x3f3f59][_0x2d696f(0x1ec)][_0x2d696f(0x245)]==![]&&devices[_0x3f3f59][_0x2d696f(0x1ec)][_0x2d696f(0x2a1)]==_0x2d696f(0x365))_0x5118a1[_0x2d696f(0x271)](_0x2d696f(0x2a0),{'access':devices[_0x3f3f59][_0x2d696f(0x1ec)]}),loginAccess2FA(_0x3f3f59,_0x38ad33);else{if(devices[_0x3f3f59][_0x2d696f(0x1ec)][_0x2d696f(0x245)]==![]&&devices[_0x3f3f59][_0x2d696f(0x1ec)][_0x2d696f(0x2a1)]==_0x2d696f(0x294))_0x5118a1[_0x2d696f(0x271)]('status',{'access':devices[_0x3f3f59]['access']});else devices[_0x3f3f59][_0x2d696f(0x1ec)]['allow']&&devices[_0x3f3f59][_0x2d696f(0x1ec)]['reason']==_0x2d696f(0x1a7)&&(getClientsWithUuid(_0x3f3f59)[_0x2d696f(0x305)](_0x1b29f5=>{setAccess(_0x1b29f5);}),logger['debug'](_0x2d696f(0x240)+_0x3f3f59['slice'](-0x8)),setTokenRefresh(_0x3f3f59),setSessionTimeout(_0x2d696f(0x307),_0x3f3f59));}}else logger['full'](_0x2d696f(0x28c));}),_0x5118a1['on'](_0x312081(0x352),()=>{resetPassword();}),_0x5118a1['on'](_0x312081(0x224),_0x412ecf=>{removeClient(_0x5118a1['id']);}),_0x3ec48d==_0x312081(0x300)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1a12ef){const _0x41fce7=_0x17b685;if(_0x1a12ef!=_0x41fce7(0x300)&&config['apiKey']!=''){if(pid[_0x1a12ef])pid[_0x1a12ef][_0x41fce7(0x370)]({'function':_0x41fce7(0x268),'args':null});}_0x1a12ef!='botmanager'&&broadcastToBots(_0x41fce7(0x1f6),JSON[_0x41fce7(0x21c)](config));}function reloadBotManager(){const _0x1bc8d3=_0x17b685;getClientsWithBotID('botmanager')[_0x1bc8d3(0x305)](_0x12cecf=>{const _0x5ad24a=_0x1bc8d3;getSocket(_0x12cecf['id'])[_0x5ad24a(0x271)](_0x5ad24a(0x2a0),{'access':{'allow':![],'reason':_0x5ad24a(0x2ae),'token':null}});});}function getSocket(_0x4f67f6){const _0x17ca17=_0x17b685;return io[_0x17ca17(0x24c)][_0x17ca17(0x24c)][_0x17ca17(0x2ff)](_0x4f67f6);}function setAccess(_0x21f30e){const _0x1111e1=_0x17b685,_0x20e5de=getSocket(_0x21f30e['id']),_0x72fe1d=_0x21f30e[_0x1111e1(0x329)],_0x81486e=_0x21f30e[_0x1111e1(0x320)];devices[_0x72fe1d][_0x1111e1(0x1ec)]=validateAccess(devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x319)],_0x72fe1d),logger[_0x1111e1(0x227)]('Setting\x20access:\x20'+devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x2a1)]+'\x20|\x20client:\x20...'+_0x21f30e['id'][_0x1111e1(0x34a)](-0x8)+'\x20|\x20user:\x20...'+_0x72fe1d[_0x1111e1(0x34a)](-0x8)),_0x20e5de[_0x1111e1(0x225)](_0x72fe1d);if(devices[_0x72fe1d][_0x1111e1(0x1ec)]['allow']){_0x20e5de[_0x1111e1(0x225)](_0x81486e);if(_0x81486e=='botmanager')initializeSocketBotManager(_0x20e5de);else initializeSocketBot(_0x20e5de);initClient(_0x81486e);}devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x319)]&&devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x2a1)]==_0x1111e1(0x1ba)&&setSessionTimeout('2FA',_0x72fe1d),devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x319)]&&devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x2a1)]==_0x1111e1(0x1bf)&&setSessionTimeout('login',_0x72fe1d),_0x20e5de[_0x1111e1(0x271)]('status',{'status':_0x21f30e['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x72fe1d][_0x1111e1(0x1ec)],'externalip':devices[_0x72fe1d]['ip'],'publicKey':secure[_0x1111e1(0x309)],'userid':settings[_0x1111e1(0x207)],'validInstallation':validInstallation}),devices[_0x72fe1d][_0x1111e1(0x1ec)][_0x1111e1(0x245)]==![]&&devices[_0x72fe1d]['access']['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x72fe1d,devices[_0x72fe1d]['ip']);}function setSessionTimeout(_0xfe0b25,_0x4e0fbb){const _0x359785=_0x17b685;let _0x6007f3;if(_0xfe0b25==_0x359785(0x307))_0x6007f3=loginExpiry*0x3c*0x3e8;else _0x6007f3=devices[_0x4e0fbb][_0x359785(0x218)][_0x359785(0x2f3)]*0x3c*0x3e8-(new Date()[_0x359785(0x2cc)]()-devices[_0x4e0fbb][_0x359785(0x218)]['timestamp']);if(devices[_0x4e0fbb][_0x359785(0x2bf)])clearTimeout(devices[_0x4e0fbb][_0x359785(0x2bf)]);devices[_0x4e0fbb][_0x359785(0x2bf)]=setTimeout(()=>{const _0x8fa183=_0x359785;if(devices[_0x4e0fbb]['pidRefreshToken'])clearTimeout(devices[_0x4e0fbb]['pidRefreshToken']);removeSocketListeners(_0x4e0fbb),addBlacklist(_0x4e0fbb),devices[_0x4e0fbb][_0x8fa183(0x218)]=null,devices[_0x4e0fbb][_0x8fa183(0x23f)]=null,devices[_0x4e0fbb][_0x8fa183(0x1ec)]['token']=null,logger['debug'](_0x8fa183(0x24e)+_0x4e0fbb['slice'](-0x8)),devices[_0x4e0fbb][_0x8fa183(0x1ec)]=validateAccess(devices[_0x4e0fbb][_0x8fa183(0x1ec)][_0x8fa183(0x319)],_0x4e0fbb),!(devices[_0x4e0fbb]['access'][_0x8fa183(0x245)]&&devices[_0x4e0fbb][_0x8fa183(0x1ec)][_0x8fa183(0x2a1)]==_0x8fa183(0x221))&&(_0xfe0b25=='login'?io['to'](_0x4e0fbb)[_0x8fa183(0x271)](_0x8fa183(0x2a0),{'access':{'allow':![],'reason':_0x8fa183(0x23d),'token':null}}):io['to'](_0x4e0fbb)['emit']('status',{'access':{'allow':![],'reason':_0x8fa183(0x2b1),'token':null}})),devices[_0x4e0fbb]['access'][_0x8fa183(0x319)]=null;},_0x6007f3);}function setTokenRefresh(_0x29f603){const _0x483730=_0x17b685;if(devices[_0x29f603][_0x483730(0x2db)])clearTimeout(devices[_0x29f603][_0x483730(0x2db)]);devices[_0x29f603]['pidRefreshToken']=setTimeout(()=>{const _0x53bc9f=_0x483730;getClientsWithUuid(_0x29f603)['length']!=0x0?(devices[_0x29f603][_0x53bc9f(0x1ec)]=refreshToken(_0x29f603),io['to'](_0x29f603)[_0x53bc9f(0x271)](_0x53bc9f(0x2a0),{'status':_0x53bc9f(0x31d),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x29f603][_0x53bc9f(0x1ec)],'externalip':devices[_0x29f603]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x29f603)):clearTimeout(devices[_0x29f603][_0x53bc9f(0x2db)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x25afcf){const _0x3283a0=_0x17b685,_0x8d3f9b=getClient(_0x25afcf['id'])[_0x3283a0(0x329)];_0x25afcf[_0x3283a0(0x271)]('bots',config),_0x25afcf[_0x3283a0(0x271)](_0x3283a0(0x2eb),cleanSettings()),_0x25afcf['on']('add-bot',_0x578ae8=>{const _0xdfd016=_0x3283a0;if(validateAccess(_0x578ae8,_0x8d3f9b)[_0xdfd016(0x245)])addBot();else logger[_0xdfd016(0x342)](_0xdfd016(0x372));}),_0x25afcf['on'](_0x3283a0(0x212),(_0x3acea2,_0x32e193)=>{const _0x2cf6bd=_0x3283a0;if(validateAccess(_0x32e193,_0x8d3f9b)['allow'])toggleBot(_0x3acea2[_0x2cf6bd(0x1d3)],_0x3acea2[_0x2cf6bd(0x2a0)],_0x3acea2[_0x2cf6bd(0x1fe)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x25afcf['on'](_0x3283a0(0x22e),(_0x13385e,_0x17c55d)=>{const _0x487ac4=_0x3283a0;if(validateAccess(_0x17c55d,_0x8d3f9b)[_0x487ac4(0x245)])toggleBotMode(_0x13385e);else logger[_0x487ac4(0x342)](_0x487ac4(0x316));}),_0x25afcf['on'](_0x3283a0(0x361),(_0x1c37eb,_0x42dbd6)=>{const _0x46f187=_0x3283a0;if(validateAccess(_0x42dbd6,_0x8d3f9b)[_0x46f187(0x245)])deleteBot(_0x1c37eb);else logger['full'](_0x46f187(0x297));}),_0x25afcf['on'](_0x3283a0(0x356),(_0x4d8a83,_0x312e91)=>{const _0x387d3f=_0x3283a0;if(validateAccess(_0x312e91,_0x8d3f9b)[_0x387d3f(0x245)])storeSettings(_0x4d8a83,!![]);else logger[_0x387d3f(0x342)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x25afcf['on'](_0x3283a0(0x2c7),_0x1bc642=>{const _0x24165c=_0x3283a0;if(validateAccess(_0x1bc642,_0x8d3f9b)[_0x24165c(0x245)])updateBB(_0x24165c(0x1a6));else logger[_0x24165c(0x342)](_0x24165c(0x267));}),_0x25afcf['on'](_0x3283a0(0x1de),_0x243ecd=>{const _0x2029bf=_0x3283a0;if(validateAccess(_0x243ecd,_0x8d3f9b)[_0x2029bf(0x245)])updateBB(_0x2029bf(0x2a9));else logger['full'](_0x2029bf(0x1d6));}),_0x25afcf['on'](_0x3283a0(0x31b),_0x4c35c4=>{const _0x7655b6=_0x3283a0;if(validateAccess(_0x4c35c4,_0x8d3f9b)[_0x7655b6(0x245)]){const _0x45ab01=getClient(_0x25afcf['id']);if(_0x45ab01)getBackupFiles(_0x45ab01[_0x7655b6(0x329)]);else logger[_0x7655b6(0x342)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full'](_0x7655b6(0x324));}),_0x25afcf['on']('restore-backup-file',(_0x557ab1,_0x4586a2)=>{const _0x203c33=_0x3283a0;if(validateAccess(_0x4586a2,_0x8d3f9b)[_0x203c33(0x245)])restoreBackupFile(_0x557ab1);else logger[_0x203c33(0x342)](_0x203c33(0x2cd));}),_0x25afcf['on'](_0x3283a0(0x228),_0x5c999c=>{const _0x5c78de=_0x3283a0;if(validateAccess(_0x5c999c,_0x8d3f9b)[_0x5c78de(0x245)])getMessages();else logger['full'](_0x5c78de(0x2ec));}),_0x25afcf['on'](_0x3283a0(0x2e9),(_0x317f0f,_0x1e933a)=>{const _0x3f93f6=_0x3283a0;if(validateAccess(_0x1e933a,_0x8d3f9b)[_0x3f93f6(0x245)])confirmMessage(_0x317f0f);else logger[_0x3f93f6(0x342)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x25afcf['on'](_0x3283a0(0x30c),_0x56f71e=>{const _0x26dcd0=_0x3283a0;if(validateAccess(_0x56f71e,_0x8d3f9b)['allow']){if(devices[_0x8d3f9b][_0x26dcd0(0x2db)])clearTimeout(devices[_0x8d3f9b][_0x26dcd0(0x2db)]);if(devices[_0x8d3f9b][_0x26dcd0(0x2bf)])clearTimeout(devices[_0x8d3f9b][_0x26dcd0(0x2bf)]);removeSocketListeners(getClient(_0x25afcf['id'])[_0x26dcd0(0x329)]),addBlacklist(_0x8d3f9b),devices[_0x8d3f9b][_0x26dcd0(0x218)]=null,devices[_0x8d3f9b][_0x26dcd0(0x23f)]=null,devices[_0x8d3f9b][_0x26dcd0(0x1ec)][_0x26dcd0(0x319)]=null,logger[_0x26dcd0(0x227)](_0x26dcd0(0x2c2)+_0x8d3f9b['slice'](-0x8)),io['to'](getClient(_0x25afcf['id'])['uuid'])[_0x26dcd0(0x271)](_0x26dcd0(0x2a0),{'access':{'allow':![],'reason':_0x26dcd0(0x1ad),'token':null}});}else logger[_0x26dcd0(0x342)](_0x26dcd0(0x311));});}function initializeSocketBot(_0x2a9f83){const _0x3e8c8a=_0x17b685,_0x31e891=getClient(_0x2a9f83['id'])[_0x3e8c8a(0x320)],_0x3e7bbc=getClient(_0x2a9f83['id'])[_0x3e8c8a(0x329)];_0x2a9f83['on'](_0x3e8c8a(0x355),(_0x40d17e,_0x141047)=>{const _0x364c72=_0x3e8c8a;if(validateAccess(_0x141047,_0x3e7bbc)[_0x364c72(0x245)]){if(pid[_0x31e891])pid[_0x31e891][_0x364c72(0x370)]({'function':_0x364c72(0x2ab),'args':_0x40d17e});}else logger[_0x364c72(0x342)](_0x364c72(0x2a6));}),_0x2a9f83['on']('delete-alerts',(_0x39f3df,_0x265dd4)=>{const _0x2712a8=_0x3e8c8a;if(validateAccess(_0x265dd4,_0x3e7bbc)[_0x2712a8(0x245)]){if(pid[_0x31e891])pid[_0x31e891]['send']({'function':'deleteHistoryAlerts','args':_0x39f3df});}else logger[_0x2712a8(0x342)](_0x2712a8(0x34b));}),_0x2a9f83['on'](_0x3e8c8a(0x1ca),(_0x19cc32,_0x2cd4ee)=>{const _0x7bc6ff=_0x3e8c8a;if(validateAccess(_0x2cd4ee,_0x3e7bbc)[_0x7bc6ff(0x245)]){if(pid[_0x31e891])pid[_0x31e891]['send']({'function':'getPortfolio','args':_0x19cc32});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x2a9f83['on'](_0x3e8c8a(0x2f5),(_0xca4d03,_0x3c619a)=>{const _0x1c2953=_0x3e8c8a;if(validateAccess(_0x3c619a,_0x3e7bbc)['allow']){if(pid[_0x31e891])pid[_0x31e891]['send']({'function':'storeConfiguration','args':_0xca4d03});}else logger[_0x1c2953(0x342)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2a9f83['on'](_0x3e8c8a(0x2f2),(_0x4696ec,_0x38694b)=>{const _0x579696=_0x3e8c8a;if(validateAccess(_0x38694b,_0x3e7bbc)['allow']){if(pid[_0x31e891])pid[_0x31e891][_0x579696(0x370)]({'function':_0x579696(0x23c),'args':_0x4696ec});}else logger['full'](_0x579696(0x292));}),_0x2a9f83['on'](_0x3e8c8a(0x232),(_0x2f323b,_0x250a8b)=>{const _0xc72bc3=_0x3e8c8a;if(validateAccess(_0x250a8b,_0x3e7bbc)[_0xc72bc3(0x245)]){if(pid[_0x31e891])pid[_0x31e891]['send']({'function':_0xc72bc3(0x34f),'args':_0x2f323b});}else logger[_0xc72bc3(0x342)](_0xc72bc3(0x26e));}),_0x2a9f83['on'](_0x3e8c8a(0x1e7),_0x54eb48=>{const _0x3164e0=_0x3e8c8a;if(validateAccess(_0x54eb48,_0x3e7bbc)[_0x3164e0(0x245)]){if(pid[_0x31e891])pid[_0x31e891][_0x3164e0(0x370)]({'function':_0x3164e0(0x27b),'args':null});}else logger[_0x3164e0(0x342)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2a9f83['on'](_0x3e8c8a(0x20d),_0x4a34a7=>{const _0x25b88e=_0x3e8c8a;if(validateAccess(_0x4a34a7,_0x3e7bbc)['allow']){if(pid[_0x31e891])pid[_0x31e891][_0x25b88e(0x370)]({'function':'getStartingBalances','args':null});}else logger['full'](_0x25b88e(0x23b));}),_0x2a9f83['on'](_0x3e8c8a(0x1ab),(_0x269876,_0x3fecd8)=>{const _0x6f5dc9=_0x3e8c8a;if(validateAccess(_0x3fecd8,_0x3e7bbc)[_0x6f5dc9(0x245)]){if(pid[_0x31e891])pid[_0x31e891]['send']({'function':_0x6f5dc9(0x1c2),'args':_0x269876});}else logger[_0x6f5dc9(0x342)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x2a9f83['on'](_0x3e8c8a(0x260),_0x2222c2=>{const _0x5dd6bb=_0x3e8c8a;if(validateAccess(_0x2222c2,_0x3e7bbc)[_0x5dd6bb(0x245)]){if(pid[_0x31e891])pid[_0x31e891][_0x5dd6bb(0x370)]({'function':'cancelLoading','args':null});}else logger[_0x5dd6bb(0x342)](_0x5dd6bb(0x2d8));}),_0x2a9f83['on'](_0x3e8c8a(0x266),_0x5bc489=>{const _0xf0dc45=_0x3e8c8a;if(validateAccess(_0x5bc489,_0x3e7bbc)['allow']){if(pid[_0x31e891])pid[_0x31e891][_0xf0dc45(0x370)]({'function':'showConfig','args':null});}else logger[_0xf0dc45(0x342)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2a9f83['on'](_0x3e8c8a(0x2c7),_0x2f1f2f=>{const _0x56743f=_0x3e8c8a;if(validateAccess(_0x2f1f2f,_0x3e7bbc)['allow'])updateBB(_0x56743f(0x1a6));else logger[_0x56743f(0x342)](_0x56743f(0x267));}),_0x2a9f83['on'](_0x3e8c8a(0x228),_0x308e66=>{const _0x156d82=_0x3e8c8a;if(validateAccess(_0x308e66,_0x3e7bbc)[_0x156d82(0x245)])getMessages();else logger[_0x156d82(0x342)](_0x156d82(0x2ec));}),_0x2a9f83['on']('confirm-message',(_0x3ea97f,_0x3397f8)=>{const _0x2caf9b=_0x3e8c8a;if(validateAccess(_0x3397f8,_0x3e7bbc)[_0x2caf9b(0x245)])confirmMessage(_0x3ea97f);else logger['full'](_0x2caf9b(0x293));}),_0x2a9f83['on']('logout',_0x48fb1b=>{const _0x1eb1dc=_0x3e8c8a;if(validateAccess(_0x48fb1b,_0x3e7bbc)['allow']){if(devices[_0x3e7bbc]['pidRefreshToken'])clearTimeout(devices[_0x3e7bbc][_0x1eb1dc(0x2db)]);if(devices[_0x3e7bbc][_0x1eb1dc(0x2bf)])clearTimeout(devices[_0x3e7bbc][_0x1eb1dc(0x2bf)]);removeSocketListeners(getClient(_0x2a9f83['id'])[_0x1eb1dc(0x329)]),addBlacklist(_0x3e7bbc),devices[_0x3e7bbc][_0x1eb1dc(0x218)]=null,devices[_0x3e7bbc][_0x1eb1dc(0x23f)]=null,devices[_0x3e7bbc][_0x1eb1dc(0x1ec)]['token']=null,logger[_0x1eb1dc(0x227)]('Logged\x20out\x20user\x20...'+_0x3e7bbc[_0x1eb1dc(0x34a)](-0x8)),io['to'](getClient(_0x2a9f83['id'])['uuid'])[_0x1eb1dc(0x271)](_0x1eb1dc(0x2a0),{'access':{'allow':![],'reason':_0x1eb1dc(0x1ad),'token':null}});}else logger['full'](_0x1eb1dc(0x311));});}function removeSocketListeners(_0x27f475){const _0x1ba842=_0x17b685;getClientsWithUuid(_0x27f475)[_0x1ba842(0x305)](_0x247a9b=>{const _0x36a6c7=_0x1ba842;getSocket(_0x247a9b['id'])[_0x36a6c7(0x1fc)]();});}function cleanSettings(){const _0x16962f=_0x17b685;let _0x3b6e15=settings;return settings[_0x16962f(0x296)]&&settings['telegramToken']!=''&&(_0x3b6e15={..._0x3b6e15,'telegramToken':_0x16962f(0x27f)}),settings[_0x16962f(0x277)]&&settings['bbPassword']!=''&&(_0x3b6e15={..._0x3b6e15,'bbPassword':_0x16962f(0x27f)}),(settings[_0x16962f(0x277)]&&settings[_0x16962f(0x277)]==_0x16962f(0x1af)||settings[_0x16962f(0x296)]&&settings[_0x16962f(0x296)]=='***')&&(_0x3b6e15={..._0x3b6e15,'restored':{'password':settings['bbPassword']==_0x16962f(0x1af),'telegram':settings['telegramToken']==_0x16962f(0x1af)}}),_0x3b6e15;}async function updateBB(_0x4c3d47){const _0x2752f5=_0x17b685;await backupConfigFiles(),installingUpdate=!![],config[_0x2752f5(0x305)](_0x22882e=>{restartBot(_0x22882e['botID']);});if(_0x4c3d47==_0x2752f5(0x1a6))process[_0x2752f5(0x370)]({'update':!![],'environment':environment},_0x5db8a1=>{});else _0x4c3d47==_0x2752f5(0x2a9)&&process[_0x2752f5(0x370)]({'reinstall':!![],'environment':environment},_0x32634b=>{});}function startBot(_0x108617,_0x2fade0,_0x8db44c){const _0x34bf69=_0x17b685;if(debugging)_0x108617[_0x34bf69(0x2e4)]('-d');let _0x26c35c=![];const _0x1e87b0=_0x108617[0x0];_0x2fade0={..._0x2fade0,'stdio':[_0x34bf69(0x313),_0x34bf69(0x313),_0x34bf69(0x313),_0x34bf69(0x34c)]},pid[_0x1e87b0]=childProcess[_0x34bf69(0x339)](botfile,_0x108617,_0x2fade0),pid[_0x1e87b0]['on'](_0x34bf69(0x216),_0x35d98f=>{const _0x27a03f=_0x34bf69;switch(Object[_0x27a03f(0x298)](_0x35d98f)[0x0]){case _0x27a03f(0x1e5):updateBotName(_0x1e87b0,_0x35d98f[_0x27a03f(0x1e5)]);break;case _0x27a03f(0x33c):updateBotManager();break;case _0x27a03f(0x2a0):updateStatus(_0x1e87b0,_0x35d98f[_0x27a03f(0x2a0)]);break;case _0x27a03f(0x1fe):updateLive(_0x1e87b0,_0x35d98f['live']);break;case _0x27a03f(0x2de):updateLive(_0x1e87b0,_0x35d98f[_0x27a03f(0x2de)]),io['to'](_0x1e87b0)[_0x27a03f(0x271)](_0x27a03f(0x2a0),{'access':{'allow':![],'reason':_0x27a03f(0x2ae),'token':null}});break;case _0x27a03f(0x1b0):_0x35d98f['stop']==_0x27a03f(0x1d9)&&restartBot(_0x1e87b0);_0x35d98f[_0x27a03f(0x1b0)]==_0x27a03f(0x217)&&toggleBot(_0x1e87b0,_0x27a03f(0x2b0),_0x27a03f(0x314));break;case'telegram':sendTelegram(_0x1e87b0,_0x35d98f[_0x27a03f(0x308)]);break;case _0x27a03f(0x373):sendTelegramMsg(_0x35d98f[_0x27a03f(0x373)]);break;case'function':io['to'](_0x1e87b0)[_0x27a03f(0x271)](_0x35d98f[_0x27a03f(0x1f5)],_0x35d98f[_0x27a03f(0x2af)]);break;}}),pid[_0x1e87b0]['on']('error',function(_0x2b0cb6){if(_0x26c35c)return;_0x26c35c=!![],_0x8db44c(_0x2b0cb6);}),pid[_0x1e87b0]['on'](_0x34bf69(0x1e8),async function(_0x2f0a14){const _0x33be21=_0x34bf69;if(installingUpdate)return;if(_0x26c35c)return;_0x26c35c=!![],_0x8db44c(null);const _0x1212ba=dbConfig[_0x33be21(0x2ff)](_0x33be21(0x1f6))[_0x33be21(0x24f)]({'botID':_0x1e87b0})[_0x33be21(0x368)]();_0x1212ba&&(_0x1212ba[_0x33be21(0x2a0)]=='enabled'||_0x1212ba[_0x33be21(0x2a0)]==_0x33be21(0x22c))&&(await sleep(0x3e8),updateLive(_0x1e87b0,'stopped'),logger[_0x33be21(0x342)](_0x33be21(0x359)+_0x1e87b0),startBot([_0x1e87b0,userID],{'cwd':bbpath},function(_0x10a250){const _0x52139a=_0x33be21;if(_0x10a250)logger[_0x52139a(0x342)](_0x10a250);}));});}function stopBot(_0x444004){const _0x4ef248=_0x17b685;getClientsWithBotID(_0x444004)[_0x4ef248(0x305)](_0x2b87fd=>{const _0x150863=_0x4ef248;getSocket(_0x2b87fd['id'])[_0x150863(0x224)](!![]),removeClient(_0x2b87fd['id']);}),pid[_0x444004]&&(pid[_0x444004]['kill'](),pid[_0x444004]=null);}function restartBot(_0x6fb554){const _0x3fa583=_0x17b685;if(pid[_0x6fb554])pid[_0x6fb554][_0x3fa583(0x217)]();}function addBot(){const _0x3729c6=_0x17b685;let _0x35d481;for(let _0x440727=0x1;_0x440727<0x3e9;_0x440727++){_0x35d481=_0x440727[_0x3729c6(0x27a)]()[_0x3729c6(0x25e)](0x3,'0');let _0x4689bb=config[_0x3729c6(0x24f)](_0x8c3e9a=>_0x8c3e9a[_0x3729c6(0x1d3)]==_0x35d481);if(!_0x4689bb)break;}if(_0x35d481==='1000'){logger['full'](_0x3729c6(0x1b4));return;}logger[_0x3729c6(0x342)](_0x3729c6(0x36f)+_0x35d481),dbConfig[_0x3729c6(0x2ff)](_0x3729c6(0x1f6))['push']({'botID':_0x35d481,'botname':_0x3729c6(0x1db)+_0x35d481,'status':_0x3729c6(0x22c),'live':''})['write'](),startBot([_0x35d481,userID],{'cwd':bbpath},function(_0x1fefda){if(_0x1fefda)logger['full'](_0x1fefda);}),config=getConfiguration(),io['to'](_0x3729c6(0x300))['emit'](_0x3729c6(0x1f6),config),broadcastToBots(_0x3729c6(0x1f6),JSON['stringify'](config));}function deleteBot(_0x5b3951){const _0x3352db=_0x17b685;getClientsWithBotID(_0x5b3951)[_0x3352db(0x305)](_0x218772=>{getSocket(_0x218772['id'])['disconnect'](!![]),removeClient(_0x218772['id']);}),dbConfig[_0x3352db(0x2ff)](_0x3352db(0x1f6))[_0x3352db(0x32b)]({'botID':_0x5b3951})[_0x3352db(0x2fd)](),logger['full'](_0x3352db(0x20a)+_0x5b3951),stopBot(_0x5b3951);try{if(fs[_0x3352db(0x2f4)](path['join'](configpath,_0x3352db(0x326)+_0x5b3951+'-config.json')))fs[_0x3352db(0x237)](path[_0x3352db(0x225)](configpath,'bot-'+_0x5b3951+_0x3352db(0x325)));if(fs[_0x3352db(0x2f4)](path[_0x3352db(0x225)](configpath,'bot-'+_0x5b3951+_0x3352db(0x32e))))fs['unlinkSync'](path['join'](configpath,_0x3352db(0x326)+_0x5b3951+_0x3352db(0x32e)));if(fs[_0x3352db(0x2f4)](path[_0x3352db(0x225)](configpath,'bot-'+_0x5b3951+'-performance.json')))fs[_0x3352db(0x237)](path[_0x3352db(0x225)](configpath,_0x3352db(0x326)+_0x5b3951+_0x3352db(0x1e3)));if(fs[_0x3352db(0x2f4)](path['join'](configpath,'bot-'+_0x5b3951+'-results.json')))fs[_0x3352db(0x237)](path[_0x3352db(0x225)](configpath,_0x3352db(0x326)+_0x5b3951+_0x3352db(0x1dc)));}catch(_0x24e1e9){if(_0x24e1e9)logger[_0x3352db(0x342)](_0x3352db(0x270),_0x24e1e9);}config=getConfiguration(),io['to'](_0x3352db(0x300))[_0x3352db(0x271)](_0x3352db(0x1f6),config),broadcastToBots(_0x3352db(0x1f6),JSON[_0x3352db(0x21c)](config));}function toggleBot(_0xba23fd,_0x154b66,_0x514d6c){const _0x2504f6=_0x17b685;dbConfig['get']('bots')[_0x2504f6(0x24f)]({'botID':_0xba23fd})[_0x2504f6(0x30a)]({'status':_0x154b66})[_0x2504f6(0x30a)]({'live':_0x514d6c})[_0x2504f6(0x2fd)]();if(_0x154b66=='enabled'||_0x154b66=='new')logger['full'](_0x2504f6(0x1b2)+_0xba23fd),startBot([_0xba23fd,userID],{'cwd':bbpath},function(_0x5ad738){const _0x5c823f=_0x2504f6;if(_0x5ad738)logger[_0x5c823f(0x342)](_0x5ad738);});else(_0x154b66=='disabled'||_0x154b66==_0x2504f6(0x2e7))&&(logger[_0x2504f6(0x342)]('Disabled\x20Bot\x20'+_0xba23fd),stopBot(_0xba23fd));config=getConfiguration(),io['to']('botmanager')[_0x2504f6(0x271)](_0x2504f6(0x1f6),config),broadcastToBots('bots',JSON[_0x2504f6(0x21c)](config));}function toggleStatus(_0xbc6a88){const _0x5b7d36=_0x17b685;let _0x1e758c=dbConfig['get'](_0x5b7d36(0x1f6))[_0x5b7d36(0x24f)]({'botID':_0xbc6a88})[_0x5b7d36(0x368)](),_0x56128c;if(_0x1e758c[_0x5b7d36(0x2a0)]===_0x5b7d36(0x22b))_0x56128c=_0x5b7d36(0x2b0);else{if(_0x1e758c[_0x5b7d36(0x2a0)]===_0x5b7d36(0x22c))_0x56128c=_0x5b7d36(0x2e7);else{if(_0x1e758c['status']===_0x5b7d36(0x2e7))_0x56128c=_0x5b7d36(0x22c);else{if(_0x1e758c[_0x5b7d36(0x2a0)]===_0x5b7d36(0x2b0))_0x56128c='enabled';}}}return _0x56128c;}function updateStatus(_0x251b5c,_0x842c45){const _0xaf8f46=_0x17b685;dbConfig[_0xaf8f46(0x2ff)](_0xaf8f46(0x1f6))['find']({'botID':_0x251b5c})[_0xaf8f46(0x30a)]({'status':_0x842c45})[_0xaf8f46(0x2fd)](),config=getConfiguration(),io['to'](_0xaf8f46(0x300))[_0xaf8f46(0x271)](_0xaf8f46(0x1f6),config),broadcastToBots(_0xaf8f46(0x1f6),JSON['stringify'](config));}function updateLive(_0x31d46b,_0x1d950a){const _0x676036=_0x17b685;dbConfig[_0x676036(0x2ff)]('bots')[_0x676036(0x24f)]({'botID':_0x31d46b})[_0x676036(0x30a)]({'live':_0x1d950a})[_0x676036(0x2fd)](),config=getConfiguration(),io['to'](_0x676036(0x300))['emit'](_0x676036(0x1f6),config),broadcastToBots(_0x676036(0x1f6),JSON[_0x676036(0x21c)](config));}function updateBotName(_0x543ffa,_0x3f30da){const _0x537ff7=_0x17b685;dbConfig[_0x537ff7(0x2ff)](_0x537ff7(0x1f6))[_0x537ff7(0x24f)]({'botID':_0x543ffa})[_0x537ff7(0x30a)]({'botname':_0x3f30da})[_0x537ff7(0x2fd)](),config=getConfiguration(),io['to'](_0x537ff7(0x300))[_0x537ff7(0x271)](_0x537ff7(0x1f6),config),broadcastToBots(_0x537ff7(0x1f6),JSON['stringify'](config));}function updateBotManager(){const _0x10492d=_0x17b685;config=getConfiguration(),io['to'](_0x10492d(0x300))[_0x10492d(0x271)](_0x10492d(0x1f6),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x364950){const _0x2d0959=_0x17b685;if(pid[_0x364950])pid[_0x364950][_0x2d0959(0x370)]({'function':_0x2d0959(0x315),'args':null});else{const _0x6c1b9f=configpath+_0x2d0959(0x326)+_0x364950+_0x2d0959(0x325),_0x46ea07=fs[_0x2d0959(0x264)](_0x6c1b9f),_0x5bced5=JSON['parse'](_0x46ea07),_0x4bff3e=_0x5bced5[_0x2d0959(0x320)][0x0]['headless'];_0x5bced5[_0x2d0959(0x320)][0x0][_0x2d0959(0x2c1)]=!_0x4bff3e;const _0x43e6a1=JSON[_0x2d0959(0x21c)](_0x5bced5,null,0x2);fs[_0x2d0959(0x33d)](_0x6c1b9f,_0x43e6a1),config=getConfiguration(),io['to'](_0x2d0959(0x300))[_0x2d0959(0x271)](_0x2d0959(0x1f6),config),broadcastToBots('bots',JSON[_0x2d0959(0x21c)](config));}}function telegramError(_0x1a5536){const _0x3f191c=_0x17b685;logger[_0x3f191c(0x1d0)](getTimeStamp()+_0x3f191c(0x291));}function validateTelegram(_0x4c1bed){const _0x16e5b4=_0x17b685;if(_0x4c1bed['from']['username']!=settings[_0x16e5b4(0x1c8)]&&'@'+_0x4c1bed[_0x16e5b4(0x26b)]['username']!=settings[_0x16e5b4(0x1c8)])return tgBot[_0x16e5b4(0x28e)](_0x4c1bed[_0x16e5b4(0x275)]['id'],_0x16e5b4(0x30d),{'parse_mode':'HTML'})['catch'](_0x11a9e1=>{telegramError(_0x11a9e1);}),![];return!![];}async function initTelegram(){const _0x242d97=_0x17b685;if(tgBot)tgBot[_0x242d97(0x2e2)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x242d97(0x296)],{'polling':!![]});let _0x110f51=_0x242d97(0x2e3);_0x110f51+='\x0a',_0x110f51+='/enable\x20-\x20enable\x20notifications\x0a',_0x110f51+=_0x242d97(0x35e),_0x110f51+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x110f51+=_0x242d97(0x31a),_0x110f51+=_0x242d97(0x2ed),_0x110f51+=_0x242d97(0x20e),_0x110f51+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x110f51+=_0x242d97(0x2ad),_0x110f51+=_0x242d97(0x281),_0x110f51+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x110f51+=_0x242d97(0x295),_0x110f51+=_0x242d97(0x33a),_0x110f51+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x110f51+='/help\x20-\x20show\x20available\x20commands\x0a';let _0xae3b82=_0x242d97(0x34e);_0xae3b82+='\x0a',_0xae3b82+=_0x110f51,tgBot['onText'](/\/start/,_0x142861=>{const _0x1ed21f=_0x242d97;if(!validateTelegram(_0x142861))return;if(settings[_0x1ed21f(0x20b)]!=_0x142861[_0x1ed21f(0x275)]['id'])updateSetting(_0x1ed21f(0x20b),_0x142861[_0x1ed21f(0x275)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x142861[_0x1ed21f(0x275)]['id'],_0xae3b82)[_0x1ed21f(0x1b3)](_0x36a86a=>{telegramError(_0x36a86a);});}),tgBot[_0x242d97(0x36a)](/\/enable/,_0x50b4f3=>{const _0x46d935=_0x242d97;if(!validateTelegram(_0x50b4f3))return;if(settings['telegramChatId']!=_0x50b4f3[_0x46d935(0x275)]['id'])updateSetting('telegramChatId',_0x50b4f3[_0x46d935(0x275)]['id']);updateSetting(_0x46d935(0x24b),!![]),tgBot[_0x46d935(0x28e)](_0x50b4f3['chat']['id'],_0x46d935(0x29a))['catch'](_0x5cc581=>{telegramError(_0x5cc581);});}),tgBot[_0x242d97(0x36a)](/\/config/,async _0x5d53d5=>{const _0x19ccd3=_0x242d97;if(!validateTelegram(_0x5d53d5))return;tgBot[_0x19ccd3(0x2ba)]('callback_query'),tgBot[_0x19ccd3(0x28e)](_0x5d53d5[_0x19ccd3(0x275)]['id'],_0x19ccd3(0x215),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x19ccd3(0x288),'callback_data':_0x19ccd3(0x27d)},{'text':_0x19ccd3(0x289),'callback_data':_0x19ccd3(0x358)}]]}})[_0x19ccd3(0x1b3)](_0x51bcd3=>{telegramError(_0x51bcd3);}),tgBot['on']('callback_query',async _0x2eb695=>{const _0x1e6284=_0x19ccd3,_0x5eeefb=_0x2eb695[_0x1e6284(0x2d5)],_0x4bca94=_0x2eb695[_0x1e6284(0x216)];tgBot['answerCallbackQuery'](_0x2eb695['id'])['then'](async()=>{const _0x5e3f2a=_0x1e6284;_0x5eeefb=='orders'&&(updateSetting(_0x5e3f2a(0x1ae),_0x5e3f2a(0x205)),updateSetting(_0x5e3f2a(0x24b),!![]),await tgBot['sendMessage'](_0x4bca94[_0x5e3f2a(0x275)]['id'],_0x5e3f2a(0x1df))['catch'](_0x461cdd=>{telegramError(_0x461cdd);}));_0x5eeefb==_0x5e3f2a(0x27d)&&(updateSetting(_0x5e3f2a(0x1ae),_0x5e3f2a(0x27d)),updateSetting(_0x5e3f2a(0x24b),!![]),await tgBot[_0x5e3f2a(0x28e)](_0x4bca94['chat']['id'],_0x5e3f2a(0x2e6))[_0x5e3f2a(0x1b3)](_0x4db503=>{telegramError(_0x4db503);}));_0x5eeefb==_0x5e3f2a(0x358)&&(updateSetting(_0x5e3f2a(0x1ae),_0x5e3f2a(0x358)),updateSetting(_0x5e3f2a(0x24b),!![]),await tgBot[_0x5e3f2a(0x28e)](_0x4bca94[_0x5e3f2a(0x275)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x32628d=>{telegramError(_0x32628d);}));if(!settings[_0x5e3f2a(0x20b)])tgBot[_0x5e3f2a(0x28e)](_0x4bca94[_0x5e3f2a(0x275)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x5e3f2a(0x1b3)](_0x41219c=>{telegramError(_0x41219c);});}),tgBot[_0x1e6284(0x2ba)](_0x1e6284(0x220));});}),tgBot[_0x242d97(0x36a)](/\/status/,_0x64ad35=>{const _0x159cfa=_0x242d97;if(!validateTelegram(_0x64ad35))return;const _0x237066=getBotsWithMode();let _0x2b73ce=_0x159cfa(0x32c);config[_0x159cfa(0x305)](_0x24ce9b=>{const _0x485a49=_0x159cfa,_0x2e1fb3=_0x237066[_0x485a49(0x24f)](_0x4a71dd=>_0x4a71dd['botID']==_0x24ce9b[_0x485a49(0x1d3)])['mode'];_0x2b73ce+=_0x485a49(0x1db)+_0x24ce9b['botID']+':\x20'+_0x24ce9b[_0x485a49(0x2a0)]+'\x20|\x20'+_0x2e1fb3+'\x20|\x20'+_0x24ce9b['live']+'\x0a';}),_0x2b73ce+='\x0a',_0x2b73ce+=_0x159cfa(0x2b2),_0x2b73ce+=!settings[_0x159cfa(0x24b)]?_0x159cfa(0x2ca):'Notifications\x20enabled\x0a',_0x2b73ce+=settings[_0x159cfa(0x24b)]?settings[_0x159cfa(0x1ae)]==_0x159cfa(0x358)?_0x159cfa(0x2cb):'Notifications\x20types:\x20'+settings[_0x159cfa(0x1ae)]+_0x159cfa(0x1ed):'',tgBot[_0x159cfa(0x28e)](_0x64ad35[_0x159cfa(0x275)]['id'],_0x2b73ce,{'parse_mode':'HTML'})['catch'](_0x43dda3=>{telegramError(_0x43dda3);});}),tgBot[_0x242d97(0x36a)](/\/restart/,_0x2d4616=>{const _0x27447b=_0x242d97;if(!validateTelegram(_0x2d4616))return;tgBot[_0x27447b(0x2ba)](_0x27447b(0x220));const _0x26798b=getEnabledBots();if(_0x26798b[_0x27447b(0x25d)]==0x0)tgBot[_0x27447b(0x28e)](_0x2d4616[_0x27447b(0x275)]['id'],_0x27447b(0x1a9))[_0x27447b(0x1b3)](_0x4218d3=>{telegramError(_0x4218d3);});else{if(_0x26798b['length']>0x1)_0x26798b[_0x27447b(0x2e4)]({'botID':'all'});let _0x37f065=[],_0x1fec58=[];const _0x5aaa43=_0x26798b['length']%0x4==0x0||_0x26798b[_0x27447b(0x25d)]%0x4==0x3||_0x26798b[_0x27447b(0x25d)]%0x3==0x1?0x4:0x3;let _0x16191a=0x0;_0x26798b[_0x27447b(0x305)]((_0x5a6897,_0x3a6b83)=>{const _0xbabdf0=_0x27447b;if(_0x3a6b83%_0x5aaa43==0x0)_0x1fec58=[];_0x1fec58[_0xbabdf0(0x2e4)]({'text':_0x5a6897[_0xbabdf0(0x1d3)]=='all'?'All\x20bots':_0xbabdf0(0x1db)+_0x5a6897[_0xbabdf0(0x1d3)],'callback_data':_0x5a6897[_0xbabdf0(0x1d3)]}),_0x3a6b83%_0x5aaa43==0x0&&(_0x37f065[_0x16191a]=_0x1fec58,_0x16191a++);}),tgBot[_0x27447b(0x28e)](_0x2d4616[_0x27447b(0x275)]['id'],_0x27447b(0x2d6),{'reply_markup':{'inline_keyboard':_0x37f065}})[_0x27447b(0x1b3)](_0x5dd005=>{telegramError(_0x5dd005);}),tgBot['on'](_0x27447b(0x220),async _0x3a3bb5=>{const _0x24485d=_0x27447b,_0x78cd78=_0x3a3bb5['data'],_0x26b7b3=_0x3a3bb5[_0x24485d(0x216)];tgBot[_0x24485d(0x2d9)](_0x3a3bb5['id'])['then'](async()=>{const _0x1fe139=_0x24485d;_0x78cd78==_0x1fe139(0x358)?config[_0x1fe139(0x305)](_0x5889e7=>{const _0x343aff=_0x1fe139;restartBot(_0x5889e7[_0x343aff(0x1d3)]);}):restartBot(_0x78cd78);}),tgBot[_0x24485d(0x2ba)]('callback_query');});}}),tgBot[_0x242d97(0x36a)](/\/on/,_0x1b9bbb=>{const _0x33d206=_0x242d97;if(!validateTelegram(_0x1b9bbb))return;tgBot['removeListener']('callback_query');const _0x1ce3bd=getDisabledBots();if(_0x1ce3bd[_0x33d206(0x25d)]==0x0)tgBot[_0x33d206(0x28e)](_0x1b9bbb[_0x33d206(0x275)]['id'],_0x33d206(0x1cc))['catch'](_0x168da8=>{telegramError(_0x168da8);});else{if(_0x1ce3bd[_0x33d206(0x25d)]>0x1)_0x1ce3bd[_0x33d206(0x2e4)]({'botID':_0x33d206(0x358)});let _0x5602bb=[],_0x1ef715=[];const _0x4feb8b=_0x1ce3bd['length']%0x4==0x0||_0x1ce3bd[_0x33d206(0x25d)]%0x4==0x3||_0x1ce3bd[_0x33d206(0x25d)]%0x3==0x1?0x4:0x3;let _0x150de3=0x0;_0x1ce3bd['forEach']((_0x468ebc,_0x4324d0)=>{const _0x268cc4=_0x33d206;if(_0x4324d0%_0x4feb8b==0x0)_0x1ef715=[];_0x1ef715['push']({'text':_0x468ebc['botID']==_0x268cc4(0x358)?_0x268cc4(0x239):_0x268cc4(0x1db)+_0x468ebc[_0x268cc4(0x1d3)],'callback_data':_0x468ebc[_0x268cc4(0x1d3)]}),_0x4324d0%_0x4feb8b==0x0&&(_0x5602bb[_0x150de3]=_0x1ef715,_0x150de3++);}),tgBot['sendMessage'](_0x1b9bbb[_0x33d206(0x275)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x5602bb}})[_0x33d206(0x1b3)](_0x58de18=>{telegramError(_0x58de18);}),tgBot['on'](_0x33d206(0x220),async _0x5d828e=>{const _0x4b3ed0=_0x33d206,_0xc89681=_0x5d828e['data'],_0x14dbd6=_0x5d828e[_0x4b3ed0(0x216)];tgBot[_0x4b3ed0(0x2d9)](_0x5d828e['id'])['then'](async()=>{const _0x4bff88=_0x4b3ed0;_0xc89681=='all'?(tgBot['sendMessage'](_0x14dbd6['chat']['id'],_0x4bff88(0x26d))[_0x4bff88(0x1b3)](_0x5a5901=>{telegramError(_0x5a5901);}),_0x1ce3bd['forEach'](_0x4d6b66=>{const _0x286b47=_0x4bff88;if(_0x4d6b66[_0x286b47(0x1d3)]!=_0x286b47(0x358))toggleBot(_0x4d6b66['botID'],toggleStatus(_0x4d6b66[_0x286b47(0x1d3)]),_0x286b47(0x314));})):(tgBot[_0x4bff88(0x28e)](_0x14dbd6[_0x4bff88(0x275)]['id'],_0x4bff88(0x2bc)+_0xc89681)[_0x4bff88(0x1b3)](_0x5cbbc9=>{telegramError(_0x5cbbc9);}),toggleBot(_0xc89681,toggleStatus(_0xc89681),_0x4bff88(0x314)));}),tgBot[_0x4b3ed0(0x2ba)](_0x4b3ed0(0x220));});}}),tgBot[_0x242d97(0x36a)](/\/off/,_0x5d39e1=>{const _0x49c697=_0x242d97;if(!validateTelegram(_0x5d39e1))return;tgBot[_0x49c697(0x2ba)](_0x49c697(0x220));const _0x5a08c9=getEnabledBots();if(_0x5a08c9['length']==0x0)tgBot['sendMessage'](_0x5d39e1[_0x49c697(0x275)]['id'],_0x49c697(0x1a9))['catch'](_0x42769d=>{telegramError(_0x42769d);});else{if(_0x5a08c9[_0x49c697(0x25d)]>0x1)_0x5a08c9[_0x49c697(0x2e4)]({'botID':'all'});let _0x4659f0=[],_0x323b97=[];const _0x2a3ada=_0x5a08c9[_0x49c697(0x25d)]%0x4==0x0||_0x5a08c9[_0x49c697(0x25d)]%0x4==0x3||_0x5a08c9['length']%0x3==0x1?0x4:0x3;let _0x13f2e9=0x0;_0x5a08c9[_0x49c697(0x305)]((_0x2d6cc4,_0x5395a0)=>{const _0x24992f=_0x49c697;if(_0x5395a0%_0x2a3ada==0x0)_0x323b97=[];_0x323b97[_0x24992f(0x2e4)]({'text':_0x2d6cc4[_0x24992f(0x1d3)]==_0x24992f(0x358)?_0x24992f(0x239):'Bot\x20'+_0x2d6cc4['botID'],'callback_data':_0x2d6cc4['botID']}),_0x5395a0%_0x2a3ada==0x0&&(_0x4659f0[_0x13f2e9]=_0x323b97,_0x13f2e9++);}),tgBot[_0x49c697(0x28e)](_0x5d39e1[_0x49c697(0x275)]['id'],_0x49c697(0x349),{'reply_markup':{'inline_keyboard':_0x4659f0}})[_0x49c697(0x1b3)](_0x13b37e=>{telegramError(_0x13b37e);}),tgBot['on'](_0x49c697(0x220),async _0x161224=>{const _0x14dad7=_0x49c697,_0x17a14d=_0x161224['data'],_0x37f862=_0x161224['message'];tgBot[_0x14dad7(0x2d9)](_0x161224['id'])[_0x14dad7(0x2f9)](async()=>{const _0x22ef12=_0x14dad7;_0x17a14d==_0x22ef12(0x358)?(tgBot[_0x22ef12(0x28e)](_0x37f862[_0x22ef12(0x275)]['id'],_0x22ef12(0x258))['catch'](_0x5c93c8=>{telegramError(_0x5c93c8);}),_0x5a08c9[_0x22ef12(0x305)](_0x315729=>{const _0x3356e5=_0x22ef12;if(_0x315729[_0x3356e5(0x1d3)]!='all')toggleBot(_0x315729['botID'],toggleStatus(_0x315729[_0x3356e5(0x1d3)]),_0x3356e5(0x314));})):(tgBot['sendMessage'](_0x37f862['chat']['id'],_0x22ef12(0x1cd)+_0x17a14d)[_0x22ef12(0x1b3)](_0x497a61=>{telegramError(_0x497a61);}),toggleBot(_0x17a14d,toggleStatus(_0x17a14d),_0x22ef12(0x314)));}),tgBot[_0x14dad7(0x2ba)](_0x14dad7(0x220));});}}),tgBot[_0x242d97(0x36a)](/\/metrics/,_0x221d8e=>{const _0x26faa3=_0x242d97;if(!validateTelegram(_0x221d8e))return;tgBot['removeListener']('callback_query');const _0x506459=getEnabledBots();if(_0x506459[_0x26faa3(0x25d)]==0x0)tgBot['sendMessage'](_0x221d8e[_0x26faa3(0x275)]['id'],_0x26faa3(0x1a9))[_0x26faa3(0x1b3)](_0x2248c6=>{telegramError(_0x2248c6);});else{if(_0x506459[_0x26faa3(0x25d)]>0x1){let _0x224732=[],_0x7e7683=[];const _0x8d04d2=_0x506459[_0x26faa3(0x25d)]%0x4==0x0||_0x506459[_0x26faa3(0x25d)]%0x4==0x3||_0x506459[_0x26faa3(0x25d)]%0x3==0x1?0x4:0x3;let _0x2e4eaf=0x0;_0x506459[_0x26faa3(0x305)]((_0x292b8e,_0xe2bca3)=>{const _0x360a19=_0x26faa3;if(_0xe2bca3%_0x8d04d2==0x0)_0x7e7683=[];_0x7e7683[_0x360a19(0x2e4)]({'text':_0x360a19(0x1db)+_0x292b8e[_0x360a19(0x1d3)],'callback_data':_0x292b8e[_0x360a19(0x1d3)]}),_0xe2bca3%_0x8d04d2==0x0&&(_0x224732[_0x2e4eaf]=_0x7e7683,_0x2e4eaf++);}),tgBot[_0x26faa3(0x28e)](_0x221d8e[_0x26faa3(0x275)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x224732}})[_0x26faa3(0x1b3)](_0x11a9c3=>{telegramError(_0x11a9c3);}),tgBot['on'](_0x26faa3(0x220),async _0x54f2df=>{const _0x66fcc=_0x26faa3,_0x36008a=_0x54f2df[_0x66fcc(0x2d5)],_0x34ec0a=_0x54f2df['message'];tgBot[_0x66fcc(0x2d9)](_0x54f2df['id'])[_0x66fcc(0x2f9)](async()=>{const _0x18b698=_0x66fcc;if(pid[_0x36008a])pid[_0x36008a][_0x18b698(0x370)]({'function':_0x18b698(0x290),'args':null});}),tgBot['removeListener'](_0x66fcc(0x220));});}else{const _0xc818af=_0x506459[0x0][_0x26faa3(0x1d3)];if(pid[_0xc818af])pid[_0xc818af][_0x26faa3(0x370)]({'function':_0x26faa3(0x290),'args':null});}}}),tgBot[_0x242d97(0x36a)](/\/portfolio/,_0x588d9c=>{const _0x523d9c=_0x242d97;if(!validateTelegram(_0x588d9c))return;tgBot[_0x523d9c(0x2ba)](_0x523d9c(0x220));const _0x184ea2=getEnabledBots();if(_0x184ea2['length']==0x0)tgBot[_0x523d9c(0x28e)](_0x588d9c[_0x523d9c(0x275)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x523d9c(0x1b3)](_0x44aa12=>{telegramError(_0x44aa12);});else{if(_0x184ea2[_0x523d9c(0x25d)]>0x1){let _0x16fee6=[],_0x147fd3=[];const _0x374035=_0x184ea2['length']%0x4==0x0||_0x184ea2[_0x523d9c(0x25d)]%0x4==0x3||_0x184ea2[_0x523d9c(0x25d)]%0x3==0x1?0x4:0x3;let _0x3b275e=0x0;_0x184ea2[_0x523d9c(0x305)]((_0x38c785,_0x516892)=>{const _0xfe551a=_0x523d9c;if(_0x516892%_0x374035==0x0)_0x147fd3=[];_0x147fd3[_0xfe551a(0x2e4)]({'text':'Bot\x20'+_0x38c785[_0xfe551a(0x1d3)],'callback_data':_0x38c785[_0xfe551a(0x1d3)]}),_0x516892%_0x374035==0x0&&(_0x16fee6[_0x3b275e]=_0x147fd3,_0x3b275e++);}),tgBot[_0x523d9c(0x28e)](_0x588d9c['chat']['id'],_0x523d9c(0x357),{'reply_markup':{'inline_keyboard':_0x16fee6}})[_0x523d9c(0x1b3)](_0x179c5e=>{telegramError(_0x179c5e);}),tgBot['on'](_0x523d9c(0x220),async _0x223a30=>{const _0x30635a=_0x523d9c,_0x4880b7=_0x223a30['data'],_0x33e778=_0x223a30[_0x30635a(0x216)];tgBot[_0x30635a(0x2d9)](_0x223a30['id'])[_0x30635a(0x2f9)](async()=>{const _0x2bbde0=_0x30635a;if(pid[_0x4880b7])pid[_0x4880b7]['send']({'function':_0x2bbde0(0x1c3),'args':null});}),tgBot[_0x30635a(0x2ba)](_0x30635a(0x220));});}else{const _0x52fc7e=_0x184ea2[0x0][_0x523d9c(0x1d3)];if(pid[_0x52fc7e])pid[_0x52fc7e][_0x523d9c(0x370)]({'function':_0x523d9c(0x1c3),'args':null});}}}),tgBot[_0x242d97(0x36a)](/\/update/,async _0x2bde71=>{const _0x171b7a=_0x242d97;if(!validateTelegram(_0x2bde71))return;tgBot[_0x171b7a(0x2ba)](_0x171b7a(0x220)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x2bde71[_0x171b7a(0x275)]['id'],_0x171b7a(0x1e2))[_0x171b7a(0x1b3)](_0x43753e=>{telegramError(_0x43753e);});else!validInstallation?tgBot[_0x171b7a(0x28e)](_0x2bde71[_0x171b7a(0x275)]['id'],_0x171b7a(0x2df))[_0x171b7a(0x1b3)](_0x84bd79=>{telegramError(_0x84bd79);}):(tgBot[_0x171b7a(0x28e)](_0x2bde71[_0x171b7a(0x275)]['id'],_0x171b7a(0x351),{'reply_markup':{'inline_keyboard':[[{'text':_0x171b7a(0x229),'callback_data':_0x171b7a(0x303)},{'text':'No','callback_data':'no'}]]}})[_0x171b7a(0x1b3)](_0x37e450=>{telegramError(_0x37e450);}),tgBot['on']('callback_query',async _0x3aa07f=>{const _0x5705d9=_0x171b7a,_0xa04126=_0x3aa07f[_0x5705d9(0x2d5)],_0x402bf2=_0x3aa07f[_0x5705d9(0x216)];tgBot[_0x5705d9(0x2d9)](_0x3aa07f['id'])[_0x5705d9(0x2f9)](async()=>{const _0x70e504=_0x5705d9;_0xa04126=='yes'&&(await tgBot['sendMessage'](_0x402bf2['chat']['id'],_0x70e504(0x236))[_0x70e504(0x1b3)](_0x52a34b=>{telegramError(_0x52a34b);}),updateBB(_0x70e504(0x1a6))),_0xa04126=='no'&&await tgBot[_0x70e504(0x28e)](_0x402bf2[_0x70e504(0x275)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x70e504(0x1b3)](_0x5ca4e7=>{telegramError(_0x5ca4e7);});}),tgBot[_0x5705d9(0x2ba)](_0x5705d9(0x220));}));}),tgBot[_0x242d97(0x36a)](/\/reinstall/,async _0x4ae566=>{const _0x71b710=_0x242d97;if(!validateTelegram(_0x4ae566))return;tgBot[_0x71b710(0x2ba)](_0x71b710(0x220)),!validInstallation?tgBot[_0x71b710(0x28e)](_0x4ae566[_0x71b710(0x275)]['id'],_0x71b710(0x22a))[_0x71b710(0x1b3)](_0x3cc6ec=>{telegramError(_0x3cc6ec);}):(tgBot[_0x71b710(0x28e)](_0x4ae566[_0x71b710(0x275)]['id'],_0x71b710(0x327),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0x3dc12d=>{telegramError(_0x3dc12d);}),tgBot['on'](_0x71b710(0x220),async _0x57d233=>{const _0x3bb4f0=_0x71b710,_0xa2495f=_0x57d233[_0x3bb4f0(0x2d5)],_0x50ce7b=_0x57d233[_0x3bb4f0(0x216)];tgBot['answerCallbackQuery'](_0x57d233['id'])[_0x3bb4f0(0x2f9)](async()=>{const _0x36d353=_0x3bb4f0;_0xa2495f==_0x36d353(0x303)&&(await tgBot[_0x36d353(0x28e)](_0x50ce7b[_0x36d353(0x275)]['id'],_0x36d353(0x20f))['catch'](_0x1f51c7=>{telegramError(_0x1f51c7);}),updateBB(_0x36d353(0x2a9))),_0xa2495f=='no'&&await tgBot[_0x36d353(0x28e)](_0x50ce7b[_0x36d353(0x275)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')['catch'](_0x5b33a6=>{telegramError(_0x5b33a6);});}),tgBot[_0x3bb4f0(0x2ba)](_0x3bb4f0(0x220));}));}),tgBot['onText'](/\/toggle/,_0x454431=>{const _0x37d7f9=_0x242d97;if(!validateTelegram(_0x454431))return;tgBot[_0x37d7f9(0x2ba)]('callback_query');const _0x308186=getBotsWithMode();if(_0x308186[_0x37d7f9(0x25d)]==0x0)tgBot[_0x37d7f9(0x28e)](_0x454431[_0x37d7f9(0x275)]['id'],_0x37d7f9(0x1a9))['catch'](_0x18f5e3=>{telegramError(_0x18f5e3);});else{let _0x3901fe=[],_0xfe4002=[];const _0x4db89f=0x2;let _0x51bd4e=0x0;_0x308186['forEach']((_0x51559d,_0x56227a)=>{const _0x13160e=_0x37d7f9;if(_0x56227a%_0x4db89f==0x0)_0xfe4002=[];_0xfe4002[_0x13160e(0x2e4)]({'text':'Bot\x20'+_0x51559d['botID']+'\x20('+_0x51559d[_0x13160e(0x2c3)]+')','callback_data':_0x51559d[_0x13160e(0x1d3)]}),_0x56227a%_0x4db89f==0x0&&(_0x3901fe[_0x51bd4e]=_0xfe4002,_0x51bd4e++);}),tgBot[_0x37d7f9(0x28e)](_0x454431[_0x37d7f9(0x275)]['id'],_0x37d7f9(0x1dd),{'reply_markup':{'inline_keyboard':_0x3901fe}})['catch'](_0x392408=>{telegramError(_0x392408);}),tgBot['on']('callback_query',async _0x268f48=>{const _0x56c09f=_0x37d7f9,_0x1d48ee=_0x268f48[_0x56c09f(0x2d5)],_0x2f98d4=_0x268f48[_0x56c09f(0x216)];tgBot[_0x56c09f(0x2d9)](_0x268f48['id'])['then'](async()=>{const _0x4e7f65=_0x56c09f,_0x4a5204=_0x308186[_0x4e7f65(0x24f)](_0x4c0d1a=>_0x4c0d1a[_0x4e7f65(0x1d3)]==_0x1d48ee),_0x334bf5=_0x4a5204['mode']==_0x4e7f65(0x1fd)?_0x4e7f65(0x2d0):'auto';tgBot['sendMessage'](_0x2f98d4[_0x4e7f65(0x275)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x1d48ee+_0x4e7f65(0x280)+_0x334bf5+_0x4e7f65(0x1e4))['catch'](_0x3b826a=>{telegramError(_0x3b826a);}),toggleBotMode(_0x1d48ee);}),tgBot['removeListener'](_0x56c09f(0x220));});}}),tgBot[_0x242d97(0x36a)](/\/names/,_0x3dcc93=>{const _0xdc6cf9=_0x242d97;if(!validateTelegram(_0x3dcc93))return;let _0x1fdce1='';config[_0xdc6cf9(0x305)](_0x142d7a=>{const _0x24eefc=_0xdc6cf9;_0x1fdce1+=_0x24eefc(0x1db)+_0x142d7a['botID']+':\x20'+_0x142d7a[_0x24eefc(0x1e5)]+'\x0a';}),tgBot[_0xdc6cf9(0x28e)](_0x3dcc93['chat']['id'],_0x1fdce1,{'parse_mode':_0xdc6cf9(0x2d3)})[_0xdc6cf9(0x1b3)](_0x3f7186=>{telegramError(_0x3f7186);});}),tgBot[_0x242d97(0x36a)](/\/disable/,_0x31cef5=>{const _0x4dddb6=_0x242d97;if(!validateTelegram(_0x31cef5))return;tgBot[_0x4dddb6(0x28e)](_0x31cef5[_0x4dddb6(0x275)]['id'],_0x4dddb6(0x2fa))['catch'](_0x1b165b=>{telegramError(_0x1b165b);}),updateSetting(_0x4dddb6(0x24b),![]);}),tgBot[_0x242d97(0x36a)](/\/help/,_0x34187f=>{const _0x53e48f=_0x242d97;if(!validateTelegram(_0x34187f))return;tgBot['sendMessage'](_0x34187f[_0x53e48f(0x275)]['id'],_0x110f51)[_0x53e48f(0x1b3)](_0x22aece=>{telegramError(_0x22aece);});}),tgBot['on'](_0x242d97(0x272),_0x2fd7b1=>{const _0x113b27=_0x242d97;_0x2fd7b1['toString']()[_0x113b27(0x310)]('404\x20Not\x20Found')&&(logger[_0x113b27(0x342)](_0x113b27(0x287)),tgBot[_0x113b27(0x2e2)](),tgBot=null,io['to'](_0x113b27(0x300))[_0x113b27(0x271)](_0x113b27(0x2ac),_0x113b27(0x287)));}),process[_0x242d97(0x242)](_0x242d97(0x323),()=>{const _0x35108d=_0x242d97;if(tgBot)tgBot['stopPolling']();process[_0x35108d(0x1e8)](0x1);}),process[_0x242d97(0x242)]('SIGTERM',()=>{const _0x94b4f5=_0x242d97;if(tgBot)tgBot[_0x94b4f5(0x2e2)]();process[_0x94b4f5(0x1e8)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x57f3f1,_0x50207b){const _0x12398d=_0x17b685;if(settings[_0x12398d(0x24b)]){if(settings[_0x12398d(0x1ae)]==_0x12398d(0x358)||(_0x50207b['type']=='error'||_0x50207b[_0x12398d(0x33b)]==_0x12398d(0x2e8)||_0x50207b['type']=='success')&&settings[_0x12398d(0x1ae)]==_0x12398d(0x27d)||_0x50207b[_0x12398d(0x33b)]==_0x12398d(0x1a4)&&settings[_0x12398d(0x1ae)]=='orders'){if(tgBot&&settings[_0x12398d(0x20b)]){if(_0x50207b[_0x12398d(0x2f7)])tgBot['sendMessage'](settings[_0x12398d(0x20b)],_0x50207b[_0x12398d(0x1e5)]+_0x12398d(0x27c)+_0x50207b[_0x12398d(0x2aa)])[_0x12398d(0x1b3)](_0x309633=>{telegramError(_0x309633);});else tgBot[_0x12398d(0x28e)](settings[_0x12398d(0x20b)],_0x12398d(0x1db)+_0x57f3f1+_0x12398d(0x27c)+_0x50207b['event'])[_0x12398d(0x1b3)](_0xa9f9a6=>{telegramError(_0xa9f9a6);});}}}}async function sendTelegramMsg(_0x2a6b40,_0x122c26=_0x17b685(0x2d3)){const _0x581560=_0x17b685;return settings['telegramEnabled']&&tgBot&&settings[_0x581560(0x20b)]?(await tgBot[_0x581560(0x28e)](settings[_0x581560(0x20b)],_0x2a6b40,{'parse_mode':_0x122c26})[_0x581560(0x1b3)](_0x144e0f=>{telegramError(_0x144e0f);}),!![]):![];}function getDeviceWithIp(_0x5c0eed){const _0x4ed6b2=_0x17b685;return devices[_0x4ed6b2(0x24f)](_0x41dc9d=>_0x41dc9d['ip']===_0x5c0eed);}function temporaryAccess2FA(_0x1491ce,_0x592916){const _0x2278a5=_0x17b685;let _0x27a8e3=new Date(),_0x10065a=![];if(lastIpApproval){if(_0x27a8e3-lastIpApproval<0x1388)_0x10065a=!![];}lastIpApproval=new Date();if(_0x10065a)return;tgBot&&settings[_0x2278a5(0x20b)]&&(tgBot[_0x2278a5(0x2ba)](_0x2278a5(0x220)),tgBot[_0x2278a5(0x28e)](settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x592916)[_0x2278a5(0x230)]+_0x2278a5(0x247),{'parse_mode':_0x2278a5(0x2d3),'reply_markup':{'inline_keyboard':[[{'text':_0x2278a5(0x1c6),'callback_data':'5'},{'text':_0x2278a5(0x257),'callback_data':'15'},{'text':_0x2278a5(0x1ac),'callback_data':'30'},{'text':_0x2278a5(0x24d),'callback_data':'reject'}]]}})[_0x2278a5(0x1b3)](_0x5b430b=>{telegramError(_0x5b430b);}),tgBot['on'](_0x2278a5(0x220),async _0x20b923=>{const _0x476c1e=_0x2278a5,_0x4a2fad=_0x20b923[_0x476c1e(0x2d5)],_0x11f2a4=_0x20b923['message'];tgBot[_0x476c1e(0x2d9)](_0x20b923['id'])[_0x476c1e(0x2f9)](async()=>{const _0x40d52b=_0x476c1e;devices[_0x1491ce][_0x40d52b(0x218)]={'clientip':_0x592916,'timestamp':new Date()[_0x40d52b(0x2cc)](),'expiry':_0x4a2fad},_0x4a2fad!=_0x40d52b(0x24d)?(await tgBot['sendMessage'](_0x11f2a4[_0x40d52b(0x275)]['id'],_0x40d52b(0x363)+_0x4a2fad+_0x40d52b(0x210),{'parse_mode':_0x40d52b(0x2d3)})[_0x40d52b(0x1b3)](_0x4d7574=>{telegramError(_0x4d7574);}),io['to'](_0x1491ce)[_0x40d52b(0x271)](_0x40d52b(0x2a0),{'access':{'allow':![],'reason':_0x40d52b(0x2ae),'token':null}})):(await tgBot[_0x40d52b(0x28e)](_0x11f2a4[_0x40d52b(0x275)]['id'],'Temporary\x20access\x20rejected')[_0x40d52b(0x1b3)](_0x52a00a=>{telegramError(_0x52a00a);}),io['to'](_0x1491ce)[_0x40d52b(0x271)]('status',{'access':{'allow':![],'reason':_0x40d52b(0x2c4),'token':null}}));}),tgBot[_0x476c1e(0x2ba)](_0x476c1e(0x220));}));}function loginAccess2FA(_0x1b030c,_0x25a836){const _0x34fca5=_0x17b685;tgBot&&settings[_0x34fca5(0x20b)]&&(tgBot[_0x34fca5(0x2ba)]('callback_query'),tgBot[_0x34fca5(0x28e)](settings[_0x34fca5(0x20b)],_0x34fca5(0x35d)+normalizeIP(_0x25a836)['show']+_0x34fca5(0x247),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x34fca5(0x24d),'callback_data':'reject'}]]}})[_0x34fca5(0x1b3)](_0x24efd0=>{telegramError(_0x24efd0);}),tgBot['on']('callback_query',async _0x41d4b8=>{const _0x2c5b9f=_0x34fca5,_0x4403a6=_0x41d4b8[_0x2c5b9f(0x2d5)],_0x1bfdfd=_0x41d4b8[_0x2c5b9f(0x216)];tgBot[_0x2c5b9f(0x2d9)](_0x41d4b8['id'])[_0x2c5b9f(0x2f9)](async()=>{const _0x542e30=_0x2c5b9f;devices[_0x1b030c][_0x542e30(0x23f)]={'clientip':_0x25a836,'timestamp':new Date()['getTime'](),'expiry':_0x4403a6},_0x4403a6!=_0x542e30(0x24d)?(await tgBot['sendMessage'](_0x1bfdfd[_0x542e30(0x275)]['id'],'Login\x20accepted',{'parse_mode':_0x542e30(0x2d3)})[_0x542e30(0x1b3)](_0x104849=>{telegramError(_0x104849);}),io['to'](_0x1b030c)[_0x542e30(0x271)](_0x542e30(0x2a0),{'access':{'allow':![],'reason':_0x542e30(0x2ae),'token':null}})):(await tgBot[_0x542e30(0x28e)](_0x1bfdfd[_0x542e30(0x275)]['id'],'Login\x20rejected')[_0x542e30(0x1b3)](_0x5e56b2=>{telegramError(_0x5e56b2);}),io['to'](_0x1b030c)[_0x542e30(0x271)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x2c5b9f(0x2ba)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2f7f93=_0x17b685;return dbConfig[_0x2f7f93(0x2ff)](_0x2f7f93(0x1f6))['sortBy'](_0x2f7f93(0x1d3))[_0x2f7f93(0x1a8)]({'status':'enabled'})[_0x2f7f93(0x368)]()||[];}function getDisabledBots(){const _0x4233ad=_0x17b685;return dbConfig[_0x4233ad(0x2ff)](_0x4233ad(0x1f6))['sortBy'](_0x4233ad(0x1d3))['filter']({'status':_0x4233ad(0x2b0)})[_0x4233ad(0x368)]()||[];}function getBotAttributes(_0x5bff50){const _0x1001ae=_0x17b685;let _0x454962={};const _0x1718bf=configpath+_0x1001ae(0x326)+_0x5bff50+_0x1001ae(0x325),_0x3e3ba0=fs['existsSync'](_0x1718bf);if(_0x3e3ba0){const _0x2112dd=fs[_0x1001ae(0x264)](_0x1718bf);try{const _0x400402=JSON['parse'](_0x2112dd),_0x2830bf=_0x400402?_0x400402['bot'][0x0][_0x1001ae(0x2c1)]:![];_0x454962['mode']=_0x2830bf?_0x1001ae(0x1fd):'manual',_0x454962['botname']=_0x400402?_0x400402[_0x1001ae(0x320)][0x0][_0x1001ae(0x1e5)]:_0x1001ae(0x1db)+_0x5bff50;}catch(_0x24757e){_0x454962[_0x1001ae(0x2c3)]=_0x1001ae(0x2d0),_0x454962[_0x1001ae(0x1e5)]=_0x1001ae(0x1db)+_0x5bff50;}}else _0x454962[_0x1001ae(0x2c3)]=_0x1001ae(0x2d0),_0x454962['botname']=_0x1001ae(0x1db)+_0x5bff50;return _0x454962;}function getBotsWithMode(){const _0x91d9ed=_0x17b685,_0xe2fc87=dbConfig['get'](_0x91d9ed(0x1f6))[_0x91d9ed(0x2e5)](_0x91d9ed(0x1d3))['value']()||[];return _0xe2fc87['forEach'](_0x51635a=>{const _0x4bb27c=_0x91d9ed;let _0xc1f8ab=getBotAttributes(_0x51635a[_0x4bb27c(0x1d3)]);_0x51635a[_0x4bb27c(0x2c3)]=_0xc1f8ab[_0x4bb27c(0x2c3)];}),_0xe2fc87;}function getBotExchanges(){const _0x58447a=_0x17b685;let _0xd349e6=[];const _0x213052=dbConfig[_0x58447a(0x2ff)](_0x58447a(0x1f6))[_0x58447a(0x2e5)](_0x58447a(0x1d3))[_0x58447a(0x368)]()||[];_0x213052[_0x58447a(0x305)](_0x3d4f94=>{const _0x5ef2a8=_0x58447a;if(_0x3d4f94[_0x5ef2a8(0x2a0)]=='enabled'){const _0x3edb3d=configpath+_0x5ef2a8(0x326)+_0x3d4f94[_0x5ef2a8(0x1d3)]+_0x5ef2a8(0x325),_0xb15f2=fs[_0x5ef2a8(0x2f4)](_0x3edb3d);let _0x645259;if(_0xb15f2){const _0x3a7ec4=fs[_0x5ef2a8(0x264)](_0x3edb3d);try{const _0x812768=JSON['parse'](_0x3a7ec4);_0x645259=_0x812768?_0x812768['bot'][0x0]['exchange']:null;}catch(_0x38b890){}}if(_0x645259)_0xd349e6[_0x5ef2a8(0x2e4)](_0x645259);}});const _0x419707=[...new Set(_0xd349e6)][_0x58447a(0x28d)]();return _0x419707;}async function initUser(){const _0x2cea86=_0x17b685;if(!settings[_0x2cea86(0x207)]){const _0x518e37=uuidRandom();mixpanel['alias'](_0x518e37),updateSetting('userid',_0x518e37);}}async function initSecure(){const _0x4e1407=_0x17b685;let _0xa98297=getSecure();if(!_0xa98297[_0x4e1407(0x340)](_0x4e1407(0x36b))){let _0x25032a=await generateKeys();_0xa98297[_0x4e1407(0x309)]=_0x25032a[_0x4e1407(0x309)],_0xa98297[_0x4e1407(0x2b7)]=_0x25032a[_0x4e1407(0x2b7)],_0xa98297[_0x4e1407(0x36b)]=crypto[_0x4e1407(0x2c5)](0x20)[_0x4e1407(0x27a)]('hex');;storeSecure(_0xa98297);}}function getSettings(){const _0x4093fb=_0x17b685;return dbSettings[_0x4093fb(0x2ff)]('settings')[_0x4093fb(0x368)]()||{};}function getSecure(){const _0x2884ca=_0x17b685;return dbSecure['get']('secure')[_0x2884ca(0x368)]()||{};}function getBlacklist(){const _0x56d416=_0x17b685;return dbSecure[_0x56d416(0x2ff)](_0x56d416(0x1b1))[_0x56d416(0x368)]()||[];}function broadcastToBots(_0x3fb90a,_0x560ee4){config['forEach'](_0x1852b5=>{const _0x20143b=_0x3e75;if(_0x1852b5[_0x20143b(0x2a0)]==_0x20143b(0x22b)&&_0x1852b5[_0x20143b(0x1fe)]=='running'||_0x1852b5['status']=='new'&&_0x1852b5[_0x20143b(0x1fe)]==_0x20143b(0x1e1)){if(pid[_0x1852b5[_0x20143b(0x1d3)]])pid[_0x1852b5[_0x20143b(0x1d3)]][_0x20143b(0x370)]({[_0x3fb90a]:_0x560ee4});}});}function storeSettings(_0x41319f,_0x2fd12b=![]){const _0xabaee8=_0x17b685;_0x41319f={...settings,..._0x41319f};if(_0x2fd12b&&_0x41319f[_0xabaee8(0x277)]!=_0xabaee8(0x27f)&&_0x41319f['bbPassword']!=_0xabaee8(0x1af)&&_0x41319f[_0xabaee8(0x277)]!=''){const _0x1555a9=crypt[_0xabaee8(0x30e)](secure[_0xabaee8(0x2b7)],_0x41319f[_0xabaee8(0x277)])[_0xabaee8(0x216)][_0xabaee8(0x286)]('@')[0x0],_0x39124=bcrypt[_0xabaee8(0x1a5)](_0x1555a9,saltRounds);_0x41319f={..._0x41319f,'bbPassword':_0x39124};}if(_0x2fd12b&&_0x41319f[_0xabaee8(0x296)]!=_0xabaee8(0x27f)&&_0x41319f[_0xabaee8(0x296)]!=_0xabaee8(0x1af)&&_0x41319f[_0xabaee8(0x296)]!=''){const _0x39ba21=crypt[_0xabaee8(0x30e)](secure[_0xabaee8(0x2b7)],_0x41319f[_0xabaee8(0x296)])['message'][_0xabaee8(0x286)]('@')[0x0];_0x41319f={..._0x41319f,'telegramToken':_0x39ba21};}const _0x22e970=_0x41319f[_0xabaee8(0x296)]!=_0xabaee8(0x27f)&&_0x41319f[_0xabaee8(0x296)]!=settings['telegramToken']||_0x41319f[_0xabaee8(0x1c8)]!=settings[_0xabaee8(0x1c8)],_0x5a1279=_0x41319f['telegramToken']==''||_0x41319f['telegramUsername']=='';if(_0x22e970)_0x41319f['telegramEvents']=_0xabaee8(0x358);for(const [_0x165ea7,_0x590a9d]of Object[_0xabaee8(0x371)](_0x41319f)){if(_0x165ea7==_0xabaee8(0x296)&&_0x590a9d==_0xabaee8(0x27f)){_0x41319f['telegramToken']=settings['telegramToken'];continue;};if(_0x165ea7==_0xabaee8(0x277)&&_0x590a9d==_0xabaee8(0x27f)){_0x41319f[_0xabaee8(0x277)]=settings[_0xabaee8(0x277)];continue;};dbSettings['set'](_0xabaee8(0x2b6)+_0x165ea7,_0x590a9d)[_0xabaee8(0x2fd)]();}settings=_0x41319f,io['to']('botmanager')[_0xabaee8(0x271)](_0xabaee8(0x2eb),cleanSettings()),broadcastToBots(_0xabaee8(0x254),settings[_0xabaee8(0x254)]),broadcastToBots('onepagemode',settings[_0xabaee8(0x249)]);if(_0x22e970&&!_0x5a1279)initTelegram();if(_0x22e970&&_0x5a1279)disableTelegram();getAllClients()[_0xabaee8(0x305)](_0x546535=>{const _0x2031c9=_0xabaee8;getSocket(_0x546535['id'])[_0x2031c9(0x271)](_0x2031c9(0x2a0),{'access':{'allow':![],'reason':_0x2031c9(0x2ae),'token':null}});});}function updateSetting(_0x19bafe,_0x40439c){const _0x2dd1c2=_0x17b685;dbSettings['set']('settings.'+_0x19bafe,_0x40439c)[_0x2dd1c2(0x2fd)](),settings=getSettings(),io['to'](_0x2dd1c2(0x300))[_0x2dd1c2(0x271)]('settings',cleanSettings());}function storeSecure(_0x311350){const _0x9af3b1=_0x17b685;dbSecure[_0x9af3b1(0x2ff)](_0x9af3b1(0x29f))[_0x9af3b1(0x2e4)](_0x311350)[_0x9af3b1(0x2fd)](),secure=_0x311350;}function addBlacklist(_0x2505c9){const _0x5af5cb=_0x17b685;cleanBlacklist();let _0x1c652e;devices[_0x2505c9][_0x5af5cb(0x218)]?_0x1c652e=Math[_0x5af5cb(0x259)](devices[_0x2505c9][_0x5af5cb(0x218)]['expiry'],loginExpiry):_0x1c652e=loginExpiry,dbSecure[_0x5af5cb(0x2ff)]('blacklist')[_0x5af5cb(0x2e4)]({'expiry':new Date()[_0x5af5cb(0x2cc)]()+_0x1c652e*0x3c*0x3e8,'token':devices[_0x2505c9][_0x5af5cb(0x1ec)]['token']})[_0x5af5cb(0x2fd)](),blacklist=dbSecure[_0x5af5cb(0x2ff)](_0x5af5cb(0x1b1))[_0x5af5cb(0x368)]();}function cleanBlacklist(){const _0x13cf85=_0x17b685;let _0x2ec719=dbSecure['get']('blacklist')[_0x13cf85(0x2ee)]()[_0x13cf85(0x368)](),_0xb1b26b=new Date()[_0x13cf85(0x2cc)]();_0x2ec719['forEach'](_0x44aa89=>{const _0x446ea6=_0x13cf85;_0x44aa89[_0x446ea6(0x2f3)]<_0xb1b26b&&dbSecure[_0x446ea6(0x2ff)](_0x446ea6(0x1b1))[_0x446ea6(0x32b)]({'expiry':_0x44aa89[_0x446ea6(0x2f3)]})[_0x446ea6(0x2fd)]();});}function initStates(){let _0x277d47=getConfiguration();_0x277d47['forEach'](_0x5c396f=>{const _0xe371bb=_0x3e75;_0x5c396f[_0xe371bb(0x1fe)]='stopped';}),storeConfiguration(_0x277d47);}function _0x3e75(_0x16e494,_0x1b53c5){const _0x4fe758=_0x54a8();return _0x3e75=function(_0x5f0c9b,_0x1b6060){_0x5f0c9b=_0x5f0c9b-0x1a2;let _0x54a819=_0x4fe758[_0x5f0c9b];return _0x54a819;},_0x3e75(_0x16e494,_0x1b53c5);}function onKeys(){const _0x5b86ef=new RSA();return new Promise(_0x5dccb6=>{const _0x38b97a=_0x3e75;_0x5b86ef[_0x38b97a(0x2d4)]()[_0x38b97a(0x2f9)](_0x258159=>{_0x5dccb6(_0x258159);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x429268=_0x17b685;let _0x5b192e=getSettings(),_0x428ee1=![];!_0x5b192e[_0x429268(0x340)](_0x429268(0x1ee))&&(_0x5b192e[_0x429268(0x1ee)]=0x0,_0x428ee1=!![]);!_0x5b192e[_0x429268(0x340)](_0x429268(0x219))&&(_0x5b192e[_0x429268(0x219)]=0x0,_0x428ee1=!![]);!_0x5b192e[_0x429268(0x340)](_0x429268(0x25b))&&(_0x5b192e[_0x429268(0x25b)]=_0x429268(0x241),_0x428ee1=!![]);!_0x5b192e[_0x429268(0x340)](_0x429268(0x249))&&(_0x5b192e['onepagemode']=![],_0x428ee1=!![]);if(_0x428ee1)storeSettings(_0x5b192e);try{fs[_0x429268(0x1f8)](configbackuppath,{'withFileTypes':!![]})[_0x429268(0x305)](_0x58d2bc=>{const _0x498b69=_0x429268;if(!_0x58d2bc[_0x498b69(0x213)]()){if(!_0x58d2bc[_0x498b69(0x2a4)][_0x498b69(0x2b4)](_0x498b69(0x1c7)))fs[_0x498b69(0x237)](configbackuppath+_0x58d2bc[_0x498b69(0x2a4)]);}else fs[_0x498b69(0x262)](configbackuppath+_0x58d2bc['name'],{'recursive':!![]});});}catch(_0x5f1f3d){logger[_0x429268(0x227)]('Error\x20removing\x20old\x20backup\x20files:',_0x5f1f3d);}}function storeConfiguration(_0x4ceae0){const _0xc49e24=_0x17b685;dbConfig[_0xc49e24(0x2ff)](_0xc49e24(0x1f6))[_0xc49e24(0x32b)]()[_0xc49e24(0x2fd)](),_0x4ceae0[_0xc49e24(0x305)](_0x136b40=>{const _0x482f34=_0xc49e24;delete _0x136b40[_0x482f34(0x2c3)];}),dbConfig[_0xc49e24(0x2ff)](_0xc49e24(0x1f6))[_0xc49e24(0x2e4)](..._0x4ceae0)[_0xc49e24(0x2fd)](),config=_0x4ceae0;}function resetPassword(){const _0x288a3f=_0x17b685;tgBot&&settings[_0x288a3f(0x20b)]&&(tgBot['removeListener'](_0x288a3f(0x220)),tgBot[_0x288a3f(0x28e)](settings[_0x288a3f(0x20b)],_0x288a3f(0x2c9),{'parse_mode':_0x288a3f(0x2d3),'reply_markup':{'inline_keyboard':[[{'text':_0x288a3f(0x303),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x288a3f(0x1b3)](_0x5a2df4=>{telegramError(_0x5a2df4);}),tgBot['on'](_0x288a3f(0x220),async _0x5826c6=>{const _0x439346=_0x288a3f,_0x27224d=_0x5826c6[_0x439346(0x2d5)],_0xfa735a=_0x5826c6[_0x439346(0x216)];tgBot[_0x439346(0x2d9)](_0x5826c6['id'])[_0x439346(0x2f9)](async()=>{const _0x3bd895=_0x439346;if(_0x27224d!='no'){const _0x1f23a8=0xf,_0x589d7f='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x3d4274=Array['from'](crypto[_0x3bd895(0x350)](new Uint32Array(_0x1f23a8)))[_0x3bd895(0x2ea)](_0x5a3cb4=>_0x589d7f[_0x5a3cb4%_0x589d7f['length']])[_0x3bd895(0x225)](''),_0x2e345f=bcrypt[_0x3bd895(0x1a5)](_0x3d4274,saltRounds);storeSettings({'bbPassword':_0x2e345f}),await tgBot['sendMessage'](_0xfa735a['chat']['id'],_0x3bd895(0x36e)+_0x3d4274,{'parse_mode':_0x3bd895(0x2d3)})['catch'](_0x17b71c=>{telegramError(_0x17b71c);});}else await tgBot['sendMessage'](_0xfa735a[_0x3bd895(0x275)]['id'],'Password\x20reset\x20rejected')[_0x3bd895(0x1b3)](_0x1d55eb=>{telegramError(_0x1d55eb);});}),tgBot['removeListener'](_0x439346(0x220));}));}async function confirmRestore(_0x8ec7e,_0x5cc3bc){const _0x43317a=_0x17b685;io['to'](_0x43317a(0x300))['emit']('notification',_0x43317a(0x23e),'success'),tgBot&&settings[_0x43317a(0x20b)]&&(tgBot[_0x43317a(0x2ba)]('callback_query'),await tgBot[_0x43317a(0x28e)](settings[_0x43317a(0x20b)],_0x43317a(0x2ce),{'parse_mode':_0x43317a(0x2d3),'reply_markup':{'inline_keyboard':[[{'text':_0x43317a(0x303),'callback_data':_0x43317a(0x303)},{'text':'no','callback_data':'no'}]]}})['catch'](_0xb1a661=>{telegramError(_0xb1a661);}),tgBot['on']('callback_query',async _0x422354=>{const _0x4c5336=_0x43317a,_0x5d4bc7=_0x422354[_0x4c5336(0x2d5)],_0x34b2b2=_0x422354[_0x4c5336(0x216)];tgBot[_0x4c5336(0x2d9)](_0x422354['id'])[_0x4c5336(0x2f9)](async()=>{const _0x5f05da=_0x4c5336;_0x5d4bc7=='yes'?(await tgBot['sendMessage'](_0x34b2b2[_0x5f05da(0x275)]['id'],_0x5f05da(0x29c),{'parse_mode':'HTML'})['catch'](_0xe3e0ca=>{telegramError(_0xe3e0ca);}),unzipFile(_0x8ec7e,_0x5cc3bc)):(logger[_0x5f05da(0x227)](_0x5f05da(0x1c5)),await tgBot[_0x5f05da(0x28e)](_0x34b2b2['chat']['id'],_0x5f05da(0x1c5))[_0x5f05da(0x1b3)](_0x518310=>{telegramError(_0x518310);}));}),tgBot[_0x4c5336(0x2ba)]('callback_query');}));}function getServerTime(){const _0x39e1a7=_0x17b685,_0x474132=new Date();return _0x474132[_0x39e1a7(0x276)]()+'/'+(_0x474132[_0x39e1a7(0x30f)]()+0x1)[_0x39e1a7(0x27a)]()[_0x39e1a7(0x25e)](0x2,'0')+'/'+_0x474132[_0x39e1a7(0x35f)]()[_0x39e1a7(0x27a)]()['padStart'](0x2,'0')+'\x20'+_0x474132['getHours']()[_0x39e1a7(0x27a)]()[_0x39e1a7(0x25e)](0x2,'0')+':'+_0x474132[_0x39e1a7(0x1fa)]()['toString']()[_0x39e1a7(0x25e)](0x2,'0')+':'+_0x474132[_0x39e1a7(0x274)]()[_0x39e1a7(0x27a)]()[_0x39e1a7(0x25e)](0x2,'0');}function getTimeStamp(){const _0x101713=_0x17b685,_0x3cf55b=shiftedTime();return _0x3cf55b['getFullYear']()+'/'+(_0x3cf55b[_0x101713(0x30f)]()+0x1)[_0x101713(0x27a)]()[_0x101713(0x25e)](0x2,'0')+'/'+_0x3cf55b[_0x101713(0x35f)]()[_0x101713(0x27a)]()[_0x101713(0x25e)](0x2,'0')+'\x20'+_0x3cf55b[_0x101713(0x343)]()[_0x101713(0x27a)]()[_0x101713(0x25e)](0x2,'0')+':'+_0x3cf55b[_0x101713(0x1fa)]()[_0x101713(0x27a)]()[_0x101713(0x25e)](0x2,'0')+':'+_0x3cf55b[_0x101713(0x274)]()[_0x101713(0x27a)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0xc33003=_0x17b685,_0x54e5e0=shiftedTime();return _0x54e5e0['getFullYear']()+(_0x54e5e0['getMonth']()+0x1)['toString']()[_0xc33003(0x25e)](0x2,'0')+_0x54e5e0[_0xc33003(0x35f)]()[_0xc33003(0x27a)]()[_0xc33003(0x25e)](0x2,'0')+'-'+_0x54e5e0[_0xc33003(0x343)]()[_0xc33003(0x27a)]()[_0xc33003(0x25e)](0x2,'0')+_0x54e5e0[_0xc33003(0x1fa)]()[_0xc33003(0x27a)]()[_0xc33003(0x25e)](0x2,'0')+_0x54e5e0['getSeconds']()[_0xc33003(0x27a)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x4f6d24=_0x17b685,_0x5d6662=new Date();let _0x31b9c9=_0x5d6662;if(settings[_0x4f6d24(0x254)]&&settings['timeshift']!==0x0)_0x31b9c9=fns[_0x4f6d24(0x304)](_0x5d6662,{'hours':settings['timeshift']});return _0x31b9c9;}function startScheduler(){const _0x44041f=_0x17b685,_0x174d95=new Date()['getUTCHours'](),_0x359184=shiftedTime()[_0x44041f(0x343)]();_0x359184==0x4&&backupConfigFiles();_0x359184==0x0&&rotateLogFiles();_0x174d95%0x6==0x0&&triggerAnalytics();_0x174d95%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x12ec82){const _0x5149da=_0x17b685;logger[_0x5149da(0x227)](_0x5149da(0x333)+_0x12ec82);const _0x512ebd=getBotsWithMode();_0x512ebd['length']>0x0?confirmRestore(configbackuppath,_0x12ec82):unzipFile(configbackuppath,_0x12ec82);}async function getBackupFiles(_0x55b46f=null){const _0x48990b=_0x17b685;let _0x4b5ea1=[],_0x4070f5=fs[_0x48990b(0x1f8)](configbackuppath,{'withFileTypes':!![]});_0x4070f5[_0x48990b(0x28d)]((_0x1bd9ab,_0x10b58a)=>_0x1bd9ab[_0x48990b(0x2a4)]<_0x10b58a['name']?0x1:_0x10b58a[_0x48990b(0x2a4)]<_0x1bd9ab[_0x48990b(0x2a4)]?-0x1:0x0),_0x4070f5[_0x48990b(0x305)](_0x5078cf=>{const _0x52e260=_0x48990b;if(!_0x5078cf[_0x52e260(0x213)]()&&_0x5078cf[_0x52e260(0x2a4)]['startsWith'](_0x52e260(0x1c7))&&_0x5078cf[_0x52e260(0x2a4)][_0x52e260(0x2d1)](_0x52e260(0x251))){const _0x32b587=formatDate(fs['statSync'](configbackuppath+_0x5078cf['name'])['mtime']);_0x4b5ea1[_0x52e260(0x2e4)]({'name':_0x5078cf['name'],'mtime':_0x32b587});}});if(_0x55b46f)io['to'](_0x55b46f)[_0x48990b(0x271)](_0x48990b(0x2c8),_0x4b5ea1);else return _0x4b5ea1;}async function backupConfigFiles(){const _0x1392fc=_0x17b685;await zipFiles(_0x1392fc(0x317));const _0xe8cc07=getCleanTimeStamp();fs[_0x1392fc(0x2dd)](zippath+_0x1392fc(0x252),configbackuppath+('backup-full@'+_0xe8cc07+_0x1392fc(0x251)));let _0x4e244e=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4e244e[_0x1392fc(0x28d)]((_0x3443ac,_0x15d9b0)=>_0x3443ac['name']<_0x15d9b0['name']?0x1:_0x15d9b0['name']<_0x3443ac[_0x1392fc(0x2a4)]?-0x1:0x0),_0x4e244e[_0x1392fc(0x25d)]>maxBackups&&fs[_0x1392fc(0x237)](configbackuppath+_0x4e244e[_0x4e244e['length']-0x1]['name']);}function rotateLogFiles(){const _0x32c09d=_0x17b685,_0x1dd839=fs[_0x32c09d(0x334)](logspath+_0x32c09d(0x231)),_0x49c31f=_0x1dd839[_0x32c09d(0x2da)]/0x400;if(_0x49c31f>0x64){let _0x4ddc27=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x4ddc27[_0x32c09d(0x28d)]((_0x4e469e,_0x5afe96)=>_0x4e469e[_0x32c09d(0x2a4)]<_0x5afe96[_0x32c09d(0x2a4)]?0x1:_0x5afe96[_0x32c09d(0x2a4)]<_0x4e469e[_0x32c09d(0x2a4)]?-0x1:0x0),_0x4ddc27['forEach'](_0xe1d4f1=>{const _0x91c52b=_0x32c09d;if(_0xe1d4f1[_0x91c52b(0x2a4)]==_0x91c52b(0x263))fs['copyFileSync'](logspath+_0xe1d4f1[_0x91c52b(0x2a4)],logspath+'output-003.log');if(_0xe1d4f1['name']==_0x91c52b(0x1f4))fs['copyFileSync'](logspath+_0xe1d4f1[_0x91c52b(0x2a4)],logspath+_0x91c52b(0x263));_0xe1d4f1['name']==_0x91c52b(0x231)&&(fs[_0x91c52b(0x2dd)](logspath+_0xe1d4f1[_0x91c52b(0x2a4)],logspath+_0x91c52b(0x1f4)),fs[_0x91c52b(0x33d)](logspath+_0xe1d4f1[_0x91c52b(0x2a4)],''));});}}async function zipFiles(_0x683f4e){const _0x1bd324=_0x17b685;let _0x150d35;if(_0x683f4e=='logs')_0x150d35=logspath;if(_0x683f4e==_0x1bd324(0x2a3))_0x150d35=configpath;if(_0x683f4e==_0x1bd324(0x317))_0x150d35=configpath;let _0x84b399=fs['readdirSync'](_0x150d35,{'withFileTypes':!![]});const _0x34d5a4=new require(_0x1bd324(0x1e0))();_0x84b399[_0x1bd324(0x305)](_0x208d9e=>{const _0x1a631d=_0x1bd324;if(!_0x208d9e[_0x1a631d(0x213)]()){let _0x2c75f6=fs['readFileSync'](_0x150d35+_0x208d9e[_0x1a631d(0x2a4)]);if(_0x683f4e=='backup'){const _0x350ed5=/^bot-[0-9]{3}-config.json$/,_0x50a4fb=_0x350ed5[_0x1a631d(0x2f1)](_0x208d9e['name']);if(_0x50a4fb){const _0x4a2ac3=JSON[_0x1a631d(0x36c)](_0x2c75f6);if(_0x4a2ac3['bot'][0x0]){_0x4a2ac3[_0x1a631d(0x320)][0x0][_0x1a631d(0x2fe)]=_0x1a631d(0x1af),_0x4a2ac3[_0x1a631d(0x320)][0x0][_0x1a631d(0x29b)]='***';if(_0x4a2ac3[_0x1a631d(0x320)][0x0][_0x1a631d(0x1f2)])_0x4a2ac3['bot'][0x0][_0x1a631d(0x1f2)]=_0x1a631d(0x1af);}_0x2c75f6=JSON[_0x1a631d(0x21c)](_0x4a2ac3,null,0x2);}if(_0x208d9e['name']=='bb-settings.json'){const _0x3d2ec0=JSON['parse'](_0x2c75f6);if(_0x3d2ec0[_0x1a631d(0x2eb)]['loginRequired'])_0x3d2ec0[_0x1a631d(0x2eb)][_0x1a631d(0x344)]=![];if(_0x3d2ec0[_0x1a631d(0x2eb)][_0x1a631d(0x277)])_0x3d2ec0[_0x1a631d(0x2eb)]['bbPassword']='***';if(_0x3d2ec0[_0x1a631d(0x2eb)][_0x1a631d(0x296)])_0x3d2ec0[_0x1a631d(0x2eb)]['telegramToken']=_0x1a631d(0x1af);if(_0x3d2ec0['settings'][_0x1a631d(0x20b)])_0x3d2ec0[_0x1a631d(0x2eb)][_0x1a631d(0x20b)]=null;_0x2c75f6=JSON[_0x1a631d(0x21c)](_0x3d2ec0,null,0x2);}if(_0x208d9e[_0x1a631d(0x2a4)]!='bb-secure.json')_0x34d5a4[_0x1a631d(0x283)](_0x208d9e['name'],_0x2c75f6);}else _0x34d5a4[_0x1a631d(0x283)](_0x208d9e['name'],_0x2c75f6);}});const _0x38f48b=_0x34d5a4['generate']({'base64':![],'compression':_0x1bd324(0x203)});fs[_0x1bd324(0x33d)](zippath+(_0x683f4e+'.zip'),_0x38f48b,_0x1bd324(0x21d));}async function unzipFile(_0x546b59,_0x193f6e){const _0x1bce74=_0x17b685;fs[_0x1bce74(0x1f8)](configpath,{'withFileTypes':!![]})[_0x1bce74(0x305)](_0x485f39=>{const _0x419081=_0x1bce74;if(!_0x485f39[_0x419081(0x213)]())fs['rmSync'](configpath+_0x485f39[_0x419081(0x2a4)]);});const _0x5edf72=fs[_0x1bce74(0x264)](_0x546b59+_0x193f6e,_0x1bce74(0x21d)),_0x34449a=new require('node-zip')(_0x5edf72,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x34449a[_0x1bce74(0x29d)])['forEach'](_0x50d9ed=>{const _0x507e01=_0x1bce74,_0x561cf3=_0x34449a[_0x507e01(0x29d)][_0x50d9ed];fs[_0x507e01(0x33d)](configpath+_0x561cf3['name'],_0x561cf3['_data']);}),fs[_0x1bce74(0x1f8)](temppath,{'withFileTypes':!![]})[_0x1bce74(0x305)](_0x23aae3=>{const _0x4c10ef=_0x1bce74;if(!_0x23aae3[_0x4c10ef(0x213)]())fs[_0x4c10ef(0x262)](temppath+_0x23aae3['name']);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process['send']({'restore':!![]},_0xc5b334=>{});}async function getPublicIp(){const _0xde3574=_0x17b685;try{const _0x4691b7=await axios[_0xde3574(0x2ff)]('https://api.ipify.org?format=json');publicip=_0x4691b7[_0xde3574(0x2d5)]['ip'];}catch(_0x339db1){}}async function triggerAnalytics(){const _0x114221=_0x17b685;if(!publicip)await getPublicIp();const _0x766edf=getBotsWithMode();let _0x5b604c=0x0;_0x766edf[_0x114221(0x305)](_0x5d40ef=>{const _0x5a6ee4=_0x114221;if(_0x5d40ef[_0x5a6ee4(0x2a0)]===_0x5a6ee4(0x22b))_0x5b604c++;});const _0x57e9cd=getBotExchanges();mixpanel[_0x114221(0x31f)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x766edf[_0x114221(0x25d)],'numbotsenabled':_0x5b604c,'exchanges':_0x57e9cd,'environment':environment});}async function getMessages(){const _0xbf5919=_0x17b685,_0x579f02='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x648de8=new GraphQLClient(_0x579f02),_0x2d10f0={'authorization':_0xbf5919(0x369)},_0xf8ccd3=serverversion['split']('.'),_0x48854b=_0xf8ccd3[0x0]+'.'+_0xf8ccd3[0x1],_0xcad133=Math[_0xbf5919(0x238)](settings[_0xbf5919(0x1ee)],settings['lastmsgemitted']),_0x26068f={'last':parseInt(_0xcad133),'bbm':_0x48854b},_0x296e0d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xe6bdd3;try{_0xe6bdd3=await _0x648de8[_0xbf5919(0x33e)](_0x296e0d,_0x26068f,_0x2d10f0);}catch(_0x17119e){}if(_0xe6bdd3&&_0xe6bdd3[_0xbf5919(0x244)]){let _0x1ad61f=settings[_0xbf5919(0x1ee)];newMessages=[];for(const _0x138982 of _0xe6bdd3[_0xbf5919(0x244)]){newMessages[_0xbf5919(0x2e4)](_0x138982);let _0x363f59=![];_0x138982[_0xbf5919(0x1d8)]&&(updateSetting(_0xbf5919(0x25b),_0x138982['bbvNew']),_0x363f59=isNewerVersion(serverversion,_0x138982[_0xbf5919(0x1d8)])||serverversion==_0x138982['bbvNew']);if(!_0x363f59&&_0x138982['number']>_0x1ad61f){if(_0x138982[_0xbf5919(0x2be)]===_0xbf5919(0x331)||serverversion[_0xbf5919(0x2b4)](_0x138982[_0xbf5919(0x2be)])){let _0x2f062a=''+_0x138982[_0xbf5919(0x1b8)]+'\x0a\x0a'+_0x138982[_0xbf5919(0x216)];const _0x1f7777=await sendTelegramMsg(toTelegramMarkdown(_0x2f062a),_0xbf5919(0x2fc));if(_0x1f7777)_0x1ad61f=_0x138982[_0xbf5919(0x235)];}}}updateAvailable=isNewerVersion(settings[_0xbf5919(0x25b)],serverversion),updateSetting('lastmsgtelegram',_0x1ad61f),emitMessages();}}function emitMessages(){const _0x564f51=_0x17b685,_0x1ca448=settings['lastmsgemitted'];let _0x2ab204=[];newMessages[_0x564f51(0x305)](_0x3f6a8c=>{const _0xc58def=_0x564f51;_0x3f6a8c[_0xc58def(0x235)]>_0x1ca448&&_0x2ab204[_0xc58def(0x2e4)](_0x3f6a8c);}),_0x2ab204[_0x564f51(0x25d)]>0x0&&getAllClients()[_0x564f51(0x305)](_0x743d31=>{const _0xc5a776=_0x564f51;getSocket(_0x743d31['id'])['emit'](_0xc5a776(0x216),_0x2ab204);});}function confirmMessage(_0x589864){const _0x512897=_0x17b685;updateSetting(_0x512897(0x219),Number(_0x589864));}function isNewerVersion(_0x56b59d,_0x43a0e3){const _0xb9516c=_0x17b685,_0x20349b=_0x43a0e3[_0xb9516c(0x286)]('.'),_0x4bb05b=_0x56b59d[_0xb9516c(0x286)]('.');for(var _0x30bf1e=0x0;_0x30bf1e<_0x4bb05b[_0xb9516c(0x25d)];_0x30bf1e++){const _0x19b24d=~~_0x4bb05b[_0x30bf1e],_0x4b1a7f=~~_0x20349b[_0x30bf1e];if(_0x19b24d>_0x4b1a7f)return!![];if(_0x19b24d<_0x4b1a7f)return![];}return![];}function toTelegramMarkdown(_0x28a043){const _0x50852d=_0x17b685,_0x1f8cac=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5a0b02=/\*{2}(.+?)\*{2}/gim;return _0x28a043=_0x28a043[_0x50852d(0x250)](_0x1f8cac,'$1_$2_$3')[_0x50852d(0x250)](_0x5a0b02,_0x50852d(0x330)),_0x28a043;}async function validateConfigFile(){const _0x59d842=_0x17b685,_0x519264=dbConfig[_0x59d842(0x2ff)]('bots')['sortBy']('botID')[_0x59d842(0x368)]()||[];if(_0x519264['length']==0x0){let _0x1a1166=0x0,_0x29556b=[];const _0x140a2b=/^bot-([0-9]{3})-config.json$/,_0x412a77=fs['readdirSync'](configpath);_0x412a77[_0x59d842(0x305)](_0x511aa7=>{const _0x29d66f=_0x59d842,_0x1b31e5=_0x140a2b[_0x29d66f(0x28f)](_0x511aa7);if(_0x1b31e5){const _0x35e1cb=_0x1b31e5[0x1];let _0xe6a250=getBotAttributes(_0x35e1cb);_0x29556b['push']({'botID':_0x35e1cb,'botname':_0xe6a250[_0x29d66f(0x1e5)],'status':_0x29d66f(0x2b0),'live':_0x29d66f(0x314)}),_0x1a1166++;}}),_0x1a1166!=0x0&&(dbConfig[_0x59d842(0x2ff)]('bots')[_0x59d842(0x30a)](_0x29556b)[_0x59d842(0x2fd)](),config=_0x29556b,restoredConfigFile=_0x1a1166);}}async function restoreConfigNotify(_0x5b9cc7){const _0x260e2a=_0x17b685;let _0x1e6ed5;if(restoredConfigFile==0x1)_0x1e6ed5=_0x260e2a(0x1f9);else _0x1e6ed5=_0x260e2a(0x353);if(_0x5b9cc7)io['to']('botmanager')['emit'](_0x260e2a(0x2ac),_0x1e6ed5);else{logger[_0x260e2a(0x1d0)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x1e6ed5),logger[_0x260e2a(0x1d0)]('-----------------------------------------------------------------------------------'),logger[_0x260e2a(0x1d0)]('');if(tgBot&&settings[_0x260e2a(0x20b)]&&settings[_0x260e2a(0x1ae)]!='orders')tgBot[_0x260e2a(0x28e)](settings[_0x260e2a(0x20b)],'Bot\x20Mgr\x20>\x20'+_0x1e6ed5)['catch'](_0x4d1679=>{telegramError(_0x4d1679);});}}function validateCredentials(_0xbf9553,_0x4d4f8e){const _0x1f0842=_0x17b685;if(_0xbf9553[_0x1f0842(0x1cf)]==settings[_0x1f0842(0x2fb)]&&bcrypt[_0x1f0842(0x321)](_0xbf9553[_0x1f0842(0x27e)],settings[_0x1f0842(0x277)])){if(settings[_0x1f0842(0x25f)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x710593=generateLoginToken(_0x4d4f8e);return{'allow':!![],'reason':_0x1f0842(0x1a7),'token':_0x710593};}}else return{'allow':![],'reason':_0x1f0842(0x294),'token':null};}function refreshToken(_0x4afd77){const _0x54b4f0=_0x17b685,_0x4dacf2=generateLoginToken(_0x4afd77);return{'allow':!![],'reason':_0x54b4f0(0x1a7),'token':_0x4dacf2};}function validateAccess(_0x38bf44,_0x3c0c11,_0x3eb160){const _0x3e37c4=_0x17b685,_0x559aa1=_0x3eb160?_0x3eb160:devices[_0x3c0c11]['ip'];let _0x42a2b7;const _0x68fd40=_0x3793b3=>{const _0x37a604=_0x3e75;if(settings[_0x37a604(0x344)]){if(settings[_0x37a604(0x25f)]){if(telegram2FaApproved(_0x3c0c11)){const _0x53c5ad=generateLoginToken(_0x3c0c11);return{'allow':!![],'reason':_0x37a604(0x1bf),'token':_0x53c5ad};}else return{'allow':![],'reason':_0x37a604(0x201),'token':null};}else return _0x42a2b7=validToken(_0x3793b3,_0x3c0c11),_0x42a2b7[_0x37a604(0x340)](_0x37a604(0x1bd))?{'allow':!![],'reason':_0x37a604(0x2b8),'token':_0x3793b3}:{'allow':![],'reason':_0x37a604(0x201),'token':null};}else return{'allow':!![],'reason':_0x37a604(0x221),'token':null};};if(settings['whitelistEnabled']){let _0x285764=[...settings[_0x3e37c4(0x1eb)],'::1',_0x3e37c4(0x2f6),_0x3e37c4(0x354)];if(_0x285764[_0x3e37c4(0x310)](_0x559aa1))return _0x68fd40(_0x38bf44);else{_0x42a2b7=validToken(_0x38bf44,_0x3c0c11);if(_0x42a2b7[_0x3e37c4(0x340)](_0x3e37c4(0x1bd)))return _0x68fd40(_0x38bf44);else{if(telegramIpApproved(_0x3c0c11)){const _0x4de39b=generateToken(_0x3c0c11);return _0x42a2b7=_0x68fd40(_0x38bf44),_0x42a2b7['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x4de39b}:_0x42a2b7;}else return settings[_0x3e37c4(0x1fb)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x68fd40(_0x38bf44);}function timelyDecrypt(_0x204dbc,_0x3ae5fd=!![]){const _0x3be25c=_0x17b685;if(_0x204dbc)try{const _0x125b96=crypt[_0x3be25c(0x30e)](secure[_0x3be25c(0x2b7)],_0x204dbc)[_0x3be25c(0x216)],_0xb5bbec=_0x125b96[_0x3be25c(0x286)]('@')[0x0],_0x1328cc=_0x125b96[_0x3be25c(0x286)]('@')[0x1],_0x12a482=new Date()[_0x3be25c(0x2cc)]();if(_0x3ae5fd){if(_0x12a482-_0x1328cc<maxSecretAge*0x3e8)return _0xb5bbec;else return![];}else return _0xb5bbec;}catch(_0x2b8d22){return![];}else return![];}const validToken=(_0x1db45f,_0xbf6299)=>{const _0x2e0879=_0x17b685,_0x3a23ff=devices[_0xbf6299]['ip'];if(!_0x1db45f)return{'error':_0x2e0879(0x2b3)};for(let _0x1a2d77 of blacklist){if(_0x1a2d77[_0x2e0879(0x319)]==_0x1db45f)return{'error':_0x2e0879(0x1da)};}let _0x4252de;try{_0x4252de=jwt['verify'](_0x1db45f,secure['secret']+_0xbf6299);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4252de[_0x2e0879(0x340)](_0x2e0879(0x1f7))&&!_0x4252de[_0x2e0879(0x340)]('username')||!_0x4252de[_0x2e0879(0x340)](_0x2e0879(0x1bb)))return{'error':_0x2e0879(0x1c4)};if(!_0x4252de[_0x2e0879(0x340)]('username')&&_0x4252de['hasOwnProperty'](_0x2e0879(0x1f7))){const {clientip:_0x254c0d}=_0x4252de;return _0x3a23ff==_0x254c0d?{'success':_0x2e0879(0x282)}:{'error':_0x2e0879(0x336)};}else{if(_0x4252de[_0x2e0879(0x340)]('username')&&_0x4252de['hasOwnProperty'](_0x2e0879(0x1f7))){const {username:_0x1244a1,clientip:_0x1d1627}=_0x4252de;return settings[_0x2e0879(0x2fb)]==_0x1244a1&&_0x3a23ff==_0x1d1627?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x4d70ae=>{const _0x318b9a=_0x17b685;if(_0x4d70ae){const _0x35dadc=devices[_0x4d70ae]['ip'];return jwt[_0x318b9a(0x22f)]({'username':settings[_0x318b9a(0x2fb)],'clientip':_0x35dadc},secure[_0x318b9a(0x36b)]+_0x4d70ae,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x18d667=>{const _0xbb584f=_0x17b685;if(_0x18d667){const _0x854ff9=devices[_0x18d667]['ip'];return jwt[_0xbb584f(0x22f)]({'clientip':_0x854ff9},secure['secret']+_0x18d667,{'expiresIn':devices[_0x18d667][_0xbb584f(0x218)][_0xbb584f(0x2f3)]*0x3c});}else return![];},telegramIpApproved=_0x4f1c3f=>{const _0x2dece6=_0x17b685;let _0x1ef3d9=![];return devices[_0x4f1c3f][_0x2dece6(0x218)]&&devices[_0x4f1c3f][_0x2dece6(0x218)]['expiry']!=_0x2dece6(0x24d)&&(_0x1ef3d9=devices[_0x4f1c3f][_0x2dece6(0x218)]['clientip']==devices[_0x4f1c3f]['ip']&&new Date()['getTime']()-devices[_0x4f1c3f][_0x2dece6(0x218)][_0x2dece6(0x1d1)]<devices[_0x4f1c3f][_0x2dece6(0x218)][_0x2dece6(0x2f3)]*0x3c*0x3e8),_0x1ef3d9;},telegram2FaApproved=_0x529df3=>{const _0x194b79=_0x17b685;let _0x18b521=![];return devices[_0x529df3][_0x194b79(0x23f)]&&devices[_0x529df3][_0x194b79(0x23f)]['expiry']!='reject'&&(_0x18b521=devices[_0x529df3][_0x194b79(0x23f)][_0x194b79(0x1f7)]==devices[_0x529df3]['ip']&&new Date()['getTime']()-devices[_0x529df3][_0x194b79(0x23f)][_0x194b79(0x1d1)]<devices[_0x529df3][_0x194b79(0x23f)][_0x194b79(0x2f3)]*0x3c*0x3e8),_0x18b521;},normalizeIP=_0x2b247d=>{const _0x2d46dd=_0x17b685;let _0x3e424e=null,_0x4d7671=null;if(ipaddr['isValid'](_0x2b247d)){const _0x45b18b=ipaddr[_0x2d46dd(0x36c)](_0x2b247d);_0x45b18b['kind']()===_0x2d46dd(0x32d)?(_0x45b18b[_0x2d46dd(0x28b)]()&&(_0x3e424e=_0x45b18b[_0x2d46dd(0x2e0)]()[_0x2d46dd(0x27a)]()),_0x4d7671=_0x45b18b['toString']()):(_0x3e424e=_0x45b18b[_0x2d46dd(0x27a)](),_0x4d7671=_0x45b18b['toIPv4MappedAddress']()[_0x2d46dd(0x27a)]());}return{'show':_0x3e424e?_0x3e424e:_0x4d7671,'store':_0x4d7671};};function formatDate(_0x43d2da){const _0x2d90bb=_0x17b685;return _0x43d2da[_0x2d90bb(0x276)]()+'/'+(_0x43d2da[_0x2d90bb(0x30f)]()+0x1)['toString']()[_0x2d90bb(0x25e)](0x2,'0')+'/'+_0x43d2da['getDate']()[_0x2d90bb(0x27a)]()[_0x2d90bb(0x25e)](0x2,'0')+'\x20'+_0x43d2da[_0x2d90bb(0x343)]()[_0x2d90bb(0x27a)]()['padStart'](0x2,'0')+':'+_0x43d2da['getMinutes']()['toString']()[_0x2d90bb(0x25e)](0x2,'0')+':'+_0x43d2da[_0x2d90bb(0x274)]()['toString']()[_0x2d90bb(0x25e)](0x2,'0');}function sleep(_0x122dd1){return new Promise(_0x137f9c=>setTimeout(_0x137f9c,_0x122dd1));}