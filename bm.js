const _0x21dae9=_0x2aa0;(function(_0x2a111e,_0x4078aa){const _0x5052b5=_0x2aa0,_0x134a55=_0x2a111e();while(!![]){try{const _0x130a4c=parseInt(_0x5052b5(0x1d4))/0x1*(parseInt(_0x5052b5(0x1df))/0x2)+-parseInt(_0x5052b5(0x252))/0x3+parseInt(_0x5052b5(0x303))/0x4*(parseInt(_0x5052b5(0x1d5))/0x5)+parseInt(_0x5052b5(0x33a))/0x6+-parseInt(_0x5052b5(0x1c7))/0x7*(parseInt(_0x5052b5(0x196))/0x8)+-parseInt(_0x5052b5(0x1db))/0x9+parseInt(_0x5052b5(0x1d3))/0xa*(parseInt(_0x5052b5(0x335))/0xb);if(_0x130a4c===_0x4078aa)break;else _0x134a55['push'](_0x134a55['shift']());}catch(_0x158015){_0x134a55['push'](_0x134a55['shift']());}}}(_0x55ed,0x7231e));const _0x5dad77=function(){let _0x50d9d9=!![];return function(_0x4eb3b0,_0x5714d7){const _0x117939=_0x50d9d9?function(){const _0x1b89ec=_0x2aa0;if(_0x5714d7){const _0x1249d8=_0x5714d7[_0x1b89ec(0x336)](_0x4eb3b0,arguments);return _0x5714d7=null,_0x1249d8;}}:function(){};return _0x50d9d9=![],_0x117939;};}(),_0x1b16a4=_0x5dad77(this,function(){const _0x21fa7f=_0x2aa0;return _0x1b16a4[_0x21fa7f(0x1d2)]()[_0x21fa7f(0x1b3)](_0x21fa7f(0x209))[_0x21fa7f(0x1d2)]()['constructor'](_0x1b16a4)[_0x21fa7f(0x1b3)](_0x21fa7f(0x209));});_0x1b16a4();'use strict';process[_0x21dae9(0x2fe)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x21dae9(0x319)),low=require(_0x21dae9(0x194)),FileSync=require(_0x21dae9(0x346)),path=require(_0x21dae9(0x22b)),crypto=require('crypto'),Crypt=require(_0x21dae9(0x167))[_0x21dae9(0x16e)],RSA=require('hybrid-crypto-js')[_0x21dae9(0x288)],bcrypt=require(_0x21dae9(0x1d9)),jwt=require(_0x21dae9(0x1bb)),ipaddr=require(_0x21dae9(0x2c0)),argv=require(_0x21dae9(0x24c))(process[_0x21dae9(0x2a1)][_0x21dae9(0x278)](0x2))['argv'],uuidRandom=require(_0x21dae9(0x28d)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x21dae9(0x32e)),axios=require(_0x21dae9(0x31e)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x21dae9(0x15a)),fileUpload=require(_0x21dae9(0x2d4)),{networkInterfaces}=require('os'),PORT=argv[_0x21dae9(0x258)]||_0x21dae9(0x1d0),pattern=/^[0-9]{2,4}$/;!pattern[_0x21dae9(0x182)](PORT)&&(console[_0x21dae9(0x26b)](_0x21dae9(0x190)+PORT+_0x21dae9(0x15b)),process['exit'](0x1));const HOST=argv[_0x21dae9(0x2c2)]||null,userID=argv[_0x21dae9(0x334)]||'',debugging=argv['d']||![],nodeversion=process['versions']['node'];let bbpath=_0x21dae9(0x1d7),bbpath2='';const botfile=_0x21dae9(0x215),configfile=_0x21dae9(0x25f),settingsfile='bb-settings.json',securefile=_0x21dae9(0x2d0),environment=require('./'+bbpath2+_0x21dae9(0x1ba))[_0x21dae9(0x263)]||_0x21dae9(0x14e),maxBackups=0xa;let validInstallation=!![];!fs[_0x21dae9(0x228)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x21dae9(0x314)),configpath=userID?bbpath+_0x21dae9(0x23b)+userID+'/':bbpath+_0x21dae9(0x23b),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x21dae9(0x1e8)+userID+'/':bbpath+_0x21dae9(0x1e8),loggerfile=fs[_0x21dae9(0x32a)](logspath+_0x21dae9(0x14f),{'flags':'a'}),temppath=userID?bbpath+_0x21dae9(0x1a9)+userID+'/':bbpath+_0x21dae9(0x1a9);!fs[_0x21dae9(0x228)](configpath)&&fs[_0x21dae9(0x287)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x21dae9(0x287)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x21dae9(0x287)](logspath);!fs[_0x21dae9(0x228)](zippath)&&fs[_0x21dae9(0x287)](zippath);!fs[_0x21dae9(0x228)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x21dae9(0x208)]({'bots':[]})[_0x21dae9(0x230)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x21dae9(0x230)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x21dae9(0x208)]({'secure':{},'blacklist':[]})[_0x21dae9(0x230)]();let crypt=new Crypt({'md':_0x21dae9(0x1f3),'rsaStandard':_0x21dae9(0x206)});const saltRounds=0xa,mixpanel=Mixpanel[_0x21dae9(0x166)](_0x21dae9(0x2f2),{'host':_0x21dae9(0x2c4)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x21dae9(0x16f)]&&(settings[_0x21dae9(0x16f)]!=''&&settings[_0x21dae9(0x16f)]!=_0x21dae9(0x20f))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x3f193f,_0x58d33e)=>{const _0x538934=_0x21dae9,_0x582a74=/#[A-Z]{3}#/g;if(typeof _0x3f193f==_0x538934(0x1e3)){!_0x58d33e?_0x3f193f=_0x3f193f[_0x538934(0x313)](_0x582a74,''):(_0x3f193f=_0x3f193f['replace'](/#BLU#/g,_0x538934(0x347)),_0x3f193f=_0x3f193f[_0x538934(0x313)](/#RED#/g,'\x1b[31m'),_0x3f193f=_0x3f193f['replace'](/#YEL#/g,'\x1b[33m'),_0x3f193f=_0x3f193f[_0x538934(0x313)](/#MAG#/g,_0x538934(0x250)),_0x3f193f=_0x3f193f[_0x538934(0x313)](/#CYA#/g,'\x1b[36m'),_0x3f193f=_0x3f193f[_0x538934(0x313)](/#RES#/g,_0x538934(0x1e2)));;}return _0x3f193f;},logger={'screen':_0x108499=>{const _0x3af576=_0x21dae9;console[_0x3af576(0x26b)](parseColor(_0x108499,!![]));},'simple':_0x4ef511=>{const _0x346c41=_0x21dae9;console[_0x346c41(0x26b)](parseColor(_0x4ef511,!![])),loggerfile[_0x346c41(0x230)](util[_0x346c41(0x1e7)](parseColor(_0x4ef511,![]))+'\x0a');},'full':async _0x44fcae=>{const _0x2e1cf8=_0x21dae9,_0x5dcd87=getTimeStamp()+_0x2e1cf8(0x33d)+_0x44fcae;console['log'](parseColor(_0x5dcd87,!![])),loggerfile[_0x2e1cf8(0x230)](util[_0x2e1cf8(0x1e7)](parseColor(_0x5dcd87,![]))+'\x0a');if(tgBot&&settings[_0x2e1cf8(0x32b)]&&settings[_0x2e1cf8(0x226)]!=_0x2e1cf8(0x171))await sendTelegram(settings[_0x2e1cf8(0x32b)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x44fcae,![]));},'debug':async(_0x45ee48,_0x41fa85='')=>{const _0x312b2d=_0x21dae9,_0x64748e=getTimeStamp()+_0x312b2d(0x21e)+_0x45ee48;if(debugging)console[_0x312b2d(0x26b)](parseColor(_0x64748e,!![]));loggerfile[_0x312b2d(0x230)](util[_0x312b2d(0x1e7)](parseColor(_0x64748e,![]))+'\x0a');if(_0x41fa85){if(debugging)console[_0x312b2d(0x26b)](_0x41fa85);loggerfile[_0x312b2d(0x230)](util[_0x312b2d(0x1e7)](_0x41fa85)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x2a5d71){const _0x4086b7=_0x21dae9;logger[_0x4086b7(0x325)](_0x2a5d71);}),process['on'](_0x21dae9(0x21d),()=>{stopAllBots();}),process['on'](_0x21dae9(0x1fa),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x21dae9(0x1ba))[_0x21dae9(0x1c5)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x21dae9(0x1c2)),app=express(),http=require('http')['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x21dae9(0x2bb),async(_0x333f40,_0x3e341e)=>{const _0x2a756d=_0x21dae9,_0x4f7e96=_0x333f40['params'][_0x2a756d(0x2f0)],_0x3f6e55=getClientsWithBotID(_0x2a756d(0x23e)),_0x54f20f=_0x333f40['headers'][_0x2a756d(0x217)],_0xf1bbba=timelyDecrypt(_0x54f20f,![]),_0x4cde03=_0x3f6e55[_0x2a756d(0x1ee)](_0x3123a8=>_0x3123a8[_0x2a756d(0x217)]==_0xf1bbba);if(_0x4cde03){const _0x5a3381=normalizeIP(_0x333f40[_0x2a756d(0x165)][_0x2a756d(0x2c5)])[_0x2a756d(0x266)],_0x104afc=_0x333f40[_0x2a756d(0x15c)][_0x2a756d(0x26c)];if(validateAccess(_0x104afc,_0xf1bbba,_0x5a3381)[_0x2a756d(0x181)])_0x4f7e96==_0x2a756d(0x267)&&await backupConfigFiles(),await zipFiles(_0x4f7e96),_0x3e341e[_0x2a756d(0x185)](zippath+(_0x4f7e96+_0x2a756d(0x1bd)),_0x26dc7c=>{const _0x421309=_0x2a756d;_0x26dc7c&&(logger['full'](_0x421309(0x17e)+_0x4f7e96),logger[_0x421309(0x325)](_0x26dc7c));});else logger['full'](_0x2a756d(0x2ce)+_0x4f7e96+_0x2a756d(0x2a2));}else logger[_0x2a756d(0x163)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x4f7e96+'\x20(2)');}),app[_0x21dae9(0x186)]('/upload-backup',async(_0x211af8,_0x1fce78)=>{const _0x18fd71=_0x21dae9,_0x484baa=getClientsWithBotID(_0x18fd71(0x23e)),_0x2467cf=_0x211af8[_0x18fd71(0x15c)][_0x18fd71(0x217)],_0x1bfade=timelyDecrypt(_0x2467cf,![]),_0x59c58d=_0x484baa[_0x18fd71(0x1ee)](_0xe282ab=>_0xe282ab['uuid']==_0x1bfade);logger[_0x18fd71(0x1e9)](_0x18fd71(0x284));if(_0x59c58d){const _0x1badd7=normalizeIP(_0x211af8[_0x18fd71(0x165)][_0x18fd71(0x2c5)])['store'],_0x826cb4=_0x211af8['headers'][_0x18fd71(0x26c)];if(validateAccess(_0x826cb4,_0x1bfade,_0x1badd7)[_0x18fd71(0x181)]){if(_0x211af8[_0x18fd71(0x27d)]){const _0x360968=_0x211af8[_0x18fd71(0x27d)][_0x18fd71(0x1da)];await _0x360968['mv'](temppath+_0x360968[_0x18fd71(0x2c1)]),_0x1fce78[_0x18fd71(0x1eb)]({'status':!![],'message':_0x18fd71(0x236)});const _0x1db38d=getBotsWithMode();_0x1db38d['length']>0x0?confirmRestore(temppath,_0x360968['name']):unzipFile(temppath,_0x360968['name']);}}else logger[_0x18fd71(0x163)](_0x18fd71(0x1b2));}else logger[_0x18fd71(0x163)](_0x18fd71(0x309));}),app[_0x21dae9(0x175)](express[_0x21dae9(0x1b8)](path[_0x21dae9(0x271)](__dirname,bbpath2,'build2'))),app[_0x21dae9(0x175)](express[_0x21dae9(0x1b8)](path[_0x21dae9(0x271)](__dirname,bbpath2,_0x21dae9(0x27e)))),app[_0x21dae9(0x2df)]('/',function(_0x52fed7,_0x5a189b){const _0x281db6=_0x21dae9;_0x5a189b[_0x281db6(0x1f2)](path[_0x281db6(0x271)](__dirname,bbpath2,_0x281db6(0x245),_0x281db6(0x210)));}),app[_0x21dae9(0x2df)](_0x21dae9(0x15e),function(_0x59aa76,_0x4221d1){const _0x108a4c=_0x21dae9;_0x4221d1[_0x108a4c(0x1f2)](path[_0x108a4c(0x271)](__dirname,bbpath2,_0x108a4c(0x27e),_0x108a4c(0x210)));}),app[_0x21dae9(0x2df)](_0x21dae9(0x23c),(_0xd070a1,_0x66a669)=>{const _0x3b24e3=_0x21dae9;_0x66a669[_0x3b24e3(0x1f2)](path[_0x3b24e3(0x271)](__dirname,bbpath2,_0x3b24e3(0x27e),_0x3b24e3(0x210)));}),app[_0x21dae9(0x2df)](_0x21dae9(0x180),(_0xf28bce,_0x18b3fa)=>{const _0x286858=_0x21dae9;_0x18b3fa[_0x286858(0x1f2)](path['join'](__dirname,bbpath2,_0x286858(0x27e),_0x286858(0x210)));}),app[_0x21dae9(0x2df)](_0x21dae9(0x26a),(_0x315d5a,_0xf06b3)=>{const _0x4e29d0=_0x21dae9;_0xf06b3[_0x4e29d0(0x1f2)](path[_0x4e29d0(0x271)](__dirname,bbpath2,'build',_0x4e29d0(0x210)));}),app[_0x21dae9(0x2df)](_0x21dae9(0x1b9),(_0x5dd73b,_0x5ec3cb)=>{const _0x398b3a=_0x21dae9;_0x5ec3cb['sendFile'](path[_0x398b3a(0x271)](__dirname,bbpath2,_0x398b3a(0x27e),_0x398b3a(0x210)));}),app[_0x21dae9(0x2df)]('/:bot/configuration',(_0x288cbb,_0xe275eb)=>{const _0x507923=_0x21dae9;_0xe275eb[_0x507923(0x1f2)](path[_0x507923(0x271)](__dirname,bbpath2,_0x507923(0x27e),'index.html'));}),app['get']('/:bot/support',(_0x110b50,_0x2c5315)=>{const _0x37cb97=_0x21dae9;_0x2c5315[_0x37cb97(0x1f2)](path[_0x37cb97(0x271)](__dirname,bbpath2,_0x37cb97(0x27e),_0x37cb97(0x210)));});if(HOST)http[_0x21dae9(0x2a3)](PORT,HOST);else http[_0x21dae9(0x2a3)](PORT);const io=require(_0x21dae9(0x24e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x169b5b=_0x21dae9;let _0x44d932=_0x169b5b(0x307);const _0x1302aa=networkInterfaces(),_0x2a8fa8={};for(const _0x4b00b8 of Object[_0x169b5b(0x264)](_0x1302aa)){for(const _0x10f2b8 of _0x1302aa[_0x4b00b8]){if((_0x10f2b8['family']==_0x169b5b(0x30a)||_0x10f2b8[_0x169b5b(0x151)]==0x4)&&!_0x10f2b8[_0x169b5b(0x170)]){const _0x19c201=ipaddr[_0x169b5b(0x207)](_0x10f2b8['address'])[_0x169b5b(0x2b3)]();_0x19c201!=_0x169b5b(0x2b4)&&(!_0x2a8fa8[_0x4b00b8]&&(_0x2a8fa8[_0x4b00b8]=[]),_0x2a8fa8[_0x4b00b8][_0x169b5b(0x343)](_0x10f2b8['address']),_0x44d932=_0x10f2b8[_0x169b5b(0x28f)]);}}}return{'serverip':_0x44d932,'netinterfaces':_0x2a8fa8};}async function startServer(){const _0x39fb92=_0x21dae9,{serverip:_0x13877b,netinterfaces:_0x1e594f}=getServerIP();logger['simple'](''),logger[_0x39fb92(0x325)]('-----------------------------------------------------------------------------------'),await logger[_0x39fb92(0x163)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x39fb92(0x2a4)+(environment==_0x39fb92(0x1ef)?_0x39fb92(0x251):'')+'\x0a'+(_0x39fb92(0x2cd)+PORT+_0x39fb92(0x2ee))+(_0x39fb92(0x29e)+_0x13877b+':'+PORT+_0x39fb92(0x1b4))),logger[_0x39fb92(0x325)]('-----------------------------------------------------------------------------------');if(config[_0x39fb92(0x1ea)]!=0x0)for(const _0x2bf9c4 of config){const _0x321766=_0x2bf9c4[_0x39fb92(0x273)]==_0x39fb92(0x1ed)?'a':'m';if(_0x2bf9c4[_0x39fb92(0x220)]==_0x39fb92(0x257)||_0x2bf9c4['status']==_0x39fb92(0x33f))await logger['full'](_0x39fb92(0x328)+_0x321766+_0x39fb92(0x239)+_0x2bf9c4['botID']+'\x20|\x20'+_0x2bf9c4[_0x39fb92(0x2bd)]),startBot([_0x2bf9c4[_0x39fb92(0x30c)],userID],{'cwd':bbpath},function(_0x1dde82){const _0x1a1682=_0x39fb92;if(_0x1dde82)logger[_0x1a1682(0x163)](_0x1dde82);});else(_0x2bf9c4['status']==_0x39fb92(0x1aa)||_0x2bf9c4['status']==_0x39fb92(0x2bf))&&await logger[_0x39fb92(0x163)](_0x39fb92(0x345)+_0x321766+_0x39fb92(0x153)+_0x2bf9c4['botID']+'\x20|\x20'+_0x2bf9c4['botname']);}else!newBot&&logger[_0x39fb92(0x325)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x39fb92(0x325)](_0x39fb92(0x29c)),logger[_0x39fb92(0x325)](''),await logger[_0x39fb92(0x1e9)](_0x39fb92(0x198)+nodeversion),await logger['debug'](_0x39fb92(0x232),_0x1e594f);}function startSocket(){const _0x1d3eaa=_0x21dae9;io['on'](_0x1d3eaa(0x2a6),_0xac8079=>{const _0x5e27e7=_0x1d3eaa;let _0x46c128,_0x2e339b,_0x214043,_0x37608e,_0x37d8af;const _0x319e52=_0xac8079[_0x5e27e7(0x176)][_0x5e27e7(0x15c)][_0x5e27e7(0x2e5)];_0x2e339b=_0x319e52['match'](/bot[0-9]{3}/);if(_0x2e339b)_0x214043=_0x2e339b[0x0][_0x5e27e7(0x235)](/[0-9]{3}/);if(_0x214043)_0x46c128=_0x214043[0x0];else _0x46c128='botmanager';const _0x416326=_0xac8079[_0x5e27e7(0x176)]['auth']['encryptedUuid'];if(!_0x416326)_0xac8079[_0x5e27e7(0x157)]('status',{'publicKey':secure[_0x5e27e7(0x32d)]});else{_0x37608e=timelyDecrypt(_0x416326,![]);if(!_0x37608e)_0xac8079[_0x5e27e7(0x157)](_0x5e27e7(0x220),{'publicKey':secure['publicKey']});else{_0x37d8af=normalizeIP(_0xac8079[_0x5e27e7(0x28a)][_0x5e27e7(0x2c5)])[_0x5e27e7(0x266)];if(!devices[_0x37608e])devices[_0x37608e]={'uuid':_0x37608e,'access':{'token':null}};devices[_0x37608e]['ip']=_0x37d8af;const _0x4a3682=addClient(_0xac8079['id'],_0x37608e,_0x46c128);setAccess(_0x4a3682),emitMessages(),_0xac8079['on'](_0x5e27e7(0x28c),_0x2033b3=>{const _0x1cc05d=_0x5e27e7,_0x3e24aa=timelyDecrypt(_0x2033b3[_0x1cc05d(0x285)]);if(_0x3e24aa){_0x2033b3={'username':_0x2033b3[_0x1cc05d(0x1cd)],'password':_0x3e24aa},devices[_0x37608e]['access']=validateCredentials(_0x2033b3,_0x37608e);if(devices[_0x37608e][_0x1cc05d(0x2bc)]['allow']==![]&&devices[_0x37608e][_0x1cc05d(0x2bc)][_0x1cc05d(0x30b)]==_0x1cc05d(0x1b5))_0xac8079[_0x1cc05d(0x157)](_0x1cc05d(0x220),{'access':devices[_0x37608e][_0x1cc05d(0x2bc)]}),loginAccess2FA(_0x37608e,_0x37d8af);else{if(devices[_0x37608e][_0x1cc05d(0x2bc)]['allow']==![]&&devices[_0x37608e][_0x1cc05d(0x2bc)][_0x1cc05d(0x30b)]==_0x1cc05d(0x1af))_0xac8079['emit'](_0x1cc05d(0x220),{'access':devices[_0x37608e][_0x1cc05d(0x2bc)]});else devices[_0x37608e][_0x1cc05d(0x2bc)][_0x1cc05d(0x181)]&&devices[_0x37608e][_0x1cc05d(0x2bc)]['reason']==_0x1cc05d(0x1c3)&&(getClientsWithUuid(_0x37608e)[_0x1cc05d(0x29f)](_0x3174fe=>{setAccess(_0x3174fe);}),logger[_0x1cc05d(0x1e9)](_0x1cc05d(0x26e)+_0x37608e[_0x1cc05d(0x278)](-0x8)),setTokenRefresh(_0x37608e),setSessionTimeout(_0x1cc05d(0x28c),_0x37608e));}}else logger[_0x1cc05d(0x163)](_0x1cc05d(0x1ec));}),_0xac8079['on'](_0x5e27e7(0x183),()=>{resetPassword();}),_0xac8079['on'](_0x5e27e7(0x1c9),_0x38a61e=>{removeClient(_0xac8079['id']);}),_0x46c128==_0x5e27e7(0x23e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x552f88){const _0x5e472b=_0x21dae9;if(_0x552f88!='botmanager'&&config[_0x5e472b(0x25a)]!=''){if(pid[_0x552f88])pid[_0x552f88]['send']({'function':_0x5e472b(0x211),'args':null});}_0x552f88!='botmanager'&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x1c9b2a=_0x21dae9;getClientsWithBotID(_0x1c9b2a(0x23e))[_0x1c9b2a(0x29f)](_0x451cb1=>{const _0x5ee432=_0x1c9b2a;getSocket(_0x451cb1['id'])[_0x5ee432(0x157)](_0x5ee432(0x220),{'access':{'allow':![],'reason':_0x5ee432(0x286),'token':null}});});}function getSocket(_0x7aba50){const _0x3d0ddc=_0x21dae9;return io['sockets'][_0x3d0ddc(0x1d1)][_0x3d0ddc(0x2df)](_0x7aba50);}function setAccess(_0x3e1f8a){const _0x46f920=_0x21dae9,_0x5c3cc6=getSocket(_0x3e1f8a['id']),_0x261a6e=_0x3e1f8a[_0x46f920(0x217)],_0xbcb3c=_0x3e1f8a['bot'];devices[_0x261a6e]['access']=validateAccess(devices[_0x261a6e][_0x46f920(0x2bc)][_0x46f920(0x26f)],_0x261a6e),logger[_0x46f920(0x1e9)]('Setting\x20access:\x20'+devices[_0x261a6e][_0x46f920(0x2bc)][_0x46f920(0x30b)]+_0x46f920(0x1f5)+_0x3e1f8a['id']['slice'](-0x8)+_0x46f920(0x326)+_0x261a6e[_0x46f920(0x278)](-0x8)),_0x5c3cc6['join'](_0x261a6e);if(devices[_0x261a6e][_0x46f920(0x2bc)]['allow']){_0x5c3cc6[_0x46f920(0x271)](_0xbcb3c);if(_0xbcb3c==_0x46f920(0x23e))initializeSocketBotManager(_0x5c3cc6);else initializeSocketBot(_0x5c3cc6);initClient(_0xbcb3c);}devices[_0x261a6e][_0x46f920(0x2bc)]['token']&&devices[_0x261a6e]['access'][_0x46f920(0x30b)]==_0x46f920(0x2f1)&&setSessionTimeout(_0x46f920(0x31b),_0x261a6e),devices[_0x261a6e][_0x46f920(0x2bc)][_0x46f920(0x26f)]&&devices[_0x261a6e]['access'][_0x46f920(0x30b)]==_0x46f920(0x33e)&&setSessionTimeout('login',_0x261a6e),_0x5c3cc6['emit'](_0x46f920(0x220),{'status':_0x3e1f8a[_0x46f920(0x173)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x261a6e][_0x46f920(0x2bc)],'externalip':devices[_0x261a6e]['ip'],'publicKey':secure[_0x46f920(0x32d)],'userid':settings[_0x46f920(0x295)],'validInstallation':validInstallation}),devices[_0x261a6e][_0x46f920(0x2bc)][_0x46f920(0x181)]==![]&&devices[_0x261a6e][_0x46f920(0x2bc)][_0x46f920(0x30b)]=='2FA\x20required'&&temporaryAccess2FA(_0x261a6e,devices[_0x261a6e]['ip']);}function setSessionTimeout(_0x39a863,_0xaf6b23){const _0x5c29a8=_0x21dae9;let _0x34a1ac;if(_0x39a863==_0x5c29a8(0x28c))_0x34a1ac=loginExpiry*0x3c*0x3e8;else _0x34a1ac=devices[_0xaf6b23][_0x5c29a8(0x2eb)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0xaf6b23][_0x5c29a8(0x2eb)][_0x5c29a8(0x2b1)]);if(devices[_0xaf6b23][_0x5c29a8(0x227)])clearTimeout(devices[_0xaf6b23]['pidExpireLogin']);devices[_0xaf6b23][_0x5c29a8(0x227)]=setTimeout(()=>{const _0x56e9ed=_0x5c29a8;if(devices[_0xaf6b23][_0x56e9ed(0x329)])clearTimeout(devices[_0xaf6b23][_0x56e9ed(0x329)]);removeSocketListeners(_0xaf6b23),addBlacklist(_0xaf6b23),devices[_0xaf6b23][_0x56e9ed(0x2eb)]=null,devices[_0xaf6b23][_0x56e9ed(0x164)]=null,devices[_0xaf6b23][_0x56e9ed(0x2bc)][_0x56e9ed(0x26f)]=null,logger[_0x56e9ed(0x1e9)](_0x56e9ed(0x204)+_0xaf6b23[_0x56e9ed(0x278)](-0x8)),devices[_0xaf6b23][_0x56e9ed(0x2bc)]=validateAccess(devices[_0xaf6b23][_0x56e9ed(0x2bc)]['token'],_0xaf6b23),!(devices[_0xaf6b23]['access'][_0x56e9ed(0x181)]&&devices[_0xaf6b23]['access'][_0x56e9ed(0x30b)]==_0x56e9ed(0x2a0))&&(_0x39a863=='login'?io['to'](_0xaf6b23)[_0x56e9ed(0x157)](_0x56e9ed(0x220),{'access':{'allow':![],'reason':_0x56e9ed(0x1a5),'token':null}}):io['to'](_0xaf6b23)[_0x56e9ed(0x157)](_0x56e9ed(0x220),{'access':{'allow':![],'reason':_0x56e9ed(0x240),'token':null}})),devices[_0xaf6b23][_0x56e9ed(0x2bc)][_0x56e9ed(0x26f)]=null;},_0x34a1ac);}function setTokenRefresh(_0x4e5025){const _0x1fa607=_0x21dae9;if(devices[_0x4e5025][_0x1fa607(0x329)])clearTimeout(devices[_0x4e5025]['pidRefreshToken']);devices[_0x4e5025][_0x1fa607(0x329)]=setTimeout(()=>{const _0xa26dbd=_0x1fa607;getClientsWithUuid(_0x4e5025)[_0xa26dbd(0x1ea)]!=0x0?(devices[_0x4e5025][_0xa26dbd(0x2bc)]=refreshToken(_0x4e5025),io['to'](_0x4e5025)[_0xa26dbd(0x157)]('status',{'status':_0xa26dbd(0x262),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4e5025][_0xa26dbd(0x2bc)],'externalip':devices[_0x4e5025]['ip'],'publicKey':secure[_0xa26dbd(0x32d)],'validInstallation':validInstallation}),setTokenRefresh(_0x4e5025)):clearTimeout(devices[_0x4e5025]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4975f8){const _0x21f9ef=_0x21dae9,_0x1e8f9e=getClient(_0x4975f8['id'])[_0x21f9ef(0x217)];_0x4975f8['emit'](_0x21f9ef(0x1a3),config),_0x4975f8['emit']('settings',cleanSettings()),_0x4975f8['on'](_0x21f9ef(0x2a9),_0x44ef9d=>{const _0x18fd61=_0x21f9ef;if(validateAccess(_0x44ef9d,_0x1e8f9e)['allow'])addBot();else logger[_0x18fd61(0x163)](_0x18fd61(0x154));}),_0x4975f8['on'](_0x21f9ef(0x2ed),(_0x442b4b,_0x14b552)=>{const _0x1af33f=_0x21f9ef;if(validateAccess(_0x14b552,_0x1e8f9e)[_0x1af33f(0x181)])toggleBot(_0x442b4b[_0x1af33f(0x30c)],_0x442b4b[_0x1af33f(0x220)],_0x442b4b['live']);else logger[_0x1af33f(0x163)](_0x1af33f(0x248));}),_0x4975f8['on']('toggle-bot-mode',(_0x36282c,_0x1a7a58)=>{const _0x54176e=_0x21f9ef;if(validateAccess(_0x1a7a58,_0x1e8f9e)[_0x54176e(0x181)])toggleBotMode(_0x36282c);else logger[_0x54176e(0x163)](_0x54176e(0x248));}),_0x4975f8['on']('delete-bot',(_0x217df9,_0x516720)=>{if(validateAccess(_0x516720,_0x1e8f9e)['allow'])deleteBot(_0x217df9);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4975f8['on'](_0x21f9ef(0x1f4),(_0x5c7883,_0x31a296)=>{const _0x5b52d4=_0x21f9ef;if(validateAccess(_0x31a296,_0x1e8f9e)['allow'])storeSettings(_0x5c7883,!![]);else logger[_0x5b52d4(0x163)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4975f8['on'](_0x21f9ef(0x1c1),_0x227e42=>{const _0x2eea3e=_0x21f9ef;if(validateAccess(_0x227e42,_0x1e8f9e)[_0x2eea3e(0x181)])updateBB('update');else logger['full'](_0x2eea3e(0x2b9));}),_0x4975f8['on']('reinstall-bb',_0x24abd0=>{const _0x594caf=_0x21f9ef;if(validateAccess(_0x24abd0,_0x1e8f9e)[_0x594caf(0x181)])updateBB('reinstall');else logger[_0x594caf(0x163)](_0x594caf(0x2b7));}),_0x4975f8['on'](_0x21f9ef(0x305),_0x2886d0=>{const _0x436866=_0x21f9ef;if(validateAccess(_0x2886d0,_0x1e8f9e)[_0x436866(0x181)]){const _0xf36e07=getClient(_0x4975f8['id']);if(_0xf36e07)getBackupFiles(_0xf36e07['uuid']);else logger[_0x436866(0x163)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x4975f8['on']('restore-backup-file',(_0x21db85,_0x1a7c8d)=>{const _0x498ad8=_0x21f9ef;if(validateAccess(_0x1a7c8d,_0x1e8f9e)['allow'])restoreBackupFile(_0x21db85);else logger[_0x498ad8(0x163)](_0x498ad8(0x317));}),_0x4975f8['on'](_0x21f9ef(0x1a6),_0x40de5e=>{const _0x458c1b=_0x21f9ef;if(validateAccess(_0x40de5e,_0x1e8f9e)[_0x458c1b(0x181)])getMessages();else logger[_0x458c1b(0x163)](_0x458c1b(0x2f9));}),_0x4975f8['on']('confirm-message',(_0x5c0dfc,_0x4dd863)=>{const _0x34c2fc=_0x21f9ef;if(validateAccess(_0x4dd863,_0x1e8f9e)[_0x34c2fc(0x181)])confirmMessage(_0x5c0dfc);else logger[_0x34c2fc(0x163)](_0x34c2fc(0x25d));}),_0x4975f8['on'](_0x21f9ef(0x302),_0x25bff6=>{const _0x4d5b35=_0x21f9ef;if(validateAccess(_0x25bff6,_0x1e8f9e)[_0x4d5b35(0x181)]){if(devices[_0x1e8f9e][_0x4d5b35(0x329)])clearTimeout(devices[_0x1e8f9e]['pidRefreshToken']);if(devices[_0x1e8f9e][_0x4d5b35(0x227)])clearTimeout(devices[_0x1e8f9e][_0x4d5b35(0x227)]);removeSocketListeners(getClient(_0x4975f8['id'])[_0x4d5b35(0x217)]),addBlacklist(_0x1e8f9e),devices[_0x1e8f9e][_0x4d5b35(0x2eb)]=null,devices[_0x1e8f9e][_0x4d5b35(0x164)]=null,devices[_0x1e8f9e][_0x4d5b35(0x2bc)][_0x4d5b35(0x26f)]=null,logger[_0x4d5b35(0x1e9)](_0x4d5b35(0x2f7)+_0x1e8f9e['slice'](-0x8)),io['to'](getClient(_0x4975f8['id'])[_0x4d5b35(0x217)])[_0x4d5b35(0x157)]('status',{'access':{'allow':![],'reason':_0x4d5b35(0x16b),'token':null}});}else logger[_0x4d5b35(0x163)](_0x4d5b35(0x304));});}function initializeSocketBot(_0x28f63f){const _0x34aa22=_0x21dae9,_0x1c37c4=getClient(_0x28f63f['id'])[_0x34aa22(0x281)],_0x4e3fb2=getClient(_0x28f63f['id'])[_0x34aa22(0x217)];_0x28f63f['on']('get-logs',(_0x463fcd,_0x1ab3c6)=>{const _0x4453ff=_0x34aa22;if(validateAccess(_0x1ab3c6,_0x4e3fb2)[_0x4453ff(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4]['send']({'function':_0x4453ff(0x2e9),'args':_0x463fcd});}else logger[_0x4453ff(0x163)](_0x4453ff(0x1a2));}),_0x28f63f['on'](_0x34aa22(0x260),(_0x4609dc,_0x2938f0)=>{const _0x1a0404=_0x34aa22;if(validateAccess(_0x2938f0,_0x4e3fb2)[_0x1a0404(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4][_0x1a0404(0x1eb)]({'function':'deleteHistoryAlerts','args':_0x4609dc});}else logger['full'](_0x1a0404(0x2e8));}),_0x28f63f['on'](_0x34aa22(0x18e),(_0x3412ef,_0x3fb092)=>{const _0x7be758=_0x34aa22;if(validateAccess(_0x3fb092,_0x4e3fb2)['allow']){if(pid[_0x1c37c4])pid[_0x1c37c4]['send']({'function':_0x7be758(0x223),'args':_0x3412ef});}else logger[_0x7be758(0x163)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x28f63f['on'](_0x34aa22(0x19b),(_0x4e4855,_0x35ee01)=>{const _0x12cdca=_0x34aa22;if(validateAccess(_0x35ee01,_0x4e3fb2)[_0x12cdca(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4][_0x12cdca(0x1eb)]({'function':'storeConfiguration','args':_0x4e4855});}else logger['full'](_0x12cdca(0x2af));}),_0x28f63f['on']('store-headless',(_0x303340,_0x6f10a4)=>{const _0x26f715=_0x34aa22;if(validateAccess(_0x6f10a4,_0x4e3fb2)['allow']){if(pid[_0x1c37c4])pid[_0x1c37c4]['send']({'function':_0x26f715(0x28e),'args':_0x303340});}else logger['full'](_0x26f715(0x179));}),_0x28f63f['on'](_0x34aa22(0x301),(_0x32d0a8,_0x443291)=>{const _0x97458d=_0x34aa22;if(validateAccess(_0x443291,_0x4e3fb2)[_0x97458d(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4]['send']({'function':'storeFiat','args':_0x32d0a8});}else logger[_0x97458d(0x163)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x28f63f['on'](_0x34aa22(0x246),_0x2bcd52=>{const _0x4a9f73=_0x34aa22;if(validateAccess(_0x2bcd52,_0x4e3fb2)[_0x4a9f73(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4][_0x4a9f73(0x1eb)]({'function':'resetHistory','args':null});}else logger[_0x4a9f73(0x163)](_0x4a9f73(0x2ab));}),_0x28f63f['on']('get-starting-balances',_0x450440=>{const _0x22ed8b=_0x34aa22;if(validateAccess(_0x450440,_0x4e3fb2)[_0x22ed8b(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4][_0x22ed8b(0x1eb)]({'function':_0x22ed8b(0x27c),'args':null});}else logger[_0x22ed8b(0x163)](_0x22ed8b(0x168));}),_0x28f63f['on'](_0x34aa22(0x2fa),(_0x1518b3,_0x457d74)=>{const _0x3296ef=_0x34aa22;if(validateAccess(_0x457d74,_0x4e3fb2)[_0x3296ef(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4][_0x3296ef(0x1eb)]({'function':'placeOrder','args':_0x1518b3});}else logger[_0x3296ef(0x163)](_0x3296ef(0x2c9));}),_0x28f63f['on']('cancel-loading',_0x3acc8a=>{const _0x256077=_0x34aa22;if(validateAccess(_0x3acc8a,_0x4e3fb2)[_0x256077(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4][_0x256077(0x1eb)]({'function':'cancelLoading','args':null});}else logger['full'](_0x256077(0x172));}),_0x28f63f['on'](_0x34aa22(0x29d),_0x4f8e5b=>{const _0x590ab2=_0x34aa22;if(validateAccess(_0x4f8e5b,_0x4e3fb2)[_0x590ab2(0x181)]){if(pid[_0x1c37c4])pid[_0x1c37c4]['send']({'function':_0x590ab2(0x30e),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x28f63f['on'](_0x34aa22(0x1c1),_0x48bb1b=>{const _0x27d791=_0x34aa22;if(validateAccess(_0x48bb1b,_0x4e3fb2)[_0x27d791(0x181)])updateBB(_0x27d791(0x2d2));else logger[_0x27d791(0x163)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x28f63f['on'](_0x34aa22(0x1a6),_0x44e903=>{const _0x252448=_0x34aa22;if(validateAccess(_0x44e903,_0x4e3fb2)[_0x252448(0x181)])getMessages();else logger[_0x252448(0x163)](_0x252448(0x2f9));}),_0x28f63f['on']('confirm-message',(_0x1eaecf,_0x17e824)=>{const _0x49e6d0=_0x34aa22;if(validateAccess(_0x17e824,_0x4e3fb2)[_0x49e6d0(0x181)])confirmMessage(_0x1eaecf);else logger[_0x49e6d0(0x163)](_0x49e6d0(0x25d));}),_0x28f63f['on'](_0x34aa22(0x302),_0x27777b=>{const _0x1f0ab0=_0x34aa22;if(validateAccess(_0x27777b,_0x4e3fb2)[_0x1f0ab0(0x181)]){if(devices[_0x4e3fb2][_0x1f0ab0(0x329)])clearTimeout(devices[_0x4e3fb2][_0x1f0ab0(0x329)]);if(devices[_0x4e3fb2][_0x1f0ab0(0x227)])clearTimeout(devices[_0x4e3fb2][_0x1f0ab0(0x227)]);removeSocketListeners(getClient(_0x28f63f['id'])['uuid']),addBlacklist(_0x4e3fb2),devices[_0x4e3fb2]['telegramIpApproval']=null,devices[_0x4e3fb2][_0x1f0ab0(0x164)]=null,devices[_0x4e3fb2][_0x1f0ab0(0x2bc)][_0x1f0ab0(0x26f)]=null,logger[_0x1f0ab0(0x1e9)]('Logged\x20out\x20user\x20...'+_0x4e3fb2[_0x1f0ab0(0x278)](-0x8)),io['to'](getClient(_0x28f63f['id'])['uuid'])['emit'](_0x1f0ab0(0x220),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x1f0ab0(0x304));});}function removeSocketListeners(_0x6079a3){const _0x2f26c5=_0x21dae9;getClientsWithUuid(_0x6079a3)[_0x2f26c5(0x29f)](_0x5ec89a=>{const _0x500876=_0x2f26c5;getSocket(_0x5ec89a['id'])[_0x500876(0x33b)]();});}function cleanSettings(){const _0x25f834=_0x21dae9;let _0x55ff58=settings;return settings['telegramToken']&&settings[_0x25f834(0x16f)]!=''&&(_0x55ff58={..._0x55ff58,'telegramToken':_0x25f834(0x189)}),settings[_0x25f834(0x1be)]&&settings[_0x25f834(0x1be)]!=''&&(_0x55ff58={..._0x55ff58,'bbPassword':_0x25f834(0x189)}),(settings[_0x25f834(0x1be)]&&settings[_0x25f834(0x1be)]==_0x25f834(0x20f)||settings[_0x25f834(0x16f)]&&settings[_0x25f834(0x16f)]==_0x25f834(0x20f))&&(_0x55ff58={..._0x55ff58,'restored':{'password':settings[_0x25f834(0x1be)]==_0x25f834(0x20f),'telegram':settings[_0x25f834(0x16f)]==_0x25f834(0x20f)}}),_0x55ff58;}async function updateBB(_0x48b0da){const _0x2ebb5a=_0x21dae9;await backupConfigFiles(),installingUpdate=!![],config[_0x2ebb5a(0x29f)](_0xf19a86=>{const _0x2f7a27=_0x2ebb5a;restartBot(_0xf19a86[_0x2f7a27(0x30c)]);});if(_0x48b0da==_0x2ebb5a(0x2d2))process[_0x2ebb5a(0x1eb)]({'update':!![],'environment':environment},_0x8ed077=>{});else _0x48b0da==_0x2ebb5a(0x241)&&process[_0x2ebb5a(0x1eb)]({'reinstall':!![],'environment':environment},_0x21d01d=>{});}function startBot(_0x13f8cc,_0x234fac,_0x37913b){const _0x7f19e5=_0x21dae9;if(debugging)_0x13f8cc[_0x7f19e5(0x343)]('-d');let _0x28b52b=![];const _0x274c2f=_0x13f8cc[0x0];_0x234fac={..._0x234fac,'stdio':[_0x7f19e5(0x280),'inherit',_0x7f19e5(0x280),_0x7f19e5(0x265)]},pid[_0x274c2f]=childProcess['fork'](botfile,_0x13f8cc,_0x234fac),pid[_0x274c2f]['on'](_0x7f19e5(0x1ad),_0x3c5e51=>{const _0x3e40cb=_0x7f19e5;switch(Object[_0x3e40cb(0x264)](_0x3c5e51)[0x0]){case _0x3e40cb(0x2bd):updateBotName(_0x274c2f,_0x3c5e51[_0x3e40cb(0x2bd)]);break;case _0x3e40cb(0x1ac):updateBotManager();break;case'status':updateStatus(_0x274c2f,_0x3c5e51['status']);break;case'live':updateLive(_0x274c2f,_0x3c5e51[_0x3e40cb(0x17b)]);break;case _0x3e40cb(0x333):updateLive(_0x274c2f,_0x3c5e51[_0x3e40cb(0x333)]),io['to'](_0x274c2f)[_0x3e40cb(0x157)](_0x3e40cb(0x220),{'access':{'allow':![],'reason':_0x3e40cb(0x286),'token':null}});break;case'stop':_0x3c5e51[_0x3e40cb(0x237)]==_0x3e40cb(0x283)&&restartBot(_0x274c2f);_0x3c5e51[_0x3e40cb(0x237)]==_0x3e40cb(0x1b6)&&toggleBot(_0x274c2f,_0x3e40cb(0x1aa),_0x3e40cb(0x315));break;case'telegram':sendTelegramBot(_0x274c2f,_0x3c5e51[_0x3e40cb(0x27f)]);break;case _0x3e40cb(0x249):sendTelegramMsg(_0x3c5e51[_0x3e40cb(0x249)]);break;case'function':io['to'](_0x274c2f)[_0x3e40cb(0x157)](_0x3c5e51['function'],_0x3c5e51[_0x3e40cb(0x187)]);break;}}),pid[_0x274c2f]['on']('error',function(_0xbeba5a){if(_0x28b52b)return;_0x28b52b=!![],_0x37913b(_0xbeba5a);}),pid[_0x274c2f]['on']('exit',async function(_0x1fb1e3){const _0x32de3e=_0x7f19e5;if(terminating)return;if(installingUpdate){logger[_0x32de3e(0x1e9)](_0x32de3e(0x300)),io[_0x32de3e(0x242)]();return;}if(_0x28b52b)return;_0x28b52b=!![],_0x37913b(null);const _0x57945f=dbConfig[_0x32de3e(0x2df)](_0x32de3e(0x1a3))['find']({'botID':_0x274c2f})[_0x32de3e(0x15f)]();_0x57945f&&(_0x57945f[_0x32de3e(0x220)]=='enabled'||_0x57945f[_0x32de3e(0x220)]==_0x32de3e(0x33f))&&(await sleep(0x3e8),updateLive(_0x274c2f,'stopped'),logger[_0x32de3e(0x163)]('Restarting\x20Bot\x20'+_0x274c2f),startBot([_0x274c2f,userID],{'cwd':bbpath},function(_0x17ddc4){const _0x3aaba9=_0x32de3e;if(_0x17ddc4)logger[_0x3aaba9(0x163)](_0x17ddc4);}));});}function stopBot(_0x5e127f){const _0x33c9ca=_0x21dae9;getClientsWithBotID(_0x5e127f)[_0x33c9ca(0x29f)](_0x242364=>{getSocket(_0x242364['id'])['disconnect'](!![]),removeClient(_0x242364['id']);}),pid[_0x5e127f]&&(pid[_0x5e127f][_0x33c9ca(0x1b6)](),pid[_0x5e127f]=null);}function stopAllBots(){const _0x9dee1d=_0x21dae9;terminating=!![];const _0x393978=getEnabledBots();_0x393978[_0x9dee1d(0x29f)](_0x12c0cc=>{const _0x574ab3=_0x9dee1d;stopBot(_0x12c0cc[_0x574ab3(0x30c)]);});}function restartBot(_0x209ce0){const _0x1def08=_0x21dae9;if(pid[_0x209ce0])pid[_0x209ce0][_0x1def08(0x1b6)]();}function addBot(){const _0x39d61d=_0x21dae9;let _0x128341;for(let _0x20d249=0x1;_0x20d249<0x3e9;_0x20d249++){_0x128341=_0x20d249['toString']()['padStart'](0x3,'0');let _0x3a3fdc=config['find'](_0x3b6e00=>_0x3b6e00[_0x39d61d(0x30c)]==_0x128341);if(!_0x3a3fdc)break;}if(_0x128341===_0x39d61d(0x2ec)){logger[_0x39d61d(0x163)](_0x39d61d(0x2c8));return;}logger['full'](_0x39d61d(0x177)+_0x128341),dbConfig['get']('bots')[_0x39d61d(0x343)]({'botID':_0x128341,'botname':_0x39d61d(0x150)+_0x128341,'status':_0x39d61d(0x33f),'live':''})[_0x39d61d(0x230)](),startBot([_0x128341,userID],{'cwd':bbpath},function(_0x59f3ab){const _0x85a817=_0x39d61d;if(_0x59f3ab)logger[_0x85a817(0x163)](_0x59f3ab);}),config=getConfiguration(),io['to'](_0x39d61d(0x23e))['emit'](_0x39d61d(0x1a3),config),broadcastToBots('bots',JSON[_0x39d61d(0x2d1)](config));}function deleteBot(_0x4ffb48){const _0x515805=_0x21dae9;getClientsWithBotID(_0x4ffb48)[_0x515805(0x29f)](_0x1a9bea=>{getSocket(_0x1a9bea['id'])['disconnect'](!![]),removeClient(_0x1a9bea['id']);}),dbConfig[_0x515805(0x2df)](_0x515805(0x1a3))['remove']({'botID':_0x4ffb48})[_0x515805(0x230)](),logger[_0x515805(0x163)](_0x515805(0x2e0)+_0x4ffb48),stopBot(_0x4ffb48);try{if(fs[_0x515805(0x228)](path[_0x515805(0x271)](configpath,_0x515805(0x21f)+_0x4ffb48+_0x515805(0x161))))fs[_0x515805(0x192)](path[_0x515805(0x271)](configpath,_0x515805(0x21f)+_0x4ffb48+'-config.json'));if(fs['existsSync'](path[_0x515805(0x271)](configpath,'bot-'+_0x4ffb48+_0x515805(0x2b6))))fs[_0x515805(0x192)](path[_0x515805(0x271)](configpath,_0x515805(0x21f)+_0x4ffb48+_0x515805(0x2b6)));if(fs[_0x515805(0x228)](path[_0x515805(0x271)](configpath,_0x515805(0x21f)+_0x4ffb48+'-performance.json')))fs[_0x515805(0x192)](path['join'](configpath,_0x515805(0x21f)+_0x4ffb48+'-performance.json'));if(fs[_0x515805(0x228)](path['join'](configpath,_0x515805(0x21f)+_0x4ffb48+_0x515805(0x2f6))))fs[_0x515805(0x192)](path['join'](configpath,_0x515805(0x21f)+_0x4ffb48+_0x515805(0x2f6)));}catch(_0x433cab){if(_0x433cab)logger[_0x515805(0x163)](_0x515805(0x19e),_0x433cab);}config=getConfiguration(),io['to'](_0x515805(0x23e))['emit']('bots',config),broadcastToBots('bots',JSON[_0x515805(0x2d1)](config));}function toggleBot(_0x4b348f,_0x1940ce,_0x6bfee6){const _0x3790a6=_0x21dae9;dbConfig[_0x3790a6(0x2df)](_0x3790a6(0x1a3))[_0x3790a6(0x1ee)]({'botID':_0x4b348f})[_0x3790a6(0x2e7)]({'status':_0x1940ce})['assign']({'live':_0x6bfee6})[_0x3790a6(0x230)]();if(_0x1940ce==_0x3790a6(0x257)||_0x1940ce==_0x3790a6(0x33f))logger[_0x3790a6(0x163)]('Enabled\x20Bot\x20'+_0x4b348f),startBot([_0x4b348f,userID],{'cwd':bbpath},function(_0x5c2dfe){const _0x2c026c=_0x3790a6;if(_0x5c2dfe)logger[_0x2c026c(0x163)](_0x5c2dfe);});else(_0x1940ce==_0x3790a6(0x1aa)||_0x1940ce==_0x3790a6(0x2bf))&&(logger['full'](_0x3790a6(0x2a8)+_0x4b348f),stopBot(_0x4b348f));config=getConfiguration(),io['to'](_0x3790a6(0x23e))['emit'](_0x3790a6(0x1a3),config),broadcastToBots(_0x3790a6(0x1a3),JSON['stringify'](config));}function toggleStatus(_0x3b6708){const _0x171294=_0x21dae9;let _0x461552=dbConfig[_0x171294(0x2df)]('bots')[_0x171294(0x1ee)]({'botID':_0x3b6708})[_0x171294(0x15f)](),_0x4413ba;if(_0x461552[_0x171294(0x220)]===_0x171294(0x257))_0x4413ba=_0x171294(0x1aa);else{if(_0x461552[_0x171294(0x220)]===_0x171294(0x33f))_0x4413ba=_0x171294(0x2bf);else{if(_0x461552[_0x171294(0x220)]===_0x171294(0x2bf))_0x4413ba=_0x171294(0x33f);else{if(_0x461552[_0x171294(0x220)]===_0x171294(0x1aa))_0x4413ba='enabled';}}}return _0x4413ba;}function updateStatus(_0x24f471,_0x1edd95){const _0x23e20c=_0x21dae9;dbConfig[_0x23e20c(0x2df)](_0x23e20c(0x1a3))[_0x23e20c(0x1ee)]({'botID':_0x24f471})[_0x23e20c(0x2e7)]({'status':_0x1edd95})[_0x23e20c(0x230)](),config=getConfiguration(),io['to'](_0x23e20c(0x23e))[_0x23e20c(0x157)](_0x23e20c(0x1a3),config),broadcastToBots(_0x23e20c(0x1a3),JSON[_0x23e20c(0x2d1)](config));}function updateLive(_0x437b57,_0x3714da){const _0x400836=_0x21dae9;dbConfig[_0x400836(0x2df)](_0x400836(0x1a3))[_0x400836(0x1ee)]({'botID':_0x437b57})['assign']({'live':_0x3714da})[_0x400836(0x230)](),config=getConfiguration(),io['to'](_0x400836(0x23e))[_0x400836(0x157)](_0x400836(0x1a3),config),broadcastToBots(_0x400836(0x1a3),JSON[_0x400836(0x2d1)](config));}function updateBotName(_0x2db28a,_0x2cee09){const _0x4e1518=_0x21dae9;dbConfig['get'](_0x4e1518(0x1a3))[_0x4e1518(0x1ee)]({'botID':_0x2db28a})[_0x4e1518(0x2e7)]({'botname':_0x2cee09})[_0x4e1518(0x230)](),config=getConfiguration(),io['to']('botmanager')[_0x4e1518(0x157)](_0x4e1518(0x1a3),config),broadcastToBots(_0x4e1518(0x1a3),JSON['stringify'](config));}function updateBotManager(){const _0x41cde2=_0x21dae9;config=getConfiguration(),io['to'](_0x41cde2(0x23e))['emit'](_0x41cde2(0x1a3),config),broadcastToBots(_0x41cde2(0x1a3),JSON[_0x41cde2(0x2d1)](config));}function toggleBotMode(_0x21c605){const _0xc0e6b5=_0x21dae9;if(pid[_0x21c605])pid[_0x21c605]['send']({'function':_0xc0e6b5(0x219),'args':null});else{const _0x50f0a5=configpath+_0xc0e6b5(0x21f)+_0x21c605+'-config.json',_0x34cec8=fs[_0xc0e6b5(0x24d)](_0x50f0a5),_0x2aa5d7=JSON[_0xc0e6b5(0x207)](_0x34cec8),_0x1cf4b3=_0x2aa5d7[_0xc0e6b5(0x281)][0x0][_0xc0e6b5(0x244)];_0x2aa5d7['bot'][0x0][_0xc0e6b5(0x244)]=!_0x1cf4b3;const _0x175dca=JSON[_0xc0e6b5(0x2d1)](_0x2aa5d7,null,0x2);fs['writeFileSync'](_0x50f0a5,_0x175dca),config=getConfiguration(),io['to'](_0xc0e6b5(0x23e))[_0xc0e6b5(0x157)](_0xc0e6b5(0x1a3),config),broadcastToBots('bots',JSON['stringify'](config));}}function validateTelegram(_0x35d2ec){const _0xd94296=_0x21dae9;if(_0x35d2ec[_0xd94296(0x2ac)][_0xd94296(0x1cd)]!=settings[_0xd94296(0x275)]&&'@'+_0x35d2ec[_0xd94296(0x2ac)][_0xd94296(0x1cd)]!=settings['telegramUsername']||_0x35d2ec[_0xd94296(0x2cc)]['id']!=settings[_0xd94296(0x32b)])return sendTelegram(_0x35d2ec[_0xd94296(0x2cc)]['id'],_0xd94296(0x238),{'parse_mode':_0xd94296(0x1bf)}),![];return!![];}async function initTelegram(){const _0x44b275=_0x21dae9;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x44b275(0x16f)]);let _0x5c660f=_0x44b275(0x2c3);_0x5c660f+='\x0a',_0x5c660f+=_0x44b275(0x1b0),_0x5c660f+=_0x44b275(0x22c),_0x5c660f+=_0x44b275(0x22f),_0x5c660f+=_0x44b275(0x1f6),_0x5c660f+=_0x44b275(0x2e2),_0x5c660f+=_0x44b275(0x18d),_0x5c660f+=_0x44b275(0x2ad),_0x5c660f+=_0x44b275(0x261),_0x5c660f+=_0x44b275(0x31a),_0x5c660f+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x5c660f+=_0x44b275(0x205),_0x5c660f+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x5c660f+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x5c660f+=_0x44b275(0x199);let _0x35ff99=_0x44b275(0x22e);_0x35ff99+='\x0a',_0x35ff99+=_0x5c660f,tgBot[_0x44b275(0x23a)]((_0x4601ec,_0x217950)=>{const _0x5f4f47=_0x44b275;logger[_0x5f4f47(0x325)](getTimeStamp()+_0x5f4f47(0x1c6)),logger[_0x5f4f47(0x1e9)](_0x5f4f47(0x234),_0x4601ec);}),tgBot[_0x44b275(0x175)](async(_0xa801e7,_0xa59cbc)=>{const _0x32f6ba=_0x44b275;if(!(!settings['telegramChatId']&&_0xa801e7[_0x32f6ba(0x2d2)][_0x32f6ba(0x1ad)]['text']=='/start')){if(!validateTelegram(_0xa801e7))return;}_0xa59cbc();}),tgBot['command'](_0x44b275(0x1e5),async _0x42d2ef=>{const _0x1a146e=_0x44b275;if(!settings['telegramChatId'])updateSetting(_0x1a146e(0x32b),_0x42d2ef[_0x1a146e(0x2cc)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x42d2ef))return;await sendTelegram(_0x42d2ef[_0x1a146e(0x2cc)]['id'],_0x35ff99);}),tgBot[_0x44b275(0x2cf)](_0x44b275(0x19a),async _0xf492ff=>{const _0x5e110a=_0x44b275;updateSetting(_0x5e110a(0x20c),!![]),await sendTelegram(_0xf492ff[_0x5e110a(0x2cc)]['id'],_0x5e110a(0x311));}),tgBot[_0x44b275(0x2cf)](_0x44b275(0x339),async _0x233132=>{const _0x8122ea=_0x44b275;await sendTelegram(_0x233132[_0x8122ea(0x2cc)]['id'],'Notifications\x20disabled'),updateSetting(_0x8122ea(0x20c),![]);}),tgBot[_0x44b275(0x2cf)](_0x44b275(0x1c4),async _0x18bd00=>{const _0xda0c1b=_0x44b275,_0x189060=Markup[_0xda0c1b(0x16a)]([Markup[_0xda0c1b(0x253)][_0xda0c1b(0x312)]('Orders',_0xda0c1b(0x259)),Markup[_0xda0c1b(0x253)][_0xda0c1b(0x312)]('Alerts',_0xda0c1b(0x22a)),Markup[_0xda0c1b(0x253)][_0xda0c1b(0x312)](_0xda0c1b(0x17c),_0xda0c1b(0x2ca))]);_0x18bd00[_0xda0c1b(0x178)](_0xda0c1b(0x16c),_0x189060);}),tgBot['action'](_0x44b275(0x259),async _0x1160f9=>{const _0x211f66=_0x44b275;_0x1160f9['editMessageReplyMarkup'](),updateSetting(_0x211f66(0x226),_0x211f66(0x171)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1160f9[_0x211f66(0x2cc)]['id'],_0x211f66(0x277));}),tgBot[_0x44b275(0x1fe)](_0x44b275(0x22a),async _0x40d161=>{const _0x869f3c=_0x44b275;_0x40d161['editMessageReplyMarkup'](),updateSetting(_0x869f3c(0x226),_0x869f3c(0x1fb)),updateSetting(_0x869f3c(0x20c),!![]),await sendTelegram(_0x40d161[_0x869f3c(0x2cc)]['id'],_0x869f3c(0x331));}),tgBot[_0x44b275(0x1fe)](_0x44b275(0x2ca),async _0x233ed6=>{const _0x447f30=_0x44b275;_0x233ed6['editMessageReplyMarkup'](),updateSetting(_0x447f30(0x226),'all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x233ed6['chat']['id'],_0x447f30(0x348));}),tgBot['command'](_0x44b275(0x220),async _0x15de63=>{const _0x5c3424=_0x44b275,_0x2cea94=getBotsWithMode();let _0x3c7e8e=_0x5c3424(0x193);config[_0x5c3424(0x29f)](_0x48522c=>{const _0x4dd2a1=_0x5c3424,_0x29d8cc=_0x2cea94[_0x4dd2a1(0x1ee)](_0xe10e9d=>_0xe10e9d['botID']==_0x48522c[_0x4dd2a1(0x30c)])[_0x4dd2a1(0x273)];_0x3c7e8e+=_0x4dd2a1(0x150)+_0x48522c[_0x4dd2a1(0x30c)]+':\x20'+_0x48522c['status']+_0x4dd2a1(0x292)+_0x29d8cc+_0x4dd2a1(0x292)+_0x48522c[_0x4dd2a1(0x17b)]+'\x0a';}),_0x3c7e8e+='\x0a',_0x3c7e8e+=_0x5c3424(0x2dd),_0x3c7e8e+=!settings['telegramEnabled']?_0x5c3424(0x30f):_0x5c3424(0x18b),_0x3c7e8e+=settings[_0x5c3424(0x20c)]?settings[_0x5c3424(0x226)]=='all'?_0x5c3424(0x1de):_0x5c3424(0x276)+settings[_0x5c3424(0x226)]+'\x20only\x0a':'',await sendTelegram(_0x15de63[_0x5c3424(0x2cc)]['id'],_0x3c7e8e,{'parse_mode':_0x5c3424(0x1bf)});}),tgBot[_0x44b275(0x2cf)](_0x44b275(0x283),async _0x1eb357=>{const _0x4e380a=_0x44b275,_0xf8fc7=getEnabledBots();if(_0xf8fc7[_0x4e380a(0x1ea)]==0x0)await sendTelegram(_0x1eb357['chat']['id'],_0x4e380a(0x282));else{if(_0xf8fc7['length']>0x1)_0xf8fc7['push']({'botID':_0x4e380a(0x2de)});let _0x58ab6a=[],_0x169805=[];const _0x4ca3fc=_0xf8fc7['length']%0x4==0x0||_0xf8fc7[_0x4e380a(0x1ea)]%0x4==0x3||_0xf8fc7[_0x4e380a(0x1ea)]%0x3==0x1?0x4:0x3;let _0x3e477e=0x0;_0xf8fc7['forEach']((_0x27ddbd,_0x3c56c5)=>{const _0x4d17c1=_0x4e380a;if(_0x3c56c5%_0x4ca3fc==0x0)_0x169805=[];_0x169805[_0x4d17c1(0x343)](Markup[_0x4d17c1(0x253)][_0x4d17c1(0x312)](_0x27ddbd[_0x4d17c1(0x30c)]==_0x4d17c1(0x2de)?_0x4d17c1(0x2f5):'Bot\x20'+_0x27ddbd['botID'],_0x4d17c1(0x29a)+_0x27ddbd[_0x4d17c1(0x30c)])),_0x3c56c5%_0x4ca3fc==0x0&&(_0x58ab6a[_0x3e477e]=_0x169805,_0x3e477e++);});const _0x4b97ca=Markup['inlineKeyboard'](_0x58ab6a);_0x1eb357[_0x4e380a(0x178)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x4b97ca);}}),tgBot[_0x44b275(0x1fe)](/restart_(.+)/,async _0x54e4e2=>{const _0x424d40=_0x44b275,_0x3bbe1e=_0x54e4e2['match'][0x1];_0x54e4e2[_0x424d40(0x30d)](),_0x3bbe1e==_0x424d40(0x2de)?config['forEach'](_0x2daef7=>{const _0x3ea747=_0x424d40;restartBot(_0x2daef7[_0x3ea747(0x30c)]);}):restartBot(_0x3bbe1e);}),tgBot[_0x44b275(0x2cf)]('on',async _0x307050=>{const _0x1c9d94=_0x44b275,_0x53ea09=getDisabledBots();if(_0x53ea09[_0x1c9d94(0x1ea)]==0x0)await sendTelegram(_0x307050[_0x1c9d94(0x2cc)]['id'],_0x1c9d94(0x322));else{if(_0x53ea09[_0x1c9d94(0x1ea)]>0x1)_0x53ea09[_0x1c9d94(0x343)]({'botID':_0x1c9d94(0x2de)});let _0x4e8556=[],_0x35799c=[];const _0x5748f1=_0x53ea09[_0x1c9d94(0x1ea)]%0x4==0x0||_0x53ea09[_0x1c9d94(0x1ea)]%0x4==0x3||_0x53ea09['length']%0x3==0x1?0x4:0x3;let _0x41e78f=0x0;_0x53ea09[_0x1c9d94(0x29f)]((_0x5a7c79,_0x999fb5)=>{const _0x32e1d9=_0x1c9d94;if(_0x999fb5%_0x5748f1==0x0)_0x35799c=[];_0x35799c['push'](Markup[_0x32e1d9(0x253)][_0x32e1d9(0x312)](_0x5a7c79[_0x32e1d9(0x30c)]==_0x32e1d9(0x2de)?_0x32e1d9(0x2f5):_0x32e1d9(0x150)+_0x5a7c79[_0x32e1d9(0x30c)],_0x32e1d9(0x169)+_0x5a7c79['botID'])),_0x999fb5%_0x5748f1==0x0&&(_0x4e8556[_0x41e78f]=_0x35799c,_0x41e78f++);});const _0xe401a7=Markup[_0x1c9d94(0x16a)](_0x4e8556);_0x307050[_0x1c9d94(0x178)](_0x1c9d94(0x298),_0xe401a7);}}),tgBot[_0x44b275(0x1fe)](/on_(.+)/,async _0x411655=>{const _0x387bde=_0x44b275,_0x12b12d=_0x411655[_0x387bde(0x235)][0x1];_0x411655[_0x387bde(0x30d)]();if(_0x12b12d=='all'){const _0x926354=getDisabledBots();await sendTelegram(_0x411655[_0x387bde(0x2cc)]['id'],_0x387bde(0x2aa)),_0x926354[_0x387bde(0x29f)](_0x179ef2=>{const _0x4ada28=_0x387bde;if(_0x179ef2[_0x4ada28(0x30c)]!='all')toggleBot(_0x179ef2[_0x4ada28(0x30c)],toggleStatus(_0x179ef2[_0x4ada28(0x30c)]),_0x4ada28(0x315));});}else await sendTelegram(_0x411655[_0x387bde(0x2cc)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x12b12d),toggleBot(_0x12b12d,toggleStatus(_0x12b12d),_0x387bde(0x315));}),tgBot[_0x44b275(0x2cf)]('off',async _0x5ea28d=>{const _0x10fb4f=_0x44b275,_0x171a14=getEnabledBots();if(_0x171a14[_0x10fb4f(0x1ea)]==0x0)await sendTelegram(_0x5ea28d['chat']['id'],_0x10fb4f(0x282));else{if(_0x171a14[_0x10fb4f(0x1ea)]>0x1)_0x171a14['push']({'botID':_0x10fb4f(0x2de)});let _0x4602a4=[],_0x3deef1=[];const _0x7b6531=_0x171a14[_0x10fb4f(0x1ea)]%0x4==0x0||_0x171a14[_0x10fb4f(0x1ea)]%0x4==0x3||_0x171a14[_0x10fb4f(0x1ea)]%0x3==0x1?0x4:0x3;let _0x891ba0=0x0;_0x171a14[_0x10fb4f(0x29f)]((_0x362373,_0xef4e0d)=>{const _0x510787=_0x10fb4f;if(_0xef4e0d%_0x7b6531==0x0)_0x3deef1=[];_0x3deef1[_0x510787(0x343)](Markup[_0x510787(0x253)][_0x510787(0x312)](_0x362373['botID']==_0x510787(0x2de)?_0x510787(0x2f5):_0x510787(0x150)+_0x362373['botID'],_0x510787(0x270)+_0x362373['botID'])),_0xef4e0d%_0x7b6531==0x0&&(_0x4602a4[_0x891ba0]=_0x3deef1,_0x891ba0++);});const _0x569741=Markup['inlineKeyboard'](_0x4602a4);_0x5ea28d[_0x10fb4f(0x178)](_0x10fb4f(0x344),_0x569741);}}),tgBot['action'](/off_(.+)/,async _0x559f4d=>{const _0x22d3cf=_0x44b275,_0x4f5ef2=_0x559f4d[_0x22d3cf(0x235)][0x1];_0x559f4d['editMessageReplyMarkup']();if(_0x4f5ef2=='all'){const _0x5f0b9a=getEnabledBots();await sendTelegram(_0x559f4d['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x5f0b9a['forEach'](_0xc9389b=>{const _0x25b5d7=_0x22d3cf;if(_0xc9389b['botID']!='all')toggleBot(_0xc9389b[_0x25b5d7(0x30c)],toggleStatus(_0xc9389b[_0x25b5d7(0x30c)]),_0x25b5d7(0x315));});}else await sendTelegram(_0x559f4d[_0x22d3cf(0x2cc)]['id'],_0x22d3cf(0x1a1)+_0x4f5ef2),toggleBot(_0x4f5ef2,toggleStatus(_0x4f5ef2),_0x22d3cf(0x315));}),tgBot[_0x44b275(0x2cf)](_0x44b275(0x324),async _0x1a3a8d=>{const _0x4b9e4d=_0x44b275,_0x465461=getEnabledBots();if(_0x465461[_0x4b9e4d(0x1ea)]==0x0)await sendTelegram(_0x1a3a8d['chat']['id'],_0x4b9e4d(0x282));else{if(_0x465461[_0x4b9e4d(0x1ea)]>0x1){let _0x59504f=[],_0x1256e9=[];const _0xf905=_0x465461[_0x4b9e4d(0x1ea)]%0x4==0x0||_0x465461[_0x4b9e4d(0x1ea)]%0x4==0x3||_0x465461[_0x4b9e4d(0x1ea)]%0x3==0x1?0x4:0x3;let _0x33e86d=0x0;_0x465461[_0x4b9e4d(0x29f)]((_0xe4dfc2,_0x34dac0)=>{const _0x3241ed=_0x4b9e4d;if(_0x34dac0%_0xf905==0x0)_0x1256e9=[];_0x1256e9[_0x3241ed(0x343)](Markup[_0x3241ed(0x253)][_0x3241ed(0x312)](_0x3241ed(0x150)+_0xe4dfc2[_0x3241ed(0x30c)],_0x3241ed(0x2ba)+_0xe4dfc2['botID'])),_0x34dac0%_0xf905==0x0&&(_0x59504f[_0x33e86d]=_0x1256e9,_0x33e86d++);});const _0x422d38=Markup[_0x4b9e4d(0x16a)](_0x59504f);_0x1a3a8d[_0x4b9e4d(0x178)](_0x4b9e4d(0x1ca),_0x422d38);}else{const _0x1eb6d3=_0x465461[0x0][_0x4b9e4d(0x30c)];if(pid[_0x1eb6d3])pid[_0x1eb6d3][_0x4b9e4d(0x1eb)]({'function':_0x4b9e4d(0x1ab),'args':null});}}}),tgBot[_0x44b275(0x1fe)](/metrics_(.+)/,async _0x2ce822=>{const _0x57171b=_0x44b275,_0x4b9c46=_0x2ce822[_0x57171b(0x235)][0x1];_0x2ce822[_0x57171b(0x30d)]();if(pid[_0x4b9c46])pid[_0x4b9c46][_0x57171b(0x1eb)]({'function':_0x57171b(0x1ab),'args':null});}),tgBot['command'](_0x44b275(0x218),async _0x4292b4=>{const _0x1809e0=_0x44b275,_0x2363e9=getEnabledBots();if(_0x2363e9['length']==0x0)await sendTelegram(_0x4292b4['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2363e9[_0x1809e0(0x1ea)]>0x1){let _0xf9f2a6=[],_0x7f047b=[];const _0x19a5b6=_0x2363e9[_0x1809e0(0x1ea)]%0x4==0x0||_0x2363e9['length']%0x4==0x3||_0x2363e9[_0x1809e0(0x1ea)]%0x3==0x1?0x4:0x3;let _0x103b15=0x0;_0x2363e9[_0x1809e0(0x29f)]((_0x37667d,_0x41f450)=>{const _0x595f5e=_0x1809e0;if(_0x41f450%_0x19a5b6==0x0)_0x7f047b=[];_0x7f047b[_0x595f5e(0x343)](Markup['button'][_0x595f5e(0x312)]('Bot\x20'+_0x37667d[_0x595f5e(0x30c)],_0x595f5e(0x337)+_0x37667d['botID'])),_0x41f450%_0x19a5b6==0x0&&(_0xf9f2a6[_0x103b15]=_0x7f047b,_0x103b15++);});const _0x41b730=Markup[_0x1809e0(0x16a)](_0xf9f2a6);_0x4292b4[_0x1809e0(0x178)](_0x1809e0(0x320),_0x41b730);}else{const _0x588e92=_0x2363e9[0x0][_0x1809e0(0x30c)];if(pid[_0x588e92])pid[_0x588e92][_0x1809e0(0x1eb)]({'function':_0x1809e0(0x156),'args':null});}}}),tgBot[_0x44b275(0x1fe)](/portfolio_(.+)/,async _0x22a4fe=>{const _0x54e2f4=_0x44b275,_0x395c64=_0x22a4fe[_0x54e2f4(0x235)][0x1];_0x22a4fe[_0x54e2f4(0x30d)]();if(pid[_0x395c64])pid[_0x395c64][_0x54e2f4(0x1eb)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x44b275(0x2cf)]('update',async _0x4886a8=>{const _0x3e55f4=_0x44b275;await getMessages();if(!updateAvailable)await sendTelegram(_0x4886a8['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x4886a8[_0x3e55f4(0x2cc)]['id'],_0x3e55f4(0x2a5));else{const _0x3a6370=Markup[_0x3e55f4(0x16a)]([Markup[_0x3e55f4(0x253)]['callback'](_0x3e55f4(0x155),_0x3e55f4(0x19f)),Markup[_0x3e55f4(0x253)][_0x3e55f4(0x312)]('No','update_no')]);_0x4886a8[_0x3e55f4(0x178)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x3a6370);}}}),tgBot[_0x44b275(0x1fe)](/update_(.+)/,async _0x3600f0=>{const _0x175506=_0x44b275,_0x229a56=_0x3600f0[_0x175506(0x235)][0x1];_0x3600f0[_0x175506(0x30d)](),_0x229a56==_0x175506(0x2c7)&&(await sendTelegram(_0x3600f0[_0x175506(0x2cc)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x175506(0x2d2))),_0x229a56=='no'&&await sendTelegram(_0x3600f0[_0x175506(0x2cc)]['id'],_0x175506(0x1ae));}),tgBot['command']('reinstall',async _0x561ce9=>{const _0x430b77=_0x44b275;if(!validInstallation)await sendTelegram(_0x561ce9[_0x430b77(0x2cc)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x6d6269=Markup[_0x430b77(0x16a)]([Markup[_0x430b77(0x253)][_0x430b77(0x312)](_0x430b77(0x155),_0x430b77(0x272)),Markup['button'][_0x430b77(0x312)]('No','reinstall_no')]);_0x561ce9[_0x430b77(0x178)](_0x430b77(0x162),_0x6d6269);}}),tgBot[_0x44b275(0x1fe)](/reinstall_(.+)/,async _0x411d1c=>{const _0x27ffa7=_0x44b275,_0x19de3e=_0x411d1c[_0x27ffa7(0x235)][0x1];_0x411d1c['editMessageReplyMarkup'](),_0x19de3e=='yes'&&(await sendTelegram(_0x411d1c[_0x27ffa7(0x2cc)]['id'],_0x27ffa7(0x1a0)),updateBB(_0x27ffa7(0x241))),_0x19de3e=='no'&&await sendTelegram(_0x411d1c[_0x27ffa7(0x2cc)]['id'],_0x27ffa7(0x224));}),tgBot[_0x44b275(0x2cf)](_0x44b275(0x24b),async _0x4d4619=>{const _0x26c83f=_0x44b275,_0x3578da=getBotsWithMode();if(_0x3578da['length']==0x0)await sendTelegram(_0x4d4619['chat']['id'],_0x26c83f(0x282));else{let _0x38c308=[],_0x472cfd=[];const _0x2284fc=0x2;let _0x2692ea=0x0;_0x3578da['forEach']((_0x4cf604,_0x2a5d99)=>{const _0x8b4c50=_0x26c83f;if(_0x2a5d99%_0x2284fc==0x0)_0x472cfd=[];_0x472cfd[_0x8b4c50(0x343)](Markup[_0x8b4c50(0x253)][_0x8b4c50(0x312)]('Bot\x20'+_0x4cf604[_0x8b4c50(0x30c)]+'\x20('+_0x4cf604['mode']+')',_0x8b4c50(0x20e)+_0x4cf604[_0x8b4c50(0x30c)])),_0x2a5d99%_0x2284fc==0x0&&(_0x38c308[_0x2692ea]=_0x472cfd,_0x2692ea++);});const _0x599a87=Markup[_0x26c83f(0x16a)](_0x38c308);_0x4d4619[_0x26c83f(0x178)](_0x26c83f(0x1e0),_0x599a87);}}),tgBot['action'](/toggle_(.+)/,async _0x420e48=>{const _0x3eb100=_0x44b275,_0x400af4=_0x420e48[_0x3eb100(0x235)][0x1];_0x420e48[_0x3eb100(0x30d)]();const _0x1c2ca8=getBotsWithMode(),_0x1ff15f=_0x1c2ca8[_0x3eb100(0x1ee)](_0x4eb9da=>_0x4eb9da[_0x3eb100(0x30c)]==_0x400af4),_0x191069=_0x1ff15f[_0x3eb100(0x273)]==_0x3eb100(0x1ed)?_0x3eb100(0x23d):_0x3eb100(0x1ed);await sendTelegram(_0x420e48['chat']['id'],_0x3eb100(0x1c0)+_0x400af4+_0x3eb100(0x222)+_0x191069+_0x3eb100(0x15d)),toggleBotMode(_0x400af4);}),tgBot[_0x44b275(0x2cf)]('names',async _0x5aa4a0=>{const _0x2e16da=_0x44b275;let _0x31384b='';config['forEach'](_0x3214e7=>{const _0x55f58f=_0x2aa0;_0x31384b+=_0x55f58f(0x150)+_0x3214e7['botID']+':\x20'+_0x3214e7['botname']+'\x0a';}),await sendTelegram(_0x5aa4a0[_0x2e16da(0x2cc)]['id'],_0x31384b,{'parse_mode':_0x2e16da(0x1bf)});}),tgBot['command'](_0x44b275(0x229),async _0x46e1a0=>{const _0x33cd12=_0x44b275;await sendTelegram(_0x46e1a0[_0x33cd12(0x2cc)]['id'],_0x5c660f);}),process[_0x44b275(0x197)](_0x44b275(0x1fa),()=>tgBot[_0x44b275(0x237)](_0x44b275(0x1fa))),process['once'](_0x44b275(0x290),()=>tgBot[_0x44b275(0x237)](_0x44b275(0x290))),tgBot[_0x44b275(0x33c)]();}}function disableTelegram(){const _0x3e5949=_0x21dae9;tgBot&&tgBot[_0x3e5949(0x237)]();}async function sendTelegram(_0x50be60,_0x67cb4d,_0x5aafbb){const _0x33138b=_0x21dae9;try{await tgBot['telegram'][_0x33138b(0x340)](_0x50be60,_0x67cb4d,_0x5aafbb);}catch(_0x32df57){console[_0x33138b(0x26b)](_0x33138b(0x1bc),_0x32df57);}}async function sendTelegramBot(_0x292dad,_0xc767e0){const _0x1c5927=_0x21dae9;if(settings[_0x1c5927(0x20c)]){if(settings['telegramEvents']=='all'||(_0xc767e0[_0x1c5927(0x2f0)]==_0x1c5927(0x1fc)||_0xc767e0[_0x1c5927(0x2f0)]==_0x1c5927(0x231)||_0xc767e0[_0x1c5927(0x2f0)]=='success')&&settings[_0x1c5927(0x226)]==_0x1c5927(0x1fb)||_0xc767e0[_0x1c5927(0x2f0)]==_0x1c5927(0x269)&&settings[_0x1c5927(0x226)]==_0x1c5927(0x171)){if(tgBot&&settings[_0x1c5927(0x32b)]){if(_0xc767e0['showname'])await sendTelegram(settings[_0x1c5927(0x32b)],_0xc767e0[_0x1c5927(0x2bd)]+_0x1c5927(0x323)+_0xc767e0[_0x1c5927(0x1b7)]);else await sendTelegram(settings['telegramChatId'],_0x1c5927(0x150)+_0x292dad+_0x1c5927(0x323)+_0xc767e0['event']);}}}}async function sendTelegramMsg(_0x411a77,_0x32dc78=_0x21dae9(0x1bf)){const _0x1ba629=_0x21dae9;return settings[_0x1ba629(0x20c)]&&tgBot&&settings[_0x1ba629(0x32b)]?(await sendTelegram(settings[_0x1ba629(0x32b)],_0x411a77,{'parse_mode':_0x32dc78}),!![]):![];}function getDeviceWithIp(_0x389f66){const _0x451f60=_0x21dae9;return devices[_0x451f60(0x1ee)](_0x33b8c8=>_0x33b8c8['ip']===_0x389f66);}async function temporaryAccess2FA(_0x23492b,_0x2d8bad){const _0x150ece=_0x21dae9;let _0x2bef74=new Date(),_0x1b249c=![];if(lastIpApproval){if(_0x2bef74-lastIpApproval<0x1388)_0x1b249c=!![];}lastIpApproval=new Date();if(_0x1b249c)return;if(tgBot&&settings['telegramChatId']){const _0x2e9541=uuidRandom();tmpStorage[_0x2e9541]={'uuid':_0x23492b,'externalip':_0x2d8bad};const _0x593ad7=Markup[_0x150ece(0x16a)]([Markup[_0x150ece(0x253)][_0x150ece(0x312)](_0x150ece(0x20d),_0x150ece(0x203)+_0x2e9541),Markup[_0x150ece(0x253)][_0x150ece(0x312)](_0x150ece(0x31c),'tempaccess_15_'+_0x2e9541),Markup[_0x150ece(0x253)]['callback'](_0x150ece(0x2e4),'tempaccess_30_'+_0x2e9541),Markup['button']['callback']('reject',_0x150ece(0x25c)+_0x2e9541)]);await sendTelegram(settings[_0x150ece(0x32b)],_0x150ece(0x254)+normalizeIP(_0x2d8bad)[_0x150ece(0x2b5)]+'\x20?',_0x593ad7),tgBot[_0x150ece(0x1fe)](/tempaccess_(.+)_(.+)/,async _0x139f12=>{const _0x558041=_0x150ece,_0x443bb8=_0x139f12[_0x558041(0x235)][0x1],_0x1e968e=_0x139f12[_0x558041(0x235)][0x2],{uuid:_0x431de2,externalip:_0x447b96}=tmpStorage[_0x1e968e];delete tmpStorage[_0x1e968e],_0x139f12[_0x558041(0x30d)](),devices[_0x431de2][_0x558041(0x2eb)]={'clientip':_0x447b96,'timestamp':new Date()[_0x558041(0x16d)](),'expiry':_0x443bb8},_0x443bb8!=_0x558041(0x25b)?(await sendTelegram(_0x139f12['chat']['id'],_0x558041(0x174)+_0x443bb8+'\x20minutes',{'parse_mode':_0x558041(0x1bf)}),io['to'](_0x431de2)[_0x558041(0x157)](_0x558041(0x220),{'access':{'allow':![],'reason':_0x558041(0x286),'token':null}})):(await sendTelegram(_0x139f12['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x431de2)[_0x558041(0x157)](_0x558041(0x220),{'access':{'allow':![],'reason':_0x558041(0x332),'token':null}}));});}}async function loginAccess2FA(_0x58b712,_0xf0a1c5){const _0x485739=_0x21dae9;if(tgBot&&settings[_0x485739(0x32b)]){const _0x1550f0=uuidRandom();tmpStorage[_0x1550f0]={'uuid':_0x58b712,'externalip':_0xf0a1c5};const _0x9af75f=Markup[_0x485739(0x16a)]([Markup[_0x485739(0x253)][_0x485739(0x312)](_0x485739(0x327),_0x485739(0x289)+loginExpiry+'_'+_0x1550f0),Markup['button']['callback'](_0x485739(0x25b),_0x485739(0x202)+_0x1550f0)]);await sendTelegram(settings['telegramChatId'],_0x485739(0x1cf)+normalizeIP(_0xf0a1c5)[_0x485739(0x2b5)]+'\x20?',_0x9af75f),tgBot[_0x485739(0x1fe)](/login2fa_(.+)_(.+)/,async _0x2d7a55=>{const _0x350905=_0x485739,_0x446fc2=_0x2d7a55[_0x350905(0x235)][0x1],_0x1165e2=_0x2d7a55[_0x350905(0x235)][0x2],{uuid:_0x4eff6d,externalip:_0x22b3e1}=tmpStorage[_0x1165e2];delete tmpStorage[_0x1165e2],_0x2d7a55[_0x350905(0x30d)](),devices[_0x4eff6d][_0x350905(0x164)]={'clientip':_0x22b3e1,'timestamp':new Date()['getTime'](),'expiry':_0x446fc2},_0x446fc2!='reject'?(await sendTelegram(_0x2d7a55[_0x350905(0x2cc)]['id'],_0x350905(0x2ea),{'parse_mode':'HTML'}),io['to'](_0x4eff6d)[_0x350905(0x157)](_0x350905(0x220),{'access':{'allow':![],'reason':_0x350905(0x286),'token':null}})):(await sendTelegram(_0x2d7a55[_0x350905(0x2cc)]['id'],_0x350905(0x18a)),io['to'](_0x4eff6d)[_0x350905(0x157)](_0x350905(0x220),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x20833e=_0x21dae9;return dbConfig[_0x20833e(0x2df)](_0x20833e(0x1a3))[_0x20833e(0x1e4)](_0x20833e(0x30c))[_0x20833e(0x2f4)]({'status':_0x20833e(0x257)})['value']()||[];}function getDisabledBots(){const _0x274127=_0x21dae9;return dbConfig[_0x274127(0x2df)]('bots')[_0x274127(0x1e4)]('botID')[_0x274127(0x2f4)]({'status':'disabled'})[_0x274127(0x15f)]()||[];}function getBotAttributes(_0x4197bc){const _0x103f25=_0x21dae9;let _0x51e59f={};const _0x1b832a=configpath+'bot-'+_0x4197bc+_0x103f25(0x161),_0x8a179e=fs[_0x103f25(0x228)](_0x1b832a);if(_0x8a179e){const _0x3e8892=fs[_0x103f25(0x24d)](_0x1b832a);try{const _0x97fc9e=JSON[_0x103f25(0x207)](_0x3e8892),_0xc62c92=_0x97fc9e?_0x97fc9e[_0x103f25(0x281)][0x0]['headless']:![];_0x51e59f['mode']=_0xc62c92?_0x103f25(0x1ed):_0x103f25(0x23d),_0x51e59f[_0x103f25(0x2bd)]=_0x97fc9e?_0x97fc9e[_0x103f25(0x281)][0x0][_0x103f25(0x2bd)]:_0x103f25(0x150)+_0x4197bc;}catch(_0x2ce479){_0x51e59f[_0x103f25(0x273)]=_0x103f25(0x23d),_0x51e59f[_0x103f25(0x2bd)]=_0x103f25(0x150)+_0x4197bc;}}else _0x51e59f[_0x103f25(0x273)]=_0x103f25(0x23d),_0x51e59f[_0x103f25(0x2bd)]=_0x103f25(0x150)+_0x4197bc;return _0x51e59f;}function getBotsWithMode(){const _0x5b2505=_0x21dae9,_0x4f6351=dbConfig['get'](_0x5b2505(0x1a3))[_0x5b2505(0x1e4)](_0x5b2505(0x30c))['value']()||[];return _0x4f6351[_0x5b2505(0x29f)](_0x41032d=>{const _0x185bbc=_0x5b2505;let _0x46c082=getBotAttributes(_0x41032d[_0x185bbc(0x30c)]);_0x41032d[_0x185bbc(0x273)]=_0x46c082[_0x185bbc(0x273)];}),_0x4f6351;}function getBotExchanges(){const _0xe036e1=_0x21dae9;let _0x5c39cd=[];const _0x3085bc=dbConfig[_0xe036e1(0x2df)]('bots')[_0xe036e1(0x1e4)](_0xe036e1(0x30c))[_0xe036e1(0x15f)]()||[];_0x3085bc['forEach'](_0x47daff=>{const _0x4a7cb5=_0xe036e1;if(_0x47daff['status']=='enabled'){const _0x11a227=configpath+_0x4a7cb5(0x21f)+_0x47daff[_0x4a7cb5(0x30c)]+_0x4a7cb5(0x161),_0x39a121=fs['existsSync'](_0x11a227);let _0x22da7b;if(_0x39a121){const _0x3bd407=fs[_0x4a7cb5(0x24d)](_0x11a227);try{const _0x56008c=JSON[_0x4a7cb5(0x207)](_0x3bd407);_0x22da7b=_0x56008c?_0x56008c['bot'][0x0][_0x4a7cb5(0x27a)]:null;}catch(_0x6e21af){}}if(_0x22da7b)_0x5c39cd[_0x4a7cb5(0x343)](_0x22da7b);}});const _0x3f60cd=[...new Set(_0x5c39cd)][_0xe036e1(0x21a)]();return _0x3f60cd;}async function initUser(){const _0x540149=_0x21dae9;if(!settings[_0x540149(0x295)]){const _0x36f8cd=uuidRandom();mixpanel['alias'](_0x36f8cd),updateSetting('userid',_0x36f8cd);}}async function initSecure(){const _0xe2061e=_0x21dae9;let _0x376f27=getSecure();if(!_0x376f27[_0xe2061e(0x255)](_0xe2061e(0x1a7))){let _0x20f97c=await generateKeys();_0x376f27['publicKey']=_0x20f97c[_0xe2061e(0x32d)],_0x376f27['privateKey']=_0x20f97c[_0xe2061e(0x2b2)],_0x376f27[_0xe2061e(0x1a7)]=crypto[_0xe2061e(0x1f7)](0x20)['toString'](_0xe2061e(0x321));;storeSecure(_0x376f27);}}function getSettings(){const _0x19c69e=_0x21dae9;return dbSettings[_0x19c69e(0x2df)]('settings')['value']()||{};}function getSecure(){const _0x380d5c=_0x21dae9;return dbSecure[_0x380d5c(0x2df)](_0x380d5c(0x1d8))[_0x380d5c(0x15f)]()||{};}function _0x2aa0(_0x681c6c,_0x12b1c1){const _0x377646=_0x55ed();return _0x2aa0=function(_0x1b16a4,_0x5dad77){_0x1b16a4=_0x1b16a4-0x14e;let _0x55ed56=_0x377646[_0x1b16a4];return _0x55ed56;},_0x2aa0(_0x681c6c,_0x12b1c1);}function getBlacklist(){const _0x4b23f9=_0x21dae9;return dbSecure['get'](_0x4b23f9(0x1a4))[_0x4b23f9(0x15f)]()||[];}function broadcastToBots(_0x27f1ea,_0x41007a){const _0x5c9b2b=_0x21dae9;config[_0x5c9b2b(0x29f)](_0x4bee7d=>{const _0x3b3900=_0x5c9b2b;if(_0x4bee7d[_0x3b3900(0x220)]==_0x3b3900(0x257)&&_0x4bee7d[_0x3b3900(0x17b)]==_0x3b3900(0x200)||_0x4bee7d[_0x3b3900(0x220)]==_0x3b3900(0x33f)&&_0x4bee7d['live']==_0x3b3900(0x200)){if(pid[_0x4bee7d[_0x3b3900(0x30c)]])pid[_0x4bee7d[_0x3b3900(0x30c)]][_0x3b3900(0x1eb)]({[_0x27f1ea]:_0x41007a});}});}function storeSettings(_0x3e79a7,_0x178395=![]){const _0x237b92=_0x21dae9;_0x3e79a7={...settings,..._0x3e79a7};if(_0x178395&&_0x3e79a7[_0x237b92(0x1be)]!=_0x237b92(0x189)&&_0x3e79a7[_0x237b92(0x1be)]!=_0x237b92(0x20f)&&_0x3e79a7['bbPassword']!=''){const _0x465e56=crypt[_0x237b92(0x225)](secure['privateKey'],_0x3e79a7[_0x237b92(0x1be)])['message'][_0x237b92(0x22d)]('@')[0x0],_0xc89746=bcrypt['hashSync'](_0x465e56,saltRounds);_0x3e79a7={..._0x3e79a7,'bbPassword':_0xc89746};}if(_0x178395&&_0x3e79a7[_0x237b92(0x16f)]!=_0x237b92(0x189)&&_0x3e79a7['telegramToken']!=_0x237b92(0x20f)&&_0x3e79a7[_0x237b92(0x16f)]!=''){const _0x23ae08=crypt[_0x237b92(0x225)](secure['privateKey'],_0x3e79a7[_0x237b92(0x16f)])[_0x237b92(0x1ad)]['split']('@')[0x0];_0x3e79a7={..._0x3e79a7,'telegramToken':_0x23ae08};}const _0x478062=_0x3e79a7[_0x237b92(0x16f)]!=_0x237b92(0x189)&&_0x3e79a7['telegramToken']!=settings[_0x237b92(0x16f)]||_0x3e79a7['telegramUsername']!=settings['telegramUsername'],_0x39a53b=_0x3e79a7[_0x237b92(0x16f)]==''||_0x3e79a7[_0x237b92(0x275)]=='';_0x478062&&(_0x3e79a7['telegramChatId']=null,_0x3e79a7[_0x237b92(0x226)]=_0x237b92(0x2de));for(const [_0x48e77d,_0x55f33a]of Object['entries'](_0x3e79a7)){if(_0x48e77d==_0x237b92(0x16f)&&_0x55f33a==_0x237b92(0x189)){_0x3e79a7['telegramToken']=settings[_0x237b92(0x16f)];continue;};if(_0x48e77d==_0x237b92(0x1be)&&_0x55f33a==_0x237b92(0x189)){_0x3e79a7[_0x237b92(0x1be)]=settings[_0x237b92(0x1be)];continue;};dbSettings[_0x237b92(0x2e6)](_0x237b92(0x1cb)+_0x48e77d,_0x55f33a)['write']();}settings=_0x3e79a7,io['to'](_0x237b92(0x23e))[_0x237b92(0x157)]('settings',cleanSettings()),broadcastToBots(_0x237b92(0x1f0),settings[_0x237b92(0x1f0)]),broadcastToBots(_0x237b92(0x2cb),settings['onepagemode']);if(_0x478062&&!_0x39a53b)initTelegram();if(_0x478062&&_0x39a53b)disableTelegram();getAllClients()[_0x237b92(0x29f)](_0x435c84=>{const _0x87955=_0x237b92;getSocket(_0x435c84['id'])[_0x87955(0x157)](_0x87955(0x220),{'access':{'allow':![],'reason':_0x87955(0x286),'token':null}});});}function updateSetting(_0x335cbc,_0x327125){const _0x5ad096=_0x21dae9;dbSettings[_0x5ad096(0x2e6)](_0x5ad096(0x1cb)+_0x335cbc,_0x327125)[_0x5ad096(0x230)](),settings=getSettings(),io['to'](_0x5ad096(0x23e))[_0x5ad096(0x157)]('settings',cleanSettings());}function storeSecure(_0x1f722c){const _0x1e0726=_0x21dae9;dbSecure[_0x1e0726(0x2df)](_0x1e0726(0x1d8))[_0x1e0726(0x343)](_0x1f722c)['write'](),secure=_0x1f722c;}function addBlacklist(_0x2fc9db){const _0x1fb5a7=_0x21dae9;cleanBlacklist();let _0x287964;devices[_0x2fc9db][_0x1fb5a7(0x2eb)]?_0x287964=Math['max'](devices[_0x2fc9db][_0x1fb5a7(0x2eb)][_0x1fb5a7(0x2d7)],loginExpiry):_0x287964=loginExpiry,dbSecure[_0x1fb5a7(0x2df)](_0x1fb5a7(0x1a4))[_0x1fb5a7(0x343)]({'expiry':new Date()[_0x1fb5a7(0x16d)]()+_0x287964*0x3c*0x3e8,'token':devices[_0x2fc9db][_0x1fb5a7(0x2bc)]['token']})[_0x1fb5a7(0x230)](),blacklist=dbSecure[_0x1fb5a7(0x2df)](_0x1fb5a7(0x1a4))[_0x1fb5a7(0x15f)]();}function cleanBlacklist(){const _0x30848d=_0x21dae9;let _0x385902=dbSecure[_0x30848d(0x2df)]('blacklist')[_0x30848d(0x152)]()[_0x30848d(0x15f)](),_0x4698b9=new Date()[_0x30848d(0x16d)]();_0x385902['forEach'](_0x4acdf3=>{const _0x5d847f=_0x30848d;_0x4acdf3[_0x5d847f(0x2d7)]<_0x4698b9&&dbSecure[_0x5d847f(0x2df)](_0x5d847f(0x1a4))['remove']({'expiry':_0x4acdf3[_0x5d847f(0x2d7)]})[_0x5d847f(0x230)]();});}function initStates(){let _0x592019=getConfiguration();_0x592019['forEach'](_0x31b96a=>{const _0x1e471b=_0x2aa0;_0x31b96a['live']=_0x1e471b(0x315);}),storeConfiguration(_0x592019);}function onKeys(){const _0xf84a57=new RSA();return new Promise(_0x490be0=>{_0xf84a57['generateKeyPairAsync']()['then'](_0x47f7a8=>{_0x490be0(_0x47f7a8);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x20655e=_0x21dae9;let _0xcf6dc1=getSettings(),_0xe91fda=![];!_0xcf6dc1[_0x20655e(0x255)]('lastmsgtelegram')&&(_0xcf6dc1[_0x20655e(0x32c)]=0x0,_0xe91fda=!![]);!_0xcf6dc1[_0x20655e(0x255)](_0x20655e(0x188))&&(_0xcf6dc1['lastmsgemitted']=0x0,_0xe91fda=!![]);!_0xcf6dc1[_0x20655e(0x255)](_0x20655e(0x299))&&(_0xcf6dc1[_0x20655e(0x299)]=_0x20655e(0x216),_0xe91fda=!![]);!_0xcf6dc1['hasOwnProperty']('onepagemode')&&(_0xcf6dc1[_0x20655e(0x2cb)]=![],_0xe91fda=!![]);if(_0xe91fda)storeSettings(_0xcf6dc1);try{fs[_0x20655e(0x212)](configbackuppath,{'withFileTypes':!![]})[_0x20655e(0x29f)](_0x53e154=>{const _0x19be35=_0x20655e;if(!_0x53e154[_0x19be35(0x184)]()){if(!_0x53e154[_0x19be35(0x2c1)][_0x19be35(0x2ae)]('backup-full@'))fs[_0x19be35(0x192)](configbackuppath+_0x53e154[_0x19be35(0x2c1)]);}else fs[_0x19be35(0x20b)](configbackuppath+_0x53e154['name'],{'recursive':!![]});});}catch(_0x59581a){logger[_0x20655e(0x1e9)](_0x20655e(0x2fc),_0x59581a);}}function storeConfiguration(_0x46b43e){const _0x46fc7a=_0x21dae9;dbConfig[_0x46fc7a(0x2df)](_0x46fc7a(0x1a3))[_0x46fc7a(0x32f)]()[_0x46fc7a(0x230)](),dbConfig[_0x46fc7a(0x2df)]('bots')['push'](..._0x46b43e)[_0x46fc7a(0x230)](),config=_0x46b43e;}async function resetPassword(){const _0x56e769=_0x21dae9;if(tgBot&&settings[_0x56e769(0x32b)]){const _0x251f77=Markup['inlineKeyboard']([Markup[_0x56e769(0x253)]['callback'](_0x56e769(0x2c7),_0x56e769(0x341)),Markup[_0x56e769(0x253)][_0x56e769(0x312)]('no','resetpw_no')]);await sendTelegram(settings[_0x56e769(0x32b)],_0x56e769(0x27b),_0x251f77),tgBot['action'](/resetpw_(.+)/,async _0x112467=>{const _0x524719=_0x56e769,_0x23ee6a=_0x112467['match'][0x1];_0x112467[_0x524719(0x30d)]();if(_0x23ee6a!='no'){const _0x23829d=0xf,_0x2d0731=_0x524719(0x268),_0x3174c2=Array[_0x524719(0x2ac)](crypto[_0x524719(0x2c6)](new Uint32Array(_0x23829d)))[_0x524719(0x31d)](_0x230d42=>_0x2d0731[_0x230d42%_0x2d0731[_0x524719(0x1ea)]])[_0x524719(0x271)](''),_0x2961c5=bcrypt[_0x524719(0x2db)](_0x3174c2,saltRounds);storeSettings({'bbPassword':_0x2961c5}),await sendTelegram(_0x112467[_0x524719(0x2cc)]['id'],_0x524719(0x338)+_0x3174c2,{'parse_mode':'HTML'});}else await sendTelegram(_0x112467['chat']['id'],_0x524719(0x2ef));});}}async function confirmRestore(_0x38dea3,_0x53ebb2){const _0x27d02f=_0x21dae9;io['to'](_0x27d02f(0x23e))[_0x27d02f(0x157)](_0x27d02f(0x19c),_0x27d02f(0x2d6),_0x27d02f(0x1a8));if(tgBot&&settings[_0x27d02f(0x32b)]){const _0x591ac8=uuidRandom();tmpStorage[_0x591ac8]={'path':_0x38dea3,'filename':_0x53ebb2};const _0x9016d8=Markup['inlineKeyboard']([Markup[_0x27d02f(0x253)][_0x27d02f(0x312)]('yes',_0x27d02f(0x159)+_0x591ac8),Markup[_0x27d02f(0x253)]['callback']('no','restore_no_'+_0x591ac8)]);await sendTelegram(settings[_0x27d02f(0x32b)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x9016d8),tgBot[_0x27d02f(0x1fe)](/restore_(.+)_(.+)/,async _0x2b6c66=>{const _0x5ead3d=_0x27d02f,_0x23c96b=_0x2b6c66['match'][0x1],_0x1a2b22=_0x2b6c66['match'][0x2],{path:_0x3d5339,filename:_0x6c397}=tmpStorage[_0x1a2b22];delete tmpStorage[_0x1a2b22],_0x2b6c66['editMessageReplyMarkup'](),_0x23c96b==_0x5ead3d(0x2c7)?(logger[_0x5ead3d(0x1e9)](_0x5ead3d(0x2da)),await sendTelegram(_0x2b6c66['chat']['id'],_0x5ead3d(0x195),{'parse_mode':'HTML'}),unzipFile(_0x3d5339,_0x6c397)):(logger[_0x5ead3d(0x1e9)](_0x5ead3d(0x160)),await sendTelegram(_0x2b6c66[_0x5ead3d(0x2cc)]['id'],_0x5ead3d(0x160)));});}}function getServerTime(){const _0x29aad5=_0x21dae9,_0x3c268c=new Date();return _0x3c268c[_0x29aad5(0x17f)]()+'/'+(_0x3c268c[_0x29aad5(0x19d)]()+0x1)['toString']()[_0x29aad5(0x1ce)](0x2,'0')+'/'+_0x3c268c[_0x29aad5(0x2d9)]()['toString']()[_0x29aad5(0x1ce)](0x2,'0')+'\x20'+_0x3c268c['getHours']()[_0x29aad5(0x1d2)]()[_0x29aad5(0x1ce)](0x2,'0')+':'+_0x3c268c[_0x29aad5(0x2e3)]()[_0x29aad5(0x1d2)]()[_0x29aad5(0x1ce)](0x2,'0')+':'+_0x3c268c[_0x29aad5(0x1b1)]()[_0x29aad5(0x1d2)]()[_0x29aad5(0x1ce)](0x2,'0');}function getTimeStamp(){const _0x53f1dd=_0x21dae9,_0x5e4707=shiftedTime();return _0x5e4707[_0x53f1dd(0x17f)]()+'/'+(_0x5e4707[_0x53f1dd(0x19d)]()+0x1)['toString']()[_0x53f1dd(0x1ce)](0x2,'0')+'/'+_0x5e4707[_0x53f1dd(0x2d9)]()[_0x53f1dd(0x1d2)]()[_0x53f1dd(0x1ce)](0x2,'0')+'\x20'+_0x5e4707['getHours']()[_0x53f1dd(0x1d2)]()['padStart'](0x2,'0')+':'+_0x5e4707[_0x53f1dd(0x2e3)]()[_0x53f1dd(0x1d2)]()[_0x53f1dd(0x1ce)](0x2,'0')+':'+_0x5e4707[_0x53f1dd(0x1b1)]()[_0x53f1dd(0x1d2)]()[_0x53f1dd(0x1ce)](0x2,'0');}function getCleanTimeStamp(){const _0x175bc7=_0x21dae9,_0x242086=shiftedTime();return _0x242086[_0x175bc7(0x17f)]()+(_0x242086['getMonth']()+0x1)[_0x175bc7(0x1d2)]()[_0x175bc7(0x1ce)](0x2,'0')+_0x242086[_0x175bc7(0x2d9)]()['toString']()[_0x175bc7(0x1ce)](0x2,'0')+'-'+_0x242086[_0x175bc7(0x17d)]()[_0x175bc7(0x1d2)]()['padStart'](0x2,'0')+_0x242086[_0x175bc7(0x2e3)]()['toString']()[_0x175bc7(0x1ce)](0x2,'0')+_0x242086[_0x175bc7(0x1b1)]()[_0x175bc7(0x1d2)]()[_0x175bc7(0x1ce)](0x2,'0');}function shiftedTime(){const _0x1183fb=_0x21dae9,_0x534500=new Date();let _0x2a8617=_0x534500;if(settings[_0x1183fb(0x1f0)]&&settings[_0x1183fb(0x1f0)]!==0x0)_0x2a8617=fns[_0x1183fb(0x256)](_0x534500,{'hours':settings[_0x1183fb(0x1f0)]});return _0x2a8617;}function startScheduler(){const _0x5bafe8=_0x21dae9,_0x18c844=new Date()[_0x5bafe8(0x2d3)](),_0x33b10a=shiftedTime()[_0x5bafe8(0x17d)]();_0x33b10a==0x4&&backupConfigFiles();_0x33b10a==0x0&&rotateLogFiles();_0x18c844%0x6==0x0&&triggerAnalytics();_0x18c844%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xcab420){const _0xee4097=_0x21dae9;logger[_0xee4097(0x1e9)](_0xee4097(0x2f8)+_0xcab420);const _0x251181=getBotsWithMode();_0x251181[_0xee4097(0x1ea)]>0x0?confirmRestore(configbackuppath,_0xcab420):unzipFile(configbackuppath,_0xcab420);}async function getBackupFiles(_0xc626ca=null){const _0x4565f6=_0x21dae9;let _0x4cf83f=[],_0x4e7e29=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4e7e29[_0x4565f6(0x21a)]((_0x276af7,_0x5dca0e)=>_0x276af7[_0x4565f6(0x2c1)]<_0x5dca0e[_0x4565f6(0x2c1)]?0x1:_0x5dca0e['name']<_0x276af7[_0x4565f6(0x2c1)]?-0x1:0x0),_0x4e7e29['forEach'](_0x2729c2=>{const _0x131dd7=_0x4565f6;if(!_0x2729c2[_0x131dd7(0x184)]()&&_0x2729c2['name'][_0x131dd7(0x2ae)](_0x131dd7(0x297))&&_0x2729c2[_0x131dd7(0x2c1)][_0x131dd7(0x1fd)]('.zip')){const _0x38819b=formatDate(fs[_0x131dd7(0x25e)](configbackuppath+_0x2729c2[_0x131dd7(0x2c1)])['mtime']);_0x4cf83f[_0x131dd7(0x343)]({'name':_0x2729c2['name'],'mtime':_0x38819b});}});if(_0xc626ca)io['to'](_0xc626ca)['emit']('backup-files',_0x4cf83f);else return _0x4cf83f;}async function backupConfigFiles(){const _0x5f147e=_0x21dae9;await zipFiles(_0x5f147e(0x18c));const _0x57a79b=getCleanTimeStamp();fs[_0x5f147e(0x201)](zippath+_0x5f147e(0x1f8),configbackuppath+(_0x5f147e(0x297)+_0x57a79b+_0x5f147e(0x1bd)));let _0x4d48d7=fs[_0x5f147e(0x212)](configbackuppath,{'withFileTypes':!![]});_0x4d48d7[_0x5f147e(0x21a)]((_0xe6f5c1,_0x1a61f6)=>_0xe6f5c1['name']<_0x1a61f6[_0x5f147e(0x2c1)]?0x1:_0x1a61f6[_0x5f147e(0x2c1)]<_0xe6f5c1['name']?-0x1:0x0),_0x4d48d7[_0x5f147e(0x1ea)]>maxBackups&&fs[_0x5f147e(0x192)](configbackuppath+_0x4d48d7[_0x4d48d7[_0x5f147e(0x1ea)]-0x1][_0x5f147e(0x2c1)]);}function rotateLogFiles(){const _0x406abd=_0x21dae9,_0xe7eecd=fs['statSync'](logspath+_0x406abd(0x294)),_0x1745f7=_0xe7eecd[_0x406abd(0x2f3)]/0x400;if(_0x1745f7>0x64){let _0x13253f=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x13253f[_0x406abd(0x21a)]((_0x11257a,_0x2f724d)=>_0x11257a[_0x406abd(0x2c1)]<_0x2f724d[_0x406abd(0x2c1)]?0x1:_0x2f724d[_0x406abd(0x2c1)]<_0x11257a[_0x406abd(0x2c1)]?-0x1:0x0),_0x13253f['forEach'](_0x36f68e=>{const _0x579c53=_0x406abd;if(_0x36f68e[_0x579c53(0x2c1)]==_0x579c53(0x214))fs[_0x579c53(0x201)](logspath+_0x36f68e['name'],logspath+_0x579c53(0x308));if(_0x36f68e[_0x579c53(0x2c1)]==_0x579c53(0x28b))fs[_0x579c53(0x201)](logspath+_0x36f68e[_0x579c53(0x2c1)],logspath+_0x579c53(0x214));_0x36f68e[_0x579c53(0x2c1)]==_0x579c53(0x294)&&(fs[_0x579c53(0x201)](logspath+_0x36f68e[_0x579c53(0x2c1)],logspath+_0x579c53(0x28b)),fs['writeFileSync'](logspath+_0x36f68e['name'],''));});}}async function zipFiles(_0x19a7b7){const _0x11922d=_0x21dae9;let _0x67f34;if(_0x19a7b7==_0x11922d(0x29b))_0x67f34=logspath;if(_0x19a7b7=='backup')_0x67f34=configpath;if(_0x19a7b7==_0x11922d(0x18c))_0x67f34=configpath;let _0x5494bb=fs[_0x11922d(0x212)](_0x67f34,{'withFileTypes':!![]});const _0x2677c6=new require(_0x11922d(0x330))();_0x5494bb['forEach'](_0x447e15=>{const _0x1c67c9=_0x11922d;if(!_0x447e15[_0x1c67c9(0x184)]()){let _0x4a1adf=fs[_0x1c67c9(0x24d)](_0x67f34+_0x447e15[_0x1c67c9(0x2c1)]);if(_0x19a7b7==_0x1c67c9(0x267)){const _0x17b9ad=/^bot-[0-9]{3}-config.json$/,_0x2c9aca=_0x17b9ad[_0x1c67c9(0x182)](_0x447e15['name']);if(_0x2c9aca){const _0x11415d=JSON[_0x1c67c9(0x207)](_0x4a1adf);if(_0x11415d[_0x1c67c9(0x281)][0x0]){_0x11415d[_0x1c67c9(0x281)][0x0][_0x1c67c9(0x25a)]=_0x1c67c9(0x20f),_0x11415d['bot'][0x0][_0x1c67c9(0x243)]='***';if(_0x11415d['bot'][0x0][_0x1c67c9(0x2b0)])_0x11415d['bot'][0x0][_0x1c67c9(0x2b0)]=_0x1c67c9(0x20f);}_0x4a1adf=JSON[_0x1c67c9(0x2d1)](_0x11415d,null,0x2);}if(_0x447e15[_0x1c67c9(0x2c1)]==_0x1c67c9(0x247)){const _0x155caa=JSON[_0x1c67c9(0x207)](_0x4a1adf);if(_0x155caa[_0x1c67c9(0x306)]['loginRequired'])_0x155caa[_0x1c67c9(0x306)][_0x1c67c9(0x24a)]=![];if(_0x155caa[_0x1c67c9(0x306)]['bbPassword'])_0x155caa['settings'][_0x1c67c9(0x1be)]=_0x1c67c9(0x20f);if(_0x155caa[_0x1c67c9(0x306)][_0x1c67c9(0x16f)])_0x155caa[_0x1c67c9(0x306)][_0x1c67c9(0x16f)]=_0x1c67c9(0x20f);if(_0x155caa[_0x1c67c9(0x306)][_0x1c67c9(0x32b)])_0x155caa[_0x1c67c9(0x306)][_0x1c67c9(0x32b)]=null;_0x4a1adf=JSON[_0x1c67c9(0x2d1)](_0x155caa,null,0x2);}if(_0x447e15[_0x1c67c9(0x2c1)]!='bb-secure.json')_0x2677c6[_0x1c67c9(0x21b)](_0x447e15[_0x1c67c9(0x2c1)],_0x4a1adf);}else _0x2677c6[_0x1c67c9(0x21b)](_0x447e15['name'],_0x4a1adf);}});const _0x31dc90=_0x2677c6[_0x11922d(0x310)]({'base64':![],'compression':_0x11922d(0x1dc)});fs[_0x11922d(0x2ff)](zippath+(_0x19a7b7+'.zip'),_0x31dc90,_0x11922d(0x1c8));}async function unzipFile(_0x391784,_0x5d2d54){const _0x20b97b=_0x21dae9;fs[_0x20b97b(0x212)](configpath,{'withFileTypes':!![]})[_0x20b97b(0x29f)](_0x1c6000=>{const _0x3100fe=_0x20b97b;if(!_0x1c6000[_0x3100fe(0x184)]())fs['rmSync'](configpath+_0x1c6000['name']);});const _0x4d2d06=fs[_0x20b97b(0x24d)](_0x391784+_0x5d2d54,_0x20b97b(0x1c8)),_0x3d9018=new require(_0x20b97b(0x330))(_0x4d2d06,{'base64':![],'checkCRC32':!![]});Object[_0x20b97b(0x264)](_0x3d9018[_0x20b97b(0x27d)])['forEach'](_0x4ecbae=>{const _0x2e3896=_0x20b97b,_0x44d90e=_0x3d9018[_0x2e3896(0x27d)][_0x4ecbae];fs['writeFileSync'](configpath+_0x44d90e[_0x2e3896(0x2c1)],_0x44d90e[_0x2e3896(0x2b8)]);}),fs[_0x20b97b(0x212)](temppath,{'withFileTypes':!![]})['forEach'](_0x936e9c=>{const _0x58937f=_0x20b97b;if(!_0x936e9c[_0x58937f(0x184)]())fs[_0x58937f(0x20b)](temppath+_0x936e9c[_0x58937f(0x2c1)]);}),logger[_0x20b97b(0x1e9)](_0x20b97b(0x18f)),process[_0x20b97b(0x1eb)]({'restore':!![]},_0x2ea73e=>{});}async function getPublicIp(){const _0x421e10=_0x21dae9;try{const _0x52ad13=await axios[_0x421e10(0x2df)](_0x421e10(0x291));publicip=_0x52ad13[_0x421e10(0x31f)]['ip'];}catch(_0x45a311){}}async function triggerAnalytics(){const _0x141436=_0x21dae9;if(!publicip)await getPublicIp();const _0x5e28d9=getBotsWithMode();let _0x21453b=0x0;_0x5e28d9[_0x141436(0x29f)](_0xd80bb9=>{const _0x2d7430=_0x141436;if(_0xd80bb9[_0x2d7430(0x220)]===_0x2d7430(0x257))_0x21453b++;});const _0x2f81d3=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x5e28d9[_0x141436(0x1ea)],'numbotsenabled':_0x21453b,'exchanges':_0x2f81d3,'environment':environment});}function _0x55ed(){const _0x1f1369=['/:bot/coins','log','tkn','temporaryAccessAllowed','Logged\x20in\x20user\x20...','token','off_','join','reinstall_yes','mode','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','telegramUsername','Notifications\x20types:\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','slice','127.0.0.1','exchange','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','getStartingBalances','files','build','telegram','inherit','bot','No\x20bots\x20running\x20right\x20now','restart','Backup\x20file\x20uploaded','password','reload','mkdirSync','RSA','login2fa_','conn','output-001.log','login','uuid-random','storeHeadless','address','SIGTERM','https://api.ipify.org?format=json','\x20|\x20','Invalid\x20IP\x20address','output-000.log','userid','clientip','backup-full@','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','latestversion','restart_','logs','-----------------------------------------------------------------------------------','show-config','=>\x20Go\x20to\x20#CYA#http://','forEach','login\x20not\x20required','argv','\x20(1)','listen','#RES#\x20','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','connection','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Disabled\x20Bot\x20','add-bot','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','from','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','startsWith','Unauthorized\x20attempt\x20to\x20store\x20configuration','apiPassword','timestamp','privateKey','range','private','show','-events.json','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','_data','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','metrics_','/download/:type','access','botname','$1_$2_$3','new-disabled','ipaddr.js','name','host','You\x20can\x20use\x20the\x20following\x20commands:\x0a','api-eu.mixpanel.com','remoteAddress','randomFillSync','yes','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','config_all','onepagemode','chat','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Unauthorized\x20attempt\x20to\x20download\x20','command','bb-secure.json','stringify','update','getUTCHours','express-fileupload','sign','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','expiry','login\x20token\x20valid','getDate','Restore\x20process\x20confirmed','hashSync','number','<b>Telegram\x20Bot\x20Status:</b>\x0a','all','get','Deleted\x20Bot\x20','*$1*','/on\x20-\x20start\x20bot(s)\x0a','getMinutes','30\x20min','referer','set','assign','Unauthorized\x20attempt\x20to\x20delete\x20alerts','emitHistory','Login\x20accepted','telegramIpApproval','1000','update-bot','#RES#\x20if\x20running\x20locally\x0a','Password\x20reset\x20rejected','type','temporary\x20token\x20generated','6b67f3d61ee94b8f5c80b4affef4c4d9','size','filter','All\x20bots','-results.json','Logged\x20out\x20user\x20...','Restore\x20backup\x20file\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','place-order','exec','Error\x20removing\x20old\x20backup\x20files:','messages','env','writeFileSync','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','store-fiat','logout','84FGmCBj','Unauthorized\x20attempt\x20to\x20log\x20out','get-backup-files','settings','[ip-address]','output-003.log','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','IPv4','reason','botID','editMessageReplyMarkup','showConfig','Notifications\x20disabled\x0a','generate','Notifications\x20enabled','callback','replace','clients','stopped','isValid','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','isIPv4MappedAddress','date-fns','/status\x20-\x20show\x20bot(s)\x20status\x0a','2FA','15\x20min','map','axios','data','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','hex','All\x20bots\x20running\x20right\x20now','\x20>\x20','metrics','simple','\x20|\x20user:\x20...','accept','Starting\x20(','pidRefreshToken','createWriteStream','telegramChatId','lastmsgtelegram','publicKey','mixpanel','remove','node-zip','Ok,\x20will\x20send\x20alert\x20notifications\x20only','temporary\x20access\x20rejected','started','user','22OiAvuR','apply','portfolio_','Password\x20has\x20been\x20reset\x20to:\x20','disable','2790012OOmTAd','removeAllListeners','launch',':\x20Bot\x20Mgr\x20>\x20','2FA\x20login\x20token\x20generated','new','sendMessage','resetpw_yes','::1','push','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Idling\x20(','lowdb/adapters/FileSync','\x1b[34m','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','production','/output-000.log','Bot\x20','family','cloneDeep',')\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','Yes','sendPortfolioTelegram','emit','min','restore_yes_','util',',\x20must\x20be\x20a\x204\x20digit\x20number','headers','\x20mode','/:bot','value','Restore\x20process\x20aborted','-config.json','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','full','telegram2FaApproval','socket','init','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','on_','inlineKeyboard','logged\x20out','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getTime','Crypt','telegramToken','internal','orders','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','server','Access\x20enabled\x20for\x20','use','handshake','Starting\x20new\x20bot\x20|\x20Bot\x20','reply','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','request','live','All','getHours','Failed\x20to\x20download\x20','getFullYear','/:bot/performance','allow','test','reset-password','isDirectory','download','post','args','lastmsgemitted','************','Login\x20rejected','Notifications\x20enabled\x0a','backup-full','/off\x20-\x20stop\x20bot(s)\x0a','get-portfolio','Backup\x20file\x20unzipped\x20and\x20stored','Error:\x20Invalid\x20argument\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','unlinkSync','<b>Balance\x20Bot\x20Status:</b>\x0a','lowdb','Restoring\x20bot(s)\x20from\x20backup','16lsUJEG','once','Node.js\x20v','/help\x20-\x20show\x20available\x20commands\x0a','enable','store-configuration','notification','getMonth','Error\x20while\x20deleting\x20config\x20files:\x20','update_yes','Starting\x20Balance\x20Bot\x20reinstallation','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20events','bots','blacklist','access\x20timeout','get-messages','secret','success','temp/','disabled','sendMetricsTelegram','updatebotmanager','message','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','invalid\x20credentials','/enable\x20-\x20enable\x20notifications\x0a','getSeconds','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','search','#RES#\x20if\x20running\x20on\x20server','2FA\x20login\x20required','kill','event','static','/:bot/history','version.json','jsonwebtoken','Telegram\x20error:','.zip','bbPassword','HTML','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','update-bb','express','login\x20token\x20generated','config','version',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','444731lxPdtY','binary','disconnect','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','settings.','bbUsername','username','padStart','Allow\x20login\x20from\x20IP\x20address\x20','3000','sockets','toString','939590hafzlO','17jYylnQ','120180qsthTq','Invalid\x20authentication\x20token\x20(1)','bb/','secure','bcryptjs','backupfile','224937oluHwl','DEFLATE','2FA\x20required','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','35864jrPoqa','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','f2aRequired','\x1b[0m','string','sortBy','start','User\x20has\x20been\x20validated','format','zip/','debug','length','send','Unauthorized\x20login\x20attempt\x20(timeout)','auto','find','staging','timeshift','Token\x20blacklisted','sendFile','sha256','store-settings','\x20|\x20client:\x20...','/restart\x20-\x20restart\x20bot(s)\x0a','randomBytes','backup-full.zip','verify','SIGINT','alerts','error','endsWith','action','whitelist','running','copyFileSync','login2fa_reject_','tempaccess_5_','Session\x20expired\x20for\x20user\x20...','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','RSA-OAEP','parse','defaults','(((.+)+)+)+$','Invalid\x20username\x20or\x20IP\x20address','rmSync','telegramEnabled','5\x20min','toggle_','***','index.html','initclient','readdirSync','bbvReceive','output-002.log','bot.js','0.0.0','uuid','portfolio','toggleBotMode','sort','file','exp','exit',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','bot-','status','toIPv4Address','\x20to\x20','getPortfolio','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','decrypt','telegramEvents','pidExpireLogin','existsSync','help','config_alerts','path','/disable\x20-\x20disable\x20notifications\x0a','split','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','write','warning','Network\x20Interfaces:','bbvNew','Telegraf\x20error:','match','File\x20uploaded','stop','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',')\x20|\x20Bot\x20','catch','config/','/:bot/portfolio','manual','botmanager','whitelistEnabled','temporary\x20access\x20timeout','reinstall','close','apiSecret','headless','build2','reset-history','bb-settings.json','Unauthorized\x20attempt\x20to\x20update\x20bot','telegrammsg','loginRequired','toggle','yargs/yargs','readFileSync','socket.io','any','\x1b[35m','(staging)','2528157eRkvsr','button','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','hasOwnProperty','add','enabled','port','config_orders','apiKey','reject','tempaccess_reject_','Unauthorized\x20attempt\x20to\x20confirm\x20message','statSync','bb-config.json','delete-alerts','/names\x20-\x20show\x20bot\x20names\x0a','connected','environment','keys','ipc','store','backup','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','order'];_0x55ed=function(){return _0x1f1369;};return _0x55ed();}async function getMessages(){const _0x28aba1=_0x21dae9,_0x1a5f5c=_0x28aba1(0x191),_0x562f02=new GraphQLClient(_0x1a5f5c),_0xd63f42={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x376bfc=serverversion[_0x28aba1(0x22d)]('.'),_0x558579=_0x376bfc[0x0]+'.'+_0x376bfc[0x1],_0x2903d9=Math[_0x28aba1(0x158)](settings[_0x28aba1(0x32c)],settings[_0x28aba1(0x188)]),_0x3ee8d7={'last':parseInt(_0x2903d9),'bbm':_0x558579},_0x14c1c1=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2de2dd;try{_0x2de2dd=await _0x562f02[_0x28aba1(0x17a)](_0x14c1c1,_0x3ee8d7,_0xd63f42);}catch(_0x4b3202){}if(_0x2de2dd&&_0x2de2dd['messages']){let _0xb3901b=settings[_0x28aba1(0x32c)];newMessages=[];for(const _0x334d02 of _0x2de2dd[_0x28aba1(0x2fd)]){newMessages[_0x28aba1(0x343)](_0x334d02);let _0x3aab05=![];_0x334d02[_0x28aba1(0x233)]&&(updateSetting(_0x28aba1(0x299),_0x334d02[_0x28aba1(0x233)]),_0x3aab05=isNewerVersion(serverversion,_0x334d02['bbvNew'])||serverversion==_0x334d02[_0x28aba1(0x233)]);if(!_0x3aab05&&_0x334d02[_0x28aba1(0x2dc)]>_0xb3901b){if(_0x334d02[_0x28aba1(0x213)]===_0x28aba1(0x24f)||serverversion[_0x28aba1(0x2ae)](_0x334d02[_0x28aba1(0x213)])){let _0x2f79c0=''+_0x334d02['title']+'\x0a\x0a'+_0x334d02[_0x28aba1(0x1ad)];const _0x4aa458=await sendTelegramMsg(toTelegramMarkdown(_0x2f79c0),'Markdown');if(_0x4aa458)_0xb3901b=_0x334d02[_0x28aba1(0x2dc)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x28aba1(0x32c),_0xb3901b),emitMessages();}}function emitMessages(){const _0x1dfacc=_0x21dae9,_0x1a059f=settings['lastmsgemitted'];let _0x5134b7=[];newMessages['forEach'](_0x16a03b=>{const _0xc206d3=_0x2aa0;_0x16a03b[_0xc206d3(0x2dc)]>_0x1a059f&&_0x5134b7[_0xc206d3(0x343)](_0x16a03b);}),_0x5134b7['length']>0x0&&getAllClients()[_0x1dfacc(0x29f)](_0x448531=>{const _0x3c9a0d=_0x1dfacc;getSocket(_0x448531['id'])[_0x3c9a0d(0x157)](_0x3c9a0d(0x1ad),_0x5134b7);});}function confirmMessage(_0x397c14){const _0x5af185=_0x21dae9;updateSetting(_0x5af185(0x188),Number(_0x397c14));}function isNewerVersion(_0x1b6661,_0x3499cd){const _0x2188e3=_0x21dae9,_0x341506=_0x3499cd[_0x2188e3(0x22d)]('.'),_0x47906f=_0x1b6661[_0x2188e3(0x22d)]('.');for(var _0xcd3994=0x0;_0xcd3994<_0x47906f[_0x2188e3(0x1ea)];_0xcd3994++){const _0x5a3fa9=~~_0x47906f[_0xcd3994],_0x2bf3d0=~~_0x341506[_0xcd3994];if(_0x5a3fa9>_0x2bf3d0)return!![];if(_0x5a3fa9<_0x2bf3d0)return![];}return![];}function toTelegramMarkdown(_0x2d1a63){const _0x4dd38f=_0x21dae9,_0x438749=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1a2e15=/\*{2}(.+?)\*{2}/gim;return _0x2d1a63=_0x2d1a63['replace'](_0x438749,_0x4dd38f(0x2be))['replace'](_0x1a2e15,_0x4dd38f(0x2e1)),_0x2d1a63;}async function validateConfigFile(){const _0x367918=_0x21dae9,_0xb57be4=dbConfig['get'](_0x367918(0x1a3))['sortBy'](_0x367918(0x30c))['value']()||[];if(_0xb57be4[_0x367918(0x1ea)]==0x0){let _0x2f8f3b=0x0,_0x3e8f2c=[];const _0x1fc20c=/^bot-([0-9]{3})-config.json$/,_0x11b838=fs[_0x367918(0x212)](configpath);_0x11b838[_0x367918(0x29f)](_0x28e1a7=>{const _0x5e49ca=_0x367918,_0x371e45=_0x1fc20c[_0x5e49ca(0x2fb)](_0x28e1a7);if(_0x371e45){const _0x590fae=_0x371e45[0x1];let _0x2316ab=getBotAttributes(_0x590fae);_0x3e8f2c[_0x5e49ca(0x343)]({'botID':_0x590fae,'botname':_0x2316ab[_0x5e49ca(0x2bd)],'status':_0x5e49ca(0x1aa),'live':_0x5e49ca(0x315)}),_0x2f8f3b++;}}),_0x2f8f3b!=0x0&&(dbConfig[_0x367918(0x2df)]('bots')[_0x367918(0x2e7)](_0x3e8f2c)[_0x367918(0x230)](),config=_0x3e8f2c,restoredConfigFile=_0x2f8f3b);}}async function restoreConfigNotify(_0x3135ce){const _0x130f33=_0x21dae9;let _0x24bcf5;if(restoredConfigFile==0x1)_0x24bcf5=_0x130f33(0x274);else _0x24bcf5=_0x130f33(0x2a7);if(_0x3135ce)io['to'](_0x130f33(0x23e))[_0x130f33(0x157)]('notification',_0x24bcf5);else{logger['simple'](_0x130f33(0x29c)),logger[_0x130f33(0x325)](_0x24bcf5),logger[_0x130f33(0x325)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x130f33(0x32b)]&&settings[_0x130f33(0x226)]!=_0x130f33(0x171))await sendTelegram(settings[_0x130f33(0x32b)],'Bot\x20Mgr\x20>\x20'+_0x24bcf5);}}function validateCredentials(_0x5ed3e4,_0x261fff){const _0x2b3c2f=_0x21dae9;if(_0x5ed3e4[_0x2b3c2f(0x1cd)]==settings[_0x2b3c2f(0x1cc)]&&bcrypt['compareSync'](_0x5ed3e4[_0x2b3c2f(0x285)],settings[_0x2b3c2f(0x1be)])){if(settings[_0x2b3c2f(0x1e1)])return{'allow':![],'reason':_0x2b3c2f(0x1b5),'token':null};else{const _0x3e976f=generateLoginToken(_0x261fff);return{'allow':!![],'reason':_0x2b3c2f(0x1c3),'token':_0x3e976f};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x53acfe){const _0x34c42d=generateLoginToken(_0x53acfe);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x34c42d};}function validateAccess(_0x62d8af,_0x45f026,_0x2cae27){const _0x2354c8=_0x21dae9,_0x5486b2=_0x2cae27?_0x2cae27:devices[_0x45f026]['ip'];let _0x1192bc;const _0x36ce85=_0x36283f=>{const _0x10e61a=_0x2aa0;if(settings['loginRequired']){if(settings[_0x10e61a(0x1e1)]){if(telegram2FaApproved(_0x45f026)){const _0x5ef708=generateLoginToken(_0x45f026);return{'allow':!![],'reason':_0x10e61a(0x33e),'token':_0x5ef708};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1192bc=validToken(_0x36283f,_0x45f026),_0x1192bc[_0x10e61a(0x255)](_0x10e61a(0x1a8))?{'allow':!![],'reason':_0x10e61a(0x2d8),'token':_0x36283f}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x10e61a(0x2a0),'token':null};};if(settings[_0x2354c8(0x23f)]){let _0x51efdb=[...settings[_0x2354c8(0x1ff)],_0x2354c8(0x342),'::ffff:127.0.0.1',_0x2354c8(0x279)];if(_0x51efdb['includes'](_0x5486b2))return _0x36ce85(_0x62d8af);else{_0x1192bc=validToken(_0x62d8af,_0x45f026);if(_0x1192bc[_0x2354c8(0x255)](_0x2354c8(0x1a8)))return _0x36ce85(_0x62d8af);else{if(telegramIpApproved(_0x45f026)){const _0x5f2356=generateToken(_0x45f026);return _0x1192bc=_0x36ce85(_0x62d8af),_0x1192bc['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x5f2356}:_0x1192bc;}else return settings[_0x2354c8(0x26d)]?{'allow':![],'reason':_0x2354c8(0x1dd),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x36ce85(_0x62d8af);}function timelyDecrypt(_0x18737f,_0x50a442=!![]){const _0x3a95a6=_0x21dae9;if(_0x18737f)try{const _0x308b67=crypt[_0x3a95a6(0x225)](secure[_0x3a95a6(0x2b2)],_0x18737f)[_0x3a95a6(0x1ad)],_0x77d5af=_0x308b67[_0x3a95a6(0x22d)]('@')[0x0],_0x37b2f7=_0x308b67[_0x3a95a6(0x22d)]('@')[0x1],_0x4831af=new Date()[_0x3a95a6(0x16d)]();if(_0x50a442){if(_0x4831af-_0x37b2f7<maxSecretAge*0x3e8)return _0x77d5af;else return![];}else return _0x77d5af;}catch(_0x1ced84){return![];}else return![];}const validToken=(_0x3292a7,_0x5d02cd)=>{const _0x2803e6=_0x21dae9,_0x45d034=devices[_0x5d02cd]['ip'];if(!_0x3292a7)return{'error':'No\x20authentication\x20token'};for(let _0x4f8487 of blacklist){if(_0x4f8487[_0x2803e6(0x26f)]==_0x3292a7)return{'error':_0x2803e6(0x1f1)};}let _0x11ca75;try{_0x11ca75=jwt[_0x2803e6(0x1f9)](_0x3292a7,secure[_0x2803e6(0x1a7)]+_0x5d02cd);}catch{return{'error':_0x2803e6(0x1d6)};}if(!_0x11ca75[_0x2803e6(0x255)]('clientip')&&!_0x11ca75['hasOwnProperty']('username')||!_0x11ca75[_0x2803e6(0x255)](_0x2803e6(0x21c)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x11ca75[_0x2803e6(0x255)](_0x2803e6(0x1cd))&&_0x11ca75[_0x2803e6(0x255)](_0x2803e6(0x296))){const {clientip:_0x8c3d8e}=_0x11ca75;return _0x45d034==_0x8c3d8e?{'success':_0x2803e6(0x1e6)}:{'error':_0x2803e6(0x293)};}else{if(_0x11ca75[_0x2803e6(0x255)](_0x2803e6(0x1cd))&&_0x11ca75[_0x2803e6(0x255)](_0x2803e6(0x296))){const {username:_0x555b06,clientip:_0x3be725}=_0x11ca75;return settings['bbUsername']==_0x555b06&&_0x45d034==_0x3be725?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2803e6(0x20a)};}}},generateLoginToken=_0x550c09=>{const _0x2595f9=_0x21dae9;if(_0x550c09){const _0x1eed0b=devices[_0x550c09]['ip'];return jwt[_0x2595f9(0x2d5)]({'username':settings[_0x2595f9(0x1cc)],'clientip':_0x1eed0b},secure[_0x2595f9(0x1a7)]+_0x550c09,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x54a3ca=>{const _0x5b414f=_0x21dae9;if(_0x54a3ca){const _0x39e245=devices[_0x54a3ca]['ip'];return jwt[_0x5b414f(0x2d5)]({'clientip':_0x39e245},secure['secret']+_0x54a3ca,{'expiresIn':devices[_0x54a3ca][_0x5b414f(0x2eb)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x317aeb=>{const _0xaa6d1a=_0x21dae9;let _0x120c08=![];return devices[_0x317aeb][_0xaa6d1a(0x2eb)]&&devices[_0x317aeb]['telegramIpApproval'][_0xaa6d1a(0x2d7)]!=_0xaa6d1a(0x25b)&&(_0x120c08=devices[_0x317aeb][_0xaa6d1a(0x2eb)][_0xaa6d1a(0x296)]==devices[_0x317aeb]['ip']&&new Date()[_0xaa6d1a(0x16d)]()-devices[_0x317aeb]['telegramIpApproval'][_0xaa6d1a(0x2b1)]<devices[_0x317aeb][_0xaa6d1a(0x2eb)][_0xaa6d1a(0x2d7)]*0x3c*0x3e8),_0x120c08;},telegram2FaApproved=_0x12281a=>{const _0x3738d1=_0x21dae9;let _0x9ed442=![];return devices[_0x12281a][_0x3738d1(0x164)]&&devices[_0x12281a][_0x3738d1(0x164)][_0x3738d1(0x2d7)]!=_0x3738d1(0x25b)&&(_0x9ed442=devices[_0x12281a][_0x3738d1(0x164)][_0x3738d1(0x296)]==devices[_0x12281a]['ip']&&new Date()[_0x3738d1(0x16d)]()-devices[_0x12281a][_0x3738d1(0x164)][_0x3738d1(0x2b1)]<devices[_0x12281a][_0x3738d1(0x164)][_0x3738d1(0x2d7)]*0x3c*0x3e8),_0x9ed442;},normalizeIP=_0x319468=>{const _0x44f138=_0x21dae9;let _0x39d72c=null,_0x3747d1=null;if(ipaddr[_0x44f138(0x316)](_0x319468)){const _0x8eeab8=ipaddr[_0x44f138(0x207)](_0x319468);_0x8eeab8['kind']()==='ipv6'?(_0x8eeab8[_0x44f138(0x318)]()&&(_0x39d72c=_0x8eeab8[_0x44f138(0x221)]()[_0x44f138(0x1d2)]()),_0x3747d1=_0x8eeab8[_0x44f138(0x1d2)]()):(_0x39d72c=_0x8eeab8[_0x44f138(0x1d2)](),_0x3747d1=_0x8eeab8['toIPv4MappedAddress']()['toString']());}return{'show':_0x39d72c?_0x39d72c:_0x3747d1,'store':_0x3747d1};};function formatDate(_0x4093e9){const _0x33f372=_0x21dae9;return _0x4093e9['getFullYear']()+'/'+(_0x4093e9[_0x33f372(0x19d)]()+0x1)[_0x33f372(0x1d2)]()[_0x33f372(0x1ce)](0x2,'0')+'/'+_0x4093e9[_0x33f372(0x2d9)]()[_0x33f372(0x1d2)]()['padStart'](0x2,'0')+'\x20'+_0x4093e9[_0x33f372(0x17d)]()['toString']()[_0x33f372(0x1ce)](0x2,'0')+':'+_0x4093e9[_0x33f372(0x2e3)]()['toString']()[_0x33f372(0x1ce)](0x2,'0')+':'+_0x4093e9[_0x33f372(0x1b1)]()[_0x33f372(0x1d2)]()[_0x33f372(0x1ce)](0x2,'0');}function sleep(_0xca908c){return new Promise(_0x8d0711=>setTimeout(_0x8d0711,_0xca908c));}