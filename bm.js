const _0x47280c=_0x3f24;(function(_0x1580e9,_0x4d6474){const _0x2c0e4e=_0x3f24,_0x5629db=_0x1580e9();while(!![]){try{const _0x2f3540=-parseInt(_0x2c0e4e(0x264))/0x1+-parseInt(_0x2c0e4e(0x306))/0x2+-parseInt(_0x2c0e4e(0x236))/0x3+parseInt(_0x2c0e4e(0x35c))/0x4*(parseInt(_0x2c0e4e(0x3c3))/0x5)+parseInt(_0x2c0e4e(0x20c))/0x6*(parseInt(_0x2c0e4e(0x311))/0x7)+-parseInt(_0x2c0e4e(0x359))/0x8*(parseInt(_0x2c0e4e(0x237))/0x9)+-parseInt(_0x2c0e4e(0x23e))/0xa*(-parseInt(_0x2c0e4e(0x1fd))/0xb);if(_0x2f3540===_0x4d6474)break;else _0x5629db['push'](_0x5629db['shift']());}catch(_0x3180b9){_0x5629db['push'](_0x5629db['shift']());}}}(_0x39ae,0x9eb6b));const _0x4d1abd=function(){let _0x719564=!![];return function(_0x151bb7,_0x430dd2){const _0x1d77b6=_0x719564?function(){const _0x664d7b=_0x3f24;if(_0x430dd2){const _0x2c803b=_0x430dd2[_0x664d7b(0x31a)](_0x151bb7,arguments);return _0x430dd2=null,_0x2c803b;}}:function(){};return _0x719564=![],_0x1d77b6;};}(),_0x15833c=_0x4d1abd(this,function(){const _0x3bc123=_0x3f24;return _0x15833c[_0x3bc123(0x2c7)]()[_0x3bc123(0x361)]('(((.+)+)+)+$')[_0x3bc123(0x2c7)]()[_0x3bc123(0x330)](_0x15833c)[_0x3bc123(0x361)](_0x3bc123(0x212));});_0x15833c();'use strict';process[_0x47280c(0x2d9)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x47280c(0x378)),fs=require('fs'),fns=require(_0x47280c(0x309)),low=require(_0x47280c(0x36d)),FileSync=require(_0x47280c(0x2cd)),path=require(_0x47280c(0x2d4)),crypto=require(_0x47280c(0x202)),Crypt=require(_0x47280c(0x286))[_0x47280c(0x362)],RSA=require(_0x47280c(0x286))[_0x47280c(0x2b6)],bcrypt=require(_0x47280c(0x25e)),jwt=require(_0x47280c(0x34d)),ipaddr=require(_0x47280c(0x1f0)),argv=require(_0x47280c(0x342))(process[_0x47280c(0x3cc)][_0x47280c(0x26e)](0x2))[_0x47280c(0x3cc)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x47280c(0x3bc)),Mixpanel=require(_0x47280c(0x392)),axios=require(_0x47280c(0x2cb)),{GraphQLClient,gql}=require(_0x47280c(0x2e3)),util=require(_0x47280c(0x301)),fileUpload=require(_0x47280c(0x2fc)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x47280c(0x2ce),pattern=/^[0-9]{2,4}$/;!pattern[_0x47280c(0x221)](PORT)&&(console[_0x47280c(0x220)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x47280c(0x2cf)]||null,userID=argv[_0x47280c(0x294)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x47280c(0x29f)],environment=require(_0x47280c(0x269))['environment']||_0x47280c(0x265);let bbpath=_0x47280c(0x279),bbpath2='';const botfile=_0x47280c(0x2dc),configfile=_0x47280c(0x2aa),settingsfile=_0x47280c(0x381),securefile=_0x47280c(0x371),maxBackups=0xa;let validInstallation=!![];!fs[_0x47280c(0x2ab)](bbpath+botfile)&&(bbpath='',validInstallation=![]);function _0x39ae(){const _0x577cdd=['sendMessage','assign','settings','Disabled\x20Bot\x20','min','stop','debug','https://api.ipify.org?format=json','resetHistory','generateKeyPairAsync','sort','Unauthorized\x20attempt\x20to\x20download\x20','simple','reject','error','notification','bcryptjs','Orders','defaults','Network\x20Interfaces:','Ok,\x20will\x20send\x20alert\x20notifications\x20only','telegramUsername','47576ercedS','production','logout','Notifications\x20enabled','deleteHistoryAlerts','./version.json','ipc','readdirSync','filter','randomFillSync','slice','string','match','event','data','answerCallbackQuery','getTime','Bot\x20','getHours','stringify','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bb/','new-disabled','login\x20required','password','apiSecret','apiPassword','bbvNew','6b67f3d61ee94b8f5c80b4affef4c4d9','************',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','orders','Restore\x20backup\x20file\x20','bbvReceive','hybrid-crypto-js','chat','toIPv4Address','conn','logged\x20out','Backup\x20file\x20uploaded','socket.io','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','expiry','encryptedUuid','statSync','sortBy','\x20|\x20client:\x20...','add','user','Login\x20accepted','invalid\x20credentials','show','/metrics\x20-\x20show\x20bot\x20performance\x0a','getMinutes','keys','\x20(2)','exp','-events.json','2FA\x20login\x20required','node','remove','telegramEnabled','lastmsgemitted','enabled','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','hashSync','max','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','name','RSA-OAEP','bb-config.json','existsSync','disconnect','privateKey','allow','No\x20authentication\x20token','get','/:bot/performance','decrypt','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','remoteAddress','generate','RSA','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','delete-alerts','telegram2FaApproval','staging','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','cloneDeep','/:bot/support','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Access\x20enabled\x20for\x20','bot-','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','format','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','message','started','headers','toString','cancelLoading','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','axios','Deleted\x20Bot\x20','lowdb/adapters/FileSync','3000','host','zip/','secret','telegramChatId','live','path','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/output-000.log','compareSync','server','env','stopPolling','Bot\x20Mgr\x20>\x20','bot.js','=>\x20Go\x20to\x20#CYA#http://','size','callback_query','Unauthorized\x20attempt\x20to\x20get\x20messages','showname','storeConfiguration','graphql-request','pidExpireLogin','get-backup-files','/restart\x20-\x20restart\x20bot(s)\x0a','listen','get-starting-balances','-config.json','endsWith','parse','getStartingBalances','\x1b[0m','success','blacklist','latestversion','/:bot','temporary\x20token\x20generated','add-bot','Invalid\x20authentication\x20token\x20(2)','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','verify','logs','temporary\x20access\x20not\x20allowed','forEach','mkdirSync','express-fileupload','store-headless','post','lastmsgtelegram','botID','util','\x1b[33m','store','value','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','2215426mpdNfJ','Notifications\x20disabled\x0a','pidRefreshToken','date-fns','\x20(1)','handshake','\x1b[36m','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/enable\x20-\x20enable\x20notifications\x0a','-----------------------------------------------------------------------------------','confirm-message','451157UKoSfF','get-logs','files','getPortfolio','build','::ffff:127.0.0.1','backupfile','backup-full@','backup','apply','#RES#\x20if\x20running\x20locally\x0a','access','function','loginRequired','Login\x20rejected','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','<b>Balance\x20Bot\x20Status:</b>\x0a','File\x20uploaded','All\x20bots','[ip-address]','getSeconds','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','\x20|\x20','Enabled\x20Bot\x20','***','token','place-order','connection','0.0.0','index.html','<b>Telegram\x20Bot\x20Status:</b>\x0a','constructor','emit','binary','entries','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','timeshift','map','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','use','split','full','Logged\x20out\x20user\x20...','clients','reinstall-bb','restart','Unauthorized\x20attempt\x20to\x20store\x20configuration','family','write','yargs/yargs','127.0.0.1','storeFiat','botmanager','SIGINT','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','find','connected','push','internal','copyFileSync','jsonwebtoken','#RES#\x20if\x20running\x20on\x20server','version.json','temporary\x20access\x20timeout','-performance.json','send','range','1000','Setting\x20access:\x20','login\x20not\x20required','node-zip','config/','1472Gkytnz','getDate','-results.json','194208RIVguT','join','writeFileSync','reload','padStart','search','Crypt','backup-full','telegram','yes','(staging)','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20login\x20attempt\x20(timeout)','hasOwnProperty','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','secure','Unauthorized\x20attempt\x20to\x20get\x20events','lowdb','\x20only\x0a','mode','Temporary\x20access\x20rejected','bb-secure.json','from','bbUsername','isDirectory','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','showConfig','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','child_process','createServer','f2aRequired','rmSync','login\x20token\x20generated','type','disabled','Logged\x20in\x20user\x20...','Restoring\x20bot(s)\x20from\x20backup','bb-settings.json','unlinkSync','toIPv4MappedAddress','output-000.log','request','userid','title','socket','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','HTML','uuid','auth','reset-history','telegramIpApproval','settings.','telegrammsg','mixpanel','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/names\x20-\x20show\x20bot\x20names\x0a','params','update','output-002.log','.zip','Unauthorized\x20attempt\x20to\x20update\x20settings','getMonth','uncaughtException','Restore\x20process\x20aborted','Unauthorized\x20attempt\x20to\x20confirm\x20message','IPv4','timestamp','Markdown','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Notifications\x20types:\x20','\x20>\x20','temporary\x20access\x20rejected','Starting\x20Balance\x20Bot\x20update','randomBytes','version','404\x20Not\x20Found','address','botname','Unauthorized\x20attempt\x20to\x20add\x20bot','polling_error','/upload-backup','Node.js\x20v','file','then','build2','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','store-configuration','reinstall','exit','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','startsWith','output-001.log','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','$1_$2_$3','node-telegram-bot-api','initclient','login','login\x20token\x20valid','getFullYear','Notifications\x20disabled','</b>\x20?','80BEeKXr','_data','once','sendMetricsTelegram','api-eu.mixpanel.com','static','clientip','Unauthorized\x20attempt\x20to\x20log\x20out','apiKey','argv','toggleBotMode','telegramToken','sockets','onText','fork','telegramEvents','ipaddr.js','publicKey','backup-files','replace','new','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Unauthorized\x20attempt\x20to\x20update\x20bot','2FA\x20login\x20token\x20generated','kill','number','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','set','headless','33YAukto','sha256','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','delete-bot','crypto','length','sendPortfolioTelegram','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','bot','reason','hex','sign','2FA\x20required','Error\x20removing\x20old\x20backup\x20files:','96MGYMIv','Password\x20has\x20been\x20reset\x20to:\x20','backup/','/:bot/history','all','bbPassword','(((.+)+)+)+$','mtime','\x20to\x20','/:bot/configuration','status','createWriteStream','whitelistEnabled','get-messages','update-bot','logs/','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','includes','init','log','test','\x1b[34m','stopped','/off\x20-\x20stop\x20bot(s)\x0a','reset-password','No\x20bots\x20running\x20right\x20now','Invalid\x20IP\x20address','bots','download','Failed\x20to\x20download\x20','alerts','Invalid\x20username\x20or\x20IP\x20address','catch','username','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','30\x20min','User\x20has\x20been\x20validated','Error\x20while\x20deleting\x20config\x20files:\x20','sendFile','\x1b[31m','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','2195307OrfRFP','30762NpxeJT','2FA','temp/','emitHistory','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','onepagemode','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','4526710WTojAf','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','readFileSync','removeAllListeners','toggle-bot-mode','inherit','get-portfolio','isValid','args','update-bb','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','removeListener','auto','5\x20min','manual','storeHeadless'];_0x39ae=function(){return _0x577cdd;};return _0x39ae();}const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x47280c(0x33c)),configpath=userID?bbpath+_0x47280c(0x358)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x47280c(0x20e),logspath=userID?bbpath+_0x47280c(0x21b)+userID+'/':bbpath+_0x47280c(0x21b),zippath=userID?bbpath+_0x47280c(0x2d0)+userID+'/':bbpath+_0x47280c(0x2d0),loggerfile=fs[_0x47280c(0x217)](logspath+_0x47280c(0x2d6),{'flags':'a'}),temppath=userID?bbpath+_0x47280c(0x239)+userID+'/':bbpath+_0x47280c(0x239);!fs[_0x47280c(0x2ab)](configpath)&&fs[_0x47280c(0x2fb)](configpath);!fs[_0x47280c(0x2ab)](configbackuppath)&&fs[_0x47280c(0x2fb)](configbackuppath);!fs[_0x47280c(0x2ab)](logspath)&&fs[_0x47280c(0x2fb)](logspath);!fs['existsSync'](zippath)&&fs[_0x47280c(0x2fb)](zippath);!fs[_0x47280c(0x2ab)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x47280c(0x260)]({'bots':[]})[_0x47280c(0x341)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x47280c(0x260)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x47280c(0x32d),'onepagemode':![]}})[_0x47280c(0x341)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x47280c(0x260)]({'secure':{},'blacklist':[]})[_0x47280c(0x341)]();let crypt=new Crypt({'md':_0x47280c(0x1fe),'rsaStandard':_0x47280c(0x2a9)});const saltRounds=0xa,mixpanel=Mixpanel[_0x47280c(0x21f)](_0x47280c(0x280),{'host':_0x47280c(0x3c7)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x47280c(0x3ce)]!=''&&settings[_0x47280c(0x263)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x5776d0,_0x4d14c5)=>{const _0x3d56da=_0x47280c,_0xc9ddc6=/#[A-Z]{3}#/g;if(typeof _0x5776d0==_0x3d56da(0x26f)){!_0x4d14c5?_0x5776d0=_0x5776d0[_0x3d56da(0x1f3)](_0xc9ddc6,''):(_0x5776d0=_0x5776d0[_0x3d56da(0x1f3)](/#BLU#/g,_0x3d56da(0x222)),_0x5776d0=_0x5776d0[_0x3d56da(0x1f3)](/#RED#/g,_0x3d56da(0x234)),_0x5776d0=_0x5776d0[_0x3d56da(0x1f3)](/#YEL#/g,_0x3d56da(0x302)),_0x5776d0=_0x5776d0['replace'](/#MAG#/g,'\x1b[35m'),_0x5776d0=_0x5776d0[_0x3d56da(0x1f3)](/#CYA#/g,_0x3d56da(0x30c)),_0x5776d0=_0x5776d0[_0x3d56da(0x1f3)](/#RES#/g,_0x3d56da(0x2ed)));;}return _0x5776d0;},logger={'screen':_0x52c027=>{const _0x4ede9d=_0x47280c;console[_0x4ede9d(0x220)](parseColor(_0x52c027,!![]));},'simple':_0x4b4a3c=>{const _0x27dcf4=_0x47280c;console['log'](parseColor(_0x4b4a3c,!![])),loggerfile[_0x27dcf4(0x341)](util[_0x27dcf4(0x2c2)](parseColor(_0x4b4a3c,![]))+'\x0a');},'full':async _0x3f7479=>{const _0x1037c1=_0x47280c,_0x2c33f2=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x3f7479;console[_0x1037c1(0x220)](parseColor(_0x2c33f2,!![])),loggerfile['write'](util[_0x1037c1(0x2c2)](parseColor(_0x2c33f2,![]))+'\x0a');if(tgBot&&settings[_0x1037c1(0x2d2)]&&settings[_0x1037c1(0x1ef)]!=_0x1037c1(0x283))await tgBot[_0x1037c1(0x24e)](settings[_0x1037c1(0x2d2)],_0x1037c1(0x2db)+parseColor(_0x3f7479,![]))[_0x1037c1(0x22d)](_0x5ada2a=>{telegramError(_0x5ada2a);});},'debug':async(_0x3f214b,_0x2a2357='')=>{const _0x33ca13=_0x47280c,_0x53dd4e=getTimeStamp()+_0x33ca13(0x2ca)+_0x3f214b;if(debugging)console['log'](parseColor(_0x53dd4e,!![]));loggerfile[_0x33ca13(0x341)](util[_0x33ca13(0x2c2)](parseColor(_0x53dd4e,![]))+'\x0a');if(_0x2a2357){if(debugging)console['log'](_0x2a2357);loggerfile[_0x33ca13(0x341)](util[_0x33ca13(0x2c2)](_0x2a2357)+'\x0a');}}};process['on'](_0x47280c(0x39b),function(_0x6e0847){const _0x3fe7ea=_0x47280c;logger[_0x3fe7ea(0x25a)](_0x6e0847);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x47280c(0x34f))[_0x47280c(0x3a7)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x47280c(0x379)](app);function _0x3f24(_0x3068f7,_0x233b18){const _0x4f1413=_0x39ae();return _0x3f24=function(_0x15833c,_0x4d1abd){_0x15833c=_0x15833c-0x1ee;let _0x39ae10=_0x4f1413[_0x15833c];return _0x39ae10;},_0x3f24(_0x3068f7,_0x233b18);}app[_0x47280c(0x338)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x1087eb,_0x5bb91a)=>{const _0x3ab4b5=_0x47280c,_0x291391=_0x1087eb[_0x3ab4b5(0x395)][_0x3ab4b5(0x37d)],_0x373849=getClientsWithBotID(_0x3ab4b5(0x345)),_0x448eda=_0x1087eb[_0x3ab4b5(0x2c6)][_0x3ab4b5(0x38c)],_0x49ae06=timelyDecrypt(_0x448eda,![]),_0x5e61ef=_0x373849[_0x3ab4b5(0x348)](_0x282e90=>_0x282e90['uuid']==_0x49ae06);if(_0x5e61ef){const _0x303975=normalizeIP(_0x1087eb['socket']['remoteAddress'])['store'],_0x684772=_0x1087eb[_0x3ab4b5(0x2c6)]['tkn'];if(validateAccess(_0x684772,_0x49ae06,_0x303975)['allow'])_0x291391=='backup'&&await backupConfigFiles(),await zipFiles(_0x291391),_0x5bb91a[_0x3ab4b5(0x229)](zippath+(_0x291391+_0x3ab4b5(0x398)),_0x2fde66=>{const _0x9e45b4=_0x3ab4b5;_0x2fde66&&(logger['full'](_0x9e45b4(0x22a)+_0x291391),logger['simple'](_0x2fde66));});else logger[_0x3ab4b5(0x33a)](_0x3ab4b5(0x259)+_0x291391+_0x3ab4b5(0x30a));}else logger[_0x3ab4b5(0x33a)](_0x3ab4b5(0x259)+_0x291391+_0x3ab4b5(0x29b));}),app[_0x47280c(0x2fe)](_0x47280c(0x3ad),async(_0x2a5a42,_0x35da01)=>{const _0x44fc29=_0x47280c,_0x143bd6=getClientsWithBotID(_0x44fc29(0x345)),_0x17a8d7=_0x2a5a42[_0x44fc29(0x2c6)][_0x44fc29(0x38c)],_0x388a83=timelyDecrypt(_0x17a8d7,![]),_0xd2fd8b=_0x143bd6[_0x44fc29(0x348)](_0x27ccda=>_0x27ccda[_0x44fc29(0x38c)]==_0x388a83);logger[_0x44fc29(0x254)](_0x44fc29(0x28b));if(_0xd2fd8b){const _0x45bc70=normalizeIP(_0x2a5a42[_0x44fc29(0x388)][_0x44fc29(0x2b4)])['store'],_0x4ad678=_0x2a5a42['headers']['tkn'];if(validateAccess(_0x4ad678,_0x388a83,_0x45bc70)[_0x44fc29(0x2ae)]){if(_0x2a5a42[_0x44fc29(0x313)]){const _0x3fa3c7=_0x2a5a42[_0x44fc29(0x313)][_0x44fc29(0x317)];await _0x3fa3c7['mv'](temppath+_0x3fa3c7[_0x44fc29(0x2a8)]),_0x35da01['send']({'status':!![],'message':_0x44fc29(0x322)});const _0x3ecb07=getBotsWithMode();_0x3ecb07[_0x44fc29(0x203)]>0x0?confirmRestore(temppath,_0x3fa3c7[_0x44fc29(0x2a8)]):unzipFile(temppath,_0x3fa3c7['name']);}}else logger['full'](_0x44fc29(0x3b6));}else logger[_0x44fc29(0x33a)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x47280c(0x338)](express['static'](path[_0x47280c(0x35d)](__dirname,bbpath2,'build2'))),app[_0x47280c(0x338)](express[_0x47280c(0x3c8)](path['join'](__dirname,bbpath2,'build'))),app[_0x47280c(0x2b0)]('/',function(_0x10549c,_0x2483b2){const _0x14a54c=_0x47280c;_0x2483b2[_0x14a54c(0x233)](path[_0x14a54c(0x35d)](__dirname,bbpath2,_0x14a54c(0x3b1),_0x14a54c(0x32e)));}),app[_0x47280c(0x2b0)](_0x47280c(0x2f1),function(_0x5ea546,_0x13364b){const _0x5dcbb4=_0x47280c;_0x13364b[_0x5dcbb4(0x233)](path['join'](__dirname,bbpath2,_0x5dcbb4(0x315),'index.html'));}),app[_0x47280c(0x2b0)]('/:bot/portfolio',(_0x325377,_0x5500f1)=>{const _0x1d45c1=_0x47280c;_0x5500f1[_0x1d45c1(0x233)](path[_0x1d45c1(0x35d)](__dirname,bbpath2,_0x1d45c1(0x315),_0x1d45c1(0x32e)));}),app['get'](_0x47280c(0x2b1),(_0x1583ab,_0x11ed90)=>{const _0x38e104=_0x47280c;_0x11ed90[_0x38e104(0x233)](path[_0x38e104(0x35d)](__dirname,bbpath2,_0x38e104(0x315),_0x38e104(0x32e)));}),app[_0x47280c(0x2b0)]('/:bot/coins',(_0x554e4d,_0x20a7c7)=>{const _0x51578a=_0x47280c;_0x20a7c7[_0x51578a(0x233)](path['join'](__dirname,bbpath2,_0x51578a(0x315),_0x51578a(0x32e)));}),app[_0x47280c(0x2b0)](_0x47280c(0x20f),(_0x1239b3,_0x2677cd)=>{const _0x450a0a=_0x47280c;_0x2677cd[_0x450a0a(0x233)](path[_0x450a0a(0x35d)](__dirname,bbpath2,_0x450a0a(0x315),_0x450a0a(0x32e)));}),app[_0x47280c(0x2b0)](_0x47280c(0x215),(_0x574157,_0x354c20)=>{const _0x2a5938=_0x47280c;_0x354c20[_0x2a5938(0x233)](path[_0x2a5938(0x35d)](__dirname,bbpath2,_0x2a5938(0x315),_0x2a5938(0x32e)));}),app['get'](_0x47280c(0x2bd),(_0x3b0733,_0x2a41e7)=>{const _0x324e79=_0x47280c;_0x2a41e7[_0x324e79(0x233)](path[_0x324e79(0x35d)](__dirname,bbpath2,_0x324e79(0x315),_0x324e79(0x32e)));});if(HOST)http[_0x47280c(0x2e7)](PORT,HOST);else http[_0x47280c(0x2e7)](PORT);const io=require(_0x47280c(0x28c))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x57e256=_0x47280c;let _0x364026=_0x57e256(0x324);const _0xe0a654=networkInterfaces(),_0x3f1541={};for(const _0x2ff592 of Object[_0x57e256(0x29a)](_0xe0a654)){for(const _0x39a121 of _0xe0a654[_0x2ff592]){if((_0x39a121[_0x57e256(0x340)]==_0x57e256(0x39e)||_0x39a121[_0x57e256(0x340)]==0x4)&&!_0x39a121[_0x57e256(0x34b)]){const _0x3e68d1=ipaddr[_0x57e256(0x2eb)](_0x39a121[_0x57e256(0x3a9)])[_0x57e256(0x353)]();_0x3e68d1!='private'&&(!_0x3f1541[_0x2ff592]&&(_0x3f1541[_0x2ff592]=[]),_0x3f1541[_0x2ff592][_0x57e256(0x34a)](_0x39a121['address']),_0x364026=_0x39a121[_0x57e256(0x3a9)]);}}}return{'serverip':_0x364026,'netinterfaces':_0x3f1541};}async function startServer(){const _0x22f9b7=_0x47280c,{serverip:_0x2e9ec2,netinterfaces:_0x1cd705}=getServerIP();logger[_0x22f9b7(0x25a)](''),logger[_0x22f9b7(0x25a)](_0x22f9b7(0x30f)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x22f9b7(0x2ba)?_0x22f9b7(0x366):'')+'\x0a'+(_0x22f9b7(0x2c3)+PORT+_0x22f9b7(0x31b))+(_0x22f9b7(0x2dd)+_0x2e9ec2+':'+PORT+_0x22f9b7(0x34e))),logger[_0x22f9b7(0x25a)](_0x22f9b7(0x30f));if(config[_0x22f9b7(0x203)]!=0x0)for(const _0x3c484e of config){if(_0x3c484e['status']==_0x22f9b7(0x2a3)||_0x3c484e[_0x22f9b7(0x216)]==_0x22f9b7(0x1f4))await logger[_0x22f9b7(0x33a)]('Starting\x20bot\x20|\x20Bot\x20'+_0x3c484e[_0x22f9b7(0x300)]+'\x20|\x20'+_0x3c484e[_0x22f9b7(0x3aa)]),startBot([_0x3c484e[_0x22f9b7(0x300)],userID],{'cwd':bbpath},function(_0x28de3a){if(_0x28de3a)logger['full'](_0x28de3a);});else(_0x3c484e[_0x22f9b7(0x216)]=='disabled'||_0x3c484e['status']==_0x22f9b7(0x27a))&&await logger[_0x22f9b7(0x33a)](_0x22f9b7(0x3b9)+_0x3c484e[_0x22f9b7(0x300)]+_0x22f9b7(0x327)+_0x3c484e['botname']);}else!newBot&&logger[_0x22f9b7(0x25a)](_0x22f9b7(0x393));if(newBot)addBot();logger[_0x22f9b7(0x25a)](_0x22f9b7(0x30f)),logger[_0x22f9b7(0x25a)](''),await logger[_0x22f9b7(0x254)](_0x22f9b7(0x3ae)+nodeversion),await logger[_0x22f9b7(0x254)](_0x22f9b7(0x261),_0x1cd705);}function startSocket(){const _0x258482=_0x47280c;io['on'](_0x258482(0x32c),_0x417ee5=>{const _0x2c88f8=_0x258482;let _0x30945a,_0x168d45,_0x30c8fc,_0x48ec1d,_0x3b0666;const _0x3298aa=_0x417ee5[_0x2c88f8(0x30b)][_0x2c88f8(0x2c6)]['referer'];_0x168d45=_0x3298aa[_0x2c88f8(0x270)](/bot[0-9]{3}/);if(_0x168d45)_0x30c8fc=_0x168d45[0x0][_0x2c88f8(0x270)](/[0-9]{3}/);if(_0x30c8fc)_0x30945a=_0x30c8fc[0x0];else _0x30945a=_0x2c88f8(0x345);const _0x2c31d5=_0x417ee5[_0x2c88f8(0x30b)][_0x2c88f8(0x38d)][_0x2c88f8(0x28f)];if(!_0x2c31d5)_0x417ee5['emit']('status',{'publicKey':secure['publicKey']});else{_0x48ec1d=timelyDecrypt(_0x2c31d5,![]);if(!_0x48ec1d)_0x417ee5[_0x2c88f8(0x331)](_0x2c88f8(0x216),{'publicKey':secure[_0x2c88f8(0x1f1)]});else{_0x3b0666=normalizeIP(_0x417ee5[_0x2c88f8(0x289)][_0x2c88f8(0x2b4)])[_0x2c88f8(0x303)];if(!devices[_0x48ec1d])devices[_0x48ec1d]={'uuid':_0x48ec1d,'access':{'token':null}};devices[_0x48ec1d]['ip']=_0x3b0666;const _0x5cd408=addClient(_0x417ee5['id'],_0x48ec1d,_0x30945a);setAccess(_0x5cd408),emitMessages(),_0x417ee5['on']('login',_0x43a805=>{const _0x1d97d6=_0x2c88f8,_0x3e80ba=timelyDecrypt(_0x43a805['password']);if(_0x3e80ba){_0x43a805={'username':_0x43a805[_0x1d97d6(0x22e)],'password':_0x3e80ba},devices[_0x48ec1d][_0x1d97d6(0x31c)]=validateCredentials(_0x43a805,_0x48ec1d);if(devices[_0x48ec1d][_0x1d97d6(0x31c)][_0x1d97d6(0x2ae)]==![]&&devices[_0x48ec1d][_0x1d97d6(0x31c)][_0x1d97d6(0x207)]=='2FA\x20login\x20required')_0x417ee5[_0x1d97d6(0x331)](_0x1d97d6(0x216),{'access':devices[_0x48ec1d][_0x1d97d6(0x31c)]}),loginAccess2FA(_0x48ec1d,_0x3b0666);else{if(devices[_0x48ec1d]['access']['allow']==![]&&devices[_0x48ec1d][_0x1d97d6(0x31c)][_0x1d97d6(0x207)]=='invalid\x20credentials')_0x417ee5[_0x1d97d6(0x331)](_0x1d97d6(0x216),{'access':devices[_0x48ec1d][_0x1d97d6(0x31c)]});else devices[_0x48ec1d]['access']['allow']&&devices[_0x48ec1d][_0x1d97d6(0x31c)][_0x1d97d6(0x207)]==_0x1d97d6(0x37c)&&(getClientsWithUuid(_0x48ec1d)['forEach'](_0x4a58b9=>{setAccess(_0x4a58b9);}),logger[_0x1d97d6(0x254)](_0x1d97d6(0x37f)+_0x48ec1d[_0x1d97d6(0x26e)](-0x8)),setTokenRefresh(_0x48ec1d),setSessionTimeout(_0x1d97d6(0x3be),_0x48ec1d));}}else logger['full'](_0x1d97d6(0x368));}),_0x417ee5['on'](_0x2c88f8(0x225),()=>{resetPassword();}),_0x417ee5['on'](_0x2c88f8(0x2ac),_0x55b655=>{removeClient(_0x417ee5['id']);}),_0x30945a==_0x2c88f8(0x345)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5146a1){const _0x175906=_0x47280c;if(_0x5146a1!=_0x175906(0x345)&&config[_0x175906(0x3cb)]!=''){if(pid[_0x5146a1])pid[_0x5146a1][_0x175906(0x352)]({'function':_0x175906(0x3bd),'args':null});}_0x5146a1!=_0x175906(0x345)&&broadcastToBots(_0x175906(0x228),JSON[_0x175906(0x277)](config));}function reloadBotManager(){const _0x22ed7a=_0x47280c;getClientsWithBotID(_0x22ed7a(0x345))[_0x22ed7a(0x2fa)](_0x4ea8ea=>{const _0x1e0223=_0x22ed7a;getSocket(_0x4ea8ea['id'])[_0x1e0223(0x331)](_0x1e0223(0x216),{'access':{'allow':![],'reason':_0x1e0223(0x35f),'token':null}});});}function getSocket(_0x3f1f3e){const _0x3e37bb=_0x47280c;return io[_0x3e37bb(0x3cf)][_0x3e37bb(0x3cf)]['get'](_0x3f1f3e);}function setAccess(_0x2e094d){const _0xd92bfc=_0x47280c,_0x59ee6c=getSocket(_0x2e094d['id']),_0x3fa29f=_0x2e094d[_0xd92bfc(0x38c)],_0xab0fc7=_0x2e094d[_0xd92bfc(0x206)];devices[_0x3fa29f][_0xd92bfc(0x31c)]=validateAccess(devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x32a)],_0x3fa29f),logger[_0xd92bfc(0x254)](_0xd92bfc(0x355)+devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x207)]+_0xd92bfc(0x292)+_0x2e094d['id'][_0xd92bfc(0x26e)](-0x8)+'\x20|\x20user:\x20...'+_0x3fa29f[_0xd92bfc(0x26e)](-0x8)),_0x59ee6c[_0xd92bfc(0x35d)](_0x3fa29f);if(devices[_0x3fa29f][_0xd92bfc(0x31c)]['allow']){_0x59ee6c['join'](_0xab0fc7);if(_0xab0fc7==_0xd92bfc(0x345))initializeSocketBotManager(_0x59ee6c);else initializeSocketBot(_0x59ee6c);initClient(_0xab0fc7);}devices[_0x3fa29f]['access']['token']&&devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x207)]==_0xd92bfc(0x2f2)&&setSessionTimeout(_0xd92bfc(0x238),_0x3fa29f),devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x32a)]&&devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x207)]==_0xd92bfc(0x1f7)&&setSessionTimeout(_0xd92bfc(0x3be),_0x3fa29f),_0x59ee6c['emit'](_0xd92bfc(0x216),{'status':_0x2e094d[_0xd92bfc(0x2d8)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3fa29f][_0xd92bfc(0x31c)],'externalip':devices[_0x3fa29f]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x2ae)]==![]&&devices[_0x3fa29f][_0xd92bfc(0x31c)][_0xd92bfc(0x207)]==_0xd92bfc(0x20a)&&temporaryAccess2FA(_0x3fa29f,devices[_0x3fa29f]['ip']);}function setSessionTimeout(_0x530dbd,_0x340e2a){const _0x5c6217=_0x47280c;let _0x59c88c;if(_0x530dbd==_0x5c6217(0x3be))_0x59c88c=loginExpiry*0x3c*0x3e8;else _0x59c88c=devices[_0x340e2a][_0x5c6217(0x38f)][_0x5c6217(0x28e)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x340e2a][_0x5c6217(0x38f)][_0x5c6217(0x39f)]);if(devices[_0x340e2a][_0x5c6217(0x2e4)])clearTimeout(devices[_0x340e2a]['pidExpireLogin']);devices[_0x340e2a][_0x5c6217(0x2e4)]=setTimeout(()=>{const _0x53737f=_0x5c6217;if(devices[_0x340e2a][_0x53737f(0x308)])clearTimeout(devices[_0x340e2a][_0x53737f(0x308)]);removeSocketListeners(_0x340e2a),addBlacklist(_0x340e2a),devices[_0x340e2a][_0x53737f(0x38f)]=null,devices[_0x340e2a][_0x53737f(0x2b9)]=null,devices[_0x340e2a][_0x53737f(0x31c)][_0x53737f(0x32a)]=null,logger[_0x53737f(0x254)]('Session\x20expired\x20for\x20user\x20...'+_0x340e2a[_0x53737f(0x26e)](-0x8)),devices[_0x340e2a]['access']=validateAccess(devices[_0x340e2a][_0x53737f(0x31c)]['token'],_0x340e2a),!(devices[_0x340e2a][_0x53737f(0x31c)]['allow']&&devices[_0x340e2a][_0x53737f(0x31c)]['reason']==_0x53737f(0x356))&&(_0x530dbd==_0x53737f(0x3be)?io['to'](_0x340e2a)[_0x53737f(0x331)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x340e2a)['emit'](_0x53737f(0x216),{'access':{'allow':![],'reason':_0x53737f(0x350),'token':null}})),devices[_0x340e2a][_0x53737f(0x31c)]['token']=null;},_0x59c88c);}function setTokenRefresh(_0xca06d4){const _0x21b370=_0x47280c;if(devices[_0xca06d4][_0x21b370(0x308)])clearTimeout(devices[_0xca06d4]['pidRefreshToken']);devices[_0xca06d4][_0x21b370(0x308)]=setTimeout(()=>{const _0x5b82b8=_0x21b370;getClientsWithUuid(_0xca06d4)[_0x5b82b8(0x203)]!=0x0?(devices[_0xca06d4]['access']=refreshToken(_0xca06d4),io['to'](_0xca06d4)['emit'](_0x5b82b8(0x216),{'status':_0x5b82b8(0x349),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xca06d4][_0x5b82b8(0x31c)],'externalip':devices[_0xca06d4]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0xca06d4)):clearTimeout(devices[_0xca06d4][_0x5b82b8(0x308)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x59a2ab){const _0x1e2b67=_0x47280c,_0x15f29f=getClient(_0x59a2ab['id'])[_0x1e2b67(0x38c)];_0x59a2ab[_0x1e2b67(0x331)](_0x1e2b67(0x228),config),_0x59a2ab[_0x1e2b67(0x331)](_0x1e2b67(0x250),cleanSettings()),_0x59a2ab['on'](_0x1e2b67(0x2f3),_0x4250a5=>{const _0x5d558e=_0x1e2b67;if(validateAccess(_0x4250a5,_0x15f29f)[_0x5d558e(0x2ae)])addBot();else logger['full'](_0x5d558e(0x3ab));}),_0x59a2ab['on'](_0x1e2b67(0x21a),(_0x4e6930,_0x38dbee)=>{const _0x2c6fe5=_0x1e2b67;if(validateAccess(_0x38dbee,_0x15f29f)[_0x2c6fe5(0x2ae)])toggleBot(_0x4e6930['botID'],_0x4e6930[_0x2c6fe5(0x216)],_0x4e6930[_0x2c6fe5(0x2d3)]);else logger[_0x2c6fe5(0x33a)](_0x2c6fe5(0x1f6));}),_0x59a2ab['on'](_0x1e2b67(0x242),(_0x4b5bf0,_0x3eb017)=>{const _0x3aeafd=_0x1e2b67;if(validateAccess(_0x3eb017,_0x15f29f)['allow'])toggleBotMode(_0x4b5bf0);else logger[_0x3aeafd(0x33a)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x59a2ab['on'](_0x1e2b67(0x201),(_0x32ea98,_0x3c5b16)=>{const _0x3f68ed=_0x1e2b67;if(validateAccess(_0x3c5b16,_0x15f29f)[_0x3f68ed(0x2ae)])deleteBot(_0x32ea98);else logger[_0x3f68ed(0x33a)](_0x3f68ed(0x3ba));}),_0x59a2ab['on']('store-settings',(_0x4c1c10,_0x451911)=>{const _0x3cf042=_0x1e2b67;if(validateAccess(_0x451911,_0x15f29f)['allow'])storeSettings(_0x4c1c10,!![]);else logger[_0x3cf042(0x33a)](_0x3cf042(0x399));}),_0x59a2ab['on'](_0x1e2b67(0x247),_0x325d41=>{const _0x18d9a5=_0x1e2b67;if(validateAccess(_0x325d41,_0x15f29f)[_0x18d9a5(0x2ae)])updateBB(_0x18d9a5(0x396));else logger[_0x18d9a5(0x33a)](_0x18d9a5(0x2bb));}),_0x59a2ab['on'](_0x1e2b67(0x33d),_0x4408c5=>{const _0x1c088b=_0x1e2b67;if(validateAccess(_0x4408c5,_0x15f29f)['allow'])updateBB(_0x1c088b(0x3b4));else logger[_0x1c088b(0x33a)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x59a2ab['on'](_0x1e2b67(0x2e5),_0x55ed8a=>{const _0x486b39=_0x1e2b67;if(validateAccess(_0x55ed8a,_0x15f29f)[_0x486b39(0x2ae)]){const _0x5094b3=getClient(_0x59a2ab['id']);if(_0x5094b3)getBackupFiles(_0x5094b3[_0x486b39(0x38c)]);else logger['full'](_0x486b39(0x278));}else logger[_0x486b39(0x33a)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x59a2ab['on']('restore-backup-file',(_0x21067e,_0x30972a)=>{const _0x277e16=_0x1e2b67;if(validateAccess(_0x30972a,_0x15f29f)[_0x277e16(0x2ae)])restoreBackupFile(_0x21067e);else logger[_0x277e16(0x33a)](_0x277e16(0x1f5));}),_0x59a2ab['on'](_0x1e2b67(0x219),_0xe99332=>{const _0x56745b=_0x1e2b67;if(validateAccess(_0xe99332,_0x15f29f)['allow'])getMessages();else logger[_0x56745b(0x33a)](_0x56745b(0x2e0));}),_0x59a2ab['on'](_0x1e2b67(0x310),(_0x3bcd8f,_0x304526)=>{const _0x5d90e8=_0x1e2b67;if(validateAccess(_0x304526,_0x15f29f)['allow'])confirmMessage(_0x3bcd8f);else logger[_0x5d90e8(0x33a)](_0x5d90e8(0x39d));}),_0x59a2ab['on'](_0x1e2b67(0x266),_0x595fe5=>{const _0x110fd6=_0x1e2b67;if(validateAccess(_0x595fe5,_0x15f29f)[_0x110fd6(0x2ae)]){if(devices[_0x15f29f][_0x110fd6(0x308)])clearTimeout(devices[_0x15f29f][_0x110fd6(0x308)]);if(devices[_0x15f29f][_0x110fd6(0x2e4)])clearTimeout(devices[_0x15f29f][_0x110fd6(0x2e4)]);removeSocketListeners(getClient(_0x59a2ab['id'])[_0x110fd6(0x38c)]),addBlacklist(_0x15f29f),devices[_0x15f29f][_0x110fd6(0x38f)]=null,devices[_0x15f29f][_0x110fd6(0x2b9)]=null,devices[_0x15f29f][_0x110fd6(0x31c)][_0x110fd6(0x32a)]=null,logger[_0x110fd6(0x254)](_0x110fd6(0x33b)+_0x15f29f[_0x110fd6(0x26e)](-0x8)),io['to'](getClient(_0x59a2ab['id'])[_0x110fd6(0x38c)])[_0x110fd6(0x331)](_0x110fd6(0x216),{'access':{'allow':![],'reason':_0x110fd6(0x28a),'token':null}});}else logger[_0x110fd6(0x33a)](_0x110fd6(0x3ca));});}function initializeSocketBot(_0x2a4207){const _0x3203fa=_0x47280c,_0x55d8bd=getClient(_0x2a4207['id'])[_0x3203fa(0x206)],_0x3e5430=getClient(_0x2a4207['id'])[_0x3203fa(0x38c)];_0x2a4207['on'](_0x3203fa(0x312),(_0x406da1,_0x37e063)=>{const _0x2869cd=_0x3203fa;if(validateAccess(_0x37e063,_0x3e5430)[_0x2869cd(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x2869cd(0x352)]({'function':_0x2869cd(0x23a),'args':_0x406da1});}else logger['full'](_0x2869cd(0x36c));}),_0x2a4207['on'](_0x3203fa(0x2b8),(_0x53fb16,_0x5ea71a)=>{const _0x1a7777=_0x3203fa;if(validateAccess(_0x5ea71a,_0x3e5430)[_0x1a7777(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x1a7777(0x352)]({'function':_0x1a7777(0x268),'args':_0x53fb16});}else logger['full'](_0x1a7777(0x1ff));}),_0x2a4207['on'](_0x3203fa(0x244),(_0x59460e,_0x14e0c9)=>{const _0x41c337=_0x3203fa;if(validateAccess(_0x14e0c9,_0x3e5430)[_0x41c337(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd]['send']({'function':_0x41c337(0x314),'args':_0x59460e});}else logger[_0x41c337(0x33a)](_0x41c337(0x2d5));}),_0x2a4207['on'](_0x3203fa(0x3b3),(_0x3b006d,_0x4d3d0b)=>{const _0x23b5f1=_0x3203fa;if(validateAccess(_0x4d3d0b,_0x3e5430)[_0x23b5f1(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x23b5f1(0x352)]({'function':_0x23b5f1(0x2e2),'args':_0x3b006d});}else logger[_0x23b5f1(0x33a)](_0x23b5f1(0x33f));}),_0x2a4207['on'](_0x3203fa(0x2fd),(_0x4d97ef,_0x2abebc)=>{const _0x15f8d9=_0x3203fa;if(validateAccess(_0x2abebc,_0x3e5430)[_0x15f8d9(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x15f8d9(0x352)]({'function':_0x15f8d9(0x24d),'args':_0x4d97ef});}else logger[_0x15f8d9(0x33a)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x2a4207['on']('store-fiat',(_0x25ab24,_0x3866ec)=>{const _0x364c47=_0x3203fa;if(validateAccess(_0x3866ec,_0x3e5430)[_0x364c47(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd]['send']({'function':_0x364c47(0x344),'args':_0x25ab24});}else logger[_0x364c47(0x33a)](_0x364c47(0x248));}),_0x2a4207['on'](_0x3203fa(0x38e),_0x394a0c=>{const _0x104d85=_0x3203fa;if(validateAccess(_0x394a0c,_0x3e5430)[_0x104d85(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x104d85(0x352)]({'function':_0x104d85(0x256),'args':null});}else logger[_0x104d85(0x33a)](_0x104d85(0x2c9));}),_0x2a4207['on'](_0x3203fa(0x2e8),_0x4aa16e=>{const _0x139077=_0x3203fa;if(validateAccess(_0x4aa16e,_0x3e5430)[_0x139077(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x139077(0x352)]({'function':_0x139077(0x2ec),'args':null});}else logger[_0x139077(0x33a)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2a4207['on'](_0x3203fa(0x32b),(_0xfc1ba6,_0x4e15ae)=>{const _0x1e03c1=_0x3203fa;if(validateAccess(_0x4e15ae,_0x3e5430)[_0x1e03c1(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd]['send']({'function':'placeOrder','args':_0xfc1ba6});}else logger[_0x1e03c1(0x33a)](_0x1e03c1(0x377));}),_0x2a4207['on']('cancel-loading',_0x55105c=>{const _0x37886b=_0x3203fa;if(validateAccess(_0x55105c,_0x3e5430)[_0x37886b(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x37886b(0x352)]({'function':_0x37886b(0x2c8),'args':null});}else logger['full'](_0x37886b(0x38a));}),_0x2a4207['on']('show-config',_0x569bfd=>{const _0x24ab4f=_0x3203fa;if(validateAccess(_0x569bfd,_0x3e5430)[_0x24ab4f(0x2ae)]){if(pid[_0x55d8bd])pid[_0x55d8bd][_0x24ab4f(0x352)]({'function':_0x24ab4f(0x376),'args':null});}else logger[_0x24ab4f(0x33a)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2a4207['on'](_0x3203fa(0x247),_0x3aad5c=>{const _0x2e378c=_0x3203fa;if(validateAccess(_0x3aad5c,_0x3e5430)['allow'])updateBB(_0x2e378c(0x396));else logger[_0x2e378c(0x33a)](_0x2e378c(0x2bb));}),_0x2a4207['on'](_0x3203fa(0x219),_0x386cf3=>{const _0x1842aa=_0x3203fa;if(validateAccess(_0x386cf3,_0x3e5430)[_0x1842aa(0x2ae)])getMessages();else logger['full'](_0x1842aa(0x2e0));}),_0x2a4207['on']('confirm-message',(_0x37619b,_0xf67ee2)=>{const _0xea056b=_0x3203fa;if(validateAccess(_0xf67ee2,_0x3e5430)[_0xea056b(0x2ae)])confirmMessage(_0x37619b);else logger[_0xea056b(0x33a)](_0xea056b(0x39d));}),_0x2a4207['on'](_0x3203fa(0x266),_0x1bea3f=>{const _0x4ff3eb=_0x3203fa;if(validateAccess(_0x1bea3f,_0x3e5430)[_0x4ff3eb(0x2ae)]){if(devices[_0x3e5430][_0x4ff3eb(0x308)])clearTimeout(devices[_0x3e5430][_0x4ff3eb(0x308)]);if(devices[_0x3e5430]['pidExpireLogin'])clearTimeout(devices[_0x3e5430][_0x4ff3eb(0x2e4)]);removeSocketListeners(getClient(_0x2a4207['id'])[_0x4ff3eb(0x38c)]),addBlacklist(_0x3e5430),devices[_0x3e5430][_0x4ff3eb(0x38f)]=null,devices[_0x3e5430][_0x4ff3eb(0x2b9)]=null,devices[_0x3e5430][_0x4ff3eb(0x31c)][_0x4ff3eb(0x32a)]=null,logger[_0x4ff3eb(0x254)]('Logged\x20out\x20user\x20...'+_0x3e5430['slice'](-0x8)),io['to'](getClient(_0x2a4207['id'])[_0x4ff3eb(0x38c)])[_0x4ff3eb(0x331)](_0x4ff3eb(0x216),{'access':{'allow':![],'reason':_0x4ff3eb(0x28a),'token':null}});}else logger['full'](_0x4ff3eb(0x3ca));});}function removeSocketListeners(_0x557112){getClientsWithUuid(_0x557112)['forEach'](_0x1b41d7=>{const _0x35ab43=_0x3f24;getSocket(_0x1b41d7['id'])[_0x35ab43(0x241)]();});}function cleanSettings(){const _0x3aae2d=_0x47280c;let _0x3efd98=settings;return settings[_0x3aae2d(0x3ce)]&&settings['telegramToken']!=''&&(_0x3efd98={..._0x3efd98,'telegramToken':_0x3aae2d(0x281)}),settings[_0x3aae2d(0x211)]&&settings[_0x3aae2d(0x211)]!=''&&(_0x3efd98={..._0x3efd98,'bbPassword':_0x3aae2d(0x281)}),(settings[_0x3aae2d(0x211)]&&settings[_0x3aae2d(0x211)]==_0x3aae2d(0x329)||settings[_0x3aae2d(0x3ce)]&&settings['telegramToken']==_0x3aae2d(0x329))&&(_0x3efd98={..._0x3efd98,'restored':{'password':settings[_0x3aae2d(0x211)]==_0x3aae2d(0x329),'telegram':settings[_0x3aae2d(0x3ce)]==_0x3aae2d(0x329)}}),_0x3efd98;}async function updateBB(_0x47afe2){const _0x2e5c21=_0x47280c;await backupConfigFiles(),installingUpdate=!![],config[_0x2e5c21(0x2fa)](_0x1fb8fa=>{const _0xd58d41=_0x2e5c21;restartBot(_0x1fb8fa[_0xd58d41(0x300)]);});if(_0x47afe2=='update')process[_0x2e5c21(0x352)]({'update':!![],'environment':environment},_0x1272d2=>{});else _0x47afe2==_0x2e5c21(0x3b4)&&process['send']({'reinstall':!![],'environment':environment},_0x5099d4=>{});}function startBot(_0x5cdefe,_0x1a5ce5,_0x5d7118){const _0x240b81=_0x47280c;if(debugging)_0x5cdefe[_0x240b81(0x34a)]('-d');let _0x17b0aa=![];const _0x54af3d=_0x5cdefe[0x0];_0x1a5ce5={..._0x1a5ce5,'stdio':['inherit',_0x240b81(0x243),_0x240b81(0x243),_0x240b81(0x26a)]},pid[_0x54af3d]=childProcess[_0x240b81(0x1ee)](botfile,_0x5cdefe,_0x1a5ce5),pid[_0x54af3d]['on'](_0x240b81(0x2c4),_0x293920=>{const _0xea1ec5=_0x240b81;switch(Object[_0xea1ec5(0x29a)](_0x293920)[0x0]){case'botname':updateBotName(_0x54af3d,_0x293920[_0xea1ec5(0x3aa)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x54af3d,_0x293920[_0xea1ec5(0x216)]);break;case _0xea1ec5(0x2d3):updateLive(_0x54af3d,_0x293920['live']);break;case _0xea1ec5(0x2c5):updateLive(_0x54af3d,_0x293920[_0xea1ec5(0x2c5)]),io['to'](_0x54af3d)['emit'](_0xea1ec5(0x216),{'access':{'allow':![],'reason':_0xea1ec5(0x35f),'token':null}});break;case _0xea1ec5(0x253):_0x293920[_0xea1ec5(0x253)]==_0xea1ec5(0x33e)&&restartBot(_0x54af3d);_0x293920[_0xea1ec5(0x253)]=='kill'&&toggleBot(_0x54af3d,_0xea1ec5(0x37e),_0xea1ec5(0x223));break;case _0xea1ec5(0x364):sendTelegram(_0x54af3d,_0x293920['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x293920[_0xea1ec5(0x391)]);break;case _0xea1ec5(0x31d):io['to'](_0x54af3d)[_0xea1ec5(0x331)](_0x293920[_0xea1ec5(0x31d)],_0x293920[_0xea1ec5(0x246)]);break;}}),pid[_0x54af3d]['on'](_0x240b81(0x25c),function(_0xfcf659){if(_0x17b0aa)return;_0x17b0aa=!![],_0x5d7118(_0xfcf659);}),pid[_0x54af3d]['on'](_0x240b81(0x3b5),async function(_0x55dc10){const _0x4765cb=_0x240b81;if(installingUpdate)return;if(_0x17b0aa)return;_0x17b0aa=!![],_0x5d7118(null);const _0x50f13d=dbConfig[_0x4765cb(0x2b0)](_0x4765cb(0x228))[_0x4765cb(0x348)]({'botID':_0x54af3d})['value']();_0x50f13d&&(_0x50f13d['status']==_0x4765cb(0x2a3)||_0x50f13d[_0x4765cb(0x216)]=='new')&&(await sleep(0x3e8),updateLive(_0x54af3d,_0x4765cb(0x223)),logger[_0x4765cb(0x33a)]('Restarting\x20Bot\x20'+_0x54af3d),startBot([_0x54af3d,userID],{'cwd':bbpath},function(_0x1a63d8){const _0x5a11b5=_0x4765cb;if(_0x1a63d8)logger[_0x5a11b5(0x33a)](_0x1a63d8);}));});}function stopBot(_0x259a48){const _0x591d6e=_0x47280c;getClientsWithBotID(_0x259a48)['forEach'](_0x5bf22f=>{const _0x37ef76=_0x3f24;getSocket(_0x5bf22f['id'])[_0x37ef76(0x2ac)](!![]),removeClient(_0x5bf22f['id']);}),pid[_0x259a48]&&(pid[_0x259a48][_0x591d6e(0x1f8)](),pid[_0x259a48]=null);}function restartBot(_0x1eda29){const _0x10af3b=_0x47280c;if(pid[_0x1eda29])pid[_0x1eda29][_0x10af3b(0x1f8)]();}function addBot(){const _0x1b8768=_0x47280c;let _0xfb201a;for(let _0x3700ca=0x1;_0x3700ca<0x3e9;_0x3700ca++){_0xfb201a=_0x3700ca[_0x1b8768(0x2c7)]()[_0x1b8768(0x360)](0x3,'0');let _0x3c2ee4=config[_0x1b8768(0x348)](_0x1d9d51=>_0x1d9d51[_0x1b8768(0x300)]==_0xfb201a);if(!_0x3c2ee4)break;}if(_0xfb201a===_0x1b8768(0x354)){logger['full'](_0x1b8768(0x23b));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0xfb201a),dbConfig[_0x1b8768(0x2b0)]('bots')[_0x1b8768(0x34a)]({'botID':_0xfb201a,'botname':_0x1b8768(0x275)+_0xfb201a,'status':_0x1b8768(0x1f4),'live':''})[_0x1b8768(0x341)](),startBot([_0xfb201a,userID],{'cwd':bbpath},function(_0x559297){const _0x414922=_0x1b8768;if(_0x559297)logger[_0x414922(0x33a)](_0x559297);}),config=getConfiguration(),io['to']('botmanager')[_0x1b8768(0x331)]('bots',config),broadcastToBots('bots',JSON[_0x1b8768(0x277)](config));}function deleteBot(_0x14b845){const _0x2ab884=_0x47280c;getClientsWithBotID(_0x14b845)[_0x2ab884(0x2fa)](_0x1b508a=>{const _0x83cd1c=_0x2ab884;getSocket(_0x1b508a['id'])[_0x83cd1c(0x2ac)](!![]),removeClient(_0x1b508a['id']);}),dbConfig[_0x2ab884(0x2b0)](_0x2ab884(0x228))['remove']({'botID':_0x14b845})[_0x2ab884(0x341)](),logger[_0x2ab884(0x33a)](_0x2ab884(0x2cc)+_0x14b845),stopBot(_0x14b845);try{if(fs['existsSync'](path[_0x2ab884(0x35d)](configpath,'bot-'+_0x14b845+_0x2ab884(0x2e9))))fs[_0x2ab884(0x382)](path[_0x2ab884(0x35d)](configpath,_0x2ab884(0x2c0)+_0x14b845+_0x2ab884(0x2e9)));if(fs[_0x2ab884(0x2ab)](path[_0x2ab884(0x35d)](configpath,_0x2ab884(0x2c0)+_0x14b845+_0x2ab884(0x29d))))fs[_0x2ab884(0x382)](path[_0x2ab884(0x35d)](configpath,_0x2ab884(0x2c0)+_0x14b845+_0x2ab884(0x29d)));if(fs[_0x2ab884(0x2ab)](path[_0x2ab884(0x35d)](configpath,_0x2ab884(0x2c0)+_0x14b845+_0x2ab884(0x351))))fs[_0x2ab884(0x382)](path[_0x2ab884(0x35d)](configpath,_0x2ab884(0x2c0)+_0x14b845+_0x2ab884(0x351)));if(fs['existsSync'](path[_0x2ab884(0x35d)](configpath,_0x2ab884(0x2c0)+_0x14b845+_0x2ab884(0x35b))))fs[_0x2ab884(0x382)](path[_0x2ab884(0x35d)](configpath,'bot-'+_0x14b845+'-results.json'));}catch(_0x30cb07){if(_0x30cb07)logger['full'](_0x2ab884(0x232),_0x30cb07);}config=getConfiguration(),io['to'](_0x2ab884(0x345))[_0x2ab884(0x331)](_0x2ab884(0x228),config),broadcastToBots(_0x2ab884(0x228),JSON[_0x2ab884(0x277)](config));}function toggleBot(_0x1961bd,_0x366873,_0x199050){const _0x13d1ed=_0x47280c;dbConfig[_0x13d1ed(0x2b0)](_0x13d1ed(0x228))[_0x13d1ed(0x348)]({'botID':_0x1961bd})[_0x13d1ed(0x24f)]({'status':_0x366873})['assign']({'live':_0x199050})[_0x13d1ed(0x341)]();if(_0x366873==_0x13d1ed(0x2a3)||_0x366873==_0x13d1ed(0x1f4))logger[_0x13d1ed(0x33a)](_0x13d1ed(0x328)+_0x1961bd),startBot([_0x1961bd,userID],{'cwd':bbpath},function(_0x38a15b){const _0x54b9e9=_0x13d1ed;if(_0x38a15b)logger[_0x54b9e9(0x33a)](_0x38a15b);});else(_0x366873==_0x13d1ed(0x37e)||_0x366873==_0x13d1ed(0x27a))&&(logger[_0x13d1ed(0x33a)](_0x13d1ed(0x251)+_0x1961bd),stopBot(_0x1961bd));config=getConfiguration(),io['to'](_0x13d1ed(0x345))['emit'](_0x13d1ed(0x228),config),broadcastToBots(_0x13d1ed(0x228),JSON['stringify'](config));}function toggleStatus(_0x1a7e51){const _0x40f120=_0x47280c;let _0x1704dc=dbConfig['get'](_0x40f120(0x228))[_0x40f120(0x348)]({'botID':_0x1a7e51})[_0x40f120(0x304)](),_0x13b9aa;if(_0x1704dc[_0x40f120(0x216)]==='enabled')_0x13b9aa=_0x40f120(0x37e);else{if(_0x1704dc[_0x40f120(0x216)]===_0x40f120(0x1f4))_0x13b9aa=_0x40f120(0x27a);else{if(_0x1704dc[_0x40f120(0x216)]==='new-disabled')_0x13b9aa=_0x40f120(0x1f4);else{if(_0x1704dc[_0x40f120(0x216)]===_0x40f120(0x37e))_0x13b9aa='enabled';}}}return _0x13b9aa;}function updateStatus(_0x485a5b,_0x3b96c0){const _0x1b93f2=_0x47280c;dbConfig[_0x1b93f2(0x2b0)](_0x1b93f2(0x228))[_0x1b93f2(0x348)]({'botID':_0x485a5b})[_0x1b93f2(0x24f)]({'status':_0x3b96c0})[_0x1b93f2(0x341)](),config=getConfiguration(),io['to'](_0x1b93f2(0x345))[_0x1b93f2(0x331)]('bots',config),broadcastToBots(_0x1b93f2(0x228),JSON[_0x1b93f2(0x277)](config));}function updateLive(_0x4b7f2b,_0x5697be){const _0x5ecd15=_0x47280c;dbConfig['get'](_0x5ecd15(0x228))[_0x5ecd15(0x348)]({'botID':_0x4b7f2b})['assign']({'live':_0x5697be})['write'](),config=getConfiguration(),io['to'](_0x5ecd15(0x345))[_0x5ecd15(0x331)](_0x5ecd15(0x228),config),broadcastToBots(_0x5ecd15(0x228),JSON[_0x5ecd15(0x277)](config));}function updateBotName(_0x5394be,_0x397c4f){const _0x3f9fe5=_0x47280c;dbConfig[_0x3f9fe5(0x2b0)](_0x3f9fe5(0x228))[_0x3f9fe5(0x348)]({'botID':_0x5394be})['assign']({'botname':_0x397c4f})[_0x3f9fe5(0x341)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x3f9fe5(0x228),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x4a4c20=_0x47280c;config=getConfiguration(),io['to'](_0x4a4c20(0x345))[_0x4a4c20(0x331)](_0x4a4c20(0x228),config),broadcastToBots(_0x4a4c20(0x228),JSON[_0x4a4c20(0x277)](config));}function toggleBotMode(_0x5e7c7d){const _0x46e6e8=_0x47280c;if(pid[_0x5e7c7d])pid[_0x5e7c7d][_0x46e6e8(0x352)]({'function':_0x46e6e8(0x3cd),'args':null});else{const _0x420b26=configpath+_0x46e6e8(0x2c0)+_0x5e7c7d+'-config.json',_0x13ccf2=fs[_0x46e6e8(0x240)](_0x420b26),_0x27a5c0=JSON[_0x46e6e8(0x2eb)](_0x13ccf2),_0x271df7=_0x27a5c0['bot'][0x0][_0x46e6e8(0x1fc)];_0x27a5c0[_0x46e6e8(0x206)][0x0][_0x46e6e8(0x1fc)]=!_0x271df7;const _0x5e15dd=JSON[_0x46e6e8(0x277)](_0x27a5c0,null,0x2);fs[_0x46e6e8(0x35e)](_0x420b26,_0x5e15dd),config=getConfiguration(),io['to'](_0x46e6e8(0x345))['emit'](_0x46e6e8(0x228),config),broadcastToBots(_0x46e6e8(0x228),JSON[_0x46e6e8(0x277)](config));}}function telegramError(_0x390bc1){const _0x458f05=_0x47280c;logger['simple'](getTimeStamp()+_0x458f05(0x282));}function validateTelegram(_0x32a49c){const _0x1d66f0=_0x47280c;if(_0x32a49c[_0x1d66f0(0x372)][_0x1d66f0(0x22e)]!=settings[_0x1d66f0(0x263)]&&'@'+_0x32a49c[_0x1d66f0(0x372)]['username']!=settings[_0x1d66f0(0x263)])return tgBot[_0x1d66f0(0x24e)](_0x32a49c[_0x1d66f0(0x287)]['id'],_0x1d66f0(0x2be),{'parse_mode':_0x1d66f0(0x38b)})[_0x1d66f0(0x22d)](_0x569970=>{telegramError(_0x569970);}),![];return!![];}async function initTelegram(){const _0x6d7dbf=_0x47280c;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x6d7dbf(0x3ce)],{'polling':!![]});let _0x35de6f='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x35de6f+='\x0a',_0x35de6f+=_0x6d7dbf(0x30e),_0x35de6f+='/disable\x20-\x20disable\x20notifications\x0a',_0x35de6f+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x35de6f+=_0x6d7dbf(0x2e6),_0x35de6f+='/on\x20-\x20start\x20bot(s)\x0a',_0x35de6f+=_0x6d7dbf(0x224),_0x35de6f+=_0x6d7dbf(0x2f5),_0x35de6f+=_0x6d7dbf(0x394),_0x35de6f+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x35de6f+=_0x6d7dbf(0x298),_0x35de6f+=_0x6d7dbf(0x21c),_0x35de6f+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x35de6f+=_0x6d7dbf(0x3a1),_0x35de6f+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x234ab4=_0x6d7dbf(0x235);_0x234ab4+='\x0a',_0x234ab4+=_0x35de6f,tgBot[_0x6d7dbf(0x3d0)](/\/start/,_0x211c80=>{const _0x59f888=_0x6d7dbf;if(!validateTelegram(_0x211c80))return;if(settings['telegramChatId']!=_0x211c80[_0x59f888(0x287)]['id'])updateSetting(_0x59f888(0x2d2),_0x211c80[_0x59f888(0x287)]['id']);updateSetting(_0x59f888(0x2a1),!![]),tgBot['sendMessage'](_0x211c80[_0x59f888(0x287)]['id'],_0x234ab4)[_0x59f888(0x22d)](_0x34d0a4=>{telegramError(_0x34d0a4);});}),tgBot[_0x6d7dbf(0x3d0)](/\/enable/,_0x1a4de1=>{const _0x1b1050=_0x6d7dbf;if(!validateTelegram(_0x1a4de1))return;if(settings[_0x1b1050(0x2d2)]!=_0x1a4de1[_0x1b1050(0x287)]['id'])updateSetting(_0x1b1050(0x2d2),_0x1a4de1[_0x1b1050(0x287)]['id']);updateSetting(_0x1b1050(0x2a1),!![]),tgBot[_0x1b1050(0x24e)](_0x1a4de1[_0x1b1050(0x287)]['id'],_0x1b1050(0x267))[_0x1b1050(0x22d)](_0x4d8910=>{telegramError(_0x4d8910);});}),tgBot[_0x6d7dbf(0x3d0)](/\/config/,async _0x43c08f=>{const _0x3dfd47=_0x6d7dbf;if(!validateTelegram(_0x43c08f))return;tgBot['removeListener'](_0x3dfd47(0x2df)),tgBot[_0x3dfd47(0x24e)](_0x43c08f[_0x3dfd47(0x287)]['id'],_0x3dfd47(0x2b3),{'reply_markup':{'inline_keyboard':[[{'text':_0x3dfd47(0x25f),'callback_data':'orders'},{'text':'Alerts','callback_data':_0x3dfd47(0x22b)},{'text':'All','callback_data':_0x3dfd47(0x210)}]]}})[_0x3dfd47(0x22d)](_0x187be4=>{telegramError(_0x187be4);}),tgBot['on'](_0x3dfd47(0x2df),async _0x3b2dec=>{const _0x143f6f=_0x3dfd47,_0x485f2a=_0x3b2dec[_0x143f6f(0x272)],_0x3df7cd=_0x3b2dec[_0x143f6f(0x2c4)];tgBot[_0x143f6f(0x273)](_0x3b2dec['id'])[_0x143f6f(0x3b0)](async()=>{const _0x53ca74=_0x143f6f;_0x485f2a=='orders'&&(updateSetting(_0x53ca74(0x1ef),_0x53ca74(0x283)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x3df7cd[_0x53ca74(0x287)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x3a8b2c=>{telegramError(_0x3a8b2c);}));_0x485f2a==_0x53ca74(0x22b)&&(updateSetting(_0x53ca74(0x1ef),_0x53ca74(0x22b)),updateSetting('telegramEnabled',!![]),await tgBot[_0x53ca74(0x24e)](_0x3df7cd[_0x53ca74(0x287)]['id'],_0x53ca74(0x262))['catch'](_0x2c6c75=>{telegramError(_0x2c6c75);}));_0x485f2a==_0x53ca74(0x210)&&(updateSetting(_0x53ca74(0x1ef),'all'),updateSetting(_0x53ca74(0x2a1),!![]),await tgBot[_0x53ca74(0x24e)](_0x3df7cd[_0x53ca74(0x287)]['id'],_0x53ca74(0x1fa))[_0x53ca74(0x22d)](_0x3c90ce=>{telegramError(_0x3c90ce);}));if(!settings[_0x53ca74(0x2d2)])tgBot[_0x53ca74(0x24e)](_0x3df7cd[_0x53ca74(0x287)]['id'],_0x53ca74(0x375))[_0x53ca74(0x22d)](_0x15ab7a=>{telegramError(_0x15ab7a);});}),tgBot[_0x143f6f(0x249)](_0x143f6f(0x2df));});}),tgBot[_0x6d7dbf(0x3d0)](/\/status/,_0x4a6a39=>{const _0x5d56e7=_0x6d7dbf;if(!validateTelegram(_0x4a6a39))return;const _0x39784e=getBotsWithMode();let _0x590726=_0x5d56e7(0x321);config[_0x5d56e7(0x2fa)](_0x101eb0=>{const _0x140bf0=_0x5d56e7,_0x33b522=_0x39784e[_0x140bf0(0x348)](_0x23c97a=>_0x23c97a[_0x140bf0(0x300)]==_0x101eb0[_0x140bf0(0x300)])[_0x140bf0(0x36f)];_0x590726+='Bot\x20'+_0x101eb0[_0x140bf0(0x300)]+':\x20'+_0x101eb0[_0x140bf0(0x216)]+'\x20|\x20'+_0x33b522+_0x140bf0(0x327)+_0x101eb0[_0x140bf0(0x2d3)]+'\x0a';}),_0x590726+='\x0a',_0x590726+=_0x5d56e7(0x32f),_0x590726+=!settings[_0x5d56e7(0x2a1)]?_0x5d56e7(0x307):'Notifications\x20enabled\x0a',_0x590726+=settings['telegramEnabled']?settings[_0x5d56e7(0x1ef)]=='all'?_0x5d56e7(0x28d):_0x5d56e7(0x3a2)+settings[_0x5d56e7(0x1ef)]+_0x5d56e7(0x36e):'',tgBot[_0x5d56e7(0x24e)](_0x4a6a39[_0x5d56e7(0x287)]['id'],_0x590726,{'parse_mode':_0x5d56e7(0x38b)})[_0x5d56e7(0x22d)](_0x2bc81f=>{telegramError(_0x2bc81f);});}),tgBot[_0x6d7dbf(0x3d0)](/\/restart/,_0x53cff9=>{const _0xe2aa2=_0x6d7dbf;if(!validateTelegram(_0x53cff9))return;tgBot['removeListener'](_0xe2aa2(0x2df));const _0x56ef41=getEnabledBots();if(_0x56ef41[_0xe2aa2(0x203)]==0x0)tgBot['sendMessage'](_0x53cff9[_0xe2aa2(0x287)]['id'],_0xe2aa2(0x226))[_0xe2aa2(0x22d)](_0x3d7ebb=>{telegramError(_0x3d7ebb);});else{if(_0x56ef41[_0xe2aa2(0x203)]>0x1)_0x56ef41[_0xe2aa2(0x34a)]({'botID':'all'});let _0xfc9ef3=[],_0x1c1c63=[];const _0x11d948=_0x56ef41[_0xe2aa2(0x203)]%0x4==0x0||_0x56ef41[_0xe2aa2(0x203)]%0x4==0x3||_0x56ef41['length']%0x3==0x1?0x4:0x3;let _0x4bc510=0x0;_0x56ef41['forEach']((_0x42d675,_0x59f896)=>{const _0x96f5f5=_0xe2aa2;if(_0x59f896%_0x11d948==0x0)_0x1c1c63=[];_0x1c1c63[_0x96f5f5(0x34a)]({'text':_0x42d675['botID']=='all'?'All\x20bots':_0x96f5f5(0x275)+_0x42d675[_0x96f5f5(0x300)],'callback_data':_0x42d675[_0x96f5f5(0x300)]}),_0x59f896%_0x11d948==0x0&&(_0xfc9ef3[_0x4bc510]=_0x1c1c63,_0x4bc510++);}),tgBot[_0xe2aa2(0x24e)](_0x53cff9[_0xe2aa2(0x287)]['id'],_0xe2aa2(0x30d),{'reply_markup':{'inline_keyboard':_0xfc9ef3}})[_0xe2aa2(0x22d)](_0x354394=>{telegramError(_0x354394);}),tgBot['on'](_0xe2aa2(0x2df),async _0x21aae0=>{const _0x247459=_0xe2aa2,_0x2d678d=_0x21aae0[_0x247459(0x272)],_0x18cbd5=_0x21aae0['message'];tgBot['answerCallbackQuery'](_0x21aae0['id'])[_0x247459(0x3b0)](async()=>{const _0x49ed56=_0x247459;_0x2d678d==_0x49ed56(0x210)?config['forEach'](_0x33a355=>{const _0x12a72b=_0x49ed56;restartBot(_0x33a355[_0x12a72b(0x300)]);}):restartBot(_0x2d678d);}),tgBot[_0x247459(0x249)]('callback_query');});}}),tgBot[_0x6d7dbf(0x3d0)](/\/on/,_0x4cb34d=>{const _0x2264e2=_0x6d7dbf;if(!validateTelegram(_0x4cb34d))return;tgBot['removeListener'](_0x2264e2(0x2df));const _0x271e11=getDisabledBots();if(_0x271e11[_0x2264e2(0x203)]==0x0)tgBot[_0x2264e2(0x24e)](_0x4cb34d[_0x2264e2(0x287)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x2264e2(0x22d)](_0x1b46d2=>{telegramError(_0x1b46d2);});else{if(_0x271e11[_0x2264e2(0x203)]>0x1)_0x271e11[_0x2264e2(0x34a)]({'botID':_0x2264e2(0x210)});let _0x3ea0c0=[],_0x1d38e0=[];const _0x182318=_0x271e11['length']%0x4==0x0||_0x271e11[_0x2264e2(0x203)]%0x4==0x3||_0x271e11[_0x2264e2(0x203)]%0x3==0x1?0x4:0x3;let _0x15e324=0x0;_0x271e11[_0x2264e2(0x2fa)]((_0x546338,_0x2bc24d)=>{const _0x4f3823=_0x2264e2;if(_0x2bc24d%_0x182318==0x0)_0x1d38e0=[];_0x1d38e0[_0x4f3823(0x34a)]({'text':_0x546338[_0x4f3823(0x300)]==_0x4f3823(0x210)?_0x4f3823(0x323):'Bot\x20'+_0x546338['botID'],'callback_data':_0x546338[_0x4f3823(0x300)]}),_0x2bc24d%_0x182318==0x0&&(_0x3ea0c0[_0x15e324]=_0x1d38e0,_0x15e324++);}),tgBot[_0x2264e2(0x24e)](_0x4cb34d[_0x2264e2(0x287)]['id'],_0x2264e2(0x23d),{'reply_markup':{'inline_keyboard':_0x3ea0c0}})[_0x2264e2(0x22d)](_0x3cc2f6=>{telegramError(_0x3cc2f6);}),tgBot['on'](_0x2264e2(0x2df),async _0x4ae9d0=>{const _0x49ab43=_0x2264e2,_0x3a9962=_0x4ae9d0[_0x49ab43(0x272)],_0x199bfc=_0x4ae9d0[_0x49ab43(0x2c4)];tgBot['answerCallbackQuery'](_0x4ae9d0['id'])[_0x49ab43(0x3b0)](async()=>{const _0xdc9030=_0x49ab43;_0x3a9962==_0xdc9030(0x210)?(tgBot[_0xdc9030(0x24e)](_0x199bfc['chat']['id'],_0xdc9030(0x305))[_0xdc9030(0x22d)](_0x3fb1ee=>{telegramError(_0x3fb1ee);}),_0x271e11[_0xdc9030(0x2fa)](_0x2e63e9=>{const _0xb4cc1e=_0xdc9030;if(_0x2e63e9[_0xb4cc1e(0x300)]!=_0xb4cc1e(0x210))toggleBot(_0x2e63e9[_0xb4cc1e(0x300)],toggleStatus(_0x2e63e9[_0xb4cc1e(0x300)]),_0xb4cc1e(0x223));})):(tgBot[_0xdc9030(0x24e)](_0x199bfc[_0xdc9030(0x287)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x3a9962)[_0xdc9030(0x22d)](_0x248165=>{telegramError(_0x248165);}),toggleBot(_0x3a9962,toggleStatus(_0x3a9962),'stopped'));}),tgBot['removeListener'](_0x49ab43(0x2df));});}}),tgBot[_0x6d7dbf(0x3d0)](/\/off/,_0x3e68b9=>{const _0x4b62cd=_0x6d7dbf;if(!validateTelegram(_0x3e68b9))return;tgBot[_0x4b62cd(0x249)](_0x4b62cd(0x2df));const _0x2bba12=getEnabledBots();if(_0x2bba12['length']==0x0)tgBot[_0x4b62cd(0x24e)](_0x3e68b9['chat']['id'],_0x4b62cd(0x226))['catch'](_0x6a1bed=>{telegramError(_0x6a1bed);});else{if(_0x2bba12[_0x4b62cd(0x203)]>0x1)_0x2bba12[_0x4b62cd(0x34a)]({'botID':_0x4b62cd(0x210)});let _0x2d9287=[],_0x226e5e=[];const _0x191b0c=_0x2bba12[_0x4b62cd(0x203)]%0x4==0x0||_0x2bba12[_0x4b62cd(0x203)]%0x4==0x3||_0x2bba12['length']%0x3==0x1?0x4:0x3;let _0x1ffbb9=0x0;_0x2bba12['forEach']((_0x1d7636,_0x3d9cc6)=>{const _0x95b8cd=_0x4b62cd;if(_0x3d9cc6%_0x191b0c==0x0)_0x226e5e=[];_0x226e5e[_0x95b8cd(0x34a)]({'text':_0x1d7636[_0x95b8cd(0x300)]==_0x95b8cd(0x210)?_0x95b8cd(0x323):_0x95b8cd(0x275)+_0x1d7636[_0x95b8cd(0x300)],'callback_data':_0x1d7636[_0x95b8cd(0x300)]}),_0x3d9cc6%_0x191b0c==0x0&&(_0x2d9287[_0x1ffbb9]=_0x226e5e,_0x1ffbb9++);}),tgBot[_0x4b62cd(0x24e)](_0x3e68b9['chat']['id'],_0x4b62cd(0x2c1),{'reply_markup':{'inline_keyboard':_0x2d9287}})[_0x4b62cd(0x22d)](_0x4ef1d4=>{telegramError(_0x4ef1d4);}),tgBot['on']('callback_query',async _0xcdb086=>{const _0x1cf481=_0x4b62cd,_0x561064=_0xcdb086[_0x1cf481(0x272)],_0x3b225b=_0xcdb086[_0x1cf481(0x2c4)];tgBot['answerCallbackQuery'](_0xcdb086['id'])['then'](async()=>{const _0x4a281b=_0x1cf481;_0x561064=='all'?(tgBot[_0x4a281b(0x24e)](_0x3b225b['chat']['id'],_0x4a281b(0x23f))[_0x4a281b(0x22d)](_0xde6be6=>{telegramError(_0xde6be6);}),_0x2bba12[_0x4a281b(0x2fa)](_0x26ccfc=>{const _0x55c93f=_0x4a281b;if(_0x26ccfc['botID']!='all')toggleBot(_0x26ccfc[_0x55c93f(0x300)],toggleStatus(_0x26ccfc[_0x55c93f(0x300)]),_0x55c93f(0x223));})):(tgBot['sendMessage'](_0x3b225b[_0x4a281b(0x287)]['id'],_0x4a281b(0x367)+_0x561064)[_0x4a281b(0x22d)](_0xba362f=>{telegramError(_0xba362f);}),toggleBot(_0x561064,toggleStatus(_0x561064),_0x4a281b(0x223)));}),tgBot[_0x1cf481(0x249)]('callback_query');});}}),tgBot[_0x6d7dbf(0x3d0)](/\/metrics/,_0x4f0cb0=>{const _0x1af94f=_0x6d7dbf;if(!validateTelegram(_0x4f0cb0))return;tgBot['removeListener'](_0x1af94f(0x2df));const _0x208e1e=getEnabledBots();if(_0x208e1e[_0x1af94f(0x203)]==0x0)tgBot[_0x1af94f(0x24e)](_0x4f0cb0[_0x1af94f(0x287)]['id'],_0x1af94f(0x226))['catch'](_0x4aa4f0=>{telegramError(_0x4aa4f0);});else{if(_0x208e1e[_0x1af94f(0x203)]>0x1){let _0x4ac6fd=[],_0x2242d4=[];const _0x40b3c9=_0x208e1e[_0x1af94f(0x203)]%0x4==0x0||_0x208e1e[_0x1af94f(0x203)]%0x4==0x3||_0x208e1e[_0x1af94f(0x203)]%0x3==0x1?0x4:0x3;let _0x4c47c9=0x0;_0x208e1e[_0x1af94f(0x2fa)]((_0x5e2b9e,_0x6639a6)=>{const _0x264da4=_0x1af94f;if(_0x6639a6%_0x40b3c9==0x0)_0x2242d4=[];_0x2242d4[_0x264da4(0x34a)]({'text':_0x264da4(0x275)+_0x5e2b9e['botID'],'callback_data':_0x5e2b9e[_0x264da4(0x300)]}),_0x6639a6%_0x40b3c9==0x0&&(_0x4ac6fd[_0x4c47c9]=_0x2242d4,_0x4c47c9++);}),tgBot[_0x1af94f(0x24e)](_0x4f0cb0[_0x1af94f(0x287)]['id'],_0x1af94f(0x337),{'reply_markup':{'inline_keyboard':_0x4ac6fd}})[_0x1af94f(0x22d)](_0x2b6ad9=>{telegramError(_0x2b6ad9);}),tgBot['on'](_0x1af94f(0x2df),async _0x359e87=>{const _0x9babba=_0x1af94f,_0x482bb6=_0x359e87[_0x9babba(0x272)],_0x483de9=_0x359e87[_0x9babba(0x2c4)];tgBot['answerCallbackQuery'](_0x359e87['id'])[_0x9babba(0x3b0)](async()=>{const _0x5e4c63=_0x9babba;if(pid[_0x482bb6])pid[_0x482bb6][_0x5e4c63(0x352)]({'function':_0x5e4c63(0x3c6),'args':null});}),tgBot[_0x9babba(0x249)](_0x9babba(0x2df));});}else{const _0x276767=_0x208e1e[0x0][_0x1af94f(0x300)];if(pid[_0x276767])pid[_0x276767][_0x1af94f(0x352)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x6d7dbf(0x3d0)](/\/portfolio/,_0x5e33fd=>{const _0x1edfeb=_0x6d7dbf;if(!validateTelegram(_0x5e33fd))return;tgBot['removeListener'](_0x1edfeb(0x2df));const _0x1e225d=getEnabledBots();if(_0x1e225d[_0x1edfeb(0x203)]==0x0)tgBot[_0x1edfeb(0x24e)](_0x5e33fd['chat']['id'],_0x1edfeb(0x226))[_0x1edfeb(0x22d)](_0x31ea6f=>{telegramError(_0x31ea6f);});else{if(_0x1e225d[_0x1edfeb(0x203)]>0x1){let _0x28e79a=[],_0x3145aa=[];const _0x1abf05=_0x1e225d['length']%0x4==0x0||_0x1e225d[_0x1edfeb(0x203)]%0x4==0x3||_0x1e225d['length']%0x3==0x1?0x4:0x3;let _0x433530=0x0;_0x1e225d[_0x1edfeb(0x2fa)]((_0x3db489,_0x18eb21)=>{const _0x570f77=_0x1edfeb;if(_0x18eb21%_0x1abf05==0x0)_0x3145aa=[];_0x3145aa[_0x570f77(0x34a)]({'text':_0x570f77(0x275)+_0x3db489[_0x570f77(0x300)],'callback_data':_0x3db489['botID']}),_0x18eb21%_0x1abf05==0x0&&(_0x28e79a[_0x433530]=_0x3145aa,_0x433530++);}),tgBot[_0x1edfeb(0x24e)](_0x5e33fd[_0x1edfeb(0x287)]['id'],_0x1edfeb(0x320),{'reply_markup':{'inline_keyboard':_0x28e79a}})[_0x1edfeb(0x22d)](_0x1ff113=>{telegramError(_0x1ff113);}),tgBot['on'](_0x1edfeb(0x2df),async _0x196d24=>{const _0x5ddcd2=_0x1edfeb,_0x31143d=_0x196d24[_0x5ddcd2(0x272)],_0x2f9704=_0x196d24['message'];tgBot[_0x5ddcd2(0x273)](_0x196d24['id'])[_0x5ddcd2(0x3b0)](async()=>{const _0x32718d=_0x5ddcd2;if(pid[_0x31143d])pid[_0x31143d][_0x32718d(0x352)]({'function':_0x32718d(0x204),'args':null});}),tgBot[_0x5ddcd2(0x249)](_0x5ddcd2(0x2df));});}else{const _0x1f0eb6=_0x1e225d[0x0][_0x1edfeb(0x300)];if(pid[_0x1f0eb6])pid[_0x1f0eb6][_0x1edfeb(0x352)]({'function':_0x1edfeb(0x204),'args':null});}}}),tgBot[_0x6d7dbf(0x3d0)](/\/update/,async _0x276dcc=>{const _0x12bcbd=_0x6d7dbf;if(!validateTelegram(_0x276dcc))return;tgBot[_0x12bcbd(0x249)](_0x12bcbd(0x2df)),await getMessages();if(!updateAvailable)tgBot[_0x12bcbd(0x24e)](_0x276dcc[_0x12bcbd(0x287)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x12bcbd(0x22d)](_0x46f307=>{telegramError(_0x46f307);});else!validInstallation?tgBot[_0x12bcbd(0x24e)](_0x276dcc['chat']['id'],_0x12bcbd(0x2f6))[_0x12bcbd(0x22d)](_0x29768e=>{telegramError(_0x29768e);}):(tgBot['sendMessage'](_0x276dcc[_0x12bcbd(0x287)]['id'],_0x12bcbd(0x2a7),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x12bcbd(0x365)},{'text':'No','callback_data':'no'}]]}})[_0x12bcbd(0x22d)](_0x24d995=>{telegramError(_0x24d995);}),tgBot['on']('callback_query',async _0x885f4a=>{const _0x18b4dc=_0x12bcbd,_0x18990a=_0x885f4a['data'],_0x437dbf=_0x885f4a['message'];tgBot[_0x18b4dc(0x273)](_0x885f4a['id'])[_0x18b4dc(0x3b0)](async()=>{const _0x2a38ec=_0x18b4dc;_0x18990a==_0x2a38ec(0x365)&&(await tgBot[_0x2a38ec(0x24e)](_0x437dbf[_0x2a38ec(0x287)]['id'],_0x2a38ec(0x3a5))['catch'](_0x532aaa=>{telegramError(_0x532aaa);}),updateBB('update')),_0x18990a=='no'&&await tgBot[_0x2a38ec(0x24e)](_0x437dbf['chat']['id'],_0x2a38ec(0x3b2))[_0x2a38ec(0x22d)](_0x3d81b9=>{telegramError(_0x3d81b9);});}),tgBot['removeListener'](_0x18b4dc(0x2df));}));}),tgBot['onText'](/\/reinstall/,async _0xed616e=>{const _0x227572=_0x6d7dbf;if(!validateTelegram(_0xed616e))return;tgBot[_0x227572(0x249)](_0x227572(0x2df)),!validInstallation?tgBot[_0x227572(0x24e)](_0xed616e[_0x227572(0x287)]['id'],_0x227572(0x2b7))[_0x227572(0x22d)](_0x17d001=>{telegramError(_0x17d001);}):(tgBot['sendMessage'](_0xed616e['chat']['id'],_0x227572(0x347),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x227572(0x365)},{'text':'No','callback_data':'no'}]]}})[_0x227572(0x22d)](_0x261711=>{telegramError(_0x261711);}),tgBot['on'](_0x227572(0x2df),async _0x2c0d1e=>{const _0x2e35eb=_0x227572,_0x2bbc51=_0x2c0d1e['data'],_0x33dc86=_0x2c0d1e[_0x2e35eb(0x2c4)];tgBot[_0x2e35eb(0x273)](_0x2c0d1e['id'])[_0x2e35eb(0x3b0)](async()=>{const _0x3e1c6f=_0x2e35eb;_0x2bbc51=='yes'&&(await tgBot[_0x3e1c6f(0x24e)](_0x33dc86[_0x3e1c6f(0x287)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')['catch'](_0x1995fe=>{telegramError(_0x1995fe);}),updateBB(_0x3e1c6f(0x3b4))),_0x2bbc51=='no'&&await tgBot[_0x3e1c6f(0x24e)](_0x33dc86['chat']['id'],_0x3e1c6f(0x21d))[_0x3e1c6f(0x22d)](_0x4a067a=>{telegramError(_0x4a067a);});}),tgBot['removeListener']('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x205a57=>{const _0x376566=_0x6d7dbf;if(!validateTelegram(_0x205a57))return;tgBot[_0x376566(0x249)](_0x376566(0x2df));const _0x3a00b3=getBotsWithMode();if(_0x3a00b3['length']==0x0)tgBot[_0x376566(0x24e)](_0x205a57[_0x376566(0x287)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x376566(0x22d)](_0x222708=>{telegramError(_0x222708);});else{let _0x3ce0a4=[],_0x505bf0=[];const _0x1782fd=0x2;let _0xd31e24=0x0;_0x3a00b3[_0x376566(0x2fa)]((_0x3c8df0,_0x211589)=>{const _0x1f7deb=_0x376566;if(_0x211589%_0x1782fd==0x0)_0x505bf0=[];_0x505bf0['push']({'text':_0x1f7deb(0x275)+_0x3c8df0[_0x1f7deb(0x300)]+'\x20('+_0x3c8df0[_0x1f7deb(0x36f)]+')','callback_data':_0x3c8df0[_0x1f7deb(0x300)]}),_0x211589%_0x1782fd==0x0&&(_0x3ce0a4[_0xd31e24]=_0x505bf0,_0xd31e24++);}),tgBot[_0x376566(0x24e)](_0x205a57[_0x376566(0x287)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x3ce0a4}})[_0x376566(0x22d)](_0x569750=>{telegramError(_0x569750);}),tgBot['on'](_0x376566(0x2df),async _0x16834f=>{const _0x1fffce=_0x376566,_0x331b7d=_0x16834f[_0x1fffce(0x272)],_0x448876=_0x16834f[_0x1fffce(0x2c4)];tgBot['answerCallbackQuery'](_0x16834f['id'])['then'](async()=>{const _0x367a5a=_0x1fffce,_0x233fee=_0x3a00b3[_0x367a5a(0x348)](_0xdb61b3=>_0xdb61b3[_0x367a5a(0x300)]==_0x331b7d),_0x4fb7ac=_0x233fee[_0x367a5a(0x36f)]==_0x367a5a(0x24a)?_0x367a5a(0x24c):_0x367a5a(0x24a);tgBot[_0x367a5a(0x24e)](_0x448876['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x331b7d+_0x367a5a(0x214)+_0x4fb7ac+'\x20mode')[_0x367a5a(0x22d)](_0x2c0aaf=>{telegramError(_0x2c0aaf);}),toggleBotMode(_0x331b7d);}),tgBot[_0x1fffce(0x249)]('callback_query');});}}),tgBot[_0x6d7dbf(0x3d0)](/\/names/,_0x441515=>{const _0x17b014=_0x6d7dbf;if(!validateTelegram(_0x441515))return;let _0x5c8c53='';config[_0x17b014(0x2fa)](_0x693e9f=>{const _0x3f987a=_0x17b014;_0x5c8c53+=_0x3f987a(0x275)+_0x693e9f['botID']+':\x20'+_0x693e9f[_0x3f987a(0x3aa)]+'\x0a';}),tgBot['sendMessage'](_0x441515[_0x17b014(0x287)]['id'],_0x5c8c53,{'parse_mode':_0x17b014(0x38b)})['catch'](_0x46e3f0=>{telegramError(_0x46e3f0);});}),tgBot['onText'](/\/disable/,_0x52a206=>{const _0x2b888c=_0x6d7dbf;if(!validateTelegram(_0x52a206))return;tgBot['sendMessage'](_0x52a206['chat']['id'],_0x2b888c(0x3c1))[_0x2b888c(0x22d)](_0x4b7ae9=>{telegramError(_0x4b7ae9);}),updateSetting(_0x2b888c(0x2a1),![]);}),tgBot['onText'](/\/help/,_0x30a892=>{const _0x47b709=_0x6d7dbf;if(!validateTelegram(_0x30a892))return;tgBot[_0x47b709(0x24e)](_0x30a892[_0x47b709(0x287)]['id'],_0x35de6f)[_0x47b709(0x22d)](_0x672795=>{telegramError(_0x672795);});}),tgBot['on'](_0x6d7dbf(0x3ac),_0x3aa21d=>{const _0x83a63e=_0x6d7dbf;_0x3aa21d[_0x83a63e(0x2c7)]()[_0x83a63e(0x21e)](_0x83a63e(0x3a8))&&(logger[_0x83a63e(0x33a)]('Invalid\x20Telegram\x20token'),tgBot[_0x83a63e(0x2da)](),tgBot=null,io['to'](_0x83a63e(0x345))[_0x83a63e(0x331)](_0x83a63e(0x25d),'Invalid\x20Telegram\x20token'));}),process['once'](_0x6d7dbf(0x346),()=>{const _0x2a7f65=_0x6d7dbf;if(tgBot)tgBot[_0x2a7f65(0x2da)]();process[_0x2a7f65(0x3b5)](0x1);}),process[_0x6d7dbf(0x3c5)]('SIGTERM',()=>{const _0x51a22c=_0x6d7dbf;if(tgBot)tgBot[_0x51a22c(0x2da)]();process[_0x51a22c(0x3b5)](0x1);});}}function disableTelegram(){const _0x3c9afe=_0x47280c;tgBot&&(tgBot[_0x3c9afe(0x2da)](),tgBot=null);}function sendTelegram(_0x15a710,_0x3a3585){const _0x23d8de=_0x47280c;if(settings[_0x23d8de(0x2a1)]){if(settings[_0x23d8de(0x1ef)]==_0x23d8de(0x210)||(_0x3a3585['type']==_0x23d8de(0x25c)||_0x3a3585[_0x23d8de(0x37d)]=='warning'||_0x3a3585[_0x23d8de(0x37d)]==_0x23d8de(0x2ee))&&settings[_0x23d8de(0x1ef)]==_0x23d8de(0x22b)||_0x3a3585[_0x23d8de(0x37d)]=='order'&&settings[_0x23d8de(0x1ef)]==_0x23d8de(0x283)){if(tgBot&&settings['telegramChatId']){if(_0x3a3585[_0x23d8de(0x2e1)])tgBot[_0x23d8de(0x24e)](settings['telegramChatId'],_0x3a3585[_0x23d8de(0x3aa)]+_0x23d8de(0x3a3)+_0x3a3585[_0x23d8de(0x271)])[_0x23d8de(0x22d)](_0x3e809b=>{telegramError(_0x3e809b);});else tgBot[_0x23d8de(0x24e)](settings['telegramChatId'],_0x23d8de(0x275)+_0x15a710+'\x20>\x20'+_0x3a3585[_0x23d8de(0x271)])[_0x23d8de(0x22d)](_0xb30d6c=>{telegramError(_0xb30d6c);});}}}}async function sendTelegramMsg(_0x332be3,_0x1c157f='HTML'){const _0x290eb4=_0x47280c;return settings[_0x290eb4(0x2a1)]&&tgBot&&settings[_0x290eb4(0x2d2)]?(await tgBot[_0x290eb4(0x24e)](settings['telegramChatId'],_0x332be3,{'parse_mode':_0x1c157f})[_0x290eb4(0x22d)](_0xf34b58=>{telegramError(_0xf34b58);}),!![]):![];}function getDeviceWithIp(_0xac407e){const _0x44ef94=_0x47280c;return devices[_0x44ef94(0x348)](_0x487ff8=>_0x487ff8['ip']===_0xac407e);}function temporaryAccess2FA(_0x1fd78b,_0x5cd71a){const _0x51a2f6=_0x47280c;let _0x2be965=new Date(),_0x323645=![];if(lastIpApproval){if(_0x2be965-lastIpApproval<0x1388)_0x323645=!![];}lastIpApproval=new Date();if(_0x323645)return;tgBot&&settings[_0x51a2f6(0x2d2)]&&(tgBot[_0x51a2f6(0x249)]('callback_query'),tgBot[_0x51a2f6(0x24e)](settings['telegramChatId'],_0x51a2f6(0x326)+normalizeIP(_0x5cd71a)[_0x51a2f6(0x297)]+_0x51a2f6(0x3c2),{'parse_mode':_0x51a2f6(0x38b),'reply_markup':{'inline_keyboard':[[{'text':_0x51a2f6(0x24b),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x51a2f6(0x230),'callback_data':'30'},{'text':_0x51a2f6(0x25b),'callback_data':_0x51a2f6(0x25b)}]]}})[_0x51a2f6(0x22d)](_0x211145=>{telegramError(_0x211145);}),tgBot['on']('callback_query',async _0x3fb395=>{const _0x18318b=_0x51a2f6,_0x5b30c7=_0x3fb395['data'],_0x54dafc=_0x3fb395[_0x18318b(0x2c4)];tgBot[_0x18318b(0x273)](_0x3fb395['id'])[_0x18318b(0x3b0)](async()=>{const _0x2746f7=_0x18318b;devices[_0x1fd78b][_0x2746f7(0x38f)]={'clientip':_0x5cd71a,'timestamp':new Date()[_0x2746f7(0x274)](),'expiry':_0x5b30c7},_0x5b30c7!=_0x2746f7(0x25b)?(await tgBot[_0x2746f7(0x24e)](_0x54dafc['chat']['id'],_0x2746f7(0x2bf)+_0x5b30c7+'\x20minutes',{'parse_mode':'HTML'})[_0x2746f7(0x22d)](_0xe64fb8=>{telegramError(_0xe64fb8);}),io['to'](_0x1fd78b)[_0x2746f7(0x331)](_0x2746f7(0x216),{'access':{'allow':![],'reason':_0x2746f7(0x35f),'token':null}})):(await tgBot[_0x2746f7(0x24e)](_0x54dafc[_0x2746f7(0x287)]['id'],_0x2746f7(0x370))[_0x2746f7(0x22d)](_0x1fde2d=>{telegramError(_0x1fde2d);}),io['to'](_0x1fd78b)[_0x2746f7(0x331)]('status',{'access':{'allow':![],'reason':_0x2746f7(0x3a4),'token':null}}));}),tgBot[_0x18318b(0x249)](_0x18318b(0x2df));}));}function loginAccess2FA(_0x4fab54,_0x27c90e){const _0x55e0c7=_0x47280c;tgBot&&settings[_0x55e0c7(0x2d2)]&&(tgBot[_0x55e0c7(0x249)](_0x55e0c7(0x2df)),tgBot['sendMessage'](settings[_0x55e0c7(0x2d2)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x27c90e)['show']+'</b>\x20?',{'parse_mode':_0x55e0c7(0x38b),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x55e0c7(0x25b)}]]}})[_0x55e0c7(0x22d)](_0x93fc56=>{telegramError(_0x93fc56);}),tgBot['on'](_0x55e0c7(0x2df),async _0x310723=>{const _0x2178f4=_0x55e0c7,_0x136b3c=_0x310723['data'],_0x843bea=_0x310723[_0x2178f4(0x2c4)];tgBot['answerCallbackQuery'](_0x310723['id'])[_0x2178f4(0x3b0)](async()=>{const _0xa2b3a5=_0x2178f4;devices[_0x4fab54]['telegram2FaApproval']={'clientip':_0x27c90e,'timestamp':new Date()['getTime'](),'expiry':_0x136b3c},_0x136b3c!='reject'?(await tgBot[_0xa2b3a5(0x24e)](_0x843bea['chat']['id'],_0xa2b3a5(0x295),{'parse_mode':_0xa2b3a5(0x38b)})['catch'](_0x28f96c=>{telegramError(_0x28f96c);}),io['to'](_0x4fab54)['emit'](_0xa2b3a5(0x216),{'access':{'allow':![],'reason':_0xa2b3a5(0x35f),'token':null}})):(await tgBot[_0xa2b3a5(0x24e)](_0x843bea['chat']['id'],_0xa2b3a5(0x31f))['catch'](_0x56f30a=>{telegramError(_0x56f30a);}),io['to'](_0x4fab54)[_0xa2b3a5(0x331)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x2178f4(0x2df));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3d36a4=_0x47280c;return dbConfig[_0x3d36a4(0x2b0)]('bots')[_0x3d36a4(0x291)](_0x3d36a4(0x300))[_0x3d36a4(0x26c)]({'status':_0x3d36a4(0x2a3)})[_0x3d36a4(0x304)]()||[];}function getDisabledBots(){const _0x5f0c10=_0x47280c;return dbConfig[_0x5f0c10(0x2b0)](_0x5f0c10(0x228))['sortBy'](_0x5f0c10(0x300))[_0x5f0c10(0x26c)]({'status':_0x5f0c10(0x37e)})[_0x5f0c10(0x304)]()||[];}function getBotAttributes(_0x2794b2){const _0x2dc3c4=_0x47280c;let _0x407715={};const _0x5d285=configpath+_0x2dc3c4(0x2c0)+_0x2794b2+_0x2dc3c4(0x2e9),_0x4ce58a=fs[_0x2dc3c4(0x2ab)](_0x5d285);if(_0x4ce58a){const _0x94870b=fs[_0x2dc3c4(0x240)](_0x5d285);try{const _0x5a7088=JSON[_0x2dc3c4(0x2eb)](_0x94870b),_0x39d2b6=_0x5a7088?_0x5a7088[_0x2dc3c4(0x206)][0x0][_0x2dc3c4(0x1fc)]:![];_0x407715[_0x2dc3c4(0x36f)]=_0x39d2b6?'auto':'manual',_0x407715[_0x2dc3c4(0x3aa)]=_0x5a7088?_0x5a7088[_0x2dc3c4(0x206)][0x0][_0x2dc3c4(0x3aa)]:_0x2dc3c4(0x275)+_0x2794b2;}catch(_0x3b02d9){_0x407715['mode']=_0x2dc3c4(0x24c),_0x407715[_0x2dc3c4(0x3aa)]=_0x2dc3c4(0x275)+_0x2794b2;}}else _0x407715[_0x2dc3c4(0x36f)]='manual',_0x407715['botname']=_0x2dc3c4(0x275)+_0x2794b2;return _0x407715;}function getBotsWithMode(){const _0x361909=_0x47280c,_0x13ce0e=dbConfig['get']('bots')[_0x361909(0x291)](_0x361909(0x300))['value']()||[];return _0x13ce0e[_0x361909(0x2fa)](_0x1905bf=>{const _0x2c6740=_0x361909;let _0x39d6ca=getBotAttributes(_0x1905bf[_0x2c6740(0x300)]);_0x1905bf[_0x2c6740(0x36f)]=_0x39d6ca['mode'];}),_0x13ce0e;}function getBotExchanges(){const _0x59aac9=_0x47280c;let _0x5b1510=[];const _0x947203=dbConfig['get'](_0x59aac9(0x228))[_0x59aac9(0x291)](_0x59aac9(0x300))[_0x59aac9(0x304)]()||[];_0x947203[_0x59aac9(0x2fa)](_0x55c5c9=>{const _0x30ba7f=_0x59aac9;if(_0x55c5c9[_0x30ba7f(0x216)]=='enabled'){const _0x123fbc=configpath+_0x30ba7f(0x2c0)+_0x55c5c9[_0x30ba7f(0x300)]+_0x30ba7f(0x2e9),_0x561789=fs[_0x30ba7f(0x2ab)](_0x123fbc);let _0x20d61e;if(_0x561789){const _0x274379=fs['readFileSync'](_0x123fbc);try{const _0x1d9359=JSON[_0x30ba7f(0x2eb)](_0x274379);_0x20d61e=_0x1d9359?_0x1d9359[_0x30ba7f(0x206)][0x0]['exchange']:null;}catch(_0x2862a8){}}if(_0x20d61e)_0x5b1510[_0x30ba7f(0x34a)](_0x20d61e);}});const _0x4929d7=[...new Set(_0x5b1510)][_0x59aac9(0x258)]();return _0x4929d7;}async function initUser(){const _0x252d31=_0x47280c;if(!settings['userid']){const _0x34eae4=uuidRandom();mixpanel['alias'](_0x34eae4),updateSetting(_0x252d31(0x386),_0x34eae4);}}async function initSecure(){const _0x2eacc2=_0x47280c;let _0x3538e8=getSecure();if(!_0x3538e8[_0x2eacc2(0x369)](_0x2eacc2(0x2d1))){let _0x41e78d=await generateKeys();_0x3538e8[_0x2eacc2(0x1f1)]=_0x41e78d[_0x2eacc2(0x1f1)],_0x3538e8['privateKey']=_0x41e78d[_0x2eacc2(0x2ad)],_0x3538e8[_0x2eacc2(0x2d1)]=crypto[_0x2eacc2(0x3a6)](0x20)[_0x2eacc2(0x2c7)](_0x2eacc2(0x208));;storeSecure(_0x3538e8);}}function getSettings(){const _0x229571=_0x47280c;return dbSettings['get']('settings')[_0x229571(0x304)]()||{};}function getSecure(){const _0x375501=_0x47280c;return dbSecure[_0x375501(0x2b0)](_0x375501(0x36b))[_0x375501(0x304)]()||{};}function getBlacklist(){const _0x4d3e64=_0x47280c;return dbSecure[_0x4d3e64(0x2b0)]('blacklist')[_0x4d3e64(0x304)]()||[];}function broadcastToBots(_0x4b5c85,_0x413a66){const _0x3823ee=_0x47280c;config[_0x3823ee(0x2fa)](_0x5e3bed=>{const _0xbcce58=_0x3823ee;if(_0x5e3bed[_0xbcce58(0x216)]==_0xbcce58(0x2a3)&&_0x5e3bed[_0xbcce58(0x2d3)]=='running'||_0x5e3bed[_0xbcce58(0x216)]==_0xbcce58(0x1f4)&&_0x5e3bed[_0xbcce58(0x2d3)]=='running'){if(pid[_0x5e3bed[_0xbcce58(0x300)]])pid[_0x5e3bed[_0xbcce58(0x300)]][_0xbcce58(0x352)]({[_0x4b5c85]:_0x413a66});}});}function storeSettings(_0x48291d,_0x1c38f6=![]){const _0x396df7=_0x47280c;_0x48291d={...settings,..._0x48291d};if(_0x1c38f6&&_0x48291d[_0x396df7(0x211)]!=_0x396df7(0x281)&&_0x48291d[_0x396df7(0x211)]!=_0x396df7(0x329)&&_0x48291d[_0x396df7(0x211)]!=''){const _0x397e39=crypt[_0x396df7(0x2b2)](secure[_0x396df7(0x2ad)],_0x48291d['bbPassword'])['message'][_0x396df7(0x339)]('@')[0x0],_0x165645=bcrypt[_0x396df7(0x2a5)](_0x397e39,saltRounds);_0x48291d={..._0x48291d,'bbPassword':_0x165645};}if(_0x1c38f6&&_0x48291d[_0x396df7(0x3ce)]!=_0x396df7(0x281)&&_0x48291d[_0x396df7(0x3ce)]!=_0x396df7(0x329)&&_0x48291d['telegramToken']!=''){const _0x134d5e=crypt[_0x396df7(0x2b2)](secure['privateKey'],_0x48291d[_0x396df7(0x3ce)])['message'][_0x396df7(0x339)]('@')[0x0];_0x48291d={..._0x48291d,'telegramToken':_0x134d5e};}const _0x4e4039=_0x48291d[_0x396df7(0x3ce)]!=_0x396df7(0x281)&&_0x48291d[_0x396df7(0x3ce)]!=settings[_0x396df7(0x3ce)]||_0x48291d[_0x396df7(0x263)]!=settings[_0x396df7(0x263)],_0x565c5e=_0x48291d[_0x396df7(0x3ce)]==''||_0x48291d[_0x396df7(0x263)]=='';if(_0x4e4039)_0x48291d[_0x396df7(0x1ef)]=_0x396df7(0x210);for(const [_0x5874d9,_0x20bb16]of Object[_0x396df7(0x333)](_0x48291d)){if(_0x5874d9=='telegramToken'&&_0x20bb16==_0x396df7(0x281)){_0x48291d[_0x396df7(0x3ce)]=settings[_0x396df7(0x3ce)];continue;};if(_0x5874d9=='bbPassword'&&_0x20bb16==_0x396df7(0x281)){_0x48291d[_0x396df7(0x211)]=settings['bbPassword'];continue;};dbSettings[_0x396df7(0x1fb)]('settings.'+_0x5874d9,_0x20bb16)[_0x396df7(0x341)]();}settings=_0x48291d,io['to']('botmanager')[_0x396df7(0x331)](_0x396df7(0x250),cleanSettings()),broadcastToBots(_0x396df7(0x335),settings['timeshift']),broadcastToBots(_0x396df7(0x23c),settings[_0x396df7(0x23c)]);if(_0x4e4039&&!_0x565c5e)initTelegram();if(_0x4e4039&&_0x565c5e)disableTelegram();getAllClients()[_0x396df7(0x2fa)](_0x56723e=>{const _0x514941=_0x396df7;getSocket(_0x56723e['id'])[_0x514941(0x331)](_0x514941(0x216),{'access':{'allow':![],'reason':_0x514941(0x35f),'token':null}});});}function updateSetting(_0xe08665,_0x294f7b){const _0x2e4acb=_0x47280c;dbSettings[_0x2e4acb(0x1fb)](_0x2e4acb(0x390)+_0xe08665,_0x294f7b)[_0x2e4acb(0x341)](),settings=getSettings(),io['to']('botmanager')[_0x2e4acb(0x331)](_0x2e4acb(0x250),cleanSettings());}function storeSecure(_0x3818ee){const _0x42c4ab=_0x47280c;dbSecure[_0x42c4ab(0x2b0)](_0x42c4ab(0x36b))[_0x42c4ab(0x34a)](_0x3818ee)[_0x42c4ab(0x341)](),secure=_0x3818ee;}function addBlacklist(_0x53f905){const _0x59345f=_0x47280c;cleanBlacklist();let _0x47639a;devices[_0x53f905][_0x59345f(0x38f)]?_0x47639a=Math[_0x59345f(0x2a6)](devices[_0x53f905]['telegramIpApproval'][_0x59345f(0x28e)],loginExpiry):_0x47639a=loginExpiry,dbSecure[_0x59345f(0x2b0)](_0x59345f(0x2ef))[_0x59345f(0x34a)]({'expiry':new Date()[_0x59345f(0x274)]()+_0x47639a*0x3c*0x3e8,'token':devices[_0x53f905][_0x59345f(0x31c)][_0x59345f(0x32a)]})[_0x59345f(0x341)](),blacklist=dbSecure[_0x59345f(0x2b0)](_0x59345f(0x2ef))[_0x59345f(0x304)]();}function cleanBlacklist(){const _0xd4431=_0x47280c;let _0x1b977f=dbSecure['get'](_0xd4431(0x2ef))[_0xd4431(0x2bc)]()[_0xd4431(0x304)](),_0x50569a=new Date()[_0xd4431(0x274)]();_0x1b977f[_0xd4431(0x2fa)](_0x1fbe1d=>{const _0x132271=_0xd4431;_0x1fbe1d[_0x132271(0x28e)]<_0x50569a&&dbSecure[_0x132271(0x2b0)](_0x132271(0x2ef))[_0x132271(0x2a0)]({'expiry':_0x1fbe1d[_0x132271(0x28e)]})['write']();});}function initStates(){const _0x174ca5=_0x47280c;let _0x446b8b=getConfiguration();_0x446b8b[_0x174ca5(0x2fa)](_0x12ac75=>{const _0x3f3e78=_0x174ca5;_0x12ac75[_0x3f3e78(0x2d3)]=_0x3f3e78(0x223);}),storeConfiguration(_0x446b8b);}function onKeys(){const _0x4a8203=new RSA();return new Promise(_0x5e620d=>{const _0xc41b7b=_0x3f24;_0x4a8203[_0xc41b7b(0x257)]()[_0xc41b7b(0x3b0)](_0x3aad4d=>{_0x5e620d(_0x3aad4d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x335f35=_0x47280c;let _0x127aad=getSettings(),_0x3b6fd2=![];!_0x127aad[_0x335f35(0x369)](_0x335f35(0x2ff))&&(_0x127aad['lastmsgtelegram']=0x0,_0x3b6fd2=!![]);!_0x127aad[_0x335f35(0x369)](_0x335f35(0x2a2))&&(_0x127aad[_0x335f35(0x2a2)]=0x0,_0x3b6fd2=!![]);!_0x127aad['hasOwnProperty'](_0x335f35(0x2f0))&&(_0x127aad['latestversion']=_0x335f35(0x32d),_0x3b6fd2=!![]);!_0x127aad['hasOwnProperty'](_0x335f35(0x23c))&&(_0x127aad['onepagemode']=![],_0x3b6fd2=!![]);if(_0x3b6fd2)storeSettings(_0x127aad);try{fs[_0x335f35(0x26b)](configbackuppath,{'withFileTypes':!![]})[_0x335f35(0x2fa)](_0x4c46bd=>{const _0x242d9f=_0x335f35;if(!_0x4c46bd[_0x242d9f(0x374)]()){if(!_0x4c46bd[_0x242d9f(0x2a8)][_0x242d9f(0x3b7)](_0x242d9f(0x318)))fs[_0x242d9f(0x382)](configbackuppath+_0x4c46bd['name']);}else fs['rmSync'](configbackuppath+_0x4c46bd[_0x242d9f(0x2a8)],{'recursive':!![]});});}catch(_0x3c0ab8){logger['debug'](_0x335f35(0x20b),_0x3c0ab8);}}function storeConfiguration(_0x1ef83a){const _0x24caf4=_0x47280c;dbConfig[_0x24caf4(0x2b0)](_0x24caf4(0x228))['remove']()[_0x24caf4(0x341)](),_0x1ef83a['forEach'](_0x2a3fe2=>{delete _0x2a3fe2['mode'];}),dbConfig[_0x24caf4(0x2b0)](_0x24caf4(0x228))[_0x24caf4(0x34a)](..._0x1ef83a)[_0x24caf4(0x341)](),config=_0x1ef83a;}function resetPassword(){const _0x5bbd12=_0x47280c;tgBot&&settings['telegramChatId']&&(tgBot[_0x5bbd12(0x249)](_0x5bbd12(0x2df)),tgBot[_0x5bbd12(0x24e)](settings[_0x5bbd12(0x2d2)],_0x5bbd12(0x2a4),{'parse_mode':_0x5bbd12(0x38b),'reply_markup':{'inline_keyboard':[[{'text':_0x5bbd12(0x365),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x5bbd12(0x22d)](_0x8f0144=>{telegramError(_0x8f0144);}),tgBot['on'](_0x5bbd12(0x2df),async _0x2831a4=>{const _0xbc6841=_0x5bbd12,_0x4f50b0=_0x2831a4[_0xbc6841(0x272)],_0x3596a2=_0x2831a4['message'];tgBot[_0xbc6841(0x273)](_0x2831a4['id'])[_0xbc6841(0x3b0)](async()=>{const _0x659af4=_0xbc6841;if(_0x4f50b0!='no'){const _0x593068=0xf,_0xec54fc=_0x659af4(0x334),_0x19240f=Array['from'](crypto[_0x659af4(0x26d)](new Uint32Array(_0x593068)))[_0x659af4(0x336)](_0xc8b148=>_0xec54fc[_0xc8b148%_0xec54fc[_0x659af4(0x203)]])[_0x659af4(0x35d)](''),_0x4ef81e=bcrypt['hashSync'](_0x19240f,saltRounds);storeSettings({'bbPassword':_0x4ef81e}),await tgBot[_0x659af4(0x24e)](_0x3596a2[_0x659af4(0x287)]['id'],_0x659af4(0x20d)+_0x19240f,{'parse_mode':_0x659af4(0x38b)})[_0x659af4(0x22d)](_0x3f97a8=>{telegramError(_0x3f97a8);});}else await tgBot[_0x659af4(0x24e)](_0x3596a2['chat']['id'],'Password\x20reset\x20rejected')[_0x659af4(0x22d)](_0xa6463a=>{telegramError(_0xa6463a);});}),tgBot[_0xbc6841(0x249)](_0xbc6841(0x2df));}));}async function confirmRestore(_0x213dcc,_0x35f2c5){const _0x20b02e=_0x47280c;io['to'](_0x20b02e(0x345))[_0x20b02e(0x331)](_0x20b02e(0x25d),_0x20b02e(0x200),'success'),tgBot&&settings[_0x20b02e(0x2d2)]&&(tgBot[_0x20b02e(0x249)](_0x20b02e(0x2df)),await tgBot[_0x20b02e(0x24e)](settings[_0x20b02e(0x2d2)],_0x20b02e(0x389),{'parse_mode':_0x20b02e(0x38b),'reply_markup':{'inline_keyboard':[[{'text':_0x20b02e(0x365),'callback_data':_0x20b02e(0x365)},{'text':'no','callback_data':'no'}]]}})[_0x20b02e(0x22d)](_0x416cbd=>{telegramError(_0x416cbd);}),tgBot['on']('callback_query',async _0x11d7da=>{const _0x5c2a50=_0x20b02e,_0x15acc5=_0x11d7da['data'],_0x3e54b5=_0x11d7da[_0x5c2a50(0x2c4)];tgBot[_0x5c2a50(0x273)](_0x11d7da['id'])[_0x5c2a50(0x3b0)](async()=>{const _0x1420d4=_0x5c2a50;_0x15acc5==_0x1420d4(0x365)?(await tgBot[_0x1420d4(0x24e)](_0x3e54b5[_0x1420d4(0x287)]['id'],_0x1420d4(0x380),{'parse_mode':_0x1420d4(0x38b)})[_0x1420d4(0x22d)](_0x2e6d92=>{telegramError(_0x2e6d92);}),unzipFile(_0x213dcc,_0x35f2c5)):(logger['debug'](_0x1420d4(0x39c)),await tgBot[_0x1420d4(0x24e)](_0x3e54b5['chat']['id'],_0x1420d4(0x39c))['catch'](_0x2037ec=>{telegramError(_0x2037ec);}));}),tgBot[_0x5c2a50(0x249)](_0x5c2a50(0x2df));}));}function getServerTime(){const _0x4cc2cd=_0x47280c,_0x11d039=new Date();return _0x11d039[_0x4cc2cd(0x3c0)]()+'/'+(_0x11d039['getMonth']()+0x1)[_0x4cc2cd(0x2c7)]()[_0x4cc2cd(0x360)](0x2,'0')+'/'+_0x11d039[_0x4cc2cd(0x35a)]()[_0x4cc2cd(0x2c7)]()[_0x4cc2cd(0x360)](0x2,'0')+'\x20'+_0x11d039[_0x4cc2cd(0x276)]()[_0x4cc2cd(0x2c7)]()['padStart'](0x2,'0')+':'+_0x11d039[_0x4cc2cd(0x299)]()[_0x4cc2cd(0x2c7)]()['padStart'](0x2,'0')+':'+_0x11d039[_0x4cc2cd(0x325)]()[_0x4cc2cd(0x2c7)]()[_0x4cc2cd(0x360)](0x2,'0');}function getTimeStamp(){const _0x3a2e30=_0x47280c,_0x37e72e=shiftedTime();return _0x37e72e['getFullYear']()+'/'+(_0x37e72e[_0x3a2e30(0x39a)]()+0x1)['toString']()[_0x3a2e30(0x360)](0x2,'0')+'/'+_0x37e72e[_0x3a2e30(0x35a)]()['toString']()[_0x3a2e30(0x360)](0x2,'0')+'\x20'+_0x37e72e[_0x3a2e30(0x276)]()[_0x3a2e30(0x2c7)]()[_0x3a2e30(0x360)](0x2,'0')+':'+_0x37e72e[_0x3a2e30(0x299)]()[_0x3a2e30(0x2c7)]()[_0x3a2e30(0x360)](0x2,'0')+':'+_0x37e72e['getSeconds']()[_0x3a2e30(0x2c7)]()[_0x3a2e30(0x360)](0x2,'0');}function getCleanTimeStamp(){const _0x1870a5=_0x47280c,_0x11ab88=shiftedTime();return _0x11ab88[_0x1870a5(0x3c0)]()+(_0x11ab88[_0x1870a5(0x39a)]()+0x1)[_0x1870a5(0x2c7)]()[_0x1870a5(0x360)](0x2,'0')+_0x11ab88['getDate']()['toString']()[_0x1870a5(0x360)](0x2,'0')+'-'+_0x11ab88[_0x1870a5(0x276)]()[_0x1870a5(0x2c7)]()[_0x1870a5(0x360)](0x2,'0')+_0x11ab88[_0x1870a5(0x299)]()[_0x1870a5(0x2c7)]()[_0x1870a5(0x360)](0x2,'0')+_0x11ab88[_0x1870a5(0x325)]()[_0x1870a5(0x2c7)]()[_0x1870a5(0x360)](0x2,'0');}function shiftedTime(){const _0x2a4426=_0x47280c,_0x429dab=new Date();let _0xd3039b=_0x429dab;if(settings[_0x2a4426(0x335)]&&settings[_0x2a4426(0x335)]!==0x0)_0xd3039b=fns[_0x2a4426(0x293)](_0x429dab,{'hours':settings[_0x2a4426(0x335)]});return _0xd3039b;}function startScheduler(){const _0x402b24=_0x47280c,_0x786abb=new Date()['getUTCHours'](),_0x5b82c6=shiftedTime()[_0x402b24(0x276)]();_0x5b82c6==0x4&&backupConfigFiles();_0x5b82c6==0x0&&rotateLogFiles();_0x786abb%0x6==0x0&&triggerAnalytics();_0x786abb%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xc7f118){const _0x5bf2bc=_0x47280c;logger[_0x5bf2bc(0x254)](_0x5bf2bc(0x284)+_0xc7f118);const _0x5f3039=getBotsWithMode();_0x5f3039[_0x5bf2bc(0x203)]>0x0?confirmRestore(configbackuppath,_0xc7f118):unzipFile(configbackuppath,_0xc7f118);}async function getBackupFiles(_0x5f5138=null){const _0x5932fb=_0x47280c;let _0x3ae7af=[],_0x54ccf0=fs[_0x5932fb(0x26b)](configbackuppath,{'withFileTypes':!![]});_0x54ccf0[_0x5932fb(0x258)]((_0x5e3c8f,_0x1f8af7)=>_0x5e3c8f[_0x5932fb(0x2a8)]<_0x1f8af7['name']?0x1:_0x1f8af7[_0x5932fb(0x2a8)]<_0x5e3c8f[_0x5932fb(0x2a8)]?-0x1:0x0),_0x54ccf0[_0x5932fb(0x2fa)](_0x4864ab=>{const _0x5a12e7=_0x5932fb;if(!_0x4864ab['isDirectory']()&&_0x4864ab[_0x5a12e7(0x2a8)][_0x5a12e7(0x3b7)](_0x5a12e7(0x318))&&_0x4864ab['name'][_0x5a12e7(0x2ea)](_0x5a12e7(0x398))){const _0x3af3ef=formatDate(fs[_0x5a12e7(0x290)](configbackuppath+_0x4864ab['name'])[_0x5a12e7(0x213)]);_0x3ae7af[_0x5a12e7(0x34a)]({'name':_0x4864ab[_0x5a12e7(0x2a8)],'mtime':_0x3af3ef});}});if(_0x5f5138)io['to'](_0x5f5138)['emit'](_0x5932fb(0x1f2),_0x3ae7af);else return _0x3ae7af;}async function backupConfigFiles(){const _0x3b90e2=_0x47280c;await zipFiles(_0x3b90e2(0x363));const _0x408f0c=getCleanTimeStamp();fs[_0x3b90e2(0x34c)](zippath+'backup-full.zip',configbackuppath+(_0x3b90e2(0x318)+_0x408f0c+'.zip'));let _0x24d6f9=fs[_0x3b90e2(0x26b)](configbackuppath,{'withFileTypes':!![]});_0x24d6f9['sort']((_0x3a6b88,_0x3644ff)=>_0x3a6b88['name']<_0x3644ff[_0x3b90e2(0x2a8)]?0x1:_0x3644ff[_0x3b90e2(0x2a8)]<_0x3a6b88[_0x3b90e2(0x2a8)]?-0x1:0x0),_0x24d6f9[_0x3b90e2(0x203)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x24d6f9[_0x24d6f9[_0x3b90e2(0x203)]-0x1]['name']);}function rotateLogFiles(){const _0x2288d4=_0x47280c,_0x183e13=fs[_0x2288d4(0x290)](logspath+'output-000.log'),_0x25140a=_0x183e13[_0x2288d4(0x2de)]/0x400;if(_0x25140a>0x64){let _0x26f0c7=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x26f0c7['sort']((_0xed311c,_0xb43930)=>_0xed311c[_0x2288d4(0x2a8)]<_0xb43930[_0x2288d4(0x2a8)]?0x1:_0xb43930[_0x2288d4(0x2a8)]<_0xed311c[_0x2288d4(0x2a8)]?-0x1:0x0),_0x26f0c7[_0x2288d4(0x2fa)](_0x3a772c=>{const _0x52a8c1=_0x2288d4;if(_0x3a772c[_0x52a8c1(0x2a8)]==_0x52a8c1(0x397))fs['copyFileSync'](logspath+_0x3a772c[_0x52a8c1(0x2a8)],logspath+'output-003.log');if(_0x3a772c[_0x52a8c1(0x2a8)]==_0x52a8c1(0x3b8))fs[_0x52a8c1(0x34c)](logspath+_0x3a772c['name'],logspath+_0x52a8c1(0x397));_0x3a772c[_0x52a8c1(0x2a8)]==_0x52a8c1(0x384)&&(fs[_0x52a8c1(0x34c)](logspath+_0x3a772c[_0x52a8c1(0x2a8)],logspath+_0x52a8c1(0x3b8)),fs[_0x52a8c1(0x35e)](logspath+_0x3a772c['name'],''));});}}async function zipFiles(_0x29f023){const _0x156f60=_0x47280c;let _0xae88a;if(_0x29f023==_0x156f60(0x2f8))_0xae88a=logspath;if(_0x29f023==_0x156f60(0x319))_0xae88a=configpath;if(_0x29f023==_0x156f60(0x363))_0xae88a=configpath;let _0x4ec62b=fs[_0x156f60(0x26b)](_0xae88a,{'withFileTypes':!![]});const _0x22707d=new require(_0x156f60(0x357))();_0x4ec62b[_0x156f60(0x2fa)](_0x1d3e05=>{const _0x1e403e=_0x156f60;if(!_0x1d3e05[_0x1e403e(0x374)]()){let _0x3cc276=fs[_0x1e403e(0x240)](_0xae88a+_0x1d3e05['name']);if(_0x29f023==_0x1e403e(0x319)){const _0x586126=/^bot-[0-9]{3}-config.json$/,_0x33849f=_0x586126[_0x1e403e(0x221)](_0x1d3e05[_0x1e403e(0x2a8)]);if(_0x33849f){const _0x36f6a4=JSON['parse'](_0x3cc276);if(_0x36f6a4[_0x1e403e(0x206)][0x0]){_0x36f6a4[_0x1e403e(0x206)][0x0][_0x1e403e(0x3cb)]='***',_0x36f6a4[_0x1e403e(0x206)][0x0][_0x1e403e(0x27d)]='***';if(_0x36f6a4[_0x1e403e(0x206)][0x0]['apiPassword'])_0x36f6a4['bot'][0x0][_0x1e403e(0x27e)]='***';}_0x3cc276=JSON[_0x1e403e(0x277)](_0x36f6a4,null,0x2);}if(_0x1d3e05[_0x1e403e(0x2a8)]=='bb-settings.json'){const _0x15b929=JSON['parse'](_0x3cc276);if(_0x15b929[_0x1e403e(0x250)][_0x1e403e(0x31e)])_0x15b929[_0x1e403e(0x250)][_0x1e403e(0x31e)]=![];if(_0x15b929[_0x1e403e(0x250)][_0x1e403e(0x211)])_0x15b929['settings'][_0x1e403e(0x211)]=_0x1e403e(0x329);if(_0x15b929['settings'][_0x1e403e(0x3ce)])_0x15b929[_0x1e403e(0x250)]['telegramToken']=_0x1e403e(0x329);if(_0x15b929[_0x1e403e(0x250)]['telegramChatId'])_0x15b929[_0x1e403e(0x250)]['telegramChatId']=null;_0x3cc276=JSON['stringify'](_0x15b929,null,0x2);}if(_0x1d3e05[_0x1e403e(0x2a8)]!=_0x1e403e(0x371))_0x22707d[_0x1e403e(0x3af)](_0x1d3e05[_0x1e403e(0x2a8)],_0x3cc276);}else _0x22707d[_0x1e403e(0x3af)](_0x1d3e05[_0x1e403e(0x2a8)],_0x3cc276);}});const _0x3dcbec=_0x22707d[_0x156f60(0x2b5)]({'base64':![],'compression':'DEFLATE'});fs[_0x156f60(0x35e)](zippath+(_0x29f023+_0x156f60(0x398)),_0x3dcbec,_0x156f60(0x332));}async function unzipFile(_0x3648d7,_0x2c9c56){const _0x14e5d8=_0x47280c;fs[_0x14e5d8(0x26b)](configpath,{'withFileTypes':!![]})['forEach'](_0x27dfc6=>{const _0x215f25=_0x14e5d8;if(!_0x27dfc6['isDirectory']())fs['rmSync'](configpath+_0x27dfc6[_0x215f25(0x2a8)]);});const _0x2de863=fs[_0x14e5d8(0x240)](_0x3648d7+_0x2c9c56,_0x14e5d8(0x332)),_0x10729d=new require('node-zip')(_0x2de863,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x10729d[_0x14e5d8(0x313)])[_0x14e5d8(0x2fa)](_0x4ca4b9=>{const _0x326802=_0x14e5d8,_0x3d3b60=_0x10729d[_0x326802(0x313)][_0x4ca4b9];fs['writeFileSync'](configpath+_0x3d3b60['name'],_0x3d3b60[_0x326802(0x3c4)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x14e5d8(0x2fa)](_0x98972=>{const _0x5cc4db=_0x14e5d8;if(!_0x98972[_0x5cc4db(0x374)]())fs[_0x5cc4db(0x37b)](temppath+_0x98972[_0x5cc4db(0x2a8)]);}),logger[_0x14e5d8(0x254)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x14e5d8(0x352)]({'restore':!![]},_0x36f87e=>{});}async function getPublicIp(){const _0x20365e=_0x47280c;try{const _0xfaaa33=await axios['get'](_0x20365e(0x255));publicip=_0xfaaa33[_0x20365e(0x272)]['ip'];}catch(_0x223bac){}}async function triggerAnalytics(){const _0x317bcd=_0x47280c;if(!publicip)await getPublicIp();const _0xcb5801=getBotsWithMode();let _0x3774cf=0x0;_0xcb5801[_0x317bcd(0x2fa)](_0x4b79f2=>{const _0x9f918=_0x317bcd;if(_0x4b79f2[_0x9f918(0x216)]===_0x9f918(0x2a3))_0x3774cf++;});const _0x287c98=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x317bcd(0x386)],'ip':publicip,'version':serverversion,'numbots':_0xcb5801[_0x317bcd(0x203)],'numbotsenabled':_0x3774cf,'exchanges':_0x287c98});}async function getMessages(){const _0x403bae=_0x47280c,_0x57a400='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x409e66=new GraphQLClient(_0x57a400),_0x4b9660={'authorization':_0x403bae(0x36a)},_0x40364a=serverversion['split']('.'),_0xc867cd=_0x40364a[0x0]+'.'+_0x40364a[0x1],_0xc81c2a=Math[_0x403bae(0x252)](settings[_0x403bae(0x2ff)],settings[_0x403bae(0x2a2)]),_0x16c6c3={'last':parseInt(_0xc81c2a),'bbm':_0xc867cd},_0x4e6e08=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2f6bf9;try{_0x2f6bf9=await _0x409e66[_0x403bae(0x385)](_0x4e6e08,_0x16c6c3,_0x4b9660);}catch(_0x2ed008){}if(_0x2f6bf9&&_0x2f6bf9['messages']){let _0x56a90a=settings[_0x403bae(0x2ff)];newMessages=[];for(const _0x50bb1b of _0x2f6bf9['messages']){newMessages[_0x403bae(0x34a)](_0x50bb1b);if(_0x50bb1b[_0x403bae(0x27f)])updateSetting(_0x403bae(0x2f0),_0x50bb1b['bbvNew']);let _0x321c17=_0x50bb1b['bbvNew']?serverversion>=_0x50bb1b[_0x403bae(0x27f)]:![];if(!_0x321c17&&_0x50bb1b[_0x403bae(0x1f9)]>_0x56a90a){if(_0x50bb1b[_0x403bae(0x285)]==='any'||serverversion[_0x403bae(0x3b7)](_0x50bb1b['bbvReceive'])){let _0x2d7a82=''+_0x50bb1b[_0x403bae(0x387)]+'\x0a\x0a'+_0x50bb1b[_0x403bae(0x2c4)];const _0x1d822a=await sendTelegramMsg(toTelegramMarkdown(_0x2d7a82),_0x403bae(0x3a0));if(_0x1d822a)_0x56a90a=_0x50bb1b[_0x403bae(0x1f9)];}}}updateAvailable=isNewerVersion(settings[_0x403bae(0x2f0)],serverversion),updateSetting('lastmsgtelegram',_0x56a90a),emitMessages();}}function emitMessages(){const _0x5b90af=_0x47280c,_0x22497e=settings[_0x5b90af(0x2a2)];let _0x417be7=[];newMessages[_0x5b90af(0x2fa)](_0x6f4d58=>{const _0x79c84a=_0x5b90af;_0x6f4d58[_0x79c84a(0x1f9)]>_0x22497e&&_0x417be7[_0x79c84a(0x34a)](_0x6f4d58);}),_0x417be7[_0x5b90af(0x203)]>0x0&&getAllClients()[_0x5b90af(0x2fa)](_0x1385a0=>{const _0x140ed6=_0x5b90af;getSocket(_0x1385a0['id'])[_0x140ed6(0x331)](_0x140ed6(0x2c4),_0x417be7);});}function confirmMessage(_0x1ab18f){const _0x2e82a3=_0x47280c;updateSetting(_0x2e82a3(0x2a2),Number(_0x1ab18f));}function isNewerVersion(_0x2b85e9,_0x2f9909){const _0x5a2e4f=_0x47280c,_0x380f1c=_0x2f9909['split']('.'),_0x4b82ec=_0x2b85e9[_0x5a2e4f(0x339)]('.');for(var _0x1999f8=0x0;_0x1999f8<_0x4b82ec[_0x5a2e4f(0x203)];_0x1999f8++){const _0x554e1f=~~_0x4b82ec[_0x1999f8],_0x3cb761=~~_0x380f1c[_0x1999f8];if(_0x554e1f>_0x3cb761)return!![];if(_0x554e1f<_0x3cb761)return![];}return![];}function toTelegramMarkdown(_0x3cad56){const _0x439890=_0x47280c,_0x3bf23d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1c9083=/\*{2}(.+?)\*{2}/gim;return _0x3cad56=_0x3cad56['replace'](_0x3bf23d,_0x439890(0x3bb))[_0x439890(0x1f3)](_0x1c9083,'*$1*'),_0x3cad56;}async function validateConfigFile(){const _0x53b655=_0x47280c,_0x4ecf03=dbConfig[_0x53b655(0x2b0)](_0x53b655(0x228))['sortBy']('botID')[_0x53b655(0x304)]()||[];if(_0x4ecf03[_0x53b655(0x203)]==0x0){let _0x4659d0=0x0,_0x12e1b8=[];const _0x4cda12=/^bot-([0-9]{3})-config.json$/,_0x53c5a6=fs[_0x53b655(0x26b)](configpath);_0x53c5a6[_0x53b655(0x2fa)](_0x153db9=>{const _0x2910de=_0x53b655,_0xb032af=_0x4cda12['exec'](_0x153db9);if(_0xb032af){const _0x8c4308=_0xb032af[0x1];let _0x4f3d9f=getBotAttributes(_0x8c4308);_0x12e1b8['push']({'botID':_0x8c4308,'botname':_0x4f3d9f['botname'],'status':_0x2910de(0x37e),'live':_0x2910de(0x223)}),_0x4659d0++;}}),_0x4659d0!=0x0&&(dbConfig[_0x53b655(0x2b0)](_0x53b655(0x228))['assign'](_0x12e1b8)[_0x53b655(0x341)](),config=_0x12e1b8,restoredConfigFile=_0x4659d0);}}async function restoreConfigNotify(_0x485f43){const _0x5d1c7f=_0x47280c;let _0x5b1f1c;if(restoredConfigFile==0x1)_0x5b1f1c=_0x5d1c7f(0x22f);else _0x5b1f1c=_0x5d1c7f(0x205);if(_0x485f43)io['to'](_0x5d1c7f(0x345))[_0x5d1c7f(0x331)](_0x5d1c7f(0x25d),_0x5b1f1c);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x5d1c7f(0x25a)](_0x5b1f1c),logger[_0x5d1c7f(0x25a)](_0x5d1c7f(0x30f)),logger['simple']('');if(tgBot&&settings[_0x5d1c7f(0x2d2)]&&settings[_0x5d1c7f(0x1ef)]!=_0x5d1c7f(0x283))tgBot['sendMessage'](settings[_0x5d1c7f(0x2d2)],_0x5d1c7f(0x2db)+_0x5b1f1c)[_0x5d1c7f(0x22d)](_0x21d7df=>{telegramError(_0x21d7df);});}}function validateCredentials(_0x32d653,_0x441f56){const _0x3780ed=_0x47280c;if(_0x32d653['username']==settings[_0x3780ed(0x373)]&&bcrypt[_0x3780ed(0x2d7)](_0x32d653[_0x3780ed(0x27c)],settings[_0x3780ed(0x211)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x3780ed(0x29e),'token':null};else{const _0x16106e=generateLoginToken(_0x441f56);return{'allow':!![],'reason':_0x3780ed(0x37c),'token':_0x16106e};}}else return{'allow':![],'reason':_0x3780ed(0x296),'token':null};}function refreshToken(_0x4b77ce){const _0x5d5c14=_0x47280c,_0x102d56=generateLoginToken(_0x4b77ce);return{'allow':!![],'reason':_0x5d5c14(0x37c),'token':_0x102d56};}function validateAccess(_0x933063,_0x216aab,_0xd65fe2){const _0x35095b=_0x47280c,_0x161982=_0xd65fe2?_0xd65fe2:devices[_0x216aab]['ip'];let _0xe2cf23;const _0x28fa5d=_0xdb7e61=>{const _0x247f44=_0x3f24;if(settings[_0x247f44(0x31e)]){if(settings[_0x247f44(0x37a)]){if(telegram2FaApproved(_0x216aab)){const _0x1368f2=generateLoginToken(_0x216aab);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1368f2};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0xe2cf23=validToken(_0xdb7e61,_0x216aab),_0xe2cf23[_0x247f44(0x369)]('success')?{'allow':!![],'reason':_0x247f44(0x3bf),'token':_0xdb7e61}:{'allow':![],'reason':_0x247f44(0x27b),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x35095b(0x218)]){let _0x2b43ef=[...settings['whitelist'],'::1',_0x35095b(0x316),_0x35095b(0x343)];if(_0x2b43ef[_0x35095b(0x21e)](_0x161982))return _0x28fa5d(_0x933063);else{_0xe2cf23=validToken(_0x933063,_0x216aab);if(_0xe2cf23[_0x35095b(0x369)]('success'))return _0x28fa5d(_0x933063);else{if(telegramIpApproved(_0x216aab)){const _0x51a7d7=generateToken(_0x216aab);return _0xe2cf23=_0x28fa5d(_0x933063),_0xe2cf23[_0x35095b(0x2ae)]?{'allow':!![],'reason':_0x35095b(0x2f2),'token':_0x51a7d7}:_0xe2cf23;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x35095b(0x20a),'token':null}:{'allow':![],'reason':_0x35095b(0x2f9),'token':null};}}}else return _0x28fa5d(_0x933063);}function timelyDecrypt(_0x3518ca,_0x434a3d=!![]){const _0x48f158=_0x47280c;if(_0x3518ca)try{const _0x4b12f8=crypt[_0x48f158(0x2b2)](secure['privateKey'],_0x3518ca)[_0x48f158(0x2c4)],_0x3e22df=_0x4b12f8[_0x48f158(0x339)]('@')[0x0],_0x3d5734=_0x4b12f8[_0x48f158(0x339)]('@')[0x1],_0x28dc9a=new Date()[_0x48f158(0x274)]();if(_0x434a3d){if(_0x28dc9a-_0x3d5734<maxSecretAge*0x3e8)return _0x3e22df;else return![];}else return _0x3e22df;}catch(_0x280952){return![];}else return![];}const validToken=(_0x5cb2d4,_0x22e10d)=>{const _0x5a627b=_0x47280c,_0x4721f1=devices[_0x22e10d]['ip'];if(!_0x5cb2d4)return{'error':_0x5a627b(0x2af)};for(let _0x187300 of blacklist){if(_0x187300[_0x5a627b(0x32a)]==_0x5cb2d4)return{'error':'Token\x20blacklisted'};}let _0xb2a989;try{_0xb2a989=jwt[_0x5a627b(0x2f7)](_0x5cb2d4,secure[_0x5a627b(0x2d1)]+_0x22e10d);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0xb2a989[_0x5a627b(0x369)](_0x5a627b(0x3c9))&&!_0xb2a989['hasOwnProperty']('username')||!_0xb2a989[_0x5a627b(0x369)](_0x5a627b(0x29c)))return{'error':_0x5a627b(0x2f4)};if(!_0xb2a989[_0x5a627b(0x369)](_0x5a627b(0x22e))&&_0xb2a989[_0x5a627b(0x369)](_0x5a627b(0x3c9))){const {clientip:_0x3825ed}=_0xb2a989;return _0x4721f1==_0x3825ed?{'success':_0x5a627b(0x231)}:{'error':_0x5a627b(0x227)};}else{if(_0xb2a989[_0x5a627b(0x369)](_0x5a627b(0x22e))&&_0xb2a989[_0x5a627b(0x369)](_0x5a627b(0x3c9))){const {username:_0x1cd474,clientip:_0xe045e0}=_0xb2a989;return settings['bbUsername']==_0x1cd474&&_0x4721f1==_0xe045e0?{'success':_0x5a627b(0x231)}:{'error':_0x5a627b(0x22c)};}}},generateLoginToken=_0x1bcc3a=>{const _0x3f7e74=_0x47280c;if(_0x1bcc3a){const _0x1e631c=devices[_0x1bcc3a]['ip'];return jwt['sign']({'username':settings[_0x3f7e74(0x373)],'clientip':_0x1e631c},secure[_0x3f7e74(0x2d1)]+_0x1bcc3a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1733ac=>{const _0x360ca=_0x47280c;if(_0x1733ac){const _0x4ee481=devices[_0x1733ac]['ip'];return jwt[_0x360ca(0x209)]({'clientip':_0x4ee481},secure['secret']+_0x1733ac,{'expiresIn':devices[_0x1733ac][_0x360ca(0x38f)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x143fc3=>{const _0x317f22=_0x47280c;let _0x4d9b38=![];return devices[_0x143fc3][_0x317f22(0x38f)]&&devices[_0x143fc3][_0x317f22(0x38f)][_0x317f22(0x28e)]!=_0x317f22(0x25b)&&(_0x4d9b38=devices[_0x143fc3][_0x317f22(0x38f)][_0x317f22(0x3c9)]==devices[_0x143fc3]['ip']&&new Date()['getTime']()-devices[_0x143fc3]['telegramIpApproval'][_0x317f22(0x39f)]<devices[_0x143fc3][_0x317f22(0x38f)]['expiry']*0x3c*0x3e8),_0x4d9b38;},telegram2FaApproved=_0x22fac1=>{const _0x1e6ff1=_0x47280c;let _0x43b5ba=![];return devices[_0x22fac1][_0x1e6ff1(0x2b9)]&&devices[_0x22fac1]['telegram2FaApproval'][_0x1e6ff1(0x28e)]!=_0x1e6ff1(0x25b)&&(_0x43b5ba=devices[_0x22fac1][_0x1e6ff1(0x2b9)][_0x1e6ff1(0x3c9)]==devices[_0x22fac1]['ip']&&new Date()['getTime']()-devices[_0x22fac1][_0x1e6ff1(0x2b9)][_0x1e6ff1(0x39f)]<devices[_0x22fac1][_0x1e6ff1(0x2b9)]['expiry']*0x3c*0x3e8),_0x43b5ba;},normalizeIP=_0x33c206=>{const _0x2f4982=_0x47280c;let _0x270571=null,_0xac735c=null;if(ipaddr[_0x2f4982(0x245)](_0x33c206)){const _0x240ef7=ipaddr[_0x2f4982(0x2eb)](_0x33c206);_0x240ef7['kind']()==='ipv6'?(_0x240ef7['isIPv4MappedAddress']()&&(_0x270571=_0x240ef7[_0x2f4982(0x288)]()[_0x2f4982(0x2c7)]()),_0xac735c=_0x240ef7[_0x2f4982(0x2c7)]()):(_0x270571=_0x240ef7[_0x2f4982(0x2c7)](),_0xac735c=_0x240ef7[_0x2f4982(0x383)]()['toString']());}return{'show':_0x270571?_0x270571:_0xac735c,'store':_0xac735c};};function formatDate(_0x384cad){const _0x16c782=_0x47280c;return _0x384cad[_0x16c782(0x3c0)]()+'/'+(_0x384cad['getMonth']()+0x1)[_0x16c782(0x2c7)]()[_0x16c782(0x360)](0x2,'0')+'/'+_0x384cad[_0x16c782(0x35a)]()[_0x16c782(0x2c7)]()[_0x16c782(0x360)](0x2,'0')+'\x20'+_0x384cad[_0x16c782(0x276)]()[_0x16c782(0x2c7)]()[_0x16c782(0x360)](0x2,'0')+':'+_0x384cad[_0x16c782(0x299)]()['toString']()['padStart'](0x2,'0')+':'+_0x384cad['getSeconds']()['toString']()[_0x16c782(0x360)](0x2,'0');}function sleep(_0x42e5d5){return new Promise(_0x283f72=>setTimeout(_0x283f72,_0x42e5d5));}