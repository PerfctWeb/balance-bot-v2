const _0x4af2cf=_0x2b8a;(function(_0x4e1e6a,_0xa48c57){const _0x54b7f3=_0x2b8a,_0x178b3d=_0x4e1e6a();while(!![]){try{const _0x313bdf=-parseInt(_0x54b7f3(0x1c6))/0x1+-parseInt(_0x54b7f3(0x2a9))/0x2+parseInt(_0x54b7f3(0x17a))/0x3*(parseInt(_0x54b7f3(0x24f))/0x4)+parseInt(_0x54b7f3(0x2b1))/0x5+-parseInt(_0x54b7f3(0x236))/0x6*(-parseInt(_0x54b7f3(0x21c))/0x7)+parseInt(_0x54b7f3(0xed))/0x8+-parseInt(_0x54b7f3(0x114))/0x9;if(_0x313bdf===_0xa48c57)break;else _0x178b3d['push'](_0x178b3d['shift']());}catch(_0x55e2a2){_0x178b3d['push'](_0x178b3d['shift']());}}}(_0x10cb,0x44d1f));const _0x3aa78a=function(){let _0x1a2d60=!![];return function(_0x13166a,_0x1014a1){const _0x77b4c6=_0x1a2d60?function(){const _0x4e9588=_0x2b8a;if(_0x1014a1){const _0x5344ba=_0x1014a1[_0x4e9588(0x2b4)](_0x13166a,arguments);return _0x1014a1=null,_0x5344ba;}}:function(){};return _0x1a2d60=![],_0x77b4c6;};}(),_0x28f638=_0x3aa78a(this,function(){const _0x4be461=_0x2b8a;return _0x28f638[_0x4be461(0x194)]()[_0x4be461(0x26e)]('(((.+)+)+)+$')['toString']()[_0x4be461(0x109)](_0x28f638)[_0x4be461(0x26e)](_0x4be461(0x10a));});_0x28f638();'use strict';process[_0x4af2cf(0x257)][_0x4af2cf(0x215)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x4af2cf(0x1b0)),low=require(_0x4af2cf(0x11a)),FileSync=require(_0x4af2cf(0x1bd)),path=require('path'),crypto=require(_0x4af2cf(0x1fd)),Crypt=require('hybrid-crypto-js')[_0x4af2cf(0x1ab)],RSA=require('hybrid-crypto-js')[_0x4af2cf(0x1ff)],bcrypt=require('bcryptjs'),jwt=require(_0x4af2cf(0x237)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x4af2cf(0x145)][_0x4af2cf(0x23c)](0x2))[_0x4af2cf(0x145)],uuidRandom=require(_0x4af2cf(0xf3)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x4af2cf(0x1d5)),{GraphQLClient,gql}=require(_0x4af2cf(0x282)),util=require(_0x4af2cf(0x18d)),fileUpload=require(_0x4af2cf(0x138)),{networkInterfaces}=require('os'),PORT=argv[_0x4af2cf(0x1e4)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x4af2cf(0x100)](PORT)&&(console[_0x4af2cf(0x255)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x4af2cf(0x185)]||null,userID=argv[_0x4af2cf(0x102)]||'',debugging=argv['d']||![],nodeversion=process[_0x4af2cf(0x256)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x4af2cf(0x115),configfile=_0x4af2cf(0x106),settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x4af2cf(0x297))[_0x4af2cf(0x191)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x4af2cf(0xdc)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x4af2cf(0x22c)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x4af2cf(0x14b),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x4af2cf(0x130),zippath=userID?bbpath+_0x4af2cf(0x1ba)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x4af2cf(0x2b0)](logspath+_0x4af2cf(0x27f),{'flags':'a'}),temppath=userID?bbpath+_0x4af2cf(0x195)+userID+'/':bbpath+'temp/';!fs[_0x4af2cf(0xdc)](configpath)&&fs[_0x4af2cf(0x1a2)](configpath);function _0x2b8a(_0x2bee13,_0x37e007){const _0x11493c=_0x10cb();return _0x2b8a=function(_0x28f638,_0x3aa78a){_0x28f638=_0x28f638-0xd7;let _0x10cb7b=_0x11493c[_0x28f638];return _0x10cb7b;},_0x2b8a(_0x2bee13,_0x37e007);}!fs['existsSync'](configbackuppath)&&fs[_0x4af2cf(0x1a2)](configbackuppath);!fs[_0x4af2cf(0xdc)](logspath)&&fs[_0x4af2cf(0x1a2)](logspath);!fs[_0x4af2cf(0xdc)](zippath)&&fs[_0x4af2cf(0x1a2)](zippath);!fs[_0x4af2cf(0xdc)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4af2cf(0x1e3)]({'bots':[]})[_0x4af2cf(0xda)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4af2cf(0x1e3)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4af2cf(0x26a),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4af2cf(0x1e3)]({'secure':{},'blacklist':[]})[_0x4af2cf(0xda)]();let crypt=new Crypt({'md':_0x4af2cf(0x134),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x4af2cf(0x104)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4af2cf(0x289)]&&settings[_0x4af2cf(0x289)]!=''&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0xbff271,_0x505720)=>{const _0x112515=_0x4af2cf,_0x39adcb=/#[A-Z]{3}#/g;if(typeof _0xbff271==_0x112515(0x1a3)){!_0x505720?_0xbff271=_0xbff271['replace'](_0x39adcb,''):(_0xbff271=_0xbff271['replace'](/#BLU#/g,_0x112515(0x183)),_0xbff271=_0xbff271['replace'](/#RED#/g,_0x112515(0x1ae)),_0xbff271=_0xbff271[_0x112515(0xfc)](/#YEL#/g,_0x112515(0x12c)),_0xbff271=_0xbff271[_0x112515(0xfc)](/#MAG#/g,'\x1b[35m'),_0xbff271=_0xbff271[_0x112515(0xfc)](/#CYA#/g,_0x112515(0x162)),_0xbff271=_0xbff271[_0x112515(0xfc)](/#RES#/g,_0x112515(0x1f9)));;}return _0xbff271;},logger={'screen':_0x3043ed=>{console['log'](parseColor(_0x3043ed,!![]));},'simple':_0x1b6041=>{const _0x34e139=_0x4af2cf;console['log'](parseColor(_0x1b6041,!![])),loggerfile[_0x34e139(0xda)](util[_0x34e139(0x129)](parseColor(_0x1b6041,![]))+'\x0a');},'full':async _0x50150e=>{const _0x49d961=_0x4af2cf,_0x13767c=getTimeStamp()+_0x49d961(0x239)+_0x50150e;console[_0x49d961(0x255)](parseColor(_0x13767c,!![])),loggerfile[_0x49d961(0xda)](util['format'](parseColor(_0x13767c,![]))+'\x0a');if(tgBot&&settings[_0x49d961(0x245)]&&settings[_0x49d961(0x269)]!=_0x49d961(0x27d))await tgBot[_0x49d961(0x163)](settings[_0x49d961(0x245)],_0x49d961(0x267)+parseColor(_0x50150e,![]))[_0x49d961(0x128)](_0x4cb1f4=>{telegramError(_0x4cb1f4);});},'debug':async(_0x19a922,_0x23f513='')=>{const _0x204618=_0x4af2cf,_0x5a4121=getTimeStamp()+_0x204618(0xf6)+_0x19a922;if(debugging)console[_0x204618(0x255)](parseColor(_0x5a4121,!![]));loggerfile[_0x204618(0xda)](util[_0x204618(0x129)](parseColor(_0x5a4121,![]))+'\x0a');if(_0x23f513){if(debugging)console[_0x204618(0x255)](_0x23f513);loggerfile['write'](util[_0x204618(0x129)](_0x23f513)+'\x0a');}}};process['on'](_0x4af2cf(0x189),function(_0x5a5426){const _0x4dfb73=_0x4af2cf;logger[_0x4dfb73(0x17e)](_0x5a5426);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4af2cf(0x297))[_0x4af2cf(0x229)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4af2cf(0x1d7)),app=express(),http=require(_0x4af2cf(0x1b9))['createServer'](app);app[_0x4af2cf(0x26d)](fileUpload({'useTempFiles':!![]})),app[_0x4af2cf(0x21e)](_0x4af2cf(0x147),async(_0x42eb6a,_0x14ccd1)=>{const _0x3ab717=_0x4af2cf,_0x3f69ea=_0x42eb6a[_0x3ab717(0x169)][_0x3ab717(0x1d9)],_0x3b021c=getClientsWithBotID('botmanager'),_0x192e4f=_0x42eb6a[_0x3ab717(0x249)]['uuid'],_0x3e0eb2=timelyDecrypt(_0x192e4f,![]),_0x62a8e3=_0x3b021c[_0x3ab717(0xec)](_0x38af3a=>_0x38af3a[_0x3ab717(0xe0)]==_0x3e0eb2);if(_0x62a8e3){const _0x1bb231=normalizeIP(_0x42eb6a[_0x3ab717(0x1d2)][_0x3ab717(0x270)])[_0x3ab717(0x181)],_0x3a4ad6=_0x42eb6a[_0x3ab717(0x249)][_0x3ab717(0x2bc)];if(validateAccess(_0x3a4ad6,_0x3e0eb2,_0x1bb231)[_0x3ab717(0x211)])_0x3f69ea==_0x3ab717(0x29e)&&await backupConfigFiles(),await zipFiles(_0x3f69ea),_0x14ccd1[_0x3ab717(0x246)](zippath+(_0x3f69ea+'.zip'),_0x53e9a1=>{const _0xd68049=_0x3ab717;_0x53e9a1&&(logger[_0xd68049(0x1a7)]('Failed\x20to\x20download\x20'+_0x3f69ea),logger[_0xd68049(0x17e)](_0x53e9a1));});else logger['full'](_0x3ab717(0xfa)+_0x3f69ea+_0x3ab717(0x165));}else logger[_0x3ab717(0x1a7)](_0x3ab717(0xfa)+_0x3f69ea+_0x3ab717(0x1b3));}),app[_0x4af2cf(0x12f)](_0x4af2cf(0x174),async(_0x3f148e,_0x53e509)=>{const _0x21efd4=_0x4af2cf,_0x249502=getClientsWithBotID(_0x21efd4(0x2b2)),_0x4c191e=_0x3f148e[_0x21efd4(0x249)][_0x21efd4(0xe0)],_0x274b03=timelyDecrypt(_0x4c191e,![]),_0x43c10f=_0x249502['find'](_0x42bb14=>_0x42bb14['uuid']==_0x274b03);logger[_0x21efd4(0x202)](_0x21efd4(0x1ac));if(_0x43c10f){const _0x33b714=normalizeIP(_0x3f148e['socket']['remoteAddress'])['store'],_0x224054=_0x3f148e[_0x21efd4(0x249)]['tkn'];if(validateAccess(_0x224054,_0x274b03,_0x33b714)[_0x21efd4(0x211)]){if(_0x3f148e['files']){const _0x5c74ae=_0x3f148e[_0x21efd4(0x1d8)]['backupfile'];await _0x5c74ae['mv'](temppath+_0x5c74ae[_0x21efd4(0x1d6)]),_0x53e509['send']({'status':!![],'message':_0x21efd4(0x25f)});const _0x296a69=getBotsWithMode();_0x296a69[_0x21efd4(0x190)]>0x0?confirmRestore(temppath,_0x5c74ae[_0x21efd4(0x1d6)]):unzipFile(temppath,_0x5c74ae['name']);}}else logger[_0x21efd4(0x1a7)](_0x21efd4(0x21b));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x4af2cf(0x26d)](express[_0x4af2cf(0x149)](path['join'](__dirname,bbpath2,'build2'))),app['use'](express[_0x4af2cf(0x149)](path[_0x4af2cf(0x1a1)](__dirname,bbpath2,_0x4af2cf(0x121)))),app[_0x4af2cf(0x21e)]('/',function(_0x13b5c2,_0x3abb52){const _0x641543=_0x4af2cf;_0x3abb52[_0x641543(0xdf)](path['join'](__dirname,bbpath2,_0x641543(0x213),_0x641543(0xe9)));}),app['get'](_0x4af2cf(0x2af),function(_0x207c5d,_0x287162){const _0x2a492d=_0x4af2cf;_0x287162[_0x2a492d(0xdf)](path['join'](__dirname,bbpath2,_0x2a492d(0x121),'index.html'));}),app[_0x4af2cf(0x21e)](_0x4af2cf(0x2a6),(_0x443082,_0x112ca5)=>{const _0x59f683=_0x4af2cf;_0x112ca5[_0x59f683(0xdf)](path[_0x59f683(0x1a1)](__dirname,bbpath2,_0x59f683(0x121),_0x59f683(0xe9)));}),app[_0x4af2cf(0x21e)]('/:bot/performance',(_0x4f7e68,_0x5ba115)=>{const _0x5a796b=_0x4af2cf;_0x5ba115[_0x5a796b(0xdf)](path[_0x5a796b(0x1a1)](__dirname,bbpath2,_0x5a796b(0x121),_0x5a796b(0xe9)));}),app[_0x4af2cf(0x21e)](_0x4af2cf(0xf4),(_0x1b5e36,_0x238840)=>{const _0xc3e25f=_0x4af2cf;_0x238840[_0xc3e25f(0xdf)](path['join'](__dirname,bbpath2,_0xc3e25f(0x121),_0xc3e25f(0xe9)));}),app[_0x4af2cf(0x21e)]('/:bot/history',(_0x2d8f39,_0x1b586f)=>{const _0x34b499=_0x4af2cf;_0x1b586f[_0x34b499(0xdf)](path[_0x34b499(0x1a1)](__dirname,bbpath2,'build',_0x34b499(0xe9)));}),app['get'](_0x4af2cf(0x23e),(_0x34ef5c,_0x4f9c75)=>{const _0x9a3644=_0x4af2cf;_0x4f9c75['sendFile'](path[_0x9a3644(0x1a1)](__dirname,bbpath2,_0x9a3644(0x121),_0x9a3644(0xe9)));}),app[_0x4af2cf(0x21e)](_0x4af2cf(0x15c),(_0x33e357,_0x37ac0a)=>{const _0x161fa5=_0x4af2cf;_0x37ac0a[_0x161fa5(0xdf)](path[_0x161fa5(0x1a1)](__dirname,bbpath2,_0x161fa5(0x121),'index.html'));});if(HOST)http[_0x4af2cf(0x11d)](PORT,HOST);else http['listen'](PORT);const io=require(_0x4af2cf(0x14e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x27f2d3=_0x4af2cf;let _0x36fc5b=_0x27f2d3(0x122);const _0x357752=networkInterfaces(),_0x120bcd={};for(const _0x5dd20f of Object['keys'](_0x357752)){for(const _0x1d1cbb of _0x357752[_0x5dd20f]){if((_0x1d1cbb[_0x27f2d3(0x26b)]==_0x27f2d3(0x159)||_0x1d1cbb[_0x27f2d3(0x26b)]==0x4)&&!_0x1d1cbb[_0x27f2d3(0x12e)]){const _0x530c4e=ipaddr[_0x27f2d3(0x1c5)](_0x1d1cbb[_0x27f2d3(0x25d)])[_0x27f2d3(0x1e6)]();_0x530c4e!=_0x27f2d3(0x10d)&&(!_0x120bcd[_0x5dd20f]&&(_0x120bcd[_0x5dd20f]=[]),_0x120bcd[_0x5dd20f][_0x27f2d3(0x266)](_0x1d1cbb['address']),_0x36fc5b=_0x1d1cbb[_0x27f2d3(0x25d)]);}}}return{'serverip':_0x36fc5b,'netinterfaces':_0x120bcd};}async function startServer(){const _0xd0350f=_0x4af2cf,{serverip:_0x2267f5,netinterfaces:_0x597c99}=getServerIP();logger['simple'](''),logger[_0xd0350f(0x17e)]('-----------------------------------------------------------------------------------'),await logger['full'](_0xd0350f(0xdd)+serverversion+_0xd0350f(0x2ae)+(environment==_0xd0350f(0x192)?_0xd0350f(0x24d):'')+'\x0a'+(_0xd0350f(0x126)+PORT+_0xd0350f(0x225))+(_0xd0350f(0x18c)+_0x2267f5+':'+PORT+_0xd0350f(0x22b))),logger['simple'](_0xd0350f(0x285));if(config[_0xd0350f(0x190)]!=0x0)for(const _0x555502 of config){if(_0x555502[_0xd0350f(0x2ad)]==_0xd0350f(0x210)||_0x555502[_0xd0350f(0x2ad)]==_0xd0350f(0x23b))await logger[_0xd0350f(0x1a7)](_0xd0350f(0x150)+_0x555502['botID']+_0xd0350f(0x24b)+_0x555502['botname']),startBot([_0x555502[_0xd0350f(0x17c)],userID],{'cwd':bbpath},function(_0x5c4d82){const _0x1be30=_0xd0350f;if(_0x5c4d82)logger[_0x1be30(0x1a7)](_0x5c4d82);});else(_0x555502['status']==_0xd0350f(0x281)||_0x555502[_0xd0350f(0x2ad)]==_0xd0350f(0xf7))&&await logger[_0xd0350f(0x1a7)](_0xd0350f(0xfb)+_0x555502['botID']+'\x20|\x20'+_0x555502['botname']);}else!newBot&&logger[_0xd0350f(0x17e)](_0xd0350f(0x1d4));if(newBot)addBot();logger[_0xd0350f(0x17e)](_0xd0350f(0x285)),logger[_0xd0350f(0x17e)](''),await logger['debug'](_0xd0350f(0x235)+nodeversion),await logger[_0xd0350f(0x202)](_0xd0350f(0x2c4),_0x597c99);}function startSocket(){const _0x10f94c=_0x4af2cf;io['on'](_0x10f94c(0x164),_0x58f7d9=>{const _0x3db0c5=_0x10f94c;let _0x1f0e89,_0x428117,_0x7e5f19,_0x74bd19,_0x26a981;const _0xf2003=_0x58f7d9[_0x3db0c5(0x29f)][_0x3db0c5(0x249)][_0x3db0c5(0x2ab)];_0x428117=_0xf2003['match'](/bot[0-9]{3}/);if(_0x428117)_0x7e5f19=_0x428117[0x0][_0x3db0c5(0x140)](/[0-9]{3}/);if(_0x7e5f19)_0x1f0e89=_0x7e5f19[0x0];else _0x1f0e89=_0x3db0c5(0x2b2);const _0x41b1e3=_0x58f7d9[_0x3db0c5(0x29f)][_0x3db0c5(0x103)][_0x3db0c5(0x28b)];if(!_0x41b1e3)_0x58f7d9[_0x3db0c5(0x22e)](_0x3db0c5(0x2ad),{'publicKey':secure['publicKey']});else{_0x74bd19=timelyDecrypt(_0x41b1e3,![]);if(!_0x74bd19)_0x58f7d9[_0x3db0c5(0x22e)](_0x3db0c5(0x2ad),{'publicKey':secure['publicKey']});else{_0x26a981=normalizeIP(_0x58f7d9[_0x3db0c5(0x187)]['remoteAddress'])[_0x3db0c5(0x181)];if(!devices[_0x74bd19])devices[_0x74bd19]={'uuid':_0x74bd19,'access':{'token':null}};devices[_0x74bd19]['ip']=_0x26a981;const _0x5a9b23=addClient(_0x58f7d9['id'],_0x74bd19,_0x1f0e89);setAccess(_0x5a9b23),emitMessages(),_0x58f7d9['on'](_0x3db0c5(0x2a0),_0x251519=>{const _0x56f690=_0x3db0c5,_0xaa9932=timelyDecrypt(_0x251519[_0x56f690(0x1ee)]);if(_0xaa9932){_0x251519={'username':_0x251519[_0x56f690(0x1a5)],'password':_0xaa9932},devices[_0x74bd19]['access']=validateCredentials(_0x251519,_0x74bd19);if(devices[_0x74bd19][_0x56f690(0x13c)][_0x56f690(0x211)]==![]&&devices[_0x74bd19][_0x56f690(0x13c)][_0x56f690(0x179)]==_0x56f690(0x132))_0x58f7d9[_0x56f690(0x22e)](_0x56f690(0x2ad),{'access':devices[_0x74bd19][_0x56f690(0x13c)]}),loginAccess2FA(_0x74bd19,_0x26a981);else{if(devices[_0x74bd19][_0x56f690(0x13c)]['allow']==![]&&devices[_0x74bd19][_0x56f690(0x13c)][_0x56f690(0x179)]==_0x56f690(0x1b1))_0x58f7d9['emit'](_0x56f690(0x2ad),{'access':devices[_0x74bd19][_0x56f690(0x13c)]});else devices[_0x74bd19][_0x56f690(0x13c)]['allow']&&devices[_0x74bd19][_0x56f690(0x13c)][_0x56f690(0x179)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x74bd19)[_0x56f690(0x2b9)](_0x48a3dd=>{setAccess(_0x48a3dd);}),logger[_0x56f690(0x202)](_0x56f690(0xe7)+_0x74bd19[_0x56f690(0x23c)](-0x8)),setTokenRefresh(_0x74bd19),setSessionTimeout(_0x56f690(0x2a0),_0x74bd19));}}else logger['full'](_0x56f690(0x14a));}),_0x58f7d9['on'](_0x3db0c5(0x1ef),()=>{resetPassword();}),_0x58f7d9['on'](_0x3db0c5(0x1e1),_0x2c2133=>{removeClient(_0x58f7d9['id']);}),_0x1f0e89==_0x3db0c5(0x2b2)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1e581c){const _0x5a7499=_0x4af2cf;if(_0x1e581c!='botmanager'&&config['apiKey']!=''){if(pid[_0x1e581c])pid[_0x1e581c][_0x5a7499(0x218)]({'function':_0x5a7499(0x158),'args':null});}_0x1e581c!=_0x5a7499(0x2b2)&&broadcastToBots(_0x5a7499(0x1d1),JSON['stringify'](config));}function reloadBotManager(){const _0x326acc=_0x4af2cf;getClientsWithBotID(_0x326acc(0x2b2))[_0x326acc(0x2b9)](_0x4594bf=>{const _0x42ef42=_0x326acc;getSocket(_0x4594bf['id'])['emit'](_0x42ef42(0x2ad),{'access':{'allow':![],'reason':_0x42ef42(0xf9),'token':null}});});}function getSocket(_0x3b9fa4){const _0x34ea2e=_0x4af2cf;return io[_0x34ea2e(0x221)][_0x34ea2e(0x221)][_0x34ea2e(0x21e)](_0x3b9fa4);}function setAccess(_0x3f5759){const _0x307280=_0x4af2cf,_0x3617c2=getSocket(_0x3f5759['id']),_0x126249=_0x3f5759[_0x307280(0xe0)],_0x42f9d4=_0x3f5759[_0x307280(0x222)];devices[_0x126249][_0x307280(0x13c)]=validateAccess(devices[_0x126249][_0x307280(0x13c)][_0x307280(0x2a5)],_0x126249),logger[_0x307280(0x202)](_0x307280(0x234)+devices[_0x126249][_0x307280(0x13c)][_0x307280(0x179)]+_0x307280(0x283)+_0x3f5759['id']['slice'](-0x8)+_0x307280(0x2c2)+_0x126249['slice'](-0x8)),_0x3617c2[_0x307280(0x1a1)](_0x126249);if(devices[_0x126249][_0x307280(0x13c)][_0x307280(0x211)]){_0x3617c2[_0x307280(0x1a1)](_0x42f9d4);if(_0x42f9d4=='botmanager')initializeSocketBotManager(_0x3617c2);else initializeSocketBot(_0x3617c2);initClient(_0x42f9d4);}devices[_0x126249]['access'][_0x307280(0x2a5)]&&devices[_0x126249][_0x307280(0x13c)][_0x307280(0x179)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x307280(0x16e),_0x126249),devices[_0x126249][_0x307280(0x13c)]['token']&&devices[_0x126249][_0x307280(0x13c)][_0x307280(0x179)]==_0x307280(0x200)&&setSessionTimeout(_0x307280(0x2a0),_0x126249),_0x3617c2[_0x307280(0x22e)]('status',{'status':_0x3f5759[_0x307280(0x2b3)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x126249][_0x307280(0x13c)],'externalip':devices[_0x126249]['ip'],'publicKey':secure[_0x307280(0x161)],'userid':settings[_0x307280(0x12d)],'validInstallation':validInstallation}),devices[_0x126249][_0x307280(0x13c)][_0x307280(0x211)]==![]&&devices[_0x126249][_0x307280(0x13c)][_0x307280(0x179)]==_0x307280(0x1e9)&&temporaryAccess2FA(_0x126249,devices[_0x126249]['ip']);}function setSessionTimeout(_0x5b5d41,_0x14c148){const _0x34cb8b=_0x4af2cf;let _0x54a7a4;if(_0x5b5d41=='login')_0x54a7a4=loginExpiry*0x3c*0x3e8;else _0x54a7a4=devices[_0x14c148][_0x34cb8b(0x197)][_0x34cb8b(0x113)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x14c148][_0x34cb8b(0x197)][_0x34cb8b(0x260)]);if(devices[_0x14c148][_0x34cb8b(0x1cb)])clearTimeout(devices[_0x14c148][_0x34cb8b(0x1cb)]);devices[_0x14c148][_0x34cb8b(0x1cb)]=setTimeout(()=>{const _0x296d76=_0x34cb8b;if(devices[_0x14c148]['pidRefreshToken'])clearTimeout(devices[_0x14c148]['pidRefreshToken']);removeSocketListeners(_0x14c148),addBlacklist(_0x14c148),devices[_0x14c148][_0x296d76(0x197)]=null,devices[_0x14c148][_0x296d76(0x16b)]=null,devices[_0x14c148][_0x296d76(0x13c)][_0x296d76(0x2a5)]=null,logger[_0x296d76(0x202)](_0x296d76(0xf8)+_0x14c148[_0x296d76(0x23c)](-0x8)),devices[_0x14c148][_0x296d76(0x13c)]=validateAccess(devices[_0x14c148]['access'][_0x296d76(0x2a5)],_0x14c148),!(devices[_0x14c148][_0x296d76(0x13c)][_0x296d76(0x211)]&&devices[_0x14c148][_0x296d76(0x13c)]['reason']==_0x296d76(0x146))&&(_0x5b5d41=='login'?io['to'](_0x14c148)[_0x296d76(0x22e)](_0x296d76(0x2ad),{'access':{'allow':![],'reason':_0x296d76(0xe2),'token':null}}):io['to'](_0x14c148)[_0x296d76(0x22e)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x14c148][_0x296d76(0x13c)]['token']=null;},_0x54a7a4);}function setTokenRefresh(_0x450a){const _0x1a35fa=_0x4af2cf;if(devices[_0x450a][_0x1a35fa(0x2b7)])clearTimeout(devices[_0x450a][_0x1a35fa(0x2b7)]);devices[_0x450a][_0x1a35fa(0x2b7)]=setTimeout(()=>{const _0x3029c4=_0x1a35fa;getClientsWithUuid(_0x450a)['length']!=0x0?(devices[_0x450a][_0x3029c4(0x13c)]=refreshToken(_0x450a),io['to'](_0x450a)[_0x3029c4(0x22e)](_0x3029c4(0x2ad),{'status':_0x3029c4(0x1cf),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x450a]['access'],'externalip':devices[_0x450a]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x450a)):clearTimeout(devices[_0x450a][_0x3029c4(0x2b7)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x55c3c2){const _0x75beb6=_0x4af2cf,_0x565646=getClient(_0x55c3c2['id'])['uuid'];_0x55c3c2['emit'](_0x75beb6(0x1d1),config),_0x55c3c2[_0x75beb6(0x22e)](_0x75beb6(0x205),cleanSettings()),_0x55c3c2['on'](_0x75beb6(0x14f),_0x57b5a5=>{const _0xe4dd04=_0x75beb6;if(validateAccess(_0x57b5a5,_0x565646)[_0xe4dd04(0x211)])addBot();else logger[_0xe4dd04(0x1a7)](_0xe4dd04(0x2a2));}),_0x55c3c2['on'](_0x75beb6(0x178),(_0x597e0a,_0x33ea28)=>{const _0xace566=_0x75beb6;if(validateAccess(_0x33ea28,_0x565646)[_0xace566(0x211)])toggleBot(_0x597e0a[_0xace566(0x17c)],_0x597e0a[_0xace566(0x2ad)],_0x597e0a[_0xace566(0x18e)]);else logger[_0xace566(0x1a7)](_0xace566(0x288));}),_0x55c3c2['on'](_0x75beb6(0x2aa),(_0x55f764,_0x262f93)=>{const _0x5e3898=_0x75beb6;if(validateAccess(_0x262f93,_0x565646)[_0x5e3898(0x211)])toggleBotMode(_0x55f764);else logger[_0x5e3898(0x1a7)](_0x5e3898(0x288));}),_0x55c3c2['on'](_0x75beb6(0x241),(_0x34d630,_0x3ac9c8)=>{const _0x3859e6=_0x75beb6;if(validateAccess(_0x3ac9c8,_0x565646)[_0x3859e6(0x211)])deleteBot(_0x34d630);else logger['full'](_0x3859e6(0x1ca));}),_0x55c3c2['on']('store-settings',(_0x4fc874,_0x486990)=>{const _0x5a1d36=_0x75beb6;if(validateAccess(_0x486990,_0x565646)[_0x5a1d36(0x211)])storeSettings(_0x4fc874,!![]);else logger[_0x5a1d36(0x1a7)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x55c3c2['on'](_0x75beb6(0x125),_0x50964d=>{const _0x10b9a8=_0x75beb6;if(validateAccess(_0x50964d,_0x565646)['allow'])updateBB('update');else logger[_0x10b9a8(0x1a7)](_0x10b9a8(0x1ad));}),_0x55c3c2['on']('reinstall-bb',_0xac21ca=>{const _0xcdb3c=_0x75beb6;if(validateAccess(_0xac21ca,_0x565646)[_0xcdb3c(0x211)])updateBB(_0xcdb3c(0x298));else logger[_0xcdb3c(0x1a7)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x55c3c2['on'](_0x75beb6(0x291),_0x2b1ca6=>{const _0x369a8a=_0x75beb6;if(validateAccess(_0x2b1ca6,_0x565646)[_0x369a8a(0x211)]){const _0x4d4a30=getClient(_0x55c3c2['id']);if(_0x4d4a30)getBackupFiles(_0x4d4a30[_0x369a8a(0xe0)]);else logger['full'](_0x369a8a(0x123));}else logger[_0x369a8a(0x1a7)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x55c3c2['on'](_0x75beb6(0x243),(_0x2d7ad1,_0x1b1bc2)=>{const _0x43fa62=_0x75beb6;if(validateAccess(_0x1b1bc2,_0x565646)[_0x43fa62(0x211)])restoreBackupFile(_0x2d7ad1);else logger[_0x43fa62(0x1a7)](_0x43fa62(0xe3));}),_0x55c3c2['on'](_0x75beb6(0x1dd),_0x1e6e93=>{const _0x15d4aa=_0x75beb6;if(validateAccess(_0x1e6e93,_0x565646)[_0x15d4aa(0x211)])getMessages();else logger[_0x15d4aa(0x1a7)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x55c3c2['on'](_0x75beb6(0x24c),(_0x15684e,_0x41c5e4)=>{const _0x554a7f=_0x75beb6;if(validateAccess(_0x41c5e4,_0x565646)['allow'])confirmMessage(_0x15684e);else logger[_0x554a7f(0x1a7)](_0x554a7f(0x120));}),_0x55c3c2['on'](_0x75beb6(0x176),_0x9c17e2=>{const _0x478053=_0x75beb6;if(validateAccess(_0x9c17e2,_0x565646)[_0x478053(0x211)]){if(devices[_0x565646][_0x478053(0x2b7)])clearTimeout(devices[_0x565646][_0x478053(0x2b7)]);if(devices[_0x565646][_0x478053(0x1cb)])clearTimeout(devices[_0x565646]['pidExpireLogin']);removeSocketListeners(getClient(_0x55c3c2['id'])[_0x478053(0xe0)]),addBlacklist(_0x565646),devices[_0x565646][_0x478053(0x197)]=null,devices[_0x565646][_0x478053(0x16b)]=null,devices[_0x565646][_0x478053(0x13c)][_0x478053(0x2a5)]=null,logger[_0x478053(0x202)]('Logged\x20out\x20user\x20...'+_0x565646[_0x478053(0x23c)](-0x8)),io['to'](getClient(_0x55c3c2['id'])[_0x478053(0xe0)])['emit']('status',{'access':{'allow':![],'reason':_0x478053(0x168),'token':null}});}else logger[_0x478053(0x1a7)](_0x478053(0x11e));});}function initializeSocketBot(_0x5c403f){const _0x5ce735=_0x4af2cf,_0x4871f5=getClient(_0x5c403f['id'])[_0x5ce735(0x222)],_0x47fcca=getClient(_0x5c403f['id'])[_0x5ce735(0xe0)];_0x5c403f['on']('get-logs',(_0xf34142,_0x2f65e3)=>{const _0x340d3a=_0x5ce735;if(validateAccess(_0x2f65e3,_0x47fcca)[_0x340d3a(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x340d3a(0x218)]({'function':_0x340d3a(0x18f),'args':_0xf34142});}else logger[_0x340d3a(0x1a7)](_0x340d3a(0x1e5));}),_0x5c403f['on'](_0x5ce735(0x20b),(_0x37d51d,_0xb0b64)=>{const _0x41c393=_0x5ce735;if(validateAccess(_0xb0b64,_0x47fcca)[_0x41c393(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x41c393(0x218)]({'function':_0x41c393(0x227),'args':_0x37d51d});}else logger[_0x41c393(0x1a7)](_0x41c393(0x23a));}),_0x5c403f['on'](_0x5ce735(0x244),(_0x3b3203,_0x34c512)=>{const _0x1ce0f5=_0x5ce735;if(validateAccess(_0x34c512,_0x47fcca)[_0x1ce0f5(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x1ce0f5(0x218)]({'function':'getPortfolio','args':_0x3b3203});}else logger['full'](_0x1ce0f5(0x27a));}),_0x5c403f['on'](_0x5ce735(0x1b2),(_0x37aecf,_0x170a42)=>{const _0x25549d=_0x5ce735;if(validateAccess(_0x170a42,_0x47fcca)[_0x25549d(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x25549d(0x218)]({'function':_0x25549d(0x17b),'args':_0x37aecf});}else logger[_0x25549d(0x1a7)](_0x25549d(0x272));}),_0x5c403f['on']('store-headless',(_0x2bcb5e,_0x177b32)=>{const _0x20733e=_0x5ce735;if(validateAccess(_0x177b32,_0x47fcca)['allow']){if(pid[_0x4871f5])pid[_0x4871f5]['send']({'function':_0x20733e(0x1c1),'args':_0x2bcb5e});}else logger['full'](_0x20733e(0x286));}),_0x5c403f['on']('store-fiat',(_0x5d62c9,_0x17a41e)=>{const _0x47ec03=_0x5ce735;if(validateAccess(_0x17a41e,_0x47fcca)[_0x47ec03(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x47ec03(0x218)]({'function':_0x47ec03(0x135),'args':_0x5d62c9});}else logger[_0x47ec03(0x1a7)](_0x47ec03(0x20c));}),_0x5c403f['on'](_0x5ce735(0xe8),_0xea3937=>{const _0x5f2fc8=_0x5ce735;if(validateAccess(_0xea3937,_0x47fcca)[_0x5f2fc8(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5]['send']({'function':_0x5f2fc8(0x1f1),'args':null});}else logger['full'](_0x5f2fc8(0x253));}),_0x5c403f['on'](_0x5ce735(0x131),_0x282fe5=>{const _0x10bce1=_0x5ce735;if(validateAccess(_0x282fe5,_0x47fcca)[_0x10bce1(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5]['send']({'function':'getStartingBalances','args':null});}else logger[_0x10bce1(0x1a7)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x5c403f['on']('place-order',(_0x58da86,_0x1d5a9e)=>{const _0x2eb9c0=_0x5ce735;if(validateAccess(_0x1d5a9e,_0x47fcca)[_0x2eb9c0(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x2eb9c0(0x218)]({'function':_0x2eb9c0(0x2ba),'args':_0x58da86});}else logger[_0x2eb9c0(0x1a7)](_0x2eb9c0(0x1f5));}),_0x5c403f['on']('cancel-loading',_0x13eaa6=>{const _0x150df2=_0x5ce735;if(validateAccess(_0x13eaa6,_0x47fcca)[_0x150df2(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x150df2(0x218)]({'function':'cancelLoading','args':null});}else logger[_0x150df2(0x1a7)](_0x150df2(0x15d));}),_0x5c403f['on']('show-config',_0x5deeb8=>{const _0x3f7e27=_0x5ce735;if(validateAccess(_0x5deeb8,_0x47fcca)[_0x3f7e27(0x211)]){if(pid[_0x4871f5])pid[_0x4871f5][_0x3f7e27(0x218)]({'function':_0x3f7e27(0x228),'args':null});}else logger[_0x3f7e27(0x1a7)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x5c403f['on'](_0x5ce735(0x125),_0x4ae866=>{const _0x325f46=_0x5ce735;if(validateAccess(_0x4ae866,_0x47fcca)[_0x325f46(0x211)])updateBB(_0x325f46(0x27c));else logger['full'](_0x325f46(0x1ad));}),_0x5c403f['on'](_0x5ce735(0x1dd),_0x41ba9b=>{const _0x5a09bc=_0x5ce735;if(validateAccess(_0x41ba9b,_0x47fcca)[_0x5a09bc(0x211)])getMessages();else logger[_0x5a09bc(0x1a7)](_0x5a09bc(0x29a));}),_0x5c403f['on'](_0x5ce735(0x24c),(_0x21d8b2,_0x3b8a21)=>{const _0x31286a=_0x5ce735;if(validateAccess(_0x3b8a21,_0x47fcca)[_0x31286a(0x211)])confirmMessage(_0x21d8b2);else logger[_0x31286a(0x1a7)](_0x31286a(0x120));}),_0x5c403f['on']('logout',_0xdf7ccb=>{const _0xac2f5=_0x5ce735;if(validateAccess(_0xdf7ccb,_0x47fcca)[_0xac2f5(0x211)]){if(devices[_0x47fcca][_0xac2f5(0x2b7)])clearTimeout(devices[_0x47fcca]['pidRefreshToken']);if(devices[_0x47fcca][_0xac2f5(0x1cb)])clearTimeout(devices[_0x47fcca][_0xac2f5(0x1cb)]);removeSocketListeners(getClient(_0x5c403f['id'])['uuid']),addBlacklist(_0x47fcca),devices[_0x47fcca][_0xac2f5(0x197)]=null,devices[_0x47fcca][_0xac2f5(0x16b)]=null,devices[_0x47fcca]['access'][_0xac2f5(0x2a5)]=null,logger['debug'](_0xac2f5(0x19d)+_0x47fcca[_0xac2f5(0x23c)](-0x8)),io['to'](getClient(_0x5c403f['id'])[_0xac2f5(0xe0)])[_0xac2f5(0x22e)]('status',{'access':{'allow':![],'reason':_0xac2f5(0x168),'token':null}});}else logger[_0xac2f5(0x1a7)](_0xac2f5(0x11e));});}function removeSocketListeners(_0x1a1f99){const _0x3fc00c=_0x4af2cf;getClientsWithUuid(_0x1a1f99)[_0x3fc00c(0x2b9)](_0x371c7a=>{const _0x286b83=_0x3fc00c;getSocket(_0x371c7a['id'])[_0x286b83(0x12b)]();});}function cleanSettings(){const _0x45f64b=_0x4af2cf;let _0x312643=settings;return settings[_0x45f64b(0x289)]&&settings[_0x45f64b(0x289)]!=''&&(_0x312643={..._0x312643,'telegramToken':_0x45f64b(0x166)}),settings[_0x45f64b(0xeb)]&&settings['bbPassword']!=''&&(_0x312643={..._0x312643,'bbPassword':_0x45f64b(0x166)}),(settings['bbPassword']&&settings[_0x45f64b(0xeb)]==_0x45f64b(0x107)||settings[_0x45f64b(0x289)]&&settings[_0x45f64b(0x289)]==_0x45f64b(0x107))&&(_0x312643={..._0x312643,'restored':{'password':settings['bbPassword']==_0x45f64b(0x107),'telegram':settings[_0x45f64b(0x289)]==_0x45f64b(0x107)}}),_0x312643;}async function updateBB(_0x5d7a72){const _0x1aca80=_0x4af2cf;await backupConfigFiles(),installingUpdate=!![],config[_0x1aca80(0x2b9)](_0x5a9b9=>{restartBot(_0x5a9b9['botID']);});if(_0x5d7a72==_0x1aca80(0x27c))process[_0x1aca80(0x218)]({'update':!![],'environment':environment},_0x30fa6b=>{});else _0x5d7a72==_0x1aca80(0x298)&&process[_0x1aca80(0x218)]({'reinstall':!![],'environment':environment},_0x4241bb=>{});}function startBot(_0x3a06a0,_0x16f2a3,_0x5cf18e){const _0x24d80a=_0x4af2cf;if(debugging)_0x3a06a0[_0x24d80a(0x266)]('-d');let _0x2b413b=![];const _0x3188a2=_0x3a06a0[0x0];_0x16f2a3={..._0x16f2a3,'stdio':[_0x24d80a(0x10f),_0x24d80a(0x10f),_0x24d80a(0x10f),_0x24d80a(0x1f7)]},pid[_0x3188a2]=childProcess[_0x24d80a(0x16d)](botfile,_0x3a06a0,_0x16f2a3),pid[_0x3188a2]['on'](_0x24d80a(0x2a1),_0x3d590e=>{const _0x56a3f6=_0x24d80a;switch(Object[_0x56a3f6(0x280)](_0x3d590e)[0x0]){case _0x56a3f6(0x1fa):updateBotName(_0x3188a2,_0x3d590e[_0x56a3f6(0x1fa)]);break;case _0x56a3f6(0x154):updateBotManager();break;case'status':updateStatus(_0x3188a2,_0x3d590e[_0x56a3f6(0x2ad)]);break;case _0x56a3f6(0x18e):updateLive(_0x3188a2,_0x3d590e[_0x56a3f6(0x18e)]);break;case _0x56a3f6(0x1af):updateLive(_0x3188a2,_0x3d590e[_0x56a3f6(0x1af)]),io['to'](_0x3188a2)[_0x56a3f6(0x22e)](_0x56a3f6(0x2ad),{'access':{'allow':![],'reason':_0x56a3f6(0xf9),'token':null}});break;case _0x56a3f6(0x1e8):_0x3d590e[_0x56a3f6(0x1e8)]==_0x56a3f6(0x252)&&restartBot(_0x3188a2);_0x3d590e[_0x56a3f6(0x1e8)]=='kill'&&toggleBot(_0x3188a2,_0x56a3f6(0x281),_0x56a3f6(0x2c3));break;case _0x56a3f6(0x2a4):sendTelegram(_0x3188a2,_0x3d590e[_0x56a3f6(0x2a4)]);break;case _0x56a3f6(0x208):sendTelegramMsg(_0x3d590e[_0x56a3f6(0x208)]);break;case'function':io['to'](_0x3188a2)[_0x56a3f6(0x22e)](_0x3d590e[_0x56a3f6(0x247)],_0x3d590e[_0x56a3f6(0x206)]);break;}}),pid[_0x3188a2]['on'](_0x24d80a(0x139),function(_0x23e572){if(_0x2b413b)return;_0x2b413b=!![],_0x5cf18e(_0x23e572);}),pid[_0x3188a2]['on']('exit',async function(_0x2f99f8){const _0x4c02f=_0x24d80a;if(installingUpdate)return;if(_0x2b413b)return;_0x2b413b=!![],_0x5cf18e(null);const _0x3e29a4=dbConfig[_0x4c02f(0x21e)]('bots')[_0x4c02f(0xec)]({'botID':_0x3188a2})[_0x4c02f(0x1a4)]();_0x3e29a4&&(_0x3e29a4[_0x4c02f(0x2ad)]==_0x4c02f(0x210)||_0x3e29a4[_0x4c02f(0x2ad)]==_0x4c02f(0x23b))&&(await sleep(0x3e8),updateLive(_0x3188a2,'stopped'),logger[_0x4c02f(0x1a7)]('Restarting\x20Bot\x20'+_0x3188a2),startBot([_0x3188a2,userID],{'cwd':bbpath},function(_0x373f30){const _0x22b1e2=_0x4c02f;if(_0x373f30)logger[_0x22b1e2(0x1a7)](_0x373f30);}));});}function stopBot(_0xd7f1b2){const _0x1f0192=_0x4af2cf;getClientsWithBotID(_0xd7f1b2)[_0x1f0192(0x2b9)](_0x5ae947=>{const _0x41d9d2=_0x1f0192;getSocket(_0x5ae947['id'])[_0x41d9d2(0x1e1)](!![]),removeClient(_0x5ae947['id']);}),pid[_0xd7f1b2]&&(pid[_0xd7f1b2][_0x1f0192(0x273)](),pid[_0xd7f1b2]=null);}function restartBot(_0x23e406){if(pid[_0x23e406])pid[_0x23e406]['kill']();}function addBot(){const _0x1a59a8=_0x4af2cf;let _0x3462e8;for(let _0x150feb=0x1;_0x150feb<0x3e9;_0x150feb++){_0x3462e8=_0x150feb[_0x1a59a8(0x194)]()[_0x1a59a8(0x142)](0x3,'0');let _0x422999=config['find'](_0x11fbbc=>_0x11fbbc['botID']==_0x3462e8);if(!_0x422999)break;}if(_0x3462e8===_0x1a59a8(0x29b)){logger[_0x1a59a8(0x1a7)](_0x1a59a8(0x127));return;}logger[_0x1a59a8(0x1a7)](_0x1a59a8(0x240)+_0x3462e8),dbConfig[_0x1a59a8(0x21e)]('bots')[_0x1a59a8(0x266)]({'botID':_0x3462e8,'botname':_0x1a59a8(0x148)+_0x3462e8,'status':'new','live':''})[_0x1a59a8(0xda)](),startBot([_0x3462e8,userID],{'cwd':bbpath},function(_0x4358b3){const _0x2147c9=_0x1a59a8;if(_0x4358b3)logger[_0x2147c9(0x1a7)](_0x4358b3);}),config=getConfiguration(),io['to']('botmanager')[_0x1a59a8(0x22e)](_0x1a59a8(0x1d1),config),broadcastToBots('bots',JSON[_0x1a59a8(0x278)](config));}function deleteBot(_0x22ad2d){const _0x1c4e07=_0x4af2cf;getClientsWithBotID(_0x22ad2d)[_0x1c4e07(0x2b9)](_0x21c998=>{getSocket(_0x21c998['id'])['disconnect'](!![]),removeClient(_0x21c998['id']);}),dbConfig[_0x1c4e07(0x21e)](_0x1c4e07(0x1d1))[_0x1c4e07(0x16a)]({'botID':_0x22ad2d})[_0x1c4e07(0xda)](),logger[_0x1c4e07(0x1a7)](_0x1c4e07(0x1a0)+_0x22ad2d),stopBot(_0x22ad2d);try{if(fs['existsSync'](path[_0x1c4e07(0x1a1)](configpath,_0x1c4e07(0x1c9)+_0x22ad2d+_0x1c4e07(0x19f))))fs['unlinkSync'](path['join'](configpath,_0x1c4e07(0x1c9)+_0x22ad2d+'-config.json'));if(fs[_0x1c4e07(0xdc)](path[_0x1c4e07(0x1a1)](configpath,_0x1c4e07(0x1c9)+_0x22ad2d+'-events.json')))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x22ad2d+_0x1c4e07(0x19e)));if(fs[_0x1c4e07(0xdc)](path[_0x1c4e07(0x1a1)](configpath,'bot-'+_0x22ad2d+_0x1c4e07(0x1a9))))fs[_0x1c4e07(0x14d)](path[_0x1c4e07(0x1a1)](configpath,_0x1c4e07(0x1c9)+_0x22ad2d+_0x1c4e07(0x1a9)));if(fs[_0x1c4e07(0xdc)](path['join'](configpath,'bot-'+_0x22ad2d+'-results.json')))fs[_0x1c4e07(0x14d)](path[_0x1c4e07(0x1a1)](configpath,'bot-'+_0x22ad2d+_0x1c4e07(0x1ce)));}catch(_0x3e429e){if(_0x3e429e)logger[_0x1c4e07(0x1a7)](_0x1c4e07(0xd8),_0x3e429e);}config=getConfiguration(),io['to'](_0x1c4e07(0x2b2))[_0x1c4e07(0x22e)]('bots',config),broadcastToBots(_0x1c4e07(0x1d1),JSON[_0x1c4e07(0x278)](config));}function toggleBot(_0x510c4a,_0x3ca059,_0x230dea){const _0x34cd69=_0x4af2cf;dbConfig[_0x34cd69(0x21e)](_0x34cd69(0x1d1))[_0x34cd69(0xec)]({'botID':_0x510c4a})['assign']({'status':_0x3ca059})[_0x34cd69(0x1bb)]({'live':_0x230dea})[_0x34cd69(0xda)]();if(_0x3ca059=='enabled'||_0x3ca059==_0x34cd69(0x23b))logger[_0x34cd69(0x1a7)]('Enabled\x20Bot\x20'+_0x510c4a),startBot([_0x510c4a,userID],{'cwd':bbpath},function(_0x34f2ff){const _0x32f1f3=_0x34cd69;if(_0x34f2ff)logger[_0x32f1f3(0x1a7)](_0x34f2ff);});else(_0x3ca059=='disabled'||_0x3ca059==_0x34cd69(0xf7))&&(logger[_0x34cd69(0x1a7)](_0x34cd69(0x1a6)+_0x510c4a),stopBot(_0x510c4a));config=getConfiguration(),io['to']('botmanager')[_0x34cd69(0x22e)]('bots',config),broadcastToBots(_0x34cd69(0x1d1),JSON['stringify'](config));}function toggleStatus(_0x4f96c3){const _0x3f40f0=_0x4af2cf;let _0x33aedc=dbConfig['get']('bots')[_0x3f40f0(0xec)]({'botID':_0x4f96c3})[_0x3f40f0(0x1a4)](),_0x10b6e7;if(_0x33aedc[_0x3f40f0(0x2ad)]==='enabled')_0x10b6e7=_0x3f40f0(0x281);else{if(_0x33aedc[_0x3f40f0(0x2ad)]==='new')_0x10b6e7=_0x3f40f0(0xf7);else{if(_0x33aedc['status']===_0x3f40f0(0xf7))_0x10b6e7='new';else{if(_0x33aedc[_0x3f40f0(0x2ad)]==='disabled')_0x10b6e7=_0x3f40f0(0x210);}}}return _0x10b6e7;}function updateStatus(_0x11f852,_0x2ea1df){const _0x53b1a3=_0x4af2cf;dbConfig['get']('bots')[_0x53b1a3(0xec)]({'botID':_0x11f852})['assign']({'status':_0x2ea1df})[_0x53b1a3(0xda)](),config=getConfiguration(),io['to'](_0x53b1a3(0x2b2))[_0x53b1a3(0x22e)](_0x53b1a3(0x1d1),config),broadcastToBots(_0x53b1a3(0x1d1),JSON[_0x53b1a3(0x278)](config));}function updateLive(_0x1c8b44,_0x47603f){const _0x5a1efa=_0x4af2cf;dbConfig[_0x5a1efa(0x21e)](_0x5a1efa(0x1d1))['find']({'botID':_0x1c8b44})[_0x5a1efa(0x1bb)]({'live':_0x47603f})['write'](),config=getConfiguration(),io['to'](_0x5a1efa(0x2b2))['emit']('bots',config),broadcastToBots(_0x5a1efa(0x1d1),JSON['stringify'](config));}function updateBotName(_0x142f8f,_0x5a5c29){const _0x3ed6aa=_0x4af2cf;dbConfig[_0x3ed6aa(0x21e)](_0x3ed6aa(0x1d1))[_0x3ed6aa(0xec)]({'botID':_0x142f8f})[_0x3ed6aa(0x1bb)]({'botname':_0x5a5c29})[_0x3ed6aa(0xda)](),config=getConfiguration(),io['to']('botmanager')[_0x3ed6aa(0x22e)]('bots',config),broadcastToBots(_0x3ed6aa(0x1d1),JSON[_0x3ed6aa(0x278)](config));}function updateBotManager(){const _0x5350c7=_0x4af2cf;config=getConfiguration(),io['to'](_0x5350c7(0x2b2))['emit'](_0x5350c7(0x1d1),config),broadcastToBots(_0x5350c7(0x1d1),JSON[_0x5350c7(0x278)](config));}function toggleBotMode(_0x4f912a){const _0x2be925=_0x4af2cf;if(pid[_0x4f912a])pid[_0x4f912a][_0x2be925(0x218)]({'function':_0x2be925(0x217),'args':null});else{const _0x895b4e=configpath+'bot-'+_0x4f912a+_0x2be925(0x19f),_0x5d6749=fs['readFileSync'](_0x895b4e),_0x49e4bd=JSON[_0x2be925(0x1c5)](_0x5d6749),_0x384764=_0x49e4bd[_0x2be925(0x222)][0x0][_0x2be925(0x2a7)];_0x49e4bd['bot'][0x0][_0x2be925(0x2a7)]=!_0x384764;const _0x3e547d=JSON[_0x2be925(0x278)](_0x49e4bd,null,0x2);fs[_0x2be925(0x1c2)](_0x895b4e,_0x3e547d),config=getConfiguration(),io['to']('botmanager')[_0x2be925(0x22e)](_0x2be925(0x1d1),config),broadcastToBots(_0x2be925(0x1d1),JSON[_0x2be925(0x278)](config));}}function telegramError(_0x4ddf40){const _0x2367ea=_0x4af2cf;logger[_0x2367ea(0x17e)](getTimeStamp()+_0x2367ea(0x28a));}function validateTelegram(_0x114416){const _0x3db81c=_0x4af2cf;if(_0x114416[_0x3db81c(0x261)][_0x3db81c(0x1a5)]!=settings[_0x3db81c(0x2c1)]&&'@'+_0x114416[_0x3db81c(0x261)]['username']!=settings[_0x3db81c(0x2c1)])return tgBot[_0x3db81c(0x163)](_0x114416[_0x3db81c(0x2bd)]['id'],_0x3db81c(0xe6),{'parse_mode':_0x3db81c(0x193)})[_0x3db81c(0x128)](_0x4deffc=>{telegramError(_0x4deffc);}),![];return!![];}async function initTelegram(){const _0x2c4c6e=_0x4af2cf;if(tgBot)tgBot[_0x2c4c6e(0x1f6)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2c4c6e(0x289)],{'polling':!![]});let _0x30f192=_0x2c4c6e(0x137);_0x30f192+='\x0a',_0x30f192+=_0x2c4c6e(0x1ed),_0x30f192+=_0x2c4c6e(0x1e2),_0x30f192+=_0x2c4c6e(0x279),_0x30f192+=_0x2c4c6e(0x1cc),_0x30f192+=_0x2c4c6e(0x153),_0x30f192+='/off\x20-\x20stop\x20bot(s)\x0a',_0x30f192+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x30f192+=_0x2c4c6e(0x186),_0x30f192+=_0x2c4c6e(0x177),_0x30f192+=_0x2c4c6e(0x27b),_0x30f192+=_0x2c4c6e(0x1b7),_0x30f192+=_0x2c4c6e(0x1cd),_0x30f192+=_0x2c4c6e(0xde),_0x30f192+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x408568=_0x2c4c6e(0x172);_0x408568+='\x0a',_0x408568+=_0x30f192,tgBot[_0x2c4c6e(0x1b6)](/\/start/,_0x46ec17=>{const _0x585078=_0x2c4c6e;if(!validateTelegram(_0x46ec17))return;if(settings[_0x585078(0x245)]!=_0x46ec17[_0x585078(0x2bd)]['id'])updateSetting(_0x585078(0x245),_0x46ec17[_0x585078(0x2bd)]['id']);updateSetting(_0x585078(0x182),!![]),tgBot[_0x585078(0x163)](_0x46ec17['chat']['id'],_0x408568)[_0x585078(0x128)](_0x583e6c=>{telegramError(_0x583e6c);});}),tgBot[_0x2c4c6e(0x1b6)](/\/enable/,_0x19eefe=>{const _0x227d54=_0x2c4c6e;if(!validateTelegram(_0x19eefe))return;if(settings['telegramChatId']!=_0x19eefe[_0x227d54(0x2bd)]['id'])updateSetting(_0x227d54(0x245),_0x19eefe[_0x227d54(0x2bd)]['id']);updateSetting(_0x227d54(0x182),!![]),tgBot[_0x227d54(0x163)](_0x19eefe[_0x227d54(0x2bd)]['id'],'Notifications\x20enabled')['catch'](_0x2bd8a2=>{telegramError(_0x2bd8a2);});}),tgBot[_0x2c4c6e(0x1b6)](/\/config/,async _0x4e724d=>{const _0x1d3d79=_0x2c4c6e;if(!validateTelegram(_0x4e724d))return;tgBot['removeListener'](_0x1d3d79(0x294)),tgBot[_0x1d3d79(0x163)](_0x4e724d['chat']['id'],_0x1d3d79(0x1da),{'reply_markup':{'inline_keyboard':[[{'text':_0x1d3d79(0x28c),'callback_data':'orders'},{'text':_0x1d3d79(0x18a),'callback_data':_0x1d3d79(0x13f)},{'text':_0x1d3d79(0x19a),'callback_data':_0x1d3d79(0x20e)}]]}})[_0x1d3d79(0x128)](_0x594d78=>{telegramError(_0x594d78);}),tgBot['on']('callback_query',async _0x28aa99=>{const _0x484dd0=_0x1d3d79,_0x3ea722=_0x28aa99[_0x484dd0(0x16c)],_0x3f5e90=_0x28aa99[_0x484dd0(0x2a1)];tgBot[_0x484dd0(0x105)](_0x28aa99['id'])[_0x484dd0(0x1bf)](async()=>{const _0x38bf92=_0x484dd0;_0x3ea722==_0x38bf92(0x27d)&&(updateSetting(_0x38bf92(0x269),'orders'),updateSetting(_0x38bf92(0x182),!![]),await tgBot[_0x38bf92(0x163)](_0x3f5e90[_0x38bf92(0x2bd)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x38bf92(0x128)](_0xcce9ad=>{telegramError(_0xcce9ad);}));_0x3ea722=='alerts'&&(updateSetting(_0x38bf92(0x269),_0x38bf92(0x13f)),updateSetting('telegramEnabled',!![]),await tgBot[_0x38bf92(0x163)](_0x3f5e90[_0x38bf92(0x2bd)]['id'],_0x38bf92(0x265))['catch'](_0x224bc6=>{telegramError(_0x224bc6);}));_0x3ea722==_0x38bf92(0x20e)&&(updateSetting(_0x38bf92(0x269),_0x38bf92(0x20e)),updateSetting(_0x38bf92(0x182),!![]),await tgBot['sendMessage'](_0x3f5e90[_0x38bf92(0x2bd)]['id'],_0x38bf92(0xd7))[_0x38bf92(0x128)](_0x2683b8=>{telegramError(_0x2683b8);}));if(!settings[_0x38bf92(0x245)])tgBot[_0x38bf92(0x163)](_0x3f5e90[_0x38bf92(0x2bd)]['id'],_0x38bf92(0xea))[_0x38bf92(0x128)](_0x433a61=>{telegramError(_0x433a61);});}),tgBot[_0x484dd0(0x173)](_0x484dd0(0x294));});}),tgBot['onText'](/\/status/,_0x4ed23c=>{const _0x1d7499=_0x2c4c6e;if(!validateTelegram(_0x4ed23c))return;const _0x3ec983=getBotsWithMode();let _0x165fad=_0x1d7499(0x1f3);config[_0x1d7499(0x2b9)](_0x34c607=>{const _0x4e11ee=_0x1d7499,_0x4d9782=_0x3ec983[_0x4e11ee(0xec)](_0x33343f=>_0x33343f[_0x4e11ee(0x17c)]==_0x34c607[_0x4e11ee(0x17c)])['mode'];_0x165fad+=_0x4e11ee(0x148)+_0x34c607['botID']+':\x20'+_0x34c607[_0x4e11ee(0x2ad)]+_0x4e11ee(0x24b)+_0x4d9782+'\x20|\x20'+_0x34c607[_0x4e11ee(0x18e)]+'\x0a';}),_0x165fad+='\x0a',_0x165fad+=_0x1d7499(0x25c),_0x165fad+=!settings['telegramEnabled']?_0x1d7499(0xe4):_0x1d7499(0xef),_0x165fad+=settings[_0x1d7499(0x182)]?settings[_0x1d7499(0x269)]==_0x1d7499(0x20e)?_0x1d7499(0x15b):_0x1d7499(0x1ea)+settings[_0x1d7499(0x269)]+_0x1d7499(0x1fe):'',tgBot[_0x1d7499(0x163)](_0x4ed23c['chat']['id'],_0x165fad,{'parse_mode':_0x1d7499(0x193)})['catch'](_0x540266=>{telegramError(_0x540266);});}),tgBot[_0x2c4c6e(0x1b6)](/\/restart/,_0xd270ae=>{const _0xe37516=_0x2c4c6e;if(!validateTelegram(_0xd270ae))return;tgBot[_0xe37516(0x173)](_0xe37516(0x294));const _0x36564d=getEnabledBots();if(_0x36564d[_0xe37516(0x190)]==0x0)tgBot['sendMessage'](_0xd270ae[_0xe37516(0x2bd)]['id'],_0xe37516(0x216))[_0xe37516(0x128)](_0x5a4d9d=>{telegramError(_0x5a4d9d);});else{if(_0x36564d['length']>0x1)_0x36564d['push']({'botID':_0xe37516(0x20e)});let _0x36d008=[],_0xebabbd=[];const _0x367830=_0x36564d[_0xe37516(0x190)]%0x4==0x0||_0x36564d[_0xe37516(0x190)]%0x4==0x3||_0x36564d[_0xe37516(0x190)]%0x3==0x1?0x4:0x3;let _0x51c6f2=0x0;_0x36564d[_0xe37516(0x2b9)]((_0x4cc79c,_0x1a0446)=>{const _0x410d5c=_0xe37516;if(_0x1a0446%_0x367830==0x0)_0xebabbd=[];_0xebabbd[_0x410d5c(0x266)]({'text':_0x4cc79c[_0x410d5c(0x17c)]==_0x410d5c(0x20e)?_0x410d5c(0x25e):_0x410d5c(0x148)+_0x4cc79c['botID'],'callback_data':_0x4cc79c['botID']}),_0x1a0446%_0x367830==0x0&&(_0x36d008[_0x51c6f2]=_0xebabbd,_0x51c6f2++);}),tgBot[_0xe37516(0x163)](_0xd270ae[_0xe37516(0x2bd)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x36d008}})[_0xe37516(0x128)](_0x15f80f=>{telegramError(_0x15f80f);}),tgBot['on'](_0xe37516(0x294),async _0x2ee5aa=>{const _0x36fc15=_0xe37516,_0x59c999=_0x2ee5aa[_0x36fc15(0x16c)],_0x594264=_0x2ee5aa[_0x36fc15(0x2a1)];tgBot[_0x36fc15(0x105)](_0x2ee5aa['id'])[_0x36fc15(0x1bf)](async()=>{const _0x5c9a2d=_0x36fc15;_0x59c999==_0x5c9a2d(0x20e)?config[_0x5c9a2d(0x2b9)](_0x4de696=>{const _0x16d713=_0x5c9a2d;restartBot(_0x4de696[_0x16d713(0x17c)]);}):restartBot(_0x59c999);}),tgBot[_0x36fc15(0x173)](_0x36fc15(0x294));});}}),tgBot[_0x2c4c6e(0x1b6)](/\/on/,_0x250c84=>{const _0x5ccab4=_0x2c4c6e;if(!validateTelegram(_0x250c84))return;tgBot[_0x5ccab4(0x173)](_0x5ccab4(0x294));const _0x27c962=getDisabledBots();if(_0x27c962[_0x5ccab4(0x190)]==0x0)tgBot['sendMessage'](_0x250c84[_0x5ccab4(0x2bd)]['id'],_0x5ccab4(0x287))['catch'](_0x5cb8ae=>{telegramError(_0x5cb8ae);});else{if(_0x27c962[_0x5ccab4(0x190)]>0x1)_0x27c962['push']({'botID':_0x5ccab4(0x20e)});let _0x3871ae=[],_0x318f14=[];const _0x53f6d7=_0x27c962['length']%0x4==0x0||_0x27c962[_0x5ccab4(0x190)]%0x4==0x3||_0x27c962[_0x5ccab4(0x190)]%0x3==0x1?0x4:0x3;let _0x20c950=0x0;_0x27c962[_0x5ccab4(0x2b9)]((_0x549fd0,_0x10e7b8)=>{const _0x51984f=_0x5ccab4;if(_0x10e7b8%_0x53f6d7==0x0)_0x318f14=[];_0x318f14['push']({'text':_0x549fd0[_0x51984f(0x17c)]==_0x51984f(0x20e)?'All\x20bots':_0x51984f(0x148)+_0x549fd0['botID'],'callback_data':_0x549fd0[_0x51984f(0x17c)]}),_0x10e7b8%_0x53f6d7==0x0&&(_0x3871ae[_0x20c950]=_0x318f14,_0x20c950++);}),tgBot['sendMessage'](_0x250c84['chat']['id'],_0x5ccab4(0x2a8),{'reply_markup':{'inline_keyboard':_0x3871ae}})[_0x5ccab4(0x128)](_0x48d807=>{telegramError(_0x48d807);}),tgBot['on'](_0x5ccab4(0x294),async _0x268fdf=>{const _0x45d943=_0x5ccab4,_0x380256=_0x268fdf['data'],_0x5187ea=_0x268fdf[_0x45d943(0x2a1)];tgBot[_0x45d943(0x105)](_0x268fdf['id'])[_0x45d943(0x1bf)](async()=>{const _0x331f14=_0x45d943;_0x380256==_0x331f14(0x20e)?(tgBot[_0x331f14(0x163)](_0x5187ea['chat']['id'],_0x331f14(0x13b))[_0x331f14(0x128)](_0x520c4a=>{telegramError(_0x520c4a);}),_0x27c962[_0x331f14(0x2b9)](_0x47f270=>{const _0x14331c=_0x331f14;if(_0x47f270[_0x14331c(0x17c)]!=_0x14331c(0x20e))toggleBot(_0x47f270['botID'],toggleStatus(_0x47f270['botID']),_0x14331c(0x2c3));})):(tgBot[_0x331f14(0x163)](_0x5187ea['chat']['id'],_0x331f14(0x1d3)+_0x380256)[_0x331f14(0x128)](_0x3f97e=>{telegramError(_0x3f97e);}),toggleBot(_0x380256,toggleStatus(_0x380256),_0x331f14(0x2c3)));}),tgBot[_0x45d943(0x173)](_0x45d943(0x294));});}}),tgBot[_0x2c4c6e(0x1b6)](/\/off/,_0x1c3af2=>{const _0x2b0f83=_0x2c4c6e;if(!validateTelegram(_0x1c3af2))return;tgBot[_0x2b0f83(0x173)](_0x2b0f83(0x294));const _0x211e16=getEnabledBots();if(_0x211e16[_0x2b0f83(0x190)]==0x0)tgBot[_0x2b0f83(0x163)](_0x1c3af2[_0x2b0f83(0x2bd)]['id'],_0x2b0f83(0x216))['catch'](_0x131ae5=>{telegramError(_0x131ae5);});else{if(_0x211e16['length']>0x1)_0x211e16['push']({'botID':_0x2b0f83(0x20e)});let _0x5aaa92=[],_0x141048=[];const _0x3f932e=_0x211e16[_0x2b0f83(0x190)]%0x4==0x0||_0x211e16['length']%0x4==0x3||_0x211e16[_0x2b0f83(0x190)]%0x3==0x1?0x4:0x3;let _0x4e8624=0x0;_0x211e16[_0x2b0f83(0x2b9)]((_0x3b1e32,_0x2dcb68)=>{const _0x1c1011=_0x2b0f83;if(_0x2dcb68%_0x3f932e==0x0)_0x141048=[];_0x141048[_0x1c1011(0x266)]({'text':_0x3b1e32[_0x1c1011(0x17c)]=='all'?_0x1c1011(0x25e):_0x1c1011(0x148)+_0x3b1e32['botID'],'callback_data':_0x3b1e32['botID']}),_0x2dcb68%_0x3f932e==0x0&&(_0x5aaa92[_0x4e8624]=_0x141048,_0x4e8624++);}),tgBot['sendMessage'](_0x1c3af2[_0x2b0f83(0x2bd)]['id'],_0x2b0f83(0x112),{'reply_markup':{'inline_keyboard':_0x5aaa92}})['catch'](_0x4e8233=>{telegramError(_0x4e8233);}),tgBot['on'](_0x2b0f83(0x294),async _0x1b829a=>{const _0x191ed2=_0x2b0f83,_0x34b9c9=_0x1b829a['data'],_0x3d113f=_0x1b829a[_0x191ed2(0x2a1)];tgBot[_0x191ed2(0x105)](_0x1b829a['id'])['then'](async()=>{const _0xa0cc5e=_0x191ed2;_0x34b9c9==_0xa0cc5e(0x20e)?(tgBot[_0xa0cc5e(0x163)](_0x3d113f[_0xa0cc5e(0x2bd)]['id'],_0xa0cc5e(0x1b8))['catch'](_0x17016e=>{telegramError(_0x17016e);}),_0x211e16[_0xa0cc5e(0x2b9)](_0x9f0e7=>{const _0x2ddedf=_0xa0cc5e;if(_0x9f0e7[_0x2ddedf(0x17c)]!=_0x2ddedf(0x20e))toggleBot(_0x9f0e7[_0x2ddedf(0x17c)],toggleStatus(_0x9f0e7[_0x2ddedf(0x17c)]),'stopped');})):(tgBot[_0xa0cc5e(0x163)](_0x3d113f[_0xa0cc5e(0x2bd)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x34b9c9)['catch'](_0x505a86=>{telegramError(_0x505a86);}),toggleBot(_0x34b9c9,toggleStatus(_0x34b9c9),'stopped'));}),tgBot[_0x191ed2(0x173)]('callback_query');});}}),tgBot['onText'](/\/metrics/,_0x263f9d=>{const _0x55e005=_0x2c4c6e;if(!validateTelegram(_0x263f9d))return;tgBot[_0x55e005(0x173)](_0x55e005(0x294));const _0x40e058=getEnabledBots();if(_0x40e058[_0x55e005(0x190)]==0x0)tgBot[_0x55e005(0x163)](_0x263f9d[_0x55e005(0x2bd)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x55e005(0x128)](_0x3dd001=>{telegramError(_0x3dd001);});else{if(_0x40e058['length']>0x1){let _0x33437f=[],_0x59232c=[];const _0x484b9c=_0x40e058[_0x55e005(0x190)]%0x4==0x0||_0x40e058['length']%0x4==0x3||_0x40e058['length']%0x3==0x1?0x4:0x3;let _0x5e6351=0x0;_0x40e058['forEach']((_0x125672,_0x1bd0c9)=>{const _0x1f1d95=_0x55e005;if(_0x1bd0c9%_0x484b9c==0x0)_0x59232c=[];_0x59232c[_0x1f1d95(0x266)]({'text':'Bot\x20'+_0x125672['botID'],'callback_data':_0x125672[_0x1f1d95(0x17c)]}),_0x1bd0c9%_0x484b9c==0x0&&(_0x33437f[_0x5e6351]=_0x59232c,_0x5e6351++);}),tgBot['sendMessage'](_0x263f9d[_0x55e005(0x2bd)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x33437f}})[_0x55e005(0x128)](_0x11b476=>{telegramError(_0x11b476);}),tgBot['on']('callback_query',async _0x459f51=>{const _0x155200=_0x55e005,_0x4163f3=_0x459f51['data'],_0x163835=_0x459f51['message'];tgBot[_0x155200(0x105)](_0x459f51['id'])[_0x155200(0x1bf)](async()=>{const _0x3b779e=_0x155200;if(pid[_0x4163f3])pid[_0x4163f3][_0x3b779e(0x218)]({'function':_0x3b779e(0x20d),'args':null});}),tgBot['removeListener'](_0x155200(0x294));});}else{const _0xe3f348=_0x40e058[0x0]['botID'];if(pid[_0xe3f348])pid[_0xe3f348][_0x55e005(0x218)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2c4c6e(0x1b6)](/\/portfolio/,_0x36291f=>{const _0x4f5fd4=_0x2c4c6e;if(!validateTelegram(_0x36291f))return;tgBot[_0x4f5fd4(0x173)](_0x4f5fd4(0x294));const _0x218ffb=getEnabledBots();if(_0x218ffb[_0x4f5fd4(0x190)]==0x0)tgBot[_0x4f5fd4(0x163)](_0x36291f[_0x4f5fd4(0x2bd)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4f5fd4(0x128)](_0x51fa85=>{telegramError(_0x51fa85);});else{if(_0x218ffb[_0x4f5fd4(0x190)]>0x1){let _0x2b10e3=[],_0x1fcd3d=[];const _0x2cf85c=_0x218ffb['length']%0x4==0x0||_0x218ffb[_0x4f5fd4(0x190)]%0x4==0x3||_0x218ffb[_0x4f5fd4(0x190)]%0x3==0x1?0x4:0x3;let _0x3af763=0x0;_0x218ffb[_0x4f5fd4(0x2b9)]((_0x49fd36,_0x1915e5)=>{const _0x5a4651=_0x4f5fd4;if(_0x1915e5%_0x2cf85c==0x0)_0x1fcd3d=[];_0x1fcd3d[_0x5a4651(0x266)]({'text':_0x5a4651(0x148)+_0x49fd36[_0x5a4651(0x17c)],'callback_data':_0x49fd36['botID']}),_0x1915e5%_0x2cf85c==0x0&&(_0x2b10e3[_0x3af763]=_0x1fcd3d,_0x3af763++);}),tgBot[_0x4f5fd4(0x163)](_0x36291f[_0x4f5fd4(0x2bd)]['id'],_0x4f5fd4(0x1ec),{'reply_markup':{'inline_keyboard':_0x2b10e3}})[_0x4f5fd4(0x128)](_0x52fc7f=>{telegramError(_0x52fc7f);}),tgBot['on'](_0x4f5fd4(0x294),async _0x2f8c18=>{const _0x568421=_0x4f5fd4,_0x5db924=_0x2f8c18[_0x568421(0x16c)],_0x31bea6=_0x2f8c18[_0x568421(0x2a1)];tgBot[_0x568421(0x105)](_0x2f8c18['id'])[_0x568421(0x1bf)](async()=>{const _0x88da4d=_0x568421;if(pid[_0x5db924])pid[_0x5db924]['send']({'function':_0x88da4d(0x180),'args':null});}),tgBot[_0x568421(0x173)](_0x568421(0x294));});}else{const _0x113b42=_0x218ffb[0x0][_0x4f5fd4(0x17c)];if(pid[_0x113b42])pid[_0x113b42]['send']({'function':_0x4f5fd4(0x180),'args':null});}}}),tgBot[_0x2c4c6e(0x1b6)](/\/update/,async _0x3f0b28=>{const _0x2ba5d0=_0x2c4c6e;if(!validateTelegram(_0x3f0b28))return;tgBot[_0x2ba5d0(0x173)](_0x2ba5d0(0x294)),await getMessages();if(!updateAvailable)tgBot[_0x2ba5d0(0x163)](_0x3f0b28[_0x2ba5d0(0x2bd)]['id'],_0x2ba5d0(0x16f))[_0x2ba5d0(0x128)](_0x1a873d=>{telegramError(_0x1a873d);});else!validInstallation?tgBot[_0x2ba5d0(0x163)](_0x3f0b28[_0x2ba5d0(0x2bd)]['id'],_0x2ba5d0(0x1c7))[_0x2ba5d0(0x128)](_0x1785a4=>{telegramError(_0x1785a4);}):(tgBot[_0x2ba5d0(0x163)](_0x3f0b28['chat']['id'],_0x2ba5d0(0x1f0),{'reply_markup':{'inline_keyboard':[[{'text':_0x2ba5d0(0x23f),'callback_data':_0x2ba5d0(0x151)},{'text':'No','callback_data':'no'}]]}})[_0x2ba5d0(0x128)](_0x1f1632=>{telegramError(_0x1f1632);}),tgBot['on'](_0x2ba5d0(0x294),async _0x536c04=>{const _0x3c69de=_0x2ba5d0,_0x5b98e9=_0x536c04[_0x3c69de(0x16c)],_0xdc9789=_0x536c04['message'];tgBot['answerCallbackQuery'](_0x536c04['id'])[_0x3c69de(0x1bf)](async()=>{const _0x2c22a8=_0x3c69de;_0x5b98e9==_0x2c22a8(0x151)&&(await tgBot[_0x2c22a8(0x163)](_0xdc9789[_0x2c22a8(0x2bd)]['id'],_0x2c22a8(0x1f2))[_0x2c22a8(0x128)](_0x5320c4=>{telegramError(_0x5320c4);}),updateBB('update')),_0x5b98e9=='no'&&await tgBot[_0x2c22a8(0x163)](_0xdc9789[_0x2c22a8(0x2bd)]['id'],_0x2c22a8(0x1db))[_0x2c22a8(0x128)](_0x26d750=>{telegramError(_0x26d750);});}),tgBot[_0x3c69de(0x173)](_0x3c69de(0x294));}));}),tgBot[_0x2c4c6e(0x1b6)](/\/reinstall/,async _0x569437=>{const _0x209df5=_0x2c4c6e;if(!validateTelegram(_0x569437))return;tgBot[_0x209df5(0x173)](_0x209df5(0x294)),!validInstallation?tgBot[_0x209df5(0x163)](_0x569437['chat']['id'],_0x209df5(0x23d))[_0x209df5(0x128)](_0x133093=>{telegramError(_0x133093);}):(tgBot[_0x209df5(0x163)](_0x569437[_0x209df5(0x2bd)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x209df5(0x23f),'callback_data':_0x209df5(0x151)},{'text':'No','callback_data':'no'}]]}})[_0x209df5(0x128)](_0x5bd175=>{telegramError(_0x5bd175);}),tgBot['on'](_0x209df5(0x294),async _0x3668fb=>{const _0x54565a=_0x209df5,_0x561a4c=_0x3668fb[_0x54565a(0x16c)],_0x31d337=_0x3668fb['message'];tgBot['answerCallbackQuery'](_0x3668fb['id'])[_0x54565a(0x1bf)](async()=>{const _0x52da87=_0x54565a;_0x561a4c==_0x52da87(0x151)&&(await tgBot[_0x52da87(0x163)](_0x31d337[_0x52da87(0x2bd)]['id'],_0x52da87(0x1bc))['catch'](_0x4030a9=>{telegramError(_0x4030a9);}),updateBB(_0x52da87(0x298))),_0x561a4c=='no'&&await tgBot[_0x52da87(0x163)](_0x31d337[_0x52da87(0x2bd)]['id'],_0x52da87(0xff))['catch'](_0x48c97a=>{telegramError(_0x48c97a);});}),tgBot['removeListener'](_0x54565a(0x294));}));}),tgBot[_0x2c4c6e(0x1b6)](/\/toggle/,_0x24a5f0=>{const _0x421c47=_0x2c4c6e;if(!validateTelegram(_0x24a5f0))return;tgBot['removeListener'](_0x421c47(0x294));const _0x435d06=getBotsWithMode();if(_0x435d06[_0x421c47(0x190)]==0x0)tgBot[_0x421c47(0x163)](_0x24a5f0[_0x421c47(0x2bd)]['id'],_0x421c47(0x216))['catch'](_0x3d9537=>{telegramError(_0x3d9537);});else{let _0x21ed8e=[],_0x466a29=[];const _0x21813f=0x2;let _0x20c595=0x0;_0x435d06['forEach']((_0x32a661,_0x14e696)=>{const _0x825987=_0x421c47;if(_0x14e696%_0x21813f==0x0)_0x466a29=[];_0x466a29['push']({'text':'Bot\x20'+_0x32a661[_0x825987(0x17c)]+'\x20('+_0x32a661[_0x825987(0x220)]+')','callback_data':_0x32a661[_0x825987(0x17c)]}),_0x14e696%_0x21813f==0x0&&(_0x21ed8e[_0x20c595]=_0x466a29,_0x20c595++);}),tgBot[_0x421c47(0x163)](_0x24a5f0[_0x421c47(0x2bd)]['id'],_0x421c47(0x275),{'reply_markup':{'inline_keyboard':_0x21ed8e}})['catch'](_0x27fdb5=>{telegramError(_0x27fdb5);}),tgBot['on'](_0x421c47(0x294),async _0x1a4398=>{const _0x3276fd=_0x421c47,_0x5a0baa=_0x1a4398[_0x3276fd(0x16c)],_0x3d5188=_0x1a4398[_0x3276fd(0x2a1)];tgBot[_0x3276fd(0x105)](_0x1a4398['id'])['then'](async()=>{const _0x416087=_0x3276fd,_0x528c42=_0x435d06[_0x416087(0xec)](_0x41a413=>_0x41a413[_0x416087(0x17c)]==_0x5a0baa),_0x35001a=_0x528c42[_0x416087(0x220)]=='auto'?'manual':_0x416087(0x188);tgBot['sendMessage'](_0x3d5188[_0x416087(0x2bd)]['id'],_0x416087(0xfe)+_0x5a0baa+_0x416087(0x24a)+_0x35001a+_0x416087(0x242))[_0x416087(0x128)](_0x1c6b81=>{telegramError(_0x1c6b81);}),toggleBotMode(_0x5a0baa);}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/names/,_0x367dc2=>{const _0x26ee54=_0x2c4c6e;if(!validateTelegram(_0x367dc2))return;let _0x212dcc='';config['forEach'](_0x52c2c8=>{const _0x50663c=_0x2b8a;_0x212dcc+='Bot\x20'+_0x52c2c8[_0x50663c(0x17c)]+':\x20'+_0x52c2c8[_0x50663c(0x1fa)]+'\x0a';}),tgBot['sendMessage'](_0x367dc2[_0x26ee54(0x2bd)]['id'],_0x212dcc,{'parse_mode':_0x26ee54(0x193)})['catch'](_0x40fb19=>{telegramError(_0x40fb19);});}),tgBot[_0x2c4c6e(0x1b6)](/\/disable/,_0x5f09e4=>{const _0x4cef97=_0x2c4c6e;if(!validateTelegram(_0x5f09e4))return;tgBot[_0x4cef97(0x163)](_0x5f09e4[_0x4cef97(0x2bd)]['id'],_0x4cef97(0x28f))[_0x4cef97(0x128)](_0x2b227b=>{telegramError(_0x2b227b);}),updateSetting(_0x4cef97(0x182),![]);}),tgBot[_0x2c4c6e(0x1b6)](/\/help/,_0x259c8d=>{const _0x3185bc=_0x2c4c6e;if(!validateTelegram(_0x259c8d))return;tgBot[_0x3185bc(0x163)](_0x259c8d[_0x3185bc(0x2bd)]['id'],_0x30f192)[_0x3185bc(0x128)](_0x437798=>{telegramError(_0x437798);});}),tgBot['on'](_0x2c4c6e(0x207),_0x168224=>{const _0x341dd1=_0x2c4c6e;_0x168224[_0x341dd1(0x194)]()[_0x341dd1(0x11c)](_0x341dd1(0x15a))&&(logger[_0x341dd1(0x1a7)](_0x341dd1(0x1fc)),tgBot[_0x341dd1(0x1f6)](),tgBot=null,io['to']('botmanager')[_0x341dd1(0x22e)](_0x341dd1(0x171),'Invalid\x20Telegram\x20token'));}),process[_0x2c4c6e(0x25b)](_0x2c4c6e(0x284),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process['once'](_0x2c4c6e(0x133),()=>{const _0x152a0a=_0x2c4c6e;if(tgBot)tgBot[_0x152a0a(0x1f6)]();process['exit'](0x1);});}}function disableTelegram(){const _0x4c17ad=_0x4af2cf;tgBot&&(tgBot[_0x4c17ad(0x1f6)](),tgBot=null);}function sendTelegram(_0x271480,_0x1d2bda){const _0x3a3053=_0x4af2cf;if(settings[_0x3a3053(0x182)]){if(settings[_0x3a3053(0x269)]==_0x3a3053(0x20e)||(_0x1d2bda[_0x3a3053(0x1d9)]==_0x3a3053(0x139)||_0x1d2bda[_0x3a3053(0x1d9)]==_0x3a3053(0x277)||_0x1d2bda['type']==_0x3a3053(0x144))&&settings[_0x3a3053(0x269)]=='alerts'||_0x1d2bda['type']==_0x3a3053(0x2be)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x3a3053(0x245)]){if(_0x1d2bda[_0x3a3053(0x22a)])tgBot[_0x3a3053(0x163)](settings[_0x3a3053(0x245)],_0x1d2bda[_0x3a3053(0x1fa)]+'\x20>\x20'+_0x1d2bda[_0x3a3053(0x136)])[_0x3a3053(0x128)](_0x1e6712=>{telegramError(_0x1e6712);});else tgBot[_0x3a3053(0x163)](settings[_0x3a3053(0x245)],_0x3a3053(0x148)+_0x271480+_0x3a3053(0x184)+_0x1d2bda[_0x3a3053(0x136)])['catch'](_0x5bd610=>{telegramError(_0x5bd610);});}}}}async function sendTelegramMsg(_0x5d82d4,_0x51162e=_0x4af2cf(0x193)){const _0x58023c=_0x4af2cf;return settings[_0x58023c(0x182)]&&tgBot&&settings[_0x58023c(0x245)]?(await tgBot[_0x58023c(0x163)](settings[_0x58023c(0x245)],_0x5d82d4,{'parse_mode':_0x51162e})[_0x58023c(0x128)](_0x4a1551=>{telegramError(_0x4a1551);}),!![]):![];}function getDeviceWithIp(_0x38388a){const _0x2fbf89=_0x4af2cf;return devices[_0x2fbf89(0xec)](_0x784092=>_0x784092['ip']===_0x38388a);}function temporaryAccess2FA(_0x1e7e66,_0x43ff69){const _0x4b26ca=_0x4af2cf;let _0x13454b=new Date(),_0x5e4fca=![];if(lastIpApproval){if(_0x13454b-lastIpApproval<0x1388)_0x5e4fca=!![];}lastIpApproval=new Date();if(_0x5e4fca)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x4b26ca(0x173)](_0x4b26ca(0x294)),tgBot[_0x4b26ca(0x163)](settings[_0x4b26ca(0x245)],_0x4b26ca(0x21f)+normalizeIP(_0x43ff69)[_0x4b26ca(0x268)]+_0x4b26ca(0x214),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4b26ca(0x223),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x4b26ca(0x2a3),'callback_data':_0x4b26ca(0x2a3)}]]}})[_0x4b26ca(0x128)](_0x526f6a=>{telegramError(_0x526f6a);}),tgBot['on'](_0x4b26ca(0x294),async _0x1d1b63=>{const _0x4d2b47=_0x4b26ca,_0x24e020=_0x1d1b63[_0x4d2b47(0x16c)],_0x374daf=_0x1d1b63['message'];tgBot[_0x4d2b47(0x105)](_0x1d1b63['id'])['then'](async()=>{const _0x1099aa=_0x4d2b47;devices[_0x1e7e66][_0x1099aa(0x197)]={'clientip':_0x43ff69,'timestamp':new Date()[_0x1099aa(0x175)](),'expiry':_0x24e020},_0x24e020!=_0x1099aa(0x2a3)?(await tgBot[_0x1099aa(0x163)](_0x374daf[_0x1099aa(0x2bd)]['id'],_0x1099aa(0x1b5)+_0x24e020+_0x1099aa(0x274),{'parse_mode':_0x1099aa(0x193)})['catch'](_0x55d616=>{telegramError(_0x55d616);}),io['to'](_0x1e7e66)[_0x1099aa(0x22e)](_0x1099aa(0x2ad),{'access':{'allow':![],'reason':_0x1099aa(0xf9),'token':null}})):(await tgBot[_0x1099aa(0x163)](_0x374daf[_0x1099aa(0x2bd)]['id'],_0x1099aa(0x293))['catch'](_0x1f30ed=>{telegramError(_0x1f30ed);}),io['to'](_0x1e7e66)[_0x1099aa(0x22e)](_0x1099aa(0x2ad),{'access':{'allow':![],'reason':_0x1099aa(0x2bb),'token':null}}));}),tgBot['removeListener'](_0x4d2b47(0x294));}));}function loginAccess2FA(_0x45d03d,_0x5ac74b){const _0x51f66b=_0x4af2cf;tgBot&&settings['telegramChatId']&&(tgBot[_0x51f66b(0x173)](_0x51f66b(0x294)),tgBot['sendMessage'](settings[_0x51f66b(0x245)],_0x51f66b(0x20a)+normalizeIP(_0x5ac74b)['show']+_0x51f66b(0x214),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x51f66b(0x230),'callback_data':loginExpiry},{'text':_0x51f66b(0x2a3),'callback_data':'reject'}]]}})['catch'](_0x5eedaa=>{telegramError(_0x5eedaa);}),tgBot['on'](_0x51f66b(0x294),async _0x3cf910=>{const _0x4026ae=_0x51f66b,_0x3edbbc=_0x3cf910[_0x4026ae(0x16c)],_0x58b4bf=_0x3cf910[_0x4026ae(0x2a1)];tgBot[_0x4026ae(0x105)](_0x3cf910['id'])['then'](async()=>{const _0x236330=_0x4026ae;devices[_0x45d03d][_0x236330(0x16b)]={'clientip':_0x5ac74b,'timestamp':new Date()[_0x236330(0x175)](),'expiry':_0x3edbbc},_0x3edbbc!=_0x236330(0x2a3)?(await tgBot[_0x236330(0x163)](_0x58b4bf[_0x236330(0x2bd)]['id'],_0x236330(0x219),{'parse_mode':_0x236330(0x193)})[_0x236330(0x128)](_0x25d17f=>{telegramError(_0x25d17f);}),io['to'](_0x45d03d)['emit']('status',{'access':{'allow':![],'reason':_0x236330(0xf9),'token':null}})):(await tgBot[_0x236330(0x163)](_0x58b4bf[_0x236330(0x2bd)]['id'],'Login\x20rejected')[_0x236330(0x128)](_0x4bb322=>{telegramError(_0x4bb322);}),io['to'](_0x45d03d)[_0x236330(0x22e)](_0x236330(0x2ad),{'access':{'allow':![],'reason':_0x236330(0x111),'token':null}}));}),tgBot[_0x4026ae(0x173)](_0x4026ae(0x294));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5ecc46=_0x4af2cf;return dbConfig[_0x5ecc46(0x21e)](_0x5ecc46(0x1d1))[_0x5ecc46(0x196)](_0x5ecc46(0x17c))[_0x5ecc46(0x22d)]({'status':_0x5ecc46(0x210)})[_0x5ecc46(0x1a4)]()||[];}function getDisabledBots(){const _0x5dc504=_0x4af2cf;return dbConfig[_0x5dc504(0x21e)](_0x5dc504(0x1d1))[_0x5dc504(0x196)](_0x5dc504(0x17c))[_0x5dc504(0x22d)]({'status':_0x5dc504(0x281)})['value']()||[];}function _0x10cb(){const _0x479702=['date-fns','invalid\x20credentials','store-configuration','\x20(2)','timeshift','Access\x20enabled\x20for\x20','onText','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','http','zip/','assign','Starting\x20Balance\x20Bot\x20reinstallation','lowdb/adapters/FileSync','temporaryAccessAllowed','then','settings.','storeHeadless','writeFileSync','cloneDeep','messages','parse','442951ZZhcZc','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','logs','bot-','Unauthorized\x20attempt\x20to\x20delete\x20bot','pidExpireLogin','/restart\x20-\x20restart\x20bot(s)\x0a','/update\x20-\x20update\x20Balance\x20Bot\x0a','-results.json','connected','compareSync','bots','socket','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','axios','name','express','files','type','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Invalid\x20authentication\x20token\x20(2)','get-messages','bbUsername','getMinutes','Invalid\x20username\x20or\x20IP\x20address','disconnect','/disable\x20-\x20disable\x20notifications\x0a','defaults','port','Unauthorized\x20attempt\x20to\x20get\x20events','range','toIPv4MappedAddress','stop','2FA\x20required','Notifications\x20types:\x20','statSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','/enable\x20-\x20enable\x20notifications\x0a','password','reset-password','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','resetHistory','Starting\x20Balance\x20Bot\x20update','<b>Balance\x20Bot\x20Status:</b>\x0a','clientip','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','stopPolling','ipc','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','\x1b[0m','botname','DEFLATE','Invalid\x20Telegram\x20token','crypto','\x20only\x0a','RSA','2FA\x20login\x20token\x20generated','getDate','debug','Restore\x20process\x20aborted','Invalid\x20authentication\x20token\x20(1)','settings','args','polling_error','telegrammsg','endsWith','Allow\x20login\x20from\x20IP\x20address\x20<b>','delete-alerts','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','sendMetricsTelegram','all','add','enabled','allow','latestversion','build2','</b>\x20?','NTBA_FIX_319','No\x20bots\x20running\x20right\x20now','toggleBotMode','send','Login\x20accepted','backup-full@','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','7qBpeXE','.zip','get','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','mode','sockets','bot','5\x20min','file','#RES#\x20if\x20running\x20locally\x0a','exchange','deleteHistoryAlerts','showConfig','version','showname','#RES#\x20if\x20running\x20on\x20server','config/','filter','emit','Restoring\x20bot(s)\x20from\x20backup','accept','getHours','$1_$2_$3','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Setting\x20access:\x20','Node.js\x20v','3097914AJifWR','jsonwebtoken','whitelist',':\x20Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','new','slice','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','/:bot/configuration','Yes','Starting\x20new\x20bot\x20|\x20Bot\x20','delete-bot','\x20mode','restore-backup-file','get-portfolio','telegramChatId','download','function','exp','headers','\x20to\x20','\x20|\x20','confirm-message','(staging)','getMonth','1504268HdMcsm','_data','onepagemode','restart','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','isDirectory','log','versions','env','privateKey','getSeconds','output-003.log','once','<b>Telegram\x20Bot\x20Status:</b>\x0a','address','All\x20bots','File\x20uploaded','timestamp','from','sign','track','decrypt','Ok,\x20will\x20send\x20alert\x20notifications\x20only','push','Bot\x20Mgr\x20>\x20','show','telegramEvents','0.0.0','family','map','use','search','Error\x20removing\x20old\x20backup\x20files:','remoteAddress','backup-full','Unauthorized\x20attempt\x20to\x20store\x20configuration','kill','\x20minutes','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','manual','warning','stringify','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/metrics\x20-\x20show\x20bot\x20performance\x0a','update','orders','Invalid\x20IP\x20address','/output-000.log','keys','disabled','graphql-request','\x20|\x20client:\x20...','SIGINT','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','All\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramToken',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','encryptedUuid','Orders','entries','node-zip','Notifications\x20disabled','readFileSync','get-backup-files','isValid','Temporary\x20access\x20rejected','callback_query','request','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','version.json','reinstall','hasOwnProperty','Unauthorized\x20attempt\x20to\x20get\x20messages','1000','randomFillSync','lastmsgtelegram','backup','handshake','login','message','Unauthorized\x20attempt\x20to\x20add\x20bot','reject','telegram','token','/:bot/portfolio','headless','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','258188fWQHjF','toggle-bot-mode','referer','title','status','#RES#\x20','/:bot','createWriteStream','111560pGZyEO','botmanager','server','apply','sort','hex','pidRefreshToken','mtime','forEach','placeOrder','temporary\x20access\x20rejected','tkn','chat','order','secure','set','telegramUsername','\x20|\x20user:\x20...','stopped','Network\x20Interfaces:','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Error\x20while\x20deleting\x20config\x20files:\x20','backup-files','write','*$1*','existsSync','Starting\x20#RED#Balance\x20Bot\x20v','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','sendFile','uuid','min','access\x20timeout','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Notifications\x20disabled\x0a','split','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Logged\x20in\x20user\x20...','reset-history','index.html','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','bbPassword','find','1112280VjhpZD','bbvNew','Notifications\x20enabled\x0a','apiPassword','temporary\x20access\x20not\x20allowed','whitelistEnabled','uuid-random','/:bot/coins','Do\x20you\x20want\x20to\x20reset\x20your\x20password?',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','new-disabled','Session\x20expired\x20for\x20user\x20...','reload','Unauthorized\x20attempt\x20to\x20download\x20','Idling\x20bot\x20\x20\x20|\x20Bot\x20','replace','getFullYear','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','test','lastmsgemitted','user','auth','api-eu.mixpanel.com','answerCallbackQuery','bb-config.json','***','Server','constructor','(((.+)+)+)+$','copyFileSync','hashSync','private','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','inherit','output-001.log','2FA\x20login\x20rejected','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','expiry','1798209JNcqeO','bot.js','::1','Password\x20reset\x20rejected','output-000.log','temporary\x20token\x20generated','lowdb','any','includes','listen','Unauthorized\x20attempt\x20to\x20log\x20out','Backup\x20file\x20unzipped\x20and\x20stored','Unauthorized\x20attempt\x20to\x20confirm\x20message','build','[ip-address]','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','https://api.ipify.org?format=json','update-bb','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','catch','format','secret','removeAllListeners','\x1b[33m','userid','internal','post','logs/','get-starting-balances','2FA\x20login\x20required','SIGTERM','sha256','storeFiat','event','You\x20can\x20use\x20the\x20following\x20commands:\x0a','express-fileupload','error','rmSync','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','access','startsWith','::ffff:127.0.0.1','alerts','match','Restore\x20backup\x20file\x20','padStart','Token\x20blacklisted','success','argv','login\x20not\x20required','/download/:type','Bot\x20','static','Unauthorized\x20login\x20attempt\x20(timeout)','backup/','bb-settings.json','unlinkSync','socket.io','add-bot','Starting\x20bot\x20|\x20Bot\x20','yes','readdirSync','/on\x20-\x20start\x20bot(s)\x0a','updatebotmanager','running','getUTCHours','toIPv4Address','initclient','IPv4','404\x20Not\x20Found','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/:bot/support','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','max','size','login\x20required','publicKey','\x1b[36m','sendMessage','connection','\x20(1)','************','ipv6','logged\x20out','params','remove','telegram2FaApproval','data','fork','2FA','Your\x20installation\x20is\x20already\x20up\x20to\x20date','login\x20token\x20generated','notification','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','removeListener','/upload-backup','getTime','logout','/status\x20-\x20show\x20bot(s)\x20status\x0a','update-bot','reason','3pSSNkw','storeConfiguration','botID','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','simple','alias','sendPortfolioTelegram','store','telegramEnabled','\x1b[34m','\x20>\x20','host','/names\x20-\x20show\x20bot\x20names\x0a','conn','auto','uncaughtException','Alerts','exec','=>\x20Go\x20to\x20#CYA#http://','util','live','emitHistory','length','environment','staging','HTML','toString','temp/','sortBy','telegramIpApproval','blacklist','output-002.log','All','loginRequired','127.0.0.1','Logged\x20out\x20user\x20...','-events.json','-config.json','Deleted\x20Bot\x20','join','mkdirSync','string','value','username','Disabled\x20Bot\x20','full','number','-performance.json','f2aRequired','Crypt','Backup\x20file\x20uploaded','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','\x1b[31m','started'];_0x10cb=function(){return _0x479702;};return _0x10cb();}function getBotAttributes(_0x5f1ff3){const _0x3945c1=_0x4af2cf;let _0x103ba2={};const _0x14dd34=configpath+_0x3945c1(0x1c9)+_0x5f1ff3+_0x3945c1(0x19f),_0x1f5299=fs[_0x3945c1(0xdc)](_0x14dd34);if(_0x1f5299){const _0x1e7d83=fs[_0x3945c1(0x290)](_0x14dd34);try{const _0x3a848b=JSON[_0x3945c1(0x1c5)](_0x1e7d83),_0x199f1a=_0x3a848b?_0x3a848b[_0x3945c1(0x222)][0x0]['headless']:![];_0x103ba2[_0x3945c1(0x220)]=_0x199f1a?_0x3945c1(0x188):_0x3945c1(0x276),_0x103ba2[_0x3945c1(0x1fa)]=_0x3a848b?_0x3a848b['bot'][0x0][_0x3945c1(0x1fa)]:'Bot\x20'+_0x5f1ff3;}catch(_0x18fa6c){_0x103ba2[_0x3945c1(0x220)]=_0x3945c1(0x276),_0x103ba2['botname']=_0x3945c1(0x148)+_0x5f1ff3;}}else _0x103ba2[_0x3945c1(0x220)]='manual',_0x103ba2['botname']=_0x3945c1(0x148)+_0x5f1ff3;return _0x103ba2;}function getBotsWithMode(){const _0x22fb68=_0x4af2cf,_0x49e36d=dbConfig[_0x22fb68(0x21e)]('bots')[_0x22fb68(0x196)](_0x22fb68(0x17c))[_0x22fb68(0x1a4)]()||[];return _0x49e36d[_0x22fb68(0x2b9)](_0x433b6a=>{const _0x155697=_0x22fb68;let _0x10a1f8=getBotAttributes(_0x433b6a[_0x155697(0x17c)]);_0x433b6a[_0x155697(0x220)]=_0x10a1f8[_0x155697(0x220)];}),_0x49e36d;}function getBotExchanges(){const _0x495d24=_0x4af2cf;let _0x1da9fc=[];const _0x5d0d24=dbConfig[_0x495d24(0x21e)](_0x495d24(0x1d1))['sortBy']('botID')[_0x495d24(0x1a4)]()||[];_0x5d0d24[_0x495d24(0x2b9)](_0x45a1ba=>{const _0xab7d6d=_0x495d24;if(_0x45a1ba['status']==_0xab7d6d(0x210)){const _0x2ad272=configpath+_0xab7d6d(0x1c9)+_0x45a1ba[_0xab7d6d(0x17c)]+_0xab7d6d(0x19f),_0x509aa6=fs[_0xab7d6d(0xdc)](_0x2ad272);let _0x2d37f0;if(_0x509aa6){const _0xa09076=fs[_0xab7d6d(0x290)](_0x2ad272);try{const _0x1e8909=JSON['parse'](_0xa09076);_0x2d37f0=_0x1e8909?_0x1e8909[_0xab7d6d(0x222)][0x0][_0xab7d6d(0x226)]:null;}catch(_0x5d5f74){}}if(_0x2d37f0)_0x1da9fc[_0xab7d6d(0x266)](_0x2d37f0);}});const _0x31911d=[...new Set(_0x1da9fc)]['sort']();return _0x31911d;}async function initUser(){const _0x1b29ab=_0x4af2cf;if(!settings['userid']){const _0x17f040=uuidRandom();mixpanel[_0x1b29ab(0x17f)](_0x17f040),updateSetting(_0x1b29ab(0x12d),_0x17f040);}}async function initSecure(){const _0x44fa42=_0x4af2cf;let _0x59d175=getSecure();if(!_0x59d175['hasOwnProperty']('secret')){let _0x43575f=await generateKeys();_0x59d175['publicKey']=_0x43575f[_0x44fa42(0x161)],_0x59d175['privateKey']=_0x43575f[_0x44fa42(0x258)],_0x59d175[_0x44fa42(0x12a)]=crypto['randomBytes'](0x20)[_0x44fa42(0x194)](_0x44fa42(0x2b6));;storeSecure(_0x59d175);}}function getSettings(){const _0x54d341=_0x4af2cf;return dbSettings[_0x54d341(0x21e)]('settings')[_0x54d341(0x1a4)]()||{};}function getSecure(){const _0x42dd4d=_0x4af2cf;return dbSecure['get'](_0x42dd4d(0x2bf))['value']()||{};}function getBlacklist(){const _0x609c7c=_0x4af2cf;return dbSecure['get'](_0x609c7c(0x198))[_0x609c7c(0x1a4)]()||[];}function broadcastToBots(_0x261b96,_0x573aa8){const _0x251022=_0x4af2cf;config[_0x251022(0x2b9)](_0x1c8830=>{const _0xcfa22d=_0x251022;if(_0x1c8830['status']==_0xcfa22d(0x210)&&_0x1c8830[_0xcfa22d(0x18e)]==_0xcfa22d(0x155)||_0x1c8830[_0xcfa22d(0x2ad)]==_0xcfa22d(0x23b)&&_0x1c8830['live']==_0xcfa22d(0x155)){if(pid[_0x1c8830['botID']])pid[_0x1c8830['botID']]['send']({[_0x261b96]:_0x573aa8});}});}function storeSettings(_0x4c1efc,_0x1397b9=![]){const _0x4b2066=_0x4af2cf;_0x4c1efc={...settings,..._0x4c1efc};if(_0x1397b9&&_0x4c1efc['bbPassword']!=_0x4b2066(0x166)&&_0x4c1efc['bbPassword']!=_0x4b2066(0x107)&&_0x4c1efc[_0x4b2066(0xeb)]!=''){const _0x1e7058=crypt['decrypt'](secure[_0x4b2066(0x258)],_0x4c1efc[_0x4b2066(0xeb)])[_0x4b2066(0x2a1)][_0x4b2066(0xe5)]('@')[0x0],_0x2a3562=bcrypt[_0x4b2066(0x10c)](_0x1e7058,saltRounds);_0x4c1efc={..._0x4c1efc,'bbPassword':_0x2a3562};}if(_0x1397b9&&_0x4c1efc[_0x4b2066(0x289)]!='************'&&_0x4c1efc[_0x4b2066(0x289)]!=_0x4b2066(0x107)&&_0x4c1efc[_0x4b2066(0x289)]!=''){const _0x526e69=crypt[_0x4b2066(0x264)](secure[_0x4b2066(0x258)],_0x4c1efc[_0x4b2066(0x289)])[_0x4b2066(0x2a1)]['split']('@')[0x0];_0x4c1efc={..._0x4c1efc,'telegramToken':_0x526e69};}const _0x43db78=_0x4c1efc[_0x4b2066(0x289)]!=_0x4b2066(0x166)&&_0x4c1efc[_0x4b2066(0x289)]!=settings[_0x4b2066(0x289)]||_0x4c1efc['telegramUsername']!=settings[_0x4b2066(0x2c1)],_0x59e917=_0x4c1efc[_0x4b2066(0x289)]==''||_0x4c1efc[_0x4b2066(0x2c1)]=='';if(_0x43db78)_0x4c1efc[_0x4b2066(0x269)]=_0x4b2066(0x20e);for(const [_0x2de6f9,_0x3dd8b3]of Object[_0x4b2066(0x28d)](_0x4c1efc)){if(_0x2de6f9==_0x4b2066(0x289)&&_0x3dd8b3==_0x4b2066(0x166)){_0x4c1efc[_0x4b2066(0x289)]=settings[_0x4b2066(0x289)];continue;};if(_0x2de6f9=='bbPassword'&&_0x3dd8b3==_0x4b2066(0x166)){_0x4c1efc[_0x4b2066(0xeb)]=settings[_0x4b2066(0xeb)];continue;};dbSettings[_0x4b2066(0x2c0)](_0x4b2066(0x1c0)+_0x2de6f9,_0x3dd8b3)[_0x4b2066(0xda)]();}settings=_0x4c1efc,io['to'](_0x4b2066(0x2b2))[_0x4b2066(0x22e)](_0x4b2066(0x205),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x4b2066(0x251),settings['onepagemode']);if(_0x43db78&&!_0x59e917)initTelegram();if(_0x43db78&&_0x59e917)disableTelegram();getAllClients()['forEach'](_0x53efee=>{const _0x826d9b=_0x4b2066;getSocket(_0x53efee['id'])[_0x826d9b(0x22e)](_0x826d9b(0x2ad),{'access':{'allow':![],'reason':_0x826d9b(0xf9),'token':null}});});}function updateSetting(_0x294682,_0x51f990){const _0x2a825d=_0x4af2cf;dbSettings['set'](_0x2a825d(0x1c0)+_0x294682,_0x51f990)['write'](),settings=getSettings(),io['to']('botmanager')[_0x2a825d(0x22e)](_0x2a825d(0x205),cleanSettings());}function storeSecure(_0x214374){const _0x4efcf2=_0x4af2cf;dbSecure[_0x4efcf2(0x21e)]('secure')[_0x4efcf2(0x266)](_0x214374)[_0x4efcf2(0xda)](),secure=_0x214374;}function addBlacklist(_0x2d081d){const _0x5aa758=_0x4af2cf;cleanBlacklist();let _0x413a30;devices[_0x2d081d][_0x5aa758(0x197)]?_0x413a30=Math[_0x5aa758(0x15e)](devices[_0x2d081d][_0x5aa758(0x197)][_0x5aa758(0x113)],loginExpiry):_0x413a30=loginExpiry,dbSecure[_0x5aa758(0x21e)](_0x5aa758(0x198))[_0x5aa758(0x266)]({'expiry':new Date()[_0x5aa758(0x175)]()+_0x413a30*0x3c*0x3e8,'token':devices[_0x2d081d][_0x5aa758(0x13c)][_0x5aa758(0x2a5)]})[_0x5aa758(0xda)](),blacklist=dbSecure[_0x5aa758(0x21e)](_0x5aa758(0x198))[_0x5aa758(0x1a4)]();}function cleanBlacklist(){const _0xe88df4=_0x4af2cf;let _0x3c1f8b=dbSecure[_0xe88df4(0x21e)](_0xe88df4(0x198))[_0xe88df4(0x1c3)]()[_0xe88df4(0x1a4)](),_0x44dc11=new Date()['getTime']();_0x3c1f8b['forEach'](_0x4bf628=>{const _0x164c87=_0xe88df4;_0x4bf628[_0x164c87(0x113)]<_0x44dc11&&dbSecure[_0x164c87(0x21e)]('blacklist')[_0x164c87(0x16a)]({'expiry':_0x4bf628[_0x164c87(0x113)]})[_0x164c87(0xda)]();});}function initStates(){const _0x527a5a=_0x4af2cf;let _0x36f5f8=getConfiguration();_0x36f5f8[_0x527a5a(0x2b9)](_0x3cb2f9=>{const _0x11aed3=_0x527a5a;_0x3cb2f9[_0x11aed3(0x18e)]=_0x11aed3(0x2c3);}),storeConfiguration(_0x36f5f8);}function onKeys(){const _0x5e2fe5=new RSA();return new Promise(_0x5a2c81=>{const _0x4316db=_0x2b8a;_0x5e2fe5['generateKeyPairAsync']()[_0x4316db(0x1bf)](_0x111fdf=>{_0x5a2c81(_0x111fdf);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x103a9a=_0x4af2cf;let _0x42e193=getSettings(),_0x345685=![];!_0x42e193['hasOwnProperty'](_0x103a9a(0x29d))&&(_0x42e193[_0x103a9a(0x29d)]=0x0,_0x345685=!![]);!_0x42e193[_0x103a9a(0x299)](_0x103a9a(0x101))&&(_0x42e193[_0x103a9a(0x101)]=0x0,_0x345685=!![]);!_0x42e193[_0x103a9a(0x299)](_0x103a9a(0x212))&&(_0x42e193[_0x103a9a(0x212)]='0.0.0',_0x345685=!![]);!_0x42e193[_0x103a9a(0x299)](_0x103a9a(0x251))&&(_0x42e193['onepagemode']=![],_0x345685=!![]);if(_0x345685)storeSettings(_0x42e193);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x104bf3=>{const _0x4a4af2=_0x103a9a;if(!_0x104bf3[_0x4a4af2(0x254)]()){if(!_0x104bf3[_0x4a4af2(0x1d6)][_0x4a4af2(0x13d)](_0x4a4af2(0x21a)))fs[_0x4a4af2(0x14d)](configbackuppath+_0x104bf3[_0x4a4af2(0x1d6)]);}else fs[_0x4a4af2(0x13a)](configbackuppath+_0x104bf3[_0x4a4af2(0x1d6)],{'recursive':!![]});});}catch(_0x1f5e98){logger['debug'](_0x103a9a(0x26f),_0x1f5e98);}}function storeConfiguration(_0x15ef66){const _0x38dac3=_0x4af2cf;dbConfig[_0x38dac3(0x21e)](_0x38dac3(0x1d1))['remove']()[_0x38dac3(0xda)](),_0x15ef66[_0x38dac3(0x2b9)](_0x561479=>{delete _0x561479['mode'];}),dbConfig[_0x38dac3(0x21e)](_0x38dac3(0x1d1))[_0x38dac3(0x266)](..._0x15ef66)[_0x38dac3(0xda)](),config=_0x15ef66;}function resetPassword(){const _0x42ad76=_0x4af2cf;tgBot&&settings[_0x42ad76(0x245)]&&(tgBot[_0x42ad76(0x173)](_0x42ad76(0x294)),tgBot[_0x42ad76(0x163)](settings[_0x42ad76(0x245)],_0x42ad76(0xf5),{'parse_mode':_0x42ad76(0x193),'reply_markup':{'inline_keyboard':[[{'text':_0x42ad76(0x151),'callback_data':_0x42ad76(0x151)},{'text':'no','callback_data':'no'}]]}})[_0x42ad76(0x128)](_0x1edc29=>{telegramError(_0x1edc29);}),tgBot['on'](_0x42ad76(0x294),async _0x1f304e=>{const _0x3dcbac=_0x42ad76,_0x24bfcd=_0x1f304e[_0x3dcbac(0x16c)],_0x194eb6=_0x1f304e[_0x3dcbac(0x2a1)];tgBot['answerCallbackQuery'](_0x1f304e['id'])[_0x3dcbac(0x1bf)](async()=>{const _0x28d929=_0x3dcbac;if(_0x24bfcd!='no'){const _0x1b3eb5=0xf,_0x3e048e=_0x28d929(0x17d),_0x15a2e6=Array[_0x28d929(0x261)](crypto[_0x28d929(0x29c)](new Uint32Array(_0x1b3eb5)))[_0x28d929(0x26c)](_0x190829=>_0x3e048e[_0x190829%_0x3e048e[_0x28d929(0x190)]])[_0x28d929(0x1a1)](''),_0x462513=bcrypt['hashSync'](_0x15a2e6,saltRounds);storeSettings({'bbPassword':_0x462513}),await tgBot[_0x28d929(0x163)](_0x194eb6[_0x28d929(0x2bd)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x15a2e6,{'parse_mode':_0x28d929(0x193)})[_0x28d929(0x128)](_0x4882b8=>{telegramError(_0x4882b8);});}else await tgBot[_0x28d929(0x163)](_0x194eb6[_0x28d929(0x2bd)]['id'],_0x28d929(0x117))[_0x28d929(0x128)](_0x5c63b8=>{telegramError(_0x5c63b8);});}),tgBot['removeListener'](_0x3dcbac(0x294));}));}async function confirmRestore(_0x3a600f,_0x41f0cf){const _0x1ad839=_0x4af2cf;io['to']('botmanager')['emit'](_0x1ad839(0x171),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x1ad839(0x144)),tgBot&&settings[_0x1ad839(0x245)]&&(tgBot[_0x1ad839(0x173)](_0x1ad839(0x294)),await tgBot[_0x1ad839(0x163)](settings[_0x1ad839(0x245)],_0x1ad839(0x1f8),{'parse_mode':_0x1ad839(0x193),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x1ad839(0x151)},{'text':'no','callback_data':'no'}]]}})[_0x1ad839(0x128)](_0x435154=>{telegramError(_0x435154);}),tgBot['on'](_0x1ad839(0x294),async _0x28f916=>{const _0x5b080c=_0x1ad839,_0x58ad70=_0x28f916['data'],_0x560569=_0x28f916[_0x5b080c(0x2a1)];tgBot[_0x5b080c(0x105)](_0x28f916['id'])[_0x5b080c(0x1bf)](async()=>{const _0x3dc735=_0x5b080c;_0x58ad70==_0x3dc735(0x151)?(await tgBot[_0x3dc735(0x163)](_0x560569[_0x3dc735(0x2bd)]['id'],_0x3dc735(0x22f),{'parse_mode':_0x3dc735(0x193)})[_0x3dc735(0x128)](_0x54f06a=>{telegramError(_0x54f06a);}),unzipFile(_0x3a600f,_0x41f0cf)):(logger['debug'](_0x3dc735(0x203)),await tgBot[_0x3dc735(0x163)](_0x560569[_0x3dc735(0x2bd)]['id'],_0x3dc735(0x203))[_0x3dc735(0x128)](_0x2d94d1=>{telegramError(_0x2d94d1);}));}),tgBot['removeListener'](_0x5b080c(0x294));}));}function getServerTime(){const _0x3c2daa=_0x4af2cf,_0x284bea=new Date();return _0x284bea[_0x3c2daa(0xfd)]()+'/'+(_0x284bea[_0x3c2daa(0x24e)]()+0x1)[_0x3c2daa(0x194)]()[_0x3c2daa(0x142)](0x2,'0')+'/'+_0x284bea[_0x3c2daa(0x201)]()[_0x3c2daa(0x194)]()['padStart'](0x2,'0')+'\x20'+_0x284bea[_0x3c2daa(0x231)]()['toString']()['padStart'](0x2,'0')+':'+_0x284bea['getMinutes']()[_0x3c2daa(0x194)]()[_0x3c2daa(0x142)](0x2,'0')+':'+_0x284bea[_0x3c2daa(0x259)]()[_0x3c2daa(0x194)]()[_0x3c2daa(0x142)](0x2,'0');}function getTimeStamp(){const _0x16eb21=_0x4af2cf,_0x1c509b=shiftedTime();return _0x1c509b[_0x16eb21(0xfd)]()+'/'+(_0x1c509b['getMonth']()+0x1)[_0x16eb21(0x194)]()['padStart'](0x2,'0')+'/'+_0x1c509b[_0x16eb21(0x201)]()[_0x16eb21(0x194)]()['padStart'](0x2,'0')+'\x20'+_0x1c509b[_0x16eb21(0x231)]()[_0x16eb21(0x194)]()[_0x16eb21(0x142)](0x2,'0')+':'+_0x1c509b[_0x16eb21(0x1df)]()[_0x16eb21(0x194)]()[_0x16eb21(0x142)](0x2,'0')+':'+_0x1c509b['getSeconds']()[_0x16eb21(0x194)]()[_0x16eb21(0x142)](0x2,'0');}function getCleanTimeStamp(){const _0xe1cef6=_0x4af2cf,_0x4edf77=shiftedTime();return _0x4edf77[_0xe1cef6(0xfd)]()+(_0x4edf77[_0xe1cef6(0x24e)]()+0x1)[_0xe1cef6(0x194)]()[_0xe1cef6(0x142)](0x2,'0')+_0x4edf77[_0xe1cef6(0x201)]()['toString']()[_0xe1cef6(0x142)](0x2,'0')+'-'+_0x4edf77[_0xe1cef6(0x231)]()[_0xe1cef6(0x194)]()[_0xe1cef6(0x142)](0x2,'0')+_0x4edf77[_0xe1cef6(0x1df)]()['toString']()[_0xe1cef6(0x142)](0x2,'0')+_0x4edf77[_0xe1cef6(0x259)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0xc62167=_0x4af2cf,_0x5996bd=new Date();let _0x171e15=_0x5996bd;if(settings[_0xc62167(0x1b4)]&&settings[_0xc62167(0x1b4)]!==0x0)_0x171e15=fns[_0xc62167(0x20f)](_0x5996bd,{'hours':settings[_0xc62167(0x1b4)]});return _0x171e15;}function startScheduler(){const _0x5f25f=_0x4af2cf,_0x222d92=new Date()[_0x5f25f(0x156)](),_0x2bb31e=shiftedTime()[_0x5f25f(0x231)]();_0x2bb31e==0x4&&backupConfigFiles();_0x2bb31e==0x0&&rotateLogFiles();_0x222d92%0x6==0x0&&triggerAnalytics();_0x222d92%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x17c82d){const _0x3c411c=_0x4af2cf;logger[_0x3c411c(0x202)](_0x3c411c(0x141)+_0x17c82d);const _0x183d40=getBotsWithMode();_0x183d40['length']>0x0?confirmRestore(configbackuppath,_0x17c82d):unzipFile(configbackuppath,_0x17c82d);}async function getBackupFiles(_0x360907=null){const _0x552a58=_0x4af2cf;let _0x28db9b=[],_0x202ef9=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x202ef9['sort']((_0x4a2016,_0x587e1f)=>_0x4a2016['name']<_0x587e1f['name']?0x1:_0x587e1f['name']<_0x4a2016[_0x552a58(0x1d6)]?-0x1:0x0),_0x202ef9[_0x552a58(0x2b9)](_0x25d61f=>{const _0x36b7ab=_0x552a58;if(!_0x25d61f[_0x36b7ab(0x254)]()&&_0x25d61f['name']['startsWith'](_0x36b7ab(0x21a))&&_0x25d61f['name'][_0x36b7ab(0x209)](_0x36b7ab(0x21d))){const _0x43f984=formatDate(fs[_0x36b7ab(0x1eb)](configbackuppath+_0x25d61f[_0x36b7ab(0x1d6)])[_0x36b7ab(0x2b8)]);_0x28db9b[_0x36b7ab(0x266)]({'name':_0x25d61f[_0x36b7ab(0x1d6)],'mtime':_0x43f984});}});if(_0x360907)io['to'](_0x360907)[_0x552a58(0x22e)](_0x552a58(0xd9),_0x28db9b);else return _0x28db9b;}async function backupConfigFiles(){const _0x56d0e0=_0x4af2cf;await zipFiles(_0x56d0e0(0x271));const _0x4bcd15=getCleanTimeStamp();fs[_0x56d0e0(0x10b)](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x4bcd15+_0x56d0e0(0x21d)));let _0x872d5c=fs[_0x56d0e0(0x152)](configbackuppath,{'withFileTypes':!![]});_0x872d5c[_0x56d0e0(0x2b5)]((_0x4829a2,_0x3af653)=>_0x4829a2[_0x56d0e0(0x1d6)]<_0x3af653[_0x56d0e0(0x1d6)]?0x1:_0x3af653[_0x56d0e0(0x1d6)]<_0x4829a2['name']?-0x1:0x0),_0x872d5c[_0x56d0e0(0x190)]>maxBackups&&fs[_0x56d0e0(0x14d)](configbackuppath+_0x872d5c[_0x872d5c[_0x56d0e0(0x190)]-0x1][_0x56d0e0(0x1d6)]);}function rotateLogFiles(){const _0x595123=_0x4af2cf,_0x54ac38=fs[_0x595123(0x1eb)](logspath+_0x595123(0x118)),_0x4fb4fc=_0x54ac38[_0x595123(0x15f)]/0x400;if(_0x4fb4fc>0x64){let _0x4e017e=fs[_0x595123(0x152)](logspath,{'withFileTypes':!![]});_0x4e017e[_0x595123(0x2b5)]((_0x5f4d9d,_0x270b26)=>_0x5f4d9d[_0x595123(0x1d6)]<_0x270b26[_0x595123(0x1d6)]?0x1:_0x270b26[_0x595123(0x1d6)]<_0x5f4d9d['name']?-0x1:0x0),_0x4e017e[_0x595123(0x2b9)](_0x2f5c9e=>{const _0x17d18b=_0x595123;if(_0x2f5c9e[_0x17d18b(0x1d6)]==_0x17d18b(0x199))fs[_0x17d18b(0x10b)](logspath+_0x2f5c9e[_0x17d18b(0x1d6)],logspath+_0x17d18b(0x25a));if(_0x2f5c9e['name']==_0x17d18b(0x110))fs[_0x17d18b(0x10b)](logspath+_0x2f5c9e[_0x17d18b(0x1d6)],logspath+_0x17d18b(0x199));_0x2f5c9e['name']==_0x17d18b(0x118)&&(fs[_0x17d18b(0x10b)](logspath+_0x2f5c9e[_0x17d18b(0x1d6)],logspath+_0x17d18b(0x110)),fs[_0x17d18b(0x1c2)](logspath+_0x2f5c9e[_0x17d18b(0x1d6)],''));});}}async function zipFiles(_0x1e384a){const _0x5d46db=_0x4af2cf;let _0xc9e648;if(_0x1e384a==_0x5d46db(0x1c8))_0xc9e648=logspath;if(_0x1e384a=='backup')_0xc9e648=configpath;if(_0x1e384a=='backup-full')_0xc9e648=configpath;let _0x2afe29=fs['readdirSync'](_0xc9e648,{'withFileTypes':!![]});const _0x3b036e=new require(_0x5d46db(0x28e))();_0x2afe29[_0x5d46db(0x2b9)](_0x4dfc04=>{const _0x572c96=_0x5d46db;if(!_0x4dfc04[_0x572c96(0x254)]()){let _0x42ed53=fs[_0x572c96(0x290)](_0xc9e648+_0x4dfc04[_0x572c96(0x1d6)]);if(_0x1e384a==_0x572c96(0x29e)){const _0x5ee3c7=/^bot-[0-9]{3}-config.json$/,_0x56c5a6=_0x5ee3c7[_0x572c96(0x100)](_0x4dfc04[_0x572c96(0x1d6)]);if(_0x56c5a6){const _0x2aa1f8=JSON[_0x572c96(0x1c5)](_0x42ed53);if(_0x2aa1f8[_0x572c96(0x222)][0x0]){_0x2aa1f8[_0x572c96(0x222)][0x0]['apiKey']=_0x572c96(0x107),_0x2aa1f8[_0x572c96(0x222)][0x0]['apiSecret']=_0x572c96(0x107);if(_0x2aa1f8[_0x572c96(0x222)][0x0][_0x572c96(0xf0)])_0x2aa1f8['bot'][0x0][_0x572c96(0xf0)]='***';}_0x42ed53=JSON['stringify'](_0x2aa1f8,null,0x2);}if(_0x4dfc04['name']==_0x572c96(0x14c)){const _0x38ffec=JSON[_0x572c96(0x1c5)](_0x42ed53);if(_0x38ffec[_0x572c96(0x205)][_0x572c96(0x19b)])_0x38ffec[_0x572c96(0x205)][_0x572c96(0x19b)]=![];if(_0x38ffec[_0x572c96(0x205)][_0x572c96(0xeb)])_0x38ffec[_0x572c96(0x205)]['bbPassword']=_0x572c96(0x107);if(_0x38ffec[_0x572c96(0x205)][_0x572c96(0x289)])_0x38ffec[_0x572c96(0x205)]['telegramToken']=_0x572c96(0x107);if(_0x38ffec['settings'][_0x572c96(0x245)])_0x38ffec['settings'][_0x572c96(0x245)]=null;_0x42ed53=JSON[_0x572c96(0x278)](_0x38ffec,null,0x2);}if(_0x4dfc04['name']!='bb-secure.json')_0x3b036e[_0x572c96(0x224)](_0x4dfc04[_0x572c96(0x1d6)],_0x42ed53);}else _0x3b036e[_0x572c96(0x224)](_0x4dfc04[_0x572c96(0x1d6)],_0x42ed53);}});const _0x14c53a=_0x3b036e['generate']({'base64':![],'compression':_0x5d46db(0x1fb)});fs[_0x5d46db(0x1c2)](zippath+(_0x1e384a+_0x5d46db(0x21d)),_0x14c53a,'binary');}async function unzipFile(_0x42d3cf,_0x56ba4a){const _0x4f8984=_0x4af2cf;fs[_0x4f8984(0x152)](configpath,{'withFileTypes':!![]})[_0x4f8984(0x2b9)](_0x45446c=>{const _0x476bde=_0x4f8984;if(!_0x45446c['isDirectory']())fs[_0x476bde(0x13a)](configpath+_0x45446c['name']);});const _0x191d7b=fs[_0x4f8984(0x290)](_0x42d3cf+_0x56ba4a,'binary'),_0x519d01=new require(_0x4f8984(0x28e))(_0x191d7b,{'base64':![],'checkCRC32':!![]});Object[_0x4f8984(0x280)](_0x519d01[_0x4f8984(0x1d8)])[_0x4f8984(0x2b9)](_0xbfbc30=>{const _0x4b4111=_0x4f8984,_0x52be55=_0x519d01[_0x4b4111(0x1d8)][_0xbfbc30];fs[_0x4b4111(0x1c2)](configpath+_0x52be55[_0x4b4111(0x1d6)],_0x52be55[_0x4b4111(0x250)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x4f8984(0x2b9)](_0x40c0e2=>{const _0x3dad83=_0x4f8984;if(!_0x40c0e2[_0x3dad83(0x254)]())fs[_0x3dad83(0x13a)](temppath+_0x40c0e2[_0x3dad83(0x1d6)]);}),logger[_0x4f8984(0x202)](_0x4f8984(0x11f)),process[_0x4f8984(0x218)]({'restore':!![]},_0x59aade=>{});}async function getPublicIp(){const _0x275c0f=_0x4af2cf;try{const _0xac1506=await axios[_0x275c0f(0x21e)](_0x275c0f(0x124));publicip=_0xac1506[_0x275c0f(0x16c)]['ip'];}catch(_0x19986e){}}async function triggerAnalytics(){const _0x575b91=_0x4af2cf;if(!publicip)await getPublicIp();const _0x57729d=getBotsWithMode();let _0x20d5e9=0x0;_0x57729d['forEach'](_0xeee14=>{const _0x1bc011=_0x2b8a;if(_0xeee14['status']===_0x1bc011(0x210))_0x20d5e9++;});const _0x2b9c05=getBotExchanges();mixpanel[_0x575b91(0x263)](_0x575b91(0x108),{'distinct_id':settings[_0x575b91(0x12d)],'ip':publicip,'version':serverversion,'numbots':_0x57729d[_0x575b91(0x190)],'numbotsenabled':_0x20d5e9,'exchanges':_0x2b9c05,'environment':environment});}async function getMessages(){const _0x277bc0=_0x4af2cf,_0x5acc41=_0x277bc0(0x296),_0x307547=new GraphQLClient(_0x5acc41),_0x2ac0da={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x7d9ea6=serverversion['split']('.'),_0x5b955e=_0x7d9ea6[0x0]+'.'+_0x7d9ea6[0x1],_0x2af317=Math[_0x277bc0(0xe1)](settings['lastmsgtelegram'],settings[_0x277bc0(0x101)]),_0x3ac938={'last':parseInt(_0x2af317),'bbm':_0x5b955e},_0x531cf4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4c71cb;try{_0x4c71cb=await _0x307547[_0x277bc0(0x295)](_0x531cf4,_0x3ac938,_0x2ac0da);}catch(_0x3ff103){}if(_0x4c71cb&&_0x4c71cb[_0x277bc0(0x1c4)]){let _0x22e512=settings[_0x277bc0(0x29d)];newMessages=[];for(const _0x686aa6 of _0x4c71cb[_0x277bc0(0x1c4)]){newMessages['push'](_0x686aa6);let _0x1a8b3e=![];_0x686aa6[_0x277bc0(0xee)]&&(updateSetting('latestversion',_0x686aa6[_0x277bc0(0xee)]),_0x1a8b3e=isNewerVersion(serverversion,_0x686aa6[_0x277bc0(0xee)])||serverversion==_0x686aa6[_0x277bc0(0xee)]);if(!_0x1a8b3e&&_0x686aa6[_0x277bc0(0x1a8)]>_0x22e512){if(_0x686aa6['bbvReceive']===_0x277bc0(0x11b)||serverversion[_0x277bc0(0x13d)](_0x686aa6['bbvReceive'])){let _0x4f596b=''+_0x686aa6[_0x277bc0(0x2ac)]+'\x0a\x0a'+_0x686aa6['message'];const _0x15c9e1=await sendTelegramMsg(toTelegramMarkdown(_0x4f596b),'Markdown');if(_0x15c9e1)_0x22e512=_0x686aa6[_0x277bc0(0x1a8)];}}}updateAvailable=isNewerVersion(settings[_0x277bc0(0x212)],serverversion),updateSetting(_0x277bc0(0x29d),_0x22e512),emitMessages();}}function emitMessages(){const _0x42eb8f=_0x4af2cf,_0x89800c=settings[_0x42eb8f(0x101)];let _0x57dfdc=[];newMessages[_0x42eb8f(0x2b9)](_0x5d7bd9=>{const _0x40eabb=_0x42eb8f;_0x5d7bd9['number']>_0x89800c&&_0x57dfdc[_0x40eabb(0x266)](_0x5d7bd9);}),_0x57dfdc[_0x42eb8f(0x190)]>0x0&&getAllClients()['forEach'](_0x302595=>{const _0xe569eb=_0x42eb8f;getSocket(_0x302595['id'])['emit'](_0xe569eb(0x2a1),_0x57dfdc);});}function confirmMessage(_0x166a98){const _0x498192=_0x4af2cf;updateSetting(_0x498192(0x101),Number(_0x166a98));}function isNewerVersion(_0x3493ce,_0x237eee){const _0x3600dd=_0x4af2cf,_0x44fd26=_0x237eee[_0x3600dd(0xe5)]('.'),_0x145937=_0x3493ce[_0x3600dd(0xe5)]('.');for(var _0x7f015=0x0;_0x7f015<_0x145937[_0x3600dd(0x190)];_0x7f015++){const _0x15bc49=~~_0x145937[_0x7f015],_0x298a36=~~_0x44fd26[_0x7f015];if(_0x15bc49>_0x298a36)return!![];if(_0x15bc49<_0x298a36)return![];}return![];}function toTelegramMarkdown(_0x1c4e64){const _0x865add=_0x4af2cf,_0x22680c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5cbcfd=/\*{2}(.+?)\*{2}/gim;return _0x1c4e64=_0x1c4e64[_0x865add(0xfc)](_0x22680c,_0x865add(0x232))[_0x865add(0xfc)](_0x5cbcfd,_0x865add(0xdb)),_0x1c4e64;}async function validateConfigFile(){const _0x4e989c=_0x4af2cf,_0xfa35aa=dbConfig[_0x4e989c(0x21e)](_0x4e989c(0x1d1))[_0x4e989c(0x196)](_0x4e989c(0x17c))[_0x4e989c(0x1a4)]()||[];if(_0xfa35aa[_0x4e989c(0x190)]==0x0){let _0x59f6fa=0x0,_0xa9d024=[];const _0x4b8644=/^bot-([0-9]{3})-config.json$/,_0x2ff7ef=fs['readdirSync'](configpath);_0x2ff7ef[_0x4e989c(0x2b9)](_0x5e3842=>{const _0x93a0a0=_0x4e989c,_0xf29947=_0x4b8644[_0x93a0a0(0x18b)](_0x5e3842);if(_0xf29947){const _0x322f37=_0xf29947[0x1];let _0x487c6b=getBotAttributes(_0x322f37);_0xa9d024[_0x93a0a0(0x266)]({'botID':_0x322f37,'botname':_0x487c6b[_0x93a0a0(0x1fa)],'status':'disabled','live':_0x93a0a0(0x2c3)}),_0x59f6fa++;}}),_0x59f6fa!=0x0&&(dbConfig[_0x4e989c(0x21e)]('bots')[_0x4e989c(0x1bb)](_0xa9d024)[_0x4e989c(0xda)](),config=_0xa9d024,restoredConfigFile=_0x59f6fa);}}async function restoreConfigNotify(_0x5c7c43){const _0x36e904=_0x4af2cf;let _0x1a6004;if(restoredConfigFile==0x1)_0x1a6004=_0x36e904(0x10e);else _0x1a6004=_0x36e904(0x233);if(_0x5c7c43)io['to'](_0x36e904(0x2b2))['emit']('notification',_0x1a6004);else{logger[_0x36e904(0x17e)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x1a6004),logger[_0x36e904(0x17e)](_0x36e904(0x285)),logger[_0x36e904(0x17e)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x36e904(0x269)]!='orders')tgBot[_0x36e904(0x163)](settings[_0x36e904(0x245)],_0x36e904(0x267)+_0x1a6004)[_0x36e904(0x128)](_0x68c243=>{telegramError(_0x68c243);});}}function validateCredentials(_0x269fc8,_0x9d957c){const _0xf060f7=_0x4af2cf;if(_0x269fc8[_0xf060f7(0x1a5)]==settings[_0xf060f7(0x1de)]&&bcrypt[_0xf060f7(0x1d0)](_0x269fc8[_0xf060f7(0x1ee)],settings['bbPassword'])){if(settings[_0xf060f7(0x1aa)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x2c7f2c=generateLoginToken(_0x9d957c);return{'allow':!![],'reason':_0xf060f7(0x170),'token':_0x2c7f2c};}}else return{'allow':![],'reason':_0xf060f7(0x1b1),'token':null};}function refreshToken(_0xc64e60){const _0xfd1e18=_0x4af2cf,_0x41e98d=generateLoginToken(_0xc64e60);return{'allow':!![],'reason':_0xfd1e18(0x170),'token':_0x41e98d};}function validateAccess(_0x60970b,_0x29b55e,_0xb610b){const _0x4077ba=_0x4af2cf,_0x4db4f4=_0xb610b?_0xb610b:devices[_0x29b55e]['ip'];let _0x371af9;const _0x4d8a94=_0x58c094=>{const _0xc33cbe=_0x2b8a;if(settings[_0xc33cbe(0x19b)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x29b55e)){const _0x23a53b=generateLoginToken(_0x29b55e);return{'allow':!![],'reason':_0xc33cbe(0x200),'token':_0x23a53b};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x371af9=validToken(_0x58c094,_0x29b55e),_0x371af9[_0xc33cbe(0x299)](_0xc33cbe(0x144))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x58c094}:{'allow':![],'reason':_0xc33cbe(0x160),'token':null};}else return{'allow':!![],'reason':_0xc33cbe(0x146),'token':null};};if(settings[_0x4077ba(0xf2)]){let _0x34ebd4=[...settings[_0x4077ba(0x238)],_0x4077ba(0x116),_0x4077ba(0x13e),_0x4077ba(0x19c)];if(_0x34ebd4[_0x4077ba(0x11c)](_0x4db4f4))return _0x4d8a94(_0x60970b);else{_0x371af9=validToken(_0x60970b,_0x29b55e);if(_0x371af9['hasOwnProperty'](_0x4077ba(0x144)))return _0x4d8a94(_0x60970b);else{if(telegramIpApproved(_0x29b55e)){const _0x4b5da9=generateToken(_0x29b55e);return _0x371af9=_0x4d8a94(_0x60970b),_0x371af9[_0x4077ba(0x211)]?{'allow':!![],'reason':_0x4077ba(0x119),'token':_0x4b5da9}:_0x371af9;}else return settings[_0x4077ba(0x1be)]?{'allow':![],'reason':_0x4077ba(0x1e9),'token':null}:{'allow':![],'reason':_0x4077ba(0xf1),'token':null};}}}else return _0x4d8a94(_0x60970b);}function timelyDecrypt(_0x47e579,_0x4ad1cb=!![]){const _0x36d727=_0x4af2cf;if(_0x47e579)try{const _0x51d458=crypt[_0x36d727(0x264)](secure['privateKey'],_0x47e579)[_0x36d727(0x2a1)],_0x5aa752=_0x51d458['split']('@')[0x0],_0x1937ae=_0x51d458['split']('@')[0x1],_0x558a81=new Date()[_0x36d727(0x175)]();if(_0x4ad1cb){if(_0x558a81-_0x1937ae<maxSecretAge*0x3e8)return _0x5aa752;else return![];}else return _0x5aa752;}catch(_0x2b5c4b){return![];}else return![];}const validToken=(_0x321019,_0x3fd958)=>{const _0x4ec49c=_0x4af2cf,_0x5a8cc5=devices[_0x3fd958]['ip'];if(!_0x321019)return{'error':'No\x20authentication\x20token'};for(let _0x2da431 of blacklist){if(_0x2da431[_0x4ec49c(0x2a5)]==_0x321019)return{'error':_0x4ec49c(0x143)};}let _0x264e6a;try{_0x264e6a=jwt['verify'](_0x321019,secure[_0x4ec49c(0x12a)]+_0x3fd958);}catch{return{'error':_0x4ec49c(0x204)};}if(!_0x264e6a['hasOwnProperty'](_0x4ec49c(0x1f4))&&!_0x264e6a['hasOwnProperty']('username')||!_0x264e6a['hasOwnProperty'](_0x4ec49c(0x248)))return{'error':_0x4ec49c(0x1dc)};if(!_0x264e6a[_0x4ec49c(0x299)](_0x4ec49c(0x1a5))&&_0x264e6a[_0x4ec49c(0x299)](_0x4ec49c(0x1f4))){const {clientip:_0x3dff73}=_0x264e6a;return _0x5a8cc5==_0x3dff73?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x4ec49c(0x27e)};}else{if(_0x264e6a['hasOwnProperty'](_0x4ec49c(0x1a5))&&_0x264e6a['hasOwnProperty']('clientip')){const {username:_0xe7cd5e,clientip:_0x25668c}=_0x264e6a;return settings[_0x4ec49c(0x1de)]==_0xe7cd5e&&_0x5a8cc5==_0x25668c?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x4ec49c(0x1e0)};}}},generateLoginToken=_0x2f6adf=>{const _0x1b6e48=_0x4af2cf;if(_0x2f6adf){const _0x2d5808=devices[_0x2f6adf]['ip'];return jwt['sign']({'username':settings[_0x1b6e48(0x1de)],'clientip':_0x2d5808},secure[_0x1b6e48(0x12a)]+_0x2f6adf,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x26307c=>{const _0x2c3813=_0x4af2cf;if(_0x26307c){const _0x4102a6=devices[_0x26307c]['ip'];return jwt[_0x2c3813(0x262)]({'clientip':_0x4102a6},secure['secret']+_0x26307c,{'expiresIn':devices[_0x26307c][_0x2c3813(0x197)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x420c88=>{const _0x2d1723=_0x4af2cf;let _0xd0b729=![];return devices[_0x420c88][_0x2d1723(0x197)]&&devices[_0x420c88][_0x2d1723(0x197)][_0x2d1723(0x113)]!=_0x2d1723(0x2a3)&&(_0xd0b729=devices[_0x420c88][_0x2d1723(0x197)][_0x2d1723(0x1f4)]==devices[_0x420c88]['ip']&&new Date()[_0x2d1723(0x175)]()-devices[_0x420c88][_0x2d1723(0x197)][_0x2d1723(0x260)]<devices[_0x420c88][_0x2d1723(0x197)]['expiry']*0x3c*0x3e8),_0xd0b729;},telegram2FaApproved=_0x124d97=>{const _0x1f2528=_0x4af2cf;let _0x5cc72f=![];return devices[_0x124d97][_0x1f2528(0x16b)]&&devices[_0x124d97]['telegram2FaApproval']['expiry']!='reject'&&(_0x5cc72f=devices[_0x124d97]['telegram2FaApproval'][_0x1f2528(0x1f4)]==devices[_0x124d97]['ip']&&new Date()[_0x1f2528(0x175)]()-devices[_0x124d97][_0x1f2528(0x16b)][_0x1f2528(0x260)]<devices[_0x124d97][_0x1f2528(0x16b)][_0x1f2528(0x113)]*0x3c*0x3e8),_0x5cc72f;},normalizeIP=_0x3b00e4=>{const _0x5834a7=_0x4af2cf;let _0x209a9a=null,_0x9e314d=null;if(ipaddr[_0x5834a7(0x292)](_0x3b00e4)){const _0x361137=ipaddr['parse'](_0x3b00e4);_0x361137['kind']()===_0x5834a7(0x167)?(_0x361137['isIPv4MappedAddress']()&&(_0x209a9a=_0x361137[_0x5834a7(0x157)]()[_0x5834a7(0x194)]()),_0x9e314d=_0x361137[_0x5834a7(0x194)]()):(_0x209a9a=_0x361137[_0x5834a7(0x194)](),_0x9e314d=_0x361137[_0x5834a7(0x1e7)]()[_0x5834a7(0x194)]());}return{'show':_0x209a9a?_0x209a9a:_0x9e314d,'store':_0x9e314d};};function formatDate(_0x1b38f6){const _0x511349=_0x4af2cf;return _0x1b38f6[_0x511349(0xfd)]()+'/'+(_0x1b38f6[_0x511349(0x24e)]()+0x1)['toString']()[_0x511349(0x142)](0x2,'0')+'/'+_0x1b38f6[_0x511349(0x201)]()['toString']()[_0x511349(0x142)](0x2,'0')+'\x20'+_0x1b38f6['getHours']()['toString']()[_0x511349(0x142)](0x2,'0')+':'+_0x1b38f6[_0x511349(0x1df)]()[_0x511349(0x194)]()[_0x511349(0x142)](0x2,'0')+':'+_0x1b38f6['getSeconds']()[_0x511349(0x194)]()[_0x511349(0x142)](0x2,'0');}function sleep(_0x28627d){return new Promise(_0x20b8aa=>setTimeout(_0x20b8aa,_0x28627d));}