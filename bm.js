const _0x4d318f=_0x1e48;(function(_0x57bc70,_0x2e420f){const _0x3a9338=_0x1e48,_0x192a7c=_0x57bc70();while(!![]){try{const _0x380f8d=parseInt(_0x3a9338(0x24e))/0x1*(parseInt(_0x3a9338(0x18c))/0x2)+-parseInt(_0x3a9338(0x255))/0x3*(parseInt(_0x3a9338(0x22a))/0x4)+-parseInt(_0x3a9338(0xd3))/0x5+-parseInt(_0x3a9338(0x10b))/0x6*(parseInt(_0x3a9338(0xb6))/0x7)+parseInt(_0x3a9338(0xc0))/0x8*(parseInt(_0x3a9338(0x19a))/0x9)+-parseInt(_0x3a9338(0xaf))/0xa+parseInt(_0x3a9338(0x1d1))/0xb*(parseInt(_0x3a9338(0x237))/0xc);if(_0x380f8d===_0x2e420f)break;else _0x192a7c['push'](_0x192a7c['shift']());}catch(_0xaa1aae){_0x192a7c['push'](_0x192a7c['shift']());}}}(_0xf01d,0x7bb8d));const _0x1067c6=function(){let _0x516b31=!![];return function(_0x2b3e30,_0x26e776){const _0x101f7e=_0x516b31?function(){const _0x4347d9=_0x1e48;if(_0x26e776){const _0x1b4370=_0x26e776[_0x4347d9(0x1c6)](_0x2b3e30,arguments);return _0x26e776=null,_0x1b4370;}}:function(){};return _0x516b31=![],_0x101f7e;};}(),_0x3e1540=_0x1067c6(this,function(){const _0x2f2566=_0x1e48;return _0x3e1540[_0x2f2566(0xbf)]()[_0x2f2566(0x226)]('(((.+)+)+)+$')[_0x2f2566(0xbf)]()[_0x2f2566(0x225)](_0x3e1540)[_0x2f2566(0x226)](_0x2f2566(0x234));});_0x3e1540();'use strict';process[_0x4d318f(0x1ed)][_0x4d318f(0xae)]=0x1;const childProcess=require(_0x4d318f(0x183)),fs=require('fs'),fns=require(_0x4d318f(0x256)),low=require(_0x4d318f(0x249)),FileSync=require(_0x4d318f(0x1a3)),path=require('path'),crypto=require(_0x4d318f(0x19e)),Crypt=require(_0x4d318f(0xcc))[_0x4d318f(0xb0)],RSA=require(_0x4d318f(0xcc))[_0x4d318f(0xeb)],bcrypt=require(_0x4d318f(0x1e1)),jwt=require(_0x4d318f(0x1f9)),ipaddr=require(_0x4d318f(0x1fb)),argv=require(_0x4d318f(0x192))(process['argv'][_0x4d318f(0xc9)](0x2))[_0x4d318f(0x1fe)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x4d318f(0x18a)),Mixpanel=require(_0x4d318f(0x252)),axios=require('axios'),{GraphQLClient,gql}=require(_0x4d318f(0x21a)),util=require(_0x4d318f(0x1a6)),fileUpload=require(_0x4d318f(0x26f)),{networkInterfaces}=require('os'),PORT=argv[_0x4d318f(0x24a)]||_0x4d318f(0xc2),pattern=/^[0-9]{2,4}$/;!pattern[_0x4d318f(0x223)](PORT)&&(console[_0x4d318f(0x1bf)](_0x4d318f(0x16c)+PORT+_0x4d318f(0x15e)),process[_0x4d318f(0x21b)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x4d318f(0x251)][_0x4d318f(0xe6)];let bbpath=_0x4d318f(0x281),bbpath2='';const botfile=_0x4d318f(0x1a5),configfile=_0x4d318f(0x20c),settingsfile=_0x4d318f(0x23d),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x4d318f(0x221))[_0x4d318f(0x198)]||_0x4d318f(0x140),maxBackups=0xa;let validInstallation=!![];!fs[_0x4d318f(0x241)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x4d318f(0x9d)+userID+'/':bbpath+_0x4d318f(0x9d),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x4d318f(0x28f),zippath=userID?bbpath+_0x4d318f(0x95)+userID+'/':bbpath+_0x4d318f(0x95),loggerfile=fs[_0x4d318f(0x213)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x4d318f(0x241)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x4d318f(0x241)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4d318f(0x241)](logspath)&&fs[_0x4d318f(0x187)](logspath);!fs[_0x4d318f(0x241)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);function _0xf01d(){const _0x1b7742=['show','Unauthorized\x20attempt\x20to\x20confirm\x20message','log','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','store-configuration','Login\x20rejected','index.html','config','emitHistory','apply','auto','headless','Notifications\x20enabled','toggle','initclient','enable','No\x20bots\x20running\x20right\x20now','restore_no','order','reinstall_yes','1784255xMsixU','-----------------------------------------------------------------------------------','output-001.log','alerts','SIGTERM','Deleted\x20Bot\x20','lastmsgtelegram','All\x20bots','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','#RES#\x20if\x20running\x20on\x20server','internal','pidRefreshToken','Network\x20Interfaces:','backup-full@','connection','No\x20authentication\x20token','bcryptjs','format','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','live','reject','hex','onepagemode','127.0.0.1','stop','Allow\x20login\x20from\x20IP\x20address\x20','telegram','access','env','encryptedUuid','enabled','/on\x20-\x20start\x20bot(s)\x0a','started','connected','reinstall_no','Unauthorized\x20attempt\x20to\x20log\x20out','Starting\x20(','Backup\x20file\x20unzipped\x20and\x20stored','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','<b>Balance\x20Bot\x20Status:</b>\x0a','jsonwebtoken','Setting\x20access:\x20','ipaddr.js','button','/:bot/portfolio','argv','kind','uncaughtException','decrypt','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','store-settings','update','telegramIpApproval','reply','\x20(2)','output-000.log','telegrammsg','socket.io','editMessageReplyMarkup','bb-config.json','backup','sign','verify','forEach','rmSync','latestversion','createWriteStream','readdirSync','getMonth','once','privateKey','::1','kill','graphql-request','exit','split','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','launch','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','version.json','value','test','Invalid\x20authentication\x20token\x20(2)','constructor','search','map','toggle_','Invalid\x20username\x20or\x20IP\x20address','25436pVsger','/off\x20-\x20stop\x20bot(s)\x0a','15\x20min','Yes','bb-secure.json','on_','build','telegramChatId','tempaccess_5','restore-backup-file','(((.+)+)+)+$','padStart','login2fa_','144qlWNUq','disconnect','.zip','login2fa_reject','SIGINT','error','bb-settings.json','max',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','title','existsSync','logged\x20out','filter','Bot\x20','password','backupfile','restart_','yes','lowdb','port','update_no','pidExpireLogin','referer','44crQDHz','catch','data','versions','mixpanel','toggle-bot-mode','set','447NSsFaL','date-fns','/:bot/support','clientip','reason','store-fiat','getHours','Error\x20removing\x20old\x20backup\x20files:','notification','new-disabled','post','tempaccess_30','inherit','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Password\x20has\x20been\x20reset\x20to:\x20','exec','sendFile','*$1*','2FA\x20required','reset-history','track','secret','success','names','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','express-fileupload','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','login\x20required','telegramEnabled','0.0.0','sendMetricsTelegram','hashSync','Unauthorized\x20attempt\x20to\x20update\x20bot','getPortfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','inlineKeyboard','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','expiry','output-003.log','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','HTML','logout','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','bb/','\x20|\x20','userid','-performance.json','Temporary\x20access\x20rejected','\x20only\x0a','/names\x20-\x20show\x20bot\x20names\x0a','\x20minutes','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','temporary\x20access\x20rejected','copyFileSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Starting\x20Balance\x20Bot\x20reinstallation','config_all','logs/','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','f2aRequired','username','unlinkSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','assign','parse','zip/','bbUsername','cancelLoading','\x1b[31m','config_alerts','request','fork','whitelist','config/','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','address','type','message','then','get-messages','$1_$2_$3','cancel-loading','node-zip','confirm-message','staging','messages','telegramUsername','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','join','https://api.ipify.org?format=json','NTBA_FIX_319','6514110fpxjAx','Crypt','6b67f3d61ee94b8f5c80b4affef4c4d9','temporary\x20token\x20generated','randomFillSync','number','Starting\x20#RED#Balance\x20Bot\x20v','637PFQUyl','Bot\x20Mgr\x20>\x20','telegramEvents','bots','push','store','token','resetpw_no','/status\x20-\x20show\x20bot(s)\x20status\x0a','toString','646512UdODFb','generateKeyPairAsync','3000','1000','delete-bot','simple','\x20|\x20user:\x20...','init','find','slice','Notifications\x20disabled\x0a','telegramToken','hybrid-crypto-js','storeFiat','show-config','botID','placeOrder','/:bot/coins','alias','3131310kYinPx','Logged\x20out\x20user\x20...','name','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','match','Unauthorized\x20attempt\x20to\x20download\x20','\x20(1)','Restore\x20backup\x20file\x20','telegram2FaApproval','Your\x20installation\x20is\x20already\x20up\x20to\x20date','get-logs','apiKey','getDate','delete-alerts','getFullYear','callback','mode','status','node',')\x20\x20\x20|\x20Bot\x20','restore_yes','reinstall','version','RSA','debug','showConfig','removeAllListeners','binary','allow','timeshift','use','login\x20token\x20valid','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','ipv6','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','file','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','ipc','showname','toIPv4MappedAddress','running','logs','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','whitelistEnabled','Idling\x20(','includes','temporary\x20access\x20timeout','[ip-address]','update-bot','isDirectory','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','login','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','chat','\x20>\x20','28086WFyMgj','statSync','start',')\x20|\x20Bot\x20','getSeconds','loginRequired','2FA','RSA-OAEP','************','backup-full.zip','command','_data','Telegraf\x20error:','Ok,\x20will\x20send\x20alert\x20notifications\x20only','manual','-events.json','startsWith','/enable\x20-\x20enable\x20notifications\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','uuid','length','keys','readFileSync','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','-config.json','full','warning','static','::ffff:127.0.0.1','settings','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','any','get-portfolio','conn','2FA\x20login\x20rejected','api-eu.mixpanel.com','IPv4','Restore\x20process\x20aborted','Notifications\x20disabled','2FA\x20login\x20token\x20generated','disable','write','bbvReceive','apiSecret','send','portfolio','\x20|\x20client:\x20...','hasOwnProperty','Session\x20expired\x20for\x20user\x20...','timestamp','sort','production','bbvNew','function','entries','Unauthorized\x20attempt\x20to\x20show\x20configuration','botmanager','all','Restore\x20process\x20confirmed','Unauthorized\x20attempt\x20to\x20store\x20configuration','reset-password','lastmsgemitted','/restart\x20-\x20restart\x20bot(s)\x0a','/disable\x20-\x20disable\x20notifications\x0a','Invalid\x20authentication\x20token\x20(1)','Login\x20accepted','File\x20uploaded','event','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','restart','headers','output-002.log','get','range','resetHistory','invalid\x20credentials','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Password\x20reset\x20rejected','files','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','(staging)',',\x20must\x20be\x20a\x204\x20digit\x20number','Telegram\x20error:','socket','/:bot/configuration','secure','get-starting-balances','cloneDeep','reinstall-bb','Starting\x20Balance\x20Bot\x20update','/download/:type','get-backup-files','bot','getUTCHours','***','Error:\x20Invalid\x20argument\x20','All\x20bots\x20running\x20right\x20now','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','sockets','Unauthorized\x20attempt\x20to\x20update\x20settings','-results.json','Server','mtime','2FA\x20login\x20required','disabled','config_orders','tkn','sha256','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/:bot','randomBytes','=>\x20Go\x20to\x20#CYA#http://','new','login\x20token\x20generated','orders','family','listen','sendPortfolioTelegram','child_process','getTime','writeFileSync','defaults','mkdirSync','temporaryAccessAllowed','params','telegraf','botname','40372ANUVew','stringify','store-headless','resetpw_yes','Unauthorized\x20attempt\x20to\x20get\x20events','apiPassword','yargs/yargs','remove','express','bot-','bbPassword','publicKey','environment','#RES#\x20if\x20running\x20locally\x0a','36IoRbpL','build2','Unauthorized\x20attempt\x20to\x20get\x20messages','stopped','crypto','sortBy','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','update_yes','lowdb/adapters/FileSync','Node.js\x20v','bot.js','util','action','\x1b[0m','accept','replace','blacklist','from','emit','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','DEFLATE','getMinutes','Notifications\x20enabled\x0a','download','Ok,\x20will\x20send\x20order\x20notifications\x20only','Markdown','/upload-backup','storeConfiguration','place-order','Unauthorized\x20login\x20attempt\x20(timeout)','backup-files','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Enabled\x20Bot\x20','reload'];_0xf01d=function(){return _0x1b7742;};return _0xf01d();}const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4d318f(0x186)]({'bots':[]})[_0x4d318f(0x136)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x4d318f(0x136)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4d318f(0x186)]({'secure':{},'blacklist':[]})[_0x4d318f(0x136)]();let crypt=new Crypt({'md':_0x4d318f(0x178),'rsaStandard':_0x4d318f(0x112)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4d318f(0xc7)](_0x4d318f(0xb1),{'host':_0x4d318f(0x130)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x4d318f(0xcb)]!=''&&settings[_0x4d318f(0xaa)]&&settings[_0x4d318f(0xaa)]!='')initTelegram();const parseColor=(_0x14e35b,_0x4544aa)=>{const _0x3f7552=_0x4d318f,_0x22c74a=/#[A-Z]{3}#/g;if(typeof _0x14e35b=='string'){!_0x4544aa?_0x14e35b=_0x14e35b[_0x3f7552(0x1aa)](_0x22c74a,''):(_0x14e35b=_0x14e35b[_0x3f7552(0x1aa)](/#BLU#/g,'\x1b[34m'),_0x14e35b=_0x14e35b[_0x3f7552(0x1aa)](/#RED#/g,_0x3f7552(0x98)),_0x14e35b=_0x14e35b[_0x3f7552(0x1aa)](/#YEL#/g,'\x1b[33m'),_0x14e35b=_0x14e35b[_0x3f7552(0x1aa)](/#MAG#/g,'\x1b[35m'),_0x14e35b=_0x14e35b[_0x3f7552(0x1aa)](/#CYA#/g,'\x1b[36m'),_0x14e35b=_0x14e35b['replace'](/#RES#/g,_0x3f7552(0x1a8)));;}return _0x14e35b;},logger={'screen':_0x5fd031=>{console['log'](parseColor(_0x5fd031,!![]));},'simple':_0x295147=>{const _0x1aeff2=_0x4d318f;console['log'](parseColor(_0x295147,!![])),loggerfile['write'](util[_0x1aeff2(0x1e2)](parseColor(_0x295147,![]))+'\x0a');},'full':async _0x502546=>{const _0x425edb=_0x4d318f,_0x3848b7=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x502546;console[_0x425edb(0x1bf)](parseColor(_0x3848b7,!![])),loggerfile[_0x425edb(0x136)](util[_0x425edb(0x1e2)](parseColor(_0x3848b7,![]))+'\x0a');if(tgBot&&settings[_0x425edb(0x231)]&&settings['telegramEvents']!=_0x425edb(0x17f))await sendTelegram(settings[_0x425edb(0x231)],_0x425edb(0xb7)+parseColor(_0x502546,![]));},'debug':async(_0x357737,_0x1cdce8='')=>{const _0x210adf=_0x4d318f,_0x442142=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x357737;if(debugging)console[_0x210adf(0x1bf)](parseColor(_0x442142,!![]));loggerfile[_0x210adf(0x136)](util[_0x210adf(0x1e2)](parseColor(_0x442142,![]))+'\x0a');if(_0x1cdce8){if(debugging)console[_0x210adf(0x1bf)](_0x1cdce8);loggerfile[_0x210adf(0x136)](util[_0x210adf(0x1e2)](_0x1cdce8)+'\x0a');}}};process['on'](_0x4d318f(0x200),function(_0x4161e2){const _0x57365b=_0x4d318f;logger[_0x57365b(0xc5)](_0x4161e2);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4d318f(0x221))[_0x4d318f(0xea)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4d318f(0x194)),app=express(),http=require('http')['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x4d318f(0x167),async(_0x462c1d,_0x4758be)=>{const _0x48c61f=_0x4d318f,_0x15b83e=_0x462c1d[_0x48c61f(0x189)]['type'],_0x568f56=getClientsWithBotID(_0x48c61f(0x145)),_0x1147d8=_0x462c1d['headers']['uuid'],_0x4f6a8c=timelyDecrypt(_0x1147d8,![]),_0x13e631=_0x568f56[_0x48c61f(0xc8)](_0x33413d=>_0x33413d[_0x48c61f(0x120)]==_0x4f6a8c);if(_0x13e631){const _0x14d891=normalizeIP(_0x462c1d[_0x48c61f(0x160)]['remoteAddress'])['store'],_0x354245=_0x462c1d[_0x48c61f(0x153)][_0x48c61f(0x177)];if(validateAccess(_0x354245,_0x4f6a8c,_0x14d891)[_0x48c61f(0xf0)])_0x15b83e==_0x48c61f(0x20d)&&await backupConfigFiles(),await zipFiles(_0x15b83e),_0x4758be[_0x48c61f(0x1b2)](zippath+(_0x15b83e+_0x48c61f(0x239)),_0x300b24=>{const _0x585319=_0x48c61f;_0x300b24&&(logger[_0x585319(0x126)]('Failed\x20to\x20download\x20'+_0x15b83e),logger[_0x585319(0xc5)](_0x300b24));});else logger[_0x48c61f(0x126)](_0x48c61f(0xd9)+_0x15b83e+_0x48c61f(0xda));}else logger[_0x48c61f(0x126)](_0x48c61f(0xd9)+_0x15b83e+_0x48c61f(0x207));}),app[_0x4d318f(0x25f)](_0x4d318f(0x1b5),async(_0xc46f30,_0x307503)=>{const _0x13b52b=_0x4d318f,_0x239cc1=getClientsWithBotID('botmanager'),_0x51b507=_0xc46f30[_0x13b52b(0x153)][_0x13b52b(0x120)],_0x53fa70=timelyDecrypt(_0x51b507,![]),_0xe36fc0=_0x239cc1[_0x13b52b(0xc8)](_0x53caa1=>_0x53caa1[_0x13b52b(0x120)]==_0x53fa70);logger[_0x13b52b(0xec)]('Backup\x20file\x20uploaded');if(_0xe36fc0){const _0x1f2f0e=normalizeIP(_0xc46f30['socket']['remoteAddress'])[_0x13b52b(0xbb)],_0x23f609=_0xc46f30[_0x13b52b(0x153)]['tkn'];if(validateAccess(_0x23f609,_0x53fa70,_0x1f2f0e)[_0x13b52b(0xf0)]){if(_0xc46f30[_0x13b52b(0x15b)]){const _0x180541=_0xc46f30[_0x13b52b(0x15b)][_0x13b52b(0x246)];await _0x180541['mv'](temppath+_0x180541['name']),_0x307503[_0x13b52b(0x139)]({'status':!![],'message':_0x13b52b(0x14f)});const _0x1a4580=getBotsWithMode();_0x1a4580['length']>0x0?confirmRestore(temppath,_0x180541['name']):unzipFile(temppath,_0x180541[_0x13b52b(0xd5)]);}}else logger['full'](_0x13b52b(0x27a));}else logger['full'](_0x13b52b(0x179));}),app[_0x4d318f(0xf2)](express[_0x4d318f(0x128)](path[_0x4d318f(0xac)](__dirname,bbpath2,_0x4d318f(0x19b)))),app[_0x4d318f(0xf2)](express[_0x4d318f(0x128)](path[_0x4d318f(0xac)](__dirname,bbpath2,_0x4d318f(0x230)))),app[_0x4d318f(0x155)]('/',function(_0x34209f,_0x117135){const _0x512860=_0x4d318f;_0x117135[_0x512860(0x265)](path[_0x512860(0xac)](__dirname,bbpath2,_0x512860(0x19b),_0x512860(0x1c3)));}),app[_0x4d318f(0x155)](_0x4d318f(0x17a),function(_0x48a9d1,_0x8e6029){const _0x451ccf=_0x4d318f;_0x8e6029[_0x451ccf(0x265)](path['join'](__dirname,bbpath2,_0x451ccf(0x230),_0x451ccf(0x1c3)));}),app[_0x4d318f(0x155)](_0x4d318f(0x1fd),(_0x2c6968,_0x3b44a0)=>{const _0xa92018=_0x4d318f;_0x3b44a0[_0xa92018(0x265)](path['join'](__dirname,bbpath2,_0xa92018(0x230),_0xa92018(0x1c3)));}),app[_0x4d318f(0x155)]('/:bot/performance',(_0x2a273f,_0x229150)=>{const _0x133e03=_0x4d318f;_0x229150[_0x133e03(0x265)](path['join'](__dirname,bbpath2,_0x133e03(0x230),_0x133e03(0x1c3)));}),app['get'](_0x4d318f(0xd1),(_0x4e4eb4,_0x352323)=>{const _0x501ddb=_0x4d318f;_0x352323[_0x501ddb(0x265)](path[_0x501ddb(0xac)](__dirname,bbpath2,_0x501ddb(0x230),_0x501ddb(0x1c3)));}),app['get']('/:bot/history',(_0x4fbad5,_0x2361f5)=>{const _0x505678=_0x4d318f;_0x2361f5[_0x505678(0x265)](path['join'](__dirname,bbpath2,'build',_0x505678(0x1c3)));}),app[_0x4d318f(0x155)](_0x4d318f(0x161),(_0xed5c11,_0x268453)=>{const _0x21c035=_0x4d318f;_0x268453[_0x21c035(0x265)](path[_0x21c035(0xac)](__dirname,bbpath2,_0x21c035(0x230),_0x21c035(0x1c3)));}),app['get'](_0x4d318f(0x257),(_0x1d607e,_0x5bad78)=>{const _0x29e5fd=_0x4d318f;_0x5bad78['sendFile'](path[_0x29e5fd(0xac)](__dirname,bbpath2,_0x29e5fd(0x230),'index.html'));});if(HOST)http[_0x4d318f(0x181)](PORT,HOST);else http[_0x4d318f(0x181)](PORT);const io=require(_0x4d318f(0x20a))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x377bdf=_0x4d318f;let _0x5349df=_0x377bdf(0x103);const _0x3ff66d=networkInterfaces(),_0x425699={};for(const _0xf704b2 of Object[_0x377bdf(0x122)](_0x3ff66d)){for(const _0x2ea1e6 of _0x3ff66d[_0xf704b2]){if((_0x2ea1e6[_0x377bdf(0x180)]==_0x377bdf(0x131)||_0x2ea1e6[_0x377bdf(0x180)]==0x4)&&!_0x2ea1e6[_0x377bdf(0x1db)]){const _0x380b74=ipaddr['parse'](_0x2ea1e6['address'])[_0x377bdf(0x156)]();_0x380b74!='private'&&(!_0x425699[_0xf704b2]&&(_0x425699[_0xf704b2]=[]),_0x425699[_0xf704b2][_0x377bdf(0xba)](_0x2ea1e6[_0x377bdf(0x9f)]),_0x5349df=_0x2ea1e6[_0x377bdf(0x9f)]);}}}return{'serverip':_0x5349df,'netinterfaces':_0x425699};}async function startServer(){const _0x2a1eb6=_0x4d318f,{serverip:_0x5f2e07,netinterfaces:_0x4eb113}=getServerIP();logger['simple'](''),logger[_0x2a1eb6(0xc5)]('-----------------------------------------------------------------------------------'),await logger[_0x2a1eb6(0x126)](_0x2a1eb6(0xb5)+serverversion+'#RES#\x20'+(environment==_0x2a1eb6(0xa8)?_0x2a1eb6(0x15d):'')+'\x0a'+(_0x2a1eb6(0x262)+PORT+_0x2a1eb6(0x199))+(_0x2a1eb6(0x17c)+_0x5f2e07+':'+PORT+_0x2a1eb6(0x1da))),logger['simple']('-----------------------------------------------------------------------------------');if(config[_0x2a1eb6(0x121)]!=0x0)for(const _0x343c3b of config){const _0x3ea7fd=_0x343c3b['mode']==_0x2a1eb6(0x1c7)?'a':'m';if(_0x343c3b['status']==_0x2a1eb6(0x1ef)||_0x343c3b['status']==_0x2a1eb6(0x17d))await logger['full'](_0x2a1eb6(0x1f5)+_0x3ea7fd+_0x2a1eb6(0x10e)+_0x343c3b[_0x2a1eb6(0xcf)]+_0x2a1eb6(0x282)+_0x343c3b[_0x2a1eb6(0x18b)]),startBot([_0x343c3b[_0x2a1eb6(0xcf)],userID],{'cwd':bbpath},function(_0x3907dc){const _0x1e8505=_0x2a1eb6;if(_0x3907dc)logger[_0x1e8505(0x126)](_0x3907dc);});else(_0x343c3b[_0x2a1eb6(0xe5)]==_0x2a1eb6(0x175)||_0x343c3b['status']==_0x2a1eb6(0x25e))&&await logger[_0x2a1eb6(0x126)](_0x2a1eb6(0x100)+_0x3ea7fd+_0x2a1eb6(0xe7)+_0x343c3b['botID']+_0x2a1eb6(0x282)+_0x343c3b[_0x2a1eb6(0x18b)]);}else!newBot&&logger['simple'](_0x2a1eb6(0x202));if(newBot)addBot();logger[_0x2a1eb6(0xc5)](_0x2a1eb6(0x1d2)),logger[_0x2a1eb6(0xc5)](''),await logger[_0x2a1eb6(0xec)](_0x2a1eb6(0x1a4)+nodeversion),await logger[_0x2a1eb6(0xec)](_0x2a1eb6(0x1dd),_0x4eb113);}function startSocket(){const _0x37289d=_0x4d318f;io['on'](_0x37289d(0x1df),_0x5e90c9=>{const _0x4152d7=_0x37289d;let _0x3a6ba8,_0x210b4b,_0x56e46b,_0xf11b97,_0x43ff6f;const _0x421ae7=_0x5e90c9['handshake']['headers'][_0x4152d7(0x24d)];_0x210b4b=_0x421ae7[_0x4152d7(0xd8)](/bot[0-9]{3}/);if(_0x210b4b)_0x56e46b=_0x210b4b[0x0][_0x4152d7(0xd8)](/[0-9]{3}/);if(_0x56e46b)_0x3a6ba8=_0x56e46b[0x0];else _0x3a6ba8=_0x4152d7(0x145);const _0x57aa76=_0x5e90c9['handshake']['auth'][_0x4152d7(0x1ee)];if(!_0x57aa76)_0x5e90c9[_0x4152d7(0x1ad)](_0x4152d7(0xe5),{'publicKey':secure[_0x4152d7(0x197)]});else{_0xf11b97=timelyDecrypt(_0x57aa76,![]);if(!_0xf11b97)_0x5e90c9[_0x4152d7(0x1ad)]('status',{'publicKey':secure[_0x4152d7(0x197)]});else{_0x43ff6f=normalizeIP(_0x5e90c9[_0x4152d7(0x12e)]['remoteAddress'])[_0x4152d7(0xbb)];if(!devices[_0xf11b97])devices[_0xf11b97]={'uuid':_0xf11b97,'access':{'token':null}};devices[_0xf11b97]['ip']=_0x43ff6f;const _0x486139=addClient(_0x5e90c9['id'],_0xf11b97,_0x3a6ba8);setAccess(_0x486139),emitMessages(),_0x5e90c9['on'](_0x4152d7(0x107),_0x1cfbea=>{const _0x46f3b1=_0x4152d7,_0x9f5fb0=timelyDecrypt(_0x1cfbea[_0x46f3b1(0x245)]);if(_0x9f5fb0){_0x1cfbea={'username':_0x1cfbea[_0x46f3b1(0x292)],'password':_0x9f5fb0},devices[_0xf11b97][_0x46f3b1(0x1ec)]=validateCredentials(_0x1cfbea,_0xf11b97);if(devices[_0xf11b97]['access'][_0x46f3b1(0xf0)]==![]&&devices[_0xf11b97][_0x46f3b1(0x1ec)][_0x46f3b1(0x259)]==_0x46f3b1(0x174))_0x5e90c9[_0x46f3b1(0x1ad)](_0x46f3b1(0xe5),{'access':devices[_0xf11b97][_0x46f3b1(0x1ec)]}),loginAccess2FA(_0xf11b97,_0x43ff6f);else{if(devices[_0xf11b97]['access'][_0x46f3b1(0xf0)]==![]&&devices[_0xf11b97][_0x46f3b1(0x1ec)]['reason']==_0x46f3b1(0x158))_0x5e90c9[_0x46f3b1(0x1ad)](_0x46f3b1(0xe5),{'access':devices[_0xf11b97][_0x46f3b1(0x1ec)]});else devices[_0xf11b97][_0x46f3b1(0x1ec)][_0x46f3b1(0xf0)]&&devices[_0xf11b97][_0x46f3b1(0x1ec)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0xf11b97)[_0x46f3b1(0x210)](_0x3a6cdc=>{setAccess(_0x3a6cdc);}),logger[_0x46f3b1(0xec)]('Logged\x20in\x20user\x20...'+_0xf11b97[_0x46f3b1(0xc9)](-0x8)),setTokenRefresh(_0xf11b97),setSessionTimeout(_0x46f3b1(0x107),_0xf11b97));}}else logger[_0x46f3b1(0x126)](_0x46f3b1(0x1b8));}),_0x5e90c9['on'](_0x4152d7(0x149),()=>{resetPassword();}),_0x5e90c9['on'](_0x4152d7(0x238),_0x476482=>{removeClient(_0x5e90c9['id']);}),_0x3a6ba8=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1e9e0a){const _0x23e24e=_0x4d318f;if(_0x1e9e0a!=_0x23e24e(0x145)&&config[_0x23e24e(0xdf)]!=''){if(pid[_0x1e9e0a])pid[_0x1e9e0a][_0x23e24e(0x139)]({'function':_0x23e24e(0x1cb),'args':null});}_0x1e9e0a!='botmanager'&&broadcastToBots(_0x23e24e(0xb9),JSON[_0x23e24e(0x18d)](config));}function reloadBotManager(){const _0x227360=_0x4d318f;getClientsWithBotID(_0x227360(0x145))[_0x227360(0x210)](_0x53e012=>{getSocket(_0x53e012['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x2ed1b2){const _0x595bcd=_0x4d318f;return io[_0x595bcd(0x16f)]['sockets']['get'](_0x2ed1b2);}function setAccess(_0xb50cee){const _0xfa472c=_0x4d318f,_0x484eeb=getSocket(_0xb50cee['id']),_0x10ac0f=_0xb50cee['uuid'],_0x3cdd8a=_0xb50cee[_0xfa472c(0x169)];devices[_0x10ac0f]['access']=validateAccess(devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0xbc)],_0x10ac0f),logger[_0xfa472c(0xec)](_0xfa472c(0x1fa)+devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0x259)]+_0xfa472c(0x13b)+_0xb50cee['id']['slice'](-0x8)+_0xfa472c(0xc6)+_0x10ac0f[_0xfa472c(0xc9)](-0x8)),_0x484eeb['join'](_0x10ac0f);if(devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0xf0)]){_0x484eeb[_0xfa472c(0xac)](_0x3cdd8a);if(_0x3cdd8a==_0xfa472c(0x145))initializeSocketBotManager(_0x484eeb);else initializeSocketBot(_0x484eeb);initClient(_0x3cdd8a);}devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0xbc)]&&devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0x259)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0xfa472c(0x111),_0x10ac0f),devices[_0x10ac0f]['access'][_0xfa472c(0xbc)]&&devices[_0x10ac0f]['access'][_0xfa472c(0x259)]==_0xfa472c(0x134)&&setSessionTimeout(_0xfa472c(0x107),_0x10ac0f),_0x484eeb[_0xfa472c(0x1ad)](_0xfa472c(0xe5),{'status':_0xb50cee['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x10ac0f][_0xfa472c(0x1ec)],'externalip':devices[_0x10ac0f]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0xf0)]==![]&&devices[_0x10ac0f][_0xfa472c(0x1ec)][_0xfa472c(0x259)]==_0xfa472c(0x267)&&temporaryAccess2FA(_0x10ac0f,devices[_0x10ac0f]['ip']);}function setSessionTimeout(_0x49008f,_0x1b7b2a){const _0x1d989f=_0x4d318f;let _0x5f3e3f;if(_0x49008f=='login')_0x5f3e3f=loginExpiry*0x3c*0x3e8;else _0x5f3e3f=devices[_0x1b7b2a][_0x1d989f(0x205)][_0x1d989f(0x27b)]*0x3c*0x3e8-(new Date()[_0x1d989f(0x184)]()-devices[_0x1b7b2a]['telegramIpApproval']['timestamp']);if(devices[_0x1b7b2a][_0x1d989f(0x24c)])clearTimeout(devices[_0x1b7b2a]['pidExpireLogin']);devices[_0x1b7b2a][_0x1d989f(0x24c)]=setTimeout(()=>{const _0x2b0789=_0x1d989f;if(devices[_0x1b7b2a][_0x2b0789(0x1dc)])clearTimeout(devices[_0x1b7b2a][_0x2b0789(0x1dc)]);removeSocketListeners(_0x1b7b2a),addBlacklist(_0x1b7b2a),devices[_0x1b7b2a]['telegramIpApproval']=null,devices[_0x1b7b2a][_0x2b0789(0xdc)]=null,devices[_0x1b7b2a]['access'][_0x2b0789(0xbc)]=null,logger[_0x2b0789(0xec)](_0x2b0789(0x13d)+_0x1b7b2a[_0x2b0789(0xc9)](-0x8)),devices[_0x1b7b2a][_0x2b0789(0x1ec)]=validateAccess(devices[_0x1b7b2a]['access'][_0x2b0789(0xbc)],_0x1b7b2a),!(devices[_0x1b7b2a][_0x2b0789(0x1ec)][_0x2b0789(0xf0)]&&devices[_0x1b7b2a][_0x2b0789(0x1ec)][_0x2b0789(0x259)]=='login\x20not\x20required')&&(_0x49008f==_0x2b0789(0x107)?io['to'](_0x1b7b2a)[_0x2b0789(0x1ad)](_0x2b0789(0xe5),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1b7b2a)['emit'](_0x2b0789(0xe5),{'access':{'allow':![],'reason':_0x2b0789(0x102),'token':null}})),devices[_0x1b7b2a][_0x2b0789(0x1ec)]['token']=null;},_0x5f3e3f);}function setTokenRefresh(_0x383b2a){const _0x2e27b7=_0x4d318f;if(devices[_0x383b2a][_0x2e27b7(0x1dc)])clearTimeout(devices[_0x383b2a]['pidRefreshToken']);devices[_0x383b2a]['pidRefreshToken']=setTimeout(()=>{const _0x46322c=_0x2e27b7;getClientsWithUuid(_0x383b2a)[_0x46322c(0x121)]!=0x0?(devices[_0x383b2a][_0x46322c(0x1ec)]=refreshToken(_0x383b2a),io['to'](_0x383b2a)[_0x46322c(0x1ad)](_0x46322c(0xe5),{'status':_0x46322c(0x1f2),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x383b2a][_0x46322c(0x1ec)],'externalip':devices[_0x383b2a]['ip'],'publicKey':secure[_0x46322c(0x197)],'validInstallation':validInstallation}),setTokenRefresh(_0x383b2a)):clearTimeout(devices[_0x383b2a][_0x46322c(0x1dc)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x58b7b1){const _0x289e91=_0x4d318f,_0x2035e0=getClient(_0x58b7b1['id'])[_0x289e91(0x120)];_0x58b7b1['emit']('bots',config),_0x58b7b1[_0x289e91(0x1ad)]('settings',cleanSettings()),_0x58b7b1['on']('add-bot',_0x4efd00=>{const _0x480b75=_0x289e91;if(validateAccess(_0x4efd00,_0x2035e0)[_0x480b75(0xf0)])addBot();else logger[_0x480b75(0x126)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x58b7b1['on'](_0x289e91(0x104),(_0x459d8b,_0x2d5eaa)=>{const _0x5cf121=_0x289e91;if(validateAccess(_0x2d5eaa,_0x2035e0)['allow'])toggleBot(_0x459d8b[_0x5cf121(0xcf)],_0x459d8b[_0x5cf121(0xe5)],_0x459d8b['live']);else logger[_0x5cf121(0x126)](_0x5cf121(0x276));}),_0x58b7b1['on'](_0x289e91(0x253),(_0x2adb8a,_0x1d6924)=>{const _0x502fb0=_0x289e91;if(validateAccess(_0x1d6924,_0x2035e0)[_0x502fb0(0xf0)])toggleBotMode(_0x2adb8a);else logger[_0x502fb0(0x126)](_0x502fb0(0x276));}),_0x58b7b1['on'](_0x289e91(0xc4),(_0x34fe3d,_0x513d23)=>{if(validateAccess(_0x513d23,_0x2035e0)['allow'])deleteBot(_0x34fe3d);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x58b7b1['on'](_0x289e91(0x203),(_0xea819e,_0x274038)=>{const _0x2c3862=_0x289e91;if(validateAccess(_0x274038,_0x2035e0)['allow'])storeSettings(_0xea819e,!![]);else logger[_0x2c3862(0x126)](_0x2c3862(0x170));}),_0x58b7b1['on']('update-bb',_0x23b524=>{const _0x5a4e7c=_0x289e91;if(validateAccess(_0x23b524,_0x2035e0)[_0x5a4e7c(0xf0)])updateBB('update');else logger[_0x5a4e7c(0x126)](_0x5a4e7c(0x28c));}),_0x58b7b1['on'](_0x289e91(0x165),_0x415a41=>{const _0x14803f=_0x289e91;if(validateAccess(_0x415a41,_0x2035e0)[_0x14803f(0xf0)])updateBB(_0x14803f(0xe9));else logger['full'](_0x14803f(0x220));}),_0x58b7b1['on'](_0x289e91(0x168),_0x23502d=>{const _0x4e0ef1=_0x289e91;if(validateAccess(_0x23502d,_0x2035e0)[_0x4e0ef1(0xf0)]){const _0x3f0bc5=getClient(_0x58b7b1['id']);if(_0x3f0bc5)getBackupFiles(_0x3f0bc5[_0x4e0ef1(0x120)]);else logger[_0x4e0ef1(0x126)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x4e0ef1(0x126)](_0x4e0ef1(0x21d));}),_0x58b7b1['on'](_0x289e91(0x233),(_0xbbdfd4,_0x7fbaad)=>{const _0x2ecc1d=_0x289e91;if(validateAccess(_0x7fbaad,_0x2035e0)[_0x2ecc1d(0xf0)])restoreBackupFile(_0xbbdfd4);else logger[_0x2ecc1d(0x126)](_0x2ecc1d(0x21f));}),_0x58b7b1['on']('get-messages',_0x456629=>{const _0x3fd301=_0x289e91;if(validateAccess(_0x456629,_0x2035e0)[_0x3fd301(0xf0)])getMessages();else logger[_0x3fd301(0x126)](_0x3fd301(0x19c));}),_0x58b7b1['on'](_0x289e91(0xa7),(_0x4dd0fc,_0xbc3ecd)=>{const _0xcb5e75=_0x289e91;if(validateAccess(_0xbc3ecd,_0x2035e0)[_0xcb5e75(0xf0)])confirmMessage(_0x4dd0fc);else logger[_0xcb5e75(0x126)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x58b7b1['on'](_0x289e91(0x27f),_0x332439=>{const _0x6b62b=_0x289e91;if(validateAccess(_0x332439,_0x2035e0)[_0x6b62b(0xf0)]){if(devices[_0x2035e0][_0x6b62b(0x1dc)])clearTimeout(devices[_0x2035e0][_0x6b62b(0x1dc)]);if(devices[_0x2035e0][_0x6b62b(0x24c)])clearTimeout(devices[_0x2035e0][_0x6b62b(0x24c)]);removeSocketListeners(getClient(_0x58b7b1['id'])['uuid']),addBlacklist(_0x2035e0),devices[_0x2035e0][_0x6b62b(0x205)]=null,devices[_0x2035e0]['telegram2FaApproval']=null,devices[_0x2035e0][_0x6b62b(0x1ec)][_0x6b62b(0xbc)]=null,logger[_0x6b62b(0xec)]('Logged\x20out\x20user\x20...'+_0x2035e0[_0x6b62b(0xc9)](-0x8)),io['to'](getClient(_0x58b7b1['id'])[_0x6b62b(0x120)])['emit'](_0x6b62b(0xe5),{'access':{'allow':![],'reason':_0x6b62b(0x242),'token':null}});}else logger['full'](_0x6b62b(0x1f4));});}function initializeSocketBot(_0x5f245b){const _0x507e00=_0x4d318f,_0x3a5a4c=getClient(_0x5f245b['id'])[_0x507e00(0x169)],_0x54eaf4=getClient(_0x5f245b['id'])[_0x507e00(0x120)];_0x5f245b['on'](_0x507e00(0xde),(_0x3e74ba,_0x3b9c96)=>{const _0x13ce56=_0x507e00;if(validateAccess(_0x3b9c96,_0x54eaf4)[_0x13ce56(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x13ce56(0x139)]({'function':_0x13ce56(0x1c5),'args':_0x3e74ba});}else logger[_0x13ce56(0x126)](_0x13ce56(0x190));}),_0x5f245b['on'](_0x507e00(0xe1),(_0x1ef12d,_0x77f2b2)=>{const _0x154492=_0x507e00;if(validateAccess(_0x77f2b2,_0x54eaf4)[_0x154492(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x154492(0x139)]({'function':_0x154492(0x26d),'args':_0x1ef12d});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5f245b['on'](_0x507e00(0x12d),(_0x5de9c3,_0x3d16a2)=>{const _0x3009a5=_0x507e00;if(validateAccess(_0x3d16a2,_0x54eaf4)[_0x3009a5(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x3009a5(0x139)]({'function':_0x3009a5(0x277),'args':_0x5de9c3});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x5f245b['on'](_0x507e00(0x1c1),(_0x1202a0,_0x14d188)=>{const _0x41a69c=_0x507e00;if(validateAccess(_0x14d188,_0x54eaf4)[_0x41a69c(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x41a69c(0x139)]({'function':_0x41a69c(0x1b6),'args':_0x1202a0});}else logger['full'](_0x41a69c(0x148));}),_0x5f245b['on'](_0x507e00(0x18e),(_0x2106c7,_0x7a0dca)=>{const _0x2dd480=_0x507e00;if(validateAccess(_0x7a0dca,_0x54eaf4)[_0x2dd480(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c]['send']({'function':'storeHeadless','args':_0x2106c7});}else logger[_0x2dd480(0x126)](_0x2dd480(0x9e));}),_0x5f245b['on'](_0x507e00(0x25a),(_0x8a55e,_0x559b3c)=>{const _0x1e9a20=_0x507e00;if(validateAccess(_0x559b3c,_0x54eaf4)[_0x1e9a20(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x1e9a20(0x139)]({'function':_0x1e9a20(0xcd),'args':_0x8a55e});}else logger[_0x1e9a20(0x126)](_0x1e9a20(0x124));}),_0x5f245b['on'](_0x507e00(0x268),_0x40bf8b=>{const _0x5f1b35=_0x507e00;if(validateAccess(_0x40bf8b,_0x54eaf4)[_0x5f1b35(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x5f1b35(0x139)]({'function':_0x5f1b35(0x157),'args':null});}else logger[_0x5f1b35(0x126)](_0x5f1b35(0xf4));}),_0x5f245b['on'](_0x507e00(0x163),_0x528579=>{const _0x3311ef=_0x507e00;if(validateAccess(_0x528579,_0x54eaf4)[_0x3311ef(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x3311ef(0x139)]({'function':'getStartingBalances','args':null});}else logger[_0x3311ef(0x126)](_0x3311ef(0x1a0));}),_0x5f245b['on'](_0x507e00(0x1b7),(_0x259ed9,_0x1c6185)=>{const _0x38c810=_0x507e00;if(validateAccess(_0x1c6185,_0x54eaf4)[_0x38c810(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c][_0x38c810(0x139)]({'function':_0x38c810(0xd0),'args':_0x259ed9});}else logger['full'](_0x38c810(0x26e));}),_0x5f245b['on'](_0x507e00(0xa5),_0x3f56fc=>{const _0x1d7a2f=_0x507e00;if(validateAccess(_0x3f56fc,_0x54eaf4)['allow']){if(pid[_0x3a5a4c])pid[_0x3a5a4c]['send']({'function':_0x1d7a2f(0x97),'args':null});}else logger[_0x1d7a2f(0x126)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5f245b['on'](_0x507e00(0xce),_0x559d9c=>{const _0x347eaa=_0x507e00;if(validateAccess(_0x559d9c,_0x54eaf4)[_0x347eaa(0xf0)]){if(pid[_0x3a5a4c])pid[_0x3a5a4c]['send']({'function':_0x347eaa(0xed),'args':null});}else logger[_0x347eaa(0x126)](_0x347eaa(0x144));}),_0x5f245b['on']('update-bb',_0x5e89d2=>{const _0x4741ff=_0x507e00;if(validateAccess(_0x5e89d2,_0x54eaf4)['allow'])updateBB('update');else logger[_0x4741ff(0x126)](_0x4741ff(0x28c));}),_0x5f245b['on'](_0x507e00(0xa3),_0x223aa4=>{const _0x4cc988=_0x507e00;if(validateAccess(_0x223aa4,_0x54eaf4)['allow'])getMessages();else logger[_0x4cc988(0x126)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5f245b['on'](_0x507e00(0xa7),(_0x277ab0,_0x27e549)=>{const _0x4b3e6d=_0x507e00;if(validateAccess(_0x27e549,_0x54eaf4)['allow'])confirmMessage(_0x277ab0);else logger[_0x4b3e6d(0x126)](_0x4b3e6d(0x1be));}),_0x5f245b['on'](_0x507e00(0x27f),_0x5859ff=>{const _0x3377ef=_0x507e00;if(validateAccess(_0x5859ff,_0x54eaf4)[_0x3377ef(0xf0)]){if(devices[_0x54eaf4]['pidRefreshToken'])clearTimeout(devices[_0x54eaf4][_0x3377ef(0x1dc)]);if(devices[_0x54eaf4]['pidExpireLogin'])clearTimeout(devices[_0x54eaf4][_0x3377ef(0x24c)]);removeSocketListeners(getClient(_0x5f245b['id'])[_0x3377ef(0x120)]),addBlacklist(_0x54eaf4),devices[_0x54eaf4][_0x3377ef(0x205)]=null,devices[_0x54eaf4][_0x3377ef(0xdc)]=null,devices[_0x54eaf4][_0x3377ef(0x1ec)][_0x3377ef(0xbc)]=null,logger[_0x3377ef(0xec)](_0x3377ef(0xd4)+_0x54eaf4['slice'](-0x8)),io['to'](getClient(_0x5f245b['id'])[_0x3377ef(0x120)])[_0x3377ef(0x1ad)](_0x3377ef(0xe5),{'access':{'allow':![],'reason':_0x3377ef(0x242),'token':null}});}else logger['full'](_0x3377ef(0x1f4));});}function removeSocketListeners(_0x2067f0){const _0x5d6f63=_0x4d318f;getClientsWithUuid(_0x2067f0)[_0x5d6f63(0x210)](_0x11bd58=>{const _0x296ff1=_0x5d6f63;getSocket(_0x11bd58['id'])[_0x296ff1(0xee)]();});}function cleanSettings(){const _0x27afa7=_0x4d318f;let _0x13c2ba=settings;return settings['telegramToken']&&settings[_0x27afa7(0xcb)]!=''&&(_0x13c2ba={..._0x13c2ba,'telegramToken':_0x27afa7(0x113)}),settings[_0x27afa7(0x196)]&&settings[_0x27afa7(0x196)]!=''&&(_0x13c2ba={..._0x13c2ba,'bbPassword':_0x27afa7(0x113)}),(settings[_0x27afa7(0x196)]&&settings[_0x27afa7(0x196)]==_0x27afa7(0x16b)||settings[_0x27afa7(0xcb)]&&settings[_0x27afa7(0xcb)]==_0x27afa7(0x16b))&&(_0x13c2ba={..._0x13c2ba,'restored':{'password':settings[_0x27afa7(0x196)]==_0x27afa7(0x16b),'telegram':settings[_0x27afa7(0xcb)]==_0x27afa7(0x16b)}}),_0x13c2ba;}async function updateBB(_0x583623){const _0x417044=_0x4d318f;await backupConfigFiles(),installingUpdate=!![],config[_0x417044(0x210)](_0x221d79=>{const _0x533a38=_0x417044;restartBot(_0x221d79[_0x533a38(0xcf)]);});if(_0x583623==_0x417044(0x204))process[_0x417044(0x139)]({'update':!![],'environment':environment},_0x304c6b=>{});else _0x583623==_0x417044(0xe9)&&process[_0x417044(0x139)]({'reinstall':!![],'environment':environment},_0x65acc=>{});}function startBot(_0x525ca8,_0x40e25c,_0x12183e){const _0x373fa4=_0x4d318f;if(debugging)_0x525ca8['push']('-d');let _0x402748=![];const _0x27e7c5=_0x525ca8[0x0];_0x40e25c={..._0x40e25c,'stdio':[_0x373fa4(0x261),_0x373fa4(0x261),_0x373fa4(0x261),_0x373fa4(0xf9)]},pid[_0x27e7c5]=childProcess[_0x373fa4(0x9b)](botfile,_0x525ca8,_0x40e25c),pid[_0x27e7c5]['on'](_0x373fa4(0xa1),_0x1a0902=>{const _0x375a7a=_0x373fa4;switch(Object[_0x375a7a(0x122)](_0x1a0902)[0x0]){case'botname':updateBotName(_0x27e7c5,_0x1a0902[_0x375a7a(0x18b)]);break;case'updatebotmanager':updateBotManager();break;case _0x375a7a(0xe5):updateStatus(_0x27e7c5,_0x1a0902['status']);break;case'live':updateLive(_0x27e7c5,_0x1a0902[_0x375a7a(0x1e4)]);break;case _0x375a7a(0x1f1):updateLive(_0x27e7c5,_0x1a0902[_0x375a7a(0x1f1)]),io['to'](_0x27e7c5)['emit'](_0x375a7a(0xe5),{'access':{'allow':![],'reason':_0x375a7a(0x1bc),'token':null}});break;case _0x375a7a(0x1e9):_0x1a0902[_0x375a7a(0x1e9)]=='restart'&&restartBot(_0x27e7c5);_0x1a0902[_0x375a7a(0x1e9)]==_0x375a7a(0x219)&&toggleBot(_0x27e7c5,_0x375a7a(0x175),'stopped');break;case'telegram':sendTelegramBot(_0x27e7c5,_0x1a0902[_0x375a7a(0x1eb)]);break;case _0x375a7a(0x209):sendTelegramMsg(_0x1a0902[_0x375a7a(0x209)]);break;case _0x375a7a(0x142):io['to'](_0x27e7c5)[_0x375a7a(0x1ad)](_0x1a0902[_0x375a7a(0x142)],_0x1a0902['args']);break;}}),pid[_0x27e7c5]['on'](_0x373fa4(0x23c),function(_0x200c76){if(_0x402748)return;_0x402748=!![],_0x12183e(_0x200c76);}),pid[_0x27e7c5]['on']('exit',async function(_0x186f63){const _0x4990df=_0x373fa4;if(installingUpdate)return;if(_0x402748)return;_0x402748=!![],_0x12183e(null);const _0x3c5618=dbConfig[_0x4990df(0x155)](_0x4990df(0xb9))[_0x4990df(0xc8)]({'botID':_0x27e7c5})[_0x4990df(0x222)]();_0x3c5618&&(_0x3c5618[_0x4990df(0xe5)]=='enabled'||_0x3c5618['status']=='new')&&(await sleep(0x3e8),updateLive(_0x27e7c5,_0x4990df(0x19d)),logger[_0x4990df(0x126)]('Restarting\x20Bot\x20'+_0x27e7c5),startBot([_0x27e7c5,userID],{'cwd':bbpath},function(_0x5b6ed1){const _0x5f33f7=_0x4990df;if(_0x5b6ed1)logger[_0x5f33f7(0x126)](_0x5b6ed1);}));});}function stopBot(_0x349193){const _0x154e60=_0x4d318f;getClientsWithBotID(_0x349193)[_0x154e60(0x210)](_0x36ad90=>{const _0x27f2c0=_0x154e60;getSocket(_0x36ad90['id'])[_0x27f2c0(0x238)](!![]),removeClient(_0x36ad90['id']);}),pid[_0x349193]&&(pid[_0x349193][_0x154e60(0x219)](),pid[_0x349193]=null);}function restartBot(_0x465ab2){const _0x29863a=_0x4d318f;if(pid[_0x465ab2])pid[_0x465ab2][_0x29863a(0x219)]();}function addBot(){const _0x9d1014=_0x4d318f;let _0x15a53a;for(let _0x3f678c=0x1;_0x3f678c<0x3e9;_0x3f678c++){_0x15a53a=_0x3f678c[_0x9d1014(0xbf)]()[_0x9d1014(0x235)](0x3,'0');let _0x41847a=config[_0x9d1014(0xc8)](_0x35edee=>_0x35edee[_0x9d1014(0xcf)]==_0x15a53a);if(!_0x41847a)break;}if(_0x15a53a===_0x9d1014(0xc3)){logger[_0x9d1014(0x126)](_0x9d1014(0x1ae));return;}logger[_0x9d1014(0x126)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x15a53a),dbConfig['get'](_0x9d1014(0xb9))[_0x9d1014(0xba)]({'botID':_0x15a53a,'botname':'Bot\x20'+_0x15a53a,'status':_0x9d1014(0x17d),'live':''})[_0x9d1014(0x136)](),startBot([_0x15a53a,userID],{'cwd':bbpath},function(_0x18f781){const _0x560ca9=_0x9d1014;if(_0x18f781)logger[_0x560ca9(0x126)](_0x18f781);}),config=getConfiguration(),io['to'](_0x9d1014(0x145))[_0x9d1014(0x1ad)](_0x9d1014(0xb9),config),broadcastToBots(_0x9d1014(0xb9),JSON[_0x9d1014(0x18d)](config));}function deleteBot(_0x42a223){const _0x349b25=_0x4d318f;getClientsWithBotID(_0x42a223)[_0x349b25(0x210)](_0x3f9bb1=>{const _0x4dff58=_0x349b25;getSocket(_0x3f9bb1['id'])[_0x4dff58(0x238)](!![]),removeClient(_0x3f9bb1['id']);}),dbConfig[_0x349b25(0x155)](_0x349b25(0xb9))[_0x349b25(0x193)]({'botID':_0x42a223})[_0x349b25(0x136)](),logger[_0x349b25(0x126)](_0x349b25(0x1d6)+_0x42a223),stopBot(_0x42a223);try{if(fs[_0x349b25(0x241)](path[_0x349b25(0xac)](configpath,_0x349b25(0x195)+_0x42a223+'-config.json')))fs['unlinkSync'](path[_0x349b25(0xac)](configpath,_0x349b25(0x195)+_0x42a223+_0x349b25(0x125)));if(fs['existsSync'](path[_0x349b25(0xac)](configpath,_0x349b25(0x195)+_0x42a223+_0x349b25(0x11a))))fs['unlinkSync'](path[_0x349b25(0xac)](configpath,'bot-'+_0x42a223+_0x349b25(0x11a)));if(fs[_0x349b25(0x241)](path['join'](configpath,_0x349b25(0x195)+_0x42a223+_0x349b25(0x284))))fs[_0x349b25(0x293)](path[_0x349b25(0xac)](configpath,'bot-'+_0x42a223+_0x349b25(0x284)));if(fs[_0x349b25(0x241)](path[_0x349b25(0xac)](configpath,_0x349b25(0x195)+_0x42a223+_0x349b25(0x171))))fs[_0x349b25(0x293)](path[_0x349b25(0xac)](configpath,_0x349b25(0x195)+_0x42a223+_0x349b25(0x171)));}catch(_0x4b461a){if(_0x4b461a)logger[_0x349b25(0x126)](_0x349b25(0x11f),_0x4b461a);}config=getConfiguration(),io['to'](_0x349b25(0x145))[_0x349b25(0x1ad)](_0x349b25(0xb9),config),broadcastToBots('bots',JSON[_0x349b25(0x18d)](config));}function toggleBot(_0x16f873,_0x1cc4da,_0x260185){const _0x35cf6b=_0x4d318f;dbConfig['get'](_0x35cf6b(0xb9))[_0x35cf6b(0xc8)]({'botID':_0x16f873})[_0x35cf6b(0x93)]({'status':_0x1cc4da})[_0x35cf6b(0x93)]({'live':_0x260185})[_0x35cf6b(0x136)]();if(_0x1cc4da==_0x35cf6b(0x1ef)||_0x1cc4da==_0x35cf6b(0x17d))logger[_0x35cf6b(0x126)](_0x35cf6b(0x1bb)+_0x16f873),startBot([_0x16f873,userID],{'cwd':bbpath},function(_0x2ac432){const _0x1e49b8=_0x35cf6b;if(_0x2ac432)logger[_0x1e49b8(0x126)](_0x2ac432);});else(_0x1cc4da==_0x35cf6b(0x175)||_0x1cc4da=='new-disabled')&&(logger['full']('Disabled\x20Bot\x20'+_0x16f873),stopBot(_0x16f873));config=getConfiguration(),io['to'](_0x35cf6b(0x145))[_0x35cf6b(0x1ad)](_0x35cf6b(0xb9),config),broadcastToBots(_0x35cf6b(0xb9),JSON[_0x35cf6b(0x18d)](config));}function toggleStatus(_0x2d59b1){const _0x5e855e=_0x4d318f;let _0x58ac7b=dbConfig[_0x5e855e(0x155)]('bots')[_0x5e855e(0xc8)]({'botID':_0x2d59b1})[_0x5e855e(0x222)](),_0xc9a810;if(_0x58ac7b[_0x5e855e(0xe5)]==='enabled')_0xc9a810='disabled';else{if(_0x58ac7b[_0x5e855e(0xe5)]===_0x5e855e(0x17d))_0xc9a810=_0x5e855e(0x25e);else{if(_0x58ac7b['status']==='new-disabled')_0xc9a810=_0x5e855e(0x17d);else{if(_0x58ac7b[_0x5e855e(0xe5)]===_0x5e855e(0x175))_0xc9a810=_0x5e855e(0x1ef);}}}return _0xc9a810;}function updateStatus(_0x573e17,_0x3d327e){const _0x750212=_0x4d318f;dbConfig['get']('bots')[_0x750212(0xc8)]({'botID':_0x573e17})['assign']({'status':_0x3d327e})[_0x750212(0x136)](),config=getConfiguration(),io['to'](_0x750212(0x145))[_0x750212(0x1ad)](_0x750212(0xb9),config),broadcastToBots(_0x750212(0xb9),JSON[_0x750212(0x18d)](config));}function updateLive(_0x5d22ce,_0x127a46){const _0x18e4eb=_0x4d318f;dbConfig[_0x18e4eb(0x155)](_0x18e4eb(0xb9))[_0x18e4eb(0xc8)]({'botID':_0x5d22ce})['assign']({'live':_0x127a46})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x18e4eb(0xb9),config),broadcastToBots(_0x18e4eb(0xb9),JSON[_0x18e4eb(0x18d)](config));}function updateBotName(_0x57f233,_0x240c0e){const _0x3874ef=_0x4d318f;dbConfig['get'](_0x3874ef(0xb9))[_0x3874ef(0xc8)]({'botID':_0x57f233})['assign']({'botname':_0x240c0e})[_0x3874ef(0x136)](),config=getConfiguration(),io['to'](_0x3874ef(0x145))[_0x3874ef(0x1ad)]('bots',config),broadcastToBots(_0x3874ef(0xb9),JSON[_0x3874ef(0x18d)](config));}function updateBotManager(){const _0x4707fc=_0x4d318f;config=getConfiguration(),io['to'](_0x4707fc(0x145))[_0x4707fc(0x1ad)](_0x4707fc(0xb9),config),broadcastToBots(_0x4707fc(0xb9),JSON[_0x4707fc(0x18d)](config));}function toggleBotMode(_0x4f0e14){const _0x1a82e9=_0x4d318f;if(pid[_0x4f0e14])pid[_0x4f0e14][_0x1a82e9(0x139)]({'function':'toggleBotMode','args':null});else{const _0x1ddb24=configpath+_0x1a82e9(0x195)+_0x4f0e14+'-config.json',_0x136b15=fs[_0x1a82e9(0x123)](_0x1ddb24),_0x3811a7=JSON[_0x1a82e9(0x94)](_0x136b15),_0x18a1ac=_0x3811a7['bot'][0x0]['headless'];_0x3811a7['bot'][0x0][_0x1a82e9(0x1c8)]=!_0x18a1ac;const _0x1001f6=JSON[_0x1a82e9(0x18d)](_0x3811a7,null,0x2);fs[_0x1a82e9(0x185)](_0x1ddb24,_0x1001f6),config=getConfiguration(),io['to'](_0x1a82e9(0x145))[_0x1a82e9(0x1ad)](_0x1a82e9(0xb9),config),broadcastToBots(_0x1a82e9(0xb9),JSON[_0x1a82e9(0x18d)](config));}}function validateTelegram(_0x39239b){const _0x44482a=_0x4d318f;if(_0x39239b[_0x44482a(0x1ac)][_0x44482a(0x292)]!=settings[_0x44482a(0xaa)]&&'@'+_0x39239b[_0x44482a(0x1ac)]['username']!=settings[_0x44482a(0xaa)]||_0x39239b['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x39239b[_0x44482a(0x109)]['id'],_0x44482a(0x15c),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x56315a=_0x4d318f;if(tgBot)tgBot[_0x56315a(0x1e9)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x56315a(0xcb)]);let _0x31cb7e='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x31cb7e+='\x0a',_0x31cb7e+=_0x56315a(0x11c),_0x31cb7e+=_0x56315a(0x14c),_0x31cb7e+=_0x56315a(0x280),_0x31cb7e+=_0x56315a(0x14b),_0x31cb7e+=_0x56315a(0x1f0),_0x31cb7e+=_0x56315a(0x22b),_0x31cb7e+=_0x56315a(0x11d),_0x31cb7e+=_0x56315a(0x287),_0x31cb7e+=_0x56315a(0xbe),_0x31cb7e+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x31cb7e+=_0x56315a(0x289),_0x31cb7e+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x31cb7e+=_0x56315a(0xf6),_0x31cb7e+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2455a9=_0x56315a(0x1ba);_0x2455a9+='\x0a',_0x2455a9+=_0x31cb7e,tgBot[_0x56315a(0x24f)]((_0x359a25,_0x14313c)=>{const _0x1e8f03=_0x56315a;logger[_0x1e8f03(0xc5)](getTimeStamp()+_0x1e8f03(0x23f)),logger[_0x1e8f03(0xec)](_0x1e8f03(0x117),_0x359a25);}),tgBot['use'](async(_0x497300,_0x3e247b)=>{const _0x110fe2=_0x56315a;if(!(!settings[_0x110fe2(0x231)]&&_0x497300[_0x110fe2(0x204)][_0x110fe2(0xa1)]['text']=='/start')){if(!validateTelegram(_0x497300))return;}_0x3e247b();}),tgBot['command'](_0x56315a(0x10d),async _0x70c052=>{const _0x4cf709=_0x56315a;if(!settings[_0x4cf709(0x231)])updateSetting(_0x4cf709(0x231),_0x70c052[_0x4cf709(0x109)]['id']);updateSetting(_0x4cf709(0x272),!![]);if(!validateTelegram(_0x70c052))return;sendTelegram(_0x70c052[_0x4cf709(0x109)]['id'],_0x2455a9);}),tgBot[_0x56315a(0x115)](_0x56315a(0x1cc),async _0x5423a2=>{const _0x3c4321=_0x56315a;updateSetting(_0x3c4321(0x272),!![]),sendTelegram(_0x5423a2['chat']['id'],_0x3c4321(0x1c9));}),tgBot[_0x56315a(0x115)](_0x56315a(0x135),async _0x4ee104=>{const _0x51ba0e=_0x56315a;sendTelegram(_0x4ee104['chat']['id'],_0x51ba0e(0x133)),updateSetting('telegramEnabled',![]);}),tgBot[_0x56315a(0x115)](_0x56315a(0x1c4),async _0x4f7ffd=>{const _0x562967=_0x56315a,_0x116339=Markup[_0x562967(0x279)]([Markup[_0x562967(0x1fc)][_0x562967(0xe3)]('Orders','config_orders'),Markup[_0x562967(0x1fc)][_0x562967(0xe3)]('Alerts','config_alerts'),Markup[_0x562967(0x1fc)]['callback']('All',_0x562967(0x28e))]);_0x4f7ffd[_0x562967(0x206)](_0x562967(0x1d9),_0x116339);}),tgBot['action'](_0x56315a(0x176),async _0x19aa86=>{const _0x1154e9=_0x56315a;_0x19aa86[_0x1154e9(0x20b)](),updateSetting(_0x1154e9(0xb8),'orders'),updateSetting(_0x1154e9(0x272),!![]),await sendTelegram(_0x19aa86[_0x1154e9(0x109)]['id'],_0x1154e9(0x1b3));}),tgBot['action'](_0x56315a(0x99),async _0x3e2c22=>{const _0x489f56=_0x56315a;_0x3e2c22[_0x489f56(0x20b)](),updateSetting(_0x489f56(0xb8),_0x489f56(0x1d4)),updateSetting(_0x489f56(0x272),!![]),await sendTelegram(_0x3e2c22['chat']['id'],_0x489f56(0x118));}),tgBot[_0x56315a(0x1a7)](_0x56315a(0x28e),async _0x342b82=>{const _0x5cb85b=_0x56315a;_0x342b82[_0x5cb85b(0x20b)](),updateSetting(_0x5cb85b(0xb8),_0x5cb85b(0x146)),updateSetting(_0x5cb85b(0x272),!![]),await sendTelegram(_0x342b82[_0x5cb85b(0x109)]['id'],_0x5cb85b(0x270));}),tgBot[_0x56315a(0x115)](_0x56315a(0xe5),async _0x18f644=>{const _0x1d4fee=_0x56315a,_0x229b9b=getBotsWithMode();let _0xb537fa=_0x1d4fee(0x1f8);config[_0x1d4fee(0x210)](_0x4e5419=>{const _0x5dfc26=_0x1d4fee,_0x49c40e=_0x229b9b[_0x5dfc26(0xc8)](_0x36d76a=>_0x36d76a[_0x5dfc26(0xcf)]==_0x4e5419[_0x5dfc26(0xcf)])['mode'];_0xb537fa+=_0x5dfc26(0x244)+_0x4e5419[_0x5dfc26(0xcf)]+':\x20'+_0x4e5419[_0x5dfc26(0xe5)]+'\x20|\x20'+_0x49c40e+_0x5dfc26(0x282)+_0x4e5419['live']+'\x0a';}),_0xb537fa+='\x0a',_0xb537fa+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0xb537fa+=!settings[_0x1d4fee(0x272)]?_0x1d4fee(0xca):_0x1d4fee(0x1b1),_0xb537fa+=settings[_0x1d4fee(0x272)]?settings[_0x1d4fee(0xb8)]==_0x1d4fee(0x146)?_0x1d4fee(0x11e):'Notifications\x20types:\x20'+settings[_0x1d4fee(0xb8)]+_0x1d4fee(0x286):'',sendTelegram(_0x18f644['chat']['id'],_0xb537fa,{'parse_mode':_0x1d4fee(0x27e)});}),tgBot['command'](_0x56315a(0x152),async _0x46eceb=>{const _0x215478=_0x56315a,_0x709881=getEnabledBots();if(_0x709881[_0x215478(0x121)]==0x0)sendTelegram(_0x46eceb['chat']['id'],_0x215478(0x1cd));else{if(_0x709881[_0x215478(0x121)]>0x1)_0x709881[_0x215478(0xba)]({'botID':'all'});let _0x4b93a6=[],_0x1cb671=[];const _0x41f0dc=_0x709881['length']%0x4==0x0||_0x709881['length']%0x4==0x3||_0x709881['length']%0x3==0x1?0x4:0x3;let _0x2a6b48=0x0;_0x709881[_0x215478(0x210)]((_0x118d4d,_0x47a22e)=>{const _0x5831a1=_0x215478;if(_0x47a22e%_0x41f0dc==0x0)_0x1cb671=[];_0x1cb671[_0x5831a1(0xba)](Markup[_0x5831a1(0x1fc)]['callback'](_0x118d4d['botID']==_0x5831a1(0x146)?_0x5831a1(0x1d8):_0x5831a1(0x244)+_0x118d4d[_0x5831a1(0xcf)],_0x5831a1(0x247)+_0x118d4d[_0x5831a1(0xcf)])),_0x47a22e%_0x41f0dc==0x0&&(_0x4b93a6[_0x2a6b48]=_0x1cb671,_0x2a6b48++);});const _0x342b0f=Markup[_0x215478(0x279)](_0x4b93a6);_0x46eceb[_0x215478(0x206)](_0x215478(0x92),_0x342b0f);}}),tgBot['action'](/restart_(.+)/,async _0x3a6d2f=>{const _0x51b6d8=_0x56315a,_0xe549f1=_0x3a6d2f[_0x51b6d8(0xd8)][0x1];_0x3a6d2f[_0x51b6d8(0x20b)](),_0xe549f1==_0x51b6d8(0x146)?config[_0x51b6d8(0x210)](_0x172681=>{const _0x1d5f79=_0x51b6d8;restartBot(_0x172681[_0x1d5f79(0xcf)]);}):restartBot(_0xe549f1);}),tgBot[_0x56315a(0x115)]('on',async _0x4a19e3=>{const _0x49e3be=_0x56315a,_0x5c49da=getDisabledBots();if(_0x5c49da['length']==0x0)sendTelegram(_0x4a19e3[_0x49e3be(0x109)]['id'],_0x49e3be(0x16d));else{if(_0x5c49da['length']>0x1)_0x5c49da[_0x49e3be(0xba)]({'botID':_0x49e3be(0x146)});let _0x504287=[],_0x71ec6d=[];const _0x28ba9d=_0x5c49da['length']%0x4==0x0||_0x5c49da['length']%0x4==0x3||_0x5c49da['length']%0x3==0x1?0x4:0x3;let _0x416bf5=0x0;_0x5c49da[_0x49e3be(0x210)]((_0x88e31e,_0x3502c9)=>{const _0x56bea0=_0x49e3be;if(_0x3502c9%_0x28ba9d==0x0)_0x71ec6d=[];_0x71ec6d[_0x56bea0(0xba)](Markup[_0x56bea0(0x1fc)]['callback'](_0x88e31e['botID']==_0x56bea0(0x146)?'All\x20bots':'Bot\x20'+_0x88e31e[_0x56bea0(0xcf)],_0x56bea0(0x22f)+_0x88e31e[_0x56bea0(0xcf)])),_0x3502c9%_0x28ba9d==0x0&&(_0x504287[_0x416bf5]=_0x71ec6d,_0x416bf5++);});const _0x1e6f5f=Markup['inlineKeyboard'](_0x504287);_0x4a19e3['reply'](_0x49e3be(0x159),_0x1e6f5f);}}),tgBot[_0x56315a(0x1a7)](/on_(.+)/,async _0xe003dd=>{const _0x2ecf1f=_0x56315a,_0x3ce8b8=_0xe003dd[_0x2ecf1f(0xd8)][0x1];_0xe003dd['editMessageReplyMarkup']();if(_0x3ce8b8=='all'){const _0xa0c607=getDisabledBots();sendTelegram(_0xe003dd['chat']['id'],_0x2ecf1f(0x27d)),_0xa0c607[_0x2ecf1f(0x210)](_0x1e44e3=>{const _0x4742f1=_0x2ecf1f;if(_0x1e44e3[_0x4742f1(0xcf)]!=_0x4742f1(0x146))toggleBot(_0x1e44e3[_0x4742f1(0xcf)],toggleStatus(_0x1e44e3[_0x4742f1(0xcf)]),_0x4742f1(0x19d));});}else sendTelegram(_0xe003dd[_0x2ecf1f(0x109)]['id'],_0x2ecf1f(0x108)+_0x3ce8b8),toggleBot(_0x3ce8b8,toggleStatus(_0x3ce8b8),_0x2ecf1f(0x19d));}),tgBot[_0x56315a(0x115)]('off',async _0x33d6be=>{const _0x479c2f=_0x56315a,_0x3fd55d=getEnabledBots();if(_0x3fd55d['length']==0x0)sendTelegram(_0x33d6be[_0x479c2f(0x109)]['id'],_0x479c2f(0x1cd));else{if(_0x3fd55d[_0x479c2f(0x121)]>0x1)_0x3fd55d[_0x479c2f(0xba)]({'botID':_0x479c2f(0x146)});let _0x478788=[],_0x13a6f8=[];const _0x1fd6c8=_0x3fd55d[_0x479c2f(0x121)]%0x4==0x0||_0x3fd55d[_0x479c2f(0x121)]%0x4==0x3||_0x3fd55d[_0x479c2f(0x121)]%0x3==0x1?0x4:0x3;let _0x5dec00=0x0;_0x3fd55d[_0x479c2f(0x210)]((_0x31ecc6,_0x1e9df3)=>{const _0x3a0250=_0x479c2f;if(_0x1e9df3%_0x1fd6c8==0x0)_0x13a6f8=[];_0x13a6f8[_0x3a0250(0xba)](Markup[_0x3a0250(0x1fc)]['callback'](_0x31ecc6['botID']=='all'?_0x3a0250(0x1d8):_0x3a0250(0x244)+_0x31ecc6[_0x3a0250(0xcf)],'off_'+_0x31ecc6[_0x3a0250(0xcf)])),_0x1e9df3%_0x1fd6c8==0x0&&(_0x478788[_0x5dec00]=_0x13a6f8,_0x5dec00++);});const _0x2dba29=Markup[_0x479c2f(0x279)](_0x478788);_0x33d6be[_0x479c2f(0x206)](_0x479c2f(0x278),_0x2dba29);}}),tgBot['action'](/off_(.+)/,async _0x242721=>{const _0x34a48a=_0x56315a,_0x198a47=_0x242721[_0x34a48a(0xd8)][0x1];_0x242721['editMessageReplyMarkup']();if(_0x198a47==_0x34a48a(0x146)){const _0x423335=getEnabledBots();sendTelegram(_0x242721[_0x34a48a(0x109)]['id'],_0x34a48a(0xfe)),_0x423335['forEach'](_0x9f98fe=>{const _0x3c258f=_0x34a48a;if(_0x9f98fe[_0x3c258f(0xcf)]!=_0x3c258f(0x146))toggleBot(_0x9f98fe[_0x3c258f(0xcf)],toggleStatus(_0x9f98fe[_0x3c258f(0xcf)]),_0x3c258f(0x19d));});}else sendTelegram(_0x242721['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x198a47),toggleBot(_0x198a47,toggleStatus(_0x198a47),_0x34a48a(0x19d));}),tgBot[_0x56315a(0x115)]('metrics',async _0x30749b=>{const _0x382203=_0x56315a,_0x3ea2bb=getEnabledBots();if(_0x3ea2bb[_0x382203(0x121)]==0x0)sendTelegram(_0x30749b[_0x382203(0x109)]['id'],_0x382203(0x1cd));else{if(_0x3ea2bb['length']>0x1){let _0x424d85=[],_0x31cfbf=[];const _0x12081b=_0x3ea2bb[_0x382203(0x121)]%0x4==0x0||_0x3ea2bb[_0x382203(0x121)]%0x4==0x3||_0x3ea2bb[_0x382203(0x121)]%0x3==0x1?0x4:0x3;let _0x2b3537=0x0;_0x3ea2bb[_0x382203(0x210)]((_0x295619,_0x2cf7b6)=>{const _0x2b468e=_0x382203;if(_0x2cf7b6%_0x12081b==0x0)_0x31cfbf=[];_0x31cfbf[_0x2b468e(0xba)](Markup[_0x2b468e(0x1fc)]['callback']('Bot\x20'+_0x295619[_0x2b468e(0xcf)],'metrics_'+_0x295619[_0x2b468e(0xcf)])),_0x2cf7b6%_0x12081b==0x0&&(_0x424d85[_0x2b3537]=_0x31cfbf,_0x2b3537++);});const _0x3663bb=Markup[_0x382203(0x279)](_0x424d85);_0x30749b['reply'](_0x382203(0x151),_0x3663bb);}else{const _0x3c1959=_0x3ea2bb[0x0][_0x382203(0xcf)];if(pid[_0x3c1959])pid[_0x3c1959][_0x382203(0x139)]({'function':_0x382203(0x274),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x4ace4a=>{const _0x16e684=_0x56315a,_0x27a2c7=_0x4ace4a['match'][0x1];_0x4ace4a[_0x16e684(0x20b)]();if(pid[_0x27a2c7])pid[_0x27a2c7]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x56315a(0x115)](_0x56315a(0x13a),async _0x3612f9=>{const _0x26c71d=_0x56315a,_0x45e681=getEnabledBots();if(_0x45e681['length']==0x0)sendTelegram(_0x3612f9[_0x26c71d(0x109)]['id'],_0x26c71d(0x1cd));else{if(_0x45e681['length']>0x1){let _0x427816=[],_0x58fa05=[];const _0x4e3232=_0x45e681[_0x26c71d(0x121)]%0x4==0x0||_0x45e681[_0x26c71d(0x121)]%0x4==0x3||_0x45e681[_0x26c71d(0x121)]%0x3==0x1?0x4:0x3;let _0x4011bd=0x0;_0x45e681[_0x26c71d(0x210)]((_0x395632,_0x416284)=>{const _0x57bfcc=_0x26c71d;if(_0x416284%_0x4e3232==0x0)_0x58fa05=[];_0x58fa05[_0x57bfcc(0xba)](Markup[_0x57bfcc(0x1fc)][_0x57bfcc(0xe3)]('Bot\x20'+_0x395632[_0x57bfcc(0xcf)],'portfolio_'+_0x395632[_0x57bfcc(0xcf)])),_0x416284%_0x4e3232==0x0&&(_0x427816[_0x4011bd]=_0x58fa05,_0x4011bd++);});const _0x5b6af3=Markup[_0x26c71d(0x279)](_0x427816);_0x3612f9[_0x26c71d(0x206)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x5b6af3);}else{const _0x183cab=_0x45e681[0x0][_0x26c71d(0xcf)];if(pid[_0x183cab])pid[_0x183cab][_0x26c71d(0x139)]({'function':_0x26c71d(0x182),'args':null});}}}),tgBot[_0x56315a(0x1a7)](/portfolio_(.+)/,async _0x129ad9=>{const _0x40940b=_0x56315a,_0x2f06ec=_0x129ad9[_0x40940b(0xd8)][0x1];_0x129ad9[_0x40940b(0x20b)]();if(pid[_0x2f06ec])pid[_0x2f06ec][_0x40940b(0x139)]({'function':_0x40940b(0x182),'args':null});}),tgBot[_0x56315a(0x115)](_0x56315a(0x204),async _0x41c835=>{const _0x56c376=_0x56315a;await getMessages();if(!updateAvailable)sendTelegram(_0x41c835[_0x56c376(0x109)]['id'],_0x56c376(0xdd));else{if(!validInstallation)sendTelegram(_0x41c835['chat']['id'],_0x56c376(0x16e));else{const _0xf2ff1b=Markup[_0x56c376(0x279)]([Markup[_0x56c376(0x1fc)][_0x56c376(0xe3)](_0x56c376(0x22d),_0x56c376(0x1a2)),Markup[_0x56c376(0x1fc)][_0x56c376(0xe3)]('No',_0x56c376(0x24b))]);_0x41c835[_0x56c376(0x206)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0xf2ff1b);}}}),tgBot[_0x56315a(0x1a7)](/update_(.+)/,async _0x15124a=>{const _0x3e20eb=_0x56315a,_0x3a4516=_0x15124a[_0x3e20eb(0xd8)][0x1];_0x15124a[_0x3e20eb(0x20b)](),_0x3a4516==_0x3e20eb(0x248)&&(await sendTelegram(_0x15124a[_0x3e20eb(0x109)]['id'],_0x3e20eb(0x166)),updateBB('update')),_0x3a4516=='no'&&await sendTelegram(_0x15124a['chat']['id'],_0x3e20eb(0x12b));}),tgBot[_0x56315a(0x115)](_0x56315a(0xe9),async _0x304f87=>{const _0x452e0b=_0x56315a;if(!validInstallation)sendTelegram(_0x304f87['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x1daed7=Markup['inlineKeyboard']([Markup[_0x452e0b(0x1fc)]['callback']('Yes',_0x452e0b(0x1d0)),Markup[_0x452e0b(0x1fc)][_0x452e0b(0xe3)]('No',_0x452e0b(0x1f3))]);_0x304f87['reply'](_0x452e0b(0x1e3),_0x1daed7);}}),tgBot['action'](/reinstall_(.+)/,async _0x522fa9=>{const _0x172d27=_0x56315a,_0x36e374=_0x522fa9[_0x172d27(0xd8)][0x1];_0x522fa9[_0x172d27(0x20b)](),_0x36e374=='yes'&&(await sendTelegram(_0x522fa9[_0x172d27(0x109)]['id'],_0x172d27(0x28d)),updateBB(_0x172d27(0xe9))),_0x36e374=='no'&&await sendTelegram(_0x522fa9[_0x172d27(0x109)]['id'],_0x172d27(0xd7));}),tgBot[_0x56315a(0x115)](_0x56315a(0x1ca),async _0x951fd6=>{const _0x51307b=_0x56315a,_0x571b6d=getBotsWithMode();if(_0x571b6d[_0x51307b(0x121)]==0x0)sendTelegram(_0x951fd6[_0x51307b(0x109)]['id'],_0x51307b(0x1cd));else{let _0x2c2caf=[],_0x216577=[];const _0x24f77b=0x2;let _0x1d4bf4=0x0;_0x571b6d[_0x51307b(0x210)]((_0x22b99d,_0x559345)=>{const _0x20827e=_0x51307b;if(_0x559345%_0x24f77b==0x0)_0x216577=[];_0x216577[_0x20827e(0xba)](Markup[_0x20827e(0x1fc)][_0x20827e(0xe3)]('Bot\x20'+_0x22b99d[_0x20827e(0xcf)]+'\x20('+_0x22b99d[_0x20827e(0xe4)]+')',_0x20827e(0x228)+_0x22b99d[_0x20827e(0xcf)])),_0x559345%_0x24f77b==0x0&&(_0x2c2caf[_0x1d4bf4]=_0x216577,_0x1d4bf4++);});const _0x254b6d=Markup[_0x51307b(0x279)](_0x2c2caf);_0x951fd6[_0x51307b(0x206)](_0x51307b(0x1f7),_0x254b6d);}}),tgBot[_0x56315a(0x1a7)](/toggle_(.+)/,async _0x5cf7ca=>{const _0x1559e0=_0x56315a,_0x9cb136=_0x5cf7ca[_0x1559e0(0xd8)][0x1];_0x5cf7ca[_0x1559e0(0x20b)]();const _0x566fbc=getBotsWithMode(),_0x50d877=_0x566fbc[_0x1559e0(0xc8)](_0x1782a1=>_0x1782a1['botID']==_0x9cb136),_0x34fdb7=_0x50d877[_0x1559e0(0xe4)]==_0x1559e0(0x1c7)?_0x1559e0(0x119):_0x1559e0(0x1c7);sendTelegram(_0x5cf7ca[_0x1559e0(0x109)]['id'],_0x1559e0(0x290)+_0x9cb136+'\x20to\x20'+_0x34fdb7+'\x20mode'),toggleBotMode(_0x9cb136);}),tgBot[_0x56315a(0x115)](_0x56315a(0x26c),async _0x56f63c=>{const _0x1c60b9=_0x56315a;let _0x15b168='';config[_0x1c60b9(0x210)](_0x20079f=>{const _0x22381b=_0x1c60b9;_0x15b168+=_0x22381b(0x244)+_0x20079f[_0x22381b(0xcf)]+':\x20'+_0x20079f['botname']+'\x0a';}),sendTelegram(_0x56f63c[_0x1c60b9(0x109)]['id'],_0x15b168,{'parse_mode':_0x1c60b9(0x27e)});}),tgBot[_0x56315a(0x115)]('help',async _0xd86395=>{const _0x1875dd=_0x56315a;sendTelegram(_0xd86395[_0x1875dd(0x109)]['id'],_0x31cb7e);}),process[_0x56315a(0x216)](_0x56315a(0x23b),()=>tgBot['stop'](_0x56315a(0x23b))),process[_0x56315a(0x216)](_0x56315a(0x1d5),()=>tgBot[_0x56315a(0x1e9)](_0x56315a(0x1d5))),tgBot[_0x56315a(0x21e)]();}}function disableTelegram(){const _0x53ba79=_0x4d318f;tgBot&&tgBot[_0x53ba79(0x1e9)]();}async function sendTelegram(_0x14637c,_0x6a1edb,_0x120f72){const _0x183866=_0x4d318f;try{await tgBot[_0x183866(0x1eb)]['sendMessage'](_0x14637c,_0x6a1edb,_0x120f72);}catch(_0x32dc7c){console[_0x183866(0x1bf)](_0x183866(0x15f),_0x32dc7c);}}function sendTelegramBot(_0x234845,_0x3e7e0f){const _0x5394c3=_0x4d318f;if(settings[_0x5394c3(0x272)]){if(settings[_0x5394c3(0xb8)]==_0x5394c3(0x146)||(_0x3e7e0f[_0x5394c3(0xa0)]=='error'||_0x3e7e0f[_0x5394c3(0xa0)]==_0x5394c3(0x127)||_0x3e7e0f['type']==_0x5394c3(0x26b))&&settings[_0x5394c3(0xb8)]==_0x5394c3(0x1d4)||_0x3e7e0f[_0x5394c3(0xa0)]==_0x5394c3(0x1cf)&&settings[_0x5394c3(0xb8)]==_0x5394c3(0x17f)){if(tgBot&&settings['telegramChatId']){if(_0x3e7e0f[_0x5394c3(0xfa)])sendTelegram(settings[_0x5394c3(0x231)],_0x3e7e0f[_0x5394c3(0x18b)]+_0x5394c3(0x10a)+_0x3e7e0f[_0x5394c3(0x150)]);else sendTelegram(settings[_0x5394c3(0x231)],_0x5394c3(0x244)+_0x234845+_0x5394c3(0x10a)+_0x3e7e0f['event']);}}}}async function sendTelegramMsg(_0x4a42f7,_0x569415='HTML'){const _0x14100d=_0x4d318f;return settings['telegramEnabled']&&tgBot&&settings[_0x14100d(0x231)]?(await sendTelegram(settings['telegramChatId'],_0x4a42f7,{'parse_mode':_0x569415}),!![]):![];}function getDeviceWithIp(_0x3f8709){const _0x5503d1=_0x4d318f;return devices[_0x5503d1(0xc8)](_0x2cc43e=>_0x2cc43e['ip']===_0x3f8709);}function temporaryAccess2FA(_0x1fe961,_0x7c8646){const _0x5264c8=_0x4d318f;let _0x5a2a06=new Date(),_0x314bd1=![];if(lastIpApproval){if(_0x5a2a06-lastIpApproval<0x1388)_0x314bd1=!![];}lastIpApproval=new Date();if(_0x314bd1)return;if(tgBot&&settings['telegramChatId']){const _0x496498=Markup[_0x5264c8(0x279)]([Markup[_0x5264c8(0x1fc)][_0x5264c8(0xe3)]('5\x20min',_0x5264c8(0x232)),Markup[_0x5264c8(0x1fc)][_0x5264c8(0xe3)](_0x5264c8(0x22c),'tempaccess_15'),Markup['button'][_0x5264c8(0xe3)]('30\x20min',_0x5264c8(0x260)),Markup[_0x5264c8(0x1fc)][_0x5264c8(0xe3)](_0x5264c8(0x1e5),'tempaccess_reject')]);sendTelegram(settings[_0x5264c8(0x231)],_0x5264c8(0xab)+normalizeIP(_0x7c8646)[_0x5264c8(0x1bd)]+'\x20?',_0x496498),tgBot[_0x5264c8(0x1a7)](/tempaccess_(.+)/,async _0x9c7132=>{const _0x293b3c=_0x5264c8,_0x51d093=_0x9c7132[_0x293b3c(0xd8)][0x1];_0x9c7132[_0x293b3c(0x20b)](),devices[_0x1fe961]['telegramIpApproval']={'clientip':_0x7c8646,'timestamp':new Date()[_0x293b3c(0x184)](),'expiry':_0x51d093},_0x51d093!='reject'?(await sendTelegram(_0x9c7132['chat']['id'],'Access\x20enabled\x20for\x20'+_0x51d093+_0x293b3c(0x288),{'parse_mode':_0x293b3c(0x27e)}),io['to'](_0x1fe961)[_0x293b3c(0x1ad)](_0x293b3c(0xe5),{'access':{'allow':![],'reason':_0x293b3c(0x1bc),'token':null}})):(await sendTelegram(_0x9c7132['chat']['id'],_0x293b3c(0x285)),io['to'](_0x1fe961)[_0x293b3c(0x1ad)](_0x293b3c(0xe5),{'access':{'allow':![],'reason':_0x293b3c(0x28a),'token':null}}));});}}function loginAccess2FA(_0x4df6c6,_0x5e7f15){const _0x2ae605=_0x4d318f;if(tgBot&&settings[_0x2ae605(0x231)]){const _0x433d6c=Markup[_0x2ae605(0x279)]([Markup[_0x2ae605(0x1fc)][_0x2ae605(0xe3)](_0x2ae605(0x1a9),_0x2ae605(0x236)+loginExpiry),Markup[_0x2ae605(0x1fc)][_0x2ae605(0xe3)](_0x2ae605(0x1e5),_0x2ae605(0x23a))]);sendTelegram(settings[_0x2ae605(0x231)],_0x2ae605(0x1ea)+normalizeIP(_0x5e7f15)['show']+'\x20?',_0x433d6c),tgBot[_0x2ae605(0x1a7)](/login2fa_(.+)/,async _0x2254a6=>{const _0x43d9f0=_0x2ae605,_0x26fc82=_0x2254a6[_0x43d9f0(0xd8)][0x1];_0x2254a6[_0x43d9f0(0x20b)](),devices[_0x4df6c6][_0x43d9f0(0xdc)]={'clientip':_0x5e7f15,'timestamp':new Date()[_0x43d9f0(0x184)](),'expiry':_0x26fc82},_0x26fc82!=_0x43d9f0(0x1e5)?(await sendTelegram(_0x2254a6[_0x43d9f0(0x109)]['id'],_0x43d9f0(0x14e),{'parse_mode':_0x43d9f0(0x27e)}),io['to'](_0x4df6c6)[_0x43d9f0(0x1ad)](_0x43d9f0(0xe5),{'access':{'allow':![],'reason':_0x43d9f0(0x1bc),'token':null}})):(await sendTelegram(_0x2254a6[_0x43d9f0(0x109)]['id'],_0x43d9f0(0x1c2)),io['to'](_0x4df6c6)['emit']('status',{'access':{'allow':![],'reason':_0x43d9f0(0x12f),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x49e2eb=_0x4d318f;return dbConfig['get'](_0x49e2eb(0xb9))[_0x49e2eb(0x19f)](_0x49e2eb(0xcf))[_0x49e2eb(0x243)]({'status':_0x49e2eb(0x1ef)})[_0x49e2eb(0x222)]()||[];}function getDisabledBots(){const _0x475560=_0x4d318f;return dbConfig[_0x475560(0x155)]('bots')[_0x475560(0x19f)](_0x475560(0xcf))['filter']({'status':_0x475560(0x175)})[_0x475560(0x222)]()||[];}function getBotAttributes(_0x21757c){const _0x4f30bd=_0x4d318f;let _0x873024={};const _0x4fd0cd=configpath+'bot-'+_0x21757c+'-config.json',_0x264e53=fs[_0x4f30bd(0x241)](_0x4fd0cd);if(_0x264e53){const _0x37e70b=fs[_0x4f30bd(0x123)](_0x4fd0cd);try{const _0x4923a2=JSON['parse'](_0x37e70b),_0x2dfd7f=_0x4923a2?_0x4923a2['bot'][0x0][_0x4f30bd(0x1c8)]:![];_0x873024['mode']=_0x2dfd7f?_0x4f30bd(0x1c7):'manual',_0x873024['botname']=_0x4923a2?_0x4923a2[_0x4f30bd(0x169)][0x0][_0x4f30bd(0x18b)]:'Bot\x20'+_0x21757c;}catch(_0xcef477){_0x873024[_0x4f30bd(0xe4)]=_0x4f30bd(0x119),_0x873024[_0x4f30bd(0x18b)]=_0x4f30bd(0x244)+_0x21757c;}}else _0x873024['mode']='manual',_0x873024[_0x4f30bd(0x18b)]='Bot\x20'+_0x21757c;return _0x873024;}function _0x1e48(_0x536c27,_0x4d7e30){const _0x25bf5b=_0xf01d();return _0x1e48=function(_0x3e1540,_0x1067c6){_0x3e1540=_0x3e1540-0x92;let _0xf01d62=_0x25bf5b[_0x3e1540];return _0xf01d62;},_0x1e48(_0x536c27,_0x4d7e30);}function getBotsWithMode(){const _0xe43119=_0x4d318f,_0x53835a=dbConfig[_0xe43119(0x155)](_0xe43119(0xb9))[_0xe43119(0x19f)](_0xe43119(0xcf))[_0xe43119(0x222)]()||[];return _0x53835a[_0xe43119(0x210)](_0x439a6f=>{const _0x2c3945=_0xe43119;let _0x147ab6=getBotAttributes(_0x439a6f[_0x2c3945(0xcf)]);_0x439a6f[_0x2c3945(0xe4)]=_0x147ab6[_0x2c3945(0xe4)];}),_0x53835a;}function getBotExchanges(){const _0x370146=_0x4d318f;let _0x37019c=[];const _0x4e852e=dbConfig[_0x370146(0x155)]('bots')[_0x370146(0x19f)](_0x370146(0xcf))[_0x370146(0x222)]()||[];_0x4e852e[_0x370146(0x210)](_0x1f7bde=>{const _0x5add05=_0x370146;if(_0x1f7bde[_0x5add05(0xe5)]==_0x5add05(0x1ef)){const _0x290d50=configpath+'bot-'+_0x1f7bde['botID']+_0x5add05(0x125),_0x264eb6=fs[_0x5add05(0x241)](_0x290d50);let _0x2a1fca;if(_0x264eb6){const _0x52413f=fs[_0x5add05(0x123)](_0x290d50);try{const _0x1ecde0=JSON[_0x5add05(0x94)](_0x52413f);_0x2a1fca=_0x1ecde0?_0x1ecde0[_0x5add05(0x169)][0x0]['exchange']:null;}catch(_0xa3b174){}}if(_0x2a1fca)_0x37019c[_0x5add05(0xba)](_0x2a1fca);}});const _0x49d249=[...new Set(_0x37019c)]['sort']();return _0x49d249;}async function initUser(){const _0x4bb54d=_0x4d318f;if(!settings[_0x4bb54d(0x283)]){const _0x53fd67=uuidRandom();mixpanel[_0x4bb54d(0xd2)](_0x53fd67),updateSetting('userid',_0x53fd67);}}async function initSecure(){const _0x2d1893=_0x4d318f;let _0x1dfaa8=getSecure();if(!_0x1dfaa8['hasOwnProperty']('secret')){let _0x49895=await generateKeys();_0x1dfaa8[_0x2d1893(0x197)]=_0x49895[_0x2d1893(0x197)],_0x1dfaa8['privateKey']=_0x49895[_0x2d1893(0x217)],_0x1dfaa8[_0x2d1893(0x26a)]=crypto[_0x2d1893(0x17b)](0x20)[_0x2d1893(0xbf)](_0x2d1893(0x1e6));;storeSecure(_0x1dfaa8);}}function getSettings(){const _0x3948b5=_0x4d318f;return dbSettings[_0x3948b5(0x155)](_0x3948b5(0x12a))['value']()||{};}function getSecure(){const _0x8ad2fa=_0x4d318f;return dbSecure[_0x8ad2fa(0x155)](_0x8ad2fa(0x162))[_0x8ad2fa(0x222)]()||{};}function getBlacklist(){const _0x1e4252=_0x4d318f;return dbSecure[_0x1e4252(0x155)](_0x1e4252(0x1ab))[_0x1e4252(0x222)]()||[];}function broadcastToBots(_0x338be9,_0x1cd631){const _0x4b1e91=_0x4d318f;config[_0x4b1e91(0x210)](_0x244c0d=>{const _0x631f39=_0x4b1e91;if(_0x244c0d[_0x631f39(0xe5)]==_0x631f39(0x1ef)&&_0x244c0d['live']==_0x631f39(0xfc)||_0x244c0d[_0x631f39(0xe5)]==_0x631f39(0x17d)&&_0x244c0d[_0x631f39(0x1e4)]==_0x631f39(0xfc)){if(pid[_0x244c0d[_0x631f39(0xcf)]])pid[_0x244c0d[_0x631f39(0xcf)]][_0x631f39(0x139)]({[_0x338be9]:_0x1cd631});}});}function storeSettings(_0x102bd2,_0xf232e7=![]){const _0x5112f4=_0x4d318f;_0x102bd2={...settings,..._0x102bd2};if(_0xf232e7&&_0x102bd2[_0x5112f4(0x196)]!=_0x5112f4(0x113)&&_0x102bd2[_0x5112f4(0x196)]!=_0x5112f4(0x16b)&&_0x102bd2[_0x5112f4(0x196)]!=''){const _0x590ba1=crypt['decrypt'](secure[_0x5112f4(0x217)],_0x102bd2[_0x5112f4(0x196)])['message'][_0x5112f4(0x21c)]('@')[0x0],_0x5be431=bcrypt['hashSync'](_0x590ba1,saltRounds);_0x102bd2={..._0x102bd2,'bbPassword':_0x5be431};}if(_0xf232e7&&_0x102bd2[_0x5112f4(0xcb)]!='************'&&_0x102bd2[_0x5112f4(0xcb)]!=_0x5112f4(0x16b)&&_0x102bd2['telegramToken']!=''){const _0x534a2c=crypt[_0x5112f4(0x201)](secure[_0x5112f4(0x217)],_0x102bd2[_0x5112f4(0xcb)])['message'][_0x5112f4(0x21c)]('@')[0x0];_0x102bd2={..._0x102bd2,'telegramToken':_0x534a2c};}const _0x53de72=_0x102bd2[_0x5112f4(0xcb)]!=_0x5112f4(0x113)&&_0x102bd2[_0x5112f4(0xcb)]!=settings[_0x5112f4(0xcb)]||_0x102bd2[_0x5112f4(0xaa)]!=settings[_0x5112f4(0xaa)],_0x590748=_0x102bd2[_0x5112f4(0xaa)]!=settings[_0x5112f4(0xaa)],_0x2d50b3=_0x102bd2[_0x5112f4(0xcb)]==''||_0x102bd2[_0x5112f4(0xaa)]=='';_0x53de72&&(_0x102bd2['telegramEvents']='all');_0x590748&&(_0x102bd2[_0x5112f4(0x231)]=null);for(const [_0x48adb4,_0x5133b5]of Object[_0x5112f4(0x143)](_0x102bd2)){if(_0x48adb4==_0x5112f4(0xcb)&&_0x5133b5==_0x5112f4(0x113)){_0x102bd2[_0x5112f4(0xcb)]=settings[_0x5112f4(0xcb)];continue;};if(_0x48adb4==_0x5112f4(0x196)&&_0x5133b5==_0x5112f4(0x113)){_0x102bd2['bbPassword']=settings[_0x5112f4(0x196)];continue;};dbSettings[_0x5112f4(0x254)]('settings.'+_0x48adb4,_0x5133b5)['write']();}settings=_0x102bd2,io['to'](_0x5112f4(0x145))['emit'](_0x5112f4(0x12a),cleanSettings()),broadcastToBots(_0x5112f4(0xf1),settings['timeshift']),broadcastToBots('onepagemode',settings[_0x5112f4(0x1e7)]);if(_0x53de72&&!_0x2d50b3)initTelegram();if(_0x53de72&&_0x2d50b3)disableTelegram();getAllClients()[_0x5112f4(0x210)](_0x405828=>{const _0x3db7de=_0x5112f4;getSocket(_0x405828['id'])[_0x3db7de(0x1ad)](_0x3db7de(0xe5),{'access':{'allow':![],'reason':_0x3db7de(0x1bc),'token':null}});});}function updateSetting(_0x25bbed,_0x2fd3de){const _0x36bb96=_0x4d318f;dbSettings['set']('settings.'+_0x25bbed,_0x2fd3de)[_0x36bb96(0x136)](),settings=getSettings(),io['to'](_0x36bb96(0x145))['emit']('settings',cleanSettings());}function storeSecure(_0x48fa0f){const _0x2cf556=_0x4d318f;dbSecure[_0x2cf556(0x155)]('secure')[_0x2cf556(0xba)](_0x48fa0f)[_0x2cf556(0x136)](),secure=_0x48fa0f;}function addBlacklist(_0x2e81d9){const _0x42fa5c=_0x4d318f;cleanBlacklist();let _0x44281c;devices[_0x2e81d9][_0x42fa5c(0x205)]?_0x44281c=Math[_0x42fa5c(0x23e)](devices[_0x2e81d9]['telegramIpApproval'][_0x42fa5c(0x27b)],loginExpiry):_0x44281c=loginExpiry,dbSecure[_0x42fa5c(0x155)](_0x42fa5c(0x1ab))[_0x42fa5c(0xba)]({'expiry':new Date()[_0x42fa5c(0x184)]()+_0x44281c*0x3c*0x3e8,'token':devices[_0x2e81d9][_0x42fa5c(0x1ec)][_0x42fa5c(0xbc)]})[_0x42fa5c(0x136)](),blacklist=dbSecure[_0x42fa5c(0x155)](_0x42fa5c(0x1ab))[_0x42fa5c(0x222)]();}function cleanBlacklist(){const _0x3d3603=_0x4d318f;let _0x1d0896=dbSecure[_0x3d3603(0x155)](_0x3d3603(0x1ab))[_0x3d3603(0x164)]()[_0x3d3603(0x222)](),_0x3d29a3=new Date()['getTime']();_0x1d0896[_0x3d3603(0x210)](_0x171d95=>{const _0x353d48=_0x3d3603;_0x171d95[_0x353d48(0x27b)]<_0x3d29a3&&dbSecure[_0x353d48(0x155)](_0x353d48(0x1ab))['remove']({'expiry':_0x171d95[_0x353d48(0x27b)]})['write']();});}function initStates(){let _0x3bc542=getConfiguration();_0x3bc542['forEach'](_0x409cca=>{const _0x1cc85f=_0x1e48;_0x409cca[_0x1cc85f(0x1e4)]=_0x1cc85f(0x19d);}),storeConfiguration(_0x3bc542);}function onKeys(){const _0x2ae238=new RSA();return new Promise(_0x36756c=>{const _0xcf5b09=_0x1e48;_0x2ae238[_0xcf5b09(0xc1)]()[_0xcf5b09(0xa2)](_0x548f7e=>{_0x36756c(_0x548f7e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x56c553=_0x4d318f;let _0x338f9f=getSettings(),_0x4c03ba=![];!_0x338f9f[_0x56c553(0x13c)](_0x56c553(0x1d7))&&(_0x338f9f[_0x56c553(0x1d7)]=0x0,_0x4c03ba=!![]);!_0x338f9f[_0x56c553(0x13c)](_0x56c553(0x14a))&&(_0x338f9f[_0x56c553(0x14a)]=0x0,_0x4c03ba=!![]);!_0x338f9f[_0x56c553(0x13c)](_0x56c553(0x212))&&(_0x338f9f['latestversion']=_0x56c553(0x273),_0x4c03ba=!![]);!_0x338f9f[_0x56c553(0x13c)](_0x56c553(0x1e7))&&(_0x338f9f[_0x56c553(0x1e7)]=![],_0x4c03ba=!![]);if(_0x4c03ba)storeSettings(_0x338f9f);try{fs[_0x56c553(0x214)](configbackuppath,{'withFileTypes':!![]})[_0x56c553(0x210)](_0xa617a7=>{const _0xee382=_0x56c553;if(!_0xa617a7[_0xee382(0x105)]()){if(!_0xa617a7[_0xee382(0xd5)][_0xee382(0x11b)](_0xee382(0x1de)))fs[_0xee382(0x293)](configbackuppath+_0xa617a7[_0xee382(0xd5)]);}else fs[_0xee382(0x211)](configbackuppath+_0xa617a7[_0xee382(0xd5)],{'recursive':!![]});});}catch(_0xd8e839){logger[_0x56c553(0xec)](_0x56c553(0x25c),_0xd8e839);}}function storeConfiguration(_0x35b160){const _0x24fa94=_0x4d318f;dbConfig[_0x24fa94(0x155)]('bots')['remove']()[_0x24fa94(0x136)](),dbConfig[_0x24fa94(0x155)](_0x24fa94(0xb9))['push'](..._0x35b160)[_0x24fa94(0x136)](),config=_0x35b160;}function resetPassword(){const _0x22a9aa=_0x4d318f;if(tgBot&&settings[_0x22a9aa(0x231)]){const _0x57b5af=Markup['inlineKeyboard']([Markup[_0x22a9aa(0x1fc)]['callback']('yes',_0x22a9aa(0x18f)),Markup['button']['callback']('no',_0x22a9aa(0xbd))]);sendTelegram(settings[_0x22a9aa(0x231)],_0x22a9aa(0x106),_0x57b5af),tgBot[_0x22a9aa(0x1a7)](/resetpw_(.+)/,async _0x282bbc=>{const _0x5c9eb7=_0x22a9aa,_0x4de6d9=_0x282bbc[_0x5c9eb7(0xd8)][0x1];_0x282bbc['editMessageReplyMarkup']();if(_0x4de6d9!='no'){const _0x4f75b8=0xf,_0x439950=_0x5c9eb7(0x1c0),_0x42d437=Array[_0x5c9eb7(0x1ac)](crypto[_0x5c9eb7(0xb3)](new Uint32Array(_0x4f75b8)))[_0x5c9eb7(0x227)](_0x4b1816=>_0x439950[_0x4b1816%_0x439950['length']])[_0x5c9eb7(0xac)](''),_0x1b0e32=bcrypt[_0x5c9eb7(0x275)](_0x42d437,saltRounds);storeSettings({'bbPassword':_0x1b0e32}),await sendTelegram(_0x282bbc['chat']['id'],_0x5c9eb7(0x263)+_0x42d437,{'parse_mode':_0x5c9eb7(0x27e)});}else await sendTelegram(_0x282bbc[_0x5c9eb7(0x109)]['id'],_0x5c9eb7(0x15a));});}}async function confirmRestore(_0x2de36e,_0x2f7bbf){const _0xa1ba2c=_0x4d318f;io['to']('botmanager')[_0xa1ba2c(0x1ad)](_0xa1ba2c(0x25d),_0xa1ba2c(0xd6),_0xa1ba2c(0x26b));if(tgBot&&settings[_0xa1ba2c(0x231)]){const _0xf76c24=Markup[_0xa1ba2c(0x279)]([Markup[_0xa1ba2c(0x1fc)][_0xa1ba2c(0xe3)](_0xa1ba2c(0x248),_0xa1ba2c(0xe8)),Markup[_0xa1ba2c(0x1fc)]['callback']('no',_0xa1ba2c(0x1ce))]);sendTelegram(settings[_0xa1ba2c(0x231)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0xf76c24),tgBot['action'](/restore_(.+)/,async _0x25e22d=>{const _0x350b49=_0xa1ba2c,_0xa0e420=_0x25e22d[_0x350b49(0xd8)][0x1];_0x25e22d[_0x350b49(0x20b)](),_0xa0e420==_0x350b49(0x248)?(logger[_0x350b49(0xec)](_0x350b49(0x147)),await sendTelegram(_0x25e22d[_0x350b49(0x109)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x350b49(0x27e)}),unzipFile(_0x2de36e,_0x2f7bbf)):(logger[_0x350b49(0xec)](_0x350b49(0x132)),await sendTelegram(_0x25e22d[_0x350b49(0x109)]['id'],_0x350b49(0x132)));});}}function getServerTime(){const _0x241e87=_0x4d318f,_0x58707f=new Date();return _0x58707f['getFullYear']()+'/'+(_0x58707f[_0x241e87(0x215)]()+0x1)['toString']()[_0x241e87(0x235)](0x2,'0')+'/'+_0x58707f[_0x241e87(0xe0)]()[_0x241e87(0xbf)]()[_0x241e87(0x235)](0x2,'0')+'\x20'+_0x58707f[_0x241e87(0x25b)]()[_0x241e87(0xbf)]()[_0x241e87(0x235)](0x2,'0')+':'+_0x58707f[_0x241e87(0x1b0)]()['toString']()['padStart'](0x2,'0')+':'+_0x58707f[_0x241e87(0x10f)]()[_0x241e87(0xbf)]()[_0x241e87(0x235)](0x2,'0');}function getTimeStamp(){const _0x56c96f=_0x4d318f,_0x5a8953=shiftedTime();return _0x5a8953['getFullYear']()+'/'+(_0x5a8953[_0x56c96f(0x215)]()+0x1)[_0x56c96f(0xbf)]()[_0x56c96f(0x235)](0x2,'0')+'/'+_0x5a8953[_0x56c96f(0xe0)]()[_0x56c96f(0xbf)]()[_0x56c96f(0x235)](0x2,'0')+'\x20'+_0x5a8953[_0x56c96f(0x25b)]()[_0x56c96f(0xbf)]()['padStart'](0x2,'0')+':'+_0x5a8953[_0x56c96f(0x1b0)]()[_0x56c96f(0xbf)]()[_0x56c96f(0x235)](0x2,'0')+':'+_0x5a8953[_0x56c96f(0x10f)]()['toString']()[_0x56c96f(0x235)](0x2,'0');}function getCleanTimeStamp(){const _0x5551a5=_0x4d318f,_0x325566=shiftedTime();return _0x325566[_0x5551a5(0xe2)]()+(_0x325566[_0x5551a5(0x215)]()+0x1)[_0x5551a5(0xbf)]()[_0x5551a5(0x235)](0x2,'0')+_0x325566[_0x5551a5(0xe0)]()['toString']()[_0x5551a5(0x235)](0x2,'0')+'-'+_0x325566[_0x5551a5(0x25b)]()[_0x5551a5(0xbf)]()[_0x5551a5(0x235)](0x2,'0')+_0x325566['getMinutes']()[_0x5551a5(0xbf)]()['padStart'](0x2,'0')+_0x325566[_0x5551a5(0x10f)]()['toString']()[_0x5551a5(0x235)](0x2,'0');}function shiftedTime(){const _0x108be0=_0x4d318f,_0x25a372=new Date();let _0x40726c=_0x25a372;if(settings[_0x108be0(0xf1)]&&settings['timeshift']!==0x0)_0x40726c=fns['add'](_0x25a372,{'hours':settings[_0x108be0(0xf1)]});return _0x40726c;}function startScheduler(){const _0xb38476=_0x4d318f,_0x26eb7e=new Date()[_0xb38476(0x16a)](),_0x3c5dbb=shiftedTime()['getHours']();_0x3c5dbb==0x4&&backupConfigFiles();_0x3c5dbb==0x0&&rotateLogFiles();_0x26eb7e%0x6==0x0&&triggerAnalytics();_0x26eb7e%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x433415){const _0x2ebd1e=_0x4d318f;logger[_0x2ebd1e(0xec)](_0x2ebd1e(0xdb)+_0x433415);const _0x2e3569=getBotsWithMode();_0x2e3569[_0x2ebd1e(0x121)]>0x0?confirmRestore(configbackuppath,_0x433415):unzipFile(configbackuppath,_0x433415);}async function getBackupFiles(_0x291858=null){const _0x4b209c=_0x4d318f;let _0x2ce888=[],_0x420b8d=fs[_0x4b209c(0x214)](configbackuppath,{'withFileTypes':!![]});_0x420b8d['sort']((_0x3a10ee,_0x2ddf3d)=>_0x3a10ee['name']<_0x2ddf3d[_0x4b209c(0xd5)]?0x1:_0x2ddf3d[_0x4b209c(0xd5)]<_0x3a10ee['name']?-0x1:0x0),_0x420b8d[_0x4b209c(0x210)](_0x252e0f=>{const _0x3e514a=_0x4b209c;if(!_0x252e0f[_0x3e514a(0x105)]()&&_0x252e0f['name'][_0x3e514a(0x11b)](_0x3e514a(0x1de))&&_0x252e0f[_0x3e514a(0xd5)]['endsWith']('.zip')){const _0x2fe8a8=formatDate(fs[_0x3e514a(0x10c)](configbackuppath+_0x252e0f['name'])[_0x3e514a(0x173)]);_0x2ce888[_0x3e514a(0xba)]({'name':_0x252e0f[_0x3e514a(0xd5)],'mtime':_0x2fe8a8});}});if(_0x291858)io['to'](_0x291858)['emit'](_0x4b209c(0x1b9),_0x2ce888);else return _0x2ce888;}async function backupConfigFiles(){const _0x28d7de=_0x4d318f;await zipFiles('backup-full');const _0x581006=getCleanTimeStamp();fs[_0x28d7de(0x28b)](zippath+_0x28d7de(0x114),configbackuppath+(_0x28d7de(0x1de)+_0x581006+_0x28d7de(0x239)));let _0x314d83=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x314d83[_0x28d7de(0x13f)]((_0x569763,_0x446d32)=>_0x569763['name']<_0x446d32[_0x28d7de(0xd5)]?0x1:_0x446d32['name']<_0x569763[_0x28d7de(0xd5)]?-0x1:0x0),_0x314d83[_0x28d7de(0x121)]>maxBackups&&fs[_0x28d7de(0x293)](configbackuppath+_0x314d83[_0x314d83[_0x28d7de(0x121)]-0x1]['name']);}function rotateLogFiles(){const _0x30905c=_0x4d318f,_0x43d5c3=fs[_0x30905c(0x10c)](logspath+_0x30905c(0x208)),_0x151b80=_0x43d5c3['size']/0x400;if(_0x151b80>0x64){let _0x20019a=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x20019a[_0x30905c(0x13f)]((_0x512fe5,_0x5d01bc)=>_0x512fe5['name']<_0x5d01bc[_0x30905c(0xd5)]?0x1:_0x5d01bc[_0x30905c(0xd5)]<_0x512fe5[_0x30905c(0xd5)]?-0x1:0x0),_0x20019a[_0x30905c(0x210)](_0x1ee094=>{const _0x3def88=_0x30905c;if(_0x1ee094['name']==_0x3def88(0x154))fs[_0x3def88(0x28b)](logspath+_0x1ee094[_0x3def88(0xd5)],logspath+_0x3def88(0x27c));if(_0x1ee094['name']=='output-001.log')fs[_0x3def88(0x28b)](logspath+_0x1ee094[_0x3def88(0xd5)],logspath+_0x3def88(0x154));_0x1ee094['name']==_0x3def88(0x208)&&(fs['copyFileSync'](logspath+_0x1ee094[_0x3def88(0xd5)],logspath+_0x3def88(0x1d3)),fs[_0x3def88(0x185)](logspath+_0x1ee094['name'],''));});}}async function zipFiles(_0x12b0cf){const _0xf926d4=_0x4d318f;let _0x4515e0;if(_0x12b0cf==_0xf926d4(0xfd))_0x4515e0=logspath;if(_0x12b0cf=='backup')_0x4515e0=configpath;if(_0x12b0cf=='backup-full')_0x4515e0=configpath;let _0x556dd1=fs['readdirSync'](_0x4515e0,{'withFileTypes':!![]});const _0xc48fc7=new require(_0xf926d4(0xa6))();_0x556dd1[_0xf926d4(0x210)](_0x1d2655=>{const _0x4f96c8=_0xf926d4;if(!_0x1d2655[_0x4f96c8(0x105)]()){let _0x27b965=fs['readFileSync'](_0x4515e0+_0x1d2655[_0x4f96c8(0xd5)]);if(_0x12b0cf==_0x4f96c8(0x20d)){const _0x4f3365=/^bot-[0-9]{3}-config.json$/,_0x174e9e=_0x4f3365['test'](_0x1d2655[_0x4f96c8(0xd5)]);if(_0x174e9e){const _0x1afd81=JSON[_0x4f96c8(0x94)](_0x27b965);if(_0x1afd81[_0x4f96c8(0x169)][0x0]){_0x1afd81[_0x4f96c8(0x169)][0x0][_0x4f96c8(0xdf)]=_0x4f96c8(0x16b),_0x1afd81[_0x4f96c8(0x169)][0x0][_0x4f96c8(0x138)]=_0x4f96c8(0x16b);if(_0x1afd81[_0x4f96c8(0x169)][0x0]['apiPassword'])_0x1afd81[_0x4f96c8(0x169)][0x0][_0x4f96c8(0x191)]=_0x4f96c8(0x16b);}_0x27b965=JSON[_0x4f96c8(0x18d)](_0x1afd81,null,0x2);}if(_0x1d2655[_0x4f96c8(0xd5)]=='bb-settings.json'){const _0x549f59=JSON[_0x4f96c8(0x94)](_0x27b965);if(_0x549f59[_0x4f96c8(0x12a)][_0x4f96c8(0x110)])_0x549f59[_0x4f96c8(0x12a)]['loginRequired']=![];if(_0x549f59['settings'][_0x4f96c8(0x196)])_0x549f59[_0x4f96c8(0x12a)][_0x4f96c8(0x196)]='***';if(_0x549f59[_0x4f96c8(0x12a)][_0x4f96c8(0xcb)])_0x549f59['settings'][_0x4f96c8(0xcb)]='***';if(_0x549f59['settings']['telegramChatId'])_0x549f59[_0x4f96c8(0x12a)]['telegramChatId']=null;_0x27b965=JSON[_0x4f96c8(0x18d)](_0x549f59,null,0x2);}if(_0x1d2655[_0x4f96c8(0xd5)]!=_0x4f96c8(0x22e))_0xc48fc7[_0x4f96c8(0xf7)](_0x1d2655[_0x4f96c8(0xd5)],_0x27b965);}else _0xc48fc7['file'](_0x1d2655[_0x4f96c8(0xd5)],_0x27b965);}});const _0x3ac5af=_0xc48fc7['generate']({'base64':![],'compression':_0xf926d4(0x1af)});fs[_0xf926d4(0x185)](zippath+(_0x12b0cf+'.zip'),_0x3ac5af,_0xf926d4(0xef));}async function unzipFile(_0x400f93,_0x2ca24c){const _0x58317c=_0x4d318f;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x5ce373=>{const _0x5d4e34=_0x1e48;if(!_0x5ce373[_0x5d4e34(0x105)]())fs[_0x5d4e34(0x211)](configpath+_0x5ce373['name']);});const _0x10bce2=fs[_0x58317c(0x123)](_0x400f93+_0x2ca24c,_0x58317c(0xef)),_0x25bc08=new require(_0x58317c(0xa6))(_0x10bce2,{'base64':![],'checkCRC32':!![]});Object[_0x58317c(0x122)](_0x25bc08['files'])[_0x58317c(0x210)](_0x35dc8f=>{const _0x15dd24=_0x58317c,_0x137af5=_0x25bc08[_0x15dd24(0x15b)][_0x35dc8f];fs['writeFileSync'](configpath+_0x137af5[_0x15dd24(0xd5)],_0x137af5[_0x15dd24(0x116)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x58317c(0x210)](_0xd91df3=>{const _0x580981=_0x58317c;if(!_0xd91df3[_0x580981(0x105)]())fs[_0x580981(0x211)](temppath+_0xd91df3[_0x580981(0xd5)]);}),logger[_0x58317c(0xec)](_0x58317c(0x1f6)),process[_0x58317c(0x139)]({'restore':!![]},_0x1f503f=>{});}async function getPublicIp(){const _0x1c265c=_0x4d318f;try{const _0x447791=await axios[_0x1c265c(0x155)](_0x1c265c(0xad));publicip=_0x447791[_0x1c265c(0x250)]['ip'];}catch(_0x1f3131){}}async function triggerAnalytics(){const _0xc140f4=_0x4d318f;if(!publicip)await getPublicIp();const _0x44949c=getBotsWithMode();let _0x2fc4cc=0x0;_0x44949c[_0xc140f4(0x210)](_0x31f0ae=>{const _0x502c07=_0xc140f4;if(_0x31f0ae[_0x502c07(0xe5)]===_0x502c07(0x1ef))_0x2fc4cc++;});const _0x1787a1=getBotExchanges();mixpanel[_0xc140f4(0x269)](_0xc140f4(0x172),{'distinct_id':settings[_0xc140f4(0x283)],'ip':publicip,'version':serverversion,'numbots':_0x44949c['length'],'numbotsenabled':_0x2fc4cc,'exchanges':_0x1787a1,'environment':environment});}async function getMessages(){const _0x6028cd=_0x4d318f,_0x48c887='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x141645=new GraphQLClient(_0x48c887),_0x147156={'authorization':_0x6028cd(0x1a1)},_0x3a3172=serverversion[_0x6028cd(0x21c)]('.'),_0x799dab=_0x3a3172[0x0]+'.'+_0x3a3172[0x1],_0x542a7a=Math['min'](settings[_0x6028cd(0x1d7)],settings[_0x6028cd(0x14a)]),_0xfe71c5={'last':parseInt(_0x542a7a),'bbm':_0x799dab},_0x266a86=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3c356d;try{_0x3c356d=await _0x141645[_0x6028cd(0x9a)](_0x266a86,_0xfe71c5,_0x147156);}catch(_0x21a652){}if(_0x3c356d&&_0x3c356d[_0x6028cd(0xa9)]){let _0x3bb0b5=settings[_0x6028cd(0x1d7)];newMessages=[];for(const _0x5157f6 of _0x3c356d[_0x6028cd(0xa9)]){newMessages[_0x6028cd(0xba)](_0x5157f6);let _0x459c59=![];_0x5157f6['bbvNew']&&(updateSetting(_0x6028cd(0x212),_0x5157f6[_0x6028cd(0x141)]),_0x459c59=isNewerVersion(serverversion,_0x5157f6[_0x6028cd(0x141)])||serverversion==_0x5157f6[_0x6028cd(0x141)]);if(!_0x459c59&&_0x5157f6['number']>_0x3bb0b5){if(_0x5157f6['bbvReceive']===_0x6028cd(0x12c)||serverversion['startsWith'](_0x5157f6[_0x6028cd(0x137)])){let _0x1868b0=''+_0x5157f6[_0x6028cd(0x240)]+'\x0a\x0a'+_0x5157f6['message'];const _0x4be156=await sendTelegramMsg(toTelegramMarkdown(_0x1868b0),_0x6028cd(0x1b4));if(_0x4be156)_0x3bb0b5=_0x5157f6[_0x6028cd(0xb4)];}}}updateAvailable=isNewerVersion(settings[_0x6028cd(0x212)],serverversion),updateSetting('lastmsgtelegram',_0x3bb0b5),emitMessages();}}function emitMessages(){const _0x435132=_0x4d318f,_0x3ae35c=settings[_0x435132(0x14a)];let _0x48e91c=[];newMessages[_0x435132(0x210)](_0x15deca=>{const _0x3d2f79=_0x435132;_0x15deca['number']>_0x3ae35c&&_0x48e91c[_0x3d2f79(0xba)](_0x15deca);}),_0x48e91c[_0x435132(0x121)]>0x0&&getAllClients()[_0x435132(0x210)](_0x5e80e7=>{const _0x140acc=_0x435132;getSocket(_0x5e80e7['id'])[_0x140acc(0x1ad)](_0x140acc(0xa1),_0x48e91c);});}function confirmMessage(_0x7f7a88){const _0x5b476b=_0x4d318f;updateSetting(_0x5b476b(0x14a),Number(_0x7f7a88));}function isNewerVersion(_0xffc1f4,_0x591cdc){const _0x5435e8=_0x4d318f,_0x32ea54=_0x591cdc['split']('.'),_0x265029=_0xffc1f4[_0x5435e8(0x21c)]('.');for(var _0x1ff725=0x0;_0x1ff725<_0x265029[_0x5435e8(0x121)];_0x1ff725++){const _0x36f594=~~_0x265029[_0x1ff725],_0x4df0c0=~~_0x32ea54[_0x1ff725];if(_0x36f594>_0x4df0c0)return!![];if(_0x36f594<_0x4df0c0)return![];}return![];}function toTelegramMarkdown(_0x40fb75){const _0x3fee79=_0x4d318f,_0x4878fa=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3eefb5=/\*{2}(.+?)\*{2}/gim;return _0x40fb75=_0x40fb75[_0x3fee79(0x1aa)](_0x4878fa,_0x3fee79(0xa4))[_0x3fee79(0x1aa)](_0x3eefb5,_0x3fee79(0x266)),_0x40fb75;}async function validateConfigFile(){const _0x4a0ae9=_0x4d318f,_0x3809f2=dbConfig['get'](_0x4a0ae9(0xb9))[_0x4a0ae9(0x19f)](_0x4a0ae9(0xcf))[_0x4a0ae9(0x222)]()||[];if(_0x3809f2['length']==0x0){let _0x3d8f3b=0x0,_0x249683=[];const _0x5ccfe6=/^bot-([0-9]{3})-config.json$/,_0x9580d6=fs[_0x4a0ae9(0x214)](configpath);_0x9580d6[_0x4a0ae9(0x210)](_0x2ecbcd=>{const _0x4ff2fc=_0x4a0ae9,_0x55b02b=_0x5ccfe6[_0x4ff2fc(0x264)](_0x2ecbcd);if(_0x55b02b){const _0xca9a13=_0x55b02b[0x1];let _0xd078c=getBotAttributes(_0xca9a13);_0x249683[_0x4ff2fc(0xba)]({'botID':_0xca9a13,'botname':_0xd078c[_0x4ff2fc(0x18b)],'status':_0x4ff2fc(0x175),'live':_0x4ff2fc(0x19d)}),_0x3d8f3b++;}}),_0x3d8f3b!=0x0&&(dbConfig['get']('bots')[_0x4a0ae9(0x93)](_0x249683)[_0x4a0ae9(0x136)](),config=_0x249683,restoredConfigFile=_0x3d8f3b);}}async function restoreConfigNotify(_0x1e13c6){const _0x27b81a=_0x4d318f;let _0x3e6d80;if(restoredConfigFile==0x1)_0x3e6d80='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x3e6d80=_0x27b81a(0xf8);if(_0x1e13c6)io['to'](_0x27b81a(0x145))[_0x27b81a(0x1ad)]('notification',_0x3e6d80);else{logger['simple'](_0x27b81a(0x1d2)),logger[_0x27b81a(0xc5)](_0x3e6d80),logger['simple'](_0x27b81a(0x1d2)),logger[_0x27b81a(0xc5)]('');if(tgBot&&settings[_0x27b81a(0x231)]&&settings['telegramEvents']!='orders')sendTelegram(settings[_0x27b81a(0x231)],_0x27b81a(0xb7)+_0x3e6d80);}}function validateCredentials(_0x2d2a5c,_0x5ea642){const _0x5962d8=_0x4d318f;if(_0x2d2a5c[_0x5962d8(0x292)]==settings[_0x5962d8(0x96)]&&bcrypt['compareSync'](_0x2d2a5c[_0x5962d8(0x245)],settings[_0x5962d8(0x196)])){if(settings[_0x5962d8(0x291)])return{'allow':![],'reason':_0x5962d8(0x174),'token':null};else{const _0x5bd5a1=generateLoginToken(_0x5ea642);return{'allow':!![],'reason':_0x5962d8(0x17e),'token':_0x5bd5a1};}}else return{'allow':![],'reason':_0x5962d8(0x158),'token':null};}function refreshToken(_0x94a593){const _0x386e6c=_0x4d318f,_0x14b3a1=generateLoginToken(_0x94a593);return{'allow':!![],'reason':_0x386e6c(0x17e),'token':_0x14b3a1};}function validateAccess(_0x33ff04,_0x38e9b6,_0x2670ba){const _0x18908b=_0x4d318f,_0x35a8bd=_0x2670ba?_0x2670ba:devices[_0x38e9b6]['ip'];let _0x22763f;const _0x5c49a6=_0x55c4aa=>{const _0x4dd091=_0x1e48;if(settings[_0x4dd091(0x110)]){if(settings[_0x4dd091(0x291)]){if(telegram2FaApproved(_0x38e9b6)){const _0x393c46=generateLoginToken(_0x38e9b6);return{'allow':!![],'reason':_0x4dd091(0x134),'token':_0x393c46};}else return{'allow':![],'reason':_0x4dd091(0x271),'token':null};}else return _0x22763f=validToken(_0x55c4aa,_0x38e9b6),_0x22763f['hasOwnProperty'](_0x4dd091(0x26b))?{'allow':!![],'reason':_0x4dd091(0xf3),'token':_0x55c4aa}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x18908b(0xff)]){let _0x3c7a38=[...settings[_0x18908b(0x9c)],_0x18908b(0x218),_0x18908b(0x129),_0x18908b(0x1e8)];if(_0x3c7a38[_0x18908b(0x101)](_0x35a8bd))return _0x5c49a6(_0x33ff04);else{_0x22763f=validToken(_0x33ff04,_0x38e9b6);if(_0x22763f[_0x18908b(0x13c)](_0x18908b(0x26b)))return _0x5c49a6(_0x33ff04);else{if(telegramIpApproved(_0x38e9b6)){const _0x25ce77=generateToken(_0x38e9b6);return _0x22763f=_0x5c49a6(_0x33ff04),_0x22763f['allow']?{'allow':!![],'reason':_0x18908b(0xb2),'token':_0x25ce77}:_0x22763f;}else return settings[_0x18908b(0x188)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5c49a6(_0x33ff04);}function timelyDecrypt(_0x2dad0c,_0xe15e9e=!![]){const _0x1224f3=_0x4d318f;if(_0x2dad0c)try{const _0xdf1e0e=crypt[_0x1224f3(0x201)](secure[_0x1224f3(0x217)],_0x2dad0c)[_0x1224f3(0xa1)],_0x2ce460=_0xdf1e0e['split']('@')[0x0],_0xdd99fe=_0xdf1e0e[_0x1224f3(0x21c)]('@')[0x1],_0x466ea7=new Date()[_0x1224f3(0x184)]();if(_0xe15e9e){if(_0x466ea7-_0xdd99fe<maxSecretAge*0x3e8)return _0x2ce460;else return![];}else return _0x2ce460;}catch(_0x55bc8b){return![];}else return![];}const validToken=(_0x38b8fa,_0xd307c8)=>{const _0x55b92c=_0x4d318f,_0x2541bf=devices[_0xd307c8]['ip'];if(!_0x38b8fa)return{'error':_0x55b92c(0x1e0)};for(let _0x2646bd of blacklist){if(_0x2646bd[_0x55b92c(0xbc)]==_0x38b8fa)return{'error':'Token\x20blacklisted'};}let _0x15a8ae;try{_0x15a8ae=jwt[_0x55b92c(0x20f)](_0x38b8fa,secure[_0x55b92c(0x26a)]+_0xd307c8);}catch{return{'error':_0x55b92c(0x14d)};}if(!_0x15a8ae['hasOwnProperty'](_0x55b92c(0x258))&&!_0x15a8ae[_0x55b92c(0x13c)](_0x55b92c(0x292))||!_0x15a8ae[_0x55b92c(0x13c)]('exp'))return{'error':_0x55b92c(0x224)};if(!_0x15a8ae['hasOwnProperty']('username')&&_0x15a8ae[_0x55b92c(0x13c)](_0x55b92c(0x258))){const {clientip:_0xcaf9d3}=_0x15a8ae;return _0x2541bf==_0xcaf9d3?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x15a8ae['hasOwnProperty'](_0x55b92c(0x292))&&_0x15a8ae['hasOwnProperty']('clientip')){const {username:_0x242e96,clientip:_0x2520c5}=_0x15a8ae;return settings[_0x55b92c(0x96)]==_0x242e96&&_0x2541bf==_0x2520c5?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x55b92c(0x229)};}}},generateLoginToken=_0xd4a0ac=>{const _0x48f665=_0x4d318f;if(_0xd4a0ac){const _0x1e5a24=devices[_0xd4a0ac]['ip'];return jwt['sign']({'username':settings[_0x48f665(0x96)],'clientip':_0x1e5a24},secure[_0x48f665(0x26a)]+_0xd4a0ac,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x170491=>{const _0xdaeb34=_0x4d318f;if(_0x170491){const _0x40b6c8=devices[_0x170491]['ip'];return jwt[_0xdaeb34(0x20e)]({'clientip':_0x40b6c8},secure['secret']+_0x170491,{'expiresIn':devices[_0x170491][_0xdaeb34(0x205)][_0xdaeb34(0x27b)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x16273e=>{const _0xab5cb6=_0x4d318f;let _0x56c701=![];return devices[_0x16273e][_0xab5cb6(0x205)]&&devices[_0x16273e][_0xab5cb6(0x205)][_0xab5cb6(0x27b)]!=_0xab5cb6(0x1e5)&&(_0x56c701=devices[_0x16273e][_0xab5cb6(0x205)]['clientip']==devices[_0x16273e]['ip']&&new Date()['getTime']()-devices[_0x16273e]['telegramIpApproval'][_0xab5cb6(0x13e)]<devices[_0x16273e][_0xab5cb6(0x205)]['expiry']*0x3c*0x3e8),_0x56c701;},telegram2FaApproved=_0x508911=>{const _0xa13b52=_0x4d318f;let _0x584eec=![];return devices[_0x508911][_0xa13b52(0xdc)]&&devices[_0x508911][_0xa13b52(0xdc)][_0xa13b52(0x27b)]!=_0xa13b52(0x1e5)&&(_0x584eec=devices[_0x508911]['telegram2FaApproval'][_0xa13b52(0x258)]==devices[_0x508911]['ip']&&new Date()[_0xa13b52(0x184)]()-devices[_0x508911][_0xa13b52(0xdc)][_0xa13b52(0x13e)]<devices[_0x508911][_0xa13b52(0xdc)][_0xa13b52(0x27b)]*0x3c*0x3e8),_0x584eec;},normalizeIP=_0x41bb9b=>{const _0x18f31a=_0x4d318f;let _0x144273=null,_0x4574aa=null;if(ipaddr['isValid'](_0x41bb9b)){const _0x119c65=ipaddr[_0x18f31a(0x94)](_0x41bb9b);_0x119c65[_0x18f31a(0x1ff)]()===_0x18f31a(0xf5)?(_0x119c65['isIPv4MappedAddress']()&&(_0x144273=_0x119c65['toIPv4Address']()[_0x18f31a(0xbf)]()),_0x4574aa=_0x119c65[_0x18f31a(0xbf)]()):(_0x144273=_0x119c65[_0x18f31a(0xbf)](),_0x4574aa=_0x119c65[_0x18f31a(0xfb)]()['toString']());}return{'show':_0x144273?_0x144273:_0x4574aa,'store':_0x4574aa};};function formatDate(_0x38d1b5){const _0x305d41=_0x4d318f;return _0x38d1b5[_0x305d41(0xe2)]()+'/'+(_0x38d1b5[_0x305d41(0x215)]()+0x1)[_0x305d41(0xbf)]()[_0x305d41(0x235)](0x2,'0')+'/'+_0x38d1b5[_0x305d41(0xe0)]()[_0x305d41(0xbf)]()[_0x305d41(0x235)](0x2,'0')+'\x20'+_0x38d1b5[_0x305d41(0x25b)]()['toString']()[_0x305d41(0x235)](0x2,'0')+':'+_0x38d1b5[_0x305d41(0x1b0)]()[_0x305d41(0xbf)]()[_0x305d41(0x235)](0x2,'0')+':'+_0x38d1b5[_0x305d41(0x10f)]()[_0x305d41(0xbf)]()[_0x305d41(0x235)](0x2,'0');}function sleep(_0x1f3910){return new Promise(_0xc67adf=>setTimeout(_0xc67adf,_0x1f3910));}