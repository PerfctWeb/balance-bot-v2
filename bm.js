const _0x4b2d52=_0x3fc6;function _0x3fc6(_0x2d3830,_0x5ba905){const _0x5202a3=_0x58d0();return _0x3fc6=function(_0x4c73f2,_0x2619e8){_0x4c73f2=_0x4c73f2-0xba;let _0x58d07c=_0x5202a3[_0x4c73f2];return _0x58d07c;},_0x3fc6(_0x2d3830,_0x5ba905);}(function(_0x272ed4,_0x39cf5c){const _0x111ed8=_0x3fc6,_0x19d8f8=_0x272ed4();while(!![]){try{const _0x1464d1=parseInt(_0x111ed8(0xfb))/0x1+-parseInt(_0x111ed8(0x1c0))/0x2+-parseInt(_0x111ed8(0xba))/0x3*(parseInt(_0x111ed8(0xdd))/0x4)+parseInt(_0x111ed8(0x126))/0x5+-parseInt(_0x111ed8(0x1dc))/0x6*(parseInt(_0x111ed8(0xbb))/0x7)+-parseInt(_0x111ed8(0x13d))/0x8*(-parseInt(_0x111ed8(0x113))/0x9)+parseInt(_0x111ed8(0x1e8))/0xa;if(_0x1464d1===_0x39cf5c)break;else _0x19d8f8['push'](_0x19d8f8['shift']());}catch(_0x479b7d){_0x19d8f8['push'](_0x19d8f8['shift']());}}}(_0x58d0,0xec1ad));const _0x2619e8=function(){let _0x546420=!![];return function(_0x45155e,_0xf23f71){const _0x36560d=_0x546420?function(){const _0x21fc39=_0x3fc6;if(_0xf23f71){const _0x1e5d16=_0xf23f71[_0x21fc39(0x15d)](_0x45155e,arguments);return _0xf23f71=null,_0x1e5d16;}}:function(){};return _0x546420=![],_0x36560d;};}(),_0x4c73f2=_0x2619e8(this,function(){const _0x4f1087=_0x3fc6;return _0x4c73f2[_0x4f1087(0x130)]()[_0x4f1087(0x1bc)](_0x4f1087(0x1cf))[_0x4f1087(0x130)]()[_0x4f1087(0x1c6)](_0x4c73f2)[_0x4f1087(0x1bc)](_0x4f1087(0x1cf));});_0x4c73f2();'use strict';process[_0x4b2d52(0x181)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x4b2d52(0x1ac)),FileSync=require(_0x4b2d52(0x144)),fs=require('fs'),fns=require(_0x4b2d52(0x16f)),low=require(_0x4b2d52(0x1e7)),path=require(_0x4b2d52(0xd6)),crypto=require(_0x4b2d52(0x1c1)),Crypt=require(_0x4b2d52(0x18d))[_0x4b2d52(0x1b2)],RSA=require(_0x4b2d52(0x18d))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x4b2d52(0x1cc)),analyticsLib=require('analytics')[_0x4b2d52(0x16b)],googleAnalytics=require(_0x4b2d52(0x1ba))[_0x4b2d52(0x16b)],ipaddr=require(_0x4b2d52(0x11c)),argv=require(_0x4b2d52(0x137))(process[_0x4b2d52(0x176)][_0x4b2d52(0x19e)](0x2))[_0x4b2d52(0x176)],PORT=argv[_0x4b2d52(0x1e6)]||'3000',pattern=/^[0-9]{2,4}$/;if(!pattern[_0x4b2d52(0x1f5)](PORT))return console['log'](_0x4b2d52(0x13e)+PORT+_0x4b2d52(0x184)),process[_0x4b2d52(0xca)](0x1);const HOST=argv['host']||null,userID=argv[_0x4b2d52(0x1f7)]||'';let bbpath=_0x4b2d52(0x14f),bbpath2='';const botfile=_0x4b2d52(0x14c),configfile='bb-config.json',settingsfile=_0x4b2d52(0x153),securefile=_0x4b2d52(0x1f4),validInstallation=fs[_0x4b2d52(0x183)]('../install.js');!fs[_0x4b2d52(0x183)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4b2d52(0x154)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/';!fs[_0x4b2d52(0x183)](configpath)&&fs[_0x4b2d52(0x12f)](configpath);!fs[_0x4b2d52(0x183)](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4b2d52(0x106)]({'bots':[]})['write']();function _0x58d0(){const _0x424c10=['add','stopPolling','2FA\x20login\x20token\x20generated','path','All\x20bots\x20running\x20right\x20now','getMonth','2FA\x20login\x20required','isDirectory','randomBytes','disabled\x20Bot\x20','1823476PzpgqG','from','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','login\x20not\x20required','reload','idling\x20bot\x20\x20\x20|\x20Bot\x20','allow','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','storeConfiguration','enabled\x20Bot\x20','enabled','getPortfolio','new','Notifications\x20types:\x20','randomFillSync','message','Login\x20rejected','success','handshake','sockets','static','/:bot/performance','remove','delete-bot','settings','login','Invalid\x20IP\x20address','map','clientip','15\x20min','1870207nfikRh','Ok,\x20will\x20send\x20order\x20notifications\x20only','disconnect','storeHeadless','starting\x20new\x20bot\x20|\x20Bot\x20','notification','token','send','copyFileSync','event','cancel-loading','defaults','args','telegram','padStart','getMinutes','forEach','answerCallbackQuery','Bot\x20','Bot\x20Mgr\x20>\x20','status','Invalid\x20authentication\x20token\x20(1)','blacklist','use','8838fTTzJJ','getDate','removeListener','initclient','conn','SIGTERM','place-order','telegramToken','telegram2FaApproval','ipaddr.js','</b>\x20?','exp','restart','Notifications\x20disabled','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/disable\x20-\x20disable\x20notifications\x0a','password','inherit','2849480XTcUYb','logout','login\x20required','loginRequired','f2aRequired','getStartingBalances','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','bot','store-settings','mkdirSync','toString','botmanager','get','sendMessage','whitelist','showname','split','yargs/yargs','cancelLoading','telegramIpApproval','then','Unauthorized\x20attempt\x20to\x20get\x20logs','bot-','13664CzJArn','Error:\x20Invalid\x20argument\x20','kill','started','Notifications\x20enabled\x0a','compareSync','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','lowdb/adapters/FileSync','set',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','hasOwnProperty','createServer','version','getHours','yes','bot.js','store-headless','stop','bb/','restarting\x20Bot\x20','Temporary\x20access\x20rejected','all','bb-settings.json','clients','cloneDeep','<b>Telegram\x20bot\x20status:</b>\x0a','whitelistEnabled','error','disabled','write','Invalid\x20Telegram\x20token','find','apply','-----------------------------------------------------------------------------------','build2','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','stopped','sendFile','Unauthorized\x20attempt\x20to\x20delete\x20bot','connection','publicKey','Orders','bbUsername','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','-results.json','toIPv4MappedAddress','default','onText','isIPv4MappedAddress','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','date-fns','Unauthorized\x20attempt\x20to\x20update\x20bot','get-portfolio','Invalid\x20username\x20or\x20IP\x20address','/:bot/support','telegramEvents','Unauthorized\x20attempt\x20to\x20get\x20portfolio','argv','No\x20bots\x20running\x20right\x20now','isValid','assign','sortBy','telegramEnabled','Unauthorized\x20attempt\x20to\x20update\x20settings','orders','pidRefreshToken','update-bb','secure','env','bbPassword','existsSync',',\x20must\x20be\x20a\x204\x20digit\x20number','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','type','/off\x20-\x20stop\x20bot(s)\x0a','getUTCHours','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','temporaryAccessAllowed','telegramChatId','2FA\x20required','hybrid-crypto-js','new-disabled','404\x20Not\x20Found','::1','toIPv4Address','secret','-events.json','invalid\x20credentials','************','fork','botname','kind','delete-alerts','UA-192771731-1','ipv6','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','https://hodlerhacks.com','slice','keys','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Ok,\x20will\x20send\x20alert\x20notifications\x20only','entries','reason','order','data','All','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Allow\x20login\x20from\x20IP\x20address\x20<b>','5\x20min','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','store','child_process','join','running','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','log','index.html','Crypt','Balance\x20Bot','\x20|\x20','hashSync','Password\x20has\x20been\x20reset\x20to:\x20','starting\x20bot\x20|\x20Bot\x20','Balance\x20Bot\x20Server','length','@analytics/google-analytics','once','search','Password\x20reset\x20rejected','botID','bots','2533250VOtSmg','crypto','sign','login\x20token\x20generated','live','ipc','constructor','getTime','chat','reject','/on\x20-\x20start\x20bot(s)\x0a','logged\x20out','jsonwebtoken','sha256','HTML','(((.+)+)+)+$','privateKey','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','temporary\x20token\x20generated','/help\x20-\x20show\x20available\x20commands\x0a','includes','User\x20has\x20been\x20validated','accept','2FA\x20login\x20rejected','Notifications\x20enabled','expiry','getFullYear','function','3880734jxtBta','decrypt','placeOrder','/:bot/configuration','access','Unauthorized\x20attempt\x20to\x20log\x20out','callback_query','::ffff:127.0.0.1','All\x20bots','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','port','lowdb','1307470LPgPwS','catch','/restart\x20-\x20restart\x20bot(s)\x0a','temporary\x20access\x20rejected','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','unlinkSync','deleteHistoryAlerts','encryptedUuid','temporary\x20access\x20timeout','match','listen','\x20only\x0a','bb-secure.json','test','username','user','server','uuid','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/status\x20-\x20show\x20bot(s)\x20status\x0a','pidExpireLogin','readdirSync','/enable\x20-\x20enable\x20notifications\x0a','telegramUsername','value','Login\x20accepted','verify','Invalid\x20authentication\x20token\x20(2)','settings.','apiKey','9ZpPBfo','7zOwSiK','push','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','build','error\x20while\x20deleting\x20config\x20files:\x20','Access\x20enabled\x20for\x20','name','emit','\x20>\x20','hex','timeshift','timestamp','Notifications\x20disabled\x0a','add-bot','getSeconds','exit','alerts','filter','reset-password','Token\x20blacklisted','show','get-starting-balances','-config.json','-performance.json'];_0x58d0=function(){return _0x424c10;};return _0x58d0();}const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4b2d52(0x106)]({'settings':{'timeshift':0x0}})[_0x4b2d52(0x15a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4b2d52(0x106)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x4b2d52(0x1cd),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x4b2d52(0x149)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require('http')[_0x4b2d52(0x148)](app);app[_0x4b2d52(0x112)](express[_0x4b2d52(0xf1)](path[_0x4b2d52(0x1ad)](__dirname,bbpath2,'build2'))),app[_0x4b2d52(0x112)](express[_0x4b2d52(0xf1)](path['join'](__dirname,bbpath2,_0x4b2d52(0xbe)))),app['get']('/',function(_0x37fb4a,_0x215e34){const _0x5786de=_0x4b2d52;_0x215e34[_0x5786de(0x162)](path[_0x5786de(0x1ad)](__dirname,bbpath2,_0x5786de(0x15f),'index.html'));}),app[_0x4b2d52(0x132)]('/:bot',function(_0x13fac8,_0x2e3cff){const _0x554555=_0x4b2d52;_0x2e3cff[_0x554555(0x162)](path['join'](__dirname,bbpath2,'build',_0x554555(0x1b1)));}),app[_0x4b2d52(0x132)]('/:bot/portfolio',(_0x4964bd,_0x4a351a)=>{const _0x1dc6fe=_0x4b2d52;_0x4a351a[_0x1dc6fe(0x162)](path[_0x1dc6fe(0x1ad)](__dirname,bbpath2,'build',_0x1dc6fe(0x1b1)));}),app[_0x4b2d52(0x132)](_0x4b2d52(0xf2),(_0x58c8bc,_0x4b95ae)=>{const _0x311063=_0x4b2d52;_0x4b95ae['sendFile'](path['join'](__dirname,bbpath2,_0x311063(0xbe),_0x311063(0x1b1)));}),app[_0x4b2d52(0x132)]('/:bot/coins',(_0x1ad93,_0x2e4184)=>{const _0x439299=_0x4b2d52;_0x2e4184[_0x439299(0x162)](path[_0x439299(0x1ad)](__dirname,bbpath2,_0x439299(0xbe),_0x439299(0x1b1)));}),app[_0x4b2d52(0x132)]('/:bot/history',(_0x4eba3f,_0xe5111d)=>{const _0x262f6a=_0x4b2d52;_0xe5111d[_0x262f6a(0x162)](path['join'](__dirname,bbpath2,_0x262f6a(0xbe),_0x262f6a(0x1b1)));}),app[_0x4b2d52(0x132)](_0x4b2d52(0x1df),(_0x3d5092,_0x1cf909)=>{const _0x3c9393=_0x4b2d52;_0x1cf909['sendFile'](path['join'](__dirname,bbpath2,_0x3c9393(0xbe),_0x3c9393(0x1b1)));}),app['get'](_0x4b2d52(0x173),(_0x7e95e,_0x11b813)=>{const _0x1fb96d=_0x4b2d52;_0x11b813[_0x1fb96d(0x162)](path[_0x1fb96d(0x1ad)](__dirname,bbpath2,_0x1fb96d(0xbe),'index.html'));});if(HOST)http[_0x4b2d52(0x1f2)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x4b2d52(0x1b3),'plugins':[googleAnalytics({'trackingId':_0x4b2d52(0x19a)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x4b2d52(0x11a)]&&settings['telegramToken']!=''&&settings[_0x4b2d52(0x1ff)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x4dee85=_0x4b2d52;console[_0x4dee85(0x1b0)](''),console[_0x4dee85(0x1b0)](_0x4dee85(0x15e)),logging(_0x4dee85(0x1ec)+PORT),console[_0x4dee85(0x1b0)](_0x4dee85(0x15e));if(config[_0x4dee85(0x1b9)]!=0x0)config[_0x4dee85(0x10b)](_0x25761a=>{const _0x3486f1=_0x4dee85;if(_0x25761a[_0x3486f1(0x10f)]==_0x3486f1(0xe7)||_0x25761a[_0x3486f1(0x10f)]==_0x3486f1(0xe9))logging(_0x3486f1(0x1b7)+_0x25761a[_0x3486f1(0x1be)]+'\x20|\x20'+_0x25761a[_0x3486f1(0x197)]),startBot([_0x25761a[_0x3486f1(0x1be)],userID],{'cwd':bbpath},function(_0x570cd9){if(_0x570cd9)logging(_0x570cd9);});else(_0x25761a[_0x3486f1(0x10f)]=='disabled'||_0x25761a[_0x3486f1(0x10f)]==_0x3486f1(0x18e))&&logging(_0x3486f1(0xe2)+_0x25761a[_0x3486f1(0x1be)]+_0x3486f1(0x1b4)+_0x25761a[_0x3486f1(0x197)]);});else!newBot&&console[_0x4dee85(0x1b0)](_0x4dee85(0x1e5));if(newBot)addBot();console[_0x4dee85(0x1b0)](_0x4dee85(0x15e)),console[_0x4dee85(0x1b0)]('');}function startSocket(){const _0x4ef0da=_0x4b2d52;io['on'](_0x4ef0da(0x164),_0x1d7de0=>{const _0x47531d=_0x4ef0da;let _0x1c211a,_0x403691,_0x4c8971,_0xf492f6,_0xce7e87;const _0x33889e=_0x1d7de0['handshake']['headers']['referer'];_0x403691=_0x33889e[_0x47531d(0x1f1)](/bot[0-9]{3}/);if(_0x403691)_0x4c8971=_0x403691[0x0][_0x47531d(0x1f1)](/[0-9]{3}/);if(_0x4c8971)_0x1c211a=_0x4c8971[0x0];else _0x1c211a=_0x47531d(0x131);const _0x5737f9=_0x1d7de0[_0x47531d(0xef)]['auth'][_0x47531d(0x1ef)];if(!_0x5737f9)_0x1d7de0[_0x47531d(0xc2)]('status',{'publicKey':secure['publicKey']});else{_0xf492f6=timelyDecrypt(_0x5737f9,![]);if(!_0xf492f6)_0x1d7de0[_0x47531d(0xc2)]('status',{'publicKey':secure[_0x47531d(0x165)]});else{_0xce7e87=normalizeIP(_0x1d7de0[_0x47531d(0x117)]['remoteAddress'])[_0x47531d(0x1ab)];if(!devices[_0xf492f6])devices[_0xf492f6]={'uuid':_0xf492f6,'access':{'token':null}};devices[_0xf492f6]['ip']=_0xce7e87;const _0x28cde8=addClient(_0x1d7de0['id'],_0xf492f6,_0x1c211a);setAccess(_0x28cde8),_0x1d7de0['on'](_0x47531d(0xf6),_0x27b98d=>{const _0x320cf6=_0x47531d,_0x517674=timelyDecrypt(_0x27b98d['password']);if(_0x517674){_0x27b98d={'username':_0x27b98d[_0x320cf6(0x1f6)],'password':_0x517674},devices[_0xf492f6]['access']=validateCredentials(_0x27b98d,_0xf492f6);if(devices[_0xf492f6][_0x320cf6(0x1e0)]['allow']==![]&&devices[_0xf492f6][_0x320cf6(0x1e0)][_0x320cf6(0x1a3)]==_0x320cf6(0xd9))_0x1d7de0['emit'](_0x320cf6(0x10f),{'access':devices[_0xf492f6][_0x320cf6(0x1e0)]}),loginAccess2FA(_0xf492f6,_0xce7e87);else{if(devices[_0xf492f6][_0x320cf6(0x1e0)][_0x320cf6(0xe3)]==![]&&devices[_0xf492f6][_0x320cf6(0x1e0)]['reason']=='invalid\x20credentials')_0x1d7de0['emit'](_0x320cf6(0x10f),{'access':devices[_0xf492f6][_0x320cf6(0x1e0)]});else devices[_0xf492f6][_0x320cf6(0x1e0)][_0x320cf6(0xe3)]&&devices[_0xf492f6]['access']['reason']==_0x320cf6(0x1c3)&&(getClientsWithUuid(_0xf492f6)['forEach'](_0x44090d=>{setAccess(_0x44090d);}),setTokenRefresh(_0xf492f6),setSessionTimeout('login',_0xf492f6));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x1d7de0['on'](_0x47531d(0xcd),()=>{resetPassword();}),_0x1d7de0['on'](_0x47531d(0xfd),_0x32e91a=>{removeClient(_0x1d7de0['id']);});}}});}function initClient(_0x15d3f5){const _0x5ef41e=_0x4b2d52;if(_0x15d3f5!=_0x5ef41e(0x131)&&config[_0x5ef41e(0x205)]!=''){if(pid[_0x15d3f5])pid[_0x15d3f5][_0x5ef41e(0x102)]({'function':_0x5ef41e(0x116),'args':null});}}function getSocket(_0x2ce29b){const _0x5c6853=_0x4b2d52;return io[_0x5c6853(0xf0)][_0x5c6853(0xf0)][_0x5c6853(0x132)](_0x2ce29b);}function setAccess(_0x47e83d){const _0x541d07=_0x4b2d52,_0x4b5d0e=getSocket(_0x47e83d['id']),_0x285982=_0x47e83d[_0x541d07(0x1f9)],_0x547def=_0x47e83d[_0x541d07(0x12d)];devices[_0x285982][_0x541d07(0x1e0)]=validateAccess(devices[_0x285982][_0x541d07(0x1e0)][_0x541d07(0x101)],_0x285982),_0x4b5d0e['join'](_0x285982);if(devices[_0x285982]['access'][_0x541d07(0xe3)]){_0x4b5d0e['join'](_0x547def);if(_0x547def=='botmanager')initializeSocketBotManager(_0x4b5d0e);else initializeSocketBot(_0x4b5d0e);initClient(_0x547def);}devices[_0x285982][_0x541d07(0x1e0)][_0x541d07(0x101)]&&devices[_0x285982][_0x541d07(0x1e0)][_0x541d07(0x1a3)]==_0x541d07(0x1d2)&&setSessionTimeout('2FA',_0x285982),devices[_0x285982][_0x541d07(0x1e0)][_0x541d07(0x101)]&&devices[_0x285982][_0x541d07(0x1e0)][_0x541d07(0x1a3)]==_0x541d07(0xd5)&&setSessionTimeout(_0x541d07(0xf6),_0x285982),_0x4b5d0e[_0x541d07(0xc2)](_0x541d07(0x10f),{'status':_0x47e83d[_0x541d07(0x1f8)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x285982][_0x541d07(0x1e0)],'externalip':devices[_0x285982]['ip'],'publicKey':secure[_0x541d07(0x165)],'validInstallation':validInstallation}),devices[_0x285982][_0x541d07(0x1e0)][_0x541d07(0xe3)]==![]&&devices[_0x285982][_0x541d07(0x1e0)]['reason']==_0x541d07(0x18c)&&temporaryAccess2FA(_0x285982,devices[_0x285982]['ip']);}function setSessionTimeout(_0x3c4d8a,_0x275f4f){const _0x3fa2d6=_0x4b2d52;let _0x102708;if(_0x3c4d8a==_0x3fa2d6(0xf6))_0x102708=loginExpiry*0x3c*0x3e8;else _0x102708=devices[_0x275f4f][_0x3fa2d6(0x139)]['expiry']*0x3c*0x3e8-(new Date()[_0x3fa2d6(0x1c7)]()-devices[_0x275f4f][_0x3fa2d6(0x139)][_0x3fa2d6(0xc6)]);if(devices[_0x275f4f]['pidExpireLogin'])clearTimeout(devices[_0x275f4f][_0x3fa2d6(0x1fc)]);devices[_0x275f4f][_0x3fa2d6(0x1fc)]=setTimeout(()=>{const _0x5124c3=_0x3fa2d6;if(devices[_0x275f4f][_0x5124c3(0x17e)])clearTimeout(devices[_0x275f4f][_0x5124c3(0x17e)]);removeSocketListeners(_0x275f4f),addBlacklist(_0x275f4f),devices[_0x275f4f]['telegramIpApproval']=null,devices[_0x275f4f]['telegram2FaApproval']=null,devices[_0x275f4f][_0x5124c3(0x1e0)][_0x5124c3(0x101)]=null,devices[_0x275f4f][_0x5124c3(0x1e0)]=validateAccess(devices[_0x275f4f][_0x5124c3(0x1e0)][_0x5124c3(0x101)],_0x275f4f),!(devices[_0x275f4f]['access']['allow']&&devices[_0x275f4f][_0x5124c3(0x1e0)][_0x5124c3(0x1a3)]==_0x5124c3(0xe0))&&(_0x3c4d8a==_0x5124c3(0xf6)?io['to'](_0x275f4f)[_0x5124c3(0xc2)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x275f4f)[_0x5124c3(0xc2)](_0x5124c3(0x10f),{'access':{'allow':![],'reason':_0x5124c3(0x1f0),'token':null}})),devices[_0x275f4f][_0x5124c3(0x1e0)]['token']=null;},_0x102708);}function setTokenRefresh(_0x5d604c){const _0x56dda6=_0x4b2d52;if(devices[_0x5d604c]['pidRefreshToken'])clearTimeout(devices[_0x5d604c][_0x56dda6(0x17e)]);devices[_0x5d604c]['pidRefreshToken']=setTimeout(()=>{const _0x1f3d34=_0x56dda6;getClientsWithUuid(_0x5d604c)['length']!=0x0?(devices[_0x5d604c]['access']=refreshToken(_0x5d604c),io['to'](_0x5d604c)[_0x1f3d34(0xc2)](_0x1f3d34(0x10f),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5d604c]['access'],'externalip':devices[_0x5d604c]['ip'],'publicKey':secure[_0x1f3d34(0x165)],'validInstallation':validInstallation}),setTokenRefresh(_0x5d604c)):clearTimeout(devices[_0x5d604c][_0x1f3d34(0x17e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2f3e09){const _0x5a0a62=_0x4b2d52,_0x50f30b=getClient(_0x2f3e09['id'])[_0x5a0a62(0x1f9)];_0x2f3e09[_0x5a0a62(0xc2)](_0x5a0a62(0x1bf),config),_0x2f3e09['emit'](_0x5a0a62(0xf5),cleanSettings()),_0x2f3e09['on'](_0x5a0a62(0xc8),_0x274ba0=>{const _0x491469=_0x5a0a62;if(validateAccess(_0x274ba0,_0x50f30b)[_0x491469(0xe3)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2f3e09['on']('update-bot',(_0x447cf6,_0x9b5ca6)=>{const _0x7802a=_0x5a0a62;if(validateAccess(_0x9b5ca6,_0x50f30b)[_0x7802a(0xe3)])toggleBot(_0x447cf6[_0x7802a(0x1be)],_0x447cf6[_0x7802a(0x10f)],_0x447cf6[_0x7802a(0x1c4)]);else logging(_0x7802a(0x170));}),_0x2f3e09['on'](_0x5a0a62(0xf4),(_0x538ae3,_0xb58c0e)=>{const _0x2c703a=_0x5a0a62;if(validateAccess(_0xb58c0e,_0x50f30b)[_0x2c703a(0xe3)])deleteBot(_0x538ae3);else logging(_0x2c703a(0x163));}),_0x2f3e09['on'](_0x5a0a62(0x12e),(_0x411e96,_0x29ba00)=>{const _0x101b0f=_0x5a0a62;if(validateAccess(_0x29ba00,_0x50f30b)[_0x101b0f(0xe3)])storeSettings(_0x411e96,!![]);else logging(_0x101b0f(0x17c));}),_0x2f3e09['on'](_0x5a0a62(0x17f),(_0xcf3c53,_0x32537e)=>{const _0xebc7df=_0x5a0a62;if(validateAccess(_0x32537e,_0x50f30b)[_0xebc7df(0xe3)])updateBB();else logging(_0xebc7df(0x17c));}),_0x2f3e09['on'](_0x5a0a62(0x127),_0x526089=>{const _0x231ddb=_0x5a0a62;if(validateAccess(_0x526089,_0x50f30b)[_0x231ddb(0xe3)]){if(devices[_0x50f30b][_0x231ddb(0x17e)])clearTimeout(devices[_0x50f30b][_0x231ddb(0x17e)]);if(devices[_0x50f30b][_0x231ddb(0x1fc)])clearTimeout(devices[_0x50f30b][_0x231ddb(0x1fc)]);removeSocketListeners(getClient(_0x2f3e09['id'])[_0x231ddb(0x1f9)]),addBlacklist(_0x50f30b),devices[_0x50f30b][_0x231ddb(0x139)]=null,devices[_0x50f30b][_0x231ddb(0x11b)]=null,devices[_0x50f30b]['access'][_0x231ddb(0x101)]=null,io['to'](getClient(_0x2f3e09['id'])[_0x231ddb(0x1f9)])[_0x231ddb(0xc2)](_0x231ddb(0x10f),{'access':{'allow':![],'reason':_0x231ddb(0x1cb),'token':null}});}else logging(_0x231ddb(0x1e1));});}function initializeSocketBot(_0x2668fc){const _0x4afec4=_0x4b2d52,_0xf5254=getClient(_0x2668fc['id'])[_0x4afec4(0x12d)],_0x36c63c=getClient(_0x2668fc['id'])['uuid'];_0x2668fc['on']('get-logs',(_0x2c7aaf,_0x4fbfba)=>{const _0x13a5d1=_0x4afec4;if(validateAccess(_0x4fbfba,_0x36c63c)[_0x13a5d1(0xe3)]){if(pid[_0xf5254])pid[_0xf5254][_0x13a5d1(0x102)]({'function':'emitHistory','args':_0x2c7aaf});}else logging(_0x13a5d1(0x13b));}),_0x2668fc['on'](_0x4afec4(0x199),_0xcf3587=>{const _0x52a488=_0x4afec4;if(validateAccess(_0xcf3587,_0x36c63c)[_0x52a488(0xe3)]){if(pid[_0xf5254])pid[_0xf5254]['send']({'function':_0x52a488(0x1ee),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2668fc['on'](_0x4afec4(0x171),(_0x41d464,_0x1901a9)=>{const _0x1b5656=_0x4afec4;if(validateAccess(_0x1901a9,_0x36c63c)[_0x1b5656(0xe3)]){if(pid[_0xf5254])pid[_0xf5254][_0x1b5656(0x102)]({'function':_0x1b5656(0xe8),'args':_0x41d464});}else logging(_0x1b5656(0x175));}),_0x2668fc['on']('store-configuration',(_0x4ca9bc,_0x3b2dac)=>{const _0x1ed638=_0x4afec4;if(validateAccess(_0x3b2dac,_0x36c63c)['allow']){if(pid[_0xf5254])pid[_0xf5254][_0x1ed638(0x102)]({'function':_0x1ed638(0xe5),'args':_0x4ca9bc});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2668fc['on'](_0x4afec4(0x14d),(_0x5d9a4e,_0x30b600)=>{const _0x5c9432=_0x4afec4;if(validateAccess(_0x30b600,_0x36c63c)[_0x5c9432(0xe3)]){if(pid[_0xf5254])pid[_0xf5254][_0x5c9432(0x102)]({'function':_0x5c9432(0xfe),'args':_0x5d9a4e});}else logging(_0x5c9432(0x1a7));}),_0x2668fc['on'](_0x4afec4(0xd0),_0x1c47c9=>{const _0x4ac060=_0x4afec4;if(validateAccess(_0x1c47c9,_0x36c63c)[_0x4ac060(0xe3)]){if(pid[_0xf5254])pid[_0xf5254][_0x4ac060(0x102)]({'function':_0x4ac060(0x12b),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2668fc['on'](_0x4afec4(0x119),(_0x4e1887,_0x66ead4)=>{const _0x335d66=_0x4afec4;if(validateAccess(_0x66ead4,_0x36c63c)[_0x335d66(0xe3)]){if(pid[_0xf5254])pid[_0xf5254][_0x335d66(0x102)]({'function':_0x335d66(0x1de),'args':_0x4e1887});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x2668fc['on'](_0x4afec4(0x105),_0x2a4c50=>{const _0x5396d9=_0x4afec4;if(validateAccess(_0x2a4c50,_0x36c63c)[_0x5396d9(0xe3)]){if(pid[_0xf5254])pid[_0xf5254][_0x5396d9(0x102)]({'function':_0x5396d9(0x138),'args':null});}else logging(_0x5396d9(0x168));}),_0x2668fc['on'](_0x4afec4(0x127),_0x28018c=>{const _0x54dcca=_0x4afec4;if(validateAccess(_0x28018c,_0x36c63c)['allow']){if(devices[_0x36c63c][_0x54dcca(0x17e)])clearTimeout(devices[_0x36c63c]['pidRefreshToken']);if(devices[_0x36c63c][_0x54dcca(0x1fc)])clearTimeout(devices[_0x36c63c][_0x54dcca(0x1fc)]);removeSocketListeners(getClient(_0x2668fc['id'])[_0x54dcca(0x1f9)]),addBlacklist(_0x36c63c),devices[_0x36c63c][_0x54dcca(0x139)]=null,devices[_0x36c63c][_0x54dcca(0x11b)]=null,devices[_0x36c63c][_0x54dcca(0x1e0)][_0x54dcca(0x101)]=null,io['to'](getClient(_0x2668fc['id'])['uuid'])[_0x54dcca(0xc2)](_0x54dcca(0x10f),{'access':{'allow':![],'reason':_0x54dcca(0x1cb),'token':null}});}else logging(_0x54dcca(0x1e1));});}function removeSocketListeners(_0x178796){const _0x58138a=_0x4b2d52;getClientsWithUuid(_0x178796)[_0x58138a(0x10b)](_0x579870=>{getSocket(_0x579870['id'])['removeAllListeners']();});}function cleanSettings(){const _0x2d624f=_0x4b2d52;let _0x1cfe15=settings;return settings[_0x2d624f(0x11a)]&&settings[_0x2d624f(0x11a)]!=''&&(_0x1cfe15={..._0x1cfe15,'telegramToken':_0x2d624f(0x195)}),settings[_0x2d624f(0x182)]&&settings[_0x2d624f(0x182)]!=''&&(_0x1cfe15={..._0x1cfe15,'bbPassword':'************'}),_0x1cfe15;}function updateBB(){const _0x3d562c=_0x4b2d52;installingUpdate=!![],config[_0x3d562c(0x10b)](_0x3b4534=>{const _0x511328=_0x3d562c;restartBot(_0x3b4534[_0x511328(0x1be)]);}),process['send']({'update':!![]},_0x5dc392=>{});}function startBot(_0x44c6ff,_0x3d3b73,_0x476f77){const _0x114db9=_0x4b2d52;let _0x5f366d=![];const _0xa134f2=_0x44c6ff[0x0];_0x3d3b73={..._0x3d3b73,'stdio':[_0x114db9(0x125),_0x114db9(0x125),'inherit',_0x114db9(0x1c5)]},pid[_0xa134f2]=childProcess[_0x114db9(0x196)](botfile,_0x44c6ff,_0x3d3b73),pid[_0xa134f2]['on']('message',_0x4030bc=>{const _0x106ad0=_0x114db9;switch(Object[_0x106ad0(0x19f)](_0x4030bc)[0x0]){case _0x106ad0(0x197):updateBotName(_0xa134f2,_0x4030bc[_0x106ad0(0x197)]);break;case _0x106ad0(0x10f):updateStatus(_0xa134f2,_0x4030bc['status']);break;case'live':updateLive(_0xa134f2,_0x4030bc[_0x106ad0(0x1c4)]);break;case'started':updateLive(_0xa134f2,_0x4030bc[_0x106ad0(0x140)]),io['to'](_0xa134f2)[_0x106ad0(0xc2)](_0x106ad0(0x10f),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x106ad0(0x14e):_0x4030bc[_0x106ad0(0x14e)]==_0x106ad0(0x11f)&&restartBot(_0xa134f2);_0x4030bc[_0x106ad0(0x14e)]==_0x106ad0(0x13f)&&toggleBot(_0xa134f2,_0x106ad0(0x159),_0x106ad0(0x161));break;case'telegram':sendTelegram(_0xa134f2,_0x4030bc[_0x106ad0(0x108)]);break;case _0x106ad0(0x1db):io['to'](_0xa134f2)[_0x106ad0(0xc2)](_0x4030bc[_0x106ad0(0x1db)],_0x4030bc[_0x106ad0(0x107)]);break;}}),pid[_0xa134f2]['on'](_0x114db9(0x158),function(_0x25fc31){if(_0x5f366d)return;_0x5f366d=!![],_0x476f77(_0x25fc31);}),pid[_0xa134f2]['on'](_0x114db9(0xca),function(_0x3134c8){const _0x3a27bb=_0x114db9;if(installingUpdate)return;if(_0x5f366d)return;_0x5f366d=!![],_0x476f77(null);const _0x39db90=dbConfig['get'](_0x3a27bb(0x1bf))['find']({'botID':_0xa134f2})[_0x3a27bb(0x200)]();_0x39db90&&(_0x39db90[_0x3a27bb(0x10f)]==_0x3a27bb(0xe7)||_0x39db90[_0x3a27bb(0x10f)]==_0x3a27bb(0xe9))&&(updateLive(_0xa134f2,_0x3a27bb(0x161)),logging(_0x3a27bb(0x150)+_0xa134f2),startBot([_0xa134f2,userID],{'cwd':bbpath},function(_0x4e47b9){if(_0x4e47b9)logging(_0x4e47b9);}));});}function stopBot(_0x4fe4b9){getClientsWithBotID(_0x4fe4b9)['forEach'](_0x52b265=>{const _0x1dbab8=_0x3fc6;getSocket(_0x52b265['id'])[_0x1dbab8(0xfd)](!![]),removeClient(_0x52b265['id']);});if(pid[_0x4fe4b9])pid[_0x4fe4b9]['kill']();}function restartBot(_0x575a83){const _0xe4adfa=_0x4b2d52;if(pid[_0x575a83])pid[_0x575a83][_0xe4adfa(0x13f)]();}function addBot(){const _0x1f2fb3=_0x4b2d52;let _0x3ead1d;for(let _0x373199=0x1;_0x373199<0x3e9;_0x373199++){_0x3ead1d=_0x373199['toString']()[_0x1f2fb3(0x109)](0x3,'0');let _0xc0a72b=config['find'](_0x39b1b4=>_0x39b1b4[_0x1f2fb3(0x1be)]==_0x3ead1d);if(!_0xc0a72b)break;}if(_0x3ead1d==='1000'){logging(_0x1f2fb3(0x1af));return;}logging(_0x1f2fb3(0xff)+_0x3ead1d),dbConfig[_0x1f2fb3(0x132)]('bots')[_0x1f2fb3(0xbc)]({'botID':_0x3ead1d,'botname':_0x1f2fb3(0x10d)+_0x3ead1d,'status':_0x1f2fb3(0xe9),'live':''})[_0x1f2fb3(0x15a)](),startBot([_0x3ead1d,userID],{'cwd':bbpath},function(_0x16f9ad){if(_0x16f9ad)logging(_0x16f9ad);}),config=getConfiguration(),io['to'](_0x1f2fb3(0x131))[_0x1f2fb3(0xc2)](_0x1f2fb3(0x1bf),config);}function deleteBot(_0x523840){const _0x165d43=_0x4b2d52;getClientsWithBotID(_0x523840)[_0x165d43(0x10b)](_0x107512=>{const _0x2a270a=_0x165d43;getSocket(_0x107512['id'])[_0x2a270a(0xfd)](!![]),removeClient(_0x107512['id']);}),dbConfig[_0x165d43(0x132)](_0x165d43(0x1bf))[_0x165d43(0xf3)]({'botID':_0x523840})[_0x165d43(0x15a)](),logging('deleted\x20Bot\x20'+_0x523840),stopBot(_0x523840);try{fs[_0x165d43(0x1ed)](path[_0x165d43(0x1ad)](configpath,_0x165d43(0x13c)+_0x523840+_0x165d43(0xd1))),fs[_0x165d43(0x1ed)](path['join'](configpath,_0x165d43(0x13c)+_0x523840+_0x165d43(0x193))),fs[_0x165d43(0x1ed)](path['join'](configpath,_0x165d43(0x13c)+_0x523840+_0x165d43(0xd2))),fs[_0x165d43(0x1ed)](path['join'](configpath,_0x165d43(0x13c)+_0x523840+_0x165d43(0x169)));}catch(_0x397e87){if(_0x397e87)logging(_0x165d43(0xbf),_0x397e87);}config=getConfiguration(),io['to'](_0x165d43(0x131))[_0x165d43(0xc2)](_0x165d43(0x1bf),config);}function toggleBot(_0x11ac6b,_0x3630d3,_0x384a89){const _0x4e9f70=_0x4b2d52;dbConfig[_0x4e9f70(0x132)](_0x4e9f70(0x1bf))[_0x4e9f70(0x15c)]({'botID':_0x11ac6b})[_0x4e9f70(0x179)]({'status':_0x3630d3})['assign']({'live':_0x384a89})[_0x4e9f70(0x15a)]();if(_0x3630d3==_0x4e9f70(0xe7)||_0x3630d3=='new')logging(_0x4e9f70(0xe6)+_0x11ac6b),startBot([_0x11ac6b,userID],{'cwd':bbpath},function(_0x2246a6){if(_0x2246a6)logging(_0x2246a6);});else(_0x3630d3==_0x4e9f70(0x159)||_0x3630d3==_0x4e9f70(0x18e))&&(logging(_0x4e9f70(0xdc)+_0x11ac6b),stopBot(_0x11ac6b));config=getConfiguration(),io['to'](_0x4e9f70(0x131))[_0x4e9f70(0xc2)](_0x4e9f70(0x1bf),config);}function toggleStatus(_0x3b258b){const _0x4ac444=_0x4b2d52;let _0x37d822=dbConfig[_0x4ac444(0x132)](_0x4ac444(0x1bf))[_0x4ac444(0x15c)]({'botID':_0x3b258b})[_0x4ac444(0x200)](),_0x320fb7;if(_0x37d822[_0x4ac444(0x10f)]===_0x4ac444(0xe7))_0x320fb7=_0x4ac444(0x159);else{if(_0x37d822['status']===_0x4ac444(0xe9))_0x320fb7=_0x4ac444(0x18e);else{if(_0x37d822['status']===_0x4ac444(0x18e))_0x320fb7='new';else{if(_0x37d822[_0x4ac444(0x10f)]===_0x4ac444(0x159))_0x320fb7=_0x4ac444(0xe7);}}}return _0x320fb7;}function updateStatus(_0x20d5ea,_0x404c11){const _0x11c119=_0x4b2d52;dbConfig[_0x11c119(0x132)](_0x11c119(0x1bf))[_0x11c119(0x15c)]({'botID':_0x20d5ea})['assign']({'status':_0x404c11})[_0x11c119(0x15a)](),config=getConfiguration(),io['to'](_0x11c119(0x131))['emit'](_0x11c119(0x1bf),config);}function updateLive(_0x144e14,_0x345700){const _0x36be49=_0x4b2d52;dbConfig['get']('bots')['find']({'botID':_0x144e14})[_0x36be49(0x179)]({'live':_0x345700})['write'](),config=getConfiguration(),io['to'](_0x36be49(0x131))[_0x36be49(0xc2)](_0x36be49(0x1bf),config);}function updateBotName(_0x28fa8f,_0x1ab0c6){const _0x5683b0=_0x4b2d52;dbConfig['get']('bots')[_0x5683b0(0x15c)]({'botID':_0x28fa8f})[_0x5683b0(0x179)]({'botname':_0x1ab0c6})[_0x5683b0(0x15a)](),config=getConfiguration(),io['to'](_0x5683b0(0x131))['emit'](_0x5683b0(0x1bf),config);}function telegramError(_0x235666){const _0x147842=_0x4b2d52;console['log'](getTimeStamp()+_0x147842(0x146));}function validateTelegram(_0x474af8){const _0xfcca9e=_0x4b2d52;if(_0x474af8[_0xfcca9e(0xde)]['username']!=settings[_0xfcca9e(0x1ff)]&&'@'+_0x474af8[_0xfcca9e(0xde)][_0xfcca9e(0x1f6)]!=settings[_0xfcca9e(0x1ff)])return tgBot[_0xfcca9e(0x133)](_0x474af8[_0xfcca9e(0x1c8)]['id'],_0xfcca9e(0xe4),{'parse_mode':_0xfcca9e(0x1ce)})[_0xfcca9e(0x1e9)](_0xc26457=>{telegramError(_0xc26457);}),![];return!![];}async function initTelegram(){const _0x6135ff=_0x4b2d52;if(tgBot)tgBot[_0x6135ff(0xd4)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x6135ff(0x11a)],{'polling':!![]});let _0x358cca='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x358cca+='\x0a',_0x358cca+=_0x6135ff(0x1fe),_0x358cca+=_0x6135ff(0x123),_0x358cca+=_0x6135ff(0x1d1),_0x358cca+=_0x6135ff(0x1ea),_0x358cca+=_0x6135ff(0x1ca),_0x358cca+=_0x6135ff(0x187),_0x358cca+=_0x6135ff(0x1fb),_0x358cca+=_0x6135ff(0x1d3);let _0x3c4050=_0x6135ff(0x143);_0x3c4050+='\x0a',_0x3c4050+=_0x358cca,tgBot[_0x6135ff(0x16c)](/\/start/,_0x463a0d=>{const _0x7aab81=_0x6135ff;if(!validateTelegram(_0x463a0d))return;if(settings[_0x7aab81(0x18b)]!=_0x463a0d[_0x7aab81(0x1c8)]['id'])updateSetting(_0x7aab81(0x18b),_0x463a0d[_0x7aab81(0x1c8)]['id']);updateSetting(_0x7aab81(0x17b),!![]),tgBot['sendMessage'](_0x463a0d[_0x7aab81(0x1c8)]['id'],_0x3c4050)[_0x7aab81(0x1e9)](_0x3d6f5a=>{telegramError(_0x3d6f5a);});}),tgBot[_0x6135ff(0x16c)](/\/enable/,_0x27ca1c=>{const _0x4bbd14=_0x6135ff;if(!validateTelegram(_0x27ca1c))return;if(settings[_0x4bbd14(0x18b)]!=_0x27ca1c[_0x4bbd14(0x1c8)]['id'])updateSetting(_0x4bbd14(0x18b),_0x27ca1c[_0x4bbd14(0x1c8)]['id']);updateSetting(_0x4bbd14(0x17b),!![]),tgBot[_0x4bbd14(0x133)](_0x27ca1c[_0x4bbd14(0x1c8)]['id'],_0x4bbd14(0x1d8))[_0x4bbd14(0x1e9)](_0x30bc5=>{telegramError(_0x30bc5);});}),tgBot[_0x6135ff(0x16c)](/\/config/,async _0x735838=>{const _0x2253a7=_0x6135ff;if(!validateTelegram(_0x735838))return;tgBot['removeListener'](_0x2253a7(0x1e2)),tgBot[_0x2253a7(0x133)](_0x735838[_0x2253a7(0x1c8)]['id'],_0x2253a7(0x16e),{'reply_markup':{'inline_keyboard':[[{'text':_0x2253a7(0x166),'callback_data':_0x2253a7(0x17d)},{'text':'Alerts','callback_data':_0x2253a7(0xcb)},{'text':_0x2253a7(0x1a6),'callback_data':_0x2253a7(0x152)}]]}})['catch'](_0x28f4ca=>{telegramError(_0x28f4ca);}),tgBot['on'](_0x2253a7(0x1e2),async _0x29742b=>{const _0x4a60cb=_0x2253a7,_0x243dcb=_0x29742b[_0x4a60cb(0x1a5)],_0x1e5f68=_0x29742b[_0x4a60cb(0xec)];tgBot[_0x4a60cb(0x10c)](_0x29742b['id'])[_0x4a60cb(0x13a)](async()=>{const _0x286727=_0x4a60cb;_0x243dcb==_0x286727(0x17d)&&(updateSetting(_0x286727(0x174),_0x286727(0x17d)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x1e5f68[_0x286727(0x1c8)]['id'],_0x286727(0xfc))[_0x286727(0x1e9)](_0x3f7822=>{telegramError(_0x3f7822);}));_0x243dcb==_0x286727(0xcb)&&(updateSetting(_0x286727(0x174),_0x286727(0xcb)),updateSetting(_0x286727(0x17b),!![]),await tgBot[_0x286727(0x133)](_0x1e5f68[_0x286727(0x1c8)]['id'],_0x286727(0x1a1))['catch'](_0x4bf263=>{telegramError(_0x4bf263);}));_0x243dcb==_0x286727(0x152)&&(updateSetting(_0x286727(0x174),_0x286727(0x152)),updateSetting(_0x286727(0x17b),!![]),await tgBot['sendMessage'](_0x1e5f68['chat']['id'],_0x286727(0x19c))[_0x286727(0x1e9)](_0x591890=>{telegramError(_0x591890);}));if(!settings['telegramChatId'])tgBot[_0x286727(0x133)](_0x1e5f68[_0x286727(0x1c8)]['id'],_0x286727(0x1a0))[_0x286727(0x1e9)](_0x3cf25f=>{telegramError(_0x3cf25f);});}),tgBot[_0x4a60cb(0x115)](_0x4a60cb(0x1e2));});}),tgBot[_0x6135ff(0x16c)](/\/status/,_0x371c55=>{const _0x9e1eb1=_0x6135ff;if(!validateTelegram(_0x371c55))return;let _0x4e980e='<b>Balance\x20Bot\x20status:</b>\x0a';config[_0x9e1eb1(0x10b)](_0x45473d=>{const _0x45d5bf=_0x9e1eb1;_0x4e980e+=_0x45d5bf(0x10d)+_0x45473d['botID']+_0x45d5bf(0x1b4)+_0x45473d[_0x45d5bf(0x197)]+':\x20'+_0x45473d[_0x45d5bf(0x10f)]+'\x20/\x20'+_0x45473d[_0x45d5bf(0x1c4)]+'\x0a';}),_0x4e980e+='\x0a',_0x4e980e+=_0x9e1eb1(0x156),_0x4e980e+=!settings[_0x9e1eb1(0x17b)]?_0x9e1eb1(0xc7):_0x9e1eb1(0x141),_0x4e980e+=settings[_0x9e1eb1(0x17b)]?settings[_0x9e1eb1(0x174)]==_0x9e1eb1(0x152)?_0x9e1eb1(0x122):_0x9e1eb1(0xea)+settings[_0x9e1eb1(0x174)]+_0x9e1eb1(0x1f3):'',tgBot['sendMessage'](_0x371c55['chat']['id'],_0x4e980e,{'parse_mode':'HTML'})[_0x9e1eb1(0x1e9)](_0x15c7af=>{telegramError(_0x15c7af);});}),tgBot[_0x6135ff(0x16c)](/\/restart/,_0x1bc4c7=>{const _0x6029c8=_0x6135ff;if(!validateTelegram(_0x1bc4c7))return;tgBot[_0x6029c8(0x115)](_0x6029c8(0x1e2));const _0x3553a2=getEnabledBots();if(_0x3553a2['length']==0x0)tgBot['sendMessage'](_0x1bc4c7[_0x6029c8(0x1c8)]['id'],_0x6029c8(0x177))[_0x6029c8(0x1e9)](_0xdad0c7=>{telegramError(_0xdad0c7);});else{if(_0x3553a2['length']>0x1)_0x3553a2[_0x6029c8(0xbc)]({'botID':_0x6029c8(0x152)});let _0x440f57=[],_0x33403b=[];const _0x2b9505=_0x3553a2[_0x6029c8(0x1b9)]%0x4==0x0||_0x3553a2[_0x6029c8(0x1b9)]%0x4==0x3||_0x3553a2[_0x6029c8(0x1b9)]%0x3==0x1?0x4:0x3;let _0x44e5e6=0x0;_0x3553a2[_0x6029c8(0x10b)]((_0x3967a1,_0x340af9)=>{const _0x18cd31=_0x6029c8;if(_0x340af9%_0x2b9505==0x0)_0x33403b=[];_0x33403b[_0x18cd31(0xbc)]({'text':_0x3967a1['botID']==_0x18cd31(0x152)?_0x18cd31(0x1e4):_0x18cd31(0x10d)+_0x3967a1['botID'],'callback_data':_0x3967a1[_0x18cd31(0x1be)]}),_0x340af9%_0x2b9505==0x0&&(_0x440f57[_0x44e5e6]=_0x33403b,_0x44e5e6++);}),tgBot[_0x6029c8(0x133)](_0x1bc4c7[_0x6029c8(0x1c8)]['id'],_0x6029c8(0x1fa),{'reply_markup':{'inline_keyboard':_0x440f57}})[_0x6029c8(0x1e9)](_0x243ed3=>{telegramError(_0x243ed3);}),tgBot['on']('callback_query',async _0x3e8980=>{const _0x5b7c2d=_0x6029c8,_0x610115=_0x3e8980[_0x5b7c2d(0x1a5)],_0x5f12d4=_0x3e8980[_0x5b7c2d(0xec)];tgBot[_0x5b7c2d(0x10c)](_0x3e8980['id'])[_0x5b7c2d(0x13a)](async()=>{const _0x2135a1=_0x5b7c2d;if(_0x610115==_0x2135a1(0x152)){if(settings['telegramEvents']=='orders')tgBot[_0x2135a1(0x133)](_0x5f12d4[_0x2135a1(0x1c8)]['id'],_0x2135a1(0x12c))[_0x2135a1(0x1e9)](_0x40d669=>{telegramError(_0x40d669);});config['forEach'](_0x3d8783=>{const _0x2424f0=_0x2135a1;restartBot(_0x3d8783[_0x2424f0(0x1be)]);});}else{if(settings['telegramEvents']==_0x2135a1(0x17d))tgBot['sendMessage'](_0x5f12d4['chat']['id'],_0x2135a1(0xbd)+_0x610115)[_0x2135a1(0x1e9)](_0x104c3a=>{telegramError(_0x104c3a);});restartBot(_0x610115);}}),tgBot[_0x5b7c2d(0x115)](_0x5b7c2d(0x1e2));});}}),tgBot[_0x6135ff(0x16c)](/\/on/,_0x1888e7=>{const _0x2d7deb=_0x6135ff;if(!validateTelegram(_0x1888e7))return;tgBot[_0x2d7deb(0x115)](_0x2d7deb(0x1e2));const _0x50b2f3=getDisabledBots();if(_0x50b2f3[_0x2d7deb(0x1b9)]==0x0)tgBot['sendMessage'](_0x1888e7['chat']['id'],_0x2d7deb(0xd7))[_0x2d7deb(0x1e9)](_0x4873f9=>{telegramError(_0x4873f9);});else{if(_0x50b2f3[_0x2d7deb(0x1b9)]>0x1)_0x50b2f3[_0x2d7deb(0xbc)]({'botID':_0x2d7deb(0x152)});let _0x167a79=[],_0x4d9857=[];const _0x4bf615=_0x50b2f3['length']%0x4==0x0||_0x50b2f3[_0x2d7deb(0x1b9)]%0x4==0x3||_0x50b2f3[_0x2d7deb(0x1b9)]%0x3==0x1?0x4:0x3;let _0x5b3b97=0x0;_0x50b2f3[_0x2d7deb(0x10b)]((_0x495ccf,_0x2f3ddf)=>{const _0x187ba2=_0x2d7deb;if(_0x2f3ddf%_0x4bf615==0x0)_0x4d9857=[];_0x4d9857[_0x187ba2(0xbc)]({'text':_0x495ccf['botID']=='all'?_0x187ba2(0x1e4):'Bot\x20'+_0x495ccf[_0x187ba2(0x1be)],'callback_data':_0x495ccf[_0x187ba2(0x1be)]}),_0x2f3ddf%_0x4bf615==0x0&&(_0x167a79[_0x5b3b97]=_0x4d9857,_0x5b3b97++);}),tgBot[_0x2d7deb(0x133)](_0x1888e7[_0x2d7deb(0x1c8)]['id'],_0x2d7deb(0x160),{'reply_markup':{'inline_keyboard':_0x167a79}})[_0x2d7deb(0x1e9)](_0x5513fb=>{telegramError(_0x5513fb);}),tgBot['on'](_0x2d7deb(0x1e2),async _0x2ff020=>{const _0x1c76c2=_0x2d7deb,_0x404f28=_0x2ff020[_0x1c76c2(0x1a5)],_0x412bfa=_0x2ff020[_0x1c76c2(0xec)];tgBot[_0x1c76c2(0x10c)](_0x2ff020['id'])[_0x1c76c2(0x13a)](async()=>{const _0x2cdb63=_0x1c76c2;if(_0x404f28==_0x2cdb63(0x152)){if(settings[_0x2cdb63(0x174)]==_0x2cdb63(0x17d))tgBot[_0x2cdb63(0x133)](_0x412bfa[_0x2cdb63(0x1c8)]['id'],_0x2cdb63(0x189))['catch'](_0x329778=>{telegramError(_0x329778);});_0x50b2f3[_0x2cdb63(0x10b)](_0x54da9e=>{const _0x4d9126=_0x2cdb63;if(_0x54da9e[_0x4d9126(0x1be)]!='all')toggleBot(_0x54da9e[_0x4d9126(0x1be)],toggleStatus(_0x54da9e[_0x4d9126(0x1be)]),'stopped');});}else{if(settings['telegramEvents']==_0x2cdb63(0x17d))tgBot['sendMessage'](_0x412bfa[_0x2cdb63(0x1c8)]['id'],_0x2cdb63(0x1aa)+_0x404f28)[_0x2cdb63(0x1e9)](_0x24b15f=>{telegramError(_0x24b15f);});toggleBot(_0x404f28,toggleStatus(_0x404f28),_0x2cdb63(0x161));}}),tgBot[_0x1c76c2(0x115)](_0x1c76c2(0x1e2));});}}),tgBot[_0x6135ff(0x16c)](/\/off/,_0x311192=>{const _0x322840=_0x6135ff;if(!validateTelegram(_0x311192))return;tgBot[_0x322840(0x115)](_0x322840(0x1e2));const _0x5e6618=getEnabledBots();if(_0x5e6618[_0x322840(0x1b9)]==0x0)tgBot[_0x322840(0x133)](_0x311192['chat']['id'],_0x322840(0x177))[_0x322840(0x1e9)](_0x1da7ce=>{telegramError(_0x1da7ce);});else{if(_0x5e6618[_0x322840(0x1b9)]>0x1)_0x5e6618[_0x322840(0xbc)]({'botID':'all'});let _0x55d2fd=[],_0x1475cc=[];const _0xd4fc25=_0x5e6618[_0x322840(0x1b9)]%0x4==0x0||_0x5e6618[_0x322840(0x1b9)]%0x4==0x3||_0x5e6618['length']%0x3==0x1?0x4:0x3;let _0x3ecaca=0x0;_0x5e6618['forEach']((_0x52f4cf,_0x3e257d)=>{const _0x40c6db=_0x322840;if(_0x3e257d%_0xd4fc25==0x0)_0x1475cc=[];_0x1475cc['push']({'text':_0x52f4cf[_0x40c6db(0x1be)]=='all'?_0x40c6db(0x1e4):_0x40c6db(0x10d)+_0x52f4cf['botID'],'callback_data':_0x52f4cf[_0x40c6db(0x1be)]}),_0x3e257d%_0xd4fc25==0x0&&(_0x55d2fd[_0x3ecaca]=_0x1475cc,_0x3ecaca++);}),tgBot[_0x322840(0x133)](_0x311192[_0x322840(0x1c8)]['id'],_0x322840(0x185),{'reply_markup':{'inline_keyboard':_0x55d2fd}})['catch'](_0x4a17e6=>{telegramError(_0x4a17e6);}),tgBot['on'](_0x322840(0x1e2),async _0x2eae78=>{const _0x48f8ee=_0x322840,_0x5ca2b2=_0x2eae78[_0x48f8ee(0x1a5)],_0xfbca95=_0x2eae78[_0x48f8ee(0xec)];tgBot[_0x48f8ee(0x10c)](_0x2eae78['id'])[_0x48f8ee(0x13a)](async()=>{const _0x1f764a=_0x48f8ee;if(_0x5ca2b2==_0x1f764a(0x152)){if(settings['telegramEvents']==_0x1f764a(0x17d))tgBot[_0x1f764a(0x133)](_0xfbca95[_0x1f764a(0x1c8)]['id'],_0x1f764a(0xdf))['catch'](_0x324a31=>{telegramError(_0x324a31);});_0x5e6618['forEach'](_0x2d997d=>{const _0x5a18a6=_0x1f764a;if(_0x2d997d['botID']!=_0x5a18a6(0x152))toggleBot(_0x2d997d['botID'],toggleStatus(_0x2d997d['botID']),_0x5a18a6(0x161));});}else{if(settings[_0x1f764a(0x174)]=='orders')tgBot['sendMessage'](_0xfbca95[_0x1f764a(0x1c8)]['id'],_0x1f764a(0x121)+_0x5ca2b2)[_0x1f764a(0x1e9)](_0x6cead2=>{telegramError(_0x6cead2);});toggleBot(_0x5ca2b2,toggleStatus(_0x5ca2b2),_0x1f764a(0x161));}}),tgBot['removeListener'](_0x48f8ee(0x1e2));});}}),tgBot[_0x6135ff(0x16c)](/\/disable/,_0x262540=>{const _0x4b29c5=_0x6135ff;if(!validateTelegram(_0x262540))return;tgBot[_0x4b29c5(0x133)](_0x262540[_0x4b29c5(0x1c8)]['id'],_0x4b29c5(0x120))[_0x4b29c5(0x1e9)](_0x35fad9=>{telegramError(_0x35fad9);}),updateSetting(_0x4b29c5(0x17b),![]);}),tgBot['onText'](/\/help/,_0x77703a=>{const _0x1645a4=_0x6135ff;if(!validateTelegram(_0x77703a))return;tgBot[_0x1645a4(0x133)](_0x77703a[_0x1645a4(0x1c8)]['id'],_0x358cca)[_0x1645a4(0x1e9)](_0x4b8057=>{telegramError(_0x4b8057);});}),tgBot['on']('polling_error',_0x550edb=>{const _0x5e7334=_0x6135ff;_0x550edb[_0x5e7334(0x130)]()[_0x5e7334(0x1d4)](_0x5e7334(0x18f))&&(logging(_0x5e7334(0x15b)),tgBot[_0x5e7334(0xd4)](),tgBot=null,io['to']('botmanager')['emit'](_0x5e7334(0x100),_0x5e7334(0x15b)));}),process[_0x6135ff(0x1bb)]('SIGINT',()=>{const _0x59f70d=_0x6135ff;if(tgBot)tgBot[_0x59f70d(0xd4)]();process[_0x59f70d(0xca)](0x1);}),process['once'](_0x6135ff(0x118),()=>{const _0x28a83e=_0x6135ff;if(tgBot)tgBot[_0x28a83e(0xd4)]();process[_0x28a83e(0xca)](0x1);});}}function disableTelegram(){const _0x275ad7=_0x4b2d52;tgBot&&(tgBot[_0x275ad7(0xd4)](),tgBot=null);}function sendTelegram(_0xa4748,_0x4b5a4a){const _0x4a4050=_0x4b2d52;if(settings[_0x4a4050(0x17b)]){if(settings['telegramEvents']=='all'||(_0x4b5a4a[_0x4a4050(0x186)]==_0x4a4050(0x158)||_0x4b5a4a['type']==_0x4a4050(0xee))&&settings[_0x4a4050(0x174)]=='alerts'||_0x4b5a4a[_0x4a4050(0x186)]==_0x4a4050(0x1a4)&&settings[_0x4a4050(0x174)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x4b5a4a[_0x4a4050(0x135)])tgBot[_0x4a4050(0x133)](settings[_0x4a4050(0x18b)],_0x4b5a4a['botname']+'\x20>\x20'+_0x4b5a4a[_0x4a4050(0x104)])[_0x4a4050(0x1e9)](_0x186ff6=>{telegramError(_0x186ff6);});else tgBot[_0x4a4050(0x133)](settings[_0x4a4050(0x18b)],_0x4a4050(0x10d)+_0xa4748+_0x4a4050(0xc3)+_0x4b5a4a['event'])[_0x4a4050(0x1e9)](_0x97c6a3=>{telegramError(_0x97c6a3);});}}}}function getDeviceWithIp(_0x16ff06){return devices['find'](_0xde4a97=>_0xde4a97['ip']===_0x16ff06);}function temporaryAccess2FA(_0x1663dd,_0x3183e3){const _0x3dd703=_0x4b2d52;let _0x1724b9=new Date(),_0x4021b1=![];if(lastIpApproval){if(_0x1724b9-lastIpApproval<0x1388)_0x4021b1=!![];}lastIpApproval=new Date();if(_0x4021b1)return;tgBot&&settings[_0x3dd703(0x18b)]&&(tgBot[_0x3dd703(0x115)](_0x3dd703(0x1e2)),tgBot['sendMessage'](settings[_0x3dd703(0x18b)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x3183e3)[_0x3dd703(0xcf)]+_0x3dd703(0x11d),{'parse_mode':_0x3dd703(0x1ce),'reply_markup':{'inline_keyboard':[[{'text':_0x3dd703(0x1a9),'callback_data':'5'},{'text':_0x3dd703(0xfa),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x3dd703(0x1c9),'callback_data':_0x3dd703(0x1c9)}]]}})[_0x3dd703(0x1e9)](_0x492193=>{telegramError(_0x492193);}),tgBot['on'](_0x3dd703(0x1e2),async _0x1fb1ef=>{const _0x59d48d=_0x3dd703,_0x513035=_0x1fb1ef['data'],_0x546176=_0x1fb1ef[_0x59d48d(0xec)];tgBot['answerCallbackQuery'](_0x1fb1ef['id'])['then'](async()=>{const _0x367f0f=_0x59d48d;devices[_0x1663dd]['telegramIpApproval']={'clientip':_0x3183e3,'timestamp':new Date()['getTime'](),'expiry':_0x513035},_0x513035!=_0x367f0f(0x1c9)?(await tgBot[_0x367f0f(0x133)](_0x546176[_0x367f0f(0x1c8)]['id'],_0x367f0f(0xc0)+_0x513035+'\x20minutes',{'parse_mode':_0x367f0f(0x1ce)})['catch'](_0x39e294=>{telegramError(_0x39e294);}),io['to'](_0x1663dd)['emit'](_0x367f0f(0x10f),{'access':{'allow':![],'reason':_0x367f0f(0xe1),'token':null}})):(await tgBot['sendMessage'](_0x546176[_0x367f0f(0x1c8)]['id'],_0x367f0f(0x151))['catch'](_0x3fcd1e=>{telegramError(_0x3fcd1e);}),io['to'](_0x1663dd)[_0x367f0f(0xc2)]('status',{'access':{'allow':![],'reason':_0x367f0f(0x1eb),'token':null}}));}),tgBot[_0x59d48d(0x115)]('callback_query');}));}function loginAccess2FA(_0x3a7ebf,_0x462f82){const _0x5b5673=_0x4b2d52;tgBot&&settings['telegramChatId']&&(tgBot[_0x5b5673(0x115)](_0x5b5673(0x1e2)),tgBot[_0x5b5673(0x133)](settings[_0x5b5673(0x18b)],_0x5b5673(0x1a8)+normalizeIP(_0x462f82)[_0x5b5673(0xcf)]+_0x5b5673(0x11d),{'parse_mode':_0x5b5673(0x1ce),'reply_markup':{'inline_keyboard':[[{'text':_0x5b5673(0x1d6),'callback_data':loginExpiry},{'text':_0x5b5673(0x1c9),'callback_data':_0x5b5673(0x1c9)}]]}})[_0x5b5673(0x1e9)](_0x41b72c=>{telegramError(_0x41b72c);}),tgBot['on'](_0x5b5673(0x1e2),async _0x2d4000=>{const _0x12ff18=_0x5b5673,_0x48079e=_0x2d4000[_0x12ff18(0x1a5)],_0x4ed628=_0x2d4000['message'];tgBot['answerCallbackQuery'](_0x2d4000['id'])[_0x12ff18(0x13a)](async()=>{const _0x26e866=_0x12ff18;devices[_0x3a7ebf][_0x26e866(0x11b)]={'clientip':_0x462f82,'timestamp':new Date()[_0x26e866(0x1c7)](),'expiry':_0x48079e},_0x48079e!=_0x26e866(0x1c9)?(await tgBot[_0x26e866(0x133)](_0x4ed628[_0x26e866(0x1c8)]['id'],_0x26e866(0x201),{'parse_mode':_0x26e866(0x1ce)})[_0x26e866(0x1e9)](_0x205ce6=>{telegramError(_0x205ce6);}),io['to'](_0x3a7ebf)[_0x26e866(0xc2)](_0x26e866(0x10f),{'access':{'allow':![],'reason':_0x26e866(0xe1),'token':null}})):(await tgBot[_0x26e866(0x133)](_0x4ed628[_0x26e866(0x1c8)]['id'],_0x26e866(0xed))[_0x26e866(0x1e9)](_0x233537=>{telegramError(_0x233537);}),io['to'](_0x3a7ebf)[_0x26e866(0xc2)](_0x26e866(0x10f),{'access':{'allow':![],'reason':_0x26e866(0x1d7),'token':null}}));}),tgBot[_0x12ff18(0x115)](_0x12ff18(0x1e2));}));}function getConfiguration(){const _0x43ab52=_0x4b2d52;return dbConfig[_0x43ab52(0x132)](_0x43ab52(0x1bf))[_0x43ab52(0x17a)](_0x43ab52(0x1be))[_0x43ab52(0x200)]()||[];}function getEnabledBots(){const _0x54c0c7=_0x4b2d52;return dbConfig[_0x54c0c7(0x132)](_0x54c0c7(0x1bf))[_0x54c0c7(0x17a)](_0x54c0c7(0x1be))[_0x54c0c7(0xcc)]({'status':_0x54c0c7(0xe7)})[_0x54c0c7(0x200)]()||[];}function getDisabledBots(){const _0x5d2b09=_0x4b2d52;return dbConfig[_0x5d2b09(0x132)](_0x5d2b09(0x1bf))[_0x5d2b09(0x17a)](_0x5d2b09(0x1be))[_0x5d2b09(0xcc)]({'status':'disabled'})[_0x5d2b09(0x200)]()||[];}function getSettings(){const _0x474725=_0x4b2d52;return dbSettings[_0x474725(0x132)]('settings')[_0x474725(0x200)]()||{'timeshift':0x0};}function getSecure(){const _0x5c1e82=_0x4b2d52;return dbSecure[_0x5c1e82(0x132)](_0x5c1e82(0x180))[_0x5c1e82(0x200)]()||{};}function getBlacklist(){const _0x4a1290=_0x4b2d52;return dbSecure[_0x4a1290(0x132)](_0x4a1290(0x111))[_0x4a1290(0x200)]()||[];}function broadcastToBots(_0x74ae4e,_0x4530e9){const _0x4bfe73=_0x4b2d52;config[_0x4bfe73(0x10b)](_0xf68e63=>{const _0xc473c1=_0x4bfe73;if(_0xf68e63[_0xc473c1(0x10f)]==_0xc473c1(0xe7)&&_0xf68e63[_0xc473c1(0x1c4)]==_0xc473c1(0x1ae)){if(pid[_0xf68e63[_0xc473c1(0x1be)]])pid[_0xf68e63[_0xc473c1(0x1be)]][_0xc473c1(0x102)]({[_0x74ae4e]:_0x4530e9});}});}function storeSettings(_0x5eee31,_0x38efaa=![]){const _0x2b4010=_0x4b2d52;_0x5eee31={...settings,..._0x5eee31};if(_0x38efaa&&_0x5eee31[_0x2b4010(0x182)]!=_0x2b4010(0x195)&&_0x5eee31[_0x2b4010(0x182)]!=''){const _0x2e5b9f=crypt[_0x2b4010(0x1dd)](secure[_0x2b4010(0x1d0)],_0x5eee31[_0x2b4010(0x182)])['message'][_0x2b4010(0x136)]('@')[0x0],_0x4590ec=bcrypt[_0x2b4010(0x1b5)](_0x2e5b9f,saltRounds);_0x5eee31={..._0x5eee31,'bbPassword':_0x4590ec};}if(_0x38efaa&&_0x5eee31[_0x2b4010(0x11a)]!=_0x2b4010(0x195)&&_0x5eee31[_0x2b4010(0x11a)]!=''){const _0x32e5c0=crypt[_0x2b4010(0x1dd)](secure[_0x2b4010(0x1d0)],_0x5eee31['telegramToken'])[_0x2b4010(0xec)][_0x2b4010(0x136)]('@')[0x0];_0x5eee31={..._0x5eee31,'telegramToken':_0x32e5c0};}const _0x2cb120=_0x5eee31['telegramToken']!=_0x2b4010(0x195)&&_0x5eee31['telegramToken']!=settings[_0x2b4010(0x11a)]||_0x5eee31['telegramUsername']!=settings[_0x2b4010(0x1ff)],_0xfca5c1=_0x5eee31[_0x2b4010(0x11a)]==''||_0x5eee31[_0x2b4010(0x1ff)]=='';if(_0x2cb120)_0x5eee31[_0x2b4010(0x174)]=_0x2b4010(0x152);for(const [_0x5eb35d,_0x367e58]of Object[_0x2b4010(0x1a2)](_0x5eee31)){if(_0x5eb35d==_0x2b4010(0x11a)&&_0x367e58==_0x2b4010(0x195)){_0x5eee31[_0x2b4010(0x11a)]=settings[_0x2b4010(0x11a)];continue;};if(_0x5eb35d=='bbPassword'&&_0x367e58==_0x2b4010(0x195)){_0x5eee31[_0x2b4010(0x182)]=settings['bbPassword'];continue;};dbSettings[_0x2b4010(0x145)](_0x2b4010(0x204)+_0x5eb35d,_0x367e58)[_0x2b4010(0x15a)]();}settings=_0x5eee31,io['to'](_0x2b4010(0x131))[_0x2b4010(0xc2)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x2b4010(0xc5)]);if(_0x2cb120&&!_0xfca5c1)initTelegram();if(_0x2cb120&&_0xfca5c1)disableTelegram();getAllClients()['forEach'](_0x5befa7=>{const _0x158967=_0x2b4010;getSocket(_0x5befa7['id'])[_0x158967(0xc2)](_0x158967(0x10f),{'access':{'allow':![],'reason':_0x158967(0xe1),'token':null}});});}function updateSetting(_0x467a6c,_0x34c471){const _0x112493=_0x4b2d52;dbSettings[_0x112493(0x145)]('settings.'+_0x467a6c,_0x34c471)[_0x112493(0x15a)](),settings=getSettings(),io['to']('botmanager')[_0x112493(0xc2)](_0x112493(0xf5),cleanSettings());}function storeSecure(_0x257892){const _0x8fcf0c=_0x4b2d52;dbSecure[_0x8fcf0c(0x132)](_0x8fcf0c(0x180))[_0x8fcf0c(0xbc)](_0x257892)[_0x8fcf0c(0x15a)](),secure=_0x257892;}function addBlacklist(_0xcf893e){const _0x4fc6b8=_0x4b2d52;cleanBlacklist();let _0xa8e33b;devices[_0xcf893e][_0x4fc6b8(0x139)]?_0xa8e33b=Math['max'](devices[_0xcf893e][_0x4fc6b8(0x139)]['expiry'],loginExpiry):_0xa8e33b=loginExpiry,dbSecure['get'](_0x4fc6b8(0x111))[_0x4fc6b8(0xbc)]({'expiry':new Date()[_0x4fc6b8(0x1c7)]()+_0xa8e33b*0x3c*0x3e8,'token':devices[_0xcf893e]['access'][_0x4fc6b8(0x101)]})[_0x4fc6b8(0x15a)](),blacklist=dbSecure[_0x4fc6b8(0x132)]('blacklist')[_0x4fc6b8(0x200)]();}function cleanBlacklist(){const _0x3f5fa3=_0x4b2d52;let _0x3bab34=dbSecure[_0x3f5fa3(0x132)](_0x3f5fa3(0x111))[_0x3f5fa3(0x155)]()[_0x3f5fa3(0x200)](),_0x48bbe4=new Date()[_0x3f5fa3(0x1c7)]();_0x3bab34['forEach'](_0x368f68=>{const _0x25ddb7=_0x3f5fa3;_0x368f68[_0x25ddb7(0x1d9)]<_0x48bbe4&&dbSecure['get']('blacklist')[_0x25ddb7(0xf3)]({'expiry':_0x368f68[_0x25ddb7(0x1d9)]})[_0x25ddb7(0x15a)]();});}function initStates(){const _0x5aeed1=_0x4b2d52;let _0x509919=getConfiguration();_0x509919[_0x5aeed1(0x10b)](_0x3f7c62=>{const _0x5283e8=_0x5aeed1;_0x3f7c62[_0x5283e8(0x1c4)]='stopped';}),storeConfiguration(_0x509919);}function onKeys(){const _0x8fa383=new RSA();return new Promise(_0x33fa1d=>{const _0x3b3059=_0x3fc6;_0x8fa383['generateKeyPairAsync']()[_0x3b3059(0x13a)](_0x397975=>{_0x33fa1d(_0x397975);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5d81b6=_0x4b2d52;let _0x5cd6bd=getConfiguration(),_0x252a0e=![];_0x5cd6bd[_0x5d81b6(0x10b)](_0x2ef696=>{const _0x47fc9b=_0x5d81b6;if(_0x2ef696[_0x47fc9b(0x10f)]==_0x47fc9b(0x1ae))_0x2ef696['status']='enabled',_0x252a0e=!![];else _0x2ef696[_0x47fc9b(0x10f)]==_0x47fc9b(0x161)&&(_0x2ef696[_0x47fc9b(0x10f)]='disabled',_0x252a0e=!![]);});if(_0x252a0e)storeConfiguration(_0x5cd6bd);let _0x404e80=getSecure();if(!_0x404e80[_0x5d81b6(0x147)](_0x5d81b6(0x192))){let _0x1a82b6=await generateKeys();_0x404e80[_0x5d81b6(0x165)]=_0x1a82b6[_0x5d81b6(0x165)],_0x404e80[_0x5d81b6(0x1d0)]=_0x1a82b6[_0x5d81b6(0x1d0)],_0x404e80[_0x5d81b6(0x192)]=crypto[_0x5d81b6(0xdb)](0x20)['toString'](_0x5d81b6(0xc4));;storeSecure(_0x404e80);}let _0x4a0934=getSettings();_0x252a0e=![];!_0x4a0934['hasOwnProperty'](_0x5d81b6(0x129))&&(_0x4a0934['loginRequired']=![],_0x4a0934[_0x5d81b6(0x167)]='',_0x4a0934[_0x5d81b6(0x182)]='',_0x4a0934[_0x5d81b6(0x12a)]=![],_0x252a0e=!![]);!_0x4a0934[_0x5d81b6(0x147)]('whitelistEnabled')&&(_0x4a0934['whitelistEnabled']=![],_0x4a0934[_0x5d81b6(0x134)]=[],_0x4a0934[_0x5d81b6(0x18a)]=![],_0x252a0e=!![]);if(!_0x4a0934[_0x5d81b6(0x147)](_0x5d81b6(0x17b))){if(_0x4a0934[_0x5d81b6(0x18b)])_0x4a0934[_0x5d81b6(0x17b)]=!![];else _0x4a0934[_0x5d81b6(0x17b)]=![];_0x252a0e=!![];}if(_0x252a0e)storeSettings(_0x4a0934);}function storeConfiguration(_0x143667){const _0xc46515=_0x4b2d52;dbConfig[_0xc46515(0x132)](_0xc46515(0x1bf))[_0xc46515(0xf3)]()[_0xc46515(0x15a)](),dbConfig['get']('bots')['push'](..._0x143667)['write'](),config=_0x143667;}function resetPassword(){const _0x4127ed=_0x4b2d52;tgBot&&settings[_0x4127ed(0x18b)]&&(tgBot['removeListener'](_0x4127ed(0x1e2)),tgBot[_0x4127ed(0x133)](settings[_0x4127ed(0x18b)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x4127ed(0x1ce),'reply_markup':{'inline_keyboard':[[{'text':_0x4127ed(0x14b),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4127ed(0x1e9)](_0x3a7f23=>{telegramError(_0x3a7f23);}),tgBot['on'](_0x4127ed(0x1e2),async _0x19c313=>{const _0x485a52=_0x4127ed,_0x51f74b=_0x19c313['data'],_0x119dc2=_0x19c313[_0x485a52(0xec)];tgBot['answerCallbackQuery'](_0x19c313['id'])[_0x485a52(0x13a)](async()=>{const _0x250564=_0x485a52;if(_0x51f74b!='no'){const _0x3253cc=0xf,_0x3c06f8='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x46a442=Array[_0x250564(0xde)](crypto[_0x250564(0xeb)](new Uint32Array(_0x3253cc)))[_0x250564(0xf8)](_0x2f59a1=>_0x3c06f8[_0x2f59a1%_0x3c06f8[_0x250564(0x1b9)]])[_0x250564(0x1ad)](''),_0x5cb2ad=bcrypt['hashSync'](_0x46a442,saltRounds);storeSettings({'bbPassword':_0x5cb2ad}),await tgBot[_0x250564(0x133)](_0x119dc2[_0x250564(0x1c8)]['id'],_0x250564(0x1b6)+_0x46a442,{'parse_mode':_0x250564(0x1ce)})[_0x250564(0x1e9)](_0x5a515e=>{telegramError(_0x5a515e);});}else await tgBot['sendMessage'](_0x119dc2[_0x250564(0x1c8)]['id'],_0x250564(0x1bd))[_0x250564(0x1e9)](_0x1f08a9=>{telegramError(_0x1f08a9);});}),tgBot['removeListener'](_0x485a52(0x1e2));}));}function logging(_0x351623){const _0x48ff05=_0x4b2d52;console[_0x48ff05(0x1b0)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x351623);if(tgBot&&settings[_0x48ff05(0x18b)]&&settings[_0x48ff05(0x174)]!=_0x48ff05(0x17d))tgBot[_0x48ff05(0x133)](settings['telegramChatId'],_0x48ff05(0x10e)+_0x351623)[_0x48ff05(0x1e9)](_0x29ec9e=>{telegramError(_0x29ec9e);});}function getServerTime(){const _0x1b051e=_0x4b2d52,_0x21074c=new Date();return _0x21074c['getFullYear']()+'/'+(_0x21074c[_0x1b051e(0xd8)]()+0x1)[_0x1b051e(0x130)]()[_0x1b051e(0x109)](0x2,'0')+'/'+_0x21074c[_0x1b051e(0x114)]()[_0x1b051e(0x130)]()[_0x1b051e(0x109)](0x2,'0')+'\x20'+_0x21074c['getHours']()[_0x1b051e(0x130)]()[_0x1b051e(0x109)](0x2,'0')+':'+_0x21074c[_0x1b051e(0x10a)]()[_0x1b051e(0x130)]()[_0x1b051e(0x109)](0x2,'0')+':'+_0x21074c[_0x1b051e(0xc9)]()[_0x1b051e(0x130)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1656e1=_0x4b2d52,_0x4ba333=shiftedTime();return _0x4ba333[_0x1656e1(0x1da)]()+'/'+(_0x4ba333['getMonth']()+0x1)[_0x1656e1(0x130)]()[_0x1656e1(0x109)](0x2,'0')+'/'+_0x4ba333[_0x1656e1(0x114)]()[_0x1656e1(0x130)]()[_0x1656e1(0x109)](0x2,'0')+'\x20'+_0x4ba333[_0x1656e1(0x14a)]()['toString']()[_0x1656e1(0x109)](0x2,'0')+':'+_0x4ba333[_0x1656e1(0x10a)]()[_0x1656e1(0x130)]()[_0x1656e1(0x109)](0x2,'0')+':'+_0x4ba333[_0x1656e1(0xc9)]()['toString']()[_0x1656e1(0x109)](0x2,'0');}function shiftedTime(){const _0x222b87=_0x4b2d52,_0x3cb65a=new Date();let _0x366dd0=_0x3cb65a;if(settings[_0x222b87(0xc5)]&&settings[_0x222b87(0xc5)]!==0x0)_0x366dd0=fns[_0x222b87(0xd3)](_0x3cb65a,{'hours':settings[_0x222b87(0xc5)]});return _0x366dd0;}function startScheduler(){const _0x13a61d=_0x4b2d52;let _0x54f986=new Date()[_0x13a61d(0x188)]();_0x54f986==0x1&&backupConfigFiles();_0x54f986==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x4f9fc0=_0x4b2d52;fs[_0x4f9fc0(0x1fd)](configpath,{'withFileTypes':!![]})[_0x4f9fc0(0x10b)](_0x5d8fdd=>{const _0x135a6e=_0x4f9fc0;if(!_0x5d8fdd[_0x135a6e(0xda)]())fs[_0x135a6e(0x103)](configpath+_0x5d8fdd['name'],configbackuppath+_0x5d8fdd[_0x135a6e(0xc1)]);});}function triggerAnalytics(){const _0x4be0b=_0x4b2d52;analytics['page']({'title':_0x4be0b(0x1b8),'href':_0x4be0b(0x19d),'path':'/v'+serverversion});}function validateCredentials(_0x5ca9e8,_0x21b48c){const _0x418ed3=_0x4b2d52;if(_0x5ca9e8[_0x418ed3(0x1f6)]==settings[_0x418ed3(0x167)]&&bcrypt[_0x418ed3(0x142)](_0x5ca9e8[_0x418ed3(0x124)],settings['bbPassword'])){if(settings[_0x418ed3(0x12a)])return{'allow':![],'reason':_0x418ed3(0xd9),'token':null};else{const _0x5ccde2=generateLoginToken(_0x21b48c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5ccde2};}}else return{'allow':![],'reason':_0x418ed3(0x194),'token':null};}function refreshToken(_0x1a42d1){const _0x42fde7=_0x4b2d52,_0x5bf3c8=generateLoginToken(_0x1a42d1);return{'allow':!![],'reason':_0x42fde7(0x1c3),'token':_0x5bf3c8};}function validateAccess(_0x1762fc,_0x22c069){const _0x5a5224=_0x4b2d52;let _0x344a07=devices[_0x22c069]['ip'],_0x229caa;const _0x5074fd=_0x3666af=>{const _0x2aae7c=_0x3fc6;if(settings[_0x2aae7c(0x129)]){if(settings[_0x2aae7c(0x12a)]){if(telegram2FaApproved(_0x22c069)){const _0x32db52=generateLoginToken(_0x22c069);return{'allow':!![],'reason':_0x2aae7c(0xd5),'token':_0x32db52};}else return{'allow':![],'reason':_0x2aae7c(0x128),'token':null};}else return _0x229caa=validToken(_0x3666af,_0x22c069),_0x229caa[_0x2aae7c(0x147)](_0x2aae7c(0xee))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3666af}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x2aae7c(0xe0),'token':null};};if(settings[_0x5a5224(0x157)]){let _0x599f3=[...settings[_0x5a5224(0x134)],_0x5a5224(0x190),_0x5a5224(0x1e3),'127.0.0.1'];if(_0x599f3[_0x5a5224(0x1d4)](_0x344a07))return _0x5074fd(_0x1762fc);else{_0x229caa=validToken(_0x1762fc,_0x22c069);if(_0x229caa[_0x5a5224(0x147)](_0x5a5224(0xee)))return _0x5074fd(_0x1762fc);else{if(telegramIpApproved(_0x22c069)){const _0x4c8e53=generateToken(_0x22c069);return _0x229caa=_0x5074fd(_0x1762fc),_0x229caa[_0x5a5224(0xe3)]?{'allow':!![],'reason':_0x5a5224(0x1d2),'token':_0x4c8e53}:_0x229caa;}else return settings[_0x5a5224(0x18a)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5074fd(_0x1762fc);}function timelyDecrypt(_0x2a0984,_0x4a0868=!![]){const _0xd73707=_0x4b2d52;if(_0x2a0984)try{const _0x2cab50=crypt['decrypt'](secure[_0xd73707(0x1d0)],_0x2a0984)[_0xd73707(0xec)],_0x4e79ae=_0x2cab50[_0xd73707(0x136)]('@')[0x0],_0x25e4e1=_0x2cab50['split']('@')[0x1],_0x222fe5=new Date()[_0xd73707(0x1c7)]();if(_0x4a0868){if(_0x222fe5-_0x25e4e1<maxSecretAge*0x3e8)return _0x4e79ae;else return![];}else return _0x4e79ae;}catch(_0x2a7d0b){return![];}else return![];}const validToken=(_0x333a22,_0x5b44b8)=>{const _0x5da550=_0x4b2d52,_0x1c00fc=devices[_0x5b44b8]['ip'];if(!_0x333a22)return{'error':'No\x20authentication\x20token'};for(let _0x563bfa of blacklist){if(_0x563bfa[_0x5da550(0x101)]==_0x333a22)return{'error':_0x5da550(0xce)};}let _0x53d188;try{_0x53d188=jwt[_0x5da550(0x202)](_0x333a22,secure[_0x5da550(0x192)]+_0x5b44b8);}catch{return{'error':_0x5da550(0x110)};}if(!_0x53d188['hasOwnProperty'](_0x5da550(0xf9))&&!_0x53d188[_0x5da550(0x147)](_0x5da550(0x1f6))||!_0x53d188[_0x5da550(0x147)](_0x5da550(0x11e)))return{'error':_0x5da550(0x203)};if(!_0x53d188[_0x5da550(0x147)](_0x5da550(0x1f6))&&_0x53d188[_0x5da550(0x147)]('clientip')){const {clientip:_0x8c5aea}=_0x53d188;return _0x1c00fc==_0x8c5aea?{'success':_0x5da550(0x1d5)}:{'error':_0x5da550(0xf7)};}else{if(_0x53d188[_0x5da550(0x147)](_0x5da550(0x1f6))&&_0x53d188[_0x5da550(0x147)](_0x5da550(0xf9))){const {username:_0x45a83f,clientip:_0xf8e814}=_0x53d188;return settings['bbUsername']==_0x45a83f&&_0x1c00fc==_0xf8e814?{'success':_0x5da550(0x1d5)}:{'error':_0x5da550(0x172)};}}},generateLoginToken=_0xe4367f=>{const _0xa03cdd=_0x4b2d52;if(_0xe4367f){const _0x165c11=devices[_0xe4367f]['ip'];return jwt[_0xa03cdd(0x1c2)]({'username':settings[_0xa03cdd(0x167)],'clientip':_0x165c11},secure[_0xa03cdd(0x192)]+_0xe4367f,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4adfba=>{const _0x246d74=_0x4b2d52;if(_0x4adfba){const _0x4e7113=devices[_0x4adfba]['ip'];return jwt['sign']({'clientip':_0x4e7113},secure['secret']+_0x4adfba,{'expiresIn':devices[_0x4adfba][_0x246d74(0x139)][_0x246d74(0x1d9)]*0x3c});}else return![];},telegramIpApproved=_0x5e994d=>{const _0x416f4e=_0x4b2d52;let _0x585b69=![];return devices[_0x5e994d]['telegramIpApproval']&&devices[_0x5e994d][_0x416f4e(0x139)][_0x416f4e(0x1d9)]!=_0x416f4e(0x1c9)&&(_0x585b69=devices[_0x5e994d][_0x416f4e(0x139)][_0x416f4e(0xf9)]==devices[_0x5e994d]['ip']&&new Date()[_0x416f4e(0x1c7)]()-devices[_0x5e994d][_0x416f4e(0x139)][_0x416f4e(0xc6)]<devices[_0x5e994d][_0x416f4e(0x139)][_0x416f4e(0x1d9)]*0x3c*0x3e8),_0x585b69;},telegram2FaApproved=_0x5b6ae2=>{const _0x551beb=_0x4b2d52;let _0x4838c1=![];return devices[_0x5b6ae2][_0x551beb(0x11b)]&&devices[_0x5b6ae2]['telegram2FaApproval']['expiry']!=_0x551beb(0x1c9)&&(_0x4838c1=devices[_0x5b6ae2]['telegram2FaApproval'][_0x551beb(0xf9)]==devices[_0x5b6ae2]['ip']&&new Date()[_0x551beb(0x1c7)]()-devices[_0x5b6ae2][_0x551beb(0x11b)][_0x551beb(0xc6)]<devices[_0x5b6ae2][_0x551beb(0x11b)][_0x551beb(0x1d9)]*0x3c*0x3e8),_0x4838c1;},normalizeIP=_0x52496e=>{const _0x30f7fa=_0x4b2d52;let _0xe6ed34=null,_0x1ff765=null;if(ipaddr[_0x30f7fa(0x178)](_0x52496e)){const _0x40bcb8=ipaddr['parse'](_0x52496e);_0x40bcb8[_0x30f7fa(0x198)]()===_0x30f7fa(0x19b)?(_0x40bcb8[_0x30f7fa(0x16d)]()&&(_0xe6ed34=_0x40bcb8[_0x30f7fa(0x191)]()[_0x30f7fa(0x130)]()),_0x1ff765=_0x40bcb8[_0x30f7fa(0x130)]()):(_0xe6ed34=_0x40bcb8[_0x30f7fa(0x130)](),_0x1ff765=_0x40bcb8[_0x30f7fa(0x16a)]()['toString']());}return{'show':_0xe6ed34?_0xe6ed34:_0x1ff765,'store':_0x1ff765};};