const _0x3ff819=_0x5e83;(function(_0x321ed7,_0x20c512){const _0x4d630c=_0x5e83,_0x56ac67=_0x321ed7();while(!![]){try{const _0x10c9d3=parseInt(_0x4d630c(0x2bf))/0x1+-parseInt(_0x4d630c(0x1be))/0x2*(parseInt(_0x4d630c(0x217))/0x3)+-parseInt(_0x4d630c(0x2d0))/0x4+parseInt(_0x4d630c(0x19d))/0x5+-parseInt(_0x4d630c(0x14f))/0x6+parseInt(_0x4d630c(0x2b5))/0x7+parseInt(_0x4d630c(0x31a))/0x8;if(_0x10c9d3===_0x20c512)break;else _0x56ac67['push'](_0x56ac67['shift']());}catch(_0x452362){_0x56ac67['push'](_0x56ac67['shift']());}}}(_0x59b9,0xe1823));const _0x512ad4=function(){let _0x2f512a=!![];return function(_0x294beb,_0x49df2e){const _0x314dc1=_0x2f512a?function(){const _0x197db5=_0x5e83;if(_0x49df2e){const _0x17b8e6=_0x49df2e[_0x197db5(0x1cb)](_0x294beb,arguments);return _0x49df2e=null,_0x17b8e6;}}:function(){};return _0x2f512a=![],_0x314dc1;};}(),_0x211f1a=_0x512ad4(this,function(){const _0x3855d2=_0x5e83;return _0x211f1a[_0x3855d2(0x177)]()[_0x3855d2(0x169)](_0x3855d2(0x187))[_0x3855d2(0x177)]()['constructor'](_0x211f1a)[_0x3855d2(0x169)]('(((.+)+)+)+$');});_0x211f1a();'use strict';process[_0x3ff819(0x259)][_0x3ff819(0x1df)]=0x1;const childProcess=require(_0x3ff819(0x314)),fs=require('fs'),fns=require(_0x3ff819(0x148)),low=require(_0x3ff819(0x257)),FileSync=require(_0x3ff819(0x1fd)),path=require('path'),crypto=require(_0x3ff819(0x18e)),Crypt=require(_0x3ff819(0x2a2))[_0x3ff819(0x144)],RSA=require(_0x3ff819(0x2a2))[_0x3ff819(0x21e)],bcrypt=require('bcryptjs'),jwt=require(_0x3ff819(0x30a)),ipaddr=require(_0x3ff819(0x2ab)),argv=require(_0x3ff819(0x2ba))(process['argv']['slice'](0x2))['argv'],uuidRandom=require(_0x3ff819(0x230)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x3ff819(0x270)),axios=require(_0x3ff819(0x1b3)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x3ff819(0x242)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x3ff819(0x320)]||_0x3ff819(0x1f7),pattern=/^[0-9]{2,4}$/;!pattern[_0x3ff819(0x1a0)](PORT)&&(console[_0x3ff819(0x186)](_0x3ff819(0x162)+PORT+_0x3ff819(0x321)),process[_0x3ff819(0x286)](0x1));const HOST=argv[_0x3ff819(0x1a2)]||null,userID=argv[_0x3ff819(0x1ec)]||'',debugging=argv['d']||![],nodeversion=process[_0x3ff819(0x2b0)]['node'];let bbpath=_0x3ff819(0x2fa),bbpath2='';const botfile=_0x3ff819(0x1ae),configfile=_0x3ff819(0x194),settingsfile=_0x3ff819(0x206),securefile=_0x3ff819(0x2a6),maxBackups=0xa;let validInstallation=!![];!fs[_0x3ff819(0x164)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3ff819(0x2be)),configpath=userID?bbpath+_0x3ff819(0x26a)+userID+'/':bbpath+_0x3ff819(0x26a),configbackuppath=configpath+_0x3ff819(0x2e3),logspath=userID?bbpath+_0x3ff819(0x180)+userID+'/':bbpath+_0x3ff819(0x180),zippath=userID?bbpath+_0x3ff819(0x2dc)+userID+'/':bbpath+_0x3ff819(0x2dc),loggerfile=fs[_0x3ff819(0x14c)](logspath+_0x3ff819(0x238),{'flags':'a'}),temppath=userID?bbpath+_0x3ff819(0x211)+userID+'/':bbpath+_0x3ff819(0x211);!fs[_0x3ff819(0x164)](configpath)&&fs[_0x3ff819(0x210)](configpath);!fs[_0x3ff819(0x164)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x3ff819(0x210)](logspath);!fs[_0x3ff819(0x164)](zippath)&&fs[_0x3ff819(0x210)](zippath);!fs[_0x3ff819(0x164)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3ff819(0x280)]({'bots':[]})[_0x3ff819(0x2af)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3ff819(0x280)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x3ff819(0x2af)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3ff819(0x1bd),'rsaStandard':_0x3ff819(0x225)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x3ff819(0x2f2),{'host':_0x3ff819(0x2ee)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x3ff819(0x255)]!=''&&settings['telegramUsername']&&settings[_0x3ff819(0x1de)]!='')initTelegram();const parseColor=(_0x5c0e1d,_0xf04c5c)=>{const _0x456a45=_0x3ff819,_0x565e76=/#[A-Z]{3}#/g;if(typeof _0x5c0e1d==_0x456a45(0x1d9)){!_0xf04c5c?_0x5c0e1d=_0x5c0e1d[_0x456a45(0x185)](_0x565e76,''):(_0x5c0e1d=_0x5c0e1d[_0x456a45(0x185)](/#BLU#/g,'\x1b[34m'),_0x5c0e1d=_0x5c0e1d['replace'](/#RED#/g,'\x1b[31m'),_0x5c0e1d=_0x5c0e1d['replace'](/#YEL#/g,_0x456a45(0x2e5)),_0x5c0e1d=_0x5c0e1d['replace'](/#MAG#/g,'\x1b[35m'),_0x5c0e1d=_0x5c0e1d[_0x456a45(0x185)](/#CYA#/g,'\x1b[36m'),_0x5c0e1d=_0x5c0e1d[_0x456a45(0x185)](/#RES#/g,'\x1b[0m'));;}return _0x5c0e1d;},logger={'screen':_0x490e67=>{const _0x211dde=_0x3ff819;console[_0x211dde(0x186)](parseColor(_0x490e67,!![]));},'simple':_0x18a43c=>{const _0x583fba=_0x3ff819;console['log'](parseColor(_0x18a43c,!![])),loggerfile[_0x583fba(0x2af)](util[_0x583fba(0x159)](parseColor(_0x18a43c,![]))+'\x0a');},'full':async _0x1e5b3c=>{const _0x20c237=_0x3ff819,_0x480155=getTimeStamp()+_0x20c237(0x269)+_0x1e5b3c;console[_0x20c237(0x186)](parseColor(_0x480155,!![])),loggerfile[_0x20c237(0x2af)](util[_0x20c237(0x159)](parseColor(_0x480155,![]))+'\x0a');if(tgBot&&settings[_0x20c237(0x219)]&&settings[_0x20c237(0x166)]!='orders')await tgBot[_0x20c237(0x2bd)](settings[_0x20c237(0x219)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x1e5b3c,![]))[_0x20c237(0x1ac)](_0x1542d0=>{telegramError(_0x1542d0);});},'debug':async(_0x3f81b6,_0x59b304='')=>{const _0x454221=_0x3ff819,_0xf23e8a=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x3f81b6;if(debugging)console[_0x454221(0x186)](parseColor(_0xf23e8a,!![]));loggerfile[_0x454221(0x2af)](util[_0x454221(0x159)](parseColor(_0xf23e8a,![]))+'\x0a');if(_0x59b304){if(debugging)console[_0x454221(0x186)](_0x59b304);loggerfile[_0x454221(0x2af)](util['format'](_0x59b304)+'\x0a');}}};process['on']('uncaughtException',function(_0x5aef3f){logger['simple'](_0x5aef3f);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3ff819(0x179))[_0x3ff819(0x153)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3ff819(0x307)),app=express(),http=require(_0x3ff819(0x15b))[_0x3ff819(0x2fb)](app);app[_0x3ff819(0x2dd)](fileUpload({'useTempFiles':!![]})),app[_0x3ff819(0x2d5)](_0x3ff819(0x21b),async(_0x32ef64,_0x22cf7d)=>{const _0x39da72=_0x3ff819,_0x67fece=_0x32ef64[_0x39da72(0x21c)][_0x39da72(0x30f)],_0x2d82b2=getClientsWithBotID(_0x39da72(0x2cd)),_0x4abcd3=_0x32ef64['headers'][_0x39da72(0x190)],_0x21f741=timelyDecrypt(_0x4abcd3,![]),_0x2e0b6f=_0x2d82b2[_0x39da72(0x23e)](_0x5d708b=>_0x5d708b['uuid']==_0x21f741);if(_0x2e0b6f){const _0x4b4ddc=normalizeIP(_0x32ef64[_0x39da72(0x323)][_0x39da72(0x2bc)])[_0x39da72(0x2f3)],_0x16f368=_0x32ef64[_0x39da72(0x1d0)]['tkn'];if(validateAccess(_0x16f368,_0x21f741,_0x4b4ddc)[_0x39da72(0x183)])_0x67fece==_0x39da72(0x249)&&await backupConfigFiles(),await zipFiles(_0x67fece),_0x22cf7d[_0x39da72(0x279)](zippath+(_0x67fece+_0x39da72(0x2db)),_0x41a3ec=>{const _0x19f5f1=_0x39da72;_0x41a3ec&&(logger[_0x19f5f1(0x2ae)](_0x19f5f1(0x319)+_0x67fece),logger[_0x19f5f1(0x16b)](_0x41a3ec));});else logger[_0x39da72(0x2ae)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x67fece+'\x20(1)');}else logger[_0x39da72(0x2ae)](_0x39da72(0x2fd)+_0x67fece+_0x39da72(0x161));}),app[_0x3ff819(0x18b)]('/upload-backup',async(_0x29b83a,_0x48c786)=>{const _0x389063=_0x3ff819,_0x3e9b2e=getClientsWithBotID(_0x389063(0x2cd)),_0x42761d=_0x29b83a['headers'][_0x389063(0x190)],_0x38bfd5=timelyDecrypt(_0x42761d,![]),_0x3dae7d=_0x3e9b2e['find'](_0x3b9d84=>_0x3b9d84[_0x389063(0x190)]==_0x38bfd5);logger[_0x389063(0x2f6)](_0x389063(0x2d8));if(_0x3dae7d){const _0x151c9c=normalizeIP(_0x29b83a['socket'][_0x389063(0x2bc)])[_0x389063(0x2f3)],_0x434f46=_0x29b83a['headers'][_0x389063(0x2d1)];if(validateAccess(_0x434f46,_0x38bfd5,_0x151c9c)[_0x389063(0x183)]){if(_0x29b83a[_0x389063(0x16e)]){const _0x38a660=_0x29b83a['files'][_0x389063(0x1bf)];await _0x38a660['mv'](temppath+_0x38a660['name']),_0x48c786[_0x389063(0x1ee)]({'status':!![],'message':_0x389063(0x28d)});const _0x3a04ea=getBotsWithMode();_0x3a04ea[_0x389063(0x2d6)]>0x0?confirmRestore(temppath,_0x38a660[_0x389063(0x1f2)]):unzipFile(temppath,_0x38a660[_0x389063(0x1f2)]);}}else logger[_0x389063(0x2ae)](_0x389063(0x175));}else logger['full'](_0x389063(0x276));}),app[_0x3ff819(0x2dd)](express[_0x3ff819(0x1da)](path[_0x3ff819(0x1d5)](__dirname,bbpath2,_0x3ff819(0x2e8)))),app[_0x3ff819(0x2dd)](express[_0x3ff819(0x1da)](path['join'](__dirname,bbpath2,_0x3ff819(0x189)))),app[_0x3ff819(0x2d5)]('/',function(_0x5d43fc,_0xb0a2e2){const _0x35200c=_0x3ff819;_0xb0a2e2['sendFile'](path[_0x35200c(0x1d5)](__dirname,bbpath2,_0x35200c(0x2e8),_0x35200c(0x155)));}),app['get']('/:bot',function(_0x7a833,_0x5d5d72){const _0x224e8e=_0x3ff819;_0x5d5d72[_0x224e8e(0x318)](path['join'](__dirname,bbpath2,_0x224e8e(0x189),'index.html'));}),app['get'](_0x3ff819(0x277),(_0x2bed86,_0x261d12)=>{const _0x177e3c=_0x3ff819;_0x261d12[_0x177e3c(0x318)](path['join'](__dirname,bbpath2,'build',_0x177e3c(0x155)));}),app[_0x3ff819(0x2d5)](_0x3ff819(0x200),(_0x3204ef,_0x235f51)=>{const _0x7c303f=_0x3ff819;_0x235f51[_0x7c303f(0x318)](path[_0x7c303f(0x1d5)](__dirname,bbpath2,_0x7c303f(0x189),_0x7c303f(0x155)));}),app[_0x3ff819(0x2d5)](_0x3ff819(0x17c),(_0x1744b1,_0x35ab8d)=>{const _0x49d6ce=_0x3ff819;_0x35ab8d['sendFile'](path['join'](__dirname,bbpath2,_0x49d6ce(0x189),_0x49d6ce(0x155)));}),app['get'](_0x3ff819(0x30e),(_0x1842ea,_0x5be3db)=>{const _0x55275f=_0x3ff819;_0x5be3db['sendFile'](path['join'](__dirname,bbpath2,_0x55275f(0x189),_0x55275f(0x155)));}),app[_0x3ff819(0x2d5)]('/:bot/configuration',(_0x5d9b42,_0x2c1c0b)=>{const _0x38d9c4=_0x3ff819;_0x2c1c0b[_0x38d9c4(0x318)](path['join'](__dirname,bbpath2,_0x38d9c4(0x189),_0x38d9c4(0x155)));}),app[_0x3ff819(0x2d5)](_0x3ff819(0x29a),(_0x3936b2,_0xc78efe)=>{const _0xedbab6=_0x3ff819;_0xc78efe['sendFile'](path[_0xedbab6(0x1d5)](__dirname,bbpath2,_0xedbab6(0x189),_0xedbab6(0x155)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4b64de=_0x3ff819;let _0x46a944=_0x4b64de(0x2ce);const _0x3dd6c5=networkInterfaces(),_0x38edd2={};for(const _0x121092 of Object[_0x4b64de(0x2f1)](_0x3dd6c5)){for(const _0x370f0c of _0x3dd6c5[_0x121092]){if((_0x370f0c[_0x4b64de(0x2b3)]=='IPv4'||_0x370f0c[_0x4b64de(0x2b3)]==0x4)&&!_0x370f0c[_0x4b64de(0x1f3)]){const _0x3ce52f=ipaddr[_0x4b64de(0x157)](_0x370f0c[_0x4b64de(0x160)])[_0x4b64de(0x27c)]();_0x3ce52f!=_0x4b64de(0x178)&&(!_0x38edd2[_0x121092]&&(_0x38edd2[_0x121092]=[]),_0x38edd2[_0x121092][_0x4b64de(0x216)](_0x370f0c['address']),_0x46a944=_0x370f0c[_0x4b64de(0x160)]);}}}return{'serverip':_0x46a944,'netinterfaces':_0x38edd2};}async function startServer(){const _0x126fb4=_0x3ff819,{serverip:_0x483847,netinterfaces:_0x3542ed}=getServerIP();logger[_0x126fb4(0x16b)](''),logger['simple'](_0x126fb4(0x1db)),await logger[_0x126fb4(0x2ae)](_0x126fb4(0x1e3)+serverversion+'#RES#\x0a'+(_0x126fb4(0x2c8)+PORT+_0x126fb4(0x25e))+(_0x126fb4(0x2a4)+_0x483847+':'+PORT+_0x126fb4(0x188))),logger['simple'](_0x126fb4(0x1db));if(config[_0x126fb4(0x2d6)]!=0x0)for(const _0x27200e of config){if(_0x27200e[_0x126fb4(0x1c9)]==_0x126fb4(0x228)||_0x27200e['status']==_0x126fb4(0x1a9))await logger[_0x126fb4(0x2ae)](_0x126fb4(0x2ed)+_0x27200e[_0x126fb4(0x22a)]+_0x126fb4(0x213)+_0x27200e[_0x126fb4(0x2ea)]),startBot([_0x27200e[_0x126fb4(0x22a)],userID],{'cwd':bbpath},function(_0x338fed){const _0xd6c0d9=_0x126fb4;if(_0x338fed)logger[_0xd6c0d9(0x2ae)](_0x338fed);});else(_0x27200e[_0x126fb4(0x1c9)]==_0x126fb4(0x28a)||_0x27200e[_0x126fb4(0x1c9)]==_0x126fb4(0x227))&&await logger[_0x126fb4(0x2ae)](_0x126fb4(0x1bc)+_0x27200e[_0x126fb4(0x22a)]+_0x126fb4(0x213)+_0x27200e[_0x126fb4(0x2ea)]);}else!newBot&&logger[_0x126fb4(0x16b)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x126fb4(0x16b)](''),await logger[_0x126fb4(0x2f6)](_0x126fb4(0x1ef)+nodeversion),await logger[_0x126fb4(0x2f6)]('Network\x20Interfaces:',_0x3542ed);}function startSocket(){const _0x1e1796=_0x3ff819;io['on'](_0x1e1796(0x181),_0xdda43b=>{const _0x56a926=_0x1e1796;let _0x166fc4,_0x4a674e,_0x5d3633,_0x3a7bee,_0x2a57f7;const _0x3fc087=_0xdda43b[_0x56a926(0x154)]['headers'][_0x56a926(0x1d1)];_0x4a674e=_0x3fc087[_0x56a926(0x18d)](/bot[0-9]{3}/);if(_0x4a674e)_0x5d3633=_0x4a674e[0x0][_0x56a926(0x18d)](/[0-9]{3}/);if(_0x5d3633)_0x166fc4=_0x5d3633[0x0];else _0x166fc4='botmanager';const _0x4f7cc9=_0xdda43b[_0x56a926(0x154)][_0x56a926(0x2ef)][_0x56a926(0x313)];if(!_0x4f7cc9)_0xdda43b['emit']('status',{'publicKey':secure[_0x56a926(0x266)]});else{_0x3a7bee=timelyDecrypt(_0x4f7cc9,![]);if(!_0x3a7bee)_0xdda43b[_0x56a926(0x1fa)]('status',{'publicKey':secure['publicKey']});else{_0x2a57f7=normalizeIP(_0xdda43b[_0x56a926(0x2aa)]['remoteAddress'])[_0x56a926(0x2f3)];if(!devices[_0x3a7bee])devices[_0x3a7bee]={'uuid':_0x3a7bee,'access':{'token':null}};devices[_0x3a7bee]['ip']=_0x2a57f7;const _0x21c96f=addClient(_0xdda43b['id'],_0x3a7bee,_0x166fc4);setAccess(_0x21c96f),emitMessages(),_0xdda43b['on'](_0x56a926(0x294),_0x28cabe=>{const _0x542d3e=_0x56a926,_0x1239af=timelyDecrypt(_0x28cabe[_0x542d3e(0x1aa)]);if(_0x1239af){_0x28cabe={'username':_0x28cabe[_0x542d3e(0x30b)],'password':_0x1239af},devices[_0x3a7bee][_0x542d3e(0x1a6)]=validateCredentials(_0x28cabe,_0x3a7bee);if(devices[_0x3a7bee][_0x542d3e(0x1a6)]['allow']==![]&&devices[_0x3a7bee][_0x542d3e(0x1a6)][_0x542d3e(0x1ea)]=='2FA\x20login\x20required')_0xdda43b['emit'](_0x542d3e(0x1c9),{'access':devices[_0x3a7bee][_0x542d3e(0x1a6)]}),loginAccess2FA(_0x3a7bee,_0x2a57f7);else{if(devices[_0x3a7bee][_0x542d3e(0x1a6)][_0x542d3e(0x183)]==![]&&devices[_0x3a7bee]['access'][_0x542d3e(0x1ea)]==_0x542d3e(0x1c0))_0xdda43b['emit'](_0x542d3e(0x1c9),{'access':devices[_0x3a7bee][_0x542d3e(0x1a6)]});else devices[_0x3a7bee]['access'][_0x542d3e(0x183)]&&devices[_0x3a7bee]['access'][_0x542d3e(0x1ea)]==_0x542d3e(0x1d2)&&(getClientsWithUuid(_0x3a7bee)['forEach'](_0x56044b=>{setAccess(_0x56044b);}),logger[_0x542d3e(0x2f6)](_0x542d3e(0x2b6)+_0x3a7bee[_0x542d3e(0x2da)](-0x8)),setTokenRefresh(_0x3a7bee),setSessionTimeout(_0x542d3e(0x294),_0x3a7bee));}}else logger[_0x542d3e(0x2ae)](_0x542d3e(0x272));}),_0xdda43b['on'](_0x56a926(0x209),()=>{resetPassword();}),_0xdda43b['on'](_0x56a926(0x21f),_0x52261e=>{removeClient(_0xdda43b['id']);}),_0x166fc4=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function _0x5e83(_0x31d7aa,_0x3cf05d){const _0x292256=_0x59b9();return _0x5e83=function(_0x211f1a,_0x512ad4){_0x211f1a=_0x211f1a-0x143;let _0x59b987=_0x292256[_0x211f1a];return _0x59b987;},_0x5e83(_0x31d7aa,_0x3cf05d);}function initClient(_0x1d38d2){const _0x5d982b=_0x3ff819;if(_0x1d38d2!=_0x5d982b(0x2cd)&&config[_0x5d982b(0x2b4)]!=''){if(pid[_0x1d38d2])pid[_0x1d38d2][_0x5d982b(0x1ee)]({'function':'initclient','args':null});}_0x1d38d2!=_0x5d982b(0x2cd)&&broadcastToBots(_0x5d982b(0x2c1),JSON[_0x5d982b(0x152)](config));}function reloadBotManager(){const _0x319105=_0x3ff819;getClientsWithBotID(_0x319105(0x2cd))[_0x319105(0x222)](_0x173947=>{const _0x41ed63=_0x319105;getSocket(_0x173947['id'])[_0x41ed63(0x1fa)]('status',{'access':{'allow':![],'reason':_0x41ed63(0x1f8),'token':null}});});}function getSocket(_0x1cba34){const _0x54a275=_0x3ff819;return io['sockets'][_0x54a275(0x1f6)][_0x54a275(0x2d5)](_0x1cba34);}function setAccess(_0xd960cc){const _0xd202fc=_0x3ff819,_0xffcdd6=getSocket(_0xd960cc['id']),_0x58e204=_0xd960cc[_0xd202fc(0x190)],_0x5e05c2=_0xd960cc['bot'];devices[_0x58e204][_0xd202fc(0x1a6)]=validateAccess(devices[_0x58e204][_0xd202fc(0x1a6)]['token'],_0x58e204),logger[_0xd202fc(0x2f6)](_0xd202fc(0x1c3)+devices[_0x58e204][_0xd202fc(0x1a6)][_0xd202fc(0x1ea)]+_0xd202fc(0x201)+_0xd960cc['id'][_0xd202fc(0x2da)](-0x8)+_0xd202fc(0x295)+_0x58e204[_0xd202fc(0x2da)](-0x8)),_0xffcdd6['join'](_0x58e204);if(devices[_0x58e204]['access'][_0xd202fc(0x183)]){_0xffcdd6[_0xd202fc(0x1d5)](_0x5e05c2);if(_0x5e05c2==_0xd202fc(0x2cd))initializeSocketBotManager(_0xffcdd6);else initializeSocketBot(_0xffcdd6);initClient(_0x5e05c2);}devices[_0x58e204][_0xd202fc(0x1a6)][_0xd202fc(0x268)]&&devices[_0x58e204][_0xd202fc(0x1a6)]['reason']==_0xd202fc(0x1d3)&&setSessionTimeout(_0xd202fc(0x288),_0x58e204),devices[_0x58e204][_0xd202fc(0x1a6)][_0xd202fc(0x268)]&&devices[_0x58e204][_0xd202fc(0x1a6)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0xd202fc(0x294),_0x58e204),_0xffcdd6['emit'](_0xd202fc(0x1c9),{'status':_0xd960cc[_0xd202fc(0x28e)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x58e204]['access'],'externalip':devices[_0x58e204]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0xd202fc(0x223)],'validInstallation':validInstallation}),devices[_0x58e204][_0xd202fc(0x1a6)]['allow']==![]&&devices[_0x58e204][_0xd202fc(0x1a6)][_0xd202fc(0x1ea)]=='2FA\x20required'&&temporaryAccess2FA(_0x58e204,devices[_0x58e204]['ip']);}function setSessionTimeout(_0x50ed08,_0x2a7946){const _0x4a7f19=_0x3ff819;let _0x443699;if(_0x50ed08==_0x4a7f19(0x294))_0x443699=loginExpiry*0x3c*0x3e8;else _0x443699=devices[_0x2a7946][_0x4a7f19(0x299)]['expiry']*0x3c*0x3e8-(new Date()[_0x4a7f19(0x322)]()-devices[_0x2a7946]['telegramIpApproval'][_0x4a7f19(0x292)]);if(devices[_0x2a7946]['pidExpireLogin'])clearTimeout(devices[_0x2a7946][_0x4a7f19(0x14b)]);devices[_0x2a7946][_0x4a7f19(0x14b)]=setTimeout(()=>{const _0x17b9e4=_0x4a7f19;if(devices[_0x2a7946][_0x17b9e4(0x149)])clearTimeout(devices[_0x2a7946]['pidRefreshToken']);removeSocketListeners(_0x2a7946),addBlacklist(_0x2a7946),devices[_0x2a7946][_0x17b9e4(0x299)]=null,devices[_0x2a7946][_0x17b9e4(0x28b)]=null,devices[_0x2a7946]['access'][_0x17b9e4(0x268)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x2a7946['slice'](-0x8)),devices[_0x2a7946][_0x17b9e4(0x1a6)]=validateAccess(devices[_0x2a7946][_0x17b9e4(0x1a6)]['token'],_0x2a7946),!(devices[_0x2a7946]['access'][_0x17b9e4(0x183)]&&devices[_0x2a7946][_0x17b9e4(0x1a6)][_0x17b9e4(0x1ea)]==_0x17b9e4(0x285))&&(_0x50ed08=='login'?io['to'](_0x2a7946)[_0x17b9e4(0x1fa)]('status',{'access':{'allow':![],'reason':_0x17b9e4(0x27d),'token':null}}):io['to'](_0x2a7946)[_0x17b9e4(0x1fa)]('status',{'access':{'allow':![],'reason':_0x17b9e4(0x17b),'token':null}})),devices[_0x2a7946][_0x17b9e4(0x1a6)][_0x17b9e4(0x268)]=null;},_0x443699);}function setTokenRefresh(_0x133335){const _0x225c60=_0x3ff819;if(devices[_0x133335][_0x225c60(0x149)])clearTimeout(devices[_0x133335]['pidRefreshToken']);devices[_0x133335][_0x225c60(0x149)]=setTimeout(()=>{const _0x9bff66=_0x225c60;getClientsWithUuid(_0x133335)[_0x9bff66(0x2d6)]!=0x0?(devices[_0x133335][_0x9bff66(0x1a6)]=refreshToken(_0x133335),io['to'](_0x133335)[_0x9bff66(0x1fa)](_0x9bff66(0x1c9),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x133335]['access'],'externalip':devices[_0x133335]['ip'],'publicKey':secure[_0x9bff66(0x266)],'validInstallation':validInstallation}),setTokenRefresh(_0x133335)):clearTimeout(devices[_0x133335]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x347147){const _0x46c066=_0x3ff819,_0x2cbd3e=getClient(_0x347147['id'])[_0x46c066(0x190)];_0x347147[_0x46c066(0x1fa)](_0x46c066(0x2c1),config),_0x347147['emit'](_0x46c066(0x2c5),cleanSettings()),_0x347147['on'](_0x46c066(0x1c2),_0x80285b=>{const _0x3cd028=_0x46c066;if(validateAccess(_0x80285b,_0x2cbd3e)[_0x3cd028(0x183)])addBot();else logger[_0x3cd028(0x2ae)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x347147['on'](_0x46c066(0x15d),(_0x4d9024,_0x1e23fc)=>{const _0x1c9b77=_0x46c066;if(validateAccess(_0x1e23fc,_0x2cbd3e)[_0x1c9b77(0x183)])toggleBot(_0x4d9024[_0x1c9b77(0x22a)],_0x4d9024[_0x1c9b77(0x1c9)],_0x4d9024[_0x1c9b77(0x1c6)]);else logger[_0x1c9b77(0x2ae)](_0x1c9b77(0x273));}),_0x347147['on'](_0x46c066(0x1b2),(_0xcf6995,_0x8e2411)=>{const _0x19e678=_0x46c066;if(validateAccess(_0x8e2411,_0x2cbd3e)[_0x19e678(0x183)])toggleBotMode(_0xcf6995);else logger[_0x19e678(0x2ae)](_0x19e678(0x273));}),_0x347147['on'](_0x46c066(0x31b),(_0x3fae8f,_0x119ea2)=>{const _0x564f77=_0x46c066;if(validateAccess(_0x119ea2,_0x2cbd3e)['allow'])deleteBot(_0x3fae8f);else logger[_0x564f77(0x2ae)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x347147['on'](_0x46c066(0x29f),(_0x201f43,_0x3f8616)=>{const _0x1cd4bf=_0x46c066;if(validateAccess(_0x3f8616,_0x2cbd3e)['allow'])storeSettings(_0x201f43,!![]);else logger[_0x1cd4bf(0x2ae)](_0x1cd4bf(0x317));}),_0x347147['on'](_0x46c066(0x305),_0x8c1763=>{const _0x35f00d=_0x46c066;if(validateAccess(_0x8c1763,_0x2cbd3e)[_0x35f00d(0x183)])updateBB('update');else logger[_0x35f00d(0x2ae)](_0x35f00d(0x1a8));}),_0x347147['on'](_0x46c066(0x208),_0x59b619=>{const _0x21933d=_0x46c066;if(validateAccess(_0x59b619,_0x2cbd3e)['allow'])updateBB(_0x21933d(0x14a));else logger[_0x21933d(0x2ae)](_0x21933d(0x145));}),_0x347147['on'](_0x46c066(0x1b0),_0x49e75c=>{const _0xaac565=_0x46c066;if(validateAccess(_0x49e75c,_0x2cbd3e)[_0xaac565(0x183)]){const _0x4cbc60=getClient(_0x347147['id']);if(_0x4cbc60)getBackupFiles(_0x4cbc60[_0xaac565(0x190)]);else logger[_0xaac565(0x2ae)](_0xaac565(0x2f4));}else logger[_0xaac565(0x2ae)](_0xaac565(0x244));}),_0x347147['on'](_0x46c066(0x170),(_0x2bc016,_0x581736)=>{const _0x3b06e9=_0x46c066;if(validateAccess(_0x581736,_0x2cbd3e)[_0x3b06e9(0x183)])restoreBackupFile(_0x2bc016);else logger[_0x3b06e9(0x2ae)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x347147['on'](_0x46c066(0x15f),_0x52c4bc=>{const _0x2ef860=_0x46c066;if(validateAccess(_0x52c4bc,_0x2cbd3e)[_0x2ef860(0x183)])getMessages();else logger[_0x2ef860(0x2ae)](_0x2ef860(0x24b));}),_0x347147['on'](_0x46c066(0x2de),(_0x5d2089,_0x2ac9d2)=>{const _0x48e034=_0x46c066;if(validateAccess(_0x2ac9d2,_0x2cbd3e)[_0x48e034(0x183)])confirmMessage(_0x5d2089);else logger[_0x48e034(0x2ae)](_0x48e034(0x296));}),_0x347147['on'](_0x46c066(0x203),_0x2436b0=>{const _0x1cfc04=_0x46c066;if(validateAccess(_0x2436b0,_0x2cbd3e)[_0x1cfc04(0x183)]){if(devices[_0x2cbd3e]['pidRefreshToken'])clearTimeout(devices[_0x2cbd3e][_0x1cfc04(0x149)]);if(devices[_0x2cbd3e][_0x1cfc04(0x14b)])clearTimeout(devices[_0x2cbd3e][_0x1cfc04(0x14b)]);removeSocketListeners(getClient(_0x347147['id'])[_0x1cfc04(0x190)]),addBlacklist(_0x2cbd3e),devices[_0x2cbd3e]['telegramIpApproval']=null,devices[_0x2cbd3e]['telegram2FaApproval']=null,devices[_0x2cbd3e][_0x1cfc04(0x1a6)]['token']=null,logger[_0x1cfc04(0x2f6)](_0x1cfc04(0x16a)+_0x2cbd3e[_0x1cfc04(0x2da)](-0x8)),io['to'](getClient(_0x347147['id'])['uuid'])['emit'](_0x1cfc04(0x1c9),{'access':{'allow':![],'reason':_0x1cfc04(0x235),'token':null}});}else logger[_0x1cfc04(0x2ae)](_0x1cfc04(0x2e4));});}function initializeSocketBot(_0x53fcf3){const _0x21e450=_0x3ff819,_0x39a35a=getClient(_0x53fcf3['id'])['bot'],_0x5d0476=getClient(_0x53fcf3['id'])['uuid'];_0x53fcf3['on'](_0x21e450(0x24e),(_0x22c4b4,_0x129719)=>{const _0x5dd049=_0x21e450;if(validateAccess(_0x129719,_0x5d0476)['allow']){if(pid[_0x39a35a])pid[_0x39a35a][_0x5dd049(0x1ee)]({'function':_0x5dd049(0x19a),'args':_0x22c4b4});}else logger[_0x5dd049(0x2ae)](_0x5dd049(0x1ce));}),_0x53fcf3['on'](_0x21e450(0x263),(_0x426020,_0x37456c)=>{const _0x23751d=_0x21e450;if(validateAccess(_0x37456c,_0x5d0476)[_0x23751d(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a]['send']({'function':_0x23751d(0x2b1),'args':_0x426020});}else logger[_0x23751d(0x2ae)](_0x23751d(0x1b8));}),_0x53fcf3['on'](_0x21e450(0x262),(_0x10e298,_0x4fae2e)=>{const _0xc74863=_0x21e450;if(validateAccess(_0x4fae2e,_0x5d0476)[_0xc74863(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a]['send']({'function':_0xc74863(0x1ed),'args':_0x10e298});}else logger['full'](_0xc74863(0x17a));}),_0x53fcf3['on'](_0x21e450(0x214),(_0x48a0bd,_0xbd15b9)=>{const _0xb58589=_0x21e450;if(validateAccess(_0xbd15b9,_0x5d0476)[_0xb58589(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a][_0xb58589(0x1ee)]({'function':_0xb58589(0x22f),'args':_0x48a0bd});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x53fcf3['on'](_0x21e450(0x15e),(_0x241864,_0x4dd1b6)=>{const _0x2d3fbf=_0x21e450;if(validateAccess(_0x4dd1b6,_0x5d0476)[_0x2d3fbf(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a]['send']({'function':_0x2d3fbf(0x1c4),'args':_0x241864});}else logger[_0x2d3fbf(0x2ae)](_0x2d3fbf(0x20a));}),_0x53fcf3['on'](_0x21e450(0x2fc),(_0x5e5b14,_0x10d773)=>{const _0x4bd0cf=_0x21e450;if(validateAccess(_0x10d773,_0x5d0476)[_0x4bd0cf(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a][_0x4bd0cf(0x1ee)]({'function':_0x4bd0cf(0x1e1),'args':_0x5e5b14});}else logger['full'](_0x4bd0cf(0x16d));}),_0x53fcf3['on'](_0x21e450(0x1a7),_0x4489fe=>{const _0x265914=_0x21e450;if(validateAccess(_0x4489fe,_0x5d0476)[_0x265914(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a]['send']({'function':_0x265914(0x25a),'args':null});}else logger['full'](_0x265914(0x275));}),_0x53fcf3['on']('get-starting-balances',_0xd2457e=>{const _0x1cb419=_0x21e450;if(validateAccess(_0xd2457e,_0x5d0476)[_0x1cb419(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a][_0x1cb419(0x1ee)]({'function':_0x1cb419(0x234),'args':null});}else logger[_0x1cb419(0x2ae)](_0x1cb419(0x176));}),_0x53fcf3['on'](_0x21e450(0x2ca),(_0x481467,_0x3051a1)=>{const _0x3f1cd6=_0x21e450;if(validateAccess(_0x3051a1,_0x5d0476)[_0x3f1cd6(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a][_0x3f1cd6(0x1ee)]({'function':_0x3f1cd6(0x2ff),'args':_0x481467});}else logger[_0x3f1cd6(0x2ae)](_0x3f1cd6(0x243));}),_0x53fcf3['on'](_0x21e450(0x301),_0x43ffab=>{if(validateAccess(_0x43ffab,_0x5d0476)['allow']){if(pid[_0x39a35a])pid[_0x39a35a]['send']({'function':'cancelLoading','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x53fcf3['on'](_0x21e450(0x199),_0x1ed24b=>{const _0x485589=_0x21e450;if(validateAccess(_0x1ed24b,_0x5d0476)[_0x485589(0x183)]){if(pid[_0x39a35a])pid[_0x39a35a][_0x485589(0x1ee)]({'function':_0x485589(0x22d),'args':null});}else logger[_0x485589(0x2ae)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x53fcf3['on']('update-bb',_0xfa1aaf=>{const _0x106887=_0x21e450;if(validateAccess(_0xfa1aaf,_0x5d0476)[_0x106887(0x183)])updateBB(_0x106887(0x237));else logger[_0x106887(0x2ae)](_0x106887(0x1a8));}),_0x53fcf3['on'](_0x21e450(0x15f),_0x5db7d6=>{const _0x32339b=_0x21e450;if(validateAccess(_0x5db7d6,_0x5d0476)[_0x32339b(0x183)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x53fcf3['on']('confirm-message',(_0x2887ee,_0xd82f84)=>{const _0xffc49f=_0x21e450;if(validateAccess(_0xd82f84,_0x5d0476)['allow'])confirmMessage(_0x2887ee);else logger[_0xffc49f(0x2ae)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x53fcf3['on'](_0x21e450(0x203),_0x205468=>{const _0x501f45=_0x21e450;if(validateAccess(_0x205468,_0x5d0476)[_0x501f45(0x183)]){if(devices[_0x5d0476]['pidRefreshToken'])clearTimeout(devices[_0x5d0476][_0x501f45(0x149)]);if(devices[_0x5d0476][_0x501f45(0x14b)])clearTimeout(devices[_0x5d0476][_0x501f45(0x14b)]);removeSocketListeners(getClient(_0x53fcf3['id'])['uuid']),addBlacklist(_0x5d0476),devices[_0x5d0476][_0x501f45(0x299)]=null,devices[_0x5d0476][_0x501f45(0x28b)]=null,devices[_0x5d0476][_0x501f45(0x1a6)]['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x5d0476[_0x501f45(0x2da)](-0x8)),io['to'](getClient(_0x53fcf3['id'])['uuid'])[_0x501f45(0x1fa)](_0x501f45(0x1c9),{'access':{'allow':![],'reason':_0x501f45(0x235),'token':null}});}else logger[_0x501f45(0x2ae)](_0x501f45(0x2e4));});}function removeSocketListeners(_0x90706d){const _0x4718ac=_0x3ff819;getClientsWithUuid(_0x90706d)[_0x4718ac(0x222)](_0x4ab4a0=>{const _0x42e38c=_0x4718ac;getSocket(_0x4ab4a0['id'])[_0x42e38c(0x1b7)]();});}function cleanSettings(){const _0x9cd1da=_0x3ff819;let _0x1ef30f=settings;return settings[_0x9cd1da(0x255)]&&settings[_0x9cd1da(0x255)]!=''&&(_0x1ef30f={..._0x1ef30f,'telegramToken':_0x9cd1da(0x2ec)}),settings[_0x9cd1da(0x284)]&&settings[_0x9cd1da(0x284)]!=''&&(_0x1ef30f={..._0x1ef30f,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x9cd1da(0x284)]=='***'||settings[_0x9cd1da(0x255)]&&settings[_0x9cd1da(0x255)]==_0x9cd1da(0x165))&&(_0x1ef30f={..._0x1ef30f,'restored':{'password':settings[_0x9cd1da(0x284)]=='***','telegram':settings[_0x9cd1da(0x255)]=='***'}}),_0x1ef30f;}async function updateBB(_0x65efa4){const _0x4ea05b=_0x3ff819;await backupConfigFiles(),installingUpdate=!![],config[_0x4ea05b(0x222)](_0x1edeee=>{const _0x3d1fd7=_0x4ea05b;restartBot(_0x1edeee[_0x3d1fd7(0x22a)]);}),logger[_0x4ea05b(0x2f6)](_0x4ea05b(0x248)+_0x65efa4);if(_0x65efa4==_0x4ea05b(0x237))process[_0x4ea05b(0x1ee)]({'update':!![]},_0x74ba8c=>{});else _0x65efa4==_0x4ea05b(0x14a)&&process[_0x4ea05b(0x1ee)]({'reinstall':!![]},_0x1dbf1d=>{});}function startBot(_0x52bbde,_0x52cfb0,_0x415a48){const _0x1f7132=_0x3ff819;if(debugging)_0x52bbde[_0x1f7132(0x216)]('-d');let _0x346dff=![];const _0x40fa31=_0x52bbde[0x0];_0x52cfb0={..._0x52cfb0,'stdio':[_0x1f7132(0x2a7),'inherit',_0x1f7132(0x2a7),_0x1f7132(0x2d9)]},pid[_0x40fa31]=childProcess['fork'](botfile,_0x52bbde,_0x52cfb0),pid[_0x40fa31]['on'](_0x1f7132(0x167),_0xed8182=>{const _0x233052=_0x1f7132;switch(Object['keys'](_0xed8182)[0x0]){case _0x233052(0x2ea):updateBotName(_0x40fa31,_0xed8182['botname']);break;case _0x233052(0x1e8):updateBotManager();break;case _0x233052(0x1c9):updateStatus(_0x40fa31,_0xed8182[_0x233052(0x1c9)]);break;case'live':updateLive(_0x40fa31,_0xed8182[_0x233052(0x1c6)]);break;case'started':updateLive(_0x40fa31,_0xed8182[_0x233052(0x29b)]),io['to'](_0x40fa31)[_0x233052(0x1fa)](_0x233052(0x1c9),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x233052(0x1b5):_0xed8182[_0x233052(0x1b5)]==_0x233052(0x233)&&restartBot(_0x40fa31);_0xed8182[_0x233052(0x1b5)]==_0x233052(0x2cf)&&toggleBot(_0x40fa31,'disabled',_0x233052(0x195));break;case _0x233052(0x239):sendTelegram(_0x40fa31,_0xed8182[_0x233052(0x239)]);break;case _0x233052(0x1a5):sendTelegramMsg(_0xed8182['telegrammsg']);break;case _0x233052(0x197):io['to'](_0x40fa31)[_0x233052(0x1fa)](_0xed8182[_0x233052(0x197)],_0xed8182[_0x233052(0x1b9)]);break;}}),pid[_0x40fa31]['on'](_0x1f7132(0x2ac),function(_0x4b03ee){if(_0x346dff)return;_0x346dff=!![],_0x415a48(_0x4b03ee);}),pid[_0x40fa31]['on'](_0x1f7132(0x286),async function(_0x5ee39b){const _0x4630e3=_0x1f7132;if(installingUpdate)return;if(_0x346dff)return;_0x346dff=!![],_0x415a48(null);const _0x5e8b8e=dbConfig[_0x4630e3(0x2d5)](_0x4630e3(0x2c1))['find']({'botID':_0x40fa31})[_0x4630e3(0x308)]();_0x5e8b8e&&(_0x5e8b8e[_0x4630e3(0x1c9)]==_0x4630e3(0x228)||_0x5e8b8e[_0x4630e3(0x1c9)]==_0x4630e3(0x1a9))&&(await sleep(0x3e8),updateLive(_0x40fa31,_0x4630e3(0x195)),logger[_0x4630e3(0x2ae)](_0x4630e3(0x1ca)+_0x40fa31),startBot([_0x40fa31,userID],{'cwd':bbpath},function(_0x5e454c){const _0x2a6e44=_0x4630e3;if(_0x5e454c)logger[_0x2a6e44(0x2ae)](_0x5e454c);}));});}function stopBot(_0x20e2d0){const _0x259b88=_0x3ff819;getClientsWithBotID(_0x20e2d0)[_0x259b88(0x222)](_0xd48ff6=>{getSocket(_0xd48ff6['id'])['disconnect'](!![]),removeClient(_0xd48ff6['id']);}),pid[_0x20e2d0]&&(pid[_0x20e2d0]['kill'](),pid[_0x20e2d0]=null);}function restartBot(_0x3eb5f8){const _0x2b56bc=_0x3ff819;if(pid[_0x3eb5f8])pid[_0x3eb5f8][_0x2b56bc(0x2cf)]();}function addBot(){const _0x446a5b=_0x3ff819;let _0x518f9b;for(let _0x322f47=0x1;_0x322f47<0x3e9;_0x322f47++){_0x518f9b=_0x322f47['toString']()[_0x446a5b(0x290)](0x3,'0');let _0x3477b4=config[_0x446a5b(0x23e)](_0x554ff5=>_0x554ff5['botID']==_0x518f9b);if(!_0x3477b4)break;}if(_0x518f9b==='1000'){logger['full'](_0x446a5b(0x1d6));return;}logger[_0x446a5b(0x2ae)](_0x446a5b(0x260)+_0x518f9b),dbConfig[_0x446a5b(0x2d5)]('bots')['push']({'botID':_0x518f9b,'botname':_0x446a5b(0x20f)+_0x518f9b,'status':_0x446a5b(0x1a9),'live':''})[_0x446a5b(0x2af)](),startBot([_0x518f9b,userID],{'cwd':bbpath},function(_0x3bdffc){if(_0x3bdffc)logger['full'](_0x3bdffc);}),config=getConfiguration(),io['to'](_0x446a5b(0x2cd))[_0x446a5b(0x1fa)](_0x446a5b(0x2c1),config),broadcastToBots(_0x446a5b(0x2c1),JSON['stringify'](config));}function deleteBot(_0x1f84b8){const _0x143f78=_0x3ff819;getClientsWithBotID(_0x1f84b8)[_0x143f78(0x222)](_0xa4a542=>{const _0x46ab48=_0x143f78;getSocket(_0xa4a542['id'])[_0x46ab48(0x21f)](!![]),removeClient(_0xa4a542['id']);}),dbConfig['get'](_0x143f78(0x2c1))[_0x143f78(0x2a5)]({'botID':_0x1f84b8})[_0x143f78(0x2af)](),logger['full'](_0x143f78(0x156)+_0x1f84b8),stopBot(_0x1f84b8);try{if(fs[_0x143f78(0x164)](path[_0x143f78(0x1d5)](configpath,_0x143f78(0x2e6)+_0x1f84b8+_0x143f78(0x19b))))fs['unlinkSync'](path[_0x143f78(0x1d5)](configpath,'bot-'+_0x1f84b8+_0x143f78(0x19b)));if(fs[_0x143f78(0x164)](path[_0x143f78(0x1d5)](configpath,_0x143f78(0x2e6)+_0x1f84b8+_0x143f78(0x2b7))))fs[_0x143f78(0x1a3)](path[_0x143f78(0x1d5)](configpath,_0x143f78(0x2e6)+_0x1f84b8+_0x143f78(0x2b7)));if(fs[_0x143f78(0x164)](path[_0x143f78(0x1d5)](configpath,_0x143f78(0x2e6)+_0x1f84b8+_0x143f78(0x297))))fs[_0x143f78(0x1a3)](path[_0x143f78(0x1d5)](configpath,_0x143f78(0x2e6)+_0x1f84b8+_0x143f78(0x297)));if(fs[_0x143f78(0x164)](path[_0x143f78(0x1d5)](configpath,_0x143f78(0x2e6)+_0x1f84b8+'-results.json')))fs[_0x143f78(0x1a3)](path[_0x143f78(0x1d5)](configpath,'bot-'+_0x1f84b8+'-results.json'));}catch(_0x46c468){if(_0x46c468)logger[_0x143f78(0x2ae)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x46c468);}config=getConfiguration(),io['to']('botmanager')[_0x143f78(0x1fa)]('bots',config),broadcastToBots(_0x143f78(0x2c1),JSON[_0x143f78(0x152)](config));}function toggleBot(_0x5e4bf8,_0x223eab,_0x157634){const _0x2ea4de=_0x3ff819;dbConfig[_0x2ea4de(0x2d5)](_0x2ea4de(0x2c1))['find']({'botID':_0x5e4bf8})['assign']({'status':_0x223eab})[_0x2ea4de(0x1cd)]({'live':_0x157634})[_0x2ea4de(0x2af)]();if(_0x223eab==_0x2ea4de(0x228)||_0x223eab==_0x2ea4de(0x1a9))logger[_0x2ea4de(0x2ae)](_0x2ea4de(0x300)+_0x5e4bf8),startBot([_0x5e4bf8,userID],{'cwd':bbpath},function(_0xbe9237){const _0x159b60=_0x2ea4de;if(_0xbe9237)logger[_0x159b60(0x2ae)](_0xbe9237);});else(_0x223eab==_0x2ea4de(0x28a)||_0x223eab==_0x2ea4de(0x227))&&(logger[_0x2ea4de(0x2ae)](_0x2ea4de(0x2e0)+_0x5e4bf8),stopBot(_0x5e4bf8));config=getConfiguration(),io['to'](_0x2ea4de(0x2cd))[_0x2ea4de(0x1fa)]('bots',config),broadcastToBots(_0x2ea4de(0x2c1),JSON['stringify'](config));}function toggleStatus(_0x3ccd75){const _0x11a7c9=_0x3ff819;let _0x23fa16=dbConfig[_0x11a7c9(0x2d5)](_0x11a7c9(0x2c1))[_0x11a7c9(0x23e)]({'botID':_0x3ccd75})['value'](),_0x46ed77;if(_0x23fa16[_0x11a7c9(0x1c9)]===_0x11a7c9(0x228))_0x46ed77=_0x11a7c9(0x28a);else{if(_0x23fa16[_0x11a7c9(0x1c9)]===_0x11a7c9(0x1a9))_0x46ed77='new-disabled';else{if(_0x23fa16[_0x11a7c9(0x1c9)]===_0x11a7c9(0x227))_0x46ed77=_0x11a7c9(0x1a9);else{if(_0x23fa16['status']==='disabled')_0x46ed77=_0x11a7c9(0x228);}}}return _0x46ed77;}function _0x59b9(){const _0x2b9676=['\x20|\x20client:\x20...','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','logout','lastmsgtelegram','output-002.log','bb-settings.json','copyFileSync','reinstall-bb','reset-password','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','decrypt','expiry','secret','manual','Bot\x20','mkdirSync','temp/','warning','\x20|\x20','store-configuration','onepagemode','push','1621908rfuLiC','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegramChatId','hashSync','/download/:type','params','generate','RSA','disconnect','kind','2FA\x20login\x20token\x20generated','forEach','userid','\x20only\x0a','RSA-OAEP','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','new-disabled','enabled','Invalid\x20username\x20or\x20IP\x20address','botID','alias','Invalid\x20authentication\x20token\x20(2)','showConfig','bbUsername','storeConfiguration','uuid-random','isValid','Ok,\x20will\x20send\x20alert\x20notifications\x20only','restart','getStartingBalances','logged\x20out','isDirectory','update','/output-000.log','telegram','file','Restoring\x20bot(s)\x20from\x20backup','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Yes','find','HTML','compareSync','notification','util','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','includes','toIPv4Address','Notifications\x20enabled','Starting\x20Balance\x20Bot\x20','backup','exchange','Unauthorized\x20attempt\x20to\x20get\x20messages','min','showname','get-logs','Restore\x20backup\x20file\x20','latestversion','getMinutes','Invalid\x20authentication\x20token\x20(1)','temporary\x20access\x20rejected','whitelist','telegramToken','bot','lowdb','success','env','resetHistory','readdirSync','output-001.log','number','#RES#\x20if\x20running\x20locally\x0a','127.0.0.1','Starting\x20new\x20bot\x20|\x20Bot\x20','backup-full@','get-portfolio','delete-alerts','All','/help\x20-\x20show\x20available\x20commands\x0a','publicKey','\x20>\x20','token',':\x20Bot\x20Mgr\x20>\x20','config/','reject','Invalid\x20Telegram\x20token','timeshift','title','statSync','mixpanel','node-zip','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20update\x20bot','ipv6','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/:bot/portfolio','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','download','/on\x20-\x20start\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','range','access\x20timeout','</b>\x20?','2FA\x20login\x20required','defaults','404\x20Not\x20Found','0.0.0','from','bbPassword','login\x20not\x20required','exit','messages','2FA','telegramEnabled','disabled','telegram2FaApproval','_data','File\x20uploaded','server','getHours','padStart','backup-files','timestamp','getFullYear','login','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20confirm\x20message','-performance.json','sort','telegramIpApproval','/:bot/support','started','cloneDeep','settings.','backup-full.zip','store-settings','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','hybrid-crypto-js','event','=>\x20Go\x20to\x20#CYA#http://','remove','bb-secure.json','inherit','chat','::ffff:127.0.0.1','conn','ipaddr.js','error','max','full','write','versions','deleteHistoryAlerts','randomFillSync','family','apiKey','11723901ZbtMgD','Logged\x20in\x20user\x20...','-events.json','apiPassword','stopPolling','yargs/yargs','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','remoteAddress','sendMessage','clients','1193368RToMVq','split','bots','readFileSync','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','settings','toIPv4MappedAddress','startsWith','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','running','place-order','sortBy','toggleBotMode','botmanager','[ip-address]','kill','5807208QcKqBs','tkn','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Alerts','Bot\x20Mgr\x20>\x20','get','length','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Backup\x20file\x20uploaded','ipc','slice','.zip','zip/','use','confirm-message','answerCallbackQuery','Disabled\x20Bot\x20','apiSecret','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','backup/','Unauthorized\x20attempt\x20to\x20log\x20out','\x1b[33m','bot-','isIPv4MappedAddress','build2','output-003.log','botname','whitelistEnabled','************','Starting\x20bot\x20|\x20Bot\x20','api-eu.mixpanel.com','auth','Invalid\x20IP\x20address','keys','6b67f3d61ee94b8f5c80b4affef4c4d9','store','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','order','debug','set','Orders','exp','bb/','createServer','store-fiat','Unauthorized\x20attempt\x20to\x20download\x20','callback_query','placeOrder','Enabled\x20Bot\x20','cancel-loading','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','hasOwnProperty','/disable\x20-\x20disable\x20notifications\x0a','update-bb','Ok,\x20will\x20send\x20order\x20notifications\x20only','express','value','Restore\x20process\x20aborted','jsonwebtoken','username','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','f2aRequired','/:bot/history','type','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Notifications\x20enabled\x0a','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','encryptedUuid','child_process','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/metrics\x20-\x20show\x20bot\x20performance\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','sendFile','Failed\x20to\x20download\x20','1750496wzvzZh','delete-bot','Temporary\x20access\x20rejected','\x20minutes','User\x20has\x20been\x20validated','getMonth','port',',\x20must\x20be\x20a\x204\x20digit\x20number','getTime','socket','::1','getSeconds','Crypt','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','filter','date-fns','pidRefreshToken','reinstall','pidExpireLogin','createWriteStream','*$1*','Backup\x20file\x20unzipped\x20and\x20stored','8120544qYXYCJ','\x20mode','temporary\x20access\x20not\x20allowed','stringify','version','handshake','index.html','Deleted\x20Bot\x20','parse','2FA\x20required','format','secure','http','lastmsgemitted','update-bot','store-headless','get-messages','address','\x20(2)','Error:\x20Invalid\x20argument\x20','30\x20min','existsSync','***','telegramEvents','message','alerts','search','Logged\x20out\x20user\x20...','simple','then','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','files','mode','restore-backup-file','login\x20required','output-000.log','yes','bbvReceive','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','toString','private','version.json','Unauthorized\x20attempt\x20to\x20get\x20portfolio','temporary\x20access\x20timeout','/:bot/coins','show','writeFileSync','sendPortfolioTelegram','logs/','connection','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','allow','All\x20bots','replace','log','(((.+)+)+)+$','#RES#\x20if\x20running\x20on\x20server','build','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','post',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','match','crypto','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','uuid','hex','Login\x20accepted','onText','bb-config.json','stopped','/enable\x20-\x20enable\x20notifications\x0a','function','No\x20authentication\x20token','show-config','emitHistory','-config.json','15\x20min','8615790yMThfs','exec','bbvNew','test','headless','host','unlinkSync','Markdown','telegrammsg','access','reset-history','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','new','password','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','catch','logs','bot.js','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','get-backup-files','verify','toggle-bot-mode','axios','orders','stop','sign','removeAllListeners','Unauthorized\x20attempt\x20to\x20delete\x20alerts','args','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','blacklist','Idling\x20bot\x20\x20\x20|\x20Bot\x20','sha256','4ZCPuoU','backupfile','invalid\x20credentials','privateKey','add-bot','Setting\x20access:\x20','storeHeadless','Access\x20enabled\x20for\x20','live','once','clientip','status','Restarting\x20Bot\x20','apply','/update\x20-\x20update\x20Balance\x20Bot\x0a','assign','Unauthorized\x20attempt\x20to\x20get\x20events','All\x20bots\x20running\x20right\x20now','headers','referer','login\x20token\x20generated','temporary\x20token\x20generated','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','join','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','auto','loginRequired','string','static','-----------------------------------------------------------------------------------','2FA\x20login\x20rejected','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','telegramUsername','NTBA_FIX_319','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','storeFiat','binary','Starting\x20#RED#Balance\x20Bot\x20v','size','https://api.ipify.org?format=json','rmSync','<b>Telegram\x20Bot\x20Status:</b>\x0a','updatebotmanager','sendMetricsTelegram','reason','getDate','user','getPortfolio','send','Node.js\x20v','data','endsWith','name','internal','all','/restart\x20-\x20restart\x20bot(s)\x0a','sockets','3000','reload','removeListener','emit','No\x20bots\x20running\x20right\x20now','Notifications\x20types:\x20','lowdb/adapters/FileSync','request','backup-full','/:bot/performance'];_0x59b9=function(){return _0x2b9676;};return _0x59b9();}function updateStatus(_0xa7869d,_0x2abd97){const _0x3fe012=_0x3ff819;dbConfig[_0x3fe012(0x2d5)]('bots')[_0x3fe012(0x23e)]({'botID':_0xa7869d})[_0x3fe012(0x1cd)]({'status':_0x2abd97})[_0x3fe012(0x2af)](),config=getConfiguration(),io['to'](_0x3fe012(0x2cd))[_0x3fe012(0x1fa)](_0x3fe012(0x2c1),config),broadcastToBots(_0x3fe012(0x2c1),JSON[_0x3fe012(0x152)](config));}function updateLive(_0x1bfa23,_0x13972b){const _0x4a9b04=_0x3ff819;dbConfig[_0x4a9b04(0x2d5)](_0x4a9b04(0x2c1))['find']({'botID':_0x1bfa23})[_0x4a9b04(0x1cd)]({'live':_0x13972b})['write'](),config=getConfiguration(),io['to'](_0x4a9b04(0x2cd))[_0x4a9b04(0x1fa)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x3ac22b,_0x519b72){const _0x26ec53=_0x3ff819;dbConfig[_0x26ec53(0x2d5)]('bots')[_0x26ec53(0x23e)]({'botID':_0x3ac22b})[_0x26ec53(0x1cd)]({'botname':_0x519b72})[_0x26ec53(0x2af)](),config=getConfiguration(),io['to'](_0x26ec53(0x2cd))[_0x26ec53(0x1fa)](_0x26ec53(0x2c1),config),broadcastToBots(_0x26ec53(0x2c1),JSON['stringify'](config));}function updateBotManager(){const _0x2c29b6=_0x3ff819;config=getConfiguration(),io['to'](_0x2c29b6(0x2cd))['emit'](_0x2c29b6(0x2c1),config),broadcastToBots(_0x2c29b6(0x2c1),JSON[_0x2c29b6(0x152)](config));}function toggleBotMode(_0x414e46){const _0x35a4c6=_0x3ff819;if(pid[_0x414e46])pid[_0x414e46][_0x35a4c6(0x1ee)]({'function':_0x35a4c6(0x2cc),'args':null});else{const _0x27340d=configpath+_0x35a4c6(0x2e6)+_0x414e46+'-config.json',_0x2e5652=fs['readFileSync'](_0x27340d),_0x2b6869=JSON[_0x35a4c6(0x157)](_0x2e5652),_0x4e632a=_0x2b6869[_0x35a4c6(0x256)][0x0][_0x35a4c6(0x1a1)];_0x2b6869[_0x35a4c6(0x256)][0x0][_0x35a4c6(0x1a1)]=!_0x4e632a;const _0x5a5147=JSON['stringify'](_0x2b6869,null,0x2);fs[_0x35a4c6(0x17e)](_0x27340d,_0x5a5147),config=getConfiguration(),io['to'](_0x35a4c6(0x2cd))[_0x35a4c6(0x1fa)](_0x35a4c6(0x2c1),config),broadcastToBots('bots',JSON[_0x35a4c6(0x152)](config));}}function telegramError(_0x440793){const _0x27e4b0=_0x3ff819;logger[_0x27e4b0(0x16b)](getTimeStamp()+_0x27e4b0(0x18c));}function validateTelegram(_0x5cd72b){const _0x571407=_0x3ff819;if(_0x5cd72b['from'][_0x571407(0x30b)]!=settings[_0x571407(0x1de)]&&'@'+_0x5cd72b[_0x571407(0x283)][_0x571407(0x30b)]!=settings['telegramUsername'])return tgBot[_0x571407(0x2bd)](_0x5cd72b['chat']['id'],_0x571407(0x1ab),{'parse_mode':_0x571407(0x23f)})[_0x571407(0x1ac)](_0x2acea1=>{telegramError(_0x2acea1);}),![];return!![];}async function initTelegram(){const _0x4822b6=_0x3ff819;if(tgBot)tgBot[_0x4822b6(0x2b9)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x1ec86d='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x1ec86d+='\x0a',_0x1ec86d+=_0x4822b6(0x196),_0x1ec86d+=_0x4822b6(0x304),_0x1ec86d+=_0x4822b6(0x23c),_0x1ec86d+=_0x4822b6(0x1f5),_0x1ec86d+=_0x4822b6(0x27a),_0x1ec86d+='/off\x20-\x20stop\x20bot(s)\x0a',_0x1ec86d+=_0x4822b6(0x226),_0x1ec86d+='/names\x20-\x20show\x20bot\x20names\x0a',_0x1ec86d+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1ec86d+=_0x4822b6(0x316),_0x1ec86d+=_0x4822b6(0x2e2),_0x1ec86d+=_0x4822b6(0x1cc),_0x1ec86d+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x1ec86d+=_0x4822b6(0x265);let _0x2d22a7=_0x4822b6(0x2a0);_0x2d22a7+='\x0a',_0x2d22a7+=_0x1ec86d,tgBot[_0x4822b6(0x193)](/\/start/,_0x6044ac=>{const _0x30ae7e=_0x4822b6;if(!validateTelegram(_0x6044ac))return;if(settings[_0x30ae7e(0x219)]!=_0x6044ac['chat']['id'])updateSetting(_0x30ae7e(0x219),_0x6044ac[_0x30ae7e(0x2a8)]['id']);updateSetting(_0x30ae7e(0x289),!![]),tgBot[_0x30ae7e(0x2bd)](_0x6044ac[_0x30ae7e(0x2a8)]['id'],_0x2d22a7)[_0x30ae7e(0x1ac)](_0x5223f7=>{telegramError(_0x5223f7);});}),tgBot[_0x4822b6(0x193)](/\/enable/,_0x4b377d=>{const _0x35217d=_0x4822b6;if(!validateTelegram(_0x4b377d))return;if(settings[_0x35217d(0x219)]!=_0x4b377d[_0x35217d(0x2a8)]['id'])updateSetting(_0x35217d(0x219),_0x4b377d[_0x35217d(0x2a8)]['id']);updateSetting(_0x35217d(0x289),!![]),tgBot['sendMessage'](_0x4b377d[_0x35217d(0x2a8)]['id'],_0x35217d(0x247))[_0x35217d(0x1ac)](_0x22bc20=>{telegramError(_0x22bc20);});}),tgBot['onText'](/\/config/,async _0x2299dc=>{const _0x1f84e7=_0x4822b6;if(!validateTelegram(_0x2299dc))return;tgBot[_0x1f84e7(0x1f9)](_0x1f84e7(0x2fe)),tgBot[_0x1f84e7(0x2bd)](_0x2299dc[_0x1f84e7(0x2a8)]['id'],_0x1f84e7(0x2bb),{'reply_markup':{'inline_keyboard':[[{'text':_0x1f84e7(0x2f8),'callback_data':_0x1f84e7(0x1b4)},{'text':_0x1f84e7(0x2d3),'callback_data':_0x1f84e7(0x168)},{'text':_0x1f84e7(0x264),'callback_data':_0x1f84e7(0x1f4)}]]}})[_0x1f84e7(0x1ac)](_0x2249e8=>{telegramError(_0x2249e8);}),tgBot['on'](_0x1f84e7(0x2fe),async _0x574821=>{const _0x19dd70=_0x1f84e7,_0xfe47fd=_0x574821[_0x19dd70(0x1f0)],_0x4501d5=_0x574821['message'];tgBot['answerCallbackQuery'](_0x574821['id'])[_0x19dd70(0x16c)](async()=>{const _0x1ad851=_0x19dd70;_0xfe47fd=='orders'&&(updateSetting(_0x1ad851(0x166),_0x1ad851(0x1b4)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x4501d5[_0x1ad851(0x2a8)]['id'],_0x1ad851(0x306))['catch'](_0x773bee=>{telegramError(_0x773bee);}));_0xfe47fd==_0x1ad851(0x168)&&(updateSetting(_0x1ad851(0x166),'alerts'),updateSetting(_0x1ad851(0x289),!![]),await tgBot[_0x1ad851(0x2bd)](_0x4501d5[_0x1ad851(0x2a8)]['id'],_0x1ad851(0x232))['catch'](_0xc24dba=>{telegramError(_0xc24dba);}));_0xfe47fd==_0x1ad851(0x1f4)&&(updateSetting(_0x1ad851(0x166),_0x1ad851(0x1f4)),updateSetting(_0x1ad851(0x289),!![]),await tgBot[_0x1ad851(0x2bd)](_0x4501d5[_0x1ad851(0x2a8)]['id'],_0x1ad851(0x18a))[_0x1ad851(0x1ac)](_0x3e154b=>{telegramError(_0x3e154b);}));if(!settings['telegramChatId'])tgBot[_0x1ad851(0x2bd)](_0x4501d5['chat']['id'],_0x1ad851(0x1d4))[_0x1ad851(0x1ac)](_0x399e64=>{telegramError(_0x399e64);});}),tgBot[_0x19dd70(0x1f9)](_0x19dd70(0x2fe));});}),tgBot[_0x4822b6(0x193)](/\/status/,_0x1e9934=>{const _0x55edf6=_0x4822b6;if(!validateTelegram(_0x1e9934))return;const _0x2a0171=getBotsWithMode();let _0x47348d='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x55edf6(0x222)](_0x4e4420=>{const _0x3e4c49=_0x55edf6,_0x31e233=_0x2a0171[_0x3e4c49(0x23e)](_0x5436f6=>_0x5436f6['botID']==_0x4e4420['botID'])[_0x3e4c49(0x16f)];_0x47348d+=_0x3e4c49(0x20f)+_0x4e4420[_0x3e4c49(0x22a)]+':\x20'+_0x4e4420[_0x3e4c49(0x1c9)]+'\x20|\x20'+_0x31e233+_0x3e4c49(0x213)+_0x4e4420[_0x3e4c49(0x1c6)]+'\x0a';}),_0x47348d+='\x0a',_0x47348d+=_0x55edf6(0x1e7),_0x47348d+=!settings[_0x55edf6(0x289)]?'Notifications\x20disabled\x0a':_0x55edf6(0x311),_0x47348d+=settings[_0x55edf6(0x289)]?settings['telegramEvents']==_0x55edf6(0x1f4)?_0x55edf6(0x1af):_0x55edf6(0x1fc)+settings['telegramEvents']+_0x55edf6(0x224):'',tgBot[_0x55edf6(0x2bd)](_0x1e9934[_0x55edf6(0x2a8)]['id'],_0x47348d,{'parse_mode':_0x55edf6(0x23f)})[_0x55edf6(0x1ac)](_0x295802=>{telegramError(_0x295802);});}),tgBot[_0x4822b6(0x193)](/\/restart/,_0x50d977=>{const _0x5cddd7=_0x4822b6;if(!validateTelegram(_0x50d977))return;tgBot[_0x5cddd7(0x1f9)](_0x5cddd7(0x2fe));const _0x58db33=getEnabledBots();if(_0x58db33[_0x5cddd7(0x2d6)]==0x0)tgBot[_0x5cddd7(0x2bd)](_0x50d977['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x5cddd7(0x1ac)](_0x266c6e=>{telegramError(_0x266c6e);});else{if(_0x58db33[_0x5cddd7(0x2d6)]>0x1)_0x58db33[_0x5cddd7(0x216)]({'botID':_0x5cddd7(0x1f4)});let _0x1d8796=[],_0x2a04a6=[];const _0x32b8bd=_0x58db33[_0x5cddd7(0x2d6)]%0x4==0x0||_0x58db33[_0x5cddd7(0x2d6)]%0x4==0x3||_0x58db33[_0x5cddd7(0x2d6)]%0x3==0x1?0x4:0x3;let _0x430a50=0x0;_0x58db33[_0x5cddd7(0x222)]((_0x148bfd,_0x4ac71e)=>{const _0x353e0b=_0x5cddd7;if(_0x4ac71e%_0x32b8bd==0x0)_0x2a04a6=[];_0x2a04a6[_0x353e0b(0x216)]({'text':_0x148bfd[_0x353e0b(0x22a)]==_0x353e0b(0x1f4)?_0x353e0b(0x184):_0x353e0b(0x20f)+_0x148bfd[_0x353e0b(0x22a)],'callback_data':_0x148bfd['botID']}),_0x4ac71e%_0x32b8bd==0x0&&(_0x1d8796[_0x430a50]=_0x2a04a6,_0x430a50++);}),tgBot[_0x5cddd7(0x2bd)](_0x50d977[_0x5cddd7(0x2a8)]['id'],_0x5cddd7(0x310),{'reply_markup':{'inline_keyboard':_0x1d8796}})['catch'](_0x12cba3=>{telegramError(_0x12cba3);}),tgBot['on']('callback_query',async _0xfeec50=>{const _0x386345=_0x5cddd7,_0x11afc8=_0xfeec50[_0x386345(0x1f0)],_0x1b9f53=_0xfeec50['message'];tgBot[_0x386345(0x2df)](_0xfeec50['id'])['then'](async()=>{const _0x17b729=_0x386345;_0x11afc8==_0x17b729(0x1f4)?config[_0x17b729(0x222)](_0x53e8ae=>{const _0x5d7b72=_0x17b729;restartBot(_0x53e8ae[_0x5d7b72(0x22a)]);}):restartBot(_0x11afc8);}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/on/,_0x34637e=>{const _0xfb6b42=_0x4822b6;if(!validateTelegram(_0x34637e))return;tgBot['removeListener'](_0xfb6b42(0x2fe));const _0xfbc432=getDisabledBots();if(_0xfbc432[_0xfb6b42(0x2d6)]==0x0)tgBot[_0xfb6b42(0x2bd)](_0x34637e[_0xfb6b42(0x2a8)]['id'],_0xfb6b42(0x1cf))[_0xfb6b42(0x1ac)](_0x54a6f5=>{telegramError(_0x54a6f5);});else{if(_0xfbc432['length']>0x1)_0xfbc432[_0xfb6b42(0x216)]({'botID':_0xfb6b42(0x1f4)});let _0x20dd1c=[],_0x4c5e9e=[];const _0x595760=_0xfbc432[_0xfb6b42(0x2d6)]%0x4==0x0||_0xfbc432[_0xfb6b42(0x2d6)]%0x4==0x3||_0xfbc432[_0xfb6b42(0x2d6)]%0x3==0x1?0x4:0x3;let _0x3bb7e1=0x0;_0xfbc432['forEach']((_0x293b1b,_0x37589e)=>{const _0x56036f=_0xfb6b42;if(_0x37589e%_0x595760==0x0)_0x4c5e9e=[];_0x4c5e9e[_0x56036f(0x216)]({'text':_0x293b1b['botID']==_0x56036f(0x1f4)?_0x56036f(0x184):_0x56036f(0x20f)+_0x293b1b[_0x56036f(0x22a)],'callback_data':_0x293b1b[_0x56036f(0x22a)]}),_0x37589e%_0x595760==0x0&&(_0x20dd1c[_0x3bb7e1]=_0x4c5e9e,_0x3bb7e1++);}),tgBot['sendMessage'](_0x34637e[_0xfb6b42(0x2a8)]['id'],_0xfb6b42(0x302),{'reply_markup':{'inline_keyboard':_0x20dd1c}})['catch'](_0x56ff45=>{telegramError(_0x56ff45);}),tgBot['on'](_0xfb6b42(0x2fe),async _0x21c5d4=>{const _0x3b1218=_0xfb6b42,_0x2750e7=_0x21c5d4[_0x3b1218(0x1f0)],_0x35fd21=_0x21c5d4[_0x3b1218(0x167)];tgBot['answerCallbackQuery'](_0x21c5d4['id'])[_0x3b1218(0x16c)](async()=>{const _0x52e743=_0x3b1218;_0x2750e7=='all'?(tgBot['sendMessage'](_0x35fd21[_0x52e743(0x2a8)]['id'],_0x52e743(0x18f))[_0x52e743(0x1ac)](_0x41b483=>{telegramError(_0x41b483);}),_0xfbc432[_0x52e743(0x222)](_0x3b1e6c=>{const _0x5ab314=_0x52e743;if(_0x3b1e6c[_0x5ab314(0x22a)]!='all')toggleBot(_0x3b1e6c[_0x5ab314(0x22a)],toggleStatus(_0x3b1e6c[_0x5ab314(0x22a)]),_0x5ab314(0x195));})):(tgBot[_0x52e743(0x2bd)](_0x35fd21[_0x52e743(0x2a8)]['id'],_0x52e743(0x27b)+_0x2750e7)[_0x52e743(0x1ac)](_0x49029d=>{telegramError(_0x49029d);}),toggleBot(_0x2750e7,toggleStatus(_0x2750e7),_0x52e743(0x195)));}),tgBot['removeListener'](_0x3b1218(0x2fe));});}}),tgBot[_0x4822b6(0x193)](/\/off/,_0x2da895=>{const _0x5d9d20=_0x4822b6;if(!validateTelegram(_0x2da895))return;tgBot[_0x5d9d20(0x1f9)](_0x5d9d20(0x2fe));const _0x42c8c5=getEnabledBots();if(_0x42c8c5[_0x5d9d20(0x2d6)]==0x0)tgBot[_0x5d9d20(0x2bd)](_0x2da895['chat']['id'],_0x5d9d20(0x1fb))[_0x5d9d20(0x1ac)](_0x48c612=>{telegramError(_0x48c612);});else{if(_0x42c8c5[_0x5d9d20(0x2d6)]>0x1)_0x42c8c5[_0x5d9d20(0x216)]({'botID':'all'});let _0x1d7367=[],_0xbdf0a7=[];const _0x2e3222=_0x42c8c5[_0x5d9d20(0x2d6)]%0x4==0x0||_0x42c8c5[_0x5d9d20(0x2d6)]%0x4==0x3||_0x42c8c5[_0x5d9d20(0x2d6)]%0x3==0x1?0x4:0x3;let _0x2fa2a8=0x0;_0x42c8c5[_0x5d9d20(0x222)]((_0x3fadee,_0x55d7fa)=>{const _0x4a5bc3=_0x5d9d20;if(_0x55d7fa%_0x2e3222==0x0)_0xbdf0a7=[];_0xbdf0a7['push']({'text':_0x3fadee[_0x4a5bc3(0x22a)]=='all'?'All\x20bots':_0x4a5bc3(0x20f)+_0x3fadee[_0x4a5bc3(0x22a)],'callback_data':_0x3fadee[_0x4a5bc3(0x22a)]}),_0x55d7fa%_0x2e3222==0x0&&(_0x1d7367[_0x2fa2a8]=_0xbdf0a7,_0x2fa2a8++);}),tgBot[_0x5d9d20(0x2bd)](_0x2da895[_0x5d9d20(0x2a8)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x1d7367}})[_0x5d9d20(0x1ac)](_0x1b7539=>{telegramError(_0x1b7539);}),tgBot['on'](_0x5d9d20(0x2fe),async _0x468560=>{const _0x3afcb7=_0x5d9d20,_0x39d52d=_0x468560['data'],_0x3c3dba=_0x468560['message'];tgBot['answerCallbackQuery'](_0x468560['id'])['then'](async()=>{const _0x3812b9=_0x5e83;_0x39d52d==_0x3812b9(0x1f4)?(tgBot['sendMessage'](_0x3c3dba[_0x3812b9(0x2a8)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x3812b9(0x1ac)](_0x4d0f99=>{telegramError(_0x4d0f99);}),_0x42c8c5[_0x3812b9(0x222)](_0x16863b=>{const _0x3313b1=_0x3812b9;if(_0x16863b[_0x3313b1(0x22a)]!=_0x3313b1(0x1f4))toggleBot(_0x16863b[_0x3313b1(0x22a)],toggleStatus(_0x16863b['botID']),_0x3313b1(0x195));})):(tgBot[_0x3812b9(0x2bd)](_0x3c3dba[_0x3812b9(0x2a8)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x39d52d)[_0x3812b9(0x1ac)](_0x56756f=>{telegramError(_0x56756f);}),toggleBot(_0x39d52d,toggleStatus(_0x39d52d),'stopped'));}),tgBot[_0x3afcb7(0x1f9)]('callback_query');});}}),tgBot[_0x4822b6(0x193)](/\/metrics/,_0x2def6d=>{const _0x13d701=_0x4822b6;if(!validateTelegram(_0x2def6d))return;tgBot['removeListener']('callback_query');const _0x544556=getEnabledBots();if(_0x544556[_0x13d701(0x2d6)]==0x0)tgBot[_0x13d701(0x2bd)](_0x2def6d['chat']['id'],_0x13d701(0x1fb))[_0x13d701(0x1ac)](_0x14ad78=>{telegramError(_0x14ad78);});else{if(_0x544556[_0x13d701(0x2d6)]>0x1){let _0x3d8d31=[],_0x41192f=[];const _0x23a23d=_0x544556[_0x13d701(0x2d6)]%0x4==0x0||_0x544556[_0x13d701(0x2d6)]%0x4==0x3||_0x544556[_0x13d701(0x2d6)]%0x3==0x1?0x4:0x3;let _0x457ab5=0x0;_0x544556[_0x13d701(0x222)]((_0x507b4c,_0x42c811)=>{const _0x1a8347=_0x13d701;if(_0x42c811%_0x23a23d==0x0)_0x41192f=[];_0x41192f[_0x1a8347(0x216)]({'text':_0x1a8347(0x20f)+_0x507b4c[_0x1a8347(0x22a)],'callback_data':_0x507b4c['botID']}),_0x42c811%_0x23a23d==0x0&&(_0x3d8d31[_0x457ab5]=_0x41192f,_0x457ab5++);}),tgBot[_0x13d701(0x2bd)](_0x2def6d['chat']['id'],_0x13d701(0x2a1),{'reply_markup':{'inline_keyboard':_0x3d8d31}})['catch'](_0x33a002=>{telegramError(_0x33a002);}),tgBot['on'](_0x13d701(0x2fe),async _0x57440d=>{const _0x12d22c=_0x13d701,_0x1e8426=_0x57440d[_0x12d22c(0x1f0)],_0x156b07=_0x57440d[_0x12d22c(0x167)];tgBot['answerCallbackQuery'](_0x57440d['id'])['then'](async()=>{const _0x1c69aa=_0x12d22c;if(pid[_0x1e8426])pid[_0x1e8426]['send']({'function':_0x1c69aa(0x1e9),'args':null});}),tgBot[_0x12d22c(0x1f9)](_0x12d22c(0x2fe));});}else{const _0xb53676=_0x544556[0x0][_0x13d701(0x22a)];if(pid[_0xb53676])pid[_0xb53676]['send']({'function':_0x13d701(0x1e9),'args':null});}}}),tgBot[_0x4822b6(0x193)](/\/portfolio/,_0x529a61=>{const _0x4e1403=_0x4822b6;if(!validateTelegram(_0x529a61))return;tgBot[_0x4e1403(0x1f9)](_0x4e1403(0x2fe));const _0x511397=getEnabledBots();if(_0x511397[_0x4e1403(0x2d6)]==0x0)tgBot['sendMessage'](_0x529a61['chat']['id'],_0x4e1403(0x1fb))[_0x4e1403(0x1ac)](_0x277028=>{telegramError(_0x277028);});else{if(_0x511397[_0x4e1403(0x2d6)]>0x1){let _0x52a366=[],_0x2e22d8=[];const _0x5b7066=_0x511397[_0x4e1403(0x2d6)]%0x4==0x0||_0x511397[_0x4e1403(0x2d6)]%0x4==0x3||_0x511397['length']%0x3==0x1?0x4:0x3;let _0x530f1b=0x0;_0x511397[_0x4e1403(0x222)]((_0x202e2f,_0xdcc101)=>{const _0x268900=_0x4e1403;if(_0xdcc101%_0x5b7066==0x0)_0x2e22d8=[];_0x2e22d8[_0x268900(0x216)]({'text':'Bot\x20'+_0x202e2f[_0x268900(0x22a)],'callback_data':_0x202e2f['botID']}),_0xdcc101%_0x5b7066==0x0&&(_0x52a366[_0x530f1b]=_0x2e22d8,_0x530f1b++);}),tgBot['sendMessage'](_0x529a61['chat']['id'],_0x4e1403(0x182),{'reply_markup':{'inline_keyboard':_0x52a366}})[_0x4e1403(0x1ac)](_0x26fcf2=>{telegramError(_0x26fcf2);}),tgBot['on']('callback_query',async _0xcde4e3=>{const _0x387935=_0x4e1403,_0x4f303f=_0xcde4e3[_0x387935(0x1f0)],_0x360ef3=_0xcde4e3[_0x387935(0x167)];tgBot[_0x387935(0x2df)](_0xcde4e3['id'])[_0x387935(0x16c)](async()=>{const _0x5a0ce7=_0x387935;if(pid[_0x4f303f])pid[_0x4f303f][_0x5a0ce7(0x1ee)]({'function':_0x5a0ce7(0x17f),'args':null});}),tgBot[_0x387935(0x1f9)](_0x387935(0x2fe));});}else{const _0x771dbd=_0x511397[0x0][_0x4e1403(0x22a)];if(pid[_0x771dbd])pid[_0x771dbd][_0x4e1403(0x1ee)]({'function':_0x4e1403(0x17f),'args':null});}}}),tgBot[_0x4822b6(0x193)](/\/update/,async _0x448cd6=>{const _0x54b80f=_0x4822b6;if(!validateTelegram(_0x448cd6))return;tgBot[_0x54b80f(0x1f9)](_0x54b80f(0x2fe)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x448cd6[_0x54b80f(0x2a8)]['id'],_0x54b80f(0x315))[_0x54b80f(0x1ac)](_0x402342=>{telegramError(_0x402342);});else!validInstallation?tgBot[_0x54b80f(0x2bd)](_0x448cd6[_0x54b80f(0x2a8)]['id'],_0x54b80f(0x2c4))[_0x54b80f(0x1ac)](_0x45cfd0=>{telegramError(_0x45cfd0);}):(tgBot[_0x54b80f(0x2bd)](_0x448cd6[_0x54b80f(0x2a8)]['id'],_0x54b80f(0x30c),{'reply_markup':{'inline_keyboard':[[{'text':_0x54b80f(0x23d),'callback_data':_0x54b80f(0x173)},{'text':'No','callback_data':'no'}]]}})['catch'](_0xf562fe=>{telegramError(_0xf562fe);}),tgBot['on'](_0x54b80f(0x2fe),async _0x5dadc3=>{const _0x2697d7=_0x54b80f,_0x411e82=_0x5dadc3[_0x2697d7(0x1f0)],_0xa7bc07=_0x5dadc3['message'];tgBot[_0x2697d7(0x2df)](_0x5dadc3['id'])[_0x2697d7(0x16c)](async()=>{const _0x47e351=_0x2697d7;_0x411e82==_0x47e351(0x173)&&(await tgBot[_0x47e351(0x2bd)](_0xa7bc07['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x47e351(0x1ac)](_0xfa109a=>{telegramError(_0xfa109a);}),updateBB(_0x47e351(0x237))),_0x411e82=='no'&&await tgBot[_0x47e351(0x2bd)](_0xa7bc07[_0x47e351(0x2a8)]['id'],_0x47e351(0x202))[_0x47e351(0x1ac)](_0xea9926=>{telegramError(_0xea9926);});}),tgBot['removeListener'](_0x2697d7(0x2fe));}));}),tgBot[_0x4822b6(0x193)](/\/reinstall/,async _0xf108ae=>{const _0x124aac=_0x4822b6;if(!validateTelegram(_0xf108ae))return;tgBot[_0x124aac(0x1f9)](_0x124aac(0x2fe)),!validInstallation?tgBot[_0x124aac(0x2bd)](_0xf108ae[_0x124aac(0x2a8)]['id'],_0x124aac(0x218))[_0x124aac(0x1ac)](_0x3c968b=>{telegramError(_0x3c968b);}):(tgBot[_0x124aac(0x2bd)](_0xf108ae['chat']['id'],_0x124aac(0x146),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x124aac(0x173)},{'text':'No','callback_data':'no'}]]}})[_0x124aac(0x1ac)](_0x5d0a76=>{telegramError(_0x5d0a76);}),tgBot['on'](_0x124aac(0x2fe),async _0x2db3c0=>{const _0x1cc9d6=_0x124aac,_0x5778d2=_0x2db3c0['data'],_0x1c20eb=_0x2db3c0[_0x1cc9d6(0x167)];tgBot['answerCallbackQuery'](_0x2db3c0['id'])[_0x1cc9d6(0x16c)](async()=>{const _0x201c75=_0x1cc9d6;_0x5778d2=='yes'&&(await tgBot[_0x201c75(0x2bd)](_0x1c20eb[_0x201c75(0x2a8)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x201c75(0x1ac)](_0x42fb57=>{telegramError(_0x42fb57);}),updateBB(_0x201c75(0x14a))),_0x5778d2=='no'&&await tgBot[_0x201c75(0x2bd)](_0x1c20eb[_0x201c75(0x2a8)]['id'],_0x201c75(0x312))['catch'](_0x104e1c=>{telegramError(_0x104e1c);});}),tgBot[_0x1cc9d6(0x1f9)](_0x1cc9d6(0x2fe));}));}),tgBot[_0x4822b6(0x193)](/\/toggle/,_0x319c94=>{const _0x5531aa=_0x4822b6;if(!validateTelegram(_0x319c94))return;tgBot['removeListener'](_0x5531aa(0x2fe));const _0x14628a=getBotsWithMode();if(_0x14628a[_0x5531aa(0x2d6)]==0x0)tgBot[_0x5531aa(0x2bd)](_0x319c94[_0x5531aa(0x2a8)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x5531aa(0x1ac)](_0x85d5a0=>{telegramError(_0x85d5a0);});else{let _0x3bedcf=[],_0x52d9e6=[];const _0x5eb3c9=0x2;let _0x272877=0x0;_0x14628a[_0x5531aa(0x222)]((_0xad3c43,_0x27bf7d)=>{const _0x20c70b=_0x5531aa;if(_0x27bf7d%_0x5eb3c9==0x0)_0x52d9e6=[];_0x52d9e6[_0x20c70b(0x216)]({'text':_0x20c70b(0x20f)+_0xad3c43[_0x20c70b(0x22a)]+'\x20('+_0xad3c43[_0x20c70b(0x16f)]+')','callback_data':_0xad3c43['botID']}),_0x27bf7d%_0x5eb3c9==0x0&&(_0x3bedcf[_0x272877]=_0x52d9e6,_0x272877++);}),tgBot[_0x5531aa(0x2bd)](_0x319c94[_0x5531aa(0x2a8)]['id'],_0x5531aa(0x1e0),{'reply_markup':{'inline_keyboard':_0x3bedcf}})[_0x5531aa(0x1ac)](_0x4a03d1=>{telegramError(_0x4a03d1);}),tgBot['on'](_0x5531aa(0x2fe),async _0x1dcf04=>{const _0x548309=_0x5531aa,_0xcea5d9=_0x1dcf04[_0x548309(0x1f0)],_0x555b4f=_0x1dcf04[_0x548309(0x167)];tgBot[_0x548309(0x2df)](_0x1dcf04['id'])['then'](async()=>{const _0x4b3e4e=_0x548309,_0x59fa40=_0x14628a['find'](_0x44afab=>_0x44afab[_0x4b3e4e(0x22a)]==_0xcea5d9),_0x238fbf=_0x59fa40['mode']=='auto'?_0x4b3e4e(0x20e):_0x4b3e4e(0x1d7);tgBot[_0x4b3e4e(0x2bd)](_0x555b4f[_0x4b3e4e(0x2a8)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0xcea5d9+'\x20to\x20'+_0x238fbf+_0x4b3e4e(0x150))[_0x4b3e4e(0x1ac)](_0x5a9e7c=>{telegramError(_0x5a9e7c);}),toggleBotMode(_0xcea5d9);}),tgBot['removeListener'](_0x548309(0x2fe));});}}),tgBot[_0x4822b6(0x193)](/\/names/,_0x6d9c7a=>{const _0x2afbc0=_0x4822b6;if(!validateTelegram(_0x6d9c7a))return;let _0x410a3a='';config['forEach'](_0x47a1b7=>{const _0x4ee303=_0x5e83;_0x410a3a+=_0x4ee303(0x20f)+_0x47a1b7[_0x4ee303(0x22a)]+':\x20'+_0x47a1b7['botname']+'\x0a';}),tgBot[_0x2afbc0(0x2bd)](_0x6d9c7a[_0x2afbc0(0x2a8)]['id'],_0x410a3a,{'parse_mode':_0x2afbc0(0x23f)})['catch'](_0x4d5254=>{telegramError(_0x4d5254);});}),tgBot['onText'](/\/disable/,_0x45328b=>{const _0x50cb48=_0x4822b6;if(!validateTelegram(_0x45328b))return;tgBot[_0x50cb48(0x2bd)](_0x45328b[_0x50cb48(0x2a8)]['id'],'Notifications\x20disabled')[_0x50cb48(0x1ac)](_0x53b8c7=>{telegramError(_0x53b8c7);}),updateSetting(_0x50cb48(0x289),![]);}),tgBot[_0x4822b6(0x193)](/\/help/,_0x472a51=>{const _0x31388c=_0x4822b6;if(!validateTelegram(_0x472a51))return;tgBot[_0x31388c(0x2bd)](_0x472a51[_0x31388c(0x2a8)]['id'],_0x1ec86d)[_0x31388c(0x1ac)](_0x578527=>{telegramError(_0x578527);});}),tgBot['on']('polling_error',_0x4f9aab=>{const _0xb05344=_0x4822b6;_0x4f9aab[_0xb05344(0x177)]()[_0xb05344(0x245)](_0xb05344(0x281))&&(logger[_0xb05344(0x2ae)]('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null,io['to'](_0xb05344(0x2cd))[_0xb05344(0x1fa)]('notification',_0xb05344(0x26c)));}),process[_0x4822b6(0x1c7)]('SIGINT',()=>{const _0x34ec0d=_0x4822b6;if(tgBot)tgBot[_0x34ec0d(0x2b9)]();process[_0x34ec0d(0x286)](0x1);}),process[_0x4822b6(0x1c7)]('SIGTERM',()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){const _0x200b9b=_0x3ff819;tgBot&&(tgBot[_0x200b9b(0x2b9)](),tgBot=null);}function sendTelegram(_0xbf3626,_0x150109){const _0x284cd1=_0x3ff819;if(settings[_0x284cd1(0x289)]){if(settings[_0x284cd1(0x166)]=='all'||(_0x150109[_0x284cd1(0x30f)]==_0x284cd1(0x2ac)||_0x150109[_0x284cd1(0x30f)]==_0x284cd1(0x212)||_0x150109['type']==_0x284cd1(0x258))&&settings[_0x284cd1(0x166)]==_0x284cd1(0x168)||_0x150109[_0x284cd1(0x30f)]==_0x284cd1(0x2f5)&&settings[_0x284cd1(0x166)]==_0x284cd1(0x1b4)){if(tgBot&&settings[_0x284cd1(0x219)]){if(_0x150109[_0x284cd1(0x24d)])tgBot['sendMessage'](settings['telegramChatId'],_0x150109[_0x284cd1(0x2ea)]+_0x284cd1(0x267)+_0x150109['event'])[_0x284cd1(0x1ac)](_0x5f3e31=>{telegramError(_0x5f3e31);});else tgBot[_0x284cd1(0x2bd)](settings['telegramChatId'],_0x284cd1(0x20f)+_0xbf3626+_0x284cd1(0x267)+_0x150109[_0x284cd1(0x2a3)])['catch'](_0x2fda46=>{telegramError(_0x2fda46);});}}}}async function sendTelegramMsg(_0x28cc01,_0x170ff1=_0x3ff819(0x23f)){const _0x41f0fe=_0x3ff819;return settings[_0x41f0fe(0x289)]&&tgBot&&settings[_0x41f0fe(0x219)]?(await tgBot[_0x41f0fe(0x2bd)](settings['telegramChatId'],_0x28cc01,{'parse_mode':_0x170ff1})[_0x41f0fe(0x1ac)](_0x286e11=>{telegramError(_0x286e11);}),!![]):![];}function getDeviceWithIp(_0x216ac5){const _0x4d8988=_0x3ff819;return devices[_0x4d8988(0x23e)](_0x582117=>_0x582117['ip']===_0x216ac5);}function temporaryAccess2FA(_0x2f21e5,_0x3e3587){const _0xe19e4d=_0x3ff819;let _0x1c062f=new Date(),_0x4b8c2f=![];if(lastIpApproval){if(_0x1c062f-lastIpApproval<0x1388)_0x4b8c2f=!![];}lastIpApproval=new Date();if(_0x4b8c2f)return;tgBot&&settings['telegramChatId']&&(tgBot[_0xe19e4d(0x1f9)]('callback_query'),tgBot['sendMessage'](settings[_0xe19e4d(0x219)],_0xe19e4d(0x1dd)+normalizeIP(_0x3e3587)[_0xe19e4d(0x17d)]+'</b>\x20?',{'parse_mode':_0xe19e4d(0x23f),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0xe19e4d(0x19c),'callback_data':'15'},{'text':_0xe19e4d(0x163),'callback_data':'30'},{'text':_0xe19e4d(0x26b),'callback_data':'reject'}]]}})[_0xe19e4d(0x1ac)](_0xfbce07=>{telegramError(_0xfbce07);}),tgBot['on'](_0xe19e4d(0x2fe),async _0x1bc9dc=>{const _0x5a4da4=_0xe19e4d,_0x55e124=_0x1bc9dc['data'],_0xa4fc3b=_0x1bc9dc[_0x5a4da4(0x167)];tgBot[_0x5a4da4(0x2df)](_0x1bc9dc['id'])[_0x5a4da4(0x16c)](async()=>{const _0xf50805=_0x5a4da4;devices[_0x2f21e5][_0xf50805(0x299)]={'clientip':_0x3e3587,'timestamp':new Date()[_0xf50805(0x322)](),'expiry':_0x55e124},_0x55e124!=_0xf50805(0x26b)?(await tgBot[_0xf50805(0x2bd)](_0xa4fc3b[_0xf50805(0x2a8)]['id'],_0xf50805(0x1c5)+_0x55e124+_0xf50805(0x31d),{'parse_mode':_0xf50805(0x23f)})[_0xf50805(0x1ac)](_0x30c7e7=>{telegramError(_0x30c7e7);}),io['to'](_0x2f21e5)[_0xf50805(0x1fa)](_0xf50805(0x1c9),{'access':{'allow':![],'reason':_0xf50805(0x1f8),'token':null}})):(await tgBot['sendMessage'](_0xa4fc3b[_0xf50805(0x2a8)]['id'],_0xf50805(0x31c))[_0xf50805(0x1ac)](_0x5579bb=>{telegramError(_0x5579bb);}),io['to'](_0x2f21e5)[_0xf50805(0x1fa)](_0xf50805(0x1c9),{'access':{'allow':![],'reason':_0xf50805(0x253),'token':null}}));}),tgBot['removeListener'](_0x5a4da4(0x2fe));}));}function loginAccess2FA(_0x23b2c6,_0x29701b){const _0xc659ba=_0x3ff819;tgBot&&settings[_0xc659ba(0x219)]&&(tgBot[_0xc659ba(0x1f9)]('callback_query'),tgBot[_0xc659ba(0x2bd)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x29701b)[_0xc659ba(0x17d)]+_0xc659ba(0x27e),{'parse_mode':_0xc659ba(0x23f),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0xc659ba(0x26b)}]]}})[_0xc659ba(0x1ac)](_0x24eae1=>{telegramError(_0x24eae1);}),tgBot['on'](_0xc659ba(0x2fe),async _0x49c49d=>{const _0x273a9c=_0xc659ba,_0xacba8c=_0x49c49d[_0x273a9c(0x1f0)],_0x2e89d9=_0x49c49d[_0x273a9c(0x167)];tgBot[_0x273a9c(0x2df)](_0x49c49d['id'])['then'](async()=>{const _0x3502cc=_0x273a9c;devices[_0x23b2c6][_0x3502cc(0x28b)]={'clientip':_0x29701b,'timestamp':new Date()[_0x3502cc(0x322)](),'expiry':_0xacba8c},_0xacba8c!='reject'?(await tgBot[_0x3502cc(0x2bd)](_0x2e89d9[_0x3502cc(0x2a8)]['id'],_0x3502cc(0x192),{'parse_mode':_0x3502cc(0x23f)})[_0x3502cc(0x1ac)](_0x17e1aa=>{telegramError(_0x17e1aa);}),io['to'](_0x23b2c6)[_0x3502cc(0x1fa)](_0x3502cc(0x1c9),{'access':{'allow':![],'reason':_0x3502cc(0x1f8),'token':null}})):(await tgBot[_0x3502cc(0x2bd)](_0x2e89d9[_0x3502cc(0x2a8)]['id'],'Login\x20rejected')[_0x3502cc(0x1ac)](_0x3e6414=>{telegramError(_0x3e6414);}),io['to'](_0x23b2c6)['emit'](_0x3502cc(0x1c9),{'access':{'allow':![],'reason':_0x3502cc(0x1dc),'token':null}}));}),tgBot[_0x273a9c(0x1f9)](_0x273a9c(0x2fe));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2cce2c=_0x3ff819;return dbConfig[_0x2cce2c(0x2d5)](_0x2cce2c(0x2c1))[_0x2cce2c(0x2cb)](_0x2cce2c(0x22a))[_0x2cce2c(0x147)]({'status':_0x2cce2c(0x228)})[_0x2cce2c(0x308)]()||[];}function getDisabledBots(){const _0x124a3d=_0x3ff819;return dbConfig['get'](_0x124a3d(0x2c1))[_0x124a3d(0x2cb)](_0x124a3d(0x22a))[_0x124a3d(0x147)]({'status':_0x124a3d(0x28a)})['value']()||[];}function getBotAttributes(_0x46dfc5){const _0x56942d=_0x3ff819;let _0x510400={};const _0x58bddb=configpath+_0x56942d(0x2e6)+_0x46dfc5+_0x56942d(0x19b),_0x1d2822=fs['existsSync'](_0x58bddb);if(_0x1d2822){const _0x3de30b=fs[_0x56942d(0x2c2)](_0x58bddb);try{const _0x946928=JSON[_0x56942d(0x157)](_0x3de30b),_0xfb126f=_0x946928?_0x946928['bot'][0x0][_0x56942d(0x1a1)]:![];_0x510400[_0x56942d(0x16f)]=_0xfb126f?_0x56942d(0x1d7):'manual',_0x510400[_0x56942d(0x2ea)]=_0x946928?_0x946928[_0x56942d(0x256)][0x0][_0x56942d(0x2ea)]:_0x56942d(0x20f)+_0x46dfc5;}catch(_0x36cc97){_0x510400['mode']='manual',_0x510400[_0x56942d(0x2ea)]='Bot\x20'+_0x46dfc5;}}else _0x510400[_0x56942d(0x16f)]=_0x56942d(0x20e),_0x510400[_0x56942d(0x2ea)]=_0x56942d(0x20f)+_0x46dfc5;return _0x510400;}function getBotsWithMode(){const _0x25c531=_0x3ff819,_0x27058d=dbConfig['get'](_0x25c531(0x2c1))['sortBy']('botID')['value']()||[];return _0x27058d[_0x25c531(0x222)](_0x587136=>{const _0x3b83a4=_0x25c531;let _0x49f8c0=getBotAttributes(_0x587136[_0x3b83a4(0x22a)]);_0x587136[_0x3b83a4(0x16f)]=_0x49f8c0[_0x3b83a4(0x16f)];}),_0x27058d;}function getBotExchanges(){const _0x10a83a=_0x3ff819;let _0x2b2be5=[];const _0x3a81de=dbConfig[_0x10a83a(0x2d5)](_0x10a83a(0x2c1))[_0x10a83a(0x2cb)](_0x10a83a(0x22a))[_0x10a83a(0x308)]()||[];_0x3a81de[_0x10a83a(0x222)](_0x169872=>{const _0x23f981=_0x10a83a;if(_0x169872['status']=='enabled'){const _0x4eaedc=configpath+'bot-'+_0x169872[_0x23f981(0x22a)]+'-config.json',_0x3d1c89=fs[_0x23f981(0x164)](_0x4eaedc);let _0x1a0ff2;if(_0x3d1c89){const _0x5bcfd5=fs[_0x23f981(0x2c2)](_0x4eaedc);try{const _0x2be571=JSON[_0x23f981(0x157)](_0x5bcfd5);_0x1a0ff2=_0x2be571?_0x2be571['bot'][0x0][_0x23f981(0x24a)]:null;}catch(_0x4b3634){}}if(_0x1a0ff2)_0x2b2be5[_0x23f981(0x216)](_0x1a0ff2);}});const _0x8e3350=[...new Set(_0x2b2be5)]['sort']();return _0x8e3350;}async function initUser(){const _0x5e2e38=_0x3ff819;if(!settings[_0x5e2e38(0x223)]){const _0x3e8784=uuidRandom();mixpanel[_0x5e2e38(0x22b)](_0x3e8784),updateSetting(_0x5e2e38(0x223),_0x3e8784);}}async function initSecure(){const _0x27ab20=_0x3ff819;let _0x27db28=getSecure();if(!_0x27db28[_0x27ab20(0x303)](_0x27ab20(0x20d))){let _0x5dad0d=await generateKeys();_0x27db28[_0x27ab20(0x266)]=_0x5dad0d[_0x27ab20(0x266)],_0x27db28[_0x27ab20(0x1c1)]=_0x5dad0d[_0x27ab20(0x1c1)],_0x27db28[_0x27ab20(0x20d)]=crypto['randomBytes'](0x20)[_0x27ab20(0x177)](_0x27ab20(0x191));;storeSecure(_0x27db28);}}function getSettings(){const _0x54c0b3=_0x3ff819;return dbSettings[_0x54c0b3(0x2d5)](_0x54c0b3(0x2c5))['value']()||{};}function getSecure(){const _0x4466f5=_0x3ff819;return dbSecure['get'](_0x4466f5(0x15a))[_0x4466f5(0x308)]()||{};}function getBlacklist(){const _0x1d406d=_0x3ff819;return dbSecure[_0x1d406d(0x2d5)]('blacklist')[_0x1d406d(0x308)]()||[];}function broadcastToBots(_0x275216,_0x5acc35){const _0x4eb5e7=_0x3ff819;config[_0x4eb5e7(0x222)](_0x51905e=>{const _0x331b19=_0x4eb5e7;if(_0x51905e[_0x331b19(0x1c9)]==_0x331b19(0x228)&&_0x51905e[_0x331b19(0x1c6)]==_0x331b19(0x2c9)||_0x51905e[_0x331b19(0x1c9)]==_0x331b19(0x1a9)&&_0x51905e[_0x331b19(0x1c6)]==_0x331b19(0x2c9)){if(pid[_0x51905e[_0x331b19(0x22a)]])pid[_0x51905e[_0x331b19(0x22a)]][_0x331b19(0x1ee)]({[_0x275216]:_0x5acc35});}});}function storeSettings(_0xe66bbf,_0x5ddd64=![]){const _0x3578d2=_0x3ff819;_0xe66bbf={...settings,..._0xe66bbf};if(_0x5ddd64&&_0xe66bbf[_0x3578d2(0x284)]!='************'&&_0xe66bbf[_0x3578d2(0x284)]!=_0x3578d2(0x165)&&_0xe66bbf['bbPassword']!=''){const _0x2cad86=crypt[_0x3578d2(0x20b)](secure[_0x3578d2(0x1c1)],_0xe66bbf[_0x3578d2(0x284)])[_0x3578d2(0x167)]['split']('@')[0x0],_0x5ec8ed=bcrypt[_0x3578d2(0x21a)](_0x2cad86,saltRounds);_0xe66bbf={..._0xe66bbf,'bbPassword':_0x5ec8ed};}if(_0x5ddd64&&_0xe66bbf[_0x3578d2(0x255)]!=_0x3578d2(0x2ec)&&_0xe66bbf['telegramToken']!=_0x3578d2(0x165)&&_0xe66bbf[_0x3578d2(0x255)]!=''){const _0x1c35c3=crypt[_0x3578d2(0x20b)](secure[_0x3578d2(0x1c1)],_0xe66bbf['telegramToken'])[_0x3578d2(0x167)][_0x3578d2(0x2c0)]('@')[0x0];_0xe66bbf={..._0xe66bbf,'telegramToken':_0x1c35c3};}const _0x235326=_0xe66bbf[_0x3578d2(0x255)]!=_0x3578d2(0x2ec)&&_0xe66bbf[_0x3578d2(0x255)]!=settings[_0x3578d2(0x255)]||_0xe66bbf[_0x3578d2(0x1de)]!=settings['telegramUsername'],_0x230a58=_0xe66bbf[_0x3578d2(0x255)]==''||_0xe66bbf[_0x3578d2(0x1de)]=='';if(_0x235326)_0xe66bbf[_0x3578d2(0x166)]='all';for(const [_0x438466,_0x345f16]of Object['entries'](_0xe66bbf)){if(_0x438466==_0x3578d2(0x255)&&_0x345f16=='************'){_0xe66bbf[_0x3578d2(0x255)]=settings[_0x3578d2(0x255)];continue;};if(_0x438466==_0x3578d2(0x284)&&_0x345f16==_0x3578d2(0x2ec)){_0xe66bbf[_0x3578d2(0x284)]=settings[_0x3578d2(0x284)];continue;};dbSettings[_0x3578d2(0x2f7)](_0x3578d2(0x29d)+_0x438466,_0x345f16)[_0x3578d2(0x2af)]();}settings=_0xe66bbf,io['to'](_0x3578d2(0x2cd))[_0x3578d2(0x1fa)]('settings',cleanSettings()),broadcastToBots(_0x3578d2(0x26d),settings[_0x3578d2(0x26d)]),broadcastToBots(_0x3578d2(0x215),settings[_0x3578d2(0x215)]);if(_0x235326&&!_0x230a58)initTelegram();if(_0x235326&&_0x230a58)disableTelegram();getAllClients()['forEach'](_0x3b8b64=>{const _0x42eca2=_0x3578d2;getSocket(_0x3b8b64['id'])[_0x42eca2(0x1fa)](_0x42eca2(0x1c9),{'access':{'allow':![],'reason':_0x42eca2(0x1f8),'token':null}});});}function updateSetting(_0x181fac,_0x2e30d4){const _0x8bdd2a=_0x3ff819;dbSettings[_0x8bdd2a(0x2f7)](_0x8bdd2a(0x29d)+_0x181fac,_0x2e30d4)['write'](),settings=getSettings(),io['to']('botmanager')[_0x8bdd2a(0x1fa)]('settings',cleanSettings());}function storeSecure(_0xff1e03){const _0x507104=_0x3ff819;dbSecure[_0x507104(0x2d5)](_0x507104(0x15a))['push'](_0xff1e03)[_0x507104(0x2af)](),secure=_0xff1e03;}function addBlacklist(_0x3bb110){const _0xbcb759=_0x3ff819;cleanBlacklist();let _0x38f384;devices[_0x3bb110][_0xbcb759(0x299)]?_0x38f384=Math[_0xbcb759(0x2ad)](devices[_0x3bb110][_0xbcb759(0x299)][_0xbcb759(0x20c)],loginExpiry):_0x38f384=loginExpiry,dbSecure[_0xbcb759(0x2d5)](_0xbcb759(0x1bb))[_0xbcb759(0x216)]({'expiry':new Date()[_0xbcb759(0x322)]()+_0x38f384*0x3c*0x3e8,'token':devices[_0x3bb110][_0xbcb759(0x1a6)][_0xbcb759(0x268)]})[_0xbcb759(0x2af)](),blacklist=dbSecure[_0xbcb759(0x2d5)]('blacklist')['value']();}function cleanBlacklist(){const _0x130356=_0x3ff819;let _0x218c5a=dbSecure[_0x130356(0x2d5)](_0x130356(0x1bb))[_0x130356(0x29c)]()[_0x130356(0x308)](),_0x5f4b4e=new Date()['getTime']();_0x218c5a[_0x130356(0x222)](_0x5a2edc=>{const _0x329cd4=_0x130356;_0x5a2edc[_0x329cd4(0x20c)]<_0x5f4b4e&&dbSecure[_0x329cd4(0x2d5)](_0x329cd4(0x1bb))[_0x329cd4(0x2a5)]({'expiry':_0x5a2edc[_0x329cd4(0x20c)]})[_0x329cd4(0x2af)]();});}function initStates(){let _0x5c39df=getConfiguration();_0x5c39df['forEach'](_0x142884=>{const _0x385620=_0x5e83;_0x142884[_0x385620(0x1c6)]=_0x385620(0x195);}),storeConfiguration(_0x5c39df);}function onKeys(){const _0x58e80c=new RSA();return new Promise(_0x372af3=>{_0x58e80c['generateKeyPairAsync']()['then'](_0xc130ba=>{_0x372af3(_0xc130ba);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x21c17b=_0x3ff819;let _0xb04340=getSettings(),_0x4772d9=![];!_0xb04340[_0x21c17b(0x303)]('lastmsgtelegram')&&(_0xb04340[_0x21c17b(0x204)]=0x0,_0x4772d9=!![]);!_0xb04340[_0x21c17b(0x303)](_0x21c17b(0x15c))&&(_0xb04340[_0x21c17b(0x15c)]=0x0,_0x4772d9=!![]);!_0xb04340[_0x21c17b(0x303)]('latestversion')&&(_0xb04340[_0x21c17b(0x250)]=_0x21c17b(0x282),_0x4772d9=!![]);!_0xb04340[_0x21c17b(0x303)](_0x21c17b(0x215))&&(_0xb04340[_0x21c17b(0x215)]=![],_0x4772d9=!![]);if(_0x4772d9)storeSettings(_0xb04340);}function storeConfiguration(_0x2d8886){const _0x59f98d=_0x3ff819;dbConfig[_0x59f98d(0x2d5)](_0x59f98d(0x2c1))[_0x59f98d(0x2a5)]()['write'](),_0x2d8886[_0x59f98d(0x222)](_0x362219=>{const _0x7d68a=_0x59f98d;delete _0x362219[_0x7d68a(0x16f)];}),dbConfig[_0x59f98d(0x2d5)]('bots')['push'](..._0x2d8886)[_0x59f98d(0x2af)](),config=_0x2d8886;}function resetPassword(){const _0x58b7c9=_0x3ff819;tgBot&&settings['telegramChatId']&&(tgBot[_0x58b7c9(0x1f9)]('callback_query'),tgBot['sendMessage'](settings[_0x58b7c9(0x219)],_0x58b7c9(0x2d7),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x58b7c9(0x173),'callback_data':_0x58b7c9(0x173)},{'text':'no','callback_data':'no'}]]}})[_0x58b7c9(0x1ac)](_0x1dc79b=>{telegramError(_0x1dc79b);}),tgBot['on']('callback_query',async _0x220035=>{const _0x17a7f2=_0x58b7c9,_0x5e0048=_0x220035[_0x17a7f2(0x1f0)],_0x2c5eb0=_0x220035[_0x17a7f2(0x167)];tgBot[_0x17a7f2(0x2df)](_0x220035['id'])['then'](async()=>{const _0x5e0dfd=_0x17a7f2;if(_0x5e0048!='no'){const _0x26be52=0xf,_0x2a7621=_0x5e0dfd(0x2c3),_0x2a076d=Array['from'](crypto[_0x5e0dfd(0x2b2)](new Uint32Array(_0x26be52)))['map'](_0x176832=>_0x2a7621[_0x176832%_0x2a7621['length']])['join'](''),_0xc3418=bcrypt[_0x5e0dfd(0x21a)](_0x2a076d,saltRounds);storeSettings({'bbPassword':_0xc3418}),await tgBot[_0x5e0dfd(0x2bd)](_0x2c5eb0['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x2a076d,{'parse_mode':_0x5e0dfd(0x23f)})['catch'](_0x41b490=>{telegramError(_0x41b490);});}else await tgBot[_0x5e0dfd(0x2bd)](_0x2c5eb0['chat']['id'],'Password\x20reset\x20rejected')[_0x5e0dfd(0x1ac)](_0x31e82d=>{telegramError(_0x31e82d);});}),tgBot['removeListener']('callback_query');}));}async function confirmRestore(_0x1eb693,_0x5c074e){const _0x4818dc=_0x3ff819;io['to']('botmanager')[_0x4818dc(0x1fa)](_0x4818dc(0x241),_0x4818dc(0x1ba),_0x4818dc(0x258)),tgBot&&settings[_0x4818dc(0x219)]&&(tgBot[_0x4818dc(0x1f9)]('callback_query'),await tgBot['sendMessage'](settings[_0x4818dc(0x219)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x4818dc(0x23f),'reply_markup':{'inline_keyboard':[[{'text':_0x4818dc(0x173),'callback_data':_0x4818dc(0x173)},{'text':'no','callback_data':'no'}]]}})[_0x4818dc(0x1ac)](_0x1c71a0=>{telegramError(_0x1c71a0);}),tgBot['on'](_0x4818dc(0x2fe),async _0x252a39=>{const _0x36a1b1=_0x4818dc,_0x30ba09=_0x252a39[_0x36a1b1(0x1f0)],_0x15ea02=_0x252a39[_0x36a1b1(0x167)];tgBot[_0x36a1b1(0x2df)](_0x252a39['id'])['then'](async()=>{const _0x3a457d=_0x36a1b1;_0x30ba09==_0x3a457d(0x173)?(await tgBot[_0x3a457d(0x2bd)](_0x15ea02[_0x3a457d(0x2a8)]['id'],_0x3a457d(0x23b),{'parse_mode':_0x3a457d(0x23f)})['catch'](_0x1a327b=>{telegramError(_0x1a327b);}),unzipFile(_0x1eb693,_0x5c074e)):(logger[_0x3a457d(0x2f6)](_0x3a457d(0x309)),await tgBot[_0x3a457d(0x2bd)](_0x15ea02[_0x3a457d(0x2a8)]['id'],_0x3a457d(0x309))[_0x3a457d(0x1ac)](_0x123baa=>{telegramError(_0x123baa);}));}),tgBot['removeListener'](_0x36a1b1(0x2fe));}));}function getServerTime(){const _0x5b2a1f=_0x3ff819,_0x8c923c=new Date();return _0x8c923c[_0x5b2a1f(0x293)]()+'/'+(_0x8c923c[_0x5b2a1f(0x31f)]()+0x1)[_0x5b2a1f(0x177)]()['padStart'](0x2,'0')+'/'+_0x8c923c['getDate']()[_0x5b2a1f(0x177)]()[_0x5b2a1f(0x290)](0x2,'0')+'\x20'+_0x8c923c['getHours']()[_0x5b2a1f(0x177)]()['padStart'](0x2,'0')+':'+_0x8c923c[_0x5b2a1f(0x251)]()[_0x5b2a1f(0x177)]()[_0x5b2a1f(0x290)](0x2,'0')+':'+_0x8c923c[_0x5b2a1f(0x143)]()[_0x5b2a1f(0x177)]()[_0x5b2a1f(0x290)](0x2,'0');}function getTimeStamp(){const _0x2ebf27=_0x3ff819,_0x1e6653=shiftedTime();return _0x1e6653[_0x2ebf27(0x293)]()+'/'+(_0x1e6653[_0x2ebf27(0x31f)]()+0x1)[_0x2ebf27(0x177)]()[_0x2ebf27(0x290)](0x2,'0')+'/'+_0x1e6653['getDate']()[_0x2ebf27(0x177)]()['padStart'](0x2,'0')+'\x20'+_0x1e6653[_0x2ebf27(0x28f)]()['toString']()['padStart'](0x2,'0')+':'+_0x1e6653[_0x2ebf27(0x251)]()[_0x2ebf27(0x177)]()[_0x2ebf27(0x290)](0x2,'0')+':'+_0x1e6653[_0x2ebf27(0x143)]()[_0x2ebf27(0x177)]()[_0x2ebf27(0x290)](0x2,'0');}function getCleanTimeStamp(){const _0x2ff471=_0x3ff819,_0x103310=shiftedTime();return _0x103310[_0x2ff471(0x293)]()+(_0x103310[_0x2ff471(0x31f)]()+0x1)[_0x2ff471(0x177)]()[_0x2ff471(0x290)](0x2,'0')+_0x103310[_0x2ff471(0x1eb)]()[_0x2ff471(0x177)]()[_0x2ff471(0x290)](0x2,'0')+'-'+_0x103310[_0x2ff471(0x28f)]()[_0x2ff471(0x177)]()[_0x2ff471(0x290)](0x2,'0')+_0x103310[_0x2ff471(0x251)]()[_0x2ff471(0x177)]()[_0x2ff471(0x290)](0x2,'0')+_0x103310['getSeconds']()[_0x2ff471(0x177)]()[_0x2ff471(0x290)](0x2,'0');}function shiftedTime(){const _0x673632=_0x3ff819,_0x4c12c8=new Date();let _0x455338=_0x4c12c8;if(settings[_0x673632(0x26d)]&&settings[_0x673632(0x26d)]!==0x0)_0x455338=fns['add'](_0x4c12c8,{'hours':settings[_0x673632(0x26d)]});return _0x455338;}function startScheduler(){const _0x1f1851=_0x3ff819,_0x12a12a=new Date()['getUTCHours'](),_0x2dfd9e=shiftedTime()[_0x1f1851(0x28f)]();_0x2dfd9e==0x4&&backupConfigFiles();_0x2dfd9e==0x0&&rotateLogFiles();_0x12a12a%0x6==0x0&&triggerAnalytics();_0x12a12a%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x480ae5){const _0x2c19b4=_0x3ff819;logger[_0x2c19b4(0x2f6)](_0x2c19b4(0x24f)+_0x480ae5);const _0x28ecae=getBotsWithMode();_0x28ecae[_0x2c19b4(0x2d6)]>0x0?confirmRestore(configbackuppath,_0x480ae5):unzipFile(configbackuppath,_0x480ae5);}async function getBackupFiles(_0x468a4d=null){const _0x2789f8=_0x3ff819;let _0x438dbd=[],_0x5f41f7=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x5f41f7[_0x2789f8(0x298)]((_0x2837b5,_0x2d5d65)=>_0x2837b5['name']<_0x2d5d65[_0x2789f8(0x1f2)]?0x1:_0x2d5d65[_0x2789f8(0x1f2)]<_0x2837b5['name']?-0x1:0x0),_0x5f41f7[_0x2789f8(0x222)](_0x2d4c38=>{const _0x11b700=_0x2789f8;if(!_0x2d4c38[_0x11b700(0x236)]()&&_0x2d4c38['name'][_0x11b700(0x2c7)]('backup-full@')&&_0x2d4c38['name'][_0x11b700(0x1f1)](_0x11b700(0x2db))){const _0x387300=formatDate(fs[_0x11b700(0x26f)](configbackuppath+_0x2d4c38[_0x11b700(0x1f2)])['mtime']);_0x438dbd[_0x11b700(0x216)]({'name':_0x2d4c38[_0x11b700(0x1f2)],'mtime':_0x387300});}});if(_0x468a4d)io['to'](_0x468a4d)[_0x2789f8(0x1fa)](_0x2789f8(0x291),_0x438dbd);else return _0x438dbd;}async function backupConfigFiles(){const _0x1ac664=_0x3ff819;await zipFiles('backup-full');const _0x4d6a0d=getCleanTimeStamp();fs[_0x1ac664(0x207)](zippath+_0x1ac664(0x29e),configbackuppath+(_0x1ac664(0x261)+_0x4d6a0d+_0x1ac664(0x2db)));let _0x327dad=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x327dad[_0x1ac664(0x298)]((_0x4340d6,_0x568ca8)=>_0x4340d6['name']<_0x568ca8[_0x1ac664(0x1f2)]?0x1:_0x568ca8[_0x1ac664(0x1f2)]<_0x4340d6[_0x1ac664(0x1f2)]?-0x1:0x0),_0x327dad[_0x1ac664(0x2d6)]>maxBackups&&fs[_0x1ac664(0x1a3)](configbackuppath+_0x327dad[maxBackups]['name']);}function rotateLogFiles(){const _0xcff5eb=_0x3ff819,_0x269692=fs['statSync'](logspath+_0xcff5eb(0x172)),_0x242ff0=_0x269692[_0xcff5eb(0x1e4)]/0x400;if(_0x242ff0>0x64){let _0xb96b8=fs[_0xcff5eb(0x25b)](logspath,{'withFileTypes':!![]});_0xb96b8['sort']((_0x5c9f08,_0x5e3d7a)=>_0x5c9f08['name']<_0x5e3d7a['name']?0x1:_0x5e3d7a['name']<_0x5c9f08[_0xcff5eb(0x1f2)]?-0x1:0x0),_0xb96b8[_0xcff5eb(0x222)](_0x41fcb0=>{const _0x3ac66b=_0xcff5eb;if(_0x41fcb0['name']==_0x3ac66b(0x205))fs[_0x3ac66b(0x207)](logspath+_0x41fcb0[_0x3ac66b(0x1f2)],logspath+_0x3ac66b(0x2e9));if(_0x41fcb0[_0x3ac66b(0x1f2)]==_0x3ac66b(0x25c))fs[_0x3ac66b(0x207)](logspath+_0x41fcb0[_0x3ac66b(0x1f2)],logspath+_0x3ac66b(0x205));_0x41fcb0['name']==_0x3ac66b(0x172)&&(fs[_0x3ac66b(0x207)](logspath+_0x41fcb0[_0x3ac66b(0x1f2)],logspath+_0x3ac66b(0x25c)),fs[_0x3ac66b(0x17e)](logspath+_0x41fcb0[_0x3ac66b(0x1f2)],''));});}}async function zipFiles(_0xae3563){const _0xa7b737=_0x3ff819;let _0x540ea0;if(_0xae3563==_0xa7b737(0x1ad))_0x540ea0=logspath;if(_0xae3563==_0xa7b737(0x249))_0x540ea0=configpath;if(_0xae3563==_0xa7b737(0x1ff))_0x540ea0=configpath;let _0x21f6d1=fs[_0xa7b737(0x25b)](_0x540ea0,{'withFileTypes':!![]});const _0x5ec9ce=new require(_0xa7b737(0x271))();_0x21f6d1[_0xa7b737(0x222)](_0x504f2d=>{const _0x1f5a4d=_0xa7b737;if(!_0x504f2d['isDirectory']()){let _0x399e5a=fs[_0x1f5a4d(0x2c2)](_0x540ea0+_0x504f2d[_0x1f5a4d(0x1f2)]);if(_0xae3563==_0x1f5a4d(0x249)){const _0x3e3eee=/^bot-[0-9]{3}-config.json$/,_0x437250=_0x3e3eee[_0x1f5a4d(0x1a0)](_0x504f2d['name']);if(_0x437250){const _0xc8860b=JSON[_0x1f5a4d(0x157)](_0x399e5a);if(_0xc8860b[_0x1f5a4d(0x256)][0x0]){_0xc8860b[_0x1f5a4d(0x256)][0x0][_0x1f5a4d(0x2b4)]=_0x1f5a4d(0x165),_0xc8860b[_0x1f5a4d(0x256)][0x0][_0x1f5a4d(0x2e1)]=_0x1f5a4d(0x165);if(_0xc8860b[_0x1f5a4d(0x256)][0x0]['apiPassword'])_0xc8860b[_0x1f5a4d(0x256)][0x0][_0x1f5a4d(0x2b8)]='***';}_0x399e5a=JSON[_0x1f5a4d(0x152)](_0xc8860b,null,0x2);}if(_0x504f2d[_0x1f5a4d(0x1f2)]==_0x1f5a4d(0x206)){const _0x3cfc20=JSON['parse'](_0x399e5a);if(_0x3cfc20[_0x1f5a4d(0x2c5)][_0x1f5a4d(0x1d8)])_0x3cfc20[_0x1f5a4d(0x2c5)][_0x1f5a4d(0x1d8)]=![];if(_0x3cfc20['settings'][_0x1f5a4d(0x284)])_0x3cfc20[_0x1f5a4d(0x2c5)]['bbPassword']=_0x1f5a4d(0x165);if(_0x3cfc20['settings']['telegramToken'])_0x3cfc20['settings'][_0x1f5a4d(0x255)]=_0x1f5a4d(0x165);if(_0x3cfc20[_0x1f5a4d(0x2c5)][_0x1f5a4d(0x219)])_0x3cfc20[_0x1f5a4d(0x2c5)][_0x1f5a4d(0x219)]=null;_0x399e5a=JSON['stringify'](_0x3cfc20,null,0x2);}if(_0x504f2d[_0x1f5a4d(0x1f2)]!='bb-secure.json')_0x5ec9ce[_0x1f5a4d(0x23a)](_0x504f2d[_0x1f5a4d(0x1f2)],_0x399e5a);}else _0x5ec9ce[_0x1f5a4d(0x23a)](_0x504f2d[_0x1f5a4d(0x1f2)],_0x399e5a);}});const _0x2497c7=_0x5ec9ce[_0xa7b737(0x21d)]({'base64':![],'compression':'DEFLATE'});fs[_0xa7b737(0x17e)](zippath+(_0xae3563+'.zip'),_0x2497c7,_0xa7b737(0x1e2));}async function unzipFile(_0x534d0d,_0x31dd20){const _0x22c574=_0x3ff819;fs[_0x22c574(0x25b)](configpath,{'withFileTypes':!![]})['forEach'](_0x1c6e36=>{const _0x22e16a=_0x22c574;if(!_0x1c6e36[_0x22e16a(0x236)]())fs[_0x22e16a(0x1e6)](configpath+_0x1c6e36[_0x22e16a(0x1f2)]);});const _0x556ce2=fs[_0x22c574(0x2c2)](_0x534d0d+_0x31dd20,_0x22c574(0x1e2)),_0x2106f4=new require(_0x22c574(0x271))(_0x556ce2,{'base64':![],'checkCRC32':!![]});Object[_0x22c574(0x2f1)](_0x2106f4[_0x22c574(0x16e)])['forEach'](_0x3115e5=>{const _0x38030e=_0x22c574,_0x50ad73=_0x2106f4[_0x38030e(0x16e)][_0x3115e5];fs[_0x38030e(0x17e)](configpath+_0x50ad73[_0x38030e(0x1f2)],_0x50ad73[_0x38030e(0x28c)]);}),fs[_0x22c574(0x25b)](temppath,{'withFileTypes':!![]})[_0x22c574(0x222)](_0x13c6b1=>{const _0x2075ba=_0x22c574;if(!_0x13c6b1['isDirectory']())fs[_0x2075ba(0x1e6)](temppath+_0x13c6b1[_0x2075ba(0x1f2)]);}),logger['debug'](_0x22c574(0x14e)),process[_0x22c574(0x1ee)]({'restore':!![]},_0x5ae3d8=>{});}async function getPublicIp(){const _0x1ef858=_0x3ff819;try{const _0x1f238b=await axios['get'](_0x1ef858(0x1e5));publicip=_0x1f238b[_0x1ef858(0x1f0)]['ip'];}catch(_0x2ec07a){}}async function triggerAnalytics(){const _0xfdd53d=_0x3ff819;if(!publicip)await getPublicIp();const _0xf46b1a=getBotsWithMode();let _0x30804c=0x0;_0xf46b1a['forEach'](_0x2e8c46=>{const _0xa91260=_0x5e83;if(_0x2e8c46[_0xa91260(0x1c9)]===_0xa91260(0x228))_0x30804c++;});const _0x55c350=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0xfdd53d(0x223)],'ip':publicip,'version':serverversion,'numbots':_0xf46b1a[_0xfdd53d(0x2d6)],'numbotsenabled':_0x30804c,'exchanges':_0x55c350});}async function getMessages(){const _0x3080b1=_0x3ff819,_0x1944bd='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x10283f=new GraphQLClient(_0x1944bd),_0x12f064={'authorization':_0x3080b1(0x2d2)},_0x357c98=serverversion[_0x3080b1(0x2c0)]('.'),_0x506ae6=_0x357c98[0x0]+'.'+_0x357c98[0x1],_0x29de96=Math[_0x3080b1(0x24c)](settings[_0x3080b1(0x204)],settings[_0x3080b1(0x15c)]),_0x35575c={'last':parseInt(_0x29de96),'bbm':_0x506ae6},_0x3d9f7f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x558785;try{_0x558785=await _0x10283f[_0x3080b1(0x1fe)](_0x3d9f7f,_0x35575c,_0x12f064);}catch(_0x2ad6f0){}if(_0x558785&&_0x558785['messages']){let _0x22bd78=settings[_0x3080b1(0x204)];newMessages=[];for(const _0x13d290 of _0x558785[_0x3080b1(0x287)]){newMessages['push'](_0x13d290);if(_0x13d290['bbvNew'])updateSetting(_0x3080b1(0x250),_0x13d290[_0x3080b1(0x19f)]);let _0x46961a=_0x13d290[_0x3080b1(0x19f)]?serverversion>=_0x13d290[_0x3080b1(0x19f)]:![];if(!_0x46961a&&_0x13d290[_0x3080b1(0x25d)]>_0x22bd78){if(_0x13d290[_0x3080b1(0x174)]==='any'||serverversion[_0x3080b1(0x2c7)](_0x13d290[_0x3080b1(0x174)])){let _0x35a789=''+_0x13d290[_0x3080b1(0x26e)]+'\x0a\x0a'+_0x13d290[_0x3080b1(0x167)];const _0x49e166=await sendTelegramMsg(toTelegramMarkdown(_0x35a789),_0x3080b1(0x1a4));if(_0x49e166)_0x22bd78=_0x13d290[_0x3080b1(0x25d)];}}}updateAvailable=isNewerVersion(settings[_0x3080b1(0x250)],serverversion),updateSetting('lastmsgtelegram',_0x22bd78),emitMessages();}}function emitMessages(){const _0x55131c=_0x3ff819,_0x18ff7e=settings['lastmsgemitted'];let _0x267029=[];newMessages[_0x55131c(0x222)](_0x469257=>{const _0x23de9e=_0x55131c;_0x469257['number']>_0x18ff7e&&_0x267029[_0x23de9e(0x216)](_0x469257);}),_0x267029[_0x55131c(0x2d6)]>0x0&&getAllClients()[_0x55131c(0x222)](_0x2477d9=>{const _0x1fe1b6=_0x55131c;getSocket(_0x2477d9['id'])[_0x1fe1b6(0x1fa)](_0x1fe1b6(0x167),_0x267029);});}function confirmMessage(_0x51e1c2){const _0x4fc470=_0x3ff819;updateSetting(_0x4fc470(0x15c),Number(_0x51e1c2));}function isNewerVersion(_0x394e8c,_0x486e02){const _0x4a30ba=_0x3ff819,_0x162d7d=_0x486e02[_0x4a30ba(0x2c0)]('.'),_0x23a55f=_0x394e8c[_0x4a30ba(0x2c0)]('.');for(var _0x42c32c=0x0;_0x42c32c<_0x23a55f[_0x4a30ba(0x2d6)];_0x42c32c++){const _0x48080d=~~_0x23a55f[_0x42c32c],_0x280e35=~~_0x162d7d[_0x42c32c];if(_0x48080d>_0x280e35)return!![];if(_0x48080d<_0x280e35)return![];}return![];}function toTelegramMarkdown(_0x2a903f){const _0x2745d8=_0x3ff819,_0x34a214=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xe79865=/\*{2}(.+?)\*{2}/gim;return _0x2a903f=_0x2a903f['replace'](_0x34a214,'$1_$2_$3')[_0x2745d8(0x185)](_0xe79865,_0x2745d8(0x14d)),_0x2a903f;}async function validateConfigFile(){const _0x45b30d=_0x3ff819,_0x16b900=dbConfig[_0x45b30d(0x2d5)](_0x45b30d(0x2c1))['sortBy'](_0x45b30d(0x22a))[_0x45b30d(0x308)]()||[];if(_0x16b900[_0x45b30d(0x2d6)]==0x0){let _0x1cee03=0x0,_0x5cfc6=[];const _0x242a37=/^bot-([0-9]{3})-config.json$/,_0x540cd1=fs[_0x45b30d(0x25b)](configpath);_0x540cd1[_0x45b30d(0x222)](_0x2d7f9d=>{const _0x2d81f0=_0x45b30d,_0x3d77a8=_0x242a37[_0x2d81f0(0x19e)](_0x2d7f9d);if(_0x3d77a8){const _0x93faaf=_0x3d77a8[0x1];let _0x73da48=getBotAttributes(_0x93faaf);_0x5cfc6['push']({'botID':_0x93faaf,'botname':_0x73da48[_0x2d81f0(0x2ea)],'status':'disabled','live':'stopped'}),_0x1cee03++;}}),_0x1cee03!=0x0&&(dbConfig[_0x45b30d(0x2d5)](_0x45b30d(0x2c1))['assign'](_0x5cfc6)['write'](),config=_0x5cfc6,restoredConfigFile=_0x1cee03);}}async function restoreConfigNotify(_0x51afeb){const _0x2fa9c2=_0x3ff819;let _0x26d828;if(restoredConfigFile==0x1)_0x26d828='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x26d828=_0x2fa9c2(0x278);if(_0x51afeb)io['to'](_0x2fa9c2(0x2cd))[_0x2fa9c2(0x1fa)](_0x2fa9c2(0x241),_0x26d828);else{logger[_0x2fa9c2(0x16b)]('-----------------------------------------------------------------------------------'),logger[_0x2fa9c2(0x16b)](_0x26d828),logger['simple'](_0x2fa9c2(0x1db)),logger[_0x2fa9c2(0x16b)]('');if(tgBot&&settings[_0x2fa9c2(0x219)]&&settings[_0x2fa9c2(0x166)]!=_0x2fa9c2(0x1b4))tgBot[_0x2fa9c2(0x2bd)](settings[_0x2fa9c2(0x219)],_0x2fa9c2(0x2d4)+_0x26d828)[_0x2fa9c2(0x1ac)](_0x3664e9=>{telegramError(_0x3664e9);});}}function validateCredentials(_0x1d2944,_0x29b9aa){const _0x182233=_0x3ff819;if(_0x1d2944[_0x182233(0x30b)]==settings[_0x182233(0x22e)]&&bcrypt[_0x182233(0x240)](_0x1d2944[_0x182233(0x1aa)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x182233(0x27f),'token':null};else{const _0x7ce216=generateLoginToken(_0x29b9aa);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x7ce216};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x231111){const _0x967853=_0x3ff819,_0x4a21a7=generateLoginToken(_0x231111);return{'allow':!![],'reason':_0x967853(0x1d2),'token':_0x4a21a7};}function validateAccess(_0x3ec986,_0x1183e9,_0x33f5a8){const _0x31612a=_0x3ff819,_0x4f0945=_0x33f5a8?_0x33f5a8:devices[_0x1183e9]['ip'];let _0x1e58cd;const _0x4db1c5=_0x853255=>{const _0x2b3d1b=_0x5e83;if(settings[_0x2b3d1b(0x1d8)]){if(settings[_0x2b3d1b(0x30d)]){if(telegram2FaApproved(_0x1183e9)){const _0x14db32=generateLoginToken(_0x1183e9);return{'allow':!![],'reason':_0x2b3d1b(0x221),'token':_0x14db32};}else return{'allow':![],'reason':_0x2b3d1b(0x171),'token':null};}else return _0x1e58cd=validToken(_0x853255,_0x1183e9),_0x1e58cd[_0x2b3d1b(0x303)](_0x2b3d1b(0x258))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x853255}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x2b3d1b(0x285),'token':null};};if(settings[_0x31612a(0x2eb)]){let _0x372cb5=[...settings[_0x31612a(0x254)],_0x31612a(0x324),_0x31612a(0x2a9),_0x31612a(0x25f)];if(_0x372cb5['includes'](_0x4f0945))return _0x4db1c5(_0x3ec986);else{_0x1e58cd=validToken(_0x3ec986,_0x1183e9);if(_0x1e58cd[_0x31612a(0x303)](_0x31612a(0x258)))return _0x4db1c5(_0x3ec986);else{if(telegramIpApproved(_0x1183e9)){const _0x2cea00=generateToken(_0x1183e9);return _0x1e58cd=_0x4db1c5(_0x3ec986),_0x1e58cd[_0x31612a(0x183)]?{'allow':!![],'reason':_0x31612a(0x1d3),'token':_0x2cea00}:_0x1e58cd;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x31612a(0x158),'token':null}:{'allow':![],'reason':_0x31612a(0x151),'token':null};}}}else return _0x4db1c5(_0x3ec986);}function timelyDecrypt(_0x2f0e35,_0x1e562a=!![]){const _0x413c9c=_0x3ff819;if(_0x2f0e35)try{const _0x100990=crypt[_0x413c9c(0x20b)](secure[_0x413c9c(0x1c1)],_0x2f0e35)[_0x413c9c(0x167)],_0x71947e=_0x100990[_0x413c9c(0x2c0)]('@')[0x0],_0x31d830=_0x100990['split']('@')[0x1],_0x4bf260=new Date()[_0x413c9c(0x322)]();if(_0x1e562a){if(_0x4bf260-_0x31d830<maxSecretAge*0x3e8)return _0x71947e;else return![];}else return _0x71947e;}catch(_0x1c0e44){return![];}else return![];}const validToken=(_0x2382e7,_0x3cc933)=>{const _0x200797=_0x3ff819,_0x55989a=devices[_0x3cc933]['ip'];if(!_0x2382e7)return{'error':_0x200797(0x198)};for(let _0x33730e of blacklist){if(_0x33730e[_0x200797(0x268)]==_0x2382e7)return{'error':'Token\x20blacklisted'};}let _0xfe7558;try{_0xfe7558=jwt[_0x200797(0x1b1)](_0x2382e7,secure[_0x200797(0x20d)]+_0x3cc933);}catch{return{'error':_0x200797(0x252)};}if(!_0xfe7558[_0x200797(0x303)]('clientip')&&!_0xfe7558[_0x200797(0x303)](_0x200797(0x30b))||!_0xfe7558[_0x200797(0x303)](_0x200797(0x2f9)))return{'error':_0x200797(0x22c)};if(!_0xfe7558[_0x200797(0x303)](_0x200797(0x30b))&&_0xfe7558[_0x200797(0x303)](_0x200797(0x1c8))){const {clientip:_0x7026b1}=_0xfe7558;return _0x55989a==_0x7026b1?{'success':_0x200797(0x31e)}:{'error':_0x200797(0x2f0)};}else{if(_0xfe7558[_0x200797(0x303)](_0x200797(0x30b))&&_0xfe7558[_0x200797(0x303)](_0x200797(0x1c8))){const {username:_0x38679b,clientip:_0x1e3536}=_0xfe7558;return settings[_0x200797(0x22e)]==_0x38679b&&_0x55989a==_0x1e3536?{'success':_0x200797(0x31e)}:{'error':_0x200797(0x229)};}}},generateLoginToken=_0x520269=>{const _0x3ed52b=_0x3ff819;if(_0x520269){const _0x280688=devices[_0x520269]['ip'];return jwt[_0x3ed52b(0x1b6)]({'username':settings['bbUsername'],'clientip':_0x280688},secure['secret']+_0x520269,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x36d299=>{const _0x3fdb40=_0x3ff819;if(_0x36d299){const _0x3ee933=devices[_0x36d299]['ip'];return jwt['sign']({'clientip':_0x3ee933},secure['secret']+_0x36d299,{'expiresIn':devices[_0x36d299][_0x3fdb40(0x299)][_0x3fdb40(0x20c)]*0x3c});}else return![];},telegramIpApproved=_0x11a54e=>{const _0x106b7a=_0x3ff819;let _0x3672fc=![];return devices[_0x11a54e][_0x106b7a(0x299)]&&devices[_0x11a54e][_0x106b7a(0x299)][_0x106b7a(0x20c)]!='reject'&&(_0x3672fc=devices[_0x11a54e][_0x106b7a(0x299)]['clientip']==devices[_0x11a54e]['ip']&&new Date()[_0x106b7a(0x322)]()-devices[_0x11a54e][_0x106b7a(0x299)][_0x106b7a(0x292)]<devices[_0x11a54e]['telegramIpApproval'][_0x106b7a(0x20c)]*0x3c*0x3e8),_0x3672fc;},telegram2FaApproved=_0x195a58=>{const _0x51e348=_0x3ff819;let _0x1ac449=![];return devices[_0x195a58]['telegram2FaApproval']&&devices[_0x195a58]['telegram2FaApproval'][_0x51e348(0x20c)]!='reject'&&(_0x1ac449=devices[_0x195a58][_0x51e348(0x28b)][_0x51e348(0x1c8)]==devices[_0x195a58]['ip']&&new Date()[_0x51e348(0x322)]()-devices[_0x195a58][_0x51e348(0x28b)][_0x51e348(0x292)]<devices[_0x195a58][_0x51e348(0x28b)][_0x51e348(0x20c)]*0x3c*0x3e8),_0x1ac449;},normalizeIP=_0x541844=>{const _0x5a73d6=_0x3ff819;let _0x4f2dc1=null,_0x58fcaf=null;if(ipaddr[_0x5a73d6(0x231)](_0x541844)){const _0x416097=ipaddr['parse'](_0x541844);_0x416097[_0x5a73d6(0x220)]()===_0x5a73d6(0x274)?(_0x416097[_0x5a73d6(0x2e7)]()&&(_0x4f2dc1=_0x416097[_0x5a73d6(0x246)]()[_0x5a73d6(0x177)]()),_0x58fcaf=_0x416097['toString']()):(_0x4f2dc1=_0x416097['toString'](),_0x58fcaf=_0x416097[_0x5a73d6(0x2c6)]()[_0x5a73d6(0x177)]());}return{'show':_0x4f2dc1?_0x4f2dc1:_0x58fcaf,'store':_0x58fcaf};};function formatDate(_0x5d0b8c){const _0x2aafc0=_0x3ff819;return _0x5d0b8c[_0x2aafc0(0x293)]()+'/'+(_0x5d0b8c[_0x2aafc0(0x31f)]()+0x1)[_0x2aafc0(0x177)]()[_0x2aafc0(0x290)](0x2,'0')+'/'+_0x5d0b8c[_0x2aafc0(0x1eb)]()['toString']()[_0x2aafc0(0x290)](0x2,'0')+'\x20'+_0x5d0b8c[_0x2aafc0(0x28f)]()['toString']()[_0x2aafc0(0x290)](0x2,'0')+':'+_0x5d0b8c['getMinutes']()[_0x2aafc0(0x177)]()[_0x2aafc0(0x290)](0x2,'0')+':'+_0x5d0b8c['getSeconds']()[_0x2aafc0(0x177)]()[_0x2aafc0(0x290)](0x2,'0');}function sleep(_0x44cf4c){return new Promise(_0x44d16a=>setTimeout(_0x44d16a,_0x44cf4c));}