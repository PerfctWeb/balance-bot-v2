const _0x5f2c03=_0xb091;(function(_0x56c4c4,_0x3a9d4b){const _0x2f0911=_0xb091,_0x584931=_0x56c4c4();while(!![]){try{const _0x2e1a83=parseInt(_0x2f0911(0x131))/0x1*(-parseInt(_0x2f0911(0x270))/0x2)+parseInt(_0x2f0911(0x289))/0x3+-parseInt(_0x2f0911(0x1ad))/0x4+parseInt(_0x2f0911(0x1e7))/0x5+-parseInt(_0x2f0911(0x216))/0x6*(-parseInt(_0x2f0911(0x1e9))/0x7)+-parseInt(_0x2f0911(0x115))/0x8+parseInt(_0x2f0911(0x128))/0x9;if(_0x2e1a83===_0x3a9d4b)break;else _0x584931['push'](_0x584931['shift']());}catch(_0x2fd91c){_0x584931['push'](_0x584931['shift']());}}}(_0x2377,0xe76f0));const _0x5ec933=function(){let _0x549c86=!![];return function(_0x477984,_0x5055ca){const _0x348555=_0x549c86?function(){const _0x56445b=_0xb091;if(_0x5055ca){const _0x1526ab=_0x5055ca[_0x56445b(0x213)](_0x477984,arguments);return _0x5055ca=null,_0x1526ab;}}:function(){};return _0x549c86=![],_0x348555;};}(),_0x55f3c5=_0x5ec933(this,function(){const _0x20e738=_0xb091;return _0x55f3c5[_0x20e738(0x276)]()['search']('(((.+)+)+)+$')[_0x20e738(0x276)]()[_0x20e738(0x13d)](_0x55f3c5)[_0x20e738(0xde)](_0x20e738(0xbb));});_0x55f3c5();'use strict';process[_0x5f2c03(0x1da)][_0x5f2c03(0x151)]=0x1;const childProcess=require(_0x5f2c03(0xd7)),fs=require('fs'),fns=require(_0x5f2c03(0x188)),low=require(_0x5f2c03(0x182)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x5f2c03(0x164)),crypto=require('crypto'),Crypt=require(_0x5f2c03(0x132))[_0x5f2c03(0x236)],RSA=require(_0x5f2c03(0x132))['RSA'],bcrypt=require(_0x5f2c03(0x18d)),jwt=require('jsonwebtoken'),ipaddr=require(_0x5f2c03(0x145)),argv=require(_0x5f2c03(0x10f))(process['argv'][_0x5f2c03(0x23b)](0x2))[_0x5f2c03(0x277)],uuidRandom=require(_0x5f2c03(0xf6)),TelegramBot=require(_0x5f2c03(0x286)),Mixpanel=require(_0x5f2c03(0xae)),axios=require(_0x5f2c03(0x112)),{GraphQLClient,gql}=require(_0x5f2c03(0x21c)),util=require('util'),fileUpload=require(_0x5f2c03(0x1f4)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x5f2c03(0x219)](PORT)&&(console[_0x5f2c03(0x16f)](_0x5f2c03(0x120)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x5f2c03(0x20f)](0x1));const HOST=argv[_0x5f2c03(0x16a)]||null,userID=argv[_0x5f2c03(0xb9)]||'',debugging=argv['d']||![],nodeversion=process[_0x5f2c03(0x180)][_0x5f2c03(0x1ea)],environment=require('./version.json')[_0x5f2c03(0x174)]||_0x5f2c03(0x1b2);let bbpath='bb/',bbpath2='';const botfile=_0x5f2c03(0x17e),configfile=_0x5f2c03(0x111),settingsfile=_0x5f2c03(0x183),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5f2c03(0x13b)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x5f2c03(0x11e),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x5f2c03(0x228),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x5f2c03(0x1d5)](logspath+_0x5f2c03(0x225),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x5f2c03(0xb4)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x5f2c03(0xb4)](configbackuppath)&&fs[_0x5f2c03(0xd9)](configbackuppath);!fs[_0x5f2c03(0xb4)](logspath)&&fs[_0x5f2c03(0xd9)](logspath);!fs[_0x5f2c03(0xb4)](zippath)&&fs[_0x5f2c03(0xd9)](zippath);!fs[_0x5f2c03(0xb4)](temppath)&&fs[_0x5f2c03(0xd9)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5f2c03(0x12e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5f2c03(0x1c5),'onepagemode':![]}})[_0x5f2c03(0x214)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5f2c03(0x12e)]({'secure':{},'blacklist':[]})[_0x5f2c03(0x214)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x5f2c03(0xfb)});const saltRounds=0xa,mixpanel=Mixpanel[_0x5f2c03(0x208)](_0x5f2c03(0x168),{'host':_0x5f2c03(0x21f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x5f2c03(0x196)]!=''&&settings[_0x5f2c03(0x24a)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x3dc97c,_0x17a0d4)=>{const _0xfbc61e=_0x5f2c03,_0x196508=/#[A-Z]{3}#/g;if(typeof _0x3dc97c==_0xfbc61e(0x1e8)){!_0x17a0d4?_0x3dc97c=_0x3dc97c[_0xfbc61e(0x257)](_0x196508,''):(_0x3dc97c=_0x3dc97c[_0xfbc61e(0x257)](/#BLU#/g,_0xfbc61e(0x104)),_0x3dc97c=_0x3dc97c[_0xfbc61e(0x257)](/#RED#/g,'\x1b[31m'),_0x3dc97c=_0x3dc97c['replace'](/#YEL#/g,_0xfbc61e(0x1d6)),_0x3dc97c=_0x3dc97c['replace'](/#MAG#/g,_0xfbc61e(0xf9)),_0x3dc97c=_0x3dc97c[_0xfbc61e(0x257)](/#CYA#/g,_0xfbc61e(0x264)),_0x3dc97c=_0x3dc97c['replace'](/#RES#/g,_0xfbc61e(0x1c8)));;}return _0x3dc97c;},logger={'screen':_0x361f47=>{console['log'](parseColor(_0x361f47,!![]));},'simple':_0x567532=>{const _0x243b4e=_0x5f2c03;console[_0x243b4e(0x16f)](parseColor(_0x567532,!![])),loggerfile[_0x243b4e(0x214)](util[_0x243b4e(0xe0)](parseColor(_0x567532,![]))+'\x0a');},'full':async _0x3b9adf=>{const _0x5d4313=_0x5f2c03,_0xc239ce=getTimeStamp()+_0x5d4313(0x114)+_0x3b9adf;console[_0x5d4313(0x16f)](parseColor(_0xc239ce,!![])),loggerfile['write'](util['format'](parseColor(_0xc239ce,![]))+'\x0a');if(tgBot&&settings[_0x5d4313(0x144)]&&settings[_0x5d4313(0x26e)]!=_0x5d4313(0x110))await tgBot[_0x5d4313(0xba)](settings[_0x5d4313(0x144)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x3b9adf,![]))[_0x5d4313(0x20e)](_0x633d46=>{telegramError(_0x633d46);});},'debug':async(_0x1d7254,_0xadc88d='')=>{const _0x1a4bdf=_0x5f2c03,_0x5aaea7=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x1d7254;if(debugging)console[_0x1a4bdf(0x16f)](parseColor(_0x5aaea7,!![]));loggerfile['write'](util['format'](parseColor(_0x5aaea7,![]))+'\x0a');if(_0xadc88d){if(debugging)console[_0x1a4bdf(0x16f)](_0xadc88d);loggerfile['write'](util[_0x1a4bdf(0xe0)](_0xadc88d)+'\x0a');}}};process['on'](_0x5f2c03(0x184),function(_0x38b070){const _0x198fbd=_0x5f2c03;logger[_0x198fbd(0x191)](_0x38b070);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x5f2c03(0x1c3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5f2c03(0x255)),app=express(),http=require(_0x5f2c03(0x171))[_0x5f2c03(0x117)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x5f2c03(0x243)](_0x5f2c03(0x24c),async(_0x1dcadc,_0x8366d7)=>{const _0x1fdfee=_0x5f2c03,_0x465703=_0x1dcadc[_0x1fdfee(0x12c)][_0x1fdfee(0x205)],_0x207627=getClientsWithBotID(_0x1fdfee(0x1e5)),_0x48f5ec=_0x1dcadc[_0x1fdfee(0x1f2)][_0x1fdfee(0xe1)],_0x3a0d0a=timelyDecrypt(_0x48f5ec,![]),_0x447dcd=_0x207627[_0x1fdfee(0xb6)](_0x4ab659=>_0x4ab659[_0x1fdfee(0xe1)]==_0x3a0d0a);if(_0x447dcd){const _0x10ea44=normalizeIP(_0x1dcadc[_0x1fdfee(0x269)][_0x1fdfee(0x1ae)])[_0x1fdfee(0x251)],_0x4c7682=_0x1dcadc[_0x1fdfee(0x1f2)][_0x1fdfee(0x246)];if(validateAccess(_0x4c7682,_0x3a0d0a,_0x10ea44)['allow'])_0x465703=='backup'&&await backupConfigFiles(),await zipFiles(_0x465703),_0x8366d7[_0x1fdfee(0x231)](zippath+(_0x465703+_0x1fdfee(0x1a8)),_0x5e25de=>{const _0x47c6f7=_0x1fdfee;_0x5e25de&&(logger[_0x47c6f7(0x22e)](_0x47c6f7(0x266)+_0x465703),logger['simple'](_0x5e25de));});else logger[_0x1fdfee(0x22e)](_0x1fdfee(0x1a0)+_0x465703+_0x1fdfee(0x1a7));}else logger[_0x1fdfee(0x22e)](_0x1fdfee(0x1a0)+_0x465703+_0x1fdfee(0xe2));}),app['post']('/upload-backup',async(_0x7de23f,_0x392c01)=>{const _0x48b858=_0x5f2c03,_0x4a674d=getClientsWithBotID('botmanager'),_0x2f33d5=_0x7de23f[_0x48b858(0x1f2)]['uuid'],_0x55428a=timelyDecrypt(_0x2f33d5,![]),_0x49f427=_0x4a674d[_0x48b858(0xb6)](_0x143152=>_0x143152[_0x48b858(0xe1)]==_0x55428a);logger['debug']('Backup\x20file\x20uploaded');if(_0x49f427){const _0x16d977=normalizeIP(_0x7de23f[_0x48b858(0x269)][_0x48b858(0x1ae)])[_0x48b858(0x251)],_0x218fc7=_0x7de23f[_0x48b858(0x1f2)]['tkn'];if(validateAccess(_0x218fc7,_0x55428a,_0x16d977)[_0x48b858(0x139)]){if(_0x7de23f[_0x48b858(0x25d)]){const _0x44f7f9=_0x7de23f[_0x48b858(0x25d)][_0x48b858(0x1fd)];await _0x44f7f9['mv'](temppath+_0x44f7f9['name']),_0x392c01[_0x48b858(0x20b)]({'status':!![],'message':'File\x20uploaded'});const _0x301e79=getBotsWithMode();_0x301e79['length']>0x0?confirmRestore(temppath,_0x44f7f9[_0x48b858(0x22d)]):unzipFile(temppath,_0x44f7f9[_0x48b858(0x22d)]);}}else logger[_0x48b858(0x22e)](_0x48b858(0x232));}else logger[_0x48b858(0x22e)](_0x48b858(0x1be));}),app['use'](express['static'](path[_0x5f2c03(0xfe)](__dirname,bbpath2,_0x5f2c03(0x126)))),app[_0x5f2c03(0x1aa)](express[_0x5f2c03(0x10a)](path['join'](__dirname,bbpath2,_0x5f2c03(0xdf)))),app[_0x5f2c03(0x243)]('/',function(_0x24ff90,_0xc801f2){const _0x5f7af=_0x5f2c03;_0xc801f2['sendFile'](path[_0x5f7af(0xfe)](__dirname,bbpath2,_0x5f7af(0x126),'index.html'));}),app['get'](_0x5f2c03(0xc6),function(_0x4b0978,_0x3ee452){const _0x2349d9=_0x5f2c03;_0x3ee452['sendFile'](path[_0x2349d9(0xfe)](__dirname,bbpath2,'build',_0x2349d9(0x209)));}),app[_0x5f2c03(0x243)](_0x5f2c03(0x19e),(_0x245969,_0x4c23af)=>{const _0x530350=_0x5f2c03;_0x4c23af['sendFile'](path[_0x530350(0xfe)](__dirname,bbpath2,'build',_0x530350(0x209)));}),app['get'](_0x5f2c03(0xe7),(_0x47b447,_0x47a7da)=>{const _0x499694=_0x5f2c03;_0x47a7da['sendFile'](path[_0x499694(0xfe)](__dirname,bbpath2,_0x499694(0xdf),_0x499694(0x209)));}),app['get'](_0x5f2c03(0xcb),(_0x4c3817,_0x232607)=>{const _0x329633=_0x5f2c03;_0x232607[_0x329633(0xce)](path[_0x329633(0xfe)](__dirname,bbpath2,'build',_0x329633(0x209)));}),app['get']('/:bot/history',(_0x5eac60,_0x4c36f9)=>{const _0x47c915=_0x5f2c03;_0x4c36f9[_0x47c915(0xce)](path['join'](__dirname,bbpath2,_0x47c915(0xdf),_0x47c915(0x209)));}),app[_0x5f2c03(0x243)](_0x5f2c03(0xaf),(_0x2c5c12,_0x2390bb)=>{const _0x37d63f=_0x5f2c03;_0x2390bb['sendFile'](path[_0x37d63f(0xfe)](__dirname,bbpath2,_0x37d63f(0xdf),_0x37d63f(0x209)));}),app[_0x5f2c03(0x243)](_0x5f2c03(0xca),(_0x5dc49e,_0x540cee)=>{const _0x254e56=_0x5f2c03;_0x540cee[_0x254e56(0xce)](path[_0x254e56(0xfe)](__dirname,bbpath2,_0x254e56(0xdf),_0x254e56(0x209)));});if(HOST)http['listen'](PORT,HOST);else http[_0x5f2c03(0x124)](PORT);const io=require(_0x5f2c03(0x211))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5017e4=_0x5f2c03;let _0x3c37e5='[ip-address]';const _0x1acf26=networkInterfaces(),_0x412e9a={};for(const _0x13c2b9 of Object['keys'](_0x1acf26)){for(const _0x31bcd5 of _0x1acf26[_0x13c2b9]){if((_0x31bcd5[_0x5017e4(0xee)]==_0x5017e4(0x134)||_0x31bcd5[_0x5017e4(0xee)]==0x4)&&!_0x31bcd5[_0x5017e4(0x15d)]){const _0x184342=ipaddr[_0x5017e4(0x1b1)](_0x31bcd5['address'])['range']();_0x184342!=_0x5017e4(0x26b)&&(!_0x412e9a[_0x13c2b9]&&(_0x412e9a[_0x13c2b9]=[]),_0x412e9a[_0x13c2b9][_0x5017e4(0x105)](_0x31bcd5['address']),_0x3c37e5=_0x31bcd5[_0x5017e4(0x17a)]);}}}return{'serverip':_0x3c37e5,'netinterfaces':_0x412e9a};}async function startServer(){const _0x3a066c=_0x5f2c03,{serverip:_0x49a214,netinterfaces:_0xa02c00}=getServerIP();logger[_0x3a066c(0x191)](''),logger['simple'](_0x3a066c(0x1b0)),await logger[_0x3a066c(0x22e)](_0x3a066c(0x1c0)+serverversion+_0x3a066c(0xc5)+(environment=='staging'?_0x3a066c(0x173):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x3a066c(0x1a6))+(_0x3a066c(0x249)+_0x49a214+':'+PORT+_0x3a066c(0x221))),logger[_0x3a066c(0x191)](_0x3a066c(0x1b0));if(config['length']!=0x0)for(const _0x471de1 of config){if(_0x471de1[_0x3a066c(0x1c7)]==_0x3a066c(0x138)||_0x471de1[_0x3a066c(0x1c7)]=='new')await logger[_0x3a066c(0x22e)](_0x3a066c(0x244)+_0x471de1[_0x3a066c(0x1ba)]+_0x3a066c(0x178)+_0x471de1['botname']),startBot([_0x471de1[_0x3a066c(0x1ba)],userID],{'cwd':bbpath},function(_0x4d0445){const _0x428b86=_0x3a066c;if(_0x4d0445)logger[_0x428b86(0x22e)](_0x4d0445);});else(_0x471de1['status']=='disabled'||_0x471de1[_0x3a066c(0x1c7)]==_0x3a066c(0x248))&&await logger[_0x3a066c(0x22e)](_0x3a066c(0x1b8)+_0x471de1['botID']+_0x3a066c(0x178)+_0x471de1['botname']);}else!newBot&&logger[_0x3a066c(0x191)](_0x3a066c(0x133));if(newBot)addBot();logger['simple'](_0x3a066c(0x1b0)),logger[_0x3a066c(0x191)](''),await logger[_0x3a066c(0x1fa)](_0x3a066c(0x238)+nodeversion),await logger['debug'](_0x3a066c(0x137),_0xa02c00);}function startSocket(){const _0x409d98=_0x5f2c03;io['on'](_0x409d98(0x136),_0x1db7b8=>{const _0x48e179=_0x409d98;let _0x370a72,_0x368ed3,_0x1c5838,_0x35092b,_0x52ad93;const _0x16503a=_0x1db7b8[_0x48e179(0x247)][_0x48e179(0x1f2)][_0x48e179(0xf7)];_0x368ed3=_0x16503a['match'](/bot[0-9]{3}/);if(_0x368ed3)_0x1c5838=_0x368ed3[0x0]['match'](/[0-9]{3}/);if(_0x1c5838)_0x370a72=_0x1c5838[0x0];else _0x370a72=_0x48e179(0x1e5);const _0x589020=_0x1db7b8[_0x48e179(0x247)][_0x48e179(0x24d)][_0x48e179(0x14d)];if(!_0x589020)_0x1db7b8[_0x48e179(0x15c)](_0x48e179(0x1c7),{'publicKey':secure['publicKey']});else{_0x35092b=timelyDecrypt(_0x589020,![]);if(!_0x35092b)_0x1db7b8[_0x48e179(0x15c)](_0x48e179(0x1c7),{'publicKey':secure[_0x48e179(0x26f)]});else{_0x52ad93=normalizeIP(_0x1db7b8[_0x48e179(0xf5)][_0x48e179(0x1ae)])[_0x48e179(0x251)];if(!devices[_0x35092b])devices[_0x35092b]={'uuid':_0x35092b,'access':{'token':null}};devices[_0x35092b]['ip']=_0x52ad93;const _0x3d9ee6=addClient(_0x1db7b8['id'],_0x35092b,_0x370a72);setAccess(_0x3d9ee6),emitMessages(),_0x1db7b8['on'](_0x48e179(0x1dc),_0x56bc9e=>{const _0x3c98b1=_0x48e179,_0x664616=timelyDecrypt(_0x56bc9e[_0x3c98b1(0x154)]);if(_0x664616){_0x56bc9e={'username':_0x56bc9e[_0x3c98b1(0x271)],'password':_0x664616},devices[_0x35092b]['access']=validateCredentials(_0x56bc9e,_0x35092b);if(devices[_0x35092b][_0x3c98b1(0x141)]['allow']==![]&&devices[_0x35092b][_0x3c98b1(0x141)]['reason']==_0x3c98b1(0x1c6))_0x1db7b8['emit']('status',{'access':devices[_0x35092b]['access']}),loginAccess2FA(_0x35092b,_0x52ad93);else{if(devices[_0x35092b][_0x3c98b1(0x141)]['allow']==![]&&devices[_0x35092b][_0x3c98b1(0x141)][_0x3c98b1(0x259)]=='invalid\x20credentials')_0x1db7b8['emit'](_0x3c98b1(0x1c7),{'access':devices[_0x35092b][_0x3c98b1(0x141)]});else devices[_0x35092b][_0x3c98b1(0x141)][_0x3c98b1(0x139)]&&devices[_0x35092b][_0x3c98b1(0x141)][_0x3c98b1(0x259)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x35092b)[_0x3c98b1(0x194)](_0x2ae2a7=>{setAccess(_0x2ae2a7);}),logger[_0x3c98b1(0x1fa)]('Logged\x20in\x20user\x20...'+_0x35092b['slice'](-0x8)),setTokenRefresh(_0x35092b),setSessionTimeout(_0x3c98b1(0x1dc),_0x35092b));}}else logger['full'](_0x3c98b1(0x172));}),_0x1db7b8['on']('reset-password',()=>{resetPassword();}),_0x1db7b8['on']('disconnect',_0x1656d5=>{removeClient(_0x1db7b8['id']);}),_0x370a72==_0x48e179(0x1e5)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5168fe){const _0x3d4fbe=_0x5f2c03;if(_0x5168fe!=_0x3d4fbe(0x1e5)&&config[_0x3d4fbe(0xbe)]!=''){if(pid[_0x5168fe])pid[_0x5168fe][_0x3d4fbe(0x20b)]({'function':_0x3d4fbe(0xf1),'args':null});}_0x5168fe!=_0x3d4fbe(0x1e5)&&broadcastToBots(_0x3d4fbe(0x240),JSON['stringify'](config));}function reloadBotManager(){const _0x14240c=_0x5f2c03;getClientsWithBotID(_0x14240c(0x1e5))['forEach'](_0xf5b45d=>{const _0x38aaa6=_0x14240c;getSocket(_0xf5b45d['id'])[_0x38aaa6(0x15c)](_0x38aaa6(0x1c7),{'access':{'allow':![],'reason':_0x38aaa6(0x27a),'token':null}});});}function getSocket(_0x15e9f8){const _0x262384=_0x5f2c03;return io[_0x262384(0xe5)][_0x262384(0xe5)][_0x262384(0x243)](_0x15e9f8);}function setAccess(_0x15ccdf){const _0x1dba2b=_0x5f2c03,_0x578dfc=getSocket(_0x15ccdf['id']),_0x1ac04e=_0x15ccdf[_0x1dba2b(0xe1)],_0x1e8bba=_0x15ccdf[_0x1dba2b(0x245)];devices[_0x1ac04e][_0x1dba2b(0x141)]=validateAccess(devices[_0x1ac04e][_0x1dba2b(0x141)][_0x1dba2b(0x161)],_0x1ac04e),logger['debug'](_0x1dba2b(0x193)+devices[_0x1ac04e]['access'][_0x1dba2b(0x259)]+_0x1dba2b(0x1ff)+_0x15ccdf['id'][_0x1dba2b(0x23b)](-0x8)+_0x1dba2b(0x1f3)+_0x1ac04e['slice'](-0x8)),_0x578dfc[_0x1dba2b(0xfe)](_0x1ac04e);if(devices[_0x1ac04e]['access'][_0x1dba2b(0x139)]){_0x578dfc[_0x1dba2b(0xfe)](_0x1e8bba);if(_0x1e8bba=='botmanager')initializeSocketBotManager(_0x578dfc);else initializeSocketBot(_0x578dfc);initClient(_0x1e8bba);}devices[_0x1ac04e][_0x1dba2b(0x141)][_0x1dba2b(0x161)]&&devices[_0x1ac04e][_0x1dba2b(0x141)]['reason']==_0x1dba2b(0x261)&&setSessionTimeout(_0x1dba2b(0x1d1),_0x1ac04e),devices[_0x1ac04e][_0x1dba2b(0x141)]['token']&&devices[_0x1ac04e][_0x1dba2b(0x141)][_0x1dba2b(0x259)]==_0x1dba2b(0x1af)&&setSessionTimeout(_0x1dba2b(0x1dc),_0x1ac04e),_0x578dfc['emit'](_0x1dba2b(0x1c7),{'status':_0x15ccdf['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1ac04e][_0x1dba2b(0x141)],'externalip':devices[_0x1ac04e]['ip'],'publicKey':secure[_0x1dba2b(0x26f)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x1ac04e]['access'][_0x1dba2b(0x139)]==![]&&devices[_0x1ac04e][_0x1dba2b(0x141)][_0x1dba2b(0x259)]==_0x1dba2b(0x1f1)&&temporaryAccess2FA(_0x1ac04e,devices[_0x1ac04e]['ip']);}function _0xb091(_0x294b60,_0x546487){const _0x3528bd=_0x2377();return _0xb091=function(_0x55f3c5,_0x5ec933){_0x55f3c5=_0x55f3c5-0xad;let _0x23776f=_0x3528bd[_0x55f3c5];return _0x23776f;},_0xb091(_0x294b60,_0x546487);}function setSessionTimeout(_0x51f9b9,_0x54aeb){const _0x3fd75d=_0x5f2c03;let _0x3a3422;if(_0x51f9b9==_0x3fd75d(0x1dc))_0x3a3422=loginExpiry*0x3c*0x3e8;else _0x3a3422=devices[_0x54aeb]['telegramIpApproval'][_0x3fd75d(0x1d3)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x54aeb]['telegramIpApproval']['timestamp']);if(devices[_0x54aeb][_0x3fd75d(0x181)])clearTimeout(devices[_0x54aeb][_0x3fd75d(0x181)]);devices[_0x54aeb][_0x3fd75d(0x181)]=setTimeout(()=>{const _0x10efa1=_0x3fd75d;if(devices[_0x54aeb][_0x10efa1(0x274)])clearTimeout(devices[_0x54aeb][_0x10efa1(0x274)]);removeSocketListeners(_0x54aeb),addBlacklist(_0x54aeb),devices[_0x54aeb][_0x10efa1(0x20a)]=null,devices[_0x54aeb][_0x10efa1(0x227)]=null,devices[_0x54aeb][_0x10efa1(0x141)][_0x10efa1(0x161)]=null,logger[_0x10efa1(0x1fa)](_0x10efa1(0x158)+_0x54aeb[_0x10efa1(0x23b)](-0x8)),devices[_0x54aeb][_0x10efa1(0x141)]=validateAccess(devices[_0x54aeb][_0x10efa1(0x141)][_0x10efa1(0x161)],_0x54aeb),!(devices[_0x54aeb][_0x10efa1(0x141)][_0x10efa1(0x139)]&&devices[_0x54aeb]['access'][_0x10efa1(0x259)]==_0x10efa1(0xd4))&&(_0x51f9b9==_0x10efa1(0x1dc)?io['to'](_0x54aeb)['emit']('status',{'access':{'allow':![],'reason':_0x10efa1(0x165),'token':null}}):io['to'](_0x54aeb)['emit'](_0x10efa1(0x1c7),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x54aeb][_0x10efa1(0x141)][_0x10efa1(0x161)]=null;},_0x3a3422);}function _0x2377(){const _0x3e242d=['Password\x20reset\x20rejected','showConfig','Orders','/:bot/portfolio','getDate','Unauthorized\x20attempt\x20to\x20download\x20','yes','</b>\x20?','Enabled\x20Bot\x20','-results.json','sign','#RES#\x20if\x20running\x20locally\x0a','\x20(1)','.zip','15\x20min','use','restore-backup-file','Ok,\x20will\x20send\x20alert\x20notifications\x20only','6190180SaqILU','remoteAddress','2FA\x20login\x20token\x20generated','-----------------------------------------------------------------------------------','parse','production','settings.','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','function','getMonth','map','Idling\x20bot\x20\x20\x20|\x20Bot\x20','store-fiat','botID','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','logs','binary','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','store-headless','Starting\x20#RED#Balance\x20Bot\x20v','-events.json','HTML','version','args','0.0.0','2FA\x20login\x20required','status','\x1b[0m','***','Alerts','once','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','track','2FA\x20login\x20rejected','whitelist','delete-bot','2FA','404\x20Not\x20Found','expiry','\x20minutes','createWriteStream','\x1b[33m','Invalid\x20authentication\x20token\x20(1)','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','min','env','connected','login','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/enable\x20-\x20enable\x20notifications\x0a','reject','User\x20has\x20been\x20validated','blacklist','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','writeFileSync','Unauthorized\x20attempt\x20to\x20delete\x20bot','botmanager','cloneDeep','4955170ZreKUR','string','84mVNtVp','node','bot-','bbUsername','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','mtime','/disable\x20-\x20disable\x20notifications\x0a','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','2FA\x20required','headers','\x20|\x20user:\x20...','express-fileupload','Token\x20blacklisted','new','filter','Restoring\x20bot(s)\x20from\x20backup','get-portfolio','debug','login\x20token\x20valid','Disabled\x20Bot\x20','backupfile','getTime','\x20|\x20client:\x20...','ipc','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','backup-files','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','request','type','message','f2aRequired','init','index.html','telegramIpApproval','send','file','order','catch','exit','No\x20authentication\x20token','socket.io','reset-history','apply','write','privateKey','777918ArTnIy','isValid','\x20>\x20','test','5\x20min','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','graphql-request','Backup\x20file\x20unzipped\x20and\x20stored','success','api-eu.mixpanel.com','timestamp','#RES#\x20if\x20running\x20on\x20server','\x20mode','30\x20min','update-bot','/output-000.log','title','telegram2FaApproval','logs/','toggleBotMode','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','stopped','inherit','name','full','Error\x20while\x20deleting\x20config\x20files:\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','download','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Password\x20has\x20been\x20reset\x20to:\x20','output-002.log','updatebotmanager','Crypt','cancel-loading','Node.js\x20v','removeListener','Unauthorized\x20attempt\x20to\x20confirm\x20message','slice','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20get\x20events','temporaryAccessAllowed','deleteHistoryAlerts','bots','Allow\x20login\x20from\x20IP\x20address\x20<b>','set','get','Starting\x20bot\x20|\x20Bot\x20','bot','tkn','handshake','new-disabled','=>\x20Go\x20to\x20#CYA#http://','telegramUsername','copyFileSync','/download/:type','auth','lastmsgtelegram','backup-full.zip','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','store','Notifications\x20disabled','$1_$2_$3','statSync','express','Your\x20installation\x20is\x20already\x20up\x20to\x20date','replace','includes','reason','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','then','files','Ok,\x20will\x20send\x20order\x20notifications\x20only','readdirSync','onepagemode','temporary\x20token\x20generated','getFullYear','storeHeadless','\x1b[36m','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Failed\x20to\x20download\x20','Notifications\x20enabled\x0a','backup-full@','socket','telegramEnabled','private','padStart','node-zip','telegramEvents','publicKey','1452014qVsMhI','username','getStartingBalances','telegrammsg','pidRefreshToken','stringify','toString','argv','userid','getSeconds','reload','Error\x20removing\x20old\x20backup\x20files:','decrypt','hasOwnProperty','apiSecret','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','stopPolling','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','storeConfiguration','Notifications\x20types:\x20','Starting\x20Balance\x20Bot\x20update','/restart\x20-\x20restart\x20bot(s)\x0a','node-telegram-bot-api','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','callback_query','3730008fLXpCh','value','\x20to\x20','************','mixpanel','/:bot/configuration','sendPortfolioTelegram','exchange','getUTCHours','toggle-bot-mode','existsSync','Unauthorized\x20attempt\x20to\x20update\x20bot','find','compareSync','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','user','sendMessage','(((.+)+)+)+$','kill','SIGINT','apiKey','length','latestversion','started','Restore\x20backup\x20file\x20','settings','login\x20required','#RES#\x20','/:bot','/status\x20-\x20show\x20bot(s)\x20status\x0a','add-bot','update','/:bot/support','/:bot/coins','reinstall','sort','sendFile','apiPassword','Bot\x20','Restore\x20process\x20aborted','split','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','login\x20not\x20required','disabled','Logged\x20out\x20user\x20...','child_process','<b>Telegram\x20Bot\x20Status:</b>\x0a','mkdirSync','1000','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','running','127.0.0.1','search','build','format','uuid','\x20(2)','secure','rmSync','sockets','bbvNew','/:bot/performance','auto','disconnect','get-logs','alias','accept','unlinkSync','family','Deleted\x20Bot\x20','telegram','initclient','endsWith','resetHistory','secret','conn','uuid-random','referer','manual','\x1b[35m','Invalid\x20authentication\x20token\x20(2)','RSA-OAEP','lastmsgemitted','You\x20can\x20use\x20the\x20following\x20commands:\x0a','join','Unauthorized\x20attempt\x20to\x20log\x20out','whitelistEnabled','Notifications\x20disabled\x0a','from','-config.json','\x1b[34m','push','assign','all','get-messages','output-000.log','static','error','sendMetricsTelegram','/update\x20-\x20update\x20Balance\x20Bot\x0a','onText','yargs/yargs','orders','bb-config.json','axios','botname',':\x20Bot\x20Mgr\x20>\x20','10342456BNvcdW','mode','createServer','::ffff:127.0.0.1','answerCallbackQuery','readFileSync','place-order','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','-performance.json','backup/','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Error:\x20Invalid\x20argument\x20','Server','startsWith','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','listen','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','build2','exp','6516945CKPjms','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','warning','Unauthorized\x20attempt\x20to\x20get\x20portfolio','params','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','defaults','getPortfolio','update-bb','1nYfLAE','hybrid-crypto-js','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','IPv4','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','connection','Network\x20Interfaces:','enabled','allow','live','clients','remove','constructor',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','isDirectory','clientip','access','All\x20bots','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','telegramChatId','ipaddr.js','loginRequired','confirm-message','invalid\x20credentials','\x20only\x0a','delete-alerts','stop','bb-secure.json','encryptedUuid','Invalid\x20Telegram\x20token','getHours','Starting\x20new\x20bot\x20|\x20Bot\x20','NTBA_FIX_319','backup-full','show','password','/names\x20-\x20show\x20bot\x20names\x0a','getMinutes','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Session\x20expired\x20for\x20user\x20...','timeshift','ipv6','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','emit','internal','alerts','data','DEFLATE','token','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Restarting\x20Bot\x20','path','access\x20timeout','login\x20token\x20generated','backup','6b67f3d61ee94b8f5c80b4affef4c4d9','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','host','All','event','any','headless','log','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','http','Unauthorized\x20login\x20attempt\x20(timeout)','(staging)','environment','randomFillSync','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','storeFiat','\x20|\x20','No\x20bots\x20running\x20right\x20now','address','logout','_data','Starting\x20Balance\x20Bot\x20reinstallation','bot.js','Notifications\x20enabled','versions','pidExpireLogin','lowdb','bb-settings.json','uncaughtException','Unauthorized\x20attempt\x20to\x20get\x20messages','output-001.log','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','date-fns','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','hashSync','randomBytes','/help\x20-\x20show\x20available\x20commands\x0a','bcryptjs','Unauthorized\x20attempt\x20to\x20show\x20configuration','bbPassword','messages','simple','sortBy','Setting\x20access:\x20','forEach','Yes','telegramToken','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','chat','Login\x20accepted','temporary\x20access\x20not\x20allowed'];_0x2377=function(){return _0x3e242d;};return _0x2377();}function setTokenRefresh(_0x38ff71){const _0xa9e9d6=_0x5f2c03;if(devices[_0x38ff71][_0xa9e9d6(0x274)])clearTimeout(devices[_0x38ff71][_0xa9e9d6(0x274)]);devices[_0x38ff71]['pidRefreshToken']=setTimeout(()=>{const _0x1931f6=_0xa9e9d6;getClientsWithUuid(_0x38ff71)[_0x1931f6(0xbf)]!=0x0?(devices[_0x38ff71][_0x1931f6(0x141)]=refreshToken(_0x38ff71),io['to'](_0x38ff71)[_0x1931f6(0x15c)](_0x1931f6(0x1c7),{'status':_0x1931f6(0x1db),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x38ff71][_0x1931f6(0x141)],'externalip':devices[_0x38ff71]['ip'],'publicKey':secure[_0x1931f6(0x26f)],'validInstallation':validInstallation}),setTokenRefresh(_0x38ff71)):clearTimeout(devices[_0x38ff71][_0x1931f6(0x274)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2d3e29){const _0x4da141=_0x5f2c03,_0x4c1d9e=getClient(_0x2d3e29['id'])['uuid'];_0x2d3e29[_0x4da141(0x15c)](_0x4da141(0x240),config),_0x2d3e29[_0x4da141(0x15c)](_0x4da141(0xc3),cleanSettings()),_0x2d3e29['on'](_0x4da141(0xc8),_0x4ca467=>{const _0x5a44a3=_0x4da141;if(validateAccess(_0x4ca467,_0x4c1d9e)[_0x5a44a3(0x139)])addBot();else logger[_0x5a44a3(0x22e)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2d3e29['on'](_0x4da141(0x224),(_0x21f395,_0x4901e9)=>{const _0x540b2e=_0x4da141;if(validateAccess(_0x4901e9,_0x4c1d9e)[_0x540b2e(0x139)])toggleBot(_0x21f395[_0x540b2e(0x1ba)],_0x21f395[_0x540b2e(0x1c7)],_0x21f395[_0x540b2e(0x13a)]);else logger[_0x540b2e(0x22e)](_0x540b2e(0xb5));}),_0x2d3e29['on'](_0x4da141(0xb3),(_0x40803a,_0x2b4332)=>{const _0x26c883=_0x4da141;if(validateAccess(_0x2b4332,_0x4c1d9e)[_0x26c883(0x139)])toggleBotMode(_0x40803a);else logger[_0x26c883(0x22e)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2d3e29['on'](_0x4da141(0x1d0),(_0x4ab8ab,_0x27ab97)=>{const _0x1f3aa0=_0x4da141;if(validateAccess(_0x27ab97,_0x4c1d9e)[_0x1f3aa0(0x139)])deleteBot(_0x4ab8ab);else logger['full'](_0x1f3aa0(0x1e4));}),_0x2d3e29['on']('store-settings',(_0x1454fd,_0x2f475b)=>{const _0x4c2e55=_0x4da141;if(validateAccess(_0x2f475b,_0x4c1d9e)[_0x4c2e55(0x139)])storeSettings(_0x1454fd,!![]);else logger[_0x4c2e55(0x22e)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2d3e29['on'](_0x4da141(0x130),_0x187d88=>{const _0x4d473f=_0x4da141;if(validateAccess(_0x187d88,_0x4c1d9e)[_0x4d473f(0x139)])updateBB('update');else logger['full'](_0x4d473f(0x21b));}),_0x2d3e29['on']('reinstall-bb',_0x2b9af4=>{const _0x312a42=_0x4da141;if(validateAccess(_0x2b9af4,_0x4c1d9e)['allow'])updateBB(_0x312a42(0xcc));else logger[_0x312a42(0x22e)](_0x312a42(0xd3));}),_0x2d3e29['on']('get-backup-files',_0x1e3720=>{const _0x132c18=_0x4da141;if(validateAccess(_0x1e3720,_0x4c1d9e)[_0x132c18(0x139)]){const _0x5905ac=getClient(_0x2d3e29['id']);if(_0x5905ac)getBackupFiles(_0x5905ac[_0x132c18(0xe1)]);else logger[_0x132c18(0x22e)](_0x132c18(0x27f));}else logger[_0x132c18(0x22e)](_0x132c18(0xb8));}),_0x2d3e29['on'](_0x4da141(0x1ab),(_0x2b100a,_0x25b615)=>{const _0x455e8a=_0x4da141;if(validateAccess(_0x25b615,_0x4c1d9e)[_0x455e8a(0x139)])restoreBackupFile(_0x2b100a);else logger[_0x455e8a(0x22e)](_0x455e8a(0x187));}),_0x2d3e29['on'](_0x4da141(0x108),_0x1d22f3=>{const _0xb4787b=_0x4da141;if(validateAccess(_0x1d22f3,_0x4c1d9e)[_0xb4787b(0x139)])getMessages();else logger[_0xb4787b(0x22e)](_0xb4787b(0x185));}),_0x2d3e29['on'](_0x4da141(0x147),(_0xb9174c,_0x39f44d)=>{const _0x1594ad=_0x4da141;if(validateAccess(_0x39f44d,_0x4c1d9e)[_0x1594ad(0x139)])confirmMessage(_0xb9174c);else logger['full'](_0x1594ad(0x23a));}),_0x2d3e29['on'](_0x4da141(0x17b),_0x53a6dd=>{const _0x4aac4f=_0x4da141;if(validateAccess(_0x53a6dd,_0x4c1d9e)[_0x4aac4f(0x139)]){if(devices[_0x4c1d9e]['pidRefreshToken'])clearTimeout(devices[_0x4c1d9e][_0x4aac4f(0x274)]);if(devices[_0x4c1d9e]['pidExpireLogin'])clearTimeout(devices[_0x4c1d9e][_0x4aac4f(0x181)]);removeSocketListeners(getClient(_0x2d3e29['id'])[_0x4aac4f(0xe1)]),addBlacklist(_0x4c1d9e),devices[_0x4c1d9e][_0x4aac4f(0x20a)]=null,devices[_0x4c1d9e][_0x4aac4f(0x227)]=null,devices[_0x4c1d9e][_0x4aac4f(0x141)][_0x4aac4f(0x161)]=null,logger[_0x4aac4f(0x1fa)](_0x4aac4f(0xd6)+_0x4c1d9e['slice'](-0x8)),io['to'](getClient(_0x2d3e29['id'])[_0x4aac4f(0xe1)])[_0x4aac4f(0x15c)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x4aac4f(0x22e)](_0x4aac4f(0xff));});}function initializeSocketBot(_0x3420ea){const _0x37abc1=_0x5f2c03,_0x32f20c=getClient(_0x3420ea['id'])['bot'],_0x1753cf=getClient(_0x3420ea['id'])[_0x37abc1(0xe1)];_0x3420ea['on'](_0x37abc1(0xea),(_0x591383,_0x16102f)=>{const _0x154bb6=_0x37abc1;if(validateAccess(_0x16102f,_0x1753cf)[_0x154bb6(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x154bb6(0x20b)]({'function':'emitHistory','args':_0x591383});}else logger['full'](_0x154bb6(0x23d));}),_0x3420ea['on'](_0x37abc1(0x14a),(_0x3ca941,_0x17ec6a)=>{const _0x28bf20=_0x37abc1;if(validateAccess(_0x17ec6a,_0x1753cf)[_0x28bf20(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x28bf20(0x20b)]({'function':_0x28bf20(0x23f),'args':_0x3ca941});}else logger['full'](_0x28bf20(0x265));}),_0x3420ea['on'](_0x37abc1(0x1f9),(_0x289aef,_0x3c13b5)=>{const _0x9a6070=_0x37abc1;if(validateAccess(_0x3c13b5,_0x1753cf)[_0x9a6070(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x9a6070(0x20b)]({'function':_0x9a6070(0x12f),'args':_0x289aef});}else logger[_0x9a6070(0x22e)](_0x9a6070(0x12b));}),_0x3420ea['on']('store-configuration',(_0x561076,_0x223239)=>{const _0x5b3c3b=_0x37abc1;if(validateAccess(_0x223239,_0x1753cf)[_0x5b3c3b(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x5b3c3b(0x20b)]({'function':_0x5b3c3b(0x282),'args':_0x561076});}else logger[_0x5b3c3b(0x22e)](_0x5b3c3b(0x23c));}),_0x3420ea['on'](_0x37abc1(0x1bf),(_0x112652,_0x24b3bf)=>{const _0x2ce646=_0x37abc1;if(validateAccess(_0x24b3bf,_0x1753cf)[_0x2ce646(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c]['send']({'function':_0x2ce646(0x263),'args':_0x112652});}else logger[_0x2ce646(0x22e)](_0x2ce646(0x135));}),_0x3420ea['on'](_0x37abc1(0x1b9),(_0x42bd35,_0x25a2c5)=>{const _0x1006ea=_0x37abc1;if(validateAccess(_0x25a2c5,_0x1753cf)[_0x1006ea(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x1006ea(0x20b)]({'function':_0x1006ea(0x177),'args':_0x42bd35});}else logger[_0x1006ea(0x22e)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x3420ea['on'](_0x37abc1(0x212),_0x51db4a=>{const _0x11ac96=_0x37abc1;if(validateAccess(_0x51db4a,_0x1753cf)[_0x11ac96(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c]['send']({'function':_0x11ac96(0xf3),'args':null});}else logger['full'](_0x11ac96(0x25b));}),_0x3420ea['on']('get-starting-balances',_0x5c5b4e=>{const _0x30996e=_0x37abc1;if(validateAccess(_0x5c5b4e,_0x1753cf)[_0x30996e(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x30996e(0x20b)]({'function':_0x30996e(0x272),'args':null});}else logger[_0x30996e(0x22e)](_0x30996e(0x123));}),_0x3420ea['on'](_0x37abc1(0x11b),(_0x40637b,_0x15fcfb)=>{const _0x25fb3b=_0x37abc1;if(validateAccess(_0x15fcfb,_0x1753cf)['allow']){if(pid[_0x32f20c])pid[_0x32f20c]['send']({'function':'placeOrder','args':_0x40637b});}else logger[_0x25fb3b(0x22e)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x3420ea['on'](_0x37abc1(0x237),_0x5151c8=>{const _0x1dfb5c=_0x37abc1;if(validateAccess(_0x5151c8,_0x1753cf)[_0x1dfb5c(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c][_0x1dfb5c(0x20b)]({'function':'cancelLoading','args':null});}else logger[_0x1dfb5c(0x22e)](_0x1dfb5c(0x12d));}),_0x3420ea['on']('show-config',_0x168f7d=>{const _0x1d0e55=_0x37abc1;if(validateAccess(_0x168f7d,_0x1753cf)[_0x1d0e55(0x139)]){if(pid[_0x32f20c])pid[_0x32f20c]['send']({'function':_0x1d0e55(0x19c),'args':null});}else logger[_0x1d0e55(0x22e)](_0x1d0e55(0x18e));}),_0x3420ea['on'](_0x37abc1(0x130),_0xd3c45f=>{const _0x3288d2=_0x37abc1;if(validateAccess(_0xd3c45f,_0x1753cf)[_0x3288d2(0x139)])updateBB(_0x3288d2(0xc9));else logger[_0x3288d2(0x22e)](_0x3288d2(0x21b));}),_0x3420ea['on'](_0x37abc1(0x108),_0x5366ca=>{const _0x338cbc=_0x37abc1;if(validateAccess(_0x5366ca,_0x1753cf)[_0x338cbc(0x139)])getMessages();else logger[_0x338cbc(0x22e)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3420ea['on'](_0x37abc1(0x147),(_0x1e9f64,_0xa599eb)=>{const _0x1ea17c=_0x37abc1;if(validateAccess(_0xa599eb,_0x1753cf)[_0x1ea17c(0x139)])confirmMessage(_0x1e9f64);else logger['full'](_0x1ea17c(0x23a));}),_0x3420ea['on'](_0x37abc1(0x17b),_0x28a0d1=>{const _0x8ebd52=_0x37abc1;if(validateAccess(_0x28a0d1,_0x1753cf)[_0x8ebd52(0x139)]){if(devices[_0x1753cf][_0x8ebd52(0x274)])clearTimeout(devices[_0x1753cf][_0x8ebd52(0x274)]);if(devices[_0x1753cf]['pidExpireLogin'])clearTimeout(devices[_0x1753cf][_0x8ebd52(0x181)]);removeSocketListeners(getClient(_0x3420ea['id'])[_0x8ebd52(0xe1)]),addBlacklist(_0x1753cf),devices[_0x1753cf]['telegramIpApproval']=null,devices[_0x1753cf][_0x8ebd52(0x227)]=null,devices[_0x1753cf][_0x8ebd52(0x141)]['token']=null,logger[_0x8ebd52(0x1fa)](_0x8ebd52(0xd6)+_0x1753cf[_0x8ebd52(0x23b)](-0x8)),io['to'](getClient(_0x3420ea['id'])['uuid'])[_0x8ebd52(0x15c)](_0x8ebd52(0x1c7),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x8ebd52(0x22e)](_0x8ebd52(0xff));});}function removeSocketListeners(_0xedca02){const _0x1a2630=_0x5f2c03;getClientsWithUuid(_0xedca02)[_0x1a2630(0x194)](_0x2e1fa0=>{getSocket(_0x2e1fa0['id'])['removeAllListeners']();});}function cleanSettings(){const _0x3f10a0=_0x5f2c03;let _0x1b0c21=settings;return settings[_0x3f10a0(0x196)]&&settings['telegramToken']!=''&&(_0x1b0c21={..._0x1b0c21,'telegramToken':_0x3f10a0(0xad)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x1b0c21={..._0x1b0c21,'bbPassword':_0x3f10a0(0xad)}),(settings[_0x3f10a0(0x18f)]&&settings[_0x3f10a0(0x18f)]==_0x3f10a0(0x1c9)||settings[_0x3f10a0(0x196)]&&settings[_0x3f10a0(0x196)]==_0x3f10a0(0x1c9))&&(_0x1b0c21={..._0x1b0c21,'restored':{'password':settings['bbPassword']==_0x3f10a0(0x1c9),'telegram':settings['telegramToken']==_0x3f10a0(0x1c9)}}),_0x1b0c21;}async function updateBB(_0x1ee8ca){const _0x5a7bd1=_0x5f2c03;await backupConfigFiles(),installingUpdate=!![],config[_0x5a7bd1(0x194)](_0x288024=>{restartBot(_0x288024['botID']);});if(_0x1ee8ca=='update')process['send']({'update':!![],'environment':environment},_0x5a7508=>{});else _0x1ee8ca==_0x5a7bd1(0xcc)&&process[_0x5a7bd1(0x20b)]({'reinstall':!![],'environment':environment},_0x132c9b=>{});}function startBot(_0x42f0f1,_0x1c2985,_0x5aca20){const _0x3b43e0=_0x5f2c03;if(debugging)_0x42f0f1[_0x3b43e0(0x105)]('-d');let _0x5d28c6=![];const _0x4ec70b=_0x42f0f1[0x0];_0x1c2985={..._0x1c2985,'stdio':[_0x3b43e0(0x22c),_0x3b43e0(0x22c),_0x3b43e0(0x22c),_0x3b43e0(0x200)]},pid[_0x4ec70b]=childProcess['fork'](botfile,_0x42f0f1,_0x1c2985),pid[_0x4ec70b]['on']('message',_0x556476=>{const _0x395d7c=_0x3b43e0;switch(Object['keys'](_0x556476)[0x0]){case'botname':updateBotName(_0x4ec70b,_0x556476[_0x395d7c(0x113)]);break;case _0x395d7c(0x235):updateBotManager();break;case _0x395d7c(0x1c7):updateStatus(_0x4ec70b,_0x556476[_0x395d7c(0x1c7)]);break;case _0x395d7c(0x13a):updateLive(_0x4ec70b,_0x556476[_0x395d7c(0x13a)]);break;case _0x395d7c(0xc1):updateLive(_0x4ec70b,_0x556476[_0x395d7c(0xc1)]),io['to'](_0x4ec70b)['emit'](_0x395d7c(0x1c7),{'access':{'allow':![],'reason':_0x395d7c(0x27a),'token':null}});break;case'stop':_0x556476[_0x395d7c(0x14b)]=='restart'&&restartBot(_0x4ec70b);_0x556476[_0x395d7c(0x14b)]==_0x395d7c(0xbc)&&toggleBot(_0x4ec70b,'disabled',_0x395d7c(0x22b));break;case'telegram':sendTelegram(_0x4ec70b,_0x556476[_0x395d7c(0xf0)]);break;case _0x395d7c(0x273):sendTelegramMsg(_0x556476[_0x395d7c(0x273)]);break;case _0x395d7c(0x1b5):io['to'](_0x4ec70b)[_0x395d7c(0x15c)](_0x556476[_0x395d7c(0x1b5)],_0x556476[_0x395d7c(0x1c4)]);break;}}),pid[_0x4ec70b]['on'](_0x3b43e0(0x10b),function(_0x115971){if(_0x5d28c6)return;_0x5d28c6=!![],_0x5aca20(_0x115971);}),pid[_0x4ec70b]['on'](_0x3b43e0(0x20f),async function(_0x26ae27){const _0x560052=_0x3b43e0;if(installingUpdate)return;if(_0x5d28c6)return;_0x5d28c6=!![],_0x5aca20(null);const _0x173cf8=dbConfig[_0x560052(0x243)](_0x560052(0x240))[_0x560052(0xb6)]({'botID':_0x4ec70b})[_0x560052(0x28a)]();_0x173cf8&&(_0x173cf8['status']==_0x560052(0x138)||_0x173cf8[_0x560052(0x1c7)]==_0x560052(0x1f6))&&(await sleep(0x3e8),updateLive(_0x4ec70b,_0x560052(0x22b)),logger[_0x560052(0x22e)](_0x560052(0x163)+_0x4ec70b),startBot([_0x4ec70b,userID],{'cwd':bbpath},function(_0x40961d){const _0x36ae90=_0x560052;if(_0x40961d)logger[_0x36ae90(0x22e)](_0x40961d);}));});}function stopBot(_0x49f08b){const _0x2d92d6=_0x5f2c03;getClientsWithBotID(_0x49f08b)[_0x2d92d6(0x194)](_0x59b438=>{const _0x359c72=_0x2d92d6;getSocket(_0x59b438['id'])[_0x359c72(0xe9)](!![]),removeClient(_0x59b438['id']);}),pid[_0x49f08b]&&(pid[_0x49f08b][_0x2d92d6(0xbc)](),pid[_0x49f08b]=null);}function restartBot(_0x1b40c6){const _0x5b28a5=_0x5f2c03;if(pid[_0x1b40c6])pid[_0x1b40c6][_0x5b28a5(0xbc)]();}function addBot(){const _0x64ea2e=_0x5f2c03;let _0x5c40f0;for(let _0x3e99e7=0x1;_0x3e99e7<0x3e9;_0x3e99e7++){_0x5c40f0=_0x3e99e7['toString']()[_0x64ea2e(0x26c)](0x3,'0');let _0x5dc5bb=config[_0x64ea2e(0xb6)](_0x4593fb=>_0x4593fb['botID']==_0x5c40f0);if(!_0x5dc5bb)break;}if(_0x5c40f0===_0x64ea2e(0xda)){logger[_0x64ea2e(0x22e)](_0x64ea2e(0x129));return;}logger[_0x64ea2e(0x22e)](_0x64ea2e(0x150)+_0x5c40f0),dbConfig[_0x64ea2e(0x243)](_0x64ea2e(0x240))[_0x64ea2e(0x105)]({'botID':_0x5c40f0,'botname':_0x64ea2e(0xd0)+_0x5c40f0,'status':'new','live':''})[_0x64ea2e(0x214)](),startBot([_0x5c40f0,userID],{'cwd':bbpath},function(_0x444a04){const _0x2f94f1=_0x64ea2e;if(_0x444a04)logger[_0x2f94f1(0x22e)](_0x444a04);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x64ea2e(0x240),config),broadcastToBots('bots',JSON[_0x64ea2e(0x275)](config));}function deleteBot(_0x38af0d){const _0x9c6ccd=_0x5f2c03;getClientsWithBotID(_0x38af0d)[_0x9c6ccd(0x194)](_0x279cc3=>{const _0x179263=_0x9c6ccd;getSocket(_0x279cc3['id'])[_0x179263(0xe9)](!![]),removeClient(_0x279cc3['id']);}),dbConfig[_0x9c6ccd(0x243)](_0x9c6ccd(0x240))[_0x9c6ccd(0x13c)]({'botID':_0x38af0d})['write'](),logger[_0x9c6ccd(0x22e)](_0x9c6ccd(0xef)+_0x38af0d),stopBot(_0x38af0d);try{if(fs[_0x9c6ccd(0xb4)](path[_0x9c6ccd(0xfe)](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x103))))fs[_0x9c6ccd(0xed)](path[_0x9c6ccd(0xfe)](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x103)));if(fs[_0x9c6ccd(0xb4)](path['join'](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x1c1))))fs[_0x9c6ccd(0xed)](path[_0x9c6ccd(0xfe)](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x1c1)));if(fs[_0x9c6ccd(0xb4)](path[_0x9c6ccd(0xfe)](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x11d))))fs[_0x9c6ccd(0xed)](path['join'](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x11d)));if(fs['existsSync'](path[_0x9c6ccd(0xfe)](configpath,_0x9c6ccd(0x1eb)+_0x38af0d+_0x9c6ccd(0x1a4))))fs[_0x9c6ccd(0xed)](path['join'](configpath,'bot-'+_0x38af0d+'-results.json'));}catch(_0x156ba6){if(_0x156ba6)logger['full'](_0x9c6ccd(0x22f),_0x156ba6);}config=getConfiguration(),io['to'](_0x9c6ccd(0x1e5))[_0x9c6ccd(0x15c)]('bots',config),broadcastToBots(_0x9c6ccd(0x240),JSON[_0x9c6ccd(0x275)](config));}function toggleBot(_0x561533,_0x539a47,_0x11e958){const _0x2468a9=_0x5f2c03;dbConfig['get'](_0x2468a9(0x240))[_0x2468a9(0xb6)]({'botID':_0x561533})['assign']({'status':_0x539a47})[_0x2468a9(0x106)]({'live':_0x11e958})['write']();if(_0x539a47==_0x2468a9(0x138)||_0x539a47==_0x2468a9(0x1f6))logger[_0x2468a9(0x22e)](_0x2468a9(0x1a3)+_0x561533),startBot([_0x561533,userID],{'cwd':bbpath},function(_0x41fcf1){const _0x4f876d=_0x2468a9;if(_0x41fcf1)logger[_0x4f876d(0x22e)](_0x41fcf1);});else(_0x539a47==_0x2468a9(0xd5)||_0x539a47==_0x2468a9(0x248))&&(logger['full'](_0x2468a9(0x1fc)+_0x561533),stopBot(_0x561533));config=getConfiguration(),io['to'](_0x2468a9(0x1e5))[_0x2468a9(0x15c)](_0x2468a9(0x240),config),broadcastToBots(_0x2468a9(0x240),JSON['stringify'](config));}function toggleStatus(_0x33a926){const _0x1aea7c=_0x5f2c03;let _0x2f29b3=dbConfig[_0x1aea7c(0x243)](_0x1aea7c(0x240))[_0x1aea7c(0xb6)]({'botID':_0x33a926})[_0x1aea7c(0x28a)](),_0x1bdfcf;if(_0x2f29b3[_0x1aea7c(0x1c7)]===_0x1aea7c(0x138))_0x1bdfcf=_0x1aea7c(0xd5);else{if(_0x2f29b3[_0x1aea7c(0x1c7)]===_0x1aea7c(0x1f6))_0x1bdfcf=_0x1aea7c(0x248);else{if(_0x2f29b3[_0x1aea7c(0x1c7)]===_0x1aea7c(0x248))_0x1bdfcf='new';else{if(_0x2f29b3[_0x1aea7c(0x1c7)]===_0x1aea7c(0xd5))_0x1bdfcf=_0x1aea7c(0x138);}}}return _0x1bdfcf;}function updateStatus(_0x585f37,_0x5813b0){const _0x557ea1=_0x5f2c03;dbConfig[_0x557ea1(0x243)](_0x557ea1(0x240))[_0x557ea1(0xb6)]({'botID':_0x585f37})[_0x557ea1(0x106)]({'status':_0x5813b0})[_0x557ea1(0x214)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x557ea1(0x240),config),broadcastToBots(_0x557ea1(0x240),JSON['stringify'](config));}function updateLive(_0x3f0a5f,_0x2f96eb){const _0x41a278=_0x5f2c03;dbConfig[_0x41a278(0x243)]('bots')['find']({'botID':_0x3f0a5f})['assign']({'live':_0x2f96eb})[_0x41a278(0x214)](),config=getConfiguration(),io['to'](_0x41a278(0x1e5))['emit']('bots',config),broadcastToBots('bots',JSON[_0x41a278(0x275)](config));}function updateBotName(_0x5a6f05,_0x38ee4f){const _0x3d51ea=_0x5f2c03;dbConfig[_0x3d51ea(0x243)](_0x3d51ea(0x240))[_0x3d51ea(0xb6)]({'botID':_0x5a6f05})['assign']({'botname':_0x38ee4f})['write'](),config=getConfiguration(),io['to'](_0x3d51ea(0x1e5))['emit'](_0x3d51ea(0x240),config),broadcastToBots(_0x3d51ea(0x240),JSON[_0x3d51ea(0x275)](config));}function updateBotManager(){const _0x2590d=_0x5f2c03;config=getConfiguration(),io['to'](_0x2590d(0x1e5))[_0x2590d(0x15c)](_0x2590d(0x240),config),broadcastToBots(_0x2590d(0x240),JSON[_0x2590d(0x275)](config));}function toggleBotMode(_0x11c088){const _0x27875a=_0x5f2c03;if(pid[_0x11c088])pid[_0x11c088][_0x27875a(0x20b)]({'function':_0x27875a(0x229),'args':null});else{const _0x13607d=configpath+_0x27875a(0x1eb)+_0x11c088+_0x27875a(0x103),_0x1b6f04=fs[_0x27875a(0x11a)](_0x13607d),_0x5e57f8=JSON['parse'](_0x1b6f04),_0xd6252a=_0x5e57f8[_0x27875a(0x245)][0x0][_0x27875a(0x16e)];_0x5e57f8[_0x27875a(0x245)][0x0]['headless']=!_0xd6252a;const _0x2941fe=JSON['stringify'](_0x5e57f8,null,0x2);fs[_0x27875a(0x1e3)](_0x13607d,_0x2941fe),config=getConfiguration(),io['to'](_0x27875a(0x1e5))[_0x27875a(0x15c)](_0x27875a(0x240),config),broadcastToBots(_0x27875a(0x240),JSON[_0x27875a(0x275)](config));}}function telegramError(_0x473141){const _0x4a4859=_0x5f2c03;logger[_0x4a4859(0x191)](getTimeStamp()+_0x4a4859(0x13e));}function validateTelegram(_0x2ece30){const _0x4a34bf=_0x5f2c03;if(_0x2ece30[_0x4a34bf(0x102)]['username']!=settings[_0x4a34bf(0x24a)]&&'@'+_0x2ece30[_0x4a34bf(0x102)]['username']!=settings['telegramUsername'])return tgBot[_0x4a34bf(0xba)](_0x2ece30[_0x4a34bf(0x198)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x4a34bf(0x1c2)})['catch'](_0xd564c3=>{telegramError(_0xd564c3);}),![];return!![];}async function initTelegram(){const _0x38ed86=_0x5f2c03;if(tgBot)tgBot[_0x38ed86(0x280)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x38ed86(0x196)],{'polling':!![]});let _0x4d5436=_0x38ed86(0xfd);_0x4d5436+='\x0a',_0x4d5436+=_0x38ed86(0x1de),_0x4d5436+=_0x38ed86(0x1ef),_0x4d5436+=_0x38ed86(0x1b4),_0x4d5436+=_0x38ed86(0x285),_0x4d5436+='/on\x20-\x20start\x20bot(s)\x0a',_0x4d5436+='/off\x20-\x20stop\x20bot(s)\x0a',_0x4d5436+=_0x38ed86(0x170),_0x4d5436+=_0x38ed86(0x155),_0x4d5436+=_0x38ed86(0xc7),_0x4d5436+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x4d5436+=_0x38ed86(0x1ed),_0x4d5436+=_0x38ed86(0x10d),_0x4d5436+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x4d5436+=_0x38ed86(0x18c);let _0x45a19d=_0x38ed86(0x189);_0x45a19d+='\x0a',_0x45a19d+=_0x4d5436,tgBot['onText'](/\/start/,_0xb6aac4=>{const _0x18aa23=_0x38ed86;if(!validateTelegram(_0xb6aac4))return;if(settings[_0x18aa23(0x144)]!=_0xb6aac4[_0x18aa23(0x198)]['id'])updateSetting(_0x18aa23(0x144),_0xb6aac4[_0x18aa23(0x198)]['id']);updateSetting(_0x18aa23(0x26a),!![]),tgBot[_0x18aa23(0xba)](_0xb6aac4[_0x18aa23(0x198)]['id'],_0x45a19d)['catch'](_0x4193a0=>{telegramError(_0x4193a0);});}),tgBot[_0x38ed86(0x10e)](/\/enable/,_0x1d80a2=>{const _0x5d7799=_0x38ed86;if(!validateTelegram(_0x1d80a2))return;if(settings[_0x5d7799(0x144)]!=_0x1d80a2['chat']['id'])updateSetting(_0x5d7799(0x144),_0x1d80a2[_0x5d7799(0x198)]['id']);updateSetting(_0x5d7799(0x26a),!![]),tgBot[_0x5d7799(0xba)](_0x1d80a2[_0x5d7799(0x198)]['id'],_0x5d7799(0x17f))[_0x5d7799(0x20e)](_0x4f46eb=>{telegramError(_0x4f46eb);});}),tgBot[_0x38ed86(0x10e)](/\/config/,async _0x317b12=>{const _0x322eac=_0x38ed86;if(!validateTelegram(_0x317b12))return;tgBot['removeListener'](_0x322eac(0x288)),tgBot['sendMessage'](_0x317b12[_0x322eac(0x198)]['id'],_0x322eac(0x250),{'reply_markup':{'inline_keyboard':[[{'text':_0x322eac(0x19d),'callback_data':_0x322eac(0x110)},{'text':_0x322eac(0x1ca),'callback_data':_0x322eac(0x15e)},{'text':_0x322eac(0x16b),'callback_data':_0x322eac(0x107)}]]}})[_0x322eac(0x20e)](_0x3b3e25=>{telegramError(_0x3b3e25);}),tgBot['on']('callback_query',async _0x37dc27=>{const _0x3fefde=_0x322eac,_0x440979=_0x37dc27[_0x3fefde(0x15f)],_0x3a0222=_0x37dc27[_0x3fefde(0x206)];tgBot['answerCallbackQuery'](_0x37dc27['id'])[_0x3fefde(0x25c)](async()=>{const _0x48e779=_0x3fefde;_0x440979=='orders'&&(updateSetting(_0x48e779(0x26e),_0x48e779(0x110)),updateSetting(_0x48e779(0x26a),!![]),await tgBot['sendMessage'](_0x3a0222[_0x48e779(0x198)]['id'],_0x48e779(0x25e))['catch'](_0x3cc3b5=>{telegramError(_0x3cc3b5);}));_0x440979=='alerts'&&(updateSetting(_0x48e779(0x26e),_0x48e779(0x15e)),updateSetting('telegramEnabled',!![]),await tgBot[_0x48e779(0xba)](_0x3a0222[_0x48e779(0x198)]['id'],_0x48e779(0x1ac))[_0x48e779(0x20e)](_0x4ca08b=>{telegramError(_0x4ca08b);}));_0x440979=='all'&&(updateSetting('telegramEvents',_0x48e779(0x107)),updateSetting(_0x48e779(0x26a),!![]),await tgBot[_0x48e779(0xba)](_0x3a0222[_0x48e779(0x198)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x48e779(0x20e)](_0x100a66=>{telegramError(_0x100a66);}));if(!settings[_0x48e779(0x144)])tgBot[_0x48e779(0xba)](_0x3a0222['chat']['id'],_0x48e779(0x143))['catch'](_0x196a4d=>{telegramError(_0x196a4d);});}),tgBot['removeListener'](_0x3fefde(0x288));});}),tgBot[_0x38ed86(0x10e)](/\/status/,_0x11a13e=>{const _0x2602d8=_0x38ed86;if(!validateTelegram(_0x11a13e))return;const _0xcc7a4=getBotsWithMode();let _0x23d7fa='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x2602d8(0x194)](_0x116de2=>{const _0x5b403f=_0x2602d8,_0x1b2d5b=_0xcc7a4[_0x5b403f(0xb6)](_0x134aee=>_0x134aee['botID']==_0x116de2['botID'])[_0x5b403f(0x116)];_0x23d7fa+='Bot\x20'+_0x116de2[_0x5b403f(0x1ba)]+':\x20'+_0x116de2['status']+_0x5b403f(0x178)+_0x1b2d5b+_0x5b403f(0x178)+_0x116de2['live']+'\x0a';}),_0x23d7fa+='\x0a',_0x23d7fa+=_0x2602d8(0xd8),_0x23d7fa+=!settings['telegramEnabled']?_0x2602d8(0x101):_0x2602d8(0x267),_0x23d7fa+=settings[_0x2602d8(0x26a)]?settings[_0x2602d8(0x26e)]=='all'?_0x2602d8(0x197):_0x2602d8(0x283)+settings[_0x2602d8(0x26e)]+_0x2602d8(0x149):'',tgBot[_0x2602d8(0xba)](_0x11a13e[_0x2602d8(0x198)]['id'],_0x23d7fa,{'parse_mode':_0x2602d8(0x1c2)})[_0x2602d8(0x20e)](_0x3ac5fa=>{telegramError(_0x3ac5fa);});}),tgBot[_0x38ed86(0x10e)](/\/restart/,_0x5281eb=>{const _0x53a0f7=_0x38ed86;if(!validateTelegram(_0x5281eb))return;tgBot[_0x53a0f7(0x239)](_0x53a0f7(0x288));const _0x42d98d=getEnabledBots();if(_0x42d98d[_0x53a0f7(0xbf)]==0x0)tgBot['sendMessage'](_0x5281eb['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x53a0f7(0x20e)](_0x503a1f=>{telegramError(_0x503a1f);});else{if(_0x42d98d[_0x53a0f7(0xbf)]>0x1)_0x42d98d[_0x53a0f7(0x105)]({'botID':'all'});let _0x3f328f=[],_0x4c23c7=[];const _0x31c485=_0x42d98d[_0x53a0f7(0xbf)]%0x4==0x0||_0x42d98d['length']%0x4==0x3||_0x42d98d[_0x53a0f7(0xbf)]%0x3==0x1?0x4:0x3;let _0x36ffab=0x0;_0x42d98d['forEach']((_0x5e899c,_0x165bf1)=>{const _0x2e7acc=_0x53a0f7;if(_0x165bf1%_0x31c485==0x0)_0x4c23c7=[];_0x4c23c7[_0x2e7acc(0x105)]({'text':_0x5e899c['botID']==_0x2e7acc(0x107)?_0x2e7acc(0x142):_0x2e7acc(0xd0)+_0x5e899c[_0x2e7acc(0x1ba)],'callback_data':_0x5e899c[_0x2e7acc(0x1ba)]}),_0x165bf1%_0x31c485==0x0&&(_0x3f328f[_0x36ffab]=_0x4c23c7,_0x36ffab++);}),tgBot[_0x53a0f7(0xba)](_0x5281eb['chat']['id'],_0x53a0f7(0x287),{'reply_markup':{'inline_keyboard':_0x3f328f}})[_0x53a0f7(0x20e)](_0x28775f=>{telegramError(_0x28775f);}),tgBot['on'](_0x53a0f7(0x288),async _0x5c5e6d=>{const _0x32269c=_0x53a0f7,_0x31ff8c=_0x5c5e6d[_0x32269c(0x15f)],_0x1483e7=_0x5c5e6d[_0x32269c(0x206)];tgBot[_0x32269c(0x119)](_0x5c5e6d['id'])[_0x32269c(0x25c)](async()=>{const _0x100a28=_0x32269c;_0x31ff8c==_0x100a28(0x107)?config['forEach'](_0x27e965=>{const _0x376ddb=_0x100a28;restartBot(_0x27e965[_0x376ddb(0x1ba)]);}):restartBot(_0x31ff8c);}),tgBot[_0x32269c(0x239)](_0x32269c(0x288));});}}),tgBot[_0x38ed86(0x10e)](/\/on/,_0x1e83ca=>{const _0x4b5f54=_0x38ed86;if(!validateTelegram(_0x1e83ca))return;tgBot[_0x4b5f54(0x239)]('callback_query');const _0x34f763=getDisabledBots();if(_0x34f763[_0x4b5f54(0xbf)]==0x0)tgBot[_0x4b5f54(0xba)](_0x1e83ca[_0x4b5f54(0x198)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x4b5f54(0x20e)](_0x3a810c=>{telegramError(_0x3a810c);});else{if(_0x34f763[_0x4b5f54(0xbf)]>0x1)_0x34f763[_0x4b5f54(0x105)]({'botID':_0x4b5f54(0x107)});let _0x4929e6=[],_0xa2cb8e=[];const _0x196519=_0x34f763['length']%0x4==0x0||_0x34f763[_0x4b5f54(0xbf)]%0x4==0x3||_0x34f763['length']%0x3==0x1?0x4:0x3;let _0x5b47d6=0x0;_0x34f763[_0x4b5f54(0x194)]((_0xb57f3d,_0x2c3bba)=>{const _0x31217f=_0x4b5f54;if(_0x2c3bba%_0x196519==0x0)_0xa2cb8e=[];_0xa2cb8e[_0x31217f(0x105)]({'text':_0xb57f3d[_0x31217f(0x1ba)]=='all'?_0x31217f(0x142):_0x31217f(0xd0)+_0xb57f3d[_0x31217f(0x1ba)],'callback_data':_0xb57f3d[_0x31217f(0x1ba)]}),_0x2c3bba%_0x196519==0x0&&(_0x4929e6[_0x5b47d6]=_0xa2cb8e,_0x5b47d6++);}),tgBot['sendMessage'](_0x1e83ca[_0x4b5f54(0x198)]['id'],_0x4b5f54(0x176),{'reply_markup':{'inline_keyboard':_0x4929e6}})[_0x4b5f54(0x20e)](_0x56bb84=>{telegramError(_0x56bb84);}),tgBot['on']('callback_query',async _0x27107b=>{const _0x1f2fd0=_0x4b5f54,_0x382492=_0x27107b[_0x1f2fd0(0x15f)],_0x1481d8=_0x27107b[_0x1f2fd0(0x206)];tgBot[_0x1f2fd0(0x119)](_0x27107b['id'])[_0x1f2fd0(0x25c)](async()=>{const _0x1b42a9=_0x1f2fd0;_0x382492==_0x1b42a9(0x107)?(tgBot[_0x1b42a9(0xba)](_0x1481d8[_0x1b42a9(0x198)]['id'],_0x1b42a9(0x1cc))[_0x1b42a9(0x20e)](_0xdf5b6e=>{telegramError(_0xdf5b6e);}),_0x34f763[_0x1b42a9(0x194)](_0x596365=>{const _0x4b610f=_0x1b42a9;if(_0x596365[_0x4b610f(0x1ba)]!=_0x4b610f(0x107))toggleBot(_0x596365[_0x4b610f(0x1ba)],toggleStatus(_0x596365['botID']),'stopped');})):(tgBot[_0x1b42a9(0xba)](_0x1481d8[_0x1b42a9(0x198)]['id'],_0x1b42a9(0x11c)+_0x382492)['catch'](_0x32927b=>{telegramError(_0x32927b);}),toggleBot(_0x382492,toggleStatus(_0x382492),'stopped'));}),tgBot[_0x1f2fd0(0x239)](_0x1f2fd0(0x288));});}}),tgBot[_0x38ed86(0x10e)](/\/off/,_0x5aa6e5=>{const _0xfed0bb=_0x38ed86;if(!validateTelegram(_0x5aa6e5))return;tgBot[_0xfed0bb(0x239)](_0xfed0bb(0x288));const _0x14789a=getEnabledBots();if(_0x14789a[_0xfed0bb(0xbf)]==0x0)tgBot[_0xfed0bb(0xba)](_0x5aa6e5[_0xfed0bb(0x198)]['id'],_0xfed0bb(0x179))[_0xfed0bb(0x20e)](_0x8ad1e3=>{telegramError(_0x8ad1e3);});else{if(_0x14789a[_0xfed0bb(0xbf)]>0x1)_0x14789a[_0xfed0bb(0x105)]({'botID':'all'});let _0x1e45d6=[],_0x34b5d9=[];const _0xaad8a5=_0x14789a[_0xfed0bb(0xbf)]%0x4==0x0||_0x14789a['length']%0x4==0x3||_0x14789a['length']%0x3==0x1?0x4:0x3;let _0x200d8f=0x0;_0x14789a[_0xfed0bb(0x194)]((_0x5962e8,_0x463422)=>{const _0x1de918=_0xfed0bb;if(_0x463422%_0xaad8a5==0x0)_0x34b5d9=[];_0x34b5d9[_0x1de918(0x105)]({'text':_0x5962e8[_0x1de918(0x1ba)]=='all'?'All\x20bots':'Bot\x20'+_0x5962e8['botID'],'callback_data':_0x5962e8['botID']}),_0x463422%_0xaad8a5==0x0&&(_0x1e45d6[_0x200d8f]=_0x34b5d9,_0x200d8f++);}),tgBot['sendMessage'](_0x5aa6e5[_0xfed0bb(0x198)]['id'],_0xfed0bb(0x169),{'reply_markup':{'inline_keyboard':_0x1e45d6}})[_0xfed0bb(0x20e)](_0x298d2c=>{telegramError(_0x298d2c);}),tgBot['on'](_0xfed0bb(0x288),async _0x34c5ea=>{const _0x33357e=_0xfed0bb,_0x31451e=_0x34c5ea[_0x33357e(0x15f)],_0x1bba3f=_0x34c5ea['message'];tgBot[_0x33357e(0x119)](_0x34c5ea['id'])[_0x33357e(0x25c)](async()=>{const _0x3d480a=_0x33357e;_0x31451e==_0x3d480a(0x107)?(tgBot['sendMessage'](_0x1bba3f[_0x3d480a(0x198)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x3d480a(0x20e)](_0x45c450=>{telegramError(_0x45c450);}),_0x14789a[_0x3d480a(0x194)](_0x562b58=>{const _0x170e81=_0x3d480a;if(_0x562b58[_0x170e81(0x1ba)]!=_0x170e81(0x107))toggleBot(_0x562b58['botID'],toggleStatus(_0x562b58[_0x170e81(0x1ba)]),'stopped');})):(tgBot[_0x3d480a(0xba)](_0x1bba3f[_0x3d480a(0x198)]['id'],_0x3d480a(0x22a)+_0x31451e)['catch'](_0x3ff839=>{telegramError(_0x3ff839);}),toggleBot(_0x31451e,toggleStatus(_0x31451e),_0x3d480a(0x22b)));}),tgBot['removeListener'](_0x33357e(0x288));});}}),tgBot[_0x38ed86(0x10e)](/\/metrics/,_0x38df40=>{const _0x5ca976=_0x38ed86;if(!validateTelegram(_0x38df40))return;tgBot[_0x5ca976(0x239)](_0x5ca976(0x288));const _0x27f0fe=getEnabledBots();if(_0x27f0fe['length']==0x0)tgBot[_0x5ca976(0xba)](_0x38df40[_0x5ca976(0x198)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x5ca976(0x20e)](_0x27c7af=>{telegramError(_0x27c7af);});else{if(_0x27f0fe['length']>0x1){let _0x273b87=[],_0x140c62=[];const _0x42bf25=_0x27f0fe[_0x5ca976(0xbf)]%0x4==0x0||_0x27f0fe[_0x5ca976(0xbf)]%0x4==0x3||_0x27f0fe[_0x5ca976(0xbf)]%0x3==0x1?0x4:0x3;let _0x2e20db=0x0;_0x27f0fe[_0x5ca976(0x194)]((_0x317b24,_0x32fcb4)=>{const _0x1637d4=_0x5ca976;if(_0x32fcb4%_0x42bf25==0x0)_0x140c62=[];_0x140c62[_0x1637d4(0x105)]({'text':_0x1637d4(0xd0)+_0x317b24[_0x1637d4(0x1ba)],'callback_data':_0x317b24['botID']}),_0x32fcb4%_0x42bf25==0x0&&(_0x273b87[_0x2e20db]=_0x140c62,_0x2e20db++);}),tgBot['sendMessage'](_0x38df40[_0x5ca976(0x198)]['id'],_0x5ca976(0x157),{'reply_markup':{'inline_keyboard':_0x273b87}})['catch'](_0x2d5e8d=>{telegramError(_0x2d5e8d);}),tgBot['on'](_0x5ca976(0x288),async _0x42ce08=>{const _0x5e84ba=_0x5ca976,_0x26e4dd=_0x42ce08[_0x5e84ba(0x15f)],_0x4ff16f=_0x42ce08[_0x5e84ba(0x206)];tgBot['answerCallbackQuery'](_0x42ce08['id'])[_0x5e84ba(0x25c)](async()=>{const _0x38f87a=_0x5e84ba;if(pid[_0x26e4dd])pid[_0x26e4dd][_0x38f87a(0x20b)]({'function':_0x38f87a(0x10c),'args':null});}),tgBot[_0x5e84ba(0x239)]('callback_query');});}else{const _0x1df985=_0x27f0fe[0x0]['botID'];if(pid[_0x1df985])pid[_0x1df985][_0x5ca976(0x20b)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['onText'](/\/portfolio/,_0x2ce786=>{const _0x22cced=_0x38ed86;if(!validateTelegram(_0x2ce786))return;tgBot['removeListener'](_0x22cced(0x288));const _0x12c237=getEnabledBots();if(_0x12c237[_0x22cced(0xbf)]==0x0)tgBot[_0x22cced(0xba)](_0x2ce786[_0x22cced(0x198)]['id'],_0x22cced(0x179))['catch'](_0x4fe1ff=>{telegramError(_0x4fe1ff);});else{if(_0x12c237[_0x22cced(0xbf)]>0x1){let _0x2984c2=[],_0x58e24f=[];const _0x2c12f6=_0x12c237['length']%0x4==0x0||_0x12c237[_0x22cced(0xbf)]%0x4==0x3||_0x12c237[_0x22cced(0xbf)]%0x3==0x1?0x4:0x3;let _0x5af490=0x0;_0x12c237[_0x22cced(0x194)]((_0x5452c2,_0x185d94)=>{const _0x4d8bca=_0x22cced;if(_0x185d94%_0x2c12f6==0x0)_0x58e24f=[];_0x58e24f[_0x4d8bca(0x105)]({'text':_0x4d8bca(0xd0)+_0x5452c2[_0x4d8bca(0x1ba)],'callback_data':_0x5452c2[_0x4d8bca(0x1ba)]}),_0x185d94%_0x2c12f6==0x0&&(_0x2984c2[_0x5af490]=_0x58e24f,_0x5af490++);}),tgBot[_0x22cced(0xba)](_0x2ce786[_0x22cced(0x198)]['id'],_0x22cced(0x1e2),{'reply_markup':{'inline_keyboard':_0x2984c2}})['catch'](_0x34f8fa=>{telegramError(_0x34f8fa);}),tgBot['on'](_0x22cced(0x288),async _0x50bede=>{const _0x477bfa=_0x22cced,_0x498c4e=_0x50bede[_0x477bfa(0x15f)],_0x2e9ad3=_0x50bede[_0x477bfa(0x206)];tgBot[_0x477bfa(0x119)](_0x50bede['id'])[_0x477bfa(0x25c)](async()=>{const _0x288759=_0x477bfa;if(pid[_0x498c4e])pid[_0x498c4e]['send']({'function':_0x288759(0xb0),'args':null});}),tgBot['removeListener'](_0x477bfa(0x288));});}else{const _0x5eac6b=_0x12c237[0x0][_0x22cced(0x1ba)];if(pid[_0x5eac6b])pid[_0x5eac6b]['send']({'function':_0x22cced(0xb0),'args':null});}}}),tgBot['onText'](/\/update/,async _0x2ee3b3=>{const _0x4f9430=_0x38ed86;if(!validateTelegram(_0x2ee3b3))return;tgBot[_0x4f9430(0x239)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x4f9430(0xba)](_0x2ee3b3[_0x4f9430(0x198)]['id'],_0x4f9430(0x256))[_0x4f9430(0x20e)](_0x101d53=>{telegramError(_0x101d53);});else!validInstallation?tgBot[_0x4f9430(0xba)](_0x2ee3b3[_0x4f9430(0x198)]['id'],_0x4f9430(0x201))[_0x4f9430(0x20e)](_0xa3a8c8=>{telegramError(_0xa3a8c8);}):(tgBot['sendMessage'](_0x2ee3b3[_0x4f9430(0x198)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x4f9430(0x1a1)},{'text':'No','callback_data':'no'}]]}})[_0x4f9430(0x20e)](_0x5c596d=>{telegramError(_0x5c596d);}),tgBot['on'](_0x4f9430(0x288),async _0x1e78d8=>{const _0x11c4a1=_0x4f9430,_0x570620=_0x1e78d8['data'],_0x1c8f2a=_0x1e78d8[_0x11c4a1(0x206)];tgBot[_0x11c4a1(0x119)](_0x1e78d8['id'])[_0x11c4a1(0x25c)](async()=>{const _0x18a258=_0x11c4a1;_0x570620==_0x18a258(0x1a1)&&(await tgBot[_0x18a258(0xba)](_0x1c8f2a[_0x18a258(0x198)]['id'],_0x18a258(0x284))[_0x18a258(0x20e)](_0x591f57=>{telegramError(_0x591f57);}),updateBB(_0x18a258(0xc9))),_0x570620=='no'&&await tgBot[_0x18a258(0xba)](_0x1c8f2a[_0x18a258(0x198)]['id'],_0x18a258(0xdb))['catch'](_0x1a8ffd=>{telegramError(_0x1a8ffd);});}),tgBot['removeListener'](_0x11c4a1(0x288));}));}),tgBot[_0x38ed86(0x10e)](/\/reinstall/,async _0x5ae1db=>{const _0x67a46b=_0x38ed86;if(!validateTelegram(_0x5ae1db))return;tgBot['removeListener'](_0x67a46b(0x288)),!validInstallation?tgBot['sendMessage'](_0x5ae1db['chat']['id'],_0x67a46b(0x1f0))[_0x67a46b(0x20e)](_0x3982f8=>{telegramError(_0x3982f8);}):(tgBot[_0x67a46b(0xba)](_0x5ae1db['chat']['id'],_0x67a46b(0x162),{'reply_markup':{'inline_keyboard':[[{'text':_0x67a46b(0x195),'callback_data':_0x67a46b(0x1a1)},{'text':'No','callback_data':'no'}]]}})[_0x67a46b(0x20e)](_0x36e29f=>{telegramError(_0x36e29f);}),tgBot['on'](_0x67a46b(0x288),async _0x2a1976=>{const _0xe971f=_0x67a46b,_0x16ae54=_0x2a1976['data'],_0x4c5881=_0x2a1976[_0xe971f(0x206)];tgBot['answerCallbackQuery'](_0x2a1976['id'])['then'](async()=>{const _0x3e546d=_0xe971f;_0x16ae54=='yes'&&(await tgBot[_0x3e546d(0xba)](_0x4c5881[_0x3e546d(0x198)]['id'],_0x3e546d(0x17d))[_0x3e546d(0x20e)](_0x27fb6e=>{telegramError(_0x27fb6e);}),updateBB('reinstall')),_0x16ae54=='no'&&await tgBot[_0x3e546d(0xba)](_0x4c5881[_0x3e546d(0x198)]['id'],_0x3e546d(0x1bb))[_0x3e546d(0x20e)](_0x4e666f=>{telegramError(_0x4e666f);});}),tgBot[_0xe971f(0x239)]('callback_query');}));}),tgBot[_0x38ed86(0x10e)](/\/toggle/,_0x4b9fa1=>{const _0x1e04e3=_0x38ed86;if(!validateTelegram(_0x4b9fa1))return;tgBot[_0x1e04e3(0x239)](_0x1e04e3(0x288));const _0x1303cf=getBotsWithMode();if(_0x1303cf[_0x1e04e3(0xbf)]==0x0)tgBot[_0x1e04e3(0xba)](_0x4b9fa1[_0x1e04e3(0x198)]['id'],_0x1e04e3(0x179))[_0x1e04e3(0x20e)](_0x38517f=>{telegramError(_0x38517f);});else{let _0x50cd1f=[],_0xda36ba=[];const _0x2a0378=0x2;let _0x573d6f=0x0;_0x1303cf['forEach']((_0x3b437d,_0x7216b1)=>{const _0x2879d=_0x1e04e3;if(_0x7216b1%_0x2a0378==0x0)_0xda36ba=[];_0xda36ba[_0x2879d(0x105)]({'text':_0x2879d(0xd0)+_0x3b437d[_0x2879d(0x1ba)]+'\x20('+_0x3b437d['mode']+')','callback_data':_0x3b437d['botID']}),_0x7216b1%_0x2a0378==0x0&&(_0x50cd1f[_0x573d6f]=_0xda36ba,_0x573d6f++);}),tgBot[_0x1e04e3(0xba)](_0x4b9fa1['chat']['id'],_0x1e04e3(0x281),{'reply_markup':{'inline_keyboard':_0x50cd1f}})['catch'](_0x17a3ae=>{telegramError(_0x17a3ae);}),tgBot['on'](_0x1e04e3(0x288),async _0xe2ab73=>{const _0x5b13d5=_0x1e04e3,_0x36e873=_0xe2ab73[_0x5b13d5(0x15f)],_0x1557f6=_0xe2ab73[_0x5b13d5(0x206)];tgBot['answerCallbackQuery'](_0xe2ab73['id'])['then'](async()=>{const _0xd7508a=_0x5b13d5,_0xbb850=_0x1303cf[_0xd7508a(0xb6)](_0x36eb25=>_0x36eb25[_0xd7508a(0x1ba)]==_0x36e873),_0x3f338d=_0xbb850[_0xd7508a(0x116)]==_0xd7508a(0xe8)?_0xd7508a(0xf8):_0xd7508a(0xe8);tgBot[_0xd7508a(0xba)](_0x1557f6[_0xd7508a(0x198)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x36e873+_0xd7508a(0x28b)+_0x3f338d+_0xd7508a(0x222))[_0xd7508a(0x20e)](_0x49f96f=>{telegramError(_0x49f96f);}),toggleBotMode(_0x36e873);}),tgBot['removeListener'](_0x5b13d5(0x288));});}}),tgBot[_0x38ed86(0x10e)](/\/names/,_0x7a7c68=>{const _0x596dd1=_0x38ed86;if(!validateTelegram(_0x7a7c68))return;let _0x5ed80e='';config['forEach'](_0x292dda=>{const _0xfbaa2b=_0xb091;_0x5ed80e+='Bot\x20'+_0x292dda[_0xfbaa2b(0x1ba)]+':\x20'+_0x292dda['botname']+'\x0a';}),tgBot[_0x596dd1(0xba)](_0x7a7c68[_0x596dd1(0x198)]['id'],_0x5ed80e,{'parse_mode':_0x596dd1(0x1c2)})[_0x596dd1(0x20e)](_0x29a7f2=>{telegramError(_0x29a7f2);});}),tgBot[_0x38ed86(0x10e)](/\/disable/,_0x5ceb67=>{const _0x4543f3=_0x38ed86;if(!validateTelegram(_0x5ceb67))return;tgBot[_0x4543f3(0xba)](_0x5ceb67[_0x4543f3(0x198)]['id'],_0x4543f3(0x252))[_0x4543f3(0x20e)](_0x313c83=>{telegramError(_0x313c83);}),updateSetting(_0x4543f3(0x26a),![]);}),tgBot['onText'](/\/help/,_0x490216=>{const _0x3dd604=_0x38ed86;if(!validateTelegram(_0x490216))return;tgBot[_0x3dd604(0xba)](_0x490216[_0x3dd604(0x198)]['id'],_0x4d5436)[_0x3dd604(0x20e)](_0x38c0b5=>{telegramError(_0x38c0b5);});}),tgBot['on']('polling_error',_0xb8c2a5=>{const _0x4d63f5=_0x38ed86;_0xb8c2a5['toString']()[_0x4d63f5(0x258)](_0x4d63f5(0x1d2))&&(logger['full'](_0x4d63f5(0x14e)),tgBot[_0x4d63f5(0x280)](),tgBot=null,io['to'](_0x4d63f5(0x1e5))[_0x4d63f5(0x15c)]('notification',_0x4d63f5(0x14e)));}),process[_0x38ed86(0x1cb)](_0x38ed86(0xbd),()=>{const _0x45f7d5=_0x38ed86;if(tgBot)tgBot[_0x45f7d5(0x280)]();process[_0x45f7d5(0x20f)](0x1);}),process[_0x38ed86(0x1cb)]('SIGTERM',()=>{const _0x1aa98d=_0x38ed86;if(tgBot)tgBot['stopPolling']();process[_0x1aa98d(0x20f)](0x1);});}}function disableTelegram(){const _0x2ec662=_0x5f2c03;tgBot&&(tgBot[_0x2ec662(0x280)](),tgBot=null);}function sendTelegram(_0x53110d,_0x181046){const _0x531787=_0x5f2c03;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x531787(0x107)||(_0x181046['type']==_0x531787(0x10b)||_0x181046[_0x531787(0x205)]==_0x531787(0x12a)||_0x181046[_0x531787(0x205)]==_0x531787(0x21e))&&settings[_0x531787(0x26e)]=='alerts'||_0x181046[_0x531787(0x205)]==_0x531787(0x20d)&&settings[_0x531787(0x26e)]==_0x531787(0x110)){if(tgBot&&settings[_0x531787(0x144)]){if(_0x181046['showname'])tgBot['sendMessage'](settings['telegramChatId'],_0x181046['botname']+_0x531787(0x218)+_0x181046[_0x531787(0x16c)])[_0x531787(0x20e)](_0x40b81c=>{telegramError(_0x40b81c);});else tgBot[_0x531787(0xba)](settings['telegramChatId'],_0x531787(0xd0)+_0x53110d+'\x20>\x20'+_0x181046[_0x531787(0x16c)])[_0x531787(0x20e)](_0x172a8f=>{telegramError(_0x172a8f);});}}}}async function sendTelegramMsg(_0x197810,_0x595fa5=_0x5f2c03(0x1c2)){const _0x13d5d4=_0x5f2c03;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await tgBot[_0x13d5d4(0xba)](settings[_0x13d5d4(0x144)],_0x197810,{'parse_mode':_0x595fa5})[_0x13d5d4(0x20e)](_0x469431=>{telegramError(_0x469431);}),!![]):![];}function getDeviceWithIp(_0x2b8f33){return devices['find'](_0x4caa43=>_0x4caa43['ip']===_0x2b8f33);}function temporaryAccess2FA(_0x4aa221,_0x1ae658){const _0x46c15e=_0x5f2c03;let _0xff70=new Date(),_0x58d742=![];if(lastIpApproval){if(_0xff70-lastIpApproval<0x1388)_0x58d742=!![];}lastIpApproval=new Date();if(_0x58d742)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x46c15e(0x288)),tgBot[_0x46c15e(0xba)](settings[_0x46c15e(0x144)],_0x46c15e(0x1dd)+normalizeIP(_0x1ae658)[_0x46c15e(0x153)]+_0x46c15e(0x1a2),{'parse_mode':_0x46c15e(0x1c2),'reply_markup':{'inline_keyboard':[[{'text':_0x46c15e(0x21a),'callback_data':'5'},{'text':_0x46c15e(0x1a9),'callback_data':'15'},{'text':_0x46c15e(0x223),'callback_data':'30'},{'text':_0x46c15e(0x1df),'callback_data':_0x46c15e(0x1df)}]]}})['catch'](_0x286472=>{telegramError(_0x286472);}),tgBot['on'](_0x46c15e(0x288),async _0xdafbae=>{const _0x3f15ff=_0x46c15e,_0x39170e=_0xdafbae[_0x3f15ff(0x15f)],_0x55fbd6=_0xdafbae[_0x3f15ff(0x206)];tgBot[_0x3f15ff(0x119)](_0xdafbae['id'])[_0x3f15ff(0x25c)](async()=>{const _0x4601bd=_0x3f15ff;devices[_0x4aa221]['telegramIpApproval']={'clientip':_0x1ae658,'timestamp':new Date()[_0x4601bd(0x1fe)](),'expiry':_0x39170e},_0x39170e!=_0x4601bd(0x1df)?(await tgBot['sendMessage'](_0x55fbd6['chat']['id'],'Access\x20enabled\x20for\x20'+_0x39170e+_0x4601bd(0x1d4),{'parse_mode':'HTML'})[_0x4601bd(0x20e)](_0x2d24c2=>{telegramError(_0x2d24c2);}),io['to'](_0x4aa221)['emit'](_0x4601bd(0x1c7),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x4601bd(0xba)](_0x55fbd6['chat']['id'],'Temporary\x20access\x20rejected')[_0x4601bd(0x20e)](_0x3f0c88=>{telegramError(_0x3f0c88);}),io['to'](_0x4aa221)[_0x4601bd(0x15c)](_0x4601bd(0x1c7),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x3f15ff(0x239)](_0x3f15ff(0x288));}));}function loginAccess2FA(_0x1b50fd,_0xe317e8){const _0x1c52e6=_0x5f2c03;tgBot&&settings[_0x1c52e6(0x144)]&&(tgBot[_0x1c52e6(0x239)](_0x1c52e6(0x288)),tgBot[_0x1c52e6(0xba)](settings[_0x1c52e6(0x144)],_0x1c52e6(0x241)+normalizeIP(_0xe317e8)[_0x1c52e6(0x153)]+_0x1c52e6(0x1a2),{'parse_mode':_0x1c52e6(0x1c2),'reply_markup':{'inline_keyboard':[[{'text':_0x1c52e6(0xec),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x1c52e6(0x1df)}]]}})['catch'](_0x24333e=>{telegramError(_0x24333e);}),tgBot['on'](_0x1c52e6(0x288),async _0x38e6c0=>{const _0x40ae6e=_0x1c52e6,_0xae779e=_0x38e6c0[_0x40ae6e(0x15f)],_0x3b33f5=_0x38e6c0[_0x40ae6e(0x206)];tgBot[_0x40ae6e(0x119)](_0x38e6c0['id'])[_0x40ae6e(0x25c)](async()=>{const _0x3eb961=_0x40ae6e;devices[_0x1b50fd][_0x3eb961(0x227)]={'clientip':_0xe317e8,'timestamp':new Date()[_0x3eb961(0x1fe)](),'expiry':_0xae779e},_0xae779e!=_0x3eb961(0x1df)?(await tgBot[_0x3eb961(0xba)](_0x3b33f5['chat']['id'],_0x3eb961(0x199),{'parse_mode':_0x3eb961(0x1c2)})[_0x3eb961(0x20e)](_0x3ab46b=>{telegramError(_0x3ab46b);}),io['to'](_0x1b50fd)[_0x3eb961(0x15c)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x3eb961(0xba)](_0x3b33f5['chat']['id'],'Login\x20rejected')['catch'](_0x40e56b=>{telegramError(_0x40e56b);}),io['to'](_0x1b50fd)[_0x3eb961(0x15c)](_0x3eb961(0x1c7),{'access':{'allow':![],'reason':_0x3eb961(0x1ce),'token':null}}));}),tgBot[_0x40ae6e(0x239)](_0x40ae6e(0x288));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x361720=_0x5f2c03;return dbConfig['get'](_0x361720(0x240))['sortBy'](_0x361720(0x1ba))[_0x361720(0x1f7)]({'status':_0x361720(0x138)})[_0x361720(0x28a)]()||[];}function getDisabledBots(){const _0x43e67a=_0x5f2c03;return dbConfig[_0x43e67a(0x243)](_0x43e67a(0x240))[_0x43e67a(0x192)]('botID')[_0x43e67a(0x1f7)]({'status':_0x43e67a(0xd5)})[_0x43e67a(0x28a)]()||[];}function getBotAttributes(_0x37eb89){const _0x5873cb=_0x5f2c03;let _0x2fbdab={};const _0x49e577=configpath+'bot-'+_0x37eb89+_0x5873cb(0x103),_0x4eabe5=fs['existsSync'](_0x49e577);if(_0x4eabe5){const _0x4a8920=fs[_0x5873cb(0x11a)](_0x49e577);try{const _0x14c0ac=JSON[_0x5873cb(0x1b1)](_0x4a8920),_0x37b201=_0x14c0ac?_0x14c0ac['bot'][0x0]['headless']:![];_0x2fbdab[_0x5873cb(0x116)]=_0x37b201?_0x5873cb(0xe8):_0x5873cb(0xf8),_0x2fbdab[_0x5873cb(0x113)]=_0x14c0ac?_0x14c0ac[_0x5873cb(0x245)][0x0][_0x5873cb(0x113)]:'Bot\x20'+_0x37eb89;}catch(_0x5450f2){_0x2fbdab[_0x5873cb(0x116)]=_0x5873cb(0xf8),_0x2fbdab[_0x5873cb(0x113)]=_0x5873cb(0xd0)+_0x37eb89;}}else _0x2fbdab[_0x5873cb(0x116)]=_0x5873cb(0xf8),_0x2fbdab[_0x5873cb(0x113)]=_0x5873cb(0xd0)+_0x37eb89;return _0x2fbdab;}function getBotsWithMode(){const _0x71e33d=_0x5f2c03,_0x1b355b=dbConfig['get'](_0x71e33d(0x240))[_0x71e33d(0x192)]('botID')[_0x71e33d(0x28a)]()||[];return _0x1b355b['forEach'](_0x239158=>{const _0x464a6e=_0x71e33d;let _0x18c523=getBotAttributes(_0x239158['botID']);_0x239158['mode']=_0x18c523[_0x464a6e(0x116)];}),_0x1b355b;}function getBotExchanges(){const _0x5d628e=_0x5f2c03;let _0x1cc647=[];const _0x5ab99a=dbConfig[_0x5d628e(0x243)](_0x5d628e(0x240))[_0x5d628e(0x192)]('botID')[_0x5d628e(0x28a)]()||[];_0x5ab99a[_0x5d628e(0x194)](_0x5dbf7d=>{const _0x2333f2=_0x5d628e;if(_0x5dbf7d[_0x2333f2(0x1c7)]=='enabled'){const _0x1df290=configpath+'bot-'+_0x5dbf7d[_0x2333f2(0x1ba)]+_0x2333f2(0x103),_0x3e3788=fs[_0x2333f2(0xb4)](_0x1df290);let _0x458b20;if(_0x3e3788){const _0x17a2ed=fs[_0x2333f2(0x11a)](_0x1df290);try{const _0x2cec60=JSON['parse'](_0x17a2ed);_0x458b20=_0x2cec60?_0x2cec60[_0x2333f2(0x245)][0x0][_0x2333f2(0xb1)]:null;}catch(_0x1ef027){}}if(_0x458b20)_0x1cc647[_0x2333f2(0x105)](_0x458b20);}});const _0x3d7459=[...new Set(_0x1cc647)]['sort']();return _0x3d7459;}async function initUser(){const _0x415d69=_0x5f2c03;if(!settings['userid']){const _0x2ff164=uuidRandom();mixpanel[_0x415d69(0xeb)](_0x2ff164),updateSetting(_0x415d69(0x278),_0x2ff164);}}async function initSecure(){const _0x432b4e=_0x5f2c03;let _0x4a9fd0=getSecure();if(!_0x4a9fd0['hasOwnProperty'](_0x432b4e(0xf4))){let _0x48b41e=await generateKeys();_0x4a9fd0['publicKey']=_0x48b41e[_0x432b4e(0x26f)],_0x4a9fd0[_0x432b4e(0x215)]=_0x48b41e[_0x432b4e(0x215)],_0x4a9fd0[_0x432b4e(0xf4)]=crypto[_0x432b4e(0x18b)](0x20)[_0x432b4e(0x276)]('hex');;storeSecure(_0x4a9fd0);}}function getSettings(){const _0x39a587=_0x5f2c03;return dbSettings[_0x39a587(0x243)](_0x39a587(0xc3))['value']()||{};}function getSecure(){const _0x439c56=_0x5f2c03;return dbSecure[_0x439c56(0x243)](_0x439c56(0xe3))[_0x439c56(0x28a)]()||{};}function getBlacklist(){const _0x1efa89=_0x5f2c03;return dbSecure['get'](_0x1efa89(0x1e1))[_0x1efa89(0x28a)]()||[];}function broadcastToBots(_0x138580,_0x33ea1d){const _0x4e1e20=_0x5f2c03;config[_0x4e1e20(0x194)](_0x3d3ef2=>{const _0x49c84f=_0x4e1e20;if(_0x3d3ef2[_0x49c84f(0x1c7)]==_0x49c84f(0x138)&&_0x3d3ef2[_0x49c84f(0x13a)]==_0x49c84f(0xdc)||_0x3d3ef2['status']==_0x49c84f(0x1f6)&&_0x3d3ef2[_0x49c84f(0x13a)]=='running'){if(pid[_0x3d3ef2[_0x49c84f(0x1ba)]])pid[_0x3d3ef2['botID']]['send']({[_0x138580]:_0x33ea1d});}});}function storeSettings(_0x407fff,_0x254967=![]){const _0x587436=_0x5f2c03;_0x407fff={...settings,..._0x407fff};if(_0x254967&&_0x407fff[_0x587436(0x18f)]!=_0x587436(0xad)&&_0x407fff['bbPassword']!=_0x587436(0x1c9)&&_0x407fff[_0x587436(0x18f)]!=''){const _0x5498e8=crypt[_0x587436(0x27c)](secure[_0x587436(0x215)],_0x407fff[_0x587436(0x18f)])['message'][_0x587436(0xd2)]('@')[0x0],_0x16d1d8=bcrypt[_0x587436(0x18a)](_0x5498e8,saltRounds);_0x407fff={..._0x407fff,'bbPassword':_0x16d1d8};}if(_0x254967&&_0x407fff[_0x587436(0x196)]!='************'&&_0x407fff[_0x587436(0x196)]!=_0x587436(0x1c9)&&_0x407fff['telegramToken']!=''){const _0x1f23c9=crypt[_0x587436(0x27c)](secure['privateKey'],_0x407fff[_0x587436(0x196)])['message'][_0x587436(0xd2)]('@')[0x0];_0x407fff={..._0x407fff,'telegramToken':_0x1f23c9};}const _0x2a58f0=_0x407fff[_0x587436(0x196)]!='************'&&_0x407fff[_0x587436(0x196)]!=settings[_0x587436(0x196)]||_0x407fff['telegramUsername']!=settings['telegramUsername'],_0x19f770=_0x407fff['telegramToken']==''||_0x407fff['telegramUsername']=='';if(_0x2a58f0)_0x407fff['telegramEvents']=_0x587436(0x107);for(const [_0x31f1b2,_0xd8835f]of Object['entries'](_0x407fff)){if(_0x31f1b2==_0x587436(0x196)&&_0xd8835f=='************'){_0x407fff[_0x587436(0x196)]=settings[_0x587436(0x196)];continue;};if(_0x31f1b2==_0x587436(0x18f)&&_0xd8835f=='************'){_0x407fff[_0x587436(0x18f)]=settings[_0x587436(0x18f)];continue;};dbSettings['set'](_0x587436(0x1b3)+_0x31f1b2,_0xd8835f)['write']();}settings=_0x407fff,io['to'](_0x587436(0x1e5))['emit'](_0x587436(0xc3),cleanSettings()),broadcastToBots(_0x587436(0x159),settings['timeshift']),broadcastToBots(_0x587436(0x260),settings[_0x587436(0x260)]);if(_0x2a58f0&&!_0x19f770)initTelegram();if(_0x2a58f0&&_0x19f770)disableTelegram();getAllClients()['forEach'](_0x4af857=>{const _0x5b7477=_0x587436;getSocket(_0x4af857['id'])[_0x5b7477(0x15c)]('status',{'access':{'allow':![],'reason':_0x5b7477(0x27a),'token':null}});});}function updateSetting(_0x1951a5,_0x599996){const _0x22afdf=_0x5f2c03;dbSettings[_0x22afdf(0x242)](_0x22afdf(0x1b3)+_0x1951a5,_0x599996)['write'](),settings=getSettings(),io['to']('botmanager')[_0x22afdf(0x15c)](_0x22afdf(0xc3),cleanSettings());}function storeSecure(_0x4133ac){const _0x48287c=_0x5f2c03;dbSecure[_0x48287c(0x243)](_0x48287c(0xe3))[_0x48287c(0x105)](_0x4133ac)[_0x48287c(0x214)](),secure=_0x4133ac;}function addBlacklist(_0x220bb2){const _0x4681f2=_0x5f2c03;cleanBlacklist();let _0x12642a;devices[_0x220bb2][_0x4681f2(0x20a)]?_0x12642a=Math['max'](devices[_0x220bb2][_0x4681f2(0x20a)][_0x4681f2(0x1d3)],loginExpiry):_0x12642a=loginExpiry,dbSecure[_0x4681f2(0x243)](_0x4681f2(0x1e1))[_0x4681f2(0x105)]({'expiry':new Date()['getTime']()+_0x12642a*0x3c*0x3e8,'token':devices[_0x220bb2][_0x4681f2(0x141)][_0x4681f2(0x161)]})[_0x4681f2(0x214)](),blacklist=dbSecure[_0x4681f2(0x243)](_0x4681f2(0x1e1))[_0x4681f2(0x28a)]();}function cleanBlacklist(){const _0xfa7cdf=_0x5f2c03;let _0x5694ba=dbSecure[_0xfa7cdf(0x243)](_0xfa7cdf(0x1e1))[_0xfa7cdf(0x1e6)]()[_0xfa7cdf(0x28a)](),_0x275fd8=new Date()[_0xfa7cdf(0x1fe)]();_0x5694ba[_0xfa7cdf(0x194)](_0x9cfc00=>{const _0x35aa51=_0xfa7cdf;_0x9cfc00[_0x35aa51(0x1d3)]<_0x275fd8&&dbSecure[_0x35aa51(0x243)]('blacklist')[_0x35aa51(0x13c)]({'expiry':_0x9cfc00[_0x35aa51(0x1d3)]})[_0x35aa51(0x214)]();});}function initStates(){const _0x3780f5=_0x5f2c03;let _0xcd81e8=getConfiguration();_0xcd81e8[_0x3780f5(0x194)](_0x17acd4=>{const _0x5b7289=_0x3780f5;_0x17acd4[_0x5b7289(0x13a)]=_0x5b7289(0x22b);}),storeConfiguration(_0xcd81e8);}function onKeys(){const _0x45e2d9=new RSA();return new Promise(_0x13ad9b=>{const _0x4e69e5=_0xb091;_0x45e2d9['generateKeyPairAsync']()[_0x4e69e5(0x25c)](_0x2a6406=>{_0x13ad9b(_0x2a6406);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x73f7d4=_0x5f2c03;let _0x4570ab=getSettings(),_0x238254=![];!_0x4570ab[_0x73f7d4(0x27d)]('lastmsgtelegram')&&(_0x4570ab['lastmsgtelegram']=0x0,_0x238254=!![]);!_0x4570ab[_0x73f7d4(0x27d)](_0x73f7d4(0xfc))&&(_0x4570ab[_0x73f7d4(0xfc)]=0x0,_0x238254=!![]);!_0x4570ab[_0x73f7d4(0x27d)](_0x73f7d4(0xc0))&&(_0x4570ab[_0x73f7d4(0xc0)]=_0x73f7d4(0x1c5),_0x238254=!![]);!_0x4570ab[_0x73f7d4(0x27d)]('onepagemode')&&(_0x4570ab[_0x73f7d4(0x260)]=![],_0x238254=!![]);if(_0x238254)storeSettings(_0x4570ab);try{fs[_0x73f7d4(0x25f)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x6d7816=>{const _0x12d0b9=_0x73f7d4;if(!_0x6d7816[_0x12d0b9(0x13f)]()){if(!_0x6d7816[_0x12d0b9(0x22d)][_0x12d0b9(0x122)](_0x12d0b9(0x268)))fs[_0x12d0b9(0xed)](configbackuppath+_0x6d7816['name']);}else fs[_0x12d0b9(0xe4)](configbackuppath+_0x6d7816[_0x12d0b9(0x22d)],{'recursive':!![]});});}catch(_0x12208b){logger[_0x73f7d4(0x1fa)](_0x73f7d4(0x27b),_0x12208b);}}function storeConfiguration(_0xb130c3){const _0x1ab6c9=_0x5f2c03;dbConfig[_0x1ab6c9(0x243)](_0x1ab6c9(0x240))[_0x1ab6c9(0x13c)]()[_0x1ab6c9(0x214)](),_0xb130c3[_0x1ab6c9(0x194)](_0x19bbd8=>{const _0x3da41e=_0x1ab6c9;delete _0x19bbd8[_0x3da41e(0x116)];}),dbConfig[_0x1ab6c9(0x243)](_0x1ab6c9(0x240))[_0x1ab6c9(0x105)](..._0xb130c3)[_0x1ab6c9(0x214)](),config=_0xb130c3;}function resetPassword(){const _0x22a943=_0x5f2c03;tgBot&&settings[_0x22a943(0x144)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x22a943(0xba)](settings['telegramChatId'],_0x22a943(0x11f),{'parse_mode':_0x22a943(0x1c2),'reply_markup':{'inline_keyboard':[[{'text':_0x22a943(0x1a1),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2a18bc=>{telegramError(_0x2a18bc);}),tgBot['on'](_0x22a943(0x288),async _0x4fc8d3=>{const _0x5ae797=_0x22a943,_0x3375c9=_0x4fc8d3[_0x5ae797(0x15f)],_0x522cf3=_0x4fc8d3[_0x5ae797(0x206)];tgBot[_0x5ae797(0x119)](_0x4fc8d3['id'])[_0x5ae797(0x25c)](async()=>{const _0x96cebf=_0x5ae797;if(_0x3375c9!='no'){const _0x5bf869=0xf,_0x397775=_0x96cebf(0x1d8),_0x1d3a71=Array['from'](crypto[_0x96cebf(0x175)](new Uint32Array(_0x5bf869)))[_0x96cebf(0x1b7)](_0xbbce3b=>_0x397775[_0xbbce3b%_0x397775['length']])[_0x96cebf(0xfe)](''),_0x3edea2=bcrypt[_0x96cebf(0x18a)](_0x1d3a71,saltRounds);storeSettings({'bbPassword':_0x3edea2}),await tgBot[_0x96cebf(0xba)](_0x522cf3[_0x96cebf(0x198)]['id'],_0x96cebf(0x233)+_0x1d3a71,{'parse_mode':_0x96cebf(0x1c2)})['catch'](_0x630de7=>{telegramError(_0x630de7);});}else await tgBot[_0x96cebf(0xba)](_0x522cf3['chat']['id'],_0x96cebf(0x19b))[_0x96cebf(0x20e)](_0x29443c=>{telegramError(_0x29443c);});}),tgBot[_0x5ae797(0x239)](_0x5ae797(0x288));}));}async function confirmRestore(_0x46d0ac,_0x28caf2){const _0x3fa3f0=_0x5f2c03;io['to'](_0x3fa3f0(0x1e5))['emit']('notification',_0x3fa3f0(0x203),_0x3fa3f0(0x21e)),tgBot&&settings[_0x3fa3f0(0x144)]&&(tgBot[_0x3fa3f0(0x239)](_0x3fa3f0(0x288)),await tgBot[_0x3fa3f0(0xba)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x3fa3f0(0x1c2),'reply_markup':{'inline_keyboard':[[{'text':_0x3fa3f0(0x1a1),'callback_data':_0x3fa3f0(0x1a1)},{'text':'no','callback_data':'no'}]]}})[_0x3fa3f0(0x20e)](_0xd79964=>{telegramError(_0xd79964);}),tgBot['on']('callback_query',async _0x3124e1=>{const _0x9b0c8=_0x3fa3f0,_0x4243c1=_0x3124e1[_0x9b0c8(0x15f)],_0xb43e05=_0x3124e1['message'];tgBot[_0x9b0c8(0x119)](_0x3124e1['id'])[_0x9b0c8(0x25c)](async()=>{const _0x254d31=_0x9b0c8;_0x4243c1==_0x254d31(0x1a1)?(await tgBot['sendMessage'](_0xb43e05[_0x254d31(0x198)]['id'],_0x254d31(0x1f8),{'parse_mode':_0x254d31(0x1c2)})[_0x254d31(0x20e)](_0x2d36b1=>{telegramError(_0x2d36b1);}),unzipFile(_0x46d0ac,_0x28caf2)):(logger[_0x254d31(0x1fa)](_0x254d31(0xd1)),await tgBot[_0x254d31(0xba)](_0xb43e05[_0x254d31(0x198)]['id'],_0x254d31(0xd1))['catch'](_0xd6befb=>{telegramError(_0xd6befb);}));}),tgBot[_0x9b0c8(0x239)](_0x9b0c8(0x288));}));}function getServerTime(){const _0x321640=_0x5f2c03,_0x2019d3=new Date();return _0x2019d3['getFullYear']()+'/'+(_0x2019d3[_0x321640(0x1b6)]()+0x1)['toString']()[_0x321640(0x26c)](0x2,'0')+'/'+_0x2019d3['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2019d3['getHours']()[_0x321640(0x276)]()[_0x321640(0x26c)](0x2,'0')+':'+_0x2019d3[_0x321640(0x156)]()[_0x321640(0x276)]()[_0x321640(0x26c)](0x2,'0')+':'+_0x2019d3[_0x321640(0x279)]()[_0x321640(0x276)]()[_0x321640(0x26c)](0x2,'0');}function getTimeStamp(){const _0x471ebb=_0x5f2c03,_0x3d47c6=shiftedTime();return _0x3d47c6['getFullYear']()+'/'+(_0x3d47c6['getMonth']()+0x1)['toString']()[_0x471ebb(0x26c)](0x2,'0')+'/'+_0x3d47c6[_0x471ebb(0x19f)]()[_0x471ebb(0x276)]()[_0x471ebb(0x26c)](0x2,'0')+'\x20'+_0x3d47c6[_0x471ebb(0x14f)]()['toString']()['padStart'](0x2,'0')+':'+_0x3d47c6[_0x471ebb(0x156)]()[_0x471ebb(0x276)]()[_0x471ebb(0x26c)](0x2,'0')+':'+_0x3d47c6['getSeconds']()[_0x471ebb(0x276)]()[_0x471ebb(0x26c)](0x2,'0');}function getCleanTimeStamp(){const _0x4f803b=_0x5f2c03,_0x1f91c2=shiftedTime();return _0x1f91c2['getFullYear']()+(_0x1f91c2[_0x4f803b(0x1b6)]()+0x1)[_0x4f803b(0x276)]()[_0x4f803b(0x26c)](0x2,'0')+_0x1f91c2[_0x4f803b(0x19f)]()[_0x4f803b(0x276)]()[_0x4f803b(0x26c)](0x2,'0')+'-'+_0x1f91c2[_0x4f803b(0x14f)]()['toString']()[_0x4f803b(0x26c)](0x2,'0')+_0x1f91c2[_0x4f803b(0x156)]()[_0x4f803b(0x276)]()['padStart'](0x2,'0')+_0x1f91c2['getSeconds']()[_0x4f803b(0x276)]()[_0x4f803b(0x26c)](0x2,'0');}function shiftedTime(){const _0x3b44e7=_0x5f2c03,_0x418bd3=new Date();let _0x55072c=_0x418bd3;if(settings[_0x3b44e7(0x159)]&&settings[_0x3b44e7(0x159)]!==0x0)_0x55072c=fns['add'](_0x418bd3,{'hours':settings[_0x3b44e7(0x159)]});return _0x55072c;}function startScheduler(){const _0x1b8ab0=_0x5f2c03,_0x4270d5=new Date()[_0x1b8ab0(0xb2)](),_0x232f7b=shiftedTime()['getHours']();_0x232f7b==0x4&&backupConfigFiles();_0x232f7b==0x0&&rotateLogFiles();_0x4270d5%0x6==0x0&&triggerAnalytics();_0x4270d5%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x556c8b){const _0x1c0236=_0x5f2c03;logger['debug'](_0x1c0236(0xc2)+_0x556c8b);const _0x1f712d=getBotsWithMode();_0x1f712d[_0x1c0236(0xbf)]>0x0?confirmRestore(configbackuppath,_0x556c8b):unzipFile(configbackuppath,_0x556c8b);}async function getBackupFiles(_0x51c962=null){const _0x2dff9e=_0x5f2c03;let _0x156ee1=[],_0x1e78b9=fs[_0x2dff9e(0x25f)](configbackuppath,{'withFileTypes':!![]});_0x1e78b9[_0x2dff9e(0xcd)]((_0xc167e,_0x3a215a)=>_0xc167e['name']<_0x3a215a['name']?0x1:_0x3a215a[_0x2dff9e(0x22d)]<_0xc167e[_0x2dff9e(0x22d)]?-0x1:0x0),_0x1e78b9[_0x2dff9e(0x194)](_0x481bd4=>{const _0x4d41ef=_0x2dff9e;if(!_0x481bd4[_0x4d41ef(0x13f)]()&&_0x481bd4['name']['startsWith'](_0x4d41ef(0x268))&&_0x481bd4[_0x4d41ef(0x22d)][_0x4d41ef(0xf2)](_0x4d41ef(0x1a8))){const _0x115aaf=formatDate(fs['statSync'](configbackuppath+_0x481bd4['name'])[_0x4d41ef(0x1ee)]);_0x156ee1[_0x4d41ef(0x105)]({'name':_0x481bd4['name'],'mtime':_0x115aaf});}});if(_0x51c962)io['to'](_0x51c962)[_0x2dff9e(0x15c)](_0x2dff9e(0x202),_0x156ee1);else return _0x156ee1;}async function backupConfigFiles(){const _0x2ae074=_0x5f2c03;await zipFiles(_0x2ae074(0x152));const _0x266b1a=getCleanTimeStamp();fs[_0x2ae074(0x24b)](zippath+_0x2ae074(0x24f),configbackuppath+(_0x2ae074(0x268)+_0x266b1a+'.zip'));let _0x588ed7=fs[_0x2ae074(0x25f)](configbackuppath,{'withFileTypes':!![]});_0x588ed7[_0x2ae074(0xcd)]((_0x402a6c,_0x416916)=>_0x402a6c[_0x2ae074(0x22d)]<_0x416916[_0x2ae074(0x22d)]?0x1:_0x416916[_0x2ae074(0x22d)]<_0x402a6c[_0x2ae074(0x22d)]?-0x1:0x0),_0x588ed7[_0x2ae074(0xbf)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x588ed7[_0x588ed7[_0x2ae074(0xbf)]-0x1][_0x2ae074(0x22d)]);}function rotateLogFiles(){const _0x173945=_0x5f2c03,_0x231acc=fs[_0x173945(0x254)](logspath+_0x173945(0x109)),_0x1ca1df=_0x231acc['size']/0x400;if(_0x1ca1df>0x64){let _0x557815=fs[_0x173945(0x25f)](logspath,{'withFileTypes':!![]});_0x557815[_0x173945(0xcd)]((_0x526145,_0x42554b)=>_0x526145['name']<_0x42554b['name']?0x1:_0x42554b[_0x173945(0x22d)]<_0x526145['name']?-0x1:0x0),_0x557815[_0x173945(0x194)](_0x2bfcbe=>{const _0x5dde1e=_0x173945;if(_0x2bfcbe[_0x5dde1e(0x22d)]=='output-002.log')fs[_0x5dde1e(0x24b)](logspath+_0x2bfcbe['name'],logspath+'output-003.log');if(_0x2bfcbe['name']==_0x5dde1e(0x186))fs[_0x5dde1e(0x24b)](logspath+_0x2bfcbe[_0x5dde1e(0x22d)],logspath+_0x5dde1e(0x234));_0x2bfcbe['name']==_0x5dde1e(0x109)&&(fs['copyFileSync'](logspath+_0x2bfcbe[_0x5dde1e(0x22d)],logspath+_0x5dde1e(0x186)),fs[_0x5dde1e(0x1e3)](logspath+_0x2bfcbe[_0x5dde1e(0x22d)],''));});}}async function zipFiles(_0x1f078b){const _0x47a238=_0x5f2c03;let _0x4ae7f7;if(_0x1f078b==_0x47a238(0x1bc))_0x4ae7f7=logspath;if(_0x1f078b==_0x47a238(0x167))_0x4ae7f7=configpath;if(_0x1f078b=='backup-full')_0x4ae7f7=configpath;let _0x32d9f5=fs['readdirSync'](_0x4ae7f7,{'withFileTypes':!![]});const _0x4169b5=new require('node-zip')();_0x32d9f5[_0x47a238(0x194)](_0x43f291=>{const _0x5364ed=_0x47a238;if(!_0x43f291[_0x5364ed(0x13f)]()){let _0x1ffbbd=fs[_0x5364ed(0x11a)](_0x4ae7f7+_0x43f291[_0x5364ed(0x22d)]);if(_0x1f078b=='backup'){const _0x88de9f=/^bot-[0-9]{3}-config.json$/,_0x5a0941=_0x88de9f[_0x5364ed(0x219)](_0x43f291['name']);if(_0x5a0941){const _0xe77e6b=JSON[_0x5364ed(0x1b1)](_0x1ffbbd);if(_0xe77e6b[_0x5364ed(0x245)][0x0]){_0xe77e6b['bot'][0x0][_0x5364ed(0xbe)]=_0x5364ed(0x1c9),_0xe77e6b['bot'][0x0][_0x5364ed(0x27e)]=_0x5364ed(0x1c9);if(_0xe77e6b['bot'][0x0][_0x5364ed(0xcf)])_0xe77e6b['bot'][0x0][_0x5364ed(0xcf)]=_0x5364ed(0x1c9);}_0x1ffbbd=JSON[_0x5364ed(0x275)](_0xe77e6b,null,0x2);}if(_0x43f291[_0x5364ed(0x22d)]=='bb-settings.json'){const _0x59c104=JSON[_0x5364ed(0x1b1)](_0x1ffbbd);if(_0x59c104[_0x5364ed(0xc3)][_0x5364ed(0x146)])_0x59c104[_0x5364ed(0xc3)]['loginRequired']=![];if(_0x59c104[_0x5364ed(0xc3)]['bbPassword'])_0x59c104[_0x5364ed(0xc3)][_0x5364ed(0x18f)]=_0x5364ed(0x1c9);if(_0x59c104[_0x5364ed(0xc3)]['telegramToken'])_0x59c104[_0x5364ed(0xc3)][_0x5364ed(0x196)]=_0x5364ed(0x1c9);if(_0x59c104[_0x5364ed(0xc3)][_0x5364ed(0x144)])_0x59c104['settings']['telegramChatId']=null;_0x1ffbbd=JSON[_0x5364ed(0x275)](_0x59c104,null,0x2);}if(_0x43f291[_0x5364ed(0x22d)]!=_0x5364ed(0x14c))_0x4169b5['file'](_0x43f291[_0x5364ed(0x22d)],_0x1ffbbd);}else _0x4169b5[_0x5364ed(0x20c)](_0x43f291[_0x5364ed(0x22d)],_0x1ffbbd);}});const _0x328345=_0x4169b5['generate']({'base64':![],'compression':_0x47a238(0x160)});fs[_0x47a238(0x1e3)](zippath+(_0x1f078b+_0x47a238(0x1a8)),_0x328345,_0x47a238(0x1bd));}async function unzipFile(_0x4a416a,_0x242214){const _0x104723=_0x5f2c03;fs[_0x104723(0x25f)](configpath,{'withFileTypes':!![]})['forEach'](_0x2b0fa2=>{const _0x22716f=_0x104723;if(!_0x2b0fa2[_0x22716f(0x13f)]())fs[_0x22716f(0xe4)](configpath+_0x2b0fa2['name']);});const _0x53e6c7=fs[_0x104723(0x11a)](_0x4a416a+_0x242214,'binary'),_0x221c0e=new require(_0x104723(0x26d))(_0x53e6c7,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x221c0e[_0x104723(0x25d)])[_0x104723(0x194)](_0x586080=>{const _0x3abbab=_0x104723,_0x529863=_0x221c0e[_0x3abbab(0x25d)][_0x586080];fs[_0x3abbab(0x1e3)](configpath+_0x529863['name'],_0x529863[_0x3abbab(0x17c)]);}),fs[_0x104723(0x25f)](temppath,{'withFileTypes':!![]})[_0x104723(0x194)](_0x6c3a53=>{const _0x19ecbb=_0x104723;if(!_0x6c3a53[_0x19ecbb(0x13f)]())fs[_0x19ecbb(0xe4)](temppath+_0x6c3a53[_0x19ecbb(0x22d)]);}),logger[_0x104723(0x1fa)](_0x104723(0x21d)),process[_0x104723(0x20b)]({'restore':!![]},_0x58de32=>{});}async function getPublicIp(){const _0x27f6ac=_0x5f2c03;try{const _0x204a36=await axios[_0x27f6ac(0x243)](_0x27f6ac(0x25a));publicip=_0x204a36[_0x27f6ac(0x15f)]['ip'];}catch(_0x2a0d9b){}}async function triggerAnalytics(){const _0x940ade=_0x5f2c03;if(!publicip)await getPublicIp();const _0x13bcd4=getBotsWithMode();let _0x22e15f=0x0;_0x13bcd4[_0x940ade(0x194)](_0x1d2138=>{const _0x145a4d=_0x940ade;if(_0x1d2138[_0x145a4d(0x1c7)]===_0x145a4d(0x138))_0x22e15f++;});const _0x3ce429=getBotExchanges();mixpanel[_0x940ade(0x1cd)](_0x940ade(0x121),{'distinct_id':settings[_0x940ade(0x278)],'ip':publicip,'version':serverversion,'numbots':_0x13bcd4[_0x940ade(0xbf)],'numbotsenabled':_0x22e15f,'exchanges':_0x3ce429});}async function getMessages(){const _0x45d7a2=_0x5f2c03,_0x788d25='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x136810=new GraphQLClient(_0x788d25),_0xe9cf4e={'authorization':_0x45d7a2(0x230)},_0x2f79e8=serverversion['split']('.'),_0x25c62a=_0x2f79e8[0x0]+'.'+_0x2f79e8[0x1],_0xbc5e46=Math[_0x45d7a2(0x1d9)](settings['lastmsgtelegram'],settings[_0x45d7a2(0xfc)]),_0x3ede52={'last':parseInt(_0xbc5e46),'bbm':_0x25c62a},_0x44e946=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x47a322;try{_0x47a322=await _0x136810[_0x45d7a2(0x204)](_0x44e946,_0x3ede52,_0xe9cf4e);}catch(_0x55f912){}if(_0x47a322&&_0x47a322[_0x45d7a2(0x190)]){let _0x1b22c7=settings[_0x45d7a2(0x24e)];newMessages=[];for(const _0x1c5029 of _0x47a322[_0x45d7a2(0x190)]){newMessages[_0x45d7a2(0x105)](_0x1c5029);if(_0x1c5029[_0x45d7a2(0xe6)])updateSetting(_0x45d7a2(0xc0),_0x1c5029[_0x45d7a2(0xe6)]);let _0x3f5fa2=_0x1c5029[_0x45d7a2(0xe6)]?serverversion>=_0x1c5029[_0x45d7a2(0xe6)]:![];if(!_0x3f5fa2&&_0x1c5029['number']>_0x1b22c7){if(_0x1c5029['bbvReceive']===_0x45d7a2(0x16d)||serverversion[_0x45d7a2(0x122)](_0x1c5029['bbvReceive'])){let _0x14937f=''+_0x1c5029[_0x45d7a2(0x226)]+'\x0a\x0a'+_0x1c5029[_0x45d7a2(0x206)];const _0x14a149=await sendTelegramMsg(toTelegramMarkdown(_0x14937f),'Markdown');if(_0x14a149)_0x1b22c7=_0x1c5029['number'];}}}updateAvailable=isNewerVersion(settings[_0x45d7a2(0xc0)],serverversion),updateSetting('lastmsgtelegram',_0x1b22c7),emitMessages();}}function emitMessages(){const _0x447702=_0x5f2c03,_0xc1abeb=settings[_0x447702(0xfc)];let _0x2b7681=[];newMessages[_0x447702(0x194)](_0x1f0d80=>{const _0x4dc188=_0x447702;_0x1f0d80['number']>_0xc1abeb&&_0x2b7681[_0x4dc188(0x105)](_0x1f0d80);}),_0x2b7681[_0x447702(0xbf)]>0x0&&getAllClients()[_0x447702(0x194)](_0x3acd20=>{getSocket(_0x3acd20['id'])['emit']('message',_0x2b7681);});}function confirmMessage(_0x57b8ff){const _0x3b9b94=_0x5f2c03;updateSetting(_0x3b9b94(0xfc),Number(_0x57b8ff));}function isNewerVersion(_0x550c8a,_0x50f1ce){const _0x41defb=_0x5f2c03,_0x43bc00=_0x50f1ce[_0x41defb(0xd2)]('.'),_0x40f030=_0x550c8a[_0x41defb(0xd2)]('.');for(var _0x10e476=0x0;_0x10e476<_0x40f030[_0x41defb(0xbf)];_0x10e476++){const _0x28f1e9=~~_0x40f030[_0x10e476],_0xb4f022=~~_0x43bc00[_0x10e476];if(_0x28f1e9>_0xb4f022)return!![];if(_0x28f1e9<_0xb4f022)return![];}return![];}function toTelegramMarkdown(_0x3080d0){const _0x51dbb7=_0x5f2c03,_0x16b82e=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5a6d94=/\*{2}(.+?)\*{2}/gim;return _0x3080d0=_0x3080d0[_0x51dbb7(0x257)](_0x16b82e,_0x51dbb7(0x253))[_0x51dbb7(0x257)](_0x5a6d94,'*$1*'),_0x3080d0;}async function validateConfigFile(){const _0x48b086=_0x5f2c03,_0x1f28f3=dbConfig[_0x48b086(0x243)](_0x48b086(0x240))[_0x48b086(0x192)](_0x48b086(0x1ba))[_0x48b086(0x28a)]()||[];if(_0x1f28f3['length']==0x0){let _0x2c4077=0x0,_0x84284e=[];const _0x38e876=/^bot-([0-9]{3})-config.json$/,_0x5dc731=fs[_0x48b086(0x25f)](configpath);_0x5dc731[_0x48b086(0x194)](_0x425a5e=>{const _0x5b6947=_0x48b086,_0x5d1084=_0x38e876['exec'](_0x425a5e);if(_0x5d1084){const _0x49db8a=_0x5d1084[0x1];let _0x44a61d=getBotAttributes(_0x49db8a);_0x84284e[_0x5b6947(0x105)]({'botID':_0x49db8a,'botname':_0x44a61d['botname'],'status':_0x5b6947(0xd5),'live':_0x5b6947(0x22b)}),_0x2c4077++;}}),_0x2c4077!=0x0&&(dbConfig[_0x48b086(0x243)]('bots')['assign'](_0x84284e)[_0x48b086(0x214)](),config=_0x84284e,restoredConfigFile=_0x2c4077);}}async function restoreConfigNotify(_0x134b8a){const _0x570886=_0x5f2c03;let _0x5eaa1d;if(restoredConfigFile==0x1)_0x5eaa1d=_0x570886(0x125);else _0x5eaa1d=_0x570886(0x15b);if(_0x134b8a)io['to'](_0x570886(0x1e5))[_0x570886(0x15c)]('notification',_0x5eaa1d);else{logger[_0x570886(0x191)](_0x570886(0x1b0)),logger[_0x570886(0x191)](_0x5eaa1d),logger[_0x570886(0x191)](_0x570886(0x1b0)),logger['simple']('');if(tgBot&&settings[_0x570886(0x144)]&&settings[_0x570886(0x26e)]!=_0x570886(0x110))tgBot[_0x570886(0xba)](settings[_0x570886(0x144)],'Bot\x20Mgr\x20>\x20'+_0x5eaa1d)[_0x570886(0x20e)](_0xff1d7d=>{telegramError(_0xff1d7d);});}}function validateCredentials(_0x1f65ea,_0x592e42){const _0x48c643=_0x5f2c03;if(_0x1f65ea['username']==settings[_0x48c643(0x1ec)]&&bcrypt[_0x48c643(0xb7)](_0x1f65ea[_0x48c643(0x154)],settings['bbPassword'])){if(settings[_0x48c643(0x207)])return{'allow':![],'reason':_0x48c643(0x1c6),'token':null};else{const _0x108011=generateLoginToken(_0x592e42);return{'allow':!![],'reason':_0x48c643(0x166),'token':_0x108011};}}else return{'allow':![],'reason':_0x48c643(0x148),'token':null};}function refreshToken(_0x2a6f85){const _0x5d7421=generateLoginToken(_0x2a6f85);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5d7421};}function validateAccess(_0xac57f3,_0x555ca3,_0x4b4c14){const _0xbe6654=_0x5f2c03,_0x2cb52a=_0x4b4c14?_0x4b4c14:devices[_0x555ca3]['ip'];let _0x509b8c;const _0x25a6bd=_0x3fdd40=>{const _0x37337e=_0xb091;if(settings['loginRequired']){if(settings[_0x37337e(0x207)]){if(telegram2FaApproved(_0x555ca3)){const _0xc9e33c=generateLoginToken(_0x555ca3);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0xc9e33c};}else return{'allow':![],'reason':_0x37337e(0xc4),'token':null};}else return _0x509b8c=validToken(_0x3fdd40,_0x555ca3),_0x509b8c['hasOwnProperty']('success')?{'allow':!![],'reason':_0x37337e(0x1fb),'token':_0x3fdd40}:{'allow':![],'reason':_0x37337e(0xc4),'token':null};}else return{'allow':!![],'reason':_0x37337e(0xd4),'token':null};};if(settings[_0xbe6654(0x100)]){let _0x1f28e9=[...settings[_0xbe6654(0x1cf)],'::1',_0xbe6654(0x118),_0xbe6654(0xdd)];if(_0x1f28e9[_0xbe6654(0x258)](_0x2cb52a))return _0x25a6bd(_0xac57f3);else{_0x509b8c=validToken(_0xac57f3,_0x555ca3);if(_0x509b8c[_0xbe6654(0x27d)](_0xbe6654(0x21e)))return _0x25a6bd(_0xac57f3);else{if(telegramIpApproved(_0x555ca3)){const _0x30c6b3=generateToken(_0x555ca3);return _0x509b8c=_0x25a6bd(_0xac57f3),_0x509b8c['allow']?{'allow':!![],'reason':_0xbe6654(0x261),'token':_0x30c6b3}:_0x509b8c;}else return settings[_0xbe6654(0x23e)]?{'allow':![],'reason':_0xbe6654(0x1f1),'token':null}:{'allow':![],'reason':_0xbe6654(0x19a),'token':null};}}}else return _0x25a6bd(_0xac57f3);}function timelyDecrypt(_0x2354f5,_0x1873e0=!![]){const _0x3ad504=_0x5f2c03;if(_0x2354f5)try{const _0x1d966d=crypt[_0x3ad504(0x27c)](secure['privateKey'],_0x2354f5)[_0x3ad504(0x206)],_0x53eb30=_0x1d966d[_0x3ad504(0xd2)]('@')[0x0],_0x26165a=_0x1d966d['split']('@')[0x1],_0x5aef4c=new Date()['getTime']();if(_0x1873e0){if(_0x5aef4c-_0x26165a<maxSecretAge*0x3e8)return _0x53eb30;else return![];}else return _0x53eb30;}catch(_0x323fa4){return![];}else return![];}const validToken=(_0x4135,_0x3f4379)=>{const _0x3c1fea=_0x5f2c03,_0x8265aa=devices[_0x3f4379]['ip'];if(!_0x4135)return{'error':_0x3c1fea(0x210)};for(let _0x44bcd8 of blacklist){if(_0x44bcd8[_0x3c1fea(0x161)]==_0x4135)return{'error':_0x3c1fea(0x1f5)};}let _0x448cd4;try{_0x448cd4=jwt['verify'](_0x4135,secure[_0x3c1fea(0xf4)]+_0x3f4379);}catch{return{'error':_0x3c1fea(0x1d7)};}if(!_0x448cd4['hasOwnProperty'](_0x3c1fea(0x140))&&!_0x448cd4['hasOwnProperty'](_0x3c1fea(0x271))||!_0x448cd4[_0x3c1fea(0x27d)](_0x3c1fea(0x127)))return{'error':_0x3c1fea(0xfa)};if(!_0x448cd4[_0x3c1fea(0x27d)](_0x3c1fea(0x271))&&_0x448cd4[_0x3c1fea(0x27d)](_0x3c1fea(0x140))){const {clientip:_0x242d73}=_0x448cd4;return _0x8265aa==_0x242d73?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x448cd4[_0x3c1fea(0x27d)](_0x3c1fea(0x271))&&_0x448cd4[_0x3c1fea(0x27d)](_0x3c1fea(0x140))){const {username:_0x4f8410,clientip:_0xad3616}=_0x448cd4;return settings[_0x3c1fea(0x1ec)]==_0x4f8410&&_0x8265aa==_0xad3616?{'success':_0x3c1fea(0x1e0)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3ab891=>{const _0x5ed1fd=_0x5f2c03;if(_0x3ab891){const _0x369e80=devices[_0x3ab891]['ip'];return jwt['sign']({'username':settings[_0x5ed1fd(0x1ec)],'clientip':_0x369e80},secure['secret']+_0x3ab891,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x28d788=>{const _0x525fc6=_0x5f2c03;if(_0x28d788){const _0x2425b1=devices[_0x28d788]['ip'];return jwt[_0x525fc6(0x1a5)]({'clientip':_0x2425b1},secure[_0x525fc6(0xf4)]+_0x28d788,{'expiresIn':devices[_0x28d788][_0x525fc6(0x20a)][_0x525fc6(0x1d3)]*0x3c});}else return![];},telegramIpApproved=_0x99342a=>{const _0x3699f9=_0x5f2c03;let _0x32acf5=![];return devices[_0x99342a][_0x3699f9(0x20a)]&&devices[_0x99342a][_0x3699f9(0x20a)][_0x3699f9(0x1d3)]!=_0x3699f9(0x1df)&&(_0x32acf5=devices[_0x99342a][_0x3699f9(0x20a)][_0x3699f9(0x140)]==devices[_0x99342a]['ip']&&new Date()[_0x3699f9(0x1fe)]()-devices[_0x99342a][_0x3699f9(0x20a)][_0x3699f9(0x220)]<devices[_0x99342a][_0x3699f9(0x20a)][_0x3699f9(0x1d3)]*0x3c*0x3e8),_0x32acf5;},telegram2FaApproved=_0x55276a=>{const _0x572391=_0x5f2c03;let _0x335282=![];return devices[_0x55276a][_0x572391(0x227)]&&devices[_0x55276a][_0x572391(0x227)]['expiry']!=_0x572391(0x1df)&&(_0x335282=devices[_0x55276a][_0x572391(0x227)][_0x572391(0x140)]==devices[_0x55276a]['ip']&&new Date()[_0x572391(0x1fe)]()-devices[_0x55276a][_0x572391(0x227)][_0x572391(0x220)]<devices[_0x55276a][_0x572391(0x227)]['expiry']*0x3c*0x3e8),_0x335282;},normalizeIP=_0x22f151=>{const _0x46cc4b=_0x5f2c03;let _0x1ceffb=null,_0x89dc6b=null;if(ipaddr[_0x46cc4b(0x217)](_0x22f151)){const _0x443928=ipaddr[_0x46cc4b(0x1b1)](_0x22f151);_0x443928['kind']()===_0x46cc4b(0x15a)?(_0x443928['isIPv4MappedAddress']()&&(_0x1ceffb=_0x443928['toIPv4Address']()['toString']()),_0x89dc6b=_0x443928[_0x46cc4b(0x276)]()):(_0x1ceffb=_0x443928[_0x46cc4b(0x276)](),_0x89dc6b=_0x443928['toIPv4MappedAddress']()[_0x46cc4b(0x276)]());}return{'show':_0x1ceffb?_0x1ceffb:_0x89dc6b,'store':_0x89dc6b};};function formatDate(_0x32b969){const _0x2d1586=_0x5f2c03;return _0x32b969[_0x2d1586(0x262)]()+'/'+(_0x32b969[_0x2d1586(0x1b6)]()+0x1)[_0x2d1586(0x276)]()[_0x2d1586(0x26c)](0x2,'0')+'/'+_0x32b969[_0x2d1586(0x19f)]()[_0x2d1586(0x276)]()[_0x2d1586(0x26c)](0x2,'0')+'\x20'+_0x32b969[_0x2d1586(0x14f)]()[_0x2d1586(0x276)]()[_0x2d1586(0x26c)](0x2,'0')+':'+_0x32b969['getMinutes']()[_0x2d1586(0x276)]()[_0x2d1586(0x26c)](0x2,'0')+':'+_0x32b969['getSeconds']()[_0x2d1586(0x276)]()[_0x2d1586(0x26c)](0x2,'0');}function sleep(_0x234a3e){return new Promise(_0x540136=>setTimeout(_0x540136,_0x234a3e));}