const _0x2cd832=_0x366b;(function(_0x2497b4,_0x1fd5d5){const _0x44ed1e=_0x366b,_0x1c08b8=_0x2497b4();while(!![]){try{const _0x51a9c8=-parseInt(_0x44ed1e(0x2d2))/0x1*(-parseInt(_0x44ed1e(0x299))/0x2)+parseInt(_0x44ed1e(0x364))/0x3*(parseInt(_0x44ed1e(0x26c))/0x4)+parseInt(_0x44ed1e(0x27b))/0x5*(-parseInt(_0x44ed1e(0x2a8))/0x6)+-parseInt(_0x44ed1e(0x382))/0x7+parseInt(_0x44ed1e(0x330))/0x8*(-parseInt(_0x44ed1e(0x349))/0x9)+-parseInt(_0x44ed1e(0x2be))/0xa+parseInt(_0x44ed1e(0x378))/0xb;if(_0x51a9c8===_0x1fd5d5)break;else _0x1c08b8['push'](_0x1c08b8['shift']());}catch(_0x386f89){_0x1c08b8['push'](_0x1c08b8['shift']());}}}(_0x2a6a,0xece61));const _0x7c9ba7=function(){let _0x44b9b4=!![];return function(_0x3ee230,_0x4f7176){const _0x152b74=_0x44b9b4?function(){if(_0x4f7176){const _0x2533b9=_0x4f7176['apply'](_0x3ee230,arguments);return _0x4f7176=null,_0x2533b9;}}:function(){};return _0x44b9b4=![],_0x152b74;};}(),_0x23ba77=_0x7c9ba7(this,function(){const _0x26fdaa=_0x366b;return _0x23ba77[_0x26fdaa(0x2d1)]()[_0x26fdaa(0x385)](_0x26fdaa(0x376))[_0x26fdaa(0x2d1)]()[_0x26fdaa(0x39b)](_0x23ba77)[_0x26fdaa(0x385)](_0x26fdaa(0x376));});_0x23ba77();'use strict';process[_0x2cd832(0x2b1)][_0x2cd832(0x2f7)]=0x1;const childProcess=require(_0x2cd832(0x256)),fs=require('fs'),fns=require(_0x2cd832(0x1c8)),low=require(_0x2cd832(0x1da)),FileSync=require(_0x2cd832(0x2d7)),path=require('path'),crypto=require('crypto'),Crypt=require(_0x2cd832(0x2ac))[_0x2cd832(0x239)],RSA=require(_0x2cd832(0x2ac))[_0x2cd832(0x1cb)],bcrypt=require(_0x2cd832(0x206)),jwt=require(_0x2cd832(0x222)),ipaddr=require('ipaddr.js'),argv=require(_0x2cd832(0x314))(process['argv'][_0x2cd832(0x38e)](0x2))['argv'],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x2cd832(0x29a)),Mixpanel=require('mixpanel'),axios=require(_0x2cd832(0x2ef)),{GraphQLClient,gql}=require(_0x2cd832(0x21d)),util=require(_0x2cd832(0x2a5)),fileUpload=require(_0x2cd832(0x1b1)),{networkInterfaces}=require('os'),PORT=argv[_0x2cd832(0x3b7)]||_0x2cd832(0x393),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x2cd832(0x260)](_0x2cd832(0x1f8)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x2cd832(0x3b5)]||null,userID=argv[_0x2cd832(0x31f)]||'',debugging=argv['d']||![],nodeversion=process[_0x2cd832(0x201)][_0x2cd832(0x27a)];let bbpath='bb/',bbpath2='';function _0x366b(_0x5430b6,_0x482417){const _0x2a8bd4=_0x2a6a();return _0x366b=function(_0x23ba77,_0x7c9ba7){_0x23ba77=_0x23ba77-0x1b0;let _0x2a6a81=_0x2a8bd4[_0x23ba77];return _0x2a6a81;},_0x366b(_0x5430b6,_0x482417);}const botfile=_0x2cd832(0x2af),configfile=_0x2cd832(0x2ee),settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x2cd832(0x319))[_0x2cd832(0x37c)]||_0x2cd832(0x2cc),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2cd832(0x1ce)),configpath=userID?bbpath+_0x2cd832(0x1c1)+userID+'/':bbpath+_0x2cd832(0x1c1),configbackuppath=configpath+_0x2cd832(0x270),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x2cd832(0x1d4),zippath=userID?bbpath+_0x2cd832(0x1f6)+userID+'/':bbpath+_0x2cd832(0x1f6),loggerfile=fs[_0x2cd832(0x297)](logspath+_0x2cd832(0x1f9),{'flags':'a'}),temppath=userID?bbpath+_0x2cd832(0x22f)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x2cd832(0x28b)](configpath);!fs[_0x2cd832(0x3af)](configbackuppath)&&fs[_0x2cd832(0x28b)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x2cd832(0x28b)](logspath);!fs[_0x2cd832(0x3af)](zippath)&&fs[_0x2cd832(0x28b)](zippath);!fs[_0x2cd832(0x3af)](temppath)&&fs[_0x2cd832(0x28b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x2cd832(0x255)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2cd832(0x32c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x2cd832(0x255)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x2cd832(0x20e)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2cd832(0x1f4)](_0x2cd832(0x311),{'host':_0x2cd832(0x2f0)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2cd832(0x2fe)]&&(settings['telegramToken']!=''&&settings[_0x2cd832(0x2fe)]!=_0x2cd832(0x1ea))&&settings[_0x2cd832(0x33a)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x3d1be3,_0x7c76e7)=>{const _0x34d03b=_0x2cd832,_0x3807d5=/#[A-Z]{3}#/g;if(typeof _0x3d1be3==_0x34d03b(0x2cb)){!_0x7c76e7?_0x3d1be3=_0x3d1be3[_0x34d03b(0x2b5)](_0x3807d5,''):(_0x3d1be3=_0x3d1be3[_0x34d03b(0x2b5)](/#BLU#/g,_0x34d03b(0x1ed)),_0x3d1be3=_0x3d1be3['replace'](/#RED#/g,_0x34d03b(0x2eb)),_0x3d1be3=_0x3d1be3[_0x34d03b(0x2b5)](/#YEL#/g,_0x34d03b(0x248)),_0x3d1be3=_0x3d1be3['replace'](/#MAG#/g,_0x34d03b(0x343)),_0x3d1be3=_0x3d1be3[_0x34d03b(0x2b5)](/#CYA#/g,'\x1b[36m'),_0x3d1be3=_0x3d1be3[_0x34d03b(0x2b5)](/#RES#/g,'\x1b[0m'));;}return _0x3d1be3;},logger={'screen':_0xd47fec=>{console['log'](parseColor(_0xd47fec,!![]));},'simple':_0x19912c=>{const _0x380fa3=_0x2cd832;console[_0x380fa3(0x260)](parseColor(_0x19912c,!![])),loggerfile[_0x380fa3(0x255)](util['format'](parseColor(_0x19912c,![]))+'\x0a');},'full':async _0x5169b3=>{const _0x1bf168=_0x2cd832,_0x1a65c3=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5169b3;console[_0x1bf168(0x260)](parseColor(_0x1a65c3,!![])),loggerfile[_0x1bf168(0x255)](util[_0x1bf168(0x356)](parseColor(_0x1a65c3,![]))+'\x0a');if(tgBot&&settings[_0x1bf168(0x25f)]&&settings[_0x1bf168(0x33b)]!=_0x1bf168(0x338))await sendTelegram(settings[_0x1bf168(0x25f)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x5169b3,![]));},'debug':async(_0x42d078,_0x18fdb4='')=>{const _0x37e304=_0x2cd832,_0x3a826a=getTimeStamp()+_0x37e304(0x34f)+_0x42d078;if(debugging)console[_0x37e304(0x260)](parseColor(_0x3a826a,!![]));loggerfile[_0x37e304(0x255)](util['format'](parseColor(_0x3a826a,![]))+'\x0a');if(_0x18fdb4){if(debugging)console['log'](_0x18fdb4);loggerfile[_0x37e304(0x255)](util[_0x37e304(0x356)](_0x18fdb4)+'\x0a');}}};let terminating=![];process['on'](_0x2cd832(0x2ff),function(_0x2a7c2d){const _0x4875b0=_0x2cd832;logger[_0x4875b0(0x1d9)](_0x2a7c2d);}),process['on']('exit',()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x2cd832(0x2ed),()=>{const _0x1c0bf0=_0x2cd832;stopAllBots(),process[_0x1c0bf0(0x282)](0x0);}),process['on'](_0x2cd832(0x2ce),()=>{const _0x30c34f=_0x2cd832;stopAllBots(),process[_0x30c34f(0x282)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2cd832(0x319))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2cd832(0x2ba)),app=express(),http=require(_0x2cd832(0x23e))[_0x2cd832(0x290)](app);app[_0x2cd832(0x2f1)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x19c47f,_0x50a30a)=>{const _0x489c53=_0x2cd832,_0x2e6213=_0x19c47f[_0x489c53(0x27c)][_0x489c53(0x1c0)],_0x2e2af8=getClientsWithBotID(_0x489c53(0x1cf)),_0x12564c=_0x19c47f[_0x489c53(0x24e)]['uuid'],_0x4b3299=timelyDecrypt(_0x12564c,![]),_0x59d93d=_0x2e2af8[_0x489c53(0x2bd)](_0x170dab=>_0x170dab[_0x489c53(0x308)]==_0x4b3299);if(_0x59d93d){const _0x4f3c20=normalizeIP(_0x19c47f[_0x489c53(0x1ef)][_0x489c53(0x1ec)])['store'],_0x20bbee=_0x19c47f['headers']['tkn'];if(validateAccess(_0x20bbee,_0x4b3299,_0x4f3c20)[_0x489c53(0x2ca)])_0x2e6213=='backup'&&await backupConfigFiles(),await zipFiles(_0x2e6213),_0x50a30a['download'](zippath+(_0x2e6213+_0x489c53(0x359)),_0x5de706=>{const _0x13fb45=_0x489c53;_0x5de706&&(logger[_0x13fb45(0x2d8)](_0x13fb45(0x1e7)+_0x2e6213),logger[_0x13fb45(0x1d9)](_0x5de706));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2e6213+'\x20(1)');}else logger[_0x489c53(0x2d8)](_0x489c53(0x1d5)+_0x2e6213+_0x489c53(0x2df));}),app[_0x2cd832(0x390)](_0x2cd832(0x296),async(_0x50bae2,_0x23ea98)=>{const _0x4ba6e5=_0x2cd832,_0x22477d=getClientsWithBotID(_0x4ba6e5(0x1cf)),_0x9d8126=_0x50bae2[_0x4ba6e5(0x24e)]['uuid'],_0x7aa37b=timelyDecrypt(_0x9d8126,![]),_0x404535=_0x22477d[_0x4ba6e5(0x2bd)](_0xbf279=>_0xbf279['uuid']==_0x7aa37b);logger[_0x4ba6e5(0x3ba)](_0x4ba6e5(0x20d));if(_0x404535){const _0x4fdd12=normalizeIP(_0x50bae2['socket'][_0x4ba6e5(0x1ec)])[_0x4ba6e5(0x2a3)],_0x60f022=_0x50bae2[_0x4ba6e5(0x24e)]['tkn'];if(validateAccess(_0x60f022,_0x7aa37b,_0x4fdd12)[_0x4ba6e5(0x2ca)]){if(_0x50bae2[_0x4ba6e5(0x341)]){const _0x1993c4=_0x50bae2[_0x4ba6e5(0x341)]['backupfile'];await _0x1993c4['mv'](temppath+_0x1993c4[_0x4ba6e5(0x2bc)]),_0x23ea98[_0x4ba6e5(0x303)]({'status':!![],'message':_0x4ba6e5(0x1bb)});const _0x19707a=getBotsWithMode();_0x19707a[_0x4ba6e5(0x1b9)]>0x0?confirmRestore(temppath,_0x1993c4[_0x4ba6e5(0x2bc)]):unzipFile(temppath,_0x1993c4[_0x4ba6e5(0x2bc)]);}}else logger[_0x4ba6e5(0x2d8)](_0x4ba6e5(0x24c));}else logger[_0x4ba6e5(0x2d8)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x2cd832(0x2f1)](express[_0x2cd832(0x209)](path[_0x2cd832(0x369)](__dirname,bbpath2,_0x2cd832(0x24a)))),app[_0x2cd832(0x2f1)](express[_0x2cd832(0x209)](path[_0x2cd832(0x369)](__dirname,bbpath2,_0x2cd832(0x3a6)))),app[_0x2cd832(0x223)]('/',function(_0x233e46,_0x53ebe0){const _0x593aac=_0x2cd832;_0x53ebe0['sendFile'](path[_0x593aac(0x369)](__dirname,bbpath2,_0x593aac(0x24a),_0x593aac(0x3b1)));}),app[_0x2cd832(0x223)]('/:bot',function(_0x1c42af,_0x40477a){const _0x1046b9=_0x2cd832;_0x40477a['sendFile'](path['join'](__dirname,bbpath2,'build',_0x1046b9(0x3b1)));}),app[_0x2cd832(0x223)](_0x2cd832(0x36b),(_0x3dbfd0,_0x22c083)=>{const _0x5b1b71=_0x2cd832;_0x22c083['sendFile'](path['join'](__dirname,bbpath2,_0x5b1b71(0x3a6),_0x5b1b71(0x3b1)));}),app[_0x2cd832(0x223)](_0x2cd832(0x1d1),(_0x558c26,_0x36fe1b)=>{const _0x119823=_0x2cd832;_0x36fe1b[_0x119823(0x28c)](path['join'](__dirname,bbpath2,_0x119823(0x3a6),_0x119823(0x3b1)));}),app[_0x2cd832(0x223)](_0x2cd832(0x1d8),(_0x46a455,_0x5d6640)=>{const _0x528a62=_0x2cd832;_0x5d6640[_0x528a62(0x28c)](path['join'](__dirname,bbpath2,_0x528a62(0x3a6),_0x528a62(0x3b1)));}),app[_0x2cd832(0x223)](_0x2cd832(0x327),(_0x4c1eb8,_0x2c8374)=>{const _0x3a8f19=_0x2cd832;_0x2c8374['sendFile'](path[_0x3a8f19(0x369)](__dirname,bbpath2,_0x3a8f19(0x3a6),_0x3a8f19(0x3b1)));}),app[_0x2cd832(0x223)](_0x2cd832(0x3b2),(_0x3fb832,_0x1befa6)=>{const _0x437059=_0x2cd832;_0x1befa6['sendFile'](path['join'](__dirname,bbpath2,'build',_0x437059(0x3b1)));}),app[_0x2cd832(0x223)]('/:bot/support',(_0x326a67,_0x319b5e)=>{const _0x2e883a=_0x2cd832;_0x319b5e['sendFile'](path['join'](__dirname,bbpath2,_0x2e883a(0x3a6),_0x2e883a(0x3b1)));});if(HOST)http[_0x2cd832(0x3aa)](PORT,HOST);else http[_0x2cd832(0x3aa)](PORT);const io=require(_0x2cd832(0x1de))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5e913f=_0x2cd832;let _0x24e56f=_0x5e913f(0x3b4);const _0x541755=networkInterfaces(),_0x5845ce={};for(const _0x528eb6 of Object[_0x5e913f(0x1fa)](_0x541755)){for(const _0x547902 of _0x541755[_0x528eb6]){if((_0x547902[_0x5e913f(0x1e5)]==_0x5e913f(0x353)||_0x547902[_0x5e913f(0x1e5)]==0x4)&&!_0x547902[_0x5e913f(0x286)]){const _0x45a7ec=ipaddr[_0x5e913f(0x2e9)](_0x547902[_0x5e913f(0x26d)])[_0x5e913f(0x2cd)]();_0x45a7ec!=_0x5e913f(0x2e3)&&(!_0x5845ce[_0x528eb6]&&(_0x5845ce[_0x528eb6]=[]),_0x5845ce[_0x528eb6][_0x5e913f(0x3a3)](_0x547902[_0x5e913f(0x26d)]),_0x24e56f=_0x547902[_0x5e913f(0x26d)]);}}}return{'serverip':_0x24e56f,'netinterfaces':_0x5845ce};}async function startServer(){const _0x3564e0=_0x2cd832,{serverip:_0x3f89c6,netinterfaces:_0x211b0d}=getServerIP();logger[_0x3564e0(0x1d9)](''),logger[_0x3564e0(0x1d9)](_0x3564e0(0x336)),await logger[_0x3564e0(0x2d8)](_0x3564e0(0x215)+serverversion+_0x3564e0(0x22d)+(environment==_0x3564e0(0x25c)?_0x3564e0(0x370):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x3564e0(0x289)+_0x3f89c6+':'+PORT+_0x3564e0(0x323))),logger['simple']('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x3ca6a7 of config){const _0x30949c=_0x3ca6a7[_0x3564e0(0x245)]==_0x3564e0(0x2e5)?'a':'m';if(_0x3ca6a7[_0x3564e0(0x3b8)]==_0x3564e0(0x33c)||_0x3ca6a7['status']=='new')await logger[_0x3564e0(0x2d8)]('Starting\x20('+_0x30949c+_0x3564e0(0x252)+_0x3ca6a7[_0x3564e0(0x1e4)]+'\x20|\x20'+_0x3ca6a7[_0x3564e0(0x309)]),startBot([_0x3ca6a7[_0x3564e0(0x1e4)],userID],{'cwd':bbpath},function(_0x355fed){const _0x542d77=_0x3564e0;if(_0x355fed)logger[_0x542d77(0x2d8)](_0x355fed);});else(_0x3ca6a7[_0x3564e0(0x3b8)]=='disabled'||_0x3ca6a7['status']=='new-disabled')&&await logger['full'](_0x3564e0(0x2ae)+_0x30949c+_0x3564e0(0x1b8)+_0x3ca6a7[_0x3564e0(0x1e4)]+_0x3564e0(0x25e)+_0x3ca6a7[_0x3564e0(0x309)]);}else!newBot&&logger[_0x3564e0(0x1d9)](_0x3564e0(0x1cd));if(newBot)addBot();logger['simple'](_0x3564e0(0x336)),logger[_0x3564e0(0x1d9)](''),await logger[_0x3564e0(0x3ba)](_0x3564e0(0x21e)+nodeversion),await logger[_0x3564e0(0x3ba)](_0x3564e0(0x294),_0x211b0d);}function startSocket(){const _0x11cf5e=_0x2cd832;io['on'](_0x11cf5e(0x1e8),_0xd2557d=>{const _0x4f8393=_0x11cf5e;let _0x3a76c3,_0x26ec74,_0x518bff,_0x19af36,_0x1c00b2;const _0x1954a6=_0xd2557d[_0x4f8393(0x306)]['headers'][_0x4f8393(0x26b)];_0x26ec74=_0x1954a6[_0x4f8393(0x1fe)](/bot[0-9]{3}/);if(_0x26ec74)_0x518bff=_0x26ec74[0x0][_0x4f8393(0x1fe)](/[0-9]{3}/);if(_0x518bff)_0x3a76c3=_0x518bff[0x0];else _0x3a76c3=_0x4f8393(0x1cf);const _0x4b04d4=_0xd2557d[_0x4f8393(0x306)][_0x4f8393(0x325)][_0x4f8393(0x2d0)];if(!_0x4b04d4)_0xd2557d['emit'](_0x4f8393(0x3b8),{'publicKey':secure[_0x4f8393(0x202)]});else{_0x19af36=timelyDecrypt(_0x4b04d4,![]);if(!_0x19af36)_0xd2557d[_0x4f8393(0x2b6)](_0x4f8393(0x3b8),{'publicKey':secure[_0x4f8393(0x202)]});else{_0x1c00b2=normalizeIP(_0xd2557d[_0x4f8393(0x283)][_0x4f8393(0x1ec)])['store'];if(!devices[_0x19af36])devices[_0x19af36]={'uuid':_0x19af36,'access':{'token':null}};devices[_0x19af36]['ip']=_0x1c00b2;const _0x248fd5=addClient(_0xd2557d['id'],_0x19af36,_0x3a76c3);setAccess(_0x248fd5),emitMessages(),_0xd2557d['on'](_0x4f8393(0x375),_0x2d3c61=>{const _0x17efbc=_0x4f8393,_0x13c79b=timelyDecrypt(_0x2d3c61[_0x17efbc(0x1b7)]);if(_0x13c79b){_0x2d3c61={'username':_0x2d3c61[_0x17efbc(0x2a2)],'password':_0x13c79b},devices[_0x19af36][_0x17efbc(0x329)]=validateCredentials(_0x2d3c61,_0x19af36);if(devices[_0x19af36][_0x17efbc(0x329)][_0x17efbc(0x2ca)]==![]&&devices[_0x19af36]['access'][_0x17efbc(0x1c3)]=='2FA\x20login\x20required')_0xd2557d[_0x17efbc(0x2b6)](_0x17efbc(0x3b8),{'access':devices[_0x19af36][_0x17efbc(0x329)]}),loginAccess2FA(_0x19af36,_0x1c00b2);else{if(devices[_0x19af36][_0x17efbc(0x329)][_0x17efbc(0x2ca)]==![]&&devices[_0x19af36][_0x17efbc(0x329)][_0x17efbc(0x1c3)]==_0x17efbc(0x1ee))_0xd2557d[_0x17efbc(0x2b6)]('status',{'access':devices[_0x19af36][_0x17efbc(0x329)]});else devices[_0x19af36][_0x17efbc(0x329)][_0x17efbc(0x2ca)]&&devices[_0x19af36][_0x17efbc(0x329)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x19af36)['forEach'](_0x4a68ef=>{setAccess(_0x4a68ef);}),logger[_0x17efbc(0x3ba)](_0x17efbc(0x33f)+_0x19af36[_0x17efbc(0x38e)](-0x8)),setTokenRefresh(_0x19af36),setSessionTimeout('login',_0x19af36));}}else logger[_0x17efbc(0x2d8)](_0x17efbc(0x1d3));}),_0xd2557d['on'](_0x4f8393(0x3b6),()=>{resetPassword();}),_0xd2557d['on'](_0x4f8393(0x236),_0x3279b9=>{removeClient(_0xd2557d['id']);}),_0x3a76c3=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x11a159){const _0x5025b2=_0x2cd832;if(_0x11a159!=_0x5025b2(0x1cf)&&config['apiKey']!=''){if(pid[_0x11a159])pid[_0x11a159]['send']({'function':_0x5025b2(0x38d),'args':null});}_0x11a159!=_0x5025b2(0x1cf)&&broadcastToBots(_0x5025b2(0x1f5),JSON[_0x5025b2(0x229)](config));}function reloadBotManager(){const _0x5bb9b6=_0x2cd832;getClientsWithBotID(_0x5bb9b6(0x1cf))[_0x5bb9b6(0x399)](_0x50cb2c=>{const _0xeb4341=_0x5bb9b6;getSocket(_0x50cb2c['id'])[_0xeb4341(0x2b6)](_0xeb4341(0x3b8),{'access':{'allow':![],'reason':_0xeb4341(0x208),'token':null}});});}function getSocket(_0x4c567f){const _0x5055df=_0x2cd832;return io[_0x5055df(0x2dc)][_0x5055df(0x2dc)][_0x5055df(0x223)](_0x4c567f);}function setAccess(_0x2574b8){const _0x4f50c2=_0x2cd832,_0x40bf3a=getSocket(_0x2574b8['id']),_0x614a65=_0x2574b8['uuid'],_0x5c367d=_0x2574b8[_0x4f50c2(0x213)];devices[_0x614a65][_0x4f50c2(0x329)]=validateAccess(devices[_0x614a65][_0x4f50c2(0x329)][_0x4f50c2(0x2d5)],_0x614a65),logger[_0x4f50c2(0x3ba)]('Setting\x20access:\x20'+devices[_0x614a65][_0x4f50c2(0x329)][_0x4f50c2(0x1c3)]+_0x4f50c2(0x279)+_0x2574b8['id'][_0x4f50c2(0x38e)](-0x8)+'\x20|\x20user:\x20...'+_0x614a65['slice'](-0x8)),_0x40bf3a['join'](_0x614a65);if(devices[_0x614a65]['access'][_0x4f50c2(0x2ca)]){_0x40bf3a['join'](_0x5c367d);if(_0x5c367d==_0x4f50c2(0x1cf))initializeSocketBotManager(_0x40bf3a);else initializeSocketBot(_0x40bf3a);initClient(_0x5c367d);}devices[_0x614a65][_0x4f50c2(0x329)][_0x4f50c2(0x2d5)]&&devices[_0x614a65]['access'][_0x4f50c2(0x1c3)]==_0x4f50c2(0x37e)&&setSessionTimeout(_0x4f50c2(0x234),_0x614a65),devices[_0x614a65]['access']['token']&&devices[_0x614a65][_0x4f50c2(0x329)][_0x4f50c2(0x1c3)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4f50c2(0x375),_0x614a65),_0x40bf3a[_0x4f50c2(0x2b6)](_0x4f50c2(0x3b8),{'status':_0x2574b8[_0x4f50c2(0x273)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x614a65][_0x4f50c2(0x329)],'externalip':devices[_0x614a65]['ip'],'publicKey':secure[_0x4f50c2(0x202)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x614a65]['access']['allow']==![]&&devices[_0x614a65][_0x4f50c2(0x329)][_0x4f50c2(0x1c3)]==_0x4f50c2(0x29b)&&temporaryAccess2FA(_0x614a65,devices[_0x614a65]['ip']);}function setSessionTimeout(_0x406a3e,_0x46ec58){const _0x4ebc38=_0x2cd832;let _0x42620f;if(_0x406a3e==_0x4ebc38(0x375))_0x42620f=loginExpiry*0x3c*0x3e8;else _0x42620f=devices[_0x46ec58][_0x4ebc38(0x335)][_0x4ebc38(0x3a5)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x46ec58][_0x4ebc38(0x335)]['timestamp']);if(devices[_0x46ec58][_0x4ebc38(0x386)])clearTimeout(devices[_0x46ec58]['pidExpireLogin']);devices[_0x46ec58][_0x4ebc38(0x386)]=setTimeout(()=>{const _0x5ad0b3=_0x4ebc38;if(devices[_0x46ec58][_0x5ad0b3(0x315)])clearTimeout(devices[_0x46ec58][_0x5ad0b3(0x315)]);removeSocketListeners(_0x46ec58),addBlacklist(_0x46ec58),devices[_0x46ec58][_0x5ad0b3(0x335)]=null,devices[_0x46ec58]['telegram2FaApproval']=null,devices[_0x46ec58][_0x5ad0b3(0x329)][_0x5ad0b3(0x2d5)]=null,logger[_0x5ad0b3(0x3ba)](_0x5ad0b3(0x304)+_0x46ec58['slice'](-0x8)),devices[_0x46ec58][_0x5ad0b3(0x329)]=validateAccess(devices[_0x46ec58]['access'][_0x5ad0b3(0x2d5)],_0x46ec58),!(devices[_0x46ec58][_0x5ad0b3(0x329)][_0x5ad0b3(0x2ca)]&&devices[_0x46ec58][_0x5ad0b3(0x329)]['reason']==_0x5ad0b3(0x247))&&(_0x406a3e==_0x5ad0b3(0x375)?io['to'](_0x46ec58)['emit']('status',{'access':{'allow':![],'reason':_0x5ad0b3(0x305),'token':null}}):io['to'](_0x46ec58)[_0x5ad0b3(0x2b6)]('status',{'access':{'allow':![],'reason':_0x5ad0b3(0x1dd),'token':null}})),devices[_0x46ec58][_0x5ad0b3(0x329)]['token']=null;},_0x42620f);}function setTokenRefresh(_0x159181){const _0x40a403=_0x2cd832;if(devices[_0x159181]['pidRefreshToken'])clearTimeout(devices[_0x159181][_0x40a403(0x315)]);devices[_0x159181]['pidRefreshToken']=setTimeout(()=>{const _0x189619=_0x40a403;getClientsWithUuid(_0x159181)[_0x189619(0x1b9)]!=0x0?(devices[_0x159181]['access']=refreshToken(_0x159181),io['to'](_0x159181)[_0x189619(0x2b6)](_0x189619(0x3b8),{'status':_0x189619(0x2de),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x159181][_0x189619(0x329)],'externalip':devices[_0x159181]['ip'],'publicKey':secure[_0x189619(0x202)],'validInstallation':validInstallation}),setTokenRefresh(_0x159181)):clearTimeout(devices[_0x159181][_0x189619(0x315)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x8f6b9c){const _0x298717=_0x2cd832,_0x383e43=getClient(_0x8f6b9c['id'])[_0x298717(0x308)];_0x8f6b9c[_0x298717(0x2b6)](_0x298717(0x1f5),config),_0x8f6b9c[_0x298717(0x2b6)](_0x298717(0x230),cleanSettings()),_0x8f6b9c['on']('add-bot',_0x463c81=>{const _0x19d17c=_0x298717;if(validateAccess(_0x463c81,_0x383e43)['allow'])addBot();else logger[_0x19d17c(0x2d8)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x8f6b9c['on'](_0x298717(0x22b),(_0x2ab8b4,_0xa40d6c)=>{const _0xd52cef=_0x298717;if(validateAccess(_0xa40d6c,_0x383e43)[_0xd52cef(0x2ca)])toggleBot(_0x2ab8b4[_0xd52cef(0x1e4)],_0x2ab8b4['status'],_0x2ab8b4['live']);else logger[_0xd52cef(0x2d8)](_0xd52cef(0x357));}),_0x8f6b9c['on'](_0x298717(0x1fb),(_0x366462,_0xba5fcc)=>{const _0x24c317=_0x298717;if(validateAccess(_0xba5fcc,_0x383e43)['allow'])toggleBotMode(_0x366462);else logger[_0x24c317(0x2d8)](_0x24c317(0x357));}),_0x8f6b9c['on'](_0x298717(0x226),(_0xb0ff30,_0x55518a)=>{const _0x2a6610=_0x298717;if(validateAccess(_0x55518a,_0x383e43)[_0x2a6610(0x2ca)])deleteBot(_0xb0ff30);else logger['full'](_0x2a6610(0x351));}),_0x8f6b9c['on'](_0x298717(0x2f4),(_0x497f69,_0x472a66)=>{const _0x206bae=_0x298717;if(validateAccess(_0x472a66,_0x383e43)[_0x206bae(0x2ca)])storeSettings(_0x497f69,!![]);else logger[_0x206bae(0x2d8)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x8f6b9c['on'](_0x298717(0x38a),_0x4aa956=>{const _0x16c46f=_0x298717;if(validateAccess(_0x4aa956,_0x383e43)[_0x16c46f(0x2ca)])updateBB(_0x16c46f(0x388));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x8f6b9c['on'](_0x298717(0x263),_0x1a9e16=>{const _0x181d63=_0x298717;if(validateAccess(_0x1a9e16,_0x383e43)[_0x181d63(0x2ca)])updateBB('reinstall');else logger[_0x181d63(0x2d8)](_0x181d63(0x352));}),_0x8f6b9c['on']('get-backup-files',_0x4f8344=>{const _0x5499db=_0x298717;if(validateAccess(_0x4f8344,_0x383e43)[_0x5499db(0x2ca)]){const _0x3c60d2=getClient(_0x8f6b9c['id']);if(_0x3c60d2)getBackupFiles(_0x3c60d2[_0x5499db(0x308)]);else logger[_0x5499db(0x2d8)](_0x5499db(0x1d0));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x8f6b9c['on'](_0x298717(0x32d),(_0x427a8c,_0x2df5a5)=>{const _0x31716e=_0x298717;if(validateAccess(_0x2df5a5,_0x383e43)[_0x31716e(0x2ca)])restoreBackupFile(_0x427a8c);else logger[_0x31716e(0x2d8)](_0x31716e(0x2f3));}),_0x8f6b9c['on'](_0x298717(0x21a),_0x488e74=>{const _0x5be4d6=_0x298717;if(validateAccess(_0x488e74,_0x383e43)[_0x5be4d6(0x2ca)])getMessages();else logger['full'](_0x5be4d6(0x3b9));}),_0x8f6b9c['on']('confirm-message',(_0x54e9a8,_0x58c3c0)=>{const _0xf872d3=_0x298717;if(validateAccess(_0x58c3c0,_0x383e43)[_0xf872d3(0x2ca)])confirmMessage(_0x54e9a8);else logger[_0xf872d3(0x2d8)](_0xf872d3(0x1e2));}),_0x8f6b9c['on'](_0x298717(0x258),_0x4008ca=>{const _0x31741f=_0x298717;if(validateAccess(_0x4008ca,_0x383e43)['allow']){if(devices[_0x383e43][_0x31741f(0x315)])clearTimeout(devices[_0x383e43][_0x31741f(0x315)]);if(devices[_0x383e43][_0x31741f(0x386)])clearTimeout(devices[_0x383e43]['pidExpireLogin']);removeSocketListeners(getClient(_0x8f6b9c['id'])[_0x31741f(0x308)]),addBlacklist(_0x383e43),devices[_0x383e43][_0x31741f(0x335)]=null,devices[_0x383e43][_0x31741f(0x34d)]=null,devices[_0x383e43][_0x31741f(0x329)][_0x31741f(0x2d5)]=null,logger[_0x31741f(0x3ba)](_0x31741f(0x2bf)+_0x383e43[_0x31741f(0x38e)](-0x8)),io['to'](getClient(_0x8f6b9c['id'])['uuid'])[_0x31741f(0x2b6)](_0x31741f(0x3b8),{'access':{'allow':![],'reason':_0x31741f(0x396),'token':null}});}else logger[_0x31741f(0x2d8)](_0x31741f(0x265));});}function initializeSocketBot(_0x1bb635){const _0x4ec105=_0x2cd832,_0xcbefe9=getClient(_0x1bb635['id'])[_0x4ec105(0x213)],_0x34620d=getClient(_0x1bb635['id'])[_0x4ec105(0x308)];_0x1bb635['on'](_0x4ec105(0x30d),(_0x325d45,_0x576750)=>{const _0xe644a5=_0x4ec105;if(validateAccess(_0x576750,_0x34620d)[_0xe644a5(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0xe644a5(0x303)]({'function':_0xe644a5(0x334),'args':_0x325d45});}else logger[_0xe644a5(0x2d8)](_0xe644a5(0x23c));}),_0x1bb635['on']('delete-alerts',(_0x5673d0,_0xcb0878)=>{const _0x58efa1=_0x4ec105;if(validateAccess(_0xcb0878,_0x34620d)['allow']){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x58efa1(0x303)]({'function':_0x58efa1(0x31a),'args':_0x5673d0});}else logger[_0x58efa1(0x2d8)](_0x58efa1(0x39c));}),_0x1bb635['on'](_0x4ec105(0x244),(_0x262247,_0x2be64a)=>{const _0x28e196=_0x4ec105;if(validateAccess(_0x2be64a,_0x34620d)[_0x28e196(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x28e196(0x303)]({'function':'getPortfolio','args':_0x262247});}else logger['full'](_0x28e196(0x39f));}),_0x1bb635['on']('store-configuration',(_0x5a3423,_0xf9cfa)=>{const _0x4d3676=_0x4ec105;if(validateAccess(_0xf9cfa,_0x34620d)[_0x4d3676(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x4d3676(0x303)]({'function':_0x4d3676(0x1f0),'args':_0x5a3423});}else logger['full'](_0x4d3676(0x3ae));}),_0x1bb635['on'](_0x4ec105(0x30a),(_0x5a71fb,_0xe9ebda)=>{const _0xb2ce68=_0x4ec105;if(validateAccess(_0xe9ebda,_0x34620d)['allow']){if(pid[_0xcbefe9])pid[_0xcbefe9]['send']({'function':_0xb2ce68(0x380),'args':_0x5a71fb});}else logger[_0xb2ce68(0x2d8)](_0xb2ce68(0x1d2));}),_0x1bb635['on'](_0x4ec105(0x2c9),(_0x1eaa67,_0x3f9044)=>{const _0x1a57c2=_0x4ec105;if(validateAccess(_0x3f9044,_0x34620d)['allow']){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x1a57c2(0x303)]({'function':_0x1a57c2(0x1e0),'args':_0x1eaa67});}else logger['full'](_0x1a57c2(0x24d));}),_0x1bb635['on']('reset-history',_0x3243bd=>{const _0x468d06=_0x4ec105;if(validateAccess(_0x3243bd,_0x34620d)[_0x468d06(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x468d06(0x303)]({'function':_0x468d06(0x28e),'args':null});}else logger[_0x468d06(0x2d8)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x1bb635['on'](_0x4ec105(0x205),_0x5963e5=>{const _0x86baf4=_0x4ec105;if(validateAccess(_0x5963e5,_0x34620d)[_0x86baf4(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x86baf4(0x303)]({'function':_0x86baf4(0x33d),'args':null});}else logger[_0x86baf4(0x2d8)](_0x86baf4(0x1be));}),_0x1bb635['on'](_0x4ec105(0x1e6),(_0x188b02,_0x25afc7)=>{const _0x36ab54=_0x4ec105;if(validateAccess(_0x25afc7,_0x34620d)[_0x36ab54(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x36ab54(0x303)]({'function':_0x36ab54(0x36e),'args':_0x188b02});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x1bb635['on'](_0x4ec105(0x2bb),_0x224ff9=>{const _0x728c88=_0x4ec105;if(validateAccess(_0x224ff9,_0x34620d)[_0x728c88(0x2ca)]){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x728c88(0x303)]({'function':_0x728c88(0x1e1),'args':null});}else logger['full'](_0x728c88(0x3a8));}),_0x1bb635['on'](_0x4ec105(0x1bd),_0x17fa91=>{const _0x26324d=_0x4ec105;if(validateAccess(_0x17fa91,_0x34620d)['allow']){if(pid[_0xcbefe9])pid[_0xcbefe9][_0x26324d(0x303)]({'function':'showConfig','args':null});}else logger[_0x26324d(0x2d8)](_0x26324d(0x224));}),_0x1bb635['on'](_0x4ec105(0x38a),_0x5c9958=>{const _0x24aa17=_0x4ec105;if(validateAccess(_0x5c9958,_0x34620d)['allow'])updateBB(_0x24aa17(0x388));else logger[_0x24aa17(0x2d8)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x1bb635['on'](_0x4ec105(0x21a),_0x5b4e42=>{const _0x3421bb=_0x4ec105;if(validateAccess(_0x5b4e42,_0x34620d)[_0x3421bb(0x2ca)])getMessages();else logger[_0x3421bb(0x2d8)](_0x3421bb(0x3b9));}),_0x1bb635['on'](_0x4ec105(0x20c),(_0x42de11,_0x43da79)=>{const _0x3e3d0e=_0x4ec105;if(validateAccess(_0x43da79,_0x34620d)['allow'])confirmMessage(_0x42de11);else logger[_0x3e3d0e(0x2d8)](_0x3e3d0e(0x1e2));}),_0x1bb635['on'](_0x4ec105(0x258),_0x3cf73d=>{const _0x5f4a2c=_0x4ec105;if(validateAccess(_0x3cf73d,_0x34620d)['allow']){if(devices[_0x34620d][_0x5f4a2c(0x315)])clearTimeout(devices[_0x34620d][_0x5f4a2c(0x315)]);if(devices[_0x34620d][_0x5f4a2c(0x386)])clearTimeout(devices[_0x34620d][_0x5f4a2c(0x386)]);removeSocketListeners(getClient(_0x1bb635['id'])[_0x5f4a2c(0x308)]),addBlacklist(_0x34620d),devices[_0x34620d][_0x5f4a2c(0x335)]=null,devices[_0x34620d][_0x5f4a2c(0x34d)]=null,devices[_0x34620d][_0x5f4a2c(0x329)][_0x5f4a2c(0x2d5)]=null,logger['debug'](_0x5f4a2c(0x2bf)+_0x34620d[_0x5f4a2c(0x38e)](-0x8)),io['to'](getClient(_0x1bb635['id'])['uuid'])['emit'](_0x5f4a2c(0x3b8),{'access':{'allow':![],'reason':_0x5f4a2c(0x396),'token':null}});}else logger[_0x5f4a2c(0x2d8)](_0x5f4a2c(0x265));});}function removeSocketListeners(_0x269dc9){const _0x56d8ad=_0x2cd832;getClientsWithUuid(_0x269dc9)[_0x56d8ad(0x399)](_0x218822=>{const _0x4df8e9=_0x56d8ad;getSocket(_0x218822['id'])[_0x4df8e9(0x300)]();});}function cleanSettings(){const _0x1bb854=_0x2cd832;let _0x5d8c79=settings;return settings[_0x1bb854(0x2fe)]&&settings[_0x1bb854(0x2fe)]!=''&&(_0x5d8c79={..._0x5d8c79,'telegramToken':_0x1bb854(0x342)}),settings['bbPassword']&&settings[_0x1bb854(0x207)]!=''&&(_0x5d8c79={..._0x5d8c79,'bbPassword':_0x1bb854(0x342)}),(settings[_0x1bb854(0x207)]&&settings[_0x1bb854(0x207)]==_0x1bb854(0x1ea)||settings[_0x1bb854(0x2fe)]&&settings[_0x1bb854(0x2fe)]=='***')&&(_0x5d8c79={..._0x5d8c79,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x1bb854(0x2fe)]=='***'}}),_0x5d8c79;}async function updateBB(_0x27ae79){const _0x406c56=_0x2cd832;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x4ece1d=>{const _0x3d0f0b=_0x366b;restartBot(_0x4ece1d[_0x3d0f0b(0x1e4)]);});if(_0x27ae79==_0x406c56(0x388))process[_0x406c56(0x303)]({'update':!![],'environment':environment},_0x3552c9=>{});else _0x27ae79==_0x406c56(0x29d)&&process[_0x406c56(0x303)]({'reinstall':!![],'environment':environment},_0x2ae3f6=>{});}function startBot(_0x40f745,_0x52e12e,_0x5da3){const _0x46a48b=_0x2cd832;if(debugging)_0x40f745['push']('-d');let _0x2a5997=![];const _0x58df9f=_0x40f745[0x0];_0x52e12e={..._0x52e12e,'stdio':['inherit',_0x46a48b(0x37a),_0x46a48b(0x37a),_0x46a48b(0x3a2)]},pid[_0x58df9f]=childProcess['fork'](botfile,_0x40f745,_0x52e12e),pid[_0x58df9f]['on'](_0x46a48b(0x1b5),_0x24669f=>{const _0x5be430=_0x46a48b;switch(Object[_0x5be430(0x1fa)](_0x24669f)[0x0]){case _0x5be430(0x309):updateBotName(_0x58df9f,_0x24669f[_0x5be430(0x309)]);break;case'updatebotmanager':updateBotManager();break;case _0x5be430(0x3b8):updateStatus(_0x58df9f,_0x24669f[_0x5be430(0x3b8)]);break;case _0x5be430(0x26a):updateLive(_0x58df9f,_0x24669f[_0x5be430(0x26a)]);break;case _0x5be430(0x217):updateLive(_0x58df9f,_0x24669f[_0x5be430(0x217)]),io['to'](_0x58df9f)['emit'](_0x5be430(0x3b8),{'access':{'allow':![],'reason':_0x5be430(0x208),'token':null}});break;case _0x5be430(0x37b):_0x24669f['stop']=='restart'&&restartBot(_0x58df9f);_0x24669f[_0x5be430(0x37b)]=='kill'&&toggleBot(_0x58df9f,'disabled',_0x5be430(0x2f9));break;case _0x5be430(0x361):sendTelegramBot(_0x58df9f,_0x24669f[_0x5be430(0x361)]);break;case _0x5be430(0x240):sendTelegramMsg(_0x24669f[_0x5be430(0x240)]);break;case _0x5be430(0x35c):io['to'](_0x58df9f)[_0x5be430(0x2b6)](_0x24669f[_0x5be430(0x35c)],_0x24669f[_0x5be430(0x210)]);break;}}),pid[_0x58df9f]['on']('error',function(_0x1479d8){if(_0x2a5997)return;_0x2a5997=!![],_0x5da3(_0x1479d8);}),pid[_0x58df9f]['on'](_0x46a48b(0x282),async function(_0x3dd917){const _0x164a17=_0x46a48b;if(terminating)return;if(installingUpdate){logger[_0x164a17(0x3ba)](_0x164a17(0x326)),io[_0x164a17(0x2c4)]();return;}if(_0x2a5997)return;_0x2a5997=!![],_0x5da3(null);const _0x5db751=dbConfig[_0x164a17(0x223)](_0x164a17(0x1f5))[_0x164a17(0x2bd)]({'botID':_0x58df9f})[_0x164a17(0x272)]();_0x5db751&&(_0x5db751[_0x164a17(0x3b8)]==_0x164a17(0x33c)||_0x5db751[_0x164a17(0x3b8)]==_0x164a17(0x372))&&(await sleep(0x3e8),updateLive(_0x58df9f,'stopped'),logger[_0x164a17(0x2d8)]('Restarting\x20Bot\x20'+_0x58df9f),startBot([_0x58df9f,userID],{'cwd':bbpath},function(_0xbdc30b){const _0x4a9457=_0x164a17;if(_0xbdc30b)logger[_0x4a9457(0x2d8)](_0xbdc30b);}));});}function stopBot(_0x5dc3ed){const _0x437aed=_0x2cd832;getClientsWithBotID(_0x5dc3ed)['forEach'](_0x260cab=>{const _0x52a0d2=_0x366b;getSocket(_0x260cab['id'])[_0x52a0d2(0x236)](!![]),removeClient(_0x260cab['id']);}),pid[_0x5dc3ed]&&(pid[_0x5dc3ed][_0x437aed(0x2a7)](),pid[_0x5dc3ed]=null);}function stopAllBots(){const _0x1868f8=_0x2cd832;terminating=!![];const _0x43413d=getEnabledBots();_0x43413d[_0x1868f8(0x399)](_0x4bfe6e=>{const _0x42eb31=_0x1868f8;stopBot(_0x4bfe6e[_0x42eb31(0x1e4)]);});}function restartBot(_0x259360){const _0x25850d=_0x2cd832;if(pid[_0x259360])pid[_0x259360][_0x25850d(0x2a7)]();}function addBot(){const _0x3bc394=_0x2cd832;let _0x2f82ca;for(let _0x1c3811=0x1;_0x1c3811<0x3e9;_0x1c3811++){_0x2f82ca=_0x1c3811[_0x3bc394(0x2d1)]()[_0x3bc394(0x2e7)](0x3,'0');let _0x526a83=config[_0x3bc394(0x2bd)](_0x4f2c93=>_0x4f2c93[_0x3bc394(0x1e4)]==_0x2f82ca);if(!_0x526a83)break;}if(_0x2f82ca===_0x3bc394(0x340)){logger[_0x3bc394(0x2d8)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x3bc394(0x2d8)](_0x3bc394(0x26f)+_0x2f82ca),dbConfig['get'](_0x3bc394(0x1f5))[_0x3bc394(0x3a3)]({'botID':_0x2f82ca,'botname':'Bot\x20'+_0x2f82ca,'status':_0x3bc394(0x372),'live':''})['write'](),startBot([_0x2f82ca,userID],{'cwd':bbpath},function(_0x589501){const _0x20285c=_0x3bc394;if(_0x589501)logger[_0x20285c(0x2d8)](_0x589501);}),config=getConfiguration(),io['to']('botmanager')[_0x3bc394(0x2b6)]('bots',config),broadcastToBots(_0x3bc394(0x1f5),JSON[_0x3bc394(0x229)](config));}function deleteBot(_0x474ccd){const _0x506350=_0x2cd832;getClientsWithBotID(_0x474ccd)['forEach'](_0x263087=>{const _0x374229=_0x366b;getSocket(_0x263087['id'])[_0x374229(0x236)](!![]),removeClient(_0x263087['id']);}),dbConfig['get'](_0x506350(0x1f5))['remove']({'botID':_0x474ccd})[_0x506350(0x255)](),logger['full'](_0x506350(0x288)+_0x474ccd),stopBot(_0x474ccd);try{if(fs[_0x506350(0x3af)](path[_0x506350(0x369)](configpath,_0x506350(0x3b3)+_0x474ccd+_0x506350(0x1b6))))fs[_0x506350(0x337)](path[_0x506350(0x369)](configpath,_0x506350(0x3b3)+_0x474ccd+_0x506350(0x1b6)));if(fs[_0x506350(0x3af)](path['join'](configpath,_0x506350(0x3b3)+_0x474ccd+_0x506350(0x2b4))))fs[_0x506350(0x337)](path['join'](configpath,'bot-'+_0x474ccd+_0x506350(0x2b4)));if(fs['existsSync'](path[_0x506350(0x369)](configpath,'bot-'+_0x474ccd+'-performance.json')))fs[_0x506350(0x337)](path[_0x506350(0x369)](configpath,_0x506350(0x3b3)+_0x474ccd+_0x506350(0x30f)));if(fs['existsSync'](path[_0x506350(0x369)](configpath,'bot-'+_0x474ccd+_0x506350(0x2b0))))fs[_0x506350(0x337)](path[_0x506350(0x369)](configpath,_0x506350(0x3b3)+_0x474ccd+'-results.json'));}catch(_0x384682){if(_0x384682)logger['full'](_0x506350(0x1dc),_0x384682);}config=getConfiguration(),io['to'](_0x506350(0x1cf))[_0x506350(0x2b6)]('bots',config),broadcastToBots(_0x506350(0x1f5),JSON[_0x506350(0x229)](config));}function toggleBot(_0x51c50d,_0x8ac202,_0x551a51){const _0x9cca27=_0x2cd832;dbConfig['get'](_0x9cca27(0x1f5))['find']({'botID':_0x51c50d})[_0x9cca27(0x320)]({'status':_0x8ac202})[_0x9cca27(0x320)]({'live':_0x551a51})['write']();if(_0x8ac202==_0x9cca27(0x33c)||_0x8ac202==_0x9cca27(0x372))logger[_0x9cca27(0x2d8)](_0x9cca27(0x302)+_0x51c50d),startBot([_0x51c50d,userID],{'cwd':bbpath},function(_0x4469cd){const _0x42cfb1=_0x9cca27;if(_0x4469cd)logger[_0x42cfb1(0x2d8)](_0x4469cd);});else(_0x8ac202==_0x9cca27(0x389)||_0x8ac202==_0x9cca27(0x321))&&(logger[_0x9cca27(0x2d8)](_0x9cca27(0x317)+_0x51c50d),stopBot(_0x51c50d));config=getConfiguration(),io['to'](_0x9cca27(0x1cf))[_0x9cca27(0x2b6)](_0x9cca27(0x1f5),config),broadcastToBots(_0x9cca27(0x1f5),JSON[_0x9cca27(0x229)](config));}function toggleStatus(_0x576ff7){const _0x85774a=_0x2cd832;let _0x276341=dbConfig['get'](_0x85774a(0x1f5))['find']({'botID':_0x576ff7})[_0x85774a(0x272)](),_0x85bb4e;if(_0x276341['status']==='enabled')_0x85bb4e=_0x85774a(0x389);else{if(_0x276341['status']===_0x85774a(0x372))_0x85bb4e=_0x85774a(0x321);else{if(_0x276341[_0x85774a(0x3b8)]==='new-disabled')_0x85bb4e=_0x85774a(0x372);else{if(_0x276341[_0x85774a(0x3b8)]===_0x85774a(0x389))_0x85bb4e=_0x85774a(0x33c);}}}return _0x85bb4e;}function updateStatus(_0x109d43,_0xc99482){const _0x9d9f13=_0x2cd832;dbConfig[_0x9d9f13(0x223)](_0x9d9f13(0x1f5))[_0x9d9f13(0x2bd)]({'botID':_0x109d43})[_0x9d9f13(0x320)]({'status':_0xc99482})[_0x9d9f13(0x255)](),config=getConfiguration(),io['to'](_0x9d9f13(0x1cf))[_0x9d9f13(0x2b6)](_0x9d9f13(0x1f5),config),broadcastToBots(_0x9d9f13(0x1f5),JSON[_0x9d9f13(0x229)](config));}function updateLive(_0x357f10,_0x363a48){const _0x2f2ac7=_0x2cd832;dbConfig[_0x2f2ac7(0x223)]('bots')['find']({'botID':_0x357f10})[_0x2f2ac7(0x320)]({'live':_0x363a48})[_0x2f2ac7(0x255)](),config=getConfiguration(),io['to'](_0x2f2ac7(0x1cf))[_0x2f2ac7(0x2b6)]('bots',config),broadcastToBots(_0x2f2ac7(0x1f5),JSON[_0x2f2ac7(0x229)](config));}function updateBotName(_0x57ba17,_0x320788){const _0x53caa6=_0x2cd832;dbConfig[_0x53caa6(0x223)](_0x53caa6(0x1f5))[_0x53caa6(0x2bd)]({'botID':_0x57ba17})['assign']({'botname':_0x320788})['write'](),config=getConfiguration(),io['to'](_0x53caa6(0x1cf))['emit'](_0x53caa6(0x1f5),config),broadcastToBots(_0x53caa6(0x1f5),JSON[_0x53caa6(0x229)](config));}function updateBotManager(){const _0x5b1a5e=_0x2cd832;config=getConfiguration(),io['to'](_0x5b1a5e(0x1cf))['emit'](_0x5b1a5e(0x1f5),config),broadcastToBots('bots',JSON[_0x5b1a5e(0x229)](config));}function toggleBotMode(_0x3f34d8){const _0x40f3ae=_0x2cd832;if(pid[_0x3f34d8])pid[_0x3f34d8][_0x40f3ae(0x303)]({'function':_0x40f3ae(0x1ff),'args':null});else{const _0x2cfc13=configpath+_0x40f3ae(0x3b3)+_0x3f34d8+'-config.json',_0x2243d0=fs[_0x40f3ae(0x231)](_0x2cfc13),_0x13f87c=JSON['parse'](_0x2243d0),_0x5d87a4=_0x13f87c['bot'][0x0]['headless'];_0x13f87c[_0x40f3ae(0x213)][0x0][_0x40f3ae(0x30e)]=!_0x5d87a4;const _0x1abca1=JSON['stringify'](_0x13f87c,null,0x2);fs['writeFileSync'](_0x2cfc13,_0x1abca1),config=getConfiguration(),io['to'](_0x40f3ae(0x1cf))[_0x40f3ae(0x2b6)](_0x40f3ae(0x1f5),config),broadcastToBots('bots',JSON[_0x40f3ae(0x229)](config));}}function validateTelegram(_0x5c6f09){const _0x46a3fe=_0x2cd832;if(_0x5c6f09[_0x46a3fe(0x3ad)][_0x46a3fe(0x2a2)]!=settings['telegramUsername']&&'@'+_0x5c6f09['from']['username']!=settings[_0x46a3fe(0x33a)]||_0x5c6f09['chat']['id']!=settings[_0x46a3fe(0x25f)])return sendTelegram(_0x5c6f09[_0x46a3fe(0x21c)]['id'],_0x46a3fe(0x275),{'parse_mode':_0x46a3fe(0x2c0)}),![];return!![];}async function initTelegram(){const _0x577a9e=_0x2cd832;if(tgBot)tgBot[_0x577a9e(0x37b)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x577a9e(0x2fe)]);let _0x1a8acd=_0x577a9e(0x295);_0x1a8acd+='\x0a',_0x1a8acd+=_0x577a9e(0x1c6),_0x1a8acd+=_0x577a9e(0x35e),_0x1a8acd+=_0x577a9e(0x24f),_0x1a8acd+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1a8acd+=_0x577a9e(0x1c5),_0x1a8acd+=_0x577a9e(0x25b),_0x1a8acd+=_0x577a9e(0x281),_0x1a8acd+=_0x577a9e(0x2f5),_0x1a8acd+=_0x577a9e(0x32b),_0x1a8acd+=_0x577a9e(0x268),_0x1a8acd+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x1a8acd+=_0x577a9e(0x383),_0x1a8acd+=_0x577a9e(0x1cc),_0x1a8acd+=_0x577a9e(0x350);let _0x2049bf=_0x577a9e(0x261);_0x2049bf+='\x0a',_0x2049bf+=_0x1a8acd,tgBot['catch']((_0x867169,_0x64c788)=>{const _0x7ddff2=_0x577a9e;logger[_0x7ddff2(0x1d9)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x7ddff2(0x3ba)](_0x7ddff2(0x23f),_0x867169);}),tgBot[_0x577a9e(0x2f1)](async(_0x5a70ba,_0x55dc48)=>{const _0xf2c087=_0x577a9e;if(!(!settings['telegramChatId']&&_0x5a70ba[_0xf2c087(0x388)][_0xf2c087(0x1b5)][_0xf2c087(0x2aa)]==_0xf2c087(0x322))){if(!validateTelegram(_0x5a70ba))return;}_0x55dc48();}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x34a),async _0x58f2a2=>{const _0x15a5fd=_0x577a9e;if(!settings[_0x15a5fd(0x25f)])updateSetting(_0x15a5fd(0x25f),_0x58f2a2['chat']['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x58f2a2))return;await sendTelegram(_0x58f2a2[_0x15a5fd(0x21c)]['id'],_0x2049bf);}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x397),async _0x14a548=>{const _0x382750=_0x577a9e;updateSetting(_0x382750(0x253),!![]),await sendTelegram(_0x14a548['chat']['id'],_0x382750(0x211));}),tgBot['command']('disable',async _0x46a2e6=>{const _0x25797e=_0x577a9e;await sendTelegram(_0x46a2e6['chat']['id'],_0x25797e(0x2a1)),updateSetting(_0x25797e(0x253),![]);}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x35a),async _0x3a740b=>{const _0x17fe7e=_0x577a9e,_0x1fc704=Markup[_0x17fe7e(0x2e2)]([Markup[_0x17fe7e(0x32e)]['callback']('Orders',_0x17fe7e(0x2d6)),Markup[_0x17fe7e(0x32e)][_0x17fe7e(0x2f8)](_0x17fe7e(0x38c),_0x17fe7e(0x3a9)),Markup[_0x17fe7e(0x32e)][_0x17fe7e(0x2f8)](_0x17fe7e(0x2fd),'config_all')]);_0x3a740b[_0x17fe7e(0x360)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x1fc704);}),tgBot[_0x577a9e(0x34e)](_0x577a9e(0x2d6),async _0x196dfb=>{const _0x1401aa=_0x577a9e;_0x196dfb['editMessageReplyMarkup'](),updateSetting(_0x1401aa(0x33b),_0x1401aa(0x338)),updateSetting(_0x1401aa(0x253),!![]),await sendTelegram(_0x196dfb[_0x1401aa(0x21c)]['id'],_0x1401aa(0x1b3));}),tgBot[_0x577a9e(0x34e)](_0x577a9e(0x3a9),async _0x47a401=>{const _0x1aa2a4=_0x577a9e;_0x47a401[_0x1aa2a4(0x1ba)](),updateSetting(_0x1aa2a4(0x33b),_0x1aa2a4(0x1db)),updateSetting(_0x1aa2a4(0x253),!![]),await sendTelegram(_0x47a401['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot['action'](_0x577a9e(0x37f),async _0x3b0e1e=>{const _0x33654a=_0x577a9e;_0x3b0e1e[_0x33654a(0x1ba)](),updateSetting(_0x33654a(0x33b),_0x33654a(0x250)),updateSetting(_0x33654a(0x253),!![]),await sendTelegram(_0x3b0e1e[_0x33654a(0x21c)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x577a9e(0x3b8),async _0x476f0d=>{const _0x4f2fce=_0x577a9e,_0x25cc31=getBotsWithMode();let _0x56d5dd=_0x4f2fce(0x238);config[_0x4f2fce(0x399)](_0x2f4332=>{const _0xdfcd3e=_0x4f2fce,_0x1b46c4=_0x25cc31[_0xdfcd3e(0x2bd)](_0x30fc88=>_0x30fc88[_0xdfcd3e(0x1e4)]==_0x2f4332[_0xdfcd3e(0x1e4)])[_0xdfcd3e(0x245)];_0x56d5dd+=_0xdfcd3e(0x277)+_0x2f4332[_0xdfcd3e(0x1e4)]+':\x20'+_0x2f4332[_0xdfcd3e(0x3b8)]+'\x20|\x20'+_0x1b46c4+'\x20|\x20'+_0x2f4332['live']+'\x0a';}),_0x56d5dd+='\x0a',_0x56d5dd+=_0x4f2fce(0x267),_0x56d5dd+=!settings[_0x4f2fce(0x253)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x56d5dd+=settings['telegramEnabled']?settings['telegramEvents']==_0x4f2fce(0x250)?_0x4f2fce(0x36a):_0x4f2fce(0x2fb)+settings[_0x4f2fce(0x33b)]+_0x4f2fce(0x365):'',await sendTelegram(_0x476f0d[_0x4f2fce(0x21c)]['id'],_0x56d5dd,{'parse_mode':_0x4f2fce(0x2c0)});}),tgBot['command']('restart',async _0xdddb75=>{const _0x41bcc2=_0x577a9e,_0x478204=getEnabledBots();if(_0x478204[_0x41bcc2(0x1b9)]==0x0)await sendTelegram(_0xdddb75[_0x41bcc2(0x21c)]['id'],_0x41bcc2(0x233));else{if(_0x478204[_0x41bcc2(0x1b9)]>0x1)_0x478204[_0x41bcc2(0x3a3)]({'botID':_0x41bcc2(0x250)});let _0x2344d1=[],_0x28aec8=[];const _0x32dafc=_0x478204[_0x41bcc2(0x1b9)]%0x4==0x0||_0x478204['length']%0x4==0x3||_0x478204[_0x41bcc2(0x1b9)]%0x3==0x1?0x4:0x3;let _0x5e5c87=0x0;_0x478204[_0x41bcc2(0x399)]((_0x3db839,_0x3503bf)=>{const _0x336254=_0x41bcc2;if(_0x3503bf%_0x32dafc==0x0)_0x28aec8=[];_0x28aec8[_0x336254(0x3a3)](Markup[_0x336254(0x32e)][_0x336254(0x2f8)](_0x3db839[_0x336254(0x1e4)]==_0x336254(0x250)?_0x336254(0x2b2):_0x336254(0x277)+_0x3db839[_0x336254(0x1e4)],_0x336254(0x2b7)+_0x3db839[_0x336254(0x1e4)])),_0x3503bf%_0x32dafc==0x0&&(_0x2344d1[_0x5e5c87]=_0x28aec8,_0x5e5c87++);});const _0x39611b=Markup[_0x41bcc2(0x2e2)](_0x2344d1);_0xdddb75[_0x41bcc2(0x360)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x39611b);}}),tgBot[_0x577a9e(0x34e)](/restart_(.+)/,async _0x2cf972=>{const _0x5cfb4a=_0x577a9e,_0x4a5ee9=_0x2cf972['match'][0x1];_0x2cf972[_0x5cfb4a(0x1ba)](),_0x4a5ee9==_0x5cfb4a(0x250)?config[_0x5cfb4a(0x399)](_0x42cb92=>{restartBot(_0x42cb92['botID']);}):restartBot(_0x4a5ee9);}),tgBot[_0x577a9e(0x2cf)]('on',async _0x5ac22a=>{const _0x13a653=_0x577a9e,_0x490e75=getDisabledBots();if(_0x490e75[_0x13a653(0x1b9)]==0x0)await sendTelegram(_0x5ac22a[_0x13a653(0x21c)]['id'],_0x13a653(0x31c));else{if(_0x490e75[_0x13a653(0x1b9)]>0x1)_0x490e75['push']({'botID':_0x13a653(0x250)});let _0x39359f=[],_0x16c47d=[];const _0x2dd060=_0x490e75[_0x13a653(0x1b9)]%0x4==0x0||_0x490e75[_0x13a653(0x1b9)]%0x4==0x3||_0x490e75['length']%0x3==0x1?0x4:0x3;let _0x3feced=0x0;_0x490e75[_0x13a653(0x399)]((_0x59c9cf,_0x589b00)=>{const _0x20a913=_0x13a653;if(_0x589b00%_0x2dd060==0x0)_0x16c47d=[];_0x16c47d[_0x20a913(0x3a3)](Markup[_0x20a913(0x32e)][_0x20a913(0x2f8)](_0x59c9cf[_0x20a913(0x1e4)]=='all'?_0x20a913(0x2b2):'Bot\x20'+_0x59c9cf[_0x20a913(0x1e4)],_0x20a913(0x2c2)+_0x59c9cf[_0x20a913(0x1e4)])),_0x589b00%_0x2dd060==0x0&&(_0x39359f[_0x3feced]=_0x16c47d,_0x3feced++);});const _0x2d0b34=Markup['inlineKeyboard'](_0x39359f);_0x5ac22a[_0x13a653(0x360)](_0x13a653(0x1e3),_0x2d0b34);}}),tgBot[_0x577a9e(0x34e)](/on_(.+)/,async _0x32f6c5=>{const _0x34a019=_0x577a9e,_0x1000b8=_0x32f6c5[_0x34a019(0x1fe)][0x1];_0x32f6c5['editMessageReplyMarkup']();if(_0x1000b8==_0x34a019(0x250)){const _0x4cd0f1=getDisabledBots();await sendTelegram(_0x32f6c5['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x4cd0f1['forEach'](_0x4a52a3=>{const _0x47cc87=_0x34a019;if(_0x4a52a3['botID']!=_0x47cc87(0x250))toggleBot(_0x4a52a3['botID'],toggleStatus(_0x4a52a3[_0x47cc87(0x1e4)]),_0x47cc87(0x2f9));});}else await sendTelegram(_0x32f6c5[_0x34a019(0x21c)]['id'],_0x34a019(0x30b)+_0x1000b8),toggleBot(_0x1000b8,toggleStatus(_0x1000b8),_0x34a019(0x2f9));}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x221),async _0x1e6ac7=>{const _0x13c940=_0x577a9e,_0x5095db=getEnabledBots();if(_0x5095db[_0x13c940(0x1b9)]==0x0)await sendTelegram(_0x1e6ac7[_0x13c940(0x21c)]['id'],_0x13c940(0x233));else{if(_0x5095db[_0x13c940(0x1b9)]>0x1)_0x5095db[_0x13c940(0x3a3)]({'botID':'all'});let _0xa6fdc5=[],_0x1c6381=[];const _0x1468a7=_0x5095db[_0x13c940(0x1b9)]%0x4==0x0||_0x5095db[_0x13c940(0x1b9)]%0x4==0x3||_0x5095db['length']%0x3==0x1?0x4:0x3;let _0xba5b01=0x0;_0x5095db['forEach']((_0x165db8,_0x2c73d7)=>{const _0x33232d=_0x13c940;if(_0x2c73d7%_0x1468a7==0x0)_0x1c6381=[];_0x1c6381[_0x33232d(0x3a3)](Markup['button']['callback'](_0x165db8[_0x33232d(0x1e4)]==_0x33232d(0x250)?'All\x20bots':_0x33232d(0x277)+_0x165db8[_0x33232d(0x1e4)],_0x33232d(0x26e)+_0x165db8[_0x33232d(0x1e4)])),_0x2c73d7%_0x1468a7==0x0&&(_0xa6fdc5[_0xba5b01]=_0x1c6381,_0xba5b01++);});const _0x2106fa=Markup['inlineKeyboard'](_0xa6fdc5);_0x1e6ac7[_0x13c940(0x360)](_0x13c940(0x3ac),_0x2106fa);}}),tgBot[_0x577a9e(0x34e)](/off_(.+)/,async _0x115d79=>{const _0x26492d=_0x577a9e,_0x78b56a=_0x115d79[_0x26492d(0x1fe)][0x1];_0x115d79[_0x26492d(0x1ba)]();if(_0x78b56a==_0x26492d(0x250)){const _0x222196=getEnabledBots();await sendTelegram(_0x115d79[_0x26492d(0x21c)]['id'],_0x26492d(0x29c)),_0x222196[_0x26492d(0x399)](_0x4f868c=>{const _0x109519=_0x26492d;if(_0x4f868c[_0x109519(0x1e4)]!=_0x109519(0x250))toggleBot(_0x4f868c[_0x109519(0x1e4)],toggleStatus(_0x4f868c[_0x109519(0x1e4)]),_0x109519(0x2f9));});}else await sendTelegram(_0x115d79[_0x26492d(0x21c)]['id'],_0x26492d(0x347)+_0x78b56a),toggleBot(_0x78b56a,toggleStatus(_0x78b56a),_0x26492d(0x2f9));}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x313),async _0x202b48=>{const _0x19205a=_0x577a9e,_0x166a75=getEnabledBots();if(_0x166a75[_0x19205a(0x1b9)]==0x0)await sendTelegram(_0x202b48[_0x19205a(0x21c)]['id'],_0x19205a(0x233));else{if(_0x166a75['length']>0x1){let _0x3669b3=[],_0x470a09=[];const _0x4285de=_0x166a75['length']%0x4==0x0||_0x166a75['length']%0x4==0x3||_0x166a75[_0x19205a(0x1b9)]%0x3==0x1?0x4:0x3;let _0x3739e0=0x0;_0x166a75[_0x19205a(0x399)]((_0x587683,_0x332004)=>{const _0x202e86=_0x19205a;if(_0x332004%_0x4285de==0x0)_0x470a09=[];_0x470a09['push'](Markup['button'][_0x202e86(0x2f8)](_0x202e86(0x277)+_0x587683['botID'],_0x202e86(0x36f)+_0x587683[_0x202e86(0x1e4)])),_0x332004%_0x4285de==0x0&&(_0x3669b3[_0x3739e0]=_0x470a09,_0x3739e0++);});const _0x1ef15e=Markup[_0x19205a(0x2e2)](_0x3669b3);_0x202b48[_0x19205a(0x360)](_0x19205a(0x285),_0x1ef15e);}else{const _0x2ed95c=_0x166a75[0x0]['botID'];if(pid[_0x2ed95c])pid[_0x2ed95c][_0x19205a(0x303)]({'function':_0x19205a(0x1c9),'args':null});}}}),tgBot[_0x577a9e(0x34e)](/metrics_(.+)/,async _0x468ba2=>{const _0x1168ef=_0x577a9e,_0x4b0b29=_0x468ba2['match'][0x1];_0x468ba2['editMessageReplyMarkup']();if(pid[_0x4b0b29])pid[_0x4b0b29]['send']({'function':_0x1168ef(0x1c9),'args':null});}),tgBot['command'](_0x577a9e(0x395),async _0x28b988=>{const _0x20eb79=_0x577a9e,_0x342857=getEnabledBots();if(_0x342857['length']==0x0)await sendTelegram(_0x28b988[_0x20eb79(0x21c)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x342857[_0x20eb79(0x1b9)]>0x1){let _0xacf5b6=[],_0x963de3=[];const _0x2e2a32=_0x342857[_0x20eb79(0x1b9)]%0x4==0x0||_0x342857[_0x20eb79(0x1b9)]%0x4==0x3||_0x342857[_0x20eb79(0x1b9)]%0x3==0x1?0x4:0x3;let _0xf8cff5=0x0;_0x342857[_0x20eb79(0x399)]((_0x3aaa92,_0xc5b875)=>{const _0x40502e=_0x20eb79;if(_0xc5b875%_0x2e2a32==0x0)_0x963de3=[];_0x963de3[_0x40502e(0x3a3)](Markup[_0x40502e(0x32e)][_0x40502e(0x2f8)]('Bot\x20'+_0x3aaa92[_0x40502e(0x1e4)],_0x40502e(0x2a6)+_0x3aaa92[_0x40502e(0x1e4)])),_0xc5b875%_0x2e2a32==0x0&&(_0xacf5b6[_0xf8cff5]=_0x963de3,_0xf8cff5++);});const _0x172080=Markup[_0x20eb79(0x2e2)](_0xacf5b6);_0x28b988[_0x20eb79(0x360)](_0x20eb79(0x203),_0x172080);}else{const _0x14df9b=_0x342857[0x0][_0x20eb79(0x1e4)];if(pid[_0x14df9b])pid[_0x14df9b][_0x20eb79(0x303)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x577a9e(0x34e)](/portfolio_(.+)/,async _0xb57f22=>{const _0x5ca559=_0x577a9e,_0x3d0f1c=_0xb57f22[_0x5ca559(0x1fe)][0x1];_0xb57f22[_0x5ca559(0x1ba)]();if(pid[_0x3d0f1c])pid[_0x3d0f1c][_0x5ca559(0x303)]({'function':_0x5ca559(0x284),'args':null});}),tgBot['command'](_0x577a9e(0x388),async _0x4df52b=>{const _0x2a754c=_0x577a9e;await getMessages();if(!updateAvailable)await sendTelegram(_0x4df52b[_0x2a754c(0x21c)]['id'],_0x2a754c(0x29e));else{if(!validInstallation)await sendTelegram(_0x4df52b[_0x2a754c(0x21c)]['id'],_0x2a754c(0x23d));else{const _0x5bb39d=Markup[_0x2a754c(0x2e2)]([Markup['button'][_0x2a754c(0x2f8)](_0x2a754c(0x237),_0x2a754c(0x2da)),Markup['button']['callback']('No',_0x2a754c(0x257))]);_0x4df52b[_0x2a754c(0x360)](_0x2a754c(0x1d7),_0x5bb39d);}}}),tgBot[_0x577a9e(0x34e)](/update_(.+)/,async _0xb02a47=>{const _0x2d3eab=_0x577a9e,_0x5c7c94=_0xb02a47[_0x2d3eab(0x1fe)][0x1];_0xb02a47[_0x2d3eab(0x1ba)](),_0x5c7c94==_0x2d3eab(0x20b)&&(await sendTelegram(_0xb02a47[_0x2d3eab(0x21c)]['id'],_0x2d3eab(0x345)),updateBB(_0x2d3eab(0x388))),_0x5c7c94=='no'&&await sendTelegram(_0xb02a47['chat']['id'],_0x2d3eab(0x274));}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x29d),async _0x3d06ae=>{const _0x3cdaa7=_0x577a9e;if(!validInstallation)await sendTelegram(_0x3d06ae[_0x3cdaa7(0x21c)]['id'],_0x3cdaa7(0x2c3));else{const _0x4b0a79=Markup[_0x3cdaa7(0x2e2)]([Markup[_0x3cdaa7(0x32e)][_0x3cdaa7(0x2f8)](_0x3cdaa7(0x237),'reinstall_yes'),Markup[_0x3cdaa7(0x32e)][_0x3cdaa7(0x2f8)]('No',_0x3cdaa7(0x312))]);_0x3d06ae[_0x3cdaa7(0x360)](_0x3cdaa7(0x1fc),_0x4b0a79);}}),tgBot['action'](/reinstall_(.+)/,async _0x1ed24c=>{const _0xe038d=_0x577a9e,_0x36dfeb=_0x1ed24c[_0xe038d(0x1fe)][0x1];_0x1ed24c[_0xe038d(0x1ba)](),_0x36dfeb==_0xe038d(0x20b)&&(await sendTelegram(_0x1ed24c['chat']['id'],_0xe038d(0x3a1)),updateBB(_0xe038d(0x29d))),_0x36dfeb=='no'&&await sendTelegram(_0x1ed24c['chat']['id'],_0xe038d(0x27e));}),tgBot[_0x577a9e(0x2cf)]('toggle',async _0x31b2be=>{const _0x538a20=_0x577a9e,_0x4db9d5=getBotsWithMode();if(_0x4db9d5[_0x538a20(0x1b9)]==0x0)await sendTelegram(_0x31b2be[_0x538a20(0x21c)]['id'],_0x538a20(0x233));else{let _0x33bab5=[],_0x1c3419=[];const _0x2938a6=0x2;let _0x15b53a=0x0;_0x4db9d5[_0x538a20(0x399)]((_0x4cfe2a,_0x1c8a21)=>{const _0x4fd8ef=_0x538a20;if(_0x1c8a21%_0x2938a6==0x0)_0x1c3419=[];_0x1c3419[_0x4fd8ef(0x3a3)](Markup[_0x4fd8ef(0x32e)]['callback']('Bot\x20'+_0x4cfe2a[_0x4fd8ef(0x1e4)]+'\x20('+_0x4cfe2a[_0x4fd8ef(0x245)]+')',_0x4fd8ef(0x249)+_0x4cfe2a[_0x4fd8ef(0x1e4)])),_0x1c8a21%_0x2938a6==0x0&&(_0x33bab5[_0x15b53a]=_0x1c3419,_0x15b53a++);});const _0x4749e8=Markup[_0x538a20(0x2e2)](_0x33bab5);_0x31b2be[_0x538a20(0x360)](_0x538a20(0x35d),_0x4749e8);}}),tgBot[_0x577a9e(0x34e)](/toggle_(.+)/,async _0x23a7ea=>{const _0x17db5e=_0x577a9e,_0x10a80a=_0x23a7ea[_0x17db5e(0x1fe)][0x1];_0x23a7ea[_0x17db5e(0x1ba)]();const _0x4db0f9=getBotsWithMode(),_0x4d75dd=_0x4db0f9[_0x17db5e(0x2bd)](_0x12e612=>_0x12e612[_0x17db5e(0x1e4)]==_0x10a80a),_0xfac26c=_0x4d75dd['mode']==_0x17db5e(0x2e5)?_0x17db5e(0x377):_0x17db5e(0x2e5);await sendTelegram(_0x23a7ea['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x10a80a+_0x17db5e(0x346)+_0xfac26c+_0x17db5e(0x227)),toggleBotMode(_0x10a80a);}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x243),async _0x2817ef=>{const _0xd334d5=_0x577a9e;let _0x4f60c7='';config[_0xd334d5(0x399)](_0x3f0501=>{const _0x1c7402=_0xd334d5;_0x4f60c7+=_0x1c7402(0x277)+_0x3f0501[_0x1c7402(0x1e4)]+':\x20'+_0x3f0501[_0x1c7402(0x309)]+'\x0a';}),await sendTelegram(_0x2817ef[_0xd334d5(0x21c)]['id'],_0x4f60c7,{'parse_mode':'HTML'});}),tgBot[_0x577a9e(0x2cf)](_0x577a9e(0x2ad),async _0x59bb74=>{const _0x317d11=_0x577a9e;await sendTelegram(_0x59bb74[_0x317d11(0x21c)]['id'],_0x1a8acd);}),process['once'](_0x577a9e(0x2ce),()=>tgBot[_0x577a9e(0x37b)](_0x577a9e(0x2ce))),process[_0x577a9e(0x259)](_0x577a9e(0x2ed),()=>tgBot[_0x577a9e(0x37b)]('SIGTERM')),tgBot[_0x577a9e(0x262)]();}}function disableTelegram(){const _0x19d1a8=_0x2cd832;tgBot&&tgBot[_0x19d1a8(0x37b)]();}async function sendTelegram(_0x3ff904,_0x444907,_0x2ea940){const _0x556183=_0x2cd832;try{await tgBot[_0x556183(0x361)][_0x556183(0x20a)](_0x3ff904,_0x444907,_0x2ea940);}catch(_0x1dca72){console[_0x556183(0x260)]('Telegram\x20error:',_0x1dca72);}}async function sendTelegramBot(_0x2c3d60,_0x4c7df4){const _0x5e2a55=_0x2cd832;if(settings[_0x5e2a55(0x253)]){if(settings[_0x5e2a55(0x33b)]==_0x5e2a55(0x250)||(_0x4c7df4['type']=='error'||_0x4c7df4[_0x5e2a55(0x1c0)]==_0x5e2a55(0x23a)||_0x4c7df4['type']=='success')&&settings[_0x5e2a55(0x33b)]==_0x5e2a55(0x1db)||_0x4c7df4[_0x5e2a55(0x1c0)]==_0x5e2a55(0x276)&&settings[_0x5e2a55(0x33b)]==_0x5e2a55(0x338)){if(tgBot&&settings['telegramChatId']){if(_0x4c7df4[_0x5e2a55(0x22e)])await sendTelegram(settings[_0x5e2a55(0x25f)],_0x4c7df4[_0x5e2a55(0x309)]+_0x5e2a55(0x1df)+_0x4c7df4[_0x5e2a55(0x269)]);else await sendTelegram(settings[_0x5e2a55(0x25f)],'Bot\x20'+_0x2c3d60+'\x20>\x20'+_0x4c7df4[_0x5e2a55(0x269)]);}}}}async function sendTelegramMsg(_0x57440b,_0x4c666d=_0x2cd832(0x2c0)){const _0x3dd1b1=_0x2cd832;return settings[_0x3dd1b1(0x253)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x3dd1b1(0x25f)],_0x57440b,{'parse_mode':_0x4c666d}),!![]):![];}function getDeviceWithIp(_0x3ba80d){const _0x3099b1=_0x2cd832;return devices[_0x3099b1(0x2bd)](_0x3a6d8c=>_0x3a6d8c['ip']===_0x3ba80d);}async function temporaryAccess2FA(_0x3394aa,_0x1d3c14){const _0x180547=_0x2cd832;let _0x225029=new Date(),_0x523367=![];if(lastIpApproval){if(_0x225029-lastIpApproval<0x1388)_0x523367=!![];}lastIpApproval=new Date();if(_0x523367)return;if(tgBot&&settings[_0x180547(0x25f)]){const _0x5eed7b=uuidRandom();tmpStorage[_0x5eed7b]={'uuid':_0x3394aa,'externalip':_0x1d3c14};const _0xb67790=Markup[_0x180547(0x2e2)]([Markup[_0x180547(0x32e)][_0x180547(0x2f8)](_0x180547(0x264),_0x180547(0x34c)+_0x5eed7b),Markup[_0x180547(0x32e)][_0x180547(0x2f8)]('15\x20min','tempaccess_15_'+_0x5eed7b),Markup[_0x180547(0x32e)][_0x180547(0x2f8)](_0x180547(0x1e9),_0x180547(0x367)+_0x5eed7b),Markup[_0x180547(0x32e)][_0x180547(0x2f8)](_0x180547(0x371),_0x180547(0x33e)+_0x5eed7b)]);await sendTelegram(settings[_0x180547(0x25f)],_0x180547(0x1b4)+normalizeIP(_0x1d3c14)[_0x180547(0x355)]+'\x20?',_0xb67790),tgBot[_0x180547(0x34e)](/tempaccess_(.+)_(.+)/,async _0x32cf6d=>{const _0x2c3537=_0x180547,_0x225a0f=_0x32cf6d[_0x2c3537(0x1fe)][0x1],_0x58a637=_0x32cf6d[_0x2c3537(0x1fe)][0x2],{uuid:_0x2ccf84,externalip:_0x352ce2}=tmpStorage[_0x58a637];delete tmpStorage[_0x58a637],_0x32cf6d[_0x2c3537(0x1ba)](),devices[_0x2ccf84][_0x2c3537(0x335)]={'clientip':_0x352ce2,'timestamp':new Date()['getTime'](),'expiry':_0x225a0f},_0x225a0f!=_0x2c3537(0x371)?(await sendTelegram(_0x32cf6d[_0x2c3537(0x21c)]['id'],_0x2c3537(0x32a)+_0x225a0f+_0x2c3537(0x2e0),{'parse_mode':_0x2c3537(0x2c0)}),io['to'](_0x2ccf84)[_0x2c3537(0x2b6)](_0x2c3537(0x3b8),{'access':{'allow':![],'reason':_0x2c3537(0x208),'token':null}})):(await sendTelegram(_0x32cf6d[_0x2c3537(0x21c)]['id'],_0x2c3537(0x332)),io['to'](_0x2ccf84)[_0x2c3537(0x2b6)]('status',{'access':{'allow':![],'reason':_0x2c3537(0x2f6),'token':null}}));});}}async function loginAccess2FA(_0x8a21b4,_0x5133ee){const _0x4501e6=_0x2cd832;if(tgBot&&settings['telegramChatId']){const _0x33d457=uuidRandom();tmpStorage[_0x33d457]={'uuid':_0x8a21b4,'externalip':_0x5133ee};const _0x592fbc=Markup[_0x4501e6(0x2e2)]([Markup['button']['callback'](_0x4501e6(0x1f1),_0x4501e6(0x27f)+loginExpiry+'_'+_0x33d457),Markup['button'][_0x4501e6(0x2f8)](_0x4501e6(0x371),_0x4501e6(0x242)+_0x33d457)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x5133ee)[_0x4501e6(0x355)]+'\x20?',_0x592fbc),tgBot[_0x4501e6(0x34e)](/login2fa_(.+)_(.+)/,async _0x458254=>{const _0x237d38=_0x4501e6,_0x1026ae=_0x458254[_0x237d38(0x1fe)][0x1],_0x4cf79b=_0x458254[_0x237d38(0x1fe)][0x2],{uuid:_0x56eca1,externalip:_0x2aadfc}=tmpStorage[_0x4cf79b];delete tmpStorage[_0x4cf79b],_0x458254[_0x237d38(0x1ba)](),devices[_0x56eca1][_0x237d38(0x34d)]={'clientip':_0x2aadfc,'timestamp':new Date()['getTime'](),'expiry':_0x1026ae},_0x1026ae!='reject'?(await sendTelegram(_0x458254['chat']['id'],_0x237d38(0x2fa),{'parse_mode':_0x237d38(0x2c0)}),io['to'](_0x56eca1)[_0x237d38(0x2b6)](_0x237d38(0x3b8),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x458254['chat']['id'],_0x237d38(0x24b)),io['to'](_0x56eca1)[_0x237d38(0x2b6)](_0x237d38(0x3b8),{'access':{'allow':![],'reason':_0x237d38(0x1eb),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x9515f9=_0x2cd832;return dbConfig[_0x9515f9(0x223)](_0x9515f9(0x1f5))[_0x9515f9(0x3b0)](_0x9515f9(0x1e4))[_0x9515f9(0x1c4)]({'status':_0x9515f9(0x33c)})[_0x9515f9(0x272)]()||[];}function getDisabledBots(){const _0x32b234=_0x2cd832;return dbConfig['get'](_0x32b234(0x1f5))[_0x32b234(0x3b0)](_0x32b234(0x1e4))[_0x32b234(0x1c4)]({'status':_0x32b234(0x389)})['value']()||[];}function getBotAttributes(_0x1356d2){const _0x3a0369=_0x2cd832;let _0x2936c3={};const _0x557544=configpath+_0x3a0369(0x3b3)+_0x1356d2+_0x3a0369(0x1b6),_0x5e20df=fs['existsSync'](_0x557544);if(_0x5e20df){const _0x255086=fs[_0x3a0369(0x231)](_0x557544);try{const _0x1e37db=JSON['parse'](_0x255086),_0x4e8266=_0x1e37db?_0x1e37db[_0x3a0369(0x213)][0x0][_0x3a0369(0x30e)]:![];_0x2936c3[_0x3a0369(0x245)]=_0x4e8266?_0x3a0369(0x2e5):_0x3a0369(0x377),_0x2936c3['botname']=_0x1e37db?_0x1e37db[_0x3a0369(0x213)][0x0][_0x3a0369(0x309)]:_0x3a0369(0x277)+_0x1356d2;}catch(_0x4150df){_0x2936c3[_0x3a0369(0x245)]=_0x3a0369(0x377),_0x2936c3[_0x3a0369(0x309)]='Bot\x20'+_0x1356d2;}}else _0x2936c3['mode']=_0x3a0369(0x377),_0x2936c3[_0x3a0369(0x309)]='Bot\x20'+_0x1356d2;return _0x2936c3;}function getBotsWithMode(){const _0x368186=_0x2cd832,_0x3b4a14=dbConfig['get'](_0x368186(0x1f5))['sortBy']('botID')[_0x368186(0x272)]()||[];return _0x3b4a14['forEach'](_0x25d9a9=>{const _0x8bfaea=_0x368186;let _0x2366f7=getBotAttributes(_0x25d9a9[_0x8bfaea(0x1e4)]);_0x25d9a9[_0x8bfaea(0x245)]=_0x2366f7['mode'];}),_0x3b4a14;}function getBotExchanges(){const _0x227c0d=_0x2cd832;let _0x5920ff=[];const _0x5392e1=dbConfig['get'](_0x227c0d(0x1f5))[_0x227c0d(0x3b0)](_0x227c0d(0x1e4))[_0x227c0d(0x272)]()||[];_0x5392e1['forEach'](_0x1b9f13=>{const _0x40d412=_0x227c0d;if(_0x1b9f13[_0x40d412(0x3b8)]==_0x40d412(0x33c)){const _0xdf7fce=configpath+'bot-'+_0x1b9f13['botID']+_0x40d412(0x1b6),_0x141e6e=fs[_0x40d412(0x3af)](_0xdf7fce);let _0x3ae699;if(_0x141e6e){const _0x295b1e=fs[_0x40d412(0x231)](_0xdf7fce);try{const _0x23ab0b=JSON[_0x40d412(0x2e9)](_0x295b1e);_0x3ae699=_0x23ab0b?_0x23ab0b[_0x40d412(0x213)][0x0]['exchange']:null;}catch(_0x5c2984){}}if(_0x3ae699)_0x5920ff[_0x40d412(0x3a3)](_0x3ae699);}});const _0x59f71a=[...new Set(_0x5920ff)][_0x227c0d(0x3a4)]();return _0x59f71a;}async function initUser(){const _0x24fbd3=_0x2cd832;if(!settings['userid']){const _0xca25ab=uuidRandom();mixpanel[_0x24fbd3(0x23b)](_0xca25ab),updateSetting(_0x24fbd3(0x31b),_0xca25ab);}}function _0x2a6a(){const _0x43d14d=['2FA\x20login\x20required','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','login2fa_','hasOwnProperty','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','exit','conn','sendPortfolioTelegram','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','internal','hex','Deleted\x20Bot\x20','=>\x20Go\x20to\x20#CYA#http://','title','mkdirSync','sendFile','resetpw_yes','resetHistory','backup-full.zip','createServer','isDirectory','bb-settings.json','mtime','Network\x20Interfaces:','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/upload-backup','createWriteStream','notification','459770DDkhHO','telegraf','2FA\x20required','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','reinstall','Your\x20installation\x20is\x20already\x20up\x20to\x20date','bbUsername','https://api.ipify.org?format=json','Notifications\x20disabled','username','store','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','util','portfolio_','kill','6KDNUBd','restore_yes_','text','number','hybrid-crypto-js','help','Idling\x20(','bot.js','-results.json','env','All\x20bots','decrypt','-events.json','replace','emit','restart_','output-003.log','test','express','cancel-loading','name','find','9272410QYUjCT','Logged\x20out\x20user\x20...','HTML','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','on_','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','close','output-000.log','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','writeFileSync','privateKey','store-fiat','allow','string','production','range','SIGINT','command','encryptedUuid','toString','3SDpovF','backup-full@','exp','token','config_orders','lowdb/adapters/FileSync','full','rmSync','update_yes','remove','sockets','binary','connected','\x20(2)','\x20minutes','sign','inlineKeyboard','private','DEFLATE','auto','set','padStart','toIPv4Address','parse','timeshift','\x1b[31m','resetpw_no','SIGTERM','bb-config.json','axios','api-eu.mixpanel.com','use','add','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','store-settings','/names\x20-\x20show\x20bot\x20names\x0a','temporary\x20access\x20rejected','NTBA_FIX_319','callback','stopped','Login\x20accepted','Notifications\x20types:\x20','loginRequired','All','telegramToken','uncaughtException','removeAllListeners','then','Enabled\x20Bot\x20','send','Session\x20expired\x20for\x20user\x20...','access\x20timeout','handshake','temporary\x20access\x20not\x20allowed','uuid','botname','store-headless','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','getHours','get-logs','headless','-performance.json','toIPv4MappedAddress','6b67f3d61ee94b8f5c80b4affef4c4d9','reinstall_no','metrics','yargs/yargs','pidRefreshToken','Restore\x20backup\x20file\x20','Disabled\x20Bot\x20','No\x20authentication\x20token','version.json','deleteHistoryAlerts','userid','All\x20bots\x20running\x20right\x20now','temporaryAccessAllowed','Bot\x20Mgr\x20>\x20','user','assign','new-disabled','/start','#RES#\x20if\x20running\x20on\x20server','Password\x20reset\x20rejected','auth','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','/:bot/history','getSeconds','access','Access\x20enabled\x20for\x20','/status\x20-\x20show\x20bot(s)\x20status\x0a','defaults','restore-backup-file','button','statSync','152XBpaWr','output-001.log','Temporary\x20access\x20rejected','Restore\x20process\x20confirmed','emitHistory','telegramIpApproval','-----------------------------------------------------------------------------------','unlinkSync','orders','endsWith','telegramUsername','telegramEvents','enabled','getStartingBalances','tempaccess_reject_','Logged\x20in\x20user\x20...','1000','files','************','\x1b[35m','settings.','Starting\x20Balance\x20Bot\x20update','\x20to\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','startsWith','42813QbiZMI','start','min','tempaccess_5_','telegram2FaApproval','action',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','/help\x20-\x20show\x20available\x20commands\x0a','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','IPv4','blacklist','show','format','Unauthorized\x20attempt\x20to\x20update\x20bot','output-002.log','.zip','config','whitelistEnabled','function','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','/disable\x20-\x20disable\x20notifications\x0a','getMinutes','reply','telegram','compareSync','getDate','3yaDXFj','\x20only\x0a','split','tempaccess_30_','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','join','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/:bot/portfolio','ipv6','copyFileSync','placeOrder','metrics_','(staging)','reject','new','::1','Invalid\x20IP\x20address','login','(((.+)+)+)+$','manual','18862459zYPKjU','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','inherit','stop','environment','Backup\x20file\x20unzipped\x20and\x20stored','temporary\x20token\x20generated','config_all','storeHeadless','Invalid\x20username\x20or\x20IP\x20address','4606161arDzRC','/update\x20-\x20update\x20Balance\x20Bot\x0a','getUTCHours','search','pidExpireLogin','secure','update','disabled','update-bb','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Alerts','initclient','slice','getMonth','post','2FA\x20login\x20token\x20generated','randomFillSync','3000','messages','portfolio','logged\x20out','enable','entries','forEach','secret','constructor','Unauthorized\x20attempt\x20to\x20delete\x20alerts','track','onepagemode','Unauthorized\x20attempt\x20to\x20get\x20portfolio','login\x20required','Starting\x20Balance\x20Bot\x20reinstallation','ipc','push','sort','expiry','build','backup-files','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','config_alerts','listen','running','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','from','Unauthorized\x20attempt\x20to\x20store\x20configuration','existsSync','sortBy','index.html','/:bot/configuration','bot-','[ip-address]','host','reset-password','port','status','Unauthorized\x20attempt\x20to\x20get\x20messages','debug','Invalid\x20authentication\x20token\x20(2)','express-fileupload','logs','Ok,\x20will\x20send\x20order\x20notifications\x20only','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','message','-config.json','password',')\x20\x20\x20|\x20Bot\x20','length','editMessageReplyMarkup','File\x20uploaded','f2aRequired','show-config','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','file','type','config/','bb-secure.json','reason','filter','/on\x20-\x20start\x20bot(s)\x0a','/enable\x20-\x20enable\x20notifications\x0a','Invalid\x20authentication\x20token\x20(1)','date-fns','sendMetricsTelegram','apiKey','RSA','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','clients','botmanager','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/performance','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20login\x20attempt\x20(timeout)','logs/','Unauthorized\x20attempt\x20to\x20download\x20','Server','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/:bot/coins','simple','lowdb','alerts','Error\x20while\x20deleting\x20config\x20files:\x20','temporary\x20access\x20timeout','socket.io','\x20>\x20','storeFiat','cancelLoading','Unauthorized\x20attempt\x20to\x20confirm\x20message','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','botID','family','place-order','Failed\x20to\x20download\x20','connection','30\x20min','***','2FA\x20login\x20rejected','remoteAddress','\x1b[34m','invalid\x20credentials','socket','storeConfiguration','accept','User\x20has\x20been\x20validated','any','init','bots','zip/','success','Error:\x20Invalid\x20argument\x20','/output-000.log','keys','toggle-bot-mode','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Restoring\x20bot(s)\x20from\x20backup','match','toggleBotMode','lastmsgemitted','versions','publicKey','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','getFullYear','get-starting-balances','bcryptjs','bbPassword','reload','static','sendMessage','yes','confirm-message','Backup\x20file\x20uploaded','RSA-OAEP','max','args','Notifications\x20enabled','hashSync','bot','bbvNew','Starting\x20#RED#Balance\x20Bot\x20v','node-zip','started','Markdown','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','get-messages','size','chat','graphql-request','Node.js\x20v','clientip','127.0.0.1','off','jsonwebtoken','get','Unauthorized\x20attempt\x20to\x20show\x20configuration','readdirSync','delete-bot','\x20mode','backup','stringify','latestversion','update-bot','request','#RES#\x20','showname','temp/','settings','readFileSync','getTime','No\x20bots\x20running\x20right\x20now','2FA','Token\x20blacklisted','disconnect','Yes','<b>Balance\x20Bot\x20Status:</b>\x0a','Crypt','warning','alias','Unauthorized\x20attempt\x20to\x20get\x20events','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','http','Telegraf\x20error:','telegrammsg','apiPassword','login2fa_reject_','names','get-portfolio','mode','Restore\x20process\x20aborted','login\x20not\x20required','\x1b[33m','toggle_','build2','Login\x20rejected','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','headers','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','all','timestamp',')\x20|\x20Bot\x20','telegramEnabled','map','write','child_process','update_no','logout','once','bbvReceive','/off\x20-\x20stop\x20bot(s)\x0a','staging','verify','\x20|\x20','telegramChatId','log','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','launch','reinstall-bb','5\x20min','Unauthorized\x20attempt\x20to\x20log\x20out','$1_$2_$3','<b>Telegram\x20Bot\x20Status:</b>\x0a','/metrics\x20-\x20show\x20bot\x20performance\x0a','event','live','referer','2702756dfcwMQ','address','off_','Starting\x20new\x20bot\x20|\x20Bot\x20','backup/','lastmsgtelegram','value','server','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','order','Bot\x20','apiSecret','\x20|\x20client:\x20...','node','2170645TDEVKY','params'];_0x2a6a=function(){return _0x43d14d;};return _0x2a6a();}async function initSecure(){const _0x5c7911=_0x2cd832;let _0x13e895=getSecure();if(!_0x13e895[_0x5c7911(0x280)](_0x5c7911(0x39a))){let _0x29d6cf=await generateKeys();_0x13e895[_0x5c7911(0x202)]=_0x29d6cf[_0x5c7911(0x202)],_0x13e895[_0x5c7911(0x2c8)]=_0x29d6cf['privateKey'],_0x13e895['secret']=crypto['randomBytes'](0x20)[_0x5c7911(0x2d1)](_0x5c7911(0x287));;storeSecure(_0x13e895);}}function getSettings(){const _0x2f9792=_0x2cd832;return dbSettings[_0x2f9792(0x223)](_0x2f9792(0x230))[_0x2f9792(0x272)]()||{};}function getSecure(){const _0x2559d4=_0x2cd832;return dbSecure[_0x2559d4(0x223)](_0x2559d4(0x387))[_0x2559d4(0x272)]()||{};}function getBlacklist(){const _0x2d7fd1=_0x2cd832;return dbSecure[_0x2d7fd1(0x223)](_0x2d7fd1(0x354))['value']()||[];}function broadcastToBots(_0x2fc306,_0x3716d7){const _0x207a50=_0x2cd832;config[_0x207a50(0x399)](_0x14882c=>{const _0x51fd43=_0x207a50;if(_0x14882c['status']=='enabled'&&_0x14882c['live']=='running'||_0x14882c[_0x51fd43(0x3b8)]==_0x51fd43(0x372)&&_0x14882c[_0x51fd43(0x26a)]==_0x51fd43(0x3ab)){if(pid[_0x14882c[_0x51fd43(0x1e4)]])pid[_0x14882c['botID']][_0x51fd43(0x303)]({[_0x2fc306]:_0x3716d7});}});}function storeSettings(_0x5bd3e8,_0x99ebd=![]){const _0x462653=_0x2cd832;_0x5bd3e8={...settings,..._0x5bd3e8};if(_0x99ebd&&_0x5bd3e8['bbPassword']!='************'&&_0x5bd3e8['bbPassword']!=_0x462653(0x1ea)&&_0x5bd3e8[_0x462653(0x207)]!=''){const _0x524676=crypt[_0x462653(0x2b3)](secure['privateKey'],_0x5bd3e8[_0x462653(0x207)])[_0x462653(0x1b5)][_0x462653(0x366)]('@')[0x0],_0x41fc56=bcrypt['hashSync'](_0x524676,saltRounds);_0x5bd3e8={..._0x5bd3e8,'bbPassword':_0x41fc56};}if(_0x99ebd&&_0x5bd3e8['telegramToken']!='************'&&_0x5bd3e8[_0x462653(0x2fe)]!=_0x462653(0x1ea)&&_0x5bd3e8['telegramToken']!=''){const _0x153a33=crypt[_0x462653(0x2b3)](secure[_0x462653(0x2c8)],_0x5bd3e8[_0x462653(0x2fe)])['message'][_0x462653(0x366)]('@')[0x0];_0x5bd3e8={..._0x5bd3e8,'telegramToken':_0x153a33};}const _0x3787ce=_0x5bd3e8[_0x462653(0x2fe)]!=_0x462653(0x342)&&_0x5bd3e8[_0x462653(0x2fe)]!=settings[_0x462653(0x2fe)]||_0x5bd3e8['telegramUsername']!=settings[_0x462653(0x33a)],_0x2796f4=_0x5bd3e8[_0x462653(0x2fe)]==''||_0x5bd3e8[_0x462653(0x33a)]=='';_0x3787ce&&(_0x5bd3e8[_0x462653(0x25f)]=null,_0x5bd3e8[_0x462653(0x33b)]=_0x462653(0x250));for(const [_0x4f5cb4,_0x55bad0]of Object[_0x462653(0x398)](_0x5bd3e8)){if(_0x4f5cb4=='telegramToken'&&_0x55bad0==_0x462653(0x342)){_0x5bd3e8[_0x462653(0x2fe)]=settings[_0x462653(0x2fe)];continue;};if(_0x4f5cb4=='bbPassword'&&_0x55bad0=='************'){_0x5bd3e8['bbPassword']=settings[_0x462653(0x207)];continue;};dbSettings[_0x462653(0x2e6)](_0x462653(0x344)+_0x4f5cb4,_0x55bad0)['write']();}settings=_0x5bd3e8,io['to'](_0x462653(0x1cf))[_0x462653(0x2b6)]('settings',cleanSettings()),broadcastToBots(_0x462653(0x2ea),settings[_0x462653(0x2ea)]),broadcastToBots(_0x462653(0x39e),settings[_0x462653(0x39e)]);if(_0x3787ce&&!_0x2796f4)initTelegram();if(_0x3787ce&&_0x2796f4)disableTelegram();getAllClients()[_0x462653(0x399)](_0x3c8891=>{const _0x452125=_0x462653;getSocket(_0x3c8891['id'])[_0x452125(0x2b6)](_0x452125(0x3b8),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x43a04a,_0x3ff9fd){const _0x5c1117=_0x2cd832;dbSettings['set'](_0x5c1117(0x344)+_0x43a04a,_0x3ff9fd)['write'](),settings=getSettings(),io['to'](_0x5c1117(0x1cf))[_0x5c1117(0x2b6)](_0x5c1117(0x230),cleanSettings());}function storeSecure(_0x294bae){const _0x1c2220=_0x2cd832;dbSecure[_0x1c2220(0x223)](_0x1c2220(0x387))[_0x1c2220(0x3a3)](_0x294bae)[_0x1c2220(0x255)](),secure=_0x294bae;}function addBlacklist(_0x56f5bb){const _0x4de5b7=_0x2cd832;cleanBlacklist();let _0x1458e4;devices[_0x56f5bb][_0x4de5b7(0x335)]?_0x1458e4=Math[_0x4de5b7(0x20f)](devices[_0x56f5bb][_0x4de5b7(0x335)][_0x4de5b7(0x3a5)],loginExpiry):_0x1458e4=loginExpiry,dbSecure[_0x4de5b7(0x223)](_0x4de5b7(0x354))[_0x4de5b7(0x3a3)]({'expiry':new Date()[_0x4de5b7(0x232)]()+_0x1458e4*0x3c*0x3e8,'token':devices[_0x56f5bb]['access']['token']})[_0x4de5b7(0x255)](),blacklist=dbSecure[_0x4de5b7(0x223)](_0x4de5b7(0x354))['value']();}function cleanBlacklist(){const _0xbb7040=_0x2cd832;let _0x464cf9=dbSecure[_0xbb7040(0x223)](_0xbb7040(0x354))['cloneDeep']()[_0xbb7040(0x272)](),_0x12abc4=new Date()['getTime']();_0x464cf9[_0xbb7040(0x399)](_0x9f793e=>{const _0x408866=_0xbb7040;_0x9f793e[_0x408866(0x3a5)]<_0x12abc4&&dbSecure[_0x408866(0x223)](_0x408866(0x354))['remove']({'expiry':_0x9f793e[_0x408866(0x3a5)]})[_0x408866(0x255)]();});}function initStates(){const _0x53c6fb=_0x2cd832;let _0x38a40b=getConfiguration();_0x38a40b[_0x53c6fb(0x399)](_0x1bd0c3=>{_0x1bd0c3['live']='stopped';}),storeConfiguration(_0x38a40b);}function onKeys(){const _0x3a4a90=new RSA();return new Promise(_0x4d7e02=>{const _0x54a0df=_0x366b;_0x3a4a90['generateKeyPairAsync']()[_0x54a0df(0x301)](_0x57c66f=>{_0x4d7e02(_0x57c66f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x166d18=_0x2cd832;let _0x2a40cc=getSettings(),_0x1c926d=![];!_0x2a40cc[_0x166d18(0x280)](_0x166d18(0x271))&&(_0x2a40cc['lastmsgtelegram']=0x0,_0x1c926d=!![]);!_0x2a40cc['hasOwnProperty'](_0x166d18(0x200))&&(_0x2a40cc['lastmsgemitted']=0x0,_0x1c926d=!![]);!_0x2a40cc[_0x166d18(0x280)](_0x166d18(0x22a))&&(_0x2a40cc[_0x166d18(0x22a)]='0.0.0',_0x1c926d=!![]);!_0x2a40cc['hasOwnProperty'](_0x166d18(0x39e))&&(_0x2a40cc[_0x166d18(0x39e)]=![],_0x1c926d=!![]);if(_0x1c926d)storeSettings(_0x2a40cc);try{fs[_0x166d18(0x225)](configbackuppath,{'withFileTypes':!![]})[_0x166d18(0x399)](_0x4ea261=>{const _0x5b4623=_0x166d18;if(!_0x4ea261[_0x5b4623(0x291)]()){if(!_0x4ea261[_0x5b4623(0x2bc)][_0x5b4623(0x348)]('backup-full@'))fs[_0x5b4623(0x337)](configbackuppath+_0x4ea261[_0x5b4623(0x2bc)]);}else fs['rmSync'](configbackuppath+_0x4ea261[_0x5b4623(0x2bc)],{'recursive':!![]});});}catch(_0x1058b8){logger[_0x166d18(0x3ba)]('Error\x20removing\x20old\x20backup\x20files:',_0x1058b8);}}function storeConfiguration(_0x587deb){const _0x2465a9=_0x2cd832;dbConfig[_0x2465a9(0x223)]('bots')[_0x2465a9(0x2db)]()[_0x2465a9(0x255)](),dbConfig[_0x2465a9(0x223)](_0x2465a9(0x1f5))[_0x2465a9(0x3a3)](..._0x587deb)[_0x2465a9(0x255)](),config=_0x587deb;}async function resetPassword(){const _0x5c55fb=_0x2cd832;if(tgBot&&settings[_0x5c55fb(0x25f)]){const _0x4dbed=Markup['inlineKeyboard']([Markup['button'][_0x5c55fb(0x2f8)](_0x5c55fb(0x20b),_0x5c55fb(0x28d)),Markup['button']['callback']('no',_0x5c55fb(0x2ec))]);await sendTelegram(settings['telegramChatId'],_0x5c55fb(0x2c6),_0x4dbed),tgBot['action'](/resetpw_(.+)/,async _0x4e5fff=>{const _0x561f55=_0x5c55fb,_0x3be143=_0x4e5fff['match'][0x1];_0x4e5fff[_0x561f55(0x1ba)]();if(_0x3be143!='no'){const _0x54667e=0xf,_0x2882aa=_0x561f55(0x38b),_0x514cf8=Array[_0x561f55(0x3ad)](crypto[_0x561f55(0x392)](new Uint32Array(_0x54667e)))[_0x561f55(0x254)](_0x13881b=>_0x2882aa[_0x13881b%_0x2882aa['length']])['join'](''),_0x9caa42=bcrypt[_0x561f55(0x212)](_0x514cf8,saltRounds);storeSettings({'bbPassword':_0x9caa42}),await sendTelegram(_0x4e5fff[_0x561f55(0x21c)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x514cf8,{'parse_mode':_0x561f55(0x2c0)});}else await sendTelegram(_0x4e5fff[_0x561f55(0x21c)]['id'],_0x561f55(0x324));});}}async function confirmRestore(_0x4ee825,_0x46f9c7){const _0x441a57=_0x2cd832;io['to'](_0x441a57(0x1cf))[_0x441a57(0x2b6)](_0x441a57(0x298),_0x441a57(0x379),_0x441a57(0x1f7));if(tgBot&&settings[_0x441a57(0x25f)]){const _0x3112f1=uuidRandom();tmpStorage[_0x3112f1]={'path':_0x4ee825,'filename':_0x46f9c7};const _0x4e7ba0=Markup[_0x441a57(0x2e2)]([Markup[_0x441a57(0x32e)][_0x441a57(0x2f8)](_0x441a57(0x20b),_0x441a57(0x2a9)+_0x3112f1),Markup[_0x441a57(0x32e)][_0x441a57(0x2f8)]('no','restore_no_'+_0x3112f1)]);await sendTelegram(settings[_0x441a57(0x25f)],_0x441a57(0x368),_0x4e7ba0),tgBot[_0x441a57(0x34e)](/restore_(.+)_(.+)/,async _0x2a22d5=>{const _0x5904ee=_0x441a57,_0x11fd33=_0x2a22d5[_0x5904ee(0x1fe)][0x1],_0xdf45a9=_0x2a22d5[_0x5904ee(0x1fe)][0x2],{path:_0x292c05,filename:_0x4b2937}=tmpStorage[_0xdf45a9];delete tmpStorage[_0xdf45a9],_0x2a22d5['editMessageReplyMarkup'](),_0x11fd33=='yes'?(logger['debug'](_0x5904ee(0x333)),await sendTelegram(_0x2a22d5[_0x5904ee(0x21c)]['id'],_0x5904ee(0x1fd),{'parse_mode':_0x5904ee(0x2c0)}),unzipFile(_0x292c05,_0x4b2937)):(logger[_0x5904ee(0x3ba)](_0x5904ee(0x246)),await sendTelegram(_0x2a22d5['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x2c4679=_0x2cd832,_0x2a03c1=new Date();return _0x2a03c1[_0x2c4679(0x204)]()+'/'+(_0x2a03c1[_0x2c4679(0x38f)]()+0x1)['toString']()[_0x2c4679(0x2e7)](0x2,'0')+'/'+_0x2a03c1[_0x2c4679(0x363)]()[_0x2c4679(0x2d1)]()[_0x2c4679(0x2e7)](0x2,'0')+'\x20'+_0x2a03c1[_0x2c4679(0x30c)]()[_0x2c4679(0x2d1)]()[_0x2c4679(0x2e7)](0x2,'0')+':'+_0x2a03c1[_0x2c4679(0x35f)]()[_0x2c4679(0x2d1)]()['padStart'](0x2,'0')+':'+_0x2a03c1[_0x2c4679(0x328)]()[_0x2c4679(0x2d1)]()[_0x2c4679(0x2e7)](0x2,'0');}function getTimeStamp(){const _0x4bc84d=_0x2cd832,_0x204afb=shiftedTime();return _0x204afb[_0x4bc84d(0x204)]()+'/'+(_0x204afb[_0x4bc84d(0x38f)]()+0x1)[_0x4bc84d(0x2d1)]()[_0x4bc84d(0x2e7)](0x2,'0')+'/'+_0x204afb[_0x4bc84d(0x363)]()[_0x4bc84d(0x2d1)]()[_0x4bc84d(0x2e7)](0x2,'0')+'\x20'+_0x204afb[_0x4bc84d(0x30c)]()['toString']()[_0x4bc84d(0x2e7)](0x2,'0')+':'+_0x204afb[_0x4bc84d(0x35f)]()['toString']()['padStart'](0x2,'0')+':'+_0x204afb[_0x4bc84d(0x328)]()[_0x4bc84d(0x2d1)]()[_0x4bc84d(0x2e7)](0x2,'0');}function getCleanTimeStamp(){const _0x41adf1=_0x2cd832,_0x339234=shiftedTime();return _0x339234[_0x41adf1(0x204)]()+(_0x339234['getMonth']()+0x1)[_0x41adf1(0x2d1)]()[_0x41adf1(0x2e7)](0x2,'0')+_0x339234[_0x41adf1(0x363)]()[_0x41adf1(0x2d1)]()['padStart'](0x2,'0')+'-'+_0x339234[_0x41adf1(0x30c)]()[_0x41adf1(0x2d1)]()[_0x41adf1(0x2e7)](0x2,'0')+_0x339234[_0x41adf1(0x35f)]()['toString']()[_0x41adf1(0x2e7)](0x2,'0')+_0x339234['getSeconds']()[_0x41adf1(0x2d1)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x3799f1=_0x2cd832,_0x1097ea=new Date();let _0xbc3b5c=_0x1097ea;if(settings['timeshift']&&settings[_0x3799f1(0x2ea)]!==0x0)_0xbc3b5c=fns[_0x3799f1(0x2f2)](_0x1097ea,{'hours':settings[_0x3799f1(0x2ea)]});return _0xbc3b5c;}function startScheduler(){const _0x31b982=_0x2cd832,_0x3ea92d=new Date()[_0x31b982(0x384)](),_0x4de820=shiftedTime()['getHours']();_0x4de820==0x4&&backupConfigFiles();_0x4de820==0x0&&rotateLogFiles();_0x3ea92d%0x6==0x0&&triggerAnalytics();_0x3ea92d%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x57319f){const _0x484df4=_0x2cd832;logger['debug'](_0x484df4(0x316)+_0x57319f);const _0x579366=getBotsWithMode();_0x579366['length']>0x0?confirmRestore(configbackuppath,_0x57319f):unzipFile(configbackuppath,_0x57319f);}async function getBackupFiles(_0x402c66=null){const _0x576e02=_0x2cd832;let _0x37cda8=[],_0x44b11e=fs[_0x576e02(0x225)](configbackuppath,{'withFileTypes':!![]});_0x44b11e[_0x576e02(0x3a4)]((_0x5e4ec0,_0x5f40ec)=>_0x5e4ec0['name']<_0x5f40ec['name']?0x1:_0x5f40ec[_0x576e02(0x2bc)]<_0x5e4ec0[_0x576e02(0x2bc)]?-0x1:0x0),_0x44b11e['forEach'](_0x5ab003=>{const _0x3528cc=_0x576e02;if(!_0x5ab003[_0x3528cc(0x291)]()&&_0x5ab003['name'][_0x3528cc(0x348)](_0x3528cc(0x2d3))&&_0x5ab003[_0x3528cc(0x2bc)][_0x3528cc(0x339)]('.zip')){const _0xf94daa=formatDate(fs[_0x3528cc(0x32f)](configbackuppath+_0x5ab003[_0x3528cc(0x2bc)])[_0x3528cc(0x293)]);_0x37cda8['push']({'name':_0x5ab003['name'],'mtime':_0xf94daa});}});if(_0x402c66)io['to'](_0x402c66)[_0x576e02(0x2b6)](_0x576e02(0x3a7),_0x37cda8);else return _0x37cda8;}async function backupConfigFiles(){const _0x3cb74e=_0x2cd832;await zipFiles('backup-full');const _0x16621b=getCleanTimeStamp();fs[_0x3cb74e(0x36d)](zippath+_0x3cb74e(0x28f),configbackuppath+(_0x3cb74e(0x2d3)+_0x16621b+_0x3cb74e(0x359)));let _0x582ba3=fs[_0x3cb74e(0x225)](configbackuppath,{'withFileTypes':!![]});_0x582ba3[_0x3cb74e(0x3a4)]((_0x170293,_0x1fd82b)=>_0x170293[_0x3cb74e(0x2bc)]<_0x1fd82b[_0x3cb74e(0x2bc)]?0x1:_0x1fd82b[_0x3cb74e(0x2bc)]<_0x170293[_0x3cb74e(0x2bc)]?-0x1:0x0),_0x582ba3[_0x3cb74e(0x1b9)]>maxBackups&&fs[_0x3cb74e(0x337)](configbackuppath+_0x582ba3[_0x582ba3[_0x3cb74e(0x1b9)]-0x1][_0x3cb74e(0x2bc)]);}function rotateLogFiles(){const _0x3d2914=_0x2cd832,_0x233139=fs[_0x3d2914(0x32f)](logspath+_0x3d2914(0x2c5)),_0x22f831=_0x233139[_0x3d2914(0x21b)]/0x400;if(_0x22f831>0x64){let _0x2c343a=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x2c343a[_0x3d2914(0x3a4)]((_0x37a625,_0x5ef751)=>_0x37a625[_0x3d2914(0x2bc)]<_0x5ef751['name']?0x1:_0x5ef751[_0x3d2914(0x2bc)]<_0x37a625[_0x3d2914(0x2bc)]?-0x1:0x0),_0x2c343a[_0x3d2914(0x399)](_0x1ef530=>{const _0x5699eb=_0x3d2914;if(_0x1ef530[_0x5699eb(0x2bc)]==_0x5699eb(0x358))fs[_0x5699eb(0x36d)](logspath+_0x1ef530[_0x5699eb(0x2bc)],logspath+_0x5699eb(0x2b8));if(_0x1ef530['name']==_0x5699eb(0x331))fs[_0x5699eb(0x36d)](logspath+_0x1ef530['name'],logspath+'output-002.log');_0x1ef530['name']==_0x5699eb(0x2c5)&&(fs[_0x5699eb(0x36d)](logspath+_0x1ef530[_0x5699eb(0x2bc)],logspath+_0x5699eb(0x331)),fs['writeFileSync'](logspath+_0x1ef530['name'],''));});}}async function zipFiles(_0x705bc1){const _0x417dba=_0x2cd832;let _0x2df1ec;if(_0x705bc1==_0x417dba(0x1b2))_0x2df1ec=logspath;if(_0x705bc1==_0x417dba(0x228))_0x2df1ec=configpath;if(_0x705bc1=='backup-full')_0x2df1ec=configpath;let _0x32c7f3=fs[_0x417dba(0x225)](_0x2df1ec,{'withFileTypes':!![]});const _0x1dc8ec=new require(_0x417dba(0x216))();_0x32c7f3[_0x417dba(0x399)](_0x567b79=>{const _0x283788=_0x417dba;if(!_0x567b79['isDirectory']()){let _0x42ffe8=fs[_0x283788(0x231)](_0x2df1ec+_0x567b79[_0x283788(0x2bc)]);if(_0x705bc1==_0x283788(0x228)){const _0x5abf71=/^bot-[0-9]{3}-config.json$/,_0x557ef8=_0x5abf71[_0x283788(0x2b9)](_0x567b79[_0x283788(0x2bc)]);if(_0x557ef8){const _0x32a157=JSON[_0x283788(0x2e9)](_0x42ffe8);if(_0x32a157[_0x283788(0x213)][0x0]){_0x32a157[_0x283788(0x213)][0x0][_0x283788(0x1ca)]=_0x283788(0x1ea),_0x32a157[_0x283788(0x213)][0x0][_0x283788(0x278)]=_0x283788(0x1ea);if(_0x32a157[_0x283788(0x213)][0x0][_0x283788(0x241)])_0x32a157[_0x283788(0x213)][0x0][_0x283788(0x241)]='***';}_0x42ffe8=JSON['stringify'](_0x32a157,null,0x2);}if(_0x567b79[_0x283788(0x2bc)]==_0x283788(0x292)){const _0x5e355c=JSON[_0x283788(0x2e9)](_0x42ffe8);if(_0x5e355c[_0x283788(0x230)][_0x283788(0x2fc)])_0x5e355c['settings'][_0x283788(0x2fc)]=![];if(_0x5e355c[_0x283788(0x230)]['bbPassword'])_0x5e355c[_0x283788(0x230)][_0x283788(0x207)]='***';if(_0x5e355c[_0x283788(0x230)][_0x283788(0x2fe)])_0x5e355c[_0x283788(0x230)]['telegramToken']='***';if(_0x5e355c['settings'][_0x283788(0x25f)])_0x5e355c[_0x283788(0x230)][_0x283788(0x25f)]=null;_0x42ffe8=JSON[_0x283788(0x229)](_0x5e355c,null,0x2);}if(_0x567b79['name']!=_0x283788(0x1c2))_0x1dc8ec[_0x283788(0x1bf)](_0x567b79[_0x283788(0x2bc)],_0x42ffe8);}else _0x1dc8ec['file'](_0x567b79[_0x283788(0x2bc)],_0x42ffe8);}});const _0x4a488e=_0x1dc8ec['generate']({'base64':![],'compression':_0x417dba(0x2e4)});fs[_0x417dba(0x2c7)](zippath+(_0x705bc1+_0x417dba(0x359)),_0x4a488e,_0x417dba(0x2dd));}async function unzipFile(_0x1bfcff,_0x208121){const _0x50b3cf=_0x2cd832;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x50b3cf(0x399)](_0x5cda62=>{const _0x3174a1=_0x50b3cf;if(!_0x5cda62[_0x3174a1(0x291)]())fs['rmSync'](configpath+_0x5cda62['name']);});const _0x39d097=fs[_0x50b3cf(0x231)](_0x1bfcff+_0x208121,_0x50b3cf(0x2dd)),_0x2a9f42=new require(_0x50b3cf(0x216))(_0x39d097,{'base64':![],'checkCRC32':!![]});Object[_0x50b3cf(0x1fa)](_0x2a9f42['files'])['forEach'](_0x3b5004=>{const _0x35c96d=_0x50b3cf,_0xd528c6=_0x2a9f42[_0x35c96d(0x341)][_0x3b5004];fs['writeFileSync'](configpath+_0xd528c6['name'],_0xd528c6['_data']);}),fs[_0x50b3cf(0x225)](temppath,{'withFileTypes':!![]})[_0x50b3cf(0x399)](_0x3a4c7f=>{const _0x1b7b79=_0x50b3cf;if(!_0x3a4c7f[_0x1b7b79(0x291)]())fs[_0x1b7b79(0x2d9)](temppath+_0x3a4c7f[_0x1b7b79(0x2bc)]);}),logger['debug'](_0x50b3cf(0x37d)),process[_0x50b3cf(0x303)]({'restore':!![]},_0x4d4d46=>{});}async function getPublicIp(){const _0xac5161=_0x2cd832;try{const _0x5d7197=await axios[_0xac5161(0x223)](_0xac5161(0x2a0));publicip=_0x5d7197['data']['ip'];}catch(_0x12378c){}}async function triggerAnalytics(){const _0x2d0865=_0x2cd832;if(!publicip)await getPublicIp();const _0x71d025=getBotsWithMode();let _0x131a88=0x0;_0x71d025[_0x2d0865(0x399)](_0x52c1a7=>{const _0x3dbc2c=_0x2d0865;if(_0x52c1a7[_0x3dbc2c(0x3b8)]===_0x3dbc2c(0x33c))_0x131a88++;});const _0x650870=getBotExchanges();mixpanel[_0x2d0865(0x39d)](_0x2d0865(0x1d6),{'distinct_id':settings[_0x2d0865(0x31b)],'ip':publicip,'version':serverversion,'numbots':_0x71d025['length'],'numbotsenabled':_0x131a88,'exchanges':_0x650870,'environment':environment});}async function getMessages(){const _0x3a5415=_0x2cd832,_0x37bb87='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x3a9540=new GraphQLClient(_0x37bb87),_0xcdb117={'authorization':_0x3a5415(0x219)},_0x9beed2=serverversion['split']('.'),_0x32ccec=_0x9beed2[0x0]+'.'+_0x9beed2[0x1],_0xd1750e=Math[_0x3a5415(0x34b)](settings[_0x3a5415(0x271)],settings[_0x3a5415(0x200)]),_0x3c1c86={'last':parseInt(_0xd1750e),'bbm':_0x32ccec},_0x657c3e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x25b9d2;try{_0x25b9d2=await _0x3a9540[_0x3a5415(0x22c)](_0x657c3e,_0x3c1c86,_0xcdb117);}catch(_0x2f0d05){}if(_0x25b9d2&&_0x25b9d2[_0x3a5415(0x394)]){let _0x2474f2=settings['lastmsgtelegram'];newMessages=[];for(const _0x24f638 of _0x25b9d2[_0x3a5415(0x394)]){newMessages[_0x3a5415(0x3a3)](_0x24f638);let _0x474e8e=![];_0x24f638[_0x3a5415(0x214)]&&(updateSetting('latestversion',_0x24f638['bbvNew']),_0x474e8e=isNewerVersion(serverversion,_0x24f638[_0x3a5415(0x214)])||serverversion==_0x24f638[_0x3a5415(0x214)]);if(!_0x474e8e&&_0x24f638[_0x3a5415(0x2ab)]>_0x2474f2){if(_0x24f638[_0x3a5415(0x25a)]===_0x3a5415(0x1f3)||serverversion['startsWith'](_0x24f638[_0x3a5415(0x25a)])){let _0x19fbca=''+_0x24f638[_0x3a5415(0x28a)]+'\x0a\x0a'+_0x24f638[_0x3a5415(0x1b5)];const _0x4d6ad7=await sendTelegramMsg(toTelegramMarkdown(_0x19fbca),_0x3a5415(0x218));if(_0x4d6ad7)_0x2474f2=_0x24f638[_0x3a5415(0x2ab)];}}}updateAvailable=isNewerVersion(settings[_0x3a5415(0x22a)],serverversion),updateSetting(_0x3a5415(0x271),_0x2474f2),emitMessages();}}function emitMessages(){const _0x16352f=_0x2cd832,_0x56c6a5=settings[_0x16352f(0x200)];let _0x155912=[];newMessages['forEach'](_0xd2eb15=>{const _0x4622da=_0x16352f;_0xd2eb15[_0x4622da(0x2ab)]>_0x56c6a5&&_0x155912[_0x4622da(0x3a3)](_0xd2eb15);}),_0x155912['length']>0x0&&getAllClients()['forEach'](_0x31e73c=>{const _0x4731b8=_0x16352f;getSocket(_0x31e73c['id'])['emit'](_0x4731b8(0x1b5),_0x155912);});}function confirmMessage(_0x4364be){updateSetting('lastmsgemitted',Number(_0x4364be));}function isNewerVersion(_0x1fe522,_0x35473d){const _0x395bea=_0x35473d['split']('.'),_0x41a0c4=_0x1fe522['split']('.');for(var _0x19198c=0x0;_0x19198c<_0x41a0c4['length'];_0x19198c++){const _0x4b1baf=~~_0x41a0c4[_0x19198c],_0x459bbf=~~_0x395bea[_0x19198c];if(_0x4b1baf>_0x459bbf)return!![];if(_0x4b1baf<_0x459bbf)return![];}return![];}function toTelegramMarkdown(_0xeaac0d){const _0x5e6f9d=_0x2cd832,_0x3b0eca=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3b2abc=/\*{2}(.+?)\*{2}/gim;return _0xeaac0d=_0xeaac0d[_0x5e6f9d(0x2b5)](_0x3b0eca,_0x5e6f9d(0x266))[_0x5e6f9d(0x2b5)](_0x3b2abc,'*$1*'),_0xeaac0d;}async function validateConfigFile(){const _0x49605d=_0x2cd832,_0x1ef5dc=dbConfig[_0x49605d(0x223)](_0x49605d(0x1f5))[_0x49605d(0x3b0)](_0x49605d(0x1e4))[_0x49605d(0x272)]()||[];if(_0x1ef5dc[_0x49605d(0x1b9)]==0x0){let _0x1cea8a=0x0,_0x1f1ad7=[];const _0x29eebe=/^bot-([0-9]{3})-config.json$/,_0x201e59=fs[_0x49605d(0x225)](configpath);_0x201e59[_0x49605d(0x399)](_0x41a993=>{const _0x31dffd=_0x49605d,_0x5ab652=_0x29eebe['exec'](_0x41a993);if(_0x5ab652){const _0xee9560=_0x5ab652[0x1];let _0x3ad43f=getBotAttributes(_0xee9560);_0x1f1ad7[_0x31dffd(0x3a3)]({'botID':_0xee9560,'botname':_0x3ad43f['botname'],'status':_0x31dffd(0x389),'live':_0x31dffd(0x2f9)}),_0x1cea8a++;}}),_0x1cea8a!=0x0&&(dbConfig[_0x49605d(0x223)](_0x49605d(0x1f5))[_0x49605d(0x320)](_0x1f1ad7)[_0x49605d(0x255)](),config=_0x1f1ad7,restoredConfigFile=_0x1cea8a);}}async function restoreConfigNotify(_0x11c34f){const _0x1cbe66=_0x2cd832;let _0x32c068;if(restoredConfigFile==0x1)_0x32c068=_0x1cbe66(0x2a4);else _0x32c068=_0x1cbe66(0x2c1);if(_0x11c34f)io['to']('botmanager')[_0x1cbe66(0x2b6)](_0x1cbe66(0x298),_0x32c068);else{logger[_0x1cbe66(0x1d9)]('-----------------------------------------------------------------------------------'),logger[_0x1cbe66(0x1d9)](_0x32c068),logger[_0x1cbe66(0x1d9)](_0x1cbe66(0x336)),logger[_0x1cbe66(0x1d9)]('');if(tgBot&&settings[_0x1cbe66(0x25f)]&&settings['telegramEvents']!=_0x1cbe66(0x338))await sendTelegram(settings['telegramChatId'],_0x1cbe66(0x31e)+_0x32c068);}}function validateCredentials(_0x40c7c5,_0x33e83a){const _0x48c2fd=_0x2cd832;if(_0x40c7c5[_0x48c2fd(0x2a2)]==settings[_0x48c2fd(0x29f)]&&bcrypt[_0x48c2fd(0x362)](_0x40c7c5[_0x48c2fd(0x1b7)],settings[_0x48c2fd(0x207)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x48c2fd(0x27d),'token':null};else{const _0xe0b974=generateLoginToken(_0x33e83a);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xe0b974};}}else return{'allow':![],'reason':_0x48c2fd(0x1ee),'token':null};}function refreshToken(_0x325620){const _0x8b7d59=generateLoginToken(_0x325620);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x8b7d59};}function validateAccess(_0x378215,_0x2f6203,_0x1dbc73){const _0x50403f=_0x2cd832,_0x322ae7=_0x1dbc73?_0x1dbc73:devices[_0x2f6203]['ip'];let _0x74a7ed;const _0x42987f=_0x2be73a=>{const _0x201c18=_0x366b;if(settings['loginRequired']){if(settings[_0x201c18(0x1bc)]){if(telegram2FaApproved(_0x2f6203)){const _0x2cbb88=generateLoginToken(_0x2f6203);return{'allow':!![],'reason':_0x201c18(0x391),'token':_0x2cbb88};}else return{'allow':![],'reason':_0x201c18(0x3a0),'token':null};}else return _0x74a7ed=validToken(_0x2be73a,_0x2f6203),_0x74a7ed[_0x201c18(0x280)](_0x201c18(0x1f7))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x2be73a}:{'allow':![],'reason':_0x201c18(0x3a0),'token':null};}else return{'allow':!![],'reason':_0x201c18(0x247),'token':null};};if(settings[_0x50403f(0x35b)]){let _0x2a7192=[...settings['whitelist'],_0x50403f(0x373),'::ffff:127.0.0.1',_0x50403f(0x220)];if(_0x2a7192['includes'](_0x322ae7))return _0x42987f(_0x378215);else{_0x74a7ed=validToken(_0x378215,_0x2f6203);if(_0x74a7ed[_0x50403f(0x280)](_0x50403f(0x1f7)))return _0x42987f(_0x378215);else{if(telegramIpApproved(_0x2f6203)){const _0x4b40d5=generateToken(_0x2f6203);return _0x74a7ed=_0x42987f(_0x378215),_0x74a7ed[_0x50403f(0x2ca)]?{'allow':!![],'reason':_0x50403f(0x37e),'token':_0x4b40d5}:_0x74a7ed;}else return settings[_0x50403f(0x31d)]?{'allow':![],'reason':_0x50403f(0x29b),'token':null}:{'allow':![],'reason':_0x50403f(0x307),'token':null};}}}else return _0x42987f(_0x378215);}function timelyDecrypt(_0x54d094,_0x47df1d=!![]){const _0x37f962=_0x2cd832;if(_0x54d094)try{const _0x3ca415=crypt[_0x37f962(0x2b3)](secure[_0x37f962(0x2c8)],_0x54d094)['message'],_0x1a1d33=_0x3ca415[_0x37f962(0x366)]('@')[0x0],_0x2ef6a6=_0x3ca415[_0x37f962(0x366)]('@')[0x1],_0x54b0b4=new Date()[_0x37f962(0x232)]();if(_0x47df1d){if(_0x54b0b4-_0x2ef6a6<maxSecretAge*0x3e8)return _0x1a1d33;else return![];}else return _0x1a1d33;}catch(_0x5cfd53){return![];}else return![];}const validToken=(_0x153220,_0x120937)=>{const _0x286479=_0x2cd832,_0x471969=devices[_0x120937]['ip'];if(!_0x153220)return{'error':_0x286479(0x318)};for(let _0x1c95cb of blacklist){if(_0x1c95cb['token']==_0x153220)return{'error':_0x286479(0x235)};}let _0x3834b5;try{_0x3834b5=jwt[_0x286479(0x25d)](_0x153220,secure[_0x286479(0x39a)]+_0x120937);}catch{return{'error':_0x286479(0x1c7)};}if(!_0x3834b5[_0x286479(0x280)](_0x286479(0x21f))&&!_0x3834b5[_0x286479(0x280)](_0x286479(0x2a2))||!_0x3834b5['hasOwnProperty'](_0x286479(0x2d4)))return{'error':_0x286479(0x1b0)};if(!_0x3834b5[_0x286479(0x280)]('username')&&_0x3834b5[_0x286479(0x280)](_0x286479(0x21f))){const {clientip:_0x4af9c3}=_0x3834b5;return _0x471969==_0x4af9c3?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x286479(0x374)};}else{if(_0x3834b5[_0x286479(0x280)]('username')&&_0x3834b5[_0x286479(0x280)]('clientip')){const {username:_0x44ea80,clientip:_0x544b09}=_0x3834b5;return settings[_0x286479(0x29f)]==_0x44ea80&&_0x471969==_0x544b09?{'success':_0x286479(0x1f2)}:{'error':_0x286479(0x381)};}}},generateLoginToken=_0x4c6383=>{const _0x317067=_0x2cd832;if(_0x4c6383){const _0xc425ca=devices[_0x4c6383]['ip'];return jwt[_0x317067(0x2e1)]({'username':settings[_0x317067(0x29f)],'clientip':_0xc425ca},secure[_0x317067(0x39a)]+_0x4c6383,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x131691=>{const _0x31a315=_0x2cd832;if(_0x131691){const _0x3b6dce=devices[_0x131691]['ip'];return jwt[_0x31a315(0x2e1)]({'clientip':_0x3b6dce},secure[_0x31a315(0x39a)]+_0x131691,{'expiresIn':devices[_0x131691][_0x31a315(0x335)][_0x31a315(0x3a5)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xcf7f77=>{const _0x2259ff=_0x2cd832;let _0x219cb7=![];return devices[_0xcf7f77][_0x2259ff(0x335)]&&devices[_0xcf7f77][_0x2259ff(0x335)][_0x2259ff(0x3a5)]!='reject'&&(_0x219cb7=devices[_0xcf7f77][_0x2259ff(0x335)][_0x2259ff(0x21f)]==devices[_0xcf7f77]['ip']&&new Date()[_0x2259ff(0x232)]()-devices[_0xcf7f77]['telegramIpApproval']['timestamp']<devices[_0xcf7f77][_0x2259ff(0x335)][_0x2259ff(0x3a5)]*0x3c*0x3e8),_0x219cb7;},telegram2FaApproved=_0xd5aef5=>{const _0x1fe13c=_0x2cd832;let _0x3765b1=![];return devices[_0xd5aef5][_0x1fe13c(0x34d)]&&devices[_0xd5aef5]['telegram2FaApproval'][_0x1fe13c(0x3a5)]!='reject'&&(_0x3765b1=devices[_0xd5aef5]['telegram2FaApproval']['clientip']==devices[_0xd5aef5]['ip']&&new Date()[_0x1fe13c(0x232)]()-devices[_0xd5aef5][_0x1fe13c(0x34d)][_0x1fe13c(0x251)]<devices[_0xd5aef5][_0x1fe13c(0x34d)]['expiry']*0x3c*0x3e8),_0x3765b1;},normalizeIP=_0x596458=>{const _0x5cc545=_0x2cd832;let _0xaffeac=null,_0x5abea8=null;if(ipaddr['isValid'](_0x596458)){const _0x587d08=ipaddr['parse'](_0x596458);_0x587d08['kind']()===_0x5cc545(0x36c)?(_0x587d08['isIPv4MappedAddress']()&&(_0xaffeac=_0x587d08[_0x5cc545(0x2e8)]()[_0x5cc545(0x2d1)]()),_0x5abea8=_0x587d08[_0x5cc545(0x2d1)]()):(_0xaffeac=_0x587d08['toString'](),_0x5abea8=_0x587d08[_0x5cc545(0x310)]()[_0x5cc545(0x2d1)]());}return{'show':_0xaffeac?_0xaffeac:_0x5abea8,'store':_0x5abea8};};function formatDate(_0x165f95){const _0x5c24d9=_0x2cd832;return _0x165f95['getFullYear']()+'/'+(_0x165f95['getMonth']()+0x1)[_0x5c24d9(0x2d1)]()[_0x5c24d9(0x2e7)](0x2,'0')+'/'+_0x165f95[_0x5c24d9(0x363)]()['toString']()[_0x5c24d9(0x2e7)](0x2,'0')+'\x20'+_0x165f95[_0x5c24d9(0x30c)]()[_0x5c24d9(0x2d1)]()[_0x5c24d9(0x2e7)](0x2,'0')+':'+_0x165f95[_0x5c24d9(0x35f)]()[_0x5c24d9(0x2d1)]()[_0x5c24d9(0x2e7)](0x2,'0')+':'+_0x165f95['getSeconds']()[_0x5c24d9(0x2d1)]()['padStart'](0x2,'0');}function sleep(_0x2c0085){return new Promise(_0x531c3b=>setTimeout(_0x531c3b,_0x2c0085));}