const _0x319732=_0x5575;(function(_0x444d02,_0x5f066a){const _0x950d5c=_0x5575,_0x5c9aba=_0x444d02();while(!![]){try{const _0x2548e6=-parseInt(_0x950d5c(0x1c3))/0x1*(-parseInt(_0x950d5c(0x261))/0x2)+parseInt(_0x950d5c(0x253))/0x3+-parseInt(_0x950d5c(0x25c))/0x4+-parseInt(_0x950d5c(0x317))/0x5*(parseInt(_0x950d5c(0x322))/0x6)+parseInt(_0x950d5c(0x248))/0x7+-parseInt(_0x950d5c(0x324))/0x8*(-parseInt(_0x950d5c(0x338))/0x9)+-parseInt(_0x950d5c(0x2b4))/0xa;if(_0x2548e6===_0x5f066a)break;else _0x5c9aba['push'](_0x5c9aba['shift']());}catch(_0x157da0){_0x5c9aba['push'](_0x5c9aba['shift']());}}}(_0x2f62,0x9fc10));const _0x816504=function(){let _0x4d4501=!![];return function(_0x102180,_0x11bd06){const _0x20b12c=_0x4d4501?function(){const _0x24accf=_0x5575;if(_0x11bd06){const _0x3c2914=_0x11bd06[_0x24accf(0x240)](_0x102180,arguments);return _0x11bd06=null,_0x3c2914;}}:function(){};return _0x4d4501=![],_0x20b12c;};}(),_0x12eb80=_0x816504(this,function(){const _0x1fda46=_0x5575;return _0x12eb80[_0x1fda46(0x233)]()[_0x1fda46(0x228)]('(((.+)+)+)+$')[_0x1fda46(0x233)]()[_0x1fda46(0x2c0)](_0x12eb80)[_0x1fda46(0x228)](_0x1fda46(0x2b6));});_0x12eb80();'use strict';process[_0x319732(0x266)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x319732(0x2a4)),fs=require('fs'),fns=require(_0x319732(0x277)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x319732(0x336)),Crypt=require(_0x319732(0x307))[_0x319732(0x268)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x319732(0x2a8)),jwt=require(_0x319732(0x32e)),ipaddr=require(_0x319732(0x31b)),argv=require(_0x319732(0x25d))(process[_0x319732(0x263)][_0x319732(0x2fb)](0x2))[_0x319732(0x263)],uuidRandom=require('uuid-random'),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x319732(0x1ff)),axios=require(_0x319732(0x2e9)),{GraphQLClient,gql}=require(_0x319732(0x334)),util=require(_0x319732(0x2cf)),fileUpload=require(_0x319732(0x289)),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x319732(0x2f1)](PORT)&&(console[_0x319732(0x242)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x319732(0x2fe)),process[_0x319732(0x28e)](0x1));const HOST=argv[_0x319732(0x30c)]||null,userID=argv[_0x319732(0x333)]||'';let bbpath=_0x319732(0x259),bbpath2='';const botfile=_0x319732(0x337),configfile=_0x319732(0x2ec),settingsfile=_0x319732(0x2c5),securefile=_0x319732(0x23c);let validInstallation=!![];!fs[_0x319732(0x22b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x319732(0x294)+userID+'/':bbpath+_0x319732(0x294),configbackuppath=configpath+_0x319732(0x264),logspath=userID?bbpath+_0x319732(0x21f)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x319732(0x267),loggerfile=fs[_0x319732(0x223)](logspath+_0x319732(0x2c8),{'flags':'a'}),temppath=userID?bbpath+_0x319732(0x20a)+userID+'/':bbpath+_0x319732(0x20a);!fs[_0x319732(0x22b)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x319732(0x22b)](configbackuppath)&&fs[_0x319732(0x208)](configbackuppath);!fs[_0x319732(0x22b)](logspath)&&fs[_0x319732(0x208)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x319732(0x22b)](temppath)&&fs[_0x319732(0x208)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x319732(0x299)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x319732(0x2e0)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0'}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x319732(0x2e0)]({'secure':{},'blacklist':[]})[_0x319732(0x299)]();let crypt=new Crypt({'md':_0x319732(0x2f2),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x319732(0x320),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x319732(0x280)]&&settings[_0x319732(0x280)]!=''&&settings[_0x319732(0x205)]&&settings[_0x319732(0x205)]!='')initTelegram();const logger={'screen':_0x502319=>{const _0x341a0a=_0x319732;console[_0x341a0a(0x242)](_0x502319);},'simple':_0x14ea85=>{const _0x161f45=_0x319732;console['log'](_0x14ea85),loggerfile[_0x161f45(0x299)](util[_0x161f45(0x229)](_0x14ea85)+'\x0a');},'full':async _0xc43868=>{const _0x11d435=_0x319732,_0x3a6bf9=getTimeStamp()+_0x11d435(0x1c7)+_0xc43868;console[_0x11d435(0x242)](_0x3a6bf9),loggerfile[_0x11d435(0x299)](util[_0x11d435(0x229)](_0x3a6bf9)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x11d435(0x236))await tgBot[_0x11d435(0x201)](settings[_0x11d435(0x1aa)],_0x11d435(0x25e)+_0xc43868)[_0x11d435(0x1c4)](_0x194dc8=>{telegramError(_0x194dc8);});}};process['on'](_0x319732(0x2c9),function(_0x165016){const _0x4eaa17=_0x319732;logger[_0x4eaa17(0x27f)](_0x165016);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x319732(0x20f))[_0x319732(0x2f3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x319732(0x231)),app=express(),http=require(_0x319732(0x2ce))['createServer'](app);app[_0x319732(0x30b)](fileUpload({'useTempFiles':!![]})),app[_0x319732(0x282)](_0x319732(0x1e8),async(_0x305683,_0x47af2d)=>{const _0x1a21a4=_0x319732,_0xc719e3=_0x305683['params'][_0x1a21a4(0x2ae)],_0x2336f6=getClientsWithBotID(_0x1a21a4(0x1f7)),_0x365a6b=_0x305683[_0x1a21a4(0x2f8)][_0x1a21a4(0x1a9)],_0x14bb4e=timelyDecrypt(_0x365a6b,![]),_0x554fa4=_0x2336f6[_0x1a21a4(0x2e5)](_0x2a7803=>_0x2a7803['uuid']==_0x14bb4e);if(_0x554fa4){const _0x263aab=normalizeIP(_0x305683[_0x1a21a4(0x2ed)][_0x1a21a4(0x2b5)])[_0x1a21a4(0x279)],_0x108fec=_0x305683[_0x1a21a4(0x2f8)][_0x1a21a4(0x230)];if(validateAccess(_0x108fec,_0x14bb4e,_0x263aab)[_0x1a21a4(0x2d6)])await zipFiles(_0xc719e3),_0x47af2d[_0x1a21a4(0x2ee)](zippath+(_0xc719e3+_0x1a21a4(0x2eb)),_0x43b4b6=>{const _0x337d32=_0x1a21a4;_0x43b4b6&&(logger[_0x337d32(0x2ca)](_0x337d32(0x304)+_0xc719e3),logger[_0x337d32(0x27f)](_0x43b4b6));});else logger[_0x1a21a4(0x2ca)](_0x1a21a4(0x1f6)+_0xc719e3+_0x1a21a4(0x1ac));}else logger[_0x1a21a4(0x2ca)](_0x1a21a4(0x1f6)+_0xc719e3+_0x1a21a4(0x2a2));}),app['post'](_0x319732(0x28f),async(_0x5ce1d1,_0x39b03a)=>{const _0x1cb3ac=_0x319732,_0x20ed1e=getClientsWithBotID(_0x1cb3ac(0x1f7)),_0xfce320=_0x5ce1d1[_0x1cb3ac(0x2f8)]['uuid'],_0xa4ed63=timelyDecrypt(_0xfce320,![]),_0xa268fb=_0x20ed1e['find'](_0x24478d=>_0x24478d[_0x1cb3ac(0x1a9)]==_0xa4ed63);if(_0xa268fb){const _0x5876a2=normalizeIP(_0x5ce1d1[_0x1cb3ac(0x2ed)][_0x1cb3ac(0x2b5)])[_0x1cb3ac(0x279)],_0x581ef0=_0x5ce1d1[_0x1cb3ac(0x2f8)][_0x1cb3ac(0x230)];if(validateAccess(_0x581ef0,_0xa4ed63,_0x5876a2)[_0x1cb3ac(0x2d6)]){if(_0x5ce1d1['files']){const _0x207308=_0x5ce1d1[_0x1cb3ac(0x22a)]['backupfile'];await _0x207308['mv'](temppath+_0x207308['name']),_0x39b03a[_0x1cb3ac(0x232)]({'status':!![],'message':_0x1cb3ac(0x2bb)});const _0x8a9222=getBotsWithMode();_0x8a9222['length']>0x0?confirmRestore(temppath,_0x207308[_0x1cb3ac(0x2b9)]):unzipFile(temppath,_0x207308[_0x1cb3ac(0x2b9)]);}}else logger[_0x1cb3ac(0x2ca)](_0x1cb3ac(0x28b));}else logger[_0x1cb3ac(0x2ca)](_0x1cb3ac(0x28c));}),app[_0x319732(0x30b)](express[_0x319732(0x339)](path[_0x319732(0x32d)](__dirname,bbpath2,_0x319732(0x1e9)))),app[_0x319732(0x30b)](express['static'](path['join'](__dirname,bbpath2,_0x319732(0x2d5)))),app[_0x319732(0x282)]('/',function(_0x7fea50,_0x47cfd8){const _0xd94d23=_0x319732;_0x47cfd8[_0xd94d23(0x2c3)](path[_0xd94d23(0x32d)](__dirname,bbpath2,_0xd94d23(0x1e9),_0xd94d23(0x2c1)));}),app[_0x319732(0x282)](_0x319732(0x2bc),function(_0x46b7bd,_0xb5a794){const _0x44aaf6=_0x319732;_0xb5a794['sendFile'](path[_0x44aaf6(0x32d)](__dirname,bbpath2,_0x44aaf6(0x2d5),'index.html'));}),app[_0x319732(0x282)]('/:bot/portfolio',(_0x2625bd,_0x2e0e0c)=>{const _0x24f19b=_0x319732;_0x2e0e0c['sendFile'](path[_0x24f19b(0x32d)](__dirname,bbpath2,'build',_0x24f19b(0x2c1)));}),app[_0x319732(0x282)](_0x319732(0x1e2),(_0x302724,_0x12f235)=>{const _0x567f79=_0x319732;_0x12f235[_0x567f79(0x2c3)](path['join'](__dirname,bbpath2,_0x567f79(0x2d5),_0x567f79(0x2c1)));}),app[_0x319732(0x282)](_0x319732(0x2af),(_0x1e9636,_0x593897)=>{const _0x23c6ea=_0x319732;_0x593897[_0x23c6ea(0x2c3)](path[_0x23c6ea(0x32d)](__dirname,bbpath2,_0x23c6ea(0x2d5),_0x23c6ea(0x2c1)));}),app[_0x319732(0x282)]('/:bot/history',(_0x5404f5,_0x16aba9)=>{const _0x592e33=_0x319732;_0x16aba9[_0x592e33(0x2c3)](path[_0x592e33(0x32d)](__dirname,bbpath2,_0x592e33(0x2d5),_0x592e33(0x2c1)));}),app['get'](_0x319732(0x2f7),(_0x339bd4,_0x24d180)=>{const _0x4fbc60=_0x319732;_0x24d180[_0x4fbc60(0x2c3)](path[_0x4fbc60(0x32d)](__dirname,bbpath2,_0x4fbc60(0x2d5),'index.html'));}),app['get'](_0x319732(0x25f),(_0x363c3a,_0x29e72a)=>{const _0x5026dc=_0x319732;_0x29e72a[_0x5026dc(0x2c3)](path[_0x5026dc(0x32d)](__dirname,bbpath2,_0x5026dc(0x2d5),_0x5026dc(0x2c1)));});if(HOST)http[_0x319732(0x2a9)](PORT,HOST);else http[_0x319732(0x2a9)](PORT);const io=require(_0x319732(0x1b7))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x5468b0=_0x319732;logger[_0x5468b0(0x27f)](''),logger['simple'](_0x5468b0(0x2ab)),await logger[_0x5468b0(0x2ca)](_0x5468b0(0x257)+PORT),logger[_0x5468b0(0x27f)](_0x5468b0(0x2ab));if(config[_0x5468b0(0x2fd)]!=0x0)for(const _0x58f478 of config){if(_0x58f478[_0x5468b0(0x252)]==_0x5468b0(0x28a)||_0x58f478[_0x5468b0(0x252)]=='new')await logger[_0x5468b0(0x2ca)]('starting\x20bot\x20|\x20Bot\x20'+_0x58f478[_0x5468b0(0x2df)]+_0x5468b0(0x1c5)+_0x58f478[_0x5468b0(0x1f4)]),startBot([_0x58f478['botID'],userID],{'cwd':bbpath},function(_0x5e4b67){const _0x55a175=_0x5468b0;if(_0x5e4b67)logger[_0x55a175(0x2ca)](_0x5e4b67);});else(_0x58f478[_0x5468b0(0x252)]==_0x5468b0(0x24c)||_0x58f478['status']=='new-disabled')&&await logger[_0x5468b0(0x2ca)](_0x5468b0(0x1e7)+_0x58f478[_0x5468b0(0x2df)]+_0x5468b0(0x1c5)+_0x58f478['botname']);}else!newBot&&logger[_0x5468b0(0x27f)](_0x5468b0(0x31f));if(newBot)addBot();logger[_0x5468b0(0x27f)](_0x5468b0(0x2ab)),logger[_0x5468b0(0x27f)]('');}function startSocket(){io['on']('connection',_0x2ee7f1=>{const _0x528a27=_0x5575;let _0x380060,_0x454710,_0x46b410,_0x1dce63,_0x21500d;const _0x46ffdc=_0x2ee7f1[_0x528a27(0x1ce)][_0x528a27(0x2f8)][_0x528a27(0x1c2)];_0x454710=_0x46ffdc[_0x528a27(0x2e1)](/bot[0-9]{3}/);if(_0x454710)_0x46b410=_0x454710[0x0][_0x528a27(0x2e1)](/[0-9]{3}/);if(_0x46b410)_0x380060=_0x46b410[0x0];else _0x380060=_0x528a27(0x1f7);const _0x4bbdb5=_0x2ee7f1[_0x528a27(0x1ce)][_0x528a27(0x1fc)][_0x528a27(0x31a)];if(!_0x4bbdb5)_0x2ee7f1[_0x528a27(0x20d)](_0x528a27(0x252),{'publicKey':secure[_0x528a27(0x234)]});else{_0x1dce63=timelyDecrypt(_0x4bbdb5,![]);if(!_0x1dce63)_0x2ee7f1[_0x528a27(0x20d)](_0x528a27(0x252),{'publicKey':secure[_0x528a27(0x234)]});else{_0x21500d=normalizeIP(_0x2ee7f1[_0x528a27(0x1ea)][_0x528a27(0x2b5)])[_0x528a27(0x279)];if(!devices[_0x1dce63])devices[_0x1dce63]={'uuid':_0x1dce63,'access':{'token':null}};devices[_0x1dce63]['ip']=_0x21500d;const _0x1f623b=addClient(_0x2ee7f1['id'],_0x1dce63,_0x380060);setAccess(_0x1f623b),emitMessages(),_0x2ee7f1['on'](_0x528a27(0x2b3),_0x5a1535=>{const _0x31aca5=_0x528a27,_0x4b1fbb=timelyDecrypt(_0x5a1535[_0x31aca5(0x1cf)]);if(_0x4b1fbb){_0x5a1535={'username':_0x5a1535['username'],'password':_0x4b1fbb},devices[_0x1dce63][_0x31aca5(0x29b)]=validateCredentials(_0x5a1535,_0x1dce63);if(devices[_0x1dce63][_0x31aca5(0x29b)][_0x31aca5(0x2d6)]==![]&&devices[_0x1dce63][_0x31aca5(0x29b)][_0x31aca5(0x318)]==_0x31aca5(0x2b1))_0x2ee7f1['emit'](_0x31aca5(0x252),{'access':devices[_0x1dce63]['access']}),loginAccess2FA(_0x1dce63,_0x21500d);else{if(devices[_0x1dce63][_0x31aca5(0x29b)][_0x31aca5(0x2d6)]==![]&&devices[_0x1dce63][_0x31aca5(0x29b)]['reason']==_0x31aca5(0x325))_0x2ee7f1[_0x31aca5(0x20d)]('status',{'access':devices[_0x1dce63][_0x31aca5(0x29b)]});else devices[_0x1dce63][_0x31aca5(0x29b)]['allow']&&devices[_0x1dce63][_0x31aca5(0x29b)][_0x31aca5(0x318)]==_0x31aca5(0x1e0)&&(getClientsWithUuid(_0x1dce63)[_0x31aca5(0x274)](_0x207211=>{setAccess(_0x207211);}),setTokenRefresh(_0x1dce63),setSessionTimeout('login',_0x1dce63));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2ee7f1['on'](_0x528a27(0x200),()=>{resetPassword();}),_0x2ee7f1['on']('disconnect',_0x21f3b5=>{removeClient(_0x2ee7f1['id']);}),_0x380060=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5459e3){const _0x103326=_0x319732;if(_0x5459e3!=_0x103326(0x1f7)&&config['apiKey']!=''){if(pid[_0x5459e3])pid[_0x5459e3][_0x103326(0x232)]({'function':'initclient','args':null});}}function reloadBotManager(){const _0x5575f4=_0x319732;getClientsWithBotID(_0x5575f4(0x1f7))[_0x5575f4(0x274)](_0x152adf=>{const _0x3fc551=_0x5575f4;getSocket(_0x152adf['id'])[_0x3fc551(0x20d)](_0x3fc551(0x252),{'access':{'allow':![],'reason':_0x3fc551(0x1ab),'token':null}});});}function getSocket(_0x34272b){const _0x5544d9=_0x319732;return io[_0x5544d9(0x1b0)]['sockets']['get'](_0x34272b);}function setAccess(_0x5540a3){const _0x4ba80f=_0x319732,_0x817983=getSocket(_0x5540a3['id']),_0x311205=_0x5540a3[_0x4ba80f(0x1a9)],_0x1a0311=_0x5540a3[_0x4ba80f(0x308)];devices[_0x311205][_0x4ba80f(0x29b)]=validateAccess(devices[_0x311205][_0x4ba80f(0x29b)][_0x4ba80f(0x2a6)],_0x311205),_0x817983[_0x4ba80f(0x32d)](_0x311205);if(devices[_0x311205][_0x4ba80f(0x29b)]['allow']){_0x817983[_0x4ba80f(0x32d)](_0x1a0311);if(_0x1a0311==_0x4ba80f(0x1f7))initializeSocketBotManager(_0x817983);else initializeSocketBot(_0x817983);initClient(_0x1a0311);}devices[_0x311205]['access']['token']&&devices[_0x311205][_0x4ba80f(0x29b)][_0x4ba80f(0x318)]==_0x4ba80f(0x301)&&setSessionTimeout('2FA',_0x311205),devices[_0x311205][_0x4ba80f(0x29b)][_0x4ba80f(0x2a6)]&&devices[_0x311205][_0x4ba80f(0x29b)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x311205),_0x817983[_0x4ba80f(0x20d)]('status',{'status':_0x5540a3[_0x4ba80f(0x2a3)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x311205][_0x4ba80f(0x29b)],'externalip':devices[_0x311205]['ip'],'publicKey':secure[_0x4ba80f(0x234)],'userid':settings[_0x4ba80f(0x2ac)],'validInstallation':validInstallation}),devices[_0x311205][_0x4ba80f(0x29b)]['allow']==![]&&devices[_0x311205]['access']['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x311205,devices[_0x311205]['ip']);}function setSessionTimeout(_0x5b6305,_0x35a324){const _0x4cebfb=_0x319732;let _0x84fa76;if(_0x5b6305=='login')_0x84fa76=loginExpiry*0x3c*0x3e8;else _0x84fa76=devices[_0x35a324]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x35a324][_0x4cebfb(0x31c)][_0x4cebfb(0x1de)]);if(devices[_0x35a324][_0x4cebfb(0x275)])clearTimeout(devices[_0x35a324][_0x4cebfb(0x275)]);devices[_0x35a324][_0x4cebfb(0x275)]=setTimeout(()=>{const _0x184491=_0x4cebfb;if(devices[_0x35a324][_0x184491(0x217)])clearTimeout(devices[_0x35a324][_0x184491(0x217)]);removeSocketListeners(_0x35a324),addBlacklist(_0x35a324),devices[_0x35a324][_0x184491(0x31c)]=null,devices[_0x35a324][_0x184491(0x1c0)]=null,devices[_0x35a324]['access'][_0x184491(0x2a6)]=null,devices[_0x35a324]['access']=validateAccess(devices[_0x35a324][_0x184491(0x29b)][_0x184491(0x2a6)],_0x35a324),!(devices[_0x35a324][_0x184491(0x29b)][_0x184491(0x2d6)]&&devices[_0x35a324][_0x184491(0x29b)][_0x184491(0x318)]==_0x184491(0x300))&&(_0x5b6305=='login'?io['to'](_0x35a324)[_0x184491(0x20d)](_0x184491(0x252),{'access':{'allow':![],'reason':_0x184491(0x298),'token':null}}):io['to'](_0x35a324)[_0x184491(0x20d)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x35a324][_0x184491(0x29b)]['token']=null;},_0x84fa76);}function setTokenRefresh(_0x163997){const _0x458f6a=_0x319732;if(devices[_0x163997][_0x458f6a(0x217)])clearTimeout(devices[_0x163997][_0x458f6a(0x217)]);devices[_0x163997][_0x458f6a(0x217)]=setTimeout(()=>{const _0x36bae7=_0x458f6a;getClientsWithUuid(_0x163997)['length']!=0x0?(devices[_0x163997][_0x36bae7(0x29b)]=refreshToken(_0x163997),io['to'](_0x163997)[_0x36bae7(0x20d)](_0x36bae7(0x252),{'status':_0x36bae7(0x296),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x163997][_0x36bae7(0x29b)],'externalip':devices[_0x163997]['ip'],'publicKey':secure[_0x36bae7(0x234)],'validInstallation':validInstallation}),setTokenRefresh(_0x163997)):clearTimeout(devices[_0x163997][_0x36bae7(0x217)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3520d8){const _0x5b65f3=_0x319732,_0x466c2e=getClient(_0x3520d8['id'])[_0x5b65f3(0x1a9)];_0x3520d8[_0x5b65f3(0x20d)](_0x5b65f3(0x26a),config),_0x3520d8['emit'](_0x5b65f3(0x30a),cleanSettings()),_0x3520d8['on'](_0x5b65f3(0x1cb),_0x413751=>{const _0xbdafeb=_0x5b65f3;if(validateAccess(_0x413751,_0x466c2e)[_0xbdafeb(0x2d6)])addBot();else logger['full'](_0xbdafeb(0x1bf));}),_0x3520d8['on'](_0x5b65f3(0x2b0),(_0x3a66a1,_0x4aec12)=>{const _0x968082=_0x5b65f3;if(validateAccess(_0x4aec12,_0x466c2e)['allow'])toggleBot(_0x3a66a1['botID'],_0x3a66a1[_0x968082(0x252)],_0x3a66a1[_0x968082(0x288)]);else logger[_0x968082(0x2ca)](_0x968082(0x23a));}),_0x3520d8['on'](_0x5b65f3(0x1d6),(_0x262cdd,_0x3f65a7)=>{const _0x4b42ff=_0x5b65f3;if(validateAccess(_0x3f65a7,_0x466c2e)[_0x4b42ff(0x2d6)])toggleBotMode(_0x262cdd);else logger[_0x4b42ff(0x2ca)](_0x4b42ff(0x23a));}),_0x3520d8['on'](_0x5b65f3(0x2f9),(_0x10cbac,_0xf9cb2b)=>{const _0x81be95=_0x5b65f3;if(validateAccess(_0xf9cb2b,_0x466c2e)[_0x81be95(0x2d6)])deleteBot(_0x10cbac);else logger[_0x81be95(0x2ca)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x3520d8['on'](_0x5b65f3(0x2e8),(_0x1f02a6,_0x30c556)=>{const _0x1457f6=_0x5b65f3;if(validateAccess(_0x30c556,_0x466c2e)['allow'])storeSettings(_0x1f02a6,!![]);else logger[_0x1457f6(0x2ca)](_0x1457f6(0x1e5));}),_0x3520d8['on']('update-bb',_0x3e6825=>{const _0x211c6f=_0x5b65f3;if(validateAccess(_0x3e6825,_0x466c2e)['allow'])updateBB();else logger[_0x211c6f(0x2ca)](_0x211c6f(0x2e6));}),_0x3520d8['on']('get-messages',_0x408768=>{const _0x1525b0=_0x5b65f3;if(validateAccess(_0x408768,_0x466c2e)[_0x1525b0(0x2d6)])getMessages();else logger[_0x1525b0(0x2ca)](_0x1525b0(0x310));}),_0x3520d8['on'](_0x5b65f3(0x321),(_0x3155ac,_0x4791a8)=>{const _0x1a3a7d=_0x5b65f3;if(validateAccess(_0x4791a8,_0x466c2e)[_0x1a3a7d(0x2d6)])confirmMessage(_0x3155ac);else logger[_0x1a3a7d(0x2ca)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3520d8['on'](_0x5b65f3(0x1ba),_0x4be721=>{const _0xf50465=_0x5b65f3;if(validateAccess(_0x4be721,_0x466c2e)[_0xf50465(0x2d6)]){if(devices[_0x466c2e][_0xf50465(0x217)])clearTimeout(devices[_0x466c2e][_0xf50465(0x217)]);if(devices[_0x466c2e][_0xf50465(0x275)])clearTimeout(devices[_0x466c2e][_0xf50465(0x275)]);removeSocketListeners(getClient(_0x3520d8['id'])[_0xf50465(0x1a9)]),addBlacklist(_0x466c2e),devices[_0x466c2e]['telegramIpApproval']=null,devices[_0x466c2e]['telegram2FaApproval']=null,devices[_0x466c2e][_0xf50465(0x29b)]['token']=null,io['to'](getClient(_0x3520d8['id'])[_0xf50465(0x1a9)])['emit'](_0xf50465(0x252),{'access':{'allow':![],'reason':_0xf50465(0x249),'token':null}});}else logger[_0xf50465(0x2ca)](_0xf50465(0x2dd));});}function initializeSocketBot(_0x50c9f1){const _0x41aa8a=_0x319732,_0x4eec23=getClient(_0x50c9f1['id'])[_0x41aa8a(0x308)],_0x47455a=getClient(_0x50c9f1['id'])[_0x41aa8a(0x1a9)];_0x50c9f1['on'](_0x41aa8a(0x1f3),(_0x5b7210,_0x2afdab)=>{const _0x249510=_0x41aa8a;if(validateAccess(_0x2afdab,_0x47455a)['allow']){if(pid[_0x4eec23])pid[_0x4eec23][_0x249510(0x232)]({'function':'emitHistory','args':_0x5b7210});}else logger[_0x249510(0x2ca)](_0x249510(0x1d4));}),_0x50c9f1['on'](_0x41aa8a(0x214),(_0x4a9f80,_0x349d46)=>{const _0x17a964=_0x41aa8a;if(validateAccess(_0x349d46,_0x47455a)[_0x17a964(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23]['send']({'function':_0x17a964(0x1be),'args':_0x4a9f80});}else logger[_0x17a964(0x2ca)](_0x17a964(0x290));}),_0x50c9f1['on'](_0x41aa8a(0x2b7),(_0x56d2cf,_0x4ee7bb)=>{const _0x519f65=_0x41aa8a;if(validateAccess(_0x4ee7bb,_0x47455a)[_0x519f65(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23][_0x519f65(0x232)]({'function':_0x519f65(0x2a1),'args':_0x56d2cf});}else logger[_0x519f65(0x2ca)](_0x519f65(0x2b2));}),_0x50c9f1['on'](_0x41aa8a(0x218),(_0xf3d6c4,_0x361145)=>{const _0x309ff9=_0x41aa8a;if(validateAccess(_0x361145,_0x47455a)[_0x309ff9(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23]['send']({'function':_0x309ff9(0x32c),'args':_0xf3d6c4});}else logger[_0x309ff9(0x2ca)](_0x309ff9(0x1bc));}),_0x50c9f1['on'](_0x41aa8a(0x23e),(_0xeeb9f2,_0xc244dd)=>{const _0x563538=_0x41aa8a;if(validateAccess(_0xc244dd,_0x47455a)[_0x563538(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23][_0x563538(0x232)]({'function':_0x563538(0x2d4),'args':_0xeeb9f2});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x50c9f1['on'](_0x41aa8a(0x241),_0x1d05d9=>{const _0x2b9e4a=_0x41aa8a;if(validateAccess(_0x1d05d9,_0x47455a)[_0x2b9e4a(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23][_0x2b9e4a(0x232)]({'function':_0x2b9e4a(0x207),'args':null});}else logger[_0x2b9e4a(0x2ca)](_0x2b9e4a(0x29f));}),_0x50c9f1['on']('place-order',(_0x5c069e,_0x27ed8c)=>{const _0x3f69ee=_0x41aa8a;if(validateAccess(_0x27ed8c,_0x47455a)[_0x3f69ee(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23][_0x3f69ee(0x232)]({'function':'placeOrder','args':_0x5c069e});}else logger[_0x3f69ee(0x2ca)](_0x3f69ee(0x291));}),_0x50c9f1['on'](_0x41aa8a(0x2da),_0xdc27d7=>{const _0x412fbc=_0x41aa8a;if(validateAccess(_0xdc27d7,_0x47455a)[_0x412fbc(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23][_0x412fbc(0x232)]({'function':_0x412fbc(0x29a),'args':null});}else logger[_0x412fbc(0x2ca)](_0x412fbc(0x2ad));}),_0x50c9f1['on'](_0x41aa8a(0x314),_0x1edfff=>{const _0x28b440=_0x41aa8a;if(validateAccess(_0x1edfff,_0x47455a)[_0x28b440(0x2d6)]){if(pid[_0x4eec23])pid[_0x4eec23][_0x28b440(0x232)]({'function':_0x28b440(0x239),'args':null});}else logger[_0x28b440(0x2ca)](_0x28b440(0x21d));}),_0x50c9f1['on']('update-bb',_0x41c75e=>{const _0x39bac4=_0x41aa8a;if(validateAccess(_0x41c75e,_0x47455a)[_0x39bac4(0x2d6)])updateBB();else logger[_0x39bac4(0x2ca)](_0x39bac4(0x2e6));}),_0x50c9f1['on'](_0x41aa8a(0x235),_0x460464=>{const _0x508455=_0x41aa8a;if(validateAccess(_0x460464,_0x47455a)[_0x508455(0x2d6)])getMessages();else logger['full'](_0x508455(0x310));}),_0x50c9f1['on'](_0x41aa8a(0x321),(_0x4be669,_0x37ab6b)=>{const _0xd5a3f8=_0x41aa8a;if(validateAccess(_0x37ab6b,_0x47455a)[_0xd5a3f8(0x2d6)])confirmMessage(_0x4be669);else logger[_0xd5a3f8(0x2ca)](_0xd5a3f8(0x22d));}),_0x50c9f1['on'](_0x41aa8a(0x1ba),_0x199fcf=>{const _0x53d49a=_0x41aa8a;if(validateAccess(_0x199fcf,_0x47455a)[_0x53d49a(0x2d6)]){if(devices[_0x47455a][_0x53d49a(0x217)])clearTimeout(devices[_0x47455a][_0x53d49a(0x217)]);if(devices[_0x47455a]['pidExpireLogin'])clearTimeout(devices[_0x47455a][_0x53d49a(0x275)]);removeSocketListeners(getClient(_0x50c9f1['id'])[_0x53d49a(0x1a9)]),addBlacklist(_0x47455a),devices[_0x47455a][_0x53d49a(0x31c)]=null,devices[_0x47455a][_0x53d49a(0x1c0)]=null,devices[_0x47455a][_0x53d49a(0x29b)]['token']=null,io['to'](getClient(_0x50c9f1['id'])[_0x53d49a(0x1a9)])[_0x53d49a(0x20d)](_0x53d49a(0x252),{'access':{'allow':![],'reason':_0x53d49a(0x249),'token':null}});}else logger[_0x53d49a(0x2ca)](_0x53d49a(0x2dd));});}function removeSocketListeners(_0x4256e0){const _0x5b7068=_0x319732;getClientsWithUuid(_0x4256e0)[_0x5b7068(0x274)](_0x1b9d3b=>{getSocket(_0x1b9d3b['id'])['removeAllListeners']();});}function cleanSettings(){const _0x568c11=_0x319732;let _0x76a53c=settings;return settings[_0x568c11(0x280)]&&settings['telegramToken']!=''&&(_0x76a53c={..._0x76a53c,'telegramToken':_0x568c11(0x23f)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x76a53c={..._0x76a53c,'bbPassword':_0x568c11(0x23f)}),(settings[_0x568c11(0x2a7)]&&settings[_0x568c11(0x2a7)]=='***'||settings['telegramToken']&&settings[_0x568c11(0x280)]==_0x568c11(0x312))&&(_0x76a53c={..._0x76a53c,'restored':{'password':settings[_0x568c11(0x2a7)]==_0x568c11(0x312),'telegram':settings[_0x568c11(0x280)]==_0x568c11(0x312)}}),_0x76a53c;}function updateBB(){const _0x599f48=_0x319732;installingUpdate=!![],config[_0x599f48(0x274)](_0x26fefe=>{const _0x5aadff=_0x599f48;restartBot(_0x26fefe[_0x5aadff(0x2df)]);}),process['send']({'update':!![]},_0x482a50=>{});}function startBot(_0xb1857a,_0x9fc1be,_0x4d4130){const _0x21b1d0=_0x319732;let _0x434844=![];const _0x16855d=_0xb1857a[0x0];_0x9fc1be={..._0x9fc1be,'stdio':[_0x21b1d0(0x251),'inherit',_0x21b1d0(0x251),_0x21b1d0(0x2db)]},pid[_0x16855d]=childProcess['fork'](botfile,_0xb1857a,_0x9fc1be),pid[_0x16855d]['on'](_0x21b1d0(0x283),_0x1cbd4e=>{const _0x3493d8=_0x21b1d0;switch(Object[_0x3493d8(0x281)](_0x1cbd4e)[0x0]){case _0x3493d8(0x1f4):updateBotName(_0x16855d,_0x1cbd4e[_0x3493d8(0x1f4)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x16855d,_0x1cbd4e['status']);break;case _0x3493d8(0x288):updateLive(_0x16855d,_0x1cbd4e[_0x3493d8(0x288)]);break;case _0x3493d8(0x247):updateLive(_0x16855d,_0x1cbd4e[_0x3493d8(0x247)]),io['to'](_0x16855d)[_0x3493d8(0x20d)](_0x3493d8(0x252),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3493d8(0x1b8):_0x1cbd4e[_0x3493d8(0x1b8)]==_0x3493d8(0x2d0)&&restartBot(_0x16855d);_0x1cbd4e[_0x3493d8(0x1b8)]==_0x3493d8(0x2bf)&&toggleBot(_0x16855d,'disabled','stopped');break;case _0x3493d8(0x258):sendTelegram(_0x16855d,_0x1cbd4e[_0x3493d8(0x258)]);break;case _0x3493d8(0x1e6):sendTelegramMsg(_0x1cbd4e['telegrammsg']);break;case _0x3493d8(0x295):io['to'](_0x16855d)[_0x3493d8(0x20d)](_0x1cbd4e[_0x3493d8(0x295)],_0x1cbd4e[_0x3493d8(0x1ef)]);break;}}),pid[_0x16855d]['on'](_0x21b1d0(0x209),function(_0x2b7435){if(_0x434844)return;_0x434844=!![],_0x4d4130(_0x2b7435);}),pid[_0x16855d]['on'](_0x21b1d0(0x28e),async function(_0x1e44ee){const _0x3e844c=_0x21b1d0;if(installingUpdate)return;if(_0x434844)return;_0x434844=!![],_0x4d4130(null);const _0x1156c6=dbConfig[_0x3e844c(0x282)]('bots')[_0x3e844c(0x2e5)]({'botID':_0x16855d})[_0x3e844c(0x2dc)]();_0x1156c6&&(_0x1156c6[_0x3e844c(0x252)]==_0x3e844c(0x28a)||_0x1156c6['status']=='new')&&(await sleep(0x3e8),updateLive(_0x16855d,_0x3e844c(0x33a)),logger[_0x3e844c(0x2ca)](_0x3e844c(0x1ed)+_0x16855d),startBot([_0x16855d,userID],{'cwd':bbpath},function(_0x4d2c73){const _0x467fc2=_0x3e844c;if(_0x4d2c73)logger[_0x467fc2(0x2ca)](_0x4d2c73);}));});}function stopBot(_0x5f5681){const _0x219ec1=_0x319732;getClientsWithBotID(_0x5f5681)[_0x219ec1(0x274)](_0x1c9ebf=>{getSocket(_0x1c9ebf['id'])['disconnect'](!![]),removeClient(_0x1c9ebf['id']);}),pid[_0x5f5681]&&(pid[_0x5f5681]['kill'](),pid[_0x5f5681]=null);}function restartBot(_0x158e75){if(pid[_0x158e75])pid[_0x158e75]['kill']();}function addBot(){const _0x4a3247=_0x319732;let _0x5d8d05;for(let _0x28fdb8=0x1;_0x28fdb8<0x3e9;_0x28fdb8++){_0x5d8d05=_0x28fdb8[_0x4a3247(0x233)]()['padStart'](0x3,'0');let _0x436e73=config[_0x4a3247(0x2e5)](_0x4a2e06=>_0x4a2e06[_0x4a3247(0x2df)]==_0x5d8d05);if(!_0x436e73)break;}if(_0x5d8d05===_0x4a3247(0x202)){logger[_0x4a3247(0x2ca)]('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full']('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x5d8d05),dbConfig[_0x4a3247(0x282)](_0x4a3247(0x26a))[_0x4a3247(0x2d3)]({'botID':_0x5d8d05,'botname':_0x4a3247(0x27a)+_0x5d8d05,'status':_0x4a3247(0x1fe),'live':''})[_0x4a3247(0x299)](),startBot([_0x5d8d05,userID],{'cwd':bbpath},function(_0x31a238){const _0x2ca425=_0x4a3247;if(_0x31a238)logger[_0x2ca425(0x2ca)](_0x31a238);}),config=getConfiguration(),io['to']('botmanager')[_0x4a3247(0x20d)](_0x4a3247(0x26a),config);}function deleteBot(_0x23e82a){const _0x458276=_0x319732;getClientsWithBotID(_0x23e82a)[_0x458276(0x274)](_0x541cc2=>{const _0x34a7b9=_0x458276;getSocket(_0x541cc2['id'])[_0x34a7b9(0x27d)](!![]),removeClient(_0x541cc2['id']);}),dbConfig[_0x458276(0x282)](_0x458276(0x26a))[_0x458276(0x1d3)]({'botID':_0x23e82a})[_0x458276(0x299)](),logger[_0x458276(0x2ca)](_0x458276(0x23d)+_0x23e82a),stopBot(_0x23e82a);try{fs[_0x458276(0x22c)](path[_0x458276(0x32d)](configpath,_0x458276(0x1ee)+_0x23e82a+_0x458276(0x22e))),fs['unlinkSync'](path[_0x458276(0x32d)](configpath,_0x458276(0x1ee)+_0x23e82a+'-events.json')),fs['unlinkSync'](path[_0x458276(0x32d)](configpath,_0x458276(0x1ee)+_0x23e82a+_0x458276(0x271))),fs[_0x458276(0x22c)](path['join'](configpath,_0x458276(0x1ee)+_0x23e82a+'-results.json'));}catch(_0x11021c){if(_0x11021c)logger[_0x458276(0x2ca)]('error\x20while\x20deleting\x20config\x20files:\x20',_0x11021c);}config=getConfiguration(),io['to'](_0x458276(0x1f7))[_0x458276(0x20d)](_0x458276(0x26a),config);}function toggleBot(_0x3f5e1b,_0x5cd5ee,_0x283bdc){const _0x1c35c3=_0x319732;dbConfig[_0x1c35c3(0x282)](_0x1c35c3(0x26a))[_0x1c35c3(0x2e5)]({'botID':_0x3f5e1b})[_0x1c35c3(0x22f)]({'status':_0x5cd5ee})[_0x1c35c3(0x22f)]({'live':_0x283bdc})['write']();if(_0x5cd5ee==_0x1c35c3(0x28a)||_0x5cd5ee==_0x1c35c3(0x1fe))logger[_0x1c35c3(0x2ca)](_0x1c35c3(0x33d)+_0x3f5e1b),startBot([_0x3f5e1b,userID],{'cwd':bbpath},function(_0x432c3a){const _0x664e2d=_0x1c35c3;if(_0x432c3a)logger[_0x664e2d(0x2ca)](_0x432c3a);});else(_0x5cd5ee==_0x1c35c3(0x24c)||_0x5cd5ee=='new-disabled')&&(logger[_0x1c35c3(0x2ca)](_0x1c35c3(0x2d2)+_0x3f5e1b),stopBot(_0x3f5e1b));config=getConfiguration(),io['to'](_0x1c35c3(0x1f7))[_0x1c35c3(0x20d)](_0x1c35c3(0x26a),config);}function toggleStatus(_0x38e5dd){const _0xa68f85=_0x319732;let _0x559ddc=dbConfig[_0xa68f85(0x282)]('bots')[_0xa68f85(0x2e5)]({'botID':_0x38e5dd})[_0xa68f85(0x2dc)](),_0x183168;if(_0x559ddc[_0xa68f85(0x252)]===_0xa68f85(0x28a))_0x183168='disabled';else{if(_0x559ddc[_0xa68f85(0x252)]==='new')_0x183168=_0xa68f85(0x273);else{if(_0x559ddc[_0xa68f85(0x252)]===_0xa68f85(0x273))_0x183168=_0xa68f85(0x1fe);else{if(_0x559ddc[_0xa68f85(0x252)]===_0xa68f85(0x24c))_0x183168='enabled';}}}return _0x183168;}function updateStatus(_0x5da304,_0xb95676){const _0xd7c524=_0x319732;dbConfig[_0xd7c524(0x282)]('bots')['find']({'botID':_0x5da304})[_0xd7c524(0x22f)]({'status':_0xb95676})[_0xd7c524(0x299)](),config=getConfiguration(),io['to'](_0xd7c524(0x1f7))[_0xd7c524(0x20d)]('bots',config);}function updateLive(_0x486ace,_0x82a616){const _0x543d2d=_0x319732;dbConfig[_0x543d2d(0x282)]('bots')['find']({'botID':_0x486ace})[_0x543d2d(0x22f)]({'live':_0x82a616})[_0x543d2d(0x299)](),config=getConfiguration(),io['to'](_0x543d2d(0x1f7))[_0x543d2d(0x20d)]('bots',config);}function updateBotName(_0x271084,_0x4befea){const _0x2a0e16=_0x319732;dbConfig[_0x2a0e16(0x282)](_0x2a0e16(0x26a))[_0x2a0e16(0x2e5)]({'botID':_0x271084})[_0x2a0e16(0x22f)]({'botname':_0x4befea})[_0x2a0e16(0x299)](),config=getConfiguration(),io['to'](_0x2a0e16(0x1f7))[_0x2a0e16(0x20d)](_0x2a0e16(0x26a),config);}function updateBotManager(){const _0x20cab0=_0x319732;config=getConfiguration(),io['to']('botmanager')[_0x20cab0(0x20d)](_0x20cab0(0x26a),config);}function toggleBotMode(_0x5f280f){const _0x1b6491=_0x319732;if(pid[_0x5f280f])pid[_0x5f280f][_0x1b6491(0x232)]({'function':'toggleBotMode','args':null});else{const _0x20fd30=configpath+_0x1b6491(0x1ee)+_0x5f280f+_0x1b6491(0x22e),_0x186bb7=fs[_0x1b6491(0x1b6)](_0x20fd30),_0x15b80e=JSON[_0x1b6491(0x1cd)](_0x186bb7),_0x424cb8=_0x15b80e['bot'][0x0][_0x1b6491(0x293)];_0x15b80e['bot'][0x0][_0x1b6491(0x293)]=!_0x424cb8;const _0x2c59a4=JSON[_0x1b6491(0x27c)](_0x15b80e,null,0x2);fs[_0x1b6491(0x269)](_0x20fd30,_0x2c59a4),config=getConfiguration(),io['to']('botmanager')[_0x1b6491(0x20d)]('bots',config);}}function telegramError(_0x305142){const _0x4b190b=_0x319732;logger['simple'](getTimeStamp()+_0x4b190b(0x256));}function validateTelegram(_0x5accee){const _0x4f2ba9=_0x319732;if(_0x5accee[_0x4f2ba9(0x2fc)][_0x4f2ba9(0x255)]!=settings['telegramUsername']&&'@'+_0x5accee[_0x4f2ba9(0x2fc)][_0x4f2ba9(0x255)]!=settings['telegramUsername'])return tgBot[_0x4f2ba9(0x201)](_0x5accee['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x4f2ba9(0x1d5)})[_0x4f2ba9(0x1c4)](_0x1b1c26=>{telegramError(_0x1b1c26);}),![];return!![];}async function initTelegram(){const _0x3009b3=_0x319732;if(tgBot)tgBot[_0x3009b3(0x1a7)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x3009b3(0x280)],{'polling':!![]});let _0x50bc89=_0x3009b3(0x2d7);_0x50bc89+='\x0a',_0x50bc89+='/enable\x20-\x20enable\x20notifications\x0a',_0x50bc89+=_0x3009b3(0x245),_0x50bc89+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x50bc89+=_0x3009b3(0x1ae),_0x50bc89+='/on\x20-\x20start\x20bot(s)\x0a',_0x50bc89+='/off\x20-\x20stop\x20bot(s)\x0a',_0x50bc89+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x50bc89+='/names\x20-\x20show\x20bot\x20names\x0a',_0x50bc89+=_0x3009b3(0x27e),_0x50bc89+=_0x3009b3(0x30d),_0x50bc89+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x50bc89+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x26f23a='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x26f23a+='\x0a',_0x26f23a+=_0x50bc89,tgBot[_0x3009b3(0x33b)](/\/start/,_0x388e8a=>{const _0x1414b9=_0x3009b3;if(!validateTelegram(_0x388e8a))return;if(settings[_0x1414b9(0x1aa)]!=_0x388e8a[_0x1414b9(0x1c1)]['id'])updateSetting(_0x1414b9(0x1aa),_0x388e8a[_0x1414b9(0x1c1)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x1414b9(0x201)](_0x388e8a[_0x1414b9(0x1c1)]['id'],_0x26f23a)[_0x1414b9(0x1c4)](_0x3539e7=>{telegramError(_0x3539e7);});}),tgBot[_0x3009b3(0x33b)](/\/enable/,_0x49555d=>{const _0xa816c2=_0x3009b3;if(!validateTelegram(_0x49555d))return;if(settings[_0xa816c2(0x1aa)]!=_0x49555d[_0xa816c2(0x1c1)]['id'])updateSetting(_0xa816c2(0x1aa),_0x49555d['chat']['id']);updateSetting(_0xa816c2(0x1fb),!![]),tgBot[_0xa816c2(0x201)](_0x49555d['chat']['id'],_0xa816c2(0x2d8))[_0xa816c2(0x1c4)](_0x491d96=>{telegramError(_0x491d96);});}),tgBot['onText'](/\/config/,async _0x7ffb8d=>{const _0x392b9d=_0x3009b3;if(!validateTelegram(_0x7ffb8d))return;tgBot[_0x392b9d(0x25a)](_0x392b9d(0x1a6)),tgBot[_0x392b9d(0x201)](_0x7ffb8d[_0x392b9d(0x1c1)]['id'],_0x392b9d(0x206),{'reply_markup':{'inline_keyboard':[[{'text':_0x392b9d(0x1bd),'callback_data':_0x392b9d(0x236)},{'text':_0x392b9d(0x2ea),'callback_data':'alerts'},{'text':_0x392b9d(0x2fa),'callback_data':_0x392b9d(0x1cc)}]]}})[_0x392b9d(0x1c4)](_0x36ab78=>{telegramError(_0x36ab78);}),tgBot['on']('callback_query',async _0x3633da=>{const _0x592346=_0x392b9d,_0x12c3a0=_0x3633da['data'],_0x13b5d8=_0x3633da[_0x592346(0x283)];tgBot[_0x592346(0x24b)](_0x3633da['id'])[_0x592346(0x326)](async()=>{const _0x3de972=_0x592346;_0x12c3a0==_0x3de972(0x236)&&(updateSetting(_0x3de972(0x1a3),_0x3de972(0x236)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x13b5d8['chat']['id'],_0x3de972(0x21b))[_0x3de972(0x1c4)](_0x50947f=>{telegramError(_0x50947f);}));_0x12c3a0==_0x3de972(0x211)&&(updateSetting(_0x3de972(0x1a3),'alerts'),updateSetting(_0x3de972(0x1fb),!![]),await tgBot[_0x3de972(0x201)](_0x13b5d8['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x3de972(0x1c4)](_0x254901=>{telegramError(_0x254901);}));_0x12c3a0==_0x3de972(0x1cc)&&(updateSetting(_0x3de972(0x1a3),_0x3de972(0x1cc)),updateSetting('telegramEnabled',!![]),await tgBot[_0x3de972(0x201)](_0x13b5d8[_0x3de972(0x1c1)]['id'],_0x3de972(0x24f))[_0x3de972(0x1c4)](_0x518321=>{telegramError(_0x518321);}));if(!settings['telegramChatId'])tgBot[_0x3de972(0x201)](_0x13b5d8[_0x3de972(0x1c1)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x3de972(0x1c4)](_0x1bea05=>{telegramError(_0x1bea05);});}),tgBot[_0x592346(0x25a)](_0x592346(0x1a6));});}),tgBot['onText'](/\/status/,_0x4c4e7e=>{const _0x2bc3e2=_0x3009b3;if(!validateTelegram(_0x4c4e7e))return;const _0x59af08=getBotsWithMode();let _0x5016f5=_0x2bc3e2(0x1c9);config[_0x2bc3e2(0x274)](_0x5e1545=>{const _0x128694=_0x2bc3e2,_0x4db5b5=_0x59af08[_0x128694(0x2e5)](_0x2ed13f=>_0x2ed13f[_0x128694(0x2df)]==_0x5e1545[_0x128694(0x2df)])[_0x128694(0x1a2)];_0x5016f5+=_0x128694(0x27a)+_0x5e1545[_0x128694(0x2df)]+':\x20'+_0x5e1545['status']+'\x20|\x20'+_0x4db5b5+_0x128694(0x1c5)+_0x5e1545[_0x128694(0x288)]+'\x0a';}),_0x5016f5+='\x0a',_0x5016f5+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x5016f5+=!settings[_0x2bc3e2(0x1fb)]?_0x2bc3e2(0x302):_0x2bc3e2(0x203),_0x5016f5+=settings['telegramEnabled']?settings[_0x2bc3e2(0x1a3)]==_0x2bc3e2(0x1cc)?_0x2bc3e2(0x2c4):_0x2bc3e2(0x1b2)+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0x2bc3e2(0x201)](_0x4c4e7e['chat']['id'],_0x5016f5,{'parse_mode':_0x2bc3e2(0x1d5)})[_0x2bc3e2(0x1c4)](_0x47caef=>{telegramError(_0x47caef);});}),tgBot[_0x3009b3(0x33b)](/\/restart/,_0x32ef67=>{const _0x216aab=_0x3009b3;if(!validateTelegram(_0x32ef67))return;tgBot[_0x216aab(0x25a)]('callback_query');const _0x417c8c=getEnabledBots();if(_0x417c8c[_0x216aab(0x2fd)]==0x0)tgBot['sendMessage'](_0x32ef67[_0x216aab(0x1c1)]['id'],_0x216aab(0x244))[_0x216aab(0x1c4)](_0x411af0=>{telegramError(_0x411af0);});else{if(_0x417c8c[_0x216aab(0x2fd)]>0x1)_0x417c8c[_0x216aab(0x2d3)]({'botID':'all'});let _0x391873=[],_0x13e773=[];const _0x285120=_0x417c8c[_0x216aab(0x2fd)]%0x4==0x0||_0x417c8c[_0x216aab(0x2fd)]%0x4==0x3||_0x417c8c['length']%0x3==0x1?0x4:0x3;let _0x5a9bb5=0x0;_0x417c8c[_0x216aab(0x274)]((_0x59e7a5,_0x27fb39)=>{const _0x1bb249=_0x216aab;if(_0x27fb39%_0x285120==0x0)_0x13e773=[];_0x13e773[_0x1bb249(0x2d3)]({'text':_0x59e7a5[_0x1bb249(0x2df)]==_0x1bb249(0x1cc)?_0x1bb249(0x1f5):_0x1bb249(0x27a)+_0x59e7a5[_0x1bb249(0x2df)],'callback_data':_0x59e7a5[_0x1bb249(0x2df)]}),_0x27fb39%_0x285120==0x0&&(_0x391873[_0x5a9bb5]=_0x13e773,_0x5a9bb5++);}),tgBot[_0x216aab(0x201)](_0x32ef67[_0x216aab(0x1c1)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x391873}})[_0x216aab(0x1c4)](_0x31748b=>{telegramError(_0x31748b);}),tgBot['on']('callback_query',async _0x5a1254=>{const _0x54f2b9=_0x216aab,_0x222813=_0x5a1254[_0x54f2b9(0x311)],_0x4cb544=_0x5a1254['message'];tgBot[_0x54f2b9(0x24b)](_0x5a1254['id'])[_0x54f2b9(0x326)](async()=>{const _0x5cf5a6=_0x54f2b9;_0x222813==_0x5cf5a6(0x1cc)?config[_0x5cf5a6(0x274)](_0x59bc28=>{const _0x9979cc=_0x5cf5a6;restartBot(_0x59bc28[_0x9979cc(0x2df)]);}):restartBot(_0x222813);}),tgBot[_0x54f2b9(0x25a)](_0x54f2b9(0x1a6));});}}),tgBot[_0x3009b3(0x33b)](/\/on/,_0xf35d7=>{const _0x36c849=_0x3009b3;if(!validateTelegram(_0xf35d7))return;tgBot[_0x36c849(0x25a)]('callback_query');const _0x4a03e6=getDisabledBots();if(_0x4a03e6['length']==0x0)tgBot[_0x36c849(0x201)](_0xf35d7['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x36c849(0x1c4)](_0x54c3eb=>{telegramError(_0x54c3eb);});else{if(_0x4a03e6[_0x36c849(0x2fd)]>0x1)_0x4a03e6[_0x36c849(0x2d3)]({'botID':_0x36c849(0x1cc)});let _0x2ed928=[],_0x1e0f02=[];const _0x5c7aba=_0x4a03e6[_0x36c849(0x2fd)]%0x4==0x0||_0x4a03e6[_0x36c849(0x2fd)]%0x4==0x3||_0x4a03e6[_0x36c849(0x2fd)]%0x3==0x1?0x4:0x3;let _0x4ad756=0x0;_0x4a03e6['forEach']((_0x588b74,_0x45753e)=>{const _0x1b2db0=_0x36c849;if(_0x45753e%_0x5c7aba==0x0)_0x1e0f02=[];_0x1e0f02[_0x1b2db0(0x2d3)]({'text':_0x588b74[_0x1b2db0(0x2df)]==_0x1b2db0(0x1cc)?_0x1b2db0(0x1f5):_0x1b2db0(0x27a)+_0x588b74['botID'],'callback_data':_0x588b74['botID']}),_0x45753e%_0x5c7aba==0x0&&(_0x2ed928[_0x4ad756]=_0x1e0f02,_0x4ad756++);}),tgBot[_0x36c849(0x201)](_0xf35d7['chat']['id'],_0x36c849(0x27b),{'reply_markup':{'inline_keyboard':_0x2ed928}})[_0x36c849(0x1c4)](_0x1a12cd=>{telegramError(_0x1a12cd);}),tgBot['on'](_0x36c849(0x1a6),async _0xd9ec52=>{const _0x538b2f=_0x36c849,_0x3ee148=_0xd9ec52['data'],_0x7b4c91=_0xd9ec52[_0x538b2f(0x283)];tgBot[_0x538b2f(0x24b)](_0xd9ec52['id'])[_0x538b2f(0x326)](async()=>{const _0xcb645=_0x538b2f;_0x3ee148==_0xcb645(0x1cc)?(tgBot[_0xcb645(0x201)](_0x7b4c91['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0xcb645(0x1c4)](_0x4a0ea8=>{telegramError(_0x4a0ea8);}),_0x4a03e6[_0xcb645(0x274)](_0x3a414a=>{const _0x4888bc=_0xcb645;if(_0x3a414a[_0x4888bc(0x2df)]!=_0x4888bc(0x1cc))toggleBot(_0x3a414a[_0x4888bc(0x2df)],toggleStatus(_0x3a414a[_0x4888bc(0x2df)]),'stopped');})):(tgBot[_0xcb645(0x201)](_0x7b4c91[_0xcb645(0x1c1)]['id'],_0xcb645(0x2c6)+_0x3ee148)[_0xcb645(0x1c4)](_0x45ed33=>{telegramError(_0x45ed33);}),toggleBot(_0x3ee148,toggleStatus(_0x3ee148),_0xcb645(0x33a)));}),tgBot['removeListener'](_0x538b2f(0x1a6));});}}),tgBot[_0x3009b3(0x33b)](/\/off/,_0x326296=>{const _0x32d5c1=_0x3009b3;if(!validateTelegram(_0x326296))return;tgBot[_0x32d5c1(0x25a)]('callback_query');const _0x591e06=getEnabledBots();if(_0x591e06[_0x32d5c1(0x2fd)]==0x0)tgBot[_0x32d5c1(0x201)](_0x326296['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x32d5c1(0x1c4)](_0x44dad8=>{telegramError(_0x44dad8);});else{if(_0x591e06['length']>0x1)_0x591e06['push']({'botID':'all'});let _0x23c089=[],_0x2bb127=[];const _0x488da6=_0x591e06['length']%0x4==0x0||_0x591e06['length']%0x4==0x3||_0x591e06['length']%0x3==0x1?0x4:0x3;let _0x219fdd=0x0;_0x591e06[_0x32d5c1(0x274)]((_0xe511bb,_0x20877a)=>{const _0xca2bd8=_0x32d5c1;if(_0x20877a%_0x488da6==0x0)_0x2bb127=[];_0x2bb127[_0xca2bd8(0x2d3)]({'text':_0xe511bb[_0xca2bd8(0x2df)]=='all'?_0xca2bd8(0x1f5):_0xca2bd8(0x27a)+_0xe511bb['botID'],'callback_data':_0xe511bb[_0xca2bd8(0x2df)]}),_0x20877a%_0x488da6==0x0&&(_0x23c089[_0x219fdd]=_0x2bb127,_0x219fdd++);}),tgBot['sendMessage'](_0x326296[_0x32d5c1(0x1c1)]['id'],_0x32d5c1(0x292),{'reply_markup':{'inline_keyboard':_0x23c089}})[_0x32d5c1(0x1c4)](_0x15abae=>{telegramError(_0x15abae);}),tgBot['on'](_0x32d5c1(0x1a6),async _0x44d831=>{const _0x145366=_0x32d5c1,_0x5b50a8=_0x44d831[_0x145366(0x311)],_0x1d31f8=_0x44d831[_0x145366(0x283)];tgBot['answerCallbackQuery'](_0x44d831['id'])['then'](async()=>{const _0x6cdf70=_0x145366;_0x5b50a8==_0x6cdf70(0x1cc)?(tgBot[_0x6cdf70(0x201)](_0x1d31f8['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x57c0af=>{telegramError(_0x57c0af);}),_0x591e06['forEach'](_0x5419d7=>{const _0x417efc=_0x6cdf70;if(_0x5419d7[_0x417efc(0x2df)]!=_0x417efc(0x1cc))toggleBot(_0x5419d7['botID'],toggleStatus(_0x5419d7[_0x417efc(0x2df)]),'stopped');})):(tgBot[_0x6cdf70(0x201)](_0x1d31f8[_0x6cdf70(0x1c1)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x5b50a8)[_0x6cdf70(0x1c4)](_0xb30333=>{telegramError(_0xb30333);}),toggleBot(_0x5b50a8,toggleStatus(_0x5b50a8),'stopped'));}),tgBot[_0x145366(0x25a)]('callback_query');});}}),tgBot['onText'](/\/portfolio/,_0x365202=>{const _0x3ed6f1=_0x3009b3;if(!validateTelegram(_0x365202))return;tgBot[_0x3ed6f1(0x25a)](_0x3ed6f1(0x1a6));const _0x3e4004=getEnabledBots();if(_0x3e4004['length']==0x0)tgBot[_0x3ed6f1(0x201)](_0x365202[_0x3ed6f1(0x1c1)]['id'],_0x3ed6f1(0x244))[_0x3ed6f1(0x1c4)](_0x8f4d61=>{telegramError(_0x8f4d61);});else{if(_0x3e4004[_0x3ed6f1(0x2fd)]>0x1){let _0x25674d=[],_0x37a826=[];const _0x419a06=_0x3e4004[_0x3ed6f1(0x2fd)]%0x4==0x0||_0x3e4004[_0x3ed6f1(0x2fd)]%0x4==0x3||_0x3e4004['length']%0x3==0x1?0x4:0x3;let _0x27e5d7=0x0;_0x3e4004['forEach']((_0x553dd1,_0x2cc421)=>{const _0x2533c3=_0x3ed6f1;if(_0x2cc421%_0x419a06==0x0)_0x37a826=[];_0x37a826[_0x2533c3(0x2d3)]({'text':_0x2533c3(0x27a)+_0x553dd1['botID'],'callback_data':_0x553dd1['botID']}),_0x2cc421%_0x419a06==0x0&&(_0x25674d[_0x27e5d7]=_0x37a826,_0x27e5d7++);}),tgBot[_0x3ed6f1(0x201)](_0x365202[_0x3ed6f1(0x1c1)]['id'],_0x3ed6f1(0x278),{'reply_markup':{'inline_keyboard':_0x25674d}})[_0x3ed6f1(0x1c4)](_0x38472a=>{telegramError(_0x38472a);}),tgBot['on'](_0x3ed6f1(0x1a6),async _0x2319e3=>{const _0x5bb97a=_0x3ed6f1,_0x33f221=_0x2319e3['data'],_0x3cbb54=_0x2319e3['message'];tgBot[_0x5bb97a(0x24b)](_0x2319e3['id'])[_0x5bb97a(0x326)](async()=>{const _0x338b3c=_0x5bb97a;if(pid[_0x33f221])pid[_0x33f221]['send']({'function':_0x338b3c(0x303),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x4e4349=_0x3e4004[0x0]['botID'];if(pid[_0x4e4349])pid[_0x4e4349][_0x3ed6f1(0x232)]({'function':_0x3ed6f1(0x303),'args':null});}}}),tgBot[_0x3009b3(0x33b)](/\/update/,async _0x1a70ce=>{const _0x56d1e1=_0x3009b3;if(!validateTelegram(_0x1a70ce))return;tgBot[_0x56d1e1(0x25a)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x56d1e1(0x201)](_0x1a70ce[_0x56d1e1(0x1c1)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x56d1e1(0x1c4)](_0x58ff5c=>{telegramError(_0x58ff5c);});else!validInstallation?tgBot[_0x56d1e1(0x201)](_0x1a70ce[_0x56d1e1(0x1c1)]['id'],_0x56d1e1(0x21e))[_0x56d1e1(0x1c4)](_0x29a087=>{telegramError(_0x29a087);}):(tgBot[_0x56d1e1(0x201)](_0x1a70ce['chat']['id'],_0x56d1e1(0x332),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x56d1e1(0x1ca)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x41f0fa=>{telegramError(_0x41f0fa);}),tgBot['on'](_0x56d1e1(0x1a6),async _0x1ce1a8=>{const _0x4705b4=_0x56d1e1,_0x1881bb=_0x1ce1a8[_0x4705b4(0x311)],_0x43c4c9=_0x1ce1a8[_0x4705b4(0x283)];tgBot[_0x4705b4(0x24b)](_0x1ce1a8['id'])[_0x4705b4(0x326)](async()=>{const _0x8b4bd3=_0x4705b4;_0x1881bb==_0x8b4bd3(0x1ca)&&(await tgBot[_0x8b4bd3(0x201)](_0x43c4c9['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x8b4bd3(0x1c4)](_0x58c67b=>{telegramError(_0x58c67b);}),updateBB());_0x1881bb=='no'&&await tgBot[_0x8b4bd3(0x201)](_0x43c4c9[_0x8b4bd3(0x1c1)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x8b4bd3(0x1c4)](_0x119657=>{telegramError(_0x119657);});if(!settings['telegramChatId'])tgBot[_0x8b4bd3(0x201)](_0x43c4c9[_0x8b4bd3(0x1c1)]['id'],_0x8b4bd3(0x220))[_0x8b4bd3(0x1c4)](_0x5bc02e=>{telegramError(_0x5bc02e);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x3009b3(0x33b)](/\/toggle/,_0x433b3a=>{const _0x187118=_0x3009b3;if(!validateTelegram(_0x433b3a))return;tgBot['removeListener'](_0x187118(0x1a6));const _0x21cfad=getBotsWithMode();if(_0x21cfad['length']==0x0)tgBot['sendMessage'](_0x433b3a[_0x187118(0x1c1)]['id'],_0x187118(0x244))[_0x187118(0x1c4)](_0x10dde5=>{telegramError(_0x10dde5);});else{let _0x4509a4=[],_0x446046=[];const _0x31be1d=0x2;let _0x27b289=0x0;_0x21cfad[_0x187118(0x274)]((_0x4d1af2,_0x4f41ee)=>{const _0x1e8871=_0x187118;if(_0x4f41ee%_0x31be1d==0x0)_0x446046=[];_0x446046[_0x1e8871(0x2d3)]({'text':_0x1e8871(0x27a)+_0x4d1af2[_0x1e8871(0x2df)]+'\x20('+_0x4d1af2[_0x1e8871(0x1a2)]+')','callback_data':_0x4d1af2[_0x1e8871(0x2df)]}),_0x4f41ee%_0x31be1d==0x0&&(_0x4509a4[_0x27b289]=_0x446046,_0x27b289++);}),tgBot['sendMessage'](_0x433b3a[_0x187118(0x1c1)]['id'],_0x187118(0x1bb),{'reply_markup':{'inline_keyboard':_0x4509a4}})[_0x187118(0x1c4)](_0x5f51ec=>{telegramError(_0x5f51ec);}),tgBot['on'](_0x187118(0x1a6),async _0x3b94a6=>{const _0x2cce58=_0x187118,_0x45f0ef=_0x3b94a6[_0x2cce58(0x311)],_0x5e2acc=_0x3b94a6[_0x2cce58(0x283)];tgBot[_0x2cce58(0x24b)](_0x3b94a6['id'])[_0x2cce58(0x326)](async()=>{const _0x51504a=_0x2cce58,_0x4c1032=_0x21cfad[_0x51504a(0x2e5)](_0x370e72=>_0x370e72['botID']==_0x45f0ef),_0x437979=_0x4c1032[_0x51504a(0x1a2)]==_0x51504a(0x237)?_0x51504a(0x213):_0x51504a(0x237);tgBot[_0x51504a(0x201)](_0x5e2acc[_0x51504a(0x1c1)]['id'],_0x51504a(0x1e4)+_0x45f0ef+_0x51504a(0x24e)+_0x437979+_0x51504a(0x2be))['catch'](_0x1c3dbf=>{telegramError(_0x1c3dbf);}),toggleBotMode(_0x45f0ef);}),tgBot[_0x2cce58(0x25a)](_0x2cce58(0x1a6));});}}),tgBot['onText'](/\/names/,_0x57f900=>{const _0x330911=_0x3009b3;if(!validateTelegram(_0x57f900))return;let _0x32b035='';config['forEach'](_0x5c7309=>{const _0x428898=_0x5575;_0x32b035+=_0x428898(0x27a)+_0x5c7309[_0x428898(0x2df)]+':\x20'+_0x5c7309[_0x428898(0x1f4)]+'\x0a';}),tgBot[_0x330911(0x201)](_0x57f900[_0x330911(0x1c1)]['id'],_0x32b035,{'parse_mode':_0x330911(0x1d5)})[_0x330911(0x1c4)](_0x301d63=>{telegramError(_0x301d63);});}),tgBot[_0x3009b3(0x33b)](/\/disable/,_0x3b5335=>{const _0x415a4f=_0x3009b3;if(!validateTelegram(_0x3b5335))return;tgBot[_0x415a4f(0x201)](_0x3b5335[_0x415a4f(0x1c1)]['id'],_0x415a4f(0x30e))[_0x415a4f(0x1c4)](_0x407dc2=>{telegramError(_0x407dc2);}),updateSetting(_0x415a4f(0x1fb),![]);}),tgBot['onText'](/\/help/,_0x5db950=>{const _0x426936=_0x3009b3;if(!validateTelegram(_0x5db950))return;tgBot[_0x426936(0x201)](_0x5db950[_0x426936(0x1c1)]['id'],_0x50bc89)[_0x426936(0x1c4)](_0x343090=>{telegramError(_0x343090);});}),tgBot['on'](_0x3009b3(0x305),_0x3ae403=>{const _0x200387=_0x3009b3;_0x3ae403[_0x200387(0x233)]()['includes'](_0x200387(0x2ba))&&(logger[_0x200387(0x2ca)](_0x200387(0x2b8)),tgBot[_0x200387(0x1a7)](),tgBot=null,io['to'](_0x200387(0x1f7))['emit'](_0x200387(0x32a),_0x200387(0x2b8)));}),process[_0x3009b3(0x238)]('SIGINT',()=>{const _0x50cc62=_0x3009b3;if(tgBot)tgBot[_0x50cc62(0x1a7)]();process['exit'](0x1);}),process[_0x3009b3(0x238)](_0x3009b3(0x20e),()=>{const _0x4efec6=_0x3009b3;if(tgBot)tgBot[_0x4efec6(0x1a7)]();process[_0x4efec6(0x28e)](0x1);});}}function disableTelegram(){const _0x622399=_0x319732;tgBot&&(tgBot[_0x622399(0x1a7)](),tgBot=null);}function sendTelegram(_0x568603,_0xa4237c){const _0xda897a=_0x319732;if(settings[_0xda897a(0x1fb)]){if(settings[_0xda897a(0x1a3)]==_0xda897a(0x1cc)||(_0xa4237c[_0xda897a(0x2ae)]==_0xda897a(0x209)||_0xa4237c[_0xda897a(0x2ae)]==_0xda897a(0x1dc)||_0xa4237c[_0xda897a(0x2ae)]==_0xda897a(0x20b))&&settings['telegramEvents']=='alerts'||_0xa4237c[_0xda897a(0x2ae)]==_0xda897a(0x219)&&settings[_0xda897a(0x1a3)]==_0xda897a(0x236)){if(tgBot&&settings[_0xda897a(0x1aa)]){if(_0xa4237c[_0xda897a(0x335)])tgBot[_0xda897a(0x201)](settings[_0xda897a(0x1aa)],_0xa4237c[_0xda897a(0x1f4)]+_0xda897a(0x331)+_0xa4237c[_0xda897a(0x227)])['catch'](_0xe43a06=>{telegramError(_0xe43a06);});else tgBot[_0xda897a(0x201)](settings[_0xda897a(0x1aa)],_0xda897a(0x27a)+_0x568603+'\x20>\x20'+_0xa4237c['event'])[_0xda897a(0x1c4)](_0x589fbe=>{telegramError(_0x589fbe);});}}}}async function sendTelegramMsg(_0x18938d,_0x44fbc3=_0x319732(0x1d5)){const _0x131c09=_0x319732;return settings[_0x131c09(0x1fb)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x131c09(0x201)](settings[_0x131c09(0x1aa)],_0x18938d,{'parse_mode':_0x44fbc3})['catch'](_0x24342f=>{telegramError(_0x24342f);}),!![]):![];}function getDeviceWithIp(_0x5ba333){const _0x1349d3=_0x319732;return devices[_0x1349d3(0x2e5)](_0x4203a7=>_0x4203a7['ip']===_0x5ba333);}function temporaryAccess2FA(_0x341aec,_0x4ae02d){const _0x427661=_0x319732;let _0x3e6ddd=new Date(),_0x4e94e9=![];if(lastIpApproval){if(_0x3e6ddd-lastIpApproval<0x1388)_0x4e94e9=!![];}lastIpApproval=new Date();if(_0x4e94e9)return;tgBot&&settings[_0x427661(0x1aa)]&&(tgBot[_0x427661(0x25a)](_0x427661(0x1a6)),tgBot[_0x427661(0x201)](settings[_0x427661(0x1aa)],_0x427661(0x28d)+normalizeIP(_0x4ae02d)[_0x427661(0x2f0)]+'</b>\x20?',{'parse_mode':_0x427661(0x1d5),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x427661(0x1a5),'callback_data':'15'},{'text':_0x427661(0x222),'callback_data':'30'},{'text':_0x427661(0x221),'callback_data':_0x427661(0x221)}]]}})[_0x427661(0x1c4)](_0x32f4f6=>{telegramError(_0x32f4f6);}),tgBot['on'](_0x427661(0x1a6),async _0x2e40fa=>{const _0x984b9d=_0x427661,_0x48696d=_0x2e40fa[_0x984b9d(0x311)],_0x4c2c81=_0x2e40fa['message'];tgBot[_0x984b9d(0x24b)](_0x2e40fa['id'])[_0x984b9d(0x326)](async()=>{const _0x36fcee=_0x984b9d;devices[_0x341aec]['telegramIpApproval']={'clientip':_0x4ae02d,'timestamp':new Date()['getTime'](),'expiry':_0x48696d},_0x48696d!='reject'?(await tgBot[_0x36fcee(0x201)](_0x4c2c81[_0x36fcee(0x1c1)]['id'],_0x36fcee(0x1d9)+_0x48696d+'\x20minutes',{'parse_mode':'HTML'})[_0x36fcee(0x1c4)](_0x5c4879=>{telegramError(_0x5c4879);}),io['to'](_0x341aec)[_0x36fcee(0x20d)](_0x36fcee(0x252),{'access':{'allow':![],'reason':_0x36fcee(0x1ab),'token':null}})):(await tgBot[_0x36fcee(0x201)](_0x4c2c81[_0x36fcee(0x1c1)]['id'],_0x36fcee(0x1b5))[_0x36fcee(0x1c4)](_0x5baa7f=>{telegramError(_0x5baa7f);}),io['to'](_0x341aec)[_0x36fcee(0x20d)](_0x36fcee(0x252),{'access':{'allow':![],'reason':_0x36fcee(0x1eb),'token':null}}));}),tgBot[_0x984b9d(0x25a)](_0x984b9d(0x1a6));}));}function loginAccess2FA(_0x311b84,_0x24421f){const _0xc1eef2=_0x319732;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0xc1eef2(0x201)](settings[_0xc1eef2(0x1aa)],_0xc1eef2(0x20c)+normalizeIP(_0x24421f)[_0xc1eef2(0x2f0)]+'</b>\x20?',{'parse_mode':_0xc1eef2(0x1d5),'reply_markup':{'inline_keyboard':[[{'text':_0xc1eef2(0x1ad),'callback_data':loginExpiry},{'text':_0xc1eef2(0x221),'callback_data':_0xc1eef2(0x221)}]]}})[_0xc1eef2(0x1c4)](_0xc0cde1=>{telegramError(_0xc0cde1);}),tgBot['on'](_0xc1eef2(0x1a6),async _0x7ab70f=>{const _0x1ea019=_0xc1eef2,_0x966765=_0x7ab70f[_0x1ea019(0x311)],_0xe68295=_0x7ab70f[_0x1ea019(0x283)];tgBot[_0x1ea019(0x24b)](_0x7ab70f['id'])['then'](async()=>{const _0x425821=_0x1ea019;devices[_0x311b84][_0x425821(0x1c0)]={'clientip':_0x24421f,'timestamp':new Date()[_0x425821(0x1fa)](),'expiry':_0x966765},_0x966765!=_0x425821(0x221)?(await tgBot[_0x425821(0x201)](_0xe68295[_0x425821(0x1c1)]['id'],'Login\x20accepted',{'parse_mode':_0x425821(0x1d5)})[_0x425821(0x1c4)](_0x2c1818=>{telegramError(_0x2c1818);}),io['to'](_0x311b84)[_0x425821(0x20d)](_0x425821(0x252),{'access':{'allow':![],'reason':_0x425821(0x1ab),'token':null}})):(await tgBot[_0x425821(0x201)](_0xe68295[_0x425821(0x1c1)]['id'],_0x425821(0x319))[_0x425821(0x1c4)](_0x31d386=>{telegramError(_0x31d386);}),io['to'](_0x311b84)[_0x425821(0x20d)](_0x425821(0x252),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x1ea019(0x25a)](_0x1ea019(0x1a6));}));}function _0x2f62(){const _0xe7547a=['randomBytes','binary','request','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','toIPv4Address','getPortfolio','\x20(2)','server','child_process','::ffff:127.0.0.1','token','bbPassword','bcryptjs','listen','generate','-----------------------------------------------------------------------------------','userid','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','type','/:bot/coins','update-bot','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20get\x20portfolio','login','6815390WCtHHi','remoteAddress','(((.+)+)+)+$','get-portfolio','Invalid\x20Telegram\x20token','name','404\x20Not\x20Found','File\x20uploaded','/:bot','verify','\x20mode','kill','constructor','index.html','getHours','sendFile','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','bb-settings.json','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','map','/output-000.log','uncaughtException','full','getUTCHours','loginRequired','Markdown','http','util','restart','backup','disabled\x20Bot\x20','push','storeHeadless','build','allow','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Notifications\x20enabled','output-000.log','cancel-loading','ipc','value','Unauthorized\x20attempt\x20to\x20log\x20out','output-003.log','botID','defaults','match','sort','0.0.0','title','find','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','getDate','store-settings','axios','Alerts','.zip','bb-config.json','socket','download','logs','show','test','sha256','version','*$1*','getFullYear','readdirSync','/:bot/configuration','headers','delete-bot','All','slice','from','length',',\x20must\x20be\x20a\x204\x20digit\x20number','exp','login\x20not\x20required','temporary\x20token\x20generated','Notifications\x20disabled\x0a','sendPortfolioTelegram','Failed\x20to\x20download\x20','polling_error','max','hybrid-crypto-js','bot','2FA\x20required','settings','use','host','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Notifications\x20disabled','decrypt','Unauthorized\x20attempt\x20to\x20get\x20messages','data','***','apiKey','show-config','login\x20required','secure','685840rfZAkF','reason','Login\x20rejected','encryptedUuid','ipaddr.js','telegramIpApproval','f2aRequired','Invalid\x20authentication\x20token\x20(2)','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','6b67f3d61ee94b8f5c80b4affef4c4d9','confirm-message','12SyscOW','expiry','680776VsCUSP','invalid\x20credentials','then','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','blacklist','privateKey','notification','apiSecret','storeConfiguration','join','jsonwebtoken','min','DEFLATE','\x20>\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','user','graphql-request','showname','crypto','bot.js','99qjqcOv','static','stopped','onText','set','enabled\x20Bot\x20','Invalid\x20IP\x20address','mode','telegramEvents','Invalid\x20authentication\x20token\x20(1)','15\x20min','callback_query','stopPolling','settings.','uuid','telegramChatId','reload','\x20(1)','accept','/restart\x20-\x20restart\x20bot(s)\x0a','any','sockets','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Notifications\x20types:\x20','sign','::1','Temporary\x20access\x20rejected','readFileSync','socket.io','stop','https://api.ipify.org?format=json','logout','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Unauthorized\x20attempt\x20to\x20store\x20configuration','Orders','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20add\x20bot','telegram2FaApproval','chat','referer','24bcnNUx','catch','\x20|\x20','sortBy',':\x20Bot\x20Mgr\x20>\x20','replace','<b>Balance\x20Bot\x20Status:</b>\x0a','yes','add-bot','all','parse','handshake','password','timeshift','messages','copyFileSync','remove','Unauthorized\x20attempt\x20to\x20get\x20logs','HTML','toggle-bot-mode','generateKeyPairAsync','filter','Access\x20enabled\x20for\x20','lastmsgtelegram','Restore\x20process\x20aborted','warning','latestversion','timestamp','file','login\x20token\x20generated','bbvReceive','/:bot/performance','_data','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','telegrammsg','idling\x20bot\x20\x20\x20|\x20Bot\x20','/download/:type','build2','conn','temporary\x20access\x20rejected','Password\x20reset\x20rejected','restarting\x20Bot\x20','bot-','args','Restoring\x20bot(s)\x20from\x20backup','toIPv4MappedAddress','User\x20has\x20been\x20validated','get-logs','botname','All\x20bots','Unauthorized\x20attempt\x20to\x20download\x20','botmanager','Token\x20blacklisted','cloneDeep','getTime','telegramEnabled','auth','split','new','mixpanel','reset-password','sendMessage','1000','Notifications\x20enabled\x0a','add','telegramUsername','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getStartingBalances','mkdirSync','error','temp/','success','Allow\x20login\x20from\x20IP\x20address\x20<b>','emit','SIGTERM','version.json','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','alerts','rmSync','manual','delete-alerts','ipv6','isValid','pidRefreshToken','store-configuration','order','isDirectory','Ok,\x20will\x20send\x20order\x20notifications\x20only','startsWith','Unauthorized\x20attempt\x20to\x20show\x20configuration','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','logs/','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','reject','30\x20min','createWriteStream','output-002.log','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','clientip','event','search','format','files','existsSync','unlinkSync','Unauthorized\x20attempt\x20to\x20confirm\x20message','-config.json','assign','tkn','express','send','toString','publicKey','get-messages','orders','auto','once','showConfig','Unauthorized\x20attempt\x20to\x20update\x20bot','bbvNew','bb-secure.json','deleted\x20Bot\x20','store-headless','************','apply','get-starting-balances','log','bbUsername','No\x20bots\x20running\x20right\x20now','/disable\x20-\x20disable\x20notifications\x0a','whitelistEnabled','started','527723sFDlTb','logged\x20out','Server','answerCallbackQuery','disabled','Invalid\x20username\x20or\x20IP\x20address','\x20to\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getMonth','inherit','status','1947090MPhENN','whitelist','username',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','telegram','bb/','removeListener','getMinutes','3855948IFveVB','yargs/yargs','Bot\x20Mgr\x20>\x20','/:bot/support','entries','76144ooWmyY','No\x20authentication\x20token','argv','backup/','hashSync','env','zip/','Crypt','writeFileSync','bots','temporary\x20access\x20not\x20allowed','secret','isIPv4MappedAddress','lastmsgemitted','output-001.log','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','-performance.json','node-zip','new-disabled','forEach','pidExpireLogin','compareSync','date-fns','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','store','Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','stringify','disconnect','/status\x20-\x20show\x20bot(s)\x20status\x0a','simple','telegramToken','keys','get','message','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','hasOwnProperty','getSeconds','padStart','live','express-fileupload','enabled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','exit','/upload-backup','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','headless','config/','function','connected','exec','access\x20timeout','write','cancelLoading','access'];_0x2f62=function(){return _0xe7547a;};return _0x2f62();}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xda4288=_0x319732;return dbConfig[_0xda4288(0x282)](_0xda4288(0x26a))['sortBy'](_0xda4288(0x2df))[_0xda4288(0x1d8)]({'status':_0xda4288(0x28a)})[_0xda4288(0x2dc)]()||[];}function getDisabledBots(){const _0x47fe4d=_0x319732;return dbConfig['get'](_0x47fe4d(0x26a))[_0x47fe4d(0x1c6)]('botID')[_0x47fe4d(0x1d8)]({'status':_0x47fe4d(0x24c)})[_0x47fe4d(0x2dc)]()||[];}function getBotAttributes(_0xa3646c){const _0x16df92=_0x319732;let _0x1029f4={};const _0x19ed7e=configpath+_0x16df92(0x1ee)+_0xa3646c+_0x16df92(0x22e),_0x339b85=fs[_0x16df92(0x22b)](_0x19ed7e);if(_0x339b85){const _0x255ba8=fs[_0x16df92(0x1b6)](_0x19ed7e);try{const _0xd56137=JSON[_0x16df92(0x1cd)](_0x255ba8),_0x4875ef=_0xd56137?_0xd56137[_0x16df92(0x308)][0x0][_0x16df92(0x293)]:![];_0x1029f4['mode']=_0x4875ef?'auto':_0x16df92(0x213),_0x1029f4[_0x16df92(0x1f4)]=_0xd56137?_0xd56137[_0x16df92(0x308)][0x0][_0x16df92(0x1f4)]:'Bot\x20'+_0xa3646c;}catch(_0x506973){_0x1029f4[_0x16df92(0x1a2)]=_0x16df92(0x213),_0x1029f4[_0x16df92(0x1f4)]='Bot\x20'+_0xa3646c;}}else _0x1029f4[_0x16df92(0x1a2)]=_0x16df92(0x213),_0x1029f4[_0x16df92(0x1f4)]='Bot\x20'+_0xa3646c;return _0x1029f4;}function getBotsWithMode(){const _0x1c3cf2=_0x319732,_0x34b0a3=dbConfig[_0x1c3cf2(0x282)](_0x1c3cf2(0x26a))['sortBy'](_0x1c3cf2(0x2df))['value']()||[];return _0x34b0a3[_0x1c3cf2(0x274)](_0x216ca3=>{const _0x4a4f4a=_0x1c3cf2;let _0x491ddc=getBotAttributes(_0x216ca3[_0x4a4f4a(0x2df)]);_0x216ca3[_0x4a4f4a(0x1a2)]=_0x491ddc['mode'];}),_0x34b0a3;}async function initUser(){const _0x24bb0f=_0x319732;if(!settings[_0x24bb0f(0x2ac)]){const _0x36f8ad=uuidRandom();mixpanel['alias'](_0x36f8ad),updateSetting(_0x24bb0f(0x2ac),_0x36f8ad);}}async function initSecure(){const _0x442559=_0x319732;let _0x159cd6=getSecure();if(!_0x159cd6['hasOwnProperty']('secret')){let _0x71b835=await generateKeys();_0x159cd6[_0x442559(0x234)]=_0x71b835[_0x442559(0x234)],_0x159cd6[_0x442559(0x329)]=_0x71b835[_0x442559(0x329)],_0x159cd6[_0x442559(0x26c)]=crypto[_0x442559(0x29c)](0x20)[_0x442559(0x233)]('hex');;storeSecure(_0x159cd6);}}function getSettings(){const _0x25f872=_0x319732;return dbSettings[_0x25f872(0x282)](_0x25f872(0x30a))[_0x25f872(0x2dc)]()||{};}function getSecure(){const _0x2096f4=_0x319732;return dbSecure[_0x2096f4(0x282)](_0x2096f4(0x316))['value']()||{};}function getBlacklist(){const _0x2b9709=_0x319732;return dbSecure[_0x2b9709(0x282)](_0x2b9709(0x328))[_0x2b9709(0x2dc)]()||[];}function broadcastToBots(_0x62f11e,_0x5f1bc4){const _0x165453=_0x319732;config[_0x165453(0x274)](_0x46e018=>{const _0x2bf90a=_0x165453;if(_0x46e018[_0x2bf90a(0x252)]==_0x2bf90a(0x28a)&&_0x46e018[_0x2bf90a(0x288)]=='running'){if(pid[_0x46e018[_0x2bf90a(0x2df)]])pid[_0x46e018['botID']][_0x2bf90a(0x232)]({[_0x62f11e]:_0x5f1bc4});}});}function storeSettings(_0x3d1efb,_0x4ca57c=![]){const _0x3933f1=_0x319732;_0x3d1efb={...settings,..._0x3d1efb};if(_0x4ca57c&&_0x3d1efb[_0x3933f1(0x2a7)]!='************'&&_0x3d1efb['bbPassword']!=_0x3933f1(0x312)&&_0x3d1efb['bbPassword']!=''){const _0xfabd9a=crypt['decrypt'](secure['privateKey'],_0x3d1efb[_0x3933f1(0x2a7)])[_0x3933f1(0x283)][_0x3933f1(0x1fd)]('@')[0x0],_0x1ce192=bcrypt[_0x3933f1(0x265)](_0xfabd9a,saltRounds);_0x3d1efb={..._0x3d1efb,'bbPassword':_0x1ce192};}if(_0x4ca57c&&_0x3d1efb[_0x3933f1(0x280)]!=_0x3933f1(0x23f)&&_0x3d1efb[_0x3933f1(0x280)]!='***'&&_0x3d1efb[_0x3933f1(0x280)]!=''){const _0xfd3afb=crypt[_0x3933f1(0x30f)](secure[_0x3933f1(0x329)],_0x3d1efb[_0x3933f1(0x280)])[_0x3933f1(0x283)][_0x3933f1(0x1fd)]('@')[0x0];_0x3d1efb={..._0x3d1efb,'telegramToken':_0xfd3afb};}const _0x21a44c=_0x3d1efb[_0x3933f1(0x280)]!=_0x3933f1(0x23f)&&_0x3d1efb[_0x3933f1(0x280)]!=settings[_0x3933f1(0x280)]||_0x3d1efb[_0x3933f1(0x205)]!=settings[_0x3933f1(0x205)],_0x266ba1=_0x3d1efb[_0x3933f1(0x280)]==''||_0x3d1efb[_0x3933f1(0x205)]=='';if(_0x21a44c)_0x3d1efb[_0x3933f1(0x1a3)]='all';for(const [_0x591dc4,_0x45edf7]of Object[_0x3933f1(0x260)](_0x3d1efb)){if(_0x591dc4==_0x3933f1(0x280)&&_0x45edf7==_0x3933f1(0x23f)){_0x3d1efb[_0x3933f1(0x280)]=settings[_0x3933f1(0x280)];continue;};if(_0x591dc4=='bbPassword'&&_0x45edf7=='************'){_0x3d1efb[_0x3933f1(0x2a7)]=settings['bbPassword'];continue;};dbSettings['set'](_0x3933f1(0x1a8)+_0x591dc4,_0x45edf7)[_0x3933f1(0x299)]();}settings=_0x3d1efb,io['to'](_0x3933f1(0x1f7))['emit']('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x3933f1(0x1d0)]);if(_0x21a44c&&!_0x266ba1)initTelegram();if(_0x21a44c&&_0x266ba1)disableTelegram();getAllClients()['forEach'](_0x16d039=>{const _0x324c9a=_0x3933f1;getSocket(_0x16d039['id'])[_0x324c9a(0x20d)](_0x324c9a(0x252),{'access':{'allow':![],'reason':_0x324c9a(0x1ab),'token':null}});});}function updateSetting(_0x224437,_0x255052){const _0xcdc830=_0x319732;dbSettings[_0xcdc830(0x33c)]('settings.'+_0x224437,_0x255052)['write'](),settings=getSettings(),io['to'](_0xcdc830(0x1f7))[_0xcdc830(0x20d)](_0xcdc830(0x30a),cleanSettings());}function storeSecure(_0x750160){const _0x6207e1=_0x319732;dbSecure[_0x6207e1(0x282)](_0x6207e1(0x316))[_0x6207e1(0x2d3)](_0x750160)[_0x6207e1(0x299)](),secure=_0x750160;}function addBlacklist(_0x7858f8){const _0xf39b75=_0x319732;cleanBlacklist();let _0x5f1d26;devices[_0x7858f8]['telegramIpApproval']?_0x5f1d26=Math[_0xf39b75(0x306)](devices[_0x7858f8][_0xf39b75(0x31c)][_0xf39b75(0x323)],loginExpiry):_0x5f1d26=loginExpiry,dbSecure['get']('blacklist')['push']({'expiry':new Date()['getTime']()+_0x5f1d26*0x3c*0x3e8,'token':devices[_0x7858f8][_0xf39b75(0x29b)]['token']})['write'](),blacklist=dbSecure['get'](_0xf39b75(0x328))[_0xf39b75(0x2dc)]();}function cleanBlacklist(){const _0x1fa414=_0x319732;let _0x98c715=dbSecure[_0x1fa414(0x282)](_0x1fa414(0x328))[_0x1fa414(0x1f9)]()[_0x1fa414(0x2dc)](),_0x2788a8=new Date()[_0x1fa414(0x1fa)]();_0x98c715[_0x1fa414(0x274)](_0x1af2cd=>{const _0x1fa50c=_0x1fa414;_0x1af2cd['expiry']<_0x2788a8&&dbSecure[_0x1fa50c(0x282)]('blacklist')[_0x1fa50c(0x1d3)]({'expiry':_0x1af2cd[_0x1fa50c(0x323)]})[_0x1fa50c(0x299)]();});}function initStates(){const _0x4bf9be=_0x319732;let _0x4360fa=getConfiguration();_0x4360fa[_0x4bf9be(0x274)](_0x210389=>{const _0x10ebd7=_0x4bf9be;_0x210389[_0x10ebd7(0x288)]=_0x10ebd7(0x33a);}),storeConfiguration(_0x4360fa);}function onKeys(){const _0x5906ce=new RSA();return new Promise(_0x4b8e2d=>{const _0x19569a=_0x5575;_0x5906ce[_0x19569a(0x1d7)]()[_0x19569a(0x326)](_0x22de73=>{_0x4b8e2d(_0x22de73);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x12af59=_0x319732;let _0x57fa1f=getSettings(),_0x54c5e4=![];!_0x57fa1f[_0x12af59(0x285)](_0x12af59(0x1da))&&(_0x57fa1f[_0x12af59(0x1da)]=0x0,_0x54c5e4=!![]);!_0x57fa1f[_0x12af59(0x285)](_0x12af59(0x26e))&&(_0x57fa1f[_0x12af59(0x26e)]=0x0,_0x54c5e4=!![]);!_0x57fa1f[_0x12af59(0x285)](_0x12af59(0x1dd))&&(_0x57fa1f[_0x12af59(0x1dd)]=_0x12af59(0x2e3),_0x54c5e4=!![]);if(_0x54c5e4)storeSettings(_0x57fa1f);}function storeConfiguration(_0x393e7c){const _0x253010=_0x319732;dbConfig[_0x253010(0x282)](_0x253010(0x26a))[_0x253010(0x1d3)]()[_0x253010(0x299)](),_0x393e7c['forEach'](_0x2895e3=>{const _0x260b5c=_0x253010;delete _0x2895e3[_0x260b5c(0x1a2)];}),dbConfig[_0x253010(0x282)](_0x253010(0x26a))['push'](..._0x393e7c)[_0x253010(0x299)](),config=_0x393e7c;}function resetPassword(){const _0xb98f7d=_0x319732;tgBot&&settings[_0xb98f7d(0x1aa)]&&(tgBot[_0xb98f7d(0x25a)](_0xb98f7d(0x1a6)),tgBot[_0xb98f7d(0x201)](settings[_0xb98f7d(0x1aa)],_0xb98f7d(0x270),{'parse_mode':_0xb98f7d(0x1d5),'reply_markup':{'inline_keyboard':[[{'text':_0xb98f7d(0x1ca),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0xb98f7d(0x1c4)](_0x10caac=>{telegramError(_0x10caac);}),tgBot['on'](_0xb98f7d(0x1a6),async _0x2a869c=>{const _0x1f5352=_0xb98f7d,_0x52885f=_0x2a869c[_0x1f5352(0x311)],_0x2c1b94=_0x2a869c[_0x1f5352(0x283)];tgBot[_0x1f5352(0x24b)](_0x2a869c['id'])[_0x1f5352(0x326)](async()=>{const _0x1360e3=_0x1f5352;if(_0x52885f!='no'){const _0x4132e8=0xf,_0x397cf8=_0x1360e3(0x225),_0x316cb0=Array[_0x1360e3(0x2fc)](crypto['randomFillSync'](new Uint32Array(_0x4132e8)))[_0x1360e3(0x2c7)](_0x744755=>_0x397cf8[_0x744755%_0x397cf8['length']])[_0x1360e3(0x32d)](''),_0x5c8f24=bcrypt[_0x1360e3(0x265)](_0x316cb0,saltRounds);storeSettings({'bbPassword':_0x5c8f24}),await tgBot[_0x1360e3(0x201)](_0x2c1b94[_0x1360e3(0x1c1)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x316cb0,{'parse_mode':_0x1360e3(0x1d5)})['catch'](_0x26b629=>{telegramError(_0x26b629);});}else await tgBot['sendMessage'](_0x2c1b94[_0x1360e3(0x1c1)]['id'],_0x1360e3(0x1ec))[_0x1360e3(0x1c4)](_0x13368b=>{telegramError(_0x13368b);});}),tgBot[_0x1f5352(0x25a)](_0x1f5352(0x1a6));}));}function _0x5575(_0x4b4a11,_0x2a188a){const _0x33def1=_0x2f62();return _0x5575=function(_0x12eb80,_0x816504){_0x12eb80=_0x12eb80-0x1a2;let _0x2f6249=_0x33def1[_0x12eb80];return _0x2f6249;},_0x5575(_0x4b4a11,_0x2a188a);}async function confirmRestore(_0x45cf85,_0x2756be){const _0x11b653=_0x319732;tgBot&&settings[_0x11b653(0x1aa)]&&(tgBot[_0x11b653(0x25a)](_0x11b653(0x1a6)),await tgBot[_0x11b653(0x201)](settings[_0x11b653(0x1aa)],_0x11b653(0x210),{'parse_mode':_0x11b653(0x1d5),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x11b653(0x1c4)](_0x42854e=>{telegramError(_0x42854e);}),tgBot['on'](_0x11b653(0x1a6),async _0x241f5c=>{const _0x3332bc=_0x11b653,_0x2f38ef=_0x241f5c['data'],_0x48bd17=_0x241f5c['message'];tgBot[_0x3332bc(0x24b)](_0x241f5c['id'])[_0x3332bc(0x326)](async()=>{const _0x35138b=_0x3332bc;_0x2f38ef==_0x35138b(0x1ca)?(await tgBot[_0x35138b(0x201)](_0x48bd17[_0x35138b(0x1c1)]['id'],_0x35138b(0x1f0),{'parse_mode':_0x35138b(0x1d5)})[_0x35138b(0x1c4)](_0x26e46c=>{telegramError(_0x26e46c);}),unzipFile(_0x45cf85,_0x2756be)):await tgBot[_0x35138b(0x201)](_0x48bd17[_0x35138b(0x1c1)]['id'],_0x35138b(0x1db))[_0x35138b(0x1c4)](_0x300aa6=>{telegramError(_0x300aa6);});}),tgBot[_0x3332bc(0x25a)](_0x3332bc(0x1a6));}));}function getServerTime(){const _0x4f67f4=_0x319732,_0xb49b1c=new Date();return _0xb49b1c[_0x4f67f4(0x2f5)]()+'/'+(_0xb49b1c['getMonth']()+0x1)['toString']()[_0x4f67f4(0x287)](0x2,'0')+'/'+_0xb49b1c[_0x4f67f4(0x2e7)]()['toString']()[_0x4f67f4(0x287)](0x2,'0')+'\x20'+_0xb49b1c[_0x4f67f4(0x2c2)]()['toString']()[_0x4f67f4(0x287)](0x2,'0')+':'+_0xb49b1c[_0x4f67f4(0x25b)]()['toString']()[_0x4f67f4(0x287)](0x2,'0')+':'+_0xb49b1c[_0x4f67f4(0x286)]()[_0x4f67f4(0x233)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x354e49=_0x319732,_0x10ad54=shiftedTime();return _0x10ad54[_0x354e49(0x2f5)]()+'/'+(_0x10ad54[_0x354e49(0x250)]()+0x1)[_0x354e49(0x233)]()[_0x354e49(0x287)](0x2,'0')+'/'+_0x10ad54['getDate']()[_0x354e49(0x233)]()[_0x354e49(0x287)](0x2,'0')+'\x20'+_0x10ad54[_0x354e49(0x2c2)]()[_0x354e49(0x233)]()[_0x354e49(0x287)](0x2,'0')+':'+_0x10ad54[_0x354e49(0x25b)]()[_0x354e49(0x233)]()[_0x354e49(0x287)](0x2,'0')+':'+_0x10ad54['getSeconds']()[_0x354e49(0x233)]()[_0x354e49(0x287)](0x2,'0');}function shiftedTime(){const _0x3a88b4=_0x319732,_0x2e2ba6=new Date();let _0x4d95bb=_0x2e2ba6;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x4d95bb=fns[_0x3a88b4(0x204)](_0x2e2ba6,{'hours':settings['timeshift']});return _0x4d95bb;}function startScheduler(){const _0x32468e=_0x319732,_0x30cc46=new Date()[_0x32468e(0x2cb)](),_0x2edccf=shiftedTime()[_0x32468e(0x2c2)]();_0x2edccf==0x4&&backupConfigFiles();_0x2edccf==0x0&&rotateLogFiles();_0x30cc46%0x6==0x0&&triggerAnalytics();_0x30cc46%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x99ab55=_0x319732;fs[_0x99ab55(0x2f6)](configpath,{'withFileTypes':!![]})['forEach'](_0x490c1c=>{const _0x267f08=_0x99ab55;if(!_0x490c1c['isDirectory']())fs['copyFileSync'](configpath+_0x490c1c[_0x267f08(0x2b9)],configbackuppath+_0x490c1c[_0x267f08(0x2b9)]);});}function rotateLogFiles(){const _0x32a7fc=_0x319732,_0x3c516e=fs['statSync'](logspath+'output-000.log'),_0x2f1cc9=_0x3c516e['size']/0x400;if(_0x2f1cc9>0x32){let _0x6e7be2=fs[_0x32a7fc(0x2f6)](logspath,{'withFileTypes':!![]});_0x6e7be2[_0x32a7fc(0x2e2)]((_0x3f5790,_0x326a7d)=>_0x3f5790[_0x32a7fc(0x2b9)]<_0x326a7d['name']?0x1:_0x326a7d[_0x32a7fc(0x2b9)]<_0x3f5790[_0x32a7fc(0x2b9)]?-0x1:0x0),_0x6e7be2[_0x32a7fc(0x274)](_0x2e9b03=>{const _0x436eb8=_0x32a7fc;if(_0x2e9b03['name']=='output-002.log')fs[_0x436eb8(0x1d2)](logspath+_0x2e9b03[_0x436eb8(0x2b9)],logspath+_0x436eb8(0x2de));if(_0x2e9b03[_0x436eb8(0x2b9)]==_0x436eb8(0x26f))fs[_0x436eb8(0x1d2)](logspath+_0x2e9b03[_0x436eb8(0x2b9)],logspath+_0x436eb8(0x224));_0x2e9b03[_0x436eb8(0x2b9)]==_0x436eb8(0x2d9)&&(fs['copyFileSync'](logspath+_0x2e9b03[_0x436eb8(0x2b9)],logspath+_0x436eb8(0x26f)),fs['writeFileSync'](logspath+_0x2e9b03['name'],''));});}}async function zipFiles(_0x43fdcf){const _0x40f526=_0x319732;let _0x4d646c;if(_0x43fdcf==_0x40f526(0x2ef))_0x4d646c=logspath;if(_0x43fdcf==_0x40f526(0x2d1))_0x4d646c=configpath;let _0x4706f7=fs[_0x40f526(0x2f6)](_0x4d646c,{'withFileTypes':!![]});const _0x3ce71d=new require(_0x40f526(0x272))();_0x4706f7[_0x40f526(0x274)](_0x4dc888=>{const _0x5a90fe=_0x40f526;if(!_0x4dc888[_0x5a90fe(0x21a)]()){let _0x3d5c71=fs['readFileSync'](_0x4d646c+_0x4dc888[_0x5a90fe(0x2b9)]);const _0x5b5d77=/^bot-[0-9]{3}-config.json$/,_0x3c982d=_0x5b5d77[_0x5a90fe(0x2f1)](_0x4dc888['name']);if(_0x3c982d){const _0x1260ea=JSON[_0x5a90fe(0x1cd)](_0x3d5c71);_0x1260ea[_0x5a90fe(0x308)][0x0][_0x5a90fe(0x313)]=_0x5a90fe(0x312),_0x1260ea[_0x5a90fe(0x308)][0x0][_0x5a90fe(0x32b)]=_0x5a90fe(0x312),_0x3d5c71=JSON[_0x5a90fe(0x27c)](_0x1260ea,null,0x2);}if(_0x4dc888[_0x5a90fe(0x2b9)]==_0x5a90fe(0x2c5)){const _0x5c9f7b=JSON[_0x5a90fe(0x1cd)](_0x3d5c71);if(_0x5c9f7b['settings'][_0x5a90fe(0x2cc)])_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x2cc)]=![];if(_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x2a7)])_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x2a7)]='***';if(_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x280)])_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x280)]=_0x5a90fe(0x312);if(_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x1aa)])_0x5c9f7b[_0x5a90fe(0x30a)][_0x5a90fe(0x1aa)]=null;_0x3d5c71=JSON['stringify'](_0x5c9f7b,null,0x2);}if(_0x4dc888[_0x5a90fe(0x2b9)]!=_0x5a90fe(0x23c))_0x3ce71d[_0x5a90fe(0x1df)](_0x4dc888['name'],_0x3d5c71);}});const _0x532174=_0x3ce71d[_0x40f526(0x2aa)]({'base64':![],'compression':_0x40f526(0x330)});fs[_0x40f526(0x269)](zippath+(_0x43fdcf+'.zip'),_0x532174,_0x40f526(0x29d));}async function unzipFile(_0x433f54,_0x2ac64b){const _0x23b0f3=_0x319732;await backupConfigFiles(),fs[_0x23b0f3(0x2f6)](configpath,{'withFileTypes':!![]})['forEach'](_0x4eb5ca=>{const _0x33a686=_0x23b0f3;if(!_0x4eb5ca['isDirectory']())fs[_0x33a686(0x212)](configpath+_0x4eb5ca[_0x33a686(0x2b9)]);});const _0x29307=fs[_0x23b0f3(0x1b6)](_0x433f54+_0x2ac64b,_0x23b0f3(0x29d)),_0xe27084=new require(_0x23b0f3(0x272))(_0x29307,{'base64':![],'checkCRC32':!![]});Object[_0x23b0f3(0x281)](_0xe27084[_0x23b0f3(0x22a)])[_0x23b0f3(0x274)](_0x1ae155=>{const _0x58a11b=_0x23b0f3,_0x48c0f0=_0xe27084[_0x58a11b(0x22a)][_0x1ae155];fs[_0x58a11b(0x269)](configpath+_0x48c0f0[_0x58a11b(0x2b9)],_0x48c0f0[_0x58a11b(0x1e3)]);}),fs[_0x23b0f3(0x2f6)](temppath,{'withFileTypes':!![]})['forEach'](_0x4285a3=>{const _0x5afa78=_0x23b0f3;if(!_0x4285a3[_0x5afa78(0x21a)]())fs['rmSync'](temppath+_0x4285a3['name']);}),process[_0x23b0f3(0x232)]({'restore':!![]},_0x2aedf7=>{});}async function getPublicIp(){const _0x2b6f70=_0x319732;try{const _0x522a3d=await axios[_0x2b6f70(0x282)](_0x2b6f70(0x1b9));publicip=_0x522a3d[_0x2b6f70(0x311)]['ip'];}catch(_0x15f550){}}async function triggerAnalytics(){const _0x33151a=_0x319732;if(!publicip)await getPublicIp();const _0x41e913=getBotsWithMode();let _0x131f33=0x0;_0x41e913[_0x33151a(0x274)](_0x2c8cd1=>{const _0x26c668=_0x33151a;if(_0x2c8cd1[_0x26c668(0x252)]===_0x26c668(0x28a))_0x131f33++;}),mixpanel['track'](_0x33151a(0x24a),{'distinct_id':settings[_0x33151a(0x2ac)],'ip':publicip,'version':serverversion,'numbots':_0x41e913[_0x33151a(0x2fd)],'numbotsenabled':_0x131f33});}async function getMessages(){const _0x16226a=_0x319732,_0x12bb27=_0x16226a(0x327),_0x54cbb6=new GraphQLClient(_0x12bb27),_0x47c6f5={'authorization':_0x16226a(0x284)},_0x8cae44=serverversion[_0x16226a(0x1fd)]('.'),_0xf9f838=_0x8cae44[0x0]+'.'+_0x8cae44[0x1],_0x99f981=Math[_0x16226a(0x32f)](settings[_0x16226a(0x1da)],settings[_0x16226a(0x26e)]),_0x32440d={'last':parseInt(_0x99f981),'bbm':_0xf9f838},_0x300117=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5c0e0b;try{_0x5c0e0b=await _0x54cbb6[_0x16226a(0x29e)](_0x300117,_0x32440d,_0x47c6f5);}catch(_0x6b5bf8){}if(_0x5c0e0b&&_0x5c0e0b[_0x16226a(0x1d1)]){let _0x37ebcc=settings[_0x16226a(0x1da)];newMessages=[];for(const _0x4be639 of _0x5c0e0b[_0x16226a(0x1d1)]){newMessages[_0x16226a(0x2d3)](_0x4be639);if(_0x4be639[_0x16226a(0x23b)])updateSetting(_0x16226a(0x1dd),_0x4be639[_0x16226a(0x23b)]);let _0x812779=_0x4be639[_0x16226a(0x23b)]?serverversion>=_0x4be639['bbvNew']:![];if(!_0x812779&&_0x4be639['number']>_0x37ebcc){if(_0x4be639[_0x16226a(0x1e1)]===_0x16226a(0x1af)||serverversion[_0x16226a(0x21c)](_0x4be639[_0x16226a(0x1e1)])){let _0x461ca8=''+_0x4be639[_0x16226a(0x2e4)]+'\x0a\x0a'+_0x4be639[_0x16226a(0x283)];const _0x4c3717=await sendTelegramMsg(toTelegramMarkdown(_0x461ca8),_0x16226a(0x2cd));if(_0x4c3717)_0x37ebcc=_0x4be639['number'];}}}updateAvailable=isNewerVersion(settings[_0x16226a(0x1dd)],serverversion),updateSetting(_0x16226a(0x1da),_0x37ebcc),emitMessages();}}function emitMessages(){const _0x45ae85=_0x319732,_0x2a6633=settings['lastmsgemitted'];let _0x41b241=[];newMessages[_0x45ae85(0x274)](_0x1720f9=>{const _0x38cb12=_0x45ae85;_0x1720f9['number']>_0x2a6633&&_0x41b241[_0x38cb12(0x2d3)](_0x1720f9);}),_0x41b241[_0x45ae85(0x2fd)]>0x0&&getAllClients()[_0x45ae85(0x274)](_0x5f262a=>{const _0x9c7650=_0x45ae85;getSocket(_0x5f262a['id'])[_0x9c7650(0x20d)](_0x9c7650(0x283),_0x41b241);});}function confirmMessage(_0x180ada){const _0x59b2c4=_0x319732;updateSetting(_0x59b2c4(0x26e),Number(_0x180ada));}function isNewerVersion(_0x2d3ee0,_0x49062a){const _0xc808b1=_0x319732,_0x434610=_0x49062a[_0xc808b1(0x1fd)]('.'),_0x53e196=_0x2d3ee0['split']('.');for(var _0x1d41d3=0x0;_0x1d41d3<_0x53e196[_0xc808b1(0x2fd)];_0x1d41d3++){const _0x2f2dc8=~~_0x53e196[_0x1d41d3],_0x492443=~~_0x434610[_0x1d41d3];if(_0x2f2dc8>_0x492443)return!![];if(_0x2f2dc8<_0x492443)return![];}return![];}function toTelegramMarkdown(_0x5061b0){const _0x1b042=_0x319732,_0x24c29d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x556124=/\*{2}(.+?)\*{2}/gim;return _0x5061b0=_0x5061b0[_0x1b042(0x1c8)](_0x24c29d,'$1_$2_$3')['replace'](_0x556124,_0x1b042(0x2f4)),_0x5061b0;}async function validateConfigFile(){const _0xe4ddcd=_0x319732,_0xf617cb=dbConfig[_0xe4ddcd(0x282)](_0xe4ddcd(0x26a))['sortBy'](_0xe4ddcd(0x2df))[_0xe4ddcd(0x2dc)]()||[];if(_0xf617cb['length']==0x0){let _0x378b91=0x0,_0x26d9c0=[];const _0x324557=/^bot-([0-9]{3})-config.json$/,_0x3ca1f0=fs[_0xe4ddcd(0x2f6)](configpath);_0x3ca1f0[_0xe4ddcd(0x274)](_0x12c0ca=>{const _0x59afb7=_0xe4ddcd,_0x52e89b=_0x324557[_0x59afb7(0x297)](_0x12c0ca);if(_0x52e89b){const _0x58ce19=_0x52e89b[0x1];let _0x3bad78=getBotAttributes(_0x58ce19);_0x26d9c0['push']({'botID':_0x58ce19,'botname':_0x3bad78[_0x59afb7(0x1f4)],'status':'disabled','live':_0x59afb7(0x33a)}),_0x378b91++;}}),_0x378b91!=0x0&&(dbConfig[_0xe4ddcd(0x282)](_0xe4ddcd(0x26a))['assign'](_0x26d9c0)[_0xe4ddcd(0x299)](),config=_0x26d9c0,restoredConfigFile=_0x378b91);}}async function restoreConfigNotify(_0x476be5){const _0xb52b96=_0x319732;let _0x191d71;if(restoredConfigFile==0x1)_0x191d71=_0xb52b96(0x1b1);else _0x191d71='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x476be5)io['to'](_0xb52b96(0x1f7))[_0xb52b96(0x20d)](_0xb52b96(0x32a),_0x191d71);else{logger[_0xb52b96(0x27f)](_0xb52b96(0x2ab)),logger['simple'](_0x191d71),logger[_0xb52b96(0x27f)](_0xb52b96(0x2ab)),logger['simple']('');if(tgBot&&settings[_0xb52b96(0x1aa)]&&settings[_0xb52b96(0x1a3)]!='orders')tgBot[_0xb52b96(0x201)](settings[_0xb52b96(0x1aa)],'Bot\x20Mgr\x20>\x20'+_0x191d71)[_0xb52b96(0x1c4)](_0x2fef6f=>{telegramError(_0x2fef6f);});}}function validateCredentials(_0x395a5f,_0x1f231e){const _0x4d43c6=_0x319732;if(_0x395a5f['username']==settings['bbUsername']&&bcrypt[_0x4d43c6(0x276)](_0x395a5f['password'],settings[_0x4d43c6(0x2a7)])){if(settings[_0x4d43c6(0x31d)])return{'allow':![],'reason':_0x4d43c6(0x2b1),'token':null};else{const _0x3f2779=generateLoginToken(_0x1f231e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3f2779};}}else return{'allow':![],'reason':_0x4d43c6(0x325),'token':null};}function refreshToken(_0x4c6f0b){const _0x258048=_0x319732,_0x2cd090=generateLoginToken(_0x4c6f0b);return{'allow':!![],'reason':_0x258048(0x1e0),'token':_0x2cd090};}function validateAccess(_0x12692a,_0x37a667,_0xe4375e){const _0x721610=_0x319732,_0x2e4ed4=_0xe4375e?_0xe4375e:devices[_0x37a667]['ip'];let _0x57783e;const _0x2ff3a7=_0x1e5bc1=>{const _0x190bfe=_0x5575;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x37a667)){const _0xbf563e=generateLoginToken(_0x37a667);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0xbf563e};}else return{'allow':![],'reason':_0x190bfe(0x315),'token':null};}else return _0x57783e=validToken(_0x1e5bc1,_0x37a667),_0x57783e[_0x190bfe(0x285)](_0x190bfe(0x20b))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x1e5bc1}:{'allow':![],'reason':_0x190bfe(0x315),'token':null};}else return{'allow':!![],'reason':_0x190bfe(0x300),'token':null};};if(settings[_0x721610(0x246)]){let _0x1a2514=[...settings[_0x721610(0x254)],_0x721610(0x1b4),_0x721610(0x2a5),'127.0.0.1'];if(_0x1a2514['includes'](_0x2e4ed4))return _0x2ff3a7(_0x12692a);else{_0x57783e=validToken(_0x12692a,_0x37a667);if(_0x57783e[_0x721610(0x285)](_0x721610(0x20b)))return _0x2ff3a7(_0x12692a);else{if(telegramIpApproved(_0x37a667)){const _0x10c8d2=generateToken(_0x37a667);return _0x57783e=_0x2ff3a7(_0x12692a),_0x57783e[_0x721610(0x2d6)]?{'allow':!![],'reason':_0x721610(0x301),'token':_0x10c8d2}:_0x57783e;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x721610(0x309),'token':null}:{'allow':![],'reason':_0x721610(0x26b),'token':null};}}}else return _0x2ff3a7(_0x12692a);}function timelyDecrypt(_0x4b0d5e,_0x4924f0=!![]){const _0x6bd0f2=_0x319732;if(_0x4b0d5e)try{const _0x5a1448=crypt[_0x6bd0f2(0x30f)](secure['privateKey'],_0x4b0d5e)['message'],_0x2d6f79=_0x5a1448[_0x6bd0f2(0x1fd)]('@')[0x0],_0x412d80=_0x5a1448['split']('@')[0x1],_0x4a1939=new Date()[_0x6bd0f2(0x1fa)]();if(_0x4924f0){if(_0x4a1939-_0x412d80<maxSecretAge*0x3e8)return _0x2d6f79;else return![];}else return _0x2d6f79;}catch(_0x12822f){return![];}else return![];}const validToken=(_0x3ec956,_0x241da7)=>{const _0xaabd04=_0x319732,_0xe72c7b=devices[_0x241da7]['ip'];if(!_0x3ec956)return{'error':_0xaabd04(0x262)};for(let _0x56185c of blacklist){if(_0x56185c[_0xaabd04(0x2a6)]==_0x3ec956)return{'error':_0xaabd04(0x1f8)};}let _0x4ba54f;try{_0x4ba54f=jwt[_0xaabd04(0x2bd)](_0x3ec956,secure[_0xaabd04(0x26c)]+_0x241da7);}catch{return{'error':_0xaabd04(0x1a4)};}if(!_0x4ba54f['hasOwnProperty'](_0xaabd04(0x226))&&!_0x4ba54f[_0xaabd04(0x285)](_0xaabd04(0x255))||!_0x4ba54f[_0xaabd04(0x285)](_0xaabd04(0x2ff)))return{'error':_0xaabd04(0x31e)};if(!_0x4ba54f[_0xaabd04(0x285)](_0xaabd04(0x255))&&_0x4ba54f[_0xaabd04(0x285)](_0xaabd04(0x226))){const {clientip:_0x2a2086}=_0x4ba54f;return _0xe72c7b==_0x2a2086?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xaabd04(0x33e)};}else{if(_0x4ba54f[_0xaabd04(0x285)](_0xaabd04(0x255))&&_0x4ba54f[_0xaabd04(0x285)](_0xaabd04(0x226))){const {username:_0x167f56,clientip:_0x5c613a}=_0x4ba54f;return settings[_0xaabd04(0x243)]==_0x167f56&&_0xe72c7b==_0x5c613a?{'success':_0xaabd04(0x1f2)}:{'error':_0xaabd04(0x24d)};}}},generateLoginToken=_0x2f0ccf=>{const _0x25a874=_0x319732;if(_0x2f0ccf){const _0x4db840=devices[_0x2f0ccf]['ip'];return jwt[_0x25a874(0x1b3)]({'username':settings['bbUsername'],'clientip':_0x4db840},secure[_0x25a874(0x26c)]+_0x2f0ccf,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x28bea5=>{const _0x5b3c5a=_0x319732;if(_0x28bea5){const _0x36d1d8=devices[_0x28bea5]['ip'];return jwt[_0x5b3c5a(0x1b3)]({'clientip':_0x36d1d8},secure['secret']+_0x28bea5,{'expiresIn':devices[_0x28bea5]['telegramIpApproval'][_0x5b3c5a(0x323)]*0x3c});}else return![];},telegramIpApproved=_0x869d40=>{const _0x59f550=_0x319732;let _0x34d275=![];return devices[_0x869d40][_0x59f550(0x31c)]&&devices[_0x869d40][_0x59f550(0x31c)][_0x59f550(0x323)]!=_0x59f550(0x221)&&(_0x34d275=devices[_0x869d40][_0x59f550(0x31c)][_0x59f550(0x226)]==devices[_0x869d40]['ip']&&new Date()[_0x59f550(0x1fa)]()-devices[_0x869d40]['telegramIpApproval'][_0x59f550(0x1de)]<devices[_0x869d40][_0x59f550(0x31c)][_0x59f550(0x323)]*0x3c*0x3e8),_0x34d275;},telegram2FaApproved=_0x5c99da=>{const _0x293796=_0x319732;let _0x58334=![];return devices[_0x5c99da]['telegram2FaApproval']&&devices[_0x5c99da]['telegram2FaApproval'][_0x293796(0x323)]!=_0x293796(0x221)&&(_0x58334=devices[_0x5c99da]['telegram2FaApproval'][_0x293796(0x226)]==devices[_0x5c99da]['ip']&&new Date()[_0x293796(0x1fa)]()-devices[_0x5c99da][_0x293796(0x1c0)][_0x293796(0x1de)]<devices[_0x5c99da][_0x293796(0x1c0)]['expiry']*0x3c*0x3e8),_0x58334;},normalizeIP=_0x1f0428=>{const _0x576ff3=_0x319732;let _0x246fe2=null,_0x36300e=null;if(ipaddr[_0x576ff3(0x216)](_0x1f0428)){const _0x45b7ee=ipaddr[_0x576ff3(0x1cd)](_0x1f0428);_0x45b7ee['kind']()===_0x576ff3(0x215)?(_0x45b7ee[_0x576ff3(0x26d)]()&&(_0x246fe2=_0x45b7ee[_0x576ff3(0x2a0)]()[_0x576ff3(0x233)]()),_0x36300e=_0x45b7ee[_0x576ff3(0x233)]()):(_0x246fe2=_0x45b7ee[_0x576ff3(0x233)](),_0x36300e=_0x45b7ee[_0x576ff3(0x1f1)]()['toString']());}return{'show':_0x246fe2?_0x246fe2:_0x36300e,'store':_0x36300e};};function sleep(_0xe3c3bd){return new Promise(_0x39a2bc=>setTimeout(_0x39a2bc,_0xe3c3bd));}