const _0x13e9f2=_0x37c9;(function(_0x33926c,_0xaf1cbd){const _0x38e697=_0x37c9,_0x415392=_0x33926c();while(!![]){try{const _0x74ae81=parseInt(_0x38e697(0x248))/0x1+-parseInt(_0x38e697(0x2cd))/0x2+-parseInt(_0x38e697(0x230))/0x3*(-parseInt(_0x38e697(0x256))/0x4)+parseInt(_0x38e697(0x220))/0x5+parseInt(_0x38e697(0x2be))/0x6*(parseInt(_0x38e697(0x228))/0x7)+-parseInt(_0x38e697(0x280))/0x8+-parseInt(_0x38e697(0x2b5))/0x9*(parseInt(_0x38e697(0x2cb))/0xa);if(_0x74ae81===_0xaf1cbd)break;else _0x415392['push'](_0x415392['shift']());}catch(_0xa4d7db){_0x415392['push'](_0x415392['shift']());}}}(_0x573a,0x63181));const _0x5d437c=function(){let _0x33c254=!![];return function(_0x455ae8,_0x5476c3){const _0x1e66d1=_0x33c254?function(){const _0x2c9ae0=_0x37c9;if(_0x5476c3){const _0x41873e=_0x5476c3[_0x2c9ae0(0x1d8)](_0x455ae8,arguments);return _0x5476c3=null,_0x41873e;}}:function(){};return _0x33c254=![],_0x1e66d1;};}(),_0x4d40aa=_0x5d437c(this,function(){const _0x3b2de8=_0x37c9;return _0x4d40aa[_0x3b2de8(0x24c)]()['search'](_0x3b2de8(0x226))[_0x3b2de8(0x24c)]()['constructor'](_0x4d40aa)[_0x3b2de8(0x2b3)]('(((.+)+)+)+$');});_0x4d40aa();'use strict';process[_0x13e9f2(0x251)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require(_0x13e9f2(0x1dd)),low=require(_0x13e9f2(0x201)),path=require(_0x13e9f2(0x2a4)),crypto=require(_0x13e9f2(0x195)),Crypt=require(_0x13e9f2(0x198))['Crypt'],RSA=require(_0x13e9f2(0x198))[_0x13e9f2(0x1b7)],bcrypt=require('bcryptjs'),jwt=require(_0x13e9f2(0x27b)),analyticsLib=require('analytics')[_0x13e9f2(0x2cc)],googleAnalytics=require(_0x13e9f2(0x229))[_0x13e9f2(0x2cc)],ipaddr=require(_0x13e9f2(0x1fe)),argv=require(_0x13e9f2(0x1c3))(process['argv'][_0x13e9f2(0x1fa)](0x2))['argv'],PORT=argv[_0x13e9f2(0x25e)]||_0x13e9f2(0x2c3),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x13e9f2(0x213)](PORT))return console[_0x13e9f2(0x1ea)](_0x13e9f2(0x1f6)+PORT+_0x13e9f2(0x1c7)),process['exit'](0x1);const HOST=argv[_0x13e9f2(0x245)]||null,userID=argv[_0x13e9f2(0x2a0)]||'';let bbpath=_0x13e9f2(0x236),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x13e9f2(0x2c9);!fs[_0x13e9f2(0x1b4)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x13e9f2(0x265)),configpath=userID?bbpath+_0x13e9f2(0x24b)+userID+'/':bbpath+_0x13e9f2(0x24b),configbackuppath=configpath+'backup/';!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x13e9f2(0x1b4)](configbackuppath)&&fs[_0x13e9f2(0x231)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x13e9f2(0x1c5)]({'bots':[]})[_0x13e9f2(0x289)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x13e9f2(0x1c5)]({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x13e9f2(0x1c5)]({'secure':{},'blacklist':[]})[_0x13e9f2(0x289)]();let crypt=new Crypt({'md':_0x13e9f2(0x29a),'rsaStandard':_0x13e9f2(0x244)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x13e9f2(0x26c))[_0x13e9f2(0x253)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x13e9f2(0x1b8)),app=express(),http=require(_0x13e9f2(0x233))[_0x13e9f2(0x271)](app);app[_0x13e9f2(0x1de)](express[_0x13e9f2(0x219)](path['join'](__dirname,bbpath2,'build2'))),app[_0x13e9f2(0x1de)](express[_0x13e9f2(0x219)](path[_0x13e9f2(0x1f9)](__dirname,bbpath2,'build'))),app[_0x13e9f2(0x1b1)]('/',function(_0x17b13d,_0x368212){const _0x7043cc=_0x13e9f2;_0x368212['sendFile'](path['join'](__dirname,bbpath2,_0x7043cc(0x1cc),_0x7043cc(0x257)));}),app[_0x13e9f2(0x1b1)](_0x13e9f2(0x1d7),function(_0x218e17,_0x48eee9){const _0x48fa56=_0x13e9f2;_0x48eee9[_0x48fa56(0x24f)](path[_0x48fa56(0x1f9)](__dirname,bbpath2,_0x48fa56(0x1f5),_0x48fa56(0x257)));}),app[_0x13e9f2(0x1b1)](_0x13e9f2(0x1e5),(_0x2eb0cd,_0x24f177)=>{const _0x9e8cd=_0x13e9f2;_0x24f177[_0x9e8cd(0x24f)](path[_0x9e8cd(0x1f9)](__dirname,bbpath2,'build',_0x9e8cd(0x257)));}),app[_0x13e9f2(0x1b1)](_0x13e9f2(0x286),(_0x14d4eb,_0x3ff230)=>{const _0x2c571d=_0x13e9f2;_0x3ff230['sendFile'](path[_0x2c571d(0x1f9)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x13e9f2(0x1eb),(_0x47da3,_0x469cf9)=>{const _0x294507=_0x13e9f2;_0x469cf9['sendFile'](path['join'](__dirname,bbpath2,_0x294507(0x1f5),_0x294507(0x257)));}),app[_0x13e9f2(0x1b1)](_0x13e9f2(0x294),(_0x590d4d,_0x2682e7)=>{const _0x167e32=_0x13e9f2;_0x2682e7[_0x167e32(0x24f)](path['join'](__dirname,bbpath2,_0x167e32(0x1f5),_0x167e32(0x257)));}),app[_0x13e9f2(0x1b1)](_0x13e9f2(0x24a),(_0x316451,_0x2ed771)=>{const _0x3d655f=_0x13e9f2;_0x2ed771[_0x3d655f(0x24f)](path[_0x3d655f(0x1f9)](__dirname,bbpath2,'build',_0x3d655f(0x257)));}),app['get'](_0x13e9f2(0x1ee),(_0x3172ff,_0xc2cf69)=>{const _0x5a3fd2=_0x13e9f2;_0xc2cf69[_0x5a3fd2(0x24f)](path[_0x5a3fd2(0x1f9)](__dirname,bbpath2,'build',_0x5a3fd2(0x257)));});if(HOST)http['listen'](PORT,HOST);else http[_0x13e9f2(0x1a4)](PORT);const io=require(_0x13e9f2(0x293))(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':_0x13e9f2(0x23a)})]}),TelegramBot=require(_0x13e9f2(0x1a1));let tgBot;if(settings[_0x13e9f2(0x242)]&&settings[_0x13e9f2(0x242)]!=''&&settings['telegramUsername']&&settings[_0x13e9f2(0x20d)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x32a49c=_0x13e9f2;console['log'](''),console['log'](_0x32a49c(0x1e6)),logging(_0x32a49c(0x1c2)+PORT),console['log'](_0x32a49c(0x1e6));if(config[_0x32a49c(0x24d)]!=0x0)config[_0x32a49c(0x2ae)](_0x2fe9a6=>{const _0x494826=_0x32a49c;if(_0x2fe9a6[_0x494826(0x1a6)]==_0x494826(0x1e1)||_0x2fe9a6[_0x494826(0x1a6)]=='new')logging(_0x494826(0x239)+_0x2fe9a6[_0x494826(0x1ff)]+'\x20|\x20'+_0x2fe9a6['botname']),startBot([_0x2fe9a6['botID'],userID],{'cwd':bbpath},function(_0xdf2870){if(_0xdf2870)logging(_0xdf2870);});else(_0x2fe9a6['status']==_0x494826(0x272)||_0x2fe9a6[_0x494826(0x1a6)]==_0x494826(0x1ce))&&logging(_0x494826(0x2a6)+_0x2fe9a6[_0x494826(0x1ff)]+_0x494826(0x214)+_0x2fe9a6[_0x494826(0x1a2)]);});else!newBot&&console['log'](_0x32a49c(0x2a1));if(newBot)addBot();console[_0x32a49c(0x1ea)](_0x32a49c(0x1e6)),console[_0x32a49c(0x1ea)]('');}function startSocket(){io['on']('connection',_0x13621c=>{const _0x22ddb3=_0x37c9;let _0x3a339d,_0x32060a,_0x345d46,_0xadabf0,_0x38396b;const _0x5e67ed=_0x13621c['handshake'][_0x22ddb3(0x22c)][_0x22ddb3(0x208)];_0x32060a=_0x5e67ed[_0x22ddb3(0x247)](/bot[0-9]{3}/);if(_0x32060a)_0x345d46=_0x32060a[0x0]['match'](/[0-9]{3}/);if(_0x345d46)_0x3a339d=_0x345d46[0x0];else _0x3a339d=_0x22ddb3(0x209);const _0x531e95=_0x13621c[_0x22ddb3(0x1c9)][_0x22ddb3(0x26d)][_0x22ddb3(0x19d)];if(!_0x531e95)_0x13621c[_0x22ddb3(0x2b9)](_0x22ddb3(0x1a6),{'publicKey':secure[_0x22ddb3(0x2b2)]});else{_0xadabf0=timelyDecrypt(_0x531e95,![]);if(!_0xadabf0)logging(_0x22ddb3(0x2b4));else{_0x38396b=normalizeIP(_0x13621c[_0x22ddb3(0x2ab)][_0x22ddb3(0x262)])[_0x22ddb3(0x25c)];if(!devices[_0xadabf0])devices[_0xadabf0]={'uuid':_0xadabf0,'access':{'token':null}};devices[_0xadabf0]['ip']=_0x38396b;const _0xea54f=addClient(_0x13621c['id'],_0xadabf0,_0x3a339d);setAccess(_0xea54f),_0x13621c['on'](_0x22ddb3(0x281),_0x193888=>{const _0x17e04f=_0x22ddb3,_0x46eefc=timelyDecrypt(_0x193888[_0x17e04f(0x1db)]);if(_0x46eefc){_0x193888={'username':_0x193888[_0x17e04f(0x227)],'password':_0x46eefc},devices[_0xadabf0]['access']=validateCredentials(_0x193888,_0xadabf0);if(devices[_0xadabf0][_0x17e04f(0x203)][_0x17e04f(0x28d)]==![]&&devices[_0xadabf0]['access'][_0x17e04f(0x29d)]=='2FA\x20login\x20required')_0x13621c[_0x17e04f(0x2b9)](_0x17e04f(0x1a6),{'access':devices[_0xadabf0][_0x17e04f(0x203)]}),loginAccess2FA(_0xadabf0,_0x38396b);else{if(devices[_0xadabf0][_0x17e04f(0x203)][_0x17e04f(0x28d)]==![]&&devices[_0xadabf0][_0x17e04f(0x203)][_0x17e04f(0x29d)]==_0x17e04f(0x2a9))_0x13621c['emit'](_0x17e04f(0x1a6),{'access':devices[_0xadabf0][_0x17e04f(0x203)]});else devices[_0xadabf0][_0x17e04f(0x203)]['allow']&&devices[_0xadabf0][_0x17e04f(0x203)][_0x17e04f(0x29d)]==_0x17e04f(0x291)&&(getClientsWithUuid(_0xadabf0)[_0x17e04f(0x2ae)](_0x5f0685=>{setAccess(_0x5f0685);}),setTokenRefresh(_0xadabf0),setSessionTimeout('login',_0xadabf0));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x13621c['on'](_0x22ddb3(0x1d3),()=>{resetPassword();}),_0x13621c['on'](_0x22ddb3(0x19f),_0x196edd=>{removeClient(_0x13621c['id']);});}}});}function initClient(_0x3fb20e){const _0x20b0da=_0x13e9f2;if(_0x3fb20e!=_0x20b0da(0x209)&&config['apiKey']!=''){if(pid[_0x3fb20e])pid[_0x3fb20e][_0x20b0da(0x298)]({'function':_0x20b0da(0x258),'args':null});}}function getSocket(_0x3036a7){const _0x7ab2d0=_0x13e9f2;return io[_0x7ab2d0(0x21c)][_0x7ab2d0(0x21c)][_0x7ab2d0(0x1b1)](_0x3036a7);}function _0x37c9(_0xc75113,_0x55dd1a){const _0x49b048=_0x573a();return _0x37c9=function(_0x4d40aa,_0x5d437c){_0x4d40aa=_0x4d40aa-0x194;let _0x573a80=_0x49b048[_0x4d40aa];return _0x573a80;},_0x37c9(_0xc75113,_0x55dd1a);}function _0x573a(){const _0x3292c1=['bot-','Invalid\x20Telegram\x20token','clients','Notifications\x20enabled\x0a','cloneDeep','Invalid\x20IP\x20address','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','5\x20min','2FA','version.json','auth','settings.','removeAllListeners','kill','createServer','disabled','privateKey','Unauthorized\x20attempt\x20to\x20store\x20configuration','login\x20required','polling_error','\x20/\x20','add-bot','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','deleted\x20Bot\x20','jsonwebtoken','secure','catch','expiry','getFullYear','4678096cbTSUl','login','reload','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','assign','Bot\x20Mgr\x20>\x20','/:bot/performance','filter','\x20>\x20','write','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','reject','2FA\x20login\x20rejected','allow','place-order','Alerts','restarting\x20Bot\x20','login\x20token\x20generated','new','socket.io','/:bot/history','cancelLoading','Unauthorized\x20attempt\x20to\x20delete\x20bot','/disable\x20-\x20disable\x20notifications\x0a','send','uuid','sha256','message','/restart\x20-\x20restart\x20bot(s)\x0a','reason','store-settings','Password\x20has\x20been\x20reset\x20to:\x20','user','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Invalid\x20username\x20or\x20IP\x20address','map','path','settings','idling\x20bot\x20\x20\x20|\x20Bot\x20','answerCallbackQuery','Invalid\x20authentication\x20token\x20(2)','invalid\x20credentials','</b>\x20?','conn','removeListener','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','forEach','telegram2FaApproval','error','emitHistory','publicKey','search','Unauthorized\x20login\x20attempt\x20(public\x20key)','737982hrttNP','placeOrder','Balance\x20Bot\x20Server','whitelistEnabled','emit','set','telegram','f2aRequired','server','26946xMxwLA','randomFillSync','getTime','sendMessage','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','3000','sortBy','::ffff:127.0.0.1','pidExpireLogin','No\x20bots\x20running\x20right\x20now','started','bb-secure.json','secret','30dWNsqt','default','329134nLqsuU','all','update-bb','Token\x20blacklisted','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','https://hodlerhacks.com','running','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','generateKeyPairAsync','1000','callback_query','15\x20min','crypto','ipv6','pidRefreshToken','hybrid-crypto-js','telegramEnabled','get-portfolio','args','getMonth','encryptedUuid','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','disconnect','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','node-telegram-bot-api','botname','stop','listen','SIGINT','status','Notifications\x20types:\x20','fork','temporary\x20access\x20timeout','unlinkSync','Temporary\x20access\x20rejected','type','Unauthorized\x20attempt\x20to\x20log\x20out','readdirSync','-results.json','isValid','get','telegramIpApproval','storeConfiguration','existsSync','function','exp','RSA','express','HTML','timestamp','cancel-loading','padStart','************','push','storeHeadless','Bot\x20','remove','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','yargs/yargs','stopPolling','defaults','getDate',',\x20must\x20be\x20a\x204\x20digit\x20number','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','handshake','logged\x20out','/on\x20-\x20start\x20bot(s)\x0a','build2','-events.json','new-disabled','bbUsername','127.0.0.1','getStartingBalances','once','reset-password','::1','Invalid\x20authentication\x20token\x20(1)','disabled\x20Bot\x20','/:bot','apply','kind','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','password','Unauthorized\x20attempt\x20to\x20update\x20settings','date-fns','use','-config.json','All\x20bots\x20running\x20right\x20now','enabled','hasOwnProperty','getHours','temporaryAccessAllowed','/:bot/portfolio','-----------------------------------------------------------------------------------','/status\x20-\x20show\x20bot(s)\x20status\x0a','Password\x20reset\x20rejected','\x20only\x0a','log','/:bot/coins','connected','accept','/:bot/support',':\x20Bot\x20Mgr\x20>\x20','/help\x20-\x20show\x20available\x20commands\x0a','Allow\x20login\x20from\x20IP\x20address\x20<b>','split','/enable\x20-\x20enable\x20notifications\x0a','entries','build','Error:\x20Invalid\x20argument\x20','compareSync','2FA\x20login\x20required','join','slice','bot','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','blacklist','ipaddr.js','botID','show','lowdb','temporary\x20access\x20not\x20allowed','access','logout','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','exit','getSeconds','referer','botmanager','User\x20has\x20been\x20validated','find','getUTCHours','telegramUsername','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','data','page','stopped','inherit','test','\x20|\x20','clientip','name','telegramChatId','\x20minutes','static','No\x20authentication\x20token','live','sockets','decrypt','bots','Notifications\x20enabled','769440mFlACG','telegramEvents','sign','All\x20bots','from','bbPassword','(((.+)+)+)+$','username','238tszPsR','@analytics/google-analytics','chat','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','headers','getMinutes','orders','login\x20not\x20required','141621SMuwsz','mkdirSync','onText','http','hashSync','temporary\x20token\x20generated','bb/','isDirectory','starting\x20new\x20bot\x20|\x20Bot\x20','starting\x20bot\x20|\x20Bot\x20','UA-192771731-1','max','Unauthorized\x20attempt\x20to\x20add\x20bot','get-logs','store-configuration','then','2FA\x20required','whitelist','telegramToken','2FA\x20login\x20token\x20generated','RSA-OAEP','host','Login\x20rejected','match','528146mjjzsX','alerts','/:bot/configuration','config/','toString','length','success','sendFile','Access\x20enabled\x20for\x20','env','token','version','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Orders','48YtODLa','index.html','initclient','loginRequired','get-starting-balances','order','store','randomBytes','port','value','timeshift','event','remoteAddress'];_0x573a=function(){return _0x3292c1;};return _0x573a();}function setAccess(_0x1e4e7d){const _0x360382=_0x13e9f2,_0x47db36=getSocket(_0x1e4e7d['id']),_0x32839b=_0x1e4e7d['uuid'],_0x2db02d=_0x1e4e7d['bot'];devices[_0x32839b][_0x360382(0x203)]=validateAccess(devices[_0x32839b][_0x360382(0x203)][_0x360382(0x252)],_0x32839b),_0x47db36[_0x360382(0x1f9)](_0x32839b);if(devices[_0x32839b][_0x360382(0x203)]['allow']){_0x47db36[_0x360382(0x1f9)](_0x2db02d);if(_0x2db02d=='botmanager')initializeSocketBotManager(_0x47db36);else initializeSocketBot(_0x47db36);initClient(_0x2db02d);}devices[_0x32839b][_0x360382(0x203)]['token']&&devices[_0x32839b][_0x360382(0x203)]['reason']==_0x360382(0x235)&&setSessionTimeout(_0x360382(0x26b),_0x32839b),devices[_0x32839b][_0x360382(0x203)][_0x360382(0x252)]&&devices[_0x32839b][_0x360382(0x203)][_0x360382(0x29d)]==_0x360382(0x243)&&setSessionTimeout(_0x360382(0x281),_0x32839b),_0x47db36[_0x360382(0x2b9)](_0x360382(0x1a6),{'status':_0x1e4e7d[_0x360382(0x2bd)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x32839b][_0x360382(0x203)],'externalip':devices[_0x32839b]['ip'],'publicKey':secure[_0x360382(0x2b2)]}),devices[_0x32839b][_0x360382(0x203)][_0x360382(0x28d)]==![]&&devices[_0x32839b][_0x360382(0x203)]['reason']==_0x360382(0x240)&&temporaryAccess2FA(_0x32839b,devices[_0x32839b]['ip']);}function setSessionTimeout(_0x1551a1,_0x3be50){const _0x7086d5=_0x13e9f2;let _0x2f4862;if(_0x1551a1==_0x7086d5(0x281))_0x2f4862=loginExpiry*0x3c*0x3e8;else _0x2f4862=devices[_0x3be50][_0x7086d5(0x1b2)]['expiry']*0x3c*0x3e8-(new Date()[_0x7086d5(0x2c0)]()-devices[_0x3be50][_0x7086d5(0x1b2)][_0x7086d5(0x1ba)]);if(devices[_0x3be50]['pidExpireLogin'])clearTimeout(devices[_0x3be50][_0x7086d5(0x2c6)]);devices[_0x3be50][_0x7086d5(0x2c6)]=setTimeout(()=>{const _0x3afcc6=_0x7086d5;if(devices[_0x3be50][_0x3afcc6(0x197)])clearTimeout(devices[_0x3be50][_0x3afcc6(0x197)]);removeSocketListeners(_0x3be50),addBlacklist(_0x3be50),devices[_0x3be50]['telegramIpApproval']=null,devices[_0x3be50][_0x3afcc6(0x2af)]=null,devices[_0x3be50]['access']['token']=null,devices[_0x3be50][_0x3afcc6(0x203)]=validateAccess(devices[_0x3be50]['access'][_0x3afcc6(0x252)],_0x3be50),!(devices[_0x3be50]['access'][_0x3afcc6(0x28d)]&&devices[_0x3be50][_0x3afcc6(0x203)]['reason']==_0x3afcc6(0x22f))&&(_0x1551a1==_0x3afcc6(0x281)?io['to'](_0x3be50)['emit'](_0x3afcc6(0x1a6),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x3be50)['emit'](_0x3afcc6(0x1a6),{'access':{'allow':![],'reason':_0x3afcc6(0x1a9),'token':null}})),devices[_0x3be50][_0x3afcc6(0x203)][_0x3afcc6(0x252)]=null;},_0x2f4862);}function setTokenRefresh(_0x366ee3){const _0x248251=_0x13e9f2;if(devices[_0x366ee3][_0x248251(0x197)])clearTimeout(devices[_0x366ee3][_0x248251(0x197)]);devices[_0x366ee3]['pidRefreshToken']=setTimeout(()=>{const _0x853efd=_0x248251;getClientsWithUuid(_0x366ee3)[_0x853efd(0x24d)]!=0x0?(devices[_0x366ee3][_0x853efd(0x203)]=refreshToken(_0x366ee3),io['to'](_0x366ee3)[_0x853efd(0x2b9)](_0x853efd(0x1a6),{'status':_0x853efd(0x1ec),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x366ee3][_0x853efd(0x203)],'externalip':devices[_0x366ee3]['ip'],'publicKey':secure[_0x853efd(0x2b2)]}),setTokenRefresh(_0x366ee3)):clearTimeout(devices[_0x366ee3][_0x853efd(0x197)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x244045){const _0x4b1987=_0x13e9f2,_0x329260=getClient(_0x244045['id'])[_0x4b1987(0x299)];_0x244045[_0x4b1987(0x2b9)](_0x4b1987(0x21e),config),_0x244045[_0x4b1987(0x2b9)](_0x4b1987(0x2a5),cleanSettings()),_0x244045['on'](_0x4b1987(0x278),_0x517f67=>{const _0x1ac540=_0x4b1987;if(validateAccess(_0x517f67,_0x329260)[_0x1ac540(0x28d)])addBot();else logging(_0x1ac540(0x23c));}),_0x244045['on']('update-bot',(_0x586cf0,_0x324b24)=>{const _0x4359a3=_0x4b1987;if(validateAccess(_0x324b24,_0x329260)['allow'])toggleBot(_0x586cf0[_0x4359a3(0x1ff)],_0x586cf0[_0x4359a3(0x1a6)],_0x586cf0[_0x4359a3(0x21b)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x244045['on']('delete-bot',(_0xc65b87,_0x59491f)=>{const _0x323738=_0x4b1987;if(validateAccess(_0x59491f,_0x329260)[_0x323738(0x28d)])deleteBot(_0xc65b87);else logging(_0x323738(0x296));}),_0x244045['on'](_0x4b1987(0x29e),(_0x8a026d,_0x479328)=>{const _0x46f0bd=_0x4b1987;if(validateAccess(_0x479328,_0x329260)[_0x46f0bd(0x28d)])storeSettings(_0x8a026d,!![]);else logging(_0x46f0bd(0x1dc));}),_0x244045['on'](_0x4b1987(0x2cf),(_0x336edf,_0x365a68)=>{const _0x209ad9=_0x4b1987;if(validateAccess(_0x365a68,_0x329260)['allow'])updateBB();else logging(_0x209ad9(0x1dc));}),_0x244045['on']('logout',_0x56f2ea=>{const _0x47d165=_0x4b1987;if(validateAccess(_0x56f2ea,_0x329260)[_0x47d165(0x28d)]){if(devices[_0x329260]['pidRefreshToken'])clearTimeout(devices[_0x329260]['pidRefreshToken']);if(devices[_0x329260][_0x47d165(0x2c6)])clearTimeout(devices[_0x329260][_0x47d165(0x2c6)]);removeSocketListeners(getClient(_0x244045['id'])['uuid']),addBlacklist(_0x329260),devices[_0x329260][_0x47d165(0x1b2)]=null,devices[_0x329260][_0x47d165(0x2af)]=null,devices[_0x329260][_0x47d165(0x203)]['token']=null,io['to'](getClient(_0x244045['id'])[_0x47d165(0x299)])[_0x47d165(0x2b9)](_0x47d165(0x1a6),{'access':{'allow':![],'reason':_0x47d165(0x1ca),'token':null}});}else logging(_0x47d165(0x1ad));});}function initializeSocketBot(_0x4acb85){const _0x4dde32=_0x13e9f2,_0x2b72b7=getClient(_0x4acb85['id'])[_0x4dde32(0x1fb)],_0x571a29=getClient(_0x4acb85['id'])['uuid'];_0x4acb85['on'](_0x4dde32(0x23d),(_0x3855f6,_0x1175f9)=>{const _0x111a38=_0x4dde32;if(validateAccess(_0x1175f9,_0x571a29)[_0x111a38(0x28d)]){if(pid[_0x2b72b7])pid[_0x2b72b7]['send']({'function':_0x111a38(0x2b1),'args':_0x3855f6});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x4acb85['on'](_0x4dde32(0x19a),(_0x23cdd8,_0x59b677)=>{const _0xba6aef=_0x4dde32;if(validateAccess(_0x59b677,_0x571a29)[_0xba6aef(0x28d)]){if(pid[_0x2b72b7])pid[_0x2b72b7]['send']({'function':'getPortfolio','args':_0x23cdd8});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x4acb85['on'](_0x4dde32(0x23e),(_0x2729f8,_0x222425)=>{const _0x767dfc=_0x4dde32;if(validateAccess(_0x222425,_0x571a29)[_0x767dfc(0x28d)]){if(pid[_0x2b72b7])pid[_0x2b72b7][_0x767dfc(0x298)]({'function':_0x767dfc(0x1b3),'args':_0x2729f8});}else logging(_0x767dfc(0x274));}),_0x4acb85['on']('store-headless',(_0x3f97ae,_0x5be79b)=>{const _0x14b112=_0x4dde32;if(validateAccess(_0x5be79b,_0x571a29)['allow']){if(pid[_0x2b72b7])pid[_0x2b72b7][_0x14b112(0x298)]({'function':_0x14b112(0x1bf),'args':_0x3f97ae});}else logging(_0x14b112(0x22b));}),_0x4acb85['on'](_0x4dde32(0x25a),_0x5621c4=>{const _0x5679e3=_0x4dde32;if(validateAccess(_0x5621c4,_0x571a29)[_0x5679e3(0x28d)]){if(pid[_0x2b72b7])pid[_0x2b72b7][_0x5679e3(0x298)]({'function':_0x5679e3(0x1d1),'args':null});}else logging(_0x5679e3(0x2c2));}),_0x4acb85['on'](_0x4dde32(0x28e),(_0x22c82e,_0x9f6ed7)=>{const _0x1a12fc=_0x4dde32;if(validateAccess(_0x9f6ed7,_0x571a29)[_0x1a12fc(0x28d)]){if(pid[_0x2b72b7])pid[_0x2b72b7]['send']({'function':_0x1a12fc(0x2b6),'args':_0x22c82e});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x4acb85['on'](_0x4dde32(0x1bb),_0x430791=>{const _0x20f4d0=_0x4dde32;if(validateAccess(_0x430791,_0x571a29)[_0x20f4d0(0x28d)]){if(pid[_0x2b72b7])pid[_0x2b72b7]['send']({'function':_0x20f4d0(0x295),'args':null});}else logging(_0x20f4d0(0x283));}),_0x4acb85['on'](_0x4dde32(0x204),_0x3bb576=>{const _0x3c21a7=_0x4dde32;if(validateAccess(_0x3bb576,_0x571a29)['allow']){if(devices[_0x571a29]['pidRefreshToken'])clearTimeout(devices[_0x571a29][_0x3c21a7(0x197)]);if(devices[_0x571a29][_0x3c21a7(0x2c6)])clearTimeout(devices[_0x571a29]['pidExpireLogin']);removeSocketListeners(getClient(_0x4acb85['id'])[_0x3c21a7(0x299)]),addBlacklist(_0x571a29),devices[_0x571a29][_0x3c21a7(0x1b2)]=null,devices[_0x571a29][_0x3c21a7(0x2af)]=null,devices[_0x571a29][_0x3c21a7(0x203)][_0x3c21a7(0x252)]=null,io['to'](getClient(_0x4acb85['id'])[_0x3c21a7(0x299)])[_0x3c21a7(0x2b9)](_0x3c21a7(0x1a6),{'access':{'allow':![],'reason':_0x3c21a7(0x1ca),'token':null}});}else logging(_0x3c21a7(0x1ad));});}function removeSocketListeners(_0x387be4){getClientsWithUuid(_0x387be4)['forEach'](_0x49552a=>{const _0x56cf21=_0x37c9;getSocket(_0x49552a['id'])[_0x56cf21(0x26f)]();});}function cleanSettings(){const _0x156269=_0x13e9f2;let _0x31e776=settings;return settings['telegramToken']&&settings[_0x156269(0x242)]!=''&&(_0x31e776={..._0x31e776,'telegramToken':_0x156269(0x1bd)}),settings[_0x156269(0x225)]&&settings[_0x156269(0x225)]!=''&&(_0x31e776={..._0x31e776,'bbPassword':_0x156269(0x1bd)}),_0x31e776;}function updateBB(){process['send']({'update':!![]});}function startBot(_0xfd5ed5,_0x283c09,_0x413aab){const _0x27d63e=_0x13e9f2;let _0x3b8a8e=![];const _0x5d81de=_0xfd5ed5[0x0];_0x283c09={..._0x283c09,'stdio':[_0x27d63e(0x212),_0x27d63e(0x212),_0x27d63e(0x212),'ipc']},pid[_0x5d81de]=childProcess[_0x27d63e(0x1a8)](botfile,_0xfd5ed5,_0x283c09),pid[_0x5d81de]['on'](_0x27d63e(0x29b),_0x4bca29=>{const _0x58e61e=_0x27d63e;switch(Object['keys'](_0x4bca29)[0x0]){case _0x58e61e(0x1a2):updateBotName(_0x5d81de,_0x4bca29[_0x58e61e(0x1a2)]);break;case _0x58e61e(0x1a6):updateStatus(_0x5d81de,_0x4bca29[_0x58e61e(0x1a6)]);break;case _0x58e61e(0x21b):updateLive(_0x5d81de,_0x4bca29[_0x58e61e(0x21b)]);break;case _0x58e61e(0x2c8):updateLive(_0x5d81de,_0x4bca29[_0x58e61e(0x2c8)]),io['to'](_0x5d81de)['emit'](_0x58e61e(0x1a6),{'access':{'allow':![],'reason':_0x58e61e(0x282),'token':null}});break;case _0x58e61e(0x1a3):_0x4bca29[_0x58e61e(0x1a3)]=='restart'&&stopBot(_0x5d81de);_0x4bca29[_0x58e61e(0x1a3)]==_0x58e61e(0x270)&&toggleBot(_0x5d81de,_0x58e61e(0x272),'stopped');break;case _0x58e61e(0x2bb):sendTelegram(_0x5d81de,_0x4bca29[_0x58e61e(0x2bb)]);break;case _0x58e61e(0x1b5):io['to'](_0x5d81de)[_0x58e61e(0x2b9)](_0x4bca29['function'],_0x4bca29[_0x58e61e(0x19b)]);break;}}),pid[_0x5d81de]['on']('error',function(_0x5d1c87){if(_0x3b8a8e)return;_0x3b8a8e=!![],_0x413aab(_0x5d1c87);}),pid[_0x5d81de]['on'](_0x27d63e(0x206),function(_0x22cc05){const _0x4a3c3c=_0x27d63e;if(_0x3b8a8e)return;_0x3b8a8e=!![],_0x413aab(null);const _0x56c740=dbConfig[_0x4a3c3c(0x1b1)](_0x4a3c3c(0x21e))[_0x4a3c3c(0x20b)]({'botID':_0x5d81de})['value']();_0x56c740&&(_0x56c740['status']==_0x4a3c3c(0x1e1)||_0x56c740[_0x4a3c3c(0x1a6)]==_0x4a3c3c(0x292))&&(updateLive(_0x5d81de,_0x4a3c3c(0x211)),logging(_0x4a3c3c(0x290)+_0x5d81de),startBot([_0x5d81de,userID],{'cwd':bbpath},function(_0x2c1761){if(_0x2c1761)logging(_0x2c1761);}));});}function stopBot(_0x3a2a26){const _0x301f78=_0x13e9f2;getClientsWithBotID(_0x3a2a26)[_0x301f78(0x2ae)](_0x2512da=>{const _0x49895f=_0x301f78;getSocket(_0x2512da['id'])[_0x49895f(0x19f)](!![]),removeClient(_0x2512da['id']);});if(pid[_0x3a2a26])pid[_0x3a2a26][_0x301f78(0x270)]();}function addBot(){const _0x45a5ee=_0x13e9f2;let _0x2899bb;for(let _0x1d4a82=0x1;_0x1d4a82<0x3e9;_0x1d4a82++){_0x2899bb=_0x1d4a82['toString']()[_0x45a5ee(0x1bc)](0x3,'0');let _0x29628c=config[_0x45a5ee(0x20b)](_0x44c5f8=>_0x44c5f8[_0x45a5ee(0x1ff)]==_0x2899bb);if(!_0x29628c)break;}if(_0x2899bb===_0x45a5ee(0x2d6)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x45a5ee(0x238)+_0x2899bb),dbConfig[_0x45a5ee(0x1b1)](_0x45a5ee(0x21e))['push']({'botID':_0x2899bb,'botname':_0x45a5ee(0x1c0)+_0x2899bb,'status':_0x45a5ee(0x292),'live':''})[_0x45a5ee(0x289)](),startBot([_0x2899bb,userID],{'cwd':bbpath},function(_0x40c9dc){if(_0x40c9dc)logging(_0x40c9dc);}),config=getConfiguration(),io['to'](_0x45a5ee(0x209))[_0x45a5ee(0x2b9)](_0x45a5ee(0x21e),config);}function deleteBot(_0x4aaa5f){const _0x2546dc=_0x13e9f2;getClientsWithBotID(_0x4aaa5f)['forEach'](_0x49267e=>{getSocket(_0x49267e['id'])['disconnect'](!![]),removeClient(_0x49267e['id']);}),dbConfig['get'](_0x2546dc(0x21e))[_0x2546dc(0x1c1)]({'botID':_0x4aaa5f})[_0x2546dc(0x289)](),logging(_0x2546dc(0x27a)+_0x4aaa5f),stopBot(_0x4aaa5f);try{fs[_0x2546dc(0x1aa)](path[_0x2546dc(0x1f9)](configpath,_0x2546dc(0x263)+_0x4aaa5f+_0x2546dc(0x1df))),fs[_0x2546dc(0x1aa)](path[_0x2546dc(0x1f9)](configpath,_0x2546dc(0x263)+_0x4aaa5f+_0x2546dc(0x1cd))),fs[_0x2546dc(0x1aa)](path[_0x2546dc(0x1f9)](configpath,_0x2546dc(0x263)+_0x4aaa5f+'-performance.json')),fs['unlinkSync'](path['join'](configpath,_0x2546dc(0x263)+_0x4aaa5f+_0x2546dc(0x1af)));}catch(_0x2e8274){if(_0x2e8274)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x2e8274);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x2546dc(0x21e),config);}function toggleBot(_0x2e244d,_0x32c4af,_0x2e6de0){const _0x2fb235=_0x13e9f2;dbConfig['get'](_0x2fb235(0x21e))[_0x2fb235(0x20b)]({'botID':_0x2e244d})[_0x2fb235(0x284)]({'status':_0x32c4af})[_0x2fb235(0x284)]({'live':_0x2e6de0})['write']();if(_0x32c4af==_0x2fb235(0x1e1)||_0x32c4af==_0x2fb235(0x292))logging('enabled\x20Bot\x20'+_0x2e244d),startBot([_0x2e244d,userID],{'cwd':bbpath},function(_0x2976c8){if(_0x2976c8)logging(_0x2976c8);});else(_0x32c4af==_0x2fb235(0x272)||_0x32c4af==_0x2fb235(0x1ce))&&(logging(_0x2fb235(0x1d6)+_0x2e244d),stopBot(_0x2e244d));config=getConfiguration(),io['to'](_0x2fb235(0x209))[_0x2fb235(0x2b9)](_0x2fb235(0x21e),config);}function toggleStatus(_0x152ca2){const _0x170f60=_0x13e9f2;let _0x2c92d7=dbConfig['get']('bots')['find']({'botID':_0x152ca2})[_0x170f60(0x25f)](),_0x5873b4;if(_0x2c92d7[_0x170f60(0x1a6)]==='enabled')_0x5873b4=_0x170f60(0x272);else{if(_0x2c92d7[_0x170f60(0x1a6)]===_0x170f60(0x292))_0x5873b4='new-disabled';else{if(_0x2c92d7[_0x170f60(0x1a6)]===_0x170f60(0x1ce))_0x5873b4=_0x170f60(0x292);else{if(_0x2c92d7[_0x170f60(0x1a6)]===_0x170f60(0x272))_0x5873b4='enabled';}}}return _0x5873b4;}function updateStatus(_0x59293b,_0x20895c){const _0x5508f2=_0x13e9f2;dbConfig[_0x5508f2(0x1b1)](_0x5508f2(0x21e))[_0x5508f2(0x20b)]({'botID':_0x59293b})[_0x5508f2(0x284)]({'status':_0x20895c})[_0x5508f2(0x289)](),config=getConfiguration(),io['to'](_0x5508f2(0x209))['emit'](_0x5508f2(0x21e),config);}function updateLive(_0x228bbf,_0xcdda8){const _0x3e27b7=_0x13e9f2;dbConfig['get'](_0x3e27b7(0x21e))[_0x3e27b7(0x20b)]({'botID':_0x228bbf})[_0x3e27b7(0x284)]({'live':_0xcdda8})[_0x3e27b7(0x289)](),config=getConfiguration(),io['to'](_0x3e27b7(0x209))['emit'](_0x3e27b7(0x21e),config);}function updateBotName(_0x537d5d,_0xf2b93f){const _0x36e694=_0x13e9f2;dbConfig[_0x36e694(0x1b1)](_0x36e694(0x21e))['find']({'botID':_0x537d5d})[_0x36e694(0x284)]({'botname':_0xf2b93f})[_0x36e694(0x289)](),config=getConfiguration(),io['to'](_0x36e694(0x209))['emit'](_0x36e694(0x21e),config);}function telegramError(_0x5a33f1){const _0x3a0b91=_0x13e9f2;console[_0x3a0b91(0x1ea)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x2ad351){const _0x226f64=_0x13e9f2;if(_0x2ad351['from'][_0x226f64(0x227)]!=settings[_0x226f64(0x20d)]&&'@'+_0x2ad351[_0x226f64(0x224)][_0x226f64(0x227)]!=settings[_0x226f64(0x20d)])return tgBot['sendMessage'](_0x2ad351[_0x226f64(0x22a)]['id'],_0x226f64(0x20e),{'parse_mode':'HTML'})[_0x226f64(0x27d)](_0x5caad9=>{telegramError(_0x5caad9);}),![];return!![];}async function initTelegram(){const _0x57ba88=_0x13e9f2;if(tgBot)tgBot[_0x57ba88(0x1c4)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x497d81='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x497d81+='\x0a',_0x497d81+=_0x57ba88(0x1f3),_0x497d81+=_0x57ba88(0x297),_0x497d81+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x497d81+=_0x57ba88(0x29c),_0x497d81+=_0x57ba88(0x1cb),_0x497d81+='/off\x20-\x20stop\x20bot(s)\x0a',_0x497d81+=_0x57ba88(0x1e7),_0x497d81+=_0x57ba88(0x1f0);let _0x518f36=_0x57ba88(0x28a);_0x518f36+='\x0a',_0x518f36+=_0x497d81,tgBot[_0x57ba88(0x232)](/\/start/,_0x33fe87=>{const _0x32b41d=_0x57ba88;if(!validateTelegram(_0x33fe87))return;if(settings['telegramChatId']!=_0x33fe87['chat']['id'])updateSetting(_0x32b41d(0x217),_0x33fe87['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x32b41d(0x2c1)](_0x33fe87['chat']['id'],_0x518f36)[_0x32b41d(0x27d)](_0x3a7f90=>{telegramError(_0x3a7f90);});}),tgBot['onText'](/\/enable/,_0x53c80d=>{const _0x5c9355=_0x57ba88;if(!validateTelegram(_0x53c80d))return;if(settings['telegramChatId']!=_0x53c80d[_0x5c9355(0x22a)]['id'])updateSetting('telegramChatId',_0x53c80d['chat']['id']);updateSetting(_0x5c9355(0x199),!![]),tgBot['sendMessage'](_0x53c80d[_0x5c9355(0x22a)]['id'],_0x5c9355(0x21f))['catch'](_0x1238f3=>{telegramError(_0x1238f3);});}),tgBot[_0x57ba88(0x232)](/\/config/,async _0x2cb97d=>{const _0x23bfc9=_0x57ba88;if(!validateTelegram(_0x2cb97d))return;tgBot[_0x23bfc9(0x2ac)](_0x23bfc9(0x2d7)),tgBot[_0x23bfc9(0x2c1)](_0x2cb97d[_0x23bfc9(0x22a)]['id'],_0x23bfc9(0x1fc),{'reply_markup':{'inline_keyboard':[[{'text':_0x23bfc9(0x255),'callback_data':_0x23bfc9(0x22e)},{'text':_0x23bfc9(0x28f),'callback_data':_0x23bfc9(0x249)},{'text':'All','callback_data':'all'}]]}})[_0x23bfc9(0x27d)](_0x3a54ee=>{telegramError(_0x3a54ee);}),tgBot['on']('callback_query',async _0x3ad98c=>{const _0x580849=_0x23bfc9,_0x5c2647=_0x3ad98c['data'],_0x297d2b=_0x3ad98c['message'];tgBot['answerCallbackQuery'](_0x3ad98c['id'])[_0x580849(0x23f)](async()=>{const _0x190ff8=_0x580849;_0x5c2647==_0x190ff8(0x22e)&&(updateSetting(_0x190ff8(0x221),'orders'),updateSetting(_0x190ff8(0x199),!![]),await tgBot[_0x190ff8(0x2c1)](_0x297d2b[_0x190ff8(0x22a)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x190ff8(0x27d)](_0x444b39=>{telegramError(_0x444b39);}));_0x5c2647==_0x190ff8(0x249)&&(updateSetting(_0x190ff8(0x221),_0x190ff8(0x249)),updateSetting(_0x190ff8(0x199),!![]),await tgBot[_0x190ff8(0x2c1)](_0x297d2b[_0x190ff8(0x22a)]['id'],_0x190ff8(0x254))[_0x190ff8(0x27d)](_0x3d0a0b=>{telegramError(_0x3d0a0b);}));_0x5c2647==_0x190ff8(0x2ce)&&(updateSetting('telegramEvents',_0x190ff8(0x2ce)),updateSetting(_0x190ff8(0x199),!![]),await tgBot['sendMessage'](_0x297d2b['chat']['id'],_0x190ff8(0x205))[_0x190ff8(0x27d)](_0x3b9967=>{telegramError(_0x3b9967);}));if(!settings[_0x190ff8(0x217)])tgBot[_0x190ff8(0x2c1)](_0x297d2b[_0x190ff8(0x22a)]['id'],_0x190ff8(0x279))['catch'](_0x14dc4f=>{telegramError(_0x14dc4f);});}),tgBot[_0x580849(0x2ac)](_0x580849(0x2d7));});}),tgBot[_0x57ba88(0x232)](/\/status/,_0xad7740=>{const _0x5daeb9=_0x57ba88;if(!validateTelegram(_0xad7740))return;let _0x55a790='<b>Balance\x20Bot\x20status:</b>\x0a';config[_0x5daeb9(0x2ae)](_0x3cd2fd=>{const _0x5e592b=_0x5daeb9;_0x55a790+=_0x5e592b(0x1c0)+_0x3cd2fd[_0x5e592b(0x1ff)]+'\x20|\x20'+_0x3cd2fd[_0x5e592b(0x1a2)]+':\x20'+_0x3cd2fd[_0x5e592b(0x1a6)]+_0x5e592b(0x277)+_0x3cd2fd['live']+'\x0a';}),_0x55a790+='\x0a',_0x55a790+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x55a790+=!settings[_0x5daeb9(0x199)]?'Notifications\x20disabled\x0a':_0x5daeb9(0x266),_0x55a790+=settings[_0x5daeb9(0x199)]?settings['telegramEvents']==_0x5daeb9(0x2ce)?_0x5daeb9(0x269):_0x5daeb9(0x1a7)+settings[_0x5daeb9(0x221)]+_0x5daeb9(0x1e9):'',tgBot[_0x5daeb9(0x2c1)](_0xad7740['chat']['id'],_0x55a790,{'parse_mode':_0x5daeb9(0x1b9)})[_0x5daeb9(0x27d)](_0xfb3b94=>{telegramError(_0xfb3b94);});}),tgBot['onText'](/\/restart/,_0x3b52ff=>{const _0x3f30f7=_0x57ba88;if(!validateTelegram(_0x3b52ff))return;tgBot['removeListener'](_0x3f30f7(0x2d7));const _0x19664e=getEnabledBots();if(_0x19664e[_0x3f30f7(0x24d)]==0x0)tgBot[_0x3f30f7(0x2c1)](_0x3b52ff[_0x3f30f7(0x22a)]['id'],_0x3f30f7(0x2c7))[_0x3f30f7(0x27d)](_0x32f637=>{telegramError(_0x32f637);});else{if(_0x19664e[_0x3f30f7(0x24d)]>0x1)_0x19664e[_0x3f30f7(0x1be)]({'botID':'all'});let _0x39e996=[],_0x4c9458=[];const _0x11cebb=_0x19664e[_0x3f30f7(0x24d)]%0x4==0x0||_0x19664e[_0x3f30f7(0x24d)]%0x4==0x3||_0x19664e[_0x3f30f7(0x24d)]%0x3==0x1?0x4:0x3;let _0x2d0a2a=0x0;_0x19664e[_0x3f30f7(0x2ae)]((_0x14bbe1,_0x93dd0a)=>{const _0x5f3417=_0x3f30f7;if(_0x93dd0a%_0x11cebb==0x0)_0x4c9458=[];_0x4c9458[_0x5f3417(0x1be)]({'text':_0x14bbe1[_0x5f3417(0x1ff)]==_0x5f3417(0x2ce)?_0x5f3417(0x223):_0x5f3417(0x1c0)+_0x14bbe1[_0x5f3417(0x1ff)],'callback_data':_0x14bbe1[_0x5f3417(0x1ff)]}),_0x93dd0a%_0x11cebb==0x0&&(_0x39e996[_0x2d0a2a]=_0x4c9458,_0x2d0a2a++);}),tgBot[_0x3f30f7(0x2c1)](_0x3b52ff[_0x3f30f7(0x22a)]['id'],_0x3f30f7(0x2d1),{'reply_markup':{'inline_keyboard':_0x39e996}})[_0x3f30f7(0x27d)](_0xea7b65=>{telegramError(_0xea7b65);}),tgBot['on'](_0x3f30f7(0x2d7),async _0x1856c2=>{const _0x118195=_0x3f30f7,_0x50809=_0x1856c2[_0x118195(0x20f)],_0x2a616d=_0x1856c2[_0x118195(0x29b)];tgBot['answerCallbackQuery'](_0x1856c2['id'])[_0x118195(0x23f)](async()=>{const _0x2700b1=_0x118195;if(_0x50809==_0x2700b1(0x2ce)){if(settings[_0x2700b1(0x221)]==_0x2700b1(0x22e))tgBot[_0x2700b1(0x2c1)](_0x2a616d[_0x2700b1(0x22a)]['id'],_0x2700b1(0x2d4))[_0x2700b1(0x27d)](_0x31d614=>{telegramError(_0x31d614);});config['forEach'](_0x4f5b0d=>{stopBot(_0x4f5b0d['botID']);});}else{if(settings['telegramEvents']=='orders')tgBot['sendMessage'](_0x2a616d[_0x2700b1(0x22a)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x50809)[_0x2700b1(0x27d)](_0x4ed778=>{telegramError(_0x4ed778);});stopBot(_0x50809);}}),tgBot[_0x118195(0x2ac)](_0x118195(0x2d7));});}}),tgBot['onText'](/\/on/,_0xa75346=>{const _0x41eca6=_0x57ba88;if(!validateTelegram(_0xa75346))return;tgBot[_0x41eca6(0x2ac)](_0x41eca6(0x2d7));const _0x59b485=getDisabledBots();if(_0x59b485['length']==0x0)tgBot['sendMessage'](_0xa75346['chat']['id'],_0x41eca6(0x1e0))[_0x41eca6(0x27d)](_0x32fbf5=>{telegramError(_0x32fbf5);});else{if(_0x59b485[_0x41eca6(0x24d)]>0x1)_0x59b485[_0x41eca6(0x1be)]({'botID':_0x41eca6(0x2ce)});let _0x1d6b9b=[],_0x2fac79=[];const _0x904524=_0x59b485[_0x41eca6(0x24d)]%0x4==0x0||_0x59b485[_0x41eca6(0x24d)]%0x4==0x3||_0x59b485[_0x41eca6(0x24d)]%0x3==0x1?0x4:0x3;let _0xaecea2=0x0;_0x59b485['forEach']((_0x1eb83f,_0x5796d7)=>{const _0x165d0a=_0x41eca6;if(_0x5796d7%_0x904524==0x0)_0x2fac79=[];_0x2fac79[_0x165d0a(0x1be)]({'text':_0x1eb83f[_0x165d0a(0x1ff)]=='all'?_0x165d0a(0x223):_0x165d0a(0x1c0)+_0x1eb83f['botID'],'callback_data':_0x1eb83f[_0x165d0a(0x1ff)]}),_0x5796d7%_0x904524==0x0&&(_0x1d6b9b[_0xaecea2]=_0x2fac79,_0xaecea2++);}),tgBot[_0x41eca6(0x2c1)](_0xa75346[_0x41eca6(0x22a)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x1d6b9b}})[_0x41eca6(0x27d)](_0x3b9fb2=>{telegramError(_0x3b9fb2);}),tgBot['on'](_0x41eca6(0x2d7),async _0x5d1a8c=>{const _0x2608c5=_0x41eca6,_0x283c6e=_0x5d1a8c[_0x2608c5(0x20f)],_0x48008c=_0x5d1a8c['message'];tgBot['answerCallbackQuery'](_0x5d1a8c['id'])['then'](async()=>{const _0x244e70=_0x2608c5;if(_0x283c6e==_0x244e70(0x2ce)){if(settings[_0x244e70(0x221)]==_0x244e70(0x22e))tgBot['sendMessage'](_0x48008c[_0x244e70(0x22a)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x244e70(0x27d)](_0x30e98c=>{telegramError(_0x30e98c);});_0x59b485[_0x244e70(0x2ae)](_0x5f213a=>{const _0x2a9d56=_0x244e70;if(_0x5f213a[_0x2a9d56(0x1ff)]!=_0x2a9d56(0x2ce))toggleBot(_0x5f213a['botID'],toggleStatus(_0x5f213a[_0x2a9d56(0x1ff)]),_0x2a9d56(0x211));});}else{if(settings[_0x244e70(0x221)]==_0x244e70(0x22e))tgBot[_0x244e70(0x2c1)](_0x48008c[_0x244e70(0x22a)]['id'],_0x244e70(0x19e)+_0x283c6e)[_0x244e70(0x27d)](_0x2c0340=>{telegramError(_0x2c0340);});toggleBot(_0x283c6e,toggleStatus(_0x283c6e),'stopped');}}),tgBot['removeListener'](_0x2608c5(0x2d7));});}}),tgBot[_0x57ba88(0x232)](/\/off/,_0x122b77=>{const _0x5016b4=_0x57ba88;if(!validateTelegram(_0x122b77))return;tgBot[_0x5016b4(0x2ac)](_0x5016b4(0x2d7));const _0x50401b=getEnabledBots();if(_0x50401b[_0x5016b4(0x24d)]==0x0)tgBot[_0x5016b4(0x2c1)](_0x122b77[_0x5016b4(0x22a)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x572e23=>{telegramError(_0x572e23);});else{if(_0x50401b[_0x5016b4(0x24d)]>0x1)_0x50401b['push']({'botID':_0x5016b4(0x2ce)});let _0x54e45d=[],_0x4e88e0=[];const _0x3e1214=_0x50401b[_0x5016b4(0x24d)]%0x4==0x0||_0x50401b['length']%0x4==0x3||_0x50401b['length']%0x3==0x1?0x4:0x3;let _0xfee200=0x0;_0x50401b[_0x5016b4(0x2ae)]((_0x38f7f7,_0x2fcb42)=>{const _0x3fc05a=_0x5016b4;if(_0x2fcb42%_0x3e1214==0x0)_0x4e88e0=[];_0x4e88e0['push']({'text':_0x38f7f7[_0x3fc05a(0x1ff)]==_0x3fc05a(0x2ce)?'All\x20bots':'Bot\x20'+_0x38f7f7['botID'],'callback_data':_0x38f7f7[_0x3fc05a(0x1ff)]}),_0x2fcb42%_0x3e1214==0x0&&(_0x54e45d[_0xfee200]=_0x4e88e0,_0xfee200++);}),tgBot['sendMessage'](_0x122b77[_0x5016b4(0x22a)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x54e45d}})[_0x5016b4(0x27d)](_0xf5a3ed=>{telegramError(_0xf5a3ed);}),tgBot['on'](_0x5016b4(0x2d7),async _0x1a71a5=>{const _0x36ce43=_0x5016b4,_0x670e49=_0x1a71a5[_0x36ce43(0x20f)],_0x3d13cd=_0x1a71a5['message'];tgBot['answerCallbackQuery'](_0x1a71a5['id'])['then'](async()=>{const _0x2cf162=_0x36ce43;if(_0x670e49==_0x2cf162(0x2ce)){if(settings[_0x2cf162(0x221)]==_0x2cf162(0x22e))tgBot[_0x2cf162(0x2c1)](_0x3d13cd[_0x2cf162(0x22a)]['id'],_0x2cf162(0x2ad))[_0x2cf162(0x27d)](_0x3c014e=>{telegramError(_0x3c014e);});_0x50401b[_0x2cf162(0x2ae)](_0x4758aa=>{const _0x20476c=_0x2cf162;if(_0x4758aa[_0x20476c(0x1ff)]!='all')toggleBot(_0x4758aa[_0x20476c(0x1ff)],toggleStatus(_0x4758aa[_0x20476c(0x1ff)]),'stopped');});}else{if(settings[_0x2cf162(0x221)]=='orders')tgBot[_0x2cf162(0x2c1)](_0x3d13cd[_0x2cf162(0x22a)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x670e49)[_0x2cf162(0x27d)](_0x3c29bc=>{telegramError(_0x3c29bc);});toggleBot(_0x670e49,toggleStatus(_0x670e49),'stopped');}}),tgBot[_0x36ce43(0x2ac)](_0x36ce43(0x2d7));});}}),tgBot[_0x57ba88(0x232)](/\/disable/,_0x241441=>{const _0x3e81e6=_0x57ba88;if(!validateTelegram(_0x241441))return;tgBot[_0x3e81e6(0x2c1)](_0x241441[_0x3e81e6(0x22a)]['id'],'Notifications\x20disabled')[_0x3e81e6(0x27d)](_0x4d6d50=>{telegramError(_0x4d6d50);}),updateSetting(_0x3e81e6(0x199),![]);}),tgBot[_0x57ba88(0x232)](/\/help/,_0x39948e=>{const _0xc5e67b=_0x57ba88;if(!validateTelegram(_0x39948e))return;tgBot[_0xc5e67b(0x2c1)](_0x39948e[_0xc5e67b(0x22a)]['id'],_0x497d81)[_0xc5e67b(0x27d)](_0x2019b7=>{telegramError(_0x2019b7);});}),tgBot['on'](_0x57ba88(0x276),_0x5c35fc=>{const _0x17d39c=_0x57ba88;_0x5c35fc['toString']()['includes']('404\x20Not\x20Found')&&(logging(_0x17d39c(0x264)),tgBot[_0x17d39c(0x1c4)](),tgBot=null,io['to'](_0x17d39c(0x209))['emit']('notification',_0x17d39c(0x264)));}),process[_0x57ba88(0x1d2)](_0x57ba88(0x1a5),()=>{const _0xa541c9=_0x57ba88;if(tgBot)tgBot[_0xa541c9(0x1c4)]();process[_0xa541c9(0x206)](0x1);}),process[_0x57ba88(0x1d2)]('SIGTERM',()=>{const _0xad3078=_0x57ba88;if(tgBot)tgBot['stopPolling']();process[_0xad3078(0x206)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x992dc3,_0x2a7b0e){const _0x523756=_0x13e9f2;if(settings[_0x523756(0x199)]){if(settings[_0x523756(0x221)]==_0x523756(0x2ce)||(_0x2a7b0e[_0x523756(0x1ac)]==_0x523756(0x2b0)||_0x2a7b0e[_0x523756(0x1ac)]=='success')&&settings['telegramEvents']==_0x523756(0x249)||_0x2a7b0e[_0x523756(0x1ac)]==_0x523756(0x25b)&&settings[_0x523756(0x221)]==_0x523756(0x22e)){if(tgBot&&settings[_0x523756(0x217)]){if(_0x2a7b0e['showname'])tgBot[_0x523756(0x2c1)](settings[_0x523756(0x217)],_0x2a7b0e[_0x523756(0x1a2)]+'\x20>\x20'+_0x2a7b0e[_0x523756(0x261)])[_0x523756(0x27d)](_0x5bd55d=>{telegramError(_0x5bd55d);});else tgBot[_0x523756(0x2c1)](settings['telegramChatId'],'Bot\x20'+_0x992dc3+_0x523756(0x288)+_0x2a7b0e['event'])[_0x523756(0x27d)](_0x37d294=>{telegramError(_0x37d294);});}}}}function getDeviceWithIp(_0x4ea5f4){const _0xdd0382=_0x13e9f2;return devices[_0xdd0382(0x20b)](_0x4fa62b=>_0x4fa62b['ip']===_0x4ea5f4);}function temporaryAccess2FA(_0x268fb6,_0x344205){const _0x29399e=_0x13e9f2;let _0x1fe88c=new Date(),_0x53dd1d=![];if(lastIpApproval){if(_0x1fe88c-lastIpApproval<0x1388)_0x53dd1d=!![];}lastIpApproval=new Date();if(_0x53dd1d)return;tgBot&&settings[_0x29399e(0x217)]&&(tgBot[_0x29399e(0x2ac)](_0x29399e(0x2d7)),tgBot[_0x29399e(0x2c1)](settings['telegramChatId'],_0x29399e(0x1c8)+normalizeIP(_0x344205)[_0x29399e(0x200)]+'</b>\x20?',{'parse_mode':_0x29399e(0x1b9),'reply_markup':{'inline_keyboard':[[{'text':_0x29399e(0x26a),'callback_data':'5'},{'text':_0x29399e(0x194),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x29399e(0x28b),'callback_data':'reject'}]]}})['catch'](_0x227b2a=>{telegramError(_0x227b2a);}),tgBot['on'](_0x29399e(0x2d7),async _0x2ed8ba=>{const _0x3a457a=_0x29399e,_0x3e847c=_0x2ed8ba[_0x3a457a(0x20f)],_0x5a3553=_0x2ed8ba[_0x3a457a(0x29b)];tgBot[_0x3a457a(0x2a7)](_0x2ed8ba['id'])[_0x3a457a(0x23f)](async()=>{const _0xb45d9c=_0x3a457a;devices[_0x268fb6]['telegramIpApproval']={'clientip':_0x344205,'timestamp':new Date()[_0xb45d9c(0x2c0)](),'expiry':_0x3e847c},_0x3e847c!=_0xb45d9c(0x28b)?(await tgBot[_0xb45d9c(0x2c1)](_0x5a3553[_0xb45d9c(0x22a)]['id'],_0xb45d9c(0x250)+_0x3e847c+_0xb45d9c(0x218),{'parse_mode':'HTML'})[_0xb45d9c(0x27d)](_0xe63b0=>{telegramError(_0xe63b0);}),io['to'](_0x268fb6)['emit'](_0xb45d9c(0x1a6),{'access':{'allow':![],'reason':_0xb45d9c(0x282),'token':null}})):(await tgBot[_0xb45d9c(0x2c1)](_0x5a3553[_0xb45d9c(0x22a)]['id'],_0xb45d9c(0x1ab))[_0xb45d9c(0x27d)](_0x1c3939=>{telegramError(_0x1c3939);}),io['to'](_0x268fb6)['emit']('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x3a457a(0x2ac)]('callback_query');}));}function loginAccess2FA(_0x11af8f,_0x55e464){const _0x13d38b=_0x13e9f2;tgBot&&settings[_0x13d38b(0x217)]&&(tgBot[_0x13d38b(0x2ac)]('callback_query'),tgBot[_0x13d38b(0x2c1)](settings[_0x13d38b(0x217)],_0x13d38b(0x1f1)+normalizeIP(_0x55e464)[_0x13d38b(0x200)]+_0x13d38b(0x2aa),{'parse_mode':_0x13d38b(0x1b9),'reply_markup':{'inline_keyboard':[[{'text':_0x13d38b(0x1ed),'callback_data':loginExpiry},{'text':_0x13d38b(0x28b),'callback_data':_0x13d38b(0x28b)}]]}})[_0x13d38b(0x27d)](_0x5031b7=>{telegramError(_0x5031b7);}),tgBot['on'](_0x13d38b(0x2d7),async _0x488d53=>{const _0xe8bb55=_0x13d38b,_0x5aa2c5=_0x488d53[_0xe8bb55(0x20f)],_0x38021b=_0x488d53['message'];tgBot[_0xe8bb55(0x2a7)](_0x488d53['id'])[_0xe8bb55(0x23f)](async()=>{const _0x2eb9ee=_0xe8bb55;devices[_0x11af8f]['telegram2FaApproval']={'clientip':_0x55e464,'timestamp':new Date()[_0x2eb9ee(0x2c0)](),'expiry':_0x5aa2c5},_0x5aa2c5!='reject'?(await tgBot['sendMessage'](_0x38021b[_0x2eb9ee(0x22a)]['id'],'Login\x20accepted',{'parse_mode':_0x2eb9ee(0x1b9)})['catch'](_0x32af0a=>{telegramError(_0x32af0a);}),io['to'](_0x11af8f)[_0x2eb9ee(0x2b9)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x38021b[_0x2eb9ee(0x22a)]['id'],_0x2eb9ee(0x246))[_0x2eb9ee(0x27d)](_0x392b2a=>{telegramError(_0x392b2a);}),io['to'](_0x11af8f)[_0x2eb9ee(0x2b9)](_0x2eb9ee(0x1a6),{'access':{'allow':![],'reason':_0x2eb9ee(0x28c),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function getConfiguration(){const _0x382210=_0x13e9f2;return dbConfig['get'](_0x382210(0x21e))['sortBy'](_0x382210(0x1ff))['value']()||[];}function getEnabledBots(){const _0x56e7a7=_0x13e9f2;return dbConfig[_0x56e7a7(0x1b1)](_0x56e7a7(0x21e))['sortBy']('botID')[_0x56e7a7(0x287)]({'status':'enabled'})[_0x56e7a7(0x25f)]()||[];}function getDisabledBots(){const _0x159542=_0x13e9f2;return dbConfig[_0x159542(0x1b1)](_0x159542(0x21e))[_0x159542(0x2c4)](_0x159542(0x1ff))[_0x159542(0x287)]({'status':_0x159542(0x272)})[_0x159542(0x25f)]()||[];}function getSettings(){const _0x4d8f98=_0x13e9f2;return dbSettings[_0x4d8f98(0x1b1)](_0x4d8f98(0x2a5))['value']()||{'timeshift':0x0};}function getSecure(){const _0x2d7ce9=_0x13e9f2;return dbSecure[_0x2d7ce9(0x1b1)](_0x2d7ce9(0x27c))[_0x2d7ce9(0x25f)]()||{};}function getBlacklist(){const _0x322f7c=_0x13e9f2;return dbSecure[_0x322f7c(0x1b1)](_0x322f7c(0x1fd))[_0x322f7c(0x25f)]()||[];}function broadcastToBots(_0x5191b4,_0x475a02){const _0x2b7eb7=_0x13e9f2;config[_0x2b7eb7(0x2ae)](_0x509643=>{const _0x85b89a=_0x2b7eb7;if(_0x509643[_0x85b89a(0x1a6)]=='enabled'&&_0x509643['live']=='running'){if(pid[_0x509643['botID']])pid[_0x509643[_0x85b89a(0x1ff)]]['send']({[_0x5191b4]:_0x475a02});}});}function storeSettings(_0xba3de6,_0xea4b4b=![]){const _0x6c94ae=_0x13e9f2;_0xba3de6={...settings,..._0xba3de6};if(_0xea4b4b&&_0xba3de6['bbPassword']!=_0x6c94ae(0x1bd)&&_0xba3de6['bbPassword']!=''){const _0x3faeff=crypt[_0x6c94ae(0x21d)](secure['privateKey'],_0xba3de6['bbPassword'])['message'][_0x6c94ae(0x1f2)]('@')[0x0],_0x198dd2=bcrypt[_0x6c94ae(0x234)](_0x3faeff,saltRounds);_0xba3de6={..._0xba3de6,'bbPassword':_0x198dd2};}if(_0xea4b4b&&_0xba3de6['telegramToken']!='************'&&_0xba3de6['telegramToken']!=''){const _0x379f73=crypt[_0x6c94ae(0x21d)](secure[_0x6c94ae(0x273)],_0xba3de6[_0x6c94ae(0x242)])[_0x6c94ae(0x29b)][_0x6c94ae(0x1f2)]('@')[0x0];_0xba3de6={..._0xba3de6,'telegramToken':_0x379f73};}const _0x8ffc43=_0xba3de6[_0x6c94ae(0x242)]!=_0x6c94ae(0x1bd)&&_0xba3de6[_0x6c94ae(0x242)]!=settings[_0x6c94ae(0x242)]||_0xba3de6[_0x6c94ae(0x20d)]!=settings['telegramUsername'],_0x3549d1=_0xba3de6[_0x6c94ae(0x242)]==''||_0xba3de6['telegramUsername']=='';if(_0x8ffc43)_0xba3de6['telegramEvents']='all';for(const [_0x20152c,_0x3db542]of Object[_0x6c94ae(0x1f4)](_0xba3de6)){if(_0x20152c==_0x6c94ae(0x242)&&_0x3db542==_0x6c94ae(0x1bd)){_0xba3de6[_0x6c94ae(0x242)]=settings[_0x6c94ae(0x242)];continue;};if(_0x20152c==_0x6c94ae(0x225)&&_0x3db542=='************'){_0xba3de6[_0x6c94ae(0x225)]=settings[_0x6c94ae(0x225)];continue;};dbSettings[_0x6c94ae(0x2ba)](_0x6c94ae(0x26e)+_0x20152c,_0x3db542)[_0x6c94ae(0x289)]();}settings=_0xba3de6,io['to']('botmanager')[_0x6c94ae(0x2b9)](_0x6c94ae(0x2a5),cleanSettings()),broadcastToBots(_0x6c94ae(0x260),settings[_0x6c94ae(0x260)]);if(_0x8ffc43&&!_0x3549d1)initTelegram();if(_0x8ffc43&&_0x3549d1)disableTelegram();getAllClients()[_0x6c94ae(0x2ae)](_0x4bd89f=>{const _0xc3107c=_0x6c94ae;getSocket(_0x4bd89f['id'])[_0xc3107c(0x2b9)](_0xc3107c(0x1a6),{'access':{'allow':![],'reason':_0xc3107c(0x282),'token':null}});});}function updateSetting(_0x56ea67,_0x124270){const _0x5f26c2=_0x13e9f2;dbSettings[_0x5f26c2(0x2ba)](_0x5f26c2(0x26e)+_0x56ea67,_0x124270)[_0x5f26c2(0x289)](),settings=getSettings(),io['to'](_0x5f26c2(0x209))['emit'](_0x5f26c2(0x2a5),cleanSettings());}function storeSecure(_0x26b475){const _0x455188=_0x13e9f2;dbSecure['get'](_0x455188(0x27c))[_0x455188(0x1be)](_0x26b475)['write'](),secure=_0x26b475;}function addBlacklist(_0x1db92c){const _0x3748cf=_0x13e9f2;cleanBlacklist();let _0x2fdc85;devices[_0x1db92c][_0x3748cf(0x1b2)]?_0x2fdc85=Math[_0x3748cf(0x23b)](devices[_0x1db92c]['telegramIpApproval'][_0x3748cf(0x27e)],loginExpiry):_0x2fdc85=loginExpiry,dbSecure['get'](_0x3748cf(0x1fd))['push']({'expiry':new Date()[_0x3748cf(0x2c0)]()+_0x2fdc85*0x3c*0x3e8,'token':devices[_0x1db92c][_0x3748cf(0x203)]['token']})[_0x3748cf(0x289)](),blacklist=dbSecure[_0x3748cf(0x1b1)](_0x3748cf(0x1fd))[_0x3748cf(0x25f)]();}function cleanBlacklist(){const _0x56b238=_0x13e9f2;let _0x316e5e=dbSecure[_0x56b238(0x1b1)](_0x56b238(0x1fd))[_0x56b238(0x267)]()[_0x56b238(0x25f)](),_0x4ac7ca=new Date()[_0x56b238(0x2c0)]();_0x316e5e['forEach'](_0x146934=>{const _0x54827a=_0x56b238;_0x146934[_0x54827a(0x27e)]<_0x4ac7ca&&dbSecure[_0x54827a(0x1b1)](_0x54827a(0x1fd))['remove']({'expiry':_0x146934[_0x54827a(0x27e)]})['write']();});}function initStates(){const _0x5d1b48=_0x13e9f2;let _0x588577=getConfiguration();_0x588577[_0x5d1b48(0x2ae)](_0x2a4745=>{const _0x252931=_0x5d1b48;_0x2a4745['live']=_0x252931(0x211);}),storeConfiguration(_0x588577);}function onKeys(){const _0x883d04=new RSA();return new Promise(_0x4c1ace=>{const _0x559a7c=_0x37c9;_0x883d04[_0x559a7c(0x2d5)]()[_0x559a7c(0x23f)](_0x1da67f=>{_0x4c1ace(_0x1da67f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x485651=_0x13e9f2;let _0x3a9aaf=getConfiguration(),_0xf5a999=![];_0x3a9aaf['forEach'](_0x284d9b=>{const _0x43802b=_0x37c9;if(_0x284d9b[_0x43802b(0x1a6)]==_0x43802b(0x2d3))_0x284d9b[_0x43802b(0x1a6)]=_0x43802b(0x1e1),_0xf5a999=!![];else _0x284d9b[_0x43802b(0x1a6)]==_0x43802b(0x211)&&(_0x284d9b[_0x43802b(0x1a6)]=_0x43802b(0x272),_0xf5a999=!![]);});if(_0xf5a999)storeConfiguration(_0x3a9aaf);let _0x5444f1=getSecure();if(!_0x5444f1[_0x485651(0x1e2)](_0x485651(0x2ca))){let _0x5c2ad3=await generateKeys();_0x5444f1[_0x485651(0x2b2)]=_0x5c2ad3[_0x485651(0x2b2)],_0x5444f1[_0x485651(0x273)]=_0x5c2ad3[_0x485651(0x273)],_0x5444f1['secret']=crypto[_0x485651(0x25d)](0x20)[_0x485651(0x24c)]('hex');;storeSecure(_0x5444f1);}let _0x5c5a6a=getSettings();_0xf5a999=![];!_0x5c5a6a[_0x485651(0x1e2)](_0x485651(0x259))&&(_0x5c5a6a[_0x485651(0x259)]=![],_0x5c5a6a[_0x485651(0x1cf)]='',_0x5c5a6a[_0x485651(0x225)]='',_0x5c5a6a[_0x485651(0x2bc)]=![],_0xf5a999=!![]);!_0x5c5a6a[_0x485651(0x1e2)](_0x485651(0x2b8))&&(_0x5c5a6a[_0x485651(0x2b8)]=![],_0x5c5a6a[_0x485651(0x241)]=[],_0x5c5a6a[_0x485651(0x1e4)]=![],_0xf5a999=!![]);if(!_0x5c5a6a[_0x485651(0x1e2)](_0x485651(0x199))){if(_0x5c5a6a[_0x485651(0x217)])_0x5c5a6a['telegramEnabled']=!![];else _0x5c5a6a[_0x485651(0x199)]=![];_0xf5a999=!![];}if(_0xf5a999)storeSettings(_0x5c5a6a);}function storeConfiguration(_0x3f81fb){const _0x274369=_0x13e9f2;dbConfig['get'](_0x274369(0x21e))[_0x274369(0x1c1)]()[_0x274369(0x289)](),dbConfig[_0x274369(0x1b1)](_0x274369(0x21e))[_0x274369(0x1be)](..._0x3f81fb)[_0x274369(0x289)](),config=_0x3f81fb;}function resetPassword(){const _0x447999=_0x13e9f2;tgBot&&settings[_0x447999(0x217)]&&(tgBot[_0x447999(0x2ac)]('callback_query'),tgBot['sendMessage'](settings[_0x447999(0x217)],_0x447999(0x1a0),{'parse_mode':_0x447999(0x1b9),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x447999(0x27d)](_0x402a18=>{telegramError(_0x402a18);}),tgBot['on']('callback_query',async _0x569ac0=>{const _0x381e1=_0x447999,_0x350a36=_0x569ac0[_0x381e1(0x20f)],_0x67a937=_0x569ac0[_0x381e1(0x29b)];tgBot[_0x381e1(0x2a7)](_0x569ac0['id'])[_0x381e1(0x23f)](async()=>{const _0x1d832a=_0x381e1;if(_0x350a36!='no'){const _0x285899=0xf,_0x346586=_0x1d832a(0x1da),_0x57a66e=Array[_0x1d832a(0x224)](crypto[_0x1d832a(0x2bf)](new Uint32Array(_0x285899)))[_0x1d832a(0x2a3)](_0x2adcb5=>_0x346586[_0x2adcb5%_0x346586[_0x1d832a(0x24d)]])[_0x1d832a(0x1f9)](''),_0x122d08=bcrypt[_0x1d832a(0x234)](_0x57a66e,saltRounds);storeSettings({'bbPassword':_0x122d08}),await tgBot[_0x1d832a(0x2c1)](_0x67a937[_0x1d832a(0x22a)]['id'],_0x1d832a(0x29f)+_0x57a66e,{'parse_mode':_0x1d832a(0x1b9)})['catch'](_0x3931f1=>{telegramError(_0x3931f1);});}else await tgBot[_0x1d832a(0x2c1)](_0x67a937[_0x1d832a(0x22a)]['id'],_0x1d832a(0x1e8))[_0x1d832a(0x27d)](_0x55fe83=>{telegramError(_0x55fe83);});}),tgBot[_0x381e1(0x2ac)](_0x381e1(0x2d7));}));}function logging(_0x23b7f1){const _0x319928=_0x13e9f2;console[_0x319928(0x1ea)](getTimeStamp()+_0x319928(0x1ef)+_0x23b7f1);if(tgBot&&settings[_0x319928(0x217)]&&settings['telegramEvents']!=_0x319928(0x22e))tgBot['sendMessage'](settings[_0x319928(0x217)],_0x319928(0x285)+_0x23b7f1)[_0x319928(0x27d)](_0x461446=>{telegramError(_0x461446);});}function getServerTime(){const _0x109286=_0x13e9f2,_0x2d3810=new Date();return _0x2d3810[_0x109286(0x27f)]()+'/'+(_0x2d3810[_0x109286(0x19c)]()+0x1)[_0x109286(0x24c)]()[_0x109286(0x1bc)](0x2,'0')+'/'+_0x2d3810[_0x109286(0x1c6)]()[_0x109286(0x24c)]()[_0x109286(0x1bc)](0x2,'0')+'\x20'+_0x2d3810[_0x109286(0x1e3)]()[_0x109286(0x24c)]()[_0x109286(0x1bc)](0x2,'0')+':'+_0x2d3810[_0x109286(0x22d)]()[_0x109286(0x24c)]()[_0x109286(0x1bc)](0x2,'0')+':'+_0x2d3810[_0x109286(0x207)]()[_0x109286(0x24c)]()[_0x109286(0x1bc)](0x2,'0');}function getTimeStamp(){const _0xdba7c=_0x13e9f2,_0x396263=shiftedTime();return _0x396263['getFullYear']()+'/'+(_0x396263[_0xdba7c(0x19c)]()+0x1)[_0xdba7c(0x24c)]()['padStart'](0x2,'0')+'/'+_0x396263[_0xdba7c(0x1c6)]()[_0xdba7c(0x24c)]()[_0xdba7c(0x1bc)](0x2,'0')+'\x20'+_0x396263[_0xdba7c(0x1e3)]()[_0xdba7c(0x24c)]()[_0xdba7c(0x1bc)](0x2,'0')+':'+_0x396263[_0xdba7c(0x22d)]()[_0xdba7c(0x24c)]()[_0xdba7c(0x1bc)](0x2,'0')+':'+_0x396263['getSeconds']()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x2e8e81=new Date();let _0x2cd26=_0x2e8e81;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x2cd26=fns['add'](_0x2e8e81,{'hours':settings['timeshift']});return _0x2cd26;}function startScheduler(){const _0x2905da=_0x13e9f2;let _0x2283d6=new Date()[_0x2905da(0x20c)]();_0x2283d6==0x1&&backupConfigFiles();_0x2283d6==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x523c33=_0x13e9f2;fs[_0x523c33(0x1ae)](configpath,{'withFileTypes':!![]})[_0x523c33(0x2ae)](_0x324007=>{const _0x111e6b=_0x523c33;if(!_0x324007[_0x111e6b(0x237)]())fs['copyFileSync'](configpath+_0x324007[_0x111e6b(0x216)],configbackuppath+_0x324007[_0x111e6b(0x216)]);});}function triggerAnalytics(){const _0x3f048b=_0x13e9f2;analytics[_0x3f048b(0x210)]({'title':_0x3f048b(0x2b7),'href':_0x3f048b(0x2d2),'path':'/v'+serverversion});}function validateCredentials(_0xb1edee,_0x227982){const _0x1e1a37=_0x13e9f2;if(_0xb1edee['username']==settings['bbUsername']&&bcrypt[_0x1e1a37(0x1f7)](_0xb1edee[_0x1e1a37(0x1db)],settings[_0x1e1a37(0x225)])){if(settings[_0x1e1a37(0x2bc)])return{'allow':![],'reason':_0x1e1a37(0x1f8),'token':null};else{const _0x4a3c64=generateLoginToken(_0x227982);return{'allow':!![],'reason':_0x1e1a37(0x291),'token':_0x4a3c64};}}else return{'allow':![],'reason':_0x1e1a37(0x2a9),'token':null};}function refreshToken(_0x2b6d4b){const _0x300f1e=_0x13e9f2,_0x576c78=generateLoginToken(_0x2b6d4b);return{'allow':!![],'reason':_0x300f1e(0x291),'token':_0x576c78};}function validateAccess(_0x1a2034,_0x72f1cb){const _0x4bebd9=_0x13e9f2;let _0x1f9913=devices[_0x72f1cb]['ip'],_0x2222ef;const _0x1c35b8=_0x457e45=>{const _0x440d81=_0x37c9;if(settings['loginRequired']){if(settings[_0x440d81(0x2bc)]){if(telegram2FaApproved(_0x72f1cb)){const _0x34c6e7=generateLoginToken(_0x72f1cb);return{'allow':!![],'reason':_0x440d81(0x243),'token':_0x34c6e7};}else return{'allow':![],'reason':_0x440d81(0x275),'token':null};}else return _0x2222ef=validToken(_0x457e45,_0x72f1cb),_0x2222ef[_0x440d81(0x1e2)](_0x440d81(0x24e))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x457e45}:{'allow':![],'reason':_0x440d81(0x275),'token':null};}else return{'allow':!![],'reason':_0x440d81(0x22f),'token':null};};if(settings[_0x4bebd9(0x2b8)]){let _0x1bcbc1=[...settings[_0x4bebd9(0x241)],_0x4bebd9(0x1d4),_0x4bebd9(0x2c5),_0x4bebd9(0x1d0)];if(_0x1bcbc1['includes'](_0x1f9913))return _0x1c35b8(_0x1a2034);else{_0x2222ef=validToken(_0x1a2034,_0x72f1cb);if(_0x2222ef[_0x4bebd9(0x1e2)]('success'))return _0x1c35b8(_0x1a2034);else{if(telegramIpApproved(_0x72f1cb)){const _0x4d68be=generateToken(_0x72f1cb);return _0x2222ef=_0x1c35b8(_0x1a2034),_0x2222ef[_0x4bebd9(0x28d)]?{'allow':!![],'reason':_0x4bebd9(0x235),'token':_0x4d68be}:_0x2222ef;}else return settings[_0x4bebd9(0x1e4)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x4bebd9(0x202),'token':null};}}}else return _0x1c35b8(_0x1a2034);}function timelyDecrypt(_0x2d0200,_0x3c2e35=!![]){const _0x363f7c=_0x13e9f2;if(_0x2d0200)try{const _0x31ba6c=crypt[_0x363f7c(0x21d)](secure[_0x363f7c(0x273)],_0x2d0200)[_0x363f7c(0x29b)],_0x3af007=_0x31ba6c['split']('@')[0x0],_0x3b28b0=_0x31ba6c[_0x363f7c(0x1f2)]('@')[0x1],_0x4f1b29=new Date()[_0x363f7c(0x2c0)]();if(_0x3c2e35){if(_0x4f1b29-_0x3b28b0<maxSecretAge*0x3e8)return _0x3af007;else return![];}else return _0x3af007;}catch(_0x223222){return![];}else return![];}const validToken=(_0x587055,_0x37f622)=>{const _0x35c874=_0x13e9f2,_0x1f8b42=devices[_0x37f622]['ip'];if(!_0x587055)return{'error':_0x35c874(0x21a)};for(let _0x6d8e0 of blacklist){if(_0x6d8e0['token']==_0x587055)return{'error':_0x35c874(0x2d0)};}let _0x3b5f8a;try{_0x3b5f8a=jwt['verify'](_0x587055,secure[_0x35c874(0x2ca)]+_0x37f622);}catch{return{'error':_0x35c874(0x1d5)};}if(!_0x3b5f8a[_0x35c874(0x1e2)](_0x35c874(0x215))&&!_0x3b5f8a['hasOwnProperty'](_0x35c874(0x227))||!_0x3b5f8a[_0x35c874(0x1e2)](_0x35c874(0x1b6)))return{'error':_0x35c874(0x2a8)};if(!_0x3b5f8a[_0x35c874(0x1e2)]('username')&&_0x3b5f8a['hasOwnProperty'](_0x35c874(0x215))){const {clientip:_0x2a24a9}=_0x3b5f8a;return _0x1f8b42==_0x2a24a9?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x35c874(0x268)};}else{if(_0x3b5f8a[_0x35c874(0x1e2)]('username')&&_0x3b5f8a['hasOwnProperty'](_0x35c874(0x215))){const {username:_0x36efc4,clientip:_0x1f6aef}=_0x3b5f8a;return settings[_0x35c874(0x1cf)]==_0x36efc4&&_0x1f8b42==_0x1f6aef?{'success':_0x35c874(0x20a)}:{'error':_0x35c874(0x2a2)};}}},generateLoginToken=_0x2f0cf7=>{const _0x5ad8ed=_0x13e9f2;if(_0x2f0cf7){const _0x3b5114=devices[_0x2f0cf7]['ip'];return jwt[_0x5ad8ed(0x222)]({'username':settings[_0x5ad8ed(0x1cf)],'clientip':_0x3b5114},secure[_0x5ad8ed(0x2ca)]+_0x2f0cf7,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x570f25=>{const _0x177e5b=_0x13e9f2;if(_0x570f25){const _0x15dbec=devices[_0x570f25]['ip'];return jwt['sign']({'clientip':_0x15dbec},secure['secret']+_0x570f25,{'expiresIn':devices[_0x570f25]['telegramIpApproval'][_0x177e5b(0x27e)]*0x3c});}else return![];},telegramIpApproved=_0x51fe7a=>{const _0x27e689=_0x13e9f2;let _0x4d1e75=![];return devices[_0x51fe7a]['telegramIpApproval']&&devices[_0x51fe7a][_0x27e689(0x1b2)]['expiry']!=_0x27e689(0x28b)&&(_0x4d1e75=devices[_0x51fe7a][_0x27e689(0x1b2)]['clientip']==devices[_0x51fe7a]['ip']&&new Date()[_0x27e689(0x2c0)]()-devices[_0x51fe7a][_0x27e689(0x1b2)][_0x27e689(0x1ba)]<devices[_0x51fe7a]['telegramIpApproval'][_0x27e689(0x27e)]*0x3c*0x3e8),_0x4d1e75;},telegram2FaApproved=_0x3341f4=>{const _0x2f3112=_0x13e9f2;let _0x391066=![];return devices[_0x3341f4][_0x2f3112(0x2af)]&&devices[_0x3341f4][_0x2f3112(0x2af)]['expiry']!='reject'&&(_0x391066=devices[_0x3341f4][_0x2f3112(0x2af)][_0x2f3112(0x215)]==devices[_0x3341f4]['ip']&&new Date()[_0x2f3112(0x2c0)]()-devices[_0x3341f4][_0x2f3112(0x2af)][_0x2f3112(0x1ba)]<devices[_0x3341f4]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x391066;},normalizeIP=_0x20f412=>{const _0x4cb48c=_0x13e9f2;let _0x4586be=null,_0x562e4d=null;if(ipaddr[_0x4cb48c(0x1b0)](_0x20f412)){const _0x5a95b4=ipaddr['parse'](_0x20f412);_0x5a95b4[_0x4cb48c(0x1d9)]()===_0x4cb48c(0x196)?(_0x5a95b4['isIPv4MappedAddress']()&&(_0x4586be=_0x5a95b4['toIPv4Address']()['toString']()),_0x562e4d=_0x5a95b4[_0x4cb48c(0x24c)]()):(_0x4586be=_0x5a95b4[_0x4cb48c(0x24c)](),_0x562e4d=_0x5a95b4['toIPv4MappedAddress']()[_0x4cb48c(0x24c)]());}return{'show':_0x4586be?_0x4586be:_0x562e4d,'store':_0x562e4d};};