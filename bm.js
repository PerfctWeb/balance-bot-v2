const _0x583a45=_0x2cfb;(function(_0x483b8e,_0xf9b93b){const _0x43a8c1=_0x2cfb,_0x281e95=_0x483b8e();while(!![]){try{const _0x5a556f=parseInt(_0x43a8c1(0xe7))/0x1*(parseInt(_0x43a8c1(0x16e))/0x2)+-parseInt(_0x43a8c1(0x249))/0x3+-parseInt(_0x43a8c1(0xea))/0x4+-parseInt(_0x43a8c1(0x234))/0x5+parseInt(_0x43a8c1(0x108))/0x6+parseInt(_0x43a8c1(0x264))/0x7+parseInt(_0x43a8c1(0xed))/0x8*(parseInt(_0x43a8c1(0x268))/0x9);if(_0x5a556f===_0xf9b93b)break;else _0x281e95['push'](_0x281e95['shift']());}catch(_0x599393){_0x281e95['push'](_0x281e95['shift']());}}}(_0x22cf,0x2877c));const _0x640969=function(){let _0x1ae9ed=!![];return function(_0x546aea,_0xe49ee3){const _0x23cdeb=_0x1ae9ed?function(){const _0x41dd18=_0x2cfb;if(_0xe49ee3){const _0x2f095a=_0xe49ee3[_0x41dd18(0x15b)](_0x546aea,arguments);return _0xe49ee3=null,_0x2f095a;}}:function(){};return _0x1ae9ed=![],_0x23cdeb;};}(),_0x50ab97=_0x640969(this,function(){const _0xd8e6f0=_0x2cfb;return _0x50ab97[_0xd8e6f0(0x11a)]()[_0xd8e6f0(0x1c3)](_0xd8e6f0(0x265))['toString']()['constructor'](_0x50ab97)['search'](_0xd8e6f0(0x265));});_0x50ab97();'use strict';process[_0x583a45(0x28b)][_0x583a45(0x291)]=0x1;const childProcess=require(_0x583a45(0x240)),fs=require('fs'),fns=require(_0x583a45(0x20f)),low=require(_0x583a45(0xa8)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x583a45(0x1b5)),Crypt=require(_0x583a45(0x10f))[_0x583a45(0x26c)],RSA=require(_0x583a45(0x10f))[_0x583a45(0x1ea)],bcrypt=require('bcryptjs'),jwt=require(_0x583a45(0x1a4)),ipaddr=require(_0x583a45(0x135)),argv=require(_0x583a45(0x211))(process[_0x583a45(0x213)]['slice'](0x2))['argv'],uuidRandom=require(_0x583a45(0xa7)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x583a45(0x23d)),axios=require(_0x583a45(0x21b)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x583a45(0xb8)),fileUpload=require(_0x583a45(0x1e1)),{networkInterfaces}=require('os'),PORT=argv[_0x583a45(0x11c)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x583a45(0x143)](PORT)&&(console[_0x583a45(0xf5)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x583a45(0x1d8)),process[_0x583a45(0x1f2)](0x1));const HOST=argv[_0x583a45(0x275)]||null,userID=argv[_0x583a45(0x12e)]||'',debugging=argv['d']||![],nodeversion=process[_0x583a45(0x1bc)][_0x583a45(0x1e5)];let bbpath=_0x583a45(0x1f3),bbpath2='';const botfile=_0x583a45(0xd7),configfile=_0x583a45(0x1c0),settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x583a45(0x101))[_0x583a45(0x16f)]||_0x583a45(0x27e),maxBackups=0xa;let validInstallation=!![];!fs[_0x583a45(0x186)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x583a45(0x228)),configpath=userID?bbpath+_0x583a45(0xd4)+userID+'/':bbpath+_0x583a45(0xd4),configbackuppath=configpath+_0x583a45(0x195),logspath=userID?bbpath+_0x583a45(0x1f7)+userID+'/':bbpath+_0x583a45(0x1f7),zippath=userID?bbpath+_0x583a45(0xe5)+userID+'/':bbpath+_0x583a45(0xe5),loggerfile=fs['createWriteStream'](logspath+_0x583a45(0x281),{'flags':'a'}),temppath=userID?bbpath+_0x583a45(0x246)+userID+'/':bbpath+_0x583a45(0x246);!fs[_0x583a45(0x186)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);function _0x22cf(){const _0x1492a4=['tkn','all','-results.json','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','store-settings','existsSync','delete-bot','output-003.log','\x1b[35m','secure','callback','includes','place-order','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Restore\x20process\x20confirmed','password','kill','logged\x20out','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','f2aRequired','backup/','command','Telegram\x20error:','onepagemode','$1_$2_$3','login\x20required','getDate','forEach','value','updatebotmanager','Notifications\x20enabled','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','Bot\x20','find','on_','jsonwebtoken','You\x20can\x20use\x20the\x20following\x20commands:\x0a','botname','/:bot','User\x20has\x20been\x20validated','orders','hasOwnProperty','telegramChatId','getHours','compareSync','/:bot/history','5\x20min','6b67f3d61ee94b8f5c80b4affef4c4d9','/restart\x20-\x20restart\x20bot(s)\x0a','once','sendFile','loginRequired','crypto','Login\x20accepted','Starting\x20new\x20bot\x20|\x20Bot\x20','/help\x20-\x20show\x20available\x20commands\x0a','telegrammsg','mode','\x20>\x20','versions','createServer','min','publicKey','bb-config.json','All','telegramIpApproval','search','resetpw_no','writeFileSync','range','show-config','listen','tempaccess_15_','button','title','add-bot','update_yes','off','\x1b[0m','node-zip','backup','Notifications\x20disabled\x0a','sendMetricsTelegram','#RES#\x20if\x20running\x20on\x20server','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','telegramEnabled','apiKey',',\x20must\x20be\x20a\x204\x20digit\x20number','=>\x20Go\x20to\x20#CYA#http://','toggle_','Ok,\x20will\x20send\x20alert\x20notifications\x20only','generate','generateKeyPairAsync','-----------------------------------------------------------------------------------','reply','getSeconds','express-fileupload','send','whitelist','File\x20uploaded','node','sockets','\x20to\x20','2FA\x20required','sha256','RSA','string','exchange','Node.js\x20v','help','manual','0.0.0','assign','exit','bb/','Backup\x20file\x20unzipped\x20and\x20stored','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','private','logs/','simple','<b>Telegram\x20Bot\x20Status:</b>\x0a','server','files','event','Server',')\x20|\x20Bot\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/off\x20-\x20stop\x20bot(s)\x0a','length','sendPortfolioTelegram','resetpw_yes','map','login\x20token\x20valid','headless','encryptedUuid','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','new-disabled','lastmsgemitted','\x1b[36m','started','Logged\x20in\x20user\x20...','apiPassword','date-fns','error','yargs/yargs','login2fa_','argv','Unauthorized\x20attempt\x20to\x20delete\x20bot','mkdirSync','***','remoteAddress','getPortfolio','removeAllListeners','inherit','axios','telegramToken','2FA','Backup\x20file\x20uploaded','1000','Unauthorized\x20attempt\x20to\x20get\x20events','file','Unauthorized\x20attempt\x20to\x20delete\x20alerts','sign','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20update\x20bot','remove','stopped','clients','yes','\x20only\x0a','restart','bots','Telegraf\x20error:','hashSync','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','statSync','temporary\x20access\x20rejected','isIPv4MappedAddress','bbvNew','974990TQdDbO','timeshift','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','bbvReceive','\x20minutes','emitHistory','HTML','/:bot/performance','login\x20token\x20generated','mixpanel','2FA\x20login\x20required','botmanager','child_process','latestversion','stop','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','entries','uncaughtException','temp/','backup-full','Invalid\x20authentication\x20token\x20(2)','398295ifqchf','telegramUsername','action','function','settings.','alerts','Failed\x20to\x20download\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','placeOrder','settings','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','add','reload','\x20mode','output-001.log','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','ipc','headers','-events.json','update','SIGTERM','login2fa_reject_','format','2FA\x20login\x20token\x20generated','username','getFullYear','1242570eyHxty','(((.+)+)+)+$','pidExpireLogin','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','9YTsuzA','defaults','readFileSync','catch','Crypt','Starting\x20(','randomFillSync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','uuid','Restarting\x20Bot\x20','get','whitelistEnabled','hex','host','exp','privateKey','size','\x20|\x20','slice','set','getTime','family','production','portfolio_','replace','/output-000.log','userid','message','live','15\x20min','access\x20timeout','storeConfiguration','inlineKeyboard','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','tempaccess_5_','env','Unauthorized\x20attempt\x20to\x20store\x20configuration','names','clientip','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','disabled','NTBA_FIX_319','login\x20not\x20required','toggle','params','version','telegram','mtime','Idling\x20(','temporary\x20token\x20generated','metrics_','\x1b[31m','editMessageReplyMarkup','access',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','binary','startsWith','unlinkSync','#RES#\x20','running','warning','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','sortBy','args','push','blacklist','uuid-random','lowdb','auth','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20show\x20configuration','keys','Unauthorized\x20attempt\x20to\x20confirm\x20message','index.html','/:bot/coins','lastmsgtelegram','reinstall','write','match','timestamp','split','\x20|\x20user:\x20...','util','fork','full','build2','tempaccess_30_','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','exec','output-002.log','rmSync','apiSecret','max','/disable\x20-\x20disable\x20notifications\x0a','socket','/on\x20-\x20start\x20bot(s)\x0a','reinstall_no','then','number','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Restoring\x20bot(s)\x20from\x20backup','reinstall_yes','Error\x20removing\x20old\x20backup\x20files:','output-000.log','-config.json','toggleBotMode','All\x20bots','getMinutes','reinstall-bb','config/','Starting\x20#RED#Balance\x20Bot\x20v','reject','bot.js','logout','config_all','Markdown','emit','Notifications\x20disabled','padStart','::1','getMonth','ipv6','toggle-bot-mode','Invalid\x20username\x20or\x20IP\x20address','toIPv4Address','get-messages','zip/','/update\x20-\x20update\x20Balance\x20Bot\x0a','1718PYUMNz','Yes','post','1232808GehOyo','All\x20bots\x20running\x20right\x20now','-performance.json','2112832KBCAyV','copyFileSync','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','restore_no_','notification','backup-full@','expiry','restart_','log','use','getStartingBalances','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20log\x20out','temporary\x20access\x20not\x20allowed','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','botID','express','temporary\x20access\x20timeout','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','backup-files','version.json','confirm-message','/download/:type','token','telegramEvents','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','success','1686474FvDlgo','No\x20bots\x20running\x20right\x20now',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','http','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','store-headless','connection','hybrid-crypto-js','sendMessage','accept','name','showConfig','type','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','cancelLoading','conn','metrics','handshake','toString','SIGINT','port','off_','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','backup-full.zip','127.0.0.1','reset-password','config_alerts','chat','bot-','store','static','************','Setting\x20access:\x20','\x20(1)','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','disconnect','*$1*','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','user','Token\x20blacklisted','update-bb','pidRefreshToken','track','resetHistory','auto','ipaddr.js','show','tempaccess_reject_','sort','\x20|\x20client:\x20...','config_orders','Allow\x20login\x20from\x20IP\x20address\x20','Deleted\x20Bot\x20','launch','isDirectory','parse','connected','IPv4','Orders','test','Temporary\x20access\x20rejected','portfolio','Enabled\x20Bot\x20','status','Logged\x20out\x20user\x20...','initclient','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20update\x20settings','Invalid\x20authentication\x20token\x20(1)','reason','readdirSync','/metrics\x20-\x20show\x20bot\x20performance\x0a','get-backup-files','stringify','bot','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','No\x20authentication\x20token','/:bot/portfolio','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','decrypt','join','new','Session\x20expired\x20for\x20user\x20...','apply','delete-alerts','bb-secure.json','data','telegram2FaApproval','.zip','/upload-backup','debug','bbPassword','Alerts','staging','messages','enable','invalid\x20credentials','deleteHistoryAlerts','cloneDeep','filter','Unauthorized\x20attempt\x20to\x20add\x20bot','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','92dFEZpH','environment','enabled','Bot\x20Mgr\x20>\x20','\x1b[34m','build','allow','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','config','_data','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','::ffff:127.0.0.1','secret','from','login','bbUsername',':\x20Bot\x20Mgr\x20>\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','socket.io'];_0x22cf=function(){return _0x1492a4;};return _0x22cf();}!fs[_0x583a45(0x186)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x583a45(0x186)](temppath)&&fs[_0x583a45(0x215)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x583a45(0xb3)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x583a45(0x269)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x583a45(0x1f0),'onepagemode':![]}})[_0x583a45(0xb3)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x583a45(0x269)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x583a45(0x1e9),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x583a45(0x1b0),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings['telegramToken']!=_0x583a45(0x216))&&settings[_0x583a45(0x24a)]&&settings[_0x583a45(0x24a)]!='')initTelegram();const parseColor=(_0x45e0ba,_0x3bdff8)=>{const _0x2be7fd=_0x583a45,_0x940df8=/#[A-Z]{3}#/g;if(typeof _0x45e0ba==_0x2be7fd(0x1eb)){!_0x3bdff8?_0x45e0ba=_0x45e0ba['replace'](_0x940df8,''):(_0x45e0ba=_0x45e0ba['replace'](/#BLU#/g,_0x2be7fd(0x172)),_0x45e0ba=_0x45e0ba[_0x2be7fd(0x280)](/#RED#/g,_0x2be7fd(0x29b)),_0x45e0ba=_0x45e0ba['replace'](/#YEL#/g,'\x1b[33m'),_0x45e0ba=_0x45e0ba[_0x2be7fd(0x280)](/#MAG#/g,_0x2be7fd(0x189)),_0x45e0ba=_0x45e0ba['replace'](/#CYA#/g,_0x2be7fd(0x20b)),_0x45e0ba=_0x45e0ba[_0x2be7fd(0x280)](/#RES#/g,_0x2be7fd(0x1cf)));;}return _0x45e0ba;},logger={'screen':_0x426ed3=>{console['log'](parseColor(_0x426ed3,!![]));},'simple':_0x2057b8=>{const _0x2be193=_0x583a45;console[_0x2be193(0xf5)](parseColor(_0x2057b8,!![])),loggerfile[_0x2be193(0xb3)](util[_0x2be193(0x260)](parseColor(_0x2057b8,![]))+'\x0a');},'full':async _0x327edf=>{const _0x1f197e=_0x583a45,_0x2ef532=getTimeStamp()+_0x1f197e(0x17e)+_0x327edf;console[_0x1f197e(0xf5)](parseColor(_0x2ef532,!![])),loggerfile[_0x1f197e(0xb3)](util[_0x1f197e(0x260)](parseColor(_0x2ef532,![]))+'\x0a');if(tgBot&&settings[_0x1f197e(0x1ab)]&&settings[_0x1f197e(0x105)]!=_0x1f197e(0x1a9))await sendTelegram(settings[_0x1f197e(0x1ab)],_0x1f197e(0x171)+parseColor(_0x327edf,![]));},'debug':async(_0x58ec07,_0x31b146='')=>{const _0x41ce4a=_0x583a45,_0x103b28=getTimeStamp()+_0x41ce4a(0x9b)+_0x58ec07;if(debugging)console[_0x41ce4a(0xf5)](parseColor(_0x103b28,!![]));loggerfile['write'](util[_0x41ce4a(0x260)](parseColor(_0x103b28,![]))+'\x0a');if(_0x31b146){if(debugging)console['log'](_0x31b146);loggerfile[_0x41ce4a(0xb3)](util[_0x41ce4a(0x260)](_0x31b146)+'\x0a');}}};let terminating=![];process['on'](_0x583a45(0x245),function(_0x2433a4){const _0x4324be=_0x583a45;logger[_0x4324be(0x1f8)](_0x2433a4);}),process['on'](_0x583a45(0x1f2),()=>{stopAllBots();}),process['on'](_0x583a45(0x11b),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x583a45(0x101))[_0x583a45(0x295)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x583a45(0xfd)),app=express(),http=require(_0x583a45(0x10b))[_0x583a45(0x1bd)](app);app[_0x583a45(0xf6)](fileUpload({'useTempFiles':!![]})),app[_0x583a45(0x272)](_0x583a45(0x103),async(_0x240a4e,_0x38da6f)=>{const _0xeb535a=_0x583a45,_0x4ec2fe=_0x240a4e[_0xeb535a(0x294)][_0xeb535a(0x114)],_0x3c6ae3=getClientsWithBotID(_0xeb535a(0x23f)),_0x139298=_0x240a4e[_0xeb535a(0x25b)]['uuid'],_0xd59fb8=timelyDecrypt(_0x139298,![]),_0x163d7f=_0x3c6ae3['find'](_0x412445=>_0x412445[_0xeb535a(0x270)]==_0xd59fb8);if(_0x163d7f){const _0x42316b=normalizeIP(_0x240a4e['socket'][_0xeb535a(0x217)])[_0xeb535a(0x125)],_0x1bf31e=_0x240a4e[_0xeb535a(0x25b)][_0xeb535a(0x181)];if(validateAccess(_0x1bf31e,_0xd59fb8,_0x42316b)[_0xeb535a(0x174)])_0x4ec2fe==_0xeb535a(0x1d1)&&await backupConfigFiles(),await zipFiles(_0x4ec2fe),_0x38da6f['download'](zippath+(_0x4ec2fe+_0xeb535a(0x160)),_0x50ec27=>{const _0x2679e6=_0xeb535a;_0x50ec27&&(logger[_0x2679e6(0xba)](_0x2679e6(0x24f)+_0x4ec2fe),logger[_0x2679e6(0x1f8)](_0x50ec27));});else logger[_0xeb535a(0xba)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x4ec2fe+_0xeb535a(0x129));}else logger['full'](_0xeb535a(0xaa)+_0x4ec2fe+'\x20(2)');}),app[_0x583a45(0xe9)](_0x583a45(0x161),async(_0x10d8cd,_0x32a321)=>{const _0x2cd7c6=_0x583a45,_0x3488b4=getClientsWithBotID(_0x2cd7c6(0x23f)),_0x196483=_0x10d8cd['headers'][_0x2cd7c6(0x270)],_0x25dac2=timelyDecrypt(_0x196483,![]),_0x11ec1e=_0x3488b4[_0x2cd7c6(0x1a2)](_0x38e287=>_0x38e287['uuid']==_0x25dac2);logger[_0x2cd7c6(0x162)](_0x2cd7c6(0x21e));if(_0x11ec1e){const _0x478857=normalizeIP(_0x10d8cd[_0x2cd7c6(0xc4)]['remoteAddress'])[_0x2cd7c6(0x125)],_0x1db43c=_0x10d8cd['headers']['tkn'];if(validateAccess(_0x1db43c,_0x25dac2,_0x478857)[_0x2cd7c6(0x174)]){if(_0x10d8cd['files']){const _0x525bea=_0x10d8cd[_0x2cd7c6(0x1fb)]['backupfile'];await _0x525bea['mv'](temppath+_0x525bea[_0x2cd7c6(0x112)]),_0x32a321[_0x2cd7c6(0x1e2)]({'status':!![],'message':_0x2cd7c6(0x1e4)});const _0x238006=getBotsWithMode();_0x238006[_0x2cd7c6(0x201)]>0x0?confirmRestore(temppath,_0x525bea[_0x2cd7c6(0x112)]):unzipFile(temppath,_0x525bea[_0x2cd7c6(0x112)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x2cd7c6(0xba)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express['static'](path['join'](__dirname,bbpath2,_0x583a45(0xbb)))),app[_0x583a45(0xf6)](express[_0x583a45(0x126)](path[_0x583a45(0x158)](__dirname,bbpath2,_0x583a45(0x173)))),app[_0x583a45(0x272)]('/',function(_0x4e31db,_0x2f091a){const _0x162942=_0x583a45;_0x2f091a[_0x162942(0x1b3)](path['join'](__dirname,bbpath2,_0x162942(0xbb),'index.html'));}),app[_0x583a45(0x272)](_0x583a45(0x1a7),function(_0x4e7e78,_0x3c109e){const _0x422c0f=_0x583a45;_0x3c109e['sendFile'](path[_0x422c0f(0x158)](__dirname,bbpath2,'build',_0x422c0f(0xaf)));}),app[_0x583a45(0x272)](_0x583a45(0x155),(_0x4d3714,_0xfccd53)=>{const _0x2623c2=_0x583a45;_0xfccd53['sendFile'](path[_0x2623c2(0x158)](__dirname,bbpath2,_0x2623c2(0x173),_0x2623c2(0xaf)));}),app[_0x583a45(0x272)](_0x583a45(0x23b),(_0x3b4671,_0x5e2009)=>{const _0x1a84a8=_0x583a45;_0x5e2009[_0x1a84a8(0x1b3)](path['join'](__dirname,bbpath2,_0x1a84a8(0x173),'index.html'));}),app[_0x583a45(0x272)](_0x583a45(0xb0),(_0x18214b,_0x132d9c)=>{const _0xbfeaa1=_0x583a45;_0x132d9c[_0xbfeaa1(0x1b3)](path[_0xbfeaa1(0x158)](__dirname,bbpath2,_0xbfeaa1(0x173),_0xbfeaa1(0xaf)));}),app[_0x583a45(0x272)](_0x583a45(0x1ae),(_0x4b1772,_0x536a37)=>{const _0x5665ba=_0x583a45;_0x536a37[_0x5665ba(0x1b3)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x583a45(0x272)]('/:bot/configuration',(_0x34f19c,_0x1daf40)=>{const _0x54a084=_0x583a45;_0x1daf40[_0x54a084(0x1b3)](path['join'](__dirname,bbpath2,_0x54a084(0x173),_0x54a084(0xaf)));}),app[_0x583a45(0x272)]('/:bot/support',(_0x39f9eb,_0x184316)=>{_0x184316['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x583a45(0x1c8)](PORT,HOST);else http['listen'](PORT);const io=require(_0x583a45(0x180))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x185a6c=_0x583a45;let _0x31ccf7='[ip-address]';const _0x459acc=networkInterfaces(),_0x300576={};for(const _0x37d1f1 of Object[_0x185a6c(0xad)](_0x459acc)){for(const _0x3b173c of _0x459acc[_0x37d1f1]){if((_0x3b173c[_0x185a6c(0x27d)]==_0x185a6c(0x141)||_0x3b173c[_0x185a6c(0x27d)]==0x4)&&!_0x3b173c['internal']){const _0x12bea2=ipaddr[_0x185a6c(0x13f)](_0x3b173c['address'])[_0x185a6c(0x1c6)]();_0x12bea2!=_0x185a6c(0x1f6)&&(!_0x300576[_0x37d1f1]&&(_0x300576[_0x37d1f1]=[]),_0x300576[_0x37d1f1]['push'](_0x3b173c['address']),_0x31ccf7=_0x3b173c['address']);}}}return{'serverip':_0x31ccf7,'netinterfaces':_0x300576};}async function startServer(){const _0xe385fb=_0x583a45,{serverip:_0x1aa2dd,netinterfaces:_0x5bbfbc}=getServerIP();logger[_0xe385fb(0x1f8)](''),logger[_0xe385fb(0x1f8)](_0xe385fb(0x1de)),await logger[_0xe385fb(0xba)](_0xe385fb(0xd5)+serverversion+_0xe385fb(0x9f)+(environment==_0xe385fb(0x165)?'(staging)':'')+'\x0a'+(_0xe385fb(0x1f5)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0xe385fb(0x1d9)+_0x1aa2dd+':'+PORT+_0xe385fb(0x1d4))),logger[_0xe385fb(0x1f8)](_0xe385fb(0x1de));if(config[_0xe385fb(0x201)]!=0x0)for(const _0x27274f of config){const _0x323c6e=_0x27274f['mode']==_0xe385fb(0x134)?'a':'m';if(_0x27274f['status']==_0xe385fb(0x170)||_0x27274f[_0xe385fb(0x147)]==_0xe385fb(0x159))await logger[_0xe385fb(0xba)](_0xe385fb(0x26d)+_0x323c6e+_0xe385fb(0x1fe)+_0x27274f[_0xe385fb(0xfc)]+_0xe385fb(0x279)+_0x27274f['botname']),startBot([_0x27274f['botID'],userID],{'cwd':bbpath},function(_0x1fa265){const _0x587960=_0xe385fb;if(_0x1fa265)logger[_0x587960(0xba)](_0x1fa265);});else(_0x27274f['status']==_0xe385fb(0x290)||_0x27274f[_0xe385fb(0x147)]=='new-disabled')&&await logger['full'](_0xe385fb(0x298)+_0x323c6e+')\x20\x20\x20|\x20Bot\x20'+_0x27274f[_0xe385fb(0xfc)]+_0xe385fb(0x279)+_0x27274f[_0xe385fb(0x1a6)]);}else!newBot&&logger[_0xe385fb(0x1f8)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple'](_0xe385fb(0x1de)),logger['simple'](''),await logger[_0xe385fb(0x162)](_0xe385fb(0x1ed)+nodeversion),await logger[_0xe385fb(0x162)]('Network\x20Interfaces:',_0x5bbfbc);}function startSocket(){const _0x432070=_0x583a45;io['on'](_0x432070(0x10e),_0x5b1a7e=>{const _0x57a2d1=_0x432070;let _0x156dfb,_0x5a8b62,_0x13ba04,_0x170f45,_0x9e4716;const _0x4f01f7=_0x5b1a7e[_0x57a2d1(0x119)][_0x57a2d1(0x25b)]['referer'];_0x5a8b62=_0x4f01f7[_0x57a2d1(0xb4)](/bot[0-9]{3}/);if(_0x5a8b62)_0x13ba04=_0x5a8b62[0x0][_0x57a2d1(0xb4)](/[0-9]{3}/);if(_0x13ba04)_0x156dfb=_0x13ba04[0x0];else _0x156dfb='botmanager';const _0x50d598=_0x5b1a7e[_0x57a2d1(0x119)][_0x57a2d1(0xa9)][_0x57a2d1(0x207)];if(!_0x50d598)_0x5b1a7e['emit'](_0x57a2d1(0x147),{'publicKey':secure[_0x57a2d1(0x1bf)]});else{_0x170f45=timelyDecrypt(_0x50d598,![]);if(!_0x170f45)_0x5b1a7e['emit'](_0x57a2d1(0x147),{'publicKey':secure[_0x57a2d1(0x1bf)]});else{_0x9e4716=normalizeIP(_0x5b1a7e[_0x57a2d1(0x117)][_0x57a2d1(0x217)])[_0x57a2d1(0x125)];if(!devices[_0x170f45])devices[_0x170f45]={'uuid':_0x170f45,'access':{'token':null}};devices[_0x170f45]['ip']=_0x9e4716;const _0x1a5a88=addClient(_0x5b1a7e['id'],_0x170f45,_0x156dfb);setAccess(_0x1a5a88),emitMessages(),_0x5b1a7e['on'](_0x57a2d1(0x17c),_0x124c32=>{const _0x15ca75=_0x57a2d1,_0x5dcca=timelyDecrypt(_0x124c32[_0x15ca75(0x190)]);if(_0x5dcca){_0x124c32={'username':_0x124c32['username'],'password':_0x5dcca},devices[_0x170f45][_0x15ca75(0x29d)]=validateCredentials(_0x124c32,_0x170f45);if(devices[_0x170f45][_0x15ca75(0x29d)][_0x15ca75(0x174)]==![]&&devices[_0x170f45][_0x15ca75(0x29d)][_0x15ca75(0x14d)]==_0x15ca75(0x23e))_0x5b1a7e[_0x15ca75(0xdb)]('status',{'access':devices[_0x170f45][_0x15ca75(0x29d)]}),loginAccess2FA(_0x170f45,_0x9e4716);else{if(devices[_0x170f45][_0x15ca75(0x29d)][_0x15ca75(0x174)]==![]&&devices[_0x170f45][_0x15ca75(0x29d)][_0x15ca75(0x14d)]==_0x15ca75(0x168))_0x5b1a7e[_0x15ca75(0xdb)](_0x15ca75(0x147),{'access':devices[_0x170f45]['access']});else devices[_0x170f45][_0x15ca75(0x29d)][_0x15ca75(0x174)]&&devices[_0x170f45][_0x15ca75(0x29d)]['reason']==_0x15ca75(0x23c)&&(getClientsWithUuid(_0x170f45)[_0x15ca75(0x19c)](_0x353590=>{setAccess(_0x353590);}),logger[_0x15ca75(0x162)](_0x15ca75(0x20d)+_0x170f45[_0x15ca75(0x27a)](-0x8)),setTokenRefresh(_0x170f45),setSessionTimeout('login',_0x170f45));}}else logger[_0x15ca75(0xba)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x5b1a7e['on'](_0x57a2d1(0x121),()=>{resetPassword();}),_0x5b1a7e['on']('disconnect',_0x23bc53=>{removeClient(_0x5b1a7e['id']);}),_0x156dfb==_0x57a2d1(0x23f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x257a54){const _0x163add=_0x583a45;if(_0x257a54!=_0x163add(0x23f)&&config[_0x163add(0x1d7)]!=''){if(pid[_0x257a54])pid[_0x257a54][_0x163add(0x1e2)]({'function':_0x163add(0x149),'args':null});}_0x257a54!='botmanager'&&broadcastToBots(_0x163add(0x22c),JSON[_0x163add(0x151)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x75f1e1=>{const _0x249f0d=_0x2cfb;getSocket(_0x75f1e1['id'])[_0x249f0d(0xdb)](_0x249f0d(0x147),{'access':{'allow':![],'reason':_0x249f0d(0x255),'token':null}});});}function getSocket(_0x4a5419){const _0x3650cb=_0x583a45;return io[_0x3650cb(0x1e6)][_0x3650cb(0x1e6)]['get'](_0x4a5419);}function setAccess(_0x262bdb){const _0x4ed230=_0x583a45,_0x324bba=getSocket(_0x262bdb['id']),_0xd71ef2=_0x262bdb['uuid'],_0x2ed8e1=_0x262bdb['bot'];devices[_0xd71ef2][_0x4ed230(0x29d)]=validateAccess(devices[_0xd71ef2]['access']['token'],_0xd71ef2),logger['debug'](_0x4ed230(0x128)+devices[_0xd71ef2][_0x4ed230(0x29d)]['reason']+_0x4ed230(0x139)+_0x262bdb['id'][_0x4ed230(0x27a)](-0x8)+_0x4ed230(0xb7)+_0xd71ef2['slice'](-0x8)),_0x324bba[_0x4ed230(0x158)](_0xd71ef2);if(devices[_0xd71ef2]['access']['allow']){_0x324bba[_0x4ed230(0x158)](_0x2ed8e1);if(_0x2ed8e1=='botmanager')initializeSocketBotManager(_0x324bba);else initializeSocketBot(_0x324bba);initClient(_0x2ed8e1);}devices[_0xd71ef2][_0x4ed230(0x29d)][_0x4ed230(0x104)]&&devices[_0xd71ef2][_0x4ed230(0x29d)]['reason']==_0x4ed230(0x299)&&setSessionTimeout(_0x4ed230(0x21d),_0xd71ef2),devices[_0xd71ef2]['access']['token']&&devices[_0xd71ef2][_0x4ed230(0x29d)][_0x4ed230(0x14d)]==_0x4ed230(0x261)&&setSessionTimeout(_0x4ed230(0x17c),_0xd71ef2),_0x324bba['emit'](_0x4ed230(0x147),{'status':_0x262bdb[_0x4ed230(0x1fa)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xd71ef2][_0x4ed230(0x29d)],'externalip':devices[_0xd71ef2]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0xd71ef2][_0x4ed230(0x29d)][_0x4ed230(0x174)]==![]&&devices[_0xd71ef2][_0x4ed230(0x29d)][_0x4ed230(0x14d)]==_0x4ed230(0x1e8)&&temporaryAccess2FA(_0xd71ef2,devices[_0xd71ef2]['ip']);}function setSessionTimeout(_0x517f62,_0x52bfb6){const _0x4c10bb=_0x583a45;let _0x4a3132;if(_0x517f62==_0x4c10bb(0x17c))_0x4a3132=loginExpiry*0x3c*0x3e8;else _0x4a3132=devices[_0x52bfb6][_0x4c10bb(0x1c2)]['expiry']*0x3c*0x3e8-(new Date()[_0x4c10bb(0x27c)]()-devices[_0x52bfb6]['telegramIpApproval'][_0x4c10bb(0xb5)]);if(devices[_0x52bfb6]['pidExpireLogin'])clearTimeout(devices[_0x52bfb6][_0x4c10bb(0x266)]);devices[_0x52bfb6][_0x4c10bb(0x266)]=setTimeout(()=>{const _0x82bea=_0x4c10bb;if(devices[_0x52bfb6][_0x82bea(0x131)])clearTimeout(devices[_0x52bfb6]['pidRefreshToken']);removeSocketListeners(_0x52bfb6),addBlacklist(_0x52bfb6),devices[_0x52bfb6][_0x82bea(0x1c2)]=null,devices[_0x52bfb6]['telegram2FaApproval']=null,devices[_0x52bfb6][_0x82bea(0x29d)][_0x82bea(0x104)]=null,logger[_0x82bea(0x162)](_0x82bea(0x15a)+_0x52bfb6[_0x82bea(0x27a)](-0x8)),devices[_0x52bfb6][_0x82bea(0x29d)]=validateAccess(devices[_0x52bfb6][_0x82bea(0x29d)][_0x82bea(0x104)],_0x52bfb6),!(devices[_0x52bfb6][_0x82bea(0x29d)][_0x82bea(0x174)]&&devices[_0x52bfb6][_0x82bea(0x29d)][_0x82bea(0x14d)]=='login\x20not\x20required')&&(_0x517f62=='login'?io['to'](_0x52bfb6)[_0x82bea(0xdb)]('status',{'access':{'allow':![],'reason':_0x82bea(0x286),'token':null}}):io['to'](_0x52bfb6)[_0x82bea(0xdb)](_0x82bea(0x147),{'access':{'allow':![],'reason':_0x82bea(0xfe),'token':null}})),devices[_0x52bfb6][_0x82bea(0x29d)][_0x82bea(0x104)]=null;},_0x4a3132);}function setTokenRefresh(_0x5cce30){const _0x403ffd=_0x583a45;if(devices[_0x5cce30][_0x403ffd(0x131)])clearTimeout(devices[_0x5cce30][_0x403ffd(0x131)]);devices[_0x5cce30][_0x403ffd(0x131)]=setTimeout(()=>{const _0x23665e=_0x403ffd;getClientsWithUuid(_0x5cce30)['length']!=0x0?(devices[_0x5cce30][_0x23665e(0x29d)]=refreshToken(_0x5cce30),io['to'](_0x5cce30)[_0x23665e(0xdb)]('status',{'status':_0x23665e(0x140),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5cce30][_0x23665e(0x29d)],'externalip':devices[_0x5cce30]['ip'],'publicKey':secure[_0x23665e(0x1bf)],'validInstallation':validInstallation}),setTokenRefresh(_0x5cce30)):clearTimeout(devices[_0x5cce30]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2cafe4){const _0x232481=_0x583a45,_0x476a12=getClient(_0x2cafe4['id'])[_0x232481(0x270)];_0x2cafe4[_0x232481(0xdb)](_0x232481(0x22c),config),_0x2cafe4['emit'](_0x232481(0x252),cleanSettings()),_0x2cafe4['on'](_0x232481(0x1cc),_0x10edae=>{const _0x1f9536=_0x232481;if(validateAccess(_0x10edae,_0x476a12)[_0x1f9536(0x174)])addBot();else logger['full'](_0x1f9536(0x16c));}),_0x2cafe4['on']('update-bot',(_0x2ce69a,_0x56c700)=>{const _0x32acb0=_0x232481;if(validateAccess(_0x56c700,_0x476a12)[_0x32acb0(0x174)])toggleBot(_0x2ce69a[_0x32acb0(0xfc)],_0x2ce69a[_0x32acb0(0x147)],_0x2ce69a['live']);else logger[_0x32acb0(0xba)](_0x32acb0(0x225));}),_0x2cafe4['on'](_0x232481(0xe1),(_0x380b4a,_0x29ae22)=>{const _0x43c207=_0x232481;if(validateAccess(_0x29ae22,_0x476a12)[_0x43c207(0x174)])toggleBotMode(_0x380b4a);else logger[_0x43c207(0xba)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2cafe4['on'](_0x232481(0x187),(_0x52f304,_0x5dca11)=>{const _0x350fc9=_0x232481;if(validateAccess(_0x5dca11,_0x476a12)[_0x350fc9(0x174)])deleteBot(_0x52f304);else logger[_0x350fc9(0xba)](_0x350fc9(0x214));}),_0x2cafe4['on'](_0x232481(0x185),(_0x1b12d4,_0x29c9d6)=>{const _0x1ab65b=_0x232481;if(validateAccess(_0x29c9d6,_0x476a12)[_0x1ab65b(0x174)])storeSettings(_0x1b12d4,!![]);else logger[_0x1ab65b(0xba)](_0x1ab65b(0x14b));}),_0x2cafe4['on'](_0x232481(0x130),_0x33e142=>{const _0x127ec9=_0x232481;if(validateAccess(_0x33e142,_0x476a12)[_0x127ec9(0x174)])updateBB(_0x127ec9(0x25d));else logger[_0x127ec9(0xba)](_0x127ec9(0xc9));}),_0x2cafe4['on'](_0x232481(0xd3),_0x1ee0bc=>{const _0x35f86b=_0x232481;if(validateAccess(_0x1ee0bc,_0x476a12)['allow'])updateBB(_0x35f86b(0xb2));else logger[_0x35f86b(0xba)](_0x35f86b(0x184));}),_0x2cafe4['on'](_0x232481(0x150),_0x501fe4=>{const _0x5a0276=_0x232481;if(validateAccess(_0x501fe4,_0x476a12)[_0x5a0276(0x174)]){const _0x517ef0=getClient(_0x2cafe4['id']);if(_0x517ef0)getBackupFiles(_0x517ef0[_0x5a0276(0x270)]);else logger[_0x5a0276(0xba)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x5a0276(0xba)](_0x5a0276(0xa2));}),_0x2cafe4['on']('restore-backup-file',(_0x2121e4,_0x133d96)=>{const _0x3b5f23=_0x232481;if(validateAccess(_0x133d96,_0x476a12)[_0x3b5f23(0x174)])restoreBackupFile(_0x2121e4);else logger[_0x3b5f23(0xba)](_0x3b5f23(0x106));}),_0x2cafe4['on'](_0x232481(0xe4),_0x15d8e3=>{const _0x5f373b=_0x232481;if(validateAccess(_0x15d8e3,_0x476a12)[_0x5f373b(0x174)])getMessages();else logger[_0x5f373b(0xba)](_0x5f373b(0xab));}),_0x2cafe4['on'](_0x232481(0x102),(_0x1eed0c,_0x4f4394)=>{const _0x5d1e4a=_0x232481;if(validateAccess(_0x4f4394,_0x476a12)[_0x5d1e4a(0x174)])confirmMessage(_0x1eed0c);else logger[_0x5d1e4a(0xba)](_0x5d1e4a(0xae));}),_0x2cafe4['on']('logout',_0x2f04e3=>{const _0x387a2b=_0x232481;if(validateAccess(_0x2f04e3,_0x476a12)['allow']){if(devices[_0x476a12]['pidRefreshToken'])clearTimeout(devices[_0x476a12]['pidRefreshToken']);if(devices[_0x476a12][_0x387a2b(0x266)])clearTimeout(devices[_0x476a12][_0x387a2b(0x266)]);removeSocketListeners(getClient(_0x2cafe4['id'])['uuid']),addBlacklist(_0x476a12),devices[_0x476a12][_0x387a2b(0x1c2)]=null,devices[_0x476a12][_0x387a2b(0x15f)]=null,devices[_0x476a12]['access'][_0x387a2b(0x104)]=null,logger[_0x387a2b(0x162)](_0x387a2b(0x148)+_0x476a12[_0x387a2b(0x27a)](-0x8)),io['to'](getClient(_0x2cafe4['id'])[_0x387a2b(0x270)])[_0x387a2b(0xdb)](_0x387a2b(0x147),{'access':{'allow':![],'reason':_0x387a2b(0x192),'token':null}});}else logger[_0x387a2b(0xba)](_0x387a2b(0xf9));});}function initializeSocketBot(_0x2f4125){const _0x525785=_0x583a45,_0x34b21b=getClient(_0x2f4125['id'])[_0x525785(0x152)],_0x4fee0c=getClient(_0x2f4125['id'])[_0x525785(0x270)];_0x2f4125['on']('get-logs',(_0x27b6f1,_0x1f5069)=>{const _0x42c3c1=_0x525785;if(validateAccess(_0x1f5069,_0x4fee0c)[_0x42c3c1(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b][_0x42c3c1(0x1e2)]({'function':_0x42c3c1(0x239),'args':_0x27b6f1});}else logger[_0x42c3c1(0xba)](_0x42c3c1(0x220));}),_0x2f4125['on'](_0x525785(0x15c),(_0x24d786,_0x5b7039)=>{const _0xf81fef=_0x525785;if(validateAccess(_0x5b7039,_0x4fee0c)[_0xf81fef(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b][_0xf81fef(0x1e2)]({'function':_0xf81fef(0x169),'args':_0x24d786});}else logger[_0xf81fef(0xba)](_0xf81fef(0x222));}),_0x2f4125['on']('get-portfolio',(_0x4e5c8f,_0x412cef)=>{const _0x596e50=_0x525785;if(validateAccess(_0x412cef,_0x4fee0c)[_0x596e50(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b][_0x596e50(0x1e2)]({'function':_0x596e50(0x218),'args':_0x4e5c8f});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x2f4125['on']('store-configuration',(_0x4359ce,_0x1208fb)=>{const _0x82fb87=_0x525785;if(validateAccess(_0x1208fb,_0x4fee0c)['allow']){if(pid[_0x34b21b])pid[_0x34b21b][_0x82fb87(0x1e2)]({'function':_0x82fb87(0x287),'args':_0x4359ce});}else logger['full'](_0x82fb87(0x28c));}),_0x2f4125['on'](_0x525785(0x10d),(_0x434e92,_0x85ed7f)=>{const _0x58687d=_0x525785;if(validateAccess(_0x85ed7f,_0x4fee0c)[_0x58687d(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b]['send']({'function':'storeHeadless','args':_0x434e92});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x2f4125['on']('store-fiat',(_0x57268b,_0x57076c)=>{const _0x5f3913=_0x525785;if(validateAccess(_0x57076c,_0x4fee0c)[_0x5f3913(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b]['send']({'function':'storeFiat','args':_0x57268b});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x2f4125['on']('reset-history',_0x33a4e0=>{const _0x39f52a=_0x525785;if(validateAccess(_0x33a4e0,_0x4fee0c)[_0x39f52a(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b]['send']({'function':_0x39f52a(0x133),'args':null});}else logger[_0x39f52a(0xba)](_0x39f52a(0x259));}),_0x2f4125['on']('get-starting-balances',_0x3d8d9b=>{const _0x1dd1bd=_0x525785;if(validateAccess(_0x3d8d9b,_0x4fee0c)[_0x1dd1bd(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b][_0x1dd1bd(0x1e2)]({'function':_0x1dd1bd(0xf7),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2f4125['on'](_0x525785(0x18d),(_0x1fee9e,_0x4614c1)=>{const _0x225ac0=_0x525785;if(validateAccess(_0x4614c1,_0x4fee0c)[_0x225ac0(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b]['send']({'function':_0x225ac0(0x251),'args':_0x1fee9e});}else logger['full'](_0x225ac0(0x253));}),_0x2f4125['on']('cancel-loading',_0x267727=>{const _0x421f59=_0x525785;if(validateAccess(_0x267727,_0x4fee0c)['allow']){if(pid[_0x34b21b])pid[_0x34b21b][_0x421f59(0x1e2)]({'function':_0x421f59(0x116),'args':null});}else logger[_0x421f59(0xba)](_0x421f59(0x18e));}),_0x2f4125['on'](_0x525785(0x1c7),_0x434909=>{const _0x27fcc5=_0x525785;if(validateAccess(_0x434909,_0x4fee0c)[_0x27fcc5(0x174)]){if(pid[_0x34b21b])pid[_0x34b21b][_0x27fcc5(0x1e2)]({'function':_0x27fcc5(0x113),'args':null});}else logger[_0x27fcc5(0xba)](_0x27fcc5(0xac));}),_0x2f4125['on'](_0x525785(0x130),_0x1751c9=>{const _0x59eb36=_0x525785;if(validateAccess(_0x1751c9,_0x4fee0c)['allow'])updateBB(_0x59eb36(0x25d));else logger[_0x59eb36(0xba)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2f4125['on']('get-messages',_0x57e699=>{const _0x499f92=_0x525785;if(validateAccess(_0x57e699,_0x4fee0c)['allow'])getMessages();else logger['full'](_0x499f92(0xab));}),_0x2f4125['on'](_0x525785(0x102),(_0x3926fa,_0x358625)=>{const _0x87d68b=_0x525785;if(validateAccess(_0x358625,_0x4fee0c)[_0x87d68b(0x174)])confirmMessage(_0x3926fa);else logger['full'](_0x87d68b(0xae));}),_0x2f4125['on'](_0x525785(0xd8),_0x1ca961=>{const _0x523998=_0x525785;if(validateAccess(_0x1ca961,_0x4fee0c)['allow']){if(devices[_0x4fee0c]['pidRefreshToken'])clearTimeout(devices[_0x4fee0c]['pidRefreshToken']);if(devices[_0x4fee0c][_0x523998(0x266)])clearTimeout(devices[_0x4fee0c][_0x523998(0x266)]);removeSocketListeners(getClient(_0x2f4125['id'])[_0x523998(0x270)]),addBlacklist(_0x4fee0c),devices[_0x4fee0c][_0x523998(0x1c2)]=null,devices[_0x4fee0c]['telegram2FaApproval']=null,devices[_0x4fee0c]['access'][_0x523998(0x104)]=null,logger[_0x523998(0x162)](_0x523998(0x148)+_0x4fee0c[_0x523998(0x27a)](-0x8)),io['to'](getClient(_0x2f4125['id'])[_0x523998(0x270)])[_0x523998(0xdb)](_0x523998(0x147),{'access':{'allow':![],'reason':_0x523998(0x192),'token':null}});}else logger[_0x523998(0xba)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x54a4ff){getClientsWithUuid(_0x54a4ff)['forEach'](_0x57fab1=>{const _0x97b9a9=_0x2cfb;getSocket(_0x57fab1['id'])[_0x97b9a9(0x219)]();});}function cleanSettings(){const _0x63d417=_0x583a45;let _0x5e4560=settings;return settings[_0x63d417(0x21c)]&&settings[_0x63d417(0x21c)]!=''&&(_0x5e4560={..._0x5e4560,'telegramToken':_0x63d417(0x127)}),settings[_0x63d417(0x163)]&&settings[_0x63d417(0x163)]!=''&&(_0x5e4560={..._0x5e4560,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x63d417(0x163)]==_0x63d417(0x216)||settings['telegramToken']&&settings[_0x63d417(0x21c)]==_0x63d417(0x216))&&(_0x5e4560={..._0x5e4560,'restored':{'password':settings[_0x63d417(0x163)]=='***','telegram':settings['telegramToken']==_0x63d417(0x216)}}),_0x5e4560;}async function updateBB(_0x38f45a){const _0x572ff8=_0x583a45;await backupConfigFiles(),installingUpdate=!![],config[_0x572ff8(0x19c)](_0x2e6a71=>{const _0x6e7046=_0x572ff8;restartBot(_0x2e6a71[_0x6e7046(0xfc)]);});if(_0x38f45a==_0x572ff8(0x25d))process['send']({'update':!![],'environment':environment},_0x10fdc4=>{});else _0x38f45a=='reinstall'&&process[_0x572ff8(0x1e2)]({'reinstall':!![],'environment':environment},_0xa1d2c7=>{});}function startBot(_0x8aa1fe,_0x1f956d,_0x4451ed){const _0xa9b888=_0x583a45;if(debugging)_0x8aa1fe[_0xa9b888(0xa5)]('-d');let _0x2a3d94=![];const _0x152a68=_0x8aa1fe[0x0];_0x1f956d={..._0x1f956d,'stdio':['inherit',_0xa9b888(0x21a),_0xa9b888(0x21a),_0xa9b888(0x25a)]},pid[_0x152a68]=childProcess[_0xa9b888(0xb9)](botfile,_0x8aa1fe,_0x1f956d),pid[_0x152a68]['on'](_0xa9b888(0x283),_0x46656e=>{const _0x47b34f=_0xa9b888;switch(Object[_0x47b34f(0xad)](_0x46656e)[0x0]){case _0x47b34f(0x1a6):updateBotName(_0x152a68,_0x46656e[_0x47b34f(0x1a6)]);break;case _0x47b34f(0x19e):updateBotManager();break;case _0x47b34f(0x147):updateStatus(_0x152a68,_0x46656e[_0x47b34f(0x147)]);break;case _0x47b34f(0x284):updateLive(_0x152a68,_0x46656e['live']);break;case _0x47b34f(0x20c):updateLive(_0x152a68,_0x46656e[_0x47b34f(0x20c)]),io['to'](_0x152a68)['emit']('status',{'access':{'allow':![],'reason':_0x47b34f(0x255),'token':null}});break;case _0x47b34f(0x242):_0x46656e['stop']=='restart'&&restartBot(_0x152a68);_0x46656e[_0x47b34f(0x242)]==_0x47b34f(0x191)&&toggleBot(_0x152a68,_0x47b34f(0x290),_0x47b34f(0x227));break;case _0x47b34f(0x296):sendTelegramBot(_0x152a68,_0x46656e[_0x47b34f(0x296)]);break;case _0x47b34f(0x1b9):sendTelegramMsg(_0x46656e[_0x47b34f(0x1b9)]);break;case'function':io['to'](_0x152a68)[_0x47b34f(0xdb)](_0x46656e[_0x47b34f(0x24c)],_0x46656e[_0x47b34f(0xa4)]);break;}}),pid[_0x152a68]['on']('error',function(_0x1b73da){if(_0x2a3d94)return;_0x2a3d94=!![],_0x4451ed(_0x1b73da);}),pid[_0x152a68]['on'](_0xa9b888(0x1f2),async function(_0x272dd5){const _0x12d7bd=_0xa9b888;if(terminating)return;if(installingUpdate){logger[_0x12d7bd(0x162)](_0x12d7bd(0x1a0)),io['close']();return;}if(_0x2a3d94)return;_0x2a3d94=!![],_0x4451ed(null);const _0x4086d9=dbConfig[_0x12d7bd(0x272)](_0x12d7bd(0x22c))[_0x12d7bd(0x1a2)]({'botID':_0x152a68})[_0x12d7bd(0x19d)]();_0x4086d9&&(_0x4086d9['status']=='enabled'||_0x4086d9[_0x12d7bd(0x147)]==_0x12d7bd(0x159))&&(await sleep(0x3e8),updateLive(_0x152a68,_0x12d7bd(0x227)),logger['full'](_0x12d7bd(0x271)+_0x152a68),startBot([_0x152a68,userID],{'cwd':bbpath},function(_0x58cbcc){const _0x128cd3=_0x12d7bd;if(_0x58cbcc)logger[_0x128cd3(0xba)](_0x58cbcc);}));});}function stopBot(_0x3884ed){const _0x3c1067=_0x583a45;getClientsWithBotID(_0x3884ed)['forEach'](_0x431de6=>{const _0x4fa886=_0x2cfb;getSocket(_0x431de6['id'])[_0x4fa886(0x12b)](!![]),removeClient(_0x431de6['id']);}),pid[_0x3884ed]&&(pid[_0x3884ed][_0x3c1067(0x191)](),pid[_0x3884ed]=null);}function stopAllBots(){const _0x47a286=_0x583a45;terminating=!![];const _0x10c5d4=getEnabledBots();_0x10c5d4[_0x47a286(0x19c)](_0x166598=>{const _0x250f1e=_0x47a286;stopBot(_0x166598[_0x250f1e(0xfc)]);});}function restartBot(_0x288560){if(pid[_0x288560])pid[_0x288560]['kill']();}function addBot(){const _0x4fa3fe=_0x583a45;let _0xd88a5e;for(let _0x37ea04=0x1;_0x37ea04<0x3e9;_0x37ea04++){_0xd88a5e=_0x37ea04[_0x4fa3fe(0x11a)]()['padStart'](0x3,'0');let _0x2b3407=config[_0x4fa3fe(0x1a2)](_0x2fc0a4=>_0x2fc0a4[_0x4fa3fe(0xfc)]==_0xd88a5e);if(!_0x2b3407)break;}if(_0xd88a5e===_0x4fa3fe(0x21f)){logger[_0x4fa3fe(0xba)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full'](_0x4fa3fe(0x1b7)+_0xd88a5e),dbConfig[_0x4fa3fe(0x272)](_0x4fa3fe(0x22c))['push']({'botID':_0xd88a5e,'botname':_0x4fa3fe(0x1a1)+_0xd88a5e,'status':_0x4fa3fe(0x159),'live':''})[_0x4fa3fe(0xb3)](),startBot([_0xd88a5e,userID],{'cwd':bbpath},function(_0x13b41c){const _0x521033=_0x4fa3fe;if(_0x13b41c)logger[_0x521033(0xba)](_0x13b41c);}),config=getConfiguration(),io['to'](_0x4fa3fe(0x23f))['emit'](_0x4fa3fe(0x22c),config),broadcastToBots(_0x4fa3fe(0x22c),JSON[_0x4fa3fe(0x151)](config));}function deleteBot(_0x26c65b){const _0x569eda=_0x583a45;getClientsWithBotID(_0x26c65b)[_0x569eda(0x19c)](_0x3159f5=>{const _0xa912=_0x569eda;getSocket(_0x3159f5['id'])[_0xa912(0x12b)](!![]),removeClient(_0x3159f5['id']);}),dbConfig['get']('bots')[_0x569eda(0x226)]({'botID':_0x26c65b})[_0x569eda(0xb3)](),logger['full'](_0x569eda(0x13c)+_0x26c65b),stopBot(_0x26c65b);try{if(fs[_0x569eda(0x186)](path[_0x569eda(0x158)](configpath,_0x569eda(0x124)+_0x26c65b+_0x569eda(0xcf))))fs[_0x569eda(0x9e)](path[_0x569eda(0x158)](configpath,_0x569eda(0x124)+_0x26c65b+_0x569eda(0xcf)));if(fs[_0x569eda(0x186)](path[_0x569eda(0x158)](configpath,_0x569eda(0x124)+_0x26c65b+'-events.json')))fs[_0x569eda(0x9e)](path[_0x569eda(0x158)](configpath,'bot-'+_0x26c65b+_0x569eda(0x25c)));if(fs[_0x569eda(0x186)](path[_0x569eda(0x158)](configpath,_0x569eda(0x124)+_0x26c65b+_0x569eda(0xec))))fs[_0x569eda(0x9e)](path[_0x569eda(0x158)](configpath,_0x569eda(0x124)+_0x26c65b+'-performance.json'));if(fs['existsSync'](path[_0x569eda(0x158)](configpath,'bot-'+_0x26c65b+_0x569eda(0x183))))fs[_0x569eda(0x9e)](path[_0x569eda(0x158)](configpath,_0x569eda(0x124)+_0x26c65b+'-results.json'));}catch(_0x346deb){if(_0x346deb)logger[_0x569eda(0xba)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x346deb);}config=getConfiguration(),io['to']('botmanager')[_0x569eda(0xdb)](_0x569eda(0x22c),config),broadcastToBots(_0x569eda(0x22c),JSON['stringify'](config));}function toggleBot(_0x3866e0,_0x2060f5,_0x401f99){const _0x4b99dc=_0x583a45;dbConfig[_0x4b99dc(0x272)]('bots')[_0x4b99dc(0x1a2)]({'botID':_0x3866e0})[_0x4b99dc(0x1f1)]({'status':_0x2060f5})[_0x4b99dc(0x1f1)]({'live':_0x401f99})[_0x4b99dc(0xb3)]();if(_0x2060f5==_0x4b99dc(0x170)||_0x2060f5==_0x4b99dc(0x159))logger[_0x4b99dc(0xba)](_0x4b99dc(0x146)+_0x3866e0),startBot([_0x3866e0,userID],{'cwd':bbpath},function(_0x188bdf){const _0x5488e8=_0x4b99dc;if(_0x188bdf)logger[_0x5488e8(0xba)](_0x188bdf);});else(_0x2060f5==_0x4b99dc(0x290)||_0x2060f5=='new-disabled')&&(logger['full']('Disabled\x20Bot\x20'+_0x3866e0),stopBot(_0x3866e0));config=getConfiguration(),io['to'](_0x4b99dc(0x23f))[_0x4b99dc(0xdb)](_0x4b99dc(0x22c),config),broadcastToBots('bots',JSON[_0x4b99dc(0x151)](config));}function toggleStatus(_0x4be73e){const _0x4bed84=_0x583a45;let _0x4418ee=dbConfig['get'](_0x4bed84(0x22c))[_0x4bed84(0x1a2)]({'botID':_0x4be73e})['value'](),_0x2c3f3a;if(_0x4418ee[_0x4bed84(0x147)]==='enabled')_0x2c3f3a='disabled';else{if(_0x4418ee[_0x4bed84(0x147)]===_0x4bed84(0x159))_0x2c3f3a=_0x4bed84(0x209);else{if(_0x4418ee[_0x4bed84(0x147)]===_0x4bed84(0x209))_0x2c3f3a=_0x4bed84(0x159);else{if(_0x4418ee[_0x4bed84(0x147)]===_0x4bed84(0x290))_0x2c3f3a=_0x4bed84(0x170);}}}return _0x2c3f3a;}function updateStatus(_0x46df50,_0x385f66){const _0x2b8c9f=_0x583a45;dbConfig['get'](_0x2b8c9f(0x22c))[_0x2b8c9f(0x1a2)]({'botID':_0x46df50})[_0x2b8c9f(0x1f1)]({'status':_0x385f66})[_0x2b8c9f(0xb3)](),config=getConfiguration(),io['to']('botmanager')[_0x2b8c9f(0xdb)](_0x2b8c9f(0x22c),config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x139c23,_0x2f8392){const _0x35cc57=_0x583a45;dbConfig[_0x35cc57(0x272)](_0x35cc57(0x22c))['find']({'botID':_0x139c23})[_0x35cc57(0x1f1)]({'live':_0x2f8392})[_0x35cc57(0xb3)](),config=getConfiguration(),io['to'](_0x35cc57(0x23f))[_0x35cc57(0xdb)]('bots',config),broadcastToBots(_0x35cc57(0x22c),JSON['stringify'](config));}function updateBotName(_0x4877f5,_0x52c760){const _0x152e87=_0x583a45;dbConfig[_0x152e87(0x272)](_0x152e87(0x22c))[_0x152e87(0x1a2)]({'botID':_0x4877f5})[_0x152e87(0x1f1)]({'botname':_0x52c760})['write'](),config=getConfiguration(),io['to'](_0x152e87(0x23f))[_0x152e87(0xdb)](_0x152e87(0x22c),config),broadcastToBots('bots',JSON[_0x152e87(0x151)](config));}function updateBotManager(){const _0xbeb0f7=_0x583a45;config=getConfiguration(),io['to']('botmanager')[_0xbeb0f7(0xdb)](_0xbeb0f7(0x22c),config),broadcastToBots(_0xbeb0f7(0x22c),JSON[_0xbeb0f7(0x151)](config));}function toggleBotMode(_0x3bab09){const _0x26e4d1=_0x583a45;if(pid[_0x3bab09])pid[_0x3bab09][_0x26e4d1(0x1e2)]({'function':_0x26e4d1(0xd0),'args':null});else{const _0x4e0f7b=configpath+_0x26e4d1(0x124)+_0x3bab09+'-config.json',_0x1fe0c7=fs['readFileSync'](_0x4e0f7b),_0x3c53d7=JSON[_0x26e4d1(0x13f)](_0x1fe0c7),_0x3ab5c1=_0x3c53d7[_0x26e4d1(0x152)][0x0][_0x26e4d1(0x206)];_0x3c53d7[_0x26e4d1(0x152)][0x0][_0x26e4d1(0x206)]=!_0x3ab5c1;const _0x2679aa=JSON[_0x26e4d1(0x151)](_0x3c53d7,null,0x2);fs[_0x26e4d1(0x1c5)](_0x4e0f7b,_0x2679aa),config=getConfiguration(),io['to'](_0x26e4d1(0x23f))[_0x26e4d1(0xdb)](_0x26e4d1(0x22c),config),broadcastToBots(_0x26e4d1(0x22c),JSON[_0x26e4d1(0x151)](config));}}function validateTelegram(_0x119f8d){const _0x312802=_0x583a45;if(_0x119f8d['from'][_0x312802(0x262)]!=settings[_0x312802(0x24a)]&&'@'+_0x119f8d[_0x312802(0x17b)]['username']!=settings[_0x312802(0x24a)]||_0x119f8d[_0x312802(0x123)]['id']!=settings['telegramChatId'])return sendTelegram(_0x119f8d[_0x312802(0x123)]['id'],_0x312802(0xff),{'parse_mode':_0x312802(0x23a)}),![];return!![];}async function initTelegram(){const _0xfc0a51=_0x583a45;if(tgBot)tgBot[_0xfc0a51(0x242)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0xfc0a51(0x21c)]);let _0x5e45c1=_0xfc0a51(0x1a5);_0x5e45c1+='\x0a',_0x5e45c1+='/enable\x20-\x20enable\x20notifications\x0a',_0x5e45c1+=_0xfc0a51(0xc3),_0x5e45c1+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5e45c1+=_0xfc0a51(0x1b1),_0x5e45c1+=_0xfc0a51(0xc5),_0x5e45c1+=_0xfc0a51(0x200),_0x5e45c1+=_0xfc0a51(0x12a),_0x5e45c1+='/names\x20-\x20show\x20bot\x20names\x0a',_0x5e45c1+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x5e45c1+=_0xfc0a51(0x14f),_0x5e45c1+=_0xfc0a51(0x208),_0x5e45c1+=_0xfc0a51(0xe6),_0x5e45c1+=_0xfc0a51(0x10c),_0x5e45c1+=_0xfc0a51(0x1b8);let _0x145b60='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x145b60+='\x0a',_0x145b60+=_0x5e45c1,tgBot[_0xfc0a51(0x26b)]((_0x2ee39e,_0x118e24)=>{const _0x2e57df=_0xfc0a51;logger[_0x2e57df(0x1f8)](getTimeStamp()+_0x2e57df(0x10a)),logger[_0x2e57df(0x162)](_0x2e57df(0x22d),_0x2ee39e);}),tgBot[_0xfc0a51(0xf6)](async(_0x18c8e6,_0x3e9e48)=>{const _0x556b7d=_0xfc0a51;if(!(!settings[_0x556b7d(0x1ab)]&&_0x18c8e6[_0x556b7d(0x25d)][_0x556b7d(0x283)]['text']=='/start')){if(!validateTelegram(_0x18c8e6))return;}_0x3e9e48();}),tgBot['command']('start',async _0x11bc0a=>{const _0x234063=_0xfc0a51;if(!settings[_0x234063(0x1ab)])updateSetting(_0x234063(0x1ab),_0x11bc0a[_0x234063(0x123)]['id']);updateSetting(_0x234063(0x1d6),!![]);if(!validateTelegram(_0x11bc0a))return;await sendTelegram(_0x11bc0a['chat']['id'],_0x145b60);}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x167),async _0x3a2be6=>{const _0x36490e=_0xfc0a51;updateSetting(_0x36490e(0x1d6),!![]),await sendTelegram(_0x3a2be6[_0x36490e(0x123)]['id'],_0x36490e(0x19f));}),tgBot['command']('disable',async _0x1ac933=>{const _0x66096d=_0xfc0a51;await sendTelegram(_0x1ac933[_0x66096d(0x123)]['id'],_0x66096d(0xdc)),updateSetting(_0x66096d(0x1d6),![]);}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x176),async _0x4d4414=>{const _0x5aa45d=_0xfc0a51,_0x3709e6=Markup[_0x5aa45d(0x288)]([Markup[_0x5aa45d(0x1ca)]['callback'](_0x5aa45d(0x142),_0x5aa45d(0x13a)),Markup[_0x5aa45d(0x1ca)]['callback'](_0x5aa45d(0x164),_0x5aa45d(0x122)),Markup[_0x5aa45d(0x1ca)][_0x5aa45d(0x18b)](_0x5aa45d(0x1c1),'config_all')]);_0x4d4414[_0x5aa45d(0x1df)](_0x5aa45d(0x156),_0x3709e6);}),tgBot['action']('config_orders',async _0x36e251=>{const _0xb42cb7=_0xfc0a51;_0x36e251[_0xb42cb7(0x29c)](),updateSetting(_0xb42cb7(0x105),_0xb42cb7(0x1a9)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x36e251[_0xb42cb7(0x123)]['id'],_0xb42cb7(0x250));}),tgBot[_0xfc0a51(0x24b)](_0xfc0a51(0x122),async _0x29d558=>{const _0x505c55=_0xfc0a51;_0x29d558[_0x505c55(0x29c)](),updateSetting(_0x505c55(0x105),_0x505c55(0x24e)),updateSetting(_0x505c55(0x1d6),!![]),await sendTelegram(_0x29d558[_0x505c55(0x123)]['id'],_0x505c55(0x1db));}),tgBot[_0xfc0a51(0x24b)](_0xfc0a51(0xd9),async _0x1a4fda=>{const _0x196472=_0xfc0a51;_0x1a4fda[_0x196472(0x29c)](),updateSetting(_0x196472(0x105),'all'),updateSetting(_0x196472(0x1d6),!![]),await sendTelegram(_0x1a4fda['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x147),async _0x59e930=>{const _0x94090b=_0xfc0a51,_0x5b7df7=getBotsWithMode();let _0x27ef23='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x94090b(0x19c)](_0x1b81b0=>{const _0x521c0d=_0x94090b,_0x8cc821=_0x5b7df7['find'](_0x46130a=>_0x46130a[_0x521c0d(0xfc)]==_0x1b81b0['botID'])['mode'];_0x27ef23+='Bot\x20'+_0x1b81b0[_0x521c0d(0xfc)]+':\x20'+_0x1b81b0[_0x521c0d(0x147)]+_0x521c0d(0x279)+_0x8cc821+_0x521c0d(0x279)+_0x1b81b0[_0x521c0d(0x284)]+'\x0a';}),_0x27ef23+='\x0a',_0x27ef23+=_0x94090b(0x1f9),_0x27ef23+=!settings[_0x94090b(0x1d6)]?_0x94090b(0x1d2):'Notifications\x20enabled\x0a',_0x27ef23+=settings['telegramEnabled']?settings[_0x94090b(0x105)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x94090b(0x105)]+_0x94090b(0x22a):'',await sendTelegram(_0x59e930[_0x94090b(0x123)]['id'],_0x27ef23,{'parse_mode':_0x94090b(0x23a)});}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x22b),async _0xb55cc7=>{const _0x460dea=_0xfc0a51,_0x2bf7e0=getEnabledBots();if(_0x2bf7e0[_0x460dea(0x201)]==0x0)await sendTelegram(_0xb55cc7[_0x460dea(0x123)]['id'],_0x460dea(0x109));else{if(_0x2bf7e0[_0x460dea(0x201)]>0x1)_0x2bf7e0['push']({'botID':_0x460dea(0x182)});let _0x3207f0=[],_0xaad0e0=[];const _0x456e86=_0x2bf7e0[_0x460dea(0x201)]%0x4==0x0||_0x2bf7e0[_0x460dea(0x201)]%0x4==0x3||_0x2bf7e0[_0x460dea(0x201)]%0x3==0x1?0x4:0x3;let _0x466d31=0x0;_0x2bf7e0[_0x460dea(0x19c)]((_0x2d1628,_0x3e9eca)=>{const _0xc1d51d=_0x460dea;if(_0x3e9eca%_0x456e86==0x0)_0xaad0e0=[];_0xaad0e0[_0xc1d51d(0xa5)](Markup[_0xc1d51d(0x1ca)][_0xc1d51d(0x18b)](_0x2d1628[_0xc1d51d(0xfc)]=='all'?'All\x20bots':_0xc1d51d(0x1a1)+_0x2d1628[_0xc1d51d(0xfc)],_0xc1d51d(0xf4)+_0x2d1628[_0xc1d51d(0xfc)])),_0x3e9eca%_0x456e86==0x0&&(_0x3207f0[_0x466d31]=_0xaad0e0,_0x466d31++);});const _0x2424af=Markup[_0x460dea(0x288)](_0x3207f0);_0xb55cc7['reply'](_0x460dea(0x258),_0x2424af);}}),tgBot[_0xfc0a51(0x24b)](/restart_(.+)/,async _0x2e1af3=>{const _0x263da4=_0xfc0a51,_0x428d8f=_0x2e1af3[_0x263da4(0xb4)][0x1];_0x2e1af3['editMessageReplyMarkup'](),_0x428d8f==_0x263da4(0x182)?config[_0x263da4(0x19c)](_0x485152=>{const _0x243887=_0x263da4;restartBot(_0x485152[_0x243887(0xfc)]);}):restartBot(_0x428d8f);}),tgBot[_0xfc0a51(0x196)]('on',async _0x14851f=>{const _0x2bf34=_0xfc0a51,_0x1e9f2b=getDisabledBots();if(_0x1e9f2b[_0x2bf34(0x201)]==0x0)await sendTelegram(_0x14851f['chat']['id'],_0x2bf34(0xeb));else{if(_0x1e9f2b[_0x2bf34(0x201)]>0x1)_0x1e9f2b[_0x2bf34(0xa5)]({'botID':_0x2bf34(0x182)});let _0x3c45ce=[],_0x4403d2=[];const _0x3126e8=_0x1e9f2b['length']%0x4==0x0||_0x1e9f2b[_0x2bf34(0x201)]%0x4==0x3||_0x1e9f2b[_0x2bf34(0x201)]%0x3==0x1?0x4:0x3;let _0xac54d5=0x0;_0x1e9f2b[_0x2bf34(0x19c)]((_0xd680c7,_0x3e9743)=>{const _0x29f7dc=_0x2bf34;if(_0x3e9743%_0x3126e8==0x0)_0x4403d2=[];_0x4403d2['push'](Markup[_0x29f7dc(0x1ca)][_0x29f7dc(0x18b)](_0xd680c7['botID']=='all'?_0x29f7dc(0xd1):_0x29f7dc(0x1a1)+_0xd680c7[_0x29f7dc(0xfc)],_0x29f7dc(0x1a3)+_0xd680c7[_0x29f7dc(0xfc)])),_0x3e9743%_0x3126e8==0x0&&(_0x3c45ce[_0xac54d5]=_0x4403d2,_0xac54d5++);});const _0x1bfd88=Markup[_0x2bf34(0x288)](_0x3c45ce);_0x14851f['reply'](_0x2bf34(0x1d5),_0x1bfd88);}}),tgBot[_0xfc0a51(0x24b)](/on_(.+)/,async _0x2471f6=>{const _0x46e1f8=_0xfc0a51,_0x3fa399=_0x2471f6[_0x46e1f8(0xb4)][0x1];_0x2471f6[_0x46e1f8(0x29c)]();if(_0x3fa399==_0x46e1f8(0x182)){const _0x329cd1=getDisabledBots();await sendTelegram(_0x2471f6['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x329cd1['forEach'](_0x44d5c9=>{const _0x5c923f=_0x46e1f8;if(_0x44d5c9[_0x5c923f(0xfc)]!=_0x5c923f(0x182))toggleBot(_0x44d5c9[_0x5c923f(0xfc)],toggleStatus(_0x44d5c9[_0x5c923f(0xfc)]),_0x5c923f(0x227));});}else await sendTelegram(_0x2471f6[_0x46e1f8(0x123)]['id'],_0x46e1f8(0x236)+_0x3fa399),toggleBot(_0x3fa399,toggleStatus(_0x3fa399),_0x46e1f8(0x227));}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x1ce),async _0x5c9ae2=>{const _0x2be849=_0xfc0a51,_0x5e22e1=getEnabledBots();if(_0x5e22e1[_0x2be849(0x201)]==0x0)await sendTelegram(_0x5c9ae2[_0x2be849(0x123)]['id'],_0x2be849(0x109));else{if(_0x5e22e1[_0x2be849(0x201)]>0x1)_0x5e22e1[_0x2be849(0xa5)]({'botID':'all'});let _0x1962a0=[],_0x188798=[];const _0x2b0e4b=_0x5e22e1[_0x2be849(0x201)]%0x4==0x0||_0x5e22e1[_0x2be849(0x201)]%0x4==0x3||_0x5e22e1[_0x2be849(0x201)]%0x3==0x1?0x4:0x3;let _0x252d66=0x0;_0x5e22e1[_0x2be849(0x19c)]((_0x5d4d00,_0x2d44e7)=>{const _0x58b570=_0x2be849;if(_0x2d44e7%_0x2b0e4b==0x0)_0x188798=[];_0x188798[_0x58b570(0xa5)](Markup['button'][_0x58b570(0x18b)](_0x5d4d00[_0x58b570(0xfc)]==_0x58b570(0x182)?_0x58b570(0xd1):_0x58b570(0x1a1)+_0x5d4d00[_0x58b570(0xfc)],_0x58b570(0x11d)+_0x5d4d00['botID'])),_0x2d44e7%_0x2b0e4b==0x0&&(_0x1962a0[_0x252d66]=_0x188798,_0x252d66++);});const _0x1dc7ac=Markup[_0x2be849(0x288)](_0x1962a0);_0x5c9ae2[_0x2be849(0x1df)](_0x2be849(0x26f),_0x1dc7ac);}}),tgBot[_0xfc0a51(0x24b)](/off_(.+)/,async _0x5829c1=>{const _0xb314be=_0xfc0a51,_0x10306a=_0x5829c1[_0xb314be(0xb4)][0x1];_0x5829c1[_0xb314be(0x29c)]();if(_0x10306a==_0xb314be(0x182)){const _0x318f89=getEnabledBots();await sendTelegram(_0x5829c1[_0xb314be(0x123)]['id'],_0xb314be(0xef)),_0x318f89[_0xb314be(0x19c)](_0x43f2be=>{const _0x421e01=_0xb314be;if(_0x43f2be[_0x421e01(0xfc)]!='all')toggleBot(_0x43f2be[_0x421e01(0xfc)],toggleStatus(_0x43f2be[_0x421e01(0xfc)]),'stopped');});}else await sendTelegram(_0x5829c1[_0xb314be(0x123)]['id'],_0xb314be(0xf8)+_0x10306a),toggleBot(_0x10306a,toggleStatus(_0x10306a),_0xb314be(0x227));}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x118),async _0x1996be=>{const _0x4c1a5f=_0xfc0a51,_0x513592=getEnabledBots();if(_0x513592[_0x4c1a5f(0x201)]==0x0)await sendTelegram(_0x1996be[_0x4c1a5f(0x123)]['id'],_0x4c1a5f(0x109));else{if(_0x513592[_0x4c1a5f(0x201)]>0x1){let _0x387e6f=[],_0x286e7e=[];const _0xa18600=_0x513592[_0x4c1a5f(0x201)]%0x4==0x0||_0x513592['length']%0x4==0x3||_0x513592[_0x4c1a5f(0x201)]%0x3==0x1?0x4:0x3;let _0x2e3bed=0x0;_0x513592['forEach']((_0x49536d,_0x150982)=>{const _0x462651=_0x4c1a5f;if(_0x150982%_0xa18600==0x0)_0x286e7e=[];_0x286e7e[_0x462651(0xa5)](Markup[_0x462651(0x1ca)][_0x462651(0x18b)]('Bot\x20'+_0x49536d[_0x462651(0xfc)],_0x462651(0x29a)+_0x49536d['botID'])),_0x150982%_0xa18600==0x0&&(_0x387e6f[_0x2e3bed]=_0x286e7e,_0x2e3bed++);});const _0x38478b=Markup[_0x4c1a5f(0x288)](_0x387e6f);_0x1996be['reply'](_0x4c1a5f(0xfb),_0x38478b);}else{const _0x47fd63=_0x513592[0x0][_0x4c1a5f(0xfc)];if(pid[_0x47fd63])pid[_0x47fd63][_0x4c1a5f(0x1e2)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0xfc0a51(0x24b)](/metrics_(.+)/,async _0x18e5b0=>{const _0xac0979=_0xfc0a51,_0x2492e3=_0x18e5b0[_0xac0979(0xb4)][0x1];_0x18e5b0['editMessageReplyMarkup']();if(pid[_0x2492e3])pid[_0x2492e3][_0xac0979(0x1e2)]({'function':_0xac0979(0x1d3),'args':null});}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x145),async _0x154ba4=>{const _0x18d4f9=_0xfc0a51,_0x31e5ca=getEnabledBots();if(_0x31e5ca[_0x18d4f9(0x201)]==0x0)await sendTelegram(_0x154ba4['chat']['id'],_0x18d4f9(0x109));else{if(_0x31e5ca[_0x18d4f9(0x201)]>0x1){let _0x30a19f=[],_0x504cb5=[];const _0x10b7f4=_0x31e5ca[_0x18d4f9(0x201)]%0x4==0x0||_0x31e5ca[_0x18d4f9(0x201)]%0x4==0x3||_0x31e5ca[_0x18d4f9(0x201)]%0x3==0x1?0x4:0x3;let _0x1ccd5c=0x0;_0x31e5ca[_0x18d4f9(0x19c)]((_0x119e03,_0x194004)=>{const _0x2056a9=_0x18d4f9;if(_0x194004%_0x10b7f4==0x0)_0x504cb5=[];_0x504cb5[_0x2056a9(0xa5)](Markup[_0x2056a9(0x1ca)]['callback'](_0x2056a9(0x1a1)+_0x119e03[_0x2056a9(0xfc)],_0x2056a9(0x27f)+_0x119e03[_0x2056a9(0xfc)])),_0x194004%_0x10b7f4==0x0&&(_0x30a19f[_0x1ccd5c]=_0x504cb5,_0x1ccd5c++);});const _0x1f8add=Markup['inlineKeyboard'](_0x30a19f);_0x154ba4['reply'](_0x18d4f9(0x17f),_0x1f8add);}else{const _0x5a87ae=_0x31e5ca[0x0][_0x18d4f9(0xfc)];if(pid[_0x5a87ae])pid[_0x5a87ae]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0xfc0a51(0x24b)](/portfolio_(.+)/,async _0x7bf057=>{const _0x2396d3=_0xfc0a51,_0x19d4d8=_0x7bf057[_0x2396d3(0xb4)][0x1];_0x7bf057['editMessageReplyMarkup']();if(pid[_0x19d4d8])pid[_0x19d4d8][_0x2396d3(0x1e2)]({'function':_0x2396d3(0x202),'args':null});}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x25d),async _0x3f3d38=>{const _0x4f4543=_0xfc0a51;await getMessages();if(!updateAvailable)await sendTelegram(_0x3f3d38[_0x4f4543(0x123)]['id'],_0x4f4543(0x1ff));else{if(!validInstallation)await sendTelegram(_0x3f3d38[_0x4f4543(0x123)]['id'],_0x4f4543(0x193));else{const _0x4b13c2=Markup[_0x4f4543(0x288)]([Markup[_0x4f4543(0x1ca)][_0x4f4543(0x18b)](_0x4f4543(0xe8),_0x4f4543(0x1cd)),Markup[_0x4f4543(0x1ca)][_0x4f4543(0x18b)]('No','update_no')]);_0x3f3d38[_0x4f4543(0x1df)](_0x4f4543(0x289),_0x4b13c2);}}}),tgBot[_0xfc0a51(0x24b)](/update_(.+)/,async _0x656dc=>{const _0x26be01=_0xfc0a51,_0x3e34b3=_0x656dc[_0x26be01(0xb4)][0x1];_0x656dc['editMessageReplyMarkup'](),_0x3e34b3==_0x26be01(0x229)&&(await sendTelegram(_0x656dc[_0x26be01(0x123)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB('update')),_0x3e34b3=='no'&&await sendTelegram(_0x656dc['chat']['id'],_0x26be01(0xbd));}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0xb2),async _0x21850a=>{const _0x2f85d0=_0xfc0a51;if(!validInstallation)await sendTelegram(_0x21850a[_0x2f85d0(0x123)]['id'],_0x2f85d0(0x267));else{const _0x5caa5d=Markup[_0x2f85d0(0x288)]([Markup[_0x2f85d0(0x1ca)][_0x2f85d0(0x18b)](_0x2f85d0(0xe8),_0x2f85d0(0xcc)),Markup['button'][_0x2f85d0(0x18b)]('No',_0x2f85d0(0xc6))]);_0x21850a[_0x2f85d0(0x1df)](_0x2f85d0(0x12d),_0x5caa5d);}}),tgBot[_0xfc0a51(0x24b)](/reinstall_(.+)/,async _0x53aabb=>{const _0x1e90e6=_0xfc0a51,_0x2d4c5c=_0x53aabb[_0x1e90e6(0xb4)][0x1];_0x53aabb[_0x1e90e6(0x29c)](),_0x2d4c5c==_0x1e90e6(0x229)&&(await sendTelegram(_0x53aabb[_0x1e90e6(0x123)]['id'],_0x1e90e6(0x224)),updateBB(_0x1e90e6(0xb2))),_0x2d4c5c=='no'&&await sendTelegram(_0x53aabb[_0x1e90e6(0x123)]['id'],_0x1e90e6(0x153));}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x293),async _0x2d3f72=>{const _0x28478f=_0xfc0a51,_0x2a6331=getBotsWithMode();if(_0x2a6331['length']==0x0)await sendTelegram(_0x2d3f72[_0x28478f(0x123)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x13ce38=[],_0x4e6f7d=[];const _0x285c49=0x2;let _0x36eed9=0x0;_0x2a6331['forEach']((_0x291997,_0x10bc7a)=>{const _0xfbb8dd=_0x28478f;if(_0x10bc7a%_0x285c49==0x0)_0x4e6f7d=[];_0x4e6f7d['push'](Markup[_0xfbb8dd(0x1ca)][_0xfbb8dd(0x18b)]('Bot\x20'+_0x291997[_0xfbb8dd(0xfc)]+'\x20('+_0x291997[_0xfbb8dd(0x1ba)]+')',_0xfbb8dd(0x1da)+_0x291997['botID'])),_0x10bc7a%_0x285c49==0x0&&(_0x13ce38[_0x36eed9]=_0x4e6f7d,_0x36eed9++);});const _0x118b7b=Markup[_0x28478f(0x288)](_0x13ce38);_0x2d3f72[_0x28478f(0x1df)](_0x28478f(0x22f),_0x118b7b);}}),tgBot[_0xfc0a51(0x24b)](/toggle_(.+)/,async _0x53a227=>{const _0x2edadf=_0xfc0a51,_0x2e4306=_0x53a227['match'][0x1];_0x53a227[_0x2edadf(0x29c)]();const _0x495f31=getBotsWithMode(),_0x55e199=_0x495f31['find'](_0x3bdb37=>_0x3bdb37[_0x2edadf(0xfc)]==_0x2e4306),_0x1e623c=_0x55e199[_0x2edadf(0x1ba)]==_0x2edadf(0x134)?_0x2edadf(0x1ef):_0x2edadf(0x134);await sendTelegram(_0x53a227[_0x2edadf(0x123)]['id'],_0x2edadf(0x178)+_0x2e4306+_0x2edadf(0x1e7)+_0x1e623c+_0x2edadf(0x256)),toggleBotMode(_0x2e4306);}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x28d),async _0x3a93f4=>{const _0x93163b=_0xfc0a51;let _0x2acbf4='';config[_0x93163b(0x19c)](_0x1a6d27=>{const _0x4d56a9=_0x93163b;_0x2acbf4+=_0x4d56a9(0x1a1)+_0x1a6d27['botID']+':\x20'+_0x1a6d27['botname']+'\x0a';}),await sendTelegram(_0x3a93f4['chat']['id'],_0x2acbf4,{'parse_mode':_0x93163b(0x23a)});}),tgBot[_0xfc0a51(0x196)](_0xfc0a51(0x1ee),async _0x9955bb=>{const _0x2b9039=_0xfc0a51;await sendTelegram(_0x9955bb[_0x2b9039(0x123)]['id'],_0x5e45c1);}),process[_0xfc0a51(0x1b2)](_0xfc0a51(0x11b),()=>tgBot['stop'](_0xfc0a51(0x11b))),process[_0xfc0a51(0x1b2)](_0xfc0a51(0x25e),()=>tgBot[_0xfc0a51(0x242)](_0xfc0a51(0x25e))),tgBot[_0xfc0a51(0x13d)]();}}function disableTelegram(){const _0x1dae47=_0x583a45;tgBot&&tgBot[_0x1dae47(0x242)]();}async function sendTelegram(_0xb61f99,_0x1998c1,_0x30bfb9){const _0x504ca5=_0x583a45;try{await tgBot['telegram'][_0x504ca5(0x110)](_0xb61f99,_0x1998c1,_0x30bfb9);}catch(_0x3490ec){console[_0x504ca5(0xf5)](_0x504ca5(0x197),_0x3490ec);}}async function sendTelegramBot(_0x29150f,_0x202ebe){const _0x532e23=_0x583a45;if(settings[_0x532e23(0x1d6)]){if(settings[_0x532e23(0x105)]==_0x532e23(0x182)||(_0x202ebe[_0x532e23(0x114)]==_0x532e23(0x210)||_0x202ebe['type']==_0x532e23(0xa1)||_0x202ebe['type']==_0x532e23(0x107))&&settings[_0x532e23(0x105)]==_0x532e23(0x24e)||_0x202ebe[_0x532e23(0x114)]=='order'&&settings[_0x532e23(0x105)]=='orders'){if(tgBot&&settings[_0x532e23(0x1ab)]){if(_0x202ebe['showname'])await sendTelegram(settings[_0x532e23(0x1ab)],_0x202ebe[_0x532e23(0x1a6)]+_0x532e23(0x1bb)+_0x202ebe['event']);else await sendTelegram(settings[_0x532e23(0x1ab)],_0x532e23(0x1a1)+_0x29150f+_0x532e23(0x1bb)+_0x202ebe[_0x532e23(0x1fc)]);}}}}async function sendTelegramMsg(_0xf6dcf5,_0x37063d=_0x583a45(0x23a)){const _0x5e1deb=_0x583a45;return settings[_0x5e1deb(0x1d6)]&&tgBot&&settings[_0x5e1deb(0x1ab)]?(await sendTelegram(settings[_0x5e1deb(0x1ab)],_0xf6dcf5,{'parse_mode':_0x37063d}),!![]):![];}function _0x2cfb(_0x1598b,_0x4b6ff2){const _0x1a9be4=_0x22cf();return _0x2cfb=function(_0x50ab97,_0x640969){_0x50ab97=_0x50ab97-0x9b;let _0x22cf3e=_0x1a9be4[_0x50ab97];return _0x22cf3e;},_0x2cfb(_0x1598b,_0x4b6ff2);}function getDeviceWithIp(_0x4fc50a){const _0x4b4648=_0x583a45;return devices[_0x4b4648(0x1a2)](_0x1a6ca0=>_0x1a6ca0['ip']===_0x4fc50a);}async function temporaryAccess2FA(_0x42ec2b,_0x2f2e43){const _0x3aa2f7=_0x583a45;let _0x2faf6f=new Date(),_0x2535d6=![];if(lastIpApproval){if(_0x2faf6f-lastIpApproval<0x1388)_0x2535d6=!![];}lastIpApproval=new Date();if(_0x2535d6)return;if(tgBot&&settings[_0x3aa2f7(0x1ab)]){const _0x57c85d=uuidRandom();tmpStorage[_0x57c85d]={'uuid':_0x42ec2b,'externalip':_0x2f2e43};const _0x4bc67b=Markup[_0x3aa2f7(0x288)]([Markup[_0x3aa2f7(0x1ca)]['callback'](_0x3aa2f7(0x1af),_0x3aa2f7(0x28a)+_0x57c85d),Markup['button'][_0x3aa2f7(0x18b)](_0x3aa2f7(0x285),_0x3aa2f7(0x1c9)+_0x57c85d),Markup[_0x3aa2f7(0x1ca)][_0x3aa2f7(0x18b)]('30\x20min',_0x3aa2f7(0xbc)+_0x57c85d),Markup['button'][_0x3aa2f7(0x18b)]('reject',_0x3aa2f7(0x137)+_0x57c85d)]);await sendTelegram(settings[_0x3aa2f7(0x1ab)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x2f2e43)['show']+'\x20?',_0x4bc67b),tgBot[_0x3aa2f7(0x24b)](/tempaccess_(.+)_(.+)/,async _0x3a42ed=>{const _0x2d3e24=_0x3aa2f7,_0x1970d6=_0x3a42ed[_0x2d3e24(0xb4)][0x1],_0x72d1b6=_0x3a42ed[_0x2d3e24(0xb4)][0x2],{uuid:_0x2b99fc,externalip:_0xf6fc7e}=tmpStorage[_0x72d1b6];delete tmpStorage[_0x72d1b6],_0x3a42ed[_0x2d3e24(0x29c)](),devices[_0x2b99fc]['telegramIpApproval']={'clientip':_0xf6fc7e,'timestamp':new Date()[_0x2d3e24(0x27c)](),'expiry':_0x1970d6},_0x1970d6!=_0x2d3e24(0xd6)?(await sendTelegram(_0x3a42ed[_0x2d3e24(0x123)]['id'],'Access\x20enabled\x20for\x20'+_0x1970d6+_0x2d3e24(0x238),{'parse_mode':_0x2d3e24(0x23a)}),io['to'](_0x2b99fc)[_0x2d3e24(0xdb)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x3a42ed[_0x2d3e24(0x123)]['id'],_0x2d3e24(0x144)),io['to'](_0x2b99fc)['emit'](_0x2d3e24(0x147),{'access':{'allow':![],'reason':_0x2d3e24(0x231),'token':null}}));});}}async function loginAccess2FA(_0x44828a,_0x433689){const _0x122641=_0x583a45;if(tgBot&&settings['telegramChatId']){const _0x3c5014=uuidRandom();tmpStorage[_0x3c5014]={'uuid':_0x44828a,'externalip':_0x433689};const _0x5cb742=Markup['inlineKeyboard']([Markup[_0x122641(0x1ca)][_0x122641(0x18b)](_0x122641(0x111),_0x122641(0x212)+loginExpiry+'_'+_0x3c5014),Markup['button']['callback'](_0x122641(0xd6),_0x122641(0x25f)+_0x3c5014)]);await sendTelegram(settings[_0x122641(0x1ab)],_0x122641(0x13b)+normalizeIP(_0x433689)[_0x122641(0x136)]+'\x20?',_0x5cb742),tgBot[_0x122641(0x24b)](/login2fa_(.+)_(.+)/,async _0x4e9f40=>{const _0x2db015=_0x122641,_0x16abe3=_0x4e9f40['match'][0x1],_0x5006af=_0x4e9f40[_0x2db015(0xb4)][0x2],{uuid:_0x308695,externalip:_0x241a51}=tmpStorage[_0x5006af];delete tmpStorage[_0x5006af],_0x4e9f40['editMessageReplyMarkup'](),devices[_0x308695]['telegram2FaApproval']={'clientip':_0x241a51,'timestamp':new Date()[_0x2db015(0x27c)](),'expiry':_0x16abe3},_0x16abe3!=_0x2db015(0xd6)?(await sendTelegram(_0x4e9f40[_0x2db015(0x123)]['id'],_0x2db015(0x1b6),{'parse_mode':_0x2db015(0x23a)}),io['to'](_0x308695)[_0x2db015(0xdb)](_0x2db015(0x147),{'access':{'allow':![],'reason':_0x2db015(0x255),'token':null}})):(await sendTelegram(_0x4e9f40[_0x2db015(0x123)]['id'],'Login\x20rejected'),io['to'](_0x308695)[_0x2db015(0xdb)](_0x2db015(0x147),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xffeca1=_0x583a45;return dbConfig[_0xffeca1(0x272)](_0xffeca1(0x22c))[_0xffeca1(0xa3)](_0xffeca1(0xfc))[_0xffeca1(0x16b)]({'status':'enabled'})[_0xffeca1(0x19d)]()||[];}function getDisabledBots(){const _0x2df6c4=_0x583a45;return dbConfig[_0x2df6c4(0x272)](_0x2df6c4(0x22c))[_0x2df6c4(0xa3)](_0x2df6c4(0xfc))['filter']({'status':'disabled'})[_0x2df6c4(0x19d)]()||[];}function getBotAttributes(_0x70c518){const _0x476937=_0x583a45;let _0x59c72b={};const _0x464fde=configpath+_0x476937(0x124)+_0x70c518+_0x476937(0xcf),_0x5e6633=fs['existsSync'](_0x464fde);if(_0x5e6633){const _0x443ff4=fs[_0x476937(0x26a)](_0x464fde);try{const _0x483509=JSON[_0x476937(0x13f)](_0x443ff4),_0x4ff7ac=_0x483509?_0x483509[_0x476937(0x152)][0x0][_0x476937(0x206)]:![];_0x59c72b[_0x476937(0x1ba)]=_0x4ff7ac?_0x476937(0x134):'manual',_0x59c72b[_0x476937(0x1a6)]=_0x483509?_0x483509[_0x476937(0x152)][0x0][_0x476937(0x1a6)]:_0x476937(0x1a1)+_0x70c518;}catch(_0x591d8a){_0x59c72b[_0x476937(0x1ba)]=_0x476937(0x1ef),_0x59c72b[_0x476937(0x1a6)]='Bot\x20'+_0x70c518;}}else _0x59c72b[_0x476937(0x1ba)]=_0x476937(0x1ef),_0x59c72b[_0x476937(0x1a6)]=_0x476937(0x1a1)+_0x70c518;return _0x59c72b;}function getBotsWithMode(){const _0x46b760=_0x583a45,_0x1baf09=dbConfig[_0x46b760(0x272)]('bots')[_0x46b760(0xa3)](_0x46b760(0xfc))[_0x46b760(0x19d)]()||[];return _0x1baf09['forEach'](_0x2b7e3f=>{const _0x2872d3=_0x46b760;let _0x3155b6=getBotAttributes(_0x2b7e3f[_0x2872d3(0xfc)]);_0x2b7e3f['mode']=_0x3155b6[_0x2872d3(0x1ba)];}),_0x1baf09;}function getBotExchanges(){const _0x23f87a=_0x583a45;let _0x30886e=[];const _0x142f79=dbConfig['get'](_0x23f87a(0x22c))[_0x23f87a(0xa3)](_0x23f87a(0xfc))[_0x23f87a(0x19d)]()||[];_0x142f79[_0x23f87a(0x19c)](_0x4060d6=>{const _0x4d7160=_0x23f87a;if(_0x4060d6[_0x4d7160(0x147)]==_0x4d7160(0x170)){const _0x26e8c0=configpath+_0x4d7160(0x124)+_0x4060d6[_0x4d7160(0xfc)]+'-config.json',_0x5682ba=fs[_0x4d7160(0x186)](_0x26e8c0);let _0x19f7b9;if(_0x5682ba){const _0x550d2b=fs[_0x4d7160(0x26a)](_0x26e8c0);try{const _0x95a47c=JSON[_0x4d7160(0x13f)](_0x550d2b);_0x19f7b9=_0x95a47c?_0x95a47c[_0x4d7160(0x152)][0x0][_0x4d7160(0x1ec)]:null;}catch(_0x4718f9){}}if(_0x19f7b9)_0x30886e[_0x4d7160(0xa5)](_0x19f7b9);}});const _0x1832f1=[...new Set(_0x30886e)][_0x23f87a(0x138)]();return _0x1832f1;}async function initUser(){const _0x1fa29e=_0x583a45;if(!settings[_0x1fa29e(0x282)]){const _0x1d744d=uuidRandom();mixpanel['alias'](_0x1d744d),updateSetting(_0x1fa29e(0x282),_0x1d744d);}}async function initSecure(){const _0x431bd2=_0x583a45;let _0x54e396=getSecure();if(!_0x54e396[_0x431bd2(0x1aa)](_0x431bd2(0x17a))){let _0x452a76=await generateKeys();_0x54e396[_0x431bd2(0x1bf)]=_0x452a76[_0x431bd2(0x1bf)],_0x54e396[_0x431bd2(0x277)]=_0x452a76[_0x431bd2(0x277)],_0x54e396[_0x431bd2(0x17a)]=crypto['randomBytes'](0x20)[_0x431bd2(0x11a)](_0x431bd2(0x274));;storeSecure(_0x54e396);}}function getSettings(){const _0x301917=_0x583a45;return dbSettings[_0x301917(0x272)]('settings')[_0x301917(0x19d)]()||{};}function getSecure(){const _0xe5c874=_0x583a45;return dbSecure[_0xe5c874(0x272)](_0xe5c874(0x18a))[_0xe5c874(0x19d)]()||{};}function getBlacklist(){const _0x25b5fd=_0x583a45;return dbSecure[_0x25b5fd(0x272)](_0x25b5fd(0xa6))[_0x25b5fd(0x19d)]()||[];}function broadcastToBots(_0x1d8a94,_0x56ca9a){const _0x474392=_0x583a45;config[_0x474392(0x19c)](_0x19842b=>{const _0x2f40b2=_0x474392;if(_0x19842b[_0x2f40b2(0x147)]==_0x2f40b2(0x170)&&_0x19842b[_0x2f40b2(0x284)]=='running'||_0x19842b[_0x2f40b2(0x147)]==_0x2f40b2(0x159)&&_0x19842b[_0x2f40b2(0x284)]==_0x2f40b2(0xa0)){if(pid[_0x19842b[_0x2f40b2(0xfc)]])pid[_0x19842b['botID']][_0x2f40b2(0x1e2)]({[_0x1d8a94]:_0x56ca9a});}});}function storeSettings(_0x4cefb1,_0x32a0bf=![]){const _0x2547a0=_0x583a45;_0x4cefb1={...settings,..._0x4cefb1};if(_0x32a0bf&&_0x4cefb1[_0x2547a0(0x163)]!='************'&&_0x4cefb1['bbPassword']!=_0x2547a0(0x216)&&_0x4cefb1[_0x2547a0(0x163)]!=''){const _0x59aada=crypt['decrypt'](secure[_0x2547a0(0x277)],_0x4cefb1[_0x2547a0(0x163)])[_0x2547a0(0x283)][_0x2547a0(0xb6)]('@')[0x0],_0x59fe35=bcrypt[_0x2547a0(0x22e)](_0x59aada,saltRounds);_0x4cefb1={..._0x4cefb1,'bbPassword':_0x59fe35};}if(_0x32a0bf&&_0x4cefb1['telegramToken']!=_0x2547a0(0x127)&&_0x4cefb1['telegramToken']!='***'&&_0x4cefb1[_0x2547a0(0x21c)]!=''){const _0x429692=crypt[_0x2547a0(0x157)](secure['privateKey'],_0x4cefb1[_0x2547a0(0x21c)])[_0x2547a0(0x283)][_0x2547a0(0xb6)]('@')[0x0];_0x4cefb1={..._0x4cefb1,'telegramToken':_0x429692};}const _0x5ab047=_0x4cefb1[_0x2547a0(0x21c)]!='************'&&_0x4cefb1['telegramToken']!=settings['telegramToken']||_0x4cefb1[_0x2547a0(0x24a)]!=settings[_0x2547a0(0x24a)],_0x11a432=_0x4cefb1['telegramToken']==''||_0x4cefb1[_0x2547a0(0x24a)]=='';_0x5ab047&&(_0x4cefb1['telegramChatId']=null,_0x4cefb1[_0x2547a0(0x105)]=_0x2547a0(0x182));for(const [_0x573f70,_0x386dbd]of Object[_0x2547a0(0x244)](_0x4cefb1)){if(_0x573f70=='telegramToken'&&_0x386dbd==_0x2547a0(0x127)){_0x4cefb1[_0x2547a0(0x21c)]=settings[_0x2547a0(0x21c)];continue;};if(_0x573f70==_0x2547a0(0x163)&&_0x386dbd=='************'){_0x4cefb1[_0x2547a0(0x163)]=settings['bbPassword'];continue;};dbSettings[_0x2547a0(0x27b)](_0x2547a0(0x24d)+_0x573f70,_0x386dbd)[_0x2547a0(0xb3)]();}settings=_0x4cefb1,io['to'](_0x2547a0(0x23f))[_0x2547a0(0xdb)](_0x2547a0(0x252),cleanSettings()),broadcastToBots('timeshift',settings[_0x2547a0(0x235)]),broadcastToBots('onepagemode',settings[_0x2547a0(0x198)]);if(_0x5ab047&&!_0x11a432)initTelegram();if(_0x5ab047&&_0x11a432)disableTelegram();getAllClients()[_0x2547a0(0x19c)](_0x47d258=>{const _0x17254e=_0x2547a0;getSocket(_0x47d258['id'])['emit']('status',{'access':{'allow':![],'reason':_0x17254e(0x255),'token':null}});});}function updateSetting(_0x772c50,_0x3e8835){const _0x186b39=_0x583a45;dbSettings['set'](_0x186b39(0x24d)+_0x772c50,_0x3e8835)['write'](),settings=getSettings(),io['to'](_0x186b39(0x23f))[_0x186b39(0xdb)]('settings',cleanSettings());}function storeSecure(_0x5d846c){const _0x3c5644=_0x583a45;dbSecure['get'](_0x3c5644(0x18a))[_0x3c5644(0xa5)](_0x5d846c)[_0x3c5644(0xb3)](),secure=_0x5d846c;}function addBlacklist(_0x132b63){const _0x56447f=_0x583a45;cleanBlacklist();let _0x5e5312;devices[_0x132b63]['telegramIpApproval']?_0x5e5312=Math[_0x56447f(0xc2)](devices[_0x132b63][_0x56447f(0x1c2)][_0x56447f(0xf3)],loginExpiry):_0x5e5312=loginExpiry,dbSecure[_0x56447f(0x272)](_0x56447f(0xa6))['push']({'expiry':new Date()[_0x56447f(0x27c)]()+_0x5e5312*0x3c*0x3e8,'token':devices[_0x132b63]['access'][_0x56447f(0x104)]})['write'](),blacklist=dbSecure[_0x56447f(0x272)](_0x56447f(0xa6))[_0x56447f(0x19d)]();}function cleanBlacklist(){const _0x2122d3=_0x583a45;let _0x18434c=dbSecure[_0x2122d3(0x272)](_0x2122d3(0xa6))[_0x2122d3(0x16a)]()[_0x2122d3(0x19d)](),_0x23e10c=new Date()[_0x2122d3(0x27c)]();_0x18434c[_0x2122d3(0x19c)](_0x384f24=>{const _0x47a36d=_0x2122d3;_0x384f24[_0x47a36d(0xf3)]<_0x23e10c&&dbSecure['get']('blacklist')[_0x47a36d(0x226)]({'expiry':_0x384f24[_0x47a36d(0xf3)]})[_0x47a36d(0xb3)]();});}function initStates(){const _0x40ffb3=_0x583a45;let _0x28f67b=getConfiguration();_0x28f67b[_0x40ffb3(0x19c)](_0x1b35ba=>{const _0x52233d=_0x40ffb3;_0x1b35ba[_0x52233d(0x284)]=_0x52233d(0x227);}),storeConfiguration(_0x28f67b);}function onKeys(){const _0x5dc078=new RSA();return new Promise(_0x18e2d7=>{const _0x304fd2=_0x2cfb;_0x5dc078[_0x304fd2(0x1dd)]()[_0x304fd2(0xc7)](_0x154421=>{_0x18e2d7(_0x154421);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x54d93c=_0x583a45;let _0x8184a0=getSettings(),_0x248b99=![];!_0x8184a0['hasOwnProperty'](_0x54d93c(0xb1))&&(_0x8184a0[_0x54d93c(0xb1)]=0x0,_0x248b99=!![]);!_0x8184a0[_0x54d93c(0x1aa)](_0x54d93c(0x20a))&&(_0x8184a0['lastmsgemitted']=0x0,_0x248b99=!![]);!_0x8184a0[_0x54d93c(0x1aa)](_0x54d93c(0x241))&&(_0x8184a0[_0x54d93c(0x241)]=_0x54d93c(0x1f0),_0x248b99=!![]);!_0x8184a0[_0x54d93c(0x1aa)](_0x54d93c(0x198))&&(_0x8184a0['onepagemode']=![],_0x248b99=!![]);if(_0x248b99)storeSettings(_0x8184a0);try{fs[_0x54d93c(0x14e)](configbackuppath,{'withFileTypes':!![]})[_0x54d93c(0x19c)](_0xea372f=>{const _0x37ea44=_0x54d93c;if(!_0xea372f[_0x37ea44(0x13e)]()){if(!_0xea372f[_0x37ea44(0x112)]['startsWith'](_0x37ea44(0xf2)))fs[_0x37ea44(0x9e)](configbackuppath+_0xea372f[_0x37ea44(0x112)]);}else fs[_0x37ea44(0xc0)](configbackuppath+_0xea372f['name'],{'recursive':!![]});});}catch(_0x54ebb1){logger[_0x54d93c(0x162)](_0x54d93c(0xcd),_0x54ebb1);}}function storeConfiguration(_0x370e16){const _0x24e4ce=_0x583a45;dbConfig['get'](_0x24e4ce(0x22c))[_0x24e4ce(0x226)]()[_0x24e4ce(0xb3)](),dbConfig[_0x24e4ce(0x272)]('bots')[_0x24e4ce(0xa5)](..._0x370e16)['write'](),config=_0x370e16;}async function resetPassword(){const _0x1a3fd7=_0x583a45;if(tgBot&&settings[_0x1a3fd7(0x1ab)]){const _0x58798e=Markup['inlineKeyboard']([Markup[_0x1a3fd7(0x1ca)][_0x1a3fd7(0x18b)]('yes',_0x1a3fd7(0x203)),Markup['button'][_0x1a3fd7(0x18b)]('no',_0x1a3fd7(0x1c4))]);await sendTelegram(settings[_0x1a3fd7(0x1ab)],_0x1a3fd7(0x11e),_0x58798e),tgBot[_0x1a3fd7(0x24b)](/resetpw_(.+)/,async _0x95b4bf=>{const _0x2a96fc=_0x1a3fd7,_0x2875cb=_0x95b4bf[_0x2a96fc(0xb4)][0x1];_0x95b4bf[_0x2a96fc(0x29c)]();if(_0x2875cb!='no'){const _0x533182=0xf,_0xce6d82=_0x2a96fc(0xca),_0x40ce81=Array[_0x2a96fc(0x17b)](crypto[_0x2a96fc(0x26e)](new Uint32Array(_0x533182)))[_0x2a96fc(0x204)](_0x1a8b2a=>_0xce6d82[_0x1a8b2a%_0xce6d82[_0x2a96fc(0x201)]])[_0x2a96fc(0x158)](''),_0x9c5140=bcrypt[_0x2a96fc(0x22e)](_0x40ce81,saltRounds);storeSettings({'bbPassword':_0x9c5140}),await sendTelegram(_0x95b4bf['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x40ce81,{'parse_mode':_0x2a96fc(0x23a)});}else await sendTelegram(_0x95b4bf[_0x2a96fc(0x123)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x17a346,_0x2391e6){const _0xe682f3=_0x583a45;io['to'](_0xe682f3(0x23f))[_0xe682f3(0xdb)](_0xe682f3(0xf1),_0xe682f3(0x28f),_0xe682f3(0x107));if(tgBot&&settings[_0xe682f3(0x1ab)]){const _0x1bf548=uuidRandom();tmpStorage[_0x1bf548]={'path':_0x17a346,'filename':_0x2391e6};const _0x5c4bd2=Markup[_0xe682f3(0x288)]([Markup['button'][_0xe682f3(0x18b)](_0xe682f3(0x229),'restore_yes_'+_0x1bf548),Markup[_0xe682f3(0x1ca)][_0xe682f3(0x18b)]('no',_0xe682f3(0xf0)+_0x1bf548)]);await sendTelegram(settings['telegramChatId'],_0xe682f3(0x243),_0x5c4bd2),tgBot[_0xe682f3(0x24b)](/restore_(.+)_(.+)/,async _0x549cd5=>{const _0x47d3a2=_0xe682f3,_0x50df40=_0x549cd5['match'][0x1],_0x3f417e=_0x549cd5[_0x47d3a2(0xb4)][0x2],{path:_0x21f857,filename:_0x3062c8}=tmpStorage[_0x3f417e];delete tmpStorage[_0x3f417e],_0x549cd5['editMessageReplyMarkup'](),_0x50df40==_0x47d3a2(0x229)?(logger[_0x47d3a2(0x162)](_0x47d3a2(0x18f)),await sendTelegram(_0x549cd5[_0x47d3a2(0x123)]['id'],_0x47d3a2(0xcb),{'parse_mode':_0x47d3a2(0x23a)}),unzipFile(_0x21f857,_0x3062c8)):(logger[_0x47d3a2(0x162)]('Restore\x20process\x20aborted'),await sendTelegram(_0x549cd5[_0x47d3a2(0x123)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x5e3937=_0x583a45,_0x8b821=new Date();return _0x8b821[_0x5e3937(0x263)]()+'/'+(_0x8b821[_0x5e3937(0xdf)]()+0x1)[_0x5e3937(0x11a)]()[_0x5e3937(0xdd)](0x2,'0')+'/'+_0x8b821['getDate']()[_0x5e3937(0x11a)]()['padStart'](0x2,'0')+'\x20'+_0x8b821[_0x5e3937(0x1ac)]()['toString']()[_0x5e3937(0xdd)](0x2,'0')+':'+_0x8b821[_0x5e3937(0xd2)]()['toString']()[_0x5e3937(0xdd)](0x2,'0')+':'+_0x8b821[_0x5e3937(0x1e0)]()[_0x5e3937(0x11a)]()[_0x5e3937(0xdd)](0x2,'0');}function getTimeStamp(){const _0x377cc6=_0x583a45,_0x1013e9=shiftedTime();return _0x1013e9['getFullYear']()+'/'+(_0x1013e9[_0x377cc6(0xdf)]()+0x1)[_0x377cc6(0x11a)]()[_0x377cc6(0xdd)](0x2,'0')+'/'+_0x1013e9['getDate']()[_0x377cc6(0x11a)]()[_0x377cc6(0xdd)](0x2,'0')+'\x20'+_0x1013e9[_0x377cc6(0x1ac)]()[_0x377cc6(0x11a)]()[_0x377cc6(0xdd)](0x2,'0')+':'+_0x1013e9[_0x377cc6(0xd2)]()[_0x377cc6(0x11a)]()[_0x377cc6(0xdd)](0x2,'0')+':'+_0x1013e9[_0x377cc6(0x1e0)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x2c4289=_0x583a45,_0x378741=shiftedTime();return _0x378741[_0x2c4289(0x263)]()+(_0x378741[_0x2c4289(0xdf)]()+0x1)[_0x2c4289(0x11a)]()[_0x2c4289(0xdd)](0x2,'0')+_0x378741[_0x2c4289(0x19b)]()[_0x2c4289(0x11a)]()[_0x2c4289(0xdd)](0x2,'0')+'-'+_0x378741['getHours']()['toString']()[_0x2c4289(0xdd)](0x2,'0')+_0x378741[_0x2c4289(0xd2)]()[_0x2c4289(0x11a)]()['padStart'](0x2,'0')+_0x378741[_0x2c4289(0x1e0)]()[_0x2c4289(0x11a)]()[_0x2c4289(0xdd)](0x2,'0');}function shiftedTime(){const _0x1c90e8=_0x583a45,_0x2abe3a=new Date();let _0x10fa7f=_0x2abe3a;if(settings[_0x1c90e8(0x235)]&&settings[_0x1c90e8(0x235)]!==0x0)_0x10fa7f=fns[_0x1c90e8(0x254)](_0x2abe3a,{'hours':settings['timeshift']});return _0x10fa7f;}function startScheduler(){const _0x332132=_0x583a45,_0x588f40=new Date()['getUTCHours'](),_0x567465=shiftedTime()[_0x332132(0x1ac)]();_0x567465==0x4&&backupConfigFiles();_0x567465==0x0&&rotateLogFiles();_0x588f40%0x6==0x0&&triggerAnalytics();_0x588f40%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x410622){const _0x25fbfa=_0x583a45;logger['debug']('Restore\x20backup\x20file\x20'+_0x410622);const _0x150882=getBotsWithMode();_0x150882[_0x25fbfa(0x201)]>0x0?confirmRestore(configbackuppath,_0x410622):unzipFile(configbackuppath,_0x410622);}async function getBackupFiles(_0x1fa371=null){const _0x4a9585=_0x583a45;let _0x44002f=[],_0x1cef44=fs[_0x4a9585(0x14e)](configbackuppath,{'withFileTypes':!![]});_0x1cef44['sort']((_0x3bf071,_0x5ee01b)=>_0x3bf071['name']<_0x5ee01b[_0x4a9585(0x112)]?0x1:_0x5ee01b[_0x4a9585(0x112)]<_0x3bf071[_0x4a9585(0x112)]?-0x1:0x0),_0x1cef44[_0x4a9585(0x19c)](_0x4c65e7=>{const _0x9a9db4=_0x4a9585;if(!_0x4c65e7[_0x9a9db4(0x13e)]()&&_0x4c65e7[_0x9a9db4(0x112)][_0x9a9db4(0x9d)](_0x9a9db4(0xf2))&&_0x4c65e7[_0x9a9db4(0x112)]['endsWith'](_0x9a9db4(0x160))){const _0x2fe3db=formatDate(fs[_0x9a9db4(0x230)](configbackuppath+_0x4c65e7[_0x9a9db4(0x112)])[_0x9a9db4(0x297)]);_0x44002f['push']({'name':_0x4c65e7['name'],'mtime':_0x2fe3db});}});if(_0x1fa371)io['to'](_0x1fa371)[_0x4a9585(0xdb)](_0x4a9585(0x100),_0x44002f);else return _0x44002f;}async function backupConfigFiles(){const _0x20d028=_0x583a45;await zipFiles(_0x20d028(0x247));const _0x234772=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x20d028(0x11f),configbackuppath+(_0x20d028(0xf2)+_0x234772+_0x20d028(0x160)));let _0x5957f5=fs[_0x20d028(0x14e)](configbackuppath,{'withFileTypes':!![]});_0x5957f5['sort']((_0x14495a,_0x19fddb)=>_0x14495a[_0x20d028(0x112)]<_0x19fddb[_0x20d028(0x112)]?0x1:_0x19fddb['name']<_0x14495a[_0x20d028(0x112)]?-0x1:0x0),_0x5957f5['length']>maxBackups&&fs[_0x20d028(0x9e)](configbackuppath+_0x5957f5[_0x5957f5[_0x20d028(0x201)]-0x1]['name']);}function rotateLogFiles(){const _0x1c3305=_0x583a45,_0xdae495=fs['statSync'](logspath+_0x1c3305(0xce)),_0x190a8a=_0xdae495[_0x1c3305(0x278)]/0x400;if(_0x190a8a>0x64){let _0x15adef=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x15adef[_0x1c3305(0x138)]((_0x4954e8,_0x4f979f)=>_0x4954e8[_0x1c3305(0x112)]<_0x4f979f[_0x1c3305(0x112)]?0x1:_0x4f979f[_0x1c3305(0x112)]<_0x4954e8[_0x1c3305(0x112)]?-0x1:0x0),_0x15adef[_0x1c3305(0x19c)](_0x39d640=>{const _0x1094ca=_0x1c3305;if(_0x39d640['name']==_0x1094ca(0xbf))fs[_0x1094ca(0xee)](logspath+_0x39d640[_0x1094ca(0x112)],logspath+_0x1094ca(0x188));if(_0x39d640[_0x1094ca(0x112)]==_0x1094ca(0x257))fs[_0x1094ca(0xee)](logspath+_0x39d640[_0x1094ca(0x112)],logspath+'output-002.log');_0x39d640[_0x1094ca(0x112)]=='output-000.log'&&(fs[_0x1094ca(0xee)](logspath+_0x39d640[_0x1094ca(0x112)],logspath+'output-001.log'),fs[_0x1094ca(0x1c5)](logspath+_0x39d640[_0x1094ca(0x112)],''));});}}async function zipFiles(_0x2a3ac9){const _0x3992bd=_0x583a45;let _0x35a498;if(_0x2a3ac9=='logs')_0x35a498=logspath;if(_0x2a3ac9==_0x3992bd(0x1d1))_0x35a498=configpath;if(_0x2a3ac9==_0x3992bd(0x247))_0x35a498=configpath;let _0x40fd9e=fs[_0x3992bd(0x14e)](_0x35a498,{'withFileTypes':!![]});const _0x223a60=new require(_0x3992bd(0x1d0))();_0x40fd9e[_0x3992bd(0x19c)](_0xbcb288=>{const _0x517329=_0x3992bd;if(!_0xbcb288[_0x517329(0x13e)]()){let _0x2b3193=fs['readFileSync'](_0x35a498+_0xbcb288['name']);if(_0x2a3ac9==_0x517329(0x1d1)){const _0x108124=/^bot-[0-9]{3}-config.json$/,_0x409f41=_0x108124[_0x517329(0x143)](_0xbcb288[_0x517329(0x112)]);if(_0x409f41){const _0x399f9b=JSON[_0x517329(0x13f)](_0x2b3193);if(_0x399f9b[_0x517329(0x152)][0x0]){_0x399f9b['bot'][0x0][_0x517329(0x1d7)]=_0x517329(0x216),_0x399f9b[_0x517329(0x152)][0x0][_0x517329(0xc1)]=_0x517329(0x216);if(_0x399f9b['bot'][0x0][_0x517329(0x20e)])_0x399f9b[_0x517329(0x152)][0x0][_0x517329(0x20e)]=_0x517329(0x216);}_0x2b3193=JSON[_0x517329(0x151)](_0x399f9b,null,0x2);}if(_0xbcb288[_0x517329(0x112)]=='bb-settings.json'){const _0x23ba2a=JSON[_0x517329(0x13f)](_0x2b3193);if(_0x23ba2a[_0x517329(0x252)][_0x517329(0x1b4)])_0x23ba2a[_0x517329(0x252)][_0x517329(0x1b4)]=![];if(_0x23ba2a['settings'][_0x517329(0x163)])_0x23ba2a[_0x517329(0x252)][_0x517329(0x163)]=_0x517329(0x216);if(_0x23ba2a[_0x517329(0x252)][_0x517329(0x21c)])_0x23ba2a[_0x517329(0x252)][_0x517329(0x21c)]=_0x517329(0x216);if(_0x23ba2a[_0x517329(0x252)][_0x517329(0x1ab)])_0x23ba2a['settings'][_0x517329(0x1ab)]=null;_0x2b3193=JSON['stringify'](_0x23ba2a,null,0x2);}if(_0xbcb288[_0x517329(0x112)]!=_0x517329(0x15d))_0x223a60[_0x517329(0x221)](_0xbcb288[_0x517329(0x112)],_0x2b3193);}else _0x223a60['file'](_0xbcb288['name'],_0x2b3193);}});const _0xb9376a=_0x223a60[_0x3992bd(0x1dc)]({'base64':![],'compression':'DEFLATE'});fs[_0x3992bd(0x1c5)](zippath+(_0x2a3ac9+_0x3992bd(0x160)),_0xb9376a,_0x3992bd(0x9c));}async function unzipFile(_0x1843ab,_0xb27fc6){const _0x25cd5c=_0x583a45;fs[_0x25cd5c(0x14e)](configpath,{'withFileTypes':!![]})[_0x25cd5c(0x19c)](_0x4e833f=>{const _0x42d550=_0x25cd5c;if(!_0x4e833f['isDirectory']())fs[_0x42d550(0xc0)](configpath+_0x4e833f[_0x42d550(0x112)]);});const _0x197f51=fs[_0x25cd5c(0x26a)](_0x1843ab+_0xb27fc6,_0x25cd5c(0x9c)),_0x17c7d1=new require(_0x25cd5c(0x1d0))(_0x197f51,{'base64':![],'checkCRC32':!![]});Object[_0x25cd5c(0xad)](_0x17c7d1[_0x25cd5c(0x1fb)])['forEach'](_0xf4578a=>{const _0x343a6c=_0x25cd5c,_0x3163b7=_0x17c7d1[_0x343a6c(0x1fb)][_0xf4578a];fs[_0x343a6c(0x1c5)](configpath+_0x3163b7[_0x343a6c(0x112)],_0x3163b7[_0x343a6c(0x177)]);}),fs[_0x25cd5c(0x14e)](temppath,{'withFileTypes':!![]})[_0x25cd5c(0x19c)](_0x15933a=>{const _0x5ce4c8=_0x25cd5c;if(!_0x15933a[_0x5ce4c8(0x13e)]())fs['rmSync'](temppath+_0x15933a[_0x5ce4c8(0x112)]);}),logger[_0x25cd5c(0x162)](_0x25cd5c(0x1f4)),process[_0x25cd5c(0x1e2)]({'restore':!![]},_0x10e1b1=>{});}async function getPublicIp(){const _0x375321=_0x583a45;try{const _0x421bb4=await axios[_0x375321(0x272)]('https://api.ipify.org?format=json');publicip=_0x421bb4[_0x375321(0x15e)]['ip'];}catch(_0x281f0f){}}async function triggerAnalytics(){const _0x46b902=_0x583a45;if(!publicip)await getPublicIp();const _0x107f3b=getBotsWithMode();let _0x3782b2=0x0;_0x107f3b[_0x46b902(0x19c)](_0x192390=>{const _0x1aee19=_0x46b902;if(_0x192390[_0x1aee19(0x147)]===_0x1aee19(0x170))_0x3782b2++;});const _0x4e0f39=getBotExchanges();mixpanel[_0x46b902(0x132)](_0x46b902(0x1fd),{'distinct_id':settings[_0x46b902(0x282)],'ip':publicip,'version':serverversion,'numbots':_0x107f3b[_0x46b902(0x201)],'numbotsenabled':_0x3782b2,'exchanges':_0x4e0f39,'environment':environment});}async function getMessages(){const _0x45f1dc=_0x583a45,_0x7a0f5e=_0x45f1dc(0x115),_0x32d090=new GraphQLClient(_0x7a0f5e),_0x316d4b={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x3193c4=serverversion[_0x45f1dc(0xb6)]('.'),_0x8ff775=_0x3193c4[0x0]+'.'+_0x3193c4[0x1],_0x36b64d=Math[_0x45f1dc(0x1be)](settings[_0x45f1dc(0xb1)],settings['lastmsgemitted']),_0x5cfdfc={'last':parseInt(_0x36b64d),'bbm':_0x8ff775},_0x339c5e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x319842;try{_0x319842=await _0x32d090['request'](_0x339c5e,_0x5cfdfc,_0x316d4b);}catch(_0x3c26e5){}if(_0x319842&&_0x319842[_0x45f1dc(0x166)]){let _0x386319=settings[_0x45f1dc(0xb1)];newMessages=[];for(const _0xa30c68 of _0x319842['messages']){newMessages['push'](_0xa30c68);let _0x35b87e=![];_0xa30c68[_0x45f1dc(0x233)]&&(updateSetting(_0x45f1dc(0x241),_0xa30c68[_0x45f1dc(0x233)]),_0x35b87e=isNewerVersion(serverversion,_0xa30c68[_0x45f1dc(0x233)])||serverversion==_0xa30c68[_0x45f1dc(0x233)]);if(!_0x35b87e&&_0xa30c68[_0x45f1dc(0xc8)]>_0x386319){if(_0xa30c68[_0x45f1dc(0x237)]==='any'||serverversion[_0x45f1dc(0x9d)](_0xa30c68[_0x45f1dc(0x237)])){let _0x3a4bb0=''+_0xa30c68[_0x45f1dc(0x1cb)]+'\x0a\x0a'+_0xa30c68[_0x45f1dc(0x283)];const _0x14c50a=await sendTelegramMsg(toTelegramMarkdown(_0x3a4bb0),_0x45f1dc(0xda));if(_0x14c50a)_0x386319=_0xa30c68[_0x45f1dc(0xc8)];}}}updateAvailable=isNewerVersion(settings[_0x45f1dc(0x241)],serverversion),updateSetting(_0x45f1dc(0xb1),_0x386319),emitMessages();}}function emitMessages(){const _0x3b2c35=_0x583a45,_0x7de907=settings[_0x3b2c35(0x20a)];let _0x43c0a3=[];newMessages['forEach'](_0xd123dd=>{const _0xa6dec=_0x3b2c35;_0xd123dd[_0xa6dec(0xc8)]>_0x7de907&&_0x43c0a3[_0xa6dec(0xa5)](_0xd123dd);}),_0x43c0a3[_0x3b2c35(0x201)]>0x0&&getAllClients()[_0x3b2c35(0x19c)](_0x6ddcf3=>{const _0x465f7e=_0x3b2c35;getSocket(_0x6ddcf3['id'])[_0x465f7e(0xdb)](_0x465f7e(0x283),_0x43c0a3);});}function confirmMessage(_0x131cc6){const _0x1b2d4f=_0x583a45;updateSetting(_0x1b2d4f(0x20a),Number(_0x131cc6));}function isNewerVersion(_0x155a89,_0x20f276){const _0x5e16a6=_0x583a45,_0x688981=_0x20f276[_0x5e16a6(0xb6)]('.'),_0x4e7e05=_0x155a89[_0x5e16a6(0xb6)]('.');for(var _0x5b9cc7=0x0;_0x5b9cc7<_0x4e7e05[_0x5e16a6(0x201)];_0x5b9cc7++){const _0x48bd0d=~~_0x4e7e05[_0x5b9cc7],_0x58a796=~~_0x688981[_0x5b9cc7];if(_0x48bd0d>_0x58a796)return!![];if(_0x48bd0d<_0x58a796)return![];}return![];}function toTelegramMarkdown(_0x4f8357){const _0x24ef55=_0x583a45,_0x3432b8=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x354846=/\*{2}(.+?)\*{2}/gim;return _0x4f8357=_0x4f8357[_0x24ef55(0x280)](_0x3432b8,_0x24ef55(0x199))['replace'](_0x354846,_0x24ef55(0x12c)),_0x4f8357;}async function validateConfigFile(){const _0x5eaa50=_0x583a45,_0x26d57c=dbConfig[_0x5eaa50(0x272)](_0x5eaa50(0x22c))[_0x5eaa50(0xa3)](_0x5eaa50(0xfc))[_0x5eaa50(0x19d)]()||[];if(_0x26d57c[_0x5eaa50(0x201)]==0x0){let _0x480423=0x0,_0xb4cdcc=[];const _0x32e41e=/^bot-([0-9]{3})-config.json$/,_0x556928=fs[_0x5eaa50(0x14e)](configpath);_0x556928[_0x5eaa50(0x19c)](_0x487206=>{const _0xb0a27=_0x5eaa50,_0xc3b9a3=_0x32e41e[_0xb0a27(0xbe)](_0x487206);if(_0xc3b9a3){const _0x2073b6=_0xc3b9a3[0x1];let _0x33154b=getBotAttributes(_0x2073b6);_0xb4cdcc[_0xb0a27(0xa5)]({'botID':_0x2073b6,'botname':_0x33154b['botname'],'status':_0xb0a27(0x290),'live':_0xb0a27(0x227)}),_0x480423++;}}),_0x480423!=0x0&&(dbConfig[_0x5eaa50(0x272)](_0x5eaa50(0x22c))[_0x5eaa50(0x1f1)](_0xb4cdcc)[_0x5eaa50(0xb3)](),config=_0xb4cdcc,restoredConfigFile=_0x480423);}}async function restoreConfigNotify(_0x2db2cd){const _0x5cda1b=_0x583a45;let _0x5d724a;if(restoredConfigFile==0x1)_0x5d724a=_0x5cda1b(0x16d);else _0x5d724a=_0x5cda1b(0x175);if(_0x2db2cd)io['to'](_0x5cda1b(0x23f))['emit'](_0x5cda1b(0xf1),_0x5d724a);else{logger[_0x5cda1b(0x1f8)](_0x5cda1b(0x1de)),logger[_0x5cda1b(0x1f8)](_0x5d724a),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x5cda1b(0x1f8)]('');if(tgBot&&settings[_0x5cda1b(0x1ab)]&&settings[_0x5cda1b(0x105)]!=_0x5cda1b(0x1a9))await sendTelegram(settings[_0x5cda1b(0x1ab)],_0x5cda1b(0x171)+_0x5d724a);}}function validateCredentials(_0x40202f,_0xd540){const _0x11fc8b=_0x583a45;if(_0x40202f[_0x11fc8b(0x262)]==settings[_0x11fc8b(0x17d)]&&bcrypt[_0x11fc8b(0x1ad)](_0x40202f[_0x11fc8b(0x190)],settings[_0x11fc8b(0x163)])){if(settings[_0x11fc8b(0x194)])return{'allow':![],'reason':_0x11fc8b(0x23e),'token':null};else{const _0x4e6d05=generateLoginToken(_0xd540);return{'allow':!![],'reason':_0x11fc8b(0x23c),'token':_0x4e6d05};}}else return{'allow':![],'reason':_0x11fc8b(0x168),'token':null};}function refreshToken(_0x13c917){const _0x514330=_0x583a45,_0x11b500=generateLoginToken(_0x13c917);return{'allow':!![],'reason':_0x514330(0x23c),'token':_0x11b500};}function validateAccess(_0x29345e,_0x3e6eef,_0x448b0d){const _0x207a7a=_0x583a45,_0x331bf8=_0x448b0d?_0x448b0d:devices[_0x3e6eef]['ip'];let _0xf13e5a;const _0x3becce=_0x1943b7=>{const _0x4872ba=_0x2cfb;if(settings[_0x4872ba(0x1b4)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x3e6eef)){const _0x326e45=generateLoginToken(_0x3e6eef);return{'allow':!![],'reason':_0x4872ba(0x261),'token':_0x326e45};}else return{'allow':![],'reason':_0x4872ba(0x19a),'token':null};}else return _0xf13e5a=validToken(_0x1943b7,_0x3e6eef),_0xf13e5a['hasOwnProperty'](_0x4872ba(0x107))?{'allow':!![],'reason':_0x4872ba(0x205),'token':_0x1943b7}:{'allow':![],'reason':_0x4872ba(0x19a),'token':null};}else return{'allow':!![],'reason':_0x4872ba(0x292),'token':null};};if(settings[_0x207a7a(0x273)]){let _0x169223=[...settings[_0x207a7a(0x1e3)],_0x207a7a(0xde),_0x207a7a(0x179),_0x207a7a(0x120)];if(_0x169223[_0x207a7a(0x18c)](_0x331bf8))return _0x3becce(_0x29345e);else{_0xf13e5a=validToken(_0x29345e,_0x3e6eef);if(_0xf13e5a[_0x207a7a(0x1aa)]('success'))return _0x3becce(_0x29345e);else{if(telegramIpApproved(_0x3e6eef)){const _0x2e3970=generateToken(_0x3e6eef);return _0xf13e5a=_0x3becce(_0x29345e),_0xf13e5a[_0x207a7a(0x174)]?{'allow':!![],'reason':_0x207a7a(0x299),'token':_0x2e3970}:_0xf13e5a;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x207a7a(0x1e8),'token':null}:{'allow':![],'reason':_0x207a7a(0xfa),'token':null};}}}else return _0x3becce(_0x29345e);}function timelyDecrypt(_0x5afb54,_0x8a1053=!![]){const _0x301c11=_0x583a45;if(_0x5afb54)try{const _0xe4ad3c=crypt[_0x301c11(0x157)](secure['privateKey'],_0x5afb54)[_0x301c11(0x283)],_0xec71f9=_0xe4ad3c['split']('@')[0x0],_0x2461ab=_0xe4ad3c[_0x301c11(0xb6)]('@')[0x1],_0x3b2adc=new Date()[_0x301c11(0x27c)]();if(_0x8a1053){if(_0x3b2adc-_0x2461ab<maxSecretAge*0x3e8)return _0xec71f9;else return![];}else return _0xec71f9;}catch(_0x3c65b1){return![];}else return![];}const validToken=(_0x42d226,_0x27cf5c)=>{const _0x3efa7f=_0x583a45,_0x37e47e=devices[_0x27cf5c]['ip'];if(!_0x42d226)return{'error':_0x3efa7f(0x154)};for(let _0x40141e of blacklist){if(_0x40141e[_0x3efa7f(0x104)]==_0x42d226)return{'error':_0x3efa7f(0x12f)};}let _0x48a65e;try{_0x48a65e=jwt['verify'](_0x42d226,secure[_0x3efa7f(0x17a)]+_0x27cf5c);}catch{return{'error':_0x3efa7f(0x14c)};}if(!_0x48a65e[_0x3efa7f(0x1aa)](_0x3efa7f(0x28e))&&!_0x48a65e[_0x3efa7f(0x1aa)](_0x3efa7f(0x262))||!_0x48a65e[_0x3efa7f(0x1aa)](_0x3efa7f(0x276)))return{'error':_0x3efa7f(0x248)};if(!_0x48a65e['hasOwnProperty']('username')&&_0x48a65e[_0x3efa7f(0x1aa)](_0x3efa7f(0x28e))){const {clientip:_0x1f30b9}=_0x48a65e;return _0x37e47e==_0x1f30b9?{'success':_0x3efa7f(0x1a8)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x48a65e[_0x3efa7f(0x1aa)](_0x3efa7f(0x262))&&_0x48a65e[_0x3efa7f(0x1aa)](_0x3efa7f(0x28e))){const {username:_0x309762,clientip:_0xa38119}=_0x48a65e;return settings[_0x3efa7f(0x17d)]==_0x309762&&_0x37e47e==_0xa38119?{'success':_0x3efa7f(0x1a8)}:{'error':_0x3efa7f(0xe2)};}}},generateLoginToken=_0x30a325=>{const _0x44fef0=_0x583a45;if(_0x30a325){const _0x3d0236=devices[_0x30a325]['ip'];return jwt[_0x44fef0(0x223)]({'username':settings[_0x44fef0(0x17d)],'clientip':_0x3d0236},secure[_0x44fef0(0x17a)]+_0x30a325,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3b4000=>{const _0x4f7861=_0x583a45;if(_0x3b4000){const _0x26191a=devices[_0x3b4000]['ip'];return jwt[_0x4f7861(0x223)]({'clientip':_0x26191a},secure[_0x4f7861(0x17a)]+_0x3b4000,{'expiresIn':devices[_0x3b4000][_0x4f7861(0x1c2)][_0x4f7861(0xf3)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x51b062=>{const _0x37fdad=_0x583a45;let _0x34cc7f=![];return devices[_0x51b062][_0x37fdad(0x1c2)]&&devices[_0x51b062][_0x37fdad(0x1c2)][_0x37fdad(0xf3)]!=_0x37fdad(0xd6)&&(_0x34cc7f=devices[_0x51b062][_0x37fdad(0x1c2)][_0x37fdad(0x28e)]==devices[_0x51b062]['ip']&&new Date()[_0x37fdad(0x27c)]()-devices[_0x51b062][_0x37fdad(0x1c2)][_0x37fdad(0xb5)]<devices[_0x51b062][_0x37fdad(0x1c2)]['expiry']*0x3c*0x3e8),_0x34cc7f;},telegram2FaApproved=_0x4e4141=>{const _0x40a6e9=_0x583a45;let _0x3dc678=![];return devices[_0x4e4141][_0x40a6e9(0x15f)]&&devices[_0x4e4141][_0x40a6e9(0x15f)][_0x40a6e9(0xf3)]!='reject'&&(_0x3dc678=devices[_0x4e4141][_0x40a6e9(0x15f)][_0x40a6e9(0x28e)]==devices[_0x4e4141]['ip']&&new Date()[_0x40a6e9(0x27c)]()-devices[_0x4e4141][_0x40a6e9(0x15f)][_0x40a6e9(0xb5)]<devices[_0x4e4141][_0x40a6e9(0x15f)][_0x40a6e9(0xf3)]*0x3c*0x3e8),_0x3dc678;},normalizeIP=_0x5250d6=>{const _0x2748b2=_0x583a45;let _0x23d446=null,_0x222a08=null;if(ipaddr['isValid'](_0x5250d6)){const _0x3623ce=ipaddr[_0x2748b2(0x13f)](_0x5250d6);_0x3623ce['kind']()===_0x2748b2(0xe0)?(_0x3623ce[_0x2748b2(0x232)]()&&(_0x23d446=_0x3623ce[_0x2748b2(0xe3)]()[_0x2748b2(0x11a)]()),_0x222a08=_0x3623ce[_0x2748b2(0x11a)]()):(_0x23d446=_0x3623ce[_0x2748b2(0x11a)](),_0x222a08=_0x3623ce[_0x2748b2(0x14a)]()[_0x2748b2(0x11a)]());}return{'show':_0x23d446?_0x23d446:_0x222a08,'store':_0x222a08};};function formatDate(_0x54ae24){const _0x21c8ec=_0x583a45;return _0x54ae24[_0x21c8ec(0x263)]()+'/'+(_0x54ae24[_0x21c8ec(0xdf)]()+0x1)[_0x21c8ec(0x11a)]()[_0x21c8ec(0xdd)](0x2,'0')+'/'+_0x54ae24[_0x21c8ec(0x19b)]()[_0x21c8ec(0x11a)]()[_0x21c8ec(0xdd)](0x2,'0')+'\x20'+_0x54ae24[_0x21c8ec(0x1ac)]()[_0x21c8ec(0x11a)]()[_0x21c8ec(0xdd)](0x2,'0')+':'+_0x54ae24[_0x21c8ec(0xd2)]()[_0x21c8ec(0x11a)]()[_0x21c8ec(0xdd)](0x2,'0')+':'+_0x54ae24[_0x21c8ec(0x1e0)]()['toString']()[_0x21c8ec(0xdd)](0x2,'0');}function sleep(_0xa93b35){return new Promise(_0x3e415f=>setTimeout(_0x3e415f,_0xa93b35));}