const _0x3ce4fe=_0x4840;(function(_0x48cf99,_0x5aab89){const _0x1529cf=_0x4840,_0x3a916f=_0x48cf99();while(!![]){try{const _0x3e1a4d=parseInt(_0x1529cf(0x1f5))/0x1+parseInt(_0x1529cf(0x1d6))/0x2*(-parseInt(_0x1529cf(0x2c8))/0x3)+parseInt(_0x1529cf(0x260))/0x4+-parseInt(_0x1529cf(0x28f))/0x5+parseInt(_0x1529cf(0x298))/0x6+parseInt(_0x1529cf(0x271))/0x7*(parseInt(_0x1529cf(0x1d4))/0x8)+-parseInt(_0x1529cf(0x2e5))/0x9;if(_0x3e1a4d===_0x5aab89)break;else _0x3a916f['push'](_0x3a916f['shift']());}catch(_0x1c72e3){_0x3a916f['push'](_0x3a916f['shift']());}}}(_0x3590,0xc2265));const _0xb8cea6=function(){let _0x3e1ec7=!![];return function(_0xec5a,_0x1affb8){const _0x215065=_0x3e1ec7?function(){const _0x20d003=_0x4840;if(_0x1affb8){const _0x58ae7d=_0x1affb8[_0x20d003(0x288)](_0xec5a,arguments);return _0x1affb8=null,_0x58ae7d;}}:function(){};return _0x3e1ec7=![],_0x215065;};}(),_0x425e2a=_0xb8cea6(this,function(){const _0x4af5ee=_0x4840;return _0x425e2a[_0x4af5ee(0x2b0)]()[_0x4af5ee(0x297)](_0x4af5ee(0x1e1))['toString']()['constructor'](_0x425e2a)[_0x4af5ee(0x297)](_0x4af5ee(0x1e1));});_0x425e2a();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x3ce4fe(0x287)),FileSync=require(_0x3ce4fe(0x2ef)),fs=require('fs'),fns=require('date-fns'),low=require(_0x3ce4fe(0x1fe)),path=require(_0x3ce4fe(0x2fd)),crypto=require(_0x3ce4fe(0x1bd)),Crypt=require(_0x3ce4fe(0x1f0))[_0x3ce4fe(0x24d)],RSA=require(_0x3ce4fe(0x1f0))[_0x3ce4fe(0x2b4)],bcrypt=require(_0x3ce4fe(0x2f9)),jwt=require('jsonwebtoken'),analyticsLib=require(_0x3ce4fe(0x2ab))[_0x3ce4fe(0x25d)],googleAnalytics=require(_0x3ce4fe(0x2f1))[_0x3ce4fe(0x25d)],ipaddr=require(_0x3ce4fe(0x1bb)),argv=require(_0x3ce4fe(0x227))(process[_0x3ce4fe(0x27a)]['slice'](0x2))[_0x3ce4fe(0x27a)],PORT=argv['port']||_0x3ce4fe(0x20f),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x3ce4fe(0x216)](PORT))return console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x3ce4fe(0x2f3)),process['exit'](0x1);const HOST=argv[_0x3ce4fe(0x2c2)]||null,userID=argv[_0x3ce4fe(0x1bf)]||'';let bbpath=_0x3ce4fe(0x2c5),bbpath2='';const botfile=_0x3ce4fe(0x239),configfile=_0x3ce4fe(0x2a2),settingsfile=_0x3ce4fe(0x2aa),securefile='bb-secure.json';let validInstallation=!![];!fs[_0x3ce4fe(0x292)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3ce4fe(0x2e6)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x3ce4fe(0x1c6),configbackuppath=configpath+'backup/';!fs[_0x3ce4fe(0x292)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x3ce4fe(0x292)](configbackuppath)&&fs[_0x3ce4fe(0x2a7)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3ce4fe(0x2cb)]({'bots':[]})[_0x3ce4fe(0x2a8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0x3ce4fe(0x2a8)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3ce4fe(0x2cb)]({'secure':{},'blacklist':[]})[_0x3ce4fe(0x2a8)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x3ce4fe(0x228)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3ce4fe(0x2fc))[_0x3ce4fe(0x2ec)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x3ce4fe(0x2b5)),app=express(),http=require(_0x3ce4fe(0x1d9))[_0x3ce4fe(0x25e)](app);app[_0x3ce4fe(0x26e)](express['static'](path[_0x3ce4fe(0x2c0)](__dirname,bbpath2,_0x3ce4fe(0x2df)))),app[_0x3ce4fe(0x26e)](express[_0x3ce4fe(0x2d4)](path[_0x3ce4fe(0x2c0)](__dirname,bbpath2,_0x3ce4fe(0x2af)))),app['get']('/',function(_0x17652d,_0x1b773a){const _0x3aa066=_0x3ce4fe;_0x1b773a[_0x3aa066(0x237)](path[_0x3aa066(0x2c0)](__dirname,bbpath2,_0x3aa066(0x2df),_0x3aa066(0x26d)));}),app['get']('/:bot',function(_0x105680,_0x36791c){const _0x235bd5=_0x3ce4fe;_0x36791c[_0x235bd5(0x237)](path[_0x235bd5(0x2c0)](__dirname,bbpath2,_0x235bd5(0x2af),_0x235bd5(0x26d)));}),app[_0x3ce4fe(0x258)](_0x3ce4fe(0x2a5),(_0x37b464,_0x26a6c0)=>{const _0x1bf825=_0x3ce4fe;_0x26a6c0[_0x1bf825(0x237)](path[_0x1bf825(0x2c0)](__dirname,bbpath2,_0x1bf825(0x2af),_0x1bf825(0x26d)));}),app[_0x3ce4fe(0x258)]('/:bot/performance',(_0xf4f466,_0x3b57cc)=>{const _0x3cf208=_0x3ce4fe;_0x3b57cc[_0x3cf208(0x237)](path[_0x3cf208(0x2c0)](__dirname,bbpath2,_0x3cf208(0x2af),_0x3cf208(0x26d)));}),app[_0x3ce4fe(0x258)](_0x3ce4fe(0x2ac),(_0x29aa15,_0x479ae4)=>{const _0x19be7d=_0x3ce4fe;_0x479ae4[_0x19be7d(0x237)](path[_0x19be7d(0x2c0)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x3ce4fe(0x22d),(_0x35ba97,_0x474301)=>{const _0x5e4710=_0x3ce4fe;_0x474301[_0x5e4710(0x237)](path[_0x5e4710(0x2c0)](__dirname,bbpath2,_0x5e4710(0x2af),_0x5e4710(0x26d)));}),app[_0x3ce4fe(0x258)](_0x3ce4fe(0x28b),(_0x26281b,_0x3ace81)=>{const _0x529802=_0x3ce4fe;_0x3ace81[_0x529802(0x237)](path[_0x529802(0x2c0)](__dirname,bbpath2,_0x529802(0x2af),_0x529802(0x26d)));}),app[_0x3ce4fe(0x258)](_0x3ce4fe(0x283),(_0x3b8a4e,_0x10c218)=>{const _0xaea404=_0x3ce4fe;_0x10c218[_0xaea404(0x237)](path[_0xaea404(0x2c0)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x3ce4fe(0x28c)](PORT,HOST);else http[_0x3ce4fe(0x28c)](PORT);const io=require(_0x3ce4fe(0x24c))(http,{}),analytics=analyticsLib({'app':_0x3ce4fe(0x249),'plugins':[googleAnalytics({'trackingId':_0x3ce4fe(0x2dd)})]}),TelegramBot=require(_0x3ce4fe(0x2fa));let tgBot;if(settings[_0x3ce4fe(0x2e2)]&&settings[_0x3ce4fe(0x2e2)]!=''&&settings[_0x3ce4fe(0x1c5)]&&settings[_0x3ce4fe(0x1c5)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x226c8d=_0x3ce4fe;console[_0x226c8d(0x2a1)](''),console[_0x226c8d(0x2a1)](_0x226c8d(0x276)),logging(_0x226c8d(0x1ed)+PORT),console[_0x226c8d(0x2a1)](_0x226c8d(0x276));if(config[_0x226c8d(0x200)]!=0x0)config[_0x226c8d(0x27b)](_0x50481f=>{const _0x763a8c=_0x226c8d;if(_0x50481f[_0x763a8c(0x1f3)]=='enabled'||_0x50481f[_0x763a8c(0x1f3)]=='new')logging(_0x763a8c(0x1f9)+_0x50481f[_0x763a8c(0x2e8)]+_0x763a8c(0x1f4)+_0x50481f[_0x763a8c(0x1ef)]),startBot([_0x50481f[_0x763a8c(0x2e8)],userID],{'cwd':bbpath},function(_0x2eaf5f){if(_0x2eaf5f)logging(_0x2eaf5f);});else(_0x50481f[_0x763a8c(0x1f3)]==_0x763a8c(0x2ed)||_0x50481f['status']==_0x763a8c(0x22e))&&logging(_0x763a8c(0x204)+_0x50481f['botID']+_0x763a8c(0x1f4)+_0x50481f[_0x763a8c(0x1ef)]);});else!newBot&&console['log'](_0x226c8d(0x2f5));if(newBot)addBot();console[_0x226c8d(0x2a1)](_0x226c8d(0x276)),console['log']('');}function startSocket(){const _0x58ad5a=_0x3ce4fe;io['on'](_0x58ad5a(0x29d),_0x309b3e=>{const _0x307849=_0x58ad5a;let _0x1c1c35,_0x196c61,_0x38a0b2,_0x511041,_0x12ce40;const _0x41d2ef=_0x309b3e[_0x307849(0x207)][_0x307849(0x2a4)][_0x307849(0x28e)];_0x196c61=_0x41d2ef[_0x307849(0x25f)](/bot[0-9]{3}/);if(_0x196c61)_0x38a0b2=_0x196c61[0x0][_0x307849(0x25f)](/[0-9]{3}/);if(_0x38a0b2)_0x1c1c35=_0x38a0b2[0x0];else _0x1c1c35='botmanager';const _0x44b021=_0x309b3e[_0x307849(0x207)][_0x307849(0x2e3)][_0x307849(0x201)];if(!_0x44b021)_0x309b3e['emit'](_0x307849(0x1f3),{'publicKey':secure[_0x307849(0x241)]});else{_0x511041=timelyDecrypt(_0x44b021,![]);if(!_0x511041)_0x309b3e[_0x307849(0x1e6)](_0x307849(0x1f3),{'publicKey':secure[_0x307849(0x241)]});else{_0x12ce40=normalizeIP(_0x309b3e[_0x307849(0x1dd)][_0x307849(0x2f8)])['store'];if(!devices[_0x511041])devices[_0x511041]={'uuid':_0x511041,'access':{'token':null}};devices[_0x511041]['ip']=_0x12ce40;const _0x1557f4=addClient(_0x309b3e['id'],_0x511041,_0x1c1c35);setAccess(_0x1557f4),_0x309b3e['on'](_0x307849(0x262),_0x4964a7=>{const _0x497e94=_0x307849,_0x7685e6=timelyDecrypt(_0x4964a7[_0x497e94(0x210)]);if(_0x7685e6){_0x4964a7={'username':_0x4964a7[_0x497e94(0x1c9)],'password':_0x7685e6},devices[_0x511041][_0x497e94(0x1cc)]=validateCredentials(_0x4964a7,_0x511041);if(devices[_0x511041][_0x497e94(0x1cc)][_0x497e94(0x229)]==![]&&devices[_0x511041][_0x497e94(0x1cc)][_0x497e94(0x2d7)]=='2FA\x20login\x20required')_0x309b3e[_0x497e94(0x1e6)](_0x497e94(0x1f3),{'access':devices[_0x511041]['access']}),loginAccess2FA(_0x511041,_0x12ce40);else{if(devices[_0x511041][_0x497e94(0x1cc)][_0x497e94(0x229)]==![]&&devices[_0x511041][_0x497e94(0x1cc)]['reason']==_0x497e94(0x2b9))_0x309b3e[_0x497e94(0x1e6)](_0x497e94(0x1f3),{'access':devices[_0x511041][_0x497e94(0x1cc)]});else devices[_0x511041]['access'][_0x497e94(0x229)]&&devices[_0x511041][_0x497e94(0x1cc)][_0x497e94(0x2d7)]==_0x497e94(0x296)&&(getClientsWithUuid(_0x511041)[_0x497e94(0x27b)](_0x2a3684=>{setAccess(_0x2a3684);}),setTokenRefresh(_0x511041),setSessionTimeout(_0x497e94(0x262),_0x511041));}}else logging(_0x497e94(0x2e9));}),_0x309b3e['on']('reset-password',()=>{resetPassword();}),_0x309b3e['on'](_0x307849(0x2bb),_0x55111a=>{removeClient(_0x309b3e['id']);});}}});}function initClient(_0x5d7618){const _0x276998=_0x3ce4fe;if(_0x5d7618!='botmanager'&&config[_0x276998(0x27f)]!=''){if(pid[_0x5d7618])pid[_0x5d7618][_0x276998(0x206)]({'function':_0x276998(0x274),'args':null});}}function getSocket(_0x29d6f0){const _0x2b9e0c=_0x3ce4fe;return io['sockets'][_0x2b9e0c(0x1e3)]['get'](_0x29d6f0);}function setAccess(_0xd79a2a){const _0x3c3198=_0x3ce4fe,_0x3ff7d4=getSocket(_0xd79a2a['id']),_0x2c5ff6=_0xd79a2a[_0x3c3198(0x282)],_0x2cdc7e=_0xd79a2a[_0x3c3198(0x277)];devices[_0x2c5ff6][_0x3c3198(0x1cc)]=validateAccess(devices[_0x2c5ff6]['access'][_0x3c3198(0x273)],_0x2c5ff6),_0x3ff7d4['join'](_0x2c5ff6);if(devices[_0x2c5ff6][_0x3c3198(0x1cc)][_0x3c3198(0x229)]){_0x3ff7d4[_0x3c3198(0x2c0)](_0x2cdc7e);if(_0x2cdc7e=='botmanager')initializeSocketBotManager(_0x3ff7d4);else initializeSocketBot(_0x3ff7d4);initClient(_0x2cdc7e);}devices[_0x2c5ff6][_0x3c3198(0x1cc)][_0x3c3198(0x273)]&&devices[_0x2c5ff6][_0x3c3198(0x1cc)]['reason']==_0x3c3198(0x232)&&setSessionTimeout(_0x3c3198(0x242),_0x2c5ff6),devices[_0x2c5ff6][_0x3c3198(0x1cc)][_0x3c3198(0x273)]&&devices[_0x2c5ff6][_0x3c3198(0x1cc)][_0x3c3198(0x2d7)]==_0x3c3198(0x1f2)&&setSessionTimeout(_0x3c3198(0x262),_0x2c5ff6),_0x3ff7d4[_0x3c3198(0x1e6)]('status',{'status':_0xd79a2a['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2c5ff6][_0x3c3198(0x1cc)],'externalip':devices[_0x2c5ff6]['ip'],'publicKey':secure[_0x3c3198(0x241)],'validInstallation':validInstallation}),devices[_0x2c5ff6][_0x3c3198(0x1cc)][_0x3c3198(0x229)]==![]&&devices[_0x2c5ff6][_0x3c3198(0x1cc)][_0x3c3198(0x2d7)]==_0x3c3198(0x1b6)&&temporaryAccess2FA(_0x2c5ff6,devices[_0x2c5ff6]['ip']);}function _0x3590(){const _0x4ab72c=['whitelist','catch','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','apiKey','add','pidExpireLogin','uuid','/:bot/support','value','SIGTERM','Invalid\x20Telegram\x20token','child_process','apply','success','404\x20Not\x20Found','/:bot/configuration','listen','Allow\x20login\x20from\x20IP\x20address\x20<b>','referer','2913340jvyHiS','Notifications\x20enabled\x0a','show','existsSync','includes','login\x20required','getTime','login\x20token\x20generated','search','4958178EGiKOy','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','delete-alerts','Ok,\x20will\x20send\x20order\x20notifications\x20only','padStart','connection','127.0.0.1','-results.json','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','log','bb-config.json','function','headers','/:bot/portfolio','chat','mkdirSync','write','isDirectory','bb-settings.json','analytics','/:bot/coins','showname','set','build','toString','isIPv4MappedAddress','keys','hex','RSA','express','-performance.json','store-headless','get-starting-balances','invalid\x20credentials','compareSync','disconnect','getMinutes','Unauthorized\x20attempt\x20to\x20delete\x20bot','exit','settings','join','order','host','bbPassword','Login\x20rejected','bb/','telegramIpApproval','all','6suXJKd','remove','store-configuration','defaults','connected','decrypt','timestamp','bot-','/on\x20-\x20start\x20bot(s)\x0a','running','\x20/\x20','temporaryAccessAllowed','static','from','blacklist','reason','event','Password\x20reset\x20rejected','getSeconds','unlinkSync','secret','UA-192771731-1','Invalid\x20username\x20or\x20IP\x20address','build2','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','telegramToken','auth','split','9935991UXtFVC','clients','deleted\x20Bot\x20','botID','Unauthorized\x20login\x20attempt\x20(timeout)','enabled','exp','version','disabled','/enable\x20-\x20enable\x20notifications\x0a','lowdb/adapters/FileSync','telegram2FaApproval','@analytics/google-analytics','answerCallbackQuery',',\x20must\x20be\x20a\x204\x20digit\x20number','/restart\x20-\x20restart\x20bot(s)\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Access\x20enabled\x20for\x20','getHours','remoteAddress','bcryptjs','node-telegram-bot-api','assign','version.json','path','kill','Unauthorized\x20attempt\x20to\x20update\x20bot','Balance\x20Bot\x20Server','toIPv4MappedAddress','2FA\x20required','loginRequired','kind','Login\x20accepted','stop','ipaddr.js','reject','crypto','data','user','botmanager','whitelistEnabled','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','getPortfolio','telegramUsername','config/','yes','update-bot','username','logged\x20out','randomBytes','access','1000','5\x20min','get-logs','getDate','\x20>\x20','telegram','alerts','26528HtJdwR','type','308488IEPPND','Notifications\x20types:\x20','live','http','generateKeyPairAsync','SIGINT','Orders','conn','starting\x20new\x20bot\x20|\x20Bot\x20','getUTCHours','No\x20authentication\x20token','(((.+)+)+)+$','then','sockets','getMonth','reload','emit',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','************','::ffff:127.0.0.1','<b>Balance\x20Bot\x20status:</b>\x0a','</b>\x20?','placeOrder','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','stopped','botname','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','2FA\x20login\x20token\x20generated','status','\x20|\x20','424240NFFIef','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','telegramEvents','started','starting\x20bot\x20|\x20Bot\x20','removeListener','parse','/off\x20-\x20stop\x20bot(s)\x0a','clientip','lowdb','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','length','encryptedUuid','sortBy','telegramChatId','idling\x20bot\x20\x20\x20|\x20Bot\x20','privateKey','send','handshake','Unauthorized\x20attempt\x20to\x20update\x20settings','copyFileSync',':\x20Bot\x20Mgr\x20>\x20','onText','toIPv4Address','update-bb','inherit','3000','password','f2aRequired','hasOwnProperty','\x20only\x0a','login\x20not\x20required','30\x20min','test','hashSync','Unauthorized\x20attempt\x20to\x20get\x20logs','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','expiry','page','place-order','getFullYear','User\x20has\x20been\x20validated','fork','filter','secure','Unauthorized\x20attempt\x20to\x20log\x20out','temporary\x20access\x20rejected','message','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','sendMessage','yargs/yargs','RSA-OAEP','allow','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','<b>Telegram\x20bot\x20status:</b>\x0a','stopPolling','/:bot/history','new-disabled','deleteHistoryAlerts','callback_query','temporary\x20access\x20not\x20allowed','temporary\x20token\x20generated','2FA\x20login\x20required','cancel-loading','new','All\x20bots','sendFile','bots','bot.js','push','error\x20while\x20deleting\x20config\x20files:\x20','sign','Unauthorized\x20attempt\x20to\x20add\x20bot','HTML','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','publicKey','2FA','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','orders','timeshift','map','/disable\x20-\x20disable\x20notifications\x0a','find','Balance\x20Bot','pidRefreshToken','error','socket.io','Crypt','polling_error','temporary\x20access\x20timeout','delete-bot','disabled\x20Bot\x20','15\x20min','settings.','emitHistory','name','login\x20token\x20valid','ipv6','get','Invalid\x20authentication\x20token\x20(1)','entries','Notifications\x20disabled\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','default','createServer','match','1954468NuOuRz','Invalid\x20authentication\x20token\x20(2)','login','bbUsername','isValid','restart','get-portfolio','-config.json','You\x20can\x20use\x20the\x20following\x20commands:\x0a','notification','telegramEnabled','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Invalid\x20IP\x20address','index.html','use','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','getStartingBalances','2219UUOwsB','once','token','initclient','Unauthorized\x20attempt\x20to\x20get\x20portfolio','-----------------------------------------------------------------------------------','bot','enabled\x20Bot\x20','Bot\x20','argv','forEach'];_0x3590=function(){return _0x4ab72c;};return _0x3590();}function setSessionTimeout(_0x5d524f,_0x58686f){const _0x229f22=_0x3ce4fe;let _0x470280;if(_0x5d524f==_0x229f22(0x262))_0x470280=loginExpiry*0x3c*0x3e8;else _0x470280=devices[_0x58686f][_0x229f22(0x2c6)]['expiry']*0x3c*0x3e8-(new Date()[_0x229f22(0x295)]()-devices[_0x58686f]['telegramIpApproval']['timestamp']);if(devices[_0x58686f][_0x229f22(0x281)])clearTimeout(devices[_0x58686f][_0x229f22(0x281)]);devices[_0x58686f][_0x229f22(0x281)]=setTimeout(()=>{const _0x23c00f=_0x229f22;if(devices[_0x58686f]['pidRefreshToken'])clearTimeout(devices[_0x58686f]['pidRefreshToken']);removeSocketListeners(_0x58686f),addBlacklist(_0x58686f),devices[_0x58686f][_0x23c00f(0x2c6)]=null,devices[_0x58686f][_0x23c00f(0x2f0)]=null,devices[_0x58686f]['access'][_0x23c00f(0x273)]=null,devices[_0x58686f][_0x23c00f(0x1cc)]=validateAccess(devices[_0x58686f][_0x23c00f(0x1cc)][_0x23c00f(0x273)],_0x58686f),!(devices[_0x58686f]['access'][_0x23c00f(0x229)]&&devices[_0x58686f][_0x23c00f(0x1cc)]['reason']=='login\x20not\x20required')&&(_0x5d524f==_0x23c00f(0x262)?io['to'](_0x58686f)['emit'](_0x23c00f(0x1f3),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x58686f)[_0x23c00f(0x1e6)](_0x23c00f(0x1f3),{'access':{'allow':![],'reason':_0x23c00f(0x24f),'token':null}})),devices[_0x58686f]['access']['token']=null;},_0x470280);}function setTokenRefresh(_0x311852){const _0x38b353=_0x3ce4fe;if(devices[_0x311852][_0x38b353(0x24a)])clearTimeout(devices[_0x311852][_0x38b353(0x24a)]);devices[_0x311852][_0x38b353(0x24a)]=setTimeout(()=>{const _0x593645=_0x38b353;getClientsWithUuid(_0x311852)[_0x593645(0x200)]!=0x0?(devices[_0x311852][_0x593645(0x1cc)]=refreshToken(_0x311852),io['to'](_0x311852)[_0x593645(0x1e6)]('status',{'status':_0x593645(0x2cc),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x311852]['access'],'externalip':devices[_0x311852]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x311852)):clearTimeout(devices[_0x311852][_0x593645(0x24a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x25704a){const _0x4285b6=_0x3ce4fe,_0x13ead2=getClient(_0x25704a['id'])[_0x4285b6(0x282)];_0x25704a['emit'](_0x4285b6(0x238),config),_0x25704a['emit'](_0x4285b6(0x2bf),cleanSettings()),_0x25704a['on']('add-bot',_0x4a5b72=>{const _0x422480=_0x4285b6;if(validateAccess(_0x4a5b72,_0x13ead2)[_0x422480(0x229)])addBot();else logging(_0x422480(0x23d));}),_0x25704a['on'](_0x4285b6(0x1c8),(_0x556d97,_0xa95233)=>{const _0x533134=_0x4285b6;if(validateAccess(_0xa95233,_0x13ead2)[_0x533134(0x229)])toggleBot(_0x556d97[_0x533134(0x2e8)],_0x556d97['status'],_0x556d97[_0x533134(0x1d8)]);else logging(_0x533134(0x1b3));}),_0x25704a['on'](_0x4285b6(0x250),(_0x21c7b3,_0x3d54a8)=>{const _0x2c9640=_0x4285b6;if(validateAccess(_0x3d54a8,_0x13ead2)[_0x2c9640(0x229)])deleteBot(_0x21c7b3);else logging(_0x2c9640(0x2bd));}),_0x25704a['on']('store-settings',(_0xa31039,_0x1eb1dd)=>{const _0x3b8c3b=_0x4285b6;if(validateAccess(_0x1eb1dd,_0x13ead2)[_0x3b8c3b(0x229)])storeSettings(_0xa31039,!![]);else logging(_0x3b8c3b(0x208));}),_0x25704a['on'](_0x4285b6(0x20d),_0x4b70f0=>{const _0x46f37b=_0x4285b6;if(validateAccess(_0x4b70f0,_0x13ead2)[_0x46f37b(0x229)])updateBB();else logging(_0x46f37b(0x219));}),_0x25704a['on']('logout',_0x531ae6=>{const _0x544bd3=_0x4285b6;if(validateAccess(_0x531ae6,_0x13ead2)['allow']){if(devices[_0x13ead2][_0x544bd3(0x24a)])clearTimeout(devices[_0x13ead2][_0x544bd3(0x24a)]);if(devices[_0x13ead2][_0x544bd3(0x281)])clearTimeout(devices[_0x13ead2][_0x544bd3(0x281)]);removeSocketListeners(getClient(_0x25704a['id'])[_0x544bd3(0x282)]),addBlacklist(_0x13ead2),devices[_0x13ead2][_0x544bd3(0x2c6)]=null,devices[_0x13ead2][_0x544bd3(0x2f0)]=null,devices[_0x13ead2][_0x544bd3(0x1cc)][_0x544bd3(0x273)]=null,io['to'](getClient(_0x25704a['id'])[_0x544bd3(0x282)])['emit']('status',{'access':{'allow':![],'reason':_0x544bd3(0x1ca),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x458f7c){const _0x197282=_0x3ce4fe,_0x5b03bd=getClient(_0x458f7c['id'])[_0x197282(0x277)],_0x4832f9=getClient(_0x458f7c['id'])[_0x197282(0x282)];_0x458f7c['on'](_0x197282(0x1cf),(_0x345158,_0x387f36)=>{const _0x493c3=_0x197282;if(validateAccess(_0x387f36,_0x4832f9)[_0x493c3(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd]['send']({'function':_0x493c3(0x254),'args':_0x345158});}else logging(_0x493c3(0x218));}),_0x458f7c['on'](_0x197282(0x29a),(_0x58cc5f,_0x44ed7a)=>{const _0x30d36a=_0x197282;if(validateAccess(_0x44ed7a,_0x4832f9)[_0x30d36a(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd]['send']({'function':_0x30d36a(0x22f),'args':_0x58cc5f});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x458f7c['on'](_0x197282(0x266),(_0xc6eb5,_0x3878be)=>{const _0x460193=_0x197282;if(validateAccess(_0x3878be,_0x4832f9)[_0x460193(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd][_0x460193(0x206)]({'function':_0x460193(0x1c4),'args':_0xc6eb5});}else logging(_0x460193(0x275));}),_0x458f7c['on'](_0x197282(0x2ca),(_0x1ea903,_0x455702)=>{const _0x37b1da=_0x197282;if(validateAccess(_0x455702,_0x4832f9)[_0x37b1da(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd][_0x37b1da(0x206)]({'function':'storeConfiguration','args':_0x1ea903});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x458f7c['on'](_0x197282(0x2b7),(_0x57a846,_0x2e42bb)=>{const _0x54a0ad=_0x197282;if(validateAccess(_0x2e42bb,_0x4832f9)[_0x54a0ad(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd][_0x54a0ad(0x206)]({'function':'storeHeadless','args':_0x57a846});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x458f7c['on'](_0x197282(0x2b8),_0x6fab25=>{const _0x25b87e=_0x197282;if(validateAccess(_0x6fab25,_0x4832f9)['allow']){if(pid[_0x5b03bd])pid[_0x5b03bd][_0x25b87e(0x206)]({'function':_0x25b87e(0x270),'args':null});}else logging(_0x25b87e(0x225));}),_0x458f7c['on'](_0x197282(0x21c),(_0x45047b,_0x4d8ee8)=>{const _0x2342bd=_0x197282;if(validateAccess(_0x4d8ee8,_0x4832f9)[_0x2342bd(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd][_0x2342bd(0x206)]({'function':_0x2342bd(0x1ec),'args':_0x45047b});}else logging(_0x2342bd(0x26f));}),_0x458f7c['on'](_0x197282(0x234),_0x3f7dd2=>{const _0x57815a=_0x197282;if(validateAccess(_0x3f7dd2,_0x4832f9)[_0x57815a(0x229)]){if(pid[_0x5b03bd])pid[_0x5b03bd]['send']({'function':'cancelLoading','args':null});}else logging(_0x57815a(0x1f1));}),_0x458f7c['on']('logout',_0x4da2fa=>{const _0x4d029e=_0x197282;if(validateAccess(_0x4da2fa,_0x4832f9)['allow']){if(devices[_0x4832f9]['pidRefreshToken'])clearTimeout(devices[_0x4832f9][_0x4d029e(0x24a)]);if(devices[_0x4832f9][_0x4d029e(0x281)])clearTimeout(devices[_0x4832f9][_0x4d029e(0x281)]);removeSocketListeners(getClient(_0x458f7c['id'])[_0x4d029e(0x282)]),addBlacklist(_0x4832f9),devices[_0x4832f9]['telegramIpApproval']=null,devices[_0x4832f9]['telegram2FaApproval']=null,devices[_0x4832f9]['access']['token']=null,io['to'](getClient(_0x458f7c['id'])['uuid'])[_0x4d029e(0x1e6)](_0x4d029e(0x1f3),{'access':{'allow':![],'reason':_0x4d029e(0x1ca),'token':null}});}else logging(_0x4d029e(0x222));});}function removeSocketListeners(_0xfbd8fb){const _0x475205=_0x3ce4fe;getClientsWithUuid(_0xfbd8fb)[_0x475205(0x27b)](_0x220305=>{getSocket(_0x220305['id'])['removeAllListeners']();});}function cleanSettings(){const _0x3cce6f=_0x3ce4fe;let _0x2ba67c=settings;return settings[_0x3cce6f(0x2e2)]&&settings[_0x3cce6f(0x2e2)]!=''&&(_0x2ba67c={..._0x2ba67c,'telegramToken':'************'}),settings[_0x3cce6f(0x2c3)]&&settings[_0x3cce6f(0x2c3)]!=''&&(_0x2ba67c={..._0x2ba67c,'bbPassword':_0x3cce6f(0x1e8)}),_0x2ba67c;}function updateBB(){const _0x433102=_0x3ce4fe;installingUpdate=!![],config[_0x433102(0x27b)](_0x5e590b=>{restartBot(_0x5e590b['botID']);}),process[_0x433102(0x206)]({'update':!![]},_0x1b07e9=>{});}function startBot(_0x41921e,_0x31d00e,_0x2189f4){const _0x431ac5=_0x3ce4fe;let _0x22de37=![];const _0x48268a=_0x41921e[0x0];_0x31d00e={..._0x31d00e,'stdio':[_0x431ac5(0x20e),_0x431ac5(0x20e),_0x431ac5(0x20e),'ipc']},pid[_0x48268a]=childProcess[_0x431ac5(0x21f)](botfile,_0x41921e,_0x31d00e),pid[_0x48268a]['on'](_0x431ac5(0x224),_0x1a48ee=>{const _0xb04ee4=_0x431ac5;switch(Object[_0xb04ee4(0x2b2)](_0x1a48ee)[0x0]){case _0xb04ee4(0x1ef):updateBotName(_0x48268a,_0x1a48ee['botname']);break;case _0xb04ee4(0x1f3):updateStatus(_0x48268a,_0x1a48ee[_0xb04ee4(0x1f3)]);break;case _0xb04ee4(0x1d8):updateLive(_0x48268a,_0x1a48ee[_0xb04ee4(0x1d8)]);break;case _0xb04ee4(0x1f8):updateLive(_0x48268a,_0x1a48ee[_0xb04ee4(0x1f8)]),io['to'](_0x48268a)[_0xb04ee4(0x1e6)](_0xb04ee4(0x1f3),{'access':{'allow':![],'reason':_0xb04ee4(0x1e5),'token':null}});break;case _0xb04ee4(0x1ba):_0x1a48ee[_0xb04ee4(0x1ba)]==_0xb04ee4(0x265)&&restartBot(_0x48268a);_0x1a48ee[_0xb04ee4(0x1ba)]=='kill'&&toggleBot(_0x48268a,_0xb04ee4(0x2ed),_0xb04ee4(0x1ee));break;case _0xb04ee4(0x1d2):sendTelegram(_0x48268a,_0x1a48ee['telegram']);break;case _0xb04ee4(0x2a3):io['to'](_0x48268a)[_0xb04ee4(0x1e6)](_0x1a48ee[_0xb04ee4(0x2a3)],_0x1a48ee['args']);break;}}),pid[_0x48268a]['on'](_0x431ac5(0x24b),function(_0x4ee93e){if(_0x22de37)return;_0x22de37=!![],_0x2189f4(_0x4ee93e);}),pid[_0x48268a]['on'](_0x431ac5(0x2be),function(_0xe11160){const _0x2772f9=_0x431ac5;if(installingUpdate)return;if(_0x22de37)return;_0x22de37=!![],_0x2189f4(null);const _0x2c975c=dbConfig[_0x2772f9(0x258)](_0x2772f9(0x238))[_0x2772f9(0x248)]({'botID':_0x48268a})[_0x2772f9(0x284)]();_0x2c975c&&(_0x2c975c[_0x2772f9(0x1f3)]==_0x2772f9(0x2ea)||_0x2c975c[_0x2772f9(0x1f3)]=='new')&&(updateLive(_0x48268a,_0x2772f9(0x1ee)),logging('restarting\x20Bot\x20'+_0x48268a),startBot([_0x48268a,userID],{'cwd':bbpath},function(_0x334d39){if(_0x334d39)logging(_0x334d39);}));});}function stopBot(_0x22b1ae){const _0x42aa68=_0x3ce4fe;getClientsWithBotID(_0x22b1ae)['forEach'](_0x5128a9=>{const _0x4ae05c=_0x4840;getSocket(_0x5128a9['id'])[_0x4ae05c(0x2bb)](!![]),removeClient(_0x5128a9['id']);});if(pid[_0x22b1ae])pid[_0x22b1ae][_0x42aa68(0x1b2)]();}function restartBot(_0x3502b6){if(pid[_0x3502b6])pid[_0x3502b6]['kill']();}function addBot(){const _0x2cb091=_0x3ce4fe;let _0x2b8bdd;for(let _0x4de4ea=0x1;_0x4de4ea<0x3e9;_0x4de4ea++){_0x2b8bdd=_0x4de4ea['toString']()['padStart'](0x3,'0');let _0x51a061=config['find'](_0x3ecc38=>_0x3ecc38[_0x2cb091(0x2e8)]==_0x2b8bdd);if(!_0x51a061)break;}if(_0x2b8bdd===_0x2cb091(0x1cd)){logging(_0x2cb091(0x243));return;}logging(_0x2cb091(0x1de)+_0x2b8bdd),dbConfig[_0x2cb091(0x258)]('bots')[_0x2cb091(0x23a)]({'botID':_0x2b8bdd,'botname':_0x2cb091(0x279)+_0x2b8bdd,'status':_0x2cb091(0x235),'live':''})[_0x2cb091(0x2a8)](),startBot([_0x2b8bdd,userID],{'cwd':bbpath},function(_0x36b723){if(_0x36b723)logging(_0x36b723);}),config=getConfiguration(),io['to'](_0x2cb091(0x1c0))['emit'](_0x2cb091(0x238),config);}function deleteBot(_0x27daa6){const _0x2302b3=_0x3ce4fe;getClientsWithBotID(_0x27daa6)[_0x2302b3(0x27b)](_0x16ee16=>{const _0x244821=_0x2302b3;getSocket(_0x16ee16['id'])[_0x244821(0x2bb)](!![]),removeClient(_0x16ee16['id']);}),dbConfig[_0x2302b3(0x258)]('bots')['remove']({'botID':_0x27daa6})[_0x2302b3(0x2a8)](),logging(_0x2302b3(0x2e7)+_0x27daa6),stopBot(_0x27daa6);try{fs['unlinkSync'](path[_0x2302b3(0x2c0)](configpath,'bot-'+_0x27daa6+_0x2302b3(0x267))),fs[_0x2302b3(0x2db)](path[_0x2302b3(0x2c0)](configpath,_0x2302b3(0x2cf)+_0x27daa6+'-events.json')),fs['unlinkSync'](path[_0x2302b3(0x2c0)](configpath,_0x2302b3(0x2cf)+_0x27daa6+_0x2302b3(0x2b6))),fs['unlinkSync'](path[_0x2302b3(0x2c0)](configpath,_0x2302b3(0x2cf)+_0x27daa6+_0x2302b3(0x29f)));}catch(_0xec8a31){if(_0xec8a31)logging(_0x2302b3(0x23b),_0xec8a31);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x2302b3(0x238),config);}function toggleBot(_0x18c721,_0x26fb0f,_0x579687){const _0x4b5f82=_0x3ce4fe;dbConfig['get'](_0x4b5f82(0x238))[_0x4b5f82(0x248)]({'botID':_0x18c721})[_0x4b5f82(0x2fb)]({'status':_0x26fb0f})[_0x4b5f82(0x2fb)]({'live':_0x579687})[_0x4b5f82(0x2a8)]();if(_0x26fb0f==_0x4b5f82(0x2ea)||_0x26fb0f=='new')logging(_0x4b5f82(0x278)+_0x18c721),startBot([_0x18c721,userID],{'cwd':bbpath},function(_0x24252f){if(_0x24252f)logging(_0x24252f);});else(_0x26fb0f==_0x4b5f82(0x2ed)||_0x26fb0f==_0x4b5f82(0x22e))&&(logging(_0x4b5f82(0x251)+_0x18c721),stopBot(_0x18c721));config=getConfiguration(),io['to']('botmanager')[_0x4b5f82(0x1e6)]('bots',config);}function toggleStatus(_0x212af2){const _0x317760=_0x3ce4fe;let _0xdd82f8=dbConfig['get'](_0x317760(0x238))[_0x317760(0x248)]({'botID':_0x212af2})[_0x317760(0x284)](),_0x42d465;if(_0xdd82f8[_0x317760(0x1f3)]==='enabled')_0x42d465=_0x317760(0x2ed);else{if(_0xdd82f8[_0x317760(0x1f3)]===_0x317760(0x235))_0x42d465=_0x317760(0x22e);else{if(_0xdd82f8[_0x317760(0x1f3)]==='new-disabled')_0x42d465='new';else{if(_0xdd82f8['status']===_0x317760(0x2ed))_0x42d465=_0x317760(0x2ea);}}}return _0x42d465;}function updateStatus(_0xbc9f7d,_0x4ad3ef){const _0x40b296=_0x3ce4fe;dbConfig['get'](_0x40b296(0x238))['find']({'botID':_0xbc9f7d})['assign']({'status':_0x4ad3ef})[_0x40b296(0x2a8)](),config=getConfiguration(),io['to'](_0x40b296(0x1c0))[_0x40b296(0x1e6)](_0x40b296(0x238),config);}function updateLive(_0x33e3b1,_0x228289){const _0x2abc83=_0x3ce4fe;dbConfig[_0x2abc83(0x258)](_0x2abc83(0x238))['find']({'botID':_0x33e3b1})[_0x2abc83(0x2fb)]({'live':_0x228289})['write'](),config=getConfiguration(),io['to'](_0x2abc83(0x1c0))['emit'](_0x2abc83(0x238),config);}function updateBotName(_0x256cc3,_0x26ea9f){const _0xed321f=_0x3ce4fe;dbConfig[_0xed321f(0x258)]('bots')[_0xed321f(0x248)]({'botID':_0x256cc3})[_0xed321f(0x2fb)]({'botname':_0x26ea9f})['write'](),config=getConfiguration(),io['to'](_0xed321f(0x1c0))[_0xed321f(0x1e6)](_0xed321f(0x238),config);}function telegramError(_0x12a656){const _0x3c69e7=_0x3ce4fe;console[_0x3c69e7(0x2a1)](getTimeStamp()+_0x3c69e7(0x1e7));}function validateTelegram(_0x722b56){const _0x2c43f9=_0x3ce4fe;if(_0x722b56['from'][_0x2c43f9(0x1c9)]!=settings['telegramUsername']&&'@'+_0x722b56[_0x2c43f9(0x2d5)][_0x2c43f9(0x1c9)]!=settings[_0x2c43f9(0x1c5)])return tgBot[_0x2c43f9(0x226)](_0x722b56[_0x2c43f9(0x2a6)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})['catch'](_0x3f3e05=>{telegramError(_0x3f3e05);}),![];return!![];}async function initTelegram(){const _0x1a3b3d=_0x3ce4fe;if(tgBot)tgBot[_0x1a3b3d(0x22c)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1a3b3d(0x2e2)],{'polling':!![]});let _0x3475e8=_0x1a3b3d(0x268);_0x3475e8+='\x0a',_0x3475e8+=_0x1a3b3d(0x2ee),_0x3475e8+=_0x1a3b3d(0x247),_0x3475e8+=_0x1a3b3d(0x23f),_0x3475e8+=_0x1a3b3d(0x2f4),_0x3475e8+=_0x1a3b3d(0x2d0),_0x3475e8+=_0x1a3b3d(0x1fc),_0x3475e8+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x3475e8+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x511ec5=_0x1a3b3d(0x299);_0x511ec5+='\x0a',_0x511ec5+=_0x3475e8,tgBot[_0x1a3b3d(0x20b)](/\/start/,_0x27528a=>{const _0x1146ed=_0x1a3b3d;if(!validateTelegram(_0x27528a))return;if(settings[_0x1146ed(0x203)]!=_0x27528a[_0x1146ed(0x2a6)]['id'])updateSetting(_0x1146ed(0x203),_0x27528a[_0x1146ed(0x2a6)]['id']);updateSetting(_0x1146ed(0x26a),!![]),tgBot[_0x1146ed(0x226)](_0x27528a[_0x1146ed(0x2a6)]['id'],_0x511ec5)[_0x1146ed(0x27d)](_0xc7fd91=>{telegramError(_0xc7fd91);});}),tgBot[_0x1a3b3d(0x20b)](/\/enable/,_0x4cb5cb=>{const _0xe4634b=_0x1a3b3d;if(!validateTelegram(_0x4cb5cb))return;if(settings[_0xe4634b(0x203)]!=_0x4cb5cb[_0xe4634b(0x2a6)]['id'])updateSetting('telegramChatId',_0x4cb5cb['chat']['id']);updateSetting(_0xe4634b(0x26a),!![]),tgBot[_0xe4634b(0x226)](_0x4cb5cb[_0xe4634b(0x2a6)]['id'],'Notifications\x20enabled')[_0xe4634b(0x27d)](_0x1e589c=>{telegramError(_0x1e589c);});}),tgBot[_0x1a3b3d(0x20b)](/\/config/,async _0x293057=>{const _0x214afe=_0x1a3b3d;if(!validateTelegram(_0x293057))return;tgBot['removeListener']('callback_query'),tgBot['sendMessage'](_0x293057[_0x214afe(0x2a6)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x214afe(0x1dc),'callback_data':'orders'},{'text':'Alerts','callback_data':'alerts'},{'text':'All','callback_data':_0x214afe(0x2c7)}]]}})[_0x214afe(0x27d)](_0x3cfb51=>{telegramError(_0x3cfb51);}),tgBot['on']('callback_query',async _0x514658=>{const _0x2f7264=_0x214afe,_0x407c68=_0x514658[_0x2f7264(0x1be)],_0xa6dfc0=_0x514658[_0x2f7264(0x224)];tgBot['answerCallbackQuery'](_0x514658['id'])['then'](async()=>{const _0x203375=_0x2f7264;_0x407c68=='orders'&&(updateSetting(_0x203375(0x1f7),_0x203375(0x244)),updateSetting(_0x203375(0x26a),!![]),await tgBot['sendMessage'](_0xa6dfc0[_0x203375(0x2a6)]['id'],_0x203375(0x29b))[_0x203375(0x27d)](_0x5557fe=>{telegramError(_0x5557fe);}));_0x407c68==_0x203375(0x1d3)&&(updateSetting('telegramEvents',_0x203375(0x1d3)),updateSetting(_0x203375(0x26a),!![]),await tgBot['sendMessage'](_0xa6dfc0[_0x203375(0x2a6)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')['catch'](_0x515e2a=>{telegramError(_0x515e2a);}));_0x407c68=='all'&&(updateSetting('telegramEvents',_0x203375(0x2c7)),updateSetting(_0x203375(0x26a),!![]),await tgBot[_0x203375(0x226)](_0xa6dfc0['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x203375(0x27d)](_0x408fa4=>{telegramError(_0x408fa4);}));if(!settings['telegramChatId'])tgBot[_0x203375(0x226)](_0xa6dfc0[_0x203375(0x2a6)]['id'],_0x203375(0x240))['catch'](_0x534973=>{telegramError(_0x534973);});}),tgBot[_0x2f7264(0x1fa)](_0x2f7264(0x230));});}),tgBot[_0x1a3b3d(0x20b)](/\/status/,_0x2acc7a=>{const _0x3aca22=_0x1a3b3d;if(!validateTelegram(_0x2acc7a))return;let _0x2b3927=_0x3aca22(0x1ea);config[_0x3aca22(0x27b)](_0x2a44df=>{const _0x4028d6=_0x3aca22;_0x2b3927+=_0x4028d6(0x279)+_0x2a44df[_0x4028d6(0x2e8)]+'\x20|\x20'+_0x2a44df[_0x4028d6(0x1ef)]+':\x20'+_0x2a44df[_0x4028d6(0x1f3)]+_0x4028d6(0x2d2)+_0x2a44df[_0x4028d6(0x1d8)]+'\x0a';}),_0x2b3927+='\x0a',_0x2b3927+=_0x3aca22(0x22b),_0x2b3927+=!settings[_0x3aca22(0x26a)]?_0x3aca22(0x25b):_0x3aca22(0x290),_0x2b3927+=settings[_0x3aca22(0x26a)]?settings[_0x3aca22(0x1f7)]==_0x3aca22(0x2c7)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x3aca22(0x1d7)+settings[_0x3aca22(0x1f7)]+_0x3aca22(0x213):'',tgBot[_0x3aca22(0x226)](_0x2acc7a['chat']['id'],_0x2b3927,{'parse_mode':_0x3aca22(0x23e)})[_0x3aca22(0x27d)](_0x287cdf=>{telegramError(_0x287cdf);});}),tgBot[_0x1a3b3d(0x20b)](/\/restart/,_0x15498d=>{const _0x43f6b5=_0x1a3b3d;if(!validateTelegram(_0x15498d))return;tgBot[_0x43f6b5(0x1fa)](_0x43f6b5(0x230));const _0x21852a=getEnabledBots();if(_0x21852a[_0x43f6b5(0x200)]==0x0)tgBot[_0x43f6b5(0x226)](_0x15498d[_0x43f6b5(0x2a6)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x43f6b5(0x27d)](_0x44b077=>{telegramError(_0x44b077);});else{if(_0x21852a[_0x43f6b5(0x200)]>0x1)_0x21852a[_0x43f6b5(0x23a)]({'botID':_0x43f6b5(0x2c7)});let _0x234417=[],_0x251c4c=[];const _0x38f5aa=_0x21852a[_0x43f6b5(0x200)]%0x4==0x0||_0x21852a['length']%0x4==0x3||_0x21852a[_0x43f6b5(0x200)]%0x3==0x1?0x4:0x3;let _0x249cd9=0x0;_0x21852a[_0x43f6b5(0x27b)]((_0x125db6,_0x1d15b1)=>{const _0x1ec28a=_0x43f6b5;if(_0x1d15b1%_0x38f5aa==0x0)_0x251c4c=[];_0x251c4c[_0x1ec28a(0x23a)]({'text':_0x125db6[_0x1ec28a(0x2e8)]==_0x1ec28a(0x2c7)?_0x1ec28a(0x236):_0x1ec28a(0x279)+_0x125db6['botID'],'callback_data':_0x125db6[_0x1ec28a(0x2e8)]}),_0x1d15b1%_0x38f5aa==0x0&&(_0x234417[_0x249cd9]=_0x251c4c,_0x249cd9++);}),tgBot[_0x43f6b5(0x226)](_0x15498d[_0x43f6b5(0x2a6)]['id'],_0x43f6b5(0x2a0),{'reply_markup':{'inline_keyboard':_0x234417}})[_0x43f6b5(0x27d)](_0x58df6e=>{telegramError(_0x58df6e);}),tgBot['on'](_0x43f6b5(0x230),async _0x309328=>{const _0xb13354=_0x43f6b5,_0x295927=_0x309328['data'],_0x4e981b=_0x309328['message'];tgBot[_0xb13354(0x2f2)](_0x309328['id'])[_0xb13354(0x1e2)](async()=>{const _0x4d5417=_0xb13354;if(_0x295927==_0x4d5417(0x2c7)){if(settings[_0x4d5417(0x1f7)]==_0x4d5417(0x244))tgBot[_0x4d5417(0x226)](_0x4e981b[_0x4d5417(0x2a6)]['id'],_0x4d5417(0x2e1))['catch'](_0x4690b9=>{telegramError(_0x4690b9);});config[_0x4d5417(0x27b)](_0x39b61e=>{const _0x3987d8=_0x4d5417;restartBot(_0x39b61e[_0x3987d8(0x2e8)]);});}else{if(settings[_0x4d5417(0x1f7)]==_0x4d5417(0x244))tgBot[_0x4d5417(0x226)](_0x4e981b['chat']['id'],_0x4d5417(0x1f6)+_0x295927)['catch'](_0x513e68=>{telegramError(_0x513e68);});restartBot(_0x295927);}}),tgBot[_0xb13354(0x1fa)](_0xb13354(0x230));});}}),tgBot['onText'](/\/on/,_0x157c2b=>{const _0x5a79ac=_0x1a3b3d;if(!validateTelegram(_0x157c2b))return;tgBot[_0x5a79ac(0x1fa)](_0x5a79ac(0x230));const _0x1ac9d0=getDisabledBots();if(_0x1ac9d0[_0x5a79ac(0x200)]==0x0)tgBot[_0x5a79ac(0x226)](_0x157c2b[_0x5a79ac(0x2a6)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x5a79ac(0x27d)](_0x35e078=>{telegramError(_0x35e078);});else{if(_0x1ac9d0['length']>0x1)_0x1ac9d0[_0x5a79ac(0x23a)]({'botID':_0x5a79ac(0x2c7)});let _0x424f23=[],_0x313e08=[];const _0x4ef0f7=_0x1ac9d0[_0x5a79ac(0x200)]%0x4==0x0||_0x1ac9d0[_0x5a79ac(0x200)]%0x4==0x3||_0x1ac9d0[_0x5a79ac(0x200)]%0x3==0x1?0x4:0x3;let _0x453447=0x0;_0x1ac9d0[_0x5a79ac(0x27b)]((_0x28d879,_0x11d303)=>{const _0x2294eb=_0x5a79ac;if(_0x11d303%_0x4ef0f7==0x0)_0x313e08=[];_0x313e08['push']({'text':_0x28d879['botID']==_0x2294eb(0x2c7)?_0x2294eb(0x236):'Bot\x20'+_0x28d879['botID'],'callback_data':_0x28d879[_0x2294eb(0x2e8)]}),_0x11d303%_0x4ef0f7==0x0&&(_0x424f23[_0x453447]=_0x313e08,_0x453447++);}),tgBot[_0x5a79ac(0x226)](_0x157c2b['chat']['id'],_0x5a79ac(0x1c2),{'reply_markup':{'inline_keyboard':_0x424f23}})[_0x5a79ac(0x27d)](_0x33759f=>{telegramError(_0x33759f);}),tgBot['on']('callback_query',async _0x4e694c=>{const _0x30c779=_0x5a79ac,_0x77b07f=_0x4e694c[_0x30c779(0x1be)],_0x1da9fb=_0x4e694c[_0x30c779(0x224)];tgBot[_0x30c779(0x2f2)](_0x4e694c['id'])[_0x30c779(0x1e2)](async()=>{const _0x5a6738=_0x30c779;if(_0x77b07f==_0x5a6738(0x2c7)){if(settings[_0x5a6738(0x1f7)]==_0x5a6738(0x244))tgBot[_0x5a6738(0x226)](_0x1da9fb[_0x5a6738(0x2a6)]['id'],_0x5a6738(0x2e0))['catch'](_0x16cc26=>{telegramError(_0x16cc26);});_0x1ac9d0[_0x5a6738(0x27b)](_0x39c81a=>{const _0x5e3bbe=_0x5a6738;if(_0x39c81a[_0x5e3bbe(0x2e8)]!='all')toggleBot(_0x39c81a[_0x5e3bbe(0x2e8)],toggleStatus(_0x39c81a['botID']),_0x5e3bbe(0x1ee));});}else{if(settings['telegramEvents']==_0x5a6738(0x244))tgBot[_0x5a6738(0x226)](_0x1da9fb[_0x5a6738(0x2a6)]['id'],_0x5a6738(0x26b)+_0x77b07f)['catch'](_0x556902=>{telegramError(_0x556902);});toggleBot(_0x77b07f,toggleStatus(_0x77b07f),'stopped');}}),tgBot[_0x30c779(0x1fa)]('callback_query');});}}),tgBot[_0x1a3b3d(0x20b)](/\/off/,_0x35ecaf=>{const _0x9386e5=_0x1a3b3d;if(!validateTelegram(_0x35ecaf))return;tgBot[_0x9386e5(0x1fa)](_0x9386e5(0x230));const _0x52f67e=getEnabledBots();if(_0x52f67e[_0x9386e5(0x200)]==0x0)tgBot[_0x9386e5(0x226)](_0x35ecaf[_0x9386e5(0x2a6)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x447732=>{telegramError(_0x447732);});else{if(_0x52f67e[_0x9386e5(0x200)]>0x1)_0x52f67e[_0x9386e5(0x23a)]({'botID':_0x9386e5(0x2c7)});let _0x5102c7=[],_0x26e4a1=[];const _0xb4293a=_0x52f67e['length']%0x4==0x0||_0x52f67e[_0x9386e5(0x200)]%0x4==0x3||_0x52f67e[_0x9386e5(0x200)]%0x3==0x1?0x4:0x3;let _0xd5b82e=0x0;_0x52f67e[_0x9386e5(0x27b)]((_0x417a5f,_0x2a1ddb)=>{const _0x47a125=_0x9386e5;if(_0x2a1ddb%_0xb4293a==0x0)_0x26e4a1=[];_0x26e4a1[_0x47a125(0x23a)]({'text':_0x417a5f[_0x47a125(0x2e8)]==_0x47a125(0x2c7)?_0x47a125(0x236):'Bot\x20'+_0x417a5f[_0x47a125(0x2e8)],'callback_data':_0x417a5f[_0x47a125(0x2e8)]}),_0x2a1ddb%_0xb4293a==0x0&&(_0x5102c7[_0xd5b82e]=_0x26e4a1,_0xd5b82e++);}),tgBot[_0x9386e5(0x226)](_0x35ecaf['chat']['id'],_0x9386e5(0x25c),{'reply_markup':{'inline_keyboard':_0x5102c7}})['catch'](_0x3e57e0=>{telegramError(_0x3e57e0);}),tgBot['on'](_0x9386e5(0x230),async _0x4162a7=>{const _0x40c6b6=_0x9386e5,_0x36d2c4=_0x4162a7['data'],_0x3ac635=_0x4162a7[_0x40c6b6(0x224)];tgBot[_0x40c6b6(0x2f2)](_0x4162a7['id'])[_0x40c6b6(0x1e2)](async()=>{const _0x30b4b6=_0x40c6b6;if(_0x36d2c4==_0x30b4b6(0x2c7)){if(settings[_0x30b4b6(0x1f7)]=='orders')tgBot[_0x30b4b6(0x226)](_0x3ac635[_0x30b4b6(0x2a6)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x17a8cd=>{telegramError(_0x17a8cd);});_0x52f67e[_0x30b4b6(0x27b)](_0x1c48f5=>{const _0x2b15df=_0x30b4b6;if(_0x1c48f5[_0x2b15df(0x2e8)]!=_0x2b15df(0x2c7))toggleBot(_0x1c48f5[_0x2b15df(0x2e8)],toggleStatus(_0x1c48f5[_0x2b15df(0x2e8)]),_0x2b15df(0x1ee));});}else{if(settings[_0x30b4b6(0x1f7)]==_0x30b4b6(0x244))tgBot['sendMessage'](_0x3ac635['chat']['id'],_0x30b4b6(0x1ff)+_0x36d2c4)[_0x30b4b6(0x27d)](_0x1a365e=>{telegramError(_0x1a365e);});toggleBot(_0x36d2c4,toggleStatus(_0x36d2c4),_0x30b4b6(0x1ee));}}),tgBot[_0x40c6b6(0x1fa)](_0x40c6b6(0x230));});}}),tgBot[_0x1a3b3d(0x20b)](/\/disable/,_0x11a7ed=>{const _0x394080=_0x1a3b3d;if(!validateTelegram(_0x11a7ed))return;tgBot[_0x394080(0x226)](_0x11a7ed[_0x394080(0x2a6)]['id'],'Notifications\x20disabled')[_0x394080(0x27d)](_0x2003d6=>{telegramError(_0x2003d6);}),updateSetting(_0x394080(0x26a),![]);}),tgBot[_0x1a3b3d(0x20b)](/\/help/,_0x7bbe3f=>{const _0x5650bd=_0x1a3b3d;if(!validateTelegram(_0x7bbe3f))return;tgBot[_0x5650bd(0x226)](_0x7bbe3f['chat']['id'],_0x3475e8)['catch'](_0x20ab07=>{telegramError(_0x20ab07);});}),tgBot['on'](_0x1a3b3d(0x24e),_0x5ee741=>{const _0x5d69bd=_0x1a3b3d;_0x5ee741[_0x5d69bd(0x2b0)]()[_0x5d69bd(0x293)](_0x5d69bd(0x28a))&&(logging(_0x5d69bd(0x286)),tgBot[_0x5d69bd(0x22c)](),tgBot=null,io['to'](_0x5d69bd(0x1c0))[_0x5d69bd(0x1e6)](_0x5d69bd(0x269),_0x5d69bd(0x286)));}),process[_0x1a3b3d(0x272)](_0x1a3b3d(0x1db),()=>{const _0x495999=_0x1a3b3d;if(tgBot)tgBot[_0x495999(0x22c)]();process[_0x495999(0x2be)](0x1);}),process[_0x1a3b3d(0x272)](_0x1a3b3d(0x285),()=>{const _0x10e83b=_0x1a3b3d;if(tgBot)tgBot[_0x10e83b(0x22c)]();process[_0x10e83b(0x2be)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x2c5dc2,_0x2292aa){const _0x14753f=_0x3ce4fe;if(settings[_0x14753f(0x26a)]){if(settings[_0x14753f(0x1f7)]==_0x14753f(0x2c7)||(_0x2292aa['type']==_0x14753f(0x24b)||_0x2292aa[_0x14753f(0x1d5)]==_0x14753f(0x289))&&settings[_0x14753f(0x1f7)]=='alerts'||_0x2292aa[_0x14753f(0x1d5)]==_0x14753f(0x2c1)&&settings['telegramEvents']==_0x14753f(0x244)){if(tgBot&&settings[_0x14753f(0x203)]){if(_0x2292aa[_0x14753f(0x2ad)])tgBot[_0x14753f(0x226)](settings[_0x14753f(0x203)],_0x2292aa[_0x14753f(0x1ef)]+'\x20>\x20'+_0x2292aa[_0x14753f(0x2d8)])[_0x14753f(0x27d)](_0x200482=>{telegramError(_0x200482);});else tgBot[_0x14753f(0x226)](settings[_0x14753f(0x203)],'Bot\x20'+_0x2c5dc2+_0x14753f(0x1d1)+_0x2292aa[_0x14753f(0x2d8)])['catch'](_0x434cf8=>{telegramError(_0x434cf8);});}}}}function getDeviceWithIp(_0x5b65d5){const _0x62fef9=_0x3ce4fe;return devices[_0x62fef9(0x248)](_0x595f78=>_0x595f78['ip']===_0x5b65d5);}function temporaryAccess2FA(_0x570684,_0x1b0208){const _0x32a490=_0x3ce4fe;let _0x26f86a=new Date(),_0x15a190=![];if(lastIpApproval){if(_0x26f86a-lastIpApproval<0x1388)_0x15a190=!![];}lastIpApproval=new Date();if(_0x15a190)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x32a490(0x1fa)](_0x32a490(0x230)),tgBot[_0x32a490(0x226)](settings[_0x32a490(0x203)],_0x32a490(0x22a)+normalizeIP(_0x1b0208)[_0x32a490(0x291)]+_0x32a490(0x1eb),{'parse_mode':_0x32a490(0x23e),'reply_markup':{'inline_keyboard':[[{'text':_0x32a490(0x1ce),'callback_data':'5'},{'text':_0x32a490(0x252),'callback_data':'15'},{'text':_0x32a490(0x215),'callback_data':'30'},{'text':_0x32a490(0x1bc),'callback_data':_0x32a490(0x1bc)}]]}})[_0x32a490(0x27d)](_0x4e0d5e=>{telegramError(_0x4e0d5e);}),tgBot['on'](_0x32a490(0x230),async _0x38214=>{const _0x2f5a5c=_0x32a490,_0x1f4fcf=_0x38214[_0x2f5a5c(0x1be)],_0x314ee2=_0x38214[_0x2f5a5c(0x224)];tgBot['answerCallbackQuery'](_0x38214['id'])[_0x2f5a5c(0x1e2)](async()=>{const _0x1987c9=_0x2f5a5c;devices[_0x570684][_0x1987c9(0x2c6)]={'clientip':_0x1b0208,'timestamp':new Date()[_0x1987c9(0x295)](),'expiry':_0x1f4fcf},_0x1f4fcf!=_0x1987c9(0x1bc)?(await tgBot[_0x1987c9(0x226)](_0x314ee2[_0x1987c9(0x2a6)]['id'],_0x1987c9(0x2f6)+_0x1f4fcf+'\x20minutes',{'parse_mode':_0x1987c9(0x23e)})[_0x1987c9(0x27d)](_0x552288=>{telegramError(_0x552288);}),io['to'](_0x570684)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x314ee2[_0x1987c9(0x2a6)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x1c315b=>{telegramError(_0x1c315b);}),io['to'](_0x570684)[_0x1987c9(0x1e6)](_0x1987c9(0x1f3),{'access':{'allow':![],'reason':_0x1987c9(0x223),'token':null}}));}),tgBot[_0x2f5a5c(0x1fa)](_0x2f5a5c(0x230));}));}function loginAccess2FA(_0x518f47,_0x3273be){const _0x1c9b70=_0x3ce4fe;tgBot&&settings['telegramChatId']&&(tgBot[_0x1c9b70(0x1fa)](_0x1c9b70(0x230)),tgBot[_0x1c9b70(0x226)](settings[_0x1c9b70(0x203)],_0x1c9b70(0x28d)+normalizeIP(_0x3273be)[_0x1c9b70(0x291)]+_0x1c9b70(0x1eb),{'parse_mode':_0x1c9b70(0x23e),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x1c9b70(0x1bc),'callback_data':'reject'}]]}})[_0x1c9b70(0x27d)](_0x5094c1=>{telegramError(_0x5094c1);}),tgBot['on']('callback_query',async _0x156be0=>{const _0x10ea89=_0x1c9b70,_0xc572fc=_0x156be0[_0x10ea89(0x1be)],_0x2dc1b2=_0x156be0['message'];tgBot['answerCallbackQuery'](_0x156be0['id'])[_0x10ea89(0x1e2)](async()=>{const _0x5cb5ef=_0x10ea89;devices[_0x518f47][_0x5cb5ef(0x2f0)]={'clientip':_0x3273be,'timestamp':new Date()[_0x5cb5ef(0x295)](),'expiry':_0xc572fc},_0xc572fc!=_0x5cb5ef(0x1bc)?(await tgBot[_0x5cb5ef(0x226)](_0x2dc1b2['chat']['id'],_0x5cb5ef(0x1b9),{'parse_mode':_0x5cb5ef(0x23e)})[_0x5cb5ef(0x27d)](_0x598c93=>{telegramError(_0x598c93);}),io['to'](_0x518f47)['emit'](_0x5cb5ef(0x1f3),{'access':{'allow':![],'reason':_0x5cb5ef(0x1e5),'token':null}})):(await tgBot[_0x5cb5ef(0x226)](_0x2dc1b2[_0x5cb5ef(0x2a6)]['id'],_0x5cb5ef(0x2c4))[_0x5cb5ef(0x27d)](_0x5ef29f=>{telegramError(_0x5ef29f);}),io['to'](_0x518f47)[_0x5cb5ef(0x1e6)](_0x5cb5ef(0x1f3),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x10ea89(0x230));}));}function getConfiguration(){const _0x4a0422=_0x3ce4fe;return dbConfig[_0x4a0422(0x258)](_0x4a0422(0x238))[_0x4a0422(0x202)](_0x4a0422(0x2e8))[_0x4a0422(0x284)]()||[];}function getEnabledBots(){const _0x20f2e1=_0x3ce4fe;return dbConfig[_0x20f2e1(0x258)](_0x20f2e1(0x238))[_0x20f2e1(0x202)](_0x20f2e1(0x2e8))[_0x20f2e1(0x220)]({'status':_0x20f2e1(0x2ea)})[_0x20f2e1(0x284)]()||[];}function getDisabledBots(){const _0x2eed88=_0x3ce4fe;return dbConfig[_0x2eed88(0x258)]('bots')[_0x2eed88(0x202)](_0x2eed88(0x2e8))[_0x2eed88(0x220)]({'status':'disabled'})[_0x2eed88(0x284)]()||[];}function getSettings(){const _0x3d8b31=_0x3ce4fe;return dbSettings['get'](_0x3d8b31(0x2bf))['value']()||{'timeshift':0x0};}function getSecure(){const _0x343ff1=_0x3ce4fe;return dbSecure[_0x343ff1(0x258)]('secure')['value']()||{};}function getBlacklist(){const _0x57f794=_0x3ce4fe;return dbSecure[_0x57f794(0x258)]('blacklist')[_0x57f794(0x284)]()||[];}function broadcastToBots(_0x7f4485,_0x13b263){const _0x1881c5=_0x3ce4fe;config[_0x1881c5(0x27b)](_0x5cb1bd=>{const _0x24f7d9=_0x1881c5;if(_0x5cb1bd[_0x24f7d9(0x1f3)]==_0x24f7d9(0x2ea)&&_0x5cb1bd[_0x24f7d9(0x1d8)]==_0x24f7d9(0x2d1)){if(pid[_0x5cb1bd['botID']])pid[_0x5cb1bd['botID']][_0x24f7d9(0x206)]({[_0x7f4485]:_0x13b263});}});}function storeSettings(_0x249407,_0x1c7ca4=![]){const _0x103f14=_0x3ce4fe;_0x249407={...settings,..._0x249407};if(_0x1c7ca4&&_0x249407['bbPassword']!=_0x103f14(0x1e8)&&_0x249407[_0x103f14(0x2c3)]!=''){const _0x10c0e4=crypt[_0x103f14(0x2cd)](secure[_0x103f14(0x205)],_0x249407[_0x103f14(0x2c3)])[_0x103f14(0x224)][_0x103f14(0x2e4)]('@')[0x0],_0x403602=bcrypt[_0x103f14(0x217)](_0x10c0e4,saltRounds);_0x249407={..._0x249407,'bbPassword':_0x403602};}if(_0x1c7ca4&&_0x249407[_0x103f14(0x2e2)]!=_0x103f14(0x1e8)&&_0x249407['telegramToken']!=''){const _0xa7de10=crypt[_0x103f14(0x2cd)](secure[_0x103f14(0x205)],_0x249407[_0x103f14(0x2e2)])[_0x103f14(0x224)][_0x103f14(0x2e4)]('@')[0x0];_0x249407={..._0x249407,'telegramToken':_0xa7de10};}const _0x1f2f2a=_0x249407[_0x103f14(0x2e2)]!='************'&&_0x249407['telegramToken']!=settings[_0x103f14(0x2e2)]||_0x249407[_0x103f14(0x1c5)]!=settings[_0x103f14(0x1c5)],_0x54ecf9=_0x249407[_0x103f14(0x2e2)]==''||_0x249407['telegramUsername']=='';if(_0x1f2f2a)_0x249407[_0x103f14(0x1f7)]=_0x103f14(0x2c7);for(const [_0x3c832d,_0x4ef393]of Object[_0x103f14(0x25a)](_0x249407)){if(_0x3c832d==_0x103f14(0x2e2)&&_0x4ef393==_0x103f14(0x1e8)){_0x249407[_0x103f14(0x2e2)]=settings[_0x103f14(0x2e2)];continue;};if(_0x3c832d==_0x103f14(0x2c3)&&_0x4ef393==_0x103f14(0x1e8)){_0x249407['bbPassword']=settings[_0x103f14(0x2c3)];continue;};dbSettings[_0x103f14(0x2ae)](_0x103f14(0x253)+_0x3c832d,_0x4ef393)[_0x103f14(0x2a8)]();}settings=_0x249407,io['to']('botmanager')[_0x103f14(0x1e6)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x103f14(0x245)]);if(_0x1f2f2a&&!_0x54ecf9)initTelegram();if(_0x1f2f2a&&_0x54ecf9)disableTelegram();getAllClients()[_0x103f14(0x27b)](_0x1d36ec=>{const _0x3df02b=_0x103f14;getSocket(_0x1d36ec['id'])[_0x3df02b(0x1e6)]('status',{'access':{'allow':![],'reason':_0x3df02b(0x1e5),'token':null}});});}function updateSetting(_0x24cf54,_0x4d13b0){const _0x4717a1=_0x3ce4fe;dbSettings[_0x4717a1(0x2ae)](_0x4717a1(0x253)+_0x24cf54,_0x4d13b0)['write'](),settings=getSettings(),io['to'](_0x4717a1(0x1c0))['emit'](_0x4717a1(0x2bf),cleanSettings());}function storeSecure(_0x5d95d7){const _0x50239b=_0x3ce4fe;dbSecure[_0x50239b(0x258)](_0x50239b(0x221))[_0x50239b(0x23a)](_0x5d95d7)['write'](),secure=_0x5d95d7;}function addBlacklist(_0x2aac81){const _0x483af6=_0x3ce4fe;cleanBlacklist();let _0x2c670c;devices[_0x2aac81][_0x483af6(0x2c6)]?_0x2c670c=Math['max'](devices[_0x2aac81][_0x483af6(0x2c6)][_0x483af6(0x21a)],loginExpiry):_0x2c670c=loginExpiry,dbSecure[_0x483af6(0x258)](_0x483af6(0x2d6))[_0x483af6(0x23a)]({'expiry':new Date()[_0x483af6(0x295)]()+_0x2c670c*0x3c*0x3e8,'token':devices[_0x2aac81][_0x483af6(0x1cc)][_0x483af6(0x273)]})[_0x483af6(0x2a8)](),blacklist=dbSecure[_0x483af6(0x258)]('blacklist')[_0x483af6(0x284)]();}function cleanBlacklist(){const _0x2f7de2=_0x3ce4fe;let _0x4b54f1=dbSecure[_0x2f7de2(0x258)](_0x2f7de2(0x2d6))['cloneDeep']()[_0x2f7de2(0x284)](),_0x17df91=new Date()[_0x2f7de2(0x295)]();_0x4b54f1[_0x2f7de2(0x27b)](_0x3acf47=>{const _0x302e94=_0x2f7de2;_0x3acf47[_0x302e94(0x21a)]<_0x17df91&&dbSecure[_0x302e94(0x258)](_0x302e94(0x2d6))['remove']({'expiry':_0x3acf47[_0x302e94(0x21a)]})['write']();});}function initStates(){const _0x52f342=_0x3ce4fe;let _0x2a4f4e=getConfiguration();_0x2a4f4e[_0x52f342(0x27b)](_0x5b2172=>{const _0x13c85d=_0x52f342;_0x5b2172['live']=_0x13c85d(0x1ee);}),storeConfiguration(_0x2a4f4e);}function onKeys(){const _0x280d4f=new RSA();return new Promise(_0x32ebb4=>{const _0x34ef3d=_0x4840;_0x280d4f[_0x34ef3d(0x1da)]()['then'](_0x17d17b=>{_0x32ebb4(_0x17d17b);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3ebb5c=_0x3ce4fe;let _0x33db88=getConfiguration(),_0x169569=![];_0x33db88['forEach'](_0x43c7a0=>{const _0x4dcf73=_0x4840;if(_0x43c7a0['status']==_0x4dcf73(0x2d1))_0x43c7a0[_0x4dcf73(0x1f3)]='enabled',_0x169569=!![];else _0x43c7a0[_0x4dcf73(0x1f3)]==_0x4dcf73(0x1ee)&&(_0x43c7a0[_0x4dcf73(0x1f3)]=_0x4dcf73(0x2ed),_0x169569=!![]);});if(_0x169569)storeConfiguration(_0x33db88);let _0x1d1f73=getSecure();if(!_0x1d1f73[_0x3ebb5c(0x212)](_0x3ebb5c(0x2dc))){let _0x52215f=await generateKeys();_0x1d1f73[_0x3ebb5c(0x241)]=_0x52215f[_0x3ebb5c(0x241)],_0x1d1f73['privateKey']=_0x52215f['privateKey'],_0x1d1f73[_0x3ebb5c(0x2dc)]=crypto[_0x3ebb5c(0x1cb)](0x20)[_0x3ebb5c(0x2b0)](_0x3ebb5c(0x2b3));;storeSecure(_0x1d1f73);}let _0x400d6d=getSettings();_0x169569=![];!_0x400d6d[_0x3ebb5c(0x212)](_0x3ebb5c(0x1b7))&&(_0x400d6d[_0x3ebb5c(0x1b7)]=![],_0x400d6d[_0x3ebb5c(0x263)]='',_0x400d6d[_0x3ebb5c(0x2c3)]='',_0x400d6d[_0x3ebb5c(0x211)]=![],_0x169569=!![]);!_0x400d6d[_0x3ebb5c(0x212)](_0x3ebb5c(0x1c1))&&(_0x400d6d[_0x3ebb5c(0x1c1)]=![],_0x400d6d['whitelist']=[],_0x400d6d['temporaryAccessAllowed']=![],_0x169569=!![]);if(!_0x400d6d[_0x3ebb5c(0x212)](_0x3ebb5c(0x26a))){if(_0x400d6d[_0x3ebb5c(0x203)])_0x400d6d['telegramEnabled']=!![];else _0x400d6d[_0x3ebb5c(0x26a)]=![];_0x169569=!![];}if(_0x169569)storeSettings(_0x400d6d);}function storeConfiguration(_0x57ef18){const _0x236172=_0x3ce4fe;dbConfig[_0x236172(0x258)](_0x236172(0x238))[_0x236172(0x2c9)]()['write'](),dbConfig[_0x236172(0x258)]('bots')[_0x236172(0x23a)](..._0x57ef18)[_0x236172(0x2a8)](),config=_0x57ef18;}function _0x4840(_0x8049e,_0x35b6be){const _0x71a2dd=_0x3590();return _0x4840=function(_0x425e2a,_0xb8cea6){_0x425e2a=_0x425e2a-0x1b2;let _0x35909e=_0x71a2dd[_0x425e2a];return _0x35909e;},_0x4840(_0x8049e,_0x35b6be);}function resetPassword(){const _0x39758a=_0x3ce4fe;tgBot&&settings[_0x39758a(0x203)]&&(tgBot[_0x39758a(0x1fa)](_0x39758a(0x230)),tgBot[_0x39758a(0x226)](settings[_0x39758a(0x203)],_0x39758a(0x27e),{'parse_mode':_0x39758a(0x23e),'reply_markup':{'inline_keyboard':[[{'text':_0x39758a(0x1c7),'callback_data':_0x39758a(0x1c7)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2642ac=>{telegramError(_0x2642ac);}),tgBot['on'](_0x39758a(0x230),async _0x55c0b2=>{const _0x2b7a96=_0x39758a,_0x2b3848=_0x55c0b2['data'],_0x2cae11=_0x55c0b2[_0x2b7a96(0x224)];tgBot[_0x2b7a96(0x2f2)](_0x55c0b2['id'])[_0x2b7a96(0x1e2)](async()=>{const _0x223d04=_0x2b7a96;if(_0x2b3848!='no'){const _0x5e67af=0xf,_0x310aeb=_0x223d04(0x1c3),_0x42c021=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x5e67af)))[_0x223d04(0x246)](_0x1637b4=>_0x310aeb[_0x1637b4%_0x310aeb[_0x223d04(0x200)]])[_0x223d04(0x2c0)](''),_0x27c613=bcrypt[_0x223d04(0x217)](_0x42c021,saltRounds);storeSettings({'bbPassword':_0x27c613}),await tgBot[_0x223d04(0x226)](_0x2cae11[_0x223d04(0x2a6)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x42c021,{'parse_mode':_0x223d04(0x23e)})[_0x223d04(0x27d)](_0x45862e=>{telegramError(_0x45862e);});}else await tgBot['sendMessage'](_0x2cae11['chat']['id'],_0x223d04(0x2d9))[_0x223d04(0x27d)](_0x183f53=>{telegramError(_0x183f53);});}),tgBot['removeListener']('callback_query');}));}function logging(_0x5f2d41){const _0x8f8b31=_0x3ce4fe;console[_0x8f8b31(0x2a1)](getTimeStamp()+_0x8f8b31(0x20a)+_0x5f2d41);if(tgBot&&settings[_0x8f8b31(0x203)]&&settings['telegramEvents']!=_0x8f8b31(0x244))tgBot[_0x8f8b31(0x226)](settings[_0x8f8b31(0x203)],'Bot\x20Mgr\x20>\x20'+_0x5f2d41)['catch'](_0x5ed808=>{telegramError(_0x5ed808);});}function getServerTime(){const _0xa8c29f=_0x3ce4fe,_0x364952=new Date();return _0x364952[_0xa8c29f(0x21d)]()+'/'+(_0x364952[_0xa8c29f(0x1e4)]()+0x1)[_0xa8c29f(0x2b0)]()[_0xa8c29f(0x29c)](0x2,'0')+'/'+_0x364952['getDate']()[_0xa8c29f(0x2b0)]()[_0xa8c29f(0x29c)](0x2,'0')+'\x20'+_0x364952['getHours']()[_0xa8c29f(0x2b0)]()[_0xa8c29f(0x29c)](0x2,'0')+':'+_0x364952['getMinutes']()[_0xa8c29f(0x2b0)]()[_0xa8c29f(0x29c)](0x2,'0')+':'+_0x364952[_0xa8c29f(0x2da)]()[_0xa8c29f(0x2b0)]()[_0xa8c29f(0x29c)](0x2,'0');}function getTimeStamp(){const _0x1c8fd6=_0x3ce4fe,_0x1ae49d=shiftedTime();return _0x1ae49d[_0x1c8fd6(0x21d)]()+'/'+(_0x1ae49d[_0x1c8fd6(0x1e4)]()+0x1)[_0x1c8fd6(0x2b0)]()[_0x1c8fd6(0x29c)](0x2,'0')+'/'+_0x1ae49d[_0x1c8fd6(0x1d0)]()[_0x1c8fd6(0x2b0)]()[_0x1c8fd6(0x29c)](0x2,'0')+'\x20'+_0x1ae49d[_0x1c8fd6(0x2f7)]()[_0x1c8fd6(0x2b0)]()[_0x1c8fd6(0x29c)](0x2,'0')+':'+_0x1ae49d[_0x1c8fd6(0x2bc)]()[_0x1c8fd6(0x2b0)]()[_0x1c8fd6(0x29c)](0x2,'0')+':'+_0x1ae49d[_0x1c8fd6(0x2da)]()[_0x1c8fd6(0x2b0)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x905167=_0x3ce4fe,_0x4dca10=new Date();let _0x41fb6a=_0x4dca10;if(settings[_0x905167(0x245)]&&settings[_0x905167(0x245)]!==0x0)_0x41fb6a=fns[_0x905167(0x280)](_0x4dca10,{'hours':settings[_0x905167(0x245)]});return _0x41fb6a;}function startScheduler(){const _0x24068d=_0x3ce4fe;let _0x211a3a=new Date()[_0x24068d(0x1df)]();_0x211a3a==0x1&&backupConfigFiles();_0x211a3a==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x4feda6=_0x3ce4fe;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x4feda6(0x27b)](_0x41f2bd=>{const _0x2cfa56=_0x4feda6;if(!_0x41f2bd[_0x2cfa56(0x2a9)]())fs[_0x2cfa56(0x209)](configpath+_0x41f2bd[_0x2cfa56(0x255)],configbackuppath+_0x41f2bd[_0x2cfa56(0x255)]);});}function triggerAnalytics(){const _0x59f3ed=_0x3ce4fe;analytics[_0x59f3ed(0x21b)]({'title':_0x59f3ed(0x1b4),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0x2a77d2,_0x11252e){const _0x526926=_0x3ce4fe;if(_0x2a77d2[_0x526926(0x1c9)]==settings[_0x526926(0x263)]&&bcrypt[_0x526926(0x2ba)](_0x2a77d2[_0x526926(0x210)],settings[_0x526926(0x2c3)])){if(settings[_0x526926(0x211)])return{'allow':![],'reason':_0x526926(0x233),'token':null};else{const _0x128405=generateLoginToken(_0x11252e);return{'allow':!![],'reason':_0x526926(0x296),'token':_0x128405};}}else return{'allow':![],'reason':_0x526926(0x2b9),'token':null};}function refreshToken(_0x47570f){const _0x1a1816=_0x3ce4fe,_0x5e7ff8=generateLoginToken(_0x47570f);return{'allow':!![],'reason':_0x1a1816(0x296),'token':_0x5e7ff8};}function validateAccess(_0x243d71,_0x2fb874){const _0x3541e7=_0x3ce4fe;let _0x41e7ac=devices[_0x2fb874]['ip'],_0x1121c0;const _0x26f9ad=_0x28a952=>{const _0x1bc115=_0x4840;if(settings[_0x1bc115(0x1b7)]){if(settings[_0x1bc115(0x211)]){if(telegram2FaApproved(_0x2fb874)){const _0x31d73f=generateLoginToken(_0x2fb874);return{'allow':!![],'reason':_0x1bc115(0x1f2),'token':_0x31d73f};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1121c0=validToken(_0x28a952,_0x2fb874),_0x1121c0['hasOwnProperty'](_0x1bc115(0x289))?{'allow':!![],'reason':_0x1bc115(0x256),'token':_0x28a952}:{'allow':![],'reason':_0x1bc115(0x294),'token':null};}else return{'allow':!![],'reason':_0x1bc115(0x214),'token':null};};if(settings[_0x3541e7(0x1c1)]){let _0x2f3dce=[...settings[_0x3541e7(0x27c)],'::1',_0x3541e7(0x1e9),_0x3541e7(0x29e)];if(_0x2f3dce[_0x3541e7(0x293)](_0x41e7ac))return _0x26f9ad(_0x243d71);else{_0x1121c0=validToken(_0x243d71,_0x2fb874);if(_0x1121c0[_0x3541e7(0x212)](_0x3541e7(0x289)))return _0x26f9ad(_0x243d71);else{if(telegramIpApproved(_0x2fb874)){const _0x3f23ff=generateToken(_0x2fb874);return _0x1121c0=_0x26f9ad(_0x243d71),_0x1121c0[_0x3541e7(0x229)]?{'allow':!![],'reason':_0x3541e7(0x232),'token':_0x3f23ff}:_0x1121c0;}else return settings[_0x3541e7(0x2d3)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x3541e7(0x231),'token':null};}}}else return _0x26f9ad(_0x243d71);}function timelyDecrypt(_0x4f6d91,_0x27b62a=!![]){const _0x232cbd=_0x3ce4fe;if(_0x4f6d91)try{const _0x4b5efd=crypt[_0x232cbd(0x2cd)](secure[_0x232cbd(0x205)],_0x4f6d91)[_0x232cbd(0x224)],_0x15571e=_0x4b5efd[_0x232cbd(0x2e4)]('@')[0x0],_0xf95729=_0x4b5efd[_0x232cbd(0x2e4)]('@')[0x1],_0x3630a9=new Date()[_0x232cbd(0x295)]();if(_0x27b62a){if(_0x3630a9-_0xf95729<maxSecretAge*0x3e8)return _0x15571e;else return![];}else return _0x15571e;}catch(_0x53f240){return![];}else return![];}const validToken=(_0x18f5fb,_0x2a6ccb)=>{const _0x406752=_0x3ce4fe,_0x7d5be9=devices[_0x2a6ccb]['ip'];if(!_0x18f5fb)return{'error':_0x406752(0x1e0)};for(let _0x43f712 of blacklist){if(_0x43f712['token']==_0x18f5fb)return{'error':'Token\x20blacklisted'};}let _0x46d8bb;try{_0x46d8bb=jwt['verify'](_0x18f5fb,secure[_0x406752(0x2dc)]+_0x2a6ccb);}catch{return{'error':_0x406752(0x259)};}if(!_0x46d8bb[_0x406752(0x212)]('clientip')&&!_0x46d8bb[_0x406752(0x212)](_0x406752(0x1c9))||!_0x46d8bb[_0x406752(0x212)](_0x406752(0x2eb)))return{'error':_0x406752(0x261)};if(!_0x46d8bb[_0x406752(0x212)](_0x406752(0x1c9))&&_0x46d8bb[_0x406752(0x212)](_0x406752(0x1fd))){const {clientip:_0x541243}=_0x46d8bb;return _0x7d5be9==_0x541243?{'success':_0x406752(0x21e)}:{'error':_0x406752(0x26c)};}else{if(_0x46d8bb[_0x406752(0x212)](_0x406752(0x1c9))&&_0x46d8bb[_0x406752(0x212)](_0x406752(0x1fd))){const {username:_0x221c72,clientip:_0x58e80b}=_0x46d8bb;return settings[_0x406752(0x263)]==_0x221c72&&_0x7d5be9==_0x58e80b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x406752(0x2de)};}}},generateLoginToken=_0x518638=>{const _0x8013d4=_0x3ce4fe;if(_0x518638){const _0xc2e6b3=devices[_0x518638]['ip'];return jwt[_0x8013d4(0x23c)]({'username':settings[_0x8013d4(0x263)],'clientip':_0xc2e6b3},secure[_0x8013d4(0x2dc)]+_0x518638,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x520841=>{const _0x59c382=_0x3ce4fe;if(_0x520841){const _0x5ad0c8=devices[_0x520841]['ip'];return jwt[_0x59c382(0x23c)]({'clientip':_0x5ad0c8},secure['secret']+_0x520841,{'expiresIn':devices[_0x520841][_0x59c382(0x2c6)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x30c1cd=>{const _0x7bd09c=_0x3ce4fe;let _0x4703ad=![];return devices[_0x30c1cd][_0x7bd09c(0x2c6)]&&devices[_0x30c1cd][_0x7bd09c(0x2c6)][_0x7bd09c(0x21a)]!=_0x7bd09c(0x1bc)&&(_0x4703ad=devices[_0x30c1cd][_0x7bd09c(0x2c6)][_0x7bd09c(0x1fd)]==devices[_0x30c1cd]['ip']&&new Date()[_0x7bd09c(0x295)]()-devices[_0x30c1cd][_0x7bd09c(0x2c6)][_0x7bd09c(0x2ce)]<devices[_0x30c1cd]['telegramIpApproval'][_0x7bd09c(0x21a)]*0x3c*0x3e8),_0x4703ad;},telegram2FaApproved=_0x24c983=>{const _0x15cfaf=_0x3ce4fe;let _0x440ed6=![];return devices[_0x24c983]['telegram2FaApproval']&&devices[_0x24c983][_0x15cfaf(0x2f0)]['expiry']!=_0x15cfaf(0x1bc)&&(_0x440ed6=devices[_0x24c983]['telegram2FaApproval'][_0x15cfaf(0x1fd)]==devices[_0x24c983]['ip']&&new Date()['getTime']()-devices[_0x24c983][_0x15cfaf(0x2f0)][_0x15cfaf(0x2ce)]<devices[_0x24c983][_0x15cfaf(0x2f0)][_0x15cfaf(0x21a)]*0x3c*0x3e8),_0x440ed6;},normalizeIP=_0xf081d=>{const _0x54bb2b=_0x3ce4fe;let _0x4251ba=null,_0x368285=null;if(ipaddr[_0x54bb2b(0x264)](_0xf081d)){const _0x458654=ipaddr[_0x54bb2b(0x1fb)](_0xf081d);_0x458654[_0x54bb2b(0x1b8)]()===_0x54bb2b(0x257)?(_0x458654[_0x54bb2b(0x2b1)]()&&(_0x4251ba=_0x458654[_0x54bb2b(0x20c)]()[_0x54bb2b(0x2b0)]()),_0x368285=_0x458654[_0x54bb2b(0x2b0)]()):(_0x4251ba=_0x458654[_0x54bb2b(0x2b0)](),_0x368285=_0x458654[_0x54bb2b(0x1b5)]()[_0x54bb2b(0x2b0)]());}return{'show':_0x4251ba?_0x4251ba:_0x368285,'store':_0x368285};};