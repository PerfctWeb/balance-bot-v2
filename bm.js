const _0x379955=_0x1d6b;(function(_0x4b2737,_0x4e4d54){const _0x300931=_0x1d6b,_0x5253d4=_0x4b2737();while(!![]){try{const _0x1ceb50=-parseInt(_0x300931(0x22a))/0x1+-parseInt(_0x300931(0x2fe))/0x2*(-parseInt(_0x300931(0x2c8))/0x3)+-parseInt(_0x300931(0x120))/0x4*(parseInt(_0x300931(0x26a))/0x5)+-parseInt(_0x300931(0x1c6))/0x6*(parseInt(_0x300931(0x292))/0x7)+-parseInt(_0x300931(0x296))/0x8+-parseInt(_0x300931(0x24f))/0x9*(-parseInt(_0x300931(0x2e4))/0xa)+-parseInt(_0x300931(0x267))/0xb*(-parseInt(_0x300931(0x12e))/0xc);if(_0x1ceb50===_0x4e4d54)break;else _0x5253d4['push'](_0x5253d4['shift']());}catch(_0x55866c){_0x5253d4['push'](_0x5253d4['shift']());}}}(_0x3c3e,0x75d81));const _0x73d87e=function(){let _0x474fe2=!![];return function(_0x5eff28,_0x5079ba){const _0xa38bdf=_0x474fe2?function(){const _0x1b3b4a=_0x1d6b;if(_0x5079ba){const _0x8a456=_0x5079ba[_0x1b3b4a(0x1ec)](_0x5eff28,arguments);return _0x5079ba=null,_0x8a456;}}:function(){};return _0x474fe2=![],_0xa38bdf;};}(),_0x42e268=_0x73d87e(this,function(){const _0x5bd1cd=_0x1d6b;return _0x42e268[_0x5bd1cd(0x1e2)]()[_0x5bd1cd(0x26d)]('(((.+)+)+)+$')['toString']()['constructor'](_0x42e268)[_0x5bd1cd(0x26d)]('(((.+)+)+)+$');});_0x42e268();'use strict';process[_0x379955(0x150)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x379955(0x11d)),fs=require('fs'),fns=require('date-fns'),low=require(_0x379955(0x2a8)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x379955(0x2a5)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require('hybrid-crypto-js')[_0x379955(0x229)],bcrypt=require(_0x379955(0x1a4)),jwt=require(_0x379955(0x280)),ipaddr=require(_0x379955(0x28e)),argv=require(_0x379955(0x127))(process['argv'][_0x379955(0x283)](0x2))['argv'],uuidRandom=require(_0x379955(0x12d)),{Telegraf,Markup}=require(_0x379955(0x315)),Mixpanel=require(_0x379955(0x25e)),axios=require(_0x379955(0x2ec)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x379955(0x1b8)),{networkInterfaces}=require('os'),PORT=argv[_0x379955(0x326)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x379955(0x2b1)](_0x379955(0x15a)+PORT+_0x379955(0x149)),process[_0x379955(0x139)](0x1));const HOST=argv[_0x379955(0x2c3)]||null,userID=argv[_0x379955(0x289)]||'',debugging=argv['d']||![],nodeversion=process[_0x379955(0x2c9)][_0x379955(0x264)];let bbpath=_0x379955(0x175),bbpath2='';const botfile=_0x379955(0x1c3),configfile=_0x379955(0x125),settingsfile=_0x379955(0x1cb),securefile=_0x379955(0x257),environment=require('./'+bbpath2+_0x379955(0x2e6))[_0x379955(0x174)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x379955(0x20d)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x379955(0x18b)),configpath=userID?bbpath+_0x379955(0x195)+userID+'/':bbpath+_0x379955(0x195),configbackuppath=configpath+_0x379955(0x188),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x379955(0x172),loggerfile=fs[_0x379955(0x2e2)](logspath+_0x379955(0x1b9),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x379955(0x20d)](configpath)&&fs[_0x379955(0x13f)](configpath);!fs[_0x379955(0x20d)](configbackuppath)&&fs[_0x379955(0x13f)](configbackuppath);!fs[_0x379955(0x20d)](logspath)&&fs[_0x379955(0x13f)](logspath);!fs[_0x379955(0x20d)](zippath)&&fs[_0x379955(0x13f)](zippath);function _0x3c3e(){const _0x23921a=['api-eu.mixpanel.com','0.0.0','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','join','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','isDirectory',',\x20must\x20be\x20a\x204\x20digit\x20number','getMonth','ipv6','referer','order','reinstall_no','message','env','2FA\x20required','Markdown','action','temporary\x20access\x20timeout','max','catch','readFileSync','portfolio','reload','Error:\x20Invalid\x20argument\x20','username','-----------------------------------------------------------------------------------','Logged\x20in\x20user\x20...','logged\x20out','createServer','address','/:bot/performance','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','lastmsgtelegram','warning','|@|','CoinMarketCap\x20API\x20key\x20validated','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','login\x20token\x20valid','\x20-\x20','hasOwnProperty','SIGINT','backup-full@','Unauthorized\x20attempt\x20to\x20confirm\x20message','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','cancelLoading','kill','getHours','zip/','get-messages','environment','bb/','cancel-loading','onepagemode','get-logs','-results.json','reinstall-bb','SIGTERM','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','sha256','Access\x20enabled\x20for\x20','publicKey','config_all','botID','Password\x20reset\x20rejected','status\x20code\x20401','disconnect','restore_yes_','new','login\x20required','backup/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','clients','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Starting\x20Balance\x20Bot\x20reinstallation','Server','store-headless','internal','::1','/help\x20-\x20show\x20available\x20commands\x0a','names','inherit','config/','forEach','No\x20authentication\x20token',':\x20Bot\x20Mgr\x20>\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','confirm-message','find','function','getStartingBalances','apiKey','static','filter','getFullYear','storeHeadless','notification','bcryptjs','Unauthorized\x20attempt\x20to\x20show\x20configuration','push','decrypt','Unauthorized\x20attempt\x20to\x20get\x20events','handshake','/:bot/coins','hashSync','updatebotmanager','\x20to\x20','match','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','start','readdirSync','connected','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bbvReceive','express-fileupload','/output-000.log','test','bbPassword','Logged\x20out\x20user\x20...','Restore\x20process\x20confirmed','login','Notifications\x20disabled','file','http','Starting\x20#RED#Balance\x20Bot\x20v','bot.js','includes','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','187182YObzwI','Error\x20removing\x20old\x20backup\x20files:','reinstall_yes','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','output-000.log','bb-settings.json','alias','live',')\x20|\x20Bot\x20','Orders','bot','pidRefreshToken','add','reinstall','privateKey','split','/names\x20-\x20show\x20bot\x20names\x0a','getTime','write','/on\x20-\x20start\x20bot(s)\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','debug','off','_data','reason','userid','/download/:type','hex','toString',')\x20\x20\x20|\x20Bot\x20','Login\x20rejected','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Enabled\x20Bot\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','inlineKeyboard','simple','/:bot/support','remove','apply','staging','#RES#\x20','config_orders','title','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','Password\x20has\x20been\x20reset\x20to:\x20','blacklist','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','getPortfolio','disable','restart_','encryptedUuid','metrics','update-bot','metrics_','Unauthorized\x20attempt\x20to\x20download\x20','\x20>\x20','init','-config.json','cloneDeep','showname','password','code','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/upload-backup','Unauthorized\x20attempt\x20to\x20get\x20portfolio','\x1b[0m','telegramIpApproval','deleteHistoryAlerts','File\x20uploaded','apiPassword','mode','existsSync','\x1b[33m','number','6b67f3d61ee94b8f5c80b4affef4c4d9','access\x20timeout','portfolio_','botname','2FA\x20login\x20required','Bot\x20Mgr\x20>\x20starting\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','keys','socket.io','callback','loginRequired','\x20|\x20','manual','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','update_yes','getMinutes','ETH','generate','timestamp','.zip','toggleBotMode','toggle','clientip','randomBytes','place-order','RSA','293451uZgzdI','show','get-starting-balances','uuid','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','/disable\x20-\x20disable\x20notifications\x0a','2FA\x20login\x20rejected','secret','bots','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','request','telegramEvents','Deleted\x20Bot\x20','Restore\x20process\x20aborted','Failed\x20to\x20download\x20','getUTCHours','Unauthorized\x20attempt\x20to\x20get\x20messages','User\x20has\x20been\x20validated','\x20mode','Bot\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Disabled\x20Bot\x20','Temporary\x20access\x20rejected','binary','orders','enable','generateKeyPairAsync','files','\x1b[31m','resetpw_yes','Telegraf\x20error:','sendMetricsTelegram','#RES#','Starting\x20Balance\x20Bot\x20update','-performance.json','1017OoQOjg','#RES#\x20if\x20running\x20locally\x0a','login2fa_reject_','IPv4','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramEnabled','[ip-address]','success','bb-secure.json','output-001.log',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','reply','sort','remoteAddress','args','mixpanel','headless','Ok,\x20will\x20send\x20alert\x20notifications\x20only','login\x20token\x20generated','https://api.ipify.org?format=json','Starting\x20(','node','replace','Setting\x20access:\x20','3054777xTezrA','express','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','441445SBddGH','showConfig','/:bot/portfolio','search','emit','Alerts','You\x20can\x20use\x20the\x20following\x20commands:\x0a','placeOrder','editMessageReplyMarkup','backup-full.zip','\x1b[35m','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','accept','Unauthorized\x20login\x20attempt\x20(timeout)','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Your\x20installation\x20is\x20already\x20up\x20to\x20date','-events.json','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','on_','Notifications\x20enabled','settings','launch','jsonwebtoken','entries','Starting\x20new\x20bot\x20|\x20Bot\x20','slice','off_','All\x20bots\x20running\x20right\x20now','conn','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','server','user','map','update','sendFile','node-zip','ipaddr.js','temporaryAccessAllowed','size','sendMessage','182yyTstQ','\x20only\x0a','full','running','1320536WeTAWa','writeFileSync','show-config','use','temporary\x20access\x20rejected','/:bot/configuration','latestversion','All\x20bots','No\x20bots\x20running\x20right\x20now','\x20(2)','reset-history','update-bb','auth','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','name','path','telegramToken','all','lowdb','rmSync','unlinkSync','format','then','uncaughtException','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','address\x20already\x20in\x20use','config','log','DEFLATE','post','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','get-backup-files','store','***','disabled','token','15\x20min','\x20minutes','emitHistory','toIPv4Address','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','store-fiat','telegrammsg','removeAllListeners','telegramChatId','host','/restart\x20-\x20restart\x20bot(s)\x0a','socket','startsWith','bot-','407433iIGWwn','versions','toggle_','getDate','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','new-disabled','build','(staging)','any','from','=>\x20Go\x20to\x20#CYA#http://','temporary\x20token\x20generated','config_alerts','Allow\x20login\x20from\x20IP\x20address\x20','kind','sockets','sendPortfolioTelegram','/status\x20-\x20show\x20bot(s)\x20status\x0a','expiry','login2fa_','send','botmanager','/update\x20-\x20update\x20Balance\x20Bot\x0a','messages','yes','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','createWriteStream','status','54180JYEkQv','Node.js\x20v','version.json','restart','/start','Network\x20Interfaces:','/metrics\x20-\x20show\x20bot\x20performance\x0a','backup-files','axios','track','bbvNew','reject','type','copyFileSync','data','button','family','padStart','get','close','logs','************','Restoring\x20bot(s)\x20from\x20backup','randomFillSync','BCT','telegram','14vOdmjp','backup','enabled','index.html','isIPv4MappedAddress','output-002.log','once','event','ipc','command','statSync','stopped','store-configuration','defaults','stop','Notifications\x20enabled\x0a','telegram2FaApproval','auto','Session\x20expired\x20for\x20user\x20...','settings.','Unauthorized\x20attempt\x20to\x20delete\x20bot','f2aRequired','headers','telegraf','login\x20not\x20required','Notifications\x20types:\x20','private','pidExpireLogin','stringify','telegramUsername','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','version','Backup\x20file\x20uploaded','alerts','started','allow','parse','error','timeshift','chat','port','download','value','Invalid\x20authentication\x20token\x20(1)','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20log\x20out','sign','Invalid\x20authentication\x20token\x20(2)','listen','set','update_no','child_process','resetHistory','length','4KjYSDf','Invalid\x20IP\x20address','marketcapApi','exp','bbUsername','bb-config.json','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','yargs/yargs','lastmsgemitted','secure','Bot\x20Mgr\x20>\x20','HTML','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','uuid-random','12WluYyW','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Unauthorized\x20attempt\x20to\x20store\x20configuration','access','assign','compareSync','output-003.log','endsWith','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','exit','exchange','sortBy','restore-backup-file','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','mkdirSync','Token\x20blacklisted','string','/:bot/history'];_0x3c3e=function(){return _0x23921a;};return _0x3c3e();}!fs[_0x379955(0x20d)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x379955(0x30b)]({'bots':[]})[_0x379955(0x1d8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x379955(0x30b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x379955(0x144),'onepagemode':![],'marketcapApi':''}})[_0x379955(0x1d8)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x379955(0x30b)]({'secure':{},'blacklist':[]})[_0x379955(0x1d8)]();let crypt=new Crypt({'md':_0x379955(0x17d),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x379955(0x1fe)](_0x379955(0x210),{'host':_0x379955(0x143)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings[_0x379955(0x2a6)]!='***')&&settings[_0x379955(0x31b)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x2f08f6,_0x42cb70)=>{const _0x2995ef=_0x379955,_0x433cad=/#[A-Z]{3}#/g;if(typeof _0x2f08f6==_0x2995ef(0x141)){!_0x42cb70?_0x2f08f6=_0x2f08f6['replace'](_0x433cad,''):(_0x2f08f6=_0x2f08f6[_0x2995ef(0x265)](/#BLU#/g,'\x1b[34m'),_0x2f08f6=_0x2f08f6['replace'](/#RED#/g,_0x2995ef(0x248)),_0x2f08f6=_0x2f08f6['replace'](/#YEL#/g,_0x2995ef(0x20e)),_0x2f08f6=_0x2f08f6[_0x2995ef(0x265)](/#MAG#/g,_0x2995ef(0x274)),_0x2f08f6=_0x2f08f6[_0x2995ef(0x265)](/#CYA#/g,'\x1b[36m'),_0x2f08f6=_0x2f08f6['replace'](/#RES#/g,_0x2995ef(0x207)));;}return _0x2f08f6;},logger={'screen':_0x5584aa=>{const _0x366ea3=_0x379955;console[_0x366ea3(0x2b1)](parseColor(_0x5584aa,!![]));},'simple':_0x17787f=>{const _0x5d8881=_0x379955;console[_0x5d8881(0x2b1)](parseColor(_0x17787f,!![])),loggerfile[_0x5d8881(0x1d8)](util['format'](parseColor(_0x17787f,![]))+'\x0a');},'full':async _0x3f5220=>{const _0x13995f=_0x379955,_0x4392ca=getTimeStamp()+_0x13995f(0x198)+_0x3f5220;console[_0x13995f(0x2b1)](parseColor(_0x4392ca,!![])),loggerfile[_0x13995f(0x1d8)](util[_0x13995f(0x2ab)](parseColor(_0x4392ca,![]))+'\x0a');if(tgBot&&settings[_0x13995f(0x2c2)]&&settings[_0x13995f(0x237)]!=_0x13995f(0x244))await sendTelegram(settings[_0x13995f(0x2c2)],_0x13995f(0x12a)+parseColor(_0x3f5220,![]));},'debug':async(_0x4dfce5,_0x49ab45='')=>{const _0x259d9f=_0x379955,_0x55549f=getTimeStamp()+_0x259d9f(0x216)+_0x4dfce5;if(debugging)console[_0x259d9f(0x2b1)](parseColor(_0x55549f,!![]));loggerfile[_0x259d9f(0x1d8)](util[_0x259d9f(0x2ab)](parseColor(_0x55549f,![]))+'\x0a');if(_0x49ab45){if(debugging)console['log'](_0x49ab45);loggerfile['write'](util[_0x259d9f(0x2ab)](_0x49ab45)+'\x0a');}}};let terminating=![];process['on'](_0x379955(0x2ad),function(_0x394f0f){const _0x427415=_0x379955;_0x394f0f['toString']()[_0x427415(0x1c4)](_0x427415(0x2af))?(logger['simple'](_0x427415(0x126)+_0x394f0f[_0x427415(0x326)]+_0x427415(0x24c)),process[_0x427415(0x2dc)]({'terminate':!![]},_0x3c5c95=>{})):logger[_0x427415(0x1e9)](_0x394f0f);}),process['on'](_0x379955(0x139),()=>{const _0x1aa6db=_0x379955;stopAllBots(),process[_0x1aa6db(0x139)](0x0);}),process['on'](_0x379955(0x17b),()=>{const _0x5f68e8=_0x379955;stopAllBots(),process[_0x5f68e8(0x139)](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x379955(0x2e6))[_0x379955(0x31d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x379955(0x268)),app=express(),http=require(_0x379955(0x1c1))[_0x379955(0x15f)](app);app[_0x379955(0x299)](fileUpload({'useTempFiles':!![]})),app['get'](_0x379955(0x1e0),async(_0x5af7fb,_0x1132fe)=>{const _0x46b16a=_0x379955,_0x1068b9=_0x5af7fb['params'][_0x46b16a(0x2f0)],_0x5a0601=getClientsWithBotID('botmanager'),_0x23d8ff=_0x5af7fb['headers'][_0x46b16a(0x22d)],_0x191f58=timelyDecrypt(_0x23d8ff,![]),_0x33f800=_0x5a0601[_0x46b16a(0x19b)](_0x1b68ba=>_0x1b68ba[_0x46b16a(0x22d)]==_0x191f58);if(_0x33f800){const _0x51f47a=normalizeIP(_0x5af7fb['socket']['remoteAddress'])[_0x46b16a(0x2b6)],_0x290fff=_0x5af7fb['headers']['tkn'];if(validateAccess(_0x290fff,_0x191f58,_0x51f47a)['allow'])_0x1068b9==_0x46b16a(0x2ff)&&await backupConfigFiles(),await zipFiles(_0x1068b9),_0x1132fe[_0x46b16a(0x327)](zippath+(_0x1068b9+_0x46b16a(0x223)),_0x2d3dff=>{const _0x1fafad=_0x46b16a;_0x2d3dff&&(logger[_0x1fafad(0x294)](_0x1fafad(0x23a)+_0x1068b9),logger[_0x1fafad(0x1e9)](_0x2d3dff));});else logger[_0x46b16a(0x294)](_0x46b16a(0x1fc)+_0x1068b9+'\x20(1)');}else logger['full'](_0x46b16a(0x1fc)+_0x1068b9+_0x46b16a(0x29f));}),app[_0x379955(0x2b3)](_0x379955(0x205),async(_0x381a10,_0x11acd4)=>{const _0x4c36f3=_0x379955,_0x427cdc=getClientsWithBotID(_0x4c36f3(0x2dd)),_0x128409=_0x381a10[_0x4c36f3(0x314)]['uuid'],_0x1c2f7d=timelyDecrypt(_0x128409,![]),_0x4c3eab=_0x427cdc['find'](_0x2e5ce2=>_0x2e5ce2[_0x4c36f3(0x22d)]==_0x1c2f7d);logger[_0x4c36f3(0x1db)](_0x4c36f3(0x31e));if(_0x4c3eab){const _0x46ab9e=normalizeIP(_0x381a10[_0x4c36f3(0x2c5)][_0x4c36f3(0x25c)])[_0x4c36f3(0x2b6)],_0x4dee6b=_0x381a10[_0x4c36f3(0x314)]['tkn'];if(validateAccess(_0x4dee6b,_0x1c2f7d,_0x46ab9e)[_0x4c36f3(0x321)]){if(_0x381a10[_0x4c36f3(0x247)]){const _0x31bbd7=_0x381a10[_0x4c36f3(0x247)]['backupfile'];await _0x31bbd7['mv'](temppath+_0x31bbd7[_0x4c36f3(0x2a4)]),_0x11acd4[_0x4c36f3(0x2dc)]({'status':!![],'message':_0x4c36f3(0x20a)});const _0x44d06c=getBotsWithMode();_0x44d06c[_0x4c36f3(0x11f)]>0x0?confirmRestore(temppath,_0x31bbd7[_0x4c36f3(0x2a4)]):unzipFile(temppath,_0x31bbd7['name']);}}else logger[_0x4c36f3(0x294)](_0x4c36f3(0x189));}else logger[_0x4c36f3(0x294)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x379955(0x299)](express[_0x379955(0x19f)](path[_0x379955(0x146)](__dirname,bbpath2,'build2'))),app['use'](express[_0x379955(0x19f)](path[_0x379955(0x146)](__dirname,bbpath2,'build'))),app[_0x379955(0x2f6)]('/',function(_0x1ac241,_0x23d39c){const _0x3ff052=_0x379955;_0x23d39c['sendFile'](path[_0x3ff052(0x146)](__dirname,bbpath2,'build2','index.html'));}),app[_0x379955(0x2f6)]('/:bot',function(_0x1b048b,_0x167c8a){const _0x2ab852=_0x379955;_0x167c8a[_0x2ab852(0x28c)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x379955(0x2f6)](_0x379955(0x26c),(_0x5e760b,_0x198bf4)=>{const _0x4345df=_0x379955;_0x198bf4['sendFile'](path[_0x4345df(0x146)](__dirname,bbpath2,_0x4345df(0x2ce),_0x4345df(0x301)));}),app[_0x379955(0x2f6)](_0x379955(0x161),(_0x2e0b55,_0x5c48df)=>{const _0x55519d=_0x379955;_0x5c48df[_0x55519d(0x28c)](path[_0x55519d(0x146)](__dirname,bbpath2,_0x55519d(0x2ce),'index.html'));}),app[_0x379955(0x2f6)](_0x379955(0x1aa),(_0x49ec48,_0x43e127)=>{const _0x22d93c=_0x379955;_0x43e127['sendFile'](path['join'](__dirname,bbpath2,_0x22d93c(0x2ce),_0x22d93c(0x301)));}),app[_0x379955(0x2f6)](_0x379955(0x142),(_0x3b5721,_0x3e33be)=>{const _0x1f5524=_0x379955;_0x3e33be[_0x1f5524(0x28c)](path[_0x1f5524(0x146)](__dirname,bbpath2,_0x1f5524(0x2ce),'index.html'));}),app[_0x379955(0x2f6)](_0x379955(0x29b),(_0x53f7bc,_0x647829)=>{const _0x1673a9=_0x379955;_0x647829['sendFile'](path[_0x1673a9(0x146)](__dirname,bbpath2,_0x1673a9(0x2ce),_0x1673a9(0x301)));}),app[_0x379955(0x2f6)](_0x379955(0x1ea),(_0x1c462a,_0x5ed323)=>{const _0xde7ba=_0x379955;_0x5ed323[_0xde7ba(0x28c)](path[_0xde7ba(0x146)](__dirname,bbpath2,_0xde7ba(0x2ce),_0xde7ba(0x301)));});if(HOST)http[_0x379955(0x11a)](PORT,HOST);else http[_0x379955(0x11a)](PORT);const io=require(_0x379955(0x218))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x268232=_0x379955;let _0x36d7b7=_0x268232(0x255);const _0x5e5330=networkInterfaces(),_0x535837={};for(const _0x4e51d2 of Object[_0x268232(0x217)](_0x5e5330)){for(const _0x56b196 of _0x5e5330[_0x4e51d2]){if((_0x56b196[_0x268232(0x2f4)]==_0x268232(0x252)||_0x56b196[_0x268232(0x2f4)]==0x4)&&!_0x56b196[_0x268232(0x190)]){const _0x281f2f=ipaddr[_0x268232(0x322)](_0x56b196[_0x268232(0x160)])['range']();_0x281f2f!=_0x268232(0x318)&&(!_0x535837[_0x4e51d2]&&(_0x535837[_0x4e51d2]=[]),_0x535837[_0x4e51d2][_0x268232(0x1a6)](_0x56b196[_0x268232(0x160)]),_0x36d7b7=_0x56b196[_0x268232(0x160)]);}}}return{'serverip':_0x36d7b7,'netinterfaces':_0x535837};}async function startServer(){const _0x16f685=_0x379955,{serverip:_0x262dd8,netinterfaces:_0x1e3485}=getServerIP();logger['simple'](''),logger[_0x16f685(0x1e9)](_0x16f685(0x15c)),await logger[_0x16f685(0x294)](_0x16f685(0x1c2)+serverversion+_0x16f685(0x1ee)+(environment==_0x16f685(0x1ed)?_0x16f685(0x2cf):'')+'\x0a'+(_0x16f685(0x2a3)+PORT+_0x16f685(0x250))+(_0x16f685(0x2d2)+_0x262dd8+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x16f685(0x1e9)](_0x16f685(0x15c));if(config[_0x16f685(0x11f)]!=0x0)for(const _0x17d085 of config){const _0x568812=_0x17d085[_0x16f685(0x20c)]=='auto'?'a':'m';if(_0x17d085[_0x16f685(0x2e3)]==_0x16f685(0x300)||_0x17d085[_0x16f685(0x2e3)]==_0x16f685(0x186))await logger[_0x16f685(0x294)](_0x16f685(0x263)+_0x568812+_0x16f685(0x1ce)+_0x17d085[_0x16f685(0x181)]+_0x16f685(0x21b)+_0x17d085[_0x16f685(0x213)]),startBot([_0x17d085[_0x16f685(0x181)],userID],{'cwd':bbpath},function(_0x1c1e2f){const _0x5a0fe8=_0x16f685;if(_0x1c1e2f)logger[_0x5a0fe8(0x294)](_0x1c1e2f);});else(_0x17d085[_0x16f685(0x2e3)]==_0x16f685(0x2b8)||_0x17d085[_0x16f685(0x2e3)]==_0x16f685(0x2cd))&&await logger[_0x16f685(0x294)]('Idling\x20('+_0x568812+_0x16f685(0x1e3)+_0x17d085['botID']+_0x16f685(0x21b)+_0x17d085['botname']);}else!newBot&&logger['simple'](_0x16f685(0x1c5));if(newBot)addBot();logger[_0x16f685(0x1e9)](_0x16f685(0x15c)),logger[_0x16f685(0x1e9)](''),await logger[_0x16f685(0x1db)](_0x16f685(0x2e5)+nodeversion),await logger[_0x16f685(0x1db)](_0x16f685(0x2e9),_0x1e3485);}function startSocket(){io['on']('connection',_0x2b13f4=>{const _0x7322a5=_0x1d6b;let _0x68bf67,_0x5292f1,_0x214472,_0x57c180,_0x4a4079;const _0x1776ba=_0x2b13f4[_0x7322a5(0x1a9)]['headers'][_0x7322a5(0x14c)];_0x5292f1=_0x1776ba[_0x7322a5(0x1ae)](/bot[0-9]{3}/);if(_0x5292f1)_0x214472=_0x5292f1[0x0][_0x7322a5(0x1ae)](/[0-9]{3}/);if(_0x214472)_0x68bf67=_0x214472[0x0];else _0x68bf67=_0x7322a5(0x2dd);const _0x418261=_0x2b13f4[_0x7322a5(0x1a9)][_0x7322a5(0x2a2)][_0x7322a5(0x1f8)];if(!_0x418261)_0x2b13f4['emit'](_0x7322a5(0x2e3),{'publicKey':secure[_0x7322a5(0x17f)]});else{_0x57c180=timelyDecrypt(_0x418261,![]);if(!_0x57c180)_0x2b13f4[_0x7322a5(0x26e)](_0x7322a5(0x2e3),{'publicKey':secure[_0x7322a5(0x17f)]});else{_0x4a4079=normalizeIP(_0x2b13f4[_0x7322a5(0x286)]['remoteAddress'])['store'];if(!devices[_0x57c180])devices[_0x57c180]={'uuid':_0x57c180,'access':{'token':null}};devices[_0x57c180]['ip']=_0x4a4079;const _0x201b9d=addClient(_0x2b13f4['id'],_0x57c180,_0x68bf67);setAccess(_0x201b9d),emitMessages(),_0x2b13f4['on'](_0x7322a5(0x1be),_0x3496fe=>{const _0x4236e2=_0x7322a5,_0x2fb689=timelyDecrypt(_0x3496fe[_0x4236e2(0x202)],!![],_0x4236e2(0x165));if(_0x2fb689){_0x3496fe={'username':_0x3496fe[_0x4236e2(0x15b)],'password':_0x2fb689},devices[_0x57c180][_0x4236e2(0x132)]=validateCredentials(_0x3496fe,_0x57c180);if(devices[_0x57c180][_0x4236e2(0x132)][_0x4236e2(0x321)]==![]&&devices[_0x57c180][_0x4236e2(0x132)][_0x4236e2(0x1de)]=='2FA\x20login\x20required')_0x2b13f4[_0x4236e2(0x26e)](_0x4236e2(0x2e3),{'access':devices[_0x57c180][_0x4236e2(0x132)]}),loginAccess2FA(_0x57c180,_0x4a4079);else{if(devices[_0x57c180][_0x4236e2(0x132)][_0x4236e2(0x321)]==![]&&devices[_0x57c180][_0x4236e2(0x132)]['reason']=='invalid\x20credentials')_0x2b13f4['emit']('status',{'access':devices[_0x57c180][_0x4236e2(0x132)]});else devices[_0x57c180][_0x4236e2(0x132)][_0x4236e2(0x321)]&&devices[_0x57c180][_0x4236e2(0x132)][_0x4236e2(0x1de)]==_0x4236e2(0x261)&&(getClientsWithUuid(_0x57c180)[_0x4236e2(0x196)](_0x34a102=>{setAccess(_0x34a102);}),logger['debug'](_0x4236e2(0x15d)+_0x57c180[_0x4236e2(0x283)](-0x8)),setTokenRefresh(_0x57c180),setSessionTimeout(_0x4236e2(0x1be),_0x57c180));}}else logger[_0x4236e2(0x294)](_0x4236e2(0x277));}),_0x2b13f4['on']('reset-password',()=>{resetPassword();}),_0x2b13f4['on'](_0x7322a5(0x184),_0x3d2ad0=>{removeClient(_0x2b13f4['id']);}),_0x68bf67=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5b05fd){const _0x5a8199=_0x379955;if(_0x5b05fd!='botmanager'&&config['apiKey']!=''){if(pid[_0x5b05fd])pid[_0x5b05fd]['send']({'function':'initclient','args':null});}_0x5b05fd!=_0x5a8199(0x2dd)&&broadcastToBots(_0x5a8199(0x232),JSON[_0x5a8199(0x31a)](config));}function reloadBotManager(){const _0x3aa1d8=_0x379955;getClientsWithBotID(_0x3aa1d8(0x2dd))[_0x3aa1d8(0x196)](_0x5718d7=>{const _0x58bd5e=_0x3aa1d8;getSocket(_0x5718d7['id'])[_0x58bd5e(0x26e)]('status',{'access':{'allow':![],'reason':_0x58bd5e(0x159),'token':null}});});}function getSocket(_0x2905dd){const _0x6e762d=_0x379955;return io[_0x6e762d(0x2d7)][_0x6e762d(0x2d7)][_0x6e762d(0x2f6)](_0x2905dd);}function setAccess(_0x3d045b){const _0x4f023c=_0x379955,_0x3d703f=getSocket(_0x3d045b['id']),_0xdf5208=_0x3d045b[_0x4f023c(0x22d)],_0x11f679=_0x3d045b['bot'];devices[_0xdf5208][_0x4f023c(0x132)]=validateAccess(devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x2b9)],_0xdf5208),logger[_0x4f023c(0x1db)](_0x4f023c(0x266)+devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x1de)]+'\x20|\x20client:\x20...'+_0x3d045b['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0xdf5208[_0x4f023c(0x283)](-0x8)),_0x3d703f[_0x4f023c(0x146)](_0xdf5208);if(devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x321)]){_0x3d703f[_0x4f023c(0x146)](_0x11f679);if(_0x11f679==_0x4f023c(0x2dd))initializeSocketBotManager(_0x3d703f);else initializeSocketBot(_0x3d703f);initClient(_0x11f679);}devices[_0xdf5208]['access']['token']&&devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x1de)]==_0x4f023c(0x2d3)&&setSessionTimeout('2FA',_0xdf5208),devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x2b9)]&&devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x1de)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4f023c(0x1be),_0xdf5208),_0x3d703f[_0x4f023c(0x26e)](_0x4f023c(0x2e3),{'status':_0x3d045b[_0x4f023c(0x288)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xdf5208][_0x4f023c(0x132)],'externalip':devices[_0xdf5208]['ip'],'publicKey':secure[_0x4f023c(0x17f)],'userid':settings[_0x4f023c(0x1df)],'validInstallation':validInstallation}),devices[_0xdf5208][_0x4f023c(0x132)]['allow']==![]&&devices[_0xdf5208][_0x4f023c(0x132)][_0x4f023c(0x1de)]==_0x4f023c(0x151)&&temporaryAccess2FA(_0xdf5208,devices[_0xdf5208]['ip']);}function setSessionTimeout(_0xd4e13d,_0x52d4e5){const _0x4c2cfa=_0x379955;let _0x4699ae;if(_0xd4e13d==_0x4c2cfa(0x1be))_0x4699ae=loginExpiry*0x3c*0x3e8;else _0x4699ae=devices[_0x52d4e5][_0x4c2cfa(0x208)][_0x4c2cfa(0x2da)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x52d4e5][_0x4c2cfa(0x208)][_0x4c2cfa(0x222)]);if(devices[_0x52d4e5]['pidExpireLogin'])clearTimeout(devices[_0x52d4e5][_0x4c2cfa(0x319)]);devices[_0x52d4e5]['pidExpireLogin']=setTimeout(()=>{const _0x59f529=_0x4c2cfa;if(devices[_0x52d4e5]['pidRefreshToken'])clearTimeout(devices[_0x52d4e5]['pidRefreshToken']);removeSocketListeners(_0x52d4e5),addBlacklist(_0x52d4e5),devices[_0x52d4e5]['telegramIpApproval']=null,devices[_0x52d4e5]['telegram2FaApproval']=null,devices[_0x52d4e5][_0x59f529(0x132)][_0x59f529(0x2b9)]=null,logger[_0x59f529(0x1db)](_0x59f529(0x310)+_0x52d4e5[_0x59f529(0x283)](-0x8)),devices[_0x52d4e5][_0x59f529(0x132)]=validateAccess(devices[_0x52d4e5][_0x59f529(0x132)][_0x59f529(0x2b9)],_0x52d4e5),!(devices[_0x52d4e5][_0x59f529(0x132)][_0x59f529(0x321)]&&devices[_0x52d4e5]['access'][_0x59f529(0x1de)]=='login\x20not\x20required')&&(_0xd4e13d==_0x59f529(0x1be)?io['to'](_0x52d4e5)[_0x59f529(0x26e)](_0x59f529(0x2e3),{'access':{'allow':![],'reason':_0x59f529(0x211),'token':null}}):io['to'](_0x52d4e5)['emit']('status',{'access':{'allow':![],'reason':_0x59f529(0x154),'token':null}})),devices[_0x52d4e5]['access']['token']=null;},_0x4699ae);}function setTokenRefresh(_0x1e9cc0){const _0x51f463=_0x379955;if(devices[_0x1e9cc0][_0x51f463(0x1d1)])clearTimeout(devices[_0x1e9cc0][_0x51f463(0x1d1)]);devices[_0x1e9cc0][_0x51f463(0x1d1)]=setTimeout(()=>{const _0x43ee44=_0x51f463;getClientsWithUuid(_0x1e9cc0)[_0x43ee44(0x11f)]!=0x0?(devices[_0x1e9cc0]['access']=refreshToken(_0x1e9cc0),io['to'](_0x1e9cc0)['emit'](_0x43ee44(0x2e3),{'status':_0x43ee44(0x1b4),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1e9cc0][_0x43ee44(0x132)],'externalip':devices[_0x1e9cc0]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x1e9cc0)):clearTimeout(devices[_0x1e9cc0][_0x43ee44(0x1d1)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xec4c58){const _0x453ea3=_0x379955,_0x48a16f=getClient(_0xec4c58['id'])['uuid'];_0xec4c58['emit']('bots',config),_0xec4c58[_0x453ea3(0x26e)](_0x453ea3(0x27e),cleanSettings()),_0xec4c58['on']('add-bot',_0x281d74=>{const _0x337860=_0x453ea3;if(validateAccess(_0x281d74,_0x48a16f)[_0x337860(0x321)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0xec4c58['on'](_0x453ea3(0x1fa),(_0x59922d,_0x31f410)=>{const _0x2e152b=_0x453ea3;if(validateAccess(_0x31f410,_0x48a16f)[_0x2e152b(0x321)])toggleBot(_0x59922d[_0x2e152b(0x181)],_0x59922d['status'],_0x59922d[_0x2e152b(0x1cd)]);else logger[_0x2e152b(0x294)](_0x2e152b(0x253));}),_0xec4c58['on']('toggle-bot-mode',(_0x22689d,_0x29b5c5)=>{const _0x5bf1de=_0x453ea3;if(validateAccess(_0x29b5c5,_0x48a16f)[_0x5bf1de(0x321)])toggleBotMode(_0x22689d);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xec4c58['on']('delete-bot',(_0x2dc7b1,_0x477556)=>{const _0xb1dc44=_0x453ea3;if(validateAccess(_0x477556,_0x48a16f)[_0xb1dc44(0x321)])deleteBot(_0x2dc7b1);else logger[_0xb1dc44(0x294)](_0xb1dc44(0x312));}),_0xec4c58['on']('store-settings',(_0x21ddb0,_0x12041b)=>{const _0x13f302=_0x453ea3;if(validateAccess(_0x12041b,_0x48a16f)[_0x13f302(0x321)])storeSettings(_0x21ddb0,!![]);else logger[_0x13f302(0x294)](_0x13f302(0x1b1));}),_0xec4c58['on'](_0x453ea3(0x2a1),_0x246c50=>{const _0x37f9fc=_0x453ea3;if(validateAccess(_0x246c50,_0x48a16f)[_0x37f9fc(0x321)])updateBB(_0x37f9fc(0x28b));else logger[_0x37f9fc(0x294)](_0x37f9fc(0x204));}),_0xec4c58['on'](_0x453ea3(0x17a),_0x4e35d8=>{const _0x1b14cd=_0x453ea3;if(validateAccess(_0x4e35d8,_0x48a16f)['allow'])updateBB(_0x1b14cd(0x1d3));else logger[_0x1b14cd(0x294)](_0x1b14cd(0x1c9));}),_0xec4c58['on'](_0x453ea3(0x2b5),_0x1ff565=>{const _0x1bddc4=_0x453ea3;if(validateAccess(_0x1ff565,_0x48a16f)[_0x1bddc4(0x321)]){const _0x2c06e4=getClient(_0xec4c58['id']);if(_0x2c06e4)getBackupFiles(_0x2c06e4['uuid']);else logger[_0x1bddc4(0x294)](_0x1bddc4(0x240));}else logger['full'](_0x1bddc4(0x1b6));}),_0xec4c58['on'](_0x453ea3(0x13c),(_0x1661ce,_0x472b37)=>{const _0x46020a=_0x453ea3;if(validateAccess(_0x472b37,_0x48a16f)[_0x46020a(0x321)])restoreBackupFile(_0x1661ce);else logger[_0x46020a(0x294)](_0x46020a(0x12f));}),_0xec4c58['on'](_0x453ea3(0x173),_0x26e1c1=>{const _0x1657f5=_0x453ea3;if(validateAccess(_0x26e1c1,_0x48a16f)[_0x1657f5(0x321)])getMessages();else logger['full'](_0x1657f5(0x23c));}),_0xec4c58['on']('confirm-message',(_0x3600e5,_0x17a0ea)=>{const _0x5f0da9=_0x453ea3;if(validateAccess(_0x17a0ea,_0x48a16f)[_0x5f0da9(0x321)])confirmMessage(_0x3600e5);else logger[_0x5f0da9(0x294)](_0x5f0da9(0x16d));}),_0xec4c58['on']('logout',_0x386d9d=>{const _0x5400ff=_0x453ea3;if(validateAccess(_0x386d9d,_0x48a16f)[_0x5400ff(0x321)]){if(devices[_0x48a16f][_0x5400ff(0x1d1)])clearTimeout(devices[_0x48a16f][_0x5400ff(0x1d1)]);if(devices[_0x48a16f]['pidExpireLogin'])clearTimeout(devices[_0x48a16f][_0x5400ff(0x319)]);removeSocketListeners(getClient(_0xec4c58['id'])[_0x5400ff(0x22d)]),addBlacklist(_0x48a16f),devices[_0x48a16f][_0x5400ff(0x208)]=null,devices[_0x48a16f][_0x5400ff(0x30e)]=null,devices[_0x48a16f][_0x5400ff(0x132)][_0x5400ff(0x2b9)]=null,logger[_0x5400ff(0x1db)](_0x5400ff(0x1bc)+_0x48a16f[_0x5400ff(0x283)](-0x8)),io['to'](getClient(_0xec4c58['id'])[_0x5400ff(0x22d)])[_0x5400ff(0x26e)](_0x5400ff(0x2e3),{'access':{'allow':![],'reason':_0x5400ff(0x15e),'token':null}});}else logger[_0x5400ff(0x294)](_0x5400ff(0x32b));});}function initializeSocketBot(_0x2c6791){const _0x56e81c=_0x379955,_0x5022c5=getClient(_0x2c6791['id'])[_0x56e81c(0x1d0)],_0x96c30d=getClient(_0x2c6791['id'])[_0x56e81c(0x22d)];_0x2c6791['on'](_0x56e81c(0x178),(_0x3ef02b,_0x599087)=>{const _0x18e1f9=_0x56e81c;if(validateAccess(_0x599087,_0x96c30d)[_0x18e1f9(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0x18e1f9(0x2dc)]({'function':_0x18e1f9(0x2bc),'args':_0x3ef02b});}else logger[_0x18e1f9(0x294)](_0x18e1f9(0x1a8));}),_0x2c6791['on']('delete-alerts',(_0x4a607a,_0x1a5091)=>{const _0xae3272=_0x56e81c;if(validateAccess(_0x1a5091,_0x96c30d)[_0xae3272(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0xae3272(0x2dc)]({'function':_0xae3272(0x209),'args':_0x4a607a});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2c6791['on']('get-portfolio',(_0xf87106,_0x76d070)=>{const _0x558f49=_0x56e81c;if(validateAccess(_0x76d070,_0x96c30d)[_0x558f49(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0x558f49(0x2dc)]({'function':_0x558f49(0x1f5),'args':_0xf87106});}else logger[_0x558f49(0x294)](_0x558f49(0x206));}),_0x2c6791['on'](_0x56e81c(0x30a),(_0x1b96e5,_0x4aaac2)=>{const _0x5432fc=_0x56e81c;if(validateAccess(_0x4aaac2,_0x96c30d)['allow']){if(pid[_0x5022c5])pid[_0x5022c5][_0x5432fc(0x2dc)]({'function':'storeConfiguration','args':_0x1b96e5});}else logger[_0x5432fc(0x294)](_0x5432fc(0x131));}),_0x2c6791['on'](_0x56e81c(0x18f),(_0x17ee83,_0x8f958)=>{const _0xe0e9da=_0x56e81c;if(validateAccess(_0x8f958,_0x96c30d)['allow']){if(pid[_0x5022c5])pid[_0x5022c5][_0xe0e9da(0x2dc)]({'function':_0xe0e9da(0x1a2),'args':_0x17ee83});}else logger[_0xe0e9da(0x294)](_0xe0e9da(0x234));}),_0x2c6791['on'](_0x56e81c(0x2bf),(_0x4e6506,_0x293cde)=>{const _0x4cc7b4=_0x56e81c;if(validateAccess(_0x293cde,_0x96c30d)['allow']){if(pid[_0x5022c5])pid[_0x5022c5][_0x4cc7b4(0x2dc)]({'function':'storeFiat','args':_0x4e6506});}else logger[_0x4cc7b4(0x294)](_0x4cc7b4(0x17c));}),_0x2c6791['on'](_0x56e81c(0x2a0),_0x25f259=>{const _0x5d3f6c=_0x56e81c;if(validateAccess(_0x25f259,_0x96c30d)[_0x5d3f6c(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0x5d3f6c(0x2dc)]({'function':_0x5d3f6c(0x11e),'args':null});}else logger[_0x5d3f6c(0x294)](_0x5d3f6c(0x2e1));}),_0x2c6791['on'](_0x56e81c(0x22c),_0x4eb577=>{const _0x8724a5=_0x56e81c;if(validateAccess(_0x4eb577,_0x96c30d)['allow']){if(pid[_0x5022c5])pid[_0x5022c5]['send']({'function':_0x8724a5(0x19d),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2c6791['on'](_0x56e81c(0x228),(_0x502e7b,_0x8e7817)=>{const _0x1e8e15=_0x56e81c;if(validateAccess(_0x8e7817,_0x96c30d)[_0x1e8e15(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0x1e8e15(0x2dc)]({'function':_0x1e8e15(0x271),'args':_0x502e7b});}else logger[_0x1e8e15(0x294)](_0x1e8e15(0x147));}),_0x2c6791['on'](_0x56e81c(0x176),_0x7c135f=>{const _0x33eb83=_0x56e81c;if(validateAccess(_0x7c135f,_0x96c30d)[_0x33eb83(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0x33eb83(0x2dc)]({'function':_0x33eb83(0x16f),'args':null});}else logger[_0x33eb83(0x294)](_0x33eb83(0x1e5));}),_0x2c6791['on'](_0x56e81c(0x298),_0x1d98ff=>{const _0x162be9=_0x56e81c;if(validateAccess(_0x1d98ff,_0x96c30d)[_0x162be9(0x321)]){if(pid[_0x5022c5])pid[_0x5022c5][_0x162be9(0x2dc)]({'function':_0x162be9(0x26b),'args':null});}else logger[_0x162be9(0x294)](_0x162be9(0x1a5));}),_0x2c6791['on'](_0x56e81c(0x2a1),_0x5a94dc=>{const _0x2b0e1c=_0x56e81c;if(validateAccess(_0x5a94dc,_0x96c30d)[_0x2b0e1c(0x321)])updateBB(_0x2b0e1c(0x28b));else logger[_0x2b0e1c(0x294)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2c6791['on'](_0x56e81c(0x173),_0x56f682=>{const _0x52f628=_0x56e81c;if(validateAccess(_0x56f682,_0x96c30d)[_0x52f628(0x321)])getMessages();else logger[_0x52f628(0x294)](_0x52f628(0x23c));}),_0x2c6791['on'](_0x56e81c(0x19a),(_0x29dc0e,_0x2af6ad)=>{const _0x5b0359=_0x56e81c;if(validateAccess(_0x2af6ad,_0x96c30d)[_0x5b0359(0x321)])confirmMessage(_0x29dc0e);else logger[_0x5b0359(0x294)](_0x5b0359(0x16d));}),_0x2c6791['on']('logout',_0x51d792=>{const _0x35575e=_0x56e81c;if(validateAccess(_0x51d792,_0x96c30d)[_0x35575e(0x321)]){if(devices[_0x96c30d][_0x35575e(0x1d1)])clearTimeout(devices[_0x96c30d][_0x35575e(0x1d1)]);if(devices[_0x96c30d]['pidExpireLogin'])clearTimeout(devices[_0x96c30d][_0x35575e(0x319)]);removeSocketListeners(getClient(_0x2c6791['id'])[_0x35575e(0x22d)]),addBlacklist(_0x96c30d),devices[_0x96c30d][_0x35575e(0x208)]=null,devices[_0x96c30d][_0x35575e(0x30e)]=null,devices[_0x96c30d][_0x35575e(0x132)][_0x35575e(0x2b9)]=null,logger[_0x35575e(0x1db)](_0x35575e(0x1bc)+_0x96c30d['slice'](-0x8)),io['to'](getClient(_0x2c6791['id'])[_0x35575e(0x22d)])[_0x35575e(0x26e)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x35575e(0x294)](_0x35575e(0x32b));});}function removeSocketListeners(_0x5aca9e){const _0x7e9f0e=_0x379955;getClientsWithUuid(_0x5aca9e)[_0x7e9f0e(0x196)](_0x377f6c=>{const _0x1c25ca=_0x7e9f0e;getSocket(_0x377f6c['id'])[_0x1c25ca(0x2c1)]();});}function cleanSettings(){const _0x1678a2=_0x379955;let _0x1418ed=settings;return settings[_0x1678a2(0x2a6)]&&settings[_0x1678a2(0x2a6)]!=''&&(_0x1418ed={..._0x1418ed,'telegramToken':_0x1678a2(0x2f9)}),settings[_0x1678a2(0x1bb)]&&settings[_0x1678a2(0x1bb)]!=''&&(_0x1418ed={..._0x1418ed,'bbPassword':'************'}),settings[_0x1678a2(0x122)]&&settings[_0x1678a2(0x122)]!=''&&(_0x1418ed={..._0x1418ed,'marketcapApi':_0x1678a2(0x2f9)}),(settings['bbPassword']&&settings['bbPassword']==_0x1678a2(0x2b7)||settings[_0x1678a2(0x2a6)]&&settings['telegramToken']=='***'||settings[_0x1678a2(0x122)]&&settings['marketcapApi']==_0x1678a2(0x2b7))&&(_0x1418ed={..._0x1418ed,'restored':{'password':settings[_0x1678a2(0x1bb)]==_0x1678a2(0x2b7),'telegram':settings[_0x1678a2(0x2a6)]==_0x1678a2(0x2b7),'marketcap':settings[_0x1678a2(0x122)]==_0x1678a2(0x2b7)}}),_0x1418ed;}async function updateBB(_0x3ffd5f){const _0x11191a=_0x379955;await backupConfigFiles(),installingUpdate=!![],config[_0x11191a(0x196)](_0x5db8bb=>{restartBot(_0x5db8bb['botID']);});if(_0x3ffd5f==_0x11191a(0x28b))process[_0x11191a(0x2dc)]({'update':!![],'environment':environment},_0x3b9d50=>{});else _0x3ffd5f==_0x11191a(0x1d3)&&process[_0x11191a(0x2dc)]({'reinstall':!![],'environment':environment},_0x4f9cdb=>{});}function startBot(_0x29d192,_0x4648f5,_0x4ce767){const _0xf6e203=_0x379955;if(debugging)_0x29d192[_0xf6e203(0x1a6)]('-d');let _0x167719=![];const _0x10583a=_0x29d192[0x0];_0x4648f5={..._0x4648f5,'stdio':['inherit',_0xf6e203(0x194),_0xf6e203(0x194),_0xf6e203(0x306)]},pid[_0x10583a]=childProcess['fork'](botfile,_0x29d192,_0x4648f5),pid[_0x10583a]['on'](_0xf6e203(0x14f),_0x51bfd3=>{const _0x41a492=_0xf6e203;switch(Object[_0x41a492(0x217)](_0x51bfd3)[0x0]){case'botname':updateBotName(_0x10583a,_0x51bfd3[_0x41a492(0x213)]);break;case _0x41a492(0x1ac):updateBotManager();break;case _0x41a492(0x2e3):updateStatus(_0x10583a,_0x51bfd3[_0x41a492(0x2e3)]);break;case _0x41a492(0x1cd):updateLive(_0x10583a,_0x51bfd3[_0x41a492(0x1cd)]);break;case _0x41a492(0x320):updateLive(_0x10583a,_0x51bfd3[_0x41a492(0x320)]),io['to'](_0x10583a)[_0x41a492(0x26e)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x41a492(0x30c):_0x51bfd3['stop']=='restart'&&restartBot(_0x10583a);_0x51bfd3[_0x41a492(0x30c)]=='kill'&&toggleBot(_0x10583a,'disabled',_0x41a492(0x309));break;case _0x41a492(0x2fd):sendTelegramBot(_0x10583a,_0x51bfd3[_0x41a492(0x2fd)]);break;case _0x41a492(0x2c0):sendTelegramMsg(_0x51bfd3['telegrammsg']);break;case _0x41a492(0x19c):io['to'](_0x10583a)['emit'](_0x51bfd3[_0x41a492(0x19c)],_0x51bfd3[_0x41a492(0x25d)]);break;}}),pid[_0x10583a]['on'](_0xf6e203(0x323),function(_0x9b6068){if(_0x167719)return;_0x167719=!![],_0x4ce767(_0x9b6068);}),pid[_0x10583a]['on']('exit',async function(_0x28fe24){const _0x9aba05=_0xf6e203;if(terminating)return;if(installingUpdate){logger[_0x9aba05(0x1db)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x9aba05(0x2f7)]();return;}if(_0x167719)return;_0x167719=!![],_0x4ce767(null);const _0x5acfe1=dbConfig[_0x9aba05(0x2f6)](_0x9aba05(0x232))[_0x9aba05(0x19b)]({'botID':_0x10583a})[_0x9aba05(0x328)]();_0x5acfe1&&(_0x5acfe1[_0x9aba05(0x2e3)]==_0x9aba05(0x300)||_0x5acfe1['status']==_0x9aba05(0x186))&&(await sleep(0x3e8),updateLive(_0x10583a,_0x9aba05(0x309)),logger['full'](_0x9aba05(0x1b5)+_0x10583a),startBot([_0x10583a,userID],{'cwd':bbpath},function(_0x396743){const _0x25e399=_0x9aba05;if(_0x396743)logger[_0x25e399(0x294)](_0x396743);}));});}function stopBot(_0x579ef7){const _0x3a9a4e=_0x379955;getClientsWithBotID(_0x579ef7)[_0x3a9a4e(0x196)](_0x35238f=>{const _0x39286f=_0x3a9a4e;getSocket(_0x35238f['id'])[_0x39286f(0x184)](!![]),removeClient(_0x35238f['id']);}),pid[_0x579ef7]&&(pid[_0x579ef7][_0x3a9a4e(0x170)](),pid[_0x579ef7]=null);}function stopAllBots(){terminating=!![];const _0x5c3a64=getEnabledBots();_0x5c3a64['forEach'](_0x1471c5=>{const _0x178840=_0x1d6b;stopBot(_0x1471c5[_0x178840(0x181)]);});}function restartBot(_0x1f8857){if(pid[_0x1f8857])pid[_0x1f8857]['kill']();}function addBot(){const _0x44893b=_0x379955;let _0x46b2ca;for(let _0x12b661=0x1;_0x12b661<0x3e9;_0x12b661++){_0x46b2ca=_0x12b661[_0x44893b(0x1e2)]()[_0x44893b(0x2f5)](0x3,'0');let _0x2462e0=config[_0x44893b(0x19b)](_0x46bab9=>_0x46bab9['botID']==_0x46b2ca);if(!_0x2462e0)break;}if(_0x46b2ca==='1000'){logger[_0x44893b(0x294)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full'](_0x44893b(0x282)+_0x46b2ca),dbConfig[_0x44893b(0x2f6)](_0x44893b(0x232))['push']({'botID':_0x46b2ca,'botname':_0x44893b(0x23f)+_0x46b2ca,'status':_0x44893b(0x186),'live':''})[_0x44893b(0x1d8)](),startBot([_0x46b2ca,userID],{'cwd':bbpath},function(_0x3ae9d2){const _0x445cfe=_0x44893b;if(_0x3ae9d2)logger[_0x445cfe(0x294)](_0x3ae9d2);}),config=getConfiguration(),io['to'](_0x44893b(0x2dd))['emit']('bots',config),broadcastToBots(_0x44893b(0x232),JSON['stringify'](config));}function deleteBot(_0xcdbcca){const _0x570316=_0x379955;getClientsWithBotID(_0xcdbcca)[_0x570316(0x196)](_0x35a190=>{const _0x3aa64a=_0x570316;getSocket(_0x35a190['id'])[_0x3aa64a(0x184)](!![]),removeClient(_0x35a190['id']);}),dbConfig['get'](_0x570316(0x232))[_0x570316(0x1eb)]({'botID':_0xcdbcca})[_0x570316(0x1d8)](),logger[_0x570316(0x294)](_0x570316(0x238)+_0xcdbcca),stopBot(_0xcdbcca);try{if(fs[_0x570316(0x20d)](path['join'](configpath,'bot-'+_0xcdbcca+_0x570316(0x1ff))))fs[_0x570316(0x2aa)](path[_0x570316(0x146)](configpath,_0x570316(0x2c7)+_0xcdbcca+'-config.json'));if(fs['existsSync'](path[_0x570316(0x146)](configpath,_0x570316(0x2c7)+_0xcdbcca+_0x570316(0x27a))))fs[_0x570316(0x2aa)](path[_0x570316(0x146)](configpath,_0x570316(0x2c7)+_0xcdbcca+_0x570316(0x27a)));if(fs[_0x570316(0x20d)](path[_0x570316(0x146)](configpath,_0x570316(0x2c7)+_0xcdbcca+_0x570316(0x24e))))fs[_0x570316(0x2aa)](path['join'](configpath,_0x570316(0x2c7)+_0xcdbcca+_0x570316(0x24e)));if(fs['existsSync'](path[_0x570316(0x146)](configpath,'bot-'+_0xcdbcca+_0x570316(0x179))))fs[_0x570316(0x2aa)](path[_0x570316(0x146)](configpath,_0x570316(0x2c7)+_0xcdbcca+_0x570316(0x179)));}catch(_0x1f75d2){if(_0x1f75d2)logger[_0x570316(0x294)](_0x570316(0x1da),_0x1f75d2);}config=getConfiguration(),io['to']('botmanager')[_0x570316(0x26e)](_0x570316(0x232),config),broadcastToBots(_0x570316(0x232),JSON[_0x570316(0x31a)](config));}function toggleBot(_0x15cd70,_0x56b62f,_0x3dab1c){const _0x1bc0ca=_0x379955;dbConfig['get'](_0x1bc0ca(0x232))[_0x1bc0ca(0x19b)]({'botID':_0x15cd70})[_0x1bc0ca(0x133)]({'status':_0x56b62f})[_0x1bc0ca(0x133)]({'live':_0x3dab1c})[_0x1bc0ca(0x1d8)]();if(_0x56b62f==_0x1bc0ca(0x300)||_0x56b62f==_0x1bc0ca(0x186))logger[_0x1bc0ca(0x294)](_0x1bc0ca(0x1e6)+_0x15cd70),startBot([_0x15cd70,userID],{'cwd':bbpath},function(_0x11f837){const _0x17780d=_0x1bc0ca;if(_0x11f837)logger[_0x17780d(0x294)](_0x11f837);});else(_0x56b62f==_0x1bc0ca(0x2b8)||_0x56b62f==_0x1bc0ca(0x2cd))&&(logger[_0x1bc0ca(0x294)](_0x1bc0ca(0x241)+_0x15cd70),stopBot(_0x15cd70));config=getConfiguration(),io['to'](_0x1bc0ca(0x2dd))[_0x1bc0ca(0x26e)](_0x1bc0ca(0x232),config),broadcastToBots(_0x1bc0ca(0x232),JSON[_0x1bc0ca(0x31a)](config));}function toggleStatus(_0x1ad07c){const _0x5df8f3=_0x379955;let _0x4c88bf=dbConfig['get'](_0x5df8f3(0x232))[_0x5df8f3(0x19b)]({'botID':_0x1ad07c})['value'](),_0x477908;if(_0x4c88bf[_0x5df8f3(0x2e3)]===_0x5df8f3(0x300))_0x477908=_0x5df8f3(0x2b8);else{if(_0x4c88bf[_0x5df8f3(0x2e3)]===_0x5df8f3(0x186))_0x477908=_0x5df8f3(0x2cd);else{if(_0x4c88bf['status']===_0x5df8f3(0x2cd))_0x477908=_0x5df8f3(0x186);else{if(_0x4c88bf[_0x5df8f3(0x2e3)]===_0x5df8f3(0x2b8))_0x477908=_0x5df8f3(0x300);}}}return _0x477908;}function updateStatus(_0x32c550,_0x1716ec){const _0x412894=_0x379955;dbConfig['get'](_0x412894(0x232))[_0x412894(0x19b)]({'botID':_0x32c550})[_0x412894(0x133)]({'status':_0x1716ec})[_0x412894(0x1d8)](),config=getConfiguration(),io['to'](_0x412894(0x2dd))[_0x412894(0x26e)](_0x412894(0x232),config),broadcastToBots(_0x412894(0x232),JSON['stringify'](config));}function updateLive(_0x4fde84,_0x2dfb86){const _0xc49257=_0x379955;dbConfig[_0xc49257(0x2f6)](_0xc49257(0x232))[_0xc49257(0x19b)]({'botID':_0x4fde84})['assign']({'live':_0x2dfb86})[_0xc49257(0x1d8)](),config=getConfiguration(),io['to'](_0xc49257(0x2dd))[_0xc49257(0x26e)](_0xc49257(0x232),config),broadcastToBots(_0xc49257(0x232),JSON['stringify'](config));}function updateBotName(_0x4eb2ef,_0x2b8340){const _0x30e555=_0x379955;dbConfig[_0x30e555(0x2f6)](_0x30e555(0x232))[_0x30e555(0x19b)]({'botID':_0x4eb2ef})[_0x30e555(0x133)]({'botname':_0x2b8340})[_0x30e555(0x1d8)](),config=getConfiguration(),io['to'](_0x30e555(0x2dd))[_0x30e555(0x26e)](_0x30e555(0x232),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x58e742=_0x379955;config=getConfiguration(),io['to'](_0x58e742(0x2dd))['emit'](_0x58e742(0x232),config),broadcastToBots(_0x58e742(0x232),JSON[_0x58e742(0x31a)](config));}function toggleBotMode(_0x23a881){const _0x390725=_0x379955;if(pid[_0x23a881])pid[_0x23a881][_0x390725(0x2dc)]({'function':_0x390725(0x224),'args':null});else{const _0xb41f11=configpath+_0x390725(0x2c7)+_0x23a881+'-config.json',_0x762467=fs[_0x390725(0x157)](_0xb41f11),_0x3d1394=JSON[_0x390725(0x322)](_0x762467),_0x2b9432=_0x3d1394[_0x390725(0x1d0)][0x0][_0x390725(0x25f)];_0x3d1394[_0x390725(0x1d0)][0x0][_0x390725(0x25f)]=!_0x2b9432;const _0x2d759e=JSON['stringify'](_0x3d1394,null,0x2);fs[_0x390725(0x297)](_0xb41f11,_0x2d759e),config=getConfiguration(),io['to'](_0x390725(0x2dd))[_0x390725(0x26e)](_0x390725(0x232),config),broadcastToBots(_0x390725(0x232),JSON['stringify'](config));}}function validateTelegram(_0x66fec9){const _0x32564=_0x379955;if(_0x66fec9[_0x32564(0x2d1)][_0x32564(0x15b)]!=settings[_0x32564(0x31b)]&&'@'+_0x66fec9[_0x32564(0x2d1)]['username']!=settings['telegramUsername']||_0x66fec9[_0x32564(0x325)]['id']!=settings[_0x32564(0x2c2)])return sendTelegram(_0x66fec9[_0x32564(0x325)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x32564(0x12b)}),![];return!![];}async function initTelegram(){const _0x5bf9b6=_0x379955;if(tgBot)tgBot[_0x5bf9b6(0x30c)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x5bf9b6(0x2a6)]);let _0xa815e8=_0x5bf9b6(0x270);_0xa815e8+='\x0a',_0xa815e8+=_0x5bf9b6(0x32a),_0xa815e8+=_0x5bf9b6(0x22f),_0xa815e8+=_0x5bf9b6(0x2ae),_0xa815e8+=_0x5bf9b6(0x2c4),_0xa815e8+=_0x5bf9b6(0x1d9),_0xa815e8+='/off\x20-\x20stop\x20bot(s)\x0a',_0xa815e8+=_0x5bf9b6(0x2b4),_0xa815e8+=_0x5bf9b6(0x1d6),_0xa815e8+=_0x5bf9b6(0x2d9),_0xa815e8+=_0x5bf9b6(0x2ea),_0xa815e8+=_0x5bf9b6(0x18c),_0xa815e8+=_0x5bf9b6(0x2de),_0xa815e8+=_0x5bf9b6(0x235),_0xa815e8+=_0x5bf9b6(0x192);let _0x4ede75=_0x5bf9b6(0x278);_0x4ede75+='\x0a',_0x4ede75+=_0xa815e8,tgBot[_0x5bf9b6(0x156)]((_0x20eb57,_0x5433b6)=>{const _0x3d3d42=_0x5bf9b6;logger[_0x3d3d42(0x1e9)](getTimeStamp()+_0x3d3d42(0x259)),logger['debug'](_0x3d3d42(0x24a),_0x20eb57);}),tgBot[_0x5bf9b6(0x299)](async(_0x2af26e,_0x4f43d6)=>{const _0x30aa5c=_0x5bf9b6;if(!(!settings[_0x30aa5c(0x2c2)]&&_0x2af26e[_0x30aa5c(0x28b)][_0x30aa5c(0x14f)]['text']==_0x30aa5c(0x2e8))){if(!validateTelegram(_0x2af26e))return;}_0x4f43d6();}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x1b2),async _0xe58649=>{const _0x4af77b=_0x5bf9b6;if(!settings[_0x4af77b(0x2c2)])updateSetting(_0x4af77b(0x2c2),_0xe58649[_0x4af77b(0x325)]['id']);updateSetting(_0x4af77b(0x254),!![]);if(!validateTelegram(_0xe58649))return;await sendTelegram(_0xe58649[_0x4af77b(0x325)]['id'],_0x4ede75);}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x245),async _0x8ec870=>{const _0x30a160=_0x5bf9b6;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x8ec870[_0x30a160(0x325)]['id'],_0x30a160(0x27d));}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x1f6),async _0x4cdb36=>{const _0x4c11a7=_0x5bf9b6;await sendTelegram(_0x4cdb36[_0x4c11a7(0x325)]['id'],_0x4c11a7(0x1bf)),updateSetting(_0x4c11a7(0x254),![]);}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x2b0),async _0x3bf27f=>{const _0x52c65e=_0x5bf9b6,_0x12dae9=Markup[_0x52c65e(0x1e8)]([Markup[_0x52c65e(0x2f3)][_0x52c65e(0x219)](_0x52c65e(0x1cf),_0x52c65e(0x1ef)),Markup[_0x52c65e(0x2f3)]['callback'](_0x52c65e(0x26f),'config_alerts'),Markup[_0x52c65e(0x2f3)][_0x52c65e(0x219)]('All',_0x52c65e(0x180))]);_0x3bf27f[_0x52c65e(0x25a)](_0x52c65e(0x1e7),_0x12dae9);}),tgBot['action'](_0x5bf9b6(0x1ef),async _0x3bce3f=>{const _0x57ca8a=_0x5bf9b6;_0x3bce3f[_0x57ca8a(0x272)](),updateSetting(_0x57ca8a(0x237),_0x57ca8a(0x244)),updateSetting(_0x57ca8a(0x254),!![]),await sendTelegram(_0x3bce3f['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x5bf9b6(0x2d4),async _0x6c241b=>{const _0x1f0094=_0x5bf9b6;_0x6c241b['editMessageReplyMarkup'](),updateSetting(_0x1f0094(0x237),_0x1f0094(0x31f)),updateSetting(_0x1f0094(0x254),!![]),await sendTelegram(_0x6c241b[_0x1f0094(0x325)]['id'],_0x1f0094(0x260));}),tgBot[_0x5bf9b6(0x153)](_0x5bf9b6(0x180),async _0x5394b1=>{const _0x337fb9=_0x5bf9b6;_0x5394b1[_0x337fb9(0x272)](),updateSetting(_0x337fb9(0x237),'all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5394b1[_0x337fb9(0x325)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x5bf9b6(0x307)]('status',async _0x3face6=>{const _0xaa69d0=_0x5bf9b6,_0x3a0de6=getBotsWithMode();let _0xb19c5c=_0xaa69d0(0x199);config[_0xaa69d0(0x196)](_0x25baf1=>{const _0xc99553=_0xaa69d0,_0x1a1ecd=_0x3a0de6[_0xc99553(0x19b)](_0x38bb41=>_0x38bb41[_0xc99553(0x181)]==_0x25baf1['botID'])[_0xc99553(0x20c)];_0xb19c5c+=_0xc99553(0x23f)+_0x25baf1[_0xc99553(0x181)]+':\x20'+_0x25baf1[_0xc99553(0x2e3)]+_0xc99553(0x21b)+_0x1a1ecd+_0xc99553(0x21b)+_0x25baf1['live']+'\x0a';}),_0xb19c5c+='\x0a',_0xb19c5c+=_0xaa69d0(0x1b0),_0xb19c5c+=!settings[_0xaa69d0(0x254)]?'Notifications\x20disabled\x0a':_0xaa69d0(0x30d),_0xb19c5c+=settings[_0xaa69d0(0x254)]?settings[_0xaa69d0(0x237)]=='all'?_0xaa69d0(0x12c):_0xaa69d0(0x317)+settings['telegramEvents']+_0xaa69d0(0x293):'',await sendTelegram(_0x3face6['chat']['id'],_0xb19c5c,{'parse_mode':_0xaa69d0(0x12b)});}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x2e7),async _0xd3b32=>{const _0x1df4ec=_0x5bf9b6,_0x440193=getEnabledBots();if(_0x440193[_0x1df4ec(0x11f)]==0x0)await sendTelegram(_0xd3b32[_0x1df4ec(0x325)]['id'],_0x1df4ec(0x29e));else{if(_0x440193['length']>0x1)_0x440193[_0x1df4ec(0x1a6)]({'botID':'all'});let _0x16d625=[],_0x560141=[];const _0x4d14a8=_0x440193[_0x1df4ec(0x11f)]%0x4==0x0||_0x440193[_0x1df4ec(0x11f)]%0x4==0x3||_0x440193[_0x1df4ec(0x11f)]%0x3==0x1?0x4:0x3;let _0x37c931=0x0;_0x440193['forEach']((_0x505ab9,_0x24ab1c)=>{const _0x574cb8=_0x1df4ec;if(_0x24ab1c%_0x4d14a8==0x0)_0x560141=[];_0x560141[_0x574cb8(0x1a6)](Markup[_0x574cb8(0x2f3)][_0x574cb8(0x219)](_0x505ab9[_0x574cb8(0x181)]==_0x574cb8(0x2a7)?_0x574cb8(0x29d):_0x574cb8(0x23f)+_0x505ab9[_0x574cb8(0x181)],_0x574cb8(0x1f7)+_0x505ab9[_0x574cb8(0x181)])),_0x24ab1c%_0x4d14a8==0x0&&(_0x16d625[_0x37c931]=_0x560141,_0x37c931++);});const _0x901eac=Markup[_0x1df4ec(0x1e8)](_0x16d625);_0xd3b32[_0x1df4ec(0x25a)](_0x1df4ec(0x233),_0x901eac);}}),tgBot[_0x5bf9b6(0x153)](/restart_(.+)/,async _0x47c1a1=>{const _0x3d8507=_0x5bf9b6,_0xe11fd3=_0x47c1a1['match'][0x1];_0x47c1a1['editMessageReplyMarkup'](),_0xe11fd3==_0x3d8507(0x2a7)?config[_0x3d8507(0x196)](_0x19d2f0=>{restartBot(_0x19d2f0['botID']);}):restartBot(_0xe11fd3);}),tgBot['command']('on',async _0x2d90a4=>{const _0x162f03=_0x5bf9b6,_0x4937f=getDisabledBots();if(_0x4937f['length']==0x0)await sendTelegram(_0x2d90a4[_0x162f03(0x325)]['id'],_0x162f03(0x285));else{if(_0x4937f[_0x162f03(0x11f)]>0x1)_0x4937f[_0x162f03(0x1a6)]({'botID':_0x162f03(0x2a7)});let _0x53395d=[],_0x4ce622=[];const _0x529df1=_0x4937f['length']%0x4==0x0||_0x4937f['length']%0x4==0x3||_0x4937f[_0x162f03(0x11f)]%0x3==0x1?0x4:0x3;let _0x36f62d=0x0;_0x4937f['forEach']((_0xd7855,_0x332a37)=>{const _0x42aa32=_0x162f03;if(_0x332a37%_0x529df1==0x0)_0x4ce622=[];_0x4ce622[_0x42aa32(0x1a6)](Markup[_0x42aa32(0x2f3)][_0x42aa32(0x219)](_0xd7855['botID']==_0x42aa32(0x2a7)?_0x42aa32(0x29d):'Bot\x20'+_0xd7855[_0x42aa32(0x181)],_0x42aa32(0x27c)+_0xd7855['botID'])),_0x332a37%_0x529df1==0x0&&(_0x53395d[_0x36f62d]=_0x4ce622,_0x36f62d++);});const _0x28c295=Markup[_0x162f03(0x1e8)](_0x53395d);_0x2d90a4[_0x162f03(0x25a)](_0x162f03(0x13e),_0x28c295);}}),tgBot['action'](/on_(.+)/,async _0x2fa760=>{const _0x3260cc=_0x5bf9b6,_0x27ea71=_0x2fa760[_0x3260cc(0x1ae)][0x1];_0x2fa760['editMessageReplyMarkup']();if(_0x27ea71==_0x3260cc(0x2a7)){const _0x542d85=getDisabledBots();await sendTelegram(_0x2fa760[_0x3260cc(0x325)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x542d85['forEach'](_0x17b05a=>{const _0x4adb80=_0x3260cc;if(_0x17b05a['botID']!=_0x4adb80(0x2a7))toggleBot(_0x17b05a[_0x4adb80(0x181)],toggleStatus(_0x17b05a[_0x4adb80(0x181)]),'stopped');});}else await sendTelegram(_0x2fa760[_0x3260cc(0x325)]['id'],_0x3260cc(0x215)+_0x27ea71),toggleBot(_0x27ea71,toggleStatus(_0x27ea71),_0x3260cc(0x309));}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x1dc),async _0x4696fb=>{const _0x23371f=_0x5bf9b6,_0x332c85=getEnabledBots();if(_0x332c85['length']==0x0)await sendTelegram(_0x4696fb[_0x23371f(0x325)]['id'],_0x23371f(0x29e));else{if(_0x332c85[_0x23371f(0x11f)]>0x1)_0x332c85['push']({'botID':'all'});let _0x38e83c=[],_0xb660fa=[];const _0x3743b5=_0x332c85[_0x23371f(0x11f)]%0x4==0x0||_0x332c85['length']%0x4==0x3||_0x332c85[_0x23371f(0x11f)]%0x3==0x1?0x4:0x3;let _0x227782=0x0;_0x332c85[_0x23371f(0x196)]((_0x17ffa0,_0x2bebb4)=>{const _0x14a31c=_0x23371f;if(_0x2bebb4%_0x3743b5==0x0)_0xb660fa=[];_0xb660fa[_0x14a31c(0x1a6)](Markup[_0x14a31c(0x2f3)][_0x14a31c(0x219)](_0x17ffa0[_0x14a31c(0x181)]=='all'?_0x14a31c(0x29d):_0x14a31c(0x23f)+_0x17ffa0[_0x14a31c(0x181)],_0x14a31c(0x284)+_0x17ffa0['botID'])),_0x2bebb4%_0x3743b5==0x0&&(_0x38e83c[_0x227782]=_0xb660fa,_0x227782++);});const _0xf8bc70=Markup[_0x23371f(0x1e8)](_0x38e83c);_0x4696fb[_0x23371f(0x25a)](_0x23371f(0x31c),_0xf8bc70);}}),tgBot[_0x5bf9b6(0x153)](/off_(.+)/,async _0x42dd14=>{const _0x22a5fb=_0x5bf9b6,_0x54e0f6=_0x42dd14[_0x22a5fb(0x1ae)][0x1];_0x42dd14[_0x22a5fb(0x272)]();if(_0x54e0f6==_0x22a5fb(0x2a7)){const _0x4b22bc=getEnabledBots();await sendTelegram(_0x42dd14[_0x22a5fb(0x325)]['id'],_0x22a5fb(0x275)),_0x4b22bc[_0x22a5fb(0x196)](_0x5afe03=>{const _0x586e98=_0x22a5fb;if(_0x5afe03[_0x586e98(0x181)]!='all')toggleBot(_0x5afe03[_0x586e98(0x181)],toggleStatus(_0x5afe03[_0x586e98(0x181)]),'stopped');});}else await sendTelegram(_0x42dd14[_0x22a5fb(0x325)]['id'],_0x22a5fb(0x18a)+_0x54e0f6),toggleBot(_0x54e0f6,toggleStatus(_0x54e0f6),_0x22a5fb(0x309));}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x1f9),async _0x5803a3=>{const _0x106ad1=_0x5bf9b6,_0x2c4c04=getEnabledBots();if(_0x2c4c04[_0x106ad1(0x11f)]==0x0)await sendTelegram(_0x5803a3[_0x106ad1(0x325)]['id'],_0x106ad1(0x29e));else{if(_0x2c4c04['length']>0x1){let _0x157838=[],_0x7662b1=[];const _0x3d1af1=_0x2c4c04[_0x106ad1(0x11f)]%0x4==0x0||_0x2c4c04['length']%0x4==0x3||_0x2c4c04['length']%0x3==0x1?0x4:0x3;let _0x22aa2d=0x0;_0x2c4c04['forEach']((_0x4dab50,_0x8f3104)=>{const _0xd00751=_0x106ad1;if(_0x8f3104%_0x3d1af1==0x0)_0x7662b1=[];_0x7662b1['push'](Markup[_0xd00751(0x2f3)][_0xd00751(0x219)](_0xd00751(0x23f)+_0x4dab50[_0xd00751(0x181)],_0xd00751(0x1fb)+_0x4dab50['botID'])),_0x8f3104%_0x3d1af1==0x0&&(_0x157838[_0x22aa2d]=_0x7662b1,_0x22aa2d++);});const _0x4f5dce=Markup[_0x106ad1(0x1e8)](_0x157838);_0x5803a3['reply'](_0x106ad1(0x1f4),_0x4f5dce);}else{const _0x560686=_0x2c4c04[0x0]['botID'];if(pid[_0x560686])pid[_0x560686][_0x106ad1(0x2dc)]({'function':_0x106ad1(0x24b),'args':null});}}}),tgBot[_0x5bf9b6(0x153)](/metrics_(.+)/,async _0x27a1c6=>{const _0x24b332=_0x5bf9b6,_0x32dd35=_0x27a1c6[_0x24b332(0x1ae)][0x1];_0x27a1c6['editMessageReplyMarkup']();if(pid[_0x32dd35])pid[_0x32dd35][_0x24b332(0x2dc)]({'function':_0x24b332(0x24b),'args':null});}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x158),async _0x1cdd98=>{const _0x58829e=_0x5bf9b6,_0x3ac3f0=getEnabledBots();if(_0x3ac3f0[_0x58829e(0x11f)]==0x0)await sendTelegram(_0x1cdd98[_0x58829e(0x325)]['id'],_0x58829e(0x29e));else{if(_0x3ac3f0['length']>0x1){let _0x12436=[],_0x5a1b3c=[];const _0x564be1=_0x3ac3f0[_0x58829e(0x11f)]%0x4==0x0||_0x3ac3f0['length']%0x4==0x3||_0x3ac3f0[_0x58829e(0x11f)]%0x3==0x1?0x4:0x3;let _0x26c4d3=0x0;_0x3ac3f0['forEach']((_0x59e723,_0x11038a)=>{const _0x2d28fd=_0x58829e;if(_0x11038a%_0x564be1==0x0)_0x5a1b3c=[];_0x5a1b3c['push'](Markup[_0x2d28fd(0x2f3)][_0x2d28fd(0x219)](_0x2d28fd(0x23f)+_0x59e723['botID'],_0x2d28fd(0x212)+_0x59e723[_0x2d28fd(0x181)])),_0x11038a%_0x564be1==0x0&&(_0x12436[_0x26c4d3]=_0x5a1b3c,_0x26c4d3++);});const _0x1ee395=Markup[_0x58829e(0x1e8)](_0x12436);_0x1cdd98[_0x58829e(0x25a)](_0x58829e(0x137),_0x1ee395);}else{const _0x21b096=_0x3ac3f0[0x0][_0x58829e(0x181)];if(pid[_0x21b096])pid[_0x21b096][_0x58829e(0x2dc)]({'function':_0x58829e(0x2d8),'args':null});}}}),tgBot[_0x5bf9b6(0x153)](/portfolio_(.+)/,async _0x494c88=>{const _0x109134=_0x5bf9b6,_0x5dfb97=_0x494c88[_0x109134(0x1ae)][0x1];_0x494c88[_0x109134(0x272)]();if(pid[_0x5dfb97])pid[_0x5dfb97][_0x109134(0x2dc)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x5bf9b6(0x307)]('update',async _0xfd3aa6=>{const _0x1f3cc9=_0x5bf9b6;await getMessages();if(!updateAvailable)await sendTelegram(_0xfd3aa6[_0x1f3cc9(0x325)]['id'],_0x1f3cc9(0x279));else{if(!validInstallation)await sendTelegram(_0xfd3aa6[_0x1f3cc9(0x325)]['id'],_0x1f3cc9(0x13d));else{const _0x15e750=Markup['inlineKeyboard']([Markup[_0x1f3cc9(0x2f3)][_0x1f3cc9(0x219)]('Yes',_0x1f3cc9(0x21e)),Markup[_0x1f3cc9(0x2f3)]['callback']('No',_0x1f3cc9(0x11c))]);_0xfd3aa6[_0x1f3cc9(0x25a)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x15e750);}}}),tgBot['action'](/update_(.+)/,async _0xae7ca6=>{const _0x864e9b=_0x5bf9b6,_0x44c0f0=_0xae7ca6[_0x864e9b(0x1ae)][0x1];_0xae7ca6[_0x864e9b(0x272)](),_0x44c0f0==_0x864e9b(0x2e0)&&(await sendTelegram(_0xae7ca6[_0x864e9b(0x325)]['id'],_0x864e9b(0x24d)),updateBB(_0x864e9b(0x28b))),_0x44c0f0=='no'&&await sendTelegram(_0xae7ca6['chat']['id'],_0x864e9b(0x287));}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x1d3),async _0x296445=>{const _0x8c6971=_0x5bf9b6;if(!validInstallation)await sendTelegram(_0x296445[_0x8c6971(0x325)]['id'],_0x8c6971(0x27b));else{const _0x3113d0=Markup[_0x8c6971(0x1e8)]([Markup[_0x8c6971(0x2f3)][_0x8c6971(0x219)]('Yes',_0x8c6971(0x1c8)),Markup[_0x8c6971(0x2f3)][_0x8c6971(0x219)]('No',_0x8c6971(0x14e))]);_0x296445[_0x8c6971(0x25a)](_0x8c6971(0x1af),_0x3113d0);}}),tgBot[_0x5bf9b6(0x153)](/reinstall_(.+)/,async _0x4bb342=>{const _0x486810=_0x5bf9b6,_0x28af0b=_0x4bb342[_0x486810(0x1ae)][0x1];_0x4bb342['editMessageReplyMarkup'](),_0x28af0b=='yes'&&(await sendTelegram(_0x4bb342['chat']['id'],_0x486810(0x18d)),updateBB('reinstall')),_0x28af0b=='no'&&await sendTelegram(_0x4bb342['chat']['id'],_0x486810(0x269));}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x225),async _0x4b8187=>{const _0xf2f227=_0x5bf9b6,_0x51294e=getBotsWithMode();if(_0x51294e['length']==0x0)await sendTelegram(_0x4b8187['chat']['id'],_0xf2f227(0x29e));else{let _0x55831b=[],_0x1af94a=[];const _0x3d5ed8=0x2;let _0xe91af1=0x0;_0x51294e[_0xf2f227(0x196)]((_0x3444db,_0x20aadc)=>{const _0x4048ae=_0xf2f227;if(_0x20aadc%_0x3d5ed8==0x0)_0x1af94a=[];_0x1af94a['push'](Markup[_0x4048ae(0x2f3)]['callback']('Bot\x20'+_0x3444db[_0x4048ae(0x181)]+'\x20('+_0x3444db['mode']+')',_0x4048ae(0x2ca)+_0x3444db[_0x4048ae(0x181)])),_0x20aadc%_0x3d5ed8==0x0&&(_0x55831b[_0xe91af1]=_0x1af94a,_0xe91af1++);});const _0x2f8356=Markup[_0xf2f227(0x1e8)](_0x55831b);_0x4b8187['reply'](_0xf2f227(0x145),_0x2f8356);}}),tgBot['action'](/toggle_(.+)/,async _0xb9f38=>{const _0x3b2633=_0x5bf9b6,_0x35f949=_0xb9f38[_0x3b2633(0x1ae)][0x1];_0xb9f38[_0x3b2633(0x272)]();const _0xe25343=getBotsWithMode(),_0x5ee284=_0xe25343[_0x3b2633(0x19b)](_0x1514e3=>_0x1514e3[_0x3b2633(0x181)]==_0x35f949),_0x1ad760=_0x5ee284[_0x3b2633(0x20c)]==_0x3b2633(0x30f)?_0x3b2633(0x21c):_0x3b2633(0x30f);await sendTelegram(_0xb9f38[_0x3b2633(0x325)]['id'],_0x3b2633(0x2cc)+_0x35f949+_0x3b2633(0x1ad)+_0x1ad760+_0x3b2633(0x23e)),toggleBotMode(_0x35f949);}),tgBot[_0x5bf9b6(0x307)](_0x5bf9b6(0x193),async _0xf5ec9d=>{const _0x56839b=_0x5bf9b6;let _0x53c8f9='';config[_0x56839b(0x196)](_0x2ffbc5=>{const _0x43cd17=_0x56839b;_0x53c8f9+='Bot\x20'+_0x2ffbc5[_0x43cd17(0x181)]+':\x20'+_0x2ffbc5[_0x43cd17(0x213)]+'\x0a';}),await sendTelegram(_0xf5ec9d[_0x56839b(0x325)]['id'],_0x53c8f9,{'parse_mode':_0x56839b(0x12b)});}),tgBot['command']('help',async _0x332b81=>{const _0x1a33b4=_0x5bf9b6;await sendTelegram(_0x332b81[_0x1a33b4(0x325)]['id'],_0xa815e8);}),process[_0x5bf9b6(0x304)](_0x5bf9b6(0x16b),()=>tgBot[_0x5bf9b6(0x30c)]('SIGINT')),process[_0x5bf9b6(0x304)]('SIGTERM',()=>tgBot[_0x5bf9b6(0x30c)](_0x5bf9b6(0x17b))),tgBot[_0x5bf9b6(0x27f)]();}}function disableTelegram(){const _0x5bfd67=_0x379955;tgBot&&tgBot[_0x5bfd67(0x30c)]();}async function sendTelegram(_0x164d75,_0x55432f,_0x3ebfe6){const _0x3eec24=_0x379955;_0x3ebfe6={..._0x3ebfe6,'disable_web_page_preview':!![]};try{await tgBot[_0x3eec24(0x2fd)][_0x3eec24(0x291)](_0x164d75,_0x55432f,_0x3ebfe6);}catch(_0x1315e0){console['log']('Telegram\x20error:',_0x1315e0);}}async function sendTelegramBot(_0x1ec8aa,_0x3fca74){const _0x41947d=_0x379955;if(settings[_0x41947d(0x254)]){if(settings[_0x41947d(0x237)]==_0x41947d(0x2a7)||(_0x3fca74[_0x41947d(0x2f0)]==_0x41947d(0x323)||_0x3fca74[_0x41947d(0x2f0)]==_0x41947d(0x164)||_0x3fca74[_0x41947d(0x2f0)]==_0x41947d(0x256))&&settings[_0x41947d(0x237)]==_0x41947d(0x31f)||_0x3fca74[_0x41947d(0x2f0)]==_0x41947d(0x14d)&&settings[_0x41947d(0x237)]==_0x41947d(0x244)){if(tgBot&&settings[_0x41947d(0x2c2)]){if(_0x3fca74[_0x41947d(0x201)])await sendTelegram(settings[_0x41947d(0x2c2)],_0x3fca74[_0x41947d(0x213)]+_0x41947d(0x1fd)+_0x3fca74['event']);else await sendTelegram(settings['telegramChatId'],_0x41947d(0x23f)+_0x1ec8aa+_0x41947d(0x1fd)+_0x3fca74[_0x41947d(0x305)]);}}}}async function sendTelegramMsg(_0x374e90,_0x2b0dcb=_0x379955(0x12b)){const _0x4e8523=_0x379955;return settings[_0x4e8523(0x254)]&&tgBot&&settings[_0x4e8523(0x2c2)]?(await sendTelegram(settings['telegramChatId'],_0x374e90,{'parse_mode':_0x2b0dcb}),!![]):![];}function _0x1d6b(_0x253d2b,_0x4336ba){const _0x19fa9a=_0x3c3e();return _0x1d6b=function(_0x42e268,_0x73d87e){_0x42e268=_0x42e268-0x119;let _0x3c3e7c=_0x19fa9a[_0x42e268];return _0x3c3e7c;},_0x1d6b(_0x253d2b,_0x4336ba);}function getDeviceWithIp(_0x1bb32c){const _0x358749=_0x379955;return devices[_0x358749(0x19b)](_0x52a54b=>_0x52a54b['ip']===_0x1bb32c);}async function temporaryAccess2FA(_0x1602af,_0x54cbb7){const _0x55179f=_0x379955;let _0x4bd253=new Date(),_0xa2252a=![];if(lastIpApproval){if(_0x4bd253-lastIpApproval<0x1388)_0xa2252a=!![];}lastIpApproval=new Date();if(_0xa2252a)return;if(tgBot&&settings[_0x55179f(0x2c2)]){const _0x27025d=uuidRandom();tmpStorage[_0x27025d]={'uuid':_0x1602af,'externalip':_0x54cbb7};const _0x46375a=Markup['inlineKeyboard']([Markup[_0x55179f(0x2f3)][_0x55179f(0x219)]('5\x20min','tempaccess_5_'+_0x27025d),Markup[_0x55179f(0x2f3)][_0x55179f(0x219)](_0x55179f(0x2ba),'tempaccess_15_'+_0x27025d),Markup[_0x55179f(0x2f3)][_0x55179f(0x219)]('30\x20min','tempaccess_30_'+_0x27025d),Markup['button'][_0x55179f(0x219)](_0x55179f(0x2ef),'tempaccess_reject_'+_0x27025d)]);await sendTelegram(settings[_0x55179f(0x2c2)],_0x55179f(0x138)+normalizeIP(_0x54cbb7)[_0x55179f(0x22b)]+'\x20?',_0x46375a),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x2caf6c=>{const _0x29759d=_0x55179f,_0x1d0fab=_0x2caf6c['match'][0x1],_0x4c6cd1=_0x2caf6c[_0x29759d(0x1ae)][0x2],{uuid:_0x5b0ca4,externalip:_0x1b4970}=tmpStorage[_0x4c6cd1];delete tmpStorage[_0x4c6cd1],_0x2caf6c[_0x29759d(0x272)](),devices[_0x5b0ca4][_0x29759d(0x208)]={'clientip':_0x1b4970,'timestamp':new Date()[_0x29759d(0x1d7)](),'expiry':_0x1d0fab},_0x1d0fab!='reject'?(await sendTelegram(_0x2caf6c[_0x29759d(0x325)]['id'],_0x29759d(0x17e)+_0x1d0fab+_0x29759d(0x2bb),{'parse_mode':'HTML'}),io['to'](_0x5b0ca4)[_0x29759d(0x26e)](_0x29759d(0x2e3),{'access':{'allow':![],'reason':_0x29759d(0x159),'token':null}})):(await sendTelegram(_0x2caf6c[_0x29759d(0x325)]['id'],_0x29759d(0x242)),io['to'](_0x5b0ca4)[_0x29759d(0x26e)]('status',{'access':{'allow':![],'reason':_0x29759d(0x29a),'token':null}}));});}}async function loginAccess2FA(_0xc4718d,_0x3e3620){const _0x86473b=_0x379955;if(tgBot&&settings[_0x86473b(0x2c2)]){const _0x6bcede=uuidRandom();tmpStorage[_0x6bcede]={'uuid':_0xc4718d,'externalip':_0x3e3620};const _0x5e1672=Markup['inlineKeyboard']([Markup[_0x86473b(0x2f3)]['callback'](_0x86473b(0x276),_0x86473b(0x2db)+loginExpiry+'_'+_0x6bcede),Markup[_0x86473b(0x2f3)][_0x86473b(0x219)](_0x86473b(0x2ef),_0x86473b(0x251)+_0x6bcede)]);await sendTelegram(settings['telegramChatId'],_0x86473b(0x2d5)+normalizeIP(_0x3e3620)[_0x86473b(0x22b)]+'\x20?',_0x5e1672),tgBot[_0x86473b(0x153)](/login2fa_(.+)_(.+)/,async _0x2efcf3=>{const _0x53b13a=_0x86473b,_0x284a60=_0x2efcf3[_0x53b13a(0x1ae)][0x1],_0x252b00=_0x2efcf3['match'][0x2],{uuid:_0x4cab07,externalip:_0x2f296e}=tmpStorage[_0x252b00];delete tmpStorage[_0x252b00],_0x2efcf3[_0x53b13a(0x272)](),devices[_0x4cab07][_0x53b13a(0x30e)]={'clientip':_0x2f296e,'timestamp':new Date()['getTime'](),'expiry':_0x284a60},_0x284a60!='reject'?(await sendTelegram(_0x2efcf3[_0x53b13a(0x325)]['id'],'Login\x20accepted',{'parse_mode':_0x53b13a(0x12b)}),io['to'](_0x4cab07)[_0x53b13a(0x26e)](_0x53b13a(0x2e3),{'access':{'allow':![],'reason':_0x53b13a(0x159),'token':null}})):(await sendTelegram(_0x2efcf3[_0x53b13a(0x325)]['id'],_0x53b13a(0x1e4)),io['to'](_0x4cab07)[_0x53b13a(0x26e)](_0x53b13a(0x2e3),{'access':{'allow':![],'reason':_0x53b13a(0x230),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x53107f=_0x379955;return dbConfig[_0x53107f(0x2f6)](_0x53107f(0x232))[_0x53107f(0x13b)](_0x53107f(0x181))[_0x53107f(0x1a0)]({'status':_0x53107f(0x300)})['value']()||[];}function getDisabledBots(){const _0xff28f2=_0x379955;return dbConfig[_0xff28f2(0x2f6)]('bots')['sortBy'](_0xff28f2(0x181))[_0xff28f2(0x1a0)]({'status':_0xff28f2(0x2b8)})[_0xff28f2(0x328)]()||[];}function getBotAttributes(_0x51ecf4){const _0x255f23=_0x379955;let _0x5c3892={};const _0x136eb6=configpath+_0x255f23(0x2c7)+_0x51ecf4+_0x255f23(0x1ff),_0x534f3a=fs['existsSync'](_0x136eb6);if(_0x534f3a){const _0x578a4c=fs['readFileSync'](_0x136eb6);try{const _0x444384=JSON[_0x255f23(0x322)](_0x578a4c),_0x213df2=_0x444384?_0x444384[_0x255f23(0x1d0)][0x0][_0x255f23(0x25f)]:![];_0x5c3892['mode']=_0x213df2?_0x255f23(0x30f):_0x255f23(0x21c),_0x5c3892[_0x255f23(0x213)]=_0x444384?_0x444384['bot'][0x0][_0x255f23(0x213)]:_0x255f23(0x23f)+_0x51ecf4;}catch(_0x3fb9e3){_0x5c3892[_0x255f23(0x20c)]=_0x255f23(0x21c),_0x5c3892['botname']='Bot\x20'+_0x51ecf4;}}else _0x5c3892[_0x255f23(0x20c)]='manual',_0x5c3892[_0x255f23(0x213)]=_0x255f23(0x23f)+_0x51ecf4;return _0x5c3892;}function getBotsWithMode(){const _0x14894e=_0x379955,_0x4b035c=dbConfig[_0x14894e(0x2f6)](_0x14894e(0x232))[_0x14894e(0x13b)](_0x14894e(0x181))[_0x14894e(0x328)]()||[];return _0x4b035c['forEach'](_0x391ca5=>{const _0x51cdd7=_0x14894e;let _0x4b018e=getBotAttributes(_0x391ca5[_0x51cdd7(0x181)]);_0x391ca5['mode']=_0x4b018e[_0x51cdd7(0x20c)];}),_0x4b035c;}function getBotExchanges(){const _0x36d5d8=_0x379955;let _0x3e3d09=[];const _0x313de4=dbConfig[_0x36d5d8(0x2f6)](_0x36d5d8(0x232))[_0x36d5d8(0x13b)](_0x36d5d8(0x181))[_0x36d5d8(0x328)]()||[];_0x313de4[_0x36d5d8(0x196)](_0x571bc1=>{const _0x21d78e=_0x36d5d8;if(_0x571bc1[_0x21d78e(0x2e3)]==_0x21d78e(0x300)){const _0x262278=configpath+'bot-'+_0x571bc1[_0x21d78e(0x181)]+_0x21d78e(0x1ff),_0x215e13=fs[_0x21d78e(0x20d)](_0x262278);let _0x2db6b9;if(_0x215e13){const _0x2f855b=fs[_0x21d78e(0x157)](_0x262278);try{const _0x168a54=JSON[_0x21d78e(0x322)](_0x2f855b);_0x2db6b9=_0x168a54?_0x168a54['bot'][0x0][_0x21d78e(0x13a)]:null;}catch(_0x3d795e){}}if(_0x2db6b9)_0x3e3d09[_0x21d78e(0x1a6)](_0x2db6b9);}});const _0x7c397=[...new Set(_0x3e3d09)][_0x36d5d8(0x25b)]();return _0x7c397;}async function initUser(){const _0x3ee809=_0x379955;if(!settings['userid']){const _0x1721d2=uuidRandom();mixpanel[_0x3ee809(0x1cc)](_0x1721d2),updateSetting(_0x3ee809(0x1df),_0x1721d2);}}async function initSecure(){const _0xe6a8=_0x379955;let _0x16ccae=getSecure();if(!_0x16ccae['hasOwnProperty'](_0xe6a8(0x231))){let _0x171ad0=await generateKeys();_0x16ccae['publicKey']=_0x171ad0['publicKey'],_0x16ccae[_0xe6a8(0x1d4)]=_0x171ad0[_0xe6a8(0x1d4)],_0x16ccae[_0xe6a8(0x231)]=crypto[_0xe6a8(0x227)](0x20)['toString'](_0xe6a8(0x1e1));;storeSecure(_0x16ccae);}}function getSettings(){const _0x2b17fb=_0x379955;return dbSettings[_0x2b17fb(0x2f6)](_0x2b17fb(0x27e))['value']()||{};}function getSecure(){const _0x5c00a9=_0x379955;return dbSecure[_0x5c00a9(0x2f6)](_0x5c00a9(0x129))['value']()||{};}function getBlacklist(){const _0x13285d=_0x379955;return dbSecure[_0x13285d(0x2f6)]('blacklist')[_0x13285d(0x328)]()||[];}function broadcastToBots(_0x30c942,_0x20a4f2){const _0x5ac6d3=_0x379955;config[_0x5ac6d3(0x196)](_0x59b53c=>{const _0x1048da=_0x5ac6d3;if(_0x59b53c['status']=='enabled'&&_0x59b53c['live']=='running'||_0x59b53c['status']==_0x1048da(0x186)&&_0x59b53c[_0x1048da(0x1cd)]==_0x1048da(0x295)){if(pid[_0x59b53c[_0x1048da(0x181)]])pid[_0x59b53c['botID']]['send']({[_0x30c942]:_0x20a4f2});}});}async function storeSettings(_0x1841f9,_0x4df8e4=![]){const _0x116a8d=_0x379955;_0x1841f9={...settings,..._0x1841f9};if(_0x4df8e4&&_0x1841f9[_0x116a8d(0x1bb)]!='************'&&_0x1841f9['bbPassword']!=_0x116a8d(0x2b7)&&_0x1841f9[_0x116a8d(0x1bb)]!=''){const _0x584e74=crypt[_0x116a8d(0x1a7)](secure[_0x116a8d(0x1d4)],_0x1841f9[_0x116a8d(0x1bb)])[_0x116a8d(0x14f)][_0x116a8d(0x1d5)](_0x116a8d(0x165))[0x0],_0x2f081f=bcrypt[_0x116a8d(0x1ab)](_0x584e74,saltRounds);_0x1841f9={..._0x1841f9,'bbPassword':_0x2f081f};}if(_0x4df8e4&&_0x1841f9['telegramToken']!=_0x116a8d(0x2f9)&&_0x1841f9[_0x116a8d(0x2a6)]!=_0x116a8d(0x2b7)&&_0x1841f9[_0x116a8d(0x2a6)]!=''){const _0x12242f=crypt['decrypt'](secure[_0x116a8d(0x1d4)],_0x1841f9[_0x116a8d(0x2a6)])[_0x116a8d(0x14f)][_0x116a8d(0x1d5)](_0x116a8d(0x165))[0x0];_0x1841f9={..._0x1841f9,'telegramToken':_0x12242f};}if(_0x4df8e4&&_0x1841f9[_0x116a8d(0x122)]!=_0x116a8d(0x2f9)&&_0x1841f9[_0x116a8d(0x122)]!=_0x116a8d(0x2b7)&&_0x1841f9[_0x116a8d(0x122)]!=''){const _0x460582=crypt[_0x116a8d(0x1a7)](secure[_0x116a8d(0x1d4)],_0x1841f9[_0x116a8d(0x122)])[_0x116a8d(0x14f)][_0x116a8d(0x1d5)](_0x116a8d(0x165))[0x0];_0x1841f9={..._0x1841f9,'marketcapApi':_0x460582};}const _0x311bbf=_0x1841f9[_0x116a8d(0x2a6)]!=_0x116a8d(0x2f9)&&_0x1841f9[_0x116a8d(0x2a6)]!=settings['telegramToken']||_0x1841f9[_0x116a8d(0x31b)]!=settings['telegramUsername'],_0x13d384=_0x1841f9[_0x116a8d(0x2a6)]==''||_0x1841f9[_0x116a8d(0x31b)]=='',_0x484c57=_0x1841f9[_0x116a8d(0x122)]&&_0x1841f9['marketcapApi']!=_0x116a8d(0x2f9)&&_0x1841f9['marketcapApi']!=settings[_0x116a8d(0x2a6)];_0x311bbf&&(_0x1841f9[_0x116a8d(0x2c2)]=null,_0x1841f9[_0x116a8d(0x237)]='all');for(const [_0x528e9f,_0x327f4b]of Object[_0x116a8d(0x281)](_0x1841f9)){if(_0x528e9f==_0x116a8d(0x2a6)&&_0x327f4b=='************'){_0x1841f9[_0x116a8d(0x2a6)]=settings[_0x116a8d(0x2a6)];continue;};if(_0x528e9f=='bbPassword'&&_0x327f4b==_0x116a8d(0x2f9)){_0x1841f9[_0x116a8d(0x1bb)]=settings[_0x116a8d(0x1bb)];continue;};if(_0x528e9f==_0x116a8d(0x122)&&_0x327f4b==_0x116a8d(0x2f9)){_0x1841f9[_0x116a8d(0x122)]=settings[_0x116a8d(0x122)];continue;};dbSettings[_0x116a8d(0x11b)]('settings.'+_0x528e9f,_0x327f4b)[_0x116a8d(0x1d8)]();}settings=_0x1841f9,io['to'](_0x116a8d(0x2dd))[_0x116a8d(0x26e)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x116a8d(0x324)]),broadcastToBots(_0x116a8d(0x177),settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x116a8d(0x122)]);if(_0x311bbf&&!_0x13d384)initTelegram();if(_0x311bbf&&_0x13d384)disableTelegram();getAllClients()[_0x116a8d(0x196)](_0x79ef5a=>{const _0x85e728=_0x116a8d;getSocket(_0x79ef5a['id'])['emit'](_0x85e728(0x2e3),{'access':{'allow':![],'reason':_0x85e728(0x159),'token':null}});}),_0x484c57&&(await sleep(0xbb8),testMarketcapApi(_0x1841f9[_0x116a8d(0x122)]));}async function testMarketcapApi(_0xb8041){const _0x353890=_0x379955,_0x180ea2=[_0x353890(0x2fc),_0x353890(0x220)];try{await axios[_0x353890(0x2f6)](_0x353890(0x1f1),{'headers':{'X-CMC_PRO_API_KEY':_0xb8041},'params':{'symbol':_0x180ea2[_0x353890(0x1e2)]()}});}catch(_0x418c94){_0x418c94['toString']()['includes'](_0x353890(0x183))?(io['to'](_0x353890(0x2dd))[_0x353890(0x26e)]('notification',_0x353890(0x22e)),logger[_0x353890(0x294)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')[_0x353890(0x26e)](_0x353890(0x1a3),_0x353890(0x16e)),logger[_0x353890(0x294)](_0x353890(0x16e)),logger[_0x353890(0x1db)]('Error\x20details:',_0x418c94[_0x353890(0x1e2)]()+_0x353890(0x169)+_0x418c94[_0x353890(0x203)]));return;}logger[_0x353890(0x1db)](_0x353890(0x166));}function updateSetting(_0x4fa915,_0x49467c){const _0x1b94fe=_0x379955;dbSettings[_0x1b94fe(0x11b)](_0x1b94fe(0x311)+_0x4fa915,_0x49467c)['write'](),settings=getSettings(),io['to'](_0x1b94fe(0x2dd))[_0x1b94fe(0x26e)](_0x1b94fe(0x27e),cleanSettings());}function storeSecure(_0x33b9ea){const _0x512ada=_0x379955;dbSecure['get']('secure')[_0x512ada(0x1a6)](_0x33b9ea)[_0x512ada(0x1d8)](),secure=_0x33b9ea;}function addBlacklist(_0x430cd3){const _0x362bc1=_0x379955;cleanBlacklist();let _0x4f9f1b;devices[_0x430cd3][_0x362bc1(0x208)]?_0x4f9f1b=Math[_0x362bc1(0x155)](devices[_0x430cd3][_0x362bc1(0x208)][_0x362bc1(0x2da)],loginExpiry):_0x4f9f1b=loginExpiry,dbSecure[_0x362bc1(0x2f6)](_0x362bc1(0x1f3))[_0x362bc1(0x1a6)]({'expiry':new Date()[_0x362bc1(0x1d7)]()+_0x4f9f1b*0x3c*0x3e8,'token':devices[_0x430cd3][_0x362bc1(0x132)][_0x362bc1(0x2b9)]})[_0x362bc1(0x1d8)](),blacklist=dbSecure[_0x362bc1(0x2f6)](_0x362bc1(0x1f3))[_0x362bc1(0x328)]();}function cleanBlacklist(){const _0x316f2f=_0x379955;let _0x4ffb27=dbSecure[_0x316f2f(0x2f6)](_0x316f2f(0x1f3))[_0x316f2f(0x200)]()[_0x316f2f(0x328)](),_0x2be9a5=new Date()['getTime']();_0x4ffb27[_0x316f2f(0x196)](_0x50a852=>{const _0x385d03=_0x316f2f;_0x50a852[_0x385d03(0x2da)]<_0x2be9a5&&dbSecure[_0x385d03(0x2f6)](_0x385d03(0x1f3))[_0x385d03(0x1eb)]({'expiry':_0x50a852[_0x385d03(0x2da)]})['write']();});}function initStates(){const _0x5e796f=_0x379955;let _0x31da09=getConfiguration();_0x31da09[_0x5e796f(0x196)](_0x472eed=>{const _0x1f722a=_0x5e796f;_0x472eed['live']=_0x1f722a(0x309);}),storeConfiguration(_0x31da09);}function onKeys(){const _0x2e7ae2=new RSA();return new Promise(_0x4a2dd9=>{const _0x3947c5=_0x1d6b;_0x2e7ae2[_0x3947c5(0x246)]()[_0x3947c5(0x2ac)](_0x286e56=>{_0x4a2dd9(_0x286e56);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x192aa5=_0x379955;let _0x5f1c57=getSettings(),_0x4ac9af=![];!_0x5f1c57[_0x192aa5(0x16a)](_0x192aa5(0x163))&&(_0x5f1c57['lastmsgtelegram']=0x0,_0x4ac9af=!![]);!_0x5f1c57[_0x192aa5(0x16a)](_0x192aa5(0x128))&&(_0x5f1c57[_0x192aa5(0x128)]=0x0,_0x4ac9af=!![]);!_0x5f1c57['hasOwnProperty'](_0x192aa5(0x29c))&&(_0x5f1c57[_0x192aa5(0x29c)]=_0x192aa5(0x144),_0x4ac9af=!![]);!_0x5f1c57[_0x192aa5(0x16a)](_0x192aa5(0x177))&&(_0x5f1c57[_0x192aa5(0x177)]=![],_0x4ac9af=!![]);!_0x5f1c57['hasOwnProperty']('marketcapApi')&&(_0x5f1c57['marketcapApi']='',_0x4ac9af=!![]);if(_0x4ac9af)storeSettings(_0x5f1c57);try{fs[_0x192aa5(0x1b3)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x42a2f1=>{const _0x1cc459=_0x192aa5;if(!_0x42a2f1[_0x1cc459(0x148)]()){if(!_0x42a2f1[_0x1cc459(0x2a4)]['startsWith'](_0x1cc459(0x16c)))fs['unlinkSync'](configbackuppath+_0x42a2f1['name']);}else fs['rmSync'](configbackuppath+_0x42a2f1[_0x1cc459(0x2a4)],{'recursive':!![]});});}catch(_0x3bac92){logger[_0x192aa5(0x1db)](_0x192aa5(0x1c7),_0x3bac92);}}function storeConfiguration(_0x6c44e2){const _0x1bf0ca=_0x379955;dbConfig[_0x1bf0ca(0x2f6)]('bots')[_0x1bf0ca(0x1eb)]()['write'](),dbConfig['get'](_0x1bf0ca(0x232))['push'](..._0x6c44e2)[_0x1bf0ca(0x1d8)](),config=_0x6c44e2;}async function resetPassword(){const _0x112bb5=_0x379955;if(tgBot&&settings[_0x112bb5(0x2c2)]){const _0x50c62b=Markup[_0x112bb5(0x1e8)]([Markup['button'][_0x112bb5(0x219)](_0x112bb5(0x2e0),_0x112bb5(0x249)),Markup[_0x112bb5(0x2f3)][_0x112bb5(0x219)]('no','resetpw_no')]);await sendTelegram(settings[_0x112bb5(0x2c2)],_0x112bb5(0x21d),_0x50c62b),tgBot['action'](/resetpw_(.+)/,async _0x45c3db=>{const _0x511aec=_0x112bb5,_0x2dcd2e=_0x45c3db[_0x511aec(0x1ae)][0x1];_0x45c3db[_0x511aec(0x272)]();if(_0x2dcd2e!='no'){const _0x2915d6=0xf,_0x575bd7=_0x511aec(0x167),_0x461e65=Array[_0x511aec(0x2d1)](crypto[_0x511aec(0x2fb)](new Uint32Array(_0x2915d6)))[_0x511aec(0x28a)](_0x42c025=>_0x575bd7[_0x42c025%_0x575bd7[_0x511aec(0x11f)]])['join'](''),_0x1dc3f2=bcrypt[_0x511aec(0x1ab)](_0x461e65,saltRounds);storeSettings({'bbPassword':_0x1dc3f2}),await sendTelegram(_0x45c3db['chat']['id'],_0x511aec(0x1f2)+_0x461e65,{'parse_mode':_0x511aec(0x12b)});}else await sendTelegram(_0x45c3db[_0x511aec(0x325)]['id'],_0x511aec(0x182));});}}async function confirmRestore(_0x1b819a,_0x29f990){const _0x3892b9=_0x379955;io['to']('botmanager')['emit']('notification',_0x3892b9(0x2be),_0x3892b9(0x256));if(tgBot&&settings['telegramChatId']){const _0x2a8dfc=uuidRandom();tmpStorage[_0x2a8dfc]={'path':_0x1b819a,'filename':_0x29f990};const _0x3f15b9=Markup[_0x3892b9(0x1e8)]([Markup[_0x3892b9(0x2f3)][_0x3892b9(0x219)]('yes',_0x3892b9(0x185)+_0x2a8dfc),Markup['button']['callback']('no','restore_no_'+_0x2a8dfc)]);await sendTelegram(settings[_0x3892b9(0x2c2)],_0x3892b9(0x162),_0x3f15b9),tgBot[_0x3892b9(0x153)](/restore_(.+)_(.+)/,async _0x17878b=>{const _0x84b52=_0x3892b9,_0x1c46e8=_0x17878b[_0x84b52(0x1ae)][0x1],_0x53ed43=_0x17878b[_0x84b52(0x1ae)][0x2],{path:_0x2c4458,filename:_0x20e1a4}=tmpStorage[_0x53ed43];delete tmpStorage[_0x53ed43],_0x17878b[_0x84b52(0x272)](),_0x1c46e8==_0x84b52(0x2e0)?(logger['debug'](_0x84b52(0x1bd)),await sendTelegram(_0x17878b[_0x84b52(0x325)]['id'],_0x84b52(0x2fa),{'parse_mode':_0x84b52(0x12b)}),unzipFile(_0x2c4458,_0x20e1a4)):(logger[_0x84b52(0x1db)](_0x84b52(0x239)),await sendTelegram(_0x17878b[_0x84b52(0x325)]['id'],_0x84b52(0x239)));});}}function getServerTime(){const _0x84196b=_0x379955,_0x2335a8=new Date();return _0x2335a8[_0x84196b(0x1a1)]()+'/'+(_0x2335a8[_0x84196b(0x14a)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x2335a8[_0x84196b(0x2cb)]()[_0x84196b(0x1e2)]()[_0x84196b(0x2f5)](0x2,'0')+'\x20'+_0x2335a8[_0x84196b(0x171)]()[_0x84196b(0x1e2)]()[_0x84196b(0x2f5)](0x2,'0')+':'+_0x2335a8[_0x84196b(0x21f)]()[_0x84196b(0x1e2)]()['padStart'](0x2,'0')+':'+_0x2335a8['getSeconds']()['toString']()[_0x84196b(0x2f5)](0x2,'0');}function getTimeStamp(){const _0xbc2371=_0x379955,_0x18815c=shiftedTime();return _0x18815c['getFullYear']()+'/'+(_0x18815c[_0xbc2371(0x14a)]()+0x1)[_0xbc2371(0x1e2)]()[_0xbc2371(0x2f5)](0x2,'0')+'/'+_0x18815c[_0xbc2371(0x2cb)]()[_0xbc2371(0x1e2)]()[_0xbc2371(0x2f5)](0x2,'0')+'\x20'+_0x18815c[_0xbc2371(0x171)]()[_0xbc2371(0x1e2)]()[_0xbc2371(0x2f5)](0x2,'0')+':'+_0x18815c['getMinutes']()['toString']()[_0xbc2371(0x2f5)](0x2,'0')+':'+_0x18815c['getSeconds']()['toString']()[_0xbc2371(0x2f5)](0x2,'0');}function getCleanTimeStamp(){const _0x3e24b8=_0x379955,_0x23e51e=shiftedTime();return _0x23e51e[_0x3e24b8(0x1a1)]()+(_0x23e51e['getMonth']()+0x1)[_0x3e24b8(0x1e2)]()['padStart'](0x2,'0')+_0x23e51e[_0x3e24b8(0x2cb)]()['toString']()[_0x3e24b8(0x2f5)](0x2,'0')+'-'+_0x23e51e['getHours']()[_0x3e24b8(0x1e2)]()[_0x3e24b8(0x2f5)](0x2,'0')+_0x23e51e[_0x3e24b8(0x21f)]()[_0x3e24b8(0x1e2)]()[_0x3e24b8(0x2f5)](0x2,'0')+_0x23e51e['getSeconds']()[_0x3e24b8(0x1e2)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x4bc945=_0x379955,_0x54a8a1=new Date();let _0x4432e2=_0x54a8a1;if(settings[_0x4bc945(0x324)]&&settings['timeshift']!==0x0)_0x4432e2=fns[_0x4bc945(0x1d2)](_0x54a8a1,{'hours':settings[_0x4bc945(0x324)]});return _0x4432e2;}async function startScheduler(){const _0x3ec984=_0x379955,_0x47e363=new Date()[_0x3ec984(0x23b)](),_0x263f90=shiftedTime()[_0x3ec984(0x171)]();_0x263f90==0x4&&backupConfigFiles(),_0x263f90==0x0&&rotateLogFiles(),_0x47e363%0x6==0x0&&triggerAnalytics(),_0x47e363%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x21bb2f){const _0x486887=_0x379955;logger[_0x486887(0x1db)]('Restore\x20backup\x20file\x20'+_0x21bb2f);const _0x48e1d8=getBotsWithMode();_0x48e1d8['length']>0x0?confirmRestore(configbackuppath,_0x21bb2f):unzipFile(configbackuppath,_0x21bb2f);}async function getBackupFiles(_0x19505d=null){const _0x17c8e5=_0x379955;let _0x1bd9a4=[],_0x3d0683=fs[_0x17c8e5(0x1b3)](configbackuppath,{'withFileTypes':!![]});_0x3d0683[_0x17c8e5(0x25b)]((_0x3ee21e,_0x1f6060)=>_0x3ee21e[_0x17c8e5(0x2a4)]<_0x1f6060[_0x17c8e5(0x2a4)]?0x1:_0x1f6060[_0x17c8e5(0x2a4)]<_0x3ee21e[_0x17c8e5(0x2a4)]?-0x1:0x0),_0x3d0683['forEach'](_0x41e8c8=>{const _0x3f4073=_0x17c8e5;if(!_0x41e8c8[_0x3f4073(0x148)]()&&_0x41e8c8[_0x3f4073(0x2a4)][_0x3f4073(0x2c6)]('backup-full@')&&_0x41e8c8['name'][_0x3f4073(0x136)](_0x3f4073(0x223))){const _0x147df8=formatDate(fs[_0x3f4073(0x308)](configbackuppath+_0x41e8c8[_0x3f4073(0x2a4)])['mtime']);_0x1bd9a4[_0x3f4073(0x1a6)]({'name':_0x41e8c8[_0x3f4073(0x2a4)],'mtime':_0x147df8});}});if(_0x19505d)io['to'](_0x19505d)[_0x17c8e5(0x26e)](_0x17c8e5(0x2eb),_0x1bd9a4);else return _0x1bd9a4;}async function backupConfigFiles(){const _0x14a9d2=_0x379955;await zipFiles('backup-full');const _0x4f7125=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x14a9d2(0x273),configbackuppath+('backup-full@'+_0x4f7125+_0x14a9d2(0x223)));let _0x31e032=fs[_0x14a9d2(0x1b3)](configbackuppath,{'withFileTypes':!![]});_0x31e032[_0x14a9d2(0x25b)]((_0x43092d,_0x4a531c)=>_0x43092d[_0x14a9d2(0x2a4)]<_0x4a531c[_0x14a9d2(0x2a4)]?0x1:_0x4a531c[_0x14a9d2(0x2a4)]<_0x43092d['name']?-0x1:0x0),_0x31e032[_0x14a9d2(0x11f)]>maxBackups&&fs[_0x14a9d2(0x2aa)](configbackuppath+_0x31e032[_0x31e032[_0x14a9d2(0x11f)]-0x1]['name']);}function rotateLogFiles(){const _0x1beff7=_0x379955,_0x2601e8=fs[_0x1beff7(0x308)](logspath+_0x1beff7(0x1ca)),_0x478d58=_0x2601e8[_0x1beff7(0x290)]/0x400;if(_0x478d58>0x64){let _0xd939a6=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0xd939a6[_0x1beff7(0x25b)]((_0x34ceba,_0x46bec0)=>_0x34ceba['name']<_0x46bec0['name']?0x1:_0x46bec0[_0x1beff7(0x2a4)]<_0x34ceba[_0x1beff7(0x2a4)]?-0x1:0x0),_0xd939a6[_0x1beff7(0x196)](_0x57c9e7=>{const _0x3d66e8=_0x1beff7;if(_0x57c9e7[_0x3d66e8(0x2a4)]==_0x3d66e8(0x303))fs[_0x3d66e8(0x2f1)](logspath+_0x57c9e7['name'],logspath+_0x3d66e8(0x135));if(_0x57c9e7[_0x3d66e8(0x2a4)]=='output-001.log')fs[_0x3d66e8(0x2f1)](logspath+_0x57c9e7[_0x3d66e8(0x2a4)],logspath+_0x3d66e8(0x303));_0x57c9e7[_0x3d66e8(0x2a4)]==_0x3d66e8(0x1ca)&&(fs[_0x3d66e8(0x2f1)](logspath+_0x57c9e7[_0x3d66e8(0x2a4)],logspath+_0x3d66e8(0x258)),fs[_0x3d66e8(0x297)](logspath+_0x57c9e7[_0x3d66e8(0x2a4)],''));});}}async function zipFiles(_0x380485){const _0x12174d=_0x379955;let _0x3a3d45;if(_0x380485==_0x12174d(0x2f8))_0x3a3d45=logspath;if(_0x380485==_0x12174d(0x2ff))_0x3a3d45=configpath;if(_0x380485=='backup-full')_0x3a3d45=configpath;let _0x1c4485=fs['readdirSync'](_0x3a3d45,{'withFileTypes':!![]});const _0x426f2b=new require(_0x12174d(0x28d))();_0x1c4485[_0x12174d(0x196)](_0x3cba8b=>{const _0x419c11=_0x12174d;if(!_0x3cba8b[_0x419c11(0x148)]()){let _0x3df9e8=fs[_0x419c11(0x157)](_0x3a3d45+_0x3cba8b[_0x419c11(0x2a4)]);if(_0x380485==_0x419c11(0x2ff)){const _0x2bb3e4=/^bot-[0-9]{3}-config.json$/,_0x4b9276=_0x2bb3e4[_0x419c11(0x1ba)](_0x3cba8b[_0x419c11(0x2a4)]);if(_0x4b9276){const _0x3bd021=JSON[_0x419c11(0x322)](_0x3df9e8);if(_0x3bd021[_0x419c11(0x1d0)][0x0]){_0x3bd021[_0x419c11(0x1d0)][0x0][_0x419c11(0x19e)]='***',_0x3bd021[_0x419c11(0x1d0)][0x0]['apiSecret']=_0x419c11(0x2b7);if(_0x3bd021[_0x419c11(0x1d0)][0x0]['apiPassword'])_0x3bd021[_0x419c11(0x1d0)][0x0][_0x419c11(0x20b)]=_0x419c11(0x2b7);}_0x3df9e8=JSON[_0x419c11(0x31a)](_0x3bd021,null,0x2);}if(_0x3cba8b[_0x419c11(0x2a4)]=='bb-settings.json'){const _0x341c5f=JSON[_0x419c11(0x322)](_0x3df9e8);if(_0x341c5f[_0x419c11(0x27e)]['loginRequired'])_0x341c5f[_0x419c11(0x27e)][_0x419c11(0x21a)]=![];if(_0x341c5f[_0x419c11(0x27e)][_0x419c11(0x1bb)])_0x341c5f[_0x419c11(0x27e)][_0x419c11(0x1bb)]='***';if(_0x341c5f[_0x419c11(0x27e)]['telegramToken'])_0x341c5f['settings']['telegramToken']=_0x419c11(0x2b7);if(_0x341c5f[_0x419c11(0x27e)][_0x419c11(0x2c2)])_0x341c5f[_0x419c11(0x27e)][_0x419c11(0x2c2)]=null;if(_0x341c5f[_0x419c11(0x27e)]['marketcapApi'])_0x341c5f[_0x419c11(0x27e)]['marketcapApi']=_0x419c11(0x2b7);_0x3df9e8=JSON['stringify'](_0x341c5f,null,0x2);}if(_0x3cba8b['name']!='bb-secure.json')_0x426f2b['file'](_0x3cba8b[_0x419c11(0x2a4)],_0x3df9e8);}else _0x426f2b[_0x419c11(0x1c0)](_0x3cba8b['name'],_0x3df9e8);}});const _0x9036b5=_0x426f2b[_0x12174d(0x221)]({'base64':![],'compression':_0x12174d(0x2b2)});fs[_0x12174d(0x297)](zippath+(_0x380485+_0x12174d(0x223)),_0x9036b5,'binary');}async function unzipFile(_0x455cbc,_0x256653){const _0x297010=_0x379955;fs[_0x297010(0x1b3)](configpath,{'withFileTypes':!![]})['forEach'](_0x8ed334=>{const _0xd8cd41=_0x297010;if(!_0x8ed334[_0xd8cd41(0x148)]())fs[_0xd8cd41(0x2a9)](configpath+_0x8ed334[_0xd8cd41(0x2a4)]);});const _0x1124db=fs['readFileSync'](_0x455cbc+_0x256653,_0x297010(0x243)),_0x33f8ab=new require(_0x297010(0x28d))(_0x1124db,{'base64':![],'checkCRC32':!![]});Object[_0x297010(0x217)](_0x33f8ab[_0x297010(0x247)])['forEach'](_0x25db7d=>{const _0x230317=_0x297010,_0x333a07=_0x33f8ab[_0x230317(0x247)][_0x25db7d];fs[_0x230317(0x297)](configpath+_0x333a07[_0x230317(0x2a4)],_0x333a07[_0x230317(0x1dd)]);}),fs[_0x297010(0x1b3)](temppath,{'withFileTypes':!![]})[_0x297010(0x196)](_0x2434cf=>{const _0x547063=_0x297010;if(!_0x2434cf['isDirectory']())fs[_0x547063(0x2a9)](temppath+_0x2434cf[_0x547063(0x2a4)]);}),logger[_0x297010(0x1db)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x297010(0x2dc)]({'restore':!![]},_0x1ee6c3=>{});}async function getPublicIp(){const _0x78a4e7=_0x379955;try{const _0x11ad70=await axios[_0x78a4e7(0x2f6)](_0x78a4e7(0x262));publicip=_0x11ad70[_0x78a4e7(0x2f2)]['ip'];}catch(_0x4758e9){}}async function triggerAnalytics(){const _0x2a1a0b=_0x379955;if(!publicip)await getPublicIp();const _0x3b1e1e=getBotsWithMode();let _0x3690ed=0x0;_0x3b1e1e[_0x2a1a0b(0x196)](_0x3d5e3b=>{if(_0x3d5e3b['status']==='enabled')_0x3690ed++;});const _0xd46b5d=getBotExchanges();mixpanel[_0x2a1a0b(0x2ed)](_0x2a1a0b(0x18e),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3b1e1e[_0x2a1a0b(0x11f)],'numbotsenabled':_0x3690ed,'exchanges':_0xd46b5d,'environment':environment});}async function getMessages(){const _0x24564d=_0x379955,_0x43a5ef=_0x24564d(0x130),_0x3d5ca4=new GraphQLClient(_0x43a5ef),_0x5c337d={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x3dfa8e=serverversion[_0x24564d(0x1d5)]('.'),_0x584e51=_0x3dfa8e[0x0]+'.'+_0x3dfa8e[0x1],_0x270906=Math['min'](settings['lastmsgtelegram'],settings[_0x24564d(0x128)]),_0x27b512={'last':parseInt(_0x270906),'bbm':_0x584e51},_0x4160a8=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1d6676;try{_0x1d6676=await _0x3d5ca4[_0x24564d(0x236)](_0x4160a8,_0x27b512,_0x5c337d);}catch(_0x1c5e76){}if(_0x1d6676&&_0x1d6676[_0x24564d(0x2df)]){let _0xaa8e1f=settings[_0x24564d(0x163)];newMessages=[];for(const _0x3a533f of _0x1d6676[_0x24564d(0x2df)]){newMessages[_0x24564d(0x1a6)](_0x3a533f);let _0x43b019=![];_0x3a533f['bbvNew']&&(updateSetting(_0x24564d(0x29c),_0x3a533f[_0x24564d(0x2ee)]),_0x43b019=isNewerVersion(serverversion,_0x3a533f['bbvNew'])||serverversion==_0x3a533f[_0x24564d(0x2ee)]);if(!_0x43b019&&_0x3a533f[_0x24564d(0x20f)]>_0xaa8e1f){if(_0x3a533f[_0x24564d(0x1b7)]===_0x24564d(0x2d0)||serverversion[_0x24564d(0x2c6)](_0x3a533f[_0x24564d(0x1b7)])){let _0x4853be=''+_0x3a533f[_0x24564d(0x1f0)]+'\x0a\x0a'+_0x3a533f['message'];const _0x486483=await sendTelegramMsg(toTelegramMarkdown(_0x4853be),_0x24564d(0x152));if(_0x486483)_0xaa8e1f=_0x3a533f['number'];}}}updateAvailable=isNewerVersion(settings[_0x24564d(0x29c)],serverversion),updateSetting(_0x24564d(0x163),_0xaa8e1f),emitMessages();}}function emitMessages(){const _0x40c27c=_0x379955,_0x3f04ff=settings['lastmsgemitted'];let _0xd49d72=[];newMessages[_0x40c27c(0x196)](_0xe19448=>{const _0x5a79cf=_0x40c27c;_0xe19448[_0x5a79cf(0x20f)]>_0x3f04ff&&_0xd49d72[_0x5a79cf(0x1a6)](_0xe19448);}),_0xd49d72[_0x40c27c(0x11f)]>0x0&&getAllClients()[_0x40c27c(0x196)](_0x1ca820=>{getSocket(_0x1ca820['id'])['emit']('message',_0xd49d72);});}function confirmMessage(_0x4047e9){const _0x1157b0=_0x379955;updateSetting(_0x1157b0(0x128),Number(_0x4047e9));}function isNewerVersion(_0x316c9c,_0x254436){const _0x17e253=_0x254436['split']('.'),_0x4cfa5f=_0x316c9c['split']('.');for(var _0xe7249c=0x0;_0xe7249c<_0x4cfa5f['length'];_0xe7249c++){const _0x14ba05=~~_0x4cfa5f[_0xe7249c],_0x52d597=~~_0x17e253[_0xe7249c];if(_0x14ba05>_0x52d597)return!![];if(_0x14ba05<_0x52d597)return![];}return![];}function toTelegramMarkdown(_0x24fdaa){const _0xf8674=_0x379955,_0x350c51=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1e4087=/\*{2}(.+?)\*{2}/gim;return _0x24fdaa=_0x24fdaa['replace'](_0x350c51,'$1_$2_$3')[_0xf8674(0x265)](_0x1e4087,'*$1*'),_0x24fdaa;}async function validateConfigFile(){const _0x39461b=_0x379955,_0x144c8d=dbConfig['get'](_0x39461b(0x232))['sortBy'](_0x39461b(0x181))[_0x39461b(0x328)]()||[];if(_0x144c8d[_0x39461b(0x11f)]==0x0){let _0x1b6bcb=0x0,_0x257639=[];const _0x1d28bc=/^bot-([0-9]{3})-config.json$/,_0x57f560=fs['readdirSync'](configpath);_0x57f560[_0x39461b(0x196)](_0xc12d42=>{const _0x269c58=_0x39461b,_0x4ed06c=_0x1d28bc['exec'](_0xc12d42);if(_0x4ed06c){const _0x3f3f97=_0x4ed06c[0x1];let _0xf9226e=getBotAttributes(_0x3f3f97);_0x257639[_0x269c58(0x1a6)]({'botID':_0x3f3f97,'botname':_0xf9226e['botname'],'status':_0x269c58(0x2b8),'live':_0x269c58(0x309)}),_0x1b6bcb++;}}),_0x1b6bcb!=0x0&&(dbConfig[_0x39461b(0x2f6)](_0x39461b(0x232))[_0x39461b(0x133)](_0x257639)['write'](),config=_0x257639,restoredConfigFile=_0x1b6bcb);}}async function restoreConfigNotify(_0x2ad217){const _0x401d05=_0x379955;let _0x7d373e;if(restoredConfigFile==0x1)_0x7d373e='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x7d373e='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x2ad217)io['to'](_0x401d05(0x2dd))['emit'](_0x401d05(0x1a3),_0x7d373e);else{logger['simple'](_0x401d05(0x15c)),logger[_0x401d05(0x1e9)](_0x7d373e),logger['simple'](_0x401d05(0x15c)),logger[_0x401d05(0x1e9)]('');if(tgBot&&settings[_0x401d05(0x2c2)]&&settings['telegramEvents']!=_0x401d05(0x244))await sendTelegram(settings['telegramChatId'],_0x401d05(0x12a)+_0x7d373e);}}function validateCredentials(_0x458fff,_0x42cd75){const _0x587e4e=_0x379955;if(_0x458fff[_0x587e4e(0x15b)]==settings[_0x587e4e(0x124)]&&bcrypt[_0x587e4e(0x134)](_0x458fff[_0x587e4e(0x202)],settings[_0x587e4e(0x1bb)])){if(settings[_0x587e4e(0x313)])return{'allow':![],'reason':_0x587e4e(0x214),'token':null};else{const _0x57314d=generateLoginToken(_0x42cd75);return{'allow':!![],'reason':_0x587e4e(0x261),'token':_0x57314d};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x53202d){const _0x3330f0=_0x379955,_0x5bddc7=generateLoginToken(_0x53202d);return{'allow':!![],'reason':_0x3330f0(0x261),'token':_0x5bddc7};}function validateAccess(_0x5405b6,_0xc80432,_0x8629b8){const _0x47f610=_0x379955,_0x48036c=_0x8629b8?_0x8629b8:devices[_0xc80432]['ip'];let _0xfb8e38;const _0x586293=_0x18ce68=>{const _0x13dd1c=_0x1d6b;if(settings[_0x13dd1c(0x21a)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0xc80432)){const _0x34f474=generateLoginToken(_0xc80432);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x34f474};}else return{'allow':![],'reason':_0x13dd1c(0x187),'token':null};}else return _0xfb8e38=validToken(_0x18ce68,_0xc80432),_0xfb8e38[_0x13dd1c(0x16a)](_0x13dd1c(0x256))?{'allow':!![],'reason':_0x13dd1c(0x168),'token':_0x18ce68}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x13dd1c(0x316),'token':null};};if(settings['whitelistEnabled']){let _0x15d01e=[...settings['whitelist'],_0x47f610(0x191),'::ffff:127.0.0.1','127.0.0.1'];if(_0x15d01e[_0x47f610(0x1c4)](_0x48036c))return _0x586293(_0x5405b6);else{_0xfb8e38=validToken(_0x5405b6,_0xc80432);if(_0xfb8e38['hasOwnProperty'](_0x47f610(0x256)))return _0x586293(_0x5405b6);else{if(telegramIpApproved(_0xc80432)){const _0x3f835c=generateToken(_0xc80432);return _0xfb8e38=_0x586293(_0x5405b6),_0xfb8e38['allow']?{'allow':!![],'reason':_0x47f610(0x2d3),'token':_0x3f835c}:_0xfb8e38;}else return settings[_0x47f610(0x28f)]?{'allow':![],'reason':_0x47f610(0x151),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x586293(_0x5405b6);}function timelyDecrypt(_0x4d31ca,_0x5935d4,_0x121fa9='@'){const _0x5b9679=_0x379955;if(_0x4d31ca)try{const _0x5a0e91=crypt[_0x5b9679(0x1a7)](secure[_0x5b9679(0x1d4)],_0x4d31ca)[_0x5b9679(0x14f)],_0x232fe4=_0x5a0e91['split'](_0x121fa9)[0x0],_0x493d21=_0x5a0e91[_0x5b9679(0x1d5)](_0x121fa9)[0x1],_0x36c60e=new Date()['getTime']();if(_0x5935d4){if(_0x36c60e-_0x493d21<maxSecretAge*0x3e8)return _0x232fe4;else return![];}else return _0x232fe4;}catch(_0x52565d){return![];}else return![];}const validToken=(_0x399a14,_0x35fd3f)=>{const _0x40ecd5=_0x379955,_0x1c5d96=devices[_0x35fd3f]['ip'];if(!_0x399a14)return{'error':_0x40ecd5(0x197)};for(let _0x43d215 of blacklist){if(_0x43d215[_0x40ecd5(0x2b9)]==_0x399a14)return{'error':_0x40ecd5(0x140)};}let _0x4f804d;try{_0x4f804d=jwt['verify'](_0x399a14,secure[_0x40ecd5(0x231)]+_0x35fd3f);}catch{return{'error':_0x40ecd5(0x329)};}if(!_0x4f804d[_0x40ecd5(0x16a)](_0x40ecd5(0x226))&&!_0x4f804d[_0x40ecd5(0x16a)](_0x40ecd5(0x15b))||!_0x4f804d['hasOwnProperty'](_0x40ecd5(0x123)))return{'error':_0x40ecd5(0x119)};if(!_0x4f804d[_0x40ecd5(0x16a)](_0x40ecd5(0x15b))&&_0x4f804d['hasOwnProperty'](_0x40ecd5(0x226))){const {clientip:_0x54abf3}=_0x4f804d;return _0x1c5d96==_0x54abf3?{'success':_0x40ecd5(0x23d)}:{'error':_0x40ecd5(0x121)};}else{if(_0x4f804d[_0x40ecd5(0x16a)](_0x40ecd5(0x15b))&&_0x4f804d[_0x40ecd5(0x16a)]('clientip')){const {username:_0x45f122,clientip:_0x5d9885}=_0x4f804d;return settings[_0x40ecd5(0x124)]==_0x45f122&&_0x1c5d96==_0x5d9885?{'success':_0x40ecd5(0x23d)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x219e8f=>{const _0xf88d20=_0x379955;if(_0x219e8f){const _0x530dbd=devices[_0x219e8f]['ip'];return jwt[_0xf88d20(0x32c)]({'username':settings[_0xf88d20(0x124)],'clientip':_0x530dbd},secure[_0xf88d20(0x231)]+_0x219e8f,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3c39ee=>{const _0x7571f4=_0x379955;if(_0x3c39ee){const _0x159100=devices[_0x3c39ee]['ip'];return jwt[_0x7571f4(0x32c)]({'clientip':_0x159100},secure[_0x7571f4(0x231)]+_0x3c39ee,{'expiresIn':devices[_0x3c39ee][_0x7571f4(0x208)][_0x7571f4(0x2da)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x57f84d=>{const _0x447305=_0x379955;let _0x354ce8=![];return devices[_0x57f84d][_0x447305(0x208)]&&devices[_0x57f84d][_0x447305(0x208)][_0x447305(0x2da)]!=_0x447305(0x2ef)&&(_0x354ce8=devices[_0x57f84d][_0x447305(0x208)][_0x447305(0x226)]==devices[_0x57f84d]['ip']&&new Date()['getTime']()-devices[_0x57f84d][_0x447305(0x208)][_0x447305(0x222)]<devices[_0x57f84d][_0x447305(0x208)][_0x447305(0x2da)]*0x3c*0x3e8),_0x354ce8;},telegram2FaApproved=_0x4f96fc=>{const _0x2cddc6=_0x379955;let _0x1ae489=![];return devices[_0x4f96fc][_0x2cddc6(0x30e)]&&devices[_0x4f96fc]['telegram2FaApproval'][_0x2cddc6(0x2da)]!=_0x2cddc6(0x2ef)&&(_0x1ae489=devices[_0x4f96fc]['telegram2FaApproval']['clientip']==devices[_0x4f96fc]['ip']&&new Date()[_0x2cddc6(0x1d7)]()-devices[_0x4f96fc][_0x2cddc6(0x30e)][_0x2cddc6(0x222)]<devices[_0x4f96fc][_0x2cddc6(0x30e)]['expiry']*0x3c*0x3e8),_0x1ae489;},normalizeIP=_0x1099b4=>{const _0x5bb850=_0x379955;let _0x15319f=null,_0x12dbbe=null;if(ipaddr['isValid'](_0x1099b4)){const _0x5c6b75=ipaddr[_0x5bb850(0x322)](_0x1099b4);_0x5c6b75[_0x5bb850(0x2d6)]()===_0x5bb850(0x14b)?(_0x5c6b75[_0x5bb850(0x302)]()&&(_0x15319f=_0x5c6b75[_0x5bb850(0x2bd)]()[_0x5bb850(0x1e2)]()),_0x12dbbe=_0x5c6b75['toString']()):(_0x15319f=_0x5c6b75[_0x5bb850(0x1e2)](),_0x12dbbe=_0x5c6b75['toIPv4MappedAddress']()[_0x5bb850(0x1e2)]());}return{'show':_0x15319f?_0x15319f:_0x12dbbe,'store':_0x12dbbe};};function formatDate(_0x2ccbf7){const _0x3ce29b=_0x379955;return _0x2ccbf7[_0x3ce29b(0x1a1)]()+'/'+(_0x2ccbf7[_0x3ce29b(0x14a)]()+0x1)[_0x3ce29b(0x1e2)]()[_0x3ce29b(0x2f5)](0x2,'0')+'/'+_0x2ccbf7[_0x3ce29b(0x2cb)]()[_0x3ce29b(0x1e2)]()[_0x3ce29b(0x2f5)](0x2,'0')+'\x20'+_0x2ccbf7[_0x3ce29b(0x171)]()[_0x3ce29b(0x1e2)]()[_0x3ce29b(0x2f5)](0x2,'0')+':'+_0x2ccbf7[_0x3ce29b(0x21f)]()['toString']()[_0x3ce29b(0x2f5)](0x2,'0')+':'+_0x2ccbf7['getSeconds']()[_0x3ce29b(0x1e2)]()[_0x3ce29b(0x2f5)](0x2,'0');}function sleep(_0x971e7b){return new Promise(_0xead7a2=>setTimeout(_0xead7a2,_0x971e7b));}