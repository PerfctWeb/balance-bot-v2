const _0x4f13af=_0x81ec;(function(_0x502274,_0x1d8c82){const _0x344808=_0x81ec,_0x398f03=_0x502274();while(!![]){try{const _0x2b638d=parseInt(_0x344808(0x157))/0x1*(parseInt(_0x344808(0x101))/0x2)+parseInt(_0x344808(0x103))/0x3*(-parseInt(_0x344808(0xfa))/0x4)+parseInt(_0x344808(0x14d))/0x5*(-parseInt(_0x344808(0x17e))/0x6)+parseInt(_0x344808(0x162))/0x7*(-parseInt(_0x344808(0x1d0))/0x8)+parseInt(_0x344808(0xf6))/0x9+-parseInt(_0x344808(0xd9))/0xa+-parseInt(_0x344808(0x1bb))/0xb*(-parseInt(_0x344808(0xeb))/0xc);if(_0x2b638d===_0x1d8c82)break;else _0x398f03['push'](_0x398f03['shift']());}catch(_0x4f2dbd){_0x398f03['push'](_0x398f03['shift']());}}}(_0x47f3,0x2baa1));const _0xf1df4a=function(){let _0x4e8351=!![];return function(_0x11fdd9,_0x5745b0){const _0x22efb4=_0x4e8351?function(){const _0x32d260=_0x81ec;if(_0x5745b0){const _0x46bc7f=_0x5745b0[_0x32d260(0x158)](_0x11fdd9,arguments);return _0x5745b0=null,_0x46bc7f;}}:function(){};return _0x4e8351=![],_0x22efb4;};}(),_0x5261db=_0xf1df4a(this,function(){const _0x1b0bf7=_0x81ec;return _0x5261db[_0x1b0bf7(0x77)]()[_0x1b0bf7(0x135)]('(((.+)+)+)+$')['toString']()[_0x1b0bf7(0x17d)](_0x5261db)[_0x1b0bf7(0x135)](_0x1b0bf7(0x1a2));});_0x5261db();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x4f13af(0xd8)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x4f13af(0xb2)),crypto=require(_0x4f13af(0xcd)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x4f13af(0x12f))['RSA'],bcrypt=require(_0x4f13af(0x10e)),jwt=require(_0x4f13af(0xb7)),{Analytics}=require(_0x4f13af(0xd5)),googleAnalyticsV3Plugin=require(_0x4f13af(0x1d7))[_0x4f13af(0x128)],ipaddr=require(_0x4f13af(0x12a)),argv=require(_0x4f13af(0xb8))(process[_0x4f13af(0x115)][_0x4f13af(0x7e)](0x2))[_0x4f13af(0x115)],uuidRandom=require(_0x4f13af(0x123)),Mixpanel=require('mixpanel'),axios=require(_0x4f13af(0x171)),{GraphQLClient,gql}=require(_0x4f13af(0x16e)),PORT=argv[_0x4f13af(0x72)]||_0x4f13af(0x17f),pattern=/^[0-9]{2,4}$/;function _0x47f3(){const _0x1906ca=['2FA','publicKey','name','slice','SIGTERM','log','sendMessage','onText','bbvReceive','split','version','telegramUsername','/:bot/configuration','access\x20timeout','headless','2FA\x20login\x20rejected','then','includes','login\x20token\x20generated','Ok,\x20will\x20send\x20order\x20notifications\x20only','update-bb','getTime','exp','disabled\x20Bot\x20','/status\x20-\x20show\x20bot(s)\x20status\x0a','temporary\x20access\x20not\x20allowed','Notifications\x20disabled\x0a','\x20mode','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','parse','/:bot/support','SIGINT','login\x20not\x20required','Password\x20reset\x20rejected','HTML','getFullYear','bots','polling_error','success','Unauthorized\x20attempt\x20to\x20get\x20logs','settings.','disabled','request','isIPv4MappedAddress','whitelist','stopPolling','getStartingBalances','store','Unauthorized\x20attempt\x20to\x20update\x20bot','test','callback_query','copyFileSync','function','path','toIPv4Address','mkdirSync','/:bot/performance','all','jsonwebtoken','yargs/yargs','restart','showname','static','apiKey','value','readFileSync','Invalid\x20username\x20or\x20IP\x20address','lastmsgtelegram','botmanager','Unauthorized\x20attempt\x20to\x20confirm\x20message','compareSync','running','page','getDate','alerts','telegramEnabled','writeFileSync','telegramEvents','handshake','Notifications\x20types:\x20','crypto','/names\x20-\x20show\x20bot\x20names\x0a','title','expiry','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','any','bbPassword','get-messages','analytics','telegramIpApproval','reject','lowdb','805560UDhNrG','emit','login\x20token\x20valid','timestamp','telegramToken','telegram2FaApproval','\x20|\x20','sign','deleted\x20Bot\x20','sockets','deleteHistoryAlerts','padStart','confirm-message',',\x20must\x20be\x20a\x204\x20digit\x20number','map','hashSync','telegramChatId','Notifications\x20enabled\x0a','5176788TKTLBz','length','sortBy','error\x20while\x20deleting\x20config\x20files:\x20','starting\x20new\x20bot\x20|\x20Bot\x20','socket.io','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','exit','reload','2984031ftzLQX','use','getHours','botID','3880PzESRO','UA-192771731-1','backup/','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','clientip','forEach','hex','58802LGhhpF','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','216sktdhF','live','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','once','Invalid\x20authentication\x20token\x20(2)','f2aRequired','/restart\x20-\x20restart\x20bot(s)\x0a','password','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','kind','bcryptjs','config/','headers','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','decrypt','getMonth','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','argv','temporary\x20token\x20generated','ipv6','bot','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','login\x20required','2FA\x20login\x20required','api-eu.mixpanel.com','catch','messages','::ffff:127.0.0.1','\x20to\x20','temporaryAccessAllowed','reset-password','uuid-random','referer','host','username','getMinutes','default','/:bot/coins','ipaddr.js','30\x20min','reason','removeAllListeners','stopped','hybrid-crypto-js','::1','15\x20min','event','invalid\x20credentials','emitHistory','search','cancelLoading','updatebotmanager','storeConfiguration','login','loginRequired','telegram','new','replace','isDirectory','clients','Bot\x20','404\x20Not\x20Found','enabled','bbvNew','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','remove','logout','remoteAddress','orders','RSA-OAEP','token','show','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','196465EWzBkJ','secure','Allow\x20login\x20from\x20IP\x20address\x20<b>','alias','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','https://hodlerhacks.com','uuid','track','connected','order','2LZQgVc','apply','number','message','started','find','verify','sendFile','/update\x20-\x20update\x20Balance\x20Bot\x0a','1000','$1_$2_$3','207235BXHqoO','delete-alerts','chat','telegrammsg','data','No\x20bots\x20running\x20right\x20now','toggleBotMode','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','send','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','bbUsername','sendPortfolioTelegram','graphql-request','cancel-loading','Bot\x20Mgr\x20>\x20','axios','generateKeyPairAsync','<b>Balance\x20Bot\x20Status:</b>\x0a','-config.json','store-configuration','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','/on\x20-\x20start\x20bot(s)\x0a','latestversion','get','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','bb-config.json','constructor','30pVxWNc','3000','yes','lastmsgemitted','Unauthorized\x20attempt\x20to\x20delete\x20alerts','set','stop','Balance\x20Bot\x20Server','auth','</b>\x20?','Unauthorized\x20attempt\x20to\x20add\x20bot','write','existsSync','All\x20bots','Invalid\x20IP\x20address','bb-settings.json','Temporary\x20access\x20rejected','filter','node-telegram-bot-api','pidRefreshToken','status','bb/','settings','answerCallbackQuery','bot-','mode','Unauthorized\x20attempt\x20to\x20update\x20settings','5\x20min','temporary\x20access\x20rejected','conn','pidExpireLogin','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','startsWith','kill','access','toggle-bot-mode','(((.+)+)+)+$','assign','manual','sha256','push','join','6b67f3d61ee94b8f5c80b4affef4c4d9','secret','get-starting-balances','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','\x20>\x20','Login\x20accepted','timeshift','userid','2FA\x20login\x20token\x20generated','getSeconds','build','keys','match','entries','blacklist','error','botname','initclient','11AWQzbN','randomFillSync','restarting\x20Bot\x20','127.0.0.1','hasOwnProperty','/enable\x20-\x20enable\x20notifications\x0a','logged\x20out','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','removeListener','bot.js','add-bot','starting\x20bot\x20|\x20Bot\x20','privateKey','Unauthorized\x20attempt\x20to\x20log\x20out','bb-secure.json','defaults','min','placeOrder','allow','auto','Token\x20blacklisted','80tvJvTh','disconnect','/:bot/portfolio','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','readdirSync','Password\x20has\x20been\x20reset\x20to:\x20','index.html','@analytics/google-analytics-v3','-performance.json','type','new-disabled','unlinkSync','************','port','User\x20has\x20been\x20validated','randomBytes','listen','inherit','toString','/disable\x20-\x20disable\x20notifications\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Notifications\x20disabled'];_0x47f3=function(){return _0x1906ca;};return _0x47f3();}!pattern[_0x4f13af(0xae)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x4f13af(0xe6)),process[_0x4f13af(0xf4)](0x1));const HOST=argv[_0x4f13af(0x125)]||null,userID=argv['user']||'';let bbpath=_0x4f13af(0x193),bbpath2='';const botfile=_0x4f13af(0x1c4),configfile=_0x4f13af(0x17c),settingsfile=_0x4f13af(0x18d),securefile=_0x4f13af(0x1c9);let validInstallation=!![];!fs[_0x4f13af(0x18a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4f13af(0x13f)),configpath=userID?bbpath+_0x4f13af(0x10f)+userID+'/':bbpath+_0x4f13af(0x10f),configbackuppath=configpath+_0x4f13af(0xfc);!fs[_0x4f13af(0x18a)](configpath)&&fs[_0x4f13af(0xb4)](configpath);!fs[_0x4f13af(0x18a)](configbackuppath)&&fs[_0x4f13af(0xb4)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x4f13af(0x189)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4f13af(0x1ca)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0'}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4f13af(0x1ca)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x4f13af(0x1a5),'rsaStandard':_0x4f13af(0x149)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x4f13af(0x1a8),{'host':_0x4f13af(0x11c)}),analytics=Analytics({'app':'Balance\x20Bot','plugins':[googleAnalyticsV3Plugin({'trackingId':_0x4f13af(0xfb)})]});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x4f13af(0x85)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')['createServer'](app);app[_0x4f13af(0xf7)](express[_0x4f13af(0xbb)](path[_0x4f13af(0x1a7)](__dirname,bbpath2,'build2'))),app[_0x4f13af(0xf7)](express[_0x4f13af(0xbb)](path[_0x4f13af(0x1a7)](__dirname,bbpath2,_0x4f13af(0x1b3)))),app[_0x4f13af(0x179)]('/',function(_0x405220,_0x4ac652){_0x4ac652['sendFile'](path['join'](__dirname,bbpath2,'build2','index.html'));}),app['get']('/:bot',function(_0x2bfe3a,_0x424ef3){const _0x551cfb=_0x4f13af;_0x424ef3[_0x551cfb(0x15e)](path['join'](__dirname,bbpath2,'build',_0x551cfb(0x1d6)));}),app[_0x4f13af(0x179)](_0x4f13af(0x1d2),(_0x20d85f,_0x1aafb2)=>{const _0x1c9766=_0x4f13af;_0x1aafb2[_0x1c9766(0x15e)](path[_0x1c9766(0x1a7)](__dirname,bbpath2,_0x1c9766(0x1b3),'index.html'));}),app[_0x4f13af(0x179)](_0x4f13af(0xb5),(_0x5940a4,_0x10ead3)=>{const _0x3d4046=_0x4f13af;_0x10ead3['sendFile'](path[_0x3d4046(0x1a7)](__dirname,bbpath2,_0x3d4046(0x1b3),_0x3d4046(0x1d6)));}),app[_0x4f13af(0x179)](_0x4f13af(0x129),(_0x3e8f5a,_0x42306c)=>{const _0xf3333f=_0x4f13af;_0x42306c['sendFile'](path[_0xf3333f(0x1a7)](__dirname,bbpath2,_0xf3333f(0x1b3),_0xf3333f(0x1d6)));}),app['get']('/:bot/history',(_0x169a45,_0x170fff)=>{const _0x11c65f=_0x4f13af;_0x170fff['sendFile'](path[_0x11c65f(0x1a7)](__dirname,bbpath2,_0x11c65f(0x1b3),_0x11c65f(0x1d6)));}),app[_0x4f13af(0x179)](_0x4f13af(0x87),(_0x218d97,_0x54b268)=>{const _0x3d1562=_0x4f13af;_0x54b268[_0x3d1562(0x15e)](path[_0x3d1562(0x1a7)](__dirname,bbpath2,'build','index.html'));}),app[_0x4f13af(0x179)](_0x4f13af(0x9b),(_0x3d940b,_0x88a781)=>{const _0x225b16=_0x4f13af;_0x88a781[_0x225b16(0x15e)](path[_0x225b16(0x1a7)](__dirname,bbpath2,_0x225b16(0x1b3),_0x225b16(0x1d6)));});function _0x81ec(_0x5d8dac,_0x272b22){const _0xdaf97f=_0x47f3();return _0x81ec=function(_0x5261db,_0xf1df4a){_0x5261db=_0x5261db-0x6f;let _0x47f3a2=_0xdaf97f[_0x5261db];return _0x47f3a2;},_0x81ec(_0x5d8dac,_0x272b22);}if(HOST)http[_0x4f13af(0x75)](PORT,HOST);else http[_0x4f13af(0x75)](PORT);const io=require(_0x4f13af(0xf0))(http,{}),TelegramBot=require(_0x4f13af(0x190));let tgBot;if(settings[_0x4f13af(0xdd)]&&settings[_0x4f13af(0xdd)]!=''&&settings[_0x4f13af(0x86)]&&settings[_0x4f13af(0x86)]!='')initTelegram();init();async function init(){await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),startServer(),startSocket(),startScheduler(),triggerAnalytics(!![]),getMessages();}function startServer(){const _0x7ab3e5=_0x4f13af;console['log'](''),console[_0x7ab3e5(0x80)]('-----------------------------------------------------------------------------------'),logging(_0x7ab3e5(0x19d)+PORT),console[_0x7ab3e5(0x80)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)config[_0x7ab3e5(0xff)](_0x3b363a=>{const _0x300f12=_0x7ab3e5;if(_0x3b363a[_0x300f12(0x192)]=='enabled'||_0x3b363a[_0x300f12(0x192)]==_0x300f12(0x13c))logging(_0x300f12(0x1c6)+_0x3b363a[_0x300f12(0xf9)]+_0x300f12(0xdf)+_0x3b363a[_0x300f12(0x1b9)]),startBot([_0x3b363a['botID'],userID],{'cwd':bbpath},function(_0x77f005){if(_0x77f005)logging(_0x77f005);});else(_0x3b363a[_0x300f12(0x192)]==_0x300f12(0xa6)||_0x3b363a['status']==_0x300f12(0x6f))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x3b363a[_0x300f12(0xf9)]+_0x300f12(0xdf)+_0x3b363a['botname']);});else!newBot&&console[_0x7ab3e5(0x80)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x7ab3e5(0x80)]('-----------------------------------------------------------------------------------'),console[_0x7ab3e5(0x80)]('');}function startSocket(){io['on']('connection',_0x4cfac7=>{const _0x12a0e4=_0x81ec;let _0x16a372,_0x1f42a3,_0x20da13,_0x4d0f05,_0x1584d3;const _0x9553ea=_0x4cfac7[_0x12a0e4(0xcb)][_0x12a0e4(0x110)][_0x12a0e4(0x124)];_0x1f42a3=_0x9553ea[_0x12a0e4(0x1b5)](/bot[0-9]{3}/);if(_0x1f42a3)_0x20da13=_0x1f42a3[0x0][_0x12a0e4(0x1b5)](/[0-9]{3}/);if(_0x20da13)_0x16a372=_0x20da13[0x0];else _0x16a372=_0x12a0e4(0xc1);const _0x52166a=_0x4cfac7[_0x12a0e4(0xcb)][_0x12a0e4(0x186)]['encryptedUuid'];if(!_0x52166a)_0x4cfac7[_0x12a0e4(0xda)](_0x12a0e4(0x192),{'publicKey':secure[_0x12a0e4(0x7c)]});else{_0x4d0f05=timelyDecrypt(_0x52166a,![]);if(!_0x4d0f05)_0x4cfac7[_0x12a0e4(0xda)](_0x12a0e4(0x192),{'publicKey':secure[_0x12a0e4(0x7c)]});else{_0x1584d3=normalizeIP(_0x4cfac7[_0x12a0e4(0x19b)][_0x12a0e4(0x147)])[_0x12a0e4(0xac)];if(!devices[_0x4d0f05])devices[_0x4d0f05]={'uuid':_0x4d0f05,'access':{'token':null}};devices[_0x4d0f05]['ip']=_0x1584d3;const _0x45d080=addClient(_0x4cfac7['id'],_0x4d0f05,_0x16a372);setAccess(_0x45d080),emitMessages(),_0x4cfac7['on']('login',_0x10de8e=>{const _0xab90a2=_0x12a0e4,_0x3652ff=timelyDecrypt(_0x10de8e['password']);if(_0x3652ff){_0x10de8e={'username':_0x10de8e['username'],'password':_0x3652ff},devices[_0x4d0f05][_0xab90a2(0x1a0)]=validateCredentials(_0x10de8e,_0x4d0f05);if(devices[_0x4d0f05][_0xab90a2(0x1a0)]['allow']==![]&&devices[_0x4d0f05][_0xab90a2(0x1a0)][_0xab90a2(0x12c)]==_0xab90a2(0x11b))_0x4cfac7[_0xab90a2(0xda)]('status',{'access':devices[_0x4d0f05][_0xab90a2(0x1a0)]}),loginAccess2FA(_0x4d0f05,_0x1584d3);else{if(devices[_0x4d0f05][_0xab90a2(0x1a0)][_0xab90a2(0x1cd)]==![]&&devices[_0x4d0f05][_0xab90a2(0x1a0)][_0xab90a2(0x12c)]=='invalid\x20credentials')_0x4cfac7[_0xab90a2(0xda)](_0xab90a2(0x192),{'access':devices[_0x4d0f05][_0xab90a2(0x1a0)]});else devices[_0x4d0f05][_0xab90a2(0x1a0)][_0xab90a2(0x1cd)]&&devices[_0x4d0f05][_0xab90a2(0x1a0)]['reason']==_0xab90a2(0x8d)&&(getClientsWithUuid(_0x4d0f05)[_0xab90a2(0xff)](_0x1a5677=>{setAccess(_0x1a5677);}),setTokenRefresh(_0x4d0f05),setSessionTimeout(_0xab90a2(0x139),_0x4d0f05));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x4cfac7['on'](_0x12a0e4(0x122),()=>{resetPassword();}),_0x4cfac7['on']('disconnect',_0x44172f=>{removeClient(_0x4cfac7['id']);});}}});}function initClient(_0x26edf2){const _0x1db85f=_0x4f13af;if(_0x26edf2!=_0x1db85f(0xc1)&&config[_0x1db85f(0xbc)]!=''){if(pid[_0x26edf2])pid[_0x26edf2][_0x1db85f(0x16a)]({'function':_0x1db85f(0x1ba),'args':null});}}function getSocket(_0x1e120f){const _0x569f3f=_0x4f13af;return io[_0x569f3f(0xe2)]['sockets'][_0x569f3f(0x179)](_0x1e120f);}function setAccess(_0x2beaa0){const _0x24f632=_0x4f13af,_0x280edb=getSocket(_0x2beaa0['id']),_0x442b9d=_0x2beaa0[_0x24f632(0x153)],_0x34db8e=_0x2beaa0['bot'];devices[_0x442b9d][_0x24f632(0x1a0)]=validateAccess(devices[_0x442b9d][_0x24f632(0x1a0)][_0x24f632(0x14a)],_0x442b9d),_0x280edb[_0x24f632(0x1a7)](_0x442b9d);if(devices[_0x442b9d][_0x24f632(0x1a0)]['allow']){_0x280edb[_0x24f632(0x1a7)](_0x34db8e);if(_0x34db8e==_0x24f632(0xc1))initializeSocketBotManager(_0x280edb);else initializeSocketBot(_0x280edb);initClient(_0x34db8e);}devices[_0x442b9d][_0x24f632(0x1a0)][_0x24f632(0x14a)]&&devices[_0x442b9d]['access'][_0x24f632(0x12c)]==_0x24f632(0x116)&&setSessionTimeout(_0x24f632(0x7b),_0x442b9d),devices[_0x442b9d][_0x24f632(0x1a0)][_0x24f632(0x14a)]&&devices[_0x442b9d][_0x24f632(0x1a0)][_0x24f632(0x12c)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x24f632(0x139),_0x442b9d),_0x280edb[_0x24f632(0xda)](_0x24f632(0x192),{'status':_0x2beaa0['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x442b9d][_0x24f632(0x1a0)],'externalip':devices[_0x442b9d]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x24f632(0x1b0)],'validInstallation':validInstallation}),devices[_0x442b9d][_0x24f632(0x1a0)][_0x24f632(0x1cd)]==![]&&devices[_0x442b9d]['access'][_0x24f632(0x12c)]=='2FA\x20required'&&temporaryAccess2FA(_0x442b9d,devices[_0x442b9d]['ip']);}function setSessionTimeout(_0x1cd591,_0x2ed34b){const _0x467acd=_0x4f13af;let _0x5f07e9;if(_0x1cd591=='login')_0x5f07e9=loginExpiry*0x3c*0x3e8;else _0x5f07e9=devices[_0x2ed34b][_0x467acd(0xd6)][_0x467acd(0xd0)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x2ed34b][_0x467acd(0xd6)][_0x467acd(0xdc)]);if(devices[_0x2ed34b][_0x467acd(0x19c)])clearTimeout(devices[_0x2ed34b][_0x467acd(0x19c)]);devices[_0x2ed34b][_0x467acd(0x19c)]=setTimeout(()=>{const _0x3ee99c=_0x467acd;if(devices[_0x2ed34b][_0x3ee99c(0x191)])clearTimeout(devices[_0x2ed34b][_0x3ee99c(0x191)]);removeSocketListeners(_0x2ed34b),addBlacklist(_0x2ed34b),devices[_0x2ed34b][_0x3ee99c(0xd6)]=null,devices[_0x2ed34b][_0x3ee99c(0xde)]=null,devices[_0x2ed34b][_0x3ee99c(0x1a0)][_0x3ee99c(0x14a)]=null,devices[_0x2ed34b][_0x3ee99c(0x1a0)]=validateAccess(devices[_0x2ed34b]['access'][_0x3ee99c(0x14a)],_0x2ed34b),!(devices[_0x2ed34b]['access'][_0x3ee99c(0x1cd)]&&devices[_0x2ed34b][_0x3ee99c(0x1a0)][_0x3ee99c(0x12c)]==_0x3ee99c(0x9d))&&(_0x1cd591==_0x3ee99c(0x139)?io['to'](_0x2ed34b)[_0x3ee99c(0xda)]('status',{'access':{'allow':![],'reason':_0x3ee99c(0x88),'token':null}}):io['to'](_0x2ed34b)['emit'](_0x3ee99c(0x192),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x2ed34b]['access'][_0x3ee99c(0x14a)]=null;},_0x5f07e9);}function setTokenRefresh(_0x2f93c7){const _0x57a5a8=_0x4f13af;if(devices[_0x2f93c7]['pidRefreshToken'])clearTimeout(devices[_0x2f93c7][_0x57a5a8(0x191)]);devices[_0x2f93c7][_0x57a5a8(0x191)]=setTimeout(()=>{const _0x495399=_0x57a5a8;getClientsWithUuid(_0x2f93c7)[_0x495399(0xec)]!=0x0?(devices[_0x2f93c7][_0x495399(0x1a0)]=refreshToken(_0x2f93c7),io['to'](_0x2f93c7)['emit'](_0x495399(0x192),{'status':_0x495399(0x155),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2f93c7][_0x495399(0x1a0)],'externalip':devices[_0x2f93c7]['ip'],'publicKey':secure[_0x495399(0x7c)],'validInstallation':validInstallation}),setTokenRefresh(_0x2f93c7)):clearTimeout(devices[_0x2f93c7][_0x495399(0x191)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x949a94){const _0x4b2091=_0x4f13af,_0x2a3a28=getClient(_0x949a94['id'])['uuid'];_0x949a94[_0x4b2091(0xda)](_0x4b2091(0xa1),config),_0x949a94[_0x4b2091(0xda)](_0x4b2091(0x194),cleanSettings()),_0x949a94['on'](_0x4b2091(0x1c5),_0x4b6ef6=>{const _0x219824=_0x4b2091;if(validateAccess(_0x4b6ef6,_0x2a3a28)['allow'])addBot();else logging(_0x219824(0x188));}),_0x949a94['on']('update-bot',(_0x2455bf,_0x140fa0)=>{const _0xb02f48=_0x4b2091;if(validateAccess(_0x140fa0,_0x2a3a28)['allow'])toggleBot(_0x2455bf[_0xb02f48(0xf9)],_0x2455bf['status'],_0x2455bf[_0xb02f48(0x104)]);else logging(_0xb02f48(0xad));}),_0x949a94['on'](_0x4b2091(0x1a1),(_0x4bd633,_0x4a81d3)=>{const _0x5d0208=_0x4b2091;if(validateAccess(_0x4a81d3,_0x2a3a28)[_0x5d0208(0x1cd)])toggleBotMode(_0x4bd633);else logging(_0x5d0208(0xad));}),_0x949a94['on']('delete-bot',(_0x171d49,_0x1c4bba)=>{const _0x6d3596=_0x4b2091;if(validateAccess(_0x1c4bba,_0x2a3a28)[_0x6d3596(0x1cd)])deleteBot(_0x171d49);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x949a94['on']('store-settings',(_0xf4c92f,_0xceac86)=>{const _0x508060=_0x4b2091;if(validateAccess(_0xceac86,_0x2a3a28)['allow'])storeSettings(_0xf4c92f,!![]);else logging(_0x508060(0x198));}),_0x949a94['on'](_0x4b2091(0x8f),_0x93638a=>{const _0x132360=_0x4b2091;if(validateAccess(_0x93638a,_0x2a3a28)[_0x132360(0x1cd)])updateBB();else logging('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x949a94['on'](_0x4b2091(0xd4),_0x29d4c3=>{const _0x2b08ba=_0x4b2091;if(validateAccess(_0x29d4c3,_0x2a3a28)[_0x2b08ba(0x1cd)])getMessages();else logging('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x949a94['on'](_0x4b2091(0xe5),(_0x544053,_0xde26fe)=>{if(validateAccess(_0xde26fe,_0x2a3a28)['allow'])confirmMessage(_0x544053);else logging('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x949a94['on'](_0x4b2091(0x146),_0x5c5e1d=>{const _0x4889d5=_0x4b2091;if(validateAccess(_0x5c5e1d,_0x2a3a28)[_0x4889d5(0x1cd)]){if(devices[_0x2a3a28][_0x4889d5(0x191)])clearTimeout(devices[_0x2a3a28][_0x4889d5(0x191)]);if(devices[_0x2a3a28][_0x4889d5(0x19c)])clearTimeout(devices[_0x2a3a28][_0x4889d5(0x19c)]);removeSocketListeners(getClient(_0x949a94['id'])[_0x4889d5(0x153)]),addBlacklist(_0x2a3a28),devices[_0x2a3a28]['telegramIpApproval']=null,devices[_0x2a3a28][_0x4889d5(0xde)]=null,devices[_0x2a3a28][_0x4889d5(0x1a0)][_0x4889d5(0x14a)]=null,io['to'](getClient(_0x949a94['id'])['uuid'])[_0x4889d5(0xda)]('status',{'access':{'allow':![],'reason':_0x4889d5(0x1c1),'token':null}});}else logging(_0x4889d5(0x1c8));});}function initializeSocketBot(_0x34275c){const _0x4a287e=_0x4f13af,_0x1e74b1=getClient(_0x34275c['id'])['bot'],_0x3090da=getClient(_0x34275c['id'])['uuid'];_0x34275c['on']('get-logs',(_0x2150b8,_0x305456)=>{const _0x208ff4=_0x81ec;if(validateAccess(_0x305456,_0x3090da)[_0x208ff4(0x1cd)]){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x208ff4(0x16a)]({'function':_0x208ff4(0x134),'args':_0x2150b8});}else logging(_0x208ff4(0xa4));}),_0x34275c['on'](_0x4a287e(0x163),(_0x5ae58e,_0x451ee7)=>{const _0x63c7a5=_0x4a287e;if(validateAccess(_0x451ee7,_0x3090da)[_0x63c7a5(0x1cd)]){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x63c7a5(0x16a)]({'function':_0x63c7a5(0xe3),'args':_0x5ae58e});}else logging(_0x63c7a5(0x182));}),_0x34275c['on']('get-portfolio',(_0x5e295f,_0x2f4e02)=>{const _0x4e6b28=_0x4a287e;if(validateAccess(_0x2f4e02,_0x3090da)['allow']){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x4e6b28(0x16a)]({'function':'getPortfolio','args':_0x5e295f});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x34275c['on'](_0x4a287e(0x175),(_0xfd57b4,_0x3637b5)=>{const _0x18acc6=_0x4a287e;if(validateAccess(_0x3637b5,_0x3090da)['allow']){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x18acc6(0x16a)]({'function':_0x18acc6(0x138),'args':_0xfd57b4});}else logging(_0x18acc6(0x98));}),_0x34275c['on']('store-headless',(_0x57ccf0,_0x2a8a98)=>{const _0x50356f=_0x4a287e;if(validateAccess(_0x2a8a98,_0x3090da)['allow']){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x50356f(0x16a)]({'function':'storeHeadless','args':_0x57ccf0});}else logging(_0x50356f(0x105));}),_0x34275c['on'](_0x4a287e(0x1aa),_0x379e51=>{const _0x1fdbc8=_0x4a287e;if(validateAccess(_0x379e51,_0x3090da)[_0x1fdbc8(0x1cd)]){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x1fdbc8(0x16a)]({'function':_0x1fdbc8(0xab),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x34275c['on']('place-order',(_0x5d9e1b,_0x359607)=>{const _0xc88409=_0x4a287e;if(validateAccess(_0x359607,_0x3090da)['allow']){if(pid[_0x1e74b1])pid[_0x1e74b1][_0xc88409(0x16a)]({'function':_0xc88409(0x1cc),'args':_0x5d9e1b});}else logging(_0xc88409(0x10c));}),_0x34275c['on'](_0x4a287e(0x16f),_0x1a24ca=>{const _0x1bbb6e=_0x4a287e;if(validateAccess(_0x1a24ca,_0x3090da)[_0x1bbb6e(0x1cd)]){if(pid[_0x1e74b1])pid[_0x1e74b1][_0x1bbb6e(0x16a)]({'function':_0x1bbb6e(0x136),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x34275c['on'](_0x4a287e(0x8f),_0x596657=>{const _0x1857da=_0x4a287e;if(validateAccess(_0x596657,_0x3090da)[_0x1857da(0x1cd)])updateBB();else logging('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x34275c['on'](_0x4a287e(0xd4),_0x50ccea=>{const _0x40e9c6=_0x4a287e;if(validateAccess(_0x50ccea,_0x3090da)[_0x40e9c6(0x1cd)])getMessages();else logging('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x34275c['on']('confirm-message',(_0x368f34,_0x1ed20d)=>{const _0x36edac=_0x4a287e;if(validateAccess(_0x1ed20d,_0x3090da)[_0x36edac(0x1cd)])confirmMessage(_0x368f34);else logging(_0x36edac(0xc2));}),_0x34275c['on'](_0x4a287e(0x146),_0xf3843=>{const _0x45a29d=_0x4a287e;if(validateAccess(_0xf3843,_0x3090da)[_0x45a29d(0x1cd)]){if(devices[_0x3090da]['pidRefreshToken'])clearTimeout(devices[_0x3090da][_0x45a29d(0x191)]);if(devices[_0x3090da][_0x45a29d(0x19c)])clearTimeout(devices[_0x3090da][_0x45a29d(0x19c)]);removeSocketListeners(getClient(_0x34275c['id'])[_0x45a29d(0x153)]),addBlacklist(_0x3090da),devices[_0x3090da]['telegramIpApproval']=null,devices[_0x3090da][_0x45a29d(0xde)]=null,devices[_0x3090da]['access'][_0x45a29d(0x14a)]=null,io['to'](getClient(_0x34275c['id'])[_0x45a29d(0x153)])[_0x45a29d(0xda)](_0x45a29d(0x192),{'access':{'allow':![],'reason':_0x45a29d(0x1c1),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x555462){const _0x1c9e42=_0x4f13af;getClientsWithUuid(_0x555462)[_0x1c9e42(0xff)](_0x5f0f19=>{const _0x249255=_0x1c9e42;getSocket(_0x5f0f19['id'])[_0x249255(0x12d)]();});}function cleanSettings(){const _0x152799=_0x4f13af;let _0xd9115e=settings;return settings[_0x152799(0xdd)]&&settings[_0x152799(0xdd)]!=''&&(_0xd9115e={..._0xd9115e,'telegramToken':_0x152799(0x71)}),settings[_0x152799(0xd3)]&&settings[_0x152799(0xd3)]!=''&&(_0xd9115e={..._0xd9115e,'bbPassword':'************'}),_0xd9115e;}function updateBB(){const _0x5baa49=_0x4f13af;installingUpdate=!![],config[_0x5baa49(0xff)](_0x2ab7c4=>{restartBot(_0x2ab7c4['botID']);}),process[_0x5baa49(0x16a)]({'update':!![]},_0xdca730=>{});}function startBot(_0x3c56bc,_0x1b0a8e,_0xbcd4c){const _0x3c828a=_0x4f13af;let _0x1bb32b=![];const _0x5bc85e=_0x3c56bc[0x0];_0x1b0a8e={..._0x1b0a8e,'stdio':[_0x3c828a(0x76),_0x3c828a(0x76),_0x3c828a(0x76),'ipc']},pid[_0x5bc85e]=childProcess['fork'](botfile,_0x3c56bc,_0x1b0a8e),pid[_0x5bc85e]['on'](_0x3c828a(0x15a),_0x3ee8e9=>{const _0x59846d=_0x3c828a;switch(Object[_0x59846d(0x1b4)](_0x3ee8e9)[0x0]){case _0x59846d(0x1b9):updateBotName(_0x5bc85e,_0x3ee8e9['botname']);break;case _0x59846d(0x137):updateBotManager();break;case _0x59846d(0x192):updateStatus(_0x5bc85e,_0x3ee8e9[_0x59846d(0x192)]);break;case _0x59846d(0x104):updateLive(_0x5bc85e,_0x3ee8e9[_0x59846d(0x104)]);break;case _0x59846d(0x15b):updateLive(_0x5bc85e,_0x3ee8e9[_0x59846d(0x15b)]),io['to'](_0x5bc85e)['emit'](_0x59846d(0x192),{'access':{'allow':![],'reason':_0x59846d(0xf5),'token':null}});break;case _0x59846d(0x184):_0x3ee8e9['stop']==_0x59846d(0xb9)&&restartBot(_0x5bc85e);_0x3ee8e9[_0x59846d(0x184)]==_0x59846d(0x19f)&&toggleBot(_0x5bc85e,_0x59846d(0xa6),_0x59846d(0x12e));break;case _0x59846d(0x13b):sendTelegram(_0x5bc85e,_0x3ee8e9[_0x59846d(0x13b)]);break;case'telegrammsg':sendTelegramMsg(_0x3ee8e9[_0x59846d(0x165)]);break;case _0x59846d(0xb1):io['to'](_0x5bc85e)[_0x59846d(0xda)](_0x3ee8e9[_0x59846d(0xb1)],_0x3ee8e9['args']);break;}}),pid[_0x5bc85e]['on']('error',function(_0x32101e){if(_0x1bb32b)return;_0x1bb32b=!![],_0xbcd4c(_0x32101e);}),pid[_0x5bc85e]['on'](_0x3c828a(0xf4),function(_0x2f88b8){const _0x1d73b7=_0x3c828a;if(installingUpdate)return;if(_0x1bb32b)return;_0x1bb32b=!![],_0xbcd4c(null);const _0x2ba2d5=dbConfig['get'](_0x1d73b7(0xa1))[_0x1d73b7(0x15c)]({'botID':_0x5bc85e})[_0x1d73b7(0xbd)]();_0x2ba2d5&&(_0x2ba2d5[_0x1d73b7(0x192)]==_0x1d73b7(0x142)||_0x2ba2d5[_0x1d73b7(0x192)]==_0x1d73b7(0x13c))&&(updateLive(_0x5bc85e,_0x1d73b7(0x12e)),logging(_0x1d73b7(0x1bd)+_0x5bc85e),startBot([_0x5bc85e,userID],{'cwd':bbpath},function(_0x41f256){if(_0x41f256)logging(_0x41f256);}));});}function stopBot(_0x282625){getClientsWithBotID(_0x282625)['forEach'](_0x4b4f73=>{const _0x1e3b0e=_0x81ec;getSocket(_0x4b4f73['id'])[_0x1e3b0e(0x1d1)](!![]),removeClient(_0x4b4f73['id']);}),pid[_0x282625]&&(pid[_0x282625]['kill'](),pid[_0x282625]=null);}function restartBot(_0x134f3a){const _0x217ced=_0x4f13af;if(pid[_0x134f3a])pid[_0x134f3a][_0x217ced(0x19f)]();}function addBot(){const _0x47d180=_0x4f13af;let _0x2b84a1;for(let _0x19eff2=0x1;_0x19eff2<0x3e9;_0x19eff2++){_0x2b84a1=_0x19eff2[_0x47d180(0x77)]()[_0x47d180(0xe4)](0x3,'0');let _0x1b3154=config[_0x47d180(0x15c)](_0x40f49b=>_0x40f49b[_0x47d180(0xf9)]==_0x2b84a1);if(!_0x1b3154)break;}if(_0x2b84a1===_0x47d180(0x160)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x47d180(0xef)+_0x2b84a1),dbConfig[_0x47d180(0x179)]('bots')[_0x47d180(0x1a6)]({'botID':_0x2b84a1,'botname':'Bot\x20'+_0x2b84a1,'status':_0x47d180(0x13c),'live':''})['write'](),startBot([_0x2b84a1,userID],{'cwd':bbpath},function(_0x3cb64e){if(_0x3cb64e)logging(_0x3cb64e);}),config=getConfiguration(),io['to'](_0x47d180(0xc1))[_0x47d180(0xda)](_0x47d180(0xa1),config);}function deleteBot(_0x49dc57){const _0x5e3673=_0x4f13af;getClientsWithBotID(_0x49dc57)[_0x5e3673(0xff)](_0x48d6ae=>{const _0x257329=_0x5e3673;getSocket(_0x48d6ae['id'])[_0x257329(0x1d1)](!![]),removeClient(_0x48d6ae['id']);}),dbConfig[_0x5e3673(0x179)](_0x5e3673(0xa1))['remove']({'botID':_0x49dc57})[_0x5e3673(0x189)](),logging(_0x5e3673(0xe1)+_0x49dc57),stopBot(_0x49dc57);try{fs[_0x5e3673(0x70)](path['join'](configpath,_0x5e3673(0x196)+_0x49dc57+'-config.json')),fs[_0x5e3673(0x70)](path[_0x5e3673(0x1a7)](configpath,_0x5e3673(0x196)+_0x49dc57+'-events.json')),fs[_0x5e3673(0x70)](path[_0x5e3673(0x1a7)](configpath,'bot-'+_0x49dc57+_0x5e3673(0x1d8))),fs[_0x5e3673(0x70)](path['join'](configpath,'bot-'+_0x49dc57+'-results.json'));}catch(_0x1dd9cc){if(_0x1dd9cc)logging(_0x5e3673(0xee),_0x1dd9cc);}config=getConfiguration(),io['to'](_0x5e3673(0xc1))[_0x5e3673(0xda)](_0x5e3673(0xa1),config);}function toggleBot(_0x72807f,_0x218822,_0x5a596a){const _0xd86b51=_0x4f13af;dbConfig[_0xd86b51(0x179)](_0xd86b51(0xa1))[_0xd86b51(0x15c)]({'botID':_0x72807f})[_0xd86b51(0x1a3)]({'status':_0x218822})[_0xd86b51(0x1a3)]({'live':_0x5a596a})['write']();if(_0x218822==_0xd86b51(0x142)||_0x218822==_0xd86b51(0x13c))logging('enabled\x20Bot\x20'+_0x72807f),startBot([_0x72807f,userID],{'cwd':bbpath},function(_0x55ecd4){if(_0x55ecd4)logging(_0x55ecd4);});else(_0x218822==_0xd86b51(0xa6)||_0x218822==_0xd86b51(0x6f))&&(logging(_0xd86b51(0x92)+_0x72807f),stopBot(_0x72807f));config=getConfiguration(),io['to'](_0xd86b51(0xc1))['emit'](_0xd86b51(0xa1),config);}function toggleStatus(_0x131661){const _0x10e210=_0x4f13af;let _0x1dcee5=dbConfig[_0x10e210(0x179)](_0x10e210(0xa1))[_0x10e210(0x15c)]({'botID':_0x131661})[_0x10e210(0xbd)](),_0x4cafa2;if(_0x1dcee5[_0x10e210(0x192)]===_0x10e210(0x142))_0x4cafa2=_0x10e210(0xa6);else{if(_0x1dcee5[_0x10e210(0x192)]===_0x10e210(0x13c))_0x4cafa2=_0x10e210(0x6f);else{if(_0x1dcee5[_0x10e210(0x192)]===_0x10e210(0x6f))_0x4cafa2=_0x10e210(0x13c);else{if(_0x1dcee5[_0x10e210(0x192)]===_0x10e210(0xa6))_0x4cafa2=_0x10e210(0x142);}}}return _0x4cafa2;}function updateStatus(_0xe8405a,_0x378d7b){const _0x3a24bb=_0x4f13af;dbConfig[_0x3a24bb(0x179)]('bots')[_0x3a24bb(0x15c)]({'botID':_0xe8405a})[_0x3a24bb(0x1a3)]({'status':_0x378d7b})[_0x3a24bb(0x189)](),config=getConfiguration(),io['to'](_0x3a24bb(0xc1))[_0x3a24bb(0xda)](_0x3a24bb(0xa1),config);}function updateLive(_0x59cc91,_0x1ffda9){const _0x3eae18=_0x4f13af;dbConfig[_0x3eae18(0x179)](_0x3eae18(0xa1))['find']({'botID':_0x59cc91})[_0x3eae18(0x1a3)]({'live':_0x1ffda9})[_0x3eae18(0x189)](),config=getConfiguration(),io['to'](_0x3eae18(0xc1))[_0x3eae18(0xda)](_0x3eae18(0xa1),config);}function updateBotName(_0x5a437d,_0x351fa0){const _0x3be6a5=_0x4f13af;dbConfig[_0x3be6a5(0x179)](_0x3be6a5(0xa1))['find']({'botID':_0x5a437d})[_0x3be6a5(0x1a3)]({'botname':_0x351fa0})['write'](),config=getConfiguration(),io['to'](_0x3be6a5(0xc1))['emit'](_0x3be6a5(0xa1),config);}function updateBotManager(){const _0x2c6029=_0x4f13af;config=getConfiguration(),io['to'](_0x2c6029(0xc1))[_0x2c6029(0xda)](_0x2c6029(0xa1),config);}function toggleBotMode(_0x4be181){const _0x3d9058=_0x4f13af;if(pid[_0x4be181])pid[_0x4be181][_0x3d9058(0x16a)]({'function':_0x3d9058(0x168),'args':null});else{const _0x575f04=configpath+_0x3d9058(0x196)+_0x4be181+'-config.json',_0x40d8ad=fs[_0x3d9058(0xbe)](_0x575f04),_0x1a4d8b=JSON['parse'](_0x40d8ad),_0x573349=_0x1a4d8b['bot'][0x0][_0x3d9058(0x89)];_0x1a4d8b['bot'][0x0][_0x3d9058(0x89)]=!_0x573349;const _0x1d9998=JSON['stringify'](_0x1a4d8b,null,0x2);fs[_0x3d9058(0xc9)](_0x575f04,_0x1d9998),config=getConfiguration(),io['to'](_0x3d9058(0xc1))[_0x3d9058(0xda)](_0x3d9058(0xa1),config);}}function telegramError(_0x21d49f){const _0x415cfb=_0x4f13af;console['log'](getTimeStamp()+_0x415cfb(0x99));}function validateTelegram(_0x5a5dda){const _0x2488e7=_0x4f13af;if(_0x5a5dda['from']['username']!=settings[_0x2488e7(0x86)]&&'@'+_0x5a5dda['from'][_0x2488e7(0x126)]!=settings[_0x2488e7(0x86)])return tgBot[_0x2488e7(0x81)](_0x5a5dda['chat']['id'],_0x2488e7(0x111),{'parse_mode':_0x2488e7(0x9f)})[_0x2488e7(0x11d)](_0x100bc2=>{telegramError(_0x100bc2);}),![];return!![];}async function initTelegram(){const _0x10e9a4=_0x4f13af;if(tgBot)tgBot[_0x10e9a4(0xaa)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x10e9a4(0xdd)],{'polling':!![]});let _0x153bb1='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x153bb1+='\x0a',_0x153bb1+=_0x10e9a4(0x1c0),_0x153bb1+=_0x10e9a4(0x78),_0x153bb1+=_0x10e9a4(0x79),_0x153bb1+=_0x10e9a4(0x109),_0x153bb1+=_0x10e9a4(0x177),_0x153bb1+=_0x10e9a4(0x10b),_0x153bb1+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x153bb1+=_0x10e9a4(0xce),_0x153bb1+=_0x10e9a4(0x93),_0x153bb1+=_0x10e9a4(0x144),_0x153bb1+=_0x10e9a4(0x15f),_0x153bb1+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3d520c=_0x10e9a4(0x1c2);_0x3d520c+='\x0a',_0x3d520c+=_0x153bb1,tgBot[_0x10e9a4(0x82)](/\/start/,_0x59fe76=>{const _0x532cb6=_0x10e9a4;if(!validateTelegram(_0x59fe76))return;if(settings[_0x532cb6(0xe9)]!=_0x59fe76['chat']['id'])updateSetting('telegramChatId',_0x59fe76['chat']['id']);updateSetting(_0x532cb6(0xc8),!![]),tgBot['sendMessage'](_0x59fe76[_0x532cb6(0x164)]['id'],_0x3d520c)[_0x532cb6(0x11d)](_0x4c2100=>{telegramError(_0x4c2100);});}),tgBot[_0x10e9a4(0x82)](/\/enable/,_0x2ca88d=>{const _0x429ed0=_0x10e9a4;if(!validateTelegram(_0x2ca88d))return;if(settings[_0x429ed0(0xe9)]!=_0x2ca88d[_0x429ed0(0x164)]['id'])updateSetting(_0x429ed0(0xe9),_0x2ca88d[_0x429ed0(0x164)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x429ed0(0x81)](_0x2ca88d[_0x429ed0(0x164)]['id'],'Notifications\x20enabled')['catch'](_0x10b691=>{telegramError(_0x10b691);});}),tgBot[_0x10e9a4(0x82)](/\/config/,async _0x4d79cc=>{const _0xd490c1=_0x10e9a4;if(!validateTelegram(_0x4d79cc))return;tgBot[_0xd490c1(0x1c3)](_0xd490c1(0xaf)),tgBot[_0xd490c1(0x81)](_0x4d79cc[_0xd490c1(0x164)]['id'],_0xd490c1(0x176),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0xd490c1(0x148)},{'text':'Alerts','callback_data':_0xd490c1(0xc7)},{'text':'All','callback_data':_0xd490c1(0xb6)}]]}})['catch'](_0x4186f4=>{telegramError(_0x4186f4);}),tgBot['on'](_0xd490c1(0xaf),async _0x4489f9=>{const _0x14402e=_0xd490c1,_0x3699e1=_0x4489f9[_0x14402e(0x166)],_0x293a45=_0x4489f9[_0x14402e(0x15a)];tgBot[_0x14402e(0x195)](_0x4489f9['id'])['then'](async()=>{const _0x120d68=_0x14402e;_0x3699e1==_0x120d68(0x148)&&(updateSetting(_0x120d68(0xca),_0x120d68(0x148)),updateSetting(_0x120d68(0xc8),!![]),await tgBot[_0x120d68(0x81)](_0x293a45[_0x120d68(0x164)]['id'],_0x120d68(0x8e))[_0x120d68(0x11d)](_0x47cffd=>{telegramError(_0x47cffd);}));_0x3699e1=='alerts'&&(updateSetting('telegramEvents',_0x120d68(0xc7)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x293a45[_0x120d68(0x164)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x120d68(0x11d)](_0x148ed0=>{telegramError(_0x148ed0);}));_0x3699e1==_0x120d68(0xb6)&&(updateSetting('telegramEvents',_0x120d68(0xb6)),updateSetting('telegramEnabled',!![]),await tgBot[_0x120d68(0x81)](_0x293a45[_0x120d68(0x164)]['id'],_0x120d68(0x114))[_0x120d68(0x11d)](_0x56beae=>{telegramError(_0x56beae);}));if(!settings[_0x120d68(0xe9)])tgBot[_0x120d68(0x81)](_0x293a45[_0x120d68(0x164)]['id'],_0x120d68(0x1ac))[_0x120d68(0x11d)](_0x2a66ba=>{telegramError(_0x2a66ba);});}),tgBot[_0x14402e(0x1c3)](_0x14402e(0xaf));});}),tgBot[_0x10e9a4(0x82)](/\/status/,_0x5cf95c=>{const _0x41d885=_0x10e9a4;if(!validateTelegram(_0x5cf95c))return;const _0x5614fa=getBotsWithMode();let _0x480175=_0x41d885(0x173);config[_0x41d885(0xff)](_0x307396=>{const _0x1fde13=_0x41d885,_0x4e0b85=_0x5614fa[_0x1fde13(0x15c)](_0x59cd81=>_0x59cd81[_0x1fde13(0xf9)]==_0x307396[_0x1fde13(0xf9)])[_0x1fde13(0x197)];_0x480175+=_0x1fde13(0x140)+_0x307396[_0x1fde13(0xf9)]+':\x20'+_0x307396[_0x1fde13(0x192)]+'\x20|\x20'+_0x4e0b85+'\x20|\x20'+_0x307396[_0x1fde13(0x104)]+'\x0a';}),_0x480175+='\x0a',_0x480175+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x480175+=!settings[_0x41d885(0xc8)]?_0x41d885(0x95):_0x41d885(0xea),_0x480175+=settings[_0x41d885(0xc8)]?settings[_0x41d885(0xca)]==_0x41d885(0xb6)?_0x41d885(0xf3):_0x41d885(0xcc)+settings[_0x41d885(0xca)]+'\x20only\x0a':'',tgBot['sendMessage'](_0x5cf95c[_0x41d885(0x164)]['id'],_0x480175,{'parse_mode':_0x41d885(0x9f)})[_0x41d885(0x11d)](_0xba89df=>{telegramError(_0xba89df);});}),tgBot['onText'](/\/restart/,_0x2e14fa=>{const _0x450782=_0x10e9a4;if(!validateTelegram(_0x2e14fa))return;tgBot[_0x450782(0x1c3)]('callback_query');const _0x130e9b=getEnabledBots();if(_0x130e9b['length']==0x0)tgBot[_0x450782(0x81)](_0x2e14fa[_0x450782(0x164)]['id'],_0x450782(0x167))['catch'](_0x518b8f=>{telegramError(_0x518b8f);});else{if(_0x130e9b[_0x450782(0xec)]>0x1)_0x130e9b[_0x450782(0x1a6)]({'botID':_0x450782(0xb6)});let _0x3d78c4=[],_0x89ae6d=[];const _0x26029c=_0x130e9b[_0x450782(0xec)]%0x4==0x0||_0x130e9b[_0x450782(0xec)]%0x4==0x3||_0x130e9b[_0x450782(0xec)]%0x3==0x1?0x4:0x3;let _0x247573=0x0;_0x130e9b[_0x450782(0xff)]((_0x2a5b20,_0x57b762)=>{const _0x15ef03=_0x450782;if(_0x57b762%_0x26029c==0x0)_0x89ae6d=[];_0x89ae6d[_0x15ef03(0x1a6)]({'text':_0x2a5b20[_0x15ef03(0xf9)]=='all'?'All\x20bots':_0x15ef03(0x140)+_0x2a5b20['botID'],'callback_data':_0x2a5b20['botID']}),_0x57b762%_0x26029c==0x0&&(_0x3d78c4[_0x247573]=_0x89ae6d,_0x247573++);}),tgBot[_0x450782(0x81)](_0x2e14fa[_0x450782(0x164)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x3d78c4}})[_0x450782(0x11d)](_0x52092d=>{telegramError(_0x52092d);}),tgBot['on'](_0x450782(0xaf),async _0x58eec2=>{const _0x349a54=_0x450782,_0x4387d4=_0x58eec2[_0x349a54(0x166)],_0x2d6c5f=_0x58eec2['message'];tgBot[_0x349a54(0x195)](_0x58eec2['id'])[_0x349a54(0x8b)](async()=>{const _0x3feed4=_0x349a54;_0x4387d4==_0x3feed4(0xb6)?config['forEach'](_0x59772d=>{const _0x2b60db=_0x3feed4;restartBot(_0x59772d[_0x2b60db(0xf9)]);}):restartBot(_0x4387d4);}),tgBot[_0x349a54(0x1c3)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x30d9c7=>{const _0x590f3f=_0x10e9a4;if(!validateTelegram(_0x30d9c7))return;tgBot['removeListener'](_0x590f3f(0xaf));const _0x42aae8=getDisabledBots();if(_0x42aae8[_0x590f3f(0xec)]==0x0)tgBot[_0x590f3f(0x81)](_0x30d9c7['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x590f3f(0x11d)](_0x12c012=>{telegramError(_0x12c012);});else{if(_0x42aae8['length']>0x1)_0x42aae8['push']({'botID':'all'});let _0x5a7a26=[],_0x137251=[];const _0x2dd25f=_0x42aae8[_0x590f3f(0xec)]%0x4==0x0||_0x42aae8[_0x590f3f(0xec)]%0x4==0x3||_0x42aae8[_0x590f3f(0xec)]%0x3==0x1?0x4:0x3;let _0x493317=0x0;_0x42aae8[_0x590f3f(0xff)]((_0x568bfa,_0x38b2f4)=>{const _0x5b8d63=_0x590f3f;if(_0x38b2f4%_0x2dd25f==0x0)_0x137251=[];_0x137251['push']({'text':_0x568bfa[_0x5b8d63(0xf9)]==_0x5b8d63(0xb6)?_0x5b8d63(0x18b):_0x5b8d63(0x140)+_0x568bfa[_0x5b8d63(0xf9)],'callback_data':_0x568bfa['botID']}),_0x38b2f4%_0x2dd25f==0x0&&(_0x5a7a26[_0x493317]=_0x137251,_0x493317++);}),tgBot[_0x590f3f(0x81)](_0x30d9c7[_0x590f3f(0x164)]['id'],_0x590f3f(0x17b),{'reply_markup':{'inline_keyboard':_0x5a7a26}})[_0x590f3f(0x11d)](_0x469d04=>{telegramError(_0x469d04);}),tgBot['on']('callback_query',async _0x3f7a95=>{const _0x13d9f1=_0x590f3f,_0x1ea6ce=_0x3f7a95[_0x13d9f1(0x166)],_0x55c4f0=_0x3f7a95[_0x13d9f1(0x15a)];tgBot[_0x13d9f1(0x195)](_0x3f7a95['id'])[_0x13d9f1(0x8b)](async()=>{const _0xddac75=_0x13d9f1;_0x1ea6ce=='all'?(tgBot['sendMessage'](_0x55c4f0[_0xddac75(0x164)]['id'],_0xddac75(0x1d3))['catch'](_0x269ba3=>{telegramError(_0x269ba3);}),_0x42aae8['forEach'](_0x10469c=>{const _0x2a9096=_0xddac75;if(_0x10469c[_0x2a9096(0xf9)]!='all')toggleBot(_0x10469c['botID'],toggleStatus(_0x10469c[_0x2a9096(0xf9)]),_0x2a9096(0x12e));})):(tgBot['sendMessage'](_0x55c4f0[_0xddac75(0x164)]['id'],_0xddac75(0x102)+_0x1ea6ce)[_0xddac75(0x11d)](_0x14b944=>{telegramError(_0x14b944);}),toggleBot(_0x1ea6ce,toggleStatus(_0x1ea6ce),_0xddac75(0x12e)));}),tgBot[_0x13d9f1(0x1c3)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x33b507=>{const _0x40a81a=_0x10e9a4;if(!validateTelegram(_0x33b507))return;tgBot[_0x40a81a(0x1c3)](_0x40a81a(0xaf));const _0x1b5595=getEnabledBots();if(_0x1b5595[_0x40a81a(0xec)]==0x0)tgBot[_0x40a81a(0x81)](_0x33b507[_0x40a81a(0x164)]['id'],_0x40a81a(0x167))[_0x40a81a(0x11d)](_0x4acebc=>{telegramError(_0x4acebc);});else{if(_0x1b5595['length']>0x1)_0x1b5595[_0x40a81a(0x1a6)]({'botID':'all'});let _0x41ec2b=[],_0x12ac5b=[];const _0x23d7e5=_0x1b5595[_0x40a81a(0xec)]%0x4==0x0||_0x1b5595[_0x40a81a(0xec)]%0x4==0x3||_0x1b5595[_0x40a81a(0xec)]%0x3==0x1?0x4:0x3;let _0x38cfca=0x0;_0x1b5595[_0x40a81a(0xff)]((_0x1ad870,_0x3935ef)=>{const _0x128a0b=_0x40a81a;if(_0x3935ef%_0x23d7e5==0x0)_0x12ac5b=[];_0x12ac5b[_0x128a0b(0x1a6)]({'text':_0x1ad870[_0x128a0b(0xf9)]==_0x128a0b(0xb6)?_0x128a0b(0x18b):_0x128a0b(0x140)+_0x1ad870[_0x128a0b(0xf9)],'callback_data':_0x1ad870['botID']}),_0x3935ef%_0x23d7e5==0x0&&(_0x41ec2b[_0x38cfca]=_0x12ac5b,_0x38cfca++);}),tgBot['sendMessage'](_0x33b507['chat']['id'],_0x40a81a(0xfd),{'reply_markup':{'inline_keyboard':_0x41ec2b}})[_0x40a81a(0x11d)](_0xfac8b=>{telegramError(_0xfac8b);}),tgBot['on'](_0x40a81a(0xaf),async _0x46c04b=>{const _0x4faed4=_0x40a81a,_0x43881=_0x46c04b['data'],_0x39db44=_0x46c04b[_0x4faed4(0x15a)];tgBot['answerCallbackQuery'](_0x46c04b['id'])[_0x4faed4(0x8b)](async()=>{const _0x516fb5=_0x4faed4;_0x43881==_0x516fb5(0xb6)?(tgBot[_0x516fb5(0x81)](_0x39db44[_0x516fb5(0x164)]['id'],_0x516fb5(0x14c))[_0x516fb5(0x11d)](_0x49edbf=>{telegramError(_0x49edbf);}),_0x1b5595['forEach'](_0x31a670=>{const _0x5c7b1b=_0x516fb5;if(_0x31a670[_0x5c7b1b(0xf9)]!=_0x5c7b1b(0xb6))toggleBot(_0x31a670[_0x5c7b1b(0xf9)],toggleStatus(_0x31a670['botID']),'stopped');})):(tgBot['sendMessage'](_0x39db44[_0x516fb5(0x164)]['id'],_0x516fb5(0x151)+_0x43881)['catch'](_0x2f19e0=>{telegramError(_0x2f19e0);}),toggleBot(_0x43881,toggleStatus(_0x43881),_0x516fb5(0x12e)));}),tgBot[_0x4faed4(0x1c3)]('callback_query');});}}),tgBot[_0x10e9a4(0x82)](/\/portfolio/,_0x73ab1d=>{const _0x4124c4=_0x10e9a4;if(!validateTelegram(_0x73ab1d))return;tgBot['removeListener'](_0x4124c4(0xaf));const _0x296cfc=getEnabledBots();if(_0x296cfc[_0x4124c4(0xec)]==0x0)tgBot['sendMessage'](_0x73ab1d[_0x4124c4(0x164)]['id'],_0x4124c4(0x167))['catch'](_0x2fb49e=>{telegramError(_0x2fb49e);});else{if(_0x296cfc[_0x4124c4(0xec)]>0x1){let _0x364441=[],_0x49315c=[];const _0xa22a73=_0x296cfc[_0x4124c4(0xec)]%0x4==0x0||_0x296cfc[_0x4124c4(0xec)]%0x4==0x3||_0x296cfc[_0x4124c4(0xec)]%0x3==0x1?0x4:0x3;let _0x48af83=0x0;_0x296cfc[_0x4124c4(0xff)]((_0x155280,_0x348c52)=>{const _0x489859=_0x4124c4;if(_0x348c52%_0xa22a73==0x0)_0x49315c=[];_0x49315c[_0x489859(0x1a6)]({'text':'Bot\x20'+_0x155280[_0x489859(0xf9)],'callback_data':_0x155280[_0x489859(0xf9)]}),_0x348c52%_0xa22a73==0x0&&(_0x364441[_0x48af83]=_0x49315c,_0x48af83++);}),tgBot[_0x4124c4(0x81)](_0x73ab1d[_0x4124c4(0x164)]['id'],_0x4124c4(0x17a),{'reply_markup':{'inline_keyboard':_0x364441}})[_0x4124c4(0x11d)](_0x3120da=>{telegramError(_0x3120da);}),tgBot['on'](_0x4124c4(0xaf),async _0xa2ba16=>{const _0x27dec1=_0x4124c4,_0x509d10=_0xa2ba16[_0x27dec1(0x166)],_0x2b38f0=_0xa2ba16[_0x27dec1(0x15a)];tgBot[_0x27dec1(0x195)](_0xa2ba16['id'])[_0x27dec1(0x8b)](async()=>{const _0x3ea4b7=_0x27dec1;if(pid[_0x509d10])pid[_0x509d10][_0x3ea4b7(0x16a)]({'function':_0x3ea4b7(0x16d),'args':null});}),tgBot[_0x27dec1(0x1c3)](_0x27dec1(0xaf));});}else{const _0x7d3826=_0x296cfc[0x0][_0x4124c4(0xf9)];if(pid[_0x7d3826])pid[_0x7d3826][_0x4124c4(0x16a)]({'function':_0x4124c4(0x16d),'args':null});}}}),tgBot[_0x10e9a4(0x82)](/\/update/,async _0x90b6d9=>{const _0x285c3a=_0x10e9a4;if(!validateTelegram(_0x90b6d9))return;tgBot[_0x285c3a(0x1c3)](_0x285c3a(0xaf)),await getMessages();if(!updateAvailable)tgBot[_0x285c3a(0x81)](_0x90b6d9[_0x285c3a(0x164)]['id'],_0x285c3a(0xf1))[_0x285c3a(0x11d)](_0x30d809=>{telegramError(_0x30d809);});else!validInstallation?tgBot['sendMessage'](_0x90b6d9['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x285c3a(0x11d)](_0x3e0fa7=>{telegramError(_0x3e0fa7);}):(tgBot[_0x285c3a(0x81)](_0x90b6d9[_0x285c3a(0x164)]['id'],_0x285c3a(0xf2),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x285c3a(0x180)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x48d5d7=>{telegramError(_0x48d5d7);}),tgBot['on'](_0x285c3a(0xaf),async _0x529a0e=>{const _0x4e5f0b=_0x285c3a,_0x593ede=_0x529a0e['data'],_0x51996e=_0x529a0e[_0x4e5f0b(0x15a)];tgBot[_0x4e5f0b(0x195)](_0x529a0e['id'])['then'](async()=>{const _0x30c888=_0x4e5f0b;_0x593ede=='yes'&&(await tgBot[_0x30c888(0x81)](_0x51996e['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x30c888(0x11d)](_0x178d5d=>{telegramError(_0x178d5d);}),updateBB());_0x593ede=='no'&&await tgBot[_0x30c888(0x81)](_0x51996e[_0x30c888(0x164)]['id'],_0x30c888(0x1ab))[_0x30c888(0x11d)](_0x50712b=>{telegramError(_0x50712b);});if(!settings[_0x30c888(0xe9)])tgBot[_0x30c888(0x81)](_0x51996e[_0x30c888(0x164)]['id'],_0x30c888(0x1ac))['catch'](_0xbd8294=>{telegramError(_0xbd8294);});}),tgBot[_0x4e5f0b(0x1c3)](_0x4e5f0b(0xaf));}));}),tgBot['onText'](/\/toggle/,_0x2baf68=>{const _0xffbc8a=_0x10e9a4;if(!validateTelegram(_0x2baf68))return;tgBot[_0xffbc8a(0x1c3)]('callback_query');const _0x5aad24=getBotsWithMode();if(_0x5aad24[_0xffbc8a(0xec)]==0x0)tgBot[_0xffbc8a(0x81)](_0x2baf68[_0xffbc8a(0x164)]['id'],'No\x20bots\x20running\x20right\x20now')[_0xffbc8a(0x11d)](_0x35d6bc=>{telegramError(_0x35d6bc);});else{let _0x122de8=[],_0x223882=[];const _0x80295=0x2;let _0x3696ee=0x0;_0x5aad24['forEach']((_0xc7491f,_0x42820d)=>{const _0x4a74d0=_0xffbc8a;if(_0x42820d%_0x80295==0x0)_0x223882=[];_0x223882['push']({'text':_0x4a74d0(0x140)+_0xc7491f['botID']+'\x20('+_0xc7491f[_0x4a74d0(0x197)]+')','callback_data':_0xc7491f[_0x4a74d0(0xf9)]}),_0x42820d%_0x80295==0x0&&(_0x122de8[_0x3696ee]=_0x223882,_0x3696ee++);}),tgBot['sendMessage'](_0x2baf68['chat']['id'],_0xffbc8a(0x119),{'reply_markup':{'inline_keyboard':_0x122de8}})['catch'](_0x5ad304=>{telegramError(_0x5ad304);}),tgBot['on']('callback_query',async _0x1661ae=>{const _0x30fda5=_0xffbc8a,_0x41b9ba=_0x1661ae[_0x30fda5(0x166)],_0x24c0a0=_0x1661ae['message'];tgBot[_0x30fda5(0x195)](_0x1661ae['id'])[_0x30fda5(0x8b)](async()=>{const _0x419be0=_0x30fda5,_0x339d5e=_0x5aad24[_0x419be0(0x15c)](_0x462703=>_0x462703[_0x419be0(0xf9)]==_0x41b9ba),_0x275929=_0x339d5e[_0x419be0(0x197)]==_0x419be0(0x1ce)?_0x419be0(0x1a4):_0x419be0(0x1ce);tgBot[_0x419be0(0x81)](_0x24c0a0['chat']['id'],_0x419be0(0x97)+_0x41b9ba+_0x419be0(0x120)+_0x275929+_0x419be0(0x96))[_0x419be0(0x11d)](_0x720565=>{telegramError(_0x720565);}),toggleBotMode(_0x41b9ba);}),tgBot['removeListener'](_0x30fda5(0xaf));});}}),tgBot['onText'](/\/names/,_0x545312=>{const _0x49d9ad=_0x10e9a4;if(!validateTelegram(_0x545312))return;let _0x4b53f3='';config[_0x49d9ad(0xff)](_0x5163d3=>{const _0x55644f=_0x49d9ad;_0x4b53f3+='Bot\x20'+_0x5163d3[_0x55644f(0xf9)]+':\x20'+_0x5163d3['botname']+'\x0a';}),tgBot['sendMessage'](_0x545312['chat']['id'],_0x4b53f3,{'parse_mode':_0x49d9ad(0x9f)})[_0x49d9ad(0x11d)](_0x1e1839=>{telegramError(_0x1e1839);});}),tgBot['onText'](/\/disable/,_0x10252d=>{const _0x39c5b4=_0x10e9a4;if(!validateTelegram(_0x10252d))return;tgBot[_0x39c5b4(0x81)](_0x10252d[_0x39c5b4(0x164)]['id'],_0x39c5b4(0x7a))[_0x39c5b4(0x11d)](_0x272720=>{telegramError(_0x272720);}),updateSetting(_0x39c5b4(0xc8),![]);}),tgBot[_0x10e9a4(0x82)](/\/help/,_0xceb4c9=>{const _0x123505=_0x10e9a4;if(!validateTelegram(_0xceb4c9))return;tgBot[_0x123505(0x81)](_0xceb4c9[_0x123505(0x164)]['id'],_0x153bb1)[_0x123505(0x11d)](_0x5eb036=>{telegramError(_0x5eb036);});}),tgBot['on'](_0x10e9a4(0xa2),_0x48cf12=>{const _0x1eec76=_0x10e9a4;_0x48cf12[_0x1eec76(0x77)]()[_0x1eec76(0x8c)](_0x1eec76(0x141))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x1eec76(0xaa)](),tgBot=null,io['to']('botmanager')[_0x1eec76(0xda)]('notification','Invalid\x20Telegram\x20token'));}),process[_0x10e9a4(0x106)](_0x10e9a4(0x9c),()=>{const _0x59a88e=_0x10e9a4;if(tgBot)tgBot[_0x59a88e(0xaa)]();process[_0x59a88e(0xf4)](0x1);}),process[_0x10e9a4(0x106)](_0x10e9a4(0x7f),()=>{const _0x40d2dd=_0x10e9a4;if(tgBot)tgBot[_0x40d2dd(0xaa)]();process[_0x40d2dd(0xf4)](0x1);});}}function disableTelegram(){const _0x43d08f=_0x4f13af;tgBot&&(tgBot[_0x43d08f(0xaa)](),tgBot=null);}function sendTelegram(_0x2f9103,_0x296a86){const _0x4c6c72=_0x4f13af;if(settings[_0x4c6c72(0xc8)]){if(settings['telegramEvents']==_0x4c6c72(0xb6)||(_0x296a86[_0x4c6c72(0x1d9)]==_0x4c6c72(0x1b8)||_0x296a86[_0x4c6c72(0x1d9)]=='success')&&settings[_0x4c6c72(0xca)]==_0x4c6c72(0xc7)||_0x296a86[_0x4c6c72(0x1d9)]==_0x4c6c72(0x156)&&settings[_0x4c6c72(0xca)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x296a86[_0x4c6c72(0xba)])tgBot[_0x4c6c72(0x81)](settings[_0x4c6c72(0xe9)],_0x296a86['botname']+_0x4c6c72(0x1ad)+_0x296a86[_0x4c6c72(0x132)])['catch'](_0xa0f531=>{telegramError(_0xa0f531);});else tgBot[_0x4c6c72(0x81)](settings[_0x4c6c72(0xe9)],_0x4c6c72(0x140)+_0x2f9103+_0x4c6c72(0x1ad)+_0x296a86[_0x4c6c72(0x132)])[_0x4c6c72(0x11d)](_0x9c235d=>{telegramError(_0x9c235d);});}}}}async function sendTelegramMsg(_0xfaeb3f,_0x1873d6='HTML'){const _0x4012ab=_0x4f13af;return settings[_0x4012ab(0xc8)]&&tgBot&&settings[_0x4012ab(0xe9)]?(await tgBot['sendMessage'](settings['telegramChatId'],_0xfaeb3f,{'parse_mode':_0x1873d6})[_0x4012ab(0x11d)](_0x4559d3=>{telegramError(_0x4559d3);}),!![]):![];}function getDeviceWithIp(_0x12512c){const _0x11cebd=_0x4f13af;return devices[_0x11cebd(0x15c)](_0xb9ebdb=>_0xb9ebdb['ip']===_0x12512c);}function temporaryAccess2FA(_0xfe7b11,_0x2b6e98){const _0x2457f8=_0x4f13af;let _0x43ff72=new Date(),_0x2dd53c=![];if(lastIpApproval){if(_0x43ff72-lastIpApproval<0x1388)_0x2dd53c=!![];}lastIpApproval=new Date();if(_0x2dd53c)return;tgBot&&settings[_0x2457f8(0xe9)]&&(tgBot[_0x2457f8(0x1c3)](_0x2457f8(0xaf)),tgBot[_0x2457f8(0x81)](settings[_0x2457f8(0xe9)],_0x2457f8(0x16b)+normalizeIP(_0x2b6e98)[_0x2457f8(0x14b)]+_0x2457f8(0x187),{'parse_mode':_0x2457f8(0x9f),'reply_markup':{'inline_keyboard':[[{'text':_0x2457f8(0x199),'callback_data':'5'},{'text':_0x2457f8(0x131),'callback_data':'15'},{'text':_0x2457f8(0x12b),'callback_data':'30'},{'text':_0x2457f8(0xd7),'callback_data':_0x2457f8(0xd7)}]]}})[_0x2457f8(0x11d)](_0x4b7f2a=>{telegramError(_0x4b7f2a);}),tgBot['on'](_0x2457f8(0xaf),async _0x2274c0=>{const _0x285f67=_0x2457f8,_0x26e04a=_0x2274c0[_0x285f67(0x166)],_0x292888=_0x2274c0[_0x285f67(0x15a)];tgBot[_0x285f67(0x195)](_0x2274c0['id'])[_0x285f67(0x8b)](async()=>{const _0x40f073=_0x285f67;devices[_0xfe7b11][_0x40f073(0xd6)]={'clientip':_0x2b6e98,'timestamp':new Date()[_0x40f073(0x90)](),'expiry':_0x26e04a},_0x26e04a!=_0x40f073(0xd7)?(await tgBot[_0x40f073(0x81)](_0x292888[_0x40f073(0x164)]['id'],'Access\x20enabled\x20for\x20'+_0x26e04a+'\x20minutes',{'parse_mode':_0x40f073(0x9f)})[_0x40f073(0x11d)](_0x4ec13e=>{telegramError(_0x4ec13e);}),io['to'](_0xfe7b11)[_0x40f073(0xda)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x40f073(0x81)](_0x292888['chat']['id'],_0x40f073(0x18e))[_0x40f073(0x11d)](_0x406ac4=>{telegramError(_0x406ac4);}),io['to'](_0xfe7b11)[_0x40f073(0xda)]('status',{'access':{'allow':![],'reason':_0x40f073(0x19a),'token':null}}));}),tgBot['removeListener'](_0x285f67(0xaf));}));}function loginAccess2FA(_0x48d519,_0x5c3529){const _0x1ebbe4=_0x4f13af;tgBot&&settings[_0x1ebbe4(0xe9)]&&(tgBot[_0x1ebbe4(0x1c3)](_0x1ebbe4(0xaf)),tgBot[_0x1ebbe4(0x81)](settings[_0x1ebbe4(0xe9)],_0x1ebbe4(0x14f)+normalizeIP(_0x5c3529)[_0x1ebbe4(0x14b)]+_0x1ebbe4(0x187),{'parse_mode':_0x1ebbe4(0x9f),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x1ebbe4(0xd7)}]]}})[_0x1ebbe4(0x11d)](_0x333725=>{telegramError(_0x333725);}),tgBot['on'](_0x1ebbe4(0xaf),async _0x50fc99=>{const _0x476ebc=_0x1ebbe4,_0x1175cc=_0x50fc99['data'],_0x1a21e9=_0x50fc99[_0x476ebc(0x15a)];tgBot[_0x476ebc(0x195)](_0x50fc99['id'])['then'](async()=>{const _0x129806=_0x476ebc;devices[_0x48d519]['telegram2FaApproval']={'clientip':_0x5c3529,'timestamp':new Date()[_0x129806(0x90)](),'expiry':_0x1175cc},_0x1175cc!='reject'?(await tgBot[_0x129806(0x81)](_0x1a21e9['chat']['id'],_0x129806(0x1ae),{'parse_mode':_0x129806(0x9f)})[_0x129806(0x11d)](_0x2adb7b=>{telegramError(_0x2adb7b);}),io['to'](_0x48d519)[_0x129806(0xda)](_0x129806(0x192),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x1a21e9[_0x129806(0x164)]['id'],'Login\x20rejected')['catch'](_0x342131=>{telegramError(_0x342131);}),io['to'](_0x48d519)[_0x129806(0xda)]('status',{'access':{'allow':![],'reason':_0x129806(0x8a),'token':null}}));}),tgBot[_0x476ebc(0x1c3)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x31dacf=_0x4f13af;return dbConfig[_0x31dacf(0x179)](_0x31dacf(0xa1))[_0x31dacf(0xed)](_0x31dacf(0xf9))[_0x31dacf(0x18f)]({'status':_0x31dacf(0x142)})[_0x31dacf(0xbd)]()||[];}function getDisabledBots(){const _0x58a234=_0x4f13af;return dbConfig[_0x58a234(0x179)](_0x58a234(0xa1))['sortBy']('botID')['filter']({'status':_0x58a234(0xa6)})['value']()||[];}function getBotsWithMode(){const _0xc55898=_0x4f13af,_0x487a6a=dbConfig['get'](_0xc55898(0xa1))[_0xc55898(0xed)](_0xc55898(0xf9))['value']()||[];return _0x487a6a[_0xc55898(0xff)](_0x359bed=>{const _0x3d0402=_0xc55898,_0x1b7d3f=configpath+'bot-'+_0x359bed[_0x3d0402(0xf9)]+_0x3d0402(0x174),_0x416c5c=fs['existsSync'](_0x1b7d3f);if(_0x416c5c){const _0x41e226=fs[_0x3d0402(0xbe)](_0x1b7d3f);try{const _0x406502=JSON[_0x3d0402(0x9a)](_0x41e226),_0x431843=_0x406502?_0x406502[_0x3d0402(0x118)][0x0][_0x3d0402(0x89)]:![];_0x359bed[_0x3d0402(0x197)]=_0x431843?'auto':_0x3d0402(0x1a4);}catch(_0x296804){_0x359bed[_0x3d0402(0x197)]=_0x3d0402(0x1a4);}}else _0x359bed[_0x3d0402(0x197)]=_0x3d0402(0x1a4);}),_0x487a6a;}async function initUser(){const _0x52315=_0x4f13af;if(!settings[_0x52315(0x1b0)]){const _0x43f7c6=uuidRandom();mixpanel[_0x52315(0x150)](_0x43f7c6),updateSetting(_0x52315(0x1b0),_0x43f7c6);}}async function initSecure(){const _0x29ed6b=_0x4f13af;let _0x80ba86=getSecure();if(!_0x80ba86[_0x29ed6b(0x1bf)](_0x29ed6b(0x1a9))){let _0x83547a=await generateKeys();_0x80ba86[_0x29ed6b(0x7c)]=_0x83547a[_0x29ed6b(0x7c)],_0x80ba86[_0x29ed6b(0x1c7)]=_0x83547a['privateKey'],_0x80ba86[_0x29ed6b(0x1a9)]=crypto[_0x29ed6b(0x74)](0x20)['toString'](_0x29ed6b(0x100));;storeSecure(_0x80ba86);}}function getSettings(){const _0x2c8551=_0x4f13af;return dbSettings[_0x2c8551(0x179)]('settings')[_0x2c8551(0xbd)]()||{};}function getSecure(){const _0x222763=_0x4f13af;return dbSecure[_0x222763(0x179)]('secure')[_0x222763(0xbd)]()||{};}function getBlacklist(){const _0x2d8f78=_0x4f13af;return dbSecure['get'](_0x2d8f78(0x1b7))[_0x2d8f78(0xbd)]()||[];}function broadcastToBots(_0x1254a3,_0x4693be){config['forEach'](_0x1b8b78=>{const _0x48c6c4=_0x81ec;if(_0x1b8b78['status']=='enabled'&&_0x1b8b78[_0x48c6c4(0x104)]==_0x48c6c4(0xc4)){if(pid[_0x1b8b78[_0x48c6c4(0xf9)]])pid[_0x1b8b78[_0x48c6c4(0xf9)]]['send']({[_0x1254a3]:_0x4693be});}});}function storeSettings(_0x2da144,_0x23cff3=![]){const _0x576826=_0x4f13af;_0x2da144={...settings,..._0x2da144};if(_0x23cff3&&_0x2da144['bbPassword']!=_0x576826(0x71)&&_0x2da144[_0x576826(0xd3)]!=''){const _0x433d24=crypt['decrypt'](secure[_0x576826(0x1c7)],_0x2da144[_0x576826(0xd3)])['message'][_0x576826(0x84)]('@')[0x0],_0x5aac34=bcrypt[_0x576826(0xe8)](_0x433d24,saltRounds);_0x2da144={..._0x2da144,'bbPassword':_0x5aac34};}if(_0x23cff3&&_0x2da144[_0x576826(0xdd)]!=_0x576826(0x71)&&_0x2da144[_0x576826(0xdd)]!=''){const _0x36551d=crypt['decrypt'](secure['privateKey'],_0x2da144[_0x576826(0xdd)])[_0x576826(0x15a)][_0x576826(0x84)]('@')[0x0];_0x2da144={..._0x2da144,'telegramToken':_0x36551d};}const _0x1f5fe0=_0x2da144[_0x576826(0xdd)]!=_0x576826(0x71)&&_0x2da144[_0x576826(0xdd)]!=settings[_0x576826(0xdd)]||_0x2da144[_0x576826(0x86)]!=settings[_0x576826(0x86)],_0x570343=_0x2da144[_0x576826(0xdd)]==''||_0x2da144[_0x576826(0x86)]=='';if(_0x1f5fe0)_0x2da144[_0x576826(0xca)]=_0x576826(0xb6);for(const [_0x419e7f,_0x58db1e]of Object[_0x576826(0x1b6)](_0x2da144)){if(_0x419e7f=='telegramToken'&&_0x58db1e=='************'){_0x2da144[_0x576826(0xdd)]=settings[_0x576826(0xdd)];continue;};if(_0x419e7f=='bbPassword'&&_0x58db1e==_0x576826(0x71)){_0x2da144['bbPassword']=settings[_0x576826(0xd3)];continue;};dbSettings['set'](_0x576826(0xa5)+_0x419e7f,_0x58db1e)[_0x576826(0x189)]();}settings=_0x2da144,io['to']('botmanager')[_0x576826(0xda)]('settings',cleanSettings()),broadcastToBots(_0x576826(0x1af),settings['timeshift']);if(_0x1f5fe0&&!_0x570343)initTelegram();if(_0x1f5fe0&&_0x570343)disableTelegram();getAllClients()[_0x576826(0xff)](_0x3b49ef=>{const _0x47e69d=_0x576826;getSocket(_0x3b49ef['id'])[_0x47e69d(0xda)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0xd2c59,_0x5e27f3){const _0x46a4e3=_0x4f13af;dbSettings[_0x46a4e3(0x183)](_0x46a4e3(0xa5)+_0xd2c59,_0x5e27f3)[_0x46a4e3(0x189)](),settings=getSettings(),io['to'](_0x46a4e3(0xc1))['emit'](_0x46a4e3(0x194),cleanSettings());}function storeSecure(_0x11f442){const _0x3723f4=_0x4f13af;dbSecure[_0x3723f4(0x179)](_0x3723f4(0x14e))[_0x3723f4(0x1a6)](_0x11f442)[_0x3723f4(0x189)](),secure=_0x11f442;}function addBlacklist(_0x36e132){const _0x52b4eb=_0x4f13af;cleanBlacklist();let _0x35598f;devices[_0x36e132][_0x52b4eb(0xd6)]?_0x35598f=Math['max'](devices[_0x36e132][_0x52b4eb(0xd6)][_0x52b4eb(0xd0)],loginExpiry):_0x35598f=loginExpiry,dbSecure[_0x52b4eb(0x179)](_0x52b4eb(0x1b7))[_0x52b4eb(0x1a6)]({'expiry':new Date()[_0x52b4eb(0x90)]()+_0x35598f*0x3c*0x3e8,'token':devices[_0x36e132]['access'][_0x52b4eb(0x14a)]})[_0x52b4eb(0x189)](),blacklist=dbSecure[_0x52b4eb(0x179)](_0x52b4eb(0x1b7))[_0x52b4eb(0xbd)]();}function cleanBlacklist(){const _0x1c8b66=_0x4f13af;let _0x96da91=dbSecure['get']('blacklist')['cloneDeep']()[_0x1c8b66(0xbd)](),_0x292946=new Date()[_0x1c8b66(0x90)]();_0x96da91[_0x1c8b66(0xff)](_0x307b2f=>{const _0x5adf96=_0x1c8b66;_0x307b2f[_0x5adf96(0xd0)]<_0x292946&&dbSecure[_0x5adf96(0x179)](_0x5adf96(0x1b7))[_0x5adf96(0x145)]({'expiry':_0x307b2f[_0x5adf96(0xd0)]})[_0x5adf96(0x189)]();});}function initStates(){const _0x3f5eae=_0x4f13af;let _0x3aa388=getConfiguration();_0x3aa388[_0x3f5eae(0xff)](_0x4d81b2=>{_0x4d81b2['live']='stopped';}),storeConfiguration(_0x3aa388);}function onKeys(){const _0x1a3d7d=new RSA();return new Promise(_0x3cb8c8=>{const _0x12f29e=_0x81ec;_0x1a3d7d[_0x12f29e(0x172)]()['then'](_0x17a151=>{_0x3cb8c8(_0x17a151);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x10ce74=_0x4f13af;let _0xac76d2=getSettings(),_0x101ea6=![];!_0xac76d2[_0x10ce74(0x1bf)](_0x10ce74(0xc0))&&(_0xac76d2['lastmsgtelegram']=0x0,_0x101ea6=!![]);!_0xac76d2[_0x10ce74(0x1bf)](_0x10ce74(0x181))&&(_0xac76d2[_0x10ce74(0x181)]=0x0,_0x101ea6=!![]);!_0xac76d2[_0x10ce74(0x1bf)](_0x10ce74(0x178))&&(_0xac76d2[_0x10ce74(0x178)]='0.0.0',_0x101ea6=!![]);if(_0x101ea6)storeSettings(_0xac76d2);}function storeConfiguration(_0x2e848b){const _0x10bc3b=_0x4f13af;dbConfig[_0x10bc3b(0x179)]('bots')[_0x10bc3b(0x145)]()[_0x10bc3b(0x189)](),_0x2e848b[_0x10bc3b(0xff)](_0x5d0ff8=>{const _0x29f731=_0x10bc3b;delete _0x5d0ff8[_0x29f731(0x197)];}),dbConfig[_0x10bc3b(0x179)](_0x10bc3b(0xa1))['push'](..._0x2e848b)[_0x10bc3b(0x189)](),config=_0x2e848b;}function resetPassword(){const _0x5ddfaa=_0x4f13af;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x5ddfaa(0xaf)),tgBot[_0x5ddfaa(0x81)](settings[_0x5ddfaa(0xe9)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x5ddfaa(0x9f),'reply_markup':{'inline_keyboard':[[{'text':_0x5ddfaa(0x180),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x5ddfaa(0x11d)](_0x3786fa=>{telegramError(_0x3786fa);}),tgBot['on'](_0x5ddfaa(0xaf),async _0x1ead14=>{const _0x468c8a=_0x5ddfaa,_0xb905=_0x1ead14[_0x468c8a(0x166)],_0x18d53e=_0x1ead14[_0x468c8a(0x15a)];tgBot['answerCallbackQuery'](_0x1ead14['id'])[_0x468c8a(0x8b)](async()=>{const _0x41edde=_0x468c8a;if(_0xb905!='no'){const _0x8eb346=0xf,_0x23f6ad=_0x41edde(0x169),_0x9a629d=Array['from'](crypto[_0x41edde(0x1bc)](new Uint32Array(_0x8eb346)))[_0x41edde(0xe7)](_0x2f1020=>_0x23f6ad[_0x2f1020%_0x23f6ad[_0x41edde(0xec)]])['join'](''),_0x2f2f91=bcrypt[_0x41edde(0xe8)](_0x9a629d,saltRounds);storeSettings({'bbPassword':_0x2f2f91}),await tgBot[_0x41edde(0x81)](_0x18d53e[_0x41edde(0x164)]['id'],_0x41edde(0x1d5)+_0x9a629d,{'parse_mode':'HTML'})[_0x41edde(0x11d)](_0x58876e=>{telegramError(_0x58876e);});}else await tgBot[_0x41edde(0x81)](_0x18d53e['chat']['id'],_0x41edde(0x9e))[_0x41edde(0x11d)](_0x38fba7=>{telegramError(_0x38fba7);});}),tgBot[_0x468c8a(0x1c3)](_0x468c8a(0xaf));}));}function logging(_0x453f66){const _0x37f596=_0x4f13af;console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x453f66);if(tgBot&&settings['telegramChatId']&&settings[_0x37f596(0xca)]!='orders')tgBot[_0x37f596(0x81)](settings['telegramChatId'],_0x37f596(0x170)+_0x453f66)['catch'](_0x230760=>{telegramError(_0x230760);});}function getServerTime(){const _0x1156a4=_0x4f13af,_0x2972ff=new Date();return _0x2972ff['getFullYear']()+'/'+(_0x2972ff[_0x1156a4(0x113)]()+0x1)[_0x1156a4(0x77)]()[_0x1156a4(0xe4)](0x2,'0')+'/'+_0x2972ff['getDate']()[_0x1156a4(0x77)]()[_0x1156a4(0xe4)](0x2,'0')+'\x20'+_0x2972ff[_0x1156a4(0xf8)]()[_0x1156a4(0x77)]()['padStart'](0x2,'0')+':'+_0x2972ff[_0x1156a4(0x127)]()[_0x1156a4(0x77)]()[_0x1156a4(0xe4)](0x2,'0')+':'+_0x2972ff['getSeconds']()['toString']()[_0x1156a4(0xe4)](0x2,'0');}function getTimeStamp(){const _0x50b654=_0x4f13af,_0x1e4c1f=shiftedTime();return _0x1e4c1f[_0x50b654(0xa0)]()+'/'+(_0x1e4c1f[_0x50b654(0x113)]()+0x1)[_0x50b654(0x77)]()[_0x50b654(0xe4)](0x2,'0')+'/'+_0x1e4c1f[_0x50b654(0xc6)]()[_0x50b654(0x77)]()['padStart'](0x2,'0')+'\x20'+_0x1e4c1f[_0x50b654(0xf8)]()[_0x50b654(0x77)]()[_0x50b654(0xe4)](0x2,'0')+':'+_0x1e4c1f[_0x50b654(0x127)]()[_0x50b654(0x77)]()['padStart'](0x2,'0')+':'+_0x1e4c1f[_0x50b654(0x1b2)]()[_0x50b654(0x77)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x37fbfa=_0x4f13af,_0x3df814=new Date();let _0x83b26=_0x3df814;if(settings[_0x37fbfa(0x1af)]&&settings[_0x37fbfa(0x1af)]!==0x0)_0x83b26=fns['add'](_0x3df814,{'hours':settings['timeshift']});return _0x83b26;}function startScheduler(){let _0x4f7a25=new Date()['getUTCHours']();_0x4f7a25==0x1&&backupConfigFiles();_0x4f7a25==0x9&&triggerAnalytics();_0x4f7a25%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x385af5=_0x4f13af;fs[_0x385af5(0x1d4)](configpath,{'withFileTypes':!![]})['forEach'](_0x4e66b7=>{const _0x48a6d7=_0x385af5;if(!_0x4e66b7[_0x48a6d7(0x13e)]())fs[_0x48a6d7(0xb0)](configpath+_0x4e66b7[_0x48a6d7(0x7d)],configbackuppath+_0x4e66b7[_0x48a6d7(0x7d)]);});}async function getPublicIp(){const _0x2be598=_0x4f13af;try{const _0x1650e5=await axios[_0x2be598(0x179)]('https://api.ipify.org?format=json');publicip=_0x1650e5[_0x2be598(0x166)]['ip'];}catch(_0xc0f155){}}async function triggerAnalytics(_0x116467=![]){const _0x5dd50c=_0x4f13af;if(!publicip)await getPublicIp();const _0x461ffc=getBotsWithMode();let _0x42d068=0x0;_0x461ffc['forEach'](_0x5d1f7a=>{const _0x3fd57f=_0x81ec;if(_0x5d1f7a[_0x3fd57f(0x192)]==='enabled')_0x42d068++;}),mixpanel[_0x5dd50c(0x154)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x461ffc[_0x5dd50c(0xec)],'numbotsenabled':_0x42d068}),!_0x116467&&analytics[_0x5dd50c(0xc5)]({'title':_0x5dd50c(0x185),'href':_0x5dd50c(0x152),'path':'/v'+serverversion});}async function getMessages(){const _0x57b7ae=_0x4f13af,_0x19ab8f=_0x57b7ae(0xd1),_0x306bfd=new GraphQLClient(_0x19ab8f),_0x3c8fe8={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x4beda1=serverversion[_0x57b7ae(0x84)]('.'),_0x13de48=_0x4beda1[0x0]+'.'+_0x4beda1[0x1],_0x2b4eb8=Math[_0x57b7ae(0x1cb)](settings[_0x57b7ae(0xc0)],settings['lastmsgemitted']),_0x4bc23a={'last':parseInt(_0x2b4eb8),'bbm':_0x13de48},_0x1f4e1a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x82ff8c;try{_0x82ff8c=await _0x306bfd[_0x57b7ae(0xa7)](_0x1f4e1a,_0x4bc23a,_0x3c8fe8);}catch(_0x100a5f){}if(_0x82ff8c&&_0x82ff8c[_0x57b7ae(0x11e)]){let _0x445f6b=settings[_0x57b7ae(0xc0)];newMessages=[];for(const _0x58aaf3 of _0x82ff8c[_0x57b7ae(0x11e)]){newMessages[_0x57b7ae(0x1a6)](_0x58aaf3);if(_0x58aaf3['bbvNew'])updateSetting('latestversion',_0x58aaf3[_0x57b7ae(0x143)]);let _0x3502df=_0x58aaf3[_0x57b7ae(0x143)]?serverversion>=_0x58aaf3[_0x57b7ae(0x143)]:![];if(!_0x3502df&&_0x58aaf3[_0x57b7ae(0x159)]>_0x445f6b){if(_0x58aaf3[_0x57b7ae(0x83)]===_0x57b7ae(0xd2)||serverversion[_0x57b7ae(0x19e)](_0x58aaf3[_0x57b7ae(0x83)])){let _0x5eb0d8=''+_0x58aaf3[_0x57b7ae(0xcf)]+'\x0a\x0a'+_0x58aaf3['message'];const _0x43d0cf=await sendTelegramMsg(toTelegramMarkdown(_0x5eb0d8),'Markdown');if(_0x43d0cf)_0x445f6b=_0x58aaf3[_0x57b7ae(0x159)];}}}updateAvailable=isNewerVersion(settings[_0x57b7ae(0x178)],serverversion),updateSetting(_0x57b7ae(0xc0),_0x445f6b),emitMessages();}}function emitMessages(){const _0x34a0f7=_0x4f13af,_0x1795ce=settings[_0x34a0f7(0x181)];let _0x4afbb7=[];newMessages['forEach'](_0x36c56a=>{const _0x2dd010=_0x34a0f7;_0x36c56a[_0x2dd010(0x159)]>_0x1795ce&&_0x4afbb7[_0x2dd010(0x1a6)](_0x36c56a);}),_0x4afbb7['length']>0x0&&getAllClients()[_0x34a0f7(0xff)](_0x54f6e7=>{const _0xa7884f=_0x34a0f7;getSocket(_0x54f6e7['id'])[_0xa7884f(0xda)](_0xa7884f(0x15a),_0x4afbb7);});}function confirmMessage(_0x2a99c2){const _0x2ebc2e=_0x4f13af;updateSetting(_0x2ebc2e(0x181),Number(_0x2a99c2));}function isNewerVersion(_0x533caf,_0xb584c0){const _0x2b54c4=_0x4f13af,_0x20de96=_0xb584c0['split']('.'),_0x3230cf=_0x533caf[_0x2b54c4(0x84)]('.');for(var _0x254c5a=0x0;_0x254c5a<_0x3230cf[_0x2b54c4(0xec)];_0x254c5a++){const _0x8d8de6=~~_0x3230cf[_0x254c5a],_0x3db531=~~_0x20de96[_0x254c5a];if(_0x8d8de6>_0x3db531)return!![];if(_0x8d8de6<_0x3db531)return![];}return![];}function toTelegramMarkdown(_0x4dc61e){const _0x3c7ac3=_0x4f13af,_0x2ab7e0=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xab02dd=/\*{2}(.+?)\*{2}/gim;return _0x4dc61e=_0x4dc61e[_0x3c7ac3(0x13d)](_0x2ab7e0,_0x3c7ac3(0x161))[_0x3c7ac3(0x13d)](_0xab02dd,'*$1*'),_0x4dc61e;}function validateCredentials(_0x4b2145,_0x33eb18){const _0x8d3aaa=_0x4f13af;if(_0x4b2145['username']==settings[_0x8d3aaa(0x16c)]&&bcrypt[_0x8d3aaa(0xc3)](_0x4b2145[_0x8d3aaa(0x10a)],settings['bbPassword'])){if(settings[_0x8d3aaa(0x108)])return{'allow':![],'reason':_0x8d3aaa(0x11b),'token':null};else{const _0x3af234=generateLoginToken(_0x33eb18);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3af234};}}else return{'allow':![],'reason':_0x8d3aaa(0x133),'token':null};}function refreshToken(_0x13d0b3){const _0x67ecbb=_0x4f13af,_0x2c60d4=generateLoginToken(_0x13d0b3);return{'allow':!![],'reason':_0x67ecbb(0x8d),'token':_0x2c60d4};}function validateAccess(_0x27a282,_0x2daa25){const _0x20a700=_0x4f13af;let _0xd537db=devices[_0x2daa25]['ip'],_0x1e94c0;const _0x30881a=_0x409a88=>{const _0x562e8a=_0x81ec;if(settings[_0x562e8a(0x13a)]){if(settings[_0x562e8a(0x108)]){if(telegram2FaApproved(_0x2daa25)){const _0x2c60cf=generateLoginToken(_0x2daa25);return{'allow':!![],'reason':_0x562e8a(0x1b1),'token':_0x2c60cf};}else return{'allow':![],'reason':_0x562e8a(0x11a),'token':null};}else return _0x1e94c0=validToken(_0x409a88,_0x2daa25),_0x1e94c0[_0x562e8a(0x1bf)](_0x562e8a(0xa3))?{'allow':!![],'reason':_0x562e8a(0xdb),'token':_0x409a88}:{'allow':![],'reason':_0x562e8a(0x11a),'token':null};}else return{'allow':!![],'reason':_0x562e8a(0x9d),'token':null};};if(settings['whitelistEnabled']){let _0x4b59db=[...settings[_0x20a700(0xa9)],_0x20a700(0x130),_0x20a700(0x11f),_0x20a700(0x1be)];if(_0x4b59db[_0x20a700(0x8c)](_0xd537db))return _0x30881a(_0x27a282);else{_0x1e94c0=validToken(_0x27a282,_0x2daa25);if(_0x1e94c0[_0x20a700(0x1bf)](_0x20a700(0xa3)))return _0x30881a(_0x27a282);else{if(telegramIpApproved(_0x2daa25)){const _0x56447c=generateToken(_0x2daa25);return _0x1e94c0=_0x30881a(_0x27a282),_0x1e94c0[_0x20a700(0x1cd)]?{'allow':!![],'reason':_0x20a700(0x116),'token':_0x56447c}:_0x1e94c0;}else return settings[_0x20a700(0x121)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x20a700(0x94),'token':null};}}}else return _0x30881a(_0x27a282);}function timelyDecrypt(_0x2726fa,_0x3d5606=!![]){const _0x3baa19=_0x4f13af;if(_0x2726fa)try{const _0x4805fe=crypt[_0x3baa19(0x112)](secure[_0x3baa19(0x1c7)],_0x2726fa)[_0x3baa19(0x15a)],_0x2c004a=_0x4805fe[_0x3baa19(0x84)]('@')[0x0],_0xf9e548=_0x4805fe['split']('@')[0x1],_0x35942e=new Date()[_0x3baa19(0x90)]();if(_0x3d5606){if(_0x35942e-_0xf9e548<maxSecretAge*0x3e8)return _0x2c004a;else return![];}else return _0x2c004a;}catch(_0x4f3a25){return![];}else return![];}const validToken=(_0x554367,_0x14ac0a)=>{const _0x3bb092=_0x4f13af,_0x272544=devices[_0x14ac0a]['ip'];if(!_0x554367)return{'error':'No\x20authentication\x20token'};for(let _0x4d7344 of blacklist){if(_0x4d7344[_0x3bb092(0x14a)]==_0x554367)return{'error':_0x3bb092(0x1cf)};}let _0x32a9d2;try{_0x32a9d2=jwt[_0x3bb092(0x15d)](_0x554367,secure['secret']+_0x14ac0a);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x32a9d2[_0x3bb092(0x1bf)](_0x3bb092(0xfe))&&!_0x32a9d2[_0x3bb092(0x1bf)](_0x3bb092(0x126))||!_0x32a9d2[_0x3bb092(0x1bf)](_0x3bb092(0x91)))return{'error':_0x3bb092(0x107)};if(!_0x32a9d2['hasOwnProperty'](_0x3bb092(0x126))&&_0x32a9d2[_0x3bb092(0x1bf)](_0x3bb092(0xfe))){const {clientip:_0xf22c07}=_0x32a9d2;return _0x272544==_0xf22c07?{'success':_0x3bb092(0x73)}:{'error':_0x3bb092(0x18c)};}else{if(_0x32a9d2[_0x3bb092(0x1bf)](_0x3bb092(0x126))&&_0x32a9d2[_0x3bb092(0x1bf)]('clientip')){const {username:_0x472937,clientip:_0x50a95a}=_0x32a9d2;return settings[_0x3bb092(0x16c)]==_0x472937&&_0x272544==_0x50a95a?{'success':_0x3bb092(0x73)}:{'error':_0x3bb092(0xbf)};}}},generateLoginToken=_0x1d173e=>{const _0x5dee0f=_0x4f13af;if(_0x1d173e){const _0x2ede86=devices[_0x1d173e]['ip'];return jwt[_0x5dee0f(0xe0)]({'username':settings[_0x5dee0f(0x16c)],'clientip':_0x2ede86},secure[_0x5dee0f(0x1a9)]+_0x1d173e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x39838c=>{const _0x18622c=_0x4f13af;if(_0x39838c){const _0x3dfdd2=devices[_0x39838c]['ip'];return jwt[_0x18622c(0xe0)]({'clientip':_0x3dfdd2},secure[_0x18622c(0x1a9)]+_0x39838c,{'expiresIn':devices[_0x39838c][_0x18622c(0xd6)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x2e79bb=>{const _0x3ece0b=_0x4f13af;let _0x255007=![];return devices[_0x2e79bb][_0x3ece0b(0xd6)]&&devices[_0x2e79bb]['telegramIpApproval']['expiry']!='reject'&&(_0x255007=devices[_0x2e79bb][_0x3ece0b(0xd6)][_0x3ece0b(0xfe)]==devices[_0x2e79bb]['ip']&&new Date()[_0x3ece0b(0x90)]()-devices[_0x2e79bb][_0x3ece0b(0xd6)][_0x3ece0b(0xdc)]<devices[_0x2e79bb]['telegramIpApproval'][_0x3ece0b(0xd0)]*0x3c*0x3e8),_0x255007;},telegram2FaApproved=_0x493187=>{const _0x2e02a7=_0x4f13af;let _0x3a52fd=![];return devices[_0x493187][_0x2e02a7(0xde)]&&devices[_0x493187][_0x2e02a7(0xde)][_0x2e02a7(0xd0)]!='reject'&&(_0x3a52fd=devices[_0x493187][_0x2e02a7(0xde)][_0x2e02a7(0xfe)]==devices[_0x493187]['ip']&&new Date()['getTime']()-devices[_0x493187][_0x2e02a7(0xde)]['timestamp']<devices[_0x493187]['telegram2FaApproval'][_0x2e02a7(0xd0)]*0x3c*0x3e8),_0x3a52fd;},normalizeIP=_0x6639ca=>{const _0x93b582=_0x4f13af;let _0x4a433a=null,_0x58e033=null;if(ipaddr['isValid'](_0x6639ca)){const _0x18fc9c=ipaddr[_0x93b582(0x9a)](_0x6639ca);_0x18fc9c[_0x93b582(0x10d)]()===_0x93b582(0x117)?(_0x18fc9c[_0x93b582(0xa8)]()&&(_0x4a433a=_0x18fc9c[_0x93b582(0xb3)]()[_0x93b582(0x77)]()),_0x58e033=_0x18fc9c[_0x93b582(0x77)]()):(_0x4a433a=_0x18fc9c[_0x93b582(0x77)](),_0x58e033=_0x18fc9c['toIPv4MappedAddress']()[_0x93b582(0x77)]());}return{'show':_0x4a433a?_0x4a433a:_0x58e033,'store':_0x58e033};};function sleep(_0x5377c5){return new Promise(_0x5cfdfa=>setTimeout(_0x5cfdfa,_0x5377c5));}