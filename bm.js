const _0x5c7b80=_0x2dc7;(function(_0x54b58e,_0x2d9d6f){const _0x2c8b21=_0x2dc7,_0x4c6481=_0x54b58e();while(!![]){try{const _0x49954e=parseInt(_0x2c8b21(0x379))/0x1+-parseInt(_0x2c8b21(0x33a))/0x2+parseInt(_0x2c8b21(0x30e))/0x3+-parseInt(_0x2c8b21(0x390))/0x4+-parseInt(_0x2c8b21(0x312))/0x5*(-parseInt(_0x2c8b21(0x236))/0x6)+-parseInt(_0x2c8b21(0x349))/0x7*(-parseInt(_0x2c8b21(0x27b))/0x8)+-parseInt(_0x2c8b21(0x2cd))/0x9*(parseInt(_0x2c8b21(0x28f))/0xa);if(_0x49954e===_0x2d9d6f)break;else _0x4c6481['push'](_0x4c6481['shift']());}catch(_0x429b4b){_0x4c6481['push'](_0x4c6481['shift']());}}}(_0x21b9,0xec050));const _0x9cccfc=function(){let _0xbaa6c1=!![];return function(_0xd01dce,_0x449aae){const _0x40439c=_0xbaa6c1?function(){if(_0x449aae){const _0x46b437=_0x449aae['apply'](_0xd01dce,arguments);return _0x449aae=null,_0x46b437;}}:function(){};return _0xbaa6c1=![],_0x40439c;};}(),_0x14f986=_0x9cccfc(this,function(){const _0x263f6b=_0x2dc7;return _0x14f986[_0x263f6b(0x371)]()['search'](_0x263f6b(0x37a))[_0x263f6b(0x371)]()[_0x263f6b(0x216)](_0x14f986)[_0x263f6b(0x234)]('(((.+)+)+)+$');});_0x14f986();'use strict';process[_0x5c7b80(0x25c)][_0x5c7b80(0x395)]=0x1;const childProcess=require(_0x5c7b80(0x20d)),fs=require('fs'),fns=require(_0x5c7b80(0x380)),low=require('lowdb'),FileSync=require(_0x5c7b80(0x332)),path=require(_0x5c7b80(0x1f4)),crypto=require(_0x5c7b80(0x2ae)),Crypt=require(_0x5c7b80(0x23b))[_0x5c7b80(0x298)],RSA=require(_0x5c7b80(0x23b))[_0x5c7b80(0x2ec)],bcrypt=require(_0x5c7b80(0x2c4)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x5c7b80(0x2c0))(process['argv'][_0x5c7b80(0x1fb)](0x2))[_0x5c7b80(0x36a)],uuidRandom=require(_0x5c7b80(0x30c)),TelegramBot=require(_0x5c7b80(0x31a)),Mixpanel=require(_0x5c7b80(0x25b)),axios=require(_0x5c7b80(0x351)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x5c7b80(0x2fa)),fileUpload=require(_0x5c7b80(0x3b4)),{networkInterfaces}=require('os'),PORT=argv[_0x5c7b80(0x246)]||_0x5c7b80(0x3b0),pattern=/^[0-9]{2,4}$/;!pattern[_0x5c7b80(0x392)](PORT)&&(console['log'](_0x5c7b80(0x34e)+PORT+_0x5c7b80(0x2b0)),process['exit'](0x1));const HOST=argv[_0x5c7b80(0x273)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x5c7b80(0x223)][_0x5c7b80(0x2b1)],environment=require(_0x5c7b80(0x2b7))[_0x5c7b80(0x29b)]||_0x5c7b80(0x38f);let bbpath=_0x5c7b80(0x366),bbpath2='';const botfile=_0x5c7b80(0x252),configfile=_0x5c7b80(0x233),settingsfile=_0x5c7b80(0x3ca),securefile=_0x5c7b80(0x230),maxBackups=0xa;let validInstallation=!![];!fs[_0x5c7b80(0x3b7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5c7b80(0x27f)),configpath=userID?bbpath+_0x5c7b80(0x376)+userID+'/':bbpath+_0x5c7b80(0x376),configbackuppath=configpath+_0x5c7b80(0x37c),logspath=userID?bbpath+_0x5c7b80(0x36b)+userID+'/':bbpath+_0x5c7b80(0x36b),zippath=userID?bbpath+_0x5c7b80(0x285)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x5c7b80(0x20c)](logspath+_0x5c7b80(0x211),{'flags':'a'}),temppath=userID?bbpath+_0x5c7b80(0x326)+userID+'/':bbpath+_0x5c7b80(0x326);!fs[_0x5c7b80(0x3b7)](configpath)&&fs[_0x5c7b80(0x300)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x5c7b80(0x300)](configbackuppath);!fs[_0x5c7b80(0x3b7)](logspath)&&fs[_0x5c7b80(0x300)](logspath);!fs['existsSync'](zippath)&&fs[_0x5c7b80(0x300)](zippath);!fs[_0x5c7b80(0x3b7)](temppath)&&fs[_0x5c7b80(0x300)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5c7b80(0x3bd)]({'bots':[]})[_0x5c7b80(0x2f8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5c7b80(0x3bd)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x5c7b80(0x2f8)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5c7b80(0x3bd)]({'secure':{},'blacklist':[]})[_0x5c7b80(0x2f8)]();let crypt=new Crypt({'md':_0x5c7b80(0x2e5),'rsaStandard':_0x5c7b80(0x314)});const saltRounds=0xa,mixpanel=Mixpanel[_0x5c7b80(0x247)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x5c7b80(0x2fd)]&&settings[_0x5c7b80(0x2fd)]!=''&&settings[_0x5c7b80(0x25f)]&&settings[_0x5c7b80(0x25f)]!='')initTelegram();const parseColor=(_0x333990,_0x118890)=>{const _0x5cd8aa=_0x5c7b80,_0x202549=/#[A-Z]{3}#/g;if(typeof _0x333990==_0x5cd8aa(0x3b1)){!_0x118890?_0x333990=_0x333990[_0x5cd8aa(0x2df)](_0x202549,''):(_0x333990=_0x333990[_0x5cd8aa(0x2df)](/#BLU#/g,_0x5cd8aa(0x32a)),_0x333990=_0x333990[_0x5cd8aa(0x2df)](/#RED#/g,'\x1b[31m'),_0x333990=_0x333990['replace'](/#YEL#/g,_0x5cd8aa(0x25a)),_0x333990=_0x333990[_0x5cd8aa(0x2df)](/#MAG#/g,_0x5cd8aa(0x30b)),_0x333990=_0x333990[_0x5cd8aa(0x2df)](/#CYA#/g,'\x1b[36m'),_0x333990=_0x333990[_0x5cd8aa(0x2df)](/#RES#/g,_0x5cd8aa(0x24f)));;}return _0x333990;},logger={'screen':_0x585f8c=>{const _0x4842b3=_0x5c7b80;console[_0x4842b3(0x2ea)](parseColor(_0x585f8c,!![]));},'simple':_0x15e9de=>{const _0x4f4a37=_0x5c7b80;console[_0x4f4a37(0x2ea)](parseColor(_0x15e9de,!![])),loggerfile['write'](util['format'](parseColor(_0x15e9de,![]))+'\x0a');},'full':async _0x4fa5c9=>{const _0x2dc0b3=_0x5c7b80,_0x1533ed=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4fa5c9;console[_0x2dc0b3(0x2ea)](parseColor(_0x1533ed,!![])),loggerfile[_0x2dc0b3(0x2f8)](util[_0x2dc0b3(0x24e)](parseColor(_0x1533ed,![]))+'\x0a');if(tgBot&&settings[_0x2dc0b3(0x2e1)]&&settings[_0x2dc0b3(0x2f0)]!='orders')await tgBot[_0x2dc0b3(0x2e6)](settings[_0x2dc0b3(0x2e1)],_0x2dc0b3(0x24c)+parseColor(_0x4fa5c9,![]))['catch'](_0x34cdcc=>{telegramError(_0x34cdcc);});},'debug':async(_0x164a68,_0x1bd9d0='')=>{const _0x5d802d=_0x5c7b80,_0x1cc443=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x164a68;if(debugging)console['log'](parseColor(_0x1cc443,!![]));loggerfile[_0x5d802d(0x2f8)](util[_0x5d802d(0x24e)](parseColor(_0x1cc443,![]))+'\x0a');if(_0x1bd9d0){if(debugging)console[_0x5d802d(0x2ea)](_0x1bd9d0);loggerfile[_0x5d802d(0x2f8)](util[_0x5d802d(0x24e)](_0x1bd9d0)+'\x0a');}}};process['on']('uncaughtException',function(_0x4e226b){logger['simple'](_0x4e226b);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5c7b80(0x232))[_0x5c7b80(0x3a9)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5c7b80(0x331)),app=express(),http=require(_0x5c7b80(0x281))[_0x5c7b80(0x248)](app);app[_0x5c7b80(0x27c)](fileUpload({'useTempFiles':!![]})),app[_0x5c7b80(0x322)](_0x5c7b80(0x2f9),async(_0x38044f,_0x21a182)=>{const _0x120648=_0x5c7b80,_0x53ea04=_0x38044f[_0x120648(0x2c5)][_0x120648(0x217)],_0x59b3f4=getClientsWithBotID(_0x120648(0x20f)),_0x2b1c6f=_0x38044f[_0x120648(0x2a5)]['uuid'],_0x3d4316=timelyDecrypt(_0x2b1c6f,![]),_0x5b7aa7=_0x59b3f4['find'](_0x3bf587=>_0x3bf587[_0x120648(0x269)]==_0x3d4316);if(_0x5b7aa7){const _0x2736aa=normalizeIP(_0x38044f[_0x120648(0x260)][_0x120648(0x2d3)])[_0x120648(0x1ed)],_0x32f21e=_0x38044f[_0x120648(0x2a5)]['tkn'];if(validateAccess(_0x32f21e,_0x3d4316,_0x2736aa)[_0x120648(0x329)])_0x53ea04==_0x120648(0x3c5)&&await backupConfigFiles(),await zipFiles(_0x53ea04),_0x21a182[_0x120648(0x34a)](zippath+(_0x53ea04+'.zip'),_0x5a9748=>{const _0x514b5d=_0x120648;_0x5a9748&&(logger[_0x514b5d(0x30a)]('Failed\x20to\x20download\x20'+_0x53ea04),logger[_0x514b5d(0x34f)](_0x5a9748));});else logger[_0x120648(0x30a)](_0x120648(0x22c)+_0x53ea04+'\x20(1)');}else logger['full'](_0x120648(0x22c)+_0x53ea04+_0x120648(0x3c7));}),app['post'](_0x5c7b80(0x39b),async(_0xd8d938,_0x3c138a)=>{const _0x183782=_0x5c7b80,_0x26e4b5=getClientsWithBotID(_0x183782(0x20f)),_0x4f6cae=_0xd8d938['headers']['uuid'],_0x3f2362=timelyDecrypt(_0x4f6cae,![]),_0x2c76b9=_0x26e4b5[_0x183782(0x353)](_0x2b2f3b=>_0x2b2f3b[_0x183782(0x269)]==_0x3f2362);logger['debug']('Backup\x20file\x20uploaded');if(_0x2c76b9){const _0x1f400f=normalizeIP(_0xd8d938[_0x183782(0x260)][_0x183782(0x2d3)])[_0x183782(0x1ed)],_0x406123=_0xd8d938['headers'][_0x183782(0x340)];if(validateAccess(_0x406123,_0x3f2362,_0x1f400f)[_0x183782(0x329)]){if(_0xd8d938[_0x183782(0x23f)]){const _0x506730=_0xd8d938[_0x183782(0x23f)][_0x183782(0x32c)];await _0x506730['mv'](temppath+_0x506730[_0x183782(0x259)]),_0x3c138a['send']({'status':!![],'message':'File\x20uploaded'});const _0x489ea6=getBotsWithMode();_0x489ea6['length']>0x0?confirmRestore(temppath,_0x506730['name']):unzipFile(temppath,_0x506730[_0x183782(0x259)]);}}else logger[_0x183782(0x30a)](_0x183782(0x255));}else logger['full'](_0x183782(0x39a));}),app[_0x5c7b80(0x27c)](express['static'](path['join'](__dirname,bbpath2,_0x5c7b80(0x2fb)))),app[_0x5c7b80(0x27c)](express[_0x5c7b80(0x295)](path[_0x5c7b80(0x284)](__dirname,bbpath2,'build'))),app[_0x5c7b80(0x322)]('/',function(_0x1a4e9f,_0x10d274){const _0x2e1914=_0x5c7b80;_0x10d274[_0x2e1914(0x3b6)](path[_0x2e1914(0x284)](__dirname,bbpath2,'build2',_0x2e1914(0x347)));}),app[_0x5c7b80(0x322)](_0x5c7b80(0x3be),function(_0x123015,_0xc71c14){const _0x13ac01=_0x5c7b80;_0xc71c14['sendFile'](path['join'](__dirname,bbpath2,_0x13ac01(0x1f8),_0x13ac01(0x347)));}),app[_0x5c7b80(0x322)](_0x5c7b80(0x21b),(_0x4a92e8,_0x4e8667)=>{const _0x4122fc=_0x5c7b80;_0x4e8667[_0x4122fc(0x3b6)](path['join'](__dirname,bbpath2,_0x4122fc(0x1f8),_0x4122fc(0x347)));}),app[_0x5c7b80(0x322)](_0x5c7b80(0x2bd),(_0xe8ca37,_0x5c31d2)=>{const _0x595abe=_0x5c7b80;_0x5c31d2[_0x595abe(0x3b6)](path['join'](__dirname,bbpath2,_0x595abe(0x1f8),'index.html'));}),app[_0x5c7b80(0x322)](_0x5c7b80(0x338),(_0x163967,_0x401435)=>{const _0xe59223=_0x5c7b80;_0x401435[_0xe59223(0x3b6)](path[_0xe59223(0x284)](__dirname,bbpath2,_0xe59223(0x1f8),_0xe59223(0x347)));}),app[_0x5c7b80(0x322)]('/:bot/history',(_0x18c5f7,_0x38372a)=>{const _0x57af29=_0x5c7b80;_0x38372a[_0x57af29(0x3b6)](path['join'](__dirname,bbpath2,_0x57af29(0x1f8),_0x57af29(0x347)));}),app[_0x5c7b80(0x322)](_0x5c7b80(0x24d),(_0x40edab,_0x3f182f)=>{const _0x41b9e4=_0x5c7b80;_0x3f182f[_0x41b9e4(0x3b6)](path[_0x41b9e4(0x284)](__dirname,bbpath2,_0x41b9e4(0x1f8),_0x41b9e4(0x347)));}),app[_0x5c7b80(0x322)](_0x5c7b80(0x274),(_0x43b0b5,_0x42db8f)=>{const _0x3336d7=_0x5c7b80;_0x42db8f[_0x3336d7(0x3b6)](path[_0x3336d7(0x284)](__dirname,bbpath2,_0x3336d7(0x1f8),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x5c7b80(0x309)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x115370=_0x5c7b80;let _0xc5a23b='[ip-address]';const _0xc88f88=networkInterfaces(),_0x380932={};for(const _0x402726 of Object[_0x115370(0x1f2)](_0xc88f88)){for(const _0x4a5830 of _0xc88f88[_0x402726]){if((_0x4a5830['family']=='IPv4'||_0x4a5830[_0x115370(0x253)]==0x4)&&!_0x4a5830[_0x115370(0x26b)]){const _0x59d246=ipaddr[_0x115370(0x3a3)](_0x4a5830[_0x115370(0x33b)])[_0x115370(0x394)]();_0x59d246!='private'&&(!_0x380932[_0x402726]&&(_0x380932[_0x402726]=[]),_0x380932[_0x402726][_0x115370(0x341)](_0x4a5830['address']),_0xc5a23b=_0x4a5830[_0x115370(0x33b)]);}}}return{'serverip':_0xc5a23b,'netinterfaces':_0x380932};}async function startServer(){const _0x22b8e8=_0x5c7b80,{serverip:_0x629cfc,netinterfaces:_0x37e761}=getServerIP();logger[_0x22b8e8(0x34f)](''),logger[_0x22b8e8(0x34f)](_0x22b8e8(0x320)),await logger[_0x22b8e8(0x30a)](_0x22b8e8(0x2a3)+serverversion+_0x22b8e8(0x1eb)+(environment==_0x22b8e8(0x24a)?_0x22b8e8(0x3c0):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x22b8e8(0x294))+(_0x22b8e8(0x328)+_0x629cfc+':'+PORT+_0x22b8e8(0x2c8))),logger[_0x22b8e8(0x34f)](_0x22b8e8(0x320));if(config[_0x22b8e8(0x2ed)]!=0x0)for(const _0x72bbd1 of config){if(_0x72bbd1[_0x22b8e8(0x345)]=='enabled'||_0x72bbd1[_0x22b8e8(0x345)]==_0x22b8e8(0x3cb))await logger[_0x22b8e8(0x30a)](_0x22b8e8(0x3c1)+_0x72bbd1[_0x22b8e8(0x319)]+_0x22b8e8(0x2ab)+_0x72bbd1[_0x22b8e8(0x32b)]),startBot([_0x72bbd1['botID'],userID],{'cwd':bbpath},function(_0x5f407b){if(_0x5f407b)logger['full'](_0x5f407b);});else(_0x72bbd1[_0x22b8e8(0x345)]==_0x22b8e8(0x35f)||_0x72bbd1[_0x22b8e8(0x345)]==_0x22b8e8(0x226))&&await logger[_0x22b8e8(0x30a)](_0x22b8e8(0x257)+_0x72bbd1[_0x22b8e8(0x319)]+_0x22b8e8(0x2ab)+_0x72bbd1[_0x22b8e8(0x32b)]);}else!newBot&&logger['simple'](_0x22b8e8(0x272));if(newBot)addBot();logger[_0x22b8e8(0x34f)](_0x22b8e8(0x320)),logger[_0x22b8e8(0x34f)](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger['debug'](_0x22b8e8(0x3ba),_0x37e761);}function _0x21b9(){const _0xbbadef=['file','telegramToken','backup-full@','ipv6','mkdirSync','\x20|\x20user:\x20...','Password\x20has\x20been\x20reset\x20to:\x20','/off\x20-\x20stop\x20bot(s)\x0a','telegramEnabled','kill','manual','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','login\x20token\x20generated','listen','full','\x1b[35m','uuid-random','*$1*','2047548ManvfJ','Bot\x20','logs','resetHistory','10765GqylTG','pidExpireLogin','RSA-OAEP','lastmsgtelegram','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20update\x20bot','Disabled\x20Bot\x20','botID','node-telegram-bot-api','getMonth','showConfig','************','/update\x20-\x20update\x20Balance\x20Bot\x0a','catch','-----------------------------------------------------------------------------------','getDate','get','Logged\x20out\x20user\x20...','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','update','temp/','onText','=>\x20Go\x20to\x20#CYA#http://','allow','\x1b[34m','botname','backupfile','headless','Enabled\x20Bot\x20','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','invalid\x20credentials','express','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20confirm\x20message','place-order','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','/help\x20-\x20show\x20available\x20commands\x0a','/:bot/coins','placeOrder','34418HpxCad','address','Notifications\x20disabled','Yes','generateKeyPairAsync','Temporary\x20access\x20rejected','tkn','push','\x20only\x0a','auth','stopped','status','Backup\x20file\x20unzipped\x20and\x20stored','index.html','All','7VdlTIv','download','Logged\x20in\x20user\x20...','0.0.0','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Error:\x20Invalid\x20argument\x20','simple','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','axios','privateKey','find','User\x20has\x20been\x20validated','onepagemode','remove','update-bb','yes','telegram','rmSync','access\x20timeout','<b>Telegram\x20Bot\x20Status:</b>\x0a','username','2FA\x20required','disabled','backup-full.zip','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','.zip','Invalid\x20authentication\x20token\x20(2)','sign','handshake','bb/','sockets',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','hex','argv','logs/','settings.','exit','SIGTERM','get-messages','Unauthorized\x20attempt\x20to\x20update\x20settings','toString','data','Invalid\x20Telegram\x20token','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','***','config/','2FA\x20login\x20rejected','node-zip','989845kNWINa','(((.+)+)+)+$','stop','backup/','isIPv4MappedAddress','referer','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','date-fns','reason','auto','server','reinstall-bb','Restore\x20process\x20aborted','bbvReceive','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','kind','password','Invalid\x20authentication\x20token\x20(1)','live','/on\x20-\x20start\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','production','5745028irqyzK','hasOwnProperty','test','decrypt','range','NTBA_FIX_319','pidRefreshToken','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','/enable\x20-\x20enable\x20notifications\x0a','then','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/upload-backup','send','Unauthorized\x20attempt\x20to\x20delete\x20alerts','SIGINT','request','add-bot','::ffff:127.0.0.1','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','parse','<b>Balance\x20Bot\x20Status:</b>\x0a','cancelLoading','deleteHistoryAlerts','verify','showname','version','storeConfiguration','\x20mode','reset-password','emit','track','updatebotmanager','3000','string','output-003.log','Invalid\x20IP\x20address','express-fileupload','accept','sendFile','existsSync','Login\x20accepted','-config.json','Network\x20Interfaces:','bots','Error\x20removing\x20old\x20backup\x20files:','defaults','/:bot','writeFileSync','(staging)','Starting\x20bot\x20|\x20Bot\x20','telegrammsg','Error\x20while\x20deleting\x20config\x20files:\x20','temporary\x20token\x20generated','backup','reset-history','\x20(2)','readFileSync','telegramIpApproval','bb-settings.json','new','output-002.log','backup-files','notification','#RES#\x20','args','store','unlinkSync','once','Starting\x20new\x20bot\x20|\x20Bot\x20','Session\x20expired\x20for\x20user\x20...','keys','temporary\x20access\x20timeout','path','Unauthorized\x20attempt\x20to\x20get\x20messages','settings','orders','build','/disable\x20-\x20disable\x20notifications\x0a','match','slice','compareSync','sort','bbvNew','statSync','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','inherit','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','exp','function','toggle-bot-mode','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','stopPolling','Alerts','blacklist','set','createWriteStream','child_process','sortBy','botmanager','toIPv4Address','/output-000.log','timeshift','Restore\x20backup\x20file\x20','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','store-headless','constructor','type','started','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','getFullYear','/:bot/portfolio','apiKey','apiPassword','publicKey','encryptedUuid','login\x20required','Deleted\x20Bot\x20','startsWith','versions','initclient','temporary\x20access\x20not\x20allowed','new-disabled','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','disconnect','logged\x20out','binary','Login\x20rejected','Unauthorized\x20attempt\x20to\x20download\x20','login','token','removeListener','bb-secure.json','output-001.log','version.json','bb-config.json','search','HTML','2262lvhbZx','lastmsgemitted','expiry','sendPortfolioTelegram','copyFileSync','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20get\x20portfolio','cloneDeep','login\x20token\x20valid','files','backup-full','mode','bot-','userid','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','/metrics\x20-\x20show\x20bot\x20performance\x0a','port','init','createServer','5\x20min','staging','Unauthorized\x20attempt\x20to\x20log\x20out','Bot\x20Mgr\x20>\x20','/:bot/configuration','format','\x1b[0m','filter','delete-bot','bot.js','family','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','name','\x1b[33m','mixpanel','env','error','debug','telegramUsername','socket','Notifications\x20types:\x20','from','logout','reinstall','entries','whitelistEnabled','getHours','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','uuid','update-bot','internal','/restart\x20-\x20restart\x20bot(s)\x0a','emitHistory','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','login\x20not\x20required','cancel-loading','includes','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','host','/:bot/support','timestamp','secret','readdirSync','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','</b>\x20?','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','10437560voARls','use','sendMetricsTelegram','1000','clients','\x20to\x20','http','2FA','all','join','zip/','bbUsername','split','title','latestversion','clientip','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','event','confirm-message','polling_error','3050RaMODy','get-backup-files','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','bbPassword','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','#RES#\x20if\x20running\x20locally\x0a','static','secure','stringify','Crypt','assign','output-000.log','environment','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','::1','getUTCHours','f2aRequired','endsWith','hashSync','access','Starting\x20#RED#Balance\x20Bot\x20v','temporaryAccessAllowed','headers','get-logs','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','\x20|\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','404\x20Not\x20Found','crypto','All\x20bots\x20running\x20right\x20now',',\x20must\x20be\x20a\x204\x20digit\x20number','node','get-starting-balances','telegram2FaApproval','alias','exec','reload','./version.json','number','getSeconds','loginRequired','show','Restoring\x20bot(s)\x20from\x20backup','/:bot/performance','bot','isDirectory','yargs/yargs','store-fiat','Unauthorized\x20attempt\x20to\x20show\x20configuration','toggleBotMode','bcryptjs','params','Notifications\x20enabled','conn','#RES#\x20if\x20running\x20on\x20server','toIPv4MappedAddress','/names\x20-\x20show\x20bot\x20names\x0a','-events.json','restore-backup-file','40383PZLaqm','\x20minutes','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','apiSecret','message','$1_$2_$3','remoteAddress','map','-results.json','getMinutes','Notifications\x20enabled\x0a','running','All\x20bots','Ok,\x20will\x20send\x20order\x20notifications\x20only','padStart','chat','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','replace','add','telegramChatId','alerts','success','getTime','sha256','sendMessage','any','enabled','answerCallbackQuery','log','callback_query','RSA','length','reject','DEFLATE','telegramEvents','messages','forEach','https://api.ipify.org?format=json','2FA\x20login\x20required','getStartingBalances','storeFiat','value','write','/download/:type','util','build2'];_0x21b9=function(){return _0xbbadef;};return _0x21b9();}function startSocket(){io['on']('connection',_0x3ef7dd=>{const _0x3e17c1=_0x2dc7;let _0x16865d,_0x4b528c,_0x45e7fc,_0x48fa38,_0x312025;const _0xd6190f=_0x3ef7dd[_0x3e17c1(0x365)][_0x3e17c1(0x2a5)][_0x3e17c1(0x37e)];_0x4b528c=_0xd6190f['match'](/bot[0-9]{3}/);if(_0x4b528c)_0x45e7fc=_0x4b528c[0x0][_0x3e17c1(0x1fa)](/[0-9]{3}/);if(_0x45e7fc)_0x16865d=_0x45e7fc[0x0];else _0x16865d=_0x3e17c1(0x20f);const _0x5751a6=_0x3ef7dd[_0x3e17c1(0x365)][_0x3e17c1(0x343)][_0x3e17c1(0x21f)];if(!_0x5751a6)_0x3ef7dd['emit'](_0x3e17c1(0x345),{'publicKey':secure[_0x3e17c1(0x21e)]});else{_0x48fa38=timelyDecrypt(_0x5751a6,![]);if(!_0x48fa38)_0x3ef7dd[_0x3e17c1(0x3ad)]('status',{'publicKey':secure[_0x3e17c1(0x21e)]});else{_0x312025=normalizeIP(_0x3ef7dd[_0x3e17c1(0x2c7)][_0x3e17c1(0x2d3)])[_0x3e17c1(0x1ed)];if(!devices[_0x48fa38])devices[_0x48fa38]={'uuid':_0x48fa38,'access':{'token':null}};devices[_0x48fa38]['ip']=_0x312025;const _0xc26faa=addClient(_0x3ef7dd['id'],_0x48fa38,_0x16865d);setAccess(_0xc26faa),emitMessages(),_0x3ef7dd['on'](_0x3e17c1(0x22d),_0x35811c=>{const _0x2ac5dd=_0x3e17c1,_0x146e85=timelyDecrypt(_0x35811c[_0x2ac5dd(0x38a)]);if(_0x146e85){_0x35811c={'username':_0x35811c[_0x2ac5dd(0x35d)],'password':_0x146e85},devices[_0x48fa38]['access']=validateCredentials(_0x35811c,_0x48fa38);if(devices[_0x48fa38][_0x2ac5dd(0x2a2)]['allow']==![]&&devices[_0x48fa38][_0x2ac5dd(0x2a2)][_0x2ac5dd(0x381)]==_0x2ac5dd(0x2f4))_0x3ef7dd[_0x2ac5dd(0x3ad)](_0x2ac5dd(0x345),{'access':devices[_0x48fa38][_0x2ac5dd(0x2a2)]}),loginAccess2FA(_0x48fa38,_0x312025);else{if(devices[_0x48fa38][_0x2ac5dd(0x2a2)]['allow']==![]&&devices[_0x48fa38]['access'][_0x2ac5dd(0x381)]==_0x2ac5dd(0x330))_0x3ef7dd[_0x2ac5dd(0x3ad)](_0x2ac5dd(0x345),{'access':devices[_0x48fa38][_0x2ac5dd(0x2a2)]});else devices[_0x48fa38][_0x2ac5dd(0x2a2)][_0x2ac5dd(0x329)]&&devices[_0x48fa38][_0x2ac5dd(0x2a2)][_0x2ac5dd(0x381)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x48fa38)['forEach'](_0x152c0a=>{setAccess(_0x152c0a);}),logger[_0x2ac5dd(0x25e)](_0x2ac5dd(0x34b)+_0x48fa38[_0x2ac5dd(0x1fb)](-0x8)),setTokenRefresh(_0x48fa38),setSessionTimeout(_0x2ac5dd(0x22d),_0x48fa38));}}else logger[_0x2ac5dd(0x30a)](_0x2ac5dd(0x387));}),_0x3ef7dd['on'](_0x3e17c1(0x3ac),()=>{resetPassword();}),_0x3ef7dd['on'](_0x3e17c1(0x228),_0x2afbef=>{removeClient(_0x3ef7dd['id']);}),_0x16865d==_0x3e17c1(0x20f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x6c6af5){const _0x3f46ca=_0x5c7b80;if(_0x6c6af5!=_0x3f46ca(0x20f)&&config[_0x3f46ca(0x21c)]!=''){if(pid[_0x6c6af5])pid[_0x6c6af5][_0x3f46ca(0x39c)]({'function':_0x3f46ca(0x224),'args':null});}_0x6c6af5!=_0x3f46ca(0x20f)&&broadcastToBots(_0x3f46ca(0x3bb),JSON[_0x3f46ca(0x297)](config));}function reloadBotManager(){const _0x4f8d9d=_0x5c7b80;getClientsWithBotID(_0x4f8d9d(0x20f))['forEach'](_0x4fb4bb=>{const _0x2b505a=_0x4f8d9d;getSocket(_0x4fb4bb['id'])[_0x2b505a(0x3ad)](_0x2b505a(0x345),{'access':{'allow':![],'reason':_0x2b505a(0x2b6),'token':null}});});}function getSocket(_0x184e1b){const _0x37220d=_0x5c7b80;return io[_0x37220d(0x367)]['sockets'][_0x37220d(0x322)](_0x184e1b);}function setAccess(_0xb8eb34){const _0x3f06bb=_0x5c7b80,_0x561c6d=getSocket(_0xb8eb34['id']),_0x5e2b2d=_0xb8eb34['uuid'],_0x5b86aa=_0xb8eb34[_0x3f06bb(0x2be)];devices[_0x5e2b2d][_0x3f06bb(0x2a2)]=validateAccess(devices[_0x5e2b2d][_0x3f06bb(0x2a2)][_0x3f06bb(0x22e)],_0x5e2b2d),logger[_0x3f06bb(0x25e)]('Setting\x20access:\x20'+devices[_0x5e2b2d]['access'][_0x3f06bb(0x381)]+'\x20|\x20client:\x20...'+_0xb8eb34['id']['slice'](-0x8)+_0x3f06bb(0x301)+_0x5e2b2d[_0x3f06bb(0x1fb)](-0x8)),_0x561c6d[_0x3f06bb(0x284)](_0x5e2b2d);if(devices[_0x5e2b2d][_0x3f06bb(0x2a2)][_0x3f06bb(0x329)]){_0x561c6d[_0x3f06bb(0x284)](_0x5b86aa);if(_0x5b86aa==_0x3f06bb(0x20f))initializeSocketBotManager(_0x561c6d);else initializeSocketBot(_0x561c6d);initClient(_0x5b86aa);}devices[_0x5e2b2d][_0x3f06bb(0x2a2)][_0x3f06bb(0x22e)]&&devices[_0x5e2b2d][_0x3f06bb(0x2a2)]['reason']==_0x3f06bb(0x3c4)&&setSessionTimeout(_0x3f06bb(0x282),_0x5e2b2d),devices[_0x5e2b2d][_0x3f06bb(0x2a2)]['token']&&devices[_0x5e2b2d][_0x3f06bb(0x2a2)][_0x3f06bb(0x381)]==_0x3f06bb(0x316)&&setSessionTimeout(_0x3f06bb(0x22d),_0x5e2b2d),_0x561c6d[_0x3f06bb(0x3ad)](_0x3f06bb(0x345),{'status':_0xb8eb34[_0x3f06bb(0x383)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5e2b2d][_0x3f06bb(0x2a2)],'externalip':devices[_0x5e2b2d]['ip'],'publicKey':secure[_0x3f06bb(0x21e)],'userid':settings[_0x3f06bb(0x243)],'validInstallation':validInstallation}),devices[_0x5e2b2d][_0x3f06bb(0x2a2)][_0x3f06bb(0x329)]==![]&&devices[_0x5e2b2d][_0x3f06bb(0x2a2)][_0x3f06bb(0x381)]==_0x3f06bb(0x35e)&&temporaryAccess2FA(_0x5e2b2d,devices[_0x5e2b2d]['ip']);}function setSessionTimeout(_0x534fcb,_0x445a91){const _0x385bdc=_0x5c7b80;let _0x43497f;if(_0x534fcb==_0x385bdc(0x22d))_0x43497f=loginExpiry*0x3c*0x3e8;else _0x43497f=devices[_0x445a91][_0x385bdc(0x3c9)][_0x385bdc(0x238)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x445a91][_0x385bdc(0x3c9)][_0x385bdc(0x275)]);if(devices[_0x445a91][_0x385bdc(0x313)])clearTimeout(devices[_0x445a91][_0x385bdc(0x313)]);devices[_0x445a91][_0x385bdc(0x313)]=setTimeout(()=>{const _0x476c8d=_0x385bdc;if(devices[_0x445a91][_0x476c8d(0x396)])clearTimeout(devices[_0x445a91]['pidRefreshToken']);removeSocketListeners(_0x445a91),addBlacklist(_0x445a91),devices[_0x445a91][_0x476c8d(0x3c9)]=null,devices[_0x445a91][_0x476c8d(0x2b3)]=null,devices[_0x445a91][_0x476c8d(0x2a2)][_0x476c8d(0x22e)]=null,logger[_0x476c8d(0x25e)](_0x476c8d(0x1f1)+_0x445a91[_0x476c8d(0x1fb)](-0x8)),devices[_0x445a91][_0x476c8d(0x2a2)]=validateAccess(devices[_0x445a91][_0x476c8d(0x2a2)]['token'],_0x445a91),!(devices[_0x445a91][_0x476c8d(0x2a2)]['allow']&&devices[_0x445a91][_0x476c8d(0x2a2)]['reason']==_0x476c8d(0x26f))&&(_0x534fcb==_0x476c8d(0x22d)?io['to'](_0x445a91)[_0x476c8d(0x3ad)](_0x476c8d(0x345),{'access':{'allow':![],'reason':_0x476c8d(0x35b),'token':null}}):io['to'](_0x445a91)['emit']('status',{'access':{'allow':![],'reason':_0x476c8d(0x1f3),'token':null}})),devices[_0x445a91]['access'][_0x476c8d(0x22e)]=null;},_0x43497f);}function setTokenRefresh(_0x2b8cc5){const _0x42c927=_0x5c7b80;if(devices[_0x2b8cc5][_0x42c927(0x396)])clearTimeout(devices[_0x2b8cc5][_0x42c927(0x396)]);devices[_0x2b8cc5]['pidRefreshToken']=setTimeout(()=>{const _0x304741=_0x42c927;getClientsWithUuid(_0x2b8cc5)[_0x304741(0x2ed)]!=0x0?(devices[_0x2b8cc5][_0x304741(0x2a2)]=refreshToken(_0x2b8cc5),io['to'](_0x2b8cc5)['emit'](_0x304741(0x345),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2b8cc5][_0x304741(0x2a2)],'externalip':devices[_0x2b8cc5]['ip'],'publicKey':secure[_0x304741(0x21e)],'validInstallation':validInstallation}),setTokenRefresh(_0x2b8cc5)):clearTimeout(devices[_0x2b8cc5][_0x304741(0x396)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4fcfe4){const _0x420416=_0x5c7b80,_0x438999=getClient(_0x4fcfe4['id'])['uuid'];_0x4fcfe4[_0x420416(0x3ad)]('bots',config),_0x4fcfe4[_0x420416(0x3ad)]('settings',cleanSettings()),_0x4fcfe4['on'](_0x420416(0x3a0),_0x496ca0=>{const _0x750a47=_0x420416;if(validateAccess(_0x496ca0,_0x438999)[_0x750a47(0x329)])addBot();else logger[_0x750a47(0x30a)](_0x750a47(0x2aa));}),_0x4fcfe4['on'](_0x420416(0x26a),(_0x502487,_0xc4e7d4)=>{const _0xb3c390=_0x420416;if(validateAccess(_0xc4e7d4,_0x438999)[_0xb3c390(0x329)])toggleBot(_0x502487[_0xb3c390(0x319)],_0x502487['status'],_0x502487[_0xb3c390(0x38c)]);else logger[_0xb3c390(0x30a)](_0xb3c390(0x317));}),_0x4fcfe4['on'](_0x420416(0x206),(_0x239950,_0x45dfad)=>{const _0x1a9954=_0x420416;if(validateAccess(_0x45dfad,_0x438999)[_0x1a9954(0x329)])toggleBotMode(_0x239950);else logger[_0x1a9954(0x30a)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4fcfe4['on'](_0x420416(0x251),(_0x35da6f,_0x4fc195)=>{const _0x198a79=_0x420416;if(validateAccess(_0x4fc195,_0x438999)['allow'])deleteBot(_0x35da6f);else logger[_0x198a79(0x30a)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4fcfe4['on']('store-settings',(_0x5ec6c3,_0x3d096a)=>{const _0x2916e2=_0x420416;if(validateAccess(_0x3d096a,_0x438999)[_0x2916e2(0x329)])storeSettings(_0x5ec6c3,!![]);else logger[_0x2916e2(0x30a)](_0x2916e2(0x370));}),_0x4fcfe4['on'](_0x420416(0x357),_0x47cfc0=>{const _0x5e3c06=_0x420416;if(validateAccess(_0x47cfc0,_0x438999)[_0x5e3c06(0x329)])updateBB(_0x5e3c06(0x325));else logger[_0x5e3c06(0x30a)](_0x5e3c06(0x388));}),_0x4fcfe4['on'](_0x420416(0x384),_0xb82543=>{const _0x18a40f=_0x420416;if(validateAccess(_0xb82543,_0x438999)[_0x18a40f(0x329)])updateBB(_0x18a40f(0x264));else logger[_0x18a40f(0x30a)](_0x18a40f(0x291));}),_0x4fcfe4['on'](_0x420416(0x290),_0x2f7169=>{const _0x2d5374=_0x420416;if(validateAccess(_0x2f7169,_0x438999)[_0x2d5374(0x329)]){const _0x599154=getClient(_0x4fcfe4['id']);if(_0x599154)getBackupFiles(_0x599154['uuid']);else logger[_0x2d5374(0x30a)](_0x2d5374(0x2cf));}else logger[_0x2d5374(0x30a)](_0x2d5374(0x227));}),_0x4fcfe4['on'](_0x420416(0x2cc),(_0x2e34dc,_0x9c2888)=>{const _0x42b734=_0x420416;if(validateAccess(_0x9c2888,_0x438999)['allow'])restoreBackupFile(_0x2e34dc);else logger[_0x42b734(0x30a)](_0x42b734(0x214));}),_0x4fcfe4['on'](_0x420416(0x36f),_0x2347b7=>{const _0x3be4b6=_0x420416;if(validateAccess(_0x2347b7,_0x438999)[_0x3be4b6(0x329)])getMessages();else logger[_0x3be4b6(0x30a)](_0x3be4b6(0x1f5));}),_0x4fcfe4['on']('confirm-message',(_0x2a50f7,_0x2d5929)=>{const _0x26ab95=_0x420416;if(validateAccess(_0x2d5929,_0x438999)[_0x26ab95(0x329)])confirmMessage(_0x2a50f7);else logger[_0x26ab95(0x30a)](_0x26ab95(0x333));}),_0x4fcfe4['on'](_0x420416(0x263),_0x2bb3ac=>{const _0x20288e=_0x420416;if(validateAccess(_0x2bb3ac,_0x438999)[_0x20288e(0x329)]){if(devices[_0x438999][_0x20288e(0x396)])clearTimeout(devices[_0x438999][_0x20288e(0x396)]);if(devices[_0x438999][_0x20288e(0x313)])clearTimeout(devices[_0x438999][_0x20288e(0x313)]);removeSocketListeners(getClient(_0x4fcfe4['id'])[_0x20288e(0x269)]),addBlacklist(_0x438999),devices[_0x438999][_0x20288e(0x3c9)]=null,devices[_0x438999][_0x20288e(0x2b3)]=null,devices[_0x438999][_0x20288e(0x2a2)]['token']=null,logger['debug'](_0x20288e(0x323)+_0x438999[_0x20288e(0x1fb)](-0x8)),io['to'](getClient(_0x4fcfe4['id'])[_0x20288e(0x269)])['emit'](_0x20288e(0x345),{'access':{'allow':![],'reason':_0x20288e(0x229),'token':null}});}else logger[_0x20288e(0x30a)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x2b0112){const _0x2b3ea9=_0x5c7b80,_0x1e2019=getClient(_0x2b0112['id'])[_0x2b3ea9(0x2be)],_0x49fcba=getClient(_0x2b0112['id'])['uuid'];_0x2b0112['on'](_0x2b3ea9(0x2a6),(_0x3d01f3,_0x2a7dab)=>{const _0x3119d3=_0x2b3ea9;if(validateAccess(_0x2a7dab,_0x49fcba)[_0x3119d3(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x3119d3(0x39c)]({'function':_0x3119d3(0x26d),'args':_0x3d01f3});}else logger[_0x3119d3(0x30a)](_0x3119d3(0x200));}),_0x2b0112['on']('delete-alerts',(_0x10fa7e,_0x53d6bf)=>{const _0x4defa4=_0x2b3ea9;if(validateAccess(_0x53d6bf,_0x49fcba)[_0x4defa4(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x4defa4(0x39c)]({'function':_0x4defa4(0x3a6),'args':_0x10fa7e});}else logger[_0x4defa4(0x30a)](_0x4defa4(0x39d));}),_0x2b0112['on']('get-portfolio',(_0x2498d6,_0x2f57f2)=>{const _0x40efe0=_0x2b3ea9;if(validateAccess(_0x2f57f2,_0x49fcba)['allow']){if(pid[_0x1e2019])pid[_0x1e2019][_0x40efe0(0x39c)]({'function':'getPortfolio','args':_0x2498d6});}else logger[_0x40efe0(0x30a)](_0x40efe0(0x23c));}),_0x2b0112['on']('store-configuration',(_0x3a461c,_0x53e6fa)=>{const _0x1b44f2=_0x2b3ea9;if(validateAccess(_0x53e6fa,_0x49fcba)['allow']){if(pid[_0x1e2019])pid[_0x1e2019]['send']({'function':_0x1b44f2(0x3aa),'args':_0x3a461c});}else logger[_0x1b44f2(0x30a)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2b0112['on'](_0x2b3ea9(0x215),(_0x552ad7,_0xde9c0d)=>{const _0x122fdb=_0x2b3ea9;if(validateAccess(_0xde9c0d,_0x49fcba)['allow']){if(pid[_0x1e2019])pid[_0x1e2019][_0x122fdb(0x39c)]({'function':'storeHeadless','args':_0x552ad7});}else logger[_0x122fdb(0x30a)](_0x122fdb(0x201));}),_0x2b0112['on'](_0x2b3ea9(0x2c1),(_0x61671a,_0x4ada6f)=>{const _0x495658=_0x2b3ea9;if(validateAccess(_0x4ada6f,_0x49fcba)[_0x495658(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x495658(0x39c)]({'function':_0x495658(0x2f6),'args':_0x61671a});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x2b0112['on'](_0x2b3ea9(0x3c6),_0x9af254=>{const _0x454c68=_0x2b3ea9;if(validateAccess(_0x9af254,_0x49fcba)[_0x454c68(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x454c68(0x39c)]({'function':_0x454c68(0x311),'args':null});}else logger['full'](_0x454c68(0x26e));}),_0x2b0112['on'](_0x2b3ea9(0x2b2),_0x21a510=>{const _0x9af964=_0x2b3ea9;if(validateAccess(_0x21a510,_0x49fcba)[_0x9af964(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019]['send']({'function':_0x9af964(0x2f5),'args':null});}else logger[_0x9af964(0x30a)](_0x9af964(0x374));}),_0x2b0112['on'](_0x2b3ea9(0x334),(_0x1160bc,_0x173adf)=>{const _0x4f69f7=_0x2b3ea9;if(validateAccess(_0x173adf,_0x49fcba)[_0x4f69f7(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x4f69f7(0x39c)]({'function':_0x4f69f7(0x339),'args':_0x1160bc});}else logger[_0x4f69f7(0x30a)](_0x4f69f7(0x2a7));}),_0x2b0112['on'](_0x2b3ea9(0x270),_0x1d1166=>{const _0x134e2c=_0x2b3ea9;if(validateAccess(_0x1d1166,_0x49fcba)[_0x134e2c(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x134e2c(0x39c)]({'function':_0x134e2c(0x3a5),'args':null});}else logger[_0x134e2c(0x30a)](_0x134e2c(0x268));}),_0x2b0112['on']('show-config',_0x4a7393=>{const _0x3b501c=_0x2b3ea9;if(validateAccess(_0x4a7393,_0x49fcba)[_0x3b501c(0x329)]){if(pid[_0x1e2019])pid[_0x1e2019][_0x3b501c(0x39c)]({'function':_0x3b501c(0x31c),'args':null});}else logger['full'](_0x3b501c(0x2c2));}),_0x2b0112['on'](_0x2b3ea9(0x357),_0x5e9ca9=>{const _0x70562f=_0x2b3ea9;if(validateAccess(_0x5e9ca9,_0x49fcba)[_0x70562f(0x329)])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2b0112['on'](_0x2b3ea9(0x36f),_0x1c0b34=>{const _0x538934=_0x2b3ea9;if(validateAccess(_0x1c0b34,_0x49fcba)['allow'])getMessages();else logger[_0x538934(0x30a)](_0x538934(0x1f5));}),_0x2b0112['on'](_0x2b3ea9(0x28d),(_0x2e4735,_0x46e541)=>{const _0x1ddf1a=_0x2b3ea9;if(validateAccess(_0x46e541,_0x49fcba)[_0x1ddf1a(0x329)])confirmMessage(_0x2e4735);else logger[_0x1ddf1a(0x30a)](_0x1ddf1a(0x333));}),_0x2b0112['on'](_0x2b3ea9(0x263),_0x161b03=>{const _0x56decd=_0x2b3ea9;if(validateAccess(_0x161b03,_0x49fcba)[_0x56decd(0x329)]){if(devices[_0x49fcba][_0x56decd(0x396)])clearTimeout(devices[_0x49fcba][_0x56decd(0x396)]);if(devices[_0x49fcba]['pidExpireLogin'])clearTimeout(devices[_0x49fcba][_0x56decd(0x313)]);removeSocketListeners(getClient(_0x2b0112['id'])['uuid']),addBlacklist(_0x49fcba),devices[_0x49fcba][_0x56decd(0x3c9)]=null,devices[_0x49fcba][_0x56decd(0x2b3)]=null,devices[_0x49fcba]['access']['token']=null,logger[_0x56decd(0x25e)](_0x56decd(0x323)+_0x49fcba[_0x56decd(0x1fb)](-0x8)),io['to'](getClient(_0x2b0112['id'])[_0x56decd(0x269)])[_0x56decd(0x3ad)](_0x56decd(0x345),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x56decd(0x24b));});}function removeSocketListeners(_0x140867){const _0x2defcd=_0x5c7b80;getClientsWithUuid(_0x140867)[_0x2defcd(0x2f2)](_0x4b6450=>{getSocket(_0x4b6450['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5932f8=_0x5c7b80;let _0x279f7d=settings;return settings[_0x5932f8(0x2fd)]&&settings[_0x5932f8(0x2fd)]!=''&&(_0x279f7d={..._0x279f7d,'telegramToken':_0x5932f8(0x31d)}),settings['bbPassword']&&settings[_0x5932f8(0x292)]!=''&&(_0x279f7d={..._0x279f7d,'bbPassword':_0x5932f8(0x31d)}),(settings[_0x5932f8(0x292)]&&settings[_0x5932f8(0x292)]==_0x5932f8(0x375)||settings[_0x5932f8(0x2fd)]&&settings['telegramToken']==_0x5932f8(0x375))&&(_0x279f7d={..._0x279f7d,'restored':{'password':settings['bbPassword']==_0x5932f8(0x375),'telegram':settings['telegramToken']==_0x5932f8(0x375)}}),_0x279f7d;}async function updateBB(_0x3c52e7){const _0x48653e=_0x5c7b80;await backupConfigFiles(),installingUpdate=!![],config[_0x48653e(0x2f2)](_0x257113=>{const _0x1130df=_0x48653e;restartBot(_0x257113[_0x1130df(0x319)]);});if(_0x3c52e7==_0x48653e(0x325))process[_0x48653e(0x39c)]({'update':!![],'environment':environment},_0x419825=>{});else _0x3c52e7==_0x48653e(0x264)&&process['send']({'reinstall':!![],'environment':environment},_0x547816=>{});}function startBot(_0x41bc1d,_0x28dfaa,_0x5a4dd2){const _0x77d78f=_0x5c7b80;if(debugging)_0x41bc1d[_0x77d78f(0x341)]('-d');let _0x53195b=![];const _0x1ef680=_0x41bc1d[0x0];_0x28dfaa={..._0x28dfaa,'stdio':['inherit',_0x77d78f(0x202),_0x77d78f(0x202),'ipc']},pid[_0x1ef680]=childProcess['fork'](botfile,_0x41bc1d,_0x28dfaa),pid[_0x1ef680]['on']('message',_0x5966e1=>{const _0x34af04=_0x77d78f;switch(Object['keys'](_0x5966e1)[0x0]){case'botname':updateBotName(_0x1ef680,_0x5966e1[_0x34af04(0x32b)]);break;case _0x34af04(0x3af):updateBotManager();break;case _0x34af04(0x345):updateStatus(_0x1ef680,_0x5966e1[_0x34af04(0x345)]);break;case'live':updateLive(_0x1ef680,_0x5966e1[_0x34af04(0x38c)]);break;case _0x34af04(0x218):updateLive(_0x1ef680,_0x5966e1[_0x34af04(0x218)]),io['to'](_0x1ef680)[_0x34af04(0x3ad)]('status',{'access':{'allow':![],'reason':_0x34af04(0x2b6),'token':null}});break;case'stop':_0x5966e1[_0x34af04(0x37b)]=='restart'&&restartBot(_0x1ef680);_0x5966e1[_0x34af04(0x37b)]==_0x34af04(0x305)&&toggleBot(_0x1ef680,'disabled',_0x34af04(0x344));break;case _0x34af04(0x359):sendTelegram(_0x1ef680,_0x5966e1['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x5966e1[_0x34af04(0x3c2)]);break;case'function':io['to'](_0x1ef680)[_0x34af04(0x3ad)](_0x5966e1[_0x34af04(0x205)],_0x5966e1[_0x34af04(0x1ec)]);break;}}),pid[_0x1ef680]['on']('error',function(_0x10124f){if(_0x53195b)return;_0x53195b=!![],_0x5a4dd2(_0x10124f);}),pid[_0x1ef680]['on'](_0x77d78f(0x36d),async function(_0xd8abf2){const _0x8bf91a=_0x77d78f;if(installingUpdate)return;if(_0x53195b)return;_0x53195b=!![],_0x5a4dd2(null);const _0x2bdddf=dbConfig['get'](_0x8bf91a(0x3bb))[_0x8bf91a(0x353)]({'botID':_0x1ef680})[_0x8bf91a(0x2f7)]();_0x2bdddf&&(_0x2bdddf[_0x8bf91a(0x345)]=='enabled'||_0x2bdddf[_0x8bf91a(0x345)]=='new')&&(await sleep(0x3e8),updateLive(_0x1ef680,'stopped'),logger[_0x8bf91a(0x30a)]('Restarting\x20Bot\x20'+_0x1ef680),startBot([_0x1ef680,userID],{'cwd':bbpath},function(_0x248271){const _0x1dcf1f=_0x8bf91a;if(_0x248271)logger[_0x1dcf1f(0x30a)](_0x248271);}));});}function stopBot(_0xe6c33c){const _0x5a9f6b=_0x5c7b80;getClientsWithBotID(_0xe6c33c)[_0x5a9f6b(0x2f2)](_0x493bac=>{getSocket(_0x493bac['id'])['disconnect'](!![]),removeClient(_0x493bac['id']);}),pid[_0xe6c33c]&&(pid[_0xe6c33c][_0x5a9f6b(0x305)](),pid[_0xe6c33c]=null);}function restartBot(_0x2ade65){if(pid[_0x2ade65])pid[_0x2ade65]['kill']();}function addBot(){const _0x3aeb8e=_0x5c7b80;let _0x208e10;for(let _0x293a0e=0x1;_0x293a0e<0x3e9;_0x293a0e++){_0x208e10=_0x293a0e['toString']()[_0x3aeb8e(0x2db)](0x3,'0');let _0x11b53e=config['find'](_0x39a3b9=>_0x39a3b9[_0x3aeb8e(0x319)]==_0x208e10);if(!_0x11b53e)break;}if(_0x208e10===_0x3aeb8e(0x27e)){logger['full'](_0x3aeb8e(0x203));return;}logger[_0x3aeb8e(0x30a)](_0x3aeb8e(0x1f0)+_0x208e10),dbConfig[_0x3aeb8e(0x322)]('bots')['push']({'botID':_0x208e10,'botname':_0x3aeb8e(0x30f)+_0x208e10,'status':_0x3aeb8e(0x3cb),'live':''})[_0x3aeb8e(0x2f8)](),startBot([_0x208e10,userID],{'cwd':bbpath},function(_0x225aba){const _0x3cb51b=_0x3aeb8e;if(_0x225aba)logger[_0x3cb51b(0x30a)](_0x225aba);}),config=getConfiguration(),io['to'](_0x3aeb8e(0x20f))[_0x3aeb8e(0x3ad)](_0x3aeb8e(0x3bb),config),broadcastToBots(_0x3aeb8e(0x3bb),JSON[_0x3aeb8e(0x297)](config));}function deleteBot(_0x2485fa){const _0x1b85c6=_0x5c7b80;getClientsWithBotID(_0x2485fa)[_0x1b85c6(0x2f2)](_0x33a456=>{const _0x1cfb76=_0x1b85c6;getSocket(_0x33a456['id'])[_0x1cfb76(0x228)](!![]),removeClient(_0x33a456['id']);}),dbConfig[_0x1b85c6(0x322)]('bots')[_0x1b85c6(0x356)]({'botID':_0x2485fa})[_0x1b85c6(0x2f8)](),logger[_0x1b85c6(0x30a)](_0x1b85c6(0x221)+_0x2485fa),stopBot(_0x2485fa);try{if(fs[_0x1b85c6(0x3b7)](path[_0x1b85c6(0x284)](configpath,'bot-'+_0x2485fa+_0x1b85c6(0x3b9))))fs[_0x1b85c6(0x1ee)](path[_0x1b85c6(0x284)](configpath,_0x1b85c6(0x242)+_0x2485fa+_0x1b85c6(0x3b9)));if(fs[_0x1b85c6(0x3b7)](path['join'](configpath,_0x1b85c6(0x242)+_0x2485fa+_0x1b85c6(0x2cb))))fs[_0x1b85c6(0x1ee)](path[_0x1b85c6(0x284)](configpath,_0x1b85c6(0x242)+_0x2485fa+_0x1b85c6(0x2cb)));if(fs[_0x1b85c6(0x3b7)](path[_0x1b85c6(0x284)](configpath,'bot-'+_0x2485fa+'-performance.json')))fs['unlinkSync'](path[_0x1b85c6(0x284)](configpath,'bot-'+_0x2485fa+'-performance.json'));if(fs[_0x1b85c6(0x3b7)](path[_0x1b85c6(0x284)](configpath,'bot-'+_0x2485fa+_0x1b85c6(0x2d5))))fs[_0x1b85c6(0x1ee)](path[_0x1b85c6(0x284)](configpath,_0x1b85c6(0x242)+_0x2485fa+_0x1b85c6(0x2d5)));}catch(_0x1c43d6){if(_0x1c43d6)logger[_0x1b85c6(0x30a)](_0x1b85c6(0x3c3),_0x1c43d6);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x1b85c6(0x3bb),config),broadcastToBots(_0x1b85c6(0x3bb),JSON[_0x1b85c6(0x297)](config));}function toggleBot(_0x15ce1d,_0x24b085,_0x173f6a){const _0xdabfc0=_0x5c7b80;dbConfig[_0xdabfc0(0x322)](_0xdabfc0(0x3bb))[_0xdabfc0(0x353)]({'botID':_0x15ce1d})[_0xdabfc0(0x299)]({'status':_0x24b085})[_0xdabfc0(0x299)]({'live':_0x173f6a})['write']();if(_0x24b085=='enabled'||_0x24b085=='new')logger[_0xdabfc0(0x30a)](_0xdabfc0(0x32e)+_0x15ce1d),startBot([_0x15ce1d,userID],{'cwd':bbpath},function(_0x309730){const _0xa55941=_0xdabfc0;if(_0x309730)logger[_0xa55941(0x30a)](_0x309730);});else(_0x24b085=='disabled'||_0x24b085==_0xdabfc0(0x226))&&(logger[_0xdabfc0(0x30a)](_0xdabfc0(0x318)+_0x15ce1d),stopBot(_0x15ce1d));config=getConfiguration(),io['to'](_0xdabfc0(0x20f))[_0xdabfc0(0x3ad)](_0xdabfc0(0x3bb),config),broadcastToBots(_0xdabfc0(0x3bb),JSON[_0xdabfc0(0x297)](config));}function toggleStatus(_0x128cc6){const _0x5d109a=_0x5c7b80;let _0x3fdcd5=dbConfig[_0x5d109a(0x322)](_0x5d109a(0x3bb))[_0x5d109a(0x353)]({'botID':_0x128cc6})[_0x5d109a(0x2f7)](),_0x478871;if(_0x3fdcd5[_0x5d109a(0x345)]===_0x5d109a(0x2e8))_0x478871=_0x5d109a(0x35f);else{if(_0x3fdcd5[_0x5d109a(0x345)]===_0x5d109a(0x3cb))_0x478871=_0x5d109a(0x226);else{if(_0x3fdcd5[_0x5d109a(0x345)]===_0x5d109a(0x226))_0x478871='new';else{if(_0x3fdcd5[_0x5d109a(0x345)]===_0x5d109a(0x35f))_0x478871=_0x5d109a(0x2e8);}}}return _0x478871;}function updateStatus(_0x25f6ef,_0x5a92a3){const _0x37ca11=_0x5c7b80;dbConfig['get'](_0x37ca11(0x3bb))[_0x37ca11(0x353)]({'botID':_0x25f6ef})[_0x37ca11(0x299)]({'status':_0x5a92a3})[_0x37ca11(0x2f8)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x37ca11(0x3bb),config),broadcastToBots(_0x37ca11(0x3bb),JSON[_0x37ca11(0x297)](config));}function updateLive(_0x3a1def,_0x183313){const _0x949a5a=_0x5c7b80;dbConfig[_0x949a5a(0x322)](_0x949a5a(0x3bb))[_0x949a5a(0x353)]({'botID':_0x3a1def})[_0x949a5a(0x299)]({'live':_0x183313})[_0x949a5a(0x2f8)](),config=getConfiguration(),io['to'](_0x949a5a(0x20f))[_0x949a5a(0x3ad)](_0x949a5a(0x3bb),config),broadcastToBots(_0x949a5a(0x3bb),JSON[_0x949a5a(0x297)](config));}function updateBotName(_0x39e30c,_0x550fc4){const _0x2e46f2=_0x5c7b80;dbConfig[_0x2e46f2(0x322)](_0x2e46f2(0x3bb))['find']({'botID':_0x39e30c})[_0x2e46f2(0x299)]({'botname':_0x550fc4})[_0x2e46f2(0x2f8)](),config=getConfiguration(),io['to'](_0x2e46f2(0x20f))[_0x2e46f2(0x3ad)](_0x2e46f2(0x3bb),config),broadcastToBots(_0x2e46f2(0x3bb),JSON[_0x2e46f2(0x297)](config));}function updateBotManager(){const _0x432c6c=_0x5c7b80;config=getConfiguration(),io['to'](_0x432c6c(0x20f))[_0x432c6c(0x3ad)]('bots',config),broadcastToBots(_0x432c6c(0x3bb),JSON['stringify'](config));}function toggleBotMode(_0x58da9c){const _0x31e179=_0x5c7b80;if(pid[_0x58da9c])pid[_0x58da9c][_0x31e179(0x39c)]({'function':_0x31e179(0x2c3),'args':null});else{const _0x456d11=configpath+_0x31e179(0x242)+_0x58da9c+_0x31e179(0x3b9),_0x341732=fs[_0x31e179(0x3c8)](_0x456d11),_0x5cdb83=JSON[_0x31e179(0x3a3)](_0x341732),_0x3249fb=_0x5cdb83[_0x31e179(0x2be)][0x0][_0x31e179(0x32d)];_0x5cdb83[_0x31e179(0x2be)][0x0][_0x31e179(0x32d)]=!_0x3249fb;const _0x3978fe=JSON[_0x31e179(0x297)](_0x5cdb83,null,0x2);fs[_0x31e179(0x3bf)](_0x456d11,_0x3978fe),config=getConfiguration(),io['to'](_0x31e179(0x20f))['emit']('bots',config),broadcastToBots(_0x31e179(0x3bb),JSON[_0x31e179(0x297)](config));}}function telegramError(_0x442533){const _0x464641=_0x5c7b80;logger[_0x464641(0x34f)](getTimeStamp()+_0x464641(0x368));}function validateTelegram(_0x493e93){const _0x38bc3f=_0x5c7b80;if(_0x493e93[_0x38bc3f(0x262)][_0x38bc3f(0x35d)]!=settings['telegramUsername']&&'@'+_0x493e93[_0x38bc3f(0x262)]['username']!=settings[_0x38bc3f(0x25f)])return tgBot[_0x38bc3f(0x2e6)](_0x493e93[_0x38bc3f(0x2dc)]['id'],_0x38bc3f(0x2dd),{'parse_mode':_0x38bc3f(0x235)})[_0x38bc3f(0x31f)](_0x441f7c=>{telegramError(_0x441f7c);}),![];return!![];}async function initTelegram(){const _0x22b095=_0x5c7b80;if(tgBot)tgBot[_0x22b095(0x208)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x22b095(0x2fd)],{'polling':!![]});let _0x183d01='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x183d01+='\x0a',_0x183d01+=_0x22b095(0x398),_0x183d01+=_0x22b095(0x1f9),_0x183d01+=_0x22b095(0x2a9),_0x183d01+=_0x22b095(0x26c),_0x183d01+=_0x22b095(0x38d),_0x183d01+=_0x22b095(0x303),_0x183d01+=_0x22b095(0x207),_0x183d01+=_0x22b095(0x2ca),_0x183d01+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x183d01+=_0x22b095(0x245),_0x183d01+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x183d01+=_0x22b095(0x31e),_0x183d01+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x183d01+=_0x22b095(0x337);let _0x4771fa=_0x22b095(0x219);_0x4771fa+='\x0a',_0x4771fa+=_0x183d01,tgBot[_0x22b095(0x327)](/\/start/,_0x27a0d9=>{const _0x2c884d=_0x22b095;if(!validateTelegram(_0x27a0d9))return;if(settings[_0x2c884d(0x2e1)]!=_0x27a0d9[_0x2c884d(0x2dc)]['id'])updateSetting(_0x2c884d(0x2e1),_0x27a0d9['chat']['id']);updateSetting(_0x2c884d(0x304),!![]),tgBot[_0x2c884d(0x2e6)](_0x27a0d9[_0x2c884d(0x2dc)]['id'],_0x4771fa)[_0x2c884d(0x31f)](_0x342397=>{telegramError(_0x342397);});}),tgBot[_0x22b095(0x327)](/\/enable/,_0x51e1b2=>{const _0x28a91d=_0x22b095;if(!validateTelegram(_0x51e1b2))return;if(settings[_0x28a91d(0x2e1)]!=_0x51e1b2[_0x28a91d(0x2dc)]['id'])updateSetting(_0x28a91d(0x2e1),_0x51e1b2[_0x28a91d(0x2dc)]['id']);updateSetting(_0x28a91d(0x304),!![]),tgBot[_0x28a91d(0x2e6)](_0x51e1b2[_0x28a91d(0x2dc)]['id'],_0x28a91d(0x2c6))[_0x28a91d(0x31f)](_0x301d60=>{telegramError(_0x301d60);});}),tgBot[_0x22b095(0x327)](/\/config/,async _0x22486c=>{const _0x25e5a7=_0x22b095;if(!validateTelegram(_0x22486c))return;tgBot[_0x25e5a7(0x22f)](_0x25e5a7(0x2eb)),tgBot[_0x25e5a7(0x2e6)](_0x22486c[_0x25e5a7(0x2dc)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x25e5a7(0x209),'callback_data':_0x25e5a7(0x2e2)},{'text':_0x25e5a7(0x348),'callback_data':'all'}]]}})[_0x25e5a7(0x31f)](_0x5ea799=>{telegramError(_0x5ea799);}),tgBot['on'](_0x25e5a7(0x2eb),async _0x4f2dd5=>{const _0x57dee9=_0x25e5a7,_0x246c32=_0x4f2dd5[_0x57dee9(0x372)],_0x54b122=_0x4f2dd5[_0x57dee9(0x2d1)];tgBot[_0x57dee9(0x2e9)](_0x4f2dd5['id'])[_0x57dee9(0x399)](async()=>{const _0x268bad=_0x57dee9;_0x246c32==_0x268bad(0x1f7)&&(updateSetting(_0x268bad(0x2f0),'orders'),updateSetting(_0x268bad(0x304),!![]),await tgBot['sendMessage'](_0x54b122['chat']['id'],_0x268bad(0x2da))[_0x268bad(0x31f)](_0xea1598=>{telegramError(_0xea1598);}));_0x246c32==_0x268bad(0x2e2)&&(updateSetting(_0x268bad(0x2f0),'alerts'),updateSetting(_0x268bad(0x304),!![]),await tgBot[_0x268bad(0x2e6)](_0x54b122[_0x268bad(0x2dc)]['id'],_0x268bad(0x2a8))[_0x268bad(0x31f)](_0x26788d=>{telegramError(_0x26788d);}));_0x246c32==_0x268bad(0x283)&&(updateSetting('telegramEvents','all'),updateSetting(_0x268bad(0x304),!![]),await tgBot['sendMessage'](_0x54b122[_0x268bad(0x2dc)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x268bad(0x31f)](_0x103df4=>{telegramError(_0x103df4);}));if(!settings[_0x268bad(0x2e1)])tgBot[_0x268bad(0x2e6)](_0x54b122[_0x268bad(0x2dc)]['id'],_0x268bad(0x29c))[_0x268bad(0x31f)](_0x3afe6f=>{telegramError(_0x3afe6f);});}),tgBot['removeListener'](_0x57dee9(0x2eb));});}),tgBot[_0x22b095(0x327)](/\/status/,_0x55f672=>{const _0x302973=_0x22b095;if(!validateTelegram(_0x55f672))return;const _0x50a3a7=getBotsWithMode();let _0xdd0830=_0x302973(0x3a4);config['forEach'](_0x29092b=>{const _0x12f65e=_0x302973,_0x509e36=_0x50a3a7[_0x12f65e(0x353)](_0x508c05=>_0x508c05['botID']==_0x29092b['botID'])[_0x12f65e(0x241)];_0xdd0830+=_0x12f65e(0x30f)+_0x29092b[_0x12f65e(0x319)]+':\x20'+_0x29092b[_0x12f65e(0x345)]+_0x12f65e(0x2ab)+_0x509e36+'\x20|\x20'+_0x29092b[_0x12f65e(0x38c)]+'\x0a';}),_0xdd0830+='\x0a',_0xdd0830+=_0x302973(0x35c),_0xdd0830+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x302973(0x2d7),_0xdd0830+=settings[_0x302973(0x304)]?settings[_0x302973(0x2f0)]==_0x302973(0x283)?_0x302973(0x37f):_0x302973(0x261)+settings[_0x302973(0x2f0)]+_0x302973(0x342):'',tgBot[_0x302973(0x2e6)](_0x55f672[_0x302973(0x2dc)]['id'],_0xdd0830,{'parse_mode':_0x302973(0x235)})[_0x302973(0x31f)](_0x4a7d95=>{telegramError(_0x4a7d95);});}),tgBot[_0x22b095(0x327)](/\/restart/,_0x9e1833=>{const _0x442f4b=_0x22b095;if(!validateTelegram(_0x9e1833))return;tgBot[_0x442f4b(0x22f)](_0x442f4b(0x2eb));const _0x53f29d=getEnabledBots();if(_0x53f29d[_0x442f4b(0x2ed)]==0x0)tgBot[_0x442f4b(0x2e6)](_0x9e1833[_0x442f4b(0x2dc)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x442f4b(0x31f)](_0x3899be=>{telegramError(_0x3899be);});else{if(_0x53f29d[_0x442f4b(0x2ed)]>0x1)_0x53f29d['push']({'botID':_0x442f4b(0x283)});let _0x535b87=[],_0x4fdbd2=[];const _0x381697=_0x53f29d['length']%0x4==0x0||_0x53f29d[_0x442f4b(0x2ed)]%0x4==0x3||_0x53f29d[_0x442f4b(0x2ed)]%0x3==0x1?0x4:0x3;let _0x2e61c4=0x0;_0x53f29d['forEach']((_0x199a80,_0x2ca127)=>{const _0x37be8e=_0x442f4b;if(_0x2ca127%_0x381697==0x0)_0x4fdbd2=[];_0x4fdbd2[_0x37be8e(0x341)]({'text':_0x199a80[_0x37be8e(0x319)]==_0x37be8e(0x283)?_0x37be8e(0x2d9):_0x37be8e(0x30f)+_0x199a80[_0x37be8e(0x319)],'callback_data':_0x199a80[_0x37be8e(0x319)]}),_0x2ca127%_0x381697==0x0&&(_0x535b87[_0x2e61c4]=_0x4fdbd2,_0x2e61c4++);}),tgBot['sendMessage'](_0x9e1833[_0x442f4b(0x2dc)]['id'],_0x442f4b(0x3a2),{'reply_markup':{'inline_keyboard':_0x535b87}})[_0x442f4b(0x31f)](_0x54d6d0=>{telegramError(_0x54d6d0);}),tgBot['on']('callback_query',async _0x37e780=>{const _0x559aa3=_0x442f4b,_0x32a006=_0x37e780['data'],_0x523136=_0x37e780[_0x559aa3(0x2d1)];tgBot['answerCallbackQuery'](_0x37e780['id'])['then'](async()=>{const _0xaf1022=_0x559aa3;_0x32a006==_0xaf1022(0x283)?config[_0xaf1022(0x2f2)](_0x497f7b=>{const _0x16f58f=_0xaf1022;restartBot(_0x497f7b[_0x16f58f(0x319)]);}):restartBot(_0x32a006);}),tgBot[_0x559aa3(0x22f)](_0x559aa3(0x2eb));});}}),tgBot[_0x22b095(0x327)](/\/on/,_0xd58de6=>{const _0x9e3a51=_0x22b095;if(!validateTelegram(_0xd58de6))return;tgBot[_0x9e3a51(0x22f)]('callback_query');const _0x3a787d=getDisabledBots();if(_0x3a787d['length']==0x0)tgBot[_0x9e3a51(0x2e6)](_0xd58de6[_0x9e3a51(0x2dc)]['id'],_0x9e3a51(0x2af))[_0x9e3a51(0x31f)](_0x5bf7d4=>{telegramError(_0x5bf7d4);});else{if(_0x3a787d[_0x9e3a51(0x2ed)]>0x1)_0x3a787d[_0x9e3a51(0x341)]({'botID':_0x9e3a51(0x283)});let _0x56c583=[],_0x2fe8ec=[];const _0x570fed=_0x3a787d['length']%0x4==0x0||_0x3a787d[_0x9e3a51(0x2ed)]%0x4==0x3||_0x3a787d[_0x9e3a51(0x2ed)]%0x3==0x1?0x4:0x3;let _0x1282a6=0x0;_0x3a787d[_0x9e3a51(0x2f2)]((_0x5b5cc4,_0x507b87)=>{const _0x3bb3bf=_0x9e3a51;if(_0x507b87%_0x570fed==0x0)_0x2fe8ec=[];_0x2fe8ec[_0x3bb3bf(0x341)]({'text':_0x5b5cc4['botID']=='all'?_0x3bb3bf(0x2d9):_0x3bb3bf(0x30f)+_0x5b5cc4[_0x3bb3bf(0x319)],'callback_data':_0x5b5cc4[_0x3bb3bf(0x319)]}),_0x507b87%_0x570fed==0x0&&(_0x56c583[_0x1282a6]=_0x2fe8ec,_0x1282a6++);}),tgBot[_0x9e3a51(0x2e6)](_0xd58de6[_0x9e3a51(0x2dc)]['id'],_0x9e3a51(0x350),{'reply_markup':{'inline_keyboard':_0x56c583}})[_0x9e3a51(0x31f)](_0x5f103c=>{telegramError(_0x5f103c);}),tgBot['on'](_0x9e3a51(0x2eb),async _0x30b641=>{const _0x5c272b=_0x9e3a51,_0x20f4a1=_0x30b641[_0x5c272b(0x372)],_0x29e0d4=_0x30b641[_0x5c272b(0x2d1)];tgBot['answerCallbackQuery'](_0x30b641['id'])[_0x5c272b(0x399)](async()=>{const _0x1e49bb=_0x5c272b;_0x20f4a1==_0x1e49bb(0x283)?(tgBot[_0x1e49bb(0x2e6)](_0x29e0d4[_0x1e49bb(0x2dc)]['id'],_0x1e49bb(0x34d))[_0x1e49bb(0x31f)](_0x465111=>{telegramError(_0x465111);}),_0x3a787d[_0x1e49bb(0x2f2)](_0x2a8b10=>{const _0x1ba93b=_0x1e49bb;if(_0x2a8b10[_0x1ba93b(0x319)]!=_0x1ba93b(0x283))toggleBot(_0x2a8b10[_0x1ba93b(0x319)],toggleStatus(_0x2a8b10[_0x1ba93b(0x319)]),_0x1ba93b(0x344));})):(tgBot[_0x1e49bb(0x2e6)](_0x29e0d4[_0x1e49bb(0x2dc)]['id'],_0x1e49bb(0x336)+_0x20f4a1)[_0x1e49bb(0x31f)](_0x3ac241=>{telegramError(_0x3ac241);}),toggleBot(_0x20f4a1,toggleStatus(_0x20f4a1),_0x1e49bb(0x344)));}),tgBot[_0x5c272b(0x22f)](_0x5c272b(0x2eb));});}}),tgBot[_0x22b095(0x327)](/\/off/,_0xc05d23=>{const _0x3897d4=_0x22b095;if(!validateTelegram(_0xc05d23))return;tgBot[_0x3897d4(0x22f)](_0x3897d4(0x2eb));const _0x198a68=getEnabledBots();if(_0x198a68['length']==0x0)tgBot[_0x3897d4(0x2e6)](_0xc05d23[_0x3897d4(0x2dc)]['id'],_0x3897d4(0x254))[_0x3897d4(0x31f)](_0x85cdf4=>{telegramError(_0x85cdf4);});else{if(_0x198a68[_0x3897d4(0x2ed)]>0x1)_0x198a68[_0x3897d4(0x341)]({'botID':_0x3897d4(0x283)});let _0x5383fc=[],_0x3ddafb=[];const _0x343c50=_0x198a68[_0x3897d4(0x2ed)]%0x4==0x0||_0x198a68[_0x3897d4(0x2ed)]%0x4==0x3||_0x198a68[_0x3897d4(0x2ed)]%0x3==0x1?0x4:0x3;let _0x24c585=0x0;_0x198a68[_0x3897d4(0x2f2)]((_0x345981,_0x873a6)=>{const _0x344e9a=_0x3897d4;if(_0x873a6%_0x343c50==0x0)_0x3ddafb=[];_0x3ddafb['push']({'text':_0x345981['botID']==_0x344e9a(0x283)?_0x344e9a(0x2d9):_0x344e9a(0x30f)+_0x345981[_0x344e9a(0x319)],'callback_data':_0x345981[_0x344e9a(0x319)]}),_0x873a6%_0x343c50==0x0&&(_0x5383fc[_0x24c585]=_0x3ddafb,_0x24c585++);}),tgBot[_0x3897d4(0x2e6)](_0xc05d23[_0x3897d4(0x2dc)]['id'],_0x3897d4(0x256),{'reply_markup':{'inline_keyboard':_0x5383fc}})['catch'](_0x250700=>{telegramError(_0x250700);}),tgBot['on'](_0x3897d4(0x2eb),async _0x19e21f=>{const _0x32bb39=_0x3897d4,_0x1acc95=_0x19e21f[_0x32bb39(0x372)],_0x2bf464=_0x19e21f[_0x32bb39(0x2d1)];tgBot['answerCallbackQuery'](_0x19e21f['id'])[_0x32bb39(0x399)](async()=>{const _0x4f5a39=_0x32bb39;_0x1acc95==_0x4f5a39(0x283)?(tgBot[_0x4f5a39(0x2e6)](_0x2bf464[_0x4f5a39(0x2dc)]['id'],_0x4f5a39(0x258))['catch'](_0x2be4b7=>{telegramError(_0x2be4b7);}),_0x198a68[_0x4f5a39(0x2f2)](_0x5e189=>{const _0x493e65=_0x4f5a39;if(_0x5e189[_0x493e65(0x319)]!=_0x493e65(0x283))toggleBot(_0x5e189[_0x493e65(0x319)],toggleStatus(_0x5e189[_0x493e65(0x319)]),_0x493e65(0x344));})):(tgBot[_0x4f5a39(0x2e6)](_0x2bf464['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x1acc95)[_0x4f5a39(0x31f)](_0x3bfc73=>{telegramError(_0x3bfc73);}),toggleBot(_0x1acc95,toggleStatus(_0x1acc95),'stopped'));}),tgBot['removeListener'](_0x32bb39(0x2eb));});}}),tgBot[_0x22b095(0x327)](/\/metrics/,_0x34990d=>{const _0xdbea30=_0x22b095;if(!validateTelegram(_0x34990d))return;tgBot[_0xdbea30(0x22f)](_0xdbea30(0x2eb));const _0x593268=getEnabledBots();if(_0x593268[_0xdbea30(0x2ed)]==0x0)tgBot[_0xdbea30(0x2e6)](_0x34990d['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x1915f8=>{telegramError(_0x1915f8);});else{if(_0x593268[_0xdbea30(0x2ed)]>0x1){let _0x3f7e77=[],_0x3998a5=[];const _0x401305=_0x593268[_0xdbea30(0x2ed)]%0x4==0x0||_0x593268[_0xdbea30(0x2ed)]%0x4==0x3||_0x593268['length']%0x3==0x1?0x4:0x3;let _0x412f0d=0x0;_0x593268[_0xdbea30(0x2f2)]((_0x190764,_0x43ecea)=>{const _0x126ed1=_0xdbea30;if(_0x43ecea%_0x401305==0x0)_0x3998a5=[];_0x3998a5[_0x126ed1(0x341)]({'text':_0x126ed1(0x30f)+_0x190764[_0x126ed1(0x319)],'callback_data':_0x190764[_0x126ed1(0x319)]}),_0x43ecea%_0x401305==0x0&&(_0x3f7e77[_0x412f0d]=_0x3998a5,_0x412f0d++);}),tgBot[_0xdbea30(0x2e6)](_0x34990d[_0xdbea30(0x2dc)]['id'],_0xdbea30(0x293),{'reply_markup':{'inline_keyboard':_0x3f7e77}})[_0xdbea30(0x31f)](_0x3e85e0=>{telegramError(_0x3e85e0);}),tgBot['on']('callback_query',async _0x5e3542=>{const _0x3bbea7=_0xdbea30,_0x3538b2=_0x5e3542[_0x3bbea7(0x372)],_0x209629=_0x5e3542[_0x3bbea7(0x2d1)];tgBot['answerCallbackQuery'](_0x5e3542['id'])['then'](async()=>{const _0x4ac74d=_0x3bbea7;if(pid[_0x3538b2])pid[_0x3538b2][_0x4ac74d(0x39c)]({'function':_0x4ac74d(0x27d),'args':null});}),tgBot[_0x3bbea7(0x22f)](_0x3bbea7(0x2eb));});}else{const _0x3c9c4c=_0x593268[0x0][_0xdbea30(0x319)];if(pid[_0x3c9c4c])pid[_0x3c9c4c][_0xdbea30(0x39c)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x22b095(0x327)](/\/portfolio/,_0x4f234b=>{const _0x35b86a=_0x22b095;if(!validateTelegram(_0x4f234b))return;tgBot[_0x35b86a(0x22f)](_0x35b86a(0x2eb));const _0x43e1e0=getEnabledBots();if(_0x43e1e0[_0x35b86a(0x2ed)]==0x0)tgBot[_0x35b86a(0x2e6)](_0x4f234b['chat']['id'],_0x35b86a(0x254))[_0x35b86a(0x31f)](_0x43ea7a=>{telegramError(_0x43ea7a);});else{if(_0x43e1e0[_0x35b86a(0x2ed)]>0x1){let _0x2bac94=[],_0x213d94=[];const _0x5088dc=_0x43e1e0[_0x35b86a(0x2ed)]%0x4==0x0||_0x43e1e0[_0x35b86a(0x2ed)]%0x4==0x3||_0x43e1e0[_0x35b86a(0x2ed)]%0x3==0x1?0x4:0x3;let _0xb858cc=0x0;_0x43e1e0[_0x35b86a(0x2f2)]((_0x41be02,_0x5d6446)=>{const _0x3e7b91=_0x35b86a;if(_0x5d6446%_0x5088dc==0x0)_0x213d94=[];_0x213d94['push']({'text':_0x3e7b91(0x30f)+_0x41be02['botID'],'callback_data':_0x41be02[_0x3e7b91(0x319)]}),_0x5d6446%_0x5088dc==0x0&&(_0x2bac94[_0xb858cc]=_0x213d94,_0xb858cc++);}),tgBot['sendMessage'](_0x4f234b[_0x35b86a(0x2dc)]['id'],_0x35b86a(0x244),{'reply_markup':{'inline_keyboard':_0x2bac94}})['catch'](_0x20edc6=>{telegramError(_0x20edc6);}),tgBot['on'](_0x35b86a(0x2eb),async _0x348b62=>{const _0x2c0763=_0x35b86a,_0x3a4d03=_0x348b62[_0x2c0763(0x372)],_0x4da8da=_0x348b62['message'];tgBot['answerCallbackQuery'](_0x348b62['id'])[_0x2c0763(0x399)](async()=>{const _0x5a5627=_0x2c0763;if(pid[_0x3a4d03])pid[_0x3a4d03][_0x5a5627(0x39c)]({'function':_0x5a5627(0x239),'args':null});}),tgBot[_0x2c0763(0x22f)](_0x2c0763(0x2eb));});}else{const _0x5c07aa=_0x43e1e0[0x0][_0x35b86a(0x319)];if(pid[_0x5c07aa])pid[_0x5c07aa]['send']({'function':_0x35b86a(0x239),'args':null});}}}),tgBot[_0x22b095(0x327)](/\/update/,async _0x4d7a74=>{const _0x338330=_0x22b095;if(!validateTelegram(_0x4d7a74))return;tgBot[_0x338330(0x22f)](_0x338330(0x2eb)),await getMessages();if(!updateAvailable)tgBot[_0x338330(0x2e6)](_0x4d7a74[_0x338330(0x2dc)]['id'],_0x338330(0x2ac))[_0x338330(0x31f)](_0x346456=>{telegramError(_0x346456);});else!validInstallation?tgBot[_0x338330(0x2e6)](_0x4d7a74['chat']['id'],_0x338330(0x335))[_0x338330(0x31f)](_0x1a4f78=>{telegramError(_0x1a4f78);}):(tgBot[_0x338330(0x2e6)](_0x4d7a74['chat']['id'],_0x338330(0x278),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x338330(0x358)},{'text':'No','callback_data':'no'}]]}})[_0x338330(0x31f)](_0x9b5deb=>{telegramError(_0x9b5deb);}),tgBot['on']('callback_query',async _0x4d77e4=>{const _0x1a93c7=_0x338330,_0x21b93e=_0x4d77e4[_0x1a93c7(0x372)],_0x5885a8=_0x4d77e4[_0x1a93c7(0x2d1)];tgBot['answerCallbackQuery'](_0x4d77e4['id'])[_0x1a93c7(0x399)](async()=>{const _0xb3cf16=_0x1a93c7;_0x21b93e=='yes'&&(await tgBot[_0xb3cf16(0x2e6)](_0x5885a8[_0xb3cf16(0x2dc)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0xb3cf16(0x31f)](_0x3e1dbf=>{telegramError(_0x3e1dbf);}),updateBB(_0xb3cf16(0x325))),_0x21b93e=='no'&&await tgBot[_0xb3cf16(0x2e6)](_0x5885a8[_0xb3cf16(0x2dc)]['id'],_0xb3cf16(0x32f))['catch'](_0xbc2a57=>{telegramError(_0xbc2a57);});}),tgBot[_0x1a93c7(0x22f)](_0x1a93c7(0x2eb));}));}),tgBot['onText'](/\/reinstall/,async _0x2d7c4b=>{const _0x4a0363=_0x22b095;if(!validateTelegram(_0x2d7c4b))return;tgBot[_0x4a0363(0x22f)](_0x4a0363(0x2eb)),!validInstallation?tgBot[_0x4a0363(0x2e6)](_0x2d7c4b[_0x4a0363(0x2dc)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x4a0363(0x31f)](_0x44a6eb=>{telegramError(_0x44a6eb);}):(tgBot['sendMessage'](_0x2d7c4b['chat']['id'],_0x4a0363(0x28b),{'reply_markup':{'inline_keyboard':[[{'text':_0x4a0363(0x33d),'callback_data':_0x4a0363(0x358)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x5053c5=>{telegramError(_0x5053c5);}),tgBot['on'](_0x4a0363(0x2eb),async _0x107424=>{const _0x42159f=_0x4a0363,_0x2031d2=_0x107424['data'],_0x1b321b=_0x107424['message'];tgBot[_0x42159f(0x2e9)](_0x107424['id'])[_0x42159f(0x399)](async()=>{const _0x1fb755=_0x42159f;_0x2031d2==_0x1fb755(0x358)&&(await tgBot['sendMessage'](_0x1b321b[_0x1fb755(0x2dc)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x1fb755(0x31f)](_0x2cc347=>{telegramError(_0x2cc347);}),updateBB(_0x1fb755(0x264))),_0x2031d2=='no'&&await tgBot[_0x1fb755(0x2e6)](_0x1b321b['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x1fb755(0x31f)](_0x3b23e0=>{telegramError(_0x3b23e0);});}),tgBot[_0x42159f(0x22f)](_0x42159f(0x2eb));}));}),tgBot[_0x22b095(0x327)](/\/toggle/,_0x2096f3=>{const _0x25bac8=_0x22b095;if(!validateTelegram(_0x2096f3))return;tgBot[_0x25bac8(0x22f)](_0x25bac8(0x2eb));const _0x279281=getBotsWithMode();if(_0x279281[_0x25bac8(0x2ed)]==0x0)tgBot['sendMessage'](_0x2096f3[_0x25bac8(0x2dc)]['id'],_0x25bac8(0x254))['catch'](_0x358204=>{telegramError(_0x358204);});else{let _0x10c2a8=[],_0x101519=[];const _0x3d8d01=0x2;let _0x4c565e=0x0;_0x279281['forEach']((_0x599de5,_0x2b8b16)=>{const _0x3e6444=_0x25bac8;if(_0x2b8b16%_0x3d8d01==0x0)_0x101519=[];_0x101519[_0x3e6444(0x341)]({'text':_0x3e6444(0x30f)+_0x599de5['botID']+'\x20('+_0x599de5['mode']+')','callback_data':_0x599de5[_0x3e6444(0x319)]}),_0x2b8b16%_0x3d8d01==0x0&&(_0x10c2a8[_0x4c565e]=_0x101519,_0x4c565e++);}),tgBot[_0x25bac8(0x2e6)](_0x2096f3[_0x25bac8(0x2dc)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x10c2a8}})[_0x25bac8(0x31f)](_0x440efe=>{telegramError(_0x440efe);}),tgBot['on'](_0x25bac8(0x2eb),async _0x1d934d=>{const _0x3c2378=_0x25bac8,_0x38a996=_0x1d934d[_0x3c2378(0x372)],_0x5bfadc=_0x1d934d[_0x3c2378(0x2d1)];tgBot['answerCallbackQuery'](_0x1d934d['id'])['then'](async()=>{const _0x2d7a25=_0x3c2378,_0x3f6b2c=_0x279281['find'](_0x1f188f=>_0x1f188f['botID']==_0x38a996),_0x50adf8=_0x3f6b2c[_0x2d7a25(0x241)]==_0x2d7a25(0x382)?_0x2d7a25(0x306):_0x2d7a25(0x382);tgBot[_0x2d7a25(0x2e6)](_0x5bfadc['chat']['id'],_0x2d7a25(0x38e)+_0x38a996+_0x2d7a25(0x280)+_0x50adf8+_0x2d7a25(0x3ab))[_0x2d7a25(0x31f)](_0x4f3a5a=>{telegramError(_0x4f3a5a);}),toggleBotMode(_0x38a996);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x22b095(0x327)](/\/names/,_0xe933e3=>{const _0x38b71a=_0x22b095;if(!validateTelegram(_0xe933e3))return;let _0xe26550='';config['forEach'](_0x5c8bc2=>{_0xe26550+='Bot\x20'+_0x5c8bc2['botID']+':\x20'+_0x5c8bc2['botname']+'\x0a';}),tgBot[_0x38b71a(0x2e6)](_0xe933e3[_0x38b71a(0x2dc)]['id'],_0xe26550,{'parse_mode':'HTML'})['catch'](_0x363568=>{telegramError(_0x363568);});}),tgBot[_0x22b095(0x327)](/\/disable/,_0x156fc7=>{const _0x21da6a=_0x22b095;if(!validateTelegram(_0x156fc7))return;tgBot[_0x21da6a(0x2e6)](_0x156fc7[_0x21da6a(0x2dc)]['id'],_0x21da6a(0x33c))[_0x21da6a(0x31f)](_0x48ca46=>{telegramError(_0x48ca46);}),updateSetting(_0x21da6a(0x304),![]);}),tgBot[_0x22b095(0x327)](/\/help/,_0x2ebd11=>{const _0x4cfae6=_0x22b095;if(!validateTelegram(_0x2ebd11))return;tgBot['sendMessage'](_0x2ebd11[_0x4cfae6(0x2dc)]['id'],_0x183d01)['catch'](_0x896938=>{telegramError(_0x896938);});}),tgBot['on'](_0x22b095(0x28e),_0x45da4c=>{const _0x80fc06=_0x22b095;_0x45da4c[_0x80fc06(0x371)]()[_0x80fc06(0x271)](_0x80fc06(0x2ad))&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x80fc06(0x208)](),tgBot=null,io['to']('botmanager')['emit']('notification',_0x80fc06(0x373)));}),process[_0x22b095(0x1ef)](_0x22b095(0x39e),()=>{const _0x21626a=_0x22b095;if(tgBot)tgBot[_0x21626a(0x208)]();process[_0x21626a(0x36d)](0x1);}),process[_0x22b095(0x1ef)](_0x22b095(0x36e),()=>{const _0x954feb=_0x22b095;if(tgBot)tgBot[_0x954feb(0x208)]();process[_0x954feb(0x36d)](0x1);});}}function disableTelegram(){const _0x3f37e2=_0x5c7b80;tgBot&&(tgBot[_0x3f37e2(0x208)](),tgBot=null);}function sendTelegram(_0x25f985,_0x37fa9){const _0x557619=_0x5c7b80;if(settings['telegramEnabled']){if(settings[_0x557619(0x2f0)]==_0x557619(0x283)||(_0x37fa9['type']==_0x557619(0x25d)||_0x37fa9['type']=='warning'||_0x37fa9[_0x557619(0x217)]==_0x557619(0x2e3))&&settings[_0x557619(0x2f0)]==_0x557619(0x2e2)||_0x37fa9[_0x557619(0x217)]=='order'&&settings[_0x557619(0x2f0)]==_0x557619(0x1f7)){if(tgBot&&settings[_0x557619(0x2e1)]){if(_0x37fa9[_0x557619(0x3a8)])tgBot[_0x557619(0x2e6)](settings[_0x557619(0x2e1)],_0x37fa9[_0x557619(0x32b)]+'\x20>\x20'+_0x37fa9[_0x557619(0x28c)])[_0x557619(0x31f)](_0x3c61a1=>{telegramError(_0x3c61a1);});else tgBot['sendMessage'](settings[_0x557619(0x2e1)],_0x557619(0x30f)+_0x25f985+'\x20>\x20'+_0x37fa9[_0x557619(0x28c)])['catch'](_0x4e6924=>{telegramError(_0x4e6924);});}}}}async function sendTelegramMsg(_0x2afc41,_0x338099=_0x5c7b80(0x235)){const _0x340131=_0x5c7b80;return settings[_0x340131(0x304)]&&tgBot&&settings[_0x340131(0x2e1)]?(await tgBot[_0x340131(0x2e6)](settings[_0x340131(0x2e1)],_0x2afc41,{'parse_mode':_0x338099})[_0x340131(0x31f)](_0x2f318e=>{telegramError(_0x2f318e);}),!![]):![];}function getDeviceWithIp(_0x4775ae){return devices['find'](_0x378506=>_0x378506['ip']===_0x4775ae);}function temporaryAccess2FA(_0x22bd1d,_0x415bfd){const _0x539f2b=_0x5c7b80;let _0x3344b2=new Date(),_0x2cbbf9=![];if(lastIpApproval){if(_0x3344b2-lastIpApproval<0x1388)_0x2cbbf9=!![];}lastIpApproval=new Date();if(_0x2cbbf9)return;tgBot&&settings[_0x539f2b(0x2e1)]&&(tgBot[_0x539f2b(0x22f)](_0x539f2b(0x2eb)),tgBot[_0x539f2b(0x2e6)](settings[_0x539f2b(0x2e1)],_0x539f2b(0x307)+normalizeIP(_0x415bfd)[_0x539f2b(0x2bb)]+_0x539f2b(0x279),{'parse_mode':_0x539f2b(0x235),'reply_markup':{'inline_keyboard':[[{'text':_0x539f2b(0x249),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x539f2b(0x2ee),'callback_data':_0x539f2b(0x2ee)}]]}})[_0x539f2b(0x31f)](_0x10f2c6=>{telegramError(_0x10f2c6);}),tgBot['on']('callback_query',async _0x1b0354=>{const _0x35b60b=_0x539f2b,_0x19b572=_0x1b0354[_0x35b60b(0x372)],_0x489aba=_0x1b0354['message'];tgBot[_0x35b60b(0x2e9)](_0x1b0354['id'])[_0x35b60b(0x399)](async()=>{const _0x16bb72=_0x35b60b;devices[_0x22bd1d]['telegramIpApproval']={'clientip':_0x415bfd,'timestamp':new Date()[_0x16bb72(0x2e4)](),'expiry':_0x19b572},_0x19b572!=_0x16bb72(0x2ee)?(await tgBot[_0x16bb72(0x2e6)](_0x489aba[_0x16bb72(0x2dc)]['id'],'Access\x20enabled\x20for\x20'+_0x19b572+_0x16bb72(0x2ce),{'parse_mode':_0x16bb72(0x235)})[_0x16bb72(0x31f)](_0x374067=>{telegramError(_0x374067);}),io['to'](_0x22bd1d)['emit'](_0x16bb72(0x345),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x489aba[_0x16bb72(0x2dc)]['id'],_0x16bb72(0x33f))['catch'](_0x11fd86=>{telegramError(_0x11fd86);}),io['to'](_0x22bd1d)[_0x16bb72(0x3ad)](_0x16bb72(0x345),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x35b60b(0x22f)](_0x35b60b(0x2eb));}));}function loginAccess2FA(_0x4093e1,_0x4e6162){const _0x316cb0=_0x5c7b80;tgBot&&settings[_0x316cb0(0x2e1)]&&(tgBot[_0x316cb0(0x22f)](_0x316cb0(0x2eb)),tgBot[_0x316cb0(0x2e6)](settings[_0x316cb0(0x2e1)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x4e6162)[_0x316cb0(0x2bb)]+_0x316cb0(0x279),{'parse_mode':_0x316cb0(0x235),'reply_markup':{'inline_keyboard':[[{'text':_0x316cb0(0x3b5),'callback_data':loginExpiry},{'text':_0x316cb0(0x2ee),'callback_data':_0x316cb0(0x2ee)}]]}})[_0x316cb0(0x31f)](_0x2510c2=>{telegramError(_0x2510c2);}),tgBot['on']('callback_query',async _0x486d0d=>{const _0x38ad37=_0x316cb0,_0xfa0767=_0x486d0d[_0x38ad37(0x372)],_0x3a0ceb=_0x486d0d['message'];tgBot['answerCallbackQuery'](_0x486d0d['id'])[_0x38ad37(0x399)](async()=>{const _0x1ccc90=_0x38ad37;devices[_0x4093e1]['telegram2FaApproval']={'clientip':_0x4e6162,'timestamp':new Date()[_0x1ccc90(0x2e4)](),'expiry':_0xfa0767},_0xfa0767!=_0x1ccc90(0x2ee)?(await tgBot[_0x1ccc90(0x2e6)](_0x3a0ceb['chat']['id'],_0x1ccc90(0x3b8),{'parse_mode':_0x1ccc90(0x235)})['catch'](_0x27a228=>{telegramError(_0x27a228);}),io['to'](_0x4093e1)[_0x1ccc90(0x3ad)](_0x1ccc90(0x345),{'access':{'allow':![],'reason':_0x1ccc90(0x2b6),'token':null}})):(await tgBot[_0x1ccc90(0x2e6)](_0x3a0ceb[_0x1ccc90(0x2dc)]['id'],_0x1ccc90(0x22b))[_0x1ccc90(0x31f)](_0x4c29dd=>{telegramError(_0x4c29dd);}),io['to'](_0x4093e1)[_0x1ccc90(0x3ad)](_0x1ccc90(0x345),{'access':{'allow':![],'reason':_0x1ccc90(0x377),'token':null}}));}),tgBot[_0x38ad37(0x22f)](_0x38ad37(0x2eb));}));}function _0x2dc7(_0x53e631,_0x49dca8){const _0x2ee40e=_0x21b9();return _0x2dc7=function(_0x14f986,_0x9cccfc){_0x14f986=_0x14f986-0x1e9;let _0x21b9f1=_0x2ee40e[_0x14f986];return _0x21b9f1;},_0x2dc7(_0x53e631,_0x49dca8);}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1d9018=_0x5c7b80;return dbConfig[_0x1d9018(0x322)](_0x1d9018(0x3bb))['sortBy'](_0x1d9018(0x319))['filter']({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x4047cc=_0x5c7b80;return dbConfig[_0x4047cc(0x322)](_0x4047cc(0x3bb))[_0x4047cc(0x20e)]('botID')[_0x4047cc(0x250)]({'status':'disabled'})[_0x4047cc(0x2f7)]()||[];}function getBotAttributes(_0x216746){const _0x437f97=_0x5c7b80;let _0x49f996={};const _0x434e8c=configpath+_0x437f97(0x242)+_0x216746+'-config.json',_0x2ef775=fs[_0x437f97(0x3b7)](_0x434e8c);if(_0x2ef775){const _0x171efe=fs[_0x437f97(0x3c8)](_0x434e8c);try{const _0x346ad3=JSON['parse'](_0x171efe),_0x2eb30d=_0x346ad3?_0x346ad3['bot'][0x0][_0x437f97(0x32d)]:![];_0x49f996[_0x437f97(0x241)]=_0x2eb30d?_0x437f97(0x382):'manual',_0x49f996[_0x437f97(0x32b)]=_0x346ad3?_0x346ad3['bot'][0x0][_0x437f97(0x32b)]:_0x437f97(0x30f)+_0x216746;}catch(_0xed9608){_0x49f996[_0x437f97(0x241)]=_0x437f97(0x306),_0x49f996[_0x437f97(0x32b)]='Bot\x20'+_0x216746;}}else _0x49f996['mode']=_0x437f97(0x306),_0x49f996[_0x437f97(0x32b)]=_0x437f97(0x30f)+_0x216746;return _0x49f996;}function getBotsWithMode(){const _0x2577db=_0x5c7b80,_0x27125f=dbConfig[_0x2577db(0x322)](_0x2577db(0x3bb))[_0x2577db(0x20e)](_0x2577db(0x319))[_0x2577db(0x2f7)]()||[];return _0x27125f[_0x2577db(0x2f2)](_0x5776ae=>{const _0x5075b7=_0x2577db;let _0x350502=getBotAttributes(_0x5776ae[_0x5075b7(0x319)]);_0x5776ae[_0x5075b7(0x241)]=_0x350502[_0x5075b7(0x241)];}),_0x27125f;}function getBotExchanges(){const _0x571b62=_0x5c7b80;let _0x1364fa=[];const _0x488a86=dbConfig['get'](_0x571b62(0x3bb))[_0x571b62(0x20e)]('botID')[_0x571b62(0x2f7)]()||[];_0x488a86[_0x571b62(0x2f2)](_0x572156=>{const _0x2f34ac=_0x571b62;if(_0x572156[_0x2f34ac(0x345)]=='enabled'){const _0x142307=configpath+_0x2f34ac(0x242)+_0x572156[_0x2f34ac(0x319)]+_0x2f34ac(0x3b9),_0x968253=fs[_0x2f34ac(0x3b7)](_0x142307);let _0x4fb082;if(_0x968253){const _0x232fa1=fs[_0x2f34ac(0x3c8)](_0x142307);try{const _0x4abf48=JSON[_0x2f34ac(0x3a3)](_0x232fa1);_0x4fb082=_0x4abf48?_0x4abf48[_0x2f34ac(0x2be)][0x0]['exchange']:null;}catch(_0x51a9ff){}}if(_0x4fb082)_0x1364fa['push'](_0x4fb082);}});const _0x4618a8=[...new Set(_0x1364fa)][_0x571b62(0x1fd)]();return _0x4618a8;}async function initUser(){const _0x292cbf=_0x5c7b80;if(!settings[_0x292cbf(0x243)]){const _0x30c561=uuidRandom();mixpanel[_0x292cbf(0x2b4)](_0x30c561),updateSetting(_0x292cbf(0x243),_0x30c561);}}async function initSecure(){const _0x3582b4=_0x5c7b80;let _0xf8b6db=getSecure();if(!_0xf8b6db['hasOwnProperty'](_0x3582b4(0x276))){let _0x1cd7fe=await generateKeys();_0xf8b6db[_0x3582b4(0x21e)]=_0x1cd7fe['publicKey'],_0xf8b6db[_0x3582b4(0x352)]=_0x1cd7fe['privateKey'],_0xf8b6db[_0x3582b4(0x276)]=crypto['randomBytes'](0x20)[_0x3582b4(0x371)](_0x3582b4(0x369));;storeSecure(_0xf8b6db);}}function getSettings(){const _0x4d5288=_0x5c7b80;return dbSettings[_0x4d5288(0x322)](_0x4d5288(0x1f6))['value']()||{};}function getSecure(){const _0x38144a=_0x5c7b80;return dbSecure[_0x38144a(0x322)](_0x38144a(0x296))[_0x38144a(0x2f7)]()||{};}function getBlacklist(){const _0x4b3a50=_0x5c7b80;return dbSecure[_0x4b3a50(0x322)](_0x4b3a50(0x20a))[_0x4b3a50(0x2f7)]()||[];}function broadcastToBots(_0x3344b5,_0x35d870){config['forEach'](_0x45afad=>{const _0x44171a=_0x2dc7;if(_0x45afad['status']==_0x44171a(0x2e8)&&_0x45afad[_0x44171a(0x38c)]==_0x44171a(0x2d8)||_0x45afad['status']=='new'&&_0x45afad[_0x44171a(0x38c)]==_0x44171a(0x2d8)){if(pid[_0x45afad[_0x44171a(0x319)]])pid[_0x45afad[_0x44171a(0x319)]][_0x44171a(0x39c)]({[_0x3344b5]:_0x35d870});}});}function storeSettings(_0xd087f8,_0x63aba6=![]){const _0x3cef25=_0x5c7b80;_0xd087f8={...settings,..._0xd087f8};if(_0x63aba6&&_0xd087f8[_0x3cef25(0x292)]!=_0x3cef25(0x31d)&&_0xd087f8[_0x3cef25(0x292)]!=_0x3cef25(0x375)&&_0xd087f8['bbPassword']!=''){const _0x2d32cb=crypt[_0x3cef25(0x393)](secure[_0x3cef25(0x352)],_0xd087f8[_0x3cef25(0x292)])[_0x3cef25(0x2d1)][_0x3cef25(0x287)]('@')[0x0],_0x2f0d70=bcrypt[_0x3cef25(0x2a1)](_0x2d32cb,saltRounds);_0xd087f8={..._0xd087f8,'bbPassword':_0x2f0d70};}if(_0x63aba6&&_0xd087f8[_0x3cef25(0x2fd)]!='************'&&_0xd087f8[_0x3cef25(0x2fd)]!=_0x3cef25(0x375)&&_0xd087f8['telegramToken']!=''){const _0x4e3b87=crypt[_0x3cef25(0x393)](secure[_0x3cef25(0x352)],_0xd087f8[_0x3cef25(0x2fd)])[_0x3cef25(0x2d1)]['split']('@')[0x0];_0xd087f8={..._0xd087f8,'telegramToken':_0x4e3b87};}const _0x2ddccd=_0xd087f8[_0x3cef25(0x2fd)]!=_0x3cef25(0x31d)&&_0xd087f8[_0x3cef25(0x2fd)]!=settings[_0x3cef25(0x2fd)]||_0xd087f8['telegramUsername']!=settings[_0x3cef25(0x25f)],_0x29a26c=_0xd087f8[_0x3cef25(0x2fd)]==''||_0xd087f8[_0x3cef25(0x25f)]=='';if(_0x2ddccd)_0xd087f8['telegramEvents']=_0x3cef25(0x283);for(const [_0x589012,_0x1d24c5]of Object[_0x3cef25(0x265)](_0xd087f8)){if(_0x589012=='telegramToken'&&_0x1d24c5=='************'){_0xd087f8[_0x3cef25(0x2fd)]=settings['telegramToken'];continue;};if(_0x589012=='bbPassword'&&_0x1d24c5=='************'){_0xd087f8[_0x3cef25(0x292)]=settings[_0x3cef25(0x292)];continue;};dbSettings['set'](_0x3cef25(0x36c)+_0x589012,_0x1d24c5)[_0x3cef25(0x2f8)]();}settings=_0xd087f8,io['to'](_0x3cef25(0x20f))['emit'](_0x3cef25(0x1f6),cleanSettings()),broadcastToBots(_0x3cef25(0x212),settings[_0x3cef25(0x212)]),broadcastToBots('onepagemode',settings[_0x3cef25(0x355)]);if(_0x2ddccd&&!_0x29a26c)initTelegram();if(_0x2ddccd&&_0x29a26c)disableTelegram();getAllClients()[_0x3cef25(0x2f2)](_0x38c08f=>{const _0x4a3579=_0x3cef25;getSocket(_0x38c08f['id'])['emit'](_0x4a3579(0x345),{'access':{'allow':![],'reason':_0x4a3579(0x2b6),'token':null}});});}function updateSetting(_0x12cc1c,_0x19449c){const _0x29561e=_0x5c7b80;dbSettings[_0x29561e(0x20b)](_0x29561e(0x36c)+_0x12cc1c,_0x19449c)[_0x29561e(0x2f8)](),settings=getSettings(),io['to']('botmanager')[_0x29561e(0x3ad)](_0x29561e(0x1f6),cleanSettings());}function storeSecure(_0x18ecbf){const _0x505a6d=_0x5c7b80;dbSecure['get']('secure')[_0x505a6d(0x341)](_0x18ecbf)[_0x505a6d(0x2f8)](),secure=_0x18ecbf;}function addBlacklist(_0x2e3aa1){const _0x3ed7ae=_0x5c7b80;cleanBlacklist();let _0x355951;devices[_0x2e3aa1][_0x3ed7ae(0x3c9)]?_0x355951=Math['max'](devices[_0x2e3aa1][_0x3ed7ae(0x3c9)][_0x3ed7ae(0x238)],loginExpiry):_0x355951=loginExpiry,dbSecure[_0x3ed7ae(0x322)](_0x3ed7ae(0x20a))[_0x3ed7ae(0x341)]({'expiry':new Date()[_0x3ed7ae(0x2e4)]()+_0x355951*0x3c*0x3e8,'token':devices[_0x2e3aa1][_0x3ed7ae(0x2a2)][_0x3ed7ae(0x22e)]})[_0x3ed7ae(0x2f8)](),blacklist=dbSecure[_0x3ed7ae(0x322)](_0x3ed7ae(0x20a))[_0x3ed7ae(0x2f7)]();}function cleanBlacklist(){const _0x5b147d=_0x5c7b80;let _0x164e73=dbSecure[_0x5b147d(0x322)](_0x5b147d(0x20a))[_0x5b147d(0x23d)]()[_0x5b147d(0x2f7)](),_0x50fc80=new Date()[_0x5b147d(0x2e4)]();_0x164e73[_0x5b147d(0x2f2)](_0x453025=>{const _0x51732f=_0x5b147d;_0x453025[_0x51732f(0x238)]<_0x50fc80&&dbSecure[_0x51732f(0x322)](_0x51732f(0x20a))[_0x51732f(0x356)]({'expiry':_0x453025['expiry']})['write']();});}function initStates(){const _0x1a0522=_0x5c7b80;let _0x305d62=getConfiguration();_0x305d62[_0x1a0522(0x2f2)](_0x21bef8=>{const _0x2daf16=_0x1a0522;_0x21bef8['live']=_0x2daf16(0x344);}),storeConfiguration(_0x305d62);}function onKeys(){const _0xcbcdbc=new RSA();return new Promise(_0x5cb173=>{const _0x36e070=_0x2dc7;_0xcbcdbc[_0x36e070(0x33e)]()[_0x36e070(0x399)](_0x1c5798=>{_0x5cb173(_0x1c5798);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x47af7d=_0x5c7b80;let _0x46a25a=getSettings(),_0x43df1f=![];!_0x46a25a['hasOwnProperty'](_0x47af7d(0x315))&&(_0x46a25a[_0x47af7d(0x315)]=0x0,_0x43df1f=!![]);!_0x46a25a[_0x47af7d(0x391)]('lastmsgemitted')&&(_0x46a25a['lastmsgemitted']=0x0,_0x43df1f=!![]);!_0x46a25a[_0x47af7d(0x391)](_0x47af7d(0x289))&&(_0x46a25a[_0x47af7d(0x289)]=_0x47af7d(0x34c),_0x43df1f=!![]);!_0x46a25a['hasOwnProperty'](_0x47af7d(0x355))&&(_0x46a25a[_0x47af7d(0x355)]=![],_0x43df1f=!![]);if(_0x43df1f)storeSettings(_0x46a25a);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x47af7d(0x2f2)](_0x3bd16b=>{const _0x2dd5fe=_0x47af7d;if(!_0x3bd16b[_0x2dd5fe(0x2bf)]()){if(!_0x3bd16b[_0x2dd5fe(0x259)][_0x2dd5fe(0x222)]('backup-full@'))fs[_0x2dd5fe(0x1ee)](configbackuppath+_0x3bd16b['name']);}else fs[_0x2dd5fe(0x35a)](configbackuppath+_0x3bd16b[_0x2dd5fe(0x259)],{'recursive':!![]});});}catch(_0xe69d22){logger['debug'](_0x47af7d(0x3bc),_0xe69d22);}}function storeConfiguration(_0x83320e){const _0x427b94=_0x5c7b80;dbConfig[_0x427b94(0x322)](_0x427b94(0x3bb))[_0x427b94(0x356)]()[_0x427b94(0x2f8)](),_0x83320e['forEach'](_0x1bad7c=>{const _0x95da81=_0x427b94;delete _0x1bad7c[_0x95da81(0x241)];}),dbConfig[_0x427b94(0x322)](_0x427b94(0x3bb))[_0x427b94(0x341)](..._0x83320e)[_0x427b94(0x2f8)](),config=_0x83320e;}function resetPassword(){const _0xc0e39e=_0x5c7b80;tgBot&&settings[_0xc0e39e(0x2e1)]&&(tgBot['removeListener'](_0xc0e39e(0x2eb)),tgBot[_0xc0e39e(0x2e6)](settings[_0xc0e39e(0x2e1)],_0xc0e39e(0x361),{'parse_mode':_0xc0e39e(0x235),'reply_markup':{'inline_keyboard':[[{'text':_0xc0e39e(0x358),'callback_data':_0xc0e39e(0x358)},{'text':'no','callback_data':'no'}]]}})[_0xc0e39e(0x31f)](_0x2880c3=>{telegramError(_0x2880c3);}),tgBot['on'](_0xc0e39e(0x2eb),async _0x320724=>{const _0xa3614a=_0xc0e39e,_0x578b03=_0x320724['data'],_0x44c73c=_0x320724['message'];tgBot[_0xa3614a(0x2e9)](_0x320724['id'])['then'](async()=>{const _0x5e433b=_0xa3614a;if(_0x578b03!='no'){const _0xa3e411=0xf,_0x3b2dde=_0x5e433b(0x324),_0x4d2845=Array[_0x5e433b(0x262)](crypto['randomFillSync'](new Uint32Array(_0xa3e411)))[_0x5e433b(0x2d4)](_0x13a6ea=>_0x3b2dde[_0x13a6ea%_0x3b2dde[_0x5e433b(0x2ed)]])[_0x5e433b(0x284)](''),_0xe9acb7=bcrypt[_0x5e433b(0x2a1)](_0x4d2845,saltRounds);storeSettings({'bbPassword':_0xe9acb7}),await tgBot['sendMessage'](_0x44c73c['chat']['id'],_0x5e433b(0x302)+_0x4d2845,{'parse_mode':_0x5e433b(0x235)})[_0x5e433b(0x31f)](_0x3d9e6d=>{telegramError(_0x3d9e6d);});}else await tgBot[_0x5e433b(0x2e6)](_0x44c73c[_0x5e433b(0x2dc)]['id'],'Password\x20reset\x20rejected')[_0x5e433b(0x31f)](_0x14b393=>{telegramError(_0x14b393);});}),tgBot[_0xa3614a(0x22f)]('callback_query');}));}async function confirmRestore(_0x3ae8c0,_0x34b4e6){const _0x17fbf9=_0x5c7b80;io['to'](_0x17fbf9(0x20f))['emit']('notification',_0x17fbf9(0x27a),_0x17fbf9(0x2e3)),tgBot&&settings[_0x17fbf9(0x2e1)]&&(tgBot[_0x17fbf9(0x22f)]('callback_query'),await tgBot[_0x17fbf9(0x2e6)](settings[_0x17fbf9(0x2e1)],_0x17fbf9(0x397),{'parse_mode':_0x17fbf9(0x235),'reply_markup':{'inline_keyboard':[[{'text':_0x17fbf9(0x358),'callback_data':_0x17fbf9(0x358)},{'text':'no','callback_data':'no'}]]}})[_0x17fbf9(0x31f)](_0x196e22=>{telegramError(_0x196e22);}),tgBot['on']('callback_query',async _0x19886d=>{const _0x47917f=_0x17fbf9,_0x36131c=_0x19886d[_0x47917f(0x372)],_0x33fb49=_0x19886d[_0x47917f(0x2d1)];tgBot[_0x47917f(0x2e9)](_0x19886d['id'])[_0x47917f(0x399)](async()=>{const _0x3eb1fb=_0x47917f;_0x36131c==_0x3eb1fb(0x358)?(await tgBot[_0x3eb1fb(0x2e6)](_0x33fb49[_0x3eb1fb(0x2dc)]['id'],_0x3eb1fb(0x2bc),{'parse_mode':_0x3eb1fb(0x235)})[_0x3eb1fb(0x31f)](_0x1d7f53=>{telegramError(_0x1d7f53);}),unzipFile(_0x3ae8c0,_0x34b4e6)):(logger[_0x3eb1fb(0x25e)](_0x3eb1fb(0x385)),await tgBot[_0x3eb1fb(0x2e6)](_0x33fb49[_0x3eb1fb(0x2dc)]['id'],_0x3eb1fb(0x385))[_0x3eb1fb(0x31f)](_0x1a940d=>{telegramError(_0x1a940d);}));}),tgBot[_0x47917f(0x22f)](_0x47917f(0x2eb));}));}function getServerTime(){const _0x5034d6=_0x5c7b80,_0x81bda8=new Date();return _0x81bda8[_0x5034d6(0x21a)]()+'/'+(_0x81bda8[_0x5034d6(0x31b)]()+0x1)[_0x5034d6(0x371)]()[_0x5034d6(0x2db)](0x2,'0')+'/'+_0x81bda8[_0x5034d6(0x321)]()[_0x5034d6(0x371)]()[_0x5034d6(0x2db)](0x2,'0')+'\x20'+_0x81bda8[_0x5034d6(0x267)]()[_0x5034d6(0x371)]()[_0x5034d6(0x2db)](0x2,'0')+':'+_0x81bda8[_0x5034d6(0x2d6)]()[_0x5034d6(0x371)]()['padStart'](0x2,'0')+':'+_0x81bda8['getSeconds']()[_0x5034d6(0x371)]()[_0x5034d6(0x2db)](0x2,'0');}function getTimeStamp(){const _0x112d89=_0x5c7b80,_0x2840ff=shiftedTime();return _0x2840ff[_0x112d89(0x21a)]()+'/'+(_0x2840ff[_0x112d89(0x31b)]()+0x1)['toString']()[_0x112d89(0x2db)](0x2,'0')+'/'+_0x2840ff[_0x112d89(0x321)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2840ff[_0x112d89(0x267)]()[_0x112d89(0x371)]()['padStart'](0x2,'0')+':'+_0x2840ff[_0x112d89(0x2d6)]()[_0x112d89(0x371)]()[_0x112d89(0x2db)](0x2,'0')+':'+_0x2840ff[_0x112d89(0x2b9)]()['toString']()[_0x112d89(0x2db)](0x2,'0');}function getCleanTimeStamp(){const _0x5b2ac2=_0x5c7b80,_0x4c7384=shiftedTime();return _0x4c7384[_0x5b2ac2(0x21a)]()+(_0x4c7384[_0x5b2ac2(0x31b)]()+0x1)[_0x5b2ac2(0x371)]()[_0x5b2ac2(0x2db)](0x2,'0')+_0x4c7384['getDate']()[_0x5b2ac2(0x371)]()['padStart'](0x2,'0')+'-'+_0x4c7384[_0x5b2ac2(0x267)]()[_0x5b2ac2(0x371)]()['padStart'](0x2,'0')+_0x4c7384[_0x5b2ac2(0x2d6)]()[_0x5b2ac2(0x371)]()[_0x5b2ac2(0x2db)](0x2,'0')+_0x4c7384[_0x5b2ac2(0x2b9)]()[_0x5b2ac2(0x371)]()[_0x5b2ac2(0x2db)](0x2,'0');}function shiftedTime(){const _0x1b822f=_0x5c7b80,_0x46ee51=new Date();let _0x18feaf=_0x46ee51;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x18feaf=fns[_0x1b822f(0x2e0)](_0x46ee51,{'hours':settings[_0x1b822f(0x212)]});return _0x18feaf;}function startScheduler(){const _0x342acb=_0x5c7b80,_0x153f9c=new Date()[_0x342acb(0x29e)](),_0x1b05e2=shiftedTime()[_0x342acb(0x267)]();_0x1b05e2==0x4&&backupConfigFiles();_0x1b05e2==0x0&&rotateLogFiles();_0x153f9c%0x6==0x0&&triggerAnalytics();_0x153f9c%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2df323){const _0x827e77=_0x5c7b80;logger[_0x827e77(0x25e)](_0x827e77(0x213)+_0x2df323);const _0x452f9c=getBotsWithMode();_0x452f9c[_0x827e77(0x2ed)]>0x0?confirmRestore(configbackuppath,_0x2df323):unzipFile(configbackuppath,_0x2df323);}async function getBackupFiles(_0x37b3a1=null){const _0x2a6527=_0x5c7b80;let _0x38709c=[],_0x4bdd31=fs[_0x2a6527(0x277)](configbackuppath,{'withFileTypes':!![]});_0x4bdd31['sort']((_0x23ab20,_0x29f05b)=>_0x23ab20[_0x2a6527(0x259)]<_0x29f05b[_0x2a6527(0x259)]?0x1:_0x29f05b[_0x2a6527(0x259)]<_0x23ab20[_0x2a6527(0x259)]?-0x1:0x0),_0x4bdd31[_0x2a6527(0x2f2)](_0x9701da=>{const _0x10b572=_0x2a6527;if(!_0x9701da[_0x10b572(0x2bf)]()&&_0x9701da['name'][_0x10b572(0x222)](_0x10b572(0x2fe))&&_0x9701da[_0x10b572(0x259)][_0x10b572(0x2a0)]('.zip')){const _0x4a8176=formatDate(fs[_0x10b572(0x1ff)](configbackuppath+_0x9701da[_0x10b572(0x259)])['mtime']);_0x38709c[_0x10b572(0x341)]({'name':_0x9701da[_0x10b572(0x259)],'mtime':_0x4a8176});}});if(_0x37b3a1)io['to'](_0x37b3a1)[_0x2a6527(0x3ad)](_0x2a6527(0x1e9),_0x38709c);else return _0x38709c;}async function backupConfigFiles(){const _0x381aff=_0x5c7b80;await zipFiles(_0x381aff(0x240));const _0x1b7f8f=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x381aff(0x360),configbackuppath+('backup-full@'+_0x1b7f8f+'.zip'));let _0x422c70=fs[_0x381aff(0x277)](configbackuppath,{'withFileTypes':!![]});_0x422c70[_0x381aff(0x1fd)]((_0x2b213c,_0x40564b)=>_0x2b213c[_0x381aff(0x259)]<_0x40564b['name']?0x1:_0x40564b['name']<_0x2b213c['name']?-0x1:0x0),_0x422c70[_0x381aff(0x2ed)]>maxBackups&&fs[_0x381aff(0x1ee)](configbackuppath+_0x422c70[_0x422c70[_0x381aff(0x2ed)]-0x1]['name']);}function rotateLogFiles(){const _0xd82a16=_0x5c7b80,_0x130e19=fs[_0xd82a16(0x1ff)](logspath+_0xd82a16(0x29a)),_0x55d75f=_0x130e19['size']/0x400;if(_0x55d75f>0x64){let _0x833869=fs[_0xd82a16(0x277)](logspath,{'withFileTypes':!![]});_0x833869[_0xd82a16(0x1fd)]((_0x543952,_0x138766)=>_0x543952['name']<_0x138766[_0xd82a16(0x259)]?0x1:_0x138766[_0xd82a16(0x259)]<_0x543952['name']?-0x1:0x0),_0x833869['forEach'](_0x4ecb04=>{const _0x55cab6=_0xd82a16;if(_0x4ecb04[_0x55cab6(0x259)]==_0x55cab6(0x3cc))fs[_0x55cab6(0x23a)](logspath+_0x4ecb04['name'],logspath+_0x55cab6(0x3b2));if(_0x4ecb04[_0x55cab6(0x259)]==_0x55cab6(0x231))fs['copyFileSync'](logspath+_0x4ecb04[_0x55cab6(0x259)],logspath+_0x55cab6(0x3cc));_0x4ecb04[_0x55cab6(0x259)]==_0x55cab6(0x29a)&&(fs[_0x55cab6(0x23a)](logspath+_0x4ecb04['name'],logspath+_0x55cab6(0x231)),fs['writeFileSync'](logspath+_0x4ecb04[_0x55cab6(0x259)],''));});}}async function zipFiles(_0x486dc7){const _0x1cec49=_0x5c7b80;let _0x17be6a;if(_0x486dc7==_0x1cec49(0x310))_0x17be6a=logspath;if(_0x486dc7=='backup')_0x17be6a=configpath;if(_0x486dc7==_0x1cec49(0x240))_0x17be6a=configpath;let _0xad39de=fs[_0x1cec49(0x277)](_0x17be6a,{'withFileTypes':!![]});const _0x214735=new require('node-zip')();_0xad39de[_0x1cec49(0x2f2)](_0x20b4e4=>{const _0x4846cd=_0x1cec49;if(!_0x20b4e4[_0x4846cd(0x2bf)]()){let _0x55df5c=fs[_0x4846cd(0x3c8)](_0x17be6a+_0x20b4e4[_0x4846cd(0x259)]);if(_0x486dc7==_0x4846cd(0x3c5)){const _0x165abf=/^bot-[0-9]{3}-config.json$/,_0x371d97=_0x165abf[_0x4846cd(0x392)](_0x20b4e4[_0x4846cd(0x259)]);if(_0x371d97){const _0x57e4cd=JSON[_0x4846cd(0x3a3)](_0x55df5c);if(_0x57e4cd['bot'][0x0]){_0x57e4cd['bot'][0x0]['apiKey']='***',_0x57e4cd[_0x4846cd(0x2be)][0x0][_0x4846cd(0x2d0)]='***';if(_0x57e4cd['bot'][0x0][_0x4846cd(0x21d)])_0x57e4cd[_0x4846cd(0x2be)][0x0][_0x4846cd(0x21d)]=_0x4846cd(0x375);}_0x55df5c=JSON[_0x4846cd(0x297)](_0x57e4cd,null,0x2);}if(_0x20b4e4['name']==_0x4846cd(0x3ca)){const _0x518273=JSON['parse'](_0x55df5c);if(_0x518273[_0x4846cd(0x1f6)][_0x4846cd(0x2ba)])_0x518273['settings']['loginRequired']=![];if(_0x518273['settings'][_0x4846cd(0x292)])_0x518273['settings'][_0x4846cd(0x292)]=_0x4846cd(0x375);if(_0x518273[_0x4846cd(0x1f6)][_0x4846cd(0x2fd)])_0x518273[_0x4846cd(0x1f6)][_0x4846cd(0x2fd)]=_0x4846cd(0x375);if(_0x518273['settings'][_0x4846cd(0x2e1)])_0x518273[_0x4846cd(0x1f6)][_0x4846cd(0x2e1)]=null;_0x55df5c=JSON[_0x4846cd(0x297)](_0x518273,null,0x2);}if(_0x20b4e4[_0x4846cd(0x259)]!=_0x4846cd(0x230))_0x214735[_0x4846cd(0x2fc)](_0x20b4e4['name'],_0x55df5c);}else _0x214735[_0x4846cd(0x2fc)](_0x20b4e4[_0x4846cd(0x259)],_0x55df5c);}});const _0x52a58a=_0x214735['generate']({'base64':![],'compression':_0x1cec49(0x2ef)});fs[_0x1cec49(0x3bf)](zippath+(_0x486dc7+_0x1cec49(0x362)),_0x52a58a,_0x1cec49(0x22a));}async function unzipFile(_0x4e88be,_0x425ffe){const _0x3a01ad=_0x5c7b80;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x4492b7=>{const _0x3b85a3=_0x2dc7;if(!_0x4492b7[_0x3b85a3(0x2bf)]())fs[_0x3b85a3(0x35a)](configpath+_0x4492b7[_0x3b85a3(0x259)]);});const _0x3c2fc9=fs['readFileSync'](_0x4e88be+_0x425ffe,'binary'),_0x5c0887=new require(_0x3a01ad(0x378))(_0x3c2fc9,{'base64':![],'checkCRC32':!![]});Object[_0x3a01ad(0x1f2)](_0x5c0887[_0x3a01ad(0x23f)])[_0x3a01ad(0x2f2)](_0x482904=>{const _0x81adfc=_0x3a01ad,_0x53ab26=_0x5c0887[_0x81adfc(0x23f)][_0x482904];fs[_0x81adfc(0x3bf)](configpath+_0x53ab26[_0x81adfc(0x259)],_0x53ab26['_data']);}),fs[_0x3a01ad(0x277)](temppath,{'withFileTypes':!![]})[_0x3a01ad(0x2f2)](_0x5845ce=>{const _0x562858=_0x3a01ad;if(!_0x5845ce[_0x562858(0x2bf)]())fs[_0x562858(0x35a)](temppath+_0x5845ce['name']);}),logger[_0x3a01ad(0x25e)](_0x3a01ad(0x346)),process[_0x3a01ad(0x39c)]({'restore':!![]},_0x59d2bf=>{});}async function getPublicIp(){const _0x401c34=_0x5c7b80;try{const _0x30fd48=await axios[_0x401c34(0x322)](_0x401c34(0x2f3));publicip=_0x30fd48[_0x401c34(0x372)]['ip'];}catch(_0x5e33a8){}}async function triggerAnalytics(){const _0x55b756=_0x5c7b80;if(!publicip)await getPublicIp();const _0x30bb58=getBotsWithMode();let _0x27f8ab=0x0;_0x30bb58['forEach'](_0x1a3d98=>{const _0x5b7e1a=_0x2dc7;if(_0x1a3d98[_0x5b7e1a(0x345)]===_0x5b7e1a(0x2e8))_0x27f8ab++;});const _0xb92d6e=getBotExchanges();mixpanel[_0x55b756(0x3ae)]('Server',{'distinct_id':settings[_0x55b756(0x243)],'ip':publicip,'version':serverversion,'numbots':_0x30bb58['length'],'numbotsenabled':_0x27f8ab,'exchanges':_0xb92d6e});}async function getMessages(){const _0x36017e=_0x5c7b80,_0x36a5d6='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x58a99a=new GraphQLClient(_0x36a5d6),_0x520ac6={'authorization':_0x36017e(0x2de)},_0x113813=serverversion[_0x36017e(0x287)]('.'),_0xfd8663=_0x113813[0x0]+'.'+_0x113813[0x1],_0x164a5f=Math['min'](settings[_0x36017e(0x315)],settings[_0x36017e(0x237)]),_0x4257ed={'last':parseInt(_0x164a5f),'bbm':_0xfd8663},_0x263739=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x189361;try{_0x189361=await _0x58a99a[_0x36017e(0x39f)](_0x263739,_0x4257ed,_0x520ac6);}catch(_0x29b9a0){}if(_0x189361&&_0x189361[_0x36017e(0x2f1)]){let _0x59e31c=settings[_0x36017e(0x315)];newMessages=[];for(const _0x34c9c5 of _0x189361[_0x36017e(0x2f1)]){newMessages[_0x36017e(0x341)](_0x34c9c5);if(_0x34c9c5[_0x36017e(0x1fe)])updateSetting(_0x36017e(0x289),_0x34c9c5[_0x36017e(0x1fe)]);let _0x3eb775=_0x34c9c5[_0x36017e(0x1fe)]?serverversion>=_0x34c9c5['bbvNew']:![];if(!_0x3eb775&&_0x34c9c5[_0x36017e(0x2b8)]>_0x59e31c){if(_0x34c9c5[_0x36017e(0x386)]===_0x36017e(0x2e7)||serverversion[_0x36017e(0x222)](_0x34c9c5[_0x36017e(0x386)])){let _0x287f43=''+_0x34c9c5[_0x36017e(0x288)]+'\x0a\x0a'+_0x34c9c5[_0x36017e(0x2d1)];const _0x2940b6=await sendTelegramMsg(toTelegramMarkdown(_0x287f43),'Markdown');if(_0x2940b6)_0x59e31c=_0x34c9c5[_0x36017e(0x2b8)];}}}updateAvailable=isNewerVersion(settings[_0x36017e(0x289)],serverversion),updateSetting(_0x36017e(0x315),_0x59e31c),emitMessages();}}function emitMessages(){const _0x1e6538=_0x5c7b80,_0x3ec5f7=settings[_0x1e6538(0x237)];let _0x561737=[];newMessages[_0x1e6538(0x2f2)](_0x31231e=>{const _0xfc59e0=_0x1e6538;_0x31231e['number']>_0x3ec5f7&&_0x561737[_0xfc59e0(0x341)](_0x31231e);}),_0x561737[_0x1e6538(0x2ed)]>0x0&&getAllClients()[_0x1e6538(0x2f2)](_0x3229e3=>{const _0xaf8620=_0x1e6538;getSocket(_0x3229e3['id'])[_0xaf8620(0x3ad)](_0xaf8620(0x2d1),_0x561737);});}function confirmMessage(_0xe47595){const _0x44fbb9=_0x5c7b80;updateSetting(_0x44fbb9(0x237),Number(_0xe47595));}function isNewerVersion(_0x56edc8,_0x45a689){const _0xdb8b6b=_0x5c7b80,_0x332b78=_0x45a689[_0xdb8b6b(0x287)]('.'),_0x57191a=_0x56edc8[_0xdb8b6b(0x287)]('.');for(var _0x219f99=0x0;_0x219f99<_0x57191a[_0xdb8b6b(0x2ed)];_0x219f99++){const _0x81ae24=~~_0x57191a[_0x219f99],_0x20982e=~~_0x332b78[_0x219f99];if(_0x81ae24>_0x20982e)return!![];if(_0x81ae24<_0x20982e)return![];}return![];}function toTelegramMarkdown(_0x5502bd){const _0x338aff=_0x5c7b80,_0x5a4e8c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x47fa91=/\*{2}(.+?)\*{2}/gim;return _0x5502bd=_0x5502bd[_0x338aff(0x2df)](_0x5a4e8c,_0x338aff(0x2d2))[_0x338aff(0x2df)](_0x47fa91,_0x338aff(0x30d)),_0x5502bd;}async function validateConfigFile(){const _0x3bb9ad=_0x5c7b80,_0x2d1a6c=dbConfig[_0x3bb9ad(0x322)]('bots')[_0x3bb9ad(0x20e)](_0x3bb9ad(0x319))['value']()||[];if(_0x2d1a6c[_0x3bb9ad(0x2ed)]==0x0){let _0x59c369=0x0,_0x5c6402=[];const _0x1b1ca2=/^bot-([0-9]{3})-config.json$/,_0x23dad1=fs[_0x3bb9ad(0x277)](configpath);_0x23dad1[_0x3bb9ad(0x2f2)](_0x29e50f=>{const _0x3ed05d=_0x3bb9ad,_0x359c68=_0x1b1ca2[_0x3ed05d(0x2b5)](_0x29e50f);if(_0x359c68){const _0x1a1027=_0x359c68[0x1];let _0x54b2f7=getBotAttributes(_0x1a1027);_0x5c6402[_0x3ed05d(0x341)]({'botID':_0x1a1027,'botname':_0x54b2f7['botname'],'status':_0x3ed05d(0x35f),'live':'stopped'}),_0x59c369++;}}),_0x59c369!=0x0&&(dbConfig[_0x3bb9ad(0x322)](_0x3bb9ad(0x3bb))[_0x3bb9ad(0x299)](_0x5c6402)[_0x3bb9ad(0x2f8)](),config=_0x5c6402,restoredConfigFile=_0x59c369);}}async function restoreConfigNotify(_0xc52be8){const _0xb3c9c2=_0x5c7b80;let _0x458a90;if(restoredConfigFile==0x1)_0x458a90='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x458a90='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xc52be8)io['to'](_0xb3c9c2(0x20f))[_0xb3c9c2(0x3ad)](_0xb3c9c2(0x1ea),_0x458a90);else{logger['simple'](_0xb3c9c2(0x320)),logger['simple'](_0x458a90),logger['simple'](_0xb3c9c2(0x320)),logger[_0xb3c9c2(0x34f)]('');if(tgBot&&settings['telegramChatId']&&settings[_0xb3c9c2(0x2f0)]!=_0xb3c9c2(0x1f7))tgBot[_0xb3c9c2(0x2e6)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x458a90)[_0xb3c9c2(0x31f)](_0x4e7231=>{telegramError(_0x4e7231);});}}function validateCredentials(_0x4182cf,_0xf5dc2e){const _0x13d5b3=_0x5c7b80;if(_0x4182cf['username']==settings[_0x13d5b3(0x286)]&&bcrypt[_0x13d5b3(0x1fc)](_0x4182cf[_0x13d5b3(0x38a)],settings[_0x13d5b3(0x292)])){if(settings[_0x13d5b3(0x29f)])return{'allow':![],'reason':_0x13d5b3(0x2f4),'token':null};else{const _0x502189=generateLoginToken(_0xf5dc2e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x502189};}}else return{'allow':![],'reason':_0x13d5b3(0x330),'token':null};}function refreshToken(_0x521ff6){const _0x1d7f56=_0x5c7b80,_0x782ad9=generateLoginToken(_0x521ff6);return{'allow':!![],'reason':_0x1d7f56(0x308),'token':_0x782ad9};}function validateAccess(_0x2e587a,_0x1db8e4,_0x3b2085){const _0x59486b=_0x5c7b80,_0x2ad79b=_0x3b2085?_0x3b2085:devices[_0x1db8e4]['ip'];let _0x1458d6;const _0x1433c9=_0x426e04=>{const _0x6ed175=_0x2dc7;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1db8e4)){const _0x121ab8=generateLoginToken(_0x1db8e4);return{'allow':!![],'reason':_0x6ed175(0x316),'token':_0x121ab8};}else return{'allow':![],'reason':_0x6ed175(0x220),'token':null};}else return _0x1458d6=validToken(_0x426e04,_0x1db8e4),_0x1458d6[_0x6ed175(0x391)](_0x6ed175(0x2e3))?{'allow':!![],'reason':_0x6ed175(0x23e),'token':_0x426e04}:{'allow':![],'reason':_0x6ed175(0x220),'token':null};}else return{'allow':!![],'reason':_0x6ed175(0x26f),'token':null};};if(settings[_0x59486b(0x266)]){let _0x4faf8b=[...settings['whitelist'],_0x59486b(0x29d),_0x59486b(0x3a1),'127.0.0.1'];if(_0x4faf8b[_0x59486b(0x271)](_0x2ad79b))return _0x1433c9(_0x2e587a);else{_0x1458d6=validToken(_0x2e587a,_0x1db8e4);if(_0x1458d6[_0x59486b(0x391)](_0x59486b(0x2e3)))return _0x1433c9(_0x2e587a);else{if(telegramIpApproved(_0x1db8e4)){const _0xb96aa2=generateToken(_0x1db8e4);return _0x1458d6=_0x1433c9(_0x2e587a),_0x1458d6[_0x59486b(0x329)]?{'allow':!![],'reason':_0x59486b(0x3c4),'token':_0xb96aa2}:_0x1458d6;}else return settings[_0x59486b(0x2a4)]?{'allow':![],'reason':_0x59486b(0x35e),'token':null}:{'allow':![],'reason':_0x59486b(0x225),'token':null};}}}else return _0x1433c9(_0x2e587a);}function timelyDecrypt(_0xa3c9b6,_0x1e654a=!![]){const _0x3bb369=_0x5c7b80;if(_0xa3c9b6)try{const _0x18468e=crypt[_0x3bb369(0x393)](secure['privateKey'],_0xa3c9b6)['message'],_0x1e3c78=_0x18468e[_0x3bb369(0x287)]('@')[0x0],_0x28b13f=_0x18468e[_0x3bb369(0x287)]('@')[0x1],_0x24234d=new Date()[_0x3bb369(0x2e4)]();if(_0x1e654a){if(_0x24234d-_0x28b13f<maxSecretAge*0x3e8)return _0x1e3c78;else return![];}else return _0x1e3c78;}catch(_0x311765){return![];}else return![];}const validToken=(_0x3b6856,_0x522c33)=>{const _0x7ca01=_0x5c7b80,_0x49730b=devices[_0x522c33]['ip'];if(!_0x3b6856)return{'error':'No\x20authentication\x20token'};for(let _0x62b3c of blacklist){if(_0x62b3c[_0x7ca01(0x22e)]==_0x3b6856)return{'error':'Token\x20blacklisted'};}let _0x2bcd93;try{_0x2bcd93=jwt[_0x7ca01(0x3a7)](_0x3b6856,secure[_0x7ca01(0x276)]+_0x522c33);}catch{return{'error':_0x7ca01(0x38b)};}if(!_0x2bcd93[_0x7ca01(0x391)](_0x7ca01(0x28a))&&!_0x2bcd93['hasOwnProperty'](_0x7ca01(0x35d))||!_0x2bcd93[_0x7ca01(0x391)](_0x7ca01(0x204)))return{'error':_0x7ca01(0x363)};if(!_0x2bcd93[_0x7ca01(0x391)](_0x7ca01(0x35d))&&_0x2bcd93[_0x7ca01(0x391)]('clientip')){const {clientip:_0x55bac6}=_0x2bcd93;return _0x49730b==_0x55bac6?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x7ca01(0x3b3)};}else{if(_0x2bcd93[_0x7ca01(0x391)](_0x7ca01(0x35d))&&_0x2bcd93['hasOwnProperty'](_0x7ca01(0x28a))){const {username:_0x4f875e,clientip:_0x2bf35f}=_0x2bcd93;return settings['bbUsername']==_0x4f875e&&_0x49730b==_0x2bf35f?{'success':_0x7ca01(0x354)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x4b59aa=>{const _0x49ca38=_0x5c7b80;if(_0x4b59aa){const _0x2fe97e=devices[_0x4b59aa]['ip'];return jwt[_0x49ca38(0x364)]({'username':settings[_0x49ca38(0x286)],'clientip':_0x2fe97e},secure[_0x49ca38(0x276)]+_0x4b59aa,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x447d5f=>{const _0x558e75=_0x5c7b80;if(_0x447d5f){const _0x3ceb57=devices[_0x447d5f]['ip'];return jwt[_0x558e75(0x364)]({'clientip':_0x3ceb57},secure[_0x558e75(0x276)]+_0x447d5f,{'expiresIn':devices[_0x447d5f][_0x558e75(0x3c9)][_0x558e75(0x238)]*0x3c});}else return![];},telegramIpApproved=_0xd72bcc=>{const _0x15135c=_0x5c7b80;let _0x32c714=![];return devices[_0xd72bcc][_0x15135c(0x3c9)]&&devices[_0xd72bcc][_0x15135c(0x3c9)]['expiry']!=_0x15135c(0x2ee)&&(_0x32c714=devices[_0xd72bcc][_0x15135c(0x3c9)][_0x15135c(0x28a)]==devices[_0xd72bcc]['ip']&&new Date()[_0x15135c(0x2e4)]()-devices[_0xd72bcc][_0x15135c(0x3c9)]['timestamp']<devices[_0xd72bcc][_0x15135c(0x3c9)][_0x15135c(0x238)]*0x3c*0x3e8),_0x32c714;},telegram2FaApproved=_0x54c05b=>{const _0x2de992=_0x5c7b80;let _0xb9ac5=![];return devices[_0x54c05b][_0x2de992(0x2b3)]&&devices[_0x54c05b]['telegram2FaApproval']['expiry']!='reject'&&(_0xb9ac5=devices[_0x54c05b][_0x2de992(0x2b3)]['clientip']==devices[_0x54c05b]['ip']&&new Date()[_0x2de992(0x2e4)]()-devices[_0x54c05b][_0x2de992(0x2b3)][_0x2de992(0x275)]<devices[_0x54c05b][_0x2de992(0x2b3)]['expiry']*0x3c*0x3e8),_0xb9ac5;},normalizeIP=_0x3f3f1f=>{const _0x19c7dc=_0x5c7b80;let _0xdb884=null,_0x3c6934=null;if(ipaddr['isValid'](_0x3f3f1f)){const _0x3c0918=ipaddr[_0x19c7dc(0x3a3)](_0x3f3f1f);_0x3c0918[_0x19c7dc(0x389)]()===_0x19c7dc(0x2ff)?(_0x3c0918[_0x19c7dc(0x37d)]()&&(_0xdb884=_0x3c0918[_0x19c7dc(0x210)]()[_0x19c7dc(0x371)]()),_0x3c6934=_0x3c0918[_0x19c7dc(0x371)]()):(_0xdb884=_0x3c0918[_0x19c7dc(0x371)](),_0x3c6934=_0x3c0918[_0x19c7dc(0x2c9)]()[_0x19c7dc(0x371)]());}return{'show':_0xdb884?_0xdb884:_0x3c6934,'store':_0x3c6934};};function formatDate(_0xfef4f0){const _0x4afa4a=_0x5c7b80;return _0xfef4f0['getFullYear']()+'/'+(_0xfef4f0[_0x4afa4a(0x31b)]()+0x1)[_0x4afa4a(0x371)]()[_0x4afa4a(0x2db)](0x2,'0')+'/'+_0xfef4f0['getDate']()[_0x4afa4a(0x371)]()['padStart'](0x2,'0')+'\x20'+_0xfef4f0['getHours']()['toString']()[_0x4afa4a(0x2db)](0x2,'0')+':'+_0xfef4f0[_0x4afa4a(0x2d6)]()[_0x4afa4a(0x371)]()['padStart'](0x2,'0')+':'+_0xfef4f0[_0x4afa4a(0x2b9)]()[_0x4afa4a(0x371)]()[_0x4afa4a(0x2db)](0x2,'0');}function sleep(_0xf49d09){return new Promise(_0x4b389=>setTimeout(_0x4b389,_0xf49d09));}