const _0x3e9c6c=_0x47e5;(function(_0x455460,_0x2cb806){const _0x5a703c=_0x47e5,_0x3598d5=_0x455460();while(!![]){try{const _0x1685c0=-parseInt(_0x5a703c(0x2eb))/0x1+-parseInt(_0x5a703c(0x28a))/0x2*(parseInt(_0x5a703c(0x193))/0x3)+parseInt(_0x5a703c(0x167))/0x4+-parseInt(_0x5a703c(0x1ec))/0x5+parseInt(_0x5a703c(0x206))/0x6+-parseInt(_0x5a703c(0x1aa))/0x7*(-parseInt(_0x5a703c(0x113))/0x8)+-parseInt(_0x5a703c(0x17f))/0x9*(parseInt(_0x5a703c(0x2ac))/0xa);if(_0x1685c0===_0x2cb806)break;else _0x3598d5['push'](_0x3598d5['shift']());}catch(_0x4ebb6f){_0x3598d5['push'](_0x3598d5['shift']());}}}(_0x5c22,0x2b55b));const _0x4435cb=function(){let _0x22f679=!![];return function(_0x377e7e,_0x5d75cb){const _0xde5462=_0x22f679?function(){if(_0x5d75cb){const _0x4b166b=_0x5d75cb['apply'](_0x377e7e,arguments);return _0x5d75cb=null,_0x4b166b;}}:function(){};return _0x22f679=![],_0xde5462;};}(),_0x28a7f8=_0x4435cb(this,function(){const _0x308286=_0x47e5;return _0x28a7f8['toString']()[_0x308286(0x1ba)](_0x308286(0x114))[_0x308286(0x139)]()['constructor'](_0x28a7f8)[_0x308286(0x1ba)](_0x308286(0x114));});_0x28a7f8();'use strict';process[_0x3e9c6c(0x2c4)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3e9c6c(0x10b)),fs=require('fs'),fns=require(_0x3e9c6c(0x103)),low=require(_0x3e9c6c(0x121)),FileSync=require(_0x3e9c6c(0x283)),path=require(_0x3e9c6c(0x1c1)),crypto=require(_0x3e9c6c(0x2c2)),Crypt=require('hybrid-crypto-js')[_0x3e9c6c(0x19b)],RSA=require(_0x3e9c6c(0x125))[_0x3e9c6c(0x2c3)],bcrypt=require(_0x3e9c6c(0x1f2)),jwt=require(_0x3e9c6c(0x2c7)),ipaddr=require(_0x3e9c6c(0x12c)),argv=require(_0x3e9c6c(0x102))(process[_0x3e9c6c(0x12d)]['slice'](0x2))[_0x3e9c6c(0x12d)],uuidRandom=require(_0x3e9c6c(0x112)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require('mixpanel'),axios=require(_0x3e9c6c(0x1bc)),{GraphQLClient,gql}=require(_0x3e9c6c(0x201)),util=require(_0x3e9c6c(0x2e4)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x3e9c6c(0x2ee)]||_0x3e9c6c(0x2d8),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x3e9c6c(0x162)](_0x3e9c6c(0x186)+PORT+_0x3e9c6c(0x11d)),process[_0x3e9c6c(0x2aa)](0x1));const HOST=argv[_0x3e9c6c(0xf7)]||null,userID=argv[_0x3e9c6c(0x2d2)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x3e9c6c(0x281)];let bbpath=_0x3e9c6c(0x1e6),bbpath2='';const botfile=_0x3e9c6c(0x1a0),configfile=_0x3e9c6c(0x2d1),settingsfile=_0x3e9c6c(0xf1),securefile=_0x3e9c6c(0x133),environment=require('./'+bbpath2+_0x3e9c6c(0x273))[_0x3e9c6c(0x22f)]||_0x3e9c6c(0x28e),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x3e9c6c(0x116)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3e9c6c(0x1b1)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x3e9c6c(0x192),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x3e9c6c(0x1ac)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x3e9c6c(0x2dc)+userID+'/':bbpath+_0x3e9c6c(0x2dc),loggerfile=fs[_0x3e9c6c(0xe6)](logspath+_0x3e9c6c(0x234),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x3e9c6c(0xec);!fs[_0x3e9c6c(0x116)](configpath)&&fs[_0x3e9c6c(0x142)](configpath);!fs[_0x3e9c6c(0x116)](configbackuppath)&&fs[_0x3e9c6c(0x142)](configbackuppath);function _0x47e5(_0x424759,_0x32a57e){const _0x3b4aec=_0x5c22();return _0x47e5=function(_0x28a7f8,_0x4435cb){_0x28a7f8=_0x28a7f8-0xe6;let _0x5c2219=_0x3b4aec[_0x28a7f8];return _0x5c2219;},_0x47e5(_0x424759,_0x32a57e);}!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x3e9c6c(0x116)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3e9c6c(0xef)]({'bots':[]})[_0x3e9c6c(0x16f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x3e9c6c(0x16f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3e9c6c(0xef)]({'secure':{},'blacklist':[]})[_0x3e9c6c(0x16f)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x3e9c6c(0x256)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3e9c6c(0x1e4)](_0x3e9c6c(0x19e),{'host':_0x3e9c6c(0x10a)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3e9c6c(0x14c)]&&(settings[_0x3e9c6c(0x14c)]!=''&&settings[_0x3e9c6c(0x14c)]!=_0x3e9c6c(0x1f9))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x8ce969,_0x127d2d)=>{const _0x8268a7=_0x3e9c6c,_0x1cccf7=/#[A-Z]{3}#/g;if(typeof _0x8ce969==_0x8268a7(0x164)){!_0x127d2d?_0x8ce969=_0x8ce969[_0x8268a7(0x259)](_0x1cccf7,''):(_0x8ce969=_0x8ce969[_0x8268a7(0x259)](/#BLU#/g,_0x8268a7(0x130)),_0x8ce969=_0x8ce969[_0x8268a7(0x259)](/#RED#/g,'\x1b[31m'),_0x8ce969=_0x8ce969[_0x8268a7(0x259)](/#YEL#/g,'\x1b[33m'),_0x8ce969=_0x8ce969['replace'](/#MAG#/g,_0x8268a7(0x14f)),_0x8ce969=_0x8ce969['replace'](/#CYA#/g,_0x8268a7(0x265)),_0x8ce969=_0x8ce969[_0x8268a7(0x259)](/#RES#/g,_0x8268a7(0x2d5)));;}return _0x8ce969;},logger={'screen':_0x48aea7=>{const _0x496070=_0x3e9c6c;console[_0x496070(0x162)](parseColor(_0x48aea7,!![]));},'simple':_0x19eeef=>{const _0x39f144=_0x3e9c6c;console[_0x39f144(0x162)](parseColor(_0x19eeef,!![])),loggerfile[_0x39f144(0x16f)](util[_0x39f144(0x25c)](parseColor(_0x19eeef,![]))+'\x0a');},'full':async _0xf00d67=>{const _0x2be5c4=_0x3e9c6c,_0x31feb9=getTimeStamp()+_0x2be5c4(0x2db)+_0xf00d67;console[_0x2be5c4(0x162)](parseColor(_0x31feb9,!![])),loggerfile['write'](util[_0x2be5c4(0x25c)](parseColor(_0x31feb9,![]))+'\x0a');if(tgBot&&settings[_0x2be5c4(0x1cc)]&&settings[_0x2be5c4(0x215)]!='orders')await sendTelegram(settings[_0x2be5c4(0x1cc)],_0x2be5c4(0x25d)+parseColor(_0xf00d67,![]));},'debug':async(_0x3a508c,_0x55e7b0='')=>{const _0x591595=_0x3e9c6c,_0x7ad6b1=getTimeStamp()+_0x591595(0x2f7)+_0x3a508c;if(debugging)console[_0x591595(0x162)](parseColor(_0x7ad6b1,!![]));loggerfile[_0x591595(0x16f)](util[_0x591595(0x25c)](parseColor(_0x7ad6b1,![]))+'\x0a');if(_0x55e7b0){if(debugging)console['log'](_0x55e7b0);loggerfile[_0x591595(0x16f)](util[_0x591595(0x25c)](_0x55e7b0)+'\x0a');}}};let terminating=![];process['on'](_0x3e9c6c(0x187),function(_0x19628f){const _0x1b24a5=_0x3e9c6c;_0x19628f['toString']()[_0x1b24a5(0x205)](_0x1b24a5(0x2a1))?(logger[_0x1b24a5(0x26b)](_0x1b24a5(0x1e1)+_0x19628f['port']+_0x1b24a5(0x154)),process['send']({'terminate':!![]},_0x3b1f73=>{})):logger[_0x1b24a5(0x26b)](_0x19628f);}),process['on'](_0x3e9c6c(0x2aa),()=>{const _0x1806e8=_0x3e9c6c;stopAllBots(),process[_0x1806e8(0x2aa)](0x0);}),process['on'](_0x3e9c6c(0x16d),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3e9c6c(0x20b),()=>{const _0x2146de=_0x3e9c6c;stopAllBots(),process[_0x2146de(0x2aa)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3e9c6c(0x273))[_0x3e9c6c(0x2e0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3e9c6c(0x261)),app=express(),http=require(_0x3e9c6c(0x21e))[_0x3e9c6c(0x152)](app);app[_0x3e9c6c(0xfe)](fileUpload({'useTempFiles':!![]})),app[_0x3e9c6c(0x1e0)](_0x3e9c6c(0x1a1),async(_0x6bb54a,_0x3b17ae)=>{const _0x3db77b=_0x3e9c6c,_0x498c7c=_0x6bb54a[_0x3db77b(0x241)]['type'],_0xd38982=getClientsWithBotID('botmanager'),_0x1c75e7=_0x6bb54a['headers'][_0x3db77b(0x22c)],_0x560fe3=timelyDecrypt(_0x1c75e7,![]),_0x149bbd=_0xd38982[_0x3db77b(0x270)](_0x4f9c84=>_0x4f9c84[_0x3db77b(0x22c)]==_0x560fe3);if(_0x149bbd){const _0x487049=normalizeIP(_0x6bb54a[_0x3db77b(0xe9)][_0x3db77b(0x13b)])[_0x3db77b(0x100)],_0x42643a=_0x6bb54a[_0x3db77b(0x254)][_0x3db77b(0x2a8)];if(validateAccess(_0x42643a,_0x560fe3,_0x487049)['allow'])_0x498c7c==_0x3db77b(0x2c8)&&await backupConfigFiles(),await zipFiles(_0x498c7c),_0x3b17ae['download'](zippath+(_0x498c7c+'.zip'),_0x5e15c5=>{const _0x5bd536=_0x3db77b;_0x5e15c5&&(logger[_0x5bd536(0x2ce)](_0x5bd536(0x212)+_0x498c7c),logger['simple'](_0x5e15c5));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x498c7c+_0x3db77b(0x240));}else logger[_0x3db77b(0x2ce)](_0x3db77b(0x20e)+_0x498c7c+_0x3db77b(0x29a));}),app[_0x3e9c6c(0x1c8)]('/upload-backup',async(_0x2d416d,_0x23f0e1)=>{const _0x39d87b=_0x3e9c6c,_0x5da105=getClientsWithBotID(_0x39d87b(0x2f9)),_0x5226c5=_0x2d416d['headers'][_0x39d87b(0x22c)],_0x171b7e=timelyDecrypt(_0x5226c5,![]),_0x2ba26b=_0x5da105[_0x39d87b(0x270)](_0x16c38b=>_0x16c38b['uuid']==_0x171b7e);logger[_0x39d87b(0x122)](_0x39d87b(0x181));if(_0x2ba26b){const _0x23cd08=normalizeIP(_0x2d416d['socket']['remoteAddress'])['store'],_0x103ec4=_0x2d416d[_0x39d87b(0x254)]['tkn'];if(validateAccess(_0x103ec4,_0x171b7e,_0x23cd08)[_0x39d87b(0x1e2)]){if(_0x2d416d['files']){const _0x25db17=_0x2d416d[_0x39d87b(0x155)][_0x39d87b(0x13e)];await _0x25db17['mv'](temppath+_0x25db17[_0x39d87b(0x172)]),_0x23f0e1[_0x39d87b(0x153)]({'status':!![],'message':_0x39d87b(0x1bf)});const _0x54c3ed=getBotsWithMode();_0x54c3ed[_0x39d87b(0x29e)]>0x0?confirmRestore(temppath,_0x25db17[_0x39d87b(0x172)]):unzipFile(temppath,_0x25db17['name']);}}else logger[_0x39d87b(0x2ce)](_0x39d87b(0x22a));}else logger[_0x39d87b(0x2ce)](_0x39d87b(0x24c));}),app[_0x3e9c6c(0xfe)](express['static'](path[_0x3e9c6c(0x28f)](__dirname,bbpath2,_0x3e9c6c(0x14b)))),app[_0x3e9c6c(0xfe)](express[_0x3e9c6c(0x2b5)](path[_0x3e9c6c(0x28f)](__dirname,bbpath2,_0x3e9c6c(0x21c)))),app[_0x3e9c6c(0x1e0)]('/',function(_0x43b66a,_0x4eb205){const _0x226a7c=_0x3e9c6c;_0x4eb205[_0x226a7c(0x20d)](path[_0x226a7c(0x28f)](__dirname,bbpath2,_0x226a7c(0x14b),_0x226a7c(0x119)));}),app['get'](_0x3e9c6c(0x286),function(_0x1fb88c,_0x474978){const _0x394737=_0x3e9c6c;_0x474978[_0x394737(0x20d)](path[_0x394737(0x28f)](__dirname,bbpath2,_0x394737(0x21c),_0x394737(0x119)));}),app['get'](_0x3e9c6c(0x15c),(_0x587fde,_0x572fd7)=>{const _0x572cfe=_0x3e9c6c;_0x572fd7[_0x572cfe(0x20d)](path[_0x572cfe(0x28f)](__dirname,bbpath2,_0x572cfe(0x21c),_0x572cfe(0x119)));}),app[_0x3e9c6c(0x1e0)](_0x3e9c6c(0x194),(_0x15209a,_0x14ffe7)=>{const _0x5d9258=_0x3e9c6c;_0x14ffe7['sendFile'](path[_0x5d9258(0x28f)](__dirname,bbpath2,_0x5d9258(0x21c),'index.html'));}),app[_0x3e9c6c(0x1e0)](_0x3e9c6c(0xeb),(_0x424ad7,_0x3044fc)=>{const _0x3b7724=_0x3e9c6c;_0x3044fc[_0x3b7724(0x20d)](path[_0x3b7724(0x28f)](__dirname,bbpath2,_0x3b7724(0x21c),_0x3b7724(0x119)));}),app['get']('/:bot/history',(_0x36df53,_0x3bf934)=>{const _0x33c1fc=_0x3e9c6c;_0x3bf934[_0x33c1fc(0x20d)](path['join'](__dirname,bbpath2,_0x33c1fc(0x21c),'index.html'));}),app[_0x3e9c6c(0x1e0)]('/:bot/configuration',(_0x350b48,_0x214540)=>{const _0x454ccb=_0x3e9c6c;_0x214540[_0x454ccb(0x20d)](path['join'](__dirname,bbpath2,_0x454ccb(0x21c),_0x454ccb(0x119)));}),app[_0x3e9c6c(0x1e0)](_0x3e9c6c(0x232),(_0x2e24fa,_0x3b64d5)=>{const _0x2be5ba=_0x3e9c6c;_0x3b64d5[_0x2be5ba(0x20d)](path[_0x2be5ba(0x28f)](__dirname,bbpath2,_0x2be5ba(0x21c),_0x2be5ba(0x119)));});if(HOST)http['listen'](PORT,HOST);else http[_0x3e9c6c(0x292)](PORT);const io=require(_0x3e9c6c(0x1fd))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x520252=_0x3e9c6c;let _0x5d3c54=_0x520252(0x1a4);const _0x4a7219=networkInterfaces(),_0x26a636={};for(const _0x206203 of Object[_0x520252(0x26e)](_0x4a7219)){for(const _0x3a9154 of _0x4a7219[_0x206203]){if((_0x3a9154[_0x520252(0x27c)]==_0x520252(0x1cf)||_0x3a9154[_0x520252(0x27c)]==0x4)&&!_0x3a9154['internal']){const _0x352913=ipaddr['parse'](_0x3a9154[_0x520252(0x158)])[_0x520252(0x2b9)]();_0x352913!='private'&&(!_0x26a636[_0x206203]&&(_0x26a636[_0x206203]=[]),_0x26a636[_0x206203]['push'](_0x3a9154[_0x520252(0x158)]),_0x5d3c54=_0x3a9154[_0x520252(0x158)]);}}}return{'serverip':_0x5d3c54,'netinterfaces':_0x26a636};}async function startServer(){const _0x2779f1=_0x3e9c6c,{serverip:_0x2601eb,netinterfaces:_0xbe36}=getServerIP();logger['simple'](''),logger[_0x2779f1(0x26b)](_0x2779f1(0x2f5)),await logger[_0x2779f1(0x2ce)](_0x2779f1(0x251)+serverversion+_0x2779f1(0x2e6)+(environment=='staging'?_0x2779f1(0x145):'')+'\x0a'+(_0x2779f1(0x2bb)+PORT+_0x2779f1(0x2b4))+(_0x2779f1(0x219)+_0x2601eb+':'+PORT+_0x2779f1(0x267))),logger[_0x2779f1(0x26b)](_0x2779f1(0x2f5));if(config['length']!=0x0)for(const _0x3e9c8e of config){const _0x3a3977=_0x3e9c8e['mode']==_0x2779f1(0x2dd)?'a':'m';if(_0x3e9c8e[_0x2779f1(0x287)]==_0x2779f1(0x14d)||_0x3e9c8e[_0x2779f1(0x287)]==_0x2779f1(0x209))await logger[_0x2779f1(0x2ce)](_0x2779f1(0x1bb)+_0x3a3977+_0x2779f1(0x1f4)+_0x3e9c8e[_0x2779f1(0x237)]+_0x2779f1(0x15f)+_0x3e9c8e[_0x2779f1(0x19d)]),startBot([_0x3e9c8e['botID'],userID],{'cwd':bbpath},function(_0x57fd30){const _0x2073ca=_0x2779f1;if(_0x57fd30)logger[_0x2073ca(0x2ce)](_0x57fd30);});else(_0x3e9c8e[_0x2779f1(0x287)]==_0x2779f1(0xed)||_0x3e9c8e[_0x2779f1(0x287)]==_0x2779f1(0x25b))&&await logger[_0x2779f1(0x2ce)](_0x2779f1(0x148)+_0x3a3977+_0x2779f1(0x2ec)+_0x3e9c8e[_0x2779f1(0x237)]+_0x2779f1(0x15f)+_0x3e9c8e[_0x2779f1(0x19d)]);}else!newBot&&logger[_0x2779f1(0x26b)](_0x2779f1(0x1a6));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x2779f1(0x26b)](''),await logger[_0x2779f1(0x122)](_0x2779f1(0x163)+nodeversion),await logger[_0x2779f1(0x122)]('Network\x20Interfaces:',_0xbe36);}function startSocket(){io['on']('connection',_0x893a1e=>{const _0x3c1ef3=_0x47e5;let _0xc606aa,_0x40730b,_0x3dc6fb,_0x4e2c7a,_0x2211b8;const _0x2fb6eb=_0x893a1e[_0x3c1ef3(0x236)][_0x3c1ef3(0x254)][_0x3c1ef3(0x23c)];_0x40730b=_0x2fb6eb[_0x3c1ef3(0xf9)](/bot[0-9]{3}/);if(_0x40730b)_0x3dc6fb=_0x40730b[0x0]['match'](/[0-9]{3}/);if(_0x3dc6fb)_0xc606aa=_0x3dc6fb[0x0];else _0xc606aa='botmanager';const _0x8ccad9=_0x893a1e[_0x3c1ef3(0x236)]['auth'][_0x3c1ef3(0x23f)];if(!_0x8ccad9)_0x893a1e[_0x3c1ef3(0x210)](_0x3c1ef3(0x287),{'publicKey':secure['publicKey']});else{_0x4e2c7a=timelyDecrypt(_0x8ccad9,![]);if(!_0x4e2c7a)_0x893a1e[_0x3c1ef3(0x210)](_0x3c1ef3(0x287),{'publicKey':secure[_0x3c1ef3(0x2bf)]});else{_0x2211b8=normalizeIP(_0x893a1e['conn'][_0x3c1ef3(0x13b)])[_0x3c1ef3(0x100)];if(!devices[_0x4e2c7a])devices[_0x4e2c7a]={'uuid':_0x4e2c7a,'access':{'token':null}};devices[_0x4e2c7a]['ip']=_0x2211b8;const _0x443158=addClient(_0x893a1e['id'],_0x4e2c7a,_0xc606aa);setAccess(_0x443158),emitMessages(),_0x893a1e['on'](_0x3c1ef3(0x2ab),_0x38c05e=>{const _0x115c75=_0x3c1ef3,_0x332fb4=timelyDecrypt(_0x38c05e['password'],!![],_0x115c75(0x249));if(_0x332fb4){_0x38c05e={'username':_0x38c05e[_0x115c75(0x111)],'password':_0x332fb4},devices[_0x4e2c7a]['access']=validateCredentials(_0x38c05e,_0x4e2c7a);if(devices[_0x4e2c7a][_0x115c75(0x144)]['allow']==![]&&devices[_0x4e2c7a]['access']['reason']==_0x115c75(0x24f))_0x893a1e[_0x115c75(0x210)](_0x115c75(0x287),{'access':devices[_0x4e2c7a][_0x115c75(0x144)]}),loginAccess2FA(_0x4e2c7a,_0x2211b8);else{if(devices[_0x4e2c7a][_0x115c75(0x144)][_0x115c75(0x1e2)]==![]&&devices[_0x4e2c7a]['access']['reason']=='invalid\x20credentials')_0x893a1e[_0x115c75(0x210)](_0x115c75(0x287),{'access':devices[_0x4e2c7a][_0x115c75(0x144)]});else devices[_0x4e2c7a][_0x115c75(0x144)][_0x115c75(0x1e2)]&&devices[_0x4e2c7a][_0x115c75(0x144)][_0x115c75(0x223)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x4e2c7a)[_0x115c75(0x16c)](_0x1f7ad7=>{setAccess(_0x1f7ad7);}),logger[_0x115c75(0x122)]('Logged\x20in\x20user\x20...'+_0x4e2c7a[_0x115c75(0x2ca)](-0x8)),setTokenRefresh(_0x4e2c7a),setSessionTimeout(_0x115c75(0x2ab),_0x4e2c7a));}}else logger[_0x115c75(0x2ce)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x893a1e['on'](_0x3c1ef3(0x126),()=>{resetPassword();}),_0x893a1e['on'](_0x3c1ef3(0x1ae),_0x1de528=>{removeClient(_0x893a1e['id']);}),_0xc606aa==_0x3c1ef3(0x2f9)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x392782){const _0x49b103=_0x3e9c6c;if(_0x392782!=_0x49b103(0x2f9)&&config[_0x49b103(0x2cc)]!=''){if(pid[_0x392782])pid[_0x392782][_0x49b103(0x153)]({'function':_0x49b103(0x299),'args':null});}_0x392782!=_0x49b103(0x2f9)&&broadcastToBots(_0x49b103(0x285),JSON[_0x49b103(0x255)](config));}function reloadBotManager(){const _0x2aba39=_0x3e9c6c;getClientsWithBotID(_0x2aba39(0x2f9))[_0x2aba39(0x16c)](_0x484106=>{const _0x5abf16=_0x2aba39;getSocket(_0x484106['id'])[_0x5abf16(0x210)](_0x5abf16(0x287),{'access':{'allow':![],'reason':'reload','token':null}});});}function _0x5c22(){const _0xfe589=['started','onepagemode','once','************','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','login\x20not\x20required','Crypt','metrics_','botname','6b67f3d61ee94b8f5c80b4affef4c4d9','bbvNew','bot.js','/download/:type','Unauthorized\x20attempt\x20to\x20update\x20bot','show','[ip-address]','reload','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','config_all','store-configuration','showConfig','10451ygjSeN','Error\x20removing\x20old\x20backup\x20files:','logs/','Logged\x20out\x20user\x20...','disconnect','text','reject','clients','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','toggle-bot-mode','-results.json','catch','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x20to\x20','Setting\x20access:\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','search','Starting\x20(','axios','DEFLATE','sendPortfolioTelegram','File\x20uploaded','temporaryAccessAllowed','path','userid','CoinMarketCap\x20API\x20key\x20validated','toIPv4MappedAddress','/names\x20-\x20show\x20bot\x20names\x0a','any','Access\x20enabled\x20for\x20','post','2FA\x20login\x20rejected','output-000.log','Unauthorized\x20attempt\x20to\x20add\x20bot','telegramChatId','notification','resetpw_yes','IPv4','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','reinstall_yes','getSeconds','<b>Balance\x20Bot\x20Status:</b>\x0a','Error\x20details:','placeOrder','password','backup-files','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','/help\x20-\x20show\x20available\x20commands\x0a','order','isValid','delete-alerts','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','tempaccess_15_','reinstall-bb','get','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','allow','Starting\x20Balance\x20Bot\x20reinstallation','init','telegramIpApproval','bb/','logout','exchange','/off\x20-\x20stop\x20bot(s)\x0a','code','apiPassword','423110urnkef','_data','secure','action','set','isDirectory','bcryptjs','server',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','5\x20min','telegrammsg','hashSync','***','error','Restore\x20process\x20confirmed','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','socket.io','0.0.0','launch','push','graphql-request','command','toggle','writeFileSync','includes','1443330GyKRxM','logged\x20out','2FA\x20required','new','stop','SIGINT','exec','sendFile','Unauthorized\x20attempt\x20to\x20download\x20','Error\x20while\x20deleting\x20config\x20files:\x20','emit','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Failed\x20to\x20download\x20','resetpw_no','Starting\x20new\x20bot\x20|\x20Bot\x20','telegramEvents','get-backup-files','15\x20min','output-001.log','=>\x20Go\x20to\x20#CYA#http://','sendMessage','function','build','bbPassword','http','value','from','<b>Telegram\x20Bot\x20Status:</b>\x0a','type','reason','Allow\x20login\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','update_yes','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20get\x20portfolio','showname','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','cancel-loading','uuid','update-bot','all','environment','Invalid\x20IP\x20address','getUTCHours','/:bot/support','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','/output-000.log','place-order','handshake','botID','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','config_orders','Notifications\x20types:\x20','storeHeadless','referer','Restore\x20backup\x20file\x20','enable','encryptedUuid','\x20(1)','params','config_alerts','\x20-\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','config','portfolio','disable','|@|','getPortfolio','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','bbUsername','copyFileSync','2FA\x20login\x20required','callback','Starting\x20#RED#Balance\x20Bot\x20v','get-messages','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','headers','stringify','RSA-OAEP','off','\x20mode','replace','telegramUsername','new-disabled','format','Bot\x20Mgr\x20>\x20','resetHistory','Enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','express','lastmsgemitted','orders','readFileSync','\x1b[36m','stopped','#RES#\x20if\x20running\x20on\x20server','Notifications\x20disabled','yes','kind','simple','assign','output-003.log','keys','Starting\x20Balance\x20Bot\x20update','find','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','/metrics\x20-\x20show\x20bot\x20performance\x0a','version.json','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','event','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','2FA','delete-bot','restore-backup-file','message','family','hasOwnProperty','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','manual','node','telegram2FaApproval','lowdb/adapters/FileSync','randomBytes','bots','/:bot','status','restart','127.0.0.1','530lKLfFZ','temporary\x20access\x20rejected','Ok,\x20will\x20send\x20alert\x20notifications\x20only','temporary\x20access\x20timeout','production','join','help','unlinkSync','listen','inherit','secret','Login\x20accepted','temporary\x20token\x20generated','\x20>\x20','cloneDeep','initclient','\x20(2)','removeAllListeners','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','1000','length','storeFiat','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','address\x20already\x20in\x20use','\x20|\x20client:\x20...','getFullYear','Temporary\x20access\x20rejected','compareSync','Unauthorized\x20attempt\x20to\x20log\x20out','size','tkn','Restoring\x20bot(s)\x20from\x20backup','exit','login','1490nhiBMC','restore_yes_','store-headless','rmSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','pidExpireLogin','output-002.log','kill','#RES#\x20if\x20running\x20locally\x0a','static','Markdown','track','bot','range','sign','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','endsWith','f2aRequired','-config.json','publicKey','binary','login\x20token\x20generated','crypto','RSA','env','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','telegramEnabled','jsonwebtoken','backup','file','slice','getTime','apiKey','2FA\x20login\x20token\x20generated','full','whitelist','close','bb-config.json','user','restore_no_','getDate','\x1b[0m','timestamp','Your\x20installation\x20is\x20already\x20up\x20to\x20date','3000','All\x20bots','sockets',':\x20Bot\x20Mgr\x20>\x20','zip/','auto','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','getMinutes','version','confirm-message','filter','add-bot','util','Notifications\x20disabled\x0a','#RES#\x20','messages','latestversion','Backup\x20file\x20unzipped\x20and\x20stored','decrypt','272325pFgYwk',')\x20\x20\x20|\x20Bot\x20','storeConfiguration','port','bot-','headless','split','alias','padStart','::1','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20confirm\x20message',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','mode','botmanager','*$1*','Password\x20has\x20been\x20reset\x20to:\x20','running','createWriteStream','token','button','socket','Unauthorized\x20attempt\x20to\x20get\x20events','/:bot/coins','temp/','disabled','sendMetricsTelegram','defaults','settings.','bb-settings.json','chat','then','args','inlineKeyboard','statSync','host','marketcapApi','match','timeshift','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','login2fa_','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','use','accept','store','Login\x20rejected','yargs/yargs','date-fns','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','telegram','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Invalid\x20authentication\x20token\x20(1)','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','api-eu.mixpanel.com','child_process','alerts','get-starting-balances','HTML','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Telegraf\x20error:','username','uuid-random','904YnUPLC','(((.+)+)+)+$','No\x20bots\x20running\x20right\x20now','existsSync','30\x20min','readdirSync','index.html','pidRefreshToken','-events.json','/update\x20-\x20update\x20Balance\x20Bot\x0a',',\x20must\x20be\x20a\x204\x20digit\x20number','/enable\x20-\x20enable\x20notifications\x0a','Alerts','Yes','lowdb','debug','randomFillSync','names','hybrid-crypto-js','reset-password','.zip',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','::ffff:127.0.0.1','tempaccess_5_','Restore\x20process\x20aborted','ipaddr.js','argv','store-settings','/disable\x20-\x20disable\x20notifications\x0a','\x1b[34m','startsWith','deleteHistoryAlerts','bb-secure.json','add','backup-full@','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','node-zip','Unauthorized\x20attempt\x20to\x20delete\x20alerts','toString','data','remoteAddress','entries','updatebotmanager','backupfile','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','ipc','mkdirSync','test','access','(staging)','settings','Server','Idling\x20(','reinstall','get-portfolio','build2','telegramToken','enabled','apiSecret','\x1b[35m','backup-full','/restart\x20-\x20restart\x20bot(s)\x0a','createServer','send','#RES#','files','Bot\x20','getHours','address','parse','User\x20has\x20been\x20validated','sortBy','/:bot/portfolio','privateKey','reset-history','\x20|\x20','lastmsgtelegram','show-config','log','Node.js\x20v','string','getMonth','toggleBotMode','584000OkUXpL','reply','-performance.json','tempaccess_30_','\x20|\x20user:\x20...','forEach','SIGTERM','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','write','expiry','reinstall_no','name','live','editMessageReplyMarkup','clientip','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','update-bb','bbvReceive','remove','success','max','blacklist','No\x20authentication\x20token','You\x20can\x20use\x20the\x20following\x20commands:\x0a','153rEephJ','Telegram\x20error:','Backup\x20file\x20uploaded','toggle_','Password\x20reset\x20rejected','metrics','loginRequired','Error:\x20Invalid\x20argument\x20','uncaughtException','login\x20required','start','Session\x20expired\x20for\x20user\x20...','sort','invalid\x20credentials','number','portfolio_','login\x20token\x20valid','update','whitelistEnabled','config/','207jLCjKc','/:bot/performance'];_0x5c22=function(){return _0xfe589;};return _0x5c22();}function getSocket(_0x2822fe){const _0x1ea047=_0x3e9c6c;return io[_0x1ea047(0x2da)]['sockets']['get'](_0x2822fe);}function setAccess(_0x51e885){const _0x46fa4d=_0x3e9c6c,_0x2fa728=getSocket(_0x51e885['id']),_0x2f0fd5=_0x51e885[_0x46fa4d(0x22c)],_0x14a01b=_0x51e885[_0x46fa4d(0x2b8)];devices[_0x2f0fd5][_0x46fa4d(0x144)]=validateAccess(devices[_0x2f0fd5][_0x46fa4d(0x144)][_0x46fa4d(0xe7)],_0x2f0fd5),logger[_0x46fa4d(0x122)](_0x46fa4d(0x1b8)+devices[_0x2f0fd5][_0x46fa4d(0x144)]['reason']+_0x46fa4d(0x2a2)+_0x51e885['id'][_0x46fa4d(0x2ca)](-0x8)+_0x46fa4d(0x16b)+_0x2f0fd5[_0x46fa4d(0x2ca)](-0x8)),_0x2fa728[_0x46fa4d(0x28f)](_0x2f0fd5);if(devices[_0x2f0fd5][_0x46fa4d(0x144)]['allow']){_0x2fa728[_0x46fa4d(0x28f)](_0x14a01b);if(_0x14a01b=='botmanager')initializeSocketBotManager(_0x2fa728);else initializeSocketBot(_0x2fa728);initClient(_0x14a01b);}devices[_0x2f0fd5][_0x46fa4d(0x144)][_0x46fa4d(0xe7)]&&devices[_0x2f0fd5][_0x46fa4d(0x144)][_0x46fa4d(0x223)]==_0x46fa4d(0x296)&&setSessionTimeout(_0x46fa4d(0x278),_0x2f0fd5),devices[_0x2f0fd5][_0x46fa4d(0x144)][_0x46fa4d(0xe7)]&&devices[_0x2f0fd5][_0x46fa4d(0x144)][_0x46fa4d(0x223)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x46fa4d(0x2ab),_0x2f0fd5),_0x2fa728['emit'](_0x46fa4d(0x287),{'status':_0x51e885[_0x46fa4d(0x1f3)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2f0fd5][_0x46fa4d(0x144)],'externalip':devices[_0x2f0fd5]['ip'],'publicKey':secure[_0x46fa4d(0x2bf)],'userid':settings[_0x46fa4d(0x1c2)],'validInstallation':validInstallation}),devices[_0x2f0fd5][_0x46fa4d(0x144)][_0x46fa4d(0x1e2)]==![]&&devices[_0x2f0fd5][_0x46fa4d(0x144)]['reason']==_0x46fa4d(0x208)&&temporaryAccess2FA(_0x2f0fd5,devices[_0x2f0fd5]['ip']);}function setSessionTimeout(_0x5a5a50,_0x1642ac){const _0x3fa59f=_0x3e9c6c;let _0x3dd8d7;if(_0x5a5a50=='login')_0x3dd8d7=loginExpiry*0x3c*0x3e8;else _0x3dd8d7=devices[_0x1642ac][_0x3fa59f(0x1e5)][_0x3fa59f(0x170)]*0x3c*0x3e8-(new Date()[_0x3fa59f(0x2cb)]()-devices[_0x1642ac][_0x3fa59f(0x1e5)][_0x3fa59f(0x2d6)]);if(devices[_0x1642ac][_0x3fa59f(0x2b1)])clearTimeout(devices[_0x1642ac][_0x3fa59f(0x2b1)]);devices[_0x1642ac]['pidExpireLogin']=setTimeout(()=>{const _0x4e3094=_0x3fa59f;if(devices[_0x1642ac][_0x4e3094(0x11a)])clearTimeout(devices[_0x1642ac][_0x4e3094(0x11a)]);removeSocketListeners(_0x1642ac),addBlacklist(_0x1642ac),devices[_0x1642ac][_0x4e3094(0x1e5)]=null,devices[_0x1642ac][_0x4e3094(0x282)]=null,devices[_0x1642ac][_0x4e3094(0x144)][_0x4e3094(0xe7)]=null,logger['debug'](_0x4e3094(0x18a)+_0x1642ac['slice'](-0x8)),devices[_0x1642ac][_0x4e3094(0x144)]=validateAccess(devices[_0x1642ac][_0x4e3094(0x144)][_0x4e3094(0xe7)],_0x1642ac),!(devices[_0x1642ac][_0x4e3094(0x144)][_0x4e3094(0x1e2)]&&devices[_0x1642ac][_0x4e3094(0x144)][_0x4e3094(0x223)]==_0x4e3094(0x19a))&&(_0x5a5a50==_0x4e3094(0x2ab)?io['to'](_0x1642ac)[_0x4e3094(0x210)](_0x4e3094(0x287),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1642ac)['emit'](_0x4e3094(0x287),{'access':{'allow':![],'reason':_0x4e3094(0x28d),'token':null}})),devices[_0x1642ac]['access'][_0x4e3094(0xe7)]=null;},_0x3dd8d7);}function setTokenRefresh(_0x26d339){const _0x39857c=_0x3e9c6c;if(devices[_0x26d339][_0x39857c(0x11a)])clearTimeout(devices[_0x26d339][_0x39857c(0x11a)]);devices[_0x26d339][_0x39857c(0x11a)]=setTimeout(()=>{const _0x4717d2=_0x39857c;getClientsWithUuid(_0x26d339)[_0x4717d2(0x29e)]!=0x0?(devices[_0x26d339][_0x4717d2(0x144)]=refreshToken(_0x26d339),io['to'](_0x26d339)[_0x4717d2(0x210)]('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x26d339][_0x4717d2(0x144)],'externalip':devices[_0x26d339]['ip'],'publicKey':secure[_0x4717d2(0x2bf)],'validInstallation':validInstallation}),setTokenRefresh(_0x26d339)):clearTimeout(devices[_0x26d339][_0x4717d2(0x11a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3dd2e7){const _0x10ff41=_0x3e9c6c,_0x450d4e=getClient(_0x3dd2e7['id'])[_0x10ff41(0x22c)];_0x3dd2e7[_0x10ff41(0x210)]('bots',config),_0x3dd2e7[_0x10ff41(0x210)](_0x10ff41(0x146),cleanSettings()),_0x3dd2e7['on'](_0x10ff41(0x2e3),_0x1066d0=>{const _0x18f46d=_0x10ff41;if(validateAccess(_0x1066d0,_0x450d4e)['allow'])addBot();else logger[_0x18f46d(0x2ce)](_0x18f46d(0x1cb));}),_0x3dd2e7['on'](_0x10ff41(0x22d),(_0x543268,_0x461af2)=>{const _0x4b324c=_0x10ff41;if(validateAccess(_0x461af2,_0x450d4e)[_0x4b324c(0x1e2)])toggleBot(_0x543268[_0x4b324c(0x237)],_0x543268[_0x4b324c(0x287)],_0x543268['live']);else logger['full'](_0x4b324c(0x1a2));}),_0x3dd2e7['on'](_0x10ff41(0x1b3),(_0x19350a,_0x2292e2)=>{const _0x12ad03=_0x10ff41;if(validateAccess(_0x2292e2,_0x450d4e)['allow'])toggleBotMode(_0x19350a);else logger['full'](_0x12ad03(0x1a2));}),_0x3dd2e7['on'](_0x10ff41(0x279),(_0x3220c0,_0x4d1879)=>{const _0x4ff44e=_0x10ff41;if(validateAccess(_0x4d1879,_0x450d4e)[_0x4ff44e(0x1e2)])deleteBot(_0x3220c0);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x3dd2e7['on'](_0x10ff41(0x12e),(_0x4cef1f,_0x39cc7a)=>{const _0x19602d=_0x10ff41;if(validateAccess(_0x39cc7a,_0x450d4e)[_0x19602d(0x1e2)])storeSettings(_0x4cef1f,!![]);else logger['full'](_0x19602d(0x27f));}),_0x3dd2e7['on']('update-bb',_0x639992=>{const _0x49e094=_0x10ff41;if(validateAccess(_0x639992,_0x450d4e)[_0x49e094(0x1e2)])updateBB('update');else logger[_0x49e094(0x2ce)](_0x49e094(0x10f));}),_0x3dd2e7['on'](_0x10ff41(0x1df),_0x17cf97=>{const _0x1bb2da=_0x10ff41;if(validateAccess(_0x17cf97,_0x450d4e)[_0x1bb2da(0x1e2)])updateBB(_0x1bb2da(0x149));else logger[_0x1bb2da(0x2ce)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x3dd2e7['on'](_0x10ff41(0x216),_0x465c52=>{const _0x5038bc=_0x10ff41;if(validateAccess(_0x465c52,_0x450d4e)[_0x5038bc(0x1e2)]){const _0x59b9c0=getClient(_0x3dd2e7['id']);if(_0x59b9c0)getBackupFiles(_0x59b9c0[_0x5038bc(0x22c)]);else logger['full'](_0x5038bc(0x227));}else logger[_0x5038bc(0x2ce)](_0x5038bc(0x1b6));}),_0x3dd2e7['on'](_0x10ff41(0x27a),(_0x2655d4,_0xf69ee1)=>{const _0x2cc466=_0x10ff41;if(validateAccess(_0xf69ee1,_0x450d4e)[_0x2cc466(0x1e2)])restoreBackupFile(_0x2655d4);else logger['full'](_0x2cc466(0x13f));}),_0x3dd2e7['on'](_0x10ff41(0x252),_0x2bc261=>{const _0x288038=_0x10ff41;if(validateAccess(_0x2bc261,_0x450d4e)['allow'])getMessages();else logger[_0x288038(0x2ce)](_0x288038(0x225));}),_0x3dd2e7['on'](_0x10ff41(0x2e1),(_0x4c8b8d,_0x1276a3)=>{const _0x3b274b=_0x10ff41;if(validateAccess(_0x1276a3,_0x450d4e)[_0x3b274b(0x1e2)])confirmMessage(_0x4c8b8d);else logger[_0x3b274b(0x2ce)](_0x3b274b(0x2f6));}),_0x3dd2e7['on'](_0x10ff41(0x1e7),_0x18b886=>{const _0x83d124=_0x10ff41;if(validateAccess(_0x18b886,_0x450d4e)['allow']){if(devices[_0x450d4e]['pidRefreshToken'])clearTimeout(devices[_0x450d4e][_0x83d124(0x11a)]);if(devices[_0x450d4e][_0x83d124(0x2b1)])clearTimeout(devices[_0x450d4e]['pidExpireLogin']);removeSocketListeners(getClient(_0x3dd2e7['id'])['uuid']),addBlacklist(_0x450d4e),devices[_0x450d4e][_0x83d124(0x1e5)]=null,devices[_0x450d4e][_0x83d124(0x282)]=null,devices[_0x450d4e][_0x83d124(0x144)][_0x83d124(0xe7)]=null,logger['debug'](_0x83d124(0x1ad)+_0x450d4e[_0x83d124(0x2ca)](-0x8)),io['to'](getClient(_0x3dd2e7['id'])[_0x83d124(0x22c)])[_0x83d124(0x210)](_0x83d124(0x287),{'access':{'allow':![],'reason':_0x83d124(0x207),'token':null}});}else logger[_0x83d124(0x2ce)](_0x83d124(0x2a6));});}function initializeSocketBot(_0x223383){const _0x49791e=_0x3e9c6c,_0x311904=getClient(_0x223383['id'])[_0x49791e(0x2b8)],_0x1e1885=getClient(_0x223383['id'])[_0x49791e(0x22c)];_0x223383['on']('get-logs',(_0x1e3805,_0x45a786)=>{const _0x2431e2=_0x49791e;if(validateAccess(_0x45a786,_0x1e1885)[_0x2431e2(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0x2431e2(0x153)]({'function':'emitHistory','args':_0x1e3805});}else logger['full'](_0x2431e2(0xea));}),_0x223383['on'](_0x49791e(0x1dc),(_0xfdf738,_0x152812)=>{const _0x2228d6=_0x49791e;if(validateAccess(_0x152812,_0x1e1885)[_0x2228d6(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0x2228d6(0x153)]({'function':_0x2228d6(0x132),'args':_0xfdf738});}else logger[_0x2228d6(0x2ce)](_0x2228d6(0x138));}),_0x223383['on'](_0x49791e(0x14a),(_0x535992,_0x216672)=>{const _0x518613=_0x49791e;if(validateAccess(_0x216672,_0x1e1885)[_0x518613(0x1e2)]){if(pid[_0x311904])pid[_0x311904]['send']({'function':_0x518613(0x24a),'args':_0x535992});}else logger[_0x518613(0x2ce)](_0x518613(0x228));}),_0x223383['on'](_0x49791e(0x1a8),(_0x95e07e,_0x35fe5d)=>{const _0x196502=_0x49791e;if(validateAccess(_0x35fe5d,_0x1e1885)[_0x196502(0x1e2)]){if(pid[_0x311904])pid[_0x311904]['send']({'function':_0x196502(0x2ed),'args':_0x95e07e});}else logger[_0x196502(0x2ce)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x223383['on'](_0x49791e(0x2ae),(_0x38d3d4,_0x40ac13)=>{const _0x1091fa=_0x49791e;if(validateAccess(_0x40ac13,_0x1e1885)['allow']){if(pid[_0x311904])pid[_0x311904][_0x1091fa(0x153)]({'function':_0x1091fa(0x23b),'args':_0x38d3d4});}else logger[_0x1091fa(0x2ce)](_0x1091fa(0x260));}),_0x223383['on']('store-fiat',(_0x572d6a,_0x187817)=>{const _0x1ce1b8=_0x49791e;if(validateAccess(_0x187817,_0x1e1885)[_0x1ce1b8(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0x1ce1b8(0x153)]({'function':_0x1ce1b8(0x29f),'args':_0x572d6a});}else logger[_0x1ce1b8(0x2ce)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x223383['on'](_0x49791e(0x15e),_0x1fb907=>{const _0x25e90a=_0x49791e;if(validateAccess(_0x1fb907,_0x1e1885)[_0x25e90a(0x1e2)]){if(pid[_0x311904])pid[_0x311904]['send']({'function':_0x25e90a(0x25e),'args':null});}else logger[_0x25e90a(0x2ce)](_0x25e90a(0x24b));}),_0x223383['on'](_0x49791e(0x10d),_0x5f0690=>{const _0x488dec=_0x49791e;if(validateAccess(_0x5f0690,_0x1e1885)[_0x488dec(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0x488dec(0x153)]({'function':'getStartingBalances','args':null});}else logger[_0x488dec(0x2ce)](_0x488dec(0x1f5));}),_0x223383['on'](_0x49791e(0x235),(_0x176a77,_0xc17339)=>{const _0xb4fcfa=_0x49791e;if(validateAccess(_0xc17339,_0x1e1885)[_0xb4fcfa(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0xb4fcfa(0x153)]({'function':_0xb4fcfa(0x1d5),'args':_0x176a77});}else logger[_0xb4fcfa(0x2ce)](_0xb4fcfa(0x211));}),_0x223383['on'](_0x49791e(0x22b),_0x135dde=>{const _0x2cb5d2=_0x49791e;if(validateAccess(_0x135dde,_0x1e1885)[_0x2cb5d2(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0x2cb5d2(0x153)]({'function':'cancelLoading','args':null});}else logger[_0x2cb5d2(0x2ce)](_0x2cb5d2(0x1d0));}),_0x223383['on'](_0x49791e(0x161),_0x5328f9=>{const _0x12d5a6=_0x49791e;if(validateAccess(_0x5328f9,_0x1e1885)[_0x12d5a6(0x1e2)]){if(pid[_0x311904])pid[_0x311904][_0x12d5a6(0x153)]({'function':_0x12d5a6(0x1a9),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x223383['on'](_0x49791e(0x177),_0x16184c=>{const _0x147fcc=_0x49791e;if(validateAccess(_0x16184c,_0x1e1885)[_0x147fcc(0x1e2)])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x223383['on'](_0x49791e(0x252),_0x5aaf53=>{const _0x56453b=_0x49791e;if(validateAccess(_0x5aaf53,_0x1e1885)[_0x56453b(0x1e2)])getMessages();else logger['full'](_0x56453b(0x225));}),_0x223383['on'](_0x49791e(0x2e1),(_0x3966af,_0x5d4362)=>{const _0x19629b=_0x49791e;if(validateAccess(_0x5d4362,_0x1e1885)['allow'])confirmMessage(_0x3966af);else logger[_0x19629b(0x2ce)](_0x19629b(0x2f6));}),_0x223383['on'](_0x49791e(0x1e7),_0x2573a3=>{const _0x5f44ac=_0x49791e;if(validateAccess(_0x2573a3,_0x1e1885)[_0x5f44ac(0x1e2)]){if(devices[_0x1e1885][_0x5f44ac(0x11a)])clearTimeout(devices[_0x1e1885][_0x5f44ac(0x11a)]);if(devices[_0x1e1885][_0x5f44ac(0x2b1)])clearTimeout(devices[_0x1e1885][_0x5f44ac(0x2b1)]);removeSocketListeners(getClient(_0x223383['id'])['uuid']),addBlacklist(_0x1e1885),devices[_0x1e1885]['telegramIpApproval']=null,devices[_0x1e1885]['telegram2FaApproval']=null,devices[_0x1e1885][_0x5f44ac(0x144)][_0x5f44ac(0xe7)]=null,logger[_0x5f44ac(0x122)](_0x5f44ac(0x1ad)+_0x1e1885[_0x5f44ac(0x2ca)](-0x8)),io['to'](getClient(_0x223383['id'])[_0x5f44ac(0x22c)])['emit'](_0x5f44ac(0x287),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5f44ac(0x2ce)](_0x5f44ac(0x2a6));});}function removeSocketListeners(_0x13dbcd){const _0x599147=_0x3e9c6c;getClientsWithUuid(_0x13dbcd)[_0x599147(0x16c)](_0x57ac6b=>{const _0x4060de=_0x599147;getSocket(_0x57ac6b['id'])[_0x4060de(0x29b)]();});}function cleanSettings(){const _0x4d7180=_0x3e9c6c;let _0x2afbb9=settings;return settings[_0x4d7180(0x14c)]&&settings[_0x4d7180(0x14c)]!=''&&(_0x2afbb9={..._0x2afbb9,'telegramToken':'************'}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x2afbb9={..._0x2afbb9,'bbPassword':_0x4d7180(0x198)}),settings[_0x4d7180(0xf8)]&&settings[_0x4d7180(0xf8)]!=''&&(_0x2afbb9={..._0x2afbb9,'marketcapApi':_0x4d7180(0x198)}),(settings[_0x4d7180(0x21d)]&&settings[_0x4d7180(0x21d)]==_0x4d7180(0x1f9)||settings[_0x4d7180(0x14c)]&&settings[_0x4d7180(0x14c)]=='***'||settings[_0x4d7180(0xf8)]&&settings[_0x4d7180(0xf8)]=='***')&&(_0x2afbb9={..._0x2afbb9,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x4d7180(0x14c)]==_0x4d7180(0x1f9),'marketcap':settings[_0x4d7180(0xf8)]==_0x4d7180(0x1f9)}}),_0x2afbb9;}async function updateBB(_0x37a338){const _0x28f779=_0x3e9c6c;await backupConfigFiles(),installingUpdate=!![],config[_0x28f779(0x16c)](_0x34a6bb=>{const _0x481069=_0x28f779;restartBot(_0x34a6bb[_0x481069(0x237)]);});if(_0x37a338==_0x28f779(0x190))process[_0x28f779(0x153)]({'update':!![],'environment':environment},_0x3db859=>{});else _0x37a338=='reinstall'&&process[_0x28f779(0x153)]({'reinstall':!![],'environment':environment},_0x506d24=>{});}function startBot(_0x593c95,_0x3ff444,_0x13bfc7){const _0x3a200b=_0x3e9c6c;if(debugging)_0x593c95[_0x3a200b(0x200)]('-d');let _0x235a3e=![];const _0x40e6ff=_0x593c95[0x0];_0x3ff444={..._0x3ff444,'stdio':[_0x3a200b(0x293),_0x3a200b(0x293),'inherit',_0x3a200b(0x141)]},pid[_0x40e6ff]=childProcess['fork'](botfile,_0x593c95,_0x3ff444),pid[_0x40e6ff]['on'](_0x3a200b(0x27b),_0x5350da=>{const _0x108012=_0x3a200b;switch(Object[_0x108012(0x26e)](_0x5350da)[0x0]){case _0x108012(0x19d):updateBotName(_0x40e6ff,_0x5350da[_0x108012(0x19d)]);break;case _0x108012(0x13d):updateBotManager();break;case _0x108012(0x287):updateStatus(_0x40e6ff,_0x5350da[_0x108012(0x287)]);break;case _0x108012(0x173):updateLive(_0x40e6ff,_0x5350da[_0x108012(0x173)]);break;case _0x108012(0x195):updateLive(_0x40e6ff,_0x5350da[_0x108012(0x195)]),io['to'](_0x40e6ff)[_0x108012(0x210)](_0x108012(0x287),{'access':{'allow':![],'reason':_0x108012(0x1a5),'token':null}});break;case'stop':_0x5350da[_0x108012(0x20a)]==_0x108012(0x288)&&restartBot(_0x40e6ff);_0x5350da['stop']==_0x108012(0x2b3)&&toggleBot(_0x40e6ff,_0x108012(0xed),_0x108012(0x266));break;case _0x108012(0x105):sendTelegramBot(_0x40e6ff,_0x5350da[_0x108012(0x105)]);break;case _0x108012(0x1f7):sendTelegramMsg(_0x5350da[_0x108012(0x1f7)]);break;case'function':io['to'](_0x40e6ff)[_0x108012(0x210)](_0x5350da[_0x108012(0x21b)],_0x5350da[_0x108012(0xf4)]);break;}}),pid[_0x40e6ff]['on'](_0x3a200b(0x1fa),function(_0x4074ca){if(_0x235a3e)return;_0x235a3e=!![],_0x13bfc7(_0x4074ca);}),pid[_0x40e6ff]['on'](_0x3a200b(0x2aa),async function(_0x10bd2c){const _0xabba28=_0x3a200b;if(terminating)return;if(installingUpdate){logger[_0xabba28(0x122)](_0xabba28(0xfd)),io[_0xabba28(0x2d0)]();return;}if(_0x235a3e)return;_0x235a3e=!![],_0x13bfc7(null);const _0x1246df=dbConfig[_0xabba28(0x1e0)](_0xabba28(0x285))[_0xabba28(0x270)]({'botID':_0x40e6ff})['value']();_0x1246df&&(_0x1246df[_0xabba28(0x287)]==_0xabba28(0x14d)||_0x1246df[_0xabba28(0x287)]=='new')&&(await sleep(0x3e8),updateLive(_0x40e6ff,_0xabba28(0x266)),logger[_0xabba28(0x2ce)]('Restarting\x20Bot\x20'+_0x40e6ff),startBot([_0x40e6ff,userID],{'cwd':bbpath},function(_0x3d9c97){const _0x1eee04=_0xabba28;if(_0x3d9c97)logger[_0x1eee04(0x2ce)](_0x3d9c97);}));});}function stopBot(_0x129e29){const _0x3cc7eb=_0x3e9c6c;getClientsWithBotID(_0x129e29)['forEach'](_0x242043=>{getSocket(_0x242043['id'])['disconnect'](!![]),removeClient(_0x242043['id']);}),pid[_0x129e29]&&(pid[_0x129e29][_0x3cc7eb(0x2b3)](),pid[_0x129e29]=null);}function stopAllBots(){terminating=!![];const _0x1e5fc7=getEnabledBots();_0x1e5fc7['forEach'](_0x55c25d=>{stopBot(_0x55c25d['botID']);});}function restartBot(_0x22fe70){const _0x2a2b70=_0x3e9c6c;if(pid[_0x22fe70])pid[_0x22fe70][_0x2a2b70(0x2b3)]();}function addBot(){const _0x462659=_0x3e9c6c;let _0x812d9e;for(let _0xfaa562=0x1;_0xfaa562<0x3e9;_0xfaa562++){_0x812d9e=_0xfaa562[_0x462659(0x139)]()[_0x462659(0x2f3)](0x3,'0');let _0x148b5a=config['find'](_0x421fd7=>_0x421fd7[_0x462659(0x237)]==_0x812d9e);if(!_0x148b5a)break;}if(_0x812d9e===_0x462659(0x29d)){logger['full'](_0x462659(0x271));return;}logger['full'](_0x462659(0x214)+_0x812d9e),dbConfig[_0x462659(0x1e0)](_0x462659(0x285))['push']({'botID':_0x812d9e,'botname':'Bot\x20'+_0x812d9e,'status':_0x462659(0x209),'live':''})[_0x462659(0x16f)](),startBot([_0x812d9e,userID],{'cwd':bbpath},function(_0x1678f8){const _0x118cab=_0x462659;if(_0x1678f8)logger[_0x118cab(0x2ce)](_0x1678f8);}),config=getConfiguration(),io['to'](_0x462659(0x2f9))[_0x462659(0x210)](_0x462659(0x285),config),broadcastToBots('bots',JSON[_0x462659(0x255)](config));}function deleteBot(_0x1ee03d){const _0x5d3e79=_0x3e9c6c;getClientsWithBotID(_0x1ee03d)['forEach'](_0x387dd1=>{const _0x3de27c=_0x47e5;getSocket(_0x387dd1['id'])[_0x3de27c(0x1ae)](!![]),removeClient(_0x387dd1['id']);}),dbConfig[_0x5d3e79(0x1e0)](_0x5d3e79(0x285))[_0x5d3e79(0x179)]({'botID':_0x1ee03d})['write'](),logger['full']('Deleted\x20Bot\x20'+_0x1ee03d),stopBot(_0x1ee03d);try{if(fs[_0x5d3e79(0x116)](path[_0x5d3e79(0x28f)](configpath,_0x5d3e79(0x2ef)+_0x1ee03d+_0x5d3e79(0x2be))))fs[_0x5d3e79(0x291)](path[_0x5d3e79(0x28f)](configpath,_0x5d3e79(0x2ef)+_0x1ee03d+_0x5d3e79(0x2be)));if(fs[_0x5d3e79(0x116)](path[_0x5d3e79(0x28f)](configpath,_0x5d3e79(0x2ef)+_0x1ee03d+_0x5d3e79(0x11b))))fs[_0x5d3e79(0x291)](path[_0x5d3e79(0x28f)](configpath,_0x5d3e79(0x2ef)+_0x1ee03d+'-events.json'));if(fs[_0x5d3e79(0x116)](path[_0x5d3e79(0x28f)](configpath,'bot-'+_0x1ee03d+_0x5d3e79(0x169))))fs[_0x5d3e79(0x291)](path[_0x5d3e79(0x28f)](configpath,_0x5d3e79(0x2ef)+_0x1ee03d+'-performance.json'));if(fs[_0x5d3e79(0x116)](path[_0x5d3e79(0x28f)](configpath,_0x5d3e79(0x2ef)+_0x1ee03d+_0x5d3e79(0x1b4))))fs[_0x5d3e79(0x291)](path[_0x5d3e79(0x28f)](configpath,'bot-'+_0x1ee03d+_0x5d3e79(0x1b4)));}catch(_0x5e6486){if(_0x5e6486)logger[_0x5d3e79(0x2ce)](_0x5d3e79(0x20f),_0x5e6486);}config=getConfiguration(),io['to']('botmanager')[_0x5d3e79(0x210)]('bots',config),broadcastToBots(_0x5d3e79(0x285),JSON[_0x5d3e79(0x255)](config));}function toggleBot(_0x4a0131,_0x2eeebb,_0x4f16ee){const _0x511e1e=_0x3e9c6c;dbConfig['get'](_0x511e1e(0x285))[_0x511e1e(0x270)]({'botID':_0x4a0131})[_0x511e1e(0x26c)]({'status':_0x2eeebb})[_0x511e1e(0x26c)]({'live':_0x4f16ee})['write']();if(_0x2eeebb==_0x511e1e(0x14d)||_0x2eeebb==_0x511e1e(0x209))logger['full'](_0x511e1e(0x25f)+_0x4a0131),startBot([_0x4a0131,userID],{'cwd':bbpath},function(_0x1fa86f){if(_0x1fa86f)logger['full'](_0x1fa86f);});else(_0x2eeebb==_0x511e1e(0xed)||_0x2eeebb==_0x511e1e(0x25b))&&(logger[_0x511e1e(0x2ce)]('Disabled\x20Bot\x20'+_0x4a0131),stopBot(_0x4a0131));config=getConfiguration(),io['to'](_0x511e1e(0x2f9))[_0x511e1e(0x210)]('bots',config),broadcastToBots(_0x511e1e(0x285),JSON[_0x511e1e(0x255)](config));}function toggleStatus(_0x5938f5){const _0x9e1b84=_0x3e9c6c;let _0x445c3d=dbConfig[_0x9e1b84(0x1e0)]('bots')[_0x9e1b84(0x270)]({'botID':_0x5938f5})[_0x9e1b84(0x21f)](),_0x11e8a2;if(_0x445c3d[_0x9e1b84(0x287)]==='enabled')_0x11e8a2=_0x9e1b84(0xed);else{if(_0x445c3d[_0x9e1b84(0x287)]===_0x9e1b84(0x209))_0x11e8a2=_0x9e1b84(0x25b);else{if(_0x445c3d[_0x9e1b84(0x287)]===_0x9e1b84(0x25b))_0x11e8a2=_0x9e1b84(0x209);else{if(_0x445c3d[_0x9e1b84(0x287)]==='disabled')_0x11e8a2='enabled';}}}return _0x11e8a2;}function updateStatus(_0x5dd471,_0x3a9c6d){const _0xf08c2f=_0x3e9c6c;dbConfig[_0xf08c2f(0x1e0)](_0xf08c2f(0x285))[_0xf08c2f(0x270)]({'botID':_0x5dd471})[_0xf08c2f(0x26c)]({'status':_0x3a9c6d})[_0xf08c2f(0x16f)](),config=getConfiguration(),io['to'](_0xf08c2f(0x2f9))['emit'](_0xf08c2f(0x285),config),broadcastToBots(_0xf08c2f(0x285),JSON[_0xf08c2f(0x255)](config));}function updateLive(_0x295f8e,_0x59bd41){const _0x546117=_0x3e9c6c;dbConfig[_0x546117(0x1e0)]('bots')[_0x546117(0x270)]({'botID':_0x295f8e})[_0x546117(0x26c)]({'live':_0x59bd41})['write'](),config=getConfiguration(),io['to'](_0x546117(0x2f9))[_0x546117(0x210)](_0x546117(0x285),config),broadcastToBots('bots',JSON[_0x546117(0x255)](config));}function updateBotName(_0x5189d4,_0x165803){const _0x46fd45=_0x3e9c6c;dbConfig[_0x46fd45(0x1e0)](_0x46fd45(0x285))[_0x46fd45(0x270)]({'botID':_0x5189d4})['assign']({'botname':_0x165803})['write'](),config=getConfiguration(),io['to'](_0x46fd45(0x2f9))[_0x46fd45(0x210)](_0x46fd45(0x285),config),broadcastToBots('bots',JSON[_0x46fd45(0x255)](config));}function updateBotManager(){const _0x4c2a59=_0x3e9c6c;config=getConfiguration(),io['to'](_0x4c2a59(0x2f9))[_0x4c2a59(0x210)](_0x4c2a59(0x285),config),broadcastToBots(_0x4c2a59(0x285),JSON[_0x4c2a59(0x255)](config));}function toggleBotMode(_0x37d56e){const _0x40ff09=_0x3e9c6c;if(pid[_0x37d56e])pid[_0x37d56e][_0x40ff09(0x153)]({'function':_0x40ff09(0x166),'args':null});else{const _0x219e06=configpath+_0x40ff09(0x2ef)+_0x37d56e+_0x40ff09(0x2be),_0x5e2eb3=fs[_0x40ff09(0x264)](_0x219e06),_0x149756=JSON['parse'](_0x5e2eb3),_0x445c75=_0x149756['bot'][0x0][_0x40ff09(0x2f0)];_0x149756[_0x40ff09(0x2b8)][0x0]['headless']=!_0x445c75;const _0x11e85a=JSON[_0x40ff09(0x255)](_0x149756,null,0x2);fs['writeFileSync'](_0x219e06,_0x11e85a),config=getConfiguration(),io['to']('botmanager')['emit'](_0x40ff09(0x285),config),broadcastToBots(_0x40ff09(0x285),JSON[_0x40ff09(0x255)](config));}}function validateTelegram(_0x317303){const _0x54dc6b=_0x3e9c6c;if(_0x317303[_0x54dc6b(0x220)][_0x54dc6b(0x111)]!=settings[_0x54dc6b(0x25a)]&&'@'+_0x317303[_0x54dc6b(0x220)][_0x54dc6b(0x111)]!=settings[_0x54dc6b(0x25a)]||_0x317303[_0x54dc6b(0xf2)]['id']!=settings[_0x54dc6b(0x1cc)])return sendTelegram(_0x317303['chat']['id'],_0x54dc6b(0x1b2),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x55cd88=_0x3e9c6c;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x4cf9c7=_0x55cd88(0x17e);_0x4cf9c7+='\x0a',_0x4cf9c7+=_0x55cd88(0x11e),_0x4cf9c7+=_0x55cd88(0x12f),_0x4cf9c7+=_0x55cd88(0x276),_0x4cf9c7+=_0x55cd88(0x151),_0x4cf9c7+=_0x55cd88(0x27e),_0x4cf9c7+=_0x55cd88(0x1e9),_0x4cf9c7+=_0x55cd88(0x140),_0x4cf9c7+=_0x55cd88(0x1c5),_0x4cf9c7+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x4cf9c7+=_0x55cd88(0x272),_0x4cf9c7+=_0x55cd88(0x2a0),_0x4cf9c7+=_0x55cd88(0x11c),_0x4cf9c7+=_0x55cd88(0x1d8),_0x4cf9c7+=_0x55cd88(0x1d9);let _0x991f4c='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x991f4c+='\x0a',_0x991f4c+=_0x4cf9c7,tgBot[_0x55cd88(0x1b5)]((_0x166b58,_0x96c4)=>{const _0xeaec53=_0x55cd88;logger[_0xeaec53(0x26b)](getTimeStamp()+_0xeaec53(0x128)),logger[_0xeaec53(0x122)](_0xeaec53(0x110),_0x166b58);}),tgBot[_0x55cd88(0xfe)](async(_0x2386b9,_0x324d8d)=>{const _0x3fab27=_0x55cd88;if(!(!settings[_0x3fab27(0x1cc)]&&_0x2386b9['update']['message'][_0x3fab27(0x1af)]=='/start')){if(!validateTelegram(_0x2386b9))return;}_0x324d8d();}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x189),async _0x1d2cdb=>{const _0x4e0f27=_0x55cd88;if(!settings[_0x4e0f27(0x1cc)])updateSetting(_0x4e0f27(0x1cc),_0x1d2cdb[_0x4e0f27(0xf2)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x1d2cdb))return;await sendTelegram(_0x1d2cdb['chat']['id'],_0x991f4c);}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x23e),async _0x5ebe35=>{const _0x3a5dfd=_0x55cd88;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5ebe35[_0x3a5dfd(0xf2)]['id'],'Notifications\x20enabled');}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x248),async _0x5ca081=>{const _0x5acb25=_0x55cd88;await sendTelegram(_0x5ca081[_0x5acb25(0xf2)]['id'],_0x5acb25(0x268)),updateSetting(_0x5acb25(0x2c6),![]);}),tgBot['command'](_0x55cd88(0x246),async _0xaaa2f1=>{const _0x5db4d7=_0x55cd88,_0x1d5687=Markup[_0x5db4d7(0xf5)]([Markup[_0x5db4d7(0xe8)][_0x5db4d7(0x250)]('Orders',_0x5db4d7(0x239)),Markup[_0x5db4d7(0xe8)]['callback'](_0x5db4d7(0x11f),_0x5db4d7(0x242)),Markup[_0x5db4d7(0xe8)][_0x5db4d7(0x250)]('All','config_all')]);_0xaaa2f1[_0x5db4d7(0x168)](_0x5db4d7(0x104),_0x1d5687);}),tgBot[_0x55cd88(0x1ef)](_0x55cd88(0x239),async _0x360c88=>{const _0x58e4e1=_0x55cd88;_0x360c88[_0x58e4e1(0x174)](),updateSetting(_0x58e4e1(0x215),_0x58e4e1(0x263)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x360c88[_0x58e4e1(0xf2)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x55cd88(0x1ef)](_0x55cd88(0x242),async _0x4f7bc9=>{const _0x2a5ed5=_0x55cd88;_0x4f7bc9['editMessageReplyMarkup'](),updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4f7bc9[_0x2a5ed5(0xf2)]['id'],_0x2a5ed5(0x28c));}),tgBot['action'](_0x55cd88(0x1a7),async _0x5bf7ec=>{const _0x2b08ab=_0x55cd88;_0x5bf7ec['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x2b08ab(0x22e)),updateSetting(_0x2b08ab(0x2c6),!![]),await sendTelegram(_0x5bf7ec['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x287),async _0x4c1d22=>{const _0xb024f9=_0x55cd88,_0x43526b=getBotsWithMode();let _0x3df382=_0xb024f9(0x1d3);config[_0xb024f9(0x16c)](_0x25e63a=>{const _0xe6096a=_0xb024f9,_0x49bd50=_0x43526b['find'](_0x835a46=>_0x835a46[_0xe6096a(0x237)]==_0x25e63a[_0xe6096a(0x237)])[_0xe6096a(0x2f8)];_0x3df382+=_0xe6096a(0x156)+_0x25e63a['botID']+':\x20'+_0x25e63a[_0xe6096a(0x287)]+'\x20|\x20'+_0x49bd50+'\x20|\x20'+_0x25e63a[_0xe6096a(0x173)]+'\x0a';}),_0x3df382+='\x0a',_0x3df382+=_0xb024f9(0x221),_0x3df382+=!settings[_0xb024f9(0x2c6)]?_0xb024f9(0x2e5):'Notifications\x20enabled\x0a',_0x3df382+=settings[_0xb024f9(0x2c6)]?settings[_0xb024f9(0x215)]==_0xb024f9(0x22e)?_0xb024f9(0x244):_0xb024f9(0x23a)+settings[_0xb024f9(0x215)]+'\x20only\x0a':'',await sendTelegram(_0x4c1d22[_0xb024f9(0xf2)]['id'],_0x3df382,{'parse_mode':_0xb024f9(0x10e)});}),tgBot['command']('restart',async _0x21c6c3=>{const _0x3bcbd3=_0x55cd88,_0x25b11c=getEnabledBots();if(_0x25b11c['length']==0x0)await sendTelegram(_0x21c6c3['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x25b11c['length']>0x1)_0x25b11c[_0x3bcbd3(0x200)]({'botID':'all'});let _0x5f3d0a=[],_0x2b19a8=[];const _0x419ae8=_0x25b11c[_0x3bcbd3(0x29e)]%0x4==0x0||_0x25b11c[_0x3bcbd3(0x29e)]%0x4==0x3||_0x25b11c[_0x3bcbd3(0x29e)]%0x3==0x1?0x4:0x3;let _0x4e5f34=0x0;_0x25b11c[_0x3bcbd3(0x16c)]((_0x8714f4,_0x4e8be2)=>{const _0x3428e0=_0x3bcbd3;if(_0x4e8be2%_0x419ae8==0x0)_0x2b19a8=[];_0x2b19a8[_0x3428e0(0x200)](Markup[_0x3428e0(0xe8)][_0x3428e0(0x250)](_0x8714f4[_0x3428e0(0x237)]==_0x3428e0(0x22e)?_0x3428e0(0x2d9):_0x3428e0(0x156)+_0x8714f4[_0x3428e0(0x237)],'restart_'+_0x8714f4['botID'])),_0x4e8be2%_0x419ae8==0x0&&(_0x5f3d0a[_0x4e5f34]=_0x2b19a8,_0x4e5f34++);});const _0x569ee9=Markup['inlineKeyboard'](_0x5f3d0a);_0x21c6c3['reply'](_0x3bcbd3(0xfb),_0x569ee9);}}),tgBot[_0x55cd88(0x1ef)](/restart_(.+)/,async _0x9c28f5=>{const _0x24b925=_0x55cd88,_0x42382e=_0x9c28f5[_0x24b925(0xf9)][0x1];_0x9c28f5[_0x24b925(0x174)](),_0x42382e==_0x24b925(0x22e)?config[_0x24b925(0x16c)](_0x5ef868=>{const _0x54b3d0=_0x24b925;restartBot(_0x5ef868[_0x54b3d0(0x237)]);}):restartBot(_0x42382e);}),tgBot['command']('on',async _0x125e5c=>{const _0x4e61fd=_0x55cd88,_0x27f074=getDisabledBots();if(_0x27f074['length']==0x0)await sendTelegram(_0x125e5c[_0x4e61fd(0xf2)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x27f074[_0x4e61fd(0x29e)]>0x1)_0x27f074['push']({'botID':_0x4e61fd(0x22e)});let _0x42d754=[],_0x49c679=[];const _0x5701bc=_0x27f074['length']%0x4==0x0||_0x27f074['length']%0x4==0x3||_0x27f074[_0x4e61fd(0x29e)]%0x3==0x1?0x4:0x3;let _0x561305=0x0;_0x27f074[_0x4e61fd(0x16c)]((_0x449293,_0x124f46)=>{const _0x4b1f4f=_0x4e61fd;if(_0x124f46%_0x5701bc==0x0)_0x49c679=[];_0x49c679[_0x4b1f4f(0x200)](Markup['button'][_0x4b1f4f(0x250)](_0x449293[_0x4b1f4f(0x237)]==_0x4b1f4f(0x22e)?_0x4b1f4f(0x2d9):'Bot\x20'+_0x449293[_0x4b1f4f(0x237)],'on_'+_0x449293[_0x4b1f4f(0x237)])),_0x124f46%_0x5701bc==0x0&&(_0x42d754[_0x561305]=_0x49c679,_0x561305++);});const _0x27bdae=Markup[_0x4e61fd(0xf5)](_0x42d754);_0x125e5c[_0x4e61fd(0x168)](_0x4e61fd(0x29c),_0x27bdae);}}),tgBot[_0x55cd88(0x1ef)](/on_(.+)/,async _0x37628c=>{const _0x1bdde8=_0x55cd88,_0x3a7484=_0x37628c[_0x1bdde8(0xf9)][0x1];_0x37628c[_0x1bdde8(0x174)]();if(_0x3a7484=='all'){const _0x4f3614=getDisabledBots();await sendTelegram(_0x37628c[_0x1bdde8(0xf2)]['id'],_0x1bdde8(0x253)),_0x4f3614[_0x1bdde8(0x16c)](_0x4fc45d=>{const _0x333b2a=_0x1bdde8;if(_0x4fc45d[_0x333b2a(0x237)]!='all')toggleBot(_0x4fc45d[_0x333b2a(0x237)],toggleStatus(_0x4fc45d['botID']),_0x333b2a(0x266));});}else await sendTelegram(_0x37628c[_0x1bdde8(0xf2)]['id'],_0x1bdde8(0x106)+_0x3a7484),toggleBot(_0x3a7484,toggleStatus(_0x3a7484),_0x1bdde8(0x266));}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x257),async _0x3c6fa7=>{const _0x1161f3=_0x55cd88,_0x3739df=getEnabledBots();if(_0x3739df[_0x1161f3(0x29e)]==0x0)await sendTelegram(_0x3c6fa7[_0x1161f3(0xf2)]['id'],_0x1161f3(0x115));else{if(_0x3739df[_0x1161f3(0x29e)]>0x1)_0x3739df['push']({'botID':'all'});let _0x3914b8=[],_0x29a35d=[];const _0x4f5b91=_0x3739df[_0x1161f3(0x29e)]%0x4==0x0||_0x3739df[_0x1161f3(0x29e)]%0x4==0x3||_0x3739df[_0x1161f3(0x29e)]%0x3==0x1?0x4:0x3;let _0xbb3ac6=0x0;_0x3739df['forEach']((_0x4f5163,_0x3d490e)=>{const _0x5cf33a=_0x1161f3;if(_0x3d490e%_0x4f5b91==0x0)_0x29a35d=[];_0x29a35d[_0x5cf33a(0x200)](Markup[_0x5cf33a(0xe8)]['callback'](_0x4f5163[_0x5cf33a(0x237)]==_0x5cf33a(0x22e)?_0x5cf33a(0x2d9):_0x5cf33a(0x156)+_0x4f5163['botID'],'off_'+_0x4f5163[_0x5cf33a(0x237)])),_0x3d490e%_0x4f5b91==0x0&&(_0x3914b8[_0xbb3ac6]=_0x29a35d,_0xbb3ac6++);});const _0x21795d=Markup[_0x1161f3(0xf5)](_0x3914b8);_0x3c6fa7[_0x1161f3(0x168)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x21795d);}}),tgBot['action'](/off_(.+)/,async _0x15effe=>{const _0xe2d437=_0x55cd88,_0x1f585b=_0x15effe[_0xe2d437(0xf9)][0x1];_0x15effe['editMessageReplyMarkup']();if(_0x1f585b==_0xe2d437(0x22e)){const _0x4b0d02=getEnabledBots();await sendTelegram(_0x15effe['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x4b0d02[_0xe2d437(0x16c)](_0x44a71b=>{const _0x55d3a0=_0xe2d437;if(_0x44a71b[_0x55d3a0(0x237)]!=_0x55d3a0(0x22e))toggleBot(_0x44a71b[_0x55d3a0(0x237)],toggleStatus(_0x44a71b['botID']),_0x55d3a0(0x266));});}else await sendTelegram(_0x15effe[_0xe2d437(0xf2)]['id'],_0xe2d437(0x2b0)+_0x1f585b),toggleBot(_0x1f585b,toggleStatus(_0x1f585b),_0xe2d437(0x266));}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x184),async _0x50e90b=>{const _0x4a40b9=_0x55cd88,_0x154f91=getEnabledBots();if(_0x154f91[_0x4a40b9(0x29e)]==0x0)await sendTelegram(_0x50e90b[_0x4a40b9(0xf2)]['id'],_0x4a40b9(0x115));else{if(_0x154f91[_0x4a40b9(0x29e)]>0x1){let _0x15b73a=[],_0xfc2d8f=[];const _0x23aa5b=_0x154f91['length']%0x4==0x0||_0x154f91[_0x4a40b9(0x29e)]%0x4==0x3||_0x154f91[_0x4a40b9(0x29e)]%0x3==0x1?0x4:0x3;let _0x10f050=0x0;_0x154f91[_0x4a40b9(0x16c)]((_0x57dc3a,_0x140c51)=>{const _0x409ca3=_0x4a40b9;if(_0x140c51%_0x23aa5b==0x0)_0xfc2d8f=[];_0xfc2d8f[_0x409ca3(0x200)](Markup['button']['callback'](_0x409ca3(0x156)+_0x57dc3a['botID'],_0x409ca3(0x19c)+_0x57dc3a[_0x409ca3(0x237)])),_0x140c51%_0x23aa5b==0x0&&(_0x15b73a[_0x10f050]=_0xfc2d8f,_0x10f050++);});const _0x599924=Markup[_0x4a40b9(0xf5)](_0x15b73a);_0x50e90b['reply'](_0x4a40b9(0x2de),_0x599924);}else{const _0x8a9ff5=_0x154f91[0x0][_0x4a40b9(0x237)];if(pid[_0x8a9ff5])pid[_0x8a9ff5][_0x4a40b9(0x153)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x36387=>{const _0x2950d2=_0x55cd88,_0x5a96ae=_0x36387[_0x2950d2(0xf9)][0x1];_0x36387[_0x2950d2(0x174)]();if(pid[_0x5a96ae])pid[_0x5a96ae][_0x2950d2(0x153)]({'function':_0x2950d2(0xee),'args':null});}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x247),async _0x41c84d=>{const _0x5090f1=_0x55cd88,_0x46cad0=getEnabledBots();if(_0x46cad0['length']==0x0)await sendTelegram(_0x41c84d[_0x5090f1(0xf2)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x46cad0[_0x5090f1(0x29e)]>0x1){let _0x3952d8=[],_0x4449ee=[];const _0x54c57a=_0x46cad0[_0x5090f1(0x29e)]%0x4==0x0||_0x46cad0['length']%0x4==0x3||_0x46cad0[_0x5090f1(0x29e)]%0x3==0x1?0x4:0x3;let _0x49bb12=0x0;_0x46cad0[_0x5090f1(0x16c)]((_0x4ae90a,_0x1a4f71)=>{const _0x15ba1d=_0x5090f1;if(_0x1a4f71%_0x54c57a==0x0)_0x4449ee=[];_0x4449ee['push'](Markup[_0x15ba1d(0xe8)]['callback'](_0x15ba1d(0x156)+_0x4ae90a['botID'],_0x15ba1d(0x18e)+_0x4ae90a[_0x15ba1d(0x237)])),_0x1a4f71%_0x54c57a==0x0&&(_0x3952d8[_0x49bb12]=_0x4449ee,_0x49bb12++);});const _0x48e528=Markup[_0x5090f1(0xf5)](_0x3952d8);_0x41c84d[_0x5090f1(0x168)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x48e528);}else{const _0x4517e4=_0x46cad0[0x0][_0x5090f1(0x237)];if(pid[_0x4517e4])pid[_0x4517e4][_0x5090f1(0x153)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x3256ba=>{const _0x6f5167=_0x55cd88,_0x290cf1=_0x3256ba['match'][0x1];_0x3256ba[_0x6f5167(0x174)]();if(pid[_0x290cf1])pid[_0x290cf1]['send']({'function':_0x6f5167(0x1be),'args':null});}),tgBot['command'](_0x55cd88(0x190),async _0x39f319=>{const _0x37ac61=_0x55cd88;await getMessages();if(!updateAvailable)await sendTelegram(_0x39f319[_0x37ac61(0xf2)]['id'],_0x37ac61(0x2d7));else{if(!validInstallation)await sendTelegram(_0x39f319[_0x37ac61(0xf2)]['id'],_0x37ac61(0x176));else{const _0x2af9f3=Markup[_0x37ac61(0xf5)]([Markup['button']['callback'](_0x37ac61(0x120),_0x37ac61(0x226)),Markup['button'][_0x37ac61(0x250)]('No','update_no')]);_0x39f319[_0x37ac61(0x168)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x2af9f3);}}}),tgBot['action'](/update_(.+)/,async _0x4dc6c7=>{const _0x5b8869=_0x55cd88,_0x3b6601=_0x4dc6c7[_0x5b8869(0xf9)][0x1];_0x4dc6c7['editMessageReplyMarkup'](),_0x3b6601=='yes'&&(await sendTelegram(_0x4dc6c7[_0x5b8869(0xf2)]['id'],_0x5b8869(0x26f)),updateBB(_0x5b8869(0x190))),_0x3b6601=='no'&&await sendTelegram(_0x4dc6c7['chat']['id'],_0x5b8869(0x277));}),tgBot[_0x55cd88(0x202)]('reinstall',async _0x1045b5=>{const _0x122e74=_0x55cd88;if(!validInstallation)await sendTelegram(_0x1045b5[_0x122e74(0xf2)]['id'],_0x122e74(0x199));else{const _0x9fadf4=Markup['inlineKeyboard']([Markup['button'][_0x122e74(0x250)](_0x122e74(0x120),_0x122e74(0x1d1)),Markup[_0x122e74(0xe8)]['callback']('No',_0x122e74(0x171))]);_0x1045b5[_0x122e74(0x168)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x9fadf4);}}),tgBot[_0x55cd88(0x1ef)](/reinstall_(.+)/,async _0x1cd880=>{const _0x2ab612=_0x55cd88,_0xd37b5c=_0x1cd880[_0x2ab612(0xf9)][0x1];_0x1cd880[_0x2ab612(0x174)](),_0xd37b5c==_0x2ab612(0x269)&&(await sendTelegram(_0x1cd880[_0x2ab612(0xf2)]['id'],_0x2ab612(0x1e3)),updateBB(_0x2ab612(0x149))),_0xd37b5c=='no'&&await sendTelegram(_0x1cd880[_0x2ab612(0xf2)]['id'],_0x2ab612(0x245));}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x203),async _0x20a5d5=>{const _0x72727e=_0x55cd88,_0x4b9702=getBotsWithMode();if(_0x4b9702[_0x72727e(0x29e)]==0x0)await sendTelegram(_0x20a5d5[_0x72727e(0xf2)]['id'],_0x72727e(0x115));else{let _0x416861=[],_0x32e27d=[];const _0x10b85d=0x2;let _0x1c7034=0x0;_0x4b9702[_0x72727e(0x16c)]((_0x120c5f,_0x18d894)=>{const _0x2b8c4d=_0x72727e;if(_0x18d894%_0x10b85d==0x0)_0x32e27d=[];_0x32e27d['push'](Markup[_0x2b8c4d(0xe8)][_0x2b8c4d(0x250)](_0x2b8c4d(0x156)+_0x120c5f[_0x2b8c4d(0x237)]+'\x20('+_0x120c5f[_0x2b8c4d(0x2f8)]+')',_0x2b8c4d(0x182)+_0x120c5f[_0x2b8c4d(0x237)])),_0x18d894%_0x10b85d==0x0&&(_0x416861[_0x1c7034]=_0x32e27d,_0x1c7034++);});const _0xe7101f=Markup[_0x72727e(0xf5)](_0x416861);_0x20a5d5[_0x72727e(0x168)](_0x72727e(0x109),_0xe7101f);}}),tgBot[_0x55cd88(0x1ef)](/toggle_(.+)/,async _0x238d4b=>{const _0x30ee88=_0x55cd88,_0x471dfc=_0x238d4b[_0x30ee88(0xf9)][0x1];_0x238d4b[_0x30ee88(0x174)]();const _0x5c6c7f=getBotsWithMode(),_0x5e0bec=_0x5c6c7f[_0x30ee88(0x270)](_0x2100e9=>_0x2100e9['botID']==_0x471dfc),_0x106950=_0x5e0bec['mode']==_0x30ee88(0x2dd)?'manual':_0x30ee88(0x2dd);await sendTelegram(_0x238d4b[_0x30ee88(0xf2)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x471dfc+_0x30ee88(0x1b7)+_0x106950+_0x30ee88(0x258)),toggleBotMode(_0x471dfc);}),tgBot['command'](_0x55cd88(0x124),async _0x3decfa=>{const _0x1f6feb=_0x55cd88;let _0x1eac48='';config[_0x1f6feb(0x16c)](_0x2e09cf=>{const _0x150da6=_0x1f6feb;_0x1eac48+='Bot\x20'+_0x2e09cf[_0x150da6(0x237)]+':\x20'+_0x2e09cf[_0x150da6(0x19d)]+'\x0a';}),await sendTelegram(_0x3decfa[_0x1f6feb(0xf2)]['id'],_0x1eac48,{'parse_mode':'HTML'});}),tgBot[_0x55cd88(0x202)](_0x55cd88(0x290),async _0x43ace9=>{const _0x18de41=_0x55cd88;await sendTelegram(_0x43ace9[_0x18de41(0xf2)]['id'],_0x4cf9c7);}),process[_0x55cd88(0x197)](_0x55cd88(0x20b),()=>tgBot[_0x55cd88(0x20a)](_0x55cd88(0x20b))),process[_0x55cd88(0x197)]('SIGTERM',()=>tgBot[_0x55cd88(0x20a)](_0x55cd88(0x16d))),tgBot[_0x55cd88(0x1ff)]();}}function disableTelegram(){const _0x2e613a=_0x3e9c6c;tgBot&&tgBot[_0x2e613a(0x20a)]();}async function sendTelegram(_0x5783c3,_0x3bca92,_0x150e56){const _0x413e79=_0x3e9c6c;_0x150e56={..._0x150e56,'disable_web_page_preview':!![]};try{await tgBot[_0x413e79(0x105)][_0x413e79(0x21a)](_0x5783c3,_0x3bca92,_0x150e56);}catch(_0x3a6787){console[_0x413e79(0x162)](_0x413e79(0x180),_0x3a6787);}}async function sendTelegramBot(_0x4012df,_0x55d559){const _0x3855de=_0x3e9c6c;if(settings[_0x3855de(0x2c6)]){if(settings[_0x3855de(0x215)]==_0x3855de(0x22e)||(_0x55d559[_0x3855de(0x222)]=='error'||_0x55d559[_0x3855de(0x222)]=='warning'||_0x55d559['type']==_0x3855de(0x17a))&&settings[_0x3855de(0x215)]==_0x3855de(0x10c)||_0x55d559[_0x3855de(0x222)]==_0x3855de(0x1da)&&settings[_0x3855de(0x215)]==_0x3855de(0x263)){if(tgBot&&settings[_0x3855de(0x1cc)]){if(_0x55d559[_0x3855de(0x229)])await sendTelegram(settings[_0x3855de(0x1cc)],_0x55d559[_0x3855de(0x19d)]+_0x3855de(0x297)+_0x55d559[_0x3855de(0x275)]);else await sendTelegram(settings[_0x3855de(0x1cc)],_0x3855de(0x156)+_0x4012df+_0x3855de(0x297)+_0x55d559[_0x3855de(0x275)]);}}}}async function sendTelegramMsg(_0x3e7d20,_0xc5c798='HTML'){const _0x3e25f5=_0x3e9c6c;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x3e25f5(0x1cc)],_0x3e7d20,{'parse_mode':_0xc5c798}),!![]):![];}function getDeviceWithIp(_0x24c0e7){const _0x50c967=_0x3e9c6c;return devices[_0x50c967(0x270)](_0xff5078=>_0xff5078['ip']===_0x24c0e7);}async function temporaryAccess2FA(_0x4c8253,_0x349e7e){const _0x1e77be=_0x3e9c6c;let _0x5a803c=new Date(),_0x5d424c=![];if(lastIpApproval){if(_0x5a803c-lastIpApproval<0x1388)_0x5d424c=!![];}lastIpApproval=new Date();if(_0x5d424c)return;if(tgBot&&settings[_0x1e77be(0x1cc)]){const _0x2dfa3f=uuidRandom();tmpStorage[_0x2dfa3f]={'uuid':_0x4c8253,'externalip':_0x349e7e};const _0x3c7075=Markup[_0x1e77be(0xf5)]([Markup[_0x1e77be(0xe8)][_0x1e77be(0x250)](_0x1e77be(0x1f6),_0x1e77be(0x12a)+_0x2dfa3f),Markup[_0x1e77be(0xe8)][_0x1e77be(0x250)](_0x1e77be(0x217),_0x1e77be(0x1de)+_0x2dfa3f),Markup[_0x1e77be(0xe8)][_0x1e77be(0x250)](_0x1e77be(0x117),_0x1e77be(0x16a)+_0x2dfa3f),Markup['button'][_0x1e77be(0x250)](_0x1e77be(0x1b0),'tempaccess_reject_'+_0x2dfa3f)]);await sendTelegram(settings['telegramChatId'],_0x1e77be(0x274)+normalizeIP(_0x349e7e)[_0x1e77be(0x1a3)]+'\x20?',_0x3c7075),tgBot[_0x1e77be(0x1ef)](/tempaccess_(.+)_(.+)/,async _0x47c61c=>{const _0x472714=_0x1e77be,_0x1831e7=_0x47c61c[_0x472714(0xf9)][0x1],_0x26ad71=_0x47c61c[_0x472714(0xf9)][0x2],{uuid:_0x43e0aa,externalip:_0x412a47}=tmpStorage[_0x26ad71];delete tmpStorage[_0x26ad71],_0x47c61c[_0x472714(0x174)](),devices[_0x43e0aa][_0x472714(0x1e5)]={'clientip':_0x412a47,'timestamp':new Date()[_0x472714(0x2cb)](),'expiry':_0x1831e7},_0x1831e7!='reject'?(await sendTelegram(_0x47c61c[_0x472714(0xf2)]['id'],_0x472714(0x1c7)+_0x1831e7+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x43e0aa)[_0x472714(0x210)](_0x472714(0x287),{'access':{'allow':![],'reason':_0x472714(0x1a5),'token':null}})):(await sendTelegram(_0x47c61c[_0x472714(0xf2)]['id'],_0x472714(0x2a4)),io['to'](_0x43e0aa)[_0x472714(0x210)](_0x472714(0x287),{'access':{'allow':![],'reason':_0x472714(0x28b),'token':null}}));});}}async function loginAccess2FA(_0x57e7fa,_0x59fb81){const _0xe348c1=_0x3e9c6c;if(tgBot&&settings[_0xe348c1(0x1cc)]){const _0x24f939=uuidRandom();tmpStorage[_0x24f939]={'uuid':_0x57e7fa,'externalip':_0x59fb81};const _0x159779=Markup['inlineKeyboard']([Markup['button']['callback'](_0xe348c1(0xff),_0xe348c1(0xfc)+loginExpiry+'_'+_0x24f939),Markup[_0xe348c1(0xe8)][_0xe348c1(0x250)](_0xe348c1(0x1b0),'login2fa_reject_'+_0x24f939)]);await sendTelegram(settings['telegramChatId'],_0xe348c1(0x224)+normalizeIP(_0x59fb81)[_0xe348c1(0x1a3)]+'\x20?',_0x159779),tgBot[_0xe348c1(0x1ef)](/login2fa_(.+)_(.+)/,async _0x37b925=>{const _0xf9c116=_0xe348c1,_0x48ea1f=_0x37b925['match'][0x1],_0x4da76d=_0x37b925[_0xf9c116(0xf9)][0x2],{uuid:_0x19e37d,externalip:_0x4c3a01}=tmpStorage[_0x4da76d];delete tmpStorage[_0x4da76d],_0x37b925[_0xf9c116(0x174)](),devices[_0x19e37d][_0xf9c116(0x282)]={'clientip':_0x4c3a01,'timestamp':new Date()['getTime'](),'expiry':_0x48ea1f},_0x48ea1f!=_0xf9c116(0x1b0)?(await sendTelegram(_0x37b925[_0xf9c116(0xf2)]['id'],_0xf9c116(0x295),{'parse_mode':_0xf9c116(0x10e)}),io['to'](_0x19e37d)['emit'](_0xf9c116(0x287),{'access':{'allow':![],'reason':_0xf9c116(0x1a5),'token':null}})):(await sendTelegram(_0x37b925['chat']['id'],_0xf9c116(0x101)),io['to'](_0x19e37d)[_0xf9c116(0x210)]('status',{'access':{'allow':![],'reason':_0xf9c116(0x1c9),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x31398e=_0x3e9c6c;return dbConfig[_0x31398e(0x1e0)](_0x31398e(0x285))[_0x31398e(0x15b)]('botID')[_0x31398e(0x2e2)]({'status':_0x31398e(0x14d)})[_0x31398e(0x21f)]()||[];}function getDisabledBots(){const _0x291c26=_0x3e9c6c;return dbConfig[_0x291c26(0x1e0)](_0x291c26(0x285))['sortBy'](_0x291c26(0x237))[_0x291c26(0x2e2)]({'status':_0x291c26(0xed)})[_0x291c26(0x21f)]()||[];}function getBotAttributes(_0x5e8f85){const _0x474225=_0x3e9c6c;let _0x38df4c={};const _0x2eb227=configpath+_0x474225(0x2ef)+_0x5e8f85+_0x474225(0x2be),_0x476ef9=fs[_0x474225(0x116)](_0x2eb227);if(_0x476ef9){const _0x4762f9=fs[_0x474225(0x264)](_0x2eb227);try{const _0x417749=JSON[_0x474225(0x159)](_0x4762f9),_0x14646a=_0x417749?_0x417749[_0x474225(0x2b8)][0x0][_0x474225(0x2f0)]:![];_0x38df4c['mode']=_0x14646a?_0x474225(0x2dd):_0x474225(0x280),_0x38df4c[_0x474225(0x19d)]=_0x417749?_0x417749[_0x474225(0x2b8)][0x0][_0x474225(0x19d)]:_0x474225(0x156)+_0x5e8f85;}catch(_0x5675de){_0x38df4c['mode']=_0x474225(0x280),_0x38df4c['botname']=_0x474225(0x156)+_0x5e8f85;}}else _0x38df4c[_0x474225(0x2f8)]=_0x474225(0x280),_0x38df4c[_0x474225(0x19d)]=_0x474225(0x156)+_0x5e8f85;return _0x38df4c;}function getBotsWithMode(){const _0x2bd1e5=_0x3e9c6c,_0x1036fa=dbConfig[_0x2bd1e5(0x1e0)](_0x2bd1e5(0x285))[_0x2bd1e5(0x15b)]('botID')[_0x2bd1e5(0x21f)]()||[];return _0x1036fa['forEach'](_0x2c3ff6=>{const _0x2434b7=_0x2bd1e5;let _0xb8fa59=getBotAttributes(_0x2c3ff6[_0x2434b7(0x237)]);_0x2c3ff6[_0x2434b7(0x2f8)]=_0xb8fa59[_0x2434b7(0x2f8)];}),_0x1036fa;}function getBotExchanges(){const _0x154f31=_0x3e9c6c;let _0x1ed711=[];const _0x2af638=dbConfig[_0x154f31(0x1e0)](_0x154f31(0x285))[_0x154f31(0x15b)](_0x154f31(0x237))['value']()||[];_0x2af638[_0x154f31(0x16c)](_0x2f0be8=>{const _0x3a1df7=_0x154f31;if(_0x2f0be8[_0x3a1df7(0x287)]==_0x3a1df7(0x14d)){const _0x4dde40=configpath+'bot-'+_0x2f0be8[_0x3a1df7(0x237)]+_0x3a1df7(0x2be),_0x3186bf=fs[_0x3a1df7(0x116)](_0x4dde40);let _0x386e7f;if(_0x3186bf){const _0x53574c=fs[_0x3a1df7(0x264)](_0x4dde40);try{const _0x444de7=JSON['parse'](_0x53574c);_0x386e7f=_0x444de7?_0x444de7[_0x3a1df7(0x2b8)][0x0][_0x3a1df7(0x1e8)]:null;}catch(_0x255938){}}if(_0x386e7f)_0x1ed711['push'](_0x386e7f);}});const _0x46e771=[...new Set(_0x1ed711)]['sort']();return _0x46e771;}async function initUser(){const _0x14a1ca=_0x3e9c6c;if(!settings[_0x14a1ca(0x1c2)]){const _0x4be90e=uuidRandom();mixpanel[_0x14a1ca(0x2f2)](_0x4be90e),updateSetting(_0x14a1ca(0x1c2),_0x4be90e);}}async function initSecure(){const _0xe22ec9=_0x3e9c6c;let _0x1e1627=getSecure();if(!_0x1e1627[_0xe22ec9(0x27d)](_0xe22ec9(0x294))){let _0x38b65c=await generateKeys();_0x1e1627[_0xe22ec9(0x2bf)]=_0x38b65c[_0xe22ec9(0x2bf)],_0x1e1627[_0xe22ec9(0x15d)]=_0x38b65c[_0xe22ec9(0x15d)],_0x1e1627['secret']=crypto[_0xe22ec9(0x284)](0x20)[_0xe22ec9(0x139)]('hex');;storeSecure(_0x1e1627);}}function getSettings(){const _0x9a332d=_0x3e9c6c;return dbSettings[_0x9a332d(0x1e0)]('settings')['value']()||{};}function getSecure(){const _0x7375b5=_0x3e9c6c;return dbSecure['get'](_0x7375b5(0x1ee))['value']()||{};}function getBlacklist(){const _0x406066=_0x3e9c6c;return dbSecure[_0x406066(0x1e0)]('blacklist')['value']()||[];}function broadcastToBots(_0x47cf,_0xe28ad2){const _0x6b99a9=_0x3e9c6c;config[_0x6b99a9(0x16c)](_0x27fbb0=>{const _0x5e385c=_0x6b99a9;if(_0x27fbb0[_0x5e385c(0x287)]==_0x5e385c(0x14d)&&_0x27fbb0[_0x5e385c(0x173)]==_0x5e385c(0x2fc)||_0x27fbb0[_0x5e385c(0x287)]==_0x5e385c(0x209)&&_0x27fbb0[_0x5e385c(0x173)]=='running'){if(pid[_0x27fbb0[_0x5e385c(0x237)]])pid[_0x27fbb0['botID']][_0x5e385c(0x153)]({[_0x47cf]:_0xe28ad2});}});}async function storeSettings(_0x2a1ef1,_0x45fea3=![]){const _0x28b95d=_0x3e9c6c;_0x2a1ef1={...settings,..._0x2a1ef1};if(_0x45fea3&&_0x2a1ef1[_0x28b95d(0x21d)]!=_0x28b95d(0x198)&&_0x2a1ef1['bbPassword']!='***'&&_0x2a1ef1['bbPassword']!=''){const _0x1cd069=crypt[_0x28b95d(0x2ea)](secure['privateKey'],_0x2a1ef1['bbPassword'])['message']['split']('|@|')[0x0],_0x303179=bcrypt[_0x28b95d(0x1f8)](_0x1cd069,saltRounds);_0x2a1ef1={..._0x2a1ef1,'bbPassword':_0x303179};}if(_0x45fea3&&_0x2a1ef1[_0x28b95d(0x14c)]!=_0x28b95d(0x198)&&_0x2a1ef1[_0x28b95d(0x14c)]!='***'&&_0x2a1ef1[_0x28b95d(0x14c)]!=''){const _0x6ed888=crypt[_0x28b95d(0x2ea)](secure[_0x28b95d(0x15d)],_0x2a1ef1[_0x28b95d(0x14c)])[_0x28b95d(0x27b)][_0x28b95d(0x2f1)](_0x28b95d(0x249))[0x0];_0x2a1ef1={..._0x2a1ef1,'telegramToken':_0x6ed888};}if(_0x45fea3&&_0x2a1ef1[_0x28b95d(0xf8)]!=_0x28b95d(0x198)&&_0x2a1ef1['marketcapApi']!=_0x28b95d(0x1f9)&&_0x2a1ef1[_0x28b95d(0xf8)]!=''){const _0x31dd9e=crypt[_0x28b95d(0x2ea)](secure[_0x28b95d(0x15d)],_0x2a1ef1[_0x28b95d(0xf8)])[_0x28b95d(0x27b)][_0x28b95d(0x2f1)](_0x28b95d(0x249))[0x0];_0x2a1ef1={..._0x2a1ef1,'marketcapApi':_0x31dd9e};}const _0x43661d=_0x2a1ef1['telegramToken']!=_0x28b95d(0x198)&&_0x2a1ef1['telegramToken']!=settings['telegramToken']||_0x2a1ef1[_0x28b95d(0x25a)]!=settings[_0x28b95d(0x25a)],_0xb898dd=_0x2a1ef1[_0x28b95d(0x14c)]==''||_0x2a1ef1['telegramUsername']=='',_0x3460f7=_0x2a1ef1[_0x28b95d(0xf8)]&&_0x2a1ef1[_0x28b95d(0xf8)]!=_0x28b95d(0x198)&&_0x2a1ef1['marketcapApi']!=settings[_0x28b95d(0x14c)];_0x43661d&&(_0x2a1ef1[_0x28b95d(0x1cc)]=null,_0x2a1ef1[_0x28b95d(0x215)]='all');for(const [_0xbe52ee,_0x4b58e9]of Object[_0x28b95d(0x13c)](_0x2a1ef1)){if(_0xbe52ee==_0x28b95d(0x14c)&&_0x4b58e9==_0x28b95d(0x198)){_0x2a1ef1['telegramToken']=settings['telegramToken'];continue;};if(_0xbe52ee=='bbPassword'&&_0x4b58e9=='************'){_0x2a1ef1['bbPassword']=settings['bbPassword'];continue;};if(_0xbe52ee==_0x28b95d(0xf8)&&_0x4b58e9==_0x28b95d(0x198)){_0x2a1ef1[_0x28b95d(0xf8)]=settings[_0x28b95d(0xf8)];continue;};dbSettings['set'](_0x28b95d(0xf0)+_0xbe52ee,_0x4b58e9)[_0x28b95d(0x16f)]();}settings=_0x2a1ef1,io['to'](_0x28b95d(0x2f9))[_0x28b95d(0x210)](_0x28b95d(0x146),cleanSettings()),broadcastToBots(_0x28b95d(0xfa),settings[_0x28b95d(0xfa)]),broadcastToBots(_0x28b95d(0x196),settings['onepagemode']),broadcastToBots(_0x28b95d(0xf8),settings[_0x28b95d(0xf8)]);if(_0x43661d&&!_0xb898dd)initTelegram();if(_0x43661d&&_0xb898dd)disableTelegram();getAllClients()[_0x28b95d(0x16c)](_0x4a2ee0=>{const _0x2c6eec=_0x28b95d;getSocket(_0x4a2ee0['id'])['emit'](_0x2c6eec(0x287),{'access':{'allow':![],'reason':_0x2c6eec(0x1a5),'token':null}});}),_0x3460f7&&(await sleep(0xbb8),testMarketcapApi(_0x2a1ef1['marketcapApi']));}async function testMarketcapApi(_0x2f9054){const _0x210443=_0x3e9c6c,_0x107a31=['BCT','ETH'];try{await axios['get'](_0x210443(0x1dd),{'headers':{'X-CMC_PRO_API_KEY':_0x2f9054},'params':{'symbol':_0x107a31[_0x210443(0x139)]()}});}catch(_0x415d9b){_0x415d9b[_0x210443(0x139)]()[_0x210443(0x205)]('status\x20code\x20401')?(io['to'](_0x210443(0x2f9))['emit'](_0x210443(0x1cd),_0x210443(0x1b9)),logger['full'](_0x210443(0x1b9))):(io['to']('botmanager')[_0x210443(0x210)](_0x210443(0x1cd),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x210443(0x2ce)](_0x210443(0x233)),logger['debug'](_0x210443(0x1d4),_0x415d9b['toString']()+_0x210443(0x243)+_0x415d9b[_0x210443(0x1ea)]));return;}logger[_0x210443(0x122)](_0x210443(0x1c3));}function updateSetting(_0x151570,_0x27c131){const _0x2f79ba=_0x3e9c6c;dbSettings[_0x2f79ba(0x1f0)](_0x2f79ba(0xf0)+_0x151570,_0x27c131)[_0x2f79ba(0x16f)](),settings=getSettings(),io['to'](_0x2f79ba(0x2f9))[_0x2f79ba(0x210)](_0x2f79ba(0x146),cleanSettings());}function storeSecure(_0x3954dc){const _0x3cb56a=_0x3e9c6c;dbSecure[_0x3cb56a(0x1e0)]('secure')[_0x3cb56a(0x200)](_0x3954dc)[_0x3cb56a(0x16f)](),secure=_0x3954dc;}function addBlacklist(_0x589da9){const _0x3be748=_0x3e9c6c;cleanBlacklist();let _0x42b9eb;devices[_0x589da9][_0x3be748(0x1e5)]?_0x42b9eb=Math[_0x3be748(0x17b)](devices[_0x589da9][_0x3be748(0x1e5)][_0x3be748(0x170)],loginExpiry):_0x42b9eb=loginExpiry,dbSecure[_0x3be748(0x1e0)](_0x3be748(0x17c))[_0x3be748(0x200)]({'expiry':new Date()[_0x3be748(0x2cb)]()+_0x42b9eb*0x3c*0x3e8,'token':devices[_0x589da9][_0x3be748(0x144)]['token']})[_0x3be748(0x16f)](),blacklist=dbSecure[_0x3be748(0x1e0)]('blacklist')['value']();}function cleanBlacklist(){const _0x465d4d=_0x3e9c6c;let _0x362879=dbSecure[_0x465d4d(0x1e0)](_0x465d4d(0x17c))[_0x465d4d(0x298)]()[_0x465d4d(0x21f)](),_0x27776e=new Date()[_0x465d4d(0x2cb)]();_0x362879[_0x465d4d(0x16c)](_0x42276e=>{const _0x30d7ee=_0x465d4d;_0x42276e[_0x30d7ee(0x170)]<_0x27776e&&dbSecure['get'](_0x30d7ee(0x17c))['remove']({'expiry':_0x42276e[_0x30d7ee(0x170)]})[_0x30d7ee(0x16f)]();});}function initStates(){let _0x55f691=getConfiguration();_0x55f691['forEach'](_0x3b34c6=>{const _0x4f9eca=_0x47e5;_0x3b34c6[_0x4f9eca(0x173)]=_0x4f9eca(0x266);}),storeConfiguration(_0x55f691);}function onKeys(){const _0x5819d9=new RSA();return new Promise(_0x2970e1=>{const _0x56bf5a=_0x47e5;_0x5819d9['generateKeyPairAsync']()[_0x56bf5a(0xf3)](_0x17de26=>{_0x2970e1(_0x17de26);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x525ef7=_0x3e9c6c;let _0x3499c3=getSettings(),_0x44979b=![];!_0x3499c3[_0x525ef7(0x27d)](_0x525ef7(0x160))&&(_0x3499c3[_0x525ef7(0x160)]=0x0,_0x44979b=!![]);!_0x3499c3[_0x525ef7(0x27d)]('lastmsgemitted')&&(_0x3499c3[_0x525ef7(0x262)]=0x0,_0x44979b=!![]);!_0x3499c3[_0x525ef7(0x27d)]('latestversion')&&(_0x3499c3['latestversion']=_0x525ef7(0x1fe),_0x44979b=!![]);!_0x3499c3[_0x525ef7(0x27d)]('onepagemode')&&(_0x3499c3[_0x525ef7(0x196)]=![],_0x44979b=!![]);!_0x3499c3[_0x525ef7(0x27d)](_0x525ef7(0xf8))&&(_0x3499c3[_0x525ef7(0xf8)]='',_0x44979b=!![]);if(_0x44979b)storeSettings(_0x3499c3);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x30fbfb=>{const _0x1192f5=_0x525ef7;if(!_0x30fbfb[_0x1192f5(0x1f1)]()){if(!_0x30fbfb['name']['startsWith'](_0x1192f5(0x135)))fs['unlinkSync'](configbackuppath+_0x30fbfb[_0x1192f5(0x172)]);}else fs[_0x1192f5(0x2af)](configbackuppath+_0x30fbfb['name'],{'recursive':!![]});});}catch(_0x13a87a){logger[_0x525ef7(0x122)](_0x525ef7(0x1ab),_0x13a87a);}}function storeConfiguration(_0x4fbe93){const _0x4eda50=_0x3e9c6c;dbConfig[_0x4eda50(0x1e0)](_0x4eda50(0x285))[_0x4eda50(0x179)]()['write'](),dbConfig[_0x4eda50(0x1e0)](_0x4eda50(0x285))[_0x4eda50(0x200)](..._0x4fbe93)[_0x4eda50(0x16f)](),config=_0x4fbe93;}async function resetPassword(){const _0x123c3e=_0x3e9c6c;if(tgBot&&settings[_0x123c3e(0x1cc)]){const _0x484ea6=Markup[_0x123c3e(0xf5)]([Markup[_0x123c3e(0xe8)][_0x123c3e(0x250)]('yes',_0x123c3e(0x1ce)),Markup[_0x123c3e(0xe8)][_0x123c3e(0x250)]('no',_0x123c3e(0x213))]);await sendTelegram(settings[_0x123c3e(0x1cc)],_0x123c3e(0x16e),_0x484ea6),tgBot[_0x123c3e(0x1ef)](/resetpw_(.+)/,async _0x47fd5a=>{const _0x34bb1b=_0x123c3e,_0x353303=_0x47fd5a[_0x34bb1b(0xf9)][0x1];_0x47fd5a[_0x34bb1b(0x174)]();if(_0x353303!='no'){const _0x1678cc=0xf,_0x48be86='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0xc4a91b=Array[_0x34bb1b(0x220)](crypto[_0x34bb1b(0x123)](new Uint32Array(_0x1678cc)))['map'](_0x9c4144=>_0x48be86[_0x9c4144%_0x48be86[_0x34bb1b(0x29e)]])[_0x34bb1b(0x28f)](''),_0x229a37=bcrypt['hashSync'](_0xc4a91b,saltRounds);storeSettings({'bbPassword':_0x229a37}),await sendTelegram(_0x47fd5a['chat']['id'],_0x34bb1b(0x2fb)+_0xc4a91b,{'parse_mode':_0x34bb1b(0x10e)});}else await sendTelegram(_0x47fd5a[_0x34bb1b(0xf2)]['id'],_0x34bb1b(0x183));});}}async function confirmRestore(_0x1608ae,_0x595a92){const _0x10eb58=_0x3e9c6c;io['to'](_0x10eb58(0x2f9))[_0x10eb58(0x210)](_0x10eb58(0x1cd),_0x10eb58(0x2c5),'success');if(tgBot&&settings[_0x10eb58(0x1cc)]){const _0x3e895f=uuidRandom();tmpStorage[_0x3e895f]={'path':_0x1608ae,'filename':_0x595a92};const _0x38730d=Markup[_0x10eb58(0xf5)]([Markup[_0x10eb58(0xe8)][_0x10eb58(0x250)](_0x10eb58(0x269),_0x10eb58(0x2ad)+_0x3e895f),Markup[_0x10eb58(0xe8)]['callback']('no',_0x10eb58(0x2d3)+_0x3e895f)]);await sendTelegram(settings[_0x10eb58(0x1cc)],_0x10eb58(0x136),_0x38730d),tgBot[_0x10eb58(0x1ef)](/restore_(.+)_(.+)/,async _0x60c485=>{const _0xec1127=_0x10eb58,_0x2e666b=_0x60c485['match'][0x1],_0x14e3f5=_0x60c485[_0xec1127(0xf9)][0x2],{path:_0x1c41fd,filename:_0x390398}=tmpStorage[_0x14e3f5];delete tmpStorage[_0x14e3f5],_0x60c485[_0xec1127(0x174)](),_0x2e666b=='yes'?(logger[_0xec1127(0x122)](_0xec1127(0x1fb)),await sendTelegram(_0x60c485[_0xec1127(0xf2)]['id'],_0xec1127(0x2a9),{'parse_mode':_0xec1127(0x10e)}),unzipFile(_0x1c41fd,_0x390398)):(logger[_0xec1127(0x122)](_0xec1127(0x12b)),await sendTelegram(_0x60c485[_0xec1127(0xf2)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x2c3959=_0x3e9c6c,_0x378c49=new Date();return _0x378c49[_0x2c3959(0x2a3)]()+'/'+(_0x378c49[_0x2c3959(0x165)]()+0x1)['toString']()[_0x2c3959(0x2f3)](0x2,'0')+'/'+_0x378c49['getDate']()[_0x2c3959(0x139)]()[_0x2c3959(0x2f3)](0x2,'0')+'\x20'+_0x378c49[_0x2c3959(0x157)]()['toString']()[_0x2c3959(0x2f3)](0x2,'0')+':'+_0x378c49[_0x2c3959(0x2df)]()[_0x2c3959(0x139)]()[_0x2c3959(0x2f3)](0x2,'0')+':'+_0x378c49['getSeconds']()[_0x2c3959(0x139)]()[_0x2c3959(0x2f3)](0x2,'0');}function getTimeStamp(){const _0x4f6c1b=_0x3e9c6c,_0x199d7f=shiftedTime();return _0x199d7f[_0x4f6c1b(0x2a3)]()+'/'+(_0x199d7f[_0x4f6c1b(0x165)]()+0x1)[_0x4f6c1b(0x139)]()[_0x4f6c1b(0x2f3)](0x2,'0')+'/'+_0x199d7f[_0x4f6c1b(0x2d4)]()[_0x4f6c1b(0x139)]()[_0x4f6c1b(0x2f3)](0x2,'0')+'\x20'+_0x199d7f[_0x4f6c1b(0x157)]()[_0x4f6c1b(0x139)]()[_0x4f6c1b(0x2f3)](0x2,'0')+':'+_0x199d7f[_0x4f6c1b(0x2df)]()[_0x4f6c1b(0x139)]()[_0x4f6c1b(0x2f3)](0x2,'0')+':'+_0x199d7f['getSeconds']()[_0x4f6c1b(0x139)]()[_0x4f6c1b(0x2f3)](0x2,'0');}function getCleanTimeStamp(){const _0x80b325=_0x3e9c6c,_0xce9cda=shiftedTime();return _0xce9cda['getFullYear']()+(_0xce9cda[_0x80b325(0x165)]()+0x1)[_0x80b325(0x139)]()[_0x80b325(0x2f3)](0x2,'0')+_0xce9cda['getDate']()['toString']()[_0x80b325(0x2f3)](0x2,'0')+'-'+_0xce9cda[_0x80b325(0x157)]()[_0x80b325(0x139)]()['padStart'](0x2,'0')+_0xce9cda[_0x80b325(0x2df)]()[_0x80b325(0x139)]()['padStart'](0x2,'0')+_0xce9cda[_0x80b325(0x1d2)]()[_0x80b325(0x139)]()['padStart'](0x2,'0');}function shiftedTime(){const _0xea8428=_0x3e9c6c,_0x55d785=new Date();let _0x20caaa=_0x55d785;if(settings[_0xea8428(0xfa)]&&settings[_0xea8428(0xfa)]!==0x0)_0x20caaa=fns[_0xea8428(0x134)](_0x55d785,{'hours':settings[_0xea8428(0xfa)]});return _0x20caaa;}async function startScheduler(){const _0x33439a=_0x3e9c6c,_0x343af3=new Date()[_0x33439a(0x231)](),_0x4a4ab6=shiftedTime()[_0x33439a(0x157)]();_0x4a4ab6==0x4&&backupConfigFiles(),_0x4a4ab6==0x0&&rotateLogFiles(),_0x343af3%0x6==0x0&&triggerAnalytics(),_0x343af3%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xc253c2){const _0x16eaca=_0x3e9c6c;logger[_0x16eaca(0x122)](_0x16eaca(0x23d)+_0xc253c2);const _0x5b2cf4=getBotsWithMode();_0x5b2cf4[_0x16eaca(0x29e)]>0x0?confirmRestore(configbackuppath,_0xc253c2):unzipFile(configbackuppath,_0xc253c2);}async function getBackupFiles(_0x5d76a9=null){const _0x1d246e=_0x3e9c6c;let _0x263189=[],_0x32b0bb=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x32b0bb[_0x1d246e(0x18b)]((_0x7b1115,_0x473e55)=>_0x7b1115[_0x1d246e(0x172)]<_0x473e55['name']?0x1:_0x473e55['name']<_0x7b1115[_0x1d246e(0x172)]?-0x1:0x0),_0x32b0bb[_0x1d246e(0x16c)](_0x47d7d5=>{const _0x14257a=_0x1d246e;if(!_0x47d7d5[_0x14257a(0x1f1)]()&&_0x47d7d5[_0x14257a(0x172)][_0x14257a(0x131)](_0x14257a(0x135))&&_0x47d7d5[_0x14257a(0x172)][_0x14257a(0x2bc)](_0x14257a(0x127))){const _0x239122=formatDate(fs[_0x14257a(0xf6)](configbackuppath+_0x47d7d5[_0x14257a(0x172)])['mtime']);_0x263189[_0x14257a(0x200)]({'name':_0x47d7d5[_0x14257a(0x172)],'mtime':_0x239122});}});if(_0x5d76a9)io['to'](_0x5d76a9)[_0x1d246e(0x210)](_0x1d246e(0x1d7),_0x263189);else return _0x263189;}async function backupConfigFiles(){const _0x4bc06f=_0x3e9c6c;await zipFiles(_0x4bc06f(0x150));const _0x844af5=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x4bc06f(0x135)+_0x844af5+_0x4bc06f(0x127)));let _0x3a8ba0=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3a8ba0['sort']((_0x342696,_0x378ec2)=>_0x342696[_0x4bc06f(0x172)]<_0x378ec2[_0x4bc06f(0x172)]?0x1:_0x378ec2[_0x4bc06f(0x172)]<_0x342696[_0x4bc06f(0x172)]?-0x1:0x0),_0x3a8ba0['length']>maxBackups&&fs[_0x4bc06f(0x291)](configbackuppath+_0x3a8ba0[_0x3a8ba0[_0x4bc06f(0x29e)]-0x1][_0x4bc06f(0x172)]);}function rotateLogFiles(){const _0x53ed3b=_0x3e9c6c,_0x56bdcb=fs[_0x53ed3b(0xf6)](logspath+_0x53ed3b(0x1ca)),_0x145e70=_0x56bdcb[_0x53ed3b(0x2a7)]/0x400;if(_0x145e70>0x64){let _0x20cf82=fs[_0x53ed3b(0x118)](logspath,{'withFileTypes':!![]});_0x20cf82['sort']((_0x12c763,_0xbe77be)=>_0x12c763[_0x53ed3b(0x172)]<_0xbe77be[_0x53ed3b(0x172)]?0x1:_0xbe77be[_0x53ed3b(0x172)]<_0x12c763[_0x53ed3b(0x172)]?-0x1:0x0),_0x20cf82[_0x53ed3b(0x16c)](_0x558529=>{const _0x492ccf=_0x53ed3b;if(_0x558529[_0x492ccf(0x172)]==_0x492ccf(0x2b2))fs[_0x492ccf(0x24e)](logspath+_0x558529[_0x492ccf(0x172)],logspath+_0x492ccf(0x26d));if(_0x558529['name']==_0x492ccf(0x218))fs['copyFileSync'](logspath+_0x558529[_0x492ccf(0x172)],logspath+'output-002.log');_0x558529[_0x492ccf(0x172)]==_0x492ccf(0x1ca)&&(fs[_0x492ccf(0x24e)](logspath+_0x558529['name'],logspath+_0x492ccf(0x218)),fs[_0x492ccf(0x204)](logspath+_0x558529[_0x492ccf(0x172)],''));});}}async function zipFiles(_0xc94683){const _0x2060f6=_0x3e9c6c;let _0x2b02e0;if(_0xc94683=='logs')_0x2b02e0=logspath;if(_0xc94683==_0x2060f6(0x2c8))_0x2b02e0=configpath;if(_0xc94683==_0x2060f6(0x150))_0x2b02e0=configpath;let _0x3646c8=fs['readdirSync'](_0x2b02e0,{'withFileTypes':!![]});const _0x3c3e56=new require(_0x2060f6(0x137))();_0x3646c8['forEach'](_0x394368=>{const _0x2f9669=_0x2060f6;if(!_0x394368[_0x2f9669(0x1f1)]()){let _0x265a3f=fs[_0x2f9669(0x264)](_0x2b02e0+_0x394368['name']);if(_0xc94683==_0x2f9669(0x2c8)){const _0x1206ca=/^bot-[0-9]{3}-config.json$/,_0x427097=_0x1206ca[_0x2f9669(0x143)](_0x394368[_0x2f9669(0x172)]);if(_0x427097){const _0x1eeb00=JSON['parse'](_0x265a3f);if(_0x1eeb00[_0x2f9669(0x2b8)][0x0]){_0x1eeb00[_0x2f9669(0x2b8)][0x0][_0x2f9669(0x2cc)]=_0x2f9669(0x1f9),_0x1eeb00[_0x2f9669(0x2b8)][0x0][_0x2f9669(0x14e)]=_0x2f9669(0x1f9);if(_0x1eeb00['bot'][0x0][_0x2f9669(0x1eb)])_0x1eeb00[_0x2f9669(0x2b8)][0x0][_0x2f9669(0x1eb)]=_0x2f9669(0x1f9);}_0x265a3f=JSON[_0x2f9669(0x255)](_0x1eeb00,null,0x2);}if(_0x394368[_0x2f9669(0x172)]==_0x2f9669(0xf1)){const _0x16205c=JSON['parse'](_0x265a3f);if(_0x16205c[_0x2f9669(0x146)][_0x2f9669(0x185)])_0x16205c[_0x2f9669(0x146)][_0x2f9669(0x185)]=![];if(_0x16205c[_0x2f9669(0x146)]['bbPassword'])_0x16205c[_0x2f9669(0x146)][_0x2f9669(0x21d)]=_0x2f9669(0x1f9);if(_0x16205c[_0x2f9669(0x146)][_0x2f9669(0x14c)])_0x16205c[_0x2f9669(0x146)][_0x2f9669(0x14c)]='***';if(_0x16205c['settings'][_0x2f9669(0x1cc)])_0x16205c['settings'][_0x2f9669(0x1cc)]=null;if(_0x16205c[_0x2f9669(0x146)][_0x2f9669(0xf8)])_0x16205c[_0x2f9669(0x146)][_0x2f9669(0xf8)]=_0x2f9669(0x1f9);_0x265a3f=JSON[_0x2f9669(0x255)](_0x16205c,null,0x2);}if(_0x394368[_0x2f9669(0x172)]!=_0x2f9669(0x133))_0x3c3e56[_0x2f9669(0x2c9)](_0x394368[_0x2f9669(0x172)],_0x265a3f);}else _0x3c3e56[_0x2f9669(0x2c9)](_0x394368['name'],_0x265a3f);}});const _0x5a7de1=_0x3c3e56['generate']({'base64':![],'compression':_0x2060f6(0x1bd)});fs['writeFileSync'](zippath+(_0xc94683+_0x2060f6(0x127)),_0x5a7de1,_0x2060f6(0x2c0));}async function unzipFile(_0x4ac1e2,_0x551672){const _0x5e6474=_0x3e9c6c;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x3fd3d2=>{const _0x339f51=_0x47e5;if(!_0x3fd3d2['isDirectory']())fs[_0x339f51(0x2af)](configpath+_0x3fd3d2['name']);});const _0x1cfbf4=fs['readFileSync'](_0x4ac1e2+_0x551672,_0x5e6474(0x2c0)),_0x2243e5=new require(_0x5e6474(0x137))(_0x1cfbf4,{'base64':![],'checkCRC32':!![]});Object[_0x5e6474(0x26e)](_0x2243e5['files'])[_0x5e6474(0x16c)](_0x564cd9=>{const _0xe53f35=_0x5e6474,_0x455250=_0x2243e5[_0xe53f35(0x155)][_0x564cd9];fs[_0xe53f35(0x204)](configpath+_0x455250['name'],_0x455250[_0xe53f35(0x1ed)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x5e6474(0x16c)](_0x121afd=>{const _0x21de39=_0x5e6474;if(!_0x121afd['isDirectory']())fs[_0x21de39(0x2af)](temppath+_0x121afd[_0x21de39(0x172)]);}),logger[_0x5e6474(0x122)](_0x5e6474(0x2e9)),process[_0x5e6474(0x153)]({'restore':!![]},_0x2d319d=>{});}async function getPublicIp(){const _0x5c7c6b=_0x3e9c6c;try{const _0x3c2b59=await axios['get']('https://api.ipify.org?format=json');publicip=_0x3c2b59[_0x5c7c6b(0x13a)]['ip'];}catch(_0x53a157){}}async function triggerAnalytics(){const _0x47601a=_0x3e9c6c;if(!publicip)await getPublicIp();const _0x2c7cbf=getBotsWithMode();let _0x1eb6f8=0x0;_0x2c7cbf[_0x47601a(0x16c)](_0x17ff5a=>{const _0x4f1237=_0x47601a;if(_0x17ff5a[_0x4f1237(0x287)]===_0x4f1237(0x14d))_0x1eb6f8++;});const _0x599ac1=getBotExchanges();mixpanel[_0x47601a(0x2b7)](_0x47601a(0x147),{'distinct_id':settings[_0x47601a(0x1c2)],'ip':publicip,'version':serverversion,'numbots':_0x2c7cbf[_0x47601a(0x29e)],'numbotsenabled':_0x1eb6f8,'exchanges':_0x599ac1,'environment':environment});}async function getMessages(){const _0x1c9e7c=_0x3e9c6c,_0x5f5d0e=_0x1c9e7c(0x1fc),_0x4ffb52=new GraphQLClient(_0x5f5d0e),_0x43f671={'authorization':_0x1c9e7c(0x108)},_0x5d861e=serverversion[_0x1c9e7c(0x2f1)]('.'),_0x4e48b2=_0x5d861e[0x0]+'.'+_0x5d861e[0x1],_0x10a749=Math['min'](settings['lastmsgtelegram'],settings[_0x1c9e7c(0x262)]),_0x4ae356={'last':parseInt(_0x10a749),'bbm':_0x4e48b2},_0x31a00f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4ffcb8;try{_0x4ffcb8=await _0x4ffb52['request'](_0x31a00f,_0x4ae356,_0x43f671);}catch(_0x1af6da){}if(_0x4ffcb8&&_0x4ffcb8['messages']){let _0x30f3b6=settings[_0x1c9e7c(0x160)];newMessages=[];for(const _0x180134 of _0x4ffcb8[_0x1c9e7c(0x2e7)]){newMessages[_0x1c9e7c(0x200)](_0x180134);let _0x5c4ead=![];_0x180134[_0x1c9e7c(0x19f)]&&(updateSetting(_0x1c9e7c(0x2e8),_0x180134[_0x1c9e7c(0x19f)]),_0x5c4ead=isNewerVersion(serverversion,_0x180134[_0x1c9e7c(0x19f)])||serverversion==_0x180134['bbvNew']);if(!_0x5c4ead&&_0x180134[_0x1c9e7c(0x18d)]>_0x30f3b6){if(_0x180134[_0x1c9e7c(0x178)]===_0x1c9e7c(0x1c6)||serverversion[_0x1c9e7c(0x131)](_0x180134['bbvReceive'])){let _0x4aad06=''+_0x180134['title']+'\x0a\x0a'+_0x180134[_0x1c9e7c(0x27b)];const _0x529ccd=await sendTelegramMsg(toTelegramMarkdown(_0x4aad06),_0x1c9e7c(0x2b6));if(_0x529ccd)_0x30f3b6=_0x180134['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x30f3b6),emitMessages();}}function emitMessages(){const _0x37e039=_0x3e9c6c,_0x12503e=settings['lastmsgemitted'];let _0x42ddb0=[];newMessages[_0x37e039(0x16c)](_0xc48075=>{const _0x255053=_0x37e039;_0xc48075[_0x255053(0x18d)]>_0x12503e&&_0x42ddb0[_0x255053(0x200)](_0xc48075);}),_0x42ddb0[_0x37e039(0x29e)]>0x0&&getAllClients()[_0x37e039(0x16c)](_0x46b917=>{const _0x546de0=_0x37e039;getSocket(_0x46b917['id'])[_0x546de0(0x210)](_0x546de0(0x27b),_0x42ddb0);});}function confirmMessage(_0x5793db){updateSetting('lastmsgemitted',Number(_0x5793db));}function isNewerVersion(_0x5ea7b7,_0x4cebac){const _0x2e304f=_0x3e9c6c,_0x5153cc=_0x4cebac[_0x2e304f(0x2f1)]('.'),_0x148527=_0x5ea7b7[_0x2e304f(0x2f1)]('.');for(var _0x352591=0x0;_0x352591<_0x148527[_0x2e304f(0x29e)];_0x352591++){const _0x15ffa6=~~_0x148527[_0x352591],_0x3f58e0=~~_0x5153cc[_0x352591];if(_0x15ffa6>_0x3f58e0)return!![];if(_0x15ffa6<_0x3f58e0)return![];}return![];}function toTelegramMarkdown(_0x1cad12){const _0x4b6063=_0x3e9c6c,_0x5b5273=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2abe86=/\*{2}(.+?)\*{2}/gim;return _0x1cad12=_0x1cad12['replace'](_0x5b5273,'$1_$2_$3')[_0x4b6063(0x259)](_0x2abe86,_0x4b6063(0x2fa)),_0x1cad12;}async function validateConfigFile(){const _0xc5af22=_0x3e9c6c,_0x502e97=dbConfig[_0xc5af22(0x1e0)](_0xc5af22(0x285))[_0xc5af22(0x15b)](_0xc5af22(0x237))[_0xc5af22(0x21f)]()||[];if(_0x502e97[_0xc5af22(0x29e)]==0x0){let _0x47ab8a=0x0,_0x19c2f8=[];const _0x43368d=/^bot-([0-9]{3})-config.json$/,_0x16a0ac=fs[_0xc5af22(0x118)](configpath);_0x16a0ac[_0xc5af22(0x16c)](_0x437cd1=>{const _0x2809c8=_0xc5af22,_0x4d5dec=_0x43368d[_0x2809c8(0x20c)](_0x437cd1);if(_0x4d5dec){const _0x5bb4dd=_0x4d5dec[0x1];let _0x3f2a00=getBotAttributes(_0x5bb4dd);_0x19c2f8[_0x2809c8(0x200)]({'botID':_0x5bb4dd,'botname':_0x3f2a00[_0x2809c8(0x19d)],'status':_0x2809c8(0xed),'live':_0x2809c8(0x266)}),_0x47ab8a++;}}),_0x47ab8a!=0x0&&(dbConfig['get'](_0xc5af22(0x285))[_0xc5af22(0x26c)](_0x19c2f8)[_0xc5af22(0x16f)](),config=_0x19c2f8,restoredConfigFile=_0x47ab8a);}}async function restoreConfigNotify(_0x141712){const _0x37f6cc=_0x3e9c6c;let _0x2096d5;if(restoredConfigFile==0x1)_0x2096d5=_0x37f6cc(0x238);else _0x2096d5='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x141712)io['to'](_0x37f6cc(0x2f9))['emit'](_0x37f6cc(0x1cd),_0x2096d5);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x37f6cc(0x26b)](_0x2096d5),logger[_0x37f6cc(0x26b)](_0x37f6cc(0x2f5)),logger[_0x37f6cc(0x26b)]('');if(tgBot&&settings[_0x37f6cc(0x1cc)]&&settings[_0x37f6cc(0x215)]!='orders')await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x2096d5);}}function validateCredentials(_0x168b5b,_0x1dca00){const _0x6a20ea=_0x3e9c6c;if(_0x168b5b[_0x6a20ea(0x111)]==settings[_0x6a20ea(0x24d)]&&bcrypt[_0x6a20ea(0x2a5)](_0x168b5b[_0x6a20ea(0x1d6)],settings[_0x6a20ea(0x21d)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x6a20ea(0x24f),'token':null};else{const _0x3f8a42=generateLoginToken(_0x1dca00);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3f8a42};}}else return{'allow':![],'reason':_0x6a20ea(0x18c),'token':null};}function refreshToken(_0x4541d2){const _0x47d74a=_0x3e9c6c,_0x5a6828=generateLoginToken(_0x4541d2);return{'allow':!![],'reason':_0x47d74a(0x2c1),'token':_0x5a6828};}function validateAccess(_0x4a8190,_0x184e8b,_0x59d786){const _0xf81d3f=_0x3e9c6c,_0x55bb07=_0x59d786?_0x59d786:devices[_0x184e8b]['ip'];let _0x5874ae;const _0x2c73ca=_0x305116=>{const _0x3cf4ed=_0x47e5;if(settings[_0x3cf4ed(0x185)]){if(settings[_0x3cf4ed(0x2bd)]){if(telegram2FaApproved(_0x184e8b)){const _0x5c623f=generateLoginToken(_0x184e8b);return{'allow':!![],'reason':_0x3cf4ed(0x2cd),'token':_0x5c623f};}else return{'allow':![],'reason':_0x3cf4ed(0x188),'token':null};}else return _0x5874ae=validToken(_0x305116,_0x184e8b),_0x5874ae[_0x3cf4ed(0x27d)](_0x3cf4ed(0x17a))?{'allow':!![],'reason':_0x3cf4ed(0x18f),'token':_0x305116}:{'allow':![],'reason':_0x3cf4ed(0x188),'token':null};}else return{'allow':!![],'reason':_0x3cf4ed(0x19a),'token':null};};if(settings[_0xf81d3f(0x191)]){let _0x37ee5b=[...settings[_0xf81d3f(0x2cf)],_0xf81d3f(0x2f4),_0xf81d3f(0x129),_0xf81d3f(0x289)];if(_0x37ee5b[_0xf81d3f(0x205)](_0x55bb07))return _0x2c73ca(_0x4a8190);else{_0x5874ae=validToken(_0x4a8190,_0x184e8b);if(_0x5874ae[_0xf81d3f(0x27d)](_0xf81d3f(0x17a)))return _0x2c73ca(_0x4a8190);else{if(telegramIpApproved(_0x184e8b)){const _0x447fad=generateToken(_0x184e8b);return _0x5874ae=_0x2c73ca(_0x4a8190),_0x5874ae[_0xf81d3f(0x1e2)]?{'allow':!![],'reason':_0xf81d3f(0x296),'token':_0x447fad}:_0x5874ae;}else return settings[_0xf81d3f(0x1c0)]?{'allow':![],'reason':_0xf81d3f(0x208),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x2c73ca(_0x4a8190);}function timelyDecrypt(_0x37033c,_0x480d41,_0x44be53='@'){const _0x1592c6=_0x3e9c6c;if(_0x37033c)try{const _0x4efe68=crypt[_0x1592c6(0x2ea)](secure[_0x1592c6(0x15d)],_0x37033c)['message'],_0x5a974a=_0x4efe68['split'](_0x44be53)[0x0],_0x240237=_0x4efe68[_0x1592c6(0x2f1)](_0x44be53)[0x1],_0x1bff84=new Date()['getTime']();if(_0x480d41){if(_0x1bff84-_0x240237<maxSecretAge*0x3e8)return _0x5a974a;else return![];}else return _0x5a974a;}catch(_0x4b80e6){return![];}else return![];}const validToken=(_0x3e6bec,_0x161f12)=>{const _0x3e0803=_0x3e9c6c,_0x1343ce=devices[_0x161f12]['ip'];if(!_0x3e6bec)return{'error':_0x3e0803(0x17d)};for(let _0x3861e4 of blacklist){if(_0x3861e4[_0x3e0803(0xe7)]==_0x3e6bec)return{'error':'Token\x20blacklisted'};}let _0x20f7a0;try{_0x20f7a0=jwt['verify'](_0x3e6bec,secure[_0x3e0803(0x294)]+_0x161f12);}catch{return{'error':_0x3e0803(0x107)};}if(!_0x20f7a0[_0x3e0803(0x27d)](_0x3e0803(0x175))&&!_0x20f7a0[_0x3e0803(0x27d)](_0x3e0803(0x111))||!_0x20f7a0[_0x3e0803(0x27d)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x20f7a0[_0x3e0803(0x27d)](_0x3e0803(0x111))&&_0x20f7a0[_0x3e0803(0x27d)](_0x3e0803(0x175))){const {clientip:_0x1d141f}=_0x20f7a0;return _0x1343ce==_0x1d141f?{'success':_0x3e0803(0x15a)}:{'error':_0x3e0803(0x230)};}else{if(_0x20f7a0['hasOwnProperty'](_0x3e0803(0x111))&&_0x20f7a0[_0x3e0803(0x27d)]('clientip')){const {username:_0x131e2b,clientip:_0x7ee81c}=_0x20f7a0;return settings[_0x3e0803(0x24d)]==_0x131e2b&&_0x1343ce==_0x7ee81c?{'success':_0x3e0803(0x15a)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3b501c=>{const _0x4e490d=_0x3e9c6c;if(_0x3b501c){const _0x3a47e8=devices[_0x3b501c]['ip'];return jwt[_0x4e490d(0x2ba)]({'username':settings['bbUsername'],'clientip':_0x3a47e8},secure[_0x4e490d(0x294)]+_0x3b501c,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x23e703=>{const _0x29e0ed=_0x3e9c6c;if(_0x23e703){const _0x594c0d=devices[_0x23e703]['ip'];return jwt[_0x29e0ed(0x2ba)]({'clientip':_0x594c0d},secure['secret']+_0x23e703,{'expiresIn':devices[_0x23e703][_0x29e0ed(0x1e5)][_0x29e0ed(0x170)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x319634=>{const _0x2741f5=_0x3e9c6c;let _0x19ba62=![];return devices[_0x319634]['telegramIpApproval']&&devices[_0x319634][_0x2741f5(0x1e5)][_0x2741f5(0x170)]!=_0x2741f5(0x1b0)&&(_0x19ba62=devices[_0x319634]['telegramIpApproval'][_0x2741f5(0x175)]==devices[_0x319634]['ip']&&new Date()['getTime']()-devices[_0x319634]['telegramIpApproval'][_0x2741f5(0x2d6)]<devices[_0x319634]['telegramIpApproval'][_0x2741f5(0x170)]*0x3c*0x3e8),_0x19ba62;},telegram2FaApproved=_0xbb7d27=>{const _0x575101=_0x3e9c6c;let _0x5617c8=![];return devices[_0xbb7d27]['telegram2FaApproval']&&devices[_0xbb7d27][_0x575101(0x282)]['expiry']!=_0x575101(0x1b0)&&(_0x5617c8=devices[_0xbb7d27][_0x575101(0x282)]['clientip']==devices[_0xbb7d27]['ip']&&new Date()[_0x575101(0x2cb)]()-devices[_0xbb7d27][_0x575101(0x282)][_0x575101(0x2d6)]<devices[_0xbb7d27][_0x575101(0x282)][_0x575101(0x170)]*0x3c*0x3e8),_0x5617c8;},normalizeIP=_0x3b3bbe=>{const _0x5399cc=_0x3e9c6c;let _0x188523=null,_0x18851a=null;if(ipaddr[_0x5399cc(0x1db)](_0x3b3bbe)){const _0x35e2b9=ipaddr[_0x5399cc(0x159)](_0x3b3bbe);_0x35e2b9[_0x5399cc(0x26a)]()==='ipv6'?(_0x35e2b9['isIPv4MappedAddress']()&&(_0x188523=_0x35e2b9['toIPv4Address']()[_0x5399cc(0x139)]()),_0x18851a=_0x35e2b9['toString']()):(_0x188523=_0x35e2b9[_0x5399cc(0x139)](),_0x18851a=_0x35e2b9[_0x5399cc(0x1c4)]()['toString']());}return{'show':_0x188523?_0x188523:_0x18851a,'store':_0x18851a};};function formatDate(_0x29c027){const _0x152f38=_0x3e9c6c;return _0x29c027['getFullYear']()+'/'+(_0x29c027[_0x152f38(0x165)]()+0x1)[_0x152f38(0x139)]()[_0x152f38(0x2f3)](0x2,'0')+'/'+_0x29c027[_0x152f38(0x2d4)]()['toString']()[_0x152f38(0x2f3)](0x2,'0')+'\x20'+_0x29c027['getHours']()[_0x152f38(0x139)]()[_0x152f38(0x2f3)](0x2,'0')+':'+_0x29c027[_0x152f38(0x2df)]()[_0x152f38(0x139)]()[_0x152f38(0x2f3)](0x2,'0')+':'+_0x29c027[_0x152f38(0x1d2)]()[_0x152f38(0x139)]()[_0x152f38(0x2f3)](0x2,'0');}function sleep(_0x14beea){return new Promise(_0x8df8ae=>setTimeout(_0x8df8ae,_0x14beea));}