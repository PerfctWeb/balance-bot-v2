const _0x50ef29=_0x4877;(function(_0x257104,_0x28d2b8){const _0x2abe9d=_0x4877,_0x346a37=_0x257104();while(!![]){try{const _0x4a63c0=parseInt(_0x2abe9d(0x32f))/0x1+-parseInt(_0x2abe9d(0x3c9))/0x2+-parseInt(_0x2abe9d(0x3b4))/0x3*(parseInt(_0x2abe9d(0x2f4))/0x4)+-parseInt(_0x2abe9d(0x2b9))/0x5*(-parseInt(_0x2abe9d(0x2cc))/0x6)+-parseInt(_0x2abe9d(0x3ac))/0x7*(-parseInt(_0x2abe9d(0x1ea))/0x8)+-parseInt(_0x2abe9d(0x2a0))/0x9+-parseInt(_0x2abe9d(0x1e6))/0xa*(-parseInt(_0x2abe9d(0x1d2))/0xb);if(_0x4a63c0===_0x28d2b8)break;else _0x346a37['push'](_0x346a37['shift']());}catch(_0x15f78f){_0x346a37['push'](_0x346a37['shift']());}}}(_0x11d6,0x41939));const _0x5c1352=function(){let _0x270ab8=!![];return function(_0x16f171,_0x1e9958){const _0x18ecb7=_0x270ab8?function(){const _0x24b8f8=_0x4877;if(_0x1e9958){const _0x318689=_0x1e9958[_0x24b8f8(0x294)](_0x16f171,arguments);return _0x1e9958=null,_0x318689;}}:function(){};return _0x270ab8=![],_0x18ecb7;};}(),_0x2a466a=_0x5c1352(this,function(){const _0x17d63d=_0x4877;return _0x2a466a[_0x17d63d(0x211)]()['search'](_0x17d63d(0x22a))[_0x17d63d(0x211)]()[_0x17d63d(0x31d)](_0x2a466a)[_0x17d63d(0x2e4)](_0x17d63d(0x22a));});_0x2a466a();'use strict';process[_0x50ef29(0x354)][_0x50ef29(0x356)]=0x1;const childProcess=require(_0x50ef29(0x1f3)),fs=require('fs'),fns=require(_0x50ef29(0x206)),low=require(_0x50ef29(0x1df)),FileSync=require(_0x50ef29(0x3b3)),path=require(_0x50ef29(0x2ea)),crypto=require(_0x50ef29(0x2d3)),forge=require(_0x50ef29(0x2e1)),bcrypt=require(_0x50ef29(0x39b)),jwt=require(_0x50ef29(0x21f)),ipaddr=require(_0x50ef29(0x225)),argv=require(_0x50ef29(0x305))(process['argv'][_0x50ef29(0x340)](0x2))[_0x50ef29(0x224)],uuidRandom=require(_0x50ef29(0x303)),{Telegraf,Markup}=require(_0x50ef29(0x213)),Mixpanel=require(_0x50ef29(0x319)),axios=require(_0x50ef29(0x28b)),{GraphQLClient,gql}=require(_0x50ef29(0x24a)),util=require('util'),fileUpload=require(_0x50ef29(0x22e)),{networkInterfaces}=require('os'),JSZip=require(_0x50ef29(0x379)),PORT=argv[_0x50ef29(0x23c)]||_0x50ef29(0x343),pattern=/^[0-9]{2,4}$/;!pattern[_0x50ef29(0x2a7)](PORT)&&(console['log'](_0x50ef29(0x21c)+PORT+_0x50ef29(0x26c)),process[_0x50ef29(0x2fb)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x50ef29(0x283)];let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x50ef29(0x29f),securefile='bb-secure.json',environment=require('./'+bbpath2+'version.json')[_0x50ef29(0x393)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x50ef29(0x1d7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x50ef29(0x292)+userID+'/':bbpath+_0x50ef29(0x292),configbackuppath=configpath+_0x50ef29(0x25f),logspath=userID?bbpath+_0x50ef29(0x301)+userID+'/':bbpath+_0x50ef29(0x301),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x50ef29(0x2d1),loggerfile=fs['createWriteStream'](logspath+_0x50ef29(0x2f9),{'flags':'a'}),temppath=userID?bbpath+_0x50ef29(0x27f)+userID+'/':bbpath+'temp/';!fs[_0x50ef29(0x1d7)](configpath)&&fs[_0x50ef29(0x310)](configpath);!fs[_0x50ef29(0x1d7)](configbackuppath)&&fs[_0x50ef29(0x310)](configbackuppath);!fs[_0x50ef29(0x1d7)](logspath)&&fs[_0x50ef29(0x310)](logspath);!fs[_0x50ef29(0x1d7)](zippath)&&fs[_0x50ef29(0x310)](zippath);!fs[_0x50ef29(0x1d7)](temppath)&&fs[_0x50ef29(0x310)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x50ef29(0x399)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x50ef29(0x399)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x50ef29(0x327),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x50ef29(0x221)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x50ef29(0x2ae)](_0x50ef29(0x339),{'host':_0x50ef29(0x2cd)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x50ef29(0x28c)]&&(settings[_0x50ef29(0x28c)]!=''&&settings[_0x50ef29(0x28c)]!=_0x50ef29(0x222))&&settings[_0x50ef29(0x3a0)]&&settings[_0x50ef29(0x3a0)]!='')initTelegram();const parseColor=(_0x1374d8,_0x8c32e0)=>{const _0x51726f=_0x50ef29,_0x19c3e7=/#[A-Z]{3}#/g;if(typeof _0x1374d8==_0x51726f(0x1e2)){!_0x8c32e0?_0x1374d8=_0x1374d8[_0x51726f(0x286)](_0x19c3e7,''):(_0x1374d8=_0x1374d8[_0x51726f(0x286)](/#BLU#/g,_0x51726f(0x2bf)),_0x1374d8=_0x1374d8['replace'](/#RED#/g,'\x1b[31m'),_0x1374d8=_0x1374d8['replace'](/#YEL#/g,_0x51726f(0x28f)),_0x1374d8=_0x1374d8[_0x51726f(0x286)](/#MAG#/g,_0x51726f(0x29c)),_0x1374d8=_0x1374d8[_0x51726f(0x286)](/#CYA#/g,'\x1b[36m'),_0x1374d8=_0x1374d8[_0x51726f(0x286)](/#RES#/g,_0x51726f(0x349)));;}return _0x1374d8;},logger={'screen':_0x184521=>{const _0x1b80e6=_0x50ef29;console[_0x1b80e6(0x25b)](parseColor(_0x184521,!![]));},'simple':_0x55e270=>{const _0x1104dd=_0x50ef29;console[_0x1104dd(0x25b)](parseColor(_0x55e270,!![])),loggerfile['write'](util[_0x1104dd(0x210)](parseColor(_0x55e270,![]))+'\x0a');},'full':async _0x22cf78=>{const _0xaa8bea=_0x50ef29,_0xa5ad8b=getTimeStamp()+_0xaa8bea(0x3ba)+_0x22cf78;console['log'](parseColor(_0xa5ad8b,!![])),loggerfile[_0xaa8bea(0x221)](util[_0xaa8bea(0x210)](parseColor(_0xa5ad8b,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0xaa8bea(0x23e)]!='orders')await sendTelegram(settings[_0xaa8bea(0x365)],_0xaa8bea(0x2cf)+parseColor(_0x22cf78,![]));},'debug':async(_0x12d0d9,_0xf55f98='')=>{const _0x1972ab=_0x50ef29,_0x2fbf85=getTimeStamp()+_0x1972ab(0x263)+_0x12d0d9;if(debugging)console['log'](parseColor(_0x2fbf85,!![]));loggerfile[_0x1972ab(0x221)](util[_0x1972ab(0x210)](parseColor(_0x2fbf85,![]))+'\x0a');if(_0xf55f98){if(debugging)console['log'](_0xf55f98);loggerfile[_0x1972ab(0x221)](util[_0x1972ab(0x210)](_0xf55f98)+'\x0a');}}};let terminating=![];process['on'](_0x50ef29(0x326),function(_0x1f43cb){const _0x58a33e=_0x50ef29;_0x1f43cb['toString']()[_0x58a33e(0x2d4)](_0x58a33e(0x3ae))?(logger['simple']('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x1f43cb[_0x58a33e(0x23c)]+'#RES#'),process['send']({'terminate':!![]},_0xead897=>{})):logger[_0x58a33e(0x1d4)](_0x1f43cb);}),process['on'](_0x50ef29(0x2fb),()=>{const _0xc587e5=_0x50ef29;stopAllBots(),process[_0xc587e5(0x2fb)](0x0);}),process['on'](_0x50ef29(0x3c2),()=>{const _0x50dc46=_0x50ef29;stopAllBots(),process[_0x50dc46(0x2fb)](0x0);}),process['on'](_0x50ef29(0x209),()=>{const _0x212502=_0x50ef29;stopAllBots(),process[_0x212502(0x2fb)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x50ef29(0x256))[_0x50ef29(0x24f)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x50ef29(0x22d)),app=express(),http=require('http')[_0x50ef29(0x251)](app);app[_0x50ef29(0x1f8)](fileUpload({'useTempFiles':!![]})),app[_0x50ef29(0x284)](_0x50ef29(0x312),async(_0x1f5e49,_0x403462)=>{const _0xff2e34=_0x50ef29,_0x17a10d=_0x1f5e49[_0xff2e34(0x1f7)][_0xff2e34(0x371)],_0x4c0049=getClientsWithBotID(_0xff2e34(0x348)),_0x511830=_0x1f5e49[_0xff2e34(0x258)]['uuid'],_0x24e7b5=timelyDecrypt(_0x511830,![]),_0x350d08=_0x4c0049['find'](_0x343fbb=>_0x343fbb[_0xff2e34(0x35d)]==_0x24e7b5);if(_0x350d08){const _0x3148a5=normalizeIP(_0x1f5e49[_0xff2e34(0x26e)][_0xff2e34(0x24c)])[_0xff2e34(0x364)],_0x242a8b=_0x1f5e49['headers']['tkn'];if(validateAccess(_0x242a8b,_0x24e7b5,_0x3148a5)[_0xff2e34(0x381)])_0x17a10d==_0xff2e34(0x359)&&await backupConfigFiles(),await zipFiles(_0x17a10d),_0x403462[_0xff2e34(0x218)](zippath+(_0x17a10d+_0xff2e34(0x3a9)),_0x9ed9ce=>{const _0x3da9c6=_0xff2e34;_0x9ed9ce&&(logger['full'](_0x3da9c6(0x344)+_0x17a10d),logger[_0x3da9c6(0x1d4)](_0x9ed9ce));});else logger['full'](_0xff2e34(0x331)+_0x17a10d+_0xff2e34(0x353));}else logger[_0xff2e34(0x366)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x17a10d+_0xff2e34(0x24e));}),app[_0x50ef29(0x277)](_0x50ef29(0x1e8),async(_0x214cf0,_0x423c7e)=>{const _0x57d190=_0x50ef29,_0x2b4503=getClientsWithBotID('botmanager'),_0x143d74=_0x214cf0['headers']['uuid'],_0x327462=timelyDecrypt(_0x143d74,![]),_0x5da101=_0x2b4503[_0x57d190(0x261)](_0x12a0c6=>_0x12a0c6[_0x57d190(0x35d)]==_0x327462);logger[_0x57d190(0x350)](_0x57d190(0x30c));if(_0x5da101){const _0x18232a=normalizeIP(_0x214cf0[_0x57d190(0x26e)][_0x57d190(0x24c)])[_0x57d190(0x364)],_0x22157f=_0x214cf0['headers']['tkn'];if(validateAccess(_0x22157f,_0x327462,_0x18232a)[_0x57d190(0x381)]){if(_0x214cf0[_0x57d190(0x1f5)]){const _0x52bc45=_0x214cf0[_0x57d190(0x1f5)][_0x57d190(0x22c)];await _0x52bc45['mv'](temppath+_0x52bc45[_0x57d190(0x33e)]),_0x423c7e[_0x57d190(0x304)]({'status':!![],'message':_0x57d190(0x243)});const _0x198ebc=getBotsWithMode();_0x198ebc['length']>0x0?confirmRestore(temppath,_0x52bc45[_0x57d190(0x33e)]):unzipFile(temppath,_0x52bc45[_0x57d190(0x33e)]);}}else logger[_0x57d190(0x366)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x57d190(0x366)](_0x57d190(0x227));}),app[_0x50ef29(0x1f8)](express[_0x50ef29(0x26a)](path[_0x50ef29(0x203)](__dirname,bbpath2,_0x50ef29(0x2c5)))),app[_0x50ef29(0x1f8)](express['static'](path['join'](__dirname,bbpath2,_0x50ef29(0x2a5)))),app[_0x50ef29(0x284)]('/',function(_0x579a4e,_0x3f16db){const _0x453ead=_0x50ef29;_0x3f16db[_0x453ead(0x325)](path[_0x453ead(0x203)](__dirname,bbpath2,_0x453ead(0x2c5),'index.html'));}),app['get'](_0x50ef29(0x289),function(_0x6c905a,_0x11c315){const _0xfea225=_0x50ef29;_0x11c315[_0xfea225(0x325)](path[_0xfea225(0x203)](__dirname,bbpath2,_0xfea225(0x2a5),_0xfea225(0x35f)));}),app[_0x50ef29(0x284)](_0x50ef29(0x1dd),(_0x276ea9,_0x44cae6)=>{const _0x54c695=_0x50ef29;_0x44cae6['sendFile'](path['join'](__dirname,bbpath2,_0x54c695(0x2a5),'index.html'));}),app['get'](_0x50ef29(0x2cb),(_0x151e4a,_0x27f6f8)=>{const _0x138e42=_0x50ef29;_0x27f6f8['sendFile'](path[_0x138e42(0x203)](__dirname,bbpath2,_0x138e42(0x2a5),'index.html'));}),app[_0x50ef29(0x284)](_0x50ef29(0x3d0),(_0x17dc60,_0x2a097a)=>{const _0xe12c9e=_0x50ef29;_0x2a097a[_0xe12c9e(0x325)](path['join'](__dirname,bbpath2,_0xe12c9e(0x2a5),_0xe12c9e(0x35f)));}),app[_0x50ef29(0x284)](_0x50ef29(0x32d),(_0x311081,_0x278301)=>{const _0x5aeffe=_0x50ef29;_0x278301['sendFile'](path[_0x5aeffe(0x203)](__dirname,bbpath2,'build',_0x5aeffe(0x35f)));}),app[_0x50ef29(0x284)](_0x50ef29(0x2d7),(_0x362d61,_0x1d994d)=>{const _0x3f59d7=_0x50ef29;_0x1d994d[_0x3f59d7(0x325)](path[_0x3f59d7(0x203)](__dirname,bbpath2,_0x3f59d7(0x2a5),_0x3f59d7(0x35f)));}),app['get']('/:bot/support',(_0x114c42,_0x230bd1)=>{const _0x2b928e=_0x50ef29;_0x230bd1[_0x2b928e(0x325)](path[_0x2b928e(0x203)](__dirname,bbpath2,_0x2b928e(0x2a5),_0x2b928e(0x35f)));});if(HOST)http[_0x50ef29(0x239)](PORT,HOST);else http[_0x50ef29(0x239)](PORT);const io=require(_0x50ef29(0x355))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5eb3fe=_0x50ef29;let _0x577c36=_0x5eb3fe(0x255);const _0x5223cf=networkInterfaces(),_0x3e18eb={};for(const _0x5cdebc of Object[_0x5eb3fe(0x38b)](_0x5223cf)){for(const _0x535f7d of _0x5223cf[_0x5cdebc]){if((_0x535f7d[_0x5eb3fe(0x2f3)]=='IPv4'||_0x535f7d[_0x5eb3fe(0x2f3)]==0x4)&&!_0x535f7d[_0x5eb3fe(0x1cb)]){const _0x160ab7=ipaddr[_0x5eb3fe(0x280)](_0x535f7d[_0x5eb3fe(0x39f)])[_0x5eb3fe(0x1f6)]();_0x160ab7!='private'&&(!_0x3e18eb[_0x5cdebc]&&(_0x3e18eb[_0x5cdebc]=[]),_0x3e18eb[_0x5cdebc][_0x5eb3fe(0x2ed)](_0x535f7d['address']),_0x577c36=_0x535f7d[_0x5eb3fe(0x39f)]);}}}return{'serverip':_0x577c36,'netinterfaces':_0x3e18eb};}async function startServer(){const _0x1a6154=_0x50ef29,{serverip:_0x415470,netinterfaces:_0x453448}=getServerIP();logger[_0x1a6154(0x1d4)](''),logger['simple'](_0x1a6154(0x384)),await logger['full'](_0x1a6154(0x1ff)+serverversion+_0x1a6154(0x270)+(environment==_0x1a6154(0x389)?_0x1a6154(0x1d0):'')+'\x0a'+(_0x1a6154(0x2f6)+PORT+_0x1a6154(0x36d))+(_0x1a6154(0x391)+_0x415470+':'+PORT+_0x1a6154(0x39c))),logger['simple'](_0x1a6154(0x384));if(config[_0x1a6154(0x3b6)]!=0x0)for(const _0x49ea69 of config){const _0x1c2f4f=_0x49ea69[_0x1a6154(0x2ba)]=='auto'?'a':'m';if(_0x49ea69[_0x1a6154(0x2ab)]==_0x1a6154(0x1e7)||_0x49ea69['status']=='new')await logger['full'](_0x1a6154(0x25c)+_0x1c2f4f+')\x20|\x20Bot\x20'+_0x49ea69[_0x1a6154(0x29b)]+_0x1a6154(0x3b5)+_0x49ea69['botname']),startBot([_0x49ea69[_0x1a6154(0x29b)],userID],{'cwd':bbpath},function(_0x16acb6){const _0xb109be=_0x1a6154;if(_0x16acb6)logger[_0xb109be(0x366)](_0x16acb6);});else(_0x49ea69[_0x1a6154(0x2ab)]==_0x1a6154(0x2fc)||_0x49ea69['status']==_0x1a6154(0x3d8))&&await logger[_0x1a6154(0x366)](_0x1a6154(0x3d7)+_0x1c2f4f+')\x20\x20\x20|\x20Bot\x20'+_0x49ea69[_0x1a6154(0x29b)]+'\x20|\x20'+_0x49ea69[_0x1a6154(0x398)]);}else!newBot&&logger[_0x1a6154(0x1d4)](_0x1a6154(0x336));if(newBot)addBot();logger[_0x1a6154(0x1d4)](_0x1a6154(0x384)),logger[_0x1a6154(0x1d4)](''),await logger[_0x1a6154(0x350)]('Node.js\x20v'+nodeversion),await logger[_0x1a6154(0x350)]('Network\x20Interfaces:',_0x453448);}function startSocket(){io['on']('connection',_0x1ba94a=>{const _0xa55b51=_0x4877;let _0x47f70a,_0x3c74b3,_0x5c5916,_0x47698d,_0x83dedf;const _0x97c18e=_0x1ba94a[_0xa55b51(0x290)]['headers']['referer'];_0x3c74b3=_0x97c18e[_0xa55b51(0x387)](/bot[0-9]{3}/);if(_0x3c74b3)_0x5c5916=_0x3c74b3[0x0][_0xa55b51(0x387)](/[0-9]{3}/);if(_0x5c5916)_0x47f70a=_0x5c5916[0x0];else _0x47f70a=_0xa55b51(0x348);const _0x5daea3=_0x1ba94a[_0xa55b51(0x290)][_0xa55b51(0x235)][_0xa55b51(0x33c)];if(!_0x5daea3)_0x1ba94a[_0xa55b51(0x234)](_0xa55b51(0x2ab),{'publicKey':secure[_0xa55b51(0x318)]});else{_0x47698d=timelyDecrypt(_0x5daea3,![]);if(!_0x47698d)_0x1ba94a[_0xa55b51(0x234)]('status',{'publicKey':secure[_0xa55b51(0x318)]});else{_0x83dedf=normalizeIP(_0x1ba94a[_0xa55b51(0x374)][_0xa55b51(0x24c)])[_0xa55b51(0x364)];if(!devices[_0x47698d])devices[_0x47698d]={'uuid':_0x47698d,'access':{'token':null}};devices[_0x47698d]['ip']=_0x83dedf;const _0x15b60e=addClient(_0x1ba94a['id'],_0x47698d,_0x47f70a);setAccess(_0x15b60e),emitMessages(),_0x1ba94a['on']('login',_0x2cb311=>{const _0x403f2f=_0xa55b51,_0x25c359=timelyDecrypt(_0x2cb311[_0x403f2f(0x302)],!![],_0x403f2f(0x2c0));if(_0x25c359){_0x2cb311={'username':_0x2cb311[_0x403f2f(0x274)],'password':_0x25c359},devices[_0x47698d]['access']=validateCredentials(_0x2cb311,_0x47698d);if(devices[_0x47698d][_0x403f2f(0x2dd)][_0x403f2f(0x381)]==![]&&devices[_0x47698d]['access'][_0x403f2f(0x200)]==_0x403f2f(0x396))_0x1ba94a['emit'](_0x403f2f(0x2ab),{'access':devices[_0x47698d][_0x403f2f(0x2dd)]}),loginAccess2FA(_0x47698d,_0x83dedf);else{if(devices[_0x47698d]['access'][_0x403f2f(0x381)]==![]&&devices[_0x47698d]['access']['reason']=='invalid\x20credentials')_0x1ba94a[_0x403f2f(0x234)]('status',{'access':devices[_0x47698d][_0x403f2f(0x2dd)]});else devices[_0x47698d][_0x403f2f(0x2dd)][_0x403f2f(0x381)]&&devices[_0x47698d]['access']['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x47698d)['forEach'](_0xe12717=>{setAccess(_0xe12717);}),logger['debug'](_0x403f2f(0x1f1)+_0x47698d[_0x403f2f(0x340)](-0x8)),setTokenRefresh(_0x47698d),setSessionTimeout('login',_0x47698d));}}else logger['full'](_0x403f2f(0x1ee));}),_0x1ba94a['on'](_0xa55b51(0x397),()=>{resetPassword();}),_0x1ba94a['on']('disconnect',_0x2163f3=>{removeClient(_0x1ba94a['id']);}),_0x47f70a=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xf7c8be){const _0x3f64a4=_0x50ef29;if(_0xf7c8be!=_0x3f64a4(0x348)&&config[_0x3f64a4(0x2e7)]!=''){if(pid[_0xf7c8be])pid[_0xf7c8be]['send']({'function':_0x3f64a4(0x39a),'args':null});}_0xf7c8be!=_0x3f64a4(0x348)&&broadcastToBots('bots',JSON[_0x3f64a4(0x2b7)](config));}function reloadBotManager(){const _0x58f7ae=_0x50ef29;getClientsWithBotID(_0x58f7ae(0x348))[_0x58f7ae(0x34b)](_0x21cbf4=>{const _0x57fda4=_0x58f7ae;getSocket(_0x21cbf4['id'])[_0x57fda4(0x234)](_0x57fda4(0x2ab),{'access':{'allow':![],'reason':_0x57fda4(0x34a),'token':null}});});}function getSocket(_0xb260){const _0x458c90=_0x50ef29,_0x2b39bf=io[_0x458c90(0x382)][_0x458c90(0x284)]('/');return _0x2b39bf[_0x458c90(0x32b)][_0x458c90(0x284)](_0xb260);}function setAccess(_0x5cc159){const _0x20eb3d=_0x50ef29,_0x59605c=getSocket(_0x5cc159['id']),_0x21ef1d=_0x5cc159[_0x20eb3d(0x35d)],_0x5510fe=_0x5cc159[_0x20eb3d(0x1e9)];devices[_0x21ef1d][_0x20eb3d(0x2dd)]=validateAccess(devices[_0x21ef1d][_0x20eb3d(0x2dd)]['token'],_0x21ef1d),logger[_0x20eb3d(0x350)](_0x20eb3d(0x38e)+devices[_0x21ef1d][_0x20eb3d(0x2dd)]['reason']+'\x20|\x20client:\x20...'+_0x5cc159['id']['slice'](-0x8)+_0x20eb3d(0x242)+_0x21ef1d[_0x20eb3d(0x340)](-0x8)),_0x59605c[_0x20eb3d(0x203)](_0x21ef1d);if(devices[_0x21ef1d][_0x20eb3d(0x2dd)][_0x20eb3d(0x381)]){_0x59605c['join'](_0x5510fe);if(_0x5510fe==_0x20eb3d(0x348))initializeSocketBotManager(_0x59605c);else initializeSocketBot(_0x59605c);initClient(_0x5510fe);}devices[_0x21ef1d]['access'][_0x20eb3d(0x1db)]&&devices[_0x21ef1d][_0x20eb3d(0x2dd)][_0x20eb3d(0x200)]==_0x20eb3d(0x308)&&setSessionTimeout(_0x20eb3d(0x230),_0x21ef1d),devices[_0x21ef1d][_0x20eb3d(0x2dd)][_0x20eb3d(0x1db)]&&devices[_0x21ef1d][_0x20eb3d(0x2dd)][_0x20eb3d(0x200)]==_0x20eb3d(0x25a)&&setSessionTimeout('login',_0x21ef1d),_0x59605c['emit']('status',{'status':_0x5cc159['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x21ef1d][_0x20eb3d(0x2dd)],'externalip':devices[_0x21ef1d]['ip'],'publicKey':secure[_0x20eb3d(0x318)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x21ef1d]['access']['allow']==![]&&devices[_0x21ef1d][_0x20eb3d(0x2dd)][_0x20eb3d(0x200)]==_0x20eb3d(0x3c3)&&temporaryAccess2FA(_0x21ef1d,devices[_0x21ef1d]['ip']);}function setSessionTimeout(_0x2dc5b5,_0x27d910){const _0x24cab8=_0x50ef29;let _0x2971b9;if(_0x2dc5b5==_0x24cab8(0x278))_0x2971b9=loginExpiry*0x3c*0x3e8;else _0x2971b9=devices[_0x27d910]['telegramIpApproval'][_0x24cab8(0x21b)]*0x3c*0x3e8-(new Date()[_0x24cab8(0x2be)]()-devices[_0x27d910][_0x24cab8(0x362)][_0x24cab8(0x320)]);if(devices[_0x27d910][_0x24cab8(0x220)])clearTimeout(devices[_0x27d910][_0x24cab8(0x220)]);devices[_0x27d910]['pidExpireLogin']=setTimeout(()=>{const _0x43eb21=_0x24cab8;if(devices[_0x27d910][_0x43eb21(0x329)])clearTimeout(devices[_0x27d910][_0x43eb21(0x329)]);removeSocketListeners(_0x27d910),addBlacklist(_0x27d910),devices[_0x27d910]['telegramIpApproval']=null,devices[_0x27d910][_0x43eb21(0x20b)]=null,devices[_0x27d910][_0x43eb21(0x2dd)][_0x43eb21(0x1db)]=null,logger[_0x43eb21(0x350)](_0x43eb21(0x2c3)+_0x27d910[_0x43eb21(0x340)](-0x8)),devices[_0x27d910][_0x43eb21(0x2dd)]=validateAccess(devices[_0x27d910][_0x43eb21(0x2dd)]['token'],_0x27d910),!(devices[_0x27d910][_0x43eb21(0x2dd)]['allow']&&devices[_0x27d910][_0x43eb21(0x2dd)][_0x43eb21(0x200)]==_0x43eb21(0x2d0))&&(_0x2dc5b5=='login'?io['to'](_0x27d910)[_0x43eb21(0x234)](_0x43eb21(0x2ab),{'access':{'allow':![],'reason':_0x43eb21(0x36b),'token':null}}):io['to'](_0x27d910)['emit'](_0x43eb21(0x2ab),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x27d910][_0x43eb21(0x2dd)][_0x43eb21(0x1db)]=null;},_0x2971b9);}function setTokenRefresh(_0x474087){const _0x3b6c78=_0x50ef29;if(devices[_0x474087][_0x3b6c78(0x329)])clearTimeout(devices[_0x474087][_0x3b6c78(0x329)]);devices[_0x474087][_0x3b6c78(0x329)]=setTimeout(()=>{const _0x34b08a=_0x3b6c78;getClientsWithUuid(_0x474087)[_0x34b08a(0x3b6)]!=0x0?(devices[_0x474087][_0x34b08a(0x2dd)]=refreshToken(_0x474087),io['to'](_0x474087)[_0x34b08a(0x234)]('status',{'status':_0x34b08a(0x2e0),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x474087][_0x34b08a(0x2dd)],'externalip':devices[_0x474087]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x474087)):clearTimeout(devices[_0x474087][_0x34b08a(0x329)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x56dde5){const _0x1c8622=_0x50ef29,_0x17d261=getClient(_0x56dde5['id'])['uuid'];_0x56dde5[_0x1c8622(0x234)](_0x1c8622(0x313),config),_0x56dde5[_0x1c8622(0x234)](_0x1c8622(0x232),cleanSettings()),_0x56dde5['on'](_0x1c8622(0x1fe),_0x4f57b4=>{const _0x527cf3=_0x1c8622;if(validateAccess(_0x4f57b4,_0x17d261)[_0x527cf3(0x381)])addBot();else logger['full'](_0x527cf3(0x307));}),_0x56dde5['on'](_0x1c8622(0x1e5),(_0x2d33d3,_0x131e08)=>{const _0x25878a=_0x1c8622;if(validateAccess(_0x131e08,_0x17d261)[_0x25878a(0x381)])toggleBot(_0x2d33d3[_0x25878a(0x29b)],_0x2d33d3[_0x25878a(0x2ab)],_0x2d33d3[_0x25878a(0x1eb)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x56dde5['on']('toggle-bot-mode',(_0x42cd01,_0x55926b)=>{const _0x5c7e0=_0x1c8622;if(validateAccess(_0x55926b,_0x17d261)['allow'])toggleBotMode(_0x42cd01);else logger[_0x5c7e0(0x366)](_0x5c7e0(0x2e6));}),_0x56dde5['on'](_0x1c8622(0x3c1),(_0x8af744,_0x45db88)=>{const _0x1939de=_0x1c8622;if(validateAccess(_0x45db88,_0x17d261)[_0x1939de(0x381)])deleteBot(_0x8af744);else logger['full'](_0x1939de(0x26d));}),_0x56dde5['on'](_0x1c8622(0x36e),(_0x3699fb,_0x5b872b)=>{const _0x24a7c2=_0x1c8622;if(validateAccess(_0x5b872b,_0x17d261)['allow'])storeSettings(_0x3699fb,!![]);else logger[_0x24a7c2(0x366)](_0x24a7c2(0x29d));}),_0x56dde5['on'](_0x1c8622(0x3af),_0x58b16d=>{const _0x37546b=_0x1c8622;if(validateAccess(_0x58b16d,_0x17d261)[_0x37546b(0x381)])updateBB(_0x37546b(0x293));else logger['full'](_0x37546b(0x34e));}),_0x56dde5['on']('reinstall-bb',_0x328f41=>{const _0xc09d21=_0x1c8622;if(validateAccess(_0x328f41,_0x17d261)['allow'])updateBB(_0xc09d21(0x24b));else logger[_0xc09d21(0x366)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x56dde5['on'](_0x1c8622(0x30e),_0x49af37=>{const _0x4a8a30=_0x1c8622;if(validateAccess(_0x49af37,_0x17d261)[_0x4a8a30(0x381)]){const _0x504452=getClient(_0x56dde5['id']);if(_0x504452)getBackupFiles(_0x504452['uuid']);else logger[_0x4a8a30(0x366)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x56dde5['on']('restore-backup-file',(_0x490c3a,_0x46ab82)=>{const _0x2575c9=_0x1c8622;if(validateAccess(_0x46ab82,_0x17d261)[_0x2575c9(0x381)])restoreBackupFile(_0x490c3a);else logger[_0x2575c9(0x366)](_0x2575c9(0x3cf));}),_0x56dde5['on'](_0x1c8622(0x250),_0x50c06a=>{const _0x2bd73b=_0x1c8622;if(validateAccess(_0x50c06a,_0x17d261)['allow'])getMessages();else logger[_0x2bd73b(0x366)](_0x2bd73b(0x22b));}),_0x56dde5['on'](_0x1c8622(0x3a2),(_0xe00a9d,_0x4a4fa6)=>{const _0x51249b=_0x1c8622;if(validateAccess(_0x4a4fa6,_0x17d261)[_0x51249b(0x381)])confirmMessage(_0xe00a9d);else logger[_0x51249b(0x366)](_0x51249b(0x386));}),_0x56dde5['on']('logout',_0x214b6e=>{const _0x1a8c0a=_0x1c8622;if(validateAccess(_0x214b6e,_0x17d261)[_0x1a8c0a(0x381)]){if(devices[_0x17d261][_0x1a8c0a(0x329)])clearTimeout(devices[_0x17d261][_0x1a8c0a(0x329)]);if(devices[_0x17d261][_0x1a8c0a(0x220)])clearTimeout(devices[_0x17d261]['pidExpireLogin']);removeSocketListeners(getClient(_0x56dde5['id'])[_0x1a8c0a(0x35d)]),addBlacklist(_0x17d261),devices[_0x17d261]['telegramIpApproval']=null,devices[_0x17d261]['telegram2FaApproval']=null,devices[_0x17d261][_0x1a8c0a(0x2dd)][_0x1a8c0a(0x1db)]=null,logger[_0x1a8c0a(0x350)](_0x1a8c0a(0x31e)+_0x17d261[_0x1a8c0a(0x340)](-0x8)),io['to'](getClient(_0x56dde5['id'])[_0x1a8c0a(0x35d)])[_0x1a8c0a(0x234)](_0x1a8c0a(0x2ab),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x1a8c0a(0x366)](_0x1a8c0a(0x23d));});}function initializeSocketBot(_0x1fcb53){const _0x53cedd=_0x50ef29,_0x188a12=getClient(_0x1fcb53['id'])[_0x53cedd(0x1e9)],_0x4b089d=getClient(_0x1fcb53['id'])[_0x53cedd(0x35d)];_0x1fcb53['on'](_0x53cedd(0x360),(_0x44e58f,_0x296f0e)=>{const _0xdf3039=_0x53cedd;if(validateAccess(_0x296f0e,_0x4b089d)[_0xdf3039(0x381)]){if(pid[_0x188a12])pid[_0x188a12][_0xdf3039(0x304)]({'function':'emitHistory','args':_0x44e58f});}else logger[_0xdf3039(0x366)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x1fcb53['on'](_0x53cedd(0x316),(_0x3845a1,_0x3ee7c2)=>{const _0x559567=_0x53cedd;if(validateAccess(_0x3ee7c2,_0x4b089d)[_0x559567(0x381)]){if(pid[_0x188a12])pid[_0x188a12]['send']({'function':'deleteHistoryAlerts','args':_0x3845a1});}else logger[_0x559567(0x366)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x1fcb53['on']('get-portfolio',(_0x29c0c2,_0x39fa03)=>{const _0x1abafe=_0x53cedd;if(validateAccess(_0x39fa03,_0x4b089d)[_0x1abafe(0x381)]){if(pid[_0x188a12])pid[_0x188a12][_0x1abafe(0x304)]({'function':_0x1abafe(0x368),'args':_0x29c0c2});}else logger[_0x1abafe(0x366)](_0x1abafe(0x395));}),_0x1fcb53['on'](_0x53cedd(0x3a8),(_0x542e76,_0x48954b)=>{const _0x11d7ac=_0x53cedd;if(validateAccess(_0x48954b,_0x4b089d)['allow']){if(pid[_0x188a12])pid[_0x188a12][_0x11d7ac(0x304)]({'function':'storeConfiguration','args':_0x542e76});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x1fcb53['on']('store-headless',(_0x4b3841,_0x479781)=>{const _0x28b127=_0x53cedd;if(validateAccess(_0x479781,_0x4b089d)['allow']){if(pid[_0x188a12])pid[_0x188a12][_0x28b127(0x304)]({'function':_0x28b127(0x392),'args':_0x4b3841});}else logger['full'](_0x28b127(0x201));}),_0x1fcb53['on'](_0x53cedd(0x231),(_0x19dd1b,_0x442bb2)=>{const _0x5b8a8f=_0x53cedd;if(validateAccess(_0x442bb2,_0x4b089d)[_0x5b8a8f(0x381)]){if(pid[_0x188a12])pid[_0x188a12][_0x5b8a8f(0x304)]({'function':_0x5b8a8f(0x314),'args':_0x19dd1b});}else logger[_0x5b8a8f(0x366)](_0x5b8a8f(0x273));}),_0x1fcb53['on']('reset-history',_0x417c84=>{const _0x446472=_0x53cedd;if(validateAccess(_0x417c84,_0x4b089d)[_0x446472(0x381)]){if(pid[_0x188a12])pid[_0x188a12][_0x446472(0x304)]({'function':'resetHistory','args':null});}else logger[_0x446472(0x366)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x1fcb53['on'](_0x53cedd(0x2a9),_0x1ddfca=>{const _0x264f80=_0x53cedd;if(validateAccess(_0x1ddfca,_0x4b089d)['allow']){if(pid[_0x188a12])pid[_0x188a12][_0x264f80(0x304)]({'function':_0x264f80(0x1fa),'args':null});}else logger[_0x264f80(0x366)](_0x264f80(0x2dc));}),_0x1fcb53['on']('place-order',(_0x45765a,_0x562d3f)=>{const _0x2d71a6=_0x53cedd;if(validateAccess(_0x562d3f,_0x4b089d)[_0x2d71a6(0x381)]){if(pid[_0x188a12])pid[_0x188a12]['send']({'function':_0x2d71a6(0x3c8),'args':_0x45765a});}else logger['full'](_0x2d71a6(0x372));}),_0x1fcb53['on'](_0x53cedd(0x229),_0x2d2de0=>{const _0x573f48=_0x53cedd;if(validateAccess(_0x2d2de0,_0x4b089d)[_0x573f48(0x381)]){if(pid[_0x188a12])pid[_0x188a12][_0x573f48(0x304)]({'function':_0x573f48(0x247),'args':null});}else logger[_0x573f48(0x366)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x1fcb53['on'](_0x53cedd(0x351),_0x513d4e=>{const _0x2e8c48=_0x53cedd;if(validateAccess(_0x513d4e,_0x4b089d)[_0x2e8c48(0x381)]){if(pid[_0x188a12])pid[_0x188a12]['send']({'function':'showConfig','args':null});}else logger['full'](_0x2e8c48(0x32e));}),_0x1fcb53['on']('update-bb',_0x3fdcd0=>{const _0x49e718=_0x53cedd;if(validateAccess(_0x3fdcd0,_0x4b089d)[_0x49e718(0x381)])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x1fcb53['on'](_0x53cedd(0x250),_0x1bbce8=>{const _0x452bd5=_0x53cedd;if(validateAccess(_0x1bbce8,_0x4b089d)[_0x452bd5(0x381)])getMessages();else logger[_0x452bd5(0x366)](_0x452bd5(0x22b));}),_0x1fcb53['on'](_0x53cedd(0x3a2),(_0x2ac486,_0x57a778)=>{const _0x537271=_0x53cedd;if(validateAccess(_0x57a778,_0x4b089d)['allow'])confirmMessage(_0x2ac486);else logger[_0x537271(0x366)](_0x537271(0x386));}),_0x1fcb53['on']('logout',_0x3d2e72=>{const _0x377201=_0x53cedd;if(validateAccess(_0x3d2e72,_0x4b089d)[_0x377201(0x381)]){if(devices[_0x4b089d][_0x377201(0x329)])clearTimeout(devices[_0x4b089d][_0x377201(0x329)]);if(devices[_0x4b089d][_0x377201(0x220)])clearTimeout(devices[_0x4b089d]['pidExpireLogin']);removeSocketListeners(getClient(_0x1fcb53['id'])['uuid']),addBlacklist(_0x4b089d),devices[_0x4b089d][_0x377201(0x362)]=null,devices[_0x4b089d][_0x377201(0x20b)]=null,devices[_0x4b089d][_0x377201(0x2dd)][_0x377201(0x1db)]=null,logger[_0x377201(0x350)](_0x377201(0x31e)+_0x4b089d['slice'](-0x8)),io['to'](getClient(_0x1fcb53['id'])['uuid'])['emit'](_0x377201(0x2ab),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x377201(0x23d));});}function removeSocketListeners(_0x3f08dc){const _0x28b4ba=_0x50ef29;getClientsWithUuid(_0x3f08dc)[_0x28b4ba(0x34b)](_0x50335c=>{const _0x1db3bc=_0x28b4ba;getSocket(_0x50335c['id'])[_0x1db3bc(0x317)]();});}function cleanSettings(){const _0x3d0471=_0x50ef29;let _0x18edb6=settings;return settings[_0x3d0471(0x28c)]&&settings[_0x3d0471(0x28c)]!=''&&(_0x18edb6={..._0x18edb6,'telegramToken':_0x3d0471(0x37c)}),settings[_0x3d0471(0x1e0)]&&settings[_0x3d0471(0x1e0)]!=''&&(_0x18edb6={..._0x18edb6,'bbPassword':_0x3d0471(0x37c)}),settings[_0x3d0471(0x30f)]&&settings[_0x3d0471(0x30f)]!=''&&(_0x18edb6={..._0x18edb6,'marketcapApi':_0x3d0471(0x37c)}),(settings[_0x3d0471(0x1e0)]&&settings[_0x3d0471(0x1e0)]==_0x3d0471(0x222)||settings[_0x3d0471(0x28c)]&&settings[_0x3d0471(0x28c)]==_0x3d0471(0x222)||settings[_0x3d0471(0x30f)]&&settings[_0x3d0471(0x30f)]==_0x3d0471(0x222))&&(_0x18edb6={..._0x18edb6,'restored':{'password':settings['bbPassword']==_0x3d0471(0x222),'telegram':settings[_0x3d0471(0x28c)]==_0x3d0471(0x222),'marketcap':settings[_0x3d0471(0x30f)]=='***'}}),_0x18edb6;}async function updateBB(_0x41612d){const _0x7e4877=_0x50ef29;await backupConfigFiles(),installingUpdate=!![],config[_0x7e4877(0x34b)](_0x1ad3ed=>{restartBot(_0x1ad3ed['botID']);});if(_0x41612d=='update')process[_0x7e4877(0x304)]({'update':!![],'environment':environment},_0x2db4d3=>{});else _0x41612d==_0x7e4877(0x24b)&&process[_0x7e4877(0x304)]({'reinstall':!![],'environment':environment},_0x491d3b=>{});}function startBot(_0x426442,_0x4201b1,_0xeb6766){const _0x47ff25=_0x50ef29;if(debugging)_0x426442[_0x47ff25(0x2ed)]('-d');let _0x1b3c54=![];const _0x1c826b=_0x426442[0x0];_0x4201b1={..._0x4201b1,'stdio':[_0x47ff25(0x2ce),_0x47ff25(0x2ce),_0x47ff25(0x2ce),_0x47ff25(0x29a)]},pid[_0x1c826b]=childProcess[_0x47ff25(0x324)](botfile,_0x426442,_0x4201b1),pid[_0x1c826b]['on']('message',_0x46d708=>{const _0x486f9d=_0x47ff25;switch(Object[_0x486f9d(0x38b)](_0x46d708)[0x0]){case _0x486f9d(0x398):updateBotName(_0x1c826b,_0x46d708['botname']);break;case _0x486f9d(0x2e3):updateBotManager();break;case _0x486f9d(0x2ab):updateStatus(_0x1c826b,_0x46d708[_0x486f9d(0x2ab)]);break;case _0x486f9d(0x1eb):updateLive(_0x1c826b,_0x46d708['live']);break;case _0x486f9d(0x3d5):updateLive(_0x1c826b,_0x46d708[_0x486f9d(0x3d5)]),io['to'](_0x1c826b)[_0x486f9d(0x234)](_0x486f9d(0x2ab),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x486f9d(0x237):_0x46d708[_0x486f9d(0x237)]=='restart'&&restartBot(_0x1c826b);_0x46d708[_0x486f9d(0x237)]==_0x486f9d(0x2a8)&&toggleBot(_0x1c826b,_0x486f9d(0x2fc),'stopped');break;case _0x486f9d(0x31a):sendTelegramBot(_0x1c826b,_0x46d708[_0x486f9d(0x31a)]);break;case'telegrammsg':sendTelegramMsg(_0x46d708[_0x486f9d(0x2e8)]);break;case _0x486f9d(0x330):io['to'](_0x1c826b)[_0x486f9d(0x234)](_0x46d708[_0x486f9d(0x330)],_0x46d708[_0x486f9d(0x2b8)]);break;}}),pid[_0x1c826b]['on'](_0x47ff25(0x338),function(_0x575581){if(_0x1b3c54)return;_0x1b3c54=!![],_0xeb6766(_0x575581);}),pid[_0x1c826b]['on'](_0x47ff25(0x2fb),async function(_0x584045){const _0x512cde=_0x47ff25;if(terminating)return;if(installingUpdate){io[_0x512cde(0x279)]();return;}if(_0x1b3c54)return;_0x1b3c54=!![],_0xeb6766(null);const _0x33b8ae=dbConfig[_0x512cde(0x284)]('bots')[_0x512cde(0x261)]({'botID':_0x1c826b})[_0x512cde(0x3d3)]();_0x33b8ae&&(_0x33b8ae[_0x512cde(0x2ab)]==_0x512cde(0x1e7)||_0x33b8ae[_0x512cde(0x2ab)]==_0x512cde(0x285))&&(await sleep(0x3e8),updateLive(_0x1c826b,_0x512cde(0x257)),logger[_0x512cde(0x366)]('Restarting\x20Bot\x20'+_0x1c826b),startBot([_0x1c826b,userID],{'cwd':bbpath},function(_0x35620e){const _0x42ce1c=_0x512cde;if(_0x35620e)logger[_0x42ce1c(0x366)](_0x35620e);}));});}function stopBot(_0x29d081){const _0x2d1ee7=_0x50ef29;getClientsWithBotID(_0x29d081)[_0x2d1ee7(0x34b)](_0x53e4de=>{getSocket(_0x53e4de['id'])['disconnect'](!![]),removeClient(_0x53e4de['id']);}),pid[_0x29d081]&&(pid[_0x29d081][_0x2d1ee7(0x2a8)](),pid[_0x29d081]=null);}function stopAllBots(){terminating=!![];const _0x4a71d2=getEnabledBots();_0x4a71d2['forEach'](_0x19241e=>{const _0x2e211a=_0x4877;stopBot(_0x19241e[_0x2e211a(0x29b)]);});}function restartBot(_0x361537){if(pid[_0x361537])pid[_0x361537]['kill']();}function addBot(){const _0x270f9d=_0x50ef29;let _0x2fedbe;for(let _0x335d64=0x1;_0x335d64<0x3e9;_0x335d64++){_0x2fedbe=_0x335d64[_0x270f9d(0x211)]()[_0x270f9d(0x3b9)](0x3,'0');let _0x4c1801=config[_0x270f9d(0x261)](_0x423cba=>_0x423cba[_0x270f9d(0x29b)]==_0x2fedbe);if(!_0x4c1801)break;}if(_0x2fedbe===_0x270f9d(0x346)){logger[_0x270f9d(0x366)](_0x270f9d(0x253));return;}logger[_0x270f9d(0x366)](_0x270f9d(0x241)+_0x2fedbe),dbConfig['get']('bots')[_0x270f9d(0x2ed)]({'botID':_0x2fedbe,'botname':_0x270f9d(0x2a2)+_0x2fedbe,'status':_0x270f9d(0x285),'live':''})[_0x270f9d(0x221)](),startBot([_0x2fedbe,userID],{'cwd':bbpath},function(_0x36ac24){const _0x54d202=_0x270f9d;if(_0x36ac24)logger[_0x54d202(0x366)](_0x36ac24);}),config=getConfiguration(),io['to'](_0x270f9d(0x348))[_0x270f9d(0x234)](_0x270f9d(0x313),config),broadcastToBots('bots',JSON[_0x270f9d(0x2b7)](config));}function deleteBot(_0x101702){const _0x298510=_0x50ef29;getClientsWithBotID(_0x101702)[_0x298510(0x34b)](_0x118648=>{const _0x432af6=_0x298510;getSocket(_0x118648['id'])[_0x432af6(0x1de)](!![]),removeClient(_0x118648['id']);}),dbConfig['get']('bots')[_0x298510(0x27d)]({'botID':_0x101702})[_0x298510(0x221)](),logger[_0x298510(0x366)](_0x298510(0x1cf)+_0x101702),stopBot(_0x101702);try{if(fs[_0x298510(0x1d7)](path['join'](configpath,'bot-'+_0x101702+_0x298510(0x375))))fs['unlinkSync'](path['join'](configpath,_0x298510(0x31f)+_0x101702+_0x298510(0x375)));if(fs['existsSync'](path['join'](configpath,_0x298510(0x31f)+_0x101702+'-events.json')))fs[_0x298510(0x3bc)](path[_0x298510(0x203)](configpath,_0x298510(0x31f)+_0x101702+_0x298510(0x214)));if(fs[_0x298510(0x1d7)](path[_0x298510(0x203)](configpath,_0x298510(0x31f)+_0x101702+_0x298510(0x37a))))fs[_0x298510(0x3bc)](path[_0x298510(0x203)](configpath,'bot-'+_0x101702+_0x298510(0x37a)));if(fs['existsSync'](path[_0x298510(0x203)](configpath,_0x298510(0x31f)+_0x101702+_0x298510(0x228))))fs['unlinkSync'](path[_0x298510(0x203)](configpath,'bot-'+_0x101702+'-results.json'));}catch(_0x3889f8){if(_0x3889f8)logger[_0x298510(0x366)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x3889f8);}config=getConfiguration(),io['to']('botmanager')[_0x298510(0x234)](_0x298510(0x313),config),broadcastToBots(_0x298510(0x313),JSON['stringify'](config));}function toggleBot(_0x126cd0,_0x1470a4,_0x8a55e0){const _0x4f6b9c=_0x50ef29;dbConfig[_0x4f6b9c(0x284)](_0x4f6b9c(0x313))['find']({'botID':_0x126cd0})['assign']({'status':_0x1470a4})[_0x4f6b9c(0x34f)]({'live':_0x8a55e0})['write']();if(_0x1470a4==_0x4f6b9c(0x1e7)||_0x1470a4=='new')logger[_0x4f6b9c(0x366)]('Enabled\x20Bot\x20'+_0x126cd0),startBot([_0x126cd0,userID],{'cwd':bbpath},function(_0xd32f81){const _0x3e5ce6=_0x4f6b9c;if(_0xd32f81)logger[_0x3e5ce6(0x366)](_0xd32f81);});else(_0x1470a4==_0x4f6b9c(0x2fc)||_0x1470a4==_0x4f6b9c(0x3d8))&&(logger[_0x4f6b9c(0x366)](_0x4f6b9c(0x2eb)+_0x126cd0),stopBot(_0x126cd0));config=getConfiguration(),io['to']('botmanager')[_0x4f6b9c(0x234)](_0x4f6b9c(0x313),config),broadcastToBots('bots',JSON[_0x4f6b9c(0x2b7)](config));}function toggleStatus(_0x2146aa){const _0x31b5cd=_0x50ef29;let _0xbb1325=dbConfig[_0x31b5cd(0x284)](_0x31b5cd(0x313))[_0x31b5cd(0x261)]({'botID':_0x2146aa})[_0x31b5cd(0x3d3)](),_0x387e63;if(_0xbb1325[_0x31b5cd(0x2ab)]===_0x31b5cd(0x1e7))_0x387e63=_0x31b5cd(0x2fc);else{if(_0xbb1325['status']===_0x31b5cd(0x285))_0x387e63=_0x31b5cd(0x3d8);else{if(_0xbb1325[_0x31b5cd(0x2ab)]==='new-disabled')_0x387e63='new';else{if(_0xbb1325[_0x31b5cd(0x2ab)]===_0x31b5cd(0x2fc))_0x387e63=_0x31b5cd(0x1e7);}}}return _0x387e63;}function updateStatus(_0xafddce,_0x551c87){const _0x177229=_0x50ef29;dbConfig[_0x177229(0x284)](_0x177229(0x313))[_0x177229(0x261)]({'botID':_0xafddce})['assign']({'status':_0x551c87})[_0x177229(0x221)](),config=getConfiguration(),io['to'](_0x177229(0x348))[_0x177229(0x234)](_0x177229(0x313),config),broadcastToBots(_0x177229(0x313),JSON['stringify'](config));}function updateLive(_0x3a8718,_0x458277){const _0x4ecc60=_0x50ef29;dbConfig['get']('bots')[_0x4ecc60(0x261)]({'botID':_0x3a8718})['assign']({'live':_0x458277})[_0x4ecc60(0x221)](),config=getConfiguration(),io['to'](_0x4ecc60(0x348))[_0x4ecc60(0x234)](_0x4ecc60(0x313),config),broadcastToBots(_0x4ecc60(0x313),JSON[_0x4ecc60(0x2b7)](config));}function updateBotName(_0x10c9f6,_0x4242b9){const _0x571720=_0x50ef29;dbConfig['get']('bots')[_0x571720(0x261)]({'botID':_0x10c9f6})[_0x571720(0x34f)]({'botname':_0x4242b9})[_0x571720(0x221)](),config=getConfiguration(),io['to'](_0x571720(0x348))[_0x571720(0x234)](_0x571720(0x313),config),broadcastToBots('bots',JSON[_0x571720(0x2b7)](config));}function updateBotManager(){const _0x3f5ab1=_0x50ef29;config=getConfiguration(),io['to'](_0x3f5ab1(0x348))[_0x3f5ab1(0x234)](_0x3f5ab1(0x313),config),broadcastToBots(_0x3f5ab1(0x313),JSON[_0x3f5ab1(0x2b7)](config));}function toggleBotMode(_0x183237){const _0x536541=_0x50ef29;if(pid[_0x183237])pid[_0x183237][_0x536541(0x304)]({'function':_0x536541(0x2ad),'args':null});else{const _0xde53fa=configpath+'bot-'+_0x183237+_0x536541(0x375),_0x42982a=fs['readFileSync'](_0xde53fa),_0x11f741=JSON['parse'](_0x42982a),_0x4c8ef2=_0x11f741[_0x536541(0x1e9)][0x0][_0x536541(0x269)];_0x11f741[_0x536541(0x1e9)][0x0][_0x536541(0x269)]=!_0x4c8ef2;const _0xdf2df3=JSON[_0x536541(0x2b7)](_0x11f741,null,0x2);fs[_0x536541(0x2ee)](_0xde53fa,_0xdf2df3),config=getConfiguration(),io['to']('botmanager')[_0x536541(0x234)](_0x536541(0x313),config),broadcastToBots(_0x536541(0x313),JSON[_0x536541(0x2b7)](config));}}function validateTelegram(_0x4ab564){const _0x395d99=_0x50ef29;if(_0x4ab564[_0x395d99(0x233)][_0x395d99(0x274)]!=settings[_0x395d99(0x3a0)]&&'@'+_0x4ab564[_0x395d99(0x233)]['username']!=settings[_0x395d99(0x3a0)]||_0x4ab564['chat']['id']!=settings[_0x395d99(0x365)])return sendTelegram(_0x4ab564['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x395d99(0x36c)}),![];return!![];}async function initTelegram(){const _0x490ce0=_0x50ef29;if(tgBot)tgBot[_0x490ce0(0x237)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x490ce0(0x28c)]);let _0x281d99=_0x490ce0(0x2b0);_0x281d99+='\x0a',_0x281d99+=_0x490ce0(0x1d8),_0x281d99+=_0x490ce0(0x385),_0x281d99+=_0x490ce0(0x2f2),_0x281d99+=_0x490ce0(0x1d3),_0x281d99+=_0x490ce0(0x20a),_0x281d99+=_0x490ce0(0x2c2),_0x281d99+=_0x490ce0(0x2c8),_0x281d99+=_0x490ce0(0x1fd),_0x281d99+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x281d99+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x281d99+=_0x490ce0(0x342),_0x281d99+=_0x490ce0(0x33d),_0x281d99+=_0x490ce0(0x373),_0x281d99+=_0x490ce0(0x3cb);let _0x53e8ee=_0x490ce0(0x259);_0x53e8ee+='\x0a',_0x53e8ee+=_0x281d99,tgBot[_0x490ce0(0x3a4)]((_0x196c63,_0x437d5b)=>{const _0x3d05fb=_0x490ce0;logger[_0x3d05fb(0x1d4)](getTimeStamp()+_0x3d05fb(0x2fa)),logger[_0x3d05fb(0x350)]('Telegraf\x20error:',_0x196c63);}),tgBot[_0x490ce0(0x1f8)](async(_0x1e38cd,_0x42989d)=>{const _0x1a1738=_0x490ce0;if(!(!settings[_0x1a1738(0x365)]&&_0x1e38cd[_0x1a1738(0x293)]['message']['text']==_0x1a1738(0x1c9))){if(!validateTelegram(_0x1e38cd))return;}_0x42989d();}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x341),async _0x169995=>{const _0x2c34db=_0x490ce0;if(!settings[_0x2c34db(0x365)])updateSetting(_0x2c34db(0x365),_0x169995['chat']['id']);updateSetting(_0x2c34db(0x3c0),!![]);if(!validateTelegram(_0x169995))return;await sendTelegram(_0x169995['chat']['id'],_0x53e8ee);}),tgBot['command'](_0x490ce0(0x33b),async _0x1162d2=>{const _0x3c3fa8=_0x490ce0;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1162d2[_0x3c3fa8(0x2d6)]['id'],_0x3c3fa8(0x2aa));}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x2bb),async _0x5db586=>{const _0x3719fc=_0x490ce0;await sendTelegram(_0x5db586['chat']['id'],_0x3719fc(0x3a5)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x490ce0(0x28d),async _0x20c0b5=>{const _0x563438=_0x490ce0,_0x5c70ae=Markup[_0x563438(0x282)]([Markup[_0x563438(0x254)][_0x563438(0x2ac)](_0x563438(0x352),_0x563438(0x2a3)),Markup[_0x563438(0x254)][_0x563438(0x2ac)](_0x563438(0x332),_0x563438(0x27b)),Markup['button']['callback']('All',_0x563438(0x2db))]);_0x20c0b5['reply'](_0x563438(0x2f0),_0x5c70ae);}),tgBot[_0x490ce0(0x238)](_0x490ce0(0x2a3),async _0x190878=>{const _0x205a05=_0x490ce0;_0x190878['editMessageReplyMarkup'](),updateSetting(_0x205a05(0x23e),_0x205a05(0x245)),updateSetting(_0x205a05(0x3c0),!![]),await sendTelegram(_0x190878[_0x205a05(0x2d6)]['id'],_0x205a05(0x23a));}),tgBot[_0x490ce0(0x238)](_0x490ce0(0x27b),async _0x15108b=>{const _0x505680=_0x490ce0;_0x15108b['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x505680(0x358)),updateSetting(_0x505680(0x3c0),!![]),await sendTelegram(_0x15108b[_0x505680(0x2d6)]['id'],_0x505680(0x1ec));}),tgBot[_0x490ce0(0x238)](_0x490ce0(0x2db),async _0x4cb3c2=>{const _0x29afd3=_0x490ce0;_0x4cb3c2[_0x29afd3(0x3a1)](),updateSetting(_0x29afd3(0x23e),_0x29afd3(0x297)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4cb3c2[_0x29afd3(0x2d6)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x490ce0(0x347)]('status',async _0x5bb01d=>{const _0x5721b0=_0x490ce0,_0x31bf61=getBotsWithMode();let _0x356455='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x5721b0(0x34b)](_0x2df004=>{const _0x247a3f=_0x5721b0,_0x39d732=_0x31bf61[_0x247a3f(0x261)](_0x531b4a=>_0x531b4a[_0x247a3f(0x29b)]==_0x2df004[_0x247a3f(0x29b)])[_0x247a3f(0x2ba)];_0x356455+=_0x247a3f(0x2a2)+_0x2df004[_0x247a3f(0x29b)]+':\x20'+_0x2df004[_0x247a3f(0x2ab)]+_0x247a3f(0x3b5)+_0x39d732+_0x247a3f(0x3b5)+_0x2df004['live']+'\x0a';}),_0x356455+='\x0a',_0x356455+=_0x5721b0(0x3bd),_0x356455+=!settings[_0x5721b0(0x3c0)]?_0x5721b0(0x380):_0x5721b0(0x29e),_0x356455+=settings[_0x5721b0(0x3c0)]?settings[_0x5721b0(0x23e)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x5721b0(0x37e)+settings['telegramEvents']+_0x5721b0(0x262):'',await sendTelegram(_0x5bb01d['chat']['id'],_0x356455,{'parse_mode':'HTML'});}),tgBot[_0x490ce0(0x347)]('restart',async _0xf06fd0=>{const _0x1a72cd=_0x490ce0,_0x97ff0=getEnabledBots();if(_0x97ff0[_0x1a72cd(0x3b6)]==0x0)await sendTelegram(_0xf06fd0[_0x1a72cd(0x2d6)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x97ff0[_0x1a72cd(0x3b6)]>0x1)_0x97ff0[_0x1a72cd(0x2ed)]({'botID':_0x1a72cd(0x297)});let _0x22a01d=[],_0x396a07=[];const _0x234f3c=_0x97ff0[_0x1a72cd(0x3b6)]%0x4==0x0||_0x97ff0[_0x1a72cd(0x3b6)]%0x4==0x3||_0x97ff0[_0x1a72cd(0x3b6)]%0x3==0x1?0x4:0x3;let _0x34bc45=0x0;_0x97ff0[_0x1a72cd(0x34b)]((_0x212866,_0x32dbf1)=>{const _0x1caa93=_0x1a72cd;if(_0x32dbf1%_0x234f3c==0x0)_0x396a07=[];_0x396a07['push'](Markup['button']['callback'](_0x212866[_0x1caa93(0x29b)]==_0x1caa93(0x297)?_0x1caa93(0x36f):_0x1caa93(0x2a2)+_0x212866[_0x1caa93(0x29b)],_0x1caa93(0x2f1)+_0x212866[_0x1caa93(0x29b)])),_0x32dbf1%_0x234f3c==0x0&&(_0x22a01d[_0x34bc45]=_0x396a07,_0x34bc45++);});const _0x3a690b=Markup[_0x1a72cd(0x282)](_0x22a01d);_0xf06fd0[_0x1a72cd(0x23f)](_0x1a72cd(0x38c),_0x3a690b);}}),tgBot[_0x490ce0(0x238)](/restart_(.+)/,async _0xc43f2=>{const _0x526fe=_0x490ce0,_0x1fbeb6=_0xc43f2[_0x526fe(0x387)][0x1];_0xc43f2['editMessageReplyMarkup'](),_0x1fbeb6==_0x526fe(0x297)?config[_0x526fe(0x34b)](_0x14b794=>{const _0x30c13b=_0x526fe;restartBot(_0x14b794[_0x30c13b(0x29b)]);}):restartBot(_0x1fbeb6);}),tgBot[_0x490ce0(0x347)]('on',async _0x5341fd=>{const _0x210739=_0x490ce0,_0x2c3bb8=getDisabledBots();if(_0x2c3bb8[_0x210739(0x3b6)]==0x0)await sendTelegram(_0x5341fd[_0x210739(0x2d6)]['id'],_0x210739(0x25d));else{if(_0x2c3bb8[_0x210739(0x3b6)]>0x1)_0x2c3bb8[_0x210739(0x2ed)]({'botID':'all'});let _0x534f4d=[],_0x247c5a=[];const _0x2a27e3=_0x2c3bb8['length']%0x4==0x0||_0x2c3bb8['length']%0x4==0x3||_0x2c3bb8[_0x210739(0x3b6)]%0x3==0x1?0x4:0x3;let _0x5d9a82=0x0;_0x2c3bb8[_0x210739(0x34b)]((_0x3c6b0d,_0x3b3686)=>{const _0x44a034=_0x210739;if(_0x3b3686%_0x2a27e3==0x0)_0x247c5a=[];_0x247c5a[_0x44a034(0x2ed)](Markup[_0x44a034(0x254)][_0x44a034(0x2ac)](_0x3c6b0d[_0x44a034(0x29b)]==_0x44a034(0x297)?_0x44a034(0x36f):_0x44a034(0x2a2)+_0x3c6b0d[_0x44a034(0x29b)],_0x44a034(0x31c)+_0x3c6b0d['botID'])),_0x3b3686%_0x2a27e3==0x0&&(_0x534f4d[_0x5d9a82]=_0x247c5a,_0x5d9a82++);});const _0x10d895=Markup['inlineKeyboard'](_0x534f4d);_0x5341fd[_0x210739(0x23f)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x10d895);}}),tgBot['action'](/on_(.+)/,async _0x243e8e=>{const _0x239329=_0x490ce0,_0x3a4a1a=_0x243e8e['match'][0x1];_0x243e8e[_0x239329(0x3a1)]();if(_0x3a4a1a==_0x239329(0x297)){const _0x57403b=getDisabledBots();await sendTelegram(_0x243e8e[_0x239329(0x2d6)]['id'],_0x239329(0x333)),_0x57403b[_0x239329(0x34b)](_0x277168=>{const _0x174f45=_0x239329;if(_0x277168[_0x174f45(0x29b)]!=_0x174f45(0x297))toggleBot(_0x277168['botID'],toggleStatus(_0x277168[_0x174f45(0x29b)]),_0x174f45(0x257));});}else await sendTelegram(_0x243e8e[_0x239329(0x2d6)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x3a4a1a),toggleBot(_0x3a4a1a,toggleStatus(_0x3a4a1a),_0x239329(0x257));}),tgBot[_0x490ce0(0x347)]('off',async _0x58e850=>{const _0x54026a=_0x490ce0,_0x24047b=getEnabledBots();if(_0x24047b[_0x54026a(0x3b6)]==0x0)await sendTelegram(_0x58e850[_0x54026a(0x2d6)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x24047b[_0x54026a(0x3b6)]>0x1)_0x24047b[_0x54026a(0x2ed)]({'botID':_0x54026a(0x297)});let _0x272a88=[],_0x1e2366=[];const _0x2ebc42=_0x24047b[_0x54026a(0x3b6)]%0x4==0x0||_0x24047b[_0x54026a(0x3b6)]%0x4==0x3||_0x24047b[_0x54026a(0x3b6)]%0x3==0x1?0x4:0x3;let _0x4389e6=0x0;_0x24047b[_0x54026a(0x34b)]((_0x2e5e5d,_0x2d6754)=>{const _0xed6260=_0x54026a;if(_0x2d6754%_0x2ebc42==0x0)_0x1e2366=[];_0x1e2366['push'](Markup['button'][_0xed6260(0x2ac)](_0x2e5e5d[_0xed6260(0x29b)]=='all'?'All\x20bots':_0xed6260(0x2a2)+_0x2e5e5d['botID'],_0xed6260(0x3b2)+_0x2e5e5d['botID'])),_0x2d6754%_0x2ebc42==0x0&&(_0x272a88[_0x4389e6]=_0x1e2366,_0x4389e6++);});const _0x48d677=Markup[_0x54026a(0x282)](_0x272a88);_0x58e850[_0x54026a(0x23f)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x48d677);}}),tgBot['action'](/off_(.+)/,async _0x1a6117=>{const _0x422612=_0x490ce0,_0x6fa713=_0x1a6117[_0x422612(0x387)][0x1];_0x1a6117[_0x422612(0x3a1)]();if(_0x6fa713==_0x422612(0x297)){const _0x1c01db=getEnabledBots();await sendTelegram(_0x1a6117[_0x422612(0x2d6)]['id'],_0x422612(0x2a1)),_0x1c01db[_0x422612(0x34b)](_0x400061=>{const _0x18266c=_0x422612;if(_0x400061[_0x18266c(0x29b)]!=_0x18266c(0x297))toggleBot(_0x400061[_0x18266c(0x29b)],toggleStatus(_0x400061['botID']),'stopped');});}else await sendTelegram(_0x1a6117[_0x422612(0x2d6)]['id'],_0x422612(0x34d)+_0x6fa713),toggleBot(_0x6fa713,toggleStatus(_0x6fa713),_0x422612(0x257));}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x2d5),async _0x286b18=>{const _0x2b0281=_0x490ce0,_0x2194c6=getEnabledBots();if(_0x2194c6[_0x2b0281(0x3b6)]==0x0)await sendTelegram(_0x286b18['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2194c6['length']>0x1){let _0x44565a=[],_0x5c2bbc=[];const _0x21216d=_0x2194c6[_0x2b0281(0x3b6)]%0x4==0x0||_0x2194c6[_0x2b0281(0x3b6)]%0x4==0x3||_0x2194c6[_0x2b0281(0x3b6)]%0x3==0x1?0x4:0x3;let _0x259a6a=0x0;_0x2194c6[_0x2b0281(0x34b)]((_0x2692f8,_0xa1c354)=>{const _0x2d5eda=_0x2b0281;if(_0xa1c354%_0x21216d==0x0)_0x5c2bbc=[];_0x5c2bbc[_0x2d5eda(0x2ed)](Markup[_0x2d5eda(0x254)][_0x2d5eda(0x2ac)](_0x2d5eda(0x2a2)+_0x2692f8[_0x2d5eda(0x29b)],_0x2d5eda(0x2c4)+_0x2692f8[_0x2d5eda(0x29b)])),_0xa1c354%_0x21216d==0x0&&(_0x44565a[_0x259a6a]=_0x5c2bbc,_0x259a6a++);});const _0x55823f=Markup['inlineKeyboard'](_0x44565a);_0x286b18['reply'](_0x2b0281(0x1dc),_0x55823f);}else{const _0xaa3c82=_0x2194c6[0x0][_0x2b0281(0x29b)];if(pid[_0xaa3c82])pid[_0xaa3c82][_0x2b0281(0x304)]({'function':_0x2b0281(0x1f9),'args':null});}}}),tgBot[_0x490ce0(0x238)](/metrics_(.+)/,async _0x1380c4=>{const _0x5bf27b=_0x490ce0,_0x3c3646=_0x1380c4[_0x5bf27b(0x387)][0x1];_0x1380c4['editMessageReplyMarkup']();if(pid[_0x3c3646])pid[_0x3c3646][_0x5bf27b(0x304)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x490ce0(0x347)]('portfolio',async _0x3ca436=>{const _0x358b06=_0x490ce0,_0x492d65=getEnabledBots();if(_0x492d65[_0x358b06(0x3b6)]==0x0)await sendTelegram(_0x3ca436[_0x358b06(0x2d6)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x492d65['length']>0x1){let _0x288865=[],_0x399873=[];const _0x4b40ab=_0x492d65[_0x358b06(0x3b6)]%0x4==0x0||_0x492d65[_0x358b06(0x3b6)]%0x4==0x3||_0x492d65[_0x358b06(0x3b6)]%0x3==0x1?0x4:0x3;let _0x13ddfb=0x0;_0x492d65[_0x358b06(0x34b)]((_0x1c7f8a,_0x2df823)=>{const _0x200805=_0x358b06;if(_0x2df823%_0x4b40ab==0x0)_0x399873=[];_0x399873['push'](Markup[_0x200805(0x254)][_0x200805(0x2ac)](_0x200805(0x2a2)+_0x1c7f8a[_0x200805(0x29b)],_0x200805(0x2df)+_0x1c7f8a[_0x200805(0x29b)])),_0x2df823%_0x4b40ab==0x0&&(_0x288865[_0x13ddfb]=_0x399873,_0x13ddfb++);});const _0x42fb55=Markup[_0x358b06(0x282)](_0x288865);_0x3ca436[_0x358b06(0x23f)](_0x358b06(0x27a),_0x42fb55);}else{const _0x214e34=_0x492d65[0x0]['botID'];if(pid[_0x214e34])pid[_0x214e34]['send']({'function':_0x358b06(0x361),'args':null});}}}),tgBot[_0x490ce0(0x238)](/portfolio_(.+)/,async _0x4c67e1=>{const _0x36a395=_0x490ce0,_0x2906b0=_0x4c67e1[_0x36a395(0x387)][0x1];_0x4c67e1[_0x36a395(0x3a1)]();if(pid[_0x2906b0])pid[_0x2906b0][_0x36a395(0x304)]({'function':_0x36a395(0x361),'args':null});}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x293),async _0x2486f7=>{const _0x1606b1=_0x490ce0;await getMessages();if(!updateAvailable)await sendTelegram(_0x2486f7[_0x1606b1(0x2d6)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x2486f7['chat']['id'],_0x1606b1(0x1ca));else{const _0x1e91a8=Markup[_0x1606b1(0x282)]([Markup[_0x1606b1(0x254)][_0x1606b1(0x2ac)](_0x1606b1(0x20d),'update_yes'),Markup['button'][_0x1606b1(0x2ac)]('No',_0x1606b1(0x208))]);_0x2486f7[_0x1606b1(0x23f)](_0x1606b1(0x2af),_0x1e91a8);}}}),tgBot[_0x490ce0(0x238)](/update_(.+)/,async _0x2859f3=>{const _0x16a812=_0x490ce0,_0x4d8349=_0x2859f3[_0x16a812(0x387)][0x1];_0x2859f3[_0x16a812(0x3a1)](),_0x4d8349==_0x16a812(0x394)&&(await sendTelegram(_0x2859f3[_0x16a812(0x2d6)]['id'],_0x16a812(0x3b0)),updateBB(_0x16a812(0x293))),_0x4d8349=='no'&&await sendTelegram(_0x2859f3[_0x16a812(0x2d6)]['id'],_0x16a812(0x248));}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x24b),async _0xa16936=>{const _0x10ab7e=_0x490ce0;if(!validInstallation)await sendTelegram(_0xa16936[_0x10ab7e(0x2d6)]['id'],_0x10ab7e(0x226));else{const _0x1b116b=Markup[_0x10ab7e(0x282)]([Markup[_0x10ab7e(0x254)][_0x10ab7e(0x2ac)](_0x10ab7e(0x20d),_0x10ab7e(0x2e2)),Markup[_0x10ab7e(0x254)][_0x10ab7e(0x2ac)]('No',_0x10ab7e(0x2ca))]);_0xa16936[_0x10ab7e(0x23f)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x1b116b);}}),tgBot[_0x490ce0(0x238)](/reinstall_(.+)/,async _0x2505be=>{const _0x51bd0e=_0x490ce0,_0x20db05=_0x2505be[_0x51bd0e(0x387)][0x1];_0x2505be[_0x51bd0e(0x3a1)](),_0x20db05==_0x51bd0e(0x394)&&(await sendTelegram(_0x2505be[_0x51bd0e(0x2d6)]['id'],_0x51bd0e(0x236)),updateBB(_0x51bd0e(0x24b))),_0x20db05=='no'&&await sendTelegram(_0x2505be[_0x51bd0e(0x2d6)]['id'],_0x51bd0e(0x2a4));}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x377),async _0x4bcd17=>{const _0x37a48b=_0x490ce0,_0x456a35=getBotsWithMode();if(_0x456a35[_0x37a48b(0x3b6)]==0x0)await sendTelegram(_0x4bcd17[_0x37a48b(0x2d6)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x475dad=[],_0x185ba2=[];const _0x15c901=0x2;let _0x36c613=0x0;_0x456a35[_0x37a48b(0x34b)]((_0x29d8fc,_0x548473)=>{const _0xa7e8b6=_0x37a48b;if(_0x548473%_0x15c901==0x0)_0x185ba2=[];_0x185ba2[_0xa7e8b6(0x2ed)](Markup['button'][_0xa7e8b6(0x2ac)](_0xa7e8b6(0x2a2)+_0x29d8fc[_0xa7e8b6(0x29b)]+'\x20('+_0x29d8fc[_0xa7e8b6(0x2ba)]+')',_0xa7e8b6(0x363)+_0x29d8fc[_0xa7e8b6(0x29b)])),_0x548473%_0x15c901==0x0&&(_0x475dad[_0x36c613]=_0x185ba2,_0x36c613++);});const _0x5d7b13=Markup[_0x37a48b(0x282)](_0x475dad);_0x4bcd17[_0x37a48b(0x23f)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x5d7b13);}}),tgBot[_0x490ce0(0x238)](/toggle_(.+)/,async _0x37edbe=>{const _0x27514d=_0x490ce0,_0x56e23a=_0x37edbe[_0x27514d(0x387)][0x1];_0x37edbe[_0x27514d(0x3a1)]();const _0x29f1f6=getBotsWithMode(),_0x48e403=_0x29f1f6[_0x27514d(0x261)](_0x22554=>_0x22554['botID']==_0x56e23a),_0x20288e=_0x48e403[_0x27514d(0x2ba)]==_0x27514d(0x345)?_0x27514d(0x20e):_0x27514d(0x345);await sendTelegram(_0x37edbe[_0x27514d(0x2d6)]['id'],_0x27514d(0x38f)+_0x56e23a+_0x27514d(0x33a)+_0x20288e+'\x20mode'),toggleBotMode(_0x56e23a);}),tgBot['command'](_0x490ce0(0x3bf),async _0x3085d4=>{const _0x59e03e=_0x490ce0;let _0x2150fe='';config['forEach'](_0x9489d9=>{const _0x3e7b53=_0x4877;_0x2150fe+=_0x3e7b53(0x2a2)+_0x9489d9[_0x3e7b53(0x29b)]+':\x20'+_0x9489d9[_0x3e7b53(0x398)]+'\x0a';}),await sendTelegram(_0x3085d4[_0x59e03e(0x2d6)]['id'],_0x2150fe,{'parse_mode':'HTML'});}),tgBot[_0x490ce0(0x347)](_0x490ce0(0x3a3),async _0x31d39d=>{const _0x594948=_0x490ce0;await sendTelegram(_0x31d39d[_0x594948(0x2d6)]['id'],_0x281d99);}),process[_0x490ce0(0x202)]('SIGINT',()=>tgBot[_0x490ce0(0x237)](_0x490ce0(0x209))),process[_0x490ce0(0x202)](_0x490ce0(0x3c2),()=>tgBot[_0x490ce0(0x237)]('SIGTERM')),tgBot[_0x490ce0(0x1e4)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x5570d6,_0x5304d1,_0x50fa0d){const _0x2d4db6=_0x50ef29;_0x50fa0d={..._0x50fa0d,'disable_web_page_preview':!![]};try{await tgBot[_0x2d4db6(0x31a)]['sendMessage'](_0x5570d6,_0x5304d1,_0x50fa0d);}catch(_0x56f91b){console[_0x2d4db6(0x25b)](_0x2d4db6(0x2b4),_0x56f91b);}}async function sendTelegramBot(_0x2fdf03,_0x2d546f){const _0x2d185c=_0x50ef29;if(settings[_0x2d185c(0x3c0)]){if(settings[_0x2d185c(0x23e)]==_0x2d185c(0x297)||(_0x2d546f['type']==_0x2d185c(0x338)||_0x2d546f[_0x2d185c(0x371)]==_0x2d185c(0x3d1)||_0x2d546f[_0x2d185c(0x371)]==_0x2d185c(0x276))&&settings['telegramEvents']==_0x2d185c(0x358)||_0x2d546f[_0x2d185c(0x371)]=='order'&&settings[_0x2d185c(0x23e)]==_0x2d185c(0x245)){if(tgBot&&settings[_0x2d185c(0x365)]){if(_0x2d546f[_0x2d185c(0x244)])await sendTelegram(settings[_0x2d185c(0x365)],_0x2d546f['botname']+_0x2d185c(0x204)+_0x2d546f['event']);else await sendTelegram(settings['telegramChatId'],_0x2d185c(0x2a2)+_0x2fdf03+_0x2d185c(0x204)+_0x2d546f[_0x2d185c(0x1cc)]);}}}}async function sendTelegramMsg(_0xbdbc3b,_0xf5cee4='HTML'){const _0x2f4416=_0x50ef29;return settings[_0x2f4416(0x3c0)]&&tgBot&&settings[_0x2f4416(0x365)]?(await sendTelegram(settings[_0x2f4416(0x365)],_0xbdbc3b,{'parse_mode':_0xf5cee4}),!![]):![];}function getDeviceWithIp(_0x3fffda){const _0x330f56=_0x50ef29;return devices[_0x330f56(0x261)](_0x15f13f=>_0x15f13f['ip']===_0x3fffda);}async function temporaryAccess2FA(_0x5b1a22,_0x5dfe15){const _0x4abb44=_0x50ef29;let _0x4a2a27=new Date(),_0x1cb6b5=![];if(lastIpApproval){if(_0x4a2a27-lastIpApproval<0x1388)_0x1cb6b5=!![];}lastIpApproval=new Date();if(_0x1cb6b5)return;if(tgBot&&settings['telegramChatId']){const _0x4e76e5=uuidRandom();tmpStorage[_0x4e76e5]={'uuid':_0x5b1a22,'externalip':_0x5dfe15};const _0x4a39a4=Markup[_0x4abb44(0x282)]([Markup[_0x4abb44(0x254)][_0x4abb44(0x2ac)](_0x4abb44(0x3c7),_0x4abb44(0x39e)+_0x4e76e5),Markup[_0x4abb44(0x254)]['callback'](_0x4abb44(0x1e3),_0x4abb44(0x2d8)+_0x4e76e5),Markup[_0x4abb44(0x254)]['callback'](_0x4abb44(0x3ad),_0x4abb44(0x20c)+_0x4e76e5),Markup[_0x4abb44(0x254)]['callback'](_0x4abb44(0x1da),_0x4abb44(0x271)+_0x4e76e5)]);await sendTelegram(settings['telegramChatId'],_0x4abb44(0x264)+normalizeIP(_0x5dfe15)['show']+'\x20?',_0x4a39a4),tgBot[_0x4abb44(0x238)](/tempaccess_(.+)_(.+)/,async _0x5a1af2=>{const _0x40017b=_0x4abb44,_0x27fa00=_0x5a1af2[_0x40017b(0x387)][0x1],_0x469dcc=_0x5a1af2[_0x40017b(0x387)][0x2],{uuid:_0x17ac93,externalip:_0x3cb1a7}=tmpStorage[_0x469dcc];delete tmpStorage[_0x469dcc],_0x5a1af2['editMessageReplyMarkup'](),devices[_0x17ac93][_0x40017b(0x362)]={'clientip':_0x3cb1a7,'timestamp':new Date()[_0x40017b(0x2be)](),'expiry':_0x27fa00},_0x27fa00!=_0x40017b(0x1da)?(await sendTelegram(_0x5a1af2[_0x40017b(0x2d6)]['id'],'Access\x20enabled\x20for\x20'+_0x27fa00+'\x20minutes',{'parse_mode':_0x40017b(0x36c)}),io['to'](_0x17ac93)['emit'](_0x40017b(0x2ab),{'access':{'allow':![],'reason':_0x40017b(0x34a),'token':null}})):(await sendTelegram(_0x5a1af2[_0x40017b(0x2d6)]['id'],_0x40017b(0x378)),io['to'](_0x17ac93)[_0x40017b(0x234)](_0x40017b(0x2ab),{'access':{'allow':![],'reason':_0x40017b(0x31b),'token':null}}));});}}async function loginAccess2FA(_0x20b828,_0x155861){const _0x3c1f40=_0x50ef29;if(tgBot&&settings[_0x3c1f40(0x365)]){const _0x4efdfc=uuidRandom();tmpStorage[_0x4efdfc]={'uuid':_0x20b828,'externalip':_0x155861};const _0x388408=Markup['inlineKeyboard']([Markup['button'][_0x3c1f40(0x2ac)]('accept',_0x3c1f40(0x2bc)+loginExpiry+'_'+_0x4efdfc),Markup[_0x3c1f40(0x254)][_0x3c1f40(0x2ac)]('reject',_0x3c1f40(0x219)+_0x4efdfc)]);await sendTelegram(settings[_0x3c1f40(0x365)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x155861)[_0x3c1f40(0x2c7)]+'\x20?',_0x388408),tgBot[_0x3c1f40(0x238)](/login2fa_(.+)_(.+)/,async _0x51cb7e=>{const _0x4c84ef=_0x3c1f40,_0x27743c=_0x51cb7e[_0x4c84ef(0x387)][0x1],_0x38c186=_0x51cb7e['match'][0x2],{uuid:_0x41c67b,externalip:_0x4a4f6f}=tmpStorage[_0x38c186];delete tmpStorage[_0x38c186],_0x51cb7e['editMessageReplyMarkup'](),devices[_0x41c67b]['telegram2FaApproval']={'clientip':_0x4a4f6f,'timestamp':new Date()[_0x4c84ef(0x2be)](),'expiry':_0x27743c},_0x27743c!='reject'?(await sendTelegram(_0x51cb7e[_0x4c84ef(0x2d6)]['id'],'Login\x20accepted',{'parse_mode':_0x4c84ef(0x36c)}),io['to'](_0x41c67b)[_0x4c84ef(0x234)](_0x4c84ef(0x2ab),{'access':{'allow':![],'reason':_0x4c84ef(0x34a),'token':null}})):(await sendTelegram(_0x51cb7e[_0x4c84ef(0x2d6)]['id'],'Login\x20rejected'),io['to'](_0x41c67b)[_0x4c84ef(0x234)](_0x4c84ef(0x2ab),{'access':{'allow':![],'reason':_0x4c84ef(0x30d),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1e84b0=_0x50ef29;return dbConfig['get']('bots')[_0x1e84b0(0x1fb)](_0x1e84b0(0x29b))['filter']({'status':_0x1e84b0(0x1e7)})[_0x1e84b0(0x3d3)]()||[];}function getDisabledBots(){const _0x134e9a=_0x50ef29;return dbConfig[_0x134e9a(0x284)](_0x134e9a(0x313))['sortBy'](_0x134e9a(0x29b))[_0x134e9a(0x296)]({'status':_0x134e9a(0x2fc)})[_0x134e9a(0x3d3)]()||[];}function getBotAttributes(_0x4554cb){const _0x464ccd=_0x50ef29;let _0x34d550={};const _0x284cbe=configpath+_0x464ccd(0x31f)+_0x4554cb+_0x464ccd(0x375),_0x907178=fs[_0x464ccd(0x1d7)](_0x284cbe);if(_0x907178){const _0x427846=fs[_0x464ccd(0x30b)](_0x284cbe);try{const _0x3001bd=JSON[_0x464ccd(0x280)](_0x427846),_0x193172=_0x3001bd?_0x3001bd['bot'][0x0][_0x464ccd(0x269)]:![];_0x34d550[_0x464ccd(0x2ba)]=_0x193172?_0x464ccd(0x345):_0x464ccd(0x20e),_0x34d550[_0x464ccd(0x398)]=_0x3001bd?_0x3001bd['bot'][0x0][_0x464ccd(0x398)]:_0x464ccd(0x2a2)+_0x4554cb;}catch(_0x2dfcae){_0x34d550[_0x464ccd(0x2ba)]=_0x464ccd(0x20e),_0x34d550['botname']='Bot\x20'+_0x4554cb;}}else _0x34d550[_0x464ccd(0x2ba)]=_0x464ccd(0x20e),_0x34d550[_0x464ccd(0x398)]=_0x464ccd(0x2a2)+_0x4554cb;return _0x34d550;}function getBotsWithMode(){const _0x5a37fb=_0x50ef29,_0x3b5676=dbConfig[_0x5a37fb(0x284)](_0x5a37fb(0x313))[_0x5a37fb(0x1fb)](_0x5a37fb(0x29b))['value']()||[];return _0x3b5676[_0x5a37fb(0x34b)](_0x531a94=>{const _0xf44fc1=_0x5a37fb;let _0x162db4=getBotAttributes(_0x531a94[_0xf44fc1(0x29b)]);_0x531a94[_0xf44fc1(0x2ba)]=_0x162db4[_0xf44fc1(0x2ba)];}),_0x3b5676;}function getBotExchanges(){const _0x1ef9e2=_0x50ef29;let _0xb83691=[];const _0x4d0a84=dbConfig['get'](_0x1ef9e2(0x313))['sortBy']('botID')[_0x1ef9e2(0x3d3)]()||[];_0x4d0a84[_0x1ef9e2(0x34b)](_0x18d54c=>{const _0x60e0ab=_0x1ef9e2;if(_0x18d54c[_0x60e0ab(0x2ab)]==_0x60e0ab(0x1e7)){const _0x2fd618=configpath+_0x60e0ab(0x31f)+_0x18d54c[_0x60e0ab(0x29b)]+'-config.json',_0x5de7cd=fs[_0x60e0ab(0x1d7)](_0x2fd618);let _0x16d65a;if(_0x5de7cd){const _0x59f1af=fs[_0x60e0ab(0x30b)](_0x2fd618);try{const _0x10742c=JSON[_0x60e0ab(0x280)](_0x59f1af);_0x16d65a=_0x10742c?_0x10742c[_0x60e0ab(0x1e9)][0x0][_0x60e0ab(0x2ff)]:null;}catch(_0x2aa737){}}if(_0x16d65a)_0xb83691[_0x60e0ab(0x2ed)](_0x16d65a);}});const _0x50ae61=[...new Set(_0xb83691)][_0x1ef9e2(0x335)]();return _0x50ae61;}async function initUser(){const _0x52f02e=_0x50ef29;if(!settings[_0x52f02e(0x246)]){const _0x580b9f=uuidRandom();mixpanel[_0x52f02e(0x2fe)](_0x580b9f),updateSetting(_0x52f02e(0x246),_0x580b9f);}}async function initSecure(){const _0x31ec80=_0x50ef29;let _0x226575=getSecure();if(!_0x226575[_0x31ec80(0x27c)](_0x31ec80(0x3c4))){let _0x194f31=await generateKeys();_0x226575['publicKey']=_0x194f31[_0x31ec80(0x318)],_0x226575[_0x31ec80(0x2f7)]=_0x194f31[_0x31ec80(0x2f7)],_0x226575['secret']=crypto[_0x31ec80(0x275)](0x20)[_0x31ec80(0x211)](_0x31ec80(0x2da));;storeSecure(_0x226575);}}function getSettings(){const _0x25894a=_0x50ef29;return dbSettings[_0x25894a(0x284)](_0x25894a(0x232))[_0x25894a(0x3d3)]()||{};}function getSecure(){const _0x6d603f=_0x50ef29;return dbSecure[_0x6d603f(0x284)](_0x6d603f(0x249))[_0x6d603f(0x3d3)]()||{};}function getBlacklist(){const _0x4d67d5=_0x50ef29;return dbSecure[_0x4d67d5(0x284)](_0x4d67d5(0x1ce))[_0x4d67d5(0x3d3)]()||[];}function broadcastToBots(_0x3e7b6d,_0x38aba0){const _0x4f31be=_0x50ef29;config[_0x4f31be(0x34b)](_0x198d2d=>{const _0x43a867=_0x4f31be;if(_0x198d2d[_0x43a867(0x2ab)]==_0x43a867(0x1e7)&&_0x198d2d[_0x43a867(0x1eb)]==_0x43a867(0x3a7)||_0x198d2d[_0x43a867(0x2ab)]=='new'&&_0x198d2d[_0x43a867(0x1eb)]==_0x43a867(0x3a7)){if(pid[_0x198d2d[_0x43a867(0x29b)]])pid[_0x198d2d['botID']][_0x43a867(0x304)]({[_0x3e7b6d]:_0x38aba0});}});}async function storeSettings(_0x2d7c03,_0x349354=![]){const _0x303a89=_0x50ef29;_0x2d7c03={...settings,..._0x2d7c03};if(_0x349354&&_0x2d7c03['bbPassword']!=_0x303a89(0x37c)&&_0x2d7c03[_0x303a89(0x1e0)]!=_0x303a89(0x222)&&_0x2d7c03[_0x303a89(0x1e0)]!=''){const _0x3fbeb9=decryptRSA(secure[_0x303a89(0x2f7)],_0x2d7c03[_0x303a89(0x1e0)])[_0x303a89(0x223)](_0x303a89(0x2c0))[0x0],_0x3a082f=bcrypt['hashSync'](_0x3fbeb9,saltRounds);_0x2d7c03={..._0x2d7c03,'bbPassword':_0x3a082f};}if(_0x349354&&_0x2d7c03['telegramToken']!='************'&&_0x2d7c03[_0x303a89(0x28c)]!=_0x303a89(0x222)&&_0x2d7c03[_0x303a89(0x28c)]!=''){const _0x2b8262=decryptRSA(secure[_0x303a89(0x2f7)],_0x2d7c03['telegramToken'])[_0x303a89(0x223)](_0x303a89(0x2c0))[0x0];_0x2d7c03={..._0x2d7c03,'telegramToken':_0x2b8262};}if(_0x349354&&_0x2d7c03[_0x303a89(0x30f)]!=_0x303a89(0x37c)&&_0x2d7c03['marketcapApi']!='***'&&_0x2d7c03[_0x303a89(0x30f)]!=''){const _0x59e048=decryptRSA(secure[_0x303a89(0x2f7)],_0x2d7c03[_0x303a89(0x30f)])[_0x303a89(0x223)]('|@|')[0x0];_0x2d7c03={..._0x2d7c03,'marketcapApi':_0x59e048};}const _0x4e5f72=_0x2d7c03[_0x303a89(0x28c)]!='************'&&_0x2d7c03[_0x303a89(0x28c)]!=settings['telegramToken']||_0x2d7c03['telegramUsername']!=settings[_0x303a89(0x3a0)],_0x583180=_0x2d7c03[_0x303a89(0x28c)]==''||_0x2d7c03[_0x303a89(0x3a0)]=='',_0x46cea2=_0x2d7c03[_0x303a89(0x30f)]&&_0x2d7c03[_0x303a89(0x30f)]!='************'&&_0x2d7c03[_0x303a89(0x30f)]!=settings[_0x303a89(0x28c)];_0x4e5f72&&(_0x2d7c03[_0x303a89(0x365)]=null,_0x2d7c03['telegramEvents']=_0x303a89(0x297));for(const [_0x1a5109,_0x2e29fd]of Object[_0x303a89(0x2f5)](_0x2d7c03)){if(_0x1a5109==_0x303a89(0x28c)&&_0x2e29fd==_0x303a89(0x37c)){_0x2d7c03[_0x303a89(0x28c)]=settings[_0x303a89(0x28c)];continue;};if(_0x1a5109==_0x303a89(0x1e0)&&_0x2e29fd==_0x303a89(0x37c)){_0x2d7c03[_0x303a89(0x1e0)]=settings[_0x303a89(0x1e0)];continue;};if(_0x1a5109==_0x303a89(0x30f)&&_0x2e29fd==_0x303a89(0x37c)){_0x2d7c03[_0x303a89(0x30f)]=settings[_0x303a89(0x30f)];continue;};dbSettings[_0x303a89(0x3d2)](_0x303a89(0x3cc)+_0x1a5109,_0x2e29fd)[_0x303a89(0x221)]();}settings=_0x2d7c03,io['to'](_0x303a89(0x348))[_0x303a89(0x234)](_0x303a89(0x232),cleanSettings()),broadcastToBots(_0x303a89(0x21e),settings[_0x303a89(0x21e)]),broadcastToBots(_0x303a89(0x26b),settings[_0x303a89(0x26b)]),broadcastToBots(_0x303a89(0x30f),settings[_0x303a89(0x30f)]);if(_0x4e5f72&&!_0x583180)initTelegram();if(_0x4e5f72&&_0x583180)disableTelegram();getAllClients()[_0x303a89(0x34b)](_0x3239da=>{const _0x4f6f24=_0x303a89;getSocket(_0x3239da['id'])['emit'](_0x4f6f24(0x2ab),{'access':{'allow':![],'reason':_0x4f6f24(0x34a),'token':null}});}),_0x46cea2&&(await sleep(0xbb8),testMarketcapApi(_0x2d7c03[_0x303a89(0x30f)]));}async function testMarketcapApi(_0x185369){const _0x405965=_0x50ef29,_0x43283c=[_0x405965(0x1ed),_0x405965(0x299)];try{await axios['get'](_0x405965(0x2c6),{'headers':{'X-CMC_PRO_API_KEY':_0x185369},'params':{'symbol':_0x43283c[_0x405965(0x211)]()}});}catch(_0x31605d){_0x31605d[_0x405965(0x211)]()['includes'](_0x405965(0x3c5))?(io['to'](_0x405965(0x348))[_0x405965(0x234)](_0x405965(0x2c9),_0x405965(0x260)),logger['full'](_0x405965(0x260))):(io['to'](_0x405965(0x348))['emit']('notification',_0x405965(0x2d2)),logger['full'](_0x405965(0x2d2)),logger['debug'](_0x405965(0x1d5),_0x31605d['toString']()+_0x405965(0x21d)+_0x31605d[_0x405965(0x36a)]));return;}logger[_0x405965(0x350)](_0x405965(0x3ca));}function updateSetting(_0x14d117,_0x4b2d72){const _0x2cf6e0=_0x50ef29;dbSettings[_0x2cf6e0(0x3d2)](_0x2cf6e0(0x3cc)+_0x14d117,_0x4b2d72)[_0x2cf6e0(0x221)](),settings=getSettings(),io['to'](_0x2cf6e0(0x348))[_0x2cf6e0(0x234)](_0x2cf6e0(0x232),cleanSettings());}function storeSecure(_0x2cf8b5){const _0x6de9b0=_0x50ef29;dbSecure['get']('secure')['push'](_0x2cf8b5)[_0x6de9b0(0x221)](),secure=_0x2cf8b5;}function addBlacklist(_0x3a9e69){const _0x43dd5d=_0x50ef29;cleanBlacklist();let _0x360c8b;devices[_0x3a9e69][_0x43dd5d(0x362)]?_0x360c8b=Math['max'](devices[_0x3a9e69]['telegramIpApproval'][_0x43dd5d(0x21b)],loginExpiry):_0x360c8b=loginExpiry,dbSecure[_0x43dd5d(0x284)]('blacklist')[_0x43dd5d(0x2ed)]({'expiry':new Date()[_0x43dd5d(0x2be)]()+_0x360c8b*0x3c*0x3e8,'token':devices[_0x3a9e69]['access']['token']})[_0x43dd5d(0x221)](),blacklist=dbSecure['get']('blacklist')[_0x43dd5d(0x3d3)]();}function cleanBlacklist(){const _0x2e1d52=_0x50ef29;let _0xf19c27=dbSecure[_0x2e1d52(0x284)]('blacklist')[_0x2e1d52(0x23b)]()[_0x2e1d52(0x3d3)](),_0x5b101f=new Date()[_0x2e1d52(0x2be)]();_0xf19c27['forEach'](_0xef3b65=>{const _0x53258e=_0x2e1d52;_0xef3b65[_0x53258e(0x21b)]<_0x5b101f&&dbSecure[_0x53258e(0x284)](_0x53258e(0x1ce))[_0x53258e(0x27d)]({'expiry':_0xef3b65[_0x53258e(0x21b)]})[_0x53258e(0x221)]();});}function initStates(){const _0x5362f0=_0x50ef29;let _0x15d3b=getConfiguration();_0x15d3b[_0x5362f0(0x34b)](_0x24ce98=>{const _0x2f0369=_0x5362f0;_0x24ce98[_0x2f0369(0x1eb)]='stopped';}),storeConfiguration(_0x15d3b);}async function generateKeys(){const _0x417227=_0x50ef29,_0x53941a=forge[_0x417227(0x291)][_0x417227(0x2b3)][_0x417227(0x337)]({'bits':0x1000,'e':0x10001}),_0x267eed=forge[_0x417227(0x291)]['privateKeyToPem'](_0x53941a[_0x417227(0x2f7)]),_0x8c8926=forge[_0x417227(0x291)][_0x417227(0x35b)](_0x53941a[_0x417227(0x318)]);return{'privateKey':_0x267eed,'publicKey':_0x8c8926};}async function oneTimeMigration(){const _0x374f62=_0x50ef29;let _0x484fd2=getSettings(),_0x37c93e=![];!_0x484fd2[_0x374f62(0x27c)](_0x374f62(0x212))&&(_0x484fd2['lastmsgtelegram']=0x0,_0x37c93e=!![]);!_0x484fd2[_0x374f62(0x27c)](_0x374f62(0x311))&&(_0x484fd2['lastmsgemitted']=0x0,_0x37c93e=!![]);!_0x484fd2[_0x374f62(0x27c)](_0x374f62(0x39d))&&(_0x484fd2[_0x374f62(0x39d)]=_0x374f62(0x327),_0x37c93e=!![]);!_0x484fd2[_0x374f62(0x27c)](_0x374f62(0x26b))&&(_0x484fd2['onepagemode']=![],_0x37c93e=!![]);!_0x484fd2[_0x374f62(0x27c)](_0x374f62(0x30f))&&(_0x484fd2[_0x374f62(0x30f)]='',_0x37c93e=!![]);if(_0x37c93e)storeSettings(_0x484fd2);try{fs[_0x374f62(0x215)](configbackuppath,{'withFileTypes':!![]})[_0x374f62(0x34b)](_0x2c0eed=>{const _0x583e42=_0x374f62;if(!_0x2c0eed[_0x583e42(0x281)]()){if(!_0x2c0eed[_0x583e42(0x33e)][_0x583e42(0x334)](_0x583e42(0x2c1)))fs[_0x583e42(0x3bc)](configbackuppath+_0x2c0eed[_0x583e42(0x33e)]);}else fs[_0x583e42(0x300)](configbackuppath+_0x2c0eed[_0x583e42(0x33e)],{'recursive':!![]});});}catch(_0x17940f){logger[_0x374f62(0x350)](_0x374f62(0x25e),_0x17940f);}}function storeConfiguration(_0xba2480){const _0x112ab6=_0x50ef29;dbConfig[_0x112ab6(0x284)](_0x112ab6(0x313))[_0x112ab6(0x27d)]()[_0x112ab6(0x221)](),dbConfig[_0x112ab6(0x284)](_0x112ab6(0x313))[_0x112ab6(0x2ed)](..._0xba2480)[_0x112ab6(0x221)](),config=_0xba2480;}async function resetPassword(){const _0x1b8fa1=_0x50ef29;if(tgBot&&settings[_0x1b8fa1(0x365)]){const _0x38d7b6=Markup[_0x1b8fa1(0x282)]([Markup[_0x1b8fa1(0x254)][_0x1b8fa1(0x2ac)](_0x1b8fa1(0x394),_0x1b8fa1(0x2de)),Markup[_0x1b8fa1(0x254)][_0x1b8fa1(0x2ac)]('no',_0x1b8fa1(0x20f))]);await sendTelegram(settings[_0x1b8fa1(0x365)],_0x1b8fa1(0x288),_0x38d7b6),tgBot['action'](/resetpw_(.+)/,async _0x51623b=>{const _0xc9611=_0x1b8fa1,_0x668629=_0x51623b['match'][0x1];_0x51623b[_0xc9611(0x3a1)]();if(_0x668629!='no'){const _0x44a70b=0xf,_0x1d39a3='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x164245=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x44a70b)))['map'](_0x1a9f76=>_0x1d39a3[_0x1a9f76%_0x1d39a3[_0xc9611(0x3b6)]])['join'](''),_0xe1b578=bcrypt[_0xc9611(0x217)](_0x164245,saltRounds);storeSettings({'bbPassword':_0xe1b578}),await sendTelegram(_0x51623b['chat']['id'],_0xc9611(0x38a)+_0x164245,{'parse_mode':_0xc9611(0x36c)});}else await sendTelegram(_0x51623b[_0xc9611(0x2d6)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x4c6bcf,_0x5d999a){const _0x583559=_0x50ef29;io['to'](_0x583559(0x348))[_0x583559(0x234)](_0x583559(0x2c9),_0x583559(0x28a),_0x583559(0x276));if(tgBot&&settings[_0x583559(0x365)]){const _0x26d54f=uuidRandom();tmpStorage[_0x26d54f]={'path':_0x4c6bcf,'filename':_0x5d999a};const _0x2cfb8b=Markup[_0x583559(0x282)]([Markup[_0x583559(0x254)]['callback'](_0x583559(0x394),_0x583559(0x1f4)+_0x26d54f),Markup[_0x583559(0x254)][_0x583559(0x2ac)]('no',_0x583559(0x28e)+_0x26d54f)]);await sendTelegram(settings[_0x583559(0x365)],_0x583559(0x2f8),_0x2cfb8b),tgBot['action'](/restore_(.+)_(.+)/,async _0x2c82d5=>{const _0x1b21dd=_0x583559,_0x551ec1=_0x2c82d5[_0x1b21dd(0x387)][0x1],_0x853d7a=_0x2c82d5[_0x1b21dd(0x387)][0x2],{path:_0x4f68aa,filename:_0x4f2b14}=tmpStorage[_0x853d7a];delete tmpStorage[_0x853d7a],_0x2c82d5['editMessageReplyMarkup'](),_0x551ec1==_0x1b21dd(0x394)?(logger[_0x1b21dd(0x350)](_0x1b21dd(0x322)),await sendTelegram(_0x2c82d5['chat']['id'],_0x1b21dd(0x1d9),{'parse_mode':_0x1b21dd(0x36c)}),unzipFile(_0x4f68aa,_0x4f2b14)):(logger[_0x1b21dd(0x350)](_0x1b21dd(0x27e)),await sendTelegram(_0x2c82d5[_0x1b21dd(0x2d6)]['id'],_0x1b21dd(0x27e)));});}}function getServerTime(){const _0x28c325=_0x50ef29,_0x3e2be1=new Date();return _0x3e2be1[_0x28c325(0x3d4)]()+'/'+(_0x3e2be1[_0x28c325(0x306)]()+0x1)[_0x28c325(0x211)]()['padStart'](0x2,'0')+'/'+_0x3e2be1[_0x28c325(0x315)]()[_0x28c325(0x211)]()['padStart'](0x2,'0')+'\x20'+_0x3e2be1['getHours']()[_0x28c325(0x211)]()[_0x28c325(0x3b9)](0x2,'0')+':'+_0x3e2be1[_0x28c325(0x1f0)]()[_0x28c325(0x211)]()[_0x28c325(0x3b9)](0x2,'0')+':'+_0x3e2be1[_0x28c325(0x309)]()[_0x28c325(0x211)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x2a9a51=_0x50ef29,_0x429491=shiftedTime();return _0x429491[_0x2a9a51(0x3d4)]()+'/'+(_0x429491[_0x2a9a51(0x306)]()+0x1)[_0x2a9a51(0x211)]()[_0x2a9a51(0x3b9)](0x2,'0')+'/'+_0x429491[_0x2a9a51(0x315)]()[_0x2a9a51(0x211)]()[_0x2a9a51(0x3b9)](0x2,'0')+'\x20'+_0x429491['getHours']()[_0x2a9a51(0x211)]()[_0x2a9a51(0x3b9)](0x2,'0')+':'+_0x429491['getMinutes']()[_0x2a9a51(0x211)]()[_0x2a9a51(0x3b9)](0x2,'0')+':'+_0x429491[_0x2a9a51(0x309)]()[_0x2a9a51(0x211)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0xc7a497=_0x50ef29,_0xb0d186=shiftedTime();return _0xb0d186[_0xc7a497(0x3d4)]()+(_0xb0d186[_0xc7a497(0x306)]()+0x1)[_0xc7a497(0x211)]()[_0xc7a497(0x3b9)](0x2,'0')+_0xb0d186[_0xc7a497(0x315)]()['toString']()['padStart'](0x2,'0')+'-'+_0xb0d186[_0xc7a497(0x370)]()[_0xc7a497(0x211)]()[_0xc7a497(0x3b9)](0x2,'0')+_0xb0d186[_0xc7a497(0x1f0)]()[_0xc7a497(0x211)]()[_0xc7a497(0x3b9)](0x2,'0')+_0xb0d186[_0xc7a497(0x309)]()[_0xc7a497(0x211)]()[_0xc7a497(0x3b9)](0x2,'0');}function shiftedTime(){const _0x2e5d10=_0x50ef29,_0x1dd420=new Date();let _0x4c96a9=_0x1dd420;if(settings[_0x2e5d10(0x21e)]&&settings[_0x2e5d10(0x21e)]!==0x0)_0x4c96a9=fns[_0x2e5d10(0x2a6)](_0x1dd420,{'hours':settings[_0x2e5d10(0x21e)]});return _0x4c96a9;}async function startScheduler(){const _0x3fab1b=_0x50ef29,_0x175e48=new Date()['getUTCHours'](),_0x3dbc6a=shiftedTime()[_0x3fab1b(0x370)]();_0x3dbc6a==0x4&&backupConfigFiles(),_0x3dbc6a==0x0&&rotateLogFiles(),_0x175e48%0x6==0x0&&triggerAnalytics(),_0x175e48%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x565ec1){const _0x5c2446=_0x50ef29;logger[_0x5c2446(0x350)]('Restore\x20backup\x20file\x20'+_0x565ec1);const _0x46c117=getBotsWithMode();_0x46c117[_0x5c2446(0x3b6)]>0x0?confirmRestore(configbackuppath,_0x565ec1):unzipFile(configbackuppath,_0x565ec1);}async function getBackupFiles(_0x19e61f=null){const _0x16b06c=_0x50ef29;let _0x456389=[],_0x13d48a=fs[_0x16b06c(0x215)](configbackuppath,{'withFileTypes':!![]});_0x13d48a[_0x16b06c(0x335)]((_0x94027c,_0x43298f)=>_0x94027c[_0x16b06c(0x33e)]<_0x43298f[_0x16b06c(0x33e)]?0x1:_0x43298f['name']<_0x94027c[_0x16b06c(0x33e)]?-0x1:0x0),_0x13d48a['forEach'](_0x3de12b=>{const _0x563603=_0x16b06c;if(!_0x3de12b[_0x563603(0x281)]()&&_0x3de12b[_0x563603(0x33e)][_0x563603(0x334)](_0x563603(0x2c1))&&_0x3de12b[_0x563603(0x33e)][_0x563603(0x1ef)](_0x563603(0x3a9))){const _0x211f2a=formatDate(fs[_0x563603(0x30a)](configbackuppath+_0x3de12b[_0x563603(0x33e)])[_0x563603(0x22f)]);_0x456389['push']({'name':_0x3de12b[_0x563603(0x33e)],'mtime':_0x211f2a});}});if(_0x19e61f)io['to'](_0x19e61f)[_0x16b06c(0x234)](_0x16b06c(0x1f2),_0x456389);else return _0x456389;}async function backupConfigFiles(){const _0x48ac51=_0x50ef29;await zipFiles(_0x48ac51(0x357));const _0x35ddda=getCleanTimeStamp();fs[_0x48ac51(0x2e9)](zippath+_0x48ac51(0x323),configbackuppath+(_0x48ac51(0x2c1)+_0x35ddda+_0x48ac51(0x3a9)));let _0x21bab5=fs[_0x48ac51(0x215)](configbackuppath,{'withFileTypes':!![]});_0x21bab5[_0x48ac51(0x335)]((_0x2934d0,_0x1cc404)=>_0x2934d0[_0x48ac51(0x33e)]<_0x1cc404['name']?0x1:_0x1cc404['name']<_0x2934d0[_0x48ac51(0x33e)]?-0x1:0x0),_0x21bab5[_0x48ac51(0x3b6)]>maxBackups&&fs[_0x48ac51(0x3bc)](configbackuppath+_0x21bab5[_0x21bab5[_0x48ac51(0x3b6)]-0x1][_0x48ac51(0x33e)]);}function rotateLogFiles(){const _0x43a602=_0x50ef29,_0x345e22=fs[_0x43a602(0x30a)](logspath+'output-000.log'),_0x4cbefa=_0x345e22[_0x43a602(0x2b1)]/0x400;if(_0x4cbefa>0x64){let _0x2f495d=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x2f495d['sort']((_0x5a45a8,_0x537266)=>_0x5a45a8[_0x43a602(0x33e)]<_0x537266['name']?0x1:_0x537266['name']<_0x5a45a8[_0x43a602(0x33e)]?-0x1:0x0),_0x2f495d['forEach'](_0x494070=>{const _0x1cda7b=_0x43a602;if(_0x494070['name']=='output-002.log')fs['copyFileSync'](logspath+_0x494070[_0x1cda7b(0x33e)],logspath+_0x1cda7b(0x2ef));if(_0x494070['name']=='output-001.log')fs[_0x1cda7b(0x2e9)](logspath+_0x494070[_0x1cda7b(0x33e)],logspath+_0x1cda7b(0x1fc));_0x494070[_0x1cda7b(0x33e)]=='output-000.log'&&(fs[_0x1cda7b(0x2e9)](logspath+_0x494070[_0x1cda7b(0x33e)],logspath+_0x1cda7b(0x3a6)),fs['writeFileSync'](logspath+_0x494070[_0x1cda7b(0x33e)],''));});}}async function zipFiles(_0x5d1477){const _0x1aa69e=_0x50ef29;let _0x214861;if(_0x5d1477==_0x1aa69e(0x321))_0x214861=logspath;if(_0x5d1477==_0x1aa69e(0x359))_0x214861=configpath;if(_0x5d1477==_0x1aa69e(0x357))_0x214861=configpath;let _0x139267=fs[_0x1aa69e(0x215)](_0x214861,{'withFileTypes':!![]});const _0x34621e=new JSZip();_0x139267[_0x1aa69e(0x34b)](_0x2ad94b=>{const _0x23ebe9=_0x1aa69e;if(!_0x2ad94b[_0x23ebe9(0x281)]()){let _0x59a8c6=fs[_0x23ebe9(0x30b)](_0x214861+_0x2ad94b[_0x23ebe9(0x33e)]);if(_0x5d1477==_0x23ebe9(0x359)){const _0xacf617=/^bot-[0-9]{3}-config.json$/,_0x436daa=_0xacf617[_0x23ebe9(0x2a7)](_0x2ad94b['name']);if(_0x436daa){const _0x21a316=JSON[_0x23ebe9(0x280)](_0x59a8c6);if(_0x21a316[_0x23ebe9(0x1e9)][0x0]){_0x21a316['bot'][0x0][_0x23ebe9(0x2e7)]=_0x23ebe9(0x222),_0x21a316[_0x23ebe9(0x1e9)][0x0][_0x23ebe9(0x21a)]=_0x23ebe9(0x222);if(_0x21a316['bot'][0x0]['apiPassword'])_0x21a316[_0x23ebe9(0x1e9)][0x0][_0x23ebe9(0x216)]=_0x23ebe9(0x222);}_0x59a8c6=JSON[_0x23ebe9(0x2b7)](_0x21a316,null,0x2);}if(_0x2ad94b['name']==_0x23ebe9(0x29f)){const _0xbbba79=JSON[_0x23ebe9(0x280)](_0x59a8c6);if(_0xbbba79[_0x23ebe9(0x232)][_0x23ebe9(0x240)])_0xbbba79[_0x23ebe9(0x232)]['loginRequired']=![];if(_0xbbba79[_0x23ebe9(0x232)][_0x23ebe9(0x1e0)])_0xbbba79[_0x23ebe9(0x232)][_0x23ebe9(0x1e0)]=_0x23ebe9(0x222);if(_0xbbba79['settings'][_0x23ebe9(0x28c)])_0xbbba79['settings'][_0x23ebe9(0x28c)]=_0x23ebe9(0x222);if(_0xbbba79[_0x23ebe9(0x232)][_0x23ebe9(0x365)])_0xbbba79[_0x23ebe9(0x232)]['telegramChatId']=null;if(_0xbbba79[_0x23ebe9(0x232)][_0x23ebe9(0x30f)])_0xbbba79[_0x23ebe9(0x232)][_0x23ebe9(0x30f)]='***';_0x59a8c6=JSON[_0x23ebe9(0x2b7)](_0xbbba79,null,0x2);}if(_0x2ad94b[_0x23ebe9(0x33e)]!=_0x23ebe9(0x3be))_0x34621e['file'](_0x2ad94b[_0x23ebe9(0x33e)],_0x59a8c6);}else _0x34621e['file'](_0x2ad94b[_0x23ebe9(0x33e)],_0x59a8c6);}});const _0x7c44a8=await _0x34621e['generateAsync']({'type':'string','base64':![],'compression':_0x1aa69e(0x390)});fs[_0x1aa69e(0x2ee)](zippath+(_0x5d1477+_0x1aa69e(0x3a9)),_0x7c44a8,'binary');}async function unzipFile(_0x6ade50,_0x5d5961){const _0x5070a1=_0x50ef29;fs[_0x5070a1(0x215)](configpath,{'withFileTypes':!![]})[_0x5070a1(0x34b)](_0x5ce299=>{const _0x2048f5=_0x5070a1;if(!_0x5ce299['isDirectory']())fs[_0x2048f5(0x300)](configpath+_0x5ce299['name']);});const _0x4cb15b=fs['readFileSync'](_0x6ade50+_0x5d5961,'binary'),_0x279770=await JSZip[_0x5070a1(0x35a)](_0x4cb15b,{'base64':![],'checkCRC32':!![]});for(const _0x27f9b2 of Object[_0x5070a1(0x38b)](_0x279770[_0x5070a1(0x1f5)])){const _0x4d3848=_0x279770[_0x5070a1(0x1f5)][_0x27f9b2],_0x326c49=await _0x4d3848[_0x5070a1(0x252)]('string');fs[_0x5070a1(0x2ee)](configpath+_0x4d3848[_0x5070a1(0x33e)],_0x326c49);}fs[_0x5070a1(0x215)](temppath,{'withFileTypes':!![]})['forEach'](_0x2a0c81=>{const _0x510ebe=_0x5070a1;if(!_0x2a0c81[_0x510ebe(0x281)]())fs['rmSync'](temppath+_0x2a0c81[_0x510ebe(0x33e)]);}),logger[_0x5070a1(0x350)](_0x5070a1(0x369)),process[_0x5070a1(0x304)]({'restore':!![]},_0xf92355=>{});}async function getPublicIp(){const _0x3904cb=_0x50ef29;try{const _0x44736a=await axios['get'](_0x3904cb(0x272));publicip=_0x44736a[_0x3904cb(0x37f)]['ip'];}catch(_0x1ff9a2){}}async function triggerAnalytics(){const _0x41e103=_0x50ef29;if(!publicip)await getPublicIp();const _0x5a0613=getBotsWithMode();let _0x5dbe8c=0x0;_0x5a0613[_0x41e103(0x34b)](_0xc50f5=>{const _0x1cf28a=_0x41e103;if(_0xc50f5[_0x1cf28a(0x2ab)]===_0x1cf28a(0x1e7))_0x5dbe8c++;});const _0x8d0535=getBotExchanges();mixpanel[_0x41e103(0x2ec)](_0x41e103(0x26f),{'distinct_id':settings[_0x41e103(0x246)],'ip':publicip,'version':serverversion,'numbots':_0x5a0613[_0x41e103(0x3b6)],'numbotsenabled':_0x5dbe8c,'exchanges':_0x8d0535,'environment':environment});}async function getMessages(){const _0x2d8615=_0x50ef29,_0x3bda12=_0x2d8615(0x268),_0x262c90=new GraphQLClient(_0x3bda12),_0x25874b={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x4ed5f2=serverversion[_0x2d8615(0x223)]('.'),_0x415bd4=_0x4ed5f2[0x0]+'.'+_0x4ed5f2[0x1],_0x4d0c4b=Math[_0x2d8615(0x287)](settings['lastmsgtelegram'],settings[_0x2d8615(0x311)]),_0x281b76={'last':parseInt(_0x4d0c4b),'bbm':_0x415bd4},_0x568777=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x12d5ab;try{_0x12d5ab=await _0x262c90['request'](_0x568777,_0x281b76,_0x25874b);}catch(_0x42f4e5){}if(_0x12d5ab&&_0x12d5ab['messages']){let _0x1d174e=settings[_0x2d8615(0x212)];newMessages=[];for(const _0x36ef7e of _0x12d5ab[_0x2d8615(0x38d)]){newMessages[_0x2d8615(0x2ed)](_0x36ef7e);let _0x59fb2b=![];_0x36ef7e[_0x2d8615(0x298)]&&(updateSetting(_0x2d8615(0x39d),_0x36ef7e['bbvNew']),_0x59fb2b=isNewerVersion(serverversion,_0x36ef7e[_0x2d8615(0x298)])||serverversion==_0x36ef7e['bbvNew']);if(!_0x59fb2b&&_0x36ef7e[_0x2d8615(0x1e1)]>_0x1d174e){if(_0x36ef7e[_0x2d8615(0x2b5)]===_0x2d8615(0x37b)||serverversion[_0x2d8615(0x334)](_0x36ef7e[_0x2d8615(0x2b5)])){let _0x38fa8f=''+_0x36ef7e['title']+'\x0a\x0a'+_0x36ef7e[_0x2d8615(0x328)];const _0x216391=await sendTelegramMsg(toTelegramMarkdown(_0x38fa8f),_0x2d8615(0x3b8));if(_0x216391)_0x1d174e=_0x36ef7e[_0x2d8615(0x1e1)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x1d174e),emitMessages();}}function emitMessages(){const _0x31c372=_0x50ef29,_0x1c0770=settings['lastmsgemitted'];let _0x156610=[];newMessages['forEach'](_0x5b18f9=>{const _0x4f70bd=_0x4877;_0x5b18f9[_0x4f70bd(0x1e1)]>_0x1c0770&&_0x156610[_0x4f70bd(0x2ed)](_0x5b18f9);}),_0x156610[_0x31c372(0x3b6)]>0x0&&getAllClients()[_0x31c372(0x34b)](_0x2851c7=>{getSocket(_0x2851c7['id'])['emit']('message',_0x156610);});}function _0x4877(_0x3ddbcf,_0x57f054){const _0x496136=_0x11d6();return _0x4877=function(_0x2a466a,_0x5c1352){_0x2a466a=_0x2a466a-0x1c9;let _0x11d6ec=_0x496136[_0x2a466a];return _0x11d6ec;},_0x4877(_0x3ddbcf,_0x57f054);}function confirmMessage(_0x3cde51){const _0x2c26d7=_0x50ef29;updateSetting(_0x2c26d7(0x311),Number(_0x3cde51));}function isNewerVersion(_0x10675a,_0x417186){const _0x3ee92b=_0x50ef29,_0x55d715=_0x417186[_0x3ee92b(0x223)]('.'),_0x1a5a09=_0x10675a[_0x3ee92b(0x223)]('.');for(var _0x202538=0x0;_0x202538<_0x1a5a09[_0x3ee92b(0x3b6)];_0x202538++){const _0x4e82bc=~~_0x1a5a09[_0x202538],_0x2e7ab3=~~_0x55d715[_0x202538];if(_0x4e82bc>_0x2e7ab3)return!![];if(_0x4e82bc<_0x2e7ab3)return![];}return![];}function toTelegramMarkdown(_0x20dcc0){const _0x534476=_0x50ef29,_0x4f90ba=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3d900b=/\*{2}(.+?)\*{2}/gim;return _0x20dcc0=_0x20dcc0[_0x534476(0x286)](_0x4f90ba,_0x534476(0x1cd))['replace'](_0x3d900b,_0x534476(0x295)),_0x20dcc0;}async function validateConfigFile(){const _0x299bf1=_0x50ef29,_0x21abf1=dbConfig[_0x299bf1(0x284)](_0x299bf1(0x313))[_0x299bf1(0x1fb)]('botID')[_0x299bf1(0x3d3)]()||[];if(_0x21abf1[_0x299bf1(0x3b6)]==0x0){let _0x3a1673=0x0,_0x3b9592=[];const _0x240d4f=/^bot-([0-9]{3})-config.json$/,_0x30a49e=fs['readdirSync'](configpath);_0x30a49e['forEach'](_0x4be1da=>{const _0x2fe37d=_0x299bf1,_0x5a441d=_0x240d4f[_0x2fe37d(0x2fd)](_0x4be1da);if(_0x5a441d){const _0xedce81=_0x5a441d[0x1];let _0x387cf5=getBotAttributes(_0xedce81);_0x3b9592['push']({'botID':_0xedce81,'botname':_0x387cf5['botname'],'status':_0x2fe37d(0x2fc),'live':'stopped'}),_0x3a1673++;}}),_0x3a1673!=0x0&&(dbConfig[_0x299bf1(0x284)](_0x299bf1(0x313))[_0x299bf1(0x34f)](_0x3b9592)[_0x299bf1(0x221)](),config=_0x3b9592,restoredConfigFile=_0x3a1673);}}async function restoreConfigNotify(_0x13f2db){const _0xe05179=_0x50ef29;let _0xe3b048;if(restoredConfigFile==0x1)_0xe3b048=_0xe05179(0x32a);else _0xe3b048=_0xe05179(0x3d6);if(_0x13f2db)io['to']('botmanager')[_0xe05179(0x234)]('notification',_0xe3b048);else{logger[_0xe05179(0x1d4)](_0xe05179(0x384)),logger['simple'](_0xe3b048),logger['simple'](_0xe05179(0x384)),logger[_0xe05179(0x1d4)]('');if(tgBot&&settings[_0xe05179(0x365)]&&settings[_0xe05179(0x23e)]!=_0xe05179(0x245))await sendTelegram(settings[_0xe05179(0x365)],_0xe05179(0x2cf)+_0xe3b048);}}function decryptRSA(_0x22e008,_0x3a29cb){const _0x3815c1=_0x50ef29,_0x2d15e0=forge[_0x3815c1(0x291)][_0x3815c1(0x3bb)](_0x22e008),_0x3ee700=_0x2d15e0['decrypt'](forge[_0x3815c1(0x3ab)][_0x3815c1(0x1d1)](_0x3a29cb),_0x3815c1(0x383),{'md':forge['md'][_0x3815c1(0x34c)][_0x3815c1(0x388)](),'mgf1':{'md':forge['md'][_0x3815c1(0x34c)]['create']()}});return _0x3ee700;}function validateCredentials(_0x15d1e2,_0x123a49){const _0x54fe55=_0x50ef29;if(_0x15d1e2[_0x54fe55(0x274)]==settings[_0x54fe55(0x35c)]&&bcrypt[_0x54fe55(0x266)](_0x15d1e2[_0x54fe55(0x302)],settings[_0x54fe55(0x1e0)])){if(settings[_0x54fe55(0x35e)])return{'allow':![],'reason':_0x54fe55(0x396),'token':null};else{const _0x539412=generateLoginToken(_0x123a49);return{'allow':!![],'reason':_0x54fe55(0x205),'token':_0x539412};}}else return{'allow':![],'reason':_0x54fe55(0x2b6),'token':null};}function _0x11d6(){const _0x42be0b=['stopped','headers','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','2FA\x20login\x20token\x20generated','log','Starting\x20(','All\x20bots\x20running\x20right\x20now','Error\x20removing\x20old\x20backup\x20files:','backup/','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','find','\x20only\x0a',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','No\x20authentication\x20token','compareSync','isValid','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','headless','static','onepagemode',',\x20must\x20be\x20a\x204\x20digit\x20number','Unauthorized\x20attempt\x20to\x20delete\x20bot','socket','Server','#RES#\x20','tempaccess_reject_','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','username','randomBytes','success','post','login','close','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','config_alerts','hasOwnProperty','remove','Restore\x20process\x20aborted','temp/','parse','isDirectory','inlineKeyboard','node','get','new','replace','min','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/:bot','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','axios','telegramToken','config','restore_no_','\x1b[33m','handshake','pki','config/','update','apply','*$1*','filter','all','bbvNew','ETH','ipc','botID','\x1b[35m','Unauthorized\x20attempt\x20to\x20update\x20settings','Notifications\x20enabled\x0a','bb-settings.json','2429307mrCpPL','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Bot\x20','config_orders','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','build','add','test','kill','get-starting-balances','Notifications\x20enabled','status','callback','toggleBotMode','init','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','You\x20can\x20use\x20the\x20following\x20commands:\x0a','size','clientip','rsa','Telegram\x20error:','bbvReceive','invalid\x20credentials','stringify','args','5AMKgUY','mode','disable','login2fa_','Invalid\x20authentication\x20token\x20(1)','getTime','\x1b[34m','|@|','backup-full@','/off\x20-\x20stop\x20bot(s)\x0a','Session\x20expired\x20for\x20user\x20...','metrics_','build2','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','show','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','notification','reinstall_no','/:bot/performance','250854MoFRpu','api-eu.mixpanel.com','inherit','Bot\x20Mgr\x20>\x20','login\x20not\x20required','zip/','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','crypto','includes','metrics','chat','/:bot/configuration','tempaccess_15_','Invalid\x20authentication\x20token\x20(2)','hex','config_all','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','access','resetpw_yes','portfolio_','connected','node-forge','reinstall_yes','updatebotmanager','search','login\x20required','Unauthorized\x20attempt\x20to\x20update\x20bot','apiKey','telegrammsg','copyFileSync','path','Disabled\x20Bot\x20','track','push','writeFileSync','output-003.log','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','restart_','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','family','236668RYKNMZ','entries','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','privateKey','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','/output-000.log',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','exit','disabled','exec','alias','exchange','rmSync','logs/','password','uuid-random','send','yargs/yargs','getMonth','Unauthorized\x20attempt\x20to\x20add\x20bot','temporary\x20token\x20generated','getSeconds','statSync','readFileSync','Backup\x20file\x20uploaded','2FA\x20login\x20rejected','get-backup-files','marketcapApi','mkdirSync','lastmsgemitted','/download/:type','bots','storeFiat','getDate','delete-alerts','removeAllListeners','publicKey','mixpanel','telegram','temporary\x20access\x20rejected','on_','constructor','Logged\x20out\x20user\x20...','bot-','timestamp','logs','Restore\x20process\x20confirmed','backup-full.zip','fork','sendFile','uncaughtException','0.0.0','message','pidRefreshToken','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','sockets','temporaryAccessAllowed','/:bot/history','Unauthorized\x20attempt\x20to\x20show\x20configuration','142772TaCUvl','function','Unauthorized\x20attempt\x20to\x20download\x20','Alerts','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','startsWith','sort','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','generateKeyPair','error','6b67f3d61ee94b8f5c80b4affef4c4d9','\x20to\x20','enable','encryptedUuid','/update\x20-\x20update\x20Balance\x20Bot\x0a','name','login\x20token\x20valid','slice','start','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','3000','Failed\x20to\x20download\x20','auto','1000','command','botmanager','\x1b[0m','reload','forEach','sha256','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','assign','debug','show-config','Orders','\x20(1)','env','socket.io','NTBA_FIX_319','backup-full','alerts','backup','loadAsync','publicKeyToPem','bbUsername','uuid','f2aRequired','index.html','get-logs','sendPortfolioTelegram','telegramIpApproval','toggle_','store','telegramChatId','full','temporary\x20access\x20not\x20allowed','getPortfolio','Backup\x20file\x20unzipped\x20and\x20stored','code','access\x20timeout','HTML','#RES#\x20if\x20running\x20locally\x0a','store-settings','All\x20bots','getHours','type','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','conn','-config.json','User\x20has\x20been\x20validated','toggle','Temporary\x20access\x20rejected','jszip','-performance.json','any','************','Invalid\x20username\x20or\x20IP\x20address','Notifications\x20types:\x20','data','Notifications\x20disabled\x0a','allow','_nsps','RSA-OAEP','-----------------------------------------------------------------------------------','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','match','create','staging','Password\x20has\x20been\x20reset\x20to:\x20','keys','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','messages','Setting\x20access:\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','DEFLATE','=>\x20Go\x20to\x20#CYA#http://','storeHeadless','environment','yes','Unauthorized\x20attempt\x20to\x20get\x20portfolio','2FA\x20login\x20required','reset-password','botname','defaults','initclient','bcryptjs','#RES#\x20if\x20running\x20on\x20server','latestversion','tempaccess_5_','address','telegramUsername','editMessageReplyMarkup','confirm-message','help','catch','Notifications\x20disabled','output-001.log','running','store-configuration','.zip','::ffff:127.0.0.1','util','497SCBJRP','30\x20min','address\x20already\x20in\x20use','update-bb','Starting\x20Balance\x20Bot\x20update','127.0.0.1','off_','lowdb/adapters/FileSync','12BjxnRi','\x20|\x20','length','toIPv4MappedAddress','Markdown','padStart',':\x20Bot\x20Mgr\x20>\x20','privateKeyFromPem','unlinkSync','<b>Telegram\x20Bot\x20Status:</b>\x0a','bb-secure.json','names','telegramEnabled','delete-bot','SIGTERM','2FA\x20required','secret','status\x20code\x20401','ipv6','5\x20min','placeOrder','193628beJpCf','CoinMarketCap\x20API\x20key\x20validated','/help\x20-\x20show\x20available\x20commands\x0a','settings.','Token\x20blacklisted','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/:bot/coins','warning','set','value','getFullYear','started','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Idling\x20(','new-disabled','/start','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','internal','event','$1_$2_$3','blacklist','Deleted\x20Bot\x20','(staging)','decode64','242PLcYUT','/restart\x20-\x20restart\x20bot(s)\x0a','simple','Error\x20details:','Invalid\x20IP\x20address','existsSync','/enable\x20-\x20enable\x20notifications\x0a','Restoring\x20bot(s)\x20from\x20backup','reject','token','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','/:bot/portfolio','disconnect','lowdb','bbPassword','number','string','15\x20min','launch','update-bot','139000ugQNgh','enabled','/upload-backup','bot','43000occpEf','live','Ok,\x20will\x20send\x20alert\x20notifications\x20only','BCT','Unauthorized\x20login\x20attempt\x20(timeout)','endsWith','getMinutes','Logged\x20in\x20user\x20...','backup-files','child_process','restore_yes_','files','range','params','use','sendMetricsTelegram','getStartingBalances','sortBy','output-002.log','/names\x20-\x20show\x20bot\x20names\x0a','add-bot','Starting\x20#RED#Balance\x20Bot\x20v','reason','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','once','join','\x20>\x20','login\x20token\x20generated','date-fns','::1','update_no','SIGINT','/on\x20-\x20start\x20bot(s)\x0a','telegram2FaApproval','tempaccess_30_','Yes','manual','resetpw_no','format','toString','lastmsgtelegram','telegraf','-events.json','readdirSync','apiPassword','hashSync','download','login2fa_reject_','apiSecret','expiry','Error:\x20Invalid\x20argument\x20','\x20-\x20','timeshift','jsonwebtoken','pidExpireLogin','write','***','split','argv','ipaddr.js','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','-results.json','cancel-loading','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20get\x20messages','backupfile','express','express-fileupload','mtime','2FA','store-fiat','settings','from','emit','auth','Starting\x20Balance\x20Bot\x20reinstallation','stop','action','listen','Ok,\x20will\x20send\x20order\x20notifications\x20only','cloneDeep','port','Unauthorized\x20attempt\x20to\x20log\x20out','telegramEvents','reply','loginRequired','Starting\x20new\x20bot\x20|\x20Bot\x20','\x20|\x20user:\x20...','File\x20uploaded','showname','orders','userid','cancelLoading','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','secure','graphql-request','reinstall','remoteAddress','sign','\x20(2)','version','get-messages','createServer','async','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','button','[ip-address]','version.json'];_0x11d6=function(){return _0x42be0b;};return _0x11d6();}function refreshToken(_0x4f1c0d){const _0x5cffc7=_0x50ef29,_0x3f0d05=generateLoginToken(_0x4f1c0d);return{'allow':!![],'reason':_0x5cffc7(0x205),'token':_0x3f0d05};}function validateAccess(_0x10fa56,_0x40c2a7,_0xea87dd){const _0x44e8da=_0x50ef29,_0x23b6c7=_0xea87dd?_0xea87dd:devices[_0x40c2a7]['ip'];let _0x1f9a9e;const _0x2efcda=_0x44aa87=>{const _0x49c447=_0x4877;if(settings[_0x49c447(0x240)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x40c2a7)){const _0x556afb=generateLoginToken(_0x40c2a7);return{'allow':!![],'reason':_0x49c447(0x25a),'token':_0x556afb};}else return{'allow':![],'reason':_0x49c447(0x2e5),'token':null};}else return _0x1f9a9e=validToken(_0x44aa87,_0x40c2a7),_0x1f9a9e[_0x49c447(0x27c)](_0x49c447(0x276))?{'allow':!![],'reason':_0x49c447(0x33f),'token':_0x44aa87}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x49c447(0x2d0),'token':null};};if(settings['whitelistEnabled']){let _0x4b6f23=[...settings['whitelist'],_0x44e8da(0x207),_0x44e8da(0x3aa),_0x44e8da(0x3b1)];if(_0x4b6f23[_0x44e8da(0x2d4)](_0x23b6c7))return _0x2efcda(_0x10fa56);else{_0x1f9a9e=validToken(_0x10fa56,_0x40c2a7);if(_0x1f9a9e[_0x44e8da(0x27c)]('success'))return _0x2efcda(_0x10fa56);else{if(telegramIpApproved(_0x40c2a7)){const _0xd74f06=generateToken(_0x40c2a7);return _0x1f9a9e=_0x2efcda(_0x10fa56),_0x1f9a9e[_0x44e8da(0x381)]?{'allow':!![],'reason':_0x44e8da(0x308),'token':_0xd74f06}:_0x1f9a9e;}else return settings[_0x44e8da(0x32c)]?{'allow':![],'reason':_0x44e8da(0x3c3),'token':null}:{'allow':![],'reason':_0x44e8da(0x367),'token':null};}}}else return _0x2efcda(_0x10fa56);}function timelyDecrypt(_0x518b8d,_0x2e35bc,_0x5f262e='@'){const _0x4c689f=_0x50ef29;if(_0x518b8d)try{const _0x39fc25=decryptRSA(secure[_0x4c689f(0x2f7)],_0x518b8d),_0x3ade80=_0x39fc25[_0x4c689f(0x223)](_0x5f262e)[0x0],_0x130a1c=_0x39fc25[_0x4c689f(0x223)](_0x5f262e)[0x1],_0x22181b=new Date()['getTime']();if(_0x2e35bc){if(_0x22181b-_0x130a1c<maxSecretAge*0x3e8)return _0x3ade80;else return![];}else return _0x3ade80;}catch(_0x22fa2d){return![];}else return![];}const validToken=(_0x29f3ed,_0x9ffc62)=>{const _0x2611f0=_0x50ef29,_0x171d8a=devices[_0x9ffc62]['ip'];if(!_0x29f3ed)return{'error':_0x2611f0(0x265)};for(let _0x157abb of blacklist){if(_0x157abb[_0x2611f0(0x1db)]==_0x29f3ed)return{'error':_0x2611f0(0x3cd)};}let _0x464324;try{_0x464324=jwt['verify'](_0x29f3ed,secure['secret']+_0x9ffc62);}catch{return{'error':_0x2611f0(0x2bd)};}if(!_0x464324[_0x2611f0(0x27c)](_0x2611f0(0x2b2))&&!_0x464324[_0x2611f0(0x27c)](_0x2611f0(0x274))||!_0x464324['hasOwnProperty']('exp'))return{'error':_0x2611f0(0x2d9)};if(!_0x464324[_0x2611f0(0x27c)](_0x2611f0(0x274))&&_0x464324[_0x2611f0(0x27c)](_0x2611f0(0x2b2))){const {clientip:_0xc2c2e5}=_0x464324;return _0x171d8a==_0xc2c2e5?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2611f0(0x1d6)};}else{if(_0x464324[_0x2611f0(0x27c)](_0x2611f0(0x274))&&_0x464324[_0x2611f0(0x27c)]('clientip')){const {username:_0x524f9d,clientip:_0x5644c9}=_0x464324;return settings['bbUsername']==_0x524f9d&&_0x171d8a==_0x5644c9?{'success':_0x2611f0(0x376)}:{'error':_0x2611f0(0x37d)};}}},generateLoginToken=_0x1d9d1b=>{const _0x309079=_0x50ef29;if(_0x1d9d1b){const _0x19312f=devices[_0x1d9d1b]['ip'];return jwt[_0x309079(0x24d)]({'username':settings[_0x309079(0x35c)],'clientip':_0x19312f},secure[_0x309079(0x3c4)]+_0x1d9d1b,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x42a209=>{const _0x3497d8=_0x50ef29;if(_0x42a209){const _0x14c57e=devices[_0x42a209]['ip'];return jwt['sign']({'clientip':_0x14c57e},secure['secret']+_0x42a209,{'expiresIn':devices[_0x42a209][_0x3497d8(0x362)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x4a91cd=>{const _0x1c4c4b=_0x50ef29;let _0x230ff5=![];return devices[_0x4a91cd][_0x1c4c4b(0x362)]&&devices[_0x4a91cd]['telegramIpApproval']['expiry']!=_0x1c4c4b(0x1da)&&(_0x230ff5=devices[_0x4a91cd][_0x1c4c4b(0x362)][_0x1c4c4b(0x2b2)]==devices[_0x4a91cd]['ip']&&new Date()[_0x1c4c4b(0x2be)]()-devices[_0x4a91cd][_0x1c4c4b(0x362)][_0x1c4c4b(0x320)]<devices[_0x4a91cd][_0x1c4c4b(0x362)][_0x1c4c4b(0x21b)]*0x3c*0x3e8),_0x230ff5;},telegram2FaApproved=_0x5c6193=>{const _0x24cb6a=_0x50ef29;let _0x265851=![];return devices[_0x5c6193]['telegram2FaApproval']&&devices[_0x5c6193][_0x24cb6a(0x20b)][_0x24cb6a(0x21b)]!=_0x24cb6a(0x1da)&&(_0x265851=devices[_0x5c6193][_0x24cb6a(0x20b)]['clientip']==devices[_0x5c6193]['ip']&&new Date()['getTime']()-devices[_0x5c6193][_0x24cb6a(0x20b)]['timestamp']<devices[_0x5c6193]['telegram2FaApproval'][_0x24cb6a(0x21b)]*0x3c*0x3e8),_0x265851;},normalizeIP=_0x44397c=>{const _0x12ee86=_0x50ef29;let _0x56aa90=null,_0xdc57e8=null;if(ipaddr[_0x12ee86(0x267)](_0x44397c)){const _0x2ee75c=ipaddr[_0x12ee86(0x280)](_0x44397c);_0x2ee75c['kind']()===_0x12ee86(0x3c6)?(_0x2ee75c[_0x12ee86(0x3ce)]()&&(_0x56aa90=_0x2ee75c['toIPv4Address']()[_0x12ee86(0x211)]()),_0xdc57e8=_0x2ee75c[_0x12ee86(0x211)]()):(_0x56aa90=_0x2ee75c[_0x12ee86(0x211)](),_0xdc57e8=_0x2ee75c[_0x12ee86(0x3b7)]()[_0x12ee86(0x211)]());}return{'show':_0x56aa90?_0x56aa90:_0xdc57e8,'store':_0xdc57e8};};function formatDate(_0x3481c8){const _0x42de48=_0x50ef29;return _0x3481c8[_0x42de48(0x3d4)]()+'/'+(_0x3481c8[_0x42de48(0x306)]()+0x1)['toString']()[_0x42de48(0x3b9)](0x2,'0')+'/'+_0x3481c8['getDate']()[_0x42de48(0x211)]()[_0x42de48(0x3b9)](0x2,'0')+'\x20'+_0x3481c8['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x3481c8['getMinutes']()[_0x42de48(0x211)]()['padStart'](0x2,'0')+':'+_0x3481c8['getSeconds']()[_0x42de48(0x211)]()[_0x42de48(0x3b9)](0x2,'0');}function sleep(_0x379765){return new Promise(_0x36e849=>setTimeout(_0x36e849,_0x379765));}