const _0x2ea84e=_0x4058;(function(_0x3ef2b3,_0x4980f2){const _0x345b67=_0x4058,_0x1fdf0f=_0x3ef2b3();while(!![]){try{const _0x1ee9b5=-parseInt(_0x345b67(0x258))/0x1+parseInt(_0x345b67(0x1d2))/0x2*(parseInt(_0x345b67(0x243))/0x3)+parseInt(_0x345b67(0x23b))/0x4*(-parseInt(_0x345b67(0x1ea))/0x5)+-parseInt(_0x345b67(0x159))/0x6+parseInt(_0x345b67(0x187))/0x7*(parseInt(_0x345b67(0x253))/0x8)+parseInt(_0x345b67(0xeb))/0x9*(parseInt(_0x345b67(0x16b))/0xa)+-parseInt(_0x345b67(0x1c9))/0xb;if(_0x1ee9b5===_0x4980f2)break;else _0x1fdf0f['push'](_0x1fdf0f['shift']());}catch(_0x4e7681){_0x1fdf0f['push'](_0x1fdf0f['shift']());}}}(_0x197d,0xca400));const _0x4a7c87=function(){let _0x3a2061=!![];return function(_0x115ab3,_0x112ba5){const _0x143da7=_0x3a2061?function(){const _0x52d8f5=_0x4058;if(_0x112ba5){const _0x240812=_0x112ba5[_0x52d8f5(0x29c)](_0x115ab3,arguments);return _0x112ba5=null,_0x240812;}}:function(){};return _0x3a2061=![],_0x143da7;};}(),_0x4e9624=_0x4a7c87(this,function(){const _0x4336c2=_0x4058;return _0x4e9624[_0x4336c2(0x105)]()[_0x4336c2(0x275)](_0x4336c2(0x1fd))['toString']()[_0x4336c2(0xd5)](_0x4e9624)[_0x4336c2(0x275)]('(((.+)+)+)+$');});_0x4e9624();'use strict';process['env'][_0x2ea84e(0x132)]=0x1;const childProcess=require(_0x2ea84e(0xc5)),fs=require('fs'),fns=require(_0x2ea84e(0x1e8)),low=require('lowdb'),FileSync=require(_0x2ea84e(0x1c4)),path=require(_0x2ea84e(0x227)),crypto=require(_0x2ea84e(0x205)),Crypt=require('hybrid-crypto-js')[_0x2ea84e(0x276)],RSA=require(_0x2ea84e(0xab))[_0x2ea84e(0x10d)],bcrypt=require(_0x2ea84e(0x172)),jwt=require(_0x2ea84e(0x178)),ipaddr=require('ipaddr.js'),argv=require(_0x2ea84e(0x251))(process[_0x2ea84e(0x161)]['slice'](0x2))[_0x2ea84e(0x161)],uuidRandom=require(_0x2ea84e(0x120)),{Telegraf,Markup}=require(_0x2ea84e(0x25b)),Mixpanel=require(_0x2ea84e(0x137)),axios=require('axios'),{GraphQLClient,gql}=require(_0x2ea84e(0xae)),util=require(_0x2ea84e(0x225)),fileUpload=require(_0x2ea84e(0x1ce)),{networkInterfaces}=require('os'),PORT=argv[_0x2ea84e(0x24f)]||_0x2ea84e(0x9d),pattern=/^[0-9]{2,4}$/;!pattern[_0x2ea84e(0x289)](PORT)&&(console[_0x2ea84e(0x1a5)](_0x2ea84e(0xc1)+PORT+_0x2ea84e(0x14a)),process[_0x2ea84e(0x158)](0x1));const HOST=argv[_0x2ea84e(0x131)]||null,userID=argv[_0x2ea84e(0x1ab)]||'',debugging=argv['d']||![],nodeversion=process[_0x2ea84e(0x138)][_0x2ea84e(0x180)];let bbpath='bb/',bbpath2='';const botfile=_0x2ea84e(0x15c),configfile=_0x2ea84e(0x214),settingsfile=_0x2ea84e(0x13d),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x2ea84e(0x2a7))[_0x2ea84e(0x1e5)]||_0x2ea84e(0x10b),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2ea84e(0x255)),configpath=userID?bbpath+_0x2ea84e(0x228)+userID+'/':bbpath+_0x2ea84e(0x228),configbackuppath=configpath+_0x2ea84e(0x1aa),logspath=userID?bbpath+_0x2ea84e(0x1f8)+userID+'/':bbpath+_0x2ea84e(0x1f8),zippath=userID?bbpath+_0x2ea84e(0xb3)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x2ea84e(0xfc)](logspath+_0x2ea84e(0x1d6),{'flags':'a'}),temppath=userID?bbpath+_0x2ea84e(0x9a)+userID+'/':bbpath+'temp/';!fs[_0x2ea84e(0x15d)](configpath)&&fs[_0x2ea84e(0x121)](configpath);function _0x197d(){const _0x3543fd=['/update\x20-\x20update\x20Balance\x20Bot\x0a','Invalid\x20authentication\x20token\x20(1)','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/upload-backup','config_orders','value','Starting\x20#RED#Balance\x20Bot\x20v','live','auto','telegramIpApproval','Unauthorized\x20attempt\x20to\x20store\x20configuration','metrics','restart','sortBy','pidExpireLogin','yes','enable','telegramUsername','/:bot/history','start','names','length','lowdb/adapters/FileSync',')\x20|\x20Bot\x20','uncaughtException','Login\x20accepted','socket','12606638pTSefu','<b>Balance\x20Bot\x20Status:</b>\x0a','2FA\x20login\x20required','Allow\x20login\x20from\x20IP\x20address\x20','15\x20min','express-fileupload','Bot\x20Mgr\x20>\x20','pidRefreshToken','logs','2ETEEkp','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Restore\x20backup\x20file\x20','build2','/output-000.log','join','botID','on_','\x1b[36m','close','readdirSync','***','login2fa_reject_','version','Alerts','Yes','sendPortfolioTelegram','apiPassword','logged\x20out','environment','Disabled\x20Bot\x20','30\x20min','date-fns','randomFillSync','252500IESLbT','storeConfiguration','sendFile','decrypt','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','inlineKeyboard','=>\x20Go\x20to\x20#CYA#http://','reinstall_yes','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','mtime','notification','stop','get-logs','-performance.json','logs/',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','encryptedUuid','Notifications\x20disabled\x0a','userid','(((.+)+)+)+$','getMonth','sendMetricsTelegram','tempaccess_reject_','backup-full@','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','SIGINT','Unauthorized\x20attempt\x20to\x20update\x20bot','crypto','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','get','type','build','format','delete-bot','files','referer','sign','-----------------------------------------------------------------------------------','bbPassword','getPortfolio','auth','error','bb-config.json','write','disconnect','toIPv4Address','temporary\x20access\x20timeout','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20get\x20messages','push','ipv6','writeFileSync','from','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Restarting\x20Bot\x20','resetHistory','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','params','getUTCHours','util','bbUsername','path','config/','backup-full','Unauthorized\x20attempt\x20to\x20download\x20','restore_yes_','/:bot/coins','/off\x20-\x20stop\x20bot(s)\x0a','slice','Node.js\x20v','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','function','message','bot','hex','add','readFileSync','messages','initclient','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Network\x20Interfaces:','4EksIDz','launch','Unauthorized\x20attempt\x20to\x20show\x20configuration','lastmsgtelegram','telegramChatId','warning','isIPv4MappedAddress','secure','4391493Olmvaf','Notifications\x20enabled\x0a','temporaryAccessAllowed','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','toIPv4MappedAddress','sockets','botmanager','entries','compareSync','args','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','update_no','port','\x20minutes','yargs/yargs','.zip','88mEXmXX','assign','clients','loginRequired','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','1392511OyuZzn','\x20mode','$1_$2_$3','telegraf','Unauthorized\x20attempt\x20to\x20update\x20settings','2FA\x20required','metrics_','handshake','\x20|\x20','use','getFullYear','config_all','SIGTERM','updatebotmanager','Restoring\x20bot(s)\x20from\x20backup','Server','number','reset-history','login','debug','action','stopped','RSA-OAEP','hashSync','Password\x20has\x20been\x20reset\x20to:\x20','#RES#\x20','post','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','search','Crypt','data','uuid','access','endsWith','manual','reinstall_no','tempaccess_30_','getTime','size','map','output-002.log','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','randomBytes','disable','storeHeadless','cloneDeep','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','test','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','\x20only\x0a','Invalid\x20IP\x20address','\x20to\x20','HTML','privateKey','hasOwnProperty','password','started','Unauthorized\x20attempt\x20to\x20delete\x20bot','headless','Unauthorized\x20attempt\x20to\x20get\x20portfolio','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Restore\x20process\x20confirmed','confirm-message','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','apply','callback','expiry','Error\x20while\x20deleting\x20config\x20files:\x20','http','bots',':\x20Bot\x20Mgr\x20>\x20','************','Error\x20removing\x20old\x20backup\x20files:','event','-config.json','version.json','mode','/:bot/configuration','0.0.0','temp/','portfolio','settings','3000','copyFileSync','delete-alerts','index.html','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','storeFiat','exp','rmSync','emit','Unauthorized\x20attempt\x20to\x20confirm\x20message','new-disabled','tkn','Backup\x20file\x20uploaded','hybrid-crypto-js','download','telegram2FaApproval','graphql-request','output-000.log','6b67f3d61ee94b8f5c80b4affef4c4d9','forEach','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','zip/','new','Logged\x20out\x20user\x20...','name','verify','string','command','backup-full.zip','Failed\x20to\x20download\x20','max','get-messages','full','publicKey','sort','Error:\x20Invalid\x20argument\x20','token','status','private','child_process','editMessageReplyMarkup','File\x20uploaded','padStart','getHours','bbvNew','reinstall','file','Notifications\x20enabled','remove','telegramToken','reset-password','-events.json','fork','Unauthorized\x20attempt\x20to\x20get\x20events','whitelistEnabled','constructor','*$1*','Unauthorized\x20attempt\x20to\x20add\x20bot','\x20>\x20','match','statSync','Starting\x20Balance\x20Bot\x20reinstallation','No\x20authentication\x20token','resetpw_no','Backup\x20file\x20unzipped\x20and\x20stored','running','success','#RES#\x20if\x20running\x20on\x20server','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','replace','binary','enabled','store','showConfig','bbvReceive','toggle-bot-mode','Starting\x20(','9bCiYIY','timestamp','send','logout','username','reload','Temporary\x20access\x20rejected','toggle','blacklist','exec','store-configuration','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','catch','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','defaults','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','isValid','createWriteStream','/status\x20-\x20show\x20bot(s)\x20status\x0a','show-config','::ffff:127.0.0.1','Enabled\x20Bot\x20','temporary\x20access\x20rejected','reject','range','/help\x20-\x20show\x20available\x20commands\x0a','toString','kill','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','\x20(1)','/enable\x20-\x20enable\x20notifications\x0a','production','access\x20timeout','RSA','#RES#\x20if\x20running\x20locally\x0a','telegrammsg','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','update_yes','f2aRequired','secret','allow','/:bot','telegramEnabled','remoteAddress','All','simple','generate','sendMessage','includes','IPv4','toggleBotMode','login\x20token\x20valid','uuid-random','mkdirSync','\x20(2)','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','reply','store-headless','127.0.0.1','Idling\x20(','/metrics\x20-\x20show\x20bot\x20performance\x0a','You\x20can\x20use\x20the\x20following\x20commands:\x0a','unlinkSync','onepagemode','config_alerts','reinstall-bb','min','bot-','get-portfolio','host','NTBA_FIX_319','listen','getSeconds','login\x20not\x20required','any','mixpanel','versions','https://api.ipify.org?format=json','telegram','all','static','bb-settings.json','update-bot','/on\x20-\x20start\x20bot(s)\x0a','disabled','init','kind','Unauthorized\x20attempt\x20to\x20log\x20out','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Logged\x20in\x20user\x20...','then','tempaccess_5_','Session\x20expired\x20for\x20user\x20...','backupfile',',\x20must\x20be\x20a\x204\x20digit\x20number','Login\x20rejected','getStartingBalances','api-eu.mixpanel.com','generateKeyPairAsync','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','cancel-loading','restore-backup-file','All\x20bots','store-settings','[ip-address]','headers','sha256','Invalid\x20username\x20or\x20IP\x20address','exit','689274kszqBa','isDirectory','stringify','bot.js','existsSync','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/restart\x20-\x20restart\x20bot(s)\x0a','chat','argv','\x1b[33m','address','keys','split','backup-files','connected','apiKey','Starting\x20new\x20bot\x20|\x20Bot\x20','once','10771910IscnaZ','exchange','temporary\x20token\x20generated','update','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Token\x20blacklisted','login\x20token\x20generated','bcryptjs','User\x20has\x20been\x20validated','set','Markdown','latestversion','telegramEvents','jsonwebtoken','family','whitelist','botname','Bot\x20','filter','get-backup-files','portfolio_','node','request','login2fa_','lastmsgemitted','store-fiat','2FA\x20login\x20token\x20generated','parse','630854OjEKZi','restart_','Restore\x20process\x20aborted','Telegram\x20error:',')\x20\x20\x20|\x20Bot\x20','timeshift','emitHistory','off_','backup','orders','find','update-bb','track','/:bot/support','node-zip','createServer','inherit','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Notifications\x20types:\x20','express','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getDate','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','No\x20bots\x20running\x20right\x20now','settings.','\x1b[35m','button','conn','placeOrder','log','reason','cancelLoading','-results.json','show','backup/','user','1000','clientip'];_0x197d=function(){return _0x3543fd;};return _0x197d();}!fs[_0x2ea84e(0x15d)](configbackuppath)&&fs[_0x2ea84e(0x121)](configbackuppath);!fs[_0x2ea84e(0x15d)](logspath)&&fs[_0x2ea84e(0x121)](logspath);!fs[_0x2ea84e(0x15d)](zippath)&&fs[_0x2ea84e(0x121)](zippath);!fs['existsSync'](temppath)&&fs[_0x2ea84e(0x121)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2ea84e(0xf9)]({'bots':[]})[_0x2ea84e(0x215)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2ea84e(0xf9)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2ea84e(0x2aa),'onepagemode':![]}})[_0x2ea84e(0x215)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2ea84e(0xf9)]({'secure':{},'blacklist':[]})[_0x2ea84e(0x215)]();let crypt=new Crypt({'md':_0x2ea84e(0x156),'rsaStandard':_0x2ea84e(0x26e)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2ea84e(0x141)](_0x2ea84e(0xb0),{'host':_0x2ea84e(0x14d)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x2ea84e(0xcf)]!=''&&settings[_0x2ea84e(0xcf)]!=_0x2ea84e(0x1dd))&&settings['telegramUsername']&&settings[_0x2ea84e(0x1bf)]!='')initTelegram();const parseColor=(_0x69ea4e,_0x529b8c)=>{const _0x25c002=_0x2ea84e,_0x56f7e6=/#[A-Z]{3}#/g;if(typeof _0x69ea4e==_0x25c002(0xb8)){!_0x529b8c?_0x69ea4e=_0x69ea4e[_0x25c002(0xe3)](_0x56f7e6,''):(_0x69ea4e=_0x69ea4e['replace'](/#BLU#/g,'\x1b[34m'),_0x69ea4e=_0x69ea4e['replace'](/#RED#/g,'\x1b[31m'),_0x69ea4e=_0x69ea4e[_0x25c002(0xe3)](/#YEL#/g,_0x25c002(0x162)),_0x69ea4e=_0x69ea4e['replace'](/#MAG#/g,_0x25c002(0x1a1)),_0x69ea4e=_0x69ea4e[_0x25c002(0xe3)](/#CYA#/g,_0x25c002(0x1da)),_0x69ea4e=_0x69ea4e['replace'](/#RES#/g,'\x1b[0m'));;}return _0x69ea4e;},logger={'screen':_0x4e3ef2=>{const _0x5d6594=_0x2ea84e;console[_0x5d6594(0x1a5)](parseColor(_0x4e3ef2,!![]));},'simple':_0x3dc5df=>{const _0x105cd2=_0x2ea84e;console[_0x105cd2(0x1a5)](parseColor(_0x3dc5df,!![])),loggerfile[_0x105cd2(0x215)](util[_0x105cd2(0x20a)](parseColor(_0x3dc5df,![]))+'\x0a');},'full':async _0x383f8f=>{const _0x56d0d8=_0x2ea84e,_0x76a3bd=getTimeStamp()+_0x56d0d8(0x2a2)+_0x383f8f;console[_0x56d0d8(0x1a5)](parseColor(_0x76a3bd,!![])),loggerfile['write'](util[_0x56d0d8(0x20a)](parseColor(_0x76a3bd,![]))+'\x0a');if(tgBot&&settings[_0x56d0d8(0x23f)]&&settings['telegramEvents']!=_0x56d0d8(0x190))await sendTelegram(settings[_0x56d0d8(0x23f)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x383f8f,![]));},'debug':async(_0x37a3ca,_0x21e6f1='')=>{const _0x22a9cd=_0x2ea84e,_0x2039d9=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x37a3ca;if(debugging)console[_0x22a9cd(0x1a5)](parseColor(_0x2039d9,!![]));loggerfile[_0x22a9cd(0x215)](util[_0x22a9cd(0x20a)](parseColor(_0x2039d9,![]))+'\x0a');if(_0x21e6f1){if(debugging)console[_0x22a9cd(0x1a5)](_0x21e6f1);loggerfile[_0x22a9cd(0x215)](util['format'](_0x21e6f1)+'\x0a');}}};let terminating=![];process['on'](_0x2ea84e(0x1c6),function(_0x1778ad){logger['simple'](_0x1778ad);}),process['on'](_0x2ea84e(0x158),()=>{stopAllBots();}),process['on'](_0x2ea84e(0x203),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2ea84e(0x2a7))[_0x2ea84e(0x1df)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2ea84e(0x19b)),app=express(),http=require(_0x2ea84e(0x2a0))[_0x2ea84e(0x196)](app);app[_0x2ea84e(0x261)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x2c5977,_0x2e6a8e)=>{const _0x1516d5=_0x2ea84e,_0x489315=_0x2c5977[_0x1516d5(0x223)][_0x1516d5(0x208)],_0x3759f1=getClientsWithBotID(_0x1516d5(0x249)),_0x4f9821=_0x2c5977[_0x1516d5(0x155)][_0x1516d5(0x278)],_0x517001=timelyDecrypt(_0x4f9821,![]),_0x3623a0=_0x3759f1[_0x1516d5(0x191)](_0x3b93e0=>_0x3b93e0['uuid']==_0x517001);if(_0x3623a0){const _0x55b5f7=normalizeIP(_0x2c5977[_0x1516d5(0x1c8)]['remoteAddress'])[_0x1516d5(0xe6)],_0x4af80c=_0x2c5977[_0x1516d5(0x155)][_0x1516d5(0xa9)];if(validateAccess(_0x4af80c,_0x517001,_0x55b5f7)[_0x1516d5(0x114)])_0x489315==_0x1516d5(0x18f)&&await backupConfigFiles(),await zipFiles(_0x489315),_0x2e6a8e[_0x1516d5(0xac)](zippath+(_0x489315+'.zip'),_0x181147=>{const _0x428ddb=_0x1516d5;_0x181147&&(logger[_0x428ddb(0xbe)](_0x428ddb(0xbb)+_0x489315),logger[_0x428ddb(0x119)](_0x181147));});else logger[_0x1516d5(0xbe)](_0x1516d5(0x22a)+_0x489315+_0x1516d5(0x109));}else logger[_0x1516d5(0xbe)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x489315+_0x1516d5(0x122));}),app[_0x2ea84e(0x272)](_0x2ea84e(0x1b1),async(_0x3bd9a0,_0x292c6c)=>{const _0x27b7ea=_0x2ea84e,_0x5d20c8=getClientsWithBotID(_0x27b7ea(0x249)),_0x28ea21=_0x3bd9a0['headers'][_0x27b7ea(0x278)],_0x7e3883=timelyDecrypt(_0x28ea21,![]),_0x4cd2d8=_0x5d20c8[_0x27b7ea(0x191)](_0x5477d9=>_0x5477d9[_0x27b7ea(0x278)]==_0x7e3883);logger[_0x27b7ea(0x26b)](_0x27b7ea(0xaa));if(_0x4cd2d8){const _0x223f5f=normalizeIP(_0x3bd9a0[_0x27b7ea(0x1c8)][_0x27b7ea(0x117)])[_0x27b7ea(0xe6)],_0x473ee9=_0x3bd9a0[_0x27b7ea(0x155)][_0x27b7ea(0xa9)];if(validateAccess(_0x473ee9,_0x7e3883,_0x223f5f)[_0x27b7ea(0x114)]){if(_0x3bd9a0['files']){const _0x428a97=_0x3bd9a0[_0x27b7ea(0x20c)][_0x27b7ea(0x149)];await _0x428a97['mv'](temppath+_0x428a97[_0x27b7ea(0xb6)]),_0x292c6c[_0x27b7ea(0xed)]({'status':!![],'message':_0x27b7ea(0xc7)});const _0x2c907b=getBotsWithMode();_0x2c907b[_0x27b7ea(0x1c3)]>0x0?confirmRestore(temppath,_0x428a97[_0x27b7ea(0xb6)]):unzipFile(temppath,_0x428a97[_0x27b7ea(0xb6)]);}}else logger[_0x27b7ea(0xbe)](_0x27b7ea(0x1f2));}else logger['full'](_0x27b7ea(0x1d3));}),app[_0x2ea84e(0x261)](express[_0x2ea84e(0x13c)](path[_0x2ea84e(0x1d7)](__dirname,bbpath2,_0x2ea84e(0x1d5)))),app[_0x2ea84e(0x261)](express[_0x2ea84e(0x13c)](path[_0x2ea84e(0x1d7)](__dirname,bbpath2,_0x2ea84e(0x209)))),app[_0x2ea84e(0x207)]('/',function(_0x45aea0,_0x115508){const _0x3b859d=_0x2ea84e;_0x115508[_0x3b859d(0x1ec)](path['join'](__dirname,bbpath2,_0x3b859d(0x1d5),_0x3b859d(0xa0)));}),app[_0x2ea84e(0x207)](_0x2ea84e(0x115),function(_0x8979bc,_0x3740ee){const _0x2b1797=_0x2ea84e;_0x3740ee[_0x2b1797(0x1ec)](path[_0x2b1797(0x1d7)](__dirname,bbpath2,_0x2b1797(0x209),_0x2b1797(0xa0)));}),app[_0x2ea84e(0x207)]('/:bot/portfolio',(_0x56a3dd,_0x59e336)=>{const _0x143723=_0x2ea84e;_0x59e336[_0x143723(0x1ec)](path[_0x143723(0x1d7)](__dirname,bbpath2,_0x143723(0x209),_0x143723(0xa0)));}),app[_0x2ea84e(0x207)]('/:bot/performance',(_0x53f7a4,_0x430163)=>{const _0x9e778f=_0x2ea84e;_0x430163['sendFile'](path[_0x9e778f(0x1d7)](__dirname,bbpath2,_0x9e778f(0x209),_0x9e778f(0xa0)));}),app[_0x2ea84e(0x207)](_0x2ea84e(0x22c),(_0x3e991c,_0x40a413)=>{const _0x1416d4=_0x2ea84e;_0x40a413[_0x1416d4(0x1ec)](path['join'](__dirname,bbpath2,_0x1416d4(0x209),_0x1416d4(0xa0)));}),app[_0x2ea84e(0x207)](_0x2ea84e(0x1c0),(_0x49ff12,_0x37d9b2)=>{const _0x5b33f5=_0x2ea84e;_0x37d9b2['sendFile'](path[_0x5b33f5(0x1d7)](__dirname,bbpath2,_0x5b33f5(0x209),'index.html'));}),app['get'](_0x2ea84e(0x2a9),(_0x1d1cb6,_0x265ef9)=>{const _0x7c665f=_0x2ea84e;_0x265ef9[_0x7c665f(0x1ec)](path[_0x7c665f(0x1d7)](__dirname,bbpath2,_0x7c665f(0x209),_0x7c665f(0xa0)));}),app[_0x2ea84e(0x207)](_0x2ea84e(0x194),(_0x427261,_0x2fcdba)=>{const _0xb59e3b=_0x2ea84e;_0x2fcdba[_0xb59e3b(0x1ec)](path['join'](__dirname,bbpath2,_0xb59e3b(0x209),'index.html'));});if(HOST)http[_0x2ea84e(0x133)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1d7b68=_0x2ea84e;let _0x1e1f46=_0x1d7b68(0x154);const _0x257bce=networkInterfaces(),_0x5a2cd1={};for(const _0x1470fd of Object[_0x1d7b68(0x164)](_0x257bce)){for(const _0x569159 of _0x257bce[_0x1470fd]){if((_0x569159[_0x1d7b68(0x179)]==_0x1d7b68(0x11d)||_0x569159[_0x1d7b68(0x179)]==0x4)&&!_0x569159['internal']){const _0x47b27b=ipaddr[_0x1d7b68(0x186)](_0x569159[_0x1d7b68(0x163)])[_0x1d7b68(0x103)]();_0x47b27b!=_0x1d7b68(0xc4)&&(!_0x5a2cd1[_0x1470fd]&&(_0x5a2cd1[_0x1470fd]=[]),_0x5a2cd1[_0x1470fd][_0x1d7b68(0x21b)](_0x569159[_0x1d7b68(0x163)]),_0x1e1f46=_0x569159['address']);}}}return{'serverip':_0x1e1f46,'netinterfaces':_0x5a2cd1};}async function startServer(){const _0x4ee66b=_0x2ea84e,{serverip:_0x163aed,netinterfaces:_0x2c34ff}=getServerIP();logger['simple'](''),logger['simple'](_0x4ee66b(0x20f)),await logger[_0x4ee66b(0xbe)](_0x4ee66b(0x1b4)+serverversion+_0x4ee66b(0x271)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x4ee66b(0x298)+PORT+_0x4ee66b(0x10e))+(_0x4ee66b(0x1f0)+_0x163aed+':'+PORT+_0x4ee66b(0xe1))),logger[_0x4ee66b(0x119)]('-----------------------------------------------------------------------------------');if(config[_0x4ee66b(0x1c3)]!=0x0)for(const _0x48b3d6 of config){const _0x50176e=_0x48b3d6[_0x4ee66b(0x2a8)]==_0x4ee66b(0x1b6)?'a':'m';if(_0x48b3d6[_0x4ee66b(0xc3)]=='enabled'||_0x48b3d6[_0x4ee66b(0xc3)]==_0x4ee66b(0xb4))await logger[_0x4ee66b(0xbe)](_0x4ee66b(0xea)+_0x50176e+_0x4ee66b(0x1c5)+_0x48b3d6['botID']+_0x4ee66b(0x260)+_0x48b3d6['botname']),startBot([_0x48b3d6[_0x4ee66b(0x1d8)],userID],{'cwd':bbpath},function(_0x2738ad){const _0x4ff19f=_0x4ee66b;if(_0x2738ad)logger[_0x4ff19f(0xbe)](_0x2738ad);});else(_0x48b3d6[_0x4ee66b(0xc3)]==_0x4ee66b(0x140)||_0x48b3d6[_0x4ee66b(0xc3)]==_0x4ee66b(0xa8))&&await logger['full'](_0x4ee66b(0x127)+_0x50176e+_0x4ee66b(0x18b)+_0x48b3d6[_0x4ee66b(0x1d8)]+'\x20|\x20'+_0x48b3d6[_0x4ee66b(0x17b)]);}else!newBot&&logger[_0x4ee66b(0x119)](_0x4ee66b(0x19c));if(newBot)addBot();logger['simple'](_0x4ee66b(0x20f)),logger[_0x4ee66b(0x119)](''),await logger[_0x4ee66b(0x26b)](_0x4ee66b(0x22f)+nodeversion),await logger[_0x4ee66b(0x26b)](_0x4ee66b(0x23a),_0x2c34ff);}function startSocket(){io['on']('connection',_0x1c2cf4=>{const _0x4656bf=_0x4058;let _0x23ca2e,_0x36be42,_0x4961dc,_0x562c08,_0x3d241c;const _0x1ef905=_0x1c2cf4[_0x4656bf(0x25f)]['headers'][_0x4656bf(0x20d)];_0x36be42=_0x1ef905[_0x4656bf(0xd9)](/bot[0-9]{3}/);if(_0x36be42)_0x4961dc=_0x36be42[0x0][_0x4656bf(0xd9)](/[0-9]{3}/);if(_0x4961dc)_0x23ca2e=_0x4961dc[0x0];else _0x23ca2e=_0x4656bf(0x249);const _0x3e1c3e=_0x1c2cf4[_0x4656bf(0x25f)][_0x4656bf(0x212)][_0x4656bf(0x1fa)];if(!_0x3e1c3e)_0x1c2cf4[_0x4656bf(0xa6)](_0x4656bf(0xc3),{'publicKey':secure[_0x4656bf(0xbf)]});else{_0x562c08=timelyDecrypt(_0x3e1c3e,![]);if(!_0x562c08)_0x1c2cf4[_0x4656bf(0xa6)](_0x4656bf(0xc3),{'publicKey':secure[_0x4656bf(0xbf)]});else{_0x3d241c=normalizeIP(_0x1c2cf4[_0x4656bf(0x1a3)]['remoteAddress'])['store'];if(!devices[_0x562c08])devices[_0x562c08]={'uuid':_0x562c08,'access':{'token':null}};devices[_0x562c08]['ip']=_0x3d241c;const _0x13745f=addClient(_0x1c2cf4['id'],_0x562c08,_0x23ca2e);setAccess(_0x13745f),emitMessages(),_0x1c2cf4['on'](_0x4656bf(0x26a),_0x5ebbb5=>{const _0x2a2335=_0x4656bf,_0x236aa9=timelyDecrypt(_0x5ebbb5[_0x2a2335(0x293)]);if(_0x236aa9){_0x5ebbb5={'username':_0x5ebbb5['username'],'password':_0x236aa9},devices[_0x562c08]['access']=validateCredentials(_0x5ebbb5,_0x562c08);if(devices[_0x562c08][_0x2a2335(0x279)][_0x2a2335(0x114)]==![]&&devices[_0x562c08]['access'][_0x2a2335(0x1a6)]==_0x2a2335(0x1cb))_0x1c2cf4[_0x2a2335(0xa6)](_0x2a2335(0xc3),{'access':devices[_0x562c08][_0x2a2335(0x279)]}),loginAccess2FA(_0x562c08,_0x3d241c);else{if(devices[_0x562c08][_0x2a2335(0x279)][_0x2a2335(0x114)]==![]&&devices[_0x562c08][_0x2a2335(0x279)][_0x2a2335(0x1a6)]=='invalid\x20credentials')_0x1c2cf4['emit'](_0x2a2335(0xc3),{'access':devices[_0x562c08][_0x2a2335(0x279)]});else devices[_0x562c08]['access'][_0x2a2335(0x114)]&&devices[_0x562c08][_0x2a2335(0x279)][_0x2a2335(0x1a6)]==_0x2a2335(0x171)&&(getClientsWithUuid(_0x562c08)['forEach'](_0x272211=>{setAccess(_0x272211);}),logger[_0x2a2335(0x26b)](_0x2a2335(0x145)+_0x562c08['slice'](-0x8)),setTokenRefresh(_0x562c08),setSessionTimeout(_0x2a2335(0x26a),_0x562c08));}}else logger[_0x2a2335(0xbe)](_0x2a2335(0x219));}),_0x1c2cf4['on'](_0x4656bf(0xd0),()=>{resetPassword();}),_0x1c2cf4['on'](_0x4656bf(0x216),_0x37b724=>{removeClient(_0x1c2cf4['id']);}),_0x23ca2e==_0x4656bf(0x249)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x261129){const _0x44940e=_0x2ea84e;if(_0x261129!=_0x44940e(0x249)&&config[_0x44940e(0x168)]!=''){if(pid[_0x261129])pid[_0x261129][_0x44940e(0xed)]({'function':_0x44940e(0x238),'args':null});}_0x261129!=_0x44940e(0x249)&&broadcastToBots(_0x44940e(0x2a1),JSON[_0x44940e(0x15b)](config));}function reloadBotManager(){const _0x457b64=_0x2ea84e;getClientsWithBotID('botmanager')[_0x457b64(0xb1)](_0x5ca8ab=>{const _0x4071fa=_0x457b64;getSocket(_0x5ca8ab['id'])[_0x4071fa(0xa6)](_0x4071fa(0xc3),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0xfb9cc5){const _0x4538a3=_0x2ea84e;return io[_0x4538a3(0x248)][_0x4538a3(0x248)]['get'](_0xfb9cc5);}function setAccess(_0x360fa1){const _0x191c61=_0x2ea84e,_0x25bb35=getSocket(_0x360fa1['id']),_0x114519=_0x360fa1[_0x191c61(0x278)],_0x424968=_0x360fa1[_0x191c61(0x233)];devices[_0x114519]['access']=validateAccess(devices[_0x114519][_0x191c61(0x279)][_0x191c61(0xc2)],_0x114519),logger['debug']('Setting\x20access:\x20'+devices[_0x114519][_0x191c61(0x279)][_0x191c61(0x1a6)]+'\x20|\x20client:\x20...'+_0x360fa1['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x114519[_0x191c61(0x22e)](-0x8)),_0x25bb35[_0x191c61(0x1d7)](_0x114519);if(devices[_0x114519]['access'][_0x191c61(0x114)]){_0x25bb35[_0x191c61(0x1d7)](_0x424968);if(_0x424968==_0x191c61(0x249))initializeSocketBotManager(_0x25bb35);else initializeSocketBot(_0x25bb35);initClient(_0x424968);}devices[_0x114519][_0x191c61(0x279)]['token']&&devices[_0x114519]['access'][_0x191c61(0x1a6)]==_0x191c61(0x16d)&&setSessionTimeout('2FA',_0x114519),devices[_0x114519]['access'][_0x191c61(0xc2)]&&devices[_0x114519][_0x191c61(0x279)][_0x191c61(0x1a6)]==_0x191c61(0x185)&&setSessionTimeout(_0x191c61(0x26a),_0x114519),_0x25bb35[_0x191c61(0xa6)](_0x191c61(0xc3),{'status':_0x360fa1['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x114519]['access'],'externalip':devices[_0x114519]['ip'],'publicKey':secure[_0x191c61(0xbf)],'userid':settings[_0x191c61(0x1fc)],'validInstallation':validInstallation}),devices[_0x114519][_0x191c61(0x279)][_0x191c61(0x114)]==![]&&devices[_0x114519]['access'][_0x191c61(0x1a6)]==_0x191c61(0x25d)&&temporaryAccess2FA(_0x114519,devices[_0x114519]['ip']);}function setSessionTimeout(_0x1abe94,_0x1e6708){const _0x38501c=_0x2ea84e;let _0x5c268a;if(_0x1abe94=='login')_0x5c268a=loginExpiry*0x3c*0x3e8;else _0x5c268a=devices[_0x1e6708]['telegramIpApproval'][_0x38501c(0x29e)]*0x3c*0x3e8-(new Date()[_0x38501c(0x27e)]()-devices[_0x1e6708][_0x38501c(0x1b7)]['timestamp']);if(devices[_0x1e6708][_0x38501c(0x1bc)])clearTimeout(devices[_0x1e6708][_0x38501c(0x1bc)]);devices[_0x1e6708][_0x38501c(0x1bc)]=setTimeout(()=>{const _0x337ea8=_0x38501c;if(devices[_0x1e6708]['pidRefreshToken'])clearTimeout(devices[_0x1e6708][_0x337ea8(0x1d0)]);removeSocketListeners(_0x1e6708),addBlacklist(_0x1e6708),devices[_0x1e6708][_0x337ea8(0x1b7)]=null,devices[_0x1e6708]['telegram2FaApproval']=null,devices[_0x1e6708][_0x337ea8(0x279)][_0x337ea8(0xc2)]=null,logger[_0x337ea8(0x26b)](_0x337ea8(0x148)+_0x1e6708['slice'](-0x8)),devices[_0x1e6708][_0x337ea8(0x279)]=validateAccess(devices[_0x1e6708]['access'][_0x337ea8(0xc2)],_0x1e6708),!(devices[_0x1e6708][_0x337ea8(0x279)][_0x337ea8(0x114)]&&devices[_0x1e6708][_0x337ea8(0x279)][_0x337ea8(0x1a6)]==_0x337ea8(0x135))&&(_0x1abe94==_0x337ea8(0x26a)?io['to'](_0x1e6708)[_0x337ea8(0xa6)](_0x337ea8(0xc3),{'access':{'allow':![],'reason':_0x337ea8(0x10c),'token':null}}):io['to'](_0x1e6708)['emit']('status',{'access':{'allow':![],'reason':_0x337ea8(0x218),'token':null}})),devices[_0x1e6708]['access'][_0x337ea8(0xc2)]=null;},_0x5c268a);}function setTokenRefresh(_0x6b43f4){const _0x3a0ead=_0x2ea84e;if(devices[_0x6b43f4][_0x3a0ead(0x1d0)])clearTimeout(devices[_0x6b43f4][_0x3a0ead(0x1d0)]);devices[_0x6b43f4]['pidRefreshToken']=setTimeout(()=>{const _0x4c1b71=_0x3a0ead;getClientsWithUuid(_0x6b43f4)['length']!=0x0?(devices[_0x6b43f4]['access']=refreshToken(_0x6b43f4),io['to'](_0x6b43f4)[_0x4c1b71(0xa6)](_0x4c1b71(0xc3),{'status':_0x4c1b71(0x167),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x6b43f4][_0x4c1b71(0x279)],'externalip':devices[_0x6b43f4]['ip'],'publicKey':secure[_0x4c1b71(0xbf)],'validInstallation':validInstallation}),setTokenRefresh(_0x6b43f4)):clearTimeout(devices[_0x6b43f4][_0x4c1b71(0x1d0)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2ebed4){const _0xb07591=_0x2ea84e,_0x2ecb33=getClient(_0x2ebed4['id'])[_0xb07591(0x278)];_0x2ebed4['emit']('bots',config),_0x2ebed4[_0xb07591(0xa6)](_0xb07591(0x9c),cleanSettings()),_0x2ebed4['on']('add-bot',_0x2ae607=>{const _0x2359c1=_0xb07591;if(validateAccess(_0x2ae607,_0x2ecb33)[_0x2359c1(0x114)])addBot();else logger[_0x2359c1(0xbe)](_0x2359c1(0xd7));}),_0x2ebed4['on'](_0xb07591(0x13e),(_0x4446fc,_0xd38797)=>{const _0x1173a9=_0xb07591;if(validateAccess(_0xd38797,_0x2ecb33)[_0x1173a9(0x114)])toggleBot(_0x4446fc['botID'],_0x4446fc[_0x1173a9(0xc3)],_0x4446fc['live']);else logger[_0x1173a9(0xbe)](_0x1173a9(0x204));}),_0x2ebed4['on'](_0xb07591(0xe9),(_0x56eae7,_0x449726)=>{const _0x2baba3=_0xb07591;if(validateAccess(_0x449726,_0x2ecb33)[_0x2baba3(0x114)])toggleBotMode(_0x56eae7);else logger['full'](_0x2baba3(0x204));}),_0x2ebed4['on'](_0xb07591(0x20b),(_0x348aef,_0x2a91c8)=>{const _0x45a3e3=_0xb07591;if(validateAccess(_0x2a91c8,_0x2ecb33)['allow'])deleteBot(_0x348aef);else logger[_0x45a3e3(0xbe)](_0x45a3e3(0x295));}),_0x2ebed4['on'](_0xb07591(0x153),(_0x368d44,_0xc44cd4)=>{const _0x30e2b8=_0xb07591;if(validateAccess(_0xc44cd4,_0x2ecb33)[_0x30e2b8(0x114)])storeSettings(_0x368d44,!![]);else logger['full'](_0x30e2b8(0x25c));}),_0x2ebed4['on'](_0xb07591(0x192),_0x3a3c67=>{const _0x50392a=_0xb07591;if(validateAccess(_0x3a3c67,_0x2ecb33)[_0x50392a(0x114)])updateBB(_0x50392a(0x16e));else logger[_0x50392a(0xbe)](_0x50392a(0x273));}),_0x2ebed4['on'](_0xb07591(0x12d),_0x93af3e=>{const _0x94c2a9=_0xb07591;if(validateAccess(_0x93af3e,_0x2ecb33)['allow'])updateBB('reinstall');else logger[_0x94c2a9(0xbe)](_0x94c2a9(0xa2));}),_0x2ebed4['on'](_0xb07591(0x17e),_0x2eac67=>{const _0x577adf=_0xb07591;if(validateAccess(_0x2eac67,_0x2ecb33)['allow']){const _0x5aa734=getClient(_0x2ebed4['id']);if(_0x5aa734)getBackupFiles(_0x5aa734[_0x577adf(0x278)]);else logger['full'](_0x577adf(0xf8));}else logger[_0x577adf(0xbe)](_0x577adf(0xf6));}),_0x2ebed4['on'](_0xb07591(0x151),(_0x20db66,_0x53c5a8)=>{const _0x220dfc=_0xb07591;if(validateAccess(_0x53c5a8,_0x2ecb33)[_0x220dfc(0x114)])restoreBackupFile(_0x20db66);else logger[_0x220dfc(0xbe)](_0x220dfc(0x199));}),_0x2ebed4['on'](_0xb07591(0xbd),_0x51786b=>{const _0x1d5152=_0xb07591;if(validateAccess(_0x51786b,_0x2ecb33)[_0x1d5152(0x114)])getMessages();else logger[_0x1d5152(0xbe)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2ebed4['on'](_0xb07591(0x29a),(_0x1a2fa4,_0x234bb2)=>{const _0x22957f=_0xb07591;if(validateAccess(_0x234bb2,_0x2ecb33)[_0x22957f(0x114)])confirmMessage(_0x1a2fa4);else logger[_0x22957f(0xbe)](_0x22957f(0xa7));}),_0x2ebed4['on'](_0xb07591(0xee),_0x1934bf=>{const _0xcabde9=_0xb07591;if(validateAccess(_0x1934bf,_0x2ecb33)[_0xcabde9(0x114)]){if(devices[_0x2ecb33][_0xcabde9(0x1d0)])clearTimeout(devices[_0x2ecb33][_0xcabde9(0x1d0)]);if(devices[_0x2ecb33][_0xcabde9(0x1bc)])clearTimeout(devices[_0x2ecb33][_0xcabde9(0x1bc)]);removeSocketListeners(getClient(_0x2ebed4['id'])[_0xcabde9(0x278)]),addBlacklist(_0x2ecb33),devices[_0x2ecb33][_0xcabde9(0x1b7)]=null,devices[_0x2ecb33][_0xcabde9(0xad)]=null,devices[_0x2ecb33][_0xcabde9(0x279)][_0xcabde9(0xc2)]=null,logger[_0xcabde9(0x26b)](_0xcabde9(0xb5)+_0x2ecb33[_0xcabde9(0x22e)](-0x8)),io['to'](getClient(_0x2ebed4['id'])[_0xcabde9(0x278)])[_0xcabde9(0xa6)](_0xcabde9(0xc3),{'access':{'allow':![],'reason':_0xcabde9(0x1e4),'token':null}});}else logger[_0xcabde9(0xbe)](_0xcabde9(0x143));});}function initializeSocketBot(_0x763c36){const _0x553dae=_0x2ea84e,_0x9e9958=getClient(_0x763c36['id'])[_0x553dae(0x233)],_0x49435e=getClient(_0x763c36['id'])['uuid'];_0x763c36['on'](_0x553dae(0x1f6),(_0x52aa24,_0x1ed42a)=>{const _0xb92ed8=_0x553dae;if(validateAccess(_0x1ed42a,_0x49435e)[_0xb92ed8(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958][_0xb92ed8(0xed)]({'function':_0xb92ed8(0x18d),'args':_0x52aa24});}else logger[_0xb92ed8(0xbe)](_0xb92ed8(0xd3));}),_0x763c36['on'](_0x553dae(0x9f),(_0x483d93,_0xd01dc0)=>{const _0x5d75c7=_0x553dae;if(validateAccess(_0xd01dc0,_0x49435e)['allow']){if(pid[_0x9e9958])pid[_0x9e9958]['send']({'function':'deleteHistoryAlerts','args':_0x483d93});}else logger['full'](_0x5d75c7(0x1b0));}),_0x763c36['on'](_0x553dae(0x130),(_0x456279,_0x1fbba8)=>{const _0x38d9bb=_0x553dae;if(validateAccess(_0x1fbba8,_0x49435e)[_0x38d9bb(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958]['send']({'function':_0x38d9bb(0x211),'args':_0x456279});}else logger[_0x38d9bb(0xbe)](_0x38d9bb(0x297));}),_0x763c36['on'](_0x553dae(0xf5),(_0x10e7a5,_0x43e44d)=>{const _0xdd7e75=_0x553dae;if(validateAccess(_0x43e44d,_0x49435e)['allow']){if(pid[_0x9e9958])pid[_0x9e9958]['send']({'function':_0xdd7e75(0x1eb),'args':_0x10e7a5});}else logger[_0xdd7e75(0xbe)](_0xdd7e75(0x1b8));}),_0x763c36['on'](_0x553dae(0x125),(_0x3bb916,_0x10cd94)=>{const _0x422048=_0x553dae;if(validateAccess(_0x10cd94,_0x49435e)[_0x422048(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958][_0x422048(0xed)]({'function':_0x422048(0x285),'args':_0x3bb916});}else logger[_0x422048(0xbe)](_0x422048(0xfa));}),_0x763c36['on'](_0x553dae(0x184),(_0x3c24c6,_0x1bc35e)=>{const _0x5ce5dc=_0x553dae;if(validateAccess(_0x1bc35e,_0x49435e)[_0x5ce5dc(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958][_0x5ce5dc(0xed)]({'function':_0x5ce5dc(0xa3),'args':_0x3c24c6});}else logger[_0x5ce5dc(0xbe)](_0x5ce5dc(0x108));}),_0x763c36['on'](_0x553dae(0x269),_0x38fae1=>{const _0x982a9=_0x553dae;if(validateAccess(_0x38fae1,_0x49435e)['allow']){if(pid[_0x9e9958])pid[_0x9e9958]['send']({'function':_0x982a9(0x221),'args':null});}else logger[_0x982a9(0xbe)](_0x982a9(0x230));}),_0x763c36['on']('get-starting-balances',_0x59abb9=>{const _0x46f692=_0x553dae;if(validateAccess(_0x59abb9,_0x49435e)[_0x46f692(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958][_0x46f692(0xed)]({'function':_0x46f692(0x14c),'args':null});}else logger[_0x46f692(0xbe)](_0x46f692(0xa1));}),_0x763c36['on']('place-order',(_0x47ae8d,_0xea3767)=>{const _0x2a8688=_0x553dae;if(validateAccess(_0xea3767,_0x49435e)[_0x2a8688(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958]['send']({'function':_0x2a8688(0x1a4),'args':_0x47ae8d});}else logger[_0x2a8688(0xbe)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x763c36['on'](_0x553dae(0x150),_0x84c41=>{const _0x273ff9=_0x553dae;if(validateAccess(_0x84c41,_0x49435e)[_0x273ff9(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958][_0x273ff9(0xed)]({'function':_0x273ff9(0x1a7),'args':null});}else logger[_0x273ff9(0xbe)](_0x273ff9(0xe2));}),_0x763c36['on'](_0x553dae(0xfe),_0x55f873=>{const _0x214aa9=_0x553dae;if(validateAccess(_0x55f873,_0x49435e)[_0x214aa9(0x114)]){if(pid[_0x9e9958])pid[_0x9e9958][_0x214aa9(0xed)]({'function':_0x214aa9(0xe7),'args':null});}else logger[_0x214aa9(0xbe)](_0x214aa9(0x23d));}),_0x763c36['on'](_0x553dae(0x192),_0x4abd40=>{const _0x1e1995=_0x553dae;if(validateAccess(_0x4abd40,_0x49435e)[_0x1e1995(0x114)])updateBB('update');else logger['full'](_0x1e1995(0x273));}),_0x763c36['on']('get-messages',_0x58539a=>{const _0x16c494=_0x553dae;if(validateAccess(_0x58539a,_0x49435e)[_0x16c494(0x114)])getMessages();else logger[_0x16c494(0xbe)](_0x16c494(0x21a));}),_0x763c36['on'](_0x553dae(0x29a),(_0x17b353,_0x50bd01)=>{const _0xbaddf9=_0x553dae;if(validateAccess(_0x50bd01,_0x49435e)[_0xbaddf9(0x114)])confirmMessage(_0x17b353);else logger[_0xbaddf9(0xbe)](_0xbaddf9(0xa7));}),_0x763c36['on']('logout',_0x28ab06=>{const _0x2ea6cc=_0x553dae;if(validateAccess(_0x28ab06,_0x49435e)[_0x2ea6cc(0x114)]){if(devices[_0x49435e]['pidRefreshToken'])clearTimeout(devices[_0x49435e][_0x2ea6cc(0x1d0)]);if(devices[_0x49435e]['pidExpireLogin'])clearTimeout(devices[_0x49435e][_0x2ea6cc(0x1bc)]);removeSocketListeners(getClient(_0x763c36['id'])[_0x2ea6cc(0x278)]),addBlacklist(_0x49435e),devices[_0x49435e][_0x2ea6cc(0x1b7)]=null,devices[_0x49435e]['telegram2FaApproval']=null,devices[_0x49435e][_0x2ea6cc(0x279)][_0x2ea6cc(0xc2)]=null,logger[_0x2ea6cc(0x26b)](_0x2ea6cc(0xb5)+_0x49435e[_0x2ea6cc(0x22e)](-0x8)),io['to'](getClient(_0x763c36['id'])[_0x2ea6cc(0x278)])[_0x2ea6cc(0xa6)](_0x2ea6cc(0xc3),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x2ea6cc(0xbe)](_0x2ea6cc(0x143));});}function removeSocketListeners(_0x2c495c){const _0x188b67=_0x2ea84e;getClientsWithUuid(_0x2c495c)[_0x188b67(0xb1)](_0x343d85=>{getSocket(_0x343d85['id'])['removeAllListeners']();});}function cleanSettings(){const _0x40c423=_0x2ea84e;let _0xc8442b=settings;return settings[_0x40c423(0xcf)]&&settings[_0x40c423(0xcf)]!=''&&(_0xc8442b={..._0xc8442b,'telegramToken':'************'}),settings[_0x40c423(0x210)]&&settings['bbPassword']!=''&&(_0xc8442b={..._0xc8442b,'bbPassword':_0x40c423(0x2a3)}),(settings['bbPassword']&&settings[_0x40c423(0x210)]==_0x40c423(0x1dd)||settings[_0x40c423(0xcf)]&&settings['telegramToken']==_0x40c423(0x1dd))&&(_0xc8442b={..._0xc8442b,'restored':{'password':settings[_0x40c423(0x210)]=='***','telegram':settings['telegramToken']=='***'}}),_0xc8442b;}async function updateBB(_0x1e3cd5){const _0x1f870c=_0x2ea84e;await backupConfigFiles(),installingUpdate=!![],config[_0x1f870c(0xb1)](_0x407e6c=>{const _0x1861e3=_0x1f870c;restartBot(_0x407e6c[_0x1861e3(0x1d8)]);});if(_0x1e3cd5==_0x1f870c(0x16e))process[_0x1f870c(0xed)]({'update':!![],'environment':environment},_0xd27cef=>{});else _0x1e3cd5==_0x1f870c(0xcb)&&process['send']({'reinstall':!![],'environment':environment},_0x2dd518=>{});}function startBot(_0x11fb2f,_0x2add50,_0x360f9b){const _0x5ab3cb=_0x2ea84e;if(debugging)_0x11fb2f[_0x5ab3cb(0x21b)]('-d');let _0x31887f=![];const _0x86883=_0x11fb2f[0x0];_0x2add50={..._0x2add50,'stdio':[_0x5ab3cb(0x197),'inherit',_0x5ab3cb(0x197),'ipc']},pid[_0x86883]=childProcess[_0x5ab3cb(0xd2)](botfile,_0x11fb2f,_0x2add50),pid[_0x86883]['on'](_0x5ab3cb(0x232),_0x4ec95a=>{const _0x4bf765=_0x5ab3cb;switch(Object[_0x4bf765(0x164)](_0x4ec95a)[0x0]){case _0x4bf765(0x17b):updateBotName(_0x86883,_0x4ec95a[_0x4bf765(0x17b)]);break;case _0x4bf765(0x265):updateBotManager();break;case _0x4bf765(0xc3):updateStatus(_0x86883,_0x4ec95a['status']);break;case _0x4bf765(0x1b5):updateLive(_0x86883,_0x4ec95a['live']);break;case'started':updateLive(_0x86883,_0x4ec95a[_0x4bf765(0x294)]),io['to'](_0x86883)[_0x4bf765(0xa6)](_0x4bf765(0xc3),{'access':{'allow':![],'reason':_0x4bf765(0xf0),'token':null}});break;case _0x4bf765(0x1f5):_0x4ec95a['stop']==_0x4bf765(0x1ba)&&restartBot(_0x86883);_0x4ec95a[_0x4bf765(0x1f5)]=='kill'&&toggleBot(_0x86883,_0x4bf765(0x140),_0x4bf765(0x26d));break;case _0x4bf765(0x13a):sendTelegramBot(_0x86883,_0x4ec95a['telegram']);break;case _0x4bf765(0x10f):sendTelegramMsg(_0x4ec95a[_0x4bf765(0x10f)]);break;case _0x4bf765(0x231):io['to'](_0x86883)[_0x4bf765(0xa6)](_0x4ec95a[_0x4bf765(0x231)],_0x4ec95a[_0x4bf765(0x24c)]);break;}}),pid[_0x86883]['on'](_0x5ab3cb(0x213),function(_0x109d93){if(_0x31887f)return;_0x31887f=!![],_0x360f9b(_0x109d93);}),pid[_0x86883]['on'](_0x5ab3cb(0x158),async function(_0x419dc6){const _0x3100b4=_0x5ab3cb;if(terminating)return;if(installingUpdate){logger['debug']('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x3100b4(0x1db)]();return;}if(_0x31887f)return;_0x31887f=!![],_0x360f9b(null);const _0x3f5a35=dbConfig[_0x3100b4(0x207)](_0x3100b4(0x2a1))[_0x3100b4(0x191)]({'botID':_0x86883})[_0x3100b4(0x1b3)]();_0x3f5a35&&(_0x3f5a35[_0x3100b4(0xc3)]==_0x3100b4(0xe5)||_0x3f5a35[_0x3100b4(0xc3)]==_0x3100b4(0xb4))&&(await sleep(0x3e8),updateLive(_0x86883,_0x3100b4(0x26d)),logger['full'](_0x3100b4(0x220)+_0x86883),startBot([_0x86883,userID],{'cwd':bbpath},function(_0x1cd5bb){if(_0x1cd5bb)logger['full'](_0x1cd5bb);}));});}function stopBot(_0x14e37d){const _0x28bcf5=_0x2ea84e;getClientsWithBotID(_0x14e37d)[_0x28bcf5(0xb1)](_0x5294cb=>{getSocket(_0x5294cb['id'])['disconnect'](!![]),removeClient(_0x5294cb['id']);}),pid[_0x14e37d]&&(pid[_0x14e37d]['kill'](),pid[_0x14e37d]=null);}function stopAllBots(){const _0x425497=_0x2ea84e;terminating=!![];const _0x3a73a1=getEnabledBots();_0x3a73a1[_0x425497(0xb1)](_0x40c425=>{const _0x385e64=_0x425497;stopBot(_0x40c425[_0x385e64(0x1d8)]);});}function restartBot(_0x390bc9){const _0x26cc2e=_0x2ea84e;if(pid[_0x390bc9])pid[_0x390bc9][_0x26cc2e(0x106)]();}function addBot(){const _0x64b734=_0x2ea84e;let _0x5728ed;for(let _0x50fde3=0x1;_0x50fde3<0x3e9;_0x50fde3++){_0x5728ed=_0x50fde3[_0x64b734(0x105)]()[_0x64b734(0xc8)](0x3,'0');let _0x56dab3=config[_0x64b734(0x191)](_0x4fcc44=>_0x4fcc44[_0x64b734(0x1d8)]==_0x5728ed);if(!_0x56dab3)break;}if(_0x5728ed===_0x64b734(0x1ac)){logger['full'](_0x64b734(0x202));return;}logger[_0x64b734(0xbe)](_0x64b734(0x169)+_0x5728ed),dbConfig[_0x64b734(0x207)](_0x64b734(0x2a1))[_0x64b734(0x21b)]({'botID':_0x5728ed,'botname':_0x64b734(0x17c)+_0x5728ed,'status':_0x64b734(0xb4),'live':''})[_0x64b734(0x215)](),startBot([_0x5728ed,userID],{'cwd':bbpath},function(_0x2d7d20){const _0x45554a=_0x64b734;if(_0x2d7d20)logger[_0x45554a(0xbe)](_0x2d7d20);}),config=getConfiguration(),io['to'](_0x64b734(0x249))['emit'](_0x64b734(0x2a1),config),broadcastToBots(_0x64b734(0x2a1),JSON[_0x64b734(0x15b)](config));}function deleteBot(_0x1981e1){const _0x40048d=_0x2ea84e;getClientsWithBotID(_0x1981e1)[_0x40048d(0xb1)](_0x3ba04b=>{getSocket(_0x3ba04b['id'])['disconnect'](!![]),removeClient(_0x3ba04b['id']);}),dbConfig[_0x40048d(0x207)](_0x40048d(0x2a1))[_0x40048d(0xce)]({'botID':_0x1981e1})['write'](),logger[_0x40048d(0xbe)]('Deleted\x20Bot\x20'+_0x1981e1),stopBot(_0x1981e1);try{if(fs['existsSync'](path['join'](configpath,'bot-'+_0x1981e1+_0x40048d(0x2a6))))fs[_0x40048d(0x12a)](path[_0x40048d(0x1d7)](configpath,_0x40048d(0x12f)+_0x1981e1+'-config.json'));if(fs[_0x40048d(0x15d)](path[_0x40048d(0x1d7)](configpath,_0x40048d(0x12f)+_0x1981e1+_0x40048d(0xd1))))fs[_0x40048d(0x12a)](path[_0x40048d(0x1d7)](configpath,_0x40048d(0x12f)+_0x1981e1+_0x40048d(0xd1)));if(fs[_0x40048d(0x15d)](path[_0x40048d(0x1d7)](configpath,'bot-'+_0x1981e1+_0x40048d(0x1f7))))fs[_0x40048d(0x12a)](path[_0x40048d(0x1d7)](configpath,'bot-'+_0x1981e1+_0x40048d(0x1f7)));if(fs['existsSync'](path[_0x40048d(0x1d7)](configpath,'bot-'+_0x1981e1+_0x40048d(0x1a8))))fs[_0x40048d(0x12a)](path['join'](configpath,_0x40048d(0x12f)+_0x1981e1+'-results.json'));}catch(_0x1d8080){if(_0x1d8080)logger['full'](_0x40048d(0x29f),_0x1d8080);}config=getConfiguration(),io['to'](_0x40048d(0x249))[_0x40048d(0xa6)](_0x40048d(0x2a1),config),broadcastToBots(_0x40048d(0x2a1),JSON[_0x40048d(0x15b)](config));}function toggleBot(_0x3efd15,_0x4001b4,_0x368270){const _0x140fe8=_0x2ea84e;dbConfig[_0x140fe8(0x207)](_0x140fe8(0x2a1))['find']({'botID':_0x3efd15})[_0x140fe8(0x254)]({'status':_0x4001b4})['assign']({'live':_0x368270})[_0x140fe8(0x215)]();if(_0x4001b4=='enabled'||_0x4001b4==_0x140fe8(0xb4))logger['full'](_0x140fe8(0x100)+_0x3efd15),startBot([_0x3efd15,userID],{'cwd':bbpath},function(_0x1d9bd2){const _0x4f6504=_0x140fe8;if(_0x1d9bd2)logger[_0x4f6504(0xbe)](_0x1d9bd2);});else(_0x4001b4==_0x140fe8(0x140)||_0x4001b4==_0x140fe8(0xa8))&&(logger[_0x140fe8(0xbe)](_0x140fe8(0x1e6)+_0x3efd15),stopBot(_0x3efd15));config=getConfiguration(),io['to'](_0x140fe8(0x249))[_0x140fe8(0xa6)](_0x140fe8(0x2a1),config),broadcastToBots(_0x140fe8(0x2a1),JSON[_0x140fe8(0x15b)](config));}function toggleStatus(_0x43080e){const _0x502e31=_0x2ea84e;let _0x1ea46b=dbConfig[_0x502e31(0x207)]('bots')[_0x502e31(0x191)]({'botID':_0x43080e})[_0x502e31(0x1b3)](),_0x3b966c;if(_0x1ea46b[_0x502e31(0xc3)]===_0x502e31(0xe5))_0x3b966c='disabled';else{if(_0x1ea46b[_0x502e31(0xc3)]===_0x502e31(0xb4))_0x3b966c=_0x502e31(0xa8);else{if(_0x1ea46b['status']===_0x502e31(0xa8))_0x3b966c='new';else{if(_0x1ea46b[_0x502e31(0xc3)]===_0x502e31(0x140))_0x3b966c=_0x502e31(0xe5);}}}return _0x3b966c;}function updateStatus(_0x1ab7e8,_0x3ac7d5){const _0x930e62=_0x2ea84e;dbConfig[_0x930e62(0x207)](_0x930e62(0x2a1))['find']({'botID':_0x1ab7e8})['assign']({'status':_0x3ac7d5})[_0x930e62(0x215)](),config=getConfiguration(),io['to'](_0x930e62(0x249))[_0x930e62(0xa6)](_0x930e62(0x2a1),config),broadcastToBots(_0x930e62(0x2a1),JSON[_0x930e62(0x15b)](config));}function updateLive(_0x4ccb0d,_0x200454){const _0x56356d=_0x2ea84e;dbConfig['get'](_0x56356d(0x2a1))['find']({'botID':_0x4ccb0d})[_0x56356d(0x254)]({'live':_0x200454})[_0x56356d(0x215)](),config=getConfiguration(),io['to'](_0x56356d(0x249))[_0x56356d(0xa6)](_0x56356d(0x2a1),config),broadcastToBots(_0x56356d(0x2a1),JSON[_0x56356d(0x15b)](config));}function updateBotName(_0x22761d,_0x5e61ef){const _0xb70f76=_0x2ea84e;dbConfig[_0xb70f76(0x207)](_0xb70f76(0x2a1))[_0xb70f76(0x191)]({'botID':_0x22761d})['assign']({'botname':_0x5e61ef})[_0xb70f76(0x215)](),config=getConfiguration(),io['to'](_0xb70f76(0x249))[_0xb70f76(0xa6)](_0xb70f76(0x2a1),config),broadcastToBots(_0xb70f76(0x2a1),JSON[_0xb70f76(0x15b)](config));}function updateBotManager(){const _0x4199c6=_0x2ea84e;config=getConfiguration(),io['to']('botmanager')['emit'](_0x4199c6(0x2a1),config),broadcastToBots(_0x4199c6(0x2a1),JSON['stringify'](config));}function toggleBotMode(_0x3f3924){const _0x30469d=_0x2ea84e;if(pid[_0x3f3924])pid[_0x3f3924][_0x30469d(0xed)]({'function':_0x30469d(0x11e),'args':null});else{const _0xc29815=configpath+_0x30469d(0x12f)+_0x3f3924+_0x30469d(0x2a6),_0x160810=fs[_0x30469d(0x236)](_0xc29815),_0xfd493=JSON[_0x30469d(0x186)](_0x160810),_0x5882ee=_0xfd493['bot'][0x0][_0x30469d(0x296)];_0xfd493['bot'][0x0][_0x30469d(0x296)]=!_0x5882ee;const _0x37e6f1=JSON[_0x30469d(0x15b)](_0xfd493,null,0x2);fs[_0x30469d(0x21d)](_0xc29815,_0x37e6f1),config=getConfiguration(),io['to']('botmanager')['emit'](_0x30469d(0x2a1),config),broadcastToBots('bots',JSON[_0x30469d(0x15b)](config));}}function validateTelegram(_0x3e9fbb){const _0x5a71eb=_0x2ea84e;if(_0x3e9fbb['from'][_0x5a71eb(0xef)]!=settings[_0x5a71eb(0x1bf)]&&'@'+_0x3e9fbb[_0x5a71eb(0x21e)]['username']!=settings[_0x5a71eb(0x1bf)]||_0x3e9fbb[_0x5a71eb(0x160)]['id']!=settings[_0x5a71eb(0x23f)])return sendTelegram(_0x3e9fbb[_0x5a71eb(0x160)]['id'],_0x5a71eb(0x19e),{'parse_mode':_0x5a71eb(0x290)}),![];return!![];}async function initTelegram(){const _0x55993d=_0x2ea84e;if(tgBot)tgBot[_0x55993d(0x1f5)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x55993d(0xcf)]);let _0x4f88b2=_0x55993d(0x129);_0x4f88b2+='\x0a',_0x4f88b2+=_0x55993d(0x10a),_0x4f88b2+='/disable\x20-\x20disable\x20notifications\x0a',_0x4f88b2+=_0x55993d(0x123),_0x4f88b2+=_0x55993d(0x15f),_0x4f88b2+=_0x55993d(0x13f),_0x4f88b2+=_0x55993d(0x22d),_0x4f88b2+=_0x55993d(0x282),_0x4f88b2+='/names\x20-\x20show\x20bot\x20names\x0a',_0x4f88b2+=_0x55993d(0xfd),_0x4f88b2+=_0x55993d(0x128),_0x4f88b2+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x4f88b2+=_0x55993d(0x1ae),_0x4f88b2+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x4f88b2+=_0x55993d(0x104);let _0x359cfe=_0x55993d(0x110);_0x359cfe+='\x0a',_0x359cfe+=_0x4f88b2,tgBot[_0x55993d(0xf7)]((_0x573804,_0x15add4)=>{const _0x4ac82d=_0x55993d;logger['simple'](getTimeStamp()+_0x4ac82d(0x1f9)),logger[_0x4ac82d(0x26b)]('Telegraf\x20error:',_0x573804);}),tgBot[_0x55993d(0x261)](async(_0x5b202f,_0x56e275)=>{const _0x8408fc=_0x55993d;if(!(!settings[_0x8408fc(0x23f)]&&_0x5b202f['update'][_0x8408fc(0x232)]['text']=='/start')){if(!validateTelegram(_0x5b202f))return;}_0x56e275();}),tgBot[_0x55993d(0xb9)](_0x55993d(0x1c1),async _0x341bae=>{const _0x2fbe39=_0x55993d;if(!settings[_0x2fbe39(0x23f)])updateSetting(_0x2fbe39(0x23f),_0x341bae['chat']['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x341bae))return;await sendTelegram(_0x341bae[_0x2fbe39(0x160)]['id'],_0x359cfe);}),tgBot[_0x55993d(0xb9)](_0x55993d(0x1be),async _0x188ede=>{const _0x4270bb=_0x55993d;updateSetting(_0x4270bb(0x116),!![]),await sendTelegram(_0x188ede['chat']['id'],_0x4270bb(0xcd));}),tgBot[_0x55993d(0xb9)](_0x55993d(0x284),async _0x1e89e8=>{const _0x4b99f3=_0x55993d;await sendTelegram(_0x1e89e8[_0x4b99f3(0x160)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot['command']('config',async _0x28e063=>{const _0x343833=_0x55993d,_0x6028e=Markup['inlineKeyboard']([Markup['button'][_0x343833(0x29d)]('Orders',_0x343833(0x1b2)),Markup[_0x343833(0x1a2)][_0x343833(0x29d)](_0x343833(0x1e0),_0x343833(0x12c)),Markup[_0x343833(0x1a2)][_0x343833(0x29d)](_0x343833(0x118),_0x343833(0x263))]);_0x28e063['reply'](_0x343833(0x288),_0x6028e);}),tgBot['action']('config_orders',async _0x5980df=>{const _0x2de837=_0x55993d;_0x5980df['editMessageReplyMarkup'](),updateSetting(_0x2de837(0x177),_0x2de837(0x190)),updateSetting(_0x2de837(0x116),!![]),await sendTelegram(_0x5980df[_0x2de837(0x160)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x55993d(0x26c)]('config_alerts',async _0x4608a7=>{const _0x4c98a9=_0x55993d;_0x4608a7[_0x4c98a9(0xc6)](),updateSetting(_0x4c98a9(0x177),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4608a7[_0x4c98a9(0x160)]['id'],_0x4c98a9(0x28a));}),tgBot[_0x55993d(0x26c)](_0x55993d(0x263),async _0x509c4a=>{const _0x13a751=_0x55993d;_0x509c4a['editMessageReplyMarkup'](),updateSetting(_0x13a751(0x177),_0x13a751(0x13b)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x509c4a[_0x13a751(0x160)]['id'],_0x13a751(0x21f));}),tgBot[_0x55993d(0xb9)](_0x55993d(0xc3),async _0x5b70b2=>{const _0x57b97b=_0x55993d,_0x1f8277=getBotsWithMode();let _0xeab5b0=_0x57b97b(0x1ca);config[_0x57b97b(0xb1)](_0x1352b9=>{const _0xf2980c=_0x57b97b,_0x1bf5f7=_0x1f8277[_0xf2980c(0x191)](_0x3a2be9=>_0x3a2be9[_0xf2980c(0x1d8)]==_0x1352b9[_0xf2980c(0x1d8)])[_0xf2980c(0x2a8)];_0xeab5b0+=_0xf2980c(0x17c)+_0x1352b9['botID']+':\x20'+_0x1352b9[_0xf2980c(0xc3)]+_0xf2980c(0x260)+_0x1bf5f7+_0xf2980c(0x260)+_0x1352b9[_0xf2980c(0x1b5)]+'\x0a';}),_0xeab5b0+='\x0a',_0xeab5b0+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0xeab5b0+=!settings[_0x57b97b(0x116)]?_0x57b97b(0x1fb):_0x57b97b(0x244),_0xeab5b0+=settings['telegramEnabled']?settings['telegramEvents']==_0x57b97b(0x13b)?_0x57b97b(0x28c):_0x57b97b(0x19a)+settings[_0x57b97b(0x177)]+_0x57b97b(0x28d):'',await sendTelegram(_0x5b70b2[_0x57b97b(0x160)]['id'],_0xeab5b0,{'parse_mode':_0x57b97b(0x290)});}),tgBot[_0x55993d(0xb9)](_0x55993d(0x1ba),async _0x15522d=>{const _0x252c76=_0x55993d,_0x1cba64=getEnabledBots();if(_0x1cba64['length']==0x0)await sendTelegram(_0x15522d[_0x252c76(0x160)]['id'],_0x252c76(0x19f));else{if(_0x1cba64[_0x252c76(0x1c3)]>0x1)_0x1cba64['push']({'botID':_0x252c76(0x13b)});let _0x3dbd08=[],_0x3a1518=[];const _0x225f1b=_0x1cba64[_0x252c76(0x1c3)]%0x4==0x0||_0x1cba64[_0x252c76(0x1c3)]%0x4==0x3||_0x1cba64[_0x252c76(0x1c3)]%0x3==0x1?0x4:0x3;let _0x513464=0x0;_0x1cba64[_0x252c76(0xb1)]((_0x46d8d8,_0x3eb233)=>{const _0x2484ad=_0x252c76;if(_0x3eb233%_0x225f1b==0x0)_0x3a1518=[];_0x3a1518[_0x2484ad(0x21b)](Markup[_0x2484ad(0x1a2)][_0x2484ad(0x29d)](_0x46d8d8[_0x2484ad(0x1d8)]==_0x2484ad(0x13b)?_0x2484ad(0x152):'Bot\x20'+_0x46d8d8[_0x2484ad(0x1d8)],_0x2484ad(0x188)+_0x46d8d8[_0x2484ad(0x1d8)])),_0x3eb233%_0x225f1b==0x0&&(_0x3dbd08[_0x513464]=_0x3a1518,_0x513464++);});const _0x293e90=Markup[_0x252c76(0x1ef)](_0x3dbd08);_0x15522d[_0x252c76(0x124)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x293e90);}}),tgBot['action'](/restart_(.+)/,async _0x2a721b=>{const _0x54a0be=_0x55993d,_0x4a48d2=_0x2a721b['match'][0x1];_0x2a721b[_0x54a0be(0xc6)](),_0x4a48d2==_0x54a0be(0x13b)?config[_0x54a0be(0xb1)](_0x4d5759=>{const _0x521886=_0x54a0be;restartBot(_0x4d5759[_0x521886(0x1d8)]);}):restartBot(_0x4a48d2);}),tgBot[_0x55993d(0xb9)]('on',async _0x43cf3a=>{const _0x3d2ab5=_0x55993d,_0x5c1b3c=getDisabledBots();if(_0x5c1b3c[_0x3d2ab5(0x1c3)]==0x0)await sendTelegram(_0x43cf3a[_0x3d2ab5(0x160)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x5c1b3c[_0x3d2ab5(0x1c3)]>0x1)_0x5c1b3c[_0x3d2ab5(0x21b)]({'botID':_0x3d2ab5(0x13b)});let _0x37c424=[],_0x32b59d=[];const _0x559565=_0x5c1b3c[_0x3d2ab5(0x1c3)]%0x4==0x0||_0x5c1b3c[_0x3d2ab5(0x1c3)]%0x4==0x3||_0x5c1b3c['length']%0x3==0x1?0x4:0x3;let _0x112878=0x0;_0x5c1b3c['forEach']((_0x1495a2,_0x49c975)=>{const _0x58a327=_0x3d2ab5;if(_0x49c975%_0x559565==0x0)_0x32b59d=[];_0x32b59d[_0x58a327(0x21b)](Markup[_0x58a327(0x1a2)]['callback'](_0x1495a2[_0x58a327(0x1d8)]==_0x58a327(0x13b)?_0x58a327(0x152):_0x58a327(0x17c)+_0x1495a2[_0x58a327(0x1d8)],_0x58a327(0x1d9)+_0x1495a2[_0x58a327(0x1d8)])),_0x49c975%_0x559565==0x0&&(_0x37c424[_0x112878]=_0x32b59d,_0x112878++);});const _0x1df293=Markup[_0x3d2ab5(0x1ef)](_0x37c424);_0x43cf3a[_0x3d2ab5(0x124)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x1df293);}}),tgBot[_0x55993d(0x26c)](/on_(.+)/,async _0x55456c=>{const _0x236384=_0x55993d,_0x24d97d=_0x55456c[_0x236384(0xd9)][0x1];_0x55456c[_0x236384(0xc6)]();if(_0x24d97d==_0x236384(0x13b)){const _0xb30204=getDisabledBots();await sendTelegram(_0x55456c['chat']['id'],_0x236384(0x206)),_0xb30204[_0x236384(0xb1)](_0x525e1c=>{const _0x38ba66=_0x236384;if(_0x525e1c[_0x38ba66(0x1d8)]!=_0x38ba66(0x13b))toggleBot(_0x525e1c[_0x38ba66(0x1d8)],toggleStatus(_0x525e1c[_0x38ba66(0x1d8)]),_0x38ba66(0x26d));});}else await sendTelegram(_0x55456c[_0x236384(0x160)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x24d97d),toggleBot(_0x24d97d,toggleStatus(_0x24d97d),_0x236384(0x26d));}),tgBot['command']('off',async _0x286f24=>{const _0x3e2fc8=_0x55993d,_0x3ec8f1=getEnabledBots();if(_0x3ec8f1[_0x3e2fc8(0x1c3)]==0x0)await sendTelegram(_0x286f24[_0x3e2fc8(0x160)]['id'],_0x3e2fc8(0x19f));else{if(_0x3ec8f1[_0x3e2fc8(0x1c3)]>0x1)_0x3ec8f1[_0x3e2fc8(0x21b)]({'botID':_0x3e2fc8(0x13b)});let _0x55f4e9=[],_0x53bf02=[];const _0x3ad622=_0x3ec8f1[_0x3e2fc8(0x1c3)]%0x4==0x0||_0x3ec8f1[_0x3e2fc8(0x1c3)]%0x4==0x3||_0x3ec8f1[_0x3e2fc8(0x1c3)]%0x3==0x1?0x4:0x3;let _0x49c1e0=0x0;_0x3ec8f1[_0x3e2fc8(0xb1)]((_0x5ed324,_0x20755a)=>{const _0x831e95=_0x3e2fc8;if(_0x20755a%_0x3ad622==0x0)_0x53bf02=[];_0x53bf02[_0x831e95(0x21b)](Markup['button'][_0x831e95(0x29d)](_0x5ed324[_0x831e95(0x1d8)]==_0x831e95(0x13b)?'All\x20bots':_0x831e95(0x17c)+_0x5ed324['botID'],_0x831e95(0x18e)+_0x5ed324[_0x831e95(0x1d8)])),_0x20755a%_0x3ad622==0x0&&(_0x55f4e9[_0x49c1e0]=_0x53bf02,_0x49c1e0++);});const _0x3d10b9=Markup[_0x3e2fc8(0x1ef)](_0x55f4e9);_0x286f24[_0x3e2fc8(0x124)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x3d10b9);}}),tgBot['action'](/off_(.+)/,async _0x3709d5=>{const _0x22de49=_0x55993d,_0x2a6708=_0x3709d5['match'][0x1];_0x3709d5[_0x22de49(0xc6)]();if(_0x2a6708==_0x22de49(0x13b)){const _0x450f45=getEnabledBots();await sendTelegram(_0x3709d5[_0x22de49(0x160)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x450f45['forEach'](_0x59bc5c=>{const _0x55de82=_0x22de49;if(_0x59bc5c['botID']!=_0x55de82(0x13b))toggleBot(_0x59bc5c[_0x55de82(0x1d8)],toggleStatus(_0x59bc5c[_0x55de82(0x1d8)]),'stopped');});}else await sendTelegram(_0x3709d5[_0x22de49(0x160)]['id'],_0x22de49(0x222)+_0x2a6708),toggleBot(_0x2a6708,toggleStatus(_0x2a6708),_0x22de49(0x26d));}),tgBot['command'](_0x55993d(0x1b9),async _0x4b2257=>{const _0x59548d=_0x55993d,_0x4c4294=getEnabledBots();if(_0x4c4294[_0x59548d(0x1c3)]==0x0)await sendTelegram(_0x4b2257[_0x59548d(0x160)]['id'],_0x59548d(0x19f));else{if(_0x4c4294[_0x59548d(0x1c3)]>0x1){let _0x38b31b=[],_0x46f34d=[];const _0x517529=_0x4c4294[_0x59548d(0x1c3)]%0x4==0x0||_0x4c4294[_0x59548d(0x1c3)]%0x4==0x3||_0x4c4294['length']%0x3==0x1?0x4:0x3;let _0x4f4164=0x0;_0x4c4294[_0x59548d(0xb1)]((_0x3f23b1,_0x253cdb)=>{const _0x3aca2f=_0x59548d;if(_0x253cdb%_0x517529==0x0)_0x46f34d=[];_0x46f34d[_0x3aca2f(0x21b)](Markup[_0x3aca2f(0x1a2)]['callback'](_0x3aca2f(0x17c)+_0x3f23b1['botID'],_0x3aca2f(0x25e)+_0x3f23b1[_0x3aca2f(0x1d8)])),_0x253cdb%_0x517529==0x0&&(_0x38b31b[_0x4f4164]=_0x46f34d,_0x4f4164++);});const _0x46e37e=Markup['inlineKeyboard'](_0x38b31b);_0x4b2257[_0x59548d(0x124)](_0x59548d(0x16f),_0x46e37e);}else{const _0x35dfc3=_0x4c4294[0x0][_0x59548d(0x1d8)];if(pid[_0x35dfc3])pid[_0x35dfc3][_0x59548d(0xed)]({'function':_0x59548d(0x1ff),'args':null});}}}),tgBot[_0x55993d(0x26c)](/metrics_(.+)/,async _0x2ba127=>{const _0x147e5b=_0x55993d,_0x47cb4a=_0x2ba127[_0x147e5b(0xd9)][0x1];_0x2ba127['editMessageReplyMarkup']();if(pid[_0x47cb4a])pid[_0x47cb4a][_0x147e5b(0xed)]({'function':_0x147e5b(0x1ff),'args':null});}),tgBot[_0x55993d(0xb9)](_0x55993d(0x9b),async _0x28d7eb=>{const _0x6c3dcd=_0x55993d,_0x447ce8=getEnabledBots();if(_0x447ce8[_0x6c3dcd(0x1c3)]==0x0)await sendTelegram(_0x28d7eb[_0x6c3dcd(0x160)]['id'],_0x6c3dcd(0x19f));else{if(_0x447ce8['length']>0x1){let _0x64f148=[],_0x2de2c7=[];const _0x39954d=_0x447ce8[_0x6c3dcd(0x1c3)]%0x4==0x0||_0x447ce8[_0x6c3dcd(0x1c3)]%0x4==0x3||_0x447ce8[_0x6c3dcd(0x1c3)]%0x3==0x1?0x4:0x3;let _0x25d038=0x0;_0x447ce8[_0x6c3dcd(0xb1)]((_0x2f6469,_0x133c45)=>{const _0x566f8d=_0x6c3dcd;if(_0x133c45%_0x39954d==0x0)_0x2de2c7=[];_0x2de2c7[_0x566f8d(0x21b)](Markup[_0x566f8d(0x1a2)]['callback'](_0x566f8d(0x17c)+_0x2f6469['botID'],_0x566f8d(0x17f)+_0x2f6469[_0x566f8d(0x1d8)])),_0x133c45%_0x39954d==0x0&&(_0x64f148[_0x25d038]=_0x2de2c7,_0x25d038++);});const _0x3f9669=Markup[_0x6c3dcd(0x1ef)](_0x64f148);_0x28d7eb['reply'](_0x6c3dcd(0x29b),_0x3f9669);}else{const _0x1244ea=_0x447ce8[0x0][_0x6c3dcd(0x1d8)];if(pid[_0x1244ea])pid[_0x1244ea][_0x6c3dcd(0xed)]({'function':_0x6c3dcd(0x1e2),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x410f5e=>{const _0x1aac52=_0x55993d,_0x346ccd=_0x410f5e[_0x1aac52(0xd9)][0x1];_0x410f5e[_0x1aac52(0xc6)]();if(pid[_0x346ccd])pid[_0x346ccd][_0x1aac52(0xed)]({'function':_0x1aac52(0x1e2),'args':null});}),tgBot[_0x55993d(0xb9)](_0x55993d(0x16e),async _0x27bf1e=>{const _0x488110=_0x55993d;await getMessages();if(!updateAvailable)await sendTelegram(_0x27bf1e['chat']['id'],_0x488110(0x15e));else{if(!validInstallation)await sendTelegram(_0x27bf1e[_0x488110(0x160)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0xed21e9=Markup[_0x488110(0x1ef)]([Markup[_0x488110(0x1a2)][_0x488110(0x29d)](_0x488110(0x1e1),_0x488110(0x111)),Markup[_0x488110(0x1a2)][_0x488110(0x29d)]('No',_0x488110(0x24e))]);_0x27bf1e['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0xed21e9);}}}),tgBot[_0x55993d(0x26c)](/update_(.+)/,async _0xd52685=>{const _0x3c9317=_0x55993d,_0x18807c=_0xd52685[_0x3c9317(0xd9)][0x1];_0xd52685[_0x3c9317(0xc6)](),_0x18807c=='yes'&&(await sendTelegram(_0xd52685[_0x3c9317(0x160)]['id'],_0x3c9317(0x198)),updateBB(_0x3c9317(0x16e))),_0x18807c=='no'&&await sendTelegram(_0xd52685[_0x3c9317(0x160)]['id'],_0x3c9317(0x28b));}),tgBot['command'](_0x55993d(0xcb),async _0x311a8d=>{const _0x38ea9d=_0x55993d;if(!validInstallation)await sendTelegram(_0x311a8d[_0x38ea9d(0x160)]['id'],_0x38ea9d(0x144));else{const _0x54da39=Markup[_0x38ea9d(0x1ef)]([Markup[_0x38ea9d(0x1a2)][_0x38ea9d(0x29d)](_0x38ea9d(0x1e1),_0x38ea9d(0x1f1)),Markup[_0x38ea9d(0x1a2)][_0x38ea9d(0x29d)]('No',_0x38ea9d(0x27c))]);_0x311a8d[_0x38ea9d(0x124)](_0x38ea9d(0x287),_0x54da39);}}),tgBot[_0x55993d(0x26c)](/reinstall_(.+)/,async _0x56fad6=>{const _0x50d95f=_0x55993d,_0x1e39e9=_0x56fad6[_0x50d95f(0xd9)][0x1];_0x56fad6[_0x50d95f(0xc6)](),_0x1e39e9=='yes'&&(await sendTelegram(_0x56fad6[_0x50d95f(0x160)]['id'],_0x50d95f(0xdb)),updateBB('reinstall')),_0x1e39e9=='no'&&await sendTelegram(_0x56fad6[_0x50d95f(0x160)]['id'],_0x50d95f(0x274));}),tgBot['command'](_0x55993d(0xf2),async _0x47cc54=>{const _0x3d6223=_0x55993d,_0x3bbd9f=getBotsWithMode();if(_0x3bbd9f[_0x3d6223(0x1c3)]==0x0)await sendTelegram(_0x47cc54[_0x3d6223(0x160)]['id'],_0x3d6223(0x19f));else{let _0x2159d1=[],_0x10e6ae=[];const _0x5dd36f=0x2;let _0x3a9dd0=0x0;_0x3bbd9f[_0x3d6223(0xb1)]((_0x597949,_0x212f14)=>{const _0x14a25e=_0x3d6223;if(_0x212f14%_0x5dd36f==0x0)_0x10e6ae=[];_0x10e6ae[_0x14a25e(0x21b)](Markup[_0x14a25e(0x1a2)]['callback'](_0x14a25e(0x17c)+_0x597949['botID']+'\x20('+_0x597949['mode']+')','toggle_'+_0x597949['botID'])),_0x212f14%_0x5dd36f==0x0&&(_0x2159d1[_0x3a9dd0]=_0x10e6ae,_0x3a9dd0++);});const _0xdb7a17=Markup['inlineKeyboard'](_0x2159d1);_0x47cc54['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0xdb7a17);}}),tgBot['action'](/toggle_(.+)/,async _0x8918ca=>{const _0x498123=_0x55993d,_0x23e8fa=_0x8918ca[_0x498123(0xd9)][0x1];_0x8918ca[_0x498123(0xc6)]();const _0x4c85dd=getBotsWithMode(),_0x1f672a=_0x4c85dd[_0x498123(0x191)](_0x578abe=>_0x578abe[_0x498123(0x1d8)]==_0x23e8fa),_0x180ad3=_0x1f672a[_0x498123(0x2a8)]==_0x498123(0x1b6)?_0x498123(0x27b):_0x498123(0x1b6);await sendTelegram(_0x8918ca[_0x498123(0x160)]['id'],_0x498123(0x24d)+_0x23e8fa+_0x498123(0x28f)+_0x180ad3+_0x498123(0x259)),toggleBotMode(_0x23e8fa);}),tgBot[_0x55993d(0xb9)](_0x55993d(0x1c2),async _0x8405c6=>{const _0xb6afc3=_0x55993d;let _0x983563='';config[_0xb6afc3(0xb1)](_0x5e2220=>{const _0x427d8e=_0xb6afc3;_0x983563+=_0x427d8e(0x17c)+_0x5e2220[_0x427d8e(0x1d8)]+':\x20'+_0x5e2220[_0x427d8e(0x17b)]+'\x0a';}),await sendTelegram(_0x8405c6[_0xb6afc3(0x160)]['id'],_0x983563,{'parse_mode':_0xb6afc3(0x290)});}),tgBot['command']('help',async _0x3917d2=>{await sendTelegram(_0x3917d2['chat']['id'],_0x4f88b2);}),process[_0x55993d(0x16a)](_0x55993d(0x203),()=>tgBot[_0x55993d(0x1f5)](_0x55993d(0x203))),process[_0x55993d(0x16a)](_0x55993d(0x264),()=>tgBot[_0x55993d(0x1f5)](_0x55993d(0x264))),tgBot[_0x55993d(0x23c)]();}}function disableTelegram(){const _0x3feaf5=_0x2ea84e;tgBot&&tgBot[_0x3feaf5(0x1f5)]();}async function sendTelegram(_0x7b91c9,_0x52aa11,_0xcadc84){const _0x138832=_0x2ea84e;try{await tgBot[_0x138832(0x13a)][_0x138832(0x11b)](_0x7b91c9,_0x52aa11,_0xcadc84);}catch(_0x40eac8){console[_0x138832(0x1a5)](_0x138832(0x18a),_0x40eac8);}}async function sendTelegramBot(_0x3cc3c8,_0x273738){const _0x2ffd6e=_0x2ea84e;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x2ffd6e(0x13b)||(_0x273738[_0x2ffd6e(0x208)]==_0x2ffd6e(0x213)||_0x273738['type']==_0x2ffd6e(0x240)||_0x273738[_0x2ffd6e(0x208)]==_0x2ffd6e(0xe0))&&settings[_0x2ffd6e(0x177)]=='alerts'||_0x273738[_0x2ffd6e(0x208)]=='order'&&settings[_0x2ffd6e(0x177)]==_0x2ffd6e(0x190)){if(tgBot&&settings[_0x2ffd6e(0x23f)]){if(_0x273738['showname'])await sendTelegram(settings[_0x2ffd6e(0x23f)],_0x273738[_0x2ffd6e(0x17b)]+_0x2ffd6e(0xd8)+_0x273738[_0x2ffd6e(0x2a5)]);else await sendTelegram(settings[_0x2ffd6e(0x23f)],_0x2ffd6e(0x17c)+_0x3cc3c8+_0x2ffd6e(0xd8)+_0x273738['event']);}}}}async function sendTelegramMsg(_0x4168ca,_0x3b4716=_0x2ea84e(0x290)){const _0x3c8abd=_0x2ea84e;return settings[_0x3c8abd(0x116)]&&tgBot&&settings[_0x3c8abd(0x23f)]?(await sendTelegram(settings['telegramChatId'],_0x4168ca,{'parse_mode':_0x3b4716}),!![]):![];}function getDeviceWithIp(_0x3189c4){const _0x12d6e9=_0x2ea84e;return devices[_0x12d6e9(0x191)](_0x585d1e=>_0x585d1e['ip']===_0x3189c4);}async function temporaryAccess2FA(_0x48ce37,_0x466094){const _0x1c8470=_0x2ea84e;let _0x56e11c=new Date(),_0x4a3fa0=![];if(lastIpApproval){if(_0x56e11c-lastIpApproval<0x1388)_0x4a3fa0=!![];}lastIpApproval=new Date();if(_0x4a3fa0)return;if(tgBot&&settings['telegramChatId']){const _0x53d9ed=uuidRandom();tmpStorage[_0x53d9ed]={'uuid':_0x48ce37,'externalip':_0x466094};const _0x3ca4a9=Markup['inlineKeyboard']([Markup[_0x1c8470(0x1a2)]['callback']('5\x20min',_0x1c8470(0x147)+_0x53d9ed),Markup['button'][_0x1c8470(0x29d)](_0x1c8470(0x1cd),'tempaccess_15_'+_0x53d9ed),Markup[_0x1c8470(0x1a2)][_0x1c8470(0x29d)](_0x1c8470(0x1e7),_0x1c8470(0x27d)+_0x53d9ed),Markup['button']['callback'](_0x1c8470(0x102),_0x1c8470(0x200)+_0x53d9ed)]);await sendTelegram(settings[_0x1c8470(0x23f)],_0x1c8470(0x107)+normalizeIP(_0x466094)[_0x1c8470(0x1a9)]+'\x20?',_0x3ca4a9),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x50a1e6=>{const _0x1e1b4f=_0x1c8470,_0x4dbdff=_0x50a1e6['match'][0x1],_0x5bc4a6=_0x50a1e6['match'][0x2],{uuid:_0x46077d,externalip:_0xdeb5bc}=tmpStorage[_0x5bc4a6];delete tmpStorage[_0x5bc4a6],_0x50a1e6[_0x1e1b4f(0xc6)](),devices[_0x46077d][_0x1e1b4f(0x1b7)]={'clientip':_0xdeb5bc,'timestamp':new Date()[_0x1e1b4f(0x27e)](),'expiry':_0x4dbdff},_0x4dbdff!='reject'?(await sendTelegram(_0x50a1e6[_0x1e1b4f(0x160)]['id'],'Access\x20enabled\x20for\x20'+_0x4dbdff+_0x1e1b4f(0x250),{'parse_mode':_0x1e1b4f(0x290)}),io['to'](_0x46077d)['emit'](_0x1e1b4f(0xc3),{'access':{'allow':![],'reason':_0x1e1b4f(0xf0),'token':null}})):(await sendTelegram(_0x50a1e6[_0x1e1b4f(0x160)]['id'],_0x1e1b4f(0xf1)),io['to'](_0x46077d)[_0x1e1b4f(0xa6)](_0x1e1b4f(0xc3),{'access':{'allow':![],'reason':_0x1e1b4f(0x101),'token':null}}));});}}async function loginAccess2FA(_0x394c0c,_0x147657){const _0x51f265=_0x2ea84e;if(tgBot&&settings[_0x51f265(0x23f)]){const _0x5705f5=uuidRandom();tmpStorage[_0x5705f5]={'uuid':_0x394c0c,'externalip':_0x147657};const _0x481acf=Markup[_0x51f265(0x1ef)]([Markup[_0x51f265(0x1a2)][_0x51f265(0x29d)]('accept',_0x51f265(0x182)+loginExpiry+'_'+_0x5705f5),Markup[_0x51f265(0x1a2)][_0x51f265(0x29d)](_0x51f265(0x102),_0x51f265(0x1de)+_0x5705f5)]);await sendTelegram(settings[_0x51f265(0x23f)],_0x51f265(0x1cc)+normalizeIP(_0x147657)[_0x51f265(0x1a9)]+'\x20?',_0x481acf),tgBot[_0x51f265(0x26c)](/login2fa_(.+)_(.+)/,async _0x486e2a=>{const _0x587f46=_0x51f265,_0x2eaf79=_0x486e2a[_0x587f46(0xd9)][0x1],_0x155326=_0x486e2a[_0x587f46(0xd9)][0x2],{uuid:_0x21c7a4,externalip:_0x2af98e}=tmpStorage[_0x155326];delete tmpStorage[_0x155326],_0x486e2a[_0x587f46(0xc6)](),devices[_0x21c7a4][_0x587f46(0xad)]={'clientip':_0x2af98e,'timestamp':new Date()[_0x587f46(0x27e)](),'expiry':_0x2eaf79},_0x2eaf79!=_0x587f46(0x102)?(await sendTelegram(_0x486e2a[_0x587f46(0x160)]['id'],_0x587f46(0x1c7),{'parse_mode':_0x587f46(0x290)}),io['to'](_0x21c7a4)[_0x587f46(0xa6)](_0x587f46(0xc3),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x486e2a[_0x587f46(0x160)]['id'],_0x587f46(0x14b)),io['to'](_0x21c7a4)['emit'](_0x587f46(0xc3),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xc5d0a6=_0x2ea84e;return dbConfig[_0xc5d0a6(0x207)](_0xc5d0a6(0x2a1))[_0xc5d0a6(0x1bb)](_0xc5d0a6(0x1d8))[_0xc5d0a6(0x17d)]({'status':_0xc5d0a6(0xe5)})[_0xc5d0a6(0x1b3)]()||[];}function getDisabledBots(){const _0x4798cd=_0x2ea84e;return dbConfig[_0x4798cd(0x207)](_0x4798cd(0x2a1))[_0x4798cd(0x1bb)](_0x4798cd(0x1d8))[_0x4798cd(0x17d)]({'status':_0x4798cd(0x140)})[_0x4798cd(0x1b3)]()||[];}function getBotAttributes(_0x1a0eac){const _0x3c4366=_0x2ea84e;let _0x656eea={};const _0x5cbe1d=configpath+_0x3c4366(0x12f)+_0x1a0eac+_0x3c4366(0x2a6),_0x57fcdb=fs[_0x3c4366(0x15d)](_0x5cbe1d);if(_0x57fcdb){const _0x568222=fs[_0x3c4366(0x236)](_0x5cbe1d);try{const _0x26e1f2=JSON[_0x3c4366(0x186)](_0x568222),_0x2acd27=_0x26e1f2?_0x26e1f2[_0x3c4366(0x233)][0x0][_0x3c4366(0x296)]:![];_0x656eea[_0x3c4366(0x2a8)]=_0x2acd27?_0x3c4366(0x1b6):'manual',_0x656eea[_0x3c4366(0x17b)]=_0x26e1f2?_0x26e1f2[_0x3c4366(0x233)][0x0]['botname']:'Bot\x20'+_0x1a0eac;}catch(_0x1eff35){_0x656eea[_0x3c4366(0x2a8)]=_0x3c4366(0x27b),_0x656eea['botname']=_0x3c4366(0x17c)+_0x1a0eac;}}else _0x656eea[_0x3c4366(0x2a8)]=_0x3c4366(0x27b),_0x656eea[_0x3c4366(0x17b)]='Bot\x20'+_0x1a0eac;return _0x656eea;}function getBotsWithMode(){const _0x4158aa=_0x2ea84e,_0x416b1b=dbConfig[_0x4158aa(0x207)](_0x4158aa(0x2a1))[_0x4158aa(0x1bb)](_0x4158aa(0x1d8))['value']()||[];return _0x416b1b[_0x4158aa(0xb1)](_0x17d671=>{const _0x5c55c4=_0x4158aa;let _0x173c42=getBotAttributes(_0x17d671[_0x5c55c4(0x1d8)]);_0x17d671[_0x5c55c4(0x2a8)]=_0x173c42['mode'];}),_0x416b1b;}function getBotExchanges(){const _0x4a8284=_0x2ea84e;let _0x10eb55=[];const _0x2b9d8f=dbConfig[_0x4a8284(0x207)]('bots')['sortBy'](_0x4a8284(0x1d8))['value']()||[];_0x2b9d8f[_0x4a8284(0xb1)](_0x4fbb69=>{const _0x163bcf=_0x4a8284;if(_0x4fbb69[_0x163bcf(0xc3)]==_0x163bcf(0xe5)){const _0x29c061=configpath+_0x163bcf(0x12f)+_0x4fbb69['botID']+_0x163bcf(0x2a6),_0x39518d=fs[_0x163bcf(0x15d)](_0x29c061);let _0x259e97;if(_0x39518d){const _0x28042f=fs[_0x163bcf(0x236)](_0x29c061);try{const _0x5bc98f=JSON['parse'](_0x28042f);_0x259e97=_0x5bc98f?_0x5bc98f[_0x163bcf(0x233)][0x0][_0x163bcf(0x16c)]:null;}catch(_0x1c60ea){}}if(_0x259e97)_0x10eb55['push'](_0x259e97);}});const _0x1e180b=[...new Set(_0x10eb55)][_0x4a8284(0xc0)]();return _0x1e180b;}async function initUser(){const _0x24aa58=_0x2ea84e;if(!settings[_0x24aa58(0x1fc)]){const _0xe7747a=uuidRandom();mixpanel['alias'](_0xe7747a),updateSetting('userid',_0xe7747a);}}async function initSecure(){const _0x307b81=_0x2ea84e;let _0x490557=getSecure();if(!_0x490557[_0x307b81(0x292)](_0x307b81(0x113))){let _0x401214=await generateKeys();_0x490557[_0x307b81(0xbf)]=_0x401214[_0x307b81(0xbf)],_0x490557[_0x307b81(0x291)]=_0x401214[_0x307b81(0x291)],_0x490557[_0x307b81(0x113)]=crypto[_0x307b81(0x283)](0x20)[_0x307b81(0x105)](_0x307b81(0x234));;storeSecure(_0x490557);}}function getSettings(){const _0x271908=_0x2ea84e;return dbSettings[_0x271908(0x207)](_0x271908(0x9c))['value']()||{};}function getSecure(){const _0x2fe5f5=_0x2ea84e;return dbSecure[_0x2fe5f5(0x207)](_0x2fe5f5(0x242))[_0x2fe5f5(0x1b3)]()||{};}function getBlacklist(){const _0x57dec7=_0x2ea84e;return dbSecure[_0x57dec7(0x207)]('blacklist')[_0x57dec7(0x1b3)]()||[];}function broadcastToBots(_0x50d6c5,_0x2327e4){config['forEach'](_0xf502d2=>{const _0x137208=_0x4058;if(_0xf502d2[_0x137208(0xc3)]==_0x137208(0xe5)&&_0xf502d2[_0x137208(0x1b5)]==_0x137208(0xdf)||_0xf502d2[_0x137208(0xc3)]==_0x137208(0xb4)&&_0xf502d2[_0x137208(0x1b5)]==_0x137208(0xdf)){if(pid[_0xf502d2['botID']])pid[_0xf502d2[_0x137208(0x1d8)]][_0x137208(0xed)]({[_0x50d6c5]:_0x2327e4});}});}function storeSettings(_0x5aff18,_0x38eb03=![]){const _0x4039c6=_0x2ea84e;_0x5aff18={...settings,..._0x5aff18};if(_0x38eb03&&_0x5aff18[_0x4039c6(0x210)]!=_0x4039c6(0x2a3)&&_0x5aff18['bbPassword']!=_0x4039c6(0x1dd)&&_0x5aff18[_0x4039c6(0x210)]!=''){const _0x2f13ea=crypt[_0x4039c6(0x1ed)](secure[_0x4039c6(0x291)],_0x5aff18[_0x4039c6(0x210)])[_0x4039c6(0x232)][_0x4039c6(0x165)]('@')[0x0],_0x396d29=bcrypt['hashSync'](_0x2f13ea,saltRounds);_0x5aff18={..._0x5aff18,'bbPassword':_0x396d29};}if(_0x38eb03&&_0x5aff18['telegramToken']!=_0x4039c6(0x2a3)&&_0x5aff18[_0x4039c6(0xcf)]!='***'&&_0x5aff18[_0x4039c6(0xcf)]!=''){const _0x108820=crypt[_0x4039c6(0x1ed)](secure[_0x4039c6(0x291)],_0x5aff18[_0x4039c6(0xcf)])[_0x4039c6(0x232)][_0x4039c6(0x165)]('@')[0x0];_0x5aff18={..._0x5aff18,'telegramToken':_0x108820};}const _0x3fa1bd=_0x5aff18[_0x4039c6(0xcf)]!=_0x4039c6(0x2a3)&&_0x5aff18[_0x4039c6(0xcf)]!=settings[_0x4039c6(0xcf)]||_0x5aff18['telegramUsername']!=settings['telegramUsername'],_0x2155b0=_0x5aff18[_0x4039c6(0xcf)]==''||_0x5aff18[_0x4039c6(0x1bf)]=='';_0x3fa1bd&&(_0x5aff18['telegramChatId']=null,_0x5aff18[_0x4039c6(0x177)]=_0x4039c6(0x13b));for(const [_0x2890de,_0x5c9114]of Object[_0x4039c6(0x24a)](_0x5aff18)){if(_0x2890de=='telegramToken'&&_0x5c9114==_0x4039c6(0x2a3)){_0x5aff18[_0x4039c6(0xcf)]=settings[_0x4039c6(0xcf)];continue;};if(_0x2890de==_0x4039c6(0x210)&&_0x5c9114==_0x4039c6(0x2a3)){_0x5aff18[_0x4039c6(0x210)]=settings[_0x4039c6(0x210)];continue;};dbSettings['set'](_0x4039c6(0x1a0)+_0x2890de,_0x5c9114)[_0x4039c6(0x215)]();}settings=_0x5aff18,io['to'](_0x4039c6(0x249))[_0x4039c6(0xa6)]('settings',cleanSettings()),broadcastToBots(_0x4039c6(0x18c),settings[_0x4039c6(0x18c)]),broadcastToBots(_0x4039c6(0x12b),settings['onepagemode']);if(_0x3fa1bd&&!_0x2155b0)initTelegram();if(_0x3fa1bd&&_0x2155b0)disableTelegram();getAllClients()[_0x4039c6(0xb1)](_0x15003e=>{const _0x3fa9d3=_0x4039c6;getSocket(_0x15003e['id'])[_0x3fa9d3(0xa6)](_0x3fa9d3(0xc3),{'access':{'allow':![],'reason':_0x3fa9d3(0xf0),'token':null}});});}function updateSetting(_0x1d0423,_0x5c618d){const _0x3bdcac=_0x2ea84e;dbSettings[_0x3bdcac(0x174)]('settings.'+_0x1d0423,_0x5c618d)[_0x3bdcac(0x215)](),settings=getSettings(),io['to'](_0x3bdcac(0x249))['emit']('settings',cleanSettings());}function storeSecure(_0x142e7b){const _0x453645=_0x2ea84e;dbSecure[_0x453645(0x207)](_0x453645(0x242))[_0x453645(0x21b)](_0x142e7b)[_0x453645(0x215)](),secure=_0x142e7b;}function addBlacklist(_0x1e6290){const _0x3fe3f4=_0x2ea84e;cleanBlacklist();let _0x48dbc1;devices[_0x1e6290][_0x3fe3f4(0x1b7)]?_0x48dbc1=Math[_0x3fe3f4(0xbc)](devices[_0x1e6290][_0x3fe3f4(0x1b7)][_0x3fe3f4(0x29e)],loginExpiry):_0x48dbc1=loginExpiry,dbSecure[_0x3fe3f4(0x207)](_0x3fe3f4(0xf3))[_0x3fe3f4(0x21b)]({'expiry':new Date()['getTime']()+_0x48dbc1*0x3c*0x3e8,'token':devices[_0x1e6290]['access'][_0x3fe3f4(0xc2)]})[_0x3fe3f4(0x215)](),blacklist=dbSecure[_0x3fe3f4(0x207)]('blacklist')[_0x3fe3f4(0x1b3)]();}function cleanBlacklist(){const _0x2b3df8=_0x2ea84e;let _0x44e552=dbSecure[_0x2b3df8(0x207)](_0x2b3df8(0xf3))[_0x2b3df8(0x286)]()[_0x2b3df8(0x1b3)](),_0x3c34f2=new Date()[_0x2b3df8(0x27e)]();_0x44e552[_0x2b3df8(0xb1)](_0xfec3a6=>{const _0x12f0f3=_0x2b3df8;_0xfec3a6['expiry']<_0x3c34f2&&dbSecure[_0x12f0f3(0x207)](_0x12f0f3(0xf3))[_0x12f0f3(0xce)]({'expiry':_0xfec3a6[_0x12f0f3(0x29e)]})['write']();});}function initStates(){const _0x7a2d25=_0x2ea84e;let _0x3957d0=getConfiguration();_0x3957d0[_0x7a2d25(0xb1)](_0x11f4d3=>{const _0x3bb6d0=_0x7a2d25;_0x11f4d3[_0x3bb6d0(0x1b5)]=_0x3bb6d0(0x26d);}),storeConfiguration(_0x3957d0);}function onKeys(){const _0x222c3d=new RSA();return new Promise(_0xc05656=>{const _0x49f57c=_0x4058;_0x222c3d[_0x49f57c(0x14e)]()[_0x49f57c(0x146)](_0x2f606e=>{_0xc05656(_0x2f606e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x352f99=_0x2ea84e;let _0x340975=getSettings(),_0x12d467=![];!_0x340975['hasOwnProperty'](_0x352f99(0x23e))&&(_0x340975[_0x352f99(0x23e)]=0x0,_0x12d467=!![]);!_0x340975[_0x352f99(0x292)]('lastmsgemitted')&&(_0x340975[_0x352f99(0x183)]=0x0,_0x12d467=!![]);!_0x340975[_0x352f99(0x292)](_0x352f99(0x176))&&(_0x340975['latestversion']='0.0.0',_0x12d467=!![]);!_0x340975[_0x352f99(0x292)](_0x352f99(0x12b))&&(_0x340975[_0x352f99(0x12b)]=![],_0x12d467=!![]);if(_0x12d467)storeSettings(_0x340975);try{fs[_0x352f99(0x1dc)](configbackuppath,{'withFileTypes':!![]})[_0x352f99(0xb1)](_0x266a22=>{const _0x330e6d=_0x352f99;if(!_0x266a22[_0x330e6d(0x15a)]()){if(!_0x266a22[_0x330e6d(0xb6)]['startsWith'](_0x330e6d(0x201)))fs[_0x330e6d(0x12a)](configbackuppath+_0x266a22[_0x330e6d(0xb6)]);}else fs[_0x330e6d(0xa5)](configbackuppath+_0x266a22[_0x330e6d(0xb6)],{'recursive':!![]});});}catch(_0x485edd){logger[_0x352f99(0x26b)](_0x352f99(0x2a4),_0x485edd);}}function storeConfiguration(_0x1e8fca){const _0x168e09=_0x2ea84e;dbConfig[_0x168e09(0x207)](_0x168e09(0x2a1))['remove']()['write'](),dbConfig[_0x168e09(0x207)](_0x168e09(0x2a1))['push'](..._0x1e8fca)[_0x168e09(0x215)](),config=_0x1e8fca;}async function resetPassword(){const _0x3496fb=_0x2ea84e;if(tgBot&&settings[_0x3496fb(0x23f)]){const _0x41e1ae=Markup['inlineKeyboard']([Markup[_0x3496fb(0x1a2)][_0x3496fb(0x29d)](_0x3496fb(0x1bd),'resetpw_yes'),Markup[_0x3496fb(0x1a2)][_0x3496fb(0x29d)]('no',_0x3496fb(0xdd))]);await sendTelegram(settings[_0x3496fb(0x23f)],_0x3496fb(0x246),_0x41e1ae),tgBot[_0x3496fb(0x26c)](/resetpw_(.+)/,async _0x49220d=>{const _0x46ff0d=_0x3496fb,_0x13bfea=_0x49220d['match'][0x1];_0x49220d[_0x46ff0d(0xc6)]();if(_0x13bfea!='no'){const _0x83d0b4=0xf,_0x3550fb=_0x46ff0d(0x1ee),_0x345ceb=Array[_0x46ff0d(0x21e)](crypto[_0x46ff0d(0x1e9)](new Uint32Array(_0x83d0b4)))[_0x46ff0d(0x280)](_0x599619=>_0x3550fb[_0x599619%_0x3550fb[_0x46ff0d(0x1c3)]])['join'](''),_0x39115c=bcrypt[_0x46ff0d(0x26f)](_0x345ceb,saltRounds);storeSettings({'bbPassword':_0x39115c}),await sendTelegram(_0x49220d['chat']['id'],_0x46ff0d(0x270)+_0x345ceb,{'parse_mode':'HTML'});}else await sendTelegram(_0x49220d[_0x46ff0d(0x160)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x53c3af,_0x4a6cde){const _0x38307a=_0x2ea84e;io['to']('botmanager')[_0x38307a(0xa6)](_0x38307a(0x1f4),_0x38307a(0xb2),'success');if(tgBot&&settings['telegramChatId']){const _0x8e953c=uuidRandom();tmpStorage[_0x8e953c]={'path':_0x53c3af,'filename':_0x4a6cde};const _0x44b7f6=Markup['inlineKeyboard']([Markup[_0x38307a(0x1a2)][_0x38307a(0x29d)](_0x38307a(0x1bd),_0x38307a(0x22b)+_0x8e953c),Markup['button'][_0x38307a(0x29d)]('no','restore_no_'+_0x8e953c)]);await sendTelegram(settings[_0x38307a(0x23f)],_0x38307a(0x14f),_0x44b7f6),tgBot['action'](/restore_(.+)_(.+)/,async _0x1e02c7=>{const _0x480c34=_0x38307a,_0x6641a6=_0x1e02c7['match'][0x1],_0x111ece=_0x1e02c7[_0x480c34(0xd9)][0x2],{path:_0x525feb,filename:_0x508440}=tmpStorage[_0x111ece];delete tmpStorage[_0x111ece],_0x1e02c7[_0x480c34(0xc6)](),_0x6641a6==_0x480c34(0x1bd)?(logger[_0x480c34(0x26b)](_0x480c34(0x299)),await sendTelegram(_0x1e02c7[_0x480c34(0x160)]['id'],_0x480c34(0x266),{'parse_mode':_0x480c34(0x290)}),unzipFile(_0x525feb,_0x508440)):(logger[_0x480c34(0x26b)](_0x480c34(0x189)),await sendTelegram(_0x1e02c7[_0x480c34(0x160)]['id'],_0x480c34(0x189)));});}}function getServerTime(){const _0x5ddbbb=_0x2ea84e,_0x26eca6=new Date();return _0x26eca6['getFullYear']()+'/'+(_0x26eca6[_0x5ddbbb(0x1fe)]()+0x1)[_0x5ddbbb(0x105)]()[_0x5ddbbb(0xc8)](0x2,'0')+'/'+_0x26eca6['getDate']()['toString']()[_0x5ddbbb(0xc8)](0x2,'0')+'\x20'+_0x26eca6['getHours']()['toString']()[_0x5ddbbb(0xc8)](0x2,'0')+':'+_0x26eca6['getMinutes']()[_0x5ddbbb(0x105)]()['padStart'](0x2,'0')+':'+_0x26eca6[_0x5ddbbb(0x134)]()[_0x5ddbbb(0x105)]()[_0x5ddbbb(0xc8)](0x2,'0');}function getTimeStamp(){const _0x4962dd=_0x2ea84e,_0x3f79b3=shiftedTime();return _0x3f79b3['getFullYear']()+'/'+(_0x3f79b3['getMonth']()+0x1)[_0x4962dd(0x105)]()[_0x4962dd(0xc8)](0x2,'0')+'/'+_0x3f79b3[_0x4962dd(0x19d)]()[_0x4962dd(0x105)]()[_0x4962dd(0xc8)](0x2,'0')+'\x20'+_0x3f79b3[_0x4962dd(0xc9)]()[_0x4962dd(0x105)]()[_0x4962dd(0xc8)](0x2,'0')+':'+_0x3f79b3['getMinutes']()[_0x4962dd(0x105)]()[_0x4962dd(0xc8)](0x2,'0')+':'+_0x3f79b3[_0x4962dd(0x134)]()[_0x4962dd(0x105)]()[_0x4962dd(0xc8)](0x2,'0');}function getCleanTimeStamp(){const _0x2a8cfa=_0x2ea84e,_0x141f07=shiftedTime();return _0x141f07[_0x2a8cfa(0x262)]()+(_0x141f07['getMonth']()+0x1)['toString']()[_0x2a8cfa(0xc8)](0x2,'0')+_0x141f07[_0x2a8cfa(0x19d)]()[_0x2a8cfa(0x105)]()[_0x2a8cfa(0xc8)](0x2,'0')+'-'+_0x141f07['getHours']()[_0x2a8cfa(0x105)]()[_0x2a8cfa(0xc8)](0x2,'0')+_0x141f07['getMinutes']()['toString']()[_0x2a8cfa(0xc8)](0x2,'0')+_0x141f07[_0x2a8cfa(0x134)]()['toString']()[_0x2a8cfa(0xc8)](0x2,'0');}function shiftedTime(){const _0x18625e=_0x2ea84e,_0x39f2e9=new Date();let _0x573c4d=_0x39f2e9;if(settings['timeshift']&&settings[_0x18625e(0x18c)]!==0x0)_0x573c4d=fns[_0x18625e(0x235)](_0x39f2e9,{'hours':settings[_0x18625e(0x18c)]});return _0x573c4d;}function startScheduler(){const _0x85a0a8=_0x2ea84e,_0x458cd7=new Date()[_0x85a0a8(0x224)](),_0x4b8d9f=shiftedTime()[_0x85a0a8(0xc9)]();_0x4b8d9f==0x4&&backupConfigFiles();_0x4b8d9f==0x0&&rotateLogFiles();_0x458cd7%0x6==0x0&&triggerAnalytics();_0x458cd7%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xef15b8){const _0x29b543=_0x2ea84e;logger[_0x29b543(0x26b)](_0x29b543(0x1d4)+_0xef15b8);const _0x9742be=getBotsWithMode();_0x9742be['length']>0x0?confirmRestore(configbackuppath,_0xef15b8):unzipFile(configbackuppath,_0xef15b8);}async function getBackupFiles(_0x5be7d3=null){const _0x294d2a=_0x2ea84e;let _0x52187c=[],_0x51a94b=fs[_0x294d2a(0x1dc)](configbackuppath,{'withFileTypes':!![]});_0x51a94b[_0x294d2a(0xc0)]((_0x34b1b3,_0x38d04a)=>_0x34b1b3['name']<_0x38d04a[_0x294d2a(0xb6)]?0x1:_0x38d04a[_0x294d2a(0xb6)]<_0x34b1b3[_0x294d2a(0xb6)]?-0x1:0x0),_0x51a94b[_0x294d2a(0xb1)](_0x54e64c=>{const _0x549656=_0x294d2a;if(!_0x54e64c[_0x549656(0x15a)]()&&_0x54e64c['name']['startsWith']('backup-full@')&&_0x54e64c[_0x549656(0xb6)][_0x549656(0x27a)](_0x549656(0x252))){const _0x489d2e=formatDate(fs[_0x549656(0xda)](configbackuppath+_0x54e64c[_0x549656(0xb6)])[_0x549656(0x1f3)]);_0x52187c['push']({'name':_0x54e64c[_0x549656(0xb6)],'mtime':_0x489d2e});}});if(_0x5be7d3)io['to'](_0x5be7d3)[_0x294d2a(0xa6)](_0x294d2a(0x166),_0x52187c);else return _0x52187c;}async function backupConfigFiles(){const _0x71a518=_0x2ea84e;await zipFiles(_0x71a518(0x229));const _0x223ea5=getCleanTimeStamp();fs[_0x71a518(0x9e)](zippath+_0x71a518(0xba),configbackuppath+(_0x71a518(0x201)+_0x223ea5+_0x71a518(0x252)));let _0x1ede5e=fs[_0x71a518(0x1dc)](configbackuppath,{'withFileTypes':!![]});_0x1ede5e['sort']((_0x13f766,_0x2662ef)=>_0x13f766[_0x71a518(0xb6)]<_0x2662ef[_0x71a518(0xb6)]?0x1:_0x2662ef[_0x71a518(0xb6)]<_0x13f766['name']?-0x1:0x0),_0x1ede5e[_0x71a518(0x1c3)]>maxBackups&&fs[_0x71a518(0x12a)](configbackuppath+_0x1ede5e[_0x1ede5e[_0x71a518(0x1c3)]-0x1][_0x71a518(0xb6)]);}function rotateLogFiles(){const _0x4abe54=_0x2ea84e,_0x308ac8=fs['statSync'](logspath+_0x4abe54(0xaf)),_0x4f6048=_0x308ac8[_0x4abe54(0x27f)]/0x400;if(_0x4f6048>0x64){let _0x2f73ad=fs[_0x4abe54(0x1dc)](logspath,{'withFileTypes':!![]});_0x2f73ad[_0x4abe54(0xc0)]((_0x2a6f09,_0x24f090)=>_0x2a6f09[_0x4abe54(0xb6)]<_0x24f090['name']?0x1:_0x24f090[_0x4abe54(0xb6)]<_0x2a6f09[_0x4abe54(0xb6)]?-0x1:0x0),_0x2f73ad[_0x4abe54(0xb1)](_0x3a3247=>{const _0x5681db=_0x4abe54;if(_0x3a3247[_0x5681db(0xb6)]==_0x5681db(0x281))fs[_0x5681db(0x9e)](logspath+_0x3a3247[_0x5681db(0xb6)],logspath+'output-003.log');if(_0x3a3247[_0x5681db(0xb6)]=='output-001.log')fs[_0x5681db(0x9e)](logspath+_0x3a3247['name'],logspath+_0x5681db(0x281));_0x3a3247['name']=='output-000.log'&&(fs['copyFileSync'](logspath+_0x3a3247['name'],logspath+'output-001.log'),fs[_0x5681db(0x21d)](logspath+_0x3a3247[_0x5681db(0xb6)],''));});}}async function zipFiles(_0x453314){const _0x5a82e3=_0x2ea84e;let _0x5c94b9;if(_0x453314==_0x5a82e3(0x1d1))_0x5c94b9=logspath;if(_0x453314==_0x5a82e3(0x18f))_0x5c94b9=configpath;if(_0x453314==_0x5a82e3(0x229))_0x5c94b9=configpath;let _0x3b2ae1=fs[_0x5a82e3(0x1dc)](_0x5c94b9,{'withFileTypes':!![]});const _0x39e658=new require(_0x5a82e3(0x195))();_0x3b2ae1[_0x5a82e3(0xb1)](_0x1f7c9d=>{const _0x371e0c=_0x5a82e3;if(!_0x1f7c9d[_0x371e0c(0x15a)]()){let _0x116143=fs[_0x371e0c(0x236)](_0x5c94b9+_0x1f7c9d[_0x371e0c(0xb6)]);if(_0x453314==_0x371e0c(0x18f)){const _0x17c186=/^bot-[0-9]{3}-config.json$/,_0x2a3fda=_0x17c186[_0x371e0c(0x289)](_0x1f7c9d[_0x371e0c(0xb6)]);if(_0x2a3fda){const _0x1f595d=JSON[_0x371e0c(0x186)](_0x116143);if(_0x1f595d['bot'][0x0]){_0x1f595d[_0x371e0c(0x233)][0x0][_0x371e0c(0x168)]='***',_0x1f595d[_0x371e0c(0x233)][0x0]['apiSecret']=_0x371e0c(0x1dd);if(_0x1f595d[_0x371e0c(0x233)][0x0][_0x371e0c(0x1e3)])_0x1f595d[_0x371e0c(0x233)][0x0]['apiPassword']=_0x371e0c(0x1dd);}_0x116143=JSON[_0x371e0c(0x15b)](_0x1f595d,null,0x2);}if(_0x1f7c9d[_0x371e0c(0xb6)]=='bb-settings.json'){const _0x2c5cfc=JSON['parse'](_0x116143);if(_0x2c5cfc[_0x371e0c(0x9c)][_0x371e0c(0x256)])_0x2c5cfc[_0x371e0c(0x9c)][_0x371e0c(0x256)]=![];if(_0x2c5cfc[_0x371e0c(0x9c)][_0x371e0c(0x210)])_0x2c5cfc[_0x371e0c(0x9c)]['bbPassword']=_0x371e0c(0x1dd);if(_0x2c5cfc['settings'][_0x371e0c(0xcf)])_0x2c5cfc[_0x371e0c(0x9c)][_0x371e0c(0xcf)]=_0x371e0c(0x1dd);if(_0x2c5cfc['settings'][_0x371e0c(0x23f)])_0x2c5cfc[_0x371e0c(0x9c)]['telegramChatId']=null;_0x116143=JSON[_0x371e0c(0x15b)](_0x2c5cfc,null,0x2);}if(_0x1f7c9d['name']!='bb-secure.json')_0x39e658[_0x371e0c(0xcc)](_0x1f7c9d[_0x371e0c(0xb6)],_0x116143);}else _0x39e658[_0x371e0c(0xcc)](_0x1f7c9d['name'],_0x116143);}});const _0x37ecea=_0x39e658[_0x5a82e3(0x11a)]({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x453314+_0x5a82e3(0x252)),_0x37ecea,_0x5a82e3(0xe4));}async function unzipFile(_0x132615,_0x30862a){const _0x34ca47=_0x2ea84e;fs[_0x34ca47(0x1dc)](configpath,{'withFileTypes':!![]})[_0x34ca47(0xb1)](_0x5e8252=>{const _0x32dbbd=_0x34ca47;if(!_0x5e8252['isDirectory']())fs[_0x32dbbd(0xa5)](configpath+_0x5e8252[_0x32dbbd(0xb6)]);});const _0x1cb724=fs['readFileSync'](_0x132615+_0x30862a,_0x34ca47(0xe4)),_0x404844=new require(_0x34ca47(0x195))(_0x1cb724,{'base64':![],'checkCRC32':!![]});Object[_0x34ca47(0x164)](_0x404844[_0x34ca47(0x20c)])[_0x34ca47(0xb1)](_0x302930=>{const _0x2376c0=_0x34ca47,_0xefbe01=_0x404844[_0x2376c0(0x20c)][_0x302930];fs['writeFileSync'](configpath+_0xefbe01[_0x2376c0(0xb6)],_0xefbe01['_data']);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x34ca47(0xb1)](_0x4b3dfd=>{const _0x13d99d=_0x34ca47;if(!_0x4b3dfd[_0x13d99d(0x15a)]())fs['rmSync'](temppath+_0x4b3dfd[_0x13d99d(0xb6)]);}),logger[_0x34ca47(0x26b)](_0x34ca47(0xde)),process[_0x34ca47(0xed)]({'restore':!![]},_0x5e27ec=>{});}async function getPublicIp(){const _0x4396d2=_0x2ea84e;try{const _0x5690ed=await axios[_0x4396d2(0x207)](_0x4396d2(0x139));publicip=_0x5690ed[_0x4396d2(0x277)]['ip'];}catch(_0x12b2d1){}}async function triggerAnalytics(){const _0x6a0c16=_0x2ea84e;if(!publicip)await getPublicIp();const _0x339a83=getBotsWithMode();let _0x2f027c=0x0;_0x339a83[_0x6a0c16(0xb1)](_0x264e6f=>{const _0x975d8=_0x6a0c16;if(_0x264e6f['status']===_0x975d8(0xe5))_0x2f027c++;});const _0x1ab93d=getBotExchanges();mixpanel[_0x6a0c16(0x193)](_0x6a0c16(0x267),{'distinct_id':settings[_0x6a0c16(0x1fc)],'ip':publicip,'version':serverversion,'numbots':_0x339a83[_0x6a0c16(0x1c3)],'numbotsenabled':_0x2f027c,'exchanges':_0x1ab93d,'environment':environment});}async function getMessages(){const _0x1690ec=_0x2ea84e,_0x1972b8=_0x1690ec(0x239),_0x315418=new GraphQLClient(_0x1972b8),_0x31fb4c={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x34d510=serverversion[_0x1690ec(0x165)]('.'),_0xd94152=_0x34d510[0x0]+'.'+_0x34d510[0x1],_0x5ef959=Math[_0x1690ec(0x12e)](settings[_0x1690ec(0x23e)],settings[_0x1690ec(0x183)]),_0x21088d={'last':parseInt(_0x5ef959),'bbm':_0xd94152},_0x2b79d4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2106e5;try{_0x2106e5=await _0x315418[_0x1690ec(0x181)](_0x2b79d4,_0x21088d,_0x31fb4c);}catch(_0x1ce38d){}if(_0x2106e5&&_0x2106e5[_0x1690ec(0x237)]){let _0x467af8=settings[_0x1690ec(0x23e)];newMessages=[];for(const _0x20cb23 of _0x2106e5[_0x1690ec(0x237)]){newMessages['push'](_0x20cb23);let _0x21f71a=![];_0x20cb23[_0x1690ec(0xca)]&&(updateSetting(_0x1690ec(0x176),_0x20cb23['bbvNew']),_0x21f71a=isNewerVersion(serverversion,_0x20cb23[_0x1690ec(0xca)])||serverversion==_0x20cb23['bbvNew']);if(!_0x21f71a&&_0x20cb23[_0x1690ec(0x268)]>_0x467af8){if(_0x20cb23[_0x1690ec(0xe8)]===_0x1690ec(0x136)||serverversion['startsWith'](_0x20cb23[_0x1690ec(0xe8)])){let _0x44136c=''+_0x20cb23['title']+'\x0a\x0a'+_0x20cb23[_0x1690ec(0x232)];const _0x40f960=await sendTelegramMsg(toTelegramMarkdown(_0x44136c),_0x1690ec(0x175));if(_0x40f960)_0x467af8=_0x20cb23[_0x1690ec(0x268)];}}}updateAvailable=isNewerVersion(settings[_0x1690ec(0x176)],serverversion),updateSetting(_0x1690ec(0x23e),_0x467af8),emitMessages();}}function emitMessages(){const _0x56027b=_0x2ea84e,_0x3e8876=settings['lastmsgemitted'];let _0x339267=[];newMessages['forEach'](_0x43fd85=>{const _0x2a49ac=_0x4058;_0x43fd85[_0x2a49ac(0x268)]>_0x3e8876&&_0x339267['push'](_0x43fd85);}),_0x339267[_0x56027b(0x1c3)]>0x0&&getAllClients()['forEach'](_0x1d1e69=>{const _0x482474=_0x56027b;getSocket(_0x1d1e69['id'])[_0x482474(0xa6)](_0x482474(0x232),_0x339267);});}function confirmMessage(_0x1dc337){const _0x55dedb=_0x2ea84e;updateSetting(_0x55dedb(0x183),Number(_0x1dc337));}function isNewerVersion(_0x270e09,_0x10c65a){const _0x5cbadf=_0x2ea84e,_0x1b9e2b=_0x10c65a[_0x5cbadf(0x165)]('.'),_0x4c8bcb=_0x270e09[_0x5cbadf(0x165)]('.');for(var _0x1f0566=0x0;_0x1f0566<_0x4c8bcb[_0x5cbadf(0x1c3)];_0x1f0566++){const _0x2bc9b9=~~_0x4c8bcb[_0x1f0566],_0x590445=~~_0x1b9e2b[_0x1f0566];if(_0x2bc9b9>_0x590445)return!![];if(_0x2bc9b9<_0x590445)return![];}return![];}function toTelegramMarkdown(_0x254d47){const _0x2bdeeb=_0x2ea84e,_0x579c9f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4d9287=/\*{2}(.+?)\*{2}/gim;return _0x254d47=_0x254d47['replace'](_0x579c9f,_0x2bdeeb(0x25a))['replace'](_0x4d9287,_0x2bdeeb(0xd6)),_0x254d47;}async function validateConfigFile(){const _0x51805f=_0x2ea84e,_0x189a95=dbConfig[_0x51805f(0x207)](_0x51805f(0x2a1))[_0x51805f(0x1bb)]('botID')[_0x51805f(0x1b3)]()||[];if(_0x189a95['length']==0x0){let _0x3c2f07=0x0,_0x41d4c1=[];const _0x259403=/^bot-([0-9]{3})-config.json$/,_0x3105f8=fs[_0x51805f(0x1dc)](configpath);_0x3105f8[_0x51805f(0xb1)](_0x4be9c3=>{const _0x4d13a5=_0x51805f,_0x2d36ee=_0x259403[_0x4d13a5(0xf4)](_0x4be9c3);if(_0x2d36ee){const _0x539c8f=_0x2d36ee[0x1];let _0x89d528=getBotAttributes(_0x539c8f);_0x41d4c1[_0x4d13a5(0x21b)]({'botID':_0x539c8f,'botname':_0x89d528[_0x4d13a5(0x17b)],'status':_0x4d13a5(0x140),'live':_0x4d13a5(0x26d)}),_0x3c2f07++;}}),_0x3c2f07!=0x0&&(dbConfig[_0x51805f(0x207)](_0x51805f(0x2a1))['assign'](_0x41d4c1)['write'](),config=_0x41d4c1,restoredConfigFile=_0x3c2f07);}}async function restoreConfigNotify(_0x2e5b4c){const _0x147e82=_0x2ea84e;let _0x4cb79a;if(restoredConfigFile==0x1)_0x4cb79a=_0x147e82(0x257);else _0x4cb79a='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x2e5b4c)io['to'](_0x147e82(0x249))[_0x147e82(0xa6)]('notification',_0x4cb79a);else{logger[_0x147e82(0x119)]('-----------------------------------------------------------------------------------'),logger[_0x147e82(0x119)](_0x4cb79a),logger['simple'](_0x147e82(0x20f)),logger[_0x147e82(0x119)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x147e82(0x177)]!='orders')await sendTelegram(settings[_0x147e82(0x23f)],_0x147e82(0x1cf)+_0x4cb79a);}}function validateCredentials(_0x58c5ef,_0x5f380e){const _0x4017d6=_0x2ea84e;if(_0x58c5ef[_0x4017d6(0xef)]==settings[_0x4017d6(0x226)]&&bcrypt[_0x4017d6(0x24b)](_0x58c5ef['password'],settings[_0x4017d6(0x210)])){if(settings[_0x4017d6(0x112)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x377821=generateLoginToken(_0x5f380e);return{'allow':!![],'reason':_0x4017d6(0x171),'token':_0x377821};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x5e392f){const _0x302903=_0x2ea84e,_0x5b4684=generateLoginToken(_0x5e392f);return{'allow':!![],'reason':_0x302903(0x171),'token':_0x5b4684};}function _0x4058(_0xd07c84,_0x4b015b){const _0x2cf67a=_0x197d();return _0x4058=function(_0x4e9624,_0x4a7c87){_0x4e9624=_0x4e9624-0x9a;let _0x197d8a=_0x2cf67a[_0x4e9624];return _0x197d8a;},_0x4058(_0xd07c84,_0x4b015b);}function validateAccess(_0xb5c67c,_0x45b88f,_0x3f3839){const _0x10e219=_0x2ea84e,_0x11d30a=_0x3f3839?_0x3f3839:devices[_0x45b88f]['ip'];let _0x492b27;const _0x391dd0=_0x746281=>{const _0x562ab3=_0x4058;if(settings['loginRequired']){if(settings[_0x562ab3(0x112)]){if(telegram2FaApproved(_0x45b88f)){const _0x31e956=generateLoginToken(_0x45b88f);return{'allow':!![],'reason':_0x562ab3(0x185),'token':_0x31e956};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x492b27=validToken(_0x746281,_0x45b88f),_0x492b27['hasOwnProperty'](_0x562ab3(0xe0))?{'allow':!![],'reason':_0x562ab3(0x11f),'token':_0x746281}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x562ab3(0x135),'token':null};};if(settings[_0x10e219(0xd4)]){let _0xd398a=[...settings[_0x10e219(0x17a)],'::1',_0x10e219(0xff),_0x10e219(0x126)];if(_0xd398a[_0x10e219(0x11c)](_0x11d30a))return _0x391dd0(_0xb5c67c);else{_0x492b27=validToken(_0xb5c67c,_0x45b88f);if(_0x492b27['hasOwnProperty']('success'))return _0x391dd0(_0xb5c67c);else{if(telegramIpApproved(_0x45b88f)){const _0x52de44=generateToken(_0x45b88f);return _0x492b27=_0x391dd0(_0xb5c67c),_0x492b27['allow']?{'allow':!![],'reason':_0x10e219(0x16d),'token':_0x52de44}:_0x492b27;}else return settings[_0x10e219(0x245)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x391dd0(_0xb5c67c);}function timelyDecrypt(_0x100b45,_0x2d5ae8=!![]){const _0x183e7e=_0x2ea84e;if(_0x100b45)try{const _0x52a5e6=crypt['decrypt'](secure[_0x183e7e(0x291)],_0x100b45)['message'],_0x5a10ff=_0x52a5e6[_0x183e7e(0x165)]('@')[0x0],_0x4af67e=_0x52a5e6['split']('@')[0x1],_0x55e345=new Date()[_0x183e7e(0x27e)]();if(_0x2d5ae8){if(_0x55e345-_0x4af67e<maxSecretAge*0x3e8)return _0x5a10ff;else return![];}else return _0x5a10ff;}catch(_0x13d520){return![];}else return![];}const validToken=(_0x2ebc8c,_0x1b464f)=>{const _0x39eb68=_0x2ea84e,_0x44437f=devices[_0x1b464f]['ip'];if(!_0x2ebc8c)return{'error':_0x39eb68(0xdc)};for(let _0x563e79 of blacklist){if(_0x563e79[_0x39eb68(0xc2)]==_0x2ebc8c)return{'error':_0x39eb68(0x170)};}let _0x18341e;try{_0x18341e=jwt[_0x39eb68(0xb7)](_0x2ebc8c,secure['secret']+_0x1b464f);}catch{return{'error':_0x39eb68(0x1af)};}if(!_0x18341e[_0x39eb68(0x292)](_0x39eb68(0x1ad))&&!_0x18341e[_0x39eb68(0x292)](_0x39eb68(0xef))||!_0x18341e[_0x39eb68(0x292)](_0x39eb68(0xa4)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x18341e[_0x39eb68(0x292)](_0x39eb68(0xef))&&_0x18341e[_0x39eb68(0x292)](_0x39eb68(0x1ad))){const {clientip:_0x317b79}=_0x18341e;return _0x44437f==_0x317b79?{'success':_0x39eb68(0x173)}:{'error':_0x39eb68(0x28e)};}else{if(_0x18341e[_0x39eb68(0x292)](_0x39eb68(0xef))&&_0x18341e[_0x39eb68(0x292)]('clientip')){const {username:_0x43f88b,clientip:_0x10d664}=_0x18341e;return settings['bbUsername']==_0x43f88b&&_0x44437f==_0x10d664?{'success':_0x39eb68(0x173)}:{'error':_0x39eb68(0x157)};}}},generateLoginToken=_0x80f6be=>{const _0xc0f336=_0x2ea84e;if(_0x80f6be){const _0x467ad2=devices[_0x80f6be]['ip'];return jwt[_0xc0f336(0x20e)]({'username':settings[_0xc0f336(0x226)],'clientip':_0x467ad2},secure[_0xc0f336(0x113)]+_0x80f6be,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x176709=>{const _0xd221aa=_0x2ea84e;if(_0x176709){const _0x3c53f5=devices[_0x176709]['ip'];return jwt['sign']({'clientip':_0x3c53f5},secure[_0xd221aa(0x113)]+_0x176709,{'expiresIn':devices[_0x176709][_0xd221aa(0x1b7)][_0xd221aa(0x29e)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3773a0=>{const _0x2139cd=_0x2ea84e;let _0x569d34=![];return devices[_0x3773a0][_0x2139cd(0x1b7)]&&devices[_0x3773a0]['telegramIpApproval']['expiry']!=_0x2139cd(0x102)&&(_0x569d34=devices[_0x3773a0]['telegramIpApproval']['clientip']==devices[_0x3773a0]['ip']&&new Date()[_0x2139cd(0x27e)]()-devices[_0x3773a0]['telegramIpApproval'][_0x2139cd(0xec)]<devices[_0x3773a0]['telegramIpApproval'][_0x2139cd(0x29e)]*0x3c*0x3e8),_0x569d34;},telegram2FaApproved=_0x46463b=>{const _0x31345d=_0x2ea84e;let _0x46748e=![];return devices[_0x46463b][_0x31345d(0xad)]&&devices[_0x46463b][_0x31345d(0xad)][_0x31345d(0x29e)]!=_0x31345d(0x102)&&(_0x46748e=devices[_0x46463b][_0x31345d(0xad)][_0x31345d(0x1ad)]==devices[_0x46463b]['ip']&&new Date()['getTime']()-devices[_0x46463b][_0x31345d(0xad)][_0x31345d(0xec)]<devices[_0x46463b][_0x31345d(0xad)]['expiry']*0x3c*0x3e8),_0x46748e;},normalizeIP=_0xf8d2bd=>{const _0x474bdb=_0x2ea84e;let _0x139fd2=null,_0x56d03b=null;if(ipaddr[_0x474bdb(0xfb)](_0xf8d2bd)){const _0x4710c3=ipaddr['parse'](_0xf8d2bd);_0x4710c3[_0x474bdb(0x142)]()===_0x474bdb(0x21c)?(_0x4710c3[_0x474bdb(0x241)]()&&(_0x139fd2=_0x4710c3[_0x474bdb(0x217)]()[_0x474bdb(0x105)]()),_0x56d03b=_0x4710c3[_0x474bdb(0x105)]()):(_0x139fd2=_0x4710c3[_0x474bdb(0x105)](),_0x56d03b=_0x4710c3[_0x474bdb(0x247)]()[_0x474bdb(0x105)]());}return{'show':_0x139fd2?_0x139fd2:_0x56d03b,'store':_0x56d03b};};function formatDate(_0x57fc01){const _0x25ec36=_0x2ea84e;return _0x57fc01[_0x25ec36(0x262)]()+'/'+(_0x57fc01['getMonth']()+0x1)[_0x25ec36(0x105)]()[_0x25ec36(0xc8)](0x2,'0')+'/'+_0x57fc01[_0x25ec36(0x19d)]()[_0x25ec36(0x105)]()[_0x25ec36(0xc8)](0x2,'0')+'\x20'+_0x57fc01['getHours']()[_0x25ec36(0x105)]()[_0x25ec36(0xc8)](0x2,'0')+':'+_0x57fc01['getMinutes']()[_0x25ec36(0x105)]()['padStart'](0x2,'0')+':'+_0x57fc01[_0x25ec36(0x134)]()[_0x25ec36(0x105)]()['padStart'](0x2,'0');}function sleep(_0x207da1){return new Promise(_0x3c4c42=>setTimeout(_0x3c4c42,_0x207da1));}