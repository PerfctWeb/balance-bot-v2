const _0x513efd=_0x3016;(function(_0x1a532e,_0x2bac26){const _0x9d7914=_0x3016,_0x20bfc1=_0x1a532e();while(!![]){try{const _0x913835=-parseInt(_0x9d7914(0x15d))/0x1*(-parseInt(_0x9d7914(0x1cd))/0x2)+parseInt(_0x9d7914(0x277))/0x3+-parseInt(_0x9d7914(0x297))/0x4*(-parseInt(_0x9d7914(0x205))/0x5)+parseInt(_0x9d7914(0x27f))/0x6+-parseInt(_0x9d7914(0x265))/0x7+-parseInt(_0x9d7914(0x2ba))/0x8*(-parseInt(_0x9d7914(0x26a))/0x9)+-parseInt(_0x9d7914(0x2c3))/0xa;if(_0x913835===_0x2bac26)break;else _0x20bfc1['push'](_0x20bfc1['shift']());}catch(_0x543a1e){_0x20bfc1['push'](_0x20bfc1['shift']());}}}(_0x50df,0x6cb2a));const _0x59cb83=function(){let _0xa3804c=!![];return function(_0x559e6b,_0x2831bc){const _0x304cae=_0xa3804c?function(){if(_0x2831bc){const _0x57dac6=_0x2831bc['apply'](_0x559e6b,arguments);return _0x2831bc=null,_0x57dac6;}}:function(){};return _0xa3804c=![],_0x304cae;};}(),_0x23c6ff=_0x59cb83(this,function(){const _0x22f832=_0x3016;return _0x23c6ff['toString']()[_0x22f832(0x2e2)](_0x22f832(0x18e))[_0x22f832(0x287)]()[_0x22f832(0x2bc)](_0x23c6ff)[_0x22f832(0x2e2)](_0x22f832(0x18e));});_0x23c6ff();'use strict';process[_0x513efd(0x2b4)][_0x513efd(0x21b)]=0x1;const childProcess=require(_0x513efd(0x1a1)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x513efd(0x1c4)),crypto=require(_0x513efd(0x1a9)),Crypt=require(_0x513efd(0x175))[_0x513efd(0x263)],RSA=require(_0x513efd(0x175))[_0x513efd(0x155)],bcrypt=require(_0x513efd(0x185)),jwt=require(_0x513efd(0x2df)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x513efd(0x166)]['slice'](0x2))['argv'],uuidRandom=require(_0x513efd(0x17a)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x513efd(0x24c)),axios=require('axios'),{GraphQLClient,gql}=require(_0x513efd(0x303)),util=require(_0x513efd(0x177)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x513efd(0x2fc)]||_0x513efd(0x2e7),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x513efd(0x1cb)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x513efd(0x29d)](0x1));const HOST=argv[_0x513efd(0x20e)]||null,userID=argv[_0x513efd(0x264)]||'',debugging=argv['d']||![],nodeversion=process[_0x513efd(0x2ad)][_0x513efd(0x1f1)];let bbpath=_0x513efd(0x2a6),bbpath2='';const botfile=_0x513efd(0x25d),configfile=_0x513efd(0x26b),settingsfile=_0x513efd(0x161),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x513efd(0x195))[_0x513efd(0x13a)]||_0x513efd(0x1e3),maxBackups=0xa;let validInstallation=!![];!fs[_0x513efd(0x200)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x513efd(0x24b)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x513efd(0x147),configbackuppath=configpath+_0x513efd(0x23e),logspath=userID?bbpath+_0x513efd(0x28d)+userID+'/':bbpath+_0x513efd(0x28d),zippath=userID?bbpath+_0x513efd(0x2e4)+userID+'/':bbpath+_0x513efd(0x2e4),loggerfile=fs[_0x513efd(0x1a8)](logspath+_0x513efd(0x26d),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x513efd(0x2f2);!fs[_0x513efd(0x200)](configpath)&&fs[_0x513efd(0x299)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x513efd(0x299)](configbackuppath);!fs[_0x513efd(0x200)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x513efd(0x200)](zippath)&&fs[_0x513efd(0x299)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x513efd(0x21c)]({'bots':[]})[_0x513efd(0x133)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x513efd(0x207),'onepagemode':![]}})[_0x513efd(0x133)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x513efd(0x21c)]({'secure':{},'blacklist':[]})[_0x513efd(0x133)]();let crypt=new Crypt({'md':_0x513efd(0x138),'rsaStandard':_0x513efd(0x214)});const saltRounds=0xa,mixpanel=Mixpanel[_0x513efd(0x19c)](_0x513efd(0x1d3),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x513efd(0x172)]!=''&&settings[_0x513efd(0x188)]&&settings[_0x513efd(0x188)]!='')initTelegram();const parseColor=(_0x2c8446,_0x47545)=>{const _0x2cdc5e=_0x513efd,_0x8125ff=/#[A-Z]{3}#/g;if(typeof _0x2c8446==_0x2cdc5e(0x298)){!_0x47545?_0x2c8446=_0x2c8446[_0x2cdc5e(0x253)](_0x8125ff,''):(_0x2c8446=_0x2c8446[_0x2cdc5e(0x253)](/#BLU#/g,_0x2cdc5e(0x14e)),_0x2c8446=_0x2c8446[_0x2cdc5e(0x253)](/#RED#/g,_0x2cdc5e(0x2c7)),_0x2c8446=_0x2c8446['replace'](/#YEL#/g,_0x2cdc5e(0x1df)),_0x2c8446=_0x2c8446[_0x2cdc5e(0x253)](/#MAG#/g,'\x1b[35m'),_0x2c8446=_0x2c8446[_0x2cdc5e(0x253)](/#CYA#/g,_0x2cdc5e(0x2d9)),_0x2c8446=_0x2c8446[_0x2cdc5e(0x253)](/#RES#/g,_0x2cdc5e(0x282)));;}return _0x2c8446;},logger={'screen':_0xdc77ab=>{const _0x11ebb4=_0x513efd;console[_0x11ebb4(0x1cb)](parseColor(_0xdc77ab,!![]));},'simple':_0x3913f9=>{const _0x738f3a=_0x513efd;console[_0x738f3a(0x1cb)](parseColor(_0x3913f9,!![])),loggerfile[_0x738f3a(0x133)](util[_0x738f3a(0x209)](parseColor(_0x3913f9,![]))+'\x0a');},'full':async _0x34adad=>{const _0x3f0f47=_0x513efd,_0x2a4c38=getTimeStamp()+_0x3f0f47(0x165)+_0x34adad;console[_0x3f0f47(0x1cb)](parseColor(_0x2a4c38,!![])),loggerfile['write'](util['format'](parseColor(_0x2a4c38,![]))+'\x0a');if(tgBot&&settings[_0x3f0f47(0x168)]&&settings[_0x3f0f47(0x30c)]!=_0x3f0f47(0x259))await tgBot[_0x3f0f47(0x150)](settings[_0x3f0f47(0x168)],_0x3f0f47(0x1e1)+parseColor(_0x34adad,![]))[_0x3f0f47(0x135)](_0x406fad=>{telegramError(_0x406fad);});},'debug':async(_0x7e2c21,_0x517297='')=>{const _0x3d0005=_0x513efd,_0x3c541c=getTimeStamp()+_0x3d0005(0x2bf)+_0x7e2c21;if(debugging)console['log'](parseColor(_0x3c541c,!![]));loggerfile[_0x3d0005(0x133)](util[_0x3d0005(0x209)](parseColor(_0x3c541c,![]))+'\x0a');if(_0x517297){if(debugging)console['log'](_0x517297);loggerfile[_0x3d0005(0x133)](util[_0x3d0005(0x209)](_0x517297)+'\x0a');}}};process['on'](_0x513efd(0x23a),function(_0x5c6631){const _0x2d9703=_0x513efd;logger[_0x2d9703(0x13d)](_0x5c6631);});let restoredConfigFile=0x0,newBot=![],pid=[];function _0x3016(_0x4f47ed,_0x161147){const _0x4a6673=_0x50df();return _0x3016=function(_0x23c6ff,_0x59cb83){_0x23c6ff=_0x23c6ff-0x12e;let _0x50dff1=_0x4a6673[_0x23c6ff];return _0x50dff1;},_0x3016(_0x4f47ed,_0x161147);}const serverversion=require('./'+bbpath2+_0x513efd(0x195))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x513efd(0x1fd)),app=express(),http=require(_0x513efd(0x173))['createServer'](app);app[_0x513efd(0x21f)](fileUpload({'useTempFiles':!![]})),app[_0x513efd(0x1aa)](_0x513efd(0x19e),async(_0x13d973,_0x4fac1c)=>{const _0x906e4c=_0x513efd,_0x1423da=_0x13d973[_0x906e4c(0x1b7)]['type'],_0x5cb548=getClientsWithBotID('botmanager'),_0x227cf6=_0x13d973[_0x906e4c(0x1c1)][_0x906e4c(0x234)],_0x31c25d=timelyDecrypt(_0x227cf6,![]),_0x2bd341=_0x5cb548[_0x906e4c(0x2a5)](_0x11db9d=>_0x11db9d[_0x906e4c(0x234)]==_0x31c25d);if(_0x2bd341){const _0x9e1aca=normalizeIP(_0x13d973['socket']['remoteAddress'])[_0x906e4c(0x13f)],_0x3b480f=_0x13d973[_0x906e4c(0x1c1)][_0x906e4c(0x15f)];if(validateAccess(_0x3b480f,_0x31c25d,_0x9e1aca)[_0x906e4c(0x1b0)])_0x1423da=='backup'&&await backupConfigFiles(),await zipFiles(_0x1423da),_0x4fac1c['download'](zippath+(_0x1423da+_0x906e4c(0x1d4)),_0x5910cf=>{const _0x46461b=_0x906e4c;_0x5910cf&&(logger[_0x46461b(0x160)](_0x46461b(0x2ac)+_0x1423da),logger[_0x46461b(0x13d)](_0x5910cf));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1423da+'\x20(1)');}else logger[_0x906e4c(0x160)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1423da+_0x906e4c(0x192));}),app[_0x513efd(0x307)]('/upload-backup',async(_0x31d803,_0x44aef7)=>{const _0x35f076=_0x513efd,_0x332808=getClientsWithBotID('botmanager'),_0x2a40f8=_0x31d803[_0x35f076(0x1c1)][_0x35f076(0x234)],_0x1280ce=timelyDecrypt(_0x2a40f8,![]),_0x38eba7=_0x332808['find'](_0x1f0dec=>_0x1f0dec[_0x35f076(0x234)]==_0x1280ce);logger[_0x35f076(0x236)](_0x35f076(0x2a7));if(_0x38eba7){const _0x4e0bac=normalizeIP(_0x31d803[_0x35f076(0x17e)]['remoteAddress'])[_0x35f076(0x13f)],_0x131bee=_0x31d803[_0x35f076(0x1c1)][_0x35f076(0x15f)];if(validateAccess(_0x131bee,_0x1280ce,_0x4e0bac)[_0x35f076(0x1b0)]){if(_0x31d803['files']){const _0x5236bc=_0x31d803[_0x35f076(0x16b)][_0x35f076(0x275)];await _0x5236bc['mv'](temppath+_0x5236bc[_0x35f076(0x260)]),_0x44aef7[_0x35f076(0x222)]({'status':!![],'message':_0x35f076(0x225)});const _0x50406c=getBotsWithMode();_0x50406c[_0x35f076(0x1d7)]>0x0?confirmRestore(temppath,_0x5236bc['name']):unzipFile(temppath,_0x5236bc[_0x35f076(0x260)]);}}else logger[_0x35f076(0x160)](_0x35f076(0x29f));}else logger['full'](_0x35f076(0x2b7));}),app['use'](express[_0x513efd(0x1b8)](path[_0x513efd(0x153)](__dirname,bbpath2,_0x513efd(0x25c)))),app[_0x513efd(0x21f)](express[_0x513efd(0x1b8)](path[_0x513efd(0x153)](__dirname,bbpath2,_0x513efd(0x170)))),app[_0x513efd(0x1aa)]('/',function(_0x5d74e9,_0x46d0bb){const _0x4642ae=_0x513efd;_0x46d0bb[_0x4642ae(0x305)](path[_0x4642ae(0x153)](__dirname,bbpath2,_0x4642ae(0x25c),_0x4642ae(0x22d)));}),app['get']('/:bot',function(_0x5d7ff9,_0x55d898){const _0xeb29d3=_0x513efd;_0x55d898[_0xeb29d3(0x305)](path[_0xeb29d3(0x153)](__dirname,bbpath2,_0xeb29d3(0x170),'index.html'));}),app['get'](_0x513efd(0x2e1),(_0x5a9dca,_0xbf0e79)=>{const _0x57c075=_0x513efd;_0xbf0e79[_0x57c075(0x305)](path[_0x57c075(0x153)](__dirname,bbpath2,_0x57c075(0x170),_0x57c075(0x22d)));}),app[_0x513efd(0x1aa)](_0x513efd(0x19d),(_0x4e4e68,_0x8127ec)=>{const _0x52e481=_0x513efd;_0x8127ec['sendFile'](path[_0x52e481(0x153)](__dirname,bbpath2,_0x52e481(0x170),_0x52e481(0x22d)));}),app[_0x513efd(0x1aa)](_0x513efd(0x2d0),(_0x292b2e,_0x41bf80)=>{const _0xc0e100=_0x513efd;_0x41bf80[_0xc0e100(0x305)](path[_0xc0e100(0x153)](__dirname,bbpath2,_0xc0e100(0x170),_0xc0e100(0x22d)));}),app['get'](_0x513efd(0x2fa),(_0x4e6772,_0x4e3ce8)=>{const _0x27e21b=_0x513efd;_0x4e3ce8[_0x27e21b(0x305)](path[_0x27e21b(0x153)](__dirname,bbpath2,_0x27e21b(0x170),'index.html'));}),app['get'](_0x513efd(0x18b),(_0x59590d,_0x1931a6)=>{const _0x3343ed=_0x513efd;_0x1931a6[_0x3343ed(0x305)](path[_0x3343ed(0x153)](__dirname,bbpath2,_0x3343ed(0x170),_0x3343ed(0x22d)));}),app[_0x513efd(0x1aa)](_0x513efd(0x2ae),(_0x5a2d5a,_0x12bbb4)=>{const _0x262e10=_0x513efd;_0x12bbb4[_0x262e10(0x305)](path['join'](__dirname,bbpath2,'build',_0x262e10(0x22d)));});if(HOST)http['listen'](PORT,HOST);else http[_0x513efd(0x1d8)](PORT);const io=require(_0x513efd(0x141))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2e013a=_0x513efd;let _0xe0b2ff=_0x2e013a(0x23c);const _0x11c477=networkInterfaces(),_0x530804={};for(const _0x1966a2 of Object[_0x2e013a(0x191)](_0x11c477)){for(const _0xece10b of _0x11c477[_0x1966a2]){if((_0xece10b['family']==_0x2e013a(0x304)||_0xece10b[_0x2e013a(0x20d)]==0x4)&&!_0xece10b[_0x2e013a(0x221)]){const _0x795a46=ipaddr[_0x2e013a(0x2db)](_0xece10b['address'])[_0x2e013a(0x2e6)]();_0x795a46!='private'&&(!_0x530804[_0x1966a2]&&(_0x530804[_0x1966a2]=[]),_0x530804[_0x1966a2]['push'](_0xece10b[_0x2e013a(0x220)]),_0xe0b2ff=_0xece10b['address']);}}}return{'serverip':_0xe0b2ff,'netinterfaces':_0x530804};}async function startServer(){const _0xb21594=_0x513efd,{serverip:_0x4a41d0,netinterfaces:_0x5c48ee}=getServerIP();logger['simple'](''),logger[_0xb21594(0x13d)](_0xb21594(0x2d6)),await logger[_0xb21594(0x160)](_0xb21594(0x2ab)+serverversion+'#RES#\x20'+(environment=='staging'?_0xb21594(0x2bb):'')+'\x0a'+(_0xb21594(0x1f8)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0xb21594(0x193)+_0x4a41d0+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0xb21594(0x13d)]('-----------------------------------------------------------------------------------');if(config[_0xb21594(0x1d7)]!=0x0)for(const _0x8b0fb6 of config){if(_0x8b0fb6[_0xb21594(0x258)]==_0xb21594(0x1f2)||_0x8b0fb6['status']=='new')await logger[_0xb21594(0x160)](_0xb21594(0x142)+_0x8b0fb6[_0xb21594(0x23d)]+_0xb21594(0x26f)+_0x8b0fb6[_0xb21594(0x25e)]),startBot([_0x8b0fb6[_0xb21594(0x23d)],userID],{'cwd':bbpath},function(_0x5ab611){const _0x1f6ca6=_0xb21594;if(_0x5ab611)logger[_0x1f6ca6(0x160)](_0x5ab611);});else(_0x8b0fb6[_0xb21594(0x258)]==_0xb21594(0x2b6)||_0x8b0fb6['status']=='new-disabled')&&await logger[_0xb21594(0x160)](_0xb21594(0x134)+_0x8b0fb6[_0xb21594(0x23d)]+_0xb21594(0x26f)+_0x8b0fb6[_0xb21594(0x25e)]);}else!newBot&&logger[_0xb21594(0x13d)](_0xb21594(0x309));if(newBot)addBot();logger[_0xb21594(0x13d)](_0xb21594(0x2d6)),logger[_0xb21594(0x13d)](''),await logger[_0xb21594(0x236)](_0xb21594(0x20a)+nodeversion),await logger[_0xb21594(0x236)]('Network\x20Interfaces:',_0x5c48ee);}function startSocket(){io['on']('connection',_0x6336e3=>{const _0x35a0b8=_0x3016;let _0x368dbe,_0xc2d4cf,_0x3d137f,_0x15b137,_0x1bdf05;const _0x422acc=_0x6336e3[_0x35a0b8(0x274)]['headers']['referer'];_0xc2d4cf=_0x422acc[_0x35a0b8(0x2fb)](/bot[0-9]{3}/);if(_0xc2d4cf)_0x3d137f=_0xc2d4cf[0x0][_0x35a0b8(0x2fb)](/[0-9]{3}/);if(_0x3d137f)_0x368dbe=_0x3d137f[0x0];else _0x368dbe='botmanager';const _0x48b22b=_0x6336e3[_0x35a0b8(0x274)]['auth'][_0x35a0b8(0x171)];if(!_0x48b22b)_0x6336e3[_0x35a0b8(0x1b4)](_0x35a0b8(0x258),{'publicKey':secure[_0x35a0b8(0x1e5)]});else{_0x15b137=timelyDecrypt(_0x48b22b,![]);if(!_0x15b137)_0x6336e3[_0x35a0b8(0x1b4)](_0x35a0b8(0x258),{'publicKey':secure[_0x35a0b8(0x1e5)]});else{_0x1bdf05=normalizeIP(_0x6336e3[_0x35a0b8(0x198)][_0x35a0b8(0x2b8)])[_0x35a0b8(0x13f)];if(!devices[_0x15b137])devices[_0x15b137]={'uuid':_0x15b137,'access':{'token':null}};devices[_0x15b137]['ip']=_0x1bdf05;const _0x4157f0=addClient(_0x6336e3['id'],_0x15b137,_0x368dbe);setAccess(_0x4157f0),emitMessages(),_0x6336e3['on'](_0x35a0b8(0x2af),_0x4f7c17=>{const _0x36c079=_0x35a0b8,_0x34a20c=timelyDecrypt(_0x4f7c17['password']);if(_0x34a20c){_0x4f7c17={'username':_0x4f7c17[_0x36c079(0x1a6)],'password':_0x34a20c},devices[_0x15b137][_0x36c079(0x257)]=validateCredentials(_0x4f7c17,_0x15b137);if(devices[_0x15b137][_0x36c079(0x257)]['allow']==![]&&devices[_0x15b137]['access'][_0x36c079(0x2e0)]=='2FA\x20login\x20required')_0x6336e3[_0x36c079(0x1b4)](_0x36c079(0x258),{'access':devices[_0x15b137][_0x36c079(0x257)]}),loginAccess2FA(_0x15b137,_0x1bdf05);else{if(devices[_0x15b137][_0x36c079(0x257)]['allow']==![]&&devices[_0x15b137][_0x36c079(0x257)][_0x36c079(0x2e0)]==_0x36c079(0x294))_0x6336e3[_0x36c079(0x1b4)](_0x36c079(0x258),{'access':devices[_0x15b137][_0x36c079(0x257)]});else devices[_0x15b137]['access'][_0x36c079(0x1b0)]&&devices[_0x15b137][_0x36c079(0x257)][_0x36c079(0x2e0)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x15b137)[_0x36c079(0x248)](_0x361c06=>{setAccess(_0x361c06);}),logger[_0x36c079(0x236)](_0x36c079(0x2a8)+_0x15b137[_0x36c079(0x148)](-0x8)),setTokenRefresh(_0x15b137),setSessionTimeout(_0x36c079(0x2af),_0x15b137));}}else logger['full'](_0x36c079(0x212));}),_0x6336e3['on']('reset-password',()=>{resetPassword();}),_0x6336e3['on']('disconnect',_0x5e5ceb=>{removeClient(_0x6336e3['id']);}),_0x368dbe==_0x35a0b8(0x2c2)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x417ff8){const _0x87f07c=_0x513efd;if(_0x417ff8!='botmanager'&&config[_0x87f07c(0x16c)]!=''){if(pid[_0x417ff8])pid[_0x417ff8][_0x87f07c(0x222)]({'function':_0x87f07c(0x271),'args':null});}_0x417ff8!=_0x87f07c(0x2c2)&&broadcastToBots(_0x87f07c(0x164),JSON['stringify'](config));}function reloadBotManager(){const _0x3bd49f=_0x513efd;getClientsWithBotID(_0x3bd49f(0x2c2))[_0x3bd49f(0x248)](_0x5517ba=>{const _0x37b9b3=_0x3bd49f;getSocket(_0x5517ba['id'])[_0x37b9b3(0x1b4)](_0x37b9b3(0x258),{'access':{'allow':![],'reason':_0x37b9b3(0x1c8),'token':null}});});}function getSocket(_0x22c0d5){const _0x5eec9d=_0x513efd;return io[_0x5eec9d(0x228)][_0x5eec9d(0x228)][_0x5eec9d(0x1aa)](_0x22c0d5);}function setAccess(_0x139f72){const _0xe53b4f=_0x513efd,_0x467ba8=getSocket(_0x139f72['id']),_0x96a5e=_0x139f72[_0xe53b4f(0x234)],_0x2ea911=_0x139f72[_0xe53b4f(0x24a)];devices[_0x96a5e][_0xe53b4f(0x257)]=validateAccess(devices[_0x96a5e][_0xe53b4f(0x257)][_0xe53b4f(0x16e)],_0x96a5e),logger[_0xe53b4f(0x236)](_0xe53b4f(0x194)+devices[_0x96a5e][_0xe53b4f(0x257)][_0xe53b4f(0x2e0)]+_0xe53b4f(0x1f9)+_0x139f72['id'][_0xe53b4f(0x148)](-0x8)+_0xe53b4f(0x187)+_0x96a5e[_0xe53b4f(0x148)](-0x8)),_0x467ba8[_0xe53b4f(0x153)](_0x96a5e);if(devices[_0x96a5e][_0xe53b4f(0x257)][_0xe53b4f(0x1b0)]){_0x467ba8[_0xe53b4f(0x153)](_0x2ea911);if(_0x2ea911==_0xe53b4f(0x2c2))initializeSocketBotManager(_0x467ba8);else initializeSocketBot(_0x467ba8);initClient(_0x2ea911);}devices[_0x96a5e]['access']['token']&&devices[_0x96a5e][_0xe53b4f(0x257)]['reason']==_0xe53b4f(0x27b)&&setSessionTimeout(_0xe53b4f(0x2ca),_0x96a5e),devices[_0x96a5e][_0xe53b4f(0x257)]['token']&&devices[_0x96a5e]['access'][_0xe53b4f(0x2e0)]==_0xe53b4f(0x17d)&&setSessionTimeout('login',_0x96a5e),_0x467ba8[_0xe53b4f(0x1b4)](_0xe53b4f(0x258),{'status':_0x139f72[_0xe53b4f(0x1bb)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x96a5e][_0xe53b4f(0x257)],'externalip':devices[_0x96a5e]['ip'],'publicKey':secure[_0xe53b4f(0x1e5)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x96a5e]['access'][_0xe53b4f(0x1b0)]==![]&&devices[_0x96a5e][_0xe53b4f(0x257)][_0xe53b4f(0x2e0)]==_0xe53b4f(0x2ce)&&temporaryAccess2FA(_0x96a5e,devices[_0x96a5e]['ip']);}function setSessionTimeout(_0x6bf0ad,_0x5a155f){const _0x22f490=_0x513efd;let _0x4fac99;if(_0x6bf0ad==_0x22f490(0x2af))_0x4fac99=loginExpiry*0x3c*0x3e8;else _0x4fac99=devices[_0x5a155f][_0x22f490(0x2b5)]['expiry']*0x3c*0x3e8-(new Date()[_0x22f490(0x290)]()-devices[_0x5a155f]['telegramIpApproval'][_0x22f490(0x2ee)]);if(devices[_0x5a155f][_0x22f490(0x2ec)])clearTimeout(devices[_0x5a155f][_0x22f490(0x2ec)]);devices[_0x5a155f][_0x22f490(0x2ec)]=setTimeout(()=>{const _0x3bd61c=_0x22f490;if(devices[_0x5a155f]['pidRefreshToken'])clearTimeout(devices[_0x5a155f][_0x3bd61c(0x143)]);removeSocketListeners(_0x5a155f),addBlacklist(_0x5a155f),devices[_0x5a155f][_0x3bd61c(0x2b5)]=null,devices[_0x5a155f]['telegram2FaApproval']=null,devices[_0x5a155f][_0x3bd61c(0x257)][_0x3bd61c(0x16e)]=null,logger[_0x3bd61c(0x236)](_0x3bd61c(0x279)+_0x5a155f[_0x3bd61c(0x148)](-0x8)),devices[_0x5a155f][_0x3bd61c(0x257)]=validateAccess(devices[_0x5a155f][_0x3bd61c(0x257)]['token'],_0x5a155f),!(devices[_0x5a155f][_0x3bd61c(0x257)][_0x3bd61c(0x1b0)]&&devices[_0x5a155f][_0x3bd61c(0x257)][_0x3bd61c(0x2e0)]==_0x3bd61c(0x17f))&&(_0x6bf0ad==_0x3bd61c(0x2af)?io['to'](_0x5a155f)[_0x3bd61c(0x1b4)](_0x3bd61c(0x258),{'access':{'allow':![],'reason':_0x3bd61c(0x281),'token':null}}):io['to'](_0x5a155f)[_0x3bd61c(0x1b4)]('status',{'access':{'allow':![],'reason':_0x3bd61c(0x1e7),'token':null}})),devices[_0x5a155f][_0x3bd61c(0x257)][_0x3bd61c(0x16e)]=null;},_0x4fac99);}function setTokenRefresh(_0x44885d){const _0x346570=_0x513efd;if(devices[_0x44885d][_0x346570(0x143)])clearTimeout(devices[_0x44885d][_0x346570(0x143)]);devices[_0x44885d][_0x346570(0x143)]=setTimeout(()=>{const _0x2623e9=_0x346570;getClientsWithUuid(_0x44885d)[_0x2623e9(0x1d7)]!=0x0?(devices[_0x44885d]['access']=refreshToken(_0x44885d),io['to'](_0x44885d)[_0x2623e9(0x1b4)](_0x2623e9(0x258),{'status':_0x2623e9(0x17c),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x44885d][_0x2623e9(0x257)],'externalip':devices[_0x44885d]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x44885d)):clearTimeout(devices[_0x44885d][_0x2623e9(0x143)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1a848e){const _0x2b9453=_0x513efd,_0x4a2ae1=getClient(_0x1a848e['id'])[_0x2b9453(0x234)];_0x1a848e[_0x2b9453(0x1b4)](_0x2b9453(0x164),config),_0x1a848e[_0x2b9453(0x1b4)](_0x2b9453(0x1f7),cleanSettings()),_0x1a848e['on']('add-bot',_0x1601aa=>{const _0x3be34f=_0x2b9453;if(validateAccess(_0x1601aa,_0x4a2ae1)['allow'])addBot();else logger[_0x3be34f(0x160)](_0x3be34f(0x21a));}),_0x1a848e['on'](_0x2b9453(0x280),(_0x5792a3,_0x1ec708)=>{const _0x4d3d84=_0x2b9453;if(validateAccess(_0x1ec708,_0x4a2ae1)['allow'])toggleBot(_0x5792a3[_0x4d3d84(0x23d)],_0x5792a3['status'],_0x5792a3['live']);else logger[_0x4d3d84(0x160)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1a848e['on'](_0x2b9453(0x291),(_0x4cc32b,_0x21988a)=>{const _0xcb410d=_0x2b9453;if(validateAccess(_0x21988a,_0x4a2ae1)['allow'])toggleBotMode(_0x4cc32b);else logger[_0xcb410d(0x160)](_0xcb410d(0x1a7));}),_0x1a848e['on'](_0x2b9453(0x2c4),(_0x4e1b72,_0x1a9aba)=>{const _0x52c3ea=_0x2b9453;if(validateAccess(_0x1a9aba,_0x4a2ae1)[_0x52c3ea(0x1b0)])deleteBot(_0x4e1b72);else logger[_0x52c3ea(0x160)](_0x52c3ea(0x235));}),_0x1a848e['on']('store-settings',(_0x218097,_0x3ba389)=>{const _0x2253fd=_0x2b9453;if(validateAccess(_0x3ba389,_0x4a2ae1)[_0x2253fd(0x1b0)])storeSettings(_0x218097,!![]);else logger['full'](_0x2253fd(0x1cf));}),_0x1a848e['on'](_0x2b9453(0x28b),_0x208cc8=>{const _0x5321bb=_0x2b9453;if(validateAccess(_0x208cc8,_0x4a2ae1)[_0x5321bb(0x1b0)])updateBB(_0x5321bb(0x29b));else logger['full'](_0x5321bb(0x20f));}),_0x1a848e['on'](_0x2b9453(0x26e),_0x4e5863=>{const _0x1e413c=_0x2b9453;if(validateAccess(_0x4e5863,_0x4a2ae1)[_0x1e413c(0x1b0)])updateBB(_0x1e413c(0x2a1));else logger[_0x1e413c(0x160)](_0x1e413c(0x24d));}),_0x1a848e['on'](_0x2b9453(0x249),_0x324801=>{const _0x27eb31=_0x2b9453;if(validateAccess(_0x324801,_0x4a2ae1)[_0x27eb31(0x1b0)]){const _0xfbb1a2=getClient(_0x1a848e['id']);if(_0xfbb1a2)getBackupFiles(_0xfbb1a2[_0x27eb31(0x234)]);else logger[_0x27eb31(0x160)](_0x27eb31(0x296));}else logger[_0x27eb31(0x160)](_0x27eb31(0x208));}),_0x1a848e['on'](_0x2b9453(0x1d5),(_0x28c41e,_0x360b5b)=>{const _0xa7f4da=_0x2b9453;if(validateAccess(_0x360b5b,_0x4a2ae1)[_0xa7f4da(0x1b0)])restoreBackupFile(_0x28c41e);else logger[_0xa7f4da(0x160)](_0xa7f4da(0x2c8));}),_0x1a848e['on'](_0x2b9453(0x190),_0x2aab68=>{const _0x17df71=_0x2b9453;if(validateAccess(_0x2aab68,_0x4a2ae1)['allow'])getMessages();else logger['full'](_0x17df71(0x152));}),_0x1a848e['on']('confirm-message',(_0x369d20,_0x369fbc)=>{const _0x32391f=_0x2b9453;if(validateAccess(_0x369fbc,_0x4a2ae1)[_0x32391f(0x1b0)])confirmMessage(_0x369d20);else logger['full'](_0x32391f(0x2cb));}),_0x1a848e['on'](_0x2b9453(0x146),_0x5dcf67=>{const _0x4ea291=_0x2b9453;if(validateAccess(_0x5dcf67,_0x4a2ae1)[_0x4ea291(0x1b0)]){if(devices[_0x4a2ae1][_0x4ea291(0x143)])clearTimeout(devices[_0x4a2ae1][_0x4ea291(0x143)]);if(devices[_0x4a2ae1][_0x4ea291(0x2ec)])clearTimeout(devices[_0x4a2ae1]['pidExpireLogin']);removeSocketListeners(getClient(_0x1a848e['id'])['uuid']),addBlacklist(_0x4a2ae1),devices[_0x4a2ae1][_0x4ea291(0x2b5)]=null,devices[_0x4a2ae1][_0x4ea291(0x255)]=null,devices[_0x4a2ae1][_0x4ea291(0x257)][_0x4ea291(0x16e)]=null,logger[_0x4ea291(0x236)](_0x4ea291(0x22c)+_0x4a2ae1[_0x4ea291(0x148)](-0x8)),io['to'](getClient(_0x1a848e['id'])['uuid'])['emit'](_0x4ea291(0x258),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x4ea291(0x160)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4c1604){const _0x5cecba=_0x513efd,_0x59c2b6=getClient(_0x4c1604['id'])[_0x5cecba(0x24a)],_0x331b4f=getClient(_0x4c1604['id'])[_0x5cecba(0x234)];_0x4c1604['on'](_0x5cecba(0x2e8),(_0x518b46,_0x53ab90)=>{const _0x294d87=_0x5cecba;if(validateAccess(_0x53ab90,_0x331b4f)[_0x294d87(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6]['send']({'function':_0x294d87(0x1a2),'args':_0x518b46});}else logger['full'](_0x294d87(0x2bd));}),_0x4c1604['on']('delete-alerts',(_0x366db3,_0x301bc4)=>{const _0x26e27c=_0x5cecba;if(validateAccess(_0x301bc4,_0x331b4f)[_0x26e27c(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x26e27c(0x222)]({'function':'deleteHistoryAlerts','args':_0x366db3});}else logger[_0x26e27c(0x160)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x4c1604['on'](_0x5cecba(0x157),(_0x3a181a,_0x23667b)=>{const _0x3385ef=_0x5cecba;if(validateAccess(_0x23667b,_0x331b4f)[_0x3385ef(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x3385ef(0x222)]({'function':_0x3385ef(0x1b3),'args':_0x3a181a});}else logger[_0x3385ef(0x160)](_0x3385ef(0x137));}),_0x4c1604['on']('store-configuration',(_0x34f082,_0x394bfa)=>{const _0x1061ac=_0x5cecba;if(validateAccess(_0x394bfa,_0x331b4f)[_0x1061ac(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x1061ac(0x222)]({'function':_0x1061ac(0x254),'args':_0x34f082});}else logger['full'](_0x1061ac(0x246));}),_0x4c1604['on'](_0x5cecba(0x1dd),(_0x2068be,_0x16fd2c)=>{const _0x5eccd5=_0x5cecba;if(validateAccess(_0x16fd2c,_0x331b4f)[_0x5eccd5(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x5eccd5(0x222)]({'function':_0x5eccd5(0x1ed),'args':_0x2068be});}else logger[_0x5eccd5(0x160)](_0x5eccd5(0x1ec));}),_0x4c1604['on'](_0x5cecba(0x14d),(_0x170e13,_0x4483dc)=>{const _0x28e34=_0x5cecba;if(validateAccess(_0x4483dc,_0x331b4f)['allow']){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x28e34(0x222)]({'function':_0x28e34(0x2c1),'args':_0x170e13});}else logger[_0x28e34(0x160)](_0x28e34(0x2ea));}),_0x4c1604['on']('reset-history',_0x4416cb=>{const _0x5b0dcf=_0x5cecba;if(validateAccess(_0x4416cb,_0x331b4f)[_0x5b0dcf(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x5b0dcf(0x222)]({'function':_0x5b0dcf(0x163),'args':null});}else logger[_0x5b0dcf(0x160)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x4c1604['on'](_0x5cecba(0x30a),_0x4dab68=>{const _0x2e5914=_0x5cecba;if(validateAccess(_0x4dab68,_0x331b4f)[_0x2e5914(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x2e5914(0x222)]({'function':'getStartingBalances','args':null});}else logger[_0x2e5914(0x160)](_0x2e5914(0x1f4));}),_0x4c1604['on'](_0x5cecba(0x1a5),(_0x2fc420,_0x582156)=>{const _0x510675=_0x5cecba;if(validateAccess(_0x582156,_0x331b4f)[_0x510675(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6]['send']({'function':_0x510675(0x2f8),'args':_0x2fc420});}else logger['full'](_0x510675(0x1c7));}),_0x4c1604['on'](_0x5cecba(0x1e4),_0x1e4ad3=>{const _0x863849=_0x5cecba;if(validateAccess(_0x1e4ad3,_0x331b4f)[_0x863849(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x863849(0x222)]({'function':_0x863849(0x1af),'args':null});}else logger[_0x863849(0x160)](_0x863849(0x1b6));}),_0x4c1604['on']('show-config',_0x367e36=>{const _0x43045b=_0x5cecba;if(validateAccess(_0x367e36,_0x331b4f)[_0x43045b(0x1b0)]){if(pid[_0x59c2b6])pid[_0x59c2b6][_0x43045b(0x222)]({'function':_0x43045b(0x2ed),'args':null});}else logger[_0x43045b(0x160)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4c1604['on'](_0x5cecba(0x28b),_0x540b66=>{const _0x4e34f2=_0x5cecba;if(validateAccess(_0x540b66,_0x331b4f)[_0x4e34f2(0x1b0)])updateBB(_0x4e34f2(0x29b));else logger[_0x4e34f2(0x160)](_0x4e34f2(0x20f));}),_0x4c1604['on']('get-messages',_0x403a14=>{const _0x3f1ee3=_0x5cecba;if(validateAccess(_0x403a14,_0x331b4f)[_0x3f1ee3(0x1b0)])getMessages();else logger[_0x3f1ee3(0x160)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4c1604['on']('confirm-message',(_0x36522b,_0x269c6e)=>{const _0x400d22=_0x5cecba;if(validateAccess(_0x269c6e,_0x331b4f)[_0x400d22(0x1b0)])confirmMessage(_0x36522b);else logger[_0x400d22(0x160)](_0x400d22(0x2cb));}),_0x4c1604['on'](_0x5cecba(0x146),_0x560e94=>{const _0x198d4c=_0x5cecba;if(validateAccess(_0x560e94,_0x331b4f)['allow']){if(devices[_0x331b4f]['pidRefreshToken'])clearTimeout(devices[_0x331b4f][_0x198d4c(0x143)]);if(devices[_0x331b4f]['pidExpireLogin'])clearTimeout(devices[_0x331b4f][_0x198d4c(0x2ec)]);removeSocketListeners(getClient(_0x4c1604['id'])[_0x198d4c(0x234)]),addBlacklist(_0x331b4f),devices[_0x331b4f][_0x198d4c(0x2b5)]=null,devices[_0x331b4f][_0x198d4c(0x255)]=null,devices[_0x331b4f]['access'][_0x198d4c(0x16e)]=null,logger['debug'](_0x198d4c(0x22c)+_0x331b4f[_0x198d4c(0x148)](-0x8)),io['to'](getClient(_0x4c1604['id'])[_0x198d4c(0x234)])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x198d4c(0x25b));});}function removeSocketListeners(_0x5dc707){getClientsWithUuid(_0x5dc707)['forEach'](_0x213840=>{getSocket(_0x213840['id'])['removeAllListeners']();});}function cleanSettings(){const _0x1a2192=_0x513efd;let _0x1b90be=settings;return settings[_0x1a2192(0x172)]&&settings[_0x1a2192(0x172)]!=''&&(_0x1b90be={..._0x1b90be,'telegramToken':_0x1a2192(0x1c2)}),settings[_0x1a2192(0x230)]&&settings[_0x1a2192(0x230)]!=''&&(_0x1b90be={..._0x1b90be,'bbPassword':'************'}),(settings[_0x1a2192(0x230)]&&settings[_0x1a2192(0x230)]==_0x1a2192(0x30d)||settings[_0x1a2192(0x172)]&&settings['telegramToken']=='***')&&(_0x1b90be={..._0x1b90be,'restored':{'password':settings['bbPassword']==_0x1a2192(0x30d),'telegram':settings[_0x1a2192(0x172)]==_0x1a2192(0x30d)}}),_0x1b90be;}async function updateBB(_0x994182){const _0x19b342=_0x513efd;await backupConfigFiles(),installingUpdate=!![],config[_0x19b342(0x248)](_0x39b4c3=>{const _0x48965c=_0x19b342;restartBot(_0x39b4c3[_0x48965c(0x23d)]);});if(_0x994182=='update')process[_0x19b342(0x222)]({'update':!![],'environment':environment},_0x57532a=>{});else _0x994182=='reinstall'&&process[_0x19b342(0x222)]({'reinstall':!![],'environment':environment},_0x1e215c=>{});}function startBot(_0x2cc5cc,_0x11fa9c,_0xc11f2){const _0x114b3a=_0x513efd;if(debugging)_0x2cc5cc[_0x114b3a(0x227)]('-d');let _0x363a7e=![];const _0x58f551=_0x2cc5cc[0x0];_0x11fa9c={..._0x11fa9c,'stdio':['inherit','inherit',_0x114b3a(0x219),'ipc']},pid[_0x58f551]=childProcess[_0x114b3a(0x21d)](botfile,_0x2cc5cc,_0x11fa9c),pid[_0x58f551]['on'](_0x114b3a(0x2a0),_0x596269=>{const _0x4fd736=_0x114b3a;switch(Object['keys'](_0x596269)[0x0]){case'botname':updateBotName(_0x58f551,_0x596269[_0x4fd736(0x25e)]);break;case _0x4fd736(0x140):updateBotManager();break;case _0x4fd736(0x258):updateStatus(_0x58f551,_0x596269[_0x4fd736(0x258)]);break;case _0x4fd736(0x2c0):updateLive(_0x58f551,_0x596269[_0x4fd736(0x2c0)]);break;case _0x4fd736(0x283):updateLive(_0x58f551,_0x596269[_0x4fd736(0x283)]),io['to'](_0x58f551)[_0x4fd736(0x1b4)]('status',{'access':{'allow':![],'reason':_0x4fd736(0x1c8),'token':null}});break;case'stop':_0x596269['stop']=='restart'&&restartBot(_0x58f551);_0x596269[_0x4fd736(0x1fa)]==_0x4fd736(0x2b0)&&toggleBot(_0x58f551,'disabled',_0x4fd736(0x25a));break;case'telegram':sendTelegram(_0x58f551,_0x596269[_0x4fd736(0x2d1)]);break;case _0x4fd736(0x25f):sendTelegramMsg(_0x596269[_0x4fd736(0x25f)]);break;case'function':io['to'](_0x58f551)[_0x4fd736(0x1b4)](_0x596269['function'],_0x596269['args']);break;}}),pid[_0x58f551]['on'](_0x114b3a(0x1b2),function(_0x4b340f){if(_0x363a7e)return;_0x363a7e=!![],_0xc11f2(_0x4b340f);}),pid[_0x58f551]['on']('exit',async function(_0x3f9296){const _0x2cc382=_0x114b3a;if(installingUpdate)return;if(_0x363a7e)return;_0x363a7e=!![],_0xc11f2(null);const _0x1ec7cb=dbConfig[_0x2cc382(0x1aa)](_0x2cc382(0x164))[_0x2cc382(0x2a5)]({'botID':_0x58f551})[_0x2cc382(0x21e)]();_0x1ec7cb&&(_0x1ec7cb[_0x2cc382(0x258)]==_0x2cc382(0x1f2)||_0x1ec7cb[_0x2cc382(0x258)]=='new')&&(await sleep(0x3e8),updateLive(_0x58f551,_0x2cc382(0x25a)),logger[_0x2cc382(0x160)](_0x2cc382(0x1b5)+_0x58f551),startBot([_0x58f551,userID],{'cwd':bbpath},function(_0x2c93e6){if(_0x2c93e6)logger['full'](_0x2c93e6);}));});}function stopBot(_0x44e1e1){const _0x203596=_0x513efd;getClientsWithBotID(_0x44e1e1)[_0x203596(0x248)](_0xcff223=>{getSocket(_0xcff223['id'])['disconnect'](!![]),removeClient(_0xcff223['id']);}),pid[_0x44e1e1]&&(pid[_0x44e1e1][_0x203596(0x2b0)](),pid[_0x44e1e1]=null);}function restartBot(_0x447fae){const _0x16a5e4=_0x513efd;if(pid[_0x447fae])pid[_0x447fae][_0x16a5e4(0x2b0)]();}function addBot(){const _0x22d0ed=_0x513efd;let _0x5f0108;for(let _0x24f1b2=0x1;_0x24f1b2<0x3e9;_0x24f1b2++){_0x5f0108=_0x24f1b2['toString']()[_0x22d0ed(0x178)](0x3,'0');let _0x2aa2f6=config[_0x22d0ed(0x2a5)](_0x51d1ae=>_0x51d1ae[_0x22d0ed(0x23d)]==_0x5f0108);if(!_0x2aa2f6)break;}if(_0x5f0108==='1000'){logger[_0x22d0ed(0x160)](_0x22d0ed(0x213));return;}logger[_0x22d0ed(0x160)](_0x22d0ed(0x22f)+_0x5f0108),dbConfig[_0x22d0ed(0x1aa)](_0x22d0ed(0x164))['push']({'botID':_0x5f0108,'botname':_0x22d0ed(0x14c)+_0x5f0108,'status':_0x22d0ed(0x202),'live':''})['write'](),startBot([_0x5f0108,userID],{'cwd':bbpath},function(_0x1b773f){const _0x4012c4=_0x22d0ed;if(_0x1b773f)logger[_0x4012c4(0x160)](_0x1b773f);}),config=getConfiguration(),io['to']('botmanager')[_0x22d0ed(0x1b4)](_0x22d0ed(0x164),config),broadcastToBots(_0x22d0ed(0x164),JSON[_0x22d0ed(0x2ff)](config));}function deleteBot(_0x368a48){const _0xe995d9=_0x513efd;getClientsWithBotID(_0x368a48)[_0xe995d9(0x248)](_0x3ff1cb=>{const _0x399862=_0xe995d9;getSocket(_0x3ff1cb['id'])[_0x399862(0x2a2)](!![]),removeClient(_0x3ff1cb['id']);}),dbConfig[_0xe995d9(0x1aa)](_0xe995d9(0x164))[_0xe995d9(0x224)]({'botID':_0x368a48})[_0xe995d9(0x133)](),logger[_0xe995d9(0x160)]('Deleted\x20Bot\x20'+_0x368a48),stopBot(_0x368a48);try{if(fs[_0xe995d9(0x200)](path[_0xe995d9(0x153)](configpath,_0xe995d9(0x2f1)+_0x368a48+'-config.json')))fs[_0xe995d9(0x261)](path[_0xe995d9(0x153)](configpath,'bot-'+_0x368a48+_0xe995d9(0x1ce)));if(fs[_0xe995d9(0x200)](path[_0xe995d9(0x153)](configpath,'bot-'+_0x368a48+'-events.json')))fs[_0xe995d9(0x261)](path[_0xe995d9(0x153)](configpath,_0xe995d9(0x2f1)+_0x368a48+_0xe995d9(0x158)));if(fs['existsSync'](path[_0xe995d9(0x153)](configpath,'bot-'+_0x368a48+_0xe995d9(0x2c6))))fs[_0xe995d9(0x261)](path['join'](configpath,_0xe995d9(0x2f1)+_0x368a48+'-performance.json'));if(fs[_0xe995d9(0x200)](path['join'](configpath,_0xe995d9(0x2f1)+_0x368a48+'-results.json')))fs[_0xe995d9(0x261)](path[_0xe995d9(0x153)](configpath,_0xe995d9(0x2f1)+_0x368a48+'-results.json'));}catch(_0x11ea1f){if(_0x11ea1f)logger[_0xe995d9(0x160)](_0xe995d9(0x28a),_0x11ea1f);}config=getConfiguration(),io['to'](_0xe995d9(0x2c2))['emit'](_0xe995d9(0x164),config),broadcastToBots(_0xe995d9(0x164),JSON[_0xe995d9(0x2ff)](config));}function toggleBot(_0xde966a,_0x173937,_0xf46093){const _0x58ecdc=_0x513efd;dbConfig['get'](_0x58ecdc(0x164))[_0x58ecdc(0x2a5)]({'botID':_0xde966a})[_0x58ecdc(0x169)]({'status':_0x173937})[_0x58ecdc(0x169)]({'live':_0xf46093})['write']();if(_0x173937==_0x58ecdc(0x1f2)||_0x173937==_0x58ecdc(0x202))logger[_0x58ecdc(0x160)]('Enabled\x20Bot\x20'+_0xde966a),startBot([_0xde966a,userID],{'cwd':bbpath},function(_0x5aedd5){const _0x412d99=_0x58ecdc;if(_0x5aedd5)logger[_0x412d99(0x160)](_0x5aedd5);});else(_0x173937==_0x58ecdc(0x2b6)||_0x173937==_0x58ecdc(0x14b))&&(logger[_0x58ecdc(0x160)](_0x58ecdc(0x14a)+_0xde966a),stopBot(_0xde966a));config=getConfiguration(),io['to'](_0x58ecdc(0x2c2))['emit'](_0x58ecdc(0x164),config),broadcastToBots(_0x58ecdc(0x164),JSON[_0x58ecdc(0x2ff)](config));}function toggleStatus(_0x14ab47){const _0x4da26c=_0x513efd;let _0x5a0e1e=dbConfig[_0x4da26c(0x1aa)](_0x4da26c(0x164))[_0x4da26c(0x2a5)]({'botID':_0x14ab47})['value'](),_0x386ac5;if(_0x5a0e1e['status']===_0x4da26c(0x1f2))_0x386ac5=_0x4da26c(0x2b6);else{if(_0x5a0e1e[_0x4da26c(0x258)]===_0x4da26c(0x202))_0x386ac5=_0x4da26c(0x14b);else{if(_0x5a0e1e[_0x4da26c(0x258)]===_0x4da26c(0x14b))_0x386ac5=_0x4da26c(0x202);else{if(_0x5a0e1e[_0x4da26c(0x258)]===_0x4da26c(0x2b6))_0x386ac5=_0x4da26c(0x1f2);}}}return _0x386ac5;}function updateStatus(_0x2ba80b,_0x3bab79){const _0x209547=_0x513efd;dbConfig['get'](_0x209547(0x164))[_0x209547(0x2a5)]({'botID':_0x2ba80b})[_0x209547(0x169)]({'status':_0x3bab79})[_0x209547(0x133)](),config=getConfiguration(),io['to']('botmanager')[_0x209547(0x1b4)](_0x209547(0x164),config),broadcastToBots(_0x209547(0x164),JSON['stringify'](config));}function updateLive(_0x1b536e,_0x24115c){const _0x3641f0=_0x513efd;dbConfig[_0x3641f0(0x1aa)](_0x3641f0(0x164))[_0x3641f0(0x2a5)]({'botID':_0x1b536e})[_0x3641f0(0x169)]({'live':_0x24115c})['write'](),config=getConfiguration(),io['to'](_0x3641f0(0x2c2))[_0x3641f0(0x1b4)](_0x3641f0(0x164),config),broadcastToBots(_0x3641f0(0x164),JSON['stringify'](config));}function updateBotName(_0x1edf6a,_0x5c1465){const _0x1a4c67=_0x513efd;dbConfig[_0x1a4c67(0x1aa)](_0x1a4c67(0x164))[_0x1a4c67(0x2a5)]({'botID':_0x1edf6a})['assign']({'botname':_0x5c1465})[_0x1a4c67(0x133)](),config=getConfiguration(),io['to'](_0x1a4c67(0x2c2))[_0x1a4c67(0x1b4)]('bots',config),broadcastToBots(_0x1a4c67(0x164),JSON[_0x1a4c67(0x2ff)](config));}function updateBotManager(){const _0x55bb5b=_0x513efd;config=getConfiguration(),io['to'](_0x55bb5b(0x2c2))['emit'](_0x55bb5b(0x164),config),broadcastToBots(_0x55bb5b(0x164),JSON[_0x55bb5b(0x2ff)](config));}function _0x50df(){const _0x246cee=['/names\x20-\x20show\x20bot\x20names\x0a','access','status','orders','stopped','Unauthorized\x20attempt\x20to\x20log\x20out','build2','bot.js','botname','telegrammsg','name','unlinkSync','set','Crypt','user','3783514RUMbJo','/disable\x20-\x20disable\x20notifications\x0a','backup-files','getDate','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','513WApocA','bb-config.json','Starting\x20Balance\x20Bot\x20update','/output-000.log','reinstall-bb','\x20|\x20','All\x20bots','initclient','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','output-001.log','handshake','backupfile','hex','2339970qBUmhJ','whitelist','Session\x20expired\x20for\x20user\x20...','login\x20token\x20generated','temporary\x20token\x20generated','all','/help\x20-\x20show\x20available\x20commands\x0a','404\x20Not\x20Found','1456062jzLAzJ','update-bot','access\x20timeout','\x1b[0m','started','temporary\x20access\x20not\x20allowed','show','Restore\x20backup\x20file\x20','toString','node-zip','getFullYear','Error\x20while\x20deleting\x20config\x20files:\x20','update-bb','onepagemode','logs/','_data','manual','getTime','toggle-bot-mode','2FA\x20login\x20rejected','Yes','invalid\x20credentials','removeListener','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','4tLjGJt','string','mkdirSync','split','update','bbvNew','exit','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','message','reinstall','disconnect','\x20to\x20','from','find','bb/','Backup\x20file\x20uploaded','Logged\x20in\x20user\x20...','writeFileSync','randomBytes','Starting\x20#RED#Balance\x20Bot\x20v','Failed\x20to\x20download\x20','versions','/:bot/support','login','kill','getUTCHours','<b>Telegram\x20Bot\x20Status:</b>\x0a','size','env','telegramIpApproval','disabled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','remoteAddress','timeshift','5128UlKJyr','(staging)','constructor','Unauthorized\x20attempt\x20to\x20get\x20events','Bot\x20Mgr\x20>\x20starting\x20all\x20bots',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','live','storeFiat','botmanager','9842020DlCuIV','delete-bot','secret','-performance.json','\x1b[31m','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Starting\x20Balance\x20Bot\x20reinstallation','2FA','Unauthorized\x20attempt\x20to\x20confirm\x20message','\x20>\x20','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','2FA\x20required','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','/:bot/coins','telegram','expiry','once','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','/enable\x20-\x20enable\x20notifications\x0a','-----------------------------------------------------------------------------------','SIGINT','verify','\x1b[36m','toIPv4MappedAddress','parse','toggleBotMode','Restoring\x20bot(s)\x20from\x20backup','Server','jsonwebtoken','reason','/:bot/portfolio','search','clientip','zip/','headless','range','3000','get-logs','title','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','apiSecret','pidExpireLogin','showConfig','timestamp','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','bot-','temp/','Notifications\x20types:\x20','loginRequired','hashSync','includes','Markdown','placeOrder','warning','/:bot/history','match','port','type','min','stringify','binary','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','graphql-request','IPv4','sendFile','mtime','post','notification','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','get-starting-balances','alias','telegramEvents','***','Orders',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Token\x20blacklisted','settings.','</b>\x20?','output-002.log','write','Idling\x20bot\x20\x20\x20|\x20Bot\x20','catch','Notifications\x20disabled\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','sha256','Invalid\x20Telegram\x20token','environment','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Password\x20reset\x20rejected','simple','privateKey','store','updatebotmanager','socket.io','Starting\x20bot\x20|\x20Bot\x20','pidRefreshToken','statSync','backup-full@','logout','config/','slice','yes','Disabled\x20Bot\x20','new-disabled','Bot\x20','store-fiat','\x1b[34m','backup-full','sendMessage','Backup\x20file\x20unzipped\x20and\x20stored','Unauthorized\x20attempt\x20to\x20get\x20messages','join','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','RSA','answerCallbackQuery','get-portfolio','-events.json','any','ipv6','logs','Notifications\x20disabled','612198sWLHVA','lastmsgemitted','tkn','full','bb-settings.json','f2aRequired','resetHistory','bots',':\x20Bot\x20Mgr\x20>\x20','argv','output-003.log','telegramChatId','assign','*$1*','files','apiKey','output-000.log','token','copyFileSync','build','encryptedUuid','telegramToken','http','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','hybrid-crypto-js','order','util','padStart','stopPolling','uuid-random','Allow\x20login\x20from\x20IP\x20address\x20<b>','connected','2FA\x20login\x20token\x20generated','socket','login\x20not\x20required','isValid','running','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','mode','HTML','bcryptjs','bb-secure.json','\x20|\x20user:\x20...','telegramUsername','sign','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/:bot/configuration','::1','onText','(((.+)+)+)+$','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','get-messages','keys','\x20(2)','=>\x20Go\x20to\x20#CYA#http://','Setting\x20access:\x20','version.json','entries','<b>Balance\x20Bot\x20Status:</b>\x0a','conn','toIPv4Address','exec','data','init','/:bot/performance','/download/:type','15\x20min','Ok,\x20will\x20send\x20alert\x20notifications\x20only','child_process','emitHistory','compareSync','auto','place-order','username','Unauthorized\x20attempt\x20to\x20update\x20bot','createWriteStream','crypto','get','then','getSeconds','max','secure','cancelLoading','allow','All','error','getPortfolio','emit','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','params','static','success','kind','server','reject','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','showname','generate','hasOwnProperty','headers','************','endsWith','path','\x20minutes','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','reload','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','isDirectory','log','All\x20bots\x20running\x20right\x20now','2oiukbI','-config.json','Unauthorized\x20attempt\x20to\x20update\x20settings','randomFillSync','No\x20bots\x20running\x20right\x20now','Password\x20has\x20been\x20reset\x20to:\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','.zip','restore-backup-file','login\x20token\x20valid','length','listen','telegramEnabled','Ok,\x20will\x20send\x20order\x20notifications\x20only','$1_$2_$3','bbvReceive','store-headless','Error\x20removing\x20old\x20backup\x20files:','\x1b[33m','backup','Bot\x20Mgr\x20>\x20','exp','production','cancel-loading','publicKey','https://api.ipify.org?format=json','temporary\x20access\x20timeout','Access\x20enabled\x20for\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','/metrics\x20-\x20show\x20bot\x20performance\x0a','getHours','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','storeHeadless','filter','SIGTERM','/off\x20-\x20stop\x20bot(s)\x0a','node','enabled','callback_query','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','settings','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','\x20|\x20client:\x20...','stop','Login\x20rejected','sortBy','express','backup-full.zip','decrypt','existsSync','sendPortfolioTelegram','new','whitelistEnabled','Your\x20installation\x20is\x20already\x20up\x20to\x20date','1492640quVXjv','Temporary\x20access\x20rejected','0.0.0','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','format','Node.js\x20v','exchange','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','family','host','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','rmSync','alerts','Unauthorized\x20login\x20attempt\x20(timeout)','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','RSA-OAEP','latestversion','bbUsername','login\x20required','readdirSync','inherit','Unauthorized\x20attempt\x20to\x20add\x20bot','NTBA_FIX_319','defaults','fork','value','use','address','internal','send','request','remove','File\x20uploaded','Invalid\x20IP\x20address','push','sockets','User\x20has\x20been\x20validated','blacklist','temporary\x20access\x20rejected','Logged\x20out\x20user\x20...','index.html','file','Starting\x20new\x20bot\x20|\x20Bot\x20','bbPassword','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','getMinutes','::ffff:127.0.0.1','uuid','Unauthorized\x20attempt\x20to\x20delete\x20bot','debug','getMonth','Notifications\x20enabled\x0a','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','uncaughtException','number','[ip-address]','botID','backup/','chat','sort','\x20only\x0a','startsWith','/restart\x20-\x20restart\x20bot(s)\x0a','userid','\x20mode','Unauthorized\x20attempt\x20to\x20store\x20configuration','5\x20min','forEach','get-backup-files','bot','clients','mixpanel','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Restore\x20process\x20aborted','readFileSync','temporaryAccessAllowed','/on\x20-\x20start\x20bot(s)\x0a','lastmsgtelegram','replace','storeConfiguration','telegram2FaApproval'];_0x50df=function(){return _0x246cee;};return _0x50df();}function toggleBotMode(_0x567a58){const _0xd66f7f=_0x513efd;if(pid[_0x567a58])pid[_0x567a58]['send']({'function':_0xd66f7f(0x2dc),'args':null});else{const _0x2da30e=configpath+_0xd66f7f(0x2f1)+_0x567a58+_0xd66f7f(0x1ce),_0x5a61d8=fs[_0xd66f7f(0x24f)](_0x2da30e),_0x3312f8=JSON['parse'](_0x5a61d8),_0x3d3a3a=_0x3312f8[_0xd66f7f(0x24a)][0x0][_0xd66f7f(0x2e5)];_0x3312f8[_0xd66f7f(0x24a)][0x0][_0xd66f7f(0x2e5)]=!_0x3d3a3a;const _0x396f5c=JSON[_0xd66f7f(0x2ff)](_0x3312f8,null,0x2);fs[_0xd66f7f(0x2a9)](_0x2da30e,_0x396f5c),config=getConfiguration(),io['to'](_0xd66f7f(0x2c2))[_0xd66f7f(0x1b4)]('bots',config),broadcastToBots(_0xd66f7f(0x164),JSON[_0xd66f7f(0x2ff)](config));}}function telegramError(_0x34db2c){const _0x13af1d=_0x513efd;logger['simple'](getTimeStamp()+_0x13af1d(0x12e));}function validateTelegram(_0x423139){const _0xc80517=_0x513efd;if(_0x423139[_0xc80517(0x2a4)][_0xc80517(0x1a6)]!=settings[_0xc80517(0x188)]&&'@'+_0x423139['from'][_0xc80517(0x1a6)]!=settings[_0xc80517(0x188)])return tgBot['sendMessage'](_0x423139[_0xc80517(0x23f)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0xc80517(0x135)](_0xe64db8=>{telegramError(_0xe64db8);}),![];return!![];}async function initTelegram(){const _0x360d42=_0x513efd;if(tgBot)tgBot[_0x360d42(0x179)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x360d42(0x172)],{'polling':!![]});let _0x4ddbf6=_0x360d42(0x18a);_0x4ddbf6+='\x0a',_0x4ddbf6+=_0x360d42(0x2d5),_0x4ddbf6+=_0x360d42(0x266),_0x4ddbf6+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4ddbf6+=_0x360d42(0x243),_0x4ddbf6+=_0x360d42(0x251),_0x4ddbf6+=_0x360d42(0x1f0),_0x4ddbf6+=_0x360d42(0x20c),_0x4ddbf6+=_0x360d42(0x256),_0x4ddbf6+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x4ddbf6+=_0x360d42(0x1ea),_0x4ddbf6+=_0x360d42(0x2d4),_0x4ddbf6+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x4ddbf6+=_0x360d42(0x1bd),_0x4ddbf6+=_0x360d42(0x27d);let _0x111f1b=_0x360d42(0x239);_0x111f1b+='\x0a',_0x111f1b+=_0x4ddbf6,tgBot[_0x360d42(0x18d)](/\/start/,_0x34e837=>{const _0x1beec0=_0x360d42;if(!validateTelegram(_0x34e837))return;if(settings[_0x1beec0(0x168)]!=_0x34e837[_0x1beec0(0x23f)]['id'])updateSetting(_0x1beec0(0x168),_0x34e837[_0x1beec0(0x23f)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x34e837[_0x1beec0(0x23f)]['id'],_0x111f1b)[_0x1beec0(0x135)](_0x531a74=>{telegramError(_0x531a74);});}),tgBot[_0x360d42(0x18d)](/\/enable/,_0x4d1ba0=>{const _0x300347=_0x360d42;if(!validateTelegram(_0x4d1ba0))return;if(settings[_0x300347(0x168)]!=_0x4d1ba0[_0x300347(0x23f)]['id'])updateSetting(_0x300347(0x168),_0x4d1ba0[_0x300347(0x23f)]['id']);updateSetting(_0x300347(0x1d9),!![]),tgBot[_0x300347(0x150)](_0x4d1ba0['chat']['id'],'Notifications\x20enabled')['catch'](_0x3d9a78=>{telegramError(_0x3d9a78);});}),tgBot[_0x360d42(0x18d)](/\/config/,async _0x5ce735=>{const _0x52b011=_0x360d42;if(!validateTelegram(_0x5ce735))return;tgBot[_0x52b011(0x295)](_0x52b011(0x1f3)),tgBot[_0x52b011(0x150)](_0x5ce735[_0x52b011(0x23f)]['id'],_0x52b011(0x18f),{'reply_markup':{'inline_keyboard':[[{'text':_0x52b011(0x30e),'callback_data':_0x52b011(0x259)},{'text':'Alerts','callback_data':_0x52b011(0x211)},{'text':_0x52b011(0x1b1),'callback_data':_0x52b011(0x27c)}]]}})['catch'](_0x29ff64=>{telegramError(_0x29ff64);}),tgBot['on'](_0x52b011(0x1f3),async _0x39aa18=>{const _0x59c7f3=_0x52b011,_0x18411a=_0x39aa18[_0x59c7f3(0x19b)],_0x4ed896=_0x39aa18['message'];tgBot[_0x59c7f3(0x156)](_0x39aa18['id'])[_0x59c7f3(0x1ab)](async()=>{const _0xa11382=_0x59c7f3;_0x18411a=='orders'&&(updateSetting(_0xa11382(0x30c),_0xa11382(0x259)),updateSetting(_0xa11382(0x1d9),!![]),await tgBot[_0xa11382(0x150)](_0x4ed896['chat']['id'],_0xa11382(0x1da))[_0xa11382(0x135)](_0x2ea2ba=>{telegramError(_0x2ea2ba);}));_0x18411a==_0xa11382(0x211)&&(updateSetting(_0xa11382(0x30c),_0xa11382(0x211)),updateSetting(_0xa11382(0x1d9),!![]),await tgBot[_0xa11382(0x150)](_0x4ed896[_0xa11382(0x23f)]['id'],_0xa11382(0x1a0))[_0xa11382(0x135)](_0x39f1a7=>{telegramError(_0x39f1a7);}));_0x18411a==_0xa11382(0x27c)&&(updateSetting(_0xa11382(0x30c),'all'),updateSetting(_0xa11382(0x1d9),!![]),await tgBot[_0xa11382(0x150)](_0x4ed896['chat']['id'],_0xa11382(0x272))['catch'](_0x140920=>{telegramError(_0x140920);}));if(!settings[_0xa11382(0x168)])tgBot['sendMessage'](_0x4ed896['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0xa11382(0x135)](_0x302581=>{telegramError(_0x302581);});}),tgBot[_0x59c7f3(0x295)](_0x59c7f3(0x1f3));});}),tgBot[_0x360d42(0x18d)](/\/status/,_0x218886=>{const _0x4b583d=_0x360d42;if(!validateTelegram(_0x218886))return;const _0x3f464d=getBotsWithMode();let _0x432220=_0x4b583d(0x197);config['forEach'](_0x3e97d5=>{const _0x2cb6ab=_0x4b583d,_0x91b09d=_0x3f464d['find'](_0x5d0c41=>_0x5d0c41[_0x2cb6ab(0x23d)]==_0x3e97d5['botID'])[_0x2cb6ab(0x183)];_0x432220+=_0x2cb6ab(0x14c)+_0x3e97d5['botID']+':\x20'+_0x3e97d5[_0x2cb6ab(0x258)]+'\x20|\x20'+_0x91b09d+_0x2cb6ab(0x26f)+_0x3e97d5[_0x2cb6ab(0x2c0)]+'\x0a';}),_0x432220+='\x0a',_0x432220+=_0x4b583d(0x2b2),_0x432220+=!settings[_0x4b583d(0x1d9)]?_0x4b583d(0x136):_0x4b583d(0x238),_0x432220+=settings[_0x4b583d(0x1d9)]?settings[_0x4b583d(0x30c)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x4b583d(0x2f3)+settings[_0x4b583d(0x30c)]+_0x4b583d(0x241):'',tgBot[_0x4b583d(0x150)](_0x218886[_0x4b583d(0x23f)]['id'],_0x432220,{'parse_mode':_0x4b583d(0x184)})[_0x4b583d(0x135)](_0x4899d6=>{telegramError(_0x4899d6);});}),tgBot[_0x360d42(0x18d)](/\/restart/,_0x3fef85=>{const _0x53add6=_0x360d42;if(!validateTelegram(_0x3fef85))return;tgBot[_0x53add6(0x295)](_0x53add6(0x1f3));const _0x14caa6=getEnabledBots();if(_0x14caa6[_0x53add6(0x1d7)]==0x0)tgBot['sendMessage'](_0x3fef85['chat']['id'],_0x53add6(0x1d1))[_0x53add6(0x135)](_0x64b042=>{telegramError(_0x64b042);});else{if(_0x14caa6[_0x53add6(0x1d7)]>0x1)_0x14caa6[_0x53add6(0x227)]({'botID':_0x53add6(0x27c)});let _0x543096=[],_0x4c50ea=[];const _0x3aa81d=_0x14caa6[_0x53add6(0x1d7)]%0x4==0x0||_0x14caa6['length']%0x4==0x3||_0x14caa6['length']%0x3==0x1?0x4:0x3;let _0x4726d7=0x0;_0x14caa6[_0x53add6(0x248)]((_0x2cace1,_0x2b4dcd)=>{const _0x323c4b=_0x53add6;if(_0x2b4dcd%_0x3aa81d==0x0)_0x4c50ea=[];_0x4c50ea['push']({'text':_0x2cace1[_0x323c4b(0x23d)]==_0x323c4b(0x27c)?_0x323c4b(0x270):_0x323c4b(0x14c)+_0x2cace1[_0x323c4b(0x23d)],'callback_data':_0x2cace1[_0x323c4b(0x23d)]}),_0x2b4dcd%_0x3aa81d==0x0&&(_0x543096[_0x4726d7]=_0x4c50ea,_0x4726d7++);}),tgBot[_0x53add6(0x150)](_0x3fef85[_0x53add6(0x23f)]['id'],_0x53add6(0x2f0),{'reply_markup':{'inline_keyboard':_0x543096}})['catch'](_0x2e93af=>{telegramError(_0x2e93af);}),tgBot['on'](_0x53add6(0x1f3),async _0x34b526=>{const _0x1a0dcb=_0x53add6,_0x52cd82=_0x34b526[_0x1a0dcb(0x19b)],_0x4d5596=_0x34b526[_0x1a0dcb(0x2a0)];tgBot[_0x1a0dcb(0x156)](_0x34b526['id'])[_0x1a0dcb(0x1ab)](async()=>{const _0x3d0618=_0x1a0dcb;_0x52cd82==_0x3d0618(0x27c)?config['forEach'](_0x16912b=>{const _0x4c8a82=_0x3d0618;restartBot(_0x16912b[_0x4c8a82(0x23d)]);}):restartBot(_0x52cd82);}),tgBot[_0x1a0dcb(0x295)](_0x1a0dcb(0x1f3));});}}),tgBot['onText'](/\/on/,_0x5482c3=>{const _0x479700=_0x360d42;if(!validateTelegram(_0x5482c3))return;tgBot['removeListener'](_0x479700(0x1f3));const _0x5dc464=getDisabledBots();if(_0x5dc464[_0x479700(0x1d7)]==0x0)tgBot['sendMessage'](_0x5482c3[_0x479700(0x23f)]['id'],_0x479700(0x1cc))[_0x479700(0x135)](_0x2178f8=>{telegramError(_0x2178f8);});else{if(_0x5dc464[_0x479700(0x1d7)]>0x1)_0x5dc464[_0x479700(0x227)]({'botID':_0x479700(0x27c)});let _0x30e50b=[],_0x3eefad=[];const _0x351966=_0x5dc464[_0x479700(0x1d7)]%0x4==0x0||_0x5dc464[_0x479700(0x1d7)]%0x4==0x3||_0x5dc464[_0x479700(0x1d7)]%0x3==0x1?0x4:0x3;let _0x346c91=0x0;_0x5dc464[_0x479700(0x248)]((_0x3ff99f,_0x4a1135)=>{const _0x11dec3=_0x479700;if(_0x4a1135%_0x351966==0x0)_0x3eefad=[];_0x3eefad[_0x11dec3(0x227)]({'text':_0x3ff99f[_0x11dec3(0x23d)]==_0x11dec3(0x27c)?_0x11dec3(0x270):'Bot\x20'+_0x3ff99f[_0x11dec3(0x23d)],'callback_data':_0x3ff99f[_0x11dec3(0x23d)]}),_0x4a1135%_0x351966==0x0&&(_0x30e50b[_0x346c91]=_0x3eefad,_0x346c91++);}),tgBot[_0x479700(0x150)](_0x5482c3['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x30e50b}})[_0x479700(0x135)](_0x358727=>{telegramError(_0x358727);}),tgBot['on'](_0x479700(0x1f3),async _0x4a20af=>{const _0x149e14=_0x479700,_0x426707=_0x4a20af['data'],_0x289fc4=_0x4a20af[_0x149e14(0x2a0)];tgBot[_0x149e14(0x156)](_0x4a20af['id'])[_0x149e14(0x1ab)](async()=>{const _0x5e2b5e=_0x149e14;_0x426707==_0x5e2b5e(0x27c)?(tgBot[_0x5e2b5e(0x150)](_0x289fc4['chat']['id'],_0x5e2b5e(0x2be))['catch'](_0x4a644d=>{telegramError(_0x4a644d);}),_0x5dc464[_0x5e2b5e(0x248)](_0x31f7b2=>{const _0x2ff6f6=_0x5e2b5e;if(_0x31f7b2['botID']!=_0x2ff6f6(0x27c))toggleBot(_0x31f7b2['botID'],toggleStatus(_0x31f7b2[_0x2ff6f6(0x23d)]),_0x2ff6f6(0x25a));})):(tgBot['sendMessage'](_0x289fc4[_0x5e2b5e(0x23f)]['id'],_0x5e2b5e(0x174)+_0x426707)[_0x5e2b5e(0x135)](_0x2cbda1=>{telegramError(_0x2cbda1);}),toggleBot(_0x426707,toggleStatus(_0x426707),'stopped'));}),tgBot[_0x149e14(0x295)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x31c09d=>{const _0x17837a=_0x360d42;if(!validateTelegram(_0x31c09d))return;tgBot['removeListener'](_0x17837a(0x1f3));const _0x14f749=getEnabledBots();if(_0x14f749[_0x17837a(0x1d7)]==0x0)tgBot[_0x17837a(0x150)](_0x31c09d[_0x17837a(0x23f)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x34755d=>{telegramError(_0x34755d);});else{if(_0x14f749['length']>0x1)_0x14f749[_0x17837a(0x227)]({'botID':_0x17837a(0x27c)});let _0x38eb70=[],_0x5b811b=[];const _0x4fb9a6=_0x14f749[_0x17837a(0x1d7)]%0x4==0x0||_0x14f749[_0x17837a(0x1d7)]%0x4==0x3||_0x14f749[_0x17837a(0x1d7)]%0x3==0x1?0x4:0x3;let _0x3d37ed=0x0;_0x14f749[_0x17837a(0x248)]((_0xf973f,_0x5352f1)=>{const _0x335796=_0x17837a;if(_0x5352f1%_0x4fb9a6==0x0)_0x5b811b=[];_0x5b811b['push']({'text':_0xf973f[_0x335796(0x23d)]==_0x335796(0x27c)?'All\x20bots':_0x335796(0x14c)+_0xf973f['botID'],'callback_data':_0xf973f[_0x335796(0x23d)]}),_0x5352f1%_0x4fb9a6==0x0&&(_0x38eb70[_0x3d37ed]=_0x5b811b,_0x3d37ed++);}),tgBot[_0x17837a(0x150)](_0x31c09d[_0x17837a(0x23f)]['id'],_0x17837a(0x1f6),{'reply_markup':{'inline_keyboard':_0x38eb70}})['catch'](_0x35a4bd=>{telegramError(_0x35a4bd);}),tgBot['on']('callback_query',async _0x250330=>{const _0x266586=_0x17837a,_0x567f8c=_0x250330[_0x266586(0x19b)],_0x4a93d4=_0x250330[_0x266586(0x2a0)];tgBot['answerCallbackQuery'](_0x250330['id'])['then'](async()=>{const _0x21d0f3=_0x266586;_0x567f8c=='all'?(tgBot[_0x21d0f3(0x150)](_0x4a93d4['chat']['id'],_0x21d0f3(0x29e))[_0x21d0f3(0x135)](_0x4ac4e2=>{telegramError(_0x4ac4e2);}),_0x14f749[_0x21d0f3(0x248)](_0x5c0457=>{const _0x475be3=_0x21d0f3;if(_0x5c0457['botID']!=_0x475be3(0x27c))toggleBot(_0x5c0457[_0x475be3(0x23d)],toggleStatus(_0x5c0457['botID']),_0x475be3(0x25a));})):(tgBot[_0x21d0f3(0x150)](_0x4a93d4[_0x21d0f3(0x23f)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x567f8c)[_0x21d0f3(0x135)](_0x2a7982=>{telegramError(_0x2a7982);}),toggleBot(_0x567f8c,toggleStatus(_0x567f8c),_0x21d0f3(0x25a)));}),tgBot[_0x266586(0x295)]('callback_query');});}}),tgBot[_0x360d42(0x18d)](/\/metrics/,_0x353ce4=>{const _0x33daaf=_0x360d42;if(!validateTelegram(_0x353ce4))return;tgBot[_0x33daaf(0x295)]('callback_query');const _0x5bb0c6=getEnabledBots();if(_0x5bb0c6['length']==0x0)tgBot[_0x33daaf(0x150)](_0x353ce4[_0x33daaf(0x23f)]['id'],_0x33daaf(0x1d1))[_0x33daaf(0x135)](_0x45699f=>{telegramError(_0x45699f);});else{if(_0x5bb0c6[_0x33daaf(0x1d7)]>0x1){let _0x16ffe1=[],_0x3c4398=[];const _0x388b1c=_0x5bb0c6[_0x33daaf(0x1d7)]%0x4==0x0||_0x5bb0c6[_0x33daaf(0x1d7)]%0x4==0x3||_0x5bb0c6[_0x33daaf(0x1d7)]%0x3==0x1?0x4:0x3;let _0x496de5=0x0;_0x5bb0c6[_0x33daaf(0x248)]((_0x8a7283,_0x5c3fa7)=>{const _0xbd17f7=_0x33daaf;if(_0x5c3fa7%_0x388b1c==0x0)_0x3c4398=[];_0x3c4398[_0xbd17f7(0x227)]({'text':'Bot\x20'+_0x8a7283['botID'],'callback_data':_0x8a7283[_0xbd17f7(0x23d)]}),_0x5c3fa7%_0x388b1c==0x0&&(_0x16ffe1[_0x496de5]=_0x3c4398,_0x496de5++);}),tgBot[_0x33daaf(0x150)](_0x353ce4[_0x33daaf(0x23f)]['id'],_0x33daaf(0x13b),{'reply_markup':{'inline_keyboard':_0x16ffe1}})[_0x33daaf(0x135)](_0x45bae2=>{telegramError(_0x45bae2);}),tgBot['on']('callback_query',async _0x1d0491=>{const _0x1b7675=_0x33daaf,_0x306fa9=_0x1d0491[_0x1b7675(0x19b)],_0x30b9d9=_0x1d0491[_0x1b7675(0x2a0)];tgBot[_0x1b7675(0x156)](_0x1d0491['id'])[_0x1b7675(0x1ab)](async()=>{const _0xd8f9bd=_0x1b7675;if(pid[_0x306fa9])pid[_0x306fa9][_0xd8f9bd(0x222)]({'function':'sendMetricsTelegram','args':null});}),tgBot['removeListener'](_0x1b7675(0x1f3));});}else{const _0x4a1e25=_0x5bb0c6[0x0][_0x33daaf(0x23d)];if(pid[_0x4a1e25])pid[_0x4a1e25]['send']({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x360d42(0x18d)](/\/portfolio/,_0x15f535=>{const _0xaeb13f=_0x360d42;if(!validateTelegram(_0x15f535))return;tgBot[_0xaeb13f(0x295)](_0xaeb13f(0x1f3));const _0x492fd9=getEnabledBots();if(_0x492fd9[_0xaeb13f(0x1d7)]==0x0)tgBot[_0xaeb13f(0x150)](_0x15f535[_0xaeb13f(0x23f)]['id'],_0xaeb13f(0x1d1))[_0xaeb13f(0x135)](_0x2419f9=>{telegramError(_0x2419f9);});else{if(_0x492fd9[_0xaeb13f(0x1d7)]>0x1){let _0x208c90=[],_0x32301a=[];const _0x26c979=_0x492fd9[_0xaeb13f(0x1d7)]%0x4==0x0||_0x492fd9[_0xaeb13f(0x1d7)]%0x4==0x3||_0x492fd9['length']%0x3==0x1?0x4:0x3;let _0x6776a5=0x0;_0x492fd9[_0xaeb13f(0x248)]((_0x4b7d11,_0x24a339)=>{const _0x283fcb=_0xaeb13f;if(_0x24a339%_0x26c979==0x0)_0x32301a=[];_0x32301a[_0x283fcb(0x227)]({'text':_0x283fcb(0x14c)+_0x4b7d11['botID'],'callback_data':_0x4b7d11[_0x283fcb(0x23d)]}),_0x24a339%_0x26c979==0x0&&(_0x208c90[_0x6776a5]=_0x32301a,_0x6776a5++);}),tgBot[_0xaeb13f(0x150)](_0x15f535[_0xaeb13f(0x23f)]['id'],_0xaeb13f(0x269),{'reply_markup':{'inline_keyboard':_0x208c90}})[_0xaeb13f(0x135)](_0x581a2f=>{telegramError(_0x581a2f);}),tgBot['on']('callback_query',async _0x108b6b=>{const _0x7d25cf=_0xaeb13f,_0x220b8d=_0x108b6b['data'],_0xb99a3b=_0x108b6b[_0x7d25cf(0x2a0)];tgBot['answerCallbackQuery'](_0x108b6b['id'])[_0x7d25cf(0x1ab)](async()=>{const _0x2e9c1f=_0x7d25cf;if(pid[_0x220b8d])pid[_0x220b8d][_0x2e9c1f(0x222)]({'function':_0x2e9c1f(0x201),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x2634c9=_0x492fd9[0x0]['botID'];if(pid[_0x2634c9])pid[_0x2634c9][_0xaeb13f(0x222)]({'function':_0xaeb13f(0x201),'args':null});}}}),tgBot['onText'](/\/update/,async _0x293d7e=>{const _0x387f5c=_0x360d42;if(!validateTelegram(_0x293d7e))return;tgBot['removeListener']('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x387f5c(0x150)](_0x293d7e[_0x387f5c(0x23f)]['id'],_0x387f5c(0x204))[_0x387f5c(0x135)](_0x333192=>{telegramError(_0x333192);});else!validInstallation?tgBot[_0x387f5c(0x150)](_0x293d7e[_0x387f5c(0x23f)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x387f5c(0x135)](_0x36cc4c=>{telegramError(_0x36cc4c);}):(tgBot[_0x387f5c(0x150)](_0x293d7e[_0x387f5c(0x23f)]['id'],_0x387f5c(0x1f5),{'reply_markup':{'inline_keyboard':[[{'text':_0x387f5c(0x293),'callback_data':_0x387f5c(0x149)},{'text':'No','callback_data':'no'}]]}})[_0x387f5c(0x135)](_0x45f6a6=>{telegramError(_0x45f6a6);}),tgBot['on'](_0x387f5c(0x1f3),async _0x2b7eff=>{const _0x3fbaf5=_0x387f5c,_0x50d701=_0x2b7eff[_0x3fbaf5(0x19b)],_0x59ddf9=_0x2b7eff[_0x3fbaf5(0x2a0)];tgBot['answerCallbackQuery'](_0x2b7eff['id'])['then'](async()=>{const _0xd91f3e=_0x3fbaf5;_0x50d701==_0xd91f3e(0x149)&&(await tgBot[_0xd91f3e(0x150)](_0x59ddf9[_0xd91f3e(0x23f)]['id'],_0xd91f3e(0x26c))[_0xd91f3e(0x135)](_0x3a243b=>{telegramError(_0x3a243b);}),updateBB('update')),_0x50d701=='no'&&await tgBot[_0xd91f3e(0x150)](_0x59ddf9[_0xd91f3e(0x23f)]['id'],_0xd91f3e(0x231))[_0xd91f3e(0x135)](_0x3487dc=>{telegramError(_0x3487dc);});}),tgBot[_0x3fbaf5(0x295)]('callback_query');}));}),tgBot[_0x360d42(0x18d)](/\/reinstall/,async _0x237d32=>{const _0x10dd3b=_0x360d42;if(!validateTelegram(_0x237d32))return;tgBot[_0x10dd3b(0x295)](_0x10dd3b(0x1f3)),!validInstallation?tgBot[_0x10dd3b(0x150)](_0x237d32[_0x10dd3b(0x23f)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')['catch'](_0x47397c=>{telegramError(_0x47397c);}):(tgBot[_0x10dd3b(0x150)](_0x237d32['chat']['id'],_0x10dd3b(0x1c9),{'reply_markup':{'inline_keyboard':[[{'text':_0x10dd3b(0x293),'callback_data':_0x10dd3b(0x149)},{'text':'No','callback_data':'no'}]]}})[_0x10dd3b(0x135)](_0x3ba445=>{telegramError(_0x3ba445);}),tgBot['on'](_0x10dd3b(0x1f3),async _0x258e81=>{const _0x36b715=_0x10dd3b,_0x1e2a69=_0x258e81[_0x36b715(0x19b)],_0x898c60=_0x258e81[_0x36b715(0x2a0)];tgBot[_0x36b715(0x156)](_0x258e81['id'])[_0x36b715(0x1ab)](async()=>{const _0x5d562c=_0x36b715;_0x1e2a69==_0x5d562c(0x149)&&(await tgBot[_0x5d562c(0x150)](_0x898c60[_0x5d562c(0x23f)]['id'],_0x5d562c(0x2c9))[_0x5d562c(0x135)](_0x53834e=>{telegramError(_0x53834e);}),updateBB('reinstall')),_0x1e2a69=='no'&&await tgBot[_0x5d562c(0x150)](_0x898c60[_0x5d562c(0x23f)]['id'],_0x5d562c(0x302))['catch'](_0x23db70=>{telegramError(_0x23db70);});}),tgBot[_0x36b715(0x295)](_0x36b715(0x1f3));}));}),tgBot[_0x360d42(0x18d)](/\/toggle/,_0x376fc4=>{const _0x1d5b51=_0x360d42;if(!validateTelegram(_0x376fc4))return;tgBot['removeListener']('callback_query');const _0x4cb66e=getBotsWithMode();if(_0x4cb66e[_0x1d5b51(0x1d7)]==0x0)tgBot['sendMessage'](_0x376fc4[_0x1d5b51(0x23f)]['id'],_0x1d5b51(0x1d1))[_0x1d5b51(0x135)](_0x22f466=>{telegramError(_0x22f466);});else{let _0xca900c=[],_0x23c452=[];const _0x354f02=0x2;let _0x3d747d=0x0;_0x4cb66e[_0x1d5b51(0x248)]((_0x156f25,_0x485580)=>{const _0x52fc13=_0x1d5b51;if(_0x485580%_0x354f02==0x0)_0x23c452=[];_0x23c452[_0x52fc13(0x227)]({'text':_0x52fc13(0x14c)+_0x156f25[_0x52fc13(0x23d)]+'\x20('+_0x156f25[_0x52fc13(0x183)]+')','callback_data':_0x156f25['botID']}),_0x485580%_0x354f02==0x0&&(_0xca900c[_0x3d747d]=_0x23c452,_0x3d747d++);}),tgBot[_0x1d5b51(0x150)](_0x376fc4[_0x1d5b51(0x23f)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0xca900c}})[_0x1d5b51(0x135)](_0x14558e=>{telegramError(_0x14558e);}),tgBot['on'](_0x1d5b51(0x1f3),async _0x27c7b2=>{const _0x249704=_0x1d5b51,_0x225da0=_0x27c7b2[_0x249704(0x19b)],_0x387905=_0x27c7b2[_0x249704(0x2a0)];tgBot['answerCallbackQuery'](_0x27c7b2['id'])[_0x249704(0x1ab)](async()=>{const _0x377a5a=_0x249704,_0x125d56=_0x4cb66e[_0x377a5a(0x2a5)](_0x57c5d7=>_0x57c5d7[_0x377a5a(0x23d)]==_0x225da0),_0x5d55c1=_0x125d56[_0x377a5a(0x183)]==_0x377a5a(0x1a4)?'manual':'auto';tgBot['sendMessage'](_0x387905[_0x377a5a(0x23f)]['id'],_0x377a5a(0x182)+_0x225da0+_0x377a5a(0x2a3)+_0x5d55c1+_0x377a5a(0x245))['catch'](_0x5cf1fb=>{telegramError(_0x5cf1fb);}),toggleBotMode(_0x225da0);}),tgBot[_0x249704(0x295)](_0x249704(0x1f3));});}}),tgBot[_0x360d42(0x18d)](/\/names/,_0xb1d8f4=>{const _0xc1a3e1=_0x360d42;if(!validateTelegram(_0xb1d8f4))return;let _0x36c234='';config['forEach'](_0x3efd81=>{const _0x457f1e=_0x3016;_0x36c234+=_0x457f1e(0x14c)+_0x3efd81[_0x457f1e(0x23d)]+':\x20'+_0x3efd81[_0x457f1e(0x25e)]+'\x0a';}),tgBot[_0xc1a3e1(0x150)](_0xb1d8f4['chat']['id'],_0x36c234,{'parse_mode':'HTML'})[_0xc1a3e1(0x135)](_0x230a2b=>{telegramError(_0x230a2b);});}),tgBot[_0x360d42(0x18d)](/\/disable/,_0x1f4a29=>{const _0x5ae5bb=_0x360d42;if(!validateTelegram(_0x1f4a29))return;tgBot[_0x5ae5bb(0x150)](_0x1f4a29['chat']['id'],_0x5ae5bb(0x15c))[_0x5ae5bb(0x135)](_0x21b716=>{telegramError(_0x21b716);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x360d42(0x18d)](/\/help/,_0x438423=>{const _0x4357ce=_0x360d42;if(!validateTelegram(_0x438423))return;tgBot[_0x4357ce(0x150)](_0x438423[_0x4357ce(0x23f)]['id'],_0x4ddbf6)['catch'](_0x2ce9a1=>{telegramError(_0x2ce9a1);});}),tgBot['on']('polling_error',_0x5e0319=>{const _0x2fd2c1=_0x360d42;_0x5e0319[_0x2fd2c1(0x287)]()[_0x2fd2c1(0x2f6)](_0x2fd2c1(0x27e))&&(logger[_0x2fd2c1(0x160)](_0x2fd2c1(0x139)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x2fd2c1(0x2c2))[_0x2fd2c1(0x1b4)](_0x2fd2c1(0x308),'Invalid\x20Telegram\x20token'));}),process[_0x360d42(0x2d3)](_0x360d42(0x2d7),()=>{const _0x4e6372=_0x360d42;if(tgBot)tgBot[_0x4e6372(0x179)]();process[_0x4e6372(0x29d)](0x1);}),process[_0x360d42(0x2d3)](_0x360d42(0x1ef),()=>{const _0x30762e=_0x360d42;if(tgBot)tgBot[_0x30762e(0x179)]();process[_0x30762e(0x29d)](0x1);});}}function disableTelegram(){const _0x1c9069=_0x513efd;tgBot&&(tgBot[_0x1c9069(0x179)](),tgBot=null);}function sendTelegram(_0x1e84b9,_0x258910){const _0x46b4d9=_0x513efd;if(settings[_0x46b4d9(0x1d9)]){if(settings[_0x46b4d9(0x30c)]==_0x46b4d9(0x27c)||(_0x258910['type']=='error'||_0x258910[_0x46b4d9(0x2fd)]==_0x46b4d9(0x2f9)||_0x258910['type']=='success')&&settings[_0x46b4d9(0x30c)]==_0x46b4d9(0x211)||_0x258910[_0x46b4d9(0x2fd)]==_0x46b4d9(0x176)&&settings[_0x46b4d9(0x30c)]==_0x46b4d9(0x259)){if(tgBot&&settings[_0x46b4d9(0x168)]){if(_0x258910[_0x46b4d9(0x1be)])tgBot[_0x46b4d9(0x150)](settings[_0x46b4d9(0x168)],_0x258910['botname']+_0x46b4d9(0x2cc)+_0x258910['event'])[_0x46b4d9(0x135)](_0x3d4f6c=>{telegramError(_0x3d4f6c);});else tgBot[_0x46b4d9(0x150)](settings[_0x46b4d9(0x168)],'Bot\x20'+_0x1e84b9+_0x46b4d9(0x2cc)+_0x258910['event'])[_0x46b4d9(0x135)](_0xc3f601=>{telegramError(_0xc3f601);});}}}}async function sendTelegramMsg(_0x774d76,_0x27991a=_0x513efd(0x184)){const _0x10bdb9=_0x513efd;return settings[_0x10bdb9(0x1d9)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings['telegramChatId'],_0x774d76,{'parse_mode':_0x27991a})['catch'](_0x33e713=>{telegramError(_0x33e713);}),!![]):![];}function getDeviceWithIp(_0x51a859){const _0xc01660=_0x513efd;return devices[_0xc01660(0x2a5)](_0x3ebda3=>_0x3ebda3['ip']===_0x51a859);}function temporaryAccess2FA(_0x2d2fd0,_0x4bdb8c){const _0x196674=_0x513efd;let _0x2e986d=new Date(),_0x14de57=![];if(lastIpApproval){if(_0x2e986d-lastIpApproval<0x1388)_0x14de57=!![];}lastIpApproval=new Date();if(_0x14de57)return;tgBot&&settings[_0x196674(0x168)]&&(tgBot[_0x196674(0x295)]('callback_query'),tgBot[_0x196674(0x150)](settings[_0x196674(0x168)],_0x196674(0x154)+normalizeIP(_0x4bdb8c)[_0x196674(0x285)]+_0x196674(0x131),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x196674(0x247),'callback_data':'5'},{'text':_0x196674(0x19f),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x196674(0x1bc),'callback_data':_0x196674(0x1bc)}]]}})[_0x196674(0x135)](_0x4ec8c0=>{telegramError(_0x4ec8c0);}),tgBot['on'](_0x196674(0x1f3),async _0x194ecc=>{const _0x88afa4=_0x196674,_0x23c04b=_0x194ecc[_0x88afa4(0x19b)],_0x2008d3=_0x194ecc[_0x88afa4(0x2a0)];tgBot['answerCallbackQuery'](_0x194ecc['id'])[_0x88afa4(0x1ab)](async()=>{const _0x3b05e2=_0x88afa4;devices[_0x2d2fd0][_0x3b05e2(0x2b5)]={'clientip':_0x4bdb8c,'timestamp':new Date()[_0x3b05e2(0x290)](),'expiry':_0x23c04b},_0x23c04b!='reject'?(await tgBot[_0x3b05e2(0x150)](_0x2008d3[_0x3b05e2(0x23f)]['id'],_0x3b05e2(0x1e8)+_0x23c04b+_0x3b05e2(0x1c5),{'parse_mode':_0x3b05e2(0x184)})[_0x3b05e2(0x135)](_0x547e5d=>{telegramError(_0x547e5d);}),io['to'](_0x2d2fd0)[_0x3b05e2(0x1b4)](_0x3b05e2(0x258),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x3b05e2(0x150)](_0x2008d3[_0x3b05e2(0x23f)]['id'],_0x3b05e2(0x206))[_0x3b05e2(0x135)](_0x34a616=>{telegramError(_0x34a616);}),io['to'](_0x2d2fd0)['emit'](_0x3b05e2(0x258),{'access':{'allow':![],'reason':_0x3b05e2(0x22b),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x33bf2d,_0x2099b8){const _0x2309ac=_0x513efd;tgBot&&settings['telegramChatId']&&(tgBot[_0x2309ac(0x295)](_0x2309ac(0x1f3)),tgBot[_0x2309ac(0x150)](settings['telegramChatId'],_0x2309ac(0x17b)+normalizeIP(_0x2099b8)[_0x2309ac(0x285)]+_0x2309ac(0x131),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x2309ac(0x1bc),'callback_data':_0x2309ac(0x1bc)}]]}})[_0x2309ac(0x135)](_0x2dd130=>{telegramError(_0x2dd130);}),tgBot['on'](_0x2309ac(0x1f3),async _0x445640=>{const _0x31d749=_0x2309ac,_0x4346da=_0x445640['data'],_0x1e3609=_0x445640[_0x31d749(0x2a0)];tgBot['answerCallbackQuery'](_0x445640['id'])[_0x31d749(0x1ab)](async()=>{const _0x18dfd1=_0x31d749;devices[_0x33bf2d][_0x18dfd1(0x255)]={'clientip':_0x2099b8,'timestamp':new Date()[_0x18dfd1(0x290)](),'expiry':_0x4346da},_0x4346da!=_0x18dfd1(0x1bc)?(await tgBot[_0x18dfd1(0x150)](_0x1e3609[_0x18dfd1(0x23f)]['id'],'Login\x20accepted',{'parse_mode':_0x18dfd1(0x184)})[_0x18dfd1(0x135)](_0x1fd22d=>{telegramError(_0x1fd22d);}),io['to'](_0x33bf2d)[_0x18dfd1(0x1b4)](_0x18dfd1(0x258),{'access':{'allow':![],'reason':_0x18dfd1(0x1c8),'token':null}})):(await tgBot['sendMessage'](_0x1e3609[_0x18dfd1(0x23f)]['id'],_0x18dfd1(0x1fb))['catch'](_0x19f07c=>{telegramError(_0x19f07c);}),io['to'](_0x33bf2d)[_0x18dfd1(0x1b4)](_0x18dfd1(0x258),{'access':{'allow':![],'reason':_0x18dfd1(0x292),'token':null}}));}),tgBot[_0x31d749(0x295)](_0x31d749(0x1f3));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1b0256=_0x513efd;return dbConfig[_0x1b0256(0x1aa)](_0x1b0256(0x164))[_0x1b0256(0x1fc)](_0x1b0256(0x23d))['filter']({'status':_0x1b0256(0x1f2)})['value']()||[];}function getDisabledBots(){const _0x2f2b62=_0x513efd;return dbConfig[_0x2f2b62(0x1aa)](_0x2f2b62(0x164))[_0x2f2b62(0x1fc)](_0x2f2b62(0x23d))[_0x2f2b62(0x1ee)]({'status':_0x2f2b62(0x2b6)})['value']()||[];}function getBotAttributes(_0x35f8e2){const _0x55e8bf=_0x513efd;let _0x1a27aa={};const _0x480275=configpath+_0x55e8bf(0x2f1)+_0x35f8e2+_0x55e8bf(0x1ce),_0x1e459a=fs[_0x55e8bf(0x200)](_0x480275);if(_0x1e459a){const _0x3be207=fs[_0x55e8bf(0x24f)](_0x480275);try{const _0x1356d0=JSON[_0x55e8bf(0x2db)](_0x3be207),_0x50878c=_0x1356d0?_0x1356d0[_0x55e8bf(0x24a)][0x0]['headless']:![];_0x1a27aa[_0x55e8bf(0x183)]=_0x50878c?_0x55e8bf(0x1a4):_0x55e8bf(0x28f),_0x1a27aa['botname']=_0x1356d0?_0x1356d0[_0x55e8bf(0x24a)][0x0][_0x55e8bf(0x25e)]:_0x55e8bf(0x14c)+_0x35f8e2;}catch(_0x31ca76){_0x1a27aa[_0x55e8bf(0x183)]=_0x55e8bf(0x28f),_0x1a27aa[_0x55e8bf(0x25e)]=_0x55e8bf(0x14c)+_0x35f8e2;}}else _0x1a27aa[_0x55e8bf(0x183)]=_0x55e8bf(0x28f),_0x1a27aa['botname']='Bot\x20'+_0x35f8e2;return _0x1a27aa;}function getBotsWithMode(){const _0x4399ee=_0x513efd,_0x4d80fa=dbConfig[_0x4399ee(0x1aa)](_0x4399ee(0x164))['sortBy'](_0x4399ee(0x23d))[_0x4399ee(0x21e)]()||[];return _0x4d80fa[_0x4399ee(0x248)](_0x4d8f47=>{const _0x51112b=_0x4399ee;let _0x4ba89e=getBotAttributes(_0x4d8f47[_0x51112b(0x23d)]);_0x4d8f47[_0x51112b(0x183)]=_0x4ba89e[_0x51112b(0x183)];}),_0x4d80fa;}function getBotExchanges(){const _0x3994b4=_0x513efd;let _0x4d5c54=[];const _0x3ea117=dbConfig[_0x3994b4(0x1aa)](_0x3994b4(0x164))[_0x3994b4(0x1fc)](_0x3994b4(0x23d))[_0x3994b4(0x21e)]()||[];_0x3ea117[_0x3994b4(0x248)](_0x392575=>{const _0x1c8910=_0x3994b4;if(_0x392575[_0x1c8910(0x258)]==_0x1c8910(0x1f2)){const _0x248789=configpath+_0x1c8910(0x2f1)+_0x392575[_0x1c8910(0x23d)]+_0x1c8910(0x1ce),_0x31593e=fs[_0x1c8910(0x200)](_0x248789);let _0x522d35;if(_0x31593e){const _0x33bfe3=fs[_0x1c8910(0x24f)](_0x248789);try{const _0xce7a69=JSON[_0x1c8910(0x2db)](_0x33bfe3);_0x522d35=_0xce7a69?_0xce7a69[_0x1c8910(0x24a)][0x0][_0x1c8910(0x20b)]:null;}catch(_0x2de158){}}if(_0x522d35)_0x4d5c54['push'](_0x522d35);}});const _0x513350=[...new Set(_0x4d5c54)]['sort']();return _0x513350;}async function initUser(){const _0x29d107=_0x513efd;if(!settings[_0x29d107(0x244)]){const _0x1108c8=uuidRandom();mixpanel[_0x29d107(0x30b)](_0x1108c8),updateSetting(_0x29d107(0x244),_0x1108c8);}}async function initSecure(){const _0x367620=_0x513efd;let _0x2b402f=getSecure();if(!_0x2b402f[_0x367620(0x1c0)](_0x367620(0x2c5))){let _0x545d19=await generateKeys();_0x2b402f[_0x367620(0x1e5)]=_0x545d19['publicKey'],_0x2b402f[_0x367620(0x13e)]=_0x545d19[_0x367620(0x13e)],_0x2b402f[_0x367620(0x2c5)]=crypto[_0x367620(0x2aa)](0x20)[_0x367620(0x287)](_0x367620(0x276));;storeSecure(_0x2b402f);}}function getSettings(){const _0x5c9a34=_0x513efd;return dbSettings[_0x5c9a34(0x1aa)](_0x5c9a34(0x1f7))[_0x5c9a34(0x21e)]()||{};}function getSecure(){const _0x202dea=_0x513efd;return dbSecure[_0x202dea(0x1aa)](_0x202dea(0x1ae))['value']()||{};}function getBlacklist(){const _0x5bd386=_0x513efd;return dbSecure[_0x5bd386(0x1aa)]('blacklist')[_0x5bd386(0x21e)]()||[];}function broadcastToBots(_0x10e8b9,_0x6f75c3){const _0xe4e360=_0x513efd;config[_0xe4e360(0x248)](_0x3ae35d=>{const _0x58002f=_0xe4e360;if(_0x3ae35d[_0x58002f(0x258)]==_0x58002f(0x1f2)&&_0x3ae35d[_0x58002f(0x2c0)]=='running'||_0x3ae35d[_0x58002f(0x258)]=='new'&&_0x3ae35d['live']==_0x58002f(0x181)){if(pid[_0x3ae35d['botID']])pid[_0x3ae35d[_0x58002f(0x23d)]][_0x58002f(0x222)]({[_0x10e8b9]:_0x6f75c3});}});}function storeSettings(_0x2f2ade,_0x4f0e5d=![]){const _0x5dd28f=_0x513efd;_0x2f2ade={...settings,..._0x2f2ade};if(_0x4f0e5d&&_0x2f2ade[_0x5dd28f(0x230)]!=_0x5dd28f(0x1c2)&&_0x2f2ade[_0x5dd28f(0x230)]!=_0x5dd28f(0x30d)&&_0x2f2ade[_0x5dd28f(0x230)]!=''){const _0x883820=crypt['decrypt'](secure['privateKey'],_0x2f2ade[_0x5dd28f(0x230)])[_0x5dd28f(0x2a0)]['split']('@')[0x0],_0x2d96a5=bcrypt[_0x5dd28f(0x2f5)](_0x883820,saltRounds);_0x2f2ade={..._0x2f2ade,'bbPassword':_0x2d96a5};}if(_0x4f0e5d&&_0x2f2ade[_0x5dd28f(0x172)]!=_0x5dd28f(0x1c2)&&_0x2f2ade[_0x5dd28f(0x172)]!=_0x5dd28f(0x30d)&&_0x2f2ade[_0x5dd28f(0x172)]!=''){const _0x17895b=crypt[_0x5dd28f(0x1ff)](secure['privateKey'],_0x2f2ade['telegramToken'])[_0x5dd28f(0x2a0)][_0x5dd28f(0x29a)]('@')[0x0];_0x2f2ade={..._0x2f2ade,'telegramToken':_0x17895b};}const _0x338cce=_0x2f2ade['telegramToken']!=_0x5dd28f(0x1c2)&&_0x2f2ade[_0x5dd28f(0x172)]!=settings['telegramToken']||_0x2f2ade[_0x5dd28f(0x188)]!=settings[_0x5dd28f(0x188)],_0x3bbfa4=_0x2f2ade[_0x5dd28f(0x172)]==''||_0x2f2ade['telegramUsername']=='';if(_0x338cce)_0x2f2ade[_0x5dd28f(0x30c)]=_0x5dd28f(0x27c);for(const [_0x2e98af,_0x3968d5]of Object[_0x5dd28f(0x196)](_0x2f2ade)){if(_0x2e98af==_0x5dd28f(0x172)&&_0x3968d5==_0x5dd28f(0x1c2)){_0x2f2ade[_0x5dd28f(0x172)]=settings[_0x5dd28f(0x172)];continue;};if(_0x2e98af=='bbPassword'&&_0x3968d5=='************'){_0x2f2ade[_0x5dd28f(0x230)]=settings[_0x5dd28f(0x230)];continue;};dbSettings[_0x5dd28f(0x262)](_0x5dd28f(0x130)+_0x2e98af,_0x3968d5)[_0x5dd28f(0x133)]();}settings=_0x2f2ade,io['to'](_0x5dd28f(0x2c2))[_0x5dd28f(0x1b4)](_0x5dd28f(0x1f7),cleanSettings()),broadcastToBots('timeshift',settings[_0x5dd28f(0x2b9)]),broadcastToBots(_0x5dd28f(0x28c),settings[_0x5dd28f(0x28c)]);if(_0x338cce&&!_0x3bbfa4)initTelegram();if(_0x338cce&&_0x3bbfa4)disableTelegram();getAllClients()[_0x5dd28f(0x248)](_0x546228=>{const _0x3e1cf5=_0x5dd28f;getSocket(_0x546228['id'])[_0x3e1cf5(0x1b4)]('status',{'access':{'allow':![],'reason':_0x3e1cf5(0x1c8),'token':null}});});}function updateSetting(_0x33e1e3,_0x3afbd7){const _0x1c4e7e=_0x513efd;dbSettings[_0x1c4e7e(0x262)]('settings.'+_0x33e1e3,_0x3afbd7)[_0x1c4e7e(0x133)](),settings=getSettings(),io['to'](_0x1c4e7e(0x2c2))[_0x1c4e7e(0x1b4)](_0x1c4e7e(0x1f7),cleanSettings());}function storeSecure(_0x863555){const _0x1ae468=_0x513efd;dbSecure['get'](_0x1ae468(0x1ae))[_0x1ae468(0x227)](_0x863555)[_0x1ae468(0x133)](),secure=_0x863555;}function addBlacklist(_0x328d1c){const _0x2a5108=_0x513efd;cleanBlacklist();let _0x3b7bb0;devices[_0x328d1c]['telegramIpApproval']?_0x3b7bb0=Math[_0x2a5108(0x1ad)](devices[_0x328d1c][_0x2a5108(0x2b5)]['expiry'],loginExpiry):_0x3b7bb0=loginExpiry,dbSecure[_0x2a5108(0x1aa)](_0x2a5108(0x22a))['push']({'expiry':new Date()[_0x2a5108(0x290)]()+_0x3b7bb0*0x3c*0x3e8,'token':devices[_0x328d1c][_0x2a5108(0x257)]['token']})[_0x2a5108(0x133)](),blacklist=dbSecure[_0x2a5108(0x1aa)](_0x2a5108(0x22a))[_0x2a5108(0x21e)]();}function cleanBlacklist(){const _0x46d0ba=_0x513efd;let _0x251e2c=dbSecure[_0x46d0ba(0x1aa)](_0x46d0ba(0x22a))['cloneDeep']()['value'](),_0x2dc507=new Date()[_0x46d0ba(0x290)]();_0x251e2c[_0x46d0ba(0x248)](_0x4d4086=>{const _0x420b96=_0x46d0ba;_0x4d4086[_0x420b96(0x2d2)]<_0x2dc507&&dbSecure['get'](_0x420b96(0x22a))['remove']({'expiry':_0x4d4086['expiry']})['write']();});}function initStates(){const _0x47395b=_0x513efd;let _0x2ac2da=getConfiguration();_0x2ac2da[_0x47395b(0x248)](_0xd10170=>{_0xd10170['live']='stopped';}),storeConfiguration(_0x2ac2da);}function onKeys(){const _0xd219c8=new RSA();return new Promise(_0x4c417a=>{const _0x3c2393=_0x3016;_0xd219c8['generateKeyPairAsync']()[_0x3c2393(0x1ab)](_0x123eb3=>{_0x4c417a(_0x123eb3);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x475fc8=_0x513efd;let _0x558745=getSettings(),_0x4d9ff2=![];!_0x558745[_0x475fc8(0x1c0)](_0x475fc8(0x252))&&(_0x558745[_0x475fc8(0x252)]=0x0,_0x4d9ff2=!![]);!_0x558745[_0x475fc8(0x1c0)]('lastmsgemitted')&&(_0x558745[_0x475fc8(0x15e)]=0x0,_0x4d9ff2=!![]);!_0x558745[_0x475fc8(0x1c0)](_0x475fc8(0x215))&&(_0x558745[_0x475fc8(0x215)]=_0x475fc8(0x207),_0x4d9ff2=!![]);!_0x558745['hasOwnProperty']('onepagemode')&&(_0x558745[_0x475fc8(0x28c)]=![],_0x4d9ff2=!![]);if(_0x4d9ff2)storeSettings(_0x558745);try{fs[_0x475fc8(0x218)](configbackuppath,{'withFileTypes':!![]})[_0x475fc8(0x248)](_0x26c6f8=>{const _0x1c29ae=_0x475fc8;if(!_0x26c6f8['isDirectory']()){if(!_0x26c6f8[_0x1c29ae(0x260)][_0x1c29ae(0x242)](_0x1c29ae(0x145)))fs[_0x1c29ae(0x261)](configbackuppath+_0x26c6f8[_0x1c29ae(0x260)]);}else fs[_0x1c29ae(0x210)](configbackuppath+_0x26c6f8[_0x1c29ae(0x260)],{'recursive':!![]});});}catch(_0x4fdae3){logger['debug'](_0x475fc8(0x1de),_0x4fdae3);}}function storeConfiguration(_0x4d3a51){const _0x2de1d8=_0x513efd;dbConfig['get'](_0x2de1d8(0x164))['remove']()[_0x2de1d8(0x133)](),_0x4d3a51[_0x2de1d8(0x248)](_0x5bd69c=>{const _0x13381f=_0x2de1d8;delete _0x5bd69c[_0x13381f(0x183)];}),dbConfig[_0x2de1d8(0x1aa)](_0x2de1d8(0x164))['push'](..._0x4d3a51)[_0x2de1d8(0x133)](),config=_0x4d3a51;}function resetPassword(){const _0x1c33cf=_0x513efd;tgBot&&settings['telegramChatId']&&(tgBot[_0x1c33cf(0x295)](_0x1c33cf(0x1f3)),tgBot[_0x1c33cf(0x150)](settings[_0x1c33cf(0x168)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x1c33cf(0x184),'reply_markup':{'inline_keyboard':[[{'text':_0x1c33cf(0x149),'callback_data':_0x1c33cf(0x149)},{'text':'no','callback_data':'no'}]]}})[_0x1c33cf(0x135)](_0xa50899=>{telegramError(_0xa50899);}),tgBot['on']('callback_query',async _0x49bccf=>{const _0x95eb9d=_0x1c33cf,_0x3ddfac=_0x49bccf[_0x95eb9d(0x19b)],_0x2f61d0=_0x49bccf[_0x95eb9d(0x2a0)];tgBot[_0x95eb9d(0x156)](_0x49bccf['id'])[_0x95eb9d(0x1ab)](async()=>{const _0x316615=_0x95eb9d;if(_0x3ddfac!='no'){const _0x4205b8=0xf,_0x2e26a7=_0x316615(0x1e9),_0x26a21f=Array['from'](crypto[_0x316615(0x1d0)](new Uint32Array(_0x4205b8)))['map'](_0x1bf2d1=>_0x2e26a7[_0x1bf2d1%_0x2e26a7[_0x316615(0x1d7)]])['join'](''),_0x38288d=bcrypt['hashSync'](_0x26a21f,saltRounds);storeSettings({'bbPassword':_0x38288d}),await tgBot[_0x316615(0x150)](_0x2f61d0[_0x316615(0x23f)]['id'],_0x316615(0x1d2)+_0x26a21f,{'parse_mode':'HTML'})[_0x316615(0x135)](_0x4025d1=>{telegramError(_0x4025d1);});}else await tgBot[_0x316615(0x150)](_0x2f61d0[_0x316615(0x23f)]['id'],_0x316615(0x13c))['catch'](_0xfb8883=>{telegramError(_0xfb8883);});}),tgBot[_0x95eb9d(0x295)](_0x95eb9d(0x1f3));}));}async function confirmRestore(_0x472794,_0x868199){const _0x2131bf=_0x513efd;io['to'](_0x2131bf(0x2c2))['emit'](_0x2131bf(0x308),_0x2131bf(0x2cd),_0x2131bf(0x1b9)),tgBot&&settings[_0x2131bf(0x168)]&&(tgBot[_0x2131bf(0x295)](_0x2131bf(0x1f3)),await tgBot['sendMessage'](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x2131bf(0x184),'reply_markup':{'inline_keyboard':[[{'text':_0x2131bf(0x149),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x2131bf(0x135)](_0x1f9afe=>{telegramError(_0x1f9afe);}),tgBot['on'](_0x2131bf(0x1f3),async _0x424bbe=>{const _0x1f418f=_0x2131bf,_0x460f0b=_0x424bbe[_0x1f418f(0x19b)],_0x58dbd9=_0x424bbe[_0x1f418f(0x2a0)];tgBot[_0x1f418f(0x156)](_0x424bbe['id'])[_0x1f418f(0x1ab)](async()=>{const _0xf93892=_0x1f418f;_0x460f0b==_0xf93892(0x149)?(await tgBot[_0xf93892(0x150)](_0x58dbd9['chat']['id'],_0xf93892(0x2dd),{'parse_mode':'HTML'})[_0xf93892(0x135)](_0x8ae21b=>{telegramError(_0x8ae21b);}),unzipFile(_0x472794,_0x868199)):(logger[_0xf93892(0x236)](_0xf93892(0x24e)),await tgBot[_0xf93892(0x150)](_0x58dbd9[_0xf93892(0x23f)]['id'],_0xf93892(0x24e))['catch'](_0x2bcfae=>{telegramError(_0x2bcfae);}));}),tgBot[_0x1f418f(0x295)](_0x1f418f(0x1f3));}));}function getServerTime(){const _0x127471=_0x513efd,_0x1e3ab1=new Date();return _0x1e3ab1[_0x127471(0x289)]()+'/'+(_0x1e3ab1['getMonth']()+0x1)[_0x127471(0x287)]()[_0x127471(0x178)](0x2,'0')+'/'+_0x1e3ab1['getDate']()[_0x127471(0x287)]()[_0x127471(0x178)](0x2,'0')+'\x20'+_0x1e3ab1[_0x127471(0x1eb)]()['toString']()['padStart'](0x2,'0')+':'+_0x1e3ab1['getMinutes']()[_0x127471(0x287)]()[_0x127471(0x178)](0x2,'0')+':'+_0x1e3ab1['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x11cd69=_0x513efd,_0x3c2c6d=shiftedTime();return _0x3c2c6d[_0x11cd69(0x289)]()+'/'+(_0x3c2c6d[_0x11cd69(0x237)]()+0x1)['toString']()[_0x11cd69(0x178)](0x2,'0')+'/'+_0x3c2c6d[_0x11cd69(0x268)]()['toString']()[_0x11cd69(0x178)](0x2,'0')+'\x20'+_0x3c2c6d['getHours']()['toString']()[_0x11cd69(0x178)](0x2,'0')+':'+_0x3c2c6d[_0x11cd69(0x232)]()[_0x11cd69(0x287)]()[_0x11cd69(0x178)](0x2,'0')+':'+_0x3c2c6d[_0x11cd69(0x1ac)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x5af07b=_0x513efd,_0x593c22=shiftedTime();return _0x593c22['getFullYear']()+(_0x593c22[_0x5af07b(0x237)]()+0x1)['toString']()[_0x5af07b(0x178)](0x2,'0')+_0x593c22[_0x5af07b(0x268)]()[_0x5af07b(0x287)]()['padStart'](0x2,'0')+'-'+_0x593c22[_0x5af07b(0x1eb)]()[_0x5af07b(0x287)]()['padStart'](0x2,'0')+_0x593c22['getMinutes']()[_0x5af07b(0x287)]()[_0x5af07b(0x178)](0x2,'0')+_0x593c22[_0x5af07b(0x1ac)]()['toString']()[_0x5af07b(0x178)](0x2,'0');}function shiftedTime(){const _0x45d113=_0x513efd,_0x5a15d9=new Date();let _0x31c0ee=_0x5a15d9;if(settings['timeshift']&&settings[_0x45d113(0x2b9)]!==0x0)_0x31c0ee=fns['add'](_0x5a15d9,{'hours':settings[_0x45d113(0x2b9)]});return _0x31c0ee;}function startScheduler(){const _0x4103db=_0x513efd,_0x47eee8=new Date()[_0x4103db(0x2b1)](),_0x504ca9=shiftedTime()[_0x4103db(0x1eb)]();_0x504ca9==0x4&&backupConfigFiles();_0x504ca9==0x0&&rotateLogFiles();_0x47eee8%0x6==0x0&&triggerAnalytics();_0x47eee8%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x51332b){const _0xc2c051=_0x513efd;logger[_0xc2c051(0x236)](_0xc2c051(0x286)+_0x51332b);const _0x107032=getBotsWithMode();_0x107032[_0xc2c051(0x1d7)]>0x0?confirmRestore(configbackuppath,_0x51332b):unzipFile(configbackuppath,_0x51332b);}async function getBackupFiles(_0x434a55=null){const _0x29d814=_0x513efd;let _0x34a84a=[],_0x28fffc=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x28fffc['sort']((_0x4ba069,_0x5d9375)=>_0x4ba069[_0x29d814(0x260)]<_0x5d9375[_0x29d814(0x260)]?0x1:_0x5d9375[_0x29d814(0x260)]<_0x4ba069[_0x29d814(0x260)]?-0x1:0x0),_0x28fffc['forEach'](_0x3ff394=>{const _0xed016f=_0x29d814;if(!_0x3ff394[_0xed016f(0x1ca)]()&&_0x3ff394['name'][_0xed016f(0x242)](_0xed016f(0x145))&&_0x3ff394[_0xed016f(0x260)][_0xed016f(0x1c3)](_0xed016f(0x1d4))){const _0x3b956e=formatDate(fs['statSync'](configbackuppath+_0x3ff394[_0xed016f(0x260)])[_0xed016f(0x306)]);_0x34a84a[_0xed016f(0x227)]({'name':_0x3ff394[_0xed016f(0x260)],'mtime':_0x3b956e});}});if(_0x434a55)io['to'](_0x434a55)['emit'](_0x29d814(0x267),_0x34a84a);else return _0x34a84a;}async function backupConfigFiles(){const _0x5690c8=_0x513efd;await zipFiles(_0x5690c8(0x14f));const _0x4e29e7=getCleanTimeStamp();fs[_0x5690c8(0x16f)](zippath+_0x5690c8(0x1fe),configbackuppath+(_0x5690c8(0x145)+_0x4e29e7+_0x5690c8(0x1d4)));let _0x212609=fs[_0x5690c8(0x218)](configbackuppath,{'withFileTypes':!![]});_0x212609[_0x5690c8(0x240)]((_0x515976,_0x56f5d6)=>_0x515976[_0x5690c8(0x260)]<_0x56f5d6[_0x5690c8(0x260)]?0x1:_0x56f5d6['name']<_0x515976[_0x5690c8(0x260)]?-0x1:0x0),_0x212609['length']>maxBackups&&fs[_0x5690c8(0x261)](configbackuppath+_0x212609[_0x212609['length']-0x1][_0x5690c8(0x260)]);}function rotateLogFiles(){const _0x19eb90=_0x513efd,_0x5cb8c3=fs[_0x19eb90(0x144)](logspath+_0x19eb90(0x16d)),_0x5f2f67=_0x5cb8c3[_0x19eb90(0x2b3)]/0x400;if(_0x5f2f67>0x64){let _0x18e775=fs[_0x19eb90(0x218)](logspath,{'withFileTypes':!![]});_0x18e775[_0x19eb90(0x240)]((_0x54781f,_0x6d821)=>_0x54781f[_0x19eb90(0x260)]<_0x6d821[_0x19eb90(0x260)]?0x1:_0x6d821['name']<_0x54781f[_0x19eb90(0x260)]?-0x1:0x0),_0x18e775['forEach'](_0x4569cd=>{const _0x45cc68=_0x19eb90;if(_0x4569cd[_0x45cc68(0x260)]==_0x45cc68(0x132))fs[_0x45cc68(0x16f)](logspath+_0x4569cd[_0x45cc68(0x260)],logspath+_0x45cc68(0x167));if(_0x4569cd[_0x45cc68(0x260)]==_0x45cc68(0x273))fs[_0x45cc68(0x16f)](logspath+_0x4569cd[_0x45cc68(0x260)],logspath+_0x45cc68(0x132));_0x4569cd[_0x45cc68(0x260)]==_0x45cc68(0x16d)&&(fs[_0x45cc68(0x16f)](logspath+_0x4569cd[_0x45cc68(0x260)],logspath+_0x45cc68(0x273)),fs[_0x45cc68(0x2a9)](logspath+_0x4569cd['name'],''));});}}async function zipFiles(_0x33a8a6){const _0x2e98eb=_0x513efd;let _0x19e318;if(_0x33a8a6==_0x2e98eb(0x15b))_0x19e318=logspath;if(_0x33a8a6==_0x2e98eb(0x1e0))_0x19e318=configpath;if(_0x33a8a6=='backup-full')_0x19e318=configpath;let _0x18b6ab=fs[_0x2e98eb(0x218)](_0x19e318,{'withFileTypes':!![]});const _0x475244=new require(_0x2e98eb(0x288))();_0x18b6ab['forEach'](_0x14918a=>{const _0x1b7dc2=_0x2e98eb;if(!_0x14918a['isDirectory']()){let _0x249765=fs[_0x1b7dc2(0x24f)](_0x19e318+_0x14918a['name']);if(_0x33a8a6==_0x1b7dc2(0x1e0)){const _0x37bd4d=/^bot-[0-9]{3}-config.json$/,_0x3301e2=_0x37bd4d['test'](_0x14918a[_0x1b7dc2(0x260)]);if(_0x3301e2){const _0x5c4976=JSON['parse'](_0x249765);if(_0x5c4976['bot'][0x0]){_0x5c4976['bot'][0x0][_0x1b7dc2(0x16c)]=_0x1b7dc2(0x30d),_0x5c4976[_0x1b7dc2(0x24a)][0x0][_0x1b7dc2(0x2eb)]=_0x1b7dc2(0x30d);if(_0x5c4976['bot'][0x0]['apiPassword'])_0x5c4976[_0x1b7dc2(0x24a)][0x0]['apiPassword']=_0x1b7dc2(0x30d);}_0x249765=JSON[_0x1b7dc2(0x2ff)](_0x5c4976,null,0x2);}if(_0x14918a[_0x1b7dc2(0x260)]==_0x1b7dc2(0x161)){const _0x2f5b8a=JSON[_0x1b7dc2(0x2db)](_0x249765);if(_0x2f5b8a[_0x1b7dc2(0x1f7)][_0x1b7dc2(0x2f4)])_0x2f5b8a[_0x1b7dc2(0x1f7)][_0x1b7dc2(0x2f4)]=![];if(_0x2f5b8a[_0x1b7dc2(0x1f7)][_0x1b7dc2(0x230)])_0x2f5b8a[_0x1b7dc2(0x1f7)][_0x1b7dc2(0x230)]='***';if(_0x2f5b8a[_0x1b7dc2(0x1f7)][_0x1b7dc2(0x172)])_0x2f5b8a[_0x1b7dc2(0x1f7)]['telegramToken']=_0x1b7dc2(0x30d);if(_0x2f5b8a['settings'][_0x1b7dc2(0x168)])_0x2f5b8a[_0x1b7dc2(0x1f7)][_0x1b7dc2(0x168)]=null;_0x249765=JSON[_0x1b7dc2(0x2ff)](_0x2f5b8a,null,0x2);}if(_0x14918a[_0x1b7dc2(0x260)]!=_0x1b7dc2(0x186))_0x475244[_0x1b7dc2(0x22e)](_0x14918a[_0x1b7dc2(0x260)],_0x249765);}else _0x475244[_0x1b7dc2(0x22e)](_0x14918a[_0x1b7dc2(0x260)],_0x249765);}});const _0x50800b=_0x475244[_0x2e98eb(0x1bf)]({'base64':![],'compression':'DEFLATE'});fs[_0x2e98eb(0x2a9)](zippath+(_0x33a8a6+_0x2e98eb(0x1d4)),_0x50800b,_0x2e98eb(0x300));}async function unzipFile(_0x1b44df,_0x4717ba){const _0x212202=_0x513efd;fs[_0x212202(0x218)](configpath,{'withFileTypes':!![]})[_0x212202(0x248)](_0x3d565c=>{const _0x431623=_0x212202;if(!_0x3d565c['isDirectory']())fs[_0x431623(0x210)](configpath+_0x3d565c[_0x431623(0x260)]);});const _0x10b20a=fs[_0x212202(0x24f)](_0x1b44df+_0x4717ba,_0x212202(0x300)),_0x16368d=new require(_0x212202(0x288))(_0x10b20a,{'base64':![],'checkCRC32':!![]});Object[_0x212202(0x191)](_0x16368d['files'])[_0x212202(0x248)](_0x412a29=>{const _0xe05843=_0x212202,_0xafb998=_0x16368d[_0xe05843(0x16b)][_0x412a29];fs[_0xe05843(0x2a9)](configpath+_0xafb998['name'],_0xafb998[_0xe05843(0x28e)]);}),fs[_0x212202(0x218)](temppath,{'withFileTypes':!![]})[_0x212202(0x248)](_0x15e75d=>{const _0x54f370=_0x212202;if(!_0x15e75d[_0x54f370(0x1ca)]())fs[_0x54f370(0x210)](temppath+_0x15e75d[_0x54f370(0x260)]);}),logger['debug'](_0x212202(0x151)),process[_0x212202(0x222)]({'restore':!![]},_0x426384=>{});}async function getPublicIp(){const _0x38b812=_0x513efd;try{const _0x4f3c03=await axios[_0x38b812(0x1aa)](_0x38b812(0x1e6));publicip=_0x4f3c03[_0x38b812(0x19b)]['ip'];}catch(_0x1c98e6){}}async function triggerAnalytics(){const _0x306a54=_0x513efd;if(!publicip)await getPublicIp();const _0x1d5026=getBotsWithMode();let _0xdf7cb=0x0;_0x1d5026[_0x306a54(0x248)](_0x288c92=>{const _0x19f128=_0x306a54;if(_0x288c92[_0x19f128(0x258)]==='enabled')_0xdf7cb++;});const _0x1682bd=getBotExchanges();mixpanel['track'](_0x306a54(0x2de),{'distinct_id':settings[_0x306a54(0x244)],'ip':publicip,'version':serverversion,'numbots':_0x1d5026[_0x306a54(0x1d7)],'numbotsenabled':_0xdf7cb,'exchanges':_0x1682bd,'environment':environment});}async function getMessages(){const _0x2f7a15=_0x513efd,_0x53b46f=_0x2f7a15(0x301),_0x36cd85=new GraphQLClient(_0x53b46f),_0x5d628a={'authorization':_0x2f7a15(0x2cf)},_0x366bbe=serverversion[_0x2f7a15(0x29a)]('.'),_0x2d6532=_0x366bbe[0x0]+'.'+_0x366bbe[0x1],_0x31f240=Math[_0x2f7a15(0x2fe)](settings[_0x2f7a15(0x252)],settings[_0x2f7a15(0x15e)]),_0x29e117={'last':parseInt(_0x31f240),'bbm':_0x2d6532},_0x15438f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xc0169d;try{_0xc0169d=await _0x36cd85[_0x2f7a15(0x223)](_0x15438f,_0x29e117,_0x5d628a);}catch(_0x1bd3db){}if(_0xc0169d&&_0xc0169d['messages']){let _0x168744=settings[_0x2f7a15(0x252)];newMessages=[];for(const _0x1d9913 of _0xc0169d['messages']){newMessages[_0x2f7a15(0x227)](_0x1d9913);let _0x367c22=![];_0x1d9913['bbvNew']&&(updateSetting('latestversion',_0x1d9913[_0x2f7a15(0x29c)]),_0x367c22=isNewerVersion(serverversion,_0x1d9913[_0x2f7a15(0x29c)])||serverversion==_0x1d9913['bbvNew']);if(!_0x367c22&&_0x1d9913['number']>_0x168744){if(_0x1d9913[_0x2f7a15(0x1dc)]===_0x2f7a15(0x159)||serverversion[_0x2f7a15(0x242)](_0x1d9913[_0x2f7a15(0x1dc)])){let _0x5f3663=''+_0x1d9913[_0x2f7a15(0x2e9)]+'\x0a\x0a'+_0x1d9913['message'];const _0xcaddee=await sendTelegramMsg(toTelegramMarkdown(_0x5f3663),_0x2f7a15(0x2f7));if(_0xcaddee)_0x168744=_0x1d9913[_0x2f7a15(0x23b)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x2f7a15(0x252),_0x168744),emitMessages();}}function emitMessages(){const _0x249377=_0x513efd,_0xa8ac3a=settings[_0x249377(0x15e)];let _0x5e90a0=[];newMessages[_0x249377(0x248)](_0x418d4c=>{const _0x201be2=_0x249377;_0x418d4c[_0x201be2(0x23b)]>_0xa8ac3a&&_0x5e90a0[_0x201be2(0x227)](_0x418d4c);}),_0x5e90a0['length']>0x0&&getAllClients()['forEach'](_0x448379=>{const _0xf0bc9e=_0x249377;getSocket(_0x448379['id'])[_0xf0bc9e(0x1b4)](_0xf0bc9e(0x2a0),_0x5e90a0);});}function confirmMessage(_0x5d3072){updateSetting('lastmsgemitted',Number(_0x5d3072));}function isNewerVersion(_0x2375e9,_0x321656){const _0x5c5fbf=_0x513efd,_0x8f1df4=_0x321656[_0x5c5fbf(0x29a)]('.'),_0x282e5b=_0x2375e9[_0x5c5fbf(0x29a)]('.');for(var _0x3a0512=0x0;_0x3a0512<_0x282e5b[_0x5c5fbf(0x1d7)];_0x3a0512++){const _0x104e29=~~_0x282e5b[_0x3a0512],_0x48b9cf=~~_0x8f1df4[_0x3a0512];if(_0x104e29>_0x48b9cf)return!![];if(_0x104e29<_0x48b9cf)return![];}return![];}function toTelegramMarkdown(_0x28fb52){const _0x469feb=_0x513efd,_0x5e66ac=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x22a924=/\*{2}(.+?)\*{2}/gim;return _0x28fb52=_0x28fb52[_0x469feb(0x253)](_0x5e66ac,_0x469feb(0x1db))[_0x469feb(0x253)](_0x22a924,_0x469feb(0x16a)),_0x28fb52;}async function validateConfigFile(){const _0x1a7be5=_0x513efd,_0x4ab776=dbConfig[_0x1a7be5(0x1aa)](_0x1a7be5(0x164))[_0x1a7be5(0x1fc)](_0x1a7be5(0x23d))[_0x1a7be5(0x21e)]()||[];if(_0x4ab776[_0x1a7be5(0x1d7)]==0x0){let _0x56b57d=0x0,_0x21e7df=[];const _0x132349=/^bot-([0-9]{3})-config.json$/,_0x462b6f=fs[_0x1a7be5(0x218)](configpath);_0x462b6f['forEach'](_0x283ca9=>{const _0x25630e=_0x1a7be5,_0x2e5c01=_0x132349[_0x25630e(0x19a)](_0x283ca9);if(_0x2e5c01){const _0x34d7e5=_0x2e5c01[0x1];let _0x4a20b6=getBotAttributes(_0x34d7e5);_0x21e7df[_0x25630e(0x227)]({'botID':_0x34d7e5,'botname':_0x4a20b6[_0x25630e(0x25e)],'status':_0x25630e(0x2b6),'live':_0x25630e(0x25a)}),_0x56b57d++;}}),_0x56b57d!=0x0&&(dbConfig[_0x1a7be5(0x1aa)](_0x1a7be5(0x164))[_0x1a7be5(0x169)](_0x21e7df)[_0x1a7be5(0x133)](),config=_0x21e7df,restoredConfigFile=_0x56b57d);}}async function restoreConfigNotify(_0xa1b7d5){const _0x3a2ff2=_0x513efd;let _0x32919d;if(restoredConfigFile==0x1)_0x32919d=_0x3a2ff2(0x2ef);else _0x32919d='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xa1b7d5)io['to']('botmanager')[_0x3a2ff2(0x1b4)](_0x3a2ff2(0x308),_0x32919d);else{logger[_0x3a2ff2(0x13d)](_0x3a2ff2(0x2d6)),logger[_0x3a2ff2(0x13d)](_0x32919d),logger[_0x3a2ff2(0x13d)](_0x3a2ff2(0x2d6)),logger[_0x3a2ff2(0x13d)]('');if(tgBot&&settings[_0x3a2ff2(0x168)]&&settings[_0x3a2ff2(0x30c)]!='orders')tgBot[_0x3a2ff2(0x150)](settings['telegramChatId'],_0x3a2ff2(0x1e1)+_0x32919d)[_0x3a2ff2(0x135)](_0x1f62b7=>{telegramError(_0x1f62b7);});}}function validateCredentials(_0x225211,_0x1f79ff){const _0x23b758=_0x513efd;if(_0x225211['username']==settings[_0x23b758(0x216)]&&bcrypt[_0x23b758(0x1a3)](_0x225211['password'],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x85c617=generateLoginToken(_0x1f79ff);return{'allow':!![],'reason':_0x23b758(0x27a),'token':_0x85c617};}}else return{'allow':![],'reason':_0x23b758(0x294),'token':null};}function refreshToken(_0x445ed5){const _0x311521=_0x513efd,_0x641cba=generateLoginToken(_0x445ed5);return{'allow':!![],'reason':_0x311521(0x27a),'token':_0x641cba};}function validateAccess(_0xfcb770,_0x30bc09,_0x19eb46){const _0x45448e=_0x513efd,_0x11f470=_0x19eb46?_0x19eb46:devices[_0x30bc09]['ip'];let _0x4fb57e;const _0x15279a=_0x5bebf7=>{const _0x53d471=_0x3016;if(settings[_0x53d471(0x2f4)]){if(settings[_0x53d471(0x162)]){if(telegram2FaApproved(_0x30bc09)){const _0x3df6cd=generateLoginToken(_0x30bc09);return{'allow':!![],'reason':_0x53d471(0x17d),'token':_0x3df6cd};}else return{'allow':![],'reason':_0x53d471(0x217),'token':null};}else return _0x4fb57e=validToken(_0x5bebf7,_0x30bc09),_0x4fb57e[_0x53d471(0x1c0)](_0x53d471(0x1b9))?{'allow':!![],'reason':_0x53d471(0x1d6),'token':_0x5bebf7}:{'allow':![],'reason':_0x53d471(0x217),'token':null};}else return{'allow':!![],'reason':_0x53d471(0x17f),'token':null};};if(settings[_0x45448e(0x203)]){let _0x27a106=[...settings[_0x45448e(0x278)],_0x45448e(0x18c),_0x45448e(0x233),'127.0.0.1'];if(_0x27a106[_0x45448e(0x2f6)](_0x11f470))return _0x15279a(_0xfcb770);else{_0x4fb57e=validToken(_0xfcb770,_0x30bc09);if(_0x4fb57e[_0x45448e(0x1c0)](_0x45448e(0x1b9)))return _0x15279a(_0xfcb770);else{if(telegramIpApproved(_0x30bc09)){const _0x3a1516=generateToken(_0x30bc09);return _0x4fb57e=_0x15279a(_0xfcb770),_0x4fb57e[_0x45448e(0x1b0)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3a1516}:_0x4fb57e;}else return settings[_0x45448e(0x250)]?{'allow':![],'reason':_0x45448e(0x2ce),'token':null}:{'allow':![],'reason':_0x45448e(0x284),'token':null};}}}else return _0x15279a(_0xfcb770);}function timelyDecrypt(_0x319c08,_0x510a8c=!![]){const _0x5c8c01=_0x513efd;if(_0x319c08)try{const _0xa105cd=crypt[_0x5c8c01(0x1ff)](secure['privateKey'],_0x319c08)[_0x5c8c01(0x2a0)],_0xc8a9f3=_0xa105cd['split']('@')[0x0],_0x1790e9=_0xa105cd['split']('@')[0x1],_0x581673=new Date()[_0x5c8c01(0x290)]();if(_0x510a8c){if(_0x581673-_0x1790e9<maxSecretAge*0x3e8)return _0xc8a9f3;else return![];}else return _0xc8a9f3;}catch(_0x3997c6){return![];}else return![];}const validToken=(_0x17b53f,_0x567d29)=>{const _0x26c0cb=_0x513efd,_0x14f975=devices[_0x567d29]['ip'];if(!_0x17b53f)return{'error':'No\x20authentication\x20token'};for(let _0x451ef6 of blacklist){if(_0x451ef6[_0x26c0cb(0x16e)]==_0x17b53f)return{'error':_0x26c0cb(0x12f)};}let _0x3d117e;try{_0x3d117e=jwt[_0x26c0cb(0x2d8)](_0x17b53f,secure[_0x26c0cb(0x2c5)]+_0x567d29);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3d117e[_0x26c0cb(0x1c0)](_0x26c0cb(0x2e3))&&!_0x3d117e[_0x26c0cb(0x1c0)](_0x26c0cb(0x1a6))||!_0x3d117e[_0x26c0cb(0x1c0)](_0x26c0cb(0x1e2)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3d117e[_0x26c0cb(0x1c0)](_0x26c0cb(0x1a6))&&_0x3d117e[_0x26c0cb(0x1c0)](_0x26c0cb(0x2e3))){const {clientip:_0x34be2a}=_0x3d117e;return _0x14f975==_0x34be2a?{'success':_0x26c0cb(0x229)}:{'error':_0x26c0cb(0x226)};}else{if(_0x3d117e[_0x26c0cb(0x1c0)]('username')&&_0x3d117e[_0x26c0cb(0x1c0)](_0x26c0cb(0x2e3))){const {username:_0x3e7469,clientip:_0x3e93f3}=_0x3d117e;return settings[_0x26c0cb(0x216)]==_0x3e7469&&_0x14f975==_0x3e93f3?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3e7bae=>{const _0x1dd308=_0x513efd;if(_0x3e7bae){const _0x33c2bf=devices[_0x3e7bae]['ip'];return jwt[_0x1dd308(0x189)]({'username':settings['bbUsername'],'clientip':_0x33c2bf},secure[_0x1dd308(0x2c5)]+_0x3e7bae,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x21cdbd=>{const _0x360e42=_0x513efd;if(_0x21cdbd){const _0x33878f=devices[_0x21cdbd]['ip'];return jwt[_0x360e42(0x189)]({'clientip':_0x33878f},secure[_0x360e42(0x2c5)]+_0x21cdbd,{'expiresIn':devices[_0x21cdbd]['telegramIpApproval'][_0x360e42(0x2d2)]*0x3c});}else return![];},telegramIpApproved=_0x3a9017=>{const _0x1fc537=_0x513efd;let _0x5cd7f9=![];return devices[_0x3a9017][_0x1fc537(0x2b5)]&&devices[_0x3a9017]['telegramIpApproval'][_0x1fc537(0x2d2)]!=_0x1fc537(0x1bc)&&(_0x5cd7f9=devices[_0x3a9017][_0x1fc537(0x2b5)]['clientip']==devices[_0x3a9017]['ip']&&new Date()[_0x1fc537(0x290)]()-devices[_0x3a9017][_0x1fc537(0x2b5)][_0x1fc537(0x2ee)]<devices[_0x3a9017][_0x1fc537(0x2b5)][_0x1fc537(0x2d2)]*0x3c*0x3e8),_0x5cd7f9;},telegram2FaApproved=_0x32d712=>{const _0x2a92e0=_0x513efd;let _0x1604e8=![];return devices[_0x32d712][_0x2a92e0(0x255)]&&devices[_0x32d712][_0x2a92e0(0x255)][_0x2a92e0(0x2d2)]!=_0x2a92e0(0x1bc)&&(_0x1604e8=devices[_0x32d712][_0x2a92e0(0x255)][_0x2a92e0(0x2e3)]==devices[_0x32d712]['ip']&&new Date()[_0x2a92e0(0x290)]()-devices[_0x32d712][_0x2a92e0(0x255)][_0x2a92e0(0x2ee)]<devices[_0x32d712]['telegram2FaApproval'][_0x2a92e0(0x2d2)]*0x3c*0x3e8),_0x1604e8;},normalizeIP=_0x3625dd=>{const _0x2a6e88=_0x513efd;let _0x350803=null,_0x2dfb2c=null;if(ipaddr[_0x2a6e88(0x180)](_0x3625dd)){const _0x3ccd96=ipaddr[_0x2a6e88(0x2db)](_0x3625dd);_0x3ccd96[_0x2a6e88(0x1ba)]()===_0x2a6e88(0x15a)?(_0x3ccd96[_0x2a6e88(0x1c6)]()&&(_0x350803=_0x3ccd96[_0x2a6e88(0x199)]()['toString']()),_0x2dfb2c=_0x3ccd96['toString']()):(_0x350803=_0x3ccd96[_0x2a6e88(0x287)](),_0x2dfb2c=_0x3ccd96[_0x2a6e88(0x2da)]()[_0x2a6e88(0x287)]());}return{'show':_0x350803?_0x350803:_0x2dfb2c,'store':_0x2dfb2c};};function formatDate(_0x5d0de4){const _0x2bf967=_0x513efd;return _0x5d0de4[_0x2bf967(0x289)]()+'/'+(_0x5d0de4[_0x2bf967(0x237)]()+0x1)[_0x2bf967(0x287)]()[_0x2bf967(0x178)](0x2,'0')+'/'+_0x5d0de4['getDate']()['toString']()[_0x2bf967(0x178)](0x2,'0')+'\x20'+_0x5d0de4[_0x2bf967(0x1eb)]()[_0x2bf967(0x287)]()[_0x2bf967(0x178)](0x2,'0')+':'+_0x5d0de4[_0x2bf967(0x232)]()[_0x2bf967(0x287)]()[_0x2bf967(0x178)](0x2,'0')+':'+_0x5d0de4[_0x2bf967(0x1ac)]()['toString']()[_0x2bf967(0x178)](0x2,'0');}function sleep(_0x5e5298){return new Promise(_0x10adc0=>setTimeout(_0x10adc0,_0x5e5298));}