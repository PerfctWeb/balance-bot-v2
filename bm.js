const _0x286343=_0x461f;(function(_0x4b3f2b,_0x46aae5){const _0x49e9e1=_0x461f,_0x32e307=_0x4b3f2b();while(!![]){try{const _0x5a0a50=-parseInt(_0x49e9e1(0x33f))/0x1+-parseInt(_0x49e9e1(0x2ef))/0x2*(-parseInt(_0x49e9e1(0x18a))/0x3)+parseInt(_0x49e9e1(0x2ba))/0x4*(parseInt(_0x49e9e1(0x23a))/0x5)+parseInt(_0x49e9e1(0x211))/0x6*(parseInt(_0x49e9e1(0x314))/0x7)+parseInt(_0x49e9e1(0x316))/0x8+parseInt(_0x49e9e1(0x260))/0x9+parseInt(_0x49e9e1(0x2fe))/0xa*(-parseInt(_0x49e9e1(0x191))/0xb);if(_0x5a0a50===_0x46aae5)break;else _0x32e307['push'](_0x32e307['shift']());}catch(_0x585cc0){_0x32e307['push'](_0x32e307['shift']());}}}(_0x275b,0xebded));const _0x5b3fa3=function(){let _0x98d47d=!![];return function(_0x36fe58,_0x5474e9){const _0x3aeea1=_0x98d47d?function(){if(_0x5474e9){const _0x85e903=_0x5474e9['apply'](_0x36fe58,arguments);return _0x5474e9=null,_0x85e903;}}:function(){};return _0x98d47d=![],_0x3aeea1;};}(),_0x55d885=_0x5b3fa3(this,function(){const _0x1c6893=_0x461f;return _0x55d885['toString']()[_0x1c6893(0x238)](_0x1c6893(0x1ba))[_0x1c6893(0x18c)]()[_0x1c6893(0x20f)](_0x55d885)[_0x1c6893(0x238)](_0x1c6893(0x1ba));});_0x55d885();'use strict';process[_0x286343(0x282)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x286343(0x25f)),fs=require('fs'),fns=require('date-fns'),low=require(_0x286343(0x32b)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x286343(0x249)),crypto=require(_0x286343(0x257)),Crypt=require(_0x286343(0x2fb))['Crypt'],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x286343(0x30c)),jwt=require(_0x286343(0x1a5)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x286343(0x2e0)][_0x286343(0x2dc)](0x2))[_0x286343(0x2e0)],uuidRandom=require(_0x286343(0x32d)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x286343(0x256)),{GraphQLClient,gql}=require(_0x286343(0x2f1)),util=require(_0x286343(0x300)),fileUpload=require('express-fileupload'),PORT=argv[_0x286343(0x232)]||_0x286343(0x2a6),pattern=/^[0-9]{2,4}$/;!pattern[_0x286343(0x1fc)](PORT)&&(console[_0x286343(0x204)](_0x286343(0x23e)+PORT+_0x286343(0x20b)),process[_0x286343(0x31b)](0x1));const HOST=argv['host']||null,userID=argv[_0x286343(0x251)]||'',debugging=argv['d']||![];let bbpath='bb/',bbpath2='';const botfile=_0x286343(0x195),configfile=_0x286343(0x24a),settingsfile=_0x286343(0x18f),securefile=_0x286343(0x1ca),maxBackups=0xa;let validInstallation=!![];!fs[_0x286343(0x2a2)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x286343(0x293)),configpath=userID?bbpath+_0x286343(0x28f)+userID+'/':bbpath+_0x286343(0x28f),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x286343(0x180),zippath=userID?bbpath+_0x286343(0x1bc)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x286343(0x31a);!fs[_0x286343(0x2a2)](configpath)&&fs[_0x286343(0x184)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x286343(0x2a2)](logspath)&&fs[_0x286343(0x184)](logspath);!fs[_0x286343(0x2a2)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x286343(0x2a2)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x286343(0x298)]({'bots':[]})[_0x286343(0x2d6)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x286343(0x2d6)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x286343(0x298)]({'secure':{},'blacklist':[]})[_0x286343(0x2d6)]();let crypt=new Crypt({'md':_0x286343(0x27d),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x286343(0x321)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x286343(0x309)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings[_0x286343(0x253)]&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x1e54f5=>{const _0x211ca7=_0x286343;console[_0x211ca7(0x204)](_0x1e54f5);},'simple':_0x35f297=>{const _0x2216b6=_0x286343;console[_0x2216b6(0x204)](_0x35f297),loggerfile['write'](util['format'](_0x35f297)+'\x0a');},'full':async _0x4befa2=>{const _0xb4037=_0x286343,_0x2d88be=getTimeStamp()+_0xb4037(0x190)+_0x4befa2;console['log'](_0x2d88be),loggerfile[_0xb4037(0x2d6)](util[_0xb4037(0x22d)](_0x2d88be)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0xb4037(0x1d9)]!='orders')await tgBot['sendMessage'](settings[_0xb4037(0x1dc)],_0xb4037(0x234)+_0x4befa2)['catch'](_0x31e327=>{telegramError(_0x31e327);});},'debug':async(_0x450747,_0x48564e='')=>{const _0xde2ca4=_0x286343,_0x478916=getTimeStamp()+_0xde2ca4(0x334)+_0x450747;if(debugging)console['log'](_0x478916);loggerfile[_0xde2ca4(0x2d6)](util[_0xde2ca4(0x22d)](_0x478916)+'\x0a');if(_0x48564e){if(debugging)console[_0xde2ca4(0x204)](_0x48564e);loggerfile[_0xde2ca4(0x2d6)](util[_0xde2ca4(0x22d)](_0x48564e)+'\x0a');}}};process['on'](_0x286343(0x277),function(_0x1e6502){logger['simple'](_0x1e6502);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x286343(0x327))[_0x286343(0x283)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x286343(0x1b1))[_0x286343(0x206)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x286343(0x214)]('/download/:type',async(_0x3c71c2,_0x100603)=>{const _0x4b9ad4=_0x286343,_0x43e180=_0x3c71c2['params'][_0x4b9ad4(0x1d2)],_0x4608f5=getClientsWithBotID(_0x4b9ad4(0x331)),_0x393726=_0x3c71c2['headers'][_0x4b9ad4(0x1ea)],_0x3afa72=timelyDecrypt(_0x393726,![]),_0x192c1b=_0x4608f5[_0x4b9ad4(0x265)](_0x539cee=>_0x539cee[_0x4b9ad4(0x1ea)]==_0x3afa72);if(_0x192c1b){const _0x12cd47=normalizeIP(_0x3c71c2['socket'][_0x4b9ad4(0x2a7)])[_0x4b9ad4(0x219)],_0x4c6f19=_0x3c71c2[_0x4b9ad4(0x1c3)][_0x4b9ad4(0x207)];if(validateAccess(_0x4c6f19,_0x3afa72,_0x12cd47)[_0x4b9ad4(0x226)])_0x43e180==_0x4b9ad4(0x24d)&&await backupConfigFiles(),await zipFiles(_0x43e180),_0x100603[_0x4b9ad4(0x2d4)](zippath+(_0x43e180+_0x4b9ad4(0x255)),_0x78933c=>{const _0x5607f7=_0x4b9ad4;_0x78933c&&(logger[_0x5607f7(0x270)](_0x5607f7(0x19f)+_0x43e180),logger[_0x5607f7(0x305)](_0x78933c));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x43e180+'\x20(1)');}else logger['full'](_0x4b9ad4(0x26f)+_0x43e180+_0x4b9ad4(0x1af));}),app[_0x286343(0x280)](_0x286343(0x263),async(_0x2c1ce9,_0x28f1e9)=>{const _0x3c9f07=_0x286343,_0x32c363=getClientsWithBotID(_0x3c9f07(0x331)),_0x2e5a12=_0x2c1ce9[_0x3c9f07(0x1c3)][_0x3c9f07(0x1ea)],_0x4e69e0=timelyDecrypt(_0x2e5a12,![]),_0x1d3213=_0x32c363[_0x3c9f07(0x265)](_0x513778=>_0x513778['uuid']==_0x4e69e0);logger[_0x3c9f07(0x2bf)](_0x3c9f07(0x1ce));if(_0x1d3213){const _0x5c26e9=normalizeIP(_0x2c1ce9[_0x3c9f07(0x2e8)][_0x3c9f07(0x2a7)])['store'],_0x558e7d=_0x2c1ce9[_0x3c9f07(0x1c3)][_0x3c9f07(0x207)];if(validateAccess(_0x558e7d,_0x4e69e0,_0x5c26e9)[_0x3c9f07(0x226)]){if(_0x2c1ce9['files']){const _0x58edb5=_0x2c1ce9['files']['backupfile'];await _0x58edb5['mv'](temppath+_0x58edb5[_0x3c9f07(0x21a)]),_0x28f1e9[_0x3c9f07(0x1f8)]({'status':!![],'message':_0x3c9f07(0x30b)});const _0x5cce68=getBotsWithMode();_0x5cce68[_0x3c9f07(0x20e)]>0x0?confirmRestore(temppath,_0x58edb5['name']):unzipFile(temppath,_0x58edb5[_0x3c9f07(0x21a)]);}}else logger[_0x3c9f07(0x270)](_0x3c9f07(0x28d));}else logger[_0x3c9f07(0x270)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x286343(0x2fc)](express['static'](path['join'](__dirname,bbpath2,_0x286343(0x336)))),app[_0x286343(0x2fc)](express['static'](path['join'](__dirname,bbpath2,_0x286343(0x2e7)))),app['get']('/',function(_0x4c901d,_0xf61f83){const _0x20e281=_0x286343;_0xf61f83[_0x20e281(0x288)](path['join'](__dirname,bbpath2,_0x20e281(0x336),'index.html'));}),app['get'](_0x286343(0x17c),function(_0x2aef48,_0x4fb6b6){const _0x1405c3=_0x286343;_0x4fb6b6[_0x1405c3(0x288)](path[_0x1405c3(0x2e9)](__dirname,bbpath2,_0x1405c3(0x2e7),_0x1405c3(0x30d)));}),app[_0x286343(0x214)](_0x286343(0x318),(_0x5e3765,_0x5afa79)=>{const _0x1cab60=_0x286343;_0x5afa79[_0x1cab60(0x288)](path[_0x1cab60(0x2e9)](__dirname,bbpath2,_0x1cab60(0x2e7),_0x1cab60(0x30d)));}),app[_0x286343(0x214)](_0x286343(0x179),(_0x30944c,_0x4333b3)=>{const _0x11913a=_0x286343;_0x4333b3[_0x11913a(0x288)](path[_0x11913a(0x2e9)](__dirname,bbpath2,_0x11913a(0x2e7),'index.html'));}),app[_0x286343(0x214)](_0x286343(0x236),(_0x452f86,_0x34f6a1)=>{const _0x183071=_0x286343;_0x34f6a1[_0x183071(0x288)](path[_0x183071(0x2e9)](__dirname,bbpath2,_0x183071(0x2e7),'index.html'));}),app[_0x286343(0x214)](_0x286343(0x1a4),(_0x36366e,_0x556b2e)=>{const _0x23d311=_0x286343;_0x556b2e['sendFile'](path[_0x23d311(0x2e9)](__dirname,bbpath2,_0x23d311(0x2e7),_0x23d311(0x30d)));}),app['get']('/:bot/configuration',(_0x264085,_0x476d84)=>{const _0x2dd2b8=_0x286343;_0x476d84[_0x2dd2b8(0x288)](path[_0x2dd2b8(0x2e9)](__dirname,bbpath2,'build','index.html'));}),app[_0x286343(0x214)](_0x286343(0x338),(_0x35de3f,_0x48b9c6)=>{const _0x27ccb8=_0x286343;_0x48b9c6[_0x27ccb8(0x288)](path['join'](__dirname,bbpath2,_0x27ccb8(0x2e7),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x286343(0x20d)](PORT);const io=require(_0x286343(0x1c1))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x3b3c4f=_0x286343;logger[_0x3b3c4f(0x305)](''),logger[_0x3b3c4f(0x305)](_0x3b3c4f(0x291)),await logger[_0x3b3c4f(0x270)](_0x3b3c4f(0x285)+PORT),logger[_0x3b3c4f(0x305)](_0x3b3c4f(0x291));if(config[_0x3b3c4f(0x20e)]!=0x0)for(const _0x5bc7f7 of config){if(_0x5bc7f7[_0x3b3c4f(0x1ac)]==_0x3b3c4f(0x33c)||_0x5bc7f7[_0x3b3c4f(0x1ac)]=='new')await logger[_0x3b3c4f(0x270)]('Starting\x20bot\x20|\x20Bot\x20'+_0x5bc7f7[_0x3b3c4f(0x201)]+_0x3b3c4f(0x295)+_0x5bc7f7[_0x3b3c4f(0x2e3)]),startBot([_0x5bc7f7['botID'],userID],{'cwd':bbpath},function(_0x33a6c1){const _0x54316c=_0x3b3c4f;if(_0x33a6c1)logger[_0x54316c(0x270)](_0x33a6c1);});else(_0x5bc7f7['status']=='disabled'||_0x5bc7f7['status']==_0x3b3c4f(0x308))&&await logger[_0x3b3c4f(0x270)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x5bc7f7['botID']+_0x3b3c4f(0x295)+_0x5bc7f7[_0x3b3c4f(0x2e3)]);}else!newBot&&logger['simple'](_0x3b3c4f(0x2e2));if(newBot)addBot();logger[_0x3b3c4f(0x305)](_0x3b3c4f(0x291)),logger['simple']('');}function startSocket(){const _0x95c205=_0x286343;io['on'](_0x95c205(0x29c),_0x152ee7=>{const _0xb41800=_0x95c205;let _0x57a27a,_0x30aefd,_0x2595ff,_0x5402d0,_0x406235;const _0x4d0f1a=_0x152ee7['handshake'][_0xb41800(0x1c3)][_0xb41800(0x26a)];_0x30aefd=_0x4d0f1a[_0xb41800(0x1dd)](/bot[0-9]{3}/);if(_0x30aefd)_0x2595ff=_0x30aefd[0x0][_0xb41800(0x1dd)](/[0-9]{3}/);if(_0x2595ff)_0x57a27a=_0x2595ff[0x0];else _0x57a27a='botmanager';const _0x2dab19=_0x152ee7[_0xb41800(0x1d6)][_0xb41800(0x333)][_0xb41800(0x220)];if(!_0x2dab19)_0x152ee7[_0xb41800(0x261)](_0xb41800(0x1ac),{'publicKey':secure['publicKey']});else{_0x5402d0=timelyDecrypt(_0x2dab19,![]);if(!_0x5402d0)_0x152ee7['emit'](_0xb41800(0x1ac),{'publicKey':secure[_0xb41800(0x27f)]});else{_0x406235=normalizeIP(_0x152ee7[_0xb41800(0x323)][_0xb41800(0x2a7)])[_0xb41800(0x219)];if(!devices[_0x5402d0])devices[_0x5402d0]={'uuid':_0x5402d0,'access':{'token':null}};devices[_0x5402d0]['ip']=_0x406235;const _0x6731b=addClient(_0x152ee7['id'],_0x5402d0,_0x57a27a);setAccess(_0x6731b),emitMessages(),_0x152ee7['on'](_0xb41800(0x2c6),_0x3868a6=>{const _0xba84de=_0xb41800,_0x470b2b=timelyDecrypt(_0x3868a6[_0xba84de(0x2d3)]);if(_0x470b2b){_0x3868a6={'username':_0x3868a6[_0xba84de(0x1d4)],'password':_0x470b2b},devices[_0x5402d0][_0xba84de(0x1fe)]=validateCredentials(_0x3868a6,_0x5402d0);if(devices[_0x5402d0][_0xba84de(0x1fe)][_0xba84de(0x226)]==![]&&devices[_0x5402d0][_0xba84de(0x1fe)][_0xba84de(0x1f6)]==_0xba84de(0x243))_0x152ee7['emit'](_0xba84de(0x1ac),{'access':devices[_0x5402d0][_0xba84de(0x1fe)]}),loginAccess2FA(_0x5402d0,_0x406235);else{if(devices[_0x5402d0][_0xba84de(0x1fe)]['allow']==![]&&devices[_0x5402d0][_0xba84de(0x1fe)][_0xba84de(0x1f6)]==_0xba84de(0x1df))_0x152ee7[_0xba84de(0x261)](_0xba84de(0x1ac),{'access':devices[_0x5402d0][_0xba84de(0x1fe)]});else devices[_0x5402d0][_0xba84de(0x1fe)][_0xba84de(0x226)]&&devices[_0x5402d0][_0xba84de(0x1fe)][_0xba84de(0x1f6)]==_0xba84de(0x2a1)&&(getClientsWithUuid(_0x5402d0)[_0xba84de(0x262)](_0x4f6f41=>{setAccess(_0x4f6f41);}),logger['debug'](_0xba84de(0x337)+_0x5402d0[_0xba84de(0x2dc)](-0x8)),setTokenRefresh(_0x5402d0),setSessionTimeout(_0xba84de(0x2c6),_0x5402d0));}}else logger[_0xba84de(0x270)](_0xba84de(0x2a5));}),_0x152ee7['on']('reset-password',()=>{resetPassword();}),_0x152ee7['on']('disconnect',_0x137f1f=>{removeClient(_0x152ee7['id']);}),_0x57a27a==_0xb41800(0x331)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4b79fb){const _0x518d42=_0x286343;if(_0x4b79fb!=_0x518d42(0x331)&&config[_0x518d42(0x302)]!=''){if(pid[_0x4b79fb])pid[_0x4b79fb][_0x518d42(0x1f8)]({'function':_0x518d42(0x2dd),'args':null});}_0x4b79fb!=_0x518d42(0x331)&&broadcastToBots(_0x518d42(0x186),JSON[_0x518d42(0x254)](config));}function reloadBotManager(){const _0x1c2826=_0x286343;getClientsWithBotID(_0x1c2826(0x331))[_0x1c2826(0x262)](_0x3e876e=>{const _0x34759b=_0x1c2826;getSocket(_0x3e876e['id'])['emit'](_0x34759b(0x1ac),{'access':{'allow':![],'reason':_0x34759b(0x213),'token':null}});});}function getSocket(_0x255cff){const _0x1e9824=_0x286343;return io[_0x1e9824(0x1d8)][_0x1e9824(0x1d8)]['get'](_0x255cff);}function setAccess(_0x14c911){const _0x4d8a12=_0x286343,_0x361cae=getSocket(_0x14c911['id']),_0x50380d=_0x14c911['uuid'],_0x4a7ce8=_0x14c911['bot'];devices[_0x50380d][_0x4d8a12(0x1fe)]=validateAccess(devices[_0x50380d]['access'][_0x4d8a12(0x2c7)],_0x50380d),logger[_0x4d8a12(0x2bf)](_0x4d8a12(0x1c2)+devices[_0x50380d][_0x4d8a12(0x1fe)][_0x4d8a12(0x1f6)]+_0x4d8a12(0x22b)+_0x14c911['id'][_0x4d8a12(0x2dc)](-0x8)+'\x20|\x20user:\x20...'+_0x50380d[_0x4d8a12(0x2dc)](-0x8)),_0x361cae[_0x4d8a12(0x2e9)](_0x50380d);if(devices[_0x50380d][_0x4d8a12(0x1fe)][_0x4d8a12(0x226)]){_0x361cae['join'](_0x4a7ce8);if(_0x4a7ce8==_0x4d8a12(0x331))initializeSocketBotManager(_0x361cae);else initializeSocketBot(_0x361cae);initClient(_0x4a7ce8);}devices[_0x50380d][_0x4d8a12(0x1fe)][_0x4d8a12(0x2c7)]&&devices[_0x50380d][_0x4d8a12(0x1fe)][_0x4d8a12(0x1f6)]==_0x4d8a12(0x23c)&&setSessionTimeout(_0x4d8a12(0x193),_0x50380d),devices[_0x50380d]['access'][_0x4d8a12(0x2c7)]&&devices[_0x50380d][_0x4d8a12(0x1fe)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x50380d),_0x361cae[_0x4d8a12(0x261)](_0x4d8a12(0x1ac),{'status':_0x14c911['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x50380d]['access'],'externalip':devices[_0x50380d]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x4d8a12(0x1ec)],'validInstallation':validInstallation}),devices[_0x50380d]['access'][_0x4d8a12(0x226)]==![]&&devices[_0x50380d]['access'][_0x4d8a12(0x1f6)]==_0x4d8a12(0x2b2)&&temporaryAccess2FA(_0x50380d,devices[_0x50380d]['ip']);}function setSessionTimeout(_0x457b3a,_0x5ed226){const _0x175909=_0x286343;let _0x57eea3;if(_0x457b3a==_0x175909(0x2c6))_0x57eea3=loginExpiry*0x3c*0x3e8;else _0x57eea3=devices[_0x5ed226]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x175909(0x231)]()-devices[_0x5ed226][_0x175909(0x328)]['timestamp']);if(devices[_0x5ed226][_0x175909(0x33b)])clearTimeout(devices[_0x5ed226]['pidExpireLogin']);devices[_0x5ed226][_0x175909(0x33b)]=setTimeout(()=>{const _0x298e77=_0x175909;if(devices[_0x5ed226]['pidRefreshToken'])clearTimeout(devices[_0x5ed226][_0x298e77(0x1fa)]);removeSocketListeners(_0x5ed226),addBlacklist(_0x5ed226),devices[_0x5ed226]['telegramIpApproval']=null,devices[_0x5ed226][_0x298e77(0x2a4)]=null,devices[_0x5ed226]['access']['token']=null,logger[_0x298e77(0x2bf)](_0x298e77(0x240)+_0x5ed226[_0x298e77(0x2dc)](-0x8)),devices[_0x5ed226]['access']=validateAccess(devices[_0x5ed226][_0x298e77(0x1fe)][_0x298e77(0x2c7)],_0x5ed226),!(devices[_0x5ed226]['access'][_0x298e77(0x226)]&&devices[_0x5ed226][_0x298e77(0x1fe)][_0x298e77(0x1f6)]=='login\x20not\x20required')&&(_0x457b3a=='login'?io['to'](_0x5ed226)[_0x298e77(0x261)](_0x298e77(0x1ac),{'access':{'allow':![],'reason':_0x298e77(0x264),'token':null}}):io['to'](_0x5ed226)['emit'](_0x298e77(0x1ac),{'access':{'allow':![],'reason':_0x298e77(0x245),'token':null}})),devices[_0x5ed226][_0x298e77(0x1fe)]['token']=null;},_0x57eea3);}function setTokenRefresh(_0x14ccdc){const _0x337f9e=_0x286343;if(devices[_0x14ccdc][_0x337f9e(0x1fa)])clearTimeout(devices[_0x14ccdc][_0x337f9e(0x1fa)]);devices[_0x14ccdc][_0x337f9e(0x1fa)]=setTimeout(()=>{const _0x453dd4=_0x337f9e;getClientsWithUuid(_0x14ccdc)['length']!=0x0?(devices[_0x14ccdc][_0x453dd4(0x1fe)]=refreshToken(_0x14ccdc),io['to'](_0x14ccdc)[_0x453dd4(0x261)]('status',{'status':_0x453dd4(0x1ae),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x14ccdc]['access'],'externalip':devices[_0x14ccdc]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x14ccdc)):clearTimeout(devices[_0x14ccdc][_0x453dd4(0x1fa)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2d1c4a){const _0x4f2884=_0x286343,_0x2af9ae=getClient(_0x2d1c4a['id'])[_0x4f2884(0x1ea)];_0x2d1c4a[_0x4f2884(0x261)](_0x4f2884(0x186),config),_0x2d1c4a['emit'](_0x4f2884(0x21b),cleanSettings()),_0x2d1c4a['on'](_0x4f2884(0x196),_0x495e1d=>{const _0x4f8a67=_0x4f2884;if(validateAccess(_0x495e1d,_0x2af9ae)[_0x4f8a67(0x226)])addBot();else logger[_0x4f8a67(0x270)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2d1c4a['on'](_0x4f2884(0x278),(_0x4f9a64,_0xa41a0f)=>{const _0x2f6354=_0x4f2884;if(validateAccess(_0xa41a0f,_0x2af9ae)[_0x2f6354(0x226)])toggleBot(_0x4f9a64[_0x2f6354(0x201)],_0x4f9a64[_0x2f6354(0x1ac)],_0x4f9a64[_0x2f6354(0x2c9)]);else logger['full'](_0x2f6354(0x1c7));}),_0x2d1c4a['on']('toggle-bot-mode',(_0x4c65aa,_0xd69f7c)=>{const _0xb90daa=_0x4f2884;if(validateAccess(_0xd69f7c,_0x2af9ae)[_0xb90daa(0x226)])toggleBotMode(_0x4c65aa);else logger['full'](_0xb90daa(0x1c7));}),_0x2d1c4a['on']('delete-bot',(_0x375365,_0x533ae6)=>{const _0x3c7d41=_0x4f2884;if(validateAccess(_0x533ae6,_0x2af9ae)[_0x3c7d41(0x226)])deleteBot(_0x375365);else logger[_0x3c7d41(0x270)](_0x3c7d41(0x17a));}),_0x2d1c4a['on'](_0x4f2884(0x2d8),(_0x35932a,_0x38d676)=>{const _0x2a9df2=_0x4f2884;if(validateAccess(_0x38d676,_0x2af9ae)[_0x2a9df2(0x226)])storeSettings(_0x35932a,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2d1c4a['on'](_0x4f2884(0x1e3),_0x232fd8=>{const _0xf8a765=_0x4f2884;if(validateAccess(_0x232fd8,_0x2af9ae)[_0xf8a765(0x226)])updateBB(_0xf8a765(0x1f0));else logger[_0xf8a765(0x270)](_0xf8a765(0x339));}),_0x2d1c4a['on'](_0x4f2884(0x1ad),_0x4a2a12=>{const _0x3a3ec3=_0x4f2884;if(validateAccess(_0x4a2a12,_0x2af9ae)['allow'])updateBB(_0x3a3ec3(0x1e2));else logger[_0x3a3ec3(0x270)](_0x3a3ec3(0x319));}),_0x2d1c4a['on']('get-backup-files',_0x471378=>{const _0x1d029f=_0x4f2884;if(validateAccess(_0x471378,_0x2af9ae)[_0x1d029f(0x226)]){const _0x3f879a=getClient(_0x2d1c4a['id']);if(_0x3f879a)getBackupFiles(_0x3f879a[_0x1d029f(0x1ea)]);else logger[_0x1d029f(0x270)](_0x1d029f(0x17d));}else logger['full'](_0x1d029f(0x1fd));}),_0x2d1c4a['on'](_0x4f2884(0x18e),(_0x5a4dfd,_0x581493)=>{const _0x32048e=_0x4f2884;if(validateAccess(_0x581493,_0x2af9ae)[_0x32048e(0x226)])restoreBackupFile(_0x5a4dfd);else logger[_0x32048e(0x270)](_0x32048e(0x306));}),_0x2d1c4a['on'](_0x4f2884(0x2f6),_0x495ae3=>{const _0x198f15=_0x4f2884;if(validateAccess(_0x495ae3,_0x2af9ae)[_0x198f15(0x226)])getMessages();else logger[_0x198f15(0x270)](_0x198f15(0x217));}),_0x2d1c4a['on'](_0x4f2884(0x24c),(_0x41ce85,_0x304450)=>{const _0xbdc937=_0x4f2884;if(validateAccess(_0x304450,_0x2af9ae)[_0xbdc937(0x226)])confirmMessage(_0x41ce85);else logger[_0xbdc937(0x270)](_0xbdc937(0x2f8));}),_0x2d1c4a['on'](_0x4f2884(0x296),_0x416376=>{const _0x5bda4b=_0x4f2884;if(validateAccess(_0x416376,_0x2af9ae)[_0x5bda4b(0x226)]){if(devices[_0x2af9ae][_0x5bda4b(0x1fa)])clearTimeout(devices[_0x2af9ae][_0x5bda4b(0x1fa)]);if(devices[_0x2af9ae]['pidExpireLogin'])clearTimeout(devices[_0x2af9ae][_0x5bda4b(0x33b)]);removeSocketListeners(getClient(_0x2d1c4a['id'])[_0x5bda4b(0x1ea)]),addBlacklist(_0x2af9ae),devices[_0x2af9ae][_0x5bda4b(0x328)]=null,devices[_0x2af9ae][_0x5bda4b(0x2a4)]=null,devices[_0x2af9ae][_0x5bda4b(0x1fe)][_0x5bda4b(0x2c7)]=null,logger[_0x5bda4b(0x2bf)](_0x5bda4b(0x32e)+_0x2af9ae[_0x5bda4b(0x2dc)](-0x8)),io['to'](getClient(_0x2d1c4a['id'])[_0x5bda4b(0x1ea)])[_0x5bda4b(0x261)](_0x5bda4b(0x1ac),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5bda4b(0x270)](_0x5bda4b(0x17b));});}function initializeSocketBot(_0x1cbb9b){const _0x1b766c=_0x286343,_0xc5b7f2=getClient(_0x1cbb9b['id'])[_0x1b766c(0x2ca)],_0x1b40fa=getClient(_0x1cbb9b['id'])[_0x1b766c(0x1ea)];_0x1cbb9b['on']('get-logs',(_0x457dda,_0x49255c)=>{const _0x4eefa3=_0x1b766c;if(validateAccess(_0x49255c,_0x1b40fa)[_0x4eefa3(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2]['send']({'function':_0x4eefa3(0x2f3),'args':_0x457dda});}else logger[_0x4eefa3(0x270)](_0x4eefa3(0x224));}),_0x1cbb9b['on'](_0x1b766c(0x1cc),(_0x7420c8,_0x3f29e2)=>{const _0x25f196=_0x1b766c;if(validateAccess(_0x3f29e2,_0x1b40fa)[_0x25f196(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x25f196(0x1f8)]({'function':'deleteHistoryAlerts','args':_0x7420c8});}else logger[_0x25f196(0x270)](_0x25f196(0x1a0));}),_0x1cbb9b['on'](_0x1b766c(0x229),(_0x1ce44c,_0xee3951)=>{const _0x3ace2a=_0x1b766c;if(validateAccess(_0xee3951,_0x1b40fa)[_0x3ace2a(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x3ace2a(0x1f8)]({'function':_0x3ace2a(0x31f),'args':_0x1ce44c});}else logger['full'](_0x3ace2a(0x1c8));}),_0x1cbb9b['on'](_0x1b766c(0x25b),(_0x28bcfb,_0x1363c9)=>{const _0x3a0f63=_0x1b766c;if(validateAccess(_0x1363c9,_0x1b40fa)[_0x3a0f63(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2]['send']({'function':_0x3a0f63(0x2b4),'args':_0x28bcfb});}else logger[_0x3a0f63(0x270)](_0x3a0f63(0x2c4));}),_0x1cbb9b['on']('store-headless',(_0x3ed9fb,_0x76c4ca)=>{const _0x58e1be=_0x1b766c;if(validateAccess(_0x76c4ca,_0x1b40fa)['allow']){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x58e1be(0x1f8)]({'function':_0x58e1be(0x271),'args':_0x3ed9fb});}else logger[_0x58e1be(0x270)](_0x58e1be(0x218));}),_0x1cbb9b['on']('store-fiat',(_0x3b7dce,_0x13b4cb)=>{const _0x5705ce=_0x1b766c;if(validateAccess(_0x13b4cb,_0x1b40fa)[_0x5705ce(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2]['send']({'function':_0x5705ce(0x242),'args':_0x3b7dce});}else logger['full'](_0x5705ce(0x1a2));}),_0x1cbb9b['on'](_0x1b766c(0x198),_0x54a990=>{const _0xf43a=_0x1b766c;if(validateAccess(_0x54a990,_0x1b40fa)[_0xf43a(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2]['send']({'function':'resetHistory','args':null});}else logger[_0xf43a(0x270)](_0xf43a(0x2cc));}),_0x1cbb9b['on'](_0x1b766c(0x272),_0x170faf=>{const _0x730b46=_0x1b766c;if(validateAccess(_0x170faf,_0x1b40fa)['allow']){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x730b46(0x1f8)]({'function':_0x730b46(0x2d7),'args':null});}else logger[_0x730b46(0x270)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1cbb9b['on'](_0x1b766c(0x2f7),(_0x24a552,_0xfb2357)=>{const _0x4a1d35=_0x1b766c;if(validateAccess(_0xfb2357,_0x1b40fa)[_0x4a1d35(0x226)]){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x4a1d35(0x1f8)]({'function':_0x4a1d35(0x200),'args':_0x24a552});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x1cbb9b['on'](_0x1b766c(0x33d),_0x4faedf=>{const _0x2450a2=_0x1b766c;if(validateAccess(_0x4faedf,_0x1b40fa)['allow']){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x2450a2(0x1f8)]({'function':_0x2450a2(0x281),'args':null});}else logger[_0x2450a2(0x270)](_0x2450a2(0x304));}),_0x1cbb9b['on']('show-config',_0x49c005=>{const _0x1a8a1e=_0x1b766c;if(validateAccess(_0x49c005,_0x1b40fa)['allow']){if(pid[_0xc5b7f2])pid[_0xc5b7f2][_0x1a8a1e(0x1f8)]({'function':_0x1a8a1e(0x32a),'args':null});}else logger[_0x1a8a1e(0x270)](_0x1a8a1e(0x320));}),_0x1cbb9b['on']('update-bb',_0x2ee2c4=>{const _0x1119c0=_0x1b766c;if(validateAccess(_0x2ee2c4,_0x1b40fa)[_0x1119c0(0x226)])updateBB(_0x1119c0(0x1f0));else logger[_0x1119c0(0x270)](_0x1119c0(0x339));}),_0x1cbb9b['on']('get-messages',_0x93c7c4=>{const _0x4d799e=_0x1b766c;if(validateAccess(_0x93c7c4,_0x1b40fa)['allow'])getMessages();else logger['full'](_0x4d799e(0x217));}),_0x1cbb9b['on']('confirm-message',(_0x1b4ad9,_0x3dd3e6)=>{const _0x5cab85=_0x1b766c;if(validateAccess(_0x3dd3e6,_0x1b40fa)[_0x5cab85(0x226)])confirmMessage(_0x1b4ad9);else logger[_0x5cab85(0x270)](_0x5cab85(0x2f8));}),_0x1cbb9b['on'](_0x1b766c(0x296),_0x4370d5=>{const _0x3a2efb=_0x1b766c;if(validateAccess(_0x4370d5,_0x1b40fa)['allow']){if(devices[_0x1b40fa][_0x3a2efb(0x1fa)])clearTimeout(devices[_0x1b40fa][_0x3a2efb(0x1fa)]);if(devices[_0x1b40fa]['pidExpireLogin'])clearTimeout(devices[_0x1b40fa][_0x3a2efb(0x33b)]);removeSocketListeners(getClient(_0x1cbb9b['id'])['uuid']),addBlacklist(_0x1b40fa),devices[_0x1b40fa][_0x3a2efb(0x328)]=null,devices[_0x1b40fa]['telegram2FaApproval']=null,devices[_0x1b40fa][_0x3a2efb(0x1fe)][_0x3a2efb(0x2c7)]=null,logger['debug'](_0x3a2efb(0x32e)+_0x1b40fa[_0x3a2efb(0x2dc)](-0x8)),io['to'](getClient(_0x1cbb9b['id'])[_0x3a2efb(0x1ea)])[_0x3a2efb(0x261)](_0x3a2efb(0x1ac),{'access':{'allow':![],'reason':_0x3a2efb(0x235),'token':null}});}else logger[_0x3a2efb(0x270)](_0x3a2efb(0x17b));});}function removeSocketListeners(_0x24dc45){const _0x45a122=_0x286343;getClientsWithUuid(_0x24dc45)[_0x45a122(0x262)](_0x2adc3c=>{const _0x5ec56f=_0x45a122;getSocket(_0x2adc3c['id'])[_0x5ec56f(0x199)]();});}function cleanSettings(){const _0x695c52=_0x286343;let _0x1dd2be=settings;return settings[_0x695c52(0x2c0)]&&settings[_0x695c52(0x2c0)]!=''&&(_0x1dd2be={..._0x1dd2be,'telegramToken':_0x695c52(0x1b6)}),settings['bbPassword']&&settings[_0x695c52(0x2ea)]!=''&&(_0x1dd2be={..._0x1dd2be,'bbPassword':_0x695c52(0x1b6)}),(settings[_0x695c52(0x2ea)]&&settings[_0x695c52(0x2ea)]=='***'||settings[_0x695c52(0x2c0)]&&settings['telegramToken']==_0x695c52(0x247))&&(_0x1dd2be={..._0x1dd2be,'restored':{'password':settings[_0x695c52(0x2ea)]==_0x695c52(0x247),'telegram':settings[_0x695c52(0x2c0)]==_0x695c52(0x247)}}),_0x1dd2be;}async function updateBB(_0x2e579a){const _0x401263=_0x286343;await backupConfigFiles(),installingUpdate=!![],config[_0x401263(0x262)](_0x1cce5d=>{const _0x5e7974=_0x401263;restartBot(_0x1cce5d[_0x5e7974(0x201)]);}),logger[_0x401263(0x2bf)](_0x401263(0x216)+_0x2e579a);if(_0x2e579a=='update')process['send']({'update':!![]},_0x1e4c4a=>{});else _0x2e579a==_0x401263(0x1e2)&&process[_0x401263(0x1f8)]({'reinstall':!![]},_0x5c636f=>{});}function startBot(_0x28c5cf,_0x522993,_0x3fa8f2){const _0x3a40ac=_0x286343;if(debugging)_0x28c5cf[_0x3a40ac(0x187)]('-d');let _0x59010d=![];const _0x4bb103=_0x28c5cf[0x0];_0x522993={..._0x522993,'stdio':[_0x3a40ac(0x189),_0x3a40ac(0x189),_0x3a40ac(0x189),'ipc']},pid[_0x4bb103]=childProcess[_0x3a40ac(0x290)](botfile,_0x28c5cf,_0x522993),pid[_0x4bb103]['on']('message',_0x23c7be=>{const _0x40cc62=_0x3a40ac;switch(Object[_0x40cc62(0x2b7)](_0x23c7be)[0x0]){case _0x40cc62(0x2e3):updateBotName(_0x4bb103,_0x23c7be[_0x40cc62(0x2e3)]);break;case _0x40cc62(0x205):updateBotManager();break;case _0x40cc62(0x1ac):updateStatus(_0x4bb103,_0x23c7be[_0x40cc62(0x1ac)]);break;case _0x40cc62(0x2c9):updateLive(_0x4bb103,_0x23c7be[_0x40cc62(0x2c9)]);break;case _0x40cc62(0x2a9):updateLive(_0x4bb103,_0x23c7be['started']),io['to'](_0x4bb103)['emit'](_0x40cc62(0x1ac),{'access':{'allow':![],'reason':_0x40cc62(0x213),'token':null}});break;case'stop':_0x23c7be[_0x40cc62(0x1a7)]=='restart'&&restartBot(_0x4bb103);_0x23c7be[_0x40cc62(0x1a7)]==_0x40cc62(0x221)&&toggleBot(_0x4bb103,'disabled',_0x40cc62(0x2cd));break;case _0x40cc62(0x29d):sendTelegram(_0x4bb103,_0x23c7be[_0x40cc62(0x29d)]);break;case _0x40cc62(0x2ac):sendTelegramMsg(_0x23c7be['telegrammsg']);break;case'function':io['to'](_0x4bb103)[_0x40cc62(0x261)](_0x23c7be['function'],_0x23c7be[_0x40cc62(0x21c)]);break;}}),pid[_0x4bb103]['on'](_0x3a40ac(0x24b),function(_0x25b4a9){if(_0x59010d)return;_0x59010d=!![],_0x3fa8f2(_0x25b4a9);}),pid[_0x4bb103]['on'](_0x3a40ac(0x31b),async function(_0x5af831){const _0x269bee=_0x3a40ac;if(installingUpdate)return;if(_0x59010d)return;_0x59010d=!![],_0x3fa8f2(null);const _0x2f4791=dbConfig[_0x269bee(0x214)](_0x269bee(0x186))[_0x269bee(0x265)]({'botID':_0x4bb103})[_0x269bee(0x329)]();_0x2f4791&&(_0x2f4791[_0x269bee(0x1ac)]=='enabled'||_0x2f4791[_0x269bee(0x1ac)]==_0x269bee(0x269))&&(await sleep(0x3e8),updateLive(_0x4bb103,_0x269bee(0x2cd)),logger['full'](_0x269bee(0x2ed)+_0x4bb103),startBot([_0x4bb103,userID],{'cwd':bbpath},function(_0x1416d1){if(_0x1416d1)logger['full'](_0x1416d1);}));});}function stopBot(_0x1a9401){const _0x437d5c=_0x286343;getClientsWithBotID(_0x1a9401)[_0x437d5c(0x262)](_0x16eca4=>{const _0x549115=_0x437d5c;getSocket(_0x16eca4['id'])[_0x549115(0x28e)](!![]),removeClient(_0x16eca4['id']);}),pid[_0x1a9401]&&(pid[_0x1a9401][_0x437d5c(0x221)](),pid[_0x1a9401]=null);}function restartBot(_0x14694e){const _0x1f3d60=_0x286343;if(pid[_0x14694e])pid[_0x14694e][_0x1f3d60(0x221)]();}function addBot(){const _0x367515=_0x286343;let _0x2a5f0b;for(let _0x5251f0=0x1;_0x5251f0<0x3e9;_0x5251f0++){_0x2a5f0b=_0x5251f0['toString']()['padStart'](0x3,'0');let _0x3ac983=config[_0x367515(0x265)](_0x58496b=>_0x58496b[_0x367515(0x201)]==_0x2a5f0b);if(!_0x3ac983)break;}if(_0x2a5f0b===_0x367515(0x181)){logger['full'](_0x367515(0x1be));return;}logger[_0x367515(0x270)](_0x367515(0x326)+_0x2a5f0b),dbConfig[_0x367515(0x214)]('bots')[_0x367515(0x187)]({'botID':_0x2a5f0b,'botname':'Bot\x20'+_0x2a5f0b,'status':'new','live':''})[_0x367515(0x2d6)](),startBot([_0x2a5f0b,userID],{'cwd':bbpath},function(_0x454eec){const _0x2c43df=_0x367515;if(_0x454eec)logger[_0x2c43df(0x270)](_0x454eec);}),config=getConfiguration(),io['to'](_0x367515(0x331))['emit']('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x34c21c){const _0x2beba6=_0x286343;getClientsWithBotID(_0x34c21c)['forEach'](_0x4aeae9=>{getSocket(_0x4aeae9['id'])['disconnect'](!![]),removeClient(_0x4aeae9['id']);}),dbConfig[_0x2beba6(0x214)](_0x2beba6(0x186))[_0x2beba6(0x27e)]({'botID':_0x34c21c})[_0x2beba6(0x2d6)](),logger['full']('Deleted\x20Bot\x20'+_0x34c21c),stopBot(_0x34c21c);try{if(fs[_0x2beba6(0x2a2)](path[_0x2beba6(0x2e9)](configpath,_0x2beba6(0x2a8)+_0x34c21c+'-config.json')))fs[_0x2beba6(0x2bc)](path[_0x2beba6(0x2e9)](configpath,_0x2beba6(0x2a8)+_0x34c21c+'-config.json'));if(fs['existsSync'](path[_0x2beba6(0x2e9)](configpath,_0x2beba6(0x2a8)+_0x34c21c+_0x2beba6(0x1c0))))fs[_0x2beba6(0x2bc)](path[_0x2beba6(0x2e9)](configpath,_0x2beba6(0x2a8)+_0x34c21c+_0x2beba6(0x1c0)));if(fs[_0x2beba6(0x2a2)](path[_0x2beba6(0x2e9)](configpath,'bot-'+_0x34c21c+_0x2beba6(0x1c9))))fs[_0x2beba6(0x2bc)](path[_0x2beba6(0x2e9)](configpath,'bot-'+_0x34c21c+'-performance.json'));if(fs[_0x2beba6(0x2a2)](path[_0x2beba6(0x2e9)](configpath,_0x2beba6(0x2a8)+_0x34c21c+_0x2beba6(0x1e4))))fs[_0x2beba6(0x2bc)](path[_0x2beba6(0x2e9)](configpath,_0x2beba6(0x2a8)+_0x34c21c+_0x2beba6(0x1e4)));}catch(_0x453513){if(_0x453513)logger[_0x2beba6(0x270)](_0x2beba6(0x222),_0x453513);}config=getConfiguration(),io['to'](_0x2beba6(0x331))[_0x2beba6(0x261)](_0x2beba6(0x186),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x527458,_0x570a73,_0x161a4f){const _0x1cc520=_0x286343;dbConfig[_0x1cc520(0x214)](_0x1cc520(0x186))[_0x1cc520(0x265)]({'botID':_0x527458})[_0x1cc520(0x22c)]({'status':_0x570a73})['assign']({'live':_0x161a4f})[_0x1cc520(0x2d6)]();if(_0x570a73==_0x1cc520(0x33c)||_0x570a73==_0x1cc520(0x269))logger[_0x1cc520(0x270)](_0x1cc520(0x1b3)+_0x527458),startBot([_0x527458,userID],{'cwd':bbpath},function(_0x33b22e){const _0x403b97=_0x1cc520;if(_0x33b22e)logger[_0x403b97(0x270)](_0x33b22e);});else(_0x570a73==_0x1cc520(0x342)||_0x570a73=='new-disabled')&&(logger[_0x1cc520(0x270)](_0x1cc520(0x273)+_0x527458),stopBot(_0x527458));config=getConfiguration(),io['to'](_0x1cc520(0x331))[_0x1cc520(0x261)]('bots',config),broadcastToBots(_0x1cc520(0x186),JSON[_0x1cc520(0x254)](config));}function toggleStatus(_0x2caf0a){const _0x41611b=_0x286343;let _0x181661=dbConfig[_0x41611b(0x214)]('bots')['find']({'botID':_0x2caf0a})[_0x41611b(0x329)](),_0x283077;if(_0x181661[_0x41611b(0x1ac)]===_0x41611b(0x33c))_0x283077='disabled';else{if(_0x181661[_0x41611b(0x1ac)]===_0x41611b(0x269))_0x283077=_0x41611b(0x308);else{if(_0x181661[_0x41611b(0x1ac)]===_0x41611b(0x308))_0x283077=_0x41611b(0x269);else{if(_0x181661['status']===_0x41611b(0x342))_0x283077=_0x41611b(0x33c);}}}return _0x283077;}function updateStatus(_0x26531a,_0x121e26){const _0x449712=_0x286343;dbConfig[_0x449712(0x214)](_0x449712(0x186))['find']({'botID':_0x26531a})[_0x449712(0x22c)]({'status':_0x121e26})[_0x449712(0x2d6)](),config=getConfiguration(),io['to']('botmanager')[_0x449712(0x261)](_0x449712(0x186),config),broadcastToBots(_0x449712(0x186),JSON[_0x449712(0x254)](config));}function updateLive(_0x5a0667,_0x142fb5){const _0x8e1484=_0x286343;dbConfig[_0x8e1484(0x214)]('bots')[_0x8e1484(0x265)]({'botID':_0x5a0667})[_0x8e1484(0x22c)]({'live':_0x142fb5})[_0x8e1484(0x2d6)](),config=getConfiguration(),io['to'](_0x8e1484(0x331))['emit'](_0x8e1484(0x186),config),broadcastToBots(_0x8e1484(0x186),JSON['stringify'](config));}function updateBotName(_0x5c90fe,_0x17e637){const _0x5e5212=_0x286343;dbConfig[_0x5e5212(0x214)](_0x5e5212(0x186))[_0x5e5212(0x265)]({'botID':_0x5c90fe})[_0x5e5212(0x22c)]({'botname':_0x17e637})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x5e5212(0x261)]('bots',config),broadcastToBots(_0x5e5212(0x186),JSON[_0x5e5212(0x254)](config));}function updateBotManager(){const _0x14f19f=_0x286343;config=getConfiguration(),io['to'](_0x14f19f(0x331))['emit'](_0x14f19f(0x186),config),broadcastToBots(_0x14f19f(0x186),JSON[_0x14f19f(0x254)](config));}function toggleBotMode(_0x16a13d){const _0x3396fb=_0x286343;if(pid[_0x16a13d])pid[_0x16a13d][_0x3396fb(0x1f8)]({'function':'toggleBotMode','args':null});else{const _0x45238c=configpath+'bot-'+_0x16a13d+_0x3396fb(0x197),_0x47c4c5=fs[_0x3396fb(0x287)](_0x45238c),_0x225f35=JSON[_0x3396fb(0x1eb)](_0x47c4c5),_0x399730=_0x225f35['bot'][0x0][_0x3396fb(0x1ee)];_0x225f35[_0x3396fb(0x2ca)][0x0][_0x3396fb(0x1ee)]=!_0x399730;const _0x3edef1=JSON[_0x3396fb(0x254)](_0x225f35,null,0x2);fs['writeFileSync'](_0x45238c,_0x3edef1),config=getConfiguration(),io['to']('botmanager')[_0x3396fb(0x261)]('bots',config),broadcastToBots('bots',JSON[_0x3396fb(0x254)](config));}}function telegramError(_0x28f65a){const _0x3fb2ae=_0x286343;logger[_0x3fb2ae(0x305)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x428d10){const _0x86edf2=_0x286343;if(_0x428d10['from'][_0x86edf2(0x1d4)]!=settings['telegramUsername']&&'@'+_0x428d10[_0x86edf2(0x299)][_0x86edf2(0x1d4)]!=settings[_0x86edf2(0x253)])return tgBot[_0x86edf2(0x1f7)](_0x428d10[_0x86edf2(0x1a1)]['id'],_0x86edf2(0x2b3),{'parse_mode':_0x86edf2(0x28a)})[_0x86edf2(0x2b9)](_0x215b7d=>{telegramError(_0x215b7d);}),![];return!![];}async function initTelegram(){const _0x2df1c4=_0x286343;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2df1c4(0x2c0)],{'polling':!![]});let _0x21e3ae=_0x2df1c4(0x24e);_0x21e3ae+='\x0a',_0x21e3ae+=_0x2df1c4(0x1fb),_0x21e3ae+=_0x2df1c4(0x1cb),_0x21e3ae+=_0x2df1c4(0x239),_0x21e3ae+=_0x2df1c4(0x341),_0x21e3ae+=_0x2df1c4(0x303),_0x21e3ae+=_0x2df1c4(0x1c5),_0x21e3ae+=_0x2df1c4(0x312),_0x21e3ae+=_0x2df1c4(0x1d1),_0x21e3ae+=_0x2df1c4(0x28c),_0x21e3ae+=_0x2df1c4(0x23f),_0x21e3ae+=_0x2df1c4(0x2bd),_0x21e3ae+=_0x2df1c4(0x340),_0x21e3ae+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x21e3ae+=_0x2df1c4(0x228);let _0x123080=_0x2df1c4(0x289);_0x123080+='\x0a',_0x123080+=_0x21e3ae,tgBot['onText'](/\/start/,_0x382fa5=>{const _0x52a85e=_0x2df1c4;if(!validateTelegram(_0x382fa5))return;if(settings[_0x52a85e(0x1dc)]!=_0x382fa5[_0x52a85e(0x1a1)]['id'])updateSetting(_0x52a85e(0x1dc),_0x382fa5[_0x52a85e(0x1a1)]['id']);updateSetting(_0x52a85e(0x20c),!![]),tgBot['sendMessage'](_0x382fa5['chat']['id'],_0x123080)[_0x52a85e(0x2b9)](_0x450f7b=>{telegramError(_0x450f7b);});}),tgBot[_0x2df1c4(0x297)](/\/enable/,_0x500031=>{const _0x49b177=_0x2df1c4;if(!validateTelegram(_0x500031))return;if(settings[_0x49b177(0x1dc)]!=_0x500031[_0x49b177(0x1a1)]['id'])updateSetting(_0x49b177(0x1dc),_0x500031[_0x49b177(0x1a1)]['id']);updateSetting(_0x49b177(0x20c),!![]),tgBot[_0x49b177(0x1f7)](_0x500031[_0x49b177(0x1a1)]['id'],_0x49b177(0x2aa))[_0x49b177(0x2b9)](_0x92e3fc=>{telegramError(_0x92e3fc);});}),tgBot[_0x2df1c4(0x297)](/\/config/,async _0x168e44=>{const _0x47409a=_0x2df1c4;if(!validateTelegram(_0x168e44))return;tgBot[_0x47409a(0x330)](_0x47409a(0x2c5)),tgBot[_0x47409a(0x1f7)](_0x168e44[_0x47409a(0x1a1)]['id'],_0x47409a(0x23b),{'reply_markup':{'inline_keyboard':[[{'text':_0x47409a(0x1ab),'callback_data':_0x47409a(0x1b4)},{'text':_0x47409a(0x246),'callback_data':_0x47409a(0x23d)},{'text':'All','callback_data':_0x47409a(0x26c)}]]}})['catch'](_0x359539=>{telegramError(_0x359539);}),tgBot['on'](_0x47409a(0x2c5),async _0x57b37d=>{const _0x59c676=_0x47409a,_0x1b65f0=_0x57b37d[_0x59c676(0x324)],_0x143ff0=_0x57b37d[_0x59c676(0x2ee)];tgBot[_0x59c676(0x2be)](_0x57b37d['id'])[_0x59c676(0x2a3)](async()=>{const _0x25a249=_0x59c676;_0x1b65f0==_0x25a249(0x1b4)&&(updateSetting(_0x25a249(0x1d9),_0x25a249(0x1b4)),updateSetting(_0x25a249(0x20c),!![]),await tgBot[_0x25a249(0x1f7)](_0x143ff0[_0x25a249(0x1a1)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x25a249(0x2b9)](_0x3eb502=>{telegramError(_0x3eb502);}));_0x1b65f0=='alerts'&&(updateSetting(_0x25a249(0x1d9),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x25a249(0x1f7)](_0x143ff0['chat']['id'],_0x25a249(0x2b1))[_0x25a249(0x2b9)](_0x48a929=>{telegramError(_0x48a929);}));_0x1b65f0==_0x25a249(0x26c)&&(updateSetting(_0x25a249(0x1d9),_0x25a249(0x26c)),updateSetting('telegramEnabled',!![]),await tgBot[_0x25a249(0x1f7)](_0x143ff0['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x25a249(0x2b9)](_0x408a29=>{telegramError(_0x408a29);}));if(!settings[_0x25a249(0x1dc)])tgBot[_0x25a249(0x1f7)](_0x143ff0[_0x25a249(0x1a1)]['id'],_0x25a249(0x2e1))['catch'](_0x4a9f10=>{telegramError(_0x4a9f10);});}),tgBot['removeListener'](_0x59c676(0x2c5));});}),tgBot[_0x2df1c4(0x297)](/\/status/,_0x3e46cc=>{const _0x9a8ca3=_0x2df1c4;if(!validateTelegram(_0x3e46cc))return;const _0x50678e=getBotsWithMode();let _0x2bae55=_0x9a8ca3(0x26d);config[_0x9a8ca3(0x262)](_0x28c8b9=>{const _0x4a8f44=_0x9a8ca3,_0x9172bb=_0x50678e['find'](_0x50e5d4=>_0x50e5d4['botID']==_0x28c8b9['botID'])[_0x4a8f44(0x1d0)];_0x2bae55+=_0x4a8f44(0x275)+_0x28c8b9[_0x4a8f44(0x201)]+':\x20'+_0x28c8b9[_0x4a8f44(0x1ac)]+_0x4a8f44(0x295)+_0x9172bb+_0x4a8f44(0x295)+_0x28c8b9[_0x4a8f44(0x2c9)]+'\x0a';}),_0x2bae55+='\x0a',_0x2bae55+=_0x9a8ca3(0x267),_0x2bae55+=!settings[_0x9a8ca3(0x20c)]?_0x9a8ca3(0x1cd):_0x9a8ca3(0x2d5),_0x2bae55+=settings[_0x9a8ca3(0x20c)]?settings[_0x9a8ca3(0x1d9)]==_0x9a8ca3(0x26c)?_0x9a8ca3(0x2d9):_0x9a8ca3(0x284)+settings['telegramEvents']+_0x9a8ca3(0x202):'',tgBot['sendMessage'](_0x3e46cc['chat']['id'],_0x2bae55,{'parse_mode':_0x9a8ca3(0x28a)})['catch'](_0x541149=>{telegramError(_0x541149);});}),tgBot[_0x2df1c4(0x297)](/\/restart/,_0x2d4920=>{const _0x456df5=_0x2df1c4;if(!validateTelegram(_0x2d4920))return;tgBot[_0x456df5(0x330)]('callback_query');const _0x2d83d7=getEnabledBots();if(_0x2d83d7[_0x456df5(0x20e)]==0x0)tgBot[_0x456df5(0x1f7)](_0x2d4920[_0x456df5(0x1a1)]['id'],_0x456df5(0x32c))[_0x456df5(0x2b9)](_0x52f049=>{telegramError(_0x52f049);});else{if(_0x2d83d7[_0x456df5(0x20e)]>0x1)_0x2d83d7['push']({'botID':_0x456df5(0x26c)});let _0x465809=[],_0x192976=[];const _0x4fea03=_0x2d83d7[_0x456df5(0x20e)]%0x4==0x0||_0x2d83d7['length']%0x4==0x3||_0x2d83d7[_0x456df5(0x20e)]%0x3==0x1?0x4:0x3;let _0x3c2278=0x0;_0x2d83d7[_0x456df5(0x262)]((_0x171eb7,_0x200d79)=>{const _0x1737f9=_0x456df5;if(_0x200d79%_0x4fea03==0x0)_0x192976=[];_0x192976[_0x1737f9(0x187)]({'text':_0x171eb7[_0x1737f9(0x201)]==_0x1737f9(0x26c)?'All\x20bots':_0x1737f9(0x275)+_0x171eb7['botID'],'callback_data':_0x171eb7['botID']}),_0x200d79%_0x4fea03==0x0&&(_0x465809[_0x3c2278]=_0x192976,_0x3c2278++);}),tgBot[_0x456df5(0x1f7)](_0x2d4920[_0x456df5(0x1a1)]['id'],_0x456df5(0x2c3),{'reply_markup':{'inline_keyboard':_0x465809}})[_0x456df5(0x2b9)](_0x593913=>{telegramError(_0x593913);}),tgBot['on'](_0x456df5(0x2c5),async _0x3a758f=>{const _0x2620e4=_0x456df5,_0x52e1fa=_0x3a758f['data'],_0x77c6a9=_0x3a758f[_0x2620e4(0x2ee)];tgBot[_0x2620e4(0x2be)](_0x3a758f['id'])[_0x2620e4(0x2a3)](async()=>{const _0x11a7c4=_0x2620e4;_0x52e1fa=='all'?config[_0x11a7c4(0x262)](_0x11f961=>{const _0x340c77=_0x11a7c4;restartBot(_0x11f961[_0x340c77(0x201)]);}):restartBot(_0x52e1fa);}),tgBot[_0x2620e4(0x330)](_0x2620e4(0x2c5));});}}),tgBot[_0x2df1c4(0x297)](/\/on/,_0x2785bf=>{const _0x5170cf=_0x2df1c4;if(!validateTelegram(_0x2785bf))return;tgBot[_0x5170cf(0x330)](_0x5170cf(0x2c5));const _0x42e428=getDisabledBots();if(_0x42e428[_0x5170cf(0x20e)]==0x0)tgBot[_0x5170cf(0x1f7)](_0x2785bf[_0x5170cf(0x1a1)]['id'],_0x5170cf(0x19e))[_0x5170cf(0x2b9)](_0x19722b=>{telegramError(_0x19722b);});else{if(_0x42e428['length']>0x1)_0x42e428[_0x5170cf(0x187)]({'botID':'all'});let _0x16947f=[],_0x3a195c=[];const _0x3526bb=_0x42e428[_0x5170cf(0x20e)]%0x4==0x0||_0x42e428[_0x5170cf(0x20e)]%0x4==0x3||_0x42e428[_0x5170cf(0x20e)]%0x3==0x1?0x4:0x3;let _0x92be4f=0x0;_0x42e428['forEach']((_0x23f1f8,_0x12387d)=>{const _0x3bc038=_0x5170cf;if(_0x12387d%_0x3526bb==0x0)_0x3a195c=[];_0x3a195c[_0x3bc038(0x187)]({'text':_0x23f1f8[_0x3bc038(0x201)]=='all'?_0x3bc038(0x2f0):_0x3bc038(0x275)+_0x23f1f8[_0x3bc038(0x201)],'callback_data':_0x23f1f8[_0x3bc038(0x201)]}),_0x12387d%_0x3526bb==0x0&&(_0x16947f[_0x92be4f]=_0x3a195c,_0x92be4f++);}),tgBot[_0x5170cf(0x1f7)](_0x2785bf[_0x5170cf(0x1a1)]['id'],_0x5170cf(0x17e),{'reply_markup':{'inline_keyboard':_0x16947f}})[_0x5170cf(0x2b9)](_0x22699f=>{telegramError(_0x22699f);}),tgBot['on'](_0x5170cf(0x2c5),async _0x39effd=>{const _0x5b5ff0=_0x5170cf,_0x3d7fde=_0x39effd[_0x5b5ff0(0x324)],_0x114d0a=_0x39effd['message'];tgBot[_0x5b5ff0(0x2be)](_0x39effd['id'])['then'](async()=>{const _0x26967c=_0x5b5ff0;_0x3d7fde==_0x26967c(0x26c)?(tgBot[_0x26967c(0x1f7)](_0x114d0a[_0x26967c(0x1a1)]['id'],_0x26967c(0x1e7))['catch'](_0x47115f=>{telegramError(_0x47115f);}),_0x42e428['forEach'](_0x1a321b=>{const _0x58d47e=_0x26967c;if(_0x1a321b[_0x58d47e(0x201)]!=_0x58d47e(0x26c))toggleBot(_0x1a321b[_0x58d47e(0x201)],toggleStatus(_0x1a321b[_0x58d47e(0x201)]),_0x58d47e(0x2cd));})):(tgBot[_0x26967c(0x1f7)](_0x114d0a[_0x26967c(0x1a1)]['id'],_0x26967c(0x2de)+_0x3d7fde)['catch'](_0x390ec5=>{telegramError(_0x390ec5);}),toggleBot(_0x3d7fde,toggleStatus(_0x3d7fde),_0x26967c(0x2cd)));}),tgBot[_0x5b5ff0(0x330)](_0x5b5ff0(0x2c5));});}}),tgBot['onText'](/\/off/,_0x1acb56=>{const _0x590de7=_0x2df1c4;if(!validateTelegram(_0x1acb56))return;tgBot[_0x590de7(0x330)](_0x590de7(0x2c5));const _0x318b06=getEnabledBots();if(_0x318b06[_0x590de7(0x20e)]==0x0)tgBot['sendMessage'](_0x1acb56[_0x590de7(0x1a1)]['id'],_0x590de7(0x32c))[_0x590de7(0x2b9)](_0x598011=>{telegramError(_0x598011);});else{if(_0x318b06[_0x590de7(0x20e)]>0x1)_0x318b06[_0x590de7(0x187)]({'botID':_0x590de7(0x26c)});let _0x2f815b=[],_0x5089d9=[];const _0x4af32d=_0x318b06['length']%0x4==0x0||_0x318b06[_0x590de7(0x20e)]%0x4==0x3||_0x318b06[_0x590de7(0x20e)]%0x3==0x1?0x4:0x3;let _0x22c8a2=0x0;_0x318b06[_0x590de7(0x262)]((_0x2a0ca3,_0x14c354)=>{const _0x37c852=_0x590de7;if(_0x14c354%_0x4af32d==0x0)_0x5089d9=[];_0x5089d9[_0x37c852(0x187)]({'text':_0x2a0ca3[_0x37c852(0x201)]==_0x37c852(0x26c)?'All\x20bots':'Bot\x20'+_0x2a0ca3['botID'],'callback_data':_0x2a0ca3[_0x37c852(0x201)]}),_0x14c354%_0x4af32d==0x0&&(_0x2f815b[_0x22c8a2]=_0x5089d9,_0x22c8a2++);}),tgBot['sendMessage'](_0x1acb56['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x2f815b}})[_0x590de7(0x2b9)](_0x152f48=>{telegramError(_0x152f48);}),tgBot['on']('callback_query',async _0x23da3c=>{const _0x40dc4c=_0x590de7,_0x4302a5=_0x23da3c[_0x40dc4c(0x324)],_0x571c7f=_0x23da3c[_0x40dc4c(0x2ee)];tgBot['answerCallbackQuery'](_0x23da3c['id'])[_0x40dc4c(0x2a3)](async()=>{const _0xa19d0f=_0x40dc4c;_0x4302a5==_0xa19d0f(0x26c)?(tgBot[_0xa19d0f(0x1f7)](_0x571c7f[_0xa19d0f(0x1a1)]['id'],_0xa19d0f(0x310))[_0xa19d0f(0x2b9)](_0x768af5=>{telegramError(_0x768af5);}),_0x318b06[_0xa19d0f(0x262)](_0x22ac83=>{const _0x2c3507=_0xa19d0f;if(_0x22ac83[_0x2c3507(0x201)]!='all')toggleBot(_0x22ac83[_0x2c3507(0x201)],toggleStatus(_0x22ac83[_0x2c3507(0x201)]),'stopped');})):(tgBot[_0xa19d0f(0x1f7)](_0x571c7f[_0xa19d0f(0x1a1)]['id'],_0xa19d0f(0x1a8)+_0x4302a5)[_0xa19d0f(0x2b9)](_0x76c16=>{telegramError(_0x76c16);}),toggleBot(_0x4302a5,toggleStatus(_0x4302a5),_0xa19d0f(0x2cd)));}),tgBot[_0x40dc4c(0x330)](_0x40dc4c(0x2c5));});}}),tgBot['onText'](/\/metrics/,_0x13c5fe=>{const _0x6111f1=_0x2df1c4;if(!validateTelegram(_0x13c5fe))return;tgBot['removeListener'](_0x6111f1(0x2c5));const _0x3e40ed=getEnabledBots();if(_0x3e40ed[_0x6111f1(0x20e)]==0x0)tgBot[_0x6111f1(0x1f7)](_0x13c5fe[_0x6111f1(0x1a1)]['id'],_0x6111f1(0x32c))['catch'](_0x506dd1=>{telegramError(_0x506dd1);});else{if(_0x3e40ed['length']>0x1){let _0x39232c=[],_0x3508f2=[];const _0x326943=_0x3e40ed['length']%0x4==0x0||_0x3e40ed[_0x6111f1(0x20e)]%0x4==0x3||_0x3e40ed[_0x6111f1(0x20e)]%0x3==0x1?0x4:0x3;let _0x472ca2=0x0;_0x3e40ed['forEach']((_0x37b028,_0x2e1968)=>{const _0x1fef97=_0x6111f1;if(_0x2e1968%_0x326943==0x0)_0x3508f2=[];_0x3508f2[_0x1fef97(0x187)]({'text':_0x1fef97(0x275)+_0x37b028[_0x1fef97(0x201)],'callback_data':_0x37b028[_0x1fef97(0x201)]}),_0x2e1968%_0x326943==0x0&&(_0x39232c[_0x472ca2]=_0x3508f2,_0x472ca2++);}),tgBot['sendMessage'](_0x13c5fe[_0x6111f1(0x1a1)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x39232c}})[_0x6111f1(0x2b9)](_0x18e381=>{telegramError(_0x18e381);}),tgBot['on'](_0x6111f1(0x2c5),async _0x5b5963=>{const _0x16bd88=_0x6111f1,_0x28673b=_0x5b5963[_0x16bd88(0x324)],_0x5d2102=_0x5b5963[_0x16bd88(0x2ee)];tgBot[_0x16bd88(0x2be)](_0x5b5963['id'])[_0x16bd88(0x2a3)](async()=>{const _0x558d06=_0x16bd88;if(pid[_0x28673b])pid[_0x28673b][_0x558d06(0x1f8)]({'function':_0x558d06(0x1da),'args':null});}),tgBot[_0x16bd88(0x330)](_0x16bd88(0x2c5));});}else{const _0x36c5fe=_0x3e40ed[0x0][_0x6111f1(0x201)];if(pid[_0x36c5fe])pid[_0x36c5fe][_0x6111f1(0x1f8)]({'function':_0x6111f1(0x1da),'args':null});}}}),tgBot[_0x2df1c4(0x297)](/\/portfolio/,_0xa2d358=>{const _0x28a185=_0x2df1c4;if(!validateTelegram(_0xa2d358))return;tgBot[_0x28a185(0x330)](_0x28a185(0x2c5));const _0x533ad0=getEnabledBots();if(_0x533ad0[_0x28a185(0x20e)]==0x0)tgBot[_0x28a185(0x1f7)](_0xa2d358[_0x28a185(0x1a1)]['id'],_0x28a185(0x32c))[_0x28a185(0x2b9)](_0x21ca2c=>{telegramError(_0x21ca2c);});else{if(_0x533ad0[_0x28a185(0x20e)]>0x1){let _0x53569b=[],_0x8ae44=[];const _0x594439=_0x533ad0['length']%0x4==0x0||_0x533ad0[_0x28a185(0x20e)]%0x4==0x3||_0x533ad0[_0x28a185(0x20e)]%0x3==0x1?0x4:0x3;let _0x3722a5=0x0;_0x533ad0[_0x28a185(0x262)]((_0x1b440c,_0x590e41)=>{const _0x4eae80=_0x28a185;if(_0x590e41%_0x594439==0x0)_0x8ae44=[];_0x8ae44[_0x4eae80(0x187)]({'text':'Bot\x20'+_0x1b440c[_0x4eae80(0x201)],'callback_data':_0x1b440c[_0x4eae80(0x201)]}),_0x590e41%_0x594439==0x0&&(_0x53569b[_0x3722a5]=_0x8ae44,_0x3722a5++);}),tgBot[_0x28a185(0x1f7)](_0xa2d358[_0x28a185(0x1a1)]['id'],_0x28a185(0x19c),{'reply_markup':{'inline_keyboard':_0x53569b}})[_0x28a185(0x2b9)](_0x21712e=>{telegramError(_0x21712e);}),tgBot['on']('callback_query',async _0xda978d=>{const _0x35e944=_0x28a185,_0x372ea4=_0xda978d[_0x35e944(0x324)],_0x49210d=_0xda978d[_0x35e944(0x2ee)];tgBot[_0x35e944(0x2be)](_0xda978d['id'])['then'](async()=>{const _0x4f51c5=_0x35e944;if(pid[_0x372ea4])pid[_0x372ea4][_0x4f51c5(0x1f8)]({'function':_0x4f51c5(0x1cf),'args':null});}),tgBot[_0x35e944(0x330)](_0x35e944(0x2c5));});}else{const _0x3a9b52=_0x533ad0[0x0][_0x28a185(0x201)];if(pid[_0x3a9b52])pid[_0x3a9b52][_0x28a185(0x1f8)]({'function':_0x28a185(0x1cf),'args':null});}}}),tgBot[_0x2df1c4(0x297)](/\/update/,async _0x2275e3=>{const _0x107cc4=_0x2df1c4;if(!validateTelegram(_0x2275e3))return;tgBot[_0x107cc4(0x330)](_0x107cc4(0x2c5)),await getMessages();if(!updateAvailable)tgBot[_0x107cc4(0x1f7)](_0x2275e3['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x107cc4(0x2b9)](_0x1da315=>{telegramError(_0x1da315);});else!validInstallation?tgBot[_0x107cc4(0x1f7)](_0x2275e3['chat']['id'],_0x107cc4(0x2eb))['catch'](_0x3cb335=>{telegramError(_0x3cb335);}):(tgBot[_0x107cc4(0x1f7)](_0x2275e3['chat']['id'],_0x107cc4(0x178),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x107cc4(0x32f)},{'text':'No','callback_data':'no'}]]}})[_0x107cc4(0x2b9)](_0x1155d3=>{telegramError(_0x1155d3);}),tgBot['on'](_0x107cc4(0x2c5),async _0x5a67a5=>{const _0x33518a=_0x107cc4,_0x276da2=_0x5a67a5[_0x33518a(0x324)],_0x1c6dd3=_0x5a67a5[_0x33518a(0x2ee)];tgBot[_0x33518a(0x2be)](_0x5a67a5['id'])[_0x33518a(0x2a3)](async()=>{const _0x46047c=_0x33518a;_0x276da2=='yes'&&(await tgBot[_0x46047c(0x1f7)](_0x1c6dd3['chat']['id'],_0x46047c(0x185))['catch'](_0x460e87=>{telegramError(_0x460e87);}),updateBB(_0x46047c(0x1f0))),_0x276da2=='no'&&await tgBot[_0x46047c(0x1f7)](_0x1c6dd3['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x46047c(0x2b9)](_0x1b622e=>{telegramError(_0x1b622e);});}),tgBot['removeListener'](_0x33518a(0x2c5));}));}),tgBot[_0x2df1c4(0x297)](/\/reinstall/,async _0x5c9cf0=>{const _0x3c344a=_0x2df1c4;if(!validateTelegram(_0x5c9cf0))return;tgBot[_0x3c344a(0x330)](_0x3c344a(0x2c5)),!validInstallation?tgBot['sendMessage'](_0x5c9cf0[_0x3c344a(0x1a1)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')['catch'](_0x44b323=>{telegramError(_0x44b323);}):(tgBot[_0x3c344a(0x1f7)](_0x5c9cf0[_0x3c344a(0x1a1)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x3c344a(0x32f)},{'text':'No','callback_data':'no'}]]}})[_0x3c344a(0x2b9)](_0x5a54cf=>{telegramError(_0x5a54cf);}),tgBot['on'](_0x3c344a(0x2c5),async _0x292ab1=>{const _0x3624c7=_0x3c344a,_0x58a5b8=_0x292ab1[_0x3624c7(0x324)],_0x314969=_0x292ab1[_0x3624c7(0x2ee)];tgBot['answerCallbackQuery'](_0x292ab1['id'])['then'](async()=>{const _0x4e629e=_0x3624c7;_0x58a5b8==_0x4e629e(0x32f)&&(await tgBot[_0x4e629e(0x1f7)](_0x314969[_0x4e629e(0x1a1)]['id'],_0x4e629e(0x2da))[_0x4e629e(0x2b9)](_0x193c61=>{telegramError(_0x193c61);}),updateBB(_0x4e629e(0x1e2))),_0x58a5b8=='no'&&await tgBot[_0x4e629e(0x1f7)](_0x314969[_0x4e629e(0x1a1)]['id'],_0x4e629e(0x1e1))[_0x4e629e(0x2b9)](_0x509b7b=>{telegramError(_0x509b7b);});}),tgBot[_0x3624c7(0x330)](_0x3624c7(0x2c5));}));}),tgBot[_0x2df1c4(0x297)](/\/toggle/,_0x2c82c8=>{const _0x5c692d=_0x2df1c4;if(!validateTelegram(_0x2c82c8))return;tgBot[_0x5c692d(0x330)](_0x5c692d(0x2c5));const _0x12efc6=getBotsWithMode();if(_0x12efc6['length']==0x0)tgBot[_0x5c692d(0x1f7)](_0x2c82c8[_0x5c692d(0x1a1)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x49a162=>{telegramError(_0x49a162);});else{let _0x299ac5=[],_0xc54fbf=[];const _0xa62f0c=0x2;let _0x1183bd=0x0;_0x12efc6[_0x5c692d(0x262)]((_0x28d907,_0x10e203)=>{const _0x329ceb=_0x5c692d;if(_0x10e203%_0xa62f0c==0x0)_0xc54fbf=[];_0xc54fbf['push']({'text':_0x329ceb(0x275)+_0x28d907[_0x329ceb(0x201)]+'\x20('+_0x28d907[_0x329ceb(0x1d0)]+')','callback_data':_0x28d907[_0x329ceb(0x201)]}),_0x10e203%_0xa62f0c==0x0&&(_0x299ac5[_0x1183bd]=_0xc54fbf,_0x1183bd++);}),tgBot['sendMessage'](_0x2c82c8[_0x5c692d(0x1a1)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x299ac5}})[_0x5c692d(0x2b9)](_0x19e90d=>{telegramError(_0x19e90d);}),tgBot['on']('callback_query',async _0x43edb1=>{const _0x48da55=_0x5c692d,_0x4df7de=_0x43edb1[_0x48da55(0x324)],_0x1ecf07=_0x43edb1[_0x48da55(0x2ee)];tgBot[_0x48da55(0x2be)](_0x43edb1['id'])[_0x48da55(0x2a3)](async()=>{const _0x1cf16d=_0x48da55,_0x218be2=_0x12efc6[_0x1cf16d(0x265)](_0x35ede9=>_0x35ede9[_0x1cf16d(0x201)]==_0x4df7de),_0x76edf2=_0x218be2[_0x1cf16d(0x1d0)]==_0x1cf16d(0x29e)?_0x1cf16d(0x279):'auto';tgBot[_0x1cf16d(0x1f7)](_0x1ecf07['chat']['id'],_0x1cf16d(0x18b)+_0x4df7de+'\x20to\x20'+_0x76edf2+_0x1cf16d(0x1e8))['catch'](_0x1902e7=>{telegramError(_0x1902e7);}),toggleBotMode(_0x4df7de);}),tgBot[_0x48da55(0x330)](_0x48da55(0x2c5));});}}),tgBot['onText'](/\/names/,_0xec7c94=>{const _0x33e67d=_0x2df1c4;if(!validateTelegram(_0xec7c94))return;let _0x2409d3='';config[_0x33e67d(0x262)](_0xc31482=>{const _0xaff1b0=_0x33e67d;_0x2409d3+=_0xaff1b0(0x275)+_0xc31482[_0xaff1b0(0x201)]+':\x20'+_0xc31482['botname']+'\x0a';}),tgBot[_0x33e67d(0x1f7)](_0xec7c94[_0x33e67d(0x1a1)]['id'],_0x2409d3,{'parse_mode':_0x33e67d(0x28a)})[_0x33e67d(0x2b9)](_0x1183f2=>{telegramError(_0x1183f2);});}),tgBot[_0x2df1c4(0x297)](/\/disable/,_0x5b8723=>{const _0x15dc3e=_0x2df1c4;if(!validateTelegram(_0x5b8723))return;tgBot[_0x15dc3e(0x1f7)](_0x5b8723[_0x15dc3e(0x1a1)]['id'],'Notifications\x20disabled')[_0x15dc3e(0x2b9)](_0xe02832=>{telegramError(_0xe02832);}),updateSetting(_0x15dc3e(0x20c),![]);}),tgBot['onText'](/\/help/,_0x4566f8=>{const _0x1d29ca=_0x2df1c4;if(!validateTelegram(_0x4566f8))return;tgBot['sendMessage'](_0x4566f8['chat']['id'],_0x21e3ae)[_0x1d29ca(0x2b9)](_0x2f5c69=>{telegramError(_0x2f5c69);});}),tgBot['on'](_0x2df1c4(0x2b5),_0x3b4461=>{const _0x275b64=_0x2df1c4;_0x3b4461[_0x275b64(0x18c)]()['includes'](_0x275b64(0x1e0))&&(logger[_0x275b64(0x270)]('Invalid\x20Telegram\x20token'),tgBot[_0x275b64(0x1ed)](),tgBot=null,io['to'](_0x275b64(0x331))[_0x275b64(0x261)](_0x275b64(0x313),_0x275b64(0x26b)));}),process['once']('SIGINT',()=>{const _0xb733ee=_0x2df1c4;if(tgBot)tgBot[_0xb733ee(0x1ed)]();process['exit'](0x1);}),process[_0x2df1c4(0x19a)](_0x2df1c4(0x192),()=>{const _0x5b885c=_0x2df1c4;if(tgBot)tgBot[_0x5b885c(0x1ed)]();process['exit'](0x1);});}}function disableTelegram(){const _0x7bfaf7=_0x286343;tgBot&&(tgBot[_0x7bfaf7(0x1ed)](),tgBot=null);}function sendTelegram(_0x46896e,_0x5cf140){const _0x43c544=_0x286343;if(settings[_0x43c544(0x20c)]){if(settings[_0x43c544(0x1d9)]==_0x43c544(0x26c)||(_0x5cf140['type']=='error'||_0x5cf140[_0x43c544(0x1d2)]=='warning'||_0x5cf140[_0x43c544(0x1d2)]==_0x43c544(0x292))&&settings[_0x43c544(0x1d9)]==_0x43c544(0x23d)||_0x5cf140[_0x43c544(0x1d2)]=='order'&&settings[_0x43c544(0x1d9)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x5cf140[_0x43c544(0x2fa)])tgBot[_0x43c544(0x1f7)](settings[_0x43c544(0x1dc)],_0x5cf140[_0x43c544(0x2e3)]+_0x43c544(0x2c2)+_0x5cf140[_0x43c544(0x215)])[_0x43c544(0x2b9)](_0x43aec6=>{telegramError(_0x43aec6);});else tgBot[_0x43c544(0x1f7)](settings['telegramChatId'],_0x43c544(0x275)+_0x46896e+_0x43c544(0x2c2)+_0x5cf140[_0x43c544(0x215)])[_0x43c544(0x2b9)](_0x47acbe=>{telegramError(_0x47acbe);});}}}}async function sendTelegramMsg(_0x4b5759,_0x2f4048='HTML'){const _0xdc857e=_0x286343;return settings[_0xdc857e(0x20c)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0xdc857e(0x1f7)](settings[_0xdc857e(0x1dc)],_0x4b5759,{'parse_mode':_0x2f4048})[_0xdc857e(0x2b9)](_0x4e4746=>{telegramError(_0x4e4746);}),!![]):![];}function getDeviceWithIp(_0x52ec25){const _0x21df20=_0x286343;return devices[_0x21df20(0x265)](_0xd528fa=>_0xd528fa['ip']===_0x52ec25);}function temporaryAccess2FA(_0x4240cc,_0x130eae){const _0x35eebc=_0x286343;let _0x426cac=new Date(),_0x1e0bf9=![];if(lastIpApproval){if(_0x426cac-lastIpApproval<0x1388)_0x1e0bf9=!![];}lastIpApproval=new Date();if(_0x1e0bf9)return;tgBot&&settings[_0x35eebc(0x1dc)]&&(tgBot[_0x35eebc(0x330)](_0x35eebc(0x2c5)),tgBot[_0x35eebc(0x1f7)](settings[_0x35eebc(0x1dc)],_0x35eebc(0x1aa)+normalizeIP(_0x130eae)[_0x35eebc(0x2f5)]+_0x35eebc(0x21e),{'parse_mode':_0x35eebc(0x28a),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x35eebc(0x31d),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x35eebc(0x1b0),'callback_data':_0x35eebc(0x1b0)}]]}})['catch'](_0x1995a5=>{telegramError(_0x1995a5);}),tgBot['on'](_0x35eebc(0x2c5),async _0x2c9e81=>{const _0x2574a8=_0x35eebc,_0x421800=_0x2c9e81[_0x2574a8(0x324)],_0x248c43=_0x2c9e81[_0x2574a8(0x2ee)];tgBot[_0x2574a8(0x2be)](_0x2c9e81['id'])[_0x2574a8(0x2a3)](async()=>{const _0x2e9f51=_0x2574a8;devices[_0x4240cc][_0x2e9f51(0x328)]={'clientip':_0x130eae,'timestamp':new Date()['getTime'](),'expiry':_0x421800},_0x421800!='reject'?(await tgBot[_0x2e9f51(0x1f7)](_0x248c43['chat']['id'],_0x2e9f51(0x237)+_0x421800+_0x2e9f51(0x31e),{'parse_mode':_0x2e9f51(0x28a)})[_0x2e9f51(0x2b9)](_0x549a56=>{telegramError(_0x549a56);}),io['to'](_0x4240cc)[_0x2e9f51(0x261)]('status',{'access':{'allow':![],'reason':_0x2e9f51(0x213),'token':null}})):(await tgBot[_0x2e9f51(0x1f7)](_0x248c43[_0x2e9f51(0x1a1)]['id'],_0x2e9f51(0x29a))[_0x2e9f51(0x2b9)](_0x4127c2=>{telegramError(_0x4127c2);}),io['to'](_0x4240cc)[_0x2e9f51(0x261)]('status',{'access':{'allow':![],'reason':_0x2e9f51(0x1bd),'token':null}}));}),tgBot[_0x2574a8(0x330)](_0x2574a8(0x2c5));}));}function loginAccess2FA(_0x1e7e6e,_0x1822f9){const _0x5ae8c3=_0x286343;tgBot&&settings[_0x5ae8c3(0x1dc)]&&(tgBot[_0x5ae8c3(0x330)]('callback_query'),tgBot['sendMessage'](settings[_0x5ae8c3(0x1dc)],_0x5ae8c3(0x2d2)+normalizeIP(_0x1822f9)[_0x5ae8c3(0x2f5)]+'</b>\x20?',{'parse_mode':_0x5ae8c3(0x28a),'reply_markup':{'inline_keyboard':[[{'text':_0x5ae8c3(0x33a),'callback_data':loginExpiry},{'text':_0x5ae8c3(0x1b0),'callback_data':_0x5ae8c3(0x1b0)}]]}})['catch'](_0x39cd43=>{telegramError(_0x39cd43);}),tgBot['on'](_0x5ae8c3(0x2c5),async _0x18c5f6=>{const _0x291498=_0x5ae8c3,_0x5f56ad=_0x18c5f6[_0x291498(0x324)],_0x27c8b7=_0x18c5f6['message'];tgBot[_0x291498(0x2be)](_0x18c5f6['id'])['then'](async()=>{const _0x3e72c7=_0x291498;devices[_0x1e7e6e][_0x3e72c7(0x2a4)]={'clientip':_0x1822f9,'timestamp':new Date()[_0x3e72c7(0x231)](),'expiry':_0x5f56ad},_0x5f56ad!='reject'?(await tgBot['sendMessage'](_0x27c8b7[_0x3e72c7(0x1a1)]['id'],_0x3e72c7(0x25e),{'parse_mode':'HTML'})[_0x3e72c7(0x2b9)](_0x20e08c=>{telegramError(_0x20e08c);}),io['to'](_0x1e7e6e)['emit'](_0x3e72c7(0x1ac),{'access':{'allow':![],'reason':_0x3e72c7(0x213),'token':null}})):(await tgBot[_0x3e72c7(0x1f7)](_0x27c8b7['chat']['id'],_0x3e72c7(0x25a))[_0x3e72c7(0x2b9)](_0x2ee99d=>{telegramError(_0x2ee99d);}),io['to'](_0x1e7e6e)[_0x3e72c7(0x261)](_0x3e72c7(0x1ac),{'access':{'allow':![],'reason':_0x3e72c7(0x194),'token':null}}));}),tgBot[_0x291498(0x330)](_0x291498(0x2c5));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4ff47d=_0x286343;return dbConfig[_0x4ff47d(0x214)](_0x4ff47d(0x186))[_0x4ff47d(0x2ae)]('botID')['filter']({'status':_0x4ff47d(0x33c)})['value']()||[];}function getDisabledBots(){const _0x4b0b85=_0x286343;return dbConfig[_0x4b0b85(0x214)](_0x4b0b85(0x186))[_0x4b0b85(0x2ae)](_0x4b0b85(0x201))[_0x4b0b85(0x182)]({'status':_0x4b0b85(0x342)})[_0x4b0b85(0x329)]()||[];}function getBotAttributes(_0x82800a){const _0x13c2cf=_0x286343;let _0x2baf16={};const _0x535adc=configpath+_0x13c2cf(0x2a8)+_0x82800a+_0x13c2cf(0x197),_0x4b09a9=fs['existsSync'](_0x535adc);if(_0x4b09a9){const _0xdf8604=fs[_0x13c2cf(0x287)](_0x535adc);try{const _0x2bd10f=JSON[_0x13c2cf(0x1eb)](_0xdf8604),_0x4e6561=_0x2bd10f?_0x2bd10f[_0x13c2cf(0x2ca)][0x0][_0x13c2cf(0x1ee)]:![];_0x2baf16[_0x13c2cf(0x1d0)]=_0x4e6561?_0x13c2cf(0x29e):_0x13c2cf(0x279),_0x2baf16[_0x13c2cf(0x2e3)]=_0x2bd10f?_0x2bd10f['bot'][0x0]['botname']:_0x13c2cf(0x275)+_0x82800a;}catch(_0x51b9c4){_0x2baf16['mode']='manual',_0x2baf16[_0x13c2cf(0x2e3)]=_0x13c2cf(0x275)+_0x82800a;}}else _0x2baf16['mode']=_0x13c2cf(0x279),_0x2baf16[_0x13c2cf(0x2e3)]='Bot\x20'+_0x82800a;return _0x2baf16;}function getBotsWithMode(){const _0x39bd37=_0x286343,_0x487c91=dbConfig[_0x39bd37(0x214)](_0x39bd37(0x186))['sortBy'](_0x39bd37(0x201))[_0x39bd37(0x329)]()||[];return _0x487c91[_0x39bd37(0x262)](_0x57872c=>{const _0x27873e=_0x39bd37;let _0x2795c3=getBotAttributes(_0x57872c['botID']);_0x57872c[_0x27873e(0x1d0)]=_0x2795c3['mode'];}),_0x487c91;}function getBotExchanges(){const _0x2fb864=_0x286343;let _0x14b865=[];const _0x4c79d2=dbConfig[_0x2fb864(0x214)](_0x2fb864(0x186))[_0x2fb864(0x2ae)](_0x2fb864(0x201))['value']()||[];_0x4c79d2[_0x2fb864(0x262)](_0x218c7e=>{const _0x3cda38=_0x2fb864;if(_0x218c7e[_0x3cda38(0x1ac)]==_0x3cda38(0x33c)){const _0xcbc746=configpath+'bot-'+_0x218c7e[_0x3cda38(0x201)]+_0x3cda38(0x197),_0x1676f1=fs[_0x3cda38(0x2a2)](_0xcbc746);let _0x49229d;if(_0x1676f1){const _0x9e4e37=fs['readFileSync'](_0xcbc746);try{const _0x575b7d=JSON[_0x3cda38(0x1eb)](_0x9e4e37);_0x49229d=_0x575b7d?_0x575b7d[_0x3cda38(0x2ca)][0x0][_0x3cda38(0x2bb)]:null;}catch(_0x1b063b){}}if(_0x49229d)_0x14b865[_0x3cda38(0x187)](_0x49229d);}});const _0x2c8566=[...new Set(_0x14b865)][_0x2fb864(0x210)]();return _0x2c8566;}async function initUser(){const _0x5eb554=_0x286343;if(!settings[_0x5eb554(0x1ec)]){const _0x4b8935=uuidRandom();mixpanel[_0x5eb554(0x1a6)](_0x4b8935),updateSetting(_0x5eb554(0x1ec),_0x4b8935);}}async function initSecure(){const _0x540b0c=_0x286343;let _0x2ec8d1=getSecure();if(!_0x2ec8d1[_0x540b0c(0x1bf)](_0x540b0c(0x209))){let _0x4f2ba4=await generateKeys();_0x2ec8d1['publicKey']=_0x4f2ba4[_0x540b0c(0x27f)],_0x2ec8d1[_0x540b0c(0x2b0)]=_0x4f2ba4['privateKey'],_0x2ec8d1[_0x540b0c(0x209)]=crypto[_0x540b0c(0x17f)](0x20)[_0x540b0c(0x18c)](_0x540b0c(0x1d5));;storeSecure(_0x2ec8d1);}}function getSettings(){const _0x58c2c3=_0x286343;return dbSettings[_0x58c2c3(0x214)](_0x58c2c3(0x21b))[_0x58c2c3(0x329)]()||{};}function getSecure(){const _0x3d977f=_0x286343;return dbSecure[_0x3d977f(0x214)](_0x3d977f(0x22f))[_0x3d977f(0x329)]()||{};}function getBlacklist(){const _0x439493=_0x286343;return dbSecure[_0x439493(0x214)](_0x439493(0x25c))[_0x439493(0x329)]()||[];}function broadcastToBots(_0x7a3744,_0x22662c){const _0x22ae4c=_0x286343;config[_0x22ae4c(0x262)](_0x13c383=>{const _0x2709eb=_0x22ae4c;if(_0x13c383['status']==_0x2709eb(0x33c)&&_0x13c383[_0x2709eb(0x2c9)]==_0x2709eb(0x2b8)||_0x13c383['status']==_0x2709eb(0x269)&&_0x13c383[_0x2709eb(0x2c9)]=='running'){if(pid[_0x13c383[_0x2709eb(0x201)]])pid[_0x13c383[_0x2709eb(0x201)]][_0x2709eb(0x1f8)]({[_0x7a3744]:_0x22662c});}});}function storeSettings(_0x255be0,_0x15f3b4=![]){const _0x4190ce=_0x286343;_0x255be0={...settings,..._0x255be0};if(_0x15f3b4&&_0x255be0[_0x4190ce(0x2ea)]!='************'&&_0x255be0[_0x4190ce(0x2ea)]!=_0x4190ce(0x247)&&_0x255be0['bbPassword']!=''){const _0x35f54c=crypt[_0x4190ce(0x1b9)](secure[_0x4190ce(0x2b0)],_0x255be0['bbPassword'])[_0x4190ce(0x2ee)][_0x4190ce(0x1d7)]('@')[0x0],_0x391b81=bcrypt[_0x4190ce(0x1ff)](_0x35f54c,saltRounds);_0x255be0={..._0x255be0,'bbPassword':_0x391b81};}if(_0x15f3b4&&_0x255be0[_0x4190ce(0x2c0)]!=_0x4190ce(0x1b6)&&_0x255be0[_0x4190ce(0x2c0)]!=_0x4190ce(0x247)&&_0x255be0['telegramToken']!=''){const _0x3e9f23=crypt[_0x4190ce(0x1b9)](secure[_0x4190ce(0x2b0)],_0x255be0[_0x4190ce(0x2c0)])[_0x4190ce(0x2ee)][_0x4190ce(0x1d7)]('@')[0x0];_0x255be0={..._0x255be0,'telegramToken':_0x3e9f23};}const _0x409a37=_0x255be0[_0x4190ce(0x2c0)]!=_0x4190ce(0x1b6)&&_0x255be0[_0x4190ce(0x2c0)]!=settings[_0x4190ce(0x2c0)]||_0x255be0[_0x4190ce(0x253)]!=settings[_0x4190ce(0x253)],_0x57526c=_0x255be0['telegramToken']==''||_0x255be0[_0x4190ce(0x253)]=='';if(_0x409a37)_0x255be0[_0x4190ce(0x1d9)]=_0x4190ce(0x26c);for(const [_0x120e4f,_0x2a3166]of Object[_0x4190ce(0x18d)](_0x255be0)){if(_0x120e4f==_0x4190ce(0x2c0)&&_0x2a3166==_0x4190ce(0x1b6)){_0x255be0[_0x4190ce(0x2c0)]=settings[_0x4190ce(0x2c0)];continue;};if(_0x120e4f==_0x4190ce(0x2ea)&&_0x2a3166==_0x4190ce(0x1b6)){_0x255be0[_0x4190ce(0x2ea)]=settings[_0x4190ce(0x2ea)];continue;};dbSettings[_0x4190ce(0x325)]('settings.'+_0x120e4f,_0x2a3166)[_0x4190ce(0x2d6)]();}settings=_0x255be0,io['to'](_0x4190ce(0x331))[_0x4190ce(0x261)](_0x4190ce(0x21b),cleanSettings()),broadcastToBots(_0x4190ce(0x332),settings[_0x4190ce(0x332)]),broadcastToBots(_0x4190ce(0x1e9),settings[_0x4190ce(0x1e9)]);if(_0x409a37&&!_0x57526c)initTelegram();if(_0x409a37&&_0x57526c)disableTelegram();getAllClients()[_0x4190ce(0x262)](_0x49a614=>{const _0x5f0666=_0x4190ce;getSocket(_0x49a614['id'])[_0x5f0666(0x261)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x5b207f,_0x507bfb){const _0x1f34ea=_0x286343;dbSettings[_0x1f34ea(0x325)](_0x1f34ea(0x2e5)+_0x5b207f,_0x507bfb)[_0x1f34ea(0x2d6)](),settings=getSettings(),io['to']('botmanager')[_0x1f34ea(0x261)](_0x1f34ea(0x21b),cleanSettings());}function storeSecure(_0x2f84d9){const _0x1d6a61=_0x286343;dbSecure['get'](_0x1d6a61(0x22f))[_0x1d6a61(0x187)](_0x2f84d9)[_0x1d6a61(0x2d6)](),secure=_0x2f84d9;}function addBlacklist(_0x59e5a7){const _0x1674ec=_0x286343;cleanBlacklist();let _0x2cfbf0;devices[_0x59e5a7][_0x1674ec(0x328)]?_0x2cfbf0=Math[_0x1674ec(0x25d)](devices[_0x59e5a7][_0x1674ec(0x328)][_0x1674ec(0x24f)],loginExpiry):_0x2cfbf0=loginExpiry,dbSecure[_0x1674ec(0x214)](_0x1674ec(0x25c))[_0x1674ec(0x187)]({'expiry':new Date()[_0x1674ec(0x231)]()+_0x2cfbf0*0x3c*0x3e8,'token':devices[_0x59e5a7][_0x1674ec(0x1fe)][_0x1674ec(0x2c7)]})[_0x1674ec(0x2d6)](),blacklist=dbSecure[_0x1674ec(0x214)]('blacklist')['value']();}function cleanBlacklist(){const _0x50cb1f=_0x286343;let _0x2099da=dbSecure[_0x50cb1f(0x214)](_0x50cb1f(0x25c))[_0x50cb1f(0x250)]()[_0x50cb1f(0x329)](),_0xf79d94=new Date()[_0x50cb1f(0x231)]();_0x2099da[_0x50cb1f(0x262)](_0x4dcfae=>{const _0x4eda48=_0x50cb1f;_0x4dcfae[_0x4eda48(0x24f)]<_0xf79d94&&dbSecure[_0x4eda48(0x214)](_0x4eda48(0x25c))['remove']({'expiry':_0x4dcfae[_0x4eda48(0x24f)]})[_0x4eda48(0x2d6)]();});}function initStates(){const _0x14f51e=_0x286343;let _0x4e10fc=getConfiguration();_0x4e10fc[_0x14f51e(0x262)](_0x1a5c1b=>{const _0x525963=_0x14f51e;_0x1a5c1b[_0x525963(0x2c9)]=_0x525963(0x2cd);}),storeConfiguration(_0x4e10fc);}function onKeys(){const _0xe34d6=new RSA();return new Promise(_0x2c1204=>{const _0x48fa3f=_0x461f;_0xe34d6[_0x48fa3f(0x2fd)]()['then'](_0x41ea0a=>{_0x2c1204(_0x41ea0a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4ba877=_0x286343;let _0x121747=getSettings(),_0x4782cf=![];!_0x121747['hasOwnProperty'](_0x4ba877(0x21f))&&(_0x121747[_0x4ba877(0x21f)]=0x0,_0x4782cf=!![]);!_0x121747[_0x4ba877(0x1bf)](_0x4ba877(0x22a))&&(_0x121747[_0x4ba877(0x22a)]=0x0,_0x4782cf=!![]);!_0x121747[_0x4ba877(0x1bf)](_0x4ba877(0x2ad))&&(_0x121747[_0x4ba877(0x2ad)]=_0x4ba877(0x1b8),_0x4782cf=!![]);!_0x121747['hasOwnProperty'](_0x4ba877(0x1e9))&&(_0x121747['onepagemode']=![],_0x4782cf=!![]);if(_0x4782cf)storeSettings(_0x121747);}function storeConfiguration(_0x591dcf){const _0x513efe=_0x286343;dbConfig['get'](_0x513efe(0x186))['remove']()[_0x513efe(0x2d6)](),_0x591dcf[_0x513efe(0x262)](_0xae697c=>{const _0x519bfe=_0x513efe;delete _0xae697c[_0x519bfe(0x1d0)];}),dbConfig[_0x513efe(0x214)]('bots')[_0x513efe(0x187)](..._0x591dcf)[_0x513efe(0x2d6)](),config=_0x591dcf;}function resetPassword(){const _0x1d7880=_0x286343;tgBot&&settings[_0x1d7880(0x1dc)]&&(tgBot['removeListener'](_0x1d7880(0x2c5)),tgBot['sendMessage'](settings['telegramChatId'],_0x1d7880(0x2f2),{'parse_mode':_0x1d7880(0x28a),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x1d7880(0x32f)},{'text':'no','callback_data':'no'}]]}})[_0x1d7880(0x2b9)](_0x4e2952=>{telegramError(_0x4e2952);}),tgBot['on']('callback_query',async _0x4ba0c5=>{const _0x2a26b9=_0x1d7880,_0x1ddc3d=_0x4ba0c5[_0x2a26b9(0x324)],_0x137ac5=_0x4ba0c5['message'];tgBot[_0x2a26b9(0x2be)](_0x4ba0c5['id'])[_0x2a26b9(0x2a3)](async()=>{const _0x46a562=_0x2a26b9;if(_0x1ddc3d!='no'){const _0x6f6868=0xf,_0x450700=_0x46a562(0x322),_0x34276f=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x6f6868)))['map'](_0x3b1790=>_0x450700[_0x3b1790%_0x450700[_0x46a562(0x20e)]])['join'](''),_0x3f4361=bcrypt[_0x46a562(0x1ff)](_0x34276f,saltRounds);storeSettings({'bbPassword':_0x3f4361}),await tgBot[_0x46a562(0x1f7)](_0x137ac5[_0x46a562(0x1a1)]['id'],_0x46a562(0x1f3)+_0x34276f,{'parse_mode':_0x46a562(0x28a)})[_0x46a562(0x2b9)](_0x229e8c=>{telegramError(_0x229e8c);});}else await tgBot[_0x46a562(0x1f7)](_0x137ac5[_0x46a562(0x1a1)]['id'],_0x46a562(0x2d0))[_0x46a562(0x2b9)](_0x1ce37d=>{telegramError(_0x1ce37d);});}),tgBot[_0x2a26b9(0x330)](_0x2a26b9(0x2c5));}));}async function confirmRestore(_0x2c87e2,_0x313500){const _0x437c70=_0x286343;io['to'](_0x437c70(0x331))[_0x437c70(0x261)]('notification',_0x437c70(0x223),_0x437c70(0x292)),tgBot&&settings[_0x437c70(0x1dc)]&&(tgBot[_0x437c70(0x330)](_0x437c70(0x2c5)),await tgBot['sendMessage'](settings[_0x437c70(0x1dc)],_0x437c70(0x307),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x437c70(0x32f),'callback_data':_0x437c70(0x32f)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x567cd1=>{telegramError(_0x567cd1);}),tgBot['on'](_0x437c70(0x2c5),async _0x5bfb13=>{const _0x4f0386=_0x437c70,_0x46cd39=_0x5bfb13['data'],_0x522a29=_0x5bfb13[_0x4f0386(0x2ee)];tgBot[_0x4f0386(0x2be)](_0x5bfb13['id'])['then'](async()=>{const _0x27fdab=_0x4f0386;_0x46cd39==_0x27fdab(0x32f)?(await tgBot[_0x27fdab(0x1f7)](_0x522a29[_0x27fdab(0x1a1)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'})[_0x27fdab(0x2b9)](_0x13206c=>{telegramError(_0x13206c);}),unzipFile(_0x2c87e2,_0x313500)):(logger[_0x27fdab(0x2bf)](_0x27fdab(0x268)),await tgBot['sendMessage'](_0x522a29[_0x27fdab(0x1a1)]['id'],_0x27fdab(0x268))[_0x27fdab(0x2b9)](_0x2a84ce=>{telegramError(_0x2a84ce);}));}),tgBot[_0x4f0386(0x330)](_0x4f0386(0x2c5));}));}function getServerTime(){const _0x5e1d63=_0x286343,_0x1b5168=new Date();return _0x1b5168[_0x5e1d63(0x208)]()+'/'+(_0x1b5168['getMonth']()+0x1)[_0x5e1d63(0x18c)]()[_0x5e1d63(0x27b)](0x2,'0')+'/'+_0x1b5168[_0x5e1d63(0x294)]()[_0x5e1d63(0x18c)]()[_0x5e1d63(0x27b)](0x2,'0')+'\x20'+_0x1b5168[_0x5e1d63(0x1a9)]()[_0x5e1d63(0x18c)]()[_0x5e1d63(0x27b)](0x2,'0')+':'+_0x1b5168[_0x5e1d63(0x2f4)]()[_0x5e1d63(0x18c)]()[_0x5e1d63(0x27b)](0x2,'0')+':'+_0x1b5168[_0x5e1d63(0x20a)]()[_0x5e1d63(0x18c)]()[_0x5e1d63(0x27b)](0x2,'0');}function getTimeStamp(){const _0x8d8f19=_0x286343,_0x130bb1=shiftedTime();return _0x130bb1[_0x8d8f19(0x208)]()+'/'+(_0x130bb1['getMonth']()+0x1)[_0x8d8f19(0x18c)]()[_0x8d8f19(0x27b)](0x2,'0')+'/'+_0x130bb1[_0x8d8f19(0x294)]()[_0x8d8f19(0x18c)]()[_0x8d8f19(0x27b)](0x2,'0')+'\x20'+_0x130bb1[_0x8d8f19(0x1a9)]()[_0x8d8f19(0x18c)]()[_0x8d8f19(0x27b)](0x2,'0')+':'+_0x130bb1[_0x8d8f19(0x2f4)]()[_0x8d8f19(0x18c)]()[_0x8d8f19(0x27b)](0x2,'0')+':'+_0x130bb1[_0x8d8f19(0x20a)]()[_0x8d8f19(0x18c)]()[_0x8d8f19(0x27b)](0x2,'0');}function getCleanTimeStamp(){const _0x31e261=_0x286343,_0x37e3c6=shiftedTime();return _0x37e3c6['getFullYear']()+(_0x37e3c6[_0x31e261(0x2e6)]()+0x1)[_0x31e261(0x18c)]()[_0x31e261(0x27b)](0x2,'0')+_0x37e3c6[_0x31e261(0x294)]()['toString']()[_0x31e261(0x27b)](0x2,'0')+'-'+_0x37e3c6['getHours']()[_0x31e261(0x18c)]()[_0x31e261(0x27b)](0x2,'0')+_0x37e3c6['getMinutes']()[_0x31e261(0x18c)]()['padStart'](0x2,'0')+_0x37e3c6[_0x31e261(0x20a)]()['toString']()[_0x31e261(0x27b)](0x2,'0');}function shiftedTime(){const _0x322021=_0x286343,_0x8e95bb=new Date();let _0x2539cd=_0x8e95bb;if(settings['timeshift']&&settings[_0x322021(0x332)]!==0x0)_0x2539cd=fns[_0x322021(0x31c)](_0x8e95bb,{'hours':settings[_0x322021(0x332)]});return _0x2539cd;}function startScheduler(){const _0x5c4ea9=_0x286343,_0x1c8e57=new Date()[_0x5c4ea9(0x2af)](),_0x111cf8=shiftedTime()['getHours']();_0x111cf8==0x4&&backupConfigFiles();_0x111cf8==0x0&&rotateLogFiles();_0x1c8e57%0x6==0x0&&triggerAnalytics();_0x1c8e57%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4e3a8e){const _0x55157f=_0x286343;logger['debug'](_0x55157f(0x27c)+_0x4e3a8e);const _0x44e27e=getBotsWithMode();_0x44e27e['length']>0x0?confirmRestore(configbackuppath,_0x4e3a8e):unzipFile(configbackuppath,_0x4e3a8e);}async function getBackupFiles(_0x249aa8=null){const _0x456346=_0x286343;let _0x51c7a6=[],_0x48f589=fs[_0x456346(0x230)](configbackuppath,{'withFileTypes':!![]});_0x48f589[_0x456346(0x210)]((_0x12673e,_0xeefa11)=>_0x12673e[_0x456346(0x21a)]<_0xeefa11[_0x456346(0x21a)]?0x1:_0xeefa11[_0x456346(0x21a)]<_0x12673e['name']?-0x1:0x0),_0x48f589['forEach'](_0x2c1409=>{const _0x4c02ff=_0x456346;if(!_0x2c1409[_0x4c02ff(0x30e)]()&&_0x2c1409[_0x4c02ff(0x21a)]['startsWith'](_0x4c02ff(0x212))&&_0x2c1409['name'][_0x4c02ff(0x244)]('.zip')){const _0x40080b=formatDate(fs[_0x4c02ff(0x1de)](configbackuppath+_0x2c1409[_0x4c02ff(0x21a)])[_0x4c02ff(0x2f9)]);_0x51c7a6[_0x4c02ff(0x187)]({'name':_0x2c1409[_0x4c02ff(0x21a)],'mtime':_0x40080b});}});if(_0x249aa8)io['to'](_0x249aa8)[_0x456346(0x261)](_0x456346(0x203),_0x51c7a6);else return _0x51c7a6;}async function backupConfigFiles(){const _0x4431ca=_0x286343;await zipFiles(_0x4431ca(0x276));const _0x5a543c=getCleanTimeStamp();fs[_0x4431ca(0x1b7)](zippath+'backup-full.zip',configbackuppath+(_0x4431ca(0x212)+_0x5a543c+'.zip'));let _0x278244=fs[_0x4431ca(0x230)](configbackuppath,{'withFileTypes':!![]});_0x278244[_0x4431ca(0x210)]((_0x303a26,_0x24ada5)=>_0x303a26[_0x4431ca(0x21a)]<_0x24ada5[_0x4431ca(0x21a)]?0x1:_0x24ada5['name']<_0x303a26[_0x4431ca(0x21a)]?-0x1:0x0),_0x278244['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x278244[maxBackups][_0x4431ca(0x21a)]);}function rotateLogFiles(){const _0x2d5c55=_0x286343,_0x2937d9=fs[_0x2d5c55(0x1de)](logspath+'output-000.log'),_0x4a34a7=_0x2937d9[_0x2d5c55(0x26e)]/0x400;if(_0x4a34a7>0x64){let _0x242873=fs[_0x2d5c55(0x230)](logspath,{'withFileTypes':!![]});_0x242873['sort']((_0x548401,_0x80c44f)=>_0x548401[_0x2d5c55(0x21a)]<_0x80c44f[_0x2d5c55(0x21a)]?0x1:_0x80c44f['name']<_0x548401['name']?-0x1:0x0),_0x242873[_0x2d5c55(0x262)](_0x3015ff=>{const _0x17b378=_0x2d5c55;if(_0x3015ff[_0x17b378(0x21a)]=='output-002.log')fs[_0x17b378(0x1b7)](logspath+_0x3015ff[_0x17b378(0x21a)],logspath+_0x17b378(0x21d));if(_0x3015ff['name']==_0x17b378(0x2d1))fs[_0x17b378(0x1b7)](logspath+_0x3015ff[_0x17b378(0x21a)],logspath+_0x17b378(0x2ce));_0x3015ff[_0x17b378(0x21a)]==_0x17b378(0x188)&&(fs[_0x17b378(0x1b7)](logspath+_0x3015ff[_0x17b378(0x21a)],logspath+_0x17b378(0x2d1)),fs['writeFileSync'](logspath+_0x3015ff[_0x17b378(0x21a)],''));});}}async function zipFiles(_0x94ae67){const _0x412997=_0x286343;let _0x389487;if(_0x94ae67==_0x412997(0x2c8))_0x389487=logspath;if(_0x94ae67=='backup')_0x389487=configpath;if(_0x94ae67==_0x412997(0x276))_0x389487=configpath;let _0x589067=fs[_0x412997(0x230)](_0x389487,{'withFileTypes':!![]});const _0xbc9a2b=new require(_0x412997(0x315))();_0x589067['forEach'](_0x250815=>{const _0xc93d39=_0x412997;if(!_0x250815[_0xc93d39(0x30e)]()){let _0x368281=fs['readFileSync'](_0x389487+_0x250815['name']);if(_0x94ae67==_0xc93d39(0x24d)){const _0xc2b73=/^bot-[0-9]{3}-config.json$/,_0x9c71d6=_0xc2b73[_0xc93d39(0x1fc)](_0x250815[_0xc93d39(0x21a)]);if(_0x9c71d6){const _0x18e39e=JSON[_0xc93d39(0x1eb)](_0x368281);_0x18e39e[_0xc93d39(0x2ca)][0x0]&&(_0x18e39e[_0xc93d39(0x2ca)][0x0][_0xc93d39(0x302)]=_0xc93d39(0x247),_0x18e39e['bot'][0x0]['apiSecret']=_0xc93d39(0x247)),_0x368281=JSON[_0xc93d39(0x254)](_0x18e39e,null,0x2);}if(_0x250815[_0xc93d39(0x21a)]==_0xc93d39(0x18f)){const _0xc579ec=JSON[_0xc93d39(0x1eb)](_0x368281);if(_0xc579ec[_0xc93d39(0x21b)]['loginRequired'])_0xc579ec[_0xc93d39(0x21b)][_0xc93d39(0x233)]=![];if(_0xc579ec[_0xc93d39(0x21b)][_0xc93d39(0x2ea)])_0xc579ec[_0xc93d39(0x21b)][_0xc93d39(0x2ea)]=_0xc93d39(0x247);if(_0xc579ec[_0xc93d39(0x21b)]['telegramToken'])_0xc579ec['settings'][_0xc93d39(0x2c0)]=_0xc93d39(0x247);if(_0xc579ec[_0xc93d39(0x21b)][_0xc93d39(0x1dc)])_0xc579ec['settings'][_0xc93d39(0x1dc)]=null;_0x368281=JSON['stringify'](_0xc579ec,null,0x2);}if(_0x250815[_0xc93d39(0x21a)]!=_0xc93d39(0x1ca))_0xbc9a2b[_0xc93d39(0x241)](_0x250815['name'],_0x368281);}else _0xbc9a2b[_0xc93d39(0x241)](_0x250815['name'],_0x368281);}});const _0xd1723c=_0xbc9a2b['generate']({'base64':![],'compression':_0x412997(0x317)});fs[_0x412997(0x1b2)](zippath+(_0x94ae67+_0x412997(0x255)),_0xd1723c,_0x412997(0x22e));}async function unzipFile(_0x44d15b,_0x374037){const _0x439578=_0x286343;fs[_0x439578(0x230)](configpath,{'withFileTypes':!![]})[_0x439578(0x262)](_0x4f79e0=>{const _0x1eb095=_0x439578;if(!_0x4f79e0[_0x1eb095(0x30e)]())fs[_0x1eb095(0x1ef)](configpath+_0x4f79e0[_0x1eb095(0x21a)]);});const _0xff648c=fs[_0x439578(0x287)](_0x44d15b+_0x374037,_0x439578(0x22e)),_0x2d5f41=new require('node-zip')(_0xff648c,{'base64':![],'checkCRC32':!![]});Object[_0x439578(0x2b7)](_0x2d5f41[_0x439578(0x2ec)])[_0x439578(0x262)](_0x140ad8=>{const _0x7d271c=_0x439578,_0x568e25=_0x2d5f41[_0x7d271c(0x2ec)][_0x140ad8];fs[_0x7d271c(0x1b2)](configpath+_0x568e25[_0x7d271c(0x21a)],_0x568e25['_data']);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x439578(0x262)](_0x122a50=>{const _0x5b5f8f=_0x439578;if(!_0x122a50[_0x5b5f8f(0x30e)]())fs['rmSync'](temppath+_0x122a50[_0x5b5f8f(0x21a)]);}),logger[_0x439578(0x2bf)](_0x439578(0x2b6)),process[_0x439578(0x1f8)]({'restore':!![]},_0x2f5963=>{});}async function getPublicIp(){const _0x57b222=_0x286343;try{const _0x4cb872=await axios['get'](_0x57b222(0x227));publicip=_0x4cb872[_0x57b222(0x324)]['ip'];}catch(_0x17c595){}}async function triggerAnalytics(){const _0x1801a6=_0x286343;if(!publicip)await getPublicIp();const _0x54efcd=getBotsWithMode();let _0x457d32=0x0;_0x54efcd[_0x1801a6(0x262)](_0x3b5b6b=>{const _0x571486=_0x1801a6;if(_0x3b5b6b[_0x571486(0x1ac)]===_0x571486(0x33c))_0x457d32++;});const _0x4af75e=getBotExchanges();mixpanel[_0x1801a6(0x29f)](_0x1801a6(0x1f4),{'distinct_id':settings[_0x1801a6(0x1ec)],'ip':publicip,'version':serverversion,'numbots':_0x54efcd[_0x1801a6(0x20e)],'numbotsenabled':_0x457d32,'exchanges':_0x4af75e});}function _0x275b(){const _0x41aa6b=['logged\x20out','/:bot/coins','Access\x20enabled\x20for\x20','search','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','125855mXysMd','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','temporary\x20token\x20generated','alerts','Error:\x20Invalid\x20argument\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','Session\x20expired\x20for\x20user\x20...','file','storeFiat','2FA\x20login\x20required','endsWith','temporary\x20access\x20timeout','Alerts','***','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','path','bb-config.json','error','confirm-message','backup','You\x20can\x20use\x20the\x20following\x20commands:\x0a','expiry','cloneDeep','user','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','telegramUsername','stringify','.zip','axios','crypto','Invalid\x20IP\x20address','ipv6','Login\x20rejected','store-configuration','blacklist','max','Login\x20accepted','child_process','8150526czGHcz','emit','forEach','/upload-backup','access\x20timeout','find','replace','<b>Telegram\x20Bot\x20Status:</b>\x0a','Restore\x20process\x20aborted','new','referer','Invalid\x20Telegram\x20token','all','<b>Balance\x20Bot\x20Status:</b>\x0a','size','Unauthorized\x20attempt\x20to\x20download\x20','full','storeHeadless','get-starting-balances','Disabled\x20Bot\x20','toIPv4MappedAddress','Bot\x20','backup-full','uncaughtException','update-bot','manual','Markdown','padStart','Restore\x20backup\x20file\x20','sha256','remove','publicKey','post','cancelLoading','env','version','Notifications\x20types:\x20','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','No\x20authentication\x20token','readFileSync','sendFile','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','HTML','number','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','disconnect','config/','fork','-----------------------------------------------------------------------------------','success','clients','getDate','\x20|\x20','logout','onText','defaults','from','Temporary\x20access\x20rejected','f2aRequired','connection','telegram','auto','track','login\x20token\x20valid','login\x20token\x20generated','existsSync','then','telegram2FaApproval','Unauthorized\x20login\x20attempt\x20(timeout)','3000','remoteAddress','bot-','started','Notifications\x20enabled','includes','telegrammsg','latestversion','sortBy','getUTCHours','privateKey','Ok,\x20will\x20send\x20alert\x20notifications\x20only','2FA\x20required','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','storeConfiguration','polling_error','Backup\x20file\x20unzipped\x20and\x20stored','keys','running','catch','276gQgSTL','exchange','unlinkSync','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','answerCallbackQuery','debug','telegramToken','sign','\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20store\x20configuration','callback_query','login','token','logs','live','bot','clientip','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','stopped','output-002.log','Invalid\x20username\x20or\x20IP\x20address','Password\x20reset\x20rejected','output-001.log','Allow\x20login\x20from\x20IP\x20address\x20<b>','password','download','Notifications\x20enabled\x0a','write','getStartingBalances','store-settings','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Starting\x20Balance\x20Bot\x20reinstallation','request','slice','initclient','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','timestamp','argv','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','botname','login\x20required','settings.','getMonth','build','socket','join','bbPassword','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','files','Restarting\x20Bot\x20','message','14mGkucO','All\x20bots','graphql-request','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','emitHistory','getMinutes','show','get-messages','place-order','Unauthorized\x20attempt\x20to\x20confirm\x20message','mtime','showname','hybrid-crypto-js','use','generateKeyPairAsync','40221170UTNFIz','$1_$2_$3','util','toIPv4Address','apiKey','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','simple','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','new-disabled','api-eu.mixpanel.com','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','File\x20uploaded','bcryptjs','index.html','isDirectory','Invalid\x20authentication\x20token\x20(2)','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','isIPv4MappedAddress','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','notification','3404359PwqArt','node-zip','7645608ppmORt','DEFLATE','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','temp/','exit','add','15\x20min','\x20minutes','getPortfolio','Unauthorized\x20attempt\x20to\x20show\x20configuration','init','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','conn','data','set','Starting\x20new\x20bot\x20|\x20Bot\x20','version.json','telegramIpApproval','value','showConfig','lowdb','No\x20bots\x20running\x20right\x20now','uuid-random','Logged\x20out\x20user\x20...','yes','removeListener','botmanager','timeshift','auth',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','bbUsername','build2','Logged\x20in\x20user\x20...','/:bot/support','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','accept','pidExpireLogin','enabled','cancel-loading','::ffff:127.0.0.1','368513SoSMQg','/update\x20-\x20update\x20Balance\x20Bot\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','disabled','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/:bot/performance','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20log\x20out','/:bot','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','randomBytes','logs/','1000','filter','Invalid\x20authentication\x20token\x20(1)','mkdirSync','Starting\x20Balance\x20Bot\x20update','bots','push','output-000.log','inherit','336843zBEgiG','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','toString','entries','restore-backup-file','bb-settings.json',':\x20Bot\x20Mgr\x20>\x20','11lGbURJ','SIGTERM','2FA','2FA\x20login\x20rejected','bot.js','add-bot','-config.json','reset-history','removeAllListeners','once','exp','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','127.0.0.1','All\x20bots\x20running\x20right\x20now','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','chat','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','whitelistEnabled','/:bot/history','jsonwebtoken','alias','stop','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','getHours','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Orders','status','reinstall-bb','connected','\x20(2)','reject','http','writeFileSync','Enabled\x20Bot\x20','orders','min','************','copyFileSync','0.0.0','decrypt','(((.+)+)+)+$','temporary\x20access\x20not\x20allowed','zip/','temporary\x20access\x20rejected','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','hasOwnProperty','-events.json','socket.io','Setting\x20access:\x20','headers','isValid','/off\x20-\x20stop\x20bot(s)\x0a','bbvNew','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20attempt\x20to\x20get\x20portfolio','-performance.json','bb-secure.json','/disable\x20-\x20disable\x20notifications\x0a','delete-alerts','Notifications\x20disabled\x0a','Backup\x20file\x20uploaded','sendPortfolioTelegram','mode','/names\x20-\x20show\x20bot\x20names\x0a','type','title','username','hex','handshake','split','sockets','telegramEvents','sendMetricsTelegram','messages','telegramChatId','match','statSync','invalid\x20credentials','404\x20Not\x20Found','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','reinstall','update-bb','-results.json','verify','Token\x20blacklisted','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','\x20mode','onepagemode','uuid','parse','userid','stopPolling','headless','rmSync','update','::1','temporaryAccessAllowed','Password\x20has\x20been\x20reset\x20to:\x20','Server','startsWith','reason','sendMessage','send','*$1*','pidRefreshToken','/enable\x20-\x20enable\x20notifications\x0a','test','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','access','hashSync','placeOrder','botID','\x20only\x0a','backup-files','log','updatebotmanager','createServer','tkn','getFullYear','secret','getSeconds',',\x20must\x20be\x20a\x204\x20digit\x20number','telegramEnabled','listen','length','constructor','sort','12DWAVWC','backup-full@','reload','get','event','Starting\x20Balance\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','store','name','settings','args','output-003.log','</b>\x20?','lastmsgtelegram','encryptedUuid','kill','Error\x20while\x20deleting\x20config\x20files:\x20','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Unauthorized\x20attempt\x20to\x20get\x20events','exec','allow','https://api.ipify.org?format=json','/help\x20-\x20show\x20available\x20commands\x0a','get-portfolio','lastmsgemitted','\x20|\x20client:\x20...','assign','format','binary','secure','readdirSync','getTime','port','loginRequired','Bot\x20Mgr\x20>\x20'];_0x275b=function(){return _0x41aa6b;};return _0x275b();}async function getMessages(){const _0x1cacb2=_0x286343,_0xa75753='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x59374e=new GraphQLClient(_0xa75753),_0x817371={'authorization':_0x1cacb2(0x252)},_0x17d668=serverversion['split']('.'),_0x16e1a4=_0x17d668[0x0]+'.'+_0x17d668[0x1],_0x3c8db6=Math[_0x1cacb2(0x1b5)](settings[_0x1cacb2(0x21f)],settings[_0x1cacb2(0x22a)]),_0x40bdf1={'last':parseInt(_0x3c8db6),'bbm':_0x16e1a4},_0x609774=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x261c83;try{_0x261c83=await _0x59374e[_0x1cacb2(0x2db)](_0x609774,_0x40bdf1,_0x817371);}catch(_0x397cff){}if(_0x261c83&&_0x261c83[_0x1cacb2(0x1db)]){let _0xa829bf=settings[_0x1cacb2(0x21f)];newMessages=[];for(const _0x58f762 of _0x261c83[_0x1cacb2(0x1db)]){newMessages[_0x1cacb2(0x187)](_0x58f762);if(_0x58f762[_0x1cacb2(0x1c6)])updateSetting('latestversion',_0x58f762[_0x1cacb2(0x1c6)]);let _0x4b97e8=_0x58f762['bbvNew']?serverversion>=_0x58f762[_0x1cacb2(0x1c6)]:![];if(!_0x4b97e8&&_0x58f762[_0x1cacb2(0x28b)]>_0xa829bf){if(_0x58f762['bbvReceive']==='any'||serverversion[_0x1cacb2(0x1f5)](_0x58f762['bbvReceive'])){let _0xfeb625=''+_0x58f762[_0x1cacb2(0x1d3)]+'\x0a\x0a'+_0x58f762['message'];const _0x131aa8=await sendTelegramMsg(toTelegramMarkdown(_0xfeb625),_0x1cacb2(0x27a));if(_0x131aa8)_0xa829bf=_0x58f762[_0x1cacb2(0x28b)];}}}updateAvailable=isNewerVersion(settings[_0x1cacb2(0x2ad)],serverversion),updateSetting(_0x1cacb2(0x21f),_0xa829bf),emitMessages();}}function emitMessages(){const _0x29d40d=_0x286343,_0x4ef8c6=settings[_0x29d40d(0x22a)];let _0xf83ca7=[];newMessages[_0x29d40d(0x262)](_0x2179e7=>{const _0x113516=_0x29d40d;_0x2179e7[_0x113516(0x28b)]>_0x4ef8c6&&_0xf83ca7[_0x113516(0x187)](_0x2179e7);}),_0xf83ca7[_0x29d40d(0x20e)]>0x0&&getAllClients()['forEach'](_0x56756d=>{const _0x829fd7=_0x29d40d;getSocket(_0x56756d['id'])[_0x829fd7(0x261)](_0x829fd7(0x2ee),_0xf83ca7);});}function confirmMessage(_0x5f0836){const _0x2b8bf3=_0x286343;updateSetting(_0x2b8bf3(0x22a),Number(_0x5f0836));}function isNewerVersion(_0x34cf0e,_0x704fc){const _0x4ac3aa=_0x286343,_0x2c3d79=_0x704fc[_0x4ac3aa(0x1d7)]('.'),_0x259d65=_0x34cf0e['split']('.');for(var _0x536d5e=0x0;_0x536d5e<_0x259d65[_0x4ac3aa(0x20e)];_0x536d5e++){const _0x41904d=~~_0x259d65[_0x536d5e],_0x2467bc=~~_0x2c3d79[_0x536d5e];if(_0x41904d>_0x2467bc)return!![];if(_0x41904d<_0x2467bc)return![];}return![];}function toTelegramMarkdown(_0xdc8a4e){const _0x3ea1b5=_0x286343,_0x5a33c2=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1c2415=/\*{2}(.+?)\*{2}/gim;return _0xdc8a4e=_0xdc8a4e[_0x3ea1b5(0x266)](_0x5a33c2,_0x3ea1b5(0x2ff))[_0x3ea1b5(0x266)](_0x1c2415,_0x3ea1b5(0x1f9)),_0xdc8a4e;}async function validateConfigFile(){const _0xae5620=_0x286343,_0x1e3bd2=dbConfig['get'](_0xae5620(0x186))[_0xae5620(0x2ae)](_0xae5620(0x201))[_0xae5620(0x329)]()||[];if(_0x1e3bd2['length']==0x0){let _0x3c2545=0x0,_0x296627=[];const _0xda1ec4=/^bot-([0-9]{3})-config.json$/,_0x196146=fs[_0xae5620(0x230)](configpath);_0x196146[_0xae5620(0x262)](_0x51b4c4=>{const _0x2e42fe=_0xae5620,_0x39d2ce=_0xda1ec4[_0x2e42fe(0x225)](_0x51b4c4);if(_0x39d2ce){const _0x64c2a8=_0x39d2ce[0x1];let _0x4f2a03=getBotAttributes(_0x64c2a8);_0x296627['push']({'botID':_0x64c2a8,'botname':_0x4f2a03[_0x2e42fe(0x2e3)],'status':_0x2e42fe(0x342),'live':_0x2e42fe(0x2cd)}),_0x3c2545++;}}),_0x3c2545!=0x0&&(dbConfig[_0xae5620(0x214)](_0xae5620(0x186))[_0xae5620(0x22c)](_0x296627)[_0xae5620(0x2d6)](),config=_0x296627,restoredConfigFile=_0x3c2545);}}async function restoreConfigNotify(_0x33ac6d){const _0x211582=_0x286343;let _0x5dded7;if(restoredConfigFile==0x1)_0x5dded7=_0x211582(0x248);else _0x5dded7=_0x211582(0x30a);if(_0x33ac6d)io['to'](_0x211582(0x331))[_0x211582(0x261)]('notification',_0x5dded7);else{logger[_0x211582(0x305)](_0x211582(0x291)),logger[_0x211582(0x305)](_0x5dded7),logger[_0x211582(0x305)](_0x211582(0x291)),logger[_0x211582(0x305)]('');if(tgBot&&settings[_0x211582(0x1dc)]&&settings['telegramEvents']!=_0x211582(0x1b4))tgBot['sendMessage'](settings[_0x211582(0x1dc)],_0x211582(0x234)+_0x5dded7)[_0x211582(0x2b9)](_0x5c8db3=>{telegramError(_0x5c8db3);});}}function validateCredentials(_0x5a2bd3,_0x7b2654){const _0xca73e5=_0x286343;if(_0x5a2bd3[_0xca73e5(0x1d4)]==settings[_0xca73e5(0x335)]&&bcrypt['compareSync'](_0x5a2bd3[_0xca73e5(0x2d3)],settings[_0xca73e5(0x2ea)])){if(settings[_0xca73e5(0x29b)])return{'allow':![],'reason':_0xca73e5(0x243),'token':null};else{const _0x18dedc=generateLoginToken(_0x7b2654);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x18dedc};}}else return{'allow':![],'reason':_0xca73e5(0x1df),'token':null};}function refreshToken(_0x5d74a3){const _0x2cdf40=_0x286343,_0x45596c=generateLoginToken(_0x5d74a3);return{'allow':!![],'reason':_0x2cdf40(0x2a1),'token':_0x45596c};}function validateAccess(_0x5cfc2b,_0x4b0316,_0x386c60){const _0x324ef4=_0x286343,_0x45d68f=_0x386c60?_0x386c60:devices[_0x4b0316]['ip'];let _0x289875;const _0xa9e59b=_0x102405=>{const _0x279729=_0x461f;if(settings[_0x279729(0x233)]){if(settings[_0x279729(0x29b)]){if(telegram2FaApproved(_0x4b0316)){const _0x272525=generateLoginToken(_0x4b0316);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x272525};}else return{'allow':![],'reason':_0x279729(0x2e4),'token':null};}else return _0x289875=validToken(_0x102405,_0x4b0316),_0x289875[_0x279729(0x1bf)](_0x279729(0x292))?{'allow':!![],'reason':_0x279729(0x2a0),'token':_0x102405}:{'allow':![],'reason':_0x279729(0x2e4),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x324ef4(0x1a3)]){let _0x351865=[...settings['whitelist'],_0x324ef4(0x1f1),_0x324ef4(0x33e),_0x324ef4(0x19d)];if(_0x351865[_0x324ef4(0x2ab)](_0x45d68f))return _0xa9e59b(_0x5cfc2b);else{_0x289875=validToken(_0x5cfc2b,_0x4b0316);if(_0x289875[_0x324ef4(0x1bf)](_0x324ef4(0x292)))return _0xa9e59b(_0x5cfc2b);else{if(telegramIpApproved(_0x4b0316)){const _0x3921e1=generateToken(_0x4b0316);return _0x289875=_0xa9e59b(_0x5cfc2b),_0x289875[_0x324ef4(0x226)]?{'allow':!![],'reason':_0x324ef4(0x23c),'token':_0x3921e1}:_0x289875;}else return settings[_0x324ef4(0x1f2)]?{'allow':![],'reason':_0x324ef4(0x2b2),'token':null}:{'allow':![],'reason':_0x324ef4(0x1bb),'token':null};}}}else return _0xa9e59b(_0x5cfc2b);}function timelyDecrypt(_0x2a294c,_0x4e75d2=!![]){const _0x4e28ce=_0x286343;if(_0x2a294c)try{const _0x42d910=crypt['decrypt'](secure[_0x4e28ce(0x2b0)],_0x2a294c)[_0x4e28ce(0x2ee)],_0x457fec=_0x42d910['split']('@')[0x0],_0xa7b4f7=_0x42d910[_0x4e28ce(0x1d7)]('@')[0x1],_0x3b8a63=new Date()[_0x4e28ce(0x231)]();if(_0x4e75d2){if(_0x3b8a63-_0xa7b4f7<maxSecretAge*0x3e8)return _0x457fec;else return![];}else return _0x457fec;}catch(_0x1fa2c9){return![];}else return![];}const validToken=(_0x248b0a,_0x557471)=>{const _0xfee9d7=_0x286343,_0x7784fe=devices[_0x557471]['ip'];if(!_0x248b0a)return{'error':_0xfee9d7(0x286)};for(let _0x23e0d6 of blacklist){if(_0x23e0d6[_0xfee9d7(0x2c7)]==_0x248b0a)return{'error':_0xfee9d7(0x1e6)};}let _0x5e7c15;try{_0x5e7c15=jwt[_0xfee9d7(0x1e5)](_0x248b0a,secure[_0xfee9d7(0x209)]+_0x557471);}catch{return{'error':_0xfee9d7(0x183)};}if(!_0x5e7c15[_0xfee9d7(0x1bf)](_0xfee9d7(0x2cb))&&!_0x5e7c15[_0xfee9d7(0x1bf)](_0xfee9d7(0x1d4))||!_0x5e7c15['hasOwnProperty'](_0xfee9d7(0x19b)))return{'error':_0xfee9d7(0x30f)};if(!_0x5e7c15['hasOwnProperty'](_0xfee9d7(0x1d4))&&_0x5e7c15[_0xfee9d7(0x1bf)](_0xfee9d7(0x2cb))){const {clientip:_0x5ce492}=_0x5e7c15;return _0x7784fe==_0x5ce492?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xfee9d7(0x258)};}else{if(_0x5e7c15[_0xfee9d7(0x1bf)](_0xfee9d7(0x1d4))&&_0x5e7c15['hasOwnProperty'](_0xfee9d7(0x2cb))){const {username:_0x14787e,clientip:_0x2d9d2e}=_0x5e7c15;return settings[_0xfee9d7(0x335)]==_0x14787e&&_0x7784fe==_0x2d9d2e?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xfee9d7(0x2cf)};}}},generateLoginToken=_0x244427=>{const _0x5bd486=_0x286343;if(_0x244427){const _0x41c702=devices[_0x244427]['ip'];return jwt[_0x5bd486(0x2c1)]({'username':settings['bbUsername'],'clientip':_0x41c702},secure['secret']+_0x244427,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2f38f8=>{const _0x30ce86=_0x286343;if(_0x2f38f8){const _0x57d662=devices[_0x2f38f8]['ip'];return jwt['sign']({'clientip':_0x57d662},secure[_0x30ce86(0x209)]+_0x2f38f8,{'expiresIn':devices[_0x2f38f8][_0x30ce86(0x328)][_0x30ce86(0x24f)]*0x3c});}else return![];},telegramIpApproved=_0x34be25=>{const _0x507c3f=_0x286343;let _0xfdb2b2=![];return devices[_0x34be25]['telegramIpApproval']&&devices[_0x34be25][_0x507c3f(0x328)]['expiry']!='reject'&&(_0xfdb2b2=devices[_0x34be25][_0x507c3f(0x328)][_0x507c3f(0x2cb)]==devices[_0x34be25]['ip']&&new Date()['getTime']()-devices[_0x34be25][_0x507c3f(0x328)][_0x507c3f(0x2df)]<devices[_0x34be25][_0x507c3f(0x328)][_0x507c3f(0x24f)]*0x3c*0x3e8),_0xfdb2b2;},telegram2FaApproved=_0x2aa99a=>{const _0x2ce02e=_0x286343;let _0x37ad0d=![];return devices[_0x2aa99a]['telegram2FaApproval']&&devices[_0x2aa99a][_0x2ce02e(0x2a4)][_0x2ce02e(0x24f)]!='reject'&&(_0x37ad0d=devices[_0x2aa99a][_0x2ce02e(0x2a4)]['clientip']==devices[_0x2aa99a]['ip']&&new Date()[_0x2ce02e(0x231)]()-devices[_0x2aa99a][_0x2ce02e(0x2a4)][_0x2ce02e(0x2df)]<devices[_0x2aa99a]['telegram2FaApproval'][_0x2ce02e(0x24f)]*0x3c*0x3e8),_0x37ad0d;},normalizeIP=_0x11bdd6=>{const _0x44576a=_0x286343;let _0x1e6d78=null,_0x108d44=null;if(ipaddr[_0x44576a(0x1c4)](_0x11bdd6)){const _0x4acb41=ipaddr[_0x44576a(0x1eb)](_0x11bdd6);_0x4acb41['kind']()===_0x44576a(0x259)?(_0x4acb41[_0x44576a(0x311)]()&&(_0x1e6d78=_0x4acb41[_0x44576a(0x301)]()[_0x44576a(0x18c)]()),_0x108d44=_0x4acb41['toString']()):(_0x1e6d78=_0x4acb41[_0x44576a(0x18c)](),_0x108d44=_0x4acb41[_0x44576a(0x274)]()['toString']());}return{'show':_0x1e6d78?_0x1e6d78:_0x108d44,'store':_0x108d44};};function formatDate(_0xc2b791){const _0x3e6f38=_0x286343;return _0xc2b791['getFullYear']()+'/'+(_0xc2b791['getMonth']()+0x1)[_0x3e6f38(0x18c)]()[_0x3e6f38(0x27b)](0x2,'0')+'/'+_0xc2b791[_0x3e6f38(0x294)]()[_0x3e6f38(0x18c)]()[_0x3e6f38(0x27b)](0x2,'0')+'\x20'+_0xc2b791[_0x3e6f38(0x1a9)]()[_0x3e6f38(0x18c)]()[_0x3e6f38(0x27b)](0x2,'0')+':'+_0xc2b791['getMinutes']()[_0x3e6f38(0x18c)]()['padStart'](0x2,'0')+':'+_0xc2b791[_0x3e6f38(0x20a)]()[_0x3e6f38(0x18c)]()['padStart'](0x2,'0');}function _0x461f(_0x1dd1b5,_0x13244f){const _0x3d2767=_0x275b();return _0x461f=function(_0x55d885,_0x5b3fa3){_0x55d885=_0x55d885-0x178;let _0x275b08=_0x3d2767[_0x55d885];return _0x275b08;},_0x461f(_0x1dd1b5,_0x13244f);}function sleep(_0x3d40e0){return new Promise(_0x49f1eb=>setTimeout(_0x49f1eb,_0x3d40e0));}