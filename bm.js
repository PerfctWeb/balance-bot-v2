function _0x150f(){const _0x8fed48=['resetHistory','-results.json','emitHistory','\x1b[35m','0.0.0','cancel-loading','getUTCHours','temporary\x20access\x20rejected','timeshift','status\x20code\x20401','Unauthorized\x20attempt\x20to\x20download\x20','ETH','You\x20can\x20use\x20the\x20following\x20commands:\x0a','config/','store-configuration','event','Starting\x20(','map','name','output-002.log','binary','Backup\x20file\x20unzipped\x20and\x20stored','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','test','rmSync','output-000.log','-events.json','Restore\x20backup\x20file\x20','getMonth','privateKey','/on\x20-\x20start\x20bot(s)\x0a','join','\x1b[0m','config','deleteHistoryAlerts','full','yargs/yargs','restore_no_','zip/','backup-files','\x1b[33m','SIGINT','sort','(((.+)+)+)+$','bot-','\x20-\x20','marketcapApi','invalid\x20credentials','bot','config_all','forEach','.zip','Yes','exchange','Server','loginRequired','mixpanel','telegramIpApproval','sha256','port','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','kill','All\x20bots','Unauthorized\x20attempt\x20to\x20get\x20events','Notifications\x20disabled','toggleBotMode','editMessageReplyMarkup','kind','getPortfolio',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','/:bot/performance','CoinMarketCap\x20API\x20key\x20validated','login\x20token\x20generated','hashSync','backup-full@','temporary\x20access\x20not\x20allowed','toString','Starting\x20new\x20bot\x20|\x20Bot\x20','inherit','Unauthorized\x20attempt\x20to\x20add\x20bot','text','/:bot/history','f2aRequired','get','entries','delete-alerts','success','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','/:bot/configuration','secret','off','login','getFullYear','uuid','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20update\x20bot','Error:\x20Invalid\x20argument\x20','uncaughtException','number','<b>Telegram\x20Bot\x20Status:</b>\x0a','Temporary\x20access\x20rejected','http','any','bb/','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','toggle_','backup/','headless','No\x20authentication\x20token','isDirectory','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','uuid-random','constructor','version.json','express-fileupload','enabled','handshake','send','RSA-OAEP','restart','conn','once','getSeconds','disable','pidRefreshToken','Password\x20reset\x20rejected','new','fork','2FA\x20login\x20required','1376620zFNoUQ','chat','update','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','lastmsgemitted','match','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','2FA\x20required','1167196ZdBDnL','logged\x20out','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','user','store-settings','build','accept','backup-full.zip','update-bb','pidExpireLogin','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','place-order','update_yes','socket.io','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','existsSync','Notifications\x20disabled\x0a','show','env','toggle-bot-mode','catch','reply','/start','timestamp','running','HTML','verify','username','whitelistEnabled','Invalid\x20IP\x20address','resetpw_no','started','family','bbvReceive','date-fns','sendMessage','/:bot/coins','alerts','Restore\x20process\x20confirmed','settings','https://api.ipify.org?format=json','blacklist','*$1*','onepagemode','lastmsgtelegram','crypto','getTime','store-headless','storeHeadless','stopped','DEFLATE','access','#RES#\x20','manual','/status\x20-\x20show\x20bot(s)\x20status\x0a','padStart','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','IPv4','string','private','tempaccess_5_','sendFile','telegraf','version','tkn','ipc','removeAllListeners','restore_yes_','store-fiat','bb-settings.json','output-001.log','lowdb','keys','***','bots','generateAsync','telegramUsername','decrypt','\x20(1)','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','live','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','params','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Node.js\x20v','assign','args','disconnect','versions','/off\x20-\x20stop\x20bot(s)\x0a','reset-history','Logged\x20in\x20user\x20...','emit','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','readFileSync','config_orders','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Session\x20expired\x20for\x20user\x20...','botmanager','Logged\x20out\x20user\x20...','loadAsync','Notifications\x20enabled','tempaccess_reject_','1119353UkFcHX','format','inlineKeyboard','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','logout','Orders','temporary\x20access\x20timeout','File\x20uploaded','sortBy','token','latestversion','telegramToken','util','internal','statSync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','reason','login\x20token\x20valid','type','temporaryAccessAllowed','Invalid\x20authentication\x20token\x20(1)','getStartingBalances','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','placeOrder','botID','set',',\x20must\x20be\x20a\x204\x20digit\x20number','button','bbPassword','botname','bcryptjs','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','find','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','isIPv4MappedAddress','Deleted\x20Bot\x20','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','warning','All','off_','output-003.log','************','action','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/download/:type','defaults',':\x20Bot\x20Mgr\x20>\x20','max','startsWith','metrics_','alias','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','publicKey','staging','sockets','reinstall_no','Starting\x20Balance\x20Bot\x20update','from','unlinkSync','writeFileSync','clientip','bbUsername','\x20|\x20','reinstall','All\x20bots\x20running\x20right\x20now','filter','5\x20min','range','Error\x20details:','temporary\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','#RES#\x20if\x20running\x20on\x20server','function','get-starting-balances','get-messages','settings.','bb-config.json','socket','tempaccess_30_','file','::ffff:127.0.0.1','restore-backup-file','<b>Balance\x20Bot\x20Status:</b>\x0a','login\x20not\x20required','/help\x20-\x20show\x20available\x20commands\x0a','remoteAddress','status','getMinutes','showConfig','sign','Access\x20enabled\x20for\x20','ipv6','reject','cloneDeep','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','3000','messages','Allow\x20login\x20from\x20IP\x20address\x20','SIGTERM','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','readdirSync','new-disabled','command','randomFillSync','apiPassword','bot.js','search','encryptedUuid','Unauthorized\x20attempt\x20to\x20update\x20settings','value','backup-full','disabled','all','write','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','/disable\x20-\x20disable\x20notifications\x0a','reload','telegramChatId','callback','secure','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','telegram','login\x20required','use','files','Notifications\x20enabled\x0a','\x20(2)','error','mode','node','apply','reset-password','=>\x20Go\x20to\x20#CYA#http://','-----------------------------------------------------------------------------------','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','-performance.json','3fserEb','mkdirSync','stringify','generateKeyPair','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','bb-secure.json','remove','(staging)','auto','19767280ykIsHL','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','includes','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','slice','get-portfolio','store','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','express','Unauthorized\x20attempt\x20to\x20store\x20configuration','logs/','listen','Your\x20installation\x20is\x20already\x20up\x20to\x20date','portfolio','exit','split','-config.json','2718DTKoTs','toIPv4MappedAddress','publicKeyToPem','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','reinstall_yes','parse','address','1000','telegramEnabled','Unauthorized\x20attempt\x20to\x20log\x20out','Login\x20accepted','connected','Idling\x20(','logs','data','Login\x20rejected','2FA\x20login\x20token\x20generated','help','lowdb/adapters/FileSync','BCT','privateKeyToPem','127.0.0.1','Unauthorized\x20attempt\x20to\x20get\x20messages','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','randomBytes','size','#RES#','telegramEvents','expiry','/update\x20-\x20update\x20Balance\x20Bot\x0a','userid','host','static','|@|','hex','restart_','environment',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Notifications\x20types:\x20',')\x20\x20\x20|\x20Bot\x20','endsWith','getDate','Restore\x20process\x20aborted','whitelist','telegrammsg','allow','No\x20bots\x20running\x20right\x20now','orders','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','backup','4724928smMKmY','Bot\x20','create','760fTxPYd','metrics','login2fa_reject_','order','NTBA_FIX_319','simple','access\x20timeout','hasOwnProperty','stop','copyFileSync','telegram2FaApproval','yes','login2fa_','headers','build2','async','add-bot','message','backupfile','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','/names\x20-\x20show\x20bot\x20names\x0a','title','[ip-address]','config_alerts','jsonwebtoken','notification','on_','getHours','cancelLoading','connection','/enable\x20-\x20enable\x20notifications\x0a','request','Markdown','length','Restarting\x20Bot\x20','replace','Ok,\x20will\x20send\x20alert\x20notifications\x20only','2FA','debug','createWriteStream','log','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Token\x20blacklisted','password','6b67f3d61ee94b8f5c80b4affef4c4d9','pki','Telegraf\x20error:','\x1b[31m','index.html','2FA\x20login\x20rejected','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Setting\x20access:\x20','103424vTCHAc','Error\x20while\x20deleting\x20config\x20files:\x20','push','_nsps','child_process','Restoring\x20bot(s)\x20from\x20backup','35lTSwEK','bbvNew','privateKeyFromPem','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?'];_0x150f=function(){return _0x8fed48;};return _0x150f();}const _0x3b3dcf=_0x156b;(function(_0x5431b1,_0x219f53){const _0x5c18d2=_0x156b,_0x178da3=_0x5431b1();while(!![]){try{const _0x2a1627=-parseInt(_0x5c18d2(0x35f))/0x1+parseInt(_0x5c18d2(0x2ed))/0x2+parseInt(_0x5c18d2(0x1df))/0x3*(-parseInt(_0x5c18d2(0x2f5))/0x4)+parseInt(_0x5c18d2(0x22e))/0x5*(-parseInt(_0x5c18d2(0x1f9))/0x6)+parseInt(_0x5c18d2(0x268))/0x7*(-parseInt(_0x5c18d2(0x262))/0x8)+-parseInt(_0x5c18d2(0x22b))/0x9+parseInt(_0x5c18d2(0x1e8))/0xa;if(_0x2a1627===_0x219f53)break;else _0x178da3['push'](_0x178da3['shift']());}catch(_0x1e9544){_0x178da3['push'](_0x178da3['shift']());}}}(_0x150f,0x915c6));const _0xa3089d=function(){let _0x4f5d19=!![];return function(_0x1db464,_0x2c6d97){const _0x130f42=_0x4f5d19?function(){const _0x7177a9=_0x156b;if(_0x2c6d97){const _0x32b74c=_0x2c6d97[_0x7177a9(0x1d7)](_0x1db464,arguments);return _0x2c6d97=null,_0x32b74c;}}:function(){};return _0x4f5d19=![],_0x130f42;};}(),_0x132a53=_0xa3089d(this,function(){const _0x40d30b=_0x156b;return _0x132a53['toString']()[_0x40d30b(0x1bf)](_0x40d30b(0x297))[_0x40d30b(0x2b8)]()[_0x40d30b(0x2dc)](_0x132a53)[_0x40d30b(0x1bf)]('(((.+)+)+)+$');});_0x132a53();'use strict';process[_0x3b3dcf(0x308)][_0x3b3dcf(0x232)]=0x1;const childProcess=require(_0x3b3dcf(0x266)),fs=require('fs'),fns=require(_0x3b3dcf(0x318)),low=require(_0x3b3dcf(0x33e)),FileSync=require(_0x3b3dcf(0x20b)),path=require('path'),crypto=require(_0x3b3dcf(0x323)),forge=require('node-forge'),bcrypt=require(_0x3b3dcf(0x37d)),jwt=require(_0x3b3dcf(0x246)),ipaddr=require('ipaddr.js'),argv=require(_0x3b3dcf(0x290))(process['argv']['slice'](0x2))['argv'],uuidRandom=require(_0x3b3dcf(0x2db)),{Telegraf,Markup}=require(_0x3b3dcf(0x335)),Mixpanel=require(_0x3b3dcf(0x2a4)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x3b3dcf(0x2de)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x3b3dcf(0x2a7)]||_0x3b3dcf(0x1b4),pattern=/^[0-9]{2,4}$/;!pattern[_0x3b3dcf(0x283)](PORT)&&(console[_0x3b3dcf(0x256)](_0x3b3dcf(0x2cc)+PORT+_0x3b3dcf(0x379)),process[_0x3b3dcf(0x1f6)](0x1));const HOST=argv[_0x3b3dcf(0x218)]||null,userID=argv[_0x3b3dcf(0x2f8)]||'',debugging=argv['d']||![],nodeversion=process[_0x3b3dcf(0x350)][_0x3b3dcf(0x1d6)];let bbpath=_0x3b3dcf(0x2d3),bbpath2='';const botfile=_0x3b3dcf(0x1be),configfile=_0x3b3dcf(0x1a1),settingsfile='bb-settings.json',securefile=_0x3b3dcf(0x1e4),environment=require('./'+bbpath2+_0x3b3dcf(0x2dd))[_0x3b3dcf(0x21d)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x3b3dcf(0x305)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x3b3dcf(0x279)+userID+'/':bbpath+_0x3b3dcf(0x279),configbackuppath=configpath+_0x3b3dcf(0x2d6),logspath=userID?bbpath+_0x3b3dcf(0x1f2)+userID+'/':bbpath+_0x3b3dcf(0x1f2),zippath=userID?bbpath+_0x3b3dcf(0x292)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x3b3dcf(0x255)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x3b3dcf(0x305)](configpath)&&fs[_0x3b3dcf(0x1e0)](configpath);!fs[_0x3b3dcf(0x305)](configbackuppath)&&fs[_0x3b3dcf(0x1e0)](configbackuppath);!fs[_0x3b3dcf(0x305)](logspath)&&fs[_0x3b3dcf(0x1e0)](logspath);!fs[_0x3b3dcf(0x305)](zippath)&&fs[_0x3b3dcf(0x1e0)](zippath);!fs[_0x3b3dcf(0x305)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3b3dcf(0x38c)]({'bots':[]})[_0x3b3dcf(0x1c6)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3b3dcf(0x38c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x3b3dcf(0x1c6)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x3b3dcf(0x1c6)]();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x3b3dcf(0x25a),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x3b3dcf(0x36a)]!=''&&settings[_0x3b3dcf(0x36a)]!='***')&&settings[_0x3b3dcf(0x343)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x3c52f6,_0x4d2427)=>{const _0x40c2af=_0x3b3dcf,_0x5c8c87=/#[A-Z]{3}#/g;if(typeof _0x3c52f6=='string'){!_0x4d2427?_0x3c52f6=_0x3c52f6['replace'](_0x5c8c87,''):(_0x3c52f6=_0x3c52f6[_0x40c2af(0x251)](/#BLU#/g,'\x1b[34m'),_0x3c52f6=_0x3c52f6['replace'](/#RED#/g,_0x40c2af(0x25d)),_0x3c52f6=_0x3c52f6[_0x40c2af(0x251)](/#YEL#/g,_0x40c2af(0x294)),_0x3c52f6=_0x3c52f6[_0x40c2af(0x251)](/#MAG#/g,_0x40c2af(0x26f)),_0x3c52f6=_0x3c52f6[_0x40c2af(0x251)](/#CYA#/g,'\x1b[36m'),_0x3c52f6=_0x3c52f6[_0x40c2af(0x251)](/#RES#/g,_0x40c2af(0x28c)));;}return _0x3c52f6;},logger={'screen':_0x4dff3e=>{const _0x184d89=_0x3b3dcf;console[_0x184d89(0x256)](parseColor(_0x4dff3e,!![]));},'simple':_0x48eab3=>{const _0x5036c2=_0x3b3dcf;console[_0x5036c2(0x256)](parseColor(_0x48eab3,!![])),loggerfile['write'](util[_0x5036c2(0x360)](parseColor(_0x48eab3,![]))+'\x0a');},'full':async _0x4b9c99=>{const _0x306fa1=_0x3b3dcf,_0x5c9a6f=getTimeStamp()+_0x306fa1(0x38d)+_0x4b9c99;console[_0x306fa1(0x256)](parseColor(_0x5c9a6f,!![])),loggerfile['write'](util['format'](parseColor(_0x5c9a6f,![]))+'\x0a');if(tgBot&&settings[_0x306fa1(0x1ca)]&&settings[_0x306fa1(0x214)]!='orders')await sendTelegram(settings[_0x306fa1(0x1ca)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x4b9c99,![]));},'debug':async(_0x364704,_0x5be257='')=>{const _0xf014b2=_0x3b3dcf,_0x3ec94e=getTimeStamp()+_0xf014b2(0x2b1)+_0x364704;if(debugging)console[_0xf014b2(0x256)](parseColor(_0x3ec94e,!![]));loggerfile[_0xf014b2(0x1c6)](util[_0xf014b2(0x360)](parseColor(_0x3ec94e,![]))+'\x0a');if(_0x5be257){if(debugging)console[_0xf014b2(0x256)](_0x5be257);loggerfile[_0xf014b2(0x1c6)](util[_0xf014b2(0x360)](_0x5be257)+'\x0a');}}};let terminating=![];process['on'](_0x3b3dcf(0x2cd),function(_0x162d2a){const _0x4da972=_0x3b3dcf;_0x162d2a['toString']()[_0x4da972(0x1ea)]('address\x20already\x20in\x20use')?(logger[_0x4da972(0x233)](_0x4da972(0x1e9)+_0x162d2a['port']+_0x4da972(0x213)),process[_0x4da972(0x2e1)]({'terminate':!![]},_0x4e4616=>{})):logger[_0x4da972(0x233)](_0x162d2a);}),process['on'](_0x3b3dcf(0x1f6),()=>{const _0x309bf1=_0x3b3dcf;stopAllBots(),process[_0x309bf1(0x1f6)](0x0);}),process['on'](_0x3b3dcf(0x1b7),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3b3dcf(0x295),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3b3dcf(0x2dd))[_0x3b3dcf(0x336)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3b3dcf(0x1f0)),app=express(),http=require(_0x3b3dcf(0x2d1))['createServer'](app);app[_0x3b3dcf(0x1d0)](fileUpload({'useTempFiles':!![]})),app[_0x3b3dcf(0x2bf)](_0x3b3dcf(0x38b),async(_0x3ed473,_0x994bca)=>{const _0x71244c=_0x3b3dcf,_0x5c23be=_0x3ed473[_0x71244c(0x34a)][_0x71244c(0x371)],_0x4026c4=getClientsWithBotID('botmanager'),_0x1b29e0=_0x3ed473[_0x71244c(0x23b)]['uuid'],_0x23731e=timelyDecrypt(_0x1b29e0,![]),_0xaef169=_0x4026c4[_0x71244c(0x37f)](_0x3f8598=>_0x3f8598[_0x71244c(0x2c9)]==_0x23731e);if(_0xaef169){const _0x13588a=normalizeIP(_0x3ed473[_0x71244c(0x1a2)][_0x71244c(0x1aa)])[_0x71244c(0x1ee)],_0x5ea6d0=_0x3ed473[_0x71244c(0x23b)]['tkn'];if(validateAccess(_0x5ea6d0,_0x23731e,_0x13588a)['allow'])_0x5c23be==_0x71244c(0x22a)&&await backupConfigFiles(),await zipFiles(_0x5c23be),_0x994bca['download'](zippath+(_0x5c23be+_0x71244c(0x29f)),_0x541d8d=>{_0x541d8d&&(logger['full']('Failed\x20to\x20download\x20'+_0x5c23be),logger['simple'](_0x541d8d));});else logger[_0x71244c(0x28f)](_0x71244c(0x276)+_0x5c23be+_0x71244c(0x345));}else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x5c23be+_0x71244c(0x1d3));}),app['post']('/upload-backup',async(_0x4a2f76,_0x76baf0)=>{const _0x189912=_0x3b3dcf,_0x553a64=getClientsWithBotID(_0x189912(0x35a)),_0x37e4d4=_0x4a2f76['headers'][_0x189912(0x2c9)],_0x413054=timelyDecrypt(_0x37e4d4,![]),_0x4011fe=_0x553a64['find'](_0x3ab254=>_0x3ab254[_0x189912(0x2c9)]==_0x413054);logger[_0x189912(0x254)]('Backup\x20file\x20uploaded');if(_0x4011fe){const _0x195544=normalizeIP(_0x4a2f76[_0x189912(0x1a2)][_0x189912(0x1aa)])[_0x189912(0x1ee)],_0xf57705=_0x4a2f76[_0x189912(0x23b)][_0x189912(0x337)];if(validateAccess(_0xf57705,_0x413054,_0x195544)[_0x189912(0x226)]){if(_0x4a2f76[_0x189912(0x1d1)]){const _0x52efdf=_0x4a2f76['files'][_0x189912(0x240)];await _0x52efdf['mv'](temppath+_0x52efdf['name']),_0x76baf0[_0x189912(0x2e1)]({'status':!![],'message':_0x189912(0x366)});const _0x36e02f=getBotsWithMode();_0x36e02f[_0x189912(0x24f)]>0x0?confirmRestore(temppath,_0x52efdf[_0x189912(0x27e)]):unzipFile(temppath,_0x52efdf[_0x189912(0x27e)]);}}else logger[_0x189912(0x28f)](_0x189912(0x358));}else logger[_0x189912(0x28f)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x3b3dcf(0x1d0)](express[_0x3b3dcf(0x219)](path[_0x3b3dcf(0x28b)](__dirname,bbpath2,_0x3b3dcf(0x23c)))),app[_0x3b3dcf(0x1d0)](express[_0x3b3dcf(0x219)](path[_0x3b3dcf(0x28b)](__dirname,bbpath2,_0x3b3dcf(0x2fa)))),app[_0x3b3dcf(0x2bf)]('/',function(_0x56d6f3,_0x406e60){const _0x5bafc5=_0x3b3dcf;_0x406e60[_0x5bafc5(0x334)](path[_0x5bafc5(0x28b)](__dirname,bbpath2,_0x5bafc5(0x23c),_0x5bafc5(0x25e)));}),app[_0x3b3dcf(0x2bf)]('/:bot',function(_0x3b958c,_0x177791){const _0x33b089=_0x3b3dcf;_0x177791[_0x33b089(0x334)](path[_0x33b089(0x28b)](__dirname,bbpath2,_0x33b089(0x2fa),_0x33b089(0x25e)));}),app[_0x3b3dcf(0x2bf)]('/:bot/portfolio',(_0x13ce97,_0x17e141)=>{const _0x4a511e=_0x3b3dcf;_0x17e141[_0x4a511e(0x334)](path[_0x4a511e(0x28b)](__dirname,bbpath2,'build',_0x4a511e(0x25e)));}),app['get'](_0x3b3dcf(0x2b2),(_0x5b6ae3,_0x5da980)=>{const _0x29342=_0x3b3dcf;_0x5da980[_0x29342(0x334)](path[_0x29342(0x28b)](__dirname,bbpath2,_0x29342(0x2fa),'index.html'));}),app['get'](_0x3b3dcf(0x31a),(_0x160257,_0x45d9e1)=>{const _0x11dee5=_0x3b3dcf;_0x45d9e1[_0x11dee5(0x334)](path[_0x11dee5(0x28b)](__dirname,bbpath2,_0x11dee5(0x2fa),_0x11dee5(0x25e)));}),app[_0x3b3dcf(0x2bf)](_0x3b3dcf(0x2bd),(_0x4e3293,_0x23f3c8)=>{const _0x4db343=_0x3b3dcf;_0x23f3c8[_0x4db343(0x334)](path[_0x4db343(0x28b)](__dirname,bbpath2,_0x4db343(0x2fa),_0x4db343(0x25e)));}),app[_0x3b3dcf(0x2bf)](_0x3b3dcf(0x2c4),(_0x5874e4,_0x2271a9)=>{const _0x5a1907=_0x3b3dcf;_0x2271a9[_0x5a1907(0x334)](path[_0x5a1907(0x28b)](__dirname,bbpath2,'build',_0x5a1907(0x25e)));}),app[_0x3b3dcf(0x2bf)]('/:bot/support',(_0x4b9219,_0xa6f988)=>{const _0x226365=_0x3b3dcf;_0xa6f988[_0x226365(0x334)](path[_0x226365(0x28b)](__dirname,bbpath2,_0x226365(0x2fa),_0x226365(0x25e)));});if(HOST)http[_0x3b3dcf(0x1f3)](PORT,HOST);else http[_0x3b3dcf(0x1f3)](PORT);const io=require(_0x3b3dcf(0x302))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x455e14=_0x3b3dcf;let _0x59e4a5=_0x455e14(0x244);const _0x790ae5=networkInterfaces(),_0x5b5f8f={};for(const _0x5b6df0 of Object['keys'](_0x790ae5)){for(const _0x24f5cb of _0x790ae5[_0x5b6df0]){if((_0x24f5cb[_0x455e14(0x316)]==_0x455e14(0x330)||_0x24f5cb['family']==0x4)&&!_0x24f5cb[_0x455e14(0x36c)]){const _0x9c17a0=ipaddr[_0x455e14(0x1fe)](_0x24f5cb[_0x455e14(0x1ff)])[_0x455e14(0x198)]();_0x9c17a0!=_0x455e14(0x332)&&(!_0x5b5f8f[_0x5b6df0]&&(_0x5b5f8f[_0x5b6df0]=[]),_0x5b5f8f[_0x5b6df0][_0x455e14(0x264)](_0x24f5cb[_0x455e14(0x1ff)]),_0x59e4a5=_0x24f5cb[_0x455e14(0x1ff)]);}}}return{'serverip':_0x59e4a5,'netinterfaces':_0x5b5f8f};}async function startServer(){const _0x317030=_0x3b3dcf,{serverip:_0x3b2f57,netinterfaces:_0x1912b1}=getServerIP();logger[_0x317030(0x233)](''),logger[_0x317030(0x233)](_0x317030(0x1da)),await logger[_0x317030(0x28f)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x317030(0x32a)+(environment==_0x317030(0x394)?_0x317030(0x1e6):'')+'\x0a'+(_0x317030(0x380)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x317030(0x1d9)+_0x3b2f57+':'+PORT+_0x317030(0x19c))),logger[_0x317030(0x233)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x21b1b6 of config){const _0x5ca129=_0x21b1b6[_0x317030(0x1d5)]==_0x317030(0x1e7)?'a':'m';if(_0x21b1b6[_0x317030(0x1ab)]==_0x317030(0x2df)||_0x21b1b6['status']==_0x317030(0x2ea))await logger['full'](_0x317030(0x27c)+_0x5ca129+')\x20|\x20Bot\x20'+_0x21b1b6['botID']+_0x317030(0x193)+_0x21b1b6[_0x317030(0x37c)]),startBot([_0x21b1b6[_0x317030(0x377)],userID],{'cwd':bbpath},function(_0x5e5ae9){const _0x169910=_0x317030;if(_0x5e5ae9)logger[_0x169910(0x28f)](_0x5e5ae9);});else(_0x21b1b6[_0x317030(0x1ab)]==_0x317030(0x1c4)||_0x21b1b6['status']==_0x317030(0x1ba))&&await logger[_0x317030(0x28f)](_0x317030(0x205)+_0x5ca129+_0x317030(0x220)+_0x21b1b6[_0x317030(0x377)]+_0x317030(0x193)+_0x21b1b6[_0x317030(0x37c)]);}else!newBot&&logger['simple'](_0x317030(0x348));if(newBot)addBot();logger[_0x317030(0x233)](_0x317030(0x1da)),logger['simple'](''),await logger['debug'](_0x317030(0x34c)+nodeversion),await logger[_0x317030(0x254)]('Network\x20Interfaces:',_0x1912b1);}function startSocket(){const _0x677e27=_0x3b3dcf;io['on'](_0x677e27(0x24b),_0xd1a3af=>{const _0x1ddf2d=_0x677e27;let _0x193e90,_0x28358b,_0x44e17f,_0x2bbb5f,_0x201f07;const _0x5ded8d=_0xd1a3af[_0x1ddf2d(0x2e0)]['headers']['referer'];_0x28358b=_0x5ded8d['match'](/bot[0-9]{3}/);if(_0x28358b)_0x44e17f=_0x28358b[0x0][_0x1ddf2d(0x2f2)](/[0-9]{3}/);if(_0x44e17f)_0x193e90=_0x44e17f[0x0];else _0x193e90=_0x1ddf2d(0x35a);const _0x599583=_0xd1a3af['handshake']['auth'][_0x1ddf2d(0x1c0)];if(!_0x599583)_0xd1a3af[_0x1ddf2d(0x354)](_0x1ddf2d(0x1ab),{'publicKey':secure[_0x1ddf2d(0x393)]});else{_0x2bbb5f=timelyDecrypt(_0x599583,![]);if(!_0x2bbb5f)_0xd1a3af['emit']('status',{'publicKey':secure[_0x1ddf2d(0x393)]});else{_0x201f07=normalizeIP(_0xd1a3af[_0x1ddf2d(0x2e4)][_0x1ddf2d(0x1aa)])[_0x1ddf2d(0x1ee)];if(!devices[_0x2bbb5f])devices[_0x2bbb5f]={'uuid':_0x2bbb5f,'access':{'token':null}};devices[_0x2bbb5f]['ip']=_0x201f07;const _0x24617f=addClient(_0xd1a3af['id'],_0x2bbb5f,_0x193e90);setAccess(_0x24617f),emitMessages(),_0xd1a3af['on'](_0x1ddf2d(0x2c7),_0x594dc3=>{const _0x23eab=_0x1ddf2d,_0x35aa57=timelyDecrypt(_0x594dc3[_0x23eab(0x259)],!![],'|@|');if(_0x35aa57){_0x594dc3={'username':_0x594dc3[_0x23eab(0x311)],'password':_0x35aa57},devices[_0x2bbb5f][_0x23eab(0x329)]=validateCredentials(_0x594dc3,_0x2bbb5f);if(devices[_0x2bbb5f][_0x23eab(0x329)][_0x23eab(0x226)]==![]&&devices[_0x2bbb5f][_0x23eab(0x329)][_0x23eab(0x36f)]==_0x23eab(0x2ec))_0xd1a3af[_0x23eab(0x354)](_0x23eab(0x1ab),{'access':devices[_0x2bbb5f]['access']}),loginAccess2FA(_0x2bbb5f,_0x201f07);else{if(devices[_0x2bbb5f][_0x23eab(0x329)][_0x23eab(0x226)]==![]&&devices[_0x2bbb5f]['access'][_0x23eab(0x36f)]==_0x23eab(0x29b))_0xd1a3af[_0x23eab(0x354)](_0x23eab(0x1ab),{'access':devices[_0x2bbb5f]['access']});else devices[_0x2bbb5f][_0x23eab(0x329)][_0x23eab(0x226)]&&devices[_0x2bbb5f][_0x23eab(0x329)][_0x23eab(0x36f)]==_0x23eab(0x2b4)&&(getClientsWithUuid(_0x2bbb5f)['forEach'](_0x2cd526=>{setAccess(_0x2cd526);}),logger[_0x23eab(0x254)](_0x23eab(0x353)+_0x2bbb5f[_0x23eab(0x1ec)](-0x8)),setTokenRefresh(_0x2bbb5f),setSessionTimeout(_0x23eab(0x2c7),_0x2bbb5f));}}else logger[_0x23eab(0x28f)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0xd1a3af['on'](_0x1ddf2d(0x1d8),()=>{resetPassword();}),_0xd1a3af['on']('disconnect',_0xca46b6=>{removeClient(_0xd1a3af['id']);}),_0x193e90=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x481bb7){const _0x8e4edf=_0x3b3dcf;if(_0x481bb7!=_0x8e4edf(0x35a)&&config['apiKey']!=''){if(pid[_0x481bb7])pid[_0x481bb7][_0x8e4edf(0x2e1)]({'function':'initclient','args':null});}_0x481bb7!=_0x8e4edf(0x35a)&&broadcastToBots(_0x8e4edf(0x341),JSON[_0x8e4edf(0x1e1)](config));}function reloadBotManager(){const _0x43b2d9=_0x3b3dcf;getClientsWithBotID(_0x43b2d9(0x35a))[_0x43b2d9(0x29e)](_0x9aea2f=>{const _0x553c33=_0x43b2d9;getSocket(_0x9aea2f['id'])[_0x553c33(0x354)](_0x553c33(0x1ab),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x2f52d9){const _0x1382e9=_0x3b3dcf,_0x7fac6b=io[_0x1382e9(0x265)]['get']('/');return _0x7fac6b[_0x1382e9(0x395)][_0x1382e9(0x2bf)](_0x2f52d9);}function setAccess(_0x138977){const _0x739455=_0x3b3dcf,_0x8a7556=getSocket(_0x138977['id']),_0xb9fe97=_0x138977[_0x739455(0x2c9)],_0x39ccfe=_0x138977[_0x739455(0x29c)];devices[_0xb9fe97][_0x739455(0x329)]=validateAccess(devices[_0xb9fe97]['access'][_0x739455(0x368)],_0xb9fe97),logger[_0x739455(0x254)](_0x739455(0x261)+devices[_0xb9fe97][_0x739455(0x329)][_0x739455(0x36f)]+'\x20|\x20client:\x20...'+_0x138977['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0xb9fe97['slice'](-0x8)),_0x8a7556[_0x739455(0x28b)](_0xb9fe97);if(devices[_0xb9fe97][_0x739455(0x329)][_0x739455(0x226)]){_0x8a7556[_0x739455(0x28b)](_0x39ccfe);if(_0x39ccfe==_0x739455(0x35a))initializeSocketBotManager(_0x8a7556);else initializeSocketBot(_0x8a7556);initClient(_0x39ccfe);}devices[_0xb9fe97][_0x739455(0x329)][_0x739455(0x368)]&&devices[_0xb9fe97]['access']['reason']==_0x739455(0x19a)&&setSessionTimeout(_0x739455(0x253),_0xb9fe97),devices[_0xb9fe97][_0x739455(0x329)][_0x739455(0x368)]&&devices[_0xb9fe97]['access']['reason']==_0x739455(0x209)&&setSessionTimeout(_0x739455(0x2c7),_0xb9fe97),_0x8a7556[_0x739455(0x354)](_0x739455(0x1ab),{'status':_0x138977['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xb9fe97][_0x739455(0x329)],'externalip':devices[_0xb9fe97]['ip'],'publicKey':secure[_0x739455(0x393)],'userid':settings[_0x739455(0x217)],'validInstallation':validInstallation}),devices[_0xb9fe97][_0x739455(0x329)][_0x739455(0x226)]==![]&&devices[_0xb9fe97][_0x739455(0x329)][_0x739455(0x36f)]=='2FA\x20required'&&temporaryAccess2FA(_0xb9fe97,devices[_0xb9fe97]['ip']);}function setSessionTimeout(_0x4a129f,_0x2d17c7){const _0x4f6ecb=_0x3b3dcf;let _0x52a33a;if(_0x4a129f==_0x4f6ecb(0x2c7))_0x52a33a=loginExpiry*0x3c*0x3e8;else _0x52a33a=devices[_0x2d17c7][_0x4f6ecb(0x2a5)][_0x4f6ecb(0x215)]*0x3c*0x3e8-(new Date()[_0x4f6ecb(0x324)]()-devices[_0x2d17c7][_0x4f6ecb(0x2a5)]['timestamp']);if(devices[_0x2d17c7][_0x4f6ecb(0x2fe)])clearTimeout(devices[_0x2d17c7][_0x4f6ecb(0x2fe)]);devices[_0x2d17c7]['pidExpireLogin']=setTimeout(()=>{const _0x140ac9=_0x4f6ecb;if(devices[_0x2d17c7]['pidRefreshToken'])clearTimeout(devices[_0x2d17c7]['pidRefreshToken']);removeSocketListeners(_0x2d17c7),addBlacklist(_0x2d17c7),devices[_0x2d17c7][_0x140ac9(0x2a5)]=null,devices[_0x2d17c7][_0x140ac9(0x238)]=null,devices[_0x2d17c7]['access'][_0x140ac9(0x368)]=null,logger[_0x140ac9(0x254)](_0x140ac9(0x359)+_0x2d17c7[_0x140ac9(0x1ec)](-0x8)),devices[_0x2d17c7][_0x140ac9(0x329)]=validateAccess(devices[_0x2d17c7]['access'][_0x140ac9(0x368)],_0x2d17c7),!(devices[_0x2d17c7][_0x140ac9(0x329)][_0x140ac9(0x226)]&&devices[_0x2d17c7][_0x140ac9(0x329)][_0x140ac9(0x36f)]==_0x140ac9(0x1a8))&&(_0x4a129f==_0x140ac9(0x2c7)?io['to'](_0x2d17c7)[_0x140ac9(0x354)]('status',{'access':{'allow':![],'reason':_0x140ac9(0x234),'token':null}}):io['to'](_0x2d17c7)[_0x140ac9(0x354)](_0x140ac9(0x1ab),{'access':{'allow':![],'reason':_0x140ac9(0x365),'token':null}})),devices[_0x2d17c7][_0x140ac9(0x329)][_0x140ac9(0x368)]=null;},_0x52a33a);}function setTokenRefresh(_0x2782de){const _0x13f195=_0x3b3dcf;if(devices[_0x2782de][_0x13f195(0x2e8)])clearTimeout(devices[_0x2782de][_0x13f195(0x2e8)]);devices[_0x2782de]['pidRefreshToken']=setTimeout(()=>{const _0x100c37=_0x13f195;getClientsWithUuid(_0x2782de)['length']!=0x0?(devices[_0x2782de][_0x100c37(0x329)]=refreshToken(_0x2782de),io['to'](_0x2782de)[_0x100c37(0x354)](_0x100c37(0x1ab),{'status':_0x100c37(0x204),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2782de][_0x100c37(0x329)],'externalip':devices[_0x2782de]['ip'],'publicKey':secure[_0x100c37(0x393)],'validInstallation':validInstallation}),setTokenRefresh(_0x2782de)):clearTimeout(devices[_0x2782de][_0x100c37(0x2e8)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4fa9c9){const _0x4a56cc=_0x3b3dcf,_0x38d542=getClient(_0x4fa9c9['id'])[_0x4a56cc(0x2c9)];_0x4fa9c9['emit'](_0x4a56cc(0x341),config),_0x4fa9c9[_0x4a56cc(0x354)](_0x4a56cc(0x31d),cleanSettings()),_0x4fa9c9['on'](_0x4a56cc(0x23e),_0x12753d=>{const _0xec9cf=_0x4a56cc;if(validateAccess(_0x12753d,_0x38d542)[_0xec9cf(0x226)])addBot();else logger[_0xec9cf(0x28f)](_0xec9cf(0x2bb));}),_0x4fa9c9['on']('update-bot',(_0x1119e0,_0x35a0b9)=>{const _0x4bb9fa=_0x4a56cc;if(validateAccess(_0x35a0b9,_0x38d542)[_0x4bb9fa(0x226)])toggleBot(_0x1119e0[_0x4bb9fa(0x377)],_0x1119e0[_0x4bb9fa(0x1ab)],_0x1119e0['live']);else logger['full'](_0x4bb9fa(0x2cb));}),_0x4fa9c9['on'](_0x4a56cc(0x309),(_0x4a73d,_0x47b85c)=>{const _0x40ee53=_0x4a56cc;if(validateAccess(_0x47b85c,_0x38d542)[_0x40ee53(0x226)])toggleBotMode(_0x4a73d);else logger[_0x40ee53(0x28f)](_0x40ee53(0x2cb));}),_0x4fa9c9['on']('delete-bot',(_0x238e1c,_0x55c041)=>{const _0x50a6a=_0x4a56cc;if(validateAccess(_0x55c041,_0x38d542)[_0x50a6a(0x226)])deleteBot(_0x238e1c);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4fa9c9['on'](_0x4a56cc(0x2f9),(_0x361415,_0x12f246)=>{const _0xc34d07=_0x4a56cc;if(validateAccess(_0x12f246,_0x38d542)[_0xc34d07(0x226)])storeSettings(_0x361415,!![]);else logger['full'](_0xc34d07(0x1c1));}),_0x4fa9c9['on'](_0x4a56cc(0x2fd),_0x4cf0cc=>{const _0x132873=_0x4a56cc;if(validateAccess(_0x4cf0cc,_0x38d542)[_0x132873(0x226)])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4fa9c9['on']('reinstall-bb',_0x2b410d=>{const _0x2bf501=_0x4a56cc;if(validateAccess(_0x2b410d,_0x38d542)[_0x2bf501(0x226)])updateBB(_0x2bf501(0x194));else logger[_0x2bf501(0x28f)](_0x2bf501(0x346));}),_0x4fa9c9['on']('get-backup-files',_0x3bf065=>{const _0x3b660e=_0x4a56cc;if(validateAccess(_0x3bf065,_0x38d542)['allow']){const _0x3671ba=getClient(_0x4fa9c9['id']);if(_0x3671ba)getBackupFiles(_0x3671ba[_0x3b660e(0x2c9)]);else logger[_0x3b660e(0x28f)](_0x3b660e(0x362));}else logger[_0x3b660e(0x28f)](_0x3b660e(0x392));}),_0x4fa9c9['on'](_0x4a56cc(0x1a6),(_0x59d6d,_0xb35af1)=>{const _0x236305=_0x4a56cc;if(validateAccess(_0xb35af1,_0x38d542)['allow'])restoreBackupFile(_0x59d6d);else logger['full'](_0x236305(0x304));}),_0x4fa9c9['on'](_0x4a56cc(0x19f),_0x48d85f=>{const _0x21713f=_0x4a56cc;if(validateAccess(_0x48d85f,_0x38d542)[_0x21713f(0x226)])getMessages();else logger[_0x21713f(0x28f)](_0x21713f(0x20f));}),_0x4fa9c9['on']('confirm-message',(_0x2b0d26,_0x3ddb5a)=>{const _0x4d2c5b=_0x4a56cc;if(validateAccess(_0x3ddb5a,_0x38d542)[_0x4d2c5b(0x226)])confirmMessage(_0x2b0d26);else logger[_0x4d2c5b(0x28f)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4fa9c9['on']('logout',_0x490c83=>{const _0x5c9354=_0x4a56cc;if(validateAccess(_0x490c83,_0x38d542)[_0x5c9354(0x226)]){if(devices[_0x38d542][_0x5c9354(0x2e8)])clearTimeout(devices[_0x38d542][_0x5c9354(0x2e8)]);if(devices[_0x38d542][_0x5c9354(0x2fe)])clearTimeout(devices[_0x38d542][_0x5c9354(0x2fe)]);removeSocketListeners(getClient(_0x4fa9c9['id'])[_0x5c9354(0x2c9)]),addBlacklist(_0x38d542),devices[_0x38d542]['telegramIpApproval']=null,devices[_0x38d542][_0x5c9354(0x238)]=null,devices[_0x38d542][_0x5c9354(0x329)][_0x5c9354(0x368)]=null,logger[_0x5c9354(0x254)](_0x5c9354(0x35b)+_0x38d542[_0x5c9354(0x1ec)](-0x8)),io['to'](getClient(_0x4fa9c9['id'])[_0x5c9354(0x2c9)])[_0x5c9354(0x354)](_0x5c9354(0x1ab),{'access':{'allow':![],'reason':_0x5c9354(0x2f6),'token':null}});}else logger[_0x5c9354(0x28f)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x42f724){const _0x4d54fa=_0x3b3dcf,_0x129601=getClient(_0x42f724['id'])[_0x4d54fa(0x29c)],_0x100ce3=getClient(_0x42f724['id'])['uuid'];_0x42f724['on']('get-logs',(_0x95f90d,_0x58fe3b)=>{const _0x2af955=_0x4d54fa;if(validateAccess(_0x58fe3b,_0x100ce3)['allow']){if(pid[_0x129601])pid[_0x129601][_0x2af955(0x2e1)]({'function':_0x2af955(0x26e),'args':_0x95f90d});}else logger['full'](_0x2af955(0x2ab));}),_0x42f724['on'](_0x4d54fa(0x2c1),(_0x4133e4,_0x1abd16)=>{const _0x1d1595=_0x4d54fa;if(validateAccess(_0x1abd16,_0x100ce3)[_0x1d1595(0x226)]){if(pid[_0x129601])pid[_0x129601][_0x1d1595(0x2e1)]({'function':_0x1d1595(0x28e),'args':_0x4133e4});}else logger[_0x1d1595(0x28f)](_0x1d1595(0x38a));}),_0x42f724['on'](_0x4d54fa(0x1ed),(_0x3d2a73,_0x624f49)=>{const _0x33be10=_0x4d54fa;if(validateAccess(_0x624f49,_0x100ce3)[_0x33be10(0x226)]){if(pid[_0x129601])pid[_0x129601][_0x33be10(0x2e1)]({'function':_0x33be10(0x2b0),'args':_0x3d2a73});}else logger[_0x33be10(0x28f)](_0x33be10(0x1dc));}),_0x42f724['on'](_0x4d54fa(0x27a),(_0x274185,_0x471307)=>{const _0x475e86=_0x4d54fa;if(validateAccess(_0x471307,_0x100ce3)['allow']){if(pid[_0x129601])pid[_0x129601][_0x475e86(0x2e1)]({'function':'storeConfiguration','args':_0x274185});}else logger[_0x475e86(0x28f)](_0x475e86(0x1f1));}),_0x42f724['on'](_0x4d54fa(0x325),(_0x43c6af,_0x3b621b)=>{const _0x2d763b=_0x4d54fa;if(validateAccess(_0x3b621b,_0x100ce3)['allow']){if(pid[_0x129601])pid[_0x129601][_0x2d763b(0x2e1)]({'function':_0x2d763b(0x326),'args':_0x43c6af});}else logger[_0x2d763b(0x28f)](_0x2d763b(0x229));}),_0x42f724['on'](_0x4d54fa(0x33b),(_0x1cdcca,_0x3dccd5)=>{const _0x487b50=_0x4d54fa;if(validateAccess(_0x3dccd5,_0x100ce3)[_0x487b50(0x226)]){if(pid[_0x129601])pid[_0x129601][_0x487b50(0x2e1)]({'function':'storeFiat','args':_0x1cdcca});}else logger[_0x487b50(0x28f)](_0x487b50(0x2d4));}),_0x42f724['on'](_0x4d54fa(0x352),_0x35b036=>{const _0x2ce484=_0x4d54fa;if(validateAccess(_0x35b036,_0x100ce3)[_0x2ce484(0x226)]){if(pid[_0x129601])pid[_0x129601]['send']({'function':_0x2ce484(0x26c),'args':null});}else logger[_0x2ce484(0x28f)](_0x2ce484(0x1e3));}),_0x42f724['on'](_0x4d54fa(0x19e),_0x3b3fdd=>{const _0x241c00=_0x4d54fa;if(validateAccess(_0x3b3fdd,_0x100ce3)[_0x241c00(0x226)]){if(pid[_0x129601])pid[_0x129601][_0x241c00(0x2e1)]({'function':_0x241c00(0x374),'args':null});}else logger[_0x241c00(0x28f)](_0x241c00(0x2da));}),_0x42f724['on'](_0x4d54fa(0x300),(_0xcceb8e,_0x1aa7a3)=>{const _0x10a3fa=_0x4d54fa;if(validateAccess(_0x1aa7a3,_0x100ce3)[_0x10a3fa(0x226)]){if(pid[_0x129601])pid[_0x129601][_0x10a3fa(0x2e1)]({'function':_0x10a3fa(0x376),'args':_0xcceb8e});}else logger[_0x10a3fa(0x28f)](_0x10a3fa(0x1eb));}),_0x42f724['on'](_0x4d54fa(0x271),_0x45fb8a=>{const _0x33559a=_0x4d54fa;if(validateAccess(_0x45fb8a,_0x100ce3)[_0x33559a(0x226)]){if(pid[_0x129601])pid[_0x129601][_0x33559a(0x2e1)]({'function':_0x33559a(0x24a),'args':null});}else logger[_0x33559a(0x28f)](_0x33559a(0x1dd));}),_0x42f724['on']('show-config',_0x1fe646=>{const _0x38a29c=_0x4d54fa;if(validateAccess(_0x1fe646,_0x100ce3)['allow']){if(pid[_0x129601])pid[_0x129601][_0x38a29c(0x2e1)]({'function':_0x38a29c(0x1ad),'args':null});}else logger[_0x38a29c(0x28f)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x42f724['on'](_0x4d54fa(0x2fd),_0x70548d=>{const _0x368d6c=_0x4d54fa;if(validateAccess(_0x70548d,_0x100ce3)[_0x368d6c(0x226)])updateBB('update');else logger[_0x368d6c(0x28f)](_0x368d6c(0x1b3));}),_0x42f724['on'](_0x4d54fa(0x19f),_0x307a37=>{const _0x6992c2=_0x4d54fa;if(validateAccess(_0x307a37,_0x100ce3)[_0x6992c2(0x226)])getMessages();else logger[_0x6992c2(0x28f)](_0x6992c2(0x20f));}),_0x42f724['on']('confirm-message',(_0x2a7270,_0x30e4a5)=>{const _0x4de2b2=_0x4d54fa;if(validateAccess(_0x30e4a5,_0x100ce3)[_0x4de2b2(0x226)])confirmMessage(_0x2a7270);else logger[_0x4de2b2(0x28f)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x42f724['on'](_0x4d54fa(0x363),_0x2026b8=>{const _0x253589=_0x4d54fa;if(validateAccess(_0x2026b8,_0x100ce3)['allow']){if(devices[_0x100ce3]['pidRefreshToken'])clearTimeout(devices[_0x100ce3][_0x253589(0x2e8)]);if(devices[_0x100ce3][_0x253589(0x2fe)])clearTimeout(devices[_0x100ce3][_0x253589(0x2fe)]);removeSocketListeners(getClient(_0x42f724['id'])['uuid']),addBlacklist(_0x100ce3),devices[_0x100ce3][_0x253589(0x2a5)]=null,devices[_0x100ce3][_0x253589(0x238)]=null,devices[_0x100ce3][_0x253589(0x329)][_0x253589(0x368)]=null,logger[_0x253589(0x254)]('Logged\x20out\x20user\x20...'+_0x100ce3['slice'](-0x8)),io['to'](getClient(_0x42f724['id'])[_0x253589(0x2c9)])['emit'](_0x253589(0x1ab),{'access':{'allow':![],'reason':_0x253589(0x2f6),'token':null}});}else logger['full'](_0x253589(0x202));});}function removeSocketListeners(_0x4bae27){const _0x9740e2=_0x3b3dcf;getClientsWithUuid(_0x4bae27)[_0x9740e2(0x29e)](_0x73a412=>{const _0x17d48c=_0x9740e2;getSocket(_0x73a412['id'])[_0x17d48c(0x339)]();});}function cleanSettings(){const _0x4ae688=_0x3b3dcf;let _0x1e4e3a=settings;return settings[_0x4ae688(0x36a)]&&settings[_0x4ae688(0x36a)]!=''&&(_0x1e4e3a={..._0x1e4e3a,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x4ae688(0x37b)]!=''&&(_0x1e4e3a={..._0x1e4e3a,'bbPassword':_0x4ae688(0x388)}),settings['marketcapApi']&&settings['marketcapApi']!=''&&(_0x1e4e3a={..._0x1e4e3a,'marketcapApi':'************'}),(settings[_0x4ae688(0x37b)]&&settings[_0x4ae688(0x37b)]==_0x4ae688(0x340)||settings['telegramToken']&&settings[_0x4ae688(0x36a)]==_0x4ae688(0x340)||settings[_0x4ae688(0x29a)]&&settings[_0x4ae688(0x29a)]==_0x4ae688(0x340))&&(_0x1e4e3a={..._0x1e4e3a,'restored':{'password':settings[_0x4ae688(0x37b)]=='***','telegram':settings[_0x4ae688(0x36a)]==_0x4ae688(0x340),'marketcap':settings['marketcapApi']==_0x4ae688(0x340)}}),_0x1e4e3a;}async function updateBB(_0xe7fa41){const _0x1ceddc=_0x3b3dcf;await backupConfigFiles(),installingUpdate=!![],config[_0x1ceddc(0x29e)](_0x4f5164=>{const _0x9d5235=_0x1ceddc;restartBot(_0x4f5164[_0x9d5235(0x377)]);});if(_0xe7fa41==_0x1ceddc(0x2ef))process[_0x1ceddc(0x2e1)]({'update':!![],'environment':environment},_0x349da1=>{});else _0xe7fa41==_0x1ceddc(0x194)&&process[_0x1ceddc(0x2e1)]({'reinstall':!![],'environment':environment},_0x5540d2=>{});}function startBot(_0x22a60c,_0x5a84d9,_0x2d018f){const _0x1382d9=_0x3b3dcf;if(debugging)_0x22a60c[_0x1382d9(0x264)]('-d');let _0x5a41a6=![];const _0x3d9610=_0x22a60c[0x0];_0x5a84d9={..._0x5a84d9,'stdio':['inherit','inherit',_0x1382d9(0x2ba),_0x1382d9(0x338)]},pid[_0x3d9610]=childProcess[_0x1382d9(0x2eb)](botfile,_0x22a60c,_0x5a84d9),pid[_0x3d9610]['on'](_0x1382d9(0x23f),_0x1fb274=>{const _0x513034=_0x1382d9;switch(Object['keys'](_0x1fb274)[0x0]){case _0x513034(0x37c):updateBotName(_0x3d9610,_0x1fb274[_0x513034(0x37c)]);break;case'updatebotmanager':updateBotManager();break;case _0x513034(0x1ab):updateStatus(_0x3d9610,_0x1fb274[_0x513034(0x1ab)]);break;case'live':updateLive(_0x3d9610,_0x1fb274[_0x513034(0x347)]);break;case _0x513034(0x315):updateLive(_0x3d9610,_0x1fb274[_0x513034(0x315)]),io['to'](_0x3d9610)[_0x513034(0x354)]('status',{'access':{'allow':![],'reason':_0x513034(0x1c9),'token':null}});break;case _0x513034(0x236):_0x1fb274[_0x513034(0x236)]==_0x513034(0x2e3)&&restartBot(_0x3d9610);_0x1fb274[_0x513034(0x236)]==_0x513034(0x2a9)&&toggleBot(_0x3d9610,_0x513034(0x1c4),_0x513034(0x327));break;case _0x513034(0x1ce):sendTelegramBot(_0x3d9610,_0x1fb274[_0x513034(0x1ce)]);break;case _0x513034(0x225):sendTelegramMsg(_0x1fb274['telegrammsg']);break;case _0x513034(0x19d):io['to'](_0x3d9610)[_0x513034(0x354)](_0x1fb274[_0x513034(0x19d)],_0x1fb274[_0x513034(0x34e)]);break;}}),pid[_0x3d9610]['on'](_0x1382d9(0x1d4),function(_0x400c5b){if(_0x5a41a6)return;_0x5a41a6=!![],_0x2d018f(_0x400c5b);}),pid[_0x3d9610]['on'](_0x1382d9(0x1f6),async function(_0x2dda45){const _0x3cce48=_0x1382d9;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x5a41a6)return;_0x5a41a6=!![],_0x2d018f(null);const _0x1634bd=dbConfig[_0x3cce48(0x2bf)](_0x3cce48(0x341))[_0x3cce48(0x37f)]({'botID':_0x3d9610})[_0x3cce48(0x1c2)]();_0x1634bd&&(_0x1634bd[_0x3cce48(0x1ab)]==_0x3cce48(0x2df)||_0x1634bd[_0x3cce48(0x1ab)]==_0x3cce48(0x2ea))&&(await sleep(0x3e8),updateLive(_0x3d9610,_0x3cce48(0x327)),logger[_0x3cce48(0x28f)](_0x3cce48(0x250)+_0x3d9610),startBot([_0x3d9610,userID],{'cwd':bbpath},function(_0x4b5dee){if(_0x4b5dee)logger['full'](_0x4b5dee);}));});}function stopBot(_0x4accf0){const _0x25f1ba=_0x3b3dcf;getClientsWithBotID(_0x4accf0)[_0x25f1ba(0x29e)](_0x176980=>{const _0x1d68c0=_0x25f1ba;getSocket(_0x176980['id'])[_0x1d68c0(0x34f)](!![]),removeClient(_0x176980['id']);}),pid[_0x4accf0]&&(pid[_0x4accf0][_0x25f1ba(0x2a9)](),pid[_0x4accf0]=null);}function stopAllBots(){terminating=!![];const _0xf476c2=getEnabledBots();_0xf476c2['forEach'](_0x11f8b5=>{const _0x3cbc28=_0x156b;stopBot(_0x11f8b5[_0x3cbc28(0x377)]);});}function restartBot(_0xa5f5e7){const _0x14ff3c=_0x3b3dcf;if(pid[_0xa5f5e7])pid[_0xa5f5e7][_0x14ff3c(0x2a9)]();}function addBot(){const _0x3d0e5e=_0x3b3dcf;let _0x3e74b9;for(let _0x377398=0x1;_0x377398<0x3e9;_0x377398++){_0x3e74b9=_0x377398[_0x3d0e5e(0x2b8)]()[_0x3d0e5e(0x32d)](0x3,'0');let _0x217893=config[_0x3d0e5e(0x37f)](_0x3b178c=>_0x3b178c['botID']==_0x3e74b9);if(!_0x217893)break;}if(_0x3e74b9===_0x3d0e5e(0x200)){logger[_0x3d0e5e(0x28f)](_0x3d0e5e(0x34b));return;}logger[_0x3d0e5e(0x28f)](_0x3d0e5e(0x2b9)+_0x3e74b9),dbConfig['get']('bots')['push']({'botID':_0x3e74b9,'botname':_0x3d0e5e(0x22c)+_0x3e74b9,'status':'new','live':''})[_0x3d0e5e(0x1c6)](),startBot([_0x3e74b9,userID],{'cwd':bbpath},function(_0x3d0f19){if(_0x3d0f19)logger['full'](_0x3d0f19);}),config=getConfiguration(),io['to'](_0x3d0e5e(0x35a))[_0x3d0e5e(0x354)](_0x3d0e5e(0x341),config),broadcastToBots(_0x3d0e5e(0x341),JSON[_0x3d0e5e(0x1e1)](config));}function deleteBot(_0x24ec55){const _0x45a1ba=_0x3b3dcf;getClientsWithBotID(_0x24ec55)[_0x45a1ba(0x29e)](_0x5ca82a=>{getSocket(_0x5ca82a['id'])['disconnect'](!![]),removeClient(_0x5ca82a['id']);}),dbConfig[_0x45a1ba(0x2bf)](_0x45a1ba(0x341))[_0x45a1ba(0x1e5)]({'botID':_0x24ec55})[_0x45a1ba(0x1c6)](),logger[_0x45a1ba(0x28f)](_0x45a1ba(0x382)+_0x24ec55),stopBot(_0x24ec55);try{if(fs[_0x45a1ba(0x305)](path[_0x45a1ba(0x28b)](configpath,'bot-'+_0x24ec55+'-config.json')))fs[_0x45a1ba(0x399)](path[_0x45a1ba(0x28b)](configpath,_0x45a1ba(0x298)+_0x24ec55+_0x45a1ba(0x1f8)));if(fs[_0x45a1ba(0x305)](path[_0x45a1ba(0x28b)](configpath,'bot-'+_0x24ec55+_0x45a1ba(0x286))))fs['unlinkSync'](path[_0x45a1ba(0x28b)](configpath,_0x45a1ba(0x298)+_0x24ec55+_0x45a1ba(0x286)));if(fs[_0x45a1ba(0x305)](path[_0x45a1ba(0x28b)](configpath,_0x45a1ba(0x298)+_0x24ec55+_0x45a1ba(0x1de))))fs[_0x45a1ba(0x399)](path[_0x45a1ba(0x28b)](configpath,_0x45a1ba(0x298)+_0x24ec55+_0x45a1ba(0x1de)));if(fs[_0x45a1ba(0x305)](path[_0x45a1ba(0x28b)](configpath,_0x45a1ba(0x298)+_0x24ec55+_0x45a1ba(0x26d))))fs['unlinkSync'](path[_0x45a1ba(0x28b)](configpath,_0x45a1ba(0x298)+_0x24ec55+_0x45a1ba(0x26d)));}catch(_0x196e11){if(_0x196e11)logger['full'](_0x45a1ba(0x263),_0x196e11);}config=getConfiguration(),io['to'](_0x45a1ba(0x35a))[_0x45a1ba(0x354)](_0x45a1ba(0x341),config),broadcastToBots(_0x45a1ba(0x341),JSON[_0x45a1ba(0x1e1)](config));}function toggleBot(_0x3b49a4,_0x594898,_0x52637a){const _0x595c44=_0x3b3dcf;dbConfig['get'](_0x595c44(0x341))['find']({'botID':_0x3b49a4})[_0x595c44(0x34d)]({'status':_0x594898})['assign']({'live':_0x52637a})['write']();if(_0x594898==_0x595c44(0x2df)||_0x594898==_0x595c44(0x2ea))logger[_0x595c44(0x28f)]('Enabled\x20Bot\x20'+_0x3b49a4),startBot([_0x3b49a4,userID],{'cwd':bbpath},function(_0x495d62){const _0x7656bc=_0x595c44;if(_0x495d62)logger[_0x7656bc(0x28f)](_0x495d62);});else(_0x594898==_0x595c44(0x1c4)||_0x594898==_0x595c44(0x1ba))&&(logger['full']('Disabled\x20Bot\x20'+_0x3b49a4),stopBot(_0x3b49a4));config=getConfiguration(),io['to'](_0x595c44(0x35a))['emit'](_0x595c44(0x341),config),broadcastToBots(_0x595c44(0x341),JSON[_0x595c44(0x1e1)](config));}function toggleStatus(_0x37605b){const _0x282218=_0x3b3dcf;let _0x1e59a7=dbConfig[_0x282218(0x2bf)](_0x282218(0x341))['find']({'botID':_0x37605b})[_0x282218(0x1c2)](),_0x34058d;if(_0x1e59a7['status']===_0x282218(0x2df))_0x34058d=_0x282218(0x1c4);else{if(_0x1e59a7[_0x282218(0x1ab)]==='new')_0x34058d='new-disabled';else{if(_0x1e59a7[_0x282218(0x1ab)]===_0x282218(0x1ba))_0x34058d='new';else{if(_0x1e59a7[_0x282218(0x1ab)]===_0x282218(0x1c4))_0x34058d=_0x282218(0x2df);}}}return _0x34058d;}function updateStatus(_0x4d5501,_0x1dfd74){const _0x84e1f6=_0x3b3dcf;dbConfig[_0x84e1f6(0x2bf)]('bots')[_0x84e1f6(0x37f)]({'botID':_0x4d5501})[_0x84e1f6(0x34d)]({'status':_0x1dfd74})['write'](),config=getConfiguration(),io['to'](_0x84e1f6(0x35a))['emit'](_0x84e1f6(0x341),config),broadcastToBots(_0x84e1f6(0x341),JSON['stringify'](config));}function updateLive(_0x55453f,_0x3fc017){const _0x94f417=_0x3b3dcf;dbConfig[_0x94f417(0x2bf)](_0x94f417(0x341))[_0x94f417(0x37f)]({'botID':_0x55453f})[_0x94f417(0x34d)]({'live':_0x3fc017})['write'](),config=getConfiguration(),io['to'](_0x94f417(0x35a))[_0x94f417(0x354)]('bots',config),broadcastToBots(_0x94f417(0x341),JSON[_0x94f417(0x1e1)](config));}function updateBotName(_0x19764a,_0x588107){const _0x5b08fc=_0x3b3dcf;dbConfig[_0x5b08fc(0x2bf)](_0x5b08fc(0x341))['find']({'botID':_0x19764a})['assign']({'botname':_0x588107})[_0x5b08fc(0x1c6)](),config=getConfiguration(),io['to']('botmanager')[_0x5b08fc(0x354)](_0x5b08fc(0x341),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x4cb9ef=_0x3b3dcf;config=getConfiguration(),io['to'](_0x4cb9ef(0x35a))['emit'](_0x4cb9ef(0x341),config),broadcastToBots('bots',JSON[_0x4cb9ef(0x1e1)](config));}function toggleBotMode(_0x442e06){const _0x25c6fc=_0x3b3dcf;if(pid[_0x442e06])pid[_0x442e06][_0x25c6fc(0x2e1)]({'function':_0x25c6fc(0x2ad),'args':null});else{const _0x5c542f=configpath+'bot-'+_0x442e06+_0x25c6fc(0x1f8),_0x405690=fs['readFileSync'](_0x5c542f),_0x193f70=JSON[_0x25c6fc(0x1fe)](_0x405690),_0x23d70b=_0x193f70[_0x25c6fc(0x29c)][0x0][_0x25c6fc(0x2d7)];_0x193f70[_0x25c6fc(0x29c)][0x0][_0x25c6fc(0x2d7)]=!_0x23d70b;const _0x3d8874=JSON[_0x25c6fc(0x1e1)](_0x193f70,null,0x2);fs[_0x25c6fc(0x39a)](_0x5c542f,_0x3d8874),config=getConfiguration(),io['to'](_0x25c6fc(0x35a))[_0x25c6fc(0x354)](_0x25c6fc(0x341),config),broadcastToBots(_0x25c6fc(0x341),JSON[_0x25c6fc(0x1e1)](config));}}function validateTelegram(_0x30318a){const _0x120c7f=_0x3b3dcf;if(_0x30318a[_0x120c7f(0x398)][_0x120c7f(0x311)]!=settings['telegramUsername']&&'@'+_0x30318a['from']['username']!=settings[_0x120c7f(0x343)]||_0x30318a[_0x120c7f(0x2ee)]['id']!=settings['telegramChatId'])return sendTelegram(_0x30318a[_0x120c7f(0x2ee)]['id'],_0x120c7f(0x1cd),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x4ebd2b=_0x3b3dcf;if(tgBot)tgBot[_0x4ebd2b(0x236)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x345c31=_0x4ebd2b(0x278);_0x345c31+='\x0a',_0x345c31+=_0x4ebd2b(0x24c),_0x345c31+=_0x4ebd2b(0x1c8),_0x345c31+=_0x4ebd2b(0x2f3),_0x345c31+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x345c31+=_0x4ebd2b(0x28a),_0x345c31+=_0x4ebd2b(0x351),_0x345c31+=_0x4ebd2b(0x383),_0x345c31+=_0x4ebd2b(0x242),_0x345c31+=_0x4ebd2b(0x32c),_0x345c31+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x345c31+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x345c31+=_0x4ebd2b(0x216),_0x345c31+=_0x4ebd2b(0x282),_0x345c31+=_0x4ebd2b(0x1a9);let _0x52548c='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x52548c+='\x0a',_0x52548c+=_0x345c31,tgBot[_0x4ebd2b(0x30a)]((_0x115a4e,_0x1f23a9)=>{const _0x23e414=_0x4ebd2b;logger['simple'](getTimeStamp()+_0x23e414(0x21e)),logger[_0x23e414(0x254)](_0x23e414(0x25c),_0x115a4e);}),tgBot['use'](async(_0x4acea9,_0x4dcf45)=>{const _0x4a5d94=_0x4ebd2b;if(!(!settings['telegramChatId']&&_0x4acea9[_0x4a5d94(0x2ef)][_0x4a5d94(0x23f)][_0x4a5d94(0x2bc)]==_0x4a5d94(0x30c))){if(!validateTelegram(_0x4acea9))return;}_0x4dcf45();}),tgBot[_0x4ebd2b(0x1bb)]('start',async _0x5eeb98=>{const _0x3bf31a=_0x4ebd2b;if(!settings[_0x3bf31a(0x1ca)])updateSetting(_0x3bf31a(0x1ca),_0x5eeb98[_0x3bf31a(0x2ee)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x5eeb98))return;await sendTelegram(_0x5eeb98[_0x3bf31a(0x2ee)]['id'],_0x52548c);}),tgBot[_0x4ebd2b(0x1bb)]('enable',async _0x28ea43=>{const _0xc49ffd=_0x4ebd2b;updateSetting(_0xc49ffd(0x201),!![]),await sendTelegram(_0x28ea43['chat']['id'],_0xc49ffd(0x35d));}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x2e7),async _0x51d64b=>{const _0xe05a2d=_0x4ebd2b;await sendTelegram(_0x51d64b[_0xe05a2d(0x2ee)]['id'],_0xe05a2d(0x2ac)),updateSetting(_0xe05a2d(0x201),![]);}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x28d),async _0x5ae8e9=>{const _0x1044d4=_0x4ebd2b,_0x5a82d1=Markup[_0x1044d4(0x361)]([Markup['button'][_0x1044d4(0x1cb)](_0x1044d4(0x364),_0x1044d4(0x357)),Markup[_0x1044d4(0x37a)]['callback']('Alerts',_0x1044d4(0x245)),Markup['button'][_0x1044d4(0x1cb)](_0x1044d4(0x385),_0x1044d4(0x29d))]);_0x5ae8e9[_0x1044d4(0x30b)](_0x1044d4(0x32f),_0x5a82d1);}),tgBot[_0x4ebd2b(0x389)]('config_orders',async _0x47d491=>{const _0x435ef2=_0x4ebd2b;_0x47d491[_0x435ef2(0x2ae)](),updateSetting(_0x435ef2(0x214),_0x435ef2(0x228)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x47d491[_0x435ef2(0x2ee)]['id'],_0x435ef2(0x1db));}),tgBot[_0x4ebd2b(0x389)](_0x4ebd2b(0x245),async _0x1bf6ab=>{const _0x5e27b2=_0x4ebd2b;_0x1bf6ab[_0x5e27b2(0x2ae)](),updateSetting('telegramEvents',_0x5e27b2(0x31b)),updateSetting(_0x5e27b2(0x201),!![]),await sendTelegram(_0x1bf6ab[_0x5e27b2(0x2ee)]['id'],_0x5e27b2(0x252));}),tgBot[_0x4ebd2b(0x389)](_0x4ebd2b(0x29d),async _0x134d81=>{const _0xb9342a=_0x4ebd2b;_0x134d81[_0xb9342a(0x2ae)](),updateSetting(_0xb9342a(0x214),_0xb9342a(0x1c5)),updateSetting(_0xb9342a(0x201),!![]),await sendTelegram(_0x134d81['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x1ab),async _0x352434=>{const _0x51059b=_0x4ebd2b,_0x240e6f=getBotsWithMode();let _0x5cfa70=_0x51059b(0x1a7);config[_0x51059b(0x29e)](_0x31bfff=>{const _0x508520=_0x51059b,_0x54eea9=_0x240e6f[_0x508520(0x37f)](_0x1ef26c=>_0x1ef26c[_0x508520(0x377)]==_0x31bfff[_0x508520(0x377)])[_0x508520(0x1d5)];_0x5cfa70+=_0x508520(0x22c)+_0x31bfff[_0x508520(0x377)]+':\x20'+_0x31bfff[_0x508520(0x1ab)]+_0x508520(0x193)+_0x54eea9+_0x508520(0x193)+_0x31bfff[_0x508520(0x347)]+'\x0a';}),_0x5cfa70+='\x0a',_0x5cfa70+=_0x51059b(0x2cf),_0x5cfa70+=!settings[_0x51059b(0x201)]?_0x51059b(0x306):_0x51059b(0x1d2),_0x5cfa70+=settings['telegramEnabled']?settings[_0x51059b(0x214)]=='all'?_0x51059b(0x1b8):_0x51059b(0x21f)+settings[_0x51059b(0x214)]+'\x20only\x0a':'',await sendTelegram(_0x352434['chat']['id'],_0x5cfa70,{'parse_mode':'HTML'});}),tgBot[_0x4ebd2b(0x1bb)]('restart',async _0x1cab41=>{const _0x34db96=_0x4ebd2b,_0x59440e=getEnabledBots();if(_0x59440e[_0x34db96(0x24f)]==0x0)await sendTelegram(_0x1cab41[_0x34db96(0x2ee)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x59440e[_0x34db96(0x24f)]>0x1)_0x59440e[_0x34db96(0x264)]({'botID':'all'});let _0x2e443e=[],_0x2080b8=[];const _0x42adc3=_0x59440e[_0x34db96(0x24f)]%0x4==0x0||_0x59440e[_0x34db96(0x24f)]%0x4==0x3||_0x59440e['length']%0x3==0x1?0x4:0x3;let _0x5e9e4c=0x0;_0x59440e[_0x34db96(0x29e)]((_0x398c09,_0x187e0c)=>{const _0x17edda=_0x34db96;if(_0x187e0c%_0x42adc3==0x0)_0x2080b8=[];_0x2080b8[_0x17edda(0x264)](Markup[_0x17edda(0x37a)][_0x17edda(0x1cb)](_0x398c09['botID']==_0x17edda(0x1c5)?_0x17edda(0x2aa):_0x17edda(0x22c)+_0x398c09[_0x17edda(0x377)],_0x17edda(0x21c)+_0x398c09['botID'])),_0x187e0c%_0x42adc3==0x0&&(_0x2e443e[_0x5e9e4c]=_0x2080b8,_0x5e9e4c++);});const _0x11bb00=Markup['inlineKeyboard'](_0x2e443e);_0x1cab41[_0x34db96(0x30b)](_0x34db96(0x19b),_0x11bb00);}}),tgBot['action'](/restart_(.+)/,async _0x3c0703=>{const _0x5e321d=_0x4ebd2b,_0x35fbf2=_0x3c0703['match'][0x1];_0x3c0703[_0x5e321d(0x2ae)](),_0x35fbf2==_0x5e321d(0x1c5)?config[_0x5e321d(0x29e)](_0x46f0da=>{restartBot(_0x46f0da['botID']);}):restartBot(_0x35fbf2);}),tgBot[_0x4ebd2b(0x1bb)]('on',async _0x1b8502=>{const _0x40942f=_0x4ebd2b,_0x134176=getDisabledBots();if(_0x134176[_0x40942f(0x24f)]==0x0)await sendTelegram(_0x1b8502[_0x40942f(0x2ee)]['id'],_0x40942f(0x195));else{if(_0x134176['length']>0x1)_0x134176['push']({'botID':_0x40942f(0x1c5)});let _0x4f990a=[],_0x5dea99=[];const _0xa3b7b4=_0x134176['length']%0x4==0x0||_0x134176[_0x40942f(0x24f)]%0x4==0x3||_0x134176[_0x40942f(0x24f)]%0x3==0x1?0x4:0x3;let _0x130500=0x0;_0x134176[_0x40942f(0x29e)]((_0x39ff8f,_0x331c6d)=>{const _0x541acb=_0x40942f;if(_0x331c6d%_0xa3b7b4==0x0)_0x5dea99=[];_0x5dea99['push'](Markup[_0x541acb(0x37a)][_0x541acb(0x1cb)](_0x39ff8f[_0x541acb(0x377)]=='all'?_0x541acb(0x2aa):'Bot\x20'+_0x39ff8f[_0x541acb(0x377)],_0x541acb(0x248)+_0x39ff8f['botID'])),_0x331c6d%_0xa3b7b4==0x0&&(_0x4f990a[_0x130500]=_0x5dea99,_0x130500++);});const _0x7ce545=Markup['inlineKeyboard'](_0x4f990a);_0x1b8502[_0x40942f(0x30b)](_0x40942f(0x2f7),_0x7ce545);}}),tgBot[_0x4ebd2b(0x389)](/on_(.+)/,async _0x3daaf0=>{const _0x5dd085=_0x4ebd2b,_0x9c339b=_0x3daaf0[_0x5dd085(0x2f2)][0x1];_0x3daaf0['editMessageReplyMarkup']();if(_0x9c339b==_0x5dd085(0x1c5)){const _0x1f3541=getDisabledBots();await sendTelegram(_0x3daaf0[_0x5dd085(0x2ee)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x1f3541[_0x5dd085(0x29e)](_0x16bada=>{const _0xb7455e=_0x5dd085;if(_0x16bada[_0xb7455e(0x377)]!='all')toggleBot(_0x16bada[_0xb7455e(0x377)],toggleStatus(_0x16bada[_0xb7455e(0x377)]),_0xb7455e(0x327));});}else await sendTelegram(_0x3daaf0[_0x5dd085(0x2ee)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x9c339b),toggleBot(_0x9c339b,toggleStatus(_0x9c339b),'stopped');}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x2c6),async _0x55a565=>{const _0x208620=_0x4ebd2b,_0x55a7ca=getEnabledBots();if(_0x55a7ca[_0x208620(0x24f)]==0x0)await sendTelegram(_0x55a565[_0x208620(0x2ee)]['id'],_0x208620(0x227));else{if(_0x55a7ca[_0x208620(0x24f)]>0x1)_0x55a7ca[_0x208620(0x264)]({'botID':'all'});let _0x3fe4c6=[],_0x3f5ae4=[];const _0x4d2f39=_0x55a7ca[_0x208620(0x24f)]%0x4==0x0||_0x55a7ca[_0x208620(0x24f)]%0x4==0x3||_0x55a7ca[_0x208620(0x24f)]%0x3==0x1?0x4:0x3;let _0x21efe4=0x0;_0x55a7ca['forEach']((_0x244b2d,_0x2d9bf0)=>{const _0x2aa516=_0x208620;if(_0x2d9bf0%_0x4d2f39==0x0)_0x3f5ae4=[];_0x3f5ae4[_0x2aa516(0x264)](Markup[_0x2aa516(0x37a)][_0x2aa516(0x1cb)](_0x244b2d[_0x2aa516(0x377)]==_0x2aa516(0x1c5)?_0x2aa516(0x2aa):_0x2aa516(0x22c)+_0x244b2d[_0x2aa516(0x377)],_0x2aa516(0x386)+_0x244b2d[_0x2aa516(0x377)])),_0x2d9bf0%_0x4d2f39==0x0&&(_0x3fe4c6[_0x21efe4]=_0x3f5ae4,_0x21efe4++);});const _0x5cb75d=Markup[_0x208620(0x361)](_0x3fe4c6);_0x55a565[_0x208620(0x30b)](_0x208620(0x36e),_0x5cb75d);}}),tgBot[_0x4ebd2b(0x389)](/off_(.+)/,async _0x15be13=>{const _0xa9e904=_0x4ebd2b,_0x284c2f=_0x15be13[_0xa9e904(0x2f2)][0x1];_0x15be13[_0xa9e904(0x2ae)]();if(_0x284c2f=='all'){const _0x5915d3=getEnabledBots();await sendTelegram(_0x15be13[_0xa9e904(0x2ee)]['id'],_0xa9e904(0x2f0)),_0x5915d3['forEach'](_0x172873=>{const _0x323474=_0xa9e904;if(_0x172873['botID']!=_0x323474(0x1c5))toggleBot(_0x172873[_0x323474(0x377)],toggleStatus(_0x172873['botID']),_0x323474(0x327));});}else await sendTelegram(_0x15be13[_0xa9e904(0x2ee)]['id'],_0xa9e904(0x2a8)+_0x284c2f),toggleBot(_0x284c2f,toggleStatus(_0x284c2f),_0xa9e904(0x327));}),tgBot['command'](_0x4ebd2b(0x22f),async _0x58c06f=>{const _0x2adde7=_0x4ebd2b,_0x22e88f=getEnabledBots();if(_0x22e88f['length']==0x0)await sendTelegram(_0x58c06f['chat']['id'],_0x2adde7(0x227));else{if(_0x22e88f['length']>0x1){let _0x3175b6=[],_0x31f336=[];const _0x2d4548=_0x22e88f[_0x2adde7(0x24f)]%0x4==0x0||_0x22e88f[_0x2adde7(0x24f)]%0x4==0x3||_0x22e88f['length']%0x3==0x1?0x4:0x3;let _0x53457f=0x0;_0x22e88f['forEach']((_0x23a97b,_0x4f1ec8)=>{const _0xa75801=_0x2adde7;if(_0x4f1ec8%_0x2d4548==0x0)_0x31f336=[];_0x31f336[_0xa75801(0x264)](Markup[_0xa75801(0x37a)][_0xa75801(0x1cb)](_0xa75801(0x22c)+_0x23a97b[_0xa75801(0x377)],_0xa75801(0x390)+_0x23a97b[_0xa75801(0x377)])),_0x4f1ec8%_0x2d4548==0x0&&(_0x3175b6[_0x53457f]=_0x31f336,_0x53457f++);});const _0x89f2bd=Markup[_0x2adde7(0x361)](_0x3175b6);_0x58c06f[_0x2adde7(0x30b)](_0x2adde7(0x32e),_0x89f2bd);}else{const _0x49cc87=_0x22e88f[0x0][_0x2adde7(0x377)];if(pid[_0x49cc87])pid[_0x49cc87]['send']({'function':_0x2adde7(0x303),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x2db71a=>{const _0x1171d6=_0x4ebd2b,_0x5e2181=_0x2db71a[_0x1171d6(0x2f2)][0x1];_0x2db71a[_0x1171d6(0x2ae)]();if(pid[_0x5e2181])pid[_0x5e2181]['send']({'function':_0x1171d6(0x303),'args':null});}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x1f5),async _0x2356b2=>{const _0x2dd198=_0x4ebd2b,_0x5a69c3=getEnabledBots();if(_0x5a69c3['length']==0x0)await sendTelegram(_0x2356b2[_0x2dd198(0x2ee)]['id'],_0x2dd198(0x227));else{if(_0x5a69c3[_0x2dd198(0x24f)]>0x1){let _0xa0fbef=[],_0xfcb9cd=[];const _0x2e3bb3=_0x5a69c3[_0x2dd198(0x24f)]%0x4==0x0||_0x5a69c3[_0x2dd198(0x24f)]%0x4==0x3||_0x5a69c3['length']%0x3==0x1?0x4:0x3;let _0xa81094=0x0;_0x5a69c3[_0x2dd198(0x29e)]((_0x4a05e5,_0x3d4ff8)=>{const _0x233757=_0x2dd198;if(_0x3d4ff8%_0x2e3bb3==0x0)_0xfcb9cd=[];_0xfcb9cd['push'](Markup[_0x233757(0x37a)][_0x233757(0x1cb)](_0x233757(0x22c)+_0x4a05e5[_0x233757(0x377)],'portfolio_'+_0x4a05e5['botID'])),_0x3d4ff8%_0x2e3bb3==0x0&&(_0xa0fbef[_0xa81094]=_0xfcb9cd,_0xa81094++);});const _0x42d790=Markup[_0x2dd198(0x361)](_0xa0fbef);_0x2356b2[_0x2dd198(0x30b)](_0x2dd198(0x37e),_0x42d790);}else{const _0x54c603=_0x5a69c3[0x0][_0x2dd198(0x377)];if(pid[_0x54c603])pid[_0x54c603][_0x2dd198(0x2e1)]({'function':_0x2dd198(0x2ca),'args':null});}}}),tgBot[_0x4ebd2b(0x389)](/portfolio_(.+)/,async _0x36fe7d=>{const _0x4df981=_0x4ebd2b,_0x1c2ab2=_0x36fe7d[_0x4df981(0x2f2)][0x1];_0x36fe7d['editMessageReplyMarkup']();if(pid[_0x1c2ab2])pid[_0x1c2ab2][_0x4df981(0x2e1)]({'function':_0x4df981(0x2ca),'args':null});}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x2ef),async _0x581690=>{const _0x65ef15=_0x4ebd2b;await getMessages();if(!updateAvailable)await sendTelegram(_0x581690['chat']['id'],_0x65ef15(0x1f4));else{if(!validInstallation)await sendTelegram(_0x581690[_0x65ef15(0x2ee)]['id'],_0x65ef15(0x210));else{const _0x5ed136=Markup[_0x65ef15(0x361)]([Markup[_0x65ef15(0x37a)][_0x65ef15(0x1cb)]('Yes',_0x65ef15(0x301)),Markup['button'][_0x65ef15(0x1cb)]('No','update_no')]);_0x581690[_0x65ef15(0x30b)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x5ed136);}}}),tgBot[_0x4ebd2b(0x389)](/update_(.+)/,async _0x29a493=>{const _0x18304=_0x4ebd2b,_0x1b8e22=_0x29a493['match'][0x1];_0x29a493['editMessageReplyMarkup'](),_0x1b8e22=='yes'&&(await sendTelegram(_0x29a493[_0x18304(0x2ee)]['id'],_0x18304(0x397)),updateBB(_0x18304(0x2ef))),_0x1b8e22=='no'&&await sendTelegram(_0x29a493[_0x18304(0x2ee)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x194),async _0x45e9c6=>{const _0x1e349a=_0x4ebd2b;if(!validInstallation)await sendTelegram(_0x45e9c6[_0x1e349a(0x2ee)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x14e3f1=Markup['inlineKeyboard']([Markup['button'][_0x1e349a(0x1cb)](_0x1e349a(0x2a0),_0x1e349a(0x1fd)),Markup[_0x1e349a(0x37a)][_0x1e349a(0x1cb)]('No',_0x1e349a(0x396))]);_0x45e9c6[_0x1e349a(0x30b)](_0x1e349a(0x26b),_0x14e3f1);}}),tgBot[_0x4ebd2b(0x389)](/reinstall_(.+)/,async _0x1fc553=>{const _0x5201c5=_0x4ebd2b,_0x5d8da3=_0x1fc553[_0x5201c5(0x2f2)][0x1];_0x1fc553[_0x5201c5(0x2ae)](),_0x5d8da3==_0x5201c5(0x239)&&(await sendTelegram(_0x1fc553[_0x5201c5(0x2ee)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x5201c5(0x194))),_0x5d8da3=='no'&&await sendTelegram(_0x1fc553[_0x5201c5(0x2ee)]['id'],_0x5201c5(0x2ff));}),tgBot[_0x4ebd2b(0x1bb)]('toggle',async _0x371dab=>{const _0x297d73=_0x4ebd2b,_0x5e4f40=getBotsWithMode();if(_0x5e4f40[_0x297d73(0x24f)]==0x0)await sendTelegram(_0x371dab[_0x297d73(0x2ee)]['id'],_0x297d73(0x227));else{let _0x394878=[],_0x494cdc=[];const _0x5bb440=0x2;let _0x53b528=0x0;_0x5e4f40['forEach']((_0x1e3c08,_0x132a7c)=>{const _0x2dfcf9=_0x297d73;if(_0x132a7c%_0x5bb440==0x0)_0x494cdc=[];_0x494cdc[_0x2dfcf9(0x264)](Markup[_0x2dfcf9(0x37a)][_0x2dfcf9(0x1cb)](_0x2dfcf9(0x22c)+_0x1e3c08[_0x2dfcf9(0x377)]+'\x20('+_0x1e3c08[_0x2dfcf9(0x1d5)]+')',_0x2dfcf9(0x2d5)+_0x1e3c08[_0x2dfcf9(0x377)])),_0x132a7c%_0x5bb440==0x0&&(_0x394878[_0x53b528]=_0x494cdc,_0x53b528++);});const _0xc1614d=Markup[_0x297d73(0x361)](_0x394878);_0x371dab[_0x297d73(0x30b)](_0x297d73(0x260),_0xc1614d);}}),tgBot[_0x4ebd2b(0x389)](/toggle_(.+)/,async _0x517cec=>{const _0x3532eb=_0x4ebd2b,_0x5f5a85=_0x517cec[_0x3532eb(0x2f2)][0x1];_0x517cec[_0x3532eb(0x2ae)]();const _0x424339=getBotsWithMode(),_0x1ced32=_0x424339[_0x3532eb(0x37f)](_0x10d6a3=>_0x10d6a3[_0x3532eb(0x377)]==_0x5f5a85),_0x6cd5ff=_0x1ced32[_0x3532eb(0x1d5)]==_0x3532eb(0x1e7)?_0x3532eb(0x32b):'auto';await sendTelegram(_0x517cec[_0x3532eb(0x2ee)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x5f5a85+'\x20to\x20'+_0x6cd5ff+'\x20mode'),toggleBotMode(_0x5f5a85);}),tgBot['command']('names',async _0x4b3e39=>{const _0x231be0=_0x4ebd2b;let _0x429488='';config[_0x231be0(0x29e)](_0x1672d9=>{const _0x37fa1a=_0x231be0;_0x429488+='Bot\x20'+_0x1672d9[_0x37fa1a(0x377)]+':\x20'+_0x1672d9[_0x37fa1a(0x37c)]+'\x0a';}),await sendTelegram(_0x4b3e39[_0x231be0(0x2ee)]['id'],_0x429488,{'parse_mode':_0x231be0(0x30f)});}),tgBot[_0x4ebd2b(0x1bb)](_0x4ebd2b(0x20a),async _0x447ebc=>{await sendTelegram(_0x447ebc['chat']['id'],_0x345c31);}),process[_0x4ebd2b(0x2e5)]('SIGINT',()=>tgBot['stop'](_0x4ebd2b(0x295))),process[_0x4ebd2b(0x2e5)](_0x4ebd2b(0x1b7),()=>tgBot[_0x4ebd2b(0x236)](_0x4ebd2b(0x1b7))),tgBot['launch']();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x5c6c16,_0x1ec340,_0x4e269f){const _0x460843=_0x3b3dcf;_0x4e269f={..._0x4e269f,'disable_web_page_preview':!![]};try{await tgBot[_0x460843(0x1ce)][_0x460843(0x319)](_0x5c6c16,_0x1ec340,_0x4e269f);}catch(_0x3b59ae){console[_0x460843(0x256)]('Telegram\x20error:',_0x3b59ae);}}async function sendTelegramBot(_0x5b319d,_0xe7e959){const _0x2a862f=_0x3b3dcf;if(settings[_0x2a862f(0x201)]){if(settings[_0x2a862f(0x214)]==_0x2a862f(0x1c5)||(_0xe7e959[_0x2a862f(0x371)]=='error'||_0xe7e959[_0x2a862f(0x371)]==_0x2a862f(0x384)||_0xe7e959[_0x2a862f(0x371)]==_0x2a862f(0x2c2))&&settings[_0x2a862f(0x214)]==_0x2a862f(0x31b)||_0xe7e959['type']==_0x2a862f(0x231)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x2a862f(0x1ca)]){if(_0xe7e959['showname'])await sendTelegram(settings[_0x2a862f(0x1ca)],_0xe7e959[_0x2a862f(0x37c)]+'\x20>\x20'+_0xe7e959[_0x2a862f(0x27b)]);else await sendTelegram(settings['telegramChatId'],_0x2a862f(0x22c)+_0x5b319d+'\x20>\x20'+_0xe7e959['event']);}}}}async function sendTelegramMsg(_0x244c26,_0x4ea309=_0x3b3dcf(0x30f)){const _0x2e10c1=_0x3b3dcf;return settings[_0x2e10c1(0x201)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x2e10c1(0x1ca)],_0x244c26,{'parse_mode':_0x4ea309}),!![]):![];}function getDeviceWithIp(_0xf56a12){return devices['find'](_0x2f5367=>_0x2f5367['ip']===_0xf56a12);}async function temporaryAccess2FA(_0xef3c88,_0x5e0aca){const _0x1d14b5=_0x3b3dcf;let _0x455fc6=new Date(),_0x46e454=![];if(lastIpApproval){if(_0x455fc6-lastIpApproval<0x1388)_0x46e454=!![];}lastIpApproval=new Date();if(_0x46e454)return;if(tgBot&&settings[_0x1d14b5(0x1ca)]){const _0x50d4e3=uuidRandom();tmpStorage[_0x50d4e3]={'uuid':_0xef3c88,'externalip':_0x5e0aca};const _0xcba852=Markup[_0x1d14b5(0x361)]([Markup[_0x1d14b5(0x37a)][_0x1d14b5(0x1cb)](_0x1d14b5(0x197),_0x1d14b5(0x333)+_0x50d4e3),Markup['button'][_0x1d14b5(0x1cb)]('15\x20min','tempaccess_15_'+_0x50d4e3),Markup['button']['callback']('30\x20min',_0x1d14b5(0x1a3)+_0x50d4e3),Markup[_0x1d14b5(0x37a)][_0x1d14b5(0x1cb)](_0x1d14b5(0x1b1),_0x1d14b5(0x35e)+_0x50d4e3)]);await sendTelegram(settings[_0x1d14b5(0x1ca)],_0x1d14b5(0x375)+normalizeIP(_0x5e0aca)[_0x1d14b5(0x307)]+'\x20?',_0xcba852),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x5ee164=>{const _0xe4d38=_0x1d14b5,_0x70b00a=_0x5ee164[_0xe4d38(0x2f2)][0x1],_0x149599=_0x5ee164[_0xe4d38(0x2f2)][0x2],{uuid:_0x4304fa,externalip:_0x2425ac}=tmpStorage[_0x149599];delete tmpStorage[_0x149599],_0x5ee164[_0xe4d38(0x2ae)](),devices[_0x4304fa][_0xe4d38(0x2a5)]={'clientip':_0x2425ac,'timestamp':new Date()[_0xe4d38(0x324)](),'expiry':_0x70b00a},_0x70b00a!='reject'?(await sendTelegram(_0x5ee164['chat']['id'],_0xe4d38(0x1af)+_0x70b00a+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x4304fa)[_0xe4d38(0x354)](_0xe4d38(0x1ab),{'access':{'allow':![],'reason':_0xe4d38(0x1c9),'token':null}})):(await sendTelegram(_0x5ee164[_0xe4d38(0x2ee)]['id'],_0xe4d38(0x2d0)),io['to'](_0x4304fa)['emit'](_0xe4d38(0x1ab),{'access':{'allow':![],'reason':_0xe4d38(0x273),'token':null}}));});}}async function loginAccess2FA(_0x4607ef,_0xa091f4){const _0x45890b=_0x3b3dcf;if(tgBot&&settings[_0x45890b(0x1ca)]){const _0x395dcb=uuidRandom();tmpStorage[_0x395dcb]={'uuid':_0x4607ef,'externalip':_0xa091f4};const _0x2255c9=Markup[_0x45890b(0x361)]([Markup[_0x45890b(0x37a)][_0x45890b(0x1cb)](_0x45890b(0x2fb),_0x45890b(0x23a)+loginExpiry+'_'+_0x395dcb),Markup[_0x45890b(0x37a)]['callback']('reject',_0x45890b(0x230)+_0x395dcb)]);await sendTelegram(settings['telegramChatId'],_0x45890b(0x1b6)+normalizeIP(_0xa091f4)[_0x45890b(0x307)]+'\x20?',_0x2255c9),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x228696=>{const _0x2b79fa=_0x45890b,_0x3c13b8=_0x228696[_0x2b79fa(0x2f2)][0x1],_0x57a56c=_0x228696[_0x2b79fa(0x2f2)][0x2],{uuid:_0x35c5bb,externalip:_0x2a9ac2}=tmpStorage[_0x57a56c];delete tmpStorage[_0x57a56c],_0x228696[_0x2b79fa(0x2ae)](),devices[_0x35c5bb][_0x2b79fa(0x238)]={'clientip':_0x2a9ac2,'timestamp':new Date()['getTime'](),'expiry':_0x3c13b8},_0x3c13b8!='reject'?(await sendTelegram(_0x228696[_0x2b79fa(0x2ee)]['id'],_0x2b79fa(0x203),{'parse_mode':_0x2b79fa(0x30f)}),io['to'](_0x35c5bb)[_0x2b79fa(0x354)](_0x2b79fa(0x1ab),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x228696[_0x2b79fa(0x2ee)]['id'],_0x2b79fa(0x208)),io['to'](_0x35c5bb)[_0x2b79fa(0x354)](_0x2b79fa(0x1ab),{'access':{'allow':![],'reason':_0x2b79fa(0x25f),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x275c65=_0x3b3dcf;return dbConfig['get']('bots')[_0x275c65(0x367)]('botID')['filter']({'status':_0x275c65(0x2df)})[_0x275c65(0x1c2)]()||[];}function getDisabledBots(){const _0xbfa9c6=_0x3b3dcf;return dbConfig['get'](_0xbfa9c6(0x341))[_0xbfa9c6(0x367)](_0xbfa9c6(0x377))[_0xbfa9c6(0x196)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x45e951){const _0x1f3437=_0x3b3dcf;let _0xe929a6={};const _0x4c825d=configpath+_0x1f3437(0x298)+_0x45e951+_0x1f3437(0x1f8),_0x3baebc=fs[_0x1f3437(0x305)](_0x4c825d);if(_0x3baebc){const _0x22dd46=fs['readFileSync'](_0x4c825d);try{const _0x3b6d50=JSON[_0x1f3437(0x1fe)](_0x22dd46),_0x11bd55=_0x3b6d50?_0x3b6d50[_0x1f3437(0x29c)][0x0][_0x1f3437(0x2d7)]:![];_0xe929a6['mode']=_0x11bd55?_0x1f3437(0x1e7):_0x1f3437(0x32b),_0xe929a6[_0x1f3437(0x37c)]=_0x3b6d50?_0x3b6d50['bot'][0x0]['botname']:_0x1f3437(0x22c)+_0x45e951;}catch(_0x39f7f6){_0xe929a6[_0x1f3437(0x1d5)]=_0x1f3437(0x32b),_0xe929a6[_0x1f3437(0x37c)]=_0x1f3437(0x22c)+_0x45e951;}}else _0xe929a6[_0x1f3437(0x1d5)]='manual',_0xe929a6[_0x1f3437(0x37c)]=_0x1f3437(0x22c)+_0x45e951;return _0xe929a6;}function getBotsWithMode(){const _0x4bcb27=_0x3b3dcf,_0x939e16=dbConfig[_0x4bcb27(0x2bf)](_0x4bcb27(0x341))[_0x4bcb27(0x367)](_0x4bcb27(0x377))[_0x4bcb27(0x1c2)]()||[];return _0x939e16[_0x4bcb27(0x29e)](_0x64aa5d=>{const _0x374269=_0x4bcb27;let _0x467b8e=getBotAttributes(_0x64aa5d[_0x374269(0x377)]);_0x64aa5d['mode']=_0x467b8e[_0x374269(0x1d5)];}),_0x939e16;}function getBotExchanges(){const _0x29cd21=_0x3b3dcf;let _0x3be22e=[];const _0x1bcb17=dbConfig[_0x29cd21(0x2bf)](_0x29cd21(0x341))[_0x29cd21(0x367)]('botID')[_0x29cd21(0x1c2)]()||[];_0x1bcb17['forEach'](_0x348bf3=>{const _0x5d7107=_0x29cd21;if(_0x348bf3[_0x5d7107(0x1ab)]==_0x5d7107(0x2df)){const _0x34d0b1=configpath+'bot-'+_0x348bf3['botID']+'-config.json',_0x265d61=fs[_0x5d7107(0x305)](_0x34d0b1);let _0x3f32c5;if(_0x265d61){const _0x44532c=fs[_0x5d7107(0x356)](_0x34d0b1);try{const _0xb03f82=JSON[_0x5d7107(0x1fe)](_0x44532c);_0x3f32c5=_0xb03f82?_0xb03f82[_0x5d7107(0x29c)][0x0][_0x5d7107(0x2a1)]:null;}catch(_0xdedd29){}}if(_0x3f32c5)_0x3be22e[_0x5d7107(0x264)](_0x3f32c5);}});const _0x33b80c=[...new Set(_0x3be22e)][_0x29cd21(0x296)]();return _0x33b80c;}async function initUser(){const _0x35ba1f=_0x3b3dcf;if(!settings[_0x35ba1f(0x217)]){const _0x46f68d=uuidRandom();mixpanel[_0x35ba1f(0x391)](_0x46f68d),updateSetting('userid',_0x46f68d);}}async function initSecure(){const _0x309730=_0x3b3dcf;let _0x364ebf=getSecure();if(!_0x364ebf[_0x309730(0x235)]('secret')){let _0x311589=await generateKeys();_0x364ebf[_0x309730(0x393)]=_0x311589['publicKey'],_0x364ebf[_0x309730(0x289)]=_0x311589[_0x309730(0x289)],_0x364ebf[_0x309730(0x2c5)]=crypto[_0x309730(0x211)](0x20)[_0x309730(0x2b8)](_0x309730(0x21b));;storeSecure(_0x364ebf);}}function getSettings(){const _0x59e9b9=_0x3b3dcf;return dbSettings[_0x59e9b9(0x2bf)]('settings')[_0x59e9b9(0x1c2)]()||{};}function getSecure(){const _0x3f1253=_0x3b3dcf;return dbSecure['get'](_0x3f1253(0x1cc))[_0x3f1253(0x1c2)]()||{};}function getBlacklist(){const _0x32b7c6=_0x3b3dcf;return dbSecure[_0x32b7c6(0x2bf)](_0x32b7c6(0x31f))[_0x32b7c6(0x1c2)]()||[];}function broadcastToBots(_0x272cfd,_0x229832){const _0x20ef7d=_0x3b3dcf;config[_0x20ef7d(0x29e)](_0x32551a=>{const _0x1af3f4=_0x20ef7d;if(_0x32551a[_0x1af3f4(0x1ab)]==_0x1af3f4(0x2df)&&_0x32551a[_0x1af3f4(0x347)]==_0x1af3f4(0x30e)||_0x32551a['status']=='new'&&_0x32551a[_0x1af3f4(0x347)]==_0x1af3f4(0x30e)){if(pid[_0x32551a['botID']])pid[_0x32551a[_0x1af3f4(0x377)]][_0x1af3f4(0x2e1)]({[_0x272cfd]:_0x229832});}});}async function storeSettings(_0x459ff6,_0x5d7dd4=![]){const _0x37957d=_0x3b3dcf;_0x459ff6={...settings,..._0x459ff6};if(_0x5d7dd4&&_0x459ff6[_0x37957d(0x37b)]!=_0x37957d(0x388)&&_0x459ff6[_0x37957d(0x37b)]!='***'&&_0x459ff6['bbPassword']!=''){const _0x1200b0=decryptRSA(secure[_0x37957d(0x289)],_0x459ff6[_0x37957d(0x37b)])[_0x37957d(0x1f7)]('|@|')[0x0],_0xcecf74=bcrypt[_0x37957d(0x2b5)](_0x1200b0,saltRounds);_0x459ff6={..._0x459ff6,'bbPassword':_0xcecf74};}if(_0x5d7dd4&&_0x459ff6[_0x37957d(0x36a)]!=_0x37957d(0x388)&&_0x459ff6[_0x37957d(0x36a)]!='***'&&_0x459ff6['telegramToken']!=''){const _0x4c4064=decryptRSA(secure[_0x37957d(0x289)],_0x459ff6[_0x37957d(0x36a)])[_0x37957d(0x1f7)](_0x37957d(0x21a))[0x0];_0x459ff6={..._0x459ff6,'telegramToken':_0x4c4064};}if(_0x5d7dd4&&_0x459ff6[_0x37957d(0x29a)]!=_0x37957d(0x388)&&_0x459ff6[_0x37957d(0x29a)]!=_0x37957d(0x340)&&_0x459ff6['marketcapApi']!=''){const _0x3a4ca0=decryptRSA(secure[_0x37957d(0x289)],_0x459ff6[_0x37957d(0x29a)])[_0x37957d(0x1f7)](_0x37957d(0x21a))[0x0];_0x459ff6={..._0x459ff6,'marketcapApi':_0x3a4ca0};}const _0x1a532c=_0x459ff6['telegramToken']!=_0x37957d(0x388)&&_0x459ff6[_0x37957d(0x36a)]!=settings[_0x37957d(0x36a)]||_0x459ff6[_0x37957d(0x343)]!=settings[_0x37957d(0x343)],_0x486840=_0x459ff6['telegramToken']==''||_0x459ff6[_0x37957d(0x343)]=='',_0x3fd2bb=_0x459ff6[_0x37957d(0x29a)]&&_0x459ff6[_0x37957d(0x29a)]!='************'&&_0x459ff6[_0x37957d(0x29a)]!=settings[_0x37957d(0x36a)];_0x1a532c&&(_0x459ff6['telegramChatId']=null,_0x459ff6[_0x37957d(0x214)]=_0x37957d(0x1c5));for(const [_0x59f6c6,_0x48765f]of Object[_0x37957d(0x2c0)](_0x459ff6)){if(_0x59f6c6==_0x37957d(0x36a)&&_0x48765f==_0x37957d(0x388)){_0x459ff6['telegramToken']=settings[_0x37957d(0x36a)];continue;};if(_0x59f6c6=='bbPassword'&&_0x48765f=='************'){_0x459ff6[_0x37957d(0x37b)]=settings['bbPassword'];continue;};if(_0x59f6c6==_0x37957d(0x29a)&&_0x48765f==_0x37957d(0x388)){_0x459ff6[_0x37957d(0x29a)]=settings[_0x37957d(0x29a)];continue;};dbSettings[_0x37957d(0x378)]('settings.'+_0x59f6c6,_0x48765f)['write']();}settings=_0x459ff6,io['to'](_0x37957d(0x35a))[_0x37957d(0x354)](_0x37957d(0x31d),cleanSettings()),broadcastToBots(_0x37957d(0x274),settings['timeshift']),broadcastToBots(_0x37957d(0x321),settings[_0x37957d(0x321)]),broadcastToBots(_0x37957d(0x29a),settings[_0x37957d(0x29a)]);if(_0x1a532c&&!_0x486840)initTelegram();if(_0x1a532c&&_0x486840)disableTelegram();getAllClients()['forEach'](_0x301eec=>{const _0x4188c6=_0x37957d;getSocket(_0x301eec['id'])[_0x4188c6(0x354)]('status',{'access':{'allow':![],'reason':'reload','token':null}});}),_0x3fd2bb&&(await sleep(0xbb8),testMarketcapApi(_0x459ff6[_0x37957d(0x29a)]));}async function testMarketcapApi(_0x594ddf){const _0x45a9c4=_0x3b3dcf,_0x12e975=[_0x45a9c4(0x20c),_0x45a9c4(0x277)];try{await axios[_0x45a9c4(0x2bf)](_0x45a9c4(0x1fc),{'headers':{'X-CMC_PRO_API_KEY':_0x594ddf},'params':{'symbol':_0x12e975['toString']()}});}catch(_0x2b861f){_0x2b861f[_0x45a9c4(0x2b8)]()[_0x45a9c4(0x1ea)](_0x45a9c4(0x275))?(io['to'](_0x45a9c4(0x35a))[_0x45a9c4(0x354)](_0x45a9c4(0x247),_0x45a9c4(0x2c3)),logger[_0x45a9c4(0x28f)](_0x45a9c4(0x2c3))):(io['to'](_0x45a9c4(0x35a))[_0x45a9c4(0x354)](_0x45a9c4(0x247),_0x45a9c4(0x355)),logger[_0x45a9c4(0x28f)](_0x45a9c4(0x355)),logger[_0x45a9c4(0x254)](_0x45a9c4(0x199),_0x2b861f[_0x45a9c4(0x2b8)]()+_0x45a9c4(0x299)+_0x2b861f['code']));return;}logger[_0x45a9c4(0x254)](_0x45a9c4(0x2b3));}function updateSetting(_0x12e840,_0xf1342e){const _0x17651b=_0x3b3dcf;dbSettings[_0x17651b(0x378)](_0x17651b(0x1a0)+_0x12e840,_0xf1342e)[_0x17651b(0x1c6)](),settings=getSettings(),io['to'](_0x17651b(0x35a))[_0x17651b(0x354)](_0x17651b(0x31d),cleanSettings());}function storeSecure(_0x2617ff){const _0x315a93=_0x3b3dcf;dbSecure[_0x315a93(0x2bf)](_0x315a93(0x1cc))[_0x315a93(0x264)](_0x2617ff)['write'](),secure=_0x2617ff;}function addBlacklist(_0x3cf989){const _0x18877d=_0x3b3dcf;cleanBlacklist();let _0x3d51bf;devices[_0x3cf989]['telegramIpApproval']?_0x3d51bf=Math[_0x18877d(0x38e)](devices[_0x3cf989][_0x18877d(0x2a5)][_0x18877d(0x215)],loginExpiry):_0x3d51bf=loginExpiry,dbSecure[_0x18877d(0x2bf)](_0x18877d(0x31f))[_0x18877d(0x264)]({'expiry':new Date()['getTime']()+_0x3d51bf*0x3c*0x3e8,'token':devices[_0x3cf989]['access'][_0x18877d(0x368)]})[_0x18877d(0x1c6)](),blacklist=dbSecure[_0x18877d(0x2bf)]('blacklist')[_0x18877d(0x1c2)]();}function cleanBlacklist(){const _0x3a11fc=_0x3b3dcf;let _0x13abf3=dbSecure[_0x3a11fc(0x2bf)](_0x3a11fc(0x31f))[_0x3a11fc(0x1b2)]()['value'](),_0x123709=new Date()[_0x3a11fc(0x324)]();_0x13abf3[_0x3a11fc(0x29e)](_0x48d7ac=>{const _0x4d2a5f=_0x3a11fc;_0x48d7ac[_0x4d2a5f(0x215)]<_0x123709&&dbSecure[_0x4d2a5f(0x2bf)]('blacklist')[_0x4d2a5f(0x1e5)]({'expiry':_0x48d7ac[_0x4d2a5f(0x215)]})[_0x4d2a5f(0x1c6)]();});}function initStates(){const _0x13954f=_0x3b3dcf;let _0x51499f=getConfiguration();_0x51499f[_0x13954f(0x29e)](_0x3c27c1=>{const _0x338b39=_0x13954f;_0x3c27c1[_0x338b39(0x347)]='stopped';}),storeConfiguration(_0x51499f);}async function generateKeys(){const _0x128537=_0x3b3dcf,_0x392952=forge['pki']['rsa'][_0x128537(0x1e2)]({'bits':0x1000,'e':0x10001}),_0x4d7491=forge[_0x128537(0x25b)][_0x128537(0x20d)](_0x392952[_0x128537(0x289)]),_0x811596=forge[_0x128537(0x25b)][_0x128537(0x1fb)](_0x392952[_0x128537(0x393)]);return{'privateKey':_0x4d7491,'publicKey':_0x811596};}async function oneTimeMigration(){const _0x2c757d=_0x3b3dcf;let _0x361567=getSettings(),_0x6387d1=![];!_0x361567[_0x2c757d(0x235)]('lastmsgtelegram')&&(_0x361567['lastmsgtelegram']=0x0,_0x6387d1=!![]);!_0x361567[_0x2c757d(0x235)]('lastmsgemitted')&&(_0x361567['lastmsgemitted']=0x0,_0x6387d1=!![]);!_0x361567['hasOwnProperty'](_0x2c757d(0x369))&&(_0x361567['latestversion']=_0x2c757d(0x270),_0x6387d1=!![]);!_0x361567[_0x2c757d(0x235)]('onepagemode')&&(_0x361567[_0x2c757d(0x321)]=![],_0x6387d1=!![]);!_0x361567[_0x2c757d(0x235)](_0x2c757d(0x29a))&&(_0x361567[_0x2c757d(0x29a)]='',_0x6387d1=!![]);if(_0x6387d1)storeSettings(_0x361567);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x2c757d(0x29e)](_0x371e97=>{const _0x395d43=_0x2c757d;if(!_0x371e97['isDirectory']()){if(!_0x371e97['name'][_0x395d43(0x38f)](_0x395d43(0x2b6)))fs[_0x395d43(0x399)](configbackuppath+_0x371e97[_0x395d43(0x27e)]);}else fs[_0x395d43(0x284)](configbackuppath+_0x371e97[_0x395d43(0x27e)],{'recursive':!![]});});}catch(_0x3ec52c){logger[_0x2c757d(0x254)]('Error\x20removing\x20old\x20backup\x20files:',_0x3ec52c);}}function storeConfiguration(_0x9b1e65){const _0x559f97=_0x3b3dcf;dbConfig['get'](_0x559f97(0x341))[_0x559f97(0x1e5)]()[_0x559f97(0x1c6)](),dbConfig[_0x559f97(0x2bf)](_0x559f97(0x341))[_0x559f97(0x264)](..._0x9b1e65)[_0x559f97(0x1c6)](),config=_0x9b1e65;}async function resetPassword(){const _0x1c1cb5=_0x3b3dcf;if(tgBot&&settings['telegramChatId']){const _0x5a6e8f=Markup[_0x1c1cb5(0x361)]([Markup[_0x1c1cb5(0x37a)][_0x1c1cb5(0x1cb)]('yes','resetpw_yes'),Markup[_0x1c1cb5(0x37a)][_0x1c1cb5(0x1cb)]('no',_0x1c1cb5(0x314))]);await sendTelegram(settings[_0x1c1cb5(0x1ca)],_0x1c1cb5(0x1ef),_0x5a6e8f),tgBot[_0x1c1cb5(0x389)](/resetpw_(.+)/,async _0x30ffab=>{const _0x5b041b=_0x1c1cb5,_0x4fc434=_0x30ffab[_0x5b041b(0x2f2)][0x1];_0x30ffab[_0x5b041b(0x2ae)]();if(_0x4fc434!='no'){const _0x1692c=0xf,_0x268696='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x171517=Array[_0x5b041b(0x398)](crypto[_0x5b041b(0x1bc)](new Uint32Array(_0x1692c)))[_0x5b041b(0x27d)](_0x47b6e4=>_0x268696[_0x47b6e4%_0x268696[_0x5b041b(0x24f)]])['join'](''),_0x6489c5=bcrypt[_0x5b041b(0x2b5)](_0x171517,saltRounds);storeSettings({'bbPassword':_0x6489c5}),await sendTelegram(_0x30ffab[_0x5b041b(0x2ee)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x171517,{'parse_mode':_0x5b041b(0x30f)});}else await sendTelegram(_0x30ffab['chat']['id'],_0x5b041b(0x2e9));});}}async function confirmRestore(_0x37d208,_0x231ae4){const _0x309af5=_0x3b3dcf;io['to'](_0x309af5(0x35a))['emit']('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x309af5(0x2c2));if(tgBot&&settings[_0x309af5(0x1ca)]){const _0x3a00e7=uuidRandom();tmpStorage[_0x3a00e7]={'path':_0x37d208,'filename':_0x231ae4};const _0x4e146a=Markup[_0x309af5(0x361)]([Markup[_0x309af5(0x37a)][_0x309af5(0x1cb)]('yes',_0x309af5(0x33a)+_0x3a00e7),Markup[_0x309af5(0x37a)][_0x309af5(0x1cb)]('no',_0x309af5(0x291)+_0x3a00e7)]);await sendTelegram(settings[_0x309af5(0x1ca)],_0x309af5(0x257),_0x4e146a),tgBot[_0x309af5(0x389)](/restore_(.+)_(.+)/,async _0x5ec3da=>{const _0x336d83=_0x309af5,_0x179563=_0x5ec3da[_0x336d83(0x2f2)][0x1],_0x23b1f5=_0x5ec3da[_0x336d83(0x2f2)][0x2],{path:_0x1b877e,filename:_0x55d45c}=tmpStorage[_0x23b1f5];delete tmpStorage[_0x23b1f5],_0x5ec3da[_0x336d83(0x2ae)](),_0x179563==_0x336d83(0x239)?(logger[_0x336d83(0x254)](_0x336d83(0x31c)),await sendTelegram(_0x5ec3da['chat']['id'],_0x336d83(0x267),{'parse_mode':_0x336d83(0x30f)}),unzipFile(_0x1b877e,_0x55d45c)):(logger[_0x336d83(0x254)](_0x336d83(0x223)),await sendTelegram(_0x5ec3da[_0x336d83(0x2ee)]['id'],_0x336d83(0x223)));});}}function getServerTime(){const _0x1a309d=_0x3b3dcf,_0x3e3f3c=new Date();return _0x3e3f3c['getFullYear']()+'/'+(_0x3e3f3c[_0x1a309d(0x288)]()+0x1)['toString']()[_0x1a309d(0x32d)](0x2,'0')+'/'+_0x3e3f3c['getDate']()['toString']()[_0x1a309d(0x32d)](0x2,'0')+'\x20'+_0x3e3f3c[_0x1a309d(0x249)]()['toString']()[_0x1a309d(0x32d)](0x2,'0')+':'+_0x3e3f3c['getMinutes']()[_0x1a309d(0x2b8)]()[_0x1a309d(0x32d)](0x2,'0')+':'+_0x3e3f3c['getSeconds']()['toString']()[_0x1a309d(0x32d)](0x2,'0');}function getTimeStamp(){const _0x219c7e=_0x3b3dcf,_0x2c36c7=shiftedTime();return _0x2c36c7['getFullYear']()+'/'+(_0x2c36c7[_0x219c7e(0x288)]()+0x1)[_0x219c7e(0x2b8)]()[_0x219c7e(0x32d)](0x2,'0')+'/'+_0x2c36c7[_0x219c7e(0x222)]()[_0x219c7e(0x2b8)]()[_0x219c7e(0x32d)](0x2,'0')+'\x20'+_0x2c36c7[_0x219c7e(0x249)]()['toString']()[_0x219c7e(0x32d)](0x2,'0')+':'+_0x2c36c7['getMinutes']()['toString']()[_0x219c7e(0x32d)](0x2,'0')+':'+_0x2c36c7[_0x219c7e(0x2e6)]()[_0x219c7e(0x2b8)]()[_0x219c7e(0x32d)](0x2,'0');}function getCleanTimeStamp(){const _0x49d8db=_0x3b3dcf,_0x558986=shiftedTime();return _0x558986['getFullYear']()+(_0x558986[_0x49d8db(0x288)]()+0x1)[_0x49d8db(0x2b8)]()['padStart'](0x2,'0')+_0x558986[_0x49d8db(0x222)]()[_0x49d8db(0x2b8)]()['padStart'](0x2,'0')+'-'+_0x558986[_0x49d8db(0x249)]()[_0x49d8db(0x2b8)]()[_0x49d8db(0x32d)](0x2,'0')+_0x558986[_0x49d8db(0x1ac)]()[_0x49d8db(0x2b8)]()[_0x49d8db(0x32d)](0x2,'0')+_0x558986[_0x49d8db(0x2e6)]()[_0x49d8db(0x2b8)]()[_0x49d8db(0x32d)](0x2,'0');}function shiftedTime(){const _0x4494c8=_0x3b3dcf,_0x3be449=new Date();let _0x337549=_0x3be449;if(settings[_0x4494c8(0x274)]&&settings['timeshift']!==0x0)_0x337549=fns['add'](_0x3be449,{'hours':settings[_0x4494c8(0x274)]});return _0x337549;}async function startScheduler(){const _0x1571d6=_0x3b3dcf,_0x523c00=new Date()[_0x1571d6(0x272)](),_0xb5186e=shiftedTime()['getHours']();_0xb5186e==0x4&&backupConfigFiles(),_0xb5186e==0x0&&rotateLogFiles(),_0x523c00%0x6==0x0&&triggerAnalytics(),_0x523c00%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5a9968){const _0xda9ac4=_0x3b3dcf;logger[_0xda9ac4(0x254)](_0xda9ac4(0x287)+_0x5a9968);const _0x1aea3c=getBotsWithMode();_0x1aea3c[_0xda9ac4(0x24f)]>0x0?confirmRestore(configbackuppath,_0x5a9968):unzipFile(configbackuppath,_0x5a9968);}async function getBackupFiles(_0x4ed8ee=null){const _0x499ee5=_0x3b3dcf;let _0x265ef6=[],_0x15f437=fs[_0x499ee5(0x1b9)](configbackuppath,{'withFileTypes':!![]});_0x15f437['sort']((_0x72e3f8,_0xb7f2ab)=>_0x72e3f8[_0x499ee5(0x27e)]<_0xb7f2ab[_0x499ee5(0x27e)]?0x1:_0xb7f2ab['name']<_0x72e3f8[_0x499ee5(0x27e)]?-0x1:0x0),_0x15f437[_0x499ee5(0x29e)](_0x422467=>{const _0x7056ed=_0x499ee5;if(!_0x422467[_0x7056ed(0x2d9)]()&&_0x422467[_0x7056ed(0x27e)][_0x7056ed(0x38f)](_0x7056ed(0x2b6))&&_0x422467['name'][_0x7056ed(0x221)](_0x7056ed(0x29f))){const _0xd70115=formatDate(fs[_0x7056ed(0x36d)](configbackuppath+_0x422467[_0x7056ed(0x27e)])['mtime']);_0x265ef6[_0x7056ed(0x264)]({'name':_0x422467[_0x7056ed(0x27e)],'mtime':_0xd70115});}});if(_0x4ed8ee)io['to'](_0x4ed8ee)[_0x499ee5(0x354)](_0x499ee5(0x293),_0x265ef6);else return _0x265ef6;}async function backupConfigFiles(){const _0x46995b=_0x3b3dcf;await zipFiles(_0x46995b(0x1c3));const _0x190543=getCleanTimeStamp();fs[_0x46995b(0x237)](zippath+_0x46995b(0x2fc),configbackuppath+('backup-full@'+_0x190543+_0x46995b(0x29f)));let _0x4ba722=fs[_0x46995b(0x1b9)](configbackuppath,{'withFileTypes':!![]});_0x4ba722[_0x46995b(0x296)]((_0x3255fa,_0x4bd96d)=>_0x3255fa[_0x46995b(0x27e)]<_0x4bd96d['name']?0x1:_0x4bd96d['name']<_0x3255fa['name']?-0x1:0x0),_0x4ba722[_0x46995b(0x24f)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4ba722[_0x4ba722[_0x46995b(0x24f)]-0x1][_0x46995b(0x27e)]);}function rotateLogFiles(){const _0x221c38=_0x3b3dcf,_0x570152=fs[_0x221c38(0x36d)](logspath+_0x221c38(0x285)),_0x23a6fa=_0x570152[_0x221c38(0x212)]/0x400;if(_0x23a6fa>0x64){let _0x537e51=fs[_0x221c38(0x1b9)](logspath,{'withFileTypes':!![]});_0x537e51['sort']((_0x484beb,_0x92cd0d)=>_0x484beb[_0x221c38(0x27e)]<_0x92cd0d[_0x221c38(0x27e)]?0x1:_0x92cd0d[_0x221c38(0x27e)]<_0x484beb[_0x221c38(0x27e)]?-0x1:0x0),_0x537e51[_0x221c38(0x29e)](_0x16cabf=>{const _0x58865a=_0x221c38;if(_0x16cabf['name']=='output-002.log')fs[_0x58865a(0x237)](logspath+_0x16cabf[_0x58865a(0x27e)],logspath+_0x58865a(0x387));if(_0x16cabf['name']=='output-001.log')fs[_0x58865a(0x237)](logspath+_0x16cabf[_0x58865a(0x27e)],logspath+_0x58865a(0x27f));_0x16cabf[_0x58865a(0x27e)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x16cabf[_0x58865a(0x27e)],logspath+_0x58865a(0x33d)),fs[_0x58865a(0x39a)](logspath+_0x16cabf[_0x58865a(0x27e)],''));});}}async function zipFiles(_0x4c5458){const _0x5447f7=_0x3b3dcf;let _0x3edf15;if(_0x4c5458==_0x5447f7(0x206))_0x3edf15=logspath;if(_0x4c5458=='backup')_0x3edf15=configpath;if(_0x4c5458==_0x5447f7(0x1c3))_0x3edf15=configpath;let _0x511ec0=fs[_0x5447f7(0x1b9)](_0x3edf15,{'withFileTypes':!![]});const _0x2fa3de=new JSZip();_0x511ec0[_0x5447f7(0x29e)](_0x206ccd=>{const _0x51758a=_0x5447f7;if(!_0x206ccd['isDirectory']()){let _0x366052=fs[_0x51758a(0x356)](_0x3edf15+_0x206ccd[_0x51758a(0x27e)]);if(_0x4c5458=='backup'){const _0x3288dd=/^bot-[0-9]{3}-config.json$/,_0x28d485=_0x3288dd[_0x51758a(0x283)](_0x206ccd['name']);if(_0x28d485){const _0x49114f=JSON['parse'](_0x366052);if(_0x49114f[_0x51758a(0x29c)][0x0]){_0x49114f['bot'][0x0]['apiKey']=_0x51758a(0x340),_0x49114f[_0x51758a(0x29c)][0x0]['apiSecret']=_0x51758a(0x340);if(_0x49114f['bot'][0x0][_0x51758a(0x1bd)])_0x49114f['bot'][0x0][_0x51758a(0x1bd)]=_0x51758a(0x340);}_0x366052=JSON['stringify'](_0x49114f,null,0x2);}if(_0x206ccd[_0x51758a(0x27e)]==_0x51758a(0x33c)){const _0x2e1b43=JSON[_0x51758a(0x1fe)](_0x366052);if(_0x2e1b43[_0x51758a(0x31d)]['loginRequired'])_0x2e1b43['settings'][_0x51758a(0x2a3)]=![];if(_0x2e1b43[_0x51758a(0x31d)][_0x51758a(0x37b)])_0x2e1b43['settings']['bbPassword']=_0x51758a(0x340);if(_0x2e1b43[_0x51758a(0x31d)]['telegramToken'])_0x2e1b43[_0x51758a(0x31d)][_0x51758a(0x36a)]=_0x51758a(0x340);if(_0x2e1b43[_0x51758a(0x31d)][_0x51758a(0x1ca)])_0x2e1b43[_0x51758a(0x31d)][_0x51758a(0x1ca)]=null;if(_0x2e1b43[_0x51758a(0x31d)][_0x51758a(0x29a)])_0x2e1b43[_0x51758a(0x31d)][_0x51758a(0x29a)]='***';_0x366052=JSON[_0x51758a(0x1e1)](_0x2e1b43,null,0x2);}if(_0x206ccd[_0x51758a(0x27e)]!=_0x51758a(0x1e4))_0x2fa3de[_0x51758a(0x1a4)](_0x206ccd[_0x51758a(0x27e)],_0x366052);}else _0x2fa3de[_0x51758a(0x1a4)](_0x206ccd[_0x51758a(0x27e)],_0x366052);}});const _0x1d73b1=await _0x2fa3de[_0x5447f7(0x342)]({'type':_0x5447f7(0x331),'base64':![],'compression':_0x5447f7(0x328)});fs[_0x5447f7(0x39a)](zippath+(_0x4c5458+_0x5447f7(0x29f)),_0x1d73b1,_0x5447f7(0x280));}async function unzipFile(_0x398b82,_0x1d42ea){const _0x2f8851=_0x3b3dcf;fs[_0x2f8851(0x1b9)](configpath,{'withFileTypes':!![]})[_0x2f8851(0x29e)](_0x504f5f=>{if(!_0x504f5f['isDirectory']())fs['rmSync'](configpath+_0x504f5f['name']);});const _0x3c2fb6=fs[_0x2f8851(0x356)](_0x398b82+_0x1d42ea,_0x2f8851(0x280)),_0x128817=await JSZip[_0x2f8851(0x35c)](_0x3c2fb6,{'base64':![],'checkCRC32':!![]});for(const _0xf1d084 of Object[_0x2f8851(0x33f)](_0x128817['files'])){const _0x35411e=_0x128817['files'][_0xf1d084],_0x106d02=await _0x35411e[_0x2f8851(0x23d)]('string');fs[_0x2f8851(0x39a)](configpath+_0x35411e['name'],_0x106d02);}fs[_0x2f8851(0x1b9)](temppath,{'withFileTypes':!![]})[_0x2f8851(0x29e)](_0x2af8b5=>{const _0xa89ab5=_0x2f8851;if(!_0x2af8b5[_0xa89ab5(0x2d9)]())fs[_0xa89ab5(0x284)](temppath+_0x2af8b5[_0xa89ab5(0x27e)]);}),logger[_0x2f8851(0x254)](_0x2f8851(0x281)),process[_0x2f8851(0x2e1)]({'restore':!![]},_0x181b28=>{});}function _0x156b(_0x359db9,_0x46ceb6){const _0x53566d=_0x150f();return _0x156b=function(_0x132a53,_0xa3089d){_0x132a53=_0x132a53-0x193;let _0x150f23=_0x53566d[_0x132a53];return _0x150f23;},_0x156b(_0x359db9,_0x46ceb6);}async function getPublicIp(){const _0x26cdd1=_0x3b3dcf;try{const _0x31292=await axios['get'](_0x26cdd1(0x31e));publicip=_0x31292[_0x26cdd1(0x207)]['ip'];}catch(_0x5ef936){}}async function triggerAnalytics(){const _0x1e8fbc=_0x3b3dcf;if(!publicip)await getPublicIp();const _0x5583c7=getBotsWithMode();let _0xf9f67c=0x0;_0x5583c7[_0x1e8fbc(0x29e)](_0x5d3291=>{const _0x197e91=_0x1e8fbc;if(_0x5d3291[_0x197e91(0x1ab)]==='enabled')_0xf9f67c++;});const _0x1e8c83=getBotExchanges();mixpanel['track'](_0x1e8fbc(0x2a2),{'distinct_id':settings[_0x1e8fbc(0x217)],'ip':publicip,'version':serverversion,'numbots':_0x5583c7[_0x1e8fbc(0x24f)],'numbotsenabled':_0xf9f67c,'exchanges':_0x1e8c83,'environment':environment});}async function getMessages(){const _0x4d156f=_0x3b3dcf,_0x418744=_0x4d156f(0x241),_0x1a0a03=new GraphQLClient(_0x418744),_0x14b99a={'authorization':_0x4d156f(0x1c7)},_0xed9e8d=serverversion[_0x4d156f(0x1f7)]('.'),_0x310f81=_0xed9e8d[0x0]+'.'+_0xed9e8d[0x1],_0x3582c4=Math['min'](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x4d858e={'last':parseInt(_0x3582c4),'bbm':_0x310f81},_0xed4dfd=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x48cdbd;try{_0x48cdbd=await _0x1a0a03[_0x4d156f(0x24d)](_0xed4dfd,_0x4d858e,_0x14b99a);}catch(_0x1ac2af){}if(_0x48cdbd&&_0x48cdbd[_0x4d156f(0x1b5)]){let _0xa90e54=settings[_0x4d156f(0x322)];newMessages=[];for(const _0x5c0d7c of _0x48cdbd[_0x4d156f(0x1b5)]){newMessages[_0x4d156f(0x264)](_0x5c0d7c);let _0xdb1085=![];_0x5c0d7c[_0x4d156f(0x269)]&&(updateSetting(_0x4d156f(0x369),_0x5c0d7c[_0x4d156f(0x269)]),_0xdb1085=isNewerVersion(serverversion,_0x5c0d7c['bbvNew'])||serverversion==_0x5c0d7c[_0x4d156f(0x269)]);if(!_0xdb1085&&_0x5c0d7c['number']>_0xa90e54){if(_0x5c0d7c[_0x4d156f(0x317)]===_0x4d156f(0x2d2)||serverversion[_0x4d156f(0x38f)](_0x5c0d7c[_0x4d156f(0x317)])){let _0x5d97d5=''+_0x5c0d7c[_0x4d156f(0x243)]+'\x0a\x0a'+_0x5c0d7c['message'];const _0x245fca=await sendTelegramMsg(toTelegramMarkdown(_0x5d97d5),_0x4d156f(0x24e));if(_0x245fca)_0xa90e54=_0x5c0d7c[_0x4d156f(0x2ce)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0xa90e54),emitMessages();}}function emitMessages(){const _0x186561=_0x3b3dcf,_0x54062e=settings['lastmsgemitted'];let _0x175baa=[];newMessages[_0x186561(0x29e)](_0x179850=>{const _0x11da93=_0x186561;_0x179850[_0x11da93(0x2ce)]>_0x54062e&&_0x175baa[_0x11da93(0x264)](_0x179850);}),_0x175baa[_0x186561(0x24f)]>0x0&&getAllClients()[_0x186561(0x29e)](_0xb82316=>{const _0x5906db=_0x186561;getSocket(_0xb82316['id'])[_0x5906db(0x354)](_0x5906db(0x23f),_0x175baa);});}function confirmMessage(_0x2a2ef0){const _0x18993d=_0x3b3dcf;updateSetting(_0x18993d(0x2f1),Number(_0x2a2ef0));}function isNewerVersion(_0x5ea1b4,_0x35ff74){const _0x5a849a=_0x3b3dcf,_0x5d5eff=_0x35ff74[_0x5a849a(0x1f7)]('.'),_0x14dbba=_0x5ea1b4[_0x5a849a(0x1f7)]('.');for(var _0x593284=0x0;_0x593284<_0x14dbba[_0x5a849a(0x24f)];_0x593284++){const _0x51d526=~~_0x14dbba[_0x593284],_0x3be24d=~~_0x5d5eff[_0x593284];if(_0x51d526>_0x3be24d)return!![];if(_0x51d526<_0x3be24d)return![];}return![];}function toTelegramMarkdown(_0x18bb4f){const _0x5aa719=_0x3b3dcf,_0x254374=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x529f31=/\*{2}(.+?)\*{2}/gim;return _0x18bb4f=_0x18bb4f[_0x5aa719(0x251)](_0x254374,'$1_$2_$3')[_0x5aa719(0x251)](_0x529f31,_0x5aa719(0x320)),_0x18bb4f;}async function validateConfigFile(){const _0x19a6c6=_0x3b3dcf,_0x41d156=dbConfig['get'](_0x19a6c6(0x341))[_0x19a6c6(0x367)]('botID')[_0x19a6c6(0x1c2)]()||[];if(_0x41d156['length']==0x0){let _0x3c9e0f=0x0,_0x49f4b1=[];const _0x5a1133=/^bot-([0-9]{3})-config.json$/,_0x235278=fs['readdirSync'](configpath);_0x235278[_0x19a6c6(0x29e)](_0x4db967=>{const _0x3367b5=_0x19a6c6,_0x28bc99=_0x5a1133['exec'](_0x4db967);if(_0x28bc99){const _0x32308a=_0x28bc99[0x1];let _0x49d39c=getBotAttributes(_0x32308a);_0x49f4b1[_0x3367b5(0x264)]({'botID':_0x32308a,'botname':_0x49d39c[_0x3367b5(0x37c)],'status':'disabled','live':'stopped'}),_0x3c9e0f++;}}),_0x3c9e0f!=0x0&&(dbConfig[_0x19a6c6(0x2bf)](_0x19a6c6(0x341))[_0x19a6c6(0x34d)](_0x49f4b1)['write'](),config=_0x49f4b1,restoredConfigFile=_0x3c9e0f);}}async function restoreConfigNotify(_0x393653){const _0x78075f=_0x3b3dcf;let _0x16cefb;if(restoredConfigFile==0x1)_0x16cefb=_0x78075f(0x349);else _0x16cefb='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x393653)io['to']('botmanager')[_0x78075f(0x354)]('notification',_0x16cefb);else{logger['simple'](_0x78075f(0x1da)),logger[_0x78075f(0x233)](_0x16cefb),logger[_0x78075f(0x233)](_0x78075f(0x1da)),logger[_0x78075f(0x233)]('');if(tgBot&&settings[_0x78075f(0x1ca)]&&settings[_0x78075f(0x214)]!=_0x78075f(0x228))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x16cefb);}}function decryptRSA(_0x40acfb,_0x5c57ad){const _0x454b8b=_0x3b3dcf,_0x1475ad=forge[_0x454b8b(0x25b)][_0x454b8b(0x26a)](_0x40acfb),_0x33bed6=_0x1475ad[_0x454b8b(0x344)](forge[_0x454b8b(0x36b)]['decode64'](_0x5c57ad),_0x454b8b(0x2e2),{'md':forge['md'][_0x454b8b(0x2a6)][_0x454b8b(0x22d)](),'mgf1':{'md':forge['md'][_0x454b8b(0x2a6)]['create']()}});return _0x33bed6;}function validateCredentials(_0xbb1b74,_0x3324aa){const _0x43297d=_0x3b3dcf;if(_0xbb1b74[_0x43297d(0x311)]==settings[_0x43297d(0x39c)]&&bcrypt['compareSync'](_0xbb1b74[_0x43297d(0x259)],settings[_0x43297d(0x37b)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x43297d(0x2ec),'token':null};else{const _0x13a8d2=generateLoginToken(_0x3324aa);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x13a8d2};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x591e5b){const _0x2a8e97=generateLoginToken(_0x591e5b);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2a8e97};}function validateAccess(_0x24f38b,_0x286d90,_0x53e9c4){const _0x4ad837=_0x3b3dcf,_0x4aeed3=_0x53e9c4?_0x53e9c4:devices[_0x286d90]['ip'];let _0x58f62f;const _0x2e8532=_0x3229d3=>{const _0x555249=_0x156b;if(settings['loginRequired']){if(settings[_0x555249(0x2be)]){if(telegram2FaApproved(_0x286d90)){const _0x410903=generateLoginToken(_0x286d90);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x410903};}else return{'allow':![],'reason':_0x555249(0x1cf),'token':null};}else return _0x58f62f=validToken(_0x3229d3,_0x286d90),_0x58f62f[_0x555249(0x235)](_0x555249(0x2c2))?{'allow':!![],'reason':_0x555249(0x370),'token':_0x3229d3}:{'allow':![],'reason':_0x555249(0x1cf),'token':null};}else return{'allow':!![],'reason':_0x555249(0x1a8),'token':null};};if(settings[_0x4ad837(0x312)]){let _0x627c67=[...settings[_0x4ad837(0x224)],'::1',_0x4ad837(0x1a5),_0x4ad837(0x20e)];if(_0x627c67[_0x4ad837(0x1ea)](_0x4aeed3))return _0x2e8532(_0x24f38b);else{_0x58f62f=validToken(_0x24f38b,_0x286d90);if(_0x58f62f['hasOwnProperty'](_0x4ad837(0x2c2)))return _0x2e8532(_0x24f38b);else{if(telegramIpApproved(_0x286d90)){const _0x397f5c=generateToken(_0x286d90);return _0x58f62f=_0x2e8532(_0x24f38b),_0x58f62f[_0x4ad837(0x226)]?{'allow':!![],'reason':_0x4ad837(0x19a),'token':_0x397f5c}:_0x58f62f;}else return settings[_0x4ad837(0x372)]?{'allow':![],'reason':_0x4ad837(0x2f4),'token':null}:{'allow':![],'reason':_0x4ad837(0x2b7),'token':null};}}}else return _0x2e8532(_0x24f38b);}function timelyDecrypt(_0x4cbb45,_0x329e69,_0x13d165='@'){const _0x5afa97=_0x3b3dcf;if(_0x4cbb45)try{const _0x195475=decryptRSA(secure[_0x5afa97(0x289)],_0x4cbb45),_0x53758c=_0x195475[_0x5afa97(0x1f7)](_0x13d165)[0x0],_0x52c6e2=_0x195475[_0x5afa97(0x1f7)](_0x13d165)[0x1],_0x181037=new Date()[_0x5afa97(0x324)]();if(_0x329e69){if(_0x181037-_0x52c6e2<maxSecretAge*0x3e8)return _0x53758c;else return![];}else return _0x53758c;}catch(_0x3e1495){return![];}else return![];}const validToken=(_0x38dc76,_0x208106)=>{const _0x2d7541=_0x3b3dcf,_0x218885=devices[_0x208106]['ip'];if(!_0x38dc76)return{'error':_0x2d7541(0x2d8)};for(let _0x58a64d of blacklist){if(_0x58a64d[_0x2d7541(0x368)]==_0x38dc76)return{'error':_0x2d7541(0x258)};}let _0x47dfe9;try{_0x47dfe9=jwt[_0x2d7541(0x310)](_0x38dc76,secure[_0x2d7541(0x2c5)]+_0x208106);}catch{return{'error':_0x2d7541(0x373)};}if(!_0x47dfe9['hasOwnProperty'](_0x2d7541(0x39b))&&!_0x47dfe9[_0x2d7541(0x235)](_0x2d7541(0x311))||!_0x47dfe9[_0x2d7541(0x235)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x47dfe9[_0x2d7541(0x235)](_0x2d7541(0x311))&&_0x47dfe9[_0x2d7541(0x235)]('clientip')){const {clientip:_0x3279c0}=_0x47dfe9;return _0x218885==_0x3279c0?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2d7541(0x313)};}else{if(_0x47dfe9[_0x2d7541(0x235)](_0x2d7541(0x311))&&_0x47dfe9[_0x2d7541(0x235)]('clientip')){const {username:_0x122905,clientip:_0x5593a0}=_0x47dfe9;return settings['bbUsername']==_0x122905&&_0x218885==_0x5593a0?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x57d496=>{const _0x30f409=_0x3b3dcf;if(_0x57d496){const _0x3cb6df=devices[_0x57d496]['ip'];return jwt['sign']({'username':settings[_0x30f409(0x39c)],'clientip':_0x3cb6df},secure[_0x30f409(0x2c5)]+_0x57d496,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4cd34d=>{const _0x508f33=_0x3b3dcf;if(_0x4cd34d){const _0xa32198=devices[_0x4cd34d]['ip'];return jwt[_0x508f33(0x1ae)]({'clientip':_0xa32198},secure[_0x508f33(0x2c5)]+_0x4cd34d,{'expiresIn':devices[_0x4cd34d][_0x508f33(0x2a5)][_0x508f33(0x215)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x181f32=>{const _0x110c61=_0x3b3dcf;let _0x14480c=![];return devices[_0x181f32][_0x110c61(0x2a5)]&&devices[_0x181f32]['telegramIpApproval']['expiry']!=_0x110c61(0x1b1)&&(_0x14480c=devices[_0x181f32][_0x110c61(0x2a5)][_0x110c61(0x39b)]==devices[_0x181f32]['ip']&&new Date()[_0x110c61(0x324)]()-devices[_0x181f32]['telegramIpApproval'][_0x110c61(0x30d)]<devices[_0x181f32]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x14480c;},telegram2FaApproved=_0x19d8f9=>{const _0x9c1861=_0x3b3dcf;let _0x4d631a=![];return devices[_0x19d8f9][_0x9c1861(0x238)]&&devices[_0x19d8f9]['telegram2FaApproval'][_0x9c1861(0x215)]!=_0x9c1861(0x1b1)&&(_0x4d631a=devices[_0x19d8f9][_0x9c1861(0x238)][_0x9c1861(0x39b)]==devices[_0x19d8f9]['ip']&&new Date()[_0x9c1861(0x324)]()-devices[_0x19d8f9]['telegram2FaApproval'][_0x9c1861(0x30d)]<devices[_0x19d8f9]['telegram2FaApproval'][_0x9c1861(0x215)]*0x3c*0x3e8),_0x4d631a;},normalizeIP=_0x3aafb5=>{const _0x200a2b=_0x3b3dcf;let _0x58b383=null,_0x2f1f70=null;if(ipaddr['isValid'](_0x3aafb5)){const _0x34a914=ipaddr[_0x200a2b(0x1fe)](_0x3aafb5);_0x34a914[_0x200a2b(0x2af)]()===_0x200a2b(0x1b0)?(_0x34a914[_0x200a2b(0x381)]()&&(_0x58b383=_0x34a914['toIPv4Address']()[_0x200a2b(0x2b8)]()),_0x2f1f70=_0x34a914[_0x200a2b(0x2b8)]()):(_0x58b383=_0x34a914['toString'](),_0x2f1f70=_0x34a914[_0x200a2b(0x1fa)]()[_0x200a2b(0x2b8)]());}return{'show':_0x58b383?_0x58b383:_0x2f1f70,'store':_0x2f1f70};};function formatDate(_0x473874){const _0x16ba66=_0x3b3dcf;return _0x473874[_0x16ba66(0x2c8)]()+'/'+(_0x473874[_0x16ba66(0x288)]()+0x1)[_0x16ba66(0x2b8)]()[_0x16ba66(0x32d)](0x2,'0')+'/'+_0x473874[_0x16ba66(0x222)]()[_0x16ba66(0x2b8)]()[_0x16ba66(0x32d)](0x2,'0')+'\x20'+_0x473874[_0x16ba66(0x249)]()[_0x16ba66(0x2b8)]()[_0x16ba66(0x32d)](0x2,'0')+':'+_0x473874['getMinutes']()[_0x16ba66(0x2b8)]()[_0x16ba66(0x32d)](0x2,'0')+':'+_0x473874[_0x16ba66(0x2e6)]()[_0x16ba66(0x2b8)]()[_0x16ba66(0x32d)](0x2,'0');}function sleep(_0x4ed707){return new Promise(_0x4df9b5=>setTimeout(_0x4df9b5,_0x4ed707));}