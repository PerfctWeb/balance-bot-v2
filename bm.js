const _0x4e02f9=_0xa7b0;(function(_0x4f1c23,_0x431fa2){const _0x5aebe1=_0xa7b0,_0x212465=_0x4f1c23();while(!![]){try{const _0x1d6082=parseInt(_0x5aebe1(0x185))/0x1*(parseInt(_0x5aebe1(0x17a))/0x2)+parseInt(_0x5aebe1(0x115))/0x3*(parseInt(_0x5aebe1(0x1b5))/0x4)+-parseInt(_0x5aebe1(0x1cd))/0x5*(parseInt(_0x5aebe1(0xce))/0x6)+parseInt(_0x5aebe1(0x1d6))/0x7*(-parseInt(_0x5aebe1(0xdd))/0x8)+-parseInt(_0x5aebe1(0x11c))/0x9*(parseInt(_0x5aebe1(0x181))/0xa)+-parseInt(_0x5aebe1(0x182))/0xb+parseInt(_0x5aebe1(0x1e5))/0xc;if(_0x1d6082===_0x431fa2)break;else _0x212465['push'](_0x212465['shift']());}catch(_0x2863f0){_0x212465['push'](_0x212465['shift']());}}}(_0x1ccf,0xb1811));const _0x5b4f49=function(){let _0x3f9550=!![];return function(_0x2f737e,_0x7fbb9e){const _0x1e7978=_0x3f9550?function(){const _0x47ff8f=_0xa7b0;if(_0x7fbb9e){const _0x218cd3=_0x7fbb9e[_0x47ff8f(0x102)](_0x2f737e,arguments);return _0x7fbb9e=null,_0x218cd3;}}:function(){};return _0x3f9550=![],_0x1e7978;};}(),_0x3e2f5f=_0x5b4f49(this,function(){const _0x486599=_0xa7b0;return _0x3e2f5f[_0x486599(0x130)]()[_0x486599(0xe8)]('(((.+)+)+)+$')['toString']()[_0x486599(0x147)](_0x3e2f5f)[_0x486599(0xe8)]('(((.+)+)+)+$');});_0x3e2f5f();'use strict';process[_0x4e02f9(0xd4)][_0x4e02f9(0xe2)]=0x1;const childProcess=require(_0x4e02f9(0x10e)),FileSync=require(_0x4e02f9(0x152)),fs=require('fs'),fns=require(_0x4e02f9(0x113)),low=require(_0x4e02f9(0x1e2)),path=require(_0x4e02f9(0x1a0)),crypto=require(_0x4e02f9(0x122)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require('hybrid-crypto-js')[_0x4e02f9(0x1c5)],bcrypt=require(_0x4e02f9(0x186)),jwt=require(_0x4e02f9(0xe1)),analyticsLib=require(_0x4e02f9(0x104))[_0x4e02f9(0x1a3)],googleAnalytics=require(_0x4e02f9(0x1ce))[_0x4e02f9(0x1a3)],ipaddr=require(_0x4e02f9(0x19f)),argv=require(_0x4e02f9(0x14f))(process[_0x4e02f9(0xf4)][_0x4e02f9(0x1b7)](0x2))[_0x4e02f9(0xf4)],PORT=argv[_0x4e02f9(0x13b)]||'3000',pattern=/^[0-9]{2,4}$/;function _0x1ccf(){const _0x2547fb=['Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','All\x20bots','sendFile','hashSync','constructor','5\x20min','decrypt','login\x20token\x20generated','/:bot/history','invalid\x20credentials','login\x20token\x20valid','static','yargs/yargs','placeOrder','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','lowdb/adapters/FileSync','clientip','emit','<b>Balance\x20Bot\x20status:</b>\x0a','sign','handshake','filter','sha256','starting\x20bot\x20|\x20Bot\x20','polling_error','version.json','join','update-bot','blacklist','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','index.html','live','Unauthorized\x20attempt\x20to\x20update\x20bot','kill','get','initclient','access','padStart','error','message','telegramEvents','randomBytes','remove','push','secret','Notifications\x20enabled','auth','temporary\x20access\x20rejected','find','2FA\x20login\x20required','Ok,\x20will\x20send\x20alert\x20notifications\x20only','settings.','Allow\x20login\x20from\x20IP\x20address\x20<b>','settings','127.0.0.1','2oulGut','uuid','store-settings','type','bot','bots','Invalid\x20IP\x20address','2998060bkHwbt','9165563DgZPxp','parse','sortBy','1131304mHlhsx','bcryptjs','referer','Unauthorized\x20attempt\x20to\x20add\x20bot','telegramToken','store-configuration','password',',\x20must\x20be\x20a\x204\x20digit\x20number','getSeconds','bot-','sendMessage','/:bot/portfolio','starting\x20new\x20bot\x20|\x20Bot\x20','/status\x20-\x20show\x20bot(s)\x20status\x0a','expiry','f2aRequired','Login\x20rejected','\x20>\x20','bb-settings.json','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','telegramUsername','logged\x20out','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','kind','get-portfolio','running','ipaddr.js','path','timeshift','reason','default','Balance\x20Bot','bb-config.json','reject','Notifications\x20disabled','unlinkSync','from','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','once','SIGINT','success','/:bot/coins','login','build','/:bot/performance','temporaryAccessAllowed','answerCallbackQuery','158404jdpLKH','conn','slice','bb-secure.json','logout','getDate','getHours','Balance\x20Bot\x20Server','connected','Unauthorized\x20attempt\x20to\x20log\x20out','server','store','botname','show','split','sockets','RSA','token','stop','telegramEnabled','\x20|\x20','mkdirSync','No\x20bots\x20running\x20right\x20now','order','340XiwEfa','@analytics/google-analytics','isDirectory','Unauthorized\x20login\x20attempt\x20(public\x20key)','fork','user','telegram','login\x20required','allow','21GQRQUZ','Notifications\x20enabled\x0a','version','UA-192771731-1','headers',':\x20Bot\x20Mgr\x20>\x20','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','set','then','page','new','getMinutes','lowdb','data','You\x20can\x20use\x20the\x20following\x20commands:\x0a','6621216WOasLM','stopPolling','backup/','disabled','chat','onText','Unauthorized\x20login\x20attempt\x20(timeout)','secure','All','2FA\x20login\x20token\x20generated','2FA\x20required','all','includes','</b>\x20?','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','username','\x20/\x20','\x20only\x0a','Password\x20has\x20been\x20reset\x20to:\x20','pidRefreshToken','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','whitelist','express','/:bot/configuration','reset-password','exit','temporary\x20access\x20not\x20allowed','Password\x20reset\x20rejected','name','new-disabled','listen','removeAllListeners','status','1000','Access\x20enabled\x20for\x20','use','callback_query','852lteATi','botID','cancelLoading','defaults','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','bbPassword','env','isValid','telegramChatId','test','::1','toIPv4Address','storeConfiguration','host','Unauthorized\x20attempt\x20to\x20get\x20portfolio','1297432HHgdLN','Orders','Notifications\x20disabled\x0a','args','jsonwebtoken','NTBA_FIX_319','getTime','config/','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bb/','RSA-OAEP','search','\x20minutes','showname','toIPv4MappedAddress','getMonth','User\x20has\x20been\x20validated','remoteAddress','loginRequired','send','encryptedUuid','getUTCHours','delete-bot','argv','Unauthorized\x20attempt\x20to\x20get\x20logs','accept','build2','-----------------------------------------------------------------------------------','privateKey','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','login\x20not\x20required','/:bot','bbUsername','copyFileSync','telegram2FaApproval','disconnect','inherit','apply','forEach','analytics','Invalid\x20authentication\x20token\x20(1)','event','add','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','existsSync','timestamp','function','botmanager','/enable\x20-\x20enable\x20notifications\x0a','child_process','alerts','Invalid\x20authentication\x20token\x20(2)','telegramIpApproval','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','date-fns','clients','51uUJlkB','-performance.json','disabled\x20Bot\x20','reload','connection','removeListener','assign','9LQPbRU','catch','value','exp','Bot\x20','enabled','crypto','add-bot','stopped','started','Alerts','hasOwnProperty','whitelistEnabled','bot.js','HTML','::ffff:127.0.0.1','createServer','Invalid\x20Telegram\x20token','temporary\x20token\x20generated','All\x20bots\x20running\x20right\x20now','toString','15\x20min','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','emitHistory','pidExpireLogin','orders','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','publicKey','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','error\x20while\x20deleting\x20config\x20files:\x20','log','port','Unauthorized\x20attempt\x20to\x20update\x20settings','2FA','write','************','length','Unauthorized\x20attempt\x20to\x20place\x20market\x20order'];_0x1ccf=function(){return _0x2547fb;};return _0x1ccf();}if(!pattern[_0x4e02f9(0xd7)](PORT))return console[_0x4e02f9(0x13a)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x4e02f9(0x18c)),process['exit'](0x1);const HOST=argv[_0x4e02f9(0xdb)]||null,userID=argv[_0x4e02f9(0x1d2)]||'';let bbpath=_0x4e02f9(0xe6),bbpath2='';const botfile=_0x4e02f9(0x129),configfile=_0x4e02f9(0x1a5),settingsfile=_0x4e02f9(0x197),securefile=_0x4e02f9(0x1b8);!fs[_0x4e02f9(0x109)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4e02f9(0x114)),configpath=userID?bbpath+_0x4e02f9(0xe4)+userID+'/':bbpath+_0x4e02f9(0xe4),configbackuppath=configpath+_0x4e02f9(0x1e7);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x4e02f9(0x1ca)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4e02f9(0xd1)]({'bots':[]})[_0x4e02f9(0x13e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4e02f9(0xd1)]({'secure':{},'blacklist':[]})[_0x4e02f9(0x13e)]();let crypt=new Crypt({'md':_0x4e02f9(0x159),'rsaStandard':_0x4e02f9(0xe7)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4e02f9(0x15c))[_0x4e02f9(0x1d8)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x4e02f9(0x1fb)),app=express(),http=require('http')[_0x4e02f9(0x12c)](app);app[_0x4e02f9(0xcc)](express[_0x4e02f9(0x14e)](path['join'](__dirname,bbpath2,_0x4e02f9(0xf7)))),app[_0x4e02f9(0xcc)](express['static'](path[_0x4e02f9(0x15d)](__dirname,bbpath2,_0x4e02f9(0x1b1)))),app['get']('/',function(_0x3bdb2c,_0x5ae018){const _0x154ae6=_0x4e02f9;_0x5ae018['sendFile'](path[_0x154ae6(0x15d)](__dirname,bbpath2,'build2',_0x154ae6(0x161)));}),app[_0x4e02f9(0x165)](_0x4e02f9(0xfc),function(_0x24c64e,_0x51dbb9){const _0xba2dbe=_0x4e02f9;_0x51dbb9[_0xba2dbe(0x145)](path[_0xba2dbe(0x15d)](__dirname,bbpath2,_0xba2dbe(0x1b1),_0xba2dbe(0x161)));}),app[_0x4e02f9(0x165)](_0x4e02f9(0x190),(_0x8e475b,_0x33368a)=>{const _0x102946=_0x4e02f9;_0x33368a['sendFile'](path['join'](__dirname,bbpath2,'build',_0x102946(0x161)));}),app[_0x4e02f9(0x165)](_0x4e02f9(0x1b2),(_0x49401c,_0x5c9ce2)=>{const _0x4ee130=_0x4e02f9;_0x5c9ce2[_0x4ee130(0x145)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x4e02f9(0x165)](_0x4e02f9(0x1af),(_0x26e4a6,_0x1a9578)=>{const _0x4351ac=_0x4e02f9;_0x1a9578[_0x4351ac(0x145)](path['join'](__dirname,bbpath2,_0x4351ac(0x1b1),_0x4351ac(0x161)));}),app[_0x4e02f9(0x165)](_0x4e02f9(0x14b),(_0x26f1dd,_0x3a757d)=>{const _0x3a86d6=_0x4e02f9;_0x3a757d[_0x3a86d6(0x145)](path['join'](__dirname,bbpath2,'build',_0x3a86d6(0x161)));}),app[_0x4e02f9(0x165)](_0x4e02f9(0xc0),(_0x446904,_0x13d77a)=>{const _0x3035b3=_0x4e02f9;_0x13d77a[_0x3035b3(0x145)](path['join'](__dirname,bbpath2,_0x3035b3(0x1b1),_0x3035b3(0x161)));}),app[_0x4e02f9(0x165)]('/:bot/support',(_0x5cb096,_0x7c8384)=>{const _0x2fb771=_0x4e02f9;_0x7c8384[_0x2fb771(0x145)](path[_0x2fb771(0x15d)](__dirname,bbpath2,_0x2fb771(0x1b1),_0x2fb771(0x161)));});if(HOST)http[_0x4e02f9(0xc7)](PORT,HOST);else http[_0x4e02f9(0xc7)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x4e02f9(0x1a4),'plugins':[googleAnalytics({'trackingId':_0x4e02f9(0x1d9)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x4e02f9(0x189)]&&settings[_0x4e02f9(0x189)]!=''&&settings[_0x4e02f9(0x199)]&&settings[_0x4e02f9(0x199)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x30e0f5=_0x4e02f9;console['log'](''),console[_0x30e0f5(0x13a)](_0x30e0f5(0xf8)),logging(_0x30e0f5(0x198)+PORT),console[_0x30e0f5(0x13a)](_0x30e0f5(0xf8));if(config[_0x30e0f5(0x140)]!=0x0)config[_0x30e0f5(0x103)](_0x1fa828=>{const _0x3df671=_0x30e0f5;if(_0x1fa828[_0x3df671(0xc9)]==_0x3df671(0x121)||_0x1fa828[_0x3df671(0xc9)]==_0x3df671(0x1e0))logging(_0x3df671(0x15a)+_0x1fa828[_0x3df671(0xcf)]+_0x3df671(0x1c9)+_0x1fa828['botname']),startBot([_0x1fa828[_0x3df671(0xcf)],userID],{'cwd':bbpath},function(_0x2c7210){if(_0x2c7210)logging(_0x2c7210);});else(_0x1fa828[_0x3df671(0xc9)]==_0x3df671(0x1e8)||_0x1fa828[_0x3df671(0xc9)]==_0x3df671(0xc6))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x1fa828[_0x3df671(0xcf)]+_0x3df671(0x1c9)+_0x1fa828[_0x3df671(0x1c1)]);});else!newBot&&console['log'](_0x30e0f5(0xe5));if(newBot)addBot();console[_0x30e0f5(0x13a)](_0x30e0f5(0xf8)),console[_0x30e0f5(0x13a)]('');}function startSocket(){const _0x21a6ea=_0x4e02f9;io['on'](_0x21a6ea(0x119),_0x4d6af1=>{const _0x5e969b=_0x21a6ea;let _0x2a169a,_0x1d0df0,_0x2abb83,_0x2506d6,_0x4bd214;const _0x5932cd=_0x4d6af1[_0x5e969b(0x157)][_0x5e969b(0x1da)][_0x5e969b(0x187)];_0x1d0df0=_0x5932cd['match'](/bot[0-9]{3}/);if(_0x1d0df0)_0x2abb83=_0x1d0df0[0x0]['match'](/[0-9]{3}/);if(_0x2abb83)_0x2a169a=_0x2abb83[0x0];else _0x2a169a=_0x5e969b(0x10c);const _0x44d10b=_0x4d6af1[_0x5e969b(0x157)][_0x5e969b(0x171)][_0x5e969b(0xf1)];if(!_0x44d10b)_0x4d6af1['emit'](_0x5e969b(0xc9),{'publicKey':secure[_0x5e969b(0x137)]});else{_0x2506d6=timelyDecrypt(_0x44d10b,![]);if(!_0x2506d6)logging(_0x5e969b(0x1d0));else{_0x4bd214=normalizeIP(_0x4d6af1[_0x5e969b(0x1b6)][_0x5e969b(0xee)])[_0x5e969b(0x1c0)];if(!devices[_0x2506d6])devices[_0x2506d6]={'uuid':_0x2506d6,'access':{'token':null}};devices[_0x2506d6]['ip']=_0x4bd214;const _0x3801d4=addClient(_0x4d6af1['id'],_0x2506d6,_0x2a169a);setAccess(_0x3801d4),_0x4d6af1['on'](_0x5e969b(0x1b0),_0x1ad53a=>{const _0x34e22d=_0x5e969b,_0x13e239=timelyDecrypt(_0x1ad53a[_0x34e22d(0x18b)]);if(_0x13e239){_0x1ad53a={'username':_0x1ad53a[_0x34e22d(0x1f4)],'password':_0x13e239},devices[_0x2506d6][_0x34e22d(0x167)]=validateCredentials(_0x1ad53a,_0x2506d6);if(devices[_0x2506d6][_0x34e22d(0x167)][_0x34e22d(0x1d5)]==![]&&devices[_0x2506d6][_0x34e22d(0x167)][_0x34e22d(0x1a2)]=='2FA\x20login\x20required')_0x4d6af1[_0x34e22d(0x154)](_0x34e22d(0xc9),{'access':devices[_0x2506d6][_0x34e22d(0x167)]}),loginAccess2FA(_0x2506d6,_0x4bd214);else{if(devices[_0x2506d6]['access'][_0x34e22d(0x1d5)]==![]&&devices[_0x2506d6][_0x34e22d(0x167)][_0x34e22d(0x1a2)]==_0x34e22d(0x14c))_0x4d6af1['emit']('status',{'access':devices[_0x2506d6]['access']});else devices[_0x2506d6][_0x34e22d(0x167)]['allow']&&devices[_0x2506d6][_0x34e22d(0x167)][_0x34e22d(0x1a2)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x2506d6)[_0x34e22d(0x103)](_0x4f5851=>{setAccess(_0x4f5851);}),setTokenRefresh(_0x2506d6),setSessionTimeout(_0x34e22d(0x1b0),_0x2506d6));}}else logging(_0x34e22d(0x1eb));}),_0x4d6af1['on'](_0x5e969b(0xc1),()=>{resetPassword();}),_0x4d6af1['on']('disconnect',_0x7e2644=>{removeClient(_0x4d6af1['id']);});}}});}function initClient(_0x95f94d){const _0x4e0ae1=_0x4e02f9;if(_0x95f94d!=_0x4e0ae1(0x10c)&&config['apiKey']!=''){if(pid[_0x95f94d])pid[_0x95f94d]['send']({'function':_0x4e0ae1(0x166),'args':null});}}function _0xa7b0(_0x43cb2c,_0x378cb1){const _0x30bf50=_0x1ccf();return _0xa7b0=function(_0x3e2f5f,_0x5b4f49){_0x3e2f5f=_0x3e2f5f-0xc0;let _0x1ccf48=_0x30bf50[_0x3e2f5f];return _0x1ccf48;},_0xa7b0(_0x43cb2c,_0x378cb1);}function getSocket(_0x4e367e){const _0x168745=_0x4e02f9;return io['sockets'][_0x168745(0x1c4)][_0x168745(0x165)](_0x4e367e);}function setAccess(_0x3ba2aa){const _0x25c665=_0x4e02f9,_0x2a46c5=getSocket(_0x3ba2aa['id']),_0x5eccdb=_0x3ba2aa[_0x25c665(0x17b)],_0x448919=_0x3ba2aa['bot'];devices[_0x5eccdb][_0x25c665(0x167)]=validateAccess(devices[_0x5eccdb][_0x25c665(0x167)][_0x25c665(0x1c6)],_0x5eccdb),_0x2a46c5[_0x25c665(0x15d)](_0x5eccdb);if(devices[_0x5eccdb]['access']['allow']){_0x2a46c5[_0x25c665(0x15d)](_0x448919);if(_0x448919==_0x25c665(0x10c))initializeSocketBotManager(_0x2a46c5);else initializeSocketBot(_0x2a46c5);initClient(_0x448919);}devices[_0x5eccdb][_0x25c665(0x167)][_0x25c665(0x1c6)]&&devices[_0x5eccdb][_0x25c665(0x167)][_0x25c665(0x1a2)]==_0x25c665(0x12e)&&setSessionTimeout(_0x25c665(0x13d),_0x5eccdb),devices[_0x5eccdb]['access'][_0x25c665(0x1c6)]&&devices[_0x5eccdb]['access'][_0x25c665(0x1a2)]==_0x25c665(0x1ee)&&setSessionTimeout(_0x25c665(0x1b0),_0x5eccdb),_0x2a46c5['emit'](_0x25c665(0xc9),{'status':_0x3ba2aa[_0x25c665(0x1bf)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5eccdb][_0x25c665(0x167)],'externalip':devices[_0x5eccdb]['ip'],'publicKey':secure[_0x25c665(0x137)]}),devices[_0x5eccdb][_0x25c665(0x167)][_0x25c665(0x1d5)]==![]&&devices[_0x5eccdb]['access'][_0x25c665(0x1a2)]=='2FA\x20required'&&temporaryAccess2FA(_0x5eccdb,devices[_0x5eccdb]['ip']);}function setSessionTimeout(_0x3ebe89,_0x5a80a0){const _0x53bb84=_0x4e02f9;let _0x7f4100;if(_0x3ebe89==_0x53bb84(0x1b0))_0x7f4100=loginExpiry*0x3c*0x3e8;else _0x7f4100=devices[_0x5a80a0][_0x53bb84(0x111)][_0x53bb84(0x193)]*0x3c*0x3e8-(new Date()[_0x53bb84(0xe3)]()-devices[_0x5a80a0]['telegramIpApproval'][_0x53bb84(0x10a)]);if(devices[_0x5a80a0][_0x53bb84(0x134)])clearTimeout(devices[_0x5a80a0]['pidExpireLogin']);devices[_0x5a80a0]['pidExpireLogin']=setTimeout(()=>{const _0xf99a04=_0x53bb84;if(devices[_0x5a80a0]['pidRefreshToken'])clearTimeout(devices[_0x5a80a0][_0xf99a04(0x1f8)]);removeSocketListeners(_0x5a80a0),addBlacklist(_0x5a80a0),devices[_0x5a80a0][_0xf99a04(0x111)]=null,devices[_0x5a80a0]['telegram2FaApproval']=null,devices[_0x5a80a0][_0xf99a04(0x167)][_0xf99a04(0x1c6)]=null,devices[_0x5a80a0][_0xf99a04(0x167)]=validateAccess(devices[_0x5a80a0][_0xf99a04(0x167)]['token'],_0x5a80a0),!(devices[_0x5a80a0][_0xf99a04(0x167)][_0xf99a04(0x1d5)]&&devices[_0x5a80a0][_0xf99a04(0x167)][_0xf99a04(0x1a2)]=='login\x20not\x20required')&&(_0x3ebe89==_0xf99a04(0x1b0)?io['to'](_0x5a80a0)[_0xf99a04(0x154)](_0xf99a04(0xc9),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x5a80a0)[_0xf99a04(0x154)](_0xf99a04(0xc9),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x5a80a0][_0xf99a04(0x167)][_0xf99a04(0x1c6)]=null;},_0x7f4100);}function setTokenRefresh(_0x2dfab3){const _0x59abe6=_0x4e02f9;if(devices[_0x2dfab3]['pidRefreshToken'])clearTimeout(devices[_0x2dfab3][_0x59abe6(0x1f8)]);devices[_0x2dfab3]['pidRefreshToken']=setTimeout(()=>{const _0x3791b0=_0x59abe6;getClientsWithUuid(_0x2dfab3)[_0x3791b0(0x140)]!=0x0?(devices[_0x2dfab3][_0x3791b0(0x167)]=refreshToken(_0x2dfab3),io['to'](_0x2dfab3)[_0x3791b0(0x154)](_0x3791b0(0xc9),{'status':_0x3791b0(0x1bd),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2dfab3]['access'],'externalip':devices[_0x2dfab3]['ip'],'publicKey':secure[_0x3791b0(0x137)]}),setTokenRefresh(_0x2dfab3)):clearTimeout(devices[_0x2dfab3][_0x3791b0(0x1f8)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1bc3e6){const _0x296739=_0x4e02f9,_0x2747ff=getClient(_0x1bc3e6['id'])[_0x296739(0x17b)];_0x1bc3e6[_0x296739(0x154)]('bots',config),_0x1bc3e6[_0x296739(0x154)](_0x296739(0x178),cleanSettings()),_0x1bc3e6['on'](_0x296739(0x123),_0x1a2dd4=>{const _0xb7cd53=_0x296739;if(validateAccess(_0x1a2dd4,_0x2747ff)[_0xb7cd53(0x1d5)])addBot();else logging(_0xb7cd53(0x188));}),_0x1bc3e6['on'](_0x296739(0x15e),(_0xddeba1,_0x459663)=>{const _0xccf49e=_0x296739;if(validateAccess(_0x459663,_0x2747ff)[_0xccf49e(0x1d5)])toggleBot(_0xddeba1[_0xccf49e(0xcf)],_0xddeba1[_0xccf49e(0xc9)],_0xddeba1[_0xccf49e(0x162)]);else logging(_0xccf49e(0x163));}),_0x1bc3e6['on'](_0x296739(0xf3),(_0x52ba4e,_0x4efff4)=>{const _0x108cbe=_0x296739;if(validateAccess(_0x4efff4,_0x2747ff)[_0x108cbe(0x1d5)])deleteBot(_0x52ba4e);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1bc3e6['on'](_0x296739(0x17c),(_0x3fffc2,_0x2193d2)=>{const _0xa94769=_0x296739;if(validateAccess(_0x2193d2,_0x2747ff)[_0xa94769(0x1d5)])storeSettings(_0x3fffc2,!![]);else logging(_0xa94769(0x13c));}),_0x1bc3e6['on']('update-bb',(_0x3be331,_0x5b8223)=>{const _0xb71ae9=_0x296739;if(validateAccess(_0x5b8223,_0x2747ff)[_0xb71ae9(0x1d5)])updateBB();else logging(_0xb71ae9(0x13c));}),_0x1bc3e6['on'](_0x296739(0x1b9),_0x5b12bf=>{const _0x3776d6=_0x296739;if(validateAccess(_0x5b12bf,_0x2747ff)[_0x3776d6(0x1d5)]){if(devices[_0x2747ff][_0x3776d6(0x1f8)])clearTimeout(devices[_0x2747ff]['pidRefreshToken']);if(devices[_0x2747ff][_0x3776d6(0x134)])clearTimeout(devices[_0x2747ff][_0x3776d6(0x134)]);removeSocketListeners(getClient(_0x1bc3e6['id'])[_0x3776d6(0x17b)]),addBlacklist(_0x2747ff),devices[_0x2747ff][_0x3776d6(0x111)]=null,devices[_0x2747ff]['telegram2FaApproval']=null,devices[_0x2747ff]['access']['token']=null,io['to'](getClient(_0x1bc3e6['id'])['uuid'])['emit'](_0x3776d6(0xc9),{'access':{'allow':![],'reason':_0x3776d6(0x19a),'token':null}});}else logging(_0x3776d6(0x1be));});}function initializeSocketBot(_0x6a0dc7){const _0x56df8b=_0x4e02f9,_0x49da01=getClient(_0x6a0dc7['id'])[_0x56df8b(0x17e)],_0x460919=getClient(_0x6a0dc7['id'])['uuid'];_0x6a0dc7['on']('get-logs',(_0x19993c,_0xdc2b3)=>{const _0x28562a=_0x56df8b;if(validateAccess(_0xdc2b3,_0x460919)['allow']){if(pid[_0x49da01])pid[_0x49da01][_0x28562a(0xf0)]({'function':_0x28562a(0x133),'args':_0x19993c});}else logging(_0x28562a(0xf5));}),_0x6a0dc7['on'](_0x56df8b(0x19d),(_0x3f53f5,_0x41fac3)=>{const _0x4f6cf9=_0x56df8b;if(validateAccess(_0x41fac3,_0x460919)[_0x4f6cf9(0x1d5)]){if(pid[_0x49da01])pid[_0x49da01][_0x4f6cf9(0xf0)]({'function':'getPortfolio','args':_0x3f53f5});}else logging(_0x4f6cf9(0xdc));}),_0x6a0dc7['on'](_0x56df8b(0x18a),(_0x59799d,_0x4ca1c3)=>{const _0x3969c4=_0x56df8b;if(validateAccess(_0x4ca1c3,_0x460919)['allow']){if(pid[_0x49da01])pid[_0x49da01]['send']({'function':_0x3969c4(0xda),'args':_0x59799d});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x6a0dc7['on']('store-headless',(_0x12392d,_0x3c46f2)=>{const _0x2c005b=_0x56df8b;if(validateAccess(_0x3c46f2,_0x460919)[_0x2c005b(0x1d5)]){if(pid[_0x49da01])pid[_0x49da01][_0x2c005b(0xf0)]({'function':'storeHeadless','args':_0x12392d});}else logging(_0x2c005b(0x1ab));}),_0x6a0dc7['on']('get-starting-balances',_0x418a85=>{const _0x253a8a=_0x56df8b;if(validateAccess(_0x418a85,_0x460919)['allow']){if(pid[_0x49da01])pid[_0x49da01][_0x253a8a(0xf0)]({'function':'getStartingBalances','args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x6a0dc7['on']('place-order',(_0xd9ebd4,_0x31cf0e)=>{const _0x3ea754=_0x56df8b;if(validateAccess(_0x31cf0e,_0x460919)['allow']){if(pid[_0x49da01])pid[_0x49da01]['send']({'function':_0x3ea754(0x150),'args':_0xd9ebd4});}else logging(_0x3ea754(0x141));}),_0x6a0dc7['on']('cancel-loading',_0x3c6154=>{const _0x3e5b23=_0x56df8b;if(validateAccess(_0x3c6154,_0x460919)[_0x3e5b23(0x1d5)]){if(pid[_0x49da01])pid[_0x49da01][_0x3e5b23(0xf0)]({'function':_0x3e5b23(0xd0),'args':null});}else logging(_0x3e5b23(0x136));}),_0x6a0dc7['on'](_0x56df8b(0x1b9),_0x9e489b=>{const _0x4285cd=_0x56df8b;if(validateAccess(_0x9e489b,_0x460919)[_0x4285cd(0x1d5)]){if(devices[_0x460919][_0x4285cd(0x1f8)])clearTimeout(devices[_0x460919][_0x4285cd(0x1f8)]);if(devices[_0x460919]['pidExpireLogin'])clearTimeout(devices[_0x460919]['pidExpireLogin']);removeSocketListeners(getClient(_0x6a0dc7['id'])['uuid']),addBlacklist(_0x460919),devices[_0x460919]['telegramIpApproval']=null,devices[_0x460919]['telegram2FaApproval']=null,devices[_0x460919][_0x4285cd(0x167)]['token']=null,io['to'](getClient(_0x6a0dc7['id'])[_0x4285cd(0x17b)])[_0x4285cd(0x154)](_0x4285cd(0xc9),{'access':{'allow':![],'reason':_0x4285cd(0x19a),'token':null}});}else logging(_0x4285cd(0x1be));});}function removeSocketListeners(_0x15d974){const _0x1f99e4=_0x4e02f9;getClientsWithUuid(_0x15d974)[_0x1f99e4(0x103)](_0xdf6cdd=>{const _0x1ca74e=_0x1f99e4;getSocket(_0xdf6cdd['id'])[_0x1ca74e(0xc8)]();});}function cleanSettings(){const _0x1aaafe=_0x4e02f9;let _0x20b088=settings;return settings[_0x1aaafe(0x189)]&&settings['telegramToken']!=''&&(_0x20b088={..._0x20b088,'telegramToken':'************'}),settings[_0x1aaafe(0xd3)]&&settings[_0x1aaafe(0xd3)]!=''&&(_0x20b088={..._0x20b088,'bbPassword':_0x1aaafe(0x13f)}),_0x20b088;}function updateBB(){const _0x13aae5=_0x4e02f9;process[_0x13aae5(0xf0)]({'update':!![]},_0x24df3a=>{});}function startBot(_0x1de7ba,_0x4787d7,_0x201944){const _0x2ab93f=_0x4e02f9;let _0x43e3e9=![];const _0x534eac=_0x1de7ba[0x0];_0x4787d7={..._0x4787d7,'stdio':['inherit',_0x2ab93f(0x101),_0x2ab93f(0x101),'ipc']},pid[_0x534eac]=childProcess[_0x2ab93f(0x1d1)](botfile,_0x1de7ba,_0x4787d7),pid[_0x534eac]['on'](_0x2ab93f(0x16a),_0x2480ba=>{const _0x3a701f=_0x2ab93f;switch(Object['keys'](_0x2480ba)[0x0]){case _0x3a701f(0x1c1):updateBotName(_0x534eac,_0x2480ba[_0x3a701f(0x1c1)]);break;case _0x3a701f(0xc9):updateStatus(_0x534eac,_0x2480ba['status']);break;case _0x3a701f(0x162):updateLive(_0x534eac,_0x2480ba['live']);break;case _0x3a701f(0x125):updateLive(_0x534eac,_0x2480ba[_0x3a701f(0x125)]),io['to'](_0x534eac)[_0x3a701f(0x154)](_0x3a701f(0xc9),{'access':{'allow':![],'reason':_0x3a701f(0x118),'token':null}});break;case'stop':_0x2480ba[_0x3a701f(0x1c7)]=='restart'&&stopBot(_0x534eac);_0x2480ba[_0x3a701f(0x1c7)]==_0x3a701f(0x164)&&toggleBot(_0x534eac,_0x3a701f(0x1e8),'stopped');break;case _0x3a701f(0x1d3):sendTelegram(_0x534eac,_0x2480ba['telegram']);break;case'function':io['to'](_0x534eac)[_0x3a701f(0x154)](_0x2480ba[_0x3a701f(0x10b)],_0x2480ba[_0x3a701f(0xe0)]);break;}}),pid[_0x534eac]['on'](_0x2ab93f(0x169),function(_0xbfc5fc){if(_0x43e3e9)return;_0x43e3e9=!![],_0x201944(_0xbfc5fc);}),pid[_0x534eac]['on'](_0x2ab93f(0xc2),function(_0x374f1b){const _0x2821ea=_0x2ab93f;if(_0x43e3e9)return;_0x43e3e9=!![],_0x201944(null);const _0x1272e8=dbConfig[_0x2821ea(0x165)](_0x2821ea(0x17f))[_0x2821ea(0x173)]({'botID':_0x534eac})[_0x2821ea(0x11e)]();_0x1272e8&&(_0x1272e8[_0x2821ea(0xc9)]==_0x2821ea(0x121)||_0x1272e8[_0x2821ea(0xc9)]==_0x2821ea(0x1e0))&&(updateLive(_0x534eac,_0x2821ea(0x124)),logging('restarting\x20Bot\x20'+_0x534eac),startBot([_0x534eac,userID],{'cwd':bbpath},function(_0x1bc1b0){if(_0x1bc1b0)logging(_0x1bc1b0);}));});}function stopBot(_0x4214b2){const _0x116f8f=_0x4e02f9;getClientsWithBotID(_0x4214b2)[_0x116f8f(0x103)](_0x11422c=>{const _0x3f5997=_0x116f8f;getSocket(_0x11422c['id'])[_0x3f5997(0x100)](!![]),removeClient(_0x11422c['id']);});if(pid[_0x4214b2])pid[_0x4214b2]['kill']();}function addBot(){const _0xe61280=_0x4e02f9;let _0x184709;for(let _0x38745c=0x1;_0x38745c<0x3e9;_0x38745c++){_0x184709=_0x38745c['toString']()['padStart'](0x3,'0');let _0x59eb63=config[_0xe61280(0x173)](_0x21d92d=>_0x21d92d['botID']==_0x184709);if(!_0x59eb63)break;}if(_0x184709===_0xe61280(0xca)){logging(_0xe61280(0x1f3));return;}logging(_0xe61280(0x191)+_0x184709),dbConfig['get'](_0xe61280(0x17f))[_0xe61280(0x16e)]({'botID':_0x184709,'botname':_0xe61280(0x120)+_0x184709,'status':'new','live':''})[_0xe61280(0x13e)](),startBot([_0x184709,userID],{'cwd':bbpath},function(_0x615a5f){if(_0x615a5f)logging(_0x615a5f);}),config=getConfiguration(),io['to'](_0xe61280(0x10c))[_0xe61280(0x154)](_0xe61280(0x17f),config);}function deleteBot(_0x5f486e){const _0xd3c9a6=_0x4e02f9;getClientsWithBotID(_0x5f486e)['forEach'](_0x2467b5=>{const _0x5ea4fb=_0xa7b0;getSocket(_0x2467b5['id'])[_0x5ea4fb(0x100)](!![]),removeClient(_0x2467b5['id']);}),dbConfig[_0xd3c9a6(0x165)](_0xd3c9a6(0x17f))[_0xd3c9a6(0x16d)]({'botID':_0x5f486e})[_0xd3c9a6(0x13e)](),logging('deleted\x20Bot\x20'+_0x5f486e),stopBot(_0x5f486e);try{fs[_0xd3c9a6(0x1a8)](path['join'](configpath,_0xd3c9a6(0x18e)+_0x5f486e+'-config.json')),fs[_0xd3c9a6(0x1a8)](path['join'](configpath,_0xd3c9a6(0x18e)+_0x5f486e+'-events.json')),fs[_0xd3c9a6(0x1a8)](path[_0xd3c9a6(0x15d)](configpath,'bot-'+_0x5f486e+_0xd3c9a6(0x116))),fs['unlinkSync'](path[_0xd3c9a6(0x15d)](configpath,_0xd3c9a6(0x18e)+_0x5f486e+'-results.json'));}catch(_0x24c727){if(_0x24c727)logging(_0xd3c9a6(0x139),_0x24c727);}config=getConfiguration(),io['to']('botmanager')[_0xd3c9a6(0x154)]('bots',config);}function toggleBot(_0x2dac5a,_0x3ca884,_0xb8b5a6){const _0x13852c=_0x4e02f9;dbConfig[_0x13852c(0x165)](_0x13852c(0x17f))[_0x13852c(0x173)]({'botID':_0x2dac5a})[_0x13852c(0x11b)]({'status':_0x3ca884})[_0x13852c(0x11b)]({'live':_0xb8b5a6})[_0x13852c(0x13e)]();if(_0x3ca884==_0x13852c(0x121)||_0x3ca884==_0x13852c(0x1e0))logging('enabled\x20Bot\x20'+_0x2dac5a),startBot([_0x2dac5a,userID],{'cwd':bbpath},function(_0x4c6041){if(_0x4c6041)logging(_0x4c6041);});else(_0x3ca884==_0x13852c(0x1e8)||_0x3ca884==_0x13852c(0xc6))&&(logging(_0x13852c(0x117)+_0x2dac5a),stopBot(_0x2dac5a));config=getConfiguration(),io['to']('botmanager')[_0x13852c(0x154)]('bots',config);}function toggleStatus(_0xc0f3b5){const _0x17aff1=_0x4e02f9;let _0x519a31=dbConfig[_0x17aff1(0x165)](_0x17aff1(0x17f))['find']({'botID':_0xc0f3b5})[_0x17aff1(0x11e)](),_0x6dbb1e;if(_0x519a31['status']==='enabled')_0x6dbb1e='disabled';else{if(_0x519a31[_0x17aff1(0xc9)]==='new')_0x6dbb1e=_0x17aff1(0xc6);else{if(_0x519a31[_0x17aff1(0xc9)]===_0x17aff1(0xc6))_0x6dbb1e=_0x17aff1(0x1e0);else{if(_0x519a31[_0x17aff1(0xc9)]===_0x17aff1(0x1e8))_0x6dbb1e=_0x17aff1(0x121);}}}return _0x6dbb1e;}function updateStatus(_0x2b1599,_0x35a217){const _0xbf4b9a=_0x4e02f9;dbConfig[_0xbf4b9a(0x165)](_0xbf4b9a(0x17f))[_0xbf4b9a(0x173)]({'botID':_0x2b1599})[_0xbf4b9a(0x11b)]({'status':_0x35a217})[_0xbf4b9a(0x13e)](),config=getConfiguration(),io['to'](_0xbf4b9a(0x10c))[_0xbf4b9a(0x154)](_0xbf4b9a(0x17f),config);}function updateLive(_0x127e6b,_0x159e49){const _0x3b1079=_0x4e02f9;dbConfig[_0x3b1079(0x165)]('bots')[_0x3b1079(0x173)]({'botID':_0x127e6b})[_0x3b1079(0x11b)]({'live':_0x159e49})['write'](),config=getConfiguration(),io['to'](_0x3b1079(0x10c))[_0x3b1079(0x154)](_0x3b1079(0x17f),config);}function updateBotName(_0x1752dd,_0x4a39dd){const _0x4ca6cf=_0x4e02f9;dbConfig[_0x4ca6cf(0x165)](_0x4ca6cf(0x17f))[_0x4ca6cf(0x173)]({'botID':_0x1752dd})[_0x4ca6cf(0x11b)]({'botname':_0x4a39dd})[_0x4ca6cf(0x13e)](),config=getConfiguration(),io['to'](_0x4ca6cf(0x10c))[_0x4ca6cf(0x154)](_0x4ca6cf(0x17f),config);}function telegramError(_0x1df610){const _0x4cec5c=_0x4e02f9;console[_0x4cec5c(0x13a)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x4f7db9){const _0x1ab74e=_0x4e02f9;if(_0x4f7db9[_0x1ab74e(0x1a9)]['username']!=settings[_0x1ab74e(0x199)]&&'@'+_0x4f7db9[_0x1ab74e(0x1a9)]['username']!=settings[_0x1ab74e(0x199)])return tgBot[_0x1ab74e(0x18f)](_0x4f7db9[_0x1ab74e(0x1e9)]['id'],_0x1ab74e(0xd2),{'parse_mode':_0x1ab74e(0x12a)})[_0x1ab74e(0x11d)](_0x20afb9=>{telegramError(_0x20afb9);}),![];return!![];}async function initTelegram(){const _0x212e88=_0x4e02f9;if(tgBot)tgBot[_0x212e88(0x1e6)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x212e88(0x189)],{'polling':!![]});let _0x33ef2a=_0x212e88(0x1e4);_0x33ef2a+='\x0a',_0x33ef2a+=_0x212e88(0x10d),_0x33ef2a+='/disable\x20-\x20disable\x20notifications\x0a',_0x33ef2a+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x33ef2a+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x33ef2a+='/on\x20-\x20start\x20bot(s)\x0a',_0x33ef2a+='/off\x20-\x20stop\x20bot(s)\x0a',_0x33ef2a+=_0x212e88(0x192),_0x33ef2a+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x1bf157=_0x212e88(0x132);_0x1bf157+='\x0a',_0x1bf157+=_0x33ef2a,tgBot['onText'](/\/start/,_0x1a9be9=>{const _0xe4a183=_0x212e88;if(!validateTelegram(_0x1a9be9))return;if(settings['telegramChatId']!=_0x1a9be9[_0xe4a183(0x1e9)]['id'])updateSetting(_0xe4a183(0xd6),_0x1a9be9[_0xe4a183(0x1e9)]['id']);updateSetting(_0xe4a183(0x1c8),!![]),tgBot[_0xe4a183(0x18f)](_0x1a9be9[_0xe4a183(0x1e9)]['id'],_0x1bf157)[_0xe4a183(0x11d)](_0x5778c5=>{telegramError(_0x5778c5);});}),tgBot[_0x212e88(0x1ea)](/\/enable/,_0x84c48a=>{const _0x3fb926=_0x212e88;if(!validateTelegram(_0x84c48a))return;if(settings[_0x3fb926(0xd6)]!=_0x84c48a[_0x3fb926(0x1e9)]['id'])updateSetting(_0x3fb926(0xd6),_0x84c48a[_0x3fb926(0x1e9)]['id']);updateSetting(_0x3fb926(0x1c8),!![]),tgBot[_0x3fb926(0x18f)](_0x84c48a[_0x3fb926(0x1e9)]['id'],_0x3fb926(0x170))[_0x3fb926(0x11d)](_0x4dbf5e=>{telegramError(_0x4dbf5e);});}),tgBot['onText'](/\/config/,async _0x5393cb=>{const _0x25e03b=_0x212e88;if(!validateTelegram(_0x5393cb))return;tgBot['removeListener'](_0x25e03b(0xcd)),tgBot['sendMessage'](_0x5393cb[_0x25e03b(0x1e9)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x25e03b(0xde),'callback_data':'orders'},{'text':_0x25e03b(0x126),'callback_data':_0x25e03b(0x10f)},{'text':_0x25e03b(0x1ed),'callback_data':'all'}]]}})[_0x25e03b(0x11d)](_0x4d018c=>{telegramError(_0x4d018c);}),tgBot['on']('callback_query',async _0x36e766=>{const _0x181d81=_0x25e03b,_0x2cc14b=_0x36e766['data'],_0x5b176e=_0x36e766[_0x181d81(0x16a)];tgBot[_0x181d81(0x1b4)](_0x36e766['id'])[_0x181d81(0x1de)](async()=>{const _0x9d8b36=_0x181d81;_0x2cc14b=='orders'&&(updateSetting(_0x9d8b36(0x16b),_0x9d8b36(0x135)),updateSetting('telegramEnabled',!![]),await tgBot[_0x9d8b36(0x18f)](_0x5b176e['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x9d8b36(0x11d)](_0x303608=>{telegramError(_0x303608);}));_0x2cc14b=='alerts'&&(updateSetting(_0x9d8b36(0x16b),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x9d8b36(0x18f)](_0x5b176e[_0x9d8b36(0x1e9)]['id'],_0x9d8b36(0x175))['catch'](_0x3d2aff=>{telegramError(_0x3d2aff);}));_0x2cc14b=='all'&&(updateSetting('telegramEvents','all'),updateSetting(_0x9d8b36(0x1c8),!![]),await tgBot[_0x9d8b36(0x18f)](_0x5b176e[_0x9d8b36(0x1e9)]['id'],_0x9d8b36(0x112))[_0x9d8b36(0x11d)](_0x595272=>{telegramError(_0x595272);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x5b176e[_0x9d8b36(0x1e9)]['id'],_0x9d8b36(0x151))[_0x9d8b36(0x11d)](_0x4b8b52=>{telegramError(_0x4b8b52);});}),tgBot[_0x181d81(0x11a)](_0x181d81(0xcd));});}),tgBot[_0x212e88(0x1ea)](/\/status/,_0x299613=>{const _0x140d93=_0x212e88;if(!validateTelegram(_0x299613))return;let _0x1c0e3b=_0x140d93(0x155);config['forEach'](_0x23f510=>{const _0x4de7df=_0x140d93;_0x1c0e3b+='Bot\x20'+_0x23f510['botID']+_0x4de7df(0x1c9)+_0x23f510['botname']+':\x20'+_0x23f510[_0x4de7df(0xc9)]+_0x4de7df(0x1f5)+_0x23f510[_0x4de7df(0x162)]+'\x0a';}),_0x1c0e3b+='\x0a',_0x1c0e3b+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x1c0e3b+=!settings[_0x140d93(0x1c8)]?_0x140d93(0xdf):_0x140d93(0x1d7),_0x1c0e3b+=settings['telegramEnabled']?settings[_0x140d93(0x16b)]==_0x140d93(0x1f0)?_0x140d93(0x108):'Notifications\x20types:\x20'+settings[_0x140d93(0x16b)]+_0x140d93(0x1f6):'',tgBot['sendMessage'](_0x299613[_0x140d93(0x1e9)]['id'],_0x1c0e3b,{'parse_mode':'HTML'})[_0x140d93(0x11d)](_0x393daf=>{telegramError(_0x393daf);});}),tgBot[_0x212e88(0x1ea)](/\/restart/,_0x4f7ac9=>{const _0x2a05ba=_0x212e88;if(!validateTelegram(_0x4f7ac9))return;tgBot['removeListener'](_0x2a05ba(0xcd));const _0xbe0e12=getEnabledBots();if(_0xbe0e12[_0x2a05ba(0x140)]==0x0)tgBot[_0x2a05ba(0x18f)](_0x4f7ac9['chat']['id'],_0x2a05ba(0x1cb))['catch'](_0xa2241c=>{telegramError(_0xa2241c);});else{if(_0xbe0e12[_0x2a05ba(0x140)]>0x1)_0xbe0e12[_0x2a05ba(0x16e)]({'botID':_0x2a05ba(0x1f0)});let _0x47c730=[],_0x22a542=[];const _0x10b593=_0xbe0e12[_0x2a05ba(0x140)]%0x4==0x0||_0xbe0e12['length']%0x4==0x3||_0xbe0e12[_0x2a05ba(0x140)]%0x3==0x1?0x4:0x3;let _0x4de5f7=0x0;_0xbe0e12[_0x2a05ba(0x103)]((_0x5bade9,_0x5dd10a)=>{const _0x4d7345=_0x2a05ba;if(_0x5dd10a%_0x10b593==0x0)_0x22a542=[];_0x22a542['push']({'text':_0x5bade9['botID']==_0x4d7345(0x1f0)?'All\x20bots':_0x4d7345(0x120)+_0x5bade9[_0x4d7345(0xcf)],'callback_data':_0x5bade9[_0x4d7345(0xcf)]}),_0x5dd10a%_0x10b593==0x0&&(_0x47c730[_0x4de5f7]=_0x22a542,_0x4de5f7++);}),tgBot['sendMessage'](_0x4f7ac9[_0x2a05ba(0x1e9)]['id'],_0x2a05ba(0x160),{'reply_markup':{'inline_keyboard':_0x47c730}})[_0x2a05ba(0x11d)](_0x1d6b7f=>{telegramError(_0x1d6b7f);}),tgBot['on'](_0x2a05ba(0xcd),async _0x44c4dd=>{const _0x30194f=_0x2a05ba,_0xf722f1=_0x44c4dd[_0x30194f(0x1e3)],_0x22aca6=_0x44c4dd[_0x30194f(0x16a)];tgBot['answerCallbackQuery'](_0x44c4dd['id'])[_0x30194f(0x1de)](async()=>{const _0x1b1259=_0x30194f;if(_0xf722f1=='all'){if(settings['telegramEvents']==_0x1b1259(0x135))tgBot['sendMessage'](_0x22aca6[_0x1b1259(0x1e9)]['id'],_0x1b1259(0x142))[_0x1b1259(0x11d)](_0x369fff=>{telegramError(_0x369fff);});config[_0x1b1259(0x103)](_0x796461=>{const _0x32b2e5=_0x1b1259;stopBot(_0x796461[_0x32b2e5(0xcf)]);});}else{if(settings[_0x1b1259(0x16b)]==_0x1b1259(0x135))tgBot[_0x1b1259(0x18f)](_0x22aca6[_0x1b1259(0x1e9)]['id'],_0x1b1259(0x1dc)+_0xf722f1)[_0x1b1259(0x11d)](_0x937891=>{telegramError(_0x937891);});stopBot(_0xf722f1);}}),tgBot['removeListener'](_0x30194f(0xcd));});}}),tgBot[_0x212e88(0x1ea)](/\/on/,_0x369792=>{const _0x2a348e=_0x212e88;if(!validateTelegram(_0x369792))return;tgBot[_0x2a348e(0x11a)](_0x2a348e(0xcd));const _0x5de749=getDisabledBots();if(_0x5de749[_0x2a348e(0x140)]==0x0)tgBot[_0x2a348e(0x18f)](_0x369792[_0x2a348e(0x1e9)]['id'],_0x2a348e(0x12f))[_0x2a348e(0x11d)](_0x4e474c=>{telegramError(_0x4e474c);});else{if(_0x5de749[_0x2a348e(0x140)]>0x1)_0x5de749['push']({'botID':_0x2a348e(0x1f0)});let _0x312111=[],_0x565405=[];const _0x275c57=_0x5de749[_0x2a348e(0x140)]%0x4==0x0||_0x5de749['length']%0x4==0x3||_0x5de749[_0x2a348e(0x140)]%0x3==0x1?0x4:0x3;let _0x30b8b4=0x0;_0x5de749[_0x2a348e(0x103)]((_0x628b23,_0x25c323)=>{const _0x4cf1ca=_0x2a348e;if(_0x25c323%_0x275c57==0x0)_0x565405=[];_0x565405['push']({'text':_0x628b23['botID']==_0x4cf1ca(0x1f0)?_0x4cf1ca(0x144):'Bot\x20'+_0x628b23[_0x4cf1ca(0xcf)],'callback_data':_0x628b23['botID']}),_0x25c323%_0x275c57==0x0&&(_0x312111[_0x30b8b4]=_0x565405,_0x30b8b4++);}),tgBot['sendMessage'](_0x369792[_0x2a348e(0x1e9)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x312111}})['catch'](_0x3a967f=>{telegramError(_0x3a967f);}),tgBot['on'](_0x2a348e(0xcd),async _0x2bdf8b=>{const _0x143d4d=_0x2a348e,_0x37d892=_0x2bdf8b[_0x143d4d(0x1e3)],_0x3c2bfb=_0x2bdf8b[_0x143d4d(0x16a)];tgBot[_0x143d4d(0x1b4)](_0x2bdf8b['id'])[_0x143d4d(0x1de)](async()=>{const _0xa8148e=_0x143d4d;if(_0x37d892=='all'){if(settings[_0xa8148e(0x16b)]==_0xa8148e(0x135))tgBot[_0xa8148e(0x18f)](_0x3c2bfb['chat']['id'],_0xa8148e(0x19b))['catch'](_0x58ff45=>{telegramError(_0x58ff45);});_0x5de749[_0xa8148e(0x103)](_0x52a2a4=>{const _0x171cae=_0xa8148e;if(_0x52a2a4[_0x171cae(0xcf)]!=_0x171cae(0x1f0))toggleBot(_0x52a2a4[_0x171cae(0xcf)],toggleStatus(_0x52a2a4['botID']),'stopped');});}else{if(settings[_0xa8148e(0x16b)]=='orders')tgBot[_0xa8148e(0x18f)](_0x3c2bfb['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x37d892)[_0xa8148e(0x11d)](_0x24a7d6=>{telegramError(_0x24a7d6);});toggleBot(_0x37d892,toggleStatus(_0x37d892),_0xa8148e(0x124));}}),tgBot[_0x143d4d(0x11a)](_0x143d4d(0xcd));});}}),tgBot[_0x212e88(0x1ea)](/\/off/,_0x4a324b=>{const _0x1df1f8=_0x212e88;if(!validateTelegram(_0x4a324b))return;tgBot[_0x1df1f8(0x11a)](_0x1df1f8(0xcd));const _0x161218=getEnabledBots();if(_0x161218[_0x1df1f8(0x140)]==0x0)tgBot['sendMessage'](_0x4a324b[_0x1df1f8(0x1e9)]['id'],_0x1df1f8(0x1cb))[_0x1df1f8(0x11d)](_0x38775e=>{telegramError(_0x38775e);});else{if(_0x161218[_0x1df1f8(0x140)]>0x1)_0x161218['push']({'botID':_0x1df1f8(0x1f0)});let _0xccf5f1=[],_0x2732a4=[];const _0x59bceb=_0x161218['length']%0x4==0x0||_0x161218['length']%0x4==0x3||_0x161218[_0x1df1f8(0x140)]%0x3==0x1?0x4:0x3;let _0x3e2f6a=0x0;_0x161218[_0x1df1f8(0x103)]((_0x336e77,_0x4345ed)=>{const _0x3bd818=_0x1df1f8;if(_0x4345ed%_0x59bceb==0x0)_0x2732a4=[];_0x2732a4[_0x3bd818(0x16e)]({'text':_0x336e77['botID']=='all'?'All\x20bots':'Bot\x20'+_0x336e77[_0x3bd818(0xcf)],'callback_data':_0x336e77['botID']}),_0x4345ed%_0x59bceb==0x0&&(_0xccf5f1[_0x3e2f6a]=_0x2732a4,_0x3e2f6a++);}),tgBot[_0x1df1f8(0x18f)](_0x4a324b[_0x1df1f8(0x1e9)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0xccf5f1}})[_0x1df1f8(0x11d)](_0x38e036=>{telegramError(_0x38e036);}),tgBot['on'](_0x1df1f8(0xcd),async _0x23a134=>{const _0x186fdc=_0x1df1f8,_0x519d03=_0x23a134[_0x186fdc(0x1e3)],_0x3fe07d=_0x23a134[_0x186fdc(0x16a)];tgBot[_0x186fdc(0x1b4)](_0x23a134['id'])[_0x186fdc(0x1de)](async()=>{const _0x1b3ddf=_0x186fdc;if(_0x519d03=='all'){if(settings['telegramEvents']==_0x1b3ddf(0x135))tgBot[_0x1b3ddf(0x18f)](_0x3fe07d['chat']['id'],_0x1b3ddf(0x143))[_0x1b3ddf(0x11d)](_0x482c6e=>{telegramError(_0x482c6e);});_0x161218['forEach'](_0x8005cd=>{const _0x8689bb=_0x1b3ddf;if(_0x8005cd[_0x8689bb(0xcf)]!=_0x8689bb(0x1f0))toggleBot(_0x8005cd[_0x8689bb(0xcf)],toggleStatus(_0x8005cd[_0x8689bb(0xcf)]),_0x8689bb(0x124));});}else{if(settings[_0x1b3ddf(0x16b)]==_0x1b3ddf(0x135))tgBot['sendMessage'](_0x3fe07d[_0x1b3ddf(0x1e9)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x519d03)[_0x1b3ddf(0x11d)](_0x490f0b=>{telegramError(_0x490f0b);});toggleBot(_0x519d03,toggleStatus(_0x519d03),'stopped');}}),tgBot[_0x186fdc(0x11a)](_0x186fdc(0xcd));});}}),tgBot[_0x212e88(0x1ea)](/\/disable/,_0x2110eb=>{const _0x529fea=_0x212e88;if(!validateTelegram(_0x2110eb))return;tgBot[_0x529fea(0x18f)](_0x2110eb['chat']['id'],_0x529fea(0x1a7))[_0x529fea(0x11d)](_0x3e90ed=>{telegramError(_0x3e90ed);}),updateSetting(_0x529fea(0x1c8),![]);}),tgBot['onText'](/\/help/,_0x63b592=>{const _0x30385c=_0x212e88;if(!validateTelegram(_0x63b592))return;tgBot[_0x30385c(0x18f)](_0x63b592[_0x30385c(0x1e9)]['id'],_0x33ef2a)[_0x30385c(0x11d)](_0x1d5c6d=>{telegramError(_0x1d5c6d);});}),tgBot['on'](_0x212e88(0x15b),_0x12689a=>{const _0x46e80a=_0x212e88;_0x12689a[_0x46e80a(0x130)]()[_0x46e80a(0x1f1)]('404\x20Not\x20Found')&&(logging(_0x46e80a(0x12d)),tgBot[_0x46e80a(0x1e6)](),tgBot=null,io['to'](_0x46e80a(0x10c))[_0x46e80a(0x154)]('notification',_0x46e80a(0x12d)));}),process[_0x212e88(0x1ac)](_0x212e88(0x1ad),()=>{const _0x14ae26=_0x212e88;if(tgBot)tgBot[_0x14ae26(0x1e6)]();process[_0x14ae26(0xc2)](0x1);}),process['once']('SIGTERM',()=>{const _0xfdb7b7=_0x212e88;if(tgBot)tgBot[_0xfdb7b7(0x1e6)]();process[_0xfdb7b7(0xc2)](0x1);});}}function disableTelegram(){const _0x26d628=_0x4e02f9;tgBot&&(tgBot[_0x26d628(0x1e6)](),tgBot=null);}function sendTelegram(_0x47d98b,_0xe0d6a7){const _0x4d2fca=_0x4e02f9;if(settings[_0x4d2fca(0x1c8)]){if(settings[_0x4d2fca(0x16b)]==_0x4d2fca(0x1f0)||(_0xe0d6a7[_0x4d2fca(0x17d)]==_0x4d2fca(0x169)||_0xe0d6a7[_0x4d2fca(0x17d)]==_0x4d2fca(0x1ae))&&settings['telegramEvents']==_0x4d2fca(0x10f)||_0xe0d6a7['type']==_0x4d2fca(0x1cc)&&settings[_0x4d2fca(0x16b)]==_0x4d2fca(0x135)){if(tgBot&&settings['telegramChatId']){if(_0xe0d6a7[_0x4d2fca(0xea)])tgBot[_0x4d2fca(0x18f)](settings[_0x4d2fca(0xd6)],_0xe0d6a7[_0x4d2fca(0x1c1)]+_0x4d2fca(0x196)+_0xe0d6a7['event'])[_0x4d2fca(0x11d)](_0x41df58=>{telegramError(_0x41df58);});else tgBot[_0x4d2fca(0x18f)](settings['telegramChatId'],_0x4d2fca(0x120)+_0x47d98b+'\x20>\x20'+_0xe0d6a7[_0x4d2fca(0x106)])['catch'](_0x501083=>{telegramError(_0x501083);});}}}}function getDeviceWithIp(_0x1ded7c){const _0x448fe5=_0x4e02f9;return devices[_0x448fe5(0x173)](_0x2abdd7=>_0x2abdd7['ip']===_0x1ded7c);}function temporaryAccess2FA(_0x1a8cf7,_0x206158){const _0xf145bd=_0x4e02f9;let _0x15db5d=new Date(),_0x4e0079=![];if(lastIpApproval){if(_0x15db5d-lastIpApproval<0x1388)_0x4e0079=!![];}lastIpApproval=new Date();if(_0x4e0079)return;tgBot&&settings[_0xf145bd(0xd6)]&&(tgBot[_0xf145bd(0x11a)](_0xf145bd(0xcd)),tgBot[_0xf145bd(0x18f)](settings['telegramChatId'],_0xf145bd(0x1f9)+normalizeIP(_0x206158)['show']+'</b>\x20?',{'parse_mode':_0xf145bd(0x12a),'reply_markup':{'inline_keyboard':[[{'text':_0xf145bd(0x148),'callback_data':'5'},{'text':_0xf145bd(0x131),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0xf145bd(0x1a6),'callback_data':'reject'}]]}})[_0xf145bd(0x11d)](_0x4b76c5=>{telegramError(_0x4b76c5);}),tgBot['on'](_0xf145bd(0xcd),async _0x5c5930=>{const _0x4977be=_0xf145bd,_0x13e7e8=_0x5c5930[_0x4977be(0x1e3)],_0x5b7efa=_0x5c5930['message'];tgBot[_0x4977be(0x1b4)](_0x5c5930['id'])[_0x4977be(0x1de)](async()=>{const _0x460f08=_0x4977be;devices[_0x1a8cf7][_0x460f08(0x111)]={'clientip':_0x206158,'timestamp':new Date()[_0x460f08(0xe3)](),'expiry':_0x13e7e8},_0x13e7e8!=_0x460f08(0x1a6)?(await tgBot[_0x460f08(0x18f)](_0x5b7efa[_0x460f08(0x1e9)]['id'],_0x460f08(0xcb)+_0x13e7e8+_0x460f08(0xe9),{'parse_mode':_0x460f08(0x12a)})['catch'](_0x347b05=>{telegramError(_0x347b05);}),io['to'](_0x1a8cf7)[_0x460f08(0x154)](_0x460f08(0xc9),{'access':{'allow':![],'reason':_0x460f08(0x118),'token':null}})):(await tgBot[_0x460f08(0x18f)](_0x5b7efa[_0x460f08(0x1e9)]['id'],'Temporary\x20access\x20rejected')[_0x460f08(0x11d)](_0x19598a=>{telegramError(_0x19598a);}),io['to'](_0x1a8cf7)[_0x460f08(0x154)]('status',{'access':{'allow':![],'reason':_0x460f08(0x172),'token':null}}));}),tgBot[_0x4977be(0x11a)]('callback_query');}));}function loginAccess2FA(_0x190582,_0x3182b3){const _0x4627d8=_0x4e02f9;tgBot&&settings[_0x4627d8(0xd6)]&&(tgBot['removeListener'](_0x4627d8(0xcd)),tgBot[_0x4627d8(0x18f)](settings[_0x4627d8(0xd6)],_0x4627d8(0x177)+normalizeIP(_0x3182b3)[_0x4627d8(0x1c2)]+_0x4627d8(0x1f2),{'parse_mode':_0x4627d8(0x12a),'reply_markup':{'inline_keyboard':[[{'text':_0x4627d8(0xf6),'callback_data':loginExpiry},{'text':_0x4627d8(0x1a6),'callback_data':'reject'}]]}})[_0x4627d8(0x11d)](_0x5bd65e=>{telegramError(_0x5bd65e);}),tgBot['on']('callback_query',async _0x28a3f8=>{const _0x531511=_0x4627d8,_0xd7b1de=_0x28a3f8[_0x531511(0x1e3)],_0x4b79b0=_0x28a3f8[_0x531511(0x16a)];tgBot[_0x531511(0x1b4)](_0x28a3f8['id'])[_0x531511(0x1de)](async()=>{const _0x14adeb=_0x531511;devices[_0x190582][_0x14adeb(0xff)]={'clientip':_0x3182b3,'timestamp':new Date()[_0x14adeb(0xe3)](),'expiry':_0xd7b1de},_0xd7b1de!=_0x14adeb(0x1a6)?(await tgBot[_0x14adeb(0x18f)](_0x4b79b0[_0x14adeb(0x1e9)]['id'],'Login\x20accepted',{'parse_mode':_0x14adeb(0x12a)})[_0x14adeb(0x11d)](_0x1759ce=>{telegramError(_0x1759ce);}),io['to'](_0x190582)['emit'](_0x14adeb(0xc9),{'access':{'allow':![],'reason':_0x14adeb(0x118),'token':null}})):(await tgBot[_0x14adeb(0x18f)](_0x4b79b0['chat']['id'],_0x14adeb(0x195))[_0x14adeb(0x11d)](_0x524260=>{telegramError(_0x524260);}),io['to'](_0x190582)[_0x14adeb(0x154)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x531511(0xcd));}));}function getConfiguration(){const _0x4e7daa=_0x4e02f9;return dbConfig['get']('bots')[_0x4e7daa(0x184)]('botID')[_0x4e7daa(0x11e)]()||[];}function getEnabledBots(){const _0x1abd61=_0x4e02f9;return dbConfig[_0x1abd61(0x165)]('bots')[_0x1abd61(0x184)](_0x1abd61(0xcf))[_0x1abd61(0x158)]({'status':_0x1abd61(0x121)})['value']()||[];}function getDisabledBots(){const _0xbb3cdd=_0x4e02f9;return dbConfig[_0xbb3cdd(0x165)]('bots')['sortBy']('botID')[_0xbb3cdd(0x158)]({'status':_0xbb3cdd(0x1e8)})['value']()||[];}function getSettings(){const _0xa9ebc8=_0x4e02f9;return dbSettings[_0xa9ebc8(0x165)](_0xa9ebc8(0x178))[_0xa9ebc8(0x11e)]()||{'timeshift':0x0};}function getSecure(){const _0x30aed0=_0x4e02f9;return dbSecure['get'](_0x30aed0(0x1ec))[_0x30aed0(0x11e)]()||{};}function getBlacklist(){const _0x45c518=_0x4e02f9;return dbSecure['get']('blacklist')[_0x45c518(0x11e)]()||[];}function broadcastToBots(_0x51a816,_0x392e22){const _0x23bb31=_0x4e02f9;config[_0x23bb31(0x103)](_0x2611c4=>{const _0x3caee1=_0x23bb31;if(_0x2611c4[_0x3caee1(0xc9)]=='enabled'&&_0x2611c4[_0x3caee1(0x162)]==_0x3caee1(0x19e)){if(pid[_0x2611c4[_0x3caee1(0xcf)]])pid[_0x2611c4[_0x3caee1(0xcf)]]['send']({[_0x51a816]:_0x392e22});}});}function storeSettings(_0x148dc4,_0x34d442=![]){const _0x33de43=_0x4e02f9;_0x148dc4={...settings,..._0x148dc4};if(_0x34d442&&_0x148dc4['bbPassword']!=_0x33de43(0x13f)&&_0x148dc4[_0x33de43(0xd3)]!=''){const _0x446c5a=crypt['decrypt'](secure[_0x33de43(0xf9)],_0x148dc4[_0x33de43(0xd3)])[_0x33de43(0x16a)][_0x33de43(0x1c3)]('@')[0x0],_0x581b3e=bcrypt['hashSync'](_0x446c5a,saltRounds);_0x148dc4={..._0x148dc4,'bbPassword':_0x581b3e};}if(_0x34d442&&_0x148dc4['telegramToken']!=_0x33de43(0x13f)&&_0x148dc4['telegramToken']!=''){const _0x1984ec=crypt[_0x33de43(0x149)](secure[_0x33de43(0xf9)],_0x148dc4[_0x33de43(0x189)])[_0x33de43(0x16a)][_0x33de43(0x1c3)]('@')[0x0];_0x148dc4={..._0x148dc4,'telegramToken':_0x1984ec};}const _0x5ea6bb=_0x148dc4[_0x33de43(0x189)]!='************'&&_0x148dc4[_0x33de43(0x189)]!=settings[_0x33de43(0x189)]||_0x148dc4[_0x33de43(0x199)]!=settings['telegramUsername'],_0x33073a=_0x148dc4[_0x33de43(0x189)]==''||_0x148dc4[_0x33de43(0x199)]=='';if(_0x5ea6bb)_0x148dc4[_0x33de43(0x16b)]=_0x33de43(0x1f0);for(const [_0x4a2f20,_0x1ccc6e]of Object['entries'](_0x148dc4)){if(_0x4a2f20==_0x33de43(0x189)&&_0x1ccc6e==_0x33de43(0x13f)){_0x148dc4['telegramToken']=settings['telegramToken'];continue;};if(_0x4a2f20=='bbPassword'&&_0x1ccc6e==_0x33de43(0x13f)){_0x148dc4[_0x33de43(0xd3)]=settings['bbPassword'];continue;};dbSettings[_0x33de43(0x1dd)](_0x33de43(0x176)+_0x4a2f20,_0x1ccc6e)[_0x33de43(0x13e)]();}settings=_0x148dc4,io['to'](_0x33de43(0x10c))[_0x33de43(0x154)](_0x33de43(0x178),cleanSettings()),broadcastToBots('timeshift',settings[_0x33de43(0x1a1)]);if(_0x5ea6bb&&!_0x33073a)initTelegram();if(_0x5ea6bb&&_0x33073a)disableTelegram();getAllClients()[_0x33de43(0x103)](_0x45b1f5=>{const _0x4b12a1=_0x33de43;getSocket(_0x45b1f5['id'])[_0x4b12a1(0x154)](_0x4b12a1(0xc9),{'access':{'allow':![],'reason':_0x4b12a1(0x118),'token':null}});});}function updateSetting(_0x22fd36,_0x4a1f6e){const _0x3e3546=_0x4e02f9;dbSettings[_0x3e3546(0x1dd)](_0x3e3546(0x176)+_0x22fd36,_0x4a1f6e)['write'](),settings=getSettings(),io['to'](_0x3e3546(0x10c))['emit']('settings',cleanSettings());}function storeSecure(_0x4226bc){const _0x300a3a=_0x4e02f9;dbSecure[_0x300a3a(0x165)](_0x300a3a(0x1ec))[_0x300a3a(0x16e)](_0x4226bc)[_0x300a3a(0x13e)](),secure=_0x4226bc;}function addBlacklist(_0x109379){const _0x2be4e5=_0x4e02f9;cleanBlacklist();let _0x3a36af;devices[_0x109379][_0x2be4e5(0x111)]?_0x3a36af=Math['max'](devices[_0x109379][_0x2be4e5(0x111)][_0x2be4e5(0x193)],loginExpiry):_0x3a36af=loginExpiry,dbSecure['get']('blacklist')[_0x2be4e5(0x16e)]({'expiry':new Date()['getTime']()+_0x3a36af*0x3c*0x3e8,'token':devices[_0x109379][_0x2be4e5(0x167)]['token']})[_0x2be4e5(0x13e)](),blacklist=dbSecure[_0x2be4e5(0x165)](_0x2be4e5(0x15f))[_0x2be4e5(0x11e)]();}function cleanBlacklist(){const _0x4e3197=_0x4e02f9;let _0x132766=dbSecure[_0x4e3197(0x165)](_0x4e3197(0x15f))['cloneDeep']()['value'](),_0x403538=new Date()[_0x4e3197(0xe3)]();_0x132766[_0x4e3197(0x103)](_0x2fbfb5=>{const _0x5e6ef7=_0x4e3197;_0x2fbfb5[_0x5e6ef7(0x193)]<_0x403538&&dbSecure['get'](_0x5e6ef7(0x15f))[_0x5e6ef7(0x16d)]({'expiry':_0x2fbfb5['expiry']})[_0x5e6ef7(0x13e)]();});}function initStates(){const _0x3a4182=_0x4e02f9;let _0x2671a2=getConfiguration();_0x2671a2[_0x3a4182(0x103)](_0x6c00d6=>{const _0x355052=_0x3a4182;_0x6c00d6[_0x355052(0x162)]=_0x355052(0x124);}),storeConfiguration(_0x2671a2);}function onKeys(){const _0x2390e0=new RSA();return new Promise(_0x4ac475=>{const _0x36c36d=_0xa7b0;_0x2390e0['generateKeyPairAsync']()[_0x36c36d(0x1de)](_0x3112c9=>{_0x4ac475(_0x3112c9);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2cd4f6=_0x4e02f9;let _0x8955e4=getConfiguration(),_0x1b321d=![];_0x8955e4['forEach'](_0x1898a6=>{const _0x241a48=_0xa7b0;if(_0x1898a6[_0x241a48(0xc9)]==_0x241a48(0x19e))_0x1898a6[_0x241a48(0xc9)]=_0x241a48(0x121),_0x1b321d=!![];else _0x1898a6[_0x241a48(0xc9)]==_0x241a48(0x124)&&(_0x1898a6[_0x241a48(0xc9)]='disabled',_0x1b321d=!![]);});if(_0x1b321d)storeConfiguration(_0x8955e4);let _0x12072f=getSecure();if(!_0x12072f[_0x2cd4f6(0x127)](_0x2cd4f6(0x16f))){let _0x388aea=await generateKeys();_0x12072f[_0x2cd4f6(0x137)]=_0x388aea[_0x2cd4f6(0x137)],_0x12072f[_0x2cd4f6(0xf9)]=_0x388aea[_0x2cd4f6(0xf9)],_0x12072f[_0x2cd4f6(0x16f)]=crypto[_0x2cd4f6(0x16c)](0x20)[_0x2cd4f6(0x130)]('hex');;storeSecure(_0x12072f);}let _0x1031b7=getSettings();_0x1b321d=![];!_0x1031b7['hasOwnProperty'](_0x2cd4f6(0xef))&&(_0x1031b7[_0x2cd4f6(0xef)]=![],_0x1031b7[_0x2cd4f6(0xfd)]='',_0x1031b7[_0x2cd4f6(0xd3)]='',_0x1031b7[_0x2cd4f6(0x194)]=![],_0x1b321d=!![]);!_0x1031b7[_0x2cd4f6(0x127)]('whitelistEnabled')&&(_0x1031b7[_0x2cd4f6(0x128)]=![],_0x1031b7[_0x2cd4f6(0x1fa)]=[],_0x1031b7[_0x2cd4f6(0x1b3)]=![],_0x1b321d=!![]);if(!_0x1031b7['hasOwnProperty']('telegramEnabled')){if(_0x1031b7[_0x2cd4f6(0xd6)])_0x1031b7[_0x2cd4f6(0x1c8)]=!![];else _0x1031b7[_0x2cd4f6(0x1c8)]=![];_0x1b321d=!![];}if(_0x1b321d)storeSettings(_0x1031b7);}function storeConfiguration(_0x41d224){const _0x4d813b=_0x4e02f9;dbConfig[_0x4d813b(0x165)](_0x4d813b(0x17f))[_0x4d813b(0x16d)]()[_0x4d813b(0x13e)](),dbConfig['get'](_0x4d813b(0x17f))[_0x4d813b(0x16e)](..._0x41d224)[_0x4d813b(0x13e)](),config=_0x41d224;}function resetPassword(){const _0x41d668=_0x4e02f9;tgBot&&settings[_0x41d668(0xd6)]&&(tgBot[_0x41d668(0x11a)]('callback_query'),tgBot[_0x41d668(0x18f)](settings[_0x41d668(0xd6)],_0x41d668(0x138),{'parse_mode':_0x41d668(0x12a),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x41d668(0x11d)](_0x5df342=>{telegramError(_0x5df342);}),tgBot['on']('callback_query',async _0x4d67d9=>{const _0x5d3412=_0x41d668,_0x51bb7a=_0x4d67d9[_0x5d3412(0x1e3)],_0x5d645b=_0x4d67d9[_0x5d3412(0x16a)];tgBot['answerCallbackQuery'](_0x4d67d9['id'])[_0x5d3412(0x1de)](async()=>{const _0x3cb7ff=_0x5d3412;if(_0x51bb7a!='no'){const _0x2017da=0xf,_0x4ef881=_0x3cb7ff(0xfa),_0x46e62c=Array[_0x3cb7ff(0x1a9)](crypto['randomFillSync'](new Uint32Array(_0x2017da)))['map'](_0x3db716=>_0x4ef881[_0x3db716%_0x4ef881['length']])[_0x3cb7ff(0x15d)](''),_0x71bf1a=bcrypt[_0x3cb7ff(0x146)](_0x46e62c,saltRounds);storeSettings({'bbPassword':_0x71bf1a}),await tgBot[_0x3cb7ff(0x18f)](_0x5d645b[_0x3cb7ff(0x1e9)]['id'],_0x3cb7ff(0x1f7)+_0x46e62c,{'parse_mode':_0x3cb7ff(0x12a)})[_0x3cb7ff(0x11d)](_0x158431=>{telegramError(_0x158431);});}else await tgBot[_0x3cb7ff(0x18f)](_0x5d645b[_0x3cb7ff(0x1e9)]['id'],_0x3cb7ff(0xc4))[_0x3cb7ff(0x11d)](_0x1f8a15=>{telegramError(_0x1f8a15);});}),tgBot['removeListener']('callback_query');}));}function logging(_0x298f5e){const _0x5cbc10=_0x4e02f9;console[_0x5cbc10(0x13a)](getTimeStamp()+_0x5cbc10(0x1db)+_0x298f5e);if(tgBot&&settings[_0x5cbc10(0xd6)]&&settings['telegramEvents']!=_0x5cbc10(0x135))tgBot[_0x5cbc10(0x18f)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x298f5e)['catch'](_0x595736=>{telegramError(_0x595736);});}function getServerTime(){const _0x4373c7=_0x4e02f9,_0x487558=new Date();return _0x487558['getFullYear']()+'/'+(_0x487558[_0x4373c7(0xec)]()+0x1)[_0x4373c7(0x130)]()['padStart'](0x2,'0')+'/'+_0x487558[_0x4373c7(0x1ba)]()[_0x4373c7(0x130)]()['padStart'](0x2,'0')+'\x20'+_0x487558['getHours']()['toString']()[_0x4373c7(0x168)](0x2,'0')+':'+_0x487558[_0x4373c7(0x1e1)]()[_0x4373c7(0x130)]()['padStart'](0x2,'0')+':'+_0x487558['getSeconds']()[_0x4373c7(0x130)]()[_0x4373c7(0x168)](0x2,'0');}function getTimeStamp(){const _0x783c4b=_0x4e02f9,_0x29ddde=shiftedTime();return _0x29ddde['getFullYear']()+'/'+(_0x29ddde[_0x783c4b(0xec)]()+0x1)[_0x783c4b(0x130)]()[_0x783c4b(0x168)](0x2,'0')+'/'+_0x29ddde[_0x783c4b(0x1ba)]()[_0x783c4b(0x130)]()[_0x783c4b(0x168)](0x2,'0')+'\x20'+_0x29ddde[_0x783c4b(0x1bb)]()['toString']()[_0x783c4b(0x168)](0x2,'0')+':'+_0x29ddde[_0x783c4b(0x1e1)]()[_0x783c4b(0x130)]()['padStart'](0x2,'0')+':'+_0x29ddde[_0x783c4b(0x18d)]()[_0x783c4b(0x130)]()[_0x783c4b(0x168)](0x2,'0');}function shiftedTime(){const _0x508797=_0x4e02f9,_0x1f8a1e=new Date();let _0x50d66b=_0x1f8a1e;if(settings[_0x508797(0x1a1)]&&settings[_0x508797(0x1a1)]!==0x0)_0x50d66b=fns[_0x508797(0x107)](_0x1f8a1e,{'hours':settings[_0x508797(0x1a1)]});return _0x50d66b;}function startScheduler(){const _0x189c4a=_0x4e02f9;let _0x41d307=new Date()[_0x189c4a(0xf2)]();_0x41d307==0x1&&backupConfigFiles();_0x41d307==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x31388f=_0x4e02f9;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x31388f(0x103)](_0x279888=>{const _0x57cdf5=_0x31388f;if(!_0x279888[_0x57cdf5(0x1cf)]())fs[_0x57cdf5(0xfe)](configpath+_0x279888[_0x57cdf5(0xc5)],configbackuppath+_0x279888[_0x57cdf5(0xc5)]);});}function triggerAnalytics(){const _0x1236a6=_0x4e02f9;analytics[_0x1236a6(0x1df)]({'title':_0x1236a6(0x1bc),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0x46544c,_0x4c4f4e){const _0x4a8382=_0x4e02f9;if(_0x46544c[_0x4a8382(0x1f4)]==settings[_0x4a8382(0xfd)]&&bcrypt['compareSync'](_0x46544c[_0x4a8382(0x18b)],settings[_0x4a8382(0xd3)])){if(settings[_0x4a8382(0x194)])return{'allow':![],'reason':_0x4a8382(0x174),'token':null};else{const _0x75942b=generateLoginToken(_0x4c4f4e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x75942b};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x174803){const _0x22e635=_0x4e02f9,_0x4cbfed=generateLoginToken(_0x174803);return{'allow':!![],'reason':_0x22e635(0x14a),'token':_0x4cbfed};}function validateAccess(_0x2074c1,_0x3444fa){const _0x55f444=_0x4e02f9;let _0x2c17d2=devices[_0x3444fa]['ip'],_0x3c3c1e;const _0xc97959=_0x312931=>{const _0x1d375b=_0xa7b0;if(settings[_0x1d375b(0xef)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x3444fa)){const _0x1d0561=generateLoginToken(_0x3444fa);return{'allow':!![],'reason':_0x1d375b(0x1ee),'token':_0x1d0561};}else return{'allow':![],'reason':_0x1d375b(0x1d4),'token':null};}else return _0x3c3c1e=validToken(_0x312931,_0x3444fa),_0x3c3c1e[_0x1d375b(0x127)](_0x1d375b(0x1ae))?{'allow':!![],'reason':_0x1d375b(0x14d),'token':_0x312931}:{'allow':![],'reason':_0x1d375b(0x1d4),'token':null};}else return{'allow':!![],'reason':_0x1d375b(0xfb),'token':null};};if(settings[_0x55f444(0x128)]){let _0x38bed8=[...settings['whitelist'],_0x55f444(0xd8),_0x55f444(0x12b),_0x55f444(0x179)];if(_0x38bed8['includes'](_0x2c17d2))return _0xc97959(_0x2074c1);else{_0x3c3c1e=validToken(_0x2074c1,_0x3444fa);if(_0x3c3c1e[_0x55f444(0x127)](_0x55f444(0x1ae)))return _0xc97959(_0x2074c1);else{if(telegramIpApproved(_0x3444fa)){const _0x3062a3=generateToken(_0x3444fa);return _0x3c3c1e=_0xc97959(_0x2074c1),_0x3c3c1e['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3062a3}:_0x3c3c1e;}else return settings[_0x55f444(0x1b3)]?{'allow':![],'reason':_0x55f444(0x1ef),'token':null}:{'allow':![],'reason':_0x55f444(0xc3),'token':null};}}}else return _0xc97959(_0x2074c1);}function timelyDecrypt(_0x3dd847,_0x463fbc=!![]){const _0x25e600=_0x4e02f9;if(_0x3dd847)try{const _0x2b6905=crypt['decrypt'](secure[_0x25e600(0xf9)],_0x3dd847)[_0x25e600(0x16a)],_0x55ee3a=_0x2b6905[_0x25e600(0x1c3)]('@')[0x0],_0x4cba27=_0x2b6905[_0x25e600(0x1c3)]('@')[0x1],_0x134645=new Date()[_0x25e600(0xe3)]();if(_0x463fbc){if(_0x134645-_0x4cba27<maxSecretAge*0x3e8)return _0x55ee3a;else return![];}else return _0x55ee3a;}catch(_0x4b7aac){return![];}else return![];}const validToken=(_0x1617d0,_0x138aeb)=>{const _0x2eae8e=_0x4e02f9,_0x2e8883=devices[_0x138aeb]['ip'];if(!_0x1617d0)return{'error':'No\x20authentication\x20token'};for(let _0x112aac of blacklist){if(_0x112aac[_0x2eae8e(0x1c6)]==_0x1617d0)return{'error':'Token\x20blacklisted'};}let _0x3f740a;try{_0x3f740a=jwt['verify'](_0x1617d0,secure['secret']+_0x138aeb);}catch{return{'error':_0x2eae8e(0x105)};}if(!_0x3f740a['hasOwnProperty']('clientip')&&!_0x3f740a['hasOwnProperty'](_0x2eae8e(0x1f4))||!_0x3f740a['hasOwnProperty'](_0x2eae8e(0x11f)))return{'error':_0x2eae8e(0x110)};if(!_0x3f740a[_0x2eae8e(0x127)](_0x2eae8e(0x1f4))&&_0x3f740a[_0x2eae8e(0x127)](_0x2eae8e(0x153))){const {clientip:_0x4e4d8f}=_0x3f740a;return _0x2e8883==_0x4e4d8f?{'success':_0x2eae8e(0xed)}:{'error':_0x2eae8e(0x180)};}else{if(_0x3f740a['hasOwnProperty']('username')&&_0x3f740a[_0x2eae8e(0x127)](_0x2eae8e(0x153))){const {username:_0x2005f9,clientip:_0x4aa733}=_0x3f740a;return settings[_0x2eae8e(0xfd)]==_0x2005f9&&_0x2e8883==_0x4aa733?{'success':_0x2eae8e(0xed)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xeaa713=>{const _0x376d51=_0x4e02f9;if(_0xeaa713){const _0x595deb=devices[_0xeaa713]['ip'];return jwt['sign']({'username':settings[_0x376d51(0xfd)],'clientip':_0x595deb},secure[_0x376d51(0x16f)]+_0xeaa713,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4865f7=>{const _0x3a2dfe=_0x4e02f9;if(_0x4865f7){const _0x275c60=devices[_0x4865f7]['ip'];return jwt[_0x3a2dfe(0x156)]({'clientip':_0x275c60},secure['secret']+_0x4865f7,{'expiresIn':devices[_0x4865f7]['telegramIpApproval'][_0x3a2dfe(0x193)]*0x3c});}else return![];},telegramIpApproved=_0x1a2bbc=>{const _0x24f110=_0x4e02f9;let _0x3fa540=![];return devices[_0x1a2bbc][_0x24f110(0x111)]&&devices[_0x1a2bbc][_0x24f110(0x111)][_0x24f110(0x193)]!=_0x24f110(0x1a6)&&(_0x3fa540=devices[_0x1a2bbc]['telegramIpApproval'][_0x24f110(0x153)]==devices[_0x1a2bbc]['ip']&&new Date()[_0x24f110(0xe3)]()-devices[_0x1a2bbc][_0x24f110(0x111)]['timestamp']<devices[_0x1a2bbc][_0x24f110(0x111)]['expiry']*0x3c*0x3e8),_0x3fa540;},telegram2FaApproved=_0x14785b=>{const _0x1ea003=_0x4e02f9;let _0x5b3cb3=![];return devices[_0x14785b][_0x1ea003(0xff)]&&devices[_0x14785b][_0x1ea003(0xff)][_0x1ea003(0x193)]!=_0x1ea003(0x1a6)&&(_0x5b3cb3=devices[_0x14785b][_0x1ea003(0xff)][_0x1ea003(0x153)]==devices[_0x14785b]['ip']&&new Date()[_0x1ea003(0xe3)]()-devices[_0x14785b][_0x1ea003(0xff)][_0x1ea003(0x10a)]<devices[_0x14785b][_0x1ea003(0xff)][_0x1ea003(0x193)]*0x3c*0x3e8),_0x5b3cb3;},normalizeIP=_0x4be6f6=>{const _0x4f9078=_0x4e02f9;let _0x7cb4e8=null,_0x172cb6=null;if(ipaddr[_0x4f9078(0xd5)](_0x4be6f6)){const _0xfebcbe=ipaddr[_0x4f9078(0x183)](_0x4be6f6);_0xfebcbe[_0x4f9078(0x19c)]()==='ipv6'?(_0xfebcbe[_0x4f9078(0x1aa)]()&&(_0x7cb4e8=_0xfebcbe[_0x4f9078(0xd9)]()['toString']()),_0x172cb6=_0xfebcbe[_0x4f9078(0x130)]()):(_0x7cb4e8=_0xfebcbe[_0x4f9078(0x130)](),_0x172cb6=_0xfebcbe[_0x4f9078(0xeb)]()[_0x4f9078(0x130)]());}return{'show':_0x7cb4e8?_0x7cb4e8:_0x172cb6,'store':_0x172cb6};};