const _0x59775d=_0x36a4;(function(_0x54444e,_0x3dee14){const _0x5670f6=_0x36a4,_0x4e1869=_0x54444e();while(!![]){try{const _0xc74ecd=parseInt(_0x5670f6(0x240))/0x1*(-parseInt(_0x5670f6(0x252))/0x2)+parseInt(_0x5670f6(0x1a4))/0x3*(parseInt(_0x5670f6(0x2be))/0x4)+-parseInt(_0x5670f6(0x296))/0x5*(-parseInt(_0x5670f6(0x173))/0x6)+-parseInt(_0x5670f6(0x2a0))/0x7*(parseInt(_0x5670f6(0x21c))/0x8)+-parseInt(_0x5670f6(0x2f0))/0x9*(parseInt(_0x5670f6(0x266))/0xa)+parseInt(_0x5670f6(0x1a6))/0xb+parseInt(_0x5670f6(0x2ae))/0xc;if(_0xc74ecd===_0x3dee14)break;else _0x4e1869['push'](_0x4e1869['shift']());}catch(_0x2edc40){_0x4e1869['push'](_0x4e1869['shift']());}}}(_0x5d5d,0x8b83c));const _0x41d717=function(){let _0x20b8fd=!![];return function(_0x5db31f,_0x3752dd){const _0x679d59=_0x20b8fd?function(){const _0x45c7c5=_0x36a4;if(_0x3752dd){const _0x4bf9b3=_0x3752dd[_0x45c7c5(0x26e)](_0x5db31f,arguments);return _0x3752dd=null,_0x4bf9b3;}}:function(){};return _0x20b8fd=![],_0x679d59;};}(),_0x25a396=_0x41d717(this,function(){const _0x3aad9f=_0x36a4;return _0x25a396[_0x3aad9f(0x30d)]()['search'](_0x3aad9f(0x27f))['toString']()['constructor'](_0x25a396)['search'](_0x3aad9f(0x27f));});_0x25a396();'use strict';process[_0x59775d(0x1bd)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x59775d(0x15f)),fs=require('fs'),fns=require('date-fns'),low=require(_0x59775d(0x1fc)),FileSync=require(_0x59775d(0x1b5)),path=require('path'),crypto=require(_0x59775d(0x30e)),Crypt=require(_0x59775d(0x291))[_0x59775d(0x2ab)],RSA=require(_0x59775d(0x291))[_0x59775d(0x1a2)],bcrypt=require('bcryptjs'),jwt=require(_0x59775d(0x170)),ipaddr=require('ipaddr.js'),argv=require(_0x59775d(0x289))(process['argv']['slice'](0x2))['argv'],uuidRandom=require('uuid-random'),TelegramBot=require(_0x59775d(0x295)),Mixpanel=require(_0x59775d(0x2bd)),axios=require(_0x59775d(0x2a3)),{GraphQLClient,gql}=require(_0x59775d(0x17b)),util=require(_0x59775d(0x2f1)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x59775d(0x1f5)]||_0x59775d(0x2f5),pattern=/^[0-9]{2,4}$/;!pattern[_0x59775d(0x303)](PORT)&&(console[_0x59775d(0x221)](_0x59775d(0x1fb)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x59775d(0x2c7)](0x1));function _0x5d5d(){const _0x14d198=['Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','=>\x20Go\x20to\x20#CYA#http://','getDate','name','Starting\x20Balance\x20Bot\x20update','pidRefreshToken','entries','telegramUsername','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','config/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','sortBy','mtime','12984mDSZHD','0.0.0','push','reinstall','/:bot/performance','log','exchange','blacklist','bbvReceive','access','init','min','new-disabled','range','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/metrics\x20-\x20show\x20bot\x20performance\x0a','mkdirSync','Markdown','/:bot/support','forEach','/:bot/history','disconnect','Unauthorized\x20attempt\x20to\x20confirm\x20message','padStart','inherit','password','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Notifications\x20enabled','/:bot','Bot\x20','getPortfolio','track','(staging)','sendPortfolioTelegram','login\x20token\x20valid','6b67f3d61ee94b8f5c80b4affef4c4d9','31VIrwTL','privateKey','download','Logged\x20out\x20user\x20...','/help\x20-\x20show\x20available\x20commands\x0a','Invalid\x20authentication\x20token\x20(1)','Setting\x20access:\x20','\x20(2)','Unauthorized\x20attempt\x20to\x20get\x20messages','value','sort','bots','onText','backup','enabled','Notifications\x20disabled\x0a','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','store-headless','40288nULaHT','/on\x20-\x20start\x20bot(s)\x0a','pidExpireLogin','alerts','files','debug','Starting\x20new\x20bot\x20|\x20Bot\x20','send','settings.','Starting\x20bot\x20|\x20Bot\x20','/off\x20-\x20stop\x20bot(s)\x0a','listen','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','#RES#\x20','params','full','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','warning','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','-events.json','30UtYfav','reject','running','success','backup-full','telegramIpApproval','request','Error\x20removing\x20old\x20backup\x20files:','apply','backup-full@','environment','apiSecret','fork','login\x20token\x20generated','Alerts','getHours','\x20to\x20','post','build','sha256','/enable\x20-\x20enable\x20notifications\x0a','All\x20bots\x20running\x20right\x20now','All\x20bots','referer','startsWith','(((.+)+)+)+$','-config.json','Your\x20installation\x20is\x20already\x20up\x20to\x20date','storeHeadless','logs/','split','stopPolling','defaults','Password\x20reset\x20rejected','file','yargs/yargs','bbvNew','node-zip','SIGTERM','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','*$1*','reason','bbPassword','hybrid-crypto-js','sendMessage','2FA\x20login\x20rejected','https://api.ipify.org?format=json','node-telegram-bot-api','5JMmnMA','connection','Bot\x20Mgr\x20>\x20','status','/update\x20-\x20update\x20Balance\x20Bot\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','function','messages','build2','keys','1883CuHaQX','join','store-configuration','axios','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','/:bot/portfolio','lastmsgemitted','logged\x20out',':\x20Bot\x20Mgr\x20>\x20','filter','update','Crypt','kill','add','16094244oYUGds','binary','reload','update-bot','\x1b[0m','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','uncaughtException','Restore\x20process\x20aborted','zip/','Restore\x20backup\x20file\x20','getUTCHours','catch','whitelistEnabled','secret','access\x20timeout','mixpanel','31904coOCKT','botname','Restoring\x20bot(s)\x20from\x20backup','Login\x20rejected','get-starting-balances','storeConfiguration','backup/','Token\x20blacklisted','format','exit','\x20|\x20user:\x20...','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','socket.io','Deleted\x20Bot\x20','-results.json','temp/','error','from','/download/:type','login\x20required','type','writeFileSync','get','Invalid\x20Telegram\x20token','connected','telegramChatId',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','toggle-bot-mode','telegramEvents','reset-password','ipv6','then','initclient','number','backup-full.zip','You\x20can\x20use\x20the\x20following\x20commands:\x0a','set','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','remove','manual','./version.json','Unauthorized\x20attempt\x20to\x20log\x20out','bb-settings.json','/status\x20-\x20show\x20bot(s)\x20status\x0a','apiKey','showConfig',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','15\x20min','onepagemode','getFullYear','2162871olSJIP','util','whitelist','data','RSA-OAEP','3000','1000','event','-performance.json','-----------------------------------------------------------------------------------','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','allow','headers','once','stringify','Unauthorized\x20attempt\x20to\x20store\x20configuration','timeshift','loginRequired','uuid','test','assign','any','expiry','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','decrypt','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','replace','::ffff:127.0.0.1','toString','crypto','readFileSync','simple','live','generateKeyPairAsync','bot-','stopped','disabled','Server','_data','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','string','username','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','staging','production','callback_query','telegrammsg','5\x20min','sign','length','reset-history','family','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','readdirSync','match','getMonth','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','copyFileSync','server','cancelLoading','user','store','Orders','Restarting\x20Bot\x20','max','userid','#RES#\x20if\x20running\x20on\x20server','token','store-fiat','child_process','Starting\x20#RED#Balance\x20Bot\x20v','Ok,\x20will\x20send\x20order\x20notifications\x20only','statSync','************','deleteHistoryAlerts','internal','hasOwnProperty','existsSync','30\x20min','randomFillSync','slice','placeOrder','resetHistory','Yes','polling_error','mode','jsonwebtoken','\x20(1)','sendFile','1064058JsQVfh','Temporary\x20access\x20rejected','2FA\x20login\x20required','/names\x20-\x20show\x20bot\x20names\x0a','output-002.log','Unauthorized\x20attempt\x20to\x20update\x20settings','chat','File\x20uploaded','graphql-request','settings','<b>Balance\x20Bot\x20Status:</b>\x0a','/output-000.log','place-order','updatebotmanager','order','botID','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','isDirectory','[ip-address]','headless','logout','temporary\x20access\x20rejected','\x1b[36m','\x20|\x20','auto','answerCallbackQuery','\x20mode','secure','Idling\x20bot\x20\x20\x20|\x20Bot\x20','clients','f2aRequired','invalid\x20credentials','endsWith','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','remoteAddress','User\x20has\x20been\x20validated','Session\x20expired\x20for\x20user\x20...','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','2FA\x20login\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','\x1b[35m','kind','verify','Unauthorized\x20attempt\x20to\x20add\x20bot','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','bb-config.json','RSA','latestversion','153YRflJu','static','4709694uQnzkr','telegramToken','/disable\x20-\x20disable\x20notifications\x0a','http','yes','parse','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','write','\x20only\x0a','output-001.log','toIPv4Address','login','handshake','lowdb/adapters/FileSync','login\x20not\x20required','notification','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','unlinkSync','/restart\x20-\x20restart\x20bot(s)\x0a','\x20>\x20','getMinutes','env','publicKey','bot','get-messages','removeListener','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','stop','</b>\x20?','index.html','\x1b[34m','address','getTime','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','all','***','telegramEnabled','rmSync','emitHistory','bb-secure.json','confirm-message','\x20|\x20client:\x20...','No\x20bots\x20running\x20right\x20now','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','host','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','temporaryAccessAllowed','orders','botmanager','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','started','args','No\x20authentication\x20token','Unauthorized\x20attempt\x20to\x20delete\x20bot','api-eu.mixpanel.com','compareSync','find','includes','title','toggleBotMode','emit','/:bot/configuration','private','show','new','lastmsgtelegram','generate','delete-bot','sendMetricsTelegram','tkn','storeFiat','getSeconds','removeAllListeners','createWriteStream','restore-backup-file','bot.js','HTML','port','backup-files','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','get-backup-files','/upload-backup','backupfile','Error:\x20Invalid\x20argument\x20','lowdb','output-000.log','clientip','createServer','isValid','Starting\x20Balance\x20Bot\x20reinstallation','socket','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','showname','.zip','timestamp','2FA\x20required','message','Unauthorized\x20attempt\x20to\x20download\x20','telegram2FaApproval','apiPassword','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached'];_0x5d5d=function(){return _0x14d198;};return _0x5d5d();}const HOST=argv[_0x59775d(0x1d4)]||null,userID=argv[_0x59775d(0x32e)]||'',debugging=argv['d']||![],nodeversion=process['versions']['node'],environment=require(_0x59775d(0x2e6))[_0x59775d(0x270)]||_0x59775d(0x31e);let bbpath='bb/',bbpath2='';const botfile=_0x59775d(0x1f3),configfile=_0x59775d(0x1a1),settingsfile=_0x59775d(0x2e8),securefile=_0x59775d(0x1cf),maxBackups=0xa;let validInstallation=!![];!fs[_0x59775d(0x167)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x59775d(0x190)),configpath=userID?bbpath+_0x59775d(0x217)+userID+'/':bbpath+_0x59775d(0x217),configbackuppath=configpath+_0x59775d(0x2c4),logspath=userID?bbpath+_0x59775d(0x283)+userID+'/':bbpath+_0x59775d(0x283),zippath=userID?bbpath+_0x59775d(0x2b6)+userID+'/':bbpath+_0x59775d(0x2b6),loggerfile=fs[_0x59775d(0x1f1)](logspath+_0x59775d(0x17e),{'flags':'a'}),temppath=userID?bbpath+_0x59775d(0x2cd)+userID+'/':bbpath+_0x59775d(0x2cd);!fs[_0x59775d(0x167)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x59775d(0x167)](configbackuppath)&&fs[_0x59775d(0x22c)](configbackuppath);!fs[_0x59775d(0x167)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x59775d(0x167)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x59775d(0x286)]({'bots':[]})[_0x59775d(0x1af)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x59775d(0x286)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x59775d(0x21d),'onepagemode':![]}})[_0x59775d(0x1af)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x59775d(0x286)]({'secure':{},'blacklist':[]})[_0x59775d(0x1af)]();let crypt=new Crypt({'md':_0x59775d(0x279),'rsaStandard':_0x59775d(0x2f4)});const saltRounds=0xa,mixpanel=Mixpanel[_0x59775d(0x226)](_0x59775d(0x23f),{'host':_0x59775d(0x1de)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x59775d(0x1a7)]&&settings[_0x59775d(0x1a7)]!=''&&settings[_0x59775d(0x215)]&&settings[_0x59775d(0x215)]!='')initTelegram();const parseColor=(_0xc8b99d,_0x22d3d1)=>{const _0x219068=_0x59775d,_0x339036=/#[A-Z]{3}#/g;if(typeof _0xc8b99d==_0x219068(0x319)){!_0x22d3d1?_0xc8b99d=_0xc8b99d[_0x219068(0x30b)](_0x339036,''):(_0xc8b99d=_0xc8b99d['replace'](/#BLU#/g,_0x219068(0x1c6)),_0xc8b99d=_0xc8b99d['replace'](/#RED#/g,'\x1b[31m'),_0xc8b99d=_0xc8b99d[_0x219068(0x30b)](/#YEL#/g,'\x1b[33m'),_0xc8b99d=_0xc8b99d['replace'](/#MAG#/g,_0x219068(0x19c)),_0xc8b99d=_0xc8b99d[_0x219068(0x30b)](/#CYA#/g,_0x219068(0x189)),_0xc8b99d=_0xc8b99d[_0x219068(0x30b)](/#RES#/g,_0x219068(0x2b2)));;}return _0xc8b99d;},logger={'screen':_0x36f3d1=>{const _0x2facc1=_0x59775d;console[_0x2facc1(0x221)](parseColor(_0x36f3d1,!![]));},'simple':_0x5ced5b=>{const _0x37083f=_0x59775d;console[_0x37083f(0x221)](parseColor(_0x5ced5b,!![])),loggerfile[_0x37083f(0x1af)](util[_0x37083f(0x2c6)](parseColor(_0x5ced5b,![]))+'\x0a');},'full':async _0x5e14a2=>{const _0x407965=_0x59775d,_0x26a848=getTimeStamp()+_0x407965(0x2a8)+_0x5e14a2;console[_0x407965(0x221)](parseColor(_0x26a848,!![])),loggerfile[_0x407965(0x1af)](util[_0x407965(0x2c6)](parseColor(_0x26a848,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x407965(0x2da)]!=_0x407965(0x1d7))await tgBot['sendMessage'](settings[_0x407965(0x2d7)],_0x407965(0x298)+parseColor(_0x5e14a2,![]))[_0x407965(0x2b9)](_0x113895=>{telegramError(_0x113895);});},'debug':async(_0x21bce2,_0x322abc='')=>{const _0x5a4976=_0x59775d,_0x2931a9=getTimeStamp()+_0x5a4976(0x2ec)+_0x21bce2;if(debugging)console['log'](parseColor(_0x2931a9,!![]));loggerfile[_0x5a4976(0x1af)](util[_0x5a4976(0x2c6)](parseColor(_0x2931a9,![]))+'\x0a');if(_0x322abc){if(debugging)console[_0x5a4976(0x221)](_0x322abc);loggerfile[_0x5a4976(0x1af)](util[_0x5a4976(0x2c6)](_0x322abc)+'\x0a');}}};process['on'](_0x59775d(0x2b4),function(_0x5ea545){logger['simple'](_0x5ea545);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x59775d(0x1a9))[_0x59775d(0x1ff)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x59775d(0x2d4)](_0x59775d(0x2d0),async(_0x141e28,_0x5cff75)=>{const _0x279e3f=_0x59775d,_0x5a464f=_0x141e28[_0x279e3f(0x260)][_0x279e3f(0x2d2)],_0x436a2c=getClientsWithBotID('botmanager'),_0x2e12bc=_0x141e28[_0x279e3f(0x2fc)]['uuid'],_0x6097c0=timelyDecrypt(_0x2e12bc,![]),_0x5746f9=_0x436a2c[_0x279e3f(0x1e0)](_0x3ea208=>_0x3ea208['uuid']==_0x6097c0);if(_0x5746f9){const _0x145880=normalizeIP(_0x141e28[_0x279e3f(0x202)]['remoteAddress'])[_0x279e3f(0x32f)],_0xd81ef0=_0x141e28['headers'][_0x279e3f(0x1ed)];if(validateAccess(_0xd81ef0,_0x6097c0,_0x145880)[_0x279e3f(0x2fb)])_0x5a464f==_0x279e3f(0x24d)&&await backupConfigFiles(),await zipFiles(_0x5a464f),_0x5cff75[_0x279e3f(0x242)](zippath+(_0x5a464f+'.zip'),_0x4c50b3=>{const _0x15b924=_0x279e3f;_0x4c50b3&&(logger[_0x15b924(0x261)](_0x15b924(0x1ad)+_0x5a464f),logger[_0x15b924(0x310)](_0x4c50b3));});else logger[_0x279e3f(0x261)](_0x279e3f(0x209)+_0x5a464f+_0x279e3f(0x171));}else logger['full'](_0x279e3f(0x209)+_0x5a464f+_0x279e3f(0x247));}),app[_0x59775d(0x277)](_0x59775d(0x1f9),async(_0xff7e5d,_0x4e8b8f)=>{const _0x55d2e9=_0x59775d,_0x5381c3=getClientsWithBotID('botmanager'),_0xa0206d=_0xff7e5d[_0x55d2e9(0x2fc)][_0x55d2e9(0x302)],_0x2d1229=timelyDecrypt(_0xa0206d,![]),_0x223fdd=_0x5381c3[_0x55d2e9(0x1e0)](_0x4344fa=>_0x4344fa[_0x55d2e9(0x302)]==_0x2d1229);logger[_0x55d2e9(0x257)]('Backup\x20file\x20uploaded');if(_0x223fdd){const _0x32723d=normalizeIP(_0xff7e5d[_0x55d2e9(0x202)][_0x55d2e9(0x196)])[_0x55d2e9(0x32f)],_0xcc505b=_0xff7e5d[_0x55d2e9(0x2fc)][_0x55d2e9(0x1ed)];if(validateAccess(_0xcc505b,_0x2d1229,_0x32723d)['allow']){if(_0xff7e5d[_0x55d2e9(0x256)]){const _0x6d4862=_0xff7e5d[_0x55d2e9(0x256)][_0x55d2e9(0x1fa)];await _0x6d4862['mv'](temppath+_0x6d4862[_0x55d2e9(0x211)]),_0x4e8b8f[_0x55d2e9(0x259)]({'status':!![],'message':_0x55d2e9(0x17a)});const _0x2ad28e=getBotsWithMode();_0x2ad28e[_0x55d2e9(0x323)]>0x0?confirmRestore(temppath,_0x6d4862[_0x55d2e9(0x211)]):unzipFile(temppath,_0x6d4862[_0x55d2e9(0x211)]);}}else logger[_0x55d2e9(0x261)](_0x55d2e9(0x218));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x59775d(0x1a5)](path['join'](__dirname,bbpath2,_0x59775d(0x29e)))),app['use'](express['static'](path[_0x59775d(0x2a1)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x4d49d2,_0x45c6d0){const _0x101dbd=_0x59775d;_0x45c6d0[_0x101dbd(0x172)](path['join'](__dirname,bbpath2,_0x101dbd(0x29e),_0x101dbd(0x1c5)));}),app['get'](_0x59775d(0x238),function(_0x23d996,_0x451470){const _0x64a681=_0x59775d;_0x451470['sendFile'](path[_0x64a681(0x2a1)](__dirname,bbpath2,'build',_0x64a681(0x1c5)));}),app[_0x59775d(0x2d4)](_0x59775d(0x2a5),(_0x12362f,_0x4d9ec5)=>{const _0x21c675=_0x59775d;_0x4d9ec5[_0x21c675(0x172)](path[_0x21c675(0x2a1)](__dirname,bbpath2,_0x21c675(0x278),_0x21c675(0x1c5)));}),app[_0x59775d(0x2d4)](_0x59775d(0x220),(_0x2c625d,_0x14c405)=>{const _0xf39682=_0x59775d;_0x14c405[_0xf39682(0x172)](path[_0xf39682(0x2a1)](__dirname,bbpath2,'build','index.html'));}),app[_0x59775d(0x2d4)]('/:bot/coins',(_0x343a07,_0x59802d)=>{const _0x439b84=_0x59775d;_0x59802d['sendFile'](path['join'](__dirname,bbpath2,'build',_0x439b84(0x1c5)));}),app[_0x59775d(0x2d4)](_0x59775d(0x230),(_0x3ed888,_0x2a4832)=>{const _0x563ad0=_0x59775d;_0x2a4832[_0x563ad0(0x172)](path[_0x563ad0(0x2a1)](__dirname,bbpath2,_0x563ad0(0x278),_0x563ad0(0x1c5)));}),app[_0x59775d(0x2d4)](_0x59775d(0x1e5),(_0xc6443a,_0x515d37)=>{const _0x3639e2=_0x59775d;_0x515d37['sendFile'](path[_0x3639e2(0x2a1)](__dirname,bbpath2,_0x3639e2(0x278),'index.html'));}),app[_0x59775d(0x2d4)](_0x59775d(0x22e),(_0x5be850,_0x4ead0d)=>{const _0x4c5a87=_0x59775d;_0x4ead0d[_0x4c5a87(0x172)](path[_0x4c5a87(0x2a1)](__dirname,bbpath2,'build',_0x4c5a87(0x1c5)));});if(HOST)http[_0x59775d(0x25d)](PORT,HOST);else http['listen'](PORT);const io=require(_0x59775d(0x2ca))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x33ab72=_0x59775d;let _0x22c855=_0x33ab72(0x185);const _0x3c7453=networkInterfaces(),_0x43f38f={};for(const _0x504a3e of Object[_0x33ab72(0x29f)](_0x3c7453)){for(const _0x190670 of _0x3c7453[_0x504a3e]){if((_0x190670['family']=='IPv4'||_0x190670[_0x33ab72(0x325)]==0x4)&&!_0x190670[_0x33ab72(0x165)]){const _0x3ed0b2=ipaddr['parse'](_0x190670[_0x33ab72(0x1c7)])[_0x33ab72(0x229)]();_0x3ed0b2!=_0x33ab72(0x1e6)&&(!_0x43f38f[_0x504a3e]&&(_0x43f38f[_0x504a3e]=[]),_0x43f38f[_0x504a3e]['push'](_0x190670[_0x33ab72(0x1c7)]),_0x22c855=_0x190670['address']);}}}return{'serverip':_0x22c855,'netinterfaces':_0x43f38f};}async function startServer(){const _0x29e93d=_0x59775d,{serverip:_0x4542d0,netinterfaces:_0xff1fab}=getServerIP();logger[_0x29e93d(0x310)](''),logger[_0x29e93d(0x310)](_0x29e93d(0x2f9)),await logger[_0x29e93d(0x261)](_0x29e93d(0x160)+serverversion+_0x29e93d(0x25f)+(environment==_0x29e93d(0x31d)?_0x29e93d(0x23c):'')+'\x0a'+(_0x29e93d(0x30a)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x29e93d(0x20f)+_0x4542d0+':'+PORT+_0x29e93d(0x15c))),logger['simple'](_0x29e93d(0x2f9));if(config[_0x29e93d(0x323)]!=0x0)for(const _0x45048d of config){if(_0x45048d[_0x29e93d(0x299)]==_0x29e93d(0x24e)||_0x45048d[_0x29e93d(0x299)]=='new')await logger['full'](_0x29e93d(0x25b)+_0x45048d[_0x29e93d(0x182)]+'\x20|\x20'+_0x45048d[_0x29e93d(0x2bf)]),startBot([_0x45048d['botID'],userID],{'cwd':bbpath},function(_0x3c91a7){const _0x1fda02=_0x29e93d;if(_0x3c91a7)logger[_0x1fda02(0x261)](_0x3c91a7);});else(_0x45048d[_0x29e93d(0x299)]==_0x29e93d(0x315)||_0x45048d[_0x29e93d(0x299)]=='new-disabled')&&await logger[_0x29e93d(0x261)](_0x29e93d(0x18f)+_0x45048d[_0x29e93d(0x182)]+_0x29e93d(0x18a)+_0x45048d[_0x29e93d(0x2bf)]);}else!newBot&&logger[_0x29e93d(0x310)](_0x29e93d(0x307));if(newBot)addBot();logger[_0x29e93d(0x310)](_0x29e93d(0x2f9)),logger[_0x29e93d(0x310)](''),await logger[_0x29e93d(0x257)]('Node.js\x20v'+nodeversion),await logger['debug']('Network\x20Interfaces:',_0xff1fab);}function startSocket(){const _0x6428f4=_0x59775d;io['on'](_0x6428f4(0x297),_0x3e24ea=>{const _0x68d287=_0x6428f4;let _0x33a568,_0x481bfc,_0x1741da,_0xa97b19,_0x496e83;const _0x1b8805=_0x3e24ea[_0x68d287(0x1b4)][_0x68d287(0x2fc)][_0x68d287(0x27d)];_0x481bfc=_0x1b8805[_0x68d287(0x328)](/bot[0-9]{3}/);if(_0x481bfc)_0x1741da=_0x481bfc[0x0]['match'](/[0-9]{3}/);if(_0x1741da)_0x33a568=_0x1741da[0x0];else _0x33a568=_0x68d287(0x1d8);const _0x5a8f92=_0x3e24ea[_0x68d287(0x1b4)]['auth']['encryptedUuid'];if(!_0x5a8f92)_0x3e24ea['emit']('status',{'publicKey':secure[_0x68d287(0x1be)]});else{_0xa97b19=timelyDecrypt(_0x5a8f92,![]);if(!_0xa97b19)_0x3e24ea[_0x68d287(0x1e4)](_0x68d287(0x299),{'publicKey':secure[_0x68d287(0x1be)]});else{_0x496e83=normalizeIP(_0x3e24ea['conn'][_0x68d287(0x196)])[_0x68d287(0x32f)];if(!devices[_0xa97b19])devices[_0xa97b19]={'uuid':_0xa97b19,'access':{'token':null}};devices[_0xa97b19]['ip']=_0x496e83;const _0x254b0a=addClient(_0x3e24ea['id'],_0xa97b19,_0x33a568);setAccess(_0x254b0a),emitMessages(),_0x3e24ea['on'](_0x68d287(0x1b3),_0x4ce963=>{const _0x3a7e88=_0x68d287,_0x9afd83=timelyDecrypt(_0x4ce963[_0x3a7e88(0x235)]);if(_0x9afd83){_0x4ce963={'username':_0x4ce963[_0x3a7e88(0x31a)],'password':_0x9afd83},devices[_0xa97b19][_0x3a7e88(0x225)]=validateCredentials(_0x4ce963,_0xa97b19);if(devices[_0xa97b19][_0x3a7e88(0x225)][_0x3a7e88(0x2fb)]==![]&&devices[_0xa97b19]['access'][_0x3a7e88(0x28f)]=='2FA\x20login\x20required')_0x3e24ea[_0x3a7e88(0x1e4)](_0x3a7e88(0x299),{'access':devices[_0xa97b19]['access']}),loginAccess2FA(_0xa97b19,_0x496e83);else{if(devices[_0xa97b19]['access']['allow']==![]&&devices[_0xa97b19]['access'][_0x3a7e88(0x28f)]=='invalid\x20credentials')_0x3e24ea[_0x3a7e88(0x1e4)](_0x3a7e88(0x299),{'access':devices[_0xa97b19]['access']});else devices[_0xa97b19][_0x3a7e88(0x225)][_0x3a7e88(0x2fb)]&&devices[_0xa97b19]['access'][_0x3a7e88(0x28f)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0xa97b19)[_0x3a7e88(0x22f)](_0x3d917e=>{setAccess(_0x3d917e);}),logger[_0x3a7e88(0x257)]('Logged\x20in\x20user\x20...'+_0xa97b19[_0x3a7e88(0x16a)](-0x8)),setTokenRefresh(_0xa97b19),setSessionTimeout(_0x3a7e88(0x1b3),_0xa97b19));}}else logger[_0x3a7e88(0x261)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x3e24ea['on'](_0x68d287(0x2db),()=>{resetPassword();}),_0x3e24ea['on'](_0x68d287(0x231),_0x4f15d0=>{removeClient(_0x3e24ea['id']);}),_0x33a568=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x245fe8){const _0xb23119=_0x59775d;if(_0x245fe8!='botmanager'&&config[_0xb23119(0x2ea)]!=''){if(pid[_0x245fe8])pid[_0x245fe8]['send']({'function':_0xb23119(0x2de),'args':null});}_0x245fe8!=_0xb23119(0x1d8)&&broadcastToBots(_0xb23119(0x24b),JSON['stringify'](config));}function reloadBotManager(){const _0x5d387c=_0x59775d;getClientsWithBotID(_0x5d387c(0x1d8))[_0x5d387c(0x22f)](_0xb06647=>{const _0x4c301f=_0x5d387c;getSocket(_0xb06647['id'])[_0x4c301f(0x1e4)](_0x4c301f(0x299),{'access':{'allow':![],'reason':_0x4c301f(0x2b0),'token':null}});});}function getSocket(_0x503500){return io['sockets']['sockets']['get'](_0x503500);}function setAccess(_0x25f5e7){const _0xff1186=_0x59775d,_0xad4847=getSocket(_0x25f5e7['id']),_0x3699f3=_0x25f5e7[_0xff1186(0x302)],_0x560825=_0x25f5e7[_0xff1186(0x1bf)];devices[_0x3699f3]['access']=validateAccess(devices[_0x3699f3]['access'][_0xff1186(0x15d)],_0x3699f3),logger[_0xff1186(0x257)](_0xff1186(0x246)+devices[_0x3699f3][_0xff1186(0x225)]['reason']+_0xff1186(0x1d1)+_0x25f5e7['id'][_0xff1186(0x16a)](-0x8)+_0xff1186(0x2c8)+_0x3699f3[_0xff1186(0x16a)](-0x8)),_0xad4847[_0xff1186(0x2a1)](_0x3699f3);if(devices[_0x3699f3][_0xff1186(0x225)][_0xff1186(0x2fb)]){_0xad4847[_0xff1186(0x2a1)](_0x560825);if(_0x560825==_0xff1186(0x1d8))initializeSocketBotManager(_0xad4847);else initializeSocketBot(_0xad4847);initClient(_0x560825);}devices[_0x3699f3]['access']['token']&&devices[_0x3699f3][_0xff1186(0x225)][_0xff1186(0x28f)]=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x3699f3),devices[_0x3699f3][_0xff1186(0x225)][_0xff1186(0x15d)]&&devices[_0x3699f3][_0xff1186(0x225)][_0xff1186(0x28f)]==_0xff1186(0x19a)&&setSessionTimeout('login',_0x3699f3),_0xad4847['emit'](_0xff1186(0x299),{'status':_0x25f5e7[_0xff1186(0x32c)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3699f3][_0xff1186(0x225)],'externalip':devices[_0x3699f3]['ip'],'publicKey':secure[_0xff1186(0x1be)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x3699f3]['access'][_0xff1186(0x2fb)]==![]&&devices[_0x3699f3][_0xff1186(0x225)][_0xff1186(0x28f)]==_0xff1186(0x207)&&temporaryAccess2FA(_0x3699f3,devices[_0x3699f3]['ip']);}function setSessionTimeout(_0x13ab7e,_0x2620e6){const _0x5de43f=_0x59775d;let _0x4e1d20;if(_0x13ab7e==_0x5de43f(0x1b3))_0x4e1d20=loginExpiry*0x3c*0x3e8;else _0x4e1d20=devices[_0x2620e6][_0x5de43f(0x26b)][_0x5de43f(0x306)]*0x3c*0x3e8-(new Date()[_0x5de43f(0x1c8)]()-devices[_0x2620e6][_0x5de43f(0x26b)]['timestamp']);if(devices[_0x2620e6][_0x5de43f(0x254)])clearTimeout(devices[_0x2620e6][_0x5de43f(0x254)]);devices[_0x2620e6][_0x5de43f(0x254)]=setTimeout(()=>{const _0x26eb1e=_0x5de43f;if(devices[_0x2620e6][_0x26eb1e(0x213)])clearTimeout(devices[_0x2620e6]['pidRefreshToken']);removeSocketListeners(_0x2620e6),addBlacklist(_0x2620e6),devices[_0x2620e6][_0x26eb1e(0x26b)]=null,devices[_0x2620e6]['telegram2FaApproval']=null,devices[_0x2620e6][_0x26eb1e(0x225)][_0x26eb1e(0x15d)]=null,logger[_0x26eb1e(0x257)](_0x26eb1e(0x198)+_0x2620e6['slice'](-0x8)),devices[_0x2620e6][_0x26eb1e(0x225)]=validateAccess(devices[_0x2620e6][_0x26eb1e(0x225)][_0x26eb1e(0x15d)],_0x2620e6),!(devices[_0x2620e6][_0x26eb1e(0x225)][_0x26eb1e(0x2fb)]&&devices[_0x2620e6][_0x26eb1e(0x225)][_0x26eb1e(0x28f)]=='login\x20not\x20required')&&(_0x13ab7e==_0x26eb1e(0x1b3)?io['to'](_0x2620e6)['emit'](_0x26eb1e(0x299),{'access':{'allow':![],'reason':_0x26eb1e(0x2bc),'token':null}}):io['to'](_0x2620e6)[_0x26eb1e(0x1e4)](_0x26eb1e(0x299),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x2620e6]['access']['token']=null;},_0x4e1d20);}function setTokenRefresh(_0x1d3a6a){const _0x662173=_0x59775d;if(devices[_0x1d3a6a]['pidRefreshToken'])clearTimeout(devices[_0x1d3a6a]['pidRefreshToken']);devices[_0x1d3a6a][_0x662173(0x213)]=setTimeout(()=>{const _0x107269=_0x662173;getClientsWithUuid(_0x1d3a6a)[_0x107269(0x323)]!=0x0?(devices[_0x1d3a6a][_0x107269(0x225)]=refreshToken(_0x1d3a6a),io['to'](_0x1d3a6a)[_0x107269(0x1e4)]('status',{'status':_0x107269(0x2d6),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1d3a6a][_0x107269(0x225)],'externalip':devices[_0x1d3a6a]['ip'],'publicKey':secure[_0x107269(0x1be)],'validInstallation':validInstallation}),setTokenRefresh(_0x1d3a6a)):clearTimeout(devices[_0x1d3a6a][_0x107269(0x213)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x35b432){const _0x3deae2=_0x59775d,_0x2122df=getClient(_0x35b432['id'])[_0x3deae2(0x302)];_0x35b432['emit'](_0x3deae2(0x24b),config),_0x35b432[_0x3deae2(0x1e4)](_0x3deae2(0x17c),cleanSettings()),_0x35b432['on']('add-bot',_0x314eb4=>{const _0x5715dd=_0x3deae2;if(validateAccess(_0x314eb4,_0x2122df)[_0x5715dd(0x2fb)])addBot();else logger['full'](_0x5715dd(0x19f));}),_0x35b432['on'](_0x3deae2(0x2b1),(_0x29e5d1,_0x17fe87)=>{const _0x26f275=_0x3deae2;if(validateAccess(_0x17fe87,_0x2122df)[_0x26f275(0x2fb)])toggleBot(_0x29e5d1[_0x26f275(0x182)],_0x29e5d1[_0x26f275(0x299)],_0x29e5d1[_0x26f275(0x311)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x35b432['on'](_0x3deae2(0x2d9),(_0x5257b6,_0x58def4)=>{const _0x22f551=_0x3deae2;if(validateAccess(_0x58def4,_0x2122df)[_0x22f551(0x2fb)])toggleBotMode(_0x5257b6);else logger[_0x22f551(0x261)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x35b432['on'](_0x3deae2(0x1eb),(_0x54822c,_0x2761b1)=>{const _0x173862=_0x3deae2;if(validateAccess(_0x2761b1,_0x2122df)[_0x173862(0x2fb)])deleteBot(_0x54822c);else logger['full'](_0x173862(0x1dd));}),_0x35b432['on']('store-settings',(_0x46ba5d,_0x46f69c)=>{const _0x3f91c1=_0x3deae2;if(validateAccess(_0x46f69c,_0x2122df)[_0x3f91c1(0x2fb)])storeSettings(_0x46ba5d,!![]);else logger[_0x3f91c1(0x261)](_0x3f91c1(0x178));}),_0x35b432['on']('update-bb',_0x5ad21e=>{const _0x16eeaf=_0x3deae2;if(validateAccess(_0x5ad21e,_0x2122df)[_0x16eeaf(0x2fb)])updateBB('update');else logger[_0x16eeaf(0x261)](_0x16eeaf(0x219));}),_0x35b432['on']('reinstall-bb',_0x1b02b6=>{const _0x442b88=_0x3deae2;if(validateAccess(_0x1b02b6,_0x2122df)[_0x442b88(0x2fb)])updateBB(_0x442b88(0x21f));else logger['full'](_0x442b88(0x31b));}),_0x35b432['on'](_0x3deae2(0x1f8),_0xf8ae91=>{const _0x32c0e4=_0x3deae2;if(validateAccess(_0xf8ae91,_0x2122df)[_0x32c0e4(0x2fb)]){const _0x307b11=getClient(_0x35b432['id']);if(_0x307b11)getBackupFiles(_0x307b11[_0x32c0e4(0x302)]);else logger[_0x32c0e4(0x261)](_0x32c0e4(0x326));}else logger[_0x32c0e4(0x261)](_0x32c0e4(0x309));}),_0x35b432['on'](_0x3deae2(0x1f2),(_0x403011,_0x16c61a)=>{const _0x45f038=_0x3deae2;if(validateAccess(_0x16c61a,_0x2122df)[_0x45f038(0x2fb)])restoreBackupFile(_0x403011);else logger[_0x45f038(0x261)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x35b432['on']('get-messages',_0x37909f=>{const _0x3d6747=_0x3deae2;if(validateAccess(_0x37909f,_0x2122df)[_0x3d6747(0x2fb)])getMessages();else logger['full'](_0x3d6747(0x248));}),_0x35b432['on'](_0x3deae2(0x1d0),(_0x94dcd3,_0x510c1a)=>{const _0x1c54aa=_0x3deae2;if(validateAccess(_0x510c1a,_0x2122df)[_0x1c54aa(0x2fb)])confirmMessage(_0x94dcd3);else logger[_0x1c54aa(0x261)](_0x1c54aa(0x232));}),_0x35b432['on'](_0x3deae2(0x187),_0x55ad7b=>{const _0x28798d=_0x3deae2;if(validateAccess(_0x55ad7b,_0x2122df)[_0x28798d(0x2fb)]){if(devices[_0x2122df][_0x28798d(0x213)])clearTimeout(devices[_0x2122df][_0x28798d(0x213)]);if(devices[_0x2122df]['pidExpireLogin'])clearTimeout(devices[_0x2122df][_0x28798d(0x254)]);removeSocketListeners(getClient(_0x35b432['id'])['uuid']),addBlacklist(_0x2122df),devices[_0x2122df][_0x28798d(0x26b)]=null,devices[_0x2122df][_0x28798d(0x20a)]=null,devices[_0x2122df][_0x28798d(0x225)]['token']=null,logger[_0x28798d(0x257)]('Logged\x20out\x20user\x20...'+_0x2122df[_0x28798d(0x16a)](-0x8)),io['to'](getClient(_0x35b432['id'])[_0x28798d(0x302)])[_0x28798d(0x1e4)]('status',{'access':{'allow':![],'reason':_0x28798d(0x2a7),'token':null}});}else logger[_0x28798d(0x261)](_0x28798d(0x2e7));});}function initializeSocketBot(_0x1dff8e){const _0x2a3a9a=_0x59775d,_0x5d6f30=getClient(_0x1dff8e['id'])[_0x2a3a9a(0x1bf)],_0x3f715b=getClient(_0x1dff8e['id'])['uuid'];_0x1dff8e['on']('get-logs',(_0x1dac40,_0x1992e1)=>{const _0x25f880=_0x2a3a9a;if(validateAccess(_0x1992e1,_0x3f715b)[_0x25f880(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x25f880(0x259)]({'function':_0x25f880(0x1ce),'args':_0x1dac40});}else logger[_0x25f880(0x261)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x1dff8e['on']('delete-alerts',(_0x1d3724,_0x4221f4)=>{const _0x48c601=_0x2a3a9a;if(validateAccess(_0x4221f4,_0x3f715b)[_0x48c601(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x48c601(0x259)]({'function':_0x48c601(0x164),'args':_0x1d3724});}else logger[_0x48c601(0x261)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x1dff8e['on']('get-portfolio',(_0x51f079,_0x55cc90)=>{const _0x5524f1=_0x2a3a9a;if(validateAccess(_0x55cc90,_0x3f715b)[_0x5524f1(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x5524f1(0x259)]({'function':_0x5524f1(0x23a),'args':_0x51f079});}else logger[_0x5524f1(0x261)](_0x5524f1(0x1ac));}),_0x1dff8e['on'](_0x2a3a9a(0x2a2),(_0xff8103,_0x4aefe6)=>{const _0x57d170=_0x2a3a9a;if(validateAccess(_0x4aefe6,_0x3f715b)[_0x57d170(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x57d170(0x259)]({'function':_0x57d170(0x2c3),'args':_0xff8103});}else logger[_0x57d170(0x261)](_0x57d170(0x2ff));}),_0x1dff8e['on'](_0x2a3a9a(0x251),(_0x207c2e,_0x41d358)=>{const _0x477121=_0x2a3a9a;if(validateAccess(_0x41d358,_0x3f715b)[_0x477121(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x477121(0x259)]({'function':_0x477121(0x282),'args':_0x207c2e});}else logger[_0x477121(0x261)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x1dff8e['on'](_0x2a3a9a(0x15e),(_0x10f1e2,_0x25aa93)=>{const _0x528fa4=_0x2a3a9a;if(validateAccess(_0x25aa93,_0x3f715b)[_0x528fa4(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x528fa4(0x259)]({'function':_0x528fa4(0x1ee),'args':_0x10f1e2});}else logger[_0x528fa4(0x261)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x1dff8e['on'](_0x2a3a9a(0x324),_0x568177=>{const _0x5571ce=_0x2a3a9a;if(validateAccess(_0x568177,_0x3f715b)[_0x5571ce(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x5571ce(0x259)]({'function':_0x5571ce(0x16c),'args':null});}else logger[_0x5571ce(0x261)](_0x5571ce(0x1b8));}),_0x1dff8e['on'](_0x2a3a9a(0x2c2),_0x12b145=>{const _0x4f633b=_0x2a3a9a;if(validateAccess(_0x12b145,_0x3f715b)[_0x4f633b(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30]['send']({'function':'getStartingBalances','args':null});}else logger['full'](_0x4f633b(0x25e));}),_0x1dff8e['on'](_0x2a3a9a(0x17f),(_0x203be6,_0x117539)=>{const _0x21c527=_0x2a3a9a;if(validateAccess(_0x117539,_0x3f715b)[_0x21c527(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x21c527(0x259)]({'function':_0x21c527(0x16b),'args':_0x203be6});}else logger[_0x21c527(0x261)](_0x21c527(0x262));}),_0x1dff8e['on']('cancel-loading',_0x44cdce=>{const _0x1101db=_0x2a3a9a;if(validateAccess(_0x44cdce,_0x3f715b)[_0x1101db(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0x1101db(0x259)]({'function':_0x1101db(0x32d),'args':null});}else logger[_0x1101db(0x261)](_0x1101db(0x250));}),_0x1dff8e['on']('show-config',_0x182519=>{const _0xaebd97=_0x2a3a9a;if(validateAccess(_0x182519,_0x3f715b)[_0xaebd97(0x2fb)]){if(pid[_0x5d6f30])pid[_0x5d6f30][_0xaebd97(0x259)]({'function':_0xaebd97(0x2eb),'args':null});}else logger[_0xaebd97(0x261)](_0xaebd97(0x1ae));}),_0x1dff8e['on']('update-bb',_0x451057=>{const _0x59be6a=_0x2a3a9a;if(validateAccess(_0x451057,_0x3f715b)[_0x59be6a(0x2fb)])updateBB(_0x59be6a(0x2aa));else logger[_0x59be6a(0x261)](_0x59be6a(0x219));}),_0x1dff8e['on'](_0x2a3a9a(0x1c0),_0x355dc0=>{if(validateAccess(_0x355dc0,_0x3f715b)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1dff8e['on'](_0x2a3a9a(0x1d0),(_0x255f46,_0x12bb8c)=>{const _0x66c6a7=_0x2a3a9a;if(validateAccess(_0x12bb8c,_0x3f715b)[_0x66c6a7(0x2fb)])confirmMessage(_0x255f46);else logger[_0x66c6a7(0x261)](_0x66c6a7(0x232));}),_0x1dff8e['on'](_0x2a3a9a(0x187),_0x21d45a=>{const _0xc2b00c=_0x2a3a9a;if(validateAccess(_0x21d45a,_0x3f715b)[_0xc2b00c(0x2fb)]){if(devices[_0x3f715b][_0xc2b00c(0x213)])clearTimeout(devices[_0x3f715b][_0xc2b00c(0x213)]);if(devices[_0x3f715b][_0xc2b00c(0x254)])clearTimeout(devices[_0x3f715b]['pidExpireLogin']);removeSocketListeners(getClient(_0x1dff8e['id'])[_0xc2b00c(0x302)]),addBlacklist(_0x3f715b),devices[_0x3f715b][_0xc2b00c(0x26b)]=null,devices[_0x3f715b][_0xc2b00c(0x20a)]=null,devices[_0x3f715b][_0xc2b00c(0x225)][_0xc2b00c(0x15d)]=null,logger['debug'](_0xc2b00c(0x243)+_0x3f715b[_0xc2b00c(0x16a)](-0x8)),io['to'](getClient(_0x1dff8e['id'])[_0xc2b00c(0x302)])[_0xc2b00c(0x1e4)]('status',{'access':{'allow':![],'reason':_0xc2b00c(0x2a7),'token':null}});}else logger[_0xc2b00c(0x261)](_0xc2b00c(0x2e7));});}function removeSocketListeners(_0x4af326){const _0x5035d9=_0x59775d;getClientsWithUuid(_0x4af326)[_0x5035d9(0x22f)](_0x3ee968=>{const _0x290f94=_0x5035d9;getSocket(_0x3ee968['id'])[_0x290f94(0x1f0)]();});}function cleanSettings(){const _0x3a45c3=_0x59775d;let _0x1e31c2=settings;return settings['telegramToken']&&settings[_0x3a45c3(0x1a7)]!=''&&(_0x1e31c2={..._0x1e31c2,'telegramToken':_0x3a45c3(0x163)}),settings['bbPassword']&&settings[_0x3a45c3(0x290)]!=''&&(_0x1e31c2={..._0x1e31c2,'bbPassword':'************'}),(settings[_0x3a45c3(0x290)]&&settings[_0x3a45c3(0x290)]==_0x3a45c3(0x1cb)||settings[_0x3a45c3(0x1a7)]&&settings[_0x3a45c3(0x1a7)]==_0x3a45c3(0x1cb))&&(_0x1e31c2={..._0x1e31c2,'restored':{'password':settings[_0x3a45c3(0x290)]==_0x3a45c3(0x1cb),'telegram':settings[_0x3a45c3(0x1a7)]==_0x3a45c3(0x1cb)}}),_0x1e31c2;}async function updateBB(_0x2c44af){const _0xe30ca=_0x59775d;await backupConfigFiles(),installingUpdate=!![],config[_0xe30ca(0x22f)](_0x8e53b7=>{const _0x31438e=_0xe30ca;restartBot(_0x8e53b7[_0x31438e(0x182)]);});if(_0x2c44af==_0xe30ca(0x2aa))process[_0xe30ca(0x259)]({'update':!![],'environment':environment},_0x48613b=>{});else _0x2c44af=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x37a9f2=>{});}function startBot(_0x911968,_0x2e4142,_0x23a83c){const _0x15bf68=_0x59775d;if(debugging)_0x911968[_0x15bf68(0x21e)]('-d');let _0x60d93a=![];const _0x2bbb48=_0x911968[0x0];_0x2e4142={..._0x2e4142,'stdio':[_0x15bf68(0x234),_0x15bf68(0x234),'inherit','ipc']},pid[_0x2bbb48]=childProcess[_0x15bf68(0x272)](botfile,_0x911968,_0x2e4142),pid[_0x2bbb48]['on'](_0x15bf68(0x208),_0x3240cd=>{const _0x52d1f7=_0x15bf68;switch(Object[_0x52d1f7(0x29f)](_0x3240cd)[0x0]){case'botname':updateBotName(_0x2bbb48,_0x3240cd[_0x52d1f7(0x2bf)]);break;case _0x52d1f7(0x180):updateBotManager();break;case _0x52d1f7(0x299):updateStatus(_0x2bbb48,_0x3240cd[_0x52d1f7(0x299)]);break;case'live':updateLive(_0x2bbb48,_0x3240cd[_0x52d1f7(0x311)]);break;case _0x52d1f7(0x1da):updateLive(_0x2bbb48,_0x3240cd[_0x52d1f7(0x1da)]),io['to'](_0x2bbb48)[_0x52d1f7(0x1e4)](_0x52d1f7(0x299),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x52d1f7(0x1c3):_0x3240cd[_0x52d1f7(0x1c3)]=='restart'&&restartBot(_0x2bbb48);_0x3240cd[_0x52d1f7(0x1c3)]==_0x52d1f7(0x2ac)&&toggleBot(_0x2bbb48,_0x52d1f7(0x315),'stopped');break;case'telegram':sendTelegram(_0x2bbb48,_0x3240cd['telegram']);break;case _0x52d1f7(0x320):sendTelegramMsg(_0x3240cd[_0x52d1f7(0x320)]);break;case _0x52d1f7(0x29c):io['to'](_0x2bbb48)['emit'](_0x3240cd[_0x52d1f7(0x29c)],_0x3240cd[_0x52d1f7(0x1db)]);break;}}),pid[_0x2bbb48]['on'](_0x15bf68(0x2ce),function(_0x752a7f){if(_0x60d93a)return;_0x60d93a=!![],_0x23a83c(_0x752a7f);}),pid[_0x2bbb48]['on'](_0x15bf68(0x2c7),async function(_0x4eb93c){const _0x12c46b=_0x15bf68;if(installingUpdate)return;if(_0x60d93a)return;_0x60d93a=!![],_0x23a83c(null);const _0x5ea047=dbConfig['get'](_0x12c46b(0x24b))[_0x12c46b(0x1e0)]({'botID':_0x2bbb48})[_0x12c46b(0x249)]();_0x5ea047&&(_0x5ea047['status']==_0x12c46b(0x24e)||_0x5ea047[_0x12c46b(0x299)]==_0x12c46b(0x1e8))&&(await sleep(0x3e8),updateLive(_0x2bbb48,'stopped'),logger['full'](_0x12c46b(0x159)+_0x2bbb48),startBot([_0x2bbb48,userID],{'cwd':bbpath},function(_0xf786ee){const _0x430dfb=_0x12c46b;if(_0xf786ee)logger[_0x430dfb(0x261)](_0xf786ee);}));});}function stopBot(_0x2d569c){const _0x396bd1=_0x59775d;getClientsWithBotID(_0x2d569c)[_0x396bd1(0x22f)](_0x478454=>{const _0xc93596=_0x396bd1;getSocket(_0x478454['id'])[_0xc93596(0x231)](!![]),removeClient(_0x478454['id']);}),pid[_0x2d569c]&&(pid[_0x2d569c]['kill'](),pid[_0x2d569c]=null);}function restartBot(_0x21fc4d){if(pid[_0x21fc4d])pid[_0x21fc4d]['kill']();}function addBot(){const _0x2eaa61=_0x59775d;let _0x24cab3;for(let _0x514107=0x1;_0x514107<0x3e9;_0x514107++){_0x24cab3=_0x514107[_0x2eaa61(0x30d)]()[_0x2eaa61(0x233)](0x3,'0');let _0x2ececa=config[_0x2eaa61(0x1e0)](_0x493f91=>_0x493f91['botID']==_0x24cab3);if(!_0x2ececa)break;}if(_0x24cab3===_0x2eaa61(0x2f6)){logger[_0x2eaa61(0x261)](_0x2eaa61(0x20c));return;}logger['full'](_0x2eaa61(0x258)+_0x24cab3),dbConfig[_0x2eaa61(0x2d4)](_0x2eaa61(0x24b))['push']({'botID':_0x24cab3,'botname':_0x2eaa61(0x239)+_0x24cab3,'status':'new','live':''})[_0x2eaa61(0x1af)](),startBot([_0x24cab3,userID],{'cwd':bbpath},function(_0x4dc7e0){const _0x37226d=_0x2eaa61;if(_0x4dc7e0)logger[_0x37226d(0x261)](_0x4dc7e0);}),config=getConfiguration(),io['to'](_0x2eaa61(0x1d8))[_0x2eaa61(0x1e4)](_0x2eaa61(0x24b),config),broadcastToBots(_0x2eaa61(0x24b),JSON['stringify'](config));}function deleteBot(_0x296d36){const _0x523d9a=_0x59775d;getClientsWithBotID(_0x296d36)[_0x523d9a(0x22f)](_0x1d2cc0=>{const _0x12a845=_0x523d9a;getSocket(_0x1d2cc0['id'])[_0x12a845(0x231)](!![]),removeClient(_0x1d2cc0['id']);}),dbConfig[_0x523d9a(0x2d4)](_0x523d9a(0x24b))[_0x523d9a(0x2e4)]({'botID':_0x296d36})['write'](),logger[_0x523d9a(0x261)](_0x523d9a(0x2cb)+_0x296d36),stopBot(_0x296d36);try{if(fs[_0x523d9a(0x167)](path[_0x523d9a(0x2a1)](configpath,'bot-'+_0x296d36+_0x523d9a(0x280))))fs[_0x523d9a(0x1b9)](path[_0x523d9a(0x2a1)](configpath,_0x523d9a(0x313)+_0x296d36+_0x523d9a(0x280)));if(fs[_0x523d9a(0x167)](path['join'](configpath,'bot-'+_0x296d36+_0x523d9a(0x265))))fs['unlinkSync'](path[_0x523d9a(0x2a1)](configpath,_0x523d9a(0x313)+_0x296d36+_0x523d9a(0x265)));if(fs[_0x523d9a(0x167)](path[_0x523d9a(0x2a1)](configpath,_0x523d9a(0x313)+_0x296d36+_0x523d9a(0x2f8))))fs[_0x523d9a(0x1b9)](path[_0x523d9a(0x2a1)](configpath,_0x523d9a(0x313)+_0x296d36+_0x523d9a(0x2f8)));if(fs['existsSync'](path[_0x523d9a(0x2a1)](configpath,_0x523d9a(0x313)+_0x296d36+_0x523d9a(0x2cc))))fs[_0x523d9a(0x1b9)](path[_0x523d9a(0x2a1)](configpath,_0x523d9a(0x313)+_0x296d36+_0x523d9a(0x2cc)));}catch(_0x52ad3f){if(_0x52ad3f)logger[_0x523d9a(0x261)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x52ad3f);}config=getConfiguration(),io['to'](_0x523d9a(0x1d8))[_0x523d9a(0x1e4)](_0x523d9a(0x24b),config),broadcastToBots('bots',JSON[_0x523d9a(0x2fe)](config));}function toggleBot(_0x262201,_0x227acd,_0xa87a62){const _0x1e412f=_0x59775d;dbConfig[_0x1e412f(0x2d4)](_0x1e412f(0x24b))[_0x1e412f(0x1e0)]({'botID':_0x262201})[_0x1e412f(0x304)]({'status':_0x227acd})[_0x1e412f(0x304)]({'live':_0xa87a62})[_0x1e412f(0x1af)]();if(_0x227acd==_0x1e412f(0x24e)||_0x227acd==_0x1e412f(0x1e8))logger[_0x1e412f(0x261)]('Enabled\x20Bot\x20'+_0x262201),startBot([_0x262201,userID],{'cwd':bbpath},function(_0x336aef){const _0x2c140e=_0x1e412f;if(_0x336aef)logger[_0x2c140e(0x261)](_0x336aef);});else(_0x227acd==_0x1e412f(0x315)||_0x227acd=='new-disabled')&&(logger['full']('Disabled\x20Bot\x20'+_0x262201),stopBot(_0x262201));config=getConfiguration(),io['to']('botmanager')[_0x1e412f(0x1e4)](_0x1e412f(0x24b),config),broadcastToBots(_0x1e412f(0x24b),JSON[_0x1e412f(0x2fe)](config));}function toggleStatus(_0x34cc0c){const _0x4cdcca=_0x59775d;let _0x5c0d33=dbConfig[_0x4cdcca(0x2d4)](_0x4cdcca(0x24b))[_0x4cdcca(0x1e0)]({'botID':_0x34cc0c})['value'](),_0x5240d5;if(_0x5c0d33[_0x4cdcca(0x299)]==='enabled')_0x5240d5='disabled';else{if(_0x5c0d33['status']===_0x4cdcca(0x1e8))_0x5240d5=_0x4cdcca(0x228);else{if(_0x5c0d33['status']===_0x4cdcca(0x228))_0x5240d5=_0x4cdcca(0x1e8);else{if(_0x5c0d33[_0x4cdcca(0x299)]===_0x4cdcca(0x315))_0x5240d5='enabled';}}}return _0x5240d5;}function updateStatus(_0x5dfaca,_0x22878f){const _0x4ef58f=_0x59775d;dbConfig[_0x4ef58f(0x2d4)](_0x4ef58f(0x24b))[_0x4ef58f(0x1e0)]({'botID':_0x5dfaca})[_0x4ef58f(0x304)]({'status':_0x22878f})['write'](),config=getConfiguration(),io['to'](_0x4ef58f(0x1d8))['emit'](_0x4ef58f(0x24b),config),broadcastToBots('bots',JSON[_0x4ef58f(0x2fe)](config));}function updateLive(_0x546500,_0x2dcdf0){const _0x2d67c4=_0x59775d;dbConfig['get'](_0x2d67c4(0x24b))['find']({'botID':_0x546500})[_0x2d67c4(0x304)]({'live':_0x2dcdf0})[_0x2d67c4(0x1af)](),config=getConfiguration(),io['to']('botmanager')[_0x2d67c4(0x1e4)]('bots',config),broadcastToBots(_0x2d67c4(0x24b),JSON['stringify'](config));}function updateBotName(_0x4e9dab,_0x1be659){const _0x2f5ee8=_0x59775d;dbConfig[_0x2f5ee8(0x2d4)]('bots')[_0x2f5ee8(0x1e0)]({'botID':_0x4e9dab})[_0x2f5ee8(0x304)]({'botname':_0x1be659})[_0x2f5ee8(0x1af)](),config=getConfiguration(),io['to'](_0x2f5ee8(0x1d8))[_0x2f5ee8(0x1e4)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x3a114e=_0x59775d;config=getConfiguration(),io['to'](_0x3a114e(0x1d8))['emit'](_0x3a114e(0x24b),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x5acaf7){const _0xde1de6=_0x59775d;if(pid[_0x5acaf7])pid[_0x5acaf7][_0xde1de6(0x259)]({'function':_0xde1de6(0x1e3),'args':null});else{const _0x5e5603=configpath+_0xde1de6(0x313)+_0x5acaf7+'-config.json',_0x3c6824=fs[_0xde1de6(0x30f)](_0x5e5603),_0x89830f=JSON[_0xde1de6(0x1ab)](_0x3c6824),_0x1dc607=_0x89830f[_0xde1de6(0x1bf)][0x0]['headless'];_0x89830f[_0xde1de6(0x1bf)][0x0][_0xde1de6(0x186)]=!_0x1dc607;const _0x196b8f=JSON[_0xde1de6(0x2fe)](_0x89830f,null,0x2);fs[_0xde1de6(0x2d3)](_0x5e5603,_0x196b8f),config=getConfiguration(),io['to'](_0xde1de6(0x1d8))[_0xde1de6(0x1e4)](_0xde1de6(0x24b),config),broadcastToBots('bots',JSON[_0xde1de6(0x2fe)](config));}}function telegramError(_0x2f1085){const _0x3bb6ce=_0x59775d;logger[_0x3bb6ce(0x310)](getTimeStamp()+_0x3bb6ce(0x2d8));}function validateTelegram(_0x4e2a81){const _0xf23673=_0x59775d;if(_0x4e2a81[_0xf23673(0x2cf)][_0xf23673(0x31a)]!=settings[_0xf23673(0x215)]&&'@'+_0x4e2a81['from'][_0xf23673(0x31a)]!=settings[_0xf23673(0x215)])return tgBot[_0xf23673(0x292)](_0x4e2a81[_0xf23673(0x179)]['id'],_0xf23673(0x183),{'parse_mode':_0xf23673(0x1f4)})[_0xf23673(0x2b9)](_0x35df6e=>{telegramError(_0x35df6e);}),![];return!![];}async function initTelegram(){const _0x40833a=_0x59775d;if(tgBot)tgBot[_0x40833a(0x285)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x40833a(0x1a7)],{'polling':!![]});let _0x2388a3=_0x40833a(0x2e1);_0x2388a3+='\x0a',_0x2388a3+=_0x40833a(0x27a),_0x2388a3+=_0x40833a(0x1a8),_0x2388a3+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x2388a3+=_0x40833a(0x1ba),_0x2388a3+=_0x40833a(0x253),_0x2388a3+=_0x40833a(0x25c),_0x2388a3+=_0x40833a(0x1a0),_0x2388a3+=_0x40833a(0x176),_0x2388a3+=_0x40833a(0x2e9),_0x2388a3+=_0x40833a(0x22b),_0x2388a3+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x2388a3+=_0x40833a(0x29a),_0x2388a3+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x2388a3+=_0x40833a(0x244);let _0x444e30=_0x40833a(0x28d);_0x444e30+='\x0a',_0x444e30+=_0x2388a3,tgBot[_0x40833a(0x24c)](/\/start/,_0x3904df=>{const _0x2d6206=_0x40833a;if(!validateTelegram(_0x3904df))return;if(settings[_0x2d6206(0x2d7)]!=_0x3904df['chat']['id'])updateSetting(_0x2d6206(0x2d7),_0x3904df[_0x2d6206(0x179)]['id']);updateSetting(_0x2d6206(0x1cc),!![]),tgBot[_0x2d6206(0x292)](_0x3904df[_0x2d6206(0x179)]['id'],_0x444e30)[_0x2d6206(0x2b9)](_0x3e6e69=>{telegramError(_0x3e6e69);});}),tgBot['onText'](/\/enable/,_0x32c6c7=>{const _0x1d7132=_0x40833a;if(!validateTelegram(_0x32c6c7))return;if(settings[_0x1d7132(0x2d7)]!=_0x32c6c7[_0x1d7132(0x179)]['id'])updateSetting(_0x1d7132(0x2d7),_0x32c6c7[_0x1d7132(0x179)]['id']);updateSetting(_0x1d7132(0x1cc),!![]),tgBot['sendMessage'](_0x32c6c7['chat']['id'],_0x1d7132(0x237))[_0x1d7132(0x2b9)](_0x358ee6=>{telegramError(_0x358ee6);});}),tgBot[_0x40833a(0x24c)](/\/config/,async _0x2ae24c=>{const _0x49b889=_0x40833a;if(!validateTelegram(_0x2ae24c))return;tgBot[_0x49b889(0x1c1)](_0x49b889(0x31f)),tgBot[_0x49b889(0x292)](_0x2ae24c['chat']['id'],_0x49b889(0x32a),{'reply_markup':{'inline_keyboard':[[{'text':_0x49b889(0x158),'callback_data':'orders'},{'text':_0x49b889(0x274),'callback_data':'alerts'},{'text':'All','callback_data':_0x49b889(0x1ca)}]]}})[_0x49b889(0x2b9)](_0x3e2123=>{telegramError(_0x3e2123);}),tgBot['on'](_0x49b889(0x31f),async _0x497bcd=>{const _0x5791f5=_0x49b889,_0x162180=_0x497bcd['data'],_0x3701dd=_0x497bcd[_0x5791f5(0x208)];tgBot[_0x5791f5(0x18c)](_0x497bcd['id'])[_0x5791f5(0x2dd)](async()=>{const _0x20a67f=_0x5791f5;_0x162180==_0x20a67f(0x1d7)&&(updateSetting('telegramEvents','orders'),updateSetting(_0x20a67f(0x1cc),!![]),await tgBot['sendMessage'](_0x3701dd[_0x20a67f(0x179)]['id'],_0x20a67f(0x161))[_0x20a67f(0x2b9)](_0x347e29=>{telegramError(_0x347e29);}));_0x162180==_0x20a67f(0x255)&&(updateSetting(_0x20a67f(0x2da),'alerts'),updateSetting(_0x20a67f(0x1cc),!![]),await tgBot[_0x20a67f(0x292)](_0x3701dd[_0x20a67f(0x179)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x20a67f(0x2b9)](_0x33f183=>{telegramError(_0x33f183);}));_0x162180==_0x20a67f(0x1ca)&&(updateSetting(_0x20a67f(0x2da),_0x20a67f(0x1ca)),updateSetting(_0x20a67f(0x1cc),!![]),await tgBot[_0x20a67f(0x292)](_0x3701dd[_0x20a67f(0x179)]['id'],_0x20a67f(0x2b3))[_0x20a67f(0x2b9)](_0x8fa577=>{telegramError(_0x8fa577);}));if(!settings[_0x20a67f(0x2d7)])tgBot[_0x20a67f(0x292)](_0x3701dd[_0x20a67f(0x179)]['id'],_0x20a67f(0x2a4))[_0x20a67f(0x2b9)](_0x231794=>{telegramError(_0x231794);});}),tgBot[_0x5791f5(0x1c1)]('callback_query');});}),tgBot[_0x40833a(0x24c)](/\/status/,_0x121458=>{const _0x6dcd5f=_0x40833a;if(!validateTelegram(_0x121458))return;const _0x3062fc=getBotsWithMode();let _0x527db9=_0x6dcd5f(0x17d);config[_0x6dcd5f(0x22f)](_0x4554f6=>{const _0x5f074d=_0x6dcd5f,_0x7de1fe=_0x3062fc[_0x5f074d(0x1e0)](_0x12df44=>_0x12df44[_0x5f074d(0x182)]==_0x4554f6[_0x5f074d(0x182)])['mode'];_0x527db9+=_0x5f074d(0x239)+_0x4554f6[_0x5f074d(0x182)]+':\x20'+_0x4554f6[_0x5f074d(0x299)]+_0x5f074d(0x18a)+_0x7de1fe+_0x5f074d(0x18a)+_0x4554f6['live']+'\x0a';}),_0x527db9+='\x0a',_0x527db9+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x527db9+=!settings[_0x6dcd5f(0x1cc)]?_0x6dcd5f(0x24f):'Notifications\x20enabled\x0a',_0x527db9+=settings[_0x6dcd5f(0x1cc)]?settings[_0x6dcd5f(0x2da)]==_0x6dcd5f(0x1ca)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x6dcd5f(0x2da)]+_0x6dcd5f(0x1b0):'',tgBot[_0x6dcd5f(0x292)](_0x121458[_0x6dcd5f(0x179)]['id'],_0x527db9,{'parse_mode':_0x6dcd5f(0x1f4)})[_0x6dcd5f(0x2b9)](_0x324386=>{telegramError(_0x324386);});}),tgBot['onText'](/\/restart/,_0x355d5a=>{const _0x5d64a8=_0x40833a;if(!validateTelegram(_0x355d5a))return;tgBot[_0x5d64a8(0x1c1)](_0x5d64a8(0x31f));const _0x32c12f=getEnabledBots();if(_0x32c12f[_0x5d64a8(0x323)]==0x0)tgBot['sendMessage'](_0x355d5a[_0x5d64a8(0x179)]['id'],_0x5d64a8(0x1d2))[_0x5d64a8(0x2b9)](_0x3afbc9=>{telegramError(_0x3afbc9);});else{if(_0x32c12f['length']>0x1)_0x32c12f[_0x5d64a8(0x21e)]({'botID':_0x5d64a8(0x1ca)});let _0x23f45e=[],_0x3a1828=[];const _0x2bf269=_0x32c12f['length']%0x4==0x0||_0x32c12f[_0x5d64a8(0x323)]%0x4==0x3||_0x32c12f[_0x5d64a8(0x323)]%0x3==0x1?0x4:0x3;let _0x374e78=0x0;_0x32c12f[_0x5d64a8(0x22f)]((_0x52f18c,_0x3492cf)=>{const _0x2e6f99=_0x5d64a8;if(_0x3492cf%_0x2bf269==0x0)_0x3a1828=[];_0x3a1828[_0x2e6f99(0x21e)]({'text':_0x52f18c[_0x2e6f99(0x182)]==_0x2e6f99(0x1ca)?_0x2e6f99(0x27c):'Bot\x20'+_0x52f18c[_0x2e6f99(0x182)],'callback_data':_0x52f18c[_0x2e6f99(0x182)]}),_0x3492cf%_0x2bf269==0x0&&(_0x23f45e[_0x374e78]=_0x3a1828,_0x374e78++);}),tgBot[_0x5d64a8(0x292)](_0x355d5a['chat']['id'],_0x5d64a8(0x22a),{'reply_markup':{'inline_keyboard':_0x23f45e}})['catch'](_0x1feb52=>{telegramError(_0x1feb52);}),tgBot['on']('callback_query',async _0x271b85=>{const _0xc8c360=_0x5d64a8,_0x3ca060=_0x271b85[_0xc8c360(0x2f3)],_0x3b51ea=_0x271b85[_0xc8c360(0x208)];tgBot['answerCallbackQuery'](_0x271b85['id'])[_0xc8c360(0x2dd)](async()=>{const _0x64efa7=_0xc8c360;_0x3ca060==_0x64efa7(0x1ca)?config[_0x64efa7(0x22f)](_0x2ebdd2=>{const _0x3cc641=_0x64efa7;restartBot(_0x2ebdd2[_0x3cc641(0x182)]);}):restartBot(_0x3ca060);}),tgBot[_0xc8c360(0x1c1)](_0xc8c360(0x31f));});}}),tgBot['onText'](/\/on/,_0x12511c=>{const _0x18448c=_0x40833a;if(!validateTelegram(_0x12511c))return;tgBot[_0x18448c(0x1c1)](_0x18448c(0x31f));const _0x2be6d0=getDisabledBots();if(_0x2be6d0[_0x18448c(0x323)]==0x0)tgBot[_0x18448c(0x292)](_0x12511c[_0x18448c(0x179)]['id'],_0x18448c(0x27b))['catch'](_0x5b9156=>{telegramError(_0x5b9156);});else{if(_0x2be6d0[_0x18448c(0x323)]>0x1)_0x2be6d0[_0x18448c(0x21e)]({'botID':_0x18448c(0x1ca)});let _0x373d7e=[],_0xf08bb=[];const _0x5cdb11=_0x2be6d0[_0x18448c(0x323)]%0x4==0x0||_0x2be6d0[_0x18448c(0x323)]%0x4==0x3||_0x2be6d0[_0x18448c(0x323)]%0x3==0x1?0x4:0x3;let _0x1a130b=0x0;_0x2be6d0['forEach']((_0x567d3e,_0x57d883)=>{const _0x1b82de=_0x18448c;if(_0x57d883%_0x5cdb11==0x0)_0xf08bb=[];_0xf08bb['push']({'text':_0x567d3e['botID']==_0x1b82de(0x1ca)?_0x1b82de(0x27c):_0x1b82de(0x239)+_0x567d3e['botID'],'callback_data':_0x567d3e[_0x1b82de(0x182)]}),_0x57d883%_0x5cdb11==0x0&&(_0x373d7e[_0x1a130b]=_0xf08bb,_0x1a130b++);}),tgBot['sendMessage'](_0x12511c[_0x18448c(0x179)]['id'],_0x18448c(0x2c9),{'reply_markup':{'inline_keyboard':_0x373d7e}})[_0x18448c(0x2b9)](_0x2193fa=>{telegramError(_0x2193fa);}),tgBot['on']('callback_query',async _0x18c072=>{const _0x2b99ef=_0x18448c,_0xbc05dc=_0x18c072[_0x2b99ef(0x2f3)],_0x1dfa4f=_0x18c072['message'];tgBot[_0x2b99ef(0x18c)](_0x18c072['id'])['then'](async()=>{const _0x12a27a=_0x2b99ef;_0xbc05dc==_0x12a27a(0x1ca)?(tgBot['sendMessage'](_0x1dfa4f['chat']['id'],_0x12a27a(0x194))[_0x12a27a(0x2b9)](_0x2cb47b=>{telegramError(_0x2cb47b);}),_0x2be6d0['forEach'](_0x29e681=>{const _0x32b0dc=_0x12a27a;if(_0x29e681['botID']!=_0x32b0dc(0x1ca))toggleBot(_0x29e681['botID'],toggleStatus(_0x29e681[_0x32b0dc(0x182)]),_0x32b0dc(0x314));})):(tgBot[_0x12a27a(0x292)](_0x1dfa4f[_0x12a27a(0x179)]['id'],_0x12a27a(0x20e)+_0xbc05dc)[_0x12a27a(0x2b9)](_0x1dfa6a=>{telegramError(_0x1dfa6a);}),toggleBot(_0xbc05dc,toggleStatus(_0xbc05dc),_0x12a27a(0x314)));}),tgBot['removeListener'](_0x2b99ef(0x31f));});}}),tgBot['onText'](/\/off/,_0x4d3248=>{const _0x4b15f3=_0x40833a;if(!validateTelegram(_0x4d3248))return;tgBot[_0x4b15f3(0x1c1)](_0x4b15f3(0x31f));const _0x28b36b=getEnabledBots();if(_0x28b36b[_0x4b15f3(0x323)]==0x0)tgBot[_0x4b15f3(0x292)](_0x4d3248[_0x4b15f3(0x179)]['id'],_0x4b15f3(0x1d2))[_0x4b15f3(0x2b9)](_0xafd069=>{telegramError(_0xafd069);});else{if(_0x28b36b[_0x4b15f3(0x323)]>0x1)_0x28b36b[_0x4b15f3(0x21e)]({'botID':'all'});let _0x1376ac=[],_0x1009d3=[];const _0x3a8170=_0x28b36b['length']%0x4==0x0||_0x28b36b[_0x4b15f3(0x323)]%0x4==0x3||_0x28b36b[_0x4b15f3(0x323)]%0x3==0x1?0x4:0x3;let _0xa310d2=0x0;_0x28b36b[_0x4b15f3(0x22f)]((_0x5e30af,_0x240d95)=>{const _0x1f922f=_0x4b15f3;if(_0x240d95%_0x3a8170==0x0)_0x1009d3=[];_0x1009d3['push']({'text':_0x5e30af['botID']=='all'?_0x1f922f(0x27c):_0x1f922f(0x239)+_0x5e30af['botID'],'callback_data':_0x5e30af[_0x1f922f(0x182)]}),_0x240d95%_0x3a8170==0x0&&(_0x1376ac[_0xa310d2]=_0x1009d3,_0xa310d2++);}),tgBot['sendMessage'](_0x4d3248['chat']['id'],_0x4b15f3(0x2e3),{'reply_markup':{'inline_keyboard':_0x1376ac}})[_0x4b15f3(0x2b9)](_0x58d601=>{telegramError(_0x58d601);}),tgBot['on'](_0x4b15f3(0x31f),async _0x3a9f1e=>{const _0x22b803=_0x4b15f3,_0x284b2a=_0x3a9f1e[_0x22b803(0x2f3)],_0x5442f9=_0x3a9f1e[_0x22b803(0x208)];tgBot[_0x22b803(0x18c)](_0x3a9f1e['id'])[_0x22b803(0x2dd)](async()=>{const _0x4d6fd7=_0x22b803;_0x284b2a==_0x4d6fd7(0x1ca)?(tgBot[_0x4d6fd7(0x292)](_0x5442f9[_0x4d6fd7(0x179)]['id'],_0x4d6fd7(0x195))[_0x4d6fd7(0x2b9)](_0x3f8503=>{telegramError(_0x3f8503);}),_0x28b36b[_0x4d6fd7(0x22f)](_0x479a84=>{const _0x476dda=_0x4d6fd7;if(_0x479a84[_0x476dda(0x182)]!=_0x476dda(0x1ca))toggleBot(_0x479a84[_0x476dda(0x182)],toggleStatus(_0x479a84[_0x476dda(0x182)]),_0x476dda(0x314));})):(tgBot[_0x4d6fd7(0x292)](_0x5442f9['chat']['id'],_0x4d6fd7(0x1c9)+_0x284b2a)['catch'](_0xf8781b=>{telegramError(_0xf8781b);}),toggleBot(_0x284b2a,toggleStatus(_0x284b2a),_0x4d6fd7(0x314)));}),tgBot[_0x22b803(0x1c1)](_0x22b803(0x31f));});}}),tgBot[_0x40833a(0x24c)](/\/metrics/,_0x10406d=>{const _0x3e327a=_0x40833a;if(!validateTelegram(_0x10406d))return;tgBot['removeListener']('callback_query');const _0x171b63=getEnabledBots();if(_0x171b63[_0x3e327a(0x323)]==0x0)tgBot['sendMessage'](_0x10406d['chat']['id'],_0x3e327a(0x1d2))[_0x3e327a(0x2b9)](_0x859d2c=>{telegramError(_0x859d2c);});else{if(_0x171b63[_0x3e327a(0x323)]>0x1){let _0x34f2e8=[],_0x41652a=[];const _0x44e48a=_0x171b63['length']%0x4==0x0||_0x171b63[_0x3e327a(0x323)]%0x4==0x3||_0x171b63['length']%0x3==0x1?0x4:0x3;let _0x3e6700=0x0;_0x171b63[_0x3e327a(0x22f)]((_0x34cf73,_0x5205b1)=>{const _0x41062c=_0x3e327a;if(_0x5205b1%_0x44e48a==0x0)_0x41652a=[];_0x41652a[_0x41062c(0x21e)]({'text':_0x41062c(0x239)+_0x34cf73[_0x41062c(0x182)],'callback_data':_0x34cf73[_0x41062c(0x182)]}),_0x5205b1%_0x44e48a==0x0&&(_0x34f2e8[_0x3e6700]=_0x41652a,_0x3e6700++);}),tgBot['sendMessage'](_0x10406d['chat']['id'],_0x3e327a(0x29b),{'reply_markup':{'inline_keyboard':_0x34f2e8}})[_0x3e327a(0x2b9)](_0x204a3a=>{telegramError(_0x204a3a);}),tgBot['on'](_0x3e327a(0x31f),async _0x36008c=>{const _0x5c4f98=_0x3e327a,_0x3870f9=_0x36008c['data'],_0x5b570a=_0x36008c[_0x5c4f98(0x208)];tgBot[_0x5c4f98(0x18c)](_0x36008c['id'])[_0x5c4f98(0x2dd)](async()=>{const _0xfaf8e3=_0x5c4f98;if(pid[_0x3870f9])pid[_0x3870f9][_0xfaf8e3(0x259)]({'function':_0xfaf8e3(0x1ec),'args':null});}),tgBot[_0x5c4f98(0x1c1)]('callback_query');});}else{const _0x278ffd=_0x171b63[0x0][_0x3e327a(0x182)];if(pid[_0x278ffd])pid[_0x278ffd][_0x3e327a(0x259)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x40833a(0x24c)](/\/portfolio/,_0x7fa9e6=>{const _0x377a05=_0x40833a;if(!validateTelegram(_0x7fa9e6))return;tgBot['removeListener'](_0x377a05(0x31f));const _0x3c4e74=getEnabledBots();if(_0x3c4e74[_0x377a05(0x323)]==0x0)tgBot[_0x377a05(0x292)](_0x7fa9e6[_0x377a05(0x179)]['id'],_0x377a05(0x1d2))[_0x377a05(0x2b9)](_0x5c8451=>{telegramError(_0x5c8451);});else{if(_0x3c4e74[_0x377a05(0x323)]>0x1){let _0x592cda=[],_0xb41621=[];const _0x5ad33e=_0x3c4e74[_0x377a05(0x323)]%0x4==0x0||_0x3c4e74[_0x377a05(0x323)]%0x4==0x3||_0x3c4e74['length']%0x3==0x1?0x4:0x3;let _0xa3b0d8=0x0;_0x3c4e74[_0x377a05(0x22f)]((_0x2dccce,_0x1615dd)=>{const _0xabed19=_0x377a05;if(_0x1615dd%_0x5ad33e==0x0)_0xb41621=[];_0xb41621[_0xabed19(0x21e)]({'text':'Bot\x20'+_0x2dccce[_0xabed19(0x182)],'callback_data':_0x2dccce[_0xabed19(0x182)]}),_0x1615dd%_0x5ad33e==0x0&&(_0x592cda[_0xa3b0d8]=_0xb41621,_0xa3b0d8++);}),tgBot['sendMessage'](_0x7fa9e6[_0x377a05(0x179)]['id'],_0x377a05(0x216),{'reply_markup':{'inline_keyboard':_0x592cda}})[_0x377a05(0x2b9)](_0x520b82=>{telegramError(_0x520b82);}),tgBot['on'](_0x377a05(0x31f),async _0x271caf=>{const _0xed85a1=_0x377a05,_0x211335=_0x271caf[_0xed85a1(0x2f3)],_0x4a9285=_0x271caf[_0xed85a1(0x208)];tgBot['answerCallbackQuery'](_0x271caf['id'])[_0xed85a1(0x2dd)](async()=>{const _0x5eba7b=_0xed85a1;if(pid[_0x211335])pid[_0x211335][_0x5eba7b(0x259)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['removeListener'](_0xed85a1(0x31f));});}else{const _0x545240=_0x3c4e74[0x0]['botID'];if(pid[_0x545240])pid[_0x545240][_0x377a05(0x259)]({'function':_0x377a05(0x23d),'args':null});}}}),tgBot[_0x40833a(0x24c)](/\/update/,async _0x5c7ec0=>{const _0x366ee1=_0x40833a;if(!validateTelegram(_0x5c7ec0))return;tgBot['removeListener'](_0x366ee1(0x31f)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x5c7ec0[_0x366ee1(0x179)]['id'],_0x366ee1(0x281))[_0x366ee1(0x2b9)](_0x32be3f=>{telegramError(_0x32be3f);});else!validInstallation?tgBot[_0x366ee1(0x292)](_0x5c7ec0['chat']['id'],_0x366ee1(0x20d))[_0x366ee1(0x2b9)](_0x45be5a=>{telegramError(_0x45be5a);}):(tgBot['sendMessage'](_0x5c7ec0[_0x366ee1(0x179)]['id'],_0x366ee1(0x264),{'reply_markup':{'inline_keyboard':[[{'text':_0x366ee1(0x16d),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x366ee1(0x2b9)](_0x211c3c=>{telegramError(_0x211c3c);}),tgBot['on'](_0x366ee1(0x31f),async _0x4fd273=>{const _0x395bb5=_0x366ee1,_0xe8f1b7=_0x4fd273[_0x395bb5(0x2f3)],_0x461d29=_0x4fd273[_0x395bb5(0x208)];tgBot[_0x395bb5(0x18c)](_0x4fd273['id'])[_0x395bb5(0x2dd)](async()=>{const _0x25c37f=_0x395bb5;_0xe8f1b7==_0x25c37f(0x1aa)&&(await tgBot['sendMessage'](_0x461d29[_0x25c37f(0x179)]['id'],_0x25c37f(0x212))['catch'](_0x2d0087=>{telegramError(_0x2d0087);}),updateBB(_0x25c37f(0x2aa))),_0xe8f1b7=='no'&&await tgBot[_0x25c37f(0x292)](_0x461d29[_0x25c37f(0x179)]['id'],_0x25c37f(0x1d5))['catch'](_0x3b5e0f=>{telegramError(_0x3b5e0f);});}),tgBot[_0x395bb5(0x1c1)](_0x395bb5(0x31f));}));}),tgBot[_0x40833a(0x24c)](/\/reinstall/,async _0x363e30=>{const _0x463e0d=_0x40833a;if(!validateTelegram(_0x363e30))return;tgBot['removeListener'](_0x463e0d(0x31f)),!validInstallation?tgBot['sendMessage'](_0x363e30['chat']['id'],_0x463e0d(0x236))['catch'](_0xa3ff2=>{telegramError(_0xa3ff2);}):(tgBot[_0x463e0d(0x292)](_0x363e30[_0x463e0d(0x179)]['id'],_0x463e0d(0x1d9),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x463e0d(0x1aa)},{'text':'No','callback_data':'no'}]]}})[_0x463e0d(0x2b9)](_0x191914=>{telegramError(_0x191914);}),tgBot['on'](_0x463e0d(0x31f),async _0x570353=>{const _0x4e08bd=_0x463e0d,_0x1426d2=_0x570353[_0x4e08bd(0x2f3)],_0x42c187=_0x570353[_0x4e08bd(0x208)];tgBot['answerCallbackQuery'](_0x570353['id'])['then'](async()=>{const _0x1db41e=_0x4e08bd;_0x1426d2==_0x1db41e(0x1aa)&&(await tgBot[_0x1db41e(0x292)](_0x42c187[_0x1db41e(0x179)]['id'],_0x1db41e(0x201))[_0x1db41e(0x2b9)](_0x4dc269=>{telegramError(_0x4dc269);}),updateBB(_0x1db41e(0x21f))),_0x1426d2=='no'&&await tgBot['sendMessage'](_0x42c187[_0x1db41e(0x179)]['id'],_0x1db41e(0x203))[_0x1db41e(0x2b9)](_0x1b7d5b=>{telegramError(_0x1b7d5b);});}),tgBot['removeListener'](_0x4e08bd(0x31f));}));}),tgBot['onText'](/\/toggle/,_0x3a32ff=>{const _0x4ded8b=_0x40833a;if(!validateTelegram(_0x3a32ff))return;tgBot['removeListener']('callback_query');const _0x1de1dc=getBotsWithMode();if(_0x1de1dc[_0x4ded8b(0x323)]==0x0)tgBot[_0x4ded8b(0x292)](_0x3a32ff['chat']['id'],_0x4ded8b(0x1d2))['catch'](_0x122a40=>{telegramError(_0x122a40);});else{let _0x26fe4b=[],_0x65e80c=[];const _0x557af7=0x2;let _0x38ffe2=0x0;_0x1de1dc[_0x4ded8b(0x22f)]((_0x45b2c1,_0xa13196)=>{const _0x51b044=_0x4ded8b;if(_0xa13196%_0x557af7==0x0)_0x65e80c=[];_0x65e80c[_0x51b044(0x21e)]({'text':_0x51b044(0x239)+_0x45b2c1['botID']+'\x20('+_0x45b2c1[_0x51b044(0x16f)]+')','callback_data':_0x45b2c1[_0x51b044(0x182)]}),_0xa13196%_0x557af7==0x0&&(_0x26fe4b[_0x38ffe2]=_0x65e80c,_0x38ffe2++);}),tgBot[_0x4ded8b(0x292)](_0x3a32ff[_0x4ded8b(0x179)]['id'],_0x4ded8b(0x19b),{'reply_markup':{'inline_keyboard':_0x26fe4b}})['catch'](_0x20a0cd=>{telegramError(_0x20a0cd);}),tgBot['on'](_0x4ded8b(0x31f),async _0x3ba446=>{const _0x59bb58=_0x4ded8b,_0x569db1=_0x3ba446[_0x59bb58(0x2f3)],_0x3bfd47=_0x3ba446['message'];tgBot[_0x59bb58(0x18c)](_0x3ba446['id'])[_0x59bb58(0x2dd)](async()=>{const _0x5ede4a=_0x59bb58,_0x220af0=_0x1de1dc[_0x5ede4a(0x1e0)](_0x5df6d4=>_0x5df6d4['botID']==_0x569db1),_0x1a9b5f=_0x220af0[_0x5ede4a(0x16f)]==_0x5ede4a(0x18b)?_0x5ede4a(0x2e5):'auto';tgBot['sendMessage'](_0x3bfd47['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x569db1+_0x5ede4a(0x276)+_0x1a9b5f+_0x5ede4a(0x18d))[_0x5ede4a(0x2b9)](_0x3bbef9=>{telegramError(_0x3bbef9);}),toggleBotMode(_0x569db1);}),tgBot[_0x59bb58(0x1c1)](_0x59bb58(0x31f));});}}),tgBot['onText'](/\/names/,_0x4ea113=>{const _0x14f081=_0x40833a;if(!validateTelegram(_0x4ea113))return;let _0x161052='';config['forEach'](_0x129a41=>{const _0xb90f64=_0x36a4;_0x161052+='Bot\x20'+_0x129a41[_0xb90f64(0x182)]+':\x20'+_0x129a41[_0xb90f64(0x2bf)]+'\x0a';}),tgBot[_0x14f081(0x292)](_0x4ea113[_0x14f081(0x179)]['id'],_0x161052,{'parse_mode':'HTML'})['catch'](_0x2a6cb4=>{telegramError(_0x2a6cb4);});}),tgBot[_0x40833a(0x24c)](/\/disable/,_0x1eb520=>{if(!validateTelegram(_0x1eb520))return;tgBot['sendMessage'](_0x1eb520['chat']['id'],'Notifications\x20disabled')['catch'](_0x352b89=>{telegramError(_0x352b89);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x40833a(0x24c)](/\/help/,_0x5e138a=>{const _0x449aa6=_0x40833a;if(!validateTelegram(_0x5e138a))return;tgBot[_0x449aa6(0x292)](_0x5e138a[_0x449aa6(0x179)]['id'],_0x2388a3)[_0x449aa6(0x2b9)](_0x1f0aeb=>{telegramError(_0x1f0aeb);});}),tgBot['on'](_0x40833a(0x16e),_0x309049=>{const _0x1417b1=_0x40833a;_0x309049['toString']()[_0x1417b1(0x1e1)]('404\x20Not\x20Found')&&(logger['full'](_0x1417b1(0x2d5)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x1417b1(0x1e4)](_0x1417b1(0x1b7),_0x1417b1(0x2d5)));}),process[_0x40833a(0x2fd)]('SIGINT',()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x40833a(0x2fd)](_0x40833a(0x28c),()=>{const _0x1f15bc=_0x40833a;if(tgBot)tgBot[_0x1f15bc(0x285)]();process[_0x1f15bc(0x2c7)](0x1);});}}function disableTelegram(){const _0x3d5aa7=_0x59775d;tgBot&&(tgBot[_0x3d5aa7(0x285)](),tgBot=null);}function sendTelegram(_0x6ad896,_0x14a330){const _0x2844cf=_0x59775d;if(settings[_0x2844cf(0x1cc)]){if(settings['telegramEvents']==_0x2844cf(0x1ca)||(_0x14a330[_0x2844cf(0x2d2)]==_0x2844cf(0x2ce)||_0x14a330['type']==_0x2844cf(0x263)||_0x14a330[_0x2844cf(0x2d2)]==_0x2844cf(0x269))&&settings[_0x2844cf(0x2da)]=='alerts'||_0x14a330[_0x2844cf(0x2d2)]==_0x2844cf(0x181)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x2844cf(0x2d7)]){if(_0x14a330[_0x2844cf(0x204)])tgBot['sendMessage'](settings[_0x2844cf(0x2d7)],_0x14a330[_0x2844cf(0x2bf)]+_0x2844cf(0x1bb)+_0x14a330[_0x2844cf(0x2f7)])[_0x2844cf(0x2b9)](_0x3864b4=>{telegramError(_0x3864b4);});else tgBot[_0x2844cf(0x292)](settings[_0x2844cf(0x2d7)],_0x2844cf(0x239)+_0x6ad896+_0x2844cf(0x1bb)+_0x14a330[_0x2844cf(0x2f7)])[_0x2844cf(0x2b9)](_0x2def01=>{telegramError(_0x2def01);});}}}}async function sendTelegramMsg(_0xcad689,_0x13e8d5=_0x59775d(0x1f4)){const _0x5496fc=_0x59775d;return settings[_0x5496fc(0x1cc)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x5496fc(0x292)](settings[_0x5496fc(0x2d7)],_0xcad689,{'parse_mode':_0x13e8d5})['catch'](_0x4fadb1=>{telegramError(_0x4fadb1);}),!![]):![];}function getDeviceWithIp(_0xf667b){const _0x3413ef=_0x59775d;return devices[_0x3413ef(0x1e0)](_0x143ab2=>_0x143ab2['ip']===_0xf667b);}function temporaryAccess2FA(_0x11f080,_0x102b41){const _0x16b4db=_0x59775d;let _0x215437=new Date(),_0x1bdb1a=![];if(lastIpApproval){if(_0x215437-lastIpApproval<0x1388)_0x1bdb1a=!![];}lastIpApproval=new Date();if(_0x1bdb1a)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x16b4db(0x292)](settings[_0x16b4db(0x2d7)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x102b41)['show']+_0x16b4db(0x1c4),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x16b4db(0x321),'callback_data':'5'},{'text':_0x16b4db(0x2ed),'callback_data':'15'},{'text':_0x16b4db(0x168),'callback_data':'30'},{'text':_0x16b4db(0x267),'callback_data':_0x16b4db(0x267)}]]}})[_0x16b4db(0x2b9)](_0x2b3037=>{telegramError(_0x2b3037);}),tgBot['on'](_0x16b4db(0x31f),async _0x2bb043=>{const _0x214e3f=_0x16b4db,_0xb35d99=_0x2bb043['data'],_0x20a4d3=_0x2bb043[_0x214e3f(0x208)];tgBot[_0x214e3f(0x18c)](_0x2bb043['id'])[_0x214e3f(0x2dd)](async()=>{const _0x31ea5a=_0x214e3f;devices[_0x11f080][_0x31ea5a(0x26b)]={'clientip':_0x102b41,'timestamp':new Date()[_0x31ea5a(0x1c8)](),'expiry':_0xb35d99},_0xb35d99!='reject'?(await tgBot['sendMessage'](_0x20a4d3['chat']['id'],'Access\x20enabled\x20for\x20'+_0xb35d99+'\x20minutes',{'parse_mode':_0x31ea5a(0x1f4)})[_0x31ea5a(0x2b9)](_0x1e1f9e=>{telegramError(_0x1e1f9e);}),io['to'](_0x11f080)[_0x31ea5a(0x1e4)](_0x31ea5a(0x299),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x31ea5a(0x292)](_0x20a4d3[_0x31ea5a(0x179)]['id'],_0x31ea5a(0x174))['catch'](_0x4a483a=>{telegramError(_0x4a483a);}),io['to'](_0x11f080)[_0x31ea5a(0x1e4)](_0x31ea5a(0x299),{'access':{'allow':![],'reason':_0x31ea5a(0x188),'token':null}}));}),tgBot[_0x214e3f(0x1c1)](_0x214e3f(0x31f));}));}function loginAccess2FA(_0x164bc2,_0x14920c){const _0x1beb4f=_0x59775d;tgBot&&settings[_0x1beb4f(0x2d7)]&&(tgBot[_0x1beb4f(0x1c1)]('callback_query'),tgBot[_0x1beb4f(0x292)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x14920c)[_0x1beb4f(0x1e7)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x1beb4f(0x267)}]]}})[_0x1beb4f(0x2b9)](_0x4c112a=>{telegramError(_0x4c112a);}),tgBot['on']('callback_query',async _0x334522=>{const _0x170747=_0x1beb4f,_0x6deda4=_0x334522['data'],_0x1055fa=_0x334522[_0x170747(0x208)];tgBot[_0x170747(0x18c)](_0x334522['id'])[_0x170747(0x2dd)](async()=>{const _0xb2557e=_0x170747;devices[_0x164bc2]['telegram2FaApproval']={'clientip':_0x14920c,'timestamp':new Date()[_0xb2557e(0x1c8)](),'expiry':_0x6deda4},_0x6deda4!='reject'?(await tgBot[_0xb2557e(0x292)](_0x1055fa[_0xb2557e(0x179)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0xb2557e(0x2b9)](_0x70ad65=>{telegramError(_0x70ad65);}),io['to'](_0x164bc2)['emit'](_0xb2557e(0x299),{'access':{'allow':![],'reason':_0xb2557e(0x2b0),'token':null}})):(await tgBot[_0xb2557e(0x292)](_0x1055fa['chat']['id'],_0xb2557e(0x2c1))[_0xb2557e(0x2b9)](_0x49c948=>{telegramError(_0x49c948);}),io['to'](_0x164bc2)[_0xb2557e(0x1e4)](_0xb2557e(0x299),{'access':{'allow':![],'reason':_0xb2557e(0x293),'token':null}}));}),tgBot[_0x170747(0x1c1)](_0x170747(0x31f));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x287a31=_0x59775d;return dbConfig[_0x287a31(0x2d4)]('bots')[_0x287a31(0x21a)](_0x287a31(0x182))[_0x287a31(0x2a9)]({'status':'enabled'})[_0x287a31(0x249)]()||[];}function getDisabledBots(){const _0x396884=_0x59775d;return dbConfig[_0x396884(0x2d4)](_0x396884(0x24b))[_0x396884(0x21a)](_0x396884(0x182))[_0x396884(0x2a9)]({'status':_0x396884(0x315)})[_0x396884(0x249)]()||[];}function getBotAttributes(_0x102289){const _0x5ca8a3=_0x59775d;let _0x4e11b8={};const _0x565adc=configpath+_0x5ca8a3(0x313)+_0x102289+_0x5ca8a3(0x280),_0xba8831=fs[_0x5ca8a3(0x167)](_0x565adc);if(_0xba8831){const _0xf5e72c=fs['readFileSync'](_0x565adc);try{const _0x5dba97=JSON[_0x5ca8a3(0x1ab)](_0xf5e72c),_0x2465eb=_0x5dba97?_0x5dba97[_0x5ca8a3(0x1bf)][0x0]['headless']:![];_0x4e11b8[_0x5ca8a3(0x16f)]=_0x2465eb?_0x5ca8a3(0x18b):'manual',_0x4e11b8[_0x5ca8a3(0x2bf)]=_0x5dba97?_0x5dba97[_0x5ca8a3(0x1bf)][0x0][_0x5ca8a3(0x2bf)]:'Bot\x20'+_0x102289;}catch(_0x55599a){_0x4e11b8[_0x5ca8a3(0x16f)]=_0x5ca8a3(0x2e5),_0x4e11b8[_0x5ca8a3(0x2bf)]=_0x5ca8a3(0x239)+_0x102289;}}else _0x4e11b8[_0x5ca8a3(0x16f)]=_0x5ca8a3(0x2e5),_0x4e11b8['botname']=_0x5ca8a3(0x239)+_0x102289;return _0x4e11b8;}function getBotsWithMode(){const _0x3fa59c=_0x59775d,_0x15f710=dbConfig[_0x3fa59c(0x2d4)](_0x3fa59c(0x24b))['sortBy'](_0x3fa59c(0x182))['value']()||[];return _0x15f710[_0x3fa59c(0x22f)](_0x32d3a1=>{const _0x147271=_0x3fa59c;let _0x1add46=getBotAttributes(_0x32d3a1[_0x147271(0x182)]);_0x32d3a1[_0x147271(0x16f)]=_0x1add46[_0x147271(0x16f)];}),_0x15f710;}function getBotExchanges(){const _0x252d90=_0x59775d;let _0x133881=[];const _0x3e7b5e=dbConfig[_0x252d90(0x2d4)](_0x252d90(0x24b))[_0x252d90(0x21a)](_0x252d90(0x182))[_0x252d90(0x249)]()||[];_0x3e7b5e[_0x252d90(0x22f)](_0x259fd5=>{const _0x34238e=_0x252d90;if(_0x259fd5[_0x34238e(0x299)]==_0x34238e(0x24e)){const _0x344139=configpath+_0x34238e(0x313)+_0x259fd5[_0x34238e(0x182)]+'-config.json',_0x5323f6=fs[_0x34238e(0x167)](_0x344139);let _0x4be338;if(_0x5323f6){const _0x1a477=fs['readFileSync'](_0x344139);try{const _0x1988e7=JSON[_0x34238e(0x1ab)](_0x1a477);_0x4be338=_0x1988e7?_0x1988e7[_0x34238e(0x1bf)][0x0][_0x34238e(0x222)]:null;}catch(_0x1b0d0e){}}if(_0x4be338)_0x133881[_0x34238e(0x21e)](_0x4be338);}});const _0x539be9=[...new Set(_0x133881)][_0x252d90(0x24a)]();return _0x539be9;}async function initUser(){const _0x1aab03=_0x59775d;if(!settings['userid']){const _0xa0be41=uuidRandom();mixpanel['alias'](_0xa0be41),updateSetting(_0x1aab03(0x15b),_0xa0be41);}}async function initSecure(){const _0x4b820c=_0x59775d;let _0x2f9769=getSecure();if(!_0x2f9769[_0x4b820c(0x166)](_0x4b820c(0x2bb))){let _0x2c42d8=await generateKeys();_0x2f9769[_0x4b820c(0x1be)]=_0x2c42d8[_0x4b820c(0x1be)],_0x2f9769[_0x4b820c(0x241)]=_0x2c42d8['privateKey'],_0x2f9769['secret']=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x2f9769);}}function getSettings(){const _0x4fcf9a=_0x59775d;return dbSettings[_0x4fcf9a(0x2d4)](_0x4fcf9a(0x17c))[_0x4fcf9a(0x249)]()||{};}function getSecure(){const _0x482fe2=_0x59775d;return dbSecure[_0x482fe2(0x2d4)](_0x482fe2(0x18e))[_0x482fe2(0x249)]()||{};}function getBlacklist(){const _0x5dbfe2=_0x59775d;return dbSecure['get'](_0x5dbfe2(0x223))[_0x5dbfe2(0x249)]()||[];}function broadcastToBots(_0x38d957,_0x129c54){const _0x333167=_0x59775d;config[_0x333167(0x22f)](_0x5694e9=>{const _0x5c54b5=_0x333167;if(_0x5694e9[_0x5c54b5(0x299)]==_0x5c54b5(0x24e)&&_0x5694e9['live']==_0x5c54b5(0x268)||_0x5694e9[_0x5c54b5(0x299)]==_0x5c54b5(0x1e8)&&_0x5694e9[_0x5c54b5(0x311)]==_0x5c54b5(0x268)){if(pid[_0x5694e9[_0x5c54b5(0x182)]])pid[_0x5694e9[_0x5c54b5(0x182)]]['send']({[_0x38d957]:_0x129c54});}});}function storeSettings(_0x1068a1,_0x45193a=![]){const _0x1ac5a5=_0x59775d;_0x1068a1={...settings,..._0x1068a1};if(_0x45193a&&_0x1068a1[_0x1ac5a5(0x290)]!=_0x1ac5a5(0x163)&&_0x1068a1[_0x1ac5a5(0x290)]!=_0x1ac5a5(0x1cb)&&_0x1068a1[_0x1ac5a5(0x290)]!=''){const _0x4e62c8=crypt[_0x1ac5a5(0x308)](secure[_0x1ac5a5(0x241)],_0x1068a1[_0x1ac5a5(0x290)])['message'][_0x1ac5a5(0x284)]('@')[0x0],_0x31f013=bcrypt['hashSync'](_0x4e62c8,saltRounds);_0x1068a1={..._0x1068a1,'bbPassword':_0x31f013};}if(_0x45193a&&_0x1068a1['telegramToken']!=_0x1ac5a5(0x163)&&_0x1068a1[_0x1ac5a5(0x1a7)]!=_0x1ac5a5(0x1cb)&&_0x1068a1[_0x1ac5a5(0x1a7)]!=''){const _0x2cfc16=crypt[_0x1ac5a5(0x308)](secure[_0x1ac5a5(0x241)],_0x1068a1[_0x1ac5a5(0x1a7)])[_0x1ac5a5(0x208)][_0x1ac5a5(0x284)]('@')[0x0];_0x1068a1={..._0x1068a1,'telegramToken':_0x2cfc16};}const _0x50dc1a=_0x1068a1[_0x1ac5a5(0x1a7)]!='************'&&_0x1068a1['telegramToken']!=settings[_0x1ac5a5(0x1a7)]||_0x1068a1['telegramUsername']!=settings[_0x1ac5a5(0x215)],_0x40c5a7=_0x1068a1['telegramToken']==''||_0x1068a1[_0x1ac5a5(0x215)]=='';if(_0x50dc1a)_0x1068a1[_0x1ac5a5(0x2da)]=_0x1ac5a5(0x1ca);for(const [_0x2e211f,_0x14e81a]of Object[_0x1ac5a5(0x214)](_0x1068a1)){if(_0x2e211f==_0x1ac5a5(0x1a7)&&_0x14e81a=='************'){_0x1068a1['telegramToken']=settings['telegramToken'];continue;};if(_0x2e211f==_0x1ac5a5(0x290)&&_0x14e81a=='************'){_0x1068a1['bbPassword']=settings[_0x1ac5a5(0x290)];continue;};dbSettings[_0x1ac5a5(0x2e2)](_0x1ac5a5(0x25a)+_0x2e211f,_0x14e81a)[_0x1ac5a5(0x1af)]();}settings=_0x1068a1,io['to'](_0x1ac5a5(0x1d8))[_0x1ac5a5(0x1e4)](_0x1ac5a5(0x17c),cleanSettings()),broadcastToBots('timeshift',settings[_0x1ac5a5(0x300)]),broadcastToBots(_0x1ac5a5(0x2ee),settings['onepagemode']);if(_0x50dc1a&&!_0x40c5a7)initTelegram();if(_0x50dc1a&&_0x40c5a7)disableTelegram();getAllClients()[_0x1ac5a5(0x22f)](_0x2763f1=>{const _0x3da9e7=_0x1ac5a5;getSocket(_0x2763f1['id'])['emit'](_0x3da9e7(0x299),{'access':{'allow':![],'reason':_0x3da9e7(0x2b0),'token':null}});});}function updateSetting(_0x27e0d5,_0x550a59){const _0xe817af=_0x59775d;dbSettings[_0xe817af(0x2e2)](_0xe817af(0x25a)+_0x27e0d5,_0x550a59)[_0xe817af(0x1af)](),settings=getSettings(),io['to'](_0xe817af(0x1d8))[_0xe817af(0x1e4)]('settings',cleanSettings());}function storeSecure(_0x17f4bf){const _0x541a23=_0x59775d;dbSecure[_0x541a23(0x2d4)]('secure')['push'](_0x17f4bf)[_0x541a23(0x1af)](),secure=_0x17f4bf;}function addBlacklist(_0x52f28f){const _0x9a1d40=_0x59775d;cleanBlacklist();let _0x2d096b;devices[_0x52f28f][_0x9a1d40(0x26b)]?_0x2d096b=Math[_0x9a1d40(0x15a)](devices[_0x52f28f][_0x9a1d40(0x26b)]['expiry'],loginExpiry):_0x2d096b=loginExpiry,dbSecure['get'](_0x9a1d40(0x223))[_0x9a1d40(0x21e)]({'expiry':new Date()[_0x9a1d40(0x1c8)]()+_0x2d096b*0x3c*0x3e8,'token':devices[_0x52f28f]['access'][_0x9a1d40(0x15d)]})[_0x9a1d40(0x1af)](),blacklist=dbSecure['get'](_0x9a1d40(0x223))['value']();}function cleanBlacklist(){const _0xf2b569=_0x59775d;let _0x111727=dbSecure['get']('blacklist')['cloneDeep']()[_0xf2b569(0x249)](),_0x5aea76=new Date()[_0xf2b569(0x1c8)]();_0x111727['forEach'](_0x18c15d=>{const _0x21591b=_0xf2b569;_0x18c15d[_0x21591b(0x306)]<_0x5aea76&&dbSecure[_0x21591b(0x2d4)](_0x21591b(0x223))[_0x21591b(0x2e4)]({'expiry':_0x18c15d[_0x21591b(0x306)]})[_0x21591b(0x1af)]();});}function initStates(){const _0x216f64=_0x59775d;let _0x2302fd=getConfiguration();_0x2302fd[_0x216f64(0x22f)](_0x568d6a=>{const _0x46c624=_0x216f64;_0x568d6a[_0x46c624(0x311)]=_0x46c624(0x314);}),storeConfiguration(_0x2302fd);}function onKeys(){const _0x456896=new RSA();return new Promise(_0x383950=>{const _0x28a035=_0x36a4;_0x456896[_0x28a035(0x312)]()[_0x28a035(0x2dd)](_0x5af0ed=>{_0x383950(_0x5af0ed);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3eb7f8=_0x59775d;let _0xdf6b6c=getSettings(),_0x5b1bb9=![];!_0xdf6b6c['hasOwnProperty']('lastmsgtelegram')&&(_0xdf6b6c['lastmsgtelegram']=0x0,_0x5b1bb9=!![]);!_0xdf6b6c[_0x3eb7f8(0x166)]('lastmsgemitted')&&(_0xdf6b6c[_0x3eb7f8(0x2a6)]=0x0,_0x5b1bb9=!![]);!_0xdf6b6c['hasOwnProperty'](_0x3eb7f8(0x1a3))&&(_0xdf6b6c[_0x3eb7f8(0x1a3)]=_0x3eb7f8(0x21d),_0x5b1bb9=!![]);!_0xdf6b6c[_0x3eb7f8(0x166)](_0x3eb7f8(0x2ee))&&(_0xdf6b6c[_0x3eb7f8(0x2ee)]=![],_0x5b1bb9=!![]);if(_0x5b1bb9)storeSettings(_0xdf6b6c);try{fs[_0x3eb7f8(0x327)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x404797=>{const _0x43279e=_0x3eb7f8;if(!_0x404797[_0x43279e(0x184)]()){if(!_0x404797[_0x43279e(0x211)][_0x43279e(0x27e)]('backup-full@'))fs[_0x43279e(0x1b9)](configbackuppath+_0x404797[_0x43279e(0x211)]);}else fs[_0x43279e(0x1cd)](configbackuppath+_0x404797[_0x43279e(0x211)],{'recursive':!![]});});}catch(_0x5c227c){logger[_0x3eb7f8(0x257)](_0x3eb7f8(0x26d),_0x5c227c);}}function storeConfiguration(_0x4bb08a){const _0x3c6540=_0x59775d;dbConfig[_0x3c6540(0x2d4)]('bots')[_0x3c6540(0x2e4)]()[_0x3c6540(0x1af)](),_0x4bb08a['forEach'](_0x50eb8d=>{const _0x17bb9c=_0x3c6540;delete _0x50eb8d[_0x17bb9c(0x16f)];}),dbConfig[_0x3c6540(0x2d4)](_0x3c6540(0x24b))[_0x3c6540(0x21e)](..._0x4bb08a)[_0x3c6540(0x1af)](),config=_0x4bb08a;}function resetPassword(){const _0x3cd31c=_0x59775d;tgBot&&settings['telegramChatId']&&(tgBot[_0x3cd31c(0x1c1)](_0x3cd31c(0x31f)),tgBot[_0x3cd31c(0x292)](settings[_0x3cd31c(0x2d7)],_0x3cd31c(0x31c),{'parse_mode':_0x3cd31c(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x3cd31c(0x1aa),'callback_data':_0x3cd31c(0x1aa)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x299770=>{telegramError(_0x299770);}),tgBot['on'](_0x3cd31c(0x31f),async _0xb12ebd=>{const _0x57e6f8=_0x3cd31c,_0x32a5d3=_0xb12ebd[_0x57e6f8(0x2f3)],_0x4a9798=_0xb12ebd[_0x57e6f8(0x208)];tgBot[_0x57e6f8(0x18c)](_0xb12ebd['id'])[_0x57e6f8(0x2dd)](async()=>{const _0x195862=_0x57e6f8;if(_0x32a5d3!='no'){const _0xeefa4=0xf,_0x1fc226=_0x195862(0x318),_0x6db23f=Array['from'](crypto[_0x195862(0x169)](new Uint32Array(_0xeefa4)))['map'](_0x86ef38=>_0x1fc226[_0x86ef38%_0x1fc226[_0x195862(0x323)]])['join'](''),_0x5cf2ef=bcrypt['hashSync'](_0x6db23f,saltRounds);storeSettings({'bbPassword':_0x5cf2ef}),await tgBot[_0x195862(0x292)](_0x4a9798[_0x195862(0x179)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x6db23f,{'parse_mode':_0x195862(0x1f4)})[_0x195862(0x2b9)](_0x230930=>{telegramError(_0x230930);});}else await tgBot[_0x195862(0x292)](_0x4a9798[_0x195862(0x179)]['id'],_0x195862(0x287))[_0x195862(0x2b9)](_0x29922a=>{telegramError(_0x29922a);});}),tgBot[_0x57e6f8(0x1c1)](_0x57e6f8(0x31f));}));}async function confirmRestore(_0x47e2e7,_0x5df8ec){const _0x2ba151=_0x59775d;io['to'](_0x2ba151(0x1d8))[_0x2ba151(0x1e4)](_0x2ba151(0x1b7),_0x2ba151(0x199),'success'),tgBot&&settings[_0x2ba151(0x2d7)]&&(tgBot['removeListener'](_0x2ba151(0x31f)),await tgBot[_0x2ba151(0x292)](settings[_0x2ba151(0x2d7)],_0x2ba151(0x1c2),{'parse_mode':_0x2ba151(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x2ba151(0x1aa),'callback_data':_0x2ba151(0x1aa)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x30dd4c=>{telegramError(_0x30dd4c);}),tgBot['on'](_0x2ba151(0x31f),async _0x2a3239=>{const _0x4fc10a=_0x2ba151,_0x1aa311=_0x2a3239[_0x4fc10a(0x2f3)],_0x1f3867=_0x2a3239['message'];tgBot[_0x4fc10a(0x18c)](_0x2a3239['id'])[_0x4fc10a(0x2dd)](async()=>{const _0x23ef57=_0x4fc10a;_0x1aa311==_0x23ef57(0x1aa)?(await tgBot[_0x23ef57(0x292)](_0x1f3867[_0x23ef57(0x179)]['id'],_0x23ef57(0x2c0),{'parse_mode':_0x23ef57(0x1f4)})['catch'](_0x417672=>{telegramError(_0x417672);}),unzipFile(_0x47e2e7,_0x5df8ec)):(logger['debug'](_0x23ef57(0x2b5)),await tgBot[_0x23ef57(0x292)](_0x1f3867[_0x23ef57(0x179)]['id'],_0x23ef57(0x2b5))[_0x23ef57(0x2b9)](_0x32cc84=>{telegramError(_0x32cc84);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x3a7077=_0x59775d,_0xd23166=new Date();return _0xd23166[_0x3a7077(0x2ef)]()+'/'+(_0xd23166[_0x3a7077(0x329)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0xd23166[_0x3a7077(0x210)]()[_0x3a7077(0x30d)]()['padStart'](0x2,'0')+'\x20'+_0xd23166[_0x3a7077(0x275)]()['toString']()['padStart'](0x2,'0')+':'+_0xd23166[_0x3a7077(0x1bc)]()[_0x3a7077(0x30d)]()[_0x3a7077(0x233)](0x2,'0')+':'+_0xd23166[_0x3a7077(0x1ef)]()[_0x3a7077(0x30d)]()[_0x3a7077(0x233)](0x2,'0');}function getTimeStamp(){const _0x5d5913=_0x59775d,_0xbfcc21=shiftedTime();return _0xbfcc21[_0x5d5913(0x2ef)]()+'/'+(_0xbfcc21[_0x5d5913(0x329)]()+0x1)[_0x5d5913(0x30d)]()[_0x5d5913(0x233)](0x2,'0')+'/'+_0xbfcc21[_0x5d5913(0x210)]()['toString']()[_0x5d5913(0x233)](0x2,'0')+'\x20'+_0xbfcc21[_0x5d5913(0x275)]()[_0x5d5913(0x30d)]()['padStart'](0x2,'0')+':'+_0xbfcc21[_0x5d5913(0x1bc)]()[_0x5d5913(0x30d)]()[_0x5d5913(0x233)](0x2,'0')+':'+_0xbfcc21[_0x5d5913(0x1ef)]()[_0x5d5913(0x30d)]()[_0x5d5913(0x233)](0x2,'0');}function getCleanTimeStamp(){const _0x393283=_0x59775d,_0x468aaa=shiftedTime();return _0x468aaa[_0x393283(0x2ef)]()+(_0x468aaa[_0x393283(0x329)]()+0x1)[_0x393283(0x30d)]()[_0x393283(0x233)](0x2,'0')+_0x468aaa['getDate']()[_0x393283(0x30d)]()[_0x393283(0x233)](0x2,'0')+'-'+_0x468aaa['getHours']()['toString']()[_0x393283(0x233)](0x2,'0')+_0x468aaa['getMinutes']()[_0x393283(0x30d)]()[_0x393283(0x233)](0x2,'0')+_0x468aaa['getSeconds']()['toString']()[_0x393283(0x233)](0x2,'0');}function shiftedTime(){const _0x27c9d=_0x59775d,_0x5b6491=new Date();let _0xdd173e=_0x5b6491;if(settings[_0x27c9d(0x300)]&&settings[_0x27c9d(0x300)]!==0x0)_0xdd173e=fns[_0x27c9d(0x2ad)](_0x5b6491,{'hours':settings['timeshift']});return _0xdd173e;}function startScheduler(){const _0x18bdb8=_0x59775d,_0x5ca952=new Date()[_0x18bdb8(0x2b8)](),_0x5be684=shiftedTime()[_0x18bdb8(0x275)]();_0x5be684==0x4&&backupConfigFiles();_0x5be684==0x0&&rotateLogFiles();_0x5ca952%0x6==0x0&&triggerAnalytics();_0x5ca952%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x140b91){const _0x1f7d47=_0x59775d;logger[_0x1f7d47(0x257)](_0x1f7d47(0x2b7)+_0x140b91);const _0x19ad64=getBotsWithMode();_0x19ad64['length']>0x0?confirmRestore(configbackuppath,_0x140b91):unzipFile(configbackuppath,_0x140b91);}async function getBackupFiles(_0x2e51a7=null){const _0x2eb1aa=_0x59775d;let _0x2b19ee=[],_0x1e80f0=fs[_0x2eb1aa(0x327)](configbackuppath,{'withFileTypes':!![]});_0x1e80f0[_0x2eb1aa(0x24a)]((_0x27e8ea,_0x16f6ff)=>_0x27e8ea['name']<_0x16f6ff[_0x2eb1aa(0x211)]?0x1:_0x16f6ff[_0x2eb1aa(0x211)]<_0x27e8ea[_0x2eb1aa(0x211)]?-0x1:0x0),_0x1e80f0[_0x2eb1aa(0x22f)](_0x349618=>{const _0x270cd5=_0x2eb1aa;if(!_0x349618[_0x270cd5(0x184)]()&&_0x349618[_0x270cd5(0x211)][_0x270cd5(0x27e)](_0x270cd5(0x26f))&&_0x349618[_0x270cd5(0x211)][_0x270cd5(0x193)]('.zip')){const _0x431d42=formatDate(fs[_0x270cd5(0x162)](configbackuppath+_0x349618[_0x270cd5(0x211)])[_0x270cd5(0x21b)]);_0x2b19ee[_0x270cd5(0x21e)]({'name':_0x349618['name'],'mtime':_0x431d42});}});if(_0x2e51a7)io['to'](_0x2e51a7)[_0x2eb1aa(0x1e4)](_0x2eb1aa(0x1f6),_0x2b19ee);else return _0x2b19ee;}async function backupConfigFiles(){const _0x1c2f23=_0x59775d;await zipFiles(_0x1c2f23(0x26a));const _0x3e0444=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x1c2f23(0x2e0),configbackuppath+(_0x1c2f23(0x26f)+_0x3e0444+_0x1c2f23(0x205)));let _0x508ee5=fs[_0x1c2f23(0x327)](configbackuppath,{'withFileTypes':!![]});_0x508ee5['sort']((_0x498e94,_0x3ff9c8)=>_0x498e94['name']<_0x3ff9c8[_0x1c2f23(0x211)]?0x1:_0x3ff9c8[_0x1c2f23(0x211)]<_0x498e94[_0x1c2f23(0x211)]?-0x1:0x0),_0x508ee5[_0x1c2f23(0x323)]>maxBackups&&fs[_0x1c2f23(0x1b9)](configbackuppath+_0x508ee5[_0x508ee5['length']-0x1]['name']);}function rotateLogFiles(){const _0x58a842=_0x59775d,_0x182896=fs[_0x58a842(0x162)](logspath+'output-000.log'),_0x2f12a=_0x182896['size']/0x400;if(_0x2f12a>0x64){let _0x1c0134=fs[_0x58a842(0x327)](logspath,{'withFileTypes':!![]});_0x1c0134[_0x58a842(0x24a)]((_0x28a98a,_0x4a9245)=>_0x28a98a[_0x58a842(0x211)]<_0x4a9245[_0x58a842(0x211)]?0x1:_0x4a9245[_0x58a842(0x211)]<_0x28a98a[_0x58a842(0x211)]?-0x1:0x0),_0x1c0134[_0x58a842(0x22f)](_0xb86868=>{const _0x2c70da=_0x58a842;if(_0xb86868[_0x2c70da(0x211)]==_0x2c70da(0x177))fs[_0x2c70da(0x32b)](logspath+_0xb86868['name'],logspath+'output-003.log');if(_0xb86868[_0x2c70da(0x211)]==_0x2c70da(0x1b1))fs[_0x2c70da(0x32b)](logspath+_0xb86868[_0x2c70da(0x211)],logspath+_0x2c70da(0x177));_0xb86868[_0x2c70da(0x211)]==_0x2c70da(0x1fd)&&(fs[_0x2c70da(0x32b)](logspath+_0xb86868[_0x2c70da(0x211)],logspath+'output-001.log'),fs[_0x2c70da(0x2d3)](logspath+_0xb86868['name'],''));});}}async function zipFiles(_0x156e28){const _0x5e9dc7=_0x59775d;let _0x12ac6c;if(_0x156e28=='logs')_0x12ac6c=logspath;if(_0x156e28==_0x5e9dc7(0x24d))_0x12ac6c=configpath;if(_0x156e28==_0x5e9dc7(0x26a))_0x12ac6c=configpath;let _0x5dfa9d=fs['readdirSync'](_0x12ac6c,{'withFileTypes':!![]});const _0x11737a=new require(_0x5e9dc7(0x28b))();_0x5dfa9d[_0x5e9dc7(0x22f)](_0x2224e1=>{const _0x53cc60=_0x5e9dc7;if(!_0x2224e1['isDirectory']()){let _0x3315c2=fs[_0x53cc60(0x30f)](_0x12ac6c+_0x2224e1[_0x53cc60(0x211)]);if(_0x156e28==_0x53cc60(0x24d)){const _0x3b44aa=/^bot-[0-9]{3}-config.json$/,_0x4f07f0=_0x3b44aa[_0x53cc60(0x303)](_0x2224e1[_0x53cc60(0x211)]);if(_0x4f07f0){const _0xb04ebf=JSON['parse'](_0x3315c2);if(_0xb04ebf['bot'][0x0]){_0xb04ebf[_0x53cc60(0x1bf)][0x0][_0x53cc60(0x2ea)]='***',_0xb04ebf[_0x53cc60(0x1bf)][0x0][_0x53cc60(0x271)]=_0x53cc60(0x1cb);if(_0xb04ebf[_0x53cc60(0x1bf)][0x0][_0x53cc60(0x20b)])_0xb04ebf[_0x53cc60(0x1bf)][0x0][_0x53cc60(0x20b)]=_0x53cc60(0x1cb);}_0x3315c2=JSON[_0x53cc60(0x2fe)](_0xb04ebf,null,0x2);}if(_0x2224e1[_0x53cc60(0x211)]==_0x53cc60(0x2e8)){const _0x4bf295=JSON[_0x53cc60(0x1ab)](_0x3315c2);if(_0x4bf295['settings'][_0x53cc60(0x301)])_0x4bf295[_0x53cc60(0x17c)][_0x53cc60(0x301)]=![];if(_0x4bf295[_0x53cc60(0x17c)]['bbPassword'])_0x4bf295[_0x53cc60(0x17c)][_0x53cc60(0x290)]=_0x53cc60(0x1cb);if(_0x4bf295[_0x53cc60(0x17c)]['telegramToken'])_0x4bf295[_0x53cc60(0x17c)]['telegramToken']=_0x53cc60(0x1cb);if(_0x4bf295[_0x53cc60(0x17c)]['telegramChatId'])_0x4bf295[_0x53cc60(0x17c)]['telegramChatId']=null;_0x3315c2=JSON[_0x53cc60(0x2fe)](_0x4bf295,null,0x2);}if(_0x2224e1[_0x53cc60(0x211)]!='bb-secure.json')_0x11737a['file'](_0x2224e1['name'],_0x3315c2);}else _0x11737a[_0x53cc60(0x288)](_0x2224e1[_0x53cc60(0x211)],_0x3315c2);}});const _0x53be1d=_0x11737a[_0x5e9dc7(0x1ea)]({'base64':![],'compression':'DEFLATE'});fs[_0x5e9dc7(0x2d3)](zippath+(_0x156e28+'.zip'),_0x53be1d,_0x5e9dc7(0x2af));}async function unzipFile(_0x168237,_0x491999){const _0x4b8b99=_0x59775d;fs[_0x4b8b99(0x327)](configpath,{'withFileTypes':!![]})[_0x4b8b99(0x22f)](_0x434ab1=>{const _0x36bcbe=_0x4b8b99;if(!_0x434ab1[_0x36bcbe(0x184)]())fs[_0x36bcbe(0x1cd)](configpath+_0x434ab1[_0x36bcbe(0x211)]);});const _0x237e77=fs[_0x4b8b99(0x30f)](_0x168237+_0x491999,'binary'),_0x31666d=new require(_0x4b8b99(0x28b))(_0x237e77,{'base64':![],'checkCRC32':!![]});Object[_0x4b8b99(0x29f)](_0x31666d[_0x4b8b99(0x256)])[_0x4b8b99(0x22f)](_0x573dd0=>{const _0x4dcecb=_0x4b8b99,_0x3bf6c8=_0x31666d[_0x4dcecb(0x256)][_0x573dd0];fs[_0x4dcecb(0x2d3)](configpath+_0x3bf6c8['name'],_0x3bf6c8[_0x4dcecb(0x317)]);}),fs[_0x4b8b99(0x327)](temppath,{'withFileTypes':!![]})['forEach'](_0x4599d9=>{const _0x321a99=_0x4b8b99;if(!_0x4599d9[_0x321a99(0x184)]())fs[_0x321a99(0x1cd)](temppath+_0x4599d9[_0x321a99(0x211)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x4b8b99(0x259)]({'restore':!![]},_0x59955a=>{});}async function getPublicIp(){const _0xf29eaa=_0x59775d;try{const _0x32c228=await axios['get'](_0xf29eaa(0x294));publicip=_0x32c228[_0xf29eaa(0x2f3)]['ip'];}catch(_0x33c9fb){}}async function triggerAnalytics(){const _0x372b6b=_0x59775d;if(!publicip)await getPublicIp();const _0x557b2c=getBotsWithMode();let _0x36158b=0x0;_0x557b2c[_0x372b6b(0x22f)](_0x50ac18=>{const _0x4eb2d2=_0x372b6b;if(_0x50ac18['status']===_0x4eb2d2(0x24e))_0x36158b++;});const _0x246fa0=getBotExchanges();mixpanel[_0x372b6b(0x23b)](_0x372b6b(0x316),{'distinct_id':settings[_0x372b6b(0x15b)],'ip':publicip,'version':serverversion,'numbots':_0x557b2c[_0x372b6b(0x323)],'numbotsenabled':_0x36158b,'exchanges':_0x246fa0});}async function getMessages(){const _0x2ae99e=_0x59775d,_0x305000=_0x2ae99e(0x1d3),_0x1ee4c5=new GraphQLClient(_0x305000),_0x3dce23={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x3324ca=serverversion[_0x2ae99e(0x284)]('.'),_0xc7aaea=_0x3324ca[0x0]+'.'+_0x3324ca[0x1],_0x79e1f7=Math[_0x2ae99e(0x227)](settings[_0x2ae99e(0x1e9)],settings[_0x2ae99e(0x2a6)]),_0x562eed={'last':parseInt(_0x79e1f7),'bbm':_0xc7aaea},_0x34cca0=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1c56e7;try{_0x1c56e7=await _0x1ee4c5[_0x2ae99e(0x26c)](_0x34cca0,_0x562eed,_0x3dce23);}catch(_0x1795e5){}if(_0x1c56e7&&_0x1c56e7['messages']){let _0x4abb9d=settings['lastmsgtelegram'];newMessages=[];for(const _0xbab9e0 of _0x1c56e7[_0x2ae99e(0x29d)]){newMessages['push'](_0xbab9e0);if(_0xbab9e0[_0x2ae99e(0x28a)])updateSetting(_0x2ae99e(0x1a3),_0xbab9e0['bbvNew']);let _0x9f9e4e=_0xbab9e0[_0x2ae99e(0x28a)]?serverversion>=_0xbab9e0[_0x2ae99e(0x28a)]:![];if(!_0x9f9e4e&&_0xbab9e0[_0x2ae99e(0x2df)]>_0x4abb9d){if(_0xbab9e0[_0x2ae99e(0x224)]===_0x2ae99e(0x305)||serverversion[_0x2ae99e(0x27e)](_0xbab9e0[_0x2ae99e(0x224)])){let _0x30a177=''+_0xbab9e0[_0x2ae99e(0x1e2)]+'\x0a\x0a'+_0xbab9e0['message'];const _0x5013ef=await sendTelegramMsg(toTelegramMarkdown(_0x30a177),_0x2ae99e(0x22d));if(_0x5013ef)_0x4abb9d=_0xbab9e0[_0x2ae99e(0x2df)];}}}updateAvailable=isNewerVersion(settings[_0x2ae99e(0x1a3)],serverversion),updateSetting(_0x2ae99e(0x1e9),_0x4abb9d),emitMessages();}}function _0x36a4(_0x108a95,_0x16919a){const _0x6b683d=_0x5d5d();return _0x36a4=function(_0x25a396,_0x41d717){_0x25a396=_0x25a396-0x158;let _0x5d5d08=_0x6b683d[_0x25a396];return _0x5d5d08;},_0x36a4(_0x108a95,_0x16919a);}function emitMessages(){const _0x3ebdf7=_0x59775d,_0x5117dc=settings[_0x3ebdf7(0x2a6)];let _0x1c49a7=[];newMessages[_0x3ebdf7(0x22f)](_0x2b8e73=>{const _0x3122ae=_0x3ebdf7;_0x2b8e73[_0x3122ae(0x2df)]>_0x5117dc&&_0x1c49a7[_0x3122ae(0x21e)](_0x2b8e73);}),_0x1c49a7[_0x3ebdf7(0x323)]>0x0&&getAllClients()['forEach'](_0x5e7b00=>{const _0xfad67f=_0x3ebdf7;getSocket(_0x5e7b00['id'])[_0xfad67f(0x1e4)](_0xfad67f(0x208),_0x1c49a7);});}function confirmMessage(_0x45044f){updateSetting('lastmsgemitted',Number(_0x45044f));}function isNewerVersion(_0x33ab48,_0x14c3ea){const _0x313152=_0x59775d,_0xa3a026=_0x14c3ea[_0x313152(0x284)]('.'),_0x28f46f=_0x33ab48[_0x313152(0x284)]('.');for(var _0x442a46=0x0;_0x442a46<_0x28f46f[_0x313152(0x323)];_0x442a46++){const _0x119d4d=~~_0x28f46f[_0x442a46],_0x116923=~~_0xa3a026[_0x442a46];if(_0x119d4d>_0x116923)return!![];if(_0x119d4d<_0x116923)return![];}return![];}function toTelegramMarkdown(_0x8bc3c1){const _0xe75e7=_0x59775d,_0x581a0b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x51b6de=/\*{2}(.+?)\*{2}/gim;return _0x8bc3c1=_0x8bc3c1[_0xe75e7(0x30b)](_0x581a0b,'$1_$2_$3')[_0xe75e7(0x30b)](_0x51b6de,_0xe75e7(0x28e)),_0x8bc3c1;}async function validateConfigFile(){const _0xe56f34=_0x59775d,_0x343b06=dbConfig['get'](_0xe56f34(0x24b))[_0xe56f34(0x21a)](_0xe56f34(0x182))['value']()||[];if(_0x343b06[_0xe56f34(0x323)]==0x0){let _0x31e5c3=0x0,_0x345a3d=[];const _0x23c041=/^bot-([0-9]{3})-config.json$/,_0x1c1083=fs[_0xe56f34(0x327)](configpath);_0x1c1083['forEach'](_0xe77ef=>{const _0x2f8d60=_0xe56f34,_0x515294=_0x23c041['exec'](_0xe77ef);if(_0x515294){const _0x589894=_0x515294[0x1];let _0xd5a6a4=getBotAttributes(_0x589894);_0x345a3d[_0x2f8d60(0x21e)]({'botID':_0x589894,'botname':_0xd5a6a4['botname'],'status':_0x2f8d60(0x315),'live':_0x2f8d60(0x314)}),_0x31e5c3++;}}),_0x31e5c3!=0x0&&(dbConfig['get'](_0xe56f34(0x24b))[_0xe56f34(0x304)](_0x345a3d)[_0xe56f34(0x1af)](),config=_0x345a3d,restoredConfigFile=_0x31e5c3);}}async function restoreConfigNotify(_0x45e198){const _0x3f4106=_0x59775d;let _0x2f1b1e;if(restoredConfigFile==0x1)_0x2f1b1e=_0x3f4106(0x1f7);else _0x2f1b1e=_0x3f4106(0x2fa);if(_0x45e198)io['to'](_0x3f4106(0x1d8))['emit'](_0x3f4106(0x1b7),_0x2f1b1e);else{logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](_0x2f1b1e),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x3f4106(0x310)]('');if(tgBot&&settings[_0x3f4106(0x2d7)]&&settings[_0x3f4106(0x2da)]!=_0x3f4106(0x1d7))tgBot[_0x3f4106(0x292)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x2f1b1e)[_0x3f4106(0x2b9)](_0x474195=>{telegramError(_0x474195);});}}function validateCredentials(_0x521499,_0x1f8423){const _0x4512db=_0x59775d;if(_0x521499[_0x4512db(0x31a)]==settings['bbUsername']&&bcrypt[_0x4512db(0x1df)](_0x521499[_0x4512db(0x235)],settings[_0x4512db(0x290)])){if(settings[_0x4512db(0x191)])return{'allow':![],'reason':_0x4512db(0x175),'token':null};else{const _0x3ab07f=generateLoginToken(_0x1f8423);return{'allow':!![],'reason':_0x4512db(0x273),'token':_0x3ab07f};}}else return{'allow':![],'reason':_0x4512db(0x192),'token':null};}function refreshToken(_0x16a78a){const _0x47f6ee=_0x59775d,_0x21bd56=generateLoginToken(_0x16a78a);return{'allow':!![],'reason':_0x47f6ee(0x273),'token':_0x21bd56};}function validateAccess(_0x59e49c,_0x4619e4,_0x4728b5){const _0x1fee1b=_0x59775d,_0x14b1aa=_0x4728b5?_0x4728b5:devices[_0x4619e4]['ip'];let _0x4178b6;const _0x64e7a1=_0xbc7827=>{const _0x582eb1=_0x36a4;if(settings['loginRequired']){if(settings[_0x582eb1(0x191)]){if(telegram2FaApproved(_0x4619e4)){const _0x390714=generateLoginToken(_0x4619e4);return{'allow':!![],'reason':_0x582eb1(0x19a),'token':_0x390714};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x4178b6=validToken(_0xbc7827,_0x4619e4),_0x4178b6[_0x582eb1(0x166)](_0x582eb1(0x269))?{'allow':!![],'reason':_0x582eb1(0x23e),'token':_0xbc7827}:{'allow':![],'reason':_0x582eb1(0x2d1),'token':null};}else return{'allow':!![],'reason':_0x582eb1(0x1b6),'token':null};};if(settings[_0x1fee1b(0x2ba)]){let _0x31ddc8=[...settings[_0x1fee1b(0x2f2)],'::1',_0x1fee1b(0x30c),'127.0.0.1'];if(_0x31ddc8['includes'](_0x14b1aa))return _0x64e7a1(_0x59e49c);else{_0x4178b6=validToken(_0x59e49c,_0x4619e4);if(_0x4178b6['hasOwnProperty']('success'))return _0x64e7a1(_0x59e49c);else{if(telegramIpApproved(_0x4619e4)){const _0x2c09de=generateToken(_0x4619e4);return _0x4178b6=_0x64e7a1(_0x59e49c),_0x4178b6[_0x1fee1b(0x2fb)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x2c09de}:_0x4178b6;}else return settings[_0x1fee1b(0x1d6)]?{'allow':![],'reason':_0x1fee1b(0x207),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x64e7a1(_0x59e49c);}function timelyDecrypt(_0x48b95c,_0x30e0ae=!![]){const _0x3c71d0=_0x59775d;if(_0x48b95c)try{const _0x2bc06e=crypt[_0x3c71d0(0x308)](secure['privateKey'],_0x48b95c)['message'],_0x141817=_0x2bc06e[_0x3c71d0(0x284)]('@')[0x0],_0x2fe456=_0x2bc06e[_0x3c71d0(0x284)]('@')[0x1],_0x20ccb5=new Date()[_0x3c71d0(0x1c8)]();if(_0x30e0ae){if(_0x20ccb5-_0x2fe456<maxSecretAge*0x3e8)return _0x141817;else return![];}else return _0x141817;}catch(_0x13b4e2){return![];}else return![];}const validToken=(_0xeb248b,_0x28a8e7)=>{const _0xe2deb5=_0x59775d,_0x1446fd=devices[_0x28a8e7]['ip'];if(!_0xeb248b)return{'error':_0xe2deb5(0x1dc)};for(let _0x1b82f7 of blacklist){if(_0x1b82f7['token']==_0xeb248b)return{'error':_0xe2deb5(0x2c5)};}let _0x27cc70;try{_0x27cc70=jwt[_0xe2deb5(0x19e)](_0xeb248b,secure[_0xe2deb5(0x2bb)]+_0x28a8e7);}catch{return{'error':_0xe2deb5(0x245)};}if(!_0x27cc70[_0xe2deb5(0x166)](_0xe2deb5(0x1fe))&&!_0x27cc70['hasOwnProperty'](_0xe2deb5(0x31a))||!_0x27cc70[_0xe2deb5(0x166)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x27cc70[_0xe2deb5(0x166)](_0xe2deb5(0x31a))&&_0x27cc70[_0xe2deb5(0x166)]('clientip')){const {clientip:_0xac46c8}=_0x27cc70;return _0x1446fd==_0xac46c8?{'success':_0xe2deb5(0x197)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x27cc70[_0xe2deb5(0x166)](_0xe2deb5(0x31a))&&_0x27cc70[_0xe2deb5(0x166)](_0xe2deb5(0x1fe))){const {username:_0x3a5a2c,clientip:_0x53c9df}=_0x27cc70;return settings['bbUsername']==_0x3a5a2c&&_0x1446fd==_0x53c9df?{'success':_0xe2deb5(0x197)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3046da=>{const _0x4d12e9=_0x59775d;if(_0x3046da){const _0x5343b9=devices[_0x3046da]['ip'];return jwt[_0x4d12e9(0x322)]({'username':settings['bbUsername'],'clientip':_0x5343b9},secure[_0x4d12e9(0x2bb)]+_0x3046da,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x192a33=>{const _0xe9881a=_0x59775d;if(_0x192a33){const _0x31a3b6=devices[_0x192a33]['ip'];return jwt[_0xe9881a(0x322)]({'clientip':_0x31a3b6},secure[_0xe9881a(0x2bb)]+_0x192a33,{'expiresIn':devices[_0x192a33]['telegramIpApproval']['expiry']*0x3c});}else return![];},telegramIpApproved=_0x29c6f7=>{const _0x848235=_0x59775d;let _0x4851b0=![];return devices[_0x29c6f7][_0x848235(0x26b)]&&devices[_0x29c6f7]['telegramIpApproval'][_0x848235(0x306)]!=_0x848235(0x267)&&(_0x4851b0=devices[_0x29c6f7][_0x848235(0x26b)][_0x848235(0x1fe)]==devices[_0x29c6f7]['ip']&&new Date()[_0x848235(0x1c8)]()-devices[_0x29c6f7]['telegramIpApproval'][_0x848235(0x206)]<devices[_0x29c6f7][_0x848235(0x26b)][_0x848235(0x306)]*0x3c*0x3e8),_0x4851b0;},telegram2FaApproved=_0x1f5b44=>{const _0x45d7c9=_0x59775d;let _0xc0bac0=![];return devices[_0x1f5b44][_0x45d7c9(0x20a)]&&devices[_0x1f5b44][_0x45d7c9(0x20a)][_0x45d7c9(0x306)]!=_0x45d7c9(0x267)&&(_0xc0bac0=devices[_0x1f5b44][_0x45d7c9(0x20a)]['clientip']==devices[_0x1f5b44]['ip']&&new Date()[_0x45d7c9(0x1c8)]()-devices[_0x1f5b44][_0x45d7c9(0x20a)][_0x45d7c9(0x206)]<devices[_0x1f5b44][_0x45d7c9(0x20a)][_0x45d7c9(0x306)]*0x3c*0x3e8),_0xc0bac0;},normalizeIP=_0x17ded4=>{const _0x3a19af=_0x59775d;let _0x24b4a5=null,_0x40aa23=null;if(ipaddr[_0x3a19af(0x200)](_0x17ded4)){const _0x89ca2b=ipaddr[_0x3a19af(0x1ab)](_0x17ded4);_0x89ca2b[_0x3a19af(0x19d)]()===_0x3a19af(0x2dc)?(_0x89ca2b['isIPv4MappedAddress']()&&(_0x24b4a5=_0x89ca2b[_0x3a19af(0x1b2)]()[_0x3a19af(0x30d)]()),_0x40aa23=_0x89ca2b[_0x3a19af(0x30d)]()):(_0x24b4a5=_0x89ca2b[_0x3a19af(0x30d)](),_0x40aa23=_0x89ca2b['toIPv4MappedAddress']()[_0x3a19af(0x30d)]());}return{'show':_0x24b4a5?_0x24b4a5:_0x40aa23,'store':_0x40aa23};};function formatDate(_0x1ac16c){const _0x1532d1=_0x59775d;return _0x1ac16c[_0x1532d1(0x2ef)]()+'/'+(_0x1ac16c[_0x1532d1(0x329)]()+0x1)[_0x1532d1(0x30d)]()['padStart'](0x2,'0')+'/'+_0x1ac16c[_0x1532d1(0x210)]()[_0x1532d1(0x30d)]()[_0x1532d1(0x233)](0x2,'0')+'\x20'+_0x1ac16c[_0x1532d1(0x275)]()[_0x1532d1(0x30d)]()[_0x1532d1(0x233)](0x2,'0')+':'+_0x1ac16c['getMinutes']()[_0x1532d1(0x30d)]()[_0x1532d1(0x233)](0x2,'0')+':'+_0x1ac16c['getSeconds']()[_0x1532d1(0x30d)]()[_0x1532d1(0x233)](0x2,'0');}function sleep(_0xf613b9){return new Promise(_0x4e347e=>setTimeout(_0x4e347e,_0xf613b9));}