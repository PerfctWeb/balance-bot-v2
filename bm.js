const _0x201782=_0x20cd;(function(_0x185138,_0x5ac2ab){const _0x44eb53=_0x20cd,_0x18f73a=_0x185138();while(!![]){try{const _0x538351=parseInt(_0x44eb53(0x12c))/0x1+parseInt(_0x44eb53(0x218))/0x2*(-parseInt(_0x44eb53(0x6f))/0x3)+-parseInt(_0x44eb53(0x23b))/0x4*(parseInt(_0x44eb53(0xe1))/0x5)+parseInt(_0x44eb53(0xe2))/0x6+-parseInt(_0x44eb53(0x1d0))/0x7+parseInt(_0x44eb53(0x256))/0x8+-parseInt(_0x44eb53(0xcf))/0x9;if(_0x538351===_0x5ac2ab)break;else _0x18f73a['push'](_0x18f73a['shift']());}catch(_0x53f048){_0x18f73a['push'](_0x18f73a['shift']());}}}(_0x411a,0xd44d7));const _0x469a40=function(){let _0x2a6529=!![];return function(_0xb5537d,_0x166c45){const _0x5065fd=_0x2a6529?function(){const _0x3a67c0=_0x20cd;if(_0x166c45){const _0x5db390=_0x166c45[_0x3a67c0(0xd4)](_0xb5537d,arguments);return _0x166c45=null,_0x5db390;}}:function(){};return _0x2a6529=![],_0x5065fd;};}(),_0x641fcf=_0x469a40(this,function(){const _0x2241c1=_0x20cd;return _0x641fcf[_0x2241c1(0xb3)]()[_0x2241c1(0x83)](_0x2241c1(0x203))[_0x2241c1(0xb3)]()[_0x2241c1(0x195)](_0x641fcf)[_0x2241c1(0x83)]('(((.+)+)+)+$');});_0x641fcf();'use strict';process[_0x201782(0xf2)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x201782(0x1e7)),low=require(_0x201782(0x1ef)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x201782(0xf9)),crypto=require(_0x201782(0x254)),Crypt=require(_0x201782(0x199))[_0x201782(0x7b)],RSA=require('hybrid-crypto-js')[_0x201782(0xe5)],bcrypt=require(_0x201782(0x206)),jwt=require(_0x201782(0x13b)),ipaddr=require('ipaddr.js'),argv=require(_0x201782(0x146))(process['argv'][_0x201782(0x24e)](0x2))[_0x201782(0x177)],uuidRandom=require(_0x201782(0xb6)),{Telegraf,Markup}=require(_0x201782(0x117)),Mixpanel=require(_0x201782(0xdb)),axios=require(_0x201782(0x1a5)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x201782(0x241)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x201782(0xa4)]||_0x201782(0x196),pattern=/^[0-9]{2,4}$/;!pattern[_0x201782(0xad)](PORT)&&(console[_0x201782(0x1d1)](_0x201782(0x215)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x201782(0x11d)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x201782(0xda)][_0x201782(0x213)];let bbpath=_0x201782(0xd8),bbpath2='';const botfile=_0x201782(0x151),configfile=_0x201782(0x214),settingsfile=_0x201782(0xe7),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x201782(0x80))[_0x201782(0x13c)]||'production',maxBackups=0xa;let validInstallation=!![];function _0x411a(){const _0x3656ed=['build','value','unlinkSync','static','isIPv4MappedAddress','\x20>\x20','telegramChatId','/disable\x20-\x20disable\x20notifications\x0a','telegraf','Unauthorized\x20attempt\x20to\x20delete\x20alerts','cancelLoading','showConfig','/:bot/history','once','host','command','bbUsername','connection','Password\x20has\x20been\x20reset\x20to:\x20','action','-performance.json','Session\x20expired\x20for\x20user\x20...','Access\x20enabled\x20for\x20','exec','accept','getMonth','chat','lastmsgemitted','reinstall_yes','1298528kfaUqq','All','isDirectory','/download/:type','telegram','address','password','simple','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','yes','Unauthorized\x20attempt\x20to\x20log\x20out','\x1b[31m','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','[ip-address]','update','jsonwebtoken','environment','Unauthorized\x20login\x20attempt\x20(timeout)','listen','5\x20min','ipv6','express','orders','Login\x20rejected','keys','hashSync','yargs/yargs','replace','enabled','DEFLATE','\x20|\x20user:\x20...','secret','endsWith','privateKey','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','button','type','bot.js','resetHistory','whitelistEnabled','join','File\x20uploaded','getTime','Unauthorized\x20attempt\x20to\x20update\x20settings','bot','reject','All\x20bots\x20running\x20right\x20now','1000','Idling\x20(','loginRequired','backup/','temporary\x20access\x20timeout','Restore\x20backup\x20file\x20','Error\x20removing\x20old\x20backup\x20files:','toIPv4MappedAddress','config_all','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','event','placeOrder','publicKey','headless','off','Unauthorized\x20attempt\x20to\x20show\x20configuration','get','sockets','store-settings','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','resetpw_no','editMessageReplyMarkup','order','files','restart_','emit','access\x20timeout','#RES#\x20if\x20running\x20locally\x0a','argv','sendMetricsTelegram','reason','title','::ffff:127.0.0.1','family','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','logged\x20out','2FA\x20login\x20required','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','readdirSync','inherit','max','temporary\x20access\x20not\x20allowed','stopped','reinstall','settings.','Unauthorized\x20attempt\x20to\x20delete\x20bot','api-eu.mixpanel.com','getDate',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','\x1b[35m','createServer','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','\x20(1)','bbvNew','disconnect','enable','getMinutes','/restart\x20-\x20restart\x20bot(s)\x0a','constructor','3000','backup-files','stop','hybrid-crypto-js','***','warning','statSync','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20get\x20portfolio','sortBy','output-001.log','then','latestversion','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','get-portfolio','axios','startsWith','message','push','existsSync','config_orders','get-messages','temp/','started','15\x20min','access','update-bb','verify','Backup\x20file\x20unzipped\x20and\x20stored','\x20|\x20','restart','RSA-OAEP','stringify','storeConfiguration','telegramEvents','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20download\x20','getUTCHours','clientip','getStartingBalances','$1_$2_$3','userid','settings','/:bot/performance','pidExpireLogin','rmSync','<b>Telegram\x20Bot\x20Status:</b>\x0a','/enable\x20-\x20enable\x20notifications\x0a','\x1b[34m','sort','compareSync','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','decrypt','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','exp','name','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','9866878EWfeqS','log','new-disabled','forEach','new','User\x20has\x20been\x20validated','version','onepagemode','Unauthorized\x20attempt\x20to\x20store\x20configuration',')\x20\x20\x20|\x20Bot\x20','Telegram\x20error:','build2','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Starting\x20#RED#Balance\x20Bot\x20v','reload','showname','show','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Ok,\x20will\x20send\x20order\x20notifications\x20only','Token\x20blacklisted','output-003.log','debug','date-fns','deleteHistoryAlerts','login2fa_','/:bot/coins','args','help','logs/','reset-password','lowdb','mode','auth','remove','reinstall_no','cloneDeep','Network\x20Interfaces:','2FA\x20required','map','defaults','sendPortfolioTelegram','set','callback','connected','Restore\x20process\x20confirmed','add-bot','file','add','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','(((.+)+)+)+$','Setting\x20access:\x20','\x20|\x20client:\x20...','bcryptjs','SIGINT','apiPassword','You\x20can\x20use\x20the\x20following\x20commands:\x0a','IPv4','auto','\x20mode','get-backup-files','Bot\x20','backup-full@','allow','text','Unauthorized\x20attempt\x20to\x20update\x20bot','node','bb-config.json','Error:\x20Invalid\x20argument\x20','parse','-results.json','834332OzDVrP','/update\x20-\x20update\x20Balance\x20Bot\x0a','************','running','conn','post','Disabled\x20Bot\x20','store-configuration','\x1b[33m','match','portfolio_','bbvReceive','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Restoring\x20bot(s)\x20from\x20backup','store-headless','sign','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','getHours','live','fork','-config.json','sendFile','node-zip','show-config','find','toggle','logs','telegramIpApproval','uncaughtException',':\x20Bot\x20Mgr\x20>\x20','reply','.zip','telegram2FaApproval','headers','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','20LxUybg','removeAllListeners','range','config/','mkdirSync','secure','util','getSeconds','storeHeadless','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','0.0.0','/start','https://api.ipify.org?format=json','SIGTERM','store-fiat','kind','get-starting-balances','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','slice','bot-','timestamp','No\x20authentication\x20token','full','<b>Balance\x20Bot\x20Status:</b>\x0a','crypto','length','7252792uyVDiw','getFullYear','init','generate','portfolio','zip/','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Markdown','server','tempaccess_15_','storeFiat','Deleted\x20Bot\x20','referer','update_yes','login\x20required','status','Yes','telegramToken','readFileSync','backup','3wLrBlr','2FA\x20login\x20token\x20generated','HTML','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','timeshift','sha256','get-logs','any','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','createWriteStream','/:bot','Crypt','send','Logged\x20in\x20user\x20...','manual','restore-backup-file','version.json','/metrics\x20-\x20show\x20bot\x20performance\x0a','2FA\x20login\x20rejected','search','function','tempaccess_reject_','login\x20token\x20generated','All\x20bots','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','cancel-loading','config_alerts','binary','6b67f3d61ee94b8f5c80b4affef4c4d9','copyFileSync','/off\x20-\x20stop\x20bot(s)\x0a','\x20only\x0a','\x20(2)','*$1*','lastmsgtelegram','tkn','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','index.html','delete-alerts','hasOwnProperty','login2fa_reject_','disable','Invalid\x20IP\x20address','f2aRequired','hex','catch','127.0.0.1','No\x20bots\x20running\x20right\x20now','error','Notifications\x20enabled\x0a','staging','port','temporaryAccessAllowed','telegramUsername','/:bot/support','writeFileSync','generateKeyPairAsync','-events.json','#RES#\x20','blacklist','test','notification','username','write','kill','tempaccess_5_','toString','number','split','uuid-random','\x1b[0m','mtime','botID','Notifications\x20disabled','login\x20not\x20required','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','invalid\x20credentials','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','(staging)','assign','Allow\x20login\x20from\x20IP\x20address\x20','config','padStart','pidRefreshToken','Bot\x20Mgr\x20>\x20','botmanager','success','Invalid\x20authentication\x20token\x20(2)','Password\x20reset\x20rejected','login','use','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','bbPassword','backupfile','4688307EtTPxu','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Notifications\x20disabled\x0a','sendMessage','messages','apply','remoteAddress','Unauthorized\x20attempt\x20to\x20get\x20messages','Starting\x20(','bb/','botname','versions','mixpanel','\x1b[36m','bb-secure.json','exit','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','disabled','133105sOlkAs','6871272YHsjnn','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','backup-full','RSA','/status\x20-\x20show\x20bot(s)\x20status\x0a','bb-settings.json','store','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','toIPv4Address','token','delete-bot','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Failed\x20to\x20download\x20','update_no','env','string',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','apiKey','randomFillSync','Restore\x20process\x20aborted','Alerts','path','telegramEnabled','all','toggle_','temporary\x20token\x20generated','/:bot/portfolio','output-000.log','Node.js\x20v','uuid','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','expiry','login\x20token\x20valid','toggleBotMode','inlineKeyboard','socket.io','alerts','handshake','bots','=>\x20Go\x20to\x20#CYA#http://','Orders','format','/upload-backup'];_0x411a=function(){return _0x3656ed;};return _0x411a();}!fs[_0x201782(0x1a9)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x201782(0x23e)+userID+'/':bbpath+_0x201782(0x23e),configbackuppath=configpath+_0x201782(0x15e),logspath=userID?bbpath+_0x201782(0x1ed)+userID+'/':bbpath+_0x201782(0x1ed),zippath=userID?bbpath+_0x201782(0x25b)+userID+'/':bbpath+_0x201782(0x25b),loggerfile=fs[_0x201782(0x79)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x201782(0x1ac)+userID+'/':bbpath+_0x201782(0x1ac);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x201782(0x1a9)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x201782(0x23f)](logspath);!fs['existsSync'](zippath)&&fs[_0x201782(0x23f)](zippath);!fs[_0x201782(0x1a9)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x201782(0x1f8)]({'bots':[]})[_0x201782(0xb0)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x201782(0x246),'onepagemode':![]}})[_0x201782(0xb0)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x201782(0x1f8)]({'secure':{},'blacklist':[]})[_0x201782(0xb0)]();let crypt=new Crypt({'md':_0x201782(0x75),'rsaStandard':_0x201782(0x1b5)});const saltRounds=0xa,mixpanel=Mixpanel[_0x201782(0x258)](_0x201782(0x8d),{'host':_0x201782(0x189)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x201782(0x6c)]&&(settings[_0x201782(0x6c)]!=''&&settings[_0x201782(0x6c)]!=_0x201782(0x19a))&&settings[_0x201782(0xa6)]&&settings[_0x201782(0xa6)]!='')initTelegram();const parseColor=(_0x3f6572,_0x140d4e)=>{const _0x2cd8e0=_0x201782,_0x27849d=/#[A-Z]{3}#/g;if(typeof _0x3f6572==_0x2cd8e0(0xf3)){!_0x140d4e?_0x3f6572=_0x3f6572[_0x2cd8e0(0x147)](_0x27849d,''):(_0x3f6572=_0x3f6572[_0x2cd8e0(0x147)](/#BLU#/g,_0x2cd8e0(0x1c6)),_0x3f6572=_0x3f6572[_0x2cd8e0(0x147)](/#RED#/g,_0x2cd8e0(0x137)),_0x3f6572=_0x3f6572['replace'](/#YEL#/g,_0x2cd8e0(0x220)),_0x3f6572=_0x3f6572[_0x2cd8e0(0x147)](/#MAG#/g,_0x2cd8e0(0x18c)),_0x3f6572=_0x3f6572[_0x2cd8e0(0x147)](/#CYA#/g,_0x2cd8e0(0xdc)),_0x3f6572=_0x3f6572[_0x2cd8e0(0x147)](/#RES#/g,_0x2cd8e0(0xb7)));;}return _0x3f6572;},logger={'screen':_0x1d7506=>{const _0x4da4dc=_0x201782;console[_0x4da4dc(0x1d1)](parseColor(_0x1d7506,!![]));},'simple':_0xa08b28=>{const _0x438678=_0x201782;console[_0x438678(0x1d1)](parseColor(_0xa08b28,!![])),loggerfile[_0x438678(0xb0)](util[_0x438678(0x10d)](parseColor(_0xa08b28,![]))+'\x0a');},'full':async _0x13a526=>{const _0x4ce7d8=_0x201782,_0x30ce6a=getTimeStamp()+_0x4ce7d8(0x235)+_0x13a526;console[_0x4ce7d8(0x1d1)](parseColor(_0x30ce6a,!![])),loggerfile[_0x4ce7d8(0xb0)](util[_0x4ce7d8(0x10d)](parseColor(_0x30ce6a,![]))+'\x0a');if(tgBot&&settings[_0x4ce7d8(0x115)]&&settings[_0x4ce7d8(0x1b8)]!=_0x4ce7d8(0x142))await sendTelegram(settings[_0x4ce7d8(0x115)],_0x4ce7d8(0xc5)+parseColor(_0x13a526,![]));},'debug':async(_0x2fa0f6,_0x38ea06='')=>{const _0x411b30=_0x201782,_0x25f0fa=getTimeStamp()+_0x411b30(0xf4)+_0x2fa0f6;if(debugging)console[_0x411b30(0x1d1)](parseColor(_0x25f0fa,!![]));loggerfile[_0x411b30(0xb0)](util[_0x411b30(0x10d)](parseColor(_0x25f0fa,![]))+'\x0a');if(_0x38ea06){if(debugging)console[_0x411b30(0x1d1)](_0x38ea06);loggerfile['write'](util[_0x411b30(0x10d)](_0x38ea06)+'\x0a');}}};let terminating=![];process['on'](_0x201782(0x234),function(_0x458ba1){logger['simple'](_0x458ba1);}),process['on']('exit',()=>{stopAllBots();}),process['on'](_0x201782(0x207),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x201782(0x80))[_0x201782(0x1d6)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x201782(0x141)),app=express(),http=require('http')[_0x201782(0x18d)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x201782(0x16b)](_0x201782(0x12f),async(_0x519f00,_0x325ea4)=>{const _0x228e41=_0x201782,_0x357c0f=_0x519f00['params']['type'],_0x586eb4=getClientsWithBotID(_0x228e41(0xc6)),_0x455601=_0x519f00[_0x228e41(0x239)]['uuid'],_0x1f93a1=timelyDecrypt(_0x455601,![]),_0x32c617=_0x586eb4[_0x228e41(0x230)](_0x4cfbbc=>_0x4cfbbc[_0x228e41(0x101)]==_0x1f93a1);if(_0x32c617){const _0x387723=normalizeIP(_0x519f00['socket'][_0x228e41(0xd5)])[_0x228e41(0xe8)],_0x567858=_0x519f00[_0x228e41(0x239)][_0x228e41(0x94)];if(validateAccess(_0x567858,_0x1f93a1,_0x387723)[_0x228e41(0x210)])_0x357c0f==_0x228e41(0x6e)&&await backupConfigFiles(),await zipFiles(_0x357c0f),_0x325ea4['download'](zippath+(_0x357c0f+_0x228e41(0x237)),_0x74aaa1=>{const _0xf76e25=_0x228e41;_0x74aaa1&&(logger[_0xf76e25(0x252)](_0xf76e25(0xf0)+_0x357c0f),logger[_0xf76e25(0x133)](_0x74aaa1));});else logger['full'](_0x228e41(0x1ba)+_0x357c0f+_0x228e41(0x18f));}else logger['full'](_0x228e41(0x1ba)+_0x357c0f+_0x228e41(0x91));}),app[_0x201782(0x21d)](_0x201782(0x10e),async(_0x556338,_0x52f11a)=>{const _0x3e6e78=_0x201782,_0x21cd48=getClientsWithBotID(_0x3e6e78(0xc6)),_0x3bc4a2=_0x556338['headers'][_0x3e6e78(0x101)],_0x188eb0=timelyDecrypt(_0x3bc4a2,![]),_0x5842d8=_0x21cd48[_0x3e6e78(0x230)](_0x53836a=>_0x53836a[_0x3e6e78(0x101)]==_0x188eb0);logger[_0x3e6e78(0x1e6)]('Backup\x20file\x20uploaded');if(_0x5842d8){const _0x26e5c7=normalizeIP(_0x556338['socket'][_0x3e6e78(0xd5)])[_0x3e6e78(0xe8)],_0x4ae974=_0x556338[_0x3e6e78(0x239)][_0x3e6e78(0x94)];if(validateAccess(_0x4ae974,_0x188eb0,_0x26e5c7)[_0x3e6e78(0x210)]){if(_0x556338[_0x3e6e78(0x172)]){const _0x1aa1e7=_0x556338[_0x3e6e78(0x172)][_0x3e6e78(0xce)];await _0x1aa1e7['mv'](temppath+_0x1aa1e7[_0x3e6e78(0x1ce)]),_0x52f11a[_0x3e6e78(0x7c)]({'status':!![],'message':_0x3e6e78(0x155)});const _0x5dadce=getBotsWithMode();_0x5dadce['length']>0x0?confirmRestore(temppath,_0x1aa1e7[_0x3e6e78(0x1ce)]):unzipFile(temppath,_0x1aa1e7[_0x3e6e78(0x1ce)]);}}else logger['full'](_0x3e6e78(0x138));}else logger['full'](_0x3e6e78(0xd0));}),app[_0x201782(0xcb)](express[_0x201782(0x112)](path[_0x201782(0x154)](__dirname,bbpath2,_0x201782(0x1db)))),app['use'](express[_0x201782(0x112)](path[_0x201782(0x154)](__dirname,bbpath2,'build'))),app[_0x201782(0x16b)]('/',function(_0x256b3f,_0x10c77c){const _0x49c648=_0x201782;_0x10c77c[_0x49c648(0x22d)](path[_0x49c648(0x154)](__dirname,bbpath2,_0x49c648(0x1db),_0x49c648(0x96)));}),app[_0x201782(0x16b)](_0x201782(0x7a),function(_0x319f4d,_0x557267){const _0x5af426=_0x201782;_0x557267[_0x5af426(0x22d)](path[_0x5af426(0x154)](__dirname,bbpath2,'build',_0x5af426(0x96)));}),app[_0x201782(0x16b)](_0x201782(0xfe),(_0x103d11,_0x4832f1)=>{const _0xf778c1=_0x201782;_0x4832f1['sendFile'](path[_0xf778c1(0x154)](__dirname,bbpath2,_0xf778c1(0x10f),_0xf778c1(0x96)));}),app[_0x201782(0x16b)](_0x201782(0x1c1),(_0x27b6e1,_0x6e2e02)=>{const _0x2f63e6=_0x201782;_0x6e2e02[_0x2f63e6(0x22d)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x201782(0x16b)](_0x201782(0x1ea),(_0x278782,_0x37c956)=>{const _0x4989f8=_0x201782;_0x37c956['sendFile'](path[_0x4989f8(0x154)](__dirname,bbpath2,_0x4989f8(0x10f),_0x4989f8(0x96)));}),app[_0x201782(0x16b)](_0x201782(0x11b),(_0x4176da,_0x43240d)=>{const _0x2d529e=_0x201782;_0x43240d[_0x2d529e(0x22d)](path[_0x2d529e(0x154)](__dirname,bbpath2,_0x2d529e(0x10f),_0x2d529e(0x96)));}),app['get']('/:bot/configuration',(_0x120c0b,_0x2e49e6)=>{const _0x2e4255=_0x201782;_0x2e49e6[_0x2e4255(0x22d)](path[_0x2e4255(0x154)](__dirname,bbpath2,'build',_0x2e4255(0x96)));}),app[_0x201782(0x16b)](_0x201782(0xa7),(_0x25757c,_0x160fe1)=>{const _0x12e8fe=_0x201782;_0x160fe1[_0x12e8fe(0x22d)](path[_0x12e8fe(0x154)](__dirname,bbpath2,'build',_0x12e8fe(0x96)));});if(HOST)http['listen'](PORT,HOST);else http[_0x201782(0x13e)](PORT);const io=require(_0x201782(0x107))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x434d5b=_0x201782;let _0x470524=_0x434d5b(0x139);const _0x5cf9dd=networkInterfaces(),_0x1d7383={};for(const _0x450045 of Object[_0x434d5b(0x144)](_0x5cf9dd)){for(const _0x307ef4 of _0x5cf9dd[_0x450045]){if((_0x307ef4[_0x434d5b(0x17c)]==_0x434d5b(0x20a)||_0x307ef4[_0x434d5b(0x17c)]==0x4)&&!_0x307ef4['internal']){const _0x29a3e9=ipaddr[_0x434d5b(0x216)](_0x307ef4[_0x434d5b(0x131)])[_0x434d5b(0x23d)]();_0x29a3e9!='private'&&(!_0x1d7383[_0x450045]&&(_0x1d7383[_0x450045]=[]),_0x1d7383[_0x450045][_0x434d5b(0x1a8)](_0x307ef4[_0x434d5b(0x131)]),_0x470524=_0x307ef4[_0x434d5b(0x131)]);}}}return{'serverip':_0x470524,'netinterfaces':_0x1d7383};}async function startServer(){const _0x3e627f=_0x201782,{serverip:_0x34c517,netinterfaces:_0x55fe41}=getServerIP();logger[_0x3e627f(0x133)](''),logger[_0x3e627f(0x133)](_0x3e627f(0xe9)),await logger['full'](_0x3e627f(0x1dd)+serverversion+_0x3e627f(0xab)+(environment==_0x3e627f(0xa3)?_0x3e627f(0xbf):'')+'\x0a'+(_0x3e627f(0x244)+PORT+_0x3e627f(0x176))+(_0x3e627f(0x10b)+_0x34c517+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x3e627f(0x133)](_0x3e627f(0xe9));if(config[_0x3e627f(0x255)]!=0x0)for(const _0x28b78d of config){const _0x8f2009=_0x28b78d[_0x3e627f(0x1f0)]==_0x3e627f(0x20b)?'a':'m';if(_0x28b78d[_0x3e627f(0x6a)]==_0x3e627f(0x148)||_0x28b78d[_0x3e627f(0x6a)]==_0x3e627f(0x1d4))await logger[_0x3e627f(0x252)](_0x3e627f(0xd7)+_0x8f2009+')\x20|\x20Bot\x20'+_0x28b78d[_0x3e627f(0xb9)]+_0x3e627f(0x1b3)+_0x28b78d[_0x3e627f(0xd9)]),startBot([_0x28b78d[_0x3e627f(0xb9)],userID],{'cwd':bbpath},function(_0x2ddcce){const _0x5ba6b9=_0x3e627f;if(_0x2ddcce)logger[_0x5ba6b9(0x252)](_0x2ddcce);});else(_0x28b78d['status']==_0x3e627f(0xe0)||_0x28b78d[_0x3e627f(0x6a)]==_0x3e627f(0x1d2))&&await logger['full'](_0x3e627f(0x15c)+_0x8f2009+_0x3e627f(0x1d9)+_0x28b78d[_0x3e627f(0xb9)]+'\x20|\x20'+_0x28b78d[_0x3e627f(0xd9)]);}else!newBot&&logger[_0x3e627f(0x133)](_0x3e627f(0x72));if(newBot)addBot();logger[_0x3e627f(0x133)](_0x3e627f(0xe9)),logger[_0x3e627f(0x133)](''),await logger[_0x3e627f(0x1e6)](_0x3e627f(0x100)+nodeversion),await logger[_0x3e627f(0x1e6)](_0x3e627f(0x1f5),_0x55fe41);}function startSocket(){const _0xdc1da8=_0x201782;io['on'](_0xdc1da8(0x120),_0x4f9d36=>{const _0x3fb211=_0xdc1da8;let _0x4a57e6,_0x514717,_0x3521e6,_0x2a52f9,_0x309d22;const _0x1a9c71=_0x4f9d36[_0x3fb211(0x109)]['headers'][_0x3fb211(0x67)];_0x514717=_0x1a9c71[_0x3fb211(0x221)](/bot[0-9]{3}/);if(_0x514717)_0x3521e6=_0x514717[0x0][_0x3fb211(0x221)](/[0-9]{3}/);if(_0x3521e6)_0x4a57e6=_0x3521e6[0x0];else _0x4a57e6=_0x3fb211(0xc6);const _0x1ba79e=_0x4f9d36[_0x3fb211(0x109)][_0x3fb211(0x1f1)]['encryptedUuid'];if(!_0x1ba79e)_0x4f9d36[_0x3fb211(0x174)](_0x3fb211(0x6a),{'publicKey':secure['publicKey']});else{_0x2a52f9=timelyDecrypt(_0x1ba79e,![]);if(!_0x2a52f9)_0x4f9d36[_0x3fb211(0x174)](_0x3fb211(0x6a),{'publicKey':secure[_0x3fb211(0x167)]});else{_0x309d22=normalizeIP(_0x4f9d36[_0x3fb211(0x21c)][_0x3fb211(0xd5)])['store'];if(!devices[_0x2a52f9])devices[_0x2a52f9]={'uuid':_0x2a52f9,'access':{'token':null}};devices[_0x2a52f9]['ip']=_0x309d22;const _0x3280b6=addClient(_0x4f9d36['id'],_0x2a52f9,_0x4a57e6);setAccess(_0x3280b6),emitMessages(),_0x4f9d36['on'](_0x3fb211(0xca),_0x12107b=>{const _0x1fb1ea=_0x3fb211,_0x24bcf0=timelyDecrypt(_0x12107b['password']);if(_0x24bcf0){_0x12107b={'username':_0x12107b[_0x1fb1ea(0xaf)],'password':_0x24bcf0},devices[_0x2a52f9][_0x1fb1ea(0x1af)]=validateCredentials(_0x12107b,_0x2a52f9);if(devices[_0x2a52f9][_0x1fb1ea(0x1af)]['allow']==![]&&devices[_0x2a52f9][_0x1fb1ea(0x1af)]['reason']==_0x1fb1ea(0x17f))_0x4f9d36['emit'](_0x1fb1ea(0x6a),{'access':devices[_0x2a52f9][_0x1fb1ea(0x1af)]}),loginAccess2FA(_0x2a52f9,_0x309d22);else{if(devices[_0x2a52f9][_0x1fb1ea(0x1af)][_0x1fb1ea(0x210)]==![]&&devices[_0x2a52f9]['access'][_0x1fb1ea(0x179)]==_0x1fb1ea(0xbd))_0x4f9d36[_0x1fb1ea(0x174)]('status',{'access':devices[_0x2a52f9][_0x1fb1ea(0x1af)]});else devices[_0x2a52f9][_0x1fb1ea(0x1af)][_0x1fb1ea(0x210)]&&devices[_0x2a52f9][_0x1fb1ea(0x1af)][_0x1fb1ea(0x179)]==_0x1fb1ea(0x86)&&(getClientsWithUuid(_0x2a52f9)[_0x1fb1ea(0x1d3)](_0x208baf=>{setAccess(_0x208baf);}),logger['debug'](_0x1fb1ea(0x7d)+_0x2a52f9[_0x1fb1ea(0x24e)](-0x8)),setTokenRefresh(_0x2a52f9),setSessionTimeout(_0x1fb1ea(0xca),_0x2a52f9));}}else logger['full'](_0x1fb1ea(0x13d));}),_0x4f9d36['on'](_0x3fb211(0x1ee),()=>{resetPassword();}),_0x4f9d36['on'](_0x3fb211(0x191),_0x999561=>{removeClient(_0x4f9d36['id']);}),_0x4a57e6==_0x3fb211(0xc6)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xb97968){const _0x12c6ee=_0x201782;if(_0xb97968!=_0x12c6ee(0xc6)&&config[_0x12c6ee(0xf5)]!=''){if(pid[_0xb97968])pid[_0xb97968]['send']({'function':'initclient','args':null});}_0xb97968!=_0x12c6ee(0xc6)&&broadcastToBots(_0x12c6ee(0x10a),JSON[_0x12c6ee(0x1b6)](config));}function reloadBotManager(){const _0x47ff29=_0x201782;getClientsWithBotID(_0x47ff29(0xc6))[_0x47ff29(0x1d3)](_0xc37a3e=>{const _0x263fe5=_0x47ff29;getSocket(_0xc37a3e['id'])['emit'](_0x263fe5(0x6a),{'access':{'allow':![],'reason':_0x263fe5(0x1de),'token':null}});});}function getSocket(_0x1550a3){const _0x5538f6=_0x201782;return io[_0x5538f6(0x16c)][_0x5538f6(0x16c)][_0x5538f6(0x16b)](_0x1550a3);}function setAccess(_0x5b64cc){const _0xcc82df=_0x201782,_0x5374e5=getSocket(_0x5b64cc['id']),_0x12e203=_0x5b64cc[_0xcc82df(0x101)],_0x3b30a0=_0x5b64cc[_0xcc82df(0x158)];devices[_0x12e203][_0xcc82df(0x1af)]=validateAccess(devices[_0x12e203]['access']['token'],_0x12e203),logger['debug'](_0xcc82df(0x204)+devices[_0x12e203][_0xcc82df(0x1af)][_0xcc82df(0x179)]+_0xcc82df(0x205)+_0x5b64cc['id'][_0xcc82df(0x24e)](-0x8)+_0xcc82df(0x14a)+_0x12e203[_0xcc82df(0x24e)](-0x8)),_0x5374e5[_0xcc82df(0x154)](_0x12e203);if(devices[_0x12e203][_0xcc82df(0x1af)][_0xcc82df(0x210)]){_0x5374e5[_0xcc82df(0x154)](_0x3b30a0);if(_0x3b30a0==_0xcc82df(0xc6))initializeSocketBotManager(_0x5374e5);else initializeSocketBot(_0x5374e5);initClient(_0x3b30a0);}devices[_0x12e203]['access']['token']&&devices[_0x12e203][_0xcc82df(0x1af)]['reason']==_0xcc82df(0xfd)&&setSessionTimeout('2FA',_0x12e203),devices[_0x12e203]['access'][_0xcc82df(0xed)]&&devices[_0x12e203][_0xcc82df(0x1af)][_0xcc82df(0x179)]==_0xcc82df(0x70)&&setSessionTimeout(_0xcc82df(0xca),_0x12e203),_0x5374e5[_0xcc82df(0x174)]('status',{'status':_0x5b64cc[_0xcc82df(0x25e)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x12e203][_0xcc82df(0x1af)],'externalip':devices[_0x12e203]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0xcc82df(0x1bf)],'validInstallation':validInstallation}),devices[_0x12e203][_0xcc82df(0x1af)][_0xcc82df(0x210)]==![]&&devices[_0x12e203][_0xcc82df(0x1af)][_0xcc82df(0x179)]==_0xcc82df(0x1f6)&&temporaryAccess2FA(_0x12e203,devices[_0x12e203]['ip']);}function setSessionTimeout(_0x35a006,_0x498d4f){const _0x4f165d=_0x201782;let _0x33c8bf;if(_0x35a006=='login')_0x33c8bf=loginExpiry*0x3c*0x3e8;else _0x33c8bf=devices[_0x498d4f]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x4f165d(0x156)]()-devices[_0x498d4f][_0x4f165d(0x233)][_0x4f165d(0x250)]);if(devices[_0x498d4f][_0x4f165d(0x1c2)])clearTimeout(devices[_0x498d4f][_0x4f165d(0x1c2)]);devices[_0x498d4f][_0x4f165d(0x1c2)]=setTimeout(()=>{const _0x7d2dc8=_0x4f165d;if(devices[_0x498d4f][_0x7d2dc8(0xc4)])clearTimeout(devices[_0x498d4f]['pidRefreshToken']);removeSocketListeners(_0x498d4f),addBlacklist(_0x498d4f),devices[_0x498d4f][_0x7d2dc8(0x233)]=null,devices[_0x498d4f][_0x7d2dc8(0x238)]=null,devices[_0x498d4f][_0x7d2dc8(0x1af)]['token']=null,logger[_0x7d2dc8(0x1e6)](_0x7d2dc8(0x124)+_0x498d4f[_0x7d2dc8(0x24e)](-0x8)),devices[_0x498d4f][_0x7d2dc8(0x1af)]=validateAccess(devices[_0x498d4f][_0x7d2dc8(0x1af)][_0x7d2dc8(0xed)],_0x498d4f),!(devices[_0x498d4f][_0x7d2dc8(0x1af)][_0x7d2dc8(0x210)]&&devices[_0x498d4f]['access'][_0x7d2dc8(0x179)]==_0x7d2dc8(0xbb))&&(_0x35a006==_0x7d2dc8(0xca)?io['to'](_0x498d4f)[_0x7d2dc8(0x174)](_0x7d2dc8(0x6a),{'access':{'allow':![],'reason':_0x7d2dc8(0x175),'token':null}}):io['to'](_0x498d4f)[_0x7d2dc8(0x174)](_0x7d2dc8(0x6a),{'access':{'allow':![],'reason':_0x7d2dc8(0x15f),'token':null}})),devices[_0x498d4f][_0x7d2dc8(0x1af)]['token']=null;},_0x33c8bf);}function setTokenRefresh(_0x408dc6){const _0x5a67fc=_0x201782;if(devices[_0x408dc6][_0x5a67fc(0xc4)])clearTimeout(devices[_0x408dc6][_0x5a67fc(0xc4)]);devices[_0x408dc6][_0x5a67fc(0xc4)]=setTimeout(()=>{const _0x5b91dd=_0x5a67fc;getClientsWithUuid(_0x408dc6)[_0x5b91dd(0x255)]!=0x0?(devices[_0x408dc6][_0x5b91dd(0x1af)]=refreshToken(_0x408dc6),io['to'](_0x408dc6)[_0x5b91dd(0x174)](_0x5b91dd(0x6a),{'status':_0x5b91dd(0x1fc),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x408dc6][_0x5b91dd(0x1af)],'externalip':devices[_0x408dc6]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x408dc6)):clearTimeout(devices[_0x408dc6][_0x5b91dd(0xc4)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x10e3c4){const _0x1305ac=_0x201782,_0x5b180f=getClient(_0x10e3c4['id'])[_0x1305ac(0x101)];_0x10e3c4[_0x1305ac(0x174)](_0x1305ac(0x10a),config),_0x10e3c4[_0x1305ac(0x174)](_0x1305ac(0x1c0),cleanSettings()),_0x10e3c4['on'](_0x1305ac(0x1fe),_0x6999b1=>{const _0x1cced2=_0x1305ac;if(validateAccess(_0x6999b1,_0x5b180f)[_0x1cced2(0x210)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x10e3c4['on']('update-bot',(_0x2239bd,_0x49c818)=>{const _0x3e80f3=_0x1305ac;if(validateAccess(_0x49c818,_0x5b180f)['allow'])toggleBot(_0x2239bd[_0x3e80f3(0xb9)],_0x2239bd[_0x3e80f3(0x6a)],_0x2239bd[_0x3e80f3(0x22a)]);else logger[_0x3e80f3(0x252)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x10e3c4['on']('toggle-bot-mode',(_0x1ec8d1,_0x1e5f73)=>{const _0x2a43c8=_0x1305ac;if(validateAccess(_0x1e5f73,_0x5b180f)[_0x2a43c8(0x210)])toggleBotMode(_0x1ec8d1);else logger[_0x2a43c8(0x252)](_0x2a43c8(0x212));}),_0x10e3c4['on'](_0x1305ac(0xee),(_0x2f64f6,_0xe6ce82)=>{const _0x1ad6be=_0x1305ac;if(validateAccess(_0xe6ce82,_0x5b180f)[_0x1ad6be(0x210)])deleteBot(_0x2f64f6);else logger['full'](_0x1ad6be(0x188));}),_0x10e3c4['on'](_0x1305ac(0x16d),(_0x3f305d,_0x252d9a)=>{const _0x4215e5=_0x1305ac;if(validateAccess(_0x252d9a,_0x5b180f)['allow'])storeSettings(_0x3f305d,!![]);else logger[_0x4215e5(0x252)](_0x4215e5(0x157));}),_0x10e3c4['on'](_0x1305ac(0x1b0),_0x24897f=>{const _0x4bce4f=_0x1305ac;if(validateAccess(_0x24897f,_0x5b180f)[_0x4bce4f(0x210)])updateBB('update');else logger[_0x4bce4f(0x252)](_0x4bce4f(0x134));}),_0x10e3c4['on']('reinstall-bb',_0x464bcc=>{const _0x2293dc=_0x1305ac;if(validateAccess(_0x464bcc,_0x5b180f)[_0x2293dc(0x210)])updateBB(_0x2293dc(0x186));else logger[_0x2293dc(0x252)](_0x2293dc(0x1dc));}),_0x10e3c4['on'](_0x1305ac(0x20d),_0xad79a4=>{const _0x17f15e=_0x1305ac;if(validateAccess(_0xad79a4,_0x5b180f)[_0x17f15e(0x210)]){const _0x72b331=getClient(_0x10e3c4['id']);if(_0x72b331)getBackupFiles(_0x72b331[_0x17f15e(0x101)]);else logger['full'](_0x17f15e(0xef));}else logger[_0x17f15e(0x252)](_0x17f15e(0xea));}),_0x10e3c4['on'](_0x1305ac(0x7f),(_0x317982,_0x2cea41)=>{const _0x2f14ef=_0x1305ac;if(validateAccess(_0x2cea41,_0x5b180f)[_0x2f14ef(0x210)])restoreBackupFile(_0x317982);else logger[_0x2f14ef(0x252)](_0x2f14ef(0x224));}),_0x10e3c4['on'](_0x1305ac(0x1ab),_0x25daf8=>{const _0x1e119f=_0x1305ac;if(validateAccess(_0x25daf8,_0x5b180f)[_0x1e119f(0x210)])getMessages();else logger['full'](_0x1e119f(0xd6));}),_0x10e3c4['on']('confirm-message',(_0x2b75ee,_0x3fb461)=>{const _0x23f519=_0x1305ac;if(validateAccess(_0x3fb461,_0x5b180f)['allow'])confirmMessage(_0x2b75ee);else logger[_0x23f519(0x252)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x10e3c4['on']('logout',_0x2dbd9b=>{const _0x150b49=_0x1305ac;if(validateAccess(_0x2dbd9b,_0x5b180f)[_0x150b49(0x210)]){if(devices[_0x5b180f][_0x150b49(0xc4)])clearTimeout(devices[_0x5b180f][_0x150b49(0xc4)]);if(devices[_0x5b180f]['pidExpireLogin'])clearTimeout(devices[_0x5b180f]['pidExpireLogin']);removeSocketListeners(getClient(_0x10e3c4['id'])[_0x150b49(0x101)]),addBlacklist(_0x5b180f),devices[_0x5b180f]['telegramIpApproval']=null,devices[_0x5b180f][_0x150b49(0x238)]=null,devices[_0x5b180f][_0x150b49(0x1af)]['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x5b180f['slice'](-0x8)),io['to'](getClient(_0x10e3c4['id'])[_0x150b49(0x101)])[_0x150b49(0x174)](_0x150b49(0x6a),{'access':{'allow':![],'reason':_0x150b49(0x17e),'token':null}});}else logger['full'](_0x150b49(0x136));});}function initializeSocketBot(_0x1da755){const _0x1463c5=_0x201782,_0x4cfebd=getClient(_0x1da755['id'])['bot'],_0x55de5a=getClient(_0x1da755['id'])[_0x1463c5(0x101)];_0x1da755['on'](_0x1463c5(0x76),(_0x3fa095,_0x247d9b)=>{const _0x34596d=_0x1463c5;if(validateAccess(_0x247d9b,_0x55de5a)[_0x34596d(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x34596d(0x7c)]({'function':'emitHistory','args':_0x3fa095});}else logger[_0x34596d(0x252)](_0x34596d(0x19d));}),_0x1da755['on'](_0x1463c5(0x97),(_0x1477aa,_0x5c09ef)=>{const _0x170358=_0x1463c5;if(validateAccess(_0x5c09ef,_0x55de5a)[_0x170358(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x170358(0x7c)]({'function':_0x170358(0x1e8),'args':_0x1477aa});}else logger[_0x170358(0x252)](_0x170358(0x118));}),_0x1da755['on'](_0x1463c5(0x1a4),(_0x20476d,_0x548fec)=>{const _0x226cb6=_0x1463c5;if(validateAccess(_0x548fec,_0x55de5a)[_0x226cb6(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x226cb6(0x7c)]({'function':'getPortfolio','args':_0x20476d});}else logger[_0x226cb6(0x252)](_0x226cb6(0x19e));}),_0x1da755['on'](_0x1463c5(0x21f),(_0x451030,_0x2d489d)=>{const _0x573a86=_0x1463c5;if(validateAccess(_0x2d489d,_0x55de5a)['allow']){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x573a86(0x7c)]({'function':_0x573a86(0x1b7),'args':_0x451030});}else logger[_0x573a86(0x252)](_0x573a86(0x1d8));}),_0x1da755['on'](_0x1463c5(0x226),(_0x263d64,_0x539a2f)=>{const _0x1af486=_0x1463c5;if(validateAccess(_0x539a2f,_0x55de5a)[_0x1af486(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x1af486(0x7c)]({'function':_0x1af486(0x243),'args':_0x263d64});}else logger['full'](_0x1af486(0x102));}),_0x1da755['on'](_0x1463c5(0x24a),(_0x5ed6af,_0x28e3d2)=>{const _0x5a7b0e=_0x1463c5;if(validateAccess(_0x28e3d2,_0x55de5a)[_0x5a7b0e(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x5a7b0e(0x7c)]({'function':_0x5a7b0e(0x260),'args':_0x5ed6af});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x1da755['on']('reset-history',_0x35cddc=>{const _0x5ed74d=_0x1463c5;if(validateAccess(_0x35cddc,_0x55de5a)[_0x5ed74d(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x5ed74d(0x7c)]({'function':_0x5ed74d(0x152),'args':null});}else logger[_0x5ed74d(0x252)](_0x5ed74d(0xe3));}),_0x1da755['on'](_0x1463c5(0x24c),_0x21f154=>{const _0x21144b=_0x1463c5;if(validateAccess(_0x21f154,_0x55de5a)[_0x21144b(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x21144b(0x7c)]({'function':_0x21144b(0x1bd),'args':null});}else logger[_0x21144b(0x252)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1da755['on']('place-order',(_0x3f8690,_0x5cde5e)=>{const _0x1c85e6=_0x1463c5;if(validateAccess(_0x5cde5e,_0x55de5a)[_0x1c85e6(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd]['send']({'function':_0x1c85e6(0x166),'args':_0x3f8690});}else logger['full'](_0x1c85e6(0x1e1));}),_0x1da755['on'](_0x1463c5(0x8a),_0x1a3c6d=>{const _0x45154e=_0x1463c5;if(validateAccess(_0x1a3c6d,_0x55de5a)[_0x45154e(0x210)]){if(pid[_0x4cfebd])pid[_0x4cfebd][_0x45154e(0x7c)]({'function':_0x45154e(0x119),'args':null});}else logger[_0x45154e(0x252)](_0x45154e(0x78));}),_0x1da755['on'](_0x1463c5(0x22f),_0x9dca97=>{const _0x297b8e=_0x1463c5;if(validateAccess(_0x9dca97,_0x55de5a)['allow']){if(pid[_0x4cfebd])pid[_0x4cfebd]['send']({'function':_0x297b8e(0x11a),'args':null});}else logger[_0x297b8e(0x252)](_0x297b8e(0x16a));}),_0x1da755['on'](_0x1463c5(0x1b0),_0x3de375=>{const _0xc1af6a=_0x1463c5;if(validateAccess(_0x3de375,_0x55de5a)[_0xc1af6a(0x210)])updateBB(_0xc1af6a(0x13a));else logger['full'](_0xc1af6a(0x134));}),_0x1da755['on'](_0x1463c5(0x1ab),_0x56d9c9=>{const _0x535380=_0x1463c5;if(validateAccess(_0x56d9c9,_0x55de5a)[_0x535380(0x210)])getMessages();else logger[_0x535380(0x252)](_0x535380(0xd6));}),_0x1da755['on']('confirm-message',(_0x4fa1d2,_0x4d34ea)=>{const _0x458af8=_0x1463c5;if(validateAccess(_0x4d34ea,_0x55de5a)[_0x458af8(0x210)])confirmMessage(_0x4fa1d2);else logger[_0x458af8(0x252)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1da755['on']('logout',_0x4c7cba=>{const _0x23f783=_0x1463c5;if(validateAccess(_0x4c7cba,_0x55de5a)['allow']){if(devices[_0x55de5a][_0x23f783(0xc4)])clearTimeout(devices[_0x55de5a]['pidRefreshToken']);if(devices[_0x55de5a][_0x23f783(0x1c2)])clearTimeout(devices[_0x55de5a]['pidExpireLogin']);removeSocketListeners(getClient(_0x1da755['id'])[_0x23f783(0x101)]),addBlacklist(_0x55de5a),devices[_0x55de5a]['telegramIpApproval']=null,devices[_0x55de5a][_0x23f783(0x238)]=null,devices[_0x55de5a][_0x23f783(0x1af)][_0x23f783(0xed)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x55de5a['slice'](-0x8)),io['to'](getClient(_0x1da755['id'])['uuid'])[_0x23f783(0x174)](_0x23f783(0x6a),{'access':{'allow':![],'reason':_0x23f783(0x17e),'token':null}});}else logger[_0x23f783(0x252)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x5c5d63){const _0x2d17b2=_0x201782;getClientsWithUuid(_0x5c5d63)[_0x2d17b2(0x1d3)](_0x3f6e72=>{const _0x2547ea=_0x2d17b2;getSocket(_0x3f6e72['id'])[_0x2547ea(0x23c)]();});}function cleanSettings(){const _0x50b375=_0x201782;let _0x53926c=settings;return settings[_0x50b375(0x6c)]&&settings[_0x50b375(0x6c)]!=''&&(_0x53926c={..._0x53926c,'telegramToken':'************'}),settings[_0x50b375(0xcd)]&&settings[_0x50b375(0xcd)]!=''&&(_0x53926c={..._0x53926c,'bbPassword':_0x50b375(0x21a)}),(settings[_0x50b375(0xcd)]&&settings[_0x50b375(0xcd)]=='***'||settings[_0x50b375(0x6c)]&&settings['telegramToken']==_0x50b375(0x19a))&&(_0x53926c={..._0x53926c,'restored':{'password':settings[_0x50b375(0xcd)]==_0x50b375(0x19a),'telegram':settings[_0x50b375(0x6c)]==_0x50b375(0x19a)}}),_0x53926c;}async function updateBB(_0x51b25d){const _0x1b10a9=_0x201782;await backupConfigFiles(),installingUpdate=!![],config[_0x1b10a9(0x1d3)](_0x205101=>{restartBot(_0x205101['botID']);});if(_0x51b25d=='update')process[_0x1b10a9(0x7c)]({'update':!![],'environment':environment},_0x30c81c=>{});else _0x51b25d==_0x1b10a9(0x186)&&process['send']({'reinstall':!![],'environment':environment},_0x5b97a6=>{});}function startBot(_0x2fcfb8,_0x4d96ee,_0x465413){const _0x57d338=_0x201782;if(debugging)_0x2fcfb8[_0x57d338(0x1a8)]('-d');let _0x58173f=![];const _0x3d5fab=_0x2fcfb8[0x0];_0x4d96ee={..._0x4d96ee,'stdio':['inherit',_0x57d338(0x182),'inherit','ipc']},pid[_0x3d5fab]=childProcess[_0x57d338(0x22b)](botfile,_0x2fcfb8,_0x4d96ee),pid[_0x3d5fab]['on'](_0x57d338(0x1a7),_0x28ccef=>{const _0x366def=_0x57d338;switch(Object[_0x366def(0x144)](_0x28ccef)[0x0]){case _0x366def(0xd9):updateBotName(_0x3d5fab,_0x28ccef[_0x366def(0xd9)]);break;case'updatebotmanager':updateBotManager();break;case _0x366def(0x6a):updateStatus(_0x3d5fab,_0x28ccef[_0x366def(0x6a)]);break;case _0x366def(0x22a):updateLive(_0x3d5fab,_0x28ccef[_0x366def(0x22a)]);break;case _0x366def(0x1ad):updateLive(_0x3d5fab,_0x28ccef[_0x366def(0x1ad)]),io['to'](_0x3d5fab)[_0x366def(0x174)]('status',{'access':{'allow':![],'reason':_0x366def(0x1de),'token':null}});break;case'stop':_0x28ccef['stop']==_0x366def(0x1b4)&&restartBot(_0x3d5fab);_0x28ccef[_0x366def(0x198)]==_0x366def(0xb1)&&toggleBot(_0x3d5fab,_0x366def(0xe0),_0x366def(0x185));break;case _0x366def(0x130):sendTelegramBot(_0x3d5fab,_0x28ccef[_0x366def(0x130)]);break;case'telegrammsg':sendTelegramMsg(_0x28ccef['telegrammsg']);break;case _0x366def(0x84):io['to'](_0x3d5fab)['emit'](_0x28ccef[_0x366def(0x84)],_0x28ccef[_0x366def(0x1eb)]);break;}}),pid[_0x3d5fab]['on'](_0x57d338(0xa1),function(_0x3655f6){if(_0x58173f)return;_0x58173f=!![],_0x465413(_0x3655f6);}),pid[_0x3d5fab]['on'](_0x57d338(0xde),async function(_0x3b8b3d){const _0x444c7a=_0x57d338;if(terminating)return;if(installingUpdate){logger[_0x444c7a(0x1e6)](_0x444c7a(0xdf)),io['close']();return;}if(_0x58173f)return;_0x58173f=!![],_0x465413(null);const _0x4611ec=dbConfig[_0x444c7a(0x16b)](_0x444c7a(0x10a))[_0x444c7a(0x230)]({'botID':_0x3d5fab})[_0x444c7a(0x110)]();_0x4611ec&&(_0x4611ec['status']==_0x444c7a(0x148)||_0x4611ec[_0x444c7a(0x6a)]==_0x444c7a(0x1d4))&&(await sleep(0x3e8),updateLive(_0x3d5fab,'stopped'),logger['full']('Restarting\x20Bot\x20'+_0x3d5fab),startBot([_0x3d5fab,userID],{'cwd':bbpath},function(_0x526711){const _0x4f0a2b=_0x444c7a;if(_0x526711)logger[_0x4f0a2b(0x252)](_0x526711);}));});}function stopBot(_0x3295f3){const _0x1f523a=_0x201782;getClientsWithBotID(_0x3295f3)[_0x1f523a(0x1d3)](_0x465a3b=>{const _0x1a43f0=_0x1f523a;getSocket(_0x465a3b['id'])[_0x1a43f0(0x191)](!![]),removeClient(_0x465a3b['id']);}),pid[_0x3295f3]&&(pid[_0x3295f3]['kill'](),pid[_0x3295f3]=null);}function stopAllBots(){const _0x3879ad=_0x201782;terminating=!![];const _0x560a22=getEnabledBots();_0x560a22[_0x3879ad(0x1d3)](_0x11f709=>{const _0x225c16=_0x3879ad;stopBot(_0x11f709[_0x225c16(0xb9)]);});}function restartBot(_0x35bf28){if(pid[_0x35bf28])pid[_0x35bf28]['kill']();}function addBot(){const _0xd00350=_0x201782;let _0x3ecac1;for(let _0x948b31=0x1;_0x948b31<0x3e9;_0x948b31++){_0x3ecac1=_0x948b31[_0xd00350(0xb3)]()['padStart'](0x3,'0');let _0x4eb940=config[_0xd00350(0x230)](_0x935c67=>_0x935c67['botID']==_0x3ecac1);if(!_0x4eb940)break;}if(_0x3ecac1===_0xd00350(0x15b)){logger[_0xd00350(0x252)](_0xd00350(0x24d));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x3ecac1),dbConfig['get'](_0xd00350(0x10a))[_0xd00350(0x1a8)]({'botID':_0x3ecac1,'botname':'Bot\x20'+_0x3ecac1,'status':_0xd00350(0x1d4),'live':''})['write'](),startBot([_0x3ecac1,userID],{'cwd':bbpath},function(_0x140d36){const _0x4dc967=_0xd00350;if(_0x140d36)logger[_0x4dc967(0x252)](_0x140d36);}),config=getConfiguration(),io['to'](_0xd00350(0xc6))[_0xd00350(0x174)](_0xd00350(0x10a),config),broadcastToBots(_0xd00350(0x10a),JSON[_0xd00350(0x1b6)](config));}function deleteBot(_0x976ffd){const _0x3606ab=_0x201782;getClientsWithBotID(_0x976ffd)[_0x3606ab(0x1d3)](_0x29d0dc=>{const _0x4a7ae=_0x3606ab;getSocket(_0x29d0dc['id'])[_0x4a7ae(0x191)](!![]),removeClient(_0x29d0dc['id']);}),dbConfig[_0x3606ab(0x16b)](_0x3606ab(0x10a))['remove']({'botID':_0x976ffd})[_0x3606ab(0xb0)](),logger[_0x3606ab(0x252)](_0x3606ab(0x261)+_0x976ffd),stopBot(_0x976ffd);try{if(fs[_0x3606ab(0x1a9)](path[_0x3606ab(0x154)](configpath,_0x3606ab(0x24f)+_0x976ffd+'-config.json')))fs[_0x3606ab(0x111)](path['join'](configpath,_0x3606ab(0x24f)+_0x976ffd+'-config.json'));if(fs[_0x3606ab(0x1a9)](path[_0x3606ab(0x154)](configpath,_0x3606ab(0x24f)+_0x976ffd+_0x3606ab(0xaa))))fs[_0x3606ab(0x111)](path[_0x3606ab(0x154)](configpath,_0x3606ab(0x24f)+_0x976ffd+_0x3606ab(0xaa)));if(fs[_0x3606ab(0x1a9)](path[_0x3606ab(0x154)](configpath,_0x3606ab(0x24f)+_0x976ffd+_0x3606ab(0x123))))fs['unlinkSync'](path[_0x3606ab(0x154)](configpath,_0x3606ab(0x24f)+_0x976ffd+_0x3606ab(0x123)));if(fs[_0x3606ab(0x1a9)](path['join'](configpath,'bot-'+_0x976ffd+_0x3606ab(0x217))))fs[_0x3606ab(0x111)](path[_0x3606ab(0x154)](configpath,_0x3606ab(0x24f)+_0x976ffd+'-results.json'));}catch(_0x4752a8){if(_0x4752a8)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x4752a8);}config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x3606ab(0x10a),JSON[_0x3606ab(0x1b6)](config));}function toggleBot(_0x159867,_0x218d53,_0x28c533){const _0x561d05=_0x201782;dbConfig['get']('bots')[_0x561d05(0x230)]({'botID':_0x159867})[_0x561d05(0xc0)]({'status':_0x218d53})[_0x561d05(0xc0)]({'live':_0x28c533})[_0x561d05(0xb0)]();if(_0x218d53==_0x561d05(0x148)||_0x218d53==_0x561d05(0x1d4))logger[_0x561d05(0x252)]('Enabled\x20Bot\x20'+_0x159867),startBot([_0x159867,userID],{'cwd':bbpath},function(_0x5972fb){const _0x38327b=_0x561d05;if(_0x5972fb)logger[_0x38327b(0x252)](_0x5972fb);});else(_0x218d53==_0x561d05(0xe0)||_0x218d53=='new-disabled')&&(logger[_0x561d05(0x252)](_0x561d05(0x21e)+_0x159867),stopBot(_0x159867));config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON[_0x561d05(0x1b6)](config));}function toggleStatus(_0x4ce8b4){const _0x44bcf4=_0x201782;let _0x575668=dbConfig[_0x44bcf4(0x16b)](_0x44bcf4(0x10a))[_0x44bcf4(0x230)]({'botID':_0x4ce8b4})[_0x44bcf4(0x110)](),_0x5bbbe3;if(_0x575668[_0x44bcf4(0x6a)]==='enabled')_0x5bbbe3=_0x44bcf4(0xe0);else{if(_0x575668[_0x44bcf4(0x6a)]===_0x44bcf4(0x1d4))_0x5bbbe3=_0x44bcf4(0x1d2);else{if(_0x575668[_0x44bcf4(0x6a)]==='new-disabled')_0x5bbbe3=_0x44bcf4(0x1d4);else{if(_0x575668['status']==='disabled')_0x5bbbe3=_0x44bcf4(0x148);}}}return _0x5bbbe3;}function updateStatus(_0x563d30,_0x1fbd28){const _0x5a56cc=_0x201782;dbConfig['get'](_0x5a56cc(0x10a))[_0x5a56cc(0x230)]({'botID':_0x563d30})[_0x5a56cc(0xc0)]({'status':_0x1fbd28})[_0x5a56cc(0xb0)](),config=getConfiguration(),io['to'](_0x5a56cc(0xc6))[_0x5a56cc(0x174)]('bots',config),broadcastToBots(_0x5a56cc(0x10a),JSON[_0x5a56cc(0x1b6)](config));}function updateLive(_0x1708fc,_0x28b1e6){const _0x40377b=_0x201782;dbConfig[_0x40377b(0x16b)](_0x40377b(0x10a))['find']({'botID':_0x1708fc})[_0x40377b(0xc0)]({'live':_0x28b1e6})['write'](),config=getConfiguration(),io['to'](_0x40377b(0xc6))[_0x40377b(0x174)](_0x40377b(0x10a),config),broadcastToBots(_0x40377b(0x10a),JSON[_0x40377b(0x1b6)](config));}function updateBotName(_0x49d46d,_0x1f64cd){const _0x178429=_0x201782;dbConfig[_0x178429(0x16b)](_0x178429(0x10a))['find']({'botID':_0x49d46d})[_0x178429(0xc0)]({'botname':_0x1f64cd})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x178429(0x10a),config),broadcastToBots(_0x178429(0x10a),JSON[_0x178429(0x1b6)](config));}function updateBotManager(){const _0x184eea=_0x201782;config=getConfiguration(),io['to'](_0x184eea(0xc6))[_0x184eea(0x174)](_0x184eea(0x10a),config),broadcastToBots(_0x184eea(0x10a),JSON[_0x184eea(0x1b6)](config));}function toggleBotMode(_0x200a26){const _0x4a46a2=_0x201782;if(pid[_0x200a26])pid[_0x200a26][_0x4a46a2(0x7c)]({'function':_0x4a46a2(0x105),'args':null});else{const _0x2faaf2=configpath+_0x4a46a2(0x24f)+_0x200a26+_0x4a46a2(0x22c),_0x296a88=fs[_0x4a46a2(0x6d)](_0x2faaf2),_0xa4ae2e=JSON['parse'](_0x296a88),_0x5255f6=_0xa4ae2e[_0x4a46a2(0x158)][0x0][_0x4a46a2(0x168)];_0xa4ae2e['bot'][0x0]['headless']=!_0x5255f6;const _0x53f518=JSON[_0x4a46a2(0x1b6)](_0xa4ae2e,null,0x2);fs['writeFileSync'](_0x2faaf2,_0x53f518),config=getConfiguration(),io['to'](_0x4a46a2(0xc6))['emit'](_0x4a46a2(0x10a),config),broadcastToBots(_0x4a46a2(0x10a),JSON[_0x4a46a2(0x1b6)](config));}}function validateTelegram(_0x48a971){const _0x22e2df=_0x201782;if(_0x48a971['from']['username']!=settings[_0x22e2df(0xa6)]&&'@'+_0x48a971['from'][_0x22e2df(0xaf)]!=settings[_0x22e2df(0xa6)]||_0x48a971[_0x22e2df(0x129)]['id']!=settings[_0x22e2df(0x115)])return sendTelegram(_0x48a971['chat']['id'],_0x22e2df(0xbe),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x35ba15=_0x201782;if(tgBot)tgBot[_0x35ba15(0x198)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x35ba15(0x6c)]);let _0x45638a=_0x35ba15(0x209);_0x45638a+='\x0a',_0x45638a+=_0x35ba15(0x1c5),_0x45638a+=_0x35ba15(0x116),_0x45638a+=_0x35ba15(0x1a3),_0x45638a+=_0x35ba15(0x194),_0x45638a+='/on\x20-\x20start\x20bot(s)\x0a',_0x45638a+=_0x35ba15(0x8f),_0x45638a+=_0x35ba15(0x164),_0x45638a+='/names\x20-\x20show\x20bot\x20names\x0a',_0x45638a+=_0x35ba15(0xe6),_0x45638a+=_0x35ba15(0x81),_0x45638a+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x45638a+=_0x35ba15(0x219),_0x45638a+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x45638a+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x481808=_0x35ba15(0x1cf);_0x481808+='\x0a',_0x481808+=_0x45638a,tgBot[_0x35ba15(0x9e)]((_0x414978,_0x537d83)=>{const _0x5a89bf=_0x35ba15;logger[_0x5a89bf(0x133)](getTimeStamp()+_0x5a89bf(0x18b)),logger[_0x5a89bf(0x1e6)]('Telegraf\x20error:',_0x414978);}),tgBot[_0x35ba15(0xcb)](async(_0x19ccba,_0x4a1ff6)=>{const _0xfcefb6=_0x35ba15;if(!(!settings[_0xfcefb6(0x115)]&&_0x19ccba['update'][_0xfcefb6(0x1a7)][_0xfcefb6(0x211)]==_0xfcefb6(0x247))){if(!validateTelegram(_0x19ccba))return;}_0x4a1ff6();}),tgBot[_0x35ba15(0x11e)]('start',async _0x411d13=>{const _0x1ab46e=_0x35ba15;if(!settings[_0x1ab46e(0x115)])updateSetting(_0x1ab46e(0x115),_0x411d13[_0x1ab46e(0x129)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x411d13))return;await sendTelegram(_0x411d13[_0x1ab46e(0x129)]['id'],_0x481808);}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x192),async _0x548223=>{const _0x2b3333=_0x35ba15;updateSetting(_0x2b3333(0xfa),!![]),await sendTelegram(_0x548223['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x9a),async _0x46cd81=>{const _0x3c1094=_0x35ba15;await sendTelegram(_0x46cd81[_0x3c1094(0x129)]['id'],_0x3c1094(0xba)),updateSetting(_0x3c1094(0xfa),![]);}),tgBot['command'](_0x35ba15(0xc2),async _0x38a5a2=>{const _0x26f001=_0x35ba15,_0x471fa=Markup['inlineKeyboard']([Markup[_0x26f001(0x14f)][_0x26f001(0x1fb)](_0x26f001(0x10c),_0x26f001(0x1aa)),Markup['button']['callback'](_0x26f001(0xf8),'config_alerts'),Markup[_0x26f001(0x14f)][_0x26f001(0x1fb)](_0x26f001(0x12d),_0x26f001(0x163))]);_0x38a5a2[_0x26f001(0x236)](_0x26f001(0xeb),_0x471fa);}),tgBot[_0x35ba15(0x122)](_0x35ba15(0x1aa),async _0xe35e30=>{const _0x29a040=_0x35ba15;_0xe35e30[_0x29a040(0x170)](),updateSetting(_0x29a040(0x1b8),_0x29a040(0x142)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0xe35e30[_0x29a040(0x129)]['id'],_0x29a040(0x1e3));}),tgBot[_0x35ba15(0x122)](_0x35ba15(0x8b),async _0x146a7e=>{const _0x500331=_0x35ba15;_0x146a7e[_0x500331(0x170)](),updateSetting(_0x500331(0x1b8),_0x500331(0x108)),updateSetting(_0x500331(0xfa),!![]),await sendTelegram(_0x146a7e[_0x500331(0x129)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x35ba15(0x122)](_0x35ba15(0x163),async _0x3687b1=>{const _0x3ecc0d=_0x35ba15;_0x3687b1['editMessageReplyMarkup'](),updateSetting('telegramEvents','all'),updateSetting(_0x3ecc0d(0xfa),!![]),await sendTelegram(_0x3687b1['chat']['id'],_0x3ecc0d(0x25c));}),tgBot['command'](_0x35ba15(0x6a),async _0x106b24=>{const _0x4a49f5=_0x35ba15,_0xb834c4=getBotsWithMode();let _0x4d59ca=_0x4a49f5(0x253);config[_0x4a49f5(0x1d3)](_0x2b142e=>{const _0x35ca3c=_0x4a49f5,_0x3b62d5=_0xb834c4[_0x35ca3c(0x230)](_0x117cf7=>_0x117cf7[_0x35ca3c(0xb9)]==_0x2b142e[_0x35ca3c(0xb9)])['mode'];_0x4d59ca+=_0x35ca3c(0x20e)+_0x2b142e['botID']+':\x20'+_0x2b142e[_0x35ca3c(0x6a)]+_0x35ca3c(0x1b3)+_0x3b62d5+_0x35ca3c(0x1b3)+_0x2b142e[_0x35ca3c(0x22a)]+'\x0a';}),_0x4d59ca+='\x0a',_0x4d59ca+=_0x4a49f5(0x1c4),_0x4d59ca+=!settings['telegramEnabled']?_0x4a49f5(0xd1):_0x4a49f5(0xa2),_0x4d59ca+=settings[_0x4a49f5(0xfa)]?settings['telegramEvents']==_0x4a49f5(0xfb)?_0x4a49f5(0xcc):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x4a49f5(0x90):'',await sendTelegram(_0x106b24[_0x4a49f5(0x129)]['id'],_0x4d59ca,{'parse_mode':_0x4a49f5(0x71)});}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x1b4),async _0x2dd3f1=>{const _0x325984=_0x35ba15,_0x54c480=getEnabledBots();if(_0x54c480[_0x325984(0x255)]==0x0)await sendTelegram(_0x2dd3f1['chat']['id'],_0x325984(0xa0));else{if(_0x54c480['length']>0x1)_0x54c480[_0x325984(0x1a8)]({'botID':'all'});let _0x248fdf=[],_0x43c2c6=[];const _0x56f700=_0x54c480['length']%0x4==0x0||_0x54c480[_0x325984(0x255)]%0x4==0x3||_0x54c480[_0x325984(0x255)]%0x3==0x1?0x4:0x3;let _0x529720=0x0;_0x54c480[_0x325984(0x1d3)]((_0x7db775,_0x20b0e4)=>{const _0x53104d=_0x325984;if(_0x20b0e4%_0x56f700==0x0)_0x43c2c6=[];_0x43c2c6['push'](Markup[_0x53104d(0x14f)]['callback'](_0x7db775[_0x53104d(0xb9)]==_0x53104d(0xfb)?_0x53104d(0x87):'Bot\x20'+_0x7db775[_0x53104d(0xb9)],_0x53104d(0x173)+_0x7db775[_0x53104d(0xb9)])),_0x20b0e4%_0x56f700==0x0&&(_0x248fdf[_0x529720]=_0x43c2c6,_0x529720++);});const _0x547a7d=Markup[_0x325984(0x106)](_0x248fdf);_0x2dd3f1[_0x325984(0x236)](_0x325984(0x245),_0x547a7d);}}),tgBot[_0x35ba15(0x122)](/restart_(.+)/,async _0x59c0be=>{const _0x2c37a6=_0x35ba15,_0x2ef88b=_0x59c0be[_0x2c37a6(0x221)][0x1];_0x59c0be[_0x2c37a6(0x170)](),_0x2ef88b==_0x2c37a6(0xfb)?config[_0x2c37a6(0x1d3)](_0x580cd8=>{const _0xb6c235=_0x2c37a6;restartBot(_0x580cd8[_0xb6c235(0xb9)]);}):restartBot(_0x2ef88b);}),tgBot['command']('on',async _0x2b6310=>{const _0x4ea6df=_0x35ba15,_0x60ffef=getDisabledBots();if(_0x60ffef[_0x4ea6df(0x255)]==0x0)await sendTelegram(_0x2b6310[_0x4ea6df(0x129)]['id'],_0x4ea6df(0x15a));else{if(_0x60ffef['length']>0x1)_0x60ffef[_0x4ea6df(0x1a8)]({'botID':'all'});let _0x37a1e1=[],_0x737424=[];const _0x336ee6=_0x60ffef[_0x4ea6df(0x255)]%0x4==0x0||_0x60ffef[_0x4ea6df(0x255)]%0x4==0x3||_0x60ffef['length']%0x3==0x1?0x4:0x3;let _0xed6f97=0x0;_0x60ffef[_0x4ea6df(0x1d3)]((_0x3eb1fb,_0x4f006b)=>{const _0x257aa5=_0x4ea6df;if(_0x4f006b%_0x336ee6==0x0)_0x737424=[];_0x737424[_0x257aa5(0x1a8)](Markup[_0x257aa5(0x14f)][_0x257aa5(0x1fb)](_0x3eb1fb[_0x257aa5(0xb9)]==_0x257aa5(0xfb)?_0x257aa5(0x87):_0x257aa5(0x20e)+_0x3eb1fb[_0x257aa5(0xb9)],'on_'+_0x3eb1fb[_0x257aa5(0xb9)])),_0x4f006b%_0x336ee6==0x0&&(_0x37a1e1[_0xed6f97]=_0x737424,_0xed6f97++);});const _0x210e02=Markup[_0x4ea6df(0x106)](_0x37a1e1);_0x2b6310[_0x4ea6df(0x236)](_0x4ea6df(0x180),_0x210e02);}}),tgBot['action'](/on_(.+)/,async _0xce411b=>{const _0x40b070=_0x35ba15,_0x472458=_0xce411b[_0x40b070(0x221)][0x1];_0xce411b[_0x40b070(0x170)]();if(_0x472458==_0x40b070(0xfb)){const _0x4dee26=getDisabledBots();await sendTelegram(_0xce411b[_0x40b070(0x129)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x4dee26[_0x40b070(0x1d3)](_0x5695c8=>{const _0x217b50=_0x40b070;if(_0x5695c8['botID']!=_0x217b50(0xfb))toggleBot(_0x5695c8[_0x217b50(0xb9)],toggleStatus(_0x5695c8['botID']),_0x217b50(0x185));});}else await sendTelegram(_0xce411b[_0x40b070(0x129)]['id'],_0x40b070(0x73)+_0x472458),toggleBot(_0x472458,toggleStatus(_0x472458),_0x40b070(0x185));}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x169),async _0x52ee83=>{const _0x4eb905=_0x35ba15,_0x3c7e90=getEnabledBots();if(_0x3c7e90['length']==0x0)await sendTelegram(_0x52ee83[_0x4eb905(0x129)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3c7e90[_0x4eb905(0x255)]>0x1)_0x3c7e90[_0x4eb905(0x1a8)]({'botID':_0x4eb905(0xfb)});let _0x2ee7ee=[],_0x140b97=[];const _0x3ae0e0=_0x3c7e90[_0x4eb905(0x255)]%0x4==0x0||_0x3c7e90[_0x4eb905(0x255)]%0x4==0x3||_0x3c7e90[_0x4eb905(0x255)]%0x3==0x1?0x4:0x3;let _0x2d24c0=0x0;_0x3c7e90[_0x4eb905(0x1d3)]((_0x4b553f,_0x50e1f6)=>{const _0xd43fda=_0x4eb905;if(_0x50e1f6%_0x3ae0e0==0x0)_0x140b97=[];_0x140b97['push'](Markup[_0xd43fda(0x14f)][_0xd43fda(0x1fb)](_0x4b553f[_0xd43fda(0xb9)]==_0xd43fda(0xfb)?_0xd43fda(0x87):_0xd43fda(0x20e)+_0x4b553f['botID'],'off_'+_0x4b553f[_0xd43fda(0xb9)])),_0x50e1f6%_0x3ae0e0==0x0&&(_0x2ee7ee[_0x2d24c0]=_0x140b97,_0x2d24c0++);});const _0x1242e5=Markup['inlineKeyboard'](_0x2ee7ee);_0x52ee83['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x1242e5);}}),tgBot[_0x35ba15(0x122)](/off_(.+)/,async _0x566d85=>{const _0x2f701a=_0x35ba15,_0x3ca32e=_0x566d85['match'][0x1];_0x566d85[_0x2f701a(0x170)]();if(_0x3ca32e=='all'){const _0x20185e=getEnabledBots();await sendTelegram(_0x566d85[_0x2f701a(0x129)]['id'],_0x2f701a(0x88)),_0x20185e[_0x2f701a(0x1d3)](_0xa72892=>{const _0x259a38=_0x2f701a;if(_0xa72892[_0x259a38(0xb9)]!=_0x259a38(0xfb))toggleBot(_0xa72892[_0x259a38(0xb9)],toggleStatus(_0xa72892[_0x259a38(0xb9)]),_0x259a38(0x185));});}else await sendTelegram(_0x566d85[_0x2f701a(0x129)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x3ca32e),toggleBot(_0x3ca32e,toggleStatus(_0x3ca32e),'stopped');}),tgBot[_0x35ba15(0x11e)]('metrics',async _0x51e69c=>{const _0x138ac5=_0x35ba15,_0xacc26c=getEnabledBots();if(_0xacc26c[_0x138ac5(0x255)]==0x0)await sendTelegram(_0x51e69c[_0x138ac5(0x129)]['id'],_0x138ac5(0xa0));else{if(_0xacc26c[_0x138ac5(0x255)]>0x1){let _0x50ff14=[],_0x55524b=[];const _0x48e73e=_0xacc26c[_0x138ac5(0x255)]%0x4==0x0||_0xacc26c['length']%0x4==0x3||_0xacc26c[_0x138ac5(0x255)]%0x3==0x1?0x4:0x3;let _0x198a18=0x0;_0xacc26c['forEach']((_0x468da7,_0x464024)=>{const _0x4aff59=_0x138ac5;if(_0x464024%_0x48e73e==0x0)_0x55524b=[];_0x55524b[_0x4aff59(0x1a8)](Markup[_0x4aff59(0x14f)][_0x4aff59(0x1fb)](_0x4aff59(0x20e)+_0x468da7['botID'],'metrics_'+_0x468da7['botID'])),_0x464024%_0x48e73e==0x0&&(_0x50ff14[_0x198a18]=_0x55524b,_0x198a18++);});const _0x2358b1=Markup[_0x138ac5(0x106)](_0x50ff14);_0x51e69c[_0x138ac5(0x236)](_0x138ac5(0x228),_0x2358b1);}else{const _0x133bda=_0xacc26c[0x0][_0x138ac5(0xb9)];if(pid[_0x133bda])pid[_0x133bda][_0x138ac5(0x7c)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x35ba15(0x122)](/metrics_(.+)/,async _0x297527=>{const _0x43797e=_0x35ba15,_0x39ef82=_0x297527['match'][0x1];_0x297527[_0x43797e(0x170)]();if(pid[_0x39ef82])pid[_0x39ef82]['send']({'function':_0x43797e(0x178),'args':null});}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x25a),async _0x455e03=>{const _0x4783af=_0x35ba15,_0x4bbbac=getEnabledBots();if(_0x4bbbac[_0x4783af(0x255)]==0x0)await sendTelegram(_0x455e03[_0x4783af(0x129)]['id'],_0x4783af(0xa0));else{if(_0x4bbbac[_0x4783af(0x255)]>0x1){let _0x25d212=[],_0x8fe92d=[];const _0x297ba2=_0x4bbbac['length']%0x4==0x0||_0x4bbbac[_0x4783af(0x255)]%0x4==0x3||_0x4bbbac[_0x4783af(0x255)]%0x3==0x1?0x4:0x3;let _0x182b64=0x0;_0x4bbbac[_0x4783af(0x1d3)]((_0x1456ff,_0x1aa872)=>{const _0x2906ec=_0x4783af;if(_0x1aa872%_0x297ba2==0x0)_0x8fe92d=[];_0x8fe92d[_0x2906ec(0x1a8)](Markup['button']['callback'](_0x2906ec(0x20e)+_0x1456ff[_0x2906ec(0xb9)],_0x2906ec(0x222)+_0x1456ff['botID'])),_0x1aa872%_0x297ba2==0x0&&(_0x25d212[_0x182b64]=_0x8fe92d,_0x182b64++);});const _0x20e272=Markup[_0x4783af(0x106)](_0x25d212);_0x455e03[_0x4783af(0x236)](_0x4783af(0x1ca),_0x20e272);}else{const _0x218107=_0x4bbbac[0x0][_0x4783af(0xb9)];if(pid[_0x218107])pid[_0x218107][_0x4783af(0x7c)]({'function':_0x4783af(0x1f9),'args':null});}}}),tgBot[_0x35ba15(0x122)](/portfolio_(.+)/,async _0x1bd247=>{const _0x5ea124=_0x35ba15,_0x4348d6=_0x1bd247[_0x5ea124(0x221)][0x1];_0x1bd247[_0x5ea124(0x170)]();if(pid[_0x4348d6])pid[_0x4348d6][_0x5ea124(0x7c)]({'function':_0x5ea124(0x1f9),'args':null});}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x13a),async _0x13082a=>{const _0x18798c=_0x35ba15;await getMessages();if(!updateAvailable)await sendTelegram(_0x13082a['chat']['id'],_0x18798c(0x202));else{if(!validInstallation)await sendTelegram(_0x13082a[_0x18798c(0x129)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x539365=Markup[_0x18798c(0x106)]([Markup[_0x18798c(0x14f)][_0x18798c(0x1fb)](_0x18798c(0x6b),_0x18798c(0x68)),Markup['button'][_0x18798c(0x1fb)]('No',_0x18798c(0xf1))]);_0x13082a['reply'](_0x18798c(0x1c9),_0x539365);}}}),tgBot[_0x35ba15(0x122)](/update_(.+)/,async _0x1cedc0=>{const _0x2abc1a=_0x35ba15,_0x480b61=_0x1cedc0[_0x2abc1a(0x221)][0x1];_0x1cedc0[_0x2abc1a(0x170)](),_0x480b61=='yes'&&(await sendTelegram(_0x1cedc0[_0x2abc1a(0x129)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x2abc1a(0x13a))),_0x480b61=='no'&&await sendTelegram(_0x1cedc0[_0x2abc1a(0x129)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x186),async _0x2d1c31=>{const _0x48ffc2=_0x35ba15;if(!validInstallation)await sendTelegram(_0x2d1c31[_0x48ffc2(0x129)]['id'],_0x48ffc2(0x89));else{const _0x33dc0a=Markup[_0x48ffc2(0x106)]([Markup[_0x48ffc2(0x14f)]['callback'](_0x48ffc2(0x6b),_0x48ffc2(0x12b)),Markup[_0x48ffc2(0x14f)][_0x48ffc2(0x1fb)]('No',_0x48ffc2(0x1f3))]);_0x2d1c31['reply'](_0x48ffc2(0x17d),_0x33dc0a);}}),tgBot['action'](/reinstall_(.+)/,async _0x474115=>{const _0xa98001=_0x35ba15,_0x4b451c=_0x474115[_0xa98001(0x221)][0x1];_0x474115[_0xa98001(0x170)](),_0x4b451c=='yes'&&(await sendTelegram(_0x474115[_0xa98001(0x129)]['id'],_0xa98001(0x1b9)),updateBB(_0xa98001(0x186))),_0x4b451c=='no'&&await sendTelegram(_0x474115[_0xa98001(0x129)]['id'],_0xa98001(0x1e2));}),tgBot['command'](_0x35ba15(0x231),async _0xe07256=>{const _0x166c8e=_0x35ba15,_0x2751b8=getBotsWithMode();if(_0x2751b8[_0x166c8e(0x255)]==0x0)await sendTelegram(_0xe07256[_0x166c8e(0x129)]['id'],_0x166c8e(0xa0));else{let _0x2e4271=[],_0x158833=[];const _0x47c492=0x2;let _0x2eb285=0x0;_0x2751b8['forEach']((_0x2e49cd,_0x2bf6bb)=>{const _0x3fc5de=_0x166c8e;if(_0x2bf6bb%_0x47c492==0x0)_0x158833=[];_0x158833[_0x3fc5de(0x1a8)](Markup[_0x3fc5de(0x14f)]['callback']('Bot\x20'+_0x2e49cd[_0x3fc5de(0xb9)]+'\x20('+_0x2e49cd[_0x3fc5de(0x1f0)]+')',_0x3fc5de(0xfc)+_0x2e49cd[_0x3fc5de(0xb9)])),_0x2bf6bb%_0x47c492==0x0&&(_0x2e4271[_0x2eb285]=_0x158833,_0x2eb285++);});const _0x40d232=Markup[_0x166c8e(0x106)](_0x2e4271);_0xe07256[_0x166c8e(0x236)](_0x166c8e(0x14e),_0x40d232);}}),tgBot[_0x35ba15(0x122)](/toggle_(.+)/,async _0x188e1f=>{const _0x4f544a=_0x35ba15,_0x10f77d=_0x188e1f[_0x4f544a(0x221)][0x1];_0x188e1f['editMessageReplyMarkup']();const _0x2a0460=getBotsWithMode(),_0x4bd40a=_0x2a0460[_0x4f544a(0x230)](_0x2975f8=>_0x2975f8[_0x4f544a(0xb9)]==_0x10f77d),_0x585a62=_0x4bd40a[_0x4f544a(0x1f0)]=='auto'?'manual':'auto';await sendTelegram(_0x188e1f[_0x4f544a(0x129)]['id'],_0x4f544a(0x201)+_0x10f77d+'\x20to\x20'+_0x585a62+_0x4f544a(0x20c)),toggleBotMode(_0x10f77d);}),tgBot['command']('names',async _0x1ab67f=>{const _0x132af8=_0x35ba15;let _0x3d6963='';config[_0x132af8(0x1d3)](_0x7ed12d=>{const _0x1104c4=_0x132af8;_0x3d6963+='Bot\x20'+_0x7ed12d[_0x1104c4(0xb9)]+':\x20'+_0x7ed12d[_0x1104c4(0xd9)]+'\x0a';}),await sendTelegram(_0x1ab67f['chat']['id'],_0x3d6963,{'parse_mode':_0x132af8(0x71)});}),tgBot[_0x35ba15(0x11e)](_0x35ba15(0x1ec),async _0x1d1613=>{await sendTelegram(_0x1d1613['chat']['id'],_0x45638a);}),process[_0x35ba15(0x11c)]('SIGINT',()=>tgBot[_0x35ba15(0x198)]('SIGINT')),process[_0x35ba15(0x11c)](_0x35ba15(0x249),()=>tgBot[_0x35ba15(0x198)](_0x35ba15(0x249))),tgBot['launch']();}}function disableTelegram(){const _0x3bcf1f=_0x201782;tgBot&&tgBot[_0x3bcf1f(0x198)]();}async function sendTelegram(_0x27c43e,_0x2bd191,_0x3ac6bf){const _0xf04bbf=_0x201782;try{await tgBot[_0xf04bbf(0x130)][_0xf04bbf(0xd2)](_0x27c43e,_0x2bd191,_0x3ac6bf);}catch(_0x2a7297){console['log'](_0xf04bbf(0x1da),_0x2a7297);}}async function sendTelegramBot(_0x2e5737,_0x31177d){const _0xf7e3ff=_0x201782;if(settings['telegramEnabled']){if(settings['telegramEvents']=='all'||(_0x31177d[_0xf7e3ff(0x150)]==_0xf7e3ff(0xa1)||_0x31177d['type']==_0xf7e3ff(0x19b)||_0x31177d[_0xf7e3ff(0x150)]==_0xf7e3ff(0xc7))&&settings[_0xf7e3ff(0x1b8)]=='alerts'||_0x31177d[_0xf7e3ff(0x150)]==_0xf7e3ff(0x171)&&settings[_0xf7e3ff(0x1b8)]==_0xf7e3ff(0x142)){if(tgBot&&settings[_0xf7e3ff(0x115)]){if(_0x31177d[_0xf7e3ff(0x1df)])await sendTelegram(settings[_0xf7e3ff(0x115)],_0x31177d[_0xf7e3ff(0xd9)]+'\x20>\x20'+_0x31177d[_0xf7e3ff(0x165)]);else await sendTelegram(settings[_0xf7e3ff(0x115)],_0xf7e3ff(0x20e)+_0x2e5737+_0xf7e3ff(0x114)+_0x31177d[_0xf7e3ff(0x165)]);}}}}async function sendTelegramMsg(_0x3b0e27,_0x3d9493=_0x201782(0x71)){const _0x28965e=_0x201782;return settings['telegramEnabled']&&tgBot&&settings[_0x28965e(0x115)]?(await sendTelegram(settings[_0x28965e(0x115)],_0x3b0e27,{'parse_mode':_0x3d9493}),!![]):![];}function getDeviceWithIp(_0x2ef5dc){const _0x4db3af=_0x201782;return devices[_0x4db3af(0x230)](_0x3a74a6=>_0x3a74a6['ip']===_0x2ef5dc);}async function temporaryAccess2FA(_0xc66c06,_0x4ee81e){const _0x58e485=_0x201782;let _0x201b52=new Date(),_0x276630=![];if(lastIpApproval){if(_0x201b52-lastIpApproval<0x1388)_0x276630=!![];}lastIpApproval=new Date();if(_0x276630)return;if(tgBot&&settings[_0x58e485(0x115)]){const _0x3c3f45=uuidRandom();tmpStorage[_0x3c3f45]={'uuid':_0xc66c06,'externalip':_0x4ee81e};const _0x27e8aa=Markup[_0x58e485(0x106)]([Markup['button'][_0x58e485(0x1fb)](_0x58e485(0x13f),_0x58e485(0xb2)+_0x3c3f45),Markup[_0x58e485(0x14f)][_0x58e485(0x1fb)](_0x58e485(0x1ae),_0x58e485(0x25f)+_0x3c3f45),Markup[_0x58e485(0x14f)][_0x58e485(0x1fb)]('30\x20min','tempaccess_30_'+_0x3c3f45),Markup[_0x58e485(0x14f)]['callback']('reject',_0x58e485(0x85)+_0x3c3f45)]);await sendTelegram(settings[_0x58e485(0x115)],_0x58e485(0x1cc)+normalizeIP(_0x4ee81e)['show']+'\x20?',_0x27e8aa),tgBot[_0x58e485(0x122)](/tempaccess_(.+)_(.+)/,async _0x25885a=>{const _0x32c4ee=_0x58e485,_0x2db2d3=_0x25885a[_0x32c4ee(0x221)][0x1],_0x1140a3=_0x25885a[_0x32c4ee(0x221)][0x2],{uuid:_0x39f8b5,externalip:_0x2823ad}=tmpStorage[_0x1140a3];delete tmpStorage[_0x1140a3],_0x25885a[_0x32c4ee(0x170)](),devices[_0x39f8b5][_0x32c4ee(0x233)]={'clientip':_0x2823ad,'timestamp':new Date()['getTime'](),'expiry':_0x2db2d3},_0x2db2d3!=_0x32c4ee(0x159)?(await sendTelegram(_0x25885a[_0x32c4ee(0x129)]['id'],_0x32c4ee(0x125)+_0x2db2d3+'\x20minutes',{'parse_mode':_0x32c4ee(0x71)}),io['to'](_0x39f8b5)[_0x32c4ee(0x174)]('status',{'access':{'allow':![],'reason':_0x32c4ee(0x1de),'token':null}})):(await sendTelegram(_0x25885a[_0x32c4ee(0x129)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x39f8b5)[_0x32c4ee(0x174)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x2a3e3e,_0x477b19){const _0x48d2da=_0x201782;if(tgBot&&settings[_0x48d2da(0x115)]){const _0x2c2656=uuidRandom();tmpStorage[_0x2c2656]={'uuid':_0x2a3e3e,'externalip':_0x477b19};const _0x2ced81=Markup[_0x48d2da(0x106)]([Markup[_0x48d2da(0x14f)][_0x48d2da(0x1fb)](_0x48d2da(0x127),_0x48d2da(0x1e9)+loginExpiry+'_'+_0x2c2656),Markup['button'][_0x48d2da(0x1fb)](_0x48d2da(0x159),_0x48d2da(0x99)+_0x2c2656)]);await sendTelegram(settings[_0x48d2da(0x115)],_0x48d2da(0xc1)+normalizeIP(_0x477b19)[_0x48d2da(0x1e0)]+'\x20?',_0x2ced81),tgBot[_0x48d2da(0x122)](/login2fa_(.+)_(.+)/,async _0x15c364=>{const _0x35c3ba=_0x48d2da,_0x5b4a8b=_0x15c364['match'][0x1],_0x36bd83=_0x15c364[_0x35c3ba(0x221)][0x2],{uuid:_0xcd6cb0,externalip:_0x189039}=tmpStorage[_0x36bd83];delete tmpStorage[_0x36bd83],_0x15c364['editMessageReplyMarkup'](),devices[_0xcd6cb0]['telegram2FaApproval']={'clientip':_0x189039,'timestamp':new Date()[_0x35c3ba(0x156)](),'expiry':_0x5b4a8b},_0x5b4a8b!=_0x35c3ba(0x159)?(await sendTelegram(_0x15c364['chat']['id'],'Login\x20accepted',{'parse_mode':_0x35c3ba(0x71)}),io['to'](_0xcd6cb0)[_0x35c3ba(0x174)](_0x35c3ba(0x6a),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x15c364[_0x35c3ba(0x129)]['id'],_0x35c3ba(0x143)),io['to'](_0xcd6cb0)[_0x35c3ba(0x174)](_0x35c3ba(0x6a),{'access':{'allow':![],'reason':_0x35c3ba(0x82),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3cb093=_0x201782;return dbConfig['get']('bots')[_0x3cb093(0x19f)](_0x3cb093(0xb9))['filter']({'status':_0x3cb093(0x148)})[_0x3cb093(0x110)]()||[];}function getDisabledBots(){const _0x5c5ff4=_0x201782;return dbConfig[_0x5c5ff4(0x16b)](_0x5c5ff4(0x10a))[_0x5c5ff4(0x19f)](_0x5c5ff4(0xb9))['filter']({'status':_0x5c5ff4(0xe0)})[_0x5c5ff4(0x110)]()||[];}function getBotAttributes(_0x271ff4){const _0x162c2c=_0x201782;let _0x1f6c42={};const _0x257c26=configpath+_0x162c2c(0x24f)+_0x271ff4+_0x162c2c(0x22c),_0x1c00d7=fs[_0x162c2c(0x1a9)](_0x257c26);if(_0x1c00d7){const _0x5690a1=fs[_0x162c2c(0x6d)](_0x257c26);try{const _0x28f829=JSON[_0x162c2c(0x216)](_0x5690a1),_0x5195cc=_0x28f829?_0x28f829[_0x162c2c(0x158)][0x0][_0x162c2c(0x168)]:![];_0x1f6c42[_0x162c2c(0x1f0)]=_0x5195cc?_0x162c2c(0x20b):_0x162c2c(0x7e),_0x1f6c42['botname']=_0x28f829?_0x28f829[_0x162c2c(0x158)][0x0][_0x162c2c(0xd9)]:_0x162c2c(0x20e)+_0x271ff4;}catch(_0x43cd0a){_0x1f6c42[_0x162c2c(0x1f0)]=_0x162c2c(0x7e),_0x1f6c42['botname']=_0x162c2c(0x20e)+_0x271ff4;}}else _0x1f6c42['mode']=_0x162c2c(0x7e),_0x1f6c42[_0x162c2c(0xd9)]=_0x162c2c(0x20e)+_0x271ff4;return _0x1f6c42;}function getBotsWithMode(){const _0x39693e=_0x201782,_0x26b63d=dbConfig[_0x39693e(0x16b)](_0x39693e(0x10a))[_0x39693e(0x19f)](_0x39693e(0xb9))['value']()||[];return _0x26b63d[_0x39693e(0x1d3)](_0x3c0c88=>{const _0x4c64da=_0x39693e;let _0xbbeaf9=getBotAttributes(_0x3c0c88[_0x4c64da(0xb9)]);_0x3c0c88[_0x4c64da(0x1f0)]=_0xbbeaf9['mode'];}),_0x26b63d;}function getBotExchanges(){const _0x57ce8c=_0x201782;let _0x24fa0e=[];const _0x12cdd1=dbConfig['get'](_0x57ce8c(0x10a))[_0x57ce8c(0x19f)](_0x57ce8c(0xb9))[_0x57ce8c(0x110)]()||[];_0x12cdd1[_0x57ce8c(0x1d3)](_0x1ca88e=>{const _0x1722db=_0x57ce8c;if(_0x1ca88e['status']==_0x1722db(0x148)){const _0x22a77f=configpath+_0x1722db(0x24f)+_0x1ca88e['botID']+_0x1722db(0x22c),_0x3071f2=fs[_0x1722db(0x1a9)](_0x22a77f);let _0x30f44a;if(_0x3071f2){const _0x2a74f1=fs[_0x1722db(0x6d)](_0x22a77f);try{const _0x69a658=JSON[_0x1722db(0x216)](_0x2a74f1);_0x30f44a=_0x69a658?_0x69a658[_0x1722db(0x158)][0x0]['exchange']:null;}catch(_0x1bbd9e){}}if(_0x30f44a)_0x24fa0e['push'](_0x30f44a);}});const _0x283e22=[...new Set(_0x24fa0e)][_0x57ce8c(0x1c7)]();return _0x283e22;}async function initUser(){const _0x178119=_0x201782;if(!settings[_0x178119(0x1bf)]){const _0x33716e=uuidRandom();mixpanel['alias'](_0x33716e),updateSetting(_0x178119(0x1bf),_0x33716e);}}async function initSecure(){const _0x16edfd=_0x201782;let _0x49b25e=getSecure();if(!_0x49b25e[_0x16edfd(0x98)](_0x16edfd(0x14b))){let _0x15f083=await generateKeys();_0x49b25e[_0x16edfd(0x167)]=_0x15f083[_0x16edfd(0x167)],_0x49b25e[_0x16edfd(0x14d)]=_0x15f083[_0x16edfd(0x14d)],_0x49b25e[_0x16edfd(0x14b)]=crypto['randomBytes'](0x20)['toString'](_0x16edfd(0x9d));;storeSecure(_0x49b25e);}}function getSettings(){const _0x4b4904=_0x201782;return dbSettings[_0x4b4904(0x16b)](_0x4b4904(0x1c0))[_0x4b4904(0x110)]()||{};}function getSecure(){const _0x5422ea=_0x201782;return dbSecure[_0x5422ea(0x16b)]('secure')[_0x5422ea(0x110)]()||{};}function getBlacklist(){const _0x52183e=_0x201782;return dbSecure[_0x52183e(0x16b)](_0x52183e(0xac))[_0x52183e(0x110)]()||[];}function broadcastToBots(_0x32e408,_0x5b7269){const _0x329f7f=_0x201782;config[_0x329f7f(0x1d3)](_0x5d5b87=>{const _0x11118a=_0x329f7f;if(_0x5d5b87['status']==_0x11118a(0x148)&&_0x5d5b87[_0x11118a(0x22a)]==_0x11118a(0x21b)||_0x5d5b87[_0x11118a(0x6a)]==_0x11118a(0x1d4)&&_0x5d5b87['live']==_0x11118a(0x21b)){if(pid[_0x5d5b87[_0x11118a(0xb9)]])pid[_0x5d5b87[_0x11118a(0xb9)]][_0x11118a(0x7c)]({[_0x32e408]:_0x5b7269});}});}function storeSettings(_0x105280,_0x1cf734=![]){const _0x5aa5aa=_0x201782;_0x105280={...settings,..._0x105280};if(_0x1cf734&&_0x105280[_0x5aa5aa(0xcd)]!=_0x5aa5aa(0x21a)&&_0x105280['bbPassword']!=_0x5aa5aa(0x19a)&&_0x105280[_0x5aa5aa(0xcd)]!=''){const _0x4de92b=crypt[_0x5aa5aa(0x1cb)](secure['privateKey'],_0x105280[_0x5aa5aa(0xcd)])[_0x5aa5aa(0x1a7)][_0x5aa5aa(0xb5)]('@')[0x0],_0x1000e4=bcrypt[_0x5aa5aa(0x145)](_0x4de92b,saltRounds);_0x105280={..._0x105280,'bbPassword':_0x1000e4};}if(_0x1cf734&&_0x105280[_0x5aa5aa(0x6c)]!=_0x5aa5aa(0x21a)&&_0x105280[_0x5aa5aa(0x6c)]!=_0x5aa5aa(0x19a)&&_0x105280['telegramToken']!=''){const _0x2cc2a1=crypt['decrypt'](secure[_0x5aa5aa(0x14d)],_0x105280['telegramToken'])[_0x5aa5aa(0x1a7)][_0x5aa5aa(0xb5)]('@')[0x0];_0x105280={..._0x105280,'telegramToken':_0x2cc2a1};}const _0x1d2c37=_0x105280[_0x5aa5aa(0x6c)]!=_0x5aa5aa(0x21a)&&_0x105280[_0x5aa5aa(0x6c)]!=settings[_0x5aa5aa(0x6c)]||_0x105280[_0x5aa5aa(0xa6)]!=settings['telegramUsername'],_0x45e626=_0x105280[_0x5aa5aa(0x6c)]==''||_0x105280['telegramUsername']=='';_0x1d2c37&&(_0x105280['telegramChatId']=null,_0x105280[_0x5aa5aa(0x1b8)]=_0x5aa5aa(0xfb));for(const [_0x404db9,_0x1cd3ec]of Object['entries'](_0x105280)){if(_0x404db9==_0x5aa5aa(0x6c)&&_0x1cd3ec==_0x5aa5aa(0x21a)){_0x105280[_0x5aa5aa(0x6c)]=settings['telegramToken'];continue;};if(_0x404db9==_0x5aa5aa(0xcd)&&_0x1cd3ec==_0x5aa5aa(0x21a)){_0x105280[_0x5aa5aa(0xcd)]=settings['bbPassword'];continue;};dbSettings[_0x5aa5aa(0x1fa)]('settings.'+_0x404db9,_0x1cd3ec)[_0x5aa5aa(0xb0)]();}settings=_0x105280,io['to'](_0x5aa5aa(0xc6))['emit'](_0x5aa5aa(0x1c0),cleanSettings()),broadcastToBots(_0x5aa5aa(0x74),settings[_0x5aa5aa(0x74)]),broadcastToBots(_0x5aa5aa(0x1d7),settings[_0x5aa5aa(0x1d7)]);if(_0x1d2c37&&!_0x45e626)initTelegram();if(_0x1d2c37&&_0x45e626)disableTelegram();getAllClients()[_0x5aa5aa(0x1d3)](_0x2dafca=>{const _0x567c57=_0x5aa5aa;getSocket(_0x2dafca['id'])[_0x567c57(0x174)](_0x567c57(0x6a),{'access':{'allow':![],'reason':_0x567c57(0x1de),'token':null}});});}function updateSetting(_0x3ee739,_0x1e0c80){const _0xc14d92=_0x201782;dbSettings[_0xc14d92(0x1fa)](_0xc14d92(0x187)+_0x3ee739,_0x1e0c80)['write'](),settings=getSettings(),io['to'](_0xc14d92(0xc6))['emit'](_0xc14d92(0x1c0),cleanSettings());}function storeSecure(_0x3bbfec){const _0x4a2d7c=_0x201782;dbSecure[_0x4a2d7c(0x16b)](_0x4a2d7c(0x240))[_0x4a2d7c(0x1a8)](_0x3bbfec)[_0x4a2d7c(0xb0)](),secure=_0x3bbfec;}function addBlacklist(_0x47103d){const _0x46e724=_0x201782;cleanBlacklist();let _0xb25dfd;devices[_0x47103d][_0x46e724(0x233)]?_0xb25dfd=Math[_0x46e724(0x183)](devices[_0x47103d][_0x46e724(0x233)]['expiry'],loginExpiry):_0xb25dfd=loginExpiry,dbSecure[_0x46e724(0x16b)](_0x46e724(0xac))[_0x46e724(0x1a8)]({'expiry':new Date()['getTime']()+_0xb25dfd*0x3c*0x3e8,'token':devices[_0x47103d][_0x46e724(0x1af)]['token']})['write'](),blacklist=dbSecure[_0x46e724(0x16b)](_0x46e724(0xac))[_0x46e724(0x110)]();}function cleanBlacklist(){const _0x1bf2ad=_0x201782;let _0x22a96d=dbSecure[_0x1bf2ad(0x16b)]('blacklist')[_0x1bf2ad(0x1f4)]()['value'](),_0x3c9e6e=new Date()[_0x1bf2ad(0x156)]();_0x22a96d[_0x1bf2ad(0x1d3)](_0xa29f75=>{const _0x81b9c8=_0x1bf2ad;_0xa29f75[_0x81b9c8(0x103)]<_0x3c9e6e&&dbSecure[_0x81b9c8(0x16b)](_0x81b9c8(0xac))[_0x81b9c8(0x1f2)]({'expiry':_0xa29f75[_0x81b9c8(0x103)]})[_0x81b9c8(0xb0)]();});}function initStates(){const _0x1dd96d=_0x201782;let _0x176c78=getConfiguration();_0x176c78[_0x1dd96d(0x1d3)](_0x1af182=>{const _0x4ba22b=_0x1dd96d;_0x1af182[_0x4ba22b(0x22a)]=_0x4ba22b(0x185);}),storeConfiguration(_0x176c78);}function onKeys(){const _0x5b5e01=new RSA();return new Promise(_0x242148=>{const _0x36be3a=_0x20cd;_0x5b5e01[_0x36be3a(0xa9)]()[_0x36be3a(0x1a1)](_0x2859be=>{_0x242148(_0x2859be);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x314edb=_0x201782;let _0x6520be=getSettings(),_0x386138=![];!_0x6520be['hasOwnProperty'](_0x314edb(0x93))&&(_0x6520be['lastmsgtelegram']=0x0,_0x386138=!![]);!_0x6520be[_0x314edb(0x98)](_0x314edb(0x12a))&&(_0x6520be['lastmsgemitted']=0x0,_0x386138=!![]);!_0x6520be[_0x314edb(0x98)](_0x314edb(0x1a2))&&(_0x6520be['latestversion']=_0x314edb(0x246),_0x386138=!![]);!_0x6520be[_0x314edb(0x98)](_0x314edb(0x1d7))&&(_0x6520be['onepagemode']=![],_0x386138=!![]);if(_0x386138)storeSettings(_0x6520be);try{fs[_0x314edb(0x181)](configbackuppath,{'withFileTypes':!![]})[_0x314edb(0x1d3)](_0x2e3383=>{const _0x360a65=_0x314edb;if(!_0x2e3383['isDirectory']()){if(!_0x2e3383[_0x360a65(0x1ce)][_0x360a65(0x1a6)]('backup-full@'))fs[_0x360a65(0x111)](configbackuppath+_0x2e3383[_0x360a65(0x1ce)]);}else fs[_0x360a65(0x1c3)](configbackuppath+_0x2e3383['name'],{'recursive':!![]});});}catch(_0x57969c){logger[_0x314edb(0x1e6)](_0x314edb(0x161),_0x57969c);}}function storeConfiguration(_0x2930a4){const _0x330043=_0x201782;dbConfig[_0x330043(0x16b)]('bots')[_0x330043(0x1f2)]()[_0x330043(0xb0)](),dbConfig['get'](_0x330043(0x10a))[_0x330043(0x1a8)](..._0x2930a4)['write'](),config=_0x2930a4;}async function resetPassword(){const _0x2a3740=_0x201782;if(tgBot&&settings[_0x2a3740(0x115)]){const _0x30d7aa=Markup[_0x2a3740(0x106)]([Markup[_0x2a3740(0x14f)][_0x2a3740(0x1fb)](_0x2a3740(0x135),'resetpw_yes'),Markup['button'][_0x2a3740(0x1fb)]('no',_0x2a3740(0x16f))]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x30d7aa),tgBot[_0x2a3740(0x122)](/resetpw_(.+)/,async _0x4fb75d=>{const _0xb058ea=_0x2a3740,_0x14ca1d=_0x4fb75d[_0xb058ea(0x221)][0x1];_0x4fb75d['editMessageReplyMarkup']();if(_0x14ca1d!='no'){const _0x3bf201=0xf,_0x1b26ba='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x5305fa=Array['from'](crypto[_0xb058ea(0xf6)](new Uint32Array(_0x3bf201)))[_0xb058ea(0x1f7)](_0x3d10d2=>_0x1b26ba[_0x3d10d2%_0x1b26ba[_0xb058ea(0x255)]])[_0xb058ea(0x154)](''),_0x2d59af=bcrypt[_0xb058ea(0x145)](_0x5305fa,saltRounds);storeSettings({'bbPassword':_0x2d59af}),await sendTelegram(_0x4fb75d[_0xb058ea(0x129)]['id'],_0xb058ea(0x121)+_0x5305fa,{'parse_mode':'HTML'});}else await sendTelegram(_0x4fb75d[_0xb058ea(0x129)]['id'],_0xb058ea(0xc9));});}}async function confirmRestore(_0x144d07,_0x1b0fc5){const _0x465851=_0x201782;io['to'](_0x465851(0xc6))[_0x465851(0x174)]('notification',_0x465851(0x16e),_0x465851(0xc7));if(tgBot&&settings[_0x465851(0x115)]){const _0x4010f8=uuidRandom();tmpStorage[_0x4010f8]={'path':_0x144d07,'filename':_0x1b0fc5};const _0x1454c0=Markup['inlineKeyboard']([Markup[_0x465851(0x14f)][_0x465851(0x1fb)](_0x465851(0x135),'restore_yes_'+_0x4010f8),Markup[_0x465851(0x14f)][_0x465851(0x1fb)]('no','restore_no_'+_0x4010f8)]);await sendTelegram(settings[_0x465851(0x115)],_0x465851(0xbc),_0x1454c0),tgBot[_0x465851(0x122)](/restore_(.+)_(.+)/,async _0x66615=>{const _0x14e03d=_0x465851,_0x25f679=_0x66615[_0x14e03d(0x221)][0x1],_0x1d69db=_0x66615[_0x14e03d(0x221)][0x2],{path:_0x289432,filename:_0x28b1d3}=tmpStorage[_0x1d69db];delete tmpStorage[_0x1d69db],_0x66615[_0x14e03d(0x170)](),_0x25f679==_0x14e03d(0x135)?(logger[_0x14e03d(0x1e6)](_0x14e03d(0x1fd)),await sendTelegram(_0x66615[_0x14e03d(0x129)]['id'],_0x14e03d(0x225),{'parse_mode':_0x14e03d(0x71)}),unzipFile(_0x289432,_0x28b1d3)):(logger[_0x14e03d(0x1e6)](_0x14e03d(0xf7)),await sendTelegram(_0x66615['chat']['id'],_0x14e03d(0xf7)));});}}function getServerTime(){const _0x57f310=_0x201782,_0x2c046a=new Date();return _0x2c046a['getFullYear']()+'/'+(_0x2c046a['getMonth']()+0x1)[_0x57f310(0xb3)]()[_0x57f310(0xc3)](0x2,'0')+'/'+_0x2c046a[_0x57f310(0x18a)]()[_0x57f310(0xb3)]()['padStart'](0x2,'0')+'\x20'+_0x2c046a['getHours']()[_0x57f310(0xb3)]()[_0x57f310(0xc3)](0x2,'0')+':'+_0x2c046a[_0x57f310(0x193)]()[_0x57f310(0xb3)]()[_0x57f310(0xc3)](0x2,'0')+':'+_0x2c046a[_0x57f310(0x242)]()[_0x57f310(0xb3)]()[_0x57f310(0xc3)](0x2,'0');}function getTimeStamp(){const _0x363578=_0x201782,_0x34d7d8=shiftedTime();return _0x34d7d8[_0x363578(0x257)]()+'/'+(_0x34d7d8[_0x363578(0x128)]()+0x1)[_0x363578(0xb3)]()[_0x363578(0xc3)](0x2,'0')+'/'+_0x34d7d8['getDate']()[_0x363578(0xb3)]()[_0x363578(0xc3)](0x2,'0')+'\x20'+_0x34d7d8['getHours']()[_0x363578(0xb3)]()[_0x363578(0xc3)](0x2,'0')+':'+_0x34d7d8['getMinutes']()[_0x363578(0xb3)]()[_0x363578(0xc3)](0x2,'0')+':'+_0x34d7d8[_0x363578(0x242)]()[_0x363578(0xb3)]()[_0x363578(0xc3)](0x2,'0');}function getCleanTimeStamp(){const _0x163864=_0x201782,_0x580b86=shiftedTime();return _0x580b86[_0x163864(0x257)]()+(_0x580b86['getMonth']()+0x1)['toString']()[_0x163864(0xc3)](0x2,'0')+_0x580b86[_0x163864(0x18a)]()[_0x163864(0xb3)]()['padStart'](0x2,'0')+'-'+_0x580b86[_0x163864(0x229)]()[_0x163864(0xb3)]()['padStart'](0x2,'0')+_0x580b86[_0x163864(0x193)]()[_0x163864(0xb3)]()[_0x163864(0xc3)](0x2,'0')+_0x580b86['getSeconds']()[_0x163864(0xb3)]()[_0x163864(0xc3)](0x2,'0');}function shiftedTime(){const _0x3884bd=_0x201782,_0x5d292c=new Date();let _0x4ef447=_0x5d292c;if(settings[_0x3884bd(0x74)]&&settings['timeshift']!==0x0)_0x4ef447=fns[_0x3884bd(0x200)](_0x5d292c,{'hours':settings['timeshift']});return _0x4ef447;}function startScheduler(){const _0x486bf1=_0x201782,_0x8e7694=new Date()[_0x486bf1(0x1bb)](),_0x2a6f3a=shiftedTime()[_0x486bf1(0x229)]();_0x2a6f3a==0x4&&backupConfigFiles();_0x2a6f3a==0x0&&rotateLogFiles();_0x8e7694%0x6==0x0&&triggerAnalytics();_0x8e7694%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x765598){const _0x11177e=_0x201782;logger['debug'](_0x11177e(0x160)+_0x765598);const _0x442958=getBotsWithMode();_0x442958['length']>0x0?confirmRestore(configbackuppath,_0x765598):unzipFile(configbackuppath,_0x765598);}async function getBackupFiles(_0x27049b=null){const _0x1284d7=_0x201782;let _0x11e249=[],_0x319621=fs[_0x1284d7(0x181)](configbackuppath,{'withFileTypes':!![]});_0x319621[_0x1284d7(0x1c7)]((_0x5da03c,_0x3ae5e4)=>_0x5da03c[_0x1284d7(0x1ce)]<_0x3ae5e4[_0x1284d7(0x1ce)]?0x1:_0x3ae5e4[_0x1284d7(0x1ce)]<_0x5da03c[_0x1284d7(0x1ce)]?-0x1:0x0),_0x319621[_0x1284d7(0x1d3)](_0x1800f9=>{const _0x31f214=_0x1284d7;if(!_0x1800f9[_0x31f214(0x12e)]()&&_0x1800f9['name']['startsWith'](_0x31f214(0x20f))&&_0x1800f9[_0x31f214(0x1ce)][_0x31f214(0x14c)](_0x31f214(0x237))){const _0xc2f071=formatDate(fs['statSync'](configbackuppath+_0x1800f9[_0x31f214(0x1ce)])[_0x31f214(0xb8)]);_0x11e249[_0x31f214(0x1a8)]({'name':_0x1800f9[_0x31f214(0x1ce)],'mtime':_0xc2f071});}});if(_0x27049b)io['to'](_0x27049b)[_0x1284d7(0x174)](_0x1284d7(0x197),_0x11e249);else return _0x11e249;}async function backupConfigFiles(){const _0x2746ae=_0x201782;await zipFiles(_0x2746ae(0xe4));const _0x36f457=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x2746ae(0x20f)+_0x36f457+_0x2746ae(0x237)));let _0x2bebfa=fs[_0x2746ae(0x181)](configbackuppath,{'withFileTypes':!![]});_0x2bebfa[_0x2746ae(0x1c7)]((_0x2cb205,_0x3e3f6a)=>_0x2cb205[_0x2746ae(0x1ce)]<_0x3e3f6a[_0x2746ae(0x1ce)]?0x1:_0x3e3f6a[_0x2746ae(0x1ce)]<_0x2cb205[_0x2746ae(0x1ce)]?-0x1:0x0),_0x2bebfa[_0x2746ae(0x255)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x2bebfa[_0x2bebfa[_0x2746ae(0x255)]-0x1][_0x2746ae(0x1ce)]);}function rotateLogFiles(){const _0x289991=_0x201782,_0x5a23f8=fs[_0x289991(0x19c)](logspath+'output-000.log'),_0x2da082=_0x5a23f8['size']/0x400;if(_0x2da082>0x64){let _0x2337b1=fs[_0x289991(0x181)](logspath,{'withFileTypes':!![]});_0x2337b1[_0x289991(0x1c7)]((_0x232ee3,_0x26fb43)=>_0x232ee3[_0x289991(0x1ce)]<_0x26fb43[_0x289991(0x1ce)]?0x1:_0x26fb43[_0x289991(0x1ce)]<_0x232ee3[_0x289991(0x1ce)]?-0x1:0x0),_0x2337b1[_0x289991(0x1d3)](_0xa5314c=>{const _0x194a6c=_0x289991;if(_0xa5314c[_0x194a6c(0x1ce)]=='output-002.log')fs[_0x194a6c(0x8e)](logspath+_0xa5314c[_0x194a6c(0x1ce)],logspath+_0x194a6c(0x1e5));if(_0xa5314c[_0x194a6c(0x1ce)]==_0x194a6c(0x1a0))fs[_0x194a6c(0x8e)](logspath+_0xa5314c[_0x194a6c(0x1ce)],logspath+'output-002.log');_0xa5314c[_0x194a6c(0x1ce)]==_0x194a6c(0xff)&&(fs[_0x194a6c(0x8e)](logspath+_0xa5314c[_0x194a6c(0x1ce)],logspath+'output-001.log'),fs[_0x194a6c(0xa8)](logspath+_0xa5314c[_0x194a6c(0x1ce)],''));});}}async function zipFiles(_0x2513cf){const _0x3f6f4a=_0x201782;let _0x1abba3;if(_0x2513cf==_0x3f6f4a(0x232))_0x1abba3=logspath;if(_0x2513cf==_0x3f6f4a(0x6e))_0x1abba3=configpath;if(_0x2513cf==_0x3f6f4a(0xe4))_0x1abba3=configpath;let _0x4f4c5f=fs['readdirSync'](_0x1abba3,{'withFileTypes':!![]});const _0xe47180=new require(_0x3f6f4a(0x22e))();_0x4f4c5f[_0x3f6f4a(0x1d3)](_0x4e5849=>{const _0x48dc34=_0x3f6f4a;if(!_0x4e5849[_0x48dc34(0x12e)]()){let _0x36c539=fs[_0x48dc34(0x6d)](_0x1abba3+_0x4e5849[_0x48dc34(0x1ce)]);if(_0x2513cf==_0x48dc34(0x6e)){const _0x345583=/^bot-[0-9]{3}-config.json$/,_0x2693ca=_0x345583[_0x48dc34(0xad)](_0x4e5849['name']);if(_0x2693ca){const _0xd935d=JSON['parse'](_0x36c539);if(_0xd935d['bot'][0x0]){_0xd935d[_0x48dc34(0x158)][0x0][_0x48dc34(0xf5)]=_0x48dc34(0x19a),_0xd935d[_0x48dc34(0x158)][0x0]['apiSecret']='***';if(_0xd935d[_0x48dc34(0x158)][0x0]['apiPassword'])_0xd935d[_0x48dc34(0x158)][0x0][_0x48dc34(0x208)]='***';}_0x36c539=JSON[_0x48dc34(0x1b6)](_0xd935d,null,0x2);}if(_0x4e5849['name']==_0x48dc34(0xe7)){const _0x364e39=JSON[_0x48dc34(0x216)](_0x36c539);if(_0x364e39[_0x48dc34(0x1c0)][_0x48dc34(0x15d)])_0x364e39[_0x48dc34(0x1c0)][_0x48dc34(0x15d)]=![];if(_0x364e39[_0x48dc34(0x1c0)][_0x48dc34(0xcd)])_0x364e39['settings'][_0x48dc34(0xcd)]=_0x48dc34(0x19a);if(_0x364e39[_0x48dc34(0x1c0)][_0x48dc34(0x6c)])_0x364e39[_0x48dc34(0x1c0)]['telegramToken']=_0x48dc34(0x19a);if(_0x364e39[_0x48dc34(0x1c0)][_0x48dc34(0x115)])_0x364e39[_0x48dc34(0x1c0)][_0x48dc34(0x115)]=null;_0x36c539=JSON[_0x48dc34(0x1b6)](_0x364e39,null,0x2);}if(_0x4e5849[_0x48dc34(0x1ce)]!=_0x48dc34(0xdd))_0xe47180['file'](_0x4e5849['name'],_0x36c539);}else _0xe47180[_0x48dc34(0x1ff)](_0x4e5849[_0x48dc34(0x1ce)],_0x36c539);}});const _0x22799c=_0xe47180[_0x3f6f4a(0x259)]({'base64':![],'compression':_0x3f6f4a(0x149)});fs[_0x3f6f4a(0xa8)](zippath+(_0x2513cf+_0x3f6f4a(0x237)),_0x22799c,_0x3f6f4a(0x8c));}async function unzipFile(_0x594a27,_0x39fdbc){const _0x54c3dc=_0x201782;fs[_0x54c3dc(0x181)](configpath,{'withFileTypes':!![]})[_0x54c3dc(0x1d3)](_0x56e147=>{const _0x3c911f=_0x54c3dc;if(!_0x56e147[_0x3c911f(0x12e)]())fs[_0x3c911f(0x1c3)](configpath+_0x56e147[_0x3c911f(0x1ce)]);});const _0x5104db=fs[_0x54c3dc(0x6d)](_0x594a27+_0x39fdbc,_0x54c3dc(0x8c)),_0x574d02=new require(_0x54c3dc(0x22e))(_0x5104db,{'base64':![],'checkCRC32':!![]});Object[_0x54c3dc(0x144)](_0x574d02[_0x54c3dc(0x172)])['forEach'](_0x32b48=>{const _0x304de9=_0x54c3dc,_0x1891a5=_0x574d02[_0x304de9(0x172)][_0x32b48];fs['writeFileSync'](configpath+_0x1891a5[_0x304de9(0x1ce)],_0x1891a5['_data']);}),fs[_0x54c3dc(0x181)](temppath,{'withFileTypes':!![]})[_0x54c3dc(0x1d3)](_0x34372c=>{const _0x5acd06=_0x54c3dc;if(!_0x34372c[_0x5acd06(0x12e)]())fs['rmSync'](temppath+_0x34372c['name']);}),logger[_0x54c3dc(0x1e6)](_0x54c3dc(0x1b2)),process['send']({'restore':!![]},_0x2a7f39=>{});}async function getPublicIp(){const _0x196842=_0x201782;try{const _0x34f7a1=await axios[_0x196842(0x16b)](_0x196842(0x248));publicip=_0x34f7a1['data']['ip'];}catch(_0x19f488){}}async function triggerAnalytics(){const _0x210e07=_0x201782;if(!publicip)await getPublicIp();const _0x1e34f5=getBotsWithMode();let _0x504f9e=0x0;_0x1e34f5[_0x210e07(0x1d3)](_0x3fc744=>{const _0x40b1e9=_0x210e07;if(_0x3fc744[_0x40b1e9(0x6a)]===_0x40b1e9(0x148))_0x504f9e++;});const _0x4ee1c6=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x1e34f5['length'],'numbotsenabled':_0x504f9e,'exchanges':_0x4ee1c6,'environment':environment});}async function getMessages(){const _0x14f62a=_0x201782,_0x336dfc=_0x14f62a(0x23a),_0x4cc623=new GraphQLClient(_0x336dfc),_0x54b0f2={'authorization':_0x14f62a(0x18e)},_0x554c32=serverversion[_0x14f62a(0xb5)]('.'),_0xcf6be4=_0x554c32[0x0]+'.'+_0x554c32[0x1],_0x3ed89b=Math['min'](settings[_0x14f62a(0x93)],settings['lastmsgemitted']),_0x394d03={'last':parseInt(_0x3ed89b),'bbm':_0xcf6be4},_0x30277c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xe6198d;try{_0xe6198d=await _0x4cc623['request'](_0x30277c,_0x394d03,_0x54b0f2);}catch(_0x5707e7){}if(_0xe6198d&&_0xe6198d[_0x14f62a(0xd3)]){let _0x3878c0=settings['lastmsgtelegram'];newMessages=[];for(const _0x535c77 of _0xe6198d[_0x14f62a(0xd3)]){newMessages[_0x14f62a(0x1a8)](_0x535c77);let _0xe46bd8=![];_0x535c77[_0x14f62a(0x190)]&&(updateSetting('latestversion',_0x535c77[_0x14f62a(0x190)]),_0xe46bd8=isNewerVersion(serverversion,_0x535c77['bbvNew'])||serverversion==_0x535c77['bbvNew']);if(!_0xe46bd8&&_0x535c77[_0x14f62a(0xb4)]>_0x3878c0){if(_0x535c77[_0x14f62a(0x223)]===_0x14f62a(0x77)||serverversion[_0x14f62a(0x1a6)](_0x535c77[_0x14f62a(0x223)])){let _0x57690c=''+_0x535c77[_0x14f62a(0x17a)]+'\x0a\x0a'+_0x535c77[_0x14f62a(0x1a7)];const _0x37c10f=await sendTelegramMsg(toTelegramMarkdown(_0x57690c),_0x14f62a(0x25d));if(_0x37c10f)_0x3878c0=_0x535c77[_0x14f62a(0xb4)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x14f62a(0x93),_0x3878c0),emitMessages();}}function emitMessages(){const _0x5186e1=_0x201782,_0x589f91=settings[_0x5186e1(0x12a)];let _0x294421=[];newMessages[_0x5186e1(0x1d3)](_0x546aff=>{const _0x3f2771=_0x5186e1;_0x546aff[_0x3f2771(0xb4)]>_0x589f91&&_0x294421['push'](_0x546aff);}),_0x294421[_0x5186e1(0x255)]>0x0&&getAllClients()[_0x5186e1(0x1d3)](_0x1a1dd9=>{getSocket(_0x1a1dd9['id'])['emit']('message',_0x294421);});}function confirmMessage(_0x17a979){const _0x590b90=_0x201782;updateSetting(_0x590b90(0x12a),Number(_0x17a979));}function isNewerVersion(_0x1077d5,_0x208bc9){const _0x57309b=_0x201782,_0x4670c6=_0x208bc9[_0x57309b(0xb5)]('.'),_0x3510c5=_0x1077d5[_0x57309b(0xb5)]('.');for(var _0x4f26c3=0x0;_0x4f26c3<_0x3510c5[_0x57309b(0x255)];_0x4f26c3++){const _0x5cd580=~~_0x3510c5[_0x4f26c3],_0x48b384=~~_0x4670c6[_0x4f26c3];if(_0x5cd580>_0x48b384)return!![];if(_0x5cd580<_0x48b384)return![];}return![];}function _0x20cd(_0x545db0,_0x18dcf9){const _0xc4050e=_0x411a();return _0x20cd=function(_0x641fcf,_0x469a40){_0x641fcf=_0x641fcf-0x67;let _0x411a7a=_0xc4050e[_0x641fcf];return _0x411a7a;},_0x20cd(_0x545db0,_0x18dcf9);}function toTelegramMarkdown(_0x43b679){const _0x5c0e4b=_0x201782,_0x52cadd=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3b4c3e=/\*{2}(.+?)\*{2}/gim;return _0x43b679=_0x43b679[_0x5c0e4b(0x147)](_0x52cadd,_0x5c0e4b(0x1be))['replace'](_0x3b4c3e,_0x5c0e4b(0x92)),_0x43b679;}async function validateConfigFile(){const _0x3c4229=_0x201782,_0x32f83a=dbConfig[_0x3c4229(0x16b)]('bots')[_0x3c4229(0x19f)](_0x3c4229(0xb9))[_0x3c4229(0x110)]()||[];if(_0x32f83a[_0x3c4229(0x255)]==0x0){let _0x2eecd4=0x0,_0x6303b3=[];const _0x51d9f4=/^bot-([0-9]{3})-config.json$/,_0x25fef2=fs[_0x3c4229(0x181)](configpath);_0x25fef2[_0x3c4229(0x1d3)](_0x2af50e=>{const _0x12f9ac=_0x3c4229,_0x428967=_0x51d9f4[_0x12f9ac(0x126)](_0x2af50e);if(_0x428967){const _0x73738=_0x428967[0x1];let _0x3ddab1=getBotAttributes(_0x73738);_0x6303b3[_0x12f9ac(0x1a8)]({'botID':_0x73738,'botname':_0x3ddab1[_0x12f9ac(0xd9)],'status':_0x12f9ac(0xe0),'live':'stopped'}),_0x2eecd4++;}}),_0x2eecd4!=0x0&&(dbConfig[_0x3c4229(0x16b)](_0x3c4229(0x10a))[_0x3c4229(0xc0)](_0x6303b3)[_0x3c4229(0xb0)](),config=_0x6303b3,restoredConfigFile=_0x2eecd4);}}async function restoreConfigNotify(_0x30538e){const _0xfb2a75=_0x201782;let _0x1c9a75;if(restoredConfigFile==0x1)_0x1c9a75=_0xfb2a75(0x95);else _0x1c9a75='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x30538e)io['to'](_0xfb2a75(0xc6))[_0xfb2a75(0x174)](_0xfb2a75(0xae),_0x1c9a75);else{logger[_0xfb2a75(0x133)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x1c9a75),logger['simple'](_0xfb2a75(0xe9)),logger[_0xfb2a75(0x133)]('');if(tgBot&&settings[_0xfb2a75(0x115)]&&settings[_0xfb2a75(0x1b8)]!=_0xfb2a75(0x142))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x1c9a75);}}function validateCredentials(_0x17646d,_0xa7fb5b){const _0x46e9c2=_0x201782;if(_0x17646d['username']==settings[_0x46e9c2(0x11f)]&&bcrypt[_0x46e9c2(0x1c8)](_0x17646d[_0x46e9c2(0x132)],settings[_0x46e9c2(0xcd)])){if(settings[_0x46e9c2(0x9c)])return{'allow':![],'reason':_0x46e9c2(0x17f),'token':null};else{const _0x38bb54=generateLoginToken(_0xa7fb5b);return{'allow':!![],'reason':_0x46e9c2(0x86),'token':_0x38bb54};}}else return{'allow':![],'reason':_0x46e9c2(0xbd),'token':null};}function refreshToken(_0x263f66){const _0x22d396=_0x201782,_0x2f4bc3=generateLoginToken(_0x263f66);return{'allow':!![],'reason':_0x22d396(0x86),'token':_0x2f4bc3};}function validateAccess(_0x2161a3,_0x429c7f,_0x179963){const _0x3c2bd1=_0x201782,_0x4cc959=_0x179963?_0x179963:devices[_0x429c7f]['ip'];let _0x5db26a;const _0x166e48=_0x2ecf87=>{const _0x24ee21=_0x20cd;if(settings[_0x24ee21(0x15d)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x429c7f)){const _0x145834=generateLoginToken(_0x429c7f);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x145834};}else return{'allow':![],'reason':_0x24ee21(0x69),'token':null};}else return _0x5db26a=validToken(_0x2ecf87,_0x429c7f),_0x5db26a[_0x24ee21(0x98)](_0x24ee21(0xc7))?{'allow':!![],'reason':_0x24ee21(0x104),'token':_0x2ecf87}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x24ee21(0xbb),'token':null};};if(settings[_0x3c2bd1(0x153)]){let _0x5dc5d0=[...settings['whitelist'],'::1',_0x3c2bd1(0x17b),_0x3c2bd1(0x9f)];if(_0x5dc5d0['includes'](_0x4cc959))return _0x166e48(_0x2161a3);else{_0x5db26a=validToken(_0x2161a3,_0x429c7f);if(_0x5db26a['hasOwnProperty']('success'))return _0x166e48(_0x2161a3);else{if(telegramIpApproved(_0x429c7f)){const _0x430150=generateToken(_0x429c7f);return _0x5db26a=_0x166e48(_0x2161a3),_0x5db26a['allow']?{'allow':!![],'reason':_0x3c2bd1(0xfd),'token':_0x430150}:_0x5db26a;}else return settings[_0x3c2bd1(0xa5)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x3c2bd1(0x184),'token':null};}}}else return _0x166e48(_0x2161a3);}function timelyDecrypt(_0x5abd77,_0x1c6d7b=!![]){const _0x392406=_0x201782;if(_0x5abd77)try{const _0x418db5=crypt['decrypt'](secure[_0x392406(0x14d)],_0x5abd77)[_0x392406(0x1a7)],_0x4b4cab=_0x418db5[_0x392406(0xb5)]('@')[0x0],_0x5000f0=_0x418db5[_0x392406(0xb5)]('@')[0x1],_0x548df5=new Date()[_0x392406(0x156)]();if(_0x1c6d7b){if(_0x548df5-_0x5000f0<maxSecretAge*0x3e8)return _0x4b4cab;else return![];}else return _0x4b4cab;}catch(_0x2edf29){return![];}else return![];}const validToken=(_0x109c99,_0x4fe871)=>{const _0x2908a4=_0x201782,_0x2527f2=devices[_0x4fe871]['ip'];if(!_0x109c99)return{'error':_0x2908a4(0x251)};for(let _0x5d1b93 of blacklist){if(_0x5d1b93[_0x2908a4(0xed)]==_0x109c99)return{'error':_0x2908a4(0x1e4)};}let _0x5bf270;try{_0x5bf270=jwt[_0x2908a4(0x1b1)](_0x109c99,secure[_0x2908a4(0x14b)]+_0x4fe871);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5bf270[_0x2908a4(0x98)](_0x2908a4(0x1bc))&&!_0x5bf270['hasOwnProperty'](_0x2908a4(0xaf))||!_0x5bf270[_0x2908a4(0x98)](_0x2908a4(0x1cd)))return{'error':_0x2908a4(0xc8)};if(!_0x5bf270[_0x2908a4(0x98)](_0x2908a4(0xaf))&&_0x5bf270[_0x2908a4(0x98)](_0x2908a4(0x1bc))){const {clientip:_0x23ae59}=_0x5bf270;return _0x2527f2==_0x23ae59?{'success':_0x2908a4(0x1d5)}:{'error':_0x2908a4(0x9b)};}else{if(_0x5bf270[_0x2908a4(0x98)]('username')&&_0x5bf270[_0x2908a4(0x98)](_0x2908a4(0x1bc))){const {username:_0x58b05e,clientip:_0x577e85}=_0x5bf270;return settings[_0x2908a4(0x11f)]==_0x58b05e&&_0x2527f2==_0x577e85?{'success':_0x2908a4(0x1d5)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x34befb=>{const _0x57ec8e=_0x201782;if(_0x34befb){const _0x28a502=devices[_0x34befb]['ip'];return jwt[_0x57ec8e(0x227)]({'username':settings[_0x57ec8e(0x11f)],'clientip':_0x28a502},secure[_0x57ec8e(0x14b)]+_0x34befb,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1c5ae4=>{const _0xf8b008=_0x201782;if(_0x1c5ae4){const _0x159d7d=devices[_0x1c5ae4]['ip'];return jwt[_0xf8b008(0x227)]({'clientip':_0x159d7d},secure[_0xf8b008(0x14b)]+_0x1c5ae4,{'expiresIn':devices[_0x1c5ae4]['telegramIpApproval'][_0xf8b008(0x103)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x15a274=>{const _0x42dc54=_0x201782;let _0x4dffdb=![];return devices[_0x15a274][_0x42dc54(0x233)]&&devices[_0x15a274][_0x42dc54(0x233)][_0x42dc54(0x103)]!=_0x42dc54(0x159)&&(_0x4dffdb=devices[_0x15a274][_0x42dc54(0x233)][_0x42dc54(0x1bc)]==devices[_0x15a274]['ip']&&new Date()[_0x42dc54(0x156)]()-devices[_0x15a274]['telegramIpApproval'][_0x42dc54(0x250)]<devices[_0x15a274][_0x42dc54(0x233)]['expiry']*0x3c*0x3e8),_0x4dffdb;},telegram2FaApproved=_0x9142c9=>{const _0x476403=_0x201782;let _0x26fea7=![];return devices[_0x9142c9][_0x476403(0x238)]&&devices[_0x9142c9][_0x476403(0x238)][_0x476403(0x103)]!=_0x476403(0x159)&&(_0x26fea7=devices[_0x9142c9]['telegram2FaApproval']['clientip']==devices[_0x9142c9]['ip']&&new Date()[_0x476403(0x156)]()-devices[_0x9142c9]['telegram2FaApproval'][_0x476403(0x250)]<devices[_0x9142c9][_0x476403(0x238)]['expiry']*0x3c*0x3e8),_0x26fea7;},normalizeIP=_0x1ac0b8=>{const _0x2464c7=_0x201782;let _0x3070df=null,_0xa2308f=null;if(ipaddr['isValid'](_0x1ac0b8)){const _0x472214=ipaddr[_0x2464c7(0x216)](_0x1ac0b8);_0x472214[_0x2464c7(0x24b)]()===_0x2464c7(0x140)?(_0x472214[_0x2464c7(0x113)]()&&(_0x3070df=_0x472214[_0x2464c7(0xec)]()[_0x2464c7(0xb3)]()),_0xa2308f=_0x472214['toString']()):(_0x3070df=_0x472214[_0x2464c7(0xb3)](),_0xa2308f=_0x472214[_0x2464c7(0x162)]()['toString']());}return{'show':_0x3070df?_0x3070df:_0xa2308f,'store':_0xa2308f};};function formatDate(_0x4d0084){const _0x9db0d3=_0x201782;return _0x4d0084[_0x9db0d3(0x257)]()+'/'+(_0x4d0084[_0x9db0d3(0x128)]()+0x1)[_0x9db0d3(0xb3)]()[_0x9db0d3(0xc3)](0x2,'0')+'/'+_0x4d0084[_0x9db0d3(0x18a)]()[_0x9db0d3(0xb3)]()[_0x9db0d3(0xc3)](0x2,'0')+'\x20'+_0x4d0084[_0x9db0d3(0x229)]()[_0x9db0d3(0xb3)]()[_0x9db0d3(0xc3)](0x2,'0')+':'+_0x4d0084[_0x9db0d3(0x193)]()['toString']()[_0x9db0d3(0xc3)](0x2,'0')+':'+_0x4d0084['getSeconds']()[_0x9db0d3(0xb3)]()[_0x9db0d3(0xc3)](0x2,'0');}function sleep(_0x167981){return new Promise(_0xa524e2=>setTimeout(_0xa524e2,_0x167981));}