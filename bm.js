const _0xc54fdc=_0x304a;(function(_0x3a0f03,_0x15b256){const _0x79d567=_0x304a,_0x1bbfd9=_0x3a0f03();while(!![]){try{const _0x3cce50=parseInt(_0x79d567(0x24c))/0x1+-parseInt(_0x79d567(0x29a))/0x2+-parseInt(_0x79d567(0x1d2))/0x3+parseInt(_0x79d567(0x21d))/0x4*(parseInt(_0x79d567(0x1d1))/0x5)+-parseInt(_0x79d567(0x14c))/0x6+-parseInt(_0x79d567(0x245))/0x7*(-parseInt(_0x79d567(0x206))/0x8)+parseInt(_0x79d567(0x23b))/0x9*(parseInt(_0x79d567(0x1a4))/0xa);if(_0x3cce50===_0x15b256)break;else _0x1bbfd9['push'](_0x1bbfd9['shift']());}catch(_0x2575ea){_0x1bbfd9['push'](_0x1bbfd9['shift']());}}}(_0x59d3,0x21707));const _0x3a26f2=function(){let _0x3c6883=!![];return function(_0x452fb8,_0x122214){const _0x2d0e10=_0x3c6883?function(){const _0x4d1f72=_0x304a;if(_0x122214){const _0x18d732=_0x122214[_0x4d1f72(0x150)](_0x452fb8,arguments);return _0x122214=null,_0x18d732;}}:function(){};return _0x3c6883=![],_0x2d0e10;};}(),_0x5436db=_0x3a26f2(this,function(){const _0x3d464d=_0x304a;return _0x5436db[_0x3d464d(0x17a)]()[_0x3d464d(0x229)](_0x3d464d(0x137))['toString']()[_0x3d464d(0x161)](_0x5436db)['search'](_0x3d464d(0x137));});_0x5436db();'use strict';process['env'][_0xc54fdc(0x263)]=0x1;function _0x59d3(){const _0x3b825f=['binary','No\x20bots\x20running\x20right\x20now','botID','Disabled\x20Bot\x20','_data','timeshift','/output-000.log','Unauthorized\x20attempt\x20to\x20update\x20bot','Token\x20blacklisted','from','whitelist','Unauthorized\x20attempt\x20to\x20get\x20messages','copyFileSync','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','934926IDSiha','socket','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getTime','apply','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','decrypt','disabled','warning','place-order','apiKey','stopped','reject','Login\x20accepted','running','success','answerCallbackQuery','order','deleteHistoryAlerts','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','store-configuration','constructor','-results.json','callback_query','output-003.log','argv','Enabled\x20Bot\x20','username','download','botmanager','number','Access\x20enabled\x20for\x20','get-portfolio','getDate','getUTCHours','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','pidExpireLogin','simple','clients','apiSecret','store-headless','internal','length','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','emit','bot','toString','map','Notifications\x20disabled\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','settings','access\x20timeout','user','toIPv4Address','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','slice','any','uncaughtException','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','0.0.0','backup/','clientip','readdirSync','node-telegram-bot-api','</b>\x20?','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','2FA\x20login\x20token\x20generated','Your\x20installation\x20is\x20already\x20up\x20to\x20date','hybrid-crypto-js','emitHistory','startsWith','mode','password','update','127.0.0.1','\x1b[31m','Yes','\x1b[0m','child_process','connection','sendMessage','init','sign','getMonth','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Error:\x20Invalid\x20argument\x20','bb-secure.json','10jrflKo','alerts','/update\x20-\x20update\x20Balance\x20Bot\x0a','data','address','push','chat','isValid','all','kill','headless','static','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','DEFLATE','reset-password','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','RSA-OAEP','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','auto','#RES#\x20if\x20running\x20locally\x0a','output-000.log','bbvReceive','/:bot/history','expiry','keys','messages','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Ok,\x20will\x20send\x20order\x20notifications\x20only','confirm-message','bcryptjs','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','/help\x20-\x20show\x20available\x20commands\x0a','reason','storeFiat','store','node-zip','\x20minutes','Restore\x20process\x20aborted','Temporary\x20access\x20rejected','uuid','latestversion','get-backup-files','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Invalid\x20authentication\x20token\x20(2)','551505noPwcN','3843tfqfOH','/upload-backup','\x20(1)','debug','status','files','/:bot/configuration','event','Alerts','Restoring\x20bot(s)\x20from\x20backup','Notifications\x20enabled\x0a','showname','\x1b[33m','bbUsername','30\x20min','hasOwnProperty','once','connected','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20attempt\x20to\x20download\x20','access','-config.json','catch','::ffff:127.0.0.1','Starting\x20new\x20bot\x20|\x20Bot\x20','=>\x20Go\x20to\x20#BLU#http://localhost:','get','inherit','toIPv4MappedAddress','file','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Bot\x20Mgr\x20>\x20','get-starting-balances','zip/',',\x20must\x20be\x20a\x204\x20digit\x20number','remoteAddress','Backup\x20file\x20uploaded','getHours','mkdirSync','yes','RSA','value','size','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','store-fiat','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Setting\x20access:\x20','toggle-bot-mode','listen','server','login','verify','8kWYaFz','Error\x20while\x20deleting\x20config\x20files:\x20','Session\x20expired\x20for\x20user\x20...','getFullYear','6b67f3d61ee94b8f5c80b4affef4c4d9','Restore\x20backup\x20file\x20','delete-bot','telegram2FaApproval','orders','api-eu.mixpanel.com','\x1b[34m','show','createServer','join','\x20>\x20','userid','graphql-request','loginRequired','showConfig','Login\x20rejected','/status\x20-\x20show\x20bot(s)\x20status\x0a','parse','backup-full.zip','4PDwujB','Server','.zip','polling_error','sendFile','find','forEach','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','invalid\x20credentials','Invalid\x20authentication\x20token\x20(1)','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20store\x20configuration','search','use','type','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','telegram','$1_$2_$3','sendMetricsTelegram','pidRefreshToken','jsonwebtoken','kind','lowdb/adapters/FileSync','Starting\x20bot\x20|\x20Bot\x20','Notifications\x20types:\x20','storeConfiguration','hashSync','getMinutes','/:bot/portfolio','\x20mode','2672253AILaql','post','timestamp','allow','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','handshake','whitelistEnabled','2FA\x20required','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','*$1*','165879LIazFp','stopPolling','endsWith','Logged\x20out\x20user\x20...','title','enabled','blacklist','121595JvvMhv','removeListener','test','publicKey','accept','message','Password\x20has\x20been\x20reset\x20to:\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','auth','telegramEnabled','output-002.log','bots','min','#RES#\x20if\x20running\x20on\x20server','headers','telegramChatId','bb-config.json','telegramEvents','match','onepagemode','show-config','rmSync','reload','NTBA_FIX_319','disconnect','secure','statSync','***','sendPortfolioTelegram','existsSync','login\x20token\x20valid','express','5\x20min','placeOrder','isIPv4MappedAddress','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Password\x20reset\x20rejected','telegramUsername','cloneDeep',':\x20Bot\x20Mgr\x20>\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','settings.','notification','temporaryAccessAllowed','<b>Balance\x20Bot\x20Status:</b>\x0a','::1','max','backup-files','backup-full','privateKey','params','bbPassword','then','function','-performance.json','started','/restart\x20-\x20restart\x20bot(s)\x0a','build','node','port','mtime','temporary\x20access\x20rejected','getSeconds','telegrammsg','includes','split','live','All\x20bots','Unauthorized\x20attempt\x20to\x20show\x20configuration','HTML','ipc','stop','output-001.log','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Network\x20Interfaces:','util','-----------------------------------------------------------------------------------','3000','516882MOzwqG','reinstall-bb','write','axios','secret','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','name','Deleted\x20Bot\x20','isDirectory','temporary\x20token\x20generated','telegramToken','sortBy','1000','error','padStart','restart','f2aRequired','writeFileSync','logged\x20out','Starting\x20Balance\x20Bot\x20','args','User\x20has\x20been\x20validated','config/','Unauthorized\x20attempt\x20to\x20confirm\x20message','lowdb','login\x20required','add-bot','index.html','removeAllListeners','assign','fork','You\x20can\x20use\x20the\x20following\x20commands:\x0a','path','/download/:type','private','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','#RES#\x0a','logs/','\x20only\x0a','unlinkSync','/:bot/support','full','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','resetHistory','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','track','https://api.ipify.org?format=json','bot.js','[ip-address]','/:bot/coins','botname','Failed\x20to\x20download\x20','ipaddr.js',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Restarting\x20Bot\x20','onText','request','update-bb','send','defaults','manual','Allow\x20login\x20from\x20IP\x20address\x20<b>','/:bot','sort','sockets','new-disabled','Invalid\x20IP\x20address','/names\x20-\x20show\x20bot\x20names\x0a','/disable\x20-\x20disable\x20notifications\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','host','IPv4','bbvNew','bot-','lastmsgtelegram','family','=>\x20Go\x20to\x20#BLU#http://','login\x20not\x20required','sha256','cancel-loading','Bot\x20','telegramIpApproval','yargs/yargs','readFileSync','logout','Unauthorized\x20attempt\x20to\x20log\x20out','token','replace','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','remove','backup-full@','get-messages','2FA\x20login\x20required','conn','entries','2FA','Notifications\x20enabled','build2','\x20|\x20','exit','temp/','bb/','http','backup','reset-history','************','reinstall','date-fns','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/on\x20-\x20start\x20bot(s)\x0a','log','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Invalid\x20Telegram\x20token','store-settings','format','Unauthorized\x20login\x20attempt\x20(timeout)','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20update\x20settings','bb-settings.json','stringify','filter','lastmsgemitted','(((.+)+)+)+$','apiPassword','alias','No\x20authentication\x20token','login\x20token\x20generated','compareSync','new'];_0x59d3=function(){return _0x3b825f;};return _0x59d3();}const childProcess=require(_0xc54fdc(0x19a)),fs=require('fs'),fns=require(_0xc54fdc(0x127)),low=require(_0xc54fdc(0x2b3)),FileSync=require(_0xc54fdc(0x233)),path=require(_0xc54fdc(0xda)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0xc54fdc(0x190))[_0xc54fdc(0x1fa)],bcrypt=require(_0xc54fdc(0x1c1)),jwt=require(_0xc54fdc(0x231)),ipaddr=require(_0xc54fdc(0xf0)),argv=require(_0xc54fdc(0x10e))(process[_0xc54fdc(0x165)][_0xc54fdc(0x183)](0x2))[_0xc54fdc(0x165)],uuidRandom=require('uuid-random'),TelegramBot=require(_0xc54fdc(0x18b)),Mixpanel=require('mixpanel'),axios=require(_0xc54fdc(0x29d)),{GraphQLClient,gql}=require(_0xc54fdc(0x216)),util=require(_0xc54fdc(0x297)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0xc54fdc(0x287)]||_0xc54fdc(0x299),pattern=/^[0-9]{2,4}$/;!pattern[_0xc54fdc(0x24e)](PORT)&&(console[_0xc54fdc(0x12b)](_0xc54fdc(0x1a2)+PORT+_0xc54fdc(0x1f4)),process['exit'](0x1));const HOST=argv[_0xc54fdc(0x102)]||null,userID=argv[_0xc54fdc(0x180)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0xc54fdc(0x286)];let bbpath=_0xc54fdc(0x121),bbpath2='';const botfile=_0xc54fdc(0xeb),configfile=_0xc54fdc(0x25c),settingsfile='bb-settings.json',securefile=_0xc54fdc(0x1a3),maxBackups=0xa;let validInstallation=!![];!fs[_0xc54fdc(0x269)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xc54fdc(0x172)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0xc54fdc(0x2b1),configbackuppath=configpath+_0xc54fdc(0x188),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0xc54fdc(0xe0),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0xc54fdc(0x1f3),loggerfile=fs['createWriteStream'](logspath+_0xc54fdc(0x144),{'flags':'a'}),temppath=userID?bbpath+_0xc54fdc(0x120)+userID+'/':bbpath+_0xc54fdc(0x120);function _0x304a(_0x21ef5f,_0xc5af70){const _0xc478e8=_0x59d3();return _0x304a=function(_0x5436db,_0x3a26f2){_0x5436db=_0x5436db-0xd5;let _0x59d386=_0xc478e8[_0x5436db];return _0x59d386;},_0x304a(_0x21ef5f,_0xc5af70);}!fs[_0xc54fdc(0x269)](configpath)&&fs[_0xc54fdc(0x1f8)](configpath);!fs[_0xc54fdc(0x269)](configbackuppath)&&fs[_0xc54fdc(0x1f8)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0xc54fdc(0x1f8)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs[_0xc54fdc(0x1f8)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xc54fdc(0xf7)]({'bots':[]})[_0xc54fdc(0x29c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xc54fdc(0x187),'onepagemode':![]}})[_0xc54fdc(0x29c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xc54fdc(0xf7)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0xc54fdc(0x10a),'rsaStandard':_0xc54fdc(0x1b4)});const saltRounds=0xa,mixpanel=Mixpanel[_0xc54fdc(0x19d)](_0xc54fdc(0x20a),{'host':_0xc54fdc(0x20f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xc54fdc(0x2a5)]&&settings['telegramToken']!=''&&settings[_0xc54fdc(0x271)]&&settings[_0xc54fdc(0x271)]!='')initTelegram();const parseColor=(_0x5e7fa9,_0x2909bd)=>{const _0x1e462e=_0xc54fdc,_0x11bcf6=/#[A-Z]{3}#/g;!_0x2909bd?_0x5e7fa9=_0x5e7fa9[_0x1e462e(0x113)](_0x11bcf6,''):(_0x5e7fa9=_0x5e7fa9[_0x1e462e(0x113)](/#BLU#/g,_0x1e462e(0x210)),_0x5e7fa9=_0x5e7fa9[_0x1e462e(0x113)](/#RED#/g,_0x1e462e(0x197)),_0x5e7fa9=_0x5e7fa9[_0x1e462e(0x113)](/#YEL#/g,_0x1e462e(0x1de)),_0x5e7fa9=_0x5e7fa9['replace'](/#RES#/g,_0x1e462e(0x199)));;return _0x5e7fa9;},logger={'screen':_0xc5823e=>{const _0x504d97=_0xc54fdc;console[_0x504d97(0x12b)](parseColor(_0xc5823e,!![]));},'simple':_0x4eeb72=>{const _0x191709=_0xc54fdc;console['log'](parseColor(_0x4eeb72,!![])),loggerfile[_0x191709(0x29c)](util['format'](parseColor(_0x4eeb72,![]))+'\x0a');},'full':async _0x555b7b=>{const _0x133ec4=_0xc54fdc,_0x1928c5=getTimeStamp()+_0x133ec4(0x273)+_0x555b7b;console[_0x133ec4(0x12b)](parseColor(_0x1928c5,!![])),loggerfile['write'](util[_0x133ec4(0x12f)](parseColor(_0x1928c5,![]))+'\x0a');if(tgBot&&settings[_0x133ec4(0x25b)]&&settings[_0x133ec4(0x25d)]!=_0x133ec4(0x20e))await tgBot[_0x133ec4(0x19c)](settings[_0x133ec4(0x25b)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x555b7b,![]))[_0x133ec4(0x1e8)](_0x16b3af=>{telegramError(_0x16b3af);});},'debug':async(_0x2a0b4f,_0x251276='')=>{const _0x18f956=_0xc54fdc,_0xe2d376=getTimeStamp()+_0x18f956(0xf1)+_0x2a0b4f;if(debugging)console[_0x18f956(0x12b)](parseColor(_0xe2d376,!![]));loggerfile[_0x18f956(0x29c)](util['format'](parseColor(_0xe2d376,![]))+'\x0a');if(_0x251276){if(debugging)console[_0x18f956(0x12b)](_0x251276);loggerfile['write'](util[_0x18f956(0x12f)](_0x251276)+'\x0a');}}};process['on'](_0xc54fdc(0x185),function(_0x51dace){const _0x182f48=_0xc54fdc;logger[_0x182f48(0x171)](_0x51dace);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xc54fdc(0x26b)),app=express(),http=require(_0xc54fdc(0x122))[_0xc54fdc(0x212)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0xc54fdc(0x1ec)](_0xc54fdc(0xdb),async(_0x33bdfb,_0x8d7db6)=>{const _0x20ea2e=_0xc54fdc,_0x2bd04c=_0x33bdfb[_0x20ea2e(0x27e)][_0x20ea2e(0x22b)],_0x14d230=getClientsWithBotID(_0x20ea2e(0x169)),_0x4f03b0=_0x33bdfb['headers']['uuid'],_0x359a20=timelyDecrypt(_0x4f03b0,![]),_0x1df288=_0x14d230[_0x20ea2e(0x222)](_0x514cc7=>_0x514cc7[_0x20ea2e(0x1cb)]==_0x359a20);if(_0x1df288){const _0x100cc8=normalizeIP(_0x33bdfb[_0x20ea2e(0x14d)][_0x20ea2e(0x1f5)])['store'],_0x4dc64f=_0x33bdfb['headers']['tkn'];if(validateAccess(_0x4dc64f,_0x359a20,_0x100cc8)[_0x20ea2e(0x23e)])_0x2bd04c=='backup'&&await backupConfigFiles(),await zipFiles(_0x2bd04c),_0x8d7db6[_0x20ea2e(0x168)](zippath+(_0x2bd04c+_0x20ea2e(0x21f)),_0x102e66=>{const _0x27112d=_0x20ea2e;_0x102e66&&(logger[_0x27112d(0xe4)](_0x27112d(0xef)+_0x2bd04c),logger[_0x27112d(0x171)](_0x102e66));});else logger[_0x20ea2e(0xe4)](_0x20ea2e(0x1e5)+_0x2bd04c+_0x20ea2e(0x1d4));}else logger[_0x20ea2e(0xe4)](_0x20ea2e(0x1e5)+_0x2bd04c+'\x20(2)');}),app[_0xc54fdc(0x23c)](_0xc54fdc(0x1d3),async(_0x4ff46e,_0x27ee5d)=>{const _0x3e075c=_0xc54fdc,_0x21f452=getClientsWithBotID(_0x3e075c(0x169)),_0x537677=_0x4ff46e[_0x3e075c(0x25a)]['uuid'],_0x7bd573=timelyDecrypt(_0x537677,![]),_0x3011a1=_0x21f452[_0x3e075c(0x222)](_0x1eb769=>_0x1eb769[_0x3e075c(0x1cb)]==_0x7bd573);logger[_0x3e075c(0x1d5)](_0x3e075c(0x1f6));if(_0x3011a1){const _0xa1ef8=normalizeIP(_0x4ff46e[_0x3e075c(0x14d)][_0x3e075c(0x1f5)])[_0x3e075c(0x1c6)],_0x5daf84=_0x4ff46e[_0x3e075c(0x25a)]['tkn'];if(validateAccess(_0x5daf84,_0x7bd573,_0xa1ef8)[_0x3e075c(0x23e)]){if(_0x4ff46e['files']){const _0x2684b4=_0x4ff46e['files']['backupfile'];await _0x2684b4['mv'](temppath+_0x2684b4[_0x3e075c(0x2a1)]),_0x27ee5d[_0x3e075c(0xf6)]({'status':!![],'message':'File\x20uploaded'});const _0x3a1f59=getBotsWithMode();_0x3a1f59[_0x3e075c(0x176)]>0x0?confirmRestore(temppath,_0x2684b4[_0x3e075c(0x2a1)]):unzipFile(temppath,_0x2684b4['name']);}}else logger[_0x3e075c(0xe4)](_0x3e075c(0x1ce));}else logger[_0x3e075c(0xe4)](_0x3e075c(0x1cf));}),app[_0xc54fdc(0x22a)](express[_0xc54fdc(0x1af)](path['join'](__dirname,bbpath2,_0xc54fdc(0x11d)))),app[_0xc54fdc(0x22a)](express[_0xc54fdc(0x1af)](path[_0xc54fdc(0x213)](__dirname,bbpath2,_0xc54fdc(0x285)))),app['get']('/',function(_0x2579db,_0x5eae74){const _0x244454=_0xc54fdc;_0x5eae74['sendFile'](path[_0x244454(0x213)](__dirname,bbpath2,_0x244454(0x11d),_0x244454(0xd5)));}),app['get'](_0xc54fdc(0xfa),function(_0x5386c2,_0x1aa347){const _0xd0a7a7=_0xc54fdc;_0x1aa347[_0xd0a7a7(0x221)](path[_0xd0a7a7(0x213)](__dirname,bbpath2,_0xd0a7a7(0x285),_0xd0a7a7(0xd5)));}),app[_0xc54fdc(0x1ec)](_0xc54fdc(0x239),(_0x58b1c1,_0x4a4c66)=>{const _0x4a4381=_0xc54fdc;_0x4a4c66[_0x4a4381(0x221)](path[_0x4a4381(0x213)](__dirname,bbpath2,_0x4a4381(0x285),_0x4a4381(0xd5)));}),app[_0xc54fdc(0x1ec)]('/:bot/performance',(_0x2f368f,_0xc826b5)=>{const _0x30273e=_0xc54fdc;_0xc826b5[_0x30273e(0x221)](path[_0x30273e(0x213)](__dirname,bbpath2,'build',_0x30273e(0xd5)));}),app['get'](_0xc54fdc(0xed),(_0x24cb8a,_0x5ad335)=>{const _0x3b4a78=_0xc54fdc;_0x5ad335[_0x3b4a78(0x221)](path[_0x3b4a78(0x213)](__dirname,bbpath2,'build','index.html'));}),app[_0xc54fdc(0x1ec)](_0xc54fdc(0x1ba),(_0x4c5bd2,_0x5b93dc)=>{const _0x2902ef=_0xc54fdc;_0x5b93dc[_0x2902ef(0x221)](path[_0x2902ef(0x213)](__dirname,bbpath2,_0x2902ef(0x285),_0x2902ef(0xd5)));}),app['get'](_0xc54fdc(0x1d8),(_0x39c80d,_0x23fed7)=>{const _0x2c7741=_0xc54fdc;_0x23fed7[_0x2c7741(0x221)](path['join'](__dirname,bbpath2,'build',_0x2c7741(0xd5)));}),app[_0xc54fdc(0x1ec)](_0xc54fdc(0xe3),(_0x5ab042,_0x5db7e0)=>{const _0xabb4f1=_0xc54fdc;_0x5db7e0[_0xabb4f1(0x221)](path[_0xabb4f1(0x213)](__dirname,bbpath2,_0xabb4f1(0x285),_0xabb4f1(0xd5)));});if(HOST)http[_0xc54fdc(0x202)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5f0120=_0xc54fdc;let _0x55b70a=_0x5f0120(0xec);const _0x52001a=networkInterfaces(),_0x1c8cfd={};for(const _0x3969f8 of Object['keys'](_0x52001a)){for(const _0x181525 of _0x52001a[_0x3969f8]){if((_0x181525[_0x5f0120(0x107)]==_0x5f0120(0x103)||_0x181525[_0x5f0120(0x107)]==0x4)&&!_0x181525[_0x5f0120(0x175)]){const _0x734b25=ipaddr[_0x5f0120(0x21b)](_0x181525[_0x5f0120(0x1a8)])['range']();_0x734b25!=_0x5f0120(0xdc)&&(!_0x1c8cfd[_0x3969f8]&&(_0x1c8cfd[_0x3969f8]=[]),_0x1c8cfd[_0x3969f8][_0x5f0120(0x1a9)](_0x181525[_0x5f0120(0x1a8)]),_0x55b70a=_0x181525[_0x5f0120(0x1a8)]);}}}return logger[_0x5f0120(0x1d5)](_0x5f0120(0x296),_0x1c8cfd),_0x55b70a;}async function startServer(){const _0x1b03ca=_0xc54fdc;logger[_0x1b03ca(0x171)](''),logger['simple'](_0x1b03ca(0x298)),await logger[_0x1b03ca(0xe4)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x1b03ca(0xdf)+(_0x1b03ca(0x1eb)+PORT+_0x1b03ca(0x1b7))+(_0x1b03ca(0x108)+getServerIP()+':'+PORT+_0x1b03ca(0x259))),await logger[_0x1b03ca(0x1d5)]('Node.js\x20v'+nodeversion),logger['simple']('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0xf33726 of config){if(_0xf33726[_0x1b03ca(0x1d6)]=='enabled'||_0xf33726[_0x1b03ca(0x1d6)]==_0x1b03ca(0x13d))await logger[_0x1b03ca(0xe4)](_0x1b03ca(0x234)+_0xf33726[_0x1b03ca(0x140)]+_0x1b03ca(0x11e)+_0xf33726[_0x1b03ca(0xee)]),startBot([_0xf33726[_0x1b03ca(0x140)],userID],{'cwd':bbpath},function(_0x48fa5d){const _0x1b0d7d=_0x1b03ca;if(_0x48fa5d)logger[_0x1b0d7d(0xe4)](_0x48fa5d);});else(_0xf33726['status']==_0x1b03ca(0x153)||_0xf33726['status']=='new-disabled')&&await logger['full'](_0x1b03ca(0x29f)+_0xf33726[_0x1b03ca(0x140)]+_0x1b03ca(0x11e)+_0xf33726[_0x1b03ca(0xee)]);}else!newBot&&logger[_0x1b03ca(0x171)](_0x1b03ca(0x15f));if(newBot)addBot();logger[_0x1b03ca(0x171)](_0x1b03ca(0x298)),logger[_0x1b03ca(0x171)]('');}function startSocket(){const _0x506053=_0xc54fdc;io['on'](_0x506053(0x19b),_0x19517e=>{const _0x2c80b4=_0x506053;let _0x2ee99c,_0x1dbe0a,_0x4284ae,_0x48e0a8,_0x1464e5;const _0x1bf19c=_0x19517e[_0x2c80b4(0x240)]['headers']['referer'];_0x1dbe0a=_0x1bf19c[_0x2c80b4(0x25e)](/bot[0-9]{3}/);if(_0x1dbe0a)_0x4284ae=_0x1dbe0a[0x0][_0x2c80b4(0x25e)](/[0-9]{3}/);if(_0x4284ae)_0x2ee99c=_0x4284ae[0x0];else _0x2ee99c=_0x2c80b4(0x169);const _0xd6a537=_0x19517e[_0x2c80b4(0x240)][_0x2c80b4(0x254)]['encryptedUuid'];if(!_0xd6a537)_0x19517e[_0x2c80b4(0x178)](_0x2c80b4(0x1d6),{'publicKey':secure[_0x2c80b4(0x24f)]});else{_0x48e0a8=timelyDecrypt(_0xd6a537,![]);if(!_0x48e0a8)_0x19517e['emit'](_0x2c80b4(0x1d6),{'publicKey':secure[_0x2c80b4(0x24f)]});else{_0x1464e5=normalizeIP(_0x19517e[_0x2c80b4(0x119)]['remoteAddress'])[_0x2c80b4(0x1c6)];if(!devices[_0x48e0a8])devices[_0x48e0a8]={'uuid':_0x48e0a8,'access':{'token':null}};devices[_0x48e0a8]['ip']=_0x1464e5;const _0x43ed34=addClient(_0x19517e['id'],_0x48e0a8,_0x2ee99c);setAccess(_0x43ed34),emitMessages(),_0x19517e['on'](_0x2c80b4(0x204),_0x55e522=>{const _0x8ab7d4=_0x2c80b4,_0x4f3698=timelyDecrypt(_0x55e522[_0x8ab7d4(0x194)]);if(_0x4f3698){_0x55e522={'username':_0x55e522[_0x8ab7d4(0x167)],'password':_0x4f3698},devices[_0x48e0a8][_0x8ab7d4(0x1e6)]=validateCredentials(_0x55e522,_0x48e0a8);if(devices[_0x48e0a8][_0x8ab7d4(0x1e6)][_0x8ab7d4(0x23e)]==![]&&devices[_0x48e0a8][_0x8ab7d4(0x1e6)][_0x8ab7d4(0x1c4)]==_0x8ab7d4(0x118))_0x19517e[_0x8ab7d4(0x178)](_0x8ab7d4(0x1d6),{'access':devices[_0x48e0a8]['access']}),loginAccess2FA(_0x48e0a8,_0x1464e5);else{if(devices[_0x48e0a8][_0x8ab7d4(0x1e6)][_0x8ab7d4(0x23e)]==![]&&devices[_0x48e0a8][_0x8ab7d4(0x1e6)][_0x8ab7d4(0x1c4)]==_0x8ab7d4(0x225))_0x19517e['emit'](_0x8ab7d4(0x1d6),{'access':devices[_0x48e0a8][_0x8ab7d4(0x1e6)]});else devices[_0x48e0a8][_0x8ab7d4(0x1e6)][_0x8ab7d4(0x23e)]&&devices[_0x48e0a8]['access'][_0x8ab7d4(0x1c4)]==_0x8ab7d4(0x13b)&&(getClientsWithUuid(_0x48e0a8)[_0x8ab7d4(0x223)](_0x55446b=>{setAccess(_0x55446b);}),logger[_0x8ab7d4(0x1d5)]('Logged\x20in\x20user\x20...'+_0x48e0a8[_0x8ab7d4(0x183)](-0x8)),setTokenRefresh(_0x48e0a8),setSessionTimeout(_0x8ab7d4(0x204),_0x48e0a8));}}else logger[_0x8ab7d4(0xe4)](_0x8ab7d4(0x130));}),_0x19517e['on'](_0x2c80b4(0x1b2),()=>{resetPassword();}),_0x19517e['on'](_0x2c80b4(0x264),_0x298210=>{removeClient(_0x19517e['id']);}),_0x2ee99c==_0x2c80b4(0x169)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x36ce22){const _0x427635=_0xc54fdc;if(_0x36ce22!=_0x427635(0x169)&&config['apiKey']!=''){if(pid[_0x36ce22])pid[_0x36ce22][_0x427635(0xf6)]({'function':'initclient','args':null});}_0x36ce22!=_0x427635(0x169)&&broadcastToBots('bots',JSON[_0x427635(0x134)](config));}function reloadBotManager(){const _0x3a6a11=_0xc54fdc;getClientsWithBotID(_0x3a6a11(0x169))[_0x3a6a11(0x223)](_0x36e618=>{const _0x207eb8=_0x3a6a11;getSocket(_0x36e618['id'])[_0x207eb8(0x178)](_0x207eb8(0x1d6),{'access':{'allow':![],'reason':_0x207eb8(0x262),'token':null}});});}function getSocket(_0xf1cd44){const _0x1711ca=_0xc54fdc;return io[_0x1711ca(0xfc)][_0x1711ca(0xfc)][_0x1711ca(0x1ec)](_0xf1cd44);}function setAccess(_0x5b4187){const _0x4226b2=_0xc54fdc,_0x2c6b53=getSocket(_0x5b4187['id']),_0x257104=_0x5b4187[_0x4226b2(0x1cb)],_0x59e418=_0x5b4187[_0x4226b2(0x179)];devices[_0x257104][_0x4226b2(0x1e6)]=validateAccess(devices[_0x257104][_0x4226b2(0x1e6)][_0x4226b2(0x112)],_0x257104),logger[_0x4226b2(0x1d5)](_0x4226b2(0x200)+devices[_0x257104]['access']['reason']+'\x20|\x20client:\x20...'+_0x5b4187['id'][_0x4226b2(0x183)](-0x8)+'\x20|\x20user:\x20...'+_0x257104[_0x4226b2(0x183)](-0x8)),_0x2c6b53['join'](_0x257104);if(devices[_0x257104]['access'][_0x4226b2(0x23e)]){_0x2c6b53[_0x4226b2(0x213)](_0x59e418);if(_0x59e418=='botmanager')initializeSocketBotManager(_0x2c6b53);else initializeSocketBot(_0x2c6b53);initClient(_0x59e418);}devices[_0x257104][_0x4226b2(0x1e6)]['token']&&devices[_0x257104][_0x4226b2(0x1e6)][_0x4226b2(0x1c4)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x4226b2(0x11b),_0x257104),devices[_0x257104]['access']['token']&&devices[_0x257104][_0x4226b2(0x1e6)][_0x4226b2(0x1c4)]==_0x4226b2(0x18e)&&setSessionTimeout(_0x4226b2(0x204),_0x257104),_0x2c6b53[_0x4226b2(0x178)](_0x4226b2(0x1d6),{'status':_0x5b4187[_0x4226b2(0x203)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x257104][_0x4226b2(0x1e6)],'externalip':devices[_0x257104]['ip'],'publicKey':secure[_0x4226b2(0x24f)],'userid':settings[_0x4226b2(0x215)],'validInstallation':validInstallation}),devices[_0x257104][_0x4226b2(0x1e6)][_0x4226b2(0x23e)]==![]&&devices[_0x257104][_0x4226b2(0x1e6)][_0x4226b2(0x1c4)]==_0x4226b2(0x242)&&temporaryAccess2FA(_0x257104,devices[_0x257104]['ip']);}function setSessionTimeout(_0x4322da,_0x1fc641){const _0x1f323c=_0xc54fdc;let _0x238aac;if(_0x4322da==_0x1f323c(0x204))_0x238aac=loginExpiry*0x3c*0x3e8;else _0x238aac=devices[_0x1fc641][_0x1f323c(0x10d)][_0x1f323c(0x1bb)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1fc641]['telegramIpApproval'][_0x1f323c(0x23d)]);if(devices[_0x1fc641][_0x1f323c(0x170)])clearTimeout(devices[_0x1fc641][_0x1f323c(0x170)]);devices[_0x1fc641][_0x1f323c(0x170)]=setTimeout(()=>{const _0x15809e=_0x1f323c;if(devices[_0x1fc641][_0x15809e(0x230)])clearTimeout(devices[_0x1fc641][_0x15809e(0x230)]);removeSocketListeners(_0x1fc641),addBlacklist(_0x1fc641),devices[_0x1fc641][_0x15809e(0x10d)]=null,devices[_0x1fc641][_0x15809e(0x20d)]=null,devices[_0x1fc641][_0x15809e(0x1e6)][_0x15809e(0x112)]=null,logger[_0x15809e(0x1d5)](_0x15809e(0x208)+_0x1fc641[_0x15809e(0x183)](-0x8)),devices[_0x1fc641]['access']=validateAccess(devices[_0x1fc641][_0x15809e(0x1e6)]['token'],_0x1fc641),!(devices[_0x1fc641][_0x15809e(0x1e6)][_0x15809e(0x23e)]&&devices[_0x1fc641][_0x15809e(0x1e6)][_0x15809e(0x1c4)]==_0x15809e(0x109))&&(_0x4322da=='login'?io['to'](_0x1fc641)[_0x15809e(0x178)]('status',{'access':{'allow':![],'reason':_0x15809e(0x17f),'token':null}}):io['to'](_0x1fc641)['emit'](_0x15809e(0x1d6),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x1fc641]['access'][_0x15809e(0x112)]=null;},_0x238aac);}function setTokenRefresh(_0x5e177a){const _0x2cf74c=_0xc54fdc;if(devices[_0x5e177a][_0x2cf74c(0x230)])clearTimeout(devices[_0x5e177a][_0x2cf74c(0x230)]);devices[_0x5e177a][_0x2cf74c(0x230)]=setTimeout(()=>{const _0x30ddba=_0x2cf74c;getClientsWithUuid(_0x5e177a)[_0x30ddba(0x176)]!=0x0?(devices[_0x5e177a]['access']=refreshToken(_0x5e177a),io['to'](_0x5e177a)[_0x30ddba(0x178)](_0x30ddba(0x1d6),{'status':_0x30ddba(0x1e3),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5e177a][_0x30ddba(0x1e6)],'externalip':devices[_0x5e177a]['ip'],'publicKey':secure[_0x30ddba(0x24f)],'validInstallation':validInstallation}),setTokenRefresh(_0x5e177a)):clearTimeout(devices[_0x5e177a][_0x30ddba(0x230)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x303281){const _0x57ef7c=_0xc54fdc,_0x4aa2a0=getClient(_0x303281['id'])[_0x57ef7c(0x1cb)];_0x303281[_0x57ef7c(0x178)](_0x57ef7c(0x257),config),_0x303281[_0x57ef7c(0x178)](_0x57ef7c(0x17e),cleanSettings()),_0x303281['on'](_0x57ef7c(0x2b5),_0x2f4a8e=>{const _0x2eba3c=_0x57ef7c;if(validateAccess(_0x2f4a8e,_0x4aa2a0)[_0x2eba3c(0x23e)])addBot();else logger[_0x2eba3c(0xe4)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x303281['on']('update-bot',(_0x509610,_0x2d2e1b)=>{const _0x174c6e=_0x57ef7c;if(validateAccess(_0x2d2e1b,_0x4aa2a0)[_0x174c6e(0x23e)])toggleBot(_0x509610[_0x174c6e(0x140)],_0x509610[_0x174c6e(0x1d6)],_0x509610[_0x174c6e(0x28e)]);else logger[_0x174c6e(0xe4)](_0x174c6e(0x145));}),_0x303281['on'](_0x57ef7c(0x201),(_0x2a3928,_0x8e287a)=>{const _0x4e826e=_0x57ef7c;if(validateAccess(_0x8e287a,_0x4aa2a0)[_0x4e826e(0x23e)])toggleBotMode(_0x2a3928);else logger[_0x4e826e(0xe4)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x303281['on'](_0x57ef7c(0x20c),(_0x45f97c,_0x1066a2)=>{const _0x36e884=_0x57ef7c;if(validateAccess(_0x1066a2,_0x4aa2a0)[_0x36e884(0x23e)])deleteBot(_0x45f97c);else logger[_0x36e884(0xe4)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x303281['on'](_0x57ef7c(0x12e),(_0x4ca3aa,_0x200d34)=>{const _0x23c610=_0x57ef7c;if(validateAccess(_0x200d34,_0x4aa2a0)['allow'])storeSettings(_0x4ca3aa,!![]);else logger['full'](_0x23c610(0x132));}),_0x303281['on']('update-bb',_0x3c3807=>{const _0x9d6f6=_0x57ef7c;if(validateAccess(_0x3c3807,_0x4aa2a0)['allow'])updateBB(_0x9d6f6(0x195));else logger['full'](_0x9d6f6(0x16f));}),_0x303281['on'](_0x57ef7c(0x29b),_0x1e5668=>{const _0x39b4b4=_0x57ef7c;if(validateAccess(_0x1e5668,_0x4aa2a0)[_0x39b4b4(0x23e)])updateBB(_0x39b4b4(0x126));else logger[_0x39b4b4(0xe4)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x303281['on'](_0x57ef7c(0x1cd),_0x22ca38=>{const _0x33caa0=_0x57ef7c;if(validateAccess(_0x22ca38,_0x4aa2a0)['allow']){const _0x44e384=getClient(_0x303281['id']);if(_0x44e384)getBackupFiles(_0x44e384['uuid']);else logger[_0x33caa0(0xe4)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x303281['on']('restore-backup-file',(_0x4130cc,_0x52d282)=>{const _0x5b13bc=_0x57ef7c;if(validateAccess(_0x52d282,_0x4aa2a0)['allow'])restoreBackupFile(_0x4130cc);else logger[_0x5b13bc(0xe4)](_0x5b13bc(0xde));}),_0x303281['on']('get-messages',_0x16c97f=>{const _0x42d571=_0x57ef7c;if(validateAccess(_0x16c97f,_0x4aa2a0)[_0x42d571(0x23e)])getMessages();else logger[_0x42d571(0xe4)](_0x42d571(0x149));}),_0x303281['on']('confirm-message',(_0x404b35,_0x360bb0)=>{const _0x7cf691=_0x57ef7c;if(validateAccess(_0x360bb0,_0x4aa2a0)[_0x7cf691(0x23e)])confirmMessage(_0x404b35);else logger[_0x7cf691(0xe4)](_0x7cf691(0x2b2));}),_0x303281['on'](_0x57ef7c(0x110),_0x1b55b4=>{const _0x2c65d0=_0x57ef7c;if(validateAccess(_0x1b55b4,_0x4aa2a0)[_0x2c65d0(0x23e)]){if(devices[_0x4aa2a0][_0x2c65d0(0x230)])clearTimeout(devices[_0x4aa2a0][_0x2c65d0(0x230)]);if(devices[_0x4aa2a0]['pidExpireLogin'])clearTimeout(devices[_0x4aa2a0][_0x2c65d0(0x170)]);removeSocketListeners(getClient(_0x303281['id'])[_0x2c65d0(0x1cb)]),addBlacklist(_0x4aa2a0),devices[_0x4aa2a0][_0x2c65d0(0x10d)]=null,devices[_0x4aa2a0][_0x2c65d0(0x20d)]=null,devices[_0x4aa2a0][_0x2c65d0(0x1e6)][_0x2c65d0(0x112)]=null,logger[_0x2c65d0(0x1d5)](_0x2c65d0(0x248)+_0x4aa2a0[_0x2c65d0(0x183)](-0x8)),io['to'](getClient(_0x303281['id'])['uuid'])[_0x2c65d0(0x178)](_0x2c65d0(0x1d6),{'access':{'allow':![],'reason':_0x2c65d0(0x2ad),'token':null}});}else logger[_0x2c65d0(0xe4)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x44218e){const _0x38c08e=_0xc54fdc,_0x303de9=getClient(_0x44218e['id'])['bot'],_0x58a055=getClient(_0x44218e['id'])['uuid'];_0x44218e['on']('get-logs',(_0x5afca8,_0x119f95)=>{const _0x256f3f=_0x304a;if(validateAccess(_0x119f95,_0x58a055)[_0x256f3f(0x23e)]){if(pid[_0x303de9])pid[_0x303de9][_0x256f3f(0xf6)]({'function':_0x256f3f(0x191),'args':_0x5afca8});}else logger[_0x256f3f(0xe4)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x44218e['on']('delete-alerts',(_0x2c78de,_0x24476a)=>{const _0x1b8f4e=_0x304a;if(validateAccess(_0x24476a,_0x58a055)['allow']){if(pid[_0x303de9])pid[_0x303de9][_0x1b8f4e(0xf6)]({'function':_0x1b8f4e(0x15e),'args':_0x2c78de});}else logger[_0x1b8f4e(0xe4)](_0x1b8f4e(0x1e4));}),_0x44218e['on'](_0x38c08e(0x16c),(_0x1a6d0f,_0x26789d)=>{const _0x188335=_0x38c08e;if(validateAccess(_0x26789d,_0x58a055)['allow']){if(pid[_0x303de9])pid[_0x303de9][_0x188335(0xf6)]({'function':'getPortfolio','args':_0x1a6d0f});}else logger[_0x188335(0xe4)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x44218e['on'](_0x38c08e(0x160),(_0xe59c39,_0x2bda75)=>{const _0x55a705=_0x38c08e;if(validateAccess(_0x2bda75,_0x58a055)[_0x55a705(0x23e)]){if(pid[_0x303de9])pid[_0x303de9][_0x55a705(0xf6)]({'function':_0x55a705(0x236),'args':_0xe59c39});}else logger[_0x55a705(0xe4)](_0x55a705(0x228));}),_0x44218e['on'](_0x38c08e(0x174),(_0x413bf4,_0x5cff82)=>{const _0xff3c7e=_0x38c08e;if(validateAccess(_0x5cff82,_0x58a055)[_0xff3c7e(0x23e)]){if(pid[_0x303de9])pid[_0x303de9][_0xff3c7e(0xf6)]({'function':'storeHeadless','args':_0x413bf4});}else logger[_0xff3c7e(0xe4)](_0xff3c7e(0x177));}),_0x44218e['on'](_0x38c08e(0x1fe),(_0x412210,_0x37e609)=>{const _0xf40c90=_0x38c08e;if(validateAccess(_0x37e609,_0x58a055)['allow']){if(pid[_0x303de9])pid[_0x303de9][_0xf40c90(0xf6)]({'function':_0xf40c90(0x1c5),'args':_0x412210});}else logger[_0xf40c90(0xe4)](_0xf40c90(0x1b3));}),_0x44218e['on'](_0x38c08e(0x124),_0x546153=>{const _0x47fd66=_0x38c08e;if(validateAccess(_0x546153,_0x58a055)[_0x47fd66(0x23e)]){if(pid[_0x303de9])pid[_0x303de9]['send']({'function':_0x47fd66(0xe7),'args':null});}else logger[_0x47fd66(0xe4)](_0x47fd66(0xe8));}),_0x44218e['on'](_0x38c08e(0x1f2),_0x4e116a=>{const _0x2b7aa=_0x38c08e;if(validateAccess(_0x4e116a,_0x58a055)[_0x2b7aa(0x23e)]){if(pid[_0x303de9])pid[_0x303de9]['send']({'function':'getStartingBalances','args':null});}else logger[_0x2b7aa(0xe4)](_0x2b7aa(0x1f0));}),_0x44218e['on'](_0x38c08e(0x155),(_0xdd1054,_0x50621a)=>{const _0xc4d7d7=_0x38c08e;if(validateAccess(_0x50621a,_0x58a055)[_0xc4d7d7(0x23e)]){if(pid[_0x303de9])pid[_0x303de9][_0xc4d7d7(0xf6)]({'function':_0xc4d7d7(0x26d),'args':_0xdd1054});}else logger['full'](_0xc4d7d7(0x22c));}),_0x44218e['on'](_0x38c08e(0x10b),_0x3e36ea=>{const _0x2c2b95=_0x38c08e;if(validateAccess(_0x3e36ea,_0x58a055)['allow']){if(pid[_0x303de9])pid[_0x303de9][_0x2c2b95(0xf6)]({'function':'cancelLoading','args':null});}else logger[_0x2c2b95(0xe4)](_0x2c2b95(0x2a0));}),_0x44218e['on'](_0x38c08e(0x260),_0x3e7af6=>{const _0x4af3ed=_0x38c08e;if(validateAccess(_0x3e7af6,_0x58a055)[_0x4af3ed(0x23e)]){if(pid[_0x303de9])pid[_0x303de9][_0x4af3ed(0xf6)]({'function':_0x4af3ed(0x218),'args':null});}else logger[_0x4af3ed(0xe4)](_0x4af3ed(0x290));}),_0x44218e['on'](_0x38c08e(0xf5),_0xb02827=>{const _0x285762=_0x38c08e;if(validateAccess(_0xb02827,_0x58a055)[_0x285762(0x23e)])updateBB(_0x285762(0x195));else logger[_0x285762(0xe4)](_0x285762(0x16f));}),_0x44218e['on'](_0x38c08e(0x117),_0x3c904c=>{const _0x4ef8c6=_0x38c08e;if(validateAccess(_0x3c904c,_0x58a055)[_0x4ef8c6(0x23e)])getMessages();else logger[_0x4ef8c6(0xe4)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x44218e['on'](_0x38c08e(0x1c0),(_0x53fe87,_0x265e12)=>{const _0x222fb2=_0x38c08e;if(validateAccess(_0x265e12,_0x58a055)[_0x222fb2(0x23e)])confirmMessage(_0x53fe87);else logger['full'](_0x222fb2(0x2b2));}),_0x44218e['on']('logout',_0x79cc32=>{const _0x5baba6=_0x38c08e;if(validateAccess(_0x79cc32,_0x58a055)[_0x5baba6(0x23e)]){if(devices[_0x58a055]['pidRefreshToken'])clearTimeout(devices[_0x58a055]['pidRefreshToken']);if(devices[_0x58a055][_0x5baba6(0x170)])clearTimeout(devices[_0x58a055][_0x5baba6(0x170)]);removeSocketListeners(getClient(_0x44218e['id'])['uuid']),addBlacklist(_0x58a055),devices[_0x58a055][_0x5baba6(0x10d)]=null,devices[_0x58a055][_0x5baba6(0x20d)]=null,devices[_0x58a055]['access'][_0x5baba6(0x112)]=null,logger[_0x5baba6(0x1d5)](_0x5baba6(0x248)+_0x58a055['slice'](-0x8)),io['to'](getClient(_0x44218e['id'])[_0x5baba6(0x1cb)])[_0x5baba6(0x178)](_0x5baba6(0x1d6),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5baba6(0xe4)](_0x5baba6(0x111));});}function removeSocketListeners(_0x1666a){const _0x4e516a=_0xc54fdc;getClientsWithUuid(_0x1666a)[_0x4e516a(0x223)](_0x2f90e9=>{const _0x5be557=_0x4e516a;getSocket(_0x2f90e9['id'])[_0x5be557(0xd6)]();});}function cleanSettings(){const _0x1db6d8=_0xc54fdc;let _0x6b53fd=settings;return settings['telegramToken']&&settings[_0x1db6d8(0x2a5)]!=''&&(_0x6b53fd={..._0x6b53fd,'telegramToken':'************'}),settings[_0x1db6d8(0x27f)]&&settings[_0x1db6d8(0x27f)]!=''&&(_0x6b53fd={..._0x6b53fd,'bbPassword':'************'}),(settings[_0x1db6d8(0x27f)]&&settings[_0x1db6d8(0x27f)]==_0x1db6d8(0x267)||settings['telegramToken']&&settings[_0x1db6d8(0x2a5)]=='***')&&(_0x6b53fd={..._0x6b53fd,'restored':{'password':settings[_0x1db6d8(0x27f)]==_0x1db6d8(0x267),'telegram':settings[_0x1db6d8(0x2a5)]=='***'}}),_0x6b53fd;}async function updateBB(_0x5433e1){const _0x48b757=_0xc54fdc;await backupConfigFiles(),installingUpdate=!![],config[_0x48b757(0x223)](_0x8e1d80=>{const _0x36ecd4=_0x48b757;restartBot(_0x8e1d80[_0x36ecd4(0x140)]);}),logger[_0x48b757(0x1d5)](_0x48b757(0x2ae)+_0x5433e1);if(_0x5433e1==_0x48b757(0x195))process[_0x48b757(0xf6)]({'update':!![]},_0x528dbb=>{});else _0x5433e1==_0x48b757(0x126)&&process[_0x48b757(0xf6)]({'reinstall':!![]},_0x4845f2=>{});}function startBot(_0x2bce73,_0x418197,_0x5084c5){const _0x37f8b0=_0xc54fdc;if(debugging)_0x2bce73[_0x37f8b0(0x1a9)]('-d');let _0x19023d=![];const _0x5bbf4b=_0x2bce73[0x0];_0x418197={..._0x418197,'stdio':['inherit',_0x37f8b0(0x1ed),_0x37f8b0(0x1ed),_0x37f8b0(0x292)]},pid[_0x5bbf4b]=childProcess[_0x37f8b0(0xd8)](botfile,_0x2bce73,_0x418197),pid[_0x5bbf4b]['on'](_0x37f8b0(0x251),_0x39928d=>{const _0x2436a2=_0x37f8b0;switch(Object[_0x2436a2(0x1bc)](_0x39928d)[0x0]){case _0x2436a2(0xee):updateBotName(_0x5bbf4b,_0x39928d[_0x2436a2(0xee)]);break;case'updatebotmanager':updateBotManager();break;case _0x2436a2(0x1d6):updateStatus(_0x5bbf4b,_0x39928d['status']);break;case _0x2436a2(0x28e):updateLive(_0x5bbf4b,_0x39928d['live']);break;case _0x2436a2(0x283):updateLive(_0x5bbf4b,_0x39928d[_0x2436a2(0x283)]),io['to'](_0x5bbf4b)['emit']('status',{'access':{'allow':![],'reason':_0x2436a2(0x262),'token':null}});break;case'stop':_0x39928d[_0x2436a2(0x293)]==_0x2436a2(0x2aa)&&restartBot(_0x5bbf4b);_0x39928d[_0x2436a2(0x293)]==_0x2436a2(0x1ad)&&toggleBot(_0x5bbf4b,_0x2436a2(0x153),_0x2436a2(0x157));break;case _0x2436a2(0x22d):sendTelegram(_0x5bbf4b,_0x39928d[_0x2436a2(0x22d)]);break;case _0x2436a2(0x28b):sendTelegramMsg(_0x39928d[_0x2436a2(0x28b)]);break;case _0x2436a2(0x281):io['to'](_0x5bbf4b)['emit'](_0x39928d[_0x2436a2(0x281)],_0x39928d[_0x2436a2(0x2af)]);break;}}),pid[_0x5bbf4b]['on']('error',function(_0x11257c){if(_0x19023d)return;_0x19023d=!![],_0x5084c5(_0x11257c);}),pid[_0x5bbf4b]['on']('exit',async function(_0x5f5a2e){const _0x2b1b46=_0x37f8b0;if(installingUpdate)return;if(_0x19023d)return;_0x19023d=!![],_0x5084c5(null);const _0x12b120=dbConfig['get'](_0x2b1b46(0x257))[_0x2b1b46(0x222)]({'botID':_0x5bbf4b})['value']();_0x12b120&&(_0x12b120[_0x2b1b46(0x1d6)]=='enabled'||_0x12b120[_0x2b1b46(0x1d6)]==_0x2b1b46(0x13d))&&(await sleep(0x3e8),updateLive(_0x5bbf4b,_0x2b1b46(0x157)),logger['full'](_0x2b1b46(0xf2)+_0x5bbf4b),startBot([_0x5bbf4b,userID],{'cwd':bbpath},function(_0x404618){const _0x278417=_0x2b1b46;if(_0x404618)logger[_0x278417(0xe4)](_0x404618);}));});}function stopBot(_0x2bee7d){const _0x3eb8a0=_0xc54fdc;getClientsWithBotID(_0x2bee7d)['forEach'](_0x118f76=>{const _0x23b898=_0x304a;getSocket(_0x118f76['id'])[_0x23b898(0x264)](!![]),removeClient(_0x118f76['id']);}),pid[_0x2bee7d]&&(pid[_0x2bee7d][_0x3eb8a0(0x1ad)](),pid[_0x2bee7d]=null);}function restartBot(_0x446e3b){if(pid[_0x446e3b])pid[_0x446e3b]['kill']();}function addBot(){const _0x4166cf=_0xc54fdc;let _0x4af898;for(let _0x318ad8=0x1;_0x318ad8<0x3e9;_0x318ad8++){_0x4af898=_0x318ad8['toString']()['padStart'](0x3,'0');let _0x44a8eb=config[_0x4166cf(0x222)](_0x525733=>_0x525733[_0x4166cf(0x140)]==_0x4af898);if(!_0x44a8eb)break;}if(_0x4af898===_0x4166cf(0x2a7)){logger['full'](_0x4166cf(0xdd));return;}logger[_0x4166cf(0xe4)](_0x4166cf(0x1ea)+_0x4af898),dbConfig[_0x4166cf(0x1ec)](_0x4166cf(0x257))[_0x4166cf(0x1a9)]({'botID':_0x4af898,'botname':_0x4166cf(0x10c)+_0x4af898,'status':_0x4166cf(0x13d),'live':''})[_0x4166cf(0x29c)](),startBot([_0x4af898,userID],{'cwd':bbpath},function(_0x2764a0){const _0x1fd7e2=_0x4166cf;if(_0x2764a0)logger[_0x1fd7e2(0xe4)](_0x2764a0);}),config=getConfiguration(),io['to'](_0x4166cf(0x169))[_0x4166cf(0x178)](_0x4166cf(0x257),config),broadcastToBots(_0x4166cf(0x257),JSON[_0x4166cf(0x134)](config));}function deleteBot(_0x404f56){const _0x504146=_0xc54fdc;getClientsWithBotID(_0x404f56)['forEach'](_0x43b72e=>{const _0x585902=_0x304a;getSocket(_0x43b72e['id'])[_0x585902(0x264)](!![]),removeClient(_0x43b72e['id']);}),dbConfig[_0x504146(0x1ec)]('bots')[_0x504146(0x115)]({'botID':_0x404f56})[_0x504146(0x29c)](),logger[_0x504146(0xe4)](_0x504146(0x2a2)+_0x404f56),stopBot(_0x404f56);try{if(fs[_0x504146(0x269)](path[_0x504146(0x213)](configpath,_0x504146(0x105)+_0x404f56+'-config.json')))fs['unlinkSync'](path[_0x504146(0x213)](configpath,_0x504146(0x105)+_0x404f56+_0x504146(0x1e7)));if(fs[_0x504146(0x269)](path['join'](configpath,_0x504146(0x105)+_0x404f56+'-events.json')))fs[_0x504146(0xe2)](path[_0x504146(0x213)](configpath,_0x504146(0x105)+_0x404f56+'-events.json'));if(fs[_0x504146(0x269)](path[_0x504146(0x213)](configpath,_0x504146(0x105)+_0x404f56+_0x504146(0x282))))fs['unlinkSync'](path[_0x504146(0x213)](configpath,_0x504146(0x105)+_0x404f56+_0x504146(0x282)));if(fs['existsSync'](path[_0x504146(0x213)](configpath,_0x504146(0x105)+_0x404f56+_0x504146(0x162))))fs[_0x504146(0xe2)](path[_0x504146(0x213)](configpath,'bot-'+_0x404f56+_0x504146(0x162)));}catch(_0xf5ee4e){if(_0xf5ee4e)logger[_0x504146(0xe4)](_0x504146(0x207),_0xf5ee4e);}config=getConfiguration(),io['to'](_0x504146(0x169))['emit']('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x265235,_0x4338,_0x216d19){const _0x3c9afa=_0xc54fdc;dbConfig[_0x3c9afa(0x1ec)](_0x3c9afa(0x257))[_0x3c9afa(0x222)]({'botID':_0x265235})['assign']({'status':_0x4338})[_0x3c9afa(0xd7)]({'live':_0x216d19})[_0x3c9afa(0x29c)]();if(_0x4338==_0x3c9afa(0x24a)||_0x4338==_0x3c9afa(0x13d))logger['full'](_0x3c9afa(0x166)+_0x265235),startBot([_0x265235,userID],{'cwd':bbpath},function(_0x2cff0f){if(_0x2cff0f)logger['full'](_0x2cff0f);});else(_0x4338==_0x3c9afa(0x153)||_0x4338=='new-disabled')&&(logger[_0x3c9afa(0xe4)](_0x3c9afa(0x141)+_0x265235),stopBot(_0x265235));config=getConfiguration(),io['to']('botmanager')['emit'](_0x3c9afa(0x257),config),broadcastToBots(_0x3c9afa(0x257),JSON[_0x3c9afa(0x134)](config));}function toggleStatus(_0x3d7505){const _0x4788f5=_0xc54fdc;let _0x2acc89=dbConfig[_0x4788f5(0x1ec)]('bots')['find']({'botID':_0x3d7505})[_0x4788f5(0x1fb)](),_0x5cd907;if(_0x2acc89['status']==='enabled')_0x5cd907=_0x4788f5(0x153);else{if(_0x2acc89[_0x4788f5(0x1d6)]===_0x4788f5(0x13d))_0x5cd907=_0x4788f5(0xfd);else{if(_0x2acc89[_0x4788f5(0x1d6)]===_0x4788f5(0xfd))_0x5cd907=_0x4788f5(0x13d);else{if(_0x2acc89['status']==='disabled')_0x5cd907=_0x4788f5(0x24a);}}}return _0x5cd907;}function updateStatus(_0x1aecca,_0x3b912b){const _0xa5745f=_0xc54fdc;dbConfig[_0xa5745f(0x1ec)](_0xa5745f(0x257))[_0xa5745f(0x222)]({'botID':_0x1aecca})[_0xa5745f(0xd7)]({'status':_0x3b912b})[_0xa5745f(0x29c)](),config=getConfiguration(),io['to'](_0xa5745f(0x169))[_0xa5745f(0x178)](_0xa5745f(0x257),config),broadcastToBots(_0xa5745f(0x257),JSON[_0xa5745f(0x134)](config));}function updateLive(_0x10803e,_0x37df7c){const _0x31e68d=_0xc54fdc;dbConfig['get'](_0x31e68d(0x257))[_0x31e68d(0x222)]({'botID':_0x10803e})['assign']({'live':_0x37df7c})[_0x31e68d(0x29c)](),config=getConfiguration(),io['to']('botmanager')[_0x31e68d(0x178)](_0x31e68d(0x257),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0xa8900c,_0xb75449){const _0x134097=_0xc54fdc;dbConfig['get']('bots')[_0x134097(0x222)]({'botID':_0xa8900c})[_0x134097(0xd7)]({'botname':_0xb75449})[_0x134097(0x29c)](),config=getConfiguration(),io['to'](_0x134097(0x169))['emit'](_0x134097(0x257),config),broadcastToBots(_0x134097(0x257),JSON[_0x134097(0x134)](config));}function updateBotManager(){const _0x1cc87f=_0xc54fdc;config=getConfiguration(),io['to'](_0x1cc87f(0x169))[_0x1cc87f(0x178)](_0x1cc87f(0x257),config),broadcastToBots(_0x1cc87f(0x257),JSON[_0x1cc87f(0x134)](config));}function toggleBotMode(_0x5e4cb6){const _0x43f44b=_0xc54fdc;if(pid[_0x5e4cb6])pid[_0x5e4cb6][_0x43f44b(0xf6)]({'function':'toggleBotMode','args':null});else{const _0x3d1b47=configpath+'bot-'+_0x5e4cb6+_0x43f44b(0x1e7),_0x4d4711=fs[_0x43f44b(0x10f)](_0x3d1b47),_0x2e0f6e=JSON[_0x43f44b(0x21b)](_0x4d4711),_0x1a2109=_0x2e0f6e['bot'][0x0][_0x43f44b(0x1ae)];_0x2e0f6e['bot'][0x0][_0x43f44b(0x1ae)]=!_0x1a2109;const _0x21c675=JSON[_0x43f44b(0x134)](_0x2e0f6e,null,0x2);fs['writeFileSync'](_0x3d1b47,_0x21c675),config=getConfiguration(),io['to'](_0x43f44b(0x169))[_0x43f44b(0x178)](_0x43f44b(0x257),config),broadcastToBots(_0x43f44b(0x257),JSON[_0x43f44b(0x134)](config));}}function telegramError(_0x50cd60){logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x65e930){const _0x1292f8=_0xc54fdc;if(_0x65e930['from'][_0x1292f8(0x167)]!=settings['telegramUsername']&&'@'+_0x65e930['from'][_0x1292f8(0x167)]!=settings[_0x1292f8(0x271)])return tgBot[_0x1292f8(0x19c)](_0x65e930[_0x1292f8(0x1aa)]['id'],_0x1292f8(0x114),{'parse_mode':_0x1292f8(0x291)})['catch'](_0xf243d3=>{telegramError(_0xf243d3);}),![];return!![];}async function initTelegram(){const _0x296ffe=_0xc54fdc;if(tgBot)tgBot[_0x296ffe(0x246)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x296ffe(0x2a5)],{'polling':!![]});let _0x10cac4=_0x296ffe(0xd9);_0x10cac4+='\x0a',_0x10cac4+='/enable\x20-\x20enable\x20notifications\x0a',_0x10cac4+=_0x296ffe(0x100),_0x10cac4+=_0x296ffe(0x253),_0x10cac4+=_0x296ffe(0x284),_0x10cac4+=_0x296ffe(0x12a),_0x10cac4+='/off\x20-\x20stop\x20bot(s)\x0a',_0x10cac4+=_0x296ffe(0x1b0),_0x10cac4+=_0x296ffe(0xff),_0x10cac4+=_0x296ffe(0x21a),_0x10cac4+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x10cac4+=_0x296ffe(0x1ff),_0x10cac4+=_0x296ffe(0x1a6),_0x10cac4+=_0x296ffe(0x1b5),_0x10cac4+=_0x296ffe(0x1c3);let _0x1d5fbb=_0x296ffe(0x295);_0x1d5fbb+='\x0a',_0x1d5fbb+=_0x10cac4,tgBot[_0x296ffe(0xf3)](/\/start/,_0x5dd8ca=>{const _0x44179f=_0x296ffe;if(!validateTelegram(_0x5dd8ca))return;if(settings[_0x44179f(0x25b)]!=_0x5dd8ca[_0x44179f(0x1aa)]['id'])updateSetting(_0x44179f(0x25b),_0x5dd8ca['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x44179f(0x19c)](_0x5dd8ca[_0x44179f(0x1aa)]['id'],_0x1d5fbb)[_0x44179f(0x1e8)](_0x562b46=>{telegramError(_0x562b46);});}),tgBot[_0x296ffe(0xf3)](/\/enable/,_0x53d8bc=>{const _0x27893c=_0x296ffe;if(!validateTelegram(_0x53d8bc))return;if(settings[_0x27893c(0x25b)]!=_0x53d8bc[_0x27893c(0x1aa)]['id'])updateSetting('telegramChatId',_0x53d8bc[_0x27893c(0x1aa)]['id']);updateSetting(_0x27893c(0x255),!![]),tgBot[_0x27893c(0x19c)](_0x53d8bc[_0x27893c(0x1aa)]['id'],_0x27893c(0x11c))[_0x27893c(0x1e8)](_0x31a555=>{telegramError(_0x31a555);});}),tgBot['onText'](/\/config/,async _0x56143e=>{const _0x384955=_0x296ffe;if(!validateTelegram(_0x56143e))return;tgBot[_0x384955(0x24d)](_0x384955(0x163)),tgBot[_0x384955(0x19c)](_0x56143e[_0x384955(0x1aa)]['id'],_0x384955(0x14e),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x384955(0x20e)},{'text':_0x384955(0x1da),'callback_data':_0x384955(0x1a5)},{'text':'All','callback_data':_0x384955(0x1ac)}]]}})[_0x384955(0x1e8)](_0x985c0c=>{telegramError(_0x985c0c);}),tgBot['on'](_0x384955(0x163),async _0x5905ff=>{const _0x35cb4a=_0x384955,_0x232ea5=_0x5905ff[_0x35cb4a(0x1a7)],_0x115d13=_0x5905ff['message'];tgBot[_0x35cb4a(0x15c)](_0x5905ff['id'])[_0x35cb4a(0x280)](async()=>{const _0x1e1b82=_0x35cb4a;_0x232ea5=='orders'&&(updateSetting(_0x1e1b82(0x25d),_0x1e1b82(0x20e)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1e1b82(0x19c)](_0x115d13['chat']['id'],_0x1e1b82(0x1bf))[_0x1e1b82(0x1e8)](_0x1e5838=>{telegramError(_0x1e5838);}));_0x232ea5=='alerts'&&(updateSetting(_0x1e1b82(0x25d),_0x1e1b82(0x1a5)),updateSetting(_0x1e1b82(0x255),!![]),await tgBot[_0x1e1b82(0x19c)](_0x115d13[_0x1e1b82(0x1aa)]['id'],_0x1e1b82(0x131))[_0x1e1b82(0x1e8)](_0x19d0e6=>{telegramError(_0x19d0e6);}));_0x232ea5==_0x1e1b82(0x1ac)&&(updateSetting('telegramEvents',_0x1e1b82(0x1ac)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1e1b82(0x19c)](_0x115d13[_0x1e1b82(0x1aa)]['id'],_0x1e1b82(0x274))['catch'](_0x3d7ea5=>{telegramError(_0x3d7ea5);}));if(!settings['telegramChatId'])tgBot[_0x1e1b82(0x19c)](_0x115d13[_0x1e1b82(0x1aa)]['id'],_0x1e1b82(0x23f))['catch'](_0x52b08=>{telegramError(_0x52b08);});}),tgBot[_0x35cb4a(0x24d)](_0x35cb4a(0x163));});}),tgBot['onText'](/\/status/,_0x59d449=>{const _0x51142c=_0x296ffe;if(!validateTelegram(_0x59d449))return;const _0x189ca8=getBotsWithMode();let _0x5f5b6d=_0x51142c(0x278);config['forEach'](_0x30d258=>{const _0x2ef21f=_0x51142c,_0x27c406=_0x189ca8[_0x2ef21f(0x222)](_0x4d11a7=>_0x4d11a7[_0x2ef21f(0x140)]==_0x30d258['botID'])[_0x2ef21f(0x193)];_0x5f5b6d+=_0x2ef21f(0x10c)+_0x30d258[_0x2ef21f(0x140)]+':\x20'+_0x30d258[_0x2ef21f(0x1d6)]+_0x2ef21f(0x11e)+_0x27c406+_0x2ef21f(0x11e)+_0x30d258[_0x2ef21f(0x28e)]+'\x0a';}),_0x5f5b6d+='\x0a',_0x5f5b6d+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x5f5b6d+=!settings['telegramEnabled']?_0x51142c(0x17c):_0x51142c(0x1dc),_0x5f5b6d+=settings[_0x51142c(0x255)]?settings[_0x51142c(0x25d)]==_0x51142c(0x1ac)?_0x51142c(0x129):_0x51142c(0x235)+settings['telegramEvents']+_0x51142c(0xe1):'',tgBot['sendMessage'](_0x59d449[_0x51142c(0x1aa)]['id'],_0x5f5b6d,{'parse_mode':_0x51142c(0x291)})['catch'](_0x36fe65=>{telegramError(_0x36fe65);});}),tgBot['onText'](/\/restart/,_0x5c196d=>{const _0x2ea859=_0x296ffe;if(!validateTelegram(_0x5c196d))return;tgBot[_0x2ea859(0x24d)](_0x2ea859(0x163));const _0x5a9bef=getEnabledBots();if(_0x5a9bef[_0x2ea859(0x176)]==0x0)tgBot[_0x2ea859(0x19c)](_0x5c196d['chat']['id'],_0x2ea859(0x13f))['catch'](_0x397806=>{telegramError(_0x397806);});else{if(_0x5a9bef['length']>0x1)_0x5a9bef[_0x2ea859(0x1a9)]({'botID':_0x2ea859(0x1ac)});let _0x47f806=[],_0x5906aa=[];const _0x1c96e8=_0x5a9bef[_0x2ea859(0x176)]%0x4==0x0||_0x5a9bef[_0x2ea859(0x176)]%0x4==0x3||_0x5a9bef[_0x2ea859(0x176)]%0x3==0x1?0x4:0x3;let _0x36b0c5=0x0;_0x5a9bef[_0x2ea859(0x223)]((_0x393518,_0x356db4)=>{const _0x47e3f0=_0x2ea859;if(_0x356db4%_0x1c96e8==0x0)_0x5906aa=[];_0x5906aa[_0x47e3f0(0x1a9)]({'text':_0x393518[_0x47e3f0(0x140)]=='all'?'All\x20bots':_0x47e3f0(0x10c)+_0x393518[_0x47e3f0(0x140)],'callback_data':_0x393518[_0x47e3f0(0x140)]}),_0x356db4%_0x1c96e8==0x0&&(_0x47f806[_0x36b0c5]=_0x5906aa,_0x36b0c5++);}),tgBot['sendMessage'](_0x5c196d['chat']['id'],_0x2ea859(0x224),{'reply_markup':{'inline_keyboard':_0x47f806}})[_0x2ea859(0x1e8)](_0x365130=>{telegramError(_0x365130);}),tgBot['on'](_0x2ea859(0x163),async _0x10bc04=>{const _0x34a6c3=_0x2ea859,_0x37600d=_0x10bc04['data'],_0x1a08fc=_0x10bc04[_0x34a6c3(0x251)];tgBot[_0x34a6c3(0x15c)](_0x10bc04['id'])[_0x34a6c3(0x280)](async()=>{_0x37600d=='all'?config['forEach'](_0x285f7e=>{restartBot(_0x285f7e['botID']);}):restartBot(_0x37600d);}),tgBot['removeListener'](_0x34a6c3(0x163));});}}),tgBot[_0x296ffe(0xf3)](/\/on/,_0x4e0c0d=>{const _0x5d323c=_0x296ffe;if(!validateTelegram(_0x4e0c0d))return;tgBot[_0x5d323c(0x24d)]('callback_query');const _0x3f0d5d=getDisabledBots();if(_0x3f0d5d[_0x5d323c(0x176)]==0x0)tgBot[_0x5d323c(0x19c)](_0x4e0c0d[_0x5d323c(0x1aa)]['id'],'All\x20bots\x20running\x20right\x20now')['catch'](_0x472a7d=>{telegramError(_0x472a7d);});else{if(_0x3f0d5d[_0x5d323c(0x176)]>0x1)_0x3f0d5d[_0x5d323c(0x1a9)]({'botID':_0x5d323c(0x1ac)});let _0x2a752e=[],_0x3402cc=[];const _0x7f0373=_0x3f0d5d[_0x5d323c(0x176)]%0x4==0x0||_0x3f0d5d[_0x5d323c(0x176)]%0x4==0x3||_0x3f0d5d[_0x5d323c(0x176)]%0x3==0x1?0x4:0x3;let _0x3ecf26=0x0;_0x3f0d5d['forEach']((_0x31fd19,_0x20614b)=>{const _0x13fc8e=_0x5d323c;if(_0x20614b%_0x7f0373==0x0)_0x3402cc=[];_0x3402cc[_0x13fc8e(0x1a9)]({'text':_0x31fd19['botID']==_0x13fc8e(0x1ac)?_0x13fc8e(0x28f):_0x13fc8e(0x10c)+_0x31fd19['botID'],'callback_data':_0x31fd19[_0x13fc8e(0x140)]}),_0x20614b%_0x7f0373==0x0&&(_0x2a752e[_0x3ecf26]=_0x3402cc,_0x3ecf26++);}),tgBot[_0x5d323c(0x19c)](_0x4e0c0d[_0x5d323c(0x1aa)]['id'],_0x5d323c(0x17d),{'reply_markup':{'inline_keyboard':_0x2a752e}})['catch'](_0x50b0fc=>{telegramError(_0x50b0fc);}),tgBot['on']('callback_query',async _0x472fdc=>{const _0x23a87c=_0x5d323c,_0xd2450f=_0x472fdc[_0x23a87c(0x1a7)],_0x23f7cf=_0x472fdc['message'];tgBot['answerCallbackQuery'](_0x472fdc['id'])[_0x23a87c(0x280)](async()=>{const _0x48b2c4=_0x23a87c;_0xd2450f==_0x48b2c4(0x1ac)?(tgBot[_0x48b2c4(0x19c)](_0x23f7cf[_0x48b2c4(0x1aa)]['id'],_0x48b2c4(0x12c))[_0x48b2c4(0x1e8)](_0x1a4528=>{telegramError(_0x1a4528);}),_0x3f0d5d['forEach'](_0x117c08=>{const _0x20271f=_0x48b2c4;if(_0x117c08[_0x20271f(0x140)]!=_0x20271f(0x1ac))toggleBot(_0x117c08['botID'],toggleStatus(_0x117c08[_0x20271f(0x140)]),_0x20271f(0x157));})):(tgBot[_0x48b2c4(0x19c)](_0x23f7cf['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0xd2450f)['catch'](_0x237af2=>{telegramError(_0x237af2);}),toggleBot(_0xd2450f,toggleStatus(_0xd2450f),_0x48b2c4(0x157)));}),tgBot[_0x23a87c(0x24d)](_0x23a87c(0x163));});}}),tgBot['onText'](/\/off/,_0x492dbb=>{const _0x39863d=_0x296ffe;if(!validateTelegram(_0x492dbb))return;tgBot[_0x39863d(0x24d)](_0x39863d(0x163));const _0x495d17=getEnabledBots();if(_0x495d17[_0x39863d(0x176)]==0x0)tgBot[_0x39863d(0x19c)](_0x492dbb[_0x39863d(0x1aa)]['id'],_0x39863d(0x13f))[_0x39863d(0x1e8)](_0x5d2d76=>{telegramError(_0x5d2d76);});else{if(_0x495d17['length']>0x1)_0x495d17[_0x39863d(0x1a9)]({'botID':'all'});let _0x2a7e87=[],_0x5c0ec4=[];const _0x502546=_0x495d17['length']%0x4==0x0||_0x495d17[_0x39863d(0x176)]%0x4==0x3||_0x495d17[_0x39863d(0x176)]%0x3==0x1?0x4:0x3;let _0x1dc3e1=0x0;_0x495d17[_0x39863d(0x223)]((_0x1da4df,_0x1fd952)=>{const _0xdec02c=_0x39863d;if(_0x1fd952%_0x502546==0x0)_0x5c0ec4=[];_0x5c0ec4[_0xdec02c(0x1a9)]({'text':_0x1da4df[_0xdec02c(0x140)]==_0xdec02c(0x1ac)?_0xdec02c(0x28f):_0xdec02c(0x10c)+_0x1da4df['botID'],'callback_data':_0x1da4df[_0xdec02c(0x140)]}),_0x1fd952%_0x502546==0x0&&(_0x2a7e87[_0x1dc3e1]=_0x5c0ec4,_0x1dc3e1++);}),tgBot[_0x39863d(0x19c)](_0x492dbb[_0x39863d(0x1aa)]['id'],_0x39863d(0xe5),{'reply_markup':{'inline_keyboard':_0x2a7e87}})['catch'](_0x1df406=>{telegramError(_0x1df406);}),tgBot['on']('callback_query',async _0x36abd3=>{const _0x589294=_0x39863d,_0x4f07b1=_0x36abd3[_0x589294(0x1a7)],_0x2744a9=_0x36abd3[_0x589294(0x251)];tgBot[_0x589294(0x15c)](_0x36abd3['id'])[_0x589294(0x280)](async()=>{const _0x3bf230=_0x589294;_0x4f07b1==_0x3bf230(0x1ac)?(tgBot[_0x3bf230(0x19c)](_0x2744a9[_0x3bf230(0x1aa)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x3bf230(0x1e8)](_0x2fc56d=>{telegramError(_0x2fc56d);}),_0x495d17['forEach'](_0x2e7fb1=>{const _0x461ce4=_0x3bf230;if(_0x2e7fb1[_0x461ce4(0x140)]!=_0x461ce4(0x1ac))toggleBot(_0x2e7fb1[_0x461ce4(0x140)],toggleStatus(_0x2e7fb1['botID']),_0x461ce4(0x157));})):(tgBot[_0x3bf230(0x19c)](_0x2744a9[_0x3bf230(0x1aa)]['id'],_0x3bf230(0x243)+_0x4f07b1)['catch'](_0x5d3f95=>{telegramError(_0x5d3f95);}),toggleBot(_0x4f07b1,toggleStatus(_0x4f07b1),_0x3bf230(0x157)));}),tgBot[_0x589294(0x24d)](_0x589294(0x163));});}}),tgBot[_0x296ffe(0xf3)](/\/metrics/,_0x42c3cc=>{const _0x5a1efd=_0x296ffe;if(!validateTelegram(_0x42c3cc))return;tgBot['removeListener'](_0x5a1efd(0x163));const _0x1e534a=getEnabledBots();if(_0x1e534a[_0x5a1efd(0x176)]==0x0)tgBot['sendMessage'](_0x42c3cc[_0x5a1efd(0x1aa)]['id'],_0x5a1efd(0x13f))[_0x5a1efd(0x1e8)](_0xa01592=>{telegramError(_0xa01592);});else{if(_0x1e534a[_0x5a1efd(0x176)]>0x1){let _0x393c37=[],_0x4c0363=[];const _0x21307b=_0x1e534a['length']%0x4==0x0||_0x1e534a[_0x5a1efd(0x176)]%0x4==0x3||_0x1e534a[_0x5a1efd(0x176)]%0x3==0x1?0x4:0x3;let _0x143381=0x0;_0x1e534a[_0x5a1efd(0x223)]((_0x34fb2c,_0x4b51bb)=>{const _0x72a069=_0x5a1efd;if(_0x4b51bb%_0x21307b==0x0)_0x4c0363=[];_0x4c0363[_0x72a069(0x1a9)]({'text':'Bot\x20'+_0x34fb2c[_0x72a069(0x140)],'callback_data':_0x34fb2c[_0x72a069(0x140)]}),_0x4b51bb%_0x21307b==0x0&&(_0x393c37[_0x143381]=_0x4c0363,_0x143381++);}),tgBot['sendMessage'](_0x42c3cc[_0x5a1efd(0x1aa)]['id'],_0x5a1efd(0x128),{'reply_markup':{'inline_keyboard':_0x393c37}})[_0x5a1efd(0x1e8)](_0x1298fa=>{telegramError(_0x1298fa);}),tgBot['on']('callback_query',async _0x5d4dc6=>{const _0x2aa7b6=_0x5a1efd,_0x34b1c6=_0x5d4dc6[_0x2aa7b6(0x1a7)],_0x5b8fa4=_0x5d4dc6[_0x2aa7b6(0x251)];tgBot[_0x2aa7b6(0x15c)](_0x5d4dc6['id'])[_0x2aa7b6(0x280)](async()=>{const _0x20564c=_0x2aa7b6;if(pid[_0x34b1c6])pid[_0x34b1c6][_0x20564c(0xf6)]({'function':_0x20564c(0x22f),'args':null});}),tgBot[_0x2aa7b6(0x24d)](_0x2aa7b6(0x163));});}else{const _0x5b675c=_0x1e534a[0x0][_0x5a1efd(0x140)];if(pid[_0x5b675c])pid[_0x5b675c]['send']({'function':_0x5a1efd(0x22f),'args':null});}}}),tgBot[_0x296ffe(0xf3)](/\/portfolio/,_0x3f2467=>{const _0x3d7099=_0x296ffe;if(!validateTelegram(_0x3f2467))return;tgBot[_0x3d7099(0x24d)](_0x3d7099(0x163));const _0x15ced6=getEnabledBots();if(_0x15ced6['length']==0x0)tgBot[_0x3d7099(0x19c)](_0x3f2467[_0x3d7099(0x1aa)]['id'],_0x3d7099(0x13f))[_0x3d7099(0x1e8)](_0x30b935=>{telegramError(_0x30b935);});else{if(_0x15ced6[_0x3d7099(0x176)]>0x1){let _0x1d67ec=[],_0x2a3cfd=[];const _0x4ba7d5=_0x15ced6[_0x3d7099(0x176)]%0x4==0x0||_0x15ced6['length']%0x4==0x3||_0x15ced6[_0x3d7099(0x176)]%0x3==0x1?0x4:0x3;let _0x3ba4c7=0x0;_0x15ced6[_0x3d7099(0x223)]((_0x31b2ca,_0x44eeb2)=>{const _0x33b613=_0x3d7099;if(_0x44eeb2%_0x4ba7d5==0x0)_0x2a3cfd=[];_0x2a3cfd[_0x33b613(0x1a9)]({'text':'Bot\x20'+_0x31b2ca[_0x33b613(0x140)],'callback_data':_0x31b2ca[_0x33b613(0x140)]}),_0x44eeb2%_0x4ba7d5==0x0&&(_0x1d67ec[_0x3ba4c7]=_0x2a3cfd,_0x3ba4c7++);}),tgBot[_0x3d7099(0x19c)](_0x3f2467[_0x3d7099(0x1aa)]['id'],_0x3d7099(0x1fd),{'reply_markup':{'inline_keyboard':_0x1d67ec}})[_0x3d7099(0x1e8)](_0x322653=>{telegramError(_0x322653);}),tgBot['on'](_0x3d7099(0x163),async _0x1b58f0=>{const _0x444b20=_0x3d7099,_0x3d2d3a=_0x1b58f0[_0x444b20(0x1a7)],_0x39b24e=_0x1b58f0[_0x444b20(0x251)];tgBot['answerCallbackQuery'](_0x1b58f0['id'])[_0x444b20(0x280)](async()=>{const _0xbc65=_0x444b20;if(pid[_0x3d2d3a])pid[_0x3d2d3a][_0xbc65(0xf6)]({'function':_0xbc65(0x268),'args':null});}),tgBot[_0x444b20(0x24d)](_0x444b20(0x163));});}else{const _0x41e290=_0x15ced6[0x0][_0x3d7099(0x140)];if(pid[_0x41e290])pid[_0x41e290]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x296ffe(0xf3)](/\/update/,async _0x1de32b=>{const _0x555922=_0x296ffe;if(!validateTelegram(_0x1de32b))return;tgBot[_0x555922(0x24d)](_0x555922(0x163)),await getMessages();if(!updateAvailable)tgBot[_0x555922(0x19c)](_0x1de32b['chat']['id'],_0x555922(0x18f))['catch'](_0x28065a=>{telegramError(_0x28065a);});else!validInstallation?tgBot[_0x555922(0x19c)](_0x1de32b[_0x555922(0x1aa)]['id'],_0x555922(0x182))[_0x555922(0x1e8)](_0x1bd1e0=>{telegramError(_0x1bd1e0);}):(tgBot[_0x555922(0x19c)](_0x1de32b[_0x555922(0x1aa)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x555922(0x198),'callback_data':_0x555922(0x1f9)},{'text':'No','callback_data':'no'}]]}})[_0x555922(0x1e8)](_0x4b806c=>{telegramError(_0x4b806c);}),tgBot['on'](_0x555922(0x163),async _0x20475b=>{const _0x564872=_0x555922,_0x43c4a3=_0x20475b['data'],_0x516472=_0x20475b[_0x564872(0x251)];tgBot[_0x564872(0x15c)](_0x20475b['id'])[_0x564872(0x280)](async()=>{const _0x45dd96=_0x564872;_0x43c4a3==_0x45dd96(0x1f9)&&(await tgBot[_0x45dd96(0x19c)](_0x516472[_0x45dd96(0x1aa)]['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0x2d5b22=>{telegramError(_0x2d5b22);}),updateBB(_0x45dd96(0x195))),_0x43c4a3=='no'&&await tgBot[_0x45dd96(0x19c)](_0x516472[_0x45dd96(0x1aa)]['id'],_0x45dd96(0x151))[_0x45dd96(0x1e8)](_0x49596f=>{telegramError(_0x49596f);});}),tgBot[_0x564872(0x24d)](_0x564872(0x163));}));}),tgBot[_0x296ffe(0xf3)](/\/reinstall/,async _0x50ffc2=>{const _0x3387fd=_0x296ffe;if(!validateTelegram(_0x50ffc2))return;tgBot[_0x3387fd(0x24d)](_0x3387fd(0x163)),!validInstallation?tgBot[_0x3387fd(0x19c)](_0x50ffc2[_0x3387fd(0x1aa)]['id'],_0x3387fd(0x227))[_0x3387fd(0x1e8)](_0x418f00=>{telegramError(_0x418f00);}):(tgBot[_0x3387fd(0x19c)](_0x50ffc2['chat']['id'],_0x3387fd(0x1a1),{'reply_markup':{'inline_keyboard':[[{'text':_0x3387fd(0x198),'callback_data':_0x3387fd(0x1f9)},{'text':'No','callback_data':'no'}]]}})[_0x3387fd(0x1e8)](_0x3924c0=>{telegramError(_0x3924c0);}),tgBot['on'](_0x3387fd(0x163),async _0x1f3f1a=>{const _0xfc6dd4=_0x3387fd,_0x325e44=_0x1f3f1a[_0xfc6dd4(0x1a7)],_0x59f5f6=_0x1f3f1a[_0xfc6dd4(0x251)];tgBot[_0xfc6dd4(0x15c)](_0x1f3f1a['id'])[_0xfc6dd4(0x280)](async()=>{const _0x38b19f=_0xfc6dd4;_0x325e44==_0x38b19f(0x1f9)&&(await tgBot[_0x38b19f(0x19c)](_0x59f5f6['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation')['catch'](_0x37aa0f=>{telegramError(_0x37aa0f);}),updateBB(_0x38b19f(0x126))),_0x325e44=='no'&&await tgBot['sendMessage'](_0x59f5f6[_0x38b19f(0x1aa)]['id'],_0x38b19f(0x186))[_0x38b19f(0x1e8)](_0x11ec20=>{telegramError(_0x11ec20);});}),tgBot[_0xfc6dd4(0x24d)]('callback_query');}));}),tgBot[_0x296ffe(0xf3)](/\/toggle/,_0x439b66=>{const _0x570d29=_0x296ffe;if(!validateTelegram(_0x439b66))return;tgBot[_0x570d29(0x24d)](_0x570d29(0x163));const _0xca2cb4=getBotsWithMode();if(_0xca2cb4[_0x570d29(0x176)]==0x0)tgBot[_0x570d29(0x19c)](_0x439b66['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x570d29(0x1e8)](_0x347706=>{telegramError(_0x347706);});else{let _0x3604d6=[],_0x4fce82=[];const _0x503768=0x2;let _0xd98ac8=0x0;_0xca2cb4[_0x570d29(0x223)]((_0x571a83,_0xa4bb5)=>{const _0x921ccd=_0x570d29;if(_0xa4bb5%_0x503768==0x0)_0x4fce82=[];_0x4fce82[_0x921ccd(0x1a9)]({'text':'Bot\x20'+_0x571a83[_0x921ccd(0x140)]+'\x20('+_0x571a83[_0x921ccd(0x193)]+')','callback_data':_0x571a83[_0x921ccd(0x140)]}),_0xa4bb5%_0x503768==0x0&&(_0x3604d6[_0xd98ac8]=_0x4fce82,_0xd98ac8++);}),tgBot[_0x570d29(0x19c)](_0x439b66[_0x570d29(0x1aa)]['id'],_0x570d29(0x101),{'reply_markup':{'inline_keyboard':_0x3604d6}})[_0x570d29(0x1e8)](_0x46310a=>{telegramError(_0x46310a);}),tgBot['on']('callback_query',async _0x373e18=>{const _0x50cdfa=_0x570d29,_0x7e2ce9=_0x373e18[_0x50cdfa(0x1a7)],_0x2f4b69=_0x373e18[_0x50cdfa(0x251)];tgBot[_0x50cdfa(0x15c)](_0x373e18['id'])['then'](async()=>{const _0xb78524=_0x50cdfa,_0x421361=_0xca2cb4[_0xb78524(0x222)](_0x1bdad3=>_0x1bdad3[_0xb78524(0x140)]==_0x7e2ce9),_0x5a1b4f=_0x421361[_0xb78524(0x193)]==_0xb78524(0x1b6)?'manual':'auto';tgBot[_0xb78524(0x19c)](_0x2f4b69['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x7e2ce9+'\x20to\x20'+_0x5a1b4f+_0xb78524(0x23a))[_0xb78524(0x1e8)](_0xd75e97=>{telegramError(_0xd75e97);}),toggleBotMode(_0x7e2ce9);}),tgBot[_0x50cdfa(0x24d)](_0x50cdfa(0x163));});}}),tgBot[_0x296ffe(0xf3)](/\/names/,_0x47f709=>{const _0x58ef33=_0x296ffe;if(!validateTelegram(_0x47f709))return;let _0x2c0d16='';config[_0x58ef33(0x223)](_0x1d6470=>{const _0x1b0380=_0x58ef33;_0x2c0d16+='Bot\x20'+_0x1d6470[_0x1b0380(0x140)]+':\x20'+_0x1d6470[_0x1b0380(0xee)]+'\x0a';}),tgBot[_0x58ef33(0x19c)](_0x47f709[_0x58ef33(0x1aa)]['id'],_0x2c0d16,{'parse_mode':'HTML'})[_0x58ef33(0x1e8)](_0x2922ab=>{telegramError(_0x2922ab);});}),tgBot[_0x296ffe(0xf3)](/\/disable/,_0x3dad69=>{const _0x57bd12=_0x296ffe;if(!validateTelegram(_0x3dad69))return;tgBot[_0x57bd12(0x19c)](_0x3dad69[_0x57bd12(0x1aa)]['id'],'Notifications\x20disabled')[_0x57bd12(0x1e8)](_0x146906=>{telegramError(_0x146906);}),updateSetting(_0x57bd12(0x255),![]);}),tgBot[_0x296ffe(0xf3)](/\/help/,_0x4948d7=>{const _0x1ffce3=_0x296ffe;if(!validateTelegram(_0x4948d7))return;tgBot[_0x1ffce3(0x19c)](_0x4948d7[_0x1ffce3(0x1aa)]['id'],_0x10cac4)['catch'](_0x1d536f=>{telegramError(_0x1d536f);});}),tgBot['on'](_0x296ffe(0x220),_0x1fd664=>{const _0x159eb0=_0x296ffe;_0x1fd664[_0x159eb0(0x17a)]()['includes']('404\x20Not\x20Found')&&(logger[_0x159eb0(0xe4)](_0x159eb0(0x12d)),tgBot[_0x159eb0(0x246)](),tgBot=null,io['to'](_0x159eb0(0x169))[_0x159eb0(0x178)](_0x159eb0(0x276),_0x159eb0(0x12d)));}),process[_0x296ffe(0x1e2)]('SIGINT',()=>{const _0x4a8c57=_0x296ffe;if(tgBot)tgBot[_0x4a8c57(0x246)]();process[_0x4a8c57(0x11f)](0x1);}),process[_0x296ffe(0x1e2)]('SIGTERM',()=>{const _0xba14f6=_0x296ffe;if(tgBot)tgBot[_0xba14f6(0x246)]();process[_0xba14f6(0x11f)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x3083a0,_0x4d51df){const _0x54aaaf=_0xc54fdc;if(settings[_0x54aaaf(0x255)]){if(settings['telegramEvents']=='all'||(_0x4d51df['type']==_0x54aaaf(0x2a8)||_0x4d51df[_0x54aaaf(0x22b)]==_0x54aaaf(0x154)||_0x4d51df[_0x54aaaf(0x22b)]=='success')&&settings['telegramEvents']==_0x54aaaf(0x1a5)||_0x4d51df[_0x54aaaf(0x22b)]==_0x54aaaf(0x15d)&&settings[_0x54aaaf(0x25d)]=='orders'){if(tgBot&&settings[_0x54aaaf(0x25b)]){if(_0x4d51df[_0x54aaaf(0x1dd)])tgBot[_0x54aaaf(0x19c)](settings[_0x54aaaf(0x25b)],_0x4d51df[_0x54aaaf(0xee)]+_0x54aaaf(0x214)+_0x4d51df[_0x54aaaf(0x1d9)])[_0x54aaaf(0x1e8)](_0x1ddf9b=>{telegramError(_0x1ddf9b);});else tgBot[_0x54aaaf(0x19c)](settings[_0x54aaaf(0x25b)],'Bot\x20'+_0x3083a0+_0x54aaaf(0x214)+_0x4d51df[_0x54aaaf(0x1d9)])['catch'](_0xf121d9=>{telegramError(_0xf121d9);});}}}}async function sendTelegramMsg(_0x403374,_0x1fc062=_0xc54fdc(0x291)){const _0x483258=_0xc54fdc;return settings[_0x483258(0x255)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x483258(0x19c)](settings[_0x483258(0x25b)],_0x403374,{'parse_mode':_0x1fc062})[_0x483258(0x1e8)](_0x413873=>{telegramError(_0x413873);}),!![]):![];}function getDeviceWithIp(_0x5e0725){const _0x25af9f=_0xc54fdc;return devices[_0x25af9f(0x222)](_0x4c9f94=>_0x4c9f94['ip']===_0x5e0725);}function temporaryAccess2FA(_0x5531e3,_0x192e1d){const _0x5598e3=_0xc54fdc;let _0x43d8a4=new Date(),_0x177fd8=![];if(lastIpApproval){if(_0x43d8a4-lastIpApproval<0x1388)_0x177fd8=!![];}lastIpApproval=new Date();if(_0x177fd8)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x5598e3(0x24d)](_0x5598e3(0x163)),tgBot[_0x5598e3(0x19c)](settings[_0x5598e3(0x25b)],_0x5598e3(0x26f)+normalizeIP(_0x192e1d)[_0x5598e3(0x211)]+_0x5598e3(0x18c),{'parse_mode':_0x5598e3(0x291),'reply_markup':{'inline_keyboard':[[{'text':_0x5598e3(0x26c),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x5598e3(0x1e0),'callback_data':'30'},{'text':_0x5598e3(0x158),'callback_data':_0x5598e3(0x158)}]]}})[_0x5598e3(0x1e8)](_0x28984f=>{telegramError(_0x28984f);}),tgBot['on'](_0x5598e3(0x163),async _0x43ac73=>{const _0x425ae1=_0x5598e3,_0x44bffc=_0x43ac73['data'],_0x25a400=_0x43ac73[_0x425ae1(0x251)];tgBot[_0x425ae1(0x15c)](_0x43ac73['id'])['then'](async()=>{const _0x177a3f=_0x425ae1;devices[_0x5531e3]['telegramIpApproval']={'clientip':_0x192e1d,'timestamp':new Date()[_0x177a3f(0x14f)](),'expiry':_0x44bffc},_0x44bffc!=_0x177a3f(0x158)?(await tgBot[_0x177a3f(0x19c)](_0x25a400[_0x177a3f(0x1aa)]['id'],_0x177a3f(0x16b)+_0x44bffc+_0x177a3f(0x1c8),{'parse_mode':_0x177a3f(0x291)})['catch'](_0x406430=>{telegramError(_0x406430);}),io['to'](_0x5531e3)['emit'](_0x177a3f(0x1d6),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x177a3f(0x19c)](_0x25a400['chat']['id'],_0x177a3f(0x1ca))['catch'](_0x326f61=>{telegramError(_0x326f61);}),io['to'](_0x5531e3)[_0x177a3f(0x178)](_0x177a3f(0x1d6),{'access':{'allow':![],'reason':_0x177a3f(0x289),'token':null}}));}),tgBot[_0x425ae1(0x24d)](_0x425ae1(0x163));}));}function loginAccess2FA(_0x39fdc9,_0x4dd6d8){const _0x38c63e=_0xc54fdc;tgBot&&settings[_0x38c63e(0x25b)]&&(tgBot[_0x38c63e(0x24d)](_0x38c63e(0x163)),tgBot['sendMessage'](settings['telegramChatId'],_0x38c63e(0xf9)+normalizeIP(_0x4dd6d8)[_0x38c63e(0x211)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x38c63e(0x250),'callback_data':loginExpiry},{'text':_0x38c63e(0x158),'callback_data':'reject'}]]}})[_0x38c63e(0x1e8)](_0xe9bd42=>{telegramError(_0xe9bd42);}),tgBot['on'](_0x38c63e(0x163),async _0x4de0ec=>{const _0x308022=_0x38c63e,_0x14cacb=_0x4de0ec[_0x308022(0x1a7)],_0x2279e6=_0x4de0ec['message'];tgBot[_0x308022(0x15c)](_0x4de0ec['id'])[_0x308022(0x280)](async()=>{const _0x3592bc=_0x308022;devices[_0x39fdc9][_0x3592bc(0x20d)]={'clientip':_0x4dd6d8,'timestamp':new Date()[_0x3592bc(0x14f)](),'expiry':_0x14cacb},_0x14cacb!=_0x3592bc(0x158)?(await tgBot[_0x3592bc(0x19c)](_0x2279e6[_0x3592bc(0x1aa)]['id'],_0x3592bc(0x159),{'parse_mode':_0x3592bc(0x291)})['catch'](_0x3cdac6=>{telegramError(_0x3cdac6);}),io['to'](_0x39fdc9)['emit'](_0x3592bc(0x1d6),{'access':{'allow':![],'reason':_0x3592bc(0x262),'token':null}})):(await tgBot[_0x3592bc(0x19c)](_0x2279e6[_0x3592bc(0x1aa)]['id'],_0x3592bc(0x219))[_0x3592bc(0x1e8)](_0x437fc8=>{telegramError(_0x437fc8);}),io['to'](_0x39fdc9)['emit']('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x308022(0x163));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x546dd1=_0xc54fdc;return dbConfig[_0x546dd1(0x1ec)](_0x546dd1(0x257))[_0x546dd1(0x2a6)]('botID')['filter']({'status':_0x546dd1(0x24a)})[_0x546dd1(0x1fb)]()||[];}function getDisabledBots(){const _0x1b2774=_0xc54fdc;return dbConfig[_0x1b2774(0x1ec)]('bots')[_0x1b2774(0x2a6)](_0x1b2774(0x140))[_0x1b2774(0x135)]({'status':_0x1b2774(0x153)})[_0x1b2774(0x1fb)]()||[];}function getBotAttributes(_0x393228){const _0x2f31a5=_0xc54fdc;let _0xe37664={};const _0x3fb6fa=configpath+_0x2f31a5(0x105)+_0x393228+'-config.json',_0x4cf5c1=fs[_0x2f31a5(0x269)](_0x3fb6fa);if(_0x4cf5c1){const _0x204da4=fs['readFileSync'](_0x3fb6fa);try{const _0x1e20ce=JSON['parse'](_0x204da4),_0x52b922=_0x1e20ce?_0x1e20ce[_0x2f31a5(0x179)][0x0][_0x2f31a5(0x1ae)]:![];_0xe37664[_0x2f31a5(0x193)]=_0x52b922?_0x2f31a5(0x1b6):_0x2f31a5(0xf8),_0xe37664[_0x2f31a5(0xee)]=_0x1e20ce?_0x1e20ce[_0x2f31a5(0x179)][0x0][_0x2f31a5(0xee)]:'Bot\x20'+_0x393228;}catch(_0x37b7e1){_0xe37664[_0x2f31a5(0x193)]=_0x2f31a5(0xf8),_0xe37664[_0x2f31a5(0xee)]=_0x2f31a5(0x10c)+_0x393228;}}else _0xe37664[_0x2f31a5(0x193)]=_0x2f31a5(0xf8),_0xe37664[_0x2f31a5(0xee)]=_0x2f31a5(0x10c)+_0x393228;return _0xe37664;}function getBotsWithMode(){const _0x38da66=_0xc54fdc,_0x38c92f=dbConfig[_0x38da66(0x1ec)](_0x38da66(0x257))['sortBy']('botID')[_0x38da66(0x1fb)]()||[];return _0x38c92f[_0x38da66(0x223)](_0x3ada78=>{const _0x3c32f2=_0x38da66;let _0x586f2d=getBotAttributes(_0x3ada78[_0x3c32f2(0x140)]);_0x3ada78[_0x3c32f2(0x193)]=_0x586f2d[_0x3c32f2(0x193)];}),_0x38c92f;}function getBotExchanges(){const _0x39ad33=_0xc54fdc;let _0x10046a=[];const _0x419bd7=dbConfig['get'](_0x39ad33(0x257))[_0x39ad33(0x2a6)]('botID')[_0x39ad33(0x1fb)]()||[];_0x419bd7[_0x39ad33(0x223)](_0x147a52=>{const _0x1ae873=_0x39ad33;if(_0x147a52[_0x1ae873(0x1d6)]==_0x1ae873(0x24a)){const _0x27c4c2=configpath+_0x1ae873(0x105)+_0x147a52[_0x1ae873(0x140)]+_0x1ae873(0x1e7),_0x362b63=fs['existsSync'](_0x27c4c2);let _0x421342;if(_0x362b63){const _0x316fba=fs[_0x1ae873(0x10f)](_0x27c4c2);try{const _0x26a46b=JSON[_0x1ae873(0x21b)](_0x316fba);_0x421342=_0x26a46b?_0x26a46b[_0x1ae873(0x179)][0x0]['exchange']:null;}catch(_0x2d437c){}}if(_0x421342)_0x10046a['push'](_0x421342);}});const _0x12be01=[...new Set(_0x10046a)][_0x39ad33(0xfb)]();return _0x12be01;}async function initUser(){const _0x4cee02=_0xc54fdc;if(!settings[_0x4cee02(0x215)]){const _0x3df8de=uuidRandom();mixpanel[_0x4cee02(0x139)](_0x3df8de),updateSetting(_0x4cee02(0x215),_0x3df8de);}}async function initSecure(){const _0x2b2e43=_0xc54fdc;let _0x2a16d6=getSecure();if(!_0x2a16d6[_0x2b2e43(0x1e1)](_0x2b2e43(0x29e))){let _0x6ceca9=await generateKeys();_0x2a16d6[_0x2b2e43(0x24f)]=_0x6ceca9[_0x2b2e43(0x24f)],_0x2a16d6[_0x2b2e43(0x27d)]=_0x6ceca9[_0x2b2e43(0x27d)],_0x2a16d6[_0x2b2e43(0x29e)]=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x2a16d6);}}function getSettings(){const _0x2b9c66=_0xc54fdc;return dbSettings[_0x2b9c66(0x1ec)](_0x2b9c66(0x17e))['value']()||{};}function getSecure(){const _0x10afdf=_0xc54fdc;return dbSecure['get'](_0x10afdf(0x265))['value']()||{};}function getBlacklist(){const _0x3d9c8a=_0xc54fdc;return dbSecure[_0x3d9c8a(0x1ec)](_0x3d9c8a(0x24b))['value']()||[];}function broadcastToBots(_0x35b453,_0x84a3ed){const _0x10d68f=_0xc54fdc;config[_0x10d68f(0x223)](_0xa56624=>{const _0x3968fc=_0x10d68f;if(_0xa56624[_0x3968fc(0x1d6)]==_0x3968fc(0x24a)&&_0xa56624[_0x3968fc(0x28e)]==_0x3968fc(0x15a)||_0xa56624['status']==_0x3968fc(0x13d)&&_0xa56624[_0x3968fc(0x28e)]==_0x3968fc(0x15a)){if(pid[_0xa56624[_0x3968fc(0x140)]])pid[_0xa56624[_0x3968fc(0x140)]][_0x3968fc(0xf6)]({[_0x35b453]:_0x84a3ed});}});}function storeSettings(_0x19c63e,_0x148025=![]){const _0x549f36=_0xc54fdc;_0x19c63e={...settings,..._0x19c63e};if(_0x148025&&_0x19c63e[_0x549f36(0x27f)]!=_0x549f36(0x125)&&_0x19c63e['bbPassword']!='***'&&_0x19c63e['bbPassword']!=''){const _0x1f0cb6=crypt[_0x549f36(0x152)](secure[_0x549f36(0x27d)],_0x19c63e['bbPassword'])[_0x549f36(0x251)]['split']('@')[0x0],_0x3c33a9=bcrypt[_0x549f36(0x237)](_0x1f0cb6,saltRounds);_0x19c63e={..._0x19c63e,'bbPassword':_0x3c33a9};}if(_0x148025&&_0x19c63e[_0x549f36(0x2a5)]!=_0x549f36(0x125)&&_0x19c63e[_0x549f36(0x2a5)]!=_0x549f36(0x267)&&_0x19c63e[_0x549f36(0x2a5)]!=''){const _0x540a23=crypt['decrypt'](secure[_0x549f36(0x27d)],_0x19c63e[_0x549f36(0x2a5)])['message'][_0x549f36(0x28d)]('@')[0x0];_0x19c63e={..._0x19c63e,'telegramToken':_0x540a23};}const _0x556691=_0x19c63e[_0x549f36(0x2a5)]!=_0x549f36(0x125)&&_0x19c63e[_0x549f36(0x2a5)]!=settings['telegramToken']||_0x19c63e[_0x549f36(0x271)]!=settings[_0x549f36(0x271)],_0xb9ad95=_0x19c63e['telegramToken']==''||_0x19c63e[_0x549f36(0x271)]=='';if(_0x556691)_0x19c63e[_0x549f36(0x25d)]=_0x549f36(0x1ac);for(const [_0x258ffa,_0x3c4621]of Object[_0x549f36(0x11a)](_0x19c63e)){if(_0x258ffa==_0x549f36(0x2a5)&&_0x3c4621==_0x549f36(0x125)){_0x19c63e[_0x549f36(0x2a5)]=settings[_0x549f36(0x2a5)];continue;};if(_0x258ffa==_0x549f36(0x27f)&&_0x3c4621==_0x549f36(0x125)){_0x19c63e[_0x549f36(0x27f)]=settings['bbPassword'];continue;};dbSettings['set'](_0x549f36(0x275)+_0x258ffa,_0x3c4621)[_0x549f36(0x29c)]();}settings=_0x19c63e,io['to'](_0x549f36(0x169))['emit'](_0x549f36(0x17e),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x549f36(0x25f),settings[_0x549f36(0x25f)]);if(_0x556691&&!_0xb9ad95)initTelegram();if(_0x556691&&_0xb9ad95)disableTelegram();getAllClients()[_0x549f36(0x223)](_0x47dd22=>{const _0x2f4383=_0x549f36;getSocket(_0x47dd22['id'])[_0x2f4383(0x178)](_0x2f4383(0x1d6),{'access':{'allow':![],'reason':_0x2f4383(0x262),'token':null}});});}function updateSetting(_0xe006e7,_0x3f49a6){const _0x5201fe=_0xc54fdc;dbSettings['set'](_0x5201fe(0x275)+_0xe006e7,_0x3f49a6)['write'](),settings=getSettings(),io['to'](_0x5201fe(0x169))[_0x5201fe(0x178)](_0x5201fe(0x17e),cleanSettings());}function storeSecure(_0x59e6b8){const _0x1072f2=_0xc54fdc;dbSecure[_0x1072f2(0x1ec)](_0x1072f2(0x265))[_0x1072f2(0x1a9)](_0x59e6b8)[_0x1072f2(0x29c)](),secure=_0x59e6b8;}function addBlacklist(_0x13a3df){const _0x42d67d=_0xc54fdc;cleanBlacklist();let _0x86c691;devices[_0x13a3df][_0x42d67d(0x10d)]?_0x86c691=Math[_0x42d67d(0x27a)](devices[_0x13a3df][_0x42d67d(0x10d)]['expiry'],loginExpiry):_0x86c691=loginExpiry,dbSecure[_0x42d67d(0x1ec)]('blacklist')[_0x42d67d(0x1a9)]({'expiry':new Date()[_0x42d67d(0x14f)]()+_0x86c691*0x3c*0x3e8,'token':devices[_0x13a3df]['access'][_0x42d67d(0x112)]})[_0x42d67d(0x29c)](),blacklist=dbSecure[_0x42d67d(0x1ec)](_0x42d67d(0x24b))[_0x42d67d(0x1fb)]();}function cleanBlacklist(){const _0x18e1d9=_0xc54fdc;let _0x421e8a=dbSecure[_0x18e1d9(0x1ec)]('blacklist')[_0x18e1d9(0x272)]()['value'](),_0x57279a=new Date()[_0x18e1d9(0x14f)]();_0x421e8a[_0x18e1d9(0x223)](_0x1c01db=>{const _0x466f02=_0x18e1d9;_0x1c01db[_0x466f02(0x1bb)]<_0x57279a&&dbSecure[_0x466f02(0x1ec)]('blacklist')[_0x466f02(0x115)]({'expiry':_0x1c01db[_0x466f02(0x1bb)]})[_0x466f02(0x29c)]();});}function initStates(){const _0x12328c=_0xc54fdc;let _0x59414d=getConfiguration();_0x59414d[_0x12328c(0x223)](_0x4a826b=>{const _0xd51cd=_0x12328c;_0x4a826b['live']=_0xd51cd(0x157);}),storeConfiguration(_0x59414d);}function onKeys(){const _0x1a8056=new RSA();return new Promise(_0x585eb7=>{_0x1a8056['generateKeyPairAsync']()['then'](_0x200a9b=>{_0x585eb7(_0x200a9b);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4d6d5c=_0xc54fdc;let _0x4a2010=getSettings(),_0x52f40e=![];!_0x4a2010['hasOwnProperty'](_0x4d6d5c(0x106))&&(_0x4a2010['lastmsgtelegram']=0x0,_0x52f40e=!![]);!_0x4a2010[_0x4d6d5c(0x1e1)](_0x4d6d5c(0x136))&&(_0x4a2010[_0x4d6d5c(0x136)]=0x0,_0x52f40e=!![]);!_0x4a2010['hasOwnProperty']('latestversion')&&(_0x4a2010[_0x4d6d5c(0x1cc)]=_0x4d6d5c(0x187),_0x52f40e=!![]);!_0x4a2010[_0x4d6d5c(0x1e1)](_0x4d6d5c(0x25f))&&(_0x4a2010[_0x4d6d5c(0x25f)]=![],_0x52f40e=!![]);if(_0x52f40e)storeSettings(_0x4a2010);}function storeConfiguration(_0x506a77){const _0x55b5fc=_0xc54fdc;dbConfig[_0x55b5fc(0x1ec)](_0x55b5fc(0x257))[_0x55b5fc(0x115)]()[_0x55b5fc(0x29c)](),_0x506a77[_0x55b5fc(0x223)](_0x55bc2c=>{const _0x357313=_0x55b5fc;delete _0x55bc2c[_0x357313(0x193)];}),dbConfig['get'](_0x55b5fc(0x257))[_0x55b5fc(0x1a9)](..._0x506a77)[_0x55b5fc(0x29c)](),config=_0x506a77;}function resetPassword(){const _0x247008=_0xc54fdc;tgBot&&settings[_0x247008(0x25b)]&&(tgBot[_0x247008(0x24d)](_0x247008(0x163)),tgBot['sendMessage'](settings['telegramChatId'],_0x247008(0x18d),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x247008(0x1f9),'callback_data':_0x247008(0x1f9)},{'text':'no','callback_data':'no'}]]}})[_0x247008(0x1e8)](_0x55aafd=>{telegramError(_0x55aafd);}),tgBot['on'](_0x247008(0x163),async _0x1e24eb=>{const _0x57c447=_0x247008,_0x47d3ac=_0x1e24eb[_0x57c447(0x1a7)],_0x2e3370=_0x1e24eb['message'];tgBot[_0x57c447(0x15c)](_0x1e24eb['id'])[_0x57c447(0x280)](async()=>{const _0x45ac5a=_0x57c447;if(_0x47d3ac!='no'){const _0xfc25a4=0xf,_0x55a0d4='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x5bfea7=Array[_0x45ac5a(0x147)](crypto['randomFillSync'](new Uint32Array(_0xfc25a4)))[_0x45ac5a(0x17b)](_0x2c5be2=>_0x55a0d4[_0x2c5be2%_0x55a0d4[_0x45ac5a(0x176)]])['join'](''),_0x8ac630=bcrypt[_0x45ac5a(0x237)](_0x5bfea7,saltRounds);storeSettings({'bbPassword':_0x8ac630}),await tgBot[_0x45ac5a(0x19c)](_0x2e3370[_0x45ac5a(0x1aa)]['id'],_0x45ac5a(0x252)+_0x5bfea7,{'parse_mode':_0x45ac5a(0x291)})[_0x45ac5a(0x1e8)](_0x4226b5=>{telegramError(_0x4226b5);});}else await tgBot[_0x45ac5a(0x19c)](_0x2e3370[_0x45ac5a(0x1aa)]['id'],_0x45ac5a(0x270))[_0x45ac5a(0x1e8)](_0x351f67=>{telegramError(_0x351f67);});}),tgBot[_0x57c447(0x24d)]('callback_query');}));}async function confirmRestore(_0x735142,_0x259940){const _0x3ffc2b=_0xc54fdc;io['to']('botmanager')['emit'](_0x3ffc2b(0x276),_0x3ffc2b(0xe6),_0x3ffc2b(0x15b)),tgBot&&settings[_0x3ffc2b(0x25b)]&&(tgBot[_0x3ffc2b(0x24d)]('callback_query'),await tgBot[_0x3ffc2b(0x19c)](settings[_0x3ffc2b(0x25b)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x3ffc2b(0x291),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3ffc2b(0x1f9)},{'text':'no','callback_data':'no'}]]}})[_0x3ffc2b(0x1e8)](_0x4e0edd=>{telegramError(_0x4e0edd);}),tgBot['on'](_0x3ffc2b(0x163),async _0x1e0cbf=>{const _0x4eeb0d=_0x3ffc2b,_0x1f153c=_0x1e0cbf['data'],_0x87841d=_0x1e0cbf['message'];tgBot[_0x4eeb0d(0x15c)](_0x1e0cbf['id'])[_0x4eeb0d(0x280)](async()=>{const _0x2af9b2=_0x4eeb0d;_0x1f153c==_0x2af9b2(0x1f9)?(await tgBot[_0x2af9b2(0x19c)](_0x87841d['chat']['id'],_0x2af9b2(0x1db),{'parse_mode':_0x2af9b2(0x291)})[_0x2af9b2(0x1e8)](_0x226b60=>{telegramError(_0x226b60);}),unzipFile(_0x735142,_0x259940)):(logger[_0x2af9b2(0x1d5)](_0x2af9b2(0x1c9)),await tgBot[_0x2af9b2(0x19c)](_0x87841d[_0x2af9b2(0x1aa)]['id'],_0x2af9b2(0x1c9))[_0x2af9b2(0x1e8)](_0x4fe2e2=>{telegramError(_0x4fe2e2);}));}),tgBot[_0x4eeb0d(0x24d)](_0x4eeb0d(0x163));}));}function getServerTime(){const _0x3373be=_0xc54fdc,_0x155a7c=new Date();return _0x155a7c[_0x3373be(0x209)]()+'/'+(_0x155a7c[_0x3373be(0x19f)]()+0x1)[_0x3373be(0x17a)]()[_0x3373be(0x2a9)](0x2,'0')+'/'+_0x155a7c[_0x3373be(0x16d)]()[_0x3373be(0x17a)]()[_0x3373be(0x2a9)](0x2,'0')+'\x20'+_0x155a7c[_0x3373be(0x1f7)]()[_0x3373be(0x17a)]()[_0x3373be(0x2a9)](0x2,'0')+':'+_0x155a7c[_0x3373be(0x238)]()[_0x3373be(0x17a)]()['padStart'](0x2,'0')+':'+_0x155a7c[_0x3373be(0x28a)]()['toString']()[_0x3373be(0x2a9)](0x2,'0');}function getTimeStamp(){const _0x593e3e=_0xc54fdc,_0x118394=shiftedTime();return _0x118394[_0x593e3e(0x209)]()+'/'+(_0x118394[_0x593e3e(0x19f)]()+0x1)['toString']()[_0x593e3e(0x2a9)](0x2,'0')+'/'+_0x118394[_0x593e3e(0x16d)]()[_0x593e3e(0x17a)]()[_0x593e3e(0x2a9)](0x2,'0')+'\x20'+_0x118394['getHours']()['toString']()[_0x593e3e(0x2a9)](0x2,'0')+':'+_0x118394[_0x593e3e(0x238)]()[_0x593e3e(0x17a)]()[_0x593e3e(0x2a9)](0x2,'0')+':'+_0x118394['getSeconds']()[_0x593e3e(0x17a)]()[_0x593e3e(0x2a9)](0x2,'0');}function getCleanTimeStamp(){const _0x130441=_0xc54fdc,_0x18fea6=shiftedTime();return _0x18fea6[_0x130441(0x209)]()+(_0x18fea6[_0x130441(0x19f)]()+0x1)[_0x130441(0x17a)]()[_0x130441(0x2a9)](0x2,'0')+_0x18fea6['getDate']()[_0x130441(0x17a)]()[_0x130441(0x2a9)](0x2,'0')+'-'+_0x18fea6[_0x130441(0x1f7)]()[_0x130441(0x17a)]()['padStart'](0x2,'0')+_0x18fea6[_0x130441(0x238)]()[_0x130441(0x17a)]()[_0x130441(0x2a9)](0x2,'0')+_0x18fea6[_0x130441(0x28a)]()[_0x130441(0x17a)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x5cee31=_0xc54fdc,_0x4f545c=new Date();let _0x4aaa72=_0x4f545c;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x4aaa72=fns['add'](_0x4f545c,{'hours':settings[_0x5cee31(0x143)]});return _0x4aaa72;}function startScheduler(){const _0x1f7695=_0xc54fdc,_0x1403ba=new Date()[_0x1f7695(0x16e)](),_0x5deed0=shiftedTime()['getHours']();_0x5deed0==0x4&&backupConfigFiles();_0x5deed0==0x0&&rotateLogFiles();_0x1403ba%0x6==0x0&&triggerAnalytics();_0x1403ba%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2fc1bb){const _0x1689eb=_0xc54fdc;logger[_0x1689eb(0x1d5)](_0x1689eb(0x20b)+_0x2fc1bb);const _0x42b65b=getBotsWithMode();_0x42b65b[_0x1689eb(0x176)]>0x0?confirmRestore(configbackuppath,_0x2fc1bb):unzipFile(configbackuppath,_0x2fc1bb);}async function getBackupFiles(_0x493ad4=null){const _0x36dbdb=_0xc54fdc;let _0x5a6342=[],_0x2ba546=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2ba546[_0x36dbdb(0xfb)]((_0x32f7b5,_0x9ad92b)=>_0x32f7b5[_0x36dbdb(0x2a1)]<_0x9ad92b[_0x36dbdb(0x2a1)]?0x1:_0x9ad92b['name']<_0x32f7b5[_0x36dbdb(0x2a1)]?-0x1:0x0),_0x2ba546['forEach'](_0x35ddad=>{const _0x1fa457=_0x36dbdb;if(!_0x35ddad[_0x1fa457(0x2a3)]()&&_0x35ddad[_0x1fa457(0x2a1)]['startsWith'](_0x1fa457(0x116))&&_0x35ddad[_0x1fa457(0x2a1)][_0x1fa457(0x247)]('.zip')){const _0x3e3a81=formatDate(fs[_0x1fa457(0x266)](configbackuppath+_0x35ddad[_0x1fa457(0x2a1)])[_0x1fa457(0x288)]);_0x5a6342['push']({'name':_0x35ddad['name'],'mtime':_0x3e3a81});}});if(_0x493ad4)io['to'](_0x493ad4)[_0x36dbdb(0x178)](_0x36dbdb(0x27b),_0x5a6342);else return _0x5a6342;}async function backupConfigFiles(){const _0x56cee5=_0xc54fdc;await zipFiles(_0x56cee5(0x27c));const _0x4c7420=getCleanTimeStamp();fs[_0x56cee5(0x14a)](zippath+_0x56cee5(0x21c),configbackuppath+(_0x56cee5(0x116)+_0x4c7420+_0x56cee5(0x21f)));let _0xba883e=fs[_0x56cee5(0x18a)](configbackuppath,{'withFileTypes':!![]});_0xba883e[_0x56cee5(0xfb)]((_0x1697d6,_0x3864fc)=>_0x1697d6[_0x56cee5(0x2a1)]<_0x3864fc[_0x56cee5(0x2a1)]?0x1:_0x3864fc[_0x56cee5(0x2a1)]<_0x1697d6['name']?-0x1:0x0),_0xba883e[_0x56cee5(0x176)]>maxBackups&&fs[_0x56cee5(0xe2)](configbackuppath+_0xba883e[maxBackups][_0x56cee5(0x2a1)]);}function rotateLogFiles(){const _0x632e2f=_0xc54fdc,_0x3334ad=fs['statSync'](logspath+_0x632e2f(0x1b8)),_0x4a40e6=_0x3334ad[_0x632e2f(0x1fc)]/0x400;if(_0x4a40e6>0x64){let _0xce29fa=fs[_0x632e2f(0x18a)](logspath,{'withFileTypes':!![]});_0xce29fa[_0x632e2f(0xfb)]((_0x58f1f0,_0x53ac1a)=>_0x58f1f0[_0x632e2f(0x2a1)]<_0x53ac1a[_0x632e2f(0x2a1)]?0x1:_0x53ac1a[_0x632e2f(0x2a1)]<_0x58f1f0[_0x632e2f(0x2a1)]?-0x1:0x0),_0xce29fa['forEach'](_0x55687e=>{const _0x14674f=_0x632e2f;if(_0x55687e[_0x14674f(0x2a1)]==_0x14674f(0x256))fs['copyFileSync'](logspath+_0x55687e[_0x14674f(0x2a1)],logspath+_0x14674f(0x164));if(_0x55687e[_0x14674f(0x2a1)]==_0x14674f(0x294))fs[_0x14674f(0x14a)](logspath+_0x55687e[_0x14674f(0x2a1)],logspath+_0x14674f(0x256));_0x55687e[_0x14674f(0x2a1)]==_0x14674f(0x1b8)&&(fs[_0x14674f(0x14a)](logspath+_0x55687e[_0x14674f(0x2a1)],logspath+_0x14674f(0x294)),fs[_0x14674f(0x2ac)](logspath+_0x55687e[_0x14674f(0x2a1)],''));});}}async function zipFiles(_0x119bee){const _0x35a209=_0xc54fdc;let _0x39c69e;if(_0x119bee=='logs')_0x39c69e=logspath;if(_0x119bee==_0x35a209(0x123))_0x39c69e=configpath;if(_0x119bee==_0x35a209(0x27c))_0x39c69e=configpath;let _0x31aa82=fs[_0x35a209(0x18a)](_0x39c69e,{'withFileTypes':!![]});const _0x41c87c=new require(_0x35a209(0x1c7))();_0x31aa82['forEach'](_0x3116c0=>{const _0x53e1a5=_0x35a209;if(!_0x3116c0[_0x53e1a5(0x2a3)]()){let _0x50a05a=fs[_0x53e1a5(0x10f)](_0x39c69e+_0x3116c0[_0x53e1a5(0x2a1)]);if(_0x119bee==_0x53e1a5(0x123)){const _0xb56762=/^bot-[0-9]{3}-config.json$/,_0x5ca513=_0xb56762[_0x53e1a5(0x24e)](_0x3116c0['name']);if(_0x5ca513){const _0x37de78=JSON[_0x53e1a5(0x21b)](_0x50a05a);if(_0x37de78[_0x53e1a5(0x179)][0x0]){_0x37de78['bot'][0x0][_0x53e1a5(0x156)]=_0x53e1a5(0x267),_0x37de78[_0x53e1a5(0x179)][0x0][_0x53e1a5(0x173)]=_0x53e1a5(0x267);if(_0x37de78[_0x53e1a5(0x179)][0x0][_0x53e1a5(0x138)])_0x37de78[_0x53e1a5(0x179)][0x0][_0x53e1a5(0x138)]='***';}_0x50a05a=JSON[_0x53e1a5(0x134)](_0x37de78,null,0x2);}if(_0x3116c0[_0x53e1a5(0x2a1)]==_0x53e1a5(0x133)){const _0x773f8f=JSON['parse'](_0x50a05a);if(_0x773f8f[_0x53e1a5(0x17e)][_0x53e1a5(0x217)])_0x773f8f['settings'][_0x53e1a5(0x217)]=![];if(_0x773f8f['settings']['bbPassword'])_0x773f8f['settings']['bbPassword']=_0x53e1a5(0x267);if(_0x773f8f[_0x53e1a5(0x17e)][_0x53e1a5(0x2a5)])_0x773f8f[_0x53e1a5(0x17e)]['telegramToken']='***';if(_0x773f8f[_0x53e1a5(0x17e)]['telegramChatId'])_0x773f8f[_0x53e1a5(0x17e)][_0x53e1a5(0x25b)]=null;_0x50a05a=JSON[_0x53e1a5(0x134)](_0x773f8f,null,0x2);}if(_0x3116c0[_0x53e1a5(0x2a1)]!=_0x53e1a5(0x1a3))_0x41c87c['file'](_0x3116c0[_0x53e1a5(0x2a1)],_0x50a05a);}else _0x41c87c[_0x53e1a5(0x1ef)](_0x3116c0['name'],_0x50a05a);}});const _0x497446=_0x41c87c['generate']({'base64':![],'compression':_0x35a209(0x1b1)});fs['writeFileSync'](zippath+(_0x119bee+_0x35a209(0x21f)),_0x497446,_0x35a209(0x13e));}async function unzipFile(_0x474549,_0x44015b){const _0x12d5b6=_0xc54fdc;fs[_0x12d5b6(0x18a)](configpath,{'withFileTypes':!![]})['forEach'](_0x174a0b=>{const _0x231aad=_0x12d5b6;if(!_0x174a0b['isDirectory']())fs[_0x231aad(0x261)](configpath+_0x174a0b[_0x231aad(0x2a1)]);});const _0x1716aa=fs['readFileSync'](_0x474549+_0x44015b,_0x12d5b6(0x13e)),_0x1497cc=new require(_0x12d5b6(0x1c7))(_0x1716aa,{'base64':![],'checkCRC32':!![]});Object[_0x12d5b6(0x1bc)](_0x1497cc['files'])[_0x12d5b6(0x223)](_0x1c85be=>{const _0x40f62f=_0x12d5b6,_0x335569=_0x1497cc[_0x40f62f(0x1d7)][_0x1c85be];fs[_0x40f62f(0x2ac)](configpath+_0x335569[_0x40f62f(0x2a1)],_0x335569[_0x40f62f(0x142)]);}),fs[_0x12d5b6(0x18a)](temppath,{'withFileTypes':!![]})[_0x12d5b6(0x223)](_0x2849d9=>{const _0x55a6b2=_0x12d5b6;if(!_0x2849d9['isDirectory']())fs[_0x55a6b2(0x261)](temppath+_0x2849d9[_0x55a6b2(0x2a1)]);}),logger[_0x12d5b6(0x1d5)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x12d5b6(0xf6)]({'restore':!![]},_0x1770ae=>{});}async function getPublicIp(){const _0x232c2f=_0xc54fdc;try{const _0x3d6a3d=await axios['get'](_0x232c2f(0xea));publicip=_0x3d6a3d[_0x232c2f(0x1a7)]['ip'];}catch(_0x2b68ec){}}async function triggerAnalytics(){const _0x3e9ab4=_0xc54fdc;if(!publicip)await getPublicIp();const _0x6ee0ef=getBotsWithMode();let _0x55e923=0x0;_0x6ee0ef[_0x3e9ab4(0x223)](_0x1fe45b=>{const _0x290d16=_0x3e9ab4;if(_0x1fe45b['status']===_0x290d16(0x24a))_0x55e923++;});const _0x42dee7=getBotExchanges();mixpanel[_0x3e9ab4(0xe9)](_0x3e9ab4(0x21e),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x6ee0ef[_0x3e9ab4(0x176)],'numbotsenabled':_0x55e923,'exchanges':_0x42dee7});}async function getMessages(){const _0x5b3afe=_0xc54fdc,_0x2be52d=_0x5b3afe(0x1a0),_0x42b74f=new GraphQLClient(_0x2be52d),_0x846c85={'authorization':_0x5b3afe(0x1be)},_0xc709bc=serverversion[_0x5b3afe(0x28d)]('.'),_0xf5fc89=_0xc709bc[0x0]+'.'+_0xc709bc[0x1],_0x4fcd91=Math[_0x5b3afe(0x258)](settings[_0x5b3afe(0x106)],settings[_0x5b3afe(0x136)]),_0x36e0a5={'last':parseInt(_0x4fcd91),'bbm':_0xf5fc89},_0x28e1bb=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x346c0b;try{_0x346c0b=await _0x42b74f[_0x5b3afe(0xf4)](_0x28e1bb,_0x36e0a5,_0x846c85);}catch(_0x5b75f2){}if(_0x346c0b&&_0x346c0b[_0x5b3afe(0x1bd)]){let _0x55bd8d=settings[_0x5b3afe(0x106)];newMessages=[];for(const _0x369806 of _0x346c0b[_0x5b3afe(0x1bd)]){newMessages[_0x5b3afe(0x1a9)](_0x369806);if(_0x369806[_0x5b3afe(0x104)])updateSetting('latestversion',_0x369806['bbvNew']);let _0x4b5c0b=_0x369806[_0x5b3afe(0x104)]?serverversion>=_0x369806[_0x5b3afe(0x104)]:![];if(!_0x4b5c0b&&_0x369806[_0x5b3afe(0x16a)]>_0x55bd8d){if(_0x369806[_0x5b3afe(0x1b9)]===_0x5b3afe(0x184)||serverversion[_0x5b3afe(0x192)](_0x369806[_0x5b3afe(0x1b9)])){let _0x3e7fe2=''+_0x369806[_0x5b3afe(0x249)]+'\x0a\x0a'+_0x369806['message'];const _0x545ec6=await sendTelegramMsg(toTelegramMarkdown(_0x3e7fe2),'Markdown');if(_0x545ec6)_0x55bd8d=_0x369806[_0x5b3afe(0x16a)];}}}updateAvailable=isNewerVersion(settings[_0x5b3afe(0x1cc)],serverversion),updateSetting(_0x5b3afe(0x106),_0x55bd8d),emitMessages();}}function emitMessages(){const _0x39f3b0=_0xc54fdc,_0x4e2c6a=settings[_0x39f3b0(0x136)];let _0x495dcf=[];newMessages['forEach'](_0x5bd000=>{const _0x32cb01=_0x39f3b0;_0x5bd000[_0x32cb01(0x16a)]>_0x4e2c6a&&_0x495dcf[_0x32cb01(0x1a9)](_0x5bd000);}),_0x495dcf[_0x39f3b0(0x176)]>0x0&&getAllClients()[_0x39f3b0(0x223)](_0x7352be=>{const _0x24a2c7=_0x39f3b0;getSocket(_0x7352be['id'])[_0x24a2c7(0x178)](_0x24a2c7(0x251),_0x495dcf);});}function confirmMessage(_0x21da96){const _0x3a6ceb=_0xc54fdc;updateSetting(_0x3a6ceb(0x136),Number(_0x21da96));}function isNewerVersion(_0x112503,_0x13043b){const _0x4cf584=_0x13043b['split']('.'),_0x3fc0ae=_0x112503['split']('.');for(var _0x5d021a=0x0;_0x5d021a<_0x3fc0ae['length'];_0x5d021a++){const _0x1a476a=~~_0x3fc0ae[_0x5d021a],_0xc64175=~~_0x4cf584[_0x5d021a];if(_0x1a476a>_0xc64175)return!![];if(_0x1a476a<_0xc64175)return![];}return![];}function toTelegramMarkdown(_0x482c55){const _0x27dd50=_0xc54fdc,_0x48444a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2f6c64=/\*{2}(.+?)\*{2}/gim;return _0x482c55=_0x482c55['replace'](_0x48444a,_0x27dd50(0x22e))['replace'](_0x2f6c64,_0x27dd50(0x244)),_0x482c55;}async function validateConfigFile(){const _0x5ccacb=_0xc54fdc,_0x3a011c=dbConfig[_0x5ccacb(0x1ec)](_0x5ccacb(0x257))['sortBy'](_0x5ccacb(0x140))[_0x5ccacb(0x1fb)]()||[];if(_0x3a011c['length']==0x0){let _0x5edcdd=0x0,_0x54d452=[];const _0x143370=/^bot-([0-9]{3})-config.json$/,_0x1a6051=fs['readdirSync'](configpath);_0x1a6051[_0x5ccacb(0x223)](_0x19cc72=>{const _0x7754a=_0x5ccacb,_0x4ac13e=_0x143370['exec'](_0x19cc72);if(_0x4ac13e){const _0x103693=_0x4ac13e[0x1];let _0x108db1=getBotAttributes(_0x103693);_0x54d452[_0x7754a(0x1a9)]({'botID':_0x103693,'botname':_0x108db1[_0x7754a(0xee)],'status':_0x7754a(0x153),'live':'stopped'}),_0x5edcdd++;}}),_0x5edcdd!=0x0&&(dbConfig[_0x5ccacb(0x1ec)](_0x5ccacb(0x257))['assign'](_0x54d452)[_0x5ccacb(0x29c)](),config=_0x54d452,restoredConfigFile=_0x5edcdd);}}async function restoreConfigNotify(_0x3b2d56){const _0x3ee7f1=_0xc54fdc;let _0x2491d8;if(restoredConfigFile==0x1)_0x2491d8=_0x3ee7f1(0x14b);else _0x2491d8=_0x3ee7f1(0x1c2);if(_0x3b2d56)io['to'](_0x3ee7f1(0x169))[_0x3ee7f1(0x178)](_0x3ee7f1(0x276),_0x2491d8);else{logger[_0x3ee7f1(0x171)](_0x3ee7f1(0x298)),logger['simple'](_0x2491d8),logger[_0x3ee7f1(0x171)]('-----------------------------------------------------------------------------------'),logger[_0x3ee7f1(0x171)]('');if(tgBot&&settings[_0x3ee7f1(0x25b)]&&settings[_0x3ee7f1(0x25d)]!=_0x3ee7f1(0x20e))tgBot[_0x3ee7f1(0x19c)](settings[_0x3ee7f1(0x25b)],_0x3ee7f1(0x1f1)+_0x2491d8)[_0x3ee7f1(0x1e8)](_0x206fbd=>{telegramError(_0x206fbd);});}}function validateCredentials(_0x1e2e90,_0x321f50){const _0x467a51=_0xc54fdc;if(_0x1e2e90[_0x467a51(0x167)]==settings[_0x467a51(0x1df)]&&bcrypt[_0x467a51(0x13c)](_0x1e2e90[_0x467a51(0x194)],settings[_0x467a51(0x27f)])){if(settings[_0x467a51(0x2ab)])return{'allow':![],'reason':_0x467a51(0x118),'token':null};else{const _0x5275aa=generateLoginToken(_0x321f50);return{'allow':!![],'reason':_0x467a51(0x13b),'token':_0x5275aa};}}else return{'allow':![],'reason':_0x467a51(0x225),'token':null};}function refreshToken(_0x317d0a){const _0x26b7cc=_0xc54fdc,_0x245f5d=generateLoginToken(_0x317d0a);return{'allow':!![],'reason':_0x26b7cc(0x13b),'token':_0x245f5d};}function validateAccess(_0x253cda,_0x6c3ec2,_0x47cb09){const _0x36ddc9=_0xc54fdc,_0x33ac9f=_0x47cb09?_0x47cb09:devices[_0x6c3ec2]['ip'];let _0xd9f61d;const _0x22df39=_0x520c31=>{const _0x1c2921=_0x304a;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x6c3ec2)){const _0x52e0d5=generateLoginToken(_0x6c3ec2);return{'allow':!![],'reason':_0x1c2921(0x18e),'token':_0x52e0d5};}else return{'allow':![],'reason':_0x1c2921(0x2b4),'token':null};}else return _0xd9f61d=validToken(_0x520c31,_0x6c3ec2),_0xd9f61d['hasOwnProperty'](_0x1c2921(0x15b))?{'allow':!![],'reason':_0x1c2921(0x26a),'token':_0x520c31}:{'allow':![],'reason':_0x1c2921(0x2b4),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x36ddc9(0x241)]){let _0x8b912d=[...settings[_0x36ddc9(0x148)],_0x36ddc9(0x279),_0x36ddc9(0x1e9),_0x36ddc9(0x196)];if(_0x8b912d[_0x36ddc9(0x28c)](_0x33ac9f))return _0x22df39(_0x253cda);else{_0xd9f61d=validToken(_0x253cda,_0x6c3ec2);if(_0xd9f61d[_0x36ddc9(0x1e1)]('success'))return _0x22df39(_0x253cda);else{if(telegramIpApproved(_0x6c3ec2)){const _0x3d8e28=generateToken(_0x6c3ec2);return _0xd9f61d=_0x22df39(_0x253cda),_0xd9f61d[_0x36ddc9(0x23e)]?{'allow':!![],'reason':_0x36ddc9(0x2a4),'token':_0x3d8e28}:_0xd9f61d;}else return settings[_0x36ddc9(0x277)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x22df39(_0x253cda);}function timelyDecrypt(_0x5a24a3,_0x5cb2ef=!![]){const _0xb46fb=_0xc54fdc;if(_0x5a24a3)try{const _0x204e15=crypt[_0xb46fb(0x152)](secure[_0xb46fb(0x27d)],_0x5a24a3)[_0xb46fb(0x251)],_0x5360e4=_0x204e15[_0xb46fb(0x28d)]('@')[0x0],_0x39ae47=_0x204e15[_0xb46fb(0x28d)]('@')[0x1],_0xe4e70d=new Date()[_0xb46fb(0x14f)]();if(_0x5cb2ef){if(_0xe4e70d-_0x39ae47<maxSecretAge*0x3e8)return _0x5360e4;else return![];}else return _0x5360e4;}catch(_0x229d87){return![];}else return![];}const validToken=(_0x8c98d9,_0x5c8e5d)=>{const _0x45b1d1=_0xc54fdc,_0x1abb5e=devices[_0x5c8e5d]['ip'];if(!_0x8c98d9)return{'error':_0x45b1d1(0x13a)};for(let _0x5c2237 of blacklist){if(_0x5c2237['token']==_0x8c98d9)return{'error':_0x45b1d1(0x146)};}let _0x14d86e;try{_0x14d86e=jwt[_0x45b1d1(0x205)](_0x8c98d9,secure['secret']+_0x5c8e5d);}catch{return{'error':_0x45b1d1(0x226)};}if(!_0x14d86e[_0x45b1d1(0x1e1)](_0x45b1d1(0x189))&&!_0x14d86e[_0x45b1d1(0x1e1)](_0x45b1d1(0x167))||!_0x14d86e[_0x45b1d1(0x1e1)]('exp'))return{'error':_0x45b1d1(0x1d0)};if(!_0x14d86e[_0x45b1d1(0x1e1)]('username')&&_0x14d86e['hasOwnProperty']('clientip')){const {clientip:_0x5ceb45}=_0x14d86e;return _0x1abb5e==_0x5ceb45?{'success':_0x45b1d1(0x2b0)}:{'error':_0x45b1d1(0xfe)};}else{if(_0x14d86e[_0x45b1d1(0x1e1)]('username')&&_0x14d86e['hasOwnProperty'](_0x45b1d1(0x189))){const {username:_0x441bbb,clientip:_0x49bbf1}=_0x14d86e;return settings['bbUsername']==_0x441bbb&&_0x1abb5e==_0x49bbf1?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x395b9d=>{if(_0x395b9d){const _0xd44f51=devices[_0x395b9d]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0xd44f51},secure['secret']+_0x395b9d,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x51501f=>{const _0x17a0a9=_0xc54fdc;if(_0x51501f){const _0x35861a=devices[_0x51501f]['ip'];return jwt[_0x17a0a9(0x19e)]({'clientip':_0x35861a},secure['secret']+_0x51501f,{'expiresIn':devices[_0x51501f][_0x17a0a9(0x10d)][_0x17a0a9(0x1bb)]*0x3c});}else return![];},telegramIpApproved=_0x47c356=>{const _0x53e583=_0xc54fdc;let _0x2c3ad8=![];return devices[_0x47c356][_0x53e583(0x10d)]&&devices[_0x47c356][_0x53e583(0x10d)][_0x53e583(0x1bb)]!=_0x53e583(0x158)&&(_0x2c3ad8=devices[_0x47c356][_0x53e583(0x10d)]['clientip']==devices[_0x47c356]['ip']&&new Date()[_0x53e583(0x14f)]()-devices[_0x47c356]['telegramIpApproval'][_0x53e583(0x23d)]<devices[_0x47c356][_0x53e583(0x10d)]['expiry']*0x3c*0x3e8),_0x2c3ad8;},telegram2FaApproved=_0x5457b6=>{const _0x228cac=_0xc54fdc;let _0x182141=![];return devices[_0x5457b6]['telegram2FaApproval']&&devices[_0x5457b6][_0x228cac(0x20d)]['expiry']!=_0x228cac(0x158)&&(_0x182141=devices[_0x5457b6][_0x228cac(0x20d)][_0x228cac(0x189)]==devices[_0x5457b6]['ip']&&new Date()[_0x228cac(0x14f)]()-devices[_0x5457b6][_0x228cac(0x20d)][_0x228cac(0x23d)]<devices[_0x5457b6]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x182141;},normalizeIP=_0x462eb0=>{const _0x10fb1a=_0xc54fdc;let _0x6d824a=null,_0x17fdbf=null;if(ipaddr[_0x10fb1a(0x1ab)](_0x462eb0)){const _0x2262f9=ipaddr[_0x10fb1a(0x21b)](_0x462eb0);_0x2262f9[_0x10fb1a(0x232)]()==='ipv6'?(_0x2262f9[_0x10fb1a(0x26e)]()&&(_0x6d824a=_0x2262f9[_0x10fb1a(0x181)]()[_0x10fb1a(0x17a)]()),_0x17fdbf=_0x2262f9[_0x10fb1a(0x17a)]()):(_0x6d824a=_0x2262f9[_0x10fb1a(0x17a)](),_0x17fdbf=_0x2262f9[_0x10fb1a(0x1ee)]()[_0x10fb1a(0x17a)]());}return{'show':_0x6d824a?_0x6d824a:_0x17fdbf,'store':_0x17fdbf};};function formatDate(_0x1dba40){const _0x302f9d=_0xc54fdc;return _0x1dba40[_0x302f9d(0x209)]()+'/'+(_0x1dba40[_0x302f9d(0x19f)]()+0x1)[_0x302f9d(0x17a)]()[_0x302f9d(0x2a9)](0x2,'0')+'/'+_0x1dba40[_0x302f9d(0x16d)]()[_0x302f9d(0x17a)]()[_0x302f9d(0x2a9)](0x2,'0')+'\x20'+_0x1dba40[_0x302f9d(0x1f7)]()['toString']()[_0x302f9d(0x2a9)](0x2,'0')+':'+_0x1dba40[_0x302f9d(0x238)]()[_0x302f9d(0x17a)]()[_0x302f9d(0x2a9)](0x2,'0')+':'+_0x1dba40[_0x302f9d(0x28a)]()[_0x302f9d(0x17a)]()[_0x302f9d(0x2a9)](0x2,'0');}function sleep(_0x1dcea8){return new Promise(_0x515436=>setTimeout(_0x515436,_0x1dcea8));}