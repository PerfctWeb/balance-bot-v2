const _0x42be23=_0x322b;(function(_0x57d6c3,_0x52a89f){const _0x4c807c=_0x322b,_0x2f6a42=_0x57d6c3();while(!![]){try{const _0x254ad8=-parseInt(_0x4c807c(0x1f2))/0x1+-parseInt(_0x4c807c(0x1fd))/0x2+parseInt(_0x4c807c(0x1e5))/0x3+-parseInt(_0x4c807c(0x133))/0x4+-parseInt(_0x4c807c(0x169))/0x5+-parseInt(_0x4c807c(0x182))/0x6*(-parseInt(_0x4c807c(0x1fe))/0x7)+-parseInt(_0x4c807c(0x1fb))/0x8*(-parseInt(_0x4c807c(0x178))/0x9);if(_0x254ad8===_0x52a89f)break;else _0x2f6a42['push'](_0x2f6a42['shift']());}catch(_0x1415d5){_0x2f6a42['push'](_0x2f6a42['shift']());}}}(_0x4701,0xb860c));const _0x580d4e=function(){let _0x5206d5=!![];return function(_0x1640f1,_0x578a07){const _0x4171f7=_0x5206d5?function(){const _0x49536a=_0x322b;if(_0x578a07){const _0x16ef75=_0x578a07[_0x49536a(0x20d)](_0x1640f1,arguments);return _0x578a07=null,_0x16ef75;}}:function(){};return _0x5206d5=![],_0x4171f7;};}(),_0x5a6b1b=_0x580d4e(this,function(){const _0x466398=_0x322b;return _0x5a6b1b[_0x466398(0x269)]()[_0x466398(0x157)](_0x466398(0x233))[_0x466398(0x269)]()[_0x466398(0x1b2)](_0x5a6b1b)[_0x466398(0x157)](_0x466398(0x233));});_0x5a6b1b();'use strict';process[_0x42be23(0x1d9)][_0x42be23(0x21c)]=0x1;const childProcess=require(_0x42be23(0x1b7)),FileSync=require(_0x42be23(0x1ce)),fs=require('fs'),fns=require(_0x42be23(0x1a9)),low=require('lowdb'),path=require(_0x42be23(0x1dc)),crypto=require(_0x42be23(0x140)),Crypt=require(_0x42be23(0x194))['Crypt'],RSA=require(_0x42be23(0x194))[_0x42be23(0x1bd)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),analyticsLib=require(_0x42be23(0x1ba))[_0x42be23(0x1f1)],googleAnalytics=require('@analytics/google-analytics')[_0x42be23(0x1f1)],ipaddr=require('ipaddr.js'),argv=require(_0x42be23(0x1c2))(process[_0x42be23(0x148)][_0x42be23(0x25c)](0x2))[_0x42be23(0x148)],PORT=argv[_0x42be23(0x19e)]||_0x42be23(0x23a),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x42be23(0x221)](PORT))return console['log'](_0x42be23(0x227)+PORT+_0x42be23(0x141)),process[_0x42be23(0x1f8)](0x1);const HOST=argv['host']||null,userID=argv['user']||'';let bbpath=_0x42be23(0x253),bbpath2='';const botfile=_0x42be23(0x1a4),configfile=_0x42be23(0x1b3),settingsfile=_0x42be23(0x21d),securefile=_0x42be23(0x17e);!fs[_0x42be23(0x268)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x42be23(0x218)),configpath=userID?bbpath+_0x42be23(0x245)+userID+'/':bbpath+_0x42be23(0x245),configbackuppath=configpath+'backup/';!fs[_0x42be23(0x268)](configpath)&&fs[_0x42be23(0x20b)](configpath);!fs[_0x42be23(0x268)](configbackuppath)&&fs[_0x42be23(0x20b)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x42be23(0x24b)]({'bots':[]})[_0x42be23(0x24e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x42be23(0x24b)]({'settings':{'timeshift':0x0}})[_0x42be23(0x24e)]();function _0x322b(_0x4b86cc,_0x9e024a){const _0x295aab=_0x4701();return _0x322b=function(_0x5a6b1b,_0x580d4e){_0x5a6b1b=_0x5a6b1b-0x129;let _0x470129=_0x295aab[_0x5a6b1b];return _0x470129;},_0x322b(_0x4b86cc,_0x9e024a);}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x42be23(0x24b)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x42be23(0x1a2),'rsaStandard':_0x42be23(0x155)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x42be23(0x1c1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x42be23(0x1e1)),app=express(),http=require(_0x42be23(0x149))[_0x42be23(0x1a3)](app);app[_0x42be23(0x25e)](express[_0x42be23(0x1ad)](path['join'](__dirname,bbpath2,_0x42be23(0x12e)))),app['use'](express[_0x42be23(0x1ad)](path[_0x42be23(0x23e)](__dirname,bbpath2,_0x42be23(0x242)))),app[_0x42be23(0x255)]('/',function(_0x3d0500,_0x5cd3a1){const _0x5bb56f=_0x42be23;_0x5cd3a1[_0x5bb56f(0x12f)](path[_0x5bb56f(0x23e)](__dirname,bbpath2,_0x5bb56f(0x12e),_0x5bb56f(0x17b)));}),app[_0x42be23(0x255)](_0x42be23(0x13e),function(_0x2959a5,_0x57bfef){const _0x2a9a0d=_0x42be23;_0x57bfef[_0x2a9a0d(0x12f)](path[_0x2a9a0d(0x23e)](__dirname,bbpath2,_0x2a9a0d(0x242),_0x2a9a0d(0x17b)));}),app[_0x42be23(0x255)](_0x42be23(0x15c),(_0x5a523d,_0x5f2d5e)=>{const _0x1ea2cb=_0x42be23;_0x5f2d5e[_0x1ea2cb(0x12f)](path[_0x1ea2cb(0x23e)](__dirname,bbpath2,_0x1ea2cb(0x242),'index.html'));}),app[_0x42be23(0x255)](_0x42be23(0x26c),(_0x520766,_0x16a574)=>{const _0x327310=_0x42be23;_0x16a574['sendFile'](path[_0x327310(0x23e)](__dirname,bbpath2,_0x327310(0x242),_0x327310(0x17b)));}),app[_0x42be23(0x255)]('/:bot/coins',(_0x4183f8,_0x18c33c)=>{const _0x4acffe=_0x42be23;_0x18c33c[_0x4acffe(0x12f)](path['join'](__dirname,bbpath2,_0x4acffe(0x242),_0x4acffe(0x17b)));}),app[_0x42be23(0x255)]('/:bot/history',(_0x22b025,_0x2f2386)=>{const _0x9aff4e=_0x42be23;_0x2f2386[_0x9aff4e(0x12f)](path[_0x9aff4e(0x23e)](__dirname,bbpath2,'build','index.html'));}),app[_0x42be23(0x255)](_0x42be23(0x21a),(_0x4f9675,_0x205bde)=>{const _0x423055=_0x42be23;_0x205bde[_0x423055(0x12f)](path[_0x423055(0x23e)](__dirname,bbpath2,_0x423055(0x242),_0x423055(0x17b)));}),app[_0x42be23(0x255)](_0x42be23(0x20c),(_0x25c271,_0x46a35d)=>{const _0x50e2c6=_0x42be23;_0x46a35d[_0x50e2c6(0x12f)](path[_0x50e2c6(0x23e)](__dirname,bbpath2,_0x50e2c6(0x242),_0x50e2c6(0x17b)));});if(HOST)http[_0x42be23(0x187)](PORT,HOST);else http[_0x42be23(0x187)](PORT);const io=require(_0x42be23(0x230))(http,{}),analytics=analyticsLib({'app':_0x42be23(0x1d1),'plugins':[googleAnalytics({'trackingId':_0x42be23(0x200)})]}),TelegramBot=require(_0x42be23(0x18b));let tgBot;function _0x4701(){const _0x10f21f=['apply','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','getTime','new-disabled','No\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','yes','Bot\x20','get-starting-balances','conn','No\x20authentication\x20token','clients','getStartingBalances','/:bot/configuration','placeOrder','NTBA_FIX_319','bb-settings.json','\x20>\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Notifications\x20enabled','test','storeHeadless','copyFileSync','whitelistEnabled','started','Unauthorized\x20attempt\x20to\x20add\x20bot','Error:\x20Invalid\x20argument\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Alerts','page','order','exp','token','/disable\x20-\x20disable\x20notifications\x0a','store','socket.io','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','disconnect','(((.+)+)+)+$','bots','success','unlinkSync','restarting\x20Bot\x20','getUTCHours','pidExpireLogin','3000','expiry','decrypt','update-bot','join','answerCallbackQuery','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','readdirSync','build','starting\x20new\x20bot\x20|\x20Bot\x20','cancelLoading','config/','sendMessage','logout','telegramChatId','clientip','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','defaults','getDate','/off\x20-\x20stop\x20bot(s)\x0a','write','connected','botmanager','remoteAddress','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bb/','-results.json','get','all','loginRequired','stopPolling','hashSync','/restart\x20-\x20restart\x20bot(s)\x0a','secure','slice','storeConfiguration','use','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Invalid\x20Telegram\x20token','catch','uuid','<b>Telegram\x20bot\x20status:</b>\x0a','toIPv4Address','15\x20min',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','removeAllListeners','existsSync','toString','filter','-events.json','/:bot/performance','Invalid\x20username\x20or\x20IP\x20address','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','remove','privateKey','message','showname','isDirectory','inherit','once','store-headless','SIGINT','build2','sendFile','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','2FA','max','1880288lijlbF','idling\x20bot\x20\x20\x20|\x20Bot\x20','getSeconds','temporaryAccessAllowed','blacklist','https://hodlerhacks.com','isIPv4MappedAddress','live','initclient','/status\x20-\x20show\x20bot(s)\x20status\x0a','timeshift','/:bot','login','crypto',',\x20must\x20be\x20a\x204\x20digit\x20number','data','botID','status','1000','disabled','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','argv','http','assign','temporary\x20access\x20timeout','2FA\x20login\x20token\x20generated','\x20/\x20','map','kind','allow','starting\x20bot\x20|\x20Bot\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bbPassword','-performance.json','RSA-OAEP','settings','search','enabled\x20Bot\x20','reload','login\x20token\x20generated','timestamp','/:bot/portfolio','User\x20has\x20been\x20validated','emitHistory','Invalid\x20authentication\x20token\x20(2)','temporary\x20access\x20not\x20allowed','chat','username','delete-bot','telegramToken','set','<b>Balance\x20Bot\x20status:</b>\x0a','telegram','Unauthorized\x20attempt\x20to\x20get\x20logs','2983555MPdPgv','\x20only\x0a','getHours','telegramUsername','logged\x20out','connection','emit','telegram2FaApproval','ipc','event','2FA\x20login\x20required','send','temporary\x20access\x20rejected','sockets','accept','91926RFZzOE','invalid\x20credentials','cancel-loading','index.html','Invalid\x20authentication\x20token\x20(1)','polling_error','bb-secure.json','show','secret','ipv6','334902RvZeYV','5\x20min','generateKeyPairAsync','Orders','name','listen','whitelist','stop','Notifications\x20enabled\x0a','node-telegram-bot-api','match','server','telegramEvents','deleted\x20Bot\x20','onText','disabled\x20Bot\x20','bot','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','hybrid-crypto-js','getFullYear','/on\x20-\x20start\x20bot(s)\x0a','length','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','stopped','Ok,\x20will\x20send\x20alert\x20notifications\x20only','::1','push','bot-','port','Login\x20rejected','temporary\x20token\x20generated','log','sha256','createServer','bot.js','f2aRequired','2FA\x20login\x20rejected','login\x20not\x20required','value','date-fns','2FA\x20required','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','error','static','hex','SIGTERM','forEach','Password\x20reset\x20rejected','constructor','bb-config.json','type','access','30\x20min','child_process','HTML','Notifications\x20disabled\x0a','analytics','publicKey','All','RSA','Access\x20enabled\x20for\x20','getPortfolio','settings.','version','yargs/yargs','Temporary\x20access\x20rejected','All\x20bots\x20running\x20right\x20now','randomBytes','kill','\x20|\x20','getMinutes','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20log\x20out','function','apiKey','sortBy','lowdb/adapters/FileSync','</b>\x20?','reject','Balance\x20Bot','padStart','Unauthorized\x20attempt\x20to\x20delete\x20bot','-----------------------------------------------------------------------------------','running','login\x20required','randomFillSync','get-portfolio','env','then','find','path','telegramIpApproval','Notifications\x20disabled','parse','new','express','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','127.0.0.1','Token\x20blacklisted','1156473ImqbgX','botname','args','split','Unauthorized\x20attempt\x20to\x20get\x20portfolio','removeListener','headers','includes','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','getMonth','All\x20bots','from','default','31001lZgaPL','bbUsername','callback_query','orders','telegramEnabled','referer','exit','handshake','enabled','952Epkbfk','access\x20timeout','1282066wLhTwh','112rKvAli','store-configuration','UA-192771731-1','hasOwnProperty','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','Login\x20accepted','************','alerts','Notifications\x20types:\x20','reason','pidRefreshToken','Balance\x20Bot\x20Server','sign','mkdirSync','/:bot/support'];_0x4701=function(){return _0x10f21f;};return _0x4701();}if(settings[_0x42be23(0x164)]&&settings['telegramToken']!=''&&settings[_0x42be23(0x16c)]&&settings[_0x42be23(0x16c)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x500627=_0x42be23;console[_0x500627(0x1a1)](''),console[_0x500627(0x1a1)](_0x500627(0x1d4)),logging(_0x500627(0x202)+PORT),console[_0x500627(0x1a1)](_0x500627(0x1d4));if(config[_0x500627(0x197)]!=0x0)config[_0x500627(0x1b0)](_0x2c3995=>{const _0x501a2f=_0x500627;if(_0x2c3995[_0x501a2f(0x144)]==_0x501a2f(0x1fa)||_0x2c3995[_0x501a2f(0x144)]==_0x501a2f(0x1e0))logging(_0x501a2f(0x151)+_0x2c3995[_0x501a2f(0x143)]+_0x501a2f(0x1c7)+_0x2c3995[_0x501a2f(0x1e6)]),startBot([_0x2c3995[_0x501a2f(0x143)],userID],{'cwd':bbpath},function(_0x974a9e){if(_0x974a9e)logging(_0x974a9e);});else(_0x2c3995[_0x501a2f(0x144)]==_0x501a2f(0x146)||_0x2c3995[_0x501a2f(0x144)]==_0x501a2f(0x210))&&logging(_0x501a2f(0x134)+_0x2c3995[_0x501a2f(0x143)]+'\x20|\x20'+_0x2c3995[_0x501a2f(0x1e6)]);});else!newBot&&console[_0x500627(0x1a1)](_0x500627(0x152));if(newBot)addBot();console['log']('-----------------------------------------------------------------------------------'),console['log']('');}function startSocket(){const _0x539232=_0x42be23;io['on'](_0x539232(0x16e),_0x3c6712=>{const _0x15ca03=_0x539232;let _0x48fdfc,_0x50c7fc,_0x41c674,_0x5ba16b,_0x1d8170;const _0xfa4dce=_0x3c6712[_0x15ca03(0x1f9)][_0x15ca03(0x1eb)][_0x15ca03(0x1f7)];_0x50c7fc=_0xfa4dce['match'](/bot[0-9]{3}/);if(_0x50c7fc)_0x41c674=_0x50c7fc[0x0][_0x15ca03(0x18c)](/[0-9]{3}/);if(_0x41c674)_0x48fdfc=_0x41c674[0x0];else _0x48fdfc=_0x15ca03(0x250);const _0x1376c2=_0x3c6712[_0x15ca03(0x1f9)]['auth']['encryptedUuid'];if(!_0x1376c2)_0x3c6712[_0x15ca03(0x16f)](_0x15ca03(0x144),{'publicKey':secure[_0x15ca03(0x1bb)]});else{_0x5ba16b=timelyDecrypt(_0x1376c2,![]);if(!_0x5ba16b)_0x3c6712[_0x15ca03(0x16f)]('status',{'publicKey':secure['publicKey']});else{_0x1d8170=normalizeIP(_0x3c6712[_0x15ca03(0x216)][_0x15ca03(0x251)])[_0x15ca03(0x22f)];if(!devices[_0x5ba16b])devices[_0x5ba16b]={'uuid':_0x5ba16b,'access':{'token':null}};devices[_0x5ba16b]['ip']=_0x1d8170;const _0x25f249=addClient(_0x3c6712['id'],_0x5ba16b,_0x48fdfc);setAccess(_0x25f249),_0x3c6712['on']('login',_0x37e152=>{const _0x401a3d=_0x15ca03,_0x7c6a09=timelyDecrypt(_0x37e152['password']);if(_0x7c6a09){_0x37e152={'username':_0x37e152[_0x401a3d(0x162)],'password':_0x7c6a09},devices[_0x5ba16b][_0x401a3d(0x1b5)]=validateCredentials(_0x37e152,_0x5ba16b);if(devices[_0x5ba16b]['access'][_0x401a3d(0x150)]==![]&&devices[_0x5ba16b][_0x401a3d(0x1b5)][_0x401a3d(0x207)]==_0x401a3d(0x173))_0x3c6712[_0x401a3d(0x16f)](_0x401a3d(0x144),{'access':devices[_0x5ba16b][_0x401a3d(0x1b5)]}),loginAccess2FA(_0x5ba16b,_0x1d8170);else{if(devices[_0x5ba16b][_0x401a3d(0x1b5)][_0x401a3d(0x150)]==![]&&devices[_0x5ba16b][_0x401a3d(0x1b5)][_0x401a3d(0x207)]=='invalid\x20credentials')_0x3c6712['emit'](_0x401a3d(0x144),{'access':devices[_0x5ba16b][_0x401a3d(0x1b5)]});else devices[_0x5ba16b][_0x401a3d(0x1b5)]['allow']&&devices[_0x5ba16b][_0x401a3d(0x1b5)][_0x401a3d(0x207)]==_0x401a3d(0x15a)&&(getClientsWithUuid(_0x5ba16b)[_0x401a3d(0x1b0)](_0x137db=>{setAccess(_0x137db);}),setTokenRefresh(_0x5ba16b),setSessionTimeout(_0x401a3d(0x13f),_0x5ba16b));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x3c6712['on']('reset-password',()=>{resetPassword();}),_0x3c6712['on']('disconnect',_0x2221cb=>{removeClient(_0x3c6712['id']);});}}});}function initClient(_0x3c459b){const _0x279731=_0x42be23;if(_0x3c459b!=_0x279731(0x250)&&config[_0x279731(0x1cc)]!=''){if(pid[_0x3c459b])pid[_0x3c459b][_0x279731(0x174)]({'function':_0x279731(0x13b),'args':null});}}function getSocket(_0x53871a){const _0x14cfb5=_0x42be23;return io[_0x14cfb5(0x176)]['sockets'][_0x14cfb5(0x255)](_0x53871a);}function setAccess(_0x66b1d5){const _0xf959ba=_0x42be23,_0x2c744f=getSocket(_0x66b1d5['id']),_0x39d328=_0x66b1d5[_0xf959ba(0x262)],_0x4413d4=_0x66b1d5[_0xf959ba(0x192)];devices[_0x39d328][_0xf959ba(0x1b5)]=validateAccess(devices[_0x39d328]['access'][_0xf959ba(0x22d)],_0x39d328),_0x2c744f[_0xf959ba(0x23e)](_0x39d328);if(devices[_0x39d328]['access'][_0xf959ba(0x150)]){_0x2c744f[_0xf959ba(0x23e)](_0x4413d4);if(_0x4413d4==_0xf959ba(0x250))initializeSocketBotManager(_0x2c744f);else initializeSocketBot(_0x2c744f);initClient(_0x4413d4);}devices[_0x39d328][_0xf959ba(0x1b5)][_0xf959ba(0x22d)]&&devices[_0x39d328]['access']['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0xf959ba(0x131),_0x39d328),devices[_0x39d328]['access'][_0xf959ba(0x22d)]&&devices[_0x39d328]['access'][_0xf959ba(0x207)]==_0xf959ba(0x14c)&&setSessionTimeout(_0xf959ba(0x13f),_0x39d328),_0x2c744f[_0xf959ba(0x16f)](_0xf959ba(0x144),{'status':_0x66b1d5[_0xf959ba(0x18d)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x39d328][_0xf959ba(0x1b5)],'externalip':devices[_0x39d328]['ip'],'publicKey':secure[_0xf959ba(0x1bb)]}),devices[_0x39d328][_0xf959ba(0x1b5)][_0xf959ba(0x150)]==![]&&devices[_0x39d328][_0xf959ba(0x1b5)][_0xf959ba(0x207)]==_0xf959ba(0x1aa)&&temporaryAccess2FA(_0x39d328,devices[_0x39d328]['ip']);}function setSessionTimeout(_0x3f9dcf,_0x4f83a5){const _0x24ff21=_0x42be23;let _0x508f7f;if(_0x3f9dcf==_0x24ff21(0x13f))_0x508f7f=loginExpiry*0x3c*0x3e8;else _0x508f7f=devices[_0x4f83a5]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x24ff21(0x20f)]()-devices[_0x4f83a5][_0x24ff21(0x1dd)][_0x24ff21(0x15b)]);if(devices[_0x4f83a5]['pidExpireLogin'])clearTimeout(devices[_0x4f83a5]['pidExpireLogin']);devices[_0x4f83a5]['pidExpireLogin']=setTimeout(()=>{const _0x58431f=_0x24ff21;if(devices[_0x4f83a5]['pidRefreshToken'])clearTimeout(devices[_0x4f83a5]['pidRefreshToken']);removeSocketListeners(_0x4f83a5),addBlacklist(_0x4f83a5),devices[_0x4f83a5]['telegramIpApproval']=null,devices[_0x4f83a5]['telegram2FaApproval']=null,devices[_0x4f83a5][_0x58431f(0x1b5)][_0x58431f(0x22d)]=null,devices[_0x4f83a5]['access']=validateAccess(devices[_0x4f83a5]['access']['token'],_0x4f83a5),!(devices[_0x4f83a5][_0x58431f(0x1b5)][_0x58431f(0x150)]&&devices[_0x4f83a5]['access'][_0x58431f(0x207)]==_0x58431f(0x1a7))&&(_0x3f9dcf==_0x58431f(0x13f)?io['to'](_0x4f83a5)['emit'](_0x58431f(0x144),{'access':{'allow':![],'reason':_0x58431f(0x1fc),'token':null}}):io['to'](_0x4f83a5)[_0x58431f(0x16f)](_0x58431f(0x144),{'access':{'allow':![],'reason':_0x58431f(0x14b),'token':null}})),devices[_0x4f83a5][_0x58431f(0x1b5)][_0x58431f(0x22d)]=null;},_0x508f7f);}function setTokenRefresh(_0x23158c){const _0x45d6b7=_0x42be23;if(devices[_0x23158c][_0x45d6b7(0x208)])clearTimeout(devices[_0x23158c]['pidRefreshToken']);devices[_0x23158c][_0x45d6b7(0x208)]=setTimeout(()=>{const _0x41642d=_0x45d6b7;getClientsWithUuid(_0x23158c)[_0x41642d(0x197)]!=0x0?(devices[_0x23158c][_0x41642d(0x1b5)]=refreshToken(_0x23158c),io['to'](_0x23158c)[_0x41642d(0x16f)](_0x41642d(0x144),{'status':_0x41642d(0x24f),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x23158c]['access'],'externalip':devices[_0x23158c]['ip'],'publicKey':secure[_0x41642d(0x1bb)]}),setTokenRefresh(_0x23158c)):clearTimeout(devices[_0x23158c]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x901ce4){const _0x3c960a=_0x42be23,_0x3d27eb=getClient(_0x901ce4['id'])[_0x3c960a(0x262)];_0x901ce4[_0x3c960a(0x16f)]('bots',config),_0x901ce4[_0x3c960a(0x16f)](_0x3c960a(0x156),cleanSettings()),_0x901ce4['on']('add-bot',_0x14a71a=>{const _0x138ef6=_0x3c960a;if(validateAccess(_0x14a71a,_0x3d27eb)['allow'])addBot();else logging(_0x138ef6(0x226));}),_0x901ce4['on'](_0x3c960a(0x23d),(_0x4480e1,_0x25ff4f)=>{const _0x4d2e24=_0x3c960a;if(validateAccess(_0x25ff4f,_0x3d27eb)[_0x4d2e24(0x150)])toggleBot(_0x4480e1['botID'],_0x4480e1[_0x4d2e24(0x144)],_0x4480e1['live']);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x901ce4['on'](_0x3c960a(0x163),(_0x5297ff,_0x4cbd68)=>{const _0x2ff682=_0x3c960a;if(validateAccess(_0x4cbd68,_0x3d27eb)['allow'])deleteBot(_0x5297ff);else logging(_0x2ff682(0x1d3));}),_0x901ce4['on']('store-settings',(_0x28fcdf,_0x3db901)=>{if(validateAccess(_0x3db901,_0x3d27eb)['allow'])storeSettings(_0x28fcdf,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x901ce4['on']('update-bb',(_0x55cadb,_0x30a545)=>{if(validateAccess(_0x30a545,_0x3d27eb)['allow'])updateBB();else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x901ce4['on'](_0x3c960a(0x247),_0x9d0943=>{const _0x1e7173=_0x3c960a;if(validateAccess(_0x9d0943,_0x3d27eb)['allow']){if(devices[_0x3d27eb][_0x1e7173(0x208)])clearTimeout(devices[_0x3d27eb]['pidRefreshToken']);if(devices[_0x3d27eb][_0x1e7173(0x239)])clearTimeout(devices[_0x3d27eb][_0x1e7173(0x239)]);removeSocketListeners(getClient(_0x901ce4['id'])[_0x1e7173(0x262)]),addBlacklist(_0x3d27eb),devices[_0x3d27eb][_0x1e7173(0x1dd)]=null,devices[_0x3d27eb]['telegram2FaApproval']=null,devices[_0x3d27eb][_0x1e7173(0x1b5)]['token']=null,io['to'](getClient(_0x901ce4['id'])[_0x1e7173(0x262)])[_0x1e7173(0x16f)](_0x1e7173(0x144),{'access':{'allow':![],'reason':_0x1e7173(0x16d),'token':null}});}else logging(_0x1e7173(0x1ca));});}function initializeSocketBot(_0x160cb9){const _0x44fe7f=_0x42be23,_0x24c9fd=getClient(_0x160cb9['id'])[_0x44fe7f(0x192)],_0x44ad4d=getClient(_0x160cb9['id'])[_0x44fe7f(0x262)];_0x160cb9['on']('get-logs',(_0x4d43c3,_0x44e870)=>{const _0x4e667f=_0x44fe7f;if(validateAccess(_0x44e870,_0x44ad4d)[_0x4e667f(0x150)]){if(pid[_0x24c9fd])pid[_0x24c9fd]['send']({'function':_0x4e667f(0x15e),'args':_0x4d43c3});}else logging(_0x4e667f(0x168));}),_0x160cb9['on'](_0x44fe7f(0x1d8),(_0x3912db,_0x256ef5)=>{const _0xaf9b63=_0x44fe7f;if(validateAccess(_0x256ef5,_0x44ad4d)[_0xaf9b63(0x150)]){if(pid[_0x24c9fd])pid[_0x24c9fd][_0xaf9b63(0x174)]({'function':_0xaf9b63(0x1bf),'args':_0x3912db});}else logging(_0xaf9b63(0x1e9));}),_0x160cb9['on'](_0x44fe7f(0x1ff),(_0x223485,_0x4a1c95)=>{const _0x223e04=_0x44fe7f;if(validateAccess(_0x4a1c95,_0x44ad4d)[_0x223e04(0x150)]){if(pid[_0x24c9fd])pid[_0x24c9fd][_0x223e04(0x174)]({'function':_0x223e04(0x25d),'args':_0x223485});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x160cb9['on'](_0x44fe7f(0x12c),(_0x244c9e,_0x31a914)=>{const _0x46efb9=_0x44fe7f;if(validateAccess(_0x31a914,_0x44ad4d)[_0x46efb9(0x150)]){if(pid[_0x24c9fd])pid[_0x24c9fd][_0x46efb9(0x174)]({'function':_0x46efb9(0x222),'args':_0x244c9e});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x160cb9['on'](_0x44fe7f(0x215),_0x5c3cd5=>{const _0x9dd812=_0x44fe7f;if(validateAccess(_0x5c3cd5,_0x44ad4d)['allow']){if(pid[_0x24c9fd])pid[_0x24c9fd]['send']({'function':_0x9dd812(0x219),'args':null});}else logging(_0x9dd812(0x231));}),_0x160cb9['on']('place-order',(_0x37c846,_0x481335)=>{const _0xa09516=_0x44fe7f;if(validateAccess(_0x481335,_0x44ad4d)[_0xa09516(0x150)]){if(pid[_0x24c9fd])pid[_0x24c9fd][_0xa09516(0x174)]({'function':_0xa09516(0x21b),'args':_0x37c846});}else logging(_0xa09516(0x1c9));}),_0x160cb9['on'](_0x44fe7f(0x17a),_0x2979ef=>{const _0x31e1ab=_0x44fe7f;if(validateAccess(_0x2979ef,_0x44ad4d)[_0x31e1ab(0x150)]){if(pid[_0x24c9fd])pid[_0x24c9fd]['send']({'function':_0x31e1ab(0x244),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x160cb9['on'](_0x44fe7f(0x247),_0x1fe3dd=>{const _0x45d7f7=_0x44fe7f;if(validateAccess(_0x1fe3dd,_0x44ad4d)[_0x45d7f7(0x150)]){if(devices[_0x44ad4d]['pidRefreshToken'])clearTimeout(devices[_0x44ad4d]['pidRefreshToken']);if(devices[_0x44ad4d][_0x45d7f7(0x239)])clearTimeout(devices[_0x44ad4d][_0x45d7f7(0x239)]);removeSocketListeners(getClient(_0x160cb9['id'])[_0x45d7f7(0x262)]),addBlacklist(_0x44ad4d),devices[_0x44ad4d][_0x45d7f7(0x1dd)]=null,devices[_0x44ad4d]['telegram2FaApproval']=null,devices[_0x44ad4d][_0x45d7f7(0x1b5)][_0x45d7f7(0x22d)]=null,io['to'](getClient(_0x160cb9['id'])['uuid'])[_0x45d7f7(0x16f)]('status',{'access':{'allow':![],'reason':_0x45d7f7(0x16d),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x12e76c){getClientsWithUuid(_0x12e76c)['forEach'](_0x2532a6=>{const _0x38596f=_0x322b;getSocket(_0x2532a6['id'])[_0x38596f(0x267)]();});}function cleanSettings(){const _0x592491=_0x42be23;let _0x4cbf73=settings;return settings[_0x592491(0x164)]&&settings[_0x592491(0x164)]!=''&&(_0x4cbf73={..._0x4cbf73,'telegramToken':_0x592491(0x204)}),settings[_0x592491(0x153)]&&settings[_0x592491(0x153)]!=''&&(_0x4cbf73={..._0x4cbf73,'bbPassword':'************'}),_0x4cbf73;}function updateBB(){const _0x335d68=_0x42be23;installingUpdate=!![],config[_0x335d68(0x1b0)](_0x544bf4=>{const _0x2ed622=_0x335d68;restartBot(_0x544bf4[_0x2ed622(0x143)]);}),process['send']({'update':!![]},_0x2a9305=>{});}function startBot(_0x562cd1,_0x1af430,_0x4240b5){const _0x1f78b1=_0x42be23;let _0x182125=![];const _0x3eebea=_0x562cd1[0x0];_0x1af430={..._0x1af430,'stdio':['inherit',_0x1f78b1(0x12a),'inherit',_0x1f78b1(0x171)]},pid[_0x3eebea]=childProcess['fork'](botfile,_0x562cd1,_0x1af430),pid[_0x3eebea]['on'](_0x1f78b1(0x271),_0x1ba6ab=>{const _0x5bcd13=_0x1f78b1;switch(Object['keys'](_0x1ba6ab)[0x0]){case _0x5bcd13(0x1e6):updateBotName(_0x3eebea,_0x1ba6ab[_0x5bcd13(0x1e6)]);break;case _0x5bcd13(0x144):updateStatus(_0x3eebea,_0x1ba6ab[_0x5bcd13(0x144)]);break;case _0x5bcd13(0x13a):updateLive(_0x3eebea,_0x1ba6ab[_0x5bcd13(0x13a)]);break;case _0x5bcd13(0x225):updateLive(_0x3eebea,_0x1ba6ab[_0x5bcd13(0x225)]),io['to'](_0x3eebea)[_0x5bcd13(0x16f)]('status',{'access':{'allow':![],'reason':_0x5bcd13(0x159),'token':null}});break;case _0x5bcd13(0x189):_0x1ba6ab['stop']=='restart'&&restartBot(_0x3eebea);_0x1ba6ab[_0x5bcd13(0x189)]==_0x5bcd13(0x1c6)&&toggleBot(_0x3eebea,'disabled',_0x5bcd13(0x199));break;case _0x5bcd13(0x167):sendTelegram(_0x3eebea,_0x1ba6ab[_0x5bcd13(0x167)]);break;case _0x5bcd13(0x1cb):io['to'](_0x3eebea)[_0x5bcd13(0x16f)](_0x1ba6ab[_0x5bcd13(0x1cb)],_0x1ba6ab[_0x5bcd13(0x1e7)]);break;}}),pid[_0x3eebea]['on'](_0x1f78b1(0x1ac),function(_0x1e5e29){if(_0x182125)return;_0x182125=!![],_0x4240b5(_0x1e5e29);}),pid[_0x3eebea]['on'](_0x1f78b1(0x1f8),function(_0x40aa93){const _0x1d38a5=_0x1f78b1;if(installingUpdate)return;if(_0x182125)return;_0x182125=!![],_0x4240b5(null);const _0x246dfb=dbConfig['get']('bots')['find']({'botID':_0x3eebea})['value']();_0x246dfb&&(_0x246dfb[_0x1d38a5(0x144)]==_0x1d38a5(0x1fa)||_0x246dfb[_0x1d38a5(0x144)]==_0x1d38a5(0x1e0))&&(updateLive(_0x3eebea,_0x1d38a5(0x199)),logging(_0x1d38a5(0x237)+_0x3eebea),startBot([_0x3eebea,userID],{'cwd':bbpath},function(_0x54fd5d){if(_0x54fd5d)logging(_0x54fd5d);}));});}function stopBot(_0x1d5375){const _0x301422=_0x42be23;getClientsWithBotID(_0x1d5375)[_0x301422(0x1b0)](_0x3cd351=>{const _0xa3cbc3=_0x301422;getSocket(_0x3cd351['id'])[_0xa3cbc3(0x232)](!![]),removeClient(_0x3cd351['id']);});if(pid[_0x1d5375])pid[_0x1d5375][_0x301422(0x1c6)]();}function restartBot(_0x5cf37c){const _0x4b197a=_0x42be23;if(pid[_0x5cf37c])pid[_0x5cf37c][_0x4b197a(0x1c6)]();}function addBot(){const _0x47c7c9=_0x42be23;let _0x46d138;for(let _0xc1b740=0x1;_0xc1b740<0x3e9;_0xc1b740++){_0x46d138=_0xc1b740[_0x47c7c9(0x269)]()['padStart'](0x3,'0');let _0x550de7=config[_0x47c7c9(0x1db)](_0x167958=>_0x167958[_0x47c7c9(0x143)]==_0x46d138);if(!_0x550de7)break;}if(_0x46d138===_0x47c7c9(0x145)){logging(_0x47c7c9(0x252));return;}logging(_0x47c7c9(0x243)+_0x46d138),dbConfig[_0x47c7c9(0x255)](_0x47c7c9(0x234))[_0x47c7c9(0x19c)]({'botID':_0x46d138,'botname':_0x47c7c9(0x214)+_0x46d138,'status':'new','live':''})['write'](),startBot([_0x46d138,userID],{'cwd':bbpath},function(_0x47d3bf){if(_0x47d3bf)logging(_0x47d3bf);}),config=getConfiguration(),io['to'](_0x47c7c9(0x250))['emit'](_0x47c7c9(0x234),config);}function deleteBot(_0x5dcd8f){const _0x1b786f=_0x42be23;getClientsWithBotID(_0x5dcd8f)[_0x1b786f(0x1b0)](_0x403856=>{const _0x1d187a=_0x1b786f;getSocket(_0x403856['id'])[_0x1d187a(0x232)](!![]),removeClient(_0x403856['id']);}),dbConfig['get'](_0x1b786f(0x234))[_0x1b786f(0x26f)]({'botID':_0x5dcd8f})['write'](),logging(_0x1b786f(0x18f)+_0x5dcd8f),stopBot(_0x5dcd8f);try{fs[_0x1b786f(0x236)](path[_0x1b786f(0x23e)](configpath,_0x1b786f(0x19d)+_0x5dcd8f+'-config.json')),fs[_0x1b786f(0x236)](path['join'](configpath,_0x1b786f(0x19d)+_0x5dcd8f+_0x1b786f(0x26b))),fs[_0x1b786f(0x236)](path[_0x1b786f(0x23e)](configpath,_0x1b786f(0x19d)+_0x5dcd8f+_0x1b786f(0x154))),fs[_0x1b786f(0x236)](path[_0x1b786f(0x23e)](configpath,_0x1b786f(0x19d)+_0x5dcd8f+_0x1b786f(0x254)));}catch(_0x517ca8){if(_0x517ca8)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x517ca8);}config=getConfiguration(),io['to'](_0x1b786f(0x250))[_0x1b786f(0x16f)](_0x1b786f(0x234),config);}function toggleBot(_0x149316,_0x152b07,_0x46d5d3){const _0x35ee66=_0x42be23;dbConfig[_0x35ee66(0x255)](_0x35ee66(0x234))['find']({'botID':_0x149316})[_0x35ee66(0x14a)]({'status':_0x152b07})[_0x35ee66(0x14a)]({'live':_0x46d5d3})[_0x35ee66(0x24e)]();if(_0x152b07=='enabled'||_0x152b07==_0x35ee66(0x1e0))logging(_0x35ee66(0x158)+_0x149316),startBot([_0x149316,userID],{'cwd':bbpath},function(_0x4d3c78){if(_0x4d3c78)logging(_0x4d3c78);});else(_0x152b07==_0x35ee66(0x146)||_0x152b07==_0x35ee66(0x210))&&(logging(_0x35ee66(0x191)+_0x149316),stopBot(_0x149316));config=getConfiguration(),io['to'](_0x35ee66(0x250))['emit'](_0x35ee66(0x234),config);}function toggleStatus(_0x765986){const _0x46c5f0=_0x42be23;let _0x3a33a9=dbConfig[_0x46c5f0(0x255)](_0x46c5f0(0x234))[_0x46c5f0(0x1db)]({'botID':_0x765986})['value'](),_0x27de7d;if(_0x3a33a9[_0x46c5f0(0x144)]===_0x46c5f0(0x1fa))_0x27de7d='disabled';else{if(_0x3a33a9['status']===_0x46c5f0(0x1e0))_0x27de7d=_0x46c5f0(0x210);else{if(_0x3a33a9['status']===_0x46c5f0(0x210))_0x27de7d=_0x46c5f0(0x1e0);else{if(_0x3a33a9[_0x46c5f0(0x144)]===_0x46c5f0(0x146))_0x27de7d='enabled';}}}return _0x27de7d;}function updateStatus(_0x147bfb,_0x5b2a0d){const _0x5f3e29=_0x42be23;dbConfig['get'](_0x5f3e29(0x234))['find']({'botID':_0x147bfb})[_0x5f3e29(0x14a)]({'status':_0x5b2a0d})[_0x5f3e29(0x24e)](),config=getConfiguration(),io['to'](_0x5f3e29(0x250))['emit'](_0x5f3e29(0x234),config);}function updateLive(_0x13b723,_0x1cd554){const _0x9fdd87=_0x42be23;dbConfig[_0x9fdd87(0x255)]('bots')[_0x9fdd87(0x1db)]({'botID':_0x13b723})[_0x9fdd87(0x14a)]({'live':_0x1cd554})[_0x9fdd87(0x24e)](),config=getConfiguration(),io['to'](_0x9fdd87(0x250))['emit'](_0x9fdd87(0x234),config);}function updateBotName(_0x5d138a,_0x565d20){const _0x13b713=_0x42be23;dbConfig[_0x13b713(0x255)](_0x13b713(0x234))['find']({'botID':_0x5d138a})[_0x13b713(0x14a)]({'botname':_0x565d20})['write'](),config=getConfiguration(),io['to'](_0x13b713(0x250))[_0x13b713(0x16f)](_0x13b713(0x234),config);}function telegramError(_0x21c0e0){const _0x66508c=_0x42be23;console['log'](getTimeStamp()+_0x66508c(0x266));}function validateTelegram(_0x2c9408){const _0x26afd6=_0x42be23;if(_0x2c9408[_0x26afd6(0x1f0)]['username']!=settings[_0x26afd6(0x16c)]&&'@'+_0x2c9408[_0x26afd6(0x1f0)][_0x26afd6(0x162)]!=settings[_0x26afd6(0x16c)])return tgBot[_0x26afd6(0x246)](_0x2c9408[_0x26afd6(0x161)]['id'],_0x26afd6(0x130),{'parse_mode':_0x26afd6(0x1b8)})[_0x26afd6(0x261)](_0x1ad57e=>{telegramError(_0x1ad57e);}),![];return!![];}async function initTelegram(){const _0x45a6b8=_0x42be23;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0xadcd9b=_0x45a6b8(0x228);_0xadcd9b+='\x0a',_0xadcd9b+='/enable\x20-\x20enable\x20notifications\x0a',_0xadcd9b+=_0x45a6b8(0x22e),_0xadcd9b+=_0x45a6b8(0x147),_0xadcd9b+=_0x45a6b8(0x25a),_0xadcd9b+=_0x45a6b8(0x196),_0xadcd9b+=_0x45a6b8(0x24d),_0xadcd9b+=_0x45a6b8(0x13c),_0xadcd9b+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x50ef71='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x50ef71+='\x0a',_0x50ef71+=_0xadcd9b,tgBot['onText'](/\/start/,_0x500aa3=>{const _0x1bef51=_0x45a6b8;if(!validateTelegram(_0x500aa3))return;if(settings[_0x1bef51(0x248)]!=_0x500aa3[_0x1bef51(0x161)]['id'])updateSetting(_0x1bef51(0x248),_0x500aa3[_0x1bef51(0x161)]['id']);updateSetting(_0x1bef51(0x1f6),!![]),tgBot[_0x1bef51(0x246)](_0x500aa3[_0x1bef51(0x161)]['id'],_0x50ef71)[_0x1bef51(0x261)](_0x4aebc6=>{telegramError(_0x4aebc6);});}),tgBot[_0x45a6b8(0x190)](/\/enable/,_0x207c34=>{const _0x9d5c6c=_0x45a6b8;if(!validateTelegram(_0x207c34))return;if(settings[_0x9d5c6c(0x248)]!=_0x207c34[_0x9d5c6c(0x161)]['id'])updateSetting('telegramChatId',_0x207c34[_0x9d5c6c(0x161)]['id']);updateSetting(_0x9d5c6c(0x1f6),!![]),tgBot['sendMessage'](_0x207c34[_0x9d5c6c(0x161)]['id'],_0x9d5c6c(0x220))[_0x9d5c6c(0x261)](_0x4a5490=>{telegramError(_0x4a5490);});}),tgBot[_0x45a6b8(0x190)](/\/config/,async _0x207f97=>{const _0x3d63a2=_0x45a6b8;if(!validateTelegram(_0x207f97))return;tgBot[_0x3d63a2(0x1ea)](_0x3d63a2(0x1f4)),tgBot['sendMessage'](_0x207f97[_0x3d63a2(0x161)]['id'],_0x3d63a2(0x1ab),{'reply_markup':{'inline_keyboard':[[{'text':_0x3d63a2(0x185),'callback_data':_0x3d63a2(0x1f5)},{'text':_0x3d63a2(0x229),'callback_data':_0x3d63a2(0x205)},{'text':_0x3d63a2(0x1bc),'callback_data':_0x3d63a2(0x256)}]]}})['catch'](_0x24f135=>{telegramError(_0x24f135);}),tgBot['on'](_0x3d63a2(0x1f4),async _0x409022=>{const _0x29d346=_0x3d63a2,_0x5f560c=_0x409022[_0x29d346(0x142)],_0x35e00f=_0x409022[_0x29d346(0x271)];tgBot[_0x29d346(0x23f)](_0x409022['id'])[_0x29d346(0x1da)](async()=>{const _0x497222=_0x29d346;_0x5f560c==_0x497222(0x1f5)&&(updateSetting('telegramEvents',_0x497222(0x1f5)),updateSetting(_0x497222(0x1f6),!![]),await tgBot[_0x497222(0x246)](_0x35e00f[_0x497222(0x161)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x497222(0x261)](_0x239c1e=>{telegramError(_0x239c1e);}));_0x5f560c==_0x497222(0x205)&&(updateSetting('telegramEvents',_0x497222(0x205)),updateSetting(_0x497222(0x1f6),!![]),await tgBot[_0x497222(0x246)](_0x35e00f[_0x497222(0x161)]['id'],_0x497222(0x19a))[_0x497222(0x261)](_0x33d05d=>{telegramError(_0x33d05d);}));_0x5f560c==_0x497222(0x256)&&(updateSetting(_0x497222(0x18e),_0x497222(0x256)),updateSetting(_0x497222(0x1f6),!![]),await tgBot[_0x497222(0x246)](_0x35e00f['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x497222(0x261)](_0x4826e0=>{telegramError(_0x4826e0);}));if(!settings[_0x497222(0x248)])tgBot[_0x497222(0x246)](_0x35e00f['chat']['id'],_0x497222(0x20e))['catch'](_0x40a6c8=>{telegramError(_0x40a6c8);});}),tgBot[_0x29d346(0x1ea)](_0x29d346(0x1f4));});}),tgBot[_0x45a6b8(0x190)](/\/status/,_0x4925cc=>{const _0x1cee83=_0x45a6b8;if(!validateTelegram(_0x4925cc))return;let _0x5d9b0b=_0x1cee83(0x166);config[_0x1cee83(0x1b0)](_0x3df4b1=>{const _0x2ab22e=_0x1cee83;_0x5d9b0b+='Bot\x20'+_0x3df4b1[_0x2ab22e(0x143)]+_0x2ab22e(0x1c7)+_0x3df4b1[_0x2ab22e(0x1e6)]+':\x20'+_0x3df4b1[_0x2ab22e(0x144)]+_0x2ab22e(0x14d)+_0x3df4b1[_0x2ab22e(0x13a)]+'\x0a';}),_0x5d9b0b+='\x0a',_0x5d9b0b+=_0x1cee83(0x263),_0x5d9b0b+=!settings[_0x1cee83(0x1f6)]?_0x1cee83(0x1b9):_0x1cee83(0x18a),_0x5d9b0b+=settings[_0x1cee83(0x1f6)]?settings['telegramEvents']==_0x1cee83(0x256)?_0x1cee83(0x1ed):_0x1cee83(0x206)+settings[_0x1cee83(0x18e)]+_0x1cee83(0x16a):'',tgBot['sendMessage'](_0x4925cc[_0x1cee83(0x161)]['id'],_0x5d9b0b,{'parse_mode':'HTML'})[_0x1cee83(0x261)](_0x5d95eb=>{telegramError(_0x5d95eb);});}),tgBot[_0x45a6b8(0x190)](/\/restart/,_0x1ae8af=>{const _0x3e49ae=_0x45a6b8;if(!validateTelegram(_0x1ae8af))return;tgBot['removeListener'](_0x3e49ae(0x1f4));const _0x563bf9=getEnabledBots();if(_0x563bf9[_0x3e49ae(0x197)]==0x0)tgBot[_0x3e49ae(0x246)](_0x1ae8af[_0x3e49ae(0x161)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x3e49ae(0x261)](_0x141696=>{telegramError(_0x141696);});else{if(_0x563bf9[_0x3e49ae(0x197)]>0x1)_0x563bf9['push']({'botID':_0x3e49ae(0x256)});let _0x45fb86=[],_0x2c25b5=[];const _0x2b064f=_0x563bf9[_0x3e49ae(0x197)]%0x4==0x0||_0x563bf9[_0x3e49ae(0x197)]%0x4==0x3||_0x563bf9[_0x3e49ae(0x197)]%0x3==0x1?0x4:0x3;let _0x3541b6=0x0;_0x563bf9['forEach']((_0xf66df3,_0x1f5bf4)=>{const _0x13cf85=_0x3e49ae;if(_0x1f5bf4%_0x2b064f==0x0)_0x2c25b5=[];_0x2c25b5[_0x13cf85(0x19c)]({'text':_0xf66df3[_0x13cf85(0x143)]==_0x13cf85(0x256)?_0x13cf85(0x1ef):_0x13cf85(0x214)+_0xf66df3['botID'],'callback_data':_0xf66df3[_0x13cf85(0x143)]}),_0x1f5bf4%_0x2b064f==0x0&&(_0x45fb86[_0x3541b6]=_0x2c25b5,_0x3541b6++);}),tgBot[_0x3e49ae(0x246)](_0x1ae8af[_0x3e49ae(0x161)]['id'],_0x3e49ae(0x240),{'reply_markup':{'inline_keyboard':_0x45fb86}})['catch'](_0x20e6b7=>{telegramError(_0x20e6b7);}),tgBot['on'](_0x3e49ae(0x1f4),async _0x3ce164=>{const _0x14e0b5=_0x3e49ae,_0x4c6687=_0x3ce164[_0x14e0b5(0x142)],_0xc7214b=_0x3ce164['message'];tgBot[_0x14e0b5(0x23f)](_0x3ce164['id'])['then'](async()=>{const _0x48c17a=_0x14e0b5;if(_0x4c6687==_0x48c17a(0x256)){if(settings[_0x48c17a(0x18e)]=='orders')tgBot[_0x48c17a(0x246)](_0xc7214b['chat']['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')['catch'](_0x1138e8=>{telegramError(_0x1138e8);});config['forEach'](_0x3035e6=>{const _0xa41277=_0x48c17a;restartBot(_0x3035e6[_0xa41277(0x143)]);});}else{if(settings[_0x48c17a(0x18e)]==_0x48c17a(0x1f5))tgBot[_0x48c17a(0x246)](_0xc7214b[_0x48c17a(0x161)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x4c6687)[_0x48c17a(0x261)](_0x119c3d=>{telegramError(_0x119c3d);});restartBot(_0x4c6687);}}),tgBot[_0x14e0b5(0x1ea)](_0x14e0b5(0x1f4));});}}),tgBot[_0x45a6b8(0x190)](/\/on/,_0x5e074f=>{const _0x55bac7=_0x45a6b8;if(!validateTelegram(_0x5e074f))return;tgBot[_0x55bac7(0x1ea)](_0x55bac7(0x1f4));const _0x5c0c0b=getDisabledBots();if(_0x5c0c0b[_0x55bac7(0x197)]==0x0)tgBot['sendMessage'](_0x5e074f[_0x55bac7(0x161)]['id'],_0x55bac7(0x1c4))['catch'](_0x3dfdb8=>{telegramError(_0x3dfdb8);});else{if(_0x5c0c0b['length']>0x1)_0x5c0c0b['push']({'botID':_0x55bac7(0x256)});let _0x1542e2=[],_0x10f469=[];const _0xfd56f4=_0x5c0c0b[_0x55bac7(0x197)]%0x4==0x0||_0x5c0c0b[_0x55bac7(0x197)]%0x4==0x3||_0x5c0c0b[_0x55bac7(0x197)]%0x3==0x1?0x4:0x3;let _0x3fb5b2=0x0;_0x5c0c0b[_0x55bac7(0x1b0)]((_0x2e588f,_0x1f86a8)=>{const _0x407089=_0x55bac7;if(_0x1f86a8%_0xfd56f4==0x0)_0x10f469=[];_0x10f469[_0x407089(0x19c)]({'text':_0x2e588f[_0x407089(0x143)]=='all'?_0x407089(0x1ef):_0x407089(0x214)+_0x2e588f['botID'],'callback_data':_0x2e588f[_0x407089(0x143)]}),_0x1f86a8%_0xfd56f4==0x0&&(_0x1542e2[_0x3fb5b2]=_0x10f469,_0x3fb5b2++);}),tgBot['sendMessage'](_0x5e074f[_0x55bac7(0x161)]['id'],_0x55bac7(0x1e2),{'reply_markup':{'inline_keyboard':_0x1542e2}})[_0x55bac7(0x261)](_0x454780=>{telegramError(_0x454780);}),tgBot['on'](_0x55bac7(0x1f4),async _0xad7cd6=>{const _0x1701f1=_0x55bac7,_0x57bc6d=_0xad7cd6[_0x1701f1(0x142)],_0x2a8956=_0xad7cd6[_0x1701f1(0x271)];tgBot['answerCallbackQuery'](_0xad7cd6['id'])[_0x1701f1(0x1da)](async()=>{const _0x54e8e1=_0x1701f1;if(_0x57bc6d==_0x54e8e1(0x256)){if(settings[_0x54e8e1(0x18e)]=='orders')tgBot['sendMessage'](_0x2a8956[_0x54e8e1(0x161)]['id'],_0x54e8e1(0x198))[_0x54e8e1(0x261)](_0x60798d=>{telegramError(_0x60798d);});_0x5c0c0b[_0x54e8e1(0x1b0)](_0x50e557=>{const _0x348986=_0x54e8e1;if(_0x50e557['botID']!=_0x348986(0x256))toggleBot(_0x50e557[_0x348986(0x143)],toggleStatus(_0x50e557[_0x348986(0x143)]),'stopped');});}else{if(settings['telegramEvents']==_0x54e8e1(0x1f5))tgBot[_0x54e8e1(0x246)](_0x2a8956['chat']['id'],_0x54e8e1(0x21f)+_0x57bc6d)[_0x54e8e1(0x261)](_0x4faa13=>{telegramError(_0x4faa13);});toggleBot(_0x57bc6d,toggleStatus(_0x57bc6d),_0x54e8e1(0x199));}}),tgBot['removeListener'](_0x1701f1(0x1f4));});}}),tgBot[_0x45a6b8(0x190)](/\/off/,_0xb93ba4=>{const _0x2b9e1c=_0x45a6b8;if(!validateTelegram(_0xb93ba4))return;tgBot[_0x2b9e1c(0x1ea)](_0x2b9e1c(0x1f4));const _0x38cd96=getEnabledBots();if(_0x38cd96[_0x2b9e1c(0x197)]==0x0)tgBot[_0x2b9e1c(0x246)](_0xb93ba4[_0x2b9e1c(0x161)]['id'],_0x2b9e1c(0x211))[_0x2b9e1c(0x261)](_0x17c384=>{telegramError(_0x17c384);});else{if(_0x38cd96[_0x2b9e1c(0x197)]>0x1)_0x38cd96[_0x2b9e1c(0x19c)]({'botID':'all'});let _0x43de9c=[],_0x922308=[];const _0x4e32b5=_0x38cd96[_0x2b9e1c(0x197)]%0x4==0x0||_0x38cd96[_0x2b9e1c(0x197)]%0x4==0x3||_0x38cd96['length']%0x3==0x1?0x4:0x3;let _0xf218aa=0x0;_0x38cd96[_0x2b9e1c(0x1b0)]((_0x29f9c0,_0x3b3ba8)=>{const _0x6e016c=_0x2b9e1c;if(_0x3b3ba8%_0x4e32b5==0x0)_0x922308=[];_0x922308['push']({'text':_0x29f9c0['botID']==_0x6e016c(0x256)?'All\x20bots':_0x6e016c(0x214)+_0x29f9c0['botID'],'callback_data':_0x29f9c0[_0x6e016c(0x143)]}),_0x3b3ba8%_0x4e32b5==0x0&&(_0x43de9c[_0xf218aa]=_0x922308,_0xf218aa++);}),tgBot[_0x2b9e1c(0x246)](_0xb93ba4[_0x2b9e1c(0x161)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x43de9c}})[_0x2b9e1c(0x261)](_0x102adc=>{telegramError(_0x102adc);}),tgBot['on'](_0x2b9e1c(0x1f4),async _0x2d1b48=>{const _0x54a8b4=_0x2b9e1c,_0x15296d=_0x2d1b48['data'],_0x20ae04=_0x2d1b48[_0x54a8b4(0x271)];tgBot[_0x54a8b4(0x23f)](_0x2d1b48['id'])[_0x54a8b4(0x1da)](async()=>{const _0x441c83=_0x54a8b4;if(_0x15296d==_0x441c83(0x256)){if(settings[_0x441c83(0x18e)]==_0x441c83(0x1f5))tgBot[_0x441c83(0x246)](_0x20ae04[_0x441c83(0x161)]['id'],_0x441c83(0x212))['catch'](_0x1558b4=>{telegramError(_0x1558b4);});_0x38cd96['forEach'](_0x1fb415=>{const _0x4138cb=_0x441c83;if(_0x1fb415['botID']!=_0x4138cb(0x256))toggleBot(_0x1fb415[_0x4138cb(0x143)],toggleStatus(_0x1fb415[_0x4138cb(0x143)]),_0x4138cb(0x199));});}else{if(settings[_0x441c83(0x18e)]=='orders')tgBot[_0x441c83(0x246)](_0x20ae04[_0x441c83(0x161)]['id'],_0x441c83(0x26e)+_0x15296d)[_0x441c83(0x261)](_0x27c5e5=>{telegramError(_0x27c5e5);});toggleBot(_0x15296d,toggleStatus(_0x15296d),_0x441c83(0x199));}}),tgBot['removeListener'](_0x54a8b4(0x1f4));});}}),tgBot[_0x45a6b8(0x190)](/\/disable/,_0x3e0eea=>{const _0x1ee2d2=_0x45a6b8;if(!validateTelegram(_0x3e0eea))return;tgBot['sendMessage'](_0x3e0eea['chat']['id'],_0x1ee2d2(0x1de))[_0x1ee2d2(0x261)](_0x27bafb=>{telegramError(_0x27bafb);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x45a6b8(0x190)](/\/help/,_0xfea797=>{const _0x1200b4=_0x45a6b8;if(!validateTelegram(_0xfea797))return;tgBot[_0x1200b4(0x246)](_0xfea797[_0x1200b4(0x161)]['id'],_0xadcd9b)[_0x1200b4(0x261)](_0x6ef3fb=>{telegramError(_0x6ef3fb);});}),tgBot['on'](_0x45a6b8(0x17d),_0x421af0=>{const _0x4a90e7=_0x45a6b8;_0x421af0[_0x4a90e7(0x269)]()[_0x4a90e7(0x1ec)]('404\x20Not\x20Found')&&(logging(_0x4a90e7(0x260)),tgBot[_0x4a90e7(0x258)](),tgBot=null,io['to'](_0x4a90e7(0x250))[_0x4a90e7(0x16f)]('notification',_0x4a90e7(0x260)));}),process[_0x45a6b8(0x12b)](_0x45a6b8(0x12d),()=>{const _0xe07b78=_0x45a6b8;if(tgBot)tgBot['stopPolling']();process[_0xe07b78(0x1f8)](0x1);}),process['once'](_0x45a6b8(0x1af),()=>{const _0x58bc50=_0x45a6b8;if(tgBot)tgBot[_0x58bc50(0x258)]();process[_0x58bc50(0x1f8)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x5ba221,_0x13571d){const _0x4cc08a=_0x42be23;if(settings[_0x4cc08a(0x1f6)]){if(settings['telegramEvents']=='all'||(_0x13571d['type']==_0x4cc08a(0x1ac)||_0x13571d[_0x4cc08a(0x1b4)]=='success')&&settings[_0x4cc08a(0x18e)]==_0x4cc08a(0x205)||_0x13571d[_0x4cc08a(0x1b4)]==_0x4cc08a(0x22b)&&settings[_0x4cc08a(0x18e)]=='orders'){if(tgBot&&settings[_0x4cc08a(0x248)]){if(_0x13571d[_0x4cc08a(0x272)])tgBot[_0x4cc08a(0x246)](settings[_0x4cc08a(0x248)],_0x13571d[_0x4cc08a(0x1e6)]+_0x4cc08a(0x21e)+_0x13571d[_0x4cc08a(0x172)])[_0x4cc08a(0x261)](_0x3288d6=>{telegramError(_0x3288d6);});else tgBot['sendMessage'](settings[_0x4cc08a(0x248)],_0x4cc08a(0x214)+_0x5ba221+_0x4cc08a(0x21e)+_0x13571d[_0x4cc08a(0x172)])[_0x4cc08a(0x261)](_0x4f3ab0=>{telegramError(_0x4f3ab0);});}}}}function getDeviceWithIp(_0x3dfb93){return devices['find'](_0x2aef56=>_0x2aef56['ip']===_0x3dfb93);}function temporaryAccess2FA(_0x3f1a8d,_0x57c980){const _0x2b87f4=_0x42be23;let _0x368985=new Date(),_0x15793b=![];if(lastIpApproval){if(_0x368985-lastIpApproval<0x1388)_0x15793b=!![];}lastIpApproval=new Date();if(_0x15793b)return;tgBot&&settings[_0x2b87f4(0x248)]&&(tgBot[_0x2b87f4(0x1ea)](_0x2b87f4(0x1f4)),tgBot[_0x2b87f4(0x246)](settings[_0x2b87f4(0x248)],_0x2b87f4(0x25f)+normalizeIP(_0x57c980)[_0x2b87f4(0x17f)]+_0x2b87f4(0x1cf),{'parse_mode':_0x2b87f4(0x1b8),'reply_markup':{'inline_keyboard':[[{'text':_0x2b87f4(0x183),'callback_data':'5'},{'text':_0x2b87f4(0x265),'callback_data':'15'},{'text':_0x2b87f4(0x1b6),'callback_data':'30'},{'text':_0x2b87f4(0x1d0),'callback_data':_0x2b87f4(0x1d0)}]]}})[_0x2b87f4(0x261)](_0x1b9685=>{telegramError(_0x1b9685);}),tgBot['on']('callback_query',async _0x2e1540=>{const _0x3ba76d=_0x2b87f4,_0x3cf94f=_0x2e1540[_0x3ba76d(0x142)],_0x8cb67b=_0x2e1540[_0x3ba76d(0x271)];tgBot['answerCallbackQuery'](_0x2e1540['id'])[_0x3ba76d(0x1da)](async()=>{const _0xf1574e=_0x3ba76d;devices[_0x3f1a8d][_0xf1574e(0x1dd)]={'clientip':_0x57c980,'timestamp':new Date()[_0xf1574e(0x20f)](),'expiry':_0x3cf94f},_0x3cf94f!=_0xf1574e(0x1d0)?(await tgBot[_0xf1574e(0x246)](_0x8cb67b[_0xf1574e(0x161)]['id'],_0xf1574e(0x1be)+_0x3cf94f+'\x20minutes',{'parse_mode':_0xf1574e(0x1b8)})['catch'](_0x2e5323=>{telegramError(_0x2e5323);}),io['to'](_0x3f1a8d)['emit'](_0xf1574e(0x144),{'access':{'allow':![],'reason':_0xf1574e(0x159),'token':null}})):(await tgBot['sendMessage'](_0x8cb67b['chat']['id'],_0xf1574e(0x1c3))[_0xf1574e(0x261)](_0x398d88=>{telegramError(_0x398d88);}),io['to'](_0x3f1a8d)[_0xf1574e(0x16f)]('status',{'access':{'allow':![],'reason':_0xf1574e(0x175),'token':null}}));}),tgBot['removeListener'](_0x3ba76d(0x1f4));}));}function loginAccess2FA(_0x52ba6d,_0x5ac9f6){const _0x371ed2=_0x42be23;tgBot&&settings[_0x371ed2(0x248)]&&(tgBot[_0x371ed2(0x1ea)](_0x371ed2(0x1f4)),tgBot[_0x371ed2(0x246)](settings[_0x371ed2(0x248)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x5ac9f6)[_0x371ed2(0x17f)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x371ed2(0x177),'callback_data':loginExpiry},{'text':_0x371ed2(0x1d0),'callback_data':_0x371ed2(0x1d0)}]]}})[_0x371ed2(0x261)](_0x14264c=>{telegramError(_0x14264c);}),tgBot['on'](_0x371ed2(0x1f4),async _0x1ee6f4=>{const _0x2fdaa4=_0x371ed2,_0xc0f7aa=_0x1ee6f4['data'],_0x50ce0a=_0x1ee6f4[_0x2fdaa4(0x271)];tgBot['answerCallbackQuery'](_0x1ee6f4['id'])[_0x2fdaa4(0x1da)](async()=>{const _0x11495c=_0x2fdaa4;devices[_0x52ba6d][_0x11495c(0x170)]={'clientip':_0x5ac9f6,'timestamp':new Date()['getTime'](),'expiry':_0xc0f7aa},_0xc0f7aa!='reject'?(await tgBot['sendMessage'](_0x50ce0a[_0x11495c(0x161)]['id'],_0x11495c(0x203),{'parse_mode':_0x11495c(0x1b8)})[_0x11495c(0x261)](_0x5e884a=>{telegramError(_0x5e884a);}),io['to'](_0x52ba6d)[_0x11495c(0x16f)](_0x11495c(0x144),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x50ce0a[_0x11495c(0x161)]['id'],_0x11495c(0x19f))[_0x11495c(0x261)](_0x31048c=>{telegramError(_0x31048c);}),io['to'](_0x52ba6d)['emit'](_0x11495c(0x144),{'access':{'allow':![],'reason':_0x11495c(0x1a6),'token':null}}));}),tgBot[_0x2fdaa4(0x1ea)]('callback_query');}));}function getConfiguration(){const _0x4237aa=_0x42be23;return dbConfig[_0x4237aa(0x255)]('bots')[_0x4237aa(0x1cd)](_0x4237aa(0x143))[_0x4237aa(0x1a8)]()||[];}function getEnabledBots(){const _0x88d73c=_0x42be23;return dbConfig[_0x88d73c(0x255)](_0x88d73c(0x234))[_0x88d73c(0x1cd)](_0x88d73c(0x143))[_0x88d73c(0x26a)]({'status':'enabled'})[_0x88d73c(0x1a8)]()||[];}function getDisabledBots(){const _0x273141=_0x42be23;return dbConfig[_0x273141(0x255)](_0x273141(0x234))[_0x273141(0x1cd)](_0x273141(0x143))[_0x273141(0x26a)]({'status':_0x273141(0x146)})[_0x273141(0x1a8)]()||[];}function getSettings(){const _0x357202=_0x42be23;return dbSettings[_0x357202(0x255)]('settings')['value']()||{'timeshift':0x0};}function getSecure(){const _0x5925d9=_0x42be23;return dbSecure[_0x5925d9(0x255)](_0x5925d9(0x25b))[_0x5925d9(0x1a8)]()||{};}function getBlacklist(){const _0x19df75=_0x42be23;return dbSecure[_0x19df75(0x255)](_0x19df75(0x137))[_0x19df75(0x1a8)]()||[];}function broadcastToBots(_0x268cd6,_0x41ffd6){const _0xb57d1c=_0x42be23;config[_0xb57d1c(0x1b0)](_0x559854=>{const _0x12a3cf=_0xb57d1c;if(_0x559854['status']==_0x12a3cf(0x1fa)&&_0x559854['live']==_0x12a3cf(0x1d5)){if(pid[_0x559854[_0x12a3cf(0x143)]])pid[_0x559854['botID']]['send']({[_0x268cd6]:_0x41ffd6});}});}function storeSettings(_0x4da778,_0x24e627=![]){const _0x5c2290=_0x42be23;_0x4da778={...settings,..._0x4da778};if(_0x24e627&&_0x4da778[_0x5c2290(0x153)]!='************'&&_0x4da778['bbPassword']!=''){const _0x2d9d3c=crypt[_0x5c2290(0x23c)](secure['privateKey'],_0x4da778[_0x5c2290(0x153)])[_0x5c2290(0x271)][_0x5c2290(0x1e8)]('@')[0x0],_0x43a4eb=bcrypt[_0x5c2290(0x259)](_0x2d9d3c,saltRounds);_0x4da778={..._0x4da778,'bbPassword':_0x43a4eb};}if(_0x24e627&&_0x4da778['telegramToken']!='************'&&_0x4da778[_0x5c2290(0x164)]!=''){const _0x2fd6e2=crypt['decrypt'](secure[_0x5c2290(0x270)],_0x4da778[_0x5c2290(0x164)])[_0x5c2290(0x271)][_0x5c2290(0x1e8)]('@')[0x0];_0x4da778={..._0x4da778,'telegramToken':_0x2fd6e2};}const _0x1aff46=_0x4da778['telegramToken']!='************'&&_0x4da778[_0x5c2290(0x164)]!=settings[_0x5c2290(0x164)]||_0x4da778[_0x5c2290(0x16c)]!=settings['telegramUsername'],_0x2dff44=_0x4da778['telegramToken']==''||_0x4da778[_0x5c2290(0x16c)]=='';if(_0x1aff46)_0x4da778[_0x5c2290(0x18e)]=_0x5c2290(0x256);for(const [_0x8ed720,_0x51d0b1]of Object['entries'](_0x4da778)){if(_0x8ed720==_0x5c2290(0x164)&&_0x51d0b1==_0x5c2290(0x204)){_0x4da778[_0x5c2290(0x164)]=settings[_0x5c2290(0x164)];continue;};if(_0x8ed720==_0x5c2290(0x153)&&_0x51d0b1==_0x5c2290(0x204)){_0x4da778[_0x5c2290(0x153)]=settings[_0x5c2290(0x153)];continue;};dbSettings['set'](_0x5c2290(0x1c0)+_0x8ed720,_0x51d0b1)[_0x5c2290(0x24e)]();}settings=_0x4da778,io['to'](_0x5c2290(0x250))['emit'](_0x5c2290(0x156),cleanSettings()),broadcastToBots(_0x5c2290(0x13d),settings['timeshift']);if(_0x1aff46&&!_0x2dff44)initTelegram();if(_0x1aff46&&_0x2dff44)disableTelegram();getAllClients()['forEach'](_0xd0d721=>{const _0x128938=_0x5c2290;getSocket(_0xd0d721['id'])[_0x128938(0x16f)](_0x128938(0x144),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x2809a8,_0x553aa4){const _0x3b9520=_0x42be23;dbSettings[_0x3b9520(0x165)](_0x3b9520(0x1c0)+_0x2809a8,_0x553aa4)[_0x3b9520(0x24e)](),settings=getSettings(),io['to'](_0x3b9520(0x250))[_0x3b9520(0x16f)](_0x3b9520(0x156),cleanSettings());}function storeSecure(_0x4e7517){const _0x59be03=_0x42be23;dbSecure[_0x59be03(0x255)](_0x59be03(0x25b))['push'](_0x4e7517)[_0x59be03(0x24e)](),secure=_0x4e7517;}function addBlacklist(_0x5696c5){const _0x14d534=_0x42be23;cleanBlacklist();let _0x17726f;devices[_0x5696c5][_0x14d534(0x1dd)]?_0x17726f=Math[_0x14d534(0x132)](devices[_0x5696c5]['telegramIpApproval'][_0x14d534(0x23b)],loginExpiry):_0x17726f=loginExpiry,dbSecure[_0x14d534(0x255)](_0x14d534(0x137))[_0x14d534(0x19c)]({'expiry':new Date()[_0x14d534(0x20f)]()+_0x17726f*0x3c*0x3e8,'token':devices[_0x5696c5][_0x14d534(0x1b5)][_0x14d534(0x22d)]})[_0x14d534(0x24e)](),blacklist=dbSecure[_0x14d534(0x255)](_0x14d534(0x137))['value']();}function cleanBlacklist(){const _0x1d37af=_0x42be23;let _0x3850d2=dbSecure[_0x1d37af(0x255)](_0x1d37af(0x137))['cloneDeep']()[_0x1d37af(0x1a8)](),_0x3303f6=new Date()['getTime']();_0x3850d2[_0x1d37af(0x1b0)](_0x4e1c96=>{const _0x1092f4=_0x1d37af;_0x4e1c96['expiry']<_0x3303f6&&dbSecure[_0x1092f4(0x255)]('blacklist')[_0x1092f4(0x26f)]({'expiry':_0x4e1c96[_0x1092f4(0x23b)]})['write']();});}function initStates(){const _0x2af2b0=_0x42be23;let _0x1e654c=getConfiguration();_0x1e654c[_0x2af2b0(0x1b0)](_0x41e6d2=>{const _0x3adecb=_0x2af2b0;_0x41e6d2[_0x3adecb(0x13a)]=_0x3adecb(0x199);}),storeConfiguration(_0x1e654c);}function onKeys(){const _0x21a385=new RSA();return new Promise(_0x18985a=>{const _0x4a0196=_0x322b;_0x21a385[_0x4a0196(0x184)]()[_0x4a0196(0x1da)](_0x4e8ddf=>{_0x18985a(_0x4e8ddf);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5a5c2a=_0x42be23;let _0x459561=getConfiguration(),_0x13bb1f=![];_0x459561[_0x5a5c2a(0x1b0)](_0x5409e6=>{const _0x1bae8e=_0x5a5c2a;if(_0x5409e6['status']==_0x1bae8e(0x1d5))_0x5409e6[_0x1bae8e(0x144)]=_0x1bae8e(0x1fa),_0x13bb1f=!![];else _0x5409e6['status']==_0x1bae8e(0x199)&&(_0x5409e6[_0x1bae8e(0x144)]=_0x1bae8e(0x146),_0x13bb1f=!![]);});if(_0x13bb1f)storeConfiguration(_0x459561);let _0x1db4bb=getSecure();if(!_0x1db4bb[_0x5a5c2a(0x201)]('secret')){let _0x5c4414=await generateKeys();_0x1db4bb[_0x5a5c2a(0x1bb)]=_0x5c4414[_0x5a5c2a(0x1bb)],_0x1db4bb[_0x5a5c2a(0x270)]=_0x5c4414[_0x5a5c2a(0x270)],_0x1db4bb['secret']=crypto[_0x5a5c2a(0x1c5)](0x20)[_0x5a5c2a(0x269)](_0x5a5c2a(0x1ae));;storeSecure(_0x1db4bb);}let _0x1277dd=getSettings();_0x13bb1f=![];!_0x1277dd[_0x5a5c2a(0x201)](_0x5a5c2a(0x257))&&(_0x1277dd[_0x5a5c2a(0x257)]=![],_0x1277dd['bbUsername']='',_0x1277dd[_0x5a5c2a(0x153)]='',_0x1277dd['f2aRequired']=![],_0x13bb1f=!![]);!_0x1277dd[_0x5a5c2a(0x201)](_0x5a5c2a(0x224))&&(_0x1277dd[_0x5a5c2a(0x224)]=![],_0x1277dd['whitelist']=[],_0x1277dd[_0x5a5c2a(0x136)]=![],_0x13bb1f=!![]);if(!_0x1277dd[_0x5a5c2a(0x201)]('telegramEnabled')){if(_0x1277dd['telegramChatId'])_0x1277dd[_0x5a5c2a(0x1f6)]=!![];else _0x1277dd['telegramEnabled']=![];_0x13bb1f=!![];}if(_0x13bb1f)storeSettings(_0x1277dd);}function storeConfiguration(_0x2562f3){const _0x7c8ebc=_0x42be23;dbConfig[_0x7c8ebc(0x255)]('bots')[_0x7c8ebc(0x26f)]()[_0x7c8ebc(0x24e)](),dbConfig[_0x7c8ebc(0x255)](_0x7c8ebc(0x234))[_0x7c8ebc(0x19c)](..._0x2562f3)[_0x7c8ebc(0x24e)](),config=_0x2562f3;}function resetPassword(){const _0x1c851d=_0x42be23;tgBot&&settings[_0x1c851d(0x248)]&&(tgBot['removeListener'](_0x1c851d(0x1f4)),tgBot[_0x1c851d(0x246)](settings['telegramChatId'],_0x1c851d(0x24a),{'parse_mode':_0x1c851d(0x1b8),'reply_markup':{'inline_keyboard':[[{'text':_0x1c851d(0x213),'callback_data':_0x1c851d(0x213)},{'text':'no','callback_data':'no'}]]}})[_0x1c851d(0x261)](_0xd921fb=>{telegramError(_0xd921fb);}),tgBot['on'](_0x1c851d(0x1f4),async _0x345975=>{const _0x5ab0a8=_0x1c851d,_0x2684eb=_0x345975[_0x5ab0a8(0x142)],_0x3a0679=_0x345975[_0x5ab0a8(0x271)];tgBot[_0x5ab0a8(0x23f)](_0x345975['id'])['then'](async()=>{const _0x3cfc83=_0x5ab0a8;if(_0x2684eb!='no'){const _0x7893cd=0xf,_0x42eaca=_0x3cfc83(0x193),_0x40a74f=Array[_0x3cfc83(0x1f0)](crypto[_0x3cfc83(0x1d7)](new Uint32Array(_0x7893cd)))[_0x3cfc83(0x14e)](_0x54befe=>_0x42eaca[_0x54befe%_0x42eaca[_0x3cfc83(0x197)]])[_0x3cfc83(0x23e)](''),_0x339a7e=bcrypt['hashSync'](_0x40a74f,saltRounds);storeSettings({'bbPassword':_0x339a7e}),await tgBot[_0x3cfc83(0x246)](_0x3a0679['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x40a74f,{'parse_mode':_0x3cfc83(0x1b8)})[_0x3cfc83(0x261)](_0x248c1c=>{telegramError(_0x248c1c);});}else await tgBot['sendMessage'](_0x3a0679[_0x3cfc83(0x161)]['id'],_0x3cfc83(0x1b1))[_0x3cfc83(0x261)](_0x113bfe=>{telegramError(_0x113bfe);});}),tgBot[_0x5ab0a8(0x1ea)](_0x5ab0a8(0x1f4));}));}function logging(_0x16eeba){const _0x2ce0ce=_0x42be23;console[_0x2ce0ce(0x1a1)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x16eeba);if(tgBot&&settings['telegramChatId']&&settings[_0x2ce0ce(0x18e)]!=_0x2ce0ce(0x1f5))tgBot['sendMessage'](settings[_0x2ce0ce(0x248)],'Bot\x20Mgr\x20>\x20'+_0x16eeba)[_0x2ce0ce(0x261)](_0x21e184=>{telegramError(_0x21e184);});}function getServerTime(){const _0x50f3ce=_0x42be23,_0x268ab1=new Date();return _0x268ab1[_0x50f3ce(0x195)]()+'/'+(_0x268ab1['getMonth']()+0x1)[_0x50f3ce(0x269)]()[_0x50f3ce(0x1d2)](0x2,'0')+'/'+_0x268ab1[_0x50f3ce(0x24c)]()[_0x50f3ce(0x269)]()['padStart'](0x2,'0')+'\x20'+_0x268ab1['getHours']()[_0x50f3ce(0x269)]()[_0x50f3ce(0x1d2)](0x2,'0')+':'+_0x268ab1['getMinutes']()[_0x50f3ce(0x269)]()['padStart'](0x2,'0')+':'+_0x268ab1[_0x50f3ce(0x135)]()[_0x50f3ce(0x269)]()[_0x50f3ce(0x1d2)](0x2,'0');}function getTimeStamp(){const _0x48c3e0=_0x42be23,_0xe1d764=shiftedTime();return _0xe1d764['getFullYear']()+'/'+(_0xe1d764[_0x48c3e0(0x1ee)]()+0x1)[_0x48c3e0(0x269)]()['padStart'](0x2,'0')+'/'+_0xe1d764[_0x48c3e0(0x24c)]()[_0x48c3e0(0x269)]()[_0x48c3e0(0x1d2)](0x2,'0')+'\x20'+_0xe1d764[_0x48c3e0(0x16b)]()[_0x48c3e0(0x269)]()[_0x48c3e0(0x1d2)](0x2,'0')+':'+_0xe1d764[_0x48c3e0(0x1c8)]()[_0x48c3e0(0x269)]()[_0x48c3e0(0x1d2)](0x2,'0')+':'+_0xe1d764[_0x48c3e0(0x135)]()[_0x48c3e0(0x269)]()[_0x48c3e0(0x1d2)](0x2,'0');}function shiftedTime(){const _0x957eb4=_0x42be23,_0x47dad7=new Date();let _0x23c913=_0x47dad7;if(settings[_0x957eb4(0x13d)]&&settings['timeshift']!==0x0)_0x23c913=fns['add'](_0x47dad7,{'hours':settings['timeshift']});return _0x23c913;}function startScheduler(){const _0xabc8ef=_0x42be23;let _0x1c25c8=new Date()[_0xabc8ef(0x238)]();_0x1c25c8==0x1&&backupConfigFiles();_0x1c25c8==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x59f980=_0x42be23;fs[_0x59f980(0x241)](configpath,{'withFileTypes':!![]})[_0x59f980(0x1b0)](_0x344c9f=>{const _0x891989=_0x59f980;if(!_0x344c9f[_0x891989(0x129)]())fs[_0x891989(0x223)](configpath+_0x344c9f['name'],configbackuppath+_0x344c9f[_0x891989(0x186)]);});}function triggerAnalytics(){const _0x310e01=_0x42be23;analytics[_0x310e01(0x22a)]({'title':_0x310e01(0x209),'href':_0x310e01(0x138),'path':'/v'+serverversion});}function validateCredentials(_0xc9d32f,_0x2abd4f){const _0x478f10=_0x42be23;if(_0xc9d32f['username']==settings[_0x478f10(0x1f3)]&&bcrypt['compareSync'](_0xc9d32f['password'],settings[_0x478f10(0x153)])){if(settings[_0x478f10(0x1a5)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0xad26a3=generateLoginToken(_0x2abd4f);return{'allow':!![],'reason':_0x478f10(0x15a),'token':_0xad26a3};}}else return{'allow':![],'reason':_0x478f10(0x179),'token':null};}function refreshToken(_0x3ce265){const _0x5c27a2=_0x42be23,_0x533057=generateLoginToken(_0x3ce265);return{'allow':!![],'reason':_0x5c27a2(0x15a),'token':_0x533057};}function validateAccess(_0x2528d3,_0x3b8cd5){const _0x30515b=_0x42be23;let _0x1e3363=devices[_0x3b8cd5]['ip'],_0x465369;const _0x51a4dd=_0x499b78=>{const _0x22893d=_0x322b;if(settings[_0x22893d(0x257)]){if(settings[_0x22893d(0x1a5)]){if(telegram2FaApproved(_0x3b8cd5)){const _0x201cb2=generateLoginToken(_0x3b8cd5);return{'allow':!![],'reason':_0x22893d(0x14c),'token':_0x201cb2};}else return{'allow':![],'reason':_0x22893d(0x1d6),'token':null};}else return _0x465369=validToken(_0x499b78,_0x3b8cd5),_0x465369[_0x22893d(0x201)](_0x22893d(0x235))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x499b78}:{'allow':![],'reason':_0x22893d(0x1d6),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x38112a=[...settings[_0x30515b(0x188)],_0x30515b(0x19b),'::ffff:127.0.0.1',_0x30515b(0x1e3)];if(_0x38112a[_0x30515b(0x1ec)](_0x1e3363))return _0x51a4dd(_0x2528d3);else{_0x465369=validToken(_0x2528d3,_0x3b8cd5);if(_0x465369['hasOwnProperty'](_0x30515b(0x235)))return _0x51a4dd(_0x2528d3);else{if(telegramIpApproved(_0x3b8cd5)){const _0x304243=generateToken(_0x3b8cd5);return _0x465369=_0x51a4dd(_0x2528d3),_0x465369[_0x30515b(0x150)]?{'allow':!![],'reason':_0x30515b(0x1a0),'token':_0x304243}:_0x465369;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x30515b(0x1aa),'token':null}:{'allow':![],'reason':_0x30515b(0x160),'token':null};}}}else return _0x51a4dd(_0x2528d3);}function timelyDecrypt(_0x389215,_0x4dc0db=!![]){const _0x7b075=_0x42be23;if(_0x389215)try{const _0x528618=crypt['decrypt'](secure['privateKey'],_0x389215)[_0x7b075(0x271)],_0x3257c5=_0x528618[_0x7b075(0x1e8)]('@')[0x0],_0x1d27c2=_0x528618[_0x7b075(0x1e8)]('@')[0x1],_0x38ffc9=new Date()['getTime']();if(_0x4dc0db){if(_0x38ffc9-_0x1d27c2<maxSecretAge*0x3e8)return _0x3257c5;else return![];}else return _0x3257c5;}catch(_0x3ed194){return![];}else return![];}const validToken=(_0x1add3a,_0x23617a)=>{const _0x2d232e=_0x42be23,_0x1c363b=devices[_0x23617a]['ip'];if(!_0x1add3a)return{'error':_0x2d232e(0x217)};for(let _0x3173e3 of blacklist){if(_0x3173e3[_0x2d232e(0x22d)]==_0x1add3a)return{'error':_0x2d232e(0x1e4)};}let _0x23edfe;try{_0x23edfe=jwt['verify'](_0x1add3a,secure['secret']+_0x23617a);}catch{return{'error':_0x2d232e(0x17c)};}if(!_0x23edfe[_0x2d232e(0x201)](_0x2d232e(0x249))&&!_0x23edfe['hasOwnProperty'](_0x2d232e(0x162))||!_0x23edfe[_0x2d232e(0x201)](_0x2d232e(0x22c)))return{'error':_0x2d232e(0x15f)};if(!_0x23edfe[_0x2d232e(0x201)]('username')&&_0x23edfe[_0x2d232e(0x201)](_0x2d232e(0x249))){const {clientip:_0x15b55d}=_0x23edfe;return _0x1c363b==_0x15b55d?{'success':_0x2d232e(0x15d)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x23edfe[_0x2d232e(0x201)](_0x2d232e(0x162))&&_0x23edfe[_0x2d232e(0x201)]('clientip')){const {username:_0x2c6e29,clientip:_0x4b257a}=_0x23edfe;return settings[_0x2d232e(0x1f3)]==_0x2c6e29&&_0x1c363b==_0x4b257a?{'success':_0x2d232e(0x15d)}:{'error':_0x2d232e(0x26d)};}}},generateLoginToken=_0x5e9cd0=>{const _0x34a6cd=_0x42be23;if(_0x5e9cd0){const _0x29e110=devices[_0x5e9cd0]['ip'];return jwt[_0x34a6cd(0x20a)]({'username':settings[_0x34a6cd(0x1f3)],'clientip':_0x29e110},secure[_0x34a6cd(0x180)]+_0x5e9cd0,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x43e124=>{const _0x289d2c=_0x42be23;if(_0x43e124){const _0x571000=devices[_0x43e124]['ip'];return jwt['sign']({'clientip':_0x571000},secure[_0x289d2c(0x180)]+_0x43e124,{'expiresIn':devices[_0x43e124][_0x289d2c(0x1dd)][_0x289d2c(0x23b)]*0x3c});}else return![];},telegramIpApproved=_0x2c11f8=>{const _0xe2a76c=_0x42be23;let _0x24f9d5=![];return devices[_0x2c11f8][_0xe2a76c(0x1dd)]&&devices[_0x2c11f8][_0xe2a76c(0x1dd)][_0xe2a76c(0x23b)]!='reject'&&(_0x24f9d5=devices[_0x2c11f8]['telegramIpApproval'][_0xe2a76c(0x249)]==devices[_0x2c11f8]['ip']&&new Date()[_0xe2a76c(0x20f)]()-devices[_0x2c11f8][_0xe2a76c(0x1dd)]['timestamp']<devices[_0x2c11f8]['telegramIpApproval'][_0xe2a76c(0x23b)]*0x3c*0x3e8),_0x24f9d5;},telegram2FaApproved=_0x61cda7=>{const _0x4165ec=_0x42be23;let _0x581d09=![];return devices[_0x61cda7]['telegram2FaApproval']&&devices[_0x61cda7][_0x4165ec(0x170)][_0x4165ec(0x23b)]!=_0x4165ec(0x1d0)&&(_0x581d09=devices[_0x61cda7][_0x4165ec(0x170)][_0x4165ec(0x249)]==devices[_0x61cda7]['ip']&&new Date()[_0x4165ec(0x20f)]()-devices[_0x61cda7][_0x4165ec(0x170)]['timestamp']<devices[_0x61cda7]['telegram2FaApproval'][_0x4165ec(0x23b)]*0x3c*0x3e8),_0x581d09;},normalizeIP=_0x20949a=>{const _0x4c8521=_0x42be23;let _0x5262b5=null,_0x1621b7=null;if(ipaddr['isValid'](_0x20949a)){const _0xf3c4e0=ipaddr[_0x4c8521(0x1df)](_0x20949a);_0xf3c4e0[_0x4c8521(0x14f)]()===_0x4c8521(0x181)?(_0xf3c4e0[_0x4c8521(0x139)]()&&(_0x5262b5=_0xf3c4e0[_0x4c8521(0x264)]()[_0x4c8521(0x269)]()),_0x1621b7=_0xf3c4e0[_0x4c8521(0x269)]()):(_0x5262b5=_0xf3c4e0[_0x4c8521(0x269)](),_0x1621b7=_0xf3c4e0['toIPv4MappedAddress']()[_0x4c8521(0x269)]());}return{'show':_0x5262b5?_0x5262b5:_0x1621b7,'store':_0x1621b7};};