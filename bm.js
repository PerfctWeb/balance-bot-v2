const _0x2a8e1a=_0x4923;(function(_0x293816,_0x4b4b45){const _0x83d346=_0x4923,_0x5945f1=_0x293816();while(!![]){try{const _0x5055ae=-parseInt(_0x83d346(0x25a))/0x1+-parseInt(_0x83d346(0x262))/0x2*(-parseInt(_0x83d346(0x1de))/0x3)+-parseInt(_0x83d346(0x26a))/0x4*(parseInt(_0x83d346(0x1d9))/0x5)+-parseInt(_0x83d346(0x21a))/0x6*(parseInt(_0x83d346(0x2af))/0x7)+parseInt(_0x83d346(0x30b))/0x8+-parseInt(_0x83d346(0x1d3))/0x9*(parseInt(_0x83d346(0x269))/0xa)+parseInt(_0x83d346(0x1e8))/0xb;if(_0x5055ae===_0x4b4b45)break;else _0x5945f1['push'](_0x5945f1['shift']());}catch(_0x28e345){_0x5945f1['push'](_0x5945f1['shift']());}}}(_0x1a48,0x8e488));const _0xdeb4b8=function(){let _0x529c66=!![];return function(_0x22dce5,_0x48c8fe){const _0x140b19=_0x529c66?function(){const _0x20a3c6=_0x4923;if(_0x48c8fe){const _0x4946e0=_0x48c8fe[_0x20a3c6(0x34a)](_0x22dce5,arguments);return _0x48c8fe=null,_0x4946e0;}}:function(){};return _0x529c66=![],_0x140b19;};}(),_0x3be54e=_0xdeb4b8(this,function(){const _0x374b54=_0x4923;return _0x3be54e[_0x374b54(0x2f8)]()[_0x374b54(0x2be)](_0x374b54(0x35e))[_0x374b54(0x2f8)]()[_0x374b54(0x209)](_0x3be54e)[_0x374b54(0x2be)]('(((.+)+)+)+$');});_0x3be54e();'use strict';process[_0x2a8e1a(0x1c6)][_0x2a8e1a(0x1c1)]=0x1;const childProcess=require(_0x2a8e1a(0x226)),fs=require('fs'),fns=require(_0x2a8e1a(0x296)),low=require(_0x2a8e1a(0x33c)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x2a8e1a(0x21f)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x2a8e1a(0x1e2)],RSA=require('hybrid-crypto-js')[_0x2a8e1a(0x257)],bcrypt=require(_0x2a8e1a(0x355)),jwt=require(_0x2a8e1a(0x221)),ipaddr=require(_0x2a8e1a(0x32d)),argv=require(_0x2a8e1a(0x33b))(process[_0x2a8e1a(0x274)][_0x2a8e1a(0x2c6)](0x2))[_0x2a8e1a(0x274)],uuidRandom=require(_0x2a8e1a(0x197)),{Telegraf,Markup}=require(_0x2a8e1a(0x26d)),Mixpanel=require(_0x2a8e1a(0x185)),axios=require(_0x2a8e1a(0x1b2)),{GraphQLClient,gql}=require(_0x2a8e1a(0x20f)),util=require('util'),fileUpload=require(_0x2a8e1a(0x273)),{networkInterfaces}=require('os'),PORT=argv[_0x2a8e1a(0x1f7)]||_0x2a8e1a(0x1f4),pattern=/^[0-9]{2,4}$/;!pattern[_0x2a8e1a(0x25d)](PORT)&&(console['log'](_0x2a8e1a(0x357)+PORT+_0x2a8e1a(0x24b)),process[_0x2a8e1a(0x1a2)](0x1));const HOST=argv[_0x2a8e1a(0x31a)]||null,userID=argv[_0x2a8e1a(0x32e)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x2a8e1a(0x1e0)];let bbpath=_0x2a8e1a(0x210),bbpath2='';const botfile=_0x2a8e1a(0x28d),configfile=_0x2a8e1a(0x22e),settingsfile=_0x2a8e1a(0x224),securefile=_0x2a8e1a(0x1b3),environment=require('./'+bbpath2+'version.json')['environment']||_0x2a8e1a(0x2e5),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x2a8e1a(0x1a6),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x2a8e1a(0x2e1),zippath=userID?bbpath+_0x2a8e1a(0x2c0)+userID+'/':bbpath+_0x2a8e1a(0x2c0),loggerfile=fs[_0x2a8e1a(0x1a9)](logspath+_0x2a8e1a(0x285),{'flags':'a'}),temppath=userID?bbpath+_0x2a8e1a(0x341)+userID+'/':bbpath+_0x2a8e1a(0x341);!fs[_0x2a8e1a(0x18c)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x2a8e1a(0x18c)](configbackuppath)&&fs[_0x2a8e1a(0x1c8)](configbackuppath);!fs[_0x2a8e1a(0x18c)](logspath)&&fs[_0x2a8e1a(0x1c8)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x2a8e1a(0x18c)](temppath)&&fs[_0x2a8e1a(0x1c8)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2a8e1a(0x17b)]({'bots':[]})[_0x2a8e1a(0x2f4)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2a8e1a(0x17b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2a8e1a(0x192),'onepagemode':![]}})[_0x2a8e1a(0x2f4)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2a8e1a(0x17b)]({'secure':{},'blacklist':[]})[_0x2a8e1a(0x2f4)]();let crypt=new Crypt({'md':_0x2a8e1a(0x2a6),'rsaStandard':_0x2a8e1a(0x202)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2a8e1a(0x33d)](_0x2a8e1a(0x2b0),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings[_0x2a8e1a(0x2cd)]!=_0x2a8e1a(0x316))&&settings[_0x2a8e1a(0x34b)]&&settings[_0x2a8e1a(0x34b)]!='')initTelegram();const parseColor=(_0x7f8e2a,_0x396645)=>{const _0x1c518f=_0x2a8e1a,_0x4186f7=/#[A-Z]{3}#/g;if(typeof _0x7f8e2a==_0x1c518f(0x344)){!_0x396645?_0x7f8e2a=_0x7f8e2a[_0x1c518f(0x1dd)](_0x4186f7,''):(_0x7f8e2a=_0x7f8e2a[_0x1c518f(0x1dd)](/#BLU#/g,'\x1b[34m'),_0x7f8e2a=_0x7f8e2a[_0x1c518f(0x1dd)](/#RED#/g,_0x1c518f(0x17d)),_0x7f8e2a=_0x7f8e2a['replace'](/#YEL#/g,_0x1c518f(0x24f)),_0x7f8e2a=_0x7f8e2a[_0x1c518f(0x1dd)](/#MAG#/g,_0x1c518f(0x1dc)),_0x7f8e2a=_0x7f8e2a[_0x1c518f(0x1dd)](/#CYA#/g,_0x1c518f(0x271)),_0x7f8e2a=_0x7f8e2a[_0x1c518f(0x1dd)](/#RES#/g,'\x1b[0m'));;}return _0x7f8e2a;},logger={'screen':_0x140f8d=>{const _0xf26120=_0x2a8e1a;console[_0xf26120(0x298)](parseColor(_0x140f8d,!![]));},'simple':_0x4c12a1=>{const _0x2a841a=_0x2a8e1a;console[_0x2a841a(0x298)](parseColor(_0x4c12a1,!![])),loggerfile[_0x2a841a(0x2f4)](util[_0x2a841a(0x2d2)](parseColor(_0x4c12a1,![]))+'\x0a');},'full':async _0x3c2650=>{const _0x30d86d=_0x2a8e1a,_0x366a51=getTimeStamp()+_0x30d86d(0x1f6)+_0x3c2650;console[_0x30d86d(0x298)](parseColor(_0x366a51,!![])),loggerfile[_0x30d86d(0x2f4)](util[_0x30d86d(0x2d2)](parseColor(_0x366a51,![]))+'\x0a');if(tgBot&&settings[_0x30d86d(0x2d7)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x30d86d(0x2d7)],_0x30d86d(0x32c)+parseColor(_0x3c2650,![]));},'debug':async(_0x6d7fa3,_0x3a3d6a='')=>{const _0x67ab1=_0x2a8e1a,_0x3967e4=getTimeStamp()+_0x67ab1(0x2b4)+_0x6d7fa3;if(debugging)console[_0x67ab1(0x298)](parseColor(_0x3967e4,!![]));loggerfile['write'](util[_0x67ab1(0x2d2)](parseColor(_0x3967e4,![]))+'\x0a');if(_0x3a3d6a){if(debugging)console[_0x67ab1(0x298)](_0x3a3d6a);loggerfile[_0x67ab1(0x2f4)](util[_0x67ab1(0x2d2)](_0x3a3d6a)+'\x0a');}}};let terminating=![];process['on'](_0x2a8e1a(0x304),function(_0x27c3fa){const _0x537134=_0x2a8e1a;logger[_0x537134(0x215)](_0x27c3fa);}),process['on'](_0x2a8e1a(0x1a2),()=>{stopAllBots();}),process['on'](_0x2a8e1a(0x1a1),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2a8e1a(0x294))[_0x2a8e1a(0x227)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2a8e1a(0x2e9)),app=express(),http=require(_0x2a8e1a(0x2ae))[_0x2a8e1a(0x2d9)](app);app[_0x2a8e1a(0x201)](fileUpload({'useTempFiles':!![]})),app[_0x2a8e1a(0x19f)]('/download/:type',async(_0x2e51ae,_0x2abb37)=>{const _0xb50b49=_0x2a8e1a,_0x2b35b8=_0x2e51ae['params'][_0xb50b49(0x231)],_0x49bf5b=getClientsWithBotID(_0xb50b49(0x2d6)),_0x2a685d=_0x2e51ae['headers'][_0xb50b49(0x196)],_0x327abd=timelyDecrypt(_0x2a685d,![]),_0xf8ccdd=_0x49bf5b[_0xb50b49(0x20e)](_0x3db3cc=>_0x3db3cc['uuid']==_0x327abd);if(_0xf8ccdd){const _0x5f487b=normalizeIP(_0x2e51ae['socket'][_0xb50b49(0x29a)])[_0xb50b49(0x1e1)],_0x66f30=_0x2e51ae['headers'][_0xb50b49(0x1c0)];if(validateAccess(_0x66f30,_0x327abd,_0x5f487b)[_0xb50b49(0x324)])_0x2b35b8=='backup'&&await backupConfigFiles(),await zipFiles(_0x2b35b8),_0x2abb37[_0xb50b49(0x34e)](zippath+(_0x2b35b8+_0xb50b49(0x2dc)),_0xa168f5=>{const _0x289363=_0xb50b49;_0xa168f5&&(logger[_0x289363(0x351)](_0x289363(0x305)+_0x2b35b8),logger['simple'](_0xa168f5));});else logger[_0xb50b49(0x351)](_0xb50b49(0x2e4)+_0x2b35b8+'\x20(1)');}else logger[_0xb50b49(0x351)](_0xb50b49(0x2e4)+_0x2b35b8+_0xb50b49(0x1c5));}),app[_0x2a8e1a(0x23d)](_0x2a8e1a(0x18b),async(_0x45c2ba,_0x1efe20)=>{const _0x17394e=_0x2a8e1a,_0x4d1efe=getClientsWithBotID('botmanager'),_0x567764=_0x45c2ba[_0x17394e(0x34c)][_0x17394e(0x196)],_0x555a2b=timelyDecrypt(_0x567764,![]),_0xfa96de=_0x4d1efe[_0x17394e(0x20e)](_0x1f980e=>_0x1f980e[_0x17394e(0x196)]==_0x555a2b);logger[_0x17394e(0x2c5)](_0x17394e(0x322));if(_0xfa96de){const _0x379603=normalizeIP(_0x45c2ba[_0x17394e(0x307)][_0x17394e(0x29a)])['store'],_0x4d7742=_0x45c2ba[_0x17394e(0x34c)][_0x17394e(0x1c0)];if(validateAccess(_0x4d7742,_0x555a2b,_0x379603)[_0x17394e(0x324)]){if(_0x45c2ba[_0x17394e(0x27a)]){const _0x253b99=_0x45c2ba[_0x17394e(0x27a)][_0x17394e(0x212)];await _0x253b99['mv'](temppath+_0x253b99[_0x17394e(0x2cf)]),_0x1efe20[_0x17394e(0x2e0)]({'status':!![],'message':'File\x20uploaded'});const _0x453329=getBotsWithMode();_0x453329[_0x17394e(0x366)]>0x0?confirmRestore(temppath,_0x253b99['name']):unzipFile(temppath,_0x253b99[_0x17394e(0x2cf)]);}}else logger[_0x17394e(0x351)](_0x17394e(0x32b));}else logger[_0x17394e(0x351)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x2a8e1a(0x201)](express[_0x2a8e1a(0x2b6)](path['join'](__dirname,bbpath2,_0x2a8e1a(0x313)))),app[_0x2a8e1a(0x201)](express[_0x2a8e1a(0x2b6)](path[_0x2a8e1a(0x261)](__dirname,bbpath2,_0x2a8e1a(0x1d8)))),app['get']('/',function(_0x3f177a,_0x50a90f){const _0x485832=_0x2a8e1a;_0x50a90f['sendFile'](path[_0x485832(0x261)](__dirname,bbpath2,_0x485832(0x313),_0x485832(0x228)));}),app['get']('/:bot',function(_0x31778e,_0x42d513){const _0x236512=_0x2a8e1a;_0x42d513[_0x236512(0x2d4)](path[_0x236512(0x261)](__dirname,bbpath2,_0x236512(0x1d8),_0x236512(0x228)));}),app[_0x2a8e1a(0x19f)]('/:bot/portfolio',(_0x321b16,_0x2edf53)=>{const _0x5c9a3a=_0x2a8e1a;_0x2edf53[_0x5c9a3a(0x2d4)](path[_0x5c9a3a(0x261)](__dirname,bbpath2,_0x5c9a3a(0x1d8),_0x5c9a3a(0x228)));}),app[_0x2a8e1a(0x19f)]('/:bot/performance',(_0x1ed7b3,_0x18d9e2)=>{const _0x20e171=_0x2a8e1a;_0x18d9e2[_0x20e171(0x2d4)](path[_0x20e171(0x261)](__dirname,bbpath2,_0x20e171(0x1d8),_0x20e171(0x228)));}),app['get'](_0x2a8e1a(0x2df),(_0x5c0fc0,_0x1655c0)=>{const _0x45e340=_0x2a8e1a;_0x1655c0['sendFile'](path[_0x45e340(0x261)](__dirname,bbpath2,_0x45e340(0x1d8),_0x45e340(0x228)));}),app[_0x2a8e1a(0x19f)](_0x2a8e1a(0x30d),(_0x3078f9,_0x359913)=>{const _0x2d10e0=_0x2a8e1a;_0x359913[_0x2d10e0(0x2d4)](path[_0x2d10e0(0x261)](__dirname,bbpath2,_0x2d10e0(0x1d8),'index.html'));}),app[_0x2a8e1a(0x19f)]('/:bot/configuration',(_0x202ec7,_0x35e9c2)=>{const _0x3cfcd3=_0x2a8e1a;_0x35e9c2[_0x3cfcd3(0x2d4)](path[_0x3cfcd3(0x261)](__dirname,bbpath2,_0x3cfcd3(0x1d8),'index.html'));}),app[_0x2a8e1a(0x19f)]('/:bot/support',(_0x553f2f,_0x3ede33)=>{const _0x1ee7c7=_0x2a8e1a;_0x3ede33['sendFile'](path[_0x1ee7c7(0x261)](__dirname,bbpath2,'build',_0x1ee7c7(0x228)));});if(HOST)http[_0x2a8e1a(0x26f)](PORT,HOST);else http[_0x2a8e1a(0x26f)](PORT);const io=require(_0x2a8e1a(0x17c))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1edcdf=_0x2a8e1a;let _0x498ed1=_0x1edcdf(0x234);const _0x163706=networkInterfaces(),_0x4e66a5={};for(const _0x490bd2 of Object[_0x1edcdf(0x1b1)](_0x163706)){for(const _0x14d85e of _0x163706[_0x490bd2]){if((_0x14d85e[_0x1edcdf(0x216)]==_0x1edcdf(0x2f7)||_0x14d85e[_0x1edcdf(0x216)]==0x4)&&!_0x14d85e[_0x1edcdf(0x193)]){const _0xc37121=ipaddr['parse'](_0x14d85e[_0x1edcdf(0x2a1)])[_0x1edcdf(0x28a)]();_0xc37121!='private'&&(!_0x4e66a5[_0x490bd2]&&(_0x4e66a5[_0x490bd2]=[]),_0x4e66a5[_0x490bd2]['push'](_0x14d85e[_0x1edcdf(0x2a1)]),_0x498ed1=_0x14d85e['address']);}}}return{'serverip':_0x498ed1,'netinterfaces':_0x4e66a5};}async function startServer(){const _0x175043=_0x2a8e1a,{serverip:_0x38692f,netinterfaces:_0x1042a9}=getServerIP();logger[_0x175043(0x215)](''),logger[_0x175043(0x215)]('-----------------------------------------------------------------------------------'),await logger[_0x175043(0x351)](_0x175043(0x252)+serverversion+_0x175043(0x20b)+(environment==_0x175043(0x1fe)?_0x175043(0x35d):'')+'\x0a'+(_0x175043(0x229)+PORT+_0x175043(0x233))+(_0x175043(0x2a2)+_0x38692f+':'+PORT+_0x175043(0x2dd))),logger['simple'](_0x175043(0x27d));if(config['length']!=0x0)for(const _0x46989c of config){const _0x41a660=_0x46989c['mode']==_0x175043(0x2f5)?'a':'m';if(_0x46989c[_0x175043(0x256)]=='enabled'||_0x46989c[_0x175043(0x256)]==_0x175043(0x31d))await logger[_0x175043(0x351)](_0x175043(0x2b2)+_0x41a660+_0x175043(0x31e)+_0x46989c[_0x175043(0x2f9)]+_0x175043(0x287)+_0x46989c[_0x175043(0x356)]),startBot([_0x46989c[_0x175043(0x2f9)],userID],{'cwd':bbpath},function(_0x3f75d9){const _0x54c18f=_0x175043;if(_0x3f75d9)logger[_0x54c18f(0x351)](_0x3f75d9);});else(_0x46989c[_0x175043(0x256)]=='disabled'||_0x46989c[_0x175043(0x256)]==_0x175043(0x1b8))&&await logger[_0x175043(0x351)](_0x175043(0x1ad)+_0x41a660+_0x175043(0x338)+_0x46989c[_0x175043(0x2f9)]+'\x20|\x20'+_0x46989c['botname']);}else!newBot&&logger['simple'](_0x175043(0x2ea));if(newBot)addBot();logger['simple'](_0x175043(0x27d)),logger['simple'](''),await logger[_0x175043(0x2c5)](_0x175043(0x1d0)+nodeversion),await logger[_0x175043(0x2c5)](_0x175043(0x279),_0x1042a9);}function startSocket(){const _0x297ef3=_0x2a8e1a;io['on'](_0x297ef3(0x35a),_0x40f50a=>{const _0x45ba02=_0x297ef3;let _0x5d9c88,_0x238597,_0x31388d,_0x315fb6,_0x5d78cc;const _0x182828=_0x40f50a[_0x45ba02(0x2d0)][_0x45ba02(0x34c)]['referer'];_0x238597=_0x182828[_0x45ba02(0x2ba)](/bot[0-9]{3}/);if(_0x238597)_0x31388d=_0x238597[0x0][_0x45ba02(0x2ba)](/[0-9]{3}/);if(_0x31388d)_0x5d9c88=_0x31388d[0x0];else _0x5d9c88='botmanager';const _0x22f25f=_0x40f50a[_0x45ba02(0x2d0)][_0x45ba02(0x2aa)][_0x45ba02(0x1bb)];if(!_0x22f25f)_0x40f50a[_0x45ba02(0x282)](_0x45ba02(0x256),{'publicKey':secure[_0x45ba02(0x35f)]});else{_0x315fb6=timelyDecrypt(_0x22f25f,![]);if(!_0x315fb6)_0x40f50a[_0x45ba02(0x282)]('status',{'publicKey':secure[_0x45ba02(0x35f)]});else{_0x5d78cc=normalizeIP(_0x40f50a[_0x45ba02(0x219)]['remoteAddress'])[_0x45ba02(0x1e1)];if(!devices[_0x315fb6])devices[_0x315fb6]={'uuid':_0x315fb6,'access':{'token':null}};devices[_0x315fb6]['ip']=_0x5d78cc;const _0x394b78=addClient(_0x40f50a['id'],_0x315fb6,_0x5d9c88);setAccess(_0x394b78),emitMessages(),_0x40f50a['on'](_0x45ba02(0x329),_0xc0e7e8=>{const _0x2ce2e5=_0x45ba02,_0xf16e6f=timelyDecrypt(_0xc0e7e8[_0x2ce2e5(0x342)]);if(_0xf16e6f){_0xc0e7e8={'username':_0xc0e7e8[_0x2ce2e5(0x1c4)],'password':_0xf16e6f},devices[_0x315fb6][_0x2ce2e5(0x327)]=validateCredentials(_0xc0e7e8,_0x315fb6);if(devices[_0x315fb6][_0x2ce2e5(0x327)]['allow']==![]&&devices[_0x315fb6]['access'][_0x2ce2e5(0x1c7)]==_0x2ce2e5(0x1d7))_0x40f50a['emit'](_0x2ce2e5(0x256),{'access':devices[_0x315fb6][_0x2ce2e5(0x327)]}),loginAccess2FA(_0x315fb6,_0x5d78cc);else{if(devices[_0x315fb6][_0x2ce2e5(0x327)][_0x2ce2e5(0x324)]==![]&&devices[_0x315fb6][_0x2ce2e5(0x327)][_0x2ce2e5(0x1c7)]=='invalid\x20credentials')_0x40f50a[_0x2ce2e5(0x282)](_0x2ce2e5(0x256),{'access':devices[_0x315fb6][_0x2ce2e5(0x327)]});else devices[_0x315fb6][_0x2ce2e5(0x327)][_0x2ce2e5(0x324)]&&devices[_0x315fb6][_0x2ce2e5(0x327)][_0x2ce2e5(0x1c7)]==_0x2ce2e5(0x2a9)&&(getClientsWithUuid(_0x315fb6)[_0x2ce2e5(0x272)](_0x3f70c7=>{setAccess(_0x3f70c7);}),logger[_0x2ce2e5(0x2c5)]('Logged\x20in\x20user\x20...'+_0x315fb6[_0x2ce2e5(0x2c6)](-0x8)),setTokenRefresh(_0x315fb6),setSessionTimeout(_0x2ce2e5(0x329),_0x315fb6));}}else logger[_0x2ce2e5(0x351)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x40f50a['on'](_0x45ba02(0x275),()=>{resetPassword();}),_0x40f50a['on']('disconnect',_0x1f9283=>{removeClient(_0x40f50a['id']);}),_0x5d9c88=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x34cf31){const _0x26f7aa=_0x2a8e1a;if(_0x34cf31!=_0x26f7aa(0x2d6)&&config[_0x26f7aa(0x28f)]!=''){if(pid[_0x34cf31])pid[_0x34cf31]['send']({'function':'initclient','args':null});}_0x34cf31!='botmanager'&&broadcastToBots('bots',JSON[_0x26f7aa(0x2c8)](config));}function reloadBotManager(){const _0x5e9440=_0x2a8e1a;getClientsWithBotID(_0x5e9440(0x2d6))['forEach'](_0x206471=>{const _0x189531=_0x5e9440;getSocket(_0x206471['id'])['emit'](_0x189531(0x256),{'access':{'allow':![],'reason':_0x189531(0x30f),'token':null}});});}function getSocket(_0x3e2156){const _0x5e1a36=_0x2a8e1a;return io[_0x5e1a36(0x2e7)]['sockets'][_0x5e1a36(0x19f)](_0x3e2156);}function setAccess(_0x5c1683){const _0x345ad8=_0x2a8e1a,_0x52d2c9=getSocket(_0x5c1683['id']),_0x443be6=_0x5c1683[_0x345ad8(0x196)],_0x451d5b=_0x5c1683[_0x345ad8(0x222)];devices[_0x443be6]['access']=validateAccess(devices[_0x443be6][_0x345ad8(0x327)]['token'],_0x443be6),logger[_0x345ad8(0x2c5)](_0x345ad8(0x1bd)+devices[_0x443be6]['access'][_0x345ad8(0x1c7)]+_0x345ad8(0x28c)+_0x5c1683['id'][_0x345ad8(0x2c6)](-0x8)+'\x20|\x20user:\x20...'+_0x443be6['slice'](-0x8)),_0x52d2c9['join'](_0x443be6);if(devices[_0x443be6][_0x345ad8(0x327)][_0x345ad8(0x324)]){_0x52d2c9[_0x345ad8(0x261)](_0x451d5b);if(_0x451d5b==_0x345ad8(0x2d6))initializeSocketBotManager(_0x52d2c9);else initializeSocketBot(_0x52d2c9);initClient(_0x451d5b);}devices[_0x443be6][_0x345ad8(0x327)]['token']&&devices[_0x443be6]['access'][_0x345ad8(0x1c7)]==_0x345ad8(0x325)&&setSessionTimeout(_0x345ad8(0x2bf),_0x443be6),devices[_0x443be6][_0x345ad8(0x327)][_0x345ad8(0x22b)]&&devices[_0x443be6][_0x345ad8(0x327)][_0x345ad8(0x1c7)]==_0x345ad8(0x1db)&&setSessionTimeout('login',_0x443be6),_0x52d2c9[_0x345ad8(0x282)](_0x345ad8(0x256),{'status':_0x5c1683[_0x345ad8(0x1e6)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x443be6][_0x345ad8(0x327)],'externalip':devices[_0x443be6]['ip'],'publicKey':secure[_0x345ad8(0x35f)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x443be6][_0x345ad8(0x327)][_0x345ad8(0x324)]==![]&&devices[_0x443be6][_0x345ad8(0x327)][_0x345ad8(0x1c7)]=='2FA\x20required'&&temporaryAccess2FA(_0x443be6,devices[_0x443be6]['ip']);}function setSessionTimeout(_0x2f43fa,_0x168a1e){const _0x49822d=_0x2a8e1a;let _0x5dd1b0;if(_0x2f43fa==_0x49822d(0x329))_0x5dd1b0=loginExpiry*0x3c*0x3e8;else _0x5dd1b0=devices[_0x168a1e][_0x49822d(0x187)][_0x49822d(0x2e3)]*0x3c*0x3e8-(new Date()[_0x49822d(0x34f)]()-devices[_0x168a1e][_0x49822d(0x187)][_0x49822d(0x235)]);if(devices[_0x168a1e]['pidExpireLogin'])clearTimeout(devices[_0x168a1e][_0x49822d(0x1a5)]);devices[_0x168a1e][_0x49822d(0x1a5)]=setTimeout(()=>{const _0xe4486e=_0x49822d;if(devices[_0x168a1e][_0xe4486e(0x368)])clearTimeout(devices[_0x168a1e][_0xe4486e(0x368)]);removeSocketListeners(_0x168a1e),addBlacklist(_0x168a1e),devices[_0x168a1e][_0xe4486e(0x187)]=null,devices[_0x168a1e]['telegram2FaApproval']=null,devices[_0x168a1e]['access'][_0xe4486e(0x22b)]=null,logger[_0xe4486e(0x2c5)](_0xe4486e(0x2b8)+_0x168a1e[_0xe4486e(0x2c6)](-0x8)),devices[_0x168a1e]['access']=validateAccess(devices[_0x168a1e][_0xe4486e(0x327)][_0xe4486e(0x22b)],_0x168a1e),!(devices[_0x168a1e]['access'][_0xe4486e(0x324)]&&devices[_0x168a1e][_0xe4486e(0x327)][_0xe4486e(0x1c7)]=='login\x20not\x20required')&&(_0x2f43fa==_0xe4486e(0x329)?io['to'](_0x168a1e)[_0xe4486e(0x282)]('status',{'access':{'allow':![],'reason':_0xe4486e(0x213),'token':null}}):io['to'](_0x168a1e)[_0xe4486e(0x282)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x168a1e][_0xe4486e(0x327)][_0xe4486e(0x22b)]=null;},_0x5dd1b0);}function setTokenRefresh(_0x45afc4){const _0x2fae50=_0x2a8e1a;if(devices[_0x45afc4][_0x2fae50(0x368)])clearTimeout(devices[_0x45afc4][_0x2fae50(0x368)]);devices[_0x45afc4]['pidRefreshToken']=setTimeout(()=>{const _0x24f0d0=_0x2fae50;getClientsWithUuid(_0x45afc4)[_0x24f0d0(0x366)]!=0x0?(devices[_0x45afc4][_0x24f0d0(0x327)]=refreshToken(_0x45afc4),io['to'](_0x45afc4)[_0x24f0d0(0x282)]('status',{'status':_0x24f0d0(0x277),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x45afc4][_0x24f0d0(0x327)],'externalip':devices[_0x45afc4]['ip'],'publicKey':secure[_0x24f0d0(0x35f)],'validInstallation':validInstallation}),setTokenRefresh(_0x45afc4)):clearTimeout(devices[_0x45afc4][_0x24f0d0(0x368)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x329e55){const _0x560e16=_0x2a8e1a,_0x246b9f=getClient(_0x329e55['id'])[_0x560e16(0x196)];_0x329e55[_0x560e16(0x282)](_0x560e16(0x188),config),_0x329e55[_0x560e16(0x282)](_0x560e16(0x1b5),cleanSettings()),_0x329e55['on']('add-bot',_0xf2db93=>{const _0x1f0853=_0x560e16;if(validateAccess(_0xf2db93,_0x246b9f)[_0x1f0853(0x324)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x329e55['on'](_0x560e16(0x1e3),(_0x15b3f9,_0x58ce33)=>{const _0x1819f7=_0x560e16;if(validateAccess(_0x58ce33,_0x246b9f)[_0x1819f7(0x324)])toggleBot(_0x15b3f9['botID'],_0x15b3f9[_0x1819f7(0x256)],_0x15b3f9['live']);else logger[_0x1819f7(0x351)](_0x1819f7(0x208));}),_0x329e55['on'](_0x560e16(0x2c3),(_0x205c2e,_0x195117)=>{const _0x1932cf=_0x560e16;if(validateAccess(_0x195117,_0x246b9f)[_0x1932cf(0x324)])toggleBotMode(_0x205c2e);else logger['full'](_0x1932cf(0x208));}),_0x329e55['on'](_0x560e16(0x1a7),(_0x11309a,_0x1937cf)=>{const _0x269575=_0x560e16;if(validateAccess(_0x1937cf,_0x246b9f)[_0x269575(0x324)])deleteBot(_0x11309a);else logger['full'](_0x269575(0x363));}),_0x329e55['on'](_0x560e16(0x1b9),(_0x41d1b4,_0x12d84f)=>{const _0x5d63b5=_0x560e16;if(validateAccess(_0x12d84f,_0x246b9f)[_0x5d63b5(0x324)])storeSettings(_0x41d1b4,!![]);else logger[_0x5d63b5(0x351)](_0x5d63b5(0x244));}),_0x329e55['on']('update-bb',_0x8a554f=>{const _0x29c606=_0x560e16;if(validateAccess(_0x8a554f,_0x246b9f)[_0x29c606(0x324)])updateBB(_0x29c606(0x1ba));else logger['full'](_0x29c606(0x2da));}),_0x329e55['on'](_0x560e16(0x253),_0x16d1ff=>{const _0x5542c0=_0x560e16;if(validateAccess(_0x16d1ff,_0x246b9f)['allow'])updateBB(_0x5542c0(0x232));else logger[_0x5542c0(0x351)](_0x5542c0(0x2c9));}),_0x329e55['on'](_0x560e16(0x26b),_0x2af5bb=>{const _0x594735=_0x560e16;if(validateAccess(_0x2af5bb,_0x246b9f)[_0x594735(0x324)]){const _0x119e3e=getClient(_0x329e55['id']);if(_0x119e3e)getBackupFiles(_0x119e3e[_0x594735(0x196)]);else logger['full'](_0x594735(0x333));}else logger[_0x594735(0x351)](_0x594735(0x367));}),_0x329e55['on'](_0x560e16(0x1f8),(_0x283b28,_0x3d51dc)=>{const _0x3e184f=_0x560e16;if(validateAccess(_0x3d51dc,_0x246b9f)['allow'])restoreBackupFile(_0x283b28);else logger[_0x3e184f(0x351)](_0x3e184f(0x276));}),_0x329e55['on'](_0x560e16(0x1ab),_0x2887de=>{const _0x6f5b59=_0x560e16;if(validateAccess(_0x2887de,_0x246b9f)[_0x6f5b59(0x324)])getMessages();else logger[_0x6f5b59(0x351)](_0x6f5b59(0x284));}),_0x329e55['on'](_0x560e16(0x2c4),(_0x387715,_0x4ff28a)=>{const _0x66eedf=_0x560e16;if(validateAccess(_0x4ff28a,_0x246b9f)[_0x66eedf(0x324)])confirmMessage(_0x387715);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x329e55['on'](_0x560e16(0x2eb),_0x4c428e=>{const _0x222729=_0x560e16;if(validateAccess(_0x4c428e,_0x246b9f)[_0x222729(0x324)]){if(devices[_0x246b9f][_0x222729(0x368)])clearTimeout(devices[_0x246b9f]['pidRefreshToken']);if(devices[_0x246b9f][_0x222729(0x1a5)])clearTimeout(devices[_0x246b9f][_0x222729(0x1a5)]);removeSocketListeners(getClient(_0x329e55['id'])[_0x222729(0x196)]),addBlacklist(_0x246b9f),devices[_0x246b9f][_0x222729(0x187)]=null,devices[_0x246b9f][_0x222729(0x292)]=null,devices[_0x246b9f][_0x222729(0x327)]['token']=null,logger[_0x222729(0x2c5)]('Logged\x20out\x20user\x20...'+_0x246b9f['slice'](-0x8)),io['to'](getClient(_0x329e55['id'])[_0x222729(0x196)])[_0x222729(0x282)](_0x222729(0x256),{'access':{'allow':![],'reason':_0x222729(0x19c),'token':null}});}else logger[_0x222729(0x351)](_0x222729(0x30c));});}function initializeSocketBot(_0x46bb2f){const _0x1ecf66=_0x2a8e1a,_0x2713d=getClient(_0x46bb2f['id'])['bot'],_0x8e0aab=getClient(_0x46bb2f['id'])[_0x1ecf66(0x196)];_0x46bb2f['on'](_0x1ecf66(0x34d),(_0x2d5e72,_0x28e568)=>{const _0xb4e168=_0x1ecf66;if(validateAccess(_0x28e568,_0x8e0aab)['allow']){if(pid[_0x2713d])pid[_0x2713d][_0xb4e168(0x2e0)]({'function':_0xb4e168(0x1c9),'args':_0x2d5e72});}else logger[_0xb4e168(0x351)](_0xb4e168(0x19d));}),_0x46bb2f['on'](_0x1ecf66(0x1ca),(_0x222105,_0x2dc860)=>{const _0x227edb=_0x1ecf66;if(validateAccess(_0x2dc860,_0x8e0aab)[_0x227edb(0x324)]){if(pid[_0x2713d])pid[_0x2713d][_0x227edb(0x2e0)]({'function':_0x227edb(0x242),'args':_0x222105});}else logger[_0x227edb(0x351)](_0x227edb(0x211));}),_0x46bb2f['on']('get-portfolio',(_0x2f48dd,_0x465ca9)=>{const _0x569cd8=_0x1ecf66;if(validateAccess(_0x465ca9,_0x8e0aab)['allow']){if(pid[_0x2713d])pid[_0x2713d]['send']({'function':_0x569cd8(0x332),'args':_0x2f48dd});}else logger[_0x569cd8(0x351)](_0x569cd8(0x25c));}),_0x46bb2f['on'](_0x1ecf66(0x178),(_0x37e5f2,_0x375959)=>{const _0x1da81e=_0x1ecf66;if(validateAccess(_0x375959,_0x8e0aab)['allow']){if(pid[_0x2713d])pid[_0x2713d][_0x1da81e(0x2e0)]({'function':_0x1da81e(0x343),'args':_0x37e5f2});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x46bb2f['on'](_0x1ecf66(0x2de),(_0x135dc5,_0x43dc1b)=>{const _0x318c01=_0x1ecf66;if(validateAccess(_0x43dc1b,_0x8e0aab)[_0x318c01(0x324)]){if(pid[_0x2713d])pid[_0x2713d]['send']({'function':_0x318c01(0x1a3),'args':_0x135dc5});}else logger[_0x318c01(0x351)](_0x318c01(0x239));}),_0x46bb2f['on']('store-fiat',(_0x9279ea,_0x22e0c5)=>{const _0x38a61b=_0x1ecf66;if(validateAccess(_0x22e0c5,_0x8e0aab)[_0x38a61b(0x324)]){if(pid[_0x2713d])pid[_0x2713d][_0x38a61b(0x2e0)]({'function':_0x38a61b(0x358),'args':_0x9279ea});}else logger[_0x38a61b(0x351)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x46bb2f['on'](_0x1ecf66(0x1c2),_0x323604=>{const _0x317f9a=_0x1ecf66;if(validateAccess(_0x323604,_0x8e0aab)['allow']){if(pid[_0x2713d])pid[_0x2713d][_0x317f9a(0x2e0)]({'function':_0x317f9a(0x328),'args':null});}else logger[_0x317f9a(0x351)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x46bb2f['on'](_0x1ecf66(0x220),_0x532cbc=>{const _0x2552e7=_0x1ecf66;if(validateAccess(_0x532cbc,_0x8e0aab)[_0x2552e7(0x324)]){if(pid[_0x2713d])pid[_0x2713d][_0x2552e7(0x2e0)]({'function':_0x2552e7(0x2b7),'args':null});}else logger['full'](_0x2552e7(0x1d5));}),_0x46bb2f['on'](_0x1ecf66(0x1b0),(_0x30de02,_0x43e84d)=>{const _0x47ad75=_0x1ecf66;if(validateAccess(_0x43e84d,_0x8e0aab)[_0x47ad75(0x324)]){if(pid[_0x2713d])pid[_0x2713d][_0x47ad75(0x2e0)]({'function':_0x47ad75(0x2b9),'args':_0x30de02});}else logger['full'](_0x47ad75(0x254));}),_0x46bb2f['on']('cancel-loading',_0x500e66=>{const _0x2ca359=_0x1ecf66;if(validateAccess(_0x500e66,_0x8e0aab)[_0x2ca359(0x324)]){if(pid[_0x2713d])pid[_0x2713d][_0x2ca359(0x2e0)]({'function':_0x2ca359(0x259),'args':null});}else logger['full'](_0x2ca359(0x1a4));}),_0x46bb2f['on'](_0x1ecf66(0x297),_0x360ec6=>{const _0x2381d6=_0x1ecf66;if(validateAccess(_0x360ec6,_0x8e0aab)[_0x2381d6(0x324)]){if(pid[_0x2713d])pid[_0x2713d][_0x2381d6(0x2e0)]({'function':_0x2381d6(0x20c),'args':null});}else logger[_0x2381d6(0x351)](_0x2381d6(0x27f));}),_0x46bb2f['on']('update-bb',_0x1dda91=>{const _0xeb1490=_0x1ecf66;if(validateAccess(_0x1dda91,_0x8e0aab)[_0xeb1490(0x324)])updateBB(_0xeb1490(0x1ba));else logger[_0xeb1490(0x351)](_0xeb1490(0x2da));}),_0x46bb2f['on'](_0x1ecf66(0x1ab),_0x2dd512=>{const _0x474c7c=_0x1ecf66;if(validateAccess(_0x2dd512,_0x8e0aab)[_0x474c7c(0x324)])getMessages();else logger[_0x474c7c(0x351)](_0x474c7c(0x284));}),_0x46bb2f['on']('confirm-message',(_0xc60bec,_0x174df1)=>{const _0x4bd3b4=_0x1ecf66;if(validateAccess(_0x174df1,_0x8e0aab)[_0x4bd3b4(0x324)])confirmMessage(_0xc60bec);else logger['full'](_0x4bd3b4(0x1fc));}),_0x46bb2f['on'](_0x1ecf66(0x2eb),_0x442afc=>{const _0x1f23bb=_0x1ecf66;if(validateAccess(_0x442afc,_0x8e0aab)['allow']){if(devices[_0x8e0aab][_0x1f23bb(0x368)])clearTimeout(devices[_0x8e0aab]['pidRefreshToken']);if(devices[_0x8e0aab][_0x1f23bb(0x1a5)])clearTimeout(devices[_0x8e0aab][_0x1f23bb(0x1a5)]);removeSocketListeners(getClient(_0x46bb2f['id'])[_0x1f23bb(0x196)]),addBlacklist(_0x8e0aab),devices[_0x8e0aab][_0x1f23bb(0x187)]=null,devices[_0x8e0aab][_0x1f23bb(0x292)]=null,devices[_0x8e0aab][_0x1f23bb(0x327)]['token']=null,logger['debug'](_0x1f23bb(0x1b7)+_0x8e0aab[_0x1f23bb(0x2c6)](-0x8)),io['to'](getClient(_0x46bb2f['id'])['uuid'])[_0x1f23bb(0x282)](_0x1f23bb(0x256),{'access':{'allow':![],'reason':_0x1f23bb(0x19c),'token':null}});}else logger['full'](_0x1f23bb(0x30c));});}function removeSocketListeners(_0x3a6802){getClientsWithUuid(_0x3a6802)['forEach'](_0x4f63c9=>{const _0x39cf54=_0x4923;getSocket(_0x4f63c9['id'])[_0x39cf54(0x2ad)]();});}function cleanSettings(){const _0x233db8=_0x2a8e1a;let _0x593d28=settings;return settings[_0x233db8(0x2cd)]&&settings[_0x233db8(0x2cd)]!=''&&(_0x593d28={..._0x593d28,'telegramToken':_0x233db8(0x314)}),settings[_0x233db8(0x32a)]&&settings[_0x233db8(0x32a)]!=''&&(_0x593d28={..._0x593d28,'bbPassword':_0x233db8(0x314)}),(settings[_0x233db8(0x32a)]&&settings[_0x233db8(0x32a)]=='***'||settings['telegramToken']&&settings['telegramToken']==_0x233db8(0x316))&&(_0x593d28={..._0x593d28,'restored':{'password':settings[_0x233db8(0x32a)]==_0x233db8(0x316),'telegram':settings[_0x233db8(0x2cd)]==_0x233db8(0x316)}}),_0x593d28;}async function updateBB(_0x170a72){const _0x5232ca=_0x2a8e1a;await backupConfigFiles(),installingUpdate=!![],config[_0x5232ca(0x272)](_0x91feec=>{const _0xc98ae3=_0x5232ca;restartBot(_0x91feec[_0xc98ae3(0x2f9)]);});if(_0x170a72==_0x5232ca(0x1ba))process[_0x5232ca(0x2e0)]({'update':!![],'environment':environment},_0x510e3a=>{});else _0x170a72==_0x5232ca(0x232)&&process[_0x5232ca(0x2e0)]({'reinstall':!![],'environment':environment},_0x311e02=>{});}function startBot(_0x5edf3d,_0x11727d,_0x15df07){const _0x52f2d9=_0x2a8e1a;if(debugging)_0x5edf3d[_0x52f2d9(0x237)]('-d');let _0x1c53fd=![];const _0x1324ae=_0x5edf3d[0x0];_0x11727d={..._0x11727d,'stdio':[_0x52f2d9(0x347),'inherit',_0x52f2d9(0x347),'ipc']},pid[_0x1324ae]=childProcess[_0x52f2d9(0x26c)](botfile,_0x5edf3d,_0x11727d),pid[_0x1324ae]['on'](_0x52f2d9(0x2c2),_0x3226f7=>{const _0x7737f5=_0x52f2d9;switch(Object[_0x7737f5(0x1b1)](_0x3226f7)[0x0]){case'botname':updateBotName(_0x1324ae,_0x3226f7['botname']);break;case _0x7737f5(0x35b):updateBotManager();break;case _0x7737f5(0x256):updateStatus(_0x1324ae,_0x3226f7[_0x7737f5(0x256)]);break;case _0x7737f5(0x278):updateLive(_0x1324ae,_0x3226f7[_0x7737f5(0x278)]);break;case _0x7737f5(0x1d4):updateLive(_0x1324ae,_0x3226f7[_0x7737f5(0x1d4)]),io['to'](_0x1324ae)[_0x7737f5(0x282)](_0x7737f5(0x256),{'access':{'allow':![],'reason':_0x7737f5(0x30f),'token':null}});break;case _0x7737f5(0x268):_0x3226f7[_0x7737f5(0x268)]==_0x7737f5(0x303)&&restartBot(_0x1324ae);_0x3226f7[_0x7737f5(0x268)]=='kill'&&toggleBot(_0x1324ae,_0x7737f5(0x334),_0x7737f5(0x1bc));break;case'telegram':sendTelegramBot(_0x1324ae,_0x3226f7[_0x7737f5(0x241)]);break;case'telegrammsg':sendTelegramMsg(_0x3226f7[_0x7737f5(0x361)]);break;case _0x7737f5(0x1ce):io['to'](_0x1324ae)[_0x7737f5(0x282)](_0x3226f7[_0x7737f5(0x1ce)],_0x3226f7[_0x7737f5(0x181)]);break;}}),pid[_0x1324ae]['on'](_0x52f2d9(0x1ea),function(_0x111692){if(_0x1c53fd)return;_0x1c53fd=!![],_0x15df07(_0x111692);}),pid[_0x1324ae]['on'](_0x52f2d9(0x1a2),async function(_0x3a7f47){const _0x1f8aea=_0x52f2d9;if(terminating)return;if(installingUpdate){logger[_0x1f8aea(0x2c5)](_0x1f8aea(0x29f)),io['close']();return;}if(_0x1c53fd)return;_0x1c53fd=!![],_0x15df07(null);const _0x35af8e=dbConfig[_0x1f8aea(0x19f)]('bots')['find']({'botID':_0x1324ae})[_0x1f8aea(0x349)]();_0x35af8e&&(_0x35af8e[_0x1f8aea(0x256)]==_0x1f8aea(0x326)||_0x35af8e[_0x1f8aea(0x256)]==_0x1f8aea(0x31d))&&(await sleep(0x3e8),updateLive(_0x1324ae,'stopped'),logger[_0x1f8aea(0x351)](_0x1f8aea(0x2f3)+_0x1324ae),startBot([_0x1324ae,userID],{'cwd':bbpath},function(_0xb81358){const _0x1388d2=_0x1f8aea;if(_0xb81358)logger[_0x1388d2(0x351)](_0xb81358);}));});}function stopBot(_0x1cef71){const _0x18d34c=_0x2a8e1a;getClientsWithBotID(_0x1cef71)[_0x18d34c(0x272)](_0x306c11=>{const _0x4e8841=_0x18d34c;getSocket(_0x306c11['id'])[_0x4e8841(0x300)](!![]),removeClient(_0x306c11['id']);}),pid[_0x1cef71]&&(pid[_0x1cef71]['kill'](),pid[_0x1cef71]=null);}function stopAllBots(){const _0x57e0aa=_0x2a8e1a;terminating=!![];const _0x57378f=getEnabledBots();_0x57378f[_0x57e0aa(0x272)](_0x5ebced=>{stopBot(_0x5ebced['botID']);});}function restartBot(_0x3d91c1){const _0x217fd6=_0x2a8e1a;if(pid[_0x3d91c1])pid[_0x3d91c1][_0x217fd6(0x18d)]();}function addBot(){const _0xe75b26=_0x2a8e1a;let _0x5d88a8;for(let _0x53b684=0x1;_0x53b684<0x3e9;_0x53b684++){_0x5d88a8=_0x53b684[_0xe75b26(0x2f8)]()[_0xe75b26(0x1e5)](0x3,'0');let _0x20c0da=config[_0xe75b26(0x20e)](_0x37077d=>_0x37077d['botID']==_0x5d88a8);if(!_0x20c0da)break;}if(_0x5d88a8==='1000'){logger[_0xe75b26(0x351)](_0xe75b26(0x1f9));return;}logger[_0xe75b26(0x351)](_0xe75b26(0x2bb)+_0x5d88a8),dbConfig[_0xe75b26(0x19f)](_0xe75b26(0x188))[_0xe75b26(0x237)]({'botID':_0x5d88a8,'botname':'Bot\x20'+_0x5d88a8,'status':_0xe75b26(0x31d),'live':''})[_0xe75b26(0x2f4)](),startBot([_0x5d88a8,userID],{'cwd':bbpath},function(_0x44215d){const _0x1a90c1=_0xe75b26;if(_0x44215d)logger[_0x1a90c1(0x351)](_0x44215d);}),config=getConfiguration(),io['to'](_0xe75b26(0x2d6))[_0xe75b26(0x282)](_0xe75b26(0x188),config),broadcastToBots('bots',JSON[_0xe75b26(0x2c8)](config));}function deleteBot(_0x3faec1){const _0x45ef71=_0x2a8e1a;getClientsWithBotID(_0x3faec1)['forEach'](_0x476c3f=>{getSocket(_0x476c3f['id'])['disconnect'](!![]),removeClient(_0x476c3f['id']);}),dbConfig['get'](_0x45ef71(0x188))[_0x45ef71(0x183)]({'botID':_0x3faec1})[_0x45ef71(0x2f4)](),logger['full']('Deleted\x20Bot\x20'+_0x3faec1),stopBot(_0x3faec1);try{if(fs[_0x45ef71(0x18c)](path[_0x45ef71(0x261)](configpath,'bot-'+_0x3faec1+_0x45ef71(0x29b))))fs['unlinkSync'](path[_0x45ef71(0x261)](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x29b)));if(fs[_0x45ef71(0x18c)](path[_0x45ef71(0x261)](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x1a8))))fs[_0x45ef71(0x18a)](path['join'](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x1a8)));if(fs[_0x45ef71(0x18c)](path[_0x45ef71(0x261)](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x17e))))fs['unlinkSync'](path[_0x45ef71(0x261)](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x17e)));if(fs[_0x45ef71(0x18c)](path['join'](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x289))))fs[_0x45ef71(0x18a)](path[_0x45ef71(0x261)](configpath,_0x45ef71(0x23b)+_0x3faec1+_0x45ef71(0x289)));}catch(_0x1938fb){if(_0x1938fb)logger[_0x45ef71(0x351)](_0x45ef71(0x353),_0x1938fb);}config=getConfiguration(),io['to'](_0x45ef71(0x2d6))[_0x45ef71(0x282)](_0x45ef71(0x188),config),broadcastToBots(_0x45ef71(0x188),JSON[_0x45ef71(0x2c8)](config));}function toggleBot(_0x53b3ec,_0x13b648,_0x45bca4){const _0x89664f=_0x2a8e1a;dbConfig[_0x89664f(0x19f)](_0x89664f(0x188))[_0x89664f(0x20e)]({'botID':_0x53b3ec})['assign']({'status':_0x13b648})[_0x89664f(0x29c)]({'live':_0x45bca4})[_0x89664f(0x2f4)]();if(_0x13b648==_0x89664f(0x326)||_0x13b648==_0x89664f(0x31d))logger['full']('Enabled\x20Bot\x20'+_0x53b3ec),startBot([_0x53b3ec,userID],{'cwd':bbpath},function(_0x5d2c3d){if(_0x5d2c3d)logger['full'](_0x5d2c3d);});else(_0x13b648==_0x89664f(0x334)||_0x13b648==_0x89664f(0x1b8))&&(logger[_0x89664f(0x351)]('Disabled\x20Bot\x20'+_0x53b3ec),stopBot(_0x53b3ec));config=getConfiguration(),io['to'](_0x89664f(0x2d6))[_0x89664f(0x282)]('bots',config),broadcastToBots('bots',JSON[_0x89664f(0x2c8)](config));}function toggleStatus(_0x1cc2bc){const _0x24eaad=_0x2a8e1a;let _0x4eeac5=dbConfig['get']('bots')['find']({'botID':_0x1cc2bc})[_0x24eaad(0x349)](),_0x192b6f;if(_0x4eeac5['status']===_0x24eaad(0x326))_0x192b6f=_0x24eaad(0x334);else{if(_0x4eeac5[_0x24eaad(0x256)]==='new')_0x192b6f=_0x24eaad(0x1b8);else{if(_0x4eeac5['status']==='new-disabled')_0x192b6f=_0x24eaad(0x31d);else{if(_0x4eeac5[_0x24eaad(0x256)]==='disabled')_0x192b6f=_0x24eaad(0x326);}}}return _0x192b6f;}function updateStatus(_0x21ce46,_0x3a39e7){const _0x4e12b9=_0x2a8e1a;dbConfig[_0x4e12b9(0x19f)](_0x4e12b9(0x188))['find']({'botID':_0x21ce46})[_0x4e12b9(0x29c)]({'status':_0x3a39e7})[_0x4e12b9(0x2f4)](),config=getConfiguration(),io['to']('botmanager')[_0x4e12b9(0x282)](_0x4e12b9(0x188),config),broadcastToBots(_0x4e12b9(0x188),JSON[_0x4e12b9(0x2c8)](config));}function updateLive(_0xff7075,_0x309f44){const _0x26ef79=_0x2a8e1a;dbConfig[_0x26ef79(0x19f)](_0x26ef79(0x188))[_0x26ef79(0x20e)]({'botID':_0xff7075})[_0x26ef79(0x29c)]({'live':_0x309f44})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x26ef79(0x282)](_0x26ef79(0x188),config),broadcastToBots('bots',JSON[_0x26ef79(0x2c8)](config));}function updateBotName(_0xadcedb,_0x328b76){const _0x225927=_0x2a8e1a;dbConfig[_0x225927(0x19f)](_0x225927(0x188))['find']({'botID':_0xadcedb})[_0x225927(0x29c)]({'botname':_0x328b76})[_0x225927(0x2f4)](),config=getConfiguration(),io['to'](_0x225927(0x2d6))[_0x225927(0x282)]('bots',config),broadcastToBots(_0x225927(0x188),JSON[_0x225927(0x2c8)](config));}function updateBotManager(){const _0x363b51=_0x2a8e1a;config=getConfiguration(),io['to'](_0x363b51(0x2d6))[_0x363b51(0x282)]('bots',config),broadcastToBots(_0x363b51(0x188),JSON['stringify'](config));}function toggleBotMode(_0x3617d7){const _0x165be6=_0x2a8e1a;if(pid[_0x3617d7])pid[_0x3617d7][_0x165be6(0x2e0)]({'function':'toggleBotMode','args':null});else{const _0x3bbab0=configpath+_0x165be6(0x23b)+_0x3617d7+_0x165be6(0x29b),_0x84564a=fs[_0x165be6(0x335)](_0x3bbab0),_0x4fd023=JSON[_0x165be6(0x21d)](_0x84564a),_0x8badd0=_0x4fd023[_0x165be6(0x222)][0x0]['headless'];_0x4fd023[_0x165be6(0x222)][0x0][_0x165be6(0x258)]=!_0x8badd0;const _0x411964=JSON['stringify'](_0x4fd023,null,0x2);fs[_0x165be6(0x25f)](_0x3bbab0,_0x411964),config=getConfiguration(),io['to'](_0x165be6(0x2d6))[_0x165be6(0x282)]('bots',config),broadcastToBots(_0x165be6(0x188),JSON[_0x165be6(0x2c8)](config));}}function validateTelegram(_0x467aeb){const _0x5ab183=_0x2a8e1a;if(_0x467aeb[_0x5ab183(0x308)][_0x5ab183(0x1c4)]!=settings[_0x5ab183(0x34b)]&&'@'+_0x467aeb[_0x5ab183(0x308)][_0x5ab183(0x1c4)]!=settings[_0x5ab183(0x34b)]||_0x467aeb[_0x5ab183(0x1ed)]['id']!=settings[_0x5ab183(0x2d7)])return sendTelegram(_0x467aeb[_0x5ab183(0x1ed)]['id'],_0x5ab183(0x1aa),{'parse_mode':_0x5ab183(0x27c)}),![];return!![];}async function initTelegram(){const _0x3ea5c5=_0x2a8e1a;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x3ea5c5(0x2cd)]);let _0x3555da=_0x3ea5c5(0x25b);_0x3555da+='\x0a',_0x3555da+=_0x3ea5c5(0x1e9),_0x3555da+=_0x3ea5c5(0x24a),_0x3555da+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x3555da+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3555da+=_0x3ea5c5(0x26e),_0x3555da+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3555da+=_0x3ea5c5(0x2d5),_0x3555da+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3555da+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x3555da+=_0x3ea5c5(0x1cf),_0x3555da+=_0x3ea5c5(0x204),_0x3555da+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x3555da+=_0x3ea5c5(0x2e2),_0x3555da+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3afc83=_0x3ea5c5(0x225);_0x3afc83+='\x0a',_0x3afc83+=_0x3555da,tgBot['catch']((_0x8ed112,_0x4e4f9f)=>{const _0x59bfa9=_0x3ea5c5;logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x59bfa9(0x2c5)](_0x59bfa9(0x2a0),_0x8ed112);}),tgBot[_0x3ea5c5(0x201)](async(_0x3d764b,_0x3688a9)=>{const _0xfdcf8a=_0x3ea5c5;if(!(!settings[_0xfdcf8a(0x2d7)]&&_0x3d764b['update']['message'][_0xfdcf8a(0x1ff)]==_0xfdcf8a(0x1a0))){if(!validateTelegram(_0x3d764b))return;}_0x3688a9();}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x179),async _0x5df64e=>{const _0xb8aa6e=_0x3ea5c5;if(!settings['telegramChatId'])updateSetting(_0xb8aa6e(0x2d7),_0x5df64e[_0xb8aa6e(0x1ed)]['id']);updateSetting(_0xb8aa6e(0x180),!![]);if(!validateTelegram(_0x5df64e))return;await sendTelegram(_0x5df64e[_0xb8aa6e(0x1ed)]['id'],_0x3afc83);}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x1cc),async _0x16f6a3=>{const _0x4f7394=_0x3ea5c5;updateSetting(_0x4f7394(0x180),!![]),await sendTelegram(_0x16f6a3['chat']['id'],_0x4f7394(0x2b3));}),tgBot[_0x3ea5c5(0x17f)]('disable',async _0x4161e0=>{const _0x1c2d83=_0x3ea5c5;await sendTelegram(_0x4161e0[_0x1c2d83(0x1ed)]['id'],_0x1c2d83(0x251)),updateSetting(_0x1c2d83(0x180),![]);}),tgBot[_0x3ea5c5(0x17f)]('config',async _0x2279e9=>{const _0x42378b=_0x3ea5c5,_0x284516=Markup['inlineKeyboard']([Markup[_0x42378b(0x1c3)][_0x42378b(0x1df)](_0x42378b(0x2db),_0x42378b(0x360)),Markup[_0x42378b(0x1c3)][_0x42378b(0x1df)]('Alerts',_0x42378b(0x2c1)),Markup[_0x42378b(0x1c3)]['callback'](_0x42378b(0x24d),_0x42378b(0x302))]);_0x2279e9[_0x42378b(0x32f)](_0x42378b(0x350),_0x284516);}),tgBot[_0x3ea5c5(0x1e4)](_0x3ea5c5(0x360),async _0xc8292a=>{const _0x502a23=_0x3ea5c5;_0xc8292a['editMessageReplyMarkup'](),updateSetting(_0x502a23(0x195),_0x502a23(0x250)),updateSetting(_0x502a23(0x180),!![]),await sendTelegram(_0xc8292a['chat']['id'],_0x502a23(0x318));}),tgBot[_0x3ea5c5(0x1e4)](_0x3ea5c5(0x2c1),async _0x23e87d=>{const _0x272259=_0x3ea5c5;_0x23e87d[_0x272259(0x352)](),updateSetting(_0x272259(0x195),'alerts'),updateSetting(_0x272259(0x180),!![]),await sendTelegram(_0x23e87d[_0x272259(0x1ed)]['id'],_0x272259(0x2a8));}),tgBot['action'](_0x3ea5c5(0x302),async _0x39184b=>{const _0x2616e3=_0x3ea5c5;_0x39184b['editMessageReplyMarkup'](),updateSetting(_0x2616e3(0x195),_0x2616e3(0x286)),updateSetting(_0x2616e3(0x180),!![]),await sendTelegram(_0x39184b[_0x2616e3(0x1ed)]['id'],_0x2616e3(0x248));}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x256),async _0x5a7f07=>{const _0x36dc6f=_0x3ea5c5,_0x784838=getBotsWithMode();let _0x45d48f=_0x36dc6f(0x270);config[_0x36dc6f(0x272)](_0x4c5bdc=>{const _0x509068=_0x36dc6f,_0x42099e=_0x784838['find'](_0x4b2a08=>_0x4b2a08['botID']==_0x4c5bdc[_0x509068(0x2f9)])['mode'];_0x45d48f+=_0x509068(0x246)+_0x4c5bdc[_0x509068(0x2f9)]+':\x20'+_0x4c5bdc['status']+_0x509068(0x287)+_0x42099e+_0x509068(0x287)+_0x4c5bdc[_0x509068(0x278)]+'\x0a';}),_0x45d48f+='\x0a',_0x45d48f+=_0x36dc6f(0x17a),_0x45d48f+=!settings[_0x36dc6f(0x180)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x45d48f+=settings['telegramEnabled']?settings['telegramEvents']==_0x36dc6f(0x286)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x36dc6f(0x195)]+'\x20only\x0a':'',await sendTelegram(_0x5a7f07['chat']['id'],_0x45d48f,{'parse_mode':_0x36dc6f(0x27c)});}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x303),async _0x23362d=>{const _0x2af2b9=_0x3ea5c5,_0x51a9bd=getEnabledBots();if(_0x51a9bd['length']==0x0)await sendTelegram(_0x23362d['chat']['id'],_0x2af2b9(0x236));else{if(_0x51a9bd[_0x2af2b9(0x366)]>0x1)_0x51a9bd[_0x2af2b9(0x237)]({'botID':_0x2af2b9(0x286)});let _0x34b4b8=[],_0x44aca7=[];const _0x5a6b7a=_0x51a9bd[_0x2af2b9(0x366)]%0x4==0x0||_0x51a9bd[_0x2af2b9(0x366)]%0x4==0x3||_0x51a9bd[_0x2af2b9(0x366)]%0x3==0x1?0x4:0x3;let _0x2946ea=0x0;_0x51a9bd['forEach']((_0x488945,_0x1158cf)=>{const _0xd70496=_0x2af2b9;if(_0x1158cf%_0x5a6b7a==0x0)_0x44aca7=[];_0x44aca7['push'](Markup['button'][_0xd70496(0x1df)](_0x488945[_0xd70496(0x2f9)]==_0xd70496(0x286)?_0xd70496(0x2d3):'Bot\x20'+_0x488945[_0xd70496(0x2f9)],_0xd70496(0x295)+_0x488945['botID'])),_0x1158cf%_0x5a6b7a==0x0&&(_0x34b4b8[_0x2946ea]=_0x44aca7,_0x2946ea++);});const _0x48e1a5=Markup[_0x2af2b9(0x1f1)](_0x34b4b8);_0x23362d[_0x2af2b9(0x32f)](_0x2af2b9(0x18e),_0x48e1a5);}}),tgBot[_0x3ea5c5(0x1e4)](/restart_(.+)/,async _0x408266=>{const _0xefaade=_0x3ea5c5,_0xd4a85d=_0x408266[_0xefaade(0x2ba)][0x1];_0x408266[_0xefaade(0x352)](),_0xd4a85d==_0xefaade(0x286)?config[_0xefaade(0x272)](_0x3b5b9d=>{const _0x1b102a=_0xefaade;restartBot(_0x3b5b9d[_0x1b102a(0x2f9)]);}):restartBot(_0xd4a85d);}),tgBot[_0x3ea5c5(0x17f)]('on',async _0x3a1abc=>{const _0x1c4106=_0x3ea5c5,_0x5a57ef=getDisabledBots();if(_0x5a57ef[_0x1c4106(0x366)]==0x0)await sendTelegram(_0x3a1abc[_0x1c4106(0x1ed)]['id'],_0x1c4106(0x245));else{if(_0x5a57ef[_0x1c4106(0x366)]>0x1)_0x5a57ef[_0x1c4106(0x237)]({'botID':_0x1c4106(0x286)});let _0x539179=[],_0x2178d8=[];const _0x7acd16=_0x5a57ef[_0x1c4106(0x366)]%0x4==0x0||_0x5a57ef['length']%0x4==0x3||_0x5a57ef[_0x1c4106(0x366)]%0x3==0x1?0x4:0x3;let _0x4a5839=0x0;_0x5a57ef[_0x1c4106(0x272)]((_0x201651,_0x186b30)=>{const _0x4ee761=_0x1c4106;if(_0x186b30%_0x7acd16==0x0)_0x2178d8=[];_0x2178d8[_0x4ee761(0x237)](Markup['button']['callback'](_0x201651[_0x4ee761(0x2f9)]==_0x4ee761(0x286)?_0x4ee761(0x2d3):_0x4ee761(0x246)+_0x201651[_0x4ee761(0x2f9)],_0x4ee761(0x255)+_0x201651[_0x4ee761(0x2f9)])),_0x186b30%_0x7acd16==0x0&&(_0x539179[_0x4a5839]=_0x2178d8,_0x4a5839++);});const _0x11e349=Markup[_0x1c4106(0x1f1)](_0x539179);_0x3a1abc['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x11e349);}}),tgBot['action'](/on_(.+)/,async _0x1882cc=>{const _0x3d1ff2=_0x3ea5c5,_0x2b08b3=_0x1882cc[_0x3d1ff2(0x2ba)][0x1];_0x1882cc['editMessageReplyMarkup']();if(_0x2b08b3=='all'){const _0x51d70f=getDisabledBots();await sendTelegram(_0x1882cc['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x51d70f[_0x3d1ff2(0x272)](_0x438030=>{const _0x2830fb=_0x3d1ff2;if(_0x438030[_0x2830fb(0x2f9)]!='all')toggleBot(_0x438030[_0x2830fb(0x2f9)],toggleStatus(_0x438030['botID']),'stopped');});}else await sendTelegram(_0x1882cc[_0x3d1ff2(0x1ed)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x2b08b3),toggleBot(_0x2b08b3,toggleStatus(_0x2b08b3),_0x3d1ff2(0x1bc));}),tgBot[_0x3ea5c5(0x17f)]('off',async _0x512d5e=>{const _0x36e965=_0x3ea5c5,_0x7a52aa=getEnabledBots();if(_0x7a52aa[_0x36e965(0x366)]==0x0)await sendTelegram(_0x512d5e['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x7a52aa[_0x36e965(0x366)]>0x1)_0x7a52aa[_0x36e965(0x237)]({'botID':_0x36e965(0x286)});let _0x2689aa=[],_0x5ed874=[];const _0x117c89=_0x7a52aa[_0x36e965(0x366)]%0x4==0x0||_0x7a52aa['length']%0x4==0x3||_0x7a52aa[_0x36e965(0x366)]%0x3==0x1?0x4:0x3;let _0x429715=0x0;_0x7a52aa[_0x36e965(0x272)]((_0x56a9b1,_0x20c065)=>{const _0x4ca0cc=_0x36e965;if(_0x20c065%_0x117c89==0x0)_0x5ed874=[];_0x5ed874[_0x4ca0cc(0x237)](Markup[_0x4ca0cc(0x1c3)][_0x4ca0cc(0x1df)](_0x56a9b1[_0x4ca0cc(0x2f9)]=='all'?_0x4ca0cc(0x2d3):'Bot\x20'+_0x56a9b1[_0x4ca0cc(0x2f9)],_0x4ca0cc(0x223)+_0x56a9b1[_0x4ca0cc(0x2f9)])),_0x20c065%_0x117c89==0x0&&(_0x2689aa[_0x429715]=_0x5ed874,_0x429715++);});const _0x5c8576=Markup[_0x36e965(0x1f1)](_0x2689aa);_0x512d5e[_0x36e965(0x32f)](_0x36e965(0x1b4),_0x5c8576);}}),tgBot[_0x3ea5c5(0x1e4)](/off_(.+)/,async _0x42097c=>{const _0x4a5fc4=_0x3ea5c5,_0x4830e4=_0x42097c[_0x4a5fc4(0x2ba)][0x1];_0x42097c[_0x4a5fc4(0x352)]();if(_0x4830e4==_0x4a5fc4(0x286)){const _0x73af78=getEnabledBots();await sendTelegram(_0x42097c[_0x4a5fc4(0x1ed)]['id'],_0x4a5fc4(0x2d1)),_0x73af78[_0x4a5fc4(0x272)](_0x240c35=>{const _0x35a617=_0x4a5fc4;if(_0x240c35[_0x35a617(0x2f9)]!=_0x35a617(0x286))toggleBot(_0x240c35[_0x35a617(0x2f9)],toggleStatus(_0x240c35[_0x35a617(0x2f9)]),'stopped');});}else await sendTelegram(_0x42097c[_0x4a5fc4(0x1ed)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x4830e4),toggleBot(_0x4830e4,toggleStatus(_0x4830e4),'stopped');}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x1ae),async _0x555849=>{const _0x3cf516=_0x3ea5c5,_0x3af3ae=getEnabledBots();if(_0x3af3ae[_0x3cf516(0x366)]==0x0)await sendTelegram(_0x555849[_0x3cf516(0x1ed)]['id'],_0x3cf516(0x236));else{if(_0x3af3ae[_0x3cf516(0x366)]>0x1){let _0x27554c=[],_0x2d1507=[];const _0x4ec924=_0x3af3ae[_0x3cf516(0x366)]%0x4==0x0||_0x3af3ae['length']%0x4==0x3||_0x3af3ae[_0x3cf516(0x366)]%0x3==0x1?0x4:0x3;let _0x19b794=0x0;_0x3af3ae[_0x3cf516(0x272)]((_0x2f5031,_0x5c07e8)=>{const _0x4efaf4=_0x3cf516;if(_0x5c07e8%_0x4ec924==0x0)_0x2d1507=[];_0x2d1507[_0x4efaf4(0x237)](Markup[_0x4efaf4(0x1c3)][_0x4efaf4(0x1df)]('Bot\x20'+_0x2f5031[_0x4efaf4(0x2f9)],_0x4efaf4(0x309)+_0x2f5031[_0x4efaf4(0x2f9)])),_0x5c07e8%_0x4ec924==0x0&&(_0x27554c[_0x19b794]=_0x2d1507,_0x19b794++);});const _0x39a257=Markup['inlineKeyboard'](_0x27554c);_0x555849['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x39a257);}else{const _0x595cf1=_0x3af3ae[0x0]['botID'];if(pid[_0x595cf1])pid[_0x595cf1][_0x3cf516(0x2e0)]({'function':_0x3cf516(0x1ec),'args':null});}}}),tgBot[_0x3ea5c5(0x1e4)](/metrics_(.+)/,async _0x34bcc9=>{const _0x37ba82=_0x3ea5c5,_0x52061a=_0x34bcc9[_0x37ba82(0x2ba)][0x1];_0x34bcc9[_0x37ba82(0x352)]();if(pid[_0x52061a])pid[_0x52061a]['send']({'function':_0x37ba82(0x1ec),'args':null});}),tgBot[_0x3ea5c5(0x17f)]('portfolio',async _0x24700e=>{const _0x5a9521=_0x3ea5c5,_0x38c90b=getEnabledBots();if(_0x38c90b[_0x5a9521(0x366)]==0x0)await sendTelegram(_0x24700e[_0x5a9521(0x1ed)]['id'],_0x5a9521(0x236));else{if(_0x38c90b['length']>0x1){let _0x5bd2aa=[],_0x56ed53=[];const _0x20e0c5=_0x38c90b[_0x5a9521(0x366)]%0x4==0x0||_0x38c90b['length']%0x4==0x3||_0x38c90b['length']%0x3==0x1?0x4:0x3;let _0x5e4c02=0x0;_0x38c90b[_0x5a9521(0x272)]((_0x3bfe83,_0x3453b0)=>{const _0x3f31c9=_0x5a9521;if(_0x3453b0%_0x20e0c5==0x0)_0x56ed53=[];_0x56ed53['push'](Markup[_0x3f31c9(0x1c3)][_0x3f31c9(0x1df)]('Bot\x20'+_0x3bfe83[_0x3f31c9(0x2f9)],_0x3f31c9(0x317)+_0x3bfe83['botID'])),_0x3453b0%_0x20e0c5==0x0&&(_0x5bd2aa[_0x5e4c02]=_0x56ed53,_0x5e4c02++);});const _0x388c88=Markup[_0x5a9521(0x1f1)](_0x5bd2aa);_0x24700e[_0x5a9521(0x32f)](_0x5a9521(0x1f2),_0x388c88);}else{const _0x385721=_0x38c90b[0x0][_0x5a9521(0x2f9)];if(pid[_0x385721])pid[_0x385721][_0x5a9521(0x2e0)]({'function':_0x5a9521(0x2a5),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x48b183=>{const _0x3dd156=_0x3ea5c5,_0x3b452c=_0x48b183[_0x3dd156(0x2ba)][0x1];_0x48b183['editMessageReplyMarkup']();if(pid[_0x3b452c])pid[_0x3b452c][_0x3dd156(0x2e0)]({'function':_0x3dd156(0x2a5),'args':null});}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x1ba),async _0x1c4e5e=>{const _0x4a2bef=_0x3ea5c5;await getMessages();if(!updateAvailable)await sendTelegram(_0x1c4e5e['chat']['id'],_0x4a2bef(0x247));else{if(!validInstallation)await sendTelegram(_0x1c4e5e[_0x4a2bef(0x1ed)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x2014e2=Markup['inlineKeyboard']([Markup['button'][_0x4a2bef(0x1df)]('Yes','update_yes'),Markup[_0x4a2bef(0x1c3)][_0x4a2bef(0x1df)]('No',_0x4a2bef(0x2f2))]);_0x1c4e5e[_0x4a2bef(0x32f)](_0x4a2bef(0x2bd),_0x2014e2);}}}),tgBot['action'](/update_(.+)/,async _0x4d8070=>{const _0x38aa26=_0x3ea5c5,_0x394789=_0x4d8070[_0x38aa26(0x2ba)][0x1];_0x4d8070[_0x38aa26(0x352)](),_0x394789==_0x38aa26(0x2a3)&&(await sendTelegram(_0x4d8070['chat']['id'],_0x38aa26(0x19a)),updateBB('update')),_0x394789=='no'&&await sendTelegram(_0x4d8070['chat']['id'],_0x38aa26(0x337));}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x232),async _0x4218ee=>{const _0x8f4f7c=_0x3ea5c5;if(!validInstallation)await sendTelegram(_0x4218ee['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x51a45f=Markup['inlineKeyboard']([Markup['button']['callback'](_0x8f4f7c(0x249),_0x8f4f7c(0x1d1)),Markup[_0x8f4f7c(0x1c3)][_0x8f4f7c(0x1df)]('No','reinstall_no')]);_0x4218ee[_0x8f4f7c(0x32f)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x51a45f);}}),tgBot['action'](/reinstall_(.+)/,async _0x375c36=>{const _0x5f3a06=_0x3ea5c5,_0xca3f69=_0x375c36['match'][0x1];_0x375c36['editMessageReplyMarkup'](),_0xca3f69==_0x5f3a06(0x2a3)&&(await sendTelegram(_0x375c36[_0x5f3a06(0x1ed)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x5f3a06(0x232))),_0xca3f69=='no'&&await sendTelegram(_0x375c36[_0x5f3a06(0x1ed)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x21b),async _0x39c29b=>{const _0x527e6d=_0x3ea5c5,_0x34727a=getBotsWithMode();if(_0x34727a[_0x527e6d(0x366)]==0x0)await sendTelegram(_0x39c29b[_0x527e6d(0x1ed)]['id'],_0x527e6d(0x236));else{let _0x28b6d6=[],_0xb85fc3=[];const _0xcfd05c=0x2;let _0x2a4e45=0x0;_0x34727a[_0x527e6d(0x272)]((_0x3133af,_0x340a2b)=>{const _0x546656=_0x527e6d;if(_0x340a2b%_0xcfd05c==0x0)_0xb85fc3=[];_0xb85fc3[_0x546656(0x237)](Markup[_0x546656(0x1c3)][_0x546656(0x1df)]('Bot\x20'+_0x3133af[_0x546656(0x2f9)]+'\x20('+_0x3133af[_0x546656(0x2f6)]+')',_0x546656(0x2fd)+_0x3133af[_0x546656(0x2f9)])),_0x340a2b%_0xcfd05c==0x0&&(_0x28b6d6[_0x2a4e45]=_0xb85fc3,_0x2a4e45++);});const _0xe762cb=Markup[_0x527e6d(0x1f1)](_0x28b6d6);_0x39c29b['reply'](_0x527e6d(0x2fc),_0xe762cb);}}),tgBot[_0x3ea5c5(0x1e4)](/toggle_(.+)/,async _0x263044=>{const _0x4d19f2=_0x3ea5c5,_0x3c2fae=_0x263044[_0x4d19f2(0x2ba)][0x1];_0x263044['editMessageReplyMarkup']();const _0x41e5a3=getBotsWithMode(),_0x13fff2=_0x41e5a3['find'](_0x4f08b4=>_0x4f08b4['botID']==_0x3c2fae),_0x1af1ba=_0x13fff2[_0x4d19f2(0x2f6)]==_0x4d19f2(0x2f5)?_0x4d19f2(0x319):_0x4d19f2(0x2f5);await sendTelegram(_0x263044[_0x4d19f2(0x1ed)]['id'],_0x4d19f2(0x362)+_0x3c2fae+_0x4d19f2(0x27e)+_0x1af1ba+'\x20mode'),toggleBotMode(_0x3c2fae);}),tgBot['command'](_0x3ea5c5(0x30a),async _0x997dd8=>{const _0x2b92ec=_0x3ea5c5;let _0x21e602='';config[_0x2b92ec(0x272)](_0x1377a4=>{const _0x6e5b1=_0x2b92ec;_0x21e602+=_0x6e5b1(0x246)+_0x1377a4['botID']+':\x20'+_0x1377a4['botname']+'\x0a';}),await sendTelegram(_0x997dd8[_0x2b92ec(0x1ed)]['id'],_0x21e602,{'parse_mode':_0x2b92ec(0x27c)});}),tgBot[_0x3ea5c5(0x17f)](_0x3ea5c5(0x23a),async _0x20ac81=>{const _0x5f18f8=_0x3ea5c5;await sendTelegram(_0x20ac81[_0x5f18f8(0x1ed)]['id'],_0x3555da);}),process[_0x3ea5c5(0x24e)](_0x3ea5c5(0x1a1),()=>tgBot[_0x3ea5c5(0x268)]('SIGINT')),process[_0x3ea5c5(0x24e)](_0x3ea5c5(0x306),()=>tgBot[_0x3ea5c5(0x268)](_0x3ea5c5(0x306))),tgBot[_0x3ea5c5(0x28b)]();}}function disableTelegram(){const _0x41039e=_0x2a8e1a;tgBot&&tgBot[_0x41039e(0x268)]();}async function sendTelegram(_0x4e86c8,_0x1dbe7f,_0x4ac3c9){const _0x257334=_0x2a8e1a;try{await tgBot[_0x257334(0x241)]['sendMessage'](_0x4e86c8,_0x1dbe7f,_0x4ac3c9);}catch(_0x389566){console[_0x257334(0x298)](_0x257334(0x2ca),_0x389566);}}async function sendTelegramBot(_0x382d64,_0x296539){const _0x32fe73=_0x2a8e1a;if(settings['telegramEnabled']){if(settings[_0x32fe73(0x195)]==_0x32fe73(0x286)||(_0x296539[_0x32fe73(0x231)]=='error'||_0x296539['type']=='warning'||_0x296539[_0x32fe73(0x231)]==_0x32fe73(0x336))&&settings[_0x32fe73(0x195)]=='alerts'||_0x296539[_0x32fe73(0x231)]=='order'&&settings['telegramEvents']==_0x32fe73(0x250)){if(tgBot&&settings[_0x32fe73(0x2d7)]){if(_0x296539[_0x32fe73(0x200)])await sendTelegram(settings['telegramChatId'],_0x296539[_0x32fe73(0x356)]+'\x20>\x20'+_0x296539[_0x32fe73(0x1fb)]);else await sendTelegram(settings[_0x32fe73(0x2d7)],_0x32fe73(0x246)+_0x382d64+_0x32fe73(0x2f1)+_0x296539[_0x32fe73(0x1fb)]);}}}}async function sendTelegramMsg(_0x107017,_0x4f7b2d=_0x2a8e1a(0x27c)){const _0x59929c=_0x2a8e1a;return settings[_0x59929c(0x180)]&&tgBot&&settings[_0x59929c(0x2d7)]?(await sendTelegram(settings[_0x59929c(0x2d7)],_0x107017,{'parse_mode':_0x4f7b2d}),!![]):![];}function getDeviceWithIp(_0x1b69ab){const _0x4960ed=_0x2a8e1a;return devices[_0x4960ed(0x20e)](_0x2ff1f3=>_0x2ff1f3['ip']===_0x1b69ab);}async function temporaryAccess2FA(_0x421602,_0xeacfa4){const _0x5217cf=_0x2a8e1a;let _0x530f7d=new Date(),_0x2aa997=![];if(lastIpApproval){if(_0x530f7d-lastIpApproval<0x1388)_0x2aa997=!![];}lastIpApproval=new Date();if(_0x2aa997)return;if(tgBot&&settings[_0x5217cf(0x2d7)]){const _0x31dd7c=uuidRandom();tmpStorage[_0x31dd7c]={'uuid':_0x421602,'externalip':_0xeacfa4};const _0xac6dcd=Markup['inlineKeyboard']([Markup['button'][_0x5217cf(0x1df)](_0x5217cf(0x35c),'tempaccess_5_'+_0x31dd7c),Markup[_0x5217cf(0x1c3)][_0x5217cf(0x1df)](_0x5217cf(0x184),_0x5217cf(0x1fd)+_0x31dd7c),Markup['button'][_0x5217cf(0x1df)]('30\x20min',_0x5217cf(0x2b1)+_0x31dd7c),Markup[_0x5217cf(0x1c3)][_0x5217cf(0x1df)](_0x5217cf(0x23c),'tempaccess_reject_'+_0x31dd7c)]);await sendTelegram(settings[_0x5217cf(0x2d7)],_0x5217cf(0x320)+normalizeIP(_0xeacfa4)[_0x5217cf(0x365)]+'\x20?',_0xac6dcd),tgBot[_0x5217cf(0x1e4)](/tempaccess_(.+)_(.+)/,async _0x4aadfb=>{const _0x4a9323=_0x5217cf,_0x3f67f9=_0x4aadfb['match'][0x1],_0x12a795=_0x4aadfb[_0x4a9323(0x2ba)][0x2],{uuid:_0x2edf88,externalip:_0x3faaf7}=tmpStorage[_0x12a795];delete tmpStorage[_0x12a795],_0x4aadfb['editMessageReplyMarkup'](),devices[_0x2edf88]['telegramIpApproval']={'clientip':_0x3faaf7,'timestamp':new Date()[_0x4a9323(0x34f)](),'expiry':_0x3f67f9},_0x3f67f9!=_0x4a9323(0x23c)?(await sendTelegram(_0x4aadfb[_0x4a9323(0x1ed)]['id'],_0x4a9323(0x182)+_0x3f67f9+'\x20minutes',{'parse_mode':_0x4a9323(0x27c)}),io['to'](_0x2edf88)[_0x4a9323(0x282)](_0x4a9323(0x256),{'access':{'allow':![],'reason':_0x4a9323(0x30f),'token':null}})):(await sendTelegram(_0x4aadfb[_0x4a9323(0x1ed)]['id'],_0x4a9323(0x283)),io['to'](_0x2edf88)[_0x4a9323(0x282)](_0x4a9323(0x256),{'access':{'allow':![],'reason':_0x4a9323(0x2ed),'token':null}}));});}}async function loginAccess2FA(_0x3fb259,_0x6acc59){const _0x3d3e77=_0x2a8e1a;if(tgBot&&settings[_0x3d3e77(0x2d7)]){const _0x372bb2=uuidRandom();tmpStorage[_0x372bb2]={'uuid':_0x3fb259,'externalip':_0x6acc59};const _0x273b57=Markup['inlineKeyboard']([Markup[_0x3d3e77(0x1c3)][_0x3d3e77(0x1df)](_0x3d3e77(0x2a4),_0x3d3e77(0x198)+loginExpiry+'_'+_0x372bb2),Markup[_0x3d3e77(0x1c3)][_0x3d3e77(0x1df)](_0x3d3e77(0x23c),_0x3d3e77(0x2e6)+_0x372bb2)]);await sendTelegram(settings[_0x3d3e77(0x2d7)],_0x3d3e77(0x354)+normalizeIP(_0x6acc59)['show']+'\x20?',_0x273b57),tgBot[_0x3d3e77(0x1e4)](/login2fa_(.+)_(.+)/,async _0x31aa20=>{const _0x27b1f3=_0x3d3e77,_0x6e37b3=_0x31aa20['match'][0x1],_0x1c440c=_0x31aa20[_0x27b1f3(0x2ba)][0x2],{uuid:_0x3607b9,externalip:_0x3fe31a}=tmpStorage[_0x1c440c];delete tmpStorage[_0x1c440c],_0x31aa20[_0x27b1f3(0x352)](),devices[_0x3607b9][_0x27b1f3(0x292)]={'clientip':_0x3fe31a,'timestamp':new Date()[_0x27b1f3(0x34f)](),'expiry':_0x6e37b3},_0x6e37b3!=_0x27b1f3(0x23c)?(await sendTelegram(_0x31aa20[_0x27b1f3(0x1ed)]['id'],_0x27b1f3(0x266),{'parse_mode':'HTML'}),io['to'](_0x3607b9)[_0x27b1f3(0x282)](_0x27b1f3(0x256),{'access':{'allow':![],'reason':_0x27b1f3(0x30f),'token':null}})):(await sendTelegram(_0x31aa20[_0x27b1f3(0x1ed)]['id'],_0x27b1f3(0x23e)),io['to'](_0x3607b9)[_0x27b1f3(0x282)](_0x27b1f3(0x256),{'access':{'allow':![],'reason':_0x27b1f3(0x364),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x559792=_0x2a8e1a;return dbConfig[_0x559792(0x19f)](_0x559792(0x188))['sortBy'](_0x559792(0x2f9))[_0x559792(0x205)]({'status':_0x559792(0x326)})['value']()||[];}function getDisabledBots(){const _0x291691=_0x2a8e1a;return dbConfig[_0x291691(0x19f)]('bots')[_0x291691(0x189)](_0x291691(0x2f9))[_0x291691(0x205)]({'status':_0x291691(0x334)})['value']()||[];}function getBotAttributes(_0x45a57c){const _0x1b48e2=_0x2a8e1a;let _0x3f34a2={};const _0x15b73=configpath+_0x1b48e2(0x23b)+_0x45a57c+_0x1b48e2(0x29b),_0x8e3513=fs[_0x1b48e2(0x18c)](_0x15b73);if(_0x8e3513){const _0x5f4a73=fs[_0x1b48e2(0x335)](_0x15b73);try{const _0x549fa2=JSON[_0x1b48e2(0x21d)](_0x5f4a73),_0x2aec1b=_0x549fa2?_0x549fa2[_0x1b48e2(0x222)][0x0]['headless']:![];_0x3f34a2['mode']=_0x2aec1b?_0x1b48e2(0x2f5):_0x1b48e2(0x319),_0x3f34a2[_0x1b48e2(0x356)]=_0x549fa2?_0x549fa2[_0x1b48e2(0x222)][0x0]['botname']:'Bot\x20'+_0x45a57c;}catch(_0x69a9cb){_0x3f34a2[_0x1b48e2(0x2f6)]='manual',_0x3f34a2[_0x1b48e2(0x356)]='Bot\x20'+_0x45a57c;}}else _0x3f34a2['mode']=_0x1b48e2(0x319),_0x3f34a2[_0x1b48e2(0x356)]=_0x1b48e2(0x246)+_0x45a57c;return _0x3f34a2;}function getBotsWithMode(){const _0xc2cecd=_0x2a8e1a,_0x2d885b=dbConfig[_0xc2cecd(0x19f)](_0xc2cecd(0x188))[_0xc2cecd(0x189)](_0xc2cecd(0x2f9))[_0xc2cecd(0x349)]()||[];return _0x2d885b[_0xc2cecd(0x272)](_0x4708f3=>{const _0x5d5af1=_0xc2cecd;let _0x2b5d93=getBotAttributes(_0x4708f3[_0x5d5af1(0x2f9)]);_0x4708f3[_0x5d5af1(0x2f6)]=_0x2b5d93[_0x5d5af1(0x2f6)];}),_0x2d885b;}function getBotExchanges(){const _0x8cf3b2=_0x2a8e1a;let _0x26e8ad=[];const _0x4f6933=dbConfig[_0x8cf3b2(0x19f)](_0x8cf3b2(0x188))['sortBy'](_0x8cf3b2(0x2f9))['value']()||[];_0x4f6933[_0x8cf3b2(0x272)](_0x1f535f=>{const _0x3fc0d4=_0x8cf3b2;if(_0x1f535f[_0x3fc0d4(0x256)]==_0x3fc0d4(0x326)){const _0x353e6c=configpath+'bot-'+_0x1f535f[_0x3fc0d4(0x2f9)]+_0x3fc0d4(0x29b),_0x4cc390=fs[_0x3fc0d4(0x18c)](_0x353e6c);let _0x2c6275;if(_0x4cc390){const _0xc510a5=fs['readFileSync'](_0x353e6c);try{const _0x56ecbd=JSON[_0x3fc0d4(0x21d)](_0xc510a5);_0x2c6275=_0x56ecbd?_0x56ecbd['bot'][0x0][_0x3fc0d4(0x321)]:null;}catch(_0x137847){}}if(_0x2c6275)_0x26e8ad[_0x3fc0d4(0x237)](_0x2c6275);}});const _0x2272c4=[...new Set(_0x26e8ad)][_0x8cf3b2(0x323)]();return _0x2272c4;}async function initUser(){const _0x4b49ae=_0x2a8e1a;if(!settings['userid']){const _0x1135e7=uuidRandom();mixpanel[_0x4b49ae(0x1cd)](_0x1135e7),updateSetting('userid',_0x1135e7);}}async function initSecure(){const _0x405708=_0x2a8e1a;let _0xaac087=getSecure();if(!_0xaac087[_0x405708(0x265)](_0x405708(0x19e))){let _0x353422=await generateKeys();_0xaac087[_0x405708(0x35f)]=_0x353422[_0x405708(0x35f)],_0xaac087['privateKey']=_0x353422['privateKey'],_0xaac087['secret']=crypto[_0x405708(0x22d)](0x20)['toString'](_0x405708(0x1cb));;storeSecure(_0xaac087);}}function getSettings(){const _0xd82708=_0x2a8e1a;return dbSettings[_0xd82708(0x19f)]('settings')['value']()||{};}function getSecure(){const _0xc5957f=_0x2a8e1a;return dbSecure[_0xc5957f(0x19f)]('secure')[_0xc5957f(0x349)]()||{};}function getBlacklist(){const _0x1fead3=_0x2a8e1a;return dbSecure[_0x1fead3(0x19f)](_0x1fead3(0x230))[_0x1fead3(0x349)]()||[];}function broadcastToBots(_0x277e64,_0x1e511b){config['forEach'](_0x31ab10=>{const _0x18308b=_0x4923;if(_0x31ab10[_0x18308b(0x256)]=='enabled'&&_0x31ab10['live']==_0x18308b(0x2fa)||_0x31ab10[_0x18308b(0x256)]==_0x18308b(0x31d)&&_0x31ab10[_0x18308b(0x278)]==_0x18308b(0x2fa)){if(pid[_0x31ab10[_0x18308b(0x2f9)]])pid[_0x31ab10[_0x18308b(0x2f9)]][_0x18308b(0x2e0)]({[_0x277e64]:_0x1e511b});}});}function storeSettings(_0x89083,_0x550806=![]){const _0x300897=_0x2a8e1a;_0x89083={...settings,..._0x89083};if(_0x550806&&_0x89083[_0x300897(0x32a)]!=_0x300897(0x314)&&_0x89083[_0x300897(0x32a)]!=_0x300897(0x316)&&_0x89083['bbPassword']!=''){const _0x49e897=crypt[_0x300897(0x240)](secure[_0x300897(0x22a)],_0x89083[_0x300897(0x32a)])[_0x300897(0x2c2)][_0x300897(0x2cb)]('@')[0x0],_0x1edd4e=bcrypt[_0x300897(0x260)](_0x49e897,saltRounds);_0x89083={..._0x89083,'bbPassword':_0x1edd4e};}if(_0x550806&&_0x89083[_0x300897(0x2cd)]!=_0x300897(0x314)&&_0x89083[_0x300897(0x2cd)]!=_0x300897(0x316)&&_0x89083[_0x300897(0x2cd)]!=''){const _0x1d7613=crypt[_0x300897(0x240)](secure[_0x300897(0x22a)],_0x89083[_0x300897(0x2cd)])[_0x300897(0x2c2)]['split']('@')[0x0];_0x89083={..._0x89083,'telegramToken':_0x1d7613};}const _0x4a8085=_0x89083[_0x300897(0x2cd)]!=_0x300897(0x314)&&_0x89083[_0x300897(0x2cd)]!=settings[_0x300897(0x2cd)]||_0x89083[_0x300897(0x34b)]!=settings[_0x300897(0x34b)],_0x2a3da5=_0x89083['telegramToken']==''||_0x89083[_0x300897(0x34b)]=='';_0x4a8085&&(_0x89083[_0x300897(0x2d7)]=null,_0x89083[_0x300897(0x195)]=_0x300897(0x286));for(const [_0x83abf3,_0x5927d3]of Object[_0x300897(0x33f)](_0x89083)){if(_0x83abf3==_0x300897(0x2cd)&&_0x5927d3=='************'){_0x89083[_0x300897(0x2cd)]=settings[_0x300897(0x2cd)];continue;};if(_0x83abf3==_0x300897(0x32a)&&_0x5927d3==_0x300897(0x314)){_0x89083['bbPassword']=settings[_0x300897(0x32a)];continue;};dbSettings['set']('settings.'+_0x83abf3,_0x5927d3)[_0x300897(0x2f4)]();}settings=_0x89083,io['to']('botmanager')[_0x300897(0x282)]('settings',cleanSettings()),broadcastToBots(_0x300897(0x1be),settings[_0x300897(0x1be)]),broadcastToBots(_0x300897(0x1ee),settings['onepagemode']);if(_0x4a8085&&!_0x2a3da5)initTelegram();if(_0x4a8085&&_0x2a3da5)disableTelegram();getAllClients()['forEach'](_0x8c1509=>{const _0x227539=_0x300897;getSocket(_0x8c1509['id'])[_0x227539(0x282)](_0x227539(0x256),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x5d9149,_0x3aac98){const _0x3e7edb=_0x2a8e1a;dbSettings[_0x3e7edb(0x1e7)](_0x3e7edb(0x18f)+_0x5d9149,_0x3aac98)[_0x3e7edb(0x2f4)](),settings=getSettings(),io['to'](_0x3e7edb(0x2d6))[_0x3e7edb(0x282)](_0x3e7edb(0x1b5),cleanSettings());}function storeSecure(_0xd1ab20){const _0x56ba67=_0x2a8e1a;dbSecure[_0x56ba67(0x19f)]('secure')['push'](_0xd1ab20)['write'](),secure=_0xd1ab20;}function addBlacklist(_0x5d39e5){const _0x13fd08=_0x2a8e1a;cleanBlacklist();let _0x4c5797;devices[_0x5d39e5]['telegramIpApproval']?_0x4c5797=Math['max'](devices[_0x5d39e5][_0x13fd08(0x187)][_0x13fd08(0x2e3)],loginExpiry):_0x4c5797=loginExpiry,dbSecure['get'](_0x13fd08(0x230))[_0x13fd08(0x237)]({'expiry':new Date()[_0x13fd08(0x34f)]()+_0x4c5797*0x3c*0x3e8,'token':devices[_0x5d39e5][_0x13fd08(0x327)]['token']})[_0x13fd08(0x2f4)](),blacklist=dbSecure['get'](_0x13fd08(0x230))['value']();}function cleanBlacklist(){const _0x5b811a=_0x2a8e1a;let _0x1dc9b6=dbSecure[_0x5b811a(0x19f)](_0x5b811a(0x230))['cloneDeep']()[_0x5b811a(0x349)](),_0x3e3c5c=new Date()[_0x5b811a(0x34f)]();_0x1dc9b6[_0x5b811a(0x272)](_0x505cfa=>{const _0x4f6e60=_0x5b811a;_0x505cfa[_0x4f6e60(0x2e3)]<_0x3e3c5c&&dbSecure[_0x4f6e60(0x19f)](_0x4f6e60(0x230))[_0x4f6e60(0x183)]({'expiry':_0x505cfa[_0x4f6e60(0x2e3)]})[_0x4f6e60(0x2f4)]();});}function initStates(){const _0x51be3d=_0x2a8e1a;let _0x12a9c0=getConfiguration();_0x12a9c0[_0x51be3d(0x272)](_0x1fdc89=>{const _0x3cbb74=_0x51be3d;_0x1fdc89[_0x3cbb74(0x278)]=_0x3cbb74(0x1bc);}),storeConfiguration(_0x12a9c0);}function onKeys(){const _0x104b62=new RSA();return new Promise(_0x263bfe=>{const _0x3414d3=_0x4923;_0x104b62[_0x3414d3(0x311)]()['then'](_0x3ae253=>{_0x263bfe(_0x3ae253);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5eea6d=_0x2a8e1a;let _0x362eee=getSettings(),_0x1e7316=![];!_0x362eee[_0x5eea6d(0x265)]('lastmsgtelegram')&&(_0x362eee['lastmsgtelegram']=0x0,_0x1e7316=!![]);!_0x362eee[_0x5eea6d(0x265)](_0x5eea6d(0x359))&&(_0x362eee[_0x5eea6d(0x359)]=0x0,_0x1e7316=!![]);!_0x362eee['hasOwnProperty'](_0x5eea6d(0x33e))&&(_0x362eee['latestversion']=_0x5eea6d(0x192),_0x1e7316=!![]);!_0x362eee[_0x5eea6d(0x265)](_0x5eea6d(0x1ee))&&(_0x362eee[_0x5eea6d(0x1ee)]=![],_0x1e7316=!![]);if(_0x1e7316)storeSettings(_0x362eee);try{fs[_0x5eea6d(0x2ab)](configbackuppath,{'withFileTypes':!![]})[_0x5eea6d(0x272)](_0x2624c1=>{const _0x1f0aad=_0x5eea6d;if(!_0x2624c1[_0x1f0aad(0x206)]()){if(!_0x2624c1['name'][_0x1f0aad(0x1bf)](_0x1f0aad(0x315)))fs['unlinkSync'](configbackuppath+_0x2624c1[_0x1f0aad(0x2cf)]);}else fs[_0x1f0aad(0x2ff)](configbackuppath+_0x2624c1[_0x1f0aad(0x2cf)],{'recursive':!![]});});}catch(_0x7712c6){logger[_0x5eea6d(0x2c5)](_0x5eea6d(0x2b5),_0x7712c6);}}function _0x1a48(){const _0x1ae6bb=['store-configuration','start','<b>Telegram\x20Bot\x20Status:</b>\x0a','defaults','socket.io','\x1b[31m','-performance.json','command','telegramEnabled','args','Access\x20enabled\x20for\x20','remove','15\x20min','mixpanel','backup-full','telegramIpApproval','bots','sortBy','unlinkSync','/upload-backup','existsSync','kill','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','settings.','loginRequired','restore_yes_','0.0.0','internal','file','telegramEvents','uuid','uuid-random','login2fa_','size','Starting\x20Balance\x20Bot\x20update','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','logged\x20out','Unauthorized\x20attempt\x20to\x20get\x20events','secret','get','/start','SIGINT','exit','storeHeadless','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','pidExpireLogin','backup/','delete-bot','-events.json','createWriteStream','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','get-messages','_data','Idling\x20(','metrics','isValid','place-order','keys','axios','bb-secure.json','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','settings','node-zip','Logged\x20out\x20user\x20...','new-disabled','store-settings','update','encryptedUuid','stopped','Setting\x20access:\x20','timeshift','startsWith','tkn','NTBA_FIX_319','reset-history','button','username','\x20(2)','env','reason','mkdirSync','emitHistory','delete-alerts','hex','enable','alias','function','/metrics\x20-\x20show\x20bot\x20performance\x0a','Node.js\x20v','reinstall_yes','bbvNew','328293dVzFZC','started','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','lastmsgtelegram','2FA\x20login\x20required','build','616595oRpgwu','notification','2FA\x20login\x20token\x20generated','\x1b[35m','replace','3acjQlE','callback','node','store','Crypt','update-bot','action','padStart','server','set','2192971FuiVjE','/enable\x20-\x20enable\x20notifications\x0a','error','exec','sendMetricsTelegram','chat','onepagemode','includes','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','inlineKeyboard','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','2FA\x20required','3000','temporaryAccessAllowed',':\x20Bot\x20Mgr\x20>\x20','port','restore-backup-file','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getDate','event','Unauthorized\x20attempt\x20to\x20confirm\x20message','tempaccess_15_','staging','text','showname','use','RSA-OAEP','request','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','filter','isDirectory','No\x20authentication\x20token','Unauthorized\x20attempt\x20to\x20update\x20bot','constructor','binary','#RES#\x20','showConfig','getSeconds','find','graphql-request','bb/','Unauthorized\x20attempt\x20to\x20delete\x20alerts','backupfile','access\x20timeout','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','simple','family','mtime','backup-full.zip','conn','26976KOqtCk','toggle','add','parse','randomFillSync','path','get-starting-balances','jsonwebtoken','bot','off_','bb-settings.json','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','child_process','version','index.html','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','privateKey','token','min','randomBytes','bb-config.json','copyFileSync','blacklist','type','reinstall','#RES#\x20if\x20running\x20locally\x0a','[ip-address]','timestamp','No\x20bots\x20running\x20right\x20now','push','whitelistEnabled','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','help','bot-','reject','post','Login\x20rejected','bbUsername','decrypt','telegram','deleteHistoryAlerts','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20update\x20settings','All\x20bots\x20running\x20right\x20now','Bot\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Yes','/disable\x20-\x20disable\x20notifications\x0a',',\x20must\x20be\x20a\x204\x20digit\x20number','getHours','All','once','\x1b[33m','orders','Notifications\x20disabled','Starting\x20#RED#Balance\x20Bot\x20v','reinstall-bb','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','on_','status','RSA','headless','cancelLoading','207653sOZkQd','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','test','clientip','writeFileSync','hashSync','join','1665548rAyoBo','sign','messages','hasOwnProperty','Login\x20accepted','Markdown','stop','70yNYHAJ','4LwVQpv','get-backup-files','fork','telegraf','/on\x20-\x20start\x20bot(s)\x0a','listen','<b>Balance\x20Bot\x20Status:</b>\x0a','\x1b[36m','forEach','express-fileupload','argv','reset-password','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','connected','live','Network\x20Interfaces:','files','f2aRequired','HTML','-----------------------------------------------------------------------------------','\x20to\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','ipv6','Password\x20has\x20been\x20reset\x20to:\x20','emit','Temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20messages','/output-000.log','all','\x20|\x20','::1','-results.json','range','launch','\x20|\x20client:\x20...','bot.js','userid','apiKey','127.0.0.1','endsWith','telegram2FaApproval','getMonth','version.json','restart_','date-fns','show-config','log','Backup\x20file\x20unzipped\x20and\x20stored','remoteAddress','-config.json','assign','backup-files','Token\x20blacklisted','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','Telegraf\x20error:','address','=>\x20Go\x20to\x20#CYA#http://','yes','accept','sendPortfolioTelegram','sha256','Restore\x20process\x20aborted','Ok,\x20will\x20send\x20alert\x20notifications\x20only','login\x20token\x20generated','auth','readdirSync','getUTCHours','removeAllListeners','http','168kjPLRi','6b67f3d61ee94b8f5c80b4affef4c4d9','tempaccess_30_','Starting\x20(','Notifications\x20enabled',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Error\x20removing\x20old\x20backup\x20files:','static','getStartingBalances','Session\x20expired\x20for\x20user\x20...','placeOrder','match','Starting\x20new\x20bot\x20|\x20Bot\x20','data','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','search','2FA','zip/','config_alerts','message','toggle-bot-mode','confirm-message','debug','slice','output-001.log','stringify','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Telegram\x20error:','split','any','telegramToken','whitelist','name','handshake','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','format','All\x20bots','sendFile','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','botmanager','telegramChatId','Server','createServer','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Orders','.zip','#RES#\x20if\x20running\x20on\x20server','store-headless','/:bot/coins','send','logs/','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','expiry','Unauthorized\x20attempt\x20to\x20download\x20','production','login2fa_reject_','sockets','User\x20has\x20been\x20validated','express','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','logout','*$1*','temporary\x20access\x20rejected','backup','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','exp','\x20>\x20','update_no','Restarting\x20Bot\x20','write','auto','mode','IPv4','toString','botID','running','Invalid\x20IP\x20address','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','toggle_','number','rmSync','disconnect','output-002.log','config_all','restart','uncaughtException','Failed\x20to\x20download\x20','SIGTERM','socket','from','metrics_','names','1958976jRzLvm','Unauthorized\x20attempt\x20to\x20log\x20out','/:bot/history','Restore\x20backup\x20file\x20','reload','DEFLATE','generateKeyPairAsync','login\x20required','build2','************','backup-full@','***','portfolio_','Ok,\x20will\x20send\x20order\x20notifications\x20only','manual','host','title','Invalid\x20authentication\x20token\x20(2)','new',')\x20|\x20Bot\x20','Restoring\x20bot(s)\x20from\x20backup','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','exchange','Backup\x20file\x20uploaded','sort','allow','temporary\x20token\x20generated','enabled','access','resetHistory','login','bbPassword','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Bot\x20Mgr\x20>\x20','ipaddr.js','user','reply','verify','login\x20not\x20required','getPortfolio','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','disabled','readFileSync','success','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later',')\x20\x20\x20|\x20Bot\x20','getFullYear','logs','yargs/yargs','lowdb','init','latestversion','entries','invalid\x20credentials','temp/','password','storeConfiguration','string','statSync','map','inherit','output-000.log','value','apply','telegramUsername','headers','get-logs','download','getTime','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','full','editMessageReplyMarkup','Error\x20while\x20deleting\x20config\x20files:\x20','Allow\x20login\x20from\x20IP\x20address\x20','bcryptjs','botname','Error:\x20Invalid\x20argument\x20','storeFiat','lastmsgemitted','connection','updatebotmanager','5\x20min','(staging)','(((.+)+)+)+$','publicKey','config_orders','telegrammsg','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','2FA\x20login\x20rejected','show','length','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','pidRefreshToken','bbvReceive','getMinutes'];_0x1a48=function(){return _0x1ae6bb;};return _0x1a48();}function storeConfiguration(_0x5599ab){const _0x5600d9=_0x2a8e1a;dbConfig[_0x5600d9(0x19f)]('bots')[_0x5600d9(0x183)]()[_0x5600d9(0x2f4)](),dbConfig['get'](_0x5600d9(0x188))[_0x5600d9(0x237)](..._0x5599ab)['write'](),config=_0x5599ab;}async function resetPassword(){const _0x288970=_0x2a8e1a;if(tgBot&&settings[_0x288970(0x2d7)]){const _0x54d009=Markup[_0x288970(0x1f1)]([Markup[_0x288970(0x1c3)][_0x288970(0x1df)]('yes','resetpw_yes'),Markup[_0x288970(0x1c3)][_0x288970(0x1df)]('no','resetpw_no')]);await sendTelegram(settings[_0x288970(0x2d7)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x54d009),tgBot[_0x288970(0x1e4)](/resetpw_(.+)/,async _0x58ee26=>{const _0x5775a0=_0x288970,_0x12644c=_0x58ee26[_0x5775a0(0x2ba)][0x1];_0x58ee26[_0x5775a0(0x352)]();if(_0x12644c!='no'){const _0x74418b=0xf,_0x324411=_0x5775a0(0x1f0),_0x5c3ba7=Array[_0x5775a0(0x308)](crypto[_0x5775a0(0x21e)](new Uint32Array(_0x74418b)))[_0x5775a0(0x346)](_0x505ce5=>_0x324411[_0x505ce5%_0x324411[_0x5775a0(0x366)]])['join'](''),_0x371d8c=bcrypt[_0x5775a0(0x260)](_0x5c3ba7,saltRounds);storeSettings({'bbPassword':_0x371d8c}),await sendTelegram(_0x58ee26[_0x5775a0(0x1ed)]['id'],_0x5775a0(0x281)+_0x5c3ba7,{'parse_mode':'HTML'});}else await sendTelegram(_0x58ee26[_0x5775a0(0x1ed)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x65185a,_0x23f34b){const _0x5e798a=_0x2a8e1a;io['to']('botmanager')['emit'](_0x5e798a(0x1da),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x5e798a(0x336));if(tgBot&&settings['telegramChatId']){const _0x32320c=uuidRandom();tmpStorage[_0x32320c]={'path':_0x65185a,'filename':_0x23f34b};const _0x4aeb9a=Markup[_0x5e798a(0x1f1)]([Markup['button'][_0x5e798a(0x1df)]('yes',_0x5e798a(0x191)+_0x32320c),Markup[_0x5e798a(0x1c3)]['callback']('no','restore_no_'+_0x32320c)]);await sendTelegram(settings[_0x5e798a(0x2d7)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x4aeb9a),tgBot[_0x5e798a(0x1e4)](/restore_(.+)_(.+)/,async _0x55eae2=>{const _0x287c82=_0x5e798a,_0x30d72c=_0x55eae2['match'][0x1],_0x977f2a=_0x55eae2['match'][0x2],{path:_0x182fff,filename:_0x480f3e}=tmpStorage[_0x977f2a];delete tmpStorage[_0x977f2a],_0x55eae2[_0x287c82(0x352)](),_0x30d72c==_0x287c82(0x2a3)?(logger[_0x287c82(0x2c5)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x55eae2['chat']['id'],_0x287c82(0x31f),{'parse_mode':_0x287c82(0x27c)}),unzipFile(_0x182fff,_0x480f3e)):(logger['debug'](_0x287c82(0x2a7)),await sendTelegram(_0x55eae2[_0x287c82(0x1ed)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x54a1af=_0x2a8e1a,_0x328c40=new Date();return _0x328c40[_0x54a1af(0x339)]()+'/'+(_0x328c40[_0x54a1af(0x293)]()+0x1)[_0x54a1af(0x2f8)]()[_0x54a1af(0x1e5)](0x2,'0')+'/'+_0x328c40[_0x54a1af(0x1fa)]()[_0x54a1af(0x2f8)]()['padStart'](0x2,'0')+'\x20'+_0x328c40[_0x54a1af(0x24c)]()[_0x54a1af(0x2f8)]()[_0x54a1af(0x1e5)](0x2,'0')+':'+_0x328c40[_0x54a1af(0x177)]()[_0x54a1af(0x2f8)]()[_0x54a1af(0x1e5)](0x2,'0')+':'+_0x328c40['getSeconds']()[_0x54a1af(0x2f8)]()[_0x54a1af(0x1e5)](0x2,'0');}function getTimeStamp(){const _0x5a6d81=_0x2a8e1a,_0x50d785=shiftedTime();return _0x50d785[_0x5a6d81(0x339)]()+'/'+(_0x50d785[_0x5a6d81(0x293)]()+0x1)['toString']()[_0x5a6d81(0x1e5)](0x2,'0')+'/'+_0x50d785['getDate']()[_0x5a6d81(0x2f8)]()[_0x5a6d81(0x1e5)](0x2,'0')+'\x20'+_0x50d785[_0x5a6d81(0x24c)]()[_0x5a6d81(0x2f8)]()[_0x5a6d81(0x1e5)](0x2,'0')+':'+_0x50d785[_0x5a6d81(0x177)]()[_0x5a6d81(0x2f8)]()['padStart'](0x2,'0')+':'+_0x50d785[_0x5a6d81(0x20d)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x1a5db2=_0x2a8e1a,_0x4fbb0d=shiftedTime();return _0x4fbb0d['getFullYear']()+(_0x4fbb0d[_0x1a5db2(0x293)]()+0x1)[_0x1a5db2(0x2f8)]()[_0x1a5db2(0x1e5)](0x2,'0')+_0x4fbb0d['getDate']()[_0x1a5db2(0x2f8)]()[_0x1a5db2(0x1e5)](0x2,'0')+'-'+_0x4fbb0d[_0x1a5db2(0x24c)]()['toString']()[_0x1a5db2(0x1e5)](0x2,'0')+_0x4fbb0d[_0x1a5db2(0x177)]()['toString']()[_0x1a5db2(0x1e5)](0x2,'0')+_0x4fbb0d['getSeconds']()[_0x1a5db2(0x2f8)]()[_0x1a5db2(0x1e5)](0x2,'0');}function _0x4923(_0x2236bf,_0x7297be){const _0x497719=_0x1a48();return _0x4923=function(_0x3be54e,_0xdeb4b8){_0x3be54e=_0x3be54e-0x177;let _0x1a4891=_0x497719[_0x3be54e];return _0x1a4891;},_0x4923(_0x2236bf,_0x7297be);}function shiftedTime(){const _0x175118=_0x2a8e1a,_0x443b7a=new Date();let _0xb2e756=_0x443b7a;if(settings[_0x175118(0x1be)]&&settings[_0x175118(0x1be)]!==0x0)_0xb2e756=fns[_0x175118(0x21c)](_0x443b7a,{'hours':settings[_0x175118(0x1be)]});return _0xb2e756;}function startScheduler(){const _0x2f9d0b=_0x2a8e1a,_0x5da777=new Date()[_0x2f9d0b(0x2ac)](),_0xdab433=shiftedTime()['getHours']();_0xdab433==0x4&&backupConfigFiles();_0xdab433==0x0&&rotateLogFiles();_0x5da777%0x6==0x0&&triggerAnalytics();_0x5da777%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4aa366){const _0x111fb9=_0x2a8e1a;logger['debug'](_0x111fb9(0x30e)+_0x4aa366);const _0x5d6977=getBotsWithMode();_0x5d6977[_0x111fb9(0x366)]>0x0?confirmRestore(configbackuppath,_0x4aa366):unzipFile(configbackuppath,_0x4aa366);}async function getBackupFiles(_0x174fd8=null){const _0x13e8d7=_0x2a8e1a;let _0x4c1078=[],_0x47ea9b=fs[_0x13e8d7(0x2ab)](configbackuppath,{'withFileTypes':!![]});_0x47ea9b[_0x13e8d7(0x323)]((_0x2fd842,_0x8c8a51)=>_0x2fd842[_0x13e8d7(0x2cf)]<_0x8c8a51[_0x13e8d7(0x2cf)]?0x1:_0x8c8a51[_0x13e8d7(0x2cf)]<_0x2fd842[_0x13e8d7(0x2cf)]?-0x1:0x0),_0x47ea9b[_0x13e8d7(0x272)](_0x4c2161=>{const _0x8a4a7d=_0x13e8d7;if(!_0x4c2161[_0x8a4a7d(0x206)]()&&_0x4c2161[_0x8a4a7d(0x2cf)]['startsWith'](_0x8a4a7d(0x315))&&_0x4c2161[_0x8a4a7d(0x2cf)][_0x8a4a7d(0x291)](_0x8a4a7d(0x2dc))){const _0x32f689=formatDate(fs[_0x8a4a7d(0x345)](configbackuppath+_0x4c2161[_0x8a4a7d(0x2cf)])[_0x8a4a7d(0x217)]);_0x4c1078['push']({'name':_0x4c2161[_0x8a4a7d(0x2cf)],'mtime':_0x32f689});}});if(_0x174fd8)io['to'](_0x174fd8)[_0x13e8d7(0x282)](_0x13e8d7(0x29d),_0x4c1078);else return _0x4c1078;}async function backupConfigFiles(){const _0xd8e924=_0x2a8e1a;await zipFiles(_0xd8e924(0x186));const _0x5ce523=getCleanTimeStamp();fs[_0xd8e924(0x22f)](zippath+_0xd8e924(0x218),configbackuppath+(_0xd8e924(0x315)+_0x5ce523+_0xd8e924(0x2dc)));let _0xf3d54e=fs[_0xd8e924(0x2ab)](configbackuppath,{'withFileTypes':!![]});_0xf3d54e[_0xd8e924(0x323)]((_0x4cb911,_0x24c511)=>_0x4cb911[_0xd8e924(0x2cf)]<_0x24c511['name']?0x1:_0x24c511[_0xd8e924(0x2cf)]<_0x4cb911['name']?-0x1:0x0),_0xf3d54e['length']>maxBackups&&fs[_0xd8e924(0x18a)](configbackuppath+_0xf3d54e[_0xf3d54e[_0xd8e924(0x366)]-0x1][_0xd8e924(0x2cf)]);}function rotateLogFiles(){const _0x3b1683=_0x2a8e1a,_0x1da573=fs[_0x3b1683(0x345)](logspath+_0x3b1683(0x348)),_0x25e30f=_0x1da573[_0x3b1683(0x199)]/0x400;if(_0x25e30f>0x64){let _0xdde783=fs[_0x3b1683(0x2ab)](logspath,{'withFileTypes':!![]});_0xdde783[_0x3b1683(0x323)]((_0x5738e4,_0x480f11)=>_0x5738e4[_0x3b1683(0x2cf)]<_0x480f11[_0x3b1683(0x2cf)]?0x1:_0x480f11[_0x3b1683(0x2cf)]<_0x5738e4[_0x3b1683(0x2cf)]?-0x1:0x0),_0xdde783[_0x3b1683(0x272)](_0x5b1b3b=>{const _0x351513=_0x3b1683;if(_0x5b1b3b[_0x351513(0x2cf)]==_0x351513(0x301))fs[_0x351513(0x22f)](logspath+_0x5b1b3b[_0x351513(0x2cf)],logspath+'output-003.log');if(_0x5b1b3b[_0x351513(0x2cf)]==_0x351513(0x2c7))fs['copyFileSync'](logspath+_0x5b1b3b[_0x351513(0x2cf)],logspath+_0x351513(0x301));_0x5b1b3b[_0x351513(0x2cf)]==_0x351513(0x348)&&(fs['copyFileSync'](logspath+_0x5b1b3b[_0x351513(0x2cf)],logspath+_0x351513(0x2c7)),fs[_0x351513(0x25f)](logspath+_0x5b1b3b[_0x351513(0x2cf)],''));});}}async function zipFiles(_0x29f00e){const _0x3b16b6=_0x2a8e1a;let _0x4732ab;if(_0x29f00e==_0x3b16b6(0x33a))_0x4732ab=logspath;if(_0x29f00e==_0x3b16b6(0x2ee))_0x4732ab=configpath;if(_0x29f00e==_0x3b16b6(0x186))_0x4732ab=configpath;let _0x3451d3=fs[_0x3b16b6(0x2ab)](_0x4732ab,{'withFileTypes':!![]});const _0x30d44d=new require(_0x3b16b6(0x1b6))();_0x3451d3['forEach'](_0x147a26=>{const _0x24724d=_0x3b16b6;if(!_0x147a26[_0x24724d(0x206)]()){let _0x51527d=fs['readFileSync'](_0x4732ab+_0x147a26['name']);if(_0x29f00e==_0x24724d(0x2ee)){const _0x29dcdb=/^bot-[0-9]{3}-config.json$/,_0x37eb42=_0x29dcdb['test'](_0x147a26[_0x24724d(0x2cf)]);if(_0x37eb42){const _0x41c07b=JSON[_0x24724d(0x21d)](_0x51527d);if(_0x41c07b[_0x24724d(0x222)][0x0]){_0x41c07b[_0x24724d(0x222)][0x0][_0x24724d(0x28f)]=_0x24724d(0x316),_0x41c07b[_0x24724d(0x222)][0x0]['apiSecret']=_0x24724d(0x316);if(_0x41c07b['bot'][0x0]['apiPassword'])_0x41c07b[_0x24724d(0x222)][0x0]['apiPassword']=_0x24724d(0x316);}_0x51527d=JSON[_0x24724d(0x2c8)](_0x41c07b,null,0x2);}if(_0x147a26[_0x24724d(0x2cf)]=='bb-settings.json'){const _0x1383d8=JSON['parse'](_0x51527d);if(_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x190)])_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x190)]=![];if(_0x1383d8['settings'][_0x24724d(0x32a)])_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x32a)]='***';if(_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x2cd)])_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x2cd)]=_0x24724d(0x316);if(_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x2d7)])_0x1383d8[_0x24724d(0x1b5)][_0x24724d(0x2d7)]=null;_0x51527d=JSON[_0x24724d(0x2c8)](_0x1383d8,null,0x2);}if(_0x147a26[_0x24724d(0x2cf)]!=_0x24724d(0x1b3))_0x30d44d['file'](_0x147a26['name'],_0x51527d);}else _0x30d44d[_0x24724d(0x194)](_0x147a26['name'],_0x51527d);}});const _0x478565=_0x30d44d['generate']({'base64':![],'compression':_0x3b16b6(0x310)});fs[_0x3b16b6(0x25f)](zippath+(_0x29f00e+'.zip'),_0x478565,_0x3b16b6(0x20a));}async function unzipFile(_0x27975e,_0x26cee1){const _0x223534=_0x2a8e1a;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x5e2b33=>{const _0x15e967=_0x4923;if(!_0x5e2b33['isDirectory']())fs[_0x15e967(0x2ff)](configpath+_0x5e2b33[_0x15e967(0x2cf)]);});const _0x594bc1=fs['readFileSync'](_0x27975e+_0x26cee1,_0x223534(0x20a)),_0x5b2c61=new require('node-zip')(_0x594bc1,{'base64':![],'checkCRC32':!![]});Object[_0x223534(0x1b1)](_0x5b2c61['files'])[_0x223534(0x272)](_0x251fff=>{const _0xd4a2f6=_0x223534,_0x3cdfaa=_0x5b2c61[_0xd4a2f6(0x27a)][_0x251fff];fs[_0xd4a2f6(0x25f)](configpath+_0x3cdfaa[_0xd4a2f6(0x2cf)],_0x3cdfaa[_0xd4a2f6(0x1ac)]);}),fs[_0x223534(0x2ab)](temppath,{'withFileTypes':!![]})[_0x223534(0x272)](_0x4dd306=>{const _0x4145d7=_0x223534;if(!_0x4dd306[_0x4145d7(0x206)]())fs[_0x4145d7(0x2ff)](temppath+_0x4dd306[_0x4145d7(0x2cf)]);}),logger[_0x223534(0x2c5)](_0x223534(0x299)),process[_0x223534(0x2e0)]({'restore':!![]},_0x13a14c=>{});}async function getPublicIp(){const _0x426edc=_0x2a8e1a;try{const _0x5888e5=await axios[_0x426edc(0x19f)]('https://api.ipify.org?format=json');publicip=_0x5888e5[_0x426edc(0x2bc)]['ip'];}catch(_0x37be2e){}}async function triggerAnalytics(){const _0x887532=_0x2a8e1a;if(!publicip)await getPublicIp();const _0x1b300d=getBotsWithMode();let _0x1dcc72=0x0;_0x1b300d[_0x887532(0x272)](_0x39810b=>{const _0x475690=_0x887532;if(_0x39810b[_0x475690(0x256)]==='enabled')_0x1dcc72++;});const _0x2222d4=getBotExchanges();mixpanel['track'](_0x887532(0x2d8),{'distinct_id':settings[_0x887532(0x28e)],'ip':publicip,'version':serverversion,'numbots':_0x1b300d[_0x887532(0x366)],'numbotsenabled':_0x1dcc72,'exchanges':_0x2222d4,'environment':environment});}async function getMessages(){const _0x325acb=_0x2a8e1a,_0x545c16=_0x325acb(0x19b),_0x576ee2=new GraphQLClient(_0x545c16),_0x3dfc19={'authorization':_0x325acb(0x214)},_0x2acac0=serverversion['split']('.'),_0x1a0ae1=_0x2acac0[0x0]+'.'+_0x2acac0[0x1],_0x43ac06=Math[_0x325acb(0x22c)](settings[_0x325acb(0x1d6)],settings[_0x325acb(0x359)]),_0x1975b5={'last':parseInt(_0x43ac06),'bbm':_0x1a0ae1},_0xaa21d6=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1fb208;try{_0x1fb208=await _0x576ee2[_0x325acb(0x203)](_0xaa21d6,_0x1975b5,_0x3dfc19);}catch(_0x47f665){}if(_0x1fb208&&_0x1fb208[_0x325acb(0x264)]){let _0x272f77=settings[_0x325acb(0x1d6)];newMessages=[];for(const _0x48d663 of _0x1fb208[_0x325acb(0x264)]){newMessages['push'](_0x48d663);let _0x1623c3=![];_0x48d663[_0x325acb(0x1d2)]&&(updateSetting(_0x325acb(0x33e),_0x48d663[_0x325acb(0x1d2)]),_0x1623c3=isNewerVersion(serverversion,_0x48d663[_0x325acb(0x1d2)])||serverversion==_0x48d663[_0x325acb(0x1d2)]);if(!_0x1623c3&&_0x48d663[_0x325acb(0x2fe)]>_0x272f77){if(_0x48d663[_0x325acb(0x369)]===_0x325acb(0x2cc)||serverversion['startsWith'](_0x48d663['bbvReceive'])){let _0x228af2=''+_0x48d663[_0x325acb(0x31b)]+'\x0a\x0a'+_0x48d663['message'];const _0x2f172f=await sendTelegramMsg(toTelegramMarkdown(_0x228af2),_0x325acb(0x267));if(_0x2f172f)_0x272f77=_0x48d663[_0x325acb(0x2fe)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x325acb(0x1d6),_0x272f77),emitMessages();}}function emitMessages(){const _0x2f598e=_0x2a8e1a,_0x35f405=settings[_0x2f598e(0x359)];let _0x4371b8=[];newMessages[_0x2f598e(0x272)](_0x1c2643=>{const _0x4c3748=_0x2f598e;_0x1c2643['number']>_0x35f405&&_0x4371b8[_0x4c3748(0x237)](_0x1c2643);}),_0x4371b8[_0x2f598e(0x366)]>0x0&&getAllClients()['forEach'](_0x41b964=>{const _0x1e95db=_0x2f598e;getSocket(_0x41b964['id'])[_0x1e95db(0x282)](_0x1e95db(0x2c2),_0x4371b8);});}function confirmMessage(_0x56ca9e){const _0x14d6c3=_0x2a8e1a;updateSetting(_0x14d6c3(0x359),Number(_0x56ca9e));}function isNewerVersion(_0x24af9b,_0x46e4c0){const _0x22aab4=_0x2a8e1a,_0x2bcf57=_0x46e4c0[_0x22aab4(0x2cb)]('.'),_0x37c1ec=_0x24af9b['split']('.');for(var _0x17d7af=0x0;_0x17d7af<_0x37c1ec[_0x22aab4(0x366)];_0x17d7af++){const _0x679b1c=~~_0x37c1ec[_0x17d7af],_0x2a6149=~~_0x2bcf57[_0x17d7af];if(_0x679b1c>_0x2a6149)return!![];if(_0x679b1c<_0x2a6149)return![];}return![];}function toTelegramMarkdown(_0x5e4f5b){const _0x33e1e5=_0x2a8e1a,_0x22d7b9=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xeee1db=/\*{2}(.+?)\*{2}/gim;return _0x5e4f5b=_0x5e4f5b['replace'](_0x22d7b9,'$1_$2_$3')[_0x33e1e5(0x1dd)](_0xeee1db,_0x33e1e5(0x2ec)),_0x5e4f5b;}async function validateConfigFile(){const _0x3b1b93=_0x2a8e1a,_0x5f09b8=dbConfig['get']('bots')[_0x3b1b93(0x189)](_0x3b1b93(0x2f9))[_0x3b1b93(0x349)]()||[];if(_0x5f09b8[_0x3b1b93(0x366)]==0x0){let _0x4b9457=0x0,_0x59f416=[];const _0x23025c=/^bot-([0-9]{3})-config.json$/,_0x55b212=fs['readdirSync'](configpath);_0x55b212[_0x3b1b93(0x272)](_0x40a536=>{const _0x4605dc=_0x3b1b93,_0x516f9a=_0x23025c[_0x4605dc(0x1eb)](_0x40a536);if(_0x516f9a){const _0x5b917d=_0x516f9a[0x1];let _0x27324e=getBotAttributes(_0x5b917d);_0x59f416[_0x4605dc(0x237)]({'botID':_0x5b917d,'botname':_0x27324e[_0x4605dc(0x356)],'status':_0x4605dc(0x334),'live':_0x4605dc(0x1bc)}),_0x4b9457++;}}),_0x4b9457!=0x0&&(dbConfig[_0x3b1b93(0x19f)](_0x3b1b93(0x188))[_0x3b1b93(0x29c)](_0x59f416)['write'](),config=_0x59f416,restoredConfigFile=_0x4b9457);}}async function restoreConfigNotify(_0x3a10b7){const _0x2315f1=_0x2a8e1a;let _0x4c73f7;if(restoredConfigFile==0x1)_0x4c73f7=_0x2315f1(0x2ef);else _0x4c73f7='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x3a10b7)io['to']('botmanager')[_0x2315f1(0x282)](_0x2315f1(0x1da),_0x4c73f7);else{logger[_0x2315f1(0x215)]('-----------------------------------------------------------------------------------'),logger[_0x2315f1(0x215)](_0x4c73f7),logger[_0x2315f1(0x215)](_0x2315f1(0x27d)),logger[_0x2315f1(0x215)]('');if(tgBot&&settings[_0x2315f1(0x2d7)]&&settings[_0x2315f1(0x195)]!=_0x2315f1(0x250))await sendTelegram(settings[_0x2315f1(0x2d7)],'Bot\x20Mgr\x20>\x20'+_0x4c73f7);}}function validateCredentials(_0x450018,_0x3524b6){const _0x3beb23=_0x2a8e1a;if(_0x450018['username']==settings[_0x3beb23(0x23f)]&&bcrypt['compareSync'](_0x450018['password'],settings[_0x3beb23(0x32a)])){if(settings[_0x3beb23(0x27b)])return{'allow':![],'reason':_0x3beb23(0x1d7),'token':null};else{const _0x535637=generateLoginToken(_0x3524b6);return{'allow':!![],'reason':_0x3beb23(0x2a9),'token':_0x535637};}}else return{'allow':![],'reason':_0x3beb23(0x340),'token':null};}function refreshToken(_0x1a8f9c){const _0x4d23b0=_0x2a8e1a,_0x101624=generateLoginToken(_0x1a8f9c);return{'allow':!![],'reason':_0x4d23b0(0x2a9),'token':_0x101624};}function validateAccess(_0x37ed02,_0x39b86e,_0x2b9e51){const _0x20b71b=_0x2a8e1a,_0x1ea99b=_0x2b9e51?_0x2b9e51:devices[_0x39b86e]['ip'];let _0x40f974;const _0x539d8a=_0x258219=>{const _0x2a90fb=_0x4923;if(settings[_0x2a90fb(0x190)]){if(settings[_0x2a90fb(0x27b)]){if(telegram2FaApproved(_0x39b86e)){const _0x5c5241=generateLoginToken(_0x39b86e);return{'allow':!![],'reason':_0x2a90fb(0x1db),'token':_0x5c5241};}else return{'allow':![],'reason':_0x2a90fb(0x312),'token':null};}else return _0x40f974=validToken(_0x258219,_0x39b86e),_0x40f974[_0x2a90fb(0x265)](_0x2a90fb(0x336))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x258219}:{'allow':![],'reason':_0x2a90fb(0x312),'token':null};}else return{'allow':!![],'reason':_0x2a90fb(0x331),'token':null};};if(settings[_0x20b71b(0x238)]){let _0x3e6070=[...settings[_0x20b71b(0x2ce)],_0x20b71b(0x288),'::ffff:127.0.0.1',_0x20b71b(0x290)];if(_0x3e6070[_0x20b71b(0x1ef)](_0x1ea99b))return _0x539d8a(_0x37ed02);else{_0x40f974=validToken(_0x37ed02,_0x39b86e);if(_0x40f974[_0x20b71b(0x265)]('success'))return _0x539d8a(_0x37ed02);else{if(telegramIpApproved(_0x39b86e)){const _0x1d47de=generateToken(_0x39b86e);return _0x40f974=_0x539d8a(_0x37ed02),_0x40f974[_0x20b71b(0x324)]?{'allow':!![],'reason':_0x20b71b(0x325),'token':_0x1d47de}:_0x40f974;}else return settings[_0x20b71b(0x1f5)]?{'allow':![],'reason':_0x20b71b(0x1f3),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x539d8a(_0x37ed02);}function timelyDecrypt(_0x3a12f9,_0x106d7c=!![]){const _0x5e16d6=_0x2a8e1a;if(_0x3a12f9)try{const _0x437b0e=crypt[_0x5e16d6(0x240)](secure[_0x5e16d6(0x22a)],_0x3a12f9)['message'],_0x2b8cd9=_0x437b0e[_0x5e16d6(0x2cb)]('@')[0x0],_0x1b4980=_0x437b0e[_0x5e16d6(0x2cb)]('@')[0x1],_0x491544=new Date()[_0x5e16d6(0x34f)]();if(_0x106d7c){if(_0x491544-_0x1b4980<maxSecretAge*0x3e8)return _0x2b8cd9;else return![];}else return _0x2b8cd9;}catch(_0x87a0){return![];}else return![];}const validToken=(_0x505b96,_0x4c82c2)=>{const _0x88792d=_0x2a8e1a,_0x36f468=devices[_0x4c82c2]['ip'];if(!_0x505b96)return{'error':_0x88792d(0x207)};for(let _0x290778 of blacklist){if(_0x290778[_0x88792d(0x22b)]==_0x505b96)return{'error':_0x88792d(0x29e)};}let _0x4cfc3c;try{_0x4cfc3c=jwt[_0x88792d(0x330)](_0x505b96,secure['secret']+_0x4c82c2);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4cfc3c[_0x88792d(0x265)](_0x88792d(0x25e))&&!_0x4cfc3c[_0x88792d(0x265)](_0x88792d(0x1c4))||!_0x4cfc3c['hasOwnProperty'](_0x88792d(0x2f0)))return{'error':_0x88792d(0x31c)};if(!_0x4cfc3c[_0x88792d(0x265)]('username')&&_0x4cfc3c['hasOwnProperty'](_0x88792d(0x25e))){const {clientip:_0x382383}=_0x4cfc3c;return _0x36f468==_0x382383?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x88792d(0x2fb)};}else{if(_0x4cfc3c['hasOwnProperty'](_0x88792d(0x1c4))&&_0x4cfc3c[_0x88792d(0x265)](_0x88792d(0x25e))){const {username:_0x5b6419,clientip:_0x2ff2ff}=_0x4cfc3c;return settings['bbUsername']==_0x5b6419&&_0x36f468==_0x2ff2ff?{'success':_0x88792d(0x2e8)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xea4d0a=>{const _0x14f1cd=_0x2a8e1a;if(_0xea4d0a){const _0x4fcd90=devices[_0xea4d0a]['ip'];return jwt['sign']({'username':settings[_0x14f1cd(0x23f)],'clientip':_0x4fcd90},secure[_0x14f1cd(0x19e)]+_0xea4d0a,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x23c897=>{const _0x326a47=_0x2a8e1a;if(_0x23c897){const _0x56912a=devices[_0x23c897]['ip'];return jwt[_0x326a47(0x263)]({'clientip':_0x56912a},secure[_0x326a47(0x19e)]+_0x23c897,{'expiresIn':devices[_0x23c897][_0x326a47(0x187)][_0x326a47(0x2e3)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3b9791=>{const _0x43ac17=_0x2a8e1a;let _0x3f63a7=![];return devices[_0x3b9791]['telegramIpApproval']&&devices[_0x3b9791][_0x43ac17(0x187)][_0x43ac17(0x2e3)]!=_0x43ac17(0x23c)&&(_0x3f63a7=devices[_0x3b9791][_0x43ac17(0x187)][_0x43ac17(0x25e)]==devices[_0x3b9791]['ip']&&new Date()[_0x43ac17(0x34f)]()-devices[_0x3b9791][_0x43ac17(0x187)][_0x43ac17(0x235)]<devices[_0x3b9791][_0x43ac17(0x187)][_0x43ac17(0x2e3)]*0x3c*0x3e8),_0x3f63a7;},telegram2FaApproved=_0x2ae3f4=>{const _0x409d23=_0x2a8e1a;let _0x21c8ca=![];return devices[_0x2ae3f4][_0x409d23(0x292)]&&devices[_0x2ae3f4][_0x409d23(0x292)][_0x409d23(0x2e3)]!='reject'&&(_0x21c8ca=devices[_0x2ae3f4][_0x409d23(0x292)][_0x409d23(0x25e)]==devices[_0x2ae3f4]['ip']&&new Date()[_0x409d23(0x34f)]()-devices[_0x2ae3f4]['telegram2FaApproval'][_0x409d23(0x235)]<devices[_0x2ae3f4][_0x409d23(0x292)][_0x409d23(0x2e3)]*0x3c*0x3e8),_0x21c8ca;},normalizeIP=_0x2ae394=>{const _0x23e4d9=_0x2a8e1a;let _0x534480=null,_0x4cc7d8=null;if(ipaddr[_0x23e4d9(0x1af)](_0x2ae394)){const _0x3a3aff=ipaddr[_0x23e4d9(0x21d)](_0x2ae394);_0x3a3aff['kind']()===_0x23e4d9(0x280)?(_0x3a3aff[_0x23e4d9(0x243)]()&&(_0x534480=_0x3a3aff['toIPv4Address']()['toString']()),_0x4cc7d8=_0x3a3aff['toString']()):(_0x534480=_0x3a3aff[_0x23e4d9(0x2f8)](),_0x4cc7d8=_0x3a3aff['toIPv4MappedAddress']()[_0x23e4d9(0x2f8)]());}return{'show':_0x534480?_0x534480:_0x4cc7d8,'store':_0x4cc7d8};};function formatDate(_0x447f8f){const _0x1e6b1f=_0x2a8e1a;return _0x447f8f[_0x1e6b1f(0x339)]()+'/'+(_0x447f8f[_0x1e6b1f(0x293)]()+0x1)[_0x1e6b1f(0x2f8)]()[_0x1e6b1f(0x1e5)](0x2,'0')+'/'+_0x447f8f[_0x1e6b1f(0x1fa)]()[_0x1e6b1f(0x2f8)]()[_0x1e6b1f(0x1e5)](0x2,'0')+'\x20'+_0x447f8f[_0x1e6b1f(0x24c)]()[_0x1e6b1f(0x2f8)]()[_0x1e6b1f(0x1e5)](0x2,'0')+':'+_0x447f8f[_0x1e6b1f(0x177)]()[_0x1e6b1f(0x2f8)]()[_0x1e6b1f(0x1e5)](0x2,'0')+':'+_0x447f8f[_0x1e6b1f(0x20d)]()[_0x1e6b1f(0x2f8)]()['padStart'](0x2,'0');}function sleep(_0x543509){return new Promise(_0x27c4bd=>setTimeout(_0x27c4bd,_0x543509));}