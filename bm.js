const _0x4a7179=_0x2923;(function(_0x4fb369,_0x3eeab5){const _0x10ff6d=_0x2923,_0x17fef4=_0x4fb369();while(!![]){try{const _0x5c9f0d=-parseInt(_0x10ff6d(0xe1))/0x1+parseInt(_0x10ff6d(0x217))/0x2+parseInt(_0x10ff6d(0x159))/0x3+-parseInt(_0x10ff6d(0xea))/0x4+-parseInt(_0x10ff6d(0x1be))/0x5+-parseInt(_0x10ff6d(0x1e6))/0x6+parseInt(_0x10ff6d(0x15a))/0x7;if(_0x5c9f0d===_0x3eeab5)break;else _0x17fef4['push'](_0x17fef4['shift']());}catch(_0x4def61){_0x17fef4['push'](_0x17fef4['shift']());}}}(_0x4efd,0xe87b1));const _0x54ea23=function(){let _0x267032=!![];return function(_0x136b6a,_0x1bfabb){const _0x5eda22=_0x267032?function(){const _0xda54a5=_0x2923;if(_0x1bfabb){const _0x4c5582=_0x1bfabb[_0xda54a5(0x199)](_0x136b6a,arguments);return _0x1bfabb=null,_0x4c5582;}}:function(){};return _0x267032=![],_0x5eda22;};}(),_0xbf5b3=_0x54ea23(this,function(){const _0x404ecb=_0x2923;return _0xbf5b3[_0x404ecb(0x114)]()[_0x404ecb(0x18a)]('(((.+)+)+)+$')['toString']()[_0x404ecb(0x213)](_0xbf5b3)[_0x404ecb(0x18a)](_0x404ecb(0x196));});_0xbf5b3();'use strict';process[_0x4a7179(0x143)][_0x4a7179(0x19a)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x4a7179(0xe3)),low=require(_0x4a7179(0x188)),FileSync=require(_0x4a7179(0x11d)),path=require(_0x4a7179(0x23d)),crypto=require(_0x4a7179(0x1ec)),Crypt=require(_0x4a7179(0x136))[_0x4a7179(0x128)],RSA=require('hybrid-crypto-js')[_0x4a7179(0x11a)],bcrypt=require(_0x4a7179(0x12d)),jwt=require(_0x4a7179(0x146)),ipaddr=require(_0x4a7179(0x262)),argv=require('yargs/yargs')(process[_0x4a7179(0x168)][_0x4a7179(0x26f)](0x2))[_0x4a7179(0x168)],uuidRandom=require(_0x4a7179(0x26d)),TelegramBot=require(_0x4a7179(0x186)),Mixpanel=require('mixpanel'),axios=require(_0x4a7179(0x17f)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x4a7179(0x178)),{networkInterfaces}=require('os'),PORT=argv[_0x4a7179(0x263)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x4a7179(0x1f2)](PORT)&&(console[_0x4a7179(0x15f)](_0x4a7179(0x158)+PORT+_0x4a7179(0x15c)),process['exit'](0x1));const HOST=argv[_0x4a7179(0x154)]||null,userID=argv[_0x4a7179(0xf0)]||'',debugging=argv['d']||![],nodeversion=process[_0x4a7179(0x1b7)][_0x4a7179(0xd0)];let bbpath=_0x4a7179(0x167),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x4a7179(0x1a6),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4a7179(0xf2)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x4a7179(0x1e9),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x4a7179(0x1c5)+userID+'/':bbpath+_0x4a7179(0x1c5),zippath=userID?bbpath+_0x4a7179(0x161)+userID+'/':bbpath+_0x4a7179(0x161),loggerfile=fs[_0x4a7179(0x10f)](logspath+_0x4a7179(0x26c),{'flags':'a'}),temppath=userID?bbpath+_0x4a7179(0x22b)+userID+'/':bbpath+_0x4a7179(0x22b);!fs[_0x4a7179(0x1ba)](configpath)&&fs[_0x4a7179(0x138)](configpath);!fs[_0x4a7179(0x1ba)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4a7179(0x1ba)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs[_0x4a7179(0x138)](zippath);!fs[_0x4a7179(0x1ba)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x4a7179(0x18f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4a7179(0xd6)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4a7179(0x1e7),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4a7179(0xd6)]({'secure':{},'blacklist':[]})[_0x4a7179(0x18f)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x4a7179(0xbd)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4a7179(0x1b2)](_0x4a7179(0x206),{'host':_0x4a7179(0x208)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4a7179(0x113)]&&settings['telegramToken']!=''&&settings[_0x4a7179(0x26b)]&&settings[_0x4a7179(0x26b)]!='')initTelegram();const parseColor=(_0x51c16f,_0x470b25)=>{const _0x26c33b=_0x4a7179,_0x5c1925=/#[A-Z]{3}#/g;!_0x470b25?_0x51c16f=_0x51c16f[_0x26c33b(0xb8)](_0x5c1925,''):(_0x51c16f=_0x51c16f[_0x26c33b(0xb8)](/#BLU#/g,_0x26c33b(0x109)),_0x51c16f=_0x51c16f[_0x26c33b(0xb8)](/#RED#/g,_0x26c33b(0x1ee)),_0x51c16f=_0x51c16f[_0x26c33b(0xb8)](/#YEL#/g,'\x1b[33m'),_0x51c16f=_0x51c16f[_0x26c33b(0xb8)](/#RES#/g,'\x1b[0m'));;return _0x51c16f;},logger={'screen':_0x13ebef=>{const _0x5cb7fb=_0x4a7179;console[_0x5cb7fb(0x15f)](parseColor(_0x13ebef,!![]));},'simple':_0x4c76a5=>{const _0x1027b6=_0x4a7179;console[_0x1027b6(0x15f)](parseColor(_0x4c76a5,!![])),loggerfile['write'](util[_0x1027b6(0x260)](parseColor(_0x4c76a5,![]))+'\x0a');},'full':async _0x17fa2d=>{const _0x1470eb=_0x4a7179,_0x40ff52=getTimeStamp()+_0x1470eb(0x11f)+_0x17fa2d;console[_0x1470eb(0x15f)](parseColor(_0x40ff52,!![])),loggerfile['write'](util['format'](parseColor(_0x40ff52,![]))+'\x0a');if(tgBot&&settings[_0x1470eb(0xb6)]&&settings[_0x1470eb(0x187)]!=_0x1470eb(0x1eb))await tgBot[_0x1470eb(0x17e)](settings[_0x1470eb(0xb6)],_0x1470eb(0x257)+parseColor(_0x17fa2d,![]))[_0x1470eb(0x10e)](_0xb26267=>{telegramError(_0xb26267);});},'debug':async(_0xd4bf9a,_0x137cad='')=>{const _0x591164=_0x4a7179,_0x17910d=getTimeStamp()+_0x591164(0x139)+_0xd4bf9a;if(debugging)console[_0x591164(0x15f)](parseColor(_0x17910d,!![]));loggerfile['write'](util['format'](parseColor(_0x17910d,![]))+'\x0a');if(_0x137cad){if(debugging)console['log'](_0x137cad);loggerfile[_0x591164(0x18f)](util[_0x591164(0x260)](_0x137cad)+'\x0a');}}};process['on']('uncaughtException',function(_0x17c0a0){const _0x259d72=_0x4a7179;logger[_0x259d72(0x119)](_0x17c0a0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x4a7179(0x129))[_0x4a7179(0x153)](app);app[_0x4a7179(0xd1)](fileUpload({'useTempFiles':!![]})),app[_0x4a7179(0xd4)]('/download/:type',async(_0x15a8c9,_0x1b2237)=>{const _0x551d0e=_0x4a7179,_0x41db45=_0x15a8c9[_0x551d0e(0x1d2)][_0x551d0e(0x222)],_0x373016=getClientsWithBotID('botmanager'),_0xf2649a=_0x15a8c9[_0x551d0e(0x110)]['uuid'],_0x1a18c0=timelyDecrypt(_0xf2649a,![]),_0x332d28=_0x373016[_0x551d0e(0x1e8)](_0x26a592=>_0x26a592[_0x551d0e(0xb2)]==_0x1a18c0);if(_0x332d28){const _0x4aade0=normalizeIP(_0x15a8c9['socket'][_0x551d0e(0x1ce)])['store'],_0x3e1b16=_0x15a8c9[_0x551d0e(0x110)]['tkn'];if(validateAccess(_0x3e1b16,_0x1a18c0,_0x4aade0)[_0x551d0e(0x180)])_0x41db45==_0x551d0e(0x1da)&&await backupConfigFiles(),await zipFiles(_0x41db45),_0x1b2237[_0x551d0e(0x249)](zippath+(_0x41db45+_0x551d0e(0x232)),_0x1d9bf9=>{const _0x35e155=_0x551d0e;_0x1d9bf9&&(logger[_0x35e155(0x122)](_0x35e155(0x21d)+_0x41db45),logger[_0x35e155(0x119)](_0x1d9bf9));});else logger[_0x551d0e(0x122)](_0x551d0e(0x1b0)+_0x41db45+'\x20(1)');}else logger['full'](_0x551d0e(0x1b0)+_0x41db45+'\x20(2)');}),app['post']('/upload-backup',async(_0x2e4004,_0x18bee5)=>{const _0x355f36=_0x4a7179,_0x4a6a97=getClientsWithBotID(_0x355f36(0x165)),_0x55e2f9=_0x2e4004[_0x355f36(0x110)][_0x355f36(0xb2)],_0x529b3d=timelyDecrypt(_0x55e2f9,![]),_0x3df2ac=_0x4a6a97[_0x355f36(0x1e8)](_0x55e74b=>_0x55e74b['uuid']==_0x529b3d);logger[_0x355f36(0x20a)](_0x355f36(0x238));if(_0x3df2ac){const _0x1667d6=normalizeIP(_0x2e4004['socket']['remoteAddress'])[_0x355f36(0xed)],_0xd599cc=_0x2e4004[_0x355f36(0x110)][_0x355f36(0x1a0)];if(validateAccess(_0xd599cc,_0x529b3d,_0x1667d6)[_0x355f36(0x180)]){if(_0x2e4004[_0x355f36(0x239)]){const _0x44e369=_0x2e4004[_0x355f36(0x239)]['backupfile'];await _0x44e369['mv'](temppath+_0x44e369[_0x355f36(0x9d)]),_0x18bee5[_0x355f36(0x1f1)]({'status':!![],'message':_0x355f36(0x176)});const _0x2f9aa6=getBotsWithMode();_0x2f9aa6[_0x355f36(0x1ca)]>0x0?confirmRestore(temppath,_0x44e369[_0x355f36(0x9d)]):unzipFile(temppath,_0x44e369[_0x355f36(0x9d)]);}}else logger[_0x355f36(0x122)](_0x355f36(0xf4));}else logger[_0x355f36(0x122)](_0x355f36(0x9c));}),app['use'](express[_0x4a7179(0xa4)](path['join'](__dirname,bbpath2,_0x4a7179(0x23c)))),app[_0x4a7179(0xd1)](express[_0x4a7179(0xa4)](path[_0x4a7179(0x25b)](__dirname,bbpath2,'build'))),app[_0x4a7179(0xd4)]('/',function(_0x38ee9d,_0x541f82){const _0x4a0106=_0x4a7179;_0x541f82[_0x4a0106(0xc7)](path['join'](__dirname,bbpath2,_0x4a0106(0x23c),_0x4a0106(0x23f)));}),app[_0x4a7179(0xd4)](_0x4a7179(0x1ad),function(_0x501109,_0x45f3aa){const _0x3f2c21=_0x4a7179;_0x45f3aa[_0x3f2c21(0xc7)](path['join'](__dirname,bbpath2,'build',_0x3f2c21(0x23f)));}),app[_0x4a7179(0xd4)](_0x4a7179(0x229),(_0x3e713f,_0x5d85f8)=>{const _0x2aaf76=_0x4a7179;_0x5d85f8[_0x2aaf76(0xc7)](path['join'](__dirname,bbpath2,_0x2aaf76(0x116),'index.html'));}),app['get']('/:bot/performance',(_0x17bd5b,_0x582106)=>{const _0x5660a5=_0x4a7179;_0x582106['sendFile'](path['join'](__dirname,bbpath2,'build',_0x5660a5(0x23f)));}),app[_0x4a7179(0xd4)]('/:bot/coins',(_0x45a789,_0x259b2e)=>{const _0x43582e=_0x4a7179;_0x259b2e[_0x43582e(0xc7)](path[_0x43582e(0x25b)](__dirname,bbpath2,'build',_0x43582e(0x23f)));}),app[_0x4a7179(0xd4)](_0x4a7179(0x1c4),(_0xa4602c,_0x325223)=>{const _0x4d4251=_0x4a7179;_0x325223[_0x4d4251(0xc7)](path[_0x4d4251(0x25b)](__dirname,bbpath2,_0x4d4251(0x116),_0x4d4251(0x23f)));}),app[_0x4a7179(0xd4)](_0x4a7179(0x13c),(_0x30cbd4,_0x28fddb)=>{const _0xcc6e71=_0x4a7179;_0x28fddb[_0xcc6e71(0xc7)](path[_0xcc6e71(0x25b)](__dirname,bbpath2,_0xcc6e71(0x116),_0xcc6e71(0x23f)));}),app[_0x4a7179(0xd4)](_0x4a7179(0x9f),(_0x32a09f,_0x513ba8)=>{const _0xcd7efb=_0x4a7179;_0x513ba8['sendFile'](path[_0xcd7efb(0x25b)](__dirname,bbpath2,_0xcd7efb(0x116),_0xcd7efb(0x23f)));});if(HOST)http[_0x4a7179(0x107)](PORT,HOST);else http[_0x4a7179(0x107)](PORT);const io=require(_0x4a7179(0x20e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x150ca0=_0x4a7179;let _0x5d2353=_0x150ca0(0x164);const _0x315bb4=networkInterfaces(),_0x1645f0={};for(const _0x20b153 of Object[_0x150ca0(0x1f3)](_0x315bb4)){for(const _0x49135f of _0x315bb4[_0x20b153]){if((_0x49135f['family']==_0x150ca0(0x111)||_0x49135f[_0x150ca0(0x14a)]==0x4)&&!_0x49135f[_0x150ca0(0x16e)]){const _0xe451a3=ipaddr['parse'](_0x49135f[_0x150ca0(0x212)])[_0x150ca0(0x241)]();_0xe451a3!=_0x150ca0(0x220)&&(!_0x1645f0[_0x20b153]&&(_0x1645f0[_0x20b153]=[]),_0x1645f0[_0x20b153][_0x150ca0(0x18e)](_0x49135f[_0x150ca0(0x212)]),_0x5d2353=_0x49135f[_0x150ca0(0x212)]);}}}return logger[_0x150ca0(0x20a)](_0x150ca0(0x16c),_0x1645f0),_0x5d2353;}async function startServer(){const _0x279889=_0x4a7179;logger[_0x279889(0x119)](''),logger[_0x279889(0x119)](_0x279889(0x25f)),await logger['full'](_0x279889(0xf8)+serverversion+_0x279889(0x182)+(_0x279889(0x270)+PORT+_0x279889(0x19f))+(_0x279889(0x193)+getServerIP()+':'+PORT+_0x279889(0xf9))),await logger['debug'](_0x279889(0x244)+nodeversion),logger[_0x279889(0x119)](_0x279889(0x25f));if(config[_0x279889(0x1ca)]!=0x0)for(const _0x5dd85a of config){if(_0x5dd85a[_0x279889(0x170)]==_0x279889(0x265)||_0x5dd85a[_0x279889(0x170)]==_0x279889(0xb5))await logger[_0x279889(0x122)](_0x279889(0x271)+_0x5dd85a[_0x279889(0x155)]+'\x20|\x20'+_0x5dd85a['botname']),startBot([_0x5dd85a[_0x279889(0x155)],userID],{'cwd':bbpath},function(_0xc499f1){if(_0xc499f1)logger['full'](_0xc499f1);});else(_0x5dd85a[_0x279889(0x170)]==_0x279889(0x184)||_0x5dd85a[_0x279889(0x170)]==_0x279889(0x14f))&&await logger[_0x279889(0x122)](_0x279889(0xa9)+_0x5dd85a['botID']+'\x20|\x20'+_0x5dd85a[_0x279889(0x11c)]);}else!newBot&&logger['simple'](_0x279889(0xf6));if(newBot)addBot();logger[_0x279889(0x119)]('-----------------------------------------------------------------------------------'),logger[_0x279889(0x119)]('');}function startSocket(){const _0x4999c3=_0x4a7179;io['on'](_0x4999c3(0x246),_0x2b5e81=>{const _0x3121e9=_0x4999c3;let _0x5eeaf7,_0x457d5d,_0x368449,_0x1feae8,_0x2c2946;const _0x39946f=_0x2b5e81[_0x3121e9(0x223)][_0x3121e9(0x110)][_0x3121e9(0xee)];_0x457d5d=_0x39946f[_0x3121e9(0xfc)](/bot[0-9]{3}/);if(_0x457d5d)_0x368449=_0x457d5d[0x0]['match'](/[0-9]{3}/);if(_0x368449)_0x5eeaf7=_0x368449[0x0];else _0x5eeaf7=_0x3121e9(0x165);const _0x3f65cb=_0x2b5e81[_0x3121e9(0x223)]['auth'][_0x3121e9(0xc1)];if(!_0x3f65cb)_0x2b5e81[_0x3121e9(0x224)](_0x3121e9(0x170),{'publicKey':secure[_0x3121e9(0x251)]});else{_0x1feae8=timelyDecrypt(_0x3f65cb,![]);if(!_0x1feae8)_0x2b5e81[_0x3121e9(0x224)](_0x3121e9(0x170),{'publicKey':secure[_0x3121e9(0x251)]});else{_0x2c2946=normalizeIP(_0x2b5e81[_0x3121e9(0x230)]['remoteAddress'])[_0x3121e9(0xed)];if(!devices[_0x1feae8])devices[_0x1feae8]={'uuid':_0x1feae8,'access':{'token':null}};devices[_0x1feae8]['ip']=_0x2c2946;const _0x3ef2ca=addClient(_0x2b5e81['id'],_0x1feae8,_0x5eeaf7);setAccess(_0x3ef2ca),emitMessages(),_0x2b5e81['on']('login',_0x74cc4a=>{const _0x45b09c=_0x3121e9,_0x3cd940=timelyDecrypt(_0x74cc4a['password']);if(_0x3cd940){_0x74cc4a={'username':_0x74cc4a['username'],'password':_0x3cd940},devices[_0x1feae8]['access']=validateCredentials(_0x74cc4a,_0x1feae8);if(devices[_0x1feae8][_0x45b09c(0xe0)][_0x45b09c(0x180)]==![]&&devices[_0x1feae8][_0x45b09c(0xe0)][_0x45b09c(0xc2)]==_0x45b09c(0x26e))_0x2b5e81['emit']('status',{'access':devices[_0x1feae8][_0x45b09c(0xe0)]}),loginAccess2FA(_0x1feae8,_0x2c2946);else{if(devices[_0x1feae8][_0x45b09c(0xe0)][_0x45b09c(0x180)]==![]&&devices[_0x1feae8][_0x45b09c(0xe0)][_0x45b09c(0xc2)]==_0x45b09c(0x22a))_0x2b5e81['emit']('status',{'access':devices[_0x1feae8]['access']});else devices[_0x1feae8]['access'][_0x45b09c(0x180)]&&devices[_0x1feae8][_0x45b09c(0xe0)][_0x45b09c(0xc2)]==_0x45b09c(0x12f)&&(getClientsWithUuid(_0x1feae8)[_0x45b09c(0x1ea)](_0x4103c3=>{setAccess(_0x4103c3);}),logger['debug'](_0x45b09c(0x134)+_0x1feae8[_0x45b09c(0x26f)](-0x8)),setTokenRefresh(_0x1feae8),setSessionTimeout(_0x45b09c(0x21a),_0x1feae8));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2b5e81['on'](_0x3121e9(0x12c),()=>{resetPassword();}),_0x2b5e81['on']('disconnect',_0x43539f=>{removeClient(_0x2b5e81['id']);}),_0x5eeaf7==_0x3121e9(0x165)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3efea8){const _0x21f9d3=_0x4a7179;if(_0x3efea8!=_0x21f9d3(0x165)&&config[_0x21f9d3(0xa3)]!=''){if(pid[_0x3efea8])pid[_0x3efea8]['send']({'function':_0x21f9d3(0x12a),'args':null});}_0x3efea8!=_0x21f9d3(0x165)&&broadcastToBots(_0x21f9d3(0x130),JSON['stringify'](config));}function reloadBotManager(){const _0x329e82=_0x4a7179;getClientsWithBotID(_0x329e82(0x165))[_0x329e82(0x1ea)](_0x511af7=>{const _0x592183=_0x329e82;getSocket(_0x511af7['id'])[_0x592183(0x224)](_0x592183(0x170),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0xf5ac10){const _0x43ab39=_0x4a7179;return io['sockets']['sockets'][_0x43ab39(0xd4)](_0xf5ac10);}function setAccess(_0x5bb3d9){const _0x19e3da=_0x4a7179,_0x5b97b9=getSocket(_0x5bb3d9['id']),_0x399635=_0x5bb3d9[_0x19e3da(0xb2)],_0x18437e=_0x5bb3d9[_0x19e3da(0x141)];devices[_0x399635][_0x19e3da(0xe0)]=validateAccess(devices[_0x399635][_0x19e3da(0xe0)]['token'],_0x399635),logger['debug']('Setting\x20access:\x20'+devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0xc2)]+_0x19e3da(0xe6)+_0x5bb3d9['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x399635[_0x19e3da(0x26f)](-0x8)),_0x5b97b9[_0x19e3da(0x25b)](_0x399635);if(devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0x180)]){_0x5b97b9['join'](_0x18437e);if(_0x18437e==_0x19e3da(0x165))initializeSocketBotManager(_0x5b97b9);else initializeSocketBot(_0x5b97b9);initClient(_0x18437e);}devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0x23e)]&&devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0xc2)]==_0x19e3da(0xbf)&&setSessionTimeout(_0x19e3da(0x24a),_0x399635),devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0x23e)]&&devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0xc2)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x399635),_0x5b97b9['emit']('status',{'status':_0x5bb3d9[_0x19e3da(0x203)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x399635][_0x19e3da(0xe0)],'externalip':devices[_0x399635]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x399635]['access'][_0x19e3da(0x180)]==![]&&devices[_0x399635][_0x19e3da(0xe0)][_0x19e3da(0xc2)]==_0x19e3da(0x1c8)&&temporaryAccess2FA(_0x399635,devices[_0x399635]['ip']);}function _0x2923(_0xf87f09,_0xa01420){const _0x21aae2=_0x4efd();return _0x2923=function(_0xbf5b3,_0x54ea23){_0xbf5b3=_0xbf5b3-0x9a;let _0x4efdff=_0x21aae2[_0xbf5b3];return _0x4efdff;},_0x2923(_0xf87f09,_0xa01420);}function setSessionTimeout(_0x1fb924,_0x1ab468){const _0x4a9d39=_0x4a7179;let _0x1636d0;if(_0x1fb924==_0x4a9d39(0x21a))_0x1636d0=loginExpiry*0x3c*0x3e8;else _0x1636d0=devices[_0x1ab468][_0x4a9d39(0x1b9)][_0x4a9d39(0x1b5)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1ab468][_0x4a9d39(0x1b9)][_0x4a9d39(0x157)]);if(devices[_0x1ab468][_0x4a9d39(0x1ef)])clearTimeout(devices[_0x1ab468][_0x4a9d39(0x1ef)]);devices[_0x1ab468]['pidExpireLogin']=setTimeout(()=>{const _0x8bb903=_0x4a9d39;if(devices[_0x1ab468]['pidRefreshToken'])clearTimeout(devices[_0x1ab468]['pidRefreshToken']);removeSocketListeners(_0x1ab468),addBlacklist(_0x1ab468),devices[_0x1ab468][_0x8bb903(0x1b9)]=null,devices[_0x1ab468][_0x8bb903(0x261)]=null,devices[_0x1ab468]['access']['token']=null,logger['debug'](_0x8bb903(0xfe)+_0x1ab468[_0x8bb903(0x26f)](-0x8)),devices[_0x1ab468][_0x8bb903(0xe0)]=validateAccess(devices[_0x1ab468]['access'][_0x8bb903(0x23e)],_0x1ab468),!(devices[_0x1ab468][_0x8bb903(0xe0)][_0x8bb903(0x180)]&&devices[_0x1ab468][_0x8bb903(0xe0)][_0x8bb903(0xc2)]==_0x8bb903(0x1c0))&&(_0x1fb924==_0x8bb903(0x21a)?io['to'](_0x1ab468)[_0x8bb903(0x224)]('status',{'access':{'allow':![],'reason':_0x8bb903(0x140),'token':null}}):io['to'](_0x1ab468)[_0x8bb903(0x224)](_0x8bb903(0x170),{'access':{'allow':![],'reason':_0x8bb903(0x24d),'token':null}})),devices[_0x1ab468][_0x8bb903(0xe0)][_0x8bb903(0x23e)]=null;},_0x1636d0);}function _0x4efd(){const _0x1dff54=['inherit','reset-password','bcryptjs','stop','login\x20token\x20generated','bots','telegrammsg','unlinkSync','/off\x20-\x20stop\x20bot(s)\x0a','Logged\x20in\x20user\x20...','Invalid\x20authentication\x20token\x20(1)','hybrid-crypto-js','30\x20min','mkdirSync',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/configuration','exit','temporary\x20access\x20rejected','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','access\x20timeout','bot','hashSync','env','get-starting-balances','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','jsonwebtoken','2FA\x20login\x20rejected','exec','Unauthorized\x20attempt\x20to\x20update\x20bot','family','deleteHistoryAlerts','login\x20required','size','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','new-disabled','decrypt','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','onText','createServer','host','botID','backup-full.zip','timestamp','Error:\x20Invalid\x20argument\x20','1422363lQSrtw','16580879wKNyuP','set',',\x20must\x20be\x20a\x204\x20digit\x20number','clientip','secure','log','output-001.log','zip/','Markdown','Enabled\x20Bot\x20','[ip-address]','botmanager','$1_$2_$3','bb/','argv','127.0.0.1','rmSync','manual','Network\x20Interfaces:','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','internal','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','status','store-settings','Unauthorized\x20attempt\x20to\x20confirm\x20message','resetHistory','compareSync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','File\x20uploaded','***','express-fileupload','output-002.log','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','<b>Telegram\x20Bot\x20Status:</b>\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Restoring\x20bot(s)\x20from\x20backup','sendMessage','axios','allow','readFileSync','#RES#\x0a','chat','disabled','/disable\x20-\x20disable\x20notifications\x0a','node-telegram-bot-api','telegramEvents','lowdb','cancelLoading','search','all','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','split','push','write','Invalid\x20username\x20or\x20IP\x20address','reinstall-bb','readdirSync','=>\x20Go\x20to\x20#BLU#http://','-performance.json','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','(((.+)+)+)+$','show','sendPortfolioTelegram','apply','NTBA_FIX_319','live','SIGINT','Disabled\x20Bot\x20','Invalid\x20authentication\x20token\x20(2)','#RES#\x20if\x20running\x20locally\x0a','tkn','exp','kill','getHours','Invalid\x20Telegram\x20token','secret','bb-secure.json','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','confirm-message','Server','getTime','/enable\x20-\x20enable\x20notifications\x0a','*$1*','/:bot','filter','messages','Unauthorized\x20attempt\x20to\x20download\x20','storeFiat','init','success','\x20>\x20','expiry','telegramEnabled','versions','Unauthorized\x20attempt\x20to\x20get\x20portfolio','telegramIpApproval','existsSync','toIPv4Address','backup-files','toggleBotMode','3085770QwyRCJ','toIPv4MappedAddress','login\x20not\x20required','Alerts','callback_query','auto','/:bot/history','logs/','lastmsgtelegram','No\x20bots\x20running\x20right\x20now','2FA\x20required','ipc','length','\x20to\x20','Notifications\x20disabled\x0a','then','remoteAddress','Starting\x20new\x20bot\x20|\x20Bot\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','/help\x20-\x20show\x20available\x20commands\x0a','params','reload','sort','Unauthorized\x20attempt\x20to\x20show\x20configuration','Notifications\x20types:\x20','bbUsername','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','bbvNew','backup','settings','updatebotmanager','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Access\x20enabled\x20for\x20','randomBytes','yes','getMonth','reinstall','warning','::ffff:127.0.0.1','storeHeadless','4971048ZRaMQg','0.0.0','find','config/','forEach','orders','crypto','Restore\x20process\x20aborted','\x1b[31m','pidExpireLogin','/names\x20-\x20show\x20bot\x20names\x0a','send','test','keys','padStart','Restore\x20backup\x20file\x20','username','Login\x20accepted','from','disconnect','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','headless','accept','binary','privateKey','Unauthorized\x20attempt\x20to\x20delete\x20bot','Password\x20has\x20been\x20reset\x20to:\x20','apiPassword','stopped','server','getPortfolio','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','6b67f3d61ee94b8f5c80b4affef4c4d9','settings.','api-eu.mixpanel.com','Ok,\x20will\x20send\x20alert\x20notifications\x20only','debug','any','sortBy','userid','socket.io','function','includes','getSeconds','address','constructor','bbPassword','kind','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','256852BeUFjN','store-configuration','timeshift','login','404\x20Not\x20Found','show-config','Failed\x20to\x20download\x20','writeFileSync','Starting\x20Balance\x20Bot\x20reinstallation','private','Notifications\x20enabled\x0a','type','handshake','emit','getMinutes','\x20|\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Logged\x20out\x20user\x20...','/:bot/portfolio','invalid\x20credentials','temp/','Backup\x20file\x20unzipped\x20and\x20stored','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Unauthorized\x20attempt\x20to\x20update\x20settings','DEFLATE','conn','f2aRequired','.zip','whitelistEnabled','5\x20min','password','running','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Backup\x20file\x20uploaded','files','map','Unauthorized\x20attempt\x20to\x20log\x20out','build2','path','token','index.html','-config.json','range','statSync','stopPolling','Node.js\x20v','Starting\x20Balance\x20Bot\x20','connection','/restart\x20-\x20restart\x20bot(s)\x0a','<b>Balance\x20Bot\x20Status:</b>\x0a','download','2FA','getDate','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','temporary\x20access\x20timeout','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','HTML','loginRequired','publicKey','connected','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','mtime','Unauthorized\x20attempt\x20to\x20delete\x20alerts','All\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20','-events.json','cloneDeep','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','join','polling_error','Restarting\x20Bot\x20','get-logs','-----------------------------------------------------------------------------------','format','telegram2FaApproval','ipaddr.js','port','/metrics\x20-\x20show\x20bot\x20performance\x0a','enabled','getFullYear','Unauthorized\x20attempt\x20to\x20store\x20configuration','hasOwnProperty','add','isValid','telegramUsername','/output-000.log','uuid-random','2FA\x20login\x20required','slice','=>\x20Go\x20to\x20#BLU#http://127.0.0.1:','Starting\x20bot\x20|\x20Bot\x20','value','temporary\x20access\x20not\x20allowed','title','update','output-003.log','file','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','name','generateKeyPairAsync','/:bot/support','event','notification','Allow\x20login\x20from\x20IP\x20address\x20<b>','apiKey','static','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','copyFileSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Idling\x20bot\x20\x20\x20|\x20Bot\x20','ipv6','get-portfolio','Error\x20while\x20deleting\x20config\x20files:\x20','-results.json','</b>\x20?','Bot\x20','isDirectory','assign','uuid','2FA\x20login\x20token\x20generated','backup-full','new','telegramChatId','All\x20bots','replace','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','_data','Notifications\x20disabled','showname','RSA-OAEP','Unauthorized\x20attempt\x20to\x20get\x20events','temporary\x20token\x20generated','place-order','encryptedUuid','reason','node-zip','Orders','reject','removeAllListeners','sendFile','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','pidRefreshToken','getUTCHours','delete-alerts','************','No\x20authentication\x20token','bot-','number','node','use','hex','placeOrder','get','bbvReceive','defaults','User\x20has\x20been\x20validated','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','/status\x20-\x20show\x20bot(s)\x20status\x0a','delete-bot','remove','answerCallbackQuery','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','logged\x20out','telegram','access','80281VYEJWj','getStartingBalances','date-fns','randomFillSync','entries','\x20|\x20client:\x20...','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','1972240yIHXPT','update-bot','store-headless','store','referer','logout','user','endsWith','clients','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','latestversion','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','stringify','Starting\x20#RED#Balance\x20Bot\x20v','#RES#\x20if\x20running\x20on\x20server','parse','sign','match','started','Session\x20expired\x20for\x20user\x20...','removeListener','blacklist','1000','/on\x20-\x20start\x20bot(s)\x0a','alerts','emitHistory','All','toggle-bot-mode','listen','data','\x1b[34m','onepagemode','\x20only\x0a','max','message','catch','createWriteStream','headers','IPv4','Yes','telegramToken','toString','Unauthorized\x20attempt\x20to\x20add\x20bot','build','track','sendMetricsTelegram','simple','RSA','Notifications\x20enabled','botname','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20get\x20messages',':\x20Bot\x20Mgr\x20>\x20','mode','update-bb','full','once','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','lastmsgemitted','get-messages','startsWith','Crypt','http','initclient'];_0x4efd=function(){return _0x1dff54;};return _0x4efd();}function setTokenRefresh(_0x4bfcf3){const _0x13167d=_0x4a7179;if(devices[_0x4bfcf3][_0x13167d(0xc9)])clearTimeout(devices[_0x4bfcf3][_0x13167d(0xc9)]);devices[_0x4bfcf3][_0x13167d(0xc9)]=setTimeout(()=>{const _0x56a570=_0x13167d;getClientsWithUuid(_0x4bfcf3)['length']!=0x0?(devices[_0x4bfcf3][_0x56a570(0xe0)]=refreshToken(_0x4bfcf3),io['to'](_0x4bfcf3)['emit'](_0x56a570(0x170),{'status':_0x56a570(0x252),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4bfcf3][_0x56a570(0xe0)],'externalip':devices[_0x4bfcf3]['ip'],'publicKey':secure[_0x56a570(0x251)],'validInstallation':validInstallation}),setTokenRefresh(_0x4bfcf3)):clearTimeout(devices[_0x4bfcf3][_0x56a570(0xc9)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x247538){const _0x59e848=_0x4a7179,_0x21ed54=getClient(_0x247538['id'])[_0x59e848(0xb2)];_0x247538['emit'](_0x59e848(0x130),config),_0x247538['emit']('settings',cleanSettings()),_0x247538['on']('add-bot',_0x1c19e9=>{const _0x21321f=_0x59e848;if(validateAccess(_0x1c19e9,_0x21ed54)[_0x21321f(0x180)])addBot();else logger[_0x21321f(0x122)](_0x21321f(0x115));}),_0x247538['on'](_0x59e848(0xeb),(_0x176f5b,_0x5aff7e)=>{const _0x9843ec=_0x59e848;if(validateAccess(_0x5aff7e,_0x21ed54)['allow'])toggleBot(_0x176f5b[_0x9843ec(0x155)],_0x176f5b[_0x9843ec(0x170)],_0x176f5b[_0x9843ec(0x19b)]);else logger[_0x9843ec(0x122)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x247538['on'](_0x59e848(0x106),(_0x3f188e,_0x352203)=>{const _0x34845a=_0x59e848;if(validateAccess(_0x352203,_0x21ed54)[_0x34845a(0x180)])toggleBotMode(_0x3f188e);else logger[_0x34845a(0x122)](_0x34845a(0x149));}),_0x247538['on'](_0x59e848(0xda),(_0x36e9a6,_0x1267ac)=>{const _0x97ac10=_0x59e848;if(validateAccess(_0x1267ac,_0x21ed54)[_0x97ac10(0x180)])deleteBot(_0x36e9a6);else logger[_0x97ac10(0x122)](_0x97ac10(0x1ff));}),_0x247538['on'](_0x59e848(0x171),(_0x485e32,_0xddf922)=>{const _0x511ba5=_0x59e848;if(validateAccess(_0xddf922,_0x21ed54)[_0x511ba5(0x180)])storeSettings(_0x485e32,!![]);else logger[_0x511ba5(0x122)](_0x511ba5(0x22e));}),_0x247538['on']('update-bb',_0x596855=>{const _0x381644=_0x59e848;if(validateAccess(_0x596855,_0x21ed54)['allow'])updateBB(_0x381644(0x275));else logger[_0x381644(0x122)](_0x381644(0x24c));}),_0x247538['on'](_0x59e848(0x191),_0x230f62=>{const _0x51be0b=_0x59e848;if(validateAccess(_0x230f62,_0x21ed54)[_0x51be0b(0x180)])updateBB('reinstall');else logger[_0x51be0b(0x122)](_0x51be0b(0x151));}),_0x247538['on']('get-backup-files',_0x13f5ae=>{const _0x23686d=_0x59e848;if(validateAccess(_0x13f5ae,_0x21ed54)[_0x23686d(0x180)]){const _0x263e07=getClient(_0x247538['id']);if(_0x263e07)getBackupFiles(_0x263e07[_0x23686d(0xb2)]);else logger[_0x23686d(0x122)](_0x23686d(0x13b));}else logger[_0x23686d(0x122)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x247538['on']('restore-backup-file',(_0x1968b2,_0x4595f0)=>{const _0x32f6bc=_0x59e848;if(validateAccess(_0x4595f0,_0x21ed54)[_0x32f6bc(0x180)])restoreBackupFile(_0x1968b2);else logger[_0x32f6bc(0x122)](_0x32f6bc(0x25a));}),_0x247538['on'](_0x59e848(0x126),_0x3de32d=>{const _0x5adea7=_0x59e848;if(validateAccess(_0x3de32d,_0x21ed54)[_0x5adea7(0x180)])getMessages();else logger[_0x5adea7(0x122)](_0x5adea7(0x11e));}),_0x247538['on'](_0x59e848(0x1a8),(_0x321e69,_0xc0700d)=>{const _0x403bdc=_0x59e848;if(validateAccess(_0xc0700d,_0x21ed54)[_0x403bdc(0x180)])confirmMessage(_0x321e69);else logger[_0x403bdc(0x122)](_0x403bdc(0x172));}),_0x247538['on'](_0x59e848(0xef),_0x2adb9a=>{const _0x5a269b=_0x59e848;if(validateAccess(_0x2adb9a,_0x21ed54)['allow']){if(devices[_0x21ed54][_0x5a269b(0xc9)])clearTimeout(devices[_0x21ed54]['pidRefreshToken']);if(devices[_0x21ed54][_0x5a269b(0x1ef)])clearTimeout(devices[_0x21ed54][_0x5a269b(0x1ef)]);removeSocketListeners(getClient(_0x247538['id'])[_0x5a269b(0xb2)]),addBlacklist(_0x21ed54),devices[_0x21ed54]['telegramIpApproval']=null,devices[_0x21ed54][_0x5a269b(0x261)]=null,devices[_0x21ed54][_0x5a269b(0xe0)][_0x5a269b(0x23e)]=null,logger[_0x5a269b(0x20a)](_0x5a269b(0x228)+_0x21ed54[_0x5a269b(0x26f)](-0x8)),io['to'](getClient(_0x247538['id'])[_0x5a269b(0xb2)])[_0x5a269b(0x224)](_0x5a269b(0x170),{'access':{'allow':![],'reason':_0x5a269b(0xde),'token':null}});}else logger[_0x5a269b(0x122)](_0x5a269b(0x23b));});}function initializeSocketBot(_0x259269){const _0x4c128b=_0x4a7179,_0x1e81b4=getClient(_0x259269['id'])[_0x4c128b(0x141)],_0x1e68da=getClient(_0x259269['id'])[_0x4c128b(0xb2)];_0x259269['on'](_0x4c128b(0x25e),(_0x3cb38e,_0x46ddbb)=>{const _0x3375ea=_0x4c128b;if(validateAccess(_0x46ddbb,_0x1e68da)[_0x3375ea(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x3375ea(0x1f1)]({'function':_0x3375ea(0x104),'args':_0x3cb38e});}else logger[_0x3375ea(0x122)](_0x3375ea(0xbe));}),_0x259269['on'](_0x4c128b(0xcb),(_0xfcb92c,_0x4b3791)=>{const _0x502766=_0x4c128b;if(validateAccess(_0x4b3791,_0x1e68da)[_0x502766(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x502766(0x1f1)]({'function':_0x502766(0x14b),'args':_0xfcb92c});}else logger[_0x502766(0x122)](_0x502766(0x255));}),_0x259269['on'](_0x4c128b(0xab),(_0xa1b0a7,_0x447729)=>{const _0x4d74e0=_0x4c128b;if(validateAccess(_0x447729,_0x1e68da)['allow']){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x4d74e0(0x1f1)]({'function':_0x4d74e0(0x204),'args':_0xa1b0a7});}else logger[_0x4d74e0(0x122)](_0x4d74e0(0x1b8));}),_0x259269['on'](_0x4c128b(0x218),(_0x56a2ef,_0xafc53e)=>{const _0x26dd69=_0x4c128b;if(validateAccess(_0xafc53e,_0x1e68da)[_0x26dd69(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4]['send']({'function':'storeConfiguration','args':_0x56a2ef});}else logger['full'](_0x26dd69(0x267));}),_0x259269['on'](_0x4c128b(0xec),(_0x553305,_0x568521)=>{const _0x3172ae=_0x4c128b;if(validateAccess(_0x568521,_0x1e68da)[_0x3172ae(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x3172ae(0x1f1)]({'function':_0x3172ae(0x1e5),'args':_0x553305});}else logger[_0x3172ae(0x122)](_0x3172ae(0x13a));}),_0x259269['on']('store-fiat',(_0x4fa40a,_0x3949e4)=>{const _0x43ee0=_0x4c128b;if(validateAccess(_0x3949e4,_0x1e68da)['allow']){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x43ee0(0x1f1)]({'function':_0x43ee0(0x1b1),'args':_0x4fa40a});}else logger['full'](_0x43ee0(0xe8));}),_0x259269['on']('reset-history',_0x130ef7=>{const _0x291601=_0x4c128b;if(validateAccess(_0x130ef7,_0x1e68da)[_0x291601(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4]['send']({'function':_0x291601(0x173),'args':null});}else logger[_0x291601(0x122)](_0x291601(0x14e));}),_0x259269['on'](_0x4c128b(0x144),_0x4fd606=>{const _0x19f13e=_0x4c128b;if(validateAccess(_0x4fd606,_0x1e68da)[_0x19f13e(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x19f13e(0x1f1)]({'function':_0x19f13e(0xe2),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x259269['on'](_0x4c128b(0xc0),(_0x3fe604,_0x20684d)=>{const _0xcf86e7=_0x4c128b;if(validateAccess(_0x20684d,_0x1e68da)['allow']){if(pid[_0x1e81b4])pid[_0x1e81b4][_0xcf86e7(0x1f1)]({'function':_0xcf86e7(0xd3),'args':_0x3fe604});}else logger[_0xcf86e7(0x122)](_0xcf86e7(0xa7));}),_0x259269['on']('cancel-loading',_0x1aaf86=>{const _0x506018=_0x4c128b;if(validateAccess(_0x1aaf86,_0x1e68da)['allow']){if(pid[_0x1e81b4])pid[_0x1e81b4]['send']({'function':_0x506018(0x189),'args':null});}else logger[_0x506018(0x122)](_0x506018(0x237));}),_0x259269['on'](_0x4c128b(0x21c),_0x2e0b81=>{const _0x49c83c=_0x4c128b;if(validateAccess(_0x2e0b81,_0x1e68da)[_0x49c83c(0x180)]){if(pid[_0x1e81b4])pid[_0x1e81b4][_0x49c83c(0x1f1)]({'function':'showConfig','args':null});}else logger[_0x49c83c(0x122)](_0x49c83c(0x1d5));}),_0x259269['on'](_0x4c128b(0x121),_0x471005=>{const _0x43ffe6=_0x4c128b;if(validateAccess(_0x471005,_0x1e68da)['allow'])updateBB(_0x43ffe6(0x275));else logger[_0x43ffe6(0x122)](_0x43ffe6(0x24c));}),_0x259269['on'](_0x4c128b(0x126),_0x465cb6=>{const _0x4bc339=_0x4c128b;if(validateAccess(_0x465cb6,_0x1e68da)[_0x4bc339(0x180)])getMessages();else logger[_0x4bc339(0x122)](_0x4bc339(0x11e));}),_0x259269['on'](_0x4c128b(0x1a8),(_0x41acfd,_0x175a5d)=>{const _0x20ef4a=_0x4c128b;if(validateAccess(_0x175a5d,_0x1e68da)[_0x20ef4a(0x180)])confirmMessage(_0x41acfd);else logger[_0x20ef4a(0x122)](_0x20ef4a(0x172));}),_0x259269['on'](_0x4c128b(0xef),_0x3b8d97=>{const _0x586705=_0x4c128b;if(validateAccess(_0x3b8d97,_0x1e68da)[_0x586705(0x180)]){if(devices[_0x1e68da]['pidRefreshToken'])clearTimeout(devices[_0x1e68da][_0x586705(0xc9)]);if(devices[_0x1e68da][_0x586705(0x1ef)])clearTimeout(devices[_0x1e68da][_0x586705(0x1ef)]);removeSocketListeners(getClient(_0x259269['id'])[_0x586705(0xb2)]),addBlacklist(_0x1e68da),devices[_0x1e68da][_0x586705(0x1b9)]=null,devices[_0x1e68da]['telegram2FaApproval']=null,devices[_0x1e68da][_0x586705(0xe0)][_0x586705(0x23e)]=null,logger['debug'](_0x586705(0x228)+_0x1e68da[_0x586705(0x26f)](-0x8)),io['to'](getClient(_0x259269['id'])[_0x586705(0xb2)])[_0x586705(0x224)]('status',{'access':{'allow':![],'reason':_0x586705(0xde),'token':null}});}else logger['full'](_0x586705(0x23b));});}function removeSocketListeners(_0x2160bd){getClientsWithUuid(_0x2160bd)['forEach'](_0x5f3772=>{const _0x33317c=_0x2923;getSocket(_0x5f3772['id'])[_0x33317c(0xc6)]();});}function cleanSettings(){const _0x26d55b=_0x4a7179;let _0x367907=settings;return settings[_0x26d55b(0x113)]&&settings[_0x26d55b(0x113)]!=''&&(_0x367907={..._0x367907,'telegramToken':_0x26d55b(0xcc)}),settings[_0x26d55b(0x214)]&&settings['bbPassword']!=''&&(_0x367907={..._0x367907,'bbPassword':_0x26d55b(0xcc)}),(settings[_0x26d55b(0x214)]&&settings[_0x26d55b(0x214)]=='***'||settings[_0x26d55b(0x113)]&&settings[_0x26d55b(0x113)]==_0x26d55b(0x177))&&(_0x367907={..._0x367907,'restored':{'password':settings[_0x26d55b(0x214)]==_0x26d55b(0x177),'telegram':settings[_0x26d55b(0x113)]==_0x26d55b(0x177)}}),_0x367907;}async function updateBB(_0x47d9f4){const _0x6633c7=_0x4a7179;await backupConfigFiles(),installingUpdate=!![],config[_0x6633c7(0x1ea)](_0x2c749c=>{restartBot(_0x2c749c['botID']);}),logger[_0x6633c7(0x20a)](_0x6633c7(0x245)+_0x47d9f4);if(_0x47d9f4=='update')process['send']({'update':!![]},_0x459405=>{});else _0x47d9f4==_0x6633c7(0x1e2)&&process[_0x6633c7(0x1f1)]({'reinstall':!![]},_0x164270=>{});}function startBot(_0x10e6e1,_0x5a7985,_0xe89ee8){const _0x54bfcd=_0x4a7179;if(debugging)_0x10e6e1[_0x54bfcd(0x18e)]('-d');let _0x584d30=![];const _0x4d76d3=_0x10e6e1[0x0];_0x5a7985={..._0x5a7985,'stdio':['inherit',_0x54bfcd(0x12b),'inherit',_0x54bfcd(0x1c9)]},pid[_0x4d76d3]=childProcess['fork'](botfile,_0x10e6e1,_0x5a7985),pid[_0x4d76d3]['on'](_0x54bfcd(0x10d),_0x4f9b3e=>{const _0x295bd6=_0x54bfcd;switch(Object['keys'](_0x4f9b3e)[0x0]){case'botname':updateBotName(_0x4d76d3,_0x4f9b3e[_0x295bd6(0x11c)]);break;case _0x295bd6(0x1dc):updateBotManager();break;case _0x295bd6(0x170):updateStatus(_0x4d76d3,_0x4f9b3e[_0x295bd6(0x170)]);break;case _0x295bd6(0x19b):updateLive(_0x4d76d3,_0x4f9b3e['live']);break;case _0x295bd6(0xfd):updateLive(_0x4d76d3,_0x4f9b3e[_0x295bd6(0xfd)]),io['to'](_0x4d76d3)[_0x295bd6(0x224)](_0x295bd6(0x170),{'access':{'allow':![],'reason':_0x295bd6(0x1d3),'token':null}});break;case'stop':_0x4f9b3e[_0x295bd6(0x12e)]=='restart'&&restartBot(_0x4d76d3);_0x4f9b3e[_0x295bd6(0x12e)]==_0x295bd6(0x1a2)&&toggleBot(_0x4d76d3,_0x295bd6(0x184),'stopped');break;case _0x295bd6(0xdf):sendTelegram(_0x4d76d3,_0x4f9b3e['telegram']);break;case _0x295bd6(0x131):sendTelegramMsg(_0x4f9b3e[_0x295bd6(0x131)]);break;case'function':io['to'](_0x4d76d3)[_0x295bd6(0x224)](_0x4f9b3e[_0x295bd6(0x20f)],_0x4f9b3e['args']);break;}}),pid[_0x4d76d3]['on']('error',function(_0x2c828b){if(_0x584d30)return;_0x584d30=!![],_0xe89ee8(_0x2c828b);}),pid[_0x4d76d3]['on'](_0x54bfcd(0x13d),async function(_0xb42321){const _0x590ced=_0x54bfcd;if(installingUpdate)return;if(_0x584d30)return;_0x584d30=!![],_0xe89ee8(null);const _0x58e35c=dbConfig[_0x590ced(0xd4)]('bots')[_0x590ced(0x1e8)]({'botID':_0x4d76d3})[_0x590ced(0x272)]();_0x58e35c&&(_0x58e35c[_0x590ced(0x170)]=='enabled'||_0x58e35c[_0x590ced(0x170)]=='new')&&(await sleep(0x3e8),updateLive(_0x4d76d3,_0x590ced(0x202)),logger[_0x590ced(0x122)](_0x590ced(0x25d)+_0x4d76d3),startBot([_0x4d76d3,userID],{'cwd':bbpath},function(_0x30a429){const _0xabb3fd=_0x590ced;if(_0x30a429)logger[_0xabb3fd(0x122)](_0x30a429);}));});}function stopBot(_0xaf270f){const _0xa38921=_0x4a7179;getClientsWithBotID(_0xaf270f)[_0xa38921(0x1ea)](_0x3e0384=>{const _0xff0833=_0xa38921;getSocket(_0x3e0384['id'])[_0xff0833(0x1f9)](!![]),removeClient(_0x3e0384['id']);}),pid[_0xaf270f]&&(pid[_0xaf270f]['kill'](),pid[_0xaf270f]=null);}function restartBot(_0x3689bb){const _0x20bde1=_0x4a7179;if(pid[_0x3689bb])pid[_0x3689bb][_0x20bde1(0x1a2)]();}function addBot(){const _0x395fc9=_0x4a7179;let _0x1224d4;for(let _0x3d9c00=0x1;_0x3d9c00<0x3e9;_0x3d9c00++){_0x1224d4=_0x3d9c00[_0x395fc9(0x114)]()[_0x395fc9(0x1f4)](0x3,'0');let _0xa16fb8=config['find'](_0x4bfab7=>_0x4bfab7[_0x395fc9(0x155)]==_0x1224d4);if(!_0xa16fb8)break;}if(_0x1224d4===_0x395fc9(0x101)){logger[_0x395fc9(0x122)](_0x395fc9(0x16f));return;}logger[_0x395fc9(0x122)](_0x395fc9(0x1cf)+_0x1224d4),dbConfig[_0x395fc9(0xd4)](_0x395fc9(0x130))[_0x395fc9(0x18e)]({'botID':_0x1224d4,'botname':'Bot\x20'+_0x1224d4,'status':_0x395fc9(0xb5),'live':''})['write'](),startBot([_0x1224d4,userID],{'cwd':bbpath},function(_0x23e3a4){const _0x436b68=_0x395fc9;if(_0x23e3a4)logger[_0x436b68(0x122)](_0x23e3a4);}),config=getConfiguration(),io['to'](_0x395fc9(0x165))[_0x395fc9(0x224)](_0x395fc9(0x130),config),broadcastToBots(_0x395fc9(0x130),JSON[_0x395fc9(0xf7)](config));}function deleteBot(_0x27d533){const _0x31d829=_0x4a7179;getClientsWithBotID(_0x27d533)['forEach'](_0x5f5f33=>{getSocket(_0x5f5f33['id'])['disconnect'](!![]),removeClient(_0x5f5f33['id']);}),dbConfig[_0x31d829(0xd4)]('bots')['remove']({'botID':_0x27d533})[_0x31d829(0x18f)](),logger[_0x31d829(0x122)]('Deleted\x20Bot\x20'+_0x27d533),stopBot(_0x27d533);try{if(fs['existsSync'](path[_0x31d829(0x25b)](configpath,'bot-'+_0x27d533+'-config.json')))fs[_0x31d829(0x132)](path[_0x31d829(0x25b)](configpath,'bot-'+_0x27d533+_0x31d829(0x240)));if(fs[_0x31d829(0x1ba)](path[_0x31d829(0x25b)](configpath,_0x31d829(0xce)+_0x27d533+_0x31d829(0x258))))fs[_0x31d829(0x132)](path[_0x31d829(0x25b)](configpath,'bot-'+_0x27d533+_0x31d829(0x258)));if(fs[_0x31d829(0x1ba)](path['join'](configpath,_0x31d829(0xce)+_0x27d533+'-performance.json')))fs['unlinkSync'](path[_0x31d829(0x25b)](configpath,_0x31d829(0xce)+_0x27d533+_0x31d829(0x194)));if(fs[_0x31d829(0x1ba)](path[_0x31d829(0x25b)](configpath,'bot-'+_0x27d533+'-results.json')))fs[_0x31d829(0x132)](path[_0x31d829(0x25b)](configpath,'bot-'+_0x27d533+_0x31d829(0xad)));}catch(_0x27e584){if(_0x27e584)logger[_0x31d829(0x122)](_0x31d829(0xac),_0x27e584);}config=getConfiguration(),io['to'](_0x31d829(0x165))[_0x31d829(0x224)](_0x31d829(0x130),config),broadcastToBots(_0x31d829(0x130),JSON['stringify'](config));}function toggleBot(_0x33f48b,_0x1d4157,_0x19d15f){const _0x5d9786=_0x4a7179;dbConfig[_0x5d9786(0xd4)](_0x5d9786(0x130))['find']({'botID':_0x33f48b})[_0x5d9786(0xb1)]({'status':_0x1d4157})[_0x5d9786(0xb1)]({'live':_0x19d15f})[_0x5d9786(0x18f)]();if(_0x1d4157==_0x5d9786(0x265)||_0x1d4157=='new')logger[_0x5d9786(0x122)](_0x5d9786(0x163)+_0x33f48b),startBot([_0x33f48b,userID],{'cwd':bbpath},function(_0x161aef){const _0x3af1bd=_0x5d9786;if(_0x161aef)logger[_0x3af1bd(0x122)](_0x161aef);});else(_0x1d4157=='disabled'||_0x1d4157==_0x5d9786(0x14f))&&(logger[_0x5d9786(0x122)](_0x5d9786(0x19d)+_0x33f48b),stopBot(_0x33f48b));config=getConfiguration(),io['to']('botmanager')[_0x5d9786(0x224)](_0x5d9786(0x130),config),broadcastToBots(_0x5d9786(0x130),JSON[_0x5d9786(0xf7)](config));}function toggleStatus(_0x489697){const _0x2397cf=_0x4a7179;let _0x180916=dbConfig[_0x2397cf(0xd4)](_0x2397cf(0x130))[_0x2397cf(0x1e8)]({'botID':_0x489697})['value'](),_0x33a595;if(_0x180916['status']===_0x2397cf(0x265))_0x33a595=_0x2397cf(0x184);else{if(_0x180916['status']==='new')_0x33a595=_0x2397cf(0x14f);else{if(_0x180916[_0x2397cf(0x170)]===_0x2397cf(0x14f))_0x33a595=_0x2397cf(0xb5);else{if(_0x180916[_0x2397cf(0x170)]===_0x2397cf(0x184))_0x33a595=_0x2397cf(0x265);}}}return _0x33a595;}function updateStatus(_0x4370d4,_0x237230){const _0x26bb82=_0x4a7179;dbConfig[_0x26bb82(0xd4)](_0x26bb82(0x130))[_0x26bb82(0x1e8)]({'botID':_0x4370d4})[_0x26bb82(0xb1)]({'status':_0x237230})[_0x26bb82(0x18f)](),config=getConfiguration(),io['to'](_0x26bb82(0x165))[_0x26bb82(0x224)](_0x26bb82(0x130),config),broadcastToBots('bots',JSON[_0x26bb82(0xf7)](config));}function updateLive(_0x55656d,_0x5a43a7){const _0x4a1d8c=_0x4a7179;dbConfig[_0x4a1d8c(0xd4)]('bots')[_0x4a1d8c(0x1e8)]({'botID':_0x55656d})['assign']({'live':_0x5a43a7})['write'](),config=getConfiguration(),io['to'](_0x4a1d8c(0x165))[_0x4a1d8c(0x224)](_0x4a1d8c(0x130),config),broadcastToBots(_0x4a1d8c(0x130),JSON[_0x4a1d8c(0xf7)](config));}function updateBotName(_0x11ab7d,_0x53726a){const _0x264a22=_0x4a7179;dbConfig[_0x264a22(0xd4)](_0x264a22(0x130))[_0x264a22(0x1e8)]({'botID':_0x11ab7d})[_0x264a22(0xb1)]({'botname':_0x53726a})[_0x264a22(0x18f)](),config=getConfiguration(),io['to'](_0x264a22(0x165))[_0x264a22(0x224)]('bots',config),broadcastToBots('bots',JSON[_0x264a22(0xf7)](config));}function updateBotManager(){const _0x5607a6=_0x4a7179;config=getConfiguration(),io['to'](_0x5607a6(0x165))[_0x5607a6(0x224)](_0x5607a6(0x130),config),broadcastToBots(_0x5607a6(0x130),JSON[_0x5607a6(0xf7)](config));}function toggleBotMode(_0x11638d){const _0x4d4cdf=_0x4a7179;if(pid[_0x11638d])pid[_0x11638d]['send']({'function':_0x4d4cdf(0x1bd),'args':null});else{const _0x2698fd=configpath+'bot-'+_0x11638d+_0x4d4cdf(0x240),_0xf3864d=fs[_0x4d4cdf(0x181)](_0x2698fd),_0x3b525f=JSON[_0x4d4cdf(0xfa)](_0xf3864d),_0x4a5feb=_0x3b525f[_0x4d4cdf(0x141)][0x0][_0x4d4cdf(0x1fb)];_0x3b525f[_0x4d4cdf(0x141)][0x0][_0x4d4cdf(0x1fb)]=!_0x4a5feb;const _0x534566=JSON[_0x4d4cdf(0xf7)](_0x3b525f,null,0x2);fs[_0x4d4cdf(0x21e)](_0x2698fd,_0x534566),config=getConfiguration(),io['to'](_0x4d4cdf(0x165))[_0x4d4cdf(0x224)](_0x4d4cdf(0x130),config),broadcastToBots(_0x4d4cdf(0x130),JSON[_0x4d4cdf(0xf7)](config));}}function telegramError(_0x3ce9c1){const _0x2bde0e=_0x4a7179;logger[_0x2bde0e(0x119)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x1c3fdc){const _0x49d7fa=_0x4a7179;if(_0x1c3fdc[_0x49d7fa(0x1f8)][_0x49d7fa(0x1f6)]!=settings['telegramUsername']&&'@'+_0x1c3fdc['from'][_0x49d7fa(0x1f6)]!=settings[_0x49d7fa(0x26b)])return tgBot[_0x49d7fa(0x17e)](_0x1c3fdc[_0x49d7fa(0x183)]['id'],_0x49d7fa(0x24e),{'parse_mode':_0x49d7fa(0x24f)})[_0x49d7fa(0x10e)](_0x2ef94c=>{telegramError(_0x2ef94c);}),![];return!![];}async function initTelegram(){const _0x19715c=_0x4a7179;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x19715c(0x113)],{'polling':!![]});let _0x513bbb='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x513bbb+='\x0a',_0x513bbb+=_0x19715c(0x1ab),_0x513bbb+=_0x19715c(0x185),_0x513bbb+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x513bbb+=_0x19715c(0x247),_0x513bbb+=_0x19715c(0x102),_0x513bbb+=_0x19715c(0x133),_0x513bbb+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x513bbb+=_0x19715c(0x1f0),_0x513bbb+=_0x19715c(0xd9),_0x513bbb+=_0x19715c(0x264),_0x513bbb+=_0x19715c(0x195),_0x513bbb+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x513bbb+=_0x19715c(0x1a7),_0x513bbb+=_0x19715c(0x1d1);let _0x5102d2=_0x19715c(0xf3);_0x5102d2+='\x0a',_0x5102d2+=_0x513bbb,tgBot[_0x19715c(0x152)](/\/start/,_0x50e97d=>{const _0x322295=_0x19715c;if(!validateTelegram(_0x50e97d))return;if(settings['telegramChatId']!=_0x50e97d[_0x322295(0x183)]['id'])updateSetting('telegramChatId',_0x50e97d['chat']['id']);updateSetting(_0x322295(0x1b6),!![]),tgBot[_0x322295(0x17e)](_0x50e97d[_0x322295(0x183)]['id'],_0x5102d2)[_0x322295(0x10e)](_0x5bacd3=>{telegramError(_0x5bacd3);});}),tgBot['onText'](/\/enable/,_0x4d8fd9=>{const _0x14b346=_0x19715c;if(!validateTelegram(_0x4d8fd9))return;if(settings[_0x14b346(0xb6)]!=_0x4d8fd9[_0x14b346(0x183)]['id'])updateSetting(_0x14b346(0xb6),_0x4d8fd9[_0x14b346(0x183)]['id']);updateSetting(_0x14b346(0x1b6),!![]),tgBot[_0x14b346(0x17e)](_0x4d8fd9[_0x14b346(0x183)]['id'],_0x14b346(0x11b))['catch'](_0x3b1f59=>{telegramError(_0x3b1f59);});}),tgBot['onText'](/\/config/,async _0x4afcb4=>{const _0x4c3824=_0x19715c;if(!validateTelegram(_0x4afcb4))return;tgBot['removeListener'](_0x4c3824(0x1c2)),tgBot[_0x4c3824(0x17e)](_0x4afcb4[_0x4c3824(0x183)]['id'],_0x4c3824(0xa5),{'reply_markup':{'inline_keyboard':[[{'text':_0x4c3824(0xc4),'callback_data':'orders'},{'text':_0x4c3824(0x1c1),'callback_data':_0x4c3824(0x103)},{'text':_0x4c3824(0x105),'callback_data':'all'}]]}})['catch'](_0x39b67e=>{telegramError(_0x39b67e);}),tgBot['on']('callback_query',async _0x14b858=>{const _0x2ea459=_0x4c3824,_0x4bc579=_0x14b858[_0x2ea459(0x108)],_0x34d398=_0x14b858[_0x2ea459(0x10d)];tgBot['answerCallbackQuery'](_0x14b858['id'])['then'](async()=>{const _0x41e8c2=_0x2ea459;_0x4bc579=='orders'&&(updateSetting(_0x41e8c2(0x187),_0x41e8c2(0x1eb)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x34d398[_0x41e8c2(0x183)]['id'],_0x41e8c2(0x1d0))[_0x41e8c2(0x10e)](_0x4748ba=>{telegramError(_0x4748ba);}));_0x4bc579==_0x41e8c2(0x103)&&(updateSetting('telegramEvents',_0x41e8c2(0x103)),updateSetting(_0x41e8c2(0x1b6),!![]),await tgBot[_0x41e8c2(0x17e)](_0x34d398['chat']['id'],_0x41e8c2(0x209))[_0x41e8c2(0x10e)](_0x42be35=>{telegramError(_0x42be35);}));_0x4bc579==_0x41e8c2(0x18b)&&(updateSetting(_0x41e8c2(0x187),_0x41e8c2(0x18b)),updateSetting('telegramEnabled',!![]),await tgBot[_0x41e8c2(0x17e)](_0x34d398[_0x41e8c2(0x183)]['id'],_0x41e8c2(0x17a))[_0x41e8c2(0x10e)](_0x5dfcb3=>{telegramError(_0x5dfcb3);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x34d398['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x41e8c2(0x10e)](_0x11e249=>{telegramError(_0x11e249);});}),tgBot[_0x2ea459(0xff)](_0x2ea459(0x1c2));});}),tgBot[_0x19715c(0x152)](/\/status/,_0x1f85be=>{const _0x2f69c6=_0x19715c;if(!validateTelegram(_0x1f85be))return;const _0x4df016=getBotsWithMode();let _0x5193c7=_0x2f69c6(0x248);config[_0x2f69c6(0x1ea)](_0x166f4b=>{const _0xf2b7c6=_0x2f69c6,_0x4a9317=_0x4df016[_0xf2b7c6(0x1e8)](_0x413a9f=>_0x413a9f[_0xf2b7c6(0x155)]==_0x166f4b['botID'])[_0xf2b7c6(0x120)];_0x5193c7+='Bot\x20'+_0x166f4b[_0xf2b7c6(0x155)]+':\x20'+_0x166f4b['status']+_0xf2b7c6(0x226)+_0x4a9317+_0xf2b7c6(0x226)+_0x166f4b['live']+'\x0a';}),_0x5193c7+='\x0a',_0x5193c7+=_0x2f69c6(0x17b),_0x5193c7+=!settings[_0x2f69c6(0x1b6)]?_0x2f69c6(0x1cc):_0x2f69c6(0x221),_0x5193c7+=settings['telegramEnabled']?settings[_0x2f69c6(0x187)]==_0x2f69c6(0x18b)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x2f69c6(0x1d6)+settings[_0x2f69c6(0x187)]+_0x2f69c6(0x10b):'',tgBot[_0x2f69c6(0x17e)](_0x1f85be[_0x2f69c6(0x183)]['id'],_0x5193c7,{'parse_mode':_0x2f69c6(0x24f)})[_0x2f69c6(0x10e)](_0x40ce46=>{telegramError(_0x40ce46);});}),tgBot[_0x19715c(0x152)](/\/restart/,_0x426b26=>{const _0x412049=_0x19715c;if(!validateTelegram(_0x426b26))return;tgBot[_0x412049(0xff)](_0x412049(0x1c2));const _0xd095fa=getEnabledBots();if(_0xd095fa['length']==0x0)tgBot[_0x412049(0x17e)](_0x426b26['chat']['id'],_0x412049(0x1c7))[_0x412049(0x10e)](_0x213246=>{telegramError(_0x213246);});else{if(_0xd095fa[_0x412049(0x1ca)]>0x1)_0xd095fa[_0x412049(0x18e)]({'botID':_0x412049(0x18b)});let _0x45e729=[],_0x335b79=[];const _0x571555=_0xd095fa[_0x412049(0x1ca)]%0x4==0x0||_0xd095fa['length']%0x4==0x3||_0xd095fa[_0x412049(0x1ca)]%0x3==0x1?0x4:0x3;let _0x47d7f1=0x0;_0xd095fa[_0x412049(0x1ea)]((_0x337906,_0x270c93)=>{const _0x3bb5ce=_0x412049;if(_0x270c93%_0x571555==0x0)_0x335b79=[];_0x335b79[_0x3bb5ce(0x18e)]({'text':_0x337906['botID']==_0x3bb5ce(0x18b)?_0x3bb5ce(0xb7):_0x3bb5ce(0xaf)+_0x337906[_0x3bb5ce(0x155)],'callback_data':_0x337906[_0x3bb5ce(0x155)]}),_0x270c93%_0x571555==0x0&&(_0x45e729[_0x47d7f1]=_0x335b79,_0x47d7f1++);}),tgBot[_0x412049(0x17e)](_0x426b26[_0x412049(0x183)]['id'],_0x412049(0x216),{'reply_markup':{'inline_keyboard':_0x45e729}})[_0x412049(0x10e)](_0x3a32ef=>{telegramError(_0x3a32ef);}),tgBot['on'](_0x412049(0x1c2),async _0x363c9a=>{const _0x59120f=_0x412049,_0x1199e4=_0x363c9a['data'],_0x375753=_0x363c9a['message'];tgBot[_0x59120f(0xdc)](_0x363c9a['id'])[_0x59120f(0x1cd)](async()=>{const _0x250db1=_0x59120f;_0x1199e4=='all'?config[_0x250db1(0x1ea)](_0x428e98=>{restartBot(_0x428e98['botID']);}):restartBot(_0x1199e4);}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/on/,_0x14fd13=>{const _0xa2bd9b=_0x19715c;if(!validateTelegram(_0x14fd13))return;tgBot[_0xa2bd9b(0xff)]('callback_query');const _0x7dbdf7=getDisabledBots();if(_0x7dbdf7[_0xa2bd9b(0x1ca)]==0x0)tgBot[_0xa2bd9b(0x17e)](_0x14fd13['chat']['id'],_0xa2bd9b(0x256))[_0xa2bd9b(0x10e)](_0x2d4c7a=>{telegramError(_0x2d4c7a);});else{if(_0x7dbdf7[_0xa2bd9b(0x1ca)]>0x1)_0x7dbdf7[_0xa2bd9b(0x18e)]({'botID':'all'});let _0x8fa231=[],_0x5a3323=[];const _0x21d7e8=_0x7dbdf7['length']%0x4==0x0||_0x7dbdf7[_0xa2bd9b(0x1ca)]%0x4==0x3||_0x7dbdf7[_0xa2bd9b(0x1ca)]%0x3==0x1?0x4:0x3;let _0x3b448b=0x0;_0x7dbdf7[_0xa2bd9b(0x1ea)]((_0x593a80,_0x51aac3)=>{const _0x1dc335=_0xa2bd9b;if(_0x51aac3%_0x21d7e8==0x0)_0x5a3323=[];_0x5a3323[_0x1dc335(0x18e)]({'text':_0x593a80[_0x1dc335(0x155)]=='all'?_0x1dc335(0xb7):_0x1dc335(0xaf)+_0x593a80['botID'],'callback_data':_0x593a80[_0x1dc335(0x155)]}),_0x51aac3%_0x21d7e8==0x0&&(_0x8fa231[_0x3b448b]=_0x5a3323,_0x3b448b++);}),tgBot['sendMessage'](_0x14fd13[_0xa2bd9b(0x183)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x8fa231}})[_0xa2bd9b(0x10e)](_0x3ed85f=>{telegramError(_0x3ed85f);}),tgBot['on']('callback_query',async _0x5ea4e6=>{const _0x35e0bb=_0xa2bd9b,_0x23f97c=_0x5ea4e6[_0x35e0bb(0x108)],_0x4ca130=_0x5ea4e6[_0x35e0bb(0x10d)];tgBot[_0x35e0bb(0xdc)](_0x5ea4e6['id'])[_0x35e0bb(0x1cd)](async()=>{const _0x16285c=_0x35e0bb;_0x23f97c==_0x16285c(0x18b)?(tgBot[_0x16285c(0x17e)](_0x4ca130[_0x16285c(0x183)]['id'],_0x16285c(0xd8))[_0x16285c(0x10e)](_0x23eb47=>{telegramError(_0x23eb47);}),_0x7dbdf7[_0x16285c(0x1ea)](_0x4e3792=>{const _0x56695e=_0x16285c;if(_0x4e3792[_0x56695e(0x155)]!=_0x56695e(0x18b))toggleBot(_0x4e3792[_0x56695e(0x155)],toggleStatus(_0x4e3792[_0x56695e(0x155)]),'stopped');})):(tgBot['sendMessage'](_0x4ca130[_0x16285c(0x183)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x23f97c)[_0x16285c(0x10e)](_0x7a7e44=>{telegramError(_0x7a7e44);}),toggleBot(_0x23f97c,toggleStatus(_0x23f97c),'stopped'));}),tgBot[_0x35e0bb(0xff)](_0x35e0bb(0x1c2));});}}),tgBot[_0x19715c(0x152)](/\/off/,_0x17ed83=>{const _0x28d906=_0x19715c;if(!validateTelegram(_0x17ed83))return;tgBot[_0x28d906(0xff)](_0x28d906(0x1c2));const _0x179c0d=getEnabledBots();if(_0x179c0d[_0x28d906(0x1ca)]==0x0)tgBot[_0x28d906(0x17e)](_0x17ed83['chat']['id'],_0x28d906(0x1c7))[_0x28d906(0x10e)](_0x268d60=>{telegramError(_0x268d60);});else{if(_0x179c0d[_0x28d906(0x1ca)]>0x1)_0x179c0d[_0x28d906(0x18e)]({'botID':'all'});let _0x2d239e=[],_0x5b2485=[];const _0x14f290=_0x179c0d['length']%0x4==0x0||_0x179c0d[_0x28d906(0x1ca)]%0x4==0x3||_0x179c0d[_0x28d906(0x1ca)]%0x3==0x1?0x4:0x3;let _0x9a3741=0x0;_0x179c0d['forEach']((_0x1ea2c7,_0x3850f2)=>{const _0x4b4d9c=_0x28d906;if(_0x3850f2%_0x14f290==0x0)_0x5b2485=[];_0x5b2485['push']({'text':_0x1ea2c7[_0x4b4d9c(0x155)]==_0x4b4d9c(0x18b)?_0x4b4d9c(0xb7):_0x4b4d9c(0xaf)+_0x1ea2c7[_0x4b4d9c(0x155)],'callback_data':_0x1ea2c7[_0x4b4d9c(0x155)]}),_0x3850f2%_0x14f290==0x0&&(_0x2d239e[_0x9a3741]=_0x5b2485,_0x9a3741++);}),tgBot[_0x28d906(0x17e)](_0x17ed83[_0x28d906(0x183)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x2d239e}})[_0x28d906(0x10e)](_0x499a09=>{telegramError(_0x499a09);}),tgBot['on'](_0x28d906(0x1c2),async _0x5151d9=>{const _0x27485e=_0x28d906,_0xdeecd=_0x5151d9[_0x27485e(0x108)],_0x22ad5c=_0x5151d9['message'];tgBot[_0x27485e(0xdc)](_0x5151d9['id'])[_0x27485e(0x1cd)](async()=>{const _0x444d73=_0x27485e;_0xdeecd==_0x444d73(0x18b)?(tgBot[_0x444d73(0x17e)](_0x22ad5c[_0x444d73(0x183)]['id'],_0x444d73(0xdd))[_0x444d73(0x10e)](_0x126219=>{telegramError(_0x126219);}),_0x179c0d['forEach'](_0x3f673f=>{const _0x3a5172=_0x444d73;if(_0x3f673f['botID']!=_0x3a5172(0x18b))toggleBot(_0x3f673f[_0x3a5172(0x155)],toggleStatus(_0x3f673f['botID']),_0x3a5172(0x202));})):(tgBot[_0x444d73(0x17e)](_0x22ad5c[_0x444d73(0x183)]['id'],_0x444d73(0xb9)+_0xdeecd)[_0x444d73(0x10e)](_0x3feaf8=>{telegramError(_0x3feaf8);}),toggleBot(_0xdeecd,toggleStatus(_0xdeecd),_0x444d73(0x202)));}),tgBot['removeListener'](_0x27485e(0x1c2));});}}),tgBot[_0x19715c(0x152)](/\/metrics/,_0x31d30f=>{const _0x33878d=_0x19715c;if(!validateTelegram(_0x31d30f))return;tgBot[_0x33878d(0xff)](_0x33878d(0x1c2));const _0x2e5716=getEnabledBots();if(_0x2e5716[_0x33878d(0x1ca)]==0x0)tgBot[_0x33878d(0x17e)](_0x31d30f[_0x33878d(0x183)]['id'],_0x33878d(0x1c7))['catch'](_0x2eedbd=>{telegramError(_0x2eedbd);});else{if(_0x2e5716[_0x33878d(0x1ca)]>0x1){let _0x54c6f2=[],_0x377c9e=[];const _0x3f6665=_0x2e5716[_0x33878d(0x1ca)]%0x4==0x0||_0x2e5716['length']%0x4==0x3||_0x2e5716[_0x33878d(0x1ca)]%0x3==0x1?0x4:0x3;let _0x7d2113=0x0;_0x2e5716[_0x33878d(0x1ea)]((_0xc07674,_0x597a81)=>{const _0xc31e43=_0x33878d;if(_0x597a81%_0x3f6665==0x0)_0x377c9e=[];_0x377c9e[_0xc31e43(0x18e)]({'text':'Bot\x20'+_0xc07674['botID'],'callback_data':_0xc07674[_0xc31e43(0x155)]}),_0x597a81%_0x3f6665==0x0&&(_0x54c6f2[_0x7d2113]=_0x377c9e,_0x7d2113++);}),tgBot[_0x33878d(0x17e)](_0x31d30f['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x54c6f2}})[_0x33878d(0x10e)](_0x25f834=>{telegramError(_0x25f834);}),tgBot['on']('callback_query',async _0x564923=>{const _0x3ffcb6=_0x33878d,_0x11f7fb=_0x564923[_0x3ffcb6(0x108)],_0x5b5ac4=_0x564923[_0x3ffcb6(0x10d)];tgBot[_0x3ffcb6(0xdc)](_0x564923['id'])[_0x3ffcb6(0x1cd)](async()=>{const _0x15bb5d=_0x3ffcb6;if(pid[_0x11f7fb])pid[_0x11f7fb][_0x15bb5d(0x1f1)]({'function':_0x15bb5d(0x118),'args':null});}),tgBot[_0x3ffcb6(0xff)](_0x3ffcb6(0x1c2));});}else{const _0xa765f4=_0x2e5716[0x0][_0x33878d(0x155)];if(pid[_0xa765f4])pid[_0xa765f4][_0x33878d(0x1f1)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x19715c(0x152)](/\/portfolio/,_0x283f82=>{const _0x1a679f=_0x19715c;if(!validateTelegram(_0x283f82))return;tgBot['removeListener'](_0x1a679f(0x1c2));const _0x52bd42=getEnabledBots();if(_0x52bd42[_0x1a679f(0x1ca)]==0x0)tgBot[_0x1a679f(0x17e)](_0x283f82['chat']['id'],_0x1a679f(0x1c7))[_0x1a679f(0x10e)](_0x5346bc=>{telegramError(_0x5346bc);});else{if(_0x52bd42['length']>0x1){let _0x5bd4a1=[],_0xa401e7=[];const _0x123a36=_0x52bd42['length']%0x4==0x0||_0x52bd42[_0x1a679f(0x1ca)]%0x4==0x3||_0x52bd42[_0x1a679f(0x1ca)]%0x3==0x1?0x4:0x3;let _0xd4ecde=0x0;_0x52bd42['forEach']((_0x4b6d69,_0x263386)=>{const _0x8fd473=_0x1a679f;if(_0x263386%_0x123a36==0x0)_0xa401e7=[];_0xa401e7[_0x8fd473(0x18e)]({'text':_0x8fd473(0xaf)+_0x4b6d69[_0x8fd473(0x155)],'callback_data':_0x4b6d69[_0x8fd473(0x155)]}),_0x263386%_0x123a36==0x0&&(_0x5bd4a1[_0xd4ecde]=_0xa401e7,_0xd4ecde++);}),tgBot[_0x1a679f(0x17e)](_0x283f82['chat']['id'],_0x1a679f(0x22d),{'reply_markup':{'inline_keyboard':_0x5bd4a1}})[_0x1a679f(0x10e)](_0x1cf4d5=>{telegramError(_0x1cf4d5);}),tgBot['on'](_0x1a679f(0x1c2),async _0x24e0f5=>{const _0x49ccd9=_0x1a679f,_0x1236a4=_0x24e0f5['data'],_0x46ae07=_0x24e0f5[_0x49ccd9(0x10d)];tgBot[_0x49ccd9(0xdc)](_0x24e0f5['id'])[_0x49ccd9(0x1cd)](async()=>{const _0x19c097=_0x49ccd9;if(pid[_0x1236a4])pid[_0x1236a4][_0x19c097(0x1f1)]({'function':_0x19c097(0x198),'args':null});}),tgBot[_0x49ccd9(0xff)]('callback_query');});}else{const _0x1c8e6d=_0x52bd42[0x0][_0x1a679f(0x155)];if(pid[_0x1c8e6d])pid[_0x1c8e6d][_0x1a679f(0x1f1)]({'function':_0x1a679f(0x198),'args':null});}}}),tgBot[_0x19715c(0x152)](/\/update/,async _0x513576=>{const _0x3d35c2=_0x19715c;if(!validateTelegram(_0x513576))return;tgBot[_0x3d35c2(0xff)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x3d35c2(0x17e)](_0x513576[_0x3d35c2(0x183)]['id'],_0x3d35c2(0x227))[_0x3d35c2(0x10e)](_0x2083ba=>{telegramError(_0x2083ba);});else!validInstallation?tgBot[_0x3d35c2(0x17e)](_0x513576[_0x3d35c2(0x183)]['id'],_0x3d35c2(0xc8))[_0x3d35c2(0x10e)](_0x2f1653=>{telegramError(_0x2f1653);}):(tgBot[_0x3d35c2(0x17e)](_0x513576[_0x3d35c2(0x183)]['id'],_0x3d35c2(0x1fa),{'reply_markup':{'inline_keyboard':[[{'text':_0x3d35c2(0x112),'callback_data':_0x3d35c2(0x1e0)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x29907e=>{telegramError(_0x29907e);}),tgBot['on']('callback_query',async _0x769217=>{const _0xb1031c=_0x3d35c2,_0x5d6a6b=_0x769217[_0xb1031c(0x108)],_0x21a953=_0x769217[_0xb1031c(0x10d)];tgBot['answerCallbackQuery'](_0x769217['id'])[_0xb1031c(0x1cd)](async()=>{const _0x4fb564=_0xb1031c;_0x5d6a6b==_0x4fb564(0x1e0)&&(await tgBot[_0x4fb564(0x17e)](_0x21a953[_0x4fb564(0x183)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x4fb564(0x10e)](_0x1754a4=>{telegramError(_0x1754a4);}),updateBB(_0x4fb564(0x275))),_0x5d6a6b=='no'&&await tgBot[_0x4fb564(0x17e)](_0x21a953[_0x4fb564(0x183)]['id'],_0x4fb564(0x16d))['catch'](_0x130381=>{telegramError(_0x130381);});}),tgBot['removeListener'](_0xb1031c(0x1c2));}));}),tgBot[_0x19715c(0x152)](/\/reinstall/,async _0x54dfdd=>{const _0x1fdd5f=_0x19715c;if(!validateTelegram(_0x54dfdd))return;tgBot[_0x1fdd5f(0xff)](_0x1fdd5f(0x1c2)),!validInstallation?tgBot[_0x1fdd5f(0x17e)](_0x54dfdd[_0x1fdd5f(0x183)]['id'],_0x1fdd5f(0xe9))[_0x1fdd5f(0x10e)](_0x58ea1a=>{telegramError(_0x58ea1a);}):(tgBot['sendMessage'](_0x54dfdd[_0x1fdd5f(0x183)]['id'],_0x1fdd5f(0x253),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x1fdd5f(0x1e0)},{'text':'No','callback_data':'no'}]]}})[_0x1fdd5f(0x10e)](_0x401b64=>{telegramError(_0x401b64);}),tgBot['on']('callback_query',async _0x4cc9e1=>{const _0x183dbd=_0x1fdd5f,_0x5ba998=_0x4cc9e1[_0x183dbd(0x108)],_0x4dba06=_0x4cc9e1[_0x183dbd(0x10d)];tgBot[_0x183dbd(0xdc)](_0x4cc9e1['id'])[_0x183dbd(0x1cd)](async()=>{const _0x49958e=_0x183dbd;_0x5ba998==_0x49958e(0x1e0)&&(await tgBot[_0x49958e(0x17e)](_0x4dba06[_0x49958e(0x183)]['id'],_0x49958e(0x21f))[_0x49958e(0x10e)](_0x3c9f87=>{telegramError(_0x3c9f87);}),updateBB(_0x49958e(0x1e2))),_0x5ba998=='no'&&await tgBot[_0x49958e(0x17e)](_0x4dba06[_0x49958e(0x183)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x49958e(0x10e)](_0x4fd86f=>{telegramError(_0x4fd86f);});}),tgBot[_0x183dbd(0xff)](_0x183dbd(0x1c2));}));}),tgBot['onText'](/\/toggle/,_0x138898=>{const _0x3bd359=_0x19715c;if(!validateTelegram(_0x138898))return;tgBot[_0x3bd359(0xff)](_0x3bd359(0x1c2));const _0x2c9dea=getBotsWithMode();if(_0x2c9dea[_0x3bd359(0x1ca)]==0x0)tgBot[_0x3bd359(0x17e)](_0x138898[_0x3bd359(0x183)]['id'],_0x3bd359(0x1c7))[_0x3bd359(0x10e)](_0x72f922=>{telegramError(_0x72f922);});else{let _0x3c078f=[],_0x2e763a=[];const _0x1519ac=0x2;let _0xba2071=0x0;_0x2c9dea[_0x3bd359(0x1ea)]((_0x5e6617,_0x3beea5)=>{const _0x10e619=_0x3bd359;if(_0x3beea5%_0x1519ac==0x0)_0x2e763a=[];_0x2e763a[_0x10e619(0x18e)]({'text':'Bot\x20'+_0x5e6617['botID']+'\x20('+_0x5e6617[_0x10e619(0x120)]+')','callback_data':_0x5e6617['botID']}),_0x3beea5%_0x1519ac==0x0&&(_0x3c078f[_0xba2071]=_0x2e763a,_0xba2071++);}),tgBot[_0x3bd359(0x17e)](_0x138898[_0x3bd359(0x183)]['id'],_0x3bd359(0x17c),{'reply_markup':{'inline_keyboard':_0x3c078f}})[_0x3bd359(0x10e)](_0x3cd0c4=>{telegramError(_0x3cd0c4);}),tgBot['on']('callback_query',async _0x4e9927=>{const _0x425ac9=_0x3bd359,_0x3dfed9=_0x4e9927[_0x425ac9(0x108)],_0x394110=_0x4e9927['message'];tgBot[_0x425ac9(0xdc)](_0x4e9927['id'])[_0x425ac9(0x1cd)](async()=>{const _0x3c6a4e=_0x425ac9,_0x14d62a=_0x2c9dea[_0x3c6a4e(0x1e8)](_0x1fb8af=>_0x1fb8af[_0x3c6a4e(0x155)]==_0x3dfed9),_0x21f45a=_0x14d62a['mode']=='auto'?_0x3c6a4e(0x16b):_0x3c6a4e(0x1c3);tgBot['sendMessage'](_0x394110['chat']['id'],_0x3c6a4e(0x175)+_0x3dfed9+_0x3c6a4e(0x1cb)+_0x21f45a+'\x20mode')['catch'](_0x3cd140=>{telegramError(_0x3cd140);}),toggleBotMode(_0x3dfed9);}),tgBot[_0x425ac9(0xff)](_0x425ac9(0x1c2));});}}),tgBot['onText'](/\/names/,_0x52e755=>{const _0x172bc0=_0x19715c;if(!validateTelegram(_0x52e755))return;let _0x27fe7e='';config[_0x172bc0(0x1ea)](_0x4fe223=>{const _0xc16fdf=_0x172bc0;_0x27fe7e+=_0xc16fdf(0xaf)+_0x4fe223['botID']+':\x20'+_0x4fe223[_0xc16fdf(0x11c)]+'\x0a';}),tgBot[_0x172bc0(0x17e)](_0x52e755[_0x172bc0(0x183)]['id'],_0x27fe7e,{'parse_mode':_0x172bc0(0x24f)})['catch'](_0xeaa4fc=>{telegramError(_0xeaa4fc);});}),tgBot[_0x19715c(0x152)](/\/disable/,_0x1c91eb=>{const _0x36787e=_0x19715c;if(!validateTelegram(_0x1c91eb))return;tgBot[_0x36787e(0x17e)](_0x1c91eb[_0x36787e(0x183)]['id'],_0x36787e(0xbb))[_0x36787e(0x10e)](_0x5d2b4b=>{telegramError(_0x5d2b4b);}),updateSetting(_0x36787e(0x1b6),![]);}),tgBot['onText'](/\/help/,_0x383b97=>{const _0x3eefb7=_0x19715c;if(!validateTelegram(_0x383b97))return;tgBot['sendMessage'](_0x383b97[_0x3eefb7(0x183)]['id'],_0x513bbb)[_0x3eefb7(0x10e)](_0x2f0a2c=>{telegramError(_0x2f0a2c);});}),tgBot['on'](_0x19715c(0x25c),_0x3fcb7b=>{const _0x2cb2bc=_0x19715c;_0x3fcb7b[_0x2cb2bc(0x114)]()[_0x2cb2bc(0x210)](_0x2cb2bc(0x21b))&&(logger[_0x2cb2bc(0x122)](_0x2cb2bc(0x1a4)),tgBot[_0x2cb2bc(0x243)](),tgBot=null,io['to'](_0x2cb2bc(0x165))[_0x2cb2bc(0x224)](_0x2cb2bc(0xa1),_0x2cb2bc(0x1a4)));}),process[_0x19715c(0x123)](_0x19715c(0x19c),()=>{const _0x11a3b7=_0x19715c;if(tgBot)tgBot[_0x11a3b7(0x243)]();process[_0x11a3b7(0x13d)](0x1);}),process['once']('SIGTERM',()=>{const _0x384ef6=_0x19715c;if(tgBot)tgBot[_0x384ef6(0x243)]();process[_0x384ef6(0x13d)](0x1);});}}function disableTelegram(){const _0x141c05=_0x4a7179;tgBot&&(tgBot[_0x141c05(0x243)](),tgBot=null);}function sendTelegram(_0x1014fd,_0x404901){const _0x1571df=_0x4a7179;if(settings[_0x1571df(0x1b6)]){if(settings['telegramEvents']==_0x1571df(0x18b)||(_0x404901[_0x1571df(0x222)]=='error'||_0x404901[_0x1571df(0x222)]==_0x1571df(0x1e3)||_0x404901[_0x1571df(0x222)]==_0x1571df(0x1b3))&&settings['telegramEvents']==_0x1571df(0x103)||_0x404901[_0x1571df(0x222)]=='order'&&settings[_0x1571df(0x187)]==_0x1571df(0x1eb)){if(tgBot&&settings[_0x1571df(0xb6)]){if(_0x404901[_0x1571df(0xbc)])tgBot[_0x1571df(0x17e)](settings[_0x1571df(0xb6)],_0x404901[_0x1571df(0x11c)]+'\x20>\x20'+_0x404901[_0x1571df(0xa0)])[_0x1571df(0x10e)](_0x4da94c=>{telegramError(_0x4da94c);});else tgBot['sendMessage'](settings[_0x1571df(0xb6)],_0x1571df(0xaf)+_0x1014fd+_0x1571df(0x1b4)+_0x404901[_0x1571df(0xa0)])[_0x1571df(0x10e)](_0x59a9ef=>{telegramError(_0x59a9ef);});}}}}async function sendTelegramMsg(_0x19b2b5,_0x4b98dd=_0x4a7179(0x24f)){const _0x2a50ae=_0x4a7179;return settings[_0x2a50ae(0x1b6)]&&tgBot&&settings[_0x2a50ae(0xb6)]?(await tgBot[_0x2a50ae(0x17e)](settings['telegramChatId'],_0x19b2b5,{'parse_mode':_0x4b98dd})[_0x2a50ae(0x10e)](_0x1f6639=>{telegramError(_0x1f6639);}),!![]):![];}function getDeviceWithIp(_0x52c1c8){return devices['find'](_0x4f4eba=>_0x4f4eba['ip']===_0x52c1c8);}function temporaryAccess2FA(_0x389a63,_0x4ccbf4){const _0x3475a1=_0x4a7179;let _0x341fdd=new Date(),_0x281130=![];if(lastIpApproval){if(_0x341fdd-lastIpApproval<0x1388)_0x281130=!![];}lastIpApproval=new Date();if(_0x281130)return;tgBot&&settings[_0x3475a1(0xb6)]&&(tgBot['removeListener'](_0x3475a1(0x1c2)),tgBot[_0x3475a1(0x17e)](settings[_0x3475a1(0xb6)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x4ccbf4)[_0x3475a1(0x197)]+_0x3475a1(0xae),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3475a1(0x234),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x3475a1(0x137),'callback_data':'30'},{'text':'reject','callback_data':_0x3475a1(0xc5)}]]}})[_0x3475a1(0x10e)](_0x588775=>{telegramError(_0x588775);}),tgBot['on'](_0x3475a1(0x1c2),async _0x573e81=>{const _0x3286b7=_0x3475a1,_0x4eb185=_0x573e81[_0x3286b7(0x108)],_0x3dc9f9=_0x573e81['message'];tgBot[_0x3286b7(0xdc)](_0x573e81['id'])[_0x3286b7(0x1cd)](async()=>{const _0x28c310=_0x3286b7;devices[_0x389a63][_0x28c310(0x1b9)]={'clientip':_0x4ccbf4,'timestamp':new Date()[_0x28c310(0x1aa)](),'expiry':_0x4eb185},_0x4eb185!=_0x28c310(0xc5)?(await tgBot['sendMessage'](_0x3dc9f9[_0x28c310(0x183)]['id'],_0x28c310(0x1de)+_0x4eb185+'\x20minutes',{'parse_mode':_0x28c310(0x24f)})[_0x28c310(0x10e)](_0x5b3656=>{telegramError(_0x5b3656);}),io['to'](_0x389a63)['emit'](_0x28c310(0x170),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x28c310(0x17e)](_0x3dc9f9[_0x28c310(0x183)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x526e69=>{telegramError(_0x526e69);}),io['to'](_0x389a63)[_0x28c310(0x224)](_0x28c310(0x170),{'access':{'allow':![],'reason':_0x28c310(0x13e),'token':null}}));}),tgBot['removeListener'](_0x3286b7(0x1c2));}));}function loginAccess2FA(_0xdb937e,_0x94d3f3){const _0xfb44d9=_0x4a7179;tgBot&&settings[_0xfb44d9(0xb6)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings[_0xfb44d9(0xb6)],_0xfb44d9(0xa2)+normalizeIP(_0x94d3f3)[_0xfb44d9(0x197)]+_0xfb44d9(0xae),{'parse_mode':_0xfb44d9(0x24f),'reply_markup':{'inline_keyboard':[[{'text':_0xfb44d9(0x1fc),'callback_data':loginExpiry},{'text':_0xfb44d9(0xc5),'callback_data':'reject'}]]}})[_0xfb44d9(0x10e)](_0x3791ce=>{telegramError(_0x3791ce);}),tgBot['on']('callback_query',async _0x57ffc0=>{const _0x127284=_0xfb44d9,_0x3c3d26=_0x57ffc0['data'],_0xd015ff=_0x57ffc0[_0x127284(0x10d)];tgBot[_0x127284(0xdc)](_0x57ffc0['id'])[_0x127284(0x1cd)](async()=>{const _0x29bc5d=_0x127284;devices[_0xdb937e][_0x29bc5d(0x261)]={'clientip':_0x94d3f3,'timestamp':new Date()[_0x29bc5d(0x1aa)](),'expiry':_0x3c3d26},_0x3c3d26!=_0x29bc5d(0xc5)?(await tgBot[_0x29bc5d(0x17e)](_0xd015ff[_0x29bc5d(0x183)]['id'],_0x29bc5d(0x1f7),{'parse_mode':_0x29bc5d(0x24f)})[_0x29bc5d(0x10e)](_0x31a37f=>{telegramError(_0x31a37f);}),io['to'](_0xdb937e)[_0x29bc5d(0x224)](_0x29bc5d(0x170),{'access':{'allow':![],'reason':_0x29bc5d(0x1d3),'token':null}})):(await tgBot[_0x29bc5d(0x17e)](_0xd015ff[_0x29bc5d(0x183)]['id'],'Login\x20rejected')[_0x29bc5d(0x10e)](_0x4f6115=>{telegramError(_0x4f6115);}),io['to'](_0xdb937e)[_0x29bc5d(0x224)](_0x29bc5d(0x170),{'access':{'allow':![],'reason':_0x29bc5d(0x147),'token':null}}));}),tgBot[_0x127284(0xff)](_0x127284(0x1c2));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1ac19f=_0x4a7179;return dbConfig['get'](_0x1ac19f(0x130))['sortBy'](_0x1ac19f(0x155))[_0x1ac19f(0x1ae)]({'status':_0x1ac19f(0x265)})['value']()||[];}function getDisabledBots(){const _0x57e744=_0x4a7179;return dbConfig['get'](_0x57e744(0x130))[_0x57e744(0x20c)](_0x57e744(0x155))[_0x57e744(0x1ae)]({'status':'disabled'})[_0x57e744(0x272)]()||[];}function getBotAttributes(_0x24c015){const _0x95756b=_0x4a7179;let _0x5cf5c7={};const _0x1609b6=configpath+_0x95756b(0xce)+_0x24c015+_0x95756b(0x240),_0xbfc411=fs[_0x95756b(0x1ba)](_0x1609b6);if(_0xbfc411){const _0x59e76a=fs[_0x95756b(0x181)](_0x1609b6);try{const _0x3e20c6=JSON[_0x95756b(0xfa)](_0x59e76a),_0x5d1294=_0x3e20c6?_0x3e20c6['bot'][0x0][_0x95756b(0x1fb)]:![];_0x5cf5c7['mode']=_0x5d1294?_0x95756b(0x1c3):_0x95756b(0x16b),_0x5cf5c7[_0x95756b(0x11c)]=_0x3e20c6?_0x3e20c6[_0x95756b(0x141)][0x0]['botname']:'Bot\x20'+_0x24c015;}catch(_0x755e19){_0x5cf5c7[_0x95756b(0x120)]='manual',_0x5cf5c7[_0x95756b(0x11c)]=_0x95756b(0xaf)+_0x24c015;}}else _0x5cf5c7[_0x95756b(0x120)]=_0x95756b(0x16b),_0x5cf5c7[_0x95756b(0x11c)]=_0x95756b(0xaf)+_0x24c015;return _0x5cf5c7;}function getBotsWithMode(){const _0x39a912=_0x4a7179,_0x383b2f=dbConfig[_0x39a912(0xd4)](_0x39a912(0x130))[_0x39a912(0x20c)](_0x39a912(0x155))[_0x39a912(0x272)]()||[];return _0x383b2f[_0x39a912(0x1ea)](_0x302f7b=>{const _0x32f2fe=_0x39a912;let _0x5bb820=getBotAttributes(_0x302f7b['botID']);_0x302f7b[_0x32f2fe(0x120)]=_0x5bb820[_0x32f2fe(0x120)];}),_0x383b2f;}function getBotExchanges(){const _0x557a84=_0x4a7179;let _0x4b1f10=[];const _0x50fca2=dbConfig[_0x557a84(0xd4)](_0x557a84(0x130))['sortBy'](_0x557a84(0x155))[_0x557a84(0x272)]()||[];_0x50fca2['forEach'](_0x450947=>{const _0xd239ec=_0x557a84;if(_0x450947['status']=='enabled'){const _0x336435=configpath+_0xd239ec(0xce)+_0x450947[_0xd239ec(0x155)]+'-config.json',_0x21fb82=fs[_0xd239ec(0x1ba)](_0x336435);let _0x16e55a;if(_0x21fb82){const _0xbecf7b=fs[_0xd239ec(0x181)](_0x336435);try{const _0x131985=JSON[_0xd239ec(0xfa)](_0xbecf7b);_0x16e55a=_0x131985?_0x131985['bot'][0x0]['exchange']:null;}catch(_0x15f83a){}}if(_0x16e55a)_0x4b1f10[_0xd239ec(0x18e)](_0x16e55a);}});const _0xbc8229=[...new Set(_0x4b1f10)][_0x557a84(0x1d4)]();return _0xbc8229;}async function initUser(){const _0x12cbc7=_0x4a7179;if(!settings[_0x12cbc7(0x20d)]){const _0x433b3f=uuidRandom();mixpanel['alias'](_0x433b3f),updateSetting(_0x12cbc7(0x20d),_0x433b3f);}}async function initSecure(){const _0x1bc558=_0x4a7179;let _0x290dda=getSecure();if(!_0x290dda['hasOwnProperty'](_0x1bc558(0x1a5))){let _0xa03646=await generateKeys();_0x290dda['publicKey']=_0xa03646['publicKey'],_0x290dda['privateKey']=_0xa03646['privateKey'],_0x290dda[_0x1bc558(0x1a5)]=crypto[_0x1bc558(0x1df)](0x20)[_0x1bc558(0x114)](_0x1bc558(0xd2));;storeSecure(_0x290dda);}}function getSettings(){const _0x3b84e4=_0x4a7179;return dbSettings[_0x3b84e4(0xd4)]('settings')[_0x3b84e4(0x272)]()||{};}function getSecure(){const _0x5d398e=_0x4a7179;return dbSecure['get'](_0x5d398e(0x15e))['value']()||{};}function getBlacklist(){const _0x572d68=_0x4a7179;return dbSecure[_0x572d68(0xd4)](_0x572d68(0x100))[_0x572d68(0x272)]()||[];}function broadcastToBots(_0x230a81,_0x77dbab){const _0x3e90f7=_0x4a7179;config[_0x3e90f7(0x1ea)](_0x568aeb=>{const _0xb217c5=_0x3e90f7;if(_0x568aeb['status']=='enabled'&&_0x568aeb['live']==_0xb217c5(0x236)||_0x568aeb['status']==_0xb217c5(0xb5)&&_0x568aeb['live']=='running'){if(pid[_0x568aeb['botID']])pid[_0x568aeb[_0xb217c5(0x155)]][_0xb217c5(0x1f1)]({[_0x230a81]:_0x77dbab});}});}function storeSettings(_0x51aa32,_0x76ff3=![]){const _0xcedebe=_0x4a7179;_0x51aa32={...settings,..._0x51aa32};if(_0x76ff3&&_0x51aa32['bbPassword']!='************'&&_0x51aa32[_0xcedebe(0x214)]!=_0xcedebe(0x177)&&_0x51aa32['bbPassword']!=''){const _0x434a8c=crypt['decrypt'](secure[_0xcedebe(0x1fe)],_0x51aa32[_0xcedebe(0x214)])['message']['split']('@')[0x0],_0x53c161=bcrypt[_0xcedebe(0x142)](_0x434a8c,saltRounds);_0x51aa32={..._0x51aa32,'bbPassword':_0x53c161};}if(_0x76ff3&&_0x51aa32[_0xcedebe(0x113)]!='************'&&_0x51aa32['telegramToken']!=_0xcedebe(0x177)&&_0x51aa32[_0xcedebe(0x113)]!=''){const _0x1dde00=crypt['decrypt'](secure[_0xcedebe(0x1fe)],_0x51aa32[_0xcedebe(0x113)])[_0xcedebe(0x10d)][_0xcedebe(0x18d)]('@')[0x0];_0x51aa32={..._0x51aa32,'telegramToken':_0x1dde00};}const _0x7b96b9=_0x51aa32[_0xcedebe(0x113)]!=_0xcedebe(0xcc)&&_0x51aa32[_0xcedebe(0x113)]!=settings[_0xcedebe(0x113)]||_0x51aa32[_0xcedebe(0x26b)]!=settings[_0xcedebe(0x26b)],_0x2679db=_0x51aa32[_0xcedebe(0x113)]==''||_0x51aa32[_0xcedebe(0x26b)]=='';if(_0x7b96b9)_0x51aa32['telegramEvents']=_0xcedebe(0x18b);for(const [_0x40e0aa,_0x2f8d7a]of Object[_0xcedebe(0xe5)](_0x51aa32)){if(_0x40e0aa=='telegramToken'&&_0x2f8d7a==_0xcedebe(0xcc)){_0x51aa32[_0xcedebe(0x113)]=settings[_0xcedebe(0x113)];continue;};if(_0x40e0aa==_0xcedebe(0x214)&&_0x2f8d7a==_0xcedebe(0xcc)){_0x51aa32[_0xcedebe(0x214)]=settings[_0xcedebe(0x214)];continue;};dbSettings[_0xcedebe(0x15b)](_0xcedebe(0x207)+_0x40e0aa,_0x2f8d7a)[_0xcedebe(0x18f)]();}settings=_0x51aa32,io['to'](_0xcedebe(0x165))[_0xcedebe(0x224)](_0xcedebe(0x1db),cleanSettings()),broadcastToBots('timeshift',settings[_0xcedebe(0x219)]),broadcastToBots(_0xcedebe(0x10a),settings[_0xcedebe(0x10a)]);if(_0x7b96b9&&!_0x2679db)initTelegram();if(_0x7b96b9&&_0x2679db)disableTelegram();getAllClients()[_0xcedebe(0x1ea)](_0x663fbe=>{const _0x3c04ed=_0xcedebe;getSocket(_0x663fbe['id'])[_0x3c04ed(0x224)](_0x3c04ed(0x170),{'access':{'allow':![],'reason':_0x3c04ed(0x1d3),'token':null}});});}function updateSetting(_0x534ffe,_0x43c9f2){const _0x31e076=_0x4a7179;dbSettings['set'](_0x31e076(0x207)+_0x534ffe,_0x43c9f2)[_0x31e076(0x18f)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x31e076(0x1db),cleanSettings());}function storeSecure(_0xe0a6c4){const _0x62d6e=_0x4a7179;dbSecure[_0x62d6e(0xd4)](_0x62d6e(0x15e))[_0x62d6e(0x18e)](_0xe0a6c4)['write'](),secure=_0xe0a6c4;}function addBlacklist(_0x4033d8){const _0x464ce1=_0x4a7179;cleanBlacklist();let _0x2278e5;devices[_0x4033d8][_0x464ce1(0x1b9)]?_0x2278e5=Math[_0x464ce1(0x10c)](devices[_0x4033d8][_0x464ce1(0x1b9)][_0x464ce1(0x1b5)],loginExpiry):_0x2278e5=loginExpiry,dbSecure[_0x464ce1(0xd4)](_0x464ce1(0x100))[_0x464ce1(0x18e)]({'expiry':new Date()['getTime']()+_0x2278e5*0x3c*0x3e8,'token':devices[_0x4033d8][_0x464ce1(0xe0)][_0x464ce1(0x23e)]})[_0x464ce1(0x18f)](),blacklist=dbSecure['get'](_0x464ce1(0x100))[_0x464ce1(0x272)]();}function cleanBlacklist(){const _0xe5a847=_0x4a7179;let _0x5021de=dbSecure['get'](_0xe5a847(0x100))[_0xe5a847(0x259)]()[_0xe5a847(0x272)](),_0xcc05ee=new Date()[_0xe5a847(0x1aa)]();_0x5021de['forEach'](_0x2a83f4=>{const _0x38c6c5=_0xe5a847;_0x2a83f4[_0x38c6c5(0x1b5)]<_0xcc05ee&&dbSecure[_0x38c6c5(0xd4)](_0x38c6c5(0x100))[_0x38c6c5(0xdb)]({'expiry':_0x2a83f4[_0x38c6c5(0x1b5)]})['write']();});}function initStates(){const _0x41149a=_0x4a7179;let _0x3283de=getConfiguration();_0x3283de[_0x41149a(0x1ea)](_0x210266=>{const _0x17a12b=_0x41149a;_0x210266[_0x17a12b(0x19b)]='stopped';}),storeConfiguration(_0x3283de);}function onKeys(){const _0x4cf6be=new RSA();return new Promise(_0x1f5c49=>{const _0x463747=_0x2923;_0x4cf6be[_0x463747(0x9e)]()[_0x463747(0x1cd)](_0x3b3516=>{_0x1f5c49(_0x3b3516);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3521f2=_0x4a7179;let _0x43cff3=getSettings(),_0x3fb37e=![];!_0x43cff3[_0x3521f2(0x268)]('lastmsgtelegram')&&(_0x43cff3[_0x3521f2(0x1c6)]=0x0,_0x3fb37e=!![]);!_0x43cff3[_0x3521f2(0x268)](_0x3521f2(0x125))&&(_0x43cff3[_0x3521f2(0x125)]=0x0,_0x3fb37e=!![]);!_0x43cff3[_0x3521f2(0x268)](_0x3521f2(0xf5))&&(_0x43cff3[_0x3521f2(0xf5)]=_0x3521f2(0x1e7),_0x3fb37e=!![]);!_0x43cff3[_0x3521f2(0x268)](_0x3521f2(0x10a))&&(_0x43cff3[_0x3521f2(0x10a)]=![],_0x3fb37e=!![]);if(_0x3fb37e)storeSettings(_0x43cff3);}function storeConfiguration(_0x32de9a){const _0x100591=_0x4a7179;dbConfig['get'](_0x100591(0x130))['remove']()[_0x100591(0x18f)](),_0x32de9a['forEach'](_0x420e53=>{const _0xe2bc8e=_0x100591;delete _0x420e53[_0xe2bc8e(0x120)];}),dbConfig[_0x100591(0xd4)](_0x100591(0x130))[_0x100591(0x18e)](..._0x32de9a)[_0x100591(0x18f)](),config=_0x32de9a;}function resetPassword(){const _0x1eb920=_0x4a7179;tgBot&&settings[_0x1eb920(0xb6)]&&(tgBot[_0x1eb920(0xff)](_0x1eb920(0x1c2)),tgBot[_0x1eb920(0x17e)](settings[_0x1eb920(0xb6)],_0x1eb920(0x18c),{'parse_mode':_0x1eb920(0x24f),'reply_markup':{'inline_keyboard':[[{'text':_0x1eb920(0x1e0),'callback_data':_0x1eb920(0x1e0)},{'text':'no','callback_data':'no'}]]}})[_0x1eb920(0x10e)](_0x3604bd=>{telegramError(_0x3604bd);}),tgBot['on']('callback_query',async _0x2e0e52=>{const _0xfef30c=_0x1eb920,_0xa328e6=_0x2e0e52[_0xfef30c(0x108)],_0x71c26c=_0x2e0e52[_0xfef30c(0x10d)];tgBot[_0xfef30c(0xdc)](_0x2e0e52['id'])[_0xfef30c(0x1cd)](async()=>{const _0x4aee2d=_0xfef30c;if(_0xa328e6!='no'){const _0x12f2d4=0xf,_0x14ee54=_0x4aee2d(0x205),_0x5a0fdd=Array[_0x4aee2d(0x1f8)](crypto[_0x4aee2d(0xe4)](new Uint32Array(_0x12f2d4)))[_0x4aee2d(0x23a)](_0x4bb8ea=>_0x14ee54[_0x4bb8ea%_0x14ee54[_0x4aee2d(0x1ca)]])['join'](''),_0x15257f=bcrypt[_0x4aee2d(0x142)](_0x5a0fdd,saltRounds);storeSettings({'bbPassword':_0x15257f}),await tgBot[_0x4aee2d(0x17e)](_0x71c26c['chat']['id'],_0x4aee2d(0x200)+_0x5a0fdd,{'parse_mode':_0x4aee2d(0x24f)})[_0x4aee2d(0x10e)](_0x302917=>{telegramError(_0x302917);});}else await tgBot['sendMessage'](_0x71c26c[_0x4aee2d(0x183)]['id'],'Password\x20reset\x20rejected')[_0x4aee2d(0x10e)](_0x1ade48=>{telegramError(_0x1ade48);});}),tgBot[_0xfef30c(0xff)](_0xfef30c(0x1c2));}));}async function confirmRestore(_0x771d10,_0x34ff28){const _0x5d5c0e=_0x4a7179;io['to']('botmanager')['emit']('notification',_0x5d5c0e(0x124),_0x5d5c0e(0x1b3)),tgBot&&settings[_0x5d5c0e(0xb6)]&&(tgBot[_0x5d5c0e(0xff)](_0x5d5c0e(0x1c2)),await tgBot[_0x5d5c0e(0x17e)](settings[_0x5d5c0e(0xb6)],_0x5d5c0e(0x1d8),{'parse_mode':_0x5d5c0e(0x24f),'reply_markup':{'inline_keyboard':[[{'text':_0x5d5c0e(0x1e0),'callback_data':_0x5d5c0e(0x1e0)},{'text':'no','callback_data':'no'}]]}})[_0x5d5c0e(0x10e)](_0x37bb6e=>{telegramError(_0x37bb6e);}),tgBot['on'](_0x5d5c0e(0x1c2),async _0x288c09=>{const _0x258e80=_0x5d5c0e,_0x2d9237=_0x288c09['data'],_0x4b3925=_0x288c09[_0x258e80(0x10d)];tgBot[_0x258e80(0xdc)](_0x288c09['id'])[_0x258e80(0x1cd)](async()=>{const _0x59e6a7=_0x258e80;_0x2d9237==_0x59e6a7(0x1e0)?(await tgBot[_0x59e6a7(0x17e)](_0x4b3925['chat']['id'],_0x59e6a7(0x17d),{'parse_mode':_0x59e6a7(0x24f)})['catch'](_0x45b1f2=>{telegramError(_0x45b1f2);}),unzipFile(_0x771d10,_0x34ff28)):(logger[_0x59e6a7(0x20a)](_0x59e6a7(0x1ed)),await tgBot[_0x59e6a7(0x17e)](_0x4b3925[_0x59e6a7(0x183)]['id'],'Restore\x20process\x20aborted')[_0x59e6a7(0x10e)](_0x6dfabc=>{telegramError(_0x6dfabc);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x16ef9a=_0x4a7179,_0x45cd22=new Date();return _0x45cd22[_0x16ef9a(0x266)]()+'/'+(_0x45cd22['getMonth']()+0x1)['toString']()[_0x16ef9a(0x1f4)](0x2,'0')+'/'+_0x45cd22[_0x16ef9a(0x24b)]()['toString']()[_0x16ef9a(0x1f4)](0x2,'0')+'\x20'+_0x45cd22[_0x16ef9a(0x1a3)]()[_0x16ef9a(0x114)]()[_0x16ef9a(0x1f4)](0x2,'0')+':'+_0x45cd22[_0x16ef9a(0x225)]()[_0x16ef9a(0x114)]()[_0x16ef9a(0x1f4)](0x2,'0')+':'+_0x45cd22['getSeconds']()[_0x16ef9a(0x114)]()[_0x16ef9a(0x1f4)](0x2,'0');}function getTimeStamp(){const _0x1111b4=_0x4a7179,_0x48af25=shiftedTime();return _0x48af25[_0x1111b4(0x266)]()+'/'+(_0x48af25[_0x1111b4(0x1e1)]()+0x1)[_0x1111b4(0x114)]()[_0x1111b4(0x1f4)](0x2,'0')+'/'+_0x48af25[_0x1111b4(0x24b)]()[_0x1111b4(0x114)]()[_0x1111b4(0x1f4)](0x2,'0')+'\x20'+_0x48af25['getHours']()[_0x1111b4(0x114)]()['padStart'](0x2,'0')+':'+_0x48af25[_0x1111b4(0x225)]()[_0x1111b4(0x114)]()[_0x1111b4(0x1f4)](0x2,'0')+':'+_0x48af25[_0x1111b4(0x211)]()[_0x1111b4(0x114)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x34ff9b=_0x4a7179,_0x1bf1b1=shiftedTime();return _0x1bf1b1[_0x34ff9b(0x266)]()+(_0x1bf1b1[_0x34ff9b(0x1e1)]()+0x1)[_0x34ff9b(0x114)]()[_0x34ff9b(0x1f4)](0x2,'0')+_0x1bf1b1['getDate']()[_0x34ff9b(0x114)]()[_0x34ff9b(0x1f4)](0x2,'0')+'-'+_0x1bf1b1['getHours']()[_0x34ff9b(0x114)]()[_0x34ff9b(0x1f4)](0x2,'0')+_0x1bf1b1[_0x34ff9b(0x225)]()['toString']()[_0x34ff9b(0x1f4)](0x2,'0')+_0x1bf1b1[_0x34ff9b(0x211)]()[_0x34ff9b(0x114)]()[_0x34ff9b(0x1f4)](0x2,'0');}function shiftedTime(){const _0x571bd2=_0x4a7179,_0x348e52=new Date();let _0x4dbf99=_0x348e52;if(settings[_0x571bd2(0x219)]&&settings[_0x571bd2(0x219)]!==0x0)_0x4dbf99=fns[_0x571bd2(0x269)](_0x348e52,{'hours':settings[_0x571bd2(0x219)]});return _0x4dbf99;}function startScheduler(){const _0x27ad4d=_0x4a7179,_0x5fc4a6=new Date()[_0x27ad4d(0xca)](),_0x5dedba=shiftedTime()[_0x27ad4d(0x1a3)]();_0x5dedba==0x4&&backupConfigFiles();_0x5dedba==0x0&&rotateLogFiles();_0x5fc4a6%0x6==0x0&&triggerAnalytics();_0x5fc4a6%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3e6aab){const _0x38d7af=_0x4a7179;logger['debug'](_0x38d7af(0x1f5)+_0x3e6aab);const _0x2e741a=getBotsWithMode();_0x2e741a[_0x38d7af(0x1ca)]>0x0?confirmRestore(configbackuppath,_0x3e6aab):unzipFile(configbackuppath,_0x3e6aab);}async function getBackupFiles(_0x168170=null){const _0x2ad76e=_0x4a7179;let _0x5d0aba=[],_0x5cab4b=fs[_0x2ad76e(0x192)](configbackuppath,{'withFileTypes':!![]});_0x5cab4b[_0x2ad76e(0x1d4)]((_0x29f7cc,_0x50959c)=>_0x29f7cc[_0x2ad76e(0x9d)]<_0x50959c[_0x2ad76e(0x9d)]?0x1:_0x50959c['name']<_0x29f7cc['name']?-0x1:0x0),_0x5cab4b[_0x2ad76e(0x1ea)](_0x1bccb1=>{const _0x37dcb7=_0x2ad76e;if(!_0x1bccb1[_0x37dcb7(0xb0)]()&&_0x1bccb1[_0x37dcb7(0x9d)][_0x37dcb7(0x127)]('backup-full@')&&_0x1bccb1[_0x37dcb7(0x9d)][_0x37dcb7(0xf1)](_0x37dcb7(0x232))){const _0x2e38ae=formatDate(fs[_0x37dcb7(0x242)](configbackuppath+_0x1bccb1[_0x37dcb7(0x9d)])[_0x37dcb7(0x254)]);_0x5d0aba[_0x37dcb7(0x18e)]({'name':_0x1bccb1[_0x37dcb7(0x9d)],'mtime':_0x2e38ae});}});if(_0x168170)io['to'](_0x168170)['emit'](_0x2ad76e(0x1bc),_0x5d0aba);else return _0x5d0aba;}async function backupConfigFiles(){const _0x2a9a2a=_0x4a7179;await zipFiles(_0x2a9a2a(0xb4));const _0x4ed07e=getCleanTimeStamp();fs[_0x2a9a2a(0xa6)](zippath+_0x2a9a2a(0x156),configbackuppath+('backup-full@'+_0x4ed07e+_0x2a9a2a(0x232)));let _0x27d89f=fs[_0x2a9a2a(0x192)](configbackuppath,{'withFileTypes':!![]});_0x27d89f[_0x2a9a2a(0x1d4)]((_0x1b12bc,_0x7dc783)=>_0x1b12bc[_0x2a9a2a(0x9d)]<_0x7dc783[_0x2a9a2a(0x9d)]?0x1:_0x7dc783[_0x2a9a2a(0x9d)]<_0x1b12bc[_0x2a9a2a(0x9d)]?-0x1:0x0),_0x27d89f[_0x2a9a2a(0x1ca)]>maxBackups&&fs[_0x2a9a2a(0x132)](configbackuppath+_0x27d89f[maxBackups][_0x2a9a2a(0x9d)]);}function rotateLogFiles(){const _0x1a1c1a=_0x4a7179,_0x1b2e74=fs['statSync'](logspath+'output-000.log'),_0x50d8d9=_0x1b2e74[_0x1a1c1a(0x14d)]/0x400;if(_0x50d8d9>0x64){let _0x189fe0=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x189fe0[_0x1a1c1a(0x1d4)]((_0x3855cc,_0x228d2d)=>_0x3855cc[_0x1a1c1a(0x9d)]<_0x228d2d[_0x1a1c1a(0x9d)]?0x1:_0x228d2d[_0x1a1c1a(0x9d)]<_0x3855cc[_0x1a1c1a(0x9d)]?-0x1:0x0),_0x189fe0['forEach'](_0x5b6af7=>{const _0x1861fa=_0x1a1c1a;if(_0x5b6af7['name']=='output-002.log')fs[_0x1861fa(0xa6)](logspath+_0x5b6af7[_0x1861fa(0x9d)],logspath+_0x1861fa(0x9a));if(_0x5b6af7['name']==_0x1861fa(0x160))fs['copyFileSync'](logspath+_0x5b6af7['name'],logspath+_0x1861fa(0x179));_0x5b6af7['name']=='output-000.log'&&(fs[_0x1861fa(0xa6)](logspath+_0x5b6af7[_0x1861fa(0x9d)],logspath+_0x1861fa(0x160)),fs[_0x1861fa(0x21e)](logspath+_0x5b6af7[_0x1861fa(0x9d)],''));});}}async function zipFiles(_0x9cf3da){const _0x502eb2=_0x4a7179;let _0x297698;if(_0x9cf3da=='logs')_0x297698=logspath;if(_0x9cf3da==_0x502eb2(0x1da))_0x297698=configpath;if(_0x9cf3da==_0x502eb2(0xb4))_0x297698=configpath;let _0x4b4008=fs[_0x502eb2(0x192)](_0x297698,{'withFileTypes':!![]});const _0x47232b=new require(_0x502eb2(0xc3))();_0x4b4008[_0x502eb2(0x1ea)](_0x5aac06=>{const _0x2abbf1=_0x502eb2;if(!_0x5aac06['isDirectory']()){let _0x488820=fs[_0x2abbf1(0x181)](_0x297698+_0x5aac06[_0x2abbf1(0x9d)]);if(_0x9cf3da==_0x2abbf1(0x1da)){const _0x5295ca=/^bot-[0-9]{3}-config.json$/,_0x1cad35=_0x5295ca['test'](_0x5aac06[_0x2abbf1(0x9d)]);if(_0x1cad35){const _0x11b87b=JSON['parse'](_0x488820);if(_0x11b87b[_0x2abbf1(0x141)][0x0]){_0x11b87b[_0x2abbf1(0x141)][0x0]['apiKey']=_0x2abbf1(0x177),_0x11b87b[_0x2abbf1(0x141)][0x0]['apiSecret']='***';if(_0x11b87b[_0x2abbf1(0x141)][0x0][_0x2abbf1(0x201)])_0x11b87b['bot'][0x0]['apiPassword']=_0x2abbf1(0x177);}_0x488820=JSON['stringify'](_0x11b87b,null,0x2);}if(_0x5aac06[_0x2abbf1(0x9d)]=='bb-settings.json'){const _0x407b51=JSON['parse'](_0x488820);if(_0x407b51['settings']['loginRequired'])_0x407b51[_0x2abbf1(0x1db)][_0x2abbf1(0x250)]=![];if(_0x407b51[_0x2abbf1(0x1db)]['bbPassword'])_0x407b51[_0x2abbf1(0x1db)]['bbPassword']=_0x2abbf1(0x177);if(_0x407b51['settings'][_0x2abbf1(0x113)])_0x407b51[_0x2abbf1(0x1db)]['telegramToken']=_0x2abbf1(0x177);if(_0x407b51['settings'][_0x2abbf1(0xb6)])_0x407b51[_0x2abbf1(0x1db)]['telegramChatId']=null;_0x488820=JSON[_0x2abbf1(0xf7)](_0x407b51,null,0x2);}if(_0x5aac06[_0x2abbf1(0x9d)]!=_0x2abbf1(0x1a6))_0x47232b[_0x2abbf1(0x9b)](_0x5aac06[_0x2abbf1(0x9d)],_0x488820);}else _0x47232b[_0x2abbf1(0x9b)](_0x5aac06[_0x2abbf1(0x9d)],_0x488820);}});const _0x59a172=_0x47232b['generate']({'base64':![],'compression':_0x502eb2(0x22f)});fs[_0x502eb2(0x21e)](zippath+(_0x9cf3da+_0x502eb2(0x232)),_0x59a172,_0x502eb2(0x1fd));}async function unzipFile(_0x551b51,_0x110f98){const _0x74cd1=_0x4a7179;fs[_0x74cd1(0x192)](configpath,{'withFileTypes':!![]})[_0x74cd1(0x1ea)](_0x479dfc=>{const _0x4d352b=_0x74cd1;if(!_0x479dfc[_0x4d352b(0xb0)]())fs[_0x4d352b(0x16a)](configpath+_0x479dfc[_0x4d352b(0x9d)]);});const _0x4f2512=fs[_0x74cd1(0x181)](_0x551b51+_0x110f98,_0x74cd1(0x1fd)),_0x599259=new require(_0x74cd1(0xc3))(_0x4f2512,{'base64':![],'checkCRC32':!![]});Object[_0x74cd1(0x1f3)](_0x599259[_0x74cd1(0x239)])[_0x74cd1(0x1ea)](_0xaa3b0e=>{const _0x3ef0f9=_0x74cd1,_0x3b685c=_0x599259['files'][_0xaa3b0e];fs[_0x3ef0f9(0x21e)](configpath+_0x3b685c[_0x3ef0f9(0x9d)],_0x3b685c[_0x3ef0f9(0xba)]);}),fs[_0x74cd1(0x192)](temppath,{'withFileTypes':!![]})[_0x74cd1(0x1ea)](_0x4b1441=>{const _0xaf764a=_0x74cd1;if(!_0x4b1441[_0xaf764a(0xb0)]())fs[_0xaf764a(0x16a)](temppath+_0x4b1441[_0xaf764a(0x9d)]);}),logger[_0x74cd1(0x20a)](_0x74cd1(0x22c)),process[_0x74cd1(0x1f1)]({'restore':!![]},_0x4db630=>{});}async function getPublicIp(){const _0x247d06=_0x4a7179;try{const _0x3de2ce=await axios['get']('https://api.ipify.org?format=json');publicip=_0x3de2ce[_0x247d06(0x108)]['ip'];}catch(_0x21b6ed){}}async function triggerAnalytics(){const _0xc4ed77=_0x4a7179;if(!publicip)await getPublicIp();const _0x2e6e7f=getBotsWithMode();let _0x2d523d=0x0;_0x2e6e7f[_0xc4ed77(0x1ea)](_0x2e58e0=>{const _0x5a3632=_0xc4ed77;if(_0x2e58e0[_0x5a3632(0x170)]===_0x5a3632(0x265))_0x2d523d++;});const _0x466cd0=getBotExchanges();mixpanel[_0xc4ed77(0x117)](_0xc4ed77(0x1a9),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x2e6e7f[_0xc4ed77(0x1ca)],'numbotsenabled':_0x2d523d,'exchanges':_0x466cd0});}async function getMessages(){const _0x30972c=_0x4a7179,_0x3b7e8e=_0x30972c(0x145),_0x5d9279=new GraphQLClient(_0x3b7e8e),_0x1b51b3={'authorization':_0x30972c(0x13f)},_0x541bb0=serverversion[_0x30972c(0x18d)]('.'),_0x419cd5=_0x541bb0[0x0]+'.'+_0x541bb0[0x1],_0x5b55fb=Math['min'](settings['lastmsgtelegram'],settings[_0x30972c(0x125)]),_0x555f9c={'last':parseInt(_0x5b55fb),'bbm':_0x419cd5},_0x2d4391=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x338266;try{_0x338266=await _0x5d9279['request'](_0x2d4391,_0x555f9c,_0x1b51b3);}catch(_0x580184){}if(_0x338266&&_0x338266['messages']){let _0x1f8a7b=settings['lastmsgtelegram'];newMessages=[];for(const _0x1251b9 of _0x338266[_0x30972c(0x1af)]){newMessages[_0x30972c(0x18e)](_0x1251b9);if(_0x1251b9[_0x30972c(0x1d9)])updateSetting(_0x30972c(0xf5),_0x1251b9[_0x30972c(0x1d9)]);let _0xb8dc46=_0x1251b9[_0x30972c(0x1d9)]?serverversion>=_0x1251b9['bbvNew']:![];if(!_0xb8dc46&&_0x1251b9[_0x30972c(0xcf)]>_0x1f8a7b){if(_0x1251b9[_0x30972c(0xd5)]===_0x30972c(0x20b)||serverversion[_0x30972c(0x127)](_0x1251b9[_0x30972c(0xd5)])){let _0x554030=''+_0x1251b9[_0x30972c(0x274)]+'\x0a\x0a'+_0x1251b9[_0x30972c(0x10d)];const _0x1a658f=await sendTelegramMsg(toTelegramMarkdown(_0x554030),_0x30972c(0x162));if(_0x1a658f)_0x1f8a7b=_0x1251b9['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x1f8a7b),emitMessages();}}function emitMessages(){const _0x33f72b=_0x4a7179,_0x316a91=settings[_0x33f72b(0x125)];let _0x188169=[];newMessages[_0x33f72b(0x1ea)](_0x595ca0=>{_0x595ca0['number']>_0x316a91&&_0x188169['push'](_0x595ca0);}),_0x188169[_0x33f72b(0x1ca)]>0x0&&getAllClients()[_0x33f72b(0x1ea)](_0x2e2880=>{const _0x592351=_0x33f72b;getSocket(_0x2e2880['id'])[_0x592351(0x224)](_0x592351(0x10d),_0x188169);});}function confirmMessage(_0x12153a){updateSetting('lastmsgemitted',Number(_0x12153a));}function isNewerVersion(_0x4b238d,_0xc14b52){const _0x278a59=_0x4a7179,_0xa7c45c=_0xc14b52['split']('.'),_0x2b9ffb=_0x4b238d[_0x278a59(0x18d)]('.');for(var _0x95d277=0x0;_0x95d277<_0x2b9ffb[_0x278a59(0x1ca)];_0x95d277++){const _0x38bd9e=~~_0x2b9ffb[_0x95d277],_0x27c546=~~_0xa7c45c[_0x95d277];if(_0x38bd9e>_0x27c546)return!![];if(_0x38bd9e<_0x27c546)return![];}return![];}function toTelegramMarkdown(_0x463eb9){const _0x418b14=_0x4a7179,_0x2b071e=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x43db8a=/\*{2}(.+?)\*{2}/gim;return _0x463eb9=_0x463eb9[_0x418b14(0xb8)](_0x2b071e,_0x418b14(0x166))[_0x418b14(0xb8)](_0x43db8a,_0x418b14(0x1ac)),_0x463eb9;}async function validateConfigFile(){const _0x319c3e=_0x4a7179,_0x38347f=dbConfig[_0x319c3e(0xd4)](_0x319c3e(0x130))['sortBy'](_0x319c3e(0x155))[_0x319c3e(0x272)]()||[];if(_0x38347f[_0x319c3e(0x1ca)]==0x0){let _0x967c9c=0x0,_0x5e42ec=[];const _0x54f7ef=/^bot-([0-9]{3})-config.json$/,_0xfbf73c=fs[_0x319c3e(0x192)](configpath);_0xfbf73c['forEach'](_0x580f05=>{const _0x5b0852=_0x319c3e,_0x148812=_0x54f7ef[_0x5b0852(0x148)](_0x580f05);if(_0x148812){const _0x4cb535=_0x148812[0x1];let _0x386c32=getBotAttributes(_0x4cb535);_0x5e42ec[_0x5b0852(0x18e)]({'botID':_0x4cb535,'botname':_0x386c32[_0x5b0852(0x11c)],'status':_0x5b0852(0x184),'live':_0x5b0852(0x202)}),_0x967c9c++;}}),_0x967c9c!=0x0&&(dbConfig[_0x319c3e(0xd4)](_0x319c3e(0x130))['assign'](_0x5e42ec)['write'](),config=_0x5e42ec,restoredConfigFile=_0x967c9c);}}async function restoreConfigNotify(_0x1f5ca9){const _0x3c4a5a=_0x4a7179;let _0x333a5a;if(restoredConfigFile==0x1)_0x333a5a=_0x3c4a5a(0xa8);else _0x333a5a=_0x3c4a5a(0x1dd);if(_0x1f5ca9)io['to']('botmanager')[_0x3c4a5a(0x224)](_0x3c4a5a(0xa1),_0x333a5a);else{logger['simple'](_0x3c4a5a(0x25f)),logger['simple'](_0x333a5a),logger[_0x3c4a5a(0x119)]('-----------------------------------------------------------------------------------'),logger[_0x3c4a5a(0x119)]('');if(tgBot&&settings[_0x3c4a5a(0xb6)]&&settings[_0x3c4a5a(0x187)]!=_0x3c4a5a(0x1eb))tgBot[_0x3c4a5a(0x17e)](settings[_0x3c4a5a(0xb6)],'Bot\x20Mgr\x20>\x20'+_0x333a5a)[_0x3c4a5a(0x10e)](_0x1ad05e=>{telegramError(_0x1ad05e);});}}function validateCredentials(_0x4774c5,_0x22104d){const _0x4f856f=_0x4a7179;if(_0x4774c5[_0x4f856f(0x1f6)]==settings['bbUsername']&&bcrypt[_0x4f856f(0x174)](_0x4774c5[_0x4f856f(0x235)],settings[_0x4f856f(0x214)])){if(settings[_0x4f856f(0x231)])return{'allow':![],'reason':_0x4f856f(0x26e),'token':null};else{const _0x948c5b=generateLoginToken(_0x22104d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x948c5b};}}else return{'allow':![],'reason':_0x4f856f(0x22a),'token':null};}function refreshToken(_0x2b1da6){const _0x1c69b7=_0x4a7179,_0x48dd55=generateLoginToken(_0x2b1da6);return{'allow':!![],'reason':_0x1c69b7(0x12f),'token':_0x48dd55};}function validateAccess(_0x3a3fe5,_0x30a954,_0xa64a95){const _0x59d97d=_0x4a7179,_0x5cdb2b=_0xa64a95?_0xa64a95:devices[_0x30a954]['ip'];let _0x416f83;const _0x1675c4=_0x9721b=>{const _0x39b6bc=_0x2923;if(settings[_0x39b6bc(0x250)]){if(settings[_0x39b6bc(0x231)]){if(telegram2FaApproved(_0x30a954)){const _0x152b6d=generateLoginToken(_0x30a954);return{'allow':!![],'reason':_0x39b6bc(0xb3),'token':_0x152b6d};}else return{'allow':![],'reason':_0x39b6bc(0x14c),'token':null};}else return _0x416f83=validToken(_0x9721b,_0x30a954),_0x416f83[_0x39b6bc(0x268)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x9721b}:{'allow':![],'reason':_0x39b6bc(0x14c),'token':null};}else return{'allow':!![],'reason':_0x39b6bc(0x1c0),'token':null};};if(settings[_0x59d97d(0x233)]){let _0x517337=[...settings['whitelist'],'::1',_0x59d97d(0x1e4),_0x59d97d(0x169)];if(_0x517337[_0x59d97d(0x210)](_0x5cdb2b))return _0x1675c4(_0x3a3fe5);else{_0x416f83=validToken(_0x3a3fe5,_0x30a954);if(_0x416f83[_0x59d97d(0x268)](_0x59d97d(0x1b3)))return _0x1675c4(_0x3a3fe5);else{if(telegramIpApproved(_0x30a954)){const _0x22dc6e=generateToken(_0x30a954);return _0x416f83=_0x1675c4(_0x3a3fe5),_0x416f83[_0x59d97d(0x180)]?{'allow':!![],'reason':_0x59d97d(0xbf),'token':_0x22dc6e}:_0x416f83;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x59d97d(0x1c8),'token':null}:{'allow':![],'reason':_0x59d97d(0x273),'token':null};}}}else return _0x1675c4(_0x3a3fe5);}function timelyDecrypt(_0x392c2c,_0x278903=!![]){const _0x4eb8e3=_0x4a7179;if(_0x392c2c)try{const _0x7eb950=crypt[_0x4eb8e3(0x150)](secure['privateKey'],_0x392c2c)[_0x4eb8e3(0x10d)],_0x2ca38a=_0x7eb950[_0x4eb8e3(0x18d)]('@')[0x0],_0x2e3dca=_0x7eb950[_0x4eb8e3(0x18d)]('@')[0x1],_0x28bc75=new Date()[_0x4eb8e3(0x1aa)]();if(_0x278903){if(_0x28bc75-_0x2e3dca<maxSecretAge*0x3e8)return _0x2ca38a;else return![];}else return _0x2ca38a;}catch(_0x345e68){return![];}else return![];}const validToken=(_0x19e271,_0x3acdaa)=>{const _0x316c84=_0x4a7179,_0x128e84=devices[_0x3acdaa]['ip'];if(!_0x19e271)return{'error':_0x316c84(0xcd)};for(let _0x311684 of blacklist){if(_0x311684[_0x316c84(0x23e)]==_0x19e271)return{'error':_0x316c84(0xe7)};}let _0x53c003;try{_0x53c003=jwt['verify'](_0x19e271,secure[_0x316c84(0x1a5)]+_0x3acdaa);}catch{return{'error':_0x316c84(0x135)};}if(!_0x53c003[_0x316c84(0x268)](_0x316c84(0x15d))&&!_0x53c003[_0x316c84(0x268)](_0x316c84(0x1f6))||!_0x53c003['hasOwnProperty'](_0x316c84(0x1a1)))return{'error':_0x316c84(0x19e)};if(!_0x53c003[_0x316c84(0x268)](_0x316c84(0x1f6))&&_0x53c003[_0x316c84(0x268)]('clientip')){const {clientip:_0x1ca24e}=_0x53c003;return _0x128e84==_0x1ca24e?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x53c003['hasOwnProperty'](_0x316c84(0x1f6))&&_0x53c003[_0x316c84(0x268)]('clientip')){const {username:_0xcbf52e,clientip:_0x13a01c}=_0x53c003;return settings[_0x316c84(0x1d7)]==_0xcbf52e&&_0x128e84==_0x13a01c?{'success':_0x316c84(0xd7)}:{'error':_0x316c84(0x190)};}}},generateLoginToken=_0x47b08e=>{const _0x855b5=_0x4a7179;if(_0x47b08e){const _0x211b64=devices[_0x47b08e]['ip'];return jwt[_0x855b5(0xfb)]({'username':settings[_0x855b5(0x1d7)],'clientip':_0x211b64},secure['secret']+_0x47b08e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1c44f1=>{const _0x23611f=_0x4a7179;if(_0x1c44f1){const _0x5d5ae0=devices[_0x1c44f1]['ip'];return jwt[_0x23611f(0xfb)]({'clientip':_0x5d5ae0},secure['secret']+_0x1c44f1,{'expiresIn':devices[_0x1c44f1]['telegramIpApproval'][_0x23611f(0x1b5)]*0x3c});}else return![];},telegramIpApproved=_0x13f719=>{const _0x4dd95f=_0x4a7179;let _0x379c7a=![];return devices[_0x13f719][_0x4dd95f(0x1b9)]&&devices[_0x13f719][_0x4dd95f(0x1b9)][_0x4dd95f(0x1b5)]!='reject'&&(_0x379c7a=devices[_0x13f719][_0x4dd95f(0x1b9)][_0x4dd95f(0x15d)]==devices[_0x13f719]['ip']&&new Date()['getTime']()-devices[_0x13f719]['telegramIpApproval'][_0x4dd95f(0x157)]<devices[_0x13f719][_0x4dd95f(0x1b9)][_0x4dd95f(0x1b5)]*0x3c*0x3e8),_0x379c7a;},telegram2FaApproved=_0x2d1d95=>{const _0x1fd883=_0x4a7179;let _0x2fb187=![];return devices[_0x2d1d95]['telegram2FaApproval']&&devices[_0x2d1d95]['telegram2FaApproval']['expiry']!=_0x1fd883(0xc5)&&(_0x2fb187=devices[_0x2d1d95][_0x1fd883(0x261)][_0x1fd883(0x15d)]==devices[_0x2d1d95]['ip']&&new Date()[_0x1fd883(0x1aa)]()-devices[_0x2d1d95][_0x1fd883(0x261)]['timestamp']<devices[_0x2d1d95][_0x1fd883(0x261)][_0x1fd883(0x1b5)]*0x3c*0x3e8),_0x2fb187;},normalizeIP=_0x5e6837=>{const _0x353de1=_0x4a7179;let _0x48db22=null,_0x26803a=null;if(ipaddr[_0x353de1(0x26a)](_0x5e6837)){const _0x4abe4e=ipaddr['parse'](_0x5e6837);_0x4abe4e[_0x353de1(0x215)]()===_0x353de1(0xaa)?(_0x4abe4e['isIPv4MappedAddress']()&&(_0x48db22=_0x4abe4e[_0x353de1(0x1bb)]()[_0x353de1(0x114)]()),_0x26803a=_0x4abe4e[_0x353de1(0x114)]()):(_0x48db22=_0x4abe4e[_0x353de1(0x114)](),_0x26803a=_0x4abe4e[_0x353de1(0x1bf)]()[_0x353de1(0x114)]());}return{'show':_0x48db22?_0x48db22:_0x26803a,'store':_0x26803a};};function formatDate(_0x25720a){const _0x8b24cf=_0x4a7179;return _0x25720a[_0x8b24cf(0x266)]()+'/'+(_0x25720a[_0x8b24cf(0x1e1)]()+0x1)[_0x8b24cf(0x114)]()[_0x8b24cf(0x1f4)](0x2,'0')+'/'+_0x25720a[_0x8b24cf(0x24b)]()['toString']()[_0x8b24cf(0x1f4)](0x2,'0')+'\x20'+_0x25720a[_0x8b24cf(0x1a3)]()[_0x8b24cf(0x114)]()[_0x8b24cf(0x1f4)](0x2,'0')+':'+_0x25720a[_0x8b24cf(0x225)]()[_0x8b24cf(0x114)]()[_0x8b24cf(0x1f4)](0x2,'0')+':'+_0x25720a[_0x8b24cf(0x211)]()[_0x8b24cf(0x114)]()[_0x8b24cf(0x1f4)](0x2,'0');}function sleep(_0x4e75a0){return new Promise(_0xc3703=>setTimeout(_0xc3703,_0x4e75a0));}