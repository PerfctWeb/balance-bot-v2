const _0x5d2ff7=_0x15b6;(function(_0x5bbd3c,_0x5f1455){const _0x528831=_0x15b6,_0x34f726=_0x5bbd3c();while(!![]){try{const _0x6dc510=-parseInt(_0x528831(0x283))/0x1+-parseInt(_0x528831(0x326))/0x2+-parseInt(_0x528831(0x229))/0x3*(parseInt(_0x528831(0x282))/0x4)+parseInt(_0x528831(0x386))/0x5+parseInt(_0x528831(0x3af))/0x6+-parseInt(_0x528831(0x284))/0x7*(parseInt(_0x528831(0x2e1))/0x8)+-parseInt(_0x528831(0x31b))/0x9*(-parseInt(_0x528831(0x3ad))/0xa);if(_0x6dc510===_0x5f1455)break;else _0x34f726['push'](_0x34f726['shift']());}catch(_0x57ba39){_0x34f726['push'](_0x34f726['shift']());}}}(_0x40c3,0x9aed9));const _0x238005=function(){let _0x2f97b6=!![];return function(_0x325d7c,_0x5486a7){const _0x552647=_0x2f97b6?function(){const _0x5c0d22=_0x15b6;if(_0x5486a7){const _0x5f5aac=_0x5486a7[_0x5c0d22(0x3c1)](_0x325d7c,arguments);return _0x5486a7=null,_0x5f5aac;}}:function(){};return _0x2f97b6=![],_0x552647;};}(),_0x354a6d=_0x238005(this,function(){const _0x5dd38c=_0x15b6;return _0x354a6d['toString']()[_0x5dd38c(0x234)](_0x5dd38c(0x30c))['toString']()[_0x5dd38c(0x233)](_0x354a6d)[_0x5dd38c(0x234)](_0x5dd38c(0x30c));});_0x354a6d();'use strict';process[_0x5d2ff7(0x2bf)][_0x5d2ff7(0x36c)]=0x1;const childProcess=require(_0x5d2ff7(0x32e)),fs=require('fs'),fns=require(_0x5d2ff7(0x1eb)),low=require(_0x5d2ff7(0x304)),FileSync=require(_0x5d2ff7(0x34c)),path=require(_0x5d2ff7(0x2bb)),crypto=require(_0x5d2ff7(0x316)),Crypt=require(_0x5d2ff7(0x28a))[_0x5d2ff7(0x2b9)],RSA=require(_0x5d2ff7(0x28a))[_0x5d2ff7(0x3a8)],bcrypt=require(_0x5d2ff7(0x2ba)),jwt=require(_0x5d2ff7(0x2b0)),ipaddr=require(_0x5d2ff7(0x2dd)),argv=require(_0x5d2ff7(0x362))(process[_0x5d2ff7(0x29e)][_0x5d2ff7(0x236)](0x2))[_0x5d2ff7(0x29e)],uuidRandom=require(_0x5d2ff7(0x1e5)),TelegramBot=require(_0x5d2ff7(0x2af)),Mixpanel=require(_0x5d2ff7(0x20c)),axios=require(_0x5d2ff7(0x38c)),{GraphQLClient,gql}=require(_0x5d2ff7(0x334)),util=require(_0x5d2ff7(0x381)),fileUpload=require(_0x5d2ff7(0x2b6)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x5d2ff7(0x367),pattern=/^[0-9]{2,4}$/;!pattern[_0x5d2ff7(0x237)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x5d2ff7(0x264)](0x1));const HOST=argv[_0x5d2ff7(0x245)]||null,userID=argv[_0x5d2ff7(0x394)]||'',debugging=argv['d']||![],nodeversion=process[_0x5d2ff7(0x278)][_0x5d2ff7(0x277)];let bbpath=_0x5d2ff7(0x329),bbpath2='';const botfile=_0x5d2ff7(0x3b3),configfile=_0x5d2ff7(0x308),settingsfile='bb-settings.json',securefile=_0x5d2ff7(0x2e9),maxBackups=0xa;function _0x40c3(){const _0x43d849=['getSeconds','reason','timestamp','running','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Error\x20removing\x20old\x20backup\x20files:','map','push','mtime','argv','toggle-bot-mode','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','::1','stopPolling','Starting\x20Balance\x20Bot\x20reinstallation','-config.json','reset-password','Yes','Unauthorized\x20attempt\x20to\x20get\x20events','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','live','config/','f2aRequired','\x20minutes','Starting\x20bot\x20|\x20Bot\x20','node-telegram-bot-api','jsonwebtoken','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','cancel-loading','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','\x1b[33m','IPv4','express-fileupload','\x1b[34m','sha256','Crypt','bcryptjs','path','getFullYear','sendMessage','\x20|\x20','env','args','find','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','/download/:type','output-003.log','referer','Unauthorized\x20attempt\x20to\x20get\x20portfolio','emit','Setting\x20access:\x20','startsWith','length','sockets','event','Notifications\x20types:\x20','function','placeOrder','temporary\x20access\x20timeout','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','bb-settings.json','range','privateKey','5\x20min','All','sign',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','/:bot','kind','\x20only\x0a','Logged\x20in\x20user\x20...','ipaddr.js','botname','Bot\x20','mode','8rwcTFy','backup-full.zip','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','token','accept','message','Starting\x20Balance\x20Bot\x20','isDirectory','bb-secure.json','lastmsgemitted','telegramChatId','existsSync','userid','botmanager','auto','HTML','size','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Token\x20blacklisted','telegram','compareSync','send','add-bot','getDate','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','params','log','bbUsername','replace','handshake','telegramIpApproval','apiSecret','-events.json','#RES#\x0a','store-fiat','lowdb','all','set','output-002.log','bb-config.json','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','connection','kill','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','************','auth','number','isIPv4MappedAddress','get','reinstall','reject','exp','crypto','settings.','\x20>\x20','initclient','write','6650874TAVfbS','bot-','</b>\x20?','uncaughtException','_data','Deleted\x20Bot\x20','expiry','Ok,\x20will\x20send\x20alert\x20notifications\x20only','telegramToken','127.0.0.1','Alerts','93690UYujFb','pidRefreshToken','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','bb/','/off\x20-\x20stop\x20bot(s)\x0a','update','verify','download','child_process','SIGINT','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20bot','post','Notifications\x20disabled','graphql-request','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','parse','RSA-OAEP','update-bb','logout','fork','logs','private','2FA\x20login\x20rejected','build','exchange','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','http','bbvReceive','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','emitHistory','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','add','readdirSync','get-starting-balances','keys','You\x20can\x20use\x20the\x20following\x20commands:\x0a','lowdb/adapters/FileSync','headless','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','telegramUsername','messages','store-settings','Login\x20rejected','secure','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','remoteAddress','reset-history','getUTCHours','latestversion','removeListener','Restore\x20backup\x20file\x20','headers','blacklist','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','exec','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','node-zip','/help\x20-\x20show\x20available\x20commands\x0a','yargs/yargs','username','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Error\x20while\x20deleting\x20config\x20files:\x20',':\x20Bot\x20Mgr\x20>\x20','3000','\x20(2)','manual','sendPortfolioTelegram','Backup\x20file\x20unzipped\x20and\x20stored','NTBA_FIX_319','login\x20not\x20required','\x20to\x20','title','hashSync','store-headless','/enable\x20-\x20enable\x20notifications\x0a','temp/','\x1b[35m','any','telegramEvents','getMonth','disconnect','Restore\x20process\x20aborted','type','Backup\x20file\x20uploaded','store','includes','/update\x20-\x20update\x20Balance\x20Bot\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Password\x20has\x20been\x20reset\x20to:\x20','util','Unauthorized\x20attempt\x20to\x20log\x20out','Logged\x20out\x20user\x20...','name','All\x20bots','1066780XxCCQl','then','new','password','2FA\x20required','new-disabled','axios','*$1*','telegrammsg','reinstall-bb','catch','stop','Password\x20reset\x20rejected','Unauthorized\x20attempt\x20to\x20confirm\x20message','user','output-001.log','status','bbvNew','mkdirSync','/names\x20-\x20show\x20bot\x20names\x0a','simple','#RES#\x20if\x20running\x20on\x20server','createServer','showConfig','generate','bots','express','version','hex','file','statSync','30\x20min','Session\x20expired\x20for\x20user\x20...','static','RSA','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','sendMetricsTelegram','\x20|\x20user:\x20...','Invalid\x20username\x20or\x20IP\x20address','20rfLYds','whitelist','5207352kFkZOg','delete-bot','/upload-backup','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','bot.js','store-configuration','Unauthorized\x20attempt\x20to\x20get\x20messages','restart','socket','alias','bot','Your\x20installation\x20is\x20already\x20up\x20to\x20date','disabled','success','listen','access','once','logs/','apply','isValid','cancelLoading','getHours','stringify','address','get-portfolio','Node.js\x20v','split','deleteHistoryAlerts','string','allow','backup-full@','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','logged\x20out','tkn','uuid-random','/:bot/history','Unauthorized\x20attempt\x20to\x20download\x20','socket.io','storeFiat','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','date-fns','.zip','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','15\x20min','\x1b[31m','forEach','get-logs','order','family','encryptedUuid','settings','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','yes','notification','No\x20authentication\x20token','Notifications\x20disabled\x0a','storeConfiguration','Bot\x20Mgr\x20>\x20','get-backup-files','\x20|\x20client:\x20...','createWriteStream','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','unlinkSync','access\x20timeout','sendFile','/:bot/support','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','orders','login\x20required','timeshift','mixpanel','onText','All\x20bots\x20running\x20right\x20now','generateKeyPairAsync','reload','server','getPortfolio','output-000.log','toString','apiKey','login','-results.json','place-order','telegram2FaApproval','error','2FA\x20login\x20required','Temporary\x20access\x20rejected','Notifications\x20enabled\x0a','started','bbPassword','pidExpireLogin','/on\x20-\x20start\x20bot(s)\x0a','onepagemode','Unauthorized\x20attempt\x20to\x20add\x20bot','2FA','\x20(1)','assign','show-config','backup-files','3113889bdDKVo','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/:bot/portfolio','uuid','Markdown','copyFileSync','index.html','binary','constructor','search','/metrics\x20-\x20show\x20bot\x20performance\x0a','slice','test','Unauthorized\x20login\x20attempt\x20(timeout)','data','\x1b[36m','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','hasOwnProperty','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','show','init','build2','debug','callback_query','decrypt','host','join','filter','\x1b[0m','/:bot/configuration','telegramEnabled','use','sortBy','***','rmSync','remove','confirm-message','-----------------------------------------------------------------------------------','Orders',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','sort','readFileSync','/status\x20-\x20show\x20bot(s)\x20status\x0a','0.0.0','Server','max','clients','<b>Balance\x20Bot\x20Status:</b>\x0a','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','getStartingBalances','User\x20has\x20been\x20validated','secret','writeFileSync','value','Failed\x20to\x20download\x20','Access\x20enabled\x20for\x20','exit','padStart','answerCallbackQuery','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','alerts','botID','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','backup-full','zip/','defaults','enabled','full','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','/:bot/coins','Unauthorized\x20attempt\x20to\x20store\x20configuration','publicKey','No\x20bots\x20running\x20right\x20now','internal','format','node','versions','Unauthorized\x20attempt\x20to\x20update\x20settings','Notifications\x20enabled','backupfile','login\x20token\x20generated','-performance.json','clientip','<b>Telegram\x20Bot\x20Status:</b>\x0a','chat','1000','4HCuHYW','682805QJUtAb','1099154YDOfkx','temporaryAccessAllowed','[ip-address]','loginRequired','delete-alerts','/restart\x20-\x20restart\x20bot(s)\x0a','hybrid-crypto-js','getTime','::ffff:127.0.0.1','from','toIPv4MappedAddress','endsWith','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Enabled\x20Bot\x20','getMinutes','stopped','api-eu.mixpanel.com'];_0x40c3=function(){return _0x43d849;};return _0x40c3();}let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5d2ff7(0x25a)),configpath=userID?bbpath+_0x5d2ff7(0x2ab)+userID+'/':bbpath+_0x5d2ff7(0x2ab),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x5d2ff7(0x3c0)+userID+'/':bbpath+_0x5d2ff7(0x3c0),zippath=userID?bbpath+_0x5d2ff7(0x26c)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x5d2ff7(0x201)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x5d2ff7(0x373)+userID+'/':bbpath+_0x5d2ff7(0x373);!fs[_0x5d2ff7(0x2ec)](configpath)&&fs[_0x5d2ff7(0x398)](configpath);!fs[_0x5d2ff7(0x2ec)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x5d2ff7(0x2ec)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x5d2ff7(0x2ec)](zippath)&&fs[_0x5d2ff7(0x398)](zippath);!fs[_0x5d2ff7(0x2ec)](temppath)&&fs[_0x5d2ff7(0x398)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5d2ff7(0x26d)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5d2ff7(0x257),'onepagemode':![]}})[_0x5d2ff7(0x31a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5d2ff7(0x26d)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x5d2ff7(0x2b8),'rsaStandard':_0x5d2ff7(0x337)});const saltRounds=0xa,mixpanel=Mixpanel[_0x5d2ff7(0x240)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x5d2ff7(0x294)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x5d2ff7(0x323)]&&settings[_0x5d2ff7(0x323)]!=''&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x5a4aa0,_0x37aee3)=>{const _0x3b0059=_0x5d2ff7,_0x3a7407=/#[A-Z]{3}#/g;if(typeof _0x5a4aa0==_0x3b0059(0x1df)){!_0x37aee3?_0x5a4aa0=_0x5a4aa0[_0x3b0059(0x2fd)](_0x3a7407,''):(_0x5a4aa0=_0x5a4aa0[_0x3b0059(0x2fd)](/#BLU#/g,_0x3b0059(0x2b7)),_0x5a4aa0=_0x5a4aa0['replace'](/#RED#/g,_0x3b0059(0x1ef)),_0x5a4aa0=_0x5a4aa0[_0x3b0059(0x2fd)](/#YEL#/g,_0x3b0059(0x2b4)),_0x5a4aa0=_0x5a4aa0['replace'](/#MAG#/g,_0x3b0059(0x374)),_0x5a4aa0=_0x5a4aa0[_0x3b0059(0x2fd)](/#CYA#/g,_0x3b0059(0x23a)),_0x5a4aa0=_0x5a4aa0[_0x3b0059(0x2fd)](/#RES#/g,_0x3b0059(0x248)));;}return _0x5a4aa0;},logger={'screen':_0x1e53a6=>{const _0x5723c1=_0x5d2ff7;console[_0x5723c1(0x2fb)](parseColor(_0x1e53a6,!![]));},'simple':_0x56408e=>{const _0x4cbe02=_0x5d2ff7;console[_0x4cbe02(0x2fb)](parseColor(_0x56408e,!![])),loggerfile[_0x4cbe02(0x31a)](util[_0x4cbe02(0x276)](parseColor(_0x56408e,![]))+'\x0a');},'full':async _0x1e8a63=>{const _0x301118=_0x5d2ff7,_0x54dc7b=getTimeStamp()+_0x301118(0x366)+_0x1e8a63;console[_0x301118(0x2fb)](parseColor(_0x54dc7b,!![])),loggerfile['write'](util[_0x301118(0x276)](parseColor(_0x54dc7b,![]))+'\x0a');if(tgBot&&settings[_0x301118(0x2eb)]&&settings[_0x301118(0x376)]!=_0x301118(0x209))await tgBot['sendMessage'](settings[_0x301118(0x2eb)],_0x301118(0x1fe)+parseColor(_0x1e8a63,![]))[_0x301118(0x390)](_0x20cd3d=>{telegramError(_0x20cd3d);});},'debug':async(_0x31b1bb,_0x5d25a1='')=>{const _0x19ec2b=_0x5d2ff7,_0x4b53d1=getTimeStamp()+_0x19ec2b(0x253)+_0x31b1bb;if(debugging)console[_0x19ec2b(0x2fb)](parseColor(_0x4b53d1,!![]));loggerfile[_0x19ec2b(0x31a)](util[_0x19ec2b(0x276)](parseColor(_0x4b53d1,![]))+'\x0a');if(_0x5d25a1){if(debugging)console[_0x19ec2b(0x2fb)](_0x5d25a1);loggerfile[_0x19ec2b(0x31a)](util[_0x19ec2b(0x276)](_0x5d25a1)+'\x0a');}}};process['on'](_0x5d2ff7(0x31e),function(_0x430892){const _0x3c8170=_0x5d2ff7;logger[_0x3c8170(0x39a)](_0x430892);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x5d2ff7(0x3a1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5d2ff7(0x3a0)),app=express(),http=require(_0x5d2ff7(0x341))[_0x5d2ff7(0x39c)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x5d2ff7(0x312)](_0x5d2ff7(0x2c3),async(_0x39512b,_0x4fdeb9)=>{const _0xb7f60e=_0x5d2ff7,_0x2b42e0=_0x39512b[_0xb7f60e(0x2fa)][_0xb7f60e(0x37a)],_0x5db908=getClientsWithBotID(_0xb7f60e(0x2ee)),_0x58dad4=_0x39512b['headers'][_0xb7f60e(0x22e)],_0xcd8ad6=timelyDecrypt(_0x58dad4,![]),_0xdb2a8e=_0x5db908['find'](_0x588cbc=>_0x588cbc[_0xb7f60e(0x22e)]==_0xcd8ad6);if(_0xdb2a8e){const _0x151c58=normalizeIP(_0x39512b['socket'][_0xb7f60e(0x355)])[_0xb7f60e(0x37c)],_0x471da8=_0x39512b[_0xb7f60e(0x35b)]['tkn'];if(validateAccess(_0x471da8,_0xcd8ad6,_0x151c58)['allow'])_0x2b42e0=='backup'&&await backupConfigFiles(),await zipFiles(_0x2b42e0),_0x4fdeb9[_0xb7f60e(0x32d)](zippath+(_0x2b42e0+'.zip'),_0x5b8b56=>{const _0x2e94f2=_0xb7f60e;_0x5b8b56&&(logger['full'](_0x2e94f2(0x262)+_0x2b42e0),logger['simple'](_0x5b8b56));});else logger['full'](_0xb7f60e(0x1e7)+_0x2b42e0+_0xb7f60e(0x225));}else logger[_0xb7f60e(0x26f)](_0xb7f60e(0x1e7)+_0x2b42e0+_0xb7f60e(0x368));}),app[_0x5d2ff7(0x332)](_0x5d2ff7(0x3b1),async(_0x210b04,_0x5f2f5d)=>{const _0x297805=_0x5d2ff7,_0x5db885=getClientsWithBotID(_0x297805(0x2ee)),_0x2c58c9=_0x210b04['headers'][_0x297805(0x22e)],_0x3e09f0=timelyDecrypt(_0x2c58c9,![]),_0x1758e4=_0x5db885[_0x297805(0x2c1)](_0x339e6e=>_0x339e6e[_0x297805(0x22e)]==_0x3e09f0);logger[_0x297805(0x242)](_0x297805(0x37b));if(_0x1758e4){const _0x59619b=normalizeIP(_0x210b04[_0x297805(0x3b7)][_0x297805(0x355)])[_0x297805(0x37c)],_0x582ab7=_0x210b04['headers'][_0x297805(0x1e4)];if(validateAccess(_0x582ab7,_0x3e09f0,_0x59619b)[_0x297805(0x1e0)]){if(_0x210b04['files']){const _0x309bc5=_0x210b04['files'][_0x297805(0x27b)];await _0x309bc5['mv'](temppath+_0x309bc5[_0x297805(0x384)]),_0x5f2f5d['send']({'status':!![],'message':'File\x20uploaded'});const _0x5a6a62=getBotsWithMode();_0x5a6a62[_0x297805(0x2ca)]>0x0?confirmRestore(temppath,_0x309bc5[_0x297805(0x384)]):unzipFile(temppath,_0x309bc5['name']);}}else logger[_0x297805(0x26f)](_0x297805(0x30d));}else logger[_0x297805(0x26f)](_0x297805(0x22c));}),app[_0x5d2ff7(0x24b)](express[_0x5d2ff7(0x3a7)](path[_0x5d2ff7(0x246)](__dirname,bbpath2,_0x5d2ff7(0x241)))),app[_0x5d2ff7(0x24b)](express[_0x5d2ff7(0x3a7)](path[_0x5d2ff7(0x246)](__dirname,bbpath2,'build'))),app[_0x5d2ff7(0x312)]('/',function(_0x19795b,_0x25b3f5){const _0x4a3729=_0x5d2ff7;_0x25b3f5[_0x4a3729(0x205)](path[_0x4a3729(0x246)](__dirname,bbpath2,'build2',_0x4a3729(0x231)));}),app[_0x5d2ff7(0x312)](_0x5d2ff7(0x2d9),function(_0x43da99,_0x19441d){const _0x421cc9=_0x5d2ff7;_0x19441d[_0x421cc9(0x205)](path['join'](__dirname,bbpath2,_0x421cc9(0x33e),_0x421cc9(0x231)));}),app[_0x5d2ff7(0x312)](_0x5d2ff7(0x22d),(_0x480d43,_0x2e2af7)=>{const _0x54769d=_0x5d2ff7;_0x2e2af7[_0x54769d(0x205)](path[_0x54769d(0x246)](__dirname,bbpath2,_0x54769d(0x33e),'index.html'));}),app[_0x5d2ff7(0x312)]('/:bot/performance',(_0x5485d9,_0x52f1d4)=>{const _0x497fb0=_0x5d2ff7;_0x52f1d4['sendFile'](path['join'](__dirname,bbpath2,_0x497fb0(0x33e),'index.html'));}),app[_0x5d2ff7(0x312)](_0x5d2ff7(0x271),(_0x18f3d1,_0xc97547)=>{const _0x140a61=_0x5d2ff7;_0xc97547[_0x140a61(0x205)](path['join'](__dirname,bbpath2,_0x140a61(0x33e),'index.html'));}),app['get'](_0x5d2ff7(0x1e6),(_0x53660b,_0x5b98bb)=>{const _0x4b29de=_0x5d2ff7;_0x5b98bb[_0x4b29de(0x205)](path['join'](__dirname,bbpath2,_0x4b29de(0x33e),_0x4b29de(0x231)));}),app[_0x5d2ff7(0x312)](_0x5d2ff7(0x249),(_0x4016d4,_0x487fa2)=>{const _0x3525cf=_0x5d2ff7;_0x487fa2[_0x3525cf(0x205)](path[_0x3525cf(0x246)](__dirname,bbpath2,_0x3525cf(0x33e),_0x3525cf(0x231)));}),app['get'](_0x5d2ff7(0x206),(_0x15ccce,_0x386549)=>{const _0x229e7d=_0x5d2ff7;_0x386549[_0x229e7d(0x205)](path['join'](__dirname,bbpath2,_0x229e7d(0x33e),_0x229e7d(0x231)));});if(HOST)http[_0x5d2ff7(0x3bd)](PORT,HOST);else http[_0x5d2ff7(0x3bd)](PORT);const io=require(_0x5d2ff7(0x1e8))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1316dd=_0x5d2ff7;let _0x18111e=_0x1316dd(0x286);const _0x12e07d=networkInterfaces(),_0x390296={};for(const _0xfccb72 of Object[_0x1316dd(0x34a)](_0x12e07d)){for(const _0x38941f of _0x12e07d[_0xfccb72]){if((_0x38941f['family']==_0x1316dd(0x2b5)||_0x38941f[_0x1316dd(0x1f3)]==0x4)&&!_0x38941f[_0x1316dd(0x275)]){const _0x4a8693=ipaddr[_0x1316dd(0x336)](_0x38941f[_0x1316dd(0x1da)])[_0x1316dd(0x2d3)]();_0x4a8693!=_0x1316dd(0x33c)&&(!_0x390296[_0xfccb72]&&(_0x390296[_0xfccb72]=[]),_0x390296[_0xfccb72][_0x1316dd(0x29c)](_0x38941f[_0x1316dd(0x1da)]),_0x18111e=_0x38941f[_0x1316dd(0x1da)]);}}}return{'serverip':_0x18111e,'netinterfaces':_0x390296};}async function startServer(){const _0x2948c9=_0x5d2ff7,{serverip:_0xa589ec,netinterfaces:_0x316c90}=getServerIP();logger['simple'](''),logger[_0x2948c9(0x39a)](_0x2948c9(0x251)),await logger[_0x2948c9(0x26f)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x2948c9(0x302)+(_0x2948c9(0x309)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+('=>\x20Go\x20to\x20#CYA#http://'+_0xa589ec+':'+PORT+_0x2948c9(0x39b))),logger[_0x2948c9(0x39a)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x29b38c of config){if(_0x29b38c[_0x2948c9(0x396)]==_0x2948c9(0x26e)||_0x29b38c['status']==_0x2948c9(0x388))await logger[_0x2948c9(0x26f)](_0x2948c9(0x2ae)+_0x29b38c[_0x2948c9(0x269)]+_0x2948c9(0x2be)+_0x29b38c[_0x2948c9(0x2de)]),startBot([_0x29b38c[_0x2948c9(0x269)],userID],{'cwd':bbpath},function(_0x22c6d3){const _0x3fe36d=_0x2948c9;if(_0x22c6d3)logger[_0x3fe36d(0x26f)](_0x22c6d3);});else(_0x29b38c[_0x2948c9(0x396)]=='disabled'||_0x29b38c[_0x2948c9(0x396)]=='new-disabled')&&await logger[_0x2948c9(0x26f)](_0x2948c9(0x23b)+_0x29b38c[_0x2948c9(0x269)]+_0x2948c9(0x2be)+_0x29b38c['botname']);}else!newBot&&logger[_0x2948c9(0x39a)](_0x2948c9(0x23e));if(newBot)addBot();logger[_0x2948c9(0x39a)](_0x2948c9(0x251)),logger['simple'](''),await logger[_0x2948c9(0x242)](_0x2948c9(0x1dc)+nodeversion),await logger[_0x2948c9(0x242)]('Network\x20Interfaces:',_0x316c90);}function startSocket(){const _0x5b2ab5=_0x5d2ff7;io['on'](_0x5b2ab5(0x30a),_0x50462a=>{const _0x2a9faa=_0x5b2ab5;let _0x3713a9,_0x1fdf90,_0x54c3da,_0x5c46d1,_0x4184e6;const _0x215131=_0x50462a[_0x2a9faa(0x2fe)][_0x2a9faa(0x35b)][_0x2a9faa(0x2c5)];_0x1fdf90=_0x215131['match'](/bot[0-9]{3}/);if(_0x1fdf90)_0x54c3da=_0x1fdf90[0x0]['match'](/[0-9]{3}/);if(_0x54c3da)_0x3713a9=_0x54c3da[0x0];else _0x3713a9=_0x2a9faa(0x2ee);const _0x506abd=_0x50462a[_0x2a9faa(0x2fe)][_0x2a9faa(0x30f)][_0x2a9faa(0x1f4)];if(!_0x506abd)_0x50462a[_0x2a9faa(0x2c7)](_0x2a9faa(0x396),{'publicKey':secure[_0x2a9faa(0x273)]});else{_0x5c46d1=timelyDecrypt(_0x506abd,![]);if(!_0x5c46d1)_0x50462a[_0x2a9faa(0x2c7)](_0x2a9faa(0x396),{'publicKey':secure[_0x2a9faa(0x273)]});else{_0x4184e6=normalizeIP(_0x50462a['conn'][_0x2a9faa(0x355)])[_0x2a9faa(0x37c)];if(!devices[_0x5c46d1])devices[_0x5c46d1]={'uuid':_0x5c46d1,'access':{'token':null}};devices[_0x5c46d1]['ip']=_0x4184e6;const _0x4bc881=addClient(_0x50462a['id'],_0x5c46d1,_0x3713a9);setAccess(_0x4bc881),emitMessages(),_0x50462a['on'](_0x2a9faa(0x216),_0x1ecde4=>{const _0x44a7eb=_0x2a9faa,_0x5afef0=timelyDecrypt(_0x1ecde4[_0x44a7eb(0x389)]);if(_0x5afef0){_0x1ecde4={'username':_0x1ecde4[_0x44a7eb(0x363)],'password':_0x5afef0},devices[_0x5c46d1][_0x44a7eb(0x3be)]=validateCredentials(_0x1ecde4,_0x5c46d1);if(devices[_0x5c46d1][_0x44a7eb(0x3be)]['allow']==![]&&devices[_0x5c46d1][_0x44a7eb(0x3be)][_0x44a7eb(0x296)]==_0x44a7eb(0x21b))_0x50462a[_0x44a7eb(0x2c7)]('status',{'access':devices[_0x5c46d1][_0x44a7eb(0x3be)]}),loginAccess2FA(_0x5c46d1,_0x4184e6);else{if(devices[_0x5c46d1][_0x44a7eb(0x3be)][_0x44a7eb(0x1e0)]==![]&&devices[_0x5c46d1]['access'][_0x44a7eb(0x296)]==_0x44a7eb(0x1f7))_0x50462a[_0x44a7eb(0x2c7)](_0x44a7eb(0x396),{'access':devices[_0x5c46d1][_0x44a7eb(0x3be)]});else devices[_0x5c46d1][_0x44a7eb(0x3be)]['allow']&&devices[_0x5c46d1][_0x44a7eb(0x3be)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5c46d1)['forEach'](_0x392621=>{setAccess(_0x392621);}),logger[_0x44a7eb(0x242)](_0x44a7eb(0x2dc)+_0x5c46d1[_0x44a7eb(0x236)](-0x8)),setTokenRefresh(_0x5c46d1),setSessionTimeout(_0x44a7eb(0x216),_0x5c46d1));}}else logger[_0x44a7eb(0x26f)](_0x44a7eb(0x238));}),_0x50462a['on'](_0x2a9faa(0x2a5),()=>{resetPassword();}),_0x50462a['on'](_0x2a9faa(0x378),_0x21d78e=>{removeClient(_0x50462a['id']);}),_0x3713a9==_0x2a9faa(0x2ee)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x581a5d){const _0x44f182=_0x5d2ff7;if(_0x581a5d!=_0x44f182(0x2ee)&&config[_0x44f182(0x215)]!=''){if(pid[_0x581a5d])pid[_0x581a5d][_0x44f182(0x2f6)]({'function':_0x44f182(0x319),'args':null});}_0x581a5d!=_0x44f182(0x2ee)&&broadcastToBots('bots',JSON[_0x44f182(0x1d9)](config));}function reloadBotManager(){const _0x3397c8=_0x5d2ff7;getClientsWithBotID(_0x3397c8(0x2ee))[_0x3397c8(0x1f0)](_0x3428de=>{const _0x28e96d=_0x3397c8;getSocket(_0x3428de['id'])[_0x28e96d(0x2c7)]('status',{'access':{'allow':![],'reason':_0x28e96d(0x210),'token':null}});});}function getSocket(_0x5bac1c){const _0x2ff048=_0x5d2ff7;return io[_0x2ff048(0x2cb)]['sockets']['get'](_0x5bac1c);}function setAccess(_0x11a442){const _0x2a171a=_0x5d2ff7,_0x13ea65=getSocket(_0x11a442['id']),_0x3593fa=_0x11a442['uuid'],_0x437985=_0x11a442[_0x2a171a(0x3b9)];devices[_0x3593fa][_0x2a171a(0x3be)]=validateAccess(devices[_0x3593fa]['access']['token'],_0x3593fa),logger[_0x2a171a(0x242)](_0x2a171a(0x2c8)+devices[_0x3593fa][_0x2a171a(0x3be)]['reason']+_0x2a171a(0x200)+_0x11a442['id'][_0x2a171a(0x236)](-0x8)+_0x2a171a(0x3ab)+_0x3593fa[_0x2a171a(0x236)](-0x8)),_0x13ea65[_0x2a171a(0x246)](_0x3593fa);if(devices[_0x3593fa]['access'][_0x2a171a(0x1e0)]){_0x13ea65['join'](_0x437985);if(_0x437985==_0x2a171a(0x2ee))initializeSocketBotManager(_0x13ea65);else initializeSocketBot(_0x13ea65);initClient(_0x437985);}devices[_0x3593fa][_0x2a171a(0x3be)][_0x2a171a(0x2e4)]&&devices[_0x3593fa][_0x2a171a(0x3be)][_0x2a171a(0x296)]==_0x2a171a(0x22b)&&setSessionTimeout(_0x2a171a(0x224),_0x3593fa),devices[_0x3593fa]['access'][_0x2a171a(0x2e4)]&&devices[_0x3593fa][_0x2a171a(0x3be)][_0x2a171a(0x296)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x3593fa),_0x13ea65[_0x2a171a(0x2c7)]('status',{'status':_0x11a442[_0x2a171a(0x211)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3593fa][_0x2a171a(0x3be)],'externalip':devices[_0x3593fa]['ip'],'publicKey':secure[_0x2a171a(0x273)],'userid':settings[_0x2a171a(0x2ed)],'validInstallation':validInstallation}),devices[_0x3593fa][_0x2a171a(0x3be)]['allow']==![]&&devices[_0x3593fa][_0x2a171a(0x3be)][_0x2a171a(0x296)]==_0x2a171a(0x38a)&&temporaryAccess2FA(_0x3593fa,devices[_0x3593fa]['ip']);}function setSessionTimeout(_0x4e51a0,_0x3c96c4){const _0x143845=_0x5d2ff7;let _0x4e56d3;if(_0x4e51a0==_0x143845(0x216))_0x4e56d3=loginExpiry*0x3c*0x3e8;else _0x4e56d3=devices[_0x3c96c4][_0x143845(0x2ff)][_0x143845(0x321)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x3c96c4][_0x143845(0x2ff)][_0x143845(0x297)]);if(devices[_0x3c96c4][_0x143845(0x220)])clearTimeout(devices[_0x3c96c4][_0x143845(0x220)]);devices[_0x3c96c4][_0x143845(0x220)]=setTimeout(()=>{const _0x3e56f7=_0x143845;if(devices[_0x3c96c4][_0x3e56f7(0x327)])clearTimeout(devices[_0x3c96c4][_0x3e56f7(0x327)]);removeSocketListeners(_0x3c96c4),addBlacklist(_0x3c96c4),devices[_0x3c96c4]['telegramIpApproval']=null,devices[_0x3c96c4]['telegram2FaApproval']=null,devices[_0x3c96c4]['access'][_0x3e56f7(0x2e4)]=null,logger['debug'](_0x3e56f7(0x3a6)+_0x3c96c4[_0x3e56f7(0x236)](-0x8)),devices[_0x3c96c4][_0x3e56f7(0x3be)]=validateAccess(devices[_0x3c96c4][_0x3e56f7(0x3be)][_0x3e56f7(0x2e4)],_0x3c96c4),!(devices[_0x3c96c4][_0x3e56f7(0x3be)][_0x3e56f7(0x1e0)]&&devices[_0x3c96c4][_0x3e56f7(0x3be)][_0x3e56f7(0x296)]==_0x3e56f7(0x36d))&&(_0x4e51a0==_0x3e56f7(0x216)?io['to'](_0x3c96c4)['emit']('status',{'access':{'allow':![],'reason':_0x3e56f7(0x204),'token':null}}):io['to'](_0x3c96c4)[_0x3e56f7(0x2c7)](_0x3e56f7(0x396),{'access':{'allow':![],'reason':_0x3e56f7(0x2d0),'token':null}})),devices[_0x3c96c4]['access']['token']=null;},_0x4e56d3);}function _0x15b6(_0x264085,_0x339ebc){const _0xbaeb50=_0x40c3();return _0x15b6=function(_0x354a6d,_0x238005){_0x354a6d=_0x354a6d-0x1d6;let _0x40c3ac=_0xbaeb50[_0x354a6d];return _0x40c3ac;},_0x15b6(_0x264085,_0x339ebc);}function setTokenRefresh(_0xd45102){const _0x181881=_0x5d2ff7;if(devices[_0xd45102][_0x181881(0x327)])clearTimeout(devices[_0xd45102][_0x181881(0x327)]);devices[_0xd45102]['pidRefreshToken']=setTimeout(()=>{const _0x4caa11=_0x181881;getClientsWithUuid(_0xd45102)[_0x4caa11(0x2ca)]!=0x0?(devices[_0xd45102][_0x4caa11(0x3be)]=refreshToken(_0xd45102),io['to'](_0xd45102)[_0x4caa11(0x2c7)](_0x4caa11(0x396),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xd45102][_0x4caa11(0x3be)],'externalip':devices[_0xd45102]['ip'],'publicKey':secure[_0x4caa11(0x273)],'validInstallation':validInstallation}),setTokenRefresh(_0xd45102)):clearTimeout(devices[_0xd45102]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xe1f7cb){const _0x2f753c=_0x5d2ff7,_0x4883e1=getClient(_0xe1f7cb['id'])[_0x2f753c(0x22e)];_0xe1f7cb['emit'](_0x2f753c(0x39f),config),_0xe1f7cb[_0x2f753c(0x2c7)]('settings',cleanSettings()),_0xe1f7cb['on'](_0x2f753c(0x2f7),_0x49db56=>{const _0x3e0360=_0x2f753c;if(validateAccess(_0x49db56,_0x4883e1)[_0x3e0360(0x1e0)])addBot();else logger[_0x3e0360(0x26f)](_0x3e0360(0x223));}),_0xe1f7cb['on']('update-bot',(_0x1e8d5b,_0x813882)=>{const _0x5f1780=_0x2f753c;if(validateAccess(_0x813882,_0x4883e1)['allow'])toggleBot(_0x1e8d5b['botID'],_0x1e8d5b[_0x5f1780(0x396)],_0x1e8d5b['live']);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xe1f7cb['on'](_0x2f753c(0x29f),(_0x2c8c30,_0x484a08)=>{const _0x571b1e=_0x2f753c;if(validateAccess(_0x484a08,_0x4883e1)[_0x571b1e(0x1e0)])toggleBotMode(_0x2c8c30);else logger['full'](_0x571b1e(0x331));}),_0xe1f7cb['on'](_0x2f753c(0x3b0),(_0xcf008a,_0xbbc18a)=>{const _0x5bdc75=_0x2f753c;if(validateAccess(_0xbbc18a,_0x4883e1)['allow'])deleteBot(_0xcf008a);else logger[_0x5bdc75(0x26f)](_0x5bdc75(0x23c));}),_0xe1f7cb['on'](_0x2f753c(0x351),(_0x1d3a50,_0x49580)=>{const _0x406e1b=_0x2f753c;if(validateAccess(_0x49580,_0x4883e1)[_0x406e1b(0x1e0)])storeSettings(_0x1d3a50,!![]);else logger[_0x406e1b(0x26f)](_0x406e1b(0x279));}),_0xe1f7cb['on']('update-bb',_0xc38c34=>{const _0x54751e=_0x2f753c;if(validateAccess(_0xc38c34,_0x4883e1)['allow'])updateBB(_0x54751e(0x32b));else logger['full'](_0x54751e(0x346));}),_0xe1f7cb['on'](_0x2f753c(0x38f),_0x4b093c=>{const _0xe7b8fb=_0x2f753c;if(validateAccess(_0x4b093c,_0x4883e1)['allow'])updateBB(_0xe7b8fb(0x313));else logger['full'](_0xe7b8fb(0x2a9));}),_0xe1f7cb['on'](_0x2f753c(0x1ff),_0x3fbdf0=>{const _0x5f241d=_0x2f753c;if(validateAccess(_0x3fbdf0,_0x4883e1)[_0x5f241d(0x1e0)]){const _0x1bf6d3=getClient(_0xe1f7cb['id']);if(_0x1bf6d3)getBackupFiles(_0x1bf6d3[_0x5f241d(0x22e)]);else logger[_0x5f241d(0x26f)](_0x5f241d(0x340));}else logger[_0x5f241d(0x26f)](_0x5f241d(0x343));}),_0xe1f7cb['on']('restore-backup-file',(_0x33b9e5,_0x3a0110)=>{const _0x3c96b1=_0x2f753c;if(validateAccess(_0x3a0110,_0x4883e1)['allow'])restoreBackupFile(_0x33b9e5);else logger[_0x3c96b1(0x26f)](_0x3c96b1(0x3b2));}),_0xe1f7cb['on']('get-messages',_0x2813d0=>{const _0x5d8a85=_0x2f753c;if(validateAccess(_0x2813d0,_0x4883e1)[_0x5d8a85(0x1e0)])getMessages();else logger[_0x5d8a85(0x26f)](_0x5d8a85(0x3b5));}),_0xe1f7cb['on']('confirm-message',(_0xd0bb69,_0x5aa3fe)=>{const _0xe481bf=_0x2f753c;if(validateAccess(_0x5aa3fe,_0x4883e1)[_0xe481bf(0x1e0)])confirmMessage(_0xd0bb69);else logger[_0xe481bf(0x26f)](_0xe481bf(0x393));}),_0xe1f7cb['on'](_0x2f753c(0x339),_0x3e69ca=>{const _0x19b879=_0x2f753c;if(validateAccess(_0x3e69ca,_0x4883e1)[_0x19b879(0x1e0)]){if(devices[_0x4883e1][_0x19b879(0x327)])clearTimeout(devices[_0x4883e1][_0x19b879(0x327)]);if(devices[_0x4883e1][_0x19b879(0x220)])clearTimeout(devices[_0x4883e1][_0x19b879(0x220)]);removeSocketListeners(getClient(_0xe1f7cb['id'])[_0x19b879(0x22e)]),addBlacklist(_0x4883e1),devices[_0x4883e1]['telegramIpApproval']=null,devices[_0x4883e1][_0x19b879(0x219)]=null,devices[_0x4883e1][_0x19b879(0x3be)][_0x19b879(0x2e4)]=null,logger[_0x19b879(0x242)](_0x19b879(0x383)+_0x4883e1['slice'](-0x8)),io['to'](getClient(_0xe1f7cb['id'])[_0x19b879(0x22e)])[_0x19b879(0x2c7)](_0x19b879(0x396),{'access':{'allow':![],'reason':_0x19b879(0x1e3),'token':null}});}else logger[_0x19b879(0x26f)](_0x19b879(0x382));});}function initializeSocketBot(_0x2a981d){const _0x4476bc=_0x5d2ff7,_0x2ca160=getClient(_0x2a981d['id'])[_0x4476bc(0x3b9)],_0x237073=getClient(_0x2a981d['id'])[_0x4476bc(0x22e)];_0x2a981d['on'](_0x4476bc(0x1f1),(_0x1e1158,_0x2e95e9)=>{const _0x53028d=_0x4476bc;if(validateAccess(_0x2e95e9,_0x237073)[_0x53028d(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160][_0x53028d(0x2f6)]({'function':_0x53028d(0x344),'args':_0x1e1158});}else logger[_0x53028d(0x26f)](_0x53028d(0x2a7));}),_0x2a981d['on'](_0x4476bc(0x288),(_0x125693,_0x33b9bf)=>{const _0x3e7550=_0x4476bc;if(validateAccess(_0x33b9bf,_0x237073)['allow']){if(pid[_0x2ca160])pid[_0x2ca160][_0x3e7550(0x2f6)]({'function':_0x3e7550(0x1de),'args':_0x125693});}else logger['full'](_0x3e7550(0x299));}),_0x2a981d['on'](_0x4476bc(0x1db),(_0x4bc7fc,_0x51242d)=>{const _0x5d36e9=_0x4476bc;if(validateAccess(_0x51242d,_0x237073)['allow']){if(pid[_0x2ca160])pid[_0x2ca160][_0x5d36e9(0x2f6)]({'function':_0x5d36e9(0x212),'args':_0x4bc7fc});}else logger['full'](_0x5d36e9(0x2c6));}),_0x2a981d['on'](_0x4476bc(0x3b4),(_0x54aad1,_0x926c94)=>{const _0x1c3c8d=_0x4476bc;if(validateAccess(_0x926c94,_0x237073)[_0x1c3c8d(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160][_0x1c3c8d(0x2f6)]({'function':_0x1c3c8d(0x1fd),'args':_0x54aad1});}else logger[_0x1c3c8d(0x26f)](_0x1c3c8d(0x272));}),_0x2a981d['on'](_0x4476bc(0x371),(_0x5eeb4d,_0x52a2ea)=>{const _0x4f3d3e=_0x4476bc;if(validateAccess(_0x52a2ea,_0x237073)[_0x4f3d3e(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160][_0x4f3d3e(0x2f6)]({'function':'storeHeadless','args':_0x5eeb4d});}else logger['full'](_0x4f3d3e(0x1f8));}),_0x2a981d['on'](_0x4476bc(0x303),(_0xeeb429,_0x2b3dde)=>{const _0x4ffc9a=_0x4476bc;if(validateAccess(_0x2b3dde,_0x237073)[_0x4ffc9a(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160][_0x4ffc9a(0x2f6)]({'function':_0x4ffc9a(0x1e9),'args':_0xeeb429});}else logger[_0x4ffc9a(0x26f)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x2a981d['on'](_0x4476bc(0x356),_0x1f35eb=>{const _0x44eba1=_0x4476bc;if(validateAccess(_0x1f35eb,_0x237073)['allow']){if(pid[_0x2ca160])pid[_0x2ca160][_0x44eba1(0x2f6)]({'function':'resetHistory','args':null});}else logger[_0x44eba1(0x26f)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2a981d['on'](_0x4476bc(0x349),_0x59980b=>{const _0x52fdbc=_0x4476bc;if(validateAccess(_0x59980b,_0x237073)[_0x52fdbc(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160][_0x52fdbc(0x2f6)]({'function':_0x52fdbc(0x25d),'args':null});}else logger[_0x52fdbc(0x26f)](_0x52fdbc(0x208));}),_0x2a981d['on'](_0x4476bc(0x218),(_0x162f42,_0x263de3)=>{const _0x2f48ea=_0x4476bc;if(validateAccess(_0x263de3,_0x237073)[_0x2f48ea(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160][_0x2f48ea(0x2f6)]({'function':_0x2f48ea(0x2cf),'args':_0x162f42});}else logger[_0x2f48ea(0x26f)](_0x2f48ea(0x1ed));}),_0x2a981d['on'](_0x4476bc(0x2b2),_0x1e669d=>{const _0x2ff334=_0x4476bc;if(validateAccess(_0x1e669d,_0x237073)['allow']){if(pid[_0x2ca160])pid[_0x2ca160][_0x2ff334(0x2f6)]({'function':_0x2ff334(0x1d7),'args':null});}else logger[_0x2ff334(0x26f)](_0x2ff334(0x3a9));}),_0x2a981d['on'](_0x4476bc(0x227),_0x40f3ee=>{const _0x1a52d0=_0x4476bc;if(validateAccess(_0x40f3ee,_0x237073)[_0x1a52d0(0x1e0)]){if(pid[_0x2ca160])pid[_0x2ca160]['send']({'function':_0x1a52d0(0x39d),'args':null});}else logger[_0x1a52d0(0x26f)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2a981d['on'](_0x4476bc(0x338),_0x2ea04a=>{const _0x543f09=_0x4476bc;if(validateAccess(_0x2ea04a,_0x237073)[_0x543f09(0x1e0)])updateBB(_0x543f09(0x32b));else logger[_0x543f09(0x26f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2a981d['on']('get-messages',_0x23fab4=>{const _0xa0fe5e=_0x4476bc;if(validateAccess(_0x23fab4,_0x237073)[_0xa0fe5e(0x1e0)])getMessages();else logger[_0xa0fe5e(0x26f)](_0xa0fe5e(0x3b5));}),_0x2a981d['on'](_0x4476bc(0x250),(_0x571e66,_0x2d4232)=>{const _0x394e6a=_0x4476bc;if(validateAccess(_0x2d4232,_0x237073)[_0x394e6a(0x1e0)])confirmMessage(_0x571e66);else logger[_0x394e6a(0x26f)](_0x394e6a(0x393));}),_0x2a981d['on'](_0x4476bc(0x339),_0x143df1=>{const _0x3852c1=_0x4476bc;if(validateAccess(_0x143df1,_0x237073)['allow']){if(devices[_0x237073][_0x3852c1(0x327)])clearTimeout(devices[_0x237073][_0x3852c1(0x327)]);if(devices[_0x237073][_0x3852c1(0x220)])clearTimeout(devices[_0x237073]['pidExpireLogin']);removeSocketListeners(getClient(_0x2a981d['id'])[_0x3852c1(0x22e)]),addBlacklist(_0x237073),devices[_0x237073]['telegramIpApproval']=null,devices[_0x237073][_0x3852c1(0x219)]=null,devices[_0x237073][_0x3852c1(0x3be)]['token']=null,logger[_0x3852c1(0x242)](_0x3852c1(0x383)+_0x237073['slice'](-0x8)),io['to'](getClient(_0x2a981d['id'])['uuid'])[_0x3852c1(0x2c7)](_0x3852c1(0x396),{'access':{'allow':![],'reason':_0x3852c1(0x1e3),'token':null}});}else logger[_0x3852c1(0x26f)](_0x3852c1(0x382));});}function removeSocketListeners(_0x22d833){getClientsWithUuid(_0x22d833)['forEach'](_0x39079a=>{getSocket(_0x39079a['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5b3146=_0x5d2ff7;let _0x4d20e4=settings;return settings[_0x5b3146(0x323)]&&settings[_0x5b3146(0x323)]!=''&&(_0x4d20e4={..._0x4d20e4,'telegramToken':'************'}),settings[_0x5b3146(0x21f)]&&settings[_0x5b3146(0x21f)]!=''&&(_0x4d20e4={..._0x4d20e4,'bbPassword':_0x5b3146(0x30e)}),(settings['bbPassword']&&settings['bbPassword']==_0x5b3146(0x24d)||settings['telegramToken']&&settings['telegramToken']==_0x5b3146(0x24d))&&(_0x4d20e4={..._0x4d20e4,'restored':{'password':settings[_0x5b3146(0x21f)]=='***','telegram':settings[_0x5b3146(0x323)]=='***'}}),_0x4d20e4;}async function updateBB(_0x27c91f){const _0x1ca546=_0x5d2ff7;await backupConfigFiles(),installingUpdate=!![],config[_0x1ca546(0x1f0)](_0x5b8410=>{restartBot(_0x5b8410['botID']);}),logger[_0x1ca546(0x242)](_0x1ca546(0x2e7)+_0x27c91f);if(_0x27c91f==_0x1ca546(0x32b))process[_0x1ca546(0x2f6)]({'update':!![]},_0x3e7234=>{});else _0x27c91f==_0x1ca546(0x313)&&process[_0x1ca546(0x2f6)]({'reinstall':!![]},_0x5b2e68=>{});}function startBot(_0x39f0e6,_0x1c2ae8,_0x35598f){const _0x1e00fb=_0x5d2ff7;if(debugging)_0x39f0e6[_0x1e00fb(0x29c)]('-d');let _0x5716be=![];const _0x369a92=_0x39f0e6[0x0];_0x1c2ae8={..._0x1c2ae8,'stdio':['inherit','inherit','inherit','ipc']},pid[_0x369a92]=childProcess[_0x1e00fb(0x33a)](botfile,_0x39f0e6,_0x1c2ae8),pid[_0x369a92]['on']('message',_0x4de3e4=>{const _0xd6a236=_0x1e00fb;switch(Object['keys'](_0x4de3e4)[0x0]){case _0xd6a236(0x2de):updateBotName(_0x369a92,_0x4de3e4[_0xd6a236(0x2de)]);break;case'updatebotmanager':updateBotManager();break;case _0xd6a236(0x396):updateStatus(_0x369a92,_0x4de3e4[_0xd6a236(0x396)]);break;case _0xd6a236(0x2aa):updateLive(_0x369a92,_0x4de3e4[_0xd6a236(0x2aa)]);break;case'started':updateLive(_0x369a92,_0x4de3e4[_0xd6a236(0x21e)]),io['to'](_0x369a92)[_0xd6a236(0x2c7)](_0xd6a236(0x396),{'access':{'allow':![],'reason':_0xd6a236(0x210),'token':null}});break;case _0xd6a236(0x391):_0x4de3e4[_0xd6a236(0x391)]==_0xd6a236(0x3b6)&&restartBot(_0x369a92);_0x4de3e4[_0xd6a236(0x391)]==_0xd6a236(0x30b)&&toggleBot(_0x369a92,_0xd6a236(0x3bb),_0xd6a236(0x293));break;case _0xd6a236(0x2f4):sendTelegram(_0x369a92,_0x4de3e4['telegram']);break;case _0xd6a236(0x38e):sendTelegramMsg(_0x4de3e4[_0xd6a236(0x38e)]);break;case'function':io['to'](_0x369a92)[_0xd6a236(0x2c7)](_0x4de3e4[_0xd6a236(0x2ce)],_0x4de3e4[_0xd6a236(0x2c0)]);break;}}),pid[_0x369a92]['on'](_0x1e00fb(0x21a),function(_0x47d8a4){if(_0x5716be)return;_0x5716be=!![],_0x35598f(_0x47d8a4);}),pid[_0x369a92]['on']('exit',async function(_0x2d53d7){const _0x5b2325=_0x1e00fb;if(installingUpdate)return;if(_0x5716be)return;_0x5716be=!![],_0x35598f(null);const _0x913463=dbConfig['get'](_0x5b2325(0x39f))['find']({'botID':_0x369a92})[_0x5b2325(0x261)]();_0x913463&&(_0x913463[_0x5b2325(0x396)]==_0x5b2325(0x26e)||_0x913463['status']==_0x5b2325(0x388))&&(await sleep(0x3e8),updateLive(_0x369a92,'stopped'),logger[_0x5b2325(0x26f)](_0x5b2325(0x330)+_0x369a92),startBot([_0x369a92,userID],{'cwd':bbpath},function(_0x9e840b){const _0x518489=_0x5b2325;if(_0x9e840b)logger[_0x518489(0x26f)](_0x9e840b);}));});}function stopBot(_0x24c3e3){const _0x5a3641=_0x5d2ff7;getClientsWithBotID(_0x24c3e3)[_0x5a3641(0x1f0)](_0x560f7d=>{const _0x20260a=_0x5a3641;getSocket(_0x560f7d['id'])[_0x20260a(0x378)](!![]),removeClient(_0x560f7d['id']);}),pid[_0x24c3e3]&&(pid[_0x24c3e3][_0x5a3641(0x30b)](),pid[_0x24c3e3]=null);}function restartBot(_0x521f22){const _0x477d24=_0x5d2ff7;if(pid[_0x521f22])pid[_0x521f22][_0x477d24(0x30b)]();}function addBot(){const _0x3801f5=_0x5d2ff7;let _0x368b09;for(let _0xe3ce4f=0x1;_0xe3ce4f<0x3e9;_0xe3ce4f++){_0x368b09=_0xe3ce4f['toString']()['padStart'](0x3,'0');let _0x473635=config['find'](_0x533c10=>_0x533c10[_0x3801f5(0x269)]==_0x368b09);if(!_0x473635)break;}if(_0x368b09===_0x3801f5(0x281)){logger['full'](_0x3801f5(0x290));return;}logger[_0x3801f5(0x26f)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x368b09),dbConfig[_0x3801f5(0x312)](_0x3801f5(0x39f))[_0x3801f5(0x29c)]({'botID':_0x368b09,'botname':_0x3801f5(0x2df)+_0x368b09,'status':_0x3801f5(0x388),'live':''})[_0x3801f5(0x31a)](),startBot([_0x368b09,userID],{'cwd':bbpath},function(_0x28f3ab){const _0x379710=_0x3801f5;if(_0x28f3ab)logger[_0x379710(0x26f)](_0x28f3ab);}),config=getConfiguration(),io['to']('botmanager')[_0x3801f5(0x2c7)](_0x3801f5(0x39f),config),broadcastToBots(_0x3801f5(0x39f),JSON['stringify'](config));}function deleteBot(_0x401232){const _0xed1821=_0x5d2ff7;getClientsWithBotID(_0x401232)[_0xed1821(0x1f0)](_0xb064c9=>{getSocket(_0xb064c9['id'])['disconnect'](!![]),removeClient(_0xb064c9['id']);}),dbConfig[_0xed1821(0x312)]('bots')[_0xed1821(0x24f)]({'botID':_0x401232})[_0xed1821(0x31a)](),logger[_0xed1821(0x26f)](_0xed1821(0x320)+_0x401232),stopBot(_0x401232);try{if(fs[_0xed1821(0x2ec)](path['join'](configpath,'bot-'+_0x401232+'-config.json')))fs[_0xed1821(0x203)](path['join'](configpath,_0xed1821(0x31c)+_0x401232+_0xed1821(0x2a4)));if(fs['existsSync'](path['join'](configpath,_0xed1821(0x31c)+_0x401232+_0xed1821(0x301))))fs[_0xed1821(0x203)](path[_0xed1821(0x246)](configpath,_0xed1821(0x31c)+_0x401232+_0xed1821(0x301)));if(fs[_0xed1821(0x2ec)](path['join'](configpath,'bot-'+_0x401232+_0xed1821(0x27d))))fs[_0xed1821(0x203)](path[_0xed1821(0x246)](configpath,'bot-'+_0x401232+_0xed1821(0x27d)));if(fs[_0xed1821(0x2ec)](path['join'](configpath,_0xed1821(0x31c)+_0x401232+_0xed1821(0x217))))fs['unlinkSync'](path[_0xed1821(0x246)](configpath,'bot-'+_0x401232+_0xed1821(0x217)));}catch(_0x28771e){if(_0x28771e)logger[_0xed1821(0x26f)](_0xed1821(0x365),_0x28771e);}config=getConfiguration(),io['to'](_0xed1821(0x2ee))[_0xed1821(0x2c7)](_0xed1821(0x39f),config),broadcastToBots(_0xed1821(0x39f),JSON[_0xed1821(0x1d9)](config));}function toggleBot(_0x1ffc93,_0x7b48fe,_0x2a048a){const _0x5ca34d=_0x5d2ff7;dbConfig[_0x5ca34d(0x312)](_0x5ca34d(0x39f))[_0x5ca34d(0x2c1)]({'botID':_0x1ffc93})[_0x5ca34d(0x226)]({'status':_0x7b48fe})[_0x5ca34d(0x226)]({'live':_0x2a048a})['write']();if(_0x7b48fe==_0x5ca34d(0x26e)||_0x7b48fe==_0x5ca34d(0x388))logger['full'](_0x5ca34d(0x291)+_0x1ffc93),startBot([_0x1ffc93,userID],{'cwd':bbpath},function(_0x5e3dd7){const _0x5303b9=_0x5ca34d;if(_0x5e3dd7)logger[_0x5303b9(0x26f)](_0x5e3dd7);});else(_0x7b48fe==_0x5ca34d(0x3bb)||_0x7b48fe==_0x5ca34d(0x38b))&&(logger[_0x5ca34d(0x26f)]('Disabled\x20Bot\x20'+_0x1ffc93),stopBot(_0x1ffc93));config=getConfiguration(),io['to'](_0x5ca34d(0x2ee))[_0x5ca34d(0x2c7)](_0x5ca34d(0x39f),config),broadcastToBots('bots',JSON[_0x5ca34d(0x1d9)](config));}function toggleStatus(_0x221046){const _0x1ae813=_0x5d2ff7;let _0x3f146c=dbConfig['get']('bots')[_0x1ae813(0x2c1)]({'botID':_0x221046})[_0x1ae813(0x261)](),_0x40b6ab;if(_0x3f146c[_0x1ae813(0x396)]===_0x1ae813(0x26e))_0x40b6ab='disabled';else{if(_0x3f146c[_0x1ae813(0x396)]===_0x1ae813(0x388))_0x40b6ab=_0x1ae813(0x38b);else{if(_0x3f146c['status']===_0x1ae813(0x38b))_0x40b6ab=_0x1ae813(0x388);else{if(_0x3f146c[_0x1ae813(0x396)]===_0x1ae813(0x3bb))_0x40b6ab='enabled';}}}return _0x40b6ab;}function updateStatus(_0x5c8522,_0x4f6f40){const _0x512cda=_0x5d2ff7;dbConfig[_0x512cda(0x312)](_0x512cda(0x39f))[_0x512cda(0x2c1)]({'botID':_0x5c8522})['assign']({'status':_0x4f6f40})[_0x512cda(0x31a)](),config=getConfiguration(),io['to'](_0x512cda(0x2ee))[_0x512cda(0x2c7)](_0x512cda(0x39f),config),broadcastToBots(_0x512cda(0x39f),JSON['stringify'](config));}function updateLive(_0x287f88,_0x58eaa6){const _0x342efb=_0x5d2ff7;dbConfig[_0x342efb(0x312)](_0x342efb(0x39f))[_0x342efb(0x2c1)]({'botID':_0x287f88})['assign']({'live':_0x58eaa6})[_0x342efb(0x31a)](),config=getConfiguration(),io['to'](_0x342efb(0x2ee))[_0x342efb(0x2c7)](_0x342efb(0x39f),config),broadcastToBots(_0x342efb(0x39f),JSON[_0x342efb(0x1d9)](config));}function updateBotName(_0x2ae612,_0x972cec){const _0xd5befb=_0x5d2ff7;dbConfig[_0xd5befb(0x312)](_0xd5befb(0x39f))[_0xd5befb(0x2c1)]({'botID':_0x2ae612})['assign']({'botname':_0x972cec})[_0xd5befb(0x31a)](),config=getConfiguration(),io['to'](_0xd5befb(0x2ee))[_0xd5befb(0x2c7)](_0xd5befb(0x39f),config),broadcastToBots(_0xd5befb(0x39f),JSON[_0xd5befb(0x1d9)](config));}function updateBotManager(){const _0x286e1d=_0x5d2ff7;config=getConfiguration(),io['to'](_0x286e1d(0x2ee))[_0x286e1d(0x2c7)]('bots',config),broadcastToBots(_0x286e1d(0x39f),JSON[_0x286e1d(0x1d9)](config));}function toggleBotMode(_0x295449){const _0x4a8f04=_0x5d2ff7;if(pid[_0x295449])pid[_0x295449]['send']({'function':'toggleBotMode','args':null});else{const _0x23c1d1=configpath+_0x4a8f04(0x31c)+_0x295449+_0x4a8f04(0x2a4),_0x6f94c=fs[_0x4a8f04(0x255)](_0x23c1d1),_0x534d3e=JSON['parse'](_0x6f94c),_0xfae22=_0x534d3e[_0x4a8f04(0x3b9)][0x0]['headless'];_0x534d3e[_0x4a8f04(0x3b9)][0x0][_0x4a8f04(0x34d)]=!_0xfae22;const _0x2fca73=JSON['stringify'](_0x534d3e,null,0x2);fs[_0x4a8f04(0x260)](_0x23c1d1,_0x2fca73),config=getConfiguration(),io['to'](_0x4a8f04(0x2ee))[_0x4a8f04(0x2c7)](_0x4a8f04(0x39f),config),broadcastToBots(_0x4a8f04(0x39f),JSON['stringify'](config));}}function telegramError(_0x16d000){const _0x305e02=_0x5d2ff7;logger['simple'](getTimeStamp()+_0x305e02(0x2d8));}function validateTelegram(_0x507161){const _0x29a37c=_0x5d2ff7;if(_0x507161[_0x29a37c(0x28d)][_0x29a37c(0x363)]!=settings[_0x29a37c(0x34f)]&&'@'+_0x507161[_0x29a37c(0x28d)][_0x29a37c(0x363)]!=settings['telegramUsername'])return tgBot[_0x29a37c(0x2bd)](_0x507161[_0x29a37c(0x280)]['id'],_0x29a37c(0x37f),{'parse_mode':_0x29a37c(0x2f0)})[_0x29a37c(0x390)](_0x1f1d56=>{telegramError(_0x1f1d56);}),![];return!![];}async function initTelegram(){const _0x4a0ae2=_0x5d2ff7;if(tgBot)tgBot[_0x4a0ae2(0x2a2)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x4f9beb=_0x4a0ae2(0x34b);_0x4f9beb+='\x0a',_0x4f9beb+=_0x4a0ae2(0x372),_0x4f9beb+='/disable\x20-\x20disable\x20notifications\x0a',_0x4f9beb+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4f9beb+=_0x4a0ae2(0x289),_0x4f9beb+=_0x4a0ae2(0x221),_0x4f9beb+=_0x4a0ae2(0x32a),_0x4f9beb+=_0x4a0ae2(0x335),_0x4f9beb+=_0x4a0ae2(0x399),_0x4f9beb+=_0x4a0ae2(0x256),_0x4f9beb+=_0x4a0ae2(0x235),_0x4f9beb+=_0x4a0ae2(0x2d1),_0x4f9beb+=_0x4a0ae2(0x37e),_0x4f9beb+=_0x4a0ae2(0x354),_0x4f9beb+=_0x4a0ae2(0x361);let _0x29f320='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x29f320+='\x0a',_0x29f320+=_0x4f9beb,tgBot['onText'](/\/start/,_0x4af820=>{const _0x422983=_0x4a0ae2;if(!validateTelegram(_0x4af820))return;if(settings[_0x422983(0x2eb)]!=_0x4af820[_0x422983(0x280)]['id'])updateSetting(_0x422983(0x2eb),_0x4af820[_0x422983(0x280)]['id']);updateSetting(_0x422983(0x24a),!![]),tgBot['sendMessage'](_0x4af820[_0x422983(0x280)]['id'],_0x29f320)[_0x422983(0x390)](_0x464f4e=>{telegramError(_0x464f4e);});}),tgBot['onText'](/\/enable/,_0x5dc8c5=>{const _0x7fd657=_0x4a0ae2;if(!validateTelegram(_0x5dc8c5))return;if(settings[_0x7fd657(0x2eb)]!=_0x5dc8c5[_0x7fd657(0x280)]['id'])updateSetting('telegramChatId',_0x5dc8c5[_0x7fd657(0x280)]['id']);updateSetting(_0x7fd657(0x24a),!![]),tgBot[_0x7fd657(0x2bd)](_0x5dc8c5[_0x7fd657(0x280)]['id'],_0x7fd657(0x27a))[_0x7fd657(0x390)](_0x5a97b1=>{telegramError(_0x5a97b1);});}),tgBot[_0x4a0ae2(0x20d)](/\/config/,async _0x2b53fd=>{const _0x581b6a=_0x4a0ae2;if(!validateTelegram(_0x2b53fd))return;tgBot[_0x581b6a(0x359)](_0x581b6a(0x243)),tgBot[_0x581b6a(0x2bd)](_0x2b53fd['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x581b6a(0x252),'callback_data':_0x581b6a(0x209)},{'text':_0x581b6a(0x325),'callback_data':_0x581b6a(0x268)},{'text':_0x581b6a(0x2d6),'callback_data':_0x581b6a(0x305)}]]}})['catch'](_0x7f760e=>{telegramError(_0x7f760e);}),tgBot['on'](_0x581b6a(0x243),async _0x453a79=>{const _0x3155d5=_0x581b6a,_0x68674b=_0x453a79[_0x3155d5(0x239)],_0x40c724=_0x453a79[_0x3155d5(0x2e6)];tgBot[_0x3155d5(0x266)](_0x453a79['id'])[_0x3155d5(0x387)](async()=>{const _0x460b38=_0x3155d5;_0x68674b==_0x460b38(0x209)&&(updateSetting(_0x460b38(0x376),_0x460b38(0x209)),updateSetting('telegramEnabled',!![]),await tgBot[_0x460b38(0x2bd)](_0x40c724[_0x460b38(0x280)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x460b38(0x390)](_0x244a0b=>{telegramError(_0x244a0b);}));_0x68674b==_0x460b38(0x268)&&(updateSetting(_0x460b38(0x376),_0x460b38(0x268)),updateSetting(_0x460b38(0x24a),!![]),await tgBot['sendMessage'](_0x40c724['chat']['id'],_0x460b38(0x322))[_0x460b38(0x390)](_0x192bb8=>{telegramError(_0x192bb8);}));_0x68674b==_0x460b38(0x305)&&(updateSetting(_0x460b38(0x376),_0x460b38(0x305)),updateSetting(_0x460b38(0x24a),!![]),await tgBot[_0x460b38(0x2bd)](_0x40c724[_0x460b38(0x280)]['id'],_0x460b38(0x2f9))[_0x460b38(0x390)](_0xf56877=>{telegramError(_0xf56877);}));if(!settings[_0x460b38(0x2eb)])tgBot[_0x460b38(0x2bd)](_0x40c724[_0x460b38(0x280)]['id'],_0x460b38(0x35d))[_0x460b38(0x390)](_0x6848d0=>{telegramError(_0x6848d0);});}),tgBot[_0x3155d5(0x359)]('callback_query');});}),tgBot[_0x4a0ae2(0x20d)](/\/status/,_0x4e6faf=>{const _0x2a8c5e=_0x4a0ae2;if(!validateTelegram(_0x4e6faf))return;const _0xac592d=getBotsWithMode();let _0x30ffe3=_0x2a8c5e(0x25b);config[_0x2a8c5e(0x1f0)](_0x47d677=>{const _0x3ed209=_0x2a8c5e,_0x5e7264=_0xac592d[_0x3ed209(0x2c1)](_0x5bb444=>_0x5bb444[_0x3ed209(0x269)]==_0x47d677[_0x3ed209(0x269)])[_0x3ed209(0x2e0)];_0x30ffe3+=_0x3ed209(0x2df)+_0x47d677[_0x3ed209(0x269)]+':\x20'+_0x47d677['status']+_0x3ed209(0x2be)+_0x5e7264+_0x3ed209(0x2be)+_0x47d677['live']+'\x0a';}),_0x30ffe3+='\x0a',_0x30ffe3+=_0x2a8c5e(0x27f),_0x30ffe3+=!settings['telegramEnabled']?_0x2a8c5e(0x1fc):_0x2a8c5e(0x21d),_0x30ffe3+=settings[_0x2a8c5e(0x24a)]?settings['telegramEvents']==_0x2a8c5e(0x305)?_0x2a8c5e(0x2a8):_0x2a8c5e(0x2cd)+settings['telegramEvents']+_0x2a8c5e(0x2db):'',tgBot[_0x2a8c5e(0x2bd)](_0x4e6faf[_0x2a8c5e(0x280)]['id'],_0x30ffe3,{'parse_mode':_0x2a8c5e(0x2f0)})[_0x2a8c5e(0x390)](_0x16e563=>{telegramError(_0x16e563);});}),tgBot[_0x4a0ae2(0x20d)](/\/restart/,_0x3620fd=>{const _0x2d9ae1=_0x4a0ae2;if(!validateTelegram(_0x3620fd))return;tgBot[_0x2d9ae1(0x359)](_0x2d9ae1(0x243));const _0xea2aae=getEnabledBots();if(_0xea2aae['length']==0x0)tgBot[_0x2d9ae1(0x2bd)](_0x3620fd[_0x2d9ae1(0x280)]['id'],_0x2d9ae1(0x274))[_0x2d9ae1(0x390)](_0x588153=>{telegramError(_0x588153);});else{if(_0xea2aae['length']>0x1)_0xea2aae[_0x2d9ae1(0x29c)]({'botID':'all'});let _0x13bca7=[],_0x1b0ed1=[];const _0x4c5f3e=_0xea2aae[_0x2d9ae1(0x2ca)]%0x4==0x0||_0xea2aae['length']%0x4==0x3||_0xea2aae[_0x2d9ae1(0x2ca)]%0x3==0x1?0x4:0x3;let _0xec6bcc=0x0;_0xea2aae[_0x2d9ae1(0x1f0)]((_0x12e787,_0x21ac70)=>{const _0x3873a0=_0x2d9ae1;if(_0x21ac70%_0x4c5f3e==0x0)_0x1b0ed1=[];_0x1b0ed1['push']({'text':_0x12e787[_0x3873a0(0x269)]==_0x3873a0(0x305)?_0x3873a0(0x385):'Bot\x20'+_0x12e787[_0x3873a0(0x269)],'callback_data':_0x12e787[_0x3873a0(0x269)]}),_0x21ac70%_0x4c5f3e==0x0&&(_0x13bca7[_0xec6bcc]=_0x1b0ed1,_0xec6bcc++);}),tgBot[_0x2d9ae1(0x2bd)](_0x3620fd[_0x2d9ae1(0x280)]['id'],_0x2d9ae1(0x1e2),{'reply_markup':{'inline_keyboard':_0x13bca7}})['catch'](_0x1e0a14=>{telegramError(_0x1e0a14);}),tgBot['on']('callback_query',async _0x4e3c59=>{const _0x33aac9=_0x2d9ae1,_0x42791a=_0x4e3c59[_0x33aac9(0x239)],_0x190e90=_0x4e3c59[_0x33aac9(0x2e6)];tgBot['answerCallbackQuery'](_0x4e3c59['id'])[_0x33aac9(0x387)](async()=>{const _0x135031=_0x33aac9;_0x42791a==_0x135031(0x305)?config[_0x135031(0x1f0)](_0x53bfb1=>{const _0x100923=_0x135031;restartBot(_0x53bfb1[_0x100923(0x269)]);}):restartBot(_0x42791a);}),tgBot[_0x33aac9(0x359)](_0x33aac9(0x243));});}}),tgBot[_0x4a0ae2(0x20d)](/\/on/,_0x11d0c7=>{const _0x14bd9f=_0x4a0ae2;if(!validateTelegram(_0x11d0c7))return;tgBot[_0x14bd9f(0x359)](_0x14bd9f(0x243));const _0x34eded=getDisabledBots();if(_0x34eded[_0x14bd9f(0x2ca)]==0x0)tgBot['sendMessage'](_0x11d0c7[_0x14bd9f(0x280)]['id'],_0x14bd9f(0x20e))['catch'](_0x15d56d=>{telegramError(_0x15d56d);});else{if(_0x34eded['length']>0x1)_0x34eded[_0x14bd9f(0x29c)]({'botID':_0x14bd9f(0x305)});let _0x5e1c0f=[],_0x3afa02=[];const _0xe9097d=_0x34eded['length']%0x4==0x0||_0x34eded['length']%0x4==0x3||_0x34eded[_0x14bd9f(0x2ca)]%0x3==0x1?0x4:0x3;let _0x1499b5=0x0;_0x34eded[_0x14bd9f(0x1f0)]((_0x1f8323,_0x316834)=>{const _0x5ba2a5=_0x14bd9f;if(_0x316834%_0xe9097d==0x0)_0x3afa02=[];_0x3afa02[_0x5ba2a5(0x29c)]({'text':_0x1f8323[_0x5ba2a5(0x269)]==_0x5ba2a5(0x305)?'All\x20bots':_0x5ba2a5(0x2df)+_0x1f8323[_0x5ba2a5(0x269)],'callback_data':_0x1f8323['botID']}),_0x316834%_0xe9097d==0x0&&(_0x5e1c0f[_0x1499b5]=_0x3afa02,_0x1499b5++);}),tgBot[_0x14bd9f(0x2bd)](_0x11d0c7[_0x14bd9f(0x280)]['id'],_0x14bd9f(0x2b3),{'reply_markup':{'inline_keyboard':_0x5e1c0f}})[_0x14bd9f(0x390)](_0x4c1968=>{telegramError(_0x4c1968);}),tgBot['on'](_0x14bd9f(0x243),async _0xe5074b=>{const _0x223133=_0x14bd9f,_0x5984db=_0xe5074b['data'],_0x536352=_0xe5074b['message'];tgBot[_0x223133(0x266)](_0xe5074b['id'])[_0x223133(0x387)](async()=>{const _0x13920d=_0x223133;_0x5984db==_0x13920d(0x305)?(tgBot[_0x13920d(0x2bd)](_0x536352[_0x13920d(0x280)]['id'],_0x13920d(0x1ea))['catch'](_0x5a7a16=>{telegramError(_0x5a7a16);}),_0x34eded[_0x13920d(0x1f0)](_0x2acb2f=>{const _0x1ab083=_0x13920d;if(_0x2acb2f[_0x1ab083(0x269)]!='all')toggleBot(_0x2acb2f[_0x1ab083(0x269)],toggleStatus(_0x2acb2f['botID']),_0x1ab083(0x293));})):(tgBot['sendMessage'](_0x536352[_0x13920d(0x280)]['id'],_0x13920d(0x34e)+_0x5984db)[_0x13920d(0x390)](_0x12d2e1=>{telegramError(_0x12d2e1);}),toggleBot(_0x5984db,toggleStatus(_0x5984db),_0x13920d(0x293)));}),tgBot[_0x223133(0x359)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x165a42=>{const _0xbef682=_0x4a0ae2;if(!validateTelegram(_0x165a42))return;tgBot[_0xbef682(0x359)]('callback_query');const _0x578a2b=getEnabledBots();if(_0x578a2b[_0xbef682(0x2ca)]==0x0)tgBot[_0xbef682(0x2bd)](_0x165a42[_0xbef682(0x280)]['id'],_0xbef682(0x274))[_0xbef682(0x390)](_0x120314=>{telegramError(_0x120314);});else{if(_0x578a2b[_0xbef682(0x2ca)]>0x1)_0x578a2b[_0xbef682(0x29c)]({'botID':_0xbef682(0x305)});let _0x4c6312=[],_0x52d36d=[];const _0x5e11c5=_0x578a2b['length']%0x4==0x0||_0x578a2b['length']%0x4==0x3||_0x578a2b[_0xbef682(0x2ca)]%0x3==0x1?0x4:0x3;let _0x3910c5=0x0;_0x578a2b[_0xbef682(0x1f0)]((_0x28e409,_0x12e617)=>{const _0x5ba56a=_0xbef682;if(_0x12e617%_0x5e11c5==0x0)_0x52d36d=[];_0x52d36d['push']({'text':_0x28e409[_0x5ba56a(0x269)]==_0x5ba56a(0x305)?_0x5ba56a(0x385):'Bot\x20'+_0x28e409[_0x5ba56a(0x269)],'callback_data':_0x28e409['botID']}),_0x12e617%_0x5e11c5==0x0&&(_0x4c6312[_0x3910c5]=_0x52d36d,_0x3910c5++);}),tgBot[_0xbef682(0x2bd)](_0x165a42[_0xbef682(0x280)]['id'],_0xbef682(0x270),{'reply_markup':{'inline_keyboard':_0x4c6312}})['catch'](_0x5903c3=>{telegramError(_0x5903c3);}),tgBot['on'](_0xbef682(0x243),async _0x472391=>{const _0x42fca4=_0xbef682,_0x492fd9=_0x472391[_0x42fca4(0x239)],_0x2423a1=_0x472391['message'];tgBot[_0x42fca4(0x266)](_0x472391['id'])['then'](async()=>{const _0x4cc3ae=_0x42fca4;_0x492fd9==_0x4cc3ae(0x305)?(tgBot[_0x4cc3ae(0x2bd)](_0x2423a1[_0x4cc3ae(0x280)]['id'],_0x4cc3ae(0x2a0))['catch'](_0x1b4328=>{telegramError(_0x1b4328);}),_0x578a2b['forEach'](_0xc11251=>{const _0x52de98=_0x4cc3ae;if(_0xc11251[_0x52de98(0x269)]!=_0x52de98(0x305))toggleBot(_0xc11251[_0x52de98(0x269)],toggleStatus(_0xc11251[_0x52de98(0x269)]),_0x52de98(0x293));})):(tgBot[_0x4cc3ae(0x2bd)](_0x2423a1[_0x4cc3ae(0x280)]['id'],_0x4cc3ae(0x1f6)+_0x492fd9)['catch'](_0x375cbd=>{telegramError(_0x375cbd);}),toggleBot(_0x492fd9,toggleStatus(_0x492fd9),_0x4cc3ae(0x293)));}),tgBot['removeListener'](_0x42fca4(0x243));});}}),tgBot[_0x4a0ae2(0x20d)](/\/metrics/,_0x1abc85=>{const _0x21377e=_0x4a0ae2;if(!validateTelegram(_0x1abc85))return;tgBot['removeListener']('callback_query');const _0x1610e6=getEnabledBots();if(_0x1610e6[_0x21377e(0x2ca)]==0x0)tgBot[_0x21377e(0x2bd)](_0x1abc85[_0x21377e(0x280)]['id'],_0x21377e(0x274))['catch'](_0x4dd6bf=>{telegramError(_0x4dd6bf);});else{if(_0x1610e6['length']>0x1){let _0x4038be=[],_0x41338f=[];const _0x55aa67=_0x1610e6[_0x21377e(0x2ca)]%0x4==0x0||_0x1610e6['length']%0x4==0x3||_0x1610e6['length']%0x3==0x1?0x4:0x3;let _0x3095f4=0x0;_0x1610e6[_0x21377e(0x1f0)]((_0x26fe23,_0x414ec3)=>{const _0x3b5beb=_0x21377e;if(_0x414ec3%_0x55aa67==0x0)_0x41338f=[];_0x41338f['push']({'text':'Bot\x20'+_0x26fe23[_0x3b5beb(0x269)],'callback_data':_0x26fe23['botID']}),_0x414ec3%_0x55aa67==0x0&&(_0x4038be[_0x3095f4]=_0x41338f,_0x3095f4++);}),tgBot[_0x21377e(0x2bd)](_0x1abc85['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x4038be}})['catch'](_0x411751=>{telegramError(_0x411751);}),tgBot['on']('callback_query',async _0x129478=>{const _0x3e87a4=_0x21377e,_0x3fedfc=_0x129478[_0x3e87a4(0x239)],_0x131180=_0x129478[_0x3e87a4(0x2e6)];tgBot[_0x3e87a4(0x266)](_0x129478['id'])[_0x3e87a4(0x387)](async()=>{const _0x4df1f5=_0x3e87a4;if(pid[_0x3fedfc])pid[_0x3fedfc][_0x4df1f5(0x2f6)]({'function':_0x4df1f5(0x3aa),'args':null});}),tgBot[_0x3e87a4(0x359)](_0x3e87a4(0x243));});}else{const _0x43e30a=_0x1610e6[0x0][_0x21377e(0x269)];if(pid[_0x43e30a])pid[_0x43e30a]['send']({'function':_0x21377e(0x3aa),'args':null});}}}),tgBot[_0x4a0ae2(0x20d)](/\/portfolio/,_0x5e91fc=>{const _0xeb9604=_0x4a0ae2;if(!validateTelegram(_0x5e91fc))return;tgBot[_0xeb9604(0x359)](_0xeb9604(0x243));const _0x309a06=getEnabledBots();if(_0x309a06['length']==0x0)tgBot[_0xeb9604(0x2bd)](_0x5e91fc['chat']['id'],_0xeb9604(0x274))[_0xeb9604(0x390)](_0x17547e=>{telegramError(_0x17547e);});else{if(_0x309a06['length']>0x1){let _0x2a3950=[],_0x3f9575=[];const _0x2ab9c1=_0x309a06['length']%0x4==0x0||_0x309a06[_0xeb9604(0x2ca)]%0x4==0x3||_0x309a06['length']%0x3==0x1?0x4:0x3;let _0x3797e9=0x0;_0x309a06[_0xeb9604(0x1f0)]((_0x556640,_0x3ad554)=>{const _0x4fcb64=_0xeb9604;if(_0x3ad554%_0x2ab9c1==0x0)_0x3f9575=[];_0x3f9575['push']({'text':_0x4fcb64(0x2df)+_0x556640[_0x4fcb64(0x269)],'callback_data':_0x556640[_0x4fcb64(0x269)]}),_0x3ad554%_0x2ab9c1==0x0&&(_0x2a3950[_0x3797e9]=_0x3f9575,_0x3797e9++);}),tgBot[_0xeb9604(0x2bd)](_0x5e91fc[_0xeb9604(0x280)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x2a3950}})[_0xeb9604(0x390)](_0x47b65e=>{telegramError(_0x47b65e);}),tgBot['on'](_0xeb9604(0x243),async _0x127ae6=>{const _0x51630b=_0xeb9604,_0x153716=_0x127ae6[_0x51630b(0x239)],_0x591213=_0x127ae6[_0x51630b(0x2e6)];tgBot[_0x51630b(0x266)](_0x127ae6['id'])[_0x51630b(0x387)](async()=>{const _0x5dddf7=_0x51630b;if(pid[_0x153716])pid[_0x153716][_0x5dddf7(0x2f6)]({'function':_0x5dddf7(0x36a),'args':null});}),tgBot[_0x51630b(0x359)](_0x51630b(0x243));});}else{const _0x14b0fe=_0x309a06[0x0][_0xeb9604(0x269)];if(pid[_0x14b0fe])pid[_0x14b0fe][_0xeb9604(0x2f6)]({'function':_0xeb9604(0x36a),'args':null});}}}),tgBot['onText'](/\/update/,async _0xd12043=>{const _0x55793c=_0x4a0ae2;if(!validateTelegram(_0xd12043))return;tgBot['removeListener'](_0x55793c(0x243)),await getMessages();if(!updateAvailable)tgBot[_0x55793c(0x2bd)](_0xd12043[_0x55793c(0x280)]['id'],_0x55793c(0x3ba))[_0x55793c(0x390)](_0x164cfa=>{telegramError(_0x164cfa);});else!validInstallation?tgBot[_0x55793c(0x2bd)](_0xd12043[_0x55793c(0x280)]['id'],_0x55793c(0x26a))[_0x55793c(0x390)](_0x557b28=>{telegramError(_0x557b28);}):(tgBot['sendMessage'](_0xd12043[_0x55793c(0x280)]['id'],_0x55793c(0x2e3),{'reply_markup':{'inline_keyboard':[[{'text':_0x55793c(0x2a6),'callback_data':_0x55793c(0x1f9)},{'text':'No','callback_data':'no'}]]}})[_0x55793c(0x390)](_0x21d82e=>{telegramError(_0x21d82e);}),tgBot['on'](_0x55793c(0x243),async _0x40c76a=>{const _0x2f739d=_0x55793c,_0x2da7e7=_0x40c76a[_0x2f739d(0x239)],_0x458d60=_0x40c76a[_0x2f739d(0x2e6)];tgBot[_0x2f739d(0x266)](_0x40c76a['id'])[_0x2f739d(0x387)](async()=>{const _0x50cc7f=_0x2f739d;_0x2da7e7==_0x50cc7f(0x1f9)&&(await tgBot[_0x50cc7f(0x2bd)](_0x458d60[_0x50cc7f(0x280)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x50cc7f(0x390)](_0x538afb=>{telegramError(_0x538afb);}),updateBB(_0x50cc7f(0x32b))),_0x2da7e7=='no'&&await tgBot['sendMessage'](_0x458d60['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')['catch'](_0x407ce7=>{telegramError(_0x407ce7);});}),tgBot[_0x2f739d(0x359)](_0x2f739d(0x243));}));}),tgBot['onText'](/\/reinstall/,async _0x56e152=>{const _0x182a33=_0x4a0ae2;if(!validateTelegram(_0x56e152))return;tgBot[_0x182a33(0x359)](_0x182a33(0x243)),!validInstallation?tgBot[_0x182a33(0x2bd)](_0x56e152['chat']['id'],_0x182a33(0x25c))['catch'](_0x5354ed=>{telegramError(_0x5354ed);}):(tgBot[_0x182a33(0x2bd)](_0x56e152[_0x182a33(0x280)]['id'],_0x182a33(0x202),{'reply_markup':{'inline_keyboard':[[{'text':_0x182a33(0x2a6),'callback_data':_0x182a33(0x1f9)},{'text':'No','callback_data':'no'}]]}})[_0x182a33(0x390)](_0x3bd767=>{telegramError(_0x3bd767);}),tgBot['on'](_0x182a33(0x243),async _0x4a4a73=>{const _0x3b69d2=_0x182a33,_0x22bc06=_0x4a4a73['data'],_0x288de6=_0x4a4a73[_0x3b69d2(0x2e6)];tgBot[_0x3b69d2(0x266)](_0x4a4a73['id'])[_0x3b69d2(0x387)](async()=>{const _0x173ca8=_0x3b69d2;_0x22bc06==_0x173ca8(0x1f9)&&(await tgBot['sendMessage'](_0x288de6[_0x173ca8(0x280)]['id'],_0x173ca8(0x2a3))[_0x173ca8(0x390)](_0x136381=>{telegramError(_0x136381);}),updateBB(_0x173ca8(0x313))),_0x22bc06=='no'&&await tgBot[_0x173ca8(0x2bd)](_0x288de6['chat']['id'],_0x173ca8(0x2c2))[_0x173ca8(0x390)](_0x20bf2a=>{telegramError(_0x20bf2a);});}),tgBot['removeListener'](_0x3b69d2(0x243));}));}),tgBot[_0x4a0ae2(0x20d)](/\/toggle/,_0x299c35=>{const _0xe1c3f9=_0x4a0ae2;if(!validateTelegram(_0x299c35))return;tgBot['removeListener'](_0xe1c3f9(0x243));const _0x3531ff=getBotsWithMode();if(_0x3531ff[_0xe1c3f9(0x2ca)]==0x0)tgBot['sendMessage'](_0x299c35[_0xe1c3f9(0x280)]['id'],'No\x20bots\x20running\x20right\x20now')[_0xe1c3f9(0x390)](_0xaaa49f=>{telegramError(_0xaaa49f);});else{let _0x3cfded=[],_0xc7945=[];const _0x25ac05=0x2;let _0x1ce838=0x0;_0x3531ff[_0xe1c3f9(0x1f0)]((_0x12a3b7,_0x5cfe06)=>{const _0x56961a=_0xe1c3f9;if(_0x5cfe06%_0x25ac05==0x0)_0xc7945=[];_0xc7945['push']({'text':'Bot\x20'+_0x12a3b7[_0x56961a(0x269)]+'\x20('+_0x12a3b7[_0x56961a(0x2e0)]+')','callback_data':_0x12a3b7[_0x56961a(0x269)]}),_0x5cfe06%_0x25ac05==0x0&&(_0x3cfded[_0x1ce838]=_0xc7945,_0x1ce838++);}),tgBot['sendMessage'](_0x299c35['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x3cfded}})[_0xe1c3f9(0x390)](_0x1fb47e=>{telegramError(_0x1fb47e);}),tgBot['on']('callback_query',async _0x35ecb5=>{const _0x209a9e=_0xe1c3f9,_0x51dc78=_0x35ecb5['data'],_0xbf83c7=_0x35ecb5['message'];tgBot[_0x209a9e(0x266)](_0x35ecb5['id'])[_0x209a9e(0x387)](async()=>{const _0x1105b3=_0x209a9e,_0x43cbce=_0x3531ff[_0x1105b3(0x2c1)](_0x311346=>_0x311346[_0x1105b3(0x269)]==_0x51dc78),_0x3b7496=_0x43cbce[_0x1105b3(0x2e0)]==_0x1105b3(0x2ef)?_0x1105b3(0x369):'auto';tgBot['sendMessage'](_0xbf83c7[_0x1105b3(0x280)]['id'],_0x1105b3(0x328)+_0x51dc78+_0x1105b3(0x36e)+_0x3b7496+'\x20mode')[_0x1105b3(0x390)](_0x1061de=>{telegramError(_0x1061de);}),toggleBotMode(_0x51dc78);}),tgBot[_0x209a9e(0x359)](_0x209a9e(0x243));});}}),tgBot['onText'](/\/names/,_0x5a50e0=>{const _0x321b92=_0x4a0ae2;if(!validateTelegram(_0x5a50e0))return;let _0x5ce80f='';config['forEach'](_0x46460a=>{const _0x3f40e1=_0x15b6;_0x5ce80f+=_0x3f40e1(0x2df)+_0x46460a[_0x3f40e1(0x269)]+':\x20'+_0x46460a[_0x3f40e1(0x2de)]+'\x0a';}),tgBot['sendMessage'](_0x5a50e0[_0x321b92(0x280)]['id'],_0x5ce80f,{'parse_mode':_0x321b92(0x2f0)})['catch'](_0x1ec21d=>{telegramError(_0x1ec21d);});}),tgBot[_0x4a0ae2(0x20d)](/\/disable/,_0x3b8095=>{const _0x375509=_0x4a0ae2;if(!validateTelegram(_0x3b8095))return;tgBot[_0x375509(0x2bd)](_0x3b8095[_0x375509(0x280)]['id'],_0x375509(0x333))[_0x375509(0x390)](_0x1ef9d1=>{telegramError(_0x1ef9d1);}),updateSetting(_0x375509(0x24a),![]);}),tgBot['onText'](/\/help/,_0x275326=>{const _0x4f8eb4=_0x4a0ae2;if(!validateTelegram(_0x275326))return;tgBot[_0x4f8eb4(0x2bd)](_0x275326['chat']['id'],_0x4f9beb)[_0x4f8eb4(0x390)](_0x37d0b3=>{telegramError(_0x37d0b3);});}),tgBot['on']('polling_error',_0x22512a=>{const _0x3836b9=_0x4a0ae2;_0x22512a[_0x3836b9(0x214)]()[_0x3836b9(0x37d)]('404\x20Not\x20Found')&&(logger[_0x3836b9(0x26f)]('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x3836b9(0x2c7)]('notification','Invalid\x20Telegram\x20token'));}),process[_0x4a0ae2(0x3bf)](_0x4a0ae2(0x32f),()=>{const _0x2173bc=_0x4a0ae2;if(tgBot)tgBot[_0x2173bc(0x2a2)]();process['exit'](0x1);}),process[_0x4a0ae2(0x3bf)]('SIGTERM',()=>{const _0x2e6a24=_0x4a0ae2;if(tgBot)tgBot[_0x2e6a24(0x2a2)]();process['exit'](0x1);});}}function disableTelegram(){const _0xb5cfce=_0x5d2ff7;tgBot&&(tgBot[_0xb5cfce(0x2a2)](),tgBot=null);}function sendTelegram(_0x3c9f77,_0x3e70b2){const _0x3310f9=_0x5d2ff7;if(settings[_0x3310f9(0x24a)]){if(settings['telegramEvents']==_0x3310f9(0x305)||(_0x3e70b2[_0x3310f9(0x37a)]==_0x3310f9(0x21a)||_0x3e70b2[_0x3310f9(0x37a)]=='warning'||_0x3e70b2[_0x3310f9(0x37a)]=='success')&&settings[_0x3310f9(0x376)]=='alerts'||_0x3e70b2[_0x3310f9(0x37a)]==_0x3310f9(0x1f2)&&settings[_0x3310f9(0x376)]==_0x3310f9(0x209)){if(tgBot&&settings[_0x3310f9(0x2eb)]){if(_0x3e70b2['showname'])tgBot['sendMessage'](settings['telegramChatId'],_0x3e70b2[_0x3310f9(0x2de)]+_0x3310f9(0x318)+_0x3e70b2['event'])['catch'](_0x309dc4=>{telegramError(_0x309dc4);});else tgBot['sendMessage'](settings[_0x3310f9(0x2eb)],'Bot\x20'+_0x3c9f77+_0x3310f9(0x318)+_0x3e70b2[_0x3310f9(0x2cc)])[_0x3310f9(0x390)](_0x48593e=>{telegramError(_0x48593e);});}}}}async function sendTelegramMsg(_0x3be1e0,_0x92aa9c=_0x5d2ff7(0x2f0)){const _0x413860=_0x5d2ff7;return settings[_0x413860(0x24a)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings['telegramChatId'],_0x3be1e0,{'parse_mode':_0x92aa9c})['catch'](_0x5125bc=>{telegramError(_0x5125bc);}),!![]):![];}function getDeviceWithIp(_0x1d82de){const _0x2c42b4=_0x5d2ff7;return devices[_0x2c42b4(0x2c1)](_0xef5cd9=>_0xef5cd9['ip']===_0x1d82de);}function temporaryAccess2FA(_0x5ba25f,_0x45cecb){const _0x55e7f0=_0x5d2ff7;let _0x20cb9f=new Date(),_0x2fce6c=![];if(lastIpApproval){if(_0x20cb9f-lastIpApproval<0x1388)_0x2fce6c=!![];}lastIpApproval=new Date();if(_0x2fce6c)return;tgBot&&settings[_0x55e7f0(0x2eb)]&&(tgBot[_0x55e7f0(0x359)](_0x55e7f0(0x243)),tgBot[_0x55e7f0(0x2bd)](settings[_0x55e7f0(0x2eb)],_0x55e7f0(0x2b1)+normalizeIP(_0x45cecb)['show']+_0x55e7f0(0x31d),{'parse_mode':_0x55e7f0(0x2f0),'reply_markup':{'inline_keyboard':[[{'text':_0x55e7f0(0x2d5),'callback_data':'5'},{'text':_0x55e7f0(0x1ee),'callback_data':'15'},{'text':_0x55e7f0(0x3a5),'callback_data':'30'},{'text':_0x55e7f0(0x314),'callback_data':_0x55e7f0(0x314)}]]}})[_0x55e7f0(0x390)](_0x3de1d9=>{telegramError(_0x3de1d9);}),tgBot['on'](_0x55e7f0(0x243),async _0x1713ce=>{const _0x14add7=_0x55e7f0,_0x573078=_0x1713ce[_0x14add7(0x239)],_0x4f02f0=_0x1713ce['message'];tgBot[_0x14add7(0x266)](_0x1713ce['id'])[_0x14add7(0x387)](async()=>{const _0x29a785=_0x14add7;devices[_0x5ba25f][_0x29a785(0x2ff)]={'clientip':_0x45cecb,'timestamp':new Date()[_0x29a785(0x28b)](),'expiry':_0x573078},_0x573078!=_0x29a785(0x314)?(await tgBot['sendMessage'](_0x4f02f0[_0x29a785(0x280)]['id'],_0x29a785(0x263)+_0x573078+_0x29a785(0x2ad),{'parse_mode':_0x29a785(0x2f0)})['catch'](_0x509d8f=>{telegramError(_0x509d8f);}),io['to'](_0x5ba25f)[_0x29a785(0x2c7)](_0x29a785(0x396),{'access':{'allow':![],'reason':_0x29a785(0x210),'token':null}})):(await tgBot[_0x29a785(0x2bd)](_0x4f02f0[_0x29a785(0x280)]['id'],_0x29a785(0x21c))[_0x29a785(0x390)](_0x3dcf8c=>{telegramError(_0x3dcf8c);}),io['to'](_0x5ba25f)[_0x29a785(0x2c7)](_0x29a785(0x396),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x14add7(0x359)](_0x14add7(0x243));}));}function loginAccess2FA(_0xc25c58,_0x4c39f1){const _0x1d786c=_0x5d2ff7;tgBot&&settings['telegramChatId']&&(tgBot[_0x1d786c(0x359)](_0x1d786c(0x243)),tgBot['sendMessage'](settings[_0x1d786c(0x2eb)],_0x1d786c(0x207)+normalizeIP(_0x4c39f1)[_0x1d786c(0x23f)]+_0x1d786c(0x31d),{'parse_mode':_0x1d786c(0x2f0),'reply_markup':{'inline_keyboard':[[{'text':_0x1d786c(0x2e5),'callback_data':loginExpiry},{'text':_0x1d786c(0x314),'callback_data':'reject'}]]}})[_0x1d786c(0x390)](_0x5b1946=>{telegramError(_0x5b1946);}),tgBot['on'](_0x1d786c(0x243),async _0x4fefb1=>{const _0x588c18=_0x1d786c,_0x38c373=_0x4fefb1['data'],_0x3b6b60=_0x4fefb1[_0x588c18(0x2e6)];tgBot[_0x588c18(0x266)](_0x4fefb1['id'])[_0x588c18(0x387)](async()=>{const _0x569a44=_0x588c18;devices[_0xc25c58]['telegram2FaApproval']={'clientip':_0x4c39f1,'timestamp':new Date()['getTime'](),'expiry':_0x38c373},_0x38c373!=_0x569a44(0x314)?(await tgBot[_0x569a44(0x2bd)](_0x3b6b60[_0x569a44(0x280)]['id'],'Login\x20accepted',{'parse_mode':_0x569a44(0x2f0)})['catch'](_0x4b602a=>{telegramError(_0x4b602a);}),io['to'](_0xc25c58)['emit'](_0x569a44(0x396),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x569a44(0x2bd)](_0x3b6b60['chat']['id'],_0x569a44(0x352))['catch'](_0x524b37=>{telegramError(_0x524b37);}),io['to'](_0xc25c58)[_0x569a44(0x2c7)](_0x569a44(0x396),{'access':{'allow':![],'reason':_0x569a44(0x33d),'token':null}}));}),tgBot[_0x588c18(0x359)](_0x588c18(0x243));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x226c3f=_0x5d2ff7;return dbConfig['get']('bots')[_0x226c3f(0x24c)](_0x226c3f(0x269))[_0x226c3f(0x247)]({'status':_0x226c3f(0x26e)})[_0x226c3f(0x261)]()||[];}function getDisabledBots(){const _0x1f5ca6=_0x5d2ff7;return dbConfig[_0x1f5ca6(0x312)](_0x1f5ca6(0x39f))['sortBy'](_0x1f5ca6(0x269))['filter']({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x312d96){const _0x16a8e7=_0x5d2ff7;let _0x3313d0={};const _0x4426f6=configpath+_0x16a8e7(0x31c)+_0x312d96+_0x16a8e7(0x2a4),_0x9fd7a2=fs[_0x16a8e7(0x2ec)](_0x4426f6);if(_0x9fd7a2){const _0x123d3d=fs[_0x16a8e7(0x255)](_0x4426f6);try{const _0x38bac9=JSON[_0x16a8e7(0x336)](_0x123d3d),_0x2f9910=_0x38bac9?_0x38bac9[_0x16a8e7(0x3b9)][0x0]['headless']:![];_0x3313d0[_0x16a8e7(0x2e0)]=_0x2f9910?_0x16a8e7(0x2ef):_0x16a8e7(0x369),_0x3313d0[_0x16a8e7(0x2de)]=_0x38bac9?_0x38bac9[_0x16a8e7(0x3b9)][0x0][_0x16a8e7(0x2de)]:_0x16a8e7(0x2df)+_0x312d96;}catch(_0x2e6dba){_0x3313d0[_0x16a8e7(0x2e0)]=_0x16a8e7(0x369),_0x3313d0[_0x16a8e7(0x2de)]='Bot\x20'+_0x312d96;}}else _0x3313d0['mode']=_0x16a8e7(0x369),_0x3313d0['botname']='Bot\x20'+_0x312d96;return _0x3313d0;}function getBotsWithMode(){const _0x3918f3=_0x5d2ff7,_0x5355d1=dbConfig[_0x3918f3(0x312)](_0x3918f3(0x39f))[_0x3918f3(0x24c)]('botID')['value']()||[];return _0x5355d1[_0x3918f3(0x1f0)](_0x3a1af1=>{const _0x4524a6=_0x3918f3;let _0x274d35=getBotAttributes(_0x3a1af1['botID']);_0x3a1af1[_0x4524a6(0x2e0)]=_0x274d35[_0x4524a6(0x2e0)];}),_0x5355d1;}function getBotExchanges(){const _0xb950fd=_0x5d2ff7;let _0x4bf1e4=[];const _0x2107b2=dbConfig[_0xb950fd(0x312)]('bots')['sortBy'](_0xb950fd(0x269))['value']()||[];_0x2107b2[_0xb950fd(0x1f0)](_0x4389c2=>{const _0x3e69be=_0xb950fd;if(_0x4389c2[_0x3e69be(0x396)]==_0x3e69be(0x26e)){const _0x592c91=configpath+_0x3e69be(0x31c)+_0x4389c2[_0x3e69be(0x269)]+'-config.json',_0x1280b4=fs[_0x3e69be(0x2ec)](_0x592c91);let _0x16a66e;if(_0x1280b4){const _0x3ca0ff=fs['readFileSync'](_0x592c91);try{const _0x465f9f=JSON[_0x3e69be(0x336)](_0x3ca0ff);_0x16a66e=_0x465f9f?_0x465f9f[_0x3e69be(0x3b9)][0x0][_0x3e69be(0x33f)]:null;}catch(_0x574eeb){}}if(_0x16a66e)_0x4bf1e4[_0x3e69be(0x29c)](_0x16a66e);}});const _0x33943c=[...new Set(_0x4bf1e4)][_0xb950fd(0x254)]();return _0x33943c;}async function initUser(){const _0x161be=_0x5d2ff7;if(!settings['userid']){const _0x3d4d42=uuidRandom();mixpanel[_0x161be(0x3b8)](_0x3d4d42),updateSetting(_0x161be(0x2ed),_0x3d4d42);}}async function initSecure(){const _0x540930=_0x5d2ff7;let _0x29d0b6=getSecure();if(!_0x29d0b6[_0x540930(0x23d)](_0x540930(0x25f))){let _0x4627c6=await generateKeys();_0x29d0b6[_0x540930(0x273)]=_0x4627c6[_0x540930(0x273)],_0x29d0b6[_0x540930(0x2d4)]=_0x4627c6[_0x540930(0x2d4)],_0x29d0b6[_0x540930(0x25f)]=crypto['randomBytes'](0x20)[_0x540930(0x214)](_0x540930(0x3a2));;storeSecure(_0x29d0b6);}}function getSettings(){return dbSettings['get']('settings')['value']()||{};}function getSecure(){const _0x3d57b9=_0x5d2ff7;return dbSecure[_0x3d57b9(0x312)](_0x3d57b9(0x353))[_0x3d57b9(0x261)]()||{};}function getBlacklist(){const _0x414198=_0x5d2ff7;return dbSecure['get'](_0x414198(0x35c))[_0x414198(0x261)]()||[];}function broadcastToBots(_0xa8dd8b,_0x145118){const _0x575674=_0x5d2ff7;config[_0x575674(0x1f0)](_0x216cfd=>{const _0x166d10=_0x575674;if(_0x216cfd[_0x166d10(0x396)]==_0x166d10(0x26e)&&_0x216cfd[_0x166d10(0x2aa)]==_0x166d10(0x298)||_0x216cfd[_0x166d10(0x396)]==_0x166d10(0x388)&&_0x216cfd['live']==_0x166d10(0x298)){if(pid[_0x216cfd[_0x166d10(0x269)]])pid[_0x216cfd[_0x166d10(0x269)]][_0x166d10(0x2f6)]({[_0xa8dd8b]:_0x145118});}});}function storeSettings(_0x45299f,_0x273551=![]){const _0x3c3fec=_0x5d2ff7;_0x45299f={...settings,..._0x45299f};if(_0x273551&&_0x45299f[_0x3c3fec(0x21f)]!=_0x3c3fec(0x30e)&&_0x45299f['bbPassword']!=_0x3c3fec(0x24d)&&_0x45299f[_0x3c3fec(0x21f)]!=''){const _0x22f5fb=crypt[_0x3c3fec(0x244)](secure[_0x3c3fec(0x2d4)],_0x45299f[_0x3c3fec(0x21f)])[_0x3c3fec(0x2e6)][_0x3c3fec(0x1dd)]('@')[0x0],_0x40edac=bcrypt[_0x3c3fec(0x370)](_0x22f5fb,saltRounds);_0x45299f={..._0x45299f,'bbPassword':_0x40edac};}if(_0x273551&&_0x45299f[_0x3c3fec(0x323)]!=_0x3c3fec(0x30e)&&_0x45299f[_0x3c3fec(0x323)]!=_0x3c3fec(0x24d)&&_0x45299f[_0x3c3fec(0x323)]!=''){const _0x2b4fab=crypt[_0x3c3fec(0x244)](secure[_0x3c3fec(0x2d4)],_0x45299f[_0x3c3fec(0x323)])[_0x3c3fec(0x2e6)][_0x3c3fec(0x1dd)]('@')[0x0];_0x45299f={..._0x45299f,'telegramToken':_0x2b4fab};}const _0x55bfee=_0x45299f[_0x3c3fec(0x323)]!=_0x3c3fec(0x30e)&&_0x45299f[_0x3c3fec(0x323)]!=settings[_0x3c3fec(0x323)]||_0x45299f[_0x3c3fec(0x34f)]!=settings[_0x3c3fec(0x34f)],_0x18ae8b=_0x45299f[_0x3c3fec(0x323)]==''||_0x45299f['telegramUsername']=='';if(_0x55bfee)_0x45299f[_0x3c3fec(0x376)]='all';for(const [_0x53c138,_0xbd0f12]of Object['entries'](_0x45299f)){if(_0x53c138==_0x3c3fec(0x323)&&_0xbd0f12==_0x3c3fec(0x30e)){_0x45299f[_0x3c3fec(0x323)]=settings[_0x3c3fec(0x323)];continue;};if(_0x53c138==_0x3c3fec(0x21f)&&_0xbd0f12==_0x3c3fec(0x30e)){_0x45299f[_0x3c3fec(0x21f)]=settings['bbPassword'];continue;};dbSettings[_0x3c3fec(0x306)]('settings.'+_0x53c138,_0xbd0f12)[_0x3c3fec(0x31a)]();}settings=_0x45299f,io['to'](_0x3c3fec(0x2ee))[_0x3c3fec(0x2c7)](_0x3c3fec(0x1f5),cleanSettings()),broadcastToBots(_0x3c3fec(0x20b),settings[_0x3c3fec(0x20b)]),broadcastToBots(_0x3c3fec(0x222),settings[_0x3c3fec(0x222)]);if(_0x55bfee&&!_0x18ae8b)initTelegram();if(_0x55bfee&&_0x18ae8b)disableTelegram();getAllClients()['forEach'](_0x2e85ee=>{const _0x39a6b1=_0x3c3fec;getSocket(_0x2e85ee['id'])['emit'](_0x39a6b1(0x396),{'access':{'allow':![],'reason':_0x39a6b1(0x210),'token':null}});});}function updateSetting(_0x347f2b,_0x545a7f){const _0x893815=_0x5d2ff7;dbSettings[_0x893815(0x306)](_0x893815(0x317)+_0x347f2b,_0x545a7f)[_0x893815(0x31a)](),settings=getSettings(),io['to'](_0x893815(0x2ee))[_0x893815(0x2c7)](_0x893815(0x1f5),cleanSettings());}function storeSecure(_0x369775){const _0x5618f1=_0x5d2ff7;dbSecure['get'](_0x5618f1(0x353))['push'](_0x369775)[_0x5618f1(0x31a)](),secure=_0x369775;}function addBlacklist(_0x35410a){const _0x19b8af=_0x5d2ff7;cleanBlacklist();let _0x376e84;devices[_0x35410a][_0x19b8af(0x2ff)]?_0x376e84=Math[_0x19b8af(0x259)](devices[_0x35410a][_0x19b8af(0x2ff)][_0x19b8af(0x321)],loginExpiry):_0x376e84=loginExpiry,dbSecure['get'](_0x19b8af(0x35c))['push']({'expiry':new Date()[_0x19b8af(0x28b)]()+_0x376e84*0x3c*0x3e8,'token':devices[_0x35410a][_0x19b8af(0x3be)][_0x19b8af(0x2e4)]})[_0x19b8af(0x31a)](),blacklist=dbSecure[_0x19b8af(0x312)](_0x19b8af(0x35c))[_0x19b8af(0x261)]();}function cleanBlacklist(){const _0x317311=_0x5d2ff7;let _0x24433d=dbSecure[_0x317311(0x312)](_0x317311(0x35c))['cloneDeep']()[_0x317311(0x261)](),_0x33b4b2=new Date()[_0x317311(0x28b)]();_0x24433d[_0x317311(0x1f0)](_0x34bc9b=>{const _0x2c99eb=_0x317311;_0x34bc9b[_0x2c99eb(0x321)]<_0x33b4b2&&dbSecure['get'](_0x2c99eb(0x35c))[_0x2c99eb(0x24f)]({'expiry':_0x34bc9b[_0x2c99eb(0x321)]})[_0x2c99eb(0x31a)]();});}function initStates(){const _0x1114b0=_0x5d2ff7;let _0x20f27b=getConfiguration();_0x20f27b[_0x1114b0(0x1f0)](_0x553cff=>{const _0xbe8fc5=_0x1114b0;_0x553cff[_0xbe8fc5(0x2aa)]=_0xbe8fc5(0x293);}),storeConfiguration(_0x20f27b);}function onKeys(){const _0x4743bb=new RSA();return new Promise(_0x52e4c8=>{const _0x2eda09=_0x15b6;_0x4743bb[_0x2eda09(0x20f)]()[_0x2eda09(0x387)](_0xf3f97a=>{_0x52e4c8(_0xf3f97a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1e2f71=_0x5d2ff7;let _0x5f086d=getSettings(),_0x5c8651=![];!_0x5f086d[_0x1e2f71(0x23d)]('lastmsgtelegram')&&(_0x5f086d['lastmsgtelegram']=0x0,_0x5c8651=!![]);!_0x5f086d['hasOwnProperty'](_0x1e2f71(0x2ea))&&(_0x5f086d[_0x1e2f71(0x2ea)]=0x0,_0x5c8651=!![]);!_0x5f086d[_0x1e2f71(0x23d)]('latestversion')&&(_0x5f086d[_0x1e2f71(0x358)]=_0x1e2f71(0x257),_0x5c8651=!![]);!_0x5f086d[_0x1e2f71(0x23d)](_0x1e2f71(0x222))&&(_0x5f086d['onepagemode']=![],_0x5c8651=!![]);if(_0x5c8651)storeSettings(_0x5f086d);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x1e2f71(0x1f0)](_0x1f7b44=>{const _0x4f0f18=_0x1e2f71;if(!_0x1f7b44['isDirectory']()){if(!_0x1f7b44[_0x4f0f18(0x384)]['startsWith'](_0x4f0f18(0x1e1)))fs['unlinkSync'](configbackuppath+_0x1f7b44[_0x4f0f18(0x384)]);}else fs[_0x4f0f18(0x24e)](configbackuppath+_0x1f7b44[_0x4f0f18(0x384)],{'recursive':!![]});});}catch(_0xead627){logger[_0x1e2f71(0x242)](_0x1e2f71(0x29a),_0xead627);}}function storeConfiguration(_0xc34235){const _0x5c79ef=_0x5d2ff7;dbConfig['get'](_0x5c79ef(0x39f))[_0x5c79ef(0x24f)]()[_0x5c79ef(0x31a)](),_0xc34235[_0x5c79ef(0x1f0)](_0x31771d=>{const _0x31ec81=_0x5c79ef;delete _0x31771d[_0x31ec81(0x2e0)];}),dbConfig['get']('bots')[_0x5c79ef(0x29c)](..._0xc34235)[_0x5c79ef(0x31a)](),config=_0xc34235;}function resetPassword(){const _0x32548b=_0x5d2ff7;tgBot&&settings[_0x32548b(0x2eb)]&&(tgBot[_0x32548b(0x359)](_0x32548b(0x243)),tgBot[_0x32548b(0x2bd)](settings['telegramChatId'],_0x32548b(0x35f),{'parse_mode':_0x32548b(0x2f0),'reply_markup':{'inline_keyboard':[[{'text':_0x32548b(0x1f9),'callback_data':_0x32548b(0x1f9)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x4ba776=>{telegramError(_0x4ba776);}),tgBot['on'](_0x32548b(0x243),async _0x1f6f43=>{const _0x57655f=_0x32548b,_0x5a57e5=_0x1f6f43[_0x57655f(0x239)],_0x828601=_0x1f6f43[_0x57655f(0x2e6)];tgBot[_0x57655f(0x266)](_0x1f6f43['id'])[_0x57655f(0x387)](async()=>{const _0x319b58=_0x57655f;if(_0x5a57e5!='no'){const _0x3e58f5=0xf,_0xfaf6b6='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x5c4316=Array[_0x319b58(0x28d)](crypto['randomFillSync'](new Uint32Array(_0x3e58f5)))[_0x319b58(0x29b)](_0x31978f=>_0xfaf6b6[_0x31978f%_0xfaf6b6[_0x319b58(0x2ca)]])[_0x319b58(0x246)](''),_0x71cdbd=bcrypt[_0x319b58(0x370)](_0x5c4316,saltRounds);storeSettings({'bbPassword':_0x71cdbd}),await tgBot[_0x319b58(0x2bd)](_0x828601[_0x319b58(0x280)]['id'],_0x319b58(0x380)+_0x5c4316,{'parse_mode':_0x319b58(0x2f0)})[_0x319b58(0x390)](_0x14fccc=>{telegramError(_0x14fccc);});}else await tgBot[_0x319b58(0x2bd)](_0x828601[_0x319b58(0x280)]['id'],_0x319b58(0x392))[_0x319b58(0x390)](_0x1314de=>{telegramError(_0x1314de);});}),tgBot['removeListener'](_0x57655f(0x243));}));}async function confirmRestore(_0x32f33e,_0x3d4d8c){const _0x3c1b53=_0x5d2ff7;io['to'](_0x3c1b53(0x2ee))[_0x3c1b53(0x2c7)](_0x3c1b53(0x1fa),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x3c1b53(0x3bc)),tgBot&&settings[_0x3c1b53(0x2eb)]&&(tgBot[_0x3c1b53(0x359)](_0x3c1b53(0x243)),await tgBot['sendMessage'](settings[_0x3c1b53(0x2eb)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3c1b53(0x1f9),'callback_data':_0x3c1b53(0x1f9)},{'text':'no','callback_data':'no'}]]}})[_0x3c1b53(0x390)](_0x3605d4=>{telegramError(_0x3605d4);}),tgBot['on'](_0x3c1b53(0x243),async _0x319432=>{const _0x27bf20=_0x3c1b53,_0x262d9f=_0x319432[_0x27bf20(0x239)],_0x1a4cc3=_0x319432[_0x27bf20(0x2e6)];tgBot[_0x27bf20(0x266)](_0x319432['id'])['then'](async()=>{const _0x59f8fd=_0x27bf20;_0x262d9f=='yes'?(await tgBot['sendMessage'](_0x1a4cc3[_0x59f8fd(0x280)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x59f8fd(0x2f0)})['catch'](_0x1f1268=>{telegramError(_0x1f1268);}),unzipFile(_0x32f33e,_0x3d4d8c)):(logger[_0x59f8fd(0x242)](_0x59f8fd(0x379)),await tgBot[_0x59f8fd(0x2bd)](_0x1a4cc3[_0x59f8fd(0x280)]['id'],_0x59f8fd(0x379))['catch'](_0x599e20=>{telegramError(_0x599e20);}));}),tgBot[_0x27bf20(0x359)](_0x27bf20(0x243));}));}function getServerTime(){const _0x473ea9=_0x5d2ff7,_0x36b0ed=new Date();return _0x36b0ed[_0x473ea9(0x2bc)]()+'/'+(_0x36b0ed[_0x473ea9(0x377)]()+0x1)[_0x473ea9(0x214)]()['padStart'](0x2,'0')+'/'+_0x36b0ed[_0x473ea9(0x2f8)]()[_0x473ea9(0x214)]()[_0x473ea9(0x265)](0x2,'0')+'\x20'+_0x36b0ed[_0x473ea9(0x1d8)]()[_0x473ea9(0x214)]()[_0x473ea9(0x265)](0x2,'0')+':'+_0x36b0ed[_0x473ea9(0x292)]()[_0x473ea9(0x214)]()[_0x473ea9(0x265)](0x2,'0')+':'+_0x36b0ed[_0x473ea9(0x295)]()[_0x473ea9(0x214)]()[_0x473ea9(0x265)](0x2,'0');}function getTimeStamp(){const _0x2b5f83=_0x5d2ff7,_0x2ca397=shiftedTime();return _0x2ca397[_0x2b5f83(0x2bc)]()+'/'+(_0x2ca397[_0x2b5f83(0x377)]()+0x1)[_0x2b5f83(0x214)]()['padStart'](0x2,'0')+'/'+_0x2ca397[_0x2b5f83(0x2f8)]()[_0x2b5f83(0x214)]()[_0x2b5f83(0x265)](0x2,'0')+'\x20'+_0x2ca397[_0x2b5f83(0x1d8)]()['toString']()[_0x2b5f83(0x265)](0x2,'0')+':'+_0x2ca397[_0x2b5f83(0x292)]()[_0x2b5f83(0x214)]()['padStart'](0x2,'0')+':'+_0x2ca397[_0x2b5f83(0x295)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x36dfa1=_0x5d2ff7,_0x2c9391=shiftedTime();return _0x2c9391[_0x36dfa1(0x2bc)]()+(_0x2c9391[_0x36dfa1(0x377)]()+0x1)['toString']()[_0x36dfa1(0x265)](0x2,'0')+_0x2c9391[_0x36dfa1(0x2f8)]()[_0x36dfa1(0x214)]()[_0x36dfa1(0x265)](0x2,'0')+'-'+_0x2c9391['getHours']()['toString']()[_0x36dfa1(0x265)](0x2,'0')+_0x2c9391[_0x36dfa1(0x292)]()[_0x36dfa1(0x214)]()[_0x36dfa1(0x265)](0x2,'0')+_0x2c9391[_0x36dfa1(0x295)]()[_0x36dfa1(0x214)]()[_0x36dfa1(0x265)](0x2,'0');}function shiftedTime(){const _0x5ed3bc=_0x5d2ff7,_0x3721ee=new Date();let _0x28b1df=_0x3721ee;if(settings[_0x5ed3bc(0x20b)]&&settings['timeshift']!==0x0)_0x28b1df=fns[_0x5ed3bc(0x347)](_0x3721ee,{'hours':settings[_0x5ed3bc(0x20b)]});return _0x28b1df;}function startScheduler(){const _0x5c8153=_0x5d2ff7,_0x478197=new Date()[_0x5c8153(0x357)](),_0x46b75d=shiftedTime()[_0x5c8153(0x1d8)]();_0x46b75d==0x4&&backupConfigFiles();_0x46b75d==0x0&&rotateLogFiles();_0x478197%0x6==0x0&&triggerAnalytics();_0x478197%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4845b0){const _0x21ee9c=_0x5d2ff7;logger[_0x21ee9c(0x242)](_0x21ee9c(0x35a)+_0x4845b0);const _0x51a449=getBotsWithMode();_0x51a449[_0x21ee9c(0x2ca)]>0x0?confirmRestore(configbackuppath,_0x4845b0):unzipFile(configbackuppath,_0x4845b0);}async function getBackupFiles(_0x4753b7=null){const _0x25733d=_0x5d2ff7;let _0x469e2d=[],_0x3993e9=fs[_0x25733d(0x348)](configbackuppath,{'withFileTypes':!![]});_0x3993e9[_0x25733d(0x254)]((_0x307486,_0x107c3a)=>_0x307486[_0x25733d(0x384)]<_0x107c3a[_0x25733d(0x384)]?0x1:_0x107c3a[_0x25733d(0x384)]<_0x307486['name']?-0x1:0x0),_0x3993e9[_0x25733d(0x1f0)](_0x8fbb58=>{const _0x3c03d3=_0x25733d;if(!_0x8fbb58[_0x3c03d3(0x2e8)]()&&_0x8fbb58['name'][_0x3c03d3(0x2c9)](_0x3c03d3(0x1e1))&&_0x8fbb58[_0x3c03d3(0x384)][_0x3c03d3(0x28f)]('.zip')){const _0x1e83d2=formatDate(fs[_0x3c03d3(0x3a4)](configbackuppath+_0x8fbb58[_0x3c03d3(0x384)])[_0x3c03d3(0x29d)]);_0x469e2d[_0x3c03d3(0x29c)]({'name':_0x8fbb58['name'],'mtime':_0x1e83d2});}});if(_0x4753b7)io['to'](_0x4753b7)[_0x25733d(0x2c7)](_0x25733d(0x228),_0x469e2d);else return _0x469e2d;}async function backupConfigFiles(){const _0x5379f3=_0x5d2ff7;await zipFiles('backup-full');const _0x2b9750=getCleanTimeStamp();fs[_0x5379f3(0x230)](zippath+_0x5379f3(0x2e2),configbackuppath+(_0x5379f3(0x1e1)+_0x2b9750+_0x5379f3(0x1ec)));let _0x539f48=fs[_0x5379f3(0x348)](configbackuppath,{'withFileTypes':!![]});_0x539f48['sort']((_0x906098,_0x569132)=>_0x906098['name']<_0x569132[_0x5379f3(0x384)]?0x1:_0x569132['name']<_0x906098[_0x5379f3(0x384)]?-0x1:0x0),_0x539f48[_0x5379f3(0x2ca)]>maxBackups&&fs[_0x5379f3(0x203)](configbackuppath+_0x539f48[_0x539f48[_0x5379f3(0x2ca)]-0x1]['name']);}function rotateLogFiles(){const _0x1787dd=_0x5d2ff7,_0x436752=fs[_0x1787dd(0x3a4)](logspath+_0x1787dd(0x213)),_0x20abe1=_0x436752[_0x1787dd(0x2f1)]/0x400;if(_0x20abe1>0x64){let _0xc89fd1=fs[_0x1787dd(0x348)](logspath,{'withFileTypes':!![]});_0xc89fd1[_0x1787dd(0x254)]((_0x459940,_0x28c3b6)=>_0x459940[_0x1787dd(0x384)]<_0x28c3b6[_0x1787dd(0x384)]?0x1:_0x28c3b6[_0x1787dd(0x384)]<_0x459940[_0x1787dd(0x384)]?-0x1:0x0),_0xc89fd1[_0x1787dd(0x1f0)](_0x39787d=>{const _0x4c2113=_0x1787dd;if(_0x39787d[_0x4c2113(0x384)]==_0x4c2113(0x307))fs[_0x4c2113(0x230)](logspath+_0x39787d[_0x4c2113(0x384)],logspath+_0x4c2113(0x2c4));if(_0x39787d[_0x4c2113(0x384)]==_0x4c2113(0x395))fs['copyFileSync'](logspath+_0x39787d[_0x4c2113(0x384)],logspath+_0x4c2113(0x307));_0x39787d[_0x4c2113(0x384)]==_0x4c2113(0x213)&&(fs[_0x4c2113(0x230)](logspath+_0x39787d[_0x4c2113(0x384)],logspath+_0x4c2113(0x395)),fs[_0x4c2113(0x260)](logspath+_0x39787d[_0x4c2113(0x384)],''));});}}async function zipFiles(_0x45f103){const _0x5be25b=_0x5d2ff7;let _0x3a3099;if(_0x45f103==_0x5be25b(0x33b))_0x3a3099=logspath;if(_0x45f103=='backup')_0x3a3099=configpath;if(_0x45f103==_0x5be25b(0x26b))_0x3a3099=configpath;let _0x1e993c=fs[_0x5be25b(0x348)](_0x3a3099,{'withFileTypes':!![]});const _0x5a9ba4=new require('node-zip')();_0x1e993c[_0x5be25b(0x1f0)](_0x3da70e=>{const _0x157540=_0x5be25b;if(!_0x3da70e['isDirectory']()){let _0x1e0da7=fs[_0x157540(0x255)](_0x3a3099+_0x3da70e[_0x157540(0x384)]);if(_0x45f103=='backup'){const _0x18f226=/^bot-[0-9]{3}-config.json$/,_0x32f279=_0x18f226[_0x157540(0x237)](_0x3da70e[_0x157540(0x384)]);if(_0x32f279){const _0x56b599=JSON[_0x157540(0x336)](_0x1e0da7);if(_0x56b599[_0x157540(0x3b9)][0x0]){_0x56b599['bot'][0x0][_0x157540(0x215)]='***',_0x56b599[_0x157540(0x3b9)][0x0][_0x157540(0x300)]=_0x157540(0x24d);if(_0x56b599[_0x157540(0x3b9)][0x0]['apiPassword'])_0x56b599[_0x157540(0x3b9)][0x0]['apiPassword']='***';}_0x1e0da7=JSON[_0x157540(0x1d9)](_0x56b599,null,0x2);}if(_0x3da70e[_0x157540(0x384)]==_0x157540(0x2d2)){const _0x3966fb=JSON['parse'](_0x1e0da7);if(_0x3966fb['settings'][_0x157540(0x287)])_0x3966fb[_0x157540(0x1f5)][_0x157540(0x287)]=![];if(_0x3966fb[_0x157540(0x1f5)]['bbPassword'])_0x3966fb[_0x157540(0x1f5)][_0x157540(0x21f)]=_0x157540(0x24d);if(_0x3966fb['settings'][_0x157540(0x323)])_0x3966fb[_0x157540(0x1f5)][_0x157540(0x323)]=_0x157540(0x24d);if(_0x3966fb[_0x157540(0x1f5)][_0x157540(0x2eb)])_0x3966fb['settings'][_0x157540(0x2eb)]=null;_0x1e0da7=JSON['stringify'](_0x3966fb,null,0x2);}if(_0x3da70e[_0x157540(0x384)]!=_0x157540(0x2e9))_0x5a9ba4[_0x157540(0x3a3)](_0x3da70e[_0x157540(0x384)],_0x1e0da7);}else _0x5a9ba4['file'](_0x3da70e[_0x157540(0x384)],_0x1e0da7);}});const _0x1a94ac=_0x5a9ba4[_0x5be25b(0x39e)]({'base64':![],'compression':'DEFLATE'});fs[_0x5be25b(0x260)](zippath+(_0x45f103+_0x5be25b(0x1ec)),_0x1a94ac,'binary');}async function unzipFile(_0x4e3880,_0x5049bc){const _0x3260c7=_0x5d2ff7;fs[_0x3260c7(0x348)](configpath,{'withFileTypes':!![]})[_0x3260c7(0x1f0)](_0x181f33=>{const _0x3836ba=_0x3260c7;if(!_0x181f33[_0x3836ba(0x2e8)]())fs['rmSync'](configpath+_0x181f33[_0x3836ba(0x384)]);});const _0x2713a0=fs[_0x3260c7(0x255)](_0x4e3880+_0x5049bc,_0x3260c7(0x232)),_0x3534fe=new require(_0x3260c7(0x360))(_0x2713a0,{'base64':![],'checkCRC32':!![]});Object[_0x3260c7(0x34a)](_0x3534fe['files'])[_0x3260c7(0x1f0)](_0x37ec41=>{const _0x28553c=_0x3260c7,_0xf82604=_0x3534fe['files'][_0x37ec41];fs[_0x28553c(0x260)](configpath+_0xf82604['name'],_0xf82604[_0x28553c(0x31f)]);}),fs[_0x3260c7(0x348)](temppath,{'withFileTypes':!![]})[_0x3260c7(0x1f0)](_0x4bb2a9=>{const _0x1ccaa7=_0x3260c7;if(!_0x4bb2a9[_0x1ccaa7(0x2e8)]())fs[_0x1ccaa7(0x24e)](temppath+_0x4bb2a9[_0x1ccaa7(0x384)]);}),logger[_0x3260c7(0x242)](_0x3260c7(0x36b)),process[_0x3260c7(0x2f6)]({'restore':!![]},_0x3adffb=>{});}async function getPublicIp(){const _0x414a2f=_0x5d2ff7;try{const _0x2b84e7=await axios['get']('https://api.ipify.org?format=json');publicip=_0x2b84e7[_0x414a2f(0x239)]['ip'];}catch(_0x234aa9){}}async function triggerAnalytics(){const _0x15cf33=_0x5d2ff7;if(!publicip)await getPublicIp();const _0x534082=getBotsWithMode();let _0x3e8cc0=0x0;_0x534082[_0x15cf33(0x1f0)](_0x2d5797=>{const _0x5236c7=_0x15cf33;if(_0x2d5797[_0x5236c7(0x396)]===_0x5236c7(0x26e))_0x3e8cc0++;});const _0x3a7730=getBotExchanges();mixpanel['track'](_0x15cf33(0x258),{'distinct_id':settings[_0x15cf33(0x2ed)],'ip':publicip,'version':serverversion,'numbots':_0x534082[_0x15cf33(0x2ca)],'numbotsenabled':_0x3e8cc0,'exchanges':_0x3a7730});}async function getMessages(){const _0x1260fd=_0x5d2ff7,_0x23ca80=_0x1260fd(0x364),_0xc0234f=new GraphQLClient(_0x23ca80),_0x34990f={'authorization':_0x1260fd(0x22a)},_0x1950bf=serverversion[_0x1260fd(0x1dd)]('.'),_0x529c92=_0x1950bf[0x0]+'.'+_0x1950bf[0x1],_0x9c4465=Math['min'](settings[_0x1260fd(0x345)],settings[_0x1260fd(0x2ea)]),_0x42db00={'last':parseInt(_0x9c4465),'bbm':_0x529c92},_0x110286=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x59f637;try{_0x59f637=await _0xc0234f['request'](_0x110286,_0x42db00,_0x34990f);}catch(_0x2867c8){}if(_0x59f637&&_0x59f637[_0x1260fd(0x350)]){let _0x2c5559=settings['lastmsgtelegram'];newMessages=[];for(const _0x4777d5 of _0x59f637['messages']){newMessages[_0x1260fd(0x29c)](_0x4777d5);if(_0x4777d5[_0x1260fd(0x397)])updateSetting(_0x1260fd(0x358),_0x4777d5['bbvNew']);let _0x59b72f=_0x4777d5[_0x1260fd(0x397)]?serverversion>=_0x4777d5['bbvNew']:![];if(!_0x59b72f&&_0x4777d5[_0x1260fd(0x310)]>_0x2c5559){if(_0x4777d5[_0x1260fd(0x342)]===_0x1260fd(0x375)||serverversion['startsWith'](_0x4777d5[_0x1260fd(0x342)])){let _0xfcd590=''+_0x4777d5[_0x1260fd(0x36f)]+'\x0a\x0a'+_0x4777d5[_0x1260fd(0x2e6)];const _0x157773=await sendTelegramMsg(toTelegramMarkdown(_0xfcd590),_0x1260fd(0x22f));if(_0x157773)_0x2c5559=_0x4777d5[_0x1260fd(0x310)];}}}updateAvailable=isNewerVersion(settings[_0x1260fd(0x358)],serverversion),updateSetting('lastmsgtelegram',_0x2c5559),emitMessages();}}function emitMessages(){const _0x574e0c=_0x5d2ff7,_0x1f4b20=settings[_0x574e0c(0x2ea)];let _0x14a93b=[];newMessages['forEach'](_0x49c9f0=>{const _0x46bf08=_0x574e0c;_0x49c9f0[_0x46bf08(0x310)]>_0x1f4b20&&_0x14a93b['push'](_0x49c9f0);}),_0x14a93b[_0x574e0c(0x2ca)]>0x0&&getAllClients()[_0x574e0c(0x1f0)](_0x4af9e6=>{const _0x351768=_0x574e0c;getSocket(_0x4af9e6['id'])[_0x351768(0x2c7)](_0x351768(0x2e6),_0x14a93b);});}function confirmMessage(_0x236595){const _0x412a62=_0x5d2ff7;updateSetting(_0x412a62(0x2ea),Number(_0x236595));}function isNewerVersion(_0x55d02f,_0x4bd1eb){const _0x1250e1=_0x5d2ff7,_0x59de6b=_0x4bd1eb[_0x1250e1(0x1dd)]('.'),_0xf1a846=_0x55d02f[_0x1250e1(0x1dd)]('.');for(var _0x358cf6=0x0;_0x358cf6<_0xf1a846[_0x1250e1(0x2ca)];_0x358cf6++){const _0x264c22=~~_0xf1a846[_0x358cf6],_0xa1874d=~~_0x59de6b[_0x358cf6];if(_0x264c22>_0xa1874d)return!![];if(_0x264c22<_0xa1874d)return![];}return![];}function toTelegramMarkdown(_0x338f51){const _0x55e4c6=_0x5d2ff7,_0x4f77cb=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2f4f00=/\*{2}(.+?)\*{2}/gim;return _0x338f51=_0x338f51[_0x55e4c6(0x2fd)](_0x4f77cb,'$1_$2_$3')[_0x55e4c6(0x2fd)](_0x2f4f00,_0x55e4c6(0x38d)),_0x338f51;}async function validateConfigFile(){const _0x5939f7=_0x5d2ff7,_0x1114b3=dbConfig['get']('bots')[_0x5939f7(0x24c)](_0x5939f7(0x269))[_0x5939f7(0x261)]()||[];if(_0x1114b3[_0x5939f7(0x2ca)]==0x0){let _0x230caa=0x0,_0x38a7a8=[];const _0x290907=/^bot-([0-9]{3})-config.json$/,_0x22ffc6=fs[_0x5939f7(0x348)](configpath);_0x22ffc6['forEach'](_0x4113f9=>{const _0xb98433=_0x5939f7,_0x190f18=_0x290907[_0xb98433(0x35e)](_0x4113f9);if(_0x190f18){const _0x1a549f=_0x190f18[0x1];let _0x1401d6=getBotAttributes(_0x1a549f);_0x38a7a8[_0xb98433(0x29c)]({'botID':_0x1a549f,'botname':_0x1401d6[_0xb98433(0x2de)],'status':'disabled','live':_0xb98433(0x293)}),_0x230caa++;}}),_0x230caa!=0x0&&(dbConfig['get'](_0x5939f7(0x39f))[_0x5939f7(0x226)](_0x38a7a8)[_0x5939f7(0x31a)](),config=_0x38a7a8,restoredConfigFile=_0x230caa);}}async function restoreConfigNotify(_0x1f6d27){const _0x329be2=_0x5d2ff7;let _0x1824e8;if(restoredConfigFile==0x1)_0x1824e8=_0x329be2(0x267);else _0x1824e8=_0x329be2(0x2f2);if(_0x1f6d27)io['to'](_0x329be2(0x2ee))[_0x329be2(0x2c7)](_0x329be2(0x1fa),_0x1824e8);else{logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](_0x1824e8),logger[_0x329be2(0x39a)](_0x329be2(0x251)),logger[_0x329be2(0x39a)]('');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x329be2(0x209))tgBot['sendMessage'](settings[_0x329be2(0x2eb)],_0x329be2(0x1fe)+_0x1824e8)['catch'](_0x40acfe=>{telegramError(_0x40acfe);});}}function validateCredentials(_0x1cb7e5,_0x22d265){const _0x2f4767=_0x5d2ff7;if(_0x1cb7e5[_0x2f4767(0x363)]==settings[_0x2f4767(0x2fc)]&&bcrypt[_0x2f4767(0x2f5)](_0x1cb7e5[_0x2f4767(0x389)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x2f4767(0x21b),'token':null};else{const _0x521023=generateLoginToken(_0x22d265);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x521023};}}else return{'allow':![],'reason':_0x2f4767(0x1f7),'token':null};}function refreshToken(_0x1c8ee8){const _0x124445=_0x5d2ff7,_0x4eb127=generateLoginToken(_0x1c8ee8);return{'allow':!![],'reason':_0x124445(0x27c),'token':_0x4eb127};}function validateAccess(_0x45f1d6,_0x1c8895,_0x2d1eba){const _0x5504b8=_0x5d2ff7,_0x756c97=_0x2d1eba?_0x2d1eba:devices[_0x1c8895]['ip'];let _0x3239c9;const _0x5edae4=_0x3bc119=>{const _0x528424=_0x15b6;if(settings[_0x528424(0x287)]){if(settings[_0x528424(0x2ac)]){if(telegram2FaApproved(_0x1c8895)){const _0x1bfb35=generateLoginToken(_0x1c8895);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1bfb35};}else return{'allow':![],'reason':_0x528424(0x20a),'token':null};}else return _0x3239c9=validToken(_0x3bc119,_0x1c8895),_0x3239c9[_0x528424(0x23d)](_0x528424(0x3bc))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3bc119}:{'allow':![],'reason':_0x528424(0x20a),'token':null};}else return{'allow':!![],'reason':_0x528424(0x36d),'token':null};};if(settings['whitelistEnabled']){let _0x53a476=[...settings[_0x5504b8(0x3ae)],_0x5504b8(0x2a1),_0x5504b8(0x28c),_0x5504b8(0x324)];if(_0x53a476['includes'](_0x756c97))return _0x5edae4(_0x45f1d6);else{_0x3239c9=validToken(_0x45f1d6,_0x1c8895);if(_0x3239c9[_0x5504b8(0x23d)](_0x5504b8(0x3bc)))return _0x5edae4(_0x45f1d6);else{if(telegramIpApproved(_0x1c8895)){const _0x532578=generateToken(_0x1c8895);return _0x3239c9=_0x5edae4(_0x45f1d6),_0x3239c9[_0x5504b8(0x1e0)]?{'allow':!![],'reason':_0x5504b8(0x22b),'token':_0x532578}:_0x3239c9;}else return settings[_0x5504b8(0x285)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5edae4(_0x45f1d6);}function timelyDecrypt(_0x1962a5,_0x33d7ba=!![]){const _0x227bec=_0x5d2ff7;if(_0x1962a5)try{const _0x3ba173=crypt[_0x227bec(0x244)](secure[_0x227bec(0x2d4)],_0x1962a5)[_0x227bec(0x2e6)],_0x51614f=_0x3ba173[_0x227bec(0x1dd)]('@')[0x0],_0x5efa94=_0x3ba173['split']('@')[0x1],_0x334085=new Date()[_0x227bec(0x28b)]();if(_0x33d7ba){if(_0x334085-_0x5efa94<maxSecretAge*0x3e8)return _0x51614f;else return![];}else return _0x51614f;}catch(_0x34b26a){return![];}else return![];}const validToken=(_0x5fddb7,_0xdf1a5f)=>{const _0x15ab43=_0x5d2ff7,_0x565e7b=devices[_0xdf1a5f]['ip'];if(!_0x5fddb7)return{'error':_0x15ab43(0x1fb)};for(let _0x1bd119 of blacklist){if(_0x1bd119[_0x15ab43(0x2e4)]==_0x5fddb7)return{'error':_0x15ab43(0x2f3)};}let _0x575005;try{_0x575005=jwt[_0x15ab43(0x32c)](_0x5fddb7,secure[_0x15ab43(0x25f)]+_0xdf1a5f);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x27e))&&!_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x363))||!_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x315)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x363))&&_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x27e))){const {clientip:_0x470f9e}=_0x575005;return _0x565e7b==_0x470f9e?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x363))&&_0x575005[_0x15ab43(0x23d)](_0x15ab43(0x27e))){const {username:_0x39a255,clientip:_0x4fea73}=_0x575005;return settings['bbUsername']==_0x39a255&&_0x565e7b==_0x4fea73?{'success':_0x15ab43(0x25e)}:{'error':_0x15ab43(0x3ac)};}}},generateLoginToken=_0x380017=>{const _0x948bea=_0x5d2ff7;if(_0x380017){const _0x43e037=devices[_0x380017]['ip'];return jwt[_0x948bea(0x2d7)]({'username':settings[_0x948bea(0x2fc)],'clientip':_0x43e037},secure[_0x948bea(0x25f)]+_0x380017,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x45e5d6=>{const _0x364190=_0x5d2ff7;if(_0x45e5d6){const _0x4361c3=devices[_0x45e5d6]['ip'];return jwt[_0x364190(0x2d7)]({'clientip':_0x4361c3},secure[_0x364190(0x25f)]+_0x45e5d6,{'expiresIn':devices[_0x45e5d6][_0x364190(0x2ff)][_0x364190(0x321)]*0x3c});}else return![];},telegramIpApproved=_0x5e367e=>{const _0x32a552=_0x5d2ff7;let _0x30537c=![];return devices[_0x5e367e]['telegramIpApproval']&&devices[_0x5e367e][_0x32a552(0x2ff)]['expiry']!=_0x32a552(0x314)&&(_0x30537c=devices[_0x5e367e]['telegramIpApproval'][_0x32a552(0x27e)]==devices[_0x5e367e]['ip']&&new Date()[_0x32a552(0x28b)]()-devices[_0x5e367e][_0x32a552(0x2ff)][_0x32a552(0x297)]<devices[_0x5e367e][_0x32a552(0x2ff)]['expiry']*0x3c*0x3e8),_0x30537c;},telegram2FaApproved=_0x1c1538=>{const _0xd18f33=_0x5d2ff7;let _0x48c1ce=![];return devices[_0x1c1538]['telegram2FaApproval']&&devices[_0x1c1538][_0xd18f33(0x219)]['expiry']!=_0xd18f33(0x314)&&(_0x48c1ce=devices[_0x1c1538][_0xd18f33(0x219)]['clientip']==devices[_0x1c1538]['ip']&&new Date()[_0xd18f33(0x28b)]()-devices[_0x1c1538][_0xd18f33(0x219)][_0xd18f33(0x297)]<devices[_0x1c1538]['telegram2FaApproval'][_0xd18f33(0x321)]*0x3c*0x3e8),_0x48c1ce;},normalizeIP=_0x59c6d2=>{const _0x63d3da=_0x5d2ff7;let _0x5793fc=null,_0x11ddc1=null;if(ipaddr[_0x63d3da(0x1d6)](_0x59c6d2)){const _0x294c2a=ipaddr[_0x63d3da(0x336)](_0x59c6d2);_0x294c2a[_0x63d3da(0x2da)]()==='ipv6'?(_0x294c2a[_0x63d3da(0x311)]()&&(_0x5793fc=_0x294c2a['toIPv4Address']()[_0x63d3da(0x214)]()),_0x11ddc1=_0x294c2a[_0x63d3da(0x214)]()):(_0x5793fc=_0x294c2a[_0x63d3da(0x214)](),_0x11ddc1=_0x294c2a[_0x63d3da(0x28e)]()[_0x63d3da(0x214)]());}return{'show':_0x5793fc?_0x5793fc:_0x11ddc1,'store':_0x11ddc1};};function formatDate(_0x18cb59){const _0x156429=_0x5d2ff7;return _0x18cb59[_0x156429(0x2bc)]()+'/'+(_0x18cb59[_0x156429(0x377)]()+0x1)[_0x156429(0x214)]()[_0x156429(0x265)](0x2,'0')+'/'+_0x18cb59['getDate']()[_0x156429(0x214)]()[_0x156429(0x265)](0x2,'0')+'\x20'+_0x18cb59[_0x156429(0x1d8)]()[_0x156429(0x214)]()[_0x156429(0x265)](0x2,'0')+':'+_0x18cb59[_0x156429(0x292)]()[_0x156429(0x214)]()[_0x156429(0x265)](0x2,'0')+':'+_0x18cb59['getSeconds']()['toString']()[_0x156429(0x265)](0x2,'0');}function sleep(_0xa4080){return new Promise(_0x481665=>setTimeout(_0x481665,_0xa4080));}