const _0x369d1e=_0x10c0;(function(_0x1f99f6,_0x1c1a53){const _0x3110f3=_0x10c0,_0x4cb8cd=_0x1f99f6();while(!![]){try{const _0x651890=parseInt(_0x3110f3(0x2a5))/0x1+-parseInt(_0x3110f3(0x195))/0x2*(parseInt(_0x3110f3(0x199))/0x3)+parseInt(_0x3110f3(0x2ef))/0x4+parseInt(_0x3110f3(0x264))/0x5*(-parseInt(_0x3110f3(0x27f))/0x6)+-parseInt(_0x3110f3(0x1c3))/0x7+parseInt(_0x3110f3(0x228))/0x8*(parseInt(_0x3110f3(0x1ef))/0x9)+-parseInt(_0x3110f3(0x1d5))/0xa*(-parseInt(_0x3110f3(0x1e8))/0xb);if(_0x651890===_0x1c1a53)break;else _0x4cb8cd['push'](_0x4cb8cd['shift']());}catch(_0x54964e){_0x4cb8cd['push'](_0x4cb8cd['shift']());}}}(_0x214c,0x9d696));const _0x507ea6=function(){let _0x433cd6=!![];return function(_0x55ce23,_0x38a8d7){const _0x37e1f4=_0x433cd6?function(){const _0x318a8b=_0x10c0;if(_0x38a8d7){const _0x5ea746=_0x38a8d7[_0x318a8b(0x244)](_0x55ce23,arguments);return _0x38a8d7=null,_0x5ea746;}}:function(){};return _0x433cd6=![],_0x37e1f4;};}(),_0x5e825c=_0x507ea6(this,function(){const _0x55ccdb=_0x10c0;return _0x5e825c[_0x55ccdb(0x2c7)]()['search'](_0x55ccdb(0x319))[_0x55ccdb(0x2c7)]()[_0x55ccdb(0x2ab)](_0x5e825c)[_0x55ccdb(0x216)](_0x55ccdb(0x319));});_0x5e825c();'use strict';process[_0x369d1e(0x2ae)][_0x369d1e(0x1eb)]=0x1;const childProcess=require(_0x369d1e(0x255)),fs=require('fs'),fns=require(_0x369d1e(0x237)),low=require(_0x369d1e(0x25b)),FileSync=require(_0x369d1e(0x20e)),path=require(_0x369d1e(0x2ac)),crypto=require(_0x369d1e(0x1ed)),Crypt=require(_0x369d1e(0x234))['Crypt'],RSA=require(_0x369d1e(0x234))[_0x369d1e(0x22a)],bcrypt=require(_0x369d1e(0x2a8)),jwt=require(_0x369d1e(0x1b0)),ipaddr=require(_0x369d1e(0x306)),argv=require(_0x369d1e(0x2ec))(process[_0x369d1e(0x1b4)][_0x369d1e(0x2c4)](0x2))['argv'],uuidRandom=require(_0x369d1e(0x1f4)),TelegramBot=require(_0x369d1e(0x214)),Mixpanel=require(_0x369d1e(0x2e1)),axios=require(_0x369d1e(0x1a3)),{GraphQLClient,gql}=require(_0x369d1e(0x18c)),util=require(_0x369d1e(0x1c4)),fileUpload=require('express-fileupload'),PORT=argv['port']||_0x369d1e(0x190),pattern=/^[0-9]{2,4}$/;!pattern[_0x369d1e(0x1c2)](PORT)&&(console[_0x369d1e(0x204)](_0x369d1e(0x2fc)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x369d1e(0x2d8)](0x1));const HOST=argv[_0x369d1e(0x277)]||null,userID=argv[_0x369d1e(0x1f7)]||'';let bbpath=_0x369d1e(0x220),bbpath2='';const botfile=_0x369d1e(0x287),configfile=_0x369d1e(0x2df),settingsfile=_0x369d1e(0x286),securefile=_0x369d1e(0x2a1);let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x369d1e(0x317)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x369d1e(0x24c),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x369d1e(0x1b1)+userID+'/':bbpath+_0x369d1e(0x1b1),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x369d1e(0x2f9),loggerfile=fs[_0x369d1e(0x26e)](logspath+_0x369d1e(0x2b7),{'flags':'a'}),temppath=userID?bbpath+_0x369d1e(0x24f)+userID+'/':bbpath+'temp/';!fs[_0x369d1e(0x205)](configpath)&&fs[_0x369d1e(0x254)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x369d1e(0x254)](configbackuppath);!fs[_0x369d1e(0x205)](logspath)&&fs[_0x369d1e(0x254)](logspath);!fs[_0x369d1e(0x205)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x369d1e(0x205)](temppath)&&fs[_0x369d1e(0x254)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x369d1e(0x2c0)]({'bots':[]})[_0x369d1e(0x312)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x369d1e(0x2c0)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x369d1e(0x2d1)}})[_0x369d1e(0x312)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x369d1e(0x2c0)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x369d1e(0x29e),'rsaStandard':_0x369d1e(0x231)});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x369d1e(0x20c)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x369d1e(0x27d)]!=''&&settings[_0x369d1e(0x295)]&&settings[_0x369d1e(0x295)]!='')initTelegram();const logger={'screen':_0x131562=>{const _0x380bc7=_0x369d1e;console[_0x380bc7(0x204)](_0x131562);},'simple':_0x2f3ed5=>{const _0x33130c=_0x369d1e;console[_0x33130c(0x204)](_0x2f3ed5),loggerfile['write'](util[_0x33130c(0x2aa)](_0x2f3ed5)+'\x0a');},'full':async _0x5f59ec=>{const _0x141c24=_0x369d1e,_0x288424=getTimeStamp()+_0x141c24(0x256)+_0x5f59ec;console[_0x141c24(0x204)](_0x288424),loggerfile['write'](util['format'](_0x288424)+'\x0a');if(tgBot&&settings[_0x141c24(0x18d)]&&settings[_0x141c24(0x2a4)]!=_0x141c24(0x18a))await tgBot[_0x141c24(0x248)](settings[_0x141c24(0x18d)],'Bot\x20Mgr\x20>\x20'+_0x5f59ec)['catch'](_0x10694d=>{telegramError(_0x10694d);});}};process['on'](_0x369d1e(0x272),function(_0x40a6d3){const _0x46294d=_0x369d1e;logger[_0x46294d(0x1ec)](_0x40a6d3);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x369d1e(0x32a))[_0x369d1e(0x1a9)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x10c0(_0x110a39,_0xd02c72){const _0x11dc16=_0x214c();return _0x10c0=function(_0x5e825c,_0x507ea6){_0x5e825c=_0x5e825c-0x18a;let _0x214cf5=_0x11dc16[_0x5e825c];return _0x214cf5;},_0x10c0(_0x110a39,_0xd02c72);}const express=require('express'),app=express(),http=require('http')[_0x369d1e(0x2f0)](app);app[_0x369d1e(0x284)](fileUpload({'useTempFiles':!![]})),app['get'](_0x369d1e(0x278),async(_0x47384a,_0x35ed0b)=>{const _0x398165=_0x369d1e,_0x565d6d=_0x47384a[_0x398165(0x23b)][_0x398165(0x1e1)],_0x5132ec=getClientsWithBotID(_0x398165(0x19f)),_0x46931d=_0x47384a[_0x398165(0x2c5)][_0x398165(0x1d6)],_0x47b15b=timelyDecrypt(_0x46931d,![]),_0x1158fa=_0x5132ec['find'](_0x5cd065=>_0x5cd065[_0x398165(0x1d6)]==_0x47b15b);if(_0x1158fa){const _0x3fa063=normalizeIP(_0x47384a[_0x398165(0x2b0)][_0x398165(0x1d0)])[_0x398165(0x2db)],_0x10a9c0=_0x47384a[_0x398165(0x2c5)][_0x398165(0x19b)];if(validateAccess(_0x10a9c0,_0x47b15b,_0x3fa063)['allow'])await zipFiles(_0x565d6d),_0x35ed0b[_0x398165(0x2ce)](zippath+(_0x565d6d+_0x398165(0x320)),_0x3c8708=>{const _0x5d3229=_0x398165;_0x3c8708&&(logger[_0x5d3229(0x1e2)]('Failed\x20to\x20download\x20'+_0x565d6d),logger[_0x5d3229(0x1ec)](_0x3c8708));});else logger['full'](_0x398165(0x32b)+_0x565d6d+_0x398165(0x296));}else logger[_0x398165(0x1e2)](_0x398165(0x32b)+_0x565d6d+_0x398165(0x21c));}),app['post']('/upload-backup',async(_0x209e5f,_0x2cca07)=>{const _0x34b11b=_0x369d1e,_0x32a0c3=getClientsWithBotID(_0x34b11b(0x19f)),_0x40ebb6=_0x209e5f['headers'][_0x34b11b(0x1d6)],_0x258eed=timelyDecrypt(_0x40ebb6,![]),_0x74d2a2=_0x32a0c3[_0x34b11b(0x1ca)](_0x2f372d=>_0x2f372d[_0x34b11b(0x1d6)]==_0x258eed);if(_0x74d2a2){const _0x43bf1b=normalizeIP(_0x209e5f[_0x34b11b(0x2b0)]['remoteAddress'])[_0x34b11b(0x2db)],_0x11998d=_0x209e5f[_0x34b11b(0x2c5)][_0x34b11b(0x19b)];if(validateAccess(_0x11998d,_0x258eed,_0x43bf1b)['allow']){if(_0x209e5f[_0x34b11b(0x1e6)]){const _0x277037=_0x209e5f[_0x34b11b(0x1e6)][_0x34b11b(0x23a)];await _0x277037['mv'](temppath+_0x277037[_0x34b11b(0x2da)]),_0x2cca07['send']({'status':!![],'message':'File\x20uploaded'});const _0x2fdf69=getBotsWithMode();_0x2fdf69[_0x34b11b(0x1c5)]>0x0?confirmRestore(temppath,_0x277037[_0x34b11b(0x2da)]):unzipFile(temppath,_0x277037[_0x34b11b(0x2da)]);}}else logger['full'](_0x34b11b(0x1dc));}else logger[_0x34b11b(0x1e2)](_0x34b11b(0x266));}),app['use'](express[_0x369d1e(0x22f)](path['join'](__dirname,bbpath2,_0x369d1e(0x313)))),app[_0x369d1e(0x284)](express[_0x369d1e(0x22f)](path['join'](__dirname,bbpath2,_0x369d1e(0x22c)))),app[_0x369d1e(0x1c7)]('/',function(_0x2c3f3d,_0x208110){const _0x463504=_0x369d1e;_0x208110[_0x463504(0x23c)](path['join'](__dirname,bbpath2,'build2',_0x463504(0x1bb)));}),app[_0x369d1e(0x1c7)](_0x369d1e(0x2f6),function(_0x4d1e2e,_0x28bb7c){const _0xed95b3=_0x369d1e;_0x28bb7c[_0xed95b3(0x23c)](path['join'](__dirname,bbpath2,_0xed95b3(0x22c),_0xed95b3(0x1bb)));}),app[_0x369d1e(0x1c7)](_0x369d1e(0x323),(_0x58cd53,_0x11e4ed)=>{const _0x3c8f2c=_0x369d1e;_0x11e4ed[_0x3c8f2c(0x23c)](path['join'](__dirname,bbpath2,_0x3c8f2c(0x22c),_0x3c8f2c(0x1bb)));}),app[_0x369d1e(0x1c7)](_0x369d1e(0x26b),(_0x57ec27,_0xe34540)=>{const _0x4568b2=_0x369d1e;_0xe34540['sendFile'](path[_0x4568b2(0x308)](__dirname,bbpath2,_0x4568b2(0x22c),_0x4568b2(0x1bb)));}),app['get'](_0x369d1e(0x30d),(_0x506a15,_0x50117b)=>{const _0xbdb2fc=_0x369d1e;_0x50117b[_0xbdb2fc(0x23c)](path[_0xbdb2fc(0x308)](__dirname,bbpath2,_0xbdb2fc(0x22c),_0xbdb2fc(0x1bb)));}),app[_0x369d1e(0x1c7)](_0x369d1e(0x30c),(_0x5abd9f,_0xa46639)=>{const _0x3e1e99=_0x369d1e;_0xa46639[_0x3e1e99(0x23c)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x369d1e(0x1c7)](_0x369d1e(0x2fa),(_0x59084e,_0x16a9b3)=>{const _0x181559=_0x369d1e;_0x16a9b3[_0x181559(0x23c)](path[_0x181559(0x308)](__dirname,bbpath2,_0x181559(0x22c),'index.html'));}),app[_0x369d1e(0x1c7)](_0x369d1e(0x1ad),(_0x413ef9,_0x4af566)=>{const _0x3ee221=_0x369d1e;_0x4af566[_0x3ee221(0x23c)](path[_0x3ee221(0x308)](__dirname,bbpath2,_0x3ee221(0x22c),_0x3ee221(0x1bb)));});if(HOST)http[_0x369d1e(0x19a)](PORT,HOST);else http[_0x369d1e(0x19a)](PORT);const io=require(_0x369d1e(0x2a9))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x5972ec=_0x369d1e;logger['simple'](''),logger[_0x5972ec(0x1ec)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x5972ec(0x331)+PORT),logger['simple'](_0x5972ec(0x259));if(config[_0x5972ec(0x1c5)]!=0x0)for(const _0x3f7a66 of config){if(_0x3f7a66['status']==_0x5972ec(0x2e6)||_0x3f7a66['status']=='new')await logger[_0x5972ec(0x1e2)](_0x5972ec(0x31a)+_0x3f7a66[_0x5972ec(0x2d6)]+_0x5972ec(0x1d1)+_0x3f7a66[_0x5972ec(0x2e4)]),startBot([_0x3f7a66[_0x5972ec(0x2d6)],userID],{'cwd':bbpath},function(_0x4f0380){if(_0x4f0380)logger['full'](_0x4f0380);});else(_0x3f7a66[_0x5972ec(0x1f1)]==_0x5972ec(0x1c9)||_0x3f7a66[_0x5972ec(0x1f1)]==_0x5972ec(0x1a2))&&await logger[_0x5972ec(0x1e2)]('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x3f7a66[_0x5972ec(0x2d6)]+'\x20|\x20'+_0x3f7a66[_0x5972ec(0x2e4)]);}else!newBot&&logger['simple'](_0x5972ec(0x21d));if(newBot)addBot();logger[_0x5972ec(0x1ec)](_0x5972ec(0x259)),logger[_0x5972ec(0x1ec)]('');}function startSocket(){const _0x27104b=_0x369d1e;io['on'](_0x27104b(0x18b),_0x4d1679=>{const _0x24e885=_0x27104b;let _0x201cac,_0x308264,_0x1e38d7,_0x512893,_0x50eea7;const _0x4b41be=_0x4d1679[_0x24e885(0x2d2)][_0x24e885(0x2c5)][_0x24e885(0x2d4)];_0x308264=_0x4b41be[_0x24e885(0x27c)](/bot[0-9]{3}/);if(_0x308264)_0x1e38d7=_0x308264[0x0][_0x24e885(0x27c)](/[0-9]{3}/);if(_0x1e38d7)_0x201cac=_0x1e38d7[0x0];else _0x201cac=_0x24e885(0x19f);const _0x2a7db0=_0x4d1679[_0x24e885(0x2d2)][_0x24e885(0x1e9)][_0x24e885(0x271)];if(!_0x2a7db0)_0x4d1679[_0x24e885(0x19c)]('status',{'publicKey':secure[_0x24e885(0x28d)]});else{_0x512893=timelyDecrypt(_0x2a7db0,![]);if(!_0x512893)_0x4d1679[_0x24e885(0x19c)](_0x24e885(0x1f1),{'publicKey':secure['publicKey']});else{_0x50eea7=normalizeIP(_0x4d1679[_0x24e885(0x1fd)][_0x24e885(0x1d0)])[_0x24e885(0x2db)];if(!devices[_0x512893])devices[_0x512893]={'uuid':_0x512893,'access':{'token':null}};devices[_0x512893]['ip']=_0x50eea7;const _0x191b6b=addClient(_0x4d1679['id'],_0x512893,_0x201cac);setAccess(_0x191b6b),emitMessages(),_0x4d1679['on'](_0x24e885(0x1af),_0x32dd60=>{const _0x581579=_0x24e885,_0x5b1c49=timelyDecrypt(_0x32dd60[_0x581579(0x290)]);if(_0x5b1c49){_0x32dd60={'username':_0x32dd60[_0x581579(0x1ff)],'password':_0x5b1c49},devices[_0x512893]['access']=validateCredentials(_0x32dd60,_0x512893);if(devices[_0x512893]['access'][_0x581579(0x224)]==![]&&devices[_0x512893][_0x581579(0x324)][_0x581579(0x1e4)]=='2FA\x20login\x20required')_0x4d1679[_0x581579(0x19c)](_0x581579(0x1f1),{'access':devices[_0x512893][_0x581579(0x324)]}),loginAccess2FA(_0x512893,_0x50eea7);else{if(devices[_0x512893]['access']['allow']==![]&&devices[_0x512893]['access'][_0x581579(0x1e4)]==_0x581579(0x1bc))_0x4d1679['emit'](_0x581579(0x1f1),{'access':devices[_0x512893]['access']});else devices[_0x512893][_0x581579(0x324)][_0x581579(0x224)]&&devices[_0x512893][_0x581579(0x324)]['reason']==_0x581579(0x329)&&(getClientsWithUuid(_0x512893)[_0x581579(0x294)](_0x5836a5=>{setAccess(_0x5836a5);}),setTokenRefresh(_0x512893),setSessionTimeout(_0x581579(0x1af),_0x512893));}}else logger[_0x581579(0x1e2)](_0x581579(0x27e));}),_0x4d1679['on']('reset-password',()=>{resetPassword();}),_0x4d1679['on'](_0x24e885(0x2c3),_0x81005c=>{removeClient(_0x4d1679['id']);}),_0x201cac=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x556c00){if(_0x556c00!='botmanager'&&config['apiKey']!=''){if(pid[_0x556c00])pid[_0x556c00]['send']({'function':'initclient','args':null});}}function reloadBotManager(){const _0x45e07c=_0x369d1e;getClientsWithBotID(_0x45e07c(0x19f))[_0x45e07c(0x294)](_0x3403aa=>{const _0x1d52bb=_0x45e07c;getSocket(_0x3403aa['id'])['emit'](_0x1d52bb(0x1f1),{'access':{'allow':![],'reason':_0x1d52bb(0x238),'token':null}});});}function getSocket(_0x5ec535){const _0x1b3326=_0x369d1e;return io[_0x1b3326(0x283)][_0x1b3326(0x283)][_0x1b3326(0x1c7)](_0x5ec535);}function setAccess(_0x3c7d09){const _0x401fd4=_0x369d1e,_0x2c6a0a=getSocket(_0x3c7d09['id']),_0x3bb2d6=_0x3c7d09[_0x401fd4(0x1d6)],_0x2a3cc3=_0x3c7d09['bot'];devices[_0x3bb2d6][_0x401fd4(0x324)]=validateAccess(devices[_0x3bb2d6][_0x401fd4(0x324)][_0x401fd4(0x24e)],_0x3bb2d6),_0x2c6a0a[_0x401fd4(0x308)](_0x3bb2d6);if(devices[_0x3bb2d6]['access'][_0x401fd4(0x224)]){_0x2c6a0a[_0x401fd4(0x308)](_0x2a3cc3);if(_0x2a3cc3==_0x401fd4(0x19f))initializeSocketBotManager(_0x2c6a0a);else initializeSocketBot(_0x2c6a0a);initClient(_0x2a3cc3);}devices[_0x3bb2d6][_0x401fd4(0x324)]['token']&&devices[_0x3bb2d6][_0x401fd4(0x324)][_0x401fd4(0x1e4)]==_0x401fd4(0x25a)&&setSessionTimeout(_0x401fd4(0x1f2),_0x3bb2d6),devices[_0x3bb2d6][_0x401fd4(0x324)][_0x401fd4(0x24e)]&&devices[_0x3bb2d6][_0x401fd4(0x324)][_0x401fd4(0x1e4)]==_0x401fd4(0x2ed)&&setSessionTimeout(_0x401fd4(0x1af),_0x3bb2d6),_0x2c6a0a['emit'](_0x401fd4(0x1f1),{'status':_0x3c7d09[_0x401fd4(0x2cb)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3bb2d6]['access'],'externalip':devices[_0x3bb2d6]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x401fd4(0x311)],'validInstallation':validInstallation}),devices[_0x3bb2d6]['access'][_0x401fd4(0x224)]==![]&&devices[_0x3bb2d6][_0x401fd4(0x324)]['reason']==_0x401fd4(0x1e5)&&temporaryAccess2FA(_0x3bb2d6,devices[_0x3bb2d6]['ip']);}function setSessionTimeout(_0x4ac1d0,_0x45189b){const _0x29f2da=_0x369d1e;let _0x31750a;if(_0x4ac1d0==_0x29f2da(0x1af))_0x31750a=loginExpiry*0x3c*0x3e8;else _0x31750a=devices[_0x45189b][_0x29f2da(0x2e7)][_0x29f2da(0x289)]*0x3c*0x3e8-(new Date()[_0x29f2da(0x24a)]()-devices[_0x45189b][_0x29f2da(0x2e7)][_0x29f2da(0x2fd)]);if(devices[_0x45189b][_0x29f2da(0x335)])clearTimeout(devices[_0x45189b][_0x29f2da(0x335)]);devices[_0x45189b][_0x29f2da(0x335)]=setTimeout(()=>{const _0x5b7701=_0x29f2da;if(devices[_0x45189b][_0x5b7701(0x31b)])clearTimeout(devices[_0x45189b][_0x5b7701(0x31b)]);removeSocketListeners(_0x45189b),addBlacklist(_0x45189b),devices[_0x45189b][_0x5b7701(0x2e7)]=null,devices[_0x45189b][_0x5b7701(0x2b2)]=null,devices[_0x45189b][_0x5b7701(0x324)][_0x5b7701(0x24e)]=null,devices[_0x45189b][_0x5b7701(0x324)]=validateAccess(devices[_0x45189b][_0x5b7701(0x324)][_0x5b7701(0x24e)],_0x45189b),!(devices[_0x45189b][_0x5b7701(0x324)]['allow']&&devices[_0x45189b]['access']['reason']=='login\x20not\x20required')&&(_0x4ac1d0==_0x5b7701(0x1af)?io['to'](_0x45189b)['emit']('status',{'access':{'allow':![],'reason':_0x5b7701(0x2bb),'token':null}}):io['to'](_0x45189b)['emit'](_0x5b7701(0x1f1),{'access':{'allow':![],'reason':_0x5b7701(0x274),'token':null}})),devices[_0x45189b]['access'][_0x5b7701(0x24e)]=null;},_0x31750a);}function setTokenRefresh(_0x42ba3e){const _0x543b50=_0x369d1e;if(devices[_0x42ba3e][_0x543b50(0x31b)])clearTimeout(devices[_0x42ba3e][_0x543b50(0x31b)]);devices[_0x42ba3e][_0x543b50(0x31b)]=setTimeout(()=>{const _0x2bae9d=_0x543b50;getClientsWithUuid(_0x42ba3e)[_0x2bae9d(0x1c5)]!=0x0?(devices[_0x42ba3e][_0x2bae9d(0x324)]=refreshToken(_0x42ba3e),io['to'](_0x42ba3e)['emit'](_0x2bae9d(0x1f1),{'status':_0x2bae9d(0x210),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x42ba3e][_0x2bae9d(0x324)],'externalip':devices[_0x42ba3e]['ip'],'publicKey':secure[_0x2bae9d(0x28d)],'validInstallation':validInstallation}),setTokenRefresh(_0x42ba3e)):clearTimeout(devices[_0x42ba3e][_0x2bae9d(0x31b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x132001){const _0x35be07=_0x369d1e,_0x18f1ed=getClient(_0x132001['id'])[_0x35be07(0x1d6)];_0x132001[_0x35be07(0x19c)]('bots',config),_0x132001[_0x35be07(0x19c)](_0x35be07(0x276),cleanSettings()),_0x132001['on'](_0x35be07(0x27a),_0x45e1ac=>{const _0x520657=_0x35be07;if(validateAccess(_0x45e1ac,_0x18f1ed)[_0x520657(0x224)])addBot();else logger[_0x520657(0x1e2)](_0x520657(0x225));}),_0x132001['on'](_0x35be07(0x2b3),(_0x429cef,_0x255a27)=>{const _0x22f546=_0x35be07;if(validateAccess(_0x255a27,_0x18f1ed)[_0x22f546(0x224)])toggleBot(_0x429cef[_0x22f546(0x2d6)],_0x429cef[_0x22f546(0x1f1)],_0x429cef[_0x22f546(0x233)]);else logger[_0x22f546(0x1e2)](_0x22f546(0x309));}),_0x132001['on'](_0x35be07(0x297),(_0x971a9c,_0x25943e)=>{const _0x2d20bc=_0x35be07;if(validateAccess(_0x25943e,_0x18f1ed)[_0x2d20bc(0x224)])toggleBotMode(_0x971a9c);else logger[_0x2d20bc(0x1e2)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x132001['on']('delete-bot',(_0x49de31,_0x4216d1)=>{const _0x5ef4a8=_0x35be07;if(validateAccess(_0x4216d1,_0x18f1ed)['allow'])deleteBot(_0x49de31);else logger['full'](_0x5ef4a8(0x2f8));}),_0x132001['on']('store-settings',(_0x5b38d5,_0x3b6c62)=>{const _0xf071ff=_0x35be07;if(validateAccess(_0x3b6c62,_0x18f1ed)[_0xf071ff(0x224)])storeSettings(_0x5b38d5,!![]);else logger[_0xf071ff(0x1e2)](_0xf071ff(0x303));}),_0x132001['on'](_0x35be07(0x1d8),_0xada93e=>{const _0x194e46=_0x35be07;if(validateAccess(_0xada93e,_0x18f1ed)['allow'])updateBB();else logger[_0x194e46(0x1e2)](_0x194e46(0x19e));}),_0x132001['on'](_0x35be07(0x21f),_0x3b7c81=>{const _0x45a872=_0x35be07;if(validateAccess(_0x3b7c81,_0x18f1ed)[_0x45a872(0x224)])getMessages();else logger[_0x45a872(0x1e2)](_0x45a872(0x26d));}),_0x132001['on'](_0x35be07(0x2b6),(_0x198e6c,_0x1c2218)=>{const _0x1c7d40=_0x35be07;if(validateAccess(_0x1c2218,_0x18f1ed)[_0x1c7d40(0x224)])confirmMessage(_0x198e6c);else logger[_0x1c7d40(0x1e2)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x132001['on']('logout',_0x15cf7a=>{const _0x3e9d3d=_0x35be07;if(validateAccess(_0x15cf7a,_0x18f1ed)[_0x3e9d3d(0x224)]){if(devices[_0x18f1ed]['pidRefreshToken'])clearTimeout(devices[_0x18f1ed][_0x3e9d3d(0x31b)]);if(devices[_0x18f1ed][_0x3e9d3d(0x335)])clearTimeout(devices[_0x18f1ed]['pidExpireLogin']);removeSocketListeners(getClient(_0x132001['id'])[_0x3e9d3d(0x1d6)]),addBlacklist(_0x18f1ed),devices[_0x18f1ed][_0x3e9d3d(0x2e7)]=null,devices[_0x18f1ed]['telegram2FaApproval']=null,devices[_0x18f1ed][_0x3e9d3d(0x324)][_0x3e9d3d(0x24e)]=null,io['to'](getClient(_0x132001['id'])['uuid'])['emit'](_0x3e9d3d(0x1f1),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3e9d3d(0x1e2)](_0x3e9d3d(0x2b5));});}function initializeSocketBot(_0x153319){const _0xbdd17e=_0x369d1e,_0x25d0d9=getClient(_0x153319['id'])[_0xbdd17e(0x246)],_0x860395=getClient(_0x153319['id'])['uuid'];_0x153319['on']('get-logs',(_0x3aead2,_0x404db1)=>{const _0x255ae0=_0xbdd17e;if(validateAccess(_0x404db1,_0x860395)['allow']){if(pid[_0x25d0d9])pid[_0x25d0d9]['send']({'function':_0x255ae0(0x2be),'args':_0x3aead2});}else logger[_0x255ae0(0x1e2)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x153319['on'](_0xbdd17e(0x267),(_0x2f433b,_0x5659cd)=>{const _0x3a107c=_0xbdd17e;if(validateAccess(_0x5659cd,_0x860395)['allow']){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x3a107c(0x24d)]({'function':_0x3a107c(0x326),'args':_0x2f433b});}else logger['full'](_0x3a107c(0x261));}),_0x153319['on'](_0xbdd17e(0x31f),(_0x1e0927,_0x523167)=>{const _0x580421=_0xbdd17e;if(validateAccess(_0x523167,_0x860395)[_0x580421(0x224)]){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x580421(0x24d)]({'function':'getPortfolio','args':_0x1e0927});}else logger[_0x580421(0x1e2)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x153319['on']('store-configuration',(_0x3c45ba,_0x317fb5)=>{const _0x32fc2e=_0xbdd17e;if(validateAccess(_0x317fb5,_0x860395)[_0x32fc2e(0x224)]){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x32fc2e(0x24d)]({'function':_0x32fc2e(0x196),'args':_0x3c45ba});}else logger[_0x32fc2e(0x1e2)](_0x32fc2e(0x2a0));}),_0x153319['on'](_0xbdd17e(0x1fe),(_0x2e4162,_0x32316d)=>{const _0x528f6a=_0xbdd17e;if(validateAccess(_0x32316d,_0x860395)[_0x528f6a(0x224)]){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x528f6a(0x24d)]({'function':_0x528f6a(0x1a1),'args':_0x2e4162});}else logger[_0x528f6a(0x1e2)](_0x528f6a(0x226));}),_0x153319['on'](_0xbdd17e(0x265),_0xd593fb=>{const _0x2ee97d=_0xbdd17e;if(validateAccess(_0xd593fb,_0x860395)[_0x2ee97d(0x224)]){if(pid[_0x25d0d9])pid[_0x25d0d9]['send']({'function':_0x2ee97d(0x1de),'args':null});}else logger[_0x2ee97d(0x1e2)](_0x2ee97d(0x201));}),_0x153319['on'](_0xbdd17e(0x269),(_0x2cfd14,_0x1fc9d8)=>{const _0x371fb3=_0xbdd17e;if(validateAccess(_0x1fc9d8,_0x860395)[_0x371fb3(0x224)]){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x371fb3(0x24d)]({'function':_0x371fb3(0x25f),'args':_0x2cfd14});}else logger[_0x371fb3(0x1e2)](_0x371fb3(0x1fb));}),_0x153319['on'](_0xbdd17e(0x1a7),_0xbcab1c=>{const _0x4fbd7e=_0xbdd17e;if(validateAccess(_0xbcab1c,_0x860395)[_0x4fbd7e(0x224)]){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x4fbd7e(0x24d)]({'function':_0x4fbd7e(0x24b),'args':null});}else logger[_0x4fbd7e(0x1e2)](_0x4fbd7e(0x282));}),_0x153319['on']('show-config',_0x270ab2=>{const _0x236c62=_0xbdd17e;if(validateAccess(_0x270ab2,_0x860395)['allow']){if(pid[_0x25d0d9])pid[_0x25d0d9][_0x236c62(0x24d)]({'function':_0x236c62(0x1b6),'args':null});}else logger[_0x236c62(0x1e2)](_0x236c62(0x1fa));}),_0x153319['on']('update-bb',_0x5b7042=>{const _0x41d5d7=_0xbdd17e;if(validateAccess(_0x5b7042,_0x860395)[_0x41d5d7(0x224)])updateBB();else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x153319['on'](_0xbdd17e(0x21f),_0x12d41c=>{const _0x1d57a9=_0xbdd17e;if(validateAccess(_0x12d41c,_0x860395)['allow'])getMessages();else logger[_0x1d57a9(0x1e2)](_0x1d57a9(0x26d));}),_0x153319['on'](_0xbdd17e(0x2b6),(_0x30bf14,_0x19a17)=>{const _0xf97039=_0xbdd17e;if(validateAccess(_0x19a17,_0x860395)['allow'])confirmMessage(_0x30bf14);else logger['full'](_0xf97039(0x2f5));}),_0x153319['on'](_0xbdd17e(0x2f3),_0x3550b6=>{const _0x346eaa=_0xbdd17e;if(validateAccess(_0x3550b6,_0x860395)[_0x346eaa(0x224)]){if(devices[_0x860395][_0x346eaa(0x31b)])clearTimeout(devices[_0x860395]['pidRefreshToken']);if(devices[_0x860395]['pidExpireLogin'])clearTimeout(devices[_0x860395]['pidExpireLogin']);removeSocketListeners(getClient(_0x153319['id'])[_0x346eaa(0x1d6)]),addBlacklist(_0x860395),devices[_0x860395][_0x346eaa(0x2e7)]=null,devices[_0x860395][_0x346eaa(0x2b2)]=null,devices[_0x860395][_0x346eaa(0x324)][_0x346eaa(0x24e)]=null,io['to'](getClient(_0x153319['id'])[_0x346eaa(0x1d6)])[_0x346eaa(0x19c)](_0x346eaa(0x1f1),{'access':{'allow':![],'reason':_0x346eaa(0x1a8),'token':null}});}else logger[_0x346eaa(0x1e2)](_0x346eaa(0x2b5));});}function removeSocketListeners(_0x4f2011){getClientsWithUuid(_0x4f2011)['forEach'](_0x38281e=>{const _0x16530e=_0x10c0;getSocket(_0x38281e['id'])[_0x16530e(0x2fe)]();});}function cleanSettings(){const _0x5cea28=_0x369d1e;let _0x1b4a6f=settings;return settings[_0x5cea28(0x27d)]&&settings[_0x5cea28(0x27d)]!=''&&(_0x1b4a6f={..._0x1b4a6f,'telegramToken':_0x5cea28(0x1d2)}),settings[_0x5cea28(0x219)]&&settings[_0x5cea28(0x219)]!=''&&(_0x1b4a6f={..._0x1b4a6f,'bbPassword':'************'}),(settings['bbPassword']&&settings['bbPassword']==_0x5cea28(0x285)||settings[_0x5cea28(0x27d)]&&settings['telegramToken']==_0x5cea28(0x285))&&(_0x1b4a6f={..._0x1b4a6f,'restored':{'password':settings[_0x5cea28(0x219)]=='***','telegram':settings['telegramToken']==_0x5cea28(0x285)}}),_0x1b4a6f;}function updateBB(){const _0x514d84=_0x369d1e;installingUpdate=!![],config['forEach'](_0x26f1aa=>{restartBot(_0x26f1aa['botID']);}),process[_0x514d84(0x24d)]({'update':!![]},_0x29b7f6=>{});}function startBot(_0x5a87c0,_0x530937,_0x1371c5){const _0x3eb221=_0x369d1e;let _0x48707e=![];const _0x15ef87=_0x5a87c0[0x0];_0x530937={..._0x530937,'stdio':[_0x3eb221(0x22d),_0x3eb221(0x22d),_0x3eb221(0x22d),_0x3eb221(0x23f)]},pid[_0x15ef87]=childProcess[_0x3eb221(0x1aa)](botfile,_0x5a87c0,_0x530937),pid[_0x15ef87]['on']('message',_0x500995=>{const _0x228965=_0x3eb221;switch(Object[_0x228965(0x25e)](_0x500995)[0x0]){case _0x228965(0x2e4):updateBotName(_0x15ef87,_0x500995['botname']);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x15ef87,_0x500995[_0x228965(0x1f1)]);break;case'live':updateLive(_0x15ef87,_0x500995['live']);break;case'started':updateLive(_0x15ef87,_0x500995[_0x228965(0x321)]),io['to'](_0x15ef87)[_0x228965(0x19c)](_0x228965(0x1f1),{'access':{'allow':![],'reason':_0x228965(0x238),'token':null}});break;case _0x228965(0x2e9):_0x500995['stop']==_0x228965(0x1fc)&&restartBot(_0x15ef87);_0x500995['stop']==_0x228965(0x2ad)&&toggleBot(_0x15ef87,_0x228965(0x1c9),_0x228965(0x1c6));break;case _0x228965(0x207):sendTelegram(_0x15ef87,_0x500995[_0x228965(0x207)]);break;case _0x228965(0x212):sendTelegramMsg(_0x500995['telegrammsg']);break;case _0x228965(0x1d4):io['to'](_0x15ef87)['emit'](_0x500995[_0x228965(0x1d4)],_0x500995['args']);break;}}),pid[_0x15ef87]['on'](_0x3eb221(0x32c),function(_0x20ff76){if(_0x48707e)return;_0x48707e=!![],_0x1371c5(_0x20ff76);}),pid[_0x15ef87]['on'](_0x3eb221(0x2d8),async function(_0x165ea6){const _0x25bfc3=_0x3eb221;if(installingUpdate)return;if(_0x48707e)return;_0x48707e=!![],_0x1371c5(null);const _0x59461b=dbConfig['get'](_0x25bfc3(0x2cf))[_0x25bfc3(0x1ca)]({'botID':_0x15ef87})[_0x25bfc3(0x1dd)]();_0x59461b&&(_0x59461b[_0x25bfc3(0x1f1)]==_0x25bfc3(0x2e6)||_0x59461b[_0x25bfc3(0x1f1)]==_0x25bfc3(0x1c8))&&(await sleep(0x3e8),updateLive(_0x15ef87,'stopped'),logger['full']('restarting\x20Bot\x20'+_0x15ef87),startBot([_0x15ef87,userID],{'cwd':bbpath},function(_0x230cf6){const _0x32aa8c=_0x25bfc3;if(_0x230cf6)logger[_0x32aa8c(0x1e2)](_0x230cf6);}));});}function stopBot(_0x4bc8ae){const _0x12d763=_0x369d1e;getClientsWithBotID(_0x4bc8ae)[_0x12d763(0x294)](_0x284b26=>{const _0x4cb87f=_0x12d763;getSocket(_0x284b26['id'])[_0x4cb87f(0x2c3)](!![]),removeClient(_0x284b26['id']);}),pid[_0x4bc8ae]&&(pid[_0x4bc8ae][_0x12d763(0x2ad)](),pid[_0x4bc8ae]=null);}function restartBot(_0x1f4e89){const _0x23ca97=_0x369d1e;if(pid[_0x1f4e89])pid[_0x1f4e89][_0x23ca97(0x2ad)]();}function addBot(){const _0x1b4baf=_0x369d1e;let _0x2fbc05;for(let _0x57e73f=0x1;_0x57e73f<0x3e9;_0x57e73f++){_0x2fbc05=_0x57e73f[_0x1b4baf(0x2c7)]()[_0x1b4baf(0x20b)](0x3,'0');let _0x40ecc6=config[_0x1b4baf(0x1ca)](_0xed4bea=>_0xed4bea[_0x1b4baf(0x2d6)]==_0x2fbc05);if(!_0x40ecc6)break;}if(_0x2fbc05===_0x1b4baf(0x229)){logger[_0x1b4baf(0x1e2)]('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x1b4baf(0x1e2)]('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x2fbc05),dbConfig[_0x1b4baf(0x1c7)](_0x1b4baf(0x2cf))['push']({'botID':_0x2fbc05,'botname':'Bot\x20'+_0x2fbc05,'status':_0x1b4baf(0x1c8),'live':''})[_0x1b4baf(0x312)](),startBot([_0x2fbc05,userID],{'cwd':bbpath},function(_0x272ae1){const _0x171557=_0x1b4baf;if(_0x272ae1)logger[_0x171557(0x1e2)](_0x272ae1);}),config=getConfiguration(),io['to']('botmanager')[_0x1b4baf(0x19c)](_0x1b4baf(0x2cf),config);}function deleteBot(_0x44ad5b){const _0x34fdf1=_0x369d1e;getClientsWithBotID(_0x44ad5b)[_0x34fdf1(0x294)](_0x213687=>{getSocket(_0x213687['id'])['disconnect'](!![]),removeClient(_0x213687['id']);}),dbConfig[_0x34fdf1(0x1c7)]('bots')[_0x34fdf1(0x26f)]({'botID':_0x44ad5b})[_0x34fdf1(0x312)](),logger[_0x34fdf1(0x1e2)]('deleted\x20Bot\x20'+_0x44ad5b),stopBot(_0x44ad5b);try{fs['unlinkSync'](path['join'](configpath,_0x34fdf1(0x2e2)+_0x44ad5b+_0x34fdf1(0x2f2))),fs[_0x34fdf1(0x1cc)](path[_0x34fdf1(0x308)](configpath,_0x34fdf1(0x2e2)+_0x44ad5b+_0x34fdf1(0x29b))),fs[_0x34fdf1(0x1cc)](path[_0x34fdf1(0x308)](configpath,_0x34fdf1(0x2e2)+_0x44ad5b+_0x34fdf1(0x22e))),fs['unlinkSync'](path['join'](configpath,'bot-'+_0x44ad5b+_0x34fdf1(0x1a5)));}catch(_0x45b4b3){if(_0x45b4b3)logger[_0x34fdf1(0x1e2)](_0x34fdf1(0x315),_0x45b4b3);}config=getConfiguration(),io['to'](_0x34fdf1(0x19f))[_0x34fdf1(0x19c)](_0x34fdf1(0x2cf),config);}function toggleBot(_0x34f011,_0x11efc7,_0x51ca27){const _0x3364f0=_0x369d1e;dbConfig[_0x3364f0(0x1c7)](_0x3364f0(0x2cf))[_0x3364f0(0x1ca)]({'botID':_0x34f011})[_0x3364f0(0x1ac)]({'status':_0x11efc7})[_0x3364f0(0x1ac)]({'live':_0x51ca27})[_0x3364f0(0x312)]();if(_0x11efc7==_0x3364f0(0x2e6)||_0x11efc7==_0x3364f0(0x1c8))logger[_0x3364f0(0x1e2)](_0x3364f0(0x334)+_0x34f011),startBot([_0x34f011,userID],{'cwd':bbpath},function(_0x553503){const _0x131f64=_0x3364f0;if(_0x553503)logger[_0x131f64(0x1e2)](_0x553503);});else(_0x11efc7==_0x3364f0(0x1c9)||_0x11efc7=='new-disabled')&&(logger[_0x3364f0(0x1e2)](_0x3364f0(0x21e)+_0x34f011),stopBot(_0x34f011));config=getConfiguration(),io['to'](_0x3364f0(0x19f))[_0x3364f0(0x19c)]('bots',config);}function toggleStatus(_0x2437de){const _0x974a1e=_0x369d1e;let _0x359d91=dbConfig['get'](_0x974a1e(0x2cf))[_0x974a1e(0x1ca)]({'botID':_0x2437de})[_0x974a1e(0x1dd)](),_0x2507aa;if(_0x359d91[_0x974a1e(0x1f1)]===_0x974a1e(0x2e6))_0x2507aa=_0x974a1e(0x1c9);else{if(_0x359d91['status']==='new')_0x2507aa=_0x974a1e(0x1a2);else{if(_0x359d91[_0x974a1e(0x1f1)]===_0x974a1e(0x1a2))_0x2507aa='new';else{if(_0x359d91[_0x974a1e(0x1f1)]===_0x974a1e(0x1c9))_0x2507aa='enabled';}}}return _0x2507aa;}function updateStatus(_0x26b546,_0xd9745a){const _0x152cf1=_0x369d1e;dbConfig[_0x152cf1(0x1c7)](_0x152cf1(0x2cf))['find']({'botID':_0x26b546})[_0x152cf1(0x1ac)]({'status':_0xd9745a})[_0x152cf1(0x312)](),config=getConfiguration(),io['to']('botmanager')[_0x152cf1(0x19c)](_0x152cf1(0x2cf),config);}function updateLive(_0x459613,_0x4ea088){const _0x439c41=_0x369d1e;dbConfig[_0x439c41(0x1c7)](_0x439c41(0x2cf))[_0x439c41(0x1ca)]({'botID':_0x459613})[_0x439c41(0x1ac)]({'live':_0x4ea088})[_0x439c41(0x312)](),config=getConfiguration(),io['to'](_0x439c41(0x19f))['emit'](_0x439c41(0x2cf),config);}function updateBotName(_0x392a03,_0x1dd0ec){const _0x1a7293=_0x369d1e;dbConfig[_0x1a7293(0x1c7)]('bots')[_0x1a7293(0x1ca)]({'botID':_0x392a03})[_0x1a7293(0x1ac)]({'botname':_0x1dd0ec})[_0x1a7293(0x312)](),config=getConfiguration(),io['to']('botmanager')[_0x1a7293(0x19c)](_0x1a7293(0x2cf),config);}function updateBotManager(){const _0x263c15=_0x369d1e;config=getConfiguration(),io['to'](_0x263c15(0x19f))[_0x263c15(0x19c)](_0x263c15(0x2cf),config);}function toggleBotMode(_0x2e6e45){const _0x1ea40b=_0x369d1e;if(pid[_0x2e6e45])pid[_0x2e6e45]['send']({'function':_0x1ea40b(0x223),'args':null});else{const _0x30e6a7=configpath+_0x1ea40b(0x2e2)+_0x2e6e45+_0x1ea40b(0x2f2),_0x3c4a8d=fs[_0x1ea40b(0x32d)](_0x30e6a7),_0x48d2ab=JSON[_0x1ea40b(0x1ea)](_0x3c4a8d),_0x501f52=_0x48d2ab[_0x1ea40b(0x246)][0x0][_0x1ea40b(0x232)];_0x48d2ab[_0x1ea40b(0x246)][0x0][_0x1ea40b(0x232)]=!_0x501f52;const _0x11125d=JSON['stringify'](_0x48d2ab,null,0x2);fs[_0x1ea40b(0x250)](_0x30e6a7,_0x11125d),config=getConfiguration(),io['to'](_0x1ea40b(0x19f))[_0x1ea40b(0x19c)](_0x1ea40b(0x2cf),config);}}function telegramError(_0x3a2575){const _0x17a22c=_0x369d1e;logger[_0x17a22c(0x1ec)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x2c4d06){const _0x87e1b=_0x369d1e;if(_0x2c4d06[_0x87e1b(0x25d)]['username']!=settings[_0x87e1b(0x295)]&&'@'+_0x2c4d06[_0x87e1b(0x25d)][_0x87e1b(0x1ff)]!=settings[_0x87e1b(0x295)])return tgBot[_0x87e1b(0x248)](_0x2c4d06['chat']['id'],_0x87e1b(0x29f),{'parse_mode':_0x87e1b(0x1ee)})[_0x87e1b(0x1d7)](_0x26c2b4=>{telegramError(_0x26c2b4);}),![];return!![];}async function initTelegram(){const _0x5cec29=_0x369d1e;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x5cec29(0x27d)],{'polling':!![]});let _0x3504b8='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3504b8+='\x0a',_0x3504b8+=_0x5cec29(0x2f4),_0x3504b8+=_0x5cec29(0x1f6),_0x3504b8+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x3504b8+=_0x5cec29(0x19d),_0x3504b8+=_0x5cec29(0x314),_0x3504b8+=_0x5cec29(0x2bd),_0x3504b8+=_0x5cec29(0x2cc),_0x3504b8+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3504b8+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x3504b8+=_0x5cec29(0x236),_0x3504b8+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x3504b8+=_0x5cec29(0x23d);let _0x456f21='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x456f21+='\x0a',_0x456f21+=_0x3504b8,tgBot[_0x5cec29(0x30e)](/\/start/,_0x2ac700=>{const _0x70cd99=_0x5cec29;if(!validateTelegram(_0x2ac700))return;if(settings[_0x70cd99(0x18d)]!=_0x2ac700[_0x70cd99(0x32e)]['id'])updateSetting('telegramChatId',_0x2ac700[_0x70cd99(0x32e)]['id']);updateSetting(_0x70cd99(0x291),!![]),tgBot['sendMessage'](_0x2ac700[_0x70cd99(0x32e)]['id'],_0x456f21)[_0x70cd99(0x1d7)](_0x480487=>{telegramError(_0x480487);});}),tgBot[_0x5cec29(0x30e)](/\/enable/,_0x4eecbf=>{const _0x28f484=_0x5cec29;if(!validateTelegram(_0x4eecbf))return;if(settings['telegramChatId']!=_0x4eecbf[_0x28f484(0x32e)]['id'])updateSetting(_0x28f484(0x18d),_0x4eecbf[_0x28f484(0x32e)]['id']);updateSetting(_0x28f484(0x291),!![]),tgBot[_0x28f484(0x248)](_0x4eecbf[_0x28f484(0x32e)]['id'],_0x28f484(0x243))[_0x28f484(0x1d7)](_0xb7dbd1=>{telegramError(_0xb7dbd1);});}),tgBot['onText'](/\/config/,async _0x5655bf=>{const _0x53b46a=_0x5cec29;if(!validateTelegram(_0x5655bf))return;tgBot['removeListener'](_0x53b46a(0x2af)),tgBot[_0x53b46a(0x248)](_0x5655bf[_0x53b46a(0x32e)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x53b46a(0x23e),'callback_data':_0x53b46a(0x18a)},{'text':_0x53b46a(0x203),'callback_data':_0x53b46a(0x2c6)},{'text':_0x53b46a(0x253),'callback_data':'all'}]]}})['catch'](_0x155b93=>{telegramError(_0x155b93);}),tgBot['on']('callback_query',async _0x34deb1=>{const _0x3be92a=_0x53b46a,_0x17c9f8=_0x34deb1[_0x3be92a(0x1ce)],_0x4dbb0c=_0x34deb1[_0x3be92a(0x1e7)];tgBot[_0x3be92a(0x32f)](_0x34deb1['id'])[_0x3be92a(0x301)](async()=>{const _0x19c6e4=_0x3be92a;_0x17c9f8=='orders'&&(updateSetting(_0x19c6e4(0x2a4),'orders'),updateSetting(_0x19c6e4(0x291),!![]),await tgBot[_0x19c6e4(0x248)](_0x4dbb0c['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x19c6e4(0x1d7)](_0x314cf6=>{telegramError(_0x314cf6);}));_0x17c9f8==_0x19c6e4(0x2c6)&&(updateSetting(_0x19c6e4(0x2a4),_0x19c6e4(0x2c6)),updateSetting(_0x19c6e4(0x291),!![]),await tgBot[_0x19c6e4(0x248)](_0x4dbb0c['chat']['id'],_0x19c6e4(0x268))[_0x19c6e4(0x1d7)](_0x1fcf8a=>{telegramError(_0x1fcf8a);}));_0x17c9f8=='all'&&(updateSetting(_0x19c6e4(0x2a4),_0x19c6e4(0x239)),updateSetting('telegramEnabled',!![]),await tgBot[_0x19c6e4(0x248)](_0x4dbb0c[_0x19c6e4(0x32e)]['id'],_0x19c6e4(0x2b9))[_0x19c6e4(0x1d7)](_0x34f322=>{telegramError(_0x34f322);}));if(!settings[_0x19c6e4(0x18d)])tgBot[_0x19c6e4(0x248)](_0x4dbb0c[_0x19c6e4(0x32e)]['id'],_0x19c6e4(0x2ee))[_0x19c6e4(0x1d7)](_0x5577fa=>{telegramError(_0x5577fa);});}),tgBot['removeListener']('callback_query');});}),tgBot[_0x5cec29(0x30e)](/\/status/,_0x1b9f9b=>{const _0x3e3383=_0x5cec29;if(!validateTelegram(_0x1b9f9b))return;const _0x21d64e=getBotsWithMode();let _0x28a43d=_0x3e3383(0x28a);config[_0x3e3383(0x294)](_0x5235a8=>{const _0x5a4fde=_0x3e3383,_0x2c3e50=_0x21d64e[_0x5a4fde(0x1ca)](_0x42870f=>_0x42870f[_0x5a4fde(0x2d6)]==_0x5235a8[_0x5a4fde(0x2d6)])[_0x5a4fde(0x1cf)];_0x28a43d+=_0x5a4fde(0x300)+_0x5235a8[_0x5a4fde(0x2d6)]+':\x20'+_0x5235a8['status']+_0x5a4fde(0x1d1)+_0x2c3e50+_0x5a4fde(0x1d1)+_0x5235a8[_0x5a4fde(0x233)]+'\x0a';}),_0x28a43d+='\x0a',_0x28a43d+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x28a43d+=!settings[_0x3e3383(0x291)]?_0x3e3383(0x2dc):_0x3e3383(0x1b2),_0x28a43d+=settings[_0x3e3383(0x291)]?settings['telegramEvents']==_0x3e3383(0x239)?_0x3e3383(0x252):_0x3e3383(0x2de)+settings[_0x3e3383(0x2a4)]+'\x20only\x0a':'',tgBot[_0x3e3383(0x248)](_0x1b9f9b[_0x3e3383(0x32e)]['id'],_0x28a43d,{'parse_mode':_0x3e3383(0x1ee)})[_0x3e3383(0x1d7)](_0x5c91e3=>{telegramError(_0x5c91e3);});}),tgBot['onText'](/\/restart/,_0x7c7005=>{const _0x2b99d6=_0x5cec29;if(!validateTelegram(_0x7c7005))return;tgBot[_0x2b99d6(0x30b)](_0x2b99d6(0x2af));const _0x5082b3=getEnabledBots();if(_0x5082b3['length']==0x0)tgBot[_0x2b99d6(0x248)](_0x7c7005[_0x2b99d6(0x32e)]['id'],_0x2b99d6(0x1ab))[_0x2b99d6(0x1d7)](_0x4a9a5f=>{telegramError(_0x4a9a5f);});else{if(_0x5082b3[_0x2b99d6(0x1c5)]>0x1)_0x5082b3[_0x2b99d6(0x1a0)]({'botID':_0x2b99d6(0x239)});let _0x3b448a=[],_0x26687d=[];const _0x445250=_0x5082b3['length']%0x4==0x0||_0x5082b3[_0x2b99d6(0x1c5)]%0x4==0x3||_0x5082b3[_0x2b99d6(0x1c5)]%0x3==0x1?0x4:0x3;let _0x236ad3=0x0;_0x5082b3[_0x2b99d6(0x294)]((_0x346ced,_0x36188a)=>{const _0x5c1114=_0x2b99d6;if(_0x36188a%_0x445250==0x0)_0x26687d=[];_0x26687d[_0x5c1114(0x1a0)]({'text':_0x346ced[_0x5c1114(0x2d6)]==_0x5c1114(0x239)?_0x5c1114(0x275):_0x5c1114(0x300)+_0x346ced[_0x5c1114(0x2d6)],'callback_data':_0x346ced[_0x5c1114(0x2d6)]}),_0x36188a%_0x445250==0x0&&(_0x3b448a[_0x236ad3]=_0x26687d,_0x236ad3++);}),tgBot[_0x2b99d6(0x248)](_0x7c7005[_0x2b99d6(0x32e)]['id'],_0x2b99d6(0x28f),{'reply_markup':{'inline_keyboard':_0x3b448a}})['catch'](_0x56b7c8=>{telegramError(_0x56b7c8);}),tgBot['on'](_0x2b99d6(0x2af),async _0x4c0d3e=>{const _0x572edc=_0x2b99d6,_0x4cd90e=_0x4c0d3e[_0x572edc(0x1ce)],_0xa2e16a=_0x4c0d3e['message'];tgBot[_0x572edc(0x32f)](_0x4c0d3e['id'])[_0x572edc(0x301)](async()=>{const _0x24fce0=_0x572edc;_0x4cd90e==_0x24fce0(0x239)?config[_0x24fce0(0x294)](_0x47d524=>{const _0x29e36d=_0x24fce0;restartBot(_0x47d524[_0x29e36d(0x2d6)]);}):restartBot(_0x4cd90e);}),tgBot[_0x572edc(0x30b)](_0x572edc(0x2af));});}}),tgBot[_0x5cec29(0x30e)](/\/on/,_0x3dabe0=>{const _0x5548fb=_0x5cec29;if(!validateTelegram(_0x3dabe0))return;tgBot['removeListener'](_0x5548fb(0x2af));const _0x5dc3e6=getDisabledBots();if(_0x5dc3e6['length']==0x0)tgBot['sendMessage'](_0x3dabe0[_0x5548fb(0x32e)]['id'],_0x5548fb(0x208))[_0x5548fb(0x1d7)](_0x3403b2=>{telegramError(_0x3403b2);});else{if(_0x5dc3e6[_0x5548fb(0x1c5)]>0x1)_0x5dc3e6[_0x5548fb(0x1a0)]({'botID':_0x5548fb(0x239)});let _0x53faef=[],_0x10198b=[];const _0x2bef75=_0x5dc3e6[_0x5548fb(0x1c5)]%0x4==0x0||_0x5dc3e6['length']%0x4==0x3||_0x5dc3e6[_0x5548fb(0x1c5)]%0x3==0x1?0x4:0x3;let _0x12ddae=0x0;_0x5dc3e6['forEach']((_0x2cdeb9,_0x26d99b)=>{const _0x2831bf=_0x5548fb;if(_0x26d99b%_0x2bef75==0x0)_0x10198b=[];_0x10198b[_0x2831bf(0x1a0)]({'text':_0x2cdeb9[_0x2831bf(0x2d6)]==_0x2831bf(0x239)?'All\x20bots':_0x2831bf(0x300)+_0x2cdeb9[_0x2831bf(0x2d6)],'callback_data':_0x2cdeb9[_0x2831bf(0x2d6)]}),_0x26d99b%_0x2bef75==0x0&&(_0x53faef[_0x12ddae]=_0x10198b,_0x12ddae++);}),tgBot['sendMessage'](_0x3dabe0[_0x5548fb(0x32e)]['id'],_0x5548fb(0x2ea),{'reply_markup':{'inline_keyboard':_0x53faef}})[_0x5548fb(0x1d7)](_0x522b31=>{telegramError(_0x522b31);}),tgBot['on']('callback_query',async _0x20c2d5=>{const _0x4b30bc=_0x5548fb,_0x507c16=_0x20c2d5[_0x4b30bc(0x1ce)],_0x39f098=_0x20c2d5[_0x4b30bc(0x1e7)];tgBot[_0x4b30bc(0x32f)](_0x20c2d5['id'])[_0x4b30bc(0x301)](async()=>{const _0x28b247=_0x4b30bc;_0x507c16=='all'?(tgBot['sendMessage'](_0x39f098[_0x28b247(0x32e)]['id'],_0x28b247(0x2d7))[_0x28b247(0x1d7)](_0x461653=>{telegramError(_0x461653);}),_0x5dc3e6[_0x28b247(0x294)](_0x382e26=>{const _0x216104=_0x28b247;if(_0x382e26[_0x216104(0x2d6)]!=_0x216104(0x239))toggleBot(_0x382e26['botID'],toggleStatus(_0x382e26['botID']),_0x216104(0x1c6));})):(tgBot[_0x28b247(0x248)](_0x39f098[_0x28b247(0x32e)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x507c16)[_0x28b247(0x1d7)](_0x54a8a2=>{telegramError(_0x54a8a2);}),toggleBot(_0x507c16,toggleStatus(_0x507c16),'stopped'));}),tgBot[_0x4b30bc(0x30b)](_0x4b30bc(0x2af));});}}),tgBot[_0x5cec29(0x30e)](/\/off/,_0x23acde=>{const _0x1a1d00=_0x5cec29;if(!validateTelegram(_0x23acde))return;tgBot[_0x1a1d00(0x30b)](_0x1a1d00(0x2af));const _0x41ef5e=getEnabledBots();if(_0x41ef5e[_0x1a1d00(0x1c5)]==0x0)tgBot[_0x1a1d00(0x248)](_0x23acde['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x1a1d00(0x1d7)](_0x4d2c69=>{telegramError(_0x4d2c69);});else{if(_0x41ef5e[_0x1a1d00(0x1c5)]>0x1)_0x41ef5e[_0x1a1d00(0x1a0)]({'botID':_0x1a1d00(0x239)});let _0x3f62aa=[],_0x285074=[];const _0x3a1e38=_0x41ef5e[_0x1a1d00(0x1c5)]%0x4==0x0||_0x41ef5e['length']%0x4==0x3||_0x41ef5e['length']%0x3==0x1?0x4:0x3;let _0x238075=0x0;_0x41ef5e[_0x1a1d00(0x294)]((_0x1b9a52,_0x3c48f6)=>{const _0x31c4e6=_0x1a1d00;if(_0x3c48f6%_0x3a1e38==0x0)_0x285074=[];_0x285074['push']({'text':_0x1b9a52['botID']==_0x31c4e6(0x239)?_0x31c4e6(0x275):_0x31c4e6(0x300)+_0x1b9a52['botID'],'callback_data':_0x1b9a52[_0x31c4e6(0x2d6)]}),_0x3c48f6%_0x3a1e38==0x0&&(_0x3f62aa[_0x238075]=_0x285074,_0x238075++);}),tgBot['sendMessage'](_0x23acde[_0x1a1d00(0x32e)]['id'],_0x1a1d00(0x1ae),{'reply_markup':{'inline_keyboard':_0x3f62aa}})[_0x1a1d00(0x1d7)](_0xe1b552=>{telegramError(_0xe1b552);}),tgBot['on']('callback_query',async _0x16d6ac=>{const _0x49819d=_0x1a1d00,_0x199d1e=_0x16d6ac[_0x49819d(0x1ce)],_0x45a31c=_0x16d6ac[_0x49819d(0x1e7)];tgBot[_0x49819d(0x32f)](_0x16d6ac['id'])[_0x49819d(0x301)](async()=>{const _0x5b06e7=_0x49819d;_0x199d1e=='all'?(tgBot[_0x5b06e7(0x248)](_0x45a31c[_0x5b06e7(0x32e)]['id'],_0x5b06e7(0x1bf))[_0x5b06e7(0x1d7)](_0x4242bc=>{telegramError(_0x4242bc);}),_0x41ef5e[_0x5b06e7(0x294)](_0x33cca3=>{const _0x2d06d4=_0x5b06e7;if(_0x33cca3[_0x2d06d4(0x2d6)]!=_0x2d06d4(0x239))toggleBot(_0x33cca3['botID'],toggleStatus(_0x33cca3[_0x2d06d4(0x2d6)]),_0x2d06d4(0x1c6));})):(tgBot[_0x5b06e7(0x248)](_0x45a31c['chat']['id'],_0x5b06e7(0x209)+_0x199d1e)[_0x5b06e7(0x1d7)](_0xd9162d=>{telegramError(_0xd9162d);}),toggleBot(_0x199d1e,toggleStatus(_0x199d1e),'stopped'));}),tgBot[_0x49819d(0x30b)](_0x49819d(0x2af));});}}),tgBot[_0x5cec29(0x30e)](/\/portfolio/,_0x577046=>{const _0x9e234e=_0x5cec29;if(!validateTelegram(_0x577046))return;tgBot[_0x9e234e(0x30b)](_0x9e234e(0x2af));const _0x3d6233=getEnabledBots();if(_0x3d6233[_0x9e234e(0x1c5)]==0x0)tgBot[_0x9e234e(0x248)](_0x577046[_0x9e234e(0x32e)]['id'],_0x9e234e(0x1ab))[_0x9e234e(0x1d7)](_0x34d4e0=>{telegramError(_0x34d4e0);});else{if(_0x3d6233[_0x9e234e(0x1c5)]>0x1){let _0x58a1f7=[],_0x3724d7=[];const _0x86aaaa=_0x3d6233[_0x9e234e(0x1c5)]%0x4==0x0||_0x3d6233[_0x9e234e(0x1c5)]%0x4==0x3||_0x3d6233[_0x9e234e(0x1c5)]%0x3==0x1?0x4:0x3;let _0x590450=0x0;_0x3d6233[_0x9e234e(0x294)]((_0x467ffc,_0x5339cc)=>{const _0xf1d7cc=_0x9e234e;if(_0x5339cc%_0x86aaaa==0x0)_0x3724d7=[];_0x3724d7[_0xf1d7cc(0x1a0)]({'text':_0xf1d7cc(0x300)+_0x467ffc[_0xf1d7cc(0x2d6)],'callback_data':_0x467ffc[_0xf1d7cc(0x2d6)]}),_0x5339cc%_0x86aaaa==0x0&&(_0x58a1f7[_0x590450]=_0x3724d7,_0x590450++);}),tgBot[_0x9e234e(0x248)](_0x577046[_0x9e234e(0x32e)]['id'],_0x9e234e(0x251),{'reply_markup':{'inline_keyboard':_0x58a1f7}})[_0x9e234e(0x1d7)](_0x4dfa88=>{telegramError(_0x4dfa88);}),tgBot['on']('callback_query',async _0x536755=>{const _0x3ec9f4=_0x9e234e,_0x4ee69d=_0x536755[_0x3ec9f4(0x1ce)],_0xa226d9=_0x536755['message'];tgBot[_0x3ec9f4(0x32f)](_0x536755['id'])[_0x3ec9f4(0x301)](async()=>{const _0x5b8e7c=_0x3ec9f4;if(pid[_0x4ee69d])pid[_0x4ee69d][_0x5b8e7c(0x24d)]({'function':_0x5b8e7c(0x1f9),'args':null});}),tgBot['removeListener'](_0x3ec9f4(0x2af));});}else{const _0x33444e=_0x3d6233[0x0][_0x9e234e(0x2d6)];if(pid[_0x33444e])pid[_0x33444e][_0x9e234e(0x24d)]({'function':_0x9e234e(0x1f9),'args':null});}}}),tgBot[_0x5cec29(0x30e)](/\/update/,async _0x278108=>{const _0x590262=_0x5cec29;if(!validateTelegram(_0x278108))return;tgBot[_0x590262(0x30b)](_0x590262(0x2af)),await getMessages();if(!updateAvailable)tgBot[_0x590262(0x248)](_0x278108['chat']['id'],_0x590262(0x2c8))[_0x590262(0x1d7)](_0x32499a=>{telegramError(_0x32499a);});else!validInstallation?tgBot[_0x590262(0x248)](_0x278108[_0x590262(0x32e)]['id'],_0x590262(0x235))[_0x590262(0x1d7)](_0x558ddf=>{telegramError(_0x558ddf);}):(tgBot[_0x590262(0x248)](_0x278108[_0x590262(0x32e)]['id'],_0x590262(0x258),{'reply_markup':{'inline_keyboard':[[{'text':_0x590262(0x1e0),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x590262(0x1d7)](_0x55fded=>{telegramError(_0x55fded);}),tgBot['on'](_0x590262(0x2af),async _0x5a1392=>{const _0x582b0b=_0x590262,_0x18d5c6=_0x5a1392['data'],_0x2b3459=_0x5a1392[_0x582b0b(0x1e7)];tgBot[_0x582b0b(0x32f)](_0x5a1392['id'])[_0x582b0b(0x301)](async()=>{const _0x2d7d0a=_0x582b0b;_0x18d5c6==_0x2d7d0a(0x2a3)&&(await tgBot[_0x2d7d0a(0x248)](_0x2b3459[_0x2d7d0a(0x32e)]['id'],_0x2d7d0a(0x2b4))[_0x2d7d0a(0x1d7)](_0x43e9fb=>{telegramError(_0x43e9fb);}),updateBB());_0x18d5c6=='no'&&await tgBot[_0x2d7d0a(0x248)](_0x2b3459[_0x2d7d0a(0x32e)]['id'],_0x2d7d0a(0x2c1))[_0x2d7d0a(0x1d7)](_0x3970dc=>{telegramError(_0x3970dc);});if(!settings[_0x2d7d0a(0x18d)])tgBot['sendMessage'](_0x2b3459['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x2d7d0a(0x1d7)](_0x262588=>{telegramError(_0x262588);});}),tgBot[_0x582b0b(0x30b)]('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x261a52=>{const _0x516735=_0x5cec29;if(!validateTelegram(_0x261a52))return;tgBot['removeListener']('callback_query');const _0x4658de=getBotsWithMode();if(_0x4658de[_0x516735(0x1c5)]==0x0)tgBot[_0x516735(0x248)](_0x261a52[_0x516735(0x32e)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x516735(0x1d7)](_0x4352fe=>{telegramError(_0x4352fe);});else{let _0xe4b278=[],_0x5782d0=[];const _0x51d563=0x2;let _0x19ded8=0x0;_0x4658de[_0x516735(0x294)]((_0x217e30,_0x15824a)=>{const _0x555672=_0x516735;if(_0x15824a%_0x51d563==0x0)_0x5782d0=[];_0x5782d0[_0x555672(0x1a0)]({'text':'Bot\x20'+_0x217e30[_0x555672(0x2d6)]+'\x20('+_0x217e30[_0x555672(0x1cf)]+')','callback_data':_0x217e30[_0x555672(0x2d6)]}),_0x15824a%_0x51d563==0x0&&(_0xe4b278[_0x19ded8]=_0x5782d0,_0x19ded8++);}),tgBot[_0x516735(0x248)](_0x261a52[_0x516735(0x32e)]['id'],_0x516735(0x270),{'reply_markup':{'inline_keyboard':_0xe4b278}})['catch'](_0x2491b9=>{telegramError(_0x2491b9);}),tgBot['on'](_0x516735(0x2af),async _0x415c14=>{const _0x273932=_0x516735,_0x42b123=_0x415c14['data'],_0x10f20a=_0x415c14[_0x273932(0x1e7)];tgBot[_0x273932(0x32f)](_0x415c14['id'])[_0x273932(0x301)](async()=>{const _0x57087b=_0x273932,_0x4477d6=_0x4658de[_0x57087b(0x1ca)](_0x4501e0=>_0x4501e0['botID']==_0x42b123),_0x20376a=_0x4477d6[_0x57087b(0x1cf)]==_0x57087b(0x30f)?'manual':_0x57087b(0x30f);tgBot[_0x57087b(0x248)](_0x10f20a['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x42b123+_0x57087b(0x280)+_0x20376a+_0x57087b(0x1e3))[_0x57087b(0x1d7)](_0x3a3fc2=>{telegramError(_0x3a3fc2);}),toggleBotMode(_0x42b123);}),tgBot[_0x273932(0x30b)](_0x273932(0x2af));});}}),tgBot[_0x5cec29(0x30e)](/\/names/,_0x33e8bf=>{const _0x2cbbad=_0x5cec29;if(!validateTelegram(_0x33e8bf))return;let _0x416303='';config['forEach'](_0x33143d=>{const _0x5d8360=_0x10c0;_0x416303+=_0x5d8360(0x300)+_0x33143d[_0x5d8360(0x2d6)]+':\x20'+_0x33143d[_0x5d8360(0x2e4)]+'\x0a';}),tgBot[_0x2cbbad(0x248)](_0x33e8bf[_0x2cbbad(0x32e)]['id'],_0x416303,{'parse_mode':_0x2cbbad(0x1ee)})[_0x2cbbad(0x1d7)](_0x2462f6=>{telegramError(_0x2462f6);});}),tgBot['onText'](/\/disable/,_0x164b23=>{const _0x3d5761=_0x5cec29;if(!validateTelegram(_0x164b23))return;tgBot[_0x3d5761(0x248)](_0x164b23[_0x3d5761(0x32e)]['id'],_0x3d5761(0x2d9))['catch'](_0x29ca11=>{telegramError(_0x29ca11);}),updateSetting(_0x3d5761(0x291),![]);}),tgBot['onText'](/\/help/,_0x48b2cd=>{const _0x3641e6=_0x5cec29;if(!validateTelegram(_0x48b2cd))return;tgBot['sendMessage'](_0x48b2cd[_0x3641e6(0x32e)]['id'],_0x3504b8)[_0x3641e6(0x1d7)](_0x172188=>{telegramError(_0x172188);});}),tgBot['on']('polling_error',_0xa24919=>{const _0x58bbd3=_0x5cec29;_0xa24919[_0x58bbd3(0x2c7)]()[_0x58bbd3(0x211)](_0x58bbd3(0x2a6))&&(logger[_0x58bbd3(0x1e2)](_0x58bbd3(0x2e8)),tgBot[_0x58bbd3(0x2bc)](),tgBot=null,io['to'](_0x58bbd3(0x19f))[_0x58bbd3(0x19c)](_0x58bbd3(0x28c),_0x58bbd3(0x2e8)));}),process[_0x5cec29(0x1b9)](_0x5cec29(0x20f),()=>{const _0x3bb314=_0x5cec29;if(tgBot)tgBot[_0x3bb314(0x2bc)]();process[_0x3bb314(0x2d8)](0x1);}),process[_0x5cec29(0x1b9)]('SIGTERM',()=>{const _0x2ca689=_0x5cec29;if(tgBot)tgBot[_0x2ca689(0x2bc)]();process[_0x2ca689(0x2d8)](0x1);});}}function disableTelegram(){const _0x2ec85d=_0x369d1e;tgBot&&(tgBot[_0x2ec85d(0x2bc)](),tgBot=null);}function sendTelegram(_0x471589,_0x30767b){const _0x353e7f=_0x369d1e;if(settings[_0x353e7f(0x291)]){if(settings[_0x353e7f(0x2a4)]==_0x353e7f(0x239)||(_0x30767b[_0x353e7f(0x1e1)]==_0x353e7f(0x32c)||_0x30767b[_0x353e7f(0x1e1)]==_0x353e7f(0x240)||_0x30767b[_0x353e7f(0x1e1)]=='success')&&settings[_0x353e7f(0x2a4)]==_0x353e7f(0x2c6)||_0x30767b['type']==_0x353e7f(0x2c2)&&settings[_0x353e7f(0x2a4)]=='orders'){if(tgBot&&settings[_0x353e7f(0x18d)]){if(_0x30767b[_0x353e7f(0x22b)])tgBot['sendMessage'](settings[_0x353e7f(0x18d)],_0x30767b[_0x353e7f(0x2e4)]+_0x353e7f(0x2d5)+_0x30767b[_0x353e7f(0x1f0)])[_0x353e7f(0x1d7)](_0x269391=>{telegramError(_0x269391);});else tgBot[_0x353e7f(0x248)](settings[_0x353e7f(0x18d)],'Bot\x20'+_0x471589+_0x353e7f(0x2d5)+_0x30767b[_0x353e7f(0x1f0)])[_0x353e7f(0x1d7)](_0xf00899=>{telegramError(_0xf00899);});}}}}async function sendTelegramMsg(_0x837599,_0x39a5e6=_0x369d1e(0x1ee)){const _0x346498=_0x369d1e;return settings[_0x346498(0x291)]&&tgBot&&settings[_0x346498(0x18d)]?(await tgBot[_0x346498(0x248)](settings['telegramChatId'],_0x837599,{'parse_mode':_0x39a5e6})['catch'](_0x5ed2d7=>{telegramError(_0x5ed2d7);}),!![]):![];}function getDeviceWithIp(_0x428bb7){const _0x7b262b=_0x369d1e;return devices[_0x7b262b(0x1ca)](_0x22a31d=>_0x22a31d['ip']===_0x428bb7);}function temporaryAccess2FA(_0x3f3c16,_0x523dcb){const _0x33f3ac=_0x369d1e;let _0x4ed0b3=new Date(),_0x1d1546=![];if(lastIpApproval){if(_0x4ed0b3-lastIpApproval<0x1388)_0x1d1546=!![];}lastIpApproval=new Date();if(_0x1d1546)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x33f3ac(0x30b)](_0x33f3ac(0x2af)),tgBot[_0x33f3ac(0x248)](settings['telegramChatId'],_0x33f3ac(0x2fb)+normalizeIP(_0x523dcb)[_0x33f3ac(0x29c)]+_0x33f3ac(0x279),{'parse_mode':_0x33f3ac(0x1ee),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x33f3ac(0x327),'callback_data':'15'},{'text':_0x33f3ac(0x20a),'callback_data':'30'},{'text':'reject','callback_data':_0x33f3ac(0x20d)}]]}})['catch'](_0x5723b4=>{telegramError(_0x5723b4);}),tgBot['on'](_0x33f3ac(0x2af),async _0x99afdc=>{const _0x45779d=_0x33f3ac,_0x1bc460=_0x99afdc[_0x45779d(0x1ce)],_0x32bbe8=_0x99afdc['message'];tgBot['answerCallbackQuery'](_0x99afdc['id'])[_0x45779d(0x301)](async()=>{const _0x224583=_0x45779d;devices[_0x3f3c16][_0x224583(0x2e7)]={'clientip':_0x523dcb,'timestamp':new Date()[_0x224583(0x24a)](),'expiry':_0x1bc460},_0x1bc460!='reject'?(await tgBot[_0x224583(0x248)](_0x32bbe8[_0x224583(0x32e)]['id'],_0x224583(0x292)+_0x1bc460+_0x224583(0x2a2),{'parse_mode':_0x224583(0x1ee)})[_0x224583(0x1d7)](_0x48268f=>{telegramError(_0x48268f);}),io['to'](_0x3f3c16)[_0x224583(0x19c)](_0x224583(0x1f1),{'access':{'allow':![],'reason':_0x224583(0x238),'token':null}})):(await tgBot[_0x224583(0x248)](_0x32bbe8['chat']['id'],_0x224583(0x325))[_0x224583(0x1d7)](_0x1614da=>{telegramError(_0x1614da);}),io['to'](_0x3f3c16)['emit'](_0x224583(0x1f1),{'access':{'allow':![],'reason':_0x224583(0x241),'token':null}}));}),tgBot['removeListener'](_0x45779d(0x2af));}));}function loginAccess2FA(_0x5dd293,_0x3ac3d5){const _0x4eeb3e=_0x369d1e;tgBot&&settings[_0x4eeb3e(0x18d)]&&(tgBot[_0x4eeb3e(0x30b)](_0x4eeb3e(0x2af)),tgBot[_0x4eeb3e(0x248)](settings[_0x4eeb3e(0x18d)],_0x4eeb3e(0x18e)+normalizeIP(_0x3ac3d5)['show']+_0x4eeb3e(0x279),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4eeb3e(0x2ff),'callback_data':loginExpiry},{'text':_0x4eeb3e(0x20d),'callback_data':_0x4eeb3e(0x20d)}]]}})[_0x4eeb3e(0x1d7)](_0x13f0d4=>{telegramError(_0x13f0d4);}),tgBot['on'](_0x4eeb3e(0x2af),async _0x37cb5e=>{const _0x405319=_0x4eeb3e,_0x37ab13=_0x37cb5e[_0x405319(0x1ce)],_0x3f2b00=_0x37cb5e['message'];tgBot[_0x405319(0x32f)](_0x37cb5e['id'])[_0x405319(0x301)](async()=>{const _0x52f7e1=_0x405319;devices[_0x5dd293][_0x52f7e1(0x2b2)]={'clientip':_0x3ac3d5,'timestamp':new Date()['getTime'](),'expiry':_0x37ab13},_0x37ab13!=_0x52f7e1(0x20d)?(await tgBot[_0x52f7e1(0x248)](_0x3f2b00['chat']['id'],_0x52f7e1(0x31e),{'parse_mode':_0x52f7e1(0x1ee)})['catch'](_0x233a92=>{telegramError(_0x233a92);}),io['to'](_0x5dd293)[_0x52f7e1(0x19c)](_0x52f7e1(0x1f1),{'access':{'allow':![],'reason':_0x52f7e1(0x238),'token':null}})):(await tgBot[_0x52f7e1(0x248)](_0x3f2b00['chat']['id'],_0x52f7e1(0x2ba))['catch'](_0xd9338b=>{telegramError(_0xd9338b);}),io['to'](_0x5dd293)['emit'](_0x52f7e1(0x1f1),{'access':{'allow':![],'reason':_0x52f7e1(0x273),'token':null}}));}),tgBot[_0x405319(0x30b)](_0x405319(0x2af));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4a838f=_0x369d1e;return dbConfig['get'](_0x4a838f(0x2cf))[_0x4a838f(0x192)]('botID')[_0x4a838f(0x1bd)]({'status':_0x4a838f(0x2e6)})[_0x4a838f(0x1dd)]()||[];}function getDisabledBots(){const _0x495739=_0x369d1e;return dbConfig[_0x495739(0x1c7)]('bots')[_0x495739(0x192)](_0x495739(0x2d6))[_0x495739(0x1bd)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x18a5f1){const _0x778b6e=_0x369d1e;let _0x2adc86={};const _0x5dc20a=configpath+_0x778b6e(0x2e2)+_0x18a5f1+_0x778b6e(0x2f2),_0x4822e6=fs[_0x778b6e(0x205)](_0x5dc20a);if(_0x4822e6){const _0x4346bd=fs[_0x778b6e(0x32d)](_0x5dc20a);try{const _0x5913b1=JSON['parse'](_0x4346bd),_0x4677d8=_0x5913b1?_0x5913b1[_0x778b6e(0x246)][0x0][_0x778b6e(0x232)]:![];_0x2adc86['mode']=_0x4677d8?_0x778b6e(0x30f):_0x778b6e(0x333),_0x2adc86[_0x778b6e(0x2e4)]=_0x5913b1?_0x5913b1['bot'][0x0][_0x778b6e(0x2e4)]:'Bot\x20'+_0x18a5f1;}catch(_0x5bd507){_0x2adc86['mode']='manual',_0x2adc86[_0x778b6e(0x2e4)]=_0x778b6e(0x300)+_0x18a5f1;}}else _0x2adc86['mode']=_0x778b6e(0x333),_0x2adc86[_0x778b6e(0x2e4)]='Bot\x20'+_0x18a5f1;return _0x2adc86;}function getBotsWithMode(){const _0x39fc5b=_0x369d1e,_0x4f7deb=dbConfig[_0x39fc5b(0x1c7)](_0x39fc5b(0x2cf))[_0x39fc5b(0x192)]('botID')[_0x39fc5b(0x1dd)]()||[];return _0x4f7deb['forEach'](_0xc75c15=>{const _0x1f8954=_0x39fc5b;let _0x3a5646=getBotAttributes(_0xc75c15[_0x1f8954(0x2d6)]);_0xc75c15[_0x1f8954(0x1cf)]=_0x3a5646[_0x1f8954(0x1cf)];}),_0x4f7deb;}async function initUser(){const _0x1ece3d=_0x369d1e;if(!settings[_0x1ece3d(0x311)]){const _0x3feccf=uuidRandom();mixpanel['alias'](_0x3feccf),updateSetting(_0x1ece3d(0x311),_0x3feccf);}}async function initSecure(){const _0x29d115=_0x369d1e;let _0x18bd64=getSecure();if(!_0x18bd64[_0x29d115(0x2d0)](_0x29d115(0x1b3))){let _0x25226f=await generateKeys();_0x18bd64[_0x29d115(0x28d)]=_0x25226f[_0x29d115(0x28d)],_0x18bd64[_0x29d115(0x1cd)]=_0x25226f['privateKey'],_0x18bd64['secret']=crypto[_0x29d115(0x305)](0x20)[_0x29d115(0x2c7)](_0x29d115(0x1b7));;storeSecure(_0x18bd64);}}function getSettings(){const _0x5b3afb=_0x369d1e;return dbSettings[_0x5b3afb(0x1c7)](_0x5b3afb(0x276))[_0x5b3afb(0x1dd)]()||{};}function getSecure(){const _0x45850d=_0x369d1e;return dbSecure['get'](_0x45850d(0x198))[_0x45850d(0x1dd)]()||{};}function getBlacklist(){const _0x929410=_0x369d1e;return dbSecure['get'](_0x929410(0x332))[_0x929410(0x1dd)]()||[];}function broadcastToBots(_0x4b5e32,_0x2d090c){const _0x2c7590=_0x369d1e;config[_0x2c7590(0x294)](_0x4b450e=>{const _0x58f435=_0x2c7590;if(_0x4b450e['status']=='enabled'&&_0x4b450e[_0x58f435(0x233)]==_0x58f435(0x2e0)){if(pid[_0x4b450e['botID']])pid[_0x4b450e[_0x58f435(0x2d6)]]['send']({[_0x4b5e32]:_0x2d090c});}});}function storeSettings(_0x10962e,_0x137033=![]){const _0x3839e6=_0x369d1e;_0x10962e={...settings,..._0x10962e};if(_0x137033&&_0x10962e[_0x3839e6(0x219)]!=_0x3839e6(0x1d2)&&_0x10962e[_0x3839e6(0x219)]!=_0x3839e6(0x285)&&_0x10962e[_0x3839e6(0x219)]!=''){const _0xa2e679=crypt[_0x3839e6(0x213)](secure[_0x3839e6(0x1cd)],_0x10962e[_0x3839e6(0x219)])[_0x3839e6(0x1e7)][_0x3839e6(0x2f7)]('@')[0x0],_0x2017dc=bcrypt[_0x3839e6(0x1c1)](_0xa2e679,saltRounds);_0x10962e={..._0x10962e,'bbPassword':_0x2017dc};}if(_0x137033&&_0x10962e[_0x3839e6(0x27d)]!=_0x3839e6(0x1d2)&&_0x10962e[_0x3839e6(0x27d)]!=_0x3839e6(0x285)&&_0x10962e[_0x3839e6(0x27d)]!=''){const _0x3028ce=crypt[_0x3839e6(0x213)](secure[_0x3839e6(0x1cd)],_0x10962e[_0x3839e6(0x27d)])[_0x3839e6(0x1e7)][_0x3839e6(0x2f7)]('@')[0x0];_0x10962e={..._0x10962e,'telegramToken':_0x3028ce};}const _0x5e956e=_0x10962e[_0x3839e6(0x27d)]!='************'&&_0x10962e[_0x3839e6(0x27d)]!=settings['telegramToken']||_0x10962e[_0x3839e6(0x295)]!=settings[_0x3839e6(0x295)],_0x10b455=_0x10962e[_0x3839e6(0x27d)]==''||_0x10962e['telegramUsername']=='';if(_0x5e956e)_0x10962e[_0x3839e6(0x2a4)]='all';for(const [_0x66c7e7,_0x5b4294]of Object[_0x3839e6(0x307)](_0x10962e)){if(_0x66c7e7=='telegramToken'&&_0x5b4294==_0x3839e6(0x1d2)){_0x10962e[_0x3839e6(0x27d)]=settings[_0x3839e6(0x27d)];continue;};if(_0x66c7e7=='bbPassword'&&_0x5b4294==_0x3839e6(0x1d2)){_0x10962e[_0x3839e6(0x219)]=settings[_0x3839e6(0x219)];continue;};dbSettings['set'](_0x3839e6(0x1c0)+_0x66c7e7,_0x5b4294)['write']();}settings=_0x10962e,io['to']('botmanager')[_0x3839e6(0x19c)](_0x3839e6(0x276),cleanSettings()),broadcastToBots(_0x3839e6(0x257),settings['timeshift']);if(_0x5e956e&&!_0x10b455)initTelegram();if(_0x5e956e&&_0x10b455)disableTelegram();getAllClients()[_0x3839e6(0x294)](_0x4af318=>{const _0xcc6769=_0x3839e6;getSocket(_0x4af318['id'])[_0xcc6769(0x19c)](_0xcc6769(0x1f1),{'access':{'allow':![],'reason':_0xcc6769(0x238),'token':null}});});}function updateSetting(_0x3be6c2,_0x249a74){const _0xbc9a7e=_0x369d1e;dbSettings[_0xbc9a7e(0x2b8)](_0xbc9a7e(0x1c0)+_0x3be6c2,_0x249a74)[_0xbc9a7e(0x312)](),settings=getSettings(),io['to'](_0xbc9a7e(0x19f))[_0xbc9a7e(0x19c)](_0xbc9a7e(0x276),cleanSettings());}function storeSecure(_0x5144f2){const _0x42d208=_0x369d1e;dbSecure['get'](_0x42d208(0x198))['push'](_0x5144f2)['write'](),secure=_0x5144f2;}function addBlacklist(_0x270577){const _0x234af7=_0x369d1e;cleanBlacklist();let _0x1e7b7c;devices[_0x270577][_0x234af7(0x2e7)]?_0x1e7b7c=Math['max'](devices[_0x270577]['telegramIpApproval'][_0x234af7(0x289)],loginExpiry):_0x1e7b7c=loginExpiry,dbSecure[_0x234af7(0x1c7)]('blacklist')[_0x234af7(0x1a0)]({'expiry':new Date()[_0x234af7(0x24a)]()+_0x1e7b7c*0x3c*0x3e8,'token':devices[_0x270577][_0x234af7(0x324)][_0x234af7(0x24e)]})[_0x234af7(0x312)](),blacklist=dbSecure[_0x234af7(0x1c7)](_0x234af7(0x332))['value']();}function cleanBlacklist(){const _0x19b819=_0x369d1e;let _0x4d77b9=dbSecure['get'](_0x19b819(0x332))[_0x19b819(0x2eb)]()['value'](),_0x76d1b=new Date()[_0x19b819(0x24a)]();_0x4d77b9['forEach'](_0x1ed118=>{const _0x9eaee7=_0x19b819;_0x1ed118['expiry']<_0x76d1b&&dbSecure[_0x9eaee7(0x1c7)]('blacklist')[_0x9eaee7(0x26f)]({'expiry':_0x1ed118[_0x9eaee7(0x289)]})[_0x9eaee7(0x312)]();});}function initStates(){const _0x2a6f15=_0x369d1e;let _0x3e2176=getConfiguration();_0x3e2176[_0x2a6f15(0x294)](_0x4d8ecd=>{const _0x3abcc4=_0x2a6f15;_0x4d8ecd['live']=_0x3abcc4(0x1c6);}),storeConfiguration(_0x3e2176);}function onKeys(){const _0x286b6f=new RSA();return new Promise(_0x1eb5da=>{const _0x3c0c7e=_0x10c0;_0x286b6f[_0x3c0c7e(0x1a6)]()['then'](_0x35f2d7=>{_0x1eb5da(_0x35f2d7);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4781d5=_0x369d1e;let _0x44c26c=getSettings(),_0x280051=![];!_0x44c26c[_0x4781d5(0x2d0)](_0x4781d5(0x1cb))&&(_0x44c26c['lastmsgtelegram']=0x0,_0x280051=!![]);!_0x44c26c[_0x4781d5(0x2d0)](_0x4781d5(0x2d3))&&(_0x44c26c[_0x4781d5(0x2d3)]=0x0,_0x280051=!![]);!_0x44c26c[_0x4781d5(0x2d0)]('latestversion')&&(_0x44c26c[_0x4781d5(0x1a4)]=_0x4781d5(0x2d1),_0x280051=!![]);if(_0x280051)storeSettings(_0x44c26c);}function storeConfiguration(_0x1a06f6){const _0x1648fb=_0x369d1e;dbConfig['get'](_0x1648fb(0x2cf))[_0x1648fb(0x26f)]()['write'](),_0x1a06f6[_0x1648fb(0x294)](_0x463032=>{const _0x34c25c=_0x1648fb;delete _0x463032[_0x34c25c(0x1cf)];}),dbConfig[_0x1648fb(0x1c7)](_0x1648fb(0x2cf))['push'](..._0x1a06f6)[_0x1648fb(0x312)](),config=_0x1a06f6;}function resetPassword(){const _0x4764f2=_0x369d1e;tgBot&&settings[_0x4764f2(0x18d)]&&(tgBot[_0x4764f2(0x30b)](_0x4764f2(0x2af)),tgBot[_0x4764f2(0x248)](settings[_0x4764f2(0x18d)],_0x4764f2(0x215),{'parse_mode':_0x4764f2(0x1ee),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x4764f2(0x2a3)},{'text':'no','callback_data':'no'}]]}})[_0x4764f2(0x1d7)](_0x11734a=>{telegramError(_0x11734a);}),tgBot['on'](_0x4764f2(0x2af),async _0x9953ee=>{const _0x53658d=_0x4764f2,_0x30d347=_0x9953ee[_0x53658d(0x1ce)],_0x5f3afb=_0x9953ee[_0x53658d(0x1e7)];tgBot[_0x53658d(0x32f)](_0x9953ee['id'])[_0x53658d(0x301)](async()=>{const _0x1f4f7c=_0x53658d;if(_0x30d347!='no'){const _0x50b4a0=0xf,_0xa9a8fd=_0x1f4f7c(0x30a),_0x403245=Array[_0x1f4f7c(0x25d)](crypto[_0x1f4f7c(0x2f1)](new Uint32Array(_0x50b4a0)))['map'](_0x554880=>_0xa9a8fd[_0x554880%_0xa9a8fd[_0x1f4f7c(0x1c5)]])[_0x1f4f7c(0x308)](''),_0x18ee7c=bcrypt['hashSync'](_0x403245,saltRounds);storeSettings({'bbPassword':_0x18ee7c}),await tgBot[_0x1f4f7c(0x248)](_0x5f3afb[_0x1f4f7c(0x32e)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x403245,{'parse_mode':_0x1f4f7c(0x1ee)})[_0x1f4f7c(0x1d7)](_0x463e07=>{telegramError(_0x463e07);});}else await tgBot['sendMessage'](_0x5f3afb['chat']['id'],_0x1f4f7c(0x26a))[_0x1f4f7c(0x1d7)](_0x34667e=>{telegramError(_0x34667e);});}),tgBot[_0x53658d(0x30b)](_0x53658d(0x2af));}));}async function confirmRestore(_0x4ec756,_0x5b75d8){const _0x537a8e=_0x369d1e;tgBot&&settings[_0x537a8e(0x18d)]&&(tgBot[_0x537a8e(0x30b)](_0x537a8e(0x2af)),await tgBot[_0x537a8e(0x248)](settings[_0x537a8e(0x18d)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x537a8e(0x1ee),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x46c7e4=>{telegramError(_0x46c7e4);}),tgBot['on']('callback_query',async _0x67213b=>{const _0x470a42=_0x537a8e,_0x397442=_0x67213b[_0x470a42(0x1ce)],_0x1acad2=_0x67213b['message'];tgBot[_0x470a42(0x32f)](_0x67213b['id'])[_0x470a42(0x301)](async()=>{const _0x19ca20=_0x470a42;_0x397442==_0x19ca20(0x2a3)?(await tgBot[_0x19ca20(0x248)](_0x1acad2[_0x19ca20(0x32e)]['id'],_0x19ca20(0x263),{'parse_mode':_0x19ca20(0x1ee)})['catch'](_0xc800ab=>{telegramError(_0xc800ab);}),unzipFile(_0x4ec756,_0x5b75d8)):await tgBot[_0x19ca20(0x248)](_0x1acad2[_0x19ca20(0x32e)]['id'],_0x19ca20(0x1f3))[_0x19ca20(0x1d7)](_0x286821=>{telegramError(_0x286821);});}),tgBot[_0x470a42(0x30b)](_0x470a42(0x2af));}));}function getServerTime(){const _0x540a8c=_0x369d1e,_0x3b01b3=new Date();return _0x3b01b3['getFullYear']()+'/'+(_0x3b01b3[_0x540a8c(0x221)]()+0x1)[_0x540a8c(0x2c7)]()['padStart'](0x2,'0')+'/'+_0x3b01b3[_0x540a8c(0x1f8)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3b01b3[_0x540a8c(0x293)]()['toString']()[_0x540a8c(0x20b)](0x2,'0')+':'+_0x3b01b3[_0x540a8c(0x299)]()[_0x540a8c(0x2c7)]()[_0x540a8c(0x20b)](0x2,'0')+':'+_0x3b01b3[_0x540a8c(0x18f)]()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x58b21f=_0x369d1e,_0x240e23=shiftedTime();return _0x240e23[_0x58b21f(0x29a)]()+'/'+(_0x240e23[_0x58b21f(0x221)]()+0x1)[_0x58b21f(0x2c7)]()[_0x58b21f(0x20b)](0x2,'0')+'/'+_0x240e23[_0x58b21f(0x1f8)]()['toString']()[_0x58b21f(0x20b)](0x2,'0')+'\x20'+_0x240e23[_0x58b21f(0x293)]()[_0x58b21f(0x2c7)]()[_0x58b21f(0x20b)](0x2,'0')+':'+_0x240e23['getMinutes']()[_0x58b21f(0x2c7)]()[_0x58b21f(0x20b)](0x2,'0')+':'+_0x240e23['getSeconds']()[_0x58b21f(0x2c7)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x1c97f1=_0x369d1e,_0x4fea8e=new Date();let _0x496ca1=_0x4fea8e;if(settings[_0x1c97f1(0x257)]&&settings[_0x1c97f1(0x257)]!==0x0)_0x496ca1=fns['add'](_0x4fea8e,{'hours':settings[_0x1c97f1(0x257)]});return _0x496ca1;}function startScheduler(){const _0x35450c=_0x369d1e,_0x54dacd=new Date()[_0x35450c(0x302)](),_0x97fc7e=shiftedTime()['getHours']();_0x97fc7e==0x4&&backupConfigFiles();_0x97fc7e==0x0&&rotateLogFiles();_0x54dacd%0x6==0x0&&triggerAnalytics();_0x54dacd%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x306650=_0x369d1e;fs[_0x306650(0x2cd)](configpath,{'withFileTypes':!![]})[_0x306650(0x294)](_0x1cfdde=>{const _0x30502b=_0x306650;if(!_0x1cfdde['isDirectory']())fs[_0x30502b(0x316)](configpath+_0x1cfdde[_0x30502b(0x2da)],configbackuppath+_0x1cfdde['name']);});}function rotateLogFiles(){const _0x5784c3=_0x369d1e,_0x19816d=fs['statSync'](logspath+_0x5784c3(0x1f5)),_0x489f86=_0x19816d[_0x5784c3(0x288)]/0x400;if(_0x489f86>0x32){let _0x294093=fs[_0x5784c3(0x2cd)](logspath,{'withFileTypes':!![]});_0x294093['sort']((_0x1466e0,_0x211d3c)=>_0x1466e0[_0x5784c3(0x2da)]<_0x211d3c[_0x5784c3(0x2da)]?0x1:_0x211d3c[_0x5784c3(0x2da)]<_0x1466e0['name']?-0x1:0x0),_0x294093['forEach'](_0x589893=>{const _0x3e11a0=_0x5784c3;if(_0x589893['name']==_0x3e11a0(0x28e))fs[_0x3e11a0(0x316)](logspath+_0x589893[_0x3e11a0(0x2da)],logspath+_0x3e11a0(0x1ba));if(_0x589893[_0x3e11a0(0x2da)]=='output-001.log')fs[_0x3e11a0(0x316)](logspath+_0x589893[_0x3e11a0(0x2da)],logspath+'output-002.log');_0x589893['name']=='output-000.log'&&(fs[_0x3e11a0(0x316)](logspath+_0x589893['name'],logspath+_0x3e11a0(0x1db)),fs[_0x3e11a0(0x250)](logspath+_0x589893[_0x3e11a0(0x2da)],''));});}}async function zipFiles(_0x2e16cc){const _0x19fe5f=_0x369d1e;let _0x24bd24;if(_0x2e16cc=='logs')_0x24bd24=logspath;if(_0x2e16cc=='backup')_0x24bd24=configpath;let _0x5230a3=fs['readdirSync'](_0x24bd24,{'withFileTypes':!![]});const _0x15f298=new require(_0x19fe5f(0x26c))();_0x5230a3[_0x19fe5f(0x294)](_0x4acb2=>{const _0x454ca0=_0x19fe5f;if(!_0x4acb2[_0x454ca0(0x206)]()){let _0x5bada8=fs[_0x454ca0(0x32d)](_0x24bd24+_0x4acb2[_0x454ca0(0x2da)]);const _0x5f4891=/^bot-[0-9]{3}-config.json$/,_0x408a6f=_0x5f4891[_0x454ca0(0x1c2)](_0x4acb2[_0x454ca0(0x2da)]);if(_0x408a6f){const _0x101384=JSON['parse'](_0x5bada8);_0x101384[_0x454ca0(0x246)][0x0]['apiKey']=_0x454ca0(0x285),_0x101384[_0x454ca0(0x246)][0x0][_0x454ca0(0x2dd)]='***',_0x5bada8=JSON[_0x454ca0(0x222)](_0x101384,null,0x2);}if(_0x4acb2[_0x454ca0(0x2da)]==_0x454ca0(0x286)){const _0x487e9d=JSON[_0x454ca0(0x1ea)](_0x5bada8);if(_0x487e9d[_0x454ca0(0x276)][_0x454ca0(0x191)])_0x487e9d[_0x454ca0(0x276)]['loginRequired']=![];if(_0x487e9d['settings'][_0x454ca0(0x219)])_0x487e9d[_0x454ca0(0x276)]['bbPassword']=_0x454ca0(0x285);if(_0x487e9d[_0x454ca0(0x276)][_0x454ca0(0x27d)])_0x487e9d[_0x454ca0(0x276)][_0x454ca0(0x27d)]=_0x454ca0(0x285);if(_0x487e9d[_0x454ca0(0x276)][_0x454ca0(0x18d)])_0x487e9d[_0x454ca0(0x276)]['telegramChatId']=null;_0x5bada8=JSON[_0x454ca0(0x222)](_0x487e9d,null,0x2);}if(_0x4acb2[_0x454ca0(0x2da)]!=_0x454ca0(0x2a1))_0x15f298[_0x454ca0(0x230)](_0x4acb2['name'],_0x5bada8);}});const _0x33c382=_0x15f298[_0x19fe5f(0x262)]({'base64':![],'compression':_0x19fe5f(0x336)});fs[_0x19fe5f(0x250)](zippath+(_0x2e16cc+_0x19fe5f(0x320)),_0x33c382,_0x19fe5f(0x310));}async function unzipFile(_0x3526c9,_0x4be788){const _0x381d15=_0x369d1e;await backupConfigFiles(),fs[_0x381d15(0x2cd)](configpath,{'withFileTypes':!![]})[_0x381d15(0x294)](_0x46f5cd=>{const _0xeeaf06=_0x381d15;if(!_0x46f5cd[_0xeeaf06(0x206)]())fs[_0xeeaf06(0x28b)](configpath+_0x46f5cd['name']);});const _0x2b0cc5=fs[_0x381d15(0x32d)](_0x3526c9+_0x4be788,_0x381d15(0x310)),_0x40bd3c=new require(_0x381d15(0x26c))(_0x2b0cc5,{'base64':![],'checkCRC32':!![]});Object[_0x381d15(0x25e)](_0x40bd3c['files'])['forEach'](_0xb0e49f=>{const _0x41454a=_0x381d15,_0x1d1fcb=_0x40bd3c[_0x41454a(0x1e6)][_0xb0e49f];fs[_0x41454a(0x250)](configpath+_0x1d1fcb['name'],_0x1d1fcb[_0x41454a(0x29d)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x381d15(0x294)](_0x1279f5=>{const _0x51085b=_0x381d15;if(!_0x1279f5['isDirectory']())fs[_0x51085b(0x28b)](temppath+_0x1279f5[_0x51085b(0x2da)]);}),process[_0x381d15(0x24d)]({'restore':!![]},_0x3e9a03=>{});}async function getPublicIp(){const _0xa37562=_0x369d1e;try{const _0x1b2700=await axios[_0xa37562(0x1c7)]('https://api.ipify.org?format=json');publicip=_0x1b2700['data']['ip'];}catch(_0x1347b3){}}function _0x214c(){const _0x34fc40=['allow','Unauthorized\x20attempt\x20to\x20add\x20bot','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','$1_$2_$3','21088pBMyrV','1000','RSA','showname','build','inherit','-performance.json','static','file','RSA-OAEP','headless','live','hybrid-crypto-js','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','date-fns','reload','all','backupfile','params','sendFile','/help\x20-\x20show\x20available\x20commands\x0a','Orders','ipc','warning','temporary\x20access\x20rejected','bbvNew','Notifications\x20enabled','apply','compareSync','bot','verify','sendMessage','No\x20authentication\x20token','getTime','cancelLoading','config/','send','token','temp/','writeFileSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','All','mkdirSync','child_process',':\x20Bot\x20Mgr\x20>\x20','timeshift','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','-----------------------------------------------------------------------------------','temporary\x20token\x20generated','lowdb','replace','from','keys','placeOrder','startsWith','Unauthorized\x20attempt\x20to\x20delete\x20alerts','generate','Restoring\x20bot(s)\x20from\x20backup','490855SzpMpG','get-starting-balances','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','delete-alerts','Ok,\x20will\x20send\x20alert\x20notifications\x20only','place-order','Password\x20reset\x20rejected','/:bot/performance','node-zip','Unauthorized\x20attempt\x20to\x20get\x20messages','createWriteStream','remove','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','encryptedUuid','uncaughtException','2FA\x20login\x20rejected','temporary\x20access\x20timeout','All\x20bots','settings','host','/download/:type','</b>\x20?','add-bot','isValid','match','telegramToken','Unauthorized\x20login\x20attempt\x20(timeout)','36kismCx','\x20to\x20','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','sockets','use','***','bb-settings.json','bot.js','size','expiry','<b>Balance\x20Bot\x20Status:</b>\x0a','rmSync','notification','publicKey','output-002.log','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','password','telegramEnabled','Access\x20enabled\x20for\x20','getHours','forEach','telegramUsername','\x20(1)','toggle-bot-mode','f2aRequired','getMinutes','getFullYear','-events.json','show','_data','sha256','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Unauthorized\x20attempt\x20to\x20store\x20configuration','bb-secure.json','\x20minutes','yes','telegramEvents','1176470AZaJIN','404\x20Not\x20Found','request','bcryptjs','socket.io','format','constructor','path','kill','env','callback_query','socket','exp','telegram2FaApproval','update-bot','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20log\x20out','confirm-message','/output-000.log','set','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Login\x20rejected','access\x20timeout','stopPolling','/off\x20-\x20stop\x20bot(s)\x0a','emitHistory','Token\x20blacklisted','defaults','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','order','disconnect','slice','headers','alerts','toString','Your\x20installation\x20is\x20already\x20up\x20to\x20date','bbUsername','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','server','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','readdirSync','download','bots','hasOwnProperty','0.0.0','handshake','lastmsgemitted','referer','\x20>\x20','botID','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','exit','Notifications\x20disabled','name','store','Notifications\x20disabled\x0a','apiSecret','Notifications\x20types:\x20','bb-config.json','running','mixpanel','bot-','sign','botname','whitelist','enabled','telegramIpApproval','Invalid\x20Telegram\x20token','stop','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','cloneDeep','yargs/yargs','2FA\x20login\x20token\x20generated','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','2502640nWRYyI','createServer','randomFillSync','-config.json','logout','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','/:bot','split','Unauthorized\x20attempt\x20to\x20delete\x20bot','zip/','/:bot/configuration','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Error:\x20Invalid\x20argument\x20','timestamp','removeAllListeners','accept','Bot\x20','then','getUTCHours','Unauthorized\x20attempt\x20to\x20update\x20settings','track','randomBytes','ipaddr.js','entries','join','Unauthorized\x20attempt\x20to\x20update\x20bot','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','removeListener','/:bot/history','/:bot/coins','onText','auto','binary','userid','write','build2','/on\x20-\x20start\x20bot(s)\x0a','error\x20while\x20deleting\x20config\x20files:\x20','copyFileSync','clients','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','(((.+)+)+)+$','starting\x20bot\x20|\x20Bot\x20','pidRefreshToken','clientip','toIPv4MappedAddress','Login\x20accepted','get-portfolio','.zip','started','Invalid\x20IP\x20address','/:bot/portfolio','access','Temporary\x20access\x20rejected','deleteHistoryAlerts','15\x20min','::ffff:127.0.0.1','login\x20token\x20generated','version.json','Unauthorized\x20attempt\x20to\x20download\x20','error','readFileSync','chat','answerCallbackQuery','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','blacklist','manual','enabled\x20Bot\x20','pidExpireLogin','DEFLATE','Invalid\x20authentication\x20token\x20(1)','orders','connection','graphql-request','telegramChatId','Allow\x20login\x20from\x20IP\x20address\x20<b>','getSeconds','3000','loginRequired','sortBy','2FA\x20login\x20required','bbvReceive','2EfxnCe','storeConfiguration','exec','secure','1187094sbWfhR','listen','tkn','emit','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','botmanager','push','storeHeadless','new-disabled','axios','latestversion','-results.json','generateKeyPairAsync','cancel-loading','logged\x20out','version','fork','No\x20bots\x20running\x20right\x20now','assign','/:bot/support','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','login','jsonwebtoken','logs/','Notifications\x20enabled\x0a','secret','argv','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','showConfig','hex','ipv6','once','output-003.log','index.html','invalid\x20credentials','filter','login\x20not\x20required','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','settings.','hashSync','test','8169651SkmLrr','util','length','stopped','get','new','disabled','find','lastmsgtelegram','unlinkSync','privateKey','data','mode','remoteAddress','\x20|\x20','************','Invalid\x20username\x20or\x20IP\x20address','function','10kCElzG','uuid','catch','update-bb','temporaryAccessAllowed','kind','output-001.log','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','value','getStartingBalances','127.0.0.1','Yes','type','full','\x20mode','reason','2FA\x20required','files','message','3950859zovtIJ','auth','parse','NTBA_FIX_319','simple','crypto','HTML','2169EYcLWS','event','status','2FA','Restore\x20process\x20aborted','uuid-random','output-000.log','/disable\x20-\x20disable\x20notifications\x0a','user','getDate','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','restart','conn','store-headless','username','number','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','success','Alerts','log','existsSync','isDirectory','telegram','All\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','30\x20min','padStart','api-eu.mixpanel.com','reject','lowdb/adapters/FileSync','SIGINT','connected','includes','telegrammsg','decrypt','node-telegram-bot-api','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','search','Markdown','messages','bbPassword','Server','Bot\x20Mgr\x20>\x20','\x20(2)','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','disabled\x20Bot\x20','get-messages','bb/','getMonth','stringify','toggleBotMode'];_0x214c=function(){return _0x34fc40;};return _0x214c();}async function triggerAnalytics(){const _0x245344=_0x369d1e;if(!publicip)await getPublicIp();const _0x4dd1e9=getBotsWithMode();let _0x564d2c=0x0;_0x4dd1e9[_0x245344(0x294)](_0x1203ba=>{const _0x1e846c=_0x245344;if(_0x1203ba[_0x1e846c(0x1f1)]===_0x1e846c(0x2e6))_0x564d2c++;}),mixpanel[_0x245344(0x304)](_0x245344(0x21a),{'distinct_id':settings[_0x245344(0x311)],'ip':publicip,'version':serverversion,'numbots':_0x4dd1e9['length'],'numbotsenabled':_0x564d2c});}async function getMessages(){const _0x548009=_0x369d1e,_0x208394=_0x548009(0x2ca),_0x1cffa1=new GraphQLClient(_0x208394),_0x11e504={'authorization':_0x548009(0x318)},_0x4afe7c=serverversion[_0x548009(0x2f7)]('.'),_0x5a55b9=_0x4afe7c[0x0]+'.'+_0x4afe7c[0x1],_0x5895f5=Math['min'](settings[_0x548009(0x1cb)],settings[_0x548009(0x2d3)]),_0x3ee11d={'last':parseInt(_0x5895f5),'bbm':_0x5a55b9},_0x12de6b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4ab83e;try{_0x4ab83e=await _0x1cffa1[_0x548009(0x2a7)](_0x12de6b,_0x3ee11d,_0x11e504);}catch(_0x224048){}if(_0x4ab83e&&_0x4ab83e[_0x548009(0x218)]){let _0x1b4119=settings[_0x548009(0x1cb)];newMessages=[];for(const _0x1d0d41 of _0x4ab83e['messages']){newMessages[_0x548009(0x1a0)](_0x1d0d41);if(_0x1d0d41['bbvNew'])updateSetting(_0x548009(0x1a4),_0x1d0d41[_0x548009(0x242)]);let _0x102282=_0x1d0d41['bbvNew']?serverversion>=_0x1d0d41[_0x548009(0x242)]:![];if(!_0x102282&&_0x1d0d41[_0x548009(0x200)]>_0x1b4119){if(_0x1d0d41['bbvReceive']==='any'||serverversion[_0x548009(0x260)](_0x1d0d41[_0x548009(0x194)])){let _0x36f296=''+_0x1d0d41['title']+'\x0a\x0a'+_0x1d0d41['message'];const _0x4defb6=await sendTelegramMsg(toTelegramMarkdown(_0x36f296),_0x548009(0x217));if(_0x4defb6)_0x1b4119=_0x1d0d41[_0x548009(0x200)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x548009(0x1cb),_0x1b4119),emitMessages();}}function emitMessages(){const _0x4826e1=_0x369d1e,_0x1ddcf5=settings[_0x4826e1(0x2d3)];let _0x2b4abb=[];newMessages[_0x4826e1(0x294)](_0x527ad8=>{const _0x5a1985=_0x4826e1;_0x527ad8[_0x5a1985(0x200)]>_0x1ddcf5&&_0x2b4abb[_0x5a1985(0x1a0)](_0x527ad8);}),_0x2b4abb[_0x4826e1(0x1c5)]>0x0&&getAllClients()[_0x4826e1(0x294)](_0x44e7c9=>{const _0x123dca=_0x4826e1;getSocket(_0x44e7c9['id'])[_0x123dca(0x19c)]('message',_0x2b4abb);});}function confirmMessage(_0x108e80){updateSetting('lastmsgemitted',Number(_0x108e80));}function isNewerVersion(_0x2b3e0c,_0x28ee67){const _0x16d97b=_0x369d1e,_0x256cca=_0x28ee67[_0x16d97b(0x2f7)]('.'),_0x2d1851=_0x2b3e0c[_0x16d97b(0x2f7)]('.');for(var _0x3cee08=0x0;_0x3cee08<_0x2d1851[_0x16d97b(0x1c5)];_0x3cee08++){const _0x11229a=~~_0x2d1851[_0x3cee08],_0x3d90d7=~~_0x256cca[_0x3cee08];if(_0x11229a>_0x3d90d7)return!![];if(_0x11229a<_0x3d90d7)return![];}return![];}function toTelegramMarkdown(_0x462922){const _0x401bc2=_0x369d1e,_0x341663=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x66c2bf=/\*{2}(.+?)\*{2}/gim;return _0x462922=_0x462922[_0x401bc2(0x25c)](_0x341663,_0x401bc2(0x227))[_0x401bc2(0x25c)](_0x66c2bf,'*$1*'),_0x462922;}async function validateConfigFile(){const _0x2092a8=_0x369d1e,_0x1cc914=dbConfig['get'](_0x2092a8(0x2cf))['sortBy'](_0x2092a8(0x2d6))[_0x2092a8(0x1dd)]()||[];if(_0x1cc914['length']==0x0){let _0x2cfae9=0x0,_0x2bdb94=[];const _0x24d720=/^bot-([0-9]{3})-config.json$/,_0x5efaef=fs[_0x2092a8(0x2cd)](configpath);_0x5efaef[_0x2092a8(0x294)](_0x49fe28=>{const _0x5b031c=_0x2092a8,_0xf7c74e=_0x24d720[_0x5b031c(0x197)](_0x49fe28);if(_0xf7c74e){const _0x32cb79=_0xf7c74e[0x1];let _0x47fe48=getBotAttributes(_0x32cb79);_0x2bdb94[_0x5b031c(0x1a0)]({'botID':_0x32cb79,'botname':_0x47fe48['botname'],'status':_0x5b031c(0x1c9),'live':_0x5b031c(0x1c6)}),_0x2cfae9++;}}),_0x2cfae9!=0x0&&(dbConfig['get'](_0x2092a8(0x2cf))[_0x2092a8(0x1ac)](_0x2bdb94)['write'](),config=_0x2bdb94,restoredConfigFile=_0x2cfae9);}}async function restoreConfigNotify(_0x2f9d44){const _0x50fb94=_0x369d1e;let _0x45a303;if(restoredConfigFile==0x1)_0x45a303=_0x50fb94(0x1b5);else _0x45a303=_0x50fb94(0x330);if(_0x2f9d44)io['to'](_0x50fb94(0x19f))['emit'](_0x50fb94(0x28c),_0x45a303);else{logger[_0x50fb94(0x1ec)](_0x50fb94(0x259)),logger['simple'](_0x45a303),logger[_0x50fb94(0x1ec)](_0x50fb94(0x259)),logger[_0x50fb94(0x1ec)]('');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x50fb94(0x18a))tgBot['sendMessage'](settings['telegramChatId'],_0x50fb94(0x21b)+_0x45a303)[_0x50fb94(0x1d7)](_0x1ced0d=>{telegramError(_0x1ced0d);});}}function validateCredentials(_0x5d3a71,_0x2dfa9a){const _0x594b08=_0x369d1e;if(_0x5d3a71[_0x594b08(0x1ff)]==settings[_0x594b08(0x2c9)]&&bcrypt[_0x594b08(0x245)](_0x5d3a71[_0x594b08(0x290)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x594b08(0x193),'token':null};else{const _0x8571b=generateLoginToken(_0x2dfa9a);return{'allow':!![],'reason':_0x594b08(0x329),'token':_0x8571b};}}else return{'allow':![],'reason':_0x594b08(0x1bc),'token':null};}function refreshToken(_0x15c304){const _0x447d3a=_0x369d1e,_0x10a255=generateLoginToken(_0x15c304);return{'allow':!![],'reason':_0x447d3a(0x329),'token':_0x10a255};}function validateAccess(_0x22e971,_0x101bcf,_0x26e4e7){const _0x58fc4c=_0x369d1e,_0x21dd38=_0x26e4e7?_0x26e4e7:devices[_0x101bcf]['ip'];let _0x593be7;const _0x2a9de3=_0x52c2ff=>{const _0x3a6ef2=_0x10c0;if(settings[_0x3a6ef2(0x191)]){if(settings[_0x3a6ef2(0x298)]){if(telegram2FaApproved(_0x101bcf)){const _0x1e9350=generateLoginToken(_0x101bcf);return{'allow':!![],'reason':_0x3a6ef2(0x2ed),'token':_0x1e9350};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x593be7=validToken(_0x52c2ff,_0x101bcf),_0x593be7['hasOwnProperty'](_0x3a6ef2(0x202))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x52c2ff}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x3a6ef2(0x1be),'token':null};};if(settings['whitelistEnabled']){let _0x370d8c=[...settings[_0x58fc4c(0x2e5)],'::1',_0x58fc4c(0x328),_0x58fc4c(0x1df)];if(_0x370d8c['includes'](_0x21dd38))return _0x2a9de3(_0x22e971);else{_0x593be7=validToken(_0x22e971,_0x101bcf);if(_0x593be7[_0x58fc4c(0x2d0)](_0x58fc4c(0x202)))return _0x2a9de3(_0x22e971);else{if(telegramIpApproved(_0x101bcf)){const _0x3abd52=generateToken(_0x101bcf);return _0x593be7=_0x2a9de3(_0x22e971),_0x593be7[_0x58fc4c(0x224)]?{'allow':!![],'reason':_0x58fc4c(0x25a),'token':_0x3abd52}:_0x593be7;}else return settings[_0x58fc4c(0x1d9)]?{'allow':![],'reason':_0x58fc4c(0x1e5),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x2a9de3(_0x22e971);}function timelyDecrypt(_0x1f60bc,_0xc1a5cd=!![]){const _0x12cff6=_0x369d1e;if(_0x1f60bc)try{const _0x5d4c99=crypt[_0x12cff6(0x213)](secure['privateKey'],_0x1f60bc)[_0x12cff6(0x1e7)],_0x454c6b=_0x5d4c99[_0x12cff6(0x2f7)]('@')[0x0],_0x131c4c=_0x5d4c99[_0x12cff6(0x2f7)]('@')[0x1],_0x5a24ce=new Date()[_0x12cff6(0x24a)]();if(_0xc1a5cd){if(_0x5a24ce-_0x131c4c<maxSecretAge*0x3e8)return _0x454c6b;else return![];}else return _0x454c6b;}catch(_0x5b4046){return![];}else return![];}const validToken=(_0x251b0e,_0x54e96c)=>{const _0x23f912=_0x369d1e,_0x401ce2=devices[_0x54e96c]['ip'];if(!_0x251b0e)return{'error':_0x23f912(0x249)};for(let _0x42ff49 of blacklist){if(_0x42ff49[_0x23f912(0x24e)]==_0x251b0e)return{'error':_0x23f912(0x2bf)};}let _0x315370;try{_0x315370=jwt[_0x23f912(0x247)](_0x251b0e,secure['secret']+_0x54e96c);}catch{return{'error':_0x23f912(0x337)};}if(!_0x315370[_0x23f912(0x2d0)]('clientip')&&!_0x315370[_0x23f912(0x2d0)](_0x23f912(0x1ff))||!_0x315370[_0x23f912(0x2d0)](_0x23f912(0x2b1)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x315370[_0x23f912(0x2d0)]('username')&&_0x315370[_0x23f912(0x2d0)](_0x23f912(0x31c))){const {clientip:_0x4caf14}=_0x315370;return _0x401ce2==_0x4caf14?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x23f912(0x322)};}else{if(_0x315370[_0x23f912(0x2d0)]('username')&&_0x315370[_0x23f912(0x2d0)](_0x23f912(0x31c))){const {username:_0x2f11fe,clientip:_0x7e4890}=_0x315370;return settings[_0x23f912(0x2c9)]==_0x2f11fe&&_0x401ce2==_0x7e4890?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x23f912(0x1d3)};}}},generateLoginToken=_0x131e21=>{const _0x386682=_0x369d1e;if(_0x131e21){const _0x349b4d=devices[_0x131e21]['ip'];return jwt[_0x386682(0x2e3)]({'username':settings[_0x386682(0x2c9)],'clientip':_0x349b4d},secure[_0x386682(0x1b3)]+_0x131e21,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x53fd31=>{const _0x369d37=_0x369d1e;if(_0x53fd31){const _0x284e04=devices[_0x53fd31]['ip'];return jwt['sign']({'clientip':_0x284e04},secure['secret']+_0x53fd31,{'expiresIn':devices[_0x53fd31][_0x369d37(0x2e7)][_0x369d37(0x289)]*0x3c});}else return![];},telegramIpApproved=_0x46869c=>{const _0x31e6be=_0x369d1e;let _0x21f041=![];return devices[_0x46869c][_0x31e6be(0x2e7)]&&devices[_0x46869c][_0x31e6be(0x2e7)]['expiry']!=_0x31e6be(0x20d)&&(_0x21f041=devices[_0x46869c][_0x31e6be(0x2e7)][_0x31e6be(0x31c)]==devices[_0x46869c]['ip']&&new Date()[_0x31e6be(0x24a)]()-devices[_0x46869c]['telegramIpApproval'][_0x31e6be(0x2fd)]<devices[_0x46869c][_0x31e6be(0x2e7)][_0x31e6be(0x289)]*0x3c*0x3e8),_0x21f041;},telegram2FaApproved=_0x2c802f=>{const _0x5eb5c2=_0x369d1e;let _0x443866=![];return devices[_0x2c802f][_0x5eb5c2(0x2b2)]&&devices[_0x2c802f][_0x5eb5c2(0x2b2)][_0x5eb5c2(0x289)]!='reject'&&(_0x443866=devices[_0x2c802f][_0x5eb5c2(0x2b2)][_0x5eb5c2(0x31c)]==devices[_0x2c802f]['ip']&&new Date()[_0x5eb5c2(0x24a)]()-devices[_0x2c802f]['telegram2FaApproval'][_0x5eb5c2(0x2fd)]<devices[_0x2c802f]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x443866;},normalizeIP=_0x51cffb=>{const _0x571766=_0x369d1e;let _0x1f5c5f=null,_0x14ce70=null;if(ipaddr[_0x571766(0x27b)](_0x51cffb)){const _0x33962f=ipaddr[_0x571766(0x1ea)](_0x51cffb);_0x33962f[_0x571766(0x1da)]()===_0x571766(0x1b8)?(_0x33962f[_0x571766(0x281)]()&&(_0x1f5c5f=_0x33962f['toIPv4Address']()[_0x571766(0x2c7)]()),_0x14ce70=_0x33962f['toString']()):(_0x1f5c5f=_0x33962f[_0x571766(0x2c7)](),_0x14ce70=_0x33962f[_0x571766(0x31d)]()[_0x571766(0x2c7)]());}return{'show':_0x1f5c5f?_0x1f5c5f:_0x14ce70,'store':_0x14ce70};};function sleep(_0x5242f8){return new Promise(_0x4a444d=>setTimeout(_0x4a444d,_0x5242f8));}