const _0x5b7969=_0x303c;function _0x2e7a(){const _0x5f3d0c=['backup-full@','mixpanel','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','off_','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','error','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','private','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','connection','Bot\x20Mgr\x20>\x20','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Access\x20enabled\x20for\x20','close','Restarting\x20Bot\x20','chat','update-bb','2432395KnqCTK','then','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Starting\x20(','reset-history','server','Unauthorized\x20attempt\x20to\x20download\x20','backupfile','mode','forEach','output-001.log','backup/','Starting\x20new\x20bot\x20|\x20Bot\x20','listen','/upload-backup','timeshift','/off\x20-\x20stop\x20bot(s)\x0a','headers','temporary\x20access\x20rejected','.zip','update_yes','production','orders','All\x20bots','telegram2FaApproval','getDate','api-eu.mixpanel.com','/on\x20-\x20start\x20bot(s)\x0a','temp/','botname','telegramChatId','You\x20can\x20use\x20the\x20following\x20commands:\x0a','apiKey','Unauthorized\x20attempt\x20to\x20get\x20messages','latestversion','request','backup-full','enabled','\x20(2)','\x1b[33m','getPortfolio','telegramEvents','track','tempaccess_reject_','toString','number',':\x20Bot\x20Mgr\x20>\x20','order','Login\x20rejected','add','Temporary\x20access\x20rejected','2FA\x20required','Unauthorized\x20attempt\x20to\x20get\x20events','#RES#\x20if\x20running\x20on\x20server','cancelLoading','\x20|\x20user:\x20...','getMonth','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','reason','Unauthorized\x20attempt\x20to\x20delete\x20bot','static','=>\x20Go\x20to\x20#CYA#http://',')\x20\x20\x20|\x20Bot\x20','hex','log','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Alerts','Password\x20reset\x20rejected','Starting\x20#RED#Balance\x20Bot\x20v','-config.json','exp','http','length','mkdirSync','file','onepagemode','\x20mode','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','status','secure','port','2FA\x20login\x20rejected','emitHistory','createWriteStream','family','privateKey','14409xNvAeA','post','login\x20token\x20generated','type','address','timestamp','alerts','environment','temporary\x20access\x20not\x20allowed','toggle_','success','metrics_','command','\x1b[0m','push','telegramEnabled','logs/','config/','Starting\x20Balance\x20Bot\x20reinstallation','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','2FA\x20login\x20required','No\x20bots\x20running\x20right\x20now','place-order','format','initclient','function','text','handshake','referer','temporary\x20token\x20generated','\x20(1)','/start','keys','env','backup-files','/:bot/performance','show','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','date-fns','restore_no_','get-backup-files','portfolio','storeFiat','full','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','reject','https://api.ipify.org?format=json','update','inlineKeyboard','storeHeadless','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20get\x20portfolio','apiPassword','login2fa_reject_','config_all','bot','Restore\x20backup\x20file\x20','rmSync','express-fileupload','stopped','getHours','callback','2FA','::1','Enabled\x20Bot\x20','HTML','99298RWLLHY','sortBy','readdirSync','min','*$1*','Node.js\x20v','sendPortfolioTelegram','find','************','Error:\x20Invalid\x20argument\x20','user','logs','\x1b[31m','alias','existsSync','<b>Balance\x20Bot\x20Status:</b>\x0a','value','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','allow','child_process','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','getUTCHours','Bot\x20','sendMessage','\x20|\x20client:\x20...','add-bot','path','conn','remove','ipc','Unauthorized\x20attempt\x20to\x20log\x20out','bot-','\x20|\x20','output-002.log','reinstall_no','help','get-starting-balances','-----------------------------------------------------------------------------------','30\x20min','getMinutes','Unauthorized\x20attempt\x20to\x20store\x20configuration','3000','includes','socket','login\x20not\x20required','f2aRequired','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','editMessageReplyMarkup','parse','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','action','Notifications\x20disabled\x0a','connected','blacklist','emit','endsWith','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','args','string','Unauthorized\x20attempt\x20to\x20update\x20settings',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','names','updatebotmanager','/download/:type','expiry','505742NbQmbH','config_alerts','use','manual','lastmsgemitted','15\x20min','headless','debug','DEFLATE','restart','8EjRCww','hashSync','live','/status\x20-\x20show\x20bot(s)\x20status\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','message','sendMetricsTelegram','\x1b[36m','Notifications\x20types:\x20','0.0.0','tempaccess_5_','All\x20bots\x20running\x20right\x20now','reinstall','bbPassword','auth','verify','Notifications\x20enabled','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','pidRefreshToken','any','whitelistEnabled','store-fiat','Error\x20removing\x20old\x20backup\x20files:','Restoring\x20bot(s)\x20from\x20backup','delete-alerts','event','staging','version.json','build2','uuid','apply','fork','button','Network\x20Interfaces:','Unauthorized\x20attempt\x20to\x20confirm\x20message','exec','join','Error\x20while\x20deleting\x20config\x20files:\x20','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','argv','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','zip/','catch','/:bot/history','reply','Session\x20expired\x20for\x20user\x20...','All','simple','botmanager','backup','userid',',\x20must\x20be\x20a\x204\x20digit\x20number','Failed\x20to\x20download\x20','isDirectory','binary','/enable\x20-\x20enable\x20notifications\x0a','sha256','store','socket.io','yargs/yargs','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','createServer','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','bb-config.json','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','lastmsgtelegram','Server','bbvNew','copyFileSync','publicKey','Markdown','sockets','sort','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','get','slice','Token\x20blacklisted','180wpdJHp','bbvReceive','logout','get-messages','login','output-000.log','set','\x20minutes','mtime','Invalid\x20IP\x20address','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','tkn','token','Restore\x20process\x20confirmed','start','1899496WCXNEo','Unauthorized\x20attempt\x20to\x20add\x20bot','get-portfolio','stop','telegramUsername','running','inherit','secret','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','config','logged\x20out','bb/','reinstall_yes','graphql-request','name','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','toggleBotMode','\x20to\x20','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','\x20>\x20','auto','Notifications\x20disabled','files','toIPv4Address','hasOwnProperty','SIGINT','enable','lowdb/adapters/FileSync','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','login\x20required','username','restore-backup-file','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','stringify','unlinkSync','statSync','Allow\x20login\x20from\x20IP\x20address\x20','login2fa_','Invalid\x20authentication\x20token\x20(1)','/:bot/coins','size','accept','Yes','5\x20min','constructor','getSeconds','telegraf','127.0.0.1','map','hybrid-crypto-js','portfolio_','$1_$2_$3','SIGTERM','backup-full.zip','version','isIPv4MappedAddress','21RYiHGu','new','notification','index.html','6b67f3d61ee94b8f5c80b4affef4c4d9','readFileSync','telegramIpApproval','reload','search','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','-performance.json','yes','login\x20token\x20valid','Telegraf\x20error:','range','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','match','bb-secure.json','bb-settings.json','Unauthorized\x20attempt\x20to\x20update\x20bot','2FA\x20login\x20token\x20generated','password','showname','::ffff:127.0.0.1','delete-bot','telegram','config_orders','filter','store-settings','disconnect','disabled','Password\x20has\x20been\x20reset\x20to:\x20','/disable\x20-\x20disable\x20notifications\x0a','kill','all','confirm-message','assign','once','remoteAddress','access\x20timeout','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','access','Unauthorized\x20attempt\x20to\x20show\x20configuration','RSA','clientip','Invalid\x20authentication\x20token\x20(2)','writeFileSync','host','startsWith','compareSync','***','internal','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','telegrammsg','NTBA_FIX_319','store-configuration','uuid-random','getStartingBalances','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','write','12607650iUXkPc','node-zip','build','settings','output-003.log','randomFillSync','replace','padStart','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Ok,\x20will\x20send\x20order\x20notifications\x20only','split','IPv4','cloneDeep','settings.','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','bbUsername','started','\x1b[34m','showConfig','Unauthorized\x20attempt\x20to\x20delete\x20alerts','ipaddr.js','sendFile','store-headless','restore_yes_','Restore\x20process\x20aborted','randomBytes','6BXMQHO','decrypt','Disabled\x20Bot\x20','#RES#\x20if\x20running\x20locally\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','node','Your\x20installation\x20is\x20already\x20up\x20to\x20date','botID','No\x20authentication\x20token','loginRequired','exit','-results.json','_data','clients','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','766020EuyEVk','test','/:bot','from','sign','get-logs','removeAllListeners','getFullYear','telegramToken','Logged\x20out\x20user\x20...','/restart\x20-\x20restart\x20bot(s)\x0a','getTime','/names\x20-\x20show\x20bot\x20names\x0a','send','new-disabled','User\x20has\x20been\x20validated','defaults','pidExpireLogin','\x1b[35m','bots'];_0x2e7a=function(){return _0x5f3d0c;};return _0x2e7a();}(function(_0x3951c3,_0x144bc){const _0x2db993=_0x303c,_0x3df2d4=_0x3951c3();while(!![]){try{const _0x5c1fd3=parseInt(_0x2db993(0x17b))/0x1+parseInt(_0x2db993(0x33c))/0x2*(-parseInt(_0x2db993(0x21a))/0x3)+-parseInt(_0x2db993(0x1e1))/0x4+parseInt(_0x2db993(0x27f))/0x5*(-parseInt(_0x2db993(0x270))/0x6)+parseInt(_0x2db993(0x2a4))/0x7*(-parseInt(_0x2db993(0x185))/0x8)+parseInt(_0x2db993(0x2fa))/0x9*(-parseInt(_0x2db993(0x1d2))/0xa)+parseInt(_0x2db993(0x256))/0xb;if(_0x5c1fd3===_0x144bc)break;else _0x3df2d4['push'](_0x3df2d4['shift']());}catch(_0x25ebda){_0x3df2d4['push'](_0x3df2d4['shift']());}}}(_0x2e7a,0x493c0));const _0xd20935=function(){let _0x1e4edb=!![];return function(_0x3583be,_0x3e3b17){const _0x18ea61=_0x1e4edb?function(){const _0x3123a9=_0x303c;if(_0x3e3b17){const _0x28f14c=_0x3e3b17[_0x3123a9(0x1a3)](_0x3583be,arguments);return _0x3e3b17=null,_0x28f14c;}}:function(){};return _0x1e4edb=![],_0x18ea61;};}(),_0x154411=_0xd20935(this,function(){const _0x23d5c=_0x303c;return _0x154411[_0x23d5c(0x2d0)]()[_0x23d5c(0x222)]('(((.+)+)+)+$')[_0x23d5c(0x2d0)]()[_0x23d5c(0x20e)](_0x154411)[_0x23d5c(0x222)](_0x23d5c(0x32c));});_0x154411();'use strict';process[_0x5b7969(0x31b)][_0x5b7969(0x250)]=0x1;const childProcess=require(_0x5b7969(0x352)),fs=require('fs'),fns=require(_0x5b7969(0x320)),low=require('lowdb'),FileSync=require(_0x5b7969(0x1fc)),path=require(_0x5b7969(0x359)),crypto=require('crypto'),Crypt=require(_0x5b7969(0x213))['Crypt'],RSA=require(_0x5b7969(0x213))[_0x5b7969(0x245)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x5b7969(0x26a)),argv=require(_0x5b7969(0x1c0))(process['argv']['slice'](0x2))[_0x5b7969(0x1ac)],uuidRandom=require(_0x5b7969(0x252)),{Telegraf,Markup}=require(_0x5b7969(0x210)),Mixpanel=require(_0x5b7969(0x294)),axios=require('axios'),{GraphQLClient,gql}=require(_0x5b7969(0x1ee)),util=require('util'),fileUpload=require(_0x5b7969(0x334)),{networkInterfaces}=require('os'),PORT=argv[_0x5b7969(0x2f4)]||_0x5b7969(0x368),pattern=/^[0-9]{2,4}$/;!pattern[_0x5b7969(0x280)](PORT)&&(console[_0x5b7969(0x2e4)](_0x5b7969(0x345)+PORT+_0x5b7969(0x1b8)),process[_0x5b7969(0x27a)](0x1));const HOST=argv[_0x5b7969(0x249)]||null,userID=argv[_0x5b7969(0x346)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x5b7969(0x275)];let bbpath=_0x5b7969(0x1ec),bbpath2='';const botfile='bot.js',configfile=_0x5b7969(0x1c4),settingsfile='bb-settings.json',securefile=_0x5b7969(0x22b),environment=require('./'+bbpath2+_0x5b7969(0x1a0))[_0x5b7969(0x301)]||_0x5b7969(0x2b9),maxBackups=0xa;let validInstallation=!![];!fs[_0x5b7969(0x34a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5b7969(0x27d)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x5b7969(0x30b),configbackuppath=configpath+_0x5b7969(0x2af),logspath=userID?bbpath+_0x5b7969(0x30a)+userID+'/':bbpath+_0x5b7969(0x30a),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x5b7969(0x1ae),loggerfile=fs[_0x5b7969(0x2f7)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x5b7969(0x2c0)+userID+'/':bbpath+'temp/';!fs[_0x5b7969(0x34a)](configpath)&&fs[_0x5b7969(0x2ed)](configpath);!fs[_0x5b7969(0x34a)](configbackuppath)&&fs[_0x5b7969(0x2ed)](configbackuppath);!fs[_0x5b7969(0x34a)](logspath)&&fs[_0x5b7969(0x2ed)](logspath);!fs[_0x5b7969(0x34a)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5b7969(0x28f)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5b7969(0x18e),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5b7969(0x28f)]({'secure':{},'blacklist':[]})[_0x5b7969(0x255)]();let crypt=new Crypt({'md':_0x5b7969(0x1bd),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x5b7969(0x21e),{'host':_0x5b7969(0x2be)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x5b7969(0x287)]!=''&&settings[_0x5b7969(0x287)]!='***')&&settings[_0x5b7969(0x1e5)]&&settings[_0x5b7969(0x1e5)]!='')initTelegram();const parseColor=(_0x25ddad,_0x270282)=>{const _0x3753b1=_0x5b7969,_0x54465f=/#[A-Z]{3}#/g;if(typeof _0x25ddad==_0x3753b1(0x379)){!_0x270282?_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](_0x54465f,''):(_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](/#BLU#/g,_0x3753b1(0x267)),_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](/#RED#/g,_0x3753b1(0x348)),_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](/#YEL#/g,_0x3753b1(0x2cb)),_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](/#MAG#/g,_0x3753b1(0x291)),_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](/#CYA#/g,_0x3753b1(0x18c)),_0x25ddad=_0x25ddad[_0x3753b1(0x25c)](/#RES#/g,_0x3753b1(0x307)));;}return _0x25ddad;},logger={'screen':_0x20bfe0=>{console['log'](parseColor(_0x20bfe0,!![]));},'simple':_0x42605b=>{const _0x2b99d0=_0x5b7969;console[_0x2b99d0(0x2e4)](parseColor(_0x42605b,!![])),loggerfile[_0x2b99d0(0x255)](util[_0x2b99d0(0x311)](parseColor(_0x42605b,![]))+'\x0a');},'full':async _0x474dfa=>{const _0x99b0be=_0x5b7969,_0x2f12b9=getTimeStamp()+_0x99b0be(0x2d2)+_0x474dfa;console[_0x99b0be(0x2e4)](parseColor(_0x2f12b9,!![])),loggerfile[_0x99b0be(0x255)](util[_0x99b0be(0x311)](parseColor(_0x2f12b9,![]))+'\x0a');if(tgBot&&settings[_0x99b0be(0x2c2)]&&settings[_0x99b0be(0x2cd)]!='orders')await sendTelegram(settings[_0x99b0be(0x2c2)],_0x99b0be(0x29d)+parseColor(_0x474dfa,![]));},'debug':async(_0x58326a,_0x5291c2='')=>{const _0x60f110=_0x5b7969,_0x4f31c2=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x58326a;if(debugging)console['log'](parseColor(_0x4f31c2,!![]));loggerfile['write'](util[_0x60f110(0x311)](parseColor(_0x4f31c2,![]))+'\x0a');if(_0x5291c2){if(debugging)console[_0x60f110(0x2e4)](_0x5291c2);loggerfile[_0x60f110(0x255)](util[_0x60f110(0x311)](_0x5291c2)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x4ae8b0){const _0x3926a2=_0x5b7969;logger[_0x3926a2(0x1b4)](_0x4ae8b0);}),process['on'](_0x5b7969(0x27a),()=>{const _0x412567=_0x5b7969;stopAllBots(),process[_0x412567(0x27a)](0x0);}),process['on'](_0x5b7969(0x216),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x5b7969(0x1fa),()=>{const _0x1c6f8c=_0x5b7969;stopAllBots(),process[_0x1c6f8c(0x27a)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x5b7969(0x218)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x5b7969(0x2eb))[_0x5b7969(0x1c2)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x5b7969(0x1cf)](_0x5b7969(0x179),async(_0x56f539,_0x3c9549)=>{const _0x6f6c95=_0x5b7969,_0x231a44=_0x56f539['params'][_0x6f6c95(0x2fd)],_0x529c76=getClientsWithBotID(_0x6f6c95(0x1b5)),_0xa1f6e9=_0x56f539[_0x6f6c95(0x2b5)][_0x6f6c95(0x1a2)],_0x5f4f79=timelyDecrypt(_0xa1f6e9,![]),_0x42e3f8=_0x529c76[_0x6f6c95(0x343)](_0x359bef=>_0x359bef[_0x6f6c95(0x1a2)]==_0x5f4f79);if(_0x42e3f8){const _0x5b735e=normalizeIP(_0x56f539[_0x6f6c95(0x36a)]['remoteAddress'])[_0x6f6c95(0x1be)],_0x912927=_0x56f539['headers'][_0x6f6c95(0x1dd)];if(validateAccess(_0x912927,_0x5f4f79,_0x5b735e)['allow'])_0x231a44=='backup'&&await backupConfigFiles(),await zipFiles(_0x231a44),_0x3c9549['download'](zippath+(_0x231a44+_0x6f6c95(0x2b7)),_0x18571b=>{const _0xd21bb9=_0x6f6c95;_0x18571b&&(logger['full'](_0xd21bb9(0x1b9)+_0x231a44),logger[_0xd21bb9(0x1b4)](_0x18571b));});else logger['full'](_0x6f6c95(0x2aa)+_0x231a44+_0x6f6c95(0x318));}else logger[_0x6f6c95(0x325)](_0x6f6c95(0x2aa)+_0x231a44+_0x6f6c95(0x2ca));}),app[_0x5b7969(0x2fb)](_0x5b7969(0x2b2),async(_0xe665df,_0x3ed23b)=>{const _0x2c7c82=_0x5b7969,_0x36e068=getClientsWithBotID(_0x2c7c82(0x1b5)),_0x3c7b0f=_0xe665df['headers'][_0x2c7c82(0x1a2)],_0x5f0637=timelyDecrypt(_0x3c7b0f,![]),_0x28da6a=_0x36e068[_0x2c7c82(0x343)](_0x302a39=>_0x302a39[_0x2c7c82(0x1a2)]==_0x5f0637);logger[_0x2c7c82(0x182)]('Backup\x20file\x20uploaded');if(_0x28da6a){const _0x2b8275=normalizeIP(_0xe665df[_0x2c7c82(0x36a)][_0x2c7c82(0x240)])[_0x2c7c82(0x1be)],_0x253611=_0xe665df[_0x2c7c82(0x2b5)][_0x2c7c82(0x1dd)];if(validateAccess(_0x253611,_0x5f0637,_0x2b8275)[_0x2c7c82(0x351)]){if(_0xe665df[_0x2c7c82(0x1f7)]){const _0x3b5348=_0xe665df[_0x2c7c82(0x1f7)][_0x2c7c82(0x2ab)];await _0x3b5348['mv'](temppath+_0x3b5348['name']),_0x3ed23b['send']({'status':!![],'message':'File\x20uploaded'});const _0x17b61d=getBotsWithMode();_0x17b61d[_0x2c7c82(0x2ec)]>0x0?confirmRestore(temppath,_0x3b5348['name']):unzipFile(temppath,_0x3b5348['name']);}}else logger[_0x2c7c82(0x325)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x2c7c82(0x295));}),app['use'](express['static'](path[_0x5b7969(0x1a9)](__dirname,bbpath2,'build2'))),app['use'](express[_0x5b7969(0x2e0)](path['join'](__dirname,bbpath2,_0x5b7969(0x258)))),app['get']('/',function(_0x5035ab,_0x1112fd){const _0x2bf06a=_0x5b7969;_0x1112fd[_0x2bf06a(0x26b)](path[_0x2bf06a(0x1a9)](__dirname,bbpath2,_0x2bf06a(0x1a1),'index.html'));}),app['get'](_0x5b7969(0x281),function(_0x53355e,_0x29e1dd){const _0x485c38=_0x5b7969;_0x29e1dd[_0x485c38(0x26b)](path[_0x485c38(0x1a9)](__dirname,bbpath2,_0x485c38(0x258),'index.html'));}),app[_0x5b7969(0x1cf)]('/:bot/portfolio',(_0x2c7484,_0x2a112d)=>{const _0xebf6d9=_0x5b7969;_0x2a112d[_0xebf6d9(0x26b)](path[_0xebf6d9(0x1a9)](__dirname,bbpath2,_0xebf6d9(0x258),_0xebf6d9(0x21d)));}),app['get'](_0x5b7969(0x31d),(_0x5c4801,_0x3ddad3)=>{const _0x3d0712=_0x5b7969;_0x3ddad3['sendFile'](path[_0x3d0712(0x1a9)](__dirname,bbpath2,_0x3d0712(0x258),_0x3d0712(0x21d)));}),app[_0x5b7969(0x1cf)](_0x5b7969(0x209),(_0x2c97e2,_0x44b166)=>{const _0x22c41c=_0x5b7969;_0x44b166['sendFile'](path[_0x22c41c(0x1a9)](__dirname,bbpath2,_0x22c41c(0x258),_0x22c41c(0x21d)));}),app[_0x5b7969(0x1cf)](_0x5b7969(0x1b0),(_0x20d6b4,_0xd19bef)=>{const _0x91b94b=_0x5b7969;_0xd19bef[_0x91b94b(0x26b)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x5b7969(0x1cf)]('/:bot/configuration',(_0x1329da,_0x439aa5)=>{const _0x478333=_0x5b7969;_0x439aa5['sendFile'](path[_0x478333(0x1a9)](__dirname,bbpath2,_0x478333(0x258),_0x478333(0x21d)));}),app[_0x5b7969(0x1cf)]('/:bot/support',(_0x248db9,_0xabc493)=>{const _0x3e7c77=_0x5b7969;_0xabc493[_0x3e7c77(0x26b)](path['join'](__dirname,bbpath2,_0x3e7c77(0x258),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x5b7969(0x2b1)](PORT);const io=require(_0x5b7969(0x1bf))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x16d8b8=_0x5b7969;let _0x2aaa14='[ip-address]';const _0x1607e8=networkInterfaces(),_0xa4346a={};for(const _0x17365e of Object[_0x16d8b8(0x31a)](_0x1607e8)){for(const _0x1dde5a of _0x1607e8[_0x17365e]){if((_0x1dde5a[_0x16d8b8(0x2f8)]==_0x16d8b8(0x261)||_0x1dde5a['family']==0x4)&&!_0x1dde5a[_0x16d8b8(0x24d)]){const _0x39a52e=ipaddr['parse'](_0x1dde5a[_0x16d8b8(0x2fe)])[_0x16d8b8(0x228)]();_0x39a52e!=_0x16d8b8(0x29a)&&(!_0xa4346a[_0x17365e]&&(_0xa4346a[_0x17365e]=[]),_0xa4346a[_0x17365e][_0x16d8b8(0x308)](_0x1dde5a[_0x16d8b8(0x2fe)]),_0x2aaa14=_0x1dde5a['address']);}}}return{'serverip':_0x2aaa14,'netinterfaces':_0xa4346a};}async function startServer(){const _0x2b70cf=_0x5b7969,{serverip:_0x59d25f,netinterfaces:_0x27007f}=getServerIP();logger[_0x2b70cf(0x1b4)](''),logger[_0x2b70cf(0x1b4)]('-----------------------------------------------------------------------------------'),await logger[_0x2b70cf(0x325)](_0x2b70cf(0x2e8)+serverversion+'#RES#\x20'+(environment==_0x2b70cf(0x19f)?'(staging)':'')+'\x0a'+(_0x2b70cf(0x36d)+PORT+_0x2b70cf(0x273))+(_0x2b70cf(0x2e1)+_0x59d25f+':'+PORT+_0x2b70cf(0x2d9))),logger[_0x2b70cf(0x1b4)]('-----------------------------------------------------------------------------------');if(config[_0x2b70cf(0x2ec)]!=0x0)for(const _0x43e9cb of config){const _0x2b4f5e=_0x43e9cb[_0x2b70cf(0x2ac)]==_0x2b70cf(0x1f5)?'a':'m';if(_0x43e9cb['status']=='enabled'||_0x43e9cb[_0x2b70cf(0x2f2)]==_0x2b70cf(0x21b))await logger[_0x2b70cf(0x325)](_0x2b70cf(0x2a7)+_0x2b4f5e+')\x20|\x20Bot\x20'+_0x43e9cb[_0x2b70cf(0x277)]+_0x2b70cf(0x35f)+_0x43e9cb[_0x2b70cf(0x2c1)]),startBot([_0x43e9cb[_0x2b70cf(0x277)],userID],{'cwd':bbpath},function(_0x50bfe6){const _0x176746=_0x2b70cf;if(_0x50bfe6)logger[_0x176746(0x325)](_0x50bfe6);});else(_0x43e9cb[_0x2b70cf(0x2f2)]==_0x2b70cf(0x238)||_0x43e9cb[_0x2b70cf(0x2f2)]==_0x2b70cf(0x28d))&&await logger['full']('Idling\x20('+_0x2b4f5e+_0x2b70cf(0x2e2)+_0x43e9cb[_0x2b70cf(0x277)]+'\x20|\x20'+_0x43e9cb[_0x2b70cf(0x2c1)]);}else!newBot&&logger[_0x2b70cf(0x1b4)](_0x2b70cf(0x1c1));if(newBot)addBot();logger[_0x2b70cf(0x1b4)](_0x2b70cf(0x364)),logger[_0x2b70cf(0x1b4)](''),await logger[_0x2b70cf(0x182)](_0x2b70cf(0x341)+nodeversion),await logger[_0x2b70cf(0x182)](_0x2b70cf(0x1a6),_0x27007f);}function startSocket(){const _0x4b4bcf=_0x5b7969;io['on'](_0x4b4bcf(0x29c),_0x51d9bb=>{const _0x26c802=_0x4b4bcf;let _0x2d6fbf,_0x1b03c0,_0x3b661b,_0x519e72,_0x47f86d;const _0x589994=_0x51d9bb[_0x26c802(0x315)]['headers'][_0x26c802(0x316)];_0x1b03c0=_0x589994[_0x26c802(0x22a)](/bot[0-9]{3}/);if(_0x1b03c0)_0x3b661b=_0x1b03c0[0x0][_0x26c802(0x22a)](/[0-9]{3}/);if(_0x3b661b)_0x2d6fbf=_0x3b661b[0x0];else _0x2d6fbf=_0x26c802(0x1b5);const _0x56378f=_0x51d9bb[_0x26c802(0x315)][_0x26c802(0x193)]['encryptedUuid'];if(!_0x56378f)_0x51d9bb[_0x26c802(0x375)](_0x26c802(0x2f2),{'publicKey':secure[_0x26c802(0x1ca)]});else{_0x519e72=timelyDecrypt(_0x56378f,![]);if(!_0x519e72)_0x51d9bb['emit']('status',{'publicKey':secure[_0x26c802(0x1ca)]});else{_0x47f86d=normalizeIP(_0x51d9bb[_0x26c802(0x35a)]['remoteAddress'])['store'];if(!devices[_0x519e72])devices[_0x519e72]={'uuid':_0x519e72,'access':{'token':null}};devices[_0x519e72]['ip']=_0x47f86d;const _0x910f86=addClient(_0x51d9bb['id'],_0x519e72,_0x2d6fbf);setAccess(_0x910f86),emitMessages(),_0x51d9bb['on'](_0x26c802(0x1d6),_0x5f3ca8=>{const _0x3455ad=_0x26c802,_0x48c724=timelyDecrypt(_0x5f3ca8[_0x3455ad(0x22f)]);if(_0x48c724){_0x5f3ca8={'username':_0x5f3ca8[_0x3455ad(0x1ff)],'password':_0x48c724},devices[_0x519e72][_0x3455ad(0x243)]=validateCredentials(_0x5f3ca8,_0x519e72);if(devices[_0x519e72][_0x3455ad(0x243)][_0x3455ad(0x351)]==![]&&devices[_0x519e72][_0x3455ad(0x243)][_0x3455ad(0x2de)]==_0x3455ad(0x30e))_0x51d9bb[_0x3455ad(0x375)](_0x3455ad(0x2f2),{'access':devices[_0x519e72][_0x3455ad(0x243)]}),loginAccess2FA(_0x519e72,_0x47f86d);else{if(devices[_0x519e72][_0x3455ad(0x243)][_0x3455ad(0x351)]==![]&&devices[_0x519e72][_0x3455ad(0x243)]['reason']==_0x3455ad(0x34d))_0x51d9bb['emit'](_0x3455ad(0x2f2),{'access':devices[_0x519e72][_0x3455ad(0x243)]});else devices[_0x519e72][_0x3455ad(0x243)]['allow']&&devices[_0x519e72]['access'][_0x3455ad(0x2de)]==_0x3455ad(0x2fc)&&(getClientsWithUuid(_0x519e72)[_0x3455ad(0x2ad)](_0x49ee04=>{setAccess(_0x49ee04);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x519e72[_0x3455ad(0x1d0)](-0x8)),setTokenRefresh(_0x519e72),setSessionTimeout(_0x3455ad(0x1d6),_0x519e72));}}else logger[_0x3455ad(0x325)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x51d9bb['on']('reset-password',()=>{resetPassword();}),_0x51d9bb['on']('disconnect',_0xd979b5=>{removeClient(_0x51d9bb['id']);}),_0x2d6fbf==_0x26c802(0x1b5)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3dd71f){const _0x28ceb7=_0x5b7969;if(_0x3dd71f!=_0x28ceb7(0x1b5)&&config[_0x28ceb7(0x2c4)]!=''){if(pid[_0x3dd71f])pid[_0x3dd71f]['send']({'function':_0x28ceb7(0x312),'args':null});}_0x3dd71f!='botmanager'&&broadcastToBots(_0x28ceb7(0x292),JSON[_0x28ceb7(0x203)](config));}function reloadBotManager(){const _0x43a631=_0x5b7969;getClientsWithBotID(_0x43a631(0x1b5))[_0x43a631(0x2ad)](_0x4aabda=>{const _0x8e3d8=_0x43a631;getSocket(_0x4aabda['id'])[_0x8e3d8(0x375)](_0x8e3d8(0x2f2),{'access':{'allow':![],'reason':_0x8e3d8(0x221),'token':null}});});}function getSocket(_0x2eebb0){const _0x38a0bf=_0x5b7969;return io[_0x38a0bf(0x1cc)][_0x38a0bf(0x1cc)]['get'](_0x2eebb0);}function setAccess(_0x57faaf){const _0x39d788=_0x5b7969,_0x441022=getSocket(_0x57faaf['id']),_0x1efd2d=_0x57faaf[_0x39d788(0x1a2)],_0x5b894d=_0x57faaf['bot'];devices[_0x1efd2d][_0x39d788(0x243)]=validateAccess(devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x1de)],_0x1efd2d),logger[_0x39d788(0x182)]('Setting\x20access:\x20'+devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x2de)]+_0x39d788(0x357)+_0x57faaf['id']['slice'](-0x8)+_0x39d788(0x2db)+_0x1efd2d[_0x39d788(0x1d0)](-0x8)),_0x441022[_0x39d788(0x1a9)](_0x1efd2d);if(devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x351)]){_0x441022[_0x39d788(0x1a9)](_0x5b894d);if(_0x5b894d==_0x39d788(0x1b5))initializeSocketBotManager(_0x441022);else initializeSocketBot(_0x441022);initClient(_0x5b894d);}devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x1de)]&&devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x2de)]==_0x39d788(0x317)&&setSessionTimeout(_0x39d788(0x338),_0x1efd2d),devices[_0x1efd2d][_0x39d788(0x243)]['token']&&devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x2de)]==_0x39d788(0x22e)&&setSessionTimeout('login',_0x1efd2d),_0x441022['emit'](_0x39d788(0x2f2),{'status':_0x57faaf[_0x39d788(0x2a9)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1efd2d]['access'],'externalip':devices[_0x1efd2d]['ip'],'publicKey':secure[_0x39d788(0x1ca)],'userid':settings[_0x39d788(0x1b7)],'validInstallation':validInstallation}),devices[_0x1efd2d][_0x39d788(0x243)]['allow']==![]&&devices[_0x1efd2d][_0x39d788(0x243)][_0x39d788(0x2de)]==_0x39d788(0x2d7)&&temporaryAccess2FA(_0x1efd2d,devices[_0x1efd2d]['ip']);}function setSessionTimeout(_0x236b19,_0x16a1c9){const _0x2e985a=_0x5b7969;let _0x1793b9;if(_0x236b19=='login')_0x1793b9=loginExpiry*0x3c*0x3e8;else _0x1793b9=devices[_0x16a1c9][_0x2e985a(0x220)][_0x2e985a(0x17a)]*0x3c*0x3e8-(new Date()[_0x2e985a(0x28a)]()-devices[_0x16a1c9][_0x2e985a(0x220)]['timestamp']);if(devices[_0x16a1c9][_0x2e985a(0x290)])clearTimeout(devices[_0x16a1c9][_0x2e985a(0x290)]);devices[_0x16a1c9][_0x2e985a(0x290)]=setTimeout(()=>{const _0x52ce44=_0x2e985a;if(devices[_0x16a1c9][_0x52ce44(0x197)])clearTimeout(devices[_0x16a1c9][_0x52ce44(0x197)]);removeSocketListeners(_0x16a1c9),addBlacklist(_0x16a1c9),devices[_0x16a1c9][_0x52ce44(0x220)]=null,devices[_0x16a1c9][_0x52ce44(0x2bc)]=null,devices[_0x16a1c9]['access'][_0x52ce44(0x1de)]=null,logger['debug'](_0x52ce44(0x1b2)+_0x16a1c9[_0x52ce44(0x1d0)](-0x8)),devices[_0x16a1c9]['access']=validateAccess(devices[_0x16a1c9]['access'][_0x52ce44(0x1de)],_0x16a1c9),!(devices[_0x16a1c9][_0x52ce44(0x243)][_0x52ce44(0x351)]&&devices[_0x16a1c9]['access'][_0x52ce44(0x2de)]==_0x52ce44(0x36b))&&(_0x236b19=='login'?io['to'](_0x16a1c9)['emit'](_0x52ce44(0x2f2),{'access':{'allow':![],'reason':_0x52ce44(0x241),'token':null}}):io['to'](_0x16a1c9)[_0x52ce44(0x375)](_0x52ce44(0x2f2),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x16a1c9][_0x52ce44(0x243)][_0x52ce44(0x1de)]=null;},_0x1793b9);}function setTokenRefresh(_0x4ba766){const _0xde8667=_0x5b7969;if(devices[_0x4ba766]['pidRefreshToken'])clearTimeout(devices[_0x4ba766][_0xde8667(0x197)]);devices[_0x4ba766][_0xde8667(0x197)]=setTimeout(()=>{const _0x2b16e3=_0xde8667;getClientsWithUuid(_0x4ba766)['length']!=0x0?(devices[_0x4ba766]['access']=refreshToken(_0x4ba766),io['to'](_0x4ba766)[_0x2b16e3(0x375)](_0x2b16e3(0x2f2),{'status':_0x2b16e3(0x373),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4ba766][_0x2b16e3(0x243)],'externalip':devices[_0x4ba766]['ip'],'publicKey':secure[_0x2b16e3(0x1ca)],'validInstallation':validInstallation}),setTokenRefresh(_0x4ba766)):clearTimeout(devices[_0x4ba766][_0x2b16e3(0x197)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2d7647){const _0x389a55=_0x5b7969,_0x9e2c2=getClient(_0x2d7647['id'])[_0x389a55(0x1a2)];_0x2d7647[_0x389a55(0x375)](_0x389a55(0x292),config),_0x2d7647['emit'](_0x389a55(0x259),cleanSettings()),_0x2d7647['on'](_0x389a55(0x358),_0xdb9849=>{const _0xa24d7e=_0x389a55;if(validateAccess(_0xdb9849,_0x9e2c2)['allow'])addBot();else logger['full'](_0xa24d7e(0x1e2));}),_0x2d7647['on']('update-bot',(_0x146a2e,_0x4aebcb)=>{const _0x3c5b27=_0x389a55;if(validateAccess(_0x4aebcb,_0x9e2c2)[_0x3c5b27(0x351)])toggleBot(_0x146a2e['botID'],_0x146a2e['status'],_0x146a2e[_0x3c5b27(0x187)]);else logger['full'](_0x3c5b27(0x22d));}),_0x2d7647['on']('toggle-bot-mode',(_0x5520d2,_0x5d2fb4)=>{const _0x5f763f=_0x389a55;if(validateAccess(_0x5d2fb4,_0x9e2c2)[_0x5f763f(0x351)])toggleBotMode(_0x5520d2);else logger[_0x5f763f(0x325)](_0x5f763f(0x22d));}),_0x2d7647['on'](_0x389a55(0x232),(_0x355cfd,_0x3a01f4)=>{const _0x30e71a=_0x389a55;if(validateAccess(_0x3a01f4,_0x9e2c2)['allow'])deleteBot(_0x355cfd);else logger[_0x30e71a(0x325)](_0x30e71a(0x2df));}),_0x2d7647['on'](_0x389a55(0x236),(_0x4368b7,_0x32fecb)=>{const _0x4afc0f=_0x389a55;if(validateAccess(_0x32fecb,_0x9e2c2)[_0x4afc0f(0x351)])storeSettings(_0x4368b7,!![]);else logger[_0x4afc0f(0x325)](_0x4afc0f(0x37a));}),_0x2d7647['on'](_0x389a55(0x2a3),_0x118432=>{const _0x39838e=_0x389a55;if(validateAccess(_0x118432,_0x9e2c2)[_0x39838e(0x351)])updateBB(_0x39838e(0x329));else logger[_0x39838e(0x325)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2d7647['on']('reinstall-bb',_0x1c074e=>{const _0x2040f5=_0x389a55;if(validateAccess(_0x1c074e,_0x9e2c2)[_0x2040f5(0x351)])updateBB(_0x2040f5(0x191));else logger[_0x2040f5(0x325)](_0x2040f5(0x29b));}),_0x2d7647['on'](_0x389a55(0x322),_0x5b05d8=>{const _0x5d30ba=_0x389a55;if(validateAccess(_0x5b05d8,_0x9e2c2)[_0x5d30ba(0x351)]){const _0x355473=getClient(_0x2d7647['id']);if(_0x355473)getBackupFiles(_0x355473['uuid']);else logger['full'](_0x5d30ba(0x299));}else logger['full'](_0x5d30ba(0x254));}),_0x2d7647['on'](_0x389a55(0x200),(_0x351cce,_0xffccc1)=>{const _0x212352=_0x389a55;if(validateAccess(_0xffccc1,_0x9e2c2)[_0x212352(0x351)])restoreBackupFile(_0x351cce);else logger['full'](_0x212352(0x34f));}),_0x2d7647['on'](_0x389a55(0x1d5),_0x5a22cb=>{const _0x35d265=_0x389a55;if(validateAccess(_0x5a22cb,_0x9e2c2)[_0x35d265(0x351)])getMessages();else logger[_0x35d265(0x325)](_0x35d265(0x2c5));}),_0x2d7647['on']('confirm-message',(_0x4fee48,_0x48cbfa)=>{const _0x545a88=_0x389a55;if(validateAccess(_0x48cbfa,_0x9e2c2)[_0x545a88(0x351)])confirmMessage(_0x4fee48);else logger[_0x545a88(0x325)](_0x545a88(0x1a7));}),_0x2d7647['on'](_0x389a55(0x1d4),_0x5325d9=>{const _0x256e56=_0x389a55;if(validateAccess(_0x5325d9,_0x9e2c2)['allow']){if(devices[_0x9e2c2][_0x256e56(0x197)])clearTimeout(devices[_0x9e2c2][_0x256e56(0x197)]);if(devices[_0x9e2c2][_0x256e56(0x290)])clearTimeout(devices[_0x9e2c2][_0x256e56(0x290)]);removeSocketListeners(getClient(_0x2d7647['id'])['uuid']),addBlacklist(_0x9e2c2),devices[_0x9e2c2][_0x256e56(0x220)]=null,devices[_0x9e2c2]['telegram2FaApproval']=null,devices[_0x9e2c2]['access'][_0x256e56(0x1de)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x9e2c2['slice'](-0x8)),io['to'](getClient(_0x2d7647['id'])[_0x256e56(0x1a2)])[_0x256e56(0x375)]('status',{'access':{'allow':![],'reason':_0x256e56(0x1eb),'token':null}});}else logger[_0x256e56(0x325)](_0x256e56(0x35d));});}function initializeSocketBot(_0x5265e4){const _0xfe9d83=_0x5b7969,_0x4e9558=getClient(_0x5265e4['id'])['bot'],_0x20a3b4=getClient(_0x5265e4['id'])[_0xfe9d83(0x1a2)];_0x5265e4['on'](_0xfe9d83(0x284),(_0x95fefd,_0x1545f2)=>{const _0x36c11b=_0xfe9d83;if(validateAccess(_0x1545f2,_0x20a3b4)['allow']){if(pid[_0x4e9558])pid[_0x4e9558][_0x36c11b(0x28c)]({'function':_0x36c11b(0x2f6),'args':_0x95fefd});}else logger[_0x36c11b(0x325)](_0x36c11b(0x2d8));}),_0x5265e4['on'](_0xfe9d83(0x19d),(_0x24922d,_0x48f459)=>{const _0x2827be=_0xfe9d83;if(validateAccess(_0x48f459,_0x20a3b4)['allow']){if(pid[_0x4e9558])pid[_0x4e9558][_0x2827be(0x28c)]({'function':'deleteHistoryAlerts','args':_0x24922d});}else logger[_0x2827be(0x325)](_0x2827be(0x269));}),_0x5265e4['on'](_0xfe9d83(0x1e3),(_0x3808c2,_0x3be272)=>{const _0x2ee70e=_0xfe9d83;if(validateAccess(_0x3be272,_0x20a3b4)[_0x2ee70e(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558]['send']({'function':_0x2ee70e(0x2cc),'args':_0x3808c2});}else logger[_0x2ee70e(0x325)](_0x2ee70e(0x32d));}),_0x5265e4['on'](_0xfe9d83(0x251),(_0xe1142f,_0x15ce73)=>{const _0x292293=_0xfe9d83;if(validateAccess(_0x15ce73,_0x20a3b4)[_0x292293(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558][_0x292293(0x28c)]({'function':'storeConfiguration','args':_0xe1142f});}else logger[_0x292293(0x325)](_0x292293(0x367));}),_0x5265e4['on'](_0xfe9d83(0x26c),(_0x319faf,_0x2006e4)=>{const _0x4a1c1c=_0xfe9d83;if(validateAccess(_0x2006e4,_0x20a3b4)[_0x4a1c1c(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558][_0x4a1c1c(0x28c)]({'function':_0x4a1c1c(0x32b),'args':_0x319faf});}else logger[_0x4a1c1c(0x325)](_0x4a1c1c(0x2a6));}),_0x5265e4['on'](_0xfe9d83(0x19a),(_0x189055,_0x4d6a53)=>{const _0x46eedf=_0xfe9d83;if(validateAccess(_0x4d6a53,_0x20a3b4)['allow']){if(pid[_0x4e9558])pid[_0x4e9558][_0x46eedf(0x28c)]({'function':_0x46eedf(0x324),'args':_0x189055});}else logger[_0x46eedf(0x325)](_0x46eedf(0x264));}),_0x5265e4['on'](_0xfe9d83(0x2a8),_0x510d99=>{const _0x5f37a3=_0xfe9d83;if(validateAccess(_0x510d99,_0x20a3b4)[_0x5f37a3(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558][_0x5f37a3(0x28c)]({'function':'resetHistory','args':null});}else logger[_0x5f37a3(0x325)](_0x5f37a3(0x1f3));}),_0x5265e4['on'](_0xfe9d83(0x363),_0x204bc5=>{const _0x537a67=_0xfe9d83;if(validateAccess(_0x204bc5,_0x20a3b4)[_0x537a67(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558][_0x537a67(0x28c)]({'function':_0x537a67(0x253),'args':null});}else logger[_0x537a67(0x325)](_0x537a67(0x223));}),_0x5265e4['on'](_0xfe9d83(0x310),(_0x36dc,_0x4c661d)=>{const _0x9c22e0=_0xfe9d83;if(validateAccess(_0x4c661d,_0x20a3b4)[_0x9c22e0(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558][_0x9c22e0(0x28c)]({'function':'placeOrder','args':_0x36dc});}else logger[_0x9c22e0(0x325)](_0x9c22e0(0x297));}),_0x5265e4['on']('cancel-loading',_0x158092=>{const _0x32d0b4=_0xfe9d83;if(validateAccess(_0x158092,_0x20a3b4)['allow']){if(pid[_0x4e9558])pid[_0x4e9558]['send']({'function':_0x32d0b4(0x2da),'args':null});}else logger[_0x32d0b4(0x325)](_0x32d0b4(0x34e));}),_0x5265e4['on']('show-config',_0x4bdee8=>{const _0xbd241b=_0xfe9d83;if(validateAccess(_0x4bdee8,_0x20a3b4)[_0xbd241b(0x351)]){if(pid[_0x4e9558])pid[_0x4e9558][_0xbd241b(0x28c)]({'function':_0xbd241b(0x268),'args':null});}else logger['full'](_0xbd241b(0x244));}),_0x5265e4['on']('update-bb',_0x44002b=>{const _0x5ecd56=_0xfe9d83;if(validateAccess(_0x44002b,_0x20a3b4)[_0x5ecd56(0x351)])updateBB(_0x5ecd56(0x329));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5265e4['on']('get-messages',_0x284cc8=>{const _0x23c55f=_0xfe9d83;if(validateAccess(_0x284cc8,_0x20a3b4)[_0x23c55f(0x351)])getMessages();else logger[_0x23c55f(0x325)](_0x23c55f(0x2c5));}),_0x5265e4['on'](_0xfe9d83(0x23d),(_0x463fe8,_0x23e525)=>{const _0xadaba=_0xfe9d83;if(validateAccess(_0x23e525,_0x20a3b4)[_0xadaba(0x351)])confirmMessage(_0x463fe8);else logger['full'](_0xadaba(0x1a7));}),_0x5265e4['on'](_0xfe9d83(0x1d4),_0x3f7cf7=>{const _0x5a398b=_0xfe9d83;if(validateAccess(_0x3f7cf7,_0x20a3b4)[_0x5a398b(0x351)]){if(devices[_0x20a3b4][_0x5a398b(0x197)])clearTimeout(devices[_0x20a3b4]['pidRefreshToken']);if(devices[_0x20a3b4]['pidExpireLogin'])clearTimeout(devices[_0x20a3b4][_0x5a398b(0x290)]);removeSocketListeners(getClient(_0x5265e4['id'])[_0x5a398b(0x1a2)]),addBlacklist(_0x20a3b4),devices[_0x20a3b4][_0x5a398b(0x220)]=null,devices[_0x20a3b4][_0x5a398b(0x2bc)]=null,devices[_0x20a3b4][_0x5a398b(0x243)][_0x5a398b(0x1de)]=null,logger[_0x5a398b(0x182)](_0x5a398b(0x288)+_0x20a3b4[_0x5a398b(0x1d0)](-0x8)),io['to'](getClient(_0x5265e4['id'])[_0x5a398b(0x1a2)])[_0x5a398b(0x375)](_0x5a398b(0x2f2),{'access':{'allow':![],'reason':_0x5a398b(0x1eb),'token':null}});}else logger[_0x5a398b(0x325)](_0x5a398b(0x35d));});}function removeSocketListeners(_0x33a3fd){const _0x4905ad=_0x5b7969;getClientsWithUuid(_0x33a3fd)[_0x4905ad(0x2ad)](_0x908388=>{const _0x1f3ddf=_0x4905ad;getSocket(_0x908388['id'])[_0x1f3ddf(0x285)]();});}function cleanSettings(){const _0x141117=_0x5b7969;let _0x3ae20b=settings;return settings['telegramToken']&&settings[_0x141117(0x287)]!=''&&(_0x3ae20b={..._0x3ae20b,'telegramToken':_0x141117(0x344)}),settings[_0x141117(0x192)]&&settings[_0x141117(0x192)]!=''&&(_0x3ae20b={..._0x3ae20b,'bbPassword':'************'}),(settings[_0x141117(0x192)]&&settings[_0x141117(0x192)]==_0x141117(0x24c)||settings[_0x141117(0x287)]&&settings['telegramToken']=='***')&&(_0x3ae20b={..._0x3ae20b,'restored':{'password':settings['bbPassword']==_0x141117(0x24c),'telegram':settings[_0x141117(0x287)]==_0x141117(0x24c)}}),_0x3ae20b;}async function updateBB(_0x30d1cf){const _0x4391b2=_0x5b7969;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x6ff947=>{restartBot(_0x6ff947['botID']);});if(_0x30d1cf==_0x4391b2(0x329))process[_0x4391b2(0x28c)]({'update':!![],'environment':environment},_0x4de821=>{});else _0x30d1cf==_0x4391b2(0x191)&&process[_0x4391b2(0x28c)]({'reinstall':!![],'environment':environment},_0x396349=>{});}function startBot(_0x41f15e,_0x1913a8,_0x432363){const _0x10c00c=_0x5b7969;if(debugging)_0x41f15e[_0x10c00c(0x308)]('-d');let _0x3d4874=![];const _0x48d8d0=_0x41f15e[0x0];_0x1913a8={..._0x1913a8,'stdio':[_0x10c00c(0x1e7),_0x10c00c(0x1e7),_0x10c00c(0x1e7),_0x10c00c(0x35c)]},pid[_0x48d8d0]=childProcess[_0x10c00c(0x1a4)](botfile,_0x41f15e,_0x1913a8),pid[_0x48d8d0]['on']('message',_0x26b2ee=>{const _0x3d316c=_0x10c00c;switch(Object['keys'](_0x26b2ee)[0x0]){case _0x3d316c(0x2c1):updateBotName(_0x48d8d0,_0x26b2ee[_0x3d316c(0x2c1)]);break;case _0x3d316c(0x178):updateBotManager();break;case _0x3d316c(0x2f2):updateStatus(_0x48d8d0,_0x26b2ee[_0x3d316c(0x2f2)]);break;case _0x3d316c(0x187):updateLive(_0x48d8d0,_0x26b2ee[_0x3d316c(0x187)]);break;case _0x3d316c(0x266):updateLive(_0x48d8d0,_0x26b2ee[_0x3d316c(0x266)]),io['to'](_0x48d8d0)[_0x3d316c(0x375)]('status',{'access':{'allow':![],'reason':_0x3d316c(0x221),'token':null}});break;case _0x3d316c(0x1e4):_0x26b2ee[_0x3d316c(0x1e4)]==_0x3d316c(0x184)&&restartBot(_0x48d8d0);_0x26b2ee[_0x3d316c(0x1e4)]==_0x3d316c(0x23b)&&toggleBot(_0x48d8d0,_0x3d316c(0x238),_0x3d316c(0x335));break;case _0x3d316c(0x233):sendTelegramBot(_0x48d8d0,_0x26b2ee[_0x3d316c(0x233)]);break;case _0x3d316c(0x24f):sendTelegramMsg(_0x26b2ee['telegrammsg']);break;case'function':io['to'](_0x48d8d0)[_0x3d316c(0x375)](_0x26b2ee[_0x3d316c(0x313)],_0x26b2ee[_0x3d316c(0x378)]);break;}}),pid[_0x48d8d0]['on'](_0x10c00c(0x298),function(_0x40f364){if(_0x3d4874)return;_0x3d4874=!![],_0x432363(_0x40f364);}),pid[_0x48d8d0]['on'](_0x10c00c(0x27a),async function(_0x3a51c2){const _0x201424=_0x10c00c;if(terminating)return;if(installingUpdate){logger[_0x201424(0x182)](_0x201424(0x1e9)),io[_0x201424(0x2a0)]();return;}if(_0x3d4874)return;_0x3d4874=!![],_0x432363(null);const _0x50d163=dbConfig[_0x201424(0x1cf)](_0x201424(0x292))[_0x201424(0x343)]({'botID':_0x48d8d0})[_0x201424(0x34c)]();_0x50d163&&(_0x50d163[_0x201424(0x2f2)]==_0x201424(0x2c9)||_0x50d163[_0x201424(0x2f2)]==_0x201424(0x21b))&&(await sleep(0x3e8),updateLive(_0x48d8d0,_0x201424(0x335)),logger['full'](_0x201424(0x2a1)+_0x48d8d0),startBot([_0x48d8d0,userID],{'cwd':bbpath},function(_0x56a466){const _0x1deab2=_0x201424;if(_0x56a466)logger[_0x1deab2(0x325)](_0x56a466);}));});}function stopBot(_0x48f213){const _0x4e0f1b=_0x5b7969;getClientsWithBotID(_0x48f213)[_0x4e0f1b(0x2ad)](_0x55aad3=>{const _0x512be5=_0x4e0f1b;getSocket(_0x55aad3['id'])[_0x512be5(0x237)](!![]),removeClient(_0x55aad3['id']);}),pid[_0x48f213]&&(pid[_0x48f213]['kill'](),pid[_0x48f213]=null);}function stopAllBots(){const _0x3730f7=_0x5b7969;terminating=!![];const _0x5776e1=getEnabledBots();_0x5776e1[_0x3730f7(0x2ad)](_0x7bbe60=>{const _0x733738=_0x3730f7;stopBot(_0x7bbe60[_0x733738(0x277)]);});}function restartBot(_0x301ff8){const _0x4f51c2=_0x5b7969;if(pid[_0x301ff8])pid[_0x301ff8][_0x4f51c2(0x23b)]();}function addBot(){const _0x137705=_0x5b7969;let _0xcb6005;for(let _0x1fb451=0x1;_0x1fb451<0x3e9;_0x1fb451++){_0xcb6005=_0x1fb451[_0x137705(0x2d0)]()[_0x137705(0x25d)](0x3,'0');let _0x200126=config[_0x137705(0x343)](_0x505db9=>_0x505db9[_0x137705(0x277)]==_0xcb6005);if(!_0x200126)break;}if(_0xcb6005==='1000'){logger[_0x137705(0x325)](_0x137705(0x2e5));return;}logger[_0x137705(0x325)](_0x137705(0x2b0)+_0xcb6005),dbConfig[_0x137705(0x1cf)]('bots')[_0x137705(0x308)]({'botID':_0xcb6005,'botname':_0x137705(0x355)+_0xcb6005,'status':_0x137705(0x21b),'live':''})['write'](),startBot([_0xcb6005,userID],{'cwd':bbpath},function(_0x518223){const _0x3f52e0=_0x137705;if(_0x518223)logger[_0x3f52e0(0x325)](_0x518223);}),config=getConfiguration(),io['to'](_0x137705(0x1b5))[_0x137705(0x375)](_0x137705(0x292),config),broadcastToBots('bots',JSON[_0x137705(0x203)](config));}function deleteBot(_0x1ddc5e){const _0x16ecac=_0x5b7969;getClientsWithBotID(_0x1ddc5e)[_0x16ecac(0x2ad)](_0x45f1cb=>{const _0x4c7fe6=_0x16ecac;getSocket(_0x45f1cb['id'])[_0x4c7fe6(0x237)](!![]),removeClient(_0x45f1cb['id']);}),dbConfig[_0x16ecac(0x1cf)]('bots')['remove']({'botID':_0x1ddc5e})[_0x16ecac(0x255)](),logger[_0x16ecac(0x325)]('Deleted\x20Bot\x20'+_0x1ddc5e),stopBot(_0x1ddc5e);try{if(fs[_0x16ecac(0x34a)](path[_0x16ecac(0x1a9)](configpath,_0x16ecac(0x35e)+_0x1ddc5e+_0x16ecac(0x2e9))))fs[_0x16ecac(0x204)](path[_0x16ecac(0x1a9)](configpath,_0x16ecac(0x35e)+_0x1ddc5e+_0x16ecac(0x2e9)));if(fs['existsSync'](path['join'](configpath,_0x16ecac(0x35e)+_0x1ddc5e+'-events.json')))fs[_0x16ecac(0x204)](path['join'](configpath,_0x16ecac(0x35e)+_0x1ddc5e+'-events.json'));if(fs[_0x16ecac(0x34a)](path[_0x16ecac(0x1a9)](configpath,_0x16ecac(0x35e)+_0x1ddc5e+_0x16ecac(0x224))))fs[_0x16ecac(0x204)](path[_0x16ecac(0x1a9)](configpath,_0x16ecac(0x35e)+_0x1ddc5e+_0x16ecac(0x224)));if(fs[_0x16ecac(0x34a)](path[_0x16ecac(0x1a9)](configpath,_0x16ecac(0x35e)+_0x1ddc5e+_0x16ecac(0x27b))))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x1ddc5e+_0x16ecac(0x27b)));}catch(_0x5a8d97){if(_0x5a8d97)logger[_0x16ecac(0x325)](_0x16ecac(0x1aa),_0x5a8d97);}config=getConfiguration(),io['to']('botmanager')[_0x16ecac(0x375)](_0x16ecac(0x292),config),broadcastToBots(_0x16ecac(0x292),JSON[_0x16ecac(0x203)](config));}function toggleBot(_0x490204,_0x2d1ab7,_0x4e4847){const _0x159eb8=_0x5b7969;dbConfig[_0x159eb8(0x1cf)](_0x159eb8(0x292))['find']({'botID':_0x490204})[_0x159eb8(0x23e)]({'status':_0x2d1ab7})[_0x159eb8(0x23e)]({'live':_0x4e4847})[_0x159eb8(0x255)]();if(_0x2d1ab7==_0x159eb8(0x2c9)||_0x2d1ab7==_0x159eb8(0x21b))logger[_0x159eb8(0x325)](_0x159eb8(0x33a)+_0x490204),startBot([_0x490204,userID],{'cwd':bbpath},function(_0x444d53){const _0x5bc37a=_0x159eb8;if(_0x444d53)logger[_0x5bc37a(0x325)](_0x444d53);});else(_0x2d1ab7=='disabled'||_0x2d1ab7==_0x159eb8(0x28d))&&(logger['full'](_0x159eb8(0x272)+_0x490204),stopBot(_0x490204));config=getConfiguration(),io['to'](_0x159eb8(0x1b5))['emit'](_0x159eb8(0x292),config),broadcastToBots(_0x159eb8(0x292),JSON[_0x159eb8(0x203)](config));}function toggleStatus(_0x16ee98){const _0x44473a=_0x5b7969;let _0x26ee8f=dbConfig[_0x44473a(0x1cf)](_0x44473a(0x292))['find']({'botID':_0x16ee98})[_0x44473a(0x34c)](),_0x1a1b23;if(_0x26ee8f['status']===_0x44473a(0x2c9))_0x1a1b23=_0x44473a(0x238);else{if(_0x26ee8f['status']===_0x44473a(0x21b))_0x1a1b23=_0x44473a(0x28d);else{if(_0x26ee8f[_0x44473a(0x2f2)]==='new-disabled')_0x1a1b23=_0x44473a(0x21b);else{if(_0x26ee8f[_0x44473a(0x2f2)]==='disabled')_0x1a1b23=_0x44473a(0x2c9);}}}return _0x1a1b23;}function updateStatus(_0x1dcd06,_0x3a6e2e){const _0x30c744=_0x5b7969;dbConfig['get'](_0x30c744(0x292))[_0x30c744(0x343)]({'botID':_0x1dcd06})[_0x30c744(0x23e)]({'status':_0x3a6e2e})[_0x30c744(0x255)](),config=getConfiguration(),io['to'](_0x30c744(0x1b5))['emit'](_0x30c744(0x292),config),broadcastToBots(_0x30c744(0x292),JSON[_0x30c744(0x203)](config));}function updateLive(_0x14382f,_0x5ef24c){const _0x29cb08=_0x5b7969;dbConfig[_0x29cb08(0x1cf)](_0x29cb08(0x292))[_0x29cb08(0x343)]({'botID':_0x14382f})[_0x29cb08(0x23e)]({'live':_0x5ef24c})[_0x29cb08(0x255)](),config=getConfiguration(),io['to'](_0x29cb08(0x1b5))['emit'](_0x29cb08(0x292),config),broadcastToBots(_0x29cb08(0x292),JSON[_0x29cb08(0x203)](config));}function updateBotName(_0x14a916,_0x20da03){const _0x475087=_0x5b7969;dbConfig[_0x475087(0x1cf)](_0x475087(0x292))[_0x475087(0x343)]({'botID':_0x14a916})[_0x475087(0x23e)]({'botname':_0x20da03})['write'](),config=getConfiguration(),io['to'](_0x475087(0x1b5))[_0x475087(0x375)](_0x475087(0x292),config),broadcastToBots('bots',JSON[_0x475087(0x203)](config));}function updateBotManager(){const _0x4fc573=_0x5b7969;config=getConfiguration(),io['to'](_0x4fc573(0x1b5))['emit'](_0x4fc573(0x292),config),broadcastToBots(_0x4fc573(0x292),JSON[_0x4fc573(0x203)](config));}function toggleBotMode(_0x2a1b57){const _0x1765e8=_0x5b7969;if(pid[_0x2a1b57])pid[_0x2a1b57]['send']({'function':_0x1765e8(0x1f1),'args':null});else{const _0x179416=configpath+_0x1765e8(0x35e)+_0x2a1b57+_0x1765e8(0x2e9),_0x485f45=fs['readFileSync'](_0x179416),_0x1b6113=JSON[_0x1765e8(0x36f)](_0x485f45),_0x5c1e14=_0x1b6113[_0x1765e8(0x331)][0x0][_0x1765e8(0x181)];_0x1b6113['bot'][0x0][_0x1765e8(0x181)]=!_0x5c1e14;const _0x4ca726=JSON['stringify'](_0x1b6113,null,0x2);fs['writeFileSync'](_0x179416,_0x4ca726),config=getConfiguration(),io['to'](_0x1765e8(0x1b5))[_0x1765e8(0x375)]('bots',config),broadcastToBots(_0x1765e8(0x292),JSON[_0x1765e8(0x203)](config));}}function validateTelegram(_0x39b061){const _0x2a894b=_0x5b7969;if(_0x39b061[_0x2a894b(0x282)]['username']!=settings[_0x2a894b(0x1e5)]&&'@'+_0x39b061[_0x2a894b(0x282)]['username']!=settings[_0x2a894b(0x1e5)]||_0x39b061[_0x2a894b(0x2a2)]['id']!=settings[_0x2a894b(0x2c2)])return sendTelegram(_0x39b061[_0x2a894b(0x2a2)]['id'],_0x2a894b(0x229),{'parse_mode':_0x2a894b(0x33b)}),![];return!![];}async function initTelegram(){const _0x35f804=_0x5b7969;if(tgBot)tgBot[_0x35f804(0x1e4)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x108a24=_0x35f804(0x2c3);_0x108a24+='\x0a',_0x108a24+=_0x35f804(0x1bc),_0x108a24+=_0x35f804(0x23a),_0x108a24+=_0x35f804(0x1c5),_0x108a24+=_0x35f804(0x289),_0x108a24+=_0x35f804(0x2bf),_0x108a24+=_0x35f804(0x2b4),_0x108a24+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x108a24+=_0x35f804(0x28b),_0x108a24+=_0x35f804(0x188),_0x108a24+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x108a24+=_0x35f804(0x274),_0x108a24+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x108a24+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x108a24+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x5c4e87=_0x35f804(0x353);_0x5c4e87+='\x0a',_0x5c4e87+=_0x108a24,tgBot[_0x35f804(0x1af)]((_0x2ff64f,_0x205d34)=>{const _0x5bec95=_0x35f804;logger[_0x5bec95(0x1b4)](getTimeStamp()+_0x5bec95(0x176)),logger[_0x5bec95(0x182)](_0x5bec95(0x227),_0x2ff64f);}),tgBot[_0x35f804(0x17d)](async(_0x1c1b2c,_0x33119c)=>{const _0x49fab4=_0x35f804;if(!(!settings[_0x49fab4(0x2c2)]&&_0x1c1b2c[_0x49fab4(0x329)][_0x49fab4(0x18a)][_0x49fab4(0x314)]==_0x49fab4(0x319))){if(!validateTelegram(_0x1c1b2c))return;}_0x33119c();}),tgBot[_0x35f804(0x306)](_0x35f804(0x1e0),async _0xcdc4e1=>{const _0x79820b=_0x35f804;if(!settings[_0x79820b(0x2c2)])updateSetting('telegramChatId',_0xcdc4e1[_0x79820b(0x2a2)]['id']);updateSetting(_0x79820b(0x309),!![]);if(!validateTelegram(_0xcdc4e1))return;await sendTelegram(_0xcdc4e1[_0x79820b(0x2a2)]['id'],_0x5c4e87);}),tgBot[_0x35f804(0x306)](_0x35f804(0x1fb),async _0x45c14f=>{const _0x595828=_0x35f804;updateSetting(_0x595828(0x309),!![]),await sendTelegram(_0x45c14f['chat']['id'],_0x595828(0x195));}),tgBot[_0x35f804(0x306)]('disable',async _0x215597=>{const _0x3906a0=_0x35f804;await sendTelegram(_0x215597[_0x3906a0(0x2a2)]['id'],_0x3906a0(0x1f6)),updateSetting(_0x3906a0(0x309),![]);}),tgBot[_0x35f804(0x306)](_0x35f804(0x1ea),async _0x64c244=>{const _0x5dd7dd=_0x35f804,_0x26dcac=Markup[_0x5dd7dd(0x32a)]([Markup[_0x5dd7dd(0x1a5)][_0x5dd7dd(0x337)]('Orders',_0x5dd7dd(0x234)),Markup[_0x5dd7dd(0x1a5)][_0x5dd7dd(0x337)](_0x5dd7dd(0x2e6),_0x5dd7dd(0x17c)),Markup['button'][_0x5dd7dd(0x337)](_0x5dd7dd(0x1b3),_0x5dd7dd(0x330))]);_0x64c244['reply'](_0x5dd7dd(0x201),_0x26dcac);}),tgBot[_0x35f804(0x371)](_0x35f804(0x234),async _0x3474d6=>{const _0x516e7b=_0x35f804;_0x3474d6['editMessageReplyMarkup'](),updateSetting(_0x516e7b(0x2cd),_0x516e7b(0x2ba)),updateSetting(_0x516e7b(0x309),!![]),await sendTelegram(_0x3474d6[_0x516e7b(0x2a2)]['id'],_0x516e7b(0x25f));}),tgBot['action']('config_alerts',async _0x1d3694=>{const _0x268c83=_0x35f804;_0x1d3694[_0x268c83(0x36e)](),updateSetting(_0x268c83(0x2cd),_0x268c83(0x300)),updateSetting(_0x268c83(0x309),!![]),await sendTelegram(_0x1d3694['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x35f804(0x371)]('config_all',async _0x7c5f93=>{const _0x4c258b=_0x35f804;_0x7c5f93[_0x4c258b(0x36e)](),updateSetting(_0x4c258b(0x2cd),_0x4c258b(0x23c)),updateSetting(_0x4c258b(0x309),!![]),await sendTelegram(_0x7c5f93[_0x4c258b(0x2a2)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x35f804(0x306)](_0x35f804(0x2f2),async _0x1b7c12=>{const _0x30bb8a=_0x35f804,_0x358287=getBotsWithMode();let _0x4da278=_0x30bb8a(0x34b);config['forEach'](_0x3fcd6f=>{const _0x310027=_0x30bb8a,_0x4acd4d=_0x358287[_0x310027(0x343)](_0x5ec9a9=>_0x5ec9a9[_0x310027(0x277)]==_0x3fcd6f[_0x310027(0x277)])[_0x310027(0x2ac)];_0x4da278+='Bot\x20'+_0x3fcd6f[_0x310027(0x277)]+':\x20'+_0x3fcd6f[_0x310027(0x2f2)]+_0x310027(0x35f)+_0x4acd4d+'\x20|\x20'+_0x3fcd6f[_0x310027(0x187)]+'\x0a';}),_0x4da278+='\x0a',_0x4da278+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4da278+=!settings[_0x30bb8a(0x309)]?_0x30bb8a(0x372):'Notifications\x20enabled\x0a',_0x4da278+=settings[_0x30bb8a(0x309)]?settings['telegramEvents']=='all'?_0x30bb8a(0x370):_0x30bb8a(0x18d)+settings[_0x30bb8a(0x2cd)]+'\x20only\x0a':'',await sendTelegram(_0x1b7c12[_0x30bb8a(0x2a2)]['id'],_0x4da278,{'parse_mode':_0x30bb8a(0x33b)});}),tgBot[_0x35f804(0x306)](_0x35f804(0x184),async _0x43b014=>{const _0x456914=_0x35f804,_0x5b9244=getEnabledBots();if(_0x5b9244[_0x456914(0x2ec)]==0x0)await sendTelegram(_0x43b014['chat']['id'],_0x456914(0x30f));else{if(_0x5b9244[_0x456914(0x2ec)]>0x1)_0x5b9244[_0x456914(0x308)]({'botID':_0x456914(0x23c)});let _0x1286d7=[],_0x569e1d=[];const _0x9c7c75=_0x5b9244['length']%0x4==0x0||_0x5b9244[_0x456914(0x2ec)]%0x4==0x3||_0x5b9244[_0x456914(0x2ec)]%0x3==0x1?0x4:0x3;let _0x450621=0x0;_0x5b9244[_0x456914(0x2ad)]((_0x35711c,_0x5ad58e)=>{const _0x486a2c=_0x456914;if(_0x5ad58e%_0x9c7c75==0x0)_0x569e1d=[];_0x569e1d[_0x486a2c(0x308)](Markup[_0x486a2c(0x1a5)]['callback'](_0x35711c[_0x486a2c(0x277)]==_0x486a2c(0x23c)?_0x486a2c(0x2bb):_0x486a2c(0x355)+_0x35711c[_0x486a2c(0x277)],'restart_'+_0x35711c[_0x486a2c(0x277)])),_0x5ad58e%_0x9c7c75==0x0&&(_0x1286d7[_0x450621]=_0x569e1d,_0x450621++);});const _0x3bfc9e=Markup[_0x456914(0x32a)](_0x1286d7);_0x43b014[_0x456914(0x1b1)](_0x456914(0x24e),_0x3bfc9e);}}),tgBot[_0x35f804(0x371)](/restart_(.+)/,async _0x12f9f5=>{const _0x30fe10=_0x35f804,_0x5601fe=_0x12f9f5[_0x30fe10(0x22a)][0x1];_0x12f9f5['editMessageReplyMarkup'](),_0x5601fe==_0x30fe10(0x23c)?config['forEach'](_0xc458de=>{restartBot(_0xc458de['botID']);}):restartBot(_0x5601fe);}),tgBot[_0x35f804(0x306)]('on',async _0x5bfd9b=>{const _0x1ae025=_0x35f804,_0x572c13=getDisabledBots();if(_0x572c13['length']==0x0)await sendTelegram(_0x5bfd9b[_0x1ae025(0x2a2)]['id'],_0x1ae025(0x190));else{if(_0x572c13['length']>0x1)_0x572c13['push']({'botID':'all'});let _0x241d5d=[],_0x240e64=[];const _0x32f894=_0x572c13[_0x1ae025(0x2ec)]%0x4==0x0||_0x572c13[_0x1ae025(0x2ec)]%0x4==0x3||_0x572c13[_0x1ae025(0x2ec)]%0x3==0x1?0x4:0x3;let _0x1794e1=0x0;_0x572c13[_0x1ae025(0x2ad)]((_0x245712,_0x4545b0)=>{const _0x83aee4=_0x1ae025;if(_0x4545b0%_0x32f894==0x0)_0x240e64=[];_0x240e64[_0x83aee4(0x308)](Markup[_0x83aee4(0x1a5)][_0x83aee4(0x337)](_0x245712[_0x83aee4(0x277)]==_0x83aee4(0x23c)?_0x83aee4(0x2bb):_0x83aee4(0x355)+_0x245712[_0x83aee4(0x277)],'on_'+_0x245712[_0x83aee4(0x277)])),_0x4545b0%_0x32f894==0x0&&(_0x241d5d[_0x1794e1]=_0x240e64,_0x1794e1++);});const _0x184e2b=Markup['inlineKeyboard'](_0x241d5d);_0x5bfd9b[_0x1ae025(0x1b1)](_0x1ae025(0x1c3),_0x184e2b);}}),tgBot[_0x35f804(0x371)](/on_(.+)/,async _0x7b61d1=>{const _0x417e4d=_0x35f804,_0x5eae32=_0x7b61d1[_0x417e4d(0x22a)][0x1];_0x7b61d1['editMessageReplyMarkup']();if(_0x5eae32=='all'){const _0x5a559b=getDisabledBots();await sendTelegram(_0x7b61d1[_0x417e4d(0x2a2)]['id'],_0x417e4d(0x350)),_0x5a559b[_0x417e4d(0x2ad)](_0x47ee4e=>{const _0x3308fb=_0x417e4d;if(_0x47ee4e['botID']!=_0x3308fb(0x23c))toggleBot(_0x47ee4e[_0x3308fb(0x277)],toggleStatus(_0x47ee4e[_0x3308fb(0x277)]),_0x3308fb(0x335));});}else await sendTelegram(_0x7b61d1['chat']['id'],_0x417e4d(0x27e)+_0x5eae32),toggleBot(_0x5eae32,toggleStatus(_0x5eae32),'stopped');}),tgBot[_0x35f804(0x306)]('off',async _0x4137ed=>{const _0x5a584c=_0x35f804,_0xb0aa9c=getEnabledBots();if(_0xb0aa9c[_0x5a584c(0x2ec)]==0x0)await sendTelegram(_0x4137ed[_0x5a584c(0x2a2)]['id'],_0x5a584c(0x30f));else{if(_0xb0aa9c[_0x5a584c(0x2ec)]>0x1)_0xb0aa9c['push']({'botID':_0x5a584c(0x23c)});let _0x4893c1=[],_0x4bc777=[];const _0x3c11a5=_0xb0aa9c[_0x5a584c(0x2ec)]%0x4==0x0||_0xb0aa9c[_0x5a584c(0x2ec)]%0x4==0x3||_0xb0aa9c[_0x5a584c(0x2ec)]%0x3==0x1?0x4:0x3;let _0x2e2b0a=0x0;_0xb0aa9c[_0x5a584c(0x2ad)]((_0xc90ecd,_0x4c5b5e)=>{const _0x1d4538=_0x5a584c;if(_0x4c5b5e%_0x3c11a5==0x0)_0x4bc777=[];_0x4bc777['push'](Markup[_0x1d4538(0x1a5)][_0x1d4538(0x337)](_0xc90ecd['botID']==_0x1d4538(0x23c)?_0x1d4538(0x2bb):_0x1d4538(0x355)+_0xc90ecd[_0x1d4538(0x277)],_0x1d4538(0x296)+_0xc90ecd[_0x1d4538(0x277)])),_0x4c5b5e%_0x3c11a5==0x0&&(_0x4893c1[_0x2e2b0a]=_0x4bc777,_0x2e2b0a++);});const _0x49d809=Markup[_0x5a584c(0x32a)](_0x4893c1);_0x4137ed[_0x5a584c(0x1b1)](_0x5a584c(0x25e),_0x49d809);}}),tgBot['action'](/off_(.+)/,async _0x21cf74=>{const _0x569c92=_0x35f804,_0x4c1248=_0x21cf74['match'][0x1];_0x21cf74[_0x569c92(0x36e)]();if(_0x4c1248==_0x569c92(0x23c)){const _0x99f39f=getEnabledBots();await sendTelegram(_0x21cf74[_0x569c92(0x2a2)]['id'],_0x569c92(0x1ab)),_0x99f39f[_0x569c92(0x2ad)](_0x340445=>{const _0x3d2444=_0x569c92;if(_0x340445[_0x3d2444(0x277)]!='all')toggleBot(_0x340445['botID'],toggleStatus(_0x340445[_0x3d2444(0x277)]),_0x3d2444(0x335));});}else await sendTelegram(_0x21cf74[_0x569c92(0x2a2)]['id'],_0x569c92(0x196)+_0x4c1248),toggleBot(_0x4c1248,toggleStatus(_0x4c1248),_0x569c92(0x335));}),tgBot[_0x35f804(0x306)]('metrics',async _0x24cefa=>{const _0x23a4c7=_0x35f804,_0x4cbaea=getEnabledBots();if(_0x4cbaea[_0x23a4c7(0x2ec)]==0x0)await sendTelegram(_0x24cefa['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4cbaea['length']>0x1){let _0x415d1b=[],_0x21d0a8=[];const _0x3007c7=_0x4cbaea['length']%0x4==0x0||_0x4cbaea[_0x23a4c7(0x2ec)]%0x4==0x3||_0x4cbaea[_0x23a4c7(0x2ec)]%0x3==0x1?0x4:0x3;let _0x5d7206=0x0;_0x4cbaea[_0x23a4c7(0x2ad)]((_0x4ffde4,_0x25f3e4)=>{const _0x4d0591=_0x23a4c7;if(_0x25f3e4%_0x3007c7==0x0)_0x21d0a8=[];_0x21d0a8[_0x4d0591(0x308)](Markup[_0x4d0591(0x1a5)]['callback']('Bot\x20'+_0x4ffde4['botID'],_0x4d0591(0x305)+_0x4ffde4[_0x4d0591(0x277)])),_0x25f3e4%_0x3007c7==0x0&&(_0x415d1b[_0x5d7206]=_0x21d0a8,_0x5d7206++);});const _0x245344=Markup[_0x23a4c7(0x32a)](_0x415d1b);_0x24cefa['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x245344);}else{const _0x36d99c=_0x4cbaea[0x0]['botID'];if(pid[_0x36d99c])pid[_0x36d99c][_0x23a4c7(0x28c)]({'function':_0x23a4c7(0x18b),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x2bb947=>{const _0x21760c=_0x35f804,_0x4bd2ca=_0x2bb947[_0x21760c(0x22a)][0x1];_0x2bb947['editMessageReplyMarkup']();if(pid[_0x4bd2ca])pid[_0x4bd2ca][_0x21760c(0x28c)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x35f804(0x306)](_0x35f804(0x323),async _0x195266=>{const _0x164c7f=_0x35f804,_0x167c18=getEnabledBots();if(_0x167c18[_0x164c7f(0x2ec)]==0x0)await sendTelegram(_0x195266['chat']['id'],_0x164c7f(0x30f));else{if(_0x167c18[_0x164c7f(0x2ec)]>0x1){let _0x36f8db=[],_0x13b9da=[];const _0x39378b=_0x167c18['length']%0x4==0x0||_0x167c18[_0x164c7f(0x2ec)]%0x4==0x3||_0x167c18[_0x164c7f(0x2ec)]%0x3==0x1?0x4:0x3;let _0x44bcc1=0x0;_0x167c18[_0x164c7f(0x2ad)]((_0x43f63c,_0x7de85f)=>{const _0xb16fe=_0x164c7f;if(_0x7de85f%_0x39378b==0x0)_0x13b9da=[];_0x13b9da[_0xb16fe(0x308)](Markup['button'][_0xb16fe(0x337)]('Bot\x20'+_0x43f63c[_0xb16fe(0x277)],_0xb16fe(0x214)+_0x43f63c[_0xb16fe(0x277)])),_0x7de85f%_0x39378b==0x0&&(_0x36f8db[_0x44bcc1]=_0x13b9da,_0x44bcc1++);});const _0x59427f=Markup[_0x164c7f(0x32a)](_0x36f8db);_0x195266[_0x164c7f(0x1b1)](_0x164c7f(0x242),_0x59427f);}else{const _0x4723a9=_0x167c18[0x0]['botID'];if(pid[_0x4723a9])pid[_0x4723a9][_0x164c7f(0x28c)]({'function':_0x164c7f(0x342),'args':null});}}}),tgBot[_0x35f804(0x371)](/portfolio_(.+)/,async _0x5673f9=>{const _0x520528=_0x35f804,_0x1b633c=_0x5673f9[_0x520528(0x22a)][0x1];_0x5673f9[_0x520528(0x36e)]();if(pid[_0x1b633c])pid[_0x1b633c][_0x520528(0x28c)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x35f804(0x306)](_0x35f804(0x329),async _0x22d951=>{const _0x15c0c2=_0x35f804;await getMessages();if(!updateAvailable)await sendTelegram(_0x22d951[_0x15c0c2(0x2a2)]['id'],_0x15c0c2(0x276));else{if(!validInstallation)await sendTelegram(_0x22d951[_0x15c0c2(0x2a2)]['id'],_0x15c0c2(0x1ce));else{const _0x4b3330=Markup[_0x15c0c2(0x32a)]([Markup[_0x15c0c2(0x1a5)][_0x15c0c2(0x337)](_0x15c0c2(0x20c),_0x15c0c2(0x2b8)),Markup['button'][_0x15c0c2(0x337)]('No','update_no')]);_0x22d951['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x4b3330);}}}),tgBot[_0x35f804(0x371)](/update_(.+)/,async _0x176cd7=>{const _0x250159=_0x35f804,_0x22f586=_0x176cd7[_0x250159(0x22a)][0x1];_0x176cd7['editMessageReplyMarkup'](),_0x22f586==_0x250159(0x225)&&(await sendTelegram(_0x176cd7[_0x250159(0x2a2)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x250159(0x329))),_0x22f586=='no'&&await sendTelegram(_0x176cd7[_0x250159(0x2a2)]['id'],_0x250159(0x29e));}),tgBot[_0x35f804(0x306)](_0x35f804(0x191),async _0x41dc8f=>{const _0x316354=_0x35f804;if(!validInstallation)await sendTelegram(_0x41dc8f[_0x316354(0x2a2)]['id'],_0x316354(0x2f1));else{const _0x1a2018=Markup[_0x316354(0x32a)]([Markup['button'][_0x316354(0x337)](_0x316354(0x20c),_0x316354(0x1ed)),Markup[_0x316354(0x1a5)][_0x316354(0x337)]('No',_0x316354(0x361))]);_0x41dc8f[_0x316354(0x1b1)](_0x316354(0x1f0),_0x1a2018);}}),tgBot[_0x35f804(0x371)](/reinstall_(.+)/,async _0x1bf869=>{const _0x59fbbf=_0x35f804,_0x299036=_0x1bf869[_0x59fbbf(0x22a)][0x1];_0x1bf869[_0x59fbbf(0x36e)](),_0x299036==_0x59fbbf(0x225)&&(await sendTelegram(_0x1bf869[_0x59fbbf(0x2a2)]['id'],_0x59fbbf(0x30c)),updateBB(_0x59fbbf(0x191))),_0x299036=='no'&&await sendTelegram(_0x1bf869[_0x59fbbf(0x2a2)]['id'],_0x59fbbf(0x31f));}),tgBot['command']('toggle',async _0x2a53d5=>{const _0x2f0b17=_0x35f804,_0x35dba0=getBotsWithMode();if(_0x35dba0[_0x2f0b17(0x2ec)]==0x0)await sendTelegram(_0x2a53d5[_0x2f0b17(0x2a2)]['id'],_0x2f0b17(0x30f));else{let _0x276a84=[],_0x3b8692=[];const _0xd98a8d=0x2;let _0x2a5a3f=0x0;_0x35dba0[_0x2f0b17(0x2ad)]((_0x552a38,_0x358cbb)=>{const _0x465b6d=_0x2f0b17;if(_0x358cbb%_0xd98a8d==0x0)_0x3b8692=[];_0x3b8692['push'](Markup[_0x465b6d(0x1a5)][_0x465b6d(0x337)](_0x465b6d(0x355)+_0x552a38[_0x465b6d(0x277)]+'\x20('+_0x552a38[_0x465b6d(0x2ac)]+')',_0x465b6d(0x303)+_0x552a38[_0x465b6d(0x277)])),_0x358cbb%_0xd98a8d==0x0&&(_0x276a84[_0x2a5a3f]=_0x3b8692,_0x2a5a3f++);});const _0x31ec1b=Markup[_0x2f0b17(0x32a)](_0x276a84);_0x2a53d5[_0x2f0b17(0x1b1)](_0x2f0b17(0x326),_0x31ec1b);}}),tgBot[_0x35f804(0x371)](/toggle_(.+)/,async _0x381f68=>{const _0x168cd7=_0x35f804,_0x50e65e=_0x381f68['match'][0x1];_0x381f68[_0x168cd7(0x36e)]();const _0x29e2f8=getBotsWithMode(),_0xf79e57=_0x29e2f8[_0x168cd7(0x343)](_0x31fdef=>_0x31fdef[_0x168cd7(0x277)]==_0x50e65e),_0x139534=_0xf79e57[_0x168cd7(0x2ac)]==_0x168cd7(0x1f5)?'manual':'auto';await sendTelegram(_0x381f68[_0x168cd7(0x2a2)]['id'],_0x168cd7(0x189)+_0x50e65e+_0x168cd7(0x1f2)+_0x139534+_0x168cd7(0x2f0)),toggleBotMode(_0x50e65e);}),tgBot[_0x35f804(0x306)](_0x35f804(0x177),async _0x16df8f=>{const _0x233365=_0x35f804;let _0x7c38f6='';config[_0x233365(0x2ad)](_0x7656b8=>{const _0x229c1b=_0x233365;_0x7c38f6+=_0x229c1b(0x355)+_0x7656b8['botID']+':\x20'+_0x7656b8['botname']+'\x0a';}),await sendTelegram(_0x16df8f[_0x233365(0x2a2)]['id'],_0x7c38f6,{'parse_mode':_0x233365(0x33b)});}),tgBot[_0x35f804(0x306)](_0x35f804(0x362),async _0x169a8e=>{const _0x573f4a=_0x35f804;await sendTelegram(_0x169a8e[_0x573f4a(0x2a2)]['id'],_0x108a24);}),process[_0x35f804(0x23f)]('SIGINT',()=>tgBot['stop'](_0x35f804(0x1fa))),process[_0x35f804(0x23f)](_0x35f804(0x216),()=>tgBot[_0x35f804(0x1e4)]('SIGTERM')),tgBot['launch']();}}function disableTelegram(){const _0x17bbeb=_0x5b7969;tgBot&&tgBot[_0x17bbeb(0x1e4)]();}async function sendTelegram(_0x5eea68,_0x2616ef,_0x3f707a){const _0x30e4bd=_0x5b7969;try{await tgBot[_0x30e4bd(0x233)][_0x30e4bd(0x356)](_0x5eea68,_0x2616ef,_0x3f707a);}catch(_0x4a3234){console[_0x30e4bd(0x2e4)]('Telegram\x20error:',_0x4a3234);}}async function sendTelegramBot(_0x582977,_0x58111b){const _0x26c7dc=_0x5b7969;if(settings[_0x26c7dc(0x309)]){if(settings[_0x26c7dc(0x2cd)]==_0x26c7dc(0x23c)||(_0x58111b['type']==_0x26c7dc(0x298)||_0x58111b[_0x26c7dc(0x2fd)]=='warning'||_0x58111b[_0x26c7dc(0x2fd)]=='success')&&settings[_0x26c7dc(0x2cd)]==_0x26c7dc(0x300)||_0x58111b[_0x26c7dc(0x2fd)]==_0x26c7dc(0x2d3)&&settings[_0x26c7dc(0x2cd)]==_0x26c7dc(0x2ba)){if(tgBot&&settings[_0x26c7dc(0x2c2)]){if(_0x58111b[_0x26c7dc(0x230)])await sendTelegram(settings['telegramChatId'],_0x58111b[_0x26c7dc(0x2c1)]+'\x20>\x20'+_0x58111b[_0x26c7dc(0x19e)]);else await sendTelegram(settings[_0x26c7dc(0x2c2)],'Bot\x20'+_0x582977+_0x26c7dc(0x1f4)+_0x58111b[_0x26c7dc(0x19e)]);}}}}async function sendTelegramMsg(_0x5b3983,_0x457779='HTML'){const _0x1582c5=_0x5b7969;return settings['telegramEnabled']&&tgBot&&settings[_0x1582c5(0x2c2)]?(await sendTelegram(settings['telegramChatId'],_0x5b3983,{'parse_mode':_0x457779}),!![]):![];}function getDeviceWithIp(_0x163173){const _0x42fe7c=_0x5b7969;return devices[_0x42fe7c(0x343)](_0x55f216=>_0x55f216['ip']===_0x163173);}async function temporaryAccess2FA(_0x195f04,_0x164643){const _0x5c3091=_0x5b7969;let _0x160166=new Date(),_0x32472e=![];if(lastIpApproval){if(_0x160166-lastIpApproval<0x1388)_0x32472e=!![];}lastIpApproval=new Date();if(_0x32472e)return;if(tgBot&&settings[_0x5c3091(0x2c2)]){const _0x8ad30d=uuidRandom();tmpStorage[_0x8ad30d]={'uuid':_0x195f04,'externalip':_0x164643};const _0x2dd304=Markup[_0x5c3091(0x32a)]([Markup[_0x5c3091(0x1a5)][_0x5c3091(0x337)](_0x5c3091(0x20d),_0x5c3091(0x18f)+_0x8ad30d),Markup[_0x5c3091(0x1a5)]['callback'](_0x5c3091(0x180),'tempaccess_15_'+_0x8ad30d),Markup['button'][_0x5c3091(0x337)](_0x5c3091(0x365),'tempaccess_30_'+_0x8ad30d),Markup[_0x5c3091(0x1a5)][_0x5c3091(0x337)]('reject',_0x5c3091(0x2cf)+_0x8ad30d)]);await sendTelegram(settings[_0x5c3091(0x2c2)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x164643)[_0x5c3091(0x31e)]+'\x20?',_0x2dd304),tgBot[_0x5c3091(0x371)](/tempaccess_(.+)_(.+)/,async _0x5b16be=>{const _0x53477c=_0x5c3091,_0x4d48bd=_0x5b16be[_0x53477c(0x22a)][0x1],_0x3d5fe1=_0x5b16be[_0x53477c(0x22a)][0x2],{uuid:_0x52a5fd,externalip:_0x48ea5f}=tmpStorage[_0x3d5fe1];delete tmpStorage[_0x3d5fe1],_0x5b16be['editMessageReplyMarkup'](),devices[_0x52a5fd][_0x53477c(0x220)]={'clientip':_0x48ea5f,'timestamp':new Date()[_0x53477c(0x28a)](),'expiry':_0x4d48bd},_0x4d48bd!='reject'?(await sendTelegram(_0x5b16be[_0x53477c(0x2a2)]['id'],_0x53477c(0x29f)+_0x4d48bd+_0x53477c(0x1d9),{'parse_mode':_0x53477c(0x33b)}),io['to'](_0x52a5fd)[_0x53477c(0x375)](_0x53477c(0x2f2),{'access':{'allow':![],'reason':_0x53477c(0x221),'token':null}})):(await sendTelegram(_0x5b16be[_0x53477c(0x2a2)]['id'],_0x53477c(0x2d6)),io['to'](_0x52a5fd)[_0x53477c(0x375)]('status',{'access':{'allow':![],'reason':_0x53477c(0x2b6),'token':null}}));});}}async function loginAccess2FA(_0x99c0aa,_0xfca41a){const _0x49f617=_0x5b7969;if(tgBot&&settings[_0x49f617(0x2c2)]){const _0x2bf2f2=uuidRandom();tmpStorage[_0x2bf2f2]={'uuid':_0x99c0aa,'externalip':_0xfca41a};const _0xe9a15f=Markup['inlineKeyboard']([Markup[_0x49f617(0x1a5)][_0x49f617(0x337)](_0x49f617(0x20b),_0x49f617(0x207)+loginExpiry+'_'+_0x2bf2f2),Markup[_0x49f617(0x1a5)][_0x49f617(0x337)](_0x49f617(0x327),_0x49f617(0x32f)+_0x2bf2f2)]);await sendTelegram(settings[_0x49f617(0x2c2)],_0x49f617(0x206)+normalizeIP(_0xfca41a)[_0x49f617(0x31e)]+'\x20?',_0xe9a15f),tgBot[_0x49f617(0x371)](/login2fa_(.+)_(.+)/,async _0x2ac1d4=>{const _0x19ff80=_0x49f617,_0x5d73ee=_0x2ac1d4[_0x19ff80(0x22a)][0x1],_0x3b5d78=_0x2ac1d4[_0x19ff80(0x22a)][0x2],{uuid:_0x5257a5,externalip:_0x64019f}=tmpStorage[_0x3b5d78];delete tmpStorage[_0x3b5d78],_0x2ac1d4[_0x19ff80(0x36e)](),devices[_0x5257a5]['telegram2FaApproval']={'clientip':_0x64019f,'timestamp':new Date()[_0x19ff80(0x28a)](),'expiry':_0x5d73ee},_0x5d73ee!=_0x19ff80(0x327)?(await sendTelegram(_0x2ac1d4[_0x19ff80(0x2a2)]['id'],'Login\x20accepted',{'parse_mode':_0x19ff80(0x33b)}),io['to'](_0x5257a5)[_0x19ff80(0x375)](_0x19ff80(0x2f2),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x2ac1d4[_0x19ff80(0x2a2)]['id'],_0x19ff80(0x2d4)),io['to'](_0x5257a5)[_0x19ff80(0x375)](_0x19ff80(0x2f2),{'access':{'allow':![],'reason':_0x19ff80(0x2f5),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1f0d49=_0x5b7969;return dbConfig[_0x1f0d49(0x1cf)](_0x1f0d49(0x292))[_0x1f0d49(0x33d)](_0x1f0d49(0x277))[_0x1f0d49(0x235)]({'status':'enabled'})[_0x1f0d49(0x34c)]()||[];}function getDisabledBots(){const _0x3c37c7=_0x5b7969;return dbConfig[_0x3c37c7(0x1cf)](_0x3c37c7(0x292))[_0x3c37c7(0x33d)](_0x3c37c7(0x277))[_0x3c37c7(0x235)]({'status':_0x3c37c7(0x238)})['value']()||[];}function getBotAttributes(_0x21c429){const _0x11a15d=_0x5b7969;let _0x57881a={};const _0xfa765b=configpath+_0x11a15d(0x35e)+_0x21c429+_0x11a15d(0x2e9),_0x42ba0e=fs['existsSync'](_0xfa765b);if(_0x42ba0e){const _0x8ad0ed=fs[_0x11a15d(0x21f)](_0xfa765b);try{const _0x265ff7=JSON[_0x11a15d(0x36f)](_0x8ad0ed),_0x2302cf=_0x265ff7?_0x265ff7['bot'][0x0][_0x11a15d(0x181)]:![];_0x57881a['mode']=_0x2302cf?_0x11a15d(0x1f5):_0x11a15d(0x17e),_0x57881a[_0x11a15d(0x2c1)]=_0x265ff7?_0x265ff7[_0x11a15d(0x331)][0x0][_0x11a15d(0x2c1)]:_0x11a15d(0x355)+_0x21c429;}catch(_0x17a195){_0x57881a[_0x11a15d(0x2ac)]=_0x11a15d(0x17e),_0x57881a['botname']='Bot\x20'+_0x21c429;}}else _0x57881a['mode']=_0x11a15d(0x17e),_0x57881a[_0x11a15d(0x2c1)]=_0x11a15d(0x355)+_0x21c429;return _0x57881a;}function getBotsWithMode(){const _0x2ce053=_0x5b7969,_0x2dde0a=dbConfig['get'](_0x2ce053(0x292))[_0x2ce053(0x33d)](_0x2ce053(0x277))[_0x2ce053(0x34c)]()||[];return _0x2dde0a[_0x2ce053(0x2ad)](_0x1e8fc6=>{const _0x35275f=_0x2ce053;let _0x2b8a00=getBotAttributes(_0x1e8fc6[_0x35275f(0x277)]);_0x1e8fc6[_0x35275f(0x2ac)]=_0x2b8a00[_0x35275f(0x2ac)];}),_0x2dde0a;}function getBotExchanges(){const _0x3af1da=_0x5b7969;let _0x3c2ae0=[];const _0x2e5d75=dbConfig[_0x3af1da(0x1cf)](_0x3af1da(0x292))[_0x3af1da(0x33d)](_0x3af1da(0x277))[_0x3af1da(0x34c)]()||[];_0x2e5d75['forEach'](_0x1a43d1=>{const _0xde52fe=_0x3af1da;if(_0x1a43d1[_0xde52fe(0x2f2)]==_0xde52fe(0x2c9)){const _0x3fe711=configpath+_0xde52fe(0x35e)+_0x1a43d1[_0xde52fe(0x277)]+_0xde52fe(0x2e9),_0x212d74=fs[_0xde52fe(0x34a)](_0x3fe711);let _0x580a65;if(_0x212d74){const _0x471964=fs[_0xde52fe(0x21f)](_0x3fe711);try{const _0x493f08=JSON['parse'](_0x471964);_0x580a65=_0x493f08?_0x493f08[_0xde52fe(0x331)][0x0]['exchange']:null;}catch(_0x58758a){}}if(_0x580a65)_0x3c2ae0[_0xde52fe(0x308)](_0x580a65);}});const _0xee9170=[...new Set(_0x3c2ae0)][_0x3af1da(0x1cd)]();return _0xee9170;}async function initUser(){const _0x38c6a2=_0x5b7969;if(!settings[_0x38c6a2(0x1b7)]){const _0x1656ac=uuidRandom();mixpanel[_0x38c6a2(0x349)](_0x1656ac),updateSetting(_0x38c6a2(0x1b7),_0x1656ac);}}async function initSecure(){const _0x478d22=_0x5b7969;let _0xd9ed79=getSecure();if(!_0xd9ed79[_0x478d22(0x1f9)](_0x478d22(0x1e8))){let _0x433307=await generateKeys();_0xd9ed79[_0x478d22(0x1ca)]=_0x433307['publicKey'],_0xd9ed79[_0x478d22(0x2f9)]=_0x433307[_0x478d22(0x2f9)],_0xd9ed79[_0x478d22(0x1e8)]=crypto[_0x478d22(0x26f)](0x20)[_0x478d22(0x2d0)](_0x478d22(0x2e3));;storeSecure(_0xd9ed79);}}function getSettings(){return dbSettings['get']('settings')['value']()||{};}function getSecure(){const _0x34e020=_0x5b7969;return dbSecure[_0x34e020(0x1cf)]('secure')['value']()||{};}function getBlacklist(){const _0xb8e4bd=_0x5b7969;return dbSecure[_0xb8e4bd(0x1cf)](_0xb8e4bd(0x374))[_0xb8e4bd(0x34c)]()||[];}function broadcastToBots(_0x52f701,_0x53ec7c){const _0x524ff4=_0x5b7969;config[_0x524ff4(0x2ad)](_0x46c320=>{const _0xb74422=_0x524ff4;if(_0x46c320[_0xb74422(0x2f2)]==_0xb74422(0x2c9)&&_0x46c320['live']=='running'||_0x46c320[_0xb74422(0x2f2)]==_0xb74422(0x21b)&&_0x46c320['live']==_0xb74422(0x1e6)){if(pid[_0x46c320[_0xb74422(0x277)]])pid[_0x46c320[_0xb74422(0x277)]][_0xb74422(0x28c)]({[_0x52f701]:_0x53ec7c});}});}function storeSettings(_0x3a212c,_0x4bf7a8=![]){const _0x7c8cfc=_0x5b7969;_0x3a212c={...settings,..._0x3a212c};if(_0x4bf7a8&&_0x3a212c[_0x7c8cfc(0x192)]!=_0x7c8cfc(0x344)&&_0x3a212c[_0x7c8cfc(0x192)]!=_0x7c8cfc(0x24c)&&_0x3a212c['bbPassword']!=''){const _0x4fc02e=crypt[_0x7c8cfc(0x271)](secure[_0x7c8cfc(0x2f9)],_0x3a212c['bbPassword'])[_0x7c8cfc(0x18a)][_0x7c8cfc(0x260)]('@')[0x0],_0x39e3a2=bcrypt[_0x7c8cfc(0x186)](_0x4fc02e,saltRounds);_0x3a212c={..._0x3a212c,'bbPassword':_0x39e3a2};}if(_0x4bf7a8&&_0x3a212c[_0x7c8cfc(0x287)]!=_0x7c8cfc(0x344)&&_0x3a212c[_0x7c8cfc(0x287)]!=_0x7c8cfc(0x24c)&&_0x3a212c[_0x7c8cfc(0x287)]!=''){const _0x42d034=crypt[_0x7c8cfc(0x271)](secure['privateKey'],_0x3a212c[_0x7c8cfc(0x287)])[_0x7c8cfc(0x18a)][_0x7c8cfc(0x260)]('@')[0x0];_0x3a212c={..._0x3a212c,'telegramToken':_0x42d034};}const _0x36bb2a=_0x3a212c[_0x7c8cfc(0x287)]!='************'&&_0x3a212c[_0x7c8cfc(0x287)]!=settings[_0x7c8cfc(0x287)]||_0x3a212c[_0x7c8cfc(0x1e5)]!=settings[_0x7c8cfc(0x1e5)],_0x2cc0fb=_0x3a212c[_0x7c8cfc(0x287)]==''||_0x3a212c[_0x7c8cfc(0x1e5)]=='';_0x36bb2a&&(_0x3a212c[_0x7c8cfc(0x2c2)]=null,_0x3a212c[_0x7c8cfc(0x2cd)]='all');for(const [_0x223bb6,_0x4594ea]of Object['entries'](_0x3a212c)){if(_0x223bb6=='telegramToken'&&_0x4594ea=='************'){_0x3a212c['telegramToken']=settings['telegramToken'];continue;};if(_0x223bb6==_0x7c8cfc(0x192)&&_0x4594ea=='************'){_0x3a212c[_0x7c8cfc(0x192)]=settings['bbPassword'];continue;};dbSettings[_0x7c8cfc(0x1d8)](_0x7c8cfc(0x263)+_0x223bb6,_0x4594ea)[_0x7c8cfc(0x255)]();}settings=_0x3a212c,io['to'](_0x7c8cfc(0x1b5))['emit'](_0x7c8cfc(0x259),cleanSettings()),broadcastToBots(_0x7c8cfc(0x2b3),settings[_0x7c8cfc(0x2b3)]),broadcastToBots(_0x7c8cfc(0x2ef),settings[_0x7c8cfc(0x2ef)]);if(_0x36bb2a&&!_0x2cc0fb)initTelegram();if(_0x36bb2a&&_0x2cc0fb)disableTelegram();getAllClients()[_0x7c8cfc(0x2ad)](_0x3b52b7=>{const _0x53d145=_0x7c8cfc;getSocket(_0x3b52b7['id'])[_0x53d145(0x375)](_0x53d145(0x2f2),{'access':{'allow':![],'reason':_0x53d145(0x221),'token':null}});});}function updateSetting(_0x54f98b,_0x5071fa){const _0x5d652d=_0x5b7969;dbSettings[_0x5d652d(0x1d8)](_0x5d652d(0x263)+_0x54f98b,_0x5071fa)[_0x5d652d(0x255)](),settings=getSettings(),io['to'](_0x5d652d(0x1b5))[_0x5d652d(0x375)](_0x5d652d(0x259),cleanSettings());}function storeSecure(_0x517ad8){const _0x1670f0=_0x5b7969;dbSecure['get'](_0x1670f0(0x2f3))[_0x1670f0(0x308)](_0x517ad8)['write'](),secure=_0x517ad8;}function addBlacklist(_0x23e863){const _0x4bc38c=_0x5b7969;cleanBlacklist();let _0x1d57b2;devices[_0x23e863][_0x4bc38c(0x220)]?_0x1d57b2=Math['max'](devices[_0x23e863][_0x4bc38c(0x220)][_0x4bc38c(0x17a)],loginExpiry):_0x1d57b2=loginExpiry,dbSecure[_0x4bc38c(0x1cf)](_0x4bc38c(0x374))[_0x4bc38c(0x308)]({'expiry':new Date()[_0x4bc38c(0x28a)]()+_0x1d57b2*0x3c*0x3e8,'token':devices[_0x23e863]['access'][_0x4bc38c(0x1de)]})[_0x4bc38c(0x255)](),blacklist=dbSecure[_0x4bc38c(0x1cf)](_0x4bc38c(0x374))[_0x4bc38c(0x34c)]();}function cleanBlacklist(){const _0x120491=_0x5b7969;let _0x18db47=dbSecure[_0x120491(0x1cf)](_0x120491(0x374))[_0x120491(0x262)]()['value'](),_0x4ec6d1=new Date()[_0x120491(0x28a)]();_0x18db47['forEach'](_0xa78991=>{const _0x536028=_0x120491;_0xa78991[_0x536028(0x17a)]<_0x4ec6d1&&dbSecure[_0x536028(0x1cf)](_0x536028(0x374))['remove']({'expiry':_0xa78991[_0x536028(0x17a)]})[_0x536028(0x255)]();});}function initStates(){let _0x37881f=getConfiguration();_0x37881f['forEach'](_0x3a571f=>{const _0x4bb6b3=_0x303c;_0x3a571f[_0x4bb6b3(0x187)]=_0x4bb6b3(0x335);}),storeConfiguration(_0x37881f);}function onKeys(){const _0x2cb842=new RSA();return new Promise(_0x32d6df=>{const _0x46fa32=_0x303c;_0x2cb842['generateKeyPairAsync']()[_0x46fa32(0x2a5)](_0xccdb02=>{_0x32d6df(_0xccdb02);});});}async function generateKeys(){return await onKeys();}function _0x303c(_0xf6cda4,_0x5bc485){const _0x4f770b=_0x2e7a();return _0x303c=function(_0x154411,_0xd20935){_0x154411=_0x154411-0x176;let _0x2e7a16=_0x4f770b[_0x154411];return _0x2e7a16;},_0x303c(_0xf6cda4,_0x5bc485);}async function oneTimeMigration(){const _0x2fdd22=_0x5b7969;let _0x124ab2=getSettings(),_0x53d2e0=![];!_0x124ab2[_0x2fdd22(0x1f9)](_0x2fdd22(0x1c6))&&(_0x124ab2[_0x2fdd22(0x1c6)]=0x0,_0x53d2e0=!![]);!_0x124ab2[_0x2fdd22(0x1f9)](_0x2fdd22(0x17f))&&(_0x124ab2['lastmsgemitted']=0x0,_0x53d2e0=!![]);!_0x124ab2[_0x2fdd22(0x1f9)]('latestversion')&&(_0x124ab2[_0x2fdd22(0x2c6)]=_0x2fdd22(0x18e),_0x53d2e0=!![]);!_0x124ab2[_0x2fdd22(0x1f9)](_0x2fdd22(0x2ef))&&(_0x124ab2[_0x2fdd22(0x2ef)]=![],_0x53d2e0=!![]);if(_0x53d2e0)storeSettings(_0x124ab2);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x2fdd22(0x2ad)](_0x1c3ef6=>{const _0x41d866=_0x2fdd22;if(!_0x1c3ef6['isDirectory']()){if(!_0x1c3ef6[_0x41d866(0x1ef)][_0x41d866(0x24a)](_0x41d866(0x293)))fs[_0x41d866(0x204)](configbackuppath+_0x1c3ef6[_0x41d866(0x1ef)]);}else fs[_0x41d866(0x333)](configbackuppath+_0x1c3ef6[_0x41d866(0x1ef)],{'recursive':!![]});});}catch(_0x31e3c1){logger[_0x2fdd22(0x182)](_0x2fdd22(0x19b),_0x31e3c1);}}function storeConfiguration(_0x5c06cf){const _0x5d78fb=_0x5b7969;dbConfig[_0x5d78fb(0x1cf)](_0x5d78fb(0x292))[_0x5d78fb(0x35b)]()[_0x5d78fb(0x255)](),dbConfig[_0x5d78fb(0x1cf)](_0x5d78fb(0x292))['push'](..._0x5c06cf)['write'](),config=_0x5c06cf;}async function resetPassword(){const _0x503f21=_0x5b7969;if(tgBot&&settings[_0x503f21(0x2c2)]){const _0x5d2d65=Markup[_0x503f21(0x32a)]([Markup[_0x503f21(0x1a5)][_0x503f21(0x337)](_0x503f21(0x225),'resetpw_yes'),Markup[_0x503f21(0x1a5)][_0x503f21(0x337)]('no','resetpw_no')]);await sendTelegram(settings[_0x503f21(0x2c2)],_0x503f21(0x377),_0x5d2d65),tgBot['action'](/resetpw_(.+)/,async _0x366a2a=>{const _0x39b166=_0x503f21,_0x4207ed=_0x366a2a[_0x39b166(0x22a)][0x1];_0x366a2a['editMessageReplyMarkup']();if(_0x4207ed!='no'){const _0x245181=0xf,_0x3cdbfe='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x54306a=Array['from'](crypto[_0x39b166(0x25b)](new Uint32Array(_0x245181)))[_0x39b166(0x212)](_0x24abf0=>_0x3cdbfe[_0x24abf0%_0x3cdbfe[_0x39b166(0x2ec)]])[_0x39b166(0x1a9)](''),_0x3353ef=bcrypt[_0x39b166(0x186)](_0x54306a,saltRounds);storeSettings({'bbPassword':_0x3353ef}),await sendTelegram(_0x366a2a['chat']['id'],_0x39b166(0x239)+_0x54306a,{'parse_mode':'HTML'});}else await sendTelegram(_0x366a2a['chat']['id'],_0x39b166(0x2e7));});}}async function confirmRestore(_0x2672fb,_0x48856f){const _0x20c9fe=_0x5b7969;io['to'](_0x20c9fe(0x1b5))['emit'](_0x20c9fe(0x21c),_0x20c9fe(0x202),'success');if(tgBot&&settings[_0x20c9fe(0x2c2)]){const _0x351fe0=uuidRandom();tmpStorage[_0x351fe0]={'path':_0x2672fb,'filename':_0x48856f};const _0x5a6b8f=Markup['inlineKeyboard']([Markup[_0x20c9fe(0x1a5)]['callback'](_0x20c9fe(0x225),_0x20c9fe(0x26d)+_0x351fe0),Markup[_0x20c9fe(0x1a5)]['callback']('no',_0x20c9fe(0x321)+_0x351fe0)]);await sendTelegram(settings[_0x20c9fe(0x2c2)],_0x20c9fe(0x1dc),_0x5a6b8f),tgBot[_0x20c9fe(0x371)](/restore_(.+)_(.+)/,async _0x451992=>{const _0x27d15c=_0x20c9fe,_0xd99396=_0x451992[_0x27d15c(0x22a)][0x1],_0x2666e2=_0x451992[_0x27d15c(0x22a)][0x2],{path:_0x53feb0,filename:_0x350caf}=tmpStorage[_0x2666e2];delete tmpStorage[_0x2666e2],_0x451992[_0x27d15c(0x36e)](),_0xd99396==_0x27d15c(0x225)?(logger[_0x27d15c(0x182)](_0x27d15c(0x1df)),await sendTelegram(_0x451992[_0x27d15c(0x2a2)]['id'],_0x27d15c(0x19c),{'parse_mode':_0x27d15c(0x33b)}),unzipFile(_0x53feb0,_0x350caf)):(logger[_0x27d15c(0x182)](_0x27d15c(0x26e)),await sendTelegram(_0x451992[_0x27d15c(0x2a2)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x106137=_0x5b7969,_0x335293=new Date();return _0x335293['getFullYear']()+'/'+(_0x335293[_0x106137(0x2dc)]()+0x1)['toString']()[_0x106137(0x25d)](0x2,'0')+'/'+_0x335293[_0x106137(0x2bd)]()[_0x106137(0x2d0)]()[_0x106137(0x25d)](0x2,'0')+'\x20'+_0x335293['getHours']()[_0x106137(0x2d0)]()['padStart'](0x2,'0')+':'+_0x335293[_0x106137(0x366)]()['toString']()['padStart'](0x2,'0')+':'+_0x335293[_0x106137(0x20f)]()[_0x106137(0x2d0)]()[_0x106137(0x25d)](0x2,'0');}function getTimeStamp(){const _0x5b1169=_0x5b7969,_0x4f0df6=shiftedTime();return _0x4f0df6[_0x5b1169(0x286)]()+'/'+(_0x4f0df6['getMonth']()+0x1)[_0x5b1169(0x2d0)]()[_0x5b1169(0x25d)](0x2,'0')+'/'+_0x4f0df6[_0x5b1169(0x2bd)]()[_0x5b1169(0x2d0)]()['padStart'](0x2,'0')+'\x20'+_0x4f0df6['getHours']()[_0x5b1169(0x2d0)]()[_0x5b1169(0x25d)](0x2,'0')+':'+_0x4f0df6[_0x5b1169(0x366)]()[_0x5b1169(0x2d0)]()[_0x5b1169(0x25d)](0x2,'0')+':'+_0x4f0df6[_0x5b1169(0x20f)]()[_0x5b1169(0x2d0)]()[_0x5b1169(0x25d)](0x2,'0');}function getCleanTimeStamp(){const _0x116ea7=_0x5b7969,_0x78544b=shiftedTime();return _0x78544b[_0x116ea7(0x286)]()+(_0x78544b[_0x116ea7(0x2dc)]()+0x1)[_0x116ea7(0x2d0)]()[_0x116ea7(0x25d)](0x2,'0')+_0x78544b['getDate']()[_0x116ea7(0x2d0)]()[_0x116ea7(0x25d)](0x2,'0')+'-'+_0x78544b[_0x116ea7(0x336)]()['toString']()['padStart'](0x2,'0')+_0x78544b[_0x116ea7(0x366)]()[_0x116ea7(0x2d0)]()['padStart'](0x2,'0')+_0x78544b[_0x116ea7(0x20f)]()['toString']()[_0x116ea7(0x25d)](0x2,'0');}function shiftedTime(){const _0x407e79=_0x5b7969,_0x883603=new Date();let _0x5a6a57=_0x883603;if(settings[_0x407e79(0x2b3)]&&settings['timeshift']!==0x0)_0x5a6a57=fns[_0x407e79(0x2d5)](_0x883603,{'hours':settings[_0x407e79(0x2b3)]});return _0x5a6a57;}function startScheduler(){const _0x1f4c60=_0x5b7969,_0x5b6f2f=new Date()[_0x1f4c60(0x354)](),_0x35523f=shiftedTime()[_0x1f4c60(0x336)]();_0x35523f==0x4&&backupConfigFiles();_0x35523f==0x0&&rotateLogFiles();_0x5b6f2f%0x6==0x0&&triggerAnalytics();_0x5b6f2f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4534bd){const _0x193323=_0x5b7969;logger[_0x193323(0x182)](_0x193323(0x332)+_0x4534bd);const _0x254893=getBotsWithMode();_0x254893[_0x193323(0x2ec)]>0x0?confirmRestore(configbackuppath,_0x4534bd):unzipFile(configbackuppath,_0x4534bd);}async function getBackupFiles(_0x1fde81=null){const _0x58847e=_0x5b7969;let _0x496f25=[],_0x3c2ea6=fs[_0x58847e(0x33e)](configbackuppath,{'withFileTypes':!![]});_0x3c2ea6[_0x58847e(0x1cd)]((_0x2b566c,_0x576371)=>_0x2b566c[_0x58847e(0x1ef)]<_0x576371[_0x58847e(0x1ef)]?0x1:_0x576371[_0x58847e(0x1ef)]<_0x2b566c[_0x58847e(0x1ef)]?-0x1:0x0),_0x3c2ea6[_0x58847e(0x2ad)](_0x2bec8b=>{const _0x2f795a=_0x58847e;if(!_0x2bec8b['isDirectory']()&&_0x2bec8b[_0x2f795a(0x1ef)]['startsWith'](_0x2f795a(0x293))&&_0x2bec8b[_0x2f795a(0x1ef)][_0x2f795a(0x376)](_0x2f795a(0x2b7))){const _0xc936=formatDate(fs['statSync'](configbackuppath+_0x2bec8b[_0x2f795a(0x1ef)])[_0x2f795a(0x1da)]);_0x496f25[_0x2f795a(0x308)]({'name':_0x2bec8b['name'],'mtime':_0xc936});}});if(_0x1fde81)io['to'](_0x1fde81)['emit'](_0x58847e(0x31c),_0x496f25);else return _0x496f25;}async function backupConfigFiles(){const _0x1f6d89=_0x5b7969;await zipFiles(_0x1f6d89(0x2c8));const _0x5a42a0=getCleanTimeStamp();fs[_0x1f6d89(0x1c9)](zippath+_0x1f6d89(0x217),configbackuppath+(_0x1f6d89(0x293)+_0x5a42a0+_0x1f6d89(0x2b7)));let _0x3898f8=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3898f8[_0x1f6d89(0x1cd)]((_0x319226,_0x28f0dc)=>_0x319226[_0x1f6d89(0x1ef)]<_0x28f0dc[_0x1f6d89(0x1ef)]?0x1:_0x28f0dc[_0x1f6d89(0x1ef)]<_0x319226[_0x1f6d89(0x1ef)]?-0x1:0x0),_0x3898f8[_0x1f6d89(0x2ec)]>maxBackups&&fs[_0x1f6d89(0x204)](configbackuppath+_0x3898f8[_0x3898f8[_0x1f6d89(0x2ec)]-0x1]['name']);}function rotateLogFiles(){const _0x2e5527=_0x5b7969,_0x3d1d04=fs[_0x2e5527(0x205)](logspath+_0x2e5527(0x1d7)),_0x1d660d=_0x3d1d04[_0x2e5527(0x20a)]/0x400;if(_0x1d660d>0x64){let _0x8311f9=fs[_0x2e5527(0x33e)](logspath,{'withFileTypes':!![]});_0x8311f9[_0x2e5527(0x1cd)]((_0x5c280d,_0xb6ccf5)=>_0x5c280d[_0x2e5527(0x1ef)]<_0xb6ccf5[_0x2e5527(0x1ef)]?0x1:_0xb6ccf5[_0x2e5527(0x1ef)]<_0x5c280d['name']?-0x1:0x0),_0x8311f9[_0x2e5527(0x2ad)](_0x165a9c=>{const _0x3f4342=_0x2e5527;if(_0x165a9c[_0x3f4342(0x1ef)]==_0x3f4342(0x360))fs[_0x3f4342(0x1c9)](logspath+_0x165a9c['name'],logspath+_0x3f4342(0x25a));if(_0x165a9c['name']==_0x3f4342(0x2ae))fs[_0x3f4342(0x1c9)](logspath+_0x165a9c[_0x3f4342(0x1ef)],logspath+_0x3f4342(0x360));_0x165a9c['name']=='output-000.log'&&(fs[_0x3f4342(0x1c9)](logspath+_0x165a9c['name'],logspath+_0x3f4342(0x2ae)),fs['writeFileSync'](logspath+_0x165a9c['name'],''));});}}async function zipFiles(_0x33c8a7){const _0x178beb=_0x5b7969;let _0x5b7b97;if(_0x33c8a7==_0x178beb(0x347))_0x5b7b97=logspath;if(_0x33c8a7==_0x178beb(0x1b6))_0x5b7b97=configpath;if(_0x33c8a7==_0x178beb(0x2c8))_0x5b7b97=configpath;let _0x50b377=fs[_0x178beb(0x33e)](_0x5b7b97,{'withFileTypes':!![]});const _0xc63ff=new require(_0x178beb(0x257))();_0x50b377[_0x178beb(0x2ad)](_0x4c1c7e=>{const _0x368748=_0x178beb;if(!_0x4c1c7e['isDirectory']()){let _0x1e64d7=fs[_0x368748(0x21f)](_0x5b7b97+_0x4c1c7e[_0x368748(0x1ef)]);if(_0x33c8a7==_0x368748(0x1b6)){const _0x2bbb21=/^bot-[0-9]{3}-config.json$/,_0x34dd89=_0x2bbb21[_0x368748(0x280)](_0x4c1c7e[_0x368748(0x1ef)]);if(_0x34dd89){const _0x5ee17a=JSON[_0x368748(0x36f)](_0x1e64d7);if(_0x5ee17a[_0x368748(0x331)][0x0]){_0x5ee17a['bot'][0x0]['apiKey']=_0x368748(0x24c),_0x5ee17a[_0x368748(0x331)][0x0]['apiSecret']='***';if(_0x5ee17a[_0x368748(0x331)][0x0][_0x368748(0x32e)])_0x5ee17a['bot'][0x0][_0x368748(0x32e)]='***';}_0x1e64d7=JSON[_0x368748(0x203)](_0x5ee17a,null,0x2);}if(_0x4c1c7e['name']==_0x368748(0x22c)){const _0xc2ca1d=JSON['parse'](_0x1e64d7);if(_0xc2ca1d[_0x368748(0x259)][_0x368748(0x279)])_0xc2ca1d[_0x368748(0x259)][_0x368748(0x279)]=![];if(_0xc2ca1d['settings'][_0x368748(0x192)])_0xc2ca1d['settings']['bbPassword']=_0x368748(0x24c);if(_0xc2ca1d['settings'][_0x368748(0x287)])_0xc2ca1d[_0x368748(0x259)][_0x368748(0x287)]=_0x368748(0x24c);if(_0xc2ca1d[_0x368748(0x259)][_0x368748(0x2c2)])_0xc2ca1d[_0x368748(0x259)][_0x368748(0x2c2)]=null;_0x1e64d7=JSON[_0x368748(0x203)](_0xc2ca1d,null,0x2);}if(_0x4c1c7e['name']!=_0x368748(0x22b))_0xc63ff[_0x368748(0x2ee)](_0x4c1c7e[_0x368748(0x1ef)],_0x1e64d7);}else _0xc63ff[_0x368748(0x2ee)](_0x4c1c7e[_0x368748(0x1ef)],_0x1e64d7);}});const _0x25f46d=_0xc63ff['generate']({'base64':![],'compression':_0x178beb(0x183)});fs['writeFileSync'](zippath+(_0x33c8a7+_0x178beb(0x2b7)),_0x25f46d,_0x178beb(0x1bb));}async function unzipFile(_0x427189,_0x2e7366){const _0x462c32=_0x5b7969;fs[_0x462c32(0x33e)](configpath,{'withFileTypes':!![]})[_0x462c32(0x2ad)](_0x52e4d4=>{const _0x504a53=_0x462c32;if(!_0x52e4d4[_0x504a53(0x1ba)]())fs[_0x504a53(0x333)](configpath+_0x52e4d4[_0x504a53(0x1ef)]);});const _0x199c9e=fs[_0x462c32(0x21f)](_0x427189+_0x2e7366,_0x462c32(0x1bb)),_0x416acb=new require(_0x462c32(0x257))(_0x199c9e,{'base64':![],'checkCRC32':!![]});Object[_0x462c32(0x31a)](_0x416acb[_0x462c32(0x1f7)])[_0x462c32(0x2ad)](_0xe37fd0=>{const _0x370f49=_0x462c32,_0x3a80e9=_0x416acb[_0x370f49(0x1f7)][_0xe37fd0];fs[_0x370f49(0x248)](configpath+_0x3a80e9[_0x370f49(0x1ef)],_0x3a80e9[_0x370f49(0x27c)]);}),fs[_0x462c32(0x33e)](temppath,{'withFileTypes':!![]})['forEach'](_0x12e741=>{const _0x3c65b6=_0x462c32;if(!_0x12e741[_0x3c65b6(0x1ba)]())fs[_0x3c65b6(0x333)](temppath+_0x12e741[_0x3c65b6(0x1ef)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x462c32(0x28c)]({'restore':!![]},_0x45a75e=>{});}async function getPublicIp(){const _0x4411d6=_0x5b7969;try{const _0x36db56=await axios[_0x4411d6(0x1cf)](_0x4411d6(0x328));publicip=_0x36db56['data']['ip'];}catch(_0x4016b6){}}async function triggerAnalytics(){const _0x27ba48=_0x5b7969;if(!publicip)await getPublicIp();const _0x623850=getBotsWithMode();let _0x1cf12c=0x0;_0x623850['forEach'](_0x108ec4=>{const _0x531f4d=_0x303c;if(_0x108ec4[_0x531f4d(0x2f2)]==='enabled')_0x1cf12c++;});const _0x4036dc=getBotExchanges();mixpanel[_0x27ba48(0x2ce)](_0x27ba48(0x1c7),{'distinct_id':settings[_0x27ba48(0x1b7)],'ip':publicip,'version':serverversion,'numbots':_0x623850[_0x27ba48(0x2ec)],'numbotsenabled':_0x1cf12c,'exchanges':_0x4036dc,'environment':environment});}async function getMessages(){const _0x337664=_0x5b7969,_0x1e11cf=_0x337664(0x1fd),_0x732bbf=new GraphQLClient(_0x1e11cf),_0x3b27ae={'authorization':_0x337664(0x2dd)},_0x27cfe6=serverversion[_0x337664(0x260)]('.'),_0x33cf3a=_0x27cfe6[0x0]+'.'+_0x27cfe6[0x1],_0x1600ae=Math[_0x337664(0x33f)](settings[_0x337664(0x1c6)],settings[_0x337664(0x17f)]),_0x5a2c89={'last':parseInt(_0x1600ae),'bbm':_0x33cf3a},_0x597c1b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x202b55;try{_0x202b55=await _0x732bbf[_0x337664(0x2c7)](_0x597c1b,_0x5a2c89,_0x3b27ae);}catch(_0x131b29){}if(_0x202b55&&_0x202b55['messages']){let _0x500654=settings[_0x337664(0x1c6)];newMessages=[];for(const _0x4fc1c7 of _0x202b55['messages']){newMessages[_0x337664(0x308)](_0x4fc1c7);let _0x240cb5=![];_0x4fc1c7['bbvNew']&&(updateSetting(_0x337664(0x2c6),_0x4fc1c7['bbvNew']),_0x240cb5=isNewerVersion(serverversion,_0x4fc1c7[_0x337664(0x1c8)])||serverversion==_0x4fc1c7['bbvNew']);if(!_0x240cb5&&_0x4fc1c7[_0x337664(0x2d1)]>_0x500654){if(_0x4fc1c7[_0x337664(0x1d3)]===_0x337664(0x198)||serverversion[_0x337664(0x24a)](_0x4fc1c7[_0x337664(0x1d3)])){let _0x4b8be5=''+_0x4fc1c7['title']+'\x0a\x0a'+_0x4fc1c7[_0x337664(0x18a)];const _0x15530d=await sendTelegramMsg(toTelegramMarkdown(_0x4b8be5),_0x337664(0x1cb));if(_0x15530d)_0x500654=_0x4fc1c7[_0x337664(0x2d1)];}}}updateAvailable=isNewerVersion(settings[_0x337664(0x2c6)],serverversion),updateSetting(_0x337664(0x1c6),_0x500654),emitMessages();}}function emitMessages(){const _0x14c343=_0x5b7969,_0x4da705=settings['lastmsgemitted'];let _0x28c2de=[];newMessages[_0x14c343(0x2ad)](_0x8e5326=>{const _0x3a71d1=_0x14c343;_0x8e5326[_0x3a71d1(0x2d1)]>_0x4da705&&_0x28c2de[_0x3a71d1(0x308)](_0x8e5326);}),_0x28c2de['length']>0x0&&getAllClients()['forEach'](_0x320994=>{const _0x1205e2=_0x14c343;getSocket(_0x320994['id'])[_0x1205e2(0x375)](_0x1205e2(0x18a),_0x28c2de);});}function confirmMessage(_0x2817b2){const _0x3b92f6=_0x5b7969;updateSetting(_0x3b92f6(0x17f),Number(_0x2817b2));}function isNewerVersion(_0x5061f7,_0x28a5c7){const _0x17ccd0=_0x5b7969,_0x5488a3=_0x28a5c7['split']('.'),_0x522598=_0x5061f7['split']('.');for(var _0x145877=0x0;_0x145877<_0x522598[_0x17ccd0(0x2ec)];_0x145877++){const _0x46d954=~~_0x522598[_0x145877],_0x4cabe2=~~_0x5488a3[_0x145877];if(_0x46d954>_0x4cabe2)return!![];if(_0x46d954<_0x4cabe2)return![];}return![];}function toTelegramMarkdown(_0x30d506){const _0x5512cb=_0x5b7969,_0x4893a4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2e0503=/\*{2}(.+?)\*{2}/gim;return _0x30d506=_0x30d506['replace'](_0x4893a4,_0x5512cb(0x215))['replace'](_0x2e0503,_0x5512cb(0x340)),_0x30d506;}async function validateConfigFile(){const _0x5e24f2=_0x5b7969,_0x4d699d=dbConfig[_0x5e24f2(0x1cf)](_0x5e24f2(0x292))['sortBy'](_0x5e24f2(0x277))[_0x5e24f2(0x34c)]()||[];if(_0x4d699d['length']==0x0){let _0x98fbe=0x0,_0x4ffe65=[];const _0x4bc11e=/^bot-([0-9]{3})-config.json$/,_0x2bcc32=fs[_0x5e24f2(0x33e)](configpath);_0x2bcc32['forEach'](_0x3dca5c=>{const _0x5b9131=_0x5e24f2,_0x3b048b=_0x4bc11e[_0x5b9131(0x1a8)](_0x3dca5c);if(_0x3b048b){const _0x33965d=_0x3b048b[0x1];let _0x1ea6ff=getBotAttributes(_0x33965d);_0x4ffe65['push']({'botID':_0x33965d,'botname':_0x1ea6ff[_0x5b9131(0x2c1)],'status':_0x5b9131(0x238),'live':_0x5b9131(0x335)}),_0x98fbe++;}}),_0x98fbe!=0x0&&(dbConfig[_0x5e24f2(0x1cf)](_0x5e24f2(0x292))['assign'](_0x4ffe65)[_0x5e24f2(0x255)](),config=_0x4ffe65,restoredConfigFile=_0x98fbe);}}async function restoreConfigNotify(_0x5c59d5){const _0x5f3bf1=_0x5b7969;let _0x130580;if(restoredConfigFile==0x1)_0x130580=_0x5f3bf1(0x30d);else _0x130580=_0x5f3bf1(0x1ad);if(_0x5c59d5)io['to'](_0x5f3bf1(0x1b5))[_0x5f3bf1(0x375)]('notification',_0x130580);else{logger[_0x5f3bf1(0x1b4)](_0x5f3bf1(0x364)),logger['simple'](_0x130580),logger[_0x5f3bf1(0x1b4)](_0x5f3bf1(0x364)),logger['simple']('');if(tgBot&&settings[_0x5f3bf1(0x2c2)]&&settings[_0x5f3bf1(0x2cd)]!=_0x5f3bf1(0x2ba))await sendTelegram(settings[_0x5f3bf1(0x2c2)],_0x5f3bf1(0x29d)+_0x130580);}}function validateCredentials(_0x2e15c8,_0x961bb4){const _0x22cc33=_0x5b7969;if(_0x2e15c8[_0x22cc33(0x1ff)]==settings[_0x22cc33(0x265)]&&bcrypt[_0x22cc33(0x24b)](_0x2e15c8[_0x22cc33(0x22f)],settings[_0x22cc33(0x192)])){if(settings[_0x22cc33(0x36c)])return{'allow':![],'reason':_0x22cc33(0x30e),'token':null};else{const _0x534801=generateLoginToken(_0x961bb4);return{'allow':!![],'reason':_0x22cc33(0x2fc),'token':_0x534801};}}else return{'allow':![],'reason':_0x22cc33(0x34d),'token':null};}function refreshToken(_0x5b0fd7){const _0xfe1b64=generateLoginToken(_0x5b0fd7);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xfe1b64};}function validateAccess(_0x46c140,_0x2eb2b4,_0x8f4e80){const _0x282ef1=_0x5b7969,_0x81437c=_0x8f4e80?_0x8f4e80:devices[_0x2eb2b4]['ip'];let _0x54ab59;const _0x20fe81=_0x31e7f5=>{const _0x429ee4=_0x303c;if(settings[_0x429ee4(0x279)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x2eb2b4)){const _0x294327=generateLoginToken(_0x2eb2b4);return{'allow':!![],'reason':_0x429ee4(0x22e),'token':_0x294327};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x54ab59=validToken(_0x31e7f5,_0x2eb2b4),_0x54ab59['hasOwnProperty']('success')?{'allow':!![],'reason':_0x429ee4(0x226),'token':_0x31e7f5}:{'allow':![],'reason':_0x429ee4(0x1fe),'token':null};}else return{'allow':!![],'reason':_0x429ee4(0x36b),'token':null};};if(settings[_0x282ef1(0x199)]){let _0x15d217=[...settings['whitelist'],_0x282ef1(0x339),_0x282ef1(0x231),_0x282ef1(0x211)];if(_0x15d217[_0x282ef1(0x369)](_0x81437c))return _0x20fe81(_0x46c140);else{_0x54ab59=validToken(_0x46c140,_0x2eb2b4);if(_0x54ab59[_0x282ef1(0x1f9)](_0x282ef1(0x304)))return _0x20fe81(_0x46c140);else{if(telegramIpApproved(_0x2eb2b4)){const _0x3b5e57=generateToken(_0x2eb2b4);return _0x54ab59=_0x20fe81(_0x46c140),_0x54ab59['allow']?{'allow':!![],'reason':_0x282ef1(0x317),'token':_0x3b5e57}:_0x54ab59;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x282ef1(0x2d7),'token':null}:{'allow':![],'reason':_0x282ef1(0x302),'token':null};}}}else return _0x20fe81(_0x46c140);}function timelyDecrypt(_0x3c5b63,_0x323a99=!![]){const _0x5611e2=_0x5b7969;if(_0x3c5b63)try{const _0xbe156a=crypt[_0x5611e2(0x271)](secure[_0x5611e2(0x2f9)],_0x3c5b63)[_0x5611e2(0x18a)],_0x48a053=_0xbe156a[_0x5611e2(0x260)]('@')[0x0],_0x5680ad=_0xbe156a[_0x5611e2(0x260)]('@')[0x1],_0x331f68=new Date()[_0x5611e2(0x28a)]();if(_0x323a99){if(_0x331f68-_0x5680ad<maxSecretAge*0x3e8)return _0x48a053;else return![];}else return _0x48a053;}catch(_0x564f38){return![];}else return![];}const validToken=(_0x1a5a2f,_0x214079)=>{const _0x218417=_0x5b7969,_0x4671ff=devices[_0x214079]['ip'];if(!_0x1a5a2f)return{'error':_0x218417(0x278)};for(let _0x48d05f of blacklist){if(_0x48d05f[_0x218417(0x1de)]==_0x1a5a2f)return{'error':_0x218417(0x1d1)};}let _0x2d0fe8;try{_0x2d0fe8=jwt[_0x218417(0x194)](_0x1a5a2f,secure[_0x218417(0x1e8)]+_0x214079);}catch{return{'error':_0x218417(0x208)};}if(!_0x2d0fe8[_0x218417(0x1f9)](_0x218417(0x246))&&!_0x2d0fe8[_0x218417(0x1f9)](_0x218417(0x1ff))||!_0x2d0fe8[_0x218417(0x1f9)](_0x218417(0x2ea)))return{'error':_0x218417(0x247)};if(!_0x2d0fe8[_0x218417(0x1f9)]('username')&&_0x2d0fe8[_0x218417(0x1f9)](_0x218417(0x246))){const {clientip:_0x114fbf}=_0x2d0fe8;return _0x4671ff==_0x114fbf?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x218417(0x1db)};}else{if(_0x2d0fe8[_0x218417(0x1f9)](_0x218417(0x1ff))&&_0x2d0fe8[_0x218417(0x1f9)](_0x218417(0x246))){const {username:_0x12b0a2,clientip:_0x14f6cc}=_0x2d0fe8;return settings['bbUsername']==_0x12b0a2&&_0x4671ff==_0x14f6cc?{'success':_0x218417(0x28e)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x42801a=>{const _0x547cfe=_0x5b7969;if(_0x42801a){const _0x499b2d=devices[_0x42801a]['ip'];return jwt[_0x547cfe(0x283)]({'username':settings[_0x547cfe(0x265)],'clientip':_0x499b2d},secure['secret']+_0x42801a,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xe6d5b6=>{const _0x3f0465=_0x5b7969;if(_0xe6d5b6){const _0x267696=devices[_0xe6d5b6]['ip'];return jwt['sign']({'clientip':_0x267696},secure[_0x3f0465(0x1e8)]+_0xe6d5b6,{'expiresIn':devices[_0xe6d5b6][_0x3f0465(0x220)][_0x3f0465(0x17a)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x4df61f=>{const _0xb15e19=_0x5b7969;let _0x3656b2=![];return devices[_0x4df61f][_0xb15e19(0x220)]&&devices[_0x4df61f][_0xb15e19(0x220)][_0xb15e19(0x17a)]!=_0xb15e19(0x327)&&(_0x3656b2=devices[_0x4df61f][_0xb15e19(0x220)][_0xb15e19(0x246)]==devices[_0x4df61f]['ip']&&new Date()[_0xb15e19(0x28a)]()-devices[_0x4df61f][_0xb15e19(0x220)]['timestamp']<devices[_0x4df61f][_0xb15e19(0x220)][_0xb15e19(0x17a)]*0x3c*0x3e8),_0x3656b2;},telegram2FaApproved=_0x49483f=>{const _0x2536d1=_0x5b7969;let _0x4e5e8b=![];return devices[_0x49483f][_0x2536d1(0x2bc)]&&devices[_0x49483f][_0x2536d1(0x2bc)][_0x2536d1(0x17a)]!=_0x2536d1(0x327)&&(_0x4e5e8b=devices[_0x49483f]['telegram2FaApproval'][_0x2536d1(0x246)]==devices[_0x49483f]['ip']&&new Date()['getTime']()-devices[_0x49483f]['telegram2FaApproval'][_0x2536d1(0x2ff)]<devices[_0x49483f][_0x2536d1(0x2bc)]['expiry']*0x3c*0x3e8),_0x4e5e8b;},normalizeIP=_0x598e52=>{const _0x53c6fd=_0x5b7969;let _0x433a5a=null,_0x1011c1=null;if(ipaddr['isValid'](_0x598e52)){const _0x437907=ipaddr[_0x53c6fd(0x36f)](_0x598e52);_0x437907['kind']()==='ipv6'?(_0x437907[_0x53c6fd(0x219)]()&&(_0x433a5a=_0x437907[_0x53c6fd(0x1f8)]()[_0x53c6fd(0x2d0)]()),_0x1011c1=_0x437907[_0x53c6fd(0x2d0)]()):(_0x433a5a=_0x437907[_0x53c6fd(0x2d0)](),_0x1011c1=_0x437907['toIPv4MappedAddress']()['toString']());}return{'show':_0x433a5a?_0x433a5a:_0x1011c1,'store':_0x1011c1};};function formatDate(_0x49a57c){const _0x29450d=_0x5b7969;return _0x49a57c[_0x29450d(0x286)]()+'/'+(_0x49a57c[_0x29450d(0x2dc)]()+0x1)[_0x29450d(0x2d0)]()['padStart'](0x2,'0')+'/'+_0x49a57c['getDate']()[_0x29450d(0x2d0)]()[_0x29450d(0x25d)](0x2,'0')+'\x20'+_0x49a57c[_0x29450d(0x336)]()[_0x29450d(0x2d0)]()['padStart'](0x2,'0')+':'+_0x49a57c[_0x29450d(0x366)]()['toString']()[_0x29450d(0x25d)](0x2,'0')+':'+_0x49a57c[_0x29450d(0x20f)]()[_0x29450d(0x2d0)]()[_0x29450d(0x25d)](0x2,'0');}function sleep(_0x393fe8){return new Promise(_0x247be6=>setTimeout(_0x247be6,_0x393fe8));}