const _0x34dfac=_0x5dcf;(function(_0x317ca7,_0x5bd752){const _0x18e1d2=_0x5dcf,_0x213329=_0x317ca7();while(!![]){try{const _0x38e561=parseInt(_0x18e1d2(0x1bd))/0x1+parseInt(_0x18e1d2(0x15c))/0x2*(parseInt(_0x18e1d2(0x1ac))/0x3)+parseInt(_0x18e1d2(0xbe))/0x4+parseInt(_0x18e1d2(0x215))/0x5*(parseInt(_0x18e1d2(0x1be))/0x6)+-parseInt(_0x18e1d2(0xac))/0x7*(-parseInt(_0x18e1d2(0x1c3))/0x8)+-parseInt(_0x18e1d2(0xcf))/0x9+parseInt(_0x18e1d2(0x105))/0xa*(-parseInt(_0x18e1d2(0x1f4))/0xb);if(_0x38e561===_0x5bd752)break;else _0x213329['push'](_0x213329['shift']());}catch(_0x400636){_0x213329['push'](_0x213329['shift']());}}}(_0x4363,0x778ce));const _0x23fbc8=function(){let _0x2a0d6c=!![];return function(_0x335efb,_0x22c3a7){const _0x14e303=_0x2a0d6c?function(){const _0x4aed81=_0x5dcf;if(_0x22c3a7){const _0x426c9e=_0x22c3a7[_0x4aed81(0xb4)](_0x335efb,arguments);return _0x22c3a7=null,_0x426c9e;}}:function(){};return _0x2a0d6c=![],_0x14e303;};}(),_0x40fe3e=_0x23fbc8(this,function(){const _0x8cb616=_0x5dcf;return _0x40fe3e[_0x8cb616(0x1ca)]()['search'](_0x8cb616(0xef))[_0x8cb616(0x1ca)]()[_0x8cb616(0x190)](_0x40fe3e)[_0x8cb616(0x132)](_0x8cb616(0xef));});_0x40fe3e();'use strict';process[_0x34dfac(0x22e)][_0x34dfac(0xf2)]=0x1;const childProcess=require(_0x34dfac(0x1d3)),fs=require('fs'),fns=require(_0x34dfac(0x224)),low=require(_0x34dfac(0x20b)),FileSync=require(_0x34dfac(0x18d)),path=require('path'),crypto=require(_0x34dfac(0x1ff)),Crypt=require(_0x34dfac(0x217))[_0x34dfac(0x1c9)],RSA=require(_0x34dfac(0x217))[_0x34dfac(0xfc)],bcrypt=require(_0x34dfac(0x143)),jwt=require(_0x34dfac(0xd2)),ipaddr=require('ipaddr.js'),argv=require(_0x34dfac(0x114))(process['argv'][_0x34dfac(0xfe)](0x2))[_0x34dfac(0x1ce)],uuidRandom=require(_0x34dfac(0x101)),TelegramBot=require(_0x34dfac(0x1ee)),Mixpanel=require(_0x34dfac(0x177)),axios=require(_0x34dfac(0xbb)),{GraphQLClient,gql}=require(_0x34dfac(0x150)),util=require(_0x34dfac(0x7b)),fileUpload=require(_0x34dfac(0xe5)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x34dfac(0x154),pattern=/^[0-9]{2,4}$/;!pattern[_0x34dfac(0x115)](PORT)&&(console['log'](_0x34dfac(0x94)+PORT+_0x34dfac(0xd0)),process[_0x34dfac(0x74)](0x1));const HOST=argv[_0x34dfac(0x244)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x34dfac(0x14c)][_0x34dfac(0x79)];let bbpath=_0x34dfac(0x156),bbpath2='';const botfile=_0x34dfac(0xcb),configfile=_0x34dfac(0x13d),settingsfile=_0x34dfac(0x170),securefile=_0x34dfac(0x1e8),maxBackups=0xa;let validInstallation=!![];!fs[_0x34dfac(0x124)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x34dfac(0xde)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x34dfac(0x13f),configbackuppath=configpath+_0x34dfac(0x85),logspath=userID?bbpath+_0x34dfac(0x135)+userID+'/':bbpath+_0x34dfac(0x135),zippath=userID?bbpath+_0x34dfac(0x12a)+userID+'/':bbpath+_0x34dfac(0x12a),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x34dfac(0xc2)+userID+'/':bbpath+'temp/';!fs[_0x34dfac(0x124)](configpath)&&fs[_0x34dfac(0xff)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x34dfac(0xff)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x34dfac(0xff)](logspath);!fs[_0x34dfac(0x124)](zippath)&&fs[_0x34dfac(0xff)](zippath);!fs['existsSync'](temppath)&&fs[_0x34dfac(0xff)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x34dfac(0x229)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x4363(){const _0x3e53e6=['Restoring\x20bot(s)\x20from\x20backup','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','telegramEvents','emitHistory','reason','resetHistory','/:bot/performance','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','output-001.log','Restore\x20process\x20aborted','\x20minutes','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','chat','randomFillSync','No\x20authentication\x20token','253048nzktAQ','6QjPtrQ','size','Backup\x20file\x20uploaded','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','toggleBotMode','91928odpUxS','getUTCHours','IPv4','placeOrder','apiSecret','botmanager','Crypt','toString','writeFileSync','exchange','Error\x20while\x20deleting\x20config\x20files:\x20','argv','stopped','disabled','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Bot\x20Mgr\x20>\x20','child_process','showConfig','http','-events.json','store-configuration','express','showname','Logged\x20out\x20user\x20...','storeHeadless','bots','getFullYear','f2aRequired','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','find','/upload-backup','format','generate','\x20to\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','isValid','storeConfiguration','bb-secure.json','Unauthorized\x20attempt\x20to\x20update\x20settings','Restarting\x20Bot\x20','/enable\x20-\x20enable\x20notifications\x0a','backup-files','copyFileSync','node-telegram-bot-api','uuid','settings.','sha256','store-fiat','bot-','6253445hBKrxz','send','sockets','-----------------------------------------------------------------------------------','getMinutes','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','logged\x20out','/:bot/portfolio','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','botname','file','crypto','telegramToken','write','Failed\x20to\x20download\x20','Password\x20reset\x20rejected','alias','started','temporary\x20access\x20rejected','readFileSync','Session\x20expired\x20for\x20user\x20...','\x20(1)','token','lowdb','No\x20bots\x20running\x20right\x20now','unlinkSync','files','show-config','************','username','map','*$1*','login\x20token\x20valid','360410hITTiQ','Allow\x20login\x20from\x20IP\x20address\x20<b>','hybrid-crypto-js','/metrics\x20-\x20show\x20bot\x20performance\x0a','telegramIpApproval','whitelist','from','/status\x20-\x20show\x20bot(s)\x20status\x0a','sign','value','-results.json','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','5\x20min','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','telegramUsername','date-fns','then','/on\x20-\x20start\x20bot(s)\x0a','hasOwnProperty','1000','defaults','getMonth','accept','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','auto','env','restart','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','\x20|\x20client:\x20...','Invalid\x20Telegram\x20token','Deleted\x20Bot\x20','\x20(2)','toggle-bot-mode','stopPolling','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','join','/disable\x20-\x20disable\x20notifications\x0a','getDate','access','.zip','access\x20timeout','lastmsgtelegram','Notifications\x20disabled\x0a','0.0.0','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','host','split','auth','telegram','function','parse','decrypt','all','All\x20bots\x20running\x20right\x20now','createServer','temporaryAccessAllowed','exit','lastmsgemitted','Yes','onepagemode','botID','node','timeshift','util','Unauthorized\x20attempt\x20to\x20update\x20bot','add','track','isDirectory','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','socket','number','Enabled\x20Bot\x20','kill','backup/','manual','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','running','cancelLoading','Unauthorized\x20attempt\x20to\x20download\x20','SIGINT','handshake','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','remoteAddress','download','hashSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','output-002.log','Error:\x20Invalid\x20argument\x20','Idling\x20bot\x20\x20\x20|\x20Bot\x20','getHours','entries','</b>\x20?','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','store','Node.js\x20v','login\x20not\x20required','get-logs','messages',':\x20Bot\x20Mgr\x20>\x20','disconnect','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','rmSync','remove','name','/:bot/support','any','server','settings','apiKey','pidRefreshToken','secure','196fBmyLg','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','pidExpireLogin','$1_$2_$3','simple','statSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','success','apply','publicKey','api-eu.mixpanel.com','output-000.log','once','exp','build','axios','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','bot','1670400qTKeEi','/:bot/history','delete-alerts','log','temp/','Starting\x20Balance\x20Bot\x20v','/off\x20-\x20stop\x20bot(s)\x0a','keys','node-zip','/restart\x20-\x20restart\x20bot(s)\x0a','forEach','build2','Markdown','bot.js','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','family','latestversion','6712956ugOHgy',',\x20must\x20be\x20a\x204\x20digit\x20number','Invalid\x20authentication\x20token\x20(2)','jsonwebtoken','alerts','onText','randomBytes','telegramEnabled','sortBy','update-bb','params','temporary\x20access\x20timeout','Temporary\x20access\x20rejected','enabled','callback_query','clients','full','All\x20bots','telegramChatId','use','Password\x20has\x20been\x20reset\x20to:\x20','mode','express-fileupload','length','\x20only\x0a','127.0.0.1','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','2FA\x20login\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','filter','toIPv4Address','telegram2FaApproval','(((.+)+)+)+$','set','update-bot','NTBA_FIX_319',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','-config.json','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','reset-history','encryptedUuid','\x20>\x20','store-headless','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','cancel-loading','RSA','RSA-OAEP','slice','mkdirSync','_data','uuid-random','userid','status','HTML','10cUUFhy','Setting\x20access:\x20','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20store\x20configuration','login\x20token\x20generated','readdirSync','getStartingBalances','::ffff:127.0.0.1','data','type','listen','sendPortfolioTelegram','kind','backupfile','min','yargs/yargs','test','show','headless','index.html','-performance.json','Starting\x20Balance\x20Bot\x20reinstallation','blacklist','Unauthorized\x20attempt\x20to\x20log\x20out','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','update','https://api.ipify.org?format=json','cloneDeep','Notifications\x20types:\x20','allow','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','existsSync','inherit','startsWith','hex','Unauthorized\x20attempt\x20to\x20delete\x20alerts','reload','zip/','Backup\x20file\x20unzipped\x20and\x20stored','Notifications\x20enabled\x0a','live','title','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','/download/:type','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','search','removeListener','clientip','logs/','new','sendMessage','privateKey','expiry','Ok,\x20will\x20send\x20alert\x20notifications\x20only','404\x20Not\x20Found','assign','bb-config.json','notification','config/','bbPassword','timestamp','/:bot/configuration','bcryptjs','order','get','reinstall','catch','get-messages','logout','sort','temporary\x20token\x20generated','versions','<b>Balance\x20Bot\x20Status:</b>\x0a','reject','/names\x20-\x20show\x20bot\x20names\x0a','graphql-request','Invalid\x20IP\x20address','***','Orders','3000','version','bb/','reset-password','mtime','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Server','\x20|\x20','2djXhEw','new-disabled','sendMetricsTelegram','updatebotmanager','login','Unauthorized\x20attempt\x20to\x20delete\x20bot','includes','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','ipc','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','padStart','add-bot','Login\x20rejected','backup-full@','sendFile','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','store-settings','backup-full','emit','bb-settings.json','push','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','tkn','bbUsername','debug','Unauthorized\x20login\x20attempt\x20(timeout)','mixpanel','Starting\x20bot\x20|\x20Bot\x20','Notifications\x20disabled','stringify','removeAllListeners','secret','event','delete-bot','2FA\x20required','Bot\x20','confirm-message','connection','telegrammsg','backup','getTime','replace','answerCallbackQuery','yes','initclient','2FA','bbvNew','static','lowdb/adapters/FileSync','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/:bot','constructor','Login\x20accepted','getSeconds','Unauthorized\x20attempt\x20to\x20confirm\x20message','Unauthorized\x20attempt\x20to\x20get\x20messages','headers','Invalid\x20authentication\x20token\x20(1)','bbvReceive','Notifications\x20enabled','\x20|\x20user:\x20...','message','restore-backup-file','connected','Unauthorized\x20attempt\x20to\x20get\x20portfolio','loginRequired','Restore\x20backup\x20file\x20','15\x20min','30\x20min','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','invalid\x20credentials','stop','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','User\x20has\x20been\x20validated','error','version.json','Unauthorized\x20attempt\x20to\x20add\x20bot','DEFLATE','orders','2218737eBSRnQ','Alerts'];_0x4363=function(){return _0x3e53e6;};return _0x4363();}dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x34dfac(0x229)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x34dfac(0x1f1),'rsaStandard':_0x34dfac(0xfd)});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x34dfac(0xb6)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x34dfac(0x200)]&&settings[_0x34dfac(0x200)]!=''&&settings[_0x34dfac(0x223)]&&settings[_0x34dfac(0x223)]!='')initTelegram();const logger={'screen':_0x31fcbc=>{const _0x2cf5b2=_0x34dfac;console[_0x2cf5b2(0xc1)](_0x31fcbc);},'simple':_0x17e0d0=>{const _0x193b7e=_0x34dfac;console[_0x193b7e(0xc1)](_0x17e0d0),loggerfile['write'](util['format'](_0x17e0d0)+'\x0a');},'full':async _0x4dcfac=>{const _0x3e7383=_0x34dfac,_0x12e89c=getTimeStamp()+_0x3e7383(0x9f)+_0x4dcfac;console[_0x3e7383(0xc1)](_0x12e89c),loggerfile['write'](util[_0x3e7383(0x1e2)](_0x12e89c)+'\x0a');if(tgBot&&settings[_0x3e7383(0xe1)]&&settings['telegramEvents']!='orders')await tgBot[_0x3e7383(0x137)](settings[_0x3e7383(0xe1)],_0x3e7383(0x1d2)+_0x4dcfac)[_0x3e7383(0x147)](_0x3e0df6=>{telegramError(_0x3e0df6);});},'debug':async(_0x13bcf2,_0x5b0ff9='')=>{const _0x3b5caf=_0x34dfac,_0x59fc05=getTimeStamp()+_0x3b5caf(0xf3)+_0x13bcf2;if(debugging)console[_0x3b5caf(0xc1)](_0x59fc05);loggerfile[_0x3b5caf(0x201)](util[_0x3b5caf(0x1e2)](_0x59fc05)+'\x0a');if(_0x5b0ff9){if(debugging)console[_0x3b5caf(0xc1)](_0x5b0ff9);loggerfile[_0x3b5caf(0x201)](util[_0x3b5caf(0x1e2)](_0x5b0ff9)+'\x0a');}}};process['on']('uncaughtException',function(_0x9b69e0){logger['simple'](_0x9b69e0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x34dfac(0x1a8))[_0x34dfac(0x155)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x34dfac(0x1d8)),app=express(),http=require(_0x34dfac(0x1d5))[_0x34dfac(0x72)](app);app[_0x34dfac(0xe2)](fileUpload({'useTempFiles':!![]})),app['get'](_0x34dfac(0x130),async(_0x51092a,_0x582322)=>{const _0x30dddc=_0x34dfac,_0x2c6910=_0x51092a[_0x30dddc(0xd9)][_0x30dddc(0x10e)],_0x2567cc=getClientsWithBotID(_0x30dddc(0x1c8)),_0x1bacd1=_0x51092a['headers'][_0x30dddc(0x1ef)],_0x202615=timelyDecrypt(_0x1bacd1,![]),_0x192f11=_0x2567cc[_0x30dddc(0x1e0)](_0x115c65=>_0x115c65[_0x30dddc(0x1ef)]==_0x202615);if(_0x192f11){const _0x5b9980=normalizeIP(_0x51092a[_0x30dddc(0x81)][_0x30dddc(0x8f)])[_0x30dddc(0x9a)],_0x2b12e0=_0x51092a[_0x30dddc(0x195)][_0x30dddc(0x173)];if(validateAccess(_0x2b12e0,_0x202615,_0x5b9980)[_0x30dddc(0x122)])_0x2c6910==_0x30dddc(0x184)&&await backupConfigFiles(),await zipFiles(_0x2c6910),_0x582322[_0x30dddc(0x90)](zippath+(_0x2c6910+_0x30dddc(0x23c)),_0xff8db9=>{const _0x2b3d16=_0x30dddc;_0xff8db9&&(logger['full'](_0x2b3d16(0x202)+_0x2c6910),logger['simple'](_0xff8db9));});else logger[_0x30dddc(0xdf)](_0x30dddc(0x8a)+_0x2c6910+_0x30dddc(0x209));}else logger[_0x30dddc(0xdf)](_0x30dddc(0x8a)+_0x2c6910+_0x30dddc(0x234));}),app['post'](_0x34dfac(0x1e1),async(_0x1267e1,_0x4edadc)=>{const _0x36f854=_0x34dfac,_0xe2f0a2=getClientsWithBotID(_0x36f854(0x1c8)),_0x222c30=_0x1267e1[_0x36f854(0x195)][_0x36f854(0x1ef)],_0x150c37=timelyDecrypt(_0x222c30,![]),_0x4eac9d=_0xe2f0a2[_0x36f854(0x1e0)](_0x1d8912=>_0x1d8912[_0x36f854(0x1ef)]==_0x150c37);logger[_0x36f854(0x175)](_0x36f854(0x1c0));if(_0x4eac9d){const _0x1c0008=normalizeIP(_0x1267e1['socket'][_0x36f854(0x8f)])[_0x36f854(0x9a)],_0x43ea1b=_0x1267e1[_0x36f854(0x195)][_0x36f854(0x173)];if(validateAccess(_0x43ea1b,_0x150c37,_0x1c0008)[_0x36f854(0x122)]){if(_0x1267e1[_0x36f854(0x20e)]){const _0x17d230=_0x1267e1[_0x36f854(0x20e)][_0x36f854(0x112)];await _0x17d230['mv'](temppath+_0x17d230['name']),_0x4edadc[_0x36f854(0x1f5)]({'status':!![],'message':'File\x20uploaded'});const _0x458d85=getBotsWithMode();_0x458d85[_0x36f854(0xe6)]>0x0?confirmRestore(temppath,_0x17d230[_0x36f854(0xa4)]):unzipFile(temppath,_0x17d230['name']);}}else logger[_0x36f854(0xdf)](_0x36f854(0x1b9));}else logger[_0x36f854(0xdf)](_0x36f854(0x22c));}),app[_0x34dfac(0xe2)](express[_0x34dfac(0x18c)](path['join'](__dirname,bbpath2,_0x34dfac(0xc9)))),app[_0x34dfac(0xe2)](express[_0x34dfac(0x18c)](path[_0x34dfac(0x238)](__dirname,bbpath2,_0x34dfac(0xba)))),app['get']('/',function(_0x2053f8,_0x5b54e2){const _0x1f708a=_0x34dfac;_0x5b54e2[_0x1f708a(0x16b)](path[_0x1f708a(0x238)](__dirname,bbpath2,_0x1f708a(0xc9),_0x1f708a(0x118)));}),app[_0x34dfac(0x145)](_0x34dfac(0x18f),function(_0x448659,_0x18dc51){const _0x3f6de5=_0x34dfac;_0x18dc51['sendFile'](path[_0x3f6de5(0x238)](__dirname,bbpath2,_0x3f6de5(0xba),_0x3f6de5(0x118)));}),app['get'](_0x34dfac(0x1fb),(_0x526906,_0x463025)=>{const _0x99478a=_0x34dfac;_0x463025['sendFile'](path['join'](__dirname,bbpath2,_0x99478a(0xba),_0x99478a(0x118)));}),app['get'](_0x34dfac(0x1b4),(_0x37bd25,_0x57e584)=>{const _0x3d9a3d=_0x34dfac;_0x57e584[_0x3d9a3d(0x16b)](path[_0x3d9a3d(0x238)](__dirname,bbpath2,_0x3d9a3d(0xba),_0x3d9a3d(0x118)));}),app[_0x34dfac(0x145)]('/:bot/coins',(_0x1e782a,_0x112248)=>{const _0x99b7b6=_0x34dfac;_0x112248[_0x99b7b6(0x16b)](path[_0x99b7b6(0x238)](__dirname,bbpath2,_0x99b7b6(0xba),'index.html'));}),app[_0x34dfac(0x145)](_0x34dfac(0xbf),(_0x53522a,_0x89dbd3)=>{const _0x300bf0=_0x34dfac;_0x89dbd3[_0x300bf0(0x16b)](path['join'](__dirname,bbpath2,_0x300bf0(0xba),_0x300bf0(0x118)));}),app[_0x34dfac(0x145)](_0x34dfac(0x142),(_0x4057d7,_0xc40a95)=>{const _0x5c3abc=_0x34dfac;_0xc40a95[_0x5c3abc(0x16b)](path[_0x5c3abc(0x238)](__dirname,bbpath2,_0x5c3abc(0xba),_0x5c3abc(0x118)));}),app[_0x34dfac(0x145)](_0x34dfac(0xa5),(_0x55c8fc,_0x38eba7)=>{const _0x2c038e=_0x34dfac;_0x38eba7[_0x2c038e(0x16b)](path[_0x2c038e(0x238)](__dirname,bbpath2,'build',_0x2c038e(0x118)));});if(HOST)http[_0x34dfac(0x10f)](PORT,HOST);else http[_0x34dfac(0x10f)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x2a3f24=_0x34dfac;let _0x1bfd39='[ip-address]';const _0x263666=networkInterfaces(),_0x5cb685={};for(const _0x99012e of Object[_0x2a3f24(0xc5)](_0x263666)){for(const _0x1a3937 of _0x263666[_0x99012e]){(_0x1a3937[_0x2a3f24(0xcd)]==_0x2a3f24(0x1c5)||_0x1a3937[_0x2a3f24(0xcd)]==0x4)&&(!_0x5cb685[_0x99012e]&&(_0x5cb685[_0x99012e]=[]),_0x5cb685[_0x99012e][_0x2a3f24(0x171)](_0x1a3937['address']),_0x1a3937['address']==_0x2a3f24(0xe8)&&(_0x1bfd39='localhost'));}}console[_0x2a3f24(0xc1)](_0x5cb685),logger[_0x2a3f24(0xb0)](''),logger[_0x2a3f24(0xb0)](_0x2a3f24(0x1f7)),await logger['full'](_0x2a3f24(0xc3)+serverversion),await logger[_0x2a3f24(0xdf)]('Open\x20Bot\x20Manager\x20at\x20http://'+_0x1bfd39+':'+PORT),await logger[_0x2a3f24(0x175)](_0x2a3f24(0x9b)+nodeversion),logger[_0x2a3f24(0xb0)](_0x2a3f24(0x1f7));if(config[_0x2a3f24(0xe6)]!=0x0)for(const _0x28b219 of config){if(_0x28b219['status']==_0x2a3f24(0xdc)||_0x28b219[_0x2a3f24(0x103)]==_0x2a3f24(0x136))await logger['full'](_0x2a3f24(0x178)+_0x28b219[_0x2a3f24(0x78)]+_0x2a3f24(0x15b)+_0x28b219['botname']),startBot([_0x28b219[_0x2a3f24(0x78)],userID],{'cwd':bbpath},function(_0x407706){const _0x127eaf=_0x2a3f24;if(_0x407706)logger[_0x127eaf(0xdf)](_0x407706);});else(_0x28b219[_0x2a3f24(0x103)]==_0x2a3f24(0x1d0)||_0x28b219[_0x2a3f24(0x103)]==_0x2a3f24(0x15d))&&await logger[_0x2a3f24(0xdf)](_0x2a3f24(0x95)+_0x28b219[_0x2a3f24(0x78)]+_0x2a3f24(0x15b)+_0x28b219[_0x2a3f24(0x1fd)]);}else!newBot&&logger['simple'](_0x2a3f24(0x1fc));if(newBot)addBot();logger['simple'](_0x2a3f24(0x1f7)),logger[_0x2a3f24(0xb0)]('');}function startSocket(){const _0x47884f=_0x34dfac;io['on'](_0x47884f(0x182),_0x37f742=>{const _0x3aed95=_0x47884f;let _0x50aec6,_0x13641f,_0x3e67b5,_0x1a828d,_0x242514;const _0xc1b0a1=_0x37f742[_0x3aed95(0x8c)][_0x3aed95(0x195)]['referer'];_0x13641f=_0xc1b0a1['match'](/bot[0-9]{3}/);if(_0x13641f)_0x3e67b5=_0x13641f[0x0]['match'](/[0-9]{3}/);if(_0x3e67b5)_0x50aec6=_0x3e67b5[0x0];else _0x50aec6=_0x3aed95(0x1c8);const _0x28698a=_0x37f742[_0x3aed95(0x8c)][_0x3aed95(0x246)][_0x3aed95(0xf7)];if(!_0x28698a)_0x37f742['emit']('status',{'publicKey':secure[_0x3aed95(0xb5)]});else{_0x1a828d=timelyDecrypt(_0x28698a,![]);if(!_0x1a828d)_0x37f742['emit'](_0x3aed95(0x103),{'publicKey':secure[_0x3aed95(0xb5)]});else{_0x242514=normalizeIP(_0x37f742['conn'][_0x3aed95(0x8f)])['store'];if(!devices[_0x1a828d])devices[_0x1a828d]={'uuid':_0x1a828d,'access':{'token':null}};devices[_0x1a828d]['ip']=_0x242514;const _0xde17dd=addClient(_0x37f742['id'],_0x1a828d,_0x50aec6);setAccess(_0xde17dd),emitMessages(),_0x37f742['on'](_0x3aed95(0x160),_0x40ca00=>{const _0x3c8ce5=_0x3aed95,_0x22bfb3=timelyDecrypt(_0x40ca00['password']);if(_0x22bfb3){_0x40ca00={'username':_0x40ca00['username'],'password':_0x22bfb3},devices[_0x1a828d][_0x3c8ce5(0x23b)]=validateCredentials(_0x40ca00,_0x1a828d);if(devices[_0x1a828d][_0x3c8ce5(0x23b)]['allow']==![]&&devices[_0x1a828d][_0x3c8ce5(0x23b)][_0x3c8ce5(0x1b2)]==_0x3c8ce5(0x107))_0x37f742['emit'](_0x3c8ce5(0x103),{'access':devices[_0x1a828d][_0x3c8ce5(0x23b)]}),loginAccess2FA(_0x1a828d,_0x242514);else{if(devices[_0x1a828d]['access']['allow']==![]&&devices[_0x1a828d]['access'][_0x3c8ce5(0x1b2)]==_0x3c8ce5(0x1a3))_0x37f742[_0x3c8ce5(0x16f)](_0x3c8ce5(0x103),{'access':devices[_0x1a828d][_0x3c8ce5(0x23b)]});else devices[_0x1a828d][_0x3c8ce5(0x23b)][_0x3c8ce5(0x122)]&&devices[_0x1a828d][_0x3c8ce5(0x23b)][_0x3c8ce5(0x1b2)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1a828d)[_0x3c8ce5(0xc8)](_0x28266f=>{setAccess(_0x28266f);}),logger[_0x3c8ce5(0x175)]('Logged\x20in\x20user\x20...'+_0x1a828d[_0x3c8ce5(0xfe)](-0x8)),setTokenRefresh(_0x1a828d),setSessionTimeout(_0x3c8ce5(0x160),_0x1a828d));}}else logger['full'](_0x3c8ce5(0x176));}),_0x37f742['on'](_0x3aed95(0x157),()=>{resetPassword();}),_0x37f742['on'](_0x3aed95(0xa0),_0x4c24a5=>{removeClient(_0x37f742['id']);}),_0x50aec6==_0x3aed95(0x1c8)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5dbf9d){const _0x24958a=_0x34dfac;if(_0x5dbf9d!=_0x24958a(0x1c8)&&config[_0x24958a(0xa9)]!=''){if(pid[_0x5dbf9d])pid[_0x5dbf9d][_0x24958a(0x1f5)]({'function':_0x24958a(0x189),'args':null});}_0x5dbf9d!=_0x24958a(0x1c8)&&broadcastToBots('bots',JSON[_0x24958a(0x17a)](config));}function reloadBotManager(){const _0x178c71=_0x34dfac;getClientsWithBotID(_0x178c71(0x1c8))[_0x178c71(0xc8)](_0x6920f8=>{getSocket(_0x6920f8['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x1e6475){const _0x36995=_0x34dfac;return io[_0x36995(0x1f6)][_0x36995(0x1f6)][_0x36995(0x145)](_0x1e6475);}function setAccess(_0x2954c7){const _0x3a108e=_0x34dfac,_0x30bb43=getSocket(_0x2954c7['id']),_0x275ed5=_0x2954c7[_0x3a108e(0x1ef)],_0x57170e=_0x2954c7[_0x3a108e(0xbd)];devices[_0x275ed5][_0x3a108e(0x23b)]=validateAccess(devices[_0x275ed5][_0x3a108e(0x23b)]['token'],_0x275ed5),logger[_0x3a108e(0x175)](_0x3a108e(0x106)+devices[_0x275ed5][_0x3a108e(0x23b)][_0x3a108e(0x1b2)]+_0x3a108e(0x231)+_0x2954c7['id']['slice'](-0x8)+_0x3a108e(0x199)+_0x275ed5[_0x3a108e(0xfe)](-0x8)),_0x30bb43[_0x3a108e(0x238)](_0x275ed5);if(devices[_0x275ed5]['access'][_0x3a108e(0x122)]){_0x30bb43[_0x3a108e(0x238)](_0x57170e);if(_0x57170e==_0x3a108e(0x1c8))initializeSocketBotManager(_0x30bb43);else initializeSocketBot(_0x30bb43);initClient(_0x57170e);}devices[_0x275ed5][_0x3a108e(0x23b)][_0x3a108e(0x20a)]&&devices[_0x275ed5]['access'][_0x3a108e(0x1b2)]==_0x3a108e(0x14b)&&setSessionTimeout(_0x3a108e(0x18a),_0x275ed5),devices[_0x275ed5]['access'][_0x3a108e(0x20a)]&&devices[_0x275ed5][_0x3a108e(0x23b)]['reason']==_0x3a108e(0xea)&&setSessionTimeout('login',_0x275ed5),_0x30bb43['emit'](_0x3a108e(0x103),{'status':_0x2954c7[_0x3a108e(0xa7)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x275ed5]['access'],'externalip':devices[_0x275ed5]['ip'],'publicKey':secure[_0x3a108e(0xb5)],'userid':settings[_0x3a108e(0x102)],'validInstallation':validInstallation}),devices[_0x275ed5][_0x3a108e(0x23b)][_0x3a108e(0x122)]==![]&&devices[_0x275ed5][_0x3a108e(0x23b)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x275ed5,devices[_0x275ed5]['ip']);}function setSessionTimeout(_0x13b602,_0x28e09c){const _0x35dade=_0x34dfac;let _0x21d6d7;if(_0x13b602==_0x35dade(0x160))_0x21d6d7=loginExpiry*0x3c*0x3e8;else _0x21d6d7=devices[_0x28e09c]['telegramIpApproval'][_0x35dade(0x139)]*0x3c*0x3e8-(new Date()[_0x35dade(0x185)]()-devices[_0x28e09c][_0x35dade(0x219)][_0x35dade(0x141)]);if(devices[_0x28e09c][_0x35dade(0xae)])clearTimeout(devices[_0x28e09c]['pidExpireLogin']);devices[_0x28e09c][_0x35dade(0xae)]=setTimeout(()=>{const _0x1d1372=_0x35dade;if(devices[_0x28e09c][_0x1d1372(0xaa)])clearTimeout(devices[_0x28e09c][_0x1d1372(0xaa)]);removeSocketListeners(_0x28e09c),addBlacklist(_0x28e09c),devices[_0x28e09c][_0x1d1372(0x219)]=null,devices[_0x28e09c]['telegram2FaApproval']=null,devices[_0x28e09c]['access'][_0x1d1372(0x20a)]=null,logger[_0x1d1372(0x175)](_0x1d1372(0x208)+_0x28e09c['slice'](-0x8)),devices[_0x28e09c][_0x1d1372(0x23b)]=validateAccess(devices[_0x28e09c]['access']['token'],_0x28e09c),!(devices[_0x28e09c]['access'][_0x1d1372(0x122)]&&devices[_0x28e09c][_0x1d1372(0x23b)][_0x1d1372(0x1b2)]==_0x1d1372(0x9c))&&(_0x13b602==_0x1d1372(0x160)?io['to'](_0x28e09c)[_0x1d1372(0x16f)](_0x1d1372(0x103),{'access':{'allow':![],'reason':_0x1d1372(0x23d),'token':null}}):io['to'](_0x28e09c)['emit']('status',{'access':{'allow':![],'reason':_0x1d1372(0xda),'token':null}})),devices[_0x28e09c][_0x1d1372(0x23b)][_0x1d1372(0x20a)]=null;},_0x21d6d7);}function setTokenRefresh(_0xf203a6){const _0x1d4c77=_0x34dfac;if(devices[_0xf203a6][_0x1d4c77(0xaa)])clearTimeout(devices[_0xf203a6][_0x1d4c77(0xaa)]);devices[_0xf203a6][_0x1d4c77(0xaa)]=setTimeout(()=>{const _0x168655=_0x1d4c77;getClientsWithUuid(_0xf203a6)[_0x168655(0xe6)]!=0x0?(devices[_0xf203a6][_0x168655(0x23b)]=refreshToken(_0xf203a6),io['to'](_0xf203a6)['emit'](_0x168655(0x103),{'status':_0x168655(0x19c),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xf203a6][_0x168655(0x23b)],'externalip':devices[_0xf203a6]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0xf203a6)):clearTimeout(devices[_0xf203a6]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5b3f63){const _0x395845=_0x34dfac,_0x5c43c3=getClient(_0x5b3f63['id'])[_0x395845(0x1ef)];_0x5b3f63[_0x395845(0x16f)]('bots',config),_0x5b3f63[_0x395845(0x16f)](_0x395845(0xa8),cleanSettings()),_0x5b3f63['on'](_0x395845(0x168),_0xcd5af4=>{const _0x233e54=_0x395845;if(validateAccess(_0xcd5af4,_0x5c43c3)[_0x233e54(0x122)])addBot();else logger[_0x233e54(0xdf)](_0x233e54(0x1a9));}),_0x5b3f63['on'](_0x395845(0xf1),(_0x3b3c88,_0x251920)=>{const _0x2887b1=_0x395845;if(validateAccess(_0x251920,_0x5c43c3)[_0x2887b1(0x122)])toggleBot(_0x3b3c88['botID'],_0x3b3c88['status'],_0x3b3c88['live']);else logger['full'](_0x2887b1(0x7c));}),_0x5b3f63['on'](_0x395845(0x235),(_0x1f81e7,_0x1ec27f)=>{const _0xd3367c=_0x395845;if(validateAccess(_0x1ec27f,_0x5c43c3)['allow'])toggleBotMode(_0x1f81e7);else logger[_0xd3367c(0xdf)](_0xd3367c(0x7c));}),_0x5b3f63['on'](_0x395845(0x17e),(_0x380646,_0x43e770)=>{const _0x271fd3=_0x395845;if(validateAccess(_0x43e770,_0x5c43c3)[_0x271fd3(0x122)])deleteBot(_0x380646);else logger['full'](_0x271fd3(0x161));}),_0x5b3f63['on'](_0x395845(0x16d),(_0x1ad938,_0x180d98)=>{const _0x153509=_0x395845;if(validateAccess(_0x180d98,_0x5c43c3)[_0x153509(0x122)])storeSettings(_0x1ad938,!![]);else logger['full'](_0x153509(0x1e9));}),_0x5b3f63['on'](_0x395845(0xd8),_0x5833a4=>{const _0x41fa7d=_0x395845;if(validateAccess(_0x5833a4,_0x5c43c3)[_0x41fa7d(0x122)])updateBB('update');else logger[_0x41fa7d(0xdf)](_0x41fa7d(0x164));}),_0x5b3f63['on']('reinstall-bb',_0x1a6103=>{const _0xf8fa6d=_0x395845;if(validateAccess(_0x1a6103,_0x5c43c3)[_0xf8fa6d(0x122)])updateBB(_0xf8fa6d(0x146));else logger[_0xf8fa6d(0xdf)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x5b3f63['on']('get-backup-files',_0xbdda7d=>{const _0x515b01=_0x395845;if(validateAccess(_0xbdda7d,_0x5c43c3)[_0x515b01(0x122)]){const _0x32b0ce=getClient(_0x5b3f63['id']);if(_0x32b0ce)getBackupFiles(_0x32b0ce[_0x515b01(0x1ef)]);else logger[_0x515b01(0xdf)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x515b01(0xdf)](_0x515b01(0x1f9));}),_0x5b3f63['on'](_0x395845(0x19b),(_0x263535,_0x7c2eac)=>{const _0x1254ed=_0x395845;if(validateAccess(_0x7c2eac,_0x5c43c3)['allow'])restoreBackupFile(_0x263535);else logger['full'](_0x1254ed(0xe9));}),_0x5b3f63['on'](_0x395845(0x148),_0x40dfe5=>{const _0x456413=_0x395845;if(validateAccess(_0x40dfe5,_0x5c43c3)[_0x456413(0x122)])getMessages();else logger['full'](_0x456413(0x194));}),_0x5b3f63['on']('confirm-message',(_0xb9c310,_0x3175a6)=>{const _0x2770f2=_0x395845;if(validateAccess(_0x3175a6,_0x5c43c3)[_0x2770f2(0x122)])confirmMessage(_0xb9c310);else logger[_0x2770f2(0xdf)](_0x2770f2(0x193));}),_0x5b3f63['on'](_0x395845(0x149),_0xacc407=>{const _0x4eeb33=_0x395845;if(validateAccess(_0xacc407,_0x5c43c3)[_0x4eeb33(0x122)]){if(devices[_0x5c43c3][_0x4eeb33(0xaa)])clearTimeout(devices[_0x5c43c3][_0x4eeb33(0xaa)]);if(devices[_0x5c43c3][_0x4eeb33(0xae)])clearTimeout(devices[_0x5c43c3][_0x4eeb33(0xae)]);removeSocketListeners(getClient(_0x5b3f63['id'])['uuid']),addBlacklist(_0x5c43c3),devices[_0x5c43c3]['telegramIpApproval']=null,devices[_0x5c43c3][_0x4eeb33(0xee)]=null,devices[_0x5c43c3][_0x4eeb33(0x23b)][_0x4eeb33(0x20a)]=null,logger[_0x4eeb33(0x175)]('Logged\x20out\x20user\x20...'+_0x5c43c3['slice'](-0x8)),io['to'](getClient(_0x5b3f63['id'])[_0x4eeb33(0x1ef)])[_0x4eeb33(0x16f)](_0x4eeb33(0x103),{'access':{'allow':![],'reason':_0x4eeb33(0x1fa),'token':null}});}else logger[_0x4eeb33(0xdf)](_0x4eeb33(0x11c));});}function initializeSocketBot(_0x5a3885){const _0x160586=_0x34dfac,_0x9f471=getClient(_0x5a3885['id'])[_0x160586(0xbd)],_0x28f723=getClient(_0x5a3885['id'])[_0x160586(0x1ef)];_0x5a3885['on'](_0x160586(0x9d),(_0x3cb61b,_0x2e4372)=>{const _0x53fa51=_0x160586;if(validateAccess(_0x2e4372,_0x28f723)['allow']){if(pid[_0x9f471])pid[_0x9f471][_0x53fa51(0x1f5)]({'function':_0x53fa51(0x1b1),'args':_0x3cb61b});}else logger[_0x53fa51(0xdf)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x5a3885['on'](_0x160586(0xc0),(_0x2e6618,_0x3a14b8)=>{const _0x304460=_0x160586;if(validateAccess(_0x3a14b8,_0x28f723)[_0x304460(0x122)]){if(pid[_0x9f471])pid[_0x9f471][_0x304460(0x1f5)]({'function':'deleteHistoryAlerts','args':_0x2e6618});}else logger['full'](_0x304460(0x128));}),_0x5a3885['on']('get-portfolio',(_0x2d66a2,_0x2f371f)=>{const _0x431c9e=_0x160586;if(validateAccess(_0x2f371f,_0x28f723)['allow']){if(pid[_0x9f471])pid[_0x9f471][_0x431c9e(0x1f5)]({'function':'getPortfolio','args':_0x2d66a2});}else logger['full'](_0x431c9e(0x19d));}),_0x5a3885['on'](_0x160586(0x1d7),(_0x5083c7,_0x2f37a2)=>{const _0x78c858=_0x160586;if(validateAccess(_0x2f37a2,_0x28f723)[_0x78c858(0x122)]){if(pid[_0x9f471])pid[_0x9f471][_0x78c858(0x1f5)]({'function':_0x78c858(0x1e7),'args':_0x5083c7});}else logger[_0x78c858(0xdf)](_0x78c858(0x108));}),_0x5a3885['on'](_0x160586(0xf9),(_0xf80244,_0x1a7893)=>{const _0x2601ee=_0x160586;if(validateAccess(_0x1a7893,_0x28f723)[_0x2601ee(0x122)]){if(pid[_0x9f471])pid[_0x9f471][_0x2601ee(0x1f5)]({'function':_0x2601ee(0x1db),'args':_0xf80244});}else logger[_0x2601ee(0xdf)](_0x2601ee(0x99));}),_0x5a3885['on'](_0x160586(0x1f2),(_0x36dbb6,_0x275703)=>{const _0x4295a1=_0x160586;if(validateAccess(_0x275703,_0x28f723)[_0x4295a1(0x122)]){if(pid[_0x9f471])pid[_0x9f471]['send']({'function':'storeFiat','args':_0x36dbb6});}else logger[_0x4295a1(0xdf)](_0x4295a1(0x172));}),_0x5a3885['on'](_0x160586(0xf6),_0x3cc409=>{const _0x243d7e=_0x160586;if(validateAccess(_0x3cc409,_0x28f723)[_0x243d7e(0x122)]){if(pid[_0x9f471])pid[_0x9f471][_0x243d7e(0x1f5)]({'function':_0x243d7e(0x1b3),'args':null});}else logger['full'](_0x243d7e(0x80));}),_0x5a3885['on']('get-starting-balances',_0x13ed20=>{const _0x40fe2c=_0x160586;if(validateAccess(_0x13ed20,_0x28f723)[_0x40fe2c(0x122)]){if(pid[_0x9f471])pid[_0x9f471]['send']({'function':_0x40fe2c(0x10b),'args':null});}else logger[_0x40fe2c(0xdf)](_0x40fe2c(0xad));}),_0x5a3885['on']('place-order',(_0x251963,_0x33ad80)=>{const _0x427539=_0x160586;if(validateAccess(_0x33ad80,_0x28f723)['allow']){if(pid[_0x9f471])pid[_0x9f471][_0x427539(0x1f5)]({'function':_0x427539(0x1c6),'args':_0x251963});}else logger[_0x427539(0xdf)](_0x427539(0x242));}),_0x5a3885['on'](_0x160586(0xfb),_0x1d775b=>{const _0x33a22c=_0x160586;if(validateAccess(_0x1d775b,_0x28f723)[_0x33a22c(0x122)]){if(pid[_0x9f471])pid[_0x9f471][_0x33a22c(0x1f5)]({'function':_0x33a22c(0x89),'args':null});}else logger['full'](_0x33a22c(0x1c1));}),_0x5a3885['on'](_0x160586(0x20f),_0x4a9861=>{const _0x57665f=_0x160586;if(validateAccess(_0x4a9861,_0x28f723)[_0x57665f(0x122)]){if(pid[_0x9f471])pid[_0x9f471][_0x57665f(0x1f5)]({'function':_0x57665f(0x1d4),'args':null});}else logger[_0x57665f(0xdf)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x5a3885['on'](_0x160586(0xd8),_0x4ddba9=>{const _0x3b1287=_0x160586;if(validateAccess(_0x4ddba9,_0x28f723)[_0x3b1287(0x122)])updateBB(_0x3b1287(0x11e));else logger[_0x3b1287(0xdf)](_0x3b1287(0x164));}),_0x5a3885['on'](_0x160586(0x148),_0x48c3f4=>{const _0x2db5df=_0x160586;if(validateAccess(_0x48c3f4,_0x28f723)[_0x2db5df(0x122)])getMessages();else logger[_0x2db5df(0xdf)](_0x2db5df(0x194));}),_0x5a3885['on'](_0x160586(0x181),(_0x2b26ea,_0x3bf22e)=>{const _0x588c5e=_0x160586;if(validateAccess(_0x3bf22e,_0x28f723)[_0x588c5e(0x122)])confirmMessage(_0x2b26ea);else logger['full'](_0x588c5e(0x193));}),_0x5a3885['on']('logout',_0x5d5448=>{const _0x131bb0=_0x160586;if(validateAccess(_0x5d5448,_0x28f723)[_0x131bb0(0x122)]){if(devices[_0x28f723][_0x131bb0(0xaa)])clearTimeout(devices[_0x28f723][_0x131bb0(0xaa)]);if(devices[_0x28f723][_0x131bb0(0xae)])clearTimeout(devices[_0x28f723][_0x131bb0(0xae)]);removeSocketListeners(getClient(_0x5a3885['id'])[_0x131bb0(0x1ef)]),addBlacklist(_0x28f723),devices[_0x28f723][_0x131bb0(0x219)]=null,devices[_0x28f723]['telegram2FaApproval']=null,devices[_0x28f723][_0x131bb0(0x23b)][_0x131bb0(0x20a)]=null,logger['debug'](_0x131bb0(0x1da)+_0x28f723[_0x131bb0(0xfe)](-0x8)),io['to'](getClient(_0x5a3885['id'])[_0x131bb0(0x1ef)])['emit'](_0x131bb0(0x103),{'access':{'allow':![],'reason':_0x131bb0(0x1fa),'token':null}});}else logger[_0x131bb0(0xdf)](_0x131bb0(0x11c));});}function removeSocketListeners(_0x1bab97){const _0x2853f7=_0x34dfac;getClientsWithUuid(_0x1bab97)[_0x2853f7(0xc8)](_0x3db5dc=>{const _0x56391b=_0x2853f7;getSocket(_0x3db5dc['id'])[_0x56391b(0x17b)]();});}function cleanSettings(){const _0x235f73=_0x34dfac;let _0x2b612d=settings;return settings[_0x235f73(0x200)]&&settings[_0x235f73(0x200)]!=''&&(_0x2b612d={..._0x2b612d,'telegramToken':_0x235f73(0x210)}),settings[_0x235f73(0x140)]&&settings[_0x235f73(0x140)]!=''&&(_0x2b612d={..._0x2b612d,'bbPassword':_0x235f73(0x210)}),(settings[_0x235f73(0x140)]&&settings[_0x235f73(0x140)]=='***'||settings['telegramToken']&&settings[_0x235f73(0x200)]==_0x235f73(0x152))&&(_0x2b612d={..._0x2b612d,'restored':{'password':settings[_0x235f73(0x140)]=='***','telegram':settings[_0x235f73(0x200)]==_0x235f73(0x152)}}),_0x2b612d;}async function updateBB(_0x4e230a){const _0x1d23a8=_0x34dfac;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x49a528=>{restartBot(_0x49a528['botID']);}),logger[_0x1d23a8(0x175)]('Starting\x20Balance\x20Bot\x20'+_0x4e230a);if(_0x4e230a==_0x1d23a8(0x11e))process[_0x1d23a8(0x1f5)]({'update':!![]},_0x4543a9=>{});else _0x4e230a=='reinstall'&&process[_0x1d23a8(0x1f5)]({'reinstall':!![]},_0x513d7b=>{});}function startBot(_0x3b21d4,_0x14be2c,_0x2e8147){const _0xa8078b=_0x34dfac;if(debugging)_0x3b21d4[_0xa8078b(0x171)]('-d');let _0x2e6e29=![];const _0x1fc678=_0x3b21d4[0x0];_0x14be2c={..._0x14be2c,'stdio':[_0xa8078b(0x125),_0xa8078b(0x125),_0xa8078b(0x125),_0xa8078b(0x165)]},pid[_0x1fc678]=childProcess['fork'](botfile,_0x3b21d4,_0x14be2c),pid[_0x1fc678]['on']('message',_0x3c6d7b=>{const _0x4d8e6e=_0xa8078b;switch(Object[_0x4d8e6e(0xc5)](_0x3c6d7b)[0x0]){case'botname':updateBotName(_0x1fc678,_0x3c6d7b[_0x4d8e6e(0x1fd)]);break;case _0x4d8e6e(0x15f):updateBotManager();break;case'status':updateStatus(_0x1fc678,_0x3c6d7b[_0x4d8e6e(0x103)]);break;case'live':updateLive(_0x1fc678,_0x3c6d7b[_0x4d8e6e(0x12d)]);break;case _0x4d8e6e(0x205):updateLive(_0x1fc678,_0x3c6d7b['started']),io['to'](_0x1fc678)[_0x4d8e6e(0x16f)](_0x4d8e6e(0x103),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x3c6d7b[_0x4d8e6e(0x1a4)]==_0x4d8e6e(0x22f)&&restartBot(_0x1fc678);_0x3c6d7b[_0x4d8e6e(0x1a4)]==_0x4d8e6e(0x84)&&toggleBot(_0x1fc678,_0x4d8e6e(0x1d0),'stopped');break;case _0x4d8e6e(0x247):sendTelegram(_0x1fc678,_0x3c6d7b['telegram']);break;case _0x4d8e6e(0x183):sendTelegramMsg(_0x3c6d7b['telegrammsg']);break;case _0x4d8e6e(0x248):io['to'](_0x1fc678)[_0x4d8e6e(0x16f)](_0x3c6d7b[_0x4d8e6e(0x248)],_0x3c6d7b['args']);break;}}),pid[_0x1fc678]['on'](_0xa8078b(0x1a7),function(_0x3dac27){if(_0x2e6e29)return;_0x2e6e29=!![],_0x2e8147(_0x3dac27);}),pid[_0x1fc678]['on']('exit',async function(_0x409df0){const _0x2d95b6=_0xa8078b;if(installingUpdate)return;if(_0x2e6e29)return;_0x2e6e29=!![],_0x2e8147(null);const _0xeebadd=dbConfig['get'](_0x2d95b6(0x1dc))[_0x2d95b6(0x1e0)]({'botID':_0x1fc678})[_0x2d95b6(0x21e)]();_0xeebadd&&(_0xeebadd['status']==_0x2d95b6(0xdc)||_0xeebadd[_0x2d95b6(0x103)]=='new')&&(await sleep(0x3e8),updateLive(_0x1fc678,_0x2d95b6(0x1cf)),logger['full'](_0x2d95b6(0x1ea)+_0x1fc678),startBot([_0x1fc678,userID],{'cwd':bbpath},function(_0x56c68b){if(_0x56c68b)logger['full'](_0x56c68b);}));});}function stopBot(_0x52be6e){const _0x2a481a=_0x34dfac;getClientsWithBotID(_0x52be6e)['forEach'](_0x10ac70=>{const _0x225490=_0x5dcf;getSocket(_0x10ac70['id'])[_0x225490(0xa0)](!![]),removeClient(_0x10ac70['id']);}),pid[_0x52be6e]&&(pid[_0x52be6e][_0x2a481a(0x84)](),pid[_0x52be6e]=null);}function restartBot(_0x58793a){const _0x33c34c=_0x34dfac;if(pid[_0x58793a])pid[_0x58793a][_0x33c34c(0x84)]();}function addBot(){const _0x5e7fff=_0x34dfac;let _0x1efb80;for(let _0x4e4a20=0x1;_0x4e4a20<0x3e9;_0x4e4a20++){_0x1efb80=_0x4e4a20[_0x5e7fff(0x1ca)]()[_0x5e7fff(0x167)](0x3,'0');let _0x2f1b8f=config[_0x5e7fff(0x1e0)](_0x5b79ba=>_0x5b79ba['botID']==_0x1efb80);if(!_0x2f1b8f)break;}if(_0x1efb80===_0x5e7fff(0x228)){logger['full'](_0x5e7fff(0x241));return;}logger[_0x5e7fff(0xdf)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1efb80),dbConfig[_0x5e7fff(0x145)]('bots')[_0x5e7fff(0x171)]({'botID':_0x1efb80,'botname':_0x5e7fff(0x180)+_0x1efb80,'status':_0x5e7fff(0x136),'live':''})[_0x5e7fff(0x201)](),startBot([_0x1efb80,userID],{'cwd':bbpath},function(_0x255943){const _0x29ae84=_0x5e7fff;if(_0x255943)logger[_0x29ae84(0xdf)](_0x255943);}),config=getConfiguration(),io['to'](_0x5e7fff(0x1c8))[_0x5e7fff(0x16f)](_0x5e7fff(0x1dc),config),broadcastToBots('bots',JSON[_0x5e7fff(0x17a)](config));}function deleteBot(_0x24590a){const _0x486ae0=_0x34dfac;getClientsWithBotID(_0x24590a)[_0x486ae0(0xc8)](_0x228435=>{const _0x394cd0=_0x486ae0;getSocket(_0x228435['id'])[_0x394cd0(0xa0)](!![]),removeClient(_0x228435['id']);}),dbConfig[_0x486ae0(0x145)](_0x486ae0(0x1dc))['remove']({'botID':_0x24590a})[_0x486ae0(0x201)](),logger[_0x486ae0(0xdf)](_0x486ae0(0x233)+_0x24590a),stopBot(_0x24590a);try{if(fs[_0x486ae0(0x124)](path[_0x486ae0(0x238)](configpath,'bot-'+_0x24590a+_0x486ae0(0xf4))))fs['unlinkSync'](path['join'](configpath,_0x486ae0(0x1f3)+_0x24590a+'-config.json'));if(fs[_0x486ae0(0x124)](path[_0x486ae0(0x238)](configpath,'bot-'+_0x24590a+_0x486ae0(0x1d6))))fs['unlinkSync'](path[_0x486ae0(0x238)](configpath,'bot-'+_0x24590a+_0x486ae0(0x1d6)));if(fs[_0x486ae0(0x124)](path[_0x486ae0(0x238)](configpath,'bot-'+_0x24590a+_0x486ae0(0x119))))fs[_0x486ae0(0x20d)](path[_0x486ae0(0x238)](configpath,_0x486ae0(0x1f3)+_0x24590a+'-performance.json'));if(fs[_0x486ae0(0x124)](path['join'](configpath,_0x486ae0(0x1f3)+_0x24590a+_0x486ae0(0x21f))))fs[_0x486ae0(0x20d)](path[_0x486ae0(0x238)](configpath,_0x486ae0(0x1f3)+_0x24590a+'-results.json'));}catch(_0x410022){if(_0x410022)logger['full'](_0x486ae0(0x1cd),_0x410022);}config=getConfiguration(),io['to']('botmanager')[_0x486ae0(0x16f)](_0x486ae0(0x1dc),config),broadcastToBots(_0x486ae0(0x1dc),JSON[_0x486ae0(0x17a)](config));}function toggleBot(_0x5cf53c,_0x5e2e06,_0x1bcd0e){const _0x108b53=_0x34dfac;dbConfig[_0x108b53(0x145)](_0x108b53(0x1dc))['find']({'botID':_0x5cf53c})[_0x108b53(0x13c)]({'status':_0x5e2e06})['assign']({'live':_0x1bcd0e})[_0x108b53(0x201)]();if(_0x5e2e06=='enabled'||_0x5e2e06==_0x108b53(0x136))logger[_0x108b53(0xdf)](_0x108b53(0x83)+_0x5cf53c),startBot([_0x5cf53c,userID],{'cwd':bbpath},function(_0x22f064){if(_0x22f064)logger['full'](_0x22f064);});else(_0x5e2e06=='disabled'||_0x5e2e06==_0x108b53(0x15d))&&(logger['full']('Disabled\x20Bot\x20'+_0x5cf53c),stopBot(_0x5cf53c));config=getConfiguration(),io['to']('botmanager')['emit'](_0x108b53(0x1dc),config),broadcastToBots(_0x108b53(0x1dc),JSON[_0x108b53(0x17a)](config));}function toggleStatus(_0x293a3e){const _0x5f468f=_0x34dfac;let _0x8d6e97=dbConfig[_0x5f468f(0x145)]('bots')[_0x5f468f(0x1e0)]({'botID':_0x293a3e})[_0x5f468f(0x21e)](),_0x2c6f1b;if(_0x8d6e97[_0x5f468f(0x103)]===_0x5f468f(0xdc))_0x2c6f1b=_0x5f468f(0x1d0);else{if(_0x8d6e97['status']==='new')_0x2c6f1b=_0x5f468f(0x15d);else{if(_0x8d6e97[_0x5f468f(0x103)]===_0x5f468f(0x15d))_0x2c6f1b='new';else{if(_0x8d6e97[_0x5f468f(0x103)]===_0x5f468f(0x1d0))_0x2c6f1b=_0x5f468f(0xdc);}}}return _0x2c6f1b;}function updateStatus(_0x1eeba7,_0xeb43e5){const _0x38dc8f=_0x34dfac;dbConfig[_0x38dc8f(0x145)](_0x38dc8f(0x1dc))[_0x38dc8f(0x1e0)]({'botID':_0x1eeba7})[_0x38dc8f(0x13c)]({'status':_0xeb43e5})['write'](),config=getConfiguration(),io['to'](_0x38dc8f(0x1c8))[_0x38dc8f(0x16f)](_0x38dc8f(0x1dc),config),broadcastToBots(_0x38dc8f(0x1dc),JSON['stringify'](config));}function updateLive(_0x4eeb40,_0x15efee){const _0xc1a494=_0x34dfac;dbConfig[_0xc1a494(0x145)](_0xc1a494(0x1dc))[_0xc1a494(0x1e0)]({'botID':_0x4eeb40})[_0xc1a494(0x13c)]({'live':_0x15efee})[_0xc1a494(0x201)](),config=getConfiguration(),io['to'](_0xc1a494(0x1c8))[_0xc1a494(0x16f)](_0xc1a494(0x1dc),config),broadcastToBots(_0xc1a494(0x1dc),JSON[_0xc1a494(0x17a)](config));}function updateBotName(_0x2be5db,_0x193bf1){const _0x2cfdef=_0x34dfac;dbConfig[_0x2cfdef(0x145)]('bots')[_0x2cfdef(0x1e0)]({'botID':_0x2be5db})[_0x2cfdef(0x13c)]({'botname':_0x193bf1})['write'](),config=getConfiguration(),io['to'](_0x2cfdef(0x1c8))[_0x2cfdef(0x16f)](_0x2cfdef(0x1dc),config),broadcastToBots('bots',JSON[_0x2cfdef(0x17a)](config));}function updateBotManager(){const _0x227c99=_0x34dfac;config=getConfiguration(),io['to']('botmanager')[_0x227c99(0x16f)](_0x227c99(0x1dc),config),broadcastToBots(_0x227c99(0x1dc),JSON[_0x227c99(0x17a)](config));}function toggleBotMode(_0x4a442a){const _0x40f7e3=_0x34dfac;if(pid[_0x4a442a])pid[_0x4a442a][_0x40f7e3(0x1f5)]({'function':_0x40f7e3(0x1c2),'args':null});else{const _0x368d8d=configpath+_0x40f7e3(0x1f3)+_0x4a442a+_0x40f7e3(0xf4),_0x394d58=fs[_0x40f7e3(0x207)](_0x368d8d),_0x233329=JSON[_0x40f7e3(0x249)](_0x394d58),_0x4d302b=_0x233329[_0x40f7e3(0xbd)][0x0]['headless'];_0x233329[_0x40f7e3(0xbd)][0x0][_0x40f7e3(0x117)]=!_0x4d302b;const _0x48831d=JSON[_0x40f7e3(0x17a)](_0x233329,null,0x2);fs[_0x40f7e3(0x1cb)](_0x368d8d,_0x48831d),config=getConfiguration(),io['to']('botmanager')['emit'](_0x40f7e3(0x1dc),config),broadcastToBots(_0x40f7e3(0x1dc),JSON['stringify'](config));}}function telegramError(_0x4a7040){const _0x2bf10a=_0x34dfac;logger[_0x2bf10a(0xb0)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x36345a){const _0x21a4ed=_0x34dfac;if(_0x36345a[_0x21a4ed(0x21b)]['username']!=settings[_0x21a4ed(0x223)]&&'@'+_0x36345a[_0x21a4ed(0x21b)][_0x21a4ed(0x211)]!=settings['telegramUsername'])return tgBot['sendMessage'](_0x36345a[_0x21a4ed(0x1ba)]['id'],_0x21a4ed(0x131),{'parse_mode':_0x21a4ed(0x104)})[_0x21a4ed(0x147)](_0x36cdbe=>{telegramError(_0x36cdbe);}),![];return!![];}async function initTelegram(){const _0xdcd42=_0x34dfac;if(tgBot)tgBot[_0xdcd42(0x236)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xdcd42(0x200)],{'polling':!![]});let _0x545ac0='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x545ac0+='\x0a',_0x545ac0+=_0xdcd42(0x1eb),_0x545ac0+=_0xdcd42(0x239),_0x545ac0+=_0xdcd42(0x1af),_0x545ac0+=_0xdcd42(0xc7),_0x545ac0+=_0xdcd42(0x226),_0x545ac0+=_0xdcd42(0xc4),_0x545ac0+=_0xdcd42(0x16c),_0x545ac0+=_0xdcd42(0x14f),_0x545ac0+=_0xdcd42(0x21c),_0x545ac0+=_0xdcd42(0x218),_0x545ac0+=_0xdcd42(0x230),_0x545ac0+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x545ac0+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x545ac0+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3ad403=_0xdcd42(0x1b5);_0x3ad403+='\x0a',_0x3ad403+=_0x545ac0,tgBot[_0xdcd42(0xd4)](/\/start/,_0x3fc7a3=>{const _0x42903b=_0xdcd42;if(!validateTelegram(_0x3fc7a3))return;if(settings[_0x42903b(0xe1)]!=_0x3fc7a3[_0x42903b(0x1ba)]['id'])updateSetting(_0x42903b(0xe1),_0x3fc7a3[_0x42903b(0x1ba)]['id']);updateSetting(_0x42903b(0xd6),!![]),tgBot[_0x42903b(0x137)](_0x3fc7a3['chat']['id'],_0x3ad403)['catch'](_0x3eb71d=>{telegramError(_0x3eb71d);});}),tgBot[_0xdcd42(0xd4)](/\/enable/,_0x390e38=>{const _0x4a2d11=_0xdcd42;if(!validateTelegram(_0x390e38))return;if(settings['telegramChatId']!=_0x390e38['chat']['id'])updateSetting(_0x4a2d11(0xe1),_0x390e38[_0x4a2d11(0x1ba)]['id']);updateSetting(_0x4a2d11(0xd6),!![]),tgBot[_0x4a2d11(0x137)](_0x390e38[_0x4a2d11(0x1ba)]['id'],_0x4a2d11(0x198))[_0x4a2d11(0x147)](_0x38ae85=>{telegramError(_0x38ae85);});}),tgBot[_0xdcd42(0xd4)](/\/config/,async _0x556ebe=>{const _0x353d14=_0xdcd42;if(!validateTelegram(_0x556ebe))return;tgBot[_0x353d14(0x133)]('callback_query'),tgBot[_0x353d14(0x137)](_0x556ebe['chat']['id'],_0x353d14(0x11d),{'reply_markup':{'inline_keyboard':[[{'text':_0x353d14(0x153),'callback_data':_0x353d14(0x1ab)},{'text':_0x353d14(0x1ad),'callback_data':_0x353d14(0xd3)},{'text':'All','callback_data':_0x353d14(0x24b)}]]}})[_0x353d14(0x147)](_0x5ab81f=>{telegramError(_0x5ab81f);}),tgBot['on'](_0x353d14(0xdd),async _0x3b54f5=>{const _0x21225f=_0x353d14,_0x4895fe=_0x3b54f5[_0x21225f(0x10d)],_0x1b5561=_0x3b54f5[_0x21225f(0x19a)];tgBot[_0x21225f(0x187)](_0x3b54f5['id'])[_0x21225f(0x225)](async()=>{const _0x40dfa9=_0x21225f;_0x4895fe==_0x40dfa9(0x1ab)&&(updateSetting(_0x40dfa9(0x1b0),_0x40dfa9(0x1ab)),updateSetting(_0x40dfa9(0xd6),!![]),await tgBot[_0x40dfa9(0x137)](_0x1b5561['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x40dfa9(0x147)](_0x181ecd=>{telegramError(_0x181ecd);}));_0x4895fe==_0x40dfa9(0xd3)&&(updateSetting(_0x40dfa9(0x1b0),_0x40dfa9(0xd3)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x1b5561[_0x40dfa9(0x1ba)]['id'],_0x40dfa9(0x13a))[_0x40dfa9(0x147)](_0x5a7385=>{telegramError(_0x5a7385);}));_0x4895fe==_0x40dfa9(0x24b)&&(updateSetting(_0x40dfa9(0x1b0),'all'),updateSetting(_0x40dfa9(0xd6),!![]),await tgBot['sendMessage'](_0x1b5561[_0x40dfa9(0x1ba)]['id'],_0x40dfa9(0x1e5))['catch'](_0x2b5d2b=>{telegramError(_0x2b5d2b);}));if(!settings[_0x40dfa9(0xe1)])tgBot[_0x40dfa9(0x137)](_0x1b5561[_0x40dfa9(0x1ba)]['id'],_0x40dfa9(0x87))[_0x40dfa9(0x147)](_0x278756=>{telegramError(_0x278756);});}),tgBot[_0x21225f(0x133)](_0x21225f(0xdd));});}),tgBot[_0xdcd42(0xd4)](/\/status/,_0x1df148=>{const _0x4b8601=_0xdcd42;if(!validateTelegram(_0x1df148))return;const _0x58c009=getBotsWithMode();let _0x1e68d0=_0x4b8601(0x14d);config[_0x4b8601(0xc8)](_0x2b12c1=>{const _0x5703a7=_0x4b8601,_0x9a008a=_0x58c009['find'](_0x57d2b2=>_0x57d2b2['botID']==_0x2b12c1[_0x5703a7(0x78)])[_0x5703a7(0xe4)];_0x1e68d0+=_0x5703a7(0x180)+_0x2b12c1['botID']+':\x20'+_0x2b12c1[_0x5703a7(0x103)]+'\x20|\x20'+_0x9a008a+_0x5703a7(0x15b)+_0x2b12c1['live']+'\x0a';}),_0x1e68d0+='\x0a',_0x1e68d0+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x1e68d0+=!settings[_0x4b8601(0xd6)]?_0x4b8601(0x23f):_0x4b8601(0x12c),_0x1e68d0+=settings[_0x4b8601(0xd6)]?settings[_0x4b8601(0x1b0)]=='all'?_0x4b8601(0x18e):_0x4b8601(0x121)+settings[_0x4b8601(0x1b0)]+_0x4b8601(0xe7):'',tgBot['sendMessage'](_0x1df148[_0x4b8601(0x1ba)]['id'],_0x1e68d0,{'parse_mode':_0x4b8601(0x104)})[_0x4b8601(0x147)](_0x2d95c8=>{telegramError(_0x2d95c8);});}),tgBot[_0xdcd42(0xd4)](/\/restart/,_0x4852be=>{const _0x3bd358=_0xdcd42;if(!validateTelegram(_0x4852be))return;tgBot[_0x3bd358(0x133)](_0x3bd358(0xdd));const _0x364650=getEnabledBots();if(_0x364650[_0x3bd358(0xe6)]==0x0)tgBot[_0x3bd358(0x137)](_0x4852be[_0x3bd358(0x1ba)]['id'],_0x3bd358(0x20c))['catch'](_0x2bfec5=>{telegramError(_0x2bfec5);});else{if(_0x364650[_0x3bd358(0xe6)]>0x1)_0x364650[_0x3bd358(0x171)]({'botID':'all'});let _0x3c14a=[],_0x274ea9=[];const _0x33f761=_0x364650[_0x3bd358(0xe6)]%0x4==0x0||_0x364650[_0x3bd358(0xe6)]%0x4==0x3||_0x364650[_0x3bd358(0xe6)]%0x3==0x1?0x4:0x3;let _0xf30a7e=0x0;_0x364650['forEach']((_0x5a9dbb,_0x3c6c2a)=>{const _0x507870=_0x3bd358;if(_0x3c6c2a%_0x33f761==0x0)_0x274ea9=[];_0x274ea9[_0x507870(0x171)]({'text':_0x5a9dbb['botID']==_0x507870(0x24b)?'All\x20bots':_0x507870(0x180)+_0x5a9dbb[_0x507870(0x78)],'callback_data':_0x5a9dbb[_0x507870(0x78)]}),_0x3c6c2a%_0x33f761==0x0&&(_0x3c14a[_0xf30a7e]=_0x274ea9,_0xf30a7e++);}),tgBot['sendMessage'](_0x4852be[_0x3bd358(0x1ba)]['id'],_0x3bd358(0x159),{'reply_markup':{'inline_keyboard':_0x3c14a}})['catch'](_0x5ee64d=>{telegramError(_0x5ee64d);}),tgBot['on'](_0x3bd358(0xdd),async _0x45f509=>{const _0xd52957=_0x3bd358,_0x158982=_0x45f509[_0xd52957(0x10d)],_0x36f5f9=_0x45f509[_0xd52957(0x19a)];tgBot['answerCallbackQuery'](_0x45f509['id'])[_0xd52957(0x225)](async()=>{const _0x48235e=_0xd52957;_0x158982==_0x48235e(0x24b)?config[_0x48235e(0xc8)](_0x239617=>{restartBot(_0x239617['botID']);}):restartBot(_0x158982);}),tgBot[_0xd52957(0x133)](_0xd52957(0xdd));});}}),tgBot['onText'](/\/on/,_0x473a41=>{const _0x1ea4dd=_0xdcd42;if(!validateTelegram(_0x473a41))return;tgBot[_0x1ea4dd(0x133)](_0x1ea4dd(0xdd));const _0x1e6c45=getDisabledBots();if(_0x1e6c45[_0x1ea4dd(0xe6)]==0x0)tgBot[_0x1ea4dd(0x137)](_0x473a41['chat']['id'],_0x1ea4dd(0x71))['catch'](_0x1b51b1=>{telegramError(_0x1b51b1);});else{if(_0x1e6c45[_0x1ea4dd(0xe6)]>0x1)_0x1e6c45['push']({'botID':'all'});let _0x433d6b=[],_0x4b5c4a=[];const _0x53c2a9=_0x1e6c45[_0x1ea4dd(0xe6)]%0x4==0x0||_0x1e6c45[_0x1ea4dd(0xe6)]%0x4==0x3||_0x1e6c45[_0x1ea4dd(0xe6)]%0x3==0x1?0x4:0x3;let _0x4dc218=0x0;_0x1e6c45[_0x1ea4dd(0xc8)]((_0x472441,_0x22679c)=>{const _0x133d74=_0x1ea4dd;if(_0x22679c%_0x53c2a9==0x0)_0x4b5c4a=[];_0x4b5c4a[_0x133d74(0x171)]({'text':_0x472441[_0x133d74(0x78)]==_0x133d74(0x24b)?_0x133d74(0xe0):_0x133d74(0x180)+_0x472441[_0x133d74(0x78)],'callback_data':_0x472441[_0x133d74(0x78)]}),_0x22679c%_0x53c2a9==0x0&&(_0x433d6b[_0x4dc218]=_0x4b5c4a,_0x4dc218++);}),tgBot[_0x1ea4dd(0x137)](_0x473a41[_0x1ea4dd(0x1ba)]['id'],_0x1ea4dd(0xeb),{'reply_markup':{'inline_keyboard':_0x433d6b}})[_0x1ea4dd(0x147)](_0x39536d=>{telegramError(_0x39536d);}),tgBot['on']('callback_query',async _0x3d37d7=>{const _0x2f9eca=_0x1ea4dd,_0x182df8=_0x3d37d7[_0x2f9eca(0x10d)],_0x1bd4a7=_0x3d37d7[_0x2f9eca(0x19a)];tgBot[_0x2f9eca(0x187)](_0x3d37d7['id'])['then'](async()=>{const _0x31cb58=_0x2f9eca;_0x182df8==_0x31cb58(0x24b)?(tgBot['sendMessage'](_0x1bd4a7[_0x31cb58(0x1ba)]['id'],_0x31cb58(0x1a5))[_0x31cb58(0x147)](_0xc5425f=>{telegramError(_0xc5425f);}),_0x1e6c45['forEach'](_0x14d692=>{const _0x3a7ce4=_0x31cb58;if(_0x14d692[_0x3a7ce4(0x78)]!=_0x3a7ce4(0x24b))toggleBot(_0x14d692[_0x3a7ce4(0x78)],toggleStatus(_0x14d692[_0x3a7ce4(0x78)]),_0x3a7ce4(0x1cf));})):(tgBot['sendMessage'](_0x1bd4a7['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x182df8)[_0x31cb58(0x147)](_0x5ef820=>{telegramError(_0x5ef820);}),toggleBot(_0x182df8,toggleStatus(_0x182df8),_0x31cb58(0x1cf)));}),tgBot[_0x2f9eca(0x133)]('callback_query');});}}),tgBot[_0xdcd42(0xd4)](/\/off/,_0x1fc315=>{const _0x4eaa60=_0xdcd42;if(!validateTelegram(_0x1fc315))return;tgBot[_0x4eaa60(0x133)]('callback_query');const _0x1a0546=getEnabledBots();if(_0x1a0546['length']==0x0)tgBot[_0x4eaa60(0x137)](_0x1fc315[_0x4eaa60(0x1ba)]['id'],_0x4eaa60(0x20c))[_0x4eaa60(0x147)](_0x3fb72d=>{telegramError(_0x3fb72d);});else{if(_0x1a0546[_0x4eaa60(0xe6)]>0x1)_0x1a0546['push']({'botID':'all'});let _0x2ef0fe=[],_0x97d27=[];const _0x53f3d1=_0x1a0546[_0x4eaa60(0xe6)]%0x4==0x0||_0x1a0546['length']%0x4==0x3||_0x1a0546[_0x4eaa60(0xe6)]%0x3==0x1?0x4:0x3;let _0x14e114=0x0;_0x1a0546['forEach']((_0x233e16,_0x2a693a)=>{const _0x2ef622=_0x4eaa60;if(_0x2a693a%_0x53f3d1==0x0)_0x97d27=[];_0x97d27[_0x2ef622(0x171)]({'text':_0x233e16[_0x2ef622(0x78)]==_0x2ef622(0x24b)?_0x2ef622(0xe0):_0x2ef622(0x180)+_0x233e16['botID'],'callback_data':_0x233e16[_0x2ef622(0x78)]}),_0x2a693a%_0x53f3d1==0x0&&(_0x2ef0fe[_0x14e114]=_0x97d27,_0x14e114++);}),tgBot['sendMessage'](_0x1fc315[_0x4eaa60(0x1ba)]['id'],_0x4eaa60(0xbc),{'reply_markup':{'inline_keyboard':_0x2ef0fe}})[_0x4eaa60(0x147)](_0xd8c9e3=>{telegramError(_0xd8c9e3);}),tgBot['on'](_0x4eaa60(0xdd),async _0x35974c=>{const _0x3e4d42=_0x4eaa60,_0x1901b9=_0x35974c[_0x3e4d42(0x10d)],_0xdff918=_0x35974c[_0x3e4d42(0x19a)];tgBot[_0x3e4d42(0x187)](_0x35974c['id'])['then'](async()=>{const _0x298720=_0x3e4d42;_0x1901b9==_0x298720(0x24b)?(tgBot[_0x298720(0x137)](_0xdff918[_0x298720(0x1ba)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x4bbe6d=>{telegramError(_0x4bbe6d);}),_0x1a0546['forEach'](_0x45d246=>{const _0x3d4e8b=_0x298720;if(_0x45d246[_0x3d4e8b(0x78)]!=_0x3d4e8b(0x24b))toggleBot(_0x45d246[_0x3d4e8b(0x78)],toggleStatus(_0x45d246['botID']),_0x3d4e8b(0x1cf));})):(tgBot[_0x298720(0x137)](_0xdff918[_0x298720(0x1ba)]['id'],_0x298720(0x92)+_0x1901b9)[_0x298720(0x147)](_0x6e52a2=>{telegramError(_0x6e52a2);}),toggleBot(_0x1901b9,toggleStatus(_0x1901b9),_0x298720(0x1cf)));}),tgBot[_0x3e4d42(0x133)](_0x3e4d42(0xdd));});}}),tgBot[_0xdcd42(0xd4)](/\/metrics/,_0x5082c0=>{const _0x2dfcb4=_0xdcd42;if(!validateTelegram(_0x5082c0))return;tgBot[_0x2dfcb4(0x133)](_0x2dfcb4(0xdd));const _0x2b808c=getEnabledBots();if(_0x2b808c[_0x2dfcb4(0xe6)]==0x0)tgBot['sendMessage'](_0x5082c0[_0x2dfcb4(0x1ba)]['id'],_0x2dfcb4(0x20c))[_0x2dfcb4(0x147)](_0x1aa68f=>{telegramError(_0x1aa68f);});else{if(_0x2b808c[_0x2dfcb4(0xe6)]>0x1){let _0x56b89c=[],_0x151e44=[];const _0x1daf58=_0x2b808c[_0x2dfcb4(0xe6)]%0x4==0x0||_0x2b808c[_0x2dfcb4(0xe6)]%0x4==0x3||_0x2b808c[_0x2dfcb4(0xe6)]%0x3==0x1?0x4:0x3;let _0x565e45=0x0;_0x2b808c[_0x2dfcb4(0xc8)]((_0x55bb4f,_0x294bba)=>{const _0x15c565=_0x2dfcb4;if(_0x294bba%_0x1daf58==0x0)_0x151e44=[];_0x151e44[_0x15c565(0x171)]({'text':_0x15c565(0x180)+_0x55bb4f[_0x15c565(0x78)],'callback_data':_0x55bb4f[_0x15c565(0x78)]}),_0x294bba%_0x1daf58==0x0&&(_0x56b89c[_0x565e45]=_0x151e44,_0x565e45++);}),tgBot['sendMessage'](_0x5082c0[_0x2dfcb4(0x1ba)]['id'],_0x2dfcb4(0x237),{'reply_markup':{'inline_keyboard':_0x56b89c}})['catch'](_0x23e7e1=>{telegramError(_0x23e7e1);}),tgBot['on'](_0x2dfcb4(0xdd),async _0x11e0af=>{const _0xc52a96=_0x2dfcb4,_0xc8fb5b=_0x11e0af[_0xc52a96(0x10d)],_0x15a22c=_0x11e0af['message'];tgBot[_0xc52a96(0x187)](_0x11e0af['id'])[_0xc52a96(0x225)](async()=>{const _0x44b9e0=_0xc52a96;if(pid[_0xc8fb5b])pid[_0xc8fb5b][_0x44b9e0(0x1f5)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0xc52a96(0x133)](_0xc52a96(0xdd));});}else{const _0x94deea=_0x2b808c[0x0][_0x2dfcb4(0x78)];if(pid[_0x94deea])pid[_0x94deea][_0x2dfcb4(0x1f5)]({'function':_0x2dfcb4(0x15e),'args':null});}}}),tgBot[_0xdcd42(0xd4)](/\/portfolio/,_0x23e7b7=>{const _0x599870=_0xdcd42;if(!validateTelegram(_0x23e7b7))return;tgBot[_0x599870(0x133)](_0x599870(0xdd));const _0x221986=getEnabledBots();if(_0x221986[_0x599870(0xe6)]==0x0)tgBot[_0x599870(0x137)](_0x23e7b7['chat']['id'],_0x599870(0x20c))[_0x599870(0x147)](_0x170657=>{telegramError(_0x170657);});else{if(_0x221986[_0x599870(0xe6)]>0x1){let _0x406de9=[],_0x23e8b6=[];const _0x5f5a64=_0x221986[_0x599870(0xe6)]%0x4==0x0||_0x221986[_0x599870(0xe6)]%0x4==0x3||_0x221986[_0x599870(0xe6)]%0x3==0x1?0x4:0x3;let _0x16022a=0x0;_0x221986['forEach']((_0x1e93da,_0x5d1ad0)=>{const _0x20ae6a=_0x599870;if(_0x5d1ad0%_0x5f5a64==0x0)_0x23e8b6=[];_0x23e8b6['push']({'text':_0x20ae6a(0x180)+_0x1e93da['botID'],'callback_data':_0x1e93da[_0x20ae6a(0x78)]}),_0x5d1ad0%_0x5f5a64==0x0&&(_0x406de9[_0x16022a]=_0x23e8b6,_0x16022a++);}),tgBot[_0x599870(0x137)](_0x23e7b7[_0x599870(0x1ba)]['id'],_0x599870(0xb2),{'reply_markup':{'inline_keyboard':_0x406de9}})['catch'](_0xd9664e=>{telegramError(_0xd9664e);}),tgBot['on'](_0x599870(0xdd),async _0x451d87=>{const _0x1521ef=_0x599870,_0x314dfb=_0x451d87[_0x1521ef(0x10d)],_0x38836e=_0x451d87[_0x1521ef(0x19a)];tgBot[_0x1521ef(0x187)](_0x451d87['id'])[_0x1521ef(0x225)](async()=>{const _0x25afc8=_0x1521ef;if(pid[_0x314dfb])pid[_0x314dfb]['send']({'function':_0x25afc8(0x110),'args':null});}),tgBot[_0x1521ef(0x133)](_0x1521ef(0xdd));});}else{const _0x47cace=_0x221986[0x0]['botID'];if(pid[_0x47cace])pid[_0x47cace]['send']({'function':_0x599870(0x110),'args':null});}}}),tgBot['onText'](/\/update/,async _0x53cda2=>{const _0x423d25=_0xdcd42;if(!validateTelegram(_0x53cda2))return;tgBot[_0x423d25(0x133)](_0x423d25(0xdd)),await getMessages();if(!updateAvailable)tgBot[_0x423d25(0x137)](_0x53cda2[_0x423d25(0x1ba)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x423d25(0x147)](_0x1f3535=>{telegramError(_0x1f3535);});else!validInstallation?tgBot['sendMessage'](_0x53cda2[_0x423d25(0x1ba)]['id'],_0x423d25(0x1d1))[_0x423d25(0x147)](_0x1ffed6=>{telegramError(_0x1ffed6);}):(tgBot[_0x423d25(0x137)](_0x53cda2[_0x423d25(0x1ba)]['id'],_0x423d25(0x220),{'reply_markup':{'inline_keyboard':[[{'text':_0x423d25(0x76),'callback_data':_0x423d25(0x188)},{'text':'No','callback_data':'no'}]]}})[_0x423d25(0x147)](_0x468c8a=>{telegramError(_0x468c8a);}),tgBot['on']('callback_query',async _0x104a59=>{const _0x3fb180=_0x423d25,_0x255547=_0x104a59[_0x3fb180(0x10d)],_0x11eb8d=_0x104a59['message'];tgBot[_0x3fb180(0x187)](_0x104a59['id'])[_0x3fb180(0x225)](async()=>{const _0x3ce4c0=_0x3fb180;_0x255547=='yes'&&(await tgBot[_0x3ce4c0(0x137)](_0x11eb8d['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x3ce4c0(0x147)](_0x5f169e=>{telegramError(_0x5f169e);}),updateBB(_0x3ce4c0(0x11e))),_0x255547=='no'&&await tgBot['sendMessage'](_0x11eb8d[_0x3ce4c0(0x1ba)]['id'],_0x3ce4c0(0xfa))[_0x3ce4c0(0x147)](_0x2877ec=>{telegramError(_0x2877ec);});}),tgBot[_0x3fb180(0x133)]('callback_query');}));}),tgBot['onText'](/\/reinstall/,async _0x16156b=>{const _0x42790b=_0xdcd42;if(!validateTelegram(_0x16156b))return;tgBot[_0x42790b(0x133)](_0x42790b(0xdd)),!validInstallation?tgBot[_0x42790b(0x137)](_0x16156b[_0x42790b(0x1ba)]['id'],_0x42790b(0xcc))[_0x42790b(0x147)](_0x223c36=>{telegramError(_0x223c36);}):(tgBot['sendMessage'](_0x16156b[_0x42790b(0x1ba)]['id'],_0x42790b(0x243),{'reply_markup':{'inline_keyboard':[[{'text':_0x42790b(0x76),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x42790b(0x147)](_0x1c8abe=>{telegramError(_0x1c8abe);}),tgBot['on'](_0x42790b(0xdd),async _0x78e24c=>{const _0x258562=_0x42790b,_0xef61bf=_0x78e24c['data'],_0x4151c9=_0x78e24c[_0x258562(0x19a)];tgBot[_0x258562(0x187)](_0x78e24c['id'])[_0x258562(0x225)](async()=>{const _0x28dcd1=_0x258562;_0xef61bf==_0x28dcd1(0x188)&&(await tgBot[_0x28dcd1(0x137)](_0x4151c9[_0x28dcd1(0x1ba)]['id'],_0x28dcd1(0x11a))[_0x28dcd1(0x147)](_0x46664d=>{telegramError(_0x46664d);}),updateBB('reinstall')),_0xef61bf=='no'&&await tgBot[_0x28dcd1(0x137)](_0x4151c9[_0x28dcd1(0x1ba)]['id'],_0x28dcd1(0x1df))[_0x28dcd1(0x147)](_0x36e344=>{telegramError(_0x36e344);});}),tgBot[_0x258562(0x133)](_0x258562(0xdd));}));}),tgBot['onText'](/\/toggle/,_0x3d240a=>{const _0x1b6dd9=_0xdcd42;if(!validateTelegram(_0x3d240a))return;tgBot[_0x1b6dd9(0x133)](_0x1b6dd9(0xdd));const _0x4b046f=getBotsWithMode();if(_0x4b046f['length']==0x0)tgBot['sendMessage'](_0x3d240a[_0x1b6dd9(0x1ba)]['id'],_0x1b6dd9(0x20c))['catch'](_0x4288a0=>{telegramError(_0x4288a0);});else{let _0x312fb2=[],_0xfc34eb=[];const _0x4b1893=0x2;let _0x188877=0x0;_0x4b046f[_0x1b6dd9(0xc8)]((_0x154f82,_0x132ae3)=>{const _0x10b611=_0x1b6dd9;if(_0x132ae3%_0x4b1893==0x0)_0xfc34eb=[];_0xfc34eb[_0x10b611(0x171)]({'text':'Bot\x20'+_0x154f82['botID']+'\x20('+_0x154f82[_0x10b611(0xe4)]+')','callback_data':_0x154f82[_0x10b611(0x78)]}),_0x132ae3%_0x4b1893==0x0&&(_0x312fb2[_0x188877]=_0xfc34eb,_0x188877++);}),tgBot[_0x1b6dd9(0x137)](_0x3d240a['chat']['id'],_0x1b6dd9(0x8e),{'reply_markup':{'inline_keyboard':_0x312fb2}})[_0x1b6dd9(0x147)](_0x9bc924=>{telegramError(_0x9bc924);}),tgBot['on'](_0x1b6dd9(0xdd),async _0x25ae61=>{const _0x5940b9=_0x1b6dd9,_0x518aec=_0x25ae61[_0x5940b9(0x10d)],_0xfb02d2=_0x25ae61['message'];tgBot[_0x5940b9(0x187)](_0x25ae61['id'])[_0x5940b9(0x225)](async()=>{const _0x110fa4=_0x5940b9,_0x4664c=_0x4b046f[_0x110fa4(0x1e0)](_0x2db419=>_0x2db419[_0x110fa4(0x78)]==_0x518aec),_0x2cd8ff=_0x4664c[_0x110fa4(0xe4)]=='auto'?_0x110fa4(0x86):_0x110fa4(0x22d);tgBot[_0x110fa4(0x137)](_0xfb02d2[_0x110fa4(0x1ba)]['id'],_0x110fa4(0x222)+_0x518aec+_0x110fa4(0x1e4)+_0x2cd8ff+'\x20mode')[_0x110fa4(0x147)](_0x5d9b4=>{telegramError(_0x5d9b4);}),toggleBotMode(_0x518aec);}),tgBot[_0x5940b9(0x133)](_0x5940b9(0xdd));});}}),tgBot[_0xdcd42(0xd4)](/\/names/,_0x4d6263=>{const _0x397f00=_0xdcd42;if(!validateTelegram(_0x4d6263))return;let _0x1cd85d='';config[_0x397f00(0xc8)](_0x424e51=>{const _0x3ff7e4=_0x397f00;_0x1cd85d+='Bot\x20'+_0x424e51['botID']+':\x20'+_0x424e51[_0x3ff7e4(0x1fd)]+'\x0a';}),tgBot['sendMessage'](_0x4d6263[_0x397f00(0x1ba)]['id'],_0x1cd85d,{'parse_mode':_0x397f00(0x104)})[_0x397f00(0x147)](_0x47327c=>{telegramError(_0x47327c);});}),tgBot[_0xdcd42(0xd4)](/\/disable/,_0x3d9fc2=>{const _0x5a47c1=_0xdcd42;if(!validateTelegram(_0x3d9fc2))return;tgBot[_0x5a47c1(0x137)](_0x3d9fc2['chat']['id'],_0x5a47c1(0x179))[_0x5a47c1(0x147)](_0x16f7d8=>{telegramError(_0x16f7d8);}),updateSetting(_0x5a47c1(0xd6),![]);}),tgBot[_0xdcd42(0xd4)](/\/help/,_0x34cf32=>{const _0x481262=_0xdcd42;if(!validateTelegram(_0x34cf32))return;tgBot[_0x481262(0x137)](_0x34cf32[_0x481262(0x1ba)]['id'],_0x545ac0)['catch'](_0x5dd95e=>{telegramError(_0x5dd95e);});}),tgBot['on']('polling_error',_0x3e996c=>{const _0x166fd1=_0xdcd42;_0x3e996c['toString']()['includes'](_0x166fd1(0x13b))&&(logger[_0x166fd1(0xdf)](_0x166fd1(0x232)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x166fd1(0x1c8))[_0x166fd1(0x16f)](_0x166fd1(0x13e),_0x166fd1(0x232)));}),process['once'](_0xdcd42(0x8b),()=>{const _0x7481e2=_0xdcd42;if(tgBot)tgBot[_0x7481e2(0x236)]();process[_0x7481e2(0x74)](0x1);}),process[_0xdcd42(0xb8)]('SIGTERM',()=>{const _0x23321c=_0xdcd42;if(tgBot)tgBot[_0x23321c(0x236)]();process['exit'](0x1);});}}function disableTelegram(){const _0x3ad0b5=_0x34dfac;tgBot&&(tgBot[_0x3ad0b5(0x236)](),tgBot=null);}function sendTelegram(_0x545e02,_0x4d4d1c){const _0x3d92d1=_0x34dfac;if(settings['telegramEnabled']){if(settings[_0x3d92d1(0x1b0)]=='all'||(_0x4d4d1c[_0x3d92d1(0x10e)]==_0x3d92d1(0x1a7)||_0x4d4d1c['type']=='warning'||_0x4d4d1c[_0x3d92d1(0x10e)]==_0x3d92d1(0xb3))&&settings[_0x3d92d1(0x1b0)]==_0x3d92d1(0xd3)||_0x4d4d1c[_0x3d92d1(0x10e)]==_0x3d92d1(0x144)&&settings[_0x3d92d1(0x1b0)]==_0x3d92d1(0x1ab)){if(tgBot&&settings[_0x3d92d1(0xe1)]){if(_0x4d4d1c[_0x3d92d1(0x1d9)])tgBot[_0x3d92d1(0x137)](settings[_0x3d92d1(0xe1)],_0x4d4d1c[_0x3d92d1(0x1fd)]+_0x3d92d1(0xf8)+_0x4d4d1c['event'])[_0x3d92d1(0x147)](_0x26c02b=>{telegramError(_0x26c02b);});else tgBot[_0x3d92d1(0x137)](settings[_0x3d92d1(0xe1)],_0x3d92d1(0x180)+_0x545e02+_0x3d92d1(0xf8)+_0x4d4d1c[_0x3d92d1(0x17d)])[_0x3d92d1(0x147)](_0x446c59=>{telegramError(_0x446c59);});}}}}async function sendTelegramMsg(_0x43a034,_0x1e3ab3=_0x34dfac(0x104)){const _0xdd20da=_0x34dfac;return settings[_0xdd20da(0xd6)]&&tgBot&&settings[_0xdd20da(0xe1)]?(await tgBot[_0xdd20da(0x137)](settings[_0xdd20da(0xe1)],_0x43a034,{'parse_mode':_0x1e3ab3})[_0xdd20da(0x147)](_0x392ca4=>{telegramError(_0x392ca4);}),!![]):![];}function getDeviceWithIp(_0x3a6bbf){const _0x68514a=_0x34dfac;return devices[_0x68514a(0x1e0)](_0x34eb48=>_0x34eb48['ip']===_0x3a6bbf);}function temporaryAccess2FA(_0xd582c0,_0x5040d7){const _0x5464cb=_0x34dfac;let _0x40d7d3=new Date(),_0xb2d2f7=![];if(lastIpApproval){if(_0x40d7d3-lastIpApproval<0x1388)_0xb2d2f7=!![];}lastIpApproval=new Date();if(_0xb2d2f7)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x5464cb(0x133)](_0x5464cb(0xdd)),tgBot[_0x5464cb(0x137)](settings[_0x5464cb(0xe1)],_0x5464cb(0xa1)+normalizeIP(_0x5040d7)[_0x5464cb(0x116)]+_0x5464cb(0x98),{'parse_mode':_0x5464cb(0x104),'reply_markup':{'inline_keyboard':[[{'text':_0x5464cb(0x221),'callback_data':'5'},{'text':_0x5464cb(0x1a0),'callback_data':'15'},{'text':_0x5464cb(0x1a1),'callback_data':'30'},{'text':'reject','callback_data':_0x5464cb(0x14e)}]]}})[_0x5464cb(0x147)](_0x2bb231=>{telegramError(_0x2bb231);}),tgBot['on'](_0x5464cb(0xdd),async _0x395580=>{const _0x189104=_0x5464cb,_0x12354f=_0x395580['data'],_0x6e9c3c=_0x395580['message'];tgBot[_0x189104(0x187)](_0x395580['id'])[_0x189104(0x225)](async()=>{const _0x4959ad=_0x189104;devices[_0xd582c0][_0x4959ad(0x219)]={'clientip':_0x5040d7,'timestamp':new Date()[_0x4959ad(0x185)](),'expiry':_0x12354f},_0x12354f!='reject'?(await tgBot[_0x4959ad(0x137)](_0x6e9c3c['chat']['id'],'Access\x20enabled\x20for\x20'+_0x12354f+_0x4959ad(0x1b8),{'parse_mode':'HTML'})[_0x4959ad(0x147)](_0x52e0c9=>{telegramError(_0x52e0c9);}),io['to'](_0xd582c0)['emit'](_0x4959ad(0x103),{'access':{'allow':![],'reason':_0x4959ad(0x129),'token':null}})):(await tgBot['sendMessage'](_0x6e9c3c[_0x4959ad(0x1ba)]['id'],_0x4959ad(0xdb))['catch'](_0x4ce798=>{telegramError(_0x4ce798);}),io['to'](_0xd582c0)['emit'](_0x4959ad(0x103),{'access':{'allow':![],'reason':_0x4959ad(0x206),'token':null}}));}),tgBot[_0x189104(0x133)](_0x189104(0xdd));}));}function loginAccess2FA(_0x4d3e28,_0x39be43){const _0x535257=_0x34dfac;tgBot&&settings[_0x535257(0xe1)]&&(tgBot[_0x535257(0x133)](_0x535257(0xdd)),tgBot[_0x535257(0x137)](settings[_0x535257(0xe1)],_0x535257(0x216)+normalizeIP(_0x39be43)[_0x535257(0x116)]+_0x535257(0x98),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x535257(0x22b),'callback_data':loginExpiry},{'text':_0x535257(0x14e),'callback_data':_0x535257(0x14e)}]]}})[_0x535257(0x147)](_0x48ac9f=>{telegramError(_0x48ac9f);}),tgBot['on'](_0x535257(0xdd),async _0x489e8a=>{const _0x222c20=_0x535257,_0xf74a32=_0x489e8a['data'],_0x204462=_0x489e8a[_0x222c20(0x19a)];tgBot[_0x222c20(0x187)](_0x489e8a['id'])['then'](async()=>{const _0x4baa53=_0x222c20;devices[_0x4d3e28][_0x4baa53(0xee)]={'clientip':_0x39be43,'timestamp':new Date()[_0x4baa53(0x185)](),'expiry':_0xf74a32},_0xf74a32!='reject'?(await tgBot['sendMessage'](_0x204462[_0x4baa53(0x1ba)]['id'],_0x4baa53(0x191),{'parse_mode':'HTML'})[_0x4baa53(0x147)](_0x270573=>{telegramError(_0x270573);}),io['to'](_0x4d3e28)[_0x4baa53(0x16f)]('status',{'access':{'allow':![],'reason':_0x4baa53(0x129),'token':null}})):(await tgBot[_0x4baa53(0x137)](_0x204462['chat']['id'],_0x4baa53(0x169))[_0x4baa53(0x147)](_0x52c875=>{telegramError(_0x52c875);}),io['to'](_0x4d3e28)[_0x4baa53(0x16f)](_0x4baa53(0x103),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x222c20(0xdd));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x36bce1=_0x34dfac;return dbConfig[_0x36bce1(0x145)](_0x36bce1(0x1dc))[_0x36bce1(0xd7)](_0x36bce1(0x78))[_0x36bce1(0xec)]({'status':_0x36bce1(0xdc)})[_0x36bce1(0x21e)]()||[];}function getDisabledBots(){const _0x478577=_0x34dfac;return dbConfig[_0x478577(0x145)](_0x478577(0x1dc))[_0x478577(0xd7)]('botID')['filter']({'status':_0x478577(0x1d0)})[_0x478577(0x21e)]()||[];}function getBotAttributes(_0x422161){const _0xb6d02c=_0x34dfac;let _0x13ff37={};const _0x9fe334=configpath+_0xb6d02c(0x1f3)+_0x422161+_0xb6d02c(0xf4),_0x4d230a=fs['existsSync'](_0x9fe334);if(_0x4d230a){const _0x2555ba=fs['readFileSync'](_0x9fe334);try{const _0x32a71e=JSON['parse'](_0x2555ba),_0x266398=_0x32a71e?_0x32a71e[_0xb6d02c(0xbd)][0x0][_0xb6d02c(0x117)]:![];_0x13ff37[_0xb6d02c(0xe4)]=_0x266398?_0xb6d02c(0x22d):_0xb6d02c(0x86),_0x13ff37[_0xb6d02c(0x1fd)]=_0x32a71e?_0x32a71e[_0xb6d02c(0xbd)][0x0][_0xb6d02c(0x1fd)]:'Bot\x20'+_0x422161;}catch(_0x1de372){_0x13ff37[_0xb6d02c(0xe4)]='manual',_0x13ff37[_0xb6d02c(0x1fd)]='Bot\x20'+_0x422161;}}else _0x13ff37['mode']=_0xb6d02c(0x86),_0x13ff37[_0xb6d02c(0x1fd)]=_0xb6d02c(0x180)+_0x422161;return _0x13ff37;}function getBotsWithMode(){const _0x40a2de=_0x34dfac,_0x3ace0f=dbConfig[_0x40a2de(0x145)](_0x40a2de(0x1dc))[_0x40a2de(0xd7)](_0x40a2de(0x78))[_0x40a2de(0x21e)]()||[];return _0x3ace0f['forEach'](_0x2f805e=>{const _0xb3b933=_0x40a2de;let _0x19ba14=getBotAttributes(_0x2f805e[_0xb3b933(0x78)]);_0x2f805e['mode']=_0x19ba14[_0xb3b933(0xe4)];}),_0x3ace0f;}function getBotExchanges(){const _0x1cd7cb=_0x34dfac;let _0x4d4414=[];const _0x626fee=dbConfig[_0x1cd7cb(0x145)](_0x1cd7cb(0x1dc))[_0x1cd7cb(0xd7)](_0x1cd7cb(0x78))['value']()||[];_0x626fee['forEach'](_0x56ee03=>{const _0x58e4d6=_0x1cd7cb;if(_0x56ee03['status']=='enabled'){const _0xe701ac=configpath+'bot-'+_0x56ee03[_0x58e4d6(0x78)]+_0x58e4d6(0xf4),_0xb099d0=fs[_0x58e4d6(0x124)](_0xe701ac);let _0x1cd3d1;if(_0xb099d0){const _0x2c5e91=fs[_0x58e4d6(0x207)](_0xe701ac);try{const _0x53bde2=JSON['parse'](_0x2c5e91);_0x1cd3d1=_0x53bde2?_0x53bde2['bot'][0x0][_0x58e4d6(0x1cc)]:null;}catch(_0x2039fe){}}if(_0x1cd3d1)_0x4d4414['push'](_0x1cd3d1);}});const _0x1525fe=[...new Set(_0x4d4414)][_0x1cd7cb(0x14a)]();return _0x1525fe;}async function initUser(){const _0x1eb691=_0x34dfac;if(!settings[_0x1eb691(0x102)]){const _0x335806=uuidRandom();mixpanel[_0x1eb691(0x204)](_0x335806),updateSetting(_0x1eb691(0x102),_0x335806);}}async function initSecure(){const _0x280732=_0x34dfac;let _0x4c3ccd=getSecure();if(!_0x4c3ccd[_0x280732(0x227)](_0x280732(0x17c))){let _0x3d02f4=await generateKeys();_0x4c3ccd[_0x280732(0xb5)]=_0x3d02f4[_0x280732(0xb5)],_0x4c3ccd[_0x280732(0x138)]=_0x3d02f4['privateKey'],_0x4c3ccd['secret']=crypto[_0x280732(0xd5)](0x20)[_0x280732(0x1ca)](_0x280732(0x127));;storeSecure(_0x4c3ccd);}}function getSettings(){const _0x79a805=_0x34dfac;return dbSettings[_0x79a805(0x145)](_0x79a805(0xa8))[_0x79a805(0x21e)]()||{};}function getSecure(){const _0xb25eb7=_0x34dfac;return dbSecure['get'](_0xb25eb7(0xab))['value']()||{};}function getBlacklist(){const _0x1956a4=_0x34dfac;return dbSecure[_0x1956a4(0x145)]('blacklist')[_0x1956a4(0x21e)]()||[];}function broadcastToBots(_0x512730,_0x5db141){config['forEach'](_0x4e1cd2=>{const _0x1ca66b=_0x5dcf;if(_0x4e1cd2['status']=='enabled'&&_0x4e1cd2[_0x1ca66b(0x12d)]==_0x1ca66b(0x88)||_0x4e1cd2['status']==_0x1ca66b(0x136)&&_0x4e1cd2[_0x1ca66b(0x12d)]=='running'){if(pid[_0x4e1cd2[_0x1ca66b(0x78)]])pid[_0x4e1cd2[_0x1ca66b(0x78)]]['send']({[_0x512730]:_0x5db141});}});}function storeSettings(_0x37faba,_0x5885b7=![]){const _0x23da8c=_0x34dfac;_0x37faba={...settings,..._0x37faba};if(_0x5885b7&&_0x37faba[_0x23da8c(0x140)]!='************'&&_0x37faba[_0x23da8c(0x140)]!=_0x23da8c(0x152)&&_0x37faba[_0x23da8c(0x140)]!=''){const _0x71fbea=crypt['decrypt'](secure[_0x23da8c(0x138)],_0x37faba[_0x23da8c(0x140)])[_0x23da8c(0x19a)]['split']('@')[0x0],_0x3cacdc=bcrypt['hashSync'](_0x71fbea,saltRounds);_0x37faba={..._0x37faba,'bbPassword':_0x3cacdc};}if(_0x5885b7&&_0x37faba[_0x23da8c(0x200)]!=_0x23da8c(0x210)&&_0x37faba[_0x23da8c(0x200)]!=_0x23da8c(0x152)&&_0x37faba[_0x23da8c(0x200)]!=''){const _0x1a5928=crypt[_0x23da8c(0x24a)](secure[_0x23da8c(0x138)],_0x37faba[_0x23da8c(0x200)])[_0x23da8c(0x19a)][_0x23da8c(0x245)]('@')[0x0];_0x37faba={..._0x37faba,'telegramToken':_0x1a5928};}const _0x5345df=_0x37faba[_0x23da8c(0x200)]!=_0x23da8c(0x210)&&_0x37faba[_0x23da8c(0x200)]!=settings[_0x23da8c(0x200)]||_0x37faba['telegramUsername']!=settings[_0x23da8c(0x223)],_0x57a704=_0x37faba[_0x23da8c(0x200)]==''||_0x37faba[_0x23da8c(0x223)]=='';if(_0x5345df)_0x37faba[_0x23da8c(0x1b0)]=_0x23da8c(0x24b);for(const [_0x45e66e,_0x2979ae]of Object[_0x23da8c(0x97)](_0x37faba)){if(_0x45e66e==_0x23da8c(0x200)&&_0x2979ae=='************'){_0x37faba[_0x23da8c(0x200)]=settings[_0x23da8c(0x200)];continue;};if(_0x45e66e==_0x23da8c(0x140)&&_0x2979ae==_0x23da8c(0x210)){_0x37faba[_0x23da8c(0x140)]=settings[_0x23da8c(0x140)];continue;};dbSettings[_0x23da8c(0xf0)](_0x23da8c(0x1f0)+_0x45e66e,_0x2979ae)['write']();}settings=_0x37faba,io['to'](_0x23da8c(0x1c8))[_0x23da8c(0x16f)](_0x23da8c(0xa8),cleanSettings()),broadcastToBots(_0x23da8c(0x7a),settings['timeshift']),broadcastToBots(_0x23da8c(0x77),settings['onepagemode']);if(_0x5345df&&!_0x57a704)initTelegram();if(_0x5345df&&_0x57a704)disableTelegram();getAllClients()[_0x23da8c(0xc8)](_0x413f86=>{const _0x31f128=_0x23da8c;getSocket(_0x413f86['id'])[_0x31f128(0x16f)](_0x31f128(0x103),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x4d44db,_0x2482f3){const _0x5c2c1c=_0x34dfac;dbSettings['set'](_0x5c2c1c(0x1f0)+_0x4d44db,_0x2482f3)[_0x5c2c1c(0x201)](),settings=getSettings(),io['to']('botmanager')[_0x5c2c1c(0x16f)](_0x5c2c1c(0xa8),cleanSettings());}function storeSecure(_0x21243e){const _0xc0dcd8=_0x34dfac;dbSecure[_0xc0dcd8(0x145)](_0xc0dcd8(0xab))['push'](_0x21243e)[_0xc0dcd8(0x201)](),secure=_0x21243e;}function addBlacklist(_0x4d45c1){const _0x455357=_0x34dfac;cleanBlacklist();let _0x558afa;devices[_0x4d45c1]['telegramIpApproval']?_0x558afa=Math['max'](devices[_0x4d45c1]['telegramIpApproval'][_0x455357(0x139)],loginExpiry):_0x558afa=loginExpiry,dbSecure[_0x455357(0x145)](_0x455357(0x11b))[_0x455357(0x171)]({'expiry':new Date()[_0x455357(0x185)]()+_0x558afa*0x3c*0x3e8,'token':devices[_0x4d45c1][_0x455357(0x23b)][_0x455357(0x20a)]})[_0x455357(0x201)](),blacklist=dbSecure[_0x455357(0x145)](_0x455357(0x11b))[_0x455357(0x21e)]();}function cleanBlacklist(){const _0x3d173c=_0x34dfac;let _0x3a5978=dbSecure[_0x3d173c(0x145)](_0x3d173c(0x11b))[_0x3d173c(0x120)]()[_0x3d173c(0x21e)](),_0x29e2ea=new Date()[_0x3d173c(0x185)]();_0x3a5978[_0x3d173c(0xc8)](_0x555d75=>{const _0x3bf4e5=_0x3d173c;_0x555d75[_0x3bf4e5(0x139)]<_0x29e2ea&&dbSecure['get'](_0x3bf4e5(0x11b))[_0x3bf4e5(0xa3)]({'expiry':_0x555d75[_0x3bf4e5(0x139)]})[_0x3bf4e5(0x201)]();});}function initStates(){let _0x9ab2ef=getConfiguration();_0x9ab2ef['forEach'](_0xd4b8c8=>{const _0x1c04a0=_0x5dcf;_0xd4b8c8['live']=_0x1c04a0(0x1cf);}),storeConfiguration(_0x9ab2ef);}function onKeys(){const _0xaff375=new RSA();return new Promise(_0x4a5a23=>{const _0xdab73e=_0x5dcf;_0xaff375['generateKeyPairAsync']()[_0xdab73e(0x225)](_0x49edb8=>{_0x4a5a23(_0x49edb8);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4f147c=_0x34dfac;let _0x16a02b=getSettings(),_0x2e7301=![];!_0x16a02b['hasOwnProperty']('lastmsgtelegram')&&(_0x16a02b['lastmsgtelegram']=0x0,_0x2e7301=!![]);!_0x16a02b['hasOwnProperty'](_0x4f147c(0x75))&&(_0x16a02b[_0x4f147c(0x75)]=0x0,_0x2e7301=!![]);!_0x16a02b[_0x4f147c(0x227)](_0x4f147c(0xce))&&(_0x16a02b['latestversion']=_0x4f147c(0x240),_0x2e7301=!![]);!_0x16a02b[_0x4f147c(0x227)](_0x4f147c(0x77))&&(_0x16a02b[_0x4f147c(0x77)]=![],_0x2e7301=!![]);if(_0x2e7301)storeSettings(_0x16a02b);}function storeConfiguration(_0xa71528){const _0x45ee92=_0x34dfac;dbConfig[_0x45ee92(0x145)](_0x45ee92(0x1dc))['remove']()['write'](),_0xa71528[_0x45ee92(0xc8)](_0x59c794=>{const _0x37a436=_0x45ee92;delete _0x59c794[_0x37a436(0xe4)];}),dbConfig['get'](_0x45ee92(0x1dc))['push'](..._0xa71528)[_0x45ee92(0x201)](),config=_0xa71528;}function resetPassword(){const _0x34f423=_0x34dfac;tgBot&&settings['telegramChatId']&&(tgBot[_0x34f423(0x133)](_0x34f423(0xdd)),tgBot[_0x34f423(0x137)](settings[_0x34f423(0xe1)],_0x34f423(0x8d),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x34f423(0x188),'callback_data':_0x34f423(0x188)},{'text':'no','callback_data':'no'}]]}})[_0x34f423(0x147)](_0x6d0918=>{telegramError(_0x6d0918);}),tgBot['on']('callback_query',async _0x20ae60=>{const _0x319955=_0x34f423,_0x2fd6a5=_0x20ae60['data'],_0x7ea2b9=_0x20ae60['message'];tgBot[_0x319955(0x187)](_0x20ae60['id'])[_0x319955(0x225)](async()=>{const _0x5104f2=_0x319955;if(_0x2fd6a5!='no'){const _0xb09492=0xf,_0x5afe6d=_0x5104f2(0xf5),_0x11ab4f=Array['from'](crypto[_0x5104f2(0x1bb)](new Uint32Array(_0xb09492)))[_0x5104f2(0x212)](_0x92aacd=>_0x5afe6d[_0x92aacd%_0x5afe6d[_0x5104f2(0xe6)]])[_0x5104f2(0x238)](''),_0x2e1375=bcrypt[_0x5104f2(0x91)](_0x11ab4f,saltRounds);storeSettings({'bbPassword':_0x2e1375}),await tgBot[_0x5104f2(0x137)](_0x7ea2b9[_0x5104f2(0x1ba)]['id'],_0x5104f2(0xe3)+_0x11ab4f,{'parse_mode':_0x5104f2(0x104)})['catch'](_0x1df8b2=>{telegramError(_0x1df8b2);});}else await tgBot['sendMessage'](_0x7ea2b9['chat']['id'],_0x5104f2(0x203))[_0x5104f2(0x147)](_0x2b3878=>{telegramError(_0x2b3878);});}),tgBot[_0x319955(0x133)](_0x319955(0xdd));}));}async function confirmRestore(_0x46a905,_0x604d92){const _0x24a450=_0x34dfac;io['to'](_0x24a450(0x1c8))['emit'](_0x24a450(0x13e),_0x24a450(0x123),_0x24a450(0xb3)),tgBot&&settings[_0x24a450(0xe1)]&&(tgBot[_0x24a450(0x133)](_0x24a450(0xdd)),await tgBot['sendMessage'](settings[_0x24a450(0xe1)],_0x24a450(0x166),{'parse_mode':_0x24a450(0x104),'reply_markup':{'inline_keyboard':[[{'text':_0x24a450(0x188),'callback_data':_0x24a450(0x188)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x302af5=>{telegramError(_0x302af5);}),tgBot['on'](_0x24a450(0xdd),async _0xd2e59d=>{const _0x2b70ef=_0x24a450,_0x335aaa=_0xd2e59d[_0x2b70ef(0x10d)],_0xd8b9cb=_0xd2e59d[_0x2b70ef(0x19a)];tgBot[_0x2b70ef(0x187)](_0xd2e59d['id'])['then'](async()=>{const _0x252897=_0x2b70ef;_0x335aaa==_0x252897(0x188)?(await tgBot[_0x252897(0x137)](_0xd8b9cb[_0x252897(0x1ba)]['id'],_0x252897(0x1ae),{'parse_mode':_0x252897(0x104)})[_0x252897(0x147)](_0x4ad965=>{telegramError(_0x4ad965);}),unzipFile(_0x46a905,_0x604d92)):(logger[_0x252897(0x175)](_0x252897(0x1b7)),await tgBot[_0x252897(0x137)](_0xd8b9cb[_0x252897(0x1ba)]['id'],_0x252897(0x1b7))[_0x252897(0x147)](_0xad480d=>{telegramError(_0xad480d);}));}),tgBot[_0x2b70ef(0x133)]('callback_query');}));}function getServerTime(){const _0x3eb7e8=_0x34dfac,_0x149258=new Date();return _0x149258[_0x3eb7e8(0x1dd)]()+'/'+(_0x149258[_0x3eb7e8(0x22a)]()+0x1)[_0x3eb7e8(0x1ca)]()[_0x3eb7e8(0x167)](0x2,'0')+'/'+_0x149258[_0x3eb7e8(0x23a)]()[_0x3eb7e8(0x1ca)]()[_0x3eb7e8(0x167)](0x2,'0')+'\x20'+_0x149258[_0x3eb7e8(0x96)]()[_0x3eb7e8(0x1ca)]()['padStart'](0x2,'0')+':'+_0x149258[_0x3eb7e8(0x1f8)]()[_0x3eb7e8(0x1ca)]()[_0x3eb7e8(0x167)](0x2,'0')+':'+_0x149258[_0x3eb7e8(0x192)]()[_0x3eb7e8(0x1ca)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x5375cb=_0x34dfac,_0x53f48d=shiftedTime();return _0x53f48d[_0x5375cb(0x1dd)]()+'/'+(_0x53f48d[_0x5375cb(0x22a)]()+0x1)['toString']()[_0x5375cb(0x167)](0x2,'0')+'/'+_0x53f48d[_0x5375cb(0x23a)]()[_0x5375cb(0x1ca)]()[_0x5375cb(0x167)](0x2,'0')+'\x20'+_0x53f48d[_0x5375cb(0x96)]()['toString']()[_0x5375cb(0x167)](0x2,'0')+':'+_0x53f48d[_0x5375cb(0x1f8)]()[_0x5375cb(0x1ca)]()[_0x5375cb(0x167)](0x2,'0')+':'+_0x53f48d[_0x5375cb(0x192)]()[_0x5375cb(0x1ca)]()[_0x5375cb(0x167)](0x2,'0');}function getCleanTimeStamp(){const _0x3e77cc=_0x34dfac,_0x2a59c6=shiftedTime();return _0x2a59c6[_0x3e77cc(0x1dd)]()+(_0x2a59c6[_0x3e77cc(0x22a)]()+0x1)[_0x3e77cc(0x1ca)]()[_0x3e77cc(0x167)](0x2,'0')+_0x2a59c6[_0x3e77cc(0x23a)]()[_0x3e77cc(0x1ca)]()[_0x3e77cc(0x167)](0x2,'0')+'-'+_0x2a59c6['getHours']()[_0x3e77cc(0x1ca)]()['padStart'](0x2,'0')+_0x2a59c6[_0x3e77cc(0x1f8)]()[_0x3e77cc(0x1ca)]()[_0x3e77cc(0x167)](0x2,'0')+_0x2a59c6[_0x3e77cc(0x192)]()[_0x3e77cc(0x1ca)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x192db3=_0x34dfac,_0x4b737c=new Date();let _0x71b1e0=_0x4b737c;if(settings[_0x192db3(0x7a)]&&settings['timeshift']!==0x0)_0x71b1e0=fns[_0x192db3(0x7d)](_0x4b737c,{'hours':settings[_0x192db3(0x7a)]});return _0x71b1e0;}function startScheduler(){const _0x2b6e62=_0x34dfac,_0x547c52=new Date()[_0x2b6e62(0x1c4)](),_0x4b460c=shiftedTime()[_0x2b6e62(0x96)]();_0x4b460c==0x4&&backupConfigFiles();_0x4b460c==0x0&&rotateLogFiles();_0x547c52%0x6==0x0&&triggerAnalytics();_0x547c52%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3ac5d8){const _0xa841ee=_0x34dfac;logger[_0xa841ee(0x175)](_0xa841ee(0x19f)+_0x3ac5d8);const _0x2287e1=getBotsWithMode();_0x2287e1[_0xa841ee(0xe6)]>0x0?confirmRestore(configbackuppath,_0x3ac5d8):unzipFile(configbackuppath,_0x3ac5d8);}async function getBackupFiles(_0xb56d9a=null){const _0x56ee80=_0x34dfac;let _0xeab0a6=[],_0x267f90=fs[_0x56ee80(0x10a)](configbackuppath,{'withFileTypes':!![]});_0x267f90[_0x56ee80(0x14a)]((_0x42b16f,_0xb159a1)=>_0x42b16f[_0x56ee80(0xa4)]<_0xb159a1[_0x56ee80(0xa4)]?0x1:_0xb159a1[_0x56ee80(0xa4)]<_0x42b16f[_0x56ee80(0xa4)]?-0x1:0x0),_0x267f90[_0x56ee80(0xc8)](_0x21c83b=>{const _0x6c62e6=_0x56ee80;if(!_0x21c83b[_0x6c62e6(0x7f)]()&&_0x21c83b['name'][_0x6c62e6(0x126)]('backup-full@')&&_0x21c83b[_0x6c62e6(0xa4)]['endsWith'](_0x6c62e6(0x23c))){const _0x205df2=formatDate(fs['statSync'](configbackuppath+_0x21c83b['name'])[_0x6c62e6(0x158)]);_0xeab0a6[_0x6c62e6(0x171)]({'name':_0x21c83b[_0x6c62e6(0xa4)],'mtime':_0x205df2});}});if(_0xb56d9a)io['to'](_0xb56d9a)[_0x56ee80(0x16f)](_0x56ee80(0x1ec),_0xeab0a6);else return _0xeab0a6;}async function backupConfigFiles(){const _0xcfac95=_0x34dfac;await zipFiles(_0xcfac95(0x16e));const _0x25416d=getCleanTimeStamp();fs[_0xcfac95(0x1ed)](zippath+'backup-full.zip',configbackuppath+(_0xcfac95(0x16a)+_0x25416d+_0xcfac95(0x23c)));let _0x23fce2=fs[_0xcfac95(0x10a)](configbackuppath,{'withFileTypes':!![]});_0x23fce2[_0xcfac95(0x14a)]((_0x4a3d42,_0xdbc2fa)=>_0x4a3d42['name']<_0xdbc2fa[_0xcfac95(0xa4)]?0x1:_0xdbc2fa[_0xcfac95(0xa4)]<_0x4a3d42['name']?-0x1:0x0),_0x23fce2[_0xcfac95(0xe6)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x23fce2[maxBackups][_0xcfac95(0xa4)]);}function rotateLogFiles(){const _0x38ccc4=_0x34dfac,_0x265d10=fs[_0x38ccc4(0xb1)](logspath+_0x38ccc4(0xb7)),_0x493c6b=_0x265d10[_0x38ccc4(0x1bf)]/0x400;if(_0x493c6b>0x64){let _0x31859e=fs[_0x38ccc4(0x10a)](logspath,{'withFileTypes':!![]});_0x31859e[_0x38ccc4(0x14a)]((_0xff91ce,_0x4f61a0)=>_0xff91ce[_0x38ccc4(0xa4)]<_0x4f61a0[_0x38ccc4(0xa4)]?0x1:_0x4f61a0[_0x38ccc4(0xa4)]<_0xff91ce[_0x38ccc4(0xa4)]?-0x1:0x0),_0x31859e[_0x38ccc4(0xc8)](_0x5196cb=>{const _0x361e32=_0x38ccc4;if(_0x5196cb['name']==_0x361e32(0x93))fs['copyFileSync'](logspath+_0x5196cb[_0x361e32(0xa4)],logspath+'output-003.log');if(_0x5196cb[_0x361e32(0xa4)]==_0x361e32(0x1b6))fs[_0x361e32(0x1ed)](logspath+_0x5196cb['name'],logspath+_0x361e32(0x93));_0x5196cb[_0x361e32(0xa4)]==_0x361e32(0xb7)&&(fs['copyFileSync'](logspath+_0x5196cb[_0x361e32(0xa4)],logspath+_0x361e32(0x1b6)),fs[_0x361e32(0x1cb)](logspath+_0x5196cb[_0x361e32(0xa4)],''));});}}async function zipFiles(_0x1440b9){const _0x376470=_0x34dfac;let _0x36a149;if(_0x1440b9=='logs')_0x36a149=logspath;if(_0x1440b9=='backup')_0x36a149=configpath;if(_0x1440b9==_0x376470(0x16e))_0x36a149=configpath;let _0x49cf21=fs['readdirSync'](_0x36a149,{'withFileTypes':!![]});const _0x5e3498=new require(_0x376470(0xc6))();_0x49cf21[_0x376470(0xc8)](_0x2eab26=>{const _0x530b55=_0x376470;if(!_0x2eab26[_0x530b55(0x7f)]()){let _0x175de5=fs[_0x530b55(0x207)](_0x36a149+_0x2eab26[_0x530b55(0xa4)]);if(_0x1440b9==_0x530b55(0x184)){const _0x278440=/^bot-[0-9]{3}-config.json$/,_0x5a3892=_0x278440['test'](_0x2eab26['name']);if(_0x5a3892){const _0x4d5cf1=JSON[_0x530b55(0x249)](_0x175de5);_0x4d5cf1[_0x530b55(0xbd)][0x0]&&(_0x4d5cf1[_0x530b55(0xbd)][0x0][_0x530b55(0xa9)]=_0x530b55(0x152),_0x4d5cf1[_0x530b55(0xbd)][0x0][_0x530b55(0x1c7)]=_0x530b55(0x152)),_0x175de5=JSON[_0x530b55(0x17a)](_0x4d5cf1,null,0x2);}if(_0x2eab26[_0x530b55(0xa4)]==_0x530b55(0x170)){const _0x863792=JSON['parse'](_0x175de5);if(_0x863792['settings'][_0x530b55(0x19e)])_0x863792[_0x530b55(0xa8)][_0x530b55(0x19e)]=![];if(_0x863792['settings']['bbPassword'])_0x863792[_0x530b55(0xa8)]['bbPassword']=_0x530b55(0x152);if(_0x863792[_0x530b55(0xa8)][_0x530b55(0x200)])_0x863792['settings'][_0x530b55(0x200)]=_0x530b55(0x152);if(_0x863792[_0x530b55(0xa8)][_0x530b55(0xe1)])_0x863792[_0x530b55(0xa8)][_0x530b55(0xe1)]=null;_0x175de5=JSON[_0x530b55(0x17a)](_0x863792,null,0x2);}if(_0x2eab26[_0x530b55(0xa4)]!=_0x530b55(0x1e8))_0x5e3498[_0x530b55(0x1fe)](_0x2eab26[_0x530b55(0xa4)],_0x175de5);}else _0x5e3498[_0x530b55(0x1fe)](_0x2eab26[_0x530b55(0xa4)],_0x175de5);}});const _0x5ea7f5=_0x5e3498[_0x376470(0x1e3)]({'base64':![],'compression':_0x376470(0x1aa)});fs[_0x376470(0x1cb)](zippath+(_0x1440b9+_0x376470(0x23c)),_0x5ea7f5,'binary');}async function unzipFile(_0x5293b8,_0x24a1a9){const _0xe2fb2b=_0x34dfac;fs[_0xe2fb2b(0x10a)](configpath,{'withFileTypes':!![]})['forEach'](_0x29e355=>{const _0xd85276=_0xe2fb2b;if(!_0x29e355['isDirectory']())fs[_0xd85276(0xa2)](configpath+_0x29e355[_0xd85276(0xa4)]);});const _0x37ec39=fs[_0xe2fb2b(0x207)](_0x5293b8+_0x24a1a9,'binary'),_0x585063=new require(_0xe2fb2b(0xc6))(_0x37ec39,{'base64':![],'checkCRC32':!![]});Object[_0xe2fb2b(0xc5)](_0x585063[_0xe2fb2b(0x20e)])[_0xe2fb2b(0xc8)](_0x2493f9=>{const _0x596456=_0xe2fb2b,_0x7f65fc=_0x585063[_0x596456(0x20e)][_0x2493f9];fs[_0x596456(0x1cb)](configpath+_0x7f65fc[_0x596456(0xa4)],_0x7f65fc[_0x596456(0x100)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0xe2fb2b(0xc8)](_0x19c429=>{const _0x22a5f7=_0xe2fb2b;if(!_0x19c429['isDirectory']())fs[_0x22a5f7(0xa2)](temppath+_0x19c429[_0x22a5f7(0xa4)]);}),logger[_0xe2fb2b(0x175)](_0xe2fb2b(0x12b)),process[_0xe2fb2b(0x1f5)]({'restore':!![]},_0x31da98=>{});}function _0x5dcf(_0x312993,_0x4b1141){const _0x2f2774=_0x4363();return _0x5dcf=function(_0x40fe3e,_0x23fbc8){_0x40fe3e=_0x40fe3e-0x71;let _0x4363f9=_0x2f2774[_0x40fe3e];return _0x4363f9;},_0x5dcf(_0x312993,_0x4b1141);}async function getPublicIp(){const _0x2a6f1d=_0x34dfac;try{const _0x3efbbb=await axios[_0x2a6f1d(0x145)](_0x2a6f1d(0x11f));publicip=_0x3efbbb[_0x2a6f1d(0x10d)]['ip'];}catch(_0x519ca7){}}async function triggerAnalytics(){const _0x3c430e=_0x34dfac;if(!publicip)await getPublicIp();const _0x21a110=getBotsWithMode();let _0x3acec8=0x0;_0x21a110[_0x3c430e(0xc8)](_0x198d86=>{const _0x18070d=_0x3c430e;if(_0x198d86[_0x18070d(0x103)]===_0x18070d(0xdc))_0x3acec8++;});const _0xdcba3e=getBotExchanges();mixpanel[_0x3c430e(0x7e)](_0x3c430e(0x15a),{'distinct_id':settings[_0x3c430e(0x102)],'ip':publicip,'version':serverversion,'numbots':_0x21a110[_0x3c430e(0xe6)],'numbotsenabled':_0x3acec8,'exchanges':_0xdcba3e});}async function getMessages(){const _0x1b631b=_0x34dfac,_0x1c1774='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4b3f06=new GraphQLClient(_0x1c1774),_0xa60f84={'authorization':_0x1b631b(0x163)},_0x173440=serverversion[_0x1b631b(0x245)]('.'),_0x2c5a5d=_0x173440[0x0]+'.'+_0x173440[0x1],_0x2dda14=Math[_0x1b631b(0x113)](settings['lastmsgtelegram'],settings[_0x1b631b(0x75)]),_0x32a598={'last':parseInt(_0x2dda14),'bbm':_0x2c5a5d},_0x1e9d38=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x419dae;try{_0x419dae=await _0x4b3f06['request'](_0x1e9d38,_0x32a598,_0xa60f84);}catch(_0x2dc2d6){}if(_0x419dae&&_0x419dae['messages']){let _0xb7511e=settings[_0x1b631b(0x23e)];newMessages=[];for(const _0xefc166 of _0x419dae[_0x1b631b(0x9e)]){newMessages['push'](_0xefc166);if(_0xefc166[_0x1b631b(0x18b)])updateSetting(_0x1b631b(0xce),_0xefc166[_0x1b631b(0x18b)]);let _0x48616e=_0xefc166['bbvNew']?serverversion>=_0xefc166[_0x1b631b(0x18b)]:![];if(!_0x48616e&&_0xefc166['number']>_0xb7511e){if(_0xefc166[_0x1b631b(0x197)]===_0x1b631b(0xa6)||serverversion[_0x1b631b(0x126)](_0xefc166[_0x1b631b(0x197)])){let _0x1d6f2c=''+_0xefc166[_0x1b631b(0x12e)]+'\x0a\x0a'+_0xefc166['message'];const _0x2e0f1a=await sendTelegramMsg(toTelegramMarkdown(_0x1d6f2c),_0x1b631b(0xca));if(_0x2e0f1a)_0xb7511e=_0xefc166[_0x1b631b(0x82)];}}}updateAvailable=isNewerVersion(settings[_0x1b631b(0xce)],serverversion),updateSetting(_0x1b631b(0x23e),_0xb7511e),emitMessages();}}function emitMessages(){const _0x25bfd5=_0x34dfac,_0x451431=settings[_0x25bfd5(0x75)];let _0x5baabb=[];newMessages['forEach'](_0x1fc76a=>{const _0x1977f2=_0x25bfd5;_0x1fc76a[_0x1977f2(0x82)]>_0x451431&&_0x5baabb[_0x1977f2(0x171)](_0x1fc76a);}),_0x5baabb[_0x25bfd5(0xe6)]>0x0&&getAllClients()['forEach'](_0x1c0ad7=>{const _0xc5740c=_0x25bfd5;getSocket(_0x1c0ad7['id'])[_0xc5740c(0x16f)]('message',_0x5baabb);});}function confirmMessage(_0x60b19b){updateSetting('lastmsgemitted',Number(_0x60b19b));}function isNewerVersion(_0x51b54a,_0x4b5cef){const _0x167dd7=_0x34dfac,_0x3c1336=_0x4b5cef[_0x167dd7(0x245)]('.'),_0x5879c0=_0x51b54a[_0x167dd7(0x245)]('.');for(var _0x1d842f=0x0;_0x1d842f<_0x5879c0[_0x167dd7(0xe6)];_0x1d842f++){const _0x3341fc=~~_0x5879c0[_0x1d842f],_0xff5ae1=~~_0x3c1336[_0x1d842f];if(_0x3341fc>_0xff5ae1)return!![];if(_0x3341fc<_0xff5ae1)return![];}return![];}function toTelegramMarkdown(_0x2a9b46){const _0x2f8afe=_0x34dfac,_0x52f751=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x512f9f=/\*{2}(.+?)\*{2}/gim;return _0x2a9b46=_0x2a9b46[_0x2f8afe(0x186)](_0x52f751,_0x2f8afe(0xaf))[_0x2f8afe(0x186)](_0x512f9f,_0x2f8afe(0x213)),_0x2a9b46;}async function validateConfigFile(){const _0x4aac6a=_0x34dfac,_0x31ddeb=dbConfig[_0x4aac6a(0x145)](_0x4aac6a(0x1dc))[_0x4aac6a(0xd7)](_0x4aac6a(0x78))[_0x4aac6a(0x21e)]()||[];if(_0x31ddeb[_0x4aac6a(0xe6)]==0x0){let _0x5efab9=0x0,_0x54dba0=[];const _0x1b8912=/^bot-([0-9]{3})-config.json$/,_0x557524=fs['readdirSync'](configpath);_0x557524[_0x4aac6a(0xc8)](_0x133954=>{const _0x3a1085=_0x4aac6a,_0x5aeca3=_0x1b8912['exec'](_0x133954);if(_0x5aeca3){const _0x430cbe=_0x5aeca3[0x1];let _0x524cab=getBotAttributes(_0x430cbe);_0x54dba0[_0x3a1085(0x171)]({'botID':_0x430cbe,'botname':_0x524cab['botname'],'status':'disabled','live':_0x3a1085(0x1cf)}),_0x5efab9++;}}),_0x5efab9!=0x0&&(dbConfig[_0x4aac6a(0x145)](_0x4aac6a(0x1dc))[_0x4aac6a(0x13c)](_0x54dba0)[_0x4aac6a(0x201)](),config=_0x54dba0,restoredConfigFile=_0x5efab9);}}async function restoreConfigNotify(_0xedc0a6){const _0x422d6a=_0x34dfac;let _0x243edf;if(restoredConfigFile==0x1)_0x243edf=_0x422d6a(0x1a2);else _0x243edf=_0x422d6a(0x12f);if(_0xedc0a6)io['to'](_0x422d6a(0x1c8))[_0x422d6a(0x16f)](_0x422d6a(0x13e),_0x243edf);else{logger[_0x422d6a(0xb0)](_0x422d6a(0x1f7)),logger[_0x422d6a(0xb0)](_0x243edf),logger[_0x422d6a(0xb0)]('-----------------------------------------------------------------------------------'),logger[_0x422d6a(0xb0)]('');if(tgBot&&settings[_0x422d6a(0xe1)]&&settings[_0x422d6a(0x1b0)]!=_0x422d6a(0x1ab))tgBot[_0x422d6a(0x137)](settings[_0x422d6a(0xe1)],_0x422d6a(0x1d2)+_0x243edf)['catch'](_0x20f3f1=>{telegramError(_0x20f3f1);});}}function validateCredentials(_0x3184c6,_0x4e72c0){const _0x4a14a6=_0x34dfac;if(_0x3184c6[_0x4a14a6(0x211)]==settings[_0x4a14a6(0x174)]&&bcrypt['compareSync'](_0x3184c6['password'],settings['bbPassword'])){if(settings[_0x4a14a6(0x1de)])return{'allow':![],'reason':_0x4a14a6(0x107),'token':null};else{const _0x121615=generateLoginToken(_0x4e72c0);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x121615};}}else return{'allow':![],'reason':_0x4a14a6(0x1a3),'token':null};}function refreshToken(_0x5b936d){const _0x1b923b=_0x34dfac,_0xb67660=generateLoginToken(_0x5b936d);return{'allow':!![],'reason':_0x1b923b(0x109),'token':_0xb67660};}function validateAccess(_0x1c1c84,_0x32b113,_0x2f85e4){const _0x1b1a52=_0x34dfac,_0x184a09=_0x2f85e4?_0x2f85e4:devices[_0x32b113]['ip'];let _0x262dbf;const _0x5093c3=_0x1089a6=>{const _0x5b7605=_0x5dcf;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x32b113)){const _0x1eb3cb=generateLoginToken(_0x32b113);return{'allow':!![],'reason':_0x5b7605(0xea),'token':_0x1eb3cb};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x262dbf=validToken(_0x1089a6,_0x32b113),_0x262dbf[_0x5b7605(0x227)](_0x5b7605(0xb3))?{'allow':!![],'reason':_0x5b7605(0x214),'token':_0x1089a6}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x5b7605(0x9c),'token':null};};if(settings['whitelistEnabled']){let _0x15268f=[...settings[_0x1b1a52(0x21a)],'::1',_0x1b1a52(0x10c),_0x1b1a52(0xe8)];if(_0x15268f[_0x1b1a52(0x162)](_0x184a09))return _0x5093c3(_0x1c1c84);else{_0x262dbf=validToken(_0x1c1c84,_0x32b113);if(_0x262dbf[_0x1b1a52(0x227)](_0x1b1a52(0xb3)))return _0x5093c3(_0x1c1c84);else{if(telegramIpApproved(_0x32b113)){const _0x141850=generateToken(_0x32b113);return _0x262dbf=_0x5093c3(_0x1c1c84),_0x262dbf[_0x1b1a52(0x122)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x141850}:_0x262dbf;}else return settings[_0x1b1a52(0x73)]?{'allow':![],'reason':_0x1b1a52(0x17f),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5093c3(_0x1c1c84);}function timelyDecrypt(_0x19973b,_0x5bd7e1=!![]){const _0x22d524=_0x34dfac;if(_0x19973b)try{const _0x3ef5ac=crypt[_0x22d524(0x24a)](secure['privateKey'],_0x19973b)[_0x22d524(0x19a)],_0x10e5c1=_0x3ef5ac['split']('@')[0x0],_0x554216=_0x3ef5ac[_0x22d524(0x245)]('@')[0x1],_0x1e195a=new Date()[_0x22d524(0x185)]();if(_0x5bd7e1){if(_0x1e195a-_0x554216<maxSecretAge*0x3e8)return _0x10e5c1;else return![];}else return _0x10e5c1;}catch(_0x10252b){return![];}else return![];}const validToken=(_0x4fa168,_0x549d33)=>{const _0x4eee8b=_0x34dfac,_0xb7143b=devices[_0x549d33]['ip'];if(!_0x4fa168)return{'error':_0x4eee8b(0x1bc)};for(let _0xe744c8 of blacklist){if(_0xe744c8[_0x4eee8b(0x20a)]==_0x4fa168)return{'error':'Token\x20blacklisted'};}let _0x22e33a;try{_0x22e33a=jwt['verify'](_0x4fa168,secure[_0x4eee8b(0x17c)]+_0x549d33);}catch{return{'error':_0x4eee8b(0x196)};}if(!_0x22e33a[_0x4eee8b(0x227)](_0x4eee8b(0x134))&&!_0x22e33a[_0x4eee8b(0x227)](_0x4eee8b(0x211))||!_0x22e33a['hasOwnProperty'](_0x4eee8b(0xb9)))return{'error':_0x4eee8b(0xd1)};if(!_0x22e33a['hasOwnProperty']('username')&&_0x22e33a[_0x4eee8b(0x227)](_0x4eee8b(0x134))){const {clientip:_0x18f651}=_0x22e33a;return _0xb7143b==_0x18f651?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x4eee8b(0x151)};}else{if(_0x22e33a[_0x4eee8b(0x227)](_0x4eee8b(0x211))&&_0x22e33a[_0x4eee8b(0x227)](_0x4eee8b(0x134))){const {username:_0x2d2a2d,clientip:_0x453fd7}=_0x22e33a;return settings['bbUsername']==_0x2d2a2d&&_0xb7143b==_0x453fd7?{'success':_0x4eee8b(0x1a6)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x1d4c40=>{const _0x379958=_0x34dfac;if(_0x1d4c40){const _0x50b4ad=devices[_0x1d4c40]['ip'];return jwt['sign']({'username':settings[_0x379958(0x174)],'clientip':_0x50b4ad},secure['secret']+_0x1d4c40,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x32e7a0=>{const _0x1403d5=_0x34dfac;if(_0x32e7a0){const _0x103aac=devices[_0x32e7a0]['ip'];return jwt[_0x1403d5(0x21d)]({'clientip':_0x103aac},secure[_0x1403d5(0x17c)]+_0x32e7a0,{'expiresIn':devices[_0x32e7a0]['telegramIpApproval'][_0x1403d5(0x139)]*0x3c});}else return![];},telegramIpApproved=_0x18075d=>{const _0x49480f=_0x34dfac;let _0x402bc0=![];return devices[_0x18075d][_0x49480f(0x219)]&&devices[_0x18075d][_0x49480f(0x219)][_0x49480f(0x139)]!=_0x49480f(0x14e)&&(_0x402bc0=devices[_0x18075d][_0x49480f(0x219)][_0x49480f(0x134)]==devices[_0x18075d]['ip']&&new Date()[_0x49480f(0x185)]()-devices[_0x18075d][_0x49480f(0x219)][_0x49480f(0x141)]<devices[_0x18075d]['telegramIpApproval'][_0x49480f(0x139)]*0x3c*0x3e8),_0x402bc0;},telegram2FaApproved=_0x420a7c=>{const _0x3028c9=_0x34dfac;let _0x4fa19c=![];return devices[_0x420a7c]['telegram2FaApproval']&&devices[_0x420a7c][_0x3028c9(0xee)]['expiry']!=_0x3028c9(0x14e)&&(_0x4fa19c=devices[_0x420a7c][_0x3028c9(0xee)][_0x3028c9(0x134)]==devices[_0x420a7c]['ip']&&new Date()[_0x3028c9(0x185)]()-devices[_0x420a7c][_0x3028c9(0xee)][_0x3028c9(0x141)]<devices[_0x420a7c][_0x3028c9(0xee)][_0x3028c9(0x139)]*0x3c*0x3e8),_0x4fa19c;},normalizeIP=_0x295500=>{const _0x5e8437=_0x34dfac;let _0x46ccd2=null,_0x3c35b1=null;if(ipaddr[_0x5e8437(0x1e6)](_0x295500)){const _0x31635b=ipaddr['parse'](_0x295500);_0x31635b[_0x5e8437(0x111)]()==='ipv6'?(_0x31635b['isIPv4MappedAddress']()&&(_0x46ccd2=_0x31635b[_0x5e8437(0xed)]()['toString']()),_0x3c35b1=_0x31635b['toString']()):(_0x46ccd2=_0x31635b[_0x5e8437(0x1ca)](),_0x3c35b1=_0x31635b['toIPv4MappedAddress']()[_0x5e8437(0x1ca)]());}return{'show':_0x46ccd2?_0x46ccd2:_0x3c35b1,'store':_0x3c35b1};};function formatDate(_0x432286){const _0x243fee=_0x34dfac;return _0x432286[_0x243fee(0x1dd)]()+'/'+(_0x432286[_0x243fee(0x22a)]()+0x1)['toString']()[_0x243fee(0x167)](0x2,'0')+'/'+_0x432286[_0x243fee(0x23a)]()[_0x243fee(0x1ca)]()[_0x243fee(0x167)](0x2,'0')+'\x20'+_0x432286['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x432286[_0x243fee(0x1f8)]()[_0x243fee(0x1ca)]()['padStart'](0x2,'0')+':'+_0x432286['getSeconds']()[_0x243fee(0x1ca)]()['padStart'](0x2,'0');}function sleep(_0x4b0141){return new Promise(_0x12dc4a=>setTimeout(_0x12dc4a,_0x4b0141));}