const _0xf3309e=_0x5c3e;(function(_0x45ea4,_0x106cb3){const _0x42958a=_0x5c3e,_0x4961c1=_0x45ea4();while(!![]){try{const _0x336a7b=-parseInt(_0x42958a(0x230))/0x1*(-parseInt(_0x42958a(0x1c4))/0x2)+-parseInt(_0x42958a(0x102))/0x3+parseInt(_0x42958a(0xc5))/0x4*(parseInt(_0x42958a(0x218))/0x5)+-parseInt(_0x42958a(0xe3))/0x6+-parseInt(_0x42958a(0x146))/0x7*(parseInt(_0x42958a(0x1d8))/0x8)+-parseInt(_0x42958a(0x126))/0x9*(-parseInt(_0x42958a(0x173))/0xa)+-parseInt(_0x42958a(0xc7))/0xb*(-parseInt(_0x42958a(0x15c))/0xc);if(_0x336a7b===_0x106cb3)break;else _0x4961c1['push'](_0x4961c1['shift']());}catch(_0x1139eb){_0x4961c1['push'](_0x4961c1['shift']());}}}(_0x84a7,0xae079));const _0x193c83=function(){let _0x4b3a26=!![];return function(_0x149737,_0x11f9fd){const _0x1d1434=_0x4b3a26?function(){if(_0x11f9fd){const _0x6997c4=_0x11f9fd['apply'](_0x149737,arguments);return _0x11f9fd=null,_0x6997c4;}}:function(){};return _0x4b3a26=![],_0x1d1434;};}(),_0x3ae46e=_0x193c83(this,function(){const _0x42c5a2=_0x5c3e;return _0x3ae46e[_0x42c5a2(0xe1)]()['search'](_0x42c5a2(0x1a0))[_0x42c5a2(0xe1)]()[_0x42c5a2(0x151)](_0x3ae46e)[_0x42c5a2(0xd5)](_0x42c5a2(0x1a0));});_0x3ae46e();'use strict';process[_0xf3309e(0x1d0)][_0xf3309e(0xd4)]=0x1;const childProcess=require(_0xf3309e(0x1b8)),fs=require('fs'),fns=require(_0xf3309e(0xa5)),low=require(_0xf3309e(0x143)),FileSync=require(_0xf3309e(0x1e1)),path=require(_0xf3309e(0x1e7)),crypto=require(_0xf3309e(0x1eb)),Crypt=require(_0xf3309e(0x11c))[_0xf3309e(0x1fb)],RSA=require('hybrid-crypto-js')[_0xf3309e(0x10e)],bcrypt=require(_0xf3309e(0x191)),jwt=require(_0xf3309e(0xfb)),ipaddr=require(_0xf3309e(0x234)),argv=require(_0xf3309e(0xdb))(process[_0xf3309e(0x19f)][_0xf3309e(0x207)](0x2))[_0xf3309e(0x19f)],uuidRandom=require(_0xf3309e(0x172)),TelegramBot=require(_0xf3309e(0xb6)),Mixpanel=require('mixpanel'),axios=require(_0xf3309e(0x1cf)),{GraphQLClient,gql}=require(_0xf3309e(0x18f)),util=require(_0xf3309e(0x181)),fileUpload=require(_0xf3309e(0x23f)),{networkInterfaces}=require('os'),PORT=argv[_0xf3309e(0xda)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0xf3309e(0xe4)](_0xf3309e(0x276)+PORT+_0xf3309e(0x11f)),process[_0xf3309e(0x10d)](0x1));const HOST=argv['host']||null,userID=argv[_0xf3309e(0x1a5)]||'',debugging=argv['d']||![],nodeversion=process['versions']['node'];let bbpath=_0xf3309e(0x148),bbpath2='';const botfile=_0xf3309e(0xf3),configfile=_0xf3309e(0x252),settingsfile=_0xf3309e(0xf9),securefile=_0xf3309e(0xae),maxBackups=0xa;let validInstallation=!![];!fs[_0xf3309e(0x127)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xf3309e(0x1f4)),configpath=userID?bbpath+_0xf3309e(0xea)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0xf3309e(0xfd),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0xf3309e(0x11b)+userID+'/':bbpath+'zip/',loggerfile=fs[_0xf3309e(0x1a9)](logspath+_0xf3309e(0x1dd),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0xf3309e(0x11e);!fs[_0xf3309e(0x127)](configpath)&&fs['mkdirSync'](configpath);!fs[_0xf3309e(0x127)](configbackuppath)&&fs[_0xf3309e(0x208)](configbackuppath);!fs[_0xf3309e(0x127)](logspath)&&fs[_0xf3309e(0x208)](logspath);!fs[_0xf3309e(0x127)](zippath)&&fs[_0xf3309e(0x208)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0xf3309e(0x1a1)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xf3309e(0x21c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xf3309e(0x25f),'onepagemode':![]}})[_0xf3309e(0x1a1)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0xf3309e(0x1a1)]();let crypt=new Crypt({'md':_0xf3309e(0xc2),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0xf3309e(0x10f)](_0xf3309e(0x171),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xf3309e(0x196)]&&settings[_0xf3309e(0x196)]!=''&&settings[_0xf3309e(0xb9)]&&settings[_0xf3309e(0xb9)]!='')initTelegram();const parseColor=(_0x31d42c,_0x523c70)=>{const _0x27cff4=_0xf3309e,_0x34f0b7=/#[A-Z]{3}#/g;if(typeof _0x31d42c==_0x27cff4(0x1f0)){!_0x523c70?_0x31d42c=_0x31d42c[_0x27cff4(0x27c)](_0x34f0b7,''):(_0x31d42c=_0x31d42c['replace'](/#BLU#/g,_0x27cff4(0x1dc)),_0x31d42c=_0x31d42c[_0x27cff4(0x27c)](/#RED#/g,'\x1b[31m'),_0x31d42c=_0x31d42c[_0x27cff4(0x27c)](/#YEL#/g,_0x27cff4(0x211)),_0x31d42c=_0x31d42c['replace'](/#MAG#/g,_0x27cff4(0x187)),_0x31d42c=_0x31d42c[_0x27cff4(0x27c)](/#CYA#/g,_0x27cff4(0x1bb)),_0x31d42c=_0x31d42c[_0x27cff4(0x27c)](/#RES#/g,_0x27cff4(0x236)));;}return _0x31d42c;},logger={'screen':_0x2174dd=>{const _0xf774ae=_0xf3309e;console[_0xf774ae(0xe4)](parseColor(_0x2174dd,!![]));},'simple':_0x40057d=>{const _0x30bdb5=_0xf3309e;console[_0x30bdb5(0xe4)](parseColor(_0x40057d,!![])),loggerfile[_0x30bdb5(0x1a1)](util[_0x30bdb5(0x16f)](parseColor(_0x40057d,![]))+'\x0a');},'full':async _0x1ccafb=>{const _0xd449dc=_0xf3309e,_0x33c462=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1ccafb;console[_0xd449dc(0xe4)](parseColor(_0x33c462,!![])),loggerfile[_0xd449dc(0x1a1)](util[_0xd449dc(0x16f)](parseColor(_0x33c462,![]))+'\x0a');if(tgBot&&settings[_0xd449dc(0x21b)]&&settings[_0xd449dc(0x12d)]!=_0xd449dc(0xf4))await tgBot[_0xd449dc(0x270)](settings[_0xd449dc(0x21b)],_0xd449dc(0x1e2)+parseColor(_0x1ccafb,![]))['catch'](_0x223ff6=>{telegramError(_0x223ff6);});},'debug':async(_0x2d4a8b,_0x509f95='')=>{const _0x4b4049=_0xf3309e,_0x2a2c28=getTimeStamp()+_0x4b4049(0x203)+_0x2d4a8b;if(debugging)console[_0x4b4049(0xe4)](parseColor(_0x2a2c28,!![]));loggerfile[_0x4b4049(0x1a1)](util[_0x4b4049(0x16f)](parseColor(_0x2a2c28,![]))+'\x0a');if(_0x509f95){if(debugging)console[_0x4b4049(0xe4)](_0x509f95);loggerfile[_0x4b4049(0x1a1)](util[_0x4b4049(0x16f)](_0x509f95)+'\x0a');}}};process['on'](_0xf3309e(0x1ca),function(_0x2e06be){const _0x5a94a9=_0xf3309e;logger[_0x5a94a9(0x168)](_0x2e06be);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xf3309e(0x1f2))[_0xf3309e(0x15d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xf3309e(0x20b)),app=express(),http=require(_0xf3309e(0xb3))['createServer'](app);app[_0xf3309e(0x271)](fileUpload({'useTempFiles':!![]})),app[_0xf3309e(0xec)](_0xf3309e(0x212),async(_0x12225b,_0x359fb5)=>{const _0x3d67cf=_0xf3309e,_0x3a8e1=_0x12225b[_0x3d67cf(0x24c)][_0x3d67cf(0x277)],_0x3533f9=getClientsWithBotID(_0x3d67cf(0x153)),_0x561044=_0x12225b[_0x3d67cf(0x16b)][_0x3d67cf(0x119)],_0x3ab792=timelyDecrypt(_0x561044,![]),_0xc73e3b=_0x3533f9[_0x3d67cf(0x165)](_0x4def63=>_0x4def63[_0x3d67cf(0x119)]==_0x3ab792);if(_0xc73e3b){const _0x132ec3=normalizeIP(_0x12225b[_0x3d67cf(0x223)][_0x3d67cf(0xd8)])[_0x3d67cf(0x204)],_0x2438a7=_0x12225b[_0x3d67cf(0x16b)][_0x3d67cf(0x200)];if(validateAccess(_0x2438a7,_0x3ab792,_0x132ec3)[_0x3d67cf(0x1c2)])_0x3a8e1==_0x3d67cf(0x27a)&&await backupConfigFiles(),await zipFiles(_0x3a8e1),_0x359fb5[_0x3d67cf(0x261)](zippath+(_0x3a8e1+_0x3d67cf(0x1e9)),_0x43b3f3=>{const _0x3f01bd=_0x3d67cf;_0x43b3f3&&(logger[_0x3f01bd(0x22a)]('Failed\x20to\x20download\x20'+_0x3a8e1),logger[_0x3f01bd(0x168)](_0x43b3f3));});else logger[_0x3d67cf(0x22a)](_0x3d67cf(0x258)+_0x3a8e1+_0x3d67cf(0xa6));}else logger[_0x3d67cf(0x22a)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x3a8e1+_0x3d67cf(0x1d2));}),app['post'](_0xf3309e(0x265),async(_0x4673b,_0x4479a5)=>{const _0x410616=_0xf3309e,_0x3c234e=getClientsWithBotID(_0x410616(0x153)),_0xa63d27=_0x4673b[_0x410616(0x16b)][_0x410616(0x119)],_0x23744a=timelyDecrypt(_0xa63d27,![]),_0x154003=_0x3c234e[_0x410616(0x165)](_0x1c0d3c=>_0x1c0d3c[_0x410616(0x119)]==_0x23744a);logger[_0x410616(0x205)](_0x410616(0x19e));if(_0x154003){const _0x16fecc=normalizeIP(_0x4673b[_0x410616(0x223)]['remoteAddress'])[_0x410616(0x204)],_0x53fd84=_0x4673b['headers'][_0x410616(0x200)];if(validateAccess(_0x53fd84,_0x23744a,_0x16fecc)['allow']){if(_0x4673b[_0x410616(0xb2)]){const _0x2b26f0=_0x4673b['files'][_0x410616(0x107)];await _0x2b26f0['mv'](temppath+_0x2b26f0['name']),_0x4479a5['send']({'status':!![],'message':_0x410616(0x21e)});const _0x1589ce=getBotsWithMode();_0x1589ce[_0x410616(0x1d4)]>0x0?confirmRestore(temppath,_0x2b26f0['name']):unzipFile(temppath,_0x2b26f0[_0x410616(0xce)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x410616(0x122));}),app['use'](express[_0xf3309e(0xb1)](path[_0xf3309e(0x180)](__dirname,bbpath2,'build2'))),app[_0xf3309e(0x271)](express['static'](path[_0xf3309e(0x180)](__dirname,bbpath2,'build'))),app[_0xf3309e(0xec)]('/',function(_0x2d36f8,_0xbd578b){const _0x5742a7=_0xf3309e;_0xbd578b[_0x5742a7(0x274)](path['join'](__dirname,bbpath2,_0x5742a7(0x154),'index.html'));}),app[_0xf3309e(0xec)]('/:bot',function(_0x5838a1,_0xb1db18){const _0x1a5e50=_0xf3309e;_0xb1db18[_0x1a5e50(0x274)](path[_0x1a5e50(0x180)](__dirname,bbpath2,_0x1a5e50(0x195),'index.html'));}),app[_0xf3309e(0xec)](_0xf3309e(0x1b2),(_0xd6941,_0x595548)=>{const _0x93d87d=_0xf3309e;_0x595548[_0x93d87d(0x274)](path[_0x93d87d(0x180)](__dirname,bbpath2,_0x93d87d(0x195),_0x93d87d(0xe7)));}),app[_0xf3309e(0xec)](_0xf3309e(0x1a6),(_0x67332f,_0x40319a)=>{const _0x29b806=_0xf3309e;_0x40319a[_0x29b806(0x274)](path[_0x29b806(0x180)](__dirname,bbpath2,_0x29b806(0x195),_0x29b806(0xe7)));}),app[_0xf3309e(0xec)](_0xf3309e(0x278),(_0x496426,_0x497bf4)=>{const _0x2ec236=_0xf3309e;_0x497bf4[_0x2ec236(0x274)](path[_0x2ec236(0x180)](__dirname,bbpath2,_0x2ec236(0x195),_0x2ec236(0xe7)));}),app[_0xf3309e(0xec)]('/:bot/history',(_0x1e6175,_0x495043)=>{const _0x424fd6=_0xf3309e;_0x495043[_0x424fd6(0x274)](path[_0x424fd6(0x180)](__dirname,bbpath2,_0x424fd6(0x195),_0x424fd6(0xe7)));}),app[_0xf3309e(0xec)](_0xf3309e(0x18d),(_0x38c55e,_0x4806da)=>{const _0x5ec4a3=_0xf3309e;_0x4806da[_0x5ec4a3(0x274)](path[_0x5ec4a3(0x180)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/support',(_0x149600,_0x17d3eb)=>{const _0x243f56=_0xf3309e;_0x17d3eb[_0x243f56(0x274)](path[_0x243f56(0x180)](__dirname,bbpath2,_0x243f56(0x195),_0x243f56(0xe7)));});if(HOST)http[_0xf3309e(0x27d)](PORT,HOST);else http['listen'](PORT);function _0x5c3e(_0xe1dc55,_0x4ce9ed){const _0x3c5da8=_0x84a7();return _0x5c3e=function(_0x3ae46e,_0x193c83){_0x3ae46e=_0x3ae46e-0xa5;let _0x84a739=_0x3c5da8[_0x3ae46e];return _0x84a739;},_0x5c3e(_0xe1dc55,_0x4ce9ed);}const io=require(_0xf3309e(0x137))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x430f33=_0xf3309e;let _0x3f5f01=_0x430f33(0xff);const _0x359828=networkInterfaces(),_0x302332={};for(const _0xe852f1 of Object['keys'](_0x359828)){for(const _0x1c7124 of _0x359828[_0xe852f1]){if((_0x1c7124[_0x430f33(0x11d)]==_0x430f33(0x144)||_0x1c7124[_0x430f33(0x11d)]==0x4)&&!_0x1c7124[_0x430f33(0x1d7)]){const _0x13941f=ipaddr[_0x430f33(0x1c7)](_0x1c7124['address'])[_0x430f33(0x139)]();_0x13941f!=_0x430f33(0x100)&&(!_0x302332[_0xe852f1]&&(_0x302332[_0xe852f1]=[]),_0x302332[_0xe852f1][_0x430f33(0x20c)](_0x1c7124[_0x430f33(0x1e6)]),_0x3f5f01=_0x1c7124['address']);}}}return{'serverip':_0x3f5f01,'netinterfaces':_0x302332};}async function startServer(){const _0x40fed0=_0xf3309e,{serverip:_0x58dde2,netinterfaces:_0x40d327}=getServerIP();logger[_0x40fed0(0x168)](''),logger[_0x40fed0(0x168)](_0x40fed0(0x1b3)),await logger[_0x40fed0(0x22a)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x40fed0(0x1bf))+(_0x40fed0(0x1f5)+_0x58dde2+':'+PORT+_0x40fed0(0xc4))),logger['simple'](_0x40fed0(0x1b3));if(config['length']!=0x0)for(const _0x5943a1 of config){if(_0x5943a1[_0x40fed0(0xaf)]==_0x40fed0(0xac)||_0x5943a1[_0x40fed0(0xaf)]==_0x40fed0(0x1e0))await logger['full']('Starting\x20bot\x20|\x20Bot\x20'+_0x5943a1[_0x40fed0(0x1cc)]+_0x40fed0(0xdd)+_0x5943a1[_0x40fed0(0x251)]),startBot([_0x5943a1['botID'],userID],{'cwd':bbpath},function(_0x25c11d){const _0x875312=_0x40fed0;if(_0x25c11d)logger[_0x875312(0x22a)](_0x25c11d);});else(_0x5943a1[_0x40fed0(0xaf)]==_0x40fed0(0x243)||_0x5943a1[_0x40fed0(0xaf)]==_0x40fed0(0x131))&&await logger[_0x40fed0(0x22a)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x5943a1[_0x40fed0(0x1cc)]+'\x20|\x20'+_0x5943a1['botname']);}else!newBot&&logger['simple'](_0x40fed0(0x247));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x40fed0(0x205)](_0x40fed0(0x1c6)+nodeversion),await logger[_0x40fed0(0x205)]('Network\x20Interfaces:',_0x40d327);}function startSocket(){const _0x3911cd=_0xf3309e;io['on'](_0x3911cd(0x157),_0x49cfa3=>{const _0x445deb=_0x3911cd;let _0x1fc25c,_0x3e59d8,_0x2cdbb9,_0x194047,_0x51aea9;const _0x55969a=_0x49cfa3[_0x445deb(0x1f6)][_0x445deb(0x16b)][_0x445deb(0xf6)];_0x3e59d8=_0x55969a['match'](/bot[0-9]{3}/);if(_0x3e59d8)_0x2cdbb9=_0x3e59d8[0x0][_0x445deb(0x17e)](/[0-9]{3}/);if(_0x2cdbb9)_0x1fc25c=_0x2cdbb9[0x0];else _0x1fc25c='botmanager';const _0x52d6e3=_0x49cfa3['handshake']['auth']['encryptedUuid'];if(!_0x52d6e3)_0x49cfa3[_0x445deb(0x246)](_0x445deb(0xaf),{'publicKey':secure[_0x445deb(0x169)]});else{_0x194047=timelyDecrypt(_0x52d6e3,![]);if(!_0x194047)_0x49cfa3[_0x445deb(0x246)]('status',{'publicKey':secure['publicKey']});else{_0x51aea9=normalizeIP(_0x49cfa3[_0x445deb(0x275)]['remoteAddress'])['store'];if(!devices[_0x194047])devices[_0x194047]={'uuid':_0x194047,'access':{'token':null}};devices[_0x194047]['ip']=_0x51aea9;const _0x44deb9=addClient(_0x49cfa3['id'],_0x194047,_0x1fc25c);setAccess(_0x44deb9),emitMessages(),_0x49cfa3['on']('login',_0x39cd33=>{const _0xeb0b0d=_0x445deb,_0xba76=timelyDecrypt(_0x39cd33[_0xeb0b0d(0x113)]);if(_0xba76){_0x39cd33={'username':_0x39cd33['username'],'password':_0xba76},devices[_0x194047][_0xeb0b0d(0x175)]=validateCredentials(_0x39cd33,_0x194047);if(devices[_0x194047][_0xeb0b0d(0x175)][_0xeb0b0d(0x1c2)]==![]&&devices[_0x194047][_0xeb0b0d(0x175)][_0xeb0b0d(0x1d3)]=='2FA\x20login\x20required')_0x49cfa3[_0xeb0b0d(0x246)]('status',{'access':devices[_0x194047][_0xeb0b0d(0x175)]}),loginAccess2FA(_0x194047,_0x51aea9);else{if(devices[_0x194047][_0xeb0b0d(0x175)][_0xeb0b0d(0x1c2)]==![]&&devices[_0x194047]['access'][_0xeb0b0d(0x1d3)]==_0xeb0b0d(0x217))_0x49cfa3[_0xeb0b0d(0x246)](_0xeb0b0d(0xaf),{'access':devices[_0x194047]['access']});else devices[_0x194047][_0xeb0b0d(0x175)]['allow']&&devices[_0x194047][_0xeb0b0d(0x175)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x194047)[_0xeb0b0d(0xbd)](_0x188691=>{setAccess(_0x188691);}),logger[_0xeb0b0d(0x205)]('Logged\x20in\x20user\x20...'+_0x194047[_0xeb0b0d(0x207)](-0x8)),setTokenRefresh(_0x194047),setSessionTimeout(_0xeb0b0d(0x132),_0x194047));}}else logger[_0xeb0b0d(0x22a)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x49cfa3['on']('reset-password',()=>{resetPassword();}),_0x49cfa3['on'](_0x445deb(0x248),_0x1b3479=>{removeClient(_0x49cfa3['id']);}),_0x1fc25c==_0x445deb(0x153)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3bf363){const _0x2a7bb4=_0xf3309e;if(_0x3bf363!=_0x2a7bb4(0x153)&&config[_0x2a7bb4(0xf8)]!=''){if(pid[_0x3bf363])pid[_0x3bf363][_0x2a7bb4(0x241)]({'function':_0x2a7bb4(0x145),'args':null});}_0x3bf363!='botmanager'&&broadcastToBots('bots',JSON[_0x2a7bb4(0x229)](config));}function reloadBotManager(){const _0xf5d08d=_0xf3309e;getClientsWithBotID('botmanager')[_0xf5d08d(0xbd)](_0x520f01=>{const _0x4d3454=_0xf5d08d;getSocket(_0x520f01['id'])[_0x4d3454(0x246)]('status',{'access':{'allow':![],'reason':_0x4d3454(0x192),'token':null}});});}function getSocket(_0x578ef3){const _0x177791=_0xf3309e;return io[_0x177791(0x1ee)][_0x177791(0x1ee)]['get'](_0x578ef3);}function setAccess(_0x59cb22){const _0x56f397=_0xf3309e,_0x13e132=getSocket(_0x59cb22['id']),_0x59a68c=_0x59cb22[_0x56f397(0x119)],_0x6ad0ab=_0x59cb22[_0x56f397(0x22e)];devices[_0x59a68c]['access']=validateAccess(devices[_0x59a68c]['access'][_0x56f397(0x267)],_0x59a68c),logger[_0x56f397(0x205)](_0x56f397(0x159)+devices[_0x59a68c][_0x56f397(0x175)][_0x56f397(0x1d3)]+'\x20|\x20client:\x20...'+_0x59cb22['id']['slice'](-0x8)+_0x56f397(0x213)+_0x59a68c[_0x56f397(0x207)](-0x8)),_0x13e132[_0x56f397(0x180)](_0x59a68c);if(devices[_0x59a68c]['access']['allow']){_0x13e132[_0x56f397(0x180)](_0x6ad0ab);if(_0x6ad0ab=='botmanager')initializeSocketBotManager(_0x13e132);else initializeSocketBot(_0x13e132);initClient(_0x6ad0ab);}devices[_0x59a68c][_0x56f397(0x175)][_0x56f397(0x267)]&&devices[_0x59a68c][_0x56f397(0x175)]['reason']==_0x56f397(0x1a8)&&setSessionTimeout('2FA',_0x59a68c),devices[_0x59a68c]['access']['token']&&devices[_0x59a68c][_0x56f397(0x175)][_0x56f397(0x1d3)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x56f397(0x132),_0x59a68c),_0x13e132['emit'](_0x56f397(0xaf),{'status':_0x59cb22[_0x56f397(0x16e)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x59a68c]['access'],'externalip':devices[_0x59a68c]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x59a68c][_0x56f397(0x175)]['allow']==![]&&devices[_0x59a68c][_0x56f397(0x175)][_0x56f397(0x1d3)]==_0x56f397(0x215)&&temporaryAccess2FA(_0x59a68c,devices[_0x59a68c]['ip']);}function setSessionTimeout(_0x4ccb8b,_0x2b1a05){const _0x497a93=_0xf3309e;let _0x42dcd9;if(_0x4ccb8b==_0x497a93(0x132))_0x42dcd9=loginExpiry*0x3c*0x3e8;else _0x42dcd9=devices[_0x2b1a05][_0x497a93(0xdf)][_0x497a93(0x24e)]*0x3c*0x3e8-(new Date()[_0x497a93(0x12a)]()-devices[_0x2b1a05][_0x497a93(0xdf)][_0x497a93(0x1f7)]);if(devices[_0x2b1a05][_0x497a93(0x227)])clearTimeout(devices[_0x2b1a05][_0x497a93(0x227)]);devices[_0x2b1a05][_0x497a93(0x227)]=setTimeout(()=>{const _0xb04f94=_0x497a93;if(devices[_0x2b1a05][_0xb04f94(0x12f)])clearTimeout(devices[_0x2b1a05][_0xb04f94(0x12f)]);removeSocketListeners(_0x2b1a05),addBlacklist(_0x2b1a05),devices[_0x2b1a05]['telegramIpApproval']=null,devices[_0x2b1a05][_0xb04f94(0x21a)]=null,devices[_0x2b1a05]['access'][_0xb04f94(0x267)]=null,logger['debug'](_0xb04f94(0x1fd)+_0x2b1a05[_0xb04f94(0x207)](-0x8)),devices[_0x2b1a05][_0xb04f94(0x175)]=validateAccess(devices[_0x2b1a05][_0xb04f94(0x175)]['token'],_0x2b1a05),!(devices[_0x2b1a05]['access'][_0xb04f94(0x1c2)]&&devices[_0x2b1a05][_0xb04f94(0x175)]['reason']=='login\x20not\x20required')&&(_0x4ccb8b==_0xb04f94(0x132)?io['to'](_0x2b1a05)[_0xb04f94(0x246)](_0xb04f94(0xaf),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x2b1a05)['emit'](_0xb04f94(0xaf),{'access':{'allow':![],'reason':_0xb04f94(0x25d),'token':null}})),devices[_0x2b1a05][_0xb04f94(0x175)][_0xb04f94(0x267)]=null;},_0x42dcd9);}function setTokenRefresh(_0x980f32){const _0x4c360c=_0xf3309e;if(devices[_0x980f32][_0x4c360c(0x12f)])clearTimeout(devices[_0x980f32][_0x4c360c(0x12f)]);devices[_0x980f32][_0x4c360c(0x12f)]=setTimeout(()=>{const _0x38e17c=_0x4c360c;getClientsWithUuid(_0x980f32)[_0x38e17c(0x1d4)]!=0x0?(devices[_0x980f32][_0x38e17c(0x175)]=refreshToken(_0x980f32),io['to'](_0x980f32)[_0x38e17c(0x246)](_0x38e17c(0xaf),{'status':_0x38e17c(0x23e),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x980f32][_0x38e17c(0x175)],'externalip':devices[_0x980f32]['ip'],'publicKey':secure[_0x38e17c(0x169)],'validInstallation':validInstallation}),setTokenRefresh(_0x980f32)):clearTimeout(devices[_0x980f32][_0x38e17c(0x12f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2873cb){const _0xbf3953=_0xf3309e,_0x3d88cc=getClient(_0x2873cb['id'])[_0xbf3953(0x119)];_0x2873cb[_0xbf3953(0x246)]('bots',config),_0x2873cb['emit'](_0xbf3953(0x128),cleanSettings()),_0x2873cb['on'](_0xbf3953(0x1ae),_0x5bb588=>{const _0x4114f8=_0xbf3953;if(validateAccess(_0x5bb588,_0x3d88cc)[_0x4114f8(0x1c2)])addBot();else logger['full'](_0x4114f8(0x199));}),_0x2873cb['on'](_0xbf3953(0x219),(_0x225315,_0x5a2e53)=>{const _0x1ebc1e=_0xbf3953;if(validateAccess(_0x5a2e53,_0x3d88cc)[_0x1ebc1e(0x1c2)])toggleBot(_0x225315[_0x1ebc1e(0x1cc)],_0x225315[_0x1ebc1e(0xaf)],_0x225315[_0x1ebc1e(0x124)]);else logger['full'](_0x1ebc1e(0x1c9));}),_0x2873cb['on']('toggle-bot-mode',(_0x3bf37d,_0x35c522)=>{const _0x47e043=_0xbf3953;if(validateAccess(_0x35c522,_0x3d88cc)[_0x47e043(0x1c2)])toggleBotMode(_0x3bf37d);else logger['full'](_0x47e043(0x1c9));}),_0x2873cb['on']('delete-bot',(_0x48d9a7,_0x3ce512)=>{const _0x4747f5=_0xbf3953;if(validateAccess(_0x3ce512,_0x3d88cc)[_0x4747f5(0x1c2)])deleteBot(_0x48d9a7);else logger[_0x4747f5(0x22a)](_0x4747f5(0xd2));}),_0x2873cb['on'](_0xbf3953(0xa8),(_0x317d4a,_0x7ab9a8)=>{const _0x44fcda=_0xbf3953;if(validateAccess(_0x7ab9a8,_0x3d88cc)['allow'])storeSettings(_0x317d4a,!![]);else logger[_0x44fcda(0x22a)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2873cb['on'](_0xbf3953(0x24a),_0x15322c=>{const _0x2a20fa=_0xbf3953;if(validateAccess(_0x15322c,_0x3d88cc)[_0x2a20fa(0x1c2)])updateBB(_0x2a20fa(0x17a));else logger[_0x2a20fa(0x22a)](_0x2a20fa(0x1aa));}),_0x2873cb['on'](_0xbf3953(0x164),_0x54314e=>{const _0x51e0f7=_0xbf3953;if(validateAccess(_0x54314e,_0x3d88cc)['allow'])updateBB(_0x51e0f7(0x1de));else logger[_0x51e0f7(0x22a)](_0x51e0f7(0x15f));}),_0x2873cb['on'](_0xbf3953(0xb0),_0x4abfff=>{const _0x592e84=_0xbf3953;if(validateAccess(_0x4abfff,_0x3d88cc)[_0x592e84(0x1c2)]){const _0x5c4cbc=getClient(_0x2873cb['id']);if(_0x5c4cbc)getBackupFiles(_0x5c4cbc[_0x592e84(0x119)]);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x592e84(0x22a)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x2873cb['on'](_0xbf3953(0x125),(_0x5920d0,_0x178a16)=>{const _0x41dba8=_0xbf3953;if(validateAccess(_0x178a16,_0x3d88cc)[_0x41dba8(0x1c2)])restoreBackupFile(_0x5920d0);else logger[_0x41dba8(0x22a)](_0x41dba8(0xeb));}),_0x2873cb['on']('get-messages',_0x1cc114=>{const _0x26f507=_0xbf3953;if(validateAccess(_0x1cc114,_0x3d88cc)[_0x26f507(0x1c2)])getMessages();else logger['full'](_0x26f507(0x249));}),_0x2873cb['on'](_0xbf3953(0xa7),(_0x4df2ae,_0x146514)=>{const _0x18154b=_0xbf3953;if(validateAccess(_0x146514,_0x3d88cc)[_0x18154b(0x1c2)])confirmMessage(_0x4df2ae);else logger[_0x18154b(0x22a)](_0x18154b(0x1f3));}),_0x2873cb['on'](_0xbf3953(0x115),_0xec8485=>{const _0xb5727c=_0xbf3953;if(validateAccess(_0xec8485,_0x3d88cc)[_0xb5727c(0x1c2)]){if(devices[_0x3d88cc][_0xb5727c(0x12f)])clearTimeout(devices[_0x3d88cc][_0xb5727c(0x12f)]);if(devices[_0x3d88cc][_0xb5727c(0x227)])clearTimeout(devices[_0x3d88cc][_0xb5727c(0x227)]);removeSocketListeners(getClient(_0x2873cb['id'])[_0xb5727c(0x119)]),addBlacklist(_0x3d88cc),devices[_0x3d88cc][_0xb5727c(0xdf)]=null,devices[_0x3d88cc]['telegram2FaApproval']=null,devices[_0x3d88cc][_0xb5727c(0x175)]['token']=null,logger[_0xb5727c(0x205)](_0xb5727c(0x14e)+_0x3d88cc[_0xb5727c(0x207)](-0x8)),io['to'](getClient(_0x2873cb['id'])[_0xb5727c(0x119)])[_0xb5727c(0x246)](_0xb5727c(0xaf),{'access':{'allow':![],'reason':_0xb5727c(0x17f),'token':null}});}else logger[_0xb5727c(0x22a)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x3f762e){const _0x15be37=_0xf3309e,_0x4022ea=getClient(_0x3f762e['id'])['bot'],_0x385206=getClient(_0x3f762e['id'])[_0x15be37(0x119)];_0x3f762e['on'](_0x15be37(0x14f),(_0x2a278c,_0x423e74)=>{const _0x2b253f=_0x15be37;if(validateAccess(_0x423e74,_0x385206)[_0x2b253f(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x2b253f(0x241)]({'function':_0x2b253f(0xef),'args':_0x2a278c});}else logger[_0x2b253f(0x22a)](_0x2b253f(0x1ab));}),_0x3f762e['on'](_0x15be37(0x250),(_0x355e25,_0x4f4925)=>{const _0x2c8f87=_0x15be37;if(validateAccess(_0x4f4925,_0x385206)[_0x2c8f87(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x2c8f87(0x241)]({'function':_0x2c8f87(0x253),'args':_0x355e25});}else logger[_0x2c8f87(0x22a)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x3f762e['on']('get-portfolio',(_0x41fc7f,_0x4546f2)=>{const _0x13a85d=_0x15be37;if(validateAccess(_0x4546f2,_0x385206)[_0x13a85d(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x13a85d(0x241)]({'function':_0x13a85d(0xca),'args':_0x41fc7f});}else logger[_0x13a85d(0x22a)](_0x13a85d(0x1a7));}),_0x3f762e['on']('store-configuration',(_0x20e472,_0x2e7733)=>{const _0x485c19=_0x15be37;if(validateAccess(_0x2e7733,_0x385206)[_0x485c19(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x485c19(0x241)]({'function':_0x485c19(0x25c),'args':_0x20e472});}else logger['full'](_0x485c19(0x11a));}),_0x3f762e['on'](_0x15be37(0xbb),(_0x20d82d,_0x2e05bb)=>{const _0x4053ef=_0x15be37;if(validateAccess(_0x2e05bb,_0x385206)[_0x4053ef(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x4053ef(0x241)]({'function':'storeHeadless','args':_0x20d82d});}else logger[_0x4053ef(0x22a)](_0x4053ef(0x14d));}),_0x3f762e['on']('store-fiat',(_0x3226c7,_0x43d0c7)=>{const _0xd41415=_0x15be37;if(validateAccess(_0x43d0c7,_0x385206)['allow']){if(pid[_0x4022ea])pid[_0x4022ea]['send']({'function':'storeFiat','args':_0x3226c7});}else logger[_0xd41415(0x22a)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x3f762e['on']('reset-history',_0xe30bdd=>{const _0x2f8689=_0x15be37;if(validateAccess(_0xe30bdd,_0x385206)['allow']){if(pid[_0x4022ea])pid[_0x4022ea][_0x2f8689(0x241)]({'function':'resetHistory','args':null});}else logger[_0x2f8689(0x22a)](_0x2f8689(0x24f));}),_0x3f762e['on']('get-starting-balances',_0x4d96a9=>{const _0x12b2a3=_0x15be37;if(validateAccess(_0x4d96a9,_0x385206)[_0x12b2a3(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x12b2a3(0x241)]({'function':_0x12b2a3(0x1af),'args':null});}else logger[_0x12b2a3(0x22a)](_0x12b2a3(0xfe));}),_0x3f762e['on'](_0x15be37(0xf2),(_0x385fce,_0x417618)=>{const _0x5aa25b=_0x15be37;if(validateAccess(_0x417618,_0x385206)[_0x5aa25b(0x1c2)]){if(pid[_0x4022ea])pid[_0x4022ea][_0x5aa25b(0x241)]({'function':_0x5aa25b(0x1be),'args':_0x385fce});}else logger[_0x5aa25b(0x22a)](_0x5aa25b(0x26a));}),_0x3f762e['on'](_0x15be37(0x18c),_0x35a621=>{const _0x3ecd17=_0x15be37;if(validateAccess(_0x35a621,_0x385206)['allow']){if(pid[_0x4022ea])pid[_0x4022ea][_0x3ecd17(0x241)]({'function':'cancelLoading','args':null});}else logger['full'](_0x3ecd17(0x222));}),_0x3f762e['on'](_0x15be37(0xcc),_0x46ee66=>{const _0x26b72e=_0x15be37;if(validateAccess(_0x46ee66,_0x385206)['allow']){if(pid[_0x4022ea])pid[_0x4022ea][_0x26b72e(0x241)]({'function':_0x26b72e(0x264),'args':null});}else logger['full'](_0x26b72e(0x1cb));}),_0x3f762e['on'](_0x15be37(0x24a),_0x5b0fc9=>{const _0x4f32f9=_0x15be37;if(validateAccess(_0x5b0fc9,_0x385206)[_0x4f32f9(0x1c2)])updateBB(_0x4f32f9(0x17a));else logger[_0x4f32f9(0x22a)](_0x4f32f9(0x1aa));}),_0x3f762e['on'](_0x15be37(0xcb),_0x3ac9cb=>{const _0x10e305=_0x15be37;if(validateAccess(_0x3ac9cb,_0x385206)['allow'])getMessages();else logger[_0x10e305(0x22a)](_0x10e305(0x249));}),_0x3f762e['on'](_0x15be37(0xa7),(_0x5d5682,_0x360f5f)=>{const _0x1a919a=_0x15be37;if(validateAccess(_0x360f5f,_0x385206)[_0x1a919a(0x1c2)])confirmMessage(_0x5d5682);else logger[_0x1a919a(0x22a)](_0x1a919a(0x1f3));}),_0x3f762e['on'](_0x15be37(0x115),_0x1a526e=>{const _0x45115a=_0x15be37;if(validateAccess(_0x1a526e,_0x385206)[_0x45115a(0x1c2)]){if(devices[_0x385206]['pidRefreshToken'])clearTimeout(devices[_0x385206][_0x45115a(0x12f)]);if(devices[_0x385206]['pidExpireLogin'])clearTimeout(devices[_0x385206][_0x45115a(0x227)]);removeSocketListeners(getClient(_0x3f762e['id'])[_0x45115a(0x119)]),addBlacklist(_0x385206),devices[_0x385206][_0x45115a(0xdf)]=null,devices[_0x385206][_0x45115a(0x21a)]=null,devices[_0x385206]['access'][_0x45115a(0x267)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x385206[_0x45115a(0x207)](-0x8)),io['to'](getClient(_0x3f762e['id'])[_0x45115a(0x119)])[_0x45115a(0x246)](_0x45115a(0xaf),{'access':{'allow':![],'reason':_0x45115a(0x17f),'token':null}});}else logger[_0x45115a(0x22a)](_0x45115a(0x18e));});}function removeSocketListeners(_0x93a5f1){const _0x204ec8=_0xf3309e;getClientsWithUuid(_0x93a5f1)[_0x204ec8(0xbd)](_0x277160=>{const _0x35a825=_0x204ec8;getSocket(_0x277160['id'])[_0x35a825(0x214)]();});}function cleanSettings(){const _0x462ad6=_0xf3309e;let _0x5ccea5=settings;return settings[_0x462ad6(0x196)]&&settings[_0x462ad6(0x196)]!=''&&(_0x5ccea5={..._0x5ccea5,'telegramToken':_0x462ad6(0x1ef)}),settings['bbPassword']&&settings[_0x462ad6(0x118)]!=''&&(_0x5ccea5={..._0x5ccea5,'bbPassword':_0x462ad6(0x1ef)}),(settings[_0x462ad6(0x118)]&&settings['bbPassword']==_0x462ad6(0x110)||settings[_0x462ad6(0x196)]&&settings['telegramToken']==_0x462ad6(0x110))&&(_0x5ccea5={..._0x5ccea5,'restored':{'password':settings['bbPassword']==_0x462ad6(0x110),'telegram':settings[_0x462ad6(0x196)]==_0x462ad6(0x110)}}),_0x5ccea5;}async function updateBB(_0x16b7cf){const _0x265793=_0xf3309e;await backupConfigFiles(),installingUpdate=!![],config[_0x265793(0xbd)](_0x11af35=>{const _0x7f94ec=_0x265793;restartBot(_0x11af35[_0x7f94ec(0x1cc)]);}),logger[_0x265793(0x205)](_0x265793(0xc0)+_0x16b7cf);if(_0x16b7cf==_0x265793(0x17a))process[_0x265793(0x241)]({'update':!![]},_0x4bef29=>{});else _0x16b7cf==_0x265793(0x1de)&&process[_0x265793(0x241)]({'reinstall':!![]},_0x2be553=>{});}function startBot(_0x41c3aa,_0x4520ef,_0x2239ca){const _0x3630e1=_0xf3309e;if(debugging)_0x41c3aa['push']('-d');let _0x27c48a=![];const _0x51f460=_0x41c3aa[0x0];_0x4520ef={..._0x4520ef,'stdio':[_0x3630e1(0xd6),_0x3630e1(0xd6),_0x3630e1(0xd6),_0x3630e1(0xcd)]},pid[_0x51f460]=childProcess['fork'](botfile,_0x41c3aa,_0x4520ef),pid[_0x51f460]['on'](_0x3630e1(0x19a),_0x4f9fb4=>{const _0x271c1b=_0x3630e1;switch(Object['keys'](_0x4f9fb4)[0x0]){case _0x271c1b(0x251):updateBotName(_0x51f460,_0x4f9fb4[_0x271c1b(0x251)]);break;case _0x271c1b(0x135):updateBotManager();break;case _0x271c1b(0xaf):updateStatus(_0x51f460,_0x4f9fb4[_0x271c1b(0xaf)]);break;case _0x271c1b(0x124):updateLive(_0x51f460,_0x4f9fb4[_0x271c1b(0x124)]);break;case _0x271c1b(0x235):updateLive(_0x51f460,_0x4f9fb4['started']),io['to'](_0x51f460)[_0x271c1b(0x246)](_0x271c1b(0xaf),{'access':{'allow':![],'reason':_0x271c1b(0x192),'token':null}});break;case _0x271c1b(0x1d5):_0x4f9fb4['stop']==_0x271c1b(0x263)&&restartBot(_0x51f460);_0x4f9fb4[_0x271c1b(0x1d5)]=='kill'&&toggleBot(_0x51f460,_0x271c1b(0x243),'stopped');break;case _0x271c1b(0x226):sendTelegram(_0x51f460,_0x4f9fb4[_0x271c1b(0x226)]);break;case _0x271c1b(0x231):sendTelegramMsg(_0x4f9fb4[_0x271c1b(0x231)]);break;case _0x271c1b(0x224):io['to'](_0x51f460)['emit'](_0x4f9fb4[_0x271c1b(0x224)],_0x4f9fb4['args']);break;}}),pid[_0x51f460]['on'](_0x3630e1(0x108),function(_0x30d991){if(_0x27c48a)return;_0x27c48a=!![],_0x2239ca(_0x30d991);}),pid[_0x51f460]['on']('exit',async function(_0x2e08f1){const _0x5e2b82=_0x3630e1;if(installingUpdate)return;if(_0x27c48a)return;_0x27c48a=!![],_0x2239ca(null);const _0x209dd4=dbConfig[_0x5e2b82(0xec)](_0x5e2b82(0x1d9))[_0x5e2b82(0x165)]({'botID':_0x51f460})[_0x5e2b82(0x138)]();_0x209dd4&&(_0x209dd4[_0x5e2b82(0xaf)]==_0x5e2b82(0xac)||_0x209dd4[_0x5e2b82(0xaf)]==_0x5e2b82(0x1e0))&&(await sleep(0x3e8),updateLive(_0x51f460,_0x5e2b82(0x22f)),logger[_0x5e2b82(0x22a)](_0x5e2b82(0x242)+_0x51f460),startBot([_0x51f460,userID],{'cwd':bbpath},function(_0x10fc07){const _0xa977d4=_0x5e2b82;if(_0x10fc07)logger[_0xa977d4(0x22a)](_0x10fc07);}));});}function stopBot(_0x3ce697){const _0x5d0bb3=_0xf3309e;getClientsWithBotID(_0x3ce697)[_0x5d0bb3(0xbd)](_0x242848=>{const _0x194a8c=_0x5d0bb3;getSocket(_0x242848['id'])[_0x194a8c(0x248)](!![]),removeClient(_0x242848['id']);}),pid[_0x3ce697]&&(pid[_0x3ce697]['kill'](),pid[_0x3ce697]=null);}function restartBot(_0x310d94){const _0x293e27=_0xf3309e;if(pid[_0x310d94])pid[_0x310d94][_0x293e27(0x1c1)]();}function addBot(){const _0xc550ff=_0xf3309e;let _0x5aa4c9;for(let _0x2f8667=0x1;_0x2f8667<0x3e9;_0x2f8667++){_0x5aa4c9=_0x2f8667[_0xc550ff(0xe1)]()[_0xc550ff(0x1d6)](0x3,'0');let _0x2ad1c1=config['find'](_0x227693=>_0x227693[_0xc550ff(0x1cc)]==_0x5aa4c9);if(!_0x2ad1c1)break;}if(_0x5aa4c9===_0xc550ff(0x129)){logger['full'](_0xc550ff(0xb8));return;}logger[_0xc550ff(0x22a)](_0xc550ff(0x161)+_0x5aa4c9),dbConfig[_0xc550ff(0xec)](_0xc550ff(0x1d9))[_0xc550ff(0x20c)]({'botID':_0x5aa4c9,'botname':_0xc550ff(0x257)+_0x5aa4c9,'status':_0xc550ff(0x1e0),'live':''})[_0xc550ff(0x1a1)](),startBot([_0x5aa4c9,userID],{'cwd':bbpath},function(_0x5dc649){const _0x5e8927=_0xc550ff;if(_0x5dc649)logger[_0x5e8927(0x22a)](_0x5dc649);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0xc550ff(0x1d9),config),broadcastToBots('bots',JSON[_0xc550ff(0x229)](config));}function deleteBot(_0x412fd8){const _0x570b7f=_0xf3309e;getClientsWithBotID(_0x412fd8)[_0x570b7f(0xbd)](_0x994106=>{const _0xd281a3=_0x570b7f;getSocket(_0x994106['id'])[_0xd281a3(0x248)](!![]),removeClient(_0x994106['id']);}),dbConfig[_0x570b7f(0xec)](_0x570b7f(0x1d9))[_0x570b7f(0x1c8)]({'botID':_0x412fd8})['write'](),logger[_0x570b7f(0x22a)]('Deleted\x20Bot\x20'+_0x412fd8),stopBot(_0x412fd8);try{if(fs[_0x570b7f(0x127)](path[_0x570b7f(0x180)](configpath,_0x570b7f(0x18a)+_0x412fd8+'-config.json')))fs[_0x570b7f(0x117)](path[_0x570b7f(0x180)](configpath,_0x570b7f(0x18a)+_0x412fd8+_0x570b7f(0xc9)));if(fs[_0x570b7f(0x127)](path[_0x570b7f(0x180)](configpath,_0x570b7f(0x18a)+_0x412fd8+_0x570b7f(0x134))))fs['unlinkSync'](path['join'](configpath,_0x570b7f(0x18a)+_0x412fd8+_0x570b7f(0x134)));if(fs['existsSync'](path[_0x570b7f(0x180)](configpath,'bot-'+_0x412fd8+_0x570b7f(0x13c))))fs[_0x570b7f(0x117)](path[_0x570b7f(0x180)](configpath,_0x570b7f(0x18a)+_0x412fd8+_0x570b7f(0x13c)));if(fs['existsSync'](path['join'](configpath,'bot-'+_0x412fd8+_0x570b7f(0x220))))fs['unlinkSync'](path[_0x570b7f(0x180)](configpath,_0x570b7f(0x18a)+_0x412fd8+_0x570b7f(0x220)));}catch(_0x1d75ee){if(_0x1d75ee)logger[_0x570b7f(0x22a)](_0x570b7f(0x10a),_0x1d75ee);}config=getConfiguration(),io['to'](_0x570b7f(0x153))['emit'](_0x570b7f(0x1d9),config),broadcastToBots(_0x570b7f(0x1d9),JSON[_0x570b7f(0x229)](config));}function toggleBot(_0x249320,_0x43dbad,_0x232353){const _0x3deae1=_0xf3309e;dbConfig[_0x3deae1(0xec)](_0x3deae1(0x1d9))[_0x3deae1(0x165)]({'botID':_0x249320})['assign']({'status':_0x43dbad})[_0x3deae1(0x201)]({'live':_0x232353})[_0x3deae1(0x1a1)]();if(_0x43dbad==_0x3deae1(0xac)||_0x43dbad=='new')logger['full'](_0x3deae1(0x21f)+_0x249320),startBot([_0x249320,userID],{'cwd':bbpath},function(_0x18ecdc){const _0xe09f71=_0x3deae1;if(_0x18ecdc)logger[_0xe09f71(0x22a)](_0x18ecdc);});else(_0x43dbad==_0x3deae1(0x243)||_0x43dbad==_0x3deae1(0x131))&&(logger[_0x3deae1(0x22a)](_0x3deae1(0x1a3)+_0x249320),stopBot(_0x249320));config=getConfiguration(),io['to'](_0x3deae1(0x153))['emit'](_0x3deae1(0x1d9),config),broadcastToBots(_0x3deae1(0x1d9),JSON[_0x3deae1(0x229)](config));}function toggleStatus(_0x3c4f3f){const _0x10f77d=_0xf3309e;let _0x17a51a=dbConfig[_0x10f77d(0xec)](_0x10f77d(0x1d9))['find']({'botID':_0x3c4f3f})[_0x10f77d(0x138)](),_0x1582c8;if(_0x17a51a[_0x10f77d(0xaf)]==='enabled')_0x1582c8=_0x10f77d(0x243);else{if(_0x17a51a['status']===_0x10f77d(0x1e0))_0x1582c8=_0x10f77d(0x131);else{if(_0x17a51a['status']===_0x10f77d(0x131))_0x1582c8=_0x10f77d(0x1e0);else{if(_0x17a51a['status']===_0x10f77d(0x243))_0x1582c8=_0x10f77d(0xac);}}}return _0x1582c8;}function updateStatus(_0x3e87ca,_0x159374){const _0x26e084=_0xf3309e;dbConfig[_0x26e084(0xec)](_0x26e084(0x1d9))['find']({'botID':_0x3e87ca})[_0x26e084(0x201)]({'status':_0x159374})[_0x26e084(0x1a1)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x26e084(0x1d9),config),broadcastToBots(_0x26e084(0x1d9),JSON[_0x26e084(0x229)](config));}function updateLive(_0xf0fd8c,_0x2b2f9d){const _0x118225=_0xf3309e;dbConfig[_0x118225(0xec)](_0x118225(0x1d9))[_0x118225(0x165)]({'botID':_0xf0fd8c})[_0x118225(0x201)]({'live':_0x2b2f9d})['write'](),config=getConfiguration(),io['to'](_0x118225(0x153))[_0x118225(0x246)](_0x118225(0x1d9),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x324e38,_0x534c66){const _0x2120c0=_0xf3309e;dbConfig['get'](_0x2120c0(0x1d9))['find']({'botID':_0x324e38})[_0x2120c0(0x201)]({'botname':_0x534c66})[_0x2120c0(0x1a1)](),config=getConfiguration(),io['to'](_0x2120c0(0x153))[_0x2120c0(0x246)](_0x2120c0(0x1d9),config),broadcastToBots('bots',JSON[_0x2120c0(0x229)](config));}function updateBotManager(){const _0x581804=_0xf3309e;config=getConfiguration(),io['to'](_0x581804(0x153))[_0x581804(0x246)](_0x581804(0x1d9),config),broadcastToBots(_0x581804(0x1d9),JSON[_0x581804(0x229)](config));}function toggleBotMode(_0x23a40e){const _0x55d9cd=_0xf3309e;if(pid[_0x23a40e])pid[_0x23a40e][_0x55d9cd(0x241)]({'function':_0x55d9cd(0x19d),'args':null});else{const _0x477501=configpath+_0x55d9cd(0x18a)+_0x23a40e+'-config.json',_0x27521c=fs[_0x55d9cd(0x1e3)](_0x477501),_0x147960=JSON[_0x55d9cd(0x1c7)](_0x27521c),_0x22ff85=_0x147960['bot'][0x0][_0x55d9cd(0x121)];_0x147960[_0x55d9cd(0x22e)][0x0]['headless']=!_0x22ff85;const _0x1cc7ac=JSON[_0x55d9cd(0x229)](_0x147960,null,0x2);fs[_0x55d9cd(0xbc)](_0x477501,_0x1cc7ac),config=getConfiguration(),io['to'](_0x55d9cd(0x153))['emit'](_0x55d9cd(0x1d9),config),broadcastToBots(_0x55d9cd(0x1d9),JSON['stringify'](config));}}function telegramError(_0x117454){const _0x467f02=_0xf3309e;logger[_0x467f02(0x168)](getTimeStamp()+_0x467f02(0x114));}function validateTelegram(_0x56c808){const _0x338ce4=_0xf3309e;if(_0x56c808[_0x338ce4(0x193)][_0x338ce4(0x266)]!=settings[_0x338ce4(0xb9)]&&'@'+_0x56c808[_0x338ce4(0x193)][_0x338ce4(0x266)]!=settings[_0x338ce4(0xb9)])return tgBot['sendMessage'](_0x56c808[_0x338ce4(0x272)]['id'],_0x338ce4(0x1c0),{'parse_mode':_0x338ce4(0x221)})[_0x338ce4(0x12b)](_0x31b99a=>{telegramError(_0x31b99a);}),![];return!![];}async function initTelegram(){const _0x59de30=_0xf3309e;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x59de30(0x196)],{'polling':!![]});let _0x44b68f=_0x59de30(0x206);_0x44b68f+='\x0a',_0x44b68f+='/enable\x20-\x20enable\x20notifications\x0a',_0x44b68f+=_0x59de30(0x155),_0x44b68f+=_0x59de30(0x27b),_0x44b68f+=_0x59de30(0x1bd),_0x44b68f+=_0x59de30(0x239),_0x44b68f+='/off\x20-\x20stop\x20bot(s)\x0a',_0x44b68f+=_0x59de30(0x174),_0x44b68f+=_0x59de30(0xf0),_0x44b68f+=_0x59de30(0x150),_0x44b68f+=_0x59de30(0x238),_0x44b68f+=_0x59de30(0x101),_0x44b68f+=_0x59de30(0x16d),_0x44b68f+=_0x59de30(0x260),_0x44b68f+=_0x59de30(0x147);let _0x2888f5=_0x59de30(0x1ba);_0x2888f5+='\x0a',_0x2888f5+=_0x44b68f,tgBot[_0x59de30(0x194)](/\/start/,_0x77ddfa=>{const _0x52b64d=_0x59de30;if(!validateTelegram(_0x77ddfa))return;if(settings[_0x52b64d(0x21b)]!=_0x77ddfa[_0x52b64d(0x272)]['id'])updateSetting(_0x52b64d(0x21b),_0x77ddfa[_0x52b64d(0x272)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x52b64d(0x270)](_0x77ddfa[_0x52b64d(0x272)]['id'],_0x2888f5)[_0x52b64d(0x12b)](_0x4eb9ab=>{telegramError(_0x4eb9ab);});}),tgBot[_0x59de30(0x194)](/\/enable/,_0x57022e=>{const _0x1a0124=_0x59de30;if(!validateTelegram(_0x57022e))return;if(settings[_0x1a0124(0x21b)]!=_0x57022e[_0x1a0124(0x272)]['id'])updateSetting('telegramChatId',_0x57022e[_0x1a0124(0x272)]['id']);updateSetting(_0x1a0124(0x17c),!![]),tgBot[_0x1a0124(0x270)](_0x57022e[_0x1a0124(0x272)]['id'],_0x1a0124(0x262))['catch'](_0x10e73e=>{telegramError(_0x10e73e);});}),tgBot['onText'](/\/config/,async _0x4e2a93=>{const _0x2d41c7=_0x59de30;if(!validateTelegram(_0x4e2a93))return;tgBot[_0x2d41c7(0x179)]('callback_query'),tgBot[_0x2d41c7(0x270)](_0x4e2a93['chat']['id'],_0x2d41c7(0x1b7),{'reply_markup':{'inline_keyboard':[[{'text':_0x2d41c7(0xbe),'callback_data':'orders'},{'text':_0x2d41c7(0x1ce),'callback_data':_0x2d41c7(0x259)},{'text':'All','callback_data':'all'}]]}})[_0x2d41c7(0x12b)](_0x443012=>{telegramError(_0x443012);}),tgBot['on'](_0x2d41c7(0x268),async _0x5bb0fa=>{const _0x5beca3=_0x2d41c7,_0x5bff7a=_0x5bb0fa['data'],_0x323d16=_0x5bb0fa[_0x5beca3(0x19a)];tgBot['answerCallbackQuery'](_0x5bb0fa['id'])[_0x5beca3(0x130)](async()=>{const _0x5f5672=_0x5beca3;_0x5bff7a=='orders'&&(updateSetting(_0x5f5672(0x12d),_0x5f5672(0xf4)),updateSetting(_0x5f5672(0x17c),!![]),await tgBot[_0x5f5672(0x270)](_0x323d16['chat']['id'],_0x5f5672(0xe8))[_0x5f5672(0x12b)](_0x477a8d=>{telegramError(_0x477a8d);}));_0x5bff7a==_0x5f5672(0x259)&&(updateSetting(_0x5f5672(0x12d),_0x5f5672(0x259)),updateSetting(_0x5f5672(0x17c),!![]),await tgBot[_0x5f5672(0x270)](_0x323d16['chat']['id'],_0x5f5672(0x20f))[_0x5f5672(0x12b)](_0x4467a0=>{telegramError(_0x4467a0);}));_0x5bff7a==_0x5f5672(0x160)&&(updateSetting(_0x5f5672(0x12d),_0x5f5672(0x160)),updateSetting(_0x5f5672(0x17c),!![]),await tgBot[_0x5f5672(0x270)](_0x323d16['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x50c65c=>{telegramError(_0x50c65c);}));if(!settings[_0x5f5672(0x21b)])tgBot[_0x5f5672(0x270)](_0x323d16[_0x5f5672(0x272)]['id'],_0x5f5672(0x20a))[_0x5f5672(0x12b)](_0x1e7a94=>{telegramError(_0x1e7a94);});}),tgBot[_0x5beca3(0x179)](_0x5beca3(0x268));});}),tgBot[_0x59de30(0x194)](/\/status/,_0x24ff94=>{const _0x5200cc=_0x59de30;if(!validateTelegram(_0x24ff94))return;const _0x2494ee=getBotsWithMode();let _0x26ed80='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x3ccc28=>{const _0x85e0b8=_0x5c3e,_0x54d680=_0x2494ee['find'](_0x3d4959=>_0x3d4959[_0x85e0b8(0x1cc)]==_0x3ccc28[_0x85e0b8(0x1cc)])[_0x85e0b8(0x177)];_0x26ed80+=_0x85e0b8(0x257)+_0x3ccc28[_0x85e0b8(0x1cc)]+':\x20'+_0x3ccc28['status']+_0x85e0b8(0xdd)+_0x54d680+_0x85e0b8(0xdd)+_0x3ccc28[_0x85e0b8(0x124)]+'\x0a';}),_0x26ed80+='\x0a',_0x26ed80+=_0x5200cc(0x1c5),_0x26ed80+=!settings[_0x5200cc(0x17c)]?_0x5200cc(0x197):_0x5200cc(0x156),_0x26ed80+=settings[_0x5200cc(0x17c)]?settings['telegramEvents']==_0x5200cc(0x160)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x5200cc(0x25a)+settings[_0x5200cc(0x12d)]+'\x20only\x0a':'',tgBot[_0x5200cc(0x270)](_0x24ff94[_0x5200cc(0x272)]['id'],_0x26ed80,{'parse_mode':_0x5200cc(0x221)})['catch'](_0x1d44ed=>{telegramError(_0x1d44ed);});}),tgBot['onText'](/\/restart/,_0x3b469c=>{const _0x268409=_0x59de30;if(!validateTelegram(_0x3b469c))return;tgBot[_0x268409(0x179)](_0x268409(0x268));const _0x42cc7d=getEnabledBots();if(_0x42cc7d[_0x268409(0x1d4)]==0x0)tgBot['sendMessage'](_0x3b469c['chat']['id'],_0x268409(0xe0))[_0x268409(0x12b)](_0x399a1d=>{telegramError(_0x399a1d);});else{if(_0x42cc7d[_0x268409(0x1d4)]>0x1)_0x42cc7d[_0x268409(0x20c)]({'botID':_0x268409(0x160)});let _0x3dfb81=[],_0x41e5f2=[];const _0x28862d=_0x42cc7d[_0x268409(0x1d4)]%0x4==0x0||_0x42cc7d[_0x268409(0x1d4)]%0x4==0x3||_0x42cc7d[_0x268409(0x1d4)]%0x3==0x1?0x4:0x3;let _0x1ab34e=0x0;_0x42cc7d[_0x268409(0xbd)]((_0x2f3c6b,_0x3f1830)=>{const _0x3aee33=_0x268409;if(_0x3f1830%_0x28862d==0x0)_0x41e5f2=[];_0x41e5f2['push']({'text':_0x2f3c6b[_0x3aee33(0x1cc)]==_0x3aee33(0x160)?_0x3aee33(0x1fa):_0x3aee33(0x257)+_0x2f3c6b['botID'],'callback_data':_0x2f3c6b['botID']}),_0x3f1830%_0x28862d==0x0&&(_0x3dfb81[_0x1ab34e]=_0x41e5f2,_0x1ab34e++);}),tgBot[_0x268409(0x270)](_0x3b469c[_0x268409(0x272)]['id'],_0x268409(0x1fc),{'reply_markup':{'inline_keyboard':_0x3dfb81}})[_0x268409(0x12b)](_0x513616=>{telegramError(_0x513616);}),tgBot['on']('callback_query',async _0x299492=>{const _0x299562=_0x268409,_0x5205dc=_0x299492['data'],_0x2341de=_0x299492[_0x299562(0x19a)];tgBot[_0x299562(0x1a4)](_0x299492['id'])[_0x299562(0x130)](async()=>{const _0x741949=_0x299562;_0x5205dc==_0x741949(0x160)?config[_0x741949(0xbd)](_0x456f45=>{const _0xe1e3ff=_0x741949;restartBot(_0x456f45[_0xe1e3ff(0x1cc)]);}):restartBot(_0x5205dc);}),tgBot[_0x299562(0x179)]('callback_query');});}}),tgBot[_0x59de30(0x194)](/\/on/,_0x20fd64=>{const _0x4cac62=_0x59de30;if(!validateTelegram(_0x20fd64))return;tgBot[_0x4cac62(0x179)]('callback_query');const _0x1c612d=getDisabledBots();if(_0x1c612d[_0x4cac62(0x1d4)]==0x0)tgBot[_0x4cac62(0x270)](_0x20fd64[_0x4cac62(0x272)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x4cac62(0x12b)](_0x422619=>{telegramError(_0x422619);});else{if(_0x1c612d[_0x4cac62(0x1d4)]>0x1)_0x1c612d[_0x4cac62(0x20c)]({'botID':_0x4cac62(0x160)});let _0x3ba8b6=[],_0x5b5df1=[];const _0x4a427a=_0x1c612d[_0x4cac62(0x1d4)]%0x4==0x0||_0x1c612d['length']%0x4==0x3||_0x1c612d['length']%0x3==0x1?0x4:0x3;let _0x4787c0=0x0;_0x1c612d[_0x4cac62(0xbd)]((_0x273d44,_0x2b60e7)=>{const _0x391311=_0x4cac62;if(_0x2b60e7%_0x4a427a==0x0)_0x5b5df1=[];_0x5b5df1[_0x391311(0x20c)]({'text':_0x273d44[_0x391311(0x1cc)]=='all'?_0x391311(0x1fa):_0x391311(0x257)+_0x273d44['botID'],'callback_data':_0x273d44[_0x391311(0x1cc)]}),_0x2b60e7%_0x4a427a==0x0&&(_0x3ba8b6[_0x4787c0]=_0x5b5df1,_0x4787c0++);}),tgBot['sendMessage'](_0x20fd64[_0x4cac62(0x272)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x3ba8b6}})['catch'](_0x25717a=>{telegramError(_0x25717a);}),tgBot['on'](_0x4cac62(0x268),async _0x15239c=>{const _0x11cb8f=_0x4cac62,_0x417a7c=_0x15239c[_0x11cb8f(0xbf)],_0x32ba9e=_0x15239c[_0x11cb8f(0x19a)];tgBot[_0x11cb8f(0x1a4)](_0x15239c['id'])['then'](async()=>{const _0x5dcff2=_0x11cb8f;_0x417a7c==_0x5dcff2(0x160)?(tgBot['sendMessage'](_0x32ba9e[_0x5dcff2(0x272)]['id'],_0x5dcff2(0xaa))[_0x5dcff2(0x12b)](_0xb7b189=>{telegramError(_0xb7b189);}),_0x1c612d[_0x5dcff2(0xbd)](_0x2a6a9e=>{const _0x156637=_0x5dcff2;if(_0x2a6a9e[_0x156637(0x1cc)]!=_0x156637(0x160))toggleBot(_0x2a6a9e[_0x156637(0x1cc)],toggleStatus(_0x2a6a9e[_0x156637(0x1cc)]),_0x156637(0x22f));})):(tgBot[_0x5dcff2(0x270)](_0x32ba9e[_0x5dcff2(0x272)]['id'],_0x5dcff2(0x1e4)+_0x417a7c)['catch'](_0x5b534=>{telegramError(_0x5b534);}),toggleBot(_0x417a7c,toggleStatus(_0x417a7c),_0x5dcff2(0x22f)));}),tgBot[_0x11cb8f(0x179)](_0x11cb8f(0x268));});}}),tgBot[_0x59de30(0x194)](/\/off/,_0x799895=>{const _0x3be52c=_0x59de30;if(!validateTelegram(_0x799895))return;tgBot[_0x3be52c(0x179)](_0x3be52c(0x268));const _0x285b73=getEnabledBots();if(_0x285b73[_0x3be52c(0x1d4)]==0x0)tgBot['sendMessage'](_0x799895['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x3d6e1e=>{telegramError(_0x3d6e1e);});else{if(_0x285b73['length']>0x1)_0x285b73[_0x3be52c(0x20c)]({'botID':_0x3be52c(0x160)});let _0x176c46=[],_0x12b79c=[];const _0x596cbb=_0x285b73[_0x3be52c(0x1d4)]%0x4==0x0||_0x285b73[_0x3be52c(0x1d4)]%0x4==0x3||_0x285b73[_0x3be52c(0x1d4)]%0x3==0x1?0x4:0x3;let _0x3c0650=0x0;_0x285b73[_0x3be52c(0xbd)]((_0x55018a,_0x309fd0)=>{const _0x52d8ea=_0x3be52c;if(_0x309fd0%_0x596cbb==0x0)_0x12b79c=[];_0x12b79c[_0x52d8ea(0x20c)]({'text':_0x55018a[_0x52d8ea(0x1cc)]==_0x52d8ea(0x160)?_0x52d8ea(0x1fa):_0x52d8ea(0x257)+_0x55018a[_0x52d8ea(0x1cc)],'callback_data':_0x55018a['botID']}),_0x309fd0%_0x596cbb==0x0&&(_0x176c46[_0x3c0650]=_0x12b79c,_0x3c0650++);}),tgBot['sendMessage'](_0x799895[_0x3be52c(0x272)]['id'],_0x3be52c(0x26c),{'reply_markup':{'inline_keyboard':_0x176c46}})[_0x3be52c(0x12b)](_0x3aad57=>{telegramError(_0x3aad57);}),tgBot['on'](_0x3be52c(0x268),async _0xe5f226=>{const _0xd6eb35=_0x3be52c,_0x38143e=_0xe5f226[_0xd6eb35(0xbf)],_0x5c79e1=_0xe5f226[_0xd6eb35(0x19a)];tgBot[_0xd6eb35(0x1a4)](_0xe5f226['id'])[_0xd6eb35(0x130)](async()=>{const _0x2015db=_0xd6eb35;_0x38143e=='all'?(tgBot['sendMessage'](_0x5c79e1[_0x2015db(0x272)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x2015db(0x12b)](_0x2e31cd=>{telegramError(_0x2e31cd);}),_0x285b73[_0x2015db(0xbd)](_0x2d6756=>{const _0x161861=_0x2015db;if(_0x2d6756[_0x161861(0x1cc)]!=_0x161861(0x160))toggleBot(_0x2d6756[_0x161861(0x1cc)],toggleStatus(_0x2d6756[_0x161861(0x1cc)]),_0x161861(0x22f));})):(tgBot[_0x2015db(0x270)](_0x5c79e1['chat']['id'],_0x2015db(0x178)+_0x38143e)[_0x2015db(0x12b)](_0x44b058=>{telegramError(_0x44b058);}),toggleBot(_0x38143e,toggleStatus(_0x38143e),_0x2015db(0x22f)));}),tgBot[_0xd6eb35(0x179)](_0xd6eb35(0x268));});}}),tgBot[_0x59de30(0x194)](/\/metrics/,_0x551862=>{const _0x3e025a=_0x59de30;if(!validateTelegram(_0x551862))return;tgBot[_0x3e025a(0x179)](_0x3e025a(0x268));const _0x13ffa1=getEnabledBots();if(_0x13ffa1[_0x3e025a(0x1d4)]==0x0)tgBot[_0x3e025a(0x270)](_0x551862[_0x3e025a(0x272)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x3e025a(0x12b)](_0xed9ab2=>{telegramError(_0xed9ab2);});else{if(_0x13ffa1['length']>0x1){let _0x214e8a=[],_0x5820fb=[];const _0x33f7f2=_0x13ffa1[_0x3e025a(0x1d4)]%0x4==0x0||_0x13ffa1['length']%0x4==0x3||_0x13ffa1[_0x3e025a(0x1d4)]%0x3==0x1?0x4:0x3;let _0x5a78e8=0x0;_0x13ffa1[_0x3e025a(0xbd)]((_0x24e5fa,_0x3fb5ca)=>{const _0x17c459=_0x3e025a;if(_0x3fb5ca%_0x33f7f2==0x0)_0x5820fb=[];_0x5820fb['push']({'text':_0x17c459(0x257)+_0x24e5fa[_0x17c459(0x1cc)],'callback_data':_0x24e5fa[_0x17c459(0x1cc)]}),_0x3fb5ca%_0x33f7f2==0x0&&(_0x214e8a[_0x5a78e8]=_0x5820fb,_0x5a78e8++);}),tgBot['sendMessage'](_0x551862[_0x3e025a(0x272)]['id'],_0x3e025a(0x1ac),{'reply_markup':{'inline_keyboard':_0x214e8a}})[_0x3e025a(0x12b)](_0x4a868f=>{telegramError(_0x4a868f);}),tgBot['on'](_0x3e025a(0x268),async _0xa59b55=>{const _0x3baf1e=_0x3e025a,_0x3ad855=_0xa59b55['data'],_0x5111a4=_0xa59b55[_0x3baf1e(0x19a)];tgBot[_0x3baf1e(0x1a4)](_0xa59b55['id'])['then'](async()=>{const _0x94b4c5=_0x3baf1e;if(pid[_0x3ad855])pid[_0x3ad855][_0x94b4c5(0x241)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x3baf1e(0x179)]('callback_query');});}else{const _0x42908a=_0x13ffa1[0x0][_0x3e025a(0x1cc)];if(pid[_0x42908a])pid[_0x42908a]['send']({'function':_0x3e025a(0x22c),'args':null});}}}),tgBot[_0x59de30(0x194)](/\/portfolio/,_0x4952b7=>{const _0xbc113e=_0x59de30;if(!validateTelegram(_0x4952b7))return;tgBot[_0xbc113e(0x179)]('callback_query');const _0x1b5b06=getEnabledBots();if(_0x1b5b06[_0xbc113e(0x1d4)]==0x0)tgBot[_0xbc113e(0x270)](_0x4952b7[_0xbc113e(0x272)]['id'],_0xbc113e(0xe0))[_0xbc113e(0x12b)](_0x366f69=>{telegramError(_0x366f69);});else{if(_0x1b5b06[_0xbc113e(0x1d4)]>0x1){let _0xb53d21=[],_0x3962d8=[];const _0x2e8661=_0x1b5b06['length']%0x4==0x0||_0x1b5b06[_0xbc113e(0x1d4)]%0x4==0x3||_0x1b5b06[_0xbc113e(0x1d4)]%0x3==0x1?0x4:0x3;let _0x1b96e5=0x0;_0x1b5b06['forEach']((_0x1ebd80,_0x19ab5a)=>{const _0x2741fd=_0xbc113e;if(_0x19ab5a%_0x2e8661==0x0)_0x3962d8=[];_0x3962d8[_0x2741fd(0x20c)]({'text':_0x2741fd(0x257)+_0x1ebd80[_0x2741fd(0x1cc)],'callback_data':_0x1ebd80['botID']}),_0x19ab5a%_0x2e8661==0x0&&(_0xb53d21[_0x1b96e5]=_0x3962d8,_0x1b96e5++);}),tgBot[_0xbc113e(0x270)](_0x4952b7[_0xbc113e(0x272)]['id'],_0xbc113e(0x25b),{'reply_markup':{'inline_keyboard':_0xb53d21}})[_0xbc113e(0x12b)](_0x55054b=>{telegramError(_0x55054b);}),tgBot['on'](_0xbc113e(0x268),async _0x41b471=>{const _0x44039f=_0xbc113e,_0x407c64=_0x41b471[_0x44039f(0xbf)],_0x372178=_0x41b471['message'];tgBot[_0x44039f(0x1a4)](_0x41b471['id'])['then'](async()=>{const _0x502f9f=_0x44039f;if(pid[_0x407c64])pid[_0x407c64][_0x502f9f(0x241)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x44039f(0x179)](_0x44039f(0x268));});}else{const _0x2a4c9e=_0x1b5b06[0x0][_0xbc113e(0x1cc)];if(pid[_0x2a4c9e])pid[_0x2a4c9e][_0xbc113e(0x241)]({'function':_0xbc113e(0xd3),'args':null});}}}),tgBot['onText'](/\/update/,async _0x3dad27=>{const _0x377963=_0x59de30;if(!validateTelegram(_0x3dad27))return;tgBot[_0x377963(0x179)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x377963(0x270)](_0x3dad27[_0x377963(0x272)]['id'],_0x377963(0xd0))[_0x377963(0x12b)](_0x4a4b5b=>{telegramError(_0x4a4b5b);});else!validInstallation?tgBot[_0x377963(0x270)](_0x3dad27[_0x377963(0x272)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')['catch'](_0x72c6dd=>{telegramError(_0x72c6dd);}):(tgBot[_0x377963(0x270)](_0x3dad27[_0x377963(0x272)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x377963(0x228),'callback_data':_0x377963(0xc1)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x19c6bd=>{telegramError(_0x19c6bd);}),tgBot['on'](_0x377963(0x268),async _0x5082e0=>{const _0x183347=_0x377963,_0x1333c7=_0x5082e0[_0x183347(0xbf)],_0x54ef47=_0x5082e0[_0x183347(0x19a)];tgBot[_0x183347(0x1a4)](_0x5082e0['id'])[_0x183347(0x130)](async()=>{const _0x1265f7=_0x183347;_0x1333c7==_0x1265f7(0xc1)&&(await tgBot[_0x1265f7(0x270)](_0x54ef47[_0x1265f7(0x272)]['id'],_0x1265f7(0x184))[_0x1265f7(0x12b)](_0x3e1569=>{telegramError(_0x3e1569);}),updateBB('update')),_0x1333c7=='no'&&await tgBot['sendMessage'](_0x54ef47[_0x1265f7(0x272)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x1265f7(0x12b)](_0x313e80=>{telegramError(_0x313e80);});}),tgBot[_0x183347(0x179)](_0x183347(0x268));}));}),tgBot[_0x59de30(0x194)](/\/reinstall/,async _0x235b57=>{const _0x14d990=_0x59de30;if(!validateTelegram(_0x235b57))return;tgBot['removeListener'](_0x14d990(0x268)),!validInstallation?tgBot['sendMessage'](_0x235b57[_0x14d990(0x272)]['id'],_0x14d990(0x27e))[_0x14d990(0x12b)](_0x2f393a=>{telegramError(_0x2f393a);}):(tgBot[_0x14d990(0x270)](_0x235b57[_0x14d990(0x272)]['id'],_0x14d990(0xed),{'reply_markup':{'inline_keyboard':[[{'text':_0x14d990(0x228),'callback_data':_0x14d990(0xc1)},{'text':'No','callback_data':'no'}]]}})[_0x14d990(0x12b)](_0x4fb397=>{telegramError(_0x4fb397);}),tgBot['on'](_0x14d990(0x268),async _0x251909=>{const _0x476bab=_0x14d990,_0xb670c2=_0x251909[_0x476bab(0xbf)],_0x25ca11=_0x251909[_0x476bab(0x19a)];tgBot[_0x476bab(0x1a4)](_0x251909['id'])['then'](async()=>{const _0x14cef5=_0x476bab;_0xb670c2==_0x14cef5(0xc1)&&(await tgBot[_0x14cef5(0x270)](_0x25ca11['chat']['id'],_0x14cef5(0x202))[_0x14cef5(0x12b)](_0x37433c=>{telegramError(_0x37433c);}),updateBB(_0x14cef5(0x1de))),_0xb670c2=='no'&&await tgBot['sendMessage'](_0x25ca11[_0x14cef5(0x272)]['id'],_0x14cef5(0x183))['catch'](_0x357405=>{telegramError(_0x357405);});}),tgBot[_0x476bab(0x179)](_0x476bab(0x268));}));}),tgBot[_0x59de30(0x194)](/\/toggle/,_0x5ed79d=>{const _0x5eba77=_0x59de30;if(!validateTelegram(_0x5ed79d))return;tgBot[_0x5eba77(0x179)](_0x5eba77(0x268));const _0x27ebfc=getBotsWithMode();if(_0x27ebfc['length']==0x0)tgBot[_0x5eba77(0x270)](_0x5ed79d[_0x5eba77(0x272)]['id'],_0x5eba77(0xe0))[_0x5eba77(0x12b)](_0x5f07c4=>{telegramError(_0x5f07c4);});else{let _0x2b3857=[],_0x3d857c=[];const _0xc6fb1b=0x2;let _0x17d445=0x0;_0x27ebfc[_0x5eba77(0xbd)]((_0x100378,_0x1d8e1e)=>{const _0x5ba1e0=_0x5eba77;if(_0x1d8e1e%_0xc6fb1b==0x0)_0x3d857c=[];_0x3d857c['push']({'text':_0x5ba1e0(0x257)+_0x100378[_0x5ba1e0(0x1cc)]+'\x20('+_0x100378[_0x5ba1e0(0x177)]+')','callback_data':_0x100378[_0x5ba1e0(0x1cc)]}),_0x1d8e1e%_0xc6fb1b==0x0&&(_0x2b3857[_0x17d445]=_0x3d857c,_0x17d445++);}),tgBot['sendMessage'](_0x5ed79d[_0x5eba77(0x272)]['id'],_0x5eba77(0x111),{'reply_markup':{'inline_keyboard':_0x2b3857}})[_0x5eba77(0x12b)](_0x4816b1=>{telegramError(_0x4816b1);}),tgBot['on'](_0x5eba77(0x268),async _0x41d06c=>{const _0x446388=_0x5eba77,_0x758b1b=_0x41d06c[_0x446388(0xbf)],_0x4accd0=_0x41d06c['message'];tgBot['answerCallbackQuery'](_0x41d06c['id'])[_0x446388(0x130)](async()=>{const _0x2f3266=_0x446388,_0x5f3f9c=_0x27ebfc['find'](_0x9477f2=>_0x9477f2[_0x2f3266(0x1cc)]==_0x758b1b),_0x216792=_0x5f3f9c[_0x2f3266(0x177)]==_0x2f3266(0x22b)?_0x2f3266(0x273):_0x2f3266(0x22b);tgBot[_0x2f3266(0x270)](_0x4accd0[_0x2f3266(0x272)]['id'],_0x2f3266(0xfa)+_0x758b1b+_0x2f3266(0x152)+_0x216792+_0x2f3266(0x162))[_0x2f3266(0x12b)](_0x2bec9b=>{telegramError(_0x2bec9b);}),toggleBotMode(_0x758b1b);}),tgBot[_0x446388(0x179)](_0x446388(0x268));});}}),tgBot[_0x59de30(0x194)](/\/names/,_0x1e2de8=>{const _0x185a95=_0x59de30;if(!validateTelegram(_0x1e2de8))return;let _0x589d0e='';config['forEach'](_0x24ef81=>{const _0x577d48=_0x5c3e;_0x589d0e+=_0x577d48(0x257)+_0x24ef81[_0x577d48(0x1cc)]+':\x20'+_0x24ef81[_0x577d48(0x251)]+'\x0a';}),tgBot[_0x185a95(0x270)](_0x1e2de8[_0x185a95(0x272)]['id'],_0x589d0e,{'parse_mode':_0x185a95(0x221)})[_0x185a95(0x12b)](_0x1c808d=>{telegramError(_0x1c808d);});}),tgBot['onText'](/\/disable/,_0x2dafbb=>{const _0x122f54=_0x59de30;if(!validateTelegram(_0x2dafbb))return;tgBot[_0x122f54(0x270)](_0x2dafbb['chat']['id'],'Notifications\x20disabled')[_0x122f54(0x12b)](_0x4e1c90=>{telegramError(_0x4e1c90);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x59de30(0x194)](/\/help/,_0x42559c=>{const _0x28ee89=_0x59de30;if(!validateTelegram(_0x42559c))return;tgBot[_0x28ee89(0x270)](_0x42559c['chat']['id'],_0x44b68f)[_0x28ee89(0x12b)](_0x1ac0e4=>{telegramError(_0x1ac0e4);});}),tgBot['on']('polling_error',_0x1382a3=>{const _0x44ef07=_0x59de30;_0x1382a3[_0x44ef07(0xe1)]()['includes'](_0x44ef07(0xf5))&&(logger[_0x44ef07(0x22a)](_0x44ef07(0xf7)),tgBot[_0x44ef07(0x1f9)](),tgBot=null,io['to'](_0x44ef07(0x153))[_0x44ef07(0x246)]('notification',_0x44ef07(0xf7)));}),process[_0x59de30(0x185)](_0x59de30(0xba),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x59de30(0x185)](_0x59de30(0x14b),()=>{const _0x5e6e23=_0x59de30;if(tgBot)tgBot[_0x5e6e23(0x1f9)]();process[_0x5e6e23(0x10d)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1885c1,_0x171c3c){const _0x5e358e=_0xf3309e;if(settings[_0x5e358e(0x17c)]){if(settings[_0x5e358e(0x12d)]==_0x5e358e(0x160)||(_0x171c3c['type']==_0x5e358e(0x108)||_0x171c3c['type']=='warning'||_0x171c3c[_0x5e358e(0x277)]==_0x5e358e(0x1b0))&&settings['telegramEvents']==_0x5e358e(0x259)||_0x171c3c[_0x5e358e(0x277)]=='order'&&settings[_0x5e358e(0x12d)]==_0x5e358e(0xf4)){if(tgBot&&settings['telegramChatId']){if(_0x171c3c['showname'])tgBot[_0x5e358e(0x270)](settings[_0x5e358e(0x21b)],_0x171c3c[_0x5e358e(0x251)]+_0x5e358e(0x12c)+_0x171c3c[_0x5e358e(0x1b6)])[_0x5e358e(0x12b)](_0x16cba8=>{telegramError(_0x16cba8);});else tgBot[_0x5e358e(0x270)](settings[_0x5e358e(0x21b)],_0x5e358e(0x257)+_0x1885c1+_0x5e358e(0x12c)+_0x171c3c[_0x5e358e(0x1b6)])[_0x5e358e(0x12b)](_0x164dca=>{telegramError(_0x164dca);});}}}}async function sendTelegramMsg(_0x5eeac0,_0x40b670=_0xf3309e(0x221)){const _0x3c58b5=_0xf3309e;return settings['telegramEnabled']&&tgBot&&settings[_0x3c58b5(0x21b)]?(await tgBot[_0x3c58b5(0x270)](settings[_0x3c58b5(0x21b)],_0x5eeac0,{'parse_mode':_0x40b670})[_0x3c58b5(0x12b)](_0x1a4d16=>{telegramError(_0x1a4d16);}),!![]):![];}function getDeviceWithIp(_0x4bcf23){const _0x10da44=_0xf3309e;return devices[_0x10da44(0x165)](_0x24366f=>_0x24366f['ip']===_0x4bcf23);}function temporaryAccess2FA(_0x40f5f7,_0x2636d9){const _0xf07d17=_0xf3309e;let _0x18f058=new Date(),_0x33ebb6=![];if(lastIpApproval){if(_0x18f058-lastIpApproval<0x1388)_0x33ebb6=!![];}lastIpApproval=new Date();if(_0x33ebb6)return;tgBot&&settings[_0xf07d17(0x21b)]&&(tgBot[_0xf07d17(0x179)](_0xf07d17(0x268)),tgBot[_0xf07d17(0x270)](settings[_0xf07d17(0x21b)],_0xf07d17(0x1b9)+normalizeIP(_0x2636d9)[_0xf07d17(0xf1)]+'</b>\x20?',{'parse_mode':_0xf07d17(0x221),'reply_markup':{'inline_keyboard':[[{'text':_0xf07d17(0x1f8),'callback_data':'5'},{'text':_0xf07d17(0x13b),'callback_data':'15'},{'text':_0xf07d17(0x133),'callback_data':'30'},{'text':_0xf07d17(0xc3),'callback_data':_0xf07d17(0xc3)}]]}})[_0xf07d17(0x12b)](_0x12de36=>{telegramError(_0x12de36);}),tgBot['on'](_0xf07d17(0x268),async _0x5975b3=>{const _0x14fae2=_0xf07d17,_0xf044ac=_0x5975b3[_0x14fae2(0xbf)],_0x557134=_0x5975b3[_0x14fae2(0x19a)];tgBot[_0x14fae2(0x1a4)](_0x5975b3['id'])[_0x14fae2(0x130)](async()=>{const _0x3a5ab1=_0x14fae2;devices[_0x40f5f7][_0x3a5ab1(0xdf)]={'clientip':_0x2636d9,'timestamp':new Date()[_0x3a5ab1(0x12a)](),'expiry':_0xf044ac},_0xf044ac!=_0x3a5ab1(0xc3)?(await tgBot[_0x3a5ab1(0x270)](_0x557134[_0x3a5ab1(0x272)]['id'],'Access\x20enabled\x20for\x20'+_0xf044ac+'\x20minutes',{'parse_mode':_0x3a5ab1(0x221)})['catch'](_0x28c548=>{telegramError(_0x28c548);}),io['to'](_0x40f5f7)[_0x3a5ab1(0x246)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x3a5ab1(0x270)](_0x557134[_0x3a5ab1(0x272)]['id'],_0x3a5ab1(0x19b))[_0x3a5ab1(0x12b)](_0x483221=>{telegramError(_0x483221);}),io['to'](_0x40f5f7)[_0x3a5ab1(0x246)](_0x3a5ab1(0xaf),{'access':{'allow':![],'reason':_0x3a5ab1(0x1ea),'token':null}}));}),tgBot[_0x14fae2(0x179)](_0x14fae2(0x268));}));}function loginAccess2FA(_0x51287e,_0x26216c){const _0x2a540b=_0xf3309e;tgBot&&settings[_0x2a540b(0x21b)]&&(tgBot['removeListener'](_0x2a540b(0x268)),tgBot[_0x2a540b(0x270)](settings[_0x2a540b(0x21b)],_0x2a540b(0x26e)+normalizeIP(_0x26216c)[_0x2a540b(0xf1)]+_0x2a540b(0x1ad),{'parse_mode':_0x2a540b(0x221),'reply_markup':{'inline_keyboard':[[{'text':_0x2a540b(0x1ff),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x2a540b(0xc3)}]]}})[_0x2a540b(0x12b)](_0xfd6812=>{telegramError(_0xfd6812);}),tgBot['on'](_0x2a540b(0x268),async _0x4a3c0e=>{const _0x3dd21b=_0x2a540b,_0x30ce52=_0x4a3c0e[_0x3dd21b(0xbf)],_0x324ec5=_0x4a3c0e[_0x3dd21b(0x19a)];tgBot[_0x3dd21b(0x1a4)](_0x4a3c0e['id'])[_0x3dd21b(0x130)](async()=>{const _0x94c014=_0x3dd21b;devices[_0x51287e][_0x94c014(0x21a)]={'clientip':_0x26216c,'timestamp':new Date()[_0x94c014(0x12a)](),'expiry':_0x30ce52},_0x30ce52!=_0x94c014(0xc3)?(await tgBot['sendMessage'](_0x324ec5[_0x94c014(0x272)]['id'],'Login\x20accepted',{'parse_mode':_0x94c014(0x221)})[_0x94c014(0x12b)](_0x12a478=>{telegramError(_0x12a478);}),io['to'](_0x51287e)[_0x94c014(0x246)](_0x94c014(0xaf),{'access':{'allow':![],'reason':_0x94c014(0x192),'token':null}})):(await tgBot[_0x94c014(0x270)](_0x324ec5['chat']['id'],_0x94c014(0xde))['catch'](_0x1c8456=>{telegramError(_0x1c8456);}),io['to'](_0x51287e)['emit'](_0x94c014(0xaf),{'access':{'allow':![],'reason':_0x94c014(0x136),'token':null}}));}),tgBot['removeListener'](_0x3dd21b(0x268));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2d5dea=_0xf3309e;return dbConfig[_0x2d5dea(0xec)]('bots')[_0x2d5dea(0x17b)](_0x2d5dea(0x1cc))['filter']({'status':_0x2d5dea(0xac)})[_0x2d5dea(0x138)]()||[];}function getDisabledBots(){const _0x28d4ba=_0xf3309e;return dbConfig['get'](_0x28d4ba(0x1d9))['sortBy'](_0x28d4ba(0x1cc))[_0x28d4ba(0x123)]({'status':'disabled'})[_0x28d4ba(0x138)]()||[];}function getBotAttributes(_0x38a15c){const _0x2c8c1e=_0xf3309e;let _0x41e006={};const _0x2c2dcc=configpath+_0x2c8c1e(0x18a)+_0x38a15c+_0x2c8c1e(0xc9),_0x597295=fs[_0x2c8c1e(0x127)](_0x2c2dcc);if(_0x597295){const _0x165122=fs[_0x2c8c1e(0x1e3)](_0x2c2dcc);try{const _0x3377fd=JSON[_0x2c8c1e(0x1c7)](_0x165122),_0x59ffc8=_0x3377fd?_0x3377fd['bot'][0x0][_0x2c8c1e(0x121)]:![];_0x41e006[_0x2c8c1e(0x177)]=_0x59ffc8?'auto':_0x2c8c1e(0x273),_0x41e006['botname']=_0x3377fd?_0x3377fd['bot'][0x0][_0x2c8c1e(0x251)]:_0x2c8c1e(0x257)+_0x38a15c;}catch(_0x551a82){_0x41e006[_0x2c8c1e(0x177)]=_0x2c8c1e(0x273),_0x41e006[_0x2c8c1e(0x251)]=_0x2c8c1e(0x257)+_0x38a15c;}}else _0x41e006[_0x2c8c1e(0x177)]=_0x2c8c1e(0x273),_0x41e006[_0x2c8c1e(0x251)]=_0x2c8c1e(0x257)+_0x38a15c;return _0x41e006;}function getBotsWithMode(){const _0x5604d4=_0xf3309e,_0x260d0a=dbConfig[_0x5604d4(0xec)]('bots')[_0x5604d4(0x17b)](_0x5604d4(0x1cc))[_0x5604d4(0x138)]()||[];return _0x260d0a[_0x5604d4(0xbd)](_0x299eca=>{const _0x3a21cd=_0x5604d4;let _0x113e65=getBotAttributes(_0x299eca['botID']);_0x299eca[_0x3a21cd(0x177)]=_0x113e65[_0x3a21cd(0x177)];}),_0x260d0a;}function getBotExchanges(){const _0x108ca3=_0xf3309e;let _0x2f5c6b=[];const _0x2530c9=dbConfig[_0x108ca3(0xec)](_0x108ca3(0x1d9))[_0x108ca3(0x17b)](_0x108ca3(0x1cc))['value']()||[];_0x2530c9['forEach'](_0x404e08=>{const _0x6a3d60=_0x108ca3;if(_0x404e08[_0x6a3d60(0xaf)]=='enabled'){const _0x5f34fb=configpath+_0x6a3d60(0x18a)+_0x404e08[_0x6a3d60(0x1cc)]+'-config.json',_0x4b7c56=fs[_0x6a3d60(0x127)](_0x5f34fb);let _0x31d71f;if(_0x4b7c56){const _0x28b5c6=fs[_0x6a3d60(0x1e3)](_0x5f34fb);try{const _0x3a501c=JSON[_0x6a3d60(0x1c7)](_0x28b5c6);_0x31d71f=_0x3a501c?_0x3a501c[_0x6a3d60(0x22e)][0x0][_0x6a3d60(0x105)]:null;}catch(_0x215622){}}if(_0x31d71f)_0x2f5c6b[_0x6a3d60(0x20c)](_0x31d71f);}});const _0x65b22b=[...new Set(_0x2f5c6b)][_0x108ca3(0x233)]();return _0x65b22b;}async function initUser(){const _0x1ba36f=_0xf3309e;if(!settings[_0x1ba36f(0xb7)]){const _0x17aa1b=uuidRandom();mixpanel[_0x1ba36f(0x149)](_0x17aa1b),updateSetting(_0x1ba36f(0xb7),_0x17aa1b);}}async function initSecure(){const _0x17cb5a=_0xf3309e;let _0x22474c=getSecure();if(!_0x22474c['hasOwnProperty'](_0x17cb5a(0x104))){let _0x1ec5f6=await generateKeys();_0x22474c[_0x17cb5a(0x169)]=_0x1ec5f6[_0x17cb5a(0x169)],_0x22474c['privateKey']=_0x1ec5f6['privateKey'],_0x22474c[_0x17cb5a(0x104)]=crypto[_0x17cb5a(0x163)](0x20)[_0x17cb5a(0xe1)](_0x17cb5a(0x237));;storeSecure(_0x22474c);}}function getSettings(){const _0x27f470=_0xf3309e;return dbSettings['get'](_0x27f470(0x128))['value']()||{};}function getSecure(){const _0x134ba6=_0xf3309e;return dbSecure['get'](_0x134ba6(0x27f))[_0x134ba6(0x138)]()||{};}function getBlacklist(){const _0x29de3f=_0xf3309e;return dbSecure[_0x29de3f(0xec)](_0x29de3f(0x13a))['value']()||[];}function broadcastToBots(_0x30ee1d,_0x3a3a51){const _0x231323=_0xf3309e;config[_0x231323(0xbd)](_0xcad3ce=>{const _0x436659=_0x231323;if(_0xcad3ce[_0x436659(0xaf)]==_0x436659(0xac)&&_0xcad3ce[_0x436659(0x124)]==_0x436659(0x15b)||_0xcad3ce[_0x436659(0xaf)]==_0x436659(0x1e0)&&_0xcad3ce[_0x436659(0x124)]==_0x436659(0x15b)){if(pid[_0xcad3ce[_0x436659(0x1cc)]])pid[_0xcad3ce[_0x436659(0x1cc)]][_0x436659(0x241)]({[_0x30ee1d]:_0x3a3a51});}});}function _0x84a7(){const _0x3d1e62=['stop','padStart','internal','8reyoPG','bots','temporaryAccessAllowed','getHours','\x1b[34m','/output-000.log','reinstall','getDate','new','lowdb/adapters/FileSync','Bot\x20Mgr\x20>\x20','readFileSync','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','login\x20token\x20valid','address','path','whitelist','.zip','temporary\x20access\x20rejected','crypto','file','ipv6','sockets','************','string','hasOwnProperty','version.json','Unauthorized\x20attempt\x20to\x20confirm\x20message','clients','=>\x20Go\x20to\x20#CYA#http://','handshake','timestamp','5\x20min','stopPolling','All\x20bots','Crypt','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Session\x20expired\x20for\x20user\x20...','messages','accept','tkn','assign','Starting\x20Balance\x20Bot\x20reinstallation',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','store','debug','You\x20can\x20use\x20the\x20following\x20commands:\x0a','slice','mkdirSync','kind','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','express','push','timeshift','decrypt','Ok,\x20will\x20send\x20alert\x20notifications\x20only','startsWith','\x1b[33m','/download/:type','\x20|\x20user:\x20...','removeAllListeners','2FA\x20required','track','invalid\x20credentials','867990NwaZvX','update-bot','telegram2FaApproval','telegramChatId','defaults','Restoring\x20bot(s)\x20from\x20backup','File\x20uploaded','Enabled\x20Bot\x20','-results.json','HTML','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','socket','function','apiSecret','telegram','pidExpireLogin','Yes','stringify','full','auto','sendMetricsTelegram','request','bot','stopped','828690jDHMGQ','telegrammsg','rmSync','sort','ipaddr.js','started','\x1b[0m','hex','/metrics\x20-\x20show\x20bot\x20performance\x0a','/on\x20-\x20start\x20bot(s)\x0a','output-000.log','includes','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getMinutes','connected','express-fileupload','isDirectory','send','Restarting\x20Bot\x20','disabled','keys','endsWith','emit','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','disconnect','Unauthorized\x20attempt\x20to\x20get\x20messages','update-bb','map','params','onepagemode','expiry','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','delete-alerts','botname','bb-config.json','deleteHistoryAlerts','toIPv4MappedAddress','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Markdown','Bot\x20','Unauthorized\x20attempt\x20to\x20download\x20','alerts','Notifications\x20types:\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','storeConfiguration','temporary\x20access\x20timeout','User\x20has\x20been\x20validated','0.0.0','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','download','Notifications\x20enabled','restart','showConfig','/upload-backup','username','token','callback_query','randomFillSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','verify','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','logs','Allow\x20login\x20from\x20IP\x20address\x20<b>','*$1*','sendMessage','use','chat','manual','sendFile','conn','Error:\x20Invalid\x20argument\x20','type','/:bot/coins','bbvNew','backup','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','replace','listen','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','secure','readdirSync','date-fns','\x20(1)','confirm-message','store-settings','login\x20not\x20required','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','whitelistEnabled','enabled','backup-full@','bb-secure.json','status','get-backup-files','static','files','http','notification','_data','node-telegram-bot-api','userid','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegramUsername','SIGINT','store-headless','writeFileSync','forEach','Orders','data','Starting\x20Balance\x20Bot\x20','yes','sha256','reject','#RES#\x20if\x20running\x20on\x20server','8dxakOc','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','11FIbKTC','apiPassword','-config.json','getPortfolio','get-messages','show-config','ipc','name','login\x20required','Your\x20installation\x20is\x20already\x20up\x20to\x20date','loginRequired','Unauthorized\x20attempt\x20to\x20delete\x20bot','sendPortfolioTelegram','NTBA_FIX_319','search','inherit','2FA\x20login\x20required','remoteAddress','set','port','yargs/yargs','https://api.ipify.org?format=json','\x20|\x20','Login\x20rejected','telegramIpApproval','No\x20bots\x20running\x20right\x20now','toString','isIPv4MappedAddress','4842906vfGUKi','log','Invalid\x20authentication\x20token\x20(1)','exec','index.html','Ok,\x20will\x20send\x20order\x20notifications\x20only','node-zip','config/','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','get','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Password\x20has\x20been\x20reset\x20to:\x20','emitHistory','/names\x20-\x20show\x20bot\x20names\x0a','show','place-order','bot.js','orders','404\x20Not\x20Found','referer','Invalid\x20Telegram\x20token','apiKey','bb-settings.json','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','jsonwebtoken','backup-full.zip','backup/','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','[ip-address]','private','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','1438623OziSbC','getUTCHours','secret','exchange','::1','backupfile','error','bbUsername','Error\x20while\x20deleting\x20config\x20files:\x20','min','number','exit','RSA','init','***','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','backup-full','password',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','logout','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','unlinkSync','bbPassword','uuid','Unauthorized\x20attempt\x20to\x20store\x20configuration','zip/','hybrid-crypto-js','family','temp/',',\x20must\x20be\x20a\x204\x20digit\x20number','split','headless','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','filter','live','restore-backup-file','667800QzwJRg','existsSync','settings','1000','getTime','catch','\x20>\x20','telegramEvents','lastmsgemitted','pidRefreshToken','then','new-disabled','login','30\x20min','-events.json','updatebotmanager','2FA\x20login\x20rejected','socket.io','value','range','blacklist','15\x20min','-performance.json','Invalid\x20authentication\x20token\x20(2)','hashSync','toIPv4Address','backup-files','login\x20token\x20generated','getFullYear','lowdb','IPv4','initclient','5193524iYJQGh','/help\x20-\x20show\x20available\x20commands\x0a','bb/','alias','Restore\x20process\x20aborted','SIGTERM','latestversion','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Logged\x20out\x20user\x20...','get-logs','/status\x20-\x20show\x20bot(s)\x20status\x0a','constructor','\x20to\x20','botmanager','build2','/disable\x20-\x20disable\x20notifications\x0a','Notifications\x20enabled\x0a','connection','127.0.0.1','Setting\x20access:\x20','binary','running','17896356UQlhoh','version','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','all','Starting\x20new\x20bot\x20|\x20Bot\x20','\x20mode','randomBytes','reinstall-bb','find','Error\x20removing\x20old\x20backup\x20files:','f2aRequired','simple','publicKey','getSeconds','headers','cloneDeep','/update\x20-\x20update\x20Balance\x20Bot\x0a','server','format','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','6b67f3d61ee94b8f5c80b4affef4c4d9','uuid-random','10qyiGdX','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','access','generateKeyPairAsync','mode','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','removeListener','update','sortBy','telegramEnabled','bbvReceive','match','logged\x20out','join','util','getMonth','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Starting\x20Balance\x20Bot\x20update','once','DEFLATE','\x1b[35m','sign','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','bot-','Restore\x20backup\x20file\x20','cancel-loading','/:bot/configuration','Unauthorized\x20attempt\x20to\x20log\x20out','graphql-request','output-003.log','bcryptjs','reload','from','onText','build','telegramToken','Notifications\x20disabled\x0a','clientip','Unauthorized\x20attempt\x20to\x20add\x20bot','message','Temporary\x20access\x20rejected','lastmsgtelegram','toggleBotMode','Backup\x20file\x20uploaded','argv','(((.+)+)+)+$','write','temporary\x20access\x20not\x20allowed','Disabled\x20Bot\x20','answerCallbackQuery','user','/:bot/performance','Unauthorized\x20attempt\x20to\x20get\x20portfolio','temporary\x20token\x20generated','createWriteStream','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20get\x20events','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','</b>\x20?','add-bot','getStartingBalances','success','output-002.log','/:bot/portfolio','-----------------------------------------------------------------------------------','settings.','copyFileSync','event','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','child_process','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','\x1b[36m','add','/restart\x20-\x20restart\x20bot(s)\x0a','placeOrder','#RES#\x20if\x20running\x20locally\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','kill','allow','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','2SgnNLk','<b>Telegram\x20Bot\x20Status:</b>\x0a','Node.js\x20v','parse','remove','Unauthorized\x20attempt\x20to\x20update\x20bot','uncaughtException','Unauthorized\x20attempt\x20to\x20show\x20configuration','botID','Server','Alerts','axios','env','privateKey','\x20(2)','reason','length'];_0x84a7=function(){return _0x3d1e62;};return _0x84a7();}function storeSettings(_0x377659,_0xcda403=![]){const _0x3895d7=_0xf3309e;_0x377659={...settings,..._0x377659};if(_0xcda403&&_0x377659[_0x3895d7(0x118)]!='************'&&_0x377659[_0x3895d7(0x118)]!='***'&&_0x377659[_0x3895d7(0x118)]!=''){const _0x223849=crypt[_0x3895d7(0x20e)](secure[_0x3895d7(0x1d1)],_0x377659[_0x3895d7(0x118)])['message'][_0x3895d7(0x120)]('@')[0x0],_0x41678f=bcrypt[_0x3895d7(0x13e)](_0x223849,saltRounds);_0x377659={..._0x377659,'bbPassword':_0x41678f};}if(_0xcda403&&_0x377659[_0x3895d7(0x196)]!=_0x3895d7(0x1ef)&&_0x377659[_0x3895d7(0x196)]!=_0x3895d7(0x110)&&_0x377659['telegramToken']!=''){const _0x3046c4=crypt['decrypt'](secure[_0x3895d7(0x1d1)],_0x377659['telegramToken'])['message']['split']('@')[0x0];_0x377659={..._0x377659,'telegramToken':_0x3046c4};}const _0x553a40=_0x377659[_0x3895d7(0x196)]!=_0x3895d7(0x1ef)&&_0x377659[_0x3895d7(0x196)]!=settings[_0x3895d7(0x196)]||_0x377659[_0x3895d7(0xb9)]!=settings[_0x3895d7(0xb9)],_0x335778=_0x377659[_0x3895d7(0x196)]==''||_0x377659[_0x3895d7(0xb9)]=='';if(_0x553a40)_0x377659[_0x3895d7(0x12d)]=_0x3895d7(0x160);for(const [_0x1b1e9f,_0x3f3716]of Object['entries'](_0x377659)){if(_0x1b1e9f==_0x3895d7(0x196)&&_0x3f3716=='************'){_0x377659[_0x3895d7(0x196)]=settings[_0x3895d7(0x196)];continue;};if(_0x1b1e9f==_0x3895d7(0x118)&&_0x3f3716==_0x3895d7(0x1ef)){_0x377659[_0x3895d7(0x118)]=settings['bbPassword'];continue;};dbSettings['set'](_0x3895d7(0x1b4)+_0x1b1e9f,_0x3f3716)['write']();}settings=_0x377659,io['to']('botmanager')['emit']('settings',cleanSettings()),broadcastToBots(_0x3895d7(0x20d),settings[_0x3895d7(0x20d)]),broadcastToBots(_0x3895d7(0x24d),settings[_0x3895d7(0x24d)]);if(_0x553a40&&!_0x335778)initTelegram();if(_0x553a40&&_0x335778)disableTelegram();getAllClients()[_0x3895d7(0xbd)](_0x598510=>{const _0x1e9f74=_0x3895d7;getSocket(_0x598510['id'])[_0x1e9f74(0x246)](_0x1e9f74(0xaf),{'access':{'allow':![],'reason':_0x1e9f74(0x192),'token':null}});});}function updateSetting(_0x11e333,_0x30e1a6){const _0x2e4ee3=_0xf3309e;dbSettings[_0x2e4ee3(0xd9)](_0x2e4ee3(0x1b4)+_0x11e333,_0x30e1a6)[_0x2e4ee3(0x1a1)](),settings=getSettings(),io['to'](_0x2e4ee3(0x153))[_0x2e4ee3(0x246)](_0x2e4ee3(0x128),cleanSettings());}function storeSecure(_0x4f4076){const _0x40c8bd=_0xf3309e;dbSecure[_0x40c8bd(0xec)](_0x40c8bd(0x27f))[_0x40c8bd(0x20c)](_0x4f4076)['write'](),secure=_0x4f4076;}function addBlacklist(_0x2f8611){const _0x1f122a=_0xf3309e;cleanBlacklist();let _0x5daf5f;devices[_0x2f8611][_0x1f122a(0xdf)]?_0x5daf5f=Math['max'](devices[_0x2f8611][_0x1f122a(0xdf)]['expiry'],loginExpiry):_0x5daf5f=loginExpiry,dbSecure[_0x1f122a(0xec)](_0x1f122a(0x13a))[_0x1f122a(0x20c)]({'expiry':new Date()[_0x1f122a(0x12a)]()+_0x5daf5f*0x3c*0x3e8,'token':devices[_0x2f8611][_0x1f122a(0x175)][_0x1f122a(0x267)]})['write'](),blacklist=dbSecure['get'](_0x1f122a(0x13a))[_0x1f122a(0x138)]();}function cleanBlacklist(){const _0x3c9c09=_0xf3309e;let _0x3fe24e=dbSecure[_0x3c9c09(0xec)]('blacklist')[_0x3c9c09(0x16c)]()['value'](),_0xb9a559=new Date()[_0x3c9c09(0x12a)]();_0x3fe24e[_0x3c9c09(0xbd)](_0x530bed=>{const _0x300410=_0x3c9c09;_0x530bed['expiry']<_0xb9a559&&dbSecure['get'](_0x300410(0x13a))[_0x300410(0x1c8)]({'expiry':_0x530bed[_0x300410(0x24e)]})[_0x300410(0x1a1)]();});}function initStates(){const _0x584e6f=_0xf3309e;let _0x17b476=getConfiguration();_0x17b476[_0x584e6f(0xbd)](_0x3774e3=>{const _0x2716f0=_0x584e6f;_0x3774e3[_0x2716f0(0x124)]='stopped';}),storeConfiguration(_0x17b476);}function onKeys(){const _0x57434a=new RSA();return new Promise(_0x381385=>{const _0x2089aa=_0x5c3e;_0x57434a[_0x2089aa(0x176)]()[_0x2089aa(0x130)](_0x51b2b0=>{_0x381385(_0x51b2b0);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4cc729=_0xf3309e;let _0x15f229=getSettings(),_0x3fca17=![];!_0x15f229[_0x4cc729(0x1f1)](_0x4cc729(0x19c))&&(_0x15f229[_0x4cc729(0x19c)]=0x0,_0x3fca17=!![]);!_0x15f229['hasOwnProperty'](_0x4cc729(0x12e))&&(_0x15f229[_0x4cc729(0x12e)]=0x0,_0x3fca17=!![]);!_0x15f229[_0x4cc729(0x1f1)](_0x4cc729(0x14c))&&(_0x15f229[_0x4cc729(0x14c)]=_0x4cc729(0x25f),_0x3fca17=!![]);!_0x15f229[_0x4cc729(0x1f1)](_0x4cc729(0x24d))&&(_0x15f229[_0x4cc729(0x24d)]=![],_0x3fca17=!![]);if(_0x3fca17)storeSettings(_0x15f229);try{fs[_0x4cc729(0x280)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x4945fd=>{const _0x3fd692=_0x4cc729;if(!_0x4945fd[_0x3fd692(0x240)]()){if(!_0x4945fd[_0x3fd692(0xce)][_0x3fd692(0x210)](_0x3fd692(0xad)))fs[_0x3fd692(0x117)](configbackuppath+_0x4945fd[_0x3fd692(0xce)]);}else fs[_0x3fd692(0x232)](configbackuppath+_0x4945fd['name'],{'recursive':!![]});});}catch(_0x422190){logger[_0x4cc729(0x205)](_0x4cc729(0x166),_0x422190);}}function storeConfiguration(_0x20348e){const _0x251259=_0xf3309e;dbConfig[_0x251259(0xec)](_0x251259(0x1d9))[_0x251259(0x1c8)]()[_0x251259(0x1a1)](),_0x20348e[_0x251259(0xbd)](_0x2cee7e=>{const _0x59b6b9=_0x251259;delete _0x2cee7e[_0x59b6b9(0x177)];}),dbConfig[_0x251259(0xec)]('bots')[_0x251259(0x20c)](..._0x20348e)[_0x251259(0x1a1)](),config=_0x20348e;}function resetPassword(){const _0x271f41=_0xf3309e;tgBot&&settings[_0x271f41(0x21b)]&&(tgBot[_0x271f41(0x179)]('callback_query'),tgBot[_0x271f41(0x270)](settings['telegramChatId'],_0x271f41(0xc6),{'parse_mode':_0x271f41(0x221),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x271f41(0x12b)](_0x2c57d7=>{telegramError(_0x2c57d7);}),tgBot['on'](_0x271f41(0x268),async _0x1c50ef=>{const _0x329f74=_0x271f41,_0x1fac50=_0x1c50ef[_0x329f74(0xbf)],_0x478284=_0x1c50ef['message'];tgBot['answerCallbackQuery'](_0x1c50ef['id'])[_0x329f74(0x130)](async()=>{const _0x2b616a=_0x329f74;if(_0x1fac50!='no'){const _0x455249=0xf,_0x2fdb6e='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x17ea74=Array['from'](crypto[_0x2b616a(0x269)](new Uint32Array(_0x455249)))[_0x2b616a(0x24b)](_0x4ec19e=>_0x2fdb6e[_0x4ec19e%_0x2fdb6e['length']])[_0x2b616a(0x180)](''),_0x3c5bdf=bcrypt['hashSync'](_0x17ea74,saltRounds);storeSettings({'bbPassword':_0x3c5bdf}),await tgBot['sendMessage'](_0x478284['chat']['id'],_0x2b616a(0xee)+_0x17ea74,{'parse_mode':_0x2b616a(0x221)})['catch'](_0x4bc294=>{telegramError(_0x4bc294);});}else await tgBot[_0x2b616a(0x270)](_0x478284[_0x2b616a(0x272)]['id'],'Password\x20reset\x20rejected')['catch'](_0x30b462=>{telegramError(_0x30b462);});}),tgBot[_0x329f74(0x179)]('callback_query');}));}async function confirmRestore(_0x103dba,_0x136d67){const _0x298967=_0xf3309e;io['to'](_0x298967(0x153))['emit']('notification',_0x298967(0x255),_0x298967(0x1b0)),tgBot&&settings[_0x298967(0x21b)]&&(tgBot[_0x298967(0x179)](_0x298967(0x268)),await tgBot['sendMessage'](settings['telegramChatId'],_0x298967(0x170),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x298967(0xc1),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x298967(0x12b)](_0x434bc9=>{telegramError(_0x434bc9);}),tgBot['on']('callback_query',async _0x37a0e9=>{const _0x5c4ea0=_0x298967,_0x45ee6d=_0x37a0e9[_0x5c4ea0(0xbf)],_0x358430=_0x37a0e9[_0x5c4ea0(0x19a)];tgBot[_0x5c4ea0(0x1a4)](_0x37a0e9['id'])['then'](async()=>{const _0x3a81ea=_0x5c4ea0;_0x45ee6d==_0x3a81ea(0xc1)?(await tgBot[_0x3a81ea(0x270)](_0x358430[_0x3a81ea(0x272)]['id'],_0x3a81ea(0x21d),{'parse_mode':_0x3a81ea(0x221)})['catch'](_0x4f8491=>{telegramError(_0x4f8491);}),unzipFile(_0x103dba,_0x136d67)):(logger[_0x3a81ea(0x205)](_0x3a81ea(0x14a)),await tgBot[_0x3a81ea(0x270)](_0x358430[_0x3a81ea(0x272)]['id'],_0x3a81ea(0x14a))['catch'](_0x2e987e=>{telegramError(_0x2e987e);}));}),tgBot[_0x5c4ea0(0x179)](_0x5c4ea0(0x268));}));}function getServerTime(){const _0x4f58ec=_0xf3309e,_0x21070e=new Date();return _0x21070e[_0x4f58ec(0x142)]()+'/'+(_0x21070e[_0x4f58ec(0x182)]()+0x1)[_0x4f58ec(0xe1)]()[_0x4f58ec(0x1d6)](0x2,'0')+'/'+_0x21070e['getDate']()['toString']()[_0x4f58ec(0x1d6)](0x2,'0')+'\x20'+_0x21070e[_0x4f58ec(0x1db)]()[_0x4f58ec(0xe1)]()[_0x4f58ec(0x1d6)](0x2,'0')+':'+_0x21070e[_0x4f58ec(0x23d)]()[_0x4f58ec(0xe1)]()['padStart'](0x2,'0')+':'+_0x21070e[_0x4f58ec(0x16a)]()[_0x4f58ec(0xe1)]()[_0x4f58ec(0x1d6)](0x2,'0');}function getTimeStamp(){const _0x2814df=_0xf3309e,_0x1de860=shiftedTime();return _0x1de860['getFullYear']()+'/'+(_0x1de860[_0x2814df(0x182)]()+0x1)[_0x2814df(0xe1)]()['padStart'](0x2,'0')+'/'+_0x1de860[_0x2814df(0x1df)]()[_0x2814df(0xe1)]()['padStart'](0x2,'0')+'\x20'+_0x1de860[_0x2814df(0x1db)]()['toString']()[_0x2814df(0x1d6)](0x2,'0')+':'+_0x1de860['getMinutes']()['toString']()[_0x2814df(0x1d6)](0x2,'0')+':'+_0x1de860['getSeconds']()[_0x2814df(0xe1)]()[_0x2814df(0x1d6)](0x2,'0');}function getCleanTimeStamp(){const _0x59f10a=_0xf3309e,_0x184918=shiftedTime();return _0x184918[_0x59f10a(0x142)]()+(_0x184918[_0x59f10a(0x182)]()+0x1)[_0x59f10a(0xe1)]()[_0x59f10a(0x1d6)](0x2,'0')+_0x184918[_0x59f10a(0x1df)]()[_0x59f10a(0xe1)]()[_0x59f10a(0x1d6)](0x2,'0')+'-'+_0x184918['getHours']()[_0x59f10a(0xe1)]()[_0x59f10a(0x1d6)](0x2,'0')+_0x184918[_0x59f10a(0x23d)]()[_0x59f10a(0xe1)]()['padStart'](0x2,'0')+_0x184918[_0x59f10a(0x16a)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x2d8025=_0xf3309e,_0x5a3547=new Date();let _0x243928=_0x5a3547;if(settings[_0x2d8025(0x20d)]&&settings[_0x2d8025(0x20d)]!==0x0)_0x243928=fns[_0x2d8025(0x1bc)](_0x5a3547,{'hours':settings[_0x2d8025(0x20d)]});return _0x243928;}function startScheduler(){const _0x5a49b5=_0xf3309e,_0x3c73d9=new Date()[_0x5a49b5(0x103)](),_0x2979f8=shiftedTime()[_0x5a49b5(0x1db)]();_0x2979f8==0x4&&backupConfigFiles();_0x2979f8==0x0&&rotateLogFiles();_0x3c73d9%0x6==0x0&&triggerAnalytics();_0x3c73d9%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4463c1){const _0x2db878=_0xf3309e;logger[_0x2db878(0x205)](_0x2db878(0x18b)+_0x4463c1);const _0x3cbfff=getBotsWithMode();_0x3cbfff[_0x2db878(0x1d4)]>0x0?confirmRestore(configbackuppath,_0x4463c1):unzipFile(configbackuppath,_0x4463c1);}async function getBackupFiles(_0x2f0efd=null){const _0xb3ecb2=_0xf3309e;let _0x3399bf=[],_0x4a1799=fs[_0xb3ecb2(0x280)](configbackuppath,{'withFileTypes':!![]});_0x4a1799[_0xb3ecb2(0x233)]((_0x58c844,_0x2e46a6)=>_0x58c844[_0xb3ecb2(0xce)]<_0x2e46a6['name']?0x1:_0x2e46a6[_0xb3ecb2(0xce)]<_0x58c844[_0xb3ecb2(0xce)]?-0x1:0x0),_0x4a1799['forEach'](_0x51a980=>{const _0x507cef=_0xb3ecb2;if(!_0x51a980[_0x507cef(0x240)]()&&_0x51a980[_0x507cef(0xce)][_0x507cef(0x210)](_0x507cef(0xad))&&_0x51a980[_0x507cef(0xce)][_0x507cef(0x245)](_0x507cef(0x1e9))){const _0x4ca207=formatDate(fs['statSync'](configbackuppath+_0x51a980['name'])['mtime']);_0x3399bf['push']({'name':_0x51a980['name'],'mtime':_0x4ca207});}});if(_0x2f0efd)io['to'](_0x2f0efd)[_0xb3ecb2(0x246)](_0xb3ecb2(0x140),_0x3399bf);else return _0x3399bf;}async function backupConfigFiles(){const _0x549389=_0xf3309e;await zipFiles(_0x549389(0x112));const _0x1328e8=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x549389(0xfc),configbackuppath+(_0x549389(0xad)+_0x1328e8+_0x549389(0x1e9)));let _0x2dd58c=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2dd58c[_0x549389(0x233)]((_0x4edf4b,_0x4b7d00)=>_0x4edf4b[_0x549389(0xce)]<_0x4b7d00['name']?0x1:_0x4b7d00['name']<_0x4edf4b[_0x549389(0xce)]?-0x1:0x0),_0x2dd58c[_0x549389(0x1d4)]>maxBackups&&fs[_0x549389(0x117)](configbackuppath+_0x2dd58c[_0x2dd58c[_0x549389(0x1d4)]-0x1][_0x549389(0xce)]);}function rotateLogFiles(){const _0x400422=_0xf3309e,_0x347021=fs['statSync'](logspath+'output-000.log'),_0x453497=_0x347021['size']/0x400;if(_0x453497>0x64){let _0x5db6b9=fs[_0x400422(0x280)](logspath,{'withFileTypes':!![]});_0x5db6b9['sort']((_0x433f2b,_0x50f74b)=>_0x433f2b[_0x400422(0xce)]<_0x50f74b[_0x400422(0xce)]?0x1:_0x50f74b[_0x400422(0xce)]<_0x433f2b[_0x400422(0xce)]?-0x1:0x0),_0x5db6b9[_0x400422(0xbd)](_0x4a2f8f=>{const _0x4f4924=_0x400422;if(_0x4a2f8f[_0x4f4924(0xce)]==_0x4f4924(0x1b1))fs[_0x4f4924(0x1b5)](logspath+_0x4a2f8f[_0x4f4924(0xce)],logspath+_0x4f4924(0x190));if(_0x4a2f8f[_0x4f4924(0xce)]=='output-001.log')fs[_0x4f4924(0x1b5)](logspath+_0x4a2f8f[_0x4f4924(0xce)],logspath+_0x4f4924(0x1b1));_0x4a2f8f[_0x4f4924(0xce)]==_0x4f4924(0x23a)&&(fs['copyFileSync'](logspath+_0x4a2f8f[_0x4f4924(0xce)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x4a2f8f[_0x4f4924(0xce)],''));});}}async function zipFiles(_0x18af99){const _0x19cb20=_0xf3309e;let _0x51ccd0;if(_0x18af99==_0x19cb20(0x26d))_0x51ccd0=logspath;if(_0x18af99==_0x19cb20(0x27a))_0x51ccd0=configpath;if(_0x18af99==_0x19cb20(0x112))_0x51ccd0=configpath;let _0x2ba04f=fs[_0x19cb20(0x280)](_0x51ccd0,{'withFileTypes':!![]});const _0x4b8aa9=new require(_0x19cb20(0xe9))();_0x2ba04f[_0x19cb20(0xbd)](_0x1c319a=>{const _0x36ebf7=_0x19cb20;if(!_0x1c319a['isDirectory']()){let _0x11cff6=fs[_0x36ebf7(0x1e3)](_0x51ccd0+_0x1c319a[_0x36ebf7(0xce)]);if(_0x18af99==_0x36ebf7(0x27a)){const _0x39b8b7=/^bot-[0-9]{3}-config.json$/,_0x3086f0=_0x39b8b7['test'](_0x1c319a[_0x36ebf7(0xce)]);if(_0x3086f0){const _0x3daf42=JSON[_0x36ebf7(0x1c7)](_0x11cff6);if(_0x3daf42[_0x36ebf7(0x22e)][0x0]){_0x3daf42[_0x36ebf7(0x22e)][0x0][_0x36ebf7(0xf8)]='***',_0x3daf42[_0x36ebf7(0x22e)][0x0][_0x36ebf7(0x225)]=_0x36ebf7(0x110);if(_0x3daf42[_0x36ebf7(0x22e)][0x0][_0x36ebf7(0xc8)])_0x3daf42[_0x36ebf7(0x22e)][0x0][_0x36ebf7(0xc8)]=_0x36ebf7(0x110);}_0x11cff6=JSON[_0x36ebf7(0x229)](_0x3daf42,null,0x2);}if(_0x1c319a[_0x36ebf7(0xce)]=='bb-settings.json'){const _0x143d92=JSON[_0x36ebf7(0x1c7)](_0x11cff6);if(_0x143d92['settings'][_0x36ebf7(0xd1)])_0x143d92[_0x36ebf7(0x128)][_0x36ebf7(0xd1)]=![];if(_0x143d92['settings'][_0x36ebf7(0x118)])_0x143d92[_0x36ebf7(0x128)][_0x36ebf7(0x118)]=_0x36ebf7(0x110);if(_0x143d92[_0x36ebf7(0x128)][_0x36ebf7(0x196)])_0x143d92[_0x36ebf7(0x128)][_0x36ebf7(0x196)]=_0x36ebf7(0x110);if(_0x143d92[_0x36ebf7(0x128)]['telegramChatId'])_0x143d92[_0x36ebf7(0x128)]['telegramChatId']=null;_0x11cff6=JSON[_0x36ebf7(0x229)](_0x143d92,null,0x2);}if(_0x1c319a[_0x36ebf7(0xce)]!=_0x36ebf7(0xae))_0x4b8aa9[_0x36ebf7(0x1ec)](_0x1c319a[_0x36ebf7(0xce)],_0x11cff6);}else _0x4b8aa9[_0x36ebf7(0x1ec)](_0x1c319a[_0x36ebf7(0xce)],_0x11cff6);}});const _0x20f129=_0x4b8aa9['generate']({'base64':![],'compression':_0x19cb20(0x186)});fs[_0x19cb20(0xbc)](zippath+(_0x18af99+_0x19cb20(0x1e9)),_0x20f129,_0x19cb20(0x15a));}async function unzipFile(_0x5c1511,_0x185e5e){const _0x3b88f3=_0xf3309e;fs[_0x3b88f3(0x280)](configpath,{'withFileTypes':!![]})[_0x3b88f3(0xbd)](_0x2229a6=>{const _0xb5cc99=_0x3b88f3;if(!_0x2229a6[_0xb5cc99(0x240)]())fs[_0xb5cc99(0x232)](configpath+_0x2229a6[_0xb5cc99(0xce)]);});const _0x560415=fs[_0x3b88f3(0x1e3)](_0x5c1511+_0x185e5e,_0x3b88f3(0x15a)),_0x5be703=new require(_0x3b88f3(0xe9))(_0x560415,{'base64':![],'checkCRC32':!![]});Object[_0x3b88f3(0x244)](_0x5be703['files'])['forEach'](_0x2b5d27=>{const _0x5e4ba2=_0x3b88f3,_0x519323=_0x5be703[_0x5e4ba2(0xb2)][_0x2b5d27];fs[_0x5e4ba2(0xbc)](configpath+_0x519323[_0x5e4ba2(0xce)],_0x519323[_0x5e4ba2(0xb5)]);}),fs[_0x3b88f3(0x280)](temppath,{'withFileTypes':!![]})['forEach'](_0x5efcd5=>{const _0x3113=_0x3b88f3;if(!_0x5efcd5[_0x3113(0x240)]())fs[_0x3113(0x232)](temppath+_0x5efcd5[_0x3113(0xce)]);}),logger[_0x3b88f3(0x205)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x3b88f3(0x241)]({'restore':!![]},_0x18d4ef=>{});}async function getPublicIp(){const _0x4dd3db=_0xf3309e;try{const _0x444afc=await axios[_0x4dd3db(0xec)](_0x4dd3db(0xdc));publicip=_0x444afc[_0x4dd3db(0xbf)]['ip'];}catch(_0x63090b){}}async function triggerAnalytics(){const _0x2c0655=_0xf3309e;if(!publicip)await getPublicIp();const _0x106afc=getBotsWithMode();let _0x22be72=0x0;_0x106afc[_0x2c0655(0xbd)](_0x462006=>{const _0x54977b=_0x2c0655;if(_0x462006[_0x54977b(0xaf)]===_0x54977b(0xac))_0x22be72++;});const _0x19607b=getBotExchanges();mixpanel[_0x2c0655(0x216)](_0x2c0655(0x1cd),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x106afc[_0x2c0655(0x1d4)],'numbotsenabled':_0x22be72,'exchanges':_0x19607b});}async function getMessages(){const _0x54f3a4=_0xf3309e,_0x5648bc=_0x54f3a4(0x189),_0x2e903e=new GraphQLClient(_0x5648bc),_0xe40827={'authorization':_0x54f3a4(0x116)},_0x448232=serverversion[_0x54f3a4(0x120)]('.'),_0x301e50=_0x448232[0x0]+'.'+_0x448232[0x1],_0x2aa65f=Math[_0x54f3a4(0x10b)](settings[_0x54f3a4(0x19c)],settings[_0x54f3a4(0x12e)]),_0x2da4c4={'last':parseInt(_0x2aa65f),'bbm':_0x301e50},_0xdfe37a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x391c22;try{_0x391c22=await _0x2e903e[_0x54f3a4(0x22d)](_0xdfe37a,_0x2da4c4,_0xe40827);}catch(_0x53c276){}if(_0x391c22&&_0x391c22[_0x54f3a4(0x1fe)]){let _0x2a4954=settings[_0x54f3a4(0x19c)];newMessages=[];for(const _0x3ca93f of _0x391c22[_0x54f3a4(0x1fe)]){newMessages[_0x54f3a4(0x20c)](_0x3ca93f);if(_0x3ca93f[_0x54f3a4(0x279)])updateSetting(_0x54f3a4(0x14c),_0x3ca93f[_0x54f3a4(0x279)]);let _0x311f97=_0x3ca93f['bbvNew']?serverversion>=_0x3ca93f[_0x54f3a4(0x279)]:![];if(!_0x311f97&&_0x3ca93f['number']>_0x2a4954){if(_0x3ca93f[_0x54f3a4(0x17d)]==='any'||serverversion[_0x54f3a4(0x210)](_0x3ca93f[_0x54f3a4(0x17d)])){let _0x580623=''+_0x3ca93f['title']+'\x0a\x0a'+_0x3ca93f[_0x54f3a4(0x19a)];const _0x500380=await sendTelegramMsg(toTelegramMarkdown(_0x580623),_0x54f3a4(0x256));if(_0x500380)_0x2a4954=_0x3ca93f[_0x54f3a4(0x10c)];}}}updateAvailable=isNewerVersion(settings[_0x54f3a4(0x14c)],serverversion),updateSetting(_0x54f3a4(0x19c),_0x2a4954),emitMessages();}}function emitMessages(){const _0x45b9c0=_0xf3309e,_0x109a42=settings[_0x45b9c0(0x12e)];let _0xa4a5bb=[];newMessages[_0x45b9c0(0xbd)](_0x284550=>{const _0x309e40=_0x45b9c0;_0x284550[_0x309e40(0x10c)]>_0x109a42&&_0xa4a5bb[_0x309e40(0x20c)](_0x284550);}),_0xa4a5bb['length']>0x0&&getAllClients()[_0x45b9c0(0xbd)](_0x3b64e8=>{const _0x27a80d=_0x45b9c0;getSocket(_0x3b64e8['id'])[_0x27a80d(0x246)]('message',_0xa4a5bb);});}function confirmMessage(_0x3c7521){const _0x272b94=_0xf3309e;updateSetting(_0x272b94(0x12e),Number(_0x3c7521));}function isNewerVersion(_0x3df960,_0x1c4776){const _0x16ddf9=_0xf3309e,_0x4a7aef=_0x1c4776[_0x16ddf9(0x120)]('.'),_0xb4e2a6=_0x3df960[_0x16ddf9(0x120)]('.');for(var _0x13e41c=0x0;_0x13e41c<_0xb4e2a6[_0x16ddf9(0x1d4)];_0x13e41c++){const _0x5452de=~~_0xb4e2a6[_0x13e41c],_0x1e7acf=~~_0x4a7aef[_0x13e41c];if(_0x5452de>_0x1e7acf)return!![];if(_0x5452de<_0x1e7acf)return![];}return![];}function toTelegramMarkdown(_0x43cc84){const _0x4c63a9=_0xf3309e,_0x241177=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xd3a3ab=/\*{2}(.+?)\*{2}/gim;return _0x43cc84=_0x43cc84[_0x4c63a9(0x27c)](_0x241177,'$1_$2_$3')[_0x4c63a9(0x27c)](_0xd3a3ab,_0x4c63a9(0x26f)),_0x43cc84;}async function validateConfigFile(){const _0x342c0c=_0xf3309e,_0x25f551=dbConfig[_0x342c0c(0xec)](_0x342c0c(0x1d9))[_0x342c0c(0x17b)]('botID')['value']()||[];if(_0x25f551[_0x342c0c(0x1d4)]==0x0){let _0x3afc34=0x0,_0x5a821a=[];const _0x1dd877=/^bot-([0-9]{3})-config.json$/,_0x1d1056=fs['readdirSync'](configpath);_0x1d1056[_0x342c0c(0xbd)](_0x2f10f2=>{const _0x411d2d=_0x342c0c,_0x788e57=_0x1dd877[_0x411d2d(0xe6)](_0x2f10f2);if(_0x788e57){const _0x5917c5=_0x788e57[0x1];let _0x219629=getBotAttributes(_0x5917c5);_0x5a821a['push']({'botID':_0x5917c5,'botname':_0x219629[_0x411d2d(0x251)],'status':_0x411d2d(0x243),'live':_0x411d2d(0x22f)}),_0x3afc34++;}}),_0x3afc34!=0x0&&(dbConfig[_0x342c0c(0xec)](_0x342c0c(0x1d9))[_0x342c0c(0x201)](_0x5a821a)[_0x342c0c(0x1a1)](),config=_0x5a821a,restoredConfigFile=_0x3afc34);}}async function restoreConfigNotify(_0x1cd161){const _0x1c147c=_0xf3309e;let _0x2bbc11;if(restoredConfigFile==0x1)_0x2bbc11=_0x1c147c(0x23c);else _0x2bbc11=_0x1c147c(0x1c3);if(_0x1cd161)io['to']('botmanager')[_0x1c147c(0x246)](_0x1c147c(0xb4),_0x2bbc11);else{logger['simple'](_0x1c147c(0x1b3)),logger[_0x1c147c(0x168)](_0x2bbc11),logger[_0x1c147c(0x168)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x1c147c(0x12d)]!=_0x1c147c(0xf4))tgBot['sendMessage'](settings[_0x1c147c(0x21b)],_0x1c147c(0x1e2)+_0x2bbc11)[_0x1c147c(0x12b)](_0x2e91ac=>{telegramError(_0x2e91ac);});}}function validateCredentials(_0x57cbfb,_0x2711f5){const _0x3217b6=_0xf3309e;if(_0x57cbfb[_0x3217b6(0x266)]==settings[_0x3217b6(0x109)]&&bcrypt['compareSync'](_0x57cbfb[_0x3217b6(0x113)],settings['bbPassword'])){if(settings[_0x3217b6(0x167)])return{'allow':![],'reason':_0x3217b6(0xd7),'token':null};else{const _0xf3bea3=generateLoginToken(_0x2711f5);return{'allow':!![],'reason':_0x3217b6(0x141),'token':_0xf3bea3};}}else return{'allow':![],'reason':_0x3217b6(0x217),'token':null};}function refreshToken(_0x5d20e4){const _0x985ab5=_0xf3309e,_0xf4b644=generateLoginToken(_0x5d20e4);return{'allow':!![],'reason':_0x985ab5(0x141),'token':_0xf4b644};}function validateAccess(_0x2a3d86,_0x5bd22d,_0x5044e6){const _0x141300=_0xf3309e,_0x4570f2=_0x5044e6?_0x5044e6:devices[_0x5bd22d]['ip'];let _0x584113;const _0x37fb77=_0x45f7d3=>{const _0x4f4140=_0x5c3e;if(settings[_0x4f4140(0xd1)]){if(settings[_0x4f4140(0x167)]){if(telegram2FaApproved(_0x5bd22d)){const _0x15e325=generateLoginToken(_0x5bd22d);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x15e325};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x584113=validToken(_0x45f7d3,_0x5bd22d),_0x584113[_0x4f4140(0x1f1)](_0x4f4140(0x1b0))?{'allow':!![],'reason':_0x4f4140(0x1e5),'token':_0x45f7d3}:{'allow':![],'reason':_0x4f4140(0xcf),'token':null};}else return{'allow':!![],'reason':_0x4f4140(0xa9),'token':null};};if(settings[_0x141300(0xab)]){let _0xbf8b6d=[...settings[_0x141300(0x1e8)],_0x141300(0x106),'::ffff:127.0.0.1',_0x141300(0x158)];if(_0xbf8b6d[_0x141300(0x23b)](_0x4570f2))return _0x37fb77(_0x2a3d86);else{_0x584113=validToken(_0x2a3d86,_0x5bd22d);if(_0x584113['hasOwnProperty'](_0x141300(0x1b0)))return _0x37fb77(_0x2a3d86);else{if(telegramIpApproved(_0x5bd22d)){const _0x2e99b0=generateToken(_0x5bd22d);return _0x584113=_0x37fb77(_0x2a3d86),_0x584113[_0x141300(0x1c2)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x2e99b0}:_0x584113;}else return settings[_0x141300(0x1da)]?{'allow':![],'reason':_0x141300(0x215),'token':null}:{'allow':![],'reason':_0x141300(0x1a2),'token':null};}}}else return _0x37fb77(_0x2a3d86);}function timelyDecrypt(_0x3f619a,_0x41480=!![]){const _0x5161f1=_0xf3309e;if(_0x3f619a)try{const _0x3263c3=crypt[_0x5161f1(0x20e)](secure[_0x5161f1(0x1d1)],_0x3f619a)[_0x5161f1(0x19a)],_0xaeb707=_0x3263c3[_0x5161f1(0x120)]('@')[0x0],_0x399560=_0x3263c3[_0x5161f1(0x120)]('@')[0x1],_0x2e7959=new Date()[_0x5161f1(0x12a)]();if(_0x41480){if(_0x2e7959-_0x399560<maxSecretAge*0x3e8)return _0xaeb707;else return![];}else return _0xaeb707;}catch(_0x1e94da){return![];}else return![];}const validToken=(_0xe5eef,_0x25bf6b)=>{const _0x391a8d=_0xf3309e,_0x3dd3e8=devices[_0x25bf6b]['ip'];if(!_0xe5eef)return{'error':'No\x20authentication\x20token'};for(let _0x3b103d of blacklist){if(_0x3b103d[_0x391a8d(0x267)]==_0xe5eef)return{'error':_0x391a8d(0x15e)};}let _0x2db570;try{_0x2db570=jwt[_0x391a8d(0x26b)](_0xe5eef,secure['secret']+_0x25bf6b);}catch{return{'error':_0x391a8d(0xe5)};}if(!_0x2db570[_0x391a8d(0x1f1)]('clientip')&&!_0x2db570['hasOwnProperty'](_0x391a8d(0x266))||!_0x2db570['hasOwnProperty']('exp'))return{'error':_0x391a8d(0x13d)};if(!_0x2db570[_0x391a8d(0x1f1)](_0x391a8d(0x266))&&_0x2db570[_0x391a8d(0x1f1)](_0x391a8d(0x198))){const {clientip:_0x466559}=_0x2db570;return _0x3dd3e8==_0x466559?{'success':_0x391a8d(0x25e)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x2db570[_0x391a8d(0x1f1)]('username')&&_0x2db570['hasOwnProperty'](_0x391a8d(0x198))){const {username:_0xf6c056,clientip:_0x50b0a9}=_0x2db570;return settings['bbUsername']==_0xf6c056&&_0x3dd3e8==_0x50b0a9?{'success':_0x391a8d(0x25e)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x2804af=>{const _0x2a3011=_0xf3309e;if(_0x2804af){const _0x1fb841=devices[_0x2804af]['ip'];return jwt[_0x2a3011(0x188)]({'username':settings[_0x2a3011(0x109)],'clientip':_0x1fb841},secure[_0x2a3011(0x104)]+_0x2804af,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x49ef73=>{const _0x4c268d=_0xf3309e;if(_0x49ef73){const _0x5b8ca3=devices[_0x49ef73]['ip'];return jwt['sign']({'clientip':_0x5b8ca3},secure['secret']+_0x49ef73,{'expiresIn':devices[_0x49ef73][_0x4c268d(0xdf)][_0x4c268d(0x24e)]*0x3c});}else return![];},telegramIpApproved=_0x2e6eab=>{const _0x75568e=_0xf3309e;let _0x1d0d72=![];return devices[_0x2e6eab][_0x75568e(0xdf)]&&devices[_0x2e6eab][_0x75568e(0xdf)][_0x75568e(0x24e)]!=_0x75568e(0xc3)&&(_0x1d0d72=devices[_0x2e6eab]['telegramIpApproval'][_0x75568e(0x198)]==devices[_0x2e6eab]['ip']&&new Date()['getTime']()-devices[_0x2e6eab][_0x75568e(0xdf)]['timestamp']<devices[_0x2e6eab][_0x75568e(0xdf)][_0x75568e(0x24e)]*0x3c*0x3e8),_0x1d0d72;},telegram2FaApproved=_0x5b3d29=>{const _0x4f1146=_0xf3309e;let _0x2b922f=![];return devices[_0x5b3d29]['telegram2FaApproval']&&devices[_0x5b3d29][_0x4f1146(0x21a)][_0x4f1146(0x24e)]!=_0x4f1146(0xc3)&&(_0x2b922f=devices[_0x5b3d29]['telegram2FaApproval']['clientip']==devices[_0x5b3d29]['ip']&&new Date()[_0x4f1146(0x12a)]()-devices[_0x5b3d29][_0x4f1146(0x21a)][_0x4f1146(0x1f7)]<devices[_0x5b3d29][_0x4f1146(0x21a)][_0x4f1146(0x24e)]*0x3c*0x3e8),_0x2b922f;},normalizeIP=_0x50a3b4=>{const _0x8dbc88=_0xf3309e;let _0x66b2fe=null,_0x1a8f11=null;if(ipaddr['isValid'](_0x50a3b4)){const _0x30934d=ipaddr['parse'](_0x50a3b4);_0x30934d[_0x8dbc88(0x209)]()===_0x8dbc88(0x1ed)?(_0x30934d[_0x8dbc88(0xe2)]()&&(_0x66b2fe=_0x30934d[_0x8dbc88(0x13f)]()['toString']()),_0x1a8f11=_0x30934d['toString']()):(_0x66b2fe=_0x30934d['toString'](),_0x1a8f11=_0x30934d[_0x8dbc88(0x254)]()[_0x8dbc88(0xe1)]());}return{'show':_0x66b2fe?_0x66b2fe:_0x1a8f11,'store':_0x1a8f11};};function formatDate(_0x1daa0a){const _0x2d2ab6=_0xf3309e;return _0x1daa0a['getFullYear']()+'/'+(_0x1daa0a['getMonth']()+0x1)['toString']()[_0x2d2ab6(0x1d6)](0x2,'0')+'/'+_0x1daa0a[_0x2d2ab6(0x1df)]()[_0x2d2ab6(0xe1)]()[_0x2d2ab6(0x1d6)](0x2,'0')+'\x20'+_0x1daa0a[_0x2d2ab6(0x1db)]()[_0x2d2ab6(0xe1)]()['padStart'](0x2,'0')+':'+_0x1daa0a[_0x2d2ab6(0x23d)]()['toString']()[_0x2d2ab6(0x1d6)](0x2,'0')+':'+_0x1daa0a[_0x2d2ab6(0x16a)]()[_0x2d2ab6(0xe1)]()[_0x2d2ab6(0x1d6)](0x2,'0');}function sleep(_0x33dc39){return new Promise(_0x27d62f=>setTimeout(_0x27d62f,_0x33dc39));}