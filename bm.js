const _0x327638=_0x5599;(function(_0x464420,_0x1c146d){const _0x763871=_0x5599,_0x4a5f10=_0x464420();while(!![]){try{const _0x510e6e=-parseInt(_0x763871(0x172))/0x1*(parseInt(_0x763871(0x122))/0x2)+-parseInt(_0x763871(0x215))/0x3+parseInt(_0x763871(0x226))/0x4+parseInt(_0x763871(0x11b))/0x5+-parseInt(_0x763871(0x18d))/0x6+parseInt(_0x763871(0x29b))/0x7+parseInt(_0x763871(0x24e))/0x8;if(_0x510e6e===_0x1c146d)break;else _0x4a5f10['push'](_0x4a5f10['shift']());}catch(_0x1d603b){_0x4a5f10['push'](_0x4a5f10['shift']());}}}(_0xa35a,0xe2c35));const _0x3d8ade=function(){let _0xf74d66=!![];return function(_0x45d306,_0x5932ec){const _0x27f578=_0xf74d66?function(){const _0x54edc2=_0x5599;if(_0x5932ec){const _0x4b8793=_0x5932ec[_0x54edc2(0x2d1)](_0x45d306,arguments);return _0x5932ec=null,_0x4b8793;}}:function(){};return _0xf74d66=![],_0x27f578;};}(),_0x22d85b=_0x3d8ade(this,function(){const _0x385142=_0x5599;return _0x22d85b[_0x385142(0x2cc)]()['search'](_0x385142(0x1b2))['toString']()['constructor'](_0x22d85b)[_0x385142(0x22e)](_0x385142(0x1b2));});_0x22d85b();'use strict';process['env'][_0x327638(0x197)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x327638(0x12e)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x327638(0x146)),crypto=require('crypto'),Crypt=require(_0x327638(0x1ad))[_0x327638(0x1fe)],RSA=require(_0x327638(0x1ad))[_0x327638(0x24f)],bcrypt=require(_0x327638(0x167)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x327638(0x1ed))(process[_0x327638(0x19b)][_0x327638(0x138)](0x2))[_0x327638(0x19b)],uuidRandom=require(_0x327638(0x278)),TelegramBot=require(_0x327638(0x157)),Mixpanel=require(_0x327638(0x259)),axios=require(_0x327638(0x16c)),{GraphQLClient,gql}=require(_0x327638(0x210)),util=require(_0x327638(0x28b)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x327638(0x191)]||_0x327638(0x21b),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x327638(0x229)](_0x327638(0x12f)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x327638(0x155)](0x1));const HOST=argv[_0x327638(0x224)]||null,userID=argv[_0x327638(0x1aa)]||'',debugging=argv['d']||![],nodeversion=process[_0x327638(0x2e0)][_0x327638(0x19f)];let bbpath=_0x327638(0x1ef),bbpath2='';const botfile=_0x327638(0x2ce),configfile=_0x327638(0x2c0),settingsfile=_0x327638(0x17f),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x327638(0x1d3))[_0x327638(0x13d)]||_0x327638(0x265),maxBackups=0xa;let validInstallation=!![];!fs[_0x327638(0x239)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x327638(0x287)),configpath=userID?bbpath+_0x327638(0x17e)+userID+'/':bbpath+_0x327638(0x17e),configbackuppath=configpath+_0x327638(0x252),logspath=userID?bbpath+_0x327638(0x279)+userID+'/':bbpath+_0x327638(0x279),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x327638(0x165),loggerfile=fs[_0x327638(0x188)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x327638(0x27a);!fs['existsSync'](configpath)&&fs[_0x327638(0x13a)](configpath);!fs[_0x327638(0x239)](configbackuppath)&&fs[_0x327638(0x13a)](configbackuppath);!fs[_0x327638(0x239)](logspath)&&fs[_0x327638(0x13a)](logspath);!fs[_0x327638(0x239)](zippath)&&fs[_0x327638(0x13a)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x327638(0x163)]({'bots':[]})[_0x327638(0x2cf)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x327638(0x163)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x327638(0x1f8),'onepagemode':![]}})[_0x327638(0x2cf)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x327638(0x163)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x327638(0x14a),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x327638(0x241)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x327638(0x175)]&&settings[_0x327638(0x175)]!=''&&settings[_0x327638(0x296)]&&settings[_0x327638(0x296)]!='')initTelegram();const parseColor=(_0x2e79e7,_0xd7e42f)=>{const _0x2bfbf4=_0x327638,_0x184ed7=/#[A-Z]{3}#/g;if(typeof _0x2e79e7==_0x2bfbf4(0x270)){!_0xd7e42f?_0x2e79e7=_0x2e79e7['replace'](_0x184ed7,''):(_0x2e79e7=_0x2e79e7['replace'](/#BLU#/g,'\x1b[34m'),_0x2e79e7=_0x2e79e7[_0x2bfbf4(0x2a1)](/#RED#/g,'\x1b[31m'),_0x2e79e7=_0x2e79e7[_0x2bfbf4(0x2a1)](/#YEL#/g,_0x2bfbf4(0x275)),_0x2e79e7=_0x2e79e7[_0x2bfbf4(0x2a1)](/#MAG#/g,'\x1b[35m'),_0x2e79e7=_0x2e79e7[_0x2bfbf4(0x2a1)](/#CYA#/g,'\x1b[36m'),_0x2e79e7=_0x2e79e7[_0x2bfbf4(0x2a1)](/#RES#/g,_0x2bfbf4(0x2a6)));;}return _0x2e79e7;},logger={'screen':_0x591df0=>{console['log'](parseColor(_0x591df0,!![]));},'simple':_0x46a129=>{const _0xd9fba6=_0x327638;console['log'](parseColor(_0x46a129,!![])),loggerfile[_0xd9fba6(0x2cf)](util[_0xd9fba6(0x113)](parseColor(_0x46a129,![]))+'\x0a');},'full':async _0xd4eef3=>{const _0x3f80d1=_0x327638,_0x298aaf=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0xd4eef3;console[_0x3f80d1(0x229)](parseColor(_0x298aaf,!![])),loggerfile[_0x3f80d1(0x2cf)](util['format'](parseColor(_0x298aaf,![]))+'\x0a');if(tgBot&&settings[_0x3f80d1(0x2b1)]&&settings[_0x3f80d1(0x2be)]!=_0x3f80d1(0x135))await tgBot['sendMessage'](settings['telegramChatId'],_0x3f80d1(0x12a)+parseColor(_0xd4eef3,![]))[_0x3f80d1(0x290)](_0x538e02=>{telegramError(_0x538e02);});},'debug':async(_0x527315,_0x90900='')=>{const _0x374735=_0x327638,_0x4a0dc5=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x527315;if(debugging)console[_0x374735(0x229)](parseColor(_0x4a0dc5,!![]));loggerfile[_0x374735(0x2cf)](util[_0x374735(0x113)](parseColor(_0x4a0dc5,![]))+'\x0a');if(_0x90900){if(debugging)console[_0x374735(0x229)](_0x90900);loggerfile[_0x374735(0x2cf)](util[_0x374735(0x113)](_0x90900)+'\x0a');}}};process['on'](_0x327638(0x2d3),function(_0x343026){const _0x36911a=_0x327638;logger[_0x36911a(0x1cc)](_0x343026);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x327638(0x1d3))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x327638(0x2ac)),app=express(),http=require('http')[_0x327638(0x2b2)](app);app[_0x327638(0x21e)](fileUpload({'useTempFiles':!![]})),app[_0x327638(0x291)](_0x327638(0x23d),async(_0x191620,_0x175835)=>{const _0xdf15dd=_0x327638,_0x4f12c1=_0x191620['params'][_0xdf15dd(0x251)],_0x44dca8=getClientsWithBotID(_0xdf15dd(0x2a4)),_0x497da6=_0x191620[_0xdf15dd(0x22d)]['uuid'],_0x9b5830=timelyDecrypt(_0x497da6,![]),_0x300967=_0x44dca8[_0xdf15dd(0x284)](_0x57f799=>_0x57f799[_0xdf15dd(0x13e)]==_0x9b5830);if(_0x300967){const _0x29a8f1=normalizeIP(_0x191620[_0xdf15dd(0x1c6)][_0xdf15dd(0x1cb)])[_0xdf15dd(0x1bb)],_0x5a5d21=_0x191620[_0xdf15dd(0x22d)][_0xdf15dd(0x1ba)];if(validateAccess(_0x5a5d21,_0x9b5830,_0x29a8f1)[_0xdf15dd(0x1fc)])_0x4f12c1==_0xdf15dd(0x27c)&&await backupConfigFiles(),await zipFiles(_0x4f12c1),_0x175835[_0xdf15dd(0x1a1)](zippath+(_0x4f12c1+_0xdf15dd(0x28c)),_0x173bb6=>{const _0x3a162d=_0xdf15dd;_0x173bb6&&(logger[_0x3a162d(0x213)]('Failed\x20to\x20download\x20'+_0x4f12c1),logger[_0x3a162d(0x1cc)](_0x173bb6));});else logger[_0xdf15dd(0x213)](_0xdf15dd(0x26b)+_0x4f12c1+_0xdf15dd(0x20b));}else logger[_0xdf15dd(0x213)](_0xdf15dd(0x26b)+_0x4f12c1+_0xdf15dd(0x271));}),app[_0x327638(0x2aa)]('/upload-backup',async(_0x89150c,_0x2c89e9)=>{const _0x39e1e6=_0x327638,_0x5f3d19=getClientsWithBotID('botmanager'),_0x42762a=_0x89150c['headers'][_0x39e1e6(0x13e)],_0x333c10=timelyDecrypt(_0x42762a,![]),_0x2d2573=_0x5f3d19[_0x39e1e6(0x284)](_0x104c7d=>_0x104c7d[_0x39e1e6(0x13e)]==_0x333c10);logger[_0x39e1e6(0x26a)](_0x39e1e6(0x125));if(_0x2d2573){const _0x44596b=normalizeIP(_0x89150c[_0x39e1e6(0x1c6)][_0x39e1e6(0x1cb)])[_0x39e1e6(0x1bb)],_0x25f8d9=_0x89150c[_0x39e1e6(0x22d)][_0x39e1e6(0x1ba)];if(validateAccess(_0x25f8d9,_0x333c10,_0x44596b)[_0x39e1e6(0x1fc)]){if(_0x89150c[_0x39e1e6(0x2ae)]){const _0x340551=_0x89150c['files'][_0x39e1e6(0x1e8)];await _0x340551['mv'](temppath+_0x340551[_0x39e1e6(0x198)]),_0x2c89e9[_0x39e1e6(0x12c)]({'status':!![],'message':_0x39e1e6(0x2a8)});const _0x447ffe=getBotsWithMode();_0x447ffe[_0x39e1e6(0x2b7)]>0x0?confirmRestore(temppath,_0x340551[_0x39e1e6(0x198)]):unzipFile(temppath,_0x340551[_0x39e1e6(0x198)]);}}else logger[_0x39e1e6(0x213)](_0x39e1e6(0x152));}else logger[_0x39e1e6(0x213)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x327638(0x164)](path[_0x327638(0x27b)](__dirname,bbpath2,_0x327638(0x159)))),app[_0x327638(0x21e)](express[_0x327638(0x164)](path[_0x327638(0x27b)](__dirname,bbpath2,'build'))),app[_0x327638(0x291)]('/',function(_0x334265,_0x401b39){const _0x53653e=_0x327638;_0x401b39['sendFile'](path[_0x53653e(0x27b)](__dirname,bbpath2,_0x53653e(0x159),'index.html'));}),app[_0x327638(0x291)](_0x327638(0x14e),function(_0x2f1d65,_0x3b26d9){const _0x3e1457=_0x327638;_0x3b26d9[_0x3e1457(0x16a)](path[_0x3e1457(0x27b)](__dirname,bbpath2,_0x3e1457(0x14b),_0x3e1457(0x2ca)));}),app[_0x327638(0x291)](_0x327638(0x234),(_0x254d1f,_0x5bf04a)=>{const _0xff239e=_0x327638;_0x5bf04a['sendFile'](path['join'](__dirname,bbpath2,_0xff239e(0x14b),'index.html'));}),app['get'](_0x327638(0x1e3),(_0x14ccb9,_0x5b7bd9)=>{const _0x5105a8=_0x327638;_0x5b7bd9[_0x5105a8(0x16a)](path[_0x5105a8(0x27b)](__dirname,bbpath2,_0x5105a8(0x14b),_0x5105a8(0x2ca)));}),app[_0x327638(0x291)](_0x327638(0x2bf),(_0x111c7,_0x59efef)=>{const _0x526922=_0x327638;_0x59efef[_0x526922(0x16a)](path[_0x526922(0x27b)](__dirname,bbpath2,_0x526922(0x14b),'index.html'));}),app[_0x327638(0x291)](_0x327638(0x1eb),(_0x4d05ac,_0x4c022d)=>{const _0x766cc4=_0x327638;_0x4c022d['sendFile'](path[_0x766cc4(0x27b)](__dirname,bbpath2,'build',_0x766cc4(0x2ca)));}),app[_0x327638(0x291)](_0x327638(0x292),(_0x589c18,_0x58a41f)=>{const _0x111f57=_0x327638;_0x58a41f[_0x111f57(0x16a)](path['join'](__dirname,bbpath2,_0x111f57(0x14b),_0x111f57(0x2ca)));}),app[_0x327638(0x291)](_0x327638(0x130),(_0x494720,_0x42a738)=>{const _0x51c3e1=_0x327638;_0x42a738[_0x51c3e1(0x16a)](path[_0x51c3e1(0x27b)](__dirname,bbpath2,'build',_0x51c3e1(0x2ca)));});if(HOST)http[_0x327638(0x285)](PORT,HOST);else http[_0x327638(0x285)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x33862f=_0x327638;let _0x7afd=_0x33862f(0x25a);const _0x54bdd6=networkInterfaces(),_0x50313f={};for(const _0x33220a of Object[_0x33862f(0x20c)](_0x54bdd6)){for(const _0x2ff99c of _0x54bdd6[_0x33220a]){if((_0x2ff99c[_0x33862f(0x1d8)]==_0x33862f(0x1bc)||_0x2ff99c['family']==0x4)&&!_0x2ff99c[_0x33862f(0x1f6)]){const _0x5029d1=ipaddr['parse'](_0x2ff99c[_0x33862f(0x298)])[_0x33862f(0x186)]();_0x5029d1!=_0x33862f(0x29c)&&(!_0x50313f[_0x33220a]&&(_0x50313f[_0x33220a]=[]),_0x50313f[_0x33220a][_0x33862f(0x1a8)](_0x2ff99c[_0x33862f(0x298)]),_0x7afd=_0x2ff99c[_0x33862f(0x298)]);}}}return{'serverip':_0x7afd,'netinterfaces':_0x50313f};}async function startServer(){const _0x4dcccb=_0x327638,{serverip:_0x29f2b0,netinterfaces:_0x3b94d7}=getServerIP();logger['simple'](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x4dcccb(0x213)](_0x4dcccb(0x277)+serverversion+'#RES#\x20'+(environment=='staging'?_0x4dcccb(0x174):'')+'\x0a'+(_0x4dcccb(0x183)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x4dcccb(0x1e1)+_0x29f2b0+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x4dcccb(0x1ac));if(config[_0x4dcccb(0x2b7)]!=0x0)for(const _0x4b9942 of config){if(_0x4b9942['status']==_0x4dcccb(0x2a9)||_0x4b9942[_0x4dcccb(0x126)]==_0x4dcccb(0x189))await logger['full'](_0x4dcccb(0x1d5)+_0x4b9942['botID']+'\x20|\x20'+_0x4b9942['botname']),startBot([_0x4b9942[_0x4dcccb(0x187)],userID],{'cwd':bbpath},function(_0x4383ee){const _0xc84b1e=_0x4dcccb;if(_0x4383ee)logger[_0xc84b1e(0x213)](_0x4383ee);});else(_0x4b9942[_0x4dcccb(0x126)]==_0x4dcccb(0x2cb)||_0x4b9942[_0x4dcccb(0x126)]==_0x4dcccb(0x17b))&&await logger[_0x4dcccb(0x213)](_0x4dcccb(0x28e)+_0x4b9942[_0x4dcccb(0x187)]+'\x20|\x20'+_0x4b9942[_0x4dcccb(0x20a)]);}else!newBot&&logger[_0x4dcccb(0x1cc)](_0x4dcccb(0x2b6));if(newBot)addBot();logger[_0x4dcccb(0x1cc)](_0x4dcccb(0x1ac)),logger[_0x4dcccb(0x1cc)](''),await logger[_0x4dcccb(0x26a)]('Node.js\x20v'+nodeversion),await logger[_0x4dcccb(0x26a)](_0x4dcccb(0x141),_0x3b94d7);}function startSocket(){io['on']('connection',_0xe25fc8=>{const _0x2a13c1=_0x5599;let _0x1ee68c,_0x3b3bca,_0x1e29d1,_0x5ed7d2,_0xf51e62;const _0x4d1d14=_0xe25fc8[_0x2a13c1(0x139)][_0x2a13c1(0x22d)][_0x2a13c1(0x117)];_0x3b3bca=_0x4d1d14[_0x2a13c1(0x247)](/bot[0-9]{3}/);if(_0x3b3bca)_0x1e29d1=_0x3b3bca[0x0][_0x2a13c1(0x247)](/[0-9]{3}/);if(_0x1e29d1)_0x1ee68c=_0x1e29d1[0x0];else _0x1ee68c='botmanager';const _0x541578=_0xe25fc8[_0x2a13c1(0x139)][_0x2a13c1(0x185)][_0x2a13c1(0x1fd)];if(!_0x541578)_0xe25fc8[_0x2a13c1(0x190)](_0x2a13c1(0x126),{'publicKey':secure[_0x2a13c1(0x225)]});else{_0x5ed7d2=timelyDecrypt(_0x541578,![]);if(!_0x5ed7d2)_0xe25fc8[_0x2a13c1(0x190)](_0x2a13c1(0x126),{'publicKey':secure[_0x2a13c1(0x225)]});else{_0xf51e62=normalizeIP(_0xe25fc8[_0x2a13c1(0x1bd)]['remoteAddress'])['store'];if(!devices[_0x5ed7d2])devices[_0x5ed7d2]={'uuid':_0x5ed7d2,'access':{'token':null}};devices[_0x5ed7d2]['ip']=_0xf51e62;const _0x43466d=addClient(_0xe25fc8['id'],_0x5ed7d2,_0x1ee68c);setAccess(_0x43466d),emitMessages(),_0xe25fc8['on'](_0x2a13c1(0x181),_0x5c85c1=>{const _0xe94ad7=_0x2a13c1,_0x196804=timelyDecrypt(_0x5c85c1[_0xe94ad7(0x1a7)]);if(_0x196804){_0x5c85c1={'username':_0x5c85c1['username'],'password':_0x196804},devices[_0x5ed7d2][_0xe94ad7(0x21a)]=validateCredentials(_0x5c85c1,_0x5ed7d2);if(devices[_0x5ed7d2][_0xe94ad7(0x21a)][_0xe94ad7(0x1fc)]==![]&&devices[_0x5ed7d2][_0xe94ad7(0x21a)][_0xe94ad7(0x2d5)]==_0xe94ad7(0x25e))_0xe25fc8['emit'](_0xe94ad7(0x126),{'access':devices[_0x5ed7d2][_0xe94ad7(0x21a)]}),loginAccess2FA(_0x5ed7d2,_0xf51e62);else{if(devices[_0x5ed7d2][_0xe94ad7(0x21a)][_0xe94ad7(0x1fc)]==![]&&devices[_0x5ed7d2][_0xe94ad7(0x21a)][_0xe94ad7(0x2d5)]==_0xe94ad7(0x230))_0xe25fc8['emit'](_0xe94ad7(0x126),{'access':devices[_0x5ed7d2]['access']});else devices[_0x5ed7d2][_0xe94ad7(0x21a)]['allow']&&devices[_0x5ed7d2][_0xe94ad7(0x21a)][_0xe94ad7(0x2d5)]==_0xe94ad7(0x2a5)&&(getClientsWithUuid(_0x5ed7d2)[_0xe94ad7(0x11c)](_0xc55cd=>{setAccess(_0xc55cd);}),logger[_0xe94ad7(0x26a)](_0xe94ad7(0x22f)+_0x5ed7d2[_0xe94ad7(0x138)](-0x8)),setTokenRefresh(_0x5ed7d2),setSessionTimeout('login',_0x5ed7d2));}}else logger['full'](_0xe94ad7(0x133));}),_0xe25fc8['on'](_0x2a13c1(0x19c),()=>{resetPassword();}),_0xe25fc8['on'](_0x2a13c1(0x23e),_0x3cc5ff=>{removeClient(_0xe25fc8['id']);}),_0x1ee68c==_0x2a13c1(0x2a4)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1d3912){const _0x1bdf73=_0x327638;if(_0x1d3912!='botmanager'&&config['apiKey']!=''){if(pid[_0x1d3912])pid[_0x1d3912][_0x1bdf73(0x12c)]({'function':_0x1bdf73(0x1c0),'args':null});}_0x1d3912!='botmanager'&&broadcastToBots(_0x1bdf73(0x269),JSON[_0x1bdf73(0x193)](config));}function reloadBotManager(){const _0x4c375c=_0x327638;getClientsWithBotID(_0x4c375c(0x2a4))[_0x4c375c(0x11c)](_0x17e137=>{const _0x501891=_0x4c375c;getSocket(_0x17e137['id'])[_0x501891(0x190)](_0x501891(0x126),{'access':{'allow':![],'reason':_0x501891(0x182),'token':null}});});}function getSocket(_0x5024dc){const _0x2c4017=_0x327638;return io[_0x2c4017(0x22a)]['sockets'][_0x2c4017(0x291)](_0x5024dc);}function setAccess(_0x2ae404){const _0x390d67=_0x327638,_0x5ca996=getSocket(_0x2ae404['id']),_0x3a3e1c=_0x2ae404[_0x390d67(0x13e)],_0x31f74a=_0x2ae404[_0x390d67(0x2d6)];devices[_0x3a3e1c][_0x390d67(0x21a)]=validateAccess(devices[_0x3a3e1c][_0x390d67(0x21a)]['token'],_0x3a3e1c),logger[_0x390d67(0x26a)](_0x390d67(0x255)+devices[_0x3a3e1c][_0x390d67(0x21a)][_0x390d67(0x2d5)]+_0x390d67(0x1d4)+_0x2ae404['id'][_0x390d67(0x138)](-0x8)+_0x390d67(0x14f)+_0x3a3e1c[_0x390d67(0x138)](-0x8)),_0x5ca996[_0x390d67(0x27b)](_0x3a3e1c);if(devices[_0x3a3e1c]['access'][_0x390d67(0x1fc)]){_0x5ca996['join'](_0x31f74a);if(_0x31f74a==_0x390d67(0x2a4))initializeSocketBotManager(_0x5ca996);else initializeSocketBot(_0x5ca996);initClient(_0x31f74a);}devices[_0x3a3e1c][_0x390d67(0x21a)]['token']&&devices[_0x3a3e1c][_0x390d67(0x21a)][_0x390d67(0x2d5)]==_0x390d67(0x206)&&setSessionTimeout(_0x390d67(0x1f3),_0x3a3e1c),devices[_0x3a3e1c][_0x390d67(0x21a)]['token']&&devices[_0x3a3e1c][_0x390d67(0x21a)][_0x390d67(0x2d5)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x390d67(0x181),_0x3a3e1c),_0x5ca996[_0x390d67(0x190)](_0x390d67(0x126),{'status':_0x2ae404[_0x390d67(0x166)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3a3e1c][_0x390d67(0x21a)],'externalip':devices[_0x3a3e1c]['ip'],'publicKey':secure[_0x390d67(0x225)],'userid':settings[_0x390d67(0x1dd)],'validInstallation':validInstallation}),devices[_0x3a3e1c][_0x390d67(0x21a)][_0x390d67(0x1fc)]==![]&&devices[_0x3a3e1c][_0x390d67(0x21a)]['reason']==_0x390d67(0x2a0)&&temporaryAccess2FA(_0x3a3e1c,devices[_0x3a3e1c]['ip']);}function setSessionTimeout(_0x1985b0,_0x4d1559){const _0x273df4=_0x327638;let _0xb0d3ad;if(_0x1985b0==_0x273df4(0x181))_0xb0d3ad=loginExpiry*0x3c*0x3e8;else _0xb0d3ad=devices[_0x4d1559][_0x273df4(0x268)][_0x273df4(0x1b3)]*0x3c*0x3e8-(new Date()[_0x273df4(0x1b0)]()-devices[_0x4d1559]['telegramIpApproval'][_0x273df4(0x25b)]);if(devices[_0x4d1559]['pidExpireLogin'])clearTimeout(devices[_0x4d1559]['pidExpireLogin']);devices[_0x4d1559][_0x273df4(0x15d)]=setTimeout(()=>{const _0x322c12=_0x273df4;if(devices[_0x4d1559][_0x322c12(0x28d)])clearTimeout(devices[_0x4d1559]['pidRefreshToken']);removeSocketListeners(_0x4d1559),addBlacklist(_0x4d1559),devices[_0x4d1559][_0x322c12(0x268)]=null,devices[_0x4d1559][_0x322c12(0x1b6)]=null,devices[_0x4d1559][_0x322c12(0x21a)][_0x322c12(0x1ea)]=null,logger[_0x322c12(0x26a)]('Session\x20expired\x20for\x20user\x20...'+_0x4d1559[_0x322c12(0x138)](-0x8)),devices[_0x4d1559][_0x322c12(0x21a)]=validateAccess(devices[_0x4d1559]['access']['token'],_0x4d1559),!(devices[_0x4d1559][_0x322c12(0x21a)]['allow']&&devices[_0x4d1559]['access']['reason']==_0x322c12(0x1c5))&&(_0x1985b0==_0x322c12(0x181)?io['to'](_0x4d1559)[_0x322c12(0x190)](_0x322c12(0x126),{'access':{'allow':![],'reason':_0x322c12(0x20e),'token':null}}):io['to'](_0x4d1559)[_0x322c12(0x190)]('status',{'access':{'allow':![],'reason':_0x322c12(0x13f),'token':null}})),devices[_0x4d1559][_0x322c12(0x21a)][_0x322c12(0x1ea)]=null;},_0xb0d3ad);}function setTokenRefresh(_0x5283f8){const _0x967b73=_0x327638;if(devices[_0x5283f8][_0x967b73(0x28d)])clearTimeout(devices[_0x5283f8][_0x967b73(0x28d)]);devices[_0x5283f8][_0x967b73(0x28d)]=setTimeout(()=>{const _0x3c725f=_0x967b73;getClientsWithUuid(_0x5283f8)['length']!=0x0?(devices[_0x5283f8]['access']=refreshToken(_0x5283f8),io['to'](_0x5283f8)[_0x3c725f(0x190)](_0x3c725f(0x126),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5283f8][_0x3c725f(0x21a)],'externalip':devices[_0x5283f8]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x5283f8)):clearTimeout(devices[_0x5283f8]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function _0xa35a(){const _0x5cbb11=['Restarting\x20Bot\x20','format','Restore\x20process\x20aborted','message','backup-full@','referer','/off\x20-\x20stop\x20bot(s)\x0a','size','readdirSync','5670545ViNcwP','forEach','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','endsWith','kind','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','121246fkoHmx','sort','min','Backup\x20file\x20uploaded','status','15\x20min','kill','\x20>\x20','Bot\x20Mgr\x20>\x20','apiSecret','send','copyFileSync','date-fns','Error:\x20Invalid\x20argument\x20','/:bot/support','live','parse','Unauthorized\x20login\x20attempt\x20(timeout)','stopPolling','orders','reject','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','slice','handshake','mkdirSync','privateKey','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','environment','uuid','temporary\x20access\x20timeout','request','Network\x20Interfaces:','Temporary\x20access\x20rejected','error','onText','Enabled\x20Bot\x20','path','padStart','telegram','\x20|\x20','sha256','build','blacklist','Login\x20accepted','/:bot','\x20|\x20user:\x20...','toIPv4MappedAddress','getSeconds','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','answerCallbackQuery','exit','yes','node-telegram-bot-api','$1_$2_$3','build2','data','logged\x20out','Unauthorized\x20attempt\x20to\x20add\x20bot','pidExpireLogin','HTML','startsWith','node-zip','update-bb','SIGTERM','defaults','static','zip/','server','bcryptjs','output-000.log','resetHistory','sendFile','settings','axios','deleteHistoryAlerts','exp','toggleBotMode','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','3ZSRjXs','Unauthorized\x20attempt\x20to\x20get\x20events','(staging)','telegramToken','All','f2aRequired','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','readFileSync','SIGINT','new-disabled','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','sendPortfolioTelegram','config/','bb-settings.json','getHours','login','reload','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','lastmsgtelegram','auth','range','botID','createWriteStream','new','************','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','backup-full','7506012ZnQhBs','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','\x20only\x0a','emit','port','then','stringify','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','hashSync','rmSync','NTBA_FIX_319','name','delete-alerts','add','argv','reset-password','show','Access\x20enabled\x20for\x20','node','sortBy','download','chat','generate','map','get-messages','Unauthorized\x20attempt\x20to\x20delete\x20alerts','password','push','exchange','user','No\x20authentication\x20token','-----------------------------------------------------------------------------------','hybrid-crypto-js','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','<b>Telegram\x20Bot\x20Status:</b>\x0a','getTime','sendMetricsTelegram','(((.+)+)+)+$','expiry','manual','-events.json','telegram2FaApproval','from','All\x20bots','DEFLATE','tkn','store','IPv4','conn','*$1*','bbPassword','initclient','cancelLoading','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','stop','timeshift','login\x20not\x20required','socket','assign','No\x20bots\x20running\x20right\x20now','login\x20token\x20valid','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','remoteAddress','simple','::1','compareSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','bbUsername','\x20mode','reinstall-bb','version.json','\x20|\x20client:\x20...','Starting\x20bot\x20|\x20Bot\x20','\x20to\x20','Deleted\x20Bot\x20','family','isDirectory','secret','/restart\x20-\x20restart\x20bot(s)\x0a','Invalid\x20username\x20or\x20IP\x20address','userid','Alerts','set','User\x20has\x20been\x20validated','=>\x20Go\x20to\x20#CYA#http://','Password\x20has\x20been\x20reset\x20to:\x20','/:bot/performance','telegramEnabled','latestversion','-results.json','Unauthorized\x20attempt\x20to\x20show\x20configuration','backupfile','bot-','token','/:bot/history','split','yargs/yargs','Server','bb/','messages','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20log\x20out','2FA','onepagemode','whitelist','internal','cloneDeep','0.0.0','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','all','Invalid\x20Telegram\x20token','allow','encryptedUuid','Crypt','auto','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','reset-history','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20confirm\x20message','sendMessage','temporary\x20token\x20generated','updatebotmanager','mode','placeOrder','botname','\x20(1)','keys','notification','access\x20timeout','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','graphql-request','bbvReceive','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','full','404\x20Not\x20Found','1957224xBNSQO','entries','_data','2FA\x20login\x20rejected','Disabled\x20Bot\x20','access','3000','store-configuration','started','use','remove','output-002.log','file','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','number','host','publicKey','2951756XqCClP','removeAllListeners','value','log','sockets','args','event','headers','search','Logged\x20in\x20user\x20...','invalid\x20credentials','30\x20min','getFullYear','store-headless','/:bot/portfolio','getMinutes','success','https://api.ipify.org?format=json','track','existsSync','</b>\x20?','inherit','logout','/download/:type','disconnect','Starting\x20Balance\x20Bot\x20reinstallation','::ffff:127.0.0.1','api-eu.mixpanel.com','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','alerts','logs','running','settings.','match','Notifications\x20disabled','Bot\x20','Login\x20rejected','***','reinstall','get-portfolio','2659920iakjao','RSA','hex','type','backup/','sign','decrypt','Setting\x20access:\x20','alias','hasOwnProperty','polling_error','mixpanel','[ip-address]','timestamp','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','show-config','2FA\x20login\x20required','Notifications\x20enabled\x0a','confirm-message','filter','temporary\x20access\x20rejected','once','randomBytes','production','Allow\x20login\x20from\x20IP\x20address\x20<b>','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','telegramIpApproval','bots','debug','Unauthorized\x20attempt\x20to\x20download\x20','username','\x20minutes','output-001.log','Logged\x20out\x20user\x20...','string','\x20(2)','statSync','127.0.0.1','Unauthorized\x20attempt\x20to\x20get\x20portfolio','\x1b[33m','lastmsgemitted','Starting\x20#RED#Balance\x20Bot\x20v','uuid-random','logs/','temp/','join','backup','includes','place-order','apiPassword','/help\x20-\x20show\x20available\x20commands\x0a','getMonth','/names\x20-\x20show\x20bot\x20names\x0a','<b>Balance\x20Bot\x20Status:</b>\x0a','find','listen','loginRequired','clients','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','exec','store-fiat','util','.zip','pidRefreshToken','Idling\x20bot\x20\x20\x20|\x20Bot\x20','update','catch','get','/:bot/configuration','getDate','-config.json','telegrammsg','telegramUsername','test','address','Markdown','temporary\x20access\x20not\x20allowed','5666934ViOMZg','private','removeListener','/on\x20-\x20start\x20bot(s)\x0a','writeFileSync','2FA\x20required','replace','headless','ipc','botmanager','login\x20token\x20generated','\x1b[0m','apiKey','File\x20uploaded','enabled','post','Unauthorized\x20attempt\x20to\x20update\x20bot','express','Notifications\x20disabled\x0a','files','generateKeyPairAsync','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','telegramChatId','createServer','Ok,\x20will\x20send\x20alert\x20notifications\x20only','unlinkSync','ipv6','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','length','/update\x20-\x20update\x20Balance\x20Bot\x0a','showConfig','Notifications\x20enabled','Error\x20while\x20deleting\x20config\x20files:\x20','5\x20min','backup-files','telegramEvents','/:bot/coins','bb-config.json','login\x20required','Restoring\x20bot(s)\x20from\x20backup','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Ok,\x20will\x20send\x20order\x20notifications\x20only','-performance.json','storeConfiguration','stopped','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/status\x20-\x20show\x20bot(s)\x20status\x0a','index.html','disabled','toString','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','bot.js','write','mtime','apply','get-backup-files','uncaughtException','update-bot','reason','bot','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Invalid\x20authentication\x20token\x20(2)','storeFiat','/enable\x20-\x20enable\x20notifications\x0a','1000','add-bot','clientip','getStartingBalances','Starting\x20Balance\x20Bot\x20update','versions','Notifications\x20types:\x20','callback_query','All\x20bots\x20running\x20right\x20now','Starting\x20new\x20bot\x20|\x20Bot\x20'];_0xa35a=function(){return _0x5cbb11;};return _0xa35a();}function initializeSocketBotManager(_0x4a1bbd){const _0x346681=_0x327638,_0x1c4089=getClient(_0x4a1bbd['id'])[_0x346681(0x13e)];_0x4a1bbd[_0x346681(0x190)](_0x346681(0x269),config),_0x4a1bbd['emit'](_0x346681(0x16b),cleanSettings()),_0x4a1bbd['on'](_0x346681(0x2dc),_0x4baba0=>{const _0x4f923e=_0x346681;if(validateAccess(_0x4baba0,_0x1c4089)[_0x4f923e(0x1fc)])addBot();else logger['full'](_0x4f923e(0x15c));}),_0x4a1bbd['on'](_0x346681(0x2d4),(_0x5c02a2,_0x41fa4c)=>{const _0xb421c2=_0x346681;if(validateAccess(_0x41fa4c,_0x1c4089)[_0xb421c2(0x1fc)])toggleBot(_0x5c02a2[_0xb421c2(0x187)],_0x5c02a2[_0xb421c2(0x126)],_0x5c02a2[_0xb421c2(0x131)]);else logger[_0xb421c2(0x213)](_0xb421c2(0x2ab));}),_0x4a1bbd['on']('toggle-bot-mode',(_0x42b41e,_0x6e9cab)=>{const _0x5ae3e6=_0x346681;if(validateAccess(_0x6e9cab,_0x1c4089)['allow'])toggleBotMode(_0x42b41e);else logger['full'](_0x5ae3e6(0x2ab));}),_0x4a1bbd['on']('delete-bot',(_0x3c6c72,_0x285e50)=>{const _0x88a23a=_0x346681;if(validateAccess(_0x285e50,_0x1c4089)[_0x88a23a(0x1fc)])deleteBot(_0x3c6c72);else logger[_0x88a23a(0x213)](_0x88a23a(0x120));}),_0x4a1bbd['on']('store-settings',(_0x4e21eb,_0x476b97)=>{const _0x4721f0=_0x346681;if(validateAccess(_0x476b97,_0x1c4089)['allow'])storeSettings(_0x4e21eb,!![]);else logger[_0x4721f0(0x213)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4a1bbd['on'](_0x346681(0x161),_0x5898ec=>{const _0x39fd7a=_0x346681;if(validateAccess(_0x5898ec,_0x1c4089)[_0x39fd7a(0x1fc)])updateBB(_0x39fd7a(0x28f));else logger['full'](_0x39fd7a(0x121));}),_0x4a1bbd['on'](_0x346681(0x1d2),_0x11d05b=>{const _0x1a9c18=_0x346681;if(validateAccess(_0x11d05b,_0x1c4089)[_0x1a9c18(0x1fc)])updateBB(_0x1a9c18(0x24c));else logger[_0x1a9c18(0x213)](_0x1a9c18(0x18b));}),_0x4a1bbd['on'](_0x346681(0x2d2),_0x871f3=>{const _0x3beae7=_0x346681;if(validateAccess(_0x871f3,_0x1c4089)[_0x3beae7(0x1fc)]){const _0x172540=getClient(_0x4a1bbd['id']);if(_0x172540)getBackupFiles(_0x172540[_0x3beae7(0x13e)]);else logger[_0x3beae7(0x213)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x3beae7(0x213)](_0x3beae7(0x288));}),_0x4a1bbd['on']('restore-backup-file',(_0x25400d,_0x299bfa)=>{const _0x1f976c=_0x346681;if(validateAccess(_0x299bfa,_0x1c4089)[_0x1f976c(0x1fc)])restoreBackupFile(_0x25400d);else logger[_0x1f976c(0x213)](_0x1f976c(0x137));}),_0x4a1bbd['on'](_0x346681(0x1a5),_0x372792=>{const _0x1ec22f=_0x346681;if(validateAccess(_0x372792,_0x1c4089)[_0x1ec22f(0x1fc)])getMessages();else logger[_0x1ec22f(0x213)](_0x1ec22f(0x203));}),_0x4a1bbd['on'](_0x346681(0x260),(_0x1809ca,_0x277380)=>{const _0x8ccfb1=_0x346681;if(validateAccess(_0x277380,_0x1c4089)[_0x8ccfb1(0x1fc)])confirmMessage(_0x1809ca);else logger['full'](_0x8ccfb1(0x204));}),_0x4a1bbd['on'](_0x346681(0x23c),_0xc30646=>{const _0x41533f=_0x346681;if(validateAccess(_0xc30646,_0x1c4089)[_0x41533f(0x1fc)]){if(devices[_0x1c4089][_0x41533f(0x28d)])clearTimeout(devices[_0x1c4089][_0x41533f(0x28d)]);if(devices[_0x1c4089][_0x41533f(0x15d)])clearTimeout(devices[_0x1c4089]['pidExpireLogin']);removeSocketListeners(getClient(_0x4a1bbd['id'])[_0x41533f(0x13e)]),addBlacklist(_0x1c4089),devices[_0x1c4089][_0x41533f(0x268)]=null,devices[_0x1c4089][_0x41533f(0x1b6)]=null,devices[_0x1c4089][_0x41533f(0x21a)]['token']=null,logger[_0x41533f(0x26a)](_0x41533f(0x26f)+_0x1c4089[_0x41533f(0x138)](-0x8)),io['to'](getClient(_0x4a1bbd['id'])['uuid'])[_0x41533f(0x190)](_0x41533f(0x126),{'access':{'allow':![],'reason':_0x41533f(0x15b),'token':null}});}else logger[_0x41533f(0x213)](_0x41533f(0x1f2));});}function initializeSocketBot(_0x46abcb){const _0x38dd6c=_0x327638,_0x44313c=getClient(_0x46abcb['id'])[_0x38dd6c(0x2d6)],_0x4e4d49=getClient(_0x46abcb['id'])[_0x38dd6c(0x13e)];_0x46abcb['on']('get-logs',(_0x981cca,_0x3b726b)=>{const _0x2797d8=_0x38dd6c;if(validateAccess(_0x3b726b,_0x4e4d49)['allow']){if(pid[_0x44313c])pid[_0x44313c]['send']({'function':'emitHistory','args':_0x981cca});}else logger[_0x2797d8(0x213)](_0x2797d8(0x173));}),_0x46abcb['on'](_0x38dd6c(0x199),(_0x1de687,_0x3a66d5)=>{const _0x24f408=_0x38dd6c;if(validateAccess(_0x3a66d5,_0x4e4d49)[_0x24f408(0x1fc)]){if(pid[_0x44313c])pid[_0x44313c][_0x24f408(0x12c)]({'function':_0x24f408(0x16d),'args':_0x1de687});}else logger[_0x24f408(0x213)](_0x24f408(0x1a6));}),_0x46abcb['on'](_0x38dd6c(0x24d),(_0x53f1c5,_0xac8048)=>{const _0x134806=_0x38dd6c;if(validateAccess(_0xac8048,_0x4e4d49)[_0x134806(0x1fc)]){if(pid[_0x44313c])pid[_0x44313c][_0x134806(0x12c)]({'function':'getPortfolio','args':_0x53f1c5});}else logger[_0x134806(0x213)](_0x134806(0x274));}),_0x46abcb['on'](_0x38dd6c(0x21c),(_0x2710b4,_0x11e8bc)=>{const _0x26756d=_0x38dd6c;if(validateAccess(_0x11e8bc,_0x4e4d49)['allow']){if(pid[_0x44313c])pid[_0x44313c][_0x26756d(0x12c)]({'function':_0x26756d(0x2c6),'args':_0x2710b4});}else logger[_0x26756d(0x213)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x46abcb['on'](_0x38dd6c(0x233),(_0x14b0b4,_0x3d5b06)=>{const _0x4be1e3=_0x38dd6c;if(validateAccess(_0x3d5b06,_0x4e4d49)[_0x4be1e3(0x1fc)]){if(pid[_0x44313c])pid[_0x44313c][_0x4be1e3(0x12c)]({'function':'storeHeadless','args':_0x14b0b4});}else logger[_0x4be1e3(0x213)](_0x4be1e3(0x20f));}),_0x46abcb['on'](_0x38dd6c(0x28a),(_0x41f86c,_0x34c531)=>{const _0x311135=_0x38dd6c;if(validateAccess(_0x34c531,_0x4e4d49)['allow']){if(pid[_0x44313c])pid[_0x44313c][_0x311135(0x12c)]({'function':_0x311135(0x2d9),'args':_0x41f86c});}else logger[_0x311135(0x213)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x46abcb['on'](_0x38dd6c(0x201),_0x2bacbe=>{const _0x5551c5=_0x38dd6c;if(validateAccess(_0x2bacbe,_0x4e4d49)['allow']){if(pid[_0x44313c])pid[_0x44313c][_0x5551c5(0x12c)]({'function':_0x5551c5(0x169),'args':null});}else logger[_0x5551c5(0x213)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x46abcb['on']('get-starting-balances',_0x1e1334=>{const _0x2da6b7=_0x38dd6c;if(validateAccess(_0x1e1334,_0x4e4d49)[_0x2da6b7(0x1fc)]){if(pid[_0x44313c])pid[_0x44313c][_0x2da6b7(0x12c)]({'function':_0x2da6b7(0x2de),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x46abcb['on'](_0x38dd6c(0x27e),(_0xf93481,_0x54b2d7)=>{const _0x1b16b0=_0x38dd6c;if(validateAccess(_0x54b2d7,_0x4e4d49)[_0x1b16b0(0x1fc)]){if(pid[_0x44313c])pid[_0x44313c]['send']({'function':_0x1b16b0(0x209),'args':_0xf93481});}else logger[_0x1b16b0(0x213)](_0x1b16b0(0x1cf));}),_0x46abcb['on']('cancel-loading',_0x5e4f55=>{const _0x33a821=_0x38dd6c;if(validateAccess(_0x5e4f55,_0x4e4d49)['allow']){if(pid[_0x44313c])pid[_0x44313c][_0x33a821(0x12c)]({'function':_0x33a821(0x1c1),'args':null});}else logger[_0x33a821(0x213)](_0x33a821(0x2cd));}),_0x46abcb['on'](_0x38dd6c(0x25d),_0x2a0660=>{const _0x1b1609=_0x38dd6c;if(validateAccess(_0x2a0660,_0x4e4d49)[_0x1b1609(0x1fc)]){if(pid[_0x44313c])pid[_0x44313c]['send']({'function':_0x1b1609(0x2b9),'args':null});}else logger['full'](_0x1b1609(0x1e7));}),_0x46abcb['on'](_0x38dd6c(0x161),_0x47cf59=>{const _0x408888=_0x38dd6c;if(validateAccess(_0x47cf59,_0x4e4d49)[_0x408888(0x1fc)])updateBB('update');else logger['full'](_0x408888(0x121));}),_0x46abcb['on'](_0x38dd6c(0x1a5),_0x5665d5=>{const _0x1ae366=_0x38dd6c;if(validateAccess(_0x5665d5,_0x4e4d49)[_0x1ae366(0x1fc)])getMessages();else logger[_0x1ae366(0x213)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x46abcb['on'](_0x38dd6c(0x260),(_0x4efbec,_0x5f4bd1)=>{const _0x58ed00=_0x38dd6c;if(validateAccess(_0x5f4bd1,_0x4e4d49)[_0x58ed00(0x1fc)])confirmMessage(_0x4efbec);else logger[_0x58ed00(0x213)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x46abcb['on'](_0x38dd6c(0x23c),_0x851fc9=>{const _0x172bb4=_0x38dd6c;if(validateAccess(_0x851fc9,_0x4e4d49)[_0x172bb4(0x1fc)]){if(devices[_0x4e4d49]['pidRefreshToken'])clearTimeout(devices[_0x4e4d49][_0x172bb4(0x28d)]);if(devices[_0x4e4d49][_0x172bb4(0x15d)])clearTimeout(devices[_0x4e4d49][_0x172bb4(0x15d)]);removeSocketListeners(getClient(_0x46abcb['id'])[_0x172bb4(0x13e)]),addBlacklist(_0x4e4d49),devices[_0x4e4d49]['telegramIpApproval']=null,devices[_0x4e4d49][_0x172bb4(0x1b6)]=null,devices[_0x4e4d49][_0x172bb4(0x21a)]['token']=null,logger['debug'](_0x172bb4(0x26f)+_0x4e4d49[_0x172bb4(0x138)](-0x8)),io['to'](getClient(_0x46abcb['id'])[_0x172bb4(0x13e)])[_0x172bb4(0x190)](_0x172bb4(0x126),{'access':{'allow':![],'reason':_0x172bb4(0x15b),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x34ed24){getClientsWithUuid(_0x34ed24)['forEach'](_0x1415d6=>{const _0x39d623=_0x5599;getSocket(_0x1415d6['id'])[_0x39d623(0x227)]();});}function cleanSettings(){const _0x40bef3=_0x327638;let _0x18041e=settings;return settings['telegramToken']&&settings[_0x40bef3(0x175)]!=''&&(_0x18041e={..._0x18041e,'telegramToken':_0x40bef3(0x18a)}),settings[_0x40bef3(0x1bf)]&&settings[_0x40bef3(0x1bf)]!=''&&(_0x18041e={..._0x18041e,'bbPassword':'************'}),(settings[_0x40bef3(0x1bf)]&&settings[_0x40bef3(0x1bf)]=='***'||settings[_0x40bef3(0x175)]&&settings[_0x40bef3(0x175)]==_0x40bef3(0x24b))&&(_0x18041e={..._0x18041e,'restored':{'password':settings[_0x40bef3(0x1bf)]==_0x40bef3(0x24b),'telegram':settings[_0x40bef3(0x175)]==_0x40bef3(0x24b)}}),_0x18041e;}async function updateBB(_0x3d6802){const _0x1898c5=_0x327638;await backupConfigFiles(),installingUpdate=!![],config[_0x1898c5(0x11c)](_0x3328be=>{const _0x1a36a4=_0x1898c5;restartBot(_0x3328be[_0x1a36a4(0x187)]);});if(_0x3d6802=='update')process['send']({'update':!![],'environment':environment},_0x2dfbb5=>{});else _0x3d6802=='reinstall'&&process[_0x1898c5(0x12c)]({'reinstall':!![],'environment':environment},_0x1d8d6c=>{});}function startBot(_0xcc6251,_0x50f1f0,_0x243326){const _0x41f5d8=_0x327638;if(debugging)_0xcc6251[_0x41f5d8(0x1a8)]('-d');let _0x2bbbbd=![];const _0x127da1=_0xcc6251[0x0];_0x50f1f0={..._0x50f1f0,'stdio':[_0x41f5d8(0x23b),'inherit',_0x41f5d8(0x23b),_0x41f5d8(0x2a3)]},pid[_0x127da1]=childProcess['fork'](botfile,_0xcc6251,_0x50f1f0),pid[_0x127da1]['on'](_0x41f5d8(0x115),_0x44331e=>{const _0x375f2f=_0x41f5d8;switch(Object[_0x375f2f(0x20c)](_0x44331e)[0x0]){case _0x375f2f(0x20a):updateBotName(_0x127da1,_0x44331e[_0x375f2f(0x20a)]);break;case _0x375f2f(0x207):updateBotManager();break;case _0x375f2f(0x126):updateStatus(_0x127da1,_0x44331e['status']);break;case _0x375f2f(0x131):updateLive(_0x127da1,_0x44331e[_0x375f2f(0x131)]);break;case _0x375f2f(0x21d):updateLive(_0x127da1,_0x44331e['started']),io['to'](_0x127da1)[_0x375f2f(0x190)](_0x375f2f(0x126),{'access':{'allow':![],'reason':_0x375f2f(0x182),'token':null}});break;case _0x375f2f(0x1c3):_0x44331e[_0x375f2f(0x1c3)]=='restart'&&restartBot(_0x127da1);_0x44331e[_0x375f2f(0x1c3)]==_0x375f2f(0x128)&&toggleBot(_0x127da1,_0x375f2f(0x2cb),_0x375f2f(0x2c7));break;case _0x375f2f(0x148):sendTelegram(_0x127da1,_0x44331e[_0x375f2f(0x148)]);break;case _0x375f2f(0x295):sendTelegramMsg(_0x44331e[_0x375f2f(0x295)]);break;case'function':io['to'](_0x127da1)[_0x375f2f(0x190)](_0x44331e['function'],_0x44331e[_0x375f2f(0x22b)]);break;}}),pid[_0x127da1]['on'](_0x41f5d8(0x143),function(_0x26bfa6){if(_0x2bbbbd)return;_0x2bbbbd=!![],_0x243326(_0x26bfa6);}),pid[_0x127da1]['on'](_0x41f5d8(0x155),async function(_0x189144){const _0x1f2c24=_0x41f5d8;if(installingUpdate)return;if(_0x2bbbbd)return;_0x2bbbbd=!![],_0x243326(null);const _0x2effe9=dbConfig[_0x1f2c24(0x291)](_0x1f2c24(0x269))[_0x1f2c24(0x284)]({'botID':_0x127da1})[_0x1f2c24(0x228)]();_0x2effe9&&(_0x2effe9[_0x1f2c24(0x126)]==_0x1f2c24(0x2a9)||_0x2effe9[_0x1f2c24(0x126)]==_0x1f2c24(0x189))&&(await sleep(0x3e8),updateLive(_0x127da1,_0x1f2c24(0x2c7)),logger[_0x1f2c24(0x213)](_0x1f2c24(0x2e5)+_0x127da1),startBot([_0x127da1,userID],{'cwd':bbpath},function(_0x5f0602){const _0x3af584=_0x1f2c24;if(_0x5f0602)logger[_0x3af584(0x213)](_0x5f0602);}));});}function stopBot(_0x5d9409){const _0x277474=_0x327638;getClientsWithBotID(_0x5d9409)[_0x277474(0x11c)](_0x243cc4=>{const _0x29b48a=_0x277474;getSocket(_0x243cc4['id'])[_0x29b48a(0x23e)](!![]),removeClient(_0x243cc4['id']);}),pid[_0x5d9409]&&(pid[_0x5d9409][_0x277474(0x128)](),pid[_0x5d9409]=null);}function restartBot(_0xd6abcb){const _0x2192f1=_0x327638;if(pid[_0xd6abcb])pid[_0xd6abcb][_0x2192f1(0x128)]();}function addBot(){const _0x5550d8=_0x327638;let _0x3d4a2b;for(let _0x37c105=0x1;_0x37c105<0x3e9;_0x37c105++){_0x3d4a2b=_0x37c105[_0x5550d8(0x2cc)]()['padStart'](0x3,'0');let _0x3c8ad2=config[_0x5550d8(0x284)](_0x266aad=>_0x266aad['botID']==_0x3d4a2b);if(!_0x3c8ad2)break;}if(_0x3d4a2b===_0x5550d8(0x2db)){logger[_0x5550d8(0x213)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x5550d8(0x213)](_0x5550d8(0x2e4)+_0x3d4a2b),dbConfig[_0x5550d8(0x291)]('bots')[_0x5550d8(0x1a8)]({'botID':_0x3d4a2b,'botname':_0x5550d8(0x249)+_0x3d4a2b,'status':_0x5550d8(0x189),'live':''})[_0x5550d8(0x2cf)](),startBot([_0x3d4a2b,userID],{'cwd':bbpath},function(_0x519990){const _0x1a2695=_0x5550d8;if(_0x519990)logger[_0x1a2695(0x213)](_0x519990);}),config=getConfiguration(),io['to']('botmanager')[_0x5550d8(0x190)](_0x5550d8(0x269),config),broadcastToBots(_0x5550d8(0x269),JSON[_0x5550d8(0x193)](config));}function deleteBot(_0x5d7c35){const _0x1c501f=_0x327638;getClientsWithBotID(_0x5d7c35)['forEach'](_0x4cac5f=>{const _0x553379=_0x5599;getSocket(_0x4cac5f['id'])[_0x553379(0x23e)](!![]),removeClient(_0x4cac5f['id']);}),dbConfig[_0x1c501f(0x291)](_0x1c501f(0x269))[_0x1c501f(0x21f)]({'botID':_0x5d7c35})['write'](),logger[_0x1c501f(0x213)](_0x1c501f(0x1d7)+_0x5d7c35),stopBot(_0x5d7c35);try{if(fs[_0x1c501f(0x239)](path[_0x1c501f(0x27b)](configpath,_0x1c501f(0x1e9)+_0x5d7c35+'-config.json')))fs[_0x1c501f(0x2b4)](path[_0x1c501f(0x27b)](configpath,_0x1c501f(0x1e9)+_0x5d7c35+_0x1c501f(0x294)));if(fs[_0x1c501f(0x239)](path[_0x1c501f(0x27b)](configpath,_0x1c501f(0x1e9)+_0x5d7c35+_0x1c501f(0x1b5))))fs[_0x1c501f(0x2b4)](path[_0x1c501f(0x27b)](configpath,_0x1c501f(0x1e9)+_0x5d7c35+_0x1c501f(0x1b5)));if(fs[_0x1c501f(0x239)](path[_0x1c501f(0x27b)](configpath,'bot-'+_0x5d7c35+_0x1c501f(0x2c5))))fs['unlinkSync'](path[_0x1c501f(0x27b)](configpath,_0x1c501f(0x1e9)+_0x5d7c35+_0x1c501f(0x2c5)));if(fs[_0x1c501f(0x239)](path['join'](configpath,_0x1c501f(0x1e9)+_0x5d7c35+_0x1c501f(0x1e6))))fs[_0x1c501f(0x2b4)](path[_0x1c501f(0x27b)](configpath,_0x1c501f(0x1e9)+_0x5d7c35+'-results.json'));}catch(_0x42248e){if(_0x42248e)logger[_0x1c501f(0x213)](_0x1c501f(0x2bb),_0x42248e);}config=getConfiguration(),io['to'](_0x1c501f(0x2a4))[_0x1c501f(0x190)](_0x1c501f(0x269),config),broadcastToBots(_0x1c501f(0x269),JSON[_0x1c501f(0x193)](config));}function toggleBot(_0x414984,_0x204724,_0x40a0da){const _0x39bf5a=_0x327638;dbConfig[_0x39bf5a(0x291)](_0x39bf5a(0x269))[_0x39bf5a(0x284)]({'botID':_0x414984})[_0x39bf5a(0x1c7)]({'status':_0x204724})[_0x39bf5a(0x1c7)]({'live':_0x40a0da})[_0x39bf5a(0x2cf)]();if(_0x204724==_0x39bf5a(0x2a9)||_0x204724==_0x39bf5a(0x189))logger[_0x39bf5a(0x213)](_0x39bf5a(0x145)+_0x414984),startBot([_0x414984,userID],{'cwd':bbpath},function(_0x3c4ea5){const _0x2ca57c=_0x39bf5a;if(_0x3c4ea5)logger[_0x2ca57c(0x213)](_0x3c4ea5);});else(_0x204724=='disabled'||_0x204724==_0x39bf5a(0x17b))&&(logger['full'](_0x39bf5a(0x219)+_0x414984),stopBot(_0x414984));config=getConfiguration(),io['to'](_0x39bf5a(0x2a4))[_0x39bf5a(0x190)](_0x39bf5a(0x269),config),broadcastToBots(_0x39bf5a(0x269),JSON['stringify'](config));}function toggleStatus(_0x51f071){const _0x4db134=_0x327638;let _0xa81d03=dbConfig[_0x4db134(0x291)](_0x4db134(0x269))[_0x4db134(0x284)]({'botID':_0x51f071})[_0x4db134(0x228)](),_0x1931d9;if(_0xa81d03[_0x4db134(0x126)]===_0x4db134(0x2a9))_0x1931d9=_0x4db134(0x2cb);else{if(_0xa81d03['status']==='new')_0x1931d9=_0x4db134(0x17b);else{if(_0xa81d03[_0x4db134(0x126)]===_0x4db134(0x17b))_0x1931d9=_0x4db134(0x189);else{if(_0xa81d03[_0x4db134(0x126)]===_0x4db134(0x2cb))_0x1931d9=_0x4db134(0x2a9);}}}return _0x1931d9;}function updateStatus(_0x564d4f,_0x49dbf1){const _0x389716=_0x327638;dbConfig['get'](_0x389716(0x269))['find']({'botID':_0x564d4f})[_0x389716(0x1c7)]({'status':_0x49dbf1})[_0x389716(0x2cf)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x389716(0x269),config),broadcastToBots('bots',JSON[_0x389716(0x193)](config));}function updateLive(_0x4dd6a1,_0x3f4525){const _0x44d06b=_0x327638;dbConfig[_0x44d06b(0x291)]('bots')[_0x44d06b(0x284)]({'botID':_0x4dd6a1})[_0x44d06b(0x1c7)]({'live':_0x3f4525})['write'](),config=getConfiguration(),io['to'](_0x44d06b(0x2a4))['emit'](_0x44d06b(0x269),config),broadcastToBots(_0x44d06b(0x269),JSON['stringify'](config));}function updateBotName(_0x4ee8c0,_0x501705){const _0x51e72e=_0x327638;dbConfig[_0x51e72e(0x291)](_0x51e72e(0x269))[_0x51e72e(0x284)]({'botID':_0x4ee8c0})['assign']({'botname':_0x501705})[_0x51e72e(0x2cf)](),config=getConfiguration(),io['to'](_0x51e72e(0x2a4))['emit']('bots',config),broadcastToBots('bots',JSON[_0x51e72e(0x193)](config));}function updateBotManager(){const _0x4b3e2b=_0x327638;config=getConfiguration(),io['to'](_0x4b3e2b(0x2a4))['emit'](_0x4b3e2b(0x269),config),broadcastToBots('bots',JSON[_0x4b3e2b(0x193)](config));}function toggleBotMode(_0x47ce4f){const _0xd6435a=_0x327638;if(pid[_0x47ce4f])pid[_0x47ce4f][_0xd6435a(0x12c)]({'function':_0xd6435a(0x16f),'args':null});else{const _0x304622=configpath+_0xd6435a(0x1e9)+_0x47ce4f+_0xd6435a(0x294),_0x486953=fs[_0xd6435a(0x179)](_0x304622),_0x909e75=JSON[_0xd6435a(0x132)](_0x486953),_0x1d98da=_0x909e75[_0xd6435a(0x2d6)][0x0][_0xd6435a(0x2a2)];_0x909e75[_0xd6435a(0x2d6)][0x0][_0xd6435a(0x2a2)]=!_0x1d98da;const _0x2458e9=JSON['stringify'](_0x909e75,null,0x2);fs[_0xd6435a(0x29f)](_0x304622,_0x2458e9),config=getConfiguration(),io['to'](_0xd6435a(0x2a4))[_0xd6435a(0x190)](_0xd6435a(0x269),config),broadcastToBots(_0xd6435a(0x269),JSON[_0xd6435a(0x193)](config));}}function telegramError(_0x1db6fc){const _0x19fab4=_0x327638;logger[_0x19fab4(0x1cc)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x6673b){const _0x5130ef=_0x327638;if(_0x6673b[_0x5130ef(0x1b7)][_0x5130ef(0x26c)]!=settings[_0x5130ef(0x296)]&&'@'+_0x6673b[_0x5130ef(0x1b7)][_0x5130ef(0x26c)]!=settings['telegramUsername'])return tgBot[_0x5130ef(0x205)](_0x6673b[_0x5130ef(0x1a2)]['id'],_0x5130ef(0x17c),{'parse_mode':_0x5130ef(0x15e)})[_0x5130ef(0x290)](_0x54f4da=>{telegramError(_0x54f4da);}),![];return!![];}async function initTelegram(){const _0x5d5bbf=_0x327638;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x5d5bbf(0x175)],{'polling':!![]});let _0x197062=_0x5d5bbf(0x202);_0x197062+='\x0a',_0x197062+=_0x5d5bbf(0x2da),_0x197062+='/disable\x20-\x20disable\x20notifications\x0a',_0x197062+=_0x5d5bbf(0x13c),_0x197062+=_0x5d5bbf(0x1db),_0x197062+=_0x5d5bbf(0x29e),_0x197062+=_0x5d5bbf(0x118),_0x197062+=_0x5d5bbf(0x11d),_0x197062+=_0x5d5bbf(0x282),_0x197062+=_0x5d5bbf(0x2c9),_0x197062+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x197062+=_0x5d5bbf(0x178),_0x197062+=_0x5d5bbf(0x2b8),_0x197062+=_0x5d5bbf(0x170),_0x197062+=_0x5d5bbf(0x280);let _0x42466e=_0x5d5bbf(0x2d7);_0x42466e+='\x0a',_0x42466e+=_0x197062,tgBot[_0x5d5bbf(0x144)](/\/start/,_0x68bf0b=>{const _0x11b902=_0x5d5bbf;if(!validateTelegram(_0x68bf0b))return;if(settings[_0x11b902(0x2b1)]!=_0x68bf0b[_0x11b902(0x1a2)]['id'])updateSetting(_0x11b902(0x2b1),_0x68bf0b['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x68bf0b[_0x11b902(0x1a2)]['id'],_0x42466e)[_0x11b902(0x290)](_0x18fe69=>{telegramError(_0x18fe69);});}),tgBot[_0x5d5bbf(0x144)](/\/enable/,_0x40b65c=>{const _0xe1ea44=_0x5d5bbf;if(!validateTelegram(_0x40b65c))return;if(settings[_0xe1ea44(0x2b1)]!=_0x40b65c[_0xe1ea44(0x1a2)]['id'])updateSetting(_0xe1ea44(0x2b1),_0x40b65c[_0xe1ea44(0x1a2)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0xe1ea44(0x205)](_0x40b65c[_0xe1ea44(0x1a2)]['id'],_0xe1ea44(0x2ba))[_0xe1ea44(0x290)](_0x5caf40=>{telegramError(_0x5caf40);});}),tgBot['onText'](/\/config/,async _0x1a6548=>{const _0x297b27=_0x5d5bbf;if(!validateTelegram(_0x1a6548))return;tgBot[_0x297b27(0x29d)]('callback_query'),tgBot[_0x297b27(0x205)](_0x1a6548[_0x297b27(0x1a2)]['id'],_0x297b27(0x1ca),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x297b27(0x135)},{'text':_0x297b27(0x1de),'callback_data':_0x297b27(0x243)},{'text':_0x297b27(0x176),'callback_data':'all'}]]}})[_0x297b27(0x290)](_0x5bb24c=>{telegramError(_0x5bb24c);}),tgBot['on'](_0x297b27(0x2e2),async _0x1a1d5b=>{const _0x2bbe8c=_0x297b27,_0x5985a1=_0x1a1d5b[_0x2bbe8c(0x15a)],_0x4f2e39=_0x1a1d5b[_0x2bbe8c(0x115)];tgBot[_0x2bbe8c(0x154)](_0x1a1d5b['id'])[_0x2bbe8c(0x192)](async()=>{const _0x26604c=_0x2bbe8c;_0x5985a1==_0x26604c(0x135)&&(updateSetting('telegramEvents',_0x26604c(0x135)),updateSetting('telegramEnabled',!![]),await tgBot[_0x26604c(0x205)](_0x4f2e39[_0x26604c(0x1a2)]['id'],_0x26604c(0x2c4))[_0x26604c(0x290)](_0x102cbd=>{telegramError(_0x102cbd);}));_0x5985a1==_0x26604c(0x243)&&(updateSetting(_0x26604c(0x2be),'alerts'),updateSetting(_0x26604c(0x1e4),!![]),await tgBot['sendMessage'](_0x4f2e39[_0x26604c(0x1a2)]['id'],_0x26604c(0x2b3))[_0x26604c(0x290)](_0x4619ac=>{telegramError(_0x4619ac);}));_0x5985a1==_0x26604c(0x1fa)&&(updateSetting('telegramEvents','all'),updateSetting(_0x26604c(0x1e4),!![]),await tgBot[_0x26604c(0x205)](_0x4f2e39[_0x26604c(0x1a2)]['id'],_0x26604c(0x2c8))['catch'](_0x274574=>{telegramError(_0x274574);}));if(!settings['telegramChatId'])tgBot[_0x26604c(0x205)](_0x4f2e39[_0x26604c(0x1a2)]['id'],_0x26604c(0x18e))[_0x26604c(0x290)](_0x1fdb54=>{telegramError(_0x1fdb54);});}),tgBot[_0x2bbe8c(0x29d)](_0x2bbe8c(0x2e2));});}),tgBot['onText'](/\/status/,_0x2974f8=>{const _0x53a8bd=_0x5d5bbf;if(!validateTelegram(_0x2974f8))return;const _0x1c98b2=getBotsWithMode();let _0x3fdee5=_0x53a8bd(0x283);config[_0x53a8bd(0x11c)](_0x2e9063=>{const _0x27c0f1=_0x53a8bd,_0xe1c008=_0x1c98b2['find'](_0x30a5cc=>_0x30a5cc[_0x27c0f1(0x187)]==_0x2e9063[_0x27c0f1(0x187)])['mode'];_0x3fdee5+=_0x27c0f1(0x249)+_0x2e9063['botID']+':\x20'+_0x2e9063['status']+_0x27c0f1(0x149)+_0xe1c008+'\x20|\x20'+_0x2e9063[_0x27c0f1(0x131)]+'\x0a';}),_0x3fdee5+='\x0a',_0x3fdee5+=_0x53a8bd(0x1af),_0x3fdee5+=!settings[_0x53a8bd(0x1e4)]?_0x53a8bd(0x2ad):_0x53a8bd(0x25f),_0x3fdee5+=settings[_0x53a8bd(0x1e4)]?settings[_0x53a8bd(0x2be)]==_0x53a8bd(0x1fa)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x53a8bd(0x2e1)+settings[_0x53a8bd(0x2be)]+_0x53a8bd(0x18f):'',tgBot['sendMessage'](_0x2974f8['chat']['id'],_0x3fdee5,{'parse_mode':_0x53a8bd(0x15e)})['catch'](_0x570c7c=>{telegramError(_0x570c7c);});}),tgBot[_0x5d5bbf(0x144)](/\/restart/,_0xb34692=>{const _0x1d4314=_0x5d5bbf;if(!validateTelegram(_0xb34692))return;tgBot[_0x1d4314(0x29d)](_0x1d4314(0x2e2));const _0x4841f5=getEnabledBots();if(_0x4841f5['length']==0x0)tgBot[_0x1d4314(0x205)](_0xb34692['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x1d4314(0x290)](_0x2725ad=>{telegramError(_0x2725ad);});else{if(_0x4841f5[_0x1d4314(0x2b7)]>0x1)_0x4841f5[_0x1d4314(0x1a8)]({'botID':_0x1d4314(0x1fa)});let _0x14233b=[],_0x5f3aed=[];const _0x573c86=_0x4841f5[_0x1d4314(0x2b7)]%0x4==0x0||_0x4841f5[_0x1d4314(0x2b7)]%0x4==0x3||_0x4841f5['length']%0x3==0x1?0x4:0x3;let _0x149f8f=0x0;_0x4841f5[_0x1d4314(0x11c)]((_0x604d5b,_0x56980f)=>{const _0x46edac=_0x1d4314;if(_0x56980f%_0x573c86==0x0)_0x5f3aed=[];_0x5f3aed['push']({'text':_0x604d5b[_0x46edac(0x187)]==_0x46edac(0x1fa)?_0x46edac(0x1b8):_0x46edac(0x249)+_0x604d5b[_0x46edac(0x187)],'callback_data':_0x604d5b['botID']}),_0x56980f%_0x573c86==0x0&&(_0x14233b[_0x149f8f]=_0x5f3aed,_0x149f8f++);}),tgBot['sendMessage'](_0xb34692[_0x1d4314(0x1a2)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x14233b}})[_0x1d4314(0x290)](_0x3e8dad=>{telegramError(_0x3e8dad);}),tgBot['on'](_0x1d4314(0x2e2),async _0x250b3f=>{const _0x8ad57c=_0x1d4314,_0x69d815=_0x250b3f[_0x8ad57c(0x15a)],_0x3fa6d3=_0x250b3f[_0x8ad57c(0x115)];tgBot['answerCallbackQuery'](_0x250b3f['id'])[_0x8ad57c(0x192)](async()=>{const _0x32692b=_0x8ad57c;_0x69d815==_0x32692b(0x1fa)?config[_0x32692b(0x11c)](_0x28c000=>{const _0x424d79=_0x32692b;restartBot(_0x28c000[_0x424d79(0x187)]);}):restartBot(_0x69d815);}),tgBot[_0x8ad57c(0x29d)]('callback_query');});}}),tgBot[_0x5d5bbf(0x144)](/\/on/,_0x2a335c=>{const _0x210d04=_0x5d5bbf;if(!validateTelegram(_0x2a335c))return;tgBot['removeListener'](_0x210d04(0x2e2));const _0x436db3=getDisabledBots();if(_0x436db3[_0x210d04(0x2b7)]==0x0)tgBot['sendMessage'](_0x2a335c[_0x210d04(0x1a2)]['id'],_0x210d04(0x2e3))['catch'](_0x17801a=>{telegramError(_0x17801a);});else{if(_0x436db3['length']>0x1)_0x436db3['push']({'botID':_0x210d04(0x1fa)});let _0x18b647=[],_0x31aed5=[];const _0x15196e=_0x436db3[_0x210d04(0x2b7)]%0x4==0x0||_0x436db3[_0x210d04(0x2b7)]%0x4==0x3||_0x436db3[_0x210d04(0x2b7)]%0x3==0x1?0x4:0x3;let _0x2f7970=0x0;_0x436db3['forEach']((_0x11223c,_0x57a200)=>{const _0x569654=_0x210d04;if(_0x57a200%_0x15196e==0x0)_0x31aed5=[];_0x31aed5[_0x569654(0x1a8)]({'text':_0x11223c[_0x569654(0x187)]=='all'?_0x569654(0x1b8):'Bot\x20'+_0x11223c[_0x569654(0x187)],'callback_data':_0x11223c[_0x569654(0x187)]}),_0x57a200%_0x15196e==0x0&&(_0x18b647[_0x2f7970]=_0x31aed5,_0x2f7970++);}),tgBot[_0x210d04(0x205)](_0x2a335c[_0x210d04(0x1a2)]['id'],_0x210d04(0x1f9),{'reply_markup':{'inline_keyboard':_0x18b647}})[_0x210d04(0x290)](_0x2f0e42=>{telegramError(_0x2f0e42);}),tgBot['on'](_0x210d04(0x2e2),async _0xf277d1=>{const _0x59a947=_0x210d04,_0x2b6359=_0xf277d1[_0x59a947(0x15a)],_0x321659=_0xf277d1[_0x59a947(0x115)];tgBot['answerCallbackQuery'](_0xf277d1['id'])[_0x59a947(0x192)](async()=>{const _0x3ae3c6=_0x59a947;_0x2b6359=='all'?(tgBot['sendMessage'](_0x321659['chat']['id'],_0x3ae3c6(0x25c))['catch'](_0x3eeec2=>{telegramError(_0x3eeec2);}),_0x436db3['forEach'](_0x1ac9cc=>{const _0x98968b=_0x3ae3c6;if(_0x1ac9cc[_0x98968b(0x187)]!=_0x98968b(0x1fa))toggleBot(_0x1ac9cc['botID'],toggleStatus(_0x1ac9cc[_0x98968b(0x187)]),_0x98968b(0x2c7));})):(tgBot[_0x3ae3c6(0x205)](_0x321659[_0x3ae3c6(0x1a2)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x2b6359)[_0x3ae3c6(0x290)](_0x1b31e1=>{telegramError(_0x1b31e1);}),toggleBot(_0x2b6359,toggleStatus(_0x2b6359),_0x3ae3c6(0x2c7)));}),tgBot[_0x59a947(0x29d)](_0x59a947(0x2e2));});}}),tgBot[_0x5d5bbf(0x144)](/\/off/,_0x4c203a=>{const _0x2937f8=_0x5d5bbf;if(!validateTelegram(_0x4c203a))return;tgBot['removeListener'](_0x2937f8(0x2e2));const _0x1177fd=getEnabledBots();if(_0x1177fd[_0x2937f8(0x2b7)]==0x0)tgBot[_0x2937f8(0x205)](_0x4c203a[_0x2937f8(0x1a2)]['id'],_0x2937f8(0x1c8))[_0x2937f8(0x290)](_0x3d3799=>{telegramError(_0x3d3799);});else{if(_0x1177fd[_0x2937f8(0x2b7)]>0x1)_0x1177fd['push']({'botID':_0x2937f8(0x1fa)});let _0x33566e=[],_0x3113c2=[];const _0x3c56c1=_0x1177fd['length']%0x4==0x0||_0x1177fd[_0x2937f8(0x2b7)]%0x4==0x3||_0x1177fd['length']%0x3==0x1?0x4:0x3;let _0x2fc2a0=0x0;_0x1177fd['forEach']((_0x42d0d9,_0x3ae328)=>{const _0x335fac=_0x2937f8;if(_0x3ae328%_0x3c56c1==0x0)_0x3113c2=[];_0x3113c2[_0x335fac(0x1a8)]({'text':_0x42d0d9[_0x335fac(0x187)]==_0x335fac(0x1fa)?_0x335fac(0x1b8):_0x335fac(0x249)+_0x42d0d9[_0x335fac(0x187)],'callback_data':_0x42d0d9[_0x335fac(0x187)]}),_0x3ae328%_0x3c56c1==0x0&&(_0x33566e[_0x2fc2a0]=_0x3113c2,_0x2fc2a0++);}),tgBot[_0x2937f8(0x205)](_0x4c203a[_0x2937f8(0x1a2)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x33566e}})['catch'](_0x2ffa2f=>{telegramError(_0x2ffa2f);}),tgBot['on'](_0x2937f8(0x2e2),async _0x217a32=>{const _0x38d2d9=_0x2937f8,_0xd59749=_0x217a32[_0x38d2d9(0x15a)],_0x519407=_0x217a32[_0x38d2d9(0x115)];tgBot['answerCallbackQuery'](_0x217a32['id'])[_0x38d2d9(0x192)](async()=>{const _0x22ef90=_0x38d2d9;_0xd59749=='all'?(tgBot['sendMessage'](_0x519407['chat']['id'],_0x22ef90(0x2c3))['catch'](_0x4e9101=>{telegramError(_0x4e9101);}),_0x1177fd['forEach'](_0x5498b4=>{const _0x3af6f9=_0x22ef90;if(_0x5498b4[_0x3af6f9(0x187)]!=_0x3af6f9(0x1fa))toggleBot(_0x5498b4[_0x3af6f9(0x187)],toggleStatus(_0x5498b4[_0x3af6f9(0x187)]),_0x3af6f9(0x2c7));})):(tgBot['sendMessage'](_0x519407['chat']['id'],_0x22ef90(0x200)+_0xd59749)[_0x22ef90(0x290)](_0xa9217f=>{telegramError(_0xa9217f);}),toggleBot(_0xd59749,toggleStatus(_0xd59749),'stopped'));}),tgBot[_0x38d2d9(0x29d)](_0x38d2d9(0x2e2));});}}),tgBot[_0x5d5bbf(0x144)](/\/metrics/,_0x1f48f3=>{const _0x5a96c5=_0x5d5bbf;if(!validateTelegram(_0x1f48f3))return;tgBot['removeListener'](_0x5a96c5(0x2e2));const _0x89d3f8=getEnabledBots();if(_0x89d3f8[_0x5a96c5(0x2b7)]==0x0)tgBot[_0x5a96c5(0x205)](_0x1f48f3[_0x5a96c5(0x1a2)]['id'],_0x5a96c5(0x1c8))[_0x5a96c5(0x290)](_0x2b11f9=>{telegramError(_0x2b11f9);});else{if(_0x89d3f8['length']>0x1){let _0xb4ff4d=[],_0x3f64fe=[];const _0x314a29=_0x89d3f8[_0x5a96c5(0x2b7)]%0x4==0x0||_0x89d3f8[_0x5a96c5(0x2b7)]%0x4==0x3||_0x89d3f8['length']%0x3==0x1?0x4:0x3;let _0x55773c=0x0;_0x89d3f8[_0x5a96c5(0x11c)]((_0x3e1a49,_0x504e73)=>{const _0x2b8dd6=_0x5a96c5;if(_0x504e73%_0x314a29==0x0)_0x3f64fe=[];_0x3f64fe[_0x2b8dd6(0x1a8)]({'text':'Bot\x20'+_0x3e1a49[_0x2b8dd6(0x187)],'callback_data':_0x3e1a49[_0x2b8dd6(0x187)]}),_0x504e73%_0x314a29==0x0&&(_0xb4ff4d[_0x55773c]=_0x3f64fe,_0x55773c++);}),tgBot[_0x5a96c5(0x205)](_0x1f48f3[_0x5a96c5(0x1a2)]['id'],_0x5a96c5(0x194),{'reply_markup':{'inline_keyboard':_0xb4ff4d}})['catch'](_0x244493=>{telegramError(_0x244493);}),tgBot['on'](_0x5a96c5(0x2e2),async _0x4b2ca7=>{const _0x15d190=_0x5a96c5,_0xf27d01=_0x4b2ca7['data'],_0x5bf126=_0x4b2ca7[_0x15d190(0x115)];tgBot['answerCallbackQuery'](_0x4b2ca7['id'])[_0x15d190(0x192)](async()=>{const _0x565328=_0x15d190;if(pid[_0xf27d01])pid[_0xf27d01][_0x565328(0x12c)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x15d190(0x29d)](_0x15d190(0x2e2));});}else{const _0x370af9=_0x89d3f8[0x0][_0x5a96c5(0x187)];if(pid[_0x370af9])pid[_0x370af9][_0x5a96c5(0x12c)]({'function':_0x5a96c5(0x1b1),'args':null});}}}),tgBot[_0x5d5bbf(0x144)](/\/portfolio/,_0x3bc285=>{const _0x7b83d8=_0x5d5bbf;if(!validateTelegram(_0x3bc285))return;tgBot[_0x7b83d8(0x29d)]('callback_query');const _0x4300c8=getEnabledBots();if(_0x4300c8['length']==0x0)tgBot[_0x7b83d8(0x205)](_0x3bc285[_0x7b83d8(0x1a2)]['id'],_0x7b83d8(0x1c8))[_0x7b83d8(0x290)](_0x57b5b2=>{telegramError(_0x57b5b2);});else{if(_0x4300c8[_0x7b83d8(0x2b7)]>0x1){let _0x25e497=[],_0x5a5a24=[];const _0xca49a2=_0x4300c8['length']%0x4==0x0||_0x4300c8[_0x7b83d8(0x2b7)]%0x4==0x3||_0x4300c8[_0x7b83d8(0x2b7)]%0x3==0x1?0x4:0x3;let _0x5c8c52=0x0;_0x4300c8['forEach']((_0x523d25,_0x50ae65)=>{const _0x203136=_0x7b83d8;if(_0x50ae65%_0xca49a2==0x0)_0x5a5a24=[];_0x5a5a24[_0x203136(0x1a8)]({'text':'Bot\x20'+_0x523d25[_0x203136(0x187)],'callback_data':_0x523d25[_0x203136(0x187)]}),_0x50ae65%_0xca49a2==0x0&&(_0x25e497[_0x5c8c52]=_0x5a5a24,_0x5c8c52++);}),tgBot[_0x7b83d8(0x205)](_0x3bc285[_0x7b83d8(0x1a2)]['id'],_0x7b83d8(0x242),{'reply_markup':{'inline_keyboard':_0x25e497}})[_0x7b83d8(0x290)](_0x5da2f8=>{telegramError(_0x5da2f8);}),tgBot['on'](_0x7b83d8(0x2e2),async _0x224f85=>{const _0x133fbb=_0x7b83d8,_0x522b25=_0x224f85[_0x133fbb(0x15a)],_0x516c66=_0x224f85[_0x133fbb(0x115)];tgBot[_0x133fbb(0x154)](_0x224f85['id'])[_0x133fbb(0x192)](async()=>{const _0x11e5f7=_0x133fbb;if(pid[_0x522b25])pid[_0x522b25][_0x11e5f7(0x12c)]({'function':_0x11e5f7(0x17d),'args':null});}),tgBot[_0x133fbb(0x29d)](_0x133fbb(0x2e2));});}else{const _0x41626b=_0x4300c8[0x0][_0x7b83d8(0x187)];if(pid[_0x41626b])pid[_0x41626b][_0x7b83d8(0x12c)]({'function':_0x7b83d8(0x17d),'args':null});}}}),tgBot[_0x5d5bbf(0x144)](/\/update/,async _0x328955=>{const _0x165f0a=_0x5d5bbf;if(!validateTelegram(_0x328955))return;tgBot['removeListener']('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x165f0a(0x205)](_0x328955[_0x165f0a(0x1a2)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x165f0a(0x290)](_0x3c472e=>{telegramError(_0x3c472e);});else!validInstallation?tgBot[_0x165f0a(0x205)](_0x328955['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x165f0a(0x290)](_0x408ff0=>{telegramError(_0x408ff0);}):(tgBot[_0x165f0a(0x205)](_0x328955[_0x165f0a(0x1a2)]['id'],_0x165f0a(0x1ae),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x165f0a(0x156)},{'text':'No','callback_data':'no'}]]}})[_0x165f0a(0x290)](_0x423870=>{telegramError(_0x423870);}),tgBot['on']('callback_query',async _0x3d01f0=>{const _0x1c846e=_0x165f0a,_0x3c3485=_0x3d01f0[_0x1c846e(0x15a)],_0x316600=_0x3d01f0[_0x1c846e(0x115)];tgBot['answerCallbackQuery'](_0x3d01f0['id'])['then'](async()=>{const _0x1bb25a=_0x1c846e;_0x3c3485==_0x1bb25a(0x156)&&(await tgBot[_0x1bb25a(0x205)](_0x316600[_0x1bb25a(0x1a2)]['id'],_0x1bb25a(0x2df))[_0x1bb25a(0x290)](_0x5e15b0=>{telegramError(_0x5e15b0);}),updateBB(_0x1bb25a(0x28f))),_0x3c3485=='no'&&await tgBot[_0x1bb25a(0x205)](_0x316600[_0x1bb25a(0x1a2)]['id'],_0x1bb25a(0x153))[_0x1bb25a(0x290)](_0xc0dfe5=>{telegramError(_0xc0dfe5);});}),tgBot[_0x1c846e(0x29d)]('callback_query');}));}),tgBot[_0x5d5bbf(0x144)](/\/reinstall/,async _0x42b7ed=>{const _0x5f5bdf=_0x5d5bbf;if(!validateTelegram(_0x42b7ed))return;tgBot[_0x5f5bdf(0x29d)](_0x5f5bdf(0x2e2)),!validInstallation?tgBot['sendMessage'](_0x42b7ed[_0x5f5bdf(0x1a2)]['id'],_0x5f5bdf(0x212))[_0x5f5bdf(0x290)](_0x4e7783=>{telegramError(_0x4e7783);}):(tgBot[_0x5f5bdf(0x205)](_0x42b7ed[_0x5f5bdf(0x1a2)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x5f5bdf(0x156)},{'text':'No','callback_data':'no'}]]}})[_0x5f5bdf(0x290)](_0x49ccb2=>{telegramError(_0x49ccb2);}),tgBot['on'](_0x5f5bdf(0x2e2),async _0xc89a9d=>{const _0x469731=_0x5f5bdf,_0x471b34=_0xc89a9d['data'],_0x5b749b=_0xc89a9d[_0x469731(0x115)];tgBot[_0x469731(0x154)](_0xc89a9d['id'])[_0x469731(0x192)](async()=>{const _0x581545=_0x469731;_0x471b34==_0x581545(0x156)&&(await tgBot[_0x581545(0x205)](_0x5b749b[_0x581545(0x1a2)]['id'],_0x581545(0x23f))[_0x581545(0x290)](_0x1c6b39=>{telegramError(_0x1c6b39);}),updateBB(_0x581545(0x24c))),_0x471b34=='no'&&await tgBot[_0x581545(0x205)](_0x5b749b['chat']['id'],_0x581545(0x222))[_0x581545(0x290)](_0x53459e=>{telegramError(_0x53459e);});}),tgBot[_0x469731(0x29d)]('callback_query');}));}),tgBot[_0x5d5bbf(0x144)](/\/toggle/,_0x110609=>{const _0xebe340=_0x5d5bbf;if(!validateTelegram(_0x110609))return;tgBot[_0xebe340(0x29d)]('callback_query');const _0x31841c=getBotsWithMode();if(_0x31841c[_0xebe340(0x2b7)]==0x0)tgBot[_0xebe340(0x205)](_0x110609[_0xebe340(0x1a2)]['id'],_0xebe340(0x1c8))[_0xebe340(0x290)](_0x40755d=>{telegramError(_0x40755d);});else{let _0x60e059=[],_0x267738=[];const _0x5ca78f=0x2;let _0x746e58=0x0;_0x31841c[_0xebe340(0x11c)]((_0x14eaa7,_0x6f221)=>{const _0x185fbd=_0xebe340;if(_0x6f221%_0x5ca78f==0x0)_0x267738=[];_0x267738[_0x185fbd(0x1a8)]({'text':'Bot\x20'+_0x14eaa7['botID']+'\x20('+_0x14eaa7[_0x185fbd(0x208)]+')','callback_data':_0x14eaa7[_0x185fbd(0x187)]}),_0x6f221%_0x5ca78f==0x0&&(_0x60e059[_0x746e58]=_0x267738,_0x746e58++);}),tgBot[_0xebe340(0x205)](_0x110609['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x60e059}})[_0xebe340(0x290)](_0x9121a8=>{telegramError(_0x9121a8);}),tgBot['on'](_0xebe340(0x2e2),async _0x34ca9a=>{const _0x1434a0=_0xebe340,_0x4fe699=_0x34ca9a[_0x1434a0(0x15a)],_0x18e9b4=_0x34ca9a[_0x1434a0(0x115)];tgBot[_0x1434a0(0x154)](_0x34ca9a['id'])[_0x1434a0(0x192)](async()=>{const _0x1ef1cf=_0x1434a0,_0x488a1f=_0x31841c[_0x1ef1cf(0x284)](_0x4ba10c=>_0x4ba10c[_0x1ef1cf(0x187)]==_0x4fe699),_0x3e75dc=_0x488a1f[_0x1ef1cf(0x208)]==_0x1ef1cf(0x1ff)?_0x1ef1cf(0x1b4):_0x1ef1cf(0x1ff);tgBot['sendMessage'](_0x18e9b4[_0x1ef1cf(0x1a2)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x4fe699+_0x1ef1cf(0x1d6)+_0x3e75dc+_0x1ef1cf(0x1d1))[_0x1ef1cf(0x290)](_0x2eeccb=>{telegramError(_0x2eeccb);}),toggleBotMode(_0x4fe699);}),tgBot[_0x1434a0(0x29d)](_0x1434a0(0x2e2));});}}),tgBot[_0x5d5bbf(0x144)](/\/names/,_0x47b07c=>{const _0x40d464=_0x5d5bbf;if(!validateTelegram(_0x47b07c))return;let _0x970480='';config[_0x40d464(0x11c)](_0x2d05cf=>{const _0x1ad627=_0x40d464;_0x970480+=_0x1ad627(0x249)+_0x2d05cf[_0x1ad627(0x187)]+':\x20'+_0x2d05cf[_0x1ad627(0x20a)]+'\x0a';}),tgBot[_0x40d464(0x205)](_0x47b07c[_0x40d464(0x1a2)]['id'],_0x970480,{'parse_mode':'HTML'})[_0x40d464(0x290)](_0x23f863=>{telegramError(_0x23f863);});}),tgBot['onText'](/\/disable/,_0x5e5c3c=>{const _0x2a506a=_0x5d5bbf;if(!validateTelegram(_0x5e5c3c))return;tgBot['sendMessage'](_0x5e5c3c[_0x2a506a(0x1a2)]['id'],_0x2a506a(0x248))[_0x2a506a(0x290)](_0x3444c6=>{telegramError(_0x3444c6);}),updateSetting(_0x2a506a(0x1e4),![]);}),tgBot['onText'](/\/help/,_0x21dd81=>{const _0x3abdd6=_0x5d5bbf;if(!validateTelegram(_0x21dd81))return;tgBot[_0x3abdd6(0x205)](_0x21dd81[_0x3abdd6(0x1a2)]['id'],_0x197062)[_0x3abdd6(0x290)](_0x2e020b=>{telegramError(_0x2e020b);});}),tgBot['on'](_0x5d5bbf(0x258),_0x4daa22=>{const _0x30332e=_0x5d5bbf;_0x4daa22[_0x30332e(0x2cc)]()[_0x30332e(0x27d)](_0x30332e(0x214))&&(logger[_0x30332e(0x213)](_0x30332e(0x1fb)),tgBot[_0x30332e(0x134)](),tgBot=null,io['to'](_0x30332e(0x2a4))['emit'](_0x30332e(0x20d),_0x30332e(0x1fb)));}),process[_0x5d5bbf(0x263)](_0x5d5bbf(0x17a),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process['once'](_0x5d5bbf(0x162),()=>{const _0x3f289f=_0x5d5bbf;if(tgBot)tgBot[_0x3f289f(0x134)]();process[_0x3f289f(0x155)](0x1);});}}function disableTelegram(){const _0x51831e=_0x327638;tgBot&&(tgBot[_0x51831e(0x134)](),tgBot=null);}function sendTelegram(_0x124fc8,_0x578660){const _0x46db31=_0x327638;if(settings[_0x46db31(0x1e4)]){if(settings[_0x46db31(0x2be)]==_0x46db31(0x1fa)||(_0x578660['type']==_0x46db31(0x143)||_0x578660[_0x46db31(0x251)]=='warning'||_0x578660[_0x46db31(0x251)]==_0x46db31(0x236))&&settings[_0x46db31(0x2be)]==_0x46db31(0x243)||_0x578660[_0x46db31(0x251)]=='order'&&settings['telegramEvents']=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x578660['showname'])tgBot[_0x46db31(0x205)](settings['telegramChatId'],_0x578660[_0x46db31(0x20a)]+_0x46db31(0x129)+_0x578660[_0x46db31(0x22c)])[_0x46db31(0x290)](_0x175639=>{telegramError(_0x175639);});else tgBot[_0x46db31(0x205)](settings['telegramChatId'],_0x46db31(0x249)+_0x124fc8+_0x46db31(0x129)+_0x578660[_0x46db31(0x22c)])[_0x46db31(0x290)](_0x30a96b=>{telegramError(_0x30a96b);});}}}}async function sendTelegramMsg(_0xf2ebb9,_0x2d0da9=_0x327638(0x15e)){const _0x2a7fa4=_0x327638;return settings[_0x2a7fa4(0x1e4)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x2a7fa4(0x205)](settings[_0x2a7fa4(0x2b1)],_0xf2ebb9,{'parse_mode':_0x2d0da9})[_0x2a7fa4(0x290)](_0x3f5714=>{telegramError(_0x3f5714);}),!![]):![];}function getDeviceWithIp(_0x364805){const _0x2d6d65=_0x327638;return devices[_0x2d6d65(0x284)](_0x797e68=>_0x797e68['ip']===_0x364805);}function temporaryAccess2FA(_0x406687,_0x51bbbf){const _0xf2c1d=_0x327638;let _0xb07d67=new Date(),_0x2483e2=![];if(lastIpApproval){if(_0xb07d67-lastIpApproval<0x1388)_0x2483e2=!![];}lastIpApproval=new Date();if(_0x2483e2)return;tgBot&&settings[_0xf2c1d(0x2b1)]&&(tgBot[_0xf2c1d(0x29d)](_0xf2c1d(0x2e2)),tgBot[_0xf2c1d(0x205)](settings['telegramChatId'],_0xf2c1d(0x267)+normalizeIP(_0x51bbbf)[_0xf2c1d(0x19d)]+_0xf2c1d(0x23a),{'parse_mode':_0xf2c1d(0x15e),'reply_markup':{'inline_keyboard':[[{'text':_0xf2c1d(0x2bc),'callback_data':'5'},{'text':_0xf2c1d(0x127),'callback_data':'15'},{'text':_0xf2c1d(0x231),'callback_data':'30'},{'text':_0xf2c1d(0x136),'callback_data':_0xf2c1d(0x136)}]]}})[_0xf2c1d(0x290)](_0x5c1f43=>{telegramError(_0x5c1f43);}),tgBot['on'](_0xf2c1d(0x2e2),async _0x90461f=>{const _0xc23ed7=_0xf2c1d,_0x3ba37b=_0x90461f[_0xc23ed7(0x15a)],_0x4c1b28=_0x90461f[_0xc23ed7(0x115)];tgBot[_0xc23ed7(0x154)](_0x90461f['id'])['then'](async()=>{const _0x5e4e29=_0xc23ed7;devices[_0x406687][_0x5e4e29(0x268)]={'clientip':_0x51bbbf,'timestamp':new Date()[_0x5e4e29(0x1b0)](),'expiry':_0x3ba37b},_0x3ba37b!=_0x5e4e29(0x136)?(await tgBot[_0x5e4e29(0x205)](_0x4c1b28[_0x5e4e29(0x1a2)]['id'],_0x5e4e29(0x19e)+_0x3ba37b+_0x5e4e29(0x26d),{'parse_mode':_0x5e4e29(0x15e)})[_0x5e4e29(0x290)](_0x3aa23e=>{telegramError(_0x3aa23e);}),io['to'](_0x406687)[_0x5e4e29(0x190)]('status',{'access':{'allow':![],'reason':_0x5e4e29(0x182),'token':null}})):(await tgBot[_0x5e4e29(0x205)](_0x4c1b28[_0x5e4e29(0x1a2)]['id'],_0x5e4e29(0x142))[_0x5e4e29(0x290)](_0x4838c5=>{telegramError(_0x4838c5);}),io['to'](_0x406687)[_0x5e4e29(0x190)](_0x5e4e29(0x126),{'access':{'allow':![],'reason':_0x5e4e29(0x262),'token':null}}));}),tgBot[_0xc23ed7(0x29d)](_0xc23ed7(0x2e2));}));}function loginAccess2FA(_0x304d5a,_0x5778c2){const _0x5c3d66=_0x327638;tgBot&&settings[_0x5c3d66(0x2b1)]&&(tgBot[_0x5c3d66(0x29d)](_0x5c3d66(0x2e2)),tgBot[_0x5c3d66(0x205)](settings[_0x5c3d66(0x2b1)],_0x5c3d66(0x266)+normalizeIP(_0x5778c2)['show']+'</b>\x20?',{'parse_mode':_0x5c3d66(0x15e),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x5c3d66(0x136),'callback_data':_0x5c3d66(0x136)}]]}})[_0x5c3d66(0x290)](_0xc259fa=>{telegramError(_0xc259fa);}),tgBot['on']('callback_query',async _0x59ff57=>{const _0x4c36dd=_0x5c3d66,_0x10d23f=_0x59ff57[_0x4c36dd(0x15a)],_0x4134ba=_0x59ff57['message'];tgBot[_0x4c36dd(0x154)](_0x59ff57['id'])['then'](async()=>{const _0x3f69b6=_0x4c36dd;devices[_0x304d5a][_0x3f69b6(0x1b6)]={'clientip':_0x5778c2,'timestamp':new Date()['getTime'](),'expiry':_0x10d23f},_0x10d23f!=_0x3f69b6(0x136)?(await tgBot['sendMessage'](_0x4134ba['chat']['id'],_0x3f69b6(0x14d),{'parse_mode':_0x3f69b6(0x15e)})['catch'](_0x3fdff0=>{telegramError(_0x3fdff0);}),io['to'](_0x304d5a)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x3f69b6(0x205)](_0x4134ba[_0x3f69b6(0x1a2)]['id'],_0x3f69b6(0x24a))[_0x3f69b6(0x290)](_0x4d9fb0=>{telegramError(_0x4d9fb0);}),io['to'](_0x304d5a)[_0x3f69b6(0x190)](_0x3f69b6(0x126),{'access':{'allow':![],'reason':_0x3f69b6(0x218),'token':null}}));}),tgBot[_0x4c36dd(0x29d)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1c32cb=_0x327638;return dbConfig[_0x1c32cb(0x291)]('bots')[_0x1c32cb(0x1a0)](_0x1c32cb(0x187))[_0x1c32cb(0x261)]({'status':_0x1c32cb(0x2a9)})[_0x1c32cb(0x228)]()||[];}function getDisabledBots(){const _0x4ef0d7=_0x327638;return dbConfig[_0x4ef0d7(0x291)](_0x4ef0d7(0x269))[_0x4ef0d7(0x1a0)](_0x4ef0d7(0x187))['filter']({'status':'disabled'})[_0x4ef0d7(0x228)]()||[];}function _0x5599(_0x25c790,_0x48fec6){const _0x331614=_0xa35a();return _0x5599=function(_0x22d85b,_0x3d8ade){_0x22d85b=_0x22d85b-0x113;let _0xa35aad=_0x331614[_0x22d85b];return _0xa35aad;},_0x5599(_0x25c790,_0x48fec6);}function getBotAttributes(_0x4d5696){const _0x33a598=_0x327638;let _0x518901={};const _0x119e57=configpath+_0x33a598(0x1e9)+_0x4d5696+'-config.json',_0x4ff7df=fs['existsSync'](_0x119e57);if(_0x4ff7df){const _0x694120=fs[_0x33a598(0x179)](_0x119e57);try{const _0x335ddf=JSON['parse'](_0x694120),_0x41c003=_0x335ddf?_0x335ddf[_0x33a598(0x2d6)][0x0][_0x33a598(0x2a2)]:![];_0x518901[_0x33a598(0x208)]=_0x41c003?'auto':'manual',_0x518901[_0x33a598(0x20a)]=_0x335ddf?_0x335ddf['bot'][0x0][_0x33a598(0x20a)]:_0x33a598(0x249)+_0x4d5696;}catch(_0x2e86c5){_0x518901['mode']=_0x33a598(0x1b4),_0x518901[_0x33a598(0x20a)]=_0x33a598(0x249)+_0x4d5696;}}else _0x518901[_0x33a598(0x208)]=_0x33a598(0x1b4),_0x518901['botname']=_0x33a598(0x249)+_0x4d5696;return _0x518901;}function getBotsWithMode(){const _0x49d7d5=_0x327638,_0x340acf=dbConfig[_0x49d7d5(0x291)]('bots')['sortBy'](_0x49d7d5(0x187))[_0x49d7d5(0x228)]()||[];return _0x340acf[_0x49d7d5(0x11c)](_0x407b5a=>{const _0xf4b2b=_0x49d7d5;let _0x3de1b3=getBotAttributes(_0x407b5a[_0xf4b2b(0x187)]);_0x407b5a[_0xf4b2b(0x208)]=_0x3de1b3[_0xf4b2b(0x208)];}),_0x340acf;}function getBotExchanges(){const _0x122c6c=_0x327638;let _0xff4261=[];const _0x26601b=dbConfig[_0x122c6c(0x291)]('bots')[_0x122c6c(0x1a0)]('botID')[_0x122c6c(0x228)]()||[];_0x26601b[_0x122c6c(0x11c)](_0x2d9fb1=>{const _0x5ef228=_0x122c6c;if(_0x2d9fb1['status']==_0x5ef228(0x2a9)){const _0x23f1c7=configpath+'bot-'+_0x2d9fb1['botID']+_0x5ef228(0x294),_0x1e89b1=fs['existsSync'](_0x23f1c7);let _0x1592a4;if(_0x1e89b1){const _0x1f92a9=fs[_0x5ef228(0x179)](_0x23f1c7);try{const _0x59b105=JSON[_0x5ef228(0x132)](_0x1f92a9);_0x1592a4=_0x59b105?_0x59b105[_0x5ef228(0x2d6)][0x0][_0x5ef228(0x1a9)]:null;}catch(_0x35c842){}}if(_0x1592a4)_0xff4261[_0x5ef228(0x1a8)](_0x1592a4);}});const _0x34fb97=[...new Set(_0xff4261)]['sort']();return _0x34fb97;}async function initUser(){const _0x40f7be=_0x327638;if(!settings[_0x40f7be(0x1dd)]){const _0x2fa717=uuidRandom();mixpanel[_0x40f7be(0x256)](_0x2fa717),updateSetting(_0x40f7be(0x1dd),_0x2fa717);}}async function initSecure(){const _0x45fefd=_0x327638;let _0x1c84b0=getSecure();if(!_0x1c84b0[_0x45fefd(0x257)](_0x45fefd(0x1da))){let _0x16fc2a=await generateKeys();_0x1c84b0['publicKey']=_0x16fc2a[_0x45fefd(0x225)],_0x1c84b0[_0x45fefd(0x13b)]=_0x16fc2a[_0x45fefd(0x13b)],_0x1c84b0[_0x45fefd(0x1da)]=crypto[_0x45fefd(0x264)](0x20)[_0x45fefd(0x2cc)](_0x45fefd(0x250));;storeSecure(_0x1c84b0);}}function getSettings(){const _0x20635b=_0x327638;return dbSettings[_0x20635b(0x291)](_0x20635b(0x16b))[_0x20635b(0x228)]()||{};}function getSecure(){const _0x58dc63=_0x327638;return dbSecure[_0x58dc63(0x291)]('secure')[_0x58dc63(0x228)]()||{};}function getBlacklist(){const _0x55ecef=_0x327638;return dbSecure['get'](_0x55ecef(0x14c))['value']()||[];}function broadcastToBots(_0x335988,_0x6c5ee9){const _0x39f411=_0x327638;config[_0x39f411(0x11c)](_0x5aa342=>{const _0x4a0d50=_0x39f411;if(_0x5aa342[_0x4a0d50(0x126)]=='enabled'&&_0x5aa342[_0x4a0d50(0x131)]==_0x4a0d50(0x245)||_0x5aa342['status']=='new'&&_0x5aa342[_0x4a0d50(0x131)]==_0x4a0d50(0x245)){if(pid[_0x5aa342[_0x4a0d50(0x187)]])pid[_0x5aa342[_0x4a0d50(0x187)]][_0x4a0d50(0x12c)]({[_0x335988]:_0x6c5ee9});}});}function storeSettings(_0x51d447,_0x5107c5=![]){const _0x4bd38b=_0x327638;_0x51d447={...settings,..._0x51d447};if(_0x5107c5&&_0x51d447['bbPassword']!='************'&&_0x51d447['bbPassword']!=_0x4bd38b(0x24b)&&_0x51d447[_0x4bd38b(0x1bf)]!=''){const _0x10d213=crypt[_0x4bd38b(0x254)](secure[_0x4bd38b(0x13b)],_0x51d447[_0x4bd38b(0x1bf)])[_0x4bd38b(0x115)][_0x4bd38b(0x1ec)]('@')[0x0],_0x1e2a01=bcrypt[_0x4bd38b(0x195)](_0x10d213,saltRounds);_0x51d447={..._0x51d447,'bbPassword':_0x1e2a01};}if(_0x5107c5&&_0x51d447[_0x4bd38b(0x175)]!='************'&&_0x51d447[_0x4bd38b(0x175)]!=_0x4bd38b(0x24b)&&_0x51d447[_0x4bd38b(0x175)]!=''){const _0x102ab8=crypt[_0x4bd38b(0x254)](secure[_0x4bd38b(0x13b)],_0x51d447['telegramToken'])[_0x4bd38b(0x115)]['split']('@')[0x0];_0x51d447={..._0x51d447,'telegramToken':_0x102ab8};}const _0x40d7b5=_0x51d447['telegramToken']!=_0x4bd38b(0x18a)&&_0x51d447['telegramToken']!=settings[_0x4bd38b(0x175)]||_0x51d447[_0x4bd38b(0x296)]!=settings[_0x4bd38b(0x296)],_0x1b0497=_0x51d447['telegramToken']==''||_0x51d447[_0x4bd38b(0x296)]=='';if(_0x40d7b5)_0x51d447[_0x4bd38b(0x2be)]='all';for(const [_0x752ecf,_0xf70939]of Object[_0x4bd38b(0x216)](_0x51d447)){if(_0x752ecf==_0x4bd38b(0x175)&&_0xf70939==_0x4bd38b(0x18a)){_0x51d447[_0x4bd38b(0x175)]=settings[_0x4bd38b(0x175)];continue;};if(_0x752ecf==_0x4bd38b(0x1bf)&&_0xf70939==_0x4bd38b(0x18a)){_0x51d447['bbPassword']=settings[_0x4bd38b(0x1bf)];continue;};dbSettings[_0x4bd38b(0x1df)](_0x4bd38b(0x246)+_0x752ecf,_0xf70939)[_0x4bd38b(0x2cf)]();}settings=_0x51d447,io['to']('botmanager')['emit'](_0x4bd38b(0x16b),cleanSettings()),broadcastToBots(_0x4bd38b(0x1c4),settings['timeshift']),broadcastToBots(_0x4bd38b(0x1f4),settings['onepagemode']);if(_0x40d7b5&&!_0x1b0497)initTelegram();if(_0x40d7b5&&_0x1b0497)disableTelegram();getAllClients()[_0x4bd38b(0x11c)](_0x347cd5=>{const _0x59b383=_0x4bd38b;getSocket(_0x347cd5['id'])[_0x59b383(0x190)](_0x59b383(0x126),{'access':{'allow':![],'reason':_0x59b383(0x182),'token':null}});});}function updateSetting(_0x40455f,_0x3601d6){const _0x1862f6=_0x327638;dbSettings[_0x1862f6(0x1df)]('settings.'+_0x40455f,_0x3601d6)['write'](),settings=getSettings(),io['to']('botmanager')[_0x1862f6(0x190)]('settings',cleanSettings());}function storeSecure(_0x3973af){const _0x2b2690=_0x327638;dbSecure[_0x2b2690(0x291)]('secure')[_0x2b2690(0x1a8)](_0x3973af)[_0x2b2690(0x2cf)](),secure=_0x3973af;}function addBlacklist(_0x30f173){const _0x16b53b=_0x327638;cleanBlacklist();let _0x1f9fe2;devices[_0x30f173][_0x16b53b(0x268)]?_0x1f9fe2=Math['max'](devices[_0x30f173][_0x16b53b(0x268)][_0x16b53b(0x1b3)],loginExpiry):_0x1f9fe2=loginExpiry,dbSecure[_0x16b53b(0x291)](_0x16b53b(0x14c))[_0x16b53b(0x1a8)]({'expiry':new Date()[_0x16b53b(0x1b0)]()+_0x1f9fe2*0x3c*0x3e8,'token':devices[_0x30f173][_0x16b53b(0x21a)][_0x16b53b(0x1ea)]})[_0x16b53b(0x2cf)](),blacklist=dbSecure[_0x16b53b(0x291)](_0x16b53b(0x14c))[_0x16b53b(0x228)]();}function cleanBlacklist(){const _0x3d3fcd=_0x327638;let _0x2109f3=dbSecure[_0x3d3fcd(0x291)](_0x3d3fcd(0x14c))[_0x3d3fcd(0x1f7)]()['value'](),_0x2dd291=new Date()[_0x3d3fcd(0x1b0)]();_0x2109f3['forEach'](_0xeee2d7=>{const _0xac8ade=_0x3d3fcd;_0xeee2d7[_0xac8ade(0x1b3)]<_0x2dd291&&dbSecure[_0xac8ade(0x291)]('blacklist')[_0xac8ade(0x21f)]({'expiry':_0xeee2d7['expiry']})[_0xac8ade(0x2cf)]();});}function initStates(){const _0x532c69=_0x327638;let _0x11570b=getConfiguration();_0x11570b[_0x532c69(0x11c)](_0x5f5c9c=>{const _0x8b1543=_0x532c69;_0x5f5c9c[_0x8b1543(0x131)]=_0x8b1543(0x2c7);}),storeConfiguration(_0x11570b);}function onKeys(){const _0x4e0571=new RSA();return new Promise(_0x56b940=>{const _0x4c9eac=_0x5599;_0x4e0571[_0x4c9eac(0x2af)]()[_0x4c9eac(0x192)](_0x599f8d=>{_0x56b940(_0x599f8d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4dc51f=_0x327638;let _0x253652=getSettings(),_0x3c2230=![];!_0x253652[_0x4dc51f(0x257)](_0x4dc51f(0x184))&&(_0x253652[_0x4dc51f(0x184)]=0x0,_0x3c2230=!![]);!_0x253652['hasOwnProperty'](_0x4dc51f(0x276))&&(_0x253652['lastmsgemitted']=0x0,_0x3c2230=!![]);!_0x253652['hasOwnProperty'](_0x4dc51f(0x1e5))&&(_0x253652['latestversion']=_0x4dc51f(0x1f8),_0x3c2230=!![]);!_0x253652[_0x4dc51f(0x257)](_0x4dc51f(0x1f4))&&(_0x253652[_0x4dc51f(0x1f4)]=![],_0x3c2230=!![]);if(_0x3c2230)storeSettings(_0x253652);try{fs[_0x4dc51f(0x11a)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x5a933d=>{const _0x1cbf41=_0x4dc51f;if(!_0x5a933d['isDirectory']()){if(!_0x5a933d[_0x1cbf41(0x198)][_0x1cbf41(0x15f)](_0x1cbf41(0x116)))fs[_0x1cbf41(0x2b4)](configbackuppath+_0x5a933d[_0x1cbf41(0x198)]);}else fs['rmSync'](configbackuppath+_0x5a933d[_0x1cbf41(0x198)],{'recursive':!![]});});}catch(_0x1629a2){logger[_0x4dc51f(0x26a)]('Error\x20removing\x20old\x20backup\x20files:',_0x1629a2);}}function storeConfiguration(_0x53c6bb){const _0x2ee228=_0x327638;dbConfig[_0x2ee228(0x291)](_0x2ee228(0x269))[_0x2ee228(0x21f)]()['write'](),_0x53c6bb['forEach'](_0x2c4b58=>{const _0x48e2d8=_0x2ee228;delete _0x2c4b58[_0x48e2d8(0x208)];}),dbConfig['get']('bots')['push'](..._0x53c6bb)[_0x2ee228(0x2cf)](),config=_0x53c6bb;}function resetPassword(){const _0x235ea3=_0x327638;tgBot&&settings[_0x235ea3(0x2b1)]&&(tgBot[_0x235ea3(0x29d)]('callback_query'),tgBot[_0x235ea3(0x205)](settings[_0x235ea3(0x2b1)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x235ea3(0x15e),'reply_markup':{'inline_keyboard':[[{'text':_0x235ea3(0x156),'callback_data':_0x235ea3(0x156)},{'text':'no','callback_data':'no'}]]}})[_0x235ea3(0x290)](_0x2888ef=>{telegramError(_0x2888ef);}),tgBot['on'](_0x235ea3(0x2e2),async _0xb780e0=>{const _0x516f6e=_0x235ea3,_0xfb8205=_0xb780e0['data'],_0x4172e5=_0xb780e0[_0x516f6e(0x115)];tgBot[_0x516f6e(0x154)](_0xb780e0['id'])[_0x516f6e(0x192)](async()=>{const _0x3e6141=_0x516f6e;if(_0xfb8205!='no'){const _0x34e961=0xf,_0x18f4f=_0x3e6141(0x1c2),_0x3c9c62=Array[_0x3e6141(0x1b7)](crypto['randomFillSync'](new Uint32Array(_0x34e961)))[_0x3e6141(0x1a4)](_0xbf69f1=>_0x18f4f[_0xbf69f1%_0x18f4f[_0x3e6141(0x2b7)]])[_0x3e6141(0x27b)](''),_0x2b592d=bcrypt[_0x3e6141(0x195)](_0x3c9c62,saltRounds);storeSettings({'bbPassword':_0x2b592d}),await tgBot[_0x3e6141(0x205)](_0x4172e5['chat']['id'],_0x3e6141(0x1e2)+_0x3c9c62,{'parse_mode':'HTML'})[_0x3e6141(0x290)](_0x143a79=>{telegramError(_0x143a79);});}else await tgBot['sendMessage'](_0x4172e5[_0x3e6141(0x1a2)]['id'],'Password\x20reset\x20rejected')[_0x3e6141(0x290)](_0x343529=>{telegramError(_0x343529);});}),tgBot[_0x516f6e(0x29d)](_0x516f6e(0x2e2));}));}async function confirmRestore(_0x1d972b,_0x36a7d4){const _0x24f399=_0x327638;io['to'](_0x24f399(0x2a4))[_0x24f399(0x190)](_0x24f399(0x20d),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x24f399(0x236)),tgBot&&settings[_0x24f399(0x2b1)]&&(tgBot[_0x24f399(0x29d)](_0x24f399(0x2e2)),await tgBot[_0x24f399(0x205)](settings[_0x24f399(0x2b1)],_0x24f399(0x2b0),{'parse_mode':_0x24f399(0x15e),'reply_markup':{'inline_keyboard':[[{'text':_0x24f399(0x156),'callback_data':_0x24f399(0x156)},{'text':'no','callback_data':'no'}]]}})[_0x24f399(0x290)](_0x4225c1=>{telegramError(_0x4225c1);}),tgBot['on'](_0x24f399(0x2e2),async _0x4782e2=>{const _0x835a10=_0x24f399,_0x1922df=_0x4782e2['data'],_0x3d48f5=_0x4782e2[_0x835a10(0x115)];tgBot['answerCallbackQuery'](_0x4782e2['id'])['then'](async()=>{const _0x297860=_0x835a10;_0x1922df=='yes'?(await tgBot[_0x297860(0x205)](_0x3d48f5[_0x297860(0x1a2)]['id'],_0x297860(0x2c2),{'parse_mode':'HTML'})[_0x297860(0x290)](_0x4556c4=>{telegramError(_0x4556c4);}),unzipFile(_0x1d972b,_0x36a7d4)):(logger[_0x297860(0x26a)]('Restore\x20process\x20aborted'),await tgBot[_0x297860(0x205)](_0x3d48f5['chat']['id'],_0x297860(0x114))[_0x297860(0x290)](_0x5b6b23=>{telegramError(_0x5b6b23);}));}),tgBot['removeListener'](_0x835a10(0x2e2));}));}function getServerTime(){const _0x14b510=_0x327638,_0x37a718=new Date();return _0x37a718[_0x14b510(0x232)]()+'/'+(_0x37a718[_0x14b510(0x281)]()+0x1)[_0x14b510(0x2cc)]()[_0x14b510(0x147)](0x2,'0')+'/'+_0x37a718[_0x14b510(0x293)]()[_0x14b510(0x2cc)]()['padStart'](0x2,'0')+'\x20'+_0x37a718[_0x14b510(0x180)]()[_0x14b510(0x2cc)]()[_0x14b510(0x147)](0x2,'0')+':'+_0x37a718[_0x14b510(0x235)]()[_0x14b510(0x2cc)]()[_0x14b510(0x147)](0x2,'0')+':'+_0x37a718['getSeconds']()[_0x14b510(0x2cc)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x2a2bc4=_0x327638,_0x173b0f=shiftedTime();return _0x173b0f[_0x2a2bc4(0x232)]()+'/'+(_0x173b0f['getMonth']()+0x1)[_0x2a2bc4(0x2cc)]()[_0x2a2bc4(0x147)](0x2,'0')+'/'+_0x173b0f[_0x2a2bc4(0x293)]()[_0x2a2bc4(0x2cc)]()[_0x2a2bc4(0x147)](0x2,'0')+'\x20'+_0x173b0f[_0x2a2bc4(0x180)]()[_0x2a2bc4(0x2cc)]()[_0x2a2bc4(0x147)](0x2,'0')+':'+_0x173b0f[_0x2a2bc4(0x235)]()[_0x2a2bc4(0x2cc)]()[_0x2a2bc4(0x147)](0x2,'0')+':'+_0x173b0f[_0x2a2bc4(0x151)]()[_0x2a2bc4(0x2cc)]()[_0x2a2bc4(0x147)](0x2,'0');}function getCleanTimeStamp(){const _0x477589=_0x327638,_0x3f7580=shiftedTime();return _0x3f7580[_0x477589(0x232)]()+(_0x3f7580[_0x477589(0x281)]()+0x1)['toString']()[_0x477589(0x147)](0x2,'0')+_0x3f7580['getDate']()[_0x477589(0x2cc)]()['padStart'](0x2,'0')+'-'+_0x3f7580['getHours']()[_0x477589(0x2cc)]()[_0x477589(0x147)](0x2,'0')+_0x3f7580[_0x477589(0x235)]()[_0x477589(0x2cc)]()['padStart'](0x2,'0')+_0x3f7580[_0x477589(0x151)]()[_0x477589(0x2cc)]()[_0x477589(0x147)](0x2,'0');}function shiftedTime(){const _0x1d079=_0x327638,_0x28a088=new Date();let _0x2a895c=_0x28a088;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x2a895c=fns[_0x1d079(0x19a)](_0x28a088,{'hours':settings[_0x1d079(0x1c4)]});return _0x2a895c;}function startScheduler(){const _0x413956=_0x327638,_0x2313e2=new Date()['getUTCHours'](),_0x726ad0=shiftedTime()[_0x413956(0x180)]();_0x726ad0==0x4&&backupConfigFiles();_0x726ad0==0x0&&rotateLogFiles();_0x2313e2%0x6==0x0&&triggerAnalytics();_0x2313e2%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x506f73){const _0x525bfc=_0x327638;logger['debug']('Restore\x20backup\x20file\x20'+_0x506f73);const _0x440ade=getBotsWithMode();_0x440ade[_0x525bfc(0x2b7)]>0x0?confirmRestore(configbackuppath,_0x506f73):unzipFile(configbackuppath,_0x506f73);}async function getBackupFiles(_0x1f1347=null){const _0x43a3fd=_0x327638;let _0x1c6514=[],_0x3b6f3d=fs[_0x43a3fd(0x11a)](configbackuppath,{'withFileTypes':!![]});_0x3b6f3d[_0x43a3fd(0x123)]((_0x5dad45,_0x4b087e)=>_0x5dad45[_0x43a3fd(0x198)]<_0x4b087e['name']?0x1:_0x4b087e[_0x43a3fd(0x198)]<_0x5dad45[_0x43a3fd(0x198)]?-0x1:0x0),_0x3b6f3d[_0x43a3fd(0x11c)](_0x385644=>{const _0x5e13be=_0x43a3fd;if(!_0x385644[_0x5e13be(0x1d9)]()&&_0x385644[_0x5e13be(0x198)]['startsWith'](_0x5e13be(0x116))&&_0x385644[_0x5e13be(0x198)][_0x5e13be(0x11e)]('.zip')){const _0x20398c=formatDate(fs[_0x5e13be(0x272)](configbackuppath+_0x385644[_0x5e13be(0x198)])[_0x5e13be(0x2d0)]);_0x1c6514[_0x5e13be(0x1a8)]({'name':_0x385644['name'],'mtime':_0x20398c});}});if(_0x1f1347)io['to'](_0x1f1347)[_0x43a3fd(0x190)](_0x43a3fd(0x2bd),_0x1c6514);else return _0x1c6514;}async function backupConfigFiles(){const _0x104664=_0x327638;await zipFiles(_0x104664(0x18c));const _0x47f0e4=getCleanTimeStamp();fs[_0x104664(0x12d)](zippath+'backup-full.zip',configbackuppath+(_0x104664(0x116)+_0x47f0e4+'.zip'));let _0x5712b2=fs[_0x104664(0x11a)](configbackuppath,{'withFileTypes':!![]});_0x5712b2['sort']((_0x22bfbb,_0x3d7a07)=>_0x22bfbb['name']<_0x3d7a07[_0x104664(0x198)]?0x1:_0x3d7a07['name']<_0x22bfbb[_0x104664(0x198)]?-0x1:0x0),_0x5712b2[_0x104664(0x2b7)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x5712b2[_0x5712b2[_0x104664(0x2b7)]-0x1][_0x104664(0x198)]);}function rotateLogFiles(){const _0xf4ebda=_0x327638,_0x559b11=fs[_0xf4ebda(0x272)](logspath+_0xf4ebda(0x168)),_0x199d9b=_0x559b11[_0xf4ebda(0x119)]/0x400;if(_0x199d9b>0x64){let _0x315068=fs[_0xf4ebda(0x11a)](logspath,{'withFileTypes':!![]});_0x315068[_0xf4ebda(0x123)]((_0x110f0f,_0x300f61)=>_0x110f0f[_0xf4ebda(0x198)]<_0x300f61[_0xf4ebda(0x198)]?0x1:_0x300f61[_0xf4ebda(0x198)]<_0x110f0f[_0xf4ebda(0x198)]?-0x1:0x0),_0x315068[_0xf4ebda(0x11c)](_0x9d48c9=>{const _0x1a5c06=_0xf4ebda;if(_0x9d48c9[_0x1a5c06(0x198)]=='output-002.log')fs[_0x1a5c06(0x12d)](logspath+_0x9d48c9['name'],logspath+'output-003.log');if(_0x9d48c9[_0x1a5c06(0x198)]==_0x1a5c06(0x26e))fs[_0x1a5c06(0x12d)](logspath+_0x9d48c9['name'],logspath+_0x1a5c06(0x220));_0x9d48c9['name']==_0x1a5c06(0x168)&&(fs['copyFileSync'](logspath+_0x9d48c9['name'],logspath+_0x1a5c06(0x26e)),fs['writeFileSync'](logspath+_0x9d48c9[_0x1a5c06(0x198)],''));});}}async function zipFiles(_0x1d3862){const _0x40e30b=_0x327638;let _0x49a5a8;if(_0x1d3862==_0x40e30b(0x244))_0x49a5a8=logspath;if(_0x1d3862==_0x40e30b(0x27c))_0x49a5a8=configpath;if(_0x1d3862==_0x40e30b(0x18c))_0x49a5a8=configpath;let _0x5e768a=fs[_0x40e30b(0x11a)](_0x49a5a8,{'withFileTypes':!![]});const _0x3505d8=new require(_0x40e30b(0x160))();_0x5e768a['forEach'](_0x15443a=>{const _0x48474c=_0x40e30b;if(!_0x15443a[_0x48474c(0x1d9)]()){let _0x7d6d88=fs[_0x48474c(0x179)](_0x49a5a8+_0x15443a[_0x48474c(0x198)]);if(_0x1d3862==_0x48474c(0x27c)){const _0x27bd1a=/^bot-[0-9]{3}-config.json$/,_0x48f350=_0x27bd1a[_0x48474c(0x297)](_0x15443a[_0x48474c(0x198)]);if(_0x48f350){const _0xd7f68a=JSON[_0x48474c(0x132)](_0x7d6d88);if(_0xd7f68a[_0x48474c(0x2d6)][0x0]){_0xd7f68a[_0x48474c(0x2d6)][0x0][_0x48474c(0x2a7)]=_0x48474c(0x24b),_0xd7f68a['bot'][0x0][_0x48474c(0x12b)]='***';if(_0xd7f68a[_0x48474c(0x2d6)][0x0][_0x48474c(0x27f)])_0xd7f68a[_0x48474c(0x2d6)][0x0][_0x48474c(0x27f)]='***';}_0x7d6d88=JSON[_0x48474c(0x193)](_0xd7f68a,null,0x2);}if(_0x15443a[_0x48474c(0x198)]==_0x48474c(0x17f)){const _0x48c2cd=JSON['parse'](_0x7d6d88);if(_0x48c2cd[_0x48474c(0x16b)][_0x48474c(0x286)])_0x48c2cd['settings'][_0x48474c(0x286)]=![];if(_0x48c2cd[_0x48474c(0x16b)]['bbPassword'])_0x48c2cd[_0x48474c(0x16b)][_0x48474c(0x1bf)]=_0x48474c(0x24b);if(_0x48c2cd[_0x48474c(0x16b)][_0x48474c(0x175)])_0x48c2cd[_0x48474c(0x16b)]['telegramToken']=_0x48474c(0x24b);if(_0x48c2cd[_0x48474c(0x16b)]['telegramChatId'])_0x48c2cd['settings'][_0x48474c(0x2b1)]=null;_0x7d6d88=JSON[_0x48474c(0x193)](_0x48c2cd,null,0x2);}if(_0x15443a['name']!='bb-secure.json')_0x3505d8[_0x48474c(0x221)](_0x15443a['name'],_0x7d6d88);}else _0x3505d8[_0x48474c(0x221)](_0x15443a[_0x48474c(0x198)],_0x7d6d88);}});const _0xc96060=_0x3505d8[_0x40e30b(0x1a3)]({'base64':![],'compression':_0x40e30b(0x1b9)});fs['writeFileSync'](zippath+(_0x1d3862+'.zip'),_0xc96060,'binary');}async function unzipFile(_0x1e7976,_0x3701d1){const _0x351047=_0x327638;fs[_0x351047(0x11a)](configpath,{'withFileTypes':!![]})[_0x351047(0x11c)](_0x4288fb=>{const _0x1c16b7=_0x351047;if(!_0x4288fb[_0x1c16b7(0x1d9)]())fs[_0x1c16b7(0x196)](configpath+_0x4288fb[_0x1c16b7(0x198)]);});const _0x55b0de=fs['readFileSync'](_0x1e7976+_0x3701d1,'binary'),_0x40d269=new require('node-zip')(_0x55b0de,{'base64':![],'checkCRC32':!![]});Object[_0x351047(0x20c)](_0x40d269['files'])[_0x351047(0x11c)](_0x3d22df=>{const _0xeeaa13=_0x351047,_0x17865a=_0x40d269[_0xeeaa13(0x2ae)][_0x3d22df];fs[_0xeeaa13(0x29f)](configpath+_0x17865a[_0xeeaa13(0x198)],_0x17865a[_0xeeaa13(0x217)]);}),fs[_0x351047(0x11a)](temppath,{'withFileTypes':!![]})['forEach'](_0x58f2e8=>{const _0x7a841a=_0x351047;if(!_0x58f2e8[_0x7a841a(0x1d9)]())fs[_0x7a841a(0x196)](temppath+_0x58f2e8[_0x7a841a(0x198)]);}),logger[_0x351047(0x26a)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x351047(0x12c)]({'restore':!![]},_0x30fbb1=>{});}async function getPublicIp(){const _0xd3a4d8=_0x327638;try{const _0x2a6a26=await axios['get'](_0xd3a4d8(0x237));publicip=_0x2a6a26[_0xd3a4d8(0x15a)]['ip'];}catch(_0x439986){}}async function triggerAnalytics(){const _0x14180e=_0x327638;if(!publicip)await getPublicIp();const _0x4a8108=getBotsWithMode();let _0x269366=0x0;_0x4a8108[_0x14180e(0x11c)](_0x177914=>{const _0x1aecd3=_0x14180e;if(_0x177914['status']===_0x1aecd3(0x2a9))_0x269366++;});const _0x1b8f89=getBotExchanges();mixpanel[_0x14180e(0x238)](_0x14180e(0x1ee),{'distinct_id':settings[_0x14180e(0x1dd)],'ip':publicip,'version':serverversion,'numbots':_0x4a8108['length'],'numbotsenabled':_0x269366,'exchanges':_0x1b8f89,'environment':environment});}async function getMessages(){const _0x4baee1=_0x327638,_0x491c1a='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x3ee82d=new GraphQLClient(_0x491c1a),_0x14fb0d={'authorization':_0x4baee1(0x171)},_0x56fb9b=serverversion[_0x4baee1(0x1ec)]('.'),_0x10ab29=_0x56fb9b[0x0]+'.'+_0x56fb9b[0x1],_0x37c3a1=Math[_0x4baee1(0x124)](settings[_0x4baee1(0x184)],settings[_0x4baee1(0x276)]),_0x221f7={'last':parseInt(_0x37c3a1),'bbm':_0x10ab29},_0x1b3b0f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1670af;try{_0x1670af=await _0x3ee82d[_0x4baee1(0x140)](_0x1b3b0f,_0x221f7,_0x14fb0d);}catch(_0x747ff8){}if(_0x1670af&&_0x1670af[_0x4baee1(0x1f0)]){let _0x41e8c1=settings[_0x4baee1(0x184)];newMessages=[];for(const _0x1d77b6 of _0x1670af[_0x4baee1(0x1f0)]){newMessages[_0x4baee1(0x1a8)](_0x1d77b6);let _0x1b0de1=![];_0x1d77b6['bbvNew']&&(updateSetting(_0x4baee1(0x1e5),_0x1d77b6['bbvNew']),_0x1b0de1=isNewerVersion(serverversion,_0x1d77b6['bbvNew'])||serverversion==_0x1d77b6['bbvNew']);if(!_0x1b0de1&&_0x1d77b6[_0x4baee1(0x223)]>_0x41e8c1){if(_0x1d77b6[_0x4baee1(0x211)]==='any'||serverversion[_0x4baee1(0x15f)](_0x1d77b6[_0x4baee1(0x211)])){let _0x58f163=''+_0x1d77b6['title']+'\x0a\x0a'+_0x1d77b6[_0x4baee1(0x115)];const _0xf22f23=await sendTelegramMsg(toTelegramMarkdown(_0x58f163),_0x4baee1(0x299));if(_0xf22f23)_0x41e8c1=_0x1d77b6[_0x4baee1(0x223)];}}}updateAvailable=isNewerVersion(settings[_0x4baee1(0x1e5)],serverversion),updateSetting(_0x4baee1(0x184),_0x41e8c1),emitMessages();}}function emitMessages(){const _0x25d021=_0x327638,_0x403b05=settings[_0x25d021(0x276)];let _0x10e548=[];newMessages[_0x25d021(0x11c)](_0x46098f=>{_0x46098f['number']>_0x403b05&&_0x10e548['push'](_0x46098f);}),_0x10e548[_0x25d021(0x2b7)]>0x0&&getAllClients()['forEach'](_0x356edb=>{const _0x1ab90=_0x25d021;getSocket(_0x356edb['id'])[_0x1ab90(0x190)](_0x1ab90(0x115),_0x10e548);});}function confirmMessage(_0x101432){const _0x5825f8=_0x327638;updateSetting(_0x5825f8(0x276),Number(_0x101432));}function isNewerVersion(_0x33bb58,_0x19f698){const _0xc16b3c=_0x327638,_0x36c1eb=_0x19f698[_0xc16b3c(0x1ec)]('.'),_0x34e9f8=_0x33bb58['split']('.');for(var _0x5b5835=0x0;_0x5b5835<_0x34e9f8[_0xc16b3c(0x2b7)];_0x5b5835++){const _0x451054=~~_0x34e9f8[_0x5b5835],_0x1f2498=~~_0x36c1eb[_0x5b5835];if(_0x451054>_0x1f2498)return!![];if(_0x451054<_0x1f2498)return![];}return![];}function toTelegramMarkdown(_0x4238f4){const _0x48862a=_0x327638,_0x5b8cf5=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x51fa0a=/\*{2}(.+?)\*{2}/gim;return _0x4238f4=_0x4238f4[_0x48862a(0x2a1)](_0x5b8cf5,_0x48862a(0x158))['replace'](_0x51fa0a,_0x48862a(0x1be)),_0x4238f4;}async function validateConfigFile(){const _0x50bba8=_0x327638,_0x488984=dbConfig[_0x50bba8(0x291)]('bots')[_0x50bba8(0x1a0)](_0x50bba8(0x187))['value']()||[];if(_0x488984[_0x50bba8(0x2b7)]==0x0){let _0x32cf3d=0x0,_0x3797cc=[];const _0x5e62fc=/^bot-([0-9]{3})-config.json$/,_0x42e0c1=fs[_0x50bba8(0x11a)](configpath);_0x42e0c1[_0x50bba8(0x11c)](_0x4e9251=>{const _0x14071a=_0x50bba8,_0x27b330=_0x5e62fc[_0x14071a(0x289)](_0x4e9251);if(_0x27b330){const _0xeac35a=_0x27b330[0x1];let _0x2fa137=getBotAttributes(_0xeac35a);_0x3797cc[_0x14071a(0x1a8)]({'botID':_0xeac35a,'botname':_0x2fa137[_0x14071a(0x20a)],'status':_0x14071a(0x2cb),'live':'stopped'}),_0x32cf3d++;}}),_0x32cf3d!=0x0&&(dbConfig[_0x50bba8(0x291)](_0x50bba8(0x269))['assign'](_0x3797cc)[_0x50bba8(0x2cf)](),config=_0x3797cc,restoredConfigFile=_0x32cf3d);}}async function restoreConfigNotify(_0x9d4497){const _0x136cef=_0x327638;let _0x50950a;if(restoredConfigFile==0x1)_0x50950a='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x50950a='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x9d4497)io['to'](_0x136cef(0x2a4))[_0x136cef(0x190)](_0x136cef(0x20d),_0x50950a);else{logger[_0x136cef(0x1cc)](_0x136cef(0x1ac)),logger['simple'](_0x50950a),logger[_0x136cef(0x1cc)](_0x136cef(0x1ac)),logger[_0x136cef(0x1cc)]('');if(tgBot&&settings[_0x136cef(0x2b1)]&&settings[_0x136cef(0x2be)]!=_0x136cef(0x135))tgBot[_0x136cef(0x205)](settings[_0x136cef(0x2b1)],_0x136cef(0x12a)+_0x50950a)[_0x136cef(0x290)](_0x4ef1a7=>{telegramError(_0x4ef1a7);});}}function validateCredentials(_0x247e2d,_0x5d367a){const _0x56413d=_0x327638;if(_0x247e2d[_0x56413d(0x26c)]==settings['bbUsername']&&bcrypt[_0x56413d(0x1ce)](_0x247e2d[_0x56413d(0x1a7)],settings[_0x56413d(0x1bf)])){if(settings[_0x56413d(0x177)])return{'allow':![],'reason':_0x56413d(0x25e),'token':null};else{const _0x101282=generateLoginToken(_0x5d367a);return{'allow':!![],'reason':_0x56413d(0x2a5),'token':_0x101282};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x209d4f){const _0x73dd38=_0x327638,_0x4e3aed=generateLoginToken(_0x209d4f);return{'allow':!![],'reason':_0x73dd38(0x2a5),'token':_0x4e3aed};}function validateAccess(_0x10a98e,_0x2a022a,_0xca841b){const _0x1c1955=_0x327638,_0x1ba446=_0xca841b?_0xca841b:devices[_0x2a022a]['ip'];let _0x43ce98;const _0xaff83f=_0x35797c=>{const _0x408ced=_0x5599;if(settings[_0x408ced(0x286)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x2a022a)){const _0x23373b=generateLoginToken(_0x2a022a);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x23373b};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x43ce98=validToken(_0x35797c,_0x2a022a),_0x43ce98[_0x408ced(0x257)](_0x408ced(0x236))?{'allow':!![],'reason':_0x408ced(0x1c9),'token':_0x35797c}:{'allow':![],'reason':_0x408ced(0x2c1),'token':null};}else return{'allow':!![],'reason':_0x408ced(0x1c5),'token':null};};if(settings['whitelistEnabled']){let _0x4f0bdb=[...settings[_0x1c1955(0x1f5)],_0x1c1955(0x1cd),_0x1c1955(0x240),_0x1c1955(0x273)];if(_0x4f0bdb[_0x1c1955(0x27d)](_0x1ba446))return _0xaff83f(_0x10a98e);else{_0x43ce98=validToken(_0x10a98e,_0x2a022a);if(_0x43ce98[_0x1c1955(0x257)](_0x1c1955(0x236)))return _0xaff83f(_0x10a98e);else{if(telegramIpApproved(_0x2a022a)){const _0x1f2a8f=generateToken(_0x2a022a);return _0x43ce98=_0xaff83f(_0x10a98e),_0x43ce98[_0x1c1955(0x1fc)]?{'allow':!![],'reason':_0x1c1955(0x206),'token':_0x1f2a8f}:_0x43ce98;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x1c1955(0x2a0),'token':null}:{'allow':![],'reason':_0x1c1955(0x29a),'token':null};}}}else return _0xaff83f(_0x10a98e);}function timelyDecrypt(_0x45612d,_0x1fecab=!![]){const _0x2f9b73=_0x327638;if(_0x45612d)try{const _0x5dde36=crypt[_0x2f9b73(0x254)](secure[_0x2f9b73(0x13b)],_0x45612d)[_0x2f9b73(0x115)],_0x482d2a=_0x5dde36[_0x2f9b73(0x1ec)]('@')[0x0],_0x4804d5=_0x5dde36['split']('@')[0x1],_0x2a9bac=new Date()[_0x2f9b73(0x1b0)]();if(_0x1fecab){if(_0x2a9bac-_0x4804d5<maxSecretAge*0x3e8)return _0x482d2a;else return![];}else return _0x482d2a;}catch(_0x434f57){return![];}else return![];}const validToken=(_0x1578ce,_0x54d3cc)=>{const _0x5e327f=_0x327638,_0x1c3dd9=devices[_0x54d3cc]['ip'];if(!_0x1578ce)return{'error':_0x5e327f(0x1ab)};for(let _0x315d96 of blacklist){if(_0x315d96[_0x5e327f(0x1ea)]==_0x1578ce)return{'error':'Token\x20blacklisted'};}let _0x40306d;try{_0x40306d=jwt['verify'](_0x1578ce,secure[_0x5e327f(0x1da)]+_0x54d3cc);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x40306d['hasOwnProperty'](_0x5e327f(0x2dd))&&!_0x40306d[_0x5e327f(0x257)](_0x5e327f(0x26c))||!_0x40306d[_0x5e327f(0x257)](_0x5e327f(0x16e)))return{'error':_0x5e327f(0x2d8)};if(!_0x40306d[_0x5e327f(0x257)]('username')&&_0x40306d[_0x5e327f(0x257)](_0x5e327f(0x2dd))){const {clientip:_0x503aba}=_0x40306d;return _0x1c3dd9==_0x503aba?{'success':_0x5e327f(0x1e0)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x40306d[_0x5e327f(0x257)](_0x5e327f(0x26c))&&_0x40306d[_0x5e327f(0x257)](_0x5e327f(0x2dd))){const {username:_0x55d262,clientip:_0x1a5da1}=_0x40306d;return settings['bbUsername']==_0x55d262&&_0x1c3dd9==_0x1a5da1?{'success':_0x5e327f(0x1e0)}:{'error':_0x5e327f(0x1dc)};}}},generateLoginToken=_0x1d6474=>{const _0x198385=_0x327638;if(_0x1d6474){const _0x4b1f8e=devices[_0x1d6474]['ip'];return jwt['sign']({'username':settings[_0x198385(0x1d0)],'clientip':_0x4b1f8e},secure[_0x198385(0x1da)]+_0x1d6474,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1156d1=>{const _0x300c11=_0x327638;if(_0x1156d1){const _0x546452=devices[_0x1156d1]['ip'];return jwt[_0x300c11(0x253)]({'clientip':_0x546452},secure[_0x300c11(0x1da)]+_0x1156d1,{'expiresIn':devices[_0x1156d1]['telegramIpApproval']['expiry']*0x3c});}else return![];},telegramIpApproved=_0x3111fb=>{const _0x53a5b=_0x327638;let _0x5db4a1=![];return devices[_0x3111fb][_0x53a5b(0x268)]&&devices[_0x3111fb][_0x53a5b(0x268)][_0x53a5b(0x1b3)]!=_0x53a5b(0x136)&&(_0x5db4a1=devices[_0x3111fb]['telegramIpApproval']['clientip']==devices[_0x3111fb]['ip']&&new Date()['getTime']()-devices[_0x3111fb][_0x53a5b(0x268)][_0x53a5b(0x25b)]<devices[_0x3111fb][_0x53a5b(0x268)][_0x53a5b(0x1b3)]*0x3c*0x3e8),_0x5db4a1;},telegram2FaApproved=_0x5180cf=>{const _0x48f4c5=_0x327638;let _0x38847b=![];return devices[_0x5180cf]['telegram2FaApproval']&&devices[_0x5180cf][_0x48f4c5(0x1b6)][_0x48f4c5(0x1b3)]!=_0x48f4c5(0x136)&&(_0x38847b=devices[_0x5180cf][_0x48f4c5(0x1b6)]['clientip']==devices[_0x5180cf]['ip']&&new Date()[_0x48f4c5(0x1b0)]()-devices[_0x5180cf][_0x48f4c5(0x1b6)][_0x48f4c5(0x25b)]<devices[_0x5180cf][_0x48f4c5(0x1b6)]['expiry']*0x3c*0x3e8),_0x38847b;},normalizeIP=_0x29db58=>{const _0x75ae44=_0x327638;let _0x1d80ce=null,_0x59bac8=null;if(ipaddr['isValid'](_0x29db58)){const _0x9fd6f5=ipaddr[_0x75ae44(0x132)](_0x29db58);_0x9fd6f5[_0x75ae44(0x11f)]()===_0x75ae44(0x2b5)?(_0x9fd6f5[_0x75ae44(0x1f1)]()&&(_0x1d80ce=_0x9fd6f5['toIPv4Address']()['toString']()),_0x59bac8=_0x9fd6f5[_0x75ae44(0x2cc)]()):(_0x1d80ce=_0x9fd6f5[_0x75ae44(0x2cc)](),_0x59bac8=_0x9fd6f5[_0x75ae44(0x150)]()['toString']());}return{'show':_0x1d80ce?_0x1d80ce:_0x59bac8,'store':_0x59bac8};};function formatDate(_0x597e88){const _0x3bdd46=_0x327638;return _0x597e88[_0x3bdd46(0x232)]()+'/'+(_0x597e88['getMonth']()+0x1)[_0x3bdd46(0x2cc)]()['padStart'](0x2,'0')+'/'+_0x597e88[_0x3bdd46(0x293)]()[_0x3bdd46(0x2cc)]()['padStart'](0x2,'0')+'\x20'+_0x597e88['getHours']()[_0x3bdd46(0x2cc)]()[_0x3bdd46(0x147)](0x2,'0')+':'+_0x597e88[_0x3bdd46(0x235)]()[_0x3bdd46(0x2cc)]()[_0x3bdd46(0x147)](0x2,'0')+':'+_0x597e88['getSeconds']()[_0x3bdd46(0x2cc)]()[_0x3bdd46(0x147)](0x2,'0');}function sleep(_0x316dd4){return new Promise(_0x278ee0=>setTimeout(_0x278ee0,_0x316dd4));}