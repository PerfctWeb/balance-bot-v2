const _0x348e82=_0x2db2;(function(_0x395361,_0x429345){const _0x3a0cbe=_0x2db2,_0x36c844=_0x395361();while(!![]){try{const _0x161a75=parseInt(_0x3a0cbe(0xc1))/0x1*(parseInt(_0x3a0cbe(0xc5))/0x2)+parseInt(_0x3a0cbe(0xd0))/0x3+-parseInt(_0x3a0cbe(0xcc))/0x4+parseInt(_0x3a0cbe(0x200))/0x5+parseInt(_0x3a0cbe(0x1e8))/0x6+parseInt(_0x3a0cbe(0x182))/0x7+-parseInt(_0x3a0cbe(0x110))/0x8*(parseInt(_0x3a0cbe(0x203))/0x9);if(_0x161a75===_0x429345)break;else _0x36c844['push'](_0x36c844['shift']());}catch(_0x3a0069){_0x36c844['push'](_0x36c844['shift']());}}}(_0x3009,0xa953b));const _0x5dff47=function(){let _0x43b357=!![];return function(_0x9e860b,_0x2303fd){const _0x2d3a2b=_0x43b357?function(){const _0x239bc2=_0x2db2;if(_0x2303fd){const _0x3a9396=_0x2303fd[_0x239bc2(0x122)](_0x9e860b,arguments);return _0x2303fd=null,_0x3a9396;}}:function(){};return _0x43b357=![],_0x2d3a2b;};}(),_0x54c5e3=_0x5dff47(this,function(){const _0x3a6454=_0x2db2;return _0x54c5e3['toString']()['search'](_0x3a6454(0x252))[_0x3a6454(0x1ec)]()[_0x3a6454(0x286)](_0x54c5e3)[_0x3a6454(0x1c4)](_0x3a6454(0x252));});_0x54c5e3();'use strict';process['env'][_0x348e82(0x166)]=0x1;const childProcess=require(_0x348e82(0x23e)),fs=require('fs'),fns=require('date-fns'),low=require(_0x348e82(0x16d)),FileSync=require(_0x348e82(0x136)),path=require('path'),crypto=require(_0x348e82(0xbf)),Crypt=require(_0x348e82(0xb1))['Crypt'],RSA=require(_0x348e82(0xb1))[_0x348e82(0xac)],bcrypt=require(_0x348e82(0x181)),jwt=require(_0x348e82(0xce)),ipaddr=require(_0x348e82(0xc0)),argv=require(_0x348e82(0x103))(process[_0x348e82(0x1f5)][_0x348e82(0x278)](0x2))[_0x348e82(0x1f5)],uuidRandom=require(_0x348e82(0x19f)),{Telegraf,Markup}=require(_0x348e82(0x1e6)),Mixpanel=require(_0x348e82(0x12f)),axios=require(_0x348e82(0x24b)),{GraphQLClient,gql}=require(_0x348e82(0x274)),util=require(_0x348e82(0x21b)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x348e82(0xf0)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x348e82(0x23c)](PORT)&&(console[_0x348e82(0x25a)](_0x348e82(0x1d6)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x348e82(0x124)](0x1));const HOST=argv[_0x348e82(0x11e)]||null,userID=argv[_0x348e82(0x293)]||'',debugging=argv['d']||![],nodeversion=process[_0x348e82(0x175)]['node'];let bbpath=_0x348e82(0xbd),bbpath2='';const botfile=_0x348e82(0x13e),configfile='bb-config.json',settingsfile=_0x348e82(0x163),securefile=_0x348e82(0x1eb),environment=require('./'+bbpath2+'version.json')[_0x348e82(0xc6)]||_0x348e82(0x208),maxBackups=0xa;let validInstallation=!![];!fs[_0x348e82(0x253)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x348e82(0x10c)),configpath=userID?bbpath+_0x348e82(0xb2)+userID+'/':bbpath+_0x348e82(0xb2),configbackuppath=configpath+_0x348e82(0x1b7),logspath=userID?bbpath+_0x348e82(0xb9)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x348e82(0xeb)+userID+'/':bbpath+_0x348e82(0xeb),loggerfile=fs['createWriteStream'](logspath+_0x348e82(0x1dd),{'flags':'a'}),temppath=userID?bbpath+_0x348e82(0xda)+userID+'/':bbpath+'temp/';!fs[_0x348e82(0x253)](configpath)&&fs[_0x348e82(0xff)](configpath);!fs[_0x348e82(0x253)](configbackuppath)&&fs[_0x348e82(0xff)](configbackuppath);!fs[_0x348e82(0x253)](logspath)&&fs[_0x348e82(0xff)](logspath);!fs[_0x348e82(0x253)](zippath)&&fs[_0x348e82(0xff)](zippath);!fs[_0x348e82(0x253)](temppath)&&fs[_0x348e82(0xff)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x348e82(0x18d)]({'bots':[]})[_0x348e82(0x15a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x2db2(_0x59059c,_0x27ad2a){const _0x13626a=_0x3009();return _0x2db2=function(_0x54c5e3,_0x5dff47){_0x54c5e3=_0x54c5e3-0xa3;let _0x30094b=_0x13626a[_0x54c5e3];return _0x30094b;},_0x2db2(_0x59059c,_0x27ad2a);}dbSettings[_0x348e82(0x18d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x348e82(0xa3),'onepagemode':![]}})[_0x348e82(0x15a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x348e82(0x18d)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x348e82(0x13c),'rsaStandard':_0x348e82(0x1ca)});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x348e82(0x10f)]&&(settings[_0x348e82(0x10f)]!=''&&settings[_0x348e82(0x10f)]!=_0x348e82(0x138))&&settings[_0x348e82(0x25e)]&&settings[_0x348e82(0x25e)]!='')initTelegram();const parseColor=(_0x25562f,_0x41ed87)=>{const _0x5f08d8=_0x348e82,_0x2a5bf3=/#[A-Z]{3}#/g;if(typeof _0x25562f==_0x5f08d8(0xe2)){!_0x41ed87?_0x25562f=_0x25562f['replace'](_0x2a5bf3,''):(_0x25562f=_0x25562f[_0x5f08d8(0x147)](/#BLU#/g,_0x5f08d8(0x158)),_0x25562f=_0x25562f[_0x5f08d8(0x147)](/#RED#/g,_0x5f08d8(0x237)),_0x25562f=_0x25562f[_0x5f08d8(0x147)](/#YEL#/g,_0x5f08d8(0x161)),_0x25562f=_0x25562f[_0x5f08d8(0x147)](/#MAG#/g,_0x5f08d8(0x1d0)),_0x25562f=_0x25562f[_0x5f08d8(0x147)](/#CYA#/g,_0x5f08d8(0x1f2)),_0x25562f=_0x25562f[_0x5f08d8(0x147)](/#RES#/g,'\x1b[0m'));;}return _0x25562f;},logger={'screen':_0xb93533=>{console['log'](parseColor(_0xb93533,!![]));},'simple':_0x322ee6=>{const _0x51d1cc=_0x348e82;console[_0x51d1cc(0x25a)](parseColor(_0x322ee6,!![])),loggerfile['write'](util[_0x51d1cc(0x19d)](parseColor(_0x322ee6,![]))+'\x0a');},'full':async _0x365ee6=>{const _0x962f15=_0x348e82,_0x2b554e=getTimeStamp()+_0x962f15(0x23d)+_0x365ee6;console[_0x962f15(0x25a)](parseColor(_0x2b554e,!![])),loggerfile[_0x962f15(0x15a)](util['format'](parseColor(_0x2b554e,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x962f15(0xc2)]!=_0x962f15(0x1f8))await sendTelegram(settings[_0x962f15(0x115)],_0x962f15(0x28f)+parseColor(_0x365ee6,![]));},'debug':async(_0x285a59,_0x381aac='')=>{const _0x1c6214=_0x348e82,_0x61e1ba=getTimeStamp()+_0x1c6214(0x108)+_0x285a59;if(debugging)console[_0x1c6214(0x25a)](parseColor(_0x61e1ba,!![]));loggerfile[_0x1c6214(0x15a)](util[_0x1c6214(0x19d)](parseColor(_0x61e1ba,![]))+'\x0a');if(_0x381aac){if(debugging)console[_0x1c6214(0x25a)](_0x381aac);loggerfile[_0x1c6214(0x15a)](util[_0x1c6214(0x19d)](_0x381aac)+'\x0a');}}};let terminating=![];process['on'](_0x348e82(0x18a),function(_0x31aa1d){const _0x47d1e4=_0x348e82;logger[_0x47d1e4(0x1ee)](_0x31aa1d);}),process['on'](_0x348e82(0x124),()=>{const _0xe31514=_0x348e82;console[_0xe31514(0x25a)](_0xe31514(0x1cd)),stopAllBots(),process['exit'](0x0);}),process['on'](_0x348e82(0x295),()=>{const _0x12273e=_0x348e82;console[_0x12273e(0x25a)](_0x12273e(0x1ab)),stopAllBots(),process[_0x12273e(0x124)](0x0);}),process['on'](_0x348e82(0x29e),()=>{const _0x446033=_0x348e82;console[_0x446033(0x25a)](_0x446033(0x1fe)),stopAllBots(),process[_0x446033(0x124)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x348e82(0x29c))[_0x348e82(0x1f1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x348e82(0x1e4)),app=express(),http=require(_0x348e82(0x1fb))['createServer'](app);function _0x3009(){const _0x2b653e=['show-config','Notifications\x20types:\x20','express','Invalid\x20authentication\x20token\x20(1)','telegraf','number','4382790GABawj','disconnect','kind','bb-secure.json','toString','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','simple','#RES#\x20','password','version','\x1b[36m','mtime','output-003.log','argv','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','conn','orders','manual','padStart','http','name','Logged\x20out\x20user\x20...','BM\x20received\x20sigint\x20signal','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','1761340JFDJiv','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Session\x20expired\x20for\x20user\x20...','1888398ZbUIfS','secret','startsWith','Disabled\x20Bot\x20','inherit','production','order','loginRequired','login2fa_reject_','placeOrder','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Restore\x20process\x20confirmed','login','getFullYear','apiPassword','15\x20min','success','exec','family','reset-history','headers','User\x20has\x20been\x20validated','live','temporary\x20token\x20generated','util','Starting\x20(','parse','encryptedUuid','file','unlinkSync','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Notifications\x20enabled\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','isDirectory','compareSync','Orders','metrics_','backup-full.zip','Unauthorized\x20attempt\x20to\x20update\x20settings','telegram2FaApproval','access','value','split','toggle-bot-mode','tkn','disable','.zip','token','deleteHistoryAlerts','privateKey','get-backup-files','Network\x20Interfaces:','\x1b[31m','any','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','login\x20not\x20required','get-messages','test',':\x20Bot\x20Mgr\x20>\x20','child_process','botmanager','Deleted\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','\x20|\x20client:\x20...','/restart\x20-\x20restart\x20bot(s)\x0a','all','confirm-message','store-configuration','logs','/:bot/coins','sign','names','axios','/update\x20-\x20update\x20Balance\x20Bot\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','bots','#RES#\x20if\x20running\x20on\x20server','All\x20bots','\x20mode','(((.+)+)+)+$','existsSync','Notifications\x20disabled\x0a','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20bot','settings.','f2aRequired','tempaccess_5_','log','Unauthorized\x20login\x20attempt\x20(timeout)','Invalid\x20username\x20or\x20IP\x20address','debug','telegramUsername','config_alerts','login\x20required','once','staging','restore_yes_','bbvReceive','reset-password','Error\x20removing\x20old\x20backup\x20files:','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','reason','text','copyFileSync','Enabled\x20Bot\x20','size','remoteAddress','store-fiat','notification','Ok,\x20will\x20send\x20alert\x20notifications\x20only','error','Invalid\x20IP\x20address','getTime','graphql-request','includes','restore_no_','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','slice','-results.json','botID','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','from','/names\x20-\x20show\x20bot\x20names\x0a','/:bot/support','-----------------------------------------------------------------------------------','username','endsWith','type','_data','delete-bot','running','constructor','/off\x20-\x20stop\x20bot(s)\x0a','callback','find','DEFLATE','pidRefreshToken','output-002.log','push','telegramEnabled','Bot\x20Mgr\x20>\x20','build','disabled','socket','user','forEach','SIGTERM','backup-files','button','************','config_all','reload','assign','version.json','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','SIGINT','join','referer','0.0.0','whitelistEnabled','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','keys','isIPv4MappedAddress','getMonth','stringify','reinstall_yes','showConfig','RSA','add-bot','expiry','off','initclient','hybrid-crypto-js','config/','removeAllListeners','update','clientip','timeshift','toggle_','off_','logs/','\x20minutes','telegram','function','bb/','auth','crypto','ipaddr.js','6121TDhyGJ','telegramEvents','\x20(1)','private','340kpJdYg','environment','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','emit','place-order','Token\x20blacklisted','map','3618024EGCyJz','onepagemode','jsonwebtoken','writeFileSync','1322430osBspi','title','/upload-backup','settings','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','No\x20authentication\x20token','params','server','statSync','config','temp/','hex','randomFillSync','Error\x20while\x20deleting\x20config\x20files:\x20','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','getMinutes','status','enabled','string','getHours','::1','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','reply','Unauthorized\x20attempt\x20to\x20add\x20bot','invalid\x20credentials','HTML','Alerts','zip/','get-starting-balances','sendFile','output-000.log','sendPortfolioTelegram','port','bot-','/disable\x20-\x20disable\x20notifications\x0a','update_yes','storeConfiguration','message','mode','warning','(staging)','/enable\x20-\x20enable\x20notifications\x0a','match','getUTCHours','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','2FA\x20login\x20required','decrypt','mkdirSync','Node.js\x20v','min','rmSync','yargs/yargs','/:bot','editMessageReplyMarkup','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','telegrammsg',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','-config.json','toggle','restart','clients','Markdown','download','telegramToken','80oapZlC','uuid','/start','getStartingBalances','access\x20timeout','telegramChatId','resetHistory','bbvNew','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','All','backup','hashSync',')\x20|\x20Bot\x20','store-settings','host','userid','add','post','apply','Server','exit','::ffff:127.0.0.1','1000','login\x20token\x20generated','start','alerts','handshake','\x20|\x20','new','5\x20min','inlineKeyboard','mixpanel','lastmsgemitted','new-disabled','Notifications\x20enabled','full','Yes','File\x20uploaded','lowdb/adapters/FileSync','verify','***','enable','action','getPortfolio','sha256','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','bot.js','temporary\x20access\x20timeout','publicKey','Access\x20enabled\x20for\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','auto','$1_$2_$3','Restarting\x20Bot\x20','reject','replace','exp','command','update-bb','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','close','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Starting\x20Balance\x20Bot\x20reinstallation','ipc','bot','[ip-address]','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','use','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Restore\x20process\x20aborted','config_orders','\x1b[34m','Password\x20reset\x20rejected','write','index.html','blacklist','show','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','reinstall','botname','\x1b[33m','Restore\x20backup\x20file\x20','bb-settings.json','bbPassword','Setting\x20access:\x20','NTBA_FIX_319','restore-backup-file','yes','static','cancelLoading','bbUsername','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','lowdb',')\x20\x20\x20|\x20Bot\x20','/:bot/portfolio','stopped','restart_','data','sendMetricsTelegram','2FA\x20login\x20token\x20generated','versions','timestamp','Starting\x20Balance\x20Bot\x20update','getDate','set','emitHistory','Bot\x20','event','secure','sendMessage','toIPv4Address','temporaryAccessAllowed','bcryptjs','7925232cqbSaG','/:bot/configuration','internal','pidExpireLogin','-performance.json','portfolio_','readFileSync','cloneDeep','uncaughtException','Unauthorized\x20attempt\x20to\x20get\x20messages','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','defaults','getSeconds','files','resetpw_yes','whitelist','length','send','socket.io','filter','tempaccess_reject_','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','exchange','Unauthorized\x20attempt\x20to\x20download\x20','sort','Restoring\x20bot(s)\x20from\x20backup','logged\x20out','format','address','uuid-random','Ok,\x20will\x20send\x20order\x20notifications\x20only','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','hasOwnProperty','Unauthorized\x20attempt\x20to\x20confirm\x20message','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20delete\x20bot','update_no','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Idling\x20(','kill','BM\x20received\x20sigterm\x20signal','storeHeadless','Password\x20has\x20been\x20reset\x20to:\x20','No\x20bots\x20running\x20right\x20now','node-zip','chat','entries','listen','request','lastmsgtelegram','reinstall_no','track','backup/','IPv4','Unauthorized\x20attempt\x20to\x20get\x20events','messages','latestversion','get','build2','stop','tempaccess_15_','headless','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegramIpApproval','search','<b>Balance\x20Bot\x20Status:</b>\x0a','Logged\x20in\x20user\x20...','Allow\x20login\x20from\x20IP\x20address\x20','fork','binary','RSA-OAEP','store','temporary\x20access\x20rejected','BM\x20received\x20exit\x20signal','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','\x1b[35m','/metrics\x20-\x20show\x20bot\x20performance\x0a','sortBy','Failed\x20to\x20download\x20','=>\x20Go\x20to\x20#CYA#http://','Unauthorized\x20attempt\x20to\x20log\x20out','Error:\x20Invalid\x20argument\x20','output-001.log','allow','30\x20min','backup-full@','remove','on_','/output-000.log','ipv6','readdirSync','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Starting\x20new\x20bot\x20|\x20Bot\x20'];_0x3009=function(){return _0x2b653e;};return _0x3009();}app['use'](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x544ad8,_0x36616b)=>{const _0x3ef2bf=_0x348e82,_0x310146=_0x544ad8[_0x3ef2bf(0xd6)]['type'],_0x1dc4ad=getClientsWithBotID('botmanager'),_0x5707af=_0x544ad8[_0x3ef2bf(0x217)][_0x3ef2bf(0x111)],_0x201411=timelyDecrypt(_0x5707af,![]),_0x5c995e=_0x1dc4ad['find'](_0x436310=>_0x436310[_0x3ef2bf(0x111)]==_0x201411);if(_0x5c995e){const _0x342730=normalizeIP(_0x544ad8[_0x3ef2bf(0x292)][_0x3ef2bf(0x26d)])[_0x3ef2bf(0x1cb)],_0x23d4ef=_0x544ad8['headers'][_0x3ef2bf(0x22f)];if(validateAccess(_0x23d4ef,_0x201411,_0x342730)[_0x3ef2bf(0x1d8)])_0x310146==_0x3ef2bf(0x11a)&&await backupConfigFiles(),await zipFiles(_0x310146),_0x36616b[_0x3ef2bf(0x10e)](zippath+(_0x310146+_0x3ef2bf(0x231)),_0x416719=>{const _0x151492=_0x3ef2bf;_0x416719&&(logger[_0x151492(0x133)](_0x151492(0x1d3)+_0x310146),logger[_0x151492(0x1ee)](_0x416719));});else logger[_0x3ef2bf(0x133)](_0x3ef2bf(0x199)+_0x310146+_0x3ef2bf(0xc3));}else logger[_0x3ef2bf(0x133)](_0x3ef2bf(0x199)+_0x310146+'\x20(2)');}),app[_0x348e82(0x121)](_0x348e82(0xd2),async(_0x3562eb,_0xd9c689)=>{const _0x44b36b=_0x348e82,_0x2e4715=getClientsWithBotID(_0x44b36b(0x23f)),_0x44a2ac=_0x3562eb[_0x44b36b(0x217)][_0x44b36b(0x111)],_0x3fadd3=timelyDecrypt(_0x44a2ac,![]),_0x56f48e=_0x2e4715[_0x44b36b(0x289)](_0x1636a9=>_0x1636a9['uuid']==_0x3fadd3);logger['debug']('Backup\x20file\x20uploaded');if(_0x56f48e){const _0x8b744=normalizeIP(_0x3562eb[_0x44b36b(0x292)][_0x44b36b(0x26d)])[_0x44b36b(0x1cb)],_0x1a16b5=_0x3562eb[_0x44b36b(0x217)]['tkn'];if(validateAccess(_0x1a16b5,_0x3fadd3,_0x8b744)[_0x44b36b(0x1d8)]){if(_0x3562eb[_0x44b36b(0x18f)]){const _0x1b3860=_0x3562eb['files']['backupfile'];await _0x1b3860['mv'](temppath+_0x1b3860['name']),_0xd9c689[_0x44b36b(0x193)]({'status':!![],'message':_0x44b36b(0x135)});const _0x585a88=getBotsWithMode();_0x585a88['length']>0x0?confirmRestore(temppath,_0x1b3860[_0x44b36b(0x1fc)]):unzipFile(temppath,_0x1b3860[_0x44b36b(0x1fc)]);}}else logger[_0x44b36b(0x133)](_0x44b36b(0x1ff));}else logger[_0x44b36b(0x133)](_0x44b36b(0x155));}),app[_0x348e82(0x153)](express[_0x348e82(0x169)](path[_0x348e82(0x29f)](__dirname,bbpath2,_0x348e82(0x1bd)))),app['use'](express[_0x348e82(0x169)](path['join'](__dirname,bbpath2,'build'))),app[_0x348e82(0x1bc)]('/',function(_0x25fcef,_0x307892){const _0x24eb1b=_0x348e82;_0x307892[_0x24eb1b(0xed)](path['join'](__dirname,bbpath2,_0x24eb1b(0x1bd),_0x24eb1b(0x15b)));}),app[_0x348e82(0x1bc)](_0x348e82(0x104),function(_0x12bae4,_0x1537e8){const _0x5018d9=_0x348e82;_0x1537e8[_0x5018d9(0xed)](path['join'](__dirname,bbpath2,_0x5018d9(0x290),_0x5018d9(0x15b)));}),app[_0x348e82(0x1bc)](_0x348e82(0x16f),(_0x1cddd2,_0x3fbb9f)=>{const _0x50c194=_0x348e82;_0x3fbb9f[_0x50c194(0xed)](path[_0x50c194(0x29f)](__dirname,bbpath2,_0x50c194(0x290),'index.html'));}),app[_0x348e82(0x1bc)]('/:bot/performance',(_0x4df6fd,_0x234e07)=>{const _0xc745c1=_0x348e82;_0x234e07[_0xc745c1(0xed)](path['join'](__dirname,bbpath2,'build',_0xc745c1(0x15b)));}),app['get'](_0x348e82(0x248),(_0x130828,_0x3d0920)=>{const _0x1444b6=_0x348e82;_0x3d0920[_0x1444b6(0xed)](path[_0x1444b6(0x29f)](__dirname,bbpath2,'build',_0x1444b6(0x15b)));}),app[_0x348e82(0x1bc)]('/:bot/history',(_0x593b30,_0x241d03)=>{const _0x3b49eb=_0x348e82;_0x241d03[_0x3b49eb(0xed)](path[_0x3b49eb(0x29f)](__dirname,bbpath2,_0x3b49eb(0x290),_0x3b49eb(0x15b)));}),app[_0x348e82(0x1bc)](_0x348e82(0x183),(_0x442530,_0x5df456)=>{const _0x3a47b0=_0x348e82;_0x5df456[_0x3a47b0(0xed)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x348e82(0x1bc)](_0x348e82(0x27e),(_0x40f9cd,_0x58ed2e)=>{const _0x2c2829=_0x348e82;_0x58ed2e[_0x2c2829(0xed)](path[_0x2c2829(0x29f)](__dirname,bbpath2,_0x2c2829(0x290),_0x2c2829(0x15b)));});if(HOST)http[_0x348e82(0x1b2)](PORT,HOST);else http['listen'](PORT);const io=require(_0x348e82(0x194))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x48dc22=_0x348e82;let _0x826172=_0x48dc22(0x151);const _0x26ec44=networkInterfaces(),_0xb981a5={};for(const _0x4e3793 of Object[_0x48dc22(0xa6)](_0x26ec44)){for(const _0x36911a of _0x26ec44[_0x4e3793]){if((_0x36911a[_0x48dc22(0x215)]==_0x48dc22(0x1b8)||_0x36911a[_0x48dc22(0x215)]==0x4)&&!_0x36911a[_0x48dc22(0x184)]){const _0x350e7a=ipaddr[_0x48dc22(0x21d)](_0x36911a[_0x48dc22(0x19e)])['range']();_0x350e7a!=_0x48dc22(0xc4)&&(!_0xb981a5[_0x4e3793]&&(_0xb981a5[_0x4e3793]=[]),_0xb981a5[_0x4e3793][_0x48dc22(0x28d)](_0x36911a[_0x48dc22(0x19e)]),_0x826172=_0x36911a[_0x48dc22(0x19e)]);}}}return{'serverip':_0x826172,'netinterfaces':_0xb981a5};}async function startServer(){const _0x280e51=_0x348e82,{serverip:_0x3329a2,netinterfaces:_0x564b49}=getServerIP();logger[_0x280e51(0x1ee)](''),logger['simple'](_0x280e51(0x27f)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x280e51(0x1ef)+(environment==_0x280e51(0x262)?_0x280e51(0xf8):'')+'\x0a'+(_0x280e51(0xfc)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x280e51(0x1d4)+_0x3329a2+':'+PORT+_0x280e51(0x24f))),logger['simple'](_0x280e51(0x27f));if(config['length']!=0x0)for(const _0x1c6b72 of config){const _0x52603c=_0x1c6b72['mode']==_0x280e51(0x143)?'a':'m';if(_0x1c6b72['status']=='enabled'||_0x1c6b72[_0x280e51(0xe0)]==_0x280e51(0x12c))await logger[_0x280e51(0x133)](_0x280e51(0x21c)+_0x52603c+_0x280e51(0x11c)+_0x1c6b72['botID']+_0x280e51(0x12b)+_0x1c6b72[_0x280e51(0x160)]),startBot([_0x1c6b72[_0x280e51(0x27a)],userID],{'cwd':bbpath},function(_0x2ccd69){const _0x1c5ad0=_0x280e51;if(_0x2ccd69)logger[_0x1c5ad0(0x133)](_0x2ccd69);});else(_0x1c6b72['status']=='disabled'||_0x1c6b72[_0x280e51(0xe0)]=='new-disabled')&&await logger[_0x280e51(0x133)](_0x280e51(0x1a9)+_0x52603c+_0x280e51(0x16e)+_0x1c6b72[_0x280e51(0x27a)]+_0x280e51(0x12b)+_0x1c6b72[_0x280e51(0x160)]);}else!newBot&&logger[_0x280e51(0x1ee)](_0x280e51(0x14d));if(newBot)addBot();logger[_0x280e51(0x1ee)](_0x280e51(0x27f)),logger[_0x280e51(0x1ee)](''),await logger['debug'](_0x280e51(0x100)+nodeversion),await logger['debug'](_0x280e51(0x236),_0x564b49);}function startSocket(){io['on']('connection',_0x34be0d=>{const _0x5b988d=_0x2db2;let _0x5d5147,_0x5eb4b7,_0x3c4a0c,_0x324b66,_0x545c7d;const _0x5cc719=_0x34be0d[_0x5b988d(0x12a)][_0x5b988d(0x217)][_0x5b988d(0x2a0)];_0x5eb4b7=_0x5cc719[_0x5b988d(0xfa)](/bot[0-9]{3}/);if(_0x5eb4b7)_0x3c4a0c=_0x5eb4b7[0x0][_0x5b988d(0xfa)](/[0-9]{3}/);if(_0x3c4a0c)_0x5d5147=_0x3c4a0c[0x0];else _0x5d5147=_0x5b988d(0x23f);const _0xb076d=_0x34be0d[_0x5b988d(0x12a)][_0x5b988d(0xbe)][_0x5b988d(0x21e)];if(!_0xb076d)_0x34be0d[_0x5b988d(0xc8)](_0x5b988d(0xe0),{'publicKey':secure[_0x5b988d(0x140)]});else{_0x324b66=timelyDecrypt(_0xb076d,![]);if(!_0x324b66)_0x34be0d[_0x5b988d(0xc8)]('status',{'publicKey':secure[_0x5b988d(0x140)]});else{_0x545c7d=normalizeIP(_0x34be0d[_0x5b988d(0x1f7)][_0x5b988d(0x26d)])[_0x5b988d(0x1cb)];if(!devices[_0x324b66])devices[_0x324b66]={'uuid':_0x324b66,'access':{'token':null}};devices[_0x324b66]['ip']=_0x545c7d;const _0x2a1c0c=addClient(_0x34be0d['id'],_0x324b66,_0x5d5147);setAccess(_0x2a1c0c),emitMessages(),_0x34be0d['on'](_0x5b988d(0x20f),_0x1943a9=>{const _0x38ffb9=_0x5b988d,_0x28b1b5=timelyDecrypt(_0x1943a9[_0x38ffb9(0x1f0)]);if(_0x28b1b5){_0x1943a9={'username':_0x1943a9[_0x38ffb9(0x280)],'password':_0x28b1b5},devices[_0x324b66]['access']=validateCredentials(_0x1943a9,_0x324b66);if(devices[_0x324b66][_0x38ffb9(0x22b)]['allow']==![]&&devices[_0x324b66]['access']['reason']==_0x38ffb9(0xfd))_0x34be0d[_0x38ffb9(0xc8)](_0x38ffb9(0xe0),{'access':devices[_0x324b66]['access']}),loginAccess2FA(_0x324b66,_0x545c7d);else{if(devices[_0x324b66]['access'][_0x38ffb9(0x1d8)]==![]&&devices[_0x324b66][_0x38ffb9(0x22b)]['reason']=='invalid\x20credentials')_0x34be0d[_0x38ffb9(0xc8)](_0x38ffb9(0xe0),{'access':devices[_0x324b66][_0x38ffb9(0x22b)]});else devices[_0x324b66][_0x38ffb9(0x22b)][_0x38ffb9(0x1d8)]&&devices[_0x324b66][_0x38ffb9(0x22b)]['reason']==_0x38ffb9(0x127)&&(getClientsWithUuid(_0x324b66)[_0x38ffb9(0x294)](_0xfb8cc8=>{setAccess(_0xfb8cc8);}),logger['debug'](_0x38ffb9(0x1c6)+_0x324b66[_0x38ffb9(0x278)](-0x8)),setTokenRefresh(_0x324b66),setSessionTimeout(_0x38ffb9(0x20f),_0x324b66));}}else logger[_0x38ffb9(0x133)](_0x38ffb9(0x25b));}),_0x34be0d['on'](_0x5b988d(0x265),()=>{resetPassword();}),_0x34be0d['on'](_0x5b988d(0x1e9),_0x48daad=>{removeClient(_0x34be0d['id']);}),_0x5d5147==_0x5b988d(0x23f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4bbb79){const _0x4c10db=_0x348e82;if(_0x4bbb79!='botmanager'&&config['apiKey']!=''){if(pid[_0x4bbb79])pid[_0x4bbb79][_0x4c10db(0x193)]({'function':_0x4c10db(0xb0),'args':null});}_0x4bbb79!=_0x4c10db(0x23f)&&broadcastToBots(_0x4c10db(0x24e),JSON[_0x4c10db(0xa9)](config));}function reloadBotManager(){const _0x10578e=_0x348e82;getClientsWithBotID(_0x10578e(0x23f))[_0x10578e(0x294)](_0x4996db=>{const _0x28fe59=_0x10578e;getSocket(_0x4996db['id'])[_0x28fe59(0xc8)](_0x28fe59(0xe0),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x1b898b){const _0x41018b=_0x348e82;return io['sockets']['sockets'][_0x41018b(0x1bc)](_0x1b898b);}function setAccess(_0x28ddaa){const _0x359350=_0x348e82,_0x19f2e5=getSocket(_0x28ddaa['id']),_0x426407=_0x28ddaa['uuid'],_0x3abc04=_0x28ddaa[_0x359350(0x150)];devices[_0x426407][_0x359350(0x22b)]=validateAccess(devices[_0x426407]['access'][_0x359350(0x232)],_0x426407),logger[_0x359350(0x25d)](_0x359350(0x165)+devices[_0x426407][_0x359350(0x22b)][_0x359350(0x268)]+_0x359350(0x242)+_0x28ddaa['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x426407[_0x359350(0x278)](-0x8)),_0x19f2e5[_0x359350(0x29f)](_0x426407);if(devices[_0x426407][_0x359350(0x22b)][_0x359350(0x1d8)]){_0x19f2e5['join'](_0x3abc04);if(_0x3abc04==_0x359350(0x23f))initializeSocketBotManager(_0x19f2e5);else initializeSocketBot(_0x19f2e5);initClient(_0x3abc04);}devices[_0x426407][_0x359350(0x22b)][_0x359350(0x232)]&&devices[_0x426407][_0x359350(0x22b)]['reason']==_0x359350(0x21a)&&setSessionTimeout('2FA',_0x426407),devices[_0x426407][_0x359350(0x22b)][_0x359350(0x232)]&&devices[_0x426407][_0x359350(0x22b)][_0x359350(0x268)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x359350(0x20f),_0x426407),_0x19f2e5[_0x359350(0xc8)]('status',{'status':_0x28ddaa[_0x359350(0xd7)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x426407]['access'],'externalip':devices[_0x426407]['ip'],'publicKey':secure[_0x359350(0x140)],'userid':settings[_0x359350(0x11f)],'validInstallation':validInstallation}),devices[_0x426407]['access'][_0x359350(0x1d8)]==![]&&devices[_0x426407][_0x359350(0x22b)][_0x359350(0x268)]=='2FA\x20required'&&temporaryAccess2FA(_0x426407,devices[_0x426407]['ip']);}function setSessionTimeout(_0x1c8ef0,_0x44b6d3){const _0x2b1c74=_0x348e82;let _0x4041fe;if(_0x1c8ef0==_0x2b1c74(0x20f))_0x4041fe=loginExpiry*0x3c*0x3e8;else _0x4041fe=devices[_0x44b6d3][_0x2b1c74(0x1c3)][_0x2b1c74(0xae)]*0x3c*0x3e8-(new Date()[_0x2b1c74(0x273)]()-devices[_0x44b6d3][_0x2b1c74(0x1c3)][_0x2b1c74(0x176)]);if(devices[_0x44b6d3]['pidExpireLogin'])clearTimeout(devices[_0x44b6d3][_0x2b1c74(0x185)]);devices[_0x44b6d3][_0x2b1c74(0x185)]=setTimeout(()=>{const _0x63dd45=_0x2b1c74;if(devices[_0x44b6d3][_0x63dd45(0x28b)])clearTimeout(devices[_0x44b6d3][_0x63dd45(0x28b)]);removeSocketListeners(_0x44b6d3),addBlacklist(_0x44b6d3),devices[_0x44b6d3][_0x63dd45(0x1c3)]=null,devices[_0x44b6d3]['telegram2FaApproval']=null,devices[_0x44b6d3][_0x63dd45(0x22b)][_0x63dd45(0x232)]=null,logger[_0x63dd45(0x25d)](_0x63dd45(0x202)+_0x44b6d3['slice'](-0x8)),devices[_0x44b6d3]['access']=validateAccess(devices[_0x44b6d3][_0x63dd45(0x22b)][_0x63dd45(0x232)],_0x44b6d3),!(devices[_0x44b6d3][_0x63dd45(0x22b)][_0x63dd45(0x1d8)]&&devices[_0x44b6d3]['access'][_0x63dd45(0x268)]==_0x63dd45(0x23a))&&(_0x1c8ef0==_0x63dd45(0x20f)?io['to'](_0x44b6d3)[_0x63dd45(0xc8)](_0x63dd45(0xe0),{'access':{'allow':![],'reason':_0x63dd45(0x114),'token':null}}):io['to'](_0x44b6d3)[_0x63dd45(0xc8)]('status',{'access':{'allow':![],'reason':_0x63dd45(0x13f),'token':null}})),devices[_0x44b6d3][_0x63dd45(0x22b)][_0x63dd45(0x232)]=null;},_0x4041fe);}function setTokenRefresh(_0x4427c9){const _0x2f4997=_0x348e82;if(devices[_0x4427c9][_0x2f4997(0x28b)])clearTimeout(devices[_0x4427c9][_0x2f4997(0x28b)]);devices[_0x4427c9][_0x2f4997(0x28b)]=setTimeout(()=>{const _0x486dc0=_0x2f4997;getClientsWithUuid(_0x4427c9)['length']!=0x0?(devices[_0x4427c9][_0x486dc0(0x22b)]=refreshToken(_0x4427c9),io['to'](_0x4427c9)['emit'](_0x486dc0(0xe0),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4427c9]['access'],'externalip':devices[_0x4427c9]['ip'],'publicKey':secure[_0x486dc0(0x140)],'validInstallation':validInstallation}),setTokenRefresh(_0x4427c9)):clearTimeout(devices[_0x4427c9][_0x486dc0(0x28b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x195425){const _0x4a3901=_0x348e82,_0x2f4c1b=getClient(_0x195425['id'])['uuid'];_0x195425[_0x4a3901(0xc8)](_0x4a3901(0x24e),config),_0x195425[_0x4a3901(0xc8)](_0x4a3901(0xd3),cleanSettings()),_0x195425['on'](_0x4a3901(0xad),_0x1313b4=>{const _0x65cb9c=_0x4a3901;if(validateAccess(_0x1313b4,_0x2f4c1b)[_0x65cb9c(0x1d8)])addBot();else logger[_0x65cb9c(0x133)](_0x65cb9c(0xe7));}),_0x195425['on']('update-bot',(_0x112624,_0xb4fcaf)=>{const _0x3cf4a4=_0x4a3901;if(validateAccess(_0xb4fcaf,_0x2f4c1b)[_0x3cf4a4(0x1d8)])toggleBot(_0x112624[_0x3cf4a4(0x27a)],_0x112624['status'],_0x112624['live']);else logger[_0x3cf4a4(0x133)](_0x3cf4a4(0x256));}),_0x195425['on'](_0x4a3901(0x22e),(_0x5da9d9,_0x4fc0b2)=>{const _0x3bedde=_0x4a3901;if(validateAccess(_0x4fc0b2,_0x2f4c1b)['allow'])toggleBotMode(_0x5da9d9);else logger[_0x3bedde(0x133)](_0x3bedde(0x256));}),_0x195425['on'](_0x4a3901(0x284),(_0x1a232f,_0x2b9083)=>{const _0x2bb25b=_0x4a3901;if(validateAccess(_0x2b9083,_0x2f4c1b)['allow'])deleteBot(_0x1a232f);else logger[_0x2bb25b(0x133)](_0x2bb25b(0x1a6));}),_0x195425['on'](_0x4a3901(0x11d),(_0x1e4770,_0x1543f5)=>{const _0x2361db=_0x4a3901;if(validateAccess(_0x1543f5,_0x2f4c1b)[_0x2361db(0x1d8)])storeSettings(_0x1e4770,!![]);else logger[_0x2361db(0x133)](_0x2361db(0x229));}),_0x195425['on'](_0x4a3901(0x14a),_0x5f4d94=>{const _0x2feafe=_0x4a3901;if(validateAccess(_0x5f4d94,_0x2f4c1b)['allow'])updateBB(_0x2feafe(0xb4));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x195425['on']('reinstall-bb',_0x417f2f=>{const _0x54f01f=_0x4a3901;if(validateAccess(_0x417f2f,_0x2f4c1b)[_0x54f01f(0x1d8)])updateBB(_0x54f01f(0x15f));else logger['full'](_0x54f01f(0x27b));}),_0x195425['on'](_0x4a3901(0x235),_0x5c874a=>{const _0x17f389=_0x4a3901;if(validateAccess(_0x5c874a,_0x2f4c1b)['allow']){const _0x5ef59c=getClient(_0x195425['id']);if(_0x5ef59c)getBackupFiles(_0x5ef59c[_0x17f389(0x111)]);else logger[_0x17f389(0x133)](_0x17f389(0x1a5));}else logger['full'](_0x17f389(0xde));}),_0x195425['on'](_0x4a3901(0x167),(_0x5502fd,_0x4419b9)=>{const _0x1a5c38=_0x4a3901;if(validateAccess(_0x4419b9,_0x2f4c1b)[_0x1a5c38(0x1d8)])restoreBackupFile(_0x5502fd);else logger[_0x1a5c38(0x133)](_0x1a5c38(0x1ed));}),_0x195425['on'](_0x4a3901(0x23b),_0x2ace3f=>{const _0x4e195c=_0x4a3901;if(validateAccess(_0x2ace3f,_0x2f4c1b)[_0x4e195c(0x1d8)])getMessages();else logger[_0x4e195c(0x133)](_0x4e195c(0x18b));}),_0x195425['on'](_0x4a3901(0x245),(_0x559302,_0x567c48)=>{const _0x4cec13=_0x4a3901;if(validateAccess(_0x567c48,_0x2f4c1b)[_0x4cec13(0x1d8)])confirmMessage(_0x559302);else logger[_0x4cec13(0x133)](_0x4cec13(0x1a3));}),_0x195425['on']('logout',_0x320c1a=>{const _0x183784=_0x4a3901;if(validateAccess(_0x320c1a,_0x2f4c1b)['allow']){if(devices[_0x2f4c1b]['pidRefreshToken'])clearTimeout(devices[_0x2f4c1b][_0x183784(0x28b)]);if(devices[_0x2f4c1b]['pidExpireLogin'])clearTimeout(devices[_0x2f4c1b][_0x183784(0x185)]);removeSocketListeners(getClient(_0x195425['id'])['uuid']),addBlacklist(_0x2f4c1b),devices[_0x2f4c1b][_0x183784(0x1c3)]=null,devices[_0x2f4c1b]['telegram2FaApproval']=null,devices[_0x2f4c1b][_0x183784(0x22b)][_0x183784(0x232)]=null,logger['debug'](_0x183784(0x1fd)+_0x2f4c1b[_0x183784(0x278)](-0x8)),io['to'](getClient(_0x195425['id'])['uuid'])[_0x183784(0xc8)](_0x183784(0xe0),{'access':{'allow':![],'reason':_0x183784(0x19c),'token':null}});}else logger[_0x183784(0x133)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x21c559){const _0x1af441=_0x348e82,_0x3d159a=getClient(_0x21c559['id'])[_0x1af441(0x150)],_0x5e00b0=getClient(_0x21c559['id'])[_0x1af441(0x111)];_0x21c559['on']('get-logs',(_0x110d9c,_0x352794)=>{const _0x1e21cb=_0x1af441;if(validateAccess(_0x352794,_0x5e00b0)['allow']){if(pid[_0x3d159a])pid[_0x3d159a]['send']({'function':_0x1e21cb(0x17a),'args':_0x110d9c});}else logger[_0x1e21cb(0x133)](_0x1e21cb(0x1b9));}),_0x21c559['on']('delete-alerts',(_0x51de3b,_0x4df4cc)=>{const _0x3ca3a7=_0x1af441;if(validateAccess(_0x4df4cc,_0x5e00b0)[_0x3ca3a7(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a][_0x3ca3a7(0x193)]({'function':_0x3ca3a7(0x233),'args':_0x51de3b});}else logger[_0x3ca3a7(0x133)](_0x3ca3a7(0x221));}),_0x21c559['on']('get-portfolio',(_0x42870b,_0x441126)=>{const _0x57d241=_0x1af441;if(validateAccess(_0x441126,_0x5e00b0)[_0x57d241(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a][_0x57d241(0x193)]({'function':_0x57d241(0x13b),'args':_0x42870b});}else logger[_0x57d241(0x133)](_0x57d241(0x241));}),_0x21c559['on'](_0x1af441(0x246),(_0x3f1bb5,_0x471c90)=>{const _0x1da8fb=_0x1af441;if(validateAccess(_0x471c90,_0x5e00b0)['allow']){if(pid[_0x3d159a])pid[_0x3d159a]['send']({'function':_0x1da8fb(0xf4),'args':_0x3f1bb5});}else logger['full'](_0x1da8fb(0x255));}),_0x21c559['on']('store-headless',(_0x530603,_0x1a0872)=>{const _0x4b2b9f=_0x1af441;if(validateAccess(_0x1a0872,_0x5e00b0)[_0x4b2b9f(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a][_0x4b2b9f(0x193)]({'function':_0x4b2b9f(0x1ac),'args':_0x530603});}else logger[_0x4b2b9f(0x133)](_0x4b2b9f(0x15e));}),_0x21c559['on'](_0x1af441(0x26e),(_0x2690d4,_0x20d53c)=>{const _0xa99dce=_0x1af441;if(validateAccess(_0x20d53c,_0x5e00b0)[_0xa99dce(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a][_0xa99dce(0x193)]({'function':'storeFiat','args':_0x2690d4});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x21c559['on'](_0x1af441(0x216),_0x43a361=>{const _0x50d0f6=_0x1af441;if(validateAccess(_0x43a361,_0x5e00b0)[_0x50d0f6(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a]['send']({'function':_0x50d0f6(0x116),'args':null});}else logger['full'](_0x50d0f6(0x197));}),_0x21c559['on'](_0x1af441(0xec),_0x424bc3=>{const _0x4a56f7=_0x1af441;if(validateAccess(_0x424bc3,_0x5e00b0)[_0x4a56f7(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a][_0x4a56f7(0x193)]({'function':_0x4a56f7(0x113),'args':null});}else logger[_0x4a56f7(0x133)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x21c559['on'](_0x1af441(0xc9),(_0x4074e0,_0x55132e)=>{const _0x1e4f3b=_0x1af441;if(validateAccess(_0x55132e,_0x5e00b0)['allow']){if(pid[_0x3d159a])pid[_0x3d159a][_0x1e4f3b(0x193)]({'function':_0x1e4f3b(0x20c),'args':_0x4074e0});}else logger['full'](_0x1e4f3b(0x239));}),_0x21c559['on']('cancel-loading',_0x13e84e=>{const _0x33f1c6=_0x1af441;if(validateAccess(_0x13e84e,_0x5e00b0)[_0x33f1c6(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a]['send']({'function':_0x33f1c6(0x16a),'args':null});}else logger[_0x33f1c6(0x133)](_0x33f1c6(0x201));}),_0x21c559['on'](_0x1af441(0x1e2),_0x2448d3=>{const _0x11a5dd=_0x1af441;if(validateAccess(_0x2448d3,_0x5e00b0)[_0x11a5dd(0x1d8)]){if(pid[_0x3d159a])pid[_0x3d159a][_0x11a5dd(0x193)]({'function':_0x11a5dd(0xab),'args':null});}else logger[_0x11a5dd(0x133)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x21c559['on'](_0x1af441(0x14a),_0x11e2c0=>{const _0x14b0ee=_0x1af441;if(validateAccess(_0x11e2c0,_0x5e00b0)[_0x14b0ee(0x1d8)])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x21c559['on'](_0x1af441(0x23b),_0x1cd6e5=>{const _0x5e04db=_0x1af441;if(validateAccess(_0x1cd6e5,_0x5e00b0)[_0x5e04db(0x1d8)])getMessages();else logger[_0x5e04db(0x133)](_0x5e04db(0x18b));}),_0x21c559['on'](_0x1af441(0x245),(_0x388e37,_0x54533e)=>{const _0x45e50d=_0x1af441;if(validateAccess(_0x54533e,_0x5e00b0)[_0x45e50d(0x1d8)])confirmMessage(_0x388e37);else logger['full'](_0x45e50d(0x1a3));}),_0x21c559['on']('logout',_0xa21dc0=>{const _0x7f309e=_0x1af441;if(validateAccess(_0xa21dc0,_0x5e00b0)['allow']){if(devices[_0x5e00b0]['pidRefreshToken'])clearTimeout(devices[_0x5e00b0][_0x7f309e(0x28b)]);if(devices[_0x5e00b0][_0x7f309e(0x185)])clearTimeout(devices[_0x5e00b0][_0x7f309e(0x185)]);removeSocketListeners(getClient(_0x21c559['id'])[_0x7f309e(0x111)]),addBlacklist(_0x5e00b0),devices[_0x5e00b0][_0x7f309e(0x1c3)]=null,devices[_0x5e00b0]['telegram2FaApproval']=null,devices[_0x5e00b0][_0x7f309e(0x22b)][_0x7f309e(0x232)]=null,logger[_0x7f309e(0x25d)]('Logged\x20out\x20user\x20...'+_0x5e00b0[_0x7f309e(0x278)](-0x8)),io['to'](getClient(_0x21c559['id'])[_0x7f309e(0x111)])[_0x7f309e(0xc8)](_0x7f309e(0xe0),{'access':{'allow':![],'reason':_0x7f309e(0x19c),'token':null}});}else logger[_0x7f309e(0x133)](_0x7f309e(0x1d5));});}function removeSocketListeners(_0x10cfcf){const _0x4a0786=_0x348e82;getClientsWithUuid(_0x10cfcf)[_0x4a0786(0x294)](_0x1b1ab2=>{const _0x2171b4=_0x4a0786;getSocket(_0x1b1ab2['id'])[_0x2171b4(0xb3)]();});}function cleanSettings(){const _0x335052=_0x348e82;let _0x5c41cf=settings;return settings[_0x335052(0x10f)]&&settings[_0x335052(0x10f)]!=''&&(_0x5c41cf={..._0x5c41cf,'telegramToken':'************'}),settings[_0x335052(0x164)]&&settings['bbPassword']!=''&&(_0x5c41cf={..._0x5c41cf,'bbPassword':_0x335052(0x298)}),(settings[_0x335052(0x164)]&&settings[_0x335052(0x164)]=='***'||settings[_0x335052(0x10f)]&&settings['telegramToken']==_0x335052(0x138))&&(_0x5c41cf={..._0x5c41cf,'restored':{'password':settings[_0x335052(0x164)]==_0x335052(0x138),'telegram':settings[_0x335052(0x10f)]==_0x335052(0x138)}}),_0x5c41cf;}async function updateBB(_0x33f5b9){const _0x29814c=_0x348e82;await backupConfigFiles(),installingUpdate=!![],config[_0x29814c(0x294)](_0x94544d=>{const _0x1a06b0=_0x29814c;restartBot(_0x94544d[_0x1a06b0(0x27a)]);});if(_0x33f5b9==_0x29814c(0xb4))process['send']({'update':!![],'environment':environment},_0x47a606=>{});else _0x33f5b9==_0x29814c(0x15f)&&process[_0x29814c(0x193)]({'reinstall':!![],'environment':environment},_0x54a9da=>{});}function startBot(_0x2dcf04,_0x3a2563,_0x474d46){const _0x428c79=_0x348e82;if(debugging)_0x2dcf04['push']('-d');let _0x26e460=![];const _0x8f7871=_0x2dcf04[0x0];_0x3a2563={..._0x3a2563,'stdio':['inherit',_0x428c79(0x207),'inherit',_0x428c79(0x14f)]},pid[_0x8f7871]=childProcess[_0x428c79(0x1c8)](botfile,_0x2dcf04,_0x3a2563),pid[_0x8f7871]['on'](_0x428c79(0xf5),_0x89c90e=>{const _0x19f256=_0x428c79;switch(Object[_0x19f256(0xa6)](_0x89c90e)[0x0]){case'botname':updateBotName(_0x8f7871,_0x89c90e[_0x19f256(0x160)]);break;case'updatebotmanager':updateBotManager();break;case _0x19f256(0xe0):updateStatus(_0x8f7871,_0x89c90e[_0x19f256(0xe0)]);break;case _0x19f256(0x219):updateLive(_0x8f7871,_0x89c90e[_0x19f256(0x219)]);break;case'started':updateLive(_0x8f7871,_0x89c90e['started']),io['to'](_0x8f7871)[_0x19f256(0xc8)](_0x19f256(0xe0),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x19f256(0x1be):_0x89c90e[_0x19f256(0x1be)]==_0x19f256(0x10b)&&restartBot(_0x8f7871);_0x89c90e['stop']==_0x19f256(0x1aa)&&toggleBot(_0x8f7871,_0x19f256(0x291),_0x19f256(0x170));break;case _0x19f256(0xbb):sendTelegramBot(_0x8f7871,_0x89c90e['telegram']);break;case _0x19f256(0x107):sendTelegramMsg(_0x89c90e[_0x19f256(0x107)]);break;case _0x19f256(0xbc):io['to'](_0x8f7871)[_0x19f256(0xc8)](_0x89c90e[_0x19f256(0xbc)],_0x89c90e['args']);break;}}),pid[_0x8f7871]['on'](_0x428c79(0x271),function(_0x224613){if(_0x26e460)return;_0x26e460=!![],_0x474d46(_0x224613);}),pid[_0x8f7871]['on'](_0x428c79(0x124),async function(_0x2d80f7){const _0xce7336=_0x428c79;if(terminating)return;if(installingUpdate){logger[_0xce7336(0x25d)](_0xce7336(0x277)),io[_0xce7336(0x14c)]();return;}if(_0x26e460)return;_0x26e460=!![],_0x474d46(null);const _0x388970=dbConfig[_0xce7336(0x1bc)](_0xce7336(0x24e))[_0xce7336(0x289)]({'botID':_0x8f7871})[_0xce7336(0x22c)]();_0x388970&&(_0x388970[_0xce7336(0xe0)]==_0xce7336(0xe1)||_0x388970[_0xce7336(0xe0)]==_0xce7336(0x12c))&&(await sleep(0x3e8),updateLive(_0x8f7871,_0xce7336(0x170)),logger[_0xce7336(0x133)](_0xce7336(0x145)+_0x8f7871),startBot([_0x8f7871,userID],{'cwd':bbpath},function(_0x3ca5fc){const _0x127f25=_0xce7336;if(_0x3ca5fc)logger[_0x127f25(0x133)](_0x3ca5fc);}));});}function stopBot(_0x57e13f){const _0x14898b=_0x348e82;getClientsWithBotID(_0x57e13f)[_0x14898b(0x294)](_0xab41cd=>{const _0x7029f2=_0x14898b;getSocket(_0xab41cd['id'])[_0x7029f2(0x1e9)](!![]),removeClient(_0xab41cd['id']);}),pid[_0x57e13f]&&(pid[_0x57e13f][_0x14898b(0x1aa)](),pid[_0x57e13f]=null);}function stopAllBots(){const _0x4f91c0=_0x348e82;terminating=!![];const _0x1a11b1=getEnabledBots();_0x1a11b1[_0x4f91c0(0x294)](_0x34e275=>{const _0x30948d=_0x4f91c0;stopBot(_0x34e275[_0x30948d(0x27a)]);});}function restartBot(_0x22a07e){const _0x558684=_0x348e82;if(pid[_0x22a07e])pid[_0x22a07e][_0x558684(0x1aa)]();}function addBot(){const _0x2f7723=_0x348e82;let _0x22020b;for(let _0x5218c7=0x1;_0x5218c7<0x3e9;_0x5218c7++){_0x22020b=_0x5218c7[_0x2f7723(0x1ec)]()[_0x2f7723(0x1fa)](0x3,'0');let _0x5cb54e=config[_0x2f7723(0x289)](_0x493388=>_0x493388[_0x2f7723(0x27a)]==_0x22020b);if(!_0x5cb54e)break;}if(_0x22020b===_0x2f7723(0x126)){logger[_0x2f7723(0x133)](_0x2f7723(0xa5));return;}logger[_0x2f7723(0x133)](_0x2f7723(0x1e1)+_0x22020b),dbConfig[_0x2f7723(0x1bc)](_0x2f7723(0x24e))[_0x2f7723(0x28d)]({'botID':_0x22020b,'botname':_0x2f7723(0x17b)+_0x22020b,'status':_0x2f7723(0x12c),'live':''})[_0x2f7723(0x15a)](),startBot([_0x22020b,userID],{'cwd':bbpath},function(_0x42d144){const _0x3d9da2=_0x2f7723;if(_0x42d144)logger[_0x3d9da2(0x133)](_0x42d144);}),config=getConfiguration(),io['to'](_0x2f7723(0x23f))[_0x2f7723(0xc8)]('bots',config),broadcastToBots(_0x2f7723(0x24e),JSON[_0x2f7723(0xa9)](config));}function deleteBot(_0x314b3e){const _0x528c65=_0x348e82;getClientsWithBotID(_0x314b3e)[_0x528c65(0x294)](_0x43c4ee=>{getSocket(_0x43c4ee['id'])['disconnect'](!![]),removeClient(_0x43c4ee['id']);}),dbConfig[_0x528c65(0x1bc)](_0x528c65(0x24e))[_0x528c65(0x1db)]({'botID':_0x314b3e})[_0x528c65(0x15a)](),logger['full'](_0x528c65(0x240)+_0x314b3e),stopBot(_0x314b3e);try{if(fs[_0x528c65(0x253)](path[_0x528c65(0x29f)](configpath,_0x528c65(0xf1)+_0x314b3e+_0x528c65(0x109))))fs[_0x528c65(0x220)](path['join'](configpath,_0x528c65(0xf1)+_0x314b3e+_0x528c65(0x109)));if(fs[_0x528c65(0x253)](path[_0x528c65(0x29f)](configpath,'bot-'+_0x314b3e+'-events.json')))fs['unlinkSync'](path[_0x528c65(0x29f)](configpath,_0x528c65(0xf1)+_0x314b3e+'-events.json'));if(fs[_0x528c65(0x253)](path[_0x528c65(0x29f)](configpath,_0x528c65(0xf1)+_0x314b3e+_0x528c65(0x186))))fs['unlinkSync'](path['join'](configpath,_0x528c65(0xf1)+_0x314b3e+_0x528c65(0x186)));if(fs[_0x528c65(0x253)](path[_0x528c65(0x29f)](configpath,_0x528c65(0xf1)+_0x314b3e+_0x528c65(0x279))))fs[_0x528c65(0x220)](path[_0x528c65(0x29f)](configpath,'bot-'+_0x314b3e+_0x528c65(0x279)));}catch(_0x45f1aa){if(_0x45f1aa)logger[_0x528c65(0x133)](_0x528c65(0xdd),_0x45f1aa);}config=getConfiguration(),io['to'](_0x528c65(0x23f))['emit'](_0x528c65(0x24e),config),broadcastToBots('bots',JSON[_0x528c65(0xa9)](config));}function toggleBot(_0x64fab3,_0x3fdfdc,_0x149cf2){const _0x22c5d2=_0x348e82;dbConfig['get'](_0x22c5d2(0x24e))[_0x22c5d2(0x289)]({'botID':_0x64fab3})[_0x22c5d2(0x29b)]({'status':_0x3fdfdc})[_0x22c5d2(0x29b)]({'live':_0x149cf2})[_0x22c5d2(0x15a)]();if(_0x3fdfdc==_0x22c5d2(0xe1)||_0x3fdfdc==_0x22c5d2(0x12c))logger['full'](_0x22c5d2(0x26b)+_0x64fab3),startBot([_0x64fab3,userID],{'cwd':bbpath},function(_0x247569){const _0x26ee94=_0x22c5d2;if(_0x247569)logger[_0x26ee94(0x133)](_0x247569);});else(_0x3fdfdc=='disabled'||_0x3fdfdc==_0x22c5d2(0x131))&&(logger[_0x22c5d2(0x133)](_0x22c5d2(0x206)+_0x64fab3),stopBot(_0x64fab3));config=getConfiguration(),io['to']('botmanager')[_0x22c5d2(0xc8)](_0x22c5d2(0x24e),config),broadcastToBots(_0x22c5d2(0x24e),JSON[_0x22c5d2(0xa9)](config));}function toggleStatus(_0x1a3121){const _0x1c307f=_0x348e82;let _0x46ca05=dbConfig[_0x1c307f(0x1bc)]('bots')[_0x1c307f(0x289)]({'botID':_0x1a3121})[_0x1c307f(0x22c)](),_0x455353;if(_0x46ca05[_0x1c307f(0xe0)]===_0x1c307f(0xe1))_0x455353=_0x1c307f(0x291);else{if(_0x46ca05[_0x1c307f(0xe0)]==='new')_0x455353='new-disabled';else{if(_0x46ca05[_0x1c307f(0xe0)]===_0x1c307f(0x131))_0x455353=_0x1c307f(0x12c);else{if(_0x46ca05[_0x1c307f(0xe0)]===_0x1c307f(0x291))_0x455353=_0x1c307f(0xe1);}}}return _0x455353;}function updateStatus(_0xe0416c,_0x3f533e){const _0x53d5cb=_0x348e82;dbConfig['get'](_0x53d5cb(0x24e))[_0x53d5cb(0x289)]({'botID':_0xe0416c})[_0x53d5cb(0x29b)]({'status':_0x3f533e})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x53d5cb(0xc8)]('bots',config),broadcastToBots('bots',JSON[_0x53d5cb(0xa9)](config));}function updateLive(_0x3af0e1,_0x483e8a){const _0xb7fea3=_0x348e82;dbConfig[_0xb7fea3(0x1bc)](_0xb7fea3(0x24e))[_0xb7fea3(0x289)]({'botID':_0x3af0e1})[_0xb7fea3(0x29b)]({'live':_0x483e8a})[_0xb7fea3(0x15a)](),config=getConfiguration(),io['to']('botmanager')[_0xb7fea3(0xc8)](_0xb7fea3(0x24e),config),broadcastToBots(_0xb7fea3(0x24e),JSON[_0xb7fea3(0xa9)](config));}function updateBotName(_0x413485,_0x1386d9){const _0x12949d=_0x348e82;dbConfig['get'](_0x12949d(0x24e))['find']({'botID':_0x413485})['assign']({'botname':_0x1386d9})[_0x12949d(0x15a)](),config=getConfiguration(),io['to'](_0x12949d(0x23f))[_0x12949d(0xc8)](_0x12949d(0x24e),config),broadcastToBots(_0x12949d(0x24e),JSON[_0x12949d(0xa9)](config));}function updateBotManager(){const _0x4f82e6=_0x348e82;config=getConfiguration(),io['to'](_0x4f82e6(0x23f))[_0x4f82e6(0xc8)](_0x4f82e6(0x24e),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x151fc3){const _0x55d931=_0x348e82;if(pid[_0x151fc3])pid[_0x151fc3][_0x55d931(0x193)]({'function':'toggleBotMode','args':null});else{const _0x206081=configpath+_0x55d931(0xf1)+_0x151fc3+_0x55d931(0x109),_0x3d9631=fs[_0x55d931(0x188)](_0x206081),_0x203f5b=JSON[_0x55d931(0x21d)](_0x3d9631),_0x1787ce=_0x203f5b[_0x55d931(0x150)][0x0]['headless'];_0x203f5b['bot'][0x0][_0x55d931(0x1c0)]=!_0x1787ce;const _0x325596=JSON[_0x55d931(0xa9)](_0x203f5b,null,0x2);fs['writeFileSync'](_0x206081,_0x325596),config=getConfiguration(),io['to'](_0x55d931(0x23f))['emit'](_0x55d931(0x24e),config),broadcastToBots(_0x55d931(0x24e),JSON['stringify'](config));}}function validateTelegram(_0x3e193d){const _0x731329=_0x348e82;if(_0x3e193d['from'][_0x731329(0x280)]!=settings[_0x731329(0x25e)]&&'@'+_0x3e193d[_0x731329(0x27c)][_0x731329(0x280)]!=settings[_0x731329(0x25e)]||_0x3e193d[_0x731329(0x1b0)]['id']!=settings[_0x731329(0x115)])return sendTelegram(_0x3e193d[_0x731329(0x1b0)]['id'],_0x731329(0x1ce),{'parse_mode':_0x731329(0xe9)}),![];return!![];}async function initTelegram(){const _0x4380e3=_0x348e82;if(tgBot)tgBot[_0x4380e3(0x1be)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x4380e3(0x10f)]);let _0x3430e6=_0x4380e3(0x20d);_0x3430e6+='\x0a',_0x3430e6+=_0x4380e3(0xf9),_0x3430e6+=_0x4380e3(0xf2),_0x3430e6+=_0x4380e3(0x267),_0x3430e6+=_0x4380e3(0x243),_0x3430e6+='/on\x20-\x20start\x20bot(s)\x0a',_0x3430e6+=_0x4380e3(0x287),_0x3430e6+=_0x4380e3(0x106),_0x3430e6+=_0x4380e3(0x27d),_0x3430e6+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x3430e6+=_0x4380e3(0x1d1),_0x3430e6+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3430e6+=_0x4380e3(0x24c),_0x3430e6+=_0x4380e3(0x24d),_0x3430e6+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2e15e7=_0x4380e3(0xc7);_0x2e15e7+='\x0a',_0x2e15e7+=_0x3430e6,tgBot['catch']((_0x5276e1,_0x1aa654)=>{const _0x2d048e=_0x4380e3;logger[_0x2d048e(0x1ee)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x2d048e(0x25d)]('Telegraf\x20error:',_0x5276e1);}),tgBot[_0x4380e3(0x153)](async(_0x290109,_0x1bc0ed)=>{const _0x2f9a09=_0x4380e3;if(!(!settings[_0x2f9a09(0x115)]&&_0x290109[_0x2f9a09(0xb4)]['message'][_0x2f9a09(0x269)]==_0x2f9a09(0x112))){if(!validateTelegram(_0x290109))return;}_0x1bc0ed();}),tgBot['command'](_0x4380e3(0x128),async _0x3cb6aa=>{const _0xe3300c=_0x4380e3;if(!settings[_0xe3300c(0x115)])updateSetting('telegramChatId',_0x3cb6aa['chat']['id']);updateSetting(_0xe3300c(0x28e),!![]);if(!validateTelegram(_0x3cb6aa))return;await sendTelegram(_0x3cb6aa[_0xe3300c(0x1b0)]['id'],_0x2e15e7);}),tgBot[_0x4380e3(0x149)](_0x4380e3(0x139),async _0x1ed7a8=>{const _0x4bb378=_0x4380e3;updateSetting(_0x4bb378(0x28e),!![]),await sendTelegram(_0x1ed7a8[_0x4bb378(0x1b0)]['id'],_0x4bb378(0x132));}),tgBot[_0x4380e3(0x149)](_0x4380e3(0x230),async _0x25716a=>{await sendTelegram(_0x25716a['chat']['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot[_0x4380e3(0x149)](_0x4380e3(0xd9),async _0x65d97c=>{const _0x276a9c=_0x4380e3,_0x269975=Markup[_0x276a9c(0x12e)]([Markup[_0x276a9c(0x297)][_0x276a9c(0x288)](_0x276a9c(0x226),'config_orders'),Markup['button']['callback'](_0x276a9c(0xea),_0x276a9c(0x25f)),Markup['button'][_0x276a9c(0x288)](_0x276a9c(0x119),_0x276a9c(0x299))]);_0x65d97c['reply'](_0x276a9c(0x1f6),_0x269975);}),tgBot['action'](_0x4380e3(0x157),async _0x2e8a72=>{const _0x299cc0=_0x4380e3;_0x2e8a72[_0x299cc0(0x105)](),updateSetting(_0x299cc0(0xc2),_0x299cc0(0x1f8)),updateSetting(_0x299cc0(0x28e),!![]),await sendTelegram(_0x2e8a72[_0x299cc0(0x1b0)]['id'],_0x299cc0(0x1a0));}),tgBot[_0x4380e3(0x13a)](_0x4380e3(0x25f),async _0x344b32=>{const _0x23fa91=_0x4380e3;_0x344b32[_0x23fa91(0x105)](),updateSetting(_0x23fa91(0xc2),_0x23fa91(0x129)),updateSetting(_0x23fa91(0x28e),!![]),await sendTelegram(_0x344b32[_0x23fa91(0x1b0)]['id'],_0x23fa91(0x270));}),tgBot['action']('config_all',async _0x1253bb=>{const _0x3b9eac=_0x4380e3;_0x1253bb[_0x3b9eac(0x105)](),updateSetting(_0x3b9eac(0xc2),_0x3b9eac(0x244)),updateSetting(_0x3b9eac(0x28e),!![]),await sendTelegram(_0x1253bb['chat']['id'],_0x3b9eac(0x1c1));}),tgBot[_0x4380e3(0x149)]('status',async _0x1dd397=>{const _0x5d72f4=_0x4380e3,_0x50801f=getBotsWithMode();let _0x34afc3=_0x5d72f4(0x1c5);config['forEach'](_0x52f645=>{const _0x17f326=_0x5d72f4,_0x36839c=_0x50801f['find'](_0x48d174=>_0x48d174[_0x17f326(0x27a)]==_0x52f645[_0x17f326(0x27a)])['mode'];_0x34afc3+=_0x17f326(0x17b)+_0x52f645[_0x17f326(0x27a)]+':\x20'+_0x52f645['status']+_0x17f326(0x12b)+_0x36839c+'\x20|\x20'+_0x52f645[_0x17f326(0x219)]+'\x0a';}),_0x34afc3+='\x0a',_0x34afc3+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x34afc3+=!settings[_0x5d72f4(0x28e)]?_0x5d72f4(0x254):_0x5d72f4(0x222),_0x34afc3+=settings[_0x5d72f4(0x28e)]?settings[_0x5d72f4(0xc2)]==_0x5d72f4(0x244)?_0x5d72f4(0x14b):_0x5d72f4(0x1e3)+settings['telegramEvents']+'\x20only\x0a':'',await sendTelegram(_0x1dd397[_0x5d72f4(0x1b0)]['id'],_0x34afc3,{'parse_mode':_0x5d72f4(0xe9)});}),tgBot[_0x4380e3(0x149)]('restart',async _0x3afa1e=>{const _0x32ae21=_0x4380e3,_0x5a4776=getEnabledBots();if(_0x5a4776['length']==0x0)await sendTelegram(_0x3afa1e[_0x32ae21(0x1b0)]['id'],_0x32ae21(0x1ae));else{if(_0x5a4776['length']>0x1)_0x5a4776[_0x32ae21(0x28d)]({'botID':_0x32ae21(0x244)});let _0x47c231=[],_0x1d44ea=[];const _0x146c0e=_0x5a4776[_0x32ae21(0x192)]%0x4==0x0||_0x5a4776[_0x32ae21(0x192)]%0x4==0x3||_0x5a4776[_0x32ae21(0x192)]%0x3==0x1?0x4:0x3;let _0x118a60=0x0;_0x5a4776[_0x32ae21(0x294)]((_0x406104,_0x39d787)=>{const _0x51a2b5=_0x32ae21;if(_0x39d787%_0x146c0e==0x0)_0x1d44ea=[];_0x1d44ea[_0x51a2b5(0x28d)](Markup['button'][_0x51a2b5(0x288)](_0x406104['botID']==_0x51a2b5(0x244)?_0x51a2b5(0x250):_0x51a2b5(0x17b)+_0x406104[_0x51a2b5(0x27a)],_0x51a2b5(0x171)+_0x406104[_0x51a2b5(0x27a)])),_0x39d787%_0x146c0e==0x0&&(_0x47c231[_0x118a60]=_0x1d44ea,_0x118a60++);});const _0x1523bd=Markup['inlineKeyboard'](_0x47c231);_0x3afa1e[_0x32ae21(0xe6)](_0x32ae21(0x16c),_0x1523bd);}}),tgBot[_0x4380e3(0x13a)](/restart_(.+)/,async _0x257026=>{const _0x43a100=_0x4380e3,_0x5bfe64=_0x257026[_0x43a100(0xfa)][0x1];_0x257026[_0x43a100(0x105)](),_0x5bfe64=='all'?config[_0x43a100(0x294)](_0x3993eb=>{const _0x4bced9=_0x43a100;restartBot(_0x3993eb[_0x4bced9(0x27a)]);}):restartBot(_0x5bfe64);}),tgBot['command']('on',async _0x1a0959=>{const _0xeca315=_0x4380e3,_0x5db727=getDisabledBots();if(_0x5db727['length']==0x0)await sendTelegram(_0x1a0959['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x5db727[_0xeca315(0x192)]>0x1)_0x5db727[_0xeca315(0x28d)]({'botID':_0xeca315(0x244)});let _0x58646a=[],_0x511cfd=[];const _0x1f155e=_0x5db727[_0xeca315(0x192)]%0x4==0x0||_0x5db727[_0xeca315(0x192)]%0x4==0x3||_0x5db727[_0xeca315(0x192)]%0x3==0x1?0x4:0x3;let _0x37763d=0x0;_0x5db727[_0xeca315(0x294)]((_0x32d476,_0x448101)=>{const _0x14e357=_0xeca315;if(_0x448101%_0x1f155e==0x0)_0x511cfd=[];_0x511cfd[_0x14e357(0x28d)](Markup['button'][_0x14e357(0x288)](_0x32d476[_0x14e357(0x27a)]==_0x14e357(0x244)?'All\x20bots':'Bot\x20'+_0x32d476[_0x14e357(0x27a)],_0x14e357(0x1dc)+_0x32d476[_0x14e357(0x27a)])),_0x448101%_0x1f155e==0x0&&(_0x58646a[_0x37763d]=_0x511cfd,_0x37763d++);});const _0x5e10d1=Markup['inlineKeyboard'](_0x58646a);_0x1a0959[_0xeca315(0xe6)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x5e10d1);}}),tgBot[_0x4380e3(0x13a)](/on_(.+)/,async _0x928b59=>{const _0x8e21aa=_0x4380e3,_0xba217e=_0x928b59[_0x8e21aa(0xfa)][0x1];_0x928b59[_0x8e21aa(0x105)]();if(_0xba217e==_0x8e21aa(0x244)){const _0x5a6c2b=getDisabledBots();await sendTelegram(_0x928b59['chat']['id'],_0x8e21aa(0x1e0)),_0x5a6c2b[_0x8e21aa(0x294)](_0x43e192=>{const _0x548c3f=_0x8e21aa;if(_0x43e192['botID']!=_0x548c3f(0x244))toggleBot(_0x43e192[_0x548c3f(0x27a)],toggleStatus(_0x43e192[_0x548c3f(0x27a)]),_0x548c3f(0x170));});}else await sendTelegram(_0x928b59[_0x8e21aa(0x1b0)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0xba217e),toggleBot(_0xba217e,toggleStatus(_0xba217e),_0x8e21aa(0x170));}),tgBot[_0x4380e3(0x149)](_0x4380e3(0xaf),async _0x1633f5=>{const _0x54270f=_0x4380e3,_0x112791=getEnabledBots();if(_0x112791[_0x54270f(0x192)]==0x0)await sendTelegram(_0x1633f5[_0x54270f(0x1b0)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x112791[_0x54270f(0x192)]>0x1)_0x112791[_0x54270f(0x28d)]({'botID':_0x54270f(0x244)});let _0x2b4755=[],_0x4f3701=[];const _0x476ac3=_0x112791['length']%0x4==0x0||_0x112791[_0x54270f(0x192)]%0x4==0x3||_0x112791['length']%0x3==0x1?0x4:0x3;let _0xd086bd=0x0;_0x112791[_0x54270f(0x294)]((_0x5ad679,_0x12f600)=>{const _0x4bf1d9=_0x54270f;if(_0x12f600%_0x476ac3==0x0)_0x4f3701=[];_0x4f3701[_0x4bf1d9(0x28d)](Markup['button']['callback'](_0x5ad679['botID']==_0x4bf1d9(0x244)?_0x4bf1d9(0x250):_0x4bf1d9(0x17b)+_0x5ad679['botID'],_0x4bf1d9(0xb8)+_0x5ad679[_0x4bf1d9(0x27a)])),_0x12f600%_0x476ac3==0x0&&(_0x2b4755[_0xd086bd]=_0x4f3701,_0xd086bd++);});const _0x38d58d=Markup[_0x54270f(0x12e)](_0x2b4755);_0x1633f5[_0x54270f(0xe6)](_0x54270f(0x18c),_0x38d58d);}}),tgBot[_0x4380e3(0x13a)](/off_(.+)/,async _0x124535=>{const _0x54b84a=_0x4380e3,_0x204590=_0x124535[_0x54b84a(0xfa)][0x1];_0x124535[_0x54b84a(0x105)]();if(_0x204590==_0x54b84a(0x244)){const _0x3dc0c9=getEnabledBots();await sendTelegram(_0x124535[_0x54b84a(0x1b0)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x3dc0c9[_0x54b84a(0x294)](_0x3908e0=>{const _0x53a309=_0x54b84a;if(_0x3908e0[_0x53a309(0x27a)]!='all')toggleBot(_0x3908e0[_0x53a309(0x27a)],toggleStatus(_0x3908e0[_0x53a309(0x27a)]),_0x53a309(0x170));});}else await sendTelegram(_0x124535[_0x54b84a(0x1b0)]['id'],_0x54b84a(0x223)+_0x204590),toggleBot(_0x204590,toggleStatus(_0x204590),_0x54b84a(0x170));}),tgBot[_0x4380e3(0x149)]('metrics',async _0x1fbd42=>{const _0x4bebe1=_0x4380e3,_0x1ac104=getEnabledBots();if(_0x1ac104[_0x4bebe1(0x192)]==0x0)await sendTelegram(_0x1fbd42['chat']['id'],_0x4bebe1(0x1ae));else{if(_0x1ac104[_0x4bebe1(0x192)]>0x1){let _0x126b7e=[],_0x1a92a7=[];const _0x5627b9=_0x1ac104['length']%0x4==0x0||_0x1ac104[_0x4bebe1(0x192)]%0x4==0x3||_0x1ac104['length']%0x3==0x1?0x4:0x3;let _0x218333=0x0;_0x1ac104[_0x4bebe1(0x294)]((_0x1885a3,_0x3de8e6)=>{const _0x22693e=_0x4bebe1;if(_0x3de8e6%_0x5627b9==0x0)_0x1a92a7=[];_0x1a92a7['push'](Markup[_0x22693e(0x297)][_0x22693e(0x288)]('Bot\x20'+_0x1885a3['botID'],_0x22693e(0x227)+_0x1885a3[_0x22693e(0x27a)])),_0x3de8e6%_0x5627b9==0x0&&(_0x126b7e[_0x218333]=_0x1a92a7,_0x218333++);});const _0x56eaa1=Markup[_0x4bebe1(0x12e)](_0x126b7e);_0x1fbd42[_0x4bebe1(0xe6)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x56eaa1);}else{const _0x692385=_0x1ac104[0x0][_0x4bebe1(0x27a)];if(pid[_0x692385])pid[_0x692385][_0x4bebe1(0x193)]({'function':_0x4bebe1(0x173),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x21f161=>{const _0x17cb6a=_0x4380e3,_0x3b553d=_0x21f161[_0x17cb6a(0xfa)][0x1];_0x21f161[_0x17cb6a(0x105)]();if(pid[_0x3b553d])pid[_0x3b553d][_0x17cb6a(0x193)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x4380e3(0x149)]('portfolio',async _0x825f12=>{const _0x1c128d=_0x4380e3,_0xa7e4a1=getEnabledBots();if(_0xa7e4a1[_0x1c128d(0x192)]==0x0)await sendTelegram(_0x825f12[_0x1c128d(0x1b0)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0xa7e4a1[_0x1c128d(0x192)]>0x1){let _0x57d1b2=[],_0x3398f7=[];const _0x2431e8=_0xa7e4a1[_0x1c128d(0x192)]%0x4==0x0||_0xa7e4a1[_0x1c128d(0x192)]%0x4==0x3||_0xa7e4a1[_0x1c128d(0x192)]%0x3==0x1?0x4:0x3;let _0x5c04db=0x0;_0xa7e4a1['forEach']((_0x1b3c0a,_0x41cb48)=>{const _0x549a77=_0x1c128d;if(_0x41cb48%_0x2431e8==0x0)_0x3398f7=[];_0x3398f7[_0x549a77(0x28d)](Markup[_0x549a77(0x297)]['callback']('Bot\x20'+_0x1b3c0a[_0x549a77(0x27a)],_0x549a77(0x187)+_0x1b3c0a['botID'])),_0x41cb48%_0x2431e8==0x0&&(_0x57d1b2[_0x5c04db]=_0x3398f7,_0x5c04db++);});const _0x30fde0=Markup[_0x1c128d(0x12e)](_0x57d1b2);_0x825f12[_0x1c128d(0xe6)](_0x1c128d(0x1a4),_0x30fde0);}else{const _0x3c3080=_0xa7e4a1[0x0]['botID'];if(pid[_0x3c3080])pid[_0x3c3080][_0x1c128d(0x193)]({'function':_0x1c128d(0xef),'args':null});}}}),tgBot[_0x4380e3(0x13a)](/portfolio_(.+)/,async _0x43d58d=>{const _0x239376=_0x4380e3,_0x4c07ef=_0x43d58d[_0x239376(0xfa)][0x1];_0x43d58d[_0x239376(0x105)]();if(pid[_0x4c07ef])pid[_0x4c07ef][_0x239376(0x193)]({'function':_0x239376(0xef),'args':null});}),tgBot[_0x4380e3(0x149)](_0x4380e3(0xb4),async _0x11fda0=>{const _0x10da34=_0x4380e3;await getMessages();if(!updateAvailable)await sendTelegram(_0x11fda0[_0x10da34(0x1b0)]['id'],_0x10da34(0x142));else{if(!validInstallation)await sendTelegram(_0x11fda0[_0x10da34(0x1b0)]['id'],_0x10da34(0x1cf));else{const _0x226150=Markup[_0x10da34(0x12e)]([Markup[_0x10da34(0x297)][_0x10da34(0x288)](_0x10da34(0x134),_0x10da34(0xf3)),Markup['button']['callback']('No',_0x10da34(0x1a7))]);_0x11fda0['reply'](_0x10da34(0x1a8),_0x226150);}}}),tgBot[_0x4380e3(0x13a)](/update_(.+)/,async _0x4b2617=>{const _0x2b3e7a=_0x4380e3,_0x2816cd=_0x4b2617[_0x2b3e7a(0xfa)][0x1];_0x4b2617[_0x2b3e7a(0x105)](),_0x2816cd=='yes'&&(await sendTelegram(_0x4b2617[_0x2b3e7a(0x1b0)]['id'],_0x2b3e7a(0x177)),updateBB('update')),_0x2816cd=='no'&&await sendTelegram(_0x4b2617[_0x2b3e7a(0x1b0)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot['command'](_0x4380e3(0x15f),async _0x49463b=>{const _0x282196=_0x4380e3;if(!validInstallation)await sendTelegram(_0x49463b[_0x282196(0x1b0)]['id'],_0x282196(0x1c2));else{const _0x244a82=Markup['inlineKeyboard']([Markup[_0x282196(0x297)][_0x282196(0x288)](_0x282196(0x134),_0x282196(0xaa)),Markup[_0x282196(0x297)][_0x282196(0x288)]('No',_0x282196(0x1b5))]);_0x49463b['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x244a82);}}),tgBot[_0x4380e3(0x13a)](/reinstall_(.+)/,async _0x485fb5=>{const _0x122265=_0x4380e3,_0x505ea8=_0x485fb5['match'][0x1];_0x485fb5[_0x122265(0x105)](),_0x505ea8=='yes'&&(await sendTelegram(_0x485fb5[_0x122265(0x1b0)]['id'],_0x122265(0x14e)),updateBB(_0x122265(0x15f))),_0x505ea8=='no'&&await sendTelegram(_0x485fb5['chat']['id'],_0x122265(0x152));}),tgBot[_0x4380e3(0x149)](_0x4380e3(0x10a),async _0x15eaad=>{const _0x3f2b1e=_0x4380e3,_0xf8d419=getBotsWithMode();if(_0xf8d419['length']==0x0)await sendTelegram(_0x15eaad[_0x3f2b1e(0x1b0)]['id'],_0x3f2b1e(0x1ae));else{let _0xa42901=[],_0x58ab78=[];const _0x3692d9=0x2;let _0x3219b5=0x0;_0xf8d419['forEach']((_0xaa0636,_0x31a6a1)=>{const _0x324875=_0x3f2b1e;if(_0x31a6a1%_0x3692d9==0x0)_0x58ab78=[];_0x58ab78['push'](Markup['button'][_0x324875(0x288)](_0x324875(0x17b)+_0xaa0636[_0x324875(0x27a)]+'\x20('+_0xaa0636[_0x324875(0xf6)]+')',_0x324875(0xb7)+_0xaa0636[_0x324875(0x27a)])),_0x31a6a1%_0x3692d9==0x0&&(_0xa42901[_0x3219b5]=_0x58ab78,_0x3219b5++);});const _0x2f818f=Markup[_0x3f2b1e(0x12e)](_0xa42901);_0x15eaad[_0x3f2b1e(0xe6)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x2f818f);}}),tgBot[_0x4380e3(0x13a)](/toggle_(.+)/,async _0x56bbe8=>{const _0x51cb61=_0x4380e3,_0x11b8ff=_0x56bbe8['match'][0x1];_0x56bbe8[_0x51cb61(0x105)]();const _0x59c401=getBotsWithMode(),_0x3d88aa=_0x59c401['find'](_0xcdbb57=>_0xcdbb57[_0x51cb61(0x27a)]==_0x11b8ff),_0x175420=_0x3d88aa[_0x51cb61(0xf6)]==_0x51cb61(0x143)?_0x51cb61(0x1f9):_0x51cb61(0x143);await sendTelegram(_0x56bbe8[_0x51cb61(0x1b0)]['id'],_0x51cb61(0xd4)+_0x11b8ff+'\x20to\x20'+_0x175420+_0x51cb61(0x251)),toggleBotMode(_0x11b8ff);}),tgBot[_0x4380e3(0x149)](_0x4380e3(0x24a),async _0x1d6ebd=>{const _0x3faf93=_0x4380e3;let _0x344394='';config['forEach'](_0x2ed224=>{const _0x172765=_0x2db2;_0x344394+=_0x172765(0x17b)+_0x2ed224[_0x172765(0x27a)]+':\x20'+_0x2ed224[_0x172765(0x160)]+'\x0a';}),await sendTelegram(_0x1d6ebd[_0x3faf93(0x1b0)]['id'],_0x344394,{'parse_mode':_0x3faf93(0xe9)});}),tgBot[_0x4380e3(0x149)]('help',async _0x21c18b=>{await sendTelegram(_0x21c18b['chat']['id'],_0x3430e6);}),process[_0x4380e3(0x261)](_0x4380e3(0x29e),()=>tgBot[_0x4380e3(0x1be)](_0x4380e3(0x29e))),process[_0x4380e3(0x261)](_0x4380e3(0x295),()=>tgBot[_0x4380e3(0x1be)](_0x4380e3(0x295))),tgBot['launch']();}}function disableTelegram(){const _0xe763c5=_0x348e82;tgBot&&tgBot[_0xe763c5(0x1be)]();}async function sendTelegram(_0x32cf06,_0x7a8abb,_0x1c045d){const _0xf3fe47=_0x348e82;try{await tgBot[_0xf3fe47(0xbb)][_0xf3fe47(0x17e)](_0x32cf06,_0x7a8abb,_0x1c045d);}catch(_0x35b059){console[_0xf3fe47(0x25a)]('Telegram\x20error:',_0x35b059);}}async function sendTelegramBot(_0x4750f6,_0x13cc4c){const _0x13904b=_0x348e82;if(settings['telegramEnabled']){if(settings[_0x13904b(0xc2)]==_0x13904b(0x244)||(_0x13cc4c[_0x13904b(0x282)]=='error'||_0x13cc4c[_0x13904b(0x282)]==_0x13904b(0xf7)||_0x13cc4c[_0x13904b(0x282)]==_0x13904b(0x213))&&settings['telegramEvents']==_0x13904b(0x129)||_0x13cc4c[_0x13904b(0x282)]==_0x13904b(0x209)&&settings[_0x13904b(0xc2)]=='orders'){if(tgBot&&settings[_0x13904b(0x115)]){if(_0x13cc4c['showname'])await sendTelegram(settings[_0x13904b(0x115)],_0x13cc4c['botname']+'\x20>\x20'+_0x13cc4c[_0x13904b(0x17c)]);else await sendTelegram(settings[_0x13904b(0x115)],_0x13904b(0x17b)+_0x4750f6+'\x20>\x20'+_0x13cc4c['event']);}}}}async function sendTelegramMsg(_0x179c13,_0x519a25=_0x348e82(0xe9)){const _0x5b499e=_0x348e82;return settings[_0x5b499e(0x28e)]&&tgBot&&settings[_0x5b499e(0x115)]?(await sendTelegram(settings[_0x5b499e(0x115)],_0x179c13,{'parse_mode':_0x519a25}),!![]):![];}function getDeviceWithIp(_0x1da3bf){return devices['find'](_0x210939=>_0x210939['ip']===_0x1da3bf);}async function temporaryAccess2FA(_0x600a89,_0x26837f){const _0x31b9c1=_0x348e82;let _0x597804=new Date(),_0xd13cf2=![];if(lastIpApproval){if(_0x597804-lastIpApproval<0x1388)_0xd13cf2=!![];}lastIpApproval=new Date();if(_0xd13cf2)return;if(tgBot&&settings[_0x31b9c1(0x115)]){const _0x455691=uuidRandom();tmpStorage[_0x455691]={'uuid':_0x600a89,'externalip':_0x26837f};const _0xde837a=Markup[_0x31b9c1(0x12e)]([Markup['button'][_0x31b9c1(0x288)](_0x31b9c1(0x12d),_0x31b9c1(0x259)+_0x455691),Markup[_0x31b9c1(0x297)]['callback'](_0x31b9c1(0x212),_0x31b9c1(0x1bf)+_0x455691),Markup[_0x31b9c1(0x297)][_0x31b9c1(0x288)](_0x31b9c1(0x1d9),'tempaccess_30_'+_0x455691),Markup['button'][_0x31b9c1(0x288)](_0x31b9c1(0x146),_0x31b9c1(0x196)+_0x455691)]);await sendTelegram(settings[_0x31b9c1(0x115)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x26837f)[_0x31b9c1(0x15d)]+'\x20?',_0xde837a),tgBot[_0x31b9c1(0x13a)](/tempaccess_(.+)_(.+)/,async _0xff9ced=>{const _0x342556=_0x31b9c1,_0x3ceae5=_0xff9ced[_0x342556(0xfa)][0x1],_0x3a5bac=_0xff9ced[_0x342556(0xfa)][0x2],{uuid:_0xf29cdf,externalip:_0x589f17}=tmpStorage[_0x3a5bac];delete tmpStorage[_0x3a5bac],_0xff9ced[_0x342556(0x105)](),devices[_0xf29cdf][_0x342556(0x1c3)]={'clientip':_0x589f17,'timestamp':new Date()[_0x342556(0x273)](),'expiry':_0x3ceae5},_0x3ceae5!=_0x342556(0x146)?(await sendTelegram(_0xff9ced[_0x342556(0x1b0)]['id'],_0x342556(0x141)+_0x3ceae5+_0x342556(0xba),{'parse_mode':_0x342556(0xe9)}),io['to'](_0xf29cdf)['emit'](_0x342556(0xe0),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0xff9ced[_0x342556(0x1b0)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0xf29cdf)['emit'](_0x342556(0xe0),{'access':{'allow':![],'reason':_0x342556(0x1cc),'token':null}}));});}}async function loginAccess2FA(_0x3adbc1,_0x47dd70){const _0x291ebc=_0x348e82;if(tgBot&&settings[_0x291ebc(0x115)]){const _0x357a73=uuidRandom();tmpStorage[_0x357a73]={'uuid':_0x3adbc1,'externalip':_0x47dd70};const _0x2e21e9=Markup[_0x291ebc(0x12e)]([Markup['button'][_0x291ebc(0x288)]('accept','login2fa_'+loginExpiry+'_'+_0x357a73),Markup[_0x291ebc(0x297)][_0x291ebc(0x288)](_0x291ebc(0x146),_0x291ebc(0x20b)+_0x357a73)]);await sendTelegram(settings[_0x291ebc(0x115)],_0x291ebc(0x1c7)+normalizeIP(_0x47dd70)[_0x291ebc(0x15d)]+'\x20?',_0x2e21e9),tgBot[_0x291ebc(0x13a)](/login2fa_(.+)_(.+)/,async _0x5bff46=>{const _0x3a1d87=_0x291ebc,_0x2cbbb9=_0x5bff46[_0x3a1d87(0xfa)][0x1],_0x3c230c=_0x5bff46[_0x3a1d87(0xfa)][0x2],{uuid:_0x292ac2,externalip:_0x155f87}=tmpStorage[_0x3c230c];delete tmpStorage[_0x3c230c],_0x5bff46[_0x3a1d87(0x105)](),devices[_0x292ac2][_0x3a1d87(0x22a)]={'clientip':_0x155f87,'timestamp':new Date()[_0x3a1d87(0x273)](),'expiry':_0x2cbbb9},_0x2cbbb9!=_0x3a1d87(0x146)?(await sendTelegram(_0x5bff46['chat']['id'],'Login\x20accepted',{'parse_mode':_0x3a1d87(0xe9)}),io['to'](_0x292ac2)[_0x3a1d87(0xc8)](_0x3a1d87(0xe0),{'access':{'allow':![],'reason':_0x3a1d87(0x29a),'token':null}})):(await sendTelegram(_0x5bff46['chat']['id'],'Login\x20rejected'),io['to'](_0x292ac2)[_0x3a1d87(0xc8)](_0x3a1d87(0xe0),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x41e5bb=_0x348e82;return dbConfig[_0x41e5bb(0x1bc)](_0x41e5bb(0x24e))[_0x41e5bb(0x1d2)](_0x41e5bb(0x27a))[_0x41e5bb(0x195)]({'status':_0x41e5bb(0xe1)})[_0x41e5bb(0x22c)]()||[];}function getDisabledBots(){const _0x106ff6=_0x348e82;return dbConfig['get'](_0x106ff6(0x24e))[_0x106ff6(0x1d2)]('botID')[_0x106ff6(0x195)]({'status':_0x106ff6(0x291)})[_0x106ff6(0x22c)]()||[];}function getBotAttributes(_0x5da38c){const _0x41f742=_0x348e82;let _0x4f4e4f={};const _0xc2c68c=configpath+_0x41f742(0xf1)+_0x5da38c+_0x41f742(0x109),_0x5f4acc=fs[_0x41f742(0x253)](_0xc2c68c);if(_0x5f4acc){const _0xadc895=fs['readFileSync'](_0xc2c68c);try{const _0x5b9dd9=JSON[_0x41f742(0x21d)](_0xadc895),_0xb84d8=_0x5b9dd9?_0x5b9dd9['bot'][0x0][_0x41f742(0x1c0)]:![];_0x4f4e4f['mode']=_0xb84d8?'auto':_0x41f742(0x1f9),_0x4f4e4f[_0x41f742(0x160)]=_0x5b9dd9?_0x5b9dd9['bot'][0x0][_0x41f742(0x160)]:_0x41f742(0x17b)+_0x5da38c;}catch(_0x4ac700){_0x4f4e4f['mode']='manual',_0x4f4e4f['botname']='Bot\x20'+_0x5da38c;}}else _0x4f4e4f['mode']=_0x41f742(0x1f9),_0x4f4e4f[_0x41f742(0x160)]=_0x41f742(0x17b)+_0x5da38c;return _0x4f4e4f;}function getBotsWithMode(){const _0x181988=_0x348e82,_0x48bdb3=dbConfig['get'](_0x181988(0x24e))['sortBy'](_0x181988(0x27a))['value']()||[];return _0x48bdb3[_0x181988(0x294)](_0x1d1b37=>{const _0xf80457=_0x181988;let _0xb35260=getBotAttributes(_0x1d1b37[_0xf80457(0x27a)]);_0x1d1b37[_0xf80457(0xf6)]=_0xb35260[_0xf80457(0xf6)];}),_0x48bdb3;}function getBotExchanges(){const _0x2fad64=_0x348e82;let _0x4211da=[];const _0x4fc8ac=dbConfig[_0x2fad64(0x1bc)](_0x2fad64(0x24e))[_0x2fad64(0x1d2)](_0x2fad64(0x27a))[_0x2fad64(0x22c)]()||[];_0x4fc8ac[_0x2fad64(0x294)](_0x472cf7=>{const _0x4c3de1=_0x2fad64;if(_0x472cf7[_0x4c3de1(0xe0)]==_0x4c3de1(0xe1)){const _0x575008=configpath+_0x4c3de1(0xf1)+_0x472cf7[_0x4c3de1(0x27a)]+_0x4c3de1(0x109),_0xc1989d=fs[_0x4c3de1(0x253)](_0x575008);let _0x28ecdb;if(_0xc1989d){const _0x84add3=fs['readFileSync'](_0x575008);try{const _0x1d7d49=JSON[_0x4c3de1(0x21d)](_0x84add3);_0x28ecdb=_0x1d7d49?_0x1d7d49['bot'][0x0][_0x4c3de1(0x198)]:null;}catch(_0x193396){}}if(_0x28ecdb)_0x4211da['push'](_0x28ecdb);}});const _0x215066=[...new Set(_0x4211da)]['sort']();return _0x215066;}async function initUser(){const _0x85b4f9=_0x348e82;if(!settings[_0x85b4f9(0x11f)]){const _0x45f760=uuidRandom();mixpanel['alias'](_0x45f760),updateSetting(_0x85b4f9(0x11f),_0x45f760);}}async function initSecure(){const _0x328a7d=_0x348e82;let _0xf0c547=getSecure();if(!_0xf0c547[_0x328a7d(0x1a2)](_0x328a7d(0x204))){let _0x308edd=await generateKeys();_0xf0c547[_0x328a7d(0x140)]=_0x308edd[_0x328a7d(0x140)],_0xf0c547[_0x328a7d(0x234)]=_0x308edd[_0x328a7d(0x234)],_0xf0c547[_0x328a7d(0x204)]=crypto['randomBytes'](0x20)['toString'](_0x328a7d(0xdb));;storeSecure(_0xf0c547);}}function getSettings(){const _0xe1f144=_0x348e82;return dbSettings['get'](_0xe1f144(0xd3))[_0xe1f144(0x22c)]()||{};}function getSecure(){const _0x39bed5=_0x348e82;return dbSecure[_0x39bed5(0x1bc)](_0x39bed5(0x17d))[_0x39bed5(0x22c)]()||{};}function getBlacklist(){const _0x362af7=_0x348e82;return dbSecure[_0x362af7(0x1bc)]('blacklist')[_0x362af7(0x22c)]()||[];}function broadcastToBots(_0x2b1ea4,_0x4ae643){const _0x5ead4d=_0x348e82;config[_0x5ead4d(0x294)](_0x53620c=>{const _0x3caed2=_0x5ead4d;if(_0x53620c['status']==_0x3caed2(0xe1)&&_0x53620c['live']==_0x3caed2(0x285)||_0x53620c[_0x3caed2(0xe0)]=='new'&&_0x53620c[_0x3caed2(0x219)]==_0x3caed2(0x285)){if(pid[_0x53620c[_0x3caed2(0x27a)]])pid[_0x53620c[_0x3caed2(0x27a)]][_0x3caed2(0x193)]({[_0x2b1ea4]:_0x4ae643});}});}function storeSettings(_0x2a6bc1,_0x40c6a9=![]){const _0x32eaec=_0x348e82;_0x2a6bc1={...settings,..._0x2a6bc1};if(_0x40c6a9&&_0x2a6bc1['bbPassword']!=_0x32eaec(0x298)&&_0x2a6bc1[_0x32eaec(0x164)]!='***'&&_0x2a6bc1[_0x32eaec(0x164)]!=''){const _0x1be279=crypt['decrypt'](secure[_0x32eaec(0x234)],_0x2a6bc1['bbPassword'])[_0x32eaec(0xf5)][_0x32eaec(0x22d)]('@')[0x0],_0x46afab=bcrypt[_0x32eaec(0x11b)](_0x1be279,saltRounds);_0x2a6bc1={..._0x2a6bc1,'bbPassword':_0x46afab};}if(_0x40c6a9&&_0x2a6bc1[_0x32eaec(0x10f)]!=_0x32eaec(0x298)&&_0x2a6bc1[_0x32eaec(0x10f)]!=_0x32eaec(0x138)&&_0x2a6bc1[_0x32eaec(0x10f)]!=''){const _0x2cc430=crypt[_0x32eaec(0xfe)](secure[_0x32eaec(0x234)],_0x2a6bc1[_0x32eaec(0x10f)])['message']['split']('@')[0x0];_0x2a6bc1={..._0x2a6bc1,'telegramToken':_0x2cc430};}const _0x4a5efe=_0x2a6bc1[_0x32eaec(0x10f)]!=_0x32eaec(0x298)&&_0x2a6bc1['telegramToken']!=settings['telegramToken']||_0x2a6bc1[_0x32eaec(0x25e)]!=settings['telegramUsername'],_0x2ccc83=_0x2a6bc1[_0x32eaec(0x10f)]==''||_0x2a6bc1[_0x32eaec(0x25e)]=='';_0x4a5efe&&(_0x2a6bc1[_0x32eaec(0x115)]=null,_0x2a6bc1[_0x32eaec(0xc2)]=_0x32eaec(0x244));for(const [_0x260585,_0x197980]of Object[_0x32eaec(0x1b1)](_0x2a6bc1)){if(_0x260585==_0x32eaec(0x10f)&&_0x197980==_0x32eaec(0x298)){_0x2a6bc1[_0x32eaec(0x10f)]=settings[_0x32eaec(0x10f)];continue;};if(_0x260585==_0x32eaec(0x164)&&_0x197980==_0x32eaec(0x298)){_0x2a6bc1[_0x32eaec(0x164)]=settings[_0x32eaec(0x164)];continue;};dbSettings[_0x32eaec(0x179)](_0x32eaec(0x257)+_0x260585,_0x197980)[_0x32eaec(0x15a)]();}settings=_0x2a6bc1,io['to'](_0x32eaec(0x23f))[_0x32eaec(0xc8)](_0x32eaec(0xd3),cleanSettings()),broadcastToBots(_0x32eaec(0xb6),settings['timeshift']),broadcastToBots('onepagemode',settings[_0x32eaec(0xcd)]);if(_0x4a5efe&&!_0x2ccc83)initTelegram();if(_0x4a5efe&&_0x2ccc83)disableTelegram();getAllClients()[_0x32eaec(0x294)](_0x3cb7ea=>{const _0x5e8838=_0x32eaec;getSocket(_0x3cb7ea['id'])['emit'](_0x5e8838(0xe0),{'access':{'allow':![],'reason':_0x5e8838(0x29a),'token':null}});});}function updateSetting(_0x28de20,_0x39420b){const _0x32c4b0=_0x348e82;dbSettings[_0x32c4b0(0x179)]('settings.'+_0x28de20,_0x39420b)['write'](),settings=getSettings(),io['to'](_0x32c4b0(0x23f))[_0x32c4b0(0xc8)]('settings',cleanSettings());}function storeSecure(_0x28b3c0){const _0x56d54a=_0x348e82;dbSecure[_0x56d54a(0x1bc)](_0x56d54a(0x17d))[_0x56d54a(0x28d)](_0x28b3c0)[_0x56d54a(0x15a)](),secure=_0x28b3c0;}function addBlacklist(_0x2be4be){const _0xf01c0d=_0x348e82;cleanBlacklist();let _0x5deb29;devices[_0x2be4be][_0xf01c0d(0x1c3)]?_0x5deb29=Math['max'](devices[_0x2be4be][_0xf01c0d(0x1c3)]['expiry'],loginExpiry):_0x5deb29=loginExpiry,dbSecure['get'](_0xf01c0d(0x15c))[_0xf01c0d(0x28d)]({'expiry':new Date()[_0xf01c0d(0x273)]()+_0x5deb29*0x3c*0x3e8,'token':devices[_0x2be4be]['access'][_0xf01c0d(0x232)]})[_0xf01c0d(0x15a)](),blacklist=dbSecure['get']('blacklist')[_0xf01c0d(0x22c)]();}function cleanBlacklist(){const _0x4fa1ca=_0x348e82;let _0x98ad4=dbSecure[_0x4fa1ca(0x1bc)](_0x4fa1ca(0x15c))[_0x4fa1ca(0x189)]()['value'](),_0x329a1a=new Date()[_0x4fa1ca(0x273)]();_0x98ad4['forEach'](_0x12abff=>{const _0xd8b74c=_0x4fa1ca;_0x12abff[_0xd8b74c(0xae)]<_0x329a1a&&dbSecure[_0xd8b74c(0x1bc)](_0xd8b74c(0x15c))['remove']({'expiry':_0x12abff[_0xd8b74c(0xae)]})['write']();});}function initStates(){const _0xfcb8c8=_0x348e82;let _0x33d356=getConfiguration();_0x33d356[_0xfcb8c8(0x294)](_0xf9d787=>{const _0xce78f=_0xfcb8c8;_0xf9d787['live']=_0xce78f(0x170);}),storeConfiguration(_0x33d356);}function onKeys(){const _0x5ce766=new RSA();return new Promise(_0x242e26=>{_0x5ce766['generateKeyPairAsync']()['then'](_0x379bd0=>{_0x242e26(_0x379bd0);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5401f2=_0x348e82;let _0xbac776=getSettings(),_0xf3f7d4=![];!_0xbac776[_0x5401f2(0x1a2)](_0x5401f2(0x1b4))&&(_0xbac776['lastmsgtelegram']=0x0,_0xf3f7d4=!![]);!_0xbac776['hasOwnProperty'](_0x5401f2(0x130))&&(_0xbac776['lastmsgemitted']=0x0,_0xf3f7d4=!![]);!_0xbac776[_0x5401f2(0x1a2)](_0x5401f2(0x1bb))&&(_0xbac776['latestversion']='0.0.0',_0xf3f7d4=!![]);!_0xbac776[_0x5401f2(0x1a2)](_0x5401f2(0xcd))&&(_0xbac776[_0x5401f2(0xcd)]=![],_0xf3f7d4=!![]);if(_0xf3f7d4)storeSettings(_0xbac776);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x5401f2(0x294)](_0x5b70f6=>{const _0x211b94=_0x5401f2;if(!_0x5b70f6[_0x211b94(0x224)]()){if(!_0x5b70f6[_0x211b94(0x1fc)]['startsWith'](_0x211b94(0x1da)))fs[_0x211b94(0x220)](configbackuppath+_0x5b70f6[_0x211b94(0x1fc)]);}else fs[_0x211b94(0x102)](configbackuppath+_0x5b70f6['name'],{'recursive':!![]});});}catch(_0x83bf56){logger[_0x5401f2(0x25d)](_0x5401f2(0x266),_0x83bf56);}}function storeConfiguration(_0x1c9dfc){const _0x37c728=_0x348e82;dbConfig[_0x37c728(0x1bc)]('bots')['remove']()[_0x37c728(0x15a)](),dbConfig[_0x37c728(0x1bc)](_0x37c728(0x24e))['push'](..._0x1c9dfc)[_0x37c728(0x15a)](),config=_0x1c9dfc;}async function resetPassword(){const _0x1d9476=_0x348e82;if(tgBot&&settings[_0x1d9476(0x115)]){const _0x17ba98=Markup[_0x1d9476(0x12e)]([Markup[_0x1d9476(0x297)]['callback'](_0x1d9476(0x168),_0x1d9476(0x190)),Markup[_0x1d9476(0x297)]['callback']('no','resetpw_no')]);await sendTelegram(settings['telegramChatId'],_0x1d9476(0x1a1),_0x17ba98),tgBot['action'](/resetpw_(.+)/,async _0x33937f=>{const _0x406b80=_0x1d9476,_0x27f0b4=_0x33937f['match'][0x1];_0x33937f[_0x406b80(0x105)]();if(_0x27f0b4!='no'){const _0x4d942c=0xf,_0x4f5086='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x237d05=Array['from'](crypto[_0x406b80(0xdc)](new Uint32Array(_0x4d942c)))[_0x406b80(0xcb)](_0x44d1d0=>_0x4f5086[_0x44d1d0%_0x4f5086[_0x406b80(0x192)]])[_0x406b80(0x29f)](''),_0xd71fed=bcrypt['hashSync'](_0x237d05,saltRounds);storeSettings({'bbPassword':_0xd71fed}),await sendTelegram(_0x33937f[_0x406b80(0x1b0)]['id'],_0x406b80(0x1ad)+_0x237d05,{'parse_mode':_0x406b80(0xe9)});}else await sendTelegram(_0x33937f[_0x406b80(0x1b0)]['id'],_0x406b80(0x159));});}}async function confirmRestore(_0x75655e,_0x36fc64){const _0x56e26f=_0x348e82;io['to'](_0x56e26f(0x23f))['emit'](_0x56e26f(0x26f),_0x56e26f(0x13d),'success');if(tgBot&&settings[_0x56e26f(0x115)]){const _0x2817b2=uuidRandom();tmpStorage[_0x2817b2]={'path':_0x75655e,'filename':_0x36fc64};const _0x1fda1e=Markup[_0x56e26f(0x12e)]([Markup[_0x56e26f(0x297)][_0x56e26f(0x288)]('yes',_0x56e26f(0x263)+_0x2817b2),Markup[_0x56e26f(0x297)][_0x56e26f(0x288)]('no',_0x56e26f(0x276)+_0x2817b2)]);await sendTelegram(settings[_0x56e26f(0x115)],_0x56e26f(0x118),_0x1fda1e),tgBot['action'](/restore_(.+)_(.+)/,async _0xedaf8=>{const _0x1cc213=_0x56e26f,_0x308790=_0xedaf8[_0x1cc213(0xfa)][0x1],_0xb70b97=_0xedaf8[_0x1cc213(0xfa)][0x2],{path:_0x5d7f7c,filename:_0x257b3a}=tmpStorage[_0xb70b97];delete tmpStorage[_0xb70b97],_0xedaf8[_0x1cc213(0x105)](),_0x308790==_0x1cc213(0x168)?(logger[_0x1cc213(0x25d)](_0x1cc213(0x20e)),await sendTelegram(_0xedaf8[_0x1cc213(0x1b0)]['id'],_0x1cc213(0x19b),{'parse_mode':_0x1cc213(0xe9)}),unzipFile(_0x5d7f7c,_0x257b3a)):(logger[_0x1cc213(0x25d)](_0x1cc213(0x156)),await sendTelegram(_0xedaf8[_0x1cc213(0x1b0)]['id'],_0x1cc213(0x156)));});}}function getServerTime(){const _0x1495be=_0x348e82,_0x31de24=new Date();return _0x31de24[_0x1495be(0x210)]()+'/'+(_0x31de24[_0x1495be(0xa8)]()+0x1)['toString']()[_0x1495be(0x1fa)](0x2,'0')+'/'+_0x31de24[_0x1495be(0x178)]()[_0x1495be(0x1ec)]()[_0x1495be(0x1fa)](0x2,'0')+'\x20'+_0x31de24[_0x1495be(0xe3)]()[_0x1495be(0x1ec)]()[_0x1495be(0x1fa)](0x2,'0')+':'+_0x31de24[_0x1495be(0xdf)]()['toString']()[_0x1495be(0x1fa)](0x2,'0')+':'+_0x31de24[_0x1495be(0x18e)]()[_0x1495be(0x1ec)]()[_0x1495be(0x1fa)](0x2,'0');}function getTimeStamp(){const _0x2adee1=_0x348e82,_0x2ffefc=shiftedTime();return _0x2ffefc['getFullYear']()+'/'+(_0x2ffefc[_0x2adee1(0xa8)]()+0x1)[_0x2adee1(0x1ec)]()[_0x2adee1(0x1fa)](0x2,'0')+'/'+_0x2ffefc['getDate']()[_0x2adee1(0x1ec)]()[_0x2adee1(0x1fa)](0x2,'0')+'\x20'+_0x2ffefc['getHours']()[_0x2adee1(0x1ec)]()[_0x2adee1(0x1fa)](0x2,'0')+':'+_0x2ffefc[_0x2adee1(0xdf)]()[_0x2adee1(0x1ec)]()['padStart'](0x2,'0')+':'+_0x2ffefc[_0x2adee1(0x18e)]()[_0x2adee1(0x1ec)]()[_0x2adee1(0x1fa)](0x2,'0');}function getCleanTimeStamp(){const _0x31eee7=_0x348e82,_0x2bcb15=shiftedTime();return _0x2bcb15[_0x31eee7(0x210)]()+(_0x2bcb15[_0x31eee7(0xa8)]()+0x1)[_0x31eee7(0x1ec)]()[_0x31eee7(0x1fa)](0x2,'0')+_0x2bcb15[_0x31eee7(0x178)]()[_0x31eee7(0x1ec)]()[_0x31eee7(0x1fa)](0x2,'0')+'-'+_0x2bcb15[_0x31eee7(0xe3)]()[_0x31eee7(0x1ec)]()[_0x31eee7(0x1fa)](0x2,'0')+_0x2bcb15[_0x31eee7(0xdf)]()[_0x31eee7(0x1ec)]()[_0x31eee7(0x1fa)](0x2,'0')+_0x2bcb15[_0x31eee7(0x18e)]()[_0x31eee7(0x1ec)]()[_0x31eee7(0x1fa)](0x2,'0');}function shiftedTime(){const _0x50ac6b=_0x348e82,_0x779dcc=new Date();let _0x3be18a=_0x779dcc;if(settings['timeshift']&&settings[_0x50ac6b(0xb6)]!==0x0)_0x3be18a=fns[_0x50ac6b(0x120)](_0x779dcc,{'hours':settings[_0x50ac6b(0xb6)]});return _0x3be18a;}function startScheduler(){const _0x52659c=_0x348e82,_0x46040f=new Date()[_0x52659c(0xfb)](),_0x4d8690=shiftedTime()[_0x52659c(0xe3)]();_0x4d8690==0x4&&backupConfigFiles();_0x4d8690==0x0&&rotateLogFiles();_0x46040f%0x6==0x0&&triggerAnalytics();_0x46040f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4e317d){const _0x37a94f=_0x348e82;logger[_0x37a94f(0x25d)](_0x37a94f(0x162)+_0x4e317d);const _0x1eddf1=getBotsWithMode();_0x1eddf1[_0x37a94f(0x192)]>0x0?confirmRestore(configbackuppath,_0x4e317d):unzipFile(configbackuppath,_0x4e317d);}async function getBackupFiles(_0x1da7b3=null){const _0x3d4a7b=_0x348e82;let _0xc2c018=[],_0x1500d7=fs[_0x3d4a7b(0x1df)](configbackuppath,{'withFileTypes':!![]});_0x1500d7['sort']((_0x9caab,_0x59093c)=>_0x9caab[_0x3d4a7b(0x1fc)]<_0x59093c[_0x3d4a7b(0x1fc)]?0x1:_0x59093c[_0x3d4a7b(0x1fc)]<_0x9caab[_0x3d4a7b(0x1fc)]?-0x1:0x0),_0x1500d7['forEach'](_0x3665a0=>{const _0x2d53b0=_0x3d4a7b;if(!_0x3665a0[_0x2d53b0(0x224)]()&&_0x3665a0[_0x2d53b0(0x1fc)][_0x2d53b0(0x205)](_0x2d53b0(0x1da))&&_0x3665a0['name'][_0x2d53b0(0x281)]('.zip')){const _0x1b7afa=formatDate(fs['statSync'](configbackuppath+_0x3665a0[_0x2d53b0(0x1fc)])[_0x2d53b0(0x1f3)]);_0xc2c018[_0x2d53b0(0x28d)]({'name':_0x3665a0[_0x2d53b0(0x1fc)],'mtime':_0x1b7afa});}});if(_0x1da7b3)io['to'](_0x1da7b3)[_0x3d4a7b(0xc8)](_0x3d4a7b(0x296),_0xc2c018);else return _0xc2c018;}async function backupConfigFiles(){const _0x2d8af3=_0x348e82;await zipFiles('backup-full');const _0x40f6dd=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x2d8af3(0x228),configbackuppath+(_0x2d8af3(0x1da)+_0x40f6dd+_0x2d8af3(0x231)));let _0x3d89ad=fs[_0x2d8af3(0x1df)](configbackuppath,{'withFileTypes':!![]});_0x3d89ad[_0x2d8af3(0x19a)]((_0x1091b3,_0x52ea46)=>_0x1091b3[_0x2d8af3(0x1fc)]<_0x52ea46[_0x2d8af3(0x1fc)]?0x1:_0x52ea46[_0x2d8af3(0x1fc)]<_0x1091b3[_0x2d8af3(0x1fc)]?-0x1:0x0),_0x3d89ad[_0x2d8af3(0x192)]>maxBackups&&fs[_0x2d8af3(0x220)](configbackuppath+_0x3d89ad[_0x3d89ad[_0x2d8af3(0x192)]-0x1]['name']);}function rotateLogFiles(){const _0x575798=_0x348e82,_0x44d0fd=fs[_0x575798(0xd8)](logspath+'output-000.log'),_0x4359b2=_0x44d0fd[_0x575798(0x26c)]/0x400;if(_0x4359b2>0x64){let _0x185675=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x185675['sort']((_0x4bed75,_0x1ffb77)=>_0x4bed75[_0x575798(0x1fc)]<_0x1ffb77['name']?0x1:_0x1ffb77['name']<_0x4bed75[_0x575798(0x1fc)]?-0x1:0x0),_0x185675[_0x575798(0x294)](_0x8ff10e=>{const _0x4301c4=_0x575798;if(_0x8ff10e['name']=='output-002.log')fs['copyFileSync'](logspath+_0x8ff10e['name'],logspath+_0x4301c4(0x1f4));if(_0x8ff10e[_0x4301c4(0x1fc)]==_0x4301c4(0x1d7))fs['copyFileSync'](logspath+_0x8ff10e[_0x4301c4(0x1fc)],logspath+_0x4301c4(0x28c));_0x8ff10e[_0x4301c4(0x1fc)]==_0x4301c4(0xee)&&(fs[_0x4301c4(0x26a)](logspath+_0x8ff10e[_0x4301c4(0x1fc)],logspath+'output-001.log'),fs[_0x4301c4(0xcf)](logspath+_0x8ff10e[_0x4301c4(0x1fc)],''));});}}async function zipFiles(_0x55dd7a){const _0x1ed9d7=_0x348e82;let _0x425fe3;if(_0x55dd7a==_0x1ed9d7(0x247))_0x425fe3=logspath;if(_0x55dd7a==_0x1ed9d7(0x11a))_0x425fe3=configpath;if(_0x55dd7a=='backup-full')_0x425fe3=configpath;let _0x19041e=fs[_0x1ed9d7(0x1df)](_0x425fe3,{'withFileTypes':!![]});const _0x5e6ae2=new require('node-zip')();_0x19041e[_0x1ed9d7(0x294)](_0x30340a=>{const _0x3595fa=_0x1ed9d7;if(!_0x30340a[_0x3595fa(0x224)]()){let _0x76b049=fs['readFileSync'](_0x425fe3+_0x30340a[_0x3595fa(0x1fc)]);if(_0x55dd7a==_0x3595fa(0x11a)){const _0x392d9f=/^bot-[0-9]{3}-config.json$/,_0x3ba034=_0x392d9f[_0x3595fa(0x23c)](_0x30340a['name']);if(_0x3ba034){const _0x383ff1=JSON[_0x3595fa(0x21d)](_0x76b049);if(_0x383ff1['bot'][0x0]){_0x383ff1[_0x3595fa(0x150)][0x0]['apiKey']=_0x3595fa(0x138),_0x383ff1['bot'][0x0]['apiSecret']=_0x3595fa(0x138);if(_0x383ff1[_0x3595fa(0x150)][0x0][_0x3595fa(0x211)])_0x383ff1[_0x3595fa(0x150)][0x0]['apiPassword']=_0x3595fa(0x138);}_0x76b049=JSON[_0x3595fa(0xa9)](_0x383ff1,null,0x2);}if(_0x30340a['name']==_0x3595fa(0x163)){const _0x4007bb=JSON[_0x3595fa(0x21d)](_0x76b049);if(_0x4007bb[_0x3595fa(0xd3)][_0x3595fa(0x20a)])_0x4007bb['settings'][_0x3595fa(0x20a)]=![];if(_0x4007bb['settings'][_0x3595fa(0x164)])_0x4007bb[_0x3595fa(0xd3)][_0x3595fa(0x164)]=_0x3595fa(0x138);if(_0x4007bb['settings']['telegramToken'])_0x4007bb[_0x3595fa(0xd3)][_0x3595fa(0x10f)]=_0x3595fa(0x138);if(_0x4007bb[_0x3595fa(0xd3)][_0x3595fa(0x115)])_0x4007bb[_0x3595fa(0xd3)][_0x3595fa(0x115)]=null;_0x76b049=JSON[_0x3595fa(0xa9)](_0x4007bb,null,0x2);}if(_0x30340a[_0x3595fa(0x1fc)]!=_0x3595fa(0x1eb))_0x5e6ae2['file'](_0x30340a[_0x3595fa(0x1fc)],_0x76b049);}else _0x5e6ae2[_0x3595fa(0x21f)](_0x30340a[_0x3595fa(0x1fc)],_0x76b049);}});const _0x4229cb=_0x5e6ae2['generate']({'base64':![],'compression':_0x1ed9d7(0x28a)});fs[_0x1ed9d7(0xcf)](zippath+(_0x55dd7a+_0x1ed9d7(0x231)),_0x4229cb,_0x1ed9d7(0x1c9));}async function unzipFile(_0x4d0346,_0x503dd2){const _0x163edb=_0x348e82;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x163edb(0x294)](_0x17ecf8=>{const _0x45154f=_0x163edb;if(!_0x17ecf8[_0x45154f(0x224)]())fs[_0x45154f(0x102)](configpath+_0x17ecf8[_0x45154f(0x1fc)]);});const _0x2907cd=fs['readFileSync'](_0x4d0346+_0x503dd2,'binary'),_0xb45a43=new require(_0x163edb(0x1af))(_0x2907cd,{'base64':![],'checkCRC32':!![]});Object[_0x163edb(0xa6)](_0xb45a43['files'])[_0x163edb(0x294)](_0x49b11a=>{const _0x21cbb9=_0x163edb,_0x29c886=_0xb45a43[_0x21cbb9(0x18f)][_0x49b11a];fs[_0x21cbb9(0xcf)](configpath+_0x29c886[_0x21cbb9(0x1fc)],_0x29c886[_0x21cbb9(0x283)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x163edb(0x294)](_0x24e383=>{const _0x2237ad=_0x163edb;if(!_0x24e383['isDirectory']())fs[_0x2237ad(0x102)](temppath+_0x24e383[_0x2237ad(0x1fc)]);}),logger[_0x163edb(0x25d)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x163edb(0x193)]({'restore':!![]},_0x5b8bff=>{});}async function getPublicIp(){const _0x5e3ed9=_0x348e82;try{const _0x38efee=await axios[_0x5e3ed9(0x1bc)]('https://api.ipify.org?format=json');publicip=_0x38efee[_0x5e3ed9(0x172)]['ip'];}catch(_0x308e6d){}}async function triggerAnalytics(){const _0x56f600=_0x348e82;if(!publicip)await getPublicIp();const _0x3deff3=getBotsWithMode();let _0x1ddbd6=0x0;_0x3deff3[_0x56f600(0x294)](_0x1f9ea4=>{const _0x499101=_0x56f600;if(_0x1f9ea4[_0x499101(0xe0)]===_0x499101(0xe1))_0x1ddbd6++;});const _0xe92a64=getBotExchanges();mixpanel[_0x56f600(0x1b6)](_0x56f600(0x123),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3deff3['length'],'numbotsenabled':_0x1ddbd6,'exchanges':_0xe92a64,'environment':environment});}async function getMessages(){const _0xdd3a83=_0x348e82,_0x5a8bf2='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x26b104=new GraphQLClient(_0x5a8bf2),_0x80716f={'authorization':_0xdd3a83(0xe5)},_0x2125a0=serverversion['split']('.'),_0x1be0ef=_0x2125a0[0x0]+'.'+_0x2125a0[0x1],_0x4ff903=Math[_0xdd3a83(0x101)](settings[_0xdd3a83(0x1b4)],settings[_0xdd3a83(0x130)]),_0x5e49aa={'last':parseInt(_0x4ff903),'bbm':_0x1be0ef},_0xdf8272=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x42828b;try{_0x42828b=await _0x26b104[_0xdd3a83(0x1b3)](_0xdf8272,_0x5e49aa,_0x80716f);}catch(_0x3cde57){}if(_0x42828b&&_0x42828b[_0xdd3a83(0x1ba)]){let _0x3b234c=settings['lastmsgtelegram'];newMessages=[];for(const _0x55cd04 of _0x42828b['messages']){newMessages[_0xdd3a83(0x28d)](_0x55cd04);let _0x14c5c5=![];_0x55cd04[_0xdd3a83(0x117)]&&(updateSetting(_0xdd3a83(0x1bb),_0x55cd04[_0xdd3a83(0x117)]),_0x14c5c5=isNewerVersion(serverversion,_0x55cd04[_0xdd3a83(0x117)])||serverversion==_0x55cd04[_0xdd3a83(0x117)]);if(!_0x14c5c5&&_0x55cd04[_0xdd3a83(0x1e7)]>_0x3b234c){if(_0x55cd04[_0xdd3a83(0x264)]===_0xdd3a83(0x238)||serverversion['startsWith'](_0x55cd04[_0xdd3a83(0x264)])){let _0x3fb8ee=''+_0x55cd04[_0xdd3a83(0xd1)]+'\x0a\x0a'+_0x55cd04[_0xdd3a83(0xf5)];const _0x3e551e=await sendTelegramMsg(toTelegramMarkdown(_0x3fb8ee),_0xdd3a83(0x10d));if(_0x3e551e)_0x3b234c=_0x55cd04[_0xdd3a83(0x1e7)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0xdd3a83(0x1b4),_0x3b234c),emitMessages();}}function emitMessages(){const _0x2496db=_0x348e82,_0x1c3753=settings[_0x2496db(0x130)];let _0x5adf65=[];newMessages[_0x2496db(0x294)](_0x464c0c=>{const _0x2a1fd6=_0x2496db;_0x464c0c[_0x2a1fd6(0x1e7)]>_0x1c3753&&_0x5adf65[_0x2a1fd6(0x28d)](_0x464c0c);}),_0x5adf65[_0x2496db(0x192)]>0x0&&getAllClients()['forEach'](_0x24df18=>{const _0x3868c1=_0x2496db;getSocket(_0x24df18['id'])['emit'](_0x3868c1(0xf5),_0x5adf65);});}function confirmMessage(_0x500f60){const _0x843cfc=_0x348e82;updateSetting(_0x843cfc(0x130),Number(_0x500f60));}function isNewerVersion(_0x13eb80,_0x16d52d){const _0x3800bd=_0x348e82,_0x13d0f6=_0x16d52d[_0x3800bd(0x22d)]('.'),_0x973a0c=_0x13eb80[_0x3800bd(0x22d)]('.');for(var _0x6c7f04=0x0;_0x6c7f04<_0x973a0c[_0x3800bd(0x192)];_0x6c7f04++){const _0x3e0681=~~_0x973a0c[_0x6c7f04],_0x5eb1df=~~_0x13d0f6[_0x6c7f04];if(_0x3e0681>_0x5eb1df)return!![];if(_0x3e0681<_0x5eb1df)return![];}return![];}function toTelegramMarkdown(_0x52dfbc){const _0x3ca195=_0x348e82,_0xf260f2=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x31fa4d=/\*{2}(.+?)\*{2}/gim;return _0x52dfbc=_0x52dfbc[_0x3ca195(0x147)](_0xf260f2,_0x3ca195(0x144))[_0x3ca195(0x147)](_0x31fa4d,'*$1*'),_0x52dfbc;}async function validateConfigFile(){const _0x4a9ed3=_0x348e82,_0x7503f3=dbConfig[_0x4a9ed3(0x1bc)](_0x4a9ed3(0x24e))[_0x4a9ed3(0x1d2)]('botID')[_0x4a9ed3(0x22c)]()||[];if(_0x7503f3[_0x4a9ed3(0x192)]==0x0){let _0x566e9c=0x0,_0x4954b3=[];const _0x4a450e=/^bot-([0-9]{3})-config.json$/,_0x118f59=fs[_0x4a9ed3(0x1df)](configpath);_0x118f59[_0x4a9ed3(0x294)](_0x5175f6=>{const _0x425dff=_0x4a9ed3,_0x496403=_0x4a450e[_0x425dff(0x214)](_0x5175f6);if(_0x496403){const _0x16bccb=_0x496403[0x1];let _0x61b390=getBotAttributes(_0x16bccb);_0x4954b3[_0x425dff(0x28d)]({'botID':_0x16bccb,'botname':_0x61b390[_0x425dff(0x160)],'status':_0x425dff(0x291),'live':'stopped'}),_0x566e9c++;}}),_0x566e9c!=0x0&&(dbConfig[_0x4a9ed3(0x1bc)](_0x4a9ed3(0x24e))[_0x4a9ed3(0x29b)](_0x4954b3)[_0x4a9ed3(0x15a)](),config=_0x4954b3,restoredConfigFile=_0x566e9c);}}async function restoreConfigNotify(_0x432437){const _0x97e7be=_0x348e82;let _0x497a2b;if(restoredConfigFile==0x1)_0x497a2b=_0x97e7be(0x154);else _0x497a2b=_0x97e7be(0x29d);if(_0x432437)io['to'](_0x97e7be(0x23f))[_0x97e7be(0xc8)](_0x97e7be(0x26f),_0x497a2b);else{logger[_0x97e7be(0x1ee)](_0x97e7be(0x27f)),logger[_0x97e7be(0x1ee)](_0x497a2b),logger[_0x97e7be(0x1ee)](_0x97e7be(0x27f)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x97e7be(0xc2)]!=_0x97e7be(0x1f8))await sendTelegram(settings[_0x97e7be(0x115)],_0x97e7be(0x28f)+_0x497a2b);}}function validateCredentials(_0x3d6b97,_0x268cc7){const _0x50fc8a=_0x348e82;if(_0x3d6b97['username']==settings['bbUsername']&&bcrypt[_0x50fc8a(0x225)](_0x3d6b97[_0x50fc8a(0x1f0)],settings[_0x50fc8a(0x164)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x50fc8a(0xfd),'token':null};else{const _0x463678=generateLoginToken(_0x268cc7);return{'allow':!![],'reason':_0x50fc8a(0x127),'token':_0x463678};}}else return{'allow':![],'reason':_0x50fc8a(0xe8),'token':null};}function refreshToken(_0x1b594c){const _0x43fc85=_0x348e82,_0x5d6710=generateLoginToken(_0x1b594c);return{'allow':!![],'reason':_0x43fc85(0x127),'token':_0x5d6710};}function validateAccess(_0x3155a3,_0x4d779d,_0x1bda38){const _0xb40aff=_0x348e82,_0xeba3ce=_0x1bda38?_0x1bda38:devices[_0x4d779d]['ip'];let _0x2190ac;const _0x21b40a=_0x346896=>{const _0x52cd4c=_0x2db2;if(settings[_0x52cd4c(0x20a)]){if(settings[_0x52cd4c(0x258)]){if(telegram2FaApproved(_0x4d779d)){const _0x454d43=generateLoginToken(_0x4d779d);return{'allow':!![],'reason':_0x52cd4c(0x174),'token':_0x454d43};}else return{'allow':![],'reason':_0x52cd4c(0x260),'token':null};}else return _0x2190ac=validToken(_0x346896,_0x4d779d),_0x2190ac[_0x52cd4c(0x1a2)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x346896}:{'allow':![],'reason':_0x52cd4c(0x260),'token':null};}else return{'allow':!![],'reason':_0x52cd4c(0x23a),'token':null};};if(settings[_0xb40aff(0xa4)]){let _0xc7c96b=[...settings[_0xb40aff(0x191)],_0xb40aff(0xe4),_0xb40aff(0x125),'127.0.0.1'];if(_0xc7c96b[_0xb40aff(0x275)](_0xeba3ce))return _0x21b40a(_0x3155a3);else{_0x2190ac=validToken(_0x3155a3,_0x4d779d);if(_0x2190ac[_0xb40aff(0x1a2)](_0xb40aff(0x213)))return _0x21b40a(_0x3155a3);else{if(telegramIpApproved(_0x4d779d)){const _0x2d8a1a=generateToken(_0x4d779d);return _0x2190ac=_0x21b40a(_0x3155a3),_0x2190ac['allow']?{'allow':!![],'reason':_0xb40aff(0x21a),'token':_0x2d8a1a}:_0x2190ac;}else return settings[_0xb40aff(0x180)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x21b40a(_0x3155a3);}function timelyDecrypt(_0x27d28f,_0x446bd9=!![]){const _0x5643b5=_0x348e82;if(_0x27d28f)try{const _0x34c97d=crypt[_0x5643b5(0xfe)](secure[_0x5643b5(0x234)],_0x27d28f)[_0x5643b5(0xf5)],_0x4b4375=_0x34c97d[_0x5643b5(0x22d)]('@')[0x0],_0x216cde=_0x34c97d['split']('@')[0x1],_0x198ef5=new Date()[_0x5643b5(0x273)]();if(_0x446bd9){if(_0x198ef5-_0x216cde<maxSecretAge*0x3e8)return _0x4b4375;else return![];}else return _0x4b4375;}catch(_0x468b3c){return![];}else return![];}const validToken=(_0x14ef93,_0x2dc843)=>{const _0x59bdb7=_0x348e82,_0x198053=devices[_0x2dc843]['ip'];if(!_0x14ef93)return{'error':_0x59bdb7(0xd5)};for(let _0x2678a6 of blacklist){if(_0x2678a6[_0x59bdb7(0x232)]==_0x14ef93)return{'error':_0x59bdb7(0xca)};}let _0x485e3d;try{_0x485e3d=jwt[_0x59bdb7(0x137)](_0x14ef93,secure[_0x59bdb7(0x204)]+_0x2dc843);}catch{return{'error':_0x59bdb7(0x1e5)};}if(!_0x485e3d[_0x59bdb7(0x1a2)]('clientip')&&!_0x485e3d[_0x59bdb7(0x1a2)](_0x59bdb7(0x280))||!_0x485e3d[_0x59bdb7(0x1a2)](_0x59bdb7(0x148)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x485e3d['hasOwnProperty']('username')&&_0x485e3d[_0x59bdb7(0x1a2)](_0x59bdb7(0xb5))){const {clientip:_0x33201b}=_0x485e3d;return _0x198053==_0x33201b?{'success':_0x59bdb7(0x218)}:{'error':_0x59bdb7(0x272)};}else{if(_0x485e3d['hasOwnProperty'](_0x59bdb7(0x280))&&_0x485e3d[_0x59bdb7(0x1a2)]('clientip')){const {username:_0x102c79,clientip:_0x5b504a}=_0x485e3d;return settings['bbUsername']==_0x102c79&&_0x198053==_0x5b504a?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x59bdb7(0x25c)};}}},generateLoginToken=_0x21c86f=>{const _0x17f869=_0x348e82;if(_0x21c86f){const _0x46f72d=devices[_0x21c86f]['ip'];return jwt[_0x17f869(0x249)]({'username':settings[_0x17f869(0x16b)],'clientip':_0x46f72d},secure[_0x17f869(0x204)]+_0x21c86f,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3e4292=>{const _0x51bf20=_0x348e82;if(_0x3e4292){const _0x18f40f=devices[_0x3e4292]['ip'];return jwt[_0x51bf20(0x249)]({'clientip':_0x18f40f},secure[_0x51bf20(0x204)]+_0x3e4292,{'expiresIn':devices[_0x3e4292][_0x51bf20(0x1c3)][_0x51bf20(0xae)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x49b33f=>{const _0x57ae81=_0x348e82;let _0x54dec2=![];return devices[_0x49b33f][_0x57ae81(0x1c3)]&&devices[_0x49b33f][_0x57ae81(0x1c3)][_0x57ae81(0xae)]!=_0x57ae81(0x146)&&(_0x54dec2=devices[_0x49b33f][_0x57ae81(0x1c3)]['clientip']==devices[_0x49b33f]['ip']&&new Date()[_0x57ae81(0x273)]()-devices[_0x49b33f][_0x57ae81(0x1c3)][_0x57ae81(0x176)]<devices[_0x49b33f]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x54dec2;},telegram2FaApproved=_0x1811e1=>{const _0x5c495e=_0x348e82;let _0x44d898=![];return devices[_0x1811e1]['telegram2FaApproval']&&devices[_0x1811e1][_0x5c495e(0x22a)][_0x5c495e(0xae)]!=_0x5c495e(0x146)&&(_0x44d898=devices[_0x1811e1][_0x5c495e(0x22a)]['clientip']==devices[_0x1811e1]['ip']&&new Date()[_0x5c495e(0x273)]()-devices[_0x1811e1]['telegram2FaApproval']['timestamp']<devices[_0x1811e1][_0x5c495e(0x22a)][_0x5c495e(0xae)]*0x3c*0x3e8),_0x44d898;},normalizeIP=_0x4534e5=>{const _0xfff62c=_0x348e82;let _0x3ab183=null,_0x3fcfbb=null;if(ipaddr['isValid'](_0x4534e5)){const _0x5f125e=ipaddr[_0xfff62c(0x21d)](_0x4534e5);_0x5f125e[_0xfff62c(0x1ea)]()===_0xfff62c(0x1de)?(_0x5f125e[_0xfff62c(0xa7)]()&&(_0x3ab183=_0x5f125e[_0xfff62c(0x17f)]()[_0xfff62c(0x1ec)]()),_0x3fcfbb=_0x5f125e[_0xfff62c(0x1ec)]()):(_0x3ab183=_0x5f125e['toString'](),_0x3fcfbb=_0x5f125e['toIPv4MappedAddress']()[_0xfff62c(0x1ec)]());}return{'show':_0x3ab183?_0x3ab183:_0x3fcfbb,'store':_0x3fcfbb};};function formatDate(_0x44de72){const _0x3b8395=_0x348e82;return _0x44de72[_0x3b8395(0x210)]()+'/'+(_0x44de72[_0x3b8395(0xa8)]()+0x1)[_0x3b8395(0x1ec)]()[_0x3b8395(0x1fa)](0x2,'0')+'/'+_0x44de72['getDate']()[_0x3b8395(0x1ec)]()[_0x3b8395(0x1fa)](0x2,'0')+'\x20'+_0x44de72[_0x3b8395(0xe3)]()[_0x3b8395(0x1ec)]()[_0x3b8395(0x1fa)](0x2,'0')+':'+_0x44de72[_0x3b8395(0xdf)]()[_0x3b8395(0x1ec)]()[_0x3b8395(0x1fa)](0x2,'0')+':'+_0x44de72['getSeconds']()['toString']()['padStart'](0x2,'0');}function sleep(_0xb2a229){return new Promise(_0x408fa1=>setTimeout(_0x408fa1,_0xb2a229));}