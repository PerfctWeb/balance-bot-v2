const _0x1b21eb=_0x24eb;(function(_0x13d0de,_0x18ee8d){const _0xeccc81=_0x24eb,_0x44d625=_0x13d0de();while(!![]){try{const _0x2f6867=-parseInt(_0xeccc81(0x1dc))/0x1+-parseInt(_0xeccc81(0x199))/0x2*(parseInt(_0xeccc81(0x1f3))/0x3)+-parseInt(_0xeccc81(0x1df))/0x4*(parseInt(_0xeccc81(0x153))/0x5)+parseInt(_0xeccc81(0x181))/0x6+-parseInt(_0xeccc81(0x1d6))/0x7+parseInt(_0xeccc81(0xeb))/0x8+-parseInt(_0xeccc81(0x159))/0x9*(-parseInt(_0xeccc81(0x1ff))/0xa);if(_0x2f6867===_0x18ee8d)break;else _0x44d625['push'](_0x44d625['shift']());}catch(_0x4d7c45){_0x44d625['push'](_0x44d625['shift']());}}}(_0x4a48,0x2e2d7));function _0x4a48(){const _0x42a98c=['45934WpQjRG','cancel-loading','jsonwebtoken','Password\x20reset\x20rejected','generateKeyPairAsync','onText','73442fWAzmQ','temporaryAccessAllowed','</b>\x20?','4LANeXW','match','\x20|\x20','settings','event','version','store-configuration','/on\x20-\x20start\x20bot(s)\x0a','default','starting\x20bot\x20|\x20Bot\x20','pidExpireLogin','secure','starting\x20new\x20bot\x20|\x20Bot\x20','get-portfolio','build2','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','storeHeadless','publicKey','name','password','3MfwOyE','length','stop','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','telegramUsername','\x20>\x20','lowdb','getFullYear','sockets','2FA','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','286510vecKwm','bots','/help\x20-\x20show\x20available\x20commands\x0a','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20update\x20settings','new','started','lowdb/adapters/FileSync','all','Notifications\x20disabled\x0a','get-logs','polling_error','chat','reject','function','initclient','SIGTERM','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','HTML','telegram2FaApproval','login','whitelist','isDirectory','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20update\x20bot','showname','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','randomFillSync','getMinutes','UA-192771731-1','/status\x20-\x20show\x20bot(s)\x20status\x0a','telegramEnabled','show','https://hodlerhacks.com','express','existsSync','log','search','forEach','Login\x20accepted','\x20/\x20','3000','Invalid\x20authentication\x20token\x20(1)','getStartingBalances','crypto','/:bot/configuration','storeConfiguration','stopPolling','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','mkdirSync','sign','login\x20required','token','toIPv4Address','verify','5\x20min','-results.json','Temporary\x20access\x20rejected','timestamp','2026024dFGiNg','idling\x20bot\x20\x20\x20|\x20Bot\x20','running','bb-secure.json','fork','kind','node-telegram-bot-api','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','conn','/:bot/performance','disconnect','User\x20has\x20been\x20validated','bot.js','index.html','Balance\x20Bot','toString','allow','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','connected','headers','bot','write','new-disabled','version.json','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','auth','build','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','readdirSync','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','sha256','404\x20Not\x20Found','join','catch','botmanager','emitHistory','slice','exit','keys','invalid\x20credentials','\x20minutes','Ok,\x20will\x20send\x20order\x20notifications\x20only','timeshift','clientip','server','Invalid\x20Telegram\x20token','apply','path','port','unlinkSync','cloneDeep','inherit','Login\x20rejected','loginRequired','Ok,\x20will\x20send\x20alert\x20notifications\x20only','success','orders','2FA\x20login\x20token\x20generated','message','getHours','Allow\x20login\x20from\x20IP\x20address\x20<b>','Password\x20has\x20been\x20reset\x20to:\x20','telegramToken','logout','static','value','sendFile','/enable\x20-\x20enable\x20notifications\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getUTCHours','logged\x20out','/:bot','Unauthorized\x20attempt\x20to\x20store\x20configuration','connection','login\x20not\x20required','getMonth','reload','Unauthorized\x20attempt\x20to\x20log\x20out','No\x20bots\x20running\x20right\x20now','then','privateKey','************','bbUsername','whitelistEnabled','bbPassword','user','padStart','store','telegram','removeAllListeners','store-settings','-config.json','Unauthorized\x20attempt\x20to\x20add\x20bot','Notifications\x20enabled','use','username','telegramIpApproval','enabled','toIPv4MappedAddress','push','getTime','15\x20min','<b>Balance\x20Bot\x20status:</b>\x0a','863965CtDpkI','referer','answerCallbackQuery','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','disabled','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','27euDzZW','/:bot/portfolio','send','yes','analytics','temporary\x20access\x20timeout','live','getPortfolio','access','set','telegramEvents','callback_query','Balance\x20Bot\x20Server','decrypt','hybrid-crypto-js','2FA\x20login\x20rejected','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','pidRefreshToken','find','Unauthorized\x20attempt\x20to\x20get\x20logs','settings.','defaults','stopped','/restart\x20-\x20restart\x20bot(s)\x0a','Notifications\x20types:\x20','emit','hasOwnProperty','::1','login\x20token\x20valid','enabled\x20Bot\x20','access\x20timeout','Crypt',':\x20Bot\x20Mgr\x20>\x20','place-order','child_process','config/','All\x20bots\x20running\x20right\x20now','sortBy','map','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','1198134LUrsOy','createServer','bot-','login\x20token\x20generated','Notifications\x20disabled','get-starting-balances','bcryptjs','alerts','NTBA_FIX_319','kill','remove','compareSync','2FA\x20required','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','-performance.json','secret','f2aRequired','2FA\x20login\x20required','SIGINT','args','getDate','remoteAddress','127.0.0.1','bb-settings.json','193910gNYBYE','add','@analytics/google-analytics','-----------------------------------------------------------------------------------','Bot\x20','includes','temporary\x20access\x20not\x20allowed','blacklist','cancelLoading','Orders','botID','type','ipc','reason','get','uuid','isValid','expiry','disabled\x20Bot\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','error','bb-config.json','telegramChatId','exp','Invalid\x20IP\x20address','handshake','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','No\x20authentication\x20token','data','(((.+)+)+)+$','filter','temporary\x20access\x20rejected','http','restart','parse','hex','split','page','argv','status','\x20only\x0a','/off\x20-\x20stop\x20bot(s)\x0a','backup/','All\x20bots','botname','restarting\x20Bot\x20','reset-password','test','temporary\x20token\x20generated','ipaddr.js','error\x20while\x20deleting\x20config\x20files:\x20','1000','Unauthorized\x20login\x20attempt\x20(public\x20key)','::ffff:127.0.0.1','bb/','removeListener','assign','sendMessage','RSA'];_0x4a48=function(){return _0x42a98c;};return _0x4a48();}const _0x36f16e=function(){let _0x38ecfd=!![];return function(_0x2b6871,_0x2ce4a9){const _0x40d895=_0x38ecfd?function(){const _0x381aad=_0x24eb;if(_0x2ce4a9){const _0x306199=_0x2ce4a9[_0x381aad(0x11a)](_0x2b6871,arguments);return _0x2ce4a9=null,_0x306199;}}:function(){};return _0x38ecfd=![],_0x40d895;};}(),_0x6990cf=_0x36f16e(this,function(){const _0x10c670=_0x24eb;return _0x6990cf[_0x10c670(0xfa)]()[_0x10c670(0x224)](_0x10c670(0x1b8))[_0x10c670(0xfa)]()['constructor'](_0x6990cf)['search']('(((.+)+)+)+$');});_0x6990cf();'use strict';process['env'][_0x1b21eb(0x189)]=0x1;const childProcess=require(_0x1b21eb(0x17b)),FileSync=require(_0x1b21eb(0x206)),fs=require('fs'),fns=require('date-fns'),low=require(_0x1b21eb(0x1f9)),path=require(_0x1b21eb(0x11b)),crypto=require(_0x1b21eb(0xdc)),Crypt=require(_0x1b21eb(0x167))[_0x1b21eb(0x178)],RSA=require(_0x1b21eb(0x167))[_0x1b21eb(0x1d5)],bcrypt=require(_0x1b21eb(0x187)),jwt=require(_0x1b21eb(0x1d8)),analyticsLib=require(_0x1b21eb(0x15d))[_0x1b21eb(0x1e7)],googleAnalytics=require(_0x1b21eb(0x19b))[_0x1b21eb(0x1e7)],ipaddr=require(_0x1b21eb(0x1cc)),argv=require('yargs/yargs')(process[_0x1b21eb(0x1c1)][_0x1b21eb(0x110)](0x2))[_0x1b21eb(0x1c1)],PORT=argv[_0x1b21eb(0x11c)]||_0x1b21eb(0xd9),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x1b21eb(0x1ca)](PORT))return console['log']('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1);const HOST=argv['host']||null,userID=argv[_0x1b21eb(0x141)]||'';let bbpath=_0x1b21eb(0x1d1),bbpath2='';const botfile=_0x1b21eb(0xf7),configfile=_0x1b21eb(0x1ae),settingsfile=_0x1b21eb(0x198),securefile=_0x1b21eb(0xee);!fs[_0x1b21eb(0x222)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x1b21eb(0x17c),configbackuppath=configpath+_0x1b21eb(0x1c5);!fs[_0x1b21eb(0x222)](configpath)&&fs[_0x1b21eb(0xe1)](configpath);!fs[_0x1b21eb(0x222)](configbackuppath)&&fs[_0x1b21eb(0xe1)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1b21eb(0x16e)]({'bots':[]})[_0x1b21eb(0x100)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1b21eb(0x16e)]({'settings':{'timeshift':0x0}})[_0x1b21eb(0x100)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1b21eb(0x16e)]({'secure':{},'blacklist':[]})[_0x1b21eb(0x100)]();let crypt=new Crypt({'md':_0x1b21eb(0x10a),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1b21eb(0x102))[_0x1b21eb(0x1e4)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x1b21eb(0x221)),app=express(),http=require(_0x1b21eb(0x1bb))[_0x1b21eb(0x182)](app);app[_0x1b21eb(0x14a)](express[_0x1b21eb(0x12c)](path['join'](__dirname,bbpath2,_0x1b21eb(0x1ed)))),app[_0x1b21eb(0x14a)](express[_0x1b21eb(0x12c)](path[_0x1b21eb(0x10c)](__dirname,bbpath2,_0x1b21eb(0x105)))),app[_0x1b21eb(0x1a7)]('/',function(_0x38e5fe,_0x10d639){const _0x369658=_0x1b21eb;_0x10d639[_0x369658(0x12e)](path[_0x369658(0x10c)](__dirname,bbpath2,_0x369658(0x1ed),'index.html'));}),app['get'](_0x1b21eb(0x133),function(_0x1be107,_0xbab64e){const _0x251d5e=_0x1b21eb;_0xbab64e[_0x251d5e(0x12e)](path[_0x251d5e(0x10c)](__dirname,bbpath2,_0x251d5e(0x105),_0x251d5e(0xf8)));}),app[_0x1b21eb(0x1a7)](_0x1b21eb(0x15a),(_0x48bd6f,_0x5225eb)=>{const _0x1b0fd3=_0x1b21eb;_0x5225eb[_0x1b0fd3(0x12e)](path[_0x1b0fd3(0x10c)](__dirname,bbpath2,_0x1b0fd3(0x105),'index.html'));}),app[_0x1b21eb(0x1a7)](_0x1b21eb(0xf4),(_0x7c6a5,_0x2bf620)=>{const _0x8128bb=_0x1b21eb;_0x2bf620['sendFile'](path[_0x8128bb(0x10c)](__dirname,bbpath2,_0x8128bb(0x105),'index.html'));}),app['get']('/:bot/coins',(_0x258b2d,_0x344e88)=>{const _0x19b772=_0x1b21eb;_0x344e88[_0x19b772(0x12e)](path[_0x19b772(0x10c)](__dirname,bbpath2,_0x19b772(0x105),_0x19b772(0xf8)));}),app['get']('/:bot/history',(_0x314f4c,_0x4537bd)=>{const _0x571516=_0x1b21eb;_0x4537bd[_0x571516(0x12e)](path[_0x571516(0x10c)](__dirname,bbpath2,'build',_0x571516(0xf8)));}),app['get'](_0x1b21eb(0xdd),(_0x2a056b,_0x58f0e4)=>{const _0x116310=_0x1b21eb;_0x58f0e4[_0x116310(0x12e)](path['join'](__dirname,bbpath2,_0x116310(0x105),_0x116310(0xf8)));}),app[_0x1b21eb(0x1a7)]('/:bot/support',(_0x33b562,_0x5cb8d0)=>{const _0x4a6df6=_0x1b21eb;_0x5cb8d0[_0x4a6df6(0x12e)](path[_0x4a6df6(0x10c)](__dirname,bbpath2,_0x4a6df6(0x105),_0x4a6df6(0xf8)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x1b21eb(0xf9),'plugins':[googleAnalytics({'trackingId':_0x1b21eb(0x21c)})]}),TelegramBot=require(_0x1b21eb(0xf1));let tgBot;if(settings[_0x1b21eb(0x12a)]&&settings[_0x1b21eb(0x12a)]!=''&&settings[_0x1b21eb(0x1f7)]&&settings[_0x1b21eb(0x1f7)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x3c1e18=_0x1b21eb;console['log'](''),console['log']('-----------------------------------------------------------------------------------'),logging(_0x3c1e18(0x210)+PORT),console[_0x3c1e18(0x223)](_0x3c1e18(0x19c));if(config[_0x3c1e18(0x1f4)]!=0x0)config[_0x3c1e18(0xd6)](_0x21456b=>{const _0x1c7234=_0x3c1e18;if(_0x21456b[_0x1c7234(0x1c2)]=='enabled'||_0x21456b['status']=='new')logging(_0x1c7234(0x1e8)+_0x21456b[_0x1c7234(0x1a3)]+'\x20|\x20'+_0x21456b['botname']),startBot([_0x21456b[_0x1c7234(0x1a3)],userID],{'cwd':bbpath},function(_0x3d94db){if(_0x3d94db)logging(_0x3d94db);});else(_0x21456b['status']=='disabled'||_0x21456b[_0x1c7234(0x1c2)]==_0x1c7234(0x101))&&logging(_0x1c7234(0xec)+_0x21456b[_0x1c7234(0x1a3)]+_0x1c7234(0x1e1)+_0x21456b[_0x1c7234(0x1c7)]);});else!newBot&&console['log'](_0x3c1e18(0x130));if(newBot)addBot();console[_0x3c1e18(0x223)](_0x3c1e18(0x19c)),console[_0x3c1e18(0x223)]('');}function startSocket(){const _0x573530=_0x1b21eb;io['on'](_0x573530(0x135),_0x57c00a=>{const _0x425c97=_0x573530;let _0x1b488e,_0x3cba38,_0x5a691e,_0x14076b,_0x836649;const _0x20f1a0=_0x57c00a['handshake'][_0x425c97(0xfe)][_0x425c97(0x154)];_0x3cba38=_0x20f1a0[_0x425c97(0x1e0)](/bot[0-9]{3}/);if(_0x3cba38)_0x5a691e=_0x3cba38[0x0][_0x425c97(0x1e0)](/[0-9]{3}/);if(_0x5a691e)_0x1b488e=_0x5a691e[0x0];else _0x1b488e='botmanager';const _0x51e2d9=_0x57c00a[_0x425c97(0x1b2)][_0x425c97(0x104)]['encryptedUuid'];if(!_0x51e2d9)_0x57c00a[_0x425c97(0x172)]('status',{'publicKey':secure['publicKey']});else{_0x14076b=timelyDecrypt(_0x51e2d9,![]);if(!_0x14076b)logging(_0x425c97(0x1cf));else{_0x836649=normalizeIP(_0x57c00a[_0x425c97(0xf3)][_0x425c97(0x196)])[_0x425c97(0x143)];if(!devices[_0x14076b])devices[_0x14076b]={'uuid':_0x14076b,'access':{'token':null}};devices[_0x14076b]['ip']=_0x836649;const _0x502600=addClient(_0x57c00a['id'],_0x14076b,_0x1b488e);setAccess(_0x502600),_0x57c00a['on']('login',_0x1c4027=>{const _0x29a8c2=_0x425c97,_0x3115d7=timelyDecrypt(_0x1c4027[_0x29a8c2(0x1f2)]);if(_0x3115d7){_0x1c4027={'username':_0x1c4027[_0x29a8c2(0x14b)],'password':_0x3115d7},devices[_0x14076b][_0x29a8c2(0x161)]=validateCredentials(_0x1c4027,_0x14076b);if(devices[_0x14076b][_0x29a8c2(0x161)]['allow']==![]&&devices[_0x14076b][_0x29a8c2(0x161)]['reason']==_0x29a8c2(0x192))_0x57c00a[_0x29a8c2(0x172)](_0x29a8c2(0x1c2),{'access':devices[_0x14076b][_0x29a8c2(0x161)]}),loginAccess2FA(_0x14076b,_0x836649);else{if(devices[_0x14076b][_0x29a8c2(0x161)]['allow']==![]&&devices[_0x14076b][_0x29a8c2(0x161)][_0x29a8c2(0x1a6)]==_0x29a8c2(0x113))_0x57c00a[_0x29a8c2(0x172)](_0x29a8c2(0x1c2),{'access':devices[_0x14076b]['access']});else devices[_0x14076b][_0x29a8c2(0x161)][_0x29a8c2(0xfb)]&&devices[_0x14076b][_0x29a8c2(0x161)][_0x29a8c2(0x1a6)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x14076b)['forEach'](_0x250172=>{setAccess(_0x250172);}),setTokenRefresh(_0x14076b),setSessionTimeout('login',_0x14076b));}}else logging(_0x29a8c2(0x216));}),_0x57c00a['on'](_0x425c97(0x1c9),()=>{resetPassword();}),_0x57c00a['on']('disconnect',_0x5419ca=>{removeClient(_0x57c00a['id']);});}}});}function initClient(_0x43ee59){const _0x4b7f0c=_0x1b21eb;if(_0x43ee59!=_0x4b7f0c(0x10e)&&config['apiKey']!=''){if(pid[_0x43ee59])pid[_0x43ee59][_0x4b7f0c(0x15b)]({'function':_0x4b7f0c(0x20e),'args':null});}}function getSocket(_0xa2144d){const _0xbe97d0=_0x1b21eb;return io['sockets'][_0xbe97d0(0x1fb)][_0xbe97d0(0x1a7)](_0xa2144d);}function setAccess(_0x24acd5){const _0x4ec0b7=_0x1b21eb,_0x19a7be=getSocket(_0x24acd5['id']),_0x16acdb=_0x24acd5[_0x4ec0b7(0x1a8)],_0x12d0bb=_0x24acd5[_0x4ec0b7(0xff)];devices[_0x16acdb][_0x4ec0b7(0x161)]=validateAccess(devices[_0x16acdb][_0x4ec0b7(0x161)]['token'],_0x16acdb),_0x19a7be[_0x4ec0b7(0x10c)](_0x16acdb);if(devices[_0x16acdb]['access'][_0x4ec0b7(0xfb)]){_0x19a7be['join'](_0x12d0bb);if(_0x12d0bb==_0x4ec0b7(0x10e))initializeSocketBotManager(_0x19a7be);else initializeSocketBot(_0x19a7be);initClient(_0x12d0bb);}devices[_0x16acdb][_0x4ec0b7(0x161)][_0x4ec0b7(0xe4)]&&devices[_0x16acdb][_0x4ec0b7(0x161)][_0x4ec0b7(0x1a6)]==_0x4ec0b7(0x1cb)&&setSessionTimeout(_0x4ec0b7(0x1fc),_0x16acdb),devices[_0x16acdb][_0x4ec0b7(0x161)][_0x4ec0b7(0xe4)]&&devices[_0x16acdb]['access']['reason']==_0x4ec0b7(0x125)&&setSessionTimeout(_0x4ec0b7(0x213),_0x16acdb),_0x19a7be[_0x4ec0b7(0x172)](_0x4ec0b7(0x1c2),{'status':_0x24acd5[_0x4ec0b7(0x118)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x16acdb][_0x4ec0b7(0x161)],'externalip':devices[_0x16acdb]['ip'],'publicKey':secure['publicKey']}),devices[_0x16acdb][_0x4ec0b7(0x161)][_0x4ec0b7(0xfb)]==![]&&devices[_0x16acdb][_0x4ec0b7(0x161)][_0x4ec0b7(0x1a6)]==_0x4ec0b7(0x18d)&&temporaryAccess2FA(_0x16acdb,devices[_0x16acdb]['ip']);}function setSessionTimeout(_0xcc4b0a,_0x47f4f8){const _0x1451c8=_0x1b21eb;let _0x3435ac;if(_0xcc4b0a==_0x1451c8(0x213))_0x3435ac=loginExpiry*0x3c*0x3e8;else _0x3435ac=devices[_0x47f4f8][_0x1451c8(0x14c)][_0x1451c8(0x1aa)]*0x3c*0x3e8-(new Date()[_0x1451c8(0x150)]()-devices[_0x47f4f8][_0x1451c8(0x14c)][_0x1451c8(0xea)]);if(devices[_0x47f4f8][_0x1451c8(0x1e9)])clearTimeout(devices[_0x47f4f8]['pidExpireLogin']);devices[_0x47f4f8][_0x1451c8(0x1e9)]=setTimeout(()=>{const _0x534611=_0x1451c8;if(devices[_0x47f4f8][_0x534611(0x16a)])clearTimeout(devices[_0x47f4f8][_0x534611(0x16a)]);removeSocketListeners(_0x47f4f8),addBlacklist(_0x47f4f8),devices[_0x47f4f8]['telegramIpApproval']=null,devices[_0x47f4f8][_0x534611(0x212)]=null,devices[_0x47f4f8][_0x534611(0x161)][_0x534611(0xe4)]=null,devices[_0x47f4f8][_0x534611(0x161)]=validateAccess(devices[_0x47f4f8][_0x534611(0x161)][_0x534611(0xe4)],_0x47f4f8),!(devices[_0x47f4f8][_0x534611(0x161)]['allow']&&devices[_0x47f4f8]['access']['reason']==_0x534611(0x136))&&(_0xcc4b0a==_0x534611(0x213)?io['to'](_0x47f4f8)[_0x534611(0x172)]('status',{'access':{'allow':![],'reason':_0x534611(0x177),'token':null}}):io['to'](_0x47f4f8)['emit']('status',{'access':{'allow':![],'reason':_0x534611(0x15e),'token':null}})),devices[_0x47f4f8]['access'][_0x534611(0xe4)]=null;},_0x3435ac);}function setTokenRefresh(_0x5ef636){const _0xf20790=_0x1b21eb;if(devices[_0x5ef636][_0xf20790(0x16a)])clearTimeout(devices[_0x5ef636]['pidRefreshToken']);devices[_0x5ef636][_0xf20790(0x16a)]=setTimeout(()=>{const _0x38a09a=_0xf20790;getClientsWithUuid(_0x5ef636)[_0x38a09a(0x1f4)]!=0x0?(devices[_0x5ef636]['access']=refreshToken(_0x5ef636),io['to'](_0x5ef636)['emit'](_0x38a09a(0x1c2),{'status':_0x38a09a(0xfd),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5ef636][_0x38a09a(0x161)],'externalip':devices[_0x5ef636]['ip'],'publicKey':secure[_0x38a09a(0x1f0)]}),setTokenRefresh(_0x5ef636)):clearTimeout(devices[_0x5ef636][_0x38a09a(0x16a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5e7b8e){const _0x38ef91=_0x1b21eb,_0x29537b=getClient(_0x5e7b8e['id'])[_0x38ef91(0x1a8)];_0x5e7b8e[_0x38ef91(0x172)]('bots',config),_0x5e7b8e['emit']('settings',cleanSettings()),_0x5e7b8e['on']('add-bot',_0x38a291=>{const _0x5c8368=_0x38ef91;if(validateAccess(_0x38a291,_0x29537b)[_0x5c8368(0xfb)])addBot();else logging(_0x5c8368(0x148));}),_0x5e7b8e['on']('update-bot',(_0x5a7622,_0x466947)=>{const _0x529c65=_0x38ef91;if(validateAccess(_0x466947,_0x29537b)['allow'])toggleBot(_0x5a7622['botID'],_0x5a7622[_0x529c65(0x1c2)],_0x5a7622[_0x529c65(0x15f)]);else logging(_0x529c65(0x217));}),_0x5e7b8e['on']('delete-bot',(_0x354f18,_0x591fc8)=>{const _0x1e8ad3=_0x38ef91;if(validateAccess(_0x591fc8,_0x29537b)[_0x1e8ad3(0xfb)])deleteBot(_0x354f18);else logging(_0x1e8ad3(0x1b5));}),_0x5e7b8e['on'](_0x38ef91(0x146),(_0x44a2b5,_0x346477)=>{if(validateAccess(_0x346477,_0x29537b)['allow'])storeSettings(_0x44a2b5,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x5e7b8e['on']('update-bb',(_0x747d10,_0x31e049)=>{const _0x279817=_0x38ef91;if(validateAccess(_0x31e049,_0x29537b)[_0x279817(0xfb)])updateBB();else logging(_0x279817(0x203));}),_0x5e7b8e['on'](_0x38ef91(0x12b),_0x3f129e=>{const _0x7ce63=_0x38ef91;if(validateAccess(_0x3f129e,_0x29537b)[_0x7ce63(0xfb)]){if(devices[_0x29537b][_0x7ce63(0x16a)])clearTimeout(devices[_0x29537b][_0x7ce63(0x16a)]);if(devices[_0x29537b]['pidExpireLogin'])clearTimeout(devices[_0x29537b][_0x7ce63(0x1e9)]);removeSocketListeners(getClient(_0x5e7b8e['id'])['uuid']),addBlacklist(_0x29537b),devices[_0x29537b][_0x7ce63(0x14c)]=null,devices[_0x29537b][_0x7ce63(0x212)]=null,devices[_0x29537b][_0x7ce63(0x161)]['token']=null,io['to'](getClient(_0x5e7b8e['id'])[_0x7ce63(0x1a8)])[_0x7ce63(0x172)](_0x7ce63(0x1c2),{'access':{'allow':![],'reason':_0x7ce63(0x132),'token':null}});}else logging(_0x7ce63(0x139));});}function initializeSocketBot(_0x131cd0){const _0x54a5b5=_0x1b21eb,_0x227f1f=getClient(_0x131cd0['id'])[_0x54a5b5(0xff)],_0x471592=getClient(_0x131cd0['id'])[_0x54a5b5(0x1a8)];_0x131cd0['on'](_0x54a5b5(0x209),(_0x4c2736,_0x19a881)=>{const _0x58e3ff=_0x54a5b5;if(validateAccess(_0x19a881,_0x471592)['allow']){if(pid[_0x227f1f])pid[_0x227f1f][_0x58e3ff(0x15b)]({'function':_0x58e3ff(0x10f),'args':_0x4c2736});}else logging(_0x58e3ff(0x16c));}),_0x131cd0['on'](_0x54a5b5(0x1ec),(_0x574d39,_0x161080)=>{const _0x184080=_0x54a5b5;if(validateAccess(_0x161080,_0x471592)[_0x184080(0xfb)]){if(pid[_0x227f1f])pid[_0x227f1f][_0x184080(0x15b)]({'function':_0x184080(0x160),'args':_0x574d39});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x131cd0['on'](_0x54a5b5(0x1e5),(_0x1a3f10,_0x1877e1)=>{const _0x14a502=_0x54a5b5;if(validateAccess(_0x1877e1,_0x471592)[_0x14a502(0xfb)]){if(pid[_0x227f1f])pid[_0x227f1f][_0x14a502(0x15b)]({'function':_0x14a502(0xde),'args':_0x1a3f10});}else logging(_0x14a502(0x134));}),_0x131cd0['on']('store-headless',(_0x325c96,_0x31535d)=>{const _0x22c798=_0x54a5b5;if(validateAccess(_0x31535d,_0x471592)[_0x22c798(0xfb)]){if(pid[_0x227f1f])pid[_0x227f1f][_0x22c798(0x15b)]({'function':_0x22c798(0x1ef),'args':_0x325c96});}else logging(_0x22c798(0x18e));}),_0x131cd0['on'](_0x54a5b5(0x186),_0x2fa42b=>{const _0x2eb596=_0x54a5b5;if(validateAccess(_0x2fa42b,_0x471592)[_0x2eb596(0xfb)]){if(pid[_0x227f1f])pid[_0x227f1f][_0x2eb596(0x15b)]({'function':_0x2eb596(0xdb),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x131cd0['on'](_0x54a5b5(0x17a),(_0x8cd8cd,_0x403a1e)=>{const _0x3f1ad1=_0x54a5b5;if(validateAccess(_0x403a1e,_0x471592)[_0x3f1ad1(0xfb)]){if(pid[_0x227f1f])pid[_0x227f1f][_0x3f1ad1(0x15b)]({'function':'placeOrder','args':_0x8cd8cd});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x131cd0['on'](_0x54a5b5(0x1d7),_0x5b04b1=>{const _0xe83d0f=_0x54a5b5;if(validateAccess(_0x5b04b1,_0x471592)[_0xe83d0f(0xfb)]){if(pid[_0x227f1f])pid[_0x227f1f][_0xe83d0f(0x15b)]({'function':_0xe83d0f(0x1a1),'args':null});}else logging(_0xe83d0f(0x106));}),_0x131cd0['on'](_0x54a5b5(0x12b),_0x2e2664=>{const _0x198102=_0x54a5b5;if(validateAccess(_0x2e2664,_0x471592)['allow']){if(devices[_0x471592][_0x198102(0x16a)])clearTimeout(devices[_0x471592]['pidRefreshToken']);if(devices[_0x471592][_0x198102(0x1e9)])clearTimeout(devices[_0x471592][_0x198102(0x1e9)]);removeSocketListeners(getClient(_0x131cd0['id'])[_0x198102(0x1a8)]),addBlacklist(_0x471592),devices[_0x471592][_0x198102(0x14c)]=null,devices[_0x471592][_0x198102(0x212)]=null,devices[_0x471592][_0x198102(0x161)][_0x198102(0xe4)]=null,io['to'](getClient(_0x131cd0['id'])['uuid'])[_0x198102(0x172)]('status',{'access':{'allow':![],'reason':_0x198102(0x132),'token':null}});}else logging(_0x198102(0x139));});}function removeSocketListeners(_0xec4de8){const _0x109d7e=_0x1b21eb;getClientsWithUuid(_0xec4de8)[_0x109d7e(0xd6)](_0x38039f=>{const _0x2b1ec8=_0x109d7e;getSocket(_0x38039f['id'])[_0x2b1ec8(0x145)]();});}function cleanSettings(){const _0x23efda=_0x1b21eb;let _0x4c703d=settings;return settings[_0x23efda(0x12a)]&&settings[_0x23efda(0x12a)]!=''&&(_0x4c703d={..._0x4c703d,'telegramToken':_0x23efda(0x13d)}),settings['bbPassword']&&settings[_0x23efda(0x140)]!=''&&(_0x4c703d={..._0x4c703d,'bbPassword':'************'}),_0x4c703d;}function updateBB(){const _0x2532a9=_0x1b21eb;process[_0x2532a9(0x15b)]({'update':!![]});}function startBot(_0x2ed04f,_0x2d6a51,_0x155b8e){const _0x45cc3c=_0x1b21eb;let _0xc86bca=![];const _0x45c4c0=_0x2ed04f[0x0];_0x2d6a51={..._0x2d6a51,'stdio':[_0x45cc3c(0x11f),'inherit','inherit',_0x45cc3c(0x1a5)]},pid[_0x45c4c0]=childProcess[_0x45cc3c(0xef)](botfile,_0x2ed04f,_0x2d6a51),pid[_0x45c4c0]['on'](_0x45cc3c(0x126),_0x513091=>{const _0x23e7d3=_0x45cc3c;switch(Object[_0x23e7d3(0x112)](_0x513091)[0x0]){case'botname':updateBotName(_0x45c4c0,_0x513091[_0x23e7d3(0x1c7)]);break;case _0x23e7d3(0x1c2):updateStatus(_0x45c4c0,_0x513091[_0x23e7d3(0x1c2)]);break;case _0x23e7d3(0x15f):updateLive(_0x45c4c0,_0x513091[_0x23e7d3(0x15f)]);break;case _0x23e7d3(0x205):updateLive(_0x45c4c0,_0x513091[_0x23e7d3(0x205)]),io['to'](_0x45c4c0)[_0x23e7d3(0x172)](_0x23e7d3(0x1c2),{'access':{'allow':![],'reason':_0x23e7d3(0x138),'token':null}});break;case _0x23e7d3(0x1f5):_0x513091['stop']==_0x23e7d3(0x1bc)&&stopBot(_0x45c4c0);_0x513091[_0x23e7d3(0x1f5)]==_0x23e7d3(0x18a)&&toggleBot(_0x45c4c0,_0x23e7d3(0x157),_0x23e7d3(0x16f));break;case _0x23e7d3(0x144):sendTelegram(_0x45c4c0,_0x513091['telegram']);break;case _0x23e7d3(0x20d):io['to'](_0x45c4c0)[_0x23e7d3(0x172)](_0x513091[_0x23e7d3(0x20d)],_0x513091[_0x23e7d3(0x194)]);break;}}),pid[_0x45c4c0]['on'](_0x45cc3c(0x1ad),function(_0x43c114){if(_0xc86bca)return;_0xc86bca=!![],_0x155b8e(_0x43c114);}),pid[_0x45c4c0]['on']('exit',function(_0x4f57d4){const _0x1e38ae=_0x45cc3c;if(_0xc86bca)return;_0xc86bca=!![],_0x155b8e(null);const _0xd3fdec=dbConfig[_0x1e38ae(0x1a7)]('bots')['find']({'botID':_0x45c4c0})['value']();_0xd3fdec&&(_0xd3fdec[_0x1e38ae(0x1c2)]==_0x1e38ae(0x14d)||_0xd3fdec['status']=='new')&&(updateLive(_0x45c4c0,_0x1e38ae(0x16f)),logging(_0x1e38ae(0x1c8)+_0x45c4c0),startBot([_0x45c4c0,userID],{'cwd':bbpath},function(_0x144306){if(_0x144306)logging(_0x144306);}));});}function stopBot(_0x456aab){const _0x3e911c=_0x1b21eb;getClientsWithBotID(_0x456aab)[_0x3e911c(0xd6)](_0x4686ba=>{const _0x5a5dfa=_0x3e911c;getSocket(_0x4686ba['id'])[_0x5a5dfa(0xf5)](!![]),removeClient(_0x4686ba['id']);});if(pid[_0x456aab])pid[_0x456aab]['kill']();}function addBot(){const _0x2cfb8f=_0x1b21eb;let _0x53af9a;for(let _0x44fae7=0x1;_0x44fae7<0x3e9;_0x44fae7++){_0x53af9a=_0x44fae7[_0x2cfb8f(0xfa)]()[_0x2cfb8f(0x142)](0x3,'0');let _0x3ee56a=config[_0x2cfb8f(0x16b)](_0x59d6ad=>_0x59d6ad['botID']==_0x53af9a);if(!_0x3ee56a)break;}if(_0x53af9a===_0x2cfb8f(0x1ce)){logging(_0x2cfb8f(0xfc));return;}logging(_0x2cfb8f(0x1eb)+_0x53af9a),dbConfig[_0x2cfb8f(0x1a7)](_0x2cfb8f(0x200))[_0x2cfb8f(0x14f)]({'botID':_0x53af9a,'botname':_0x2cfb8f(0x19d)+_0x53af9a,'status':_0x2cfb8f(0x204),'live':''})['write'](),startBot([_0x53af9a,userID],{'cwd':bbpath},function(_0x933b9c){if(_0x933b9c)logging(_0x933b9c);}),config=getConfiguration(),io['to'](_0x2cfb8f(0x10e))[_0x2cfb8f(0x172)](_0x2cfb8f(0x200),config);}function deleteBot(_0x298673){const _0x8ddaff=_0x1b21eb;getClientsWithBotID(_0x298673)[_0x8ddaff(0xd6)](_0x35b127=>{const _0x42b239=_0x8ddaff;getSocket(_0x35b127['id'])[_0x42b239(0xf5)](!![]),removeClient(_0x35b127['id']);}),dbConfig['get']('bots')[_0x8ddaff(0x18b)]({'botID':_0x298673})['write'](),logging('deleted\x20Bot\x20'+_0x298673),stopBot(_0x298673);try{fs[_0x8ddaff(0x11d)](path[_0x8ddaff(0x10c)](configpath,_0x8ddaff(0x183)+_0x298673+_0x8ddaff(0x147))),fs[_0x8ddaff(0x11d)](path['join'](configpath,_0x8ddaff(0x183)+_0x298673+'-events.json')),fs[_0x8ddaff(0x11d)](path[_0x8ddaff(0x10c)](configpath,'bot-'+_0x298673+_0x8ddaff(0x18f))),fs[_0x8ddaff(0x11d)](path[_0x8ddaff(0x10c)](configpath,'bot-'+_0x298673+_0x8ddaff(0xe8)));}catch(_0x3e0f0e){if(_0x3e0f0e)logging(_0x8ddaff(0x1cd),_0x3e0f0e);}config=getConfiguration(),io['to'](_0x8ddaff(0x10e))[_0x8ddaff(0x172)]('bots',config);}function toggleBot(_0x51dba8,_0x1a5d3b,_0x4f2cb8){const _0x34024b=_0x1b21eb;dbConfig['get'](_0x34024b(0x200))[_0x34024b(0x16b)]({'botID':_0x51dba8})[_0x34024b(0x1d3)]({'status':_0x1a5d3b})[_0x34024b(0x1d3)]({'live':_0x4f2cb8})['write']();if(_0x1a5d3b==_0x34024b(0x14d)||_0x1a5d3b=='new')logging(_0x34024b(0x176)+_0x51dba8),startBot([_0x51dba8,userID],{'cwd':bbpath},function(_0x356be5){if(_0x356be5)logging(_0x356be5);});else(_0x1a5d3b==_0x34024b(0x157)||_0x1a5d3b=='new-disabled')&&(logging(_0x34024b(0x1ab)+_0x51dba8),stopBot(_0x51dba8));config=getConfiguration(),io['to'](_0x34024b(0x10e))[_0x34024b(0x172)](_0x34024b(0x200),config);}function toggleStatus(_0x3623b8){const _0x5c7018=_0x1b21eb;let _0x1b6e6e=dbConfig[_0x5c7018(0x1a7)](_0x5c7018(0x200))[_0x5c7018(0x16b)]({'botID':_0x3623b8})[_0x5c7018(0x12d)](),_0x27e9f9;if(_0x1b6e6e[_0x5c7018(0x1c2)]===_0x5c7018(0x14d))_0x27e9f9=_0x5c7018(0x157);else{if(_0x1b6e6e['status']===_0x5c7018(0x204))_0x27e9f9='new-disabled';else{if(_0x1b6e6e[_0x5c7018(0x1c2)]==='new-disabled')_0x27e9f9=_0x5c7018(0x204);else{if(_0x1b6e6e[_0x5c7018(0x1c2)]==='disabled')_0x27e9f9='enabled';}}}return _0x27e9f9;}function updateStatus(_0x27b560,_0xe23f80){const _0x282786=_0x1b21eb;dbConfig[_0x282786(0x1a7)](_0x282786(0x200))['find']({'botID':_0x27b560})['assign']({'status':_0xe23f80})[_0x282786(0x100)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x282786(0x200),config);}function updateLive(_0x5bf0d8,_0x7d407a){const _0x152f64=_0x1b21eb;dbConfig[_0x152f64(0x1a7)](_0x152f64(0x200))[_0x152f64(0x16b)]({'botID':_0x5bf0d8})[_0x152f64(0x1d3)]({'live':_0x7d407a})[_0x152f64(0x100)](),config=getConfiguration(),io['to'](_0x152f64(0x10e))['emit'](_0x152f64(0x200),config);}function updateBotName(_0x156dd5,_0x19e7e0){const _0x3731c2=_0x1b21eb;dbConfig[_0x3731c2(0x1a7)](_0x3731c2(0x200))[_0x3731c2(0x16b)]({'botID':_0x156dd5})[_0x3731c2(0x1d3)]({'botname':_0x19e7e0})[_0x3731c2(0x100)](),config=getConfiguration(),io['to'](_0x3731c2(0x10e))['emit']('bots',config);}function telegramError(_0x29f420){console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0xc4b443){const _0x163641=_0x1b21eb;if(_0xc4b443['from']['username']!=settings['telegramUsername']&&'@'+_0xc4b443['from'][_0x163641(0x14b)]!=settings[_0x163641(0x1f7)])return tgBot[_0x163641(0x1d4)](_0xc4b443[_0x163641(0x20b)]['id'],_0x163641(0x1ee),{'parse_mode':_0x163641(0x211)})['catch'](_0x58f1c4=>{telegramError(_0x58f1c4);}),![];return!![];}async function initTelegram(){const _0x16992a=_0x1b21eb;if(tgBot)tgBot[_0x16992a(0xdf)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x16992a(0x12a)],{'polling':!![]});let _0x4f7df9=_0x16992a(0x1fe);_0x4f7df9+='\x0a',_0x4f7df9+=_0x16992a(0x12f),_0x4f7df9+='/disable\x20-\x20disable\x20notifications\x0a',_0x4f7df9+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4f7df9+=_0x16992a(0x170),_0x4f7df9+=_0x16992a(0x1e6),_0x4f7df9+=_0x16992a(0x1c4),_0x4f7df9+=_0x16992a(0x21d),_0x4f7df9+=_0x16992a(0x201);let _0x40d58d=_0x16992a(0x219);_0x40d58d+='\x0a',_0x40d58d+=_0x4f7df9,tgBot[_0x16992a(0x1db)](/\/start/,_0x364d7e=>{const _0x437df5=_0x16992a;if(!validateTelegram(_0x364d7e))return;if(settings[_0x437df5(0x1af)]!=_0x364d7e[_0x437df5(0x20b)]['id'])updateSetting(_0x437df5(0x1af),_0x364d7e[_0x437df5(0x20b)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x364d7e[_0x437df5(0x20b)]['id'],_0x40d58d)['catch'](_0x1d39b3=>{telegramError(_0x1d39b3);});}),tgBot['onText'](/\/enable/,_0x31d82c=>{const _0x2dd24b=_0x16992a;if(!validateTelegram(_0x31d82c))return;if(settings[_0x2dd24b(0x1af)]!=_0x31d82c[_0x2dd24b(0x20b)]['id'])updateSetting(_0x2dd24b(0x1af),_0x31d82c[_0x2dd24b(0x20b)]['id']);updateSetting(_0x2dd24b(0x21e),!![]),tgBot[_0x2dd24b(0x1d4)](_0x31d82c[_0x2dd24b(0x20b)]['id'],_0x2dd24b(0x149))[_0x2dd24b(0x10d)](_0x4b2505=>{telegramError(_0x4b2505);});}),tgBot['onText'](/\/config/,async _0x1a06e4=>{const _0x768ef3=_0x16992a;if(!validateTelegram(_0x1a06e4))return;tgBot['removeListener'](_0x768ef3(0x164)),tgBot[_0x768ef3(0x1d4)](_0x1a06e4[_0x768ef3(0x20b)]['id'],_0x768ef3(0x109),{'reply_markup':{'inline_keyboard':[[{'text':_0x768ef3(0x1a2),'callback_data':_0x768ef3(0x124)},{'text':'Alerts','callback_data':_0x768ef3(0x188)},{'text':'All','callback_data':_0x768ef3(0x207)}]]}})[_0x768ef3(0x10d)](_0x51c1e0=>{telegramError(_0x51c1e0);}),tgBot['on']('callback_query',async _0x37ef63=>{const _0x2f398f=_0x768ef3,_0x315316=_0x37ef63[_0x2f398f(0x1b7)],_0x2ae5b5=_0x37ef63['message'];tgBot[_0x2f398f(0x155)](_0x37ef63['id'])[_0x2f398f(0x13b)](async()=>{const _0x403a68=_0x2f398f;_0x315316==_0x403a68(0x124)&&(updateSetting(_0x403a68(0x163),_0x403a68(0x124)),updateSetting(_0x403a68(0x21e),!![]),await tgBot['sendMessage'](_0x2ae5b5[_0x403a68(0x20b)]['id'],_0x403a68(0x115))[_0x403a68(0x10d)](_0x3046d2=>{telegramError(_0x3046d2);}));_0x315316==_0x403a68(0x188)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x403a68(0x21e),!![]),await tgBot[_0x403a68(0x1d4)](_0x2ae5b5[_0x403a68(0x20b)]['id'],_0x403a68(0x122))['catch'](_0x3f516f=>{telegramError(_0x3f516f);}));_0x315316==_0x403a68(0x207)&&(updateSetting(_0x403a68(0x163),_0x403a68(0x207)),updateSetting(_0x403a68(0x21e),!![]),await tgBot[_0x403a68(0x1d4)](_0x2ae5b5[_0x403a68(0x20b)]['id'],_0x403a68(0x1ac))[_0x403a68(0x10d)](_0x5f10a1=>{telegramError(_0x5f10a1);}));if(!settings[_0x403a68(0x1af)])tgBot['sendMessage'](_0x2ae5b5[_0x403a68(0x20b)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x22447a=>{telegramError(_0x22447a);});}),tgBot[_0x2f398f(0x1d2)](_0x2f398f(0x164));});}),tgBot[_0x16992a(0x1db)](/\/status/,_0x598313=>{const _0x3bdde0=_0x16992a;if(!validateTelegram(_0x598313))return;let _0x100b96=_0x3bdde0(0x152);config['forEach'](_0x5ec9b2=>{const _0x7cad5a=_0x3bdde0;_0x100b96+=_0x7cad5a(0x19d)+_0x5ec9b2['botID']+_0x7cad5a(0x1e1)+_0x5ec9b2[_0x7cad5a(0x1c7)]+':\x20'+_0x5ec9b2['status']+_0x7cad5a(0xd8)+_0x5ec9b2[_0x7cad5a(0x15f)]+'\x0a';}),_0x100b96+='\x0a',_0x100b96+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x100b96+=!settings['telegramEnabled']?_0x3bdde0(0x208):'Notifications\x20enabled\x0a',_0x100b96+=settings[_0x3bdde0(0x21e)]?settings[_0x3bdde0(0x163)]==_0x3bdde0(0x207)?_0x3bdde0(0x1f6):_0x3bdde0(0x171)+settings['telegramEvents']+_0x3bdde0(0x1c3):'',tgBot[_0x3bdde0(0x1d4)](_0x598313[_0x3bdde0(0x20b)]['id'],_0x100b96,{'parse_mode':'HTML'})[_0x3bdde0(0x10d)](_0x454c07=>{telegramError(_0x454c07);});}),tgBot[_0x16992a(0x1db)](/\/restart/,_0x41f55a=>{const _0x585d94=_0x16992a;if(!validateTelegram(_0x41f55a))return;tgBot['removeListener'](_0x585d94(0x164));const _0xab8561=getEnabledBots();if(_0xab8561[_0x585d94(0x1f4)]==0x0)tgBot['sendMessage'](_0x41f55a[_0x585d94(0x20b)]['id'],_0x585d94(0x13a))[_0x585d94(0x10d)](_0x4255ff=>{telegramError(_0x4255ff);});else{if(_0xab8561[_0x585d94(0x1f4)]>0x1)_0xab8561[_0x585d94(0x14f)]({'botID':_0x585d94(0x207)});let _0x57b20d=[],_0x589a96=[];const _0x22cd6d=_0xab8561['length']%0x4==0x0||_0xab8561[_0x585d94(0x1f4)]%0x4==0x3||_0xab8561['length']%0x3==0x1?0x4:0x3;let _0x4a9e01=0x0;_0xab8561[_0x585d94(0xd6)]((_0xc2e67d,_0x3ab9f1)=>{const _0x111cfe=_0x585d94;if(_0x3ab9f1%_0x22cd6d==0x0)_0x589a96=[];_0x589a96['push']({'text':_0xc2e67d[_0x111cfe(0x1a3)]==_0x111cfe(0x207)?'All\x20bots':_0x111cfe(0x19d)+_0xc2e67d[_0x111cfe(0x1a3)],'callback_data':_0xc2e67d[_0x111cfe(0x1a3)]}),_0x3ab9f1%_0x22cd6d==0x0&&(_0x57b20d[_0x4a9e01]=_0x589a96,_0x4a9e01++);}),tgBot[_0x585d94(0x1d4)](_0x41f55a['chat']['id'],_0x585d94(0xe0),{'reply_markup':{'inline_keyboard':_0x57b20d}})[_0x585d94(0x10d)](_0x37da31=>{telegramError(_0x37da31);}),tgBot['on'](_0x585d94(0x164),async _0x4e6fe9=>{const _0x1e0856=_0x585d94,_0x34353a=_0x4e6fe9[_0x1e0856(0x1b7)],_0x23dc7e=_0x4e6fe9[_0x1e0856(0x126)];tgBot['answerCallbackQuery'](_0x4e6fe9['id'])[_0x1e0856(0x13b)](async()=>{const _0x406fc6=_0x1e0856;if(_0x34353a==_0x406fc6(0x207)){if(settings[_0x406fc6(0x163)]==_0x406fc6(0x124))tgBot[_0x406fc6(0x1d4)](_0x23dc7e[_0x406fc6(0x20b)]['id'],_0x406fc6(0x180))[_0x406fc6(0x10d)](_0x19b6b8=>{telegramError(_0x19b6b8);});config[_0x406fc6(0xd6)](_0x3cf48c=>{const _0x2c9708=_0x406fc6;stopBot(_0x3cf48c[_0x2c9708(0x1a3)]);});}else{if(settings['telegramEvents']==_0x406fc6(0x124))tgBot[_0x406fc6(0x1d4)](_0x23dc7e[_0x406fc6(0x20b)]['id'],_0x406fc6(0x1fd)+_0x34353a)[_0x406fc6(0x10d)](_0x4dfcb1=>{telegramError(_0x4dfcb1);});stopBot(_0x34353a);}}),tgBot[_0x1e0856(0x1d2)](_0x1e0856(0x164));});}}),tgBot['onText'](/\/on/,_0x1db364=>{const _0x4ddd6e=_0x16992a;if(!validateTelegram(_0x1db364))return;tgBot[_0x4ddd6e(0x1d2)](_0x4ddd6e(0x164));const _0xd37ac5=getDisabledBots();if(_0xd37ac5[_0x4ddd6e(0x1f4)]==0x0)tgBot[_0x4ddd6e(0x1d4)](_0x1db364[_0x4ddd6e(0x20b)]['id'],_0x4ddd6e(0x17d))[_0x4ddd6e(0x10d)](_0x387ceb=>{telegramError(_0x387ceb);});else{if(_0xd37ac5[_0x4ddd6e(0x1f4)]>0x1)_0xd37ac5['push']({'botID':'all'});let _0xd0ed41=[],_0x12ff21=[];const _0x331c42=_0xd37ac5['length']%0x4==0x0||_0xd37ac5[_0x4ddd6e(0x1f4)]%0x4==0x3||_0xd37ac5[_0x4ddd6e(0x1f4)]%0x3==0x1?0x4:0x3;let _0x106900=0x0;_0xd37ac5[_0x4ddd6e(0xd6)]((_0xf321d3,_0x520605)=>{const _0x4b8737=_0x4ddd6e;if(_0x520605%_0x331c42==0x0)_0x12ff21=[];_0x12ff21[_0x4b8737(0x14f)]({'text':_0xf321d3[_0x4b8737(0x1a3)]==_0x4b8737(0x207)?'All\x20bots':_0x4b8737(0x19d)+_0xf321d3[_0x4b8737(0x1a3)],'callback_data':_0xf321d3['botID']}),_0x520605%_0x331c42==0x0&&(_0xd0ed41[_0x106900]=_0x12ff21,_0x106900++);}),tgBot['sendMessage'](_0x1db364[_0x4ddd6e(0x20b)]['id'],_0x4ddd6e(0x103),{'reply_markup':{'inline_keyboard':_0xd0ed41}})[_0x4ddd6e(0x10d)](_0x5c8522=>{telegramError(_0x5c8522);}),tgBot['on'](_0x4ddd6e(0x164),async _0x11d4a6=>{const _0x259944=_0x4ddd6e,_0x375d27=_0x11d4a6[_0x259944(0x1b7)],_0x4c21f9=_0x11d4a6[_0x259944(0x126)];tgBot[_0x259944(0x155)](_0x11d4a6['id'])[_0x259944(0x13b)](async()=>{const _0x34ec7c=_0x259944;if(_0x375d27==_0x34ec7c(0x207)){if(settings['telegramEvents']==_0x34ec7c(0x124))tgBot[_0x34ec7c(0x1d4)](_0x4c21f9[_0x34ec7c(0x20b)]['id'],_0x34ec7c(0x107))[_0x34ec7c(0x10d)](_0x3d7407=>{telegramError(_0x3d7407);});_0xd37ac5[_0x34ec7c(0xd6)](_0x5299fc=>{const _0x1df07c=_0x34ec7c;if(_0x5299fc['botID']!='all')toggleBot(_0x5299fc[_0x1df07c(0x1a3)],toggleStatus(_0x5299fc[_0x1df07c(0x1a3)]),_0x1df07c(0x16f));});}else{if(settings[_0x34ec7c(0x163)]==_0x34ec7c(0x124))tgBot[_0x34ec7c(0x1d4)](_0x4c21f9['chat']['id'],_0x34ec7c(0xf2)+_0x375d27)[_0x34ec7c(0x10d)](_0x444493=>{telegramError(_0x444493);});toggleBot(_0x375d27,toggleStatus(_0x375d27),_0x34ec7c(0x16f));}}),tgBot[_0x259944(0x1d2)](_0x259944(0x164));});}}),tgBot[_0x16992a(0x1db)](/\/off/,_0x2f5689=>{const _0xb6ef31=_0x16992a;if(!validateTelegram(_0x2f5689))return;tgBot['removeListener'](_0xb6ef31(0x164));const _0x1eb370=getEnabledBots();if(_0x1eb370['length']==0x0)tgBot[_0xb6ef31(0x1d4)](_0x2f5689['chat']['id'],_0xb6ef31(0x13a))[_0xb6ef31(0x10d)](_0x386f8b=>{telegramError(_0x386f8b);});else{if(_0x1eb370[_0xb6ef31(0x1f4)]>0x1)_0x1eb370[_0xb6ef31(0x14f)]({'botID':_0xb6ef31(0x207)});let _0x47ec9d=[],_0x1b834f=[];const _0x2cffe0=_0x1eb370[_0xb6ef31(0x1f4)]%0x4==0x0||_0x1eb370[_0xb6ef31(0x1f4)]%0x4==0x3||_0x1eb370[_0xb6ef31(0x1f4)]%0x3==0x1?0x4:0x3;let _0xe1d9da=0x0;_0x1eb370[_0xb6ef31(0xd6)]((_0x51ccdb,_0x151f69)=>{const _0x5ed520=_0xb6ef31;if(_0x151f69%_0x2cffe0==0x0)_0x1b834f=[];_0x1b834f[_0x5ed520(0x14f)]({'text':_0x51ccdb[_0x5ed520(0x1a3)]==_0x5ed520(0x207)?_0x5ed520(0x1c6):_0x5ed520(0x19d)+_0x51ccdb['botID'],'callback_data':_0x51ccdb['botID']}),_0x151f69%_0x2cffe0==0x0&&(_0x47ec9d[_0xe1d9da]=_0x1b834f,_0xe1d9da++);}),tgBot[_0xb6ef31(0x1d4)](_0x2f5689[_0xb6ef31(0x20b)]['id'],_0xb6ef31(0x156),{'reply_markup':{'inline_keyboard':_0x47ec9d}})['catch'](_0x465d8c=>{telegramError(_0x465d8c);}),tgBot['on'](_0xb6ef31(0x164),async _0x4240df=>{const _0x354886=_0xb6ef31,_0x7aaeaf=_0x4240df[_0x354886(0x1b7)],_0xc31fb6=_0x4240df[_0x354886(0x126)];tgBot[_0x354886(0x155)](_0x4240df['id'])[_0x354886(0x13b)](async()=>{const _0x2463b=_0x354886;if(_0x7aaeaf==_0x2463b(0x207)){if(settings['telegramEvents']=='orders')tgBot[_0x2463b(0x1d4)](_0xc31fb6['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x2463b(0x10d)](_0x344a47=>{telegramError(_0x344a47);});_0x1eb370[_0x2463b(0xd6)](_0x16f85e=>{const _0x48b713=_0x2463b;if(_0x16f85e[_0x48b713(0x1a3)]!='all')toggleBot(_0x16f85e['botID'],toggleStatus(_0x16f85e[_0x48b713(0x1a3)]),_0x48b713(0x16f));});}else{if(settings[_0x2463b(0x163)]=='orders')tgBot['sendMessage'](_0xc31fb6[_0x2463b(0x20b)]['id'],_0x2463b(0x169)+_0x7aaeaf)[_0x2463b(0x10d)](_0x3d509c=>{telegramError(_0x3d509c);});toggleBot(_0x7aaeaf,toggleStatus(_0x7aaeaf),_0x2463b(0x16f));}}),tgBot[_0x354886(0x1d2)]('callback_query');});}}),tgBot['onText'](/\/disable/,_0x15c19c=>{const _0x290ad7=_0x16992a;if(!validateTelegram(_0x15c19c))return;tgBot[_0x290ad7(0x1d4)](_0x15c19c['chat']['id'],_0x290ad7(0x185))[_0x290ad7(0x10d)](_0x375faa=>{telegramError(_0x375faa);}),updateSetting(_0x290ad7(0x21e),![]);}),tgBot['onText'](/\/help/,_0x303ff5=>{const _0x2f47e0=_0x16992a;if(!validateTelegram(_0x303ff5))return;tgBot[_0x2f47e0(0x1d4)](_0x303ff5['chat']['id'],_0x4f7df9)[_0x2f47e0(0x10d)](_0x2a24da=>{telegramError(_0x2a24da);});}),tgBot['on'](_0x16992a(0x20a),_0x321b14=>{const _0x1a4b77=_0x16992a;_0x321b14[_0x1a4b77(0xfa)]()[_0x1a4b77(0x19e)](_0x1a4b77(0x10b))&&(logging(_0x1a4b77(0x119)),tgBot[_0x1a4b77(0xdf)](),tgBot=null,io['to'](_0x1a4b77(0x10e))[_0x1a4b77(0x172)]('notification','Invalid\x20Telegram\x20token'));}),process['once'](_0x16992a(0x193),()=>{const _0x3824f9=_0x16992a;if(tgBot)tgBot[_0x3824f9(0xdf)]();process[_0x3824f9(0x111)](0x1);}),process['once'](_0x16992a(0x20f),()=>{const _0x43e58b=_0x16992a;if(tgBot)tgBot[_0x43e58b(0xdf)]();process[_0x43e58b(0x111)](0x1);});}}function disableTelegram(){const _0x2eeb85=_0x1b21eb;tgBot&&(tgBot[_0x2eeb85(0xdf)](),tgBot=null);}function sendTelegram(_0x12ab48,_0x13ef51){const _0x33555a=_0x1b21eb;if(settings[_0x33555a(0x21e)]){if(settings[_0x33555a(0x163)]=='all'||(_0x13ef51[_0x33555a(0x1a4)]==_0x33555a(0x1ad)||_0x13ef51[_0x33555a(0x1a4)]==_0x33555a(0x123))&&settings['telegramEvents']=='alerts'||_0x13ef51[_0x33555a(0x1a4)]=='order'&&settings[_0x33555a(0x163)]==_0x33555a(0x124)){if(tgBot&&settings[_0x33555a(0x1af)]){if(_0x13ef51[_0x33555a(0x218)])tgBot[_0x33555a(0x1d4)](settings[_0x33555a(0x1af)],_0x13ef51[_0x33555a(0x1c7)]+_0x33555a(0x1f8)+_0x13ef51[_0x33555a(0x1e3)])[_0x33555a(0x10d)](_0x1f147f=>{telegramError(_0x1f147f);});else tgBot[_0x33555a(0x1d4)](settings[_0x33555a(0x1af)],'Bot\x20'+_0x12ab48+'\x20>\x20'+_0x13ef51['event'])[_0x33555a(0x10d)](_0x21892f=>{telegramError(_0x21892f);});}}}}function getDeviceWithIp(_0x11161c){return devices['find'](_0x38827d=>_0x38827d['ip']===_0x11161c);}function temporaryAccess2FA(_0x10553d,_0x25e5b1){const _0x1a53c1=_0x1b21eb;let _0xfc195=new Date(),_0x1395d9=![];if(lastIpApproval){if(_0xfc195-lastIpApproval<0x1388)_0x1395d9=!![];}lastIpApproval=new Date();if(_0x1395d9)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x1a53c1(0x1d2)]('callback_query'),tgBot[_0x1a53c1(0x1d4)](settings[_0x1a53c1(0x1af)],_0x1a53c1(0x1b3)+normalizeIP(_0x25e5b1)['show']+_0x1a53c1(0x1de),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1a53c1(0xe7),'callback_data':'5'},{'text':_0x1a53c1(0x151),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':_0x1a53c1(0x20c)}]]}})[_0x1a53c1(0x10d)](_0x3575f0=>{telegramError(_0x3575f0);}),tgBot['on'](_0x1a53c1(0x164),async _0x617b49=>{const _0x1f58a1=_0x1a53c1,_0x34ccae=_0x617b49[_0x1f58a1(0x1b7)],_0x348a54=_0x617b49[_0x1f58a1(0x126)];tgBot[_0x1f58a1(0x155)](_0x617b49['id'])[_0x1f58a1(0x13b)](async()=>{const _0xe569ea=_0x1f58a1;devices[_0x10553d]['telegramIpApproval']={'clientip':_0x25e5b1,'timestamp':new Date()[_0xe569ea(0x150)](),'expiry':_0x34ccae},_0x34ccae!=_0xe569ea(0x20c)?(await tgBot['sendMessage'](_0x348a54[_0xe569ea(0x20b)]['id'],'Access\x20enabled\x20for\x20'+_0x34ccae+_0xe569ea(0x114),{'parse_mode':_0xe569ea(0x211)})[_0xe569ea(0x10d)](_0x413270=>{telegramError(_0x413270);}),io['to'](_0x10553d)[_0xe569ea(0x172)](_0xe569ea(0x1c2),{'access':{'allow':![],'reason':_0xe569ea(0x138),'token':null}})):(await tgBot['sendMessage'](_0x348a54['chat']['id'],_0xe569ea(0xe9))['catch'](_0x2c81ed=>{telegramError(_0x2c81ed);}),io['to'](_0x10553d)[_0xe569ea(0x172)](_0xe569ea(0x1c2),{'access':{'allow':![],'reason':_0xe569ea(0x1ba),'token':null}}));}),tgBot['removeListener'](_0x1f58a1(0x164));}));}function loginAccess2FA(_0x472e0a,_0x230a6e){const _0x191437=_0x1b21eb;tgBot&&settings['telegramChatId']&&(tgBot[_0x191437(0x1d2)](_0x191437(0x164)),tgBot[_0x191437(0x1d4)](settings[_0x191437(0x1af)],_0x191437(0x128)+normalizeIP(_0x230a6e)[_0x191437(0x21f)]+_0x191437(0x1de),{'parse_mode':_0x191437(0x211),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':'reject'}]]}})[_0x191437(0x10d)](_0x45b2de=>{telegramError(_0x45b2de);}),tgBot['on'](_0x191437(0x164),async _0x5be61c=>{const _0x466ca2=_0x191437,_0x3a89f4=_0x5be61c['data'],_0x403601=_0x5be61c[_0x466ca2(0x126)];tgBot[_0x466ca2(0x155)](_0x5be61c['id'])[_0x466ca2(0x13b)](async()=>{const _0x13d446=_0x466ca2;devices[_0x472e0a][_0x13d446(0x212)]={'clientip':_0x230a6e,'timestamp':new Date()['getTime'](),'expiry':_0x3a89f4},_0x3a89f4!=_0x13d446(0x20c)?(await tgBot['sendMessage'](_0x403601[_0x13d446(0x20b)]['id'],_0x13d446(0xd7),{'parse_mode':_0x13d446(0x211)})[_0x13d446(0x10d)](_0x6bbb5c=>{telegramError(_0x6bbb5c);}),io['to'](_0x472e0a)[_0x13d446(0x172)](_0x13d446(0x1c2),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x13d446(0x1d4)](_0x403601[_0x13d446(0x20b)]['id'],_0x13d446(0x120))[_0x13d446(0x10d)](_0x23cb1f=>{telegramError(_0x23cb1f);}),io['to'](_0x472e0a)[_0x13d446(0x172)](_0x13d446(0x1c2),{'access':{'allow':![],'reason':_0x13d446(0x168),'token':null}}));}),tgBot['removeListener'](_0x466ca2(0x164));}));}function getConfiguration(){const _0x59b517=_0x1b21eb;return dbConfig['get'](_0x59b517(0x200))[_0x59b517(0x17e)](_0x59b517(0x1a3))[_0x59b517(0x12d)]()||[];}function getEnabledBots(){const _0x1640cb=_0x1b21eb;return dbConfig[_0x1640cb(0x1a7)](_0x1640cb(0x200))['sortBy'](_0x1640cb(0x1a3))[_0x1640cb(0x1b9)]({'status':_0x1640cb(0x14d)})[_0x1640cb(0x12d)]()||[];}function getDisabledBots(){const _0x474d69=_0x1b21eb;return dbConfig[_0x474d69(0x1a7)](_0x474d69(0x200))['sortBy'](_0x474d69(0x1a3))['filter']({'status':_0x474d69(0x157)})[_0x474d69(0x12d)]()||[];}function getSettings(){const _0x24dd5e=_0x1b21eb;return dbSettings['get'](_0x24dd5e(0x1e2))[_0x24dd5e(0x12d)]()||{'timeshift':0x0};}function getSecure(){const _0xb24e9d=_0x1b21eb;return dbSecure[_0xb24e9d(0x1a7)]('secure')[_0xb24e9d(0x12d)]()||{};}function getBlacklist(){const _0x503721=_0x1b21eb;return dbSecure[_0x503721(0x1a7)](_0x503721(0x1a0))['value']()||[];}function broadcastToBots(_0x7ab0a2,_0x29e8b2){const _0x58b622=_0x1b21eb;config[_0x58b622(0xd6)](_0x53d41c=>{const _0x287c7b=_0x58b622;if(_0x53d41c[_0x287c7b(0x1c2)]==_0x287c7b(0x14d)&&_0x53d41c[_0x287c7b(0x15f)]==_0x287c7b(0xed)){if(pid[_0x53d41c[_0x287c7b(0x1a3)]])pid[_0x53d41c[_0x287c7b(0x1a3)]][_0x287c7b(0x15b)]({[_0x7ab0a2]:_0x29e8b2});}});}function _0x24eb(_0x25a3ba,_0xb5b066){const _0x3160b9=_0x4a48();return _0x24eb=function(_0x6990cf,_0x36f16e){_0x6990cf=_0x6990cf-0xd6;let _0x4a483d=_0x3160b9[_0x6990cf];return _0x4a483d;},_0x24eb(_0x25a3ba,_0xb5b066);}function storeSettings(_0xdc3dca,_0xcebe42=![]){const _0x2aae70=_0x1b21eb;_0xdc3dca={...settings,..._0xdc3dca};if(_0xcebe42&&_0xdc3dca[_0x2aae70(0x140)]!=_0x2aae70(0x13d)&&_0xdc3dca[_0x2aae70(0x140)]!=''){const _0x505e77=crypt[_0x2aae70(0x166)](secure[_0x2aae70(0x13c)],_0xdc3dca[_0x2aae70(0x140)])['message'][_0x2aae70(0x1bf)]('@')[0x0],_0x2ec2ac=bcrypt['hashSync'](_0x505e77,saltRounds);_0xdc3dca={..._0xdc3dca,'bbPassword':_0x2ec2ac};}if(_0xcebe42&&_0xdc3dca['telegramToken']!='************'&&_0xdc3dca[_0x2aae70(0x12a)]!=''){const _0x23e80b=crypt['decrypt'](secure['privateKey'],_0xdc3dca[_0x2aae70(0x12a)])[_0x2aae70(0x126)]['split']('@')[0x0];_0xdc3dca={..._0xdc3dca,'telegramToken':_0x23e80b};}const _0x41502c=_0xdc3dca[_0x2aae70(0x12a)]!=_0x2aae70(0x13d)&&_0xdc3dca[_0x2aae70(0x12a)]!=settings[_0x2aae70(0x12a)]||_0xdc3dca[_0x2aae70(0x1f7)]!=settings[_0x2aae70(0x1f7)],_0xd59dad=_0xdc3dca[_0x2aae70(0x12a)]==''||_0xdc3dca[_0x2aae70(0x1f7)]=='';if(_0x41502c)_0xdc3dca[_0x2aae70(0x163)]=_0x2aae70(0x207);for(const [_0x185c7e,_0x16ba9d]of Object['entries'](_0xdc3dca)){if(_0x185c7e==_0x2aae70(0x12a)&&_0x16ba9d==_0x2aae70(0x13d)){_0xdc3dca[_0x2aae70(0x12a)]=settings[_0x2aae70(0x12a)];continue;};if(_0x185c7e==_0x2aae70(0x140)&&_0x16ba9d=='************'){_0xdc3dca[_0x2aae70(0x140)]=settings[_0x2aae70(0x140)];continue;};dbSettings['set'](_0x2aae70(0x16d)+_0x185c7e,_0x16ba9d)[_0x2aae70(0x100)]();}settings=_0xdc3dca,io['to'](_0x2aae70(0x10e))[_0x2aae70(0x172)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x2aae70(0x116)]);if(_0x41502c&&!_0xd59dad)initTelegram();if(_0x41502c&&_0xd59dad)disableTelegram();getAllClients()[_0x2aae70(0xd6)](_0x3997a6=>{const _0x45ac98=_0x2aae70;getSocket(_0x3997a6['id'])[_0x45ac98(0x172)](_0x45ac98(0x1c2),{'access':{'allow':![],'reason':_0x45ac98(0x138),'token':null}});});}function updateSetting(_0x4adb29,_0x8bff7){const _0x4d2f1e=_0x1b21eb;dbSettings[_0x4d2f1e(0x162)]('settings.'+_0x4adb29,_0x8bff7)[_0x4d2f1e(0x100)](),settings=getSettings(),io['to'](_0x4d2f1e(0x10e))[_0x4d2f1e(0x172)](_0x4d2f1e(0x1e2),cleanSettings());}function storeSecure(_0x3e6f91){const _0x3430ac=_0x1b21eb;dbSecure['get'](_0x3430ac(0x1ea))['push'](_0x3e6f91)[_0x3430ac(0x100)](),secure=_0x3e6f91;}function addBlacklist(_0x44bbab){const _0x22cd8a=_0x1b21eb;cleanBlacklist();let _0x374669;devices[_0x44bbab][_0x22cd8a(0x14c)]?_0x374669=Math['max'](devices[_0x44bbab][_0x22cd8a(0x14c)][_0x22cd8a(0x1aa)],loginExpiry):_0x374669=loginExpiry,dbSecure[_0x22cd8a(0x1a7)](_0x22cd8a(0x1a0))[_0x22cd8a(0x14f)]({'expiry':new Date()['getTime']()+_0x374669*0x3c*0x3e8,'token':devices[_0x44bbab]['access'][_0x22cd8a(0xe4)]})['write'](),blacklist=dbSecure[_0x22cd8a(0x1a7)](_0x22cd8a(0x1a0))[_0x22cd8a(0x12d)]();}function cleanBlacklist(){const _0x433a37=_0x1b21eb;let _0x48bb38=dbSecure[_0x433a37(0x1a7)](_0x433a37(0x1a0))[_0x433a37(0x11e)]()['value'](),_0x32ba81=new Date()[_0x433a37(0x150)]();_0x48bb38['forEach'](_0x436681=>{const _0x281923=_0x433a37;_0x436681['expiry']<_0x32ba81&&dbSecure[_0x281923(0x1a7)]('blacklist')[_0x281923(0x18b)]({'expiry':_0x436681[_0x281923(0x1aa)]})[_0x281923(0x100)]();});}function initStates(){const _0x2584eb=_0x1b21eb;let _0x5ad801=getConfiguration();_0x5ad801[_0x2584eb(0xd6)](_0x1772d6=>{const _0x29ea1c=_0x2584eb;_0x1772d6['live']=_0x29ea1c(0x16f);}),storeConfiguration(_0x5ad801);}function onKeys(){const _0x342a4d=new RSA();return new Promise(_0x18d50f=>{const _0x320501=_0x24eb;_0x342a4d[_0x320501(0x1da)]()[_0x320501(0x13b)](_0x4d42f9=>{_0x18d50f(_0x4d42f9);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1c2085=_0x1b21eb;let _0x22f87d=getConfiguration(),_0xe76080=![];_0x22f87d['forEach'](_0x5a544f=>{const _0xc6bf73=_0x24eb;if(_0x5a544f[_0xc6bf73(0x1c2)]==_0xc6bf73(0xed))_0x5a544f[_0xc6bf73(0x1c2)]='enabled',_0xe76080=!![];else _0x5a544f[_0xc6bf73(0x1c2)]==_0xc6bf73(0x16f)&&(_0x5a544f['status']=_0xc6bf73(0x157),_0xe76080=!![]);});if(_0xe76080)storeConfiguration(_0x22f87d);let _0x381795=getSecure();if(!_0x381795[_0x1c2085(0x173)](_0x1c2085(0x190))){let _0x41f3c4=await generateKeys();_0x381795['publicKey']=_0x41f3c4[_0x1c2085(0x1f0)],_0x381795[_0x1c2085(0x13c)]=_0x41f3c4['privateKey'],_0x381795[_0x1c2085(0x190)]=crypto['randomBytes'](0x20)[_0x1c2085(0xfa)](_0x1c2085(0x1be));;storeSecure(_0x381795);}let _0x48114a=getSettings();_0xe76080=![];!_0x48114a[_0x1c2085(0x173)](_0x1c2085(0x121))&&(_0x48114a[_0x1c2085(0x121)]=![],_0x48114a[_0x1c2085(0x13e)]='',_0x48114a[_0x1c2085(0x140)]='',_0x48114a[_0x1c2085(0x191)]=![],_0xe76080=!![]);!_0x48114a[_0x1c2085(0x173)]('whitelistEnabled')&&(_0x48114a[_0x1c2085(0x13f)]=![],_0x48114a['whitelist']=[],_0x48114a[_0x1c2085(0x1dd)]=![],_0xe76080=!![]);if(!_0x48114a[_0x1c2085(0x173)](_0x1c2085(0x21e))){if(_0x48114a[_0x1c2085(0x1af)])_0x48114a['telegramEnabled']=!![];else _0x48114a['telegramEnabled']=![];_0xe76080=!![];}if(_0xe76080)storeSettings(_0x48114a);}function storeConfiguration(_0x2856ed){const _0x2fd545=_0x1b21eb;dbConfig[_0x2fd545(0x1a7)](_0x2fd545(0x200))[_0x2fd545(0x18b)]()[_0x2fd545(0x100)](),dbConfig[_0x2fd545(0x1a7)](_0x2fd545(0x200))[_0x2fd545(0x14f)](..._0x2856ed)['write'](),config=_0x2856ed;}function resetPassword(){const _0x5f421b=_0x1b21eb;tgBot&&settings[_0x5f421b(0x1af)]&&(tgBot['removeListener'](_0x5f421b(0x164)),tgBot[_0x5f421b(0x1d4)](settings[_0x5f421b(0x1af)],_0x5f421b(0x158),{'parse_mode':_0x5f421b(0x211),'reply_markup':{'inline_keyboard':[[{'text':_0x5f421b(0x15c),'callback_data':_0x5f421b(0x15c)},{'text':'no','callback_data':'no'}]]}})[_0x5f421b(0x10d)](_0x2b7f4d=>{telegramError(_0x2b7f4d);}),tgBot['on'](_0x5f421b(0x164),async _0x2d5c05=>{const _0x5db5f4=_0x5f421b,_0x53aee2=_0x2d5c05[_0x5db5f4(0x1b7)],_0x19add2=_0x2d5c05[_0x5db5f4(0x126)];tgBot[_0x5db5f4(0x155)](_0x2d5c05['id'])['then'](async()=>{const _0x532b8b=_0x5db5f4;if(_0x53aee2!='no'){const _0x560260=0xf,_0x481b01='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x5c3c6f=Array['from'](crypto[_0x532b8b(0x21a)](new Uint32Array(_0x560260)))[_0x532b8b(0x17f)](_0x5c5c07=>_0x481b01[_0x5c5c07%_0x481b01[_0x532b8b(0x1f4)]])[_0x532b8b(0x10c)](''),_0x50ac79=bcrypt['hashSync'](_0x5c3c6f,saltRounds);storeSettings({'bbPassword':_0x50ac79}),await tgBot[_0x532b8b(0x1d4)](_0x19add2[_0x532b8b(0x20b)]['id'],_0x532b8b(0x129)+_0x5c3c6f,{'parse_mode':_0x532b8b(0x211)})['catch'](_0x2ab147=>{telegramError(_0x2ab147);});}else await tgBot[_0x532b8b(0x1d4)](_0x19add2[_0x532b8b(0x20b)]['id'],_0x532b8b(0x1d9))['catch'](_0x1b81de=>{telegramError(_0x1b81de);});}),tgBot[_0x5db5f4(0x1d2)](_0x5db5f4(0x164));}));}function logging(_0x52f291){const _0x20ecbf=_0x1b21eb;console['log'](getTimeStamp()+_0x20ecbf(0x179)+_0x52f291);if(tgBot&&settings[_0x20ecbf(0x1af)]&&settings[_0x20ecbf(0x163)]!=_0x20ecbf(0x124))tgBot[_0x20ecbf(0x1d4)](settings[_0x20ecbf(0x1af)],_0x20ecbf(0x1b4)+_0x52f291)[_0x20ecbf(0x10d)](_0x231b62=>{telegramError(_0x231b62);});}function getServerTime(){const _0x27e0ed=_0x1b21eb,_0x31c0a2=new Date();return _0x31c0a2[_0x27e0ed(0x1fa)]()+'/'+(_0x31c0a2['getMonth']()+0x1)[_0x27e0ed(0xfa)]()['padStart'](0x2,'0')+'/'+_0x31c0a2['getDate']()[_0x27e0ed(0xfa)]()[_0x27e0ed(0x142)](0x2,'0')+'\x20'+_0x31c0a2['getHours']()[_0x27e0ed(0xfa)]()[_0x27e0ed(0x142)](0x2,'0')+':'+_0x31c0a2[_0x27e0ed(0x21b)]()[_0x27e0ed(0xfa)]()[_0x27e0ed(0x142)](0x2,'0')+':'+_0x31c0a2['getSeconds']()[_0x27e0ed(0xfa)]()[_0x27e0ed(0x142)](0x2,'0');}function getTimeStamp(){const _0x1901ee=_0x1b21eb,_0x364d73=shiftedTime();return _0x364d73[_0x1901ee(0x1fa)]()+'/'+(_0x364d73[_0x1901ee(0x137)]()+0x1)[_0x1901ee(0xfa)]()[_0x1901ee(0x142)](0x2,'0')+'/'+_0x364d73[_0x1901ee(0x195)]()[_0x1901ee(0xfa)]()[_0x1901ee(0x142)](0x2,'0')+'\x20'+_0x364d73[_0x1901ee(0x127)]()['toString']()['padStart'](0x2,'0')+':'+_0x364d73[_0x1901ee(0x21b)]()[_0x1901ee(0xfa)]()[_0x1901ee(0x142)](0x2,'0')+':'+_0x364d73['getSeconds']()[_0x1901ee(0xfa)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x5d1bcb=_0x1b21eb,_0x3da0d1=new Date();let _0x5b58e6=_0x3da0d1;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x5b58e6=fns[_0x5d1bcb(0x19a)](_0x3da0d1,{'hours':settings['timeshift']});return _0x5b58e6;}function startScheduler(){const _0x5a0805=_0x1b21eb;let _0x294b3b=new Date()[_0x5a0805(0x131)]();_0x294b3b==0x1&&backupConfigFiles();_0x294b3b==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x5a14aa=_0x1b21eb;fs[_0x5a14aa(0x108)](configpath,{'withFileTypes':!![]})[_0x5a14aa(0xd6)](_0x78dca3=>{const _0x28dcb7=_0x5a14aa;if(!_0x78dca3[_0x28dcb7(0x215)]())fs['copyFileSync'](configpath+_0x78dca3[_0x28dcb7(0x1f1)],configbackuppath+_0x78dca3[_0x28dcb7(0x1f1)]);});}function triggerAnalytics(){const _0x3654b8=_0x1b21eb;analytics[_0x3654b8(0x1c0)]({'title':_0x3654b8(0x165),'href':_0x3654b8(0x220),'path':'/v'+serverversion});}function validateCredentials(_0x28df07,_0x45309e){const _0x6b9cbd=_0x1b21eb;if(_0x28df07[_0x6b9cbd(0x14b)]==settings[_0x6b9cbd(0x13e)]&&bcrypt[_0x6b9cbd(0x18c)](_0x28df07[_0x6b9cbd(0x1f2)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x6b9cbd(0x192),'token':null};else{const _0x2d152a=generateLoginToken(_0x45309e);return{'allow':!![],'reason':_0x6b9cbd(0x184),'token':_0x2d152a};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x2fd651){const _0x4ebac1=_0x1b21eb,_0x53f761=generateLoginToken(_0x2fd651);return{'allow':!![],'reason':_0x4ebac1(0x184),'token':_0x53f761};}function validateAccess(_0x4de68c,_0x15a020){const _0x1d163e=_0x1b21eb;let _0xd40c6a=devices[_0x15a020]['ip'],_0x2fbcd0;const _0x80dd2f=_0x396532=>{const _0x22cc21=_0x24eb;if(settings['loginRequired']){if(settings[_0x22cc21(0x191)]){if(telegram2FaApproved(_0x15a020)){const _0x340f8f=generateLoginToken(_0x15a020);return{'allow':!![],'reason':_0x22cc21(0x125),'token':_0x340f8f};}else return{'allow':![],'reason':_0x22cc21(0xe3),'token':null};}else return _0x2fbcd0=validToken(_0x396532,_0x15a020),_0x2fbcd0[_0x22cc21(0x173)](_0x22cc21(0x123))?{'allow':!![],'reason':_0x22cc21(0x175),'token':_0x396532}:{'allow':![],'reason':_0x22cc21(0xe3),'token':null};}else return{'allow':!![],'reason':_0x22cc21(0x136),'token':null};};if(settings[_0x1d163e(0x13f)]){let _0x4b975e=[...settings[_0x1d163e(0x214)],_0x1d163e(0x174),_0x1d163e(0x1d0),_0x1d163e(0x197)];if(_0x4b975e[_0x1d163e(0x19e)](_0xd40c6a))return _0x80dd2f(_0x4de68c);else{_0x2fbcd0=validToken(_0x4de68c,_0x15a020);if(_0x2fbcd0['hasOwnProperty'](_0x1d163e(0x123)))return _0x80dd2f(_0x4de68c);else{if(telegramIpApproved(_0x15a020)){const _0x3be094=generateToken(_0x15a020);return _0x2fbcd0=_0x80dd2f(_0x4de68c),_0x2fbcd0[_0x1d163e(0xfb)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3be094}:_0x2fbcd0;}else return settings[_0x1d163e(0x1dd)]?{'allow':![],'reason':_0x1d163e(0x18d),'token':null}:{'allow':![],'reason':_0x1d163e(0x19f),'token':null};}}}else return _0x80dd2f(_0x4de68c);}function timelyDecrypt(_0x211664,_0x3a8a7c=!![]){const _0x524808=_0x1b21eb;if(_0x211664)try{const _0x3c255c=crypt[_0x524808(0x166)](secure[_0x524808(0x13c)],_0x211664)[_0x524808(0x126)],_0x22b090=_0x3c255c[_0x524808(0x1bf)]('@')[0x0],_0xc87567=_0x3c255c[_0x524808(0x1bf)]('@')[0x1],_0x471c5e=new Date()[_0x524808(0x150)]();if(_0x3a8a7c){if(_0x471c5e-_0xc87567<maxSecretAge*0x3e8)return _0x22b090;else return![];}else return _0x22b090;}catch(_0x2e183e){return![];}else return![];}const validToken=(_0x109856,_0x101ea6)=>{const _0xd518b5=_0x1b21eb,_0x431ec9=devices[_0x101ea6]['ip'];if(!_0x109856)return{'error':_0xd518b5(0x1b6)};for(let _0x1642c0 of blacklist){if(_0x1642c0['token']==_0x109856)return{'error':_0xd518b5(0x202)};}let _0x2728fa;try{_0x2728fa=jwt[_0xd518b5(0xe6)](_0x109856,secure[_0xd518b5(0x190)]+_0x101ea6);}catch{return{'error':_0xd518b5(0xda)};}if(!_0x2728fa['hasOwnProperty']('clientip')&&!_0x2728fa['hasOwnProperty'](_0xd518b5(0x14b))||!_0x2728fa[_0xd518b5(0x173)](_0xd518b5(0x1b0)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x2728fa[_0xd518b5(0x173)](_0xd518b5(0x14b))&&_0x2728fa[_0xd518b5(0x173)](_0xd518b5(0x117))){const {clientip:_0x532c91}=_0x2728fa;return _0x431ec9==_0x532c91?{'success':_0xd518b5(0xf6)}:{'error':_0xd518b5(0x1b1)};}else{if(_0x2728fa[_0xd518b5(0x173)](_0xd518b5(0x14b))&&_0x2728fa[_0xd518b5(0x173)](_0xd518b5(0x117))){const {username:_0x351531,clientip:_0xb04d7}=_0x2728fa;return settings['bbUsername']==_0x351531&&_0x431ec9==_0xb04d7?{'success':_0xd518b5(0xf6)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x4c3c3d=>{const _0x113e28=_0x1b21eb;if(_0x4c3c3d){const _0x3b1416=devices[_0x4c3c3d]['ip'];return jwt['sign']({'username':settings[_0x113e28(0x13e)],'clientip':_0x3b1416},secure[_0x113e28(0x190)]+_0x4c3c3d,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5e35e4=>{const _0x58f306=_0x1b21eb;if(_0x5e35e4){const _0x4aa63c=devices[_0x5e35e4]['ip'];return jwt[_0x58f306(0xe2)]({'clientip':_0x4aa63c},secure[_0x58f306(0x190)]+_0x5e35e4,{'expiresIn':devices[_0x5e35e4][_0x58f306(0x14c)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x36ad55=>{const _0x47a13=_0x1b21eb;let _0x1b7857=![];return devices[_0x36ad55][_0x47a13(0x14c)]&&devices[_0x36ad55][_0x47a13(0x14c)][_0x47a13(0x1aa)]!=_0x47a13(0x20c)&&(_0x1b7857=devices[_0x36ad55][_0x47a13(0x14c)]['clientip']==devices[_0x36ad55]['ip']&&new Date()[_0x47a13(0x150)]()-devices[_0x36ad55][_0x47a13(0x14c)]['timestamp']<devices[_0x36ad55][_0x47a13(0x14c)][_0x47a13(0x1aa)]*0x3c*0x3e8),_0x1b7857;},telegram2FaApproved=_0x4702fb=>{const _0x11bd7f=_0x1b21eb;let _0x4fe848=![];return devices[_0x4702fb][_0x11bd7f(0x212)]&&devices[_0x4702fb]['telegram2FaApproval'][_0x11bd7f(0x1aa)]!='reject'&&(_0x4fe848=devices[_0x4702fb][_0x11bd7f(0x212)]['clientip']==devices[_0x4702fb]['ip']&&new Date()['getTime']()-devices[_0x4702fb][_0x11bd7f(0x212)][_0x11bd7f(0xea)]<devices[_0x4702fb]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x4fe848;},normalizeIP=_0x19f284=>{const _0x311879=_0x1b21eb;let _0x1d8089=null,_0xba6272=null;if(ipaddr[_0x311879(0x1a9)](_0x19f284)){const _0x3c58b6=ipaddr[_0x311879(0x1bd)](_0x19f284);_0x3c58b6[_0x311879(0xf0)]()==='ipv6'?(_0x3c58b6['isIPv4MappedAddress']()&&(_0x1d8089=_0x3c58b6[_0x311879(0xe5)]()['toString']()),_0xba6272=_0x3c58b6['toString']()):(_0x1d8089=_0x3c58b6['toString'](),_0xba6272=_0x3c58b6[_0x311879(0x14e)]()[_0x311879(0xfa)]());}return{'show':_0x1d8089?_0x1d8089:_0xba6272,'store':_0xba6272};};