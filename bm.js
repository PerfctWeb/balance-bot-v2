const _0x56c46b=_0x2a63;(function(_0x52e4c1,_0x56e94b){const _0x14d892=_0x2a63,_0x17f806=_0x52e4c1();while(!![]){try{const _0x429191=-parseInt(_0x14d892(0x100))/0x1+-parseInt(_0x14d892(0x17f))/0x2*(-parseInt(_0x14d892(0xbd))/0x3)+-parseInt(_0x14d892(0x11e))/0x4*(parseInt(_0x14d892(0x248))/0x5)+parseInt(_0x14d892(0x1cb))/0x6+parseInt(_0x14d892(0x1cd))/0x7*(-parseInt(_0x14d892(0x1ba))/0x8)+-parseInt(_0x14d892(0x28d))/0x9*(parseInt(_0x14d892(0x274))/0xa)+parseInt(_0x14d892(0x234))/0xb*(parseInt(_0x14d892(0x1e4))/0xc);if(_0x429191===_0x56e94b)break;else _0x17f806['push'](_0x17f806['shift']());}catch(_0x567236){_0x17f806['push'](_0x17f806['shift']());}}}(_0x3177,0xd885b));const _0x29ce24=function(){let _0x3fc58d=!![];return function(_0x3e510a,_0x3b2062){const _0x409301=_0x3fc58d?function(){const _0x3d0b4a=_0x2a63;if(_0x3b2062){const _0x5468da=_0x3b2062[_0x3d0b4a(0x28b)](_0x3e510a,arguments);return _0x3b2062=null,_0x5468da;}}:function(){};return _0x3fc58d=![],_0x409301;};}(),_0x43df08=_0x29ce24(this,function(){const _0x589e8b=_0x2a63;return _0x43df08[_0x589e8b(0x13c)]()[_0x589e8b(0x288)](_0x589e8b(0x20b))['toString']()[_0x589e8b(0x1ce)](_0x43df08)[_0x589e8b(0x288)](_0x589e8b(0x20b));});_0x43df08();'use strict';process[_0x56c46b(0xaf)][_0x56c46b(0x14f)]=0x1;const childProcess=require(_0x56c46b(0x139)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require(_0x56c46b(0x148)),path=require(_0x56c46b(0x19d)),crypto=require(_0x56c46b(0x178)),Crypt=require(_0x56c46b(0x1b5))[_0x56c46b(0x1ec)],RSA=require(_0x56c46b(0x1b5))[_0x56c46b(0xc1)],bcrypt=require('bcryptjs'),jwt=require(_0x56c46b(0x1c5)),ipaddr=require(_0x56c46b(0x294)),argv=require('yargs/yargs')(process[_0x56c46b(0x177)][_0x56c46b(0xbc)](0x2))['argv'],uuidRandom=require(_0x56c46b(0x1eb)),{Telegraf,Markup}=require(_0x56c46b(0x1fd)),Mixpanel=require(_0x56c46b(0x285)),axios=require(_0x56c46b(0x169)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x56c46b(0x157)),{networkInterfaces}=require('os'),PORT=argv[_0x56c46b(0x18a)]||_0x56c46b(0x1c9),pattern=/^[0-9]{2,4}$/;function _0x2a63(_0xbb5b04,_0xf7c59d){const _0x27b9d4=_0x3177();return _0x2a63=function(_0x43df08,_0x29ce24){_0x43df08=_0x43df08-0x92;let _0x3177bd=_0x27b9d4[_0x43df08];return _0x3177bd;},_0x2a63(_0xbb5b04,_0xf7c59d);}!pattern[_0x56c46b(0x237)](PORT)&&(console['log'](_0x56c46b(0x10e)+PORT+_0x56c46b(0x192)),process[_0x56c46b(0x236)](0x1));const HOST=argv[_0x56c46b(0x224)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x56c46b(0x27a)];let bbpath='bb/',bbpath2='';const botfile=_0x56c46b(0x1a2),configfile=_0x56c46b(0x16e),settingsfile=_0x56c46b(0xd1),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x56c46b(0x220))[_0x56c46b(0x166)]||_0x56c46b(0x268),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x56c46b(0x245)),configpath=userID?bbpath+_0x56c46b(0xd9)+userID+'/':bbpath+_0x56c46b(0xd9),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x56c46b(0x266)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x56c46b(0x122)+userID+'/':bbpath+_0x56c46b(0x122),loggerfile=fs[_0x56c46b(0xdd)](logspath+_0x56c46b(0x270),{'flags':'a'}),temppath=userID?bbpath+_0x56c46b(0xef)+userID+'/':bbpath+_0x56c46b(0xef);!fs[_0x56c46b(0x212)](configpath)&&fs[_0x56c46b(0x240)](configpath);!fs[_0x56c46b(0x212)](configbackuppath)&&fs[_0x56c46b(0x240)](configbackuppath);!fs[_0x56c46b(0x212)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs[_0x56c46b(0x240)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x56c46b(0x147)]({'bots':[]})[_0x56c46b(0x28c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x56c46b(0x147)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x56c46b(0xd4),'onepagemode':![]}})[_0x56c46b(0x28c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x56c46b(0x147)]({'secure':{},'blacklist':[]})[_0x56c46b(0x28c)]();let crypt=new Crypt({'md':_0x56c46b(0x259),'rsaStandard':_0x56c46b(0x1ff)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x56c46b(0x254),{'host':_0x56c46b(0x118)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x56c46b(0x125)]&&(settings['telegramToken']!=''&&settings[_0x56c46b(0x125)]!=_0x56c46b(0x9c))&&settings['telegramUsername']&&settings[_0x56c46b(0x156)]!='')initTelegram();const parseColor=(_0x495226,_0x36a62f)=>{const _0x33d4cd=_0x56c46b,_0x2671b9=/#[A-Z]{3}#/g;if(typeof _0x495226==_0x33d4cd(0xab)){!_0x36a62f?_0x495226=_0x495226['replace'](_0x2671b9,''):(_0x495226=_0x495226[_0x33d4cd(0x17d)](/#BLU#/g,'\x1b[34m'),_0x495226=_0x495226[_0x33d4cd(0x17d)](/#RED#/g,'\x1b[31m'),_0x495226=_0x495226[_0x33d4cd(0x17d)](/#YEL#/g,_0x33d4cd(0xfe)),_0x495226=_0x495226['replace'](/#MAG#/g,_0x33d4cd(0x24c)),_0x495226=_0x495226[_0x33d4cd(0x17d)](/#CYA#/g,'\x1b[36m'),_0x495226=_0x495226['replace'](/#RES#/g,_0x33d4cd(0x188)));;}return _0x495226;},logger={'screen':_0x4876f1=>{const _0x4d8663=_0x56c46b;console[_0x4d8663(0x24e)](parseColor(_0x4876f1,!![]));},'simple':_0x2dcc45=>{const _0x505786=_0x56c46b;console['log'](parseColor(_0x2dcc45,!![])),loggerfile[_0x505786(0x28c)](util[_0x505786(0x14d)](parseColor(_0x2dcc45,![]))+'\x0a');},'full':async _0x3bbd17=>{const _0x2d04e8=_0x56c46b,_0x27b0aa=getTimeStamp()+_0x2d04e8(0x241)+_0x3bbd17;console['log'](parseColor(_0x27b0aa,!![])),loggerfile[_0x2d04e8(0x28c)](util[_0x2d04e8(0x14d)](parseColor(_0x27b0aa,![]))+'\x0a');if(tgBot&&settings[_0x2d04e8(0x1d4)]&&settings['telegramEvents']!=_0x2d04e8(0x15e))await sendTelegram(settings[_0x2d04e8(0x1d4)],_0x2d04e8(0x1fa)+parseColor(_0x3bbd17,![]));},'debug':async(_0x5c1894,_0x491f1d='')=>{const _0x38e625=_0x56c46b,_0xd9a207=getTimeStamp()+_0x38e625(0x132)+_0x5c1894;if(debugging)console[_0x38e625(0x24e)](parseColor(_0xd9a207,!![]));loggerfile['write'](util[_0x38e625(0x14d)](parseColor(_0xd9a207,![]))+'\x0a');if(_0x491f1d){if(debugging)console[_0x38e625(0x24e)](_0x491f1d);loggerfile[_0x38e625(0x28c)](util[_0x38e625(0x14d)](_0x491f1d)+'\x0a');}}};let terminating=![];process['on'](_0x56c46b(0x210),function(_0x31824b){const _0x32d0c6=_0x56c46b;logger[_0x32d0c6(0x99)](_0x31824b);}),process['on'](_0x56c46b(0x236),()=>{stopAllBots();}),process['on'](_0x56c46b(0x23c),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x56c46b(0x220))[_0x56c46b(0x223)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;function _0x3177(){const _0x3546b9=['initclient','file','bot-','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','-----------------------------------------------------------------------------------','login\x20required','toggleBotMode','127.0.0.1','temp/','min','access','exchange','remove','Invalid\x20authentication\x20token\x20(2)','emit','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Notifications\x20disabled','name','showConfig','::ffff:127.0.0.1','backup-full@','/update\x20-\x20update\x20Balance\x20Bot\x0a','push','\x1b[33m','writeFileSync','1065237iCZErc','2FA\x20login\x20token\x20generated','restore-backup-file','token','Disabled\x20Bot\x20','/names\x20-\x20show\x20bot\x20names\x0a','secret','updatebotmanager','getPortfolio','getDate','Unauthorized\x20attempt\x20to\x20get\x20messages','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','sendMetricsTelegram','botname','Error:\x20Invalid\x20argument\x20','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20log\x20out','kill','statSync','exp','status','store-configuration','All\x20bots','internal','api-eu.mixpanel.com','storeFiat','metrics','then','mtime','Starting\x20new\x20bot\x20|\x20Bot\x20','3800012GdzYoI','userid','sockets','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','zip/','size','Starting\x20Balance\x20Bot\x20update','telegramToken','\x20(2)','portfolio_','30\x20min','join','latestversion','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','restore_yes_','2FA\x20required','manual','reload','emitHistory','build',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','reset-history','socket','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','bot','-performance.json','child_process','lastmsgtelegram','pidRefreshToken','toString','update','listen','alias','.zip','output-000.log','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','conn','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','defaults','lowdb/adapters/FileSync','Session\x20expired\x20for\x20user\x20...','auth','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','copyFileSync','format','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','NTBA_FIX_319','getMinutes','connected','restart_','find','bbvNew','Logged\x20out\x20user\x20...','telegramUsername','express-fileupload','function','Notifications\x20enabled\x0a','split','compareSync','temporary\x20access\x20not\x20allowed','filter','orders','Unauthorized\x20login\x20attempt\x20(timeout)','generateKeyPairAsync','button','/:bot/coins','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Backup\x20file\x20unzipped\x20and\x20stored','/start','environment','Unauthorized\x20attempt\x20to\x20add\x20bot','cloneDeep','axios','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','reinstall_no','Telegraf\x20error:','debug','bb-config.json','onepagemode','new-disabled','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','toggle-bot-mode','Error\x20while\x20deleting\x20config\x20files:\x20','Yes','blacklist','botID','argv','crypto','Invalid\x20username\x20or\x20IP\x20address','decrypt','Notifications\x20disabled\x0a','tempaccess_30_','replace','sign','68HDappO','apiKey','temporary\x20access\x20timeout','running','/off\x20-\x20stop\x20bot(s)\x0a','No\x20authentication\x20token','cancel-loading','tkn','config_all','\x1b[0m','DEFLATE','port','publicKey','encryptedUuid','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','build2','apiPassword','post','get-portfolio',',\x20must\x20be\x20a\x204\x20digit\x20number','timeshift','output-001.log','fork','handshake','yes','backup-full.zip','Markdown','loginRequired','restore_no_','backup','path','telegram2FaApproval','toIPv4Address','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','order','bot.js','Unauthorized\x20attempt\x20to\x20get\x20events','exec','Bot\x20','login\x20token\x20valid','reinstall_yes','toggle','enabled','uuid','[ip-address]','add-bot','placeOrder','update-bb','restart','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','secure','getTime','2FA','request','hybrid-crypto-js','on_','Restarting\x20Bot\x20','/:bot/performance','/download/:type','5887496Qqilsu','set','title','value','readFileSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','login\x20not\x20required','auto','parse','/:bot/history','clientip','jsonwebtoken','getSeconds','All','messages','3000','socket.io','10459806CLteoa','number','14dRprtB','constructor','assign','mode','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','off','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegramChatId','backup-full','\x20|\x20user:\x20...','Restoring\x20bot(s)\x20from\x20backup','message','disconnect','text','getFullYear','send','bbvReceive','get-backup-files','Unauthorized\x20attempt\x20to\x20delete\x20alerts','(staging)','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','telegramEvents','update-bot','648HDCSxK','from','logout','\x20|\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','telegramIpApproval','remoteAddress','uuid-random','Crypt','IPv4','launch','store-settings','whitelistEnabled','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','metrics_','tempaccess_5_','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','store','headers','ipc','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','once','Bot\x20Mgr\x20>\x20','Notifications\x20enabled','randomBytes','telegraf','password','RSA-OAEP','tempaccess_15_','isValid','Invalid\x20IP\x20address','login2fa_','Ok,\x20will\x20send\x20order\x20notifications\x20only','config','node-zip','Setting\x20access:\x20','show','server','bbPassword','(((.+)+)+)+$','/restart\x20-\x20restart\x20bot(s)\x0a','stop','endsWith','new','uncaughtException','Notifications\x20types:\x20','existsSync','15\x20min','help','/help\x20-\x20show\x20available\x20commands\x0a','sortBy','login','close','temporaryAccessAllowed','#RES#\x20','bbUsername','************','private','/:bot/support','use','version.json','/enable\x20-\x20enable\x20notifications\x0a','sendMessage','version','host','generate','isIPv4MappedAddress','match','toggle_','bots','/disable\x20-\x20disable\x20notifications\x0a','Enabled\x20Bot\x20','-config.json','sendPortfolioTelegram','-results.json','referer','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Telegram\x20error:','reject','673761KgTDlA','Temporary\x20access\x20rejected','exit','test','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Starting\x20#RED#Balance\x20Bot\x20v','accept','logged\x20out','SIGINT','getMonth','sendFile','family','mkdirSync',':\x20Bot\x20Mgr\x20>\x20','All\x20bots\x20running\x20right\x20now','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','inlineKeyboard','clients','disabled','binary','5cfeCEO','temporary\x20token\x20generated','get-starting-balances','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x1b[35m','args','log','apiSecret','rmSync','map','\x20>\x20','verify','6b67f3d61ee94b8f5c80b4affef4c4d9','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','/:bot/configuration','Login\x20rejected','action','sha256','live','sort','isDirectory','off_','f2aRequired','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','resetHistory','reply','whitelist','enable','invalid\x20credentials','Your\x20installation\x20is\x20already\x20up\x20to\x20date','logs/','Starting\x20(','production','resetpw_no','length','privateKey','command','settings','hasOwnProperty','Alerts','/output-000.log','bb-secure.json','config_alerts','stopped','10FYXeOd',')\x20\x20\x20|\x20Bot\x20','Node.js\x20v','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','update_yes','timestamp','node','forEach',')\x20|\x20Bot\x20','telegramEnabled','reset-password','all','unlinkSync','telegram','expiry','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','reinstall','mixpanel','/:bot/portfolio','#RES#\x20if\x20running\x20locally\x0a','search','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Restore\x20process\x20aborted','apply','write','10884366NBUpHh','File\x20uploaded','No\x20bots\x20running\x20right\x20now','Allow\x20login\x20from\x20IP\x20address\x20','editMessageReplyMarkup','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','full','ipaddr.js','settings.','SIGTERM','alerts','Restore\x20backup\x20file\x20','success','max','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','headless','reason','confirm-message','simple','keys','ipv6','***','show-config','storeHeadless','=>\x20Go\x20to\x20#CYA#http://','createServer','params','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','#RES#\x20if\x20running\x20on\x20server','callback','startsWith','-events.json','lastmsgemitted','address','5\x20min','string','\x20|\x20client:\x20...','Unauthorized\x20attempt\x20to\x20update\x20bot','config_orders','env','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','2FA\x20login\x20required','login2fa_reject_','showname','get','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','index.html','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','stringify','backupfile','getHours','download','slice','46986xiGwVS','chat','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','notification','RSA','portfolio','event','files','hex','username','range','pidExpireLogin','login\x20token\x20generated','telegrammsg','data','started','/upload-backup','Token\x20blacklisted','get-messages','connection','bb-settings.json','type','HTML','0.0.0','/on\x20-\x20start\x20bot(s)\x0a','inherit','Access\x20enabled\x20for\x20','static','config/','padStart','botmanager','Password\x20has\x20been\x20reset\x20to:\x20','createWriteStream','Unauthorized\x20attempt\x20to\x20confirm\x20message','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','readdirSync','/metrics\x20-\x20show\x20bot\x20performance\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20delete\x20bot','hashSync','update_no','allow'];_0x3177=function(){return _0x3546b9;};return _0x3177();}let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x56c46b(0xa0)](app);app[_0x56c46b(0x21f)](fileUpload({'useTempFiles':!![]})),app[_0x56c46b(0xb4)](_0x56c46b(0x1b9),async(_0x3885c5,_0x16372a)=>{const _0x347581=_0x56c46b,_0x593d32=_0x3885c5[_0x347581(0xa1)][_0x347581(0xd2)],_0x3db094=getClientsWithBotID('botmanager'),_0x125bc2=_0x3885c5[_0x347581(0x1f6)][_0x347581(0x1aa)],_0x4277c7=timelyDecrypt(_0x125bc2,![]),_0x466829=_0x3db094[_0x347581(0x153)](_0x519691=>_0x519691[_0x347581(0x1aa)]==_0x4277c7);if(_0x466829){const _0x3d0c12=normalizeIP(_0x3885c5[_0x347581(0x135)][_0x347581(0x1ea)])[_0x347581(0x1f5)],_0x2391d8=_0x3885c5[_0x347581(0x1f6)][_0x347581(0x186)];if(validateAccess(_0x2391d8,_0x4277c7,_0x3d0c12)['allow'])_0x593d32==_0x347581(0x19c)&&await backupConfigFiles(),await zipFiles(_0x593d32),_0x16372a[_0x347581(0xbb)](zippath+(_0x593d32+_0x347581(0x140)),_0x276b10=>{const _0x4c98ea=_0x347581;_0x276b10&&(logger['full'](_0x4c98ea(0x143)+_0x593d32),logger['simple'](_0x276b10));});else logger[_0x347581(0x293)](_0x347581(0x10f)+_0x593d32+'\x20(1)');}else logger['full'](_0x347581(0x10f)+_0x593d32+_0x347581(0x126));}),app[_0x56c46b(0x190)](_0x56c46b(0xcd),async(_0x5a6eb0,_0x2eeb6a)=>{const _0x3b2b68=_0x56c46b,_0x8f6feb=getClientsWithBotID(_0x3b2b68(0xdb)),_0x13eb55=_0x5a6eb0[_0x3b2b68(0x1f6)]['uuid'],_0x347f5a=timelyDecrypt(_0x13eb55,![]),_0xb6e9ce=_0x8f6feb[_0x3b2b68(0x153)](_0x2a86fd=>_0x2a86fd[_0x3b2b68(0x1aa)]==_0x347f5a);logger[_0x3b2b68(0x16d)]('Backup\x20file\x20uploaded');if(_0xb6e9ce){const _0x3e1209=normalizeIP(_0x5a6eb0[_0x3b2b68(0x135)][_0x3b2b68(0x1ea)])[_0x3b2b68(0x1f5)],_0x6603f8=_0x5a6eb0['headers']['tkn'];if(validateAccess(_0x6603f8,_0x347f5a,_0x3e1209)[_0x3b2b68(0xe6)]){if(_0x5a6eb0[_0x3b2b68(0xc4)]){const _0x5f204a=_0x5a6eb0[_0x3b2b68(0xc4)][_0x3b2b68(0xb9)];await _0x5f204a['mv'](temppath+_0x5f204a[_0x3b2b68(0xf8)]),_0x2eeb6a[_0x3b2b68(0x1dc)]({'status':!![],'message':_0x3b2b68(0x28e)});const _0x418f44=getBotsWithMode();_0x418f44[_0x3b2b68(0x26a)]>0x0?confirmRestore(temppath,_0x5f204a[_0x3b2b68(0xf8)]):unzipFile(temppath,_0x5f204a[_0x3b2b68(0xf8)]);}}else logger[_0x3b2b68(0x293)](_0x3b2b68(0x292));}else logger[_0x3b2b68(0x293)](_0x3b2b68(0x238));}),app[_0x56c46b(0x21f)](express[_0x56c46b(0xd8)](path[_0x56c46b(0x129)](__dirname,bbpath2,_0x56c46b(0x18e)))),app[_0x56c46b(0x21f)](express[_0x56c46b(0xd8)](path['join'](__dirname,bbpath2,'build'))),app[_0x56c46b(0xb4)]('/',function(_0x4ab964,_0x28ee64){const _0xe0cd4e=_0x56c46b;_0x28ee64[_0xe0cd4e(0x23e)](path[_0xe0cd4e(0x129)](__dirname,bbpath2,_0xe0cd4e(0x18e),_0xe0cd4e(0xb6)));}),app[_0x56c46b(0xb4)]('/:bot',function(_0x1da4d6,_0x594998){const _0x5964c1=_0x56c46b;_0x594998[_0x5964c1(0x23e)](path['join'](__dirname,bbpath2,_0x5964c1(0x131),_0x5964c1(0xb6)));}),app[_0x56c46b(0xb4)](_0x56c46b(0x286),(_0x595cc8,_0xc05267)=>{const _0x14964f=_0x56c46b;_0xc05267[_0x14964f(0x23e)](path[_0x14964f(0x129)](__dirname,bbpath2,_0x14964f(0x131),'index.html'));}),app['get'](_0x56c46b(0x1b8),(_0x4797f5,_0x5f2d3d)=>{const _0x27ee9a=_0x56c46b;_0x5f2d3d[_0x27ee9a(0x23e)](path[_0x27ee9a(0x129)](__dirname,bbpath2,_0x27ee9a(0x131),_0x27ee9a(0xb6)));}),app[_0x56c46b(0xb4)](_0x56c46b(0x162),(_0x20e80c,_0x42d8b1)=>{const _0x181591=_0x56c46b;_0x42d8b1[_0x181591(0x23e)](path[_0x181591(0x129)](__dirname,bbpath2,_0x181591(0x131),_0x181591(0xb6)));}),app[_0x56c46b(0xb4)](_0x56c46b(0x1c3),(_0x316425,_0x496c44)=>{const _0x5987b2=_0x56c46b;_0x496c44[_0x5987b2(0x23e)](path[_0x5987b2(0x129)](__dirname,bbpath2,_0x5987b2(0x131),_0x5987b2(0xb6)));}),app[_0x56c46b(0xb4)](_0x56c46b(0x256),(_0x2d6288,_0x49edbe)=>{const _0x300976=_0x56c46b;_0x49edbe[_0x300976(0x23e)](path[_0x300976(0x129)](__dirname,bbpath2,'build',_0x300976(0xb6)));}),app['get'](_0x56c46b(0x21e),(_0x1318de,_0x585c30)=>{const _0x3e7e91=_0x56c46b;_0x585c30[_0x3e7e91(0x23e)](path[_0x3e7e91(0x129)](__dirname,bbpath2,_0x3e7e91(0x131),_0x3e7e91(0xb6)));});if(HOST)http[_0x56c46b(0x13e)](PORT,HOST);else http[_0x56c46b(0x13e)](PORT);const io=require(_0x56c46b(0x1ca))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x44c6f8=_0x56c46b;let _0x4cf058=_0x44c6f8(0x1ab);const _0x3af3dc=networkInterfaces(),_0x9f9754={};for(const _0x41fda4 of Object[_0x44c6f8(0x9a)](_0x3af3dc)){for(const _0x2db968 of _0x3af3dc[_0x41fda4]){if((_0x2db968[_0x44c6f8(0x23f)]==_0x44c6f8(0x1ed)||_0x2db968[_0x44c6f8(0x23f)]==0x4)&&!_0x2db968[_0x44c6f8(0x117)]){const _0x3f7517=ipaddr[_0x44c6f8(0x1c2)](_0x2db968[_0x44c6f8(0xa9)])[_0x44c6f8(0xc7)]();_0x3f7517!=_0x44c6f8(0x21d)&&(!_0x9f9754[_0x41fda4]&&(_0x9f9754[_0x41fda4]=[]),_0x9f9754[_0x41fda4][_0x44c6f8(0xfd)](_0x2db968['address']),_0x4cf058=_0x2db968['address']);}}}return{'serverip':_0x4cf058,'netinterfaces':_0x9f9754};}async function startServer(){const _0x27aa82=_0x56c46b,{serverip:_0x4cc7e3,netinterfaces:_0x5a89be}=getServerIP();logger[_0x27aa82(0x99)](''),logger[_0x27aa82(0x99)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x27aa82(0x239)+serverversion+_0x27aa82(0x21a)+(environment=='staging'?_0x27aa82(0x1e0):'')+'\x0a'+(_0x27aa82(0x1e1)+PORT+_0x27aa82(0x287))+(_0x27aa82(0x9f)+_0x4cc7e3+':'+PORT+_0x27aa82(0xa4))),logger[_0x27aa82(0x99)](_0x27aa82(0xeb));if(config[_0x27aa82(0x26a)]!=0x0)for(const _0x489b71 of config){const _0x221b8d=_0x489b71[_0x27aa82(0x1d0)]==_0x27aa82(0x1c1)?'a':'m';if(_0x489b71['status']=='enabled'||_0x489b71[_0x27aa82(0x114)]==_0x27aa82(0x20f))await logger[_0x27aa82(0x293)](_0x27aa82(0x267)+_0x221b8d+_0x27aa82(0x27c)+_0x489b71['botID']+_0x27aa82(0x1e7)+_0x489b71['botname']),startBot([_0x489b71['botID'],userID],{'cwd':bbpath},function(_0x354966){if(_0x354966)logger['full'](_0x354966);});else(_0x489b71[_0x27aa82(0x114)]==_0x27aa82(0x246)||_0x489b71[_0x27aa82(0x114)]==_0x27aa82(0x170))&&await logger[_0x27aa82(0x293)]('Idling\x20('+_0x221b8d+_0x27aa82(0x275)+_0x489b71[_0x27aa82(0x176)]+_0x27aa82(0x1e7)+_0x489b71[_0x27aa82(0x10d)]);}else!newBot&&logger[_0x27aa82(0x99)](_0x27aa82(0x1a0));if(newBot)addBot();logger['simple'](_0x27aa82(0xeb)),logger['simple'](''),await logger[_0x27aa82(0x16d)](_0x27aa82(0x276)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x5a89be);}function startSocket(){const _0x39e084=_0x56c46b;io['on'](_0x39e084(0xd0),_0x305098=>{const _0x19d970=_0x39e084;let _0x261e01,_0x2928d2,_0x4d5a54,_0x770250,_0x3042db;const _0x5e8b23=_0x305098[_0x19d970(0x196)][_0x19d970(0x1f6)][_0x19d970(0x22f)];_0x2928d2=_0x5e8b23[_0x19d970(0x227)](/bot[0-9]{3}/);if(_0x2928d2)_0x4d5a54=_0x2928d2[0x0]['match'](/[0-9]{3}/);if(_0x4d5a54)_0x261e01=_0x4d5a54[0x0];else _0x261e01=_0x19d970(0xdb);const _0x44741a=_0x305098[_0x19d970(0x196)][_0x19d970(0x14a)][_0x19d970(0x18c)];if(!_0x44741a)_0x305098['emit'](_0x19d970(0x114),{'publicKey':secure['publicKey']});else{_0x770250=timelyDecrypt(_0x44741a,![]);if(!_0x770250)_0x305098[_0x19d970(0xf5)](_0x19d970(0x114),{'publicKey':secure[_0x19d970(0x18b)]});else{_0x3042db=normalizeIP(_0x305098[_0x19d970(0x145)][_0x19d970(0x1ea)])[_0x19d970(0x1f5)];if(!devices[_0x770250])devices[_0x770250]={'uuid':_0x770250,'access':{'token':null}};devices[_0x770250]['ip']=_0x3042db;const _0x44248b=addClient(_0x305098['id'],_0x770250,_0x261e01);setAccess(_0x44248b),emitMessages(),_0x305098['on'](_0x19d970(0x217),_0x537062=>{const _0x29b83b=_0x19d970,_0x5286b1=timelyDecrypt(_0x537062[_0x29b83b(0x1fe)]);if(_0x5286b1){_0x537062={'username':_0x537062[_0x29b83b(0xc6)],'password':_0x5286b1},devices[_0x770250][_0x29b83b(0xf1)]=validateCredentials(_0x537062,_0x770250);if(devices[_0x770250]['access'][_0x29b83b(0xe6)]==![]&&devices[_0x770250][_0x29b83b(0xf1)][_0x29b83b(0x97)]=='2FA\x20login\x20required')_0x305098[_0x29b83b(0xf5)](_0x29b83b(0x114),{'access':devices[_0x770250][_0x29b83b(0xf1)]}),loginAccess2FA(_0x770250,_0x3042db);else{if(devices[_0x770250][_0x29b83b(0xf1)][_0x29b83b(0xe6)]==![]&&devices[_0x770250]['access']['reason']=='invalid\x20credentials')_0x305098[_0x29b83b(0xf5)](_0x29b83b(0x114),{'access':devices[_0x770250][_0x29b83b(0xf1)]});else devices[_0x770250][_0x29b83b(0xf1)][_0x29b83b(0xe6)]&&devices[_0x770250][_0x29b83b(0xf1)][_0x29b83b(0x97)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x770250)['forEach'](_0x42cdb0=>{setAccess(_0x42cdb0);}),logger[_0x29b83b(0x16d)]('Logged\x20in\x20user\x20...'+_0x770250[_0x29b83b(0xbc)](-0x8)),setTokenRefresh(_0x770250),setSessionTimeout('login',_0x770250));}}else logger[_0x29b83b(0x293)](_0x29b83b(0x15f));}),_0x305098['on'](_0x19d970(0x27e),()=>{resetPassword();}),_0x305098['on'](_0x19d970(0x1d9),_0x26b236=>{removeClient(_0x305098['id']);}),_0x261e01==_0x19d970(0xdb)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x37b4a1){const _0x5a4d8e=_0x56c46b;if(_0x37b4a1!=_0x5a4d8e(0xdb)&&config[_0x5a4d8e(0x180)]!=''){if(pid[_0x37b4a1])pid[_0x37b4a1][_0x5a4d8e(0x1dc)]({'function':_0x5a4d8e(0xe7),'args':null});}_0x37b4a1!=_0x5a4d8e(0xdb)&&broadcastToBots(_0x5a4d8e(0x229),JSON[_0x5a4d8e(0xb8)](config));}function reloadBotManager(){const _0x272c8c=_0x56c46b;getClientsWithBotID('botmanager')[_0x272c8c(0x27b)](_0x46545c=>{const _0x21b91d=_0x272c8c;getSocket(_0x46545c['id'])[_0x21b91d(0xf5)]('status',{'access':{'allow':![],'reason':_0x21b91d(0x12f),'token':null}});});}function getSocket(_0x36c383){const _0x22439f=_0x56c46b;return io[_0x22439f(0x120)]['sockets']['get'](_0x36c383);}function setAccess(_0x23a94d){const _0x4600ef=_0x56c46b,_0xf95ea8=getSocket(_0x23a94d['id']),_0x5dc98e=_0x23a94d[_0x4600ef(0x1aa)],_0x27fbe8=_0x23a94d[_0x4600ef(0x137)];devices[_0x5dc98e]['access']=validateAccess(devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0x103)],_0x5dc98e),logger[_0x4600ef(0x16d)](_0x4600ef(0x207)+devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0x97)]+_0x4600ef(0xac)+_0x23a94d['id']['slice'](-0x8)+_0x4600ef(0x1d6)+_0x5dc98e[_0x4600ef(0xbc)](-0x8)),_0xf95ea8[_0x4600ef(0x129)](_0x5dc98e);if(devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0xe6)]){_0xf95ea8[_0x4600ef(0x129)](_0x27fbe8);if(_0x27fbe8==_0x4600ef(0xdb))initializeSocketBotManager(_0xf95ea8);else initializeSocketBot(_0xf95ea8);initClient(_0x27fbe8);}devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0x103)]&&devices[_0x5dc98e][_0x4600ef(0xf1)]['reason']==_0x4600ef(0x249)&&setSessionTimeout(_0x4600ef(0x1b3),_0x5dc98e),devices[_0x5dc98e]['access'][_0x4600ef(0x103)]&&devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0x97)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4600ef(0x217),_0x5dc98e),_0xf95ea8[_0x4600ef(0xf5)](_0x4600ef(0x114),{'status':_0x23a94d[_0x4600ef(0x209)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5dc98e]['access'],'externalip':devices[_0x5dc98e]['ip'],'publicKey':secure[_0x4600ef(0x18b)],'userid':settings[_0x4600ef(0x11f)],'validInstallation':validInstallation}),devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0xe6)]==![]&&devices[_0x5dc98e][_0x4600ef(0xf1)][_0x4600ef(0x97)]==_0x4600ef(0x12d)&&temporaryAccess2FA(_0x5dc98e,devices[_0x5dc98e]['ip']);}function setSessionTimeout(_0x5f450e,_0x525af8){const _0xb211a7=_0x56c46b;let _0x485d4d;if(_0x5f450e==_0xb211a7(0x217))_0x485d4d=loginExpiry*0x3c*0x3e8;else _0x485d4d=devices[_0x525af8]['telegramIpApproval'][_0xb211a7(0x282)]*0x3c*0x3e8-(new Date()[_0xb211a7(0x1b2)]()-devices[_0x525af8]['telegramIpApproval']['timestamp']);if(devices[_0x525af8][_0xb211a7(0xc8)])clearTimeout(devices[_0x525af8][_0xb211a7(0xc8)]);devices[_0x525af8][_0xb211a7(0xc8)]=setTimeout(()=>{const _0x4264f7=_0xb211a7;if(devices[_0x525af8][_0x4264f7(0x13b)])clearTimeout(devices[_0x525af8][_0x4264f7(0x13b)]);removeSocketListeners(_0x525af8),addBlacklist(_0x525af8),devices[_0x525af8]['telegramIpApproval']=null,devices[_0x525af8][_0x4264f7(0x19e)]=null,devices[_0x525af8][_0x4264f7(0xf1)]['token']=null,logger['debug'](_0x4264f7(0x149)+_0x525af8[_0x4264f7(0xbc)](-0x8)),devices[_0x525af8][_0x4264f7(0xf1)]=validateAccess(devices[_0x525af8]['access']['token'],_0x525af8),!(devices[_0x525af8]['access'][_0x4264f7(0xe6)]&&devices[_0x525af8][_0x4264f7(0xf1)]['reason']==_0x4264f7(0x1c0))&&(_0x5f450e==_0x4264f7(0x217)?io['to'](_0x525af8)['emit'](_0x4264f7(0x114),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x525af8)[_0x4264f7(0xf5)](_0x4264f7(0x114),{'access':{'allow':![],'reason':_0x4264f7(0x181),'token':null}})),devices[_0x525af8][_0x4264f7(0xf1)][_0x4264f7(0x103)]=null;},_0x485d4d);}function setTokenRefresh(_0x1d67b9){const _0x302a16=_0x56c46b;if(devices[_0x1d67b9][_0x302a16(0x13b)])clearTimeout(devices[_0x1d67b9][_0x302a16(0x13b)]);devices[_0x1d67b9]['pidRefreshToken']=setTimeout(()=>{const _0x168871=_0x302a16;getClientsWithUuid(_0x1d67b9)['length']!=0x0?(devices[_0x1d67b9][_0x168871(0xf1)]=refreshToken(_0x1d67b9),io['to'](_0x1d67b9)[_0x168871(0xf5)](_0x168871(0x114),{'status':_0x168871(0x151),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1d67b9][_0x168871(0xf1)],'externalip':devices[_0x1d67b9]['ip'],'publicKey':secure[_0x168871(0x18b)],'validInstallation':validInstallation}),setTokenRefresh(_0x1d67b9)):clearTimeout(devices[_0x1d67b9][_0x168871(0x13b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5f38c7){const _0x49b9ab=_0x56c46b,_0x7489d3=getClient(_0x5f38c7['id'])[_0x49b9ab(0x1aa)];_0x5f38c7[_0x49b9ab(0xf5)](_0x49b9ab(0x229),config),_0x5f38c7['emit'](_0x49b9ab(0x26d),cleanSettings()),_0x5f38c7['on'](_0x49b9ab(0x1ac),_0x214b98=>{const _0x397509=_0x49b9ab;if(validateAccess(_0x214b98,_0x7489d3)[_0x397509(0xe6)])addBot();else logger[_0x397509(0x293)](_0x397509(0x167));}),_0x5f38c7['on'](_0x49b9ab(0x1e3),(_0x24d26d,_0x3a9055)=>{const _0x34b219=_0x49b9ab;if(validateAccess(_0x3a9055,_0x7489d3)[_0x34b219(0xe6)])toggleBot(_0x24d26d[_0x34b219(0x176)],_0x24d26d['status'],_0x24d26d[_0x34b219(0x25a)]);else logger[_0x34b219(0x293)](_0x34b219(0xad));}),_0x5f38c7['on'](_0x49b9ab(0x172),(_0x27c342,_0x4106b5)=>{const _0x3afbbf=_0x49b9ab;if(validateAccess(_0x4106b5,_0x7489d3)['allow'])toggleBotMode(_0x27c342);else logger[_0x3afbbf(0x293)](_0x3afbbf(0xad));}),_0x5f38c7['on']('delete-bot',(_0x4c1fee,_0x3d5e9c)=>{const _0x21ffc3=_0x49b9ab;if(validateAccess(_0x3d5e9c,_0x7489d3)[_0x21ffc3(0xe6)])deleteBot(_0x4c1fee);else logger[_0x21ffc3(0x293)](_0x21ffc3(0xe3));}),_0x5f38c7['on'](_0x49b9ab(0x1ef),(_0x33157a,_0x7a2447)=>{const _0x534574=_0x49b9ab;if(validateAccess(_0x7a2447,_0x7489d3)['allow'])storeSettings(_0x33157a,!![]);else logger[_0x534574(0x293)](_0x534574(0xe2));}),_0x5f38c7['on']('update-bb',_0x352685=>{const _0x3d18c5=_0x49b9ab;if(validateAccess(_0x352685,_0x7489d3)['allow'])updateBB('update');else logger[_0x3d18c5(0x293)](_0x3d18c5(0x18d));}),_0x5f38c7['on']('reinstall-bb',_0x173bde=>{const _0x203d8e=_0x49b9ab;if(validateAccess(_0x173bde,_0x7489d3)[_0x203d8e(0xe6)])updateBB(_0x203d8e(0x284));else logger[_0x203d8e(0x293)](_0x203d8e(0x230));}),_0x5f38c7['on'](_0x49b9ab(0x1de),_0x4fe8c3=>{const _0x196401=_0x49b9ab;if(validateAccess(_0x4fe8c3,_0x7489d3)[_0x196401(0xe6)]){const _0x1e3266=getClient(_0x5f38c7['id']);if(_0x1e3266)getBackupFiles(_0x1e3266[_0x196401(0x1aa)]);else logger[_0x196401(0x293)](_0x196401(0x121));}else logger[_0x196401(0x293)](_0x196401(0x24b));}),_0x5f38c7['on'](_0x49b9ab(0x102),(_0x1d3044,_0x5127f9)=>{const _0x183642=_0x49b9ab;if(validateAccess(_0x5127f9,_0x7489d3)['allow'])restoreBackupFile(_0x1d3044);else logger[_0x183642(0x293)](_0x183642(0x1f8));}),_0x5f38c7['on'](_0x49b9ab(0xcf),_0x17784b=>{const _0x2b88ca=_0x49b9ab;if(validateAccess(_0x17784b,_0x7489d3)['allow'])getMessages();else logger[_0x2b88ca(0x293)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5f38c7['on'](_0x49b9ab(0x98),(_0x422b2f,_0x463098)=>{const _0x5e7320=_0x49b9ab;if(validateAccess(_0x463098,_0x7489d3)[_0x5e7320(0xe6)])confirmMessage(_0x422b2f);else logger[_0x5e7320(0x293)](_0x5e7320(0xde));}),_0x5f38c7['on'](_0x49b9ab(0x1e6),_0x411960=>{const _0x5dfbe1=_0x49b9ab;if(validateAccess(_0x411960,_0x7489d3)[_0x5dfbe1(0xe6)]){if(devices[_0x7489d3]['pidRefreshToken'])clearTimeout(devices[_0x7489d3][_0x5dfbe1(0x13b)]);if(devices[_0x7489d3]['pidExpireLogin'])clearTimeout(devices[_0x7489d3][_0x5dfbe1(0xc8)]);removeSocketListeners(getClient(_0x5f38c7['id'])[_0x5dfbe1(0x1aa)]),addBlacklist(_0x7489d3),devices[_0x7489d3][_0x5dfbe1(0x1e9)]=null,devices[_0x7489d3]['telegram2FaApproval']=null,devices[_0x7489d3][_0x5dfbe1(0xf1)]['token']=null,logger[_0x5dfbe1(0x16d)](_0x5dfbe1(0x155)+_0x7489d3[_0x5dfbe1(0xbc)](-0x8)),io['to'](getClient(_0x5f38c7['id'])[_0x5dfbe1(0x1aa)])['emit']('status',{'access':{'allow':![],'reason':_0x5dfbe1(0x23b),'token':null}});}else logger[_0x5dfbe1(0x293)](_0x5dfbe1(0x110));});}function initializeSocketBot(_0x47f9d9){const _0x261744=_0x56c46b,_0x4686c5=getClient(_0x47f9d9['id'])['bot'],_0x301ed9=getClient(_0x47f9d9['id'])[_0x261744(0x1aa)];_0x47f9d9['on']('get-logs',(_0x3effc8,_0x3a8409)=>{const _0x22d450=_0x261744;if(validateAccess(_0x3a8409,_0x301ed9)[_0x22d450(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x22d450(0x1dc)]({'function':_0x22d450(0x130),'args':_0x3effc8});}else logger[_0x22d450(0x293)](_0x22d450(0x1a3));}),_0x47f9d9['on']('delete-alerts',(_0x1a6527,_0x5aea52)=>{const _0x496916=_0x261744;if(validateAccess(_0x5aea52,_0x301ed9)['allow']){if(pid[_0x4686c5])pid[_0x4686c5][_0x496916(0x1dc)]({'function':'deleteHistoryAlerts','args':_0x1a6527});}else logger[_0x496916(0x293)](_0x496916(0x1df));}),_0x47f9d9['on'](_0x261744(0x191),(_0x107c8a,_0x6ead2b)=>{const _0x367430=_0x261744;if(validateAccess(_0x6ead2b,_0x301ed9)['allow']){if(pid[_0x4686c5])pid[_0x4686c5][_0x367430(0x1dc)]({'function':_0x367430(0x108),'args':_0x107c8a});}else logger['full'](_0x367430(0x144));}),_0x47f9d9['on'](_0x261744(0x115),(_0x41d3fa,_0x9f170)=>{const _0x2e9624=_0x261744;if(validateAccess(_0x9f170,_0x301ed9)[_0x2e9624(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5]['send']({'function':'storeConfiguration','args':_0x41d3fa});}else logger[_0x2e9624(0x293)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x47f9d9['on']('store-headless',(_0x224172,_0x12a9ab)=>{const _0x3111ba=_0x261744;if(validateAccess(_0x12a9ab,_0x301ed9)[_0x3111ba(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x3111ba(0x1dc)]({'function':_0x3111ba(0x9e),'args':_0x224172});}else logger[_0x3111ba(0x293)](_0x3111ba(0xb5));}),_0x47f9d9['on']('store-fiat',(_0x329707,_0x83f70d)=>{const _0x492fd5=_0x261744;if(validateAccess(_0x83f70d,_0x301ed9)[_0x492fd5(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x492fd5(0x1dc)]({'function':_0x492fd5(0x119),'args':_0x329707});}else logger['full'](_0x492fd5(0x16a));}),_0x47f9d9['on'](_0x261744(0x134),_0x12d979=>{const _0x223264=_0x261744;if(validateAccess(_0x12d979,_0x301ed9)[_0x223264(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x223264(0x1dc)]({'function':_0x223264(0x260),'args':null});}else logger[_0x223264(0x293)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x47f9d9['on'](_0x261744(0x24a),_0x58911f=>{const _0x274501=_0x261744;if(validateAccess(_0x58911f,_0x301ed9)[_0x274501(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x274501(0x1dc)]({'function':'getStartingBalances','args':null});}else logger[_0x274501(0x293)](_0x274501(0x231));}),_0x47f9d9['on']('place-order',(_0x2fced2,_0x170608)=>{const _0x610336=_0x261744;if(validateAccess(_0x170608,_0x301ed9)[_0x610336(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5]['send']({'function':_0x610336(0x1ad),'args':_0x2fced2});}else logger[_0x610336(0x293)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x47f9d9['on'](_0x261744(0x185),_0x4d2151=>{const _0x533506=_0x261744;if(validateAccess(_0x4d2151,_0x301ed9)[_0x533506(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x533506(0x1dc)]({'function':'cancelLoading','args':null});}else logger[_0x533506(0x293)](_0x533506(0x95));}),_0x47f9d9['on'](_0x261744(0x9d),_0x238731=>{const _0x5d7272=_0x261744;if(validateAccess(_0x238731,_0x301ed9)[_0x5d7272(0xe6)]){if(pid[_0x4686c5])pid[_0x4686c5][_0x5d7272(0x1dc)]({'function':_0x5d7272(0xf9),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x47f9d9['on'](_0x261744(0x1ae),_0xbdd77b=>{const _0x4bf393=_0x261744;if(validateAccess(_0xbdd77b,_0x301ed9)[_0x4bf393(0xe6)])updateBB(_0x4bf393(0x13d));else logger[_0x4bf393(0x293)](_0x4bf393(0x18d));}),_0x47f9d9['on'](_0x261744(0xcf),_0x6b0f03=>{const _0x2d924b=_0x261744;if(validateAccess(_0x6b0f03,_0x301ed9)[_0x2d924b(0xe6)])getMessages();else logger['full'](_0x2d924b(0x10a));}),_0x47f9d9['on'](_0x261744(0x98),(_0x3c40ae,_0x5c88a0)=>{const _0x2bfe6a=_0x261744;if(validateAccess(_0x5c88a0,_0x301ed9)['allow'])confirmMessage(_0x3c40ae);else logger[_0x2bfe6a(0x293)](_0x2bfe6a(0xde));}),_0x47f9d9['on']('logout',_0x32b09a=>{const _0x58ea02=_0x261744;if(validateAccess(_0x32b09a,_0x301ed9)[_0x58ea02(0xe6)]){if(devices[_0x301ed9][_0x58ea02(0x13b)])clearTimeout(devices[_0x301ed9][_0x58ea02(0x13b)]);if(devices[_0x301ed9][_0x58ea02(0xc8)])clearTimeout(devices[_0x301ed9][_0x58ea02(0xc8)]);removeSocketListeners(getClient(_0x47f9d9['id'])[_0x58ea02(0x1aa)]),addBlacklist(_0x301ed9),devices[_0x301ed9]['telegramIpApproval']=null,devices[_0x301ed9][_0x58ea02(0x19e)]=null,devices[_0x301ed9][_0x58ea02(0xf1)][_0x58ea02(0x103)]=null,logger[_0x58ea02(0x16d)](_0x58ea02(0x155)+_0x301ed9[_0x58ea02(0xbc)](-0x8)),io['to'](getClient(_0x47f9d9['id'])['uuid'])[_0x58ea02(0xf5)](_0x58ea02(0x114),{'access':{'allow':![],'reason':_0x58ea02(0x23b),'token':null}});}else logger[_0x58ea02(0x293)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4af2d0){const _0x528c05=_0x56c46b;getClientsWithUuid(_0x4af2d0)[_0x528c05(0x27b)](_0x25dd17=>{getSocket(_0x25dd17['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5bd50f=_0x56c46b;let _0x2ed28a=settings;return settings[_0x5bd50f(0x125)]&&settings['telegramToken']!=''&&(_0x2ed28a={..._0x2ed28a,'telegramToken':_0x5bd50f(0x21c)}),settings[_0x5bd50f(0x20a)]&&settings[_0x5bd50f(0x20a)]!=''&&(_0x2ed28a={..._0x2ed28a,'bbPassword':_0x5bd50f(0x21c)}),(settings[_0x5bd50f(0x20a)]&&settings['bbPassword']==_0x5bd50f(0x9c)||settings[_0x5bd50f(0x125)]&&settings[_0x5bd50f(0x125)]==_0x5bd50f(0x9c))&&(_0x2ed28a={..._0x2ed28a,'restored':{'password':settings[_0x5bd50f(0x20a)]==_0x5bd50f(0x9c),'telegram':settings[_0x5bd50f(0x125)]==_0x5bd50f(0x9c)}}),_0x2ed28a;}async function updateBB(_0x25206a){const _0x5b1d12=_0x56c46b;await backupConfigFiles(),installingUpdate=!![],config[_0x5b1d12(0x27b)](_0x92f1d0=>{restartBot(_0x92f1d0['botID']);});if(_0x25206a=='update')process[_0x5b1d12(0x1dc)]({'update':!![],'environment':environment},_0x54c2b1=>{});else _0x25206a=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0xf7a4cd=>{});}function startBot(_0x49b01b,_0x4ee9da,_0x499164){const _0x36b423=_0x56c46b;if(debugging)_0x49b01b[_0x36b423(0xfd)]('-d');let _0x35c292=![];const _0x4c816c=_0x49b01b[0x0];_0x4ee9da={..._0x4ee9da,'stdio':[_0x36b423(0xd6),_0x36b423(0xd6),_0x36b423(0xd6),_0x36b423(0x1f7)]},pid[_0x4c816c]=childProcess[_0x36b423(0x195)](botfile,_0x49b01b,_0x4ee9da),pid[_0x4c816c]['on'](_0x36b423(0x1d8),_0x3e89d9=>{const _0x464b58=_0x36b423;switch(Object['keys'](_0x3e89d9)[0x0]){case'botname':updateBotName(_0x4c816c,_0x3e89d9[_0x464b58(0x10d)]);break;case _0x464b58(0x107):updateBotManager();break;case _0x464b58(0x114):updateStatus(_0x4c816c,_0x3e89d9[_0x464b58(0x114)]);break;case _0x464b58(0x25a):updateLive(_0x4c816c,_0x3e89d9[_0x464b58(0x25a)]);break;case _0x464b58(0xcc):updateLive(_0x4c816c,_0x3e89d9['started']),io['to'](_0x4c816c)[_0x464b58(0xf5)](_0x464b58(0x114),{'access':{'allow':![],'reason':_0x464b58(0x12f),'token':null}});break;case _0x464b58(0x20d):_0x3e89d9[_0x464b58(0x20d)]=='restart'&&restartBot(_0x4c816c);_0x3e89d9[_0x464b58(0x20d)]==_0x464b58(0x111)&&toggleBot(_0x4c816c,_0x464b58(0x246),'stopped');break;case _0x464b58(0x281):sendTelegramBot(_0x4c816c,_0x3e89d9[_0x464b58(0x281)]);break;case _0x464b58(0xca):sendTelegramMsg(_0x3e89d9[_0x464b58(0xca)]);break;case _0x464b58(0x158):io['to'](_0x4c816c)['emit'](_0x3e89d9[_0x464b58(0x158)],_0x3e89d9[_0x464b58(0x24d)]);break;}}),pid[_0x4c816c]['on']('error',function(_0x3a870b){if(_0x35c292)return;_0x35c292=!![],_0x499164(_0x3a870b);}),pid[_0x4c816c]['on'](_0x36b423(0x236),async function(_0x4fdb05){const _0x823729=_0x36b423;if(terminating)return;if(installingUpdate){logger[_0x823729(0x16d)](_0x823729(0x12b)),io[_0x823729(0x218)]();return;}if(_0x35c292)return;_0x35c292=!![],_0x499164(null);const _0x42229a=dbConfig[_0x823729(0xb4)](_0x823729(0x229))['find']({'botID':_0x4c816c})['value']();_0x42229a&&(_0x42229a[_0x823729(0x114)]==_0x823729(0x1a9)||_0x42229a[_0x823729(0x114)]=='new')&&(await sleep(0x3e8),updateLive(_0x4c816c,_0x823729(0x273)),logger[_0x823729(0x293)](_0x823729(0x1b7)+_0x4c816c),startBot([_0x4c816c,userID],{'cwd':bbpath},function(_0x140ce7){const _0xccd7fe=_0x823729;if(_0x140ce7)logger[_0xccd7fe(0x293)](_0x140ce7);}));});}function stopBot(_0x40e2c4){const _0x14c14c=_0x56c46b;getClientsWithBotID(_0x40e2c4)[_0x14c14c(0x27b)](_0x575390=>{const _0x9211f4=_0x14c14c;getSocket(_0x575390['id'])[_0x9211f4(0x1d9)](!![]),removeClient(_0x575390['id']);}),pid[_0x40e2c4]&&(pid[_0x40e2c4][_0x14c14c(0x111)](),pid[_0x40e2c4]=null);}function stopAllBots(){const _0x4395c0=_0x56c46b;terminating=!![];const _0x2c0220=getEnabledBots();_0x2c0220[_0x4395c0(0x27b)](_0x225fb1=>{const _0x2327f4=_0x4395c0;stopBot(_0x225fb1[_0x2327f4(0x176)]);});}function restartBot(_0x209534){if(pid[_0x209534])pid[_0x209534]['kill']();}function addBot(){const _0x5db6ee=_0x56c46b;let _0x3c0bcc;for(let _0x33314b=0x1;_0x33314b<0x3e9;_0x33314b++){_0x3c0bcc=_0x33314b[_0x5db6ee(0x13c)]()[_0x5db6ee(0xda)](0x3,'0');let _0x418f28=config['find'](_0xa91fbc=>_0xa91fbc['botID']==_0x3c0bcc);if(!_0x418f28)break;}if(_0x3c0bcc==='1000'){logger[_0x5db6ee(0x293)](_0x5db6ee(0x1d3));return;}logger[_0x5db6ee(0x293)](_0x5db6ee(0x11d)+_0x3c0bcc),dbConfig[_0x5db6ee(0xb4)](_0x5db6ee(0x229))[_0x5db6ee(0xfd)]({'botID':_0x3c0bcc,'botname':_0x5db6ee(0x1a5)+_0x3c0bcc,'status':_0x5db6ee(0x20f),'live':''})[_0x5db6ee(0x28c)](),startBot([_0x3c0bcc,userID],{'cwd':bbpath},function(_0x2f6119){const _0x84024e=_0x5db6ee;if(_0x2f6119)logger[_0x84024e(0x293)](_0x2f6119);}),config=getConfiguration(),io['to'](_0x5db6ee(0xdb))[_0x5db6ee(0xf5)](_0x5db6ee(0x229),config),broadcastToBots('bots',JSON[_0x5db6ee(0xb8)](config));}function deleteBot(_0x5b13a4){const _0x5ec6a3=_0x56c46b;getClientsWithBotID(_0x5b13a4)[_0x5ec6a3(0x27b)](_0x54f237=>{const _0x28ea95=_0x5ec6a3;getSocket(_0x54f237['id'])[_0x28ea95(0x1d9)](!![]),removeClient(_0x54f237['id']);}),dbConfig[_0x5ec6a3(0xb4)](_0x5ec6a3(0x229))[_0x5ec6a3(0xf3)]({'botID':_0x5b13a4})['write'](),logger[_0x5ec6a3(0x293)]('Deleted\x20Bot\x20'+_0x5b13a4),stopBot(_0x5b13a4);try{if(fs[_0x5ec6a3(0x212)](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+_0x5ec6a3(0x22c))))fs[_0x5ec6a3(0x280)](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+'-config.json'));if(fs['existsSync'](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+'-events.json')))fs['unlinkSync'](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+_0x5ec6a3(0xa7)));if(fs[_0x5ec6a3(0x212)](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+_0x5ec6a3(0x138))))fs[_0x5ec6a3(0x280)](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+'-performance.json'));if(fs[_0x5ec6a3(0x212)](path[_0x5ec6a3(0x129)](configpath,'bot-'+_0x5b13a4+_0x5ec6a3(0x22e))))fs[_0x5ec6a3(0x280)](path[_0x5ec6a3(0x129)](configpath,_0x5ec6a3(0xe9)+_0x5b13a4+'-results.json'));}catch(_0x106453){if(_0x106453)logger[_0x5ec6a3(0x293)](_0x5ec6a3(0x173),_0x106453);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x5ec6a3(0x229),config),broadcastToBots('bots',JSON[_0x5ec6a3(0xb8)](config));}function toggleBot(_0xe4712f,_0x38b40e,_0x4bc13b){const _0x39e05d=_0x56c46b;dbConfig[_0x39e05d(0xb4)]('bots')['find']({'botID':_0xe4712f})[_0x39e05d(0x1cf)]({'status':_0x38b40e})['assign']({'live':_0x4bc13b})[_0x39e05d(0x28c)]();if(_0x38b40e==_0x39e05d(0x1a9)||_0x38b40e=='new')logger['full'](_0x39e05d(0x22b)+_0xe4712f),startBot([_0xe4712f,userID],{'cwd':bbpath},function(_0x3bf8d1){const _0x55cb93=_0x39e05d;if(_0x3bf8d1)logger[_0x55cb93(0x293)](_0x3bf8d1);});else(_0x38b40e==_0x39e05d(0x246)||_0x38b40e==_0x39e05d(0x170))&&(logger[_0x39e05d(0x293)](_0x39e05d(0x104)+_0xe4712f),stopBot(_0xe4712f));config=getConfiguration(),io['to'](_0x39e05d(0xdb))[_0x39e05d(0xf5)](_0x39e05d(0x229),config),broadcastToBots(_0x39e05d(0x229),JSON['stringify'](config));}function toggleStatus(_0x3c4ccd){const _0x19d207=_0x56c46b;let _0x23f8d3=dbConfig['get']('bots')[_0x19d207(0x153)]({'botID':_0x3c4ccd})[_0x19d207(0x1bd)](),_0x1c1a3e;if(_0x23f8d3[_0x19d207(0x114)]==='enabled')_0x1c1a3e=_0x19d207(0x246);else{if(_0x23f8d3[_0x19d207(0x114)]===_0x19d207(0x20f))_0x1c1a3e=_0x19d207(0x170);else{if(_0x23f8d3[_0x19d207(0x114)]===_0x19d207(0x170))_0x1c1a3e='new';else{if(_0x23f8d3[_0x19d207(0x114)]==='disabled')_0x1c1a3e='enabled';}}}return _0x1c1a3e;}function updateStatus(_0x57f5be,_0x3d7c4b){const _0x520053=_0x56c46b;dbConfig[_0x520053(0xb4)](_0x520053(0x229))[_0x520053(0x153)]({'botID':_0x57f5be})[_0x520053(0x1cf)]({'status':_0x3d7c4b})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x520053(0xf5)](_0x520053(0x229),config),broadcastToBots(_0x520053(0x229),JSON['stringify'](config));}function updateLive(_0x20843a,_0x22e5f6){const _0x9be7ff=_0x56c46b;dbConfig[_0x9be7ff(0xb4)](_0x9be7ff(0x229))[_0x9be7ff(0x153)]({'botID':_0x20843a})[_0x9be7ff(0x1cf)]({'live':_0x22e5f6})[_0x9be7ff(0x28c)](),config=getConfiguration(),io['to'](_0x9be7ff(0xdb))[_0x9be7ff(0xf5)](_0x9be7ff(0x229),config),broadcastToBots(_0x9be7ff(0x229),JSON['stringify'](config));}function updateBotName(_0xec9ab1,_0x28f931){const _0x25adcb=_0x56c46b;dbConfig['get'](_0x25adcb(0x229))['find']({'botID':_0xec9ab1})['assign']({'botname':_0x28f931})[_0x25adcb(0x28c)](),config=getConfiguration(),io['to']('botmanager')[_0x25adcb(0xf5)]('bots',config),broadcastToBots('bots',JSON[_0x25adcb(0xb8)](config));}function updateBotManager(){const _0x23029e=_0x56c46b;config=getConfiguration(),io['to'](_0x23029e(0xdb))[_0x23029e(0xf5)](_0x23029e(0x229),config),broadcastToBots('bots',JSON[_0x23029e(0xb8)](config));}function toggleBotMode(_0x4ccd80){const _0x2e3f00=_0x56c46b;if(pid[_0x4ccd80])pid[_0x4ccd80][_0x2e3f00(0x1dc)]({'function':_0x2e3f00(0xed),'args':null});else{const _0x349268=configpath+_0x2e3f00(0xe9)+_0x4ccd80+_0x2e3f00(0x22c),_0x535313=fs[_0x2e3f00(0x1be)](_0x349268),_0x9625df=JSON[_0x2e3f00(0x1c2)](_0x535313),_0x527c52=_0x9625df[_0x2e3f00(0x137)][0x0]['headless'];_0x9625df[_0x2e3f00(0x137)][0x0][_0x2e3f00(0x96)]=!_0x527c52;const _0xd44bfc=JSON[_0x2e3f00(0xb8)](_0x9625df,null,0x2);fs[_0x2e3f00(0xff)](_0x349268,_0xd44bfc),config=getConfiguration(),io['to']('botmanager')[_0x2e3f00(0xf5)](_0x2e3f00(0x229),config),broadcastToBots(_0x2e3f00(0x229),JSON['stringify'](config));}}function validateTelegram(_0x25328b){const _0x505b21=_0x56c46b;if(_0x25328b[_0x505b21(0x1e5)][_0x505b21(0xc6)]!=settings[_0x505b21(0x156)]&&'@'+_0x25328b[_0x505b21(0x1e5)][_0x505b21(0xc6)]!=settings[_0x505b21(0x156)]||_0x25328b[_0x505b21(0xbe)]['id']!=settings[_0x505b21(0x1d4)])return sendTelegram(_0x25328b[_0x505b21(0xbe)]['id'],_0x505b21(0xb7),{'parse_mode':_0x505b21(0xd3)}),![];return!![];}async function initTelegram(){const _0x3a372f=_0x56c46b;if(tgBot)tgBot[_0x3a372f(0x20d)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x22fce2='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x22fce2+='\x0a',_0x22fce2+=_0x3a372f(0x221),_0x22fce2+=_0x3a372f(0x22a),_0x22fce2+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x22fce2+=_0x3a372f(0x20c),_0x22fce2+=_0x3a372f(0xd5),_0x22fce2+=_0x3a372f(0x183),_0x22fce2+=_0x3a372f(0x1d1),_0x22fce2+=_0x3a372f(0x105),_0x22fce2+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x22fce2+=_0x3a372f(0xe1),_0x22fce2+=_0x3a372f(0xea),_0x22fce2+=_0x3a372f(0xfc),_0x22fce2+=_0x3a372f(0x14e),_0x22fce2+=_0x3a372f(0x215);let _0x50e1c3=_0x3a372f(0x10b);_0x50e1c3+='\x0a',_0x50e1c3+=_0x22fce2,tgBot['catch']((_0x2f9af2,_0xead203)=>{const _0x2d5056=_0x3a372f;logger[_0x2d5056(0x99)](getTimeStamp()+_0x2d5056(0x133)),logger[_0x2d5056(0x16d)](_0x2d5056(0x16c),_0x2f9af2);}),tgBot[_0x3a372f(0x21f)](async(_0x30fcef,_0x2d2fba)=>{const _0xe12e34=_0x3a372f;if(!(!settings[_0xe12e34(0x1d4)]&&_0x30fcef[_0xe12e34(0x13d)][_0xe12e34(0x1d8)][_0xe12e34(0x1da)]==_0xe12e34(0x165))){if(!validateTelegram(_0x30fcef))return;}_0x2d2fba();}),tgBot[_0x3a372f(0x26c)]('start',async _0x51fdd0=>{const _0xdcb29c=_0x3a372f;if(!settings['telegramChatId'])updateSetting(_0xdcb29c(0x1d4),_0x51fdd0['chat']['id']);updateSetting(_0xdcb29c(0x27d),!![]);if(!validateTelegram(_0x51fdd0))return;await sendTelegram(_0x51fdd0['chat']['id'],_0x50e1c3);}),tgBot['command'](_0x3a372f(0x263),async _0x4bd345=>{const _0x28591a=_0x3a372f;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4bd345[_0x28591a(0xbe)]['id'],_0x28591a(0x1fb));}),tgBot[_0x3a372f(0x26c)]('disable',async _0x3b480f=>{const _0x4948e4=_0x3a372f;await sendTelegram(_0x3b480f['chat']['id'],_0x4948e4(0xf7)),updateSetting('telegramEnabled',![]);}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x205),async _0x2f32fa=>{const _0x2d1a4f=_0x3a372f,_0x32088e=Markup['inlineKeyboard']([Markup[_0x2d1a4f(0x161)][_0x2d1a4f(0xa5)]('Orders','config_orders'),Markup['button'][_0x2d1a4f(0xa5)](_0x2d1a4f(0x26f),'config_alerts'),Markup[_0x2d1a4f(0x161)][_0x2d1a4f(0xa5)](_0x2d1a4f(0x1c7),_0x2d1a4f(0x187))]);_0x2f32fa[_0x2d1a4f(0x261)](_0x2d1a4f(0xf6),_0x32088e);}),tgBot[_0x3a372f(0x258)](_0x3a372f(0xae),async _0x1b718e=>{const _0x412b1b=_0x3a372f;_0x1b718e[_0x412b1b(0x291)](),updateSetting(_0x412b1b(0x1e2),_0x412b1b(0x15e)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1b718e['chat']['id'],_0x412b1b(0x204));}),tgBot['action'](_0x3a372f(0x272),async _0x5e5a89=>{const _0x2d4cb2=_0x3a372f;_0x5e5a89[_0x2d4cb2(0x291)](),updateSetting(_0x2d4cb2(0x1e2),_0x2d4cb2(0x297)),updateSetting(_0x2d4cb2(0x27d),!![]),await sendTelegram(_0x5e5a89[_0x2d4cb2(0xbe)]['id'],_0x2d4cb2(0xa2));}),tgBot[_0x3a372f(0x258)](_0x3a372f(0x187),async _0x4cfdcb=>{const _0x16151a=_0x3a372f;_0x4cfdcb[_0x16151a(0x291)](),updateSetting(_0x16151a(0x1e2),_0x16151a(0x27f)),updateSetting(_0x16151a(0x27d),!![]),await sendTelegram(_0x4cfdcb['chat']['id'],_0x16151a(0x146));}),tgBot[_0x3a372f(0x26c)]('status',async _0x217a0d=>{const _0xc947d0=_0x3a372f,_0x10bc87=getBotsWithMode();let _0x1b1f5d=_0xc947d0(0x1e8);config[_0xc947d0(0x27b)](_0x297771=>{const _0x18dd33=_0xc947d0,_0x45f9c2=_0x10bc87[_0x18dd33(0x153)](_0x590027=>_0x590027[_0x18dd33(0x176)]==_0x297771[_0x18dd33(0x176)])[_0x18dd33(0x1d0)];_0x1b1f5d+=_0x18dd33(0x1a5)+_0x297771[_0x18dd33(0x176)]+':\x20'+_0x297771['status']+_0x18dd33(0x1e7)+_0x45f9c2+_0x18dd33(0x1e7)+_0x297771[_0x18dd33(0x25a)]+'\x0a';}),_0x1b1f5d+='\x0a',_0x1b1f5d+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x1b1f5d+=!settings['telegramEnabled']?_0xc947d0(0x17b):_0xc947d0(0x159),_0x1b1f5d+=settings['telegramEnabled']?settings['telegramEvents']==_0xc947d0(0x27f)?_0xc947d0(0x243):_0xc947d0(0x211)+settings[_0xc947d0(0x1e2)]+'\x20only\x0a':'',await sendTelegram(_0x217a0d[_0xc947d0(0xbe)]['id'],_0x1b1f5d,{'parse_mode':_0xc947d0(0xd3)});}),tgBot['command'](_0x3a372f(0x1af),async _0x42f1ea=>{const _0x30cded=_0x3a372f,_0x3da0c6=getEnabledBots();if(_0x3da0c6[_0x30cded(0x26a)]==0x0)await sendTelegram(_0x42f1ea[_0x30cded(0xbe)]['id'],_0x30cded(0x28f));else{if(_0x3da0c6[_0x30cded(0x26a)]>0x1)_0x3da0c6[_0x30cded(0xfd)]({'botID':'all'});let _0x5b306f=[],_0x8dee81=[];const _0x3dd745=_0x3da0c6[_0x30cded(0x26a)]%0x4==0x0||_0x3da0c6[_0x30cded(0x26a)]%0x4==0x3||_0x3da0c6[_0x30cded(0x26a)]%0x3==0x1?0x4:0x3;let _0x503284=0x0;_0x3da0c6['forEach']((_0x12bcd6,_0x580fc8)=>{const _0x55e470=_0x30cded;if(_0x580fc8%_0x3dd745==0x0)_0x8dee81=[];_0x8dee81[_0x55e470(0xfd)](Markup[_0x55e470(0x161)][_0x55e470(0xa5)](_0x12bcd6['botID']==_0x55e470(0x27f)?'All\x20bots':_0x55e470(0x1a5)+_0x12bcd6[_0x55e470(0x176)],_0x55e470(0x152)+_0x12bcd6[_0x55e470(0x176)])),_0x580fc8%_0x3dd745==0x0&&(_0x5b306f[_0x503284]=_0x8dee81,_0x503284++);});const _0x36ab8b=Markup[_0x30cded(0x244)](_0x5b306f);_0x42f1ea[_0x30cded(0x261)](_0x30cded(0x136),_0x36ab8b);}}),tgBot[_0x3a372f(0x258)](/restart_(.+)/,async _0x36ab02=>{const _0x543350=_0x3a372f,_0x1e83d6=_0x36ab02[_0x543350(0x227)][0x1];_0x36ab02['editMessageReplyMarkup'](),_0x1e83d6==_0x543350(0x27f)?config[_0x543350(0x27b)](_0x974b88=>{const _0x2dac01=_0x543350;restartBot(_0x974b88[_0x2dac01(0x176)]);}):restartBot(_0x1e83d6);}),tgBot['command']('on',async _0x2f5fb2=>{const _0x488097=_0x3a372f,_0x171d68=getDisabledBots();if(_0x171d68[_0x488097(0x26a)]==0x0)await sendTelegram(_0x2f5fb2[_0x488097(0xbe)]['id'],_0x488097(0x242));else{if(_0x171d68[_0x488097(0x26a)]>0x1)_0x171d68[_0x488097(0xfd)]({'botID':_0x488097(0x27f)});let _0x308162=[],_0x273fe0=[];const _0x5be484=_0x171d68[_0x488097(0x26a)]%0x4==0x0||_0x171d68[_0x488097(0x26a)]%0x4==0x3||_0x171d68['length']%0x3==0x1?0x4:0x3;let _0x129491=0x0;_0x171d68[_0x488097(0x27b)]((_0x57eac4,_0x29024f)=>{const _0x77b4ed=_0x488097;if(_0x29024f%_0x5be484==0x0)_0x273fe0=[];_0x273fe0[_0x77b4ed(0xfd)](Markup[_0x77b4ed(0x161)][_0x77b4ed(0xa5)](_0x57eac4['botID']==_0x77b4ed(0x27f)?_0x77b4ed(0x116):_0x77b4ed(0x1a5)+_0x57eac4[_0x77b4ed(0x176)],_0x77b4ed(0x1b6)+_0x57eac4[_0x77b4ed(0x176)])),_0x29024f%_0x5be484==0x0&&(_0x308162[_0x129491]=_0x273fe0,_0x129491++);});const _0x38f50f=Markup[_0x488097(0x244)](_0x308162);_0x2f5fb2[_0x488097(0x261)](_0x488097(0x289),_0x38f50f);}}),tgBot['action'](/on_(.+)/,async _0x31a352=>{const _0x382132=_0x3a372f,_0x416604=_0x31a352['match'][0x1];_0x31a352[_0x382132(0x291)]();if(_0x416604=='all'){const _0x26de38=getDisabledBots();await sendTelegram(_0x31a352[_0x382132(0xbe)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x26de38[_0x382132(0x27b)](_0x95c585=>{const _0x194377=_0x382132;if(_0x95c585[_0x194377(0x176)]!='all')toggleBot(_0x95c585[_0x194377(0x176)],toggleStatus(_0x95c585['botID']),'stopped');});}else await sendTelegram(_0x31a352[_0x382132(0xbe)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x416604),toggleBot(_0x416604,toggleStatus(_0x416604),_0x382132(0x273));}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x1d2),async _0x3ad209=>{const _0x19ea79=_0x3a372f,_0x2a1aeb=getEnabledBots();if(_0x2a1aeb[_0x19ea79(0x26a)]==0x0)await sendTelegram(_0x3ad209['chat']['id'],_0x19ea79(0x28f));else{if(_0x2a1aeb[_0x19ea79(0x26a)]>0x1)_0x2a1aeb['push']({'botID':_0x19ea79(0x27f)});let _0x51d2d2=[],_0x3f54ed=[];const _0x4d3acb=_0x2a1aeb[_0x19ea79(0x26a)]%0x4==0x0||_0x2a1aeb[_0x19ea79(0x26a)]%0x4==0x3||_0x2a1aeb[_0x19ea79(0x26a)]%0x3==0x1?0x4:0x3;let _0x5a7801=0x0;_0x2a1aeb[_0x19ea79(0x27b)]((_0xeb7a90,_0x4cc9cf)=>{const _0x5c950d=_0x19ea79;if(_0x4cc9cf%_0x4d3acb==0x0)_0x3f54ed=[];_0x3f54ed[_0x5c950d(0xfd)](Markup[_0x5c950d(0x161)][_0x5c950d(0xa5)](_0xeb7a90[_0x5c950d(0x176)]==_0x5c950d(0x27f)?_0x5c950d(0x116):_0x5c950d(0x1a5)+_0xeb7a90[_0x5c950d(0x176)],_0x5c950d(0x25d)+_0xeb7a90['botID'])),_0x4cc9cf%_0x4d3acb==0x0&&(_0x51d2d2[_0x5a7801]=_0x3f54ed,_0x5a7801++);});const _0xb5cf91=Markup[_0x19ea79(0x244)](_0x51d2d2);_0x3ad209[_0x19ea79(0x261)](_0x19ea79(0x142),_0xb5cf91);}}),tgBot['action'](/off_(.+)/,async _0x1eb838=>{const _0x592a00=_0x3a372f,_0x4bf835=_0x1eb838[_0x592a00(0x227)][0x1];_0x1eb838[_0x592a00(0x291)]();if(_0x4bf835==_0x592a00(0x27f)){const _0x27c564=getEnabledBots();await sendTelegram(_0x1eb838[_0x592a00(0xbe)]['id'],_0x592a00(0x14b)),_0x27c564[_0x592a00(0x27b)](_0x2a59e8=>{const _0x37d76e=_0x592a00;if(_0x2a59e8[_0x37d76e(0x176)]!=_0x37d76e(0x27f))toggleBot(_0x2a59e8[_0x37d76e(0x176)],toggleStatus(_0x2a59e8['botID']),'stopped');});}else await sendTelegram(_0x1eb838[_0x592a00(0xbe)]['id'],_0x592a00(0x171)+_0x4bf835),toggleBot(_0x4bf835,toggleStatus(_0x4bf835),'stopped');}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x11a),async _0x3a5234=>{const _0xe14fc5=_0x3a372f,_0x1b2ec1=getEnabledBots();if(_0x1b2ec1[_0xe14fc5(0x26a)]==0x0)await sendTelegram(_0x3a5234[_0xe14fc5(0xbe)]['id'],_0xe14fc5(0x28f));else{if(_0x1b2ec1['length']>0x1){let _0x35ee16=[],_0x153360=[];const _0x4c0c2b=_0x1b2ec1[_0xe14fc5(0x26a)]%0x4==0x0||_0x1b2ec1[_0xe14fc5(0x26a)]%0x4==0x3||_0x1b2ec1[_0xe14fc5(0x26a)]%0x3==0x1?0x4:0x3;let _0x57f4c7=0x0;_0x1b2ec1['forEach']((_0x423efd,_0x3d5002)=>{const _0x2d198a=_0xe14fc5;if(_0x3d5002%_0x4c0c2b==0x0)_0x153360=[];_0x153360[_0x2d198a(0xfd)](Markup[_0x2d198a(0x161)][_0x2d198a(0xa5)](_0x2d198a(0x1a5)+_0x423efd[_0x2d198a(0x176)],_0x2d198a(0x1f2)+_0x423efd[_0x2d198a(0x176)])),_0x3d5002%_0x4c0c2b==0x0&&(_0x35ee16[_0x57f4c7]=_0x153360,_0x57f4c7++);});const _0x45a997=Markup['inlineKeyboard'](_0x35ee16);_0x3a5234[_0xe14fc5(0x261)](_0xe14fc5(0x1bf),_0x45a997);}else{const _0x4d05c9=_0x1b2ec1[0x0]['botID'];if(pid[_0x4d05c9])pid[_0x4d05c9]['send']({'function':_0xe14fc5(0x10c),'args':null});}}}),tgBot[_0x3a372f(0x258)](/metrics_(.+)/,async _0xe17403=>{const _0x4def81=_0x3a372f,_0x2c5755=_0xe17403[_0x4def81(0x227)][0x1];_0xe17403[_0x4def81(0x291)]();if(pid[_0x2c5755])pid[_0x2c5755][_0x4def81(0x1dc)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0xc2),async _0x2220c2=>{const _0x158416=_0x3a372f,_0x1a1fb7=getEnabledBots();if(_0x1a1fb7['length']==0x0)await sendTelegram(_0x2220c2['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1a1fb7[_0x158416(0x26a)]>0x1){let _0x2c02aa=[],_0x5b56fb=[];const _0x3a8ad2=_0x1a1fb7['length']%0x4==0x0||_0x1a1fb7[_0x158416(0x26a)]%0x4==0x3||_0x1a1fb7[_0x158416(0x26a)]%0x3==0x1?0x4:0x3;let _0x2e28d9=0x0;_0x1a1fb7[_0x158416(0x27b)]((_0x4bba52,_0x357d97)=>{const _0x14decd=_0x158416;if(_0x357d97%_0x3a8ad2==0x0)_0x5b56fb=[];_0x5b56fb['push'](Markup['button'][_0x14decd(0xa5)]('Bot\x20'+_0x4bba52['botID'],_0x14decd(0x127)+_0x4bba52[_0x14decd(0x176)])),_0x357d97%_0x3a8ad2==0x0&&(_0x2c02aa[_0x2e28d9]=_0x5b56fb,_0x2e28d9++);});const _0x448fc8=Markup[_0x158416(0x244)](_0x2c02aa);_0x2220c2['reply'](_0x158416(0xdf),_0x448fc8);}else{const _0x11204e=_0x1a1fb7[0x0][_0x158416(0x176)];if(pid[_0x11204e])pid[_0x11204e][_0x158416(0x1dc)]({'function':_0x158416(0x22d),'args':null});}}}),tgBot[_0x3a372f(0x258)](/portfolio_(.+)/,async _0x4d6fa4=>{const _0x23e413=_0x3a372f,_0x2af87e=_0x4d6fa4[_0x23e413(0x227)][0x1];_0x4d6fa4[_0x23e413(0x291)]();if(pid[_0x2af87e])pid[_0x2af87e]['send']({'function':_0x23e413(0x22d),'args':null});}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x13d),async _0x29b01f=>{const _0x47ad92=_0x3a372f;await getMessages();if(!updateAvailable)await sendTelegram(_0x29b01f[_0x47ad92(0xbe)]['id'],_0x47ad92(0x265));else{if(!validInstallation)await sendTelegram(_0x29b01f[_0x47ad92(0xbe)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0xd2938a=Markup['inlineKeyboard']([Markup[_0x47ad92(0x161)]['callback'](_0x47ad92(0x174),_0x47ad92(0x278)),Markup[_0x47ad92(0x161)][_0x47ad92(0xa5)]('No',_0x47ad92(0xe5))]);_0x29b01f[_0x47ad92(0x261)](_0x47ad92(0xa3),_0xd2938a);}}}),tgBot[_0x3a372f(0x258)](/update_(.+)/,async _0x3bb832=>{const _0x51bd05=_0x3a372f,_0x37a1e0=_0x3bb832[_0x51bd05(0x227)][0x1];_0x3bb832[_0x51bd05(0x291)](),_0x37a1e0==_0x51bd05(0x197)&&(await sendTelegram(_0x3bb832[_0x51bd05(0xbe)]['id'],_0x51bd05(0x124)),updateBB('update')),_0x37a1e0=='no'&&await sendTelegram(_0x3bb832[_0x51bd05(0xbe)]['id'],_0x51bd05(0xb0));}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x284),async _0x577f4b=>{const _0x3e03aa=_0x3a372f;if(!validInstallation)await sendTelegram(_0x577f4b['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x6ec2d9=Markup[_0x3e03aa(0x244)]([Markup[_0x3e03aa(0x161)][_0x3e03aa(0xa5)](_0x3e03aa(0x174),_0x3e03aa(0x1a7)),Markup[_0x3e03aa(0x161)][_0x3e03aa(0xa5)]('No',_0x3e03aa(0x16b))]);_0x577f4b[_0x3e03aa(0x261)](_0x3e03aa(0x1b0),_0x6ec2d9);}}),tgBot[_0x3a372f(0x258)](/reinstall_(.+)/,async _0x55f53d=>{const _0x3f62ab=_0x3a372f,_0x45e5c5=_0x55f53d[_0x3f62ab(0x227)][0x1];_0x55f53d[_0x3f62ab(0x291)](),_0x45e5c5==_0x3f62ab(0x197)&&(await sendTelegram(_0x55f53d['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x3f62ab(0x284))),_0x45e5c5=='no'&&await sendTelegram(_0x55f53d[_0x3f62ab(0xbe)]['id'],_0x3f62ab(0x163));}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x1a8),async _0x3e84f9=>{const _0x589bdd=_0x3a372f,_0x57c633=getBotsWithMode();if(_0x57c633[_0x589bdd(0x26a)]==0x0)await sendTelegram(_0x3e84f9[_0x589bdd(0xbe)]['id'],_0x589bdd(0x28f));else{let _0x150b22=[],_0x1e14e7=[];const _0x37d1a7=0x2;let _0x59e787=0x0;_0x57c633['forEach']((_0x8501c1,_0x469cbd)=>{const _0x346440=_0x589bdd;if(_0x469cbd%_0x37d1a7==0x0)_0x1e14e7=[];_0x1e14e7[_0x346440(0xfd)](Markup[_0x346440(0x161)][_0x346440(0xa5)]('Bot\x20'+_0x8501c1[_0x346440(0x176)]+'\x20('+_0x8501c1['mode']+')',_0x346440(0x228)+_0x8501c1[_0x346440(0x176)])),_0x469cbd%_0x37d1a7==0x0&&(_0x150b22[_0x59e787]=_0x1e14e7,_0x59e787++);});const _0x53d0fb=Markup[_0x589bdd(0x244)](_0x150b22);_0x3e84f9[_0x589bdd(0x261)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x53d0fb);}}),tgBot[_0x3a372f(0x258)](/toggle_(.+)/,async _0x5025be=>{const _0x845e2a=_0x3a372f,_0x380bc0=_0x5025be[_0x845e2a(0x227)][0x1];_0x5025be[_0x845e2a(0x291)]();const _0x4d874c=getBotsWithMode(),_0x4294e0=_0x4d874c[_0x845e2a(0x153)](_0x46c64a=>_0x46c64a[_0x845e2a(0x176)]==_0x380bc0),_0x1a5a0a=_0x4294e0[_0x845e2a(0x1d0)]=='auto'?_0x845e2a(0x12e):_0x845e2a(0x1c1);await sendTelegram(_0x5025be[_0x845e2a(0xbe)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x380bc0+'\x20to\x20'+_0x1a5a0a+'\x20mode'),toggleBotMode(_0x380bc0);}),tgBot[_0x3a372f(0x26c)]('names',async _0x541f1a=>{const _0x3c4c49=_0x3a372f;let _0x1d1b4f='';config[_0x3c4c49(0x27b)](_0x16624e=>{const _0xcc95e=_0x3c4c49;_0x1d1b4f+=_0xcc95e(0x1a5)+_0x16624e[_0xcc95e(0x176)]+':\x20'+_0x16624e[_0xcc95e(0x10d)]+'\x0a';}),await sendTelegram(_0x541f1a[_0x3c4c49(0xbe)]['id'],_0x1d1b4f,{'parse_mode':_0x3c4c49(0xd3)});}),tgBot[_0x3a372f(0x26c)](_0x3a372f(0x214),async _0x26f54c=>{const _0x169771=_0x3a372f;await sendTelegram(_0x26f54c[_0x169771(0xbe)]['id'],_0x22fce2);}),process[_0x3a372f(0x1f9)](_0x3a372f(0x23c),()=>tgBot[_0x3a372f(0x20d)]('SIGINT')),process[_0x3a372f(0x1f9)](_0x3a372f(0x296),()=>tgBot[_0x3a372f(0x20d)](_0x3a372f(0x296))),tgBot[_0x3a372f(0x1ee)]();}}function disableTelegram(){const _0x213749=_0x56c46b;tgBot&&tgBot[_0x213749(0x20d)]();}async function sendTelegram(_0x1b401a,_0x24e7c2,_0x566aa1){const _0x347d23=_0x56c46b;try{await tgBot[_0x347d23(0x281)][_0x347d23(0x222)](_0x1b401a,_0x24e7c2,_0x566aa1);}catch(_0x532446){console[_0x347d23(0x24e)](_0x347d23(0x232),_0x532446);}}async function sendTelegramBot(_0x40ae43,_0x43b35f){const _0x325a6=_0x56c46b;if(settings[_0x325a6(0x27d)]){if(settings[_0x325a6(0x1e2)]==_0x325a6(0x27f)||(_0x43b35f[_0x325a6(0xd2)]=='error'||_0x43b35f[_0x325a6(0xd2)]=='warning'||_0x43b35f['type']==_0x325a6(0x93))&&settings[_0x325a6(0x1e2)]==_0x325a6(0x297)||_0x43b35f[_0x325a6(0xd2)]==_0x325a6(0x1a1)&&settings[_0x325a6(0x1e2)]==_0x325a6(0x15e)){if(tgBot&&settings[_0x325a6(0x1d4)]){if(_0x43b35f[_0x325a6(0xb3)])await sendTelegram(settings[_0x325a6(0x1d4)],_0x43b35f[_0x325a6(0x10d)]+_0x325a6(0x252)+_0x43b35f[_0x325a6(0xc3)]);else await sendTelegram(settings[_0x325a6(0x1d4)],'Bot\x20'+_0x40ae43+_0x325a6(0x252)+_0x43b35f[_0x325a6(0xc3)]);}}}}async function sendTelegramMsg(_0x54a437,_0x149ae3=_0x56c46b(0xd3)){const _0x4f58dc=_0x56c46b;return settings[_0x4f58dc(0x27d)]&&tgBot&&settings[_0x4f58dc(0x1d4)]?(await sendTelegram(settings[_0x4f58dc(0x1d4)],_0x54a437,{'parse_mode':_0x149ae3}),!![]):![];}function getDeviceWithIp(_0x179cdd){const _0x20176b=_0x56c46b;return devices[_0x20176b(0x153)](_0x48e8dd=>_0x48e8dd['ip']===_0x179cdd);}async function temporaryAccess2FA(_0x5f5125,_0x315266){const _0x367457=_0x56c46b;let _0x4683f8=new Date(),_0x4923bf=![];if(lastIpApproval){if(_0x4683f8-lastIpApproval<0x1388)_0x4923bf=!![];}lastIpApproval=new Date();if(_0x4923bf)return;if(tgBot&&settings[_0x367457(0x1d4)]){const _0x49c890=uuidRandom();tmpStorage[_0x49c890]={'uuid':_0x5f5125,'externalip':_0x315266};const _0x2500c2=Markup[_0x367457(0x244)]([Markup[_0x367457(0x161)]['callback'](_0x367457(0xaa),_0x367457(0x1f3)+_0x49c890),Markup[_0x367457(0x161)]['callback'](_0x367457(0x213),_0x367457(0x200)+_0x49c890),Markup[_0x367457(0x161)][_0x367457(0xa5)](_0x367457(0x128),_0x367457(0x17c)+_0x49c890),Markup[_0x367457(0x161)][_0x367457(0xa5)](_0x367457(0x233),'tempaccess_reject_'+_0x49c890)]);await sendTelegram(settings['telegramChatId'],_0x367457(0x1f1)+normalizeIP(_0x315266)[_0x367457(0x208)]+'\x20?',_0x2500c2),tgBot[_0x367457(0x258)](/tempaccess_(.+)_(.+)/,async _0x363491=>{const _0xc171fd=_0x367457,_0x137228=_0x363491[_0xc171fd(0x227)][0x1],_0x30ebb6=_0x363491['match'][0x2],{uuid:_0x4d442e,externalip:_0x12b0ed}=tmpStorage[_0x30ebb6];delete tmpStorage[_0x30ebb6],_0x363491[_0xc171fd(0x291)](),devices[_0x4d442e][_0xc171fd(0x1e9)]={'clientip':_0x12b0ed,'timestamp':new Date()['getTime'](),'expiry':_0x137228},_0x137228!=_0xc171fd(0x233)?(await sendTelegram(_0x363491[_0xc171fd(0xbe)]['id'],_0xc171fd(0xd7)+_0x137228+'\x20minutes',{'parse_mode':_0xc171fd(0xd3)}),io['to'](_0x4d442e)[_0xc171fd(0xf5)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x363491['chat']['id'],_0xc171fd(0x235)),io['to'](_0x4d442e)[_0xc171fd(0xf5)](_0xc171fd(0x114),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x4ce774,_0x13e459){const _0x10a6c5=_0x56c46b;if(tgBot&&settings[_0x10a6c5(0x1d4)]){const _0x560a74=uuidRandom();tmpStorage[_0x560a74]={'uuid':_0x4ce774,'externalip':_0x13e459};const _0x5066bf=Markup[_0x10a6c5(0x244)]([Markup[_0x10a6c5(0x161)][_0x10a6c5(0xa5)](_0x10a6c5(0x23a),_0x10a6c5(0x203)+loginExpiry+'_'+_0x560a74),Markup[_0x10a6c5(0x161)]['callback'](_0x10a6c5(0x233),_0x10a6c5(0xb2)+_0x560a74)]);await sendTelegram(settings['telegramChatId'],_0x10a6c5(0x290)+normalizeIP(_0x13e459)[_0x10a6c5(0x208)]+'\x20?',_0x5066bf),tgBot[_0x10a6c5(0x258)](/login2fa_(.+)_(.+)/,async _0x1dc391=>{const _0x4d11be=_0x10a6c5,_0x591e07=_0x1dc391['match'][0x1],_0x3e332a=_0x1dc391['match'][0x2],{uuid:_0x358f30,externalip:_0x118179}=tmpStorage[_0x3e332a];delete tmpStorage[_0x3e332a],_0x1dc391[_0x4d11be(0x291)](),devices[_0x358f30][_0x4d11be(0x19e)]={'clientip':_0x118179,'timestamp':new Date()[_0x4d11be(0x1b2)](),'expiry':_0x591e07},_0x591e07!='reject'?(await sendTelegram(_0x1dc391[_0x4d11be(0xbe)]['id'],'Login\x20accepted',{'parse_mode':_0x4d11be(0xd3)}),io['to'](_0x358f30)[_0x4d11be(0xf5)](_0x4d11be(0x114),{'access':{'allow':![],'reason':_0x4d11be(0x12f),'token':null}})):(await sendTelegram(_0x1dc391[_0x4d11be(0xbe)]['id'],_0x4d11be(0x257)),io['to'](_0x358f30)[_0x4d11be(0xf5)](_0x4d11be(0x114),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4e9784=_0x56c46b;return dbConfig[_0x4e9784(0xb4)](_0x4e9784(0x229))[_0x4e9784(0x216)]('botID')[_0x4e9784(0x15d)]({'status':_0x4e9784(0x1a9)})[_0x4e9784(0x1bd)]()||[];}function getDisabledBots(){const _0x1dd55f=_0x56c46b;return dbConfig[_0x1dd55f(0xb4)](_0x1dd55f(0x229))[_0x1dd55f(0x216)]('botID')['filter']({'status':_0x1dd55f(0x246)})[_0x1dd55f(0x1bd)]()||[];}function getBotAttributes(_0x54bddb){const _0x2eaa97=_0x56c46b;let _0x27ae8f={};const _0x283e17=configpath+'bot-'+_0x54bddb+_0x2eaa97(0x22c),_0x4e1e00=fs[_0x2eaa97(0x212)](_0x283e17);if(_0x4e1e00){const _0x191ca1=fs['readFileSync'](_0x283e17);try{const _0x34248c=JSON[_0x2eaa97(0x1c2)](_0x191ca1),_0x52a1a4=_0x34248c?_0x34248c[_0x2eaa97(0x137)][0x0][_0x2eaa97(0x96)]:![];_0x27ae8f['mode']=_0x52a1a4?'auto':_0x2eaa97(0x12e),_0x27ae8f[_0x2eaa97(0x10d)]=_0x34248c?_0x34248c[_0x2eaa97(0x137)][0x0][_0x2eaa97(0x10d)]:_0x2eaa97(0x1a5)+_0x54bddb;}catch(_0x42434b){_0x27ae8f[_0x2eaa97(0x1d0)]='manual',_0x27ae8f['botname']=_0x2eaa97(0x1a5)+_0x54bddb;}}else _0x27ae8f[_0x2eaa97(0x1d0)]='manual',_0x27ae8f[_0x2eaa97(0x10d)]=_0x2eaa97(0x1a5)+_0x54bddb;return _0x27ae8f;}function getBotsWithMode(){const _0xbd4389=_0x56c46b,_0xacb21=dbConfig[_0xbd4389(0xb4)](_0xbd4389(0x229))[_0xbd4389(0x216)](_0xbd4389(0x176))[_0xbd4389(0x1bd)]()||[];return _0xacb21['forEach'](_0x1f7aeb=>{const _0x43944c=_0xbd4389;let _0x135ce8=getBotAttributes(_0x1f7aeb[_0x43944c(0x176)]);_0x1f7aeb[_0x43944c(0x1d0)]=_0x135ce8['mode'];}),_0xacb21;}function getBotExchanges(){const _0x5e880b=_0x56c46b;let _0x239561=[];const _0xfd28d7=dbConfig[_0x5e880b(0xb4)](_0x5e880b(0x229))[_0x5e880b(0x216)]('botID')[_0x5e880b(0x1bd)]()||[];_0xfd28d7[_0x5e880b(0x27b)](_0x380218=>{const _0x1fdf62=_0x5e880b;if(_0x380218['status']==_0x1fdf62(0x1a9)){const _0x91b62d=configpath+_0x1fdf62(0xe9)+_0x380218[_0x1fdf62(0x176)]+_0x1fdf62(0x22c),_0x42bfbe=fs['existsSync'](_0x91b62d);let _0x5ec038;if(_0x42bfbe){const _0xf951bb=fs[_0x1fdf62(0x1be)](_0x91b62d);try{const _0x484e50=JSON[_0x1fdf62(0x1c2)](_0xf951bb);_0x5ec038=_0x484e50?_0x484e50[_0x1fdf62(0x137)][0x0][_0x1fdf62(0xf2)]:null;}catch(_0x194d28){}}if(_0x5ec038)_0x239561['push'](_0x5ec038);}});const _0x4a3d61=[...new Set(_0x239561)][_0x5e880b(0x25b)]();return _0x4a3d61;}async function initUser(){const _0x31a232=_0x56c46b;if(!settings[_0x31a232(0x11f)]){const _0x5966b9=uuidRandom();mixpanel[_0x31a232(0x13f)](_0x5966b9),updateSetting('userid',_0x5966b9);}}async function initSecure(){const _0x186bdb=_0x56c46b;let _0x686ca7=getSecure();if(!_0x686ca7['hasOwnProperty'](_0x186bdb(0x106))){let _0x39090b=await generateKeys();_0x686ca7[_0x186bdb(0x18b)]=_0x39090b[_0x186bdb(0x18b)],_0x686ca7['privateKey']=_0x39090b[_0x186bdb(0x26b)],_0x686ca7[_0x186bdb(0x106)]=crypto[_0x186bdb(0x1fc)](0x20)[_0x186bdb(0x13c)](_0x186bdb(0xc5));;storeSecure(_0x686ca7);}}function getSettings(){const _0x408c4c=_0x56c46b;return dbSettings[_0x408c4c(0xb4)](_0x408c4c(0x26d))[_0x408c4c(0x1bd)]()||{};}function getSecure(){const _0x3b76dd=_0x56c46b;return dbSecure[_0x3b76dd(0xb4)](_0x3b76dd(0x1b1))['value']()||{};}function getBlacklist(){const _0x4cc76c=_0x56c46b;return dbSecure[_0x4cc76c(0xb4)](_0x4cc76c(0x175))[_0x4cc76c(0x1bd)]()||[];}function broadcastToBots(_0x58662a,_0x4d4cf9){config['forEach'](_0x2d3a1b=>{const _0x9c29d3=_0x2a63;if(_0x2d3a1b[_0x9c29d3(0x114)]==_0x9c29d3(0x1a9)&&_0x2d3a1b['live']==_0x9c29d3(0x182)||_0x2d3a1b[_0x9c29d3(0x114)]=='new'&&_0x2d3a1b[_0x9c29d3(0x25a)]=='running'){if(pid[_0x2d3a1b['botID']])pid[_0x2d3a1b[_0x9c29d3(0x176)]][_0x9c29d3(0x1dc)]({[_0x58662a]:_0x4d4cf9});}});}function storeSettings(_0xc3f98f,_0x3fe1ec=![]){const _0x34b8cd=_0x56c46b;_0xc3f98f={...settings,..._0xc3f98f};if(_0x3fe1ec&&_0xc3f98f['bbPassword']!=_0x34b8cd(0x21c)&&_0xc3f98f[_0x34b8cd(0x20a)]!=_0x34b8cd(0x9c)&&_0xc3f98f[_0x34b8cd(0x20a)]!=''){const _0x51624a=crypt['decrypt'](secure[_0x34b8cd(0x26b)],_0xc3f98f[_0x34b8cd(0x20a)])[_0x34b8cd(0x1d8)][_0x34b8cd(0x15a)]('@')[0x0],_0xd72bf1=bcrypt[_0x34b8cd(0xe4)](_0x51624a,saltRounds);_0xc3f98f={..._0xc3f98f,'bbPassword':_0xd72bf1};}if(_0x3fe1ec&&_0xc3f98f[_0x34b8cd(0x125)]!='************'&&_0xc3f98f[_0x34b8cd(0x125)]!=_0x34b8cd(0x9c)&&_0xc3f98f[_0x34b8cd(0x125)]!=''){const _0x3a60cc=crypt[_0x34b8cd(0x17a)](secure[_0x34b8cd(0x26b)],_0xc3f98f[_0x34b8cd(0x125)])[_0x34b8cd(0x1d8)][_0x34b8cd(0x15a)]('@')[0x0];_0xc3f98f={..._0xc3f98f,'telegramToken':_0x3a60cc};}const _0x53b6c5=_0xc3f98f[_0x34b8cd(0x125)]!='************'&&_0xc3f98f['telegramToken']!=settings[_0x34b8cd(0x125)]||_0xc3f98f['telegramUsername']!=settings[_0x34b8cd(0x156)],_0x13856d=_0xc3f98f[_0x34b8cd(0x125)]==''||_0xc3f98f[_0x34b8cd(0x156)]=='';_0x53b6c5&&(_0xc3f98f[_0x34b8cd(0x1d4)]=null,_0xc3f98f[_0x34b8cd(0x1e2)]=_0x34b8cd(0x27f));for(const [_0x4b8ee6,_0x1e76f7]of Object['entries'](_0xc3f98f)){if(_0x4b8ee6=='telegramToken'&&_0x1e76f7==_0x34b8cd(0x21c)){_0xc3f98f[_0x34b8cd(0x125)]=settings['telegramToken'];continue;};if(_0x4b8ee6==_0x34b8cd(0x20a)&&_0x1e76f7==_0x34b8cd(0x21c)){_0xc3f98f[_0x34b8cd(0x20a)]=settings[_0x34b8cd(0x20a)];continue;};dbSettings[_0x34b8cd(0x1bb)]('settings.'+_0x4b8ee6,_0x1e76f7)['write']();}settings=_0xc3f98f,io['to']('botmanager')[_0x34b8cd(0xf5)]('settings',cleanSettings()),broadcastToBots(_0x34b8cd(0x193),settings[_0x34b8cd(0x193)]),broadcastToBots(_0x34b8cd(0x16f),settings[_0x34b8cd(0x16f)]);if(_0x53b6c5&&!_0x13856d)initTelegram();if(_0x53b6c5&&_0x13856d)disableTelegram();getAllClients()[_0x34b8cd(0x27b)](_0x2a720b=>{const _0x1b1e67=_0x34b8cd;getSocket(_0x2a720b['id'])[_0x1b1e67(0xf5)](_0x1b1e67(0x114),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x450b55,_0x829851){const _0x56a54b=_0x56c46b;dbSettings[_0x56a54b(0x1bb)](_0x56a54b(0x295)+_0x450b55,_0x829851)[_0x56a54b(0x28c)](),settings=getSettings(),io['to']('botmanager')[_0x56a54b(0xf5)](_0x56a54b(0x26d),cleanSettings());}function storeSecure(_0x3145d9){const _0x426ae7=_0x56c46b;dbSecure['get'](_0x426ae7(0x1b1))[_0x426ae7(0xfd)](_0x3145d9)[_0x426ae7(0x28c)](),secure=_0x3145d9;}function addBlacklist(_0x4ad043){const _0x43dfbf=_0x56c46b;cleanBlacklist();let _0xaa762a;devices[_0x4ad043][_0x43dfbf(0x1e9)]?_0xaa762a=Math[_0x43dfbf(0x94)](devices[_0x4ad043][_0x43dfbf(0x1e9)]['expiry'],loginExpiry):_0xaa762a=loginExpiry,dbSecure[_0x43dfbf(0xb4)](_0x43dfbf(0x175))[_0x43dfbf(0xfd)]({'expiry':new Date()[_0x43dfbf(0x1b2)]()+_0xaa762a*0x3c*0x3e8,'token':devices[_0x4ad043][_0x43dfbf(0xf1)][_0x43dfbf(0x103)]})['write'](),blacklist=dbSecure[_0x43dfbf(0xb4)]('blacklist')[_0x43dfbf(0x1bd)]();}function cleanBlacklist(){const _0x2e177e=_0x56c46b;let _0x58ee9a=dbSecure['get']('blacklist')[_0x2e177e(0x168)]()['value'](),_0x5e4874=new Date()[_0x2e177e(0x1b2)]();_0x58ee9a[_0x2e177e(0x27b)](_0x3f7599=>{const _0x40d8d9=_0x2e177e;_0x3f7599[_0x40d8d9(0x282)]<_0x5e4874&&dbSecure[_0x40d8d9(0xb4)](_0x40d8d9(0x175))['remove']({'expiry':_0x3f7599[_0x40d8d9(0x282)]})[_0x40d8d9(0x28c)]();});}function initStates(){let _0x4a49cf=getConfiguration();_0x4a49cf['forEach'](_0x3f8467=>{const _0x26be59=_0x2a63;_0x3f8467[_0x26be59(0x25a)]='stopped';}),storeConfiguration(_0x4a49cf);}function onKeys(){const _0x1964b0=new RSA();return new Promise(_0x50c691=>{const _0x247ad6=_0x2a63;_0x1964b0[_0x247ad6(0x160)]()[_0x247ad6(0x11b)](_0x469955=>{_0x50c691(_0x469955);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x162a39=_0x56c46b;let _0x5e57d1=getSettings(),_0x6e6b90=![];!_0x5e57d1[_0x162a39(0x26e)]('lastmsgtelegram')&&(_0x5e57d1[_0x162a39(0x13a)]=0x0,_0x6e6b90=!![]);!_0x5e57d1[_0x162a39(0x26e)]('lastmsgemitted')&&(_0x5e57d1['lastmsgemitted']=0x0,_0x6e6b90=!![]);!_0x5e57d1[_0x162a39(0x26e)](_0x162a39(0x12a))&&(_0x5e57d1[_0x162a39(0x12a)]=_0x162a39(0xd4),_0x6e6b90=!![]);!_0x5e57d1[_0x162a39(0x26e)]('onepagemode')&&(_0x5e57d1[_0x162a39(0x16f)]=![],_0x6e6b90=!![]);if(_0x6e6b90)storeSettings(_0x5e57d1);try{fs[_0x162a39(0xe0)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x141940=>{const _0xe2e72b=_0x162a39;if(!_0x141940[_0xe2e72b(0x25c)]()){if(!_0x141940[_0xe2e72b(0xf8)][_0xe2e72b(0xa6)]('backup-full@'))fs[_0xe2e72b(0x280)](configbackuppath+_0x141940[_0xe2e72b(0xf8)]);}else fs[_0xe2e72b(0x250)](configbackuppath+_0x141940[_0xe2e72b(0xf8)],{'recursive':!![]});});}catch(_0x447ca2){logger[_0x162a39(0x16d)]('Error\x20removing\x20old\x20backup\x20files:',_0x447ca2);}}function storeConfiguration(_0x4eaea2){const _0x21ca27=_0x56c46b;dbConfig[_0x21ca27(0xb4)]('bots')[_0x21ca27(0xf3)]()[_0x21ca27(0x28c)](),dbConfig[_0x21ca27(0xb4)]('bots')[_0x21ca27(0xfd)](..._0x4eaea2)[_0x21ca27(0x28c)](),config=_0x4eaea2;}async function resetPassword(){const _0x159158=_0x56c46b;if(tgBot&&settings['telegramChatId']){const _0x1e0437=Markup[_0x159158(0x244)]([Markup[_0x159158(0x161)][_0x159158(0xa5)](_0x159158(0x197),'resetpw_yes'),Markup[_0x159158(0x161)][_0x159158(0xa5)]('no',_0x159158(0x269))]);await sendTelegram(settings[_0x159158(0x1d4)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x1e0437),tgBot[_0x159158(0x258)](/resetpw_(.+)/,async _0x3122f0=>{const _0x15b1ad=_0x159158,_0x1b79e1=_0x3122f0['match'][0x1];_0x3122f0['editMessageReplyMarkup']();if(_0x1b79e1!='no'){const _0x2095de=0xf,_0x2b0726=_0x15b1ad(0xbf),_0x3bbbc0=Array[_0x15b1ad(0x1e5)](crypto['randomFillSync'](new Uint32Array(_0x2095de)))[_0x15b1ad(0x251)](_0x5d5d52=>_0x2b0726[_0x5d5d52%_0x2b0726['length']])[_0x15b1ad(0x129)](''),_0x201d68=bcrypt[_0x15b1ad(0xe4)](_0x3bbbc0,saltRounds);storeSettings({'bbPassword':_0x201d68}),await sendTelegram(_0x3122f0[_0x15b1ad(0xbe)]['id'],_0x15b1ad(0xdc)+_0x3bbbc0,{'parse_mode':_0x15b1ad(0xd3)});}else await sendTelegram(_0x3122f0['chat']['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x4b281c,_0x1fcff0){const _0x2ac21d=_0x56c46b;io['to'](_0x2ac21d(0xdb))[_0x2ac21d(0xf5)](_0x2ac21d(0xc0),_0x2ac21d(0x1f4),_0x2ac21d(0x93));if(tgBot&&settings['telegramChatId']){const _0x39f2fc=uuidRandom();tmpStorage[_0x39f2fc]={'path':_0x4b281c,'filename':_0x1fcff0};const _0x264c1f=Markup[_0x2ac21d(0x244)]([Markup[_0x2ac21d(0x161)]['callback'](_0x2ac21d(0x197),_0x2ac21d(0x12c)+_0x39f2fc),Markup[_0x2ac21d(0x161)][_0x2ac21d(0xa5)]('no',_0x2ac21d(0x19b)+_0x39f2fc)]);await sendTelegram(settings['telegramChatId'],_0x2ac21d(0x255),_0x264c1f),tgBot['action'](/restore_(.+)_(.+)/,async _0x4d2262=>{const _0x411580=_0x2ac21d,_0x346496=_0x4d2262['match'][0x1],_0x20dd15=_0x4d2262[_0x411580(0x227)][0x2],{path:_0x2cd465,filename:_0x21166c}=tmpStorage[_0x20dd15];delete tmpStorage[_0x20dd15],_0x4d2262[_0x411580(0x291)](),_0x346496==_0x411580(0x197)?(logger[_0x411580(0x16d)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x4d2262['chat']['id'],_0x411580(0x1d7),{'parse_mode':_0x411580(0xd3)}),unzipFile(_0x2cd465,_0x21166c)):(logger[_0x411580(0x16d)](_0x411580(0x28a)),await sendTelegram(_0x4d2262[_0x411580(0xbe)]['id'],_0x411580(0x28a)));});}}function getServerTime(){const _0x2d02b3=_0x56c46b,_0x18e377=new Date();return _0x18e377['getFullYear']()+'/'+(_0x18e377[_0x2d02b3(0x23d)]()+0x1)[_0x2d02b3(0x13c)]()[_0x2d02b3(0xda)](0x2,'0')+'/'+_0x18e377[_0x2d02b3(0x109)]()[_0x2d02b3(0x13c)]()['padStart'](0x2,'0')+'\x20'+_0x18e377['getHours']()[_0x2d02b3(0x13c)]()[_0x2d02b3(0xda)](0x2,'0')+':'+_0x18e377[_0x2d02b3(0x150)]()['toString']()['padStart'](0x2,'0')+':'+_0x18e377['getSeconds']()[_0x2d02b3(0x13c)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x2031de=_0x56c46b,_0x3a7e7a=shiftedTime();return _0x3a7e7a['getFullYear']()+'/'+(_0x3a7e7a[_0x2031de(0x23d)]()+0x1)[_0x2031de(0x13c)]()['padStart'](0x2,'0')+'/'+_0x3a7e7a['getDate']()[_0x2031de(0x13c)]()[_0x2031de(0xda)](0x2,'0')+'\x20'+_0x3a7e7a[_0x2031de(0xba)]()['toString']()[_0x2031de(0xda)](0x2,'0')+':'+_0x3a7e7a[_0x2031de(0x150)]()[_0x2031de(0x13c)]()[_0x2031de(0xda)](0x2,'0')+':'+_0x3a7e7a[_0x2031de(0x1c6)]()[_0x2031de(0x13c)]()[_0x2031de(0xda)](0x2,'0');}function getCleanTimeStamp(){const _0x4ac2ed=_0x56c46b,_0x162bb6=shiftedTime();return _0x162bb6[_0x4ac2ed(0x1db)]()+(_0x162bb6[_0x4ac2ed(0x23d)]()+0x1)[_0x4ac2ed(0x13c)]()[_0x4ac2ed(0xda)](0x2,'0')+_0x162bb6[_0x4ac2ed(0x109)]()[_0x4ac2ed(0x13c)]()['padStart'](0x2,'0')+'-'+_0x162bb6[_0x4ac2ed(0xba)]()[_0x4ac2ed(0x13c)]()[_0x4ac2ed(0xda)](0x2,'0')+_0x162bb6['getMinutes']()['toString']()['padStart'](0x2,'0')+_0x162bb6[_0x4ac2ed(0x1c6)]()[_0x4ac2ed(0x13c)]()[_0x4ac2ed(0xda)](0x2,'0');}function shiftedTime(){const _0x47bb6c=_0x56c46b,_0x1cc632=new Date();let _0x44b691=_0x1cc632;if(settings[_0x47bb6c(0x193)]&&settings['timeshift']!==0x0)_0x44b691=fns['add'](_0x1cc632,{'hours':settings[_0x47bb6c(0x193)]});return _0x44b691;}function startScheduler(){const _0x5ce17e=_0x56c46b,_0x33c01f=new Date()['getUTCHours'](),_0x489b39=shiftedTime()[_0x5ce17e(0xba)]();_0x489b39==0x4&&backupConfigFiles();_0x489b39==0x0&&rotateLogFiles();_0x33c01f%0x6==0x0&&triggerAnalytics();_0x33c01f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xce6f3c){const _0x338942=_0x56c46b;logger['debug'](_0x338942(0x92)+_0xce6f3c);const _0x4b8d6c=getBotsWithMode();_0x4b8d6c['length']>0x0?confirmRestore(configbackuppath,_0xce6f3c):unzipFile(configbackuppath,_0xce6f3c);}async function getBackupFiles(_0x4a21d3=null){const _0x2bafd2=_0x56c46b;let _0x4e6fd9=[],_0x2d3898=fs[_0x2bafd2(0xe0)](configbackuppath,{'withFileTypes':!![]});_0x2d3898[_0x2bafd2(0x25b)]((_0x1c5cd4,_0x41881f)=>_0x1c5cd4[_0x2bafd2(0xf8)]<_0x41881f[_0x2bafd2(0xf8)]?0x1:_0x41881f[_0x2bafd2(0xf8)]<_0x1c5cd4[_0x2bafd2(0xf8)]?-0x1:0x0),_0x2d3898['forEach'](_0x36f7db=>{const _0x246f15=_0x2bafd2;if(!_0x36f7db['isDirectory']()&&_0x36f7db[_0x246f15(0xf8)][_0x246f15(0xa6)](_0x246f15(0xfb))&&_0x36f7db[_0x246f15(0xf8)][_0x246f15(0x20e)](_0x246f15(0x140))){const _0x5ea12b=formatDate(fs[_0x246f15(0x112)](configbackuppath+_0x36f7db[_0x246f15(0xf8)])[_0x246f15(0x11c)]);_0x4e6fd9[_0x246f15(0xfd)]({'name':_0x36f7db[_0x246f15(0xf8)],'mtime':_0x5ea12b});}});if(_0x4a21d3)io['to'](_0x4a21d3)[_0x2bafd2(0xf5)]('backup-files',_0x4e6fd9);else return _0x4e6fd9;}async function backupConfigFiles(){const _0x4c2ce7=_0x56c46b;await zipFiles(_0x4c2ce7(0x1d5));const _0xa01a30=getCleanTimeStamp();fs[_0x4c2ce7(0x14c)](zippath+_0x4c2ce7(0x198),configbackuppath+(_0x4c2ce7(0xfb)+_0xa01a30+_0x4c2ce7(0x140)));let _0x36f880=fs[_0x4c2ce7(0xe0)](configbackuppath,{'withFileTypes':!![]});_0x36f880[_0x4c2ce7(0x25b)]((_0x5ec392,_0xdfaa3c)=>_0x5ec392['name']<_0xdfaa3c[_0x4c2ce7(0xf8)]?0x1:_0xdfaa3c[_0x4c2ce7(0xf8)]<_0x5ec392['name']?-0x1:0x0),_0x36f880[_0x4c2ce7(0x26a)]>maxBackups&&fs[_0x4c2ce7(0x280)](configbackuppath+_0x36f880[_0x36f880[_0x4c2ce7(0x26a)]-0x1][_0x4c2ce7(0xf8)]);}function rotateLogFiles(){const _0xd84dc4=_0x56c46b,_0x58a2e4=fs[_0xd84dc4(0x112)](logspath+_0xd84dc4(0x141)),_0x2de392=_0x58a2e4[_0xd84dc4(0x123)]/0x400;if(_0x2de392>0x64){let _0xac0def=fs[_0xd84dc4(0xe0)](logspath,{'withFileTypes':!![]});_0xac0def['sort']((_0x425b1b,_0x5e9055)=>_0x425b1b['name']<_0x5e9055[_0xd84dc4(0xf8)]?0x1:_0x5e9055[_0xd84dc4(0xf8)]<_0x425b1b[_0xd84dc4(0xf8)]?-0x1:0x0),_0xac0def[_0xd84dc4(0x27b)](_0x5c0d8c=>{const _0x419f42=_0xd84dc4;if(_0x5c0d8c[_0x419f42(0xf8)]=='output-002.log')fs[_0x419f42(0x14c)](logspath+_0x5c0d8c[_0x419f42(0xf8)],logspath+'output-003.log');if(_0x5c0d8c[_0x419f42(0xf8)]==_0x419f42(0x194))fs[_0x419f42(0x14c)](logspath+_0x5c0d8c[_0x419f42(0xf8)],logspath+'output-002.log');_0x5c0d8c[_0x419f42(0xf8)]==_0x419f42(0x141)&&(fs['copyFileSync'](logspath+_0x5c0d8c[_0x419f42(0xf8)],logspath+_0x419f42(0x194)),fs[_0x419f42(0xff)](logspath+_0x5c0d8c[_0x419f42(0xf8)],''));});}}async function zipFiles(_0x229a12){const _0x75909b=_0x56c46b;let _0x1ef8d3;if(_0x229a12=='logs')_0x1ef8d3=logspath;if(_0x229a12=='backup')_0x1ef8d3=configpath;if(_0x229a12==_0x75909b(0x1d5))_0x1ef8d3=configpath;let _0x442111=fs[_0x75909b(0xe0)](_0x1ef8d3,{'withFileTypes':!![]});const _0x1c5cea=new require(_0x75909b(0x206))();_0x442111[_0x75909b(0x27b)](_0x64f098=>{const _0xa325c=_0x75909b;if(!_0x64f098[_0xa325c(0x25c)]()){let _0x1bc893=fs[_0xa325c(0x1be)](_0x1ef8d3+_0x64f098[_0xa325c(0xf8)]);if(_0x229a12==_0xa325c(0x19c)){const _0x14e3c6=/^bot-[0-9]{3}-config.json$/,_0x4dadf1=_0x14e3c6[_0xa325c(0x237)](_0x64f098[_0xa325c(0xf8)]);if(_0x4dadf1){const _0x3cb3a2=JSON[_0xa325c(0x1c2)](_0x1bc893);if(_0x3cb3a2['bot'][0x0]){_0x3cb3a2['bot'][0x0][_0xa325c(0x180)]='***',_0x3cb3a2[_0xa325c(0x137)][0x0][_0xa325c(0x24f)]=_0xa325c(0x9c);if(_0x3cb3a2[_0xa325c(0x137)][0x0][_0xa325c(0x18f)])_0x3cb3a2['bot'][0x0][_0xa325c(0x18f)]=_0xa325c(0x9c);}_0x1bc893=JSON[_0xa325c(0xb8)](_0x3cb3a2,null,0x2);}if(_0x64f098[_0xa325c(0xf8)]==_0xa325c(0xd1)){const _0x5a668f=JSON['parse'](_0x1bc893);if(_0x5a668f[_0xa325c(0x26d)][_0xa325c(0x19a)])_0x5a668f[_0xa325c(0x26d)]['loginRequired']=![];if(_0x5a668f[_0xa325c(0x26d)][_0xa325c(0x20a)])_0x5a668f[_0xa325c(0x26d)][_0xa325c(0x20a)]=_0xa325c(0x9c);if(_0x5a668f[_0xa325c(0x26d)]['telegramToken'])_0x5a668f[_0xa325c(0x26d)]['telegramToken']=_0xa325c(0x9c);if(_0x5a668f[_0xa325c(0x26d)][_0xa325c(0x1d4)])_0x5a668f[_0xa325c(0x26d)][_0xa325c(0x1d4)]=null;_0x1bc893=JSON['stringify'](_0x5a668f,null,0x2);}if(_0x64f098['name']!=_0xa325c(0x271))_0x1c5cea[_0xa325c(0xe8)](_0x64f098[_0xa325c(0xf8)],_0x1bc893);}else _0x1c5cea[_0xa325c(0xe8)](_0x64f098[_0xa325c(0xf8)],_0x1bc893);}});const _0x4b645a=_0x1c5cea[_0x75909b(0x225)]({'base64':![],'compression':_0x75909b(0x189)});fs[_0x75909b(0xff)](zippath+(_0x229a12+_0x75909b(0x140)),_0x4b645a,'binary');}async function unzipFile(_0x4dd4c7,_0x3e827f){const _0x6cb9a4=_0x56c46b;fs[_0x6cb9a4(0xe0)](configpath,{'withFileTypes':!![]})[_0x6cb9a4(0x27b)](_0x4c6ca6=>{const _0x59f893=_0x6cb9a4;if(!_0x4c6ca6[_0x59f893(0x25c)]())fs['rmSync'](configpath+_0x4c6ca6[_0x59f893(0xf8)]);});const _0x4add55=fs[_0x6cb9a4(0x1be)](_0x4dd4c7+_0x3e827f,_0x6cb9a4(0x247)),_0x2a959e=new require('node-zip')(_0x4add55,{'base64':![],'checkCRC32':!![]});Object[_0x6cb9a4(0x9a)](_0x2a959e['files'])[_0x6cb9a4(0x27b)](_0x526a56=>{const _0x5c7aa0=_0x6cb9a4,_0x58e170=_0x2a959e['files'][_0x526a56];fs[_0x5c7aa0(0xff)](configpath+_0x58e170[_0x5c7aa0(0xf8)],_0x58e170['_data']);}),fs[_0x6cb9a4(0xe0)](temppath,{'withFileTypes':!![]})['forEach'](_0x39498d=>{const _0x16b8c3=_0x6cb9a4;if(!_0x39498d[_0x16b8c3(0x25c)]())fs[_0x16b8c3(0x250)](temppath+_0x39498d[_0x16b8c3(0xf8)]);}),logger[_0x6cb9a4(0x16d)](_0x6cb9a4(0x164)),process['send']({'restore':!![]},_0x402917=>{});}async function getPublicIp(){const _0x3140fb=_0x56c46b;try{const _0x5709f7=await axios[_0x3140fb(0xb4)]('https://api.ipify.org?format=json');publicip=_0x5709f7[_0x3140fb(0xcb)]['ip'];}catch(_0x4741a9){}}async function triggerAnalytics(){const _0x3cd9c1=_0x56c46b;if(!publicip)await getPublicIp();const _0x400d59=getBotsWithMode();let _0x549f7f=0x0;_0x400d59['forEach'](_0x3b70a2=>{const _0x1fa1b9=_0x2a63;if(_0x3b70a2[_0x1fa1b9(0x114)]===_0x1fa1b9(0x1a9))_0x549f7f++;});const _0x271349=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x3cd9c1(0x11f)],'ip':publicip,'version':serverversion,'numbots':_0x400d59['length'],'numbotsenabled':_0x549f7f,'exchanges':_0x271349,'environment':environment});}async function getMessages(){const _0x3e8d34=_0x56c46b,_0x3092c4=_0x3e8d34(0x277),_0x1cec9d=new GraphQLClient(_0x3092c4),_0x3f9e01={'authorization':_0x3e8d34(0x25f)},_0x1a7fd=serverversion['split']('.'),_0x1bec9e=_0x1a7fd[0x0]+'.'+_0x1a7fd[0x1],_0x151073=Math[_0x3e8d34(0xf0)](settings[_0x3e8d34(0x13a)],settings['lastmsgemitted']),_0x53898a={'last':parseInt(_0x151073),'bbm':_0x1bec9e},_0x393002=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x42e497;try{_0x42e497=await _0x1cec9d[_0x3e8d34(0x1b4)](_0x393002,_0x53898a,_0x3f9e01);}catch(_0xbe7f50){}if(_0x42e497&&_0x42e497['messages']){let _0x34d354=settings[_0x3e8d34(0x13a)];newMessages=[];for(const _0x3552d2 of _0x42e497[_0x3e8d34(0x1c8)]){newMessages[_0x3e8d34(0xfd)](_0x3552d2);let _0x2299f1=![];_0x3552d2[_0x3e8d34(0x154)]&&(updateSetting('latestversion',_0x3552d2[_0x3e8d34(0x154)]),_0x2299f1=isNewerVersion(serverversion,_0x3552d2[_0x3e8d34(0x154)])||serverversion==_0x3552d2[_0x3e8d34(0x154)]);if(!_0x2299f1&&_0x3552d2['number']>_0x34d354){if(_0x3552d2[_0x3e8d34(0x1dd)]==='any'||serverversion['startsWith'](_0x3552d2['bbvReceive'])){let _0x209177=''+_0x3552d2[_0x3e8d34(0x1bc)]+'\x0a\x0a'+_0x3552d2[_0x3e8d34(0x1d8)];const _0x3218d0=await sendTelegramMsg(toTelegramMarkdown(_0x209177),_0x3e8d34(0x199));if(_0x3218d0)_0x34d354=_0x3552d2[_0x3e8d34(0x1cc)];}}}updateAvailable=isNewerVersion(settings[_0x3e8d34(0x12a)],serverversion),updateSetting(_0x3e8d34(0x13a),_0x34d354),emitMessages();}}function emitMessages(){const _0x56420a=_0x56c46b,_0x272489=settings[_0x56420a(0xa8)];let _0x452d61=[];newMessages[_0x56420a(0x27b)](_0x36a84a=>{_0x36a84a['number']>_0x272489&&_0x452d61['push'](_0x36a84a);}),_0x452d61[_0x56420a(0x26a)]>0x0&&getAllClients()[_0x56420a(0x27b)](_0x3e2304=>{const _0x444942=_0x56420a;getSocket(_0x3e2304['id'])[_0x444942(0xf5)](_0x444942(0x1d8),_0x452d61);});}function confirmMessage(_0x2e222a){const _0x4fd907=_0x56c46b;updateSetting(_0x4fd907(0xa8),Number(_0x2e222a));}function isNewerVersion(_0x31238c,_0x3a63f8){const _0x5b991f=_0x56c46b,_0x3c7a00=_0x3a63f8[_0x5b991f(0x15a)]('.'),_0x361a19=_0x31238c['split']('.');for(var _0x49209a=0x0;_0x49209a<_0x361a19[_0x5b991f(0x26a)];_0x49209a++){const _0x2a3f98=~~_0x361a19[_0x49209a],_0xe86b83=~~_0x3c7a00[_0x49209a];if(_0x2a3f98>_0xe86b83)return!![];if(_0x2a3f98<_0xe86b83)return![];}return![];}function toTelegramMarkdown(_0x5aa14a){const _0x29533f=_0x56c46b,_0x10bb24=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2b678a=/\*{2}(.+?)\*{2}/gim;return _0x5aa14a=_0x5aa14a[_0x29533f(0x17d)](_0x10bb24,'$1_$2_$3')[_0x29533f(0x17d)](_0x2b678a,'*$1*'),_0x5aa14a;}async function validateConfigFile(){const _0x48e6e3=_0x56c46b,_0x245ff0=dbConfig[_0x48e6e3(0xb4)]('bots')[_0x48e6e3(0x216)]('botID')[_0x48e6e3(0x1bd)]()||[];if(_0x245ff0['length']==0x0){let _0x3260a7=0x0,_0x2e7294=[];const _0x30ce12=/^bot-([0-9]{3})-config.json$/,_0x4f81d0=fs[_0x48e6e3(0xe0)](configpath);_0x4f81d0[_0x48e6e3(0x27b)](_0x136d56=>{const _0x16cb2d=_0x48e6e3,_0x3d4ee8=_0x30ce12[_0x16cb2d(0x1a4)](_0x136d56);if(_0x3d4ee8){const _0x2fdeaf=_0x3d4ee8[0x1];let _0x38b64a=getBotAttributes(_0x2fdeaf);_0x2e7294[_0x16cb2d(0xfd)]({'botID':_0x2fdeaf,'botname':_0x38b64a[_0x16cb2d(0x10d)],'status':'disabled','live':_0x16cb2d(0x273)}),_0x3260a7++;}}),_0x3260a7!=0x0&&(dbConfig[_0x48e6e3(0xb4)](_0x48e6e3(0x229))['assign'](_0x2e7294)['write'](),config=_0x2e7294,restoredConfigFile=_0x3260a7);}}async function restoreConfigNotify(_0x20bfd3){const _0x30ba61=_0x56c46b;let _0x5b334b;if(restoredConfigFile==0x1)_0x5b334b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x5b334b=_0x30ba61(0x283);if(_0x20bfd3)io['to'](_0x30ba61(0xdb))[_0x30ba61(0xf5)]('notification',_0x5b334b);else{logger[_0x30ba61(0x99)](_0x30ba61(0xeb)),logger[_0x30ba61(0x99)](_0x5b334b),logger[_0x30ba61(0x99)](_0x30ba61(0xeb)),logger[_0x30ba61(0x99)]('');if(tgBot&&settings[_0x30ba61(0x1d4)]&&settings[_0x30ba61(0x1e2)]!=_0x30ba61(0x15e))await sendTelegram(settings[_0x30ba61(0x1d4)],_0x30ba61(0x1fa)+_0x5b334b);}}function validateCredentials(_0x2f1a46,_0xc6498d){const _0x2346e8=_0x56c46b;if(_0x2f1a46[_0x2346e8(0xc6)]==settings['bbUsername']&&bcrypt[_0x2346e8(0x15b)](_0x2f1a46[_0x2346e8(0x1fe)],settings[_0x2346e8(0x20a)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x2346e8(0xb1),'token':null};else{const _0x4d4253=generateLoginToken(_0xc6498d);return{'allow':!![],'reason':_0x2346e8(0xc9),'token':_0x4d4253};}}else return{'allow':![],'reason':_0x2346e8(0x264),'token':null};}function refreshToken(_0x5d9230){const _0x343902=_0x56c46b,_0x24b94b=generateLoginToken(_0x5d9230);return{'allow':!![],'reason':_0x343902(0xc9),'token':_0x24b94b};}function validateAccess(_0x4c9dcc,_0x1e869d,_0x179557){const _0x41b493=_0x56c46b,_0x1b08b4=_0x179557?_0x179557:devices[_0x1e869d]['ip'];let _0x2559e3;const _0x26491f=_0x32685a=>{const _0x55bdf6=_0x2a63;if(settings['loginRequired']){if(settings[_0x55bdf6(0x25e)]){if(telegram2FaApproved(_0x1e869d)){const _0x2ad15f=generateLoginToken(_0x1e869d);return{'allow':!![],'reason':_0x55bdf6(0x101),'token':_0x2ad15f};}else return{'allow':![],'reason':_0x55bdf6(0xec),'token':null};}else return _0x2559e3=validToken(_0x32685a,_0x1e869d),_0x2559e3[_0x55bdf6(0x26e)]('success')?{'allow':!![],'reason':_0x55bdf6(0x1a6),'token':_0x32685a}:{'allow':![],'reason':_0x55bdf6(0xec),'token':null};}else return{'allow':!![],'reason':_0x55bdf6(0x1c0),'token':null};};if(settings[_0x41b493(0x1f0)]){let _0x5eb2da=[...settings[_0x41b493(0x262)],'::1',_0x41b493(0xfa),_0x41b493(0xee)];if(_0x5eb2da['includes'](_0x1b08b4))return _0x26491f(_0x4c9dcc);else{_0x2559e3=validToken(_0x4c9dcc,_0x1e869d);if(_0x2559e3['hasOwnProperty']('success'))return _0x26491f(_0x4c9dcc);else{if(telegramIpApproved(_0x1e869d)){const _0x57919d=generateToken(_0x1e869d);return _0x2559e3=_0x26491f(_0x4c9dcc),_0x2559e3[_0x41b493(0xe6)]?{'allow':!![],'reason':_0x41b493(0x249),'token':_0x57919d}:_0x2559e3;}else return settings[_0x41b493(0x219)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x41b493(0x15c),'token':null};}}}else return _0x26491f(_0x4c9dcc);}function timelyDecrypt(_0x1cdaa9,_0x44dfce=!![]){const _0x25bb0b=_0x56c46b;if(_0x1cdaa9)try{const _0x120a69=crypt['decrypt'](secure[_0x25bb0b(0x26b)],_0x1cdaa9)[_0x25bb0b(0x1d8)],_0x1586e0=_0x120a69['split']('@')[0x0],_0x36c292=_0x120a69[_0x25bb0b(0x15a)]('@')[0x1],_0x55e802=new Date()[_0x25bb0b(0x1b2)]();if(_0x44dfce){if(_0x55e802-_0x36c292<maxSecretAge*0x3e8)return _0x1586e0;else return![];}else return _0x1586e0;}catch(_0x40f362){return![];}else return![];}const validToken=(_0x3b5d85,_0x151219)=>{const _0x21dca4=_0x56c46b,_0x189af3=devices[_0x151219]['ip'];if(!_0x3b5d85)return{'error':_0x21dca4(0x184)};for(let _0x4e689b of blacklist){if(_0x4e689b[_0x21dca4(0x103)]==_0x3b5d85)return{'error':_0x21dca4(0xce)};}let _0x2c9769;try{_0x2c9769=jwt[_0x21dca4(0x253)](_0x3b5d85,secure[_0x21dca4(0x106)]+_0x151219);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x2c9769[_0x21dca4(0x26e)](_0x21dca4(0x1c4))&&!_0x2c9769[_0x21dca4(0x26e)](_0x21dca4(0xc6))||!_0x2c9769[_0x21dca4(0x26e)](_0x21dca4(0x113)))return{'error':_0x21dca4(0xf4)};if(!_0x2c9769[_0x21dca4(0x26e)](_0x21dca4(0xc6))&&_0x2c9769[_0x21dca4(0x26e)](_0x21dca4(0x1c4))){const {clientip:_0x53a84d}=_0x2c9769;return _0x189af3==_0x53a84d?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x21dca4(0x202)};}else{if(_0x2c9769[_0x21dca4(0x26e)]('username')&&_0x2c9769[_0x21dca4(0x26e)](_0x21dca4(0x1c4))){const {username:_0x55d0ab,clientip:_0x4068e2}=_0x2c9769;return settings[_0x21dca4(0x21b)]==_0x55d0ab&&_0x189af3==_0x4068e2?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x21dca4(0x179)};}}},generateLoginToken=_0xb443d7=>{const _0xe3acc2=_0x56c46b;if(_0xb443d7){const _0x252c47=devices[_0xb443d7]['ip'];return jwt[_0xe3acc2(0x17e)]({'username':settings['bbUsername'],'clientip':_0x252c47},secure[_0xe3acc2(0x106)]+_0xb443d7,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4d34db=>{const _0x5bbdf5=_0x56c46b;if(_0x4d34db){const _0x272738=devices[_0x4d34db]['ip'];return jwt['sign']({'clientip':_0x272738},secure['secret']+_0x4d34db,{'expiresIn':devices[_0x4d34db][_0x5bbdf5(0x1e9)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x50d228=>{const _0x5900c6=_0x56c46b;let _0x27ff04=![];return devices[_0x50d228][_0x5900c6(0x1e9)]&&devices[_0x50d228][_0x5900c6(0x1e9)][_0x5900c6(0x282)]!=_0x5900c6(0x233)&&(_0x27ff04=devices[_0x50d228][_0x5900c6(0x1e9)][_0x5900c6(0x1c4)]==devices[_0x50d228]['ip']&&new Date()[_0x5900c6(0x1b2)]()-devices[_0x50d228][_0x5900c6(0x1e9)][_0x5900c6(0x279)]<devices[_0x50d228][_0x5900c6(0x1e9)][_0x5900c6(0x282)]*0x3c*0x3e8),_0x27ff04;},telegram2FaApproved=_0x3d36e1=>{const _0x24a85c=_0x56c46b;let _0x17a60a=![];return devices[_0x3d36e1][_0x24a85c(0x19e)]&&devices[_0x3d36e1][_0x24a85c(0x19e)]['expiry']!=_0x24a85c(0x233)&&(_0x17a60a=devices[_0x3d36e1][_0x24a85c(0x19e)][_0x24a85c(0x1c4)]==devices[_0x3d36e1]['ip']&&new Date()[_0x24a85c(0x1b2)]()-devices[_0x3d36e1][_0x24a85c(0x19e)]['timestamp']<devices[_0x3d36e1][_0x24a85c(0x19e)][_0x24a85c(0x282)]*0x3c*0x3e8),_0x17a60a;},normalizeIP=_0x49fc16=>{const _0x320cdc=_0x56c46b;let _0x22b667=null,_0x332273=null;if(ipaddr[_0x320cdc(0x201)](_0x49fc16)){const _0x4500cc=ipaddr['parse'](_0x49fc16);_0x4500cc['kind']()===_0x320cdc(0x9b)?(_0x4500cc[_0x320cdc(0x226)]()&&(_0x22b667=_0x4500cc[_0x320cdc(0x19f)]()[_0x320cdc(0x13c)]()),_0x332273=_0x4500cc[_0x320cdc(0x13c)]()):(_0x22b667=_0x4500cc['toString'](),_0x332273=_0x4500cc['toIPv4MappedAddress']()[_0x320cdc(0x13c)]());}return{'show':_0x22b667?_0x22b667:_0x332273,'store':_0x332273};};function formatDate(_0xe34cd1){const _0x12a4b7=_0x56c46b;return _0xe34cd1['getFullYear']()+'/'+(_0xe34cd1[_0x12a4b7(0x23d)]()+0x1)['toString']()[_0x12a4b7(0xda)](0x2,'0')+'/'+_0xe34cd1[_0x12a4b7(0x109)]()[_0x12a4b7(0x13c)]()['padStart'](0x2,'0')+'\x20'+_0xe34cd1[_0x12a4b7(0xba)]()['toString']()[_0x12a4b7(0xda)](0x2,'0')+':'+_0xe34cd1[_0x12a4b7(0x150)]()[_0x12a4b7(0x13c)]()[_0x12a4b7(0xda)](0x2,'0')+':'+_0xe34cd1[_0x12a4b7(0x1c6)]()[_0x12a4b7(0x13c)]()[_0x12a4b7(0xda)](0x2,'0');}function sleep(_0x4e14ba){return new Promise(_0x469c40=>setTimeout(_0x469c40,_0x4e14ba));}