const _0x9aac6c=_0x2259;(function(_0x15f8c8,_0x251fc2){const _0x23ca73=_0x2259,_0x1568b6=_0x15f8c8();while(!![]){try{const _0xfe4883=parseInt(_0x23ca73(0x1b6))/0x1*(-parseInt(_0x23ca73(0x19f))/0x2)+-parseInt(_0x23ca73(0x24a))/0x3*(parseInt(_0x23ca73(0x16a))/0x4)+-parseInt(_0x23ca73(0x234))/0x5*(parseInt(_0x23ca73(0x1e8))/0x6)+-parseInt(_0x23ca73(0x21b))/0x7+parseInt(_0x23ca73(0x1b3))/0x8*(-parseInt(_0x23ca73(0x1da))/0x9)+parseInt(_0x23ca73(0x22c))/0xa+parseInt(_0x23ca73(0x185))/0xb*(parseInt(_0x23ca73(0x1ba))/0xc);if(_0xfe4883===_0x251fc2)break;else _0x1568b6['push'](_0x1568b6['shift']());}catch(_0x2cbeca){_0x1568b6['push'](_0x1568b6['shift']());}}}(_0x10d1,0x34f4c));const _0x45f19a=function(){let _0x5f3c90=!![];return function(_0x3cef8c,_0x5acb1f){const _0x39b07b=_0x5f3c90?function(){const _0x53d378=_0x2259;if(_0x5acb1f){const _0x343a94=_0x5acb1f[_0x53d378(0x10f)](_0x3cef8c,arguments);return _0x5acb1f=null,_0x343a94;}}:function(){};return _0x5f3c90=![],_0x39b07b;};}(),_0x49a91e=_0x45f19a(this,function(){const _0x167924=_0x2259;return _0x49a91e[_0x167924(0x1d5)]()[_0x167924(0x208)](_0x167924(0x23f))[_0x167924(0x1d5)]()[_0x167924(0x13e)](_0x49a91e)[_0x167924(0x208)](_0x167924(0x23f));});_0x49a91e();'use strict';process[_0x9aac6c(0x10e)][_0x9aac6c(0x154)]=0x1;const childProcess=require(_0x9aac6c(0x171)),FileSync=require(_0x9aac6c(0x122)),fs=require('fs'),fns=require(_0x9aac6c(0x224)),low=require('lowdb'),path=require(_0x9aac6c(0x22d)),crypto=require(_0x9aac6c(0x151)),Crypt=require(_0x9aac6c(0x152))['Crypt'],RSA=require(_0x9aac6c(0x152))[_0x9aac6c(0x239)],bcrypt=require(_0x9aac6c(0x131)),jwt=require('jsonwebtoken'),analyticsLib=require(_0x9aac6c(0x230))['default'],googleAnalytics=require(_0x9aac6c(0x1e3))[_0x9aac6c(0x1db)],ipaddr=require(_0x9aac6c(0x20d)),argv=require('yargs/yargs')(process[_0x9aac6c(0x11a)]['slice'](0x2))[_0x9aac6c(0x11a)],PORT=argv[_0x9aac6c(0x183)]||_0x9aac6c(0x1a8),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x9aac6c(0x173)](PORT))return console[_0x9aac6c(0x1ad)](_0x9aac6c(0x22f)+PORT+_0x9aac6c(0x17c)),process[_0x9aac6c(0x19e)](0x1);const HOST=argv[_0x9aac6c(0x134)]||null,userID=argv[_0x9aac6c(0x23c)]||'';let bbpath=_0x9aac6c(0x23e),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x9aac6c(0x21d),securefile=_0x9aac6c(0x1c5);!fs[_0x9aac6c(0x1e2)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x9aac6c(0x1aa)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/';!fs[_0x9aac6c(0x1e2)](configpath)&&fs[_0x9aac6c(0x237)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x9aac6c(0x1d4)]({'bots':[]})[_0x9aac6c(0x1bf)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x9aac6c(0x1d4)]({'settings':{'timeshift':0x0}})[_0x9aac6c(0x1bf)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x9aac6c(0x1d4)]({'secure':{},'blacklist':[]})[_0x9aac6c(0x1bf)]();let crypt=new Crypt({'md':_0x9aac6c(0x10c),'rsaStandard':_0x9aac6c(0x1f1)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x9aac6c(0x11f))[_0x9aac6c(0x211)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();function _0x10d1(){const _0x1b3edf=['\x20only\x0a','lowdb/adapters/FileSync','max','socket.io','ipv6','orders','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','::ffff:127.0.0.1','length','pidRefreshToken','from','index.html','whitelistEnabled','invalid\x20credentials','callback_query','Notifications\x20disabled\x0a','bcryptjs','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/:bot','host','join','-----------------------------------------------------------------------------------','alerts','listen','bbUsername','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','find','referer','Notifications\x20enabled','constructor','readdirSync','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','copyFileSync','get','error','parse','emit','telegramIpApproval','map','toIPv4MappedAddress','starting\x20new\x20bot\x20|\x20Bot\x20','access\x20timeout','2FA\x20required','inherit','storeHeadless','https://hodlerhacks.com','Unauthorized\x20attempt\x20to\x20store\x20configuration','get-starting-balances','crypto','hybrid-crypto-js','place-order','NTBA_FIX_319','store-configuration','get-logs','function','type','static','onText','404\x20Not\x20Found','/status\x20-\x20show\x20bot(s)\x20status\x0a','catch','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','disabled','bot-','starting\x20bot\x20|\x20Bot\x20','************','telegramEvents','Invalid\x20Telegram\x20token','send','getStartingBalances','getDate','sendMessage','disconnect','12KqTbRb','telegramUsername','bbPassword','::1','name','/off\x20-\x20stop\x20bot(s)\x0a','enabled\x20Bot\x20','child_process','remoteAddress','test','clientip','timeshift','placeOrder','hex','error\x20while\x20deleting\x20config\x20files:\x20','isDirectory','bots','live',',\x20must\x20be\x20a\x204\x20digit\x20number','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','stop','30\x20min','padStart','telegramToken','port','keys','14146eVkvJp','sendFile','delete-bot','</b>\x20?','<b>Balance\x20Bot\x20status:</b>\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','value','telegramEnabled','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20delete\x20bot','privateKey','data','token','reason','message','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','telegramChatId','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','\x20|\x20',':\x20Bot\x20Mgr\x20>\x20','isValid','sockets','Ok,\x20will\x20send\x20alert\x20notifications\x20only','SIGTERM','Invalid\x20IP\x20address','exit','94Ciqgkd','storeConfiguration','success','exp','Password\x20reset\x20rejected','emitHistory','Bot\x20','Balance\x20Bot','unlinkSync','3000','All','config/','sign','logout','log','allow','running','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Access\x20enabled\x20for\x20','Temporary\x20access\x20rejected','469648tNyAPB','No\x20bots\x20running\x20right\x20now','hashSync','1583LTExOG','settings.','2FA\x20login\x20required','use','8772jSVNZH','/:bot/configuration','User\x20has\x20been\x20validated','getSeconds','notification','write','build2','Allow\x20login\x20from\x20IP\x20address\x20<b>','order','split','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','bb-secure.json','1000','/:bot/coins','\x20>\x20','Unauthorized\x20login\x20attempt\x20(public\x20key)','login\x20token\x20generated','telegram','headers','<b>Telegram\x20bot\x20status:</b>\x0a','login\x20required','build','new','store-headless','login','filter','defaults','toString','-performance.json','status','getHours','/help\x20-\x20show\x20available\x20commands\x0a','9aObZvz','default','getMonth','-config.json','Invalid\x20authentication\x20token\x20(2)','auth','assign','deleted\x20Bot\x20','existsSync','@analytics/google-analytics','forEach','/:bot/performance','set','reload','32556oxPJwA','2FA','settings','pidExpireLogin','Orders','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20update\x20settings','store-settings','chat','RSA-OAEP','cloneDeep','/:bot/portfolio','blacklist','botID','-results.json','login\x20not\x20required','entries','telegram2FaApproval','whitelist','127.0.0.1','kill','Unauthorized\x20attempt\x20to\x20add\x20bot','toIPv4Address','express','Login\x20accepted','uuid','Unauthorized\x20attempt\x20to\x20update\x20bot','connected','once','add-bot','idling\x20bot\x20\x20\x20|\x20Bot\x20','secret','search','Ok,\x20will\x20send\x20order\x20notifications\x20only','stopped','loginRequired','Invalid\x20authentication\x20token\x20(1)','ipaddr.js','temporary\x20access\x20timeout','sortBy','/restart\x20-\x20restart\x20bot(s)\x0a','version','getPortfolio','botmanager','getFullYear','\x20minutes','timestamp','page','conn','match','verify','593488rhdjFZ','getMinutes','bb-settings.json','all','cancel-loading','event','expiry','new-disabled','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','date-fns','enabled','All\x20bots','HTML','Token\x20blacklisted','reset-password','No\x20authentication\x20token','/disable\x20-\x20disable\x20notifications\x0a','486960lwXzWc','path','hasOwnProperty','Error:\x20Invalid\x20argument\x20','analytics','bot','access','decrypt','325ElfQfH','temporary\x20access\x20rejected','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','mkdirSync','f2aRequired','RSA','server','reject','user','stopPolling','bb/','(((.+)+)+)+$','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','password','botname','-events.json','answerCallbackQuery','getTime','temporaryAccessAllowed','showname','args','remove','201273MRLZOo','then','randomFillSync','UA-192771731-1','push','show','encryptedUuid','removeListener','sha256','2FA\x20login\x20rejected','env','apply','accept','publicKey','logged\x20out','connection','polling_error','Unauthorized\x20attempt\x20to\x20log\x20out','username','Login\x20rejected','15\x20min','includes','argv','cancelLoading','add','get-portfolio','/:bot/history','version.json','update-bot'];_0x10d1=function(){return _0x1b3edf;};return _0x10d1();}const express=require(_0x9aac6c(0x1ff)),app=express(),http=require('http')['createServer'](app);app[_0x9aac6c(0x1b9)](express['static'](path[_0x9aac6c(0x135)](__dirname,bbpath2,'build2'))),app[_0x9aac6c(0x1b9)](express[_0x9aac6c(0x159)](path[_0x9aac6c(0x135)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x394b10,_0x3cd829){const _0x3829d0=_0x9aac6c;_0x3cd829[_0x3829d0(0x186)](path['join'](__dirname,bbpath2,_0x3829d0(0x1c0),_0x3829d0(0x12c)));}),app['get'](_0x9aac6c(0x133),function(_0x7a7bdd,_0x177c42){const _0x19b8d2=_0x9aac6c;_0x177c42[_0x19b8d2(0x186)](path['join'](__dirname,bbpath2,_0x19b8d2(0x1cf),_0x19b8d2(0x12c)));}),app[_0x9aac6c(0x142)](_0x9aac6c(0x1f3),(_0x32b9df,_0x1cbe26)=>{const _0x1893a1=_0x9aac6c;_0x1cbe26[_0x1893a1(0x186)](path[_0x1893a1(0x135)](__dirname,bbpath2,_0x1893a1(0x1cf),_0x1893a1(0x12c)));}),app[_0x9aac6c(0x142)](_0x9aac6c(0x1e5),(_0x38ae2d,_0x8d75b8)=>{const _0x533937=_0x9aac6c;_0x8d75b8[_0x533937(0x186)](path[_0x533937(0x135)](__dirname,bbpath2,_0x533937(0x1cf),'index.html'));}),app[_0x9aac6c(0x142)](_0x9aac6c(0x1c7),(_0x512b04,_0x2e5e6c)=>{const _0x1f9d11=_0x9aac6c;_0x2e5e6c[_0x1f9d11(0x186)](path['join'](__dirname,bbpath2,_0x1f9d11(0x1cf),'index.html'));}),app[_0x9aac6c(0x142)](_0x9aac6c(0x11e),(_0x320e0b,_0x2c1897)=>{const _0x465b6b=_0x9aac6c;_0x2c1897[_0x465b6b(0x186)](path[_0x465b6b(0x135)](__dirname,bbpath2,_0x465b6b(0x1cf),_0x465b6b(0x12c)));}),app['get'](_0x9aac6c(0x1bb),(_0x438498,_0x179a19)=>{const _0x101a9c=_0x9aac6c;_0x179a19['sendFile'](path['join'](__dirname,bbpath2,_0x101a9c(0x1cf),_0x101a9c(0x12c)));}),app['get']('/:bot/support',(_0x26bcda,_0x27dff5)=>{const _0x4a73f9=_0x9aac6c;_0x27dff5[_0x4a73f9(0x186)](path[_0x4a73f9(0x135)](__dirname,bbpath2,_0x4a73f9(0x1cf),_0x4a73f9(0x12c)));});if(HOST)http['listen'](PORT,HOST);else http[_0x9aac6c(0x138)](PORT);const io=require(_0x9aac6c(0x124))(http,{}),analytics=analyticsLib({'app':_0x9aac6c(0x1a6),'plugins':[googleAnalytics({'trackingId':_0x9aac6c(0x107)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings['telegramToken']&&settings[_0x9aac6c(0x182)]!=''&&settings[_0x9aac6c(0x16b)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x3d6531=_0x9aac6c;console[_0x3d6531(0x1ad)](''),console[_0x3d6531(0x1ad)](_0x3d6531(0x136)),logging(_0x3d6531(0x196)+PORT),console[_0x3d6531(0x1ad)](_0x3d6531(0x136));if(config[_0x3d6531(0x129)]!=0x0)config[_0x3d6531(0x1e4)](_0x148bd5=>{const _0x12e2be=_0x3d6531;if(_0x148bd5[_0x12e2be(0x1d7)]==_0x12e2be(0x225)||_0x148bd5[_0x12e2be(0x1d7)]=='new')logging(_0x12e2be(0x161)+_0x148bd5[_0x12e2be(0x1f5)]+_0x12e2be(0x197)+_0x148bd5['botname']),startBot([_0x148bd5[_0x12e2be(0x1f5)],userID],{'cwd':bbpath},function(_0x5dd73a){if(_0x5dd73a)logging(_0x5dd73a);});else(_0x148bd5[_0x12e2be(0x1d7)]==_0x12e2be(0x15f)||_0x148bd5[_0x12e2be(0x1d7)]==_0x12e2be(0x222))&&logging(_0x12e2be(0x206)+_0x148bd5['botID']+_0x12e2be(0x197)+_0x148bd5['botname']);});else!newBot&&console[_0x3d6531(0x1ad)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x3d6531(0x1ad)](_0x3d6531(0x136)),console[_0x3d6531(0x1ad)]('');}function startSocket(){const _0x1490fe=_0x9aac6c;io['on'](_0x1490fe(0x113),_0x54253c=>{const _0x2c4ebd=_0x1490fe;let _0x5cea2d,_0x2724e6,_0x2d5eea,_0xf3f28d,_0x221dad;const _0x101164=_0x54253c['handshake'][_0x2c4ebd(0x1cc)][_0x2c4ebd(0x13c)];_0x2724e6=_0x101164[_0x2c4ebd(0x219)](/bot[0-9]{3}/);if(_0x2724e6)_0x2d5eea=_0x2724e6[0x0][_0x2c4ebd(0x219)](/[0-9]{3}/);if(_0x2d5eea)_0x5cea2d=_0x2d5eea[0x0];else _0x5cea2d=_0x2c4ebd(0x213);const _0x5411a0=_0x54253c['handshake'][_0x2c4ebd(0x1df)][_0x2c4ebd(0x10a)];if(!_0x5411a0)_0x54253c[_0x2c4ebd(0x145)](_0x2c4ebd(0x1d7),{'publicKey':secure[_0x2c4ebd(0x111)]});else{_0xf3f28d=timelyDecrypt(_0x5411a0,![]);if(!_0xf3f28d)logging(_0x2c4ebd(0x1c9));else{_0x221dad=normalizeIP(_0x54253c[_0x2c4ebd(0x218)][_0x2c4ebd(0x172)])['store'];if(!devices[_0xf3f28d])devices[_0xf3f28d]={'uuid':_0xf3f28d,'access':{'token':null}};devices[_0xf3f28d]['ip']=_0x221dad;const _0x2c4b2b=addClient(_0x54253c['id'],_0xf3f28d,_0x5cea2d);setAccess(_0x2c4b2b),_0x54253c['on']('login',_0x1baa14=>{const _0x854879=_0x2c4ebd,_0x589ee2=timelyDecrypt(_0x1baa14[_0x854879(0x241)]);if(_0x589ee2){_0x1baa14={'username':_0x1baa14[_0x854879(0x116)],'password':_0x589ee2},devices[_0xf3f28d][_0x854879(0x232)]=validateCredentials(_0x1baa14,_0xf3f28d);if(devices[_0xf3f28d][_0x854879(0x232)]['allow']==![]&&devices[_0xf3f28d][_0x854879(0x232)][_0x854879(0x192)]==_0x854879(0x1b8))_0x54253c['emit'](_0x854879(0x1d7),{'access':devices[_0xf3f28d][_0x854879(0x232)]}),loginAccess2FA(_0xf3f28d,_0x221dad);else{if(devices[_0xf3f28d][_0x854879(0x232)][_0x854879(0x1ae)]==![]&&devices[_0xf3f28d][_0x854879(0x232)][_0x854879(0x192)]==_0x854879(0x12e))_0x54253c[_0x854879(0x145)](_0x854879(0x1d7),{'access':devices[_0xf3f28d][_0x854879(0x232)]});else devices[_0xf3f28d][_0x854879(0x232)]['allow']&&devices[_0xf3f28d]['access'][_0x854879(0x192)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0xf3f28d)['forEach'](_0x581f6c=>{setAccess(_0x581f6c);}),setTokenRefresh(_0xf3f28d),setSessionTimeout('login',_0xf3f28d));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x54253c['on'](_0x2c4ebd(0x229),()=>{resetPassword();}),_0x54253c['on'](_0x2c4ebd(0x169),_0x5774f5=>{removeClient(_0x54253c['id']);});}}});}function initClient(_0x5779a5){const _0x14269f=_0x9aac6c;if(_0x5779a5!=_0x14269f(0x213)&&config['apiKey']!=''){if(pid[_0x5779a5])pid[_0x5779a5]['send']({'function':'initclient','args':null});}}function getSocket(_0x21b9d9){const _0x52f1f8=_0x9aac6c;return io[_0x52f1f8(0x19a)]['sockets'][_0x52f1f8(0x142)](_0x21b9d9);}function setAccess(_0x250669){const _0x4ed19b=_0x9aac6c,_0x5ede7d=getSocket(_0x250669['id']),_0x2eb532=_0x250669[_0x4ed19b(0x201)],_0x3c21ee=_0x250669['bot'];devices[_0x2eb532][_0x4ed19b(0x232)]=validateAccess(devices[_0x2eb532][_0x4ed19b(0x232)][_0x4ed19b(0x191)],_0x2eb532),_0x5ede7d['join'](_0x2eb532);if(devices[_0x2eb532][_0x4ed19b(0x232)][_0x4ed19b(0x1ae)]){_0x5ede7d[_0x4ed19b(0x135)](_0x3c21ee);if(_0x3c21ee==_0x4ed19b(0x213))initializeSocketBotManager(_0x5ede7d);else initializeSocketBot(_0x5ede7d);initClient(_0x3c21ee);}devices[_0x2eb532]['access'][_0x4ed19b(0x191)]&&devices[_0x2eb532][_0x4ed19b(0x232)]['reason']==_0x4ed19b(0x1ed)&&setSessionTimeout(_0x4ed19b(0x1e9),_0x2eb532),devices[_0x2eb532]['access'][_0x4ed19b(0x191)]&&devices[_0x2eb532][_0x4ed19b(0x232)][_0x4ed19b(0x192)]==_0x4ed19b(0x18d)&&setSessionTimeout('login',_0x2eb532),_0x5ede7d[_0x4ed19b(0x145)](_0x4ed19b(0x1d7),{'status':_0x250669[_0x4ed19b(0x23a)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2eb532]['access'],'externalip':devices[_0x2eb532]['ip'],'publicKey':secure[_0x4ed19b(0x111)]}),devices[_0x2eb532][_0x4ed19b(0x232)]['allow']==![]&&devices[_0x2eb532][_0x4ed19b(0x232)][_0x4ed19b(0x192)]==_0x4ed19b(0x14b)&&temporaryAccess2FA(_0x2eb532,devices[_0x2eb532]['ip']);}function setSessionTimeout(_0x3bf5f4,_0x25a814){const _0x31f41b=_0x9aac6c;let _0xd94412;if(_0x3bf5f4==_0x31f41b(0x1d2))_0xd94412=loginExpiry*0x3c*0x3e8;else _0xd94412=devices[_0x25a814][_0x31f41b(0x146)]['expiry']*0x3c*0x3e8-(new Date()[_0x31f41b(0x245)]()-devices[_0x25a814][_0x31f41b(0x146)][_0x31f41b(0x216)]);if(devices[_0x25a814][_0x31f41b(0x1eb)])clearTimeout(devices[_0x25a814][_0x31f41b(0x1eb)]);devices[_0x25a814][_0x31f41b(0x1eb)]=setTimeout(()=>{const _0x461a6b=_0x31f41b;if(devices[_0x25a814][_0x461a6b(0x12a)])clearTimeout(devices[_0x25a814][_0x461a6b(0x12a)]);removeSocketListeners(_0x25a814),addBlacklist(_0x25a814),devices[_0x25a814][_0x461a6b(0x146)]=null,devices[_0x25a814][_0x461a6b(0x1f9)]=null,devices[_0x25a814]['access']['token']=null,devices[_0x25a814]['access']=validateAccess(devices[_0x25a814][_0x461a6b(0x232)]['token'],_0x25a814),!(devices[_0x25a814]['access']['allow']&&devices[_0x25a814][_0x461a6b(0x232)][_0x461a6b(0x192)]==_0x461a6b(0x1f7))&&(_0x3bf5f4=='login'?io['to'](_0x25a814)[_0x461a6b(0x145)](_0x461a6b(0x1d7),{'access':{'allow':![],'reason':_0x461a6b(0x14a),'token':null}}):io['to'](_0x25a814)['emit'](_0x461a6b(0x1d7),{'access':{'allow':![],'reason':_0x461a6b(0x20e),'token':null}})),devices[_0x25a814]['access'][_0x461a6b(0x191)]=null;},_0xd94412);}function setTokenRefresh(_0x40b553){const _0x5916f1=_0x9aac6c;if(devices[_0x40b553][_0x5916f1(0x12a)])clearTimeout(devices[_0x40b553][_0x5916f1(0x12a)]);devices[_0x40b553][_0x5916f1(0x12a)]=setTimeout(()=>{const _0x197a3a=_0x5916f1;getClientsWithUuid(_0x40b553)[_0x197a3a(0x129)]!=0x0?(devices[_0x40b553][_0x197a3a(0x232)]=refreshToken(_0x40b553),io['to'](_0x40b553)['emit'](_0x197a3a(0x1d7),{'status':_0x197a3a(0x203),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x40b553][_0x197a3a(0x232)],'externalip':devices[_0x40b553]['ip'],'publicKey':secure[_0x197a3a(0x111)]}),setTokenRefresh(_0x40b553)):clearTimeout(devices[_0x40b553][_0x197a3a(0x12a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2a4208){const _0x2fb11c=_0x9aac6c,_0x5a5753=getClient(_0x2a4208['id'])['uuid'];_0x2a4208[_0x2fb11c(0x145)](_0x2fb11c(0x17a),config),_0x2a4208['emit'](_0x2fb11c(0x1ea),cleanSettings()),_0x2a4208['on'](_0x2fb11c(0x205),_0x8c13e9=>{const _0xd725fa=_0x2fb11c;if(validateAccess(_0x8c13e9,_0x5a5753)['allow'])addBot();else logging(_0xd725fa(0x1fd));}),_0x2a4208['on'](_0x2fb11c(0x120),(_0x397e63,_0x22ce97)=>{const _0x5d6296=_0x2fb11c;if(validateAccess(_0x22ce97,_0x5a5753)[_0x5d6296(0x1ae)])toggleBot(_0x397e63['botID'],_0x397e63['status'],_0x397e63[_0x5d6296(0x17b)]);else logging(_0x5d6296(0x202));}),_0x2a4208['on'](_0x2fb11c(0x187),(_0x5efc39,_0x4e17bc)=>{const _0x27cbde=_0x2fb11c;if(validateAccess(_0x4e17bc,_0x5a5753)[_0x27cbde(0x1ae)])deleteBot(_0x5efc39);else logging(_0x27cbde(0x18e));}),_0x2a4208['on'](_0x2fb11c(0x1ef),(_0x2be209,_0x167156)=>{const _0x1556c5=_0x2fb11c;if(validateAccess(_0x167156,_0x5a5753)[_0x1556c5(0x1ae)])storeSettings(_0x2be209,!![]);else logging(_0x1556c5(0x1ee));}),_0x2a4208['on']('update-bb',(_0x5bb874,_0x4885b3)=>{const _0x58708a=_0x2fb11c;if(validateAccess(_0x4885b3,_0x5a5753)[_0x58708a(0x1ae)])updateBB();else logging(_0x58708a(0x1ee));}),_0x2a4208['on']('logout',_0x3065d4=>{const _0x2e9113=_0x2fb11c;if(validateAccess(_0x3065d4,_0x5a5753)[_0x2e9113(0x1ae)]){if(devices[_0x5a5753][_0x2e9113(0x12a)])clearTimeout(devices[_0x5a5753][_0x2e9113(0x12a)]);if(devices[_0x5a5753][_0x2e9113(0x1eb)])clearTimeout(devices[_0x5a5753]['pidExpireLogin']);removeSocketListeners(getClient(_0x2a4208['id'])[_0x2e9113(0x201)]),addBlacklist(_0x5a5753),devices[_0x5a5753][_0x2e9113(0x146)]=null,devices[_0x5a5753][_0x2e9113(0x1f9)]=null,devices[_0x5a5753][_0x2e9113(0x232)]['token']=null,io['to'](getClient(_0x2a4208['id'])[_0x2e9113(0x201)])[_0x2e9113(0x145)](_0x2e9113(0x1d7),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x2e9113(0x115));});}function initializeSocketBot(_0x44d1d8){const _0x549a8b=_0x9aac6c,_0x57af95=getClient(_0x44d1d8['id'])[_0x549a8b(0x231)],_0x49e09d=getClient(_0x44d1d8['id'])[_0x549a8b(0x201)];_0x44d1d8['on'](_0x549a8b(0x156),(_0x5d4580,_0xf228dd)=>{const _0x237683=_0x549a8b;if(validateAccess(_0xf228dd,_0x49e09d)[_0x237683(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95][_0x237683(0x165)]({'function':_0x237683(0x1a4),'args':_0x5d4580});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x44d1d8['on'](_0x549a8b(0x11d),(_0x39d3c3,_0x10ff5b)=>{const _0x342d29=_0x549a8b;if(validateAccess(_0x10ff5b,_0x49e09d)[_0x342d29(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95][_0x342d29(0x165)]({'function':_0x342d29(0x212),'args':_0x39d3c3});}else logging(_0x342d29(0x18a));}),_0x44d1d8['on'](_0x549a8b(0x155),(_0x3722b7,_0x367ed0)=>{const _0x24e9cd=_0x549a8b;if(validateAccess(_0x367ed0,_0x49e09d)[_0x24e9cd(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95][_0x24e9cd(0x165)]({'function':_0x24e9cd(0x1a0),'args':_0x3722b7});}else logging(_0x24e9cd(0x14f));}),_0x44d1d8['on'](_0x549a8b(0x1d1),(_0x378960,_0x16e07d)=>{const _0x36815a=_0x549a8b;if(validateAccess(_0x16e07d,_0x49e09d)[_0x36815a(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95][_0x36815a(0x165)]({'function':_0x36815a(0x14d),'args':_0x378960});}else logging(_0x36815a(0x1c4));}),_0x44d1d8['on'](_0x549a8b(0x150),_0x176820=>{const _0x43f7e9=_0x549a8b;if(validateAccess(_0x176820,_0x49e09d)[_0x43f7e9(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95]['send']({'function':_0x43f7e9(0x166),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x44d1d8['on'](_0x549a8b(0x153),(_0xfa7c5a,_0x1a25f8)=>{const _0x5a51d0=_0x549a8b;if(validateAccess(_0x1a25f8,_0x49e09d)[_0x5a51d0(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95]['send']({'function':_0x5a51d0(0x176),'args':_0xfa7c5a});}else logging(_0x5a51d0(0x132));}),_0x44d1d8['on'](_0x549a8b(0x21f),_0x10a5ab=>{const _0x11c490=_0x549a8b;if(validateAccess(_0x10a5ab,_0x49e09d)[_0x11c490(0x1ae)]){if(pid[_0x57af95])pid[_0x57af95][_0x11c490(0x165)]({'function':_0x11c490(0x11b),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x44d1d8['on'](_0x549a8b(0x1ac),_0x5ede95=>{const _0x2e96c0=_0x549a8b;if(validateAccess(_0x5ede95,_0x49e09d)['allow']){if(devices[_0x49e09d]['pidRefreshToken'])clearTimeout(devices[_0x49e09d][_0x2e96c0(0x12a)]);if(devices[_0x49e09d][_0x2e96c0(0x1eb)])clearTimeout(devices[_0x49e09d][_0x2e96c0(0x1eb)]);removeSocketListeners(getClient(_0x44d1d8['id'])['uuid']),addBlacklist(_0x49e09d),devices[_0x49e09d][_0x2e96c0(0x146)]=null,devices[_0x49e09d][_0x2e96c0(0x1f9)]=null,devices[_0x49e09d][_0x2e96c0(0x232)][_0x2e96c0(0x191)]=null,io['to'](getClient(_0x44d1d8['id'])[_0x2e96c0(0x201)])[_0x2e96c0(0x145)]('status',{'access':{'allow':![],'reason':_0x2e96c0(0x112),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4b011f){const _0x55a3dc=_0x9aac6c;getClientsWithUuid(_0x4b011f)[_0x55a3dc(0x1e4)](_0x1b97ee=>{getSocket(_0x1b97ee['id'])['removeAllListeners']();});}function cleanSettings(){const _0x49b901=_0x9aac6c;let _0x55dad0=settings;return settings[_0x49b901(0x182)]&&settings['telegramToken']!=''&&(_0x55dad0={..._0x55dad0,'telegramToken':_0x49b901(0x162)}),settings[_0x49b901(0x16c)]&&settings[_0x49b901(0x16c)]!=''&&(_0x55dad0={..._0x55dad0,'bbPassword':_0x49b901(0x162)}),_0x55dad0;}function updateBB(){const _0x3db02f=_0x9aac6c;process[_0x3db02f(0x165)]({'update':!![]});}function startBot(_0x55d2d3,_0x5f5241,_0x559f5b){const _0x56a21c=_0x9aac6c;let _0x1cb027=![];const _0x329e0c=_0x55d2d3[0x0];_0x5f5241={..._0x5f5241,'stdio':[_0x56a21c(0x14c),_0x56a21c(0x14c),_0x56a21c(0x14c),'ipc']},pid[_0x329e0c]=childProcess['fork'](botfile,_0x55d2d3,_0x5f5241),pid[_0x329e0c]['on']('message',_0x163ae1=>{const _0xe1c490=_0x56a21c;switch(Object[_0xe1c490(0x184)](_0x163ae1)[0x0]){case _0xe1c490(0x242):updateBotName(_0x329e0c,_0x163ae1[_0xe1c490(0x242)]);break;case _0xe1c490(0x1d7):updateStatus(_0x329e0c,_0x163ae1[_0xe1c490(0x1d7)]);break;case _0xe1c490(0x17b):updateLive(_0x329e0c,_0x163ae1[_0xe1c490(0x17b)]);break;case'started':updateLive(_0x329e0c,_0x163ae1['started']),io['to'](_0x329e0c)[_0xe1c490(0x145)](_0xe1c490(0x1d7),{'access':{'allow':![],'reason':_0xe1c490(0x1e7),'token':null}});break;case'stop':_0x163ae1[_0xe1c490(0x17f)]=='restart'&&stopBot(_0x329e0c);_0x163ae1['stop']==_0xe1c490(0x1fc)&&toggleBot(_0x329e0c,_0xe1c490(0x15f),_0xe1c490(0x20a));break;case _0xe1c490(0x1cb):sendTelegram(_0x329e0c,_0x163ae1[_0xe1c490(0x1cb)]);break;case _0xe1c490(0x157):io['to'](_0x329e0c)[_0xe1c490(0x145)](_0x163ae1[_0xe1c490(0x157)],_0x163ae1[_0xe1c490(0x248)]);break;}}),pid[_0x329e0c]['on']('error',function(_0xa02e0b){if(_0x1cb027)return;_0x1cb027=!![],_0x559f5b(_0xa02e0b);}),pid[_0x329e0c]['on'](_0x56a21c(0x19e),function(_0x3fdce7){const _0x5458bd=_0x56a21c;if(_0x1cb027)return;_0x1cb027=!![],_0x559f5b(null);const _0x125fa9=dbConfig[_0x5458bd(0x142)]('bots')[_0x5458bd(0x13b)]({'botID':_0x329e0c})['value']();_0x125fa9&&(_0x125fa9['status']==_0x5458bd(0x225)||_0x125fa9[_0x5458bd(0x1d7)]=='new')&&(updateLive(_0x329e0c,'stopped'),logging('restarting\x20Bot\x20'+_0x329e0c),startBot([_0x329e0c,userID],{'cwd':bbpath},function(_0x572dcb){if(_0x572dcb)logging(_0x572dcb);}));});}function stopBot(_0x1ab272){const _0x3ec354=_0x9aac6c;getClientsWithBotID(_0x1ab272)['forEach'](_0x3e91ed=>{const _0x5c5dde=_0x2259;getSocket(_0x3e91ed['id'])[_0x5c5dde(0x169)](!![]),removeClient(_0x3e91ed['id']);});if(pid[_0x1ab272])pid[_0x1ab272][_0x3ec354(0x1fc)]();}function addBot(){const _0xde71f5=_0x9aac6c;let _0x4b096c;for(let _0x27911e=0x1;_0x27911e<0x3e9;_0x27911e++){_0x4b096c=_0x27911e[_0xde71f5(0x1d5)]()[_0xde71f5(0x181)](0x3,'0');let _0x31c7bb=config[_0xde71f5(0x13b)](_0x5234c1=>_0x5234c1[_0xde71f5(0x1f5)]==_0x4b096c);if(!_0x31c7bb)break;}if(_0x4b096c===_0xde71f5(0x1c6)){logging(_0xde71f5(0x1b0));return;}logging(_0xde71f5(0x149)+_0x4b096c),dbConfig['get'](_0xde71f5(0x17a))[_0xde71f5(0x108)]({'botID':_0x4b096c,'botname':'Bot\x20'+_0x4b096c,'status':_0xde71f5(0x1d0),'live':''})[_0xde71f5(0x1bf)](),startBot([_0x4b096c,userID],{'cwd':bbpath},function(_0xbbf6fa){if(_0xbbf6fa)logging(_0xbbf6fa);}),config=getConfiguration(),io['to'](_0xde71f5(0x213))[_0xde71f5(0x145)]('bots',config);}function deleteBot(_0x56cd22){const _0x1ff899=_0x9aac6c;getClientsWithBotID(_0x56cd22)[_0x1ff899(0x1e4)](_0x556f2e=>{const _0x5147e9=_0x1ff899;getSocket(_0x556f2e['id'])[_0x5147e9(0x169)](!![]),removeClient(_0x556f2e['id']);}),dbConfig['get']('bots')[_0x1ff899(0x249)]({'botID':_0x56cd22})[_0x1ff899(0x1bf)](),logging(_0x1ff899(0x1e1)+_0x56cd22),stopBot(_0x56cd22);try{fs[_0x1ff899(0x1a7)](path[_0x1ff899(0x135)](configpath,_0x1ff899(0x160)+_0x56cd22+_0x1ff899(0x1dd))),fs[_0x1ff899(0x1a7)](path[_0x1ff899(0x135)](configpath,_0x1ff899(0x160)+_0x56cd22+_0x1ff899(0x243))),fs[_0x1ff899(0x1a7)](path[_0x1ff899(0x135)](configpath,_0x1ff899(0x160)+_0x56cd22+_0x1ff899(0x1d6))),fs[_0x1ff899(0x1a7)](path['join'](configpath,_0x1ff899(0x160)+_0x56cd22+_0x1ff899(0x1f6)));}catch(_0x25c226){if(_0x25c226)logging(_0x1ff899(0x178),_0x25c226);}config=getConfiguration(),io['to'](_0x1ff899(0x213))[_0x1ff899(0x145)](_0x1ff899(0x17a),config);}function toggleBot(_0x3d32ab,_0x881fc,_0x51606d){const _0x437133=_0x9aac6c;dbConfig[_0x437133(0x142)](_0x437133(0x17a))[_0x437133(0x13b)]({'botID':_0x3d32ab})[_0x437133(0x1e0)]({'status':_0x881fc})[_0x437133(0x1e0)]({'live':_0x51606d})[_0x437133(0x1bf)]();if(_0x881fc=='enabled'||_0x881fc==_0x437133(0x1d0))logging(_0x437133(0x170)+_0x3d32ab),startBot([_0x3d32ab,userID],{'cwd':bbpath},function(_0x508160){if(_0x508160)logging(_0x508160);});else(_0x881fc==_0x437133(0x15f)||_0x881fc==_0x437133(0x222))&&(logging('disabled\x20Bot\x20'+_0x3d32ab),stopBot(_0x3d32ab));config=getConfiguration(),io['to'](_0x437133(0x213))[_0x437133(0x145)](_0x437133(0x17a),config);}function toggleStatus(_0x498154){const _0x3e6561=_0x9aac6c;let _0x4bd116=dbConfig[_0x3e6561(0x142)](_0x3e6561(0x17a))[_0x3e6561(0x13b)]({'botID':_0x498154})[_0x3e6561(0x18b)](),_0x23d068;if(_0x4bd116['status']===_0x3e6561(0x225))_0x23d068=_0x3e6561(0x15f);else{if(_0x4bd116[_0x3e6561(0x1d7)]===_0x3e6561(0x1d0))_0x23d068='new-disabled';else{if(_0x4bd116[_0x3e6561(0x1d7)]==='new-disabled')_0x23d068=_0x3e6561(0x1d0);else{if(_0x4bd116[_0x3e6561(0x1d7)]===_0x3e6561(0x15f))_0x23d068='enabled';}}}return _0x23d068;}function updateStatus(_0x3104fa,_0x148bb4){const _0x4e8bb6=_0x9aac6c;dbConfig[_0x4e8bb6(0x142)]('bots')['find']({'botID':_0x3104fa})[_0x4e8bb6(0x1e0)]({'status':_0x148bb4})[_0x4e8bb6(0x1bf)](),config=getConfiguration(),io['to'](_0x4e8bb6(0x213))[_0x4e8bb6(0x145)](_0x4e8bb6(0x17a),config);}function updateLive(_0x2f4555,_0x3ab11f){const _0x413f07=_0x9aac6c;dbConfig[_0x413f07(0x142)](_0x413f07(0x17a))[_0x413f07(0x13b)]({'botID':_0x2f4555})[_0x413f07(0x1e0)]({'live':_0x3ab11f})[_0x413f07(0x1bf)](),config=getConfiguration(),io['to']('botmanager')[_0x413f07(0x145)]('bots',config);}function updateBotName(_0x4ed997,_0x2d6eba){const _0x3eefed=_0x9aac6c;dbConfig['get']('bots')[_0x3eefed(0x13b)]({'botID':_0x4ed997})[_0x3eefed(0x1e0)]({'botname':_0x2d6eba})[_0x3eefed(0x1bf)](),config=getConfiguration(),io['to'](_0x3eefed(0x213))[_0x3eefed(0x145)]('bots',config);}function telegramError(_0x415568){console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x35cda2){const _0x9d9032=_0x9aac6c;if(_0x35cda2[_0x9d9032(0x12b)][_0x9d9032(0x116)]!=settings[_0x9d9032(0x16b)]&&'@'+_0x35cda2[_0x9d9032(0x12b)][_0x9d9032(0x116)]!=settings[_0x9d9032(0x16b)])return tgBot[_0x9d9032(0x168)](_0x35cda2['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x9d9032(0x227)})['catch'](_0x440906=>{telegramError(_0x440906);}),![];return!![];}async function initTelegram(){const _0x46a65c=_0x9aac6c;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x46a65c(0x182)],{'polling':!![]});let _0x1ff6a8='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x1ff6a8+='\x0a',_0x1ff6a8+='/enable\x20-\x20enable\x20notifications\x0a',_0x1ff6a8+=_0x46a65c(0x22b),_0x1ff6a8+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x1ff6a8+=_0x46a65c(0x210),_0x1ff6a8+='/on\x20-\x20start\x20bot(s)\x0a',_0x1ff6a8+=_0x46a65c(0x16f),_0x1ff6a8+=_0x46a65c(0x15c),_0x1ff6a8+=_0x46a65c(0x1d9);let _0x3cf36b=_0x46a65c(0x240);_0x3cf36b+='\x0a',_0x3cf36b+=_0x1ff6a8,tgBot[_0x46a65c(0x15a)](/\/start/,_0x1c3713=>{const _0x1d06a7=_0x46a65c;if(!validateTelegram(_0x1c3713))return;if(settings['telegramChatId']!=_0x1c3713['chat']['id'])updateSetting('telegramChatId',_0x1c3713[_0x1d06a7(0x1f0)]['id']);updateSetting(_0x1d06a7(0x18c),!![]),tgBot['sendMessage'](_0x1c3713[_0x1d06a7(0x1f0)]['id'],_0x3cf36b)['catch'](_0x3fec9a=>{telegramError(_0x3fec9a);});}),tgBot[_0x46a65c(0x15a)](/\/enable/,_0x7d497a=>{const _0x44c33c=_0x46a65c;if(!validateTelegram(_0x7d497a))return;if(settings[_0x44c33c(0x195)]!=_0x7d497a[_0x44c33c(0x1f0)]['id'])updateSetting(_0x44c33c(0x195),_0x7d497a['chat']['id']);updateSetting(_0x44c33c(0x18c),!![]),tgBot[_0x44c33c(0x168)](_0x7d497a[_0x44c33c(0x1f0)]['id'],_0x44c33c(0x13d))['catch'](_0x480cb2=>{telegramError(_0x480cb2);});}),tgBot[_0x46a65c(0x15a)](/\/config/,async _0x5b806e=>{const _0x3622ca=_0x46a65c;if(!validateTelegram(_0x5b806e))return;tgBot[_0x3622ca(0x10b)](_0x3622ca(0x12f)),tgBot[_0x3622ca(0x168)](_0x5b806e[_0x3622ca(0x1f0)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x3622ca(0x1ec),'callback_data':_0x3622ca(0x126)},{'text':'Alerts','callback_data':_0x3622ca(0x137)},{'text':_0x3622ca(0x1a9),'callback_data':_0x3622ca(0x21e)}]]}})[_0x3622ca(0x15d)](_0x57fd7a=>{telegramError(_0x57fd7a);}),tgBot['on']('callback_query',async _0x244b58=>{const _0x26c04a=_0x3622ca,_0x5dac8e=_0x244b58[_0x26c04a(0x190)],_0x558238=_0x244b58['message'];tgBot[_0x26c04a(0x244)](_0x244b58['id'])[_0x26c04a(0x24b)](async()=>{const _0x4292e1=_0x26c04a;_0x5dac8e==_0x4292e1(0x126)&&(updateSetting('telegramEvents',_0x4292e1(0x126)),updateSetting(_0x4292e1(0x18c),!![]),await tgBot[_0x4292e1(0x168)](_0x558238[_0x4292e1(0x1f0)]['id'],_0x4292e1(0x209))[_0x4292e1(0x15d)](_0x388ec4=>{telegramError(_0x388ec4);}));_0x5dac8e=='alerts'&&(updateSetting(_0x4292e1(0x163),_0x4292e1(0x137)),updateSetting(_0x4292e1(0x18c),!![]),await tgBot[_0x4292e1(0x168)](_0x558238[_0x4292e1(0x1f0)]['id'],_0x4292e1(0x19b))['catch'](_0x134ce9=>{telegramError(_0x134ce9);}));_0x5dac8e==_0x4292e1(0x21e)&&(updateSetting(_0x4292e1(0x163),_0x4292e1(0x21e)),updateSetting(_0x4292e1(0x18c),!![]),await tgBot[_0x4292e1(0x168)](_0x558238['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x4292e1(0x15d)](_0x2a1a69=>{telegramError(_0x2a1a69);}));if(!settings[_0x4292e1(0x195)])tgBot['sendMessage'](_0x558238[_0x4292e1(0x1f0)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x4292e1(0x15d)](_0x564ab7=>{telegramError(_0x564ab7);});}),tgBot['removeListener'](_0x26c04a(0x12f));});}),tgBot[_0x46a65c(0x15a)](/\/status/,_0x10c1f1=>{const _0x3fdf96=_0x46a65c;if(!validateTelegram(_0x10c1f1))return;let _0x9c7dd6=_0x3fdf96(0x189);config['forEach'](_0x1fa0d2=>{const _0x56800b=_0x3fdf96;_0x9c7dd6+=_0x56800b(0x1a5)+_0x1fa0d2[_0x56800b(0x1f5)]+_0x56800b(0x197)+_0x1fa0d2[_0x56800b(0x242)]+':\x20'+_0x1fa0d2[_0x56800b(0x1d7)]+'\x20/\x20'+_0x1fa0d2[_0x56800b(0x17b)]+'\x0a';}),_0x9c7dd6+='\x0a',_0x9c7dd6+=_0x3fdf96(0x1cd),_0x9c7dd6+=!settings[_0x3fdf96(0x18c)]?_0x3fdf96(0x130):'Notifications\x20enabled\x0a',_0x9c7dd6+=settings['telegramEnabled']?settings[_0x3fdf96(0x163)]==_0x3fdf96(0x21e)?_0x3fdf96(0x223):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x3fdf96(0x121):'',tgBot[_0x3fdf96(0x168)](_0x10c1f1[_0x3fdf96(0x1f0)]['id'],_0x9c7dd6,{'parse_mode':_0x3fdf96(0x227)})[_0x3fdf96(0x15d)](_0x4b943f=>{telegramError(_0x4b943f);});}),tgBot[_0x46a65c(0x15a)](/\/restart/,_0x20b281=>{const _0xd955e3=_0x46a65c;if(!validateTelegram(_0x20b281))return;tgBot[_0xd955e3(0x10b)](_0xd955e3(0x12f));const _0x179a82=getEnabledBots();if(_0x179a82[_0xd955e3(0x129)]==0x0)tgBot[_0xd955e3(0x168)](_0x20b281[_0xd955e3(0x1f0)]['id'],_0xd955e3(0x1b4))[_0xd955e3(0x15d)](_0x3eee0b=>{telegramError(_0x3eee0b);});else{if(_0x179a82[_0xd955e3(0x129)]>0x1)_0x179a82[_0xd955e3(0x108)]({'botID':_0xd955e3(0x21e)});let _0x49f348=[],_0x286ffe=[];const _0x5af09c=_0x179a82['length']%0x4==0x0||_0x179a82[_0xd955e3(0x129)]%0x4==0x3||_0x179a82[_0xd955e3(0x129)]%0x3==0x1?0x4:0x3;let _0x4e1e4b=0x0;_0x179a82[_0xd955e3(0x1e4)]((_0x214f53,_0x3a4e2d)=>{const _0x39263b=_0xd955e3;if(_0x3a4e2d%_0x5af09c==0x0)_0x286ffe=[];_0x286ffe['push']({'text':_0x214f53[_0x39263b(0x1f5)]==_0x39263b(0x21e)?_0x39263b(0x226):_0x39263b(0x1a5)+_0x214f53[_0x39263b(0x1f5)],'callback_data':_0x214f53[_0x39263b(0x1f5)]}),_0x3a4e2d%_0x5af09c==0x0&&(_0x49f348[_0x4e1e4b]=_0x286ffe,_0x4e1e4b++);}),tgBot['sendMessage'](_0x20b281[_0xd955e3(0x1f0)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x49f348}})['catch'](_0x57e9e1=>{telegramError(_0x57e9e1);}),tgBot['on'](_0xd955e3(0x12f),async _0x3a9173=>{const _0x58a328=_0xd955e3,_0x5570c1=_0x3a9173[_0x58a328(0x190)],_0x1fbe56=_0x3a9173[_0x58a328(0x193)];tgBot[_0x58a328(0x244)](_0x3a9173['id'])[_0x58a328(0x24b)](async()=>{const _0x4b3e1a=_0x58a328;if(_0x5570c1==_0x4b3e1a(0x21e)){if(settings['telegramEvents']==_0x4b3e1a(0x126))tgBot[_0x4b3e1a(0x168)](_0x1fbe56[_0x4b3e1a(0x1f0)]['id'],_0x4b3e1a(0x17d))[_0x4b3e1a(0x15d)](_0x38ca91=>{telegramError(_0x38ca91);});config[_0x4b3e1a(0x1e4)](_0x1c1404=>{const _0x214906=_0x4b3e1a;stopBot(_0x1c1404[_0x214906(0x1f5)]);});}else{if(settings[_0x4b3e1a(0x163)]=='orders')tgBot[_0x4b3e1a(0x168)](_0x1fbe56[_0x4b3e1a(0x1f0)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x5570c1)[_0x4b3e1a(0x15d)](_0x1e9770=>{telegramError(_0x1e9770);});stopBot(_0x5570c1);}}),tgBot['removeListener'](_0x58a328(0x12f));});}}),tgBot[_0x46a65c(0x15a)](/\/on/,_0xe6852=>{const _0x24cc78=_0x46a65c;if(!validateTelegram(_0xe6852))return;tgBot['removeListener'](_0x24cc78(0x12f));const _0x3c6bed=getDisabledBots();if(_0x3c6bed['length']==0x0)tgBot[_0x24cc78(0x168)](_0xe6852[_0x24cc78(0x1f0)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x24cc78(0x15d)](_0x424304=>{telegramError(_0x424304);});else{if(_0x3c6bed[_0x24cc78(0x129)]>0x1)_0x3c6bed[_0x24cc78(0x108)]({'botID':_0x24cc78(0x21e)});let _0x349015=[],_0x6ccced=[];const _0x3b6aac=_0x3c6bed['length']%0x4==0x0||_0x3c6bed[_0x24cc78(0x129)]%0x4==0x3||_0x3c6bed[_0x24cc78(0x129)]%0x3==0x1?0x4:0x3;let _0x3f5213=0x0;_0x3c6bed[_0x24cc78(0x1e4)]((_0x2f7acd,_0x3712fc)=>{const _0x4a5239=_0x24cc78;if(_0x3712fc%_0x3b6aac==0x0)_0x6ccced=[];_0x6ccced[_0x4a5239(0x108)]({'text':_0x2f7acd['botID']=='all'?_0x4a5239(0x226):_0x4a5239(0x1a5)+_0x2f7acd[_0x4a5239(0x1f5)],'callback_data':_0x2f7acd['botID']}),_0x3712fc%_0x3b6aac==0x0&&(_0x349015[_0x3f5213]=_0x6ccced,_0x3f5213++);}),tgBot['sendMessage'](_0xe6852[_0x24cc78(0x1f0)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x349015}})[_0x24cc78(0x15d)](_0x2e1e90=>{telegramError(_0x2e1e90);}),tgBot['on'](_0x24cc78(0x12f),async _0x42ee5d=>{const _0x2d607a=_0x24cc78,_0x42b3af=_0x42ee5d[_0x2d607a(0x190)],_0x535dbb=_0x42ee5d['message'];tgBot['answerCallbackQuery'](_0x42ee5d['id'])[_0x2d607a(0x24b)](async()=>{const _0x36af54=_0x2d607a;if(_0x42b3af==_0x36af54(0x21e)){if(settings['telegramEvents']==_0x36af54(0x126))tgBot[_0x36af54(0x168)](_0x535dbb['chat']['id'],_0x36af54(0x15e))[_0x36af54(0x15d)](_0x516a97=>{telegramError(_0x516a97);});_0x3c6bed[_0x36af54(0x1e4)](_0x172b36=>{const _0x141dc7=_0x36af54;if(_0x172b36['botID']!=_0x141dc7(0x21e))toggleBot(_0x172b36['botID'],toggleStatus(_0x172b36['botID']),_0x141dc7(0x20a));});}else{if(settings['telegramEvents']==_0x36af54(0x126))tgBot[_0x36af54(0x168)](_0x535dbb['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x42b3af)[_0x36af54(0x15d)](_0xa9d957=>{telegramError(_0xa9d957);});toggleBot(_0x42b3af,toggleStatus(_0x42b3af),_0x36af54(0x20a));}}),tgBot['removeListener'](_0x2d607a(0x12f));});}}),tgBot['onText'](/\/off/,_0x2e766b=>{const _0x2bcdcc=_0x46a65c;if(!validateTelegram(_0x2e766b))return;tgBot[_0x2bcdcc(0x10b)]('callback_query');const _0x133b29=getEnabledBots();if(_0x133b29[_0x2bcdcc(0x129)]==0x0)tgBot[_0x2bcdcc(0x168)](_0x2e766b[_0x2bcdcc(0x1f0)]['id'],_0x2bcdcc(0x1b4))[_0x2bcdcc(0x15d)](_0x538fa4=>{telegramError(_0x538fa4);});else{if(_0x133b29['length']>0x1)_0x133b29[_0x2bcdcc(0x108)]({'botID':_0x2bcdcc(0x21e)});let _0x1629c7=[],_0x4baf9b=[];const _0x4687c8=_0x133b29['length']%0x4==0x0||_0x133b29[_0x2bcdcc(0x129)]%0x4==0x3||_0x133b29[_0x2bcdcc(0x129)]%0x3==0x1?0x4:0x3;let _0x2048fe=0x0;_0x133b29[_0x2bcdcc(0x1e4)]((_0x15cde5,_0x46c87f)=>{const _0x439678=_0x2bcdcc;if(_0x46c87f%_0x4687c8==0x0)_0x4baf9b=[];_0x4baf9b[_0x439678(0x108)]({'text':_0x15cde5[_0x439678(0x1f5)]==_0x439678(0x21e)?'All\x20bots':_0x439678(0x1a5)+_0x15cde5['botID'],'callback_data':_0x15cde5[_0x439678(0x1f5)]}),_0x46c87f%_0x4687c8==0x0&&(_0x1629c7[_0x2048fe]=_0x4baf9b,_0x2048fe++);}),tgBot[_0x2bcdcc(0x168)](_0x2e766b['chat']['id'],_0x2bcdcc(0x17e),{'reply_markup':{'inline_keyboard':_0x1629c7}})[_0x2bcdcc(0x15d)](_0x509ab4=>{telegramError(_0x509ab4);}),tgBot['on'](_0x2bcdcc(0x12f),async _0x448565=>{const _0x555250=_0x2bcdcc,_0x126039=_0x448565[_0x555250(0x190)],_0x6f1862=_0x448565[_0x555250(0x193)];tgBot[_0x555250(0x244)](_0x448565['id'])[_0x555250(0x24b)](async()=>{const _0x4fab03=_0x555250;if(_0x126039==_0x4fab03(0x21e)){if(settings[_0x4fab03(0x163)]=='orders')tgBot[_0x4fab03(0x168)](_0x6f1862[_0x4fab03(0x1f0)]['id'],_0x4fab03(0x194))['catch'](_0x35ff7f=>{telegramError(_0x35ff7f);});_0x133b29[_0x4fab03(0x1e4)](_0x4314cd=>{const _0x586f42=_0x4fab03;if(_0x4314cd[_0x586f42(0x1f5)]!=_0x586f42(0x21e))toggleBot(_0x4314cd['botID'],toggleStatus(_0x4314cd[_0x586f42(0x1f5)]),'stopped');});}else{if(settings[_0x4fab03(0x163)]==_0x4fab03(0x126))tgBot[_0x4fab03(0x168)](_0x6f1862[_0x4fab03(0x1f0)]['id'],_0x4fab03(0x127)+_0x126039)[_0x4fab03(0x15d)](_0x1a78e9=>{telegramError(_0x1a78e9);});toggleBot(_0x126039,toggleStatus(_0x126039),'stopped');}}),tgBot[_0x555250(0x10b)](_0x555250(0x12f));});}}),tgBot[_0x46a65c(0x15a)](/\/disable/,_0x114c29=>{const _0x29fa6d=_0x46a65c;if(!validateTelegram(_0x114c29))return;tgBot['sendMessage'](_0x114c29['chat']['id'],'Notifications\x20disabled')[_0x29fa6d(0x15d)](_0x3d84f6=>{telegramError(_0x3d84f6);}),updateSetting(_0x29fa6d(0x18c),![]);}),tgBot[_0x46a65c(0x15a)](/\/help/,_0x125d19=>{const _0xbb313f=_0x46a65c;if(!validateTelegram(_0x125d19))return;tgBot['sendMessage'](_0x125d19[_0xbb313f(0x1f0)]['id'],_0x1ff6a8)[_0xbb313f(0x15d)](_0xa6195d=>{telegramError(_0xa6195d);});}),tgBot['on'](_0x46a65c(0x114),_0x14023f=>{const _0x57d6a1=_0x46a65c;_0x14023f[_0x57d6a1(0x1d5)]()[_0x57d6a1(0x119)](_0x57d6a1(0x15b))&&(logging(_0x57d6a1(0x164)),tgBot[_0x57d6a1(0x23d)](),tgBot=null,io['to'](_0x57d6a1(0x213))[_0x57d6a1(0x145)](_0x57d6a1(0x1be),'Invalid\x20Telegram\x20token'));}),process['once']('SIGINT',()=>{const _0x2b9ef2=_0x46a65c;if(tgBot)tgBot[_0x2b9ef2(0x23d)]();process[_0x2b9ef2(0x19e)](0x1);}),process[_0x46a65c(0x204)](_0x46a65c(0x19c),()=>{const _0x1d66dc=_0x46a65c;if(tgBot)tgBot[_0x1d66dc(0x23d)]();process[_0x1d66dc(0x19e)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x2faa97,_0x4d6435){const _0x5dc3f7=_0x9aac6c;if(settings[_0x5dc3f7(0x18c)]){if(settings[_0x5dc3f7(0x163)]==_0x5dc3f7(0x21e)||(_0x4d6435[_0x5dc3f7(0x158)]==_0x5dc3f7(0x143)||_0x4d6435['type']==_0x5dc3f7(0x1a1))&&settings[_0x5dc3f7(0x163)]==_0x5dc3f7(0x137)||_0x4d6435[_0x5dc3f7(0x158)]==_0x5dc3f7(0x1c2)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x5dc3f7(0x195)]){if(_0x4d6435[_0x5dc3f7(0x247)])tgBot[_0x5dc3f7(0x168)](settings[_0x5dc3f7(0x195)],_0x4d6435[_0x5dc3f7(0x242)]+_0x5dc3f7(0x1c8)+_0x4d6435[_0x5dc3f7(0x220)])['catch'](_0x146f5e=>{telegramError(_0x146f5e);});else tgBot[_0x5dc3f7(0x168)](settings[_0x5dc3f7(0x195)],_0x5dc3f7(0x1a5)+_0x2faa97+_0x5dc3f7(0x1c8)+_0x4d6435[_0x5dc3f7(0x220)])['catch'](_0x4022f8=>{telegramError(_0x4022f8);});}}}}function getDeviceWithIp(_0x114fca){const _0xa2e4ac=_0x9aac6c;return devices[_0xa2e4ac(0x13b)](_0x5d7aef=>_0x5d7aef['ip']===_0x114fca);}function temporaryAccess2FA(_0x564b9a,_0x34a649){const _0x3ffae4=_0x9aac6c;let _0x10373e=new Date(),_0xb8995d=![];if(lastIpApproval){if(_0x10373e-lastIpApproval<0x1388)_0xb8995d=!![];}lastIpApproval=new Date();if(_0xb8995d)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x3ffae4(0x10b)](_0x3ffae4(0x12f)),tgBot[_0x3ffae4(0x168)](settings[_0x3ffae4(0x195)],_0x3ffae4(0x13a)+normalizeIP(_0x34a649)[_0x3ffae4(0x109)]+_0x3ffae4(0x188),{'parse_mode':_0x3ffae4(0x227),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x3ffae4(0x118),'callback_data':'15'},{'text':_0x3ffae4(0x180),'callback_data':'30'},{'text':'reject','callback_data':_0x3ffae4(0x23b)}]]}})['catch'](_0x465464=>{telegramError(_0x465464);}),tgBot['on'](_0x3ffae4(0x12f),async _0x4270f4=>{const _0x2e76b6=_0x3ffae4,_0x3f1fc9=_0x4270f4[_0x2e76b6(0x190)],_0x5a3c51=_0x4270f4[_0x2e76b6(0x193)];tgBot[_0x2e76b6(0x244)](_0x4270f4['id'])[_0x2e76b6(0x24b)](async()=>{const _0x3a61e0=_0x2e76b6;devices[_0x564b9a]['telegramIpApproval']={'clientip':_0x34a649,'timestamp':new Date()[_0x3a61e0(0x245)](),'expiry':_0x3f1fc9},_0x3f1fc9!='reject'?(await tgBot['sendMessage'](_0x5a3c51[_0x3a61e0(0x1f0)]['id'],_0x3a61e0(0x1b1)+_0x3f1fc9+_0x3a61e0(0x215),{'parse_mode':_0x3a61e0(0x227)})[_0x3a61e0(0x15d)](_0xe32f89=>{telegramError(_0xe32f89);}),io['to'](_0x564b9a)['emit'](_0x3a61e0(0x1d7),{'access':{'allow':![],'reason':_0x3a61e0(0x1e7),'token':null}})):(await tgBot[_0x3a61e0(0x168)](_0x5a3c51[_0x3a61e0(0x1f0)]['id'],_0x3a61e0(0x1b2))[_0x3a61e0(0x15d)](_0x299580=>{telegramError(_0x299580);}),io['to'](_0x564b9a)[_0x3a61e0(0x145)](_0x3a61e0(0x1d7),{'access':{'allow':![],'reason':_0x3a61e0(0x235),'token':null}}));}),tgBot[_0x2e76b6(0x10b)](_0x2e76b6(0x12f));}));}function loginAccess2FA(_0xb0bfa2,_0x1c9d5d){const _0x1da631=_0x9aac6c;tgBot&&settings[_0x1da631(0x195)]&&(tgBot[_0x1da631(0x10b)](_0x1da631(0x12f)),tgBot[_0x1da631(0x168)](settings['telegramChatId'],_0x1da631(0x1c1)+normalizeIP(_0x1c9d5d)['show']+_0x1da631(0x188),{'parse_mode':_0x1da631(0x227),'reply_markup':{'inline_keyboard':[[{'text':_0x1da631(0x110),'callback_data':loginExpiry},{'text':_0x1da631(0x23b),'callback_data':_0x1da631(0x23b)}]]}})[_0x1da631(0x15d)](_0x4c62e6=>{telegramError(_0x4c62e6);}),tgBot['on'](_0x1da631(0x12f),async _0x1fa042=>{const _0x479731=_0x1da631,_0x3a7d94=_0x1fa042[_0x479731(0x190)],_0x4f216a=_0x1fa042['message'];tgBot[_0x479731(0x244)](_0x1fa042['id'])[_0x479731(0x24b)](async()=>{const _0x18f2a3=_0x479731;devices[_0xb0bfa2]['telegram2FaApproval']={'clientip':_0x1c9d5d,'timestamp':new Date()[_0x18f2a3(0x245)](),'expiry':_0x3a7d94},_0x3a7d94!=_0x18f2a3(0x23b)?(await tgBot[_0x18f2a3(0x168)](_0x4f216a[_0x18f2a3(0x1f0)]['id'],_0x18f2a3(0x200),{'parse_mode':'HTML'})[_0x18f2a3(0x15d)](_0x10bb2f=>{telegramError(_0x10bb2f);}),io['to'](_0xb0bfa2)[_0x18f2a3(0x145)](_0x18f2a3(0x1d7),{'access':{'allow':![],'reason':_0x18f2a3(0x1e7),'token':null}})):(await tgBot[_0x18f2a3(0x168)](_0x4f216a['chat']['id'],_0x18f2a3(0x117))['catch'](_0x5b5433=>{telegramError(_0x5b5433);}),io['to'](_0xb0bfa2)[_0x18f2a3(0x145)](_0x18f2a3(0x1d7),{'access':{'allow':![],'reason':_0x18f2a3(0x10d),'token':null}}));}),tgBot[_0x479731(0x10b)](_0x479731(0x12f));}));}function getConfiguration(){const _0x1c5e96=_0x9aac6c;return dbConfig[_0x1c5e96(0x142)](_0x1c5e96(0x17a))[_0x1c5e96(0x20f)]('botID')[_0x1c5e96(0x18b)]()||[];}function getEnabledBots(){const _0x8f13dd=_0x9aac6c;return dbConfig[_0x8f13dd(0x142)](_0x8f13dd(0x17a))[_0x8f13dd(0x20f)]('botID')['filter']({'status':_0x8f13dd(0x225)})[_0x8f13dd(0x18b)]()||[];}function getDisabledBots(){const _0xe9bf04=_0x9aac6c;return dbConfig[_0xe9bf04(0x142)](_0xe9bf04(0x17a))[_0xe9bf04(0x20f)](_0xe9bf04(0x1f5))[_0xe9bf04(0x1d3)]({'status':_0xe9bf04(0x15f)})[_0xe9bf04(0x18b)]()||[];}function getSettings(){const _0x2d684e=_0x9aac6c;return dbSettings['get']('settings')[_0x2d684e(0x18b)]()||{'timeshift':0x0};}function getSecure(){const _0x2b30b7=_0x9aac6c;return dbSecure[_0x2b30b7(0x142)]('secure')[_0x2b30b7(0x18b)]()||{};}function getBlacklist(){const _0x1ec9e0=_0x9aac6c;return dbSecure[_0x1ec9e0(0x142)](_0x1ec9e0(0x1f4))['value']()||[];}function broadcastToBots(_0x4ac1f1,_0x45d613){const _0x3745=_0x9aac6c;config[_0x3745(0x1e4)](_0x579e6f=>{const _0x17492c=_0x3745;if(_0x579e6f[_0x17492c(0x1d7)]=='enabled'&&_0x579e6f[_0x17492c(0x17b)]==_0x17492c(0x1af)){if(pid[_0x579e6f[_0x17492c(0x1f5)]])pid[_0x579e6f[_0x17492c(0x1f5)]][_0x17492c(0x165)]({[_0x4ac1f1]:_0x45d613});}});}function storeSettings(_0x213a4e,_0x5f09cf=![]){const _0x4d0738=_0x9aac6c;_0x213a4e={...settings,..._0x213a4e};if(_0x5f09cf&&_0x213a4e['bbPassword']!=_0x4d0738(0x162)&&_0x213a4e['bbPassword']!=''){const _0x337b7a=crypt[_0x4d0738(0x233)](secure[_0x4d0738(0x18f)],_0x213a4e[_0x4d0738(0x16c)])[_0x4d0738(0x193)][_0x4d0738(0x1c3)]('@')[0x0],_0x2bd5fb=bcrypt[_0x4d0738(0x1b5)](_0x337b7a,saltRounds);_0x213a4e={..._0x213a4e,'bbPassword':_0x2bd5fb};}if(_0x5f09cf&&_0x213a4e[_0x4d0738(0x182)]!=_0x4d0738(0x162)&&_0x213a4e['telegramToken']!=''){const _0x1c4eb1=crypt[_0x4d0738(0x233)](secure[_0x4d0738(0x18f)],_0x213a4e['telegramToken'])['message'][_0x4d0738(0x1c3)]('@')[0x0];_0x213a4e={..._0x213a4e,'telegramToken':_0x1c4eb1};}const _0x3091ff=_0x213a4e[_0x4d0738(0x182)]!=_0x4d0738(0x162)&&_0x213a4e[_0x4d0738(0x182)]!=settings[_0x4d0738(0x182)]||_0x213a4e['telegramUsername']!=settings[_0x4d0738(0x16b)],_0x2d073a=_0x213a4e[_0x4d0738(0x182)]==''||_0x213a4e['telegramUsername']=='';if(_0x3091ff)_0x213a4e[_0x4d0738(0x163)]=_0x4d0738(0x21e);for(const [_0x1a08d5,_0x29dbef]of Object[_0x4d0738(0x1f8)](_0x213a4e)){if(_0x1a08d5=='telegramToken'&&_0x29dbef=='************'){_0x213a4e[_0x4d0738(0x182)]=settings[_0x4d0738(0x182)];continue;};if(_0x1a08d5=='bbPassword'&&_0x29dbef==_0x4d0738(0x162)){_0x213a4e[_0x4d0738(0x16c)]=settings[_0x4d0738(0x16c)];continue;};dbSettings[_0x4d0738(0x1e6)](_0x4d0738(0x1b7)+_0x1a08d5,_0x29dbef)['write']();}settings=_0x213a4e,io['to'](_0x4d0738(0x213))['emit']('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x4d0738(0x175)]);if(_0x3091ff&&!_0x2d073a)initTelegram();if(_0x3091ff&&_0x2d073a)disableTelegram();getAllClients()[_0x4d0738(0x1e4)](_0x5d3a47=>{const _0x1eae6b=_0x4d0738;getSocket(_0x5d3a47['id'])[_0x1eae6b(0x145)](_0x1eae6b(0x1d7),{'access':{'allow':![],'reason':_0x1eae6b(0x1e7),'token':null}});});}function updateSetting(_0x117d12,_0x3ea1fd){const _0x27d2ea=_0x9aac6c;dbSettings['set'](_0x27d2ea(0x1b7)+_0x117d12,_0x3ea1fd)['write'](),settings=getSettings(),io['to'](_0x27d2ea(0x213))[_0x27d2ea(0x145)](_0x27d2ea(0x1ea),cleanSettings());}function storeSecure(_0x53de15){const _0x39fd27=_0x9aac6c;dbSecure[_0x39fd27(0x142)]('secure')[_0x39fd27(0x108)](_0x53de15)[_0x39fd27(0x1bf)](),secure=_0x53de15;}function addBlacklist(_0xd7a2cc){const _0x494fa5=_0x9aac6c;cleanBlacklist();let _0x3f8e9f;devices[_0xd7a2cc][_0x494fa5(0x146)]?_0x3f8e9f=Math[_0x494fa5(0x123)](devices[_0xd7a2cc][_0x494fa5(0x146)]['expiry'],loginExpiry):_0x3f8e9f=loginExpiry,dbSecure['get']('blacklist')[_0x494fa5(0x108)]({'expiry':new Date()[_0x494fa5(0x245)]()+_0x3f8e9f*0x3c*0x3e8,'token':devices[_0xd7a2cc]['access']['token']})[_0x494fa5(0x1bf)](),blacklist=dbSecure[_0x494fa5(0x142)]('blacklist')[_0x494fa5(0x18b)]();}function cleanBlacklist(){const _0x2229e7=_0x9aac6c;let _0x4b479f=dbSecure[_0x2229e7(0x142)](_0x2229e7(0x1f4))[_0x2229e7(0x1f2)]()[_0x2229e7(0x18b)](),_0x364087=new Date()[_0x2229e7(0x245)]();_0x4b479f[_0x2229e7(0x1e4)](_0x245bd5=>{const _0x49046a=_0x2229e7;_0x245bd5['expiry']<_0x364087&&dbSecure[_0x49046a(0x142)](_0x49046a(0x1f4))[_0x49046a(0x249)]({'expiry':_0x245bd5[_0x49046a(0x221)]})[_0x49046a(0x1bf)]();});}function initStates(){const _0x120148=_0x9aac6c;let _0x101c47=getConfiguration();_0x101c47[_0x120148(0x1e4)](_0x5c0a7d=>{const _0x60cfd=_0x120148;_0x5c0a7d[_0x60cfd(0x17b)]=_0x60cfd(0x20a);}),storeConfiguration(_0x101c47);}function onKeys(){const _0x5a3243=new RSA();return new Promise(_0x4a261a=>{const _0x36da43=_0x2259;_0x5a3243['generateKeyPairAsync']()[_0x36da43(0x24b)](_0x5dc996=>{_0x4a261a(_0x5dc996);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x491bab=_0x9aac6c;let _0x195fab=getConfiguration(),_0x2dd46c=![];_0x195fab['forEach'](_0x559d05=>{const _0x2857ec=_0x2259;if(_0x559d05[_0x2857ec(0x1d7)]==_0x2857ec(0x1af))_0x559d05['status']=_0x2857ec(0x225),_0x2dd46c=!![];else _0x559d05['status']=='stopped'&&(_0x559d05['status']=_0x2857ec(0x15f),_0x2dd46c=!![]);});if(_0x2dd46c)storeConfiguration(_0x195fab);let _0x2d7708=getSecure();if(!_0x2d7708[_0x491bab(0x22e)](_0x491bab(0x207))){let _0x58219b=await generateKeys();_0x2d7708[_0x491bab(0x111)]=_0x58219b['publicKey'],_0x2d7708[_0x491bab(0x18f)]=_0x58219b[_0x491bab(0x18f)],_0x2d7708['secret']=crypto['randomBytes'](0x20)[_0x491bab(0x1d5)](_0x491bab(0x177));;storeSecure(_0x2d7708);}let _0x145a03=getSettings();_0x2dd46c=![];!_0x145a03[_0x491bab(0x22e)]('loginRequired')&&(_0x145a03[_0x491bab(0x20b)]=![],_0x145a03[_0x491bab(0x139)]='',_0x145a03[_0x491bab(0x16c)]='',_0x145a03['f2aRequired']=![],_0x2dd46c=!![]);!_0x145a03[_0x491bab(0x22e)]('whitelistEnabled')&&(_0x145a03[_0x491bab(0x12d)]=![],_0x145a03[_0x491bab(0x1fa)]=[],_0x145a03['temporaryAccessAllowed']=![],_0x2dd46c=!![]);if(!_0x145a03['hasOwnProperty'](_0x491bab(0x18c))){if(_0x145a03[_0x491bab(0x195)])_0x145a03[_0x491bab(0x18c)]=!![];else _0x145a03[_0x491bab(0x18c)]=![];_0x2dd46c=!![];}if(_0x2dd46c)storeSettings(_0x145a03);}function storeConfiguration(_0x378faa){const _0x4f1acc=_0x9aac6c;dbConfig[_0x4f1acc(0x142)](_0x4f1acc(0x17a))[_0x4f1acc(0x249)]()[_0x4f1acc(0x1bf)](),dbConfig[_0x4f1acc(0x142)](_0x4f1acc(0x17a))[_0x4f1acc(0x108)](..._0x378faa)[_0x4f1acc(0x1bf)](),config=_0x378faa;}function resetPassword(){const _0x15fe50=_0x9aac6c;tgBot&&settings[_0x15fe50(0x195)]&&(tgBot[_0x15fe50(0x10b)](_0x15fe50(0x12f)),tgBot[_0x15fe50(0x168)](settings[_0x15fe50(0x195)],_0x15fe50(0x140),{'parse_mode':_0x15fe50(0x227),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x152ff2=>{telegramError(_0x152ff2);}),tgBot['on'](_0x15fe50(0x12f),async _0x424e95=>{const _0xcffcf8=_0x15fe50,_0x19b78b=_0x424e95[_0xcffcf8(0x190)],_0x1323bd=_0x424e95[_0xcffcf8(0x193)];tgBot[_0xcffcf8(0x244)](_0x424e95['id'])[_0xcffcf8(0x24b)](async()=>{const _0x3ec128=_0xcffcf8;if(_0x19b78b!='no'){const _0x48567c=0xf,_0x499679=_0x3ec128(0x236),_0x594787=Array['from'](crypto[_0x3ec128(0x24c)](new Uint32Array(_0x48567c)))[_0x3ec128(0x147)](_0x44b58e=>_0x499679[_0x44b58e%_0x499679[_0x3ec128(0x129)]])['join'](''),_0x3e23e3=bcrypt[_0x3ec128(0x1b5)](_0x594787,saltRounds);storeSettings({'bbPassword':_0x3e23e3}),await tgBot[_0x3ec128(0x168)](_0x1323bd[_0x3ec128(0x1f0)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x594787,{'parse_mode':_0x3ec128(0x227)})[_0x3ec128(0x15d)](_0x36571f=>{telegramError(_0x36571f);});}else await tgBot['sendMessage'](_0x1323bd['chat']['id'],_0x3ec128(0x1a3))['catch'](_0x3262f4=>{telegramError(_0x3262f4);});}),tgBot[_0xcffcf8(0x10b)](_0xcffcf8(0x12f));}));}function logging(_0x312e66){const _0x32aca6=_0x9aac6c;console[_0x32aca6(0x1ad)](getTimeStamp()+_0x32aca6(0x198)+_0x312e66);if(tgBot&&settings['telegramChatId']&&settings[_0x32aca6(0x163)]!='orders')tgBot['sendMessage'](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x312e66)['catch'](_0x22e5c0=>{telegramError(_0x22e5c0);});}function getServerTime(){const _0x11244e=_0x9aac6c,_0x538c5a=new Date();return _0x538c5a[_0x11244e(0x214)]()+'/'+(_0x538c5a[_0x11244e(0x1dc)]()+0x1)[_0x11244e(0x1d5)]()[_0x11244e(0x181)](0x2,'0')+'/'+_0x538c5a[_0x11244e(0x167)]()['toString']()[_0x11244e(0x181)](0x2,'0')+'\x20'+_0x538c5a[_0x11244e(0x1d8)]()[_0x11244e(0x1d5)]()[_0x11244e(0x181)](0x2,'0')+':'+_0x538c5a[_0x11244e(0x21c)]()[_0x11244e(0x1d5)]()['padStart'](0x2,'0')+':'+_0x538c5a[_0x11244e(0x1bd)]()[_0x11244e(0x1d5)]()[_0x11244e(0x181)](0x2,'0');}function getTimeStamp(){const _0x555116=_0x9aac6c,_0x5b3e86=shiftedTime();return _0x5b3e86['getFullYear']()+'/'+(_0x5b3e86[_0x555116(0x1dc)]()+0x1)[_0x555116(0x1d5)]()[_0x555116(0x181)](0x2,'0')+'/'+_0x5b3e86[_0x555116(0x167)]()[_0x555116(0x1d5)]()[_0x555116(0x181)](0x2,'0')+'\x20'+_0x5b3e86[_0x555116(0x1d8)]()[_0x555116(0x1d5)]()[_0x555116(0x181)](0x2,'0')+':'+_0x5b3e86[_0x555116(0x21c)]()[_0x555116(0x1d5)]()['padStart'](0x2,'0')+':'+_0x5b3e86[_0x555116(0x1bd)]()[_0x555116(0x1d5)]()[_0x555116(0x181)](0x2,'0');}function shiftedTime(){const _0x1eca2e=_0x9aac6c,_0x45de24=new Date();let _0x371e62=_0x45de24;if(settings['timeshift']&&settings[_0x1eca2e(0x175)]!==0x0)_0x371e62=fns[_0x1eca2e(0x11c)](_0x45de24,{'hours':settings[_0x1eca2e(0x175)]});return _0x371e62;}function startScheduler(){let _0x2aa15c=new Date()['getUTCHours']();_0x2aa15c==0x1&&backupConfigFiles();_0x2aa15c==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x55d824=_0x9aac6c;fs[_0x55d824(0x13f)](configpath,{'withFileTypes':!![]})[_0x55d824(0x1e4)](_0x4308ca=>{const _0x468f5f=_0x55d824;if(!_0x4308ca[_0x468f5f(0x179)]())fs[_0x468f5f(0x141)](configpath+_0x4308ca[_0x468f5f(0x16e)],configbackuppath+_0x4308ca[_0x468f5f(0x16e)]);});}function triggerAnalytics(){const _0x5bddb8=_0x9aac6c;analytics[_0x5bddb8(0x217)]({'title':'Balance\x20Bot\x20Server','href':_0x5bddb8(0x14e),'path':'/v'+serverversion});}function validateCredentials(_0x3b7f35,_0x240de4){const _0x3125f4=_0x9aac6c;if(_0x3b7f35[_0x3125f4(0x116)]==settings[_0x3125f4(0x139)]&&bcrypt['compareSync'](_0x3b7f35['password'],settings[_0x3125f4(0x16c)])){if(settings[_0x3125f4(0x238)])return{'allow':![],'reason':_0x3125f4(0x1b8),'token':null};else{const _0x42920a=generateLoginToken(_0x240de4);return{'allow':!![],'reason':_0x3125f4(0x1ca),'token':_0x42920a};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x54dc0c){const _0x424b7f=generateLoginToken(_0x54dc0c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x424b7f};}function _0x2259(_0x37641a,_0x34e0b0){const _0x5bcaa7=_0x10d1();return _0x2259=function(_0x49a91e,_0x45f19a){_0x49a91e=_0x49a91e-0x107;let _0x10d1d8=_0x5bcaa7[_0x49a91e];return _0x10d1d8;},_0x2259(_0x37641a,_0x34e0b0);}function validateAccess(_0x10c207,_0x329235){const _0x1dd5ad=_0x9aac6c;let _0x2158de=devices[_0x329235]['ip'],_0x141c79;const _0x423b5e=_0x31dd10=>{const _0x2f9a64=_0x2259;if(settings['loginRequired']){if(settings[_0x2f9a64(0x238)]){if(telegram2FaApproved(_0x329235)){const _0x39d0b4=generateLoginToken(_0x329235);return{'allow':!![],'reason':_0x2f9a64(0x18d),'token':_0x39d0b4};}else return{'allow':![],'reason':_0x2f9a64(0x1ce),'token':null};}else return _0x141c79=validToken(_0x31dd10,_0x329235),_0x141c79[_0x2f9a64(0x22e)](_0x2f9a64(0x1a1))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x31dd10}:{'allow':![],'reason':_0x2f9a64(0x1ce),'token':null};}else return{'allow':!![],'reason':_0x2f9a64(0x1f7),'token':null};};if(settings[_0x1dd5ad(0x12d)]){let _0x3da28b=[...settings[_0x1dd5ad(0x1fa)],_0x1dd5ad(0x16d),_0x1dd5ad(0x128),_0x1dd5ad(0x1fb)];if(_0x3da28b['includes'](_0x2158de))return _0x423b5e(_0x10c207);else{_0x141c79=validToken(_0x10c207,_0x329235);if(_0x141c79[_0x1dd5ad(0x22e)]('success'))return _0x423b5e(_0x10c207);else{if(telegramIpApproved(_0x329235)){const _0x3b1ab3=generateToken(_0x329235);return _0x141c79=_0x423b5e(_0x10c207),_0x141c79[_0x1dd5ad(0x1ae)]?{'allow':!![],'reason':_0x1dd5ad(0x1ed),'token':_0x3b1ab3}:_0x141c79;}else return settings[_0x1dd5ad(0x246)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x423b5e(_0x10c207);}function timelyDecrypt(_0x13c79f,_0x1b371f=!![]){const _0x4f600f=_0x9aac6c;if(_0x13c79f)try{const _0x1ee8a4=crypt[_0x4f600f(0x233)](secure[_0x4f600f(0x18f)],_0x13c79f)[_0x4f600f(0x193)],_0x50c1ed=_0x1ee8a4[_0x4f600f(0x1c3)]('@')[0x0],_0x4154c8=_0x1ee8a4[_0x4f600f(0x1c3)]('@')[0x1],_0x73f1c9=new Date()[_0x4f600f(0x245)]();if(_0x1b371f){if(_0x73f1c9-_0x4154c8<maxSecretAge*0x3e8)return _0x50c1ed;else return![];}else return _0x50c1ed;}catch(_0x2d1ed9){return![];}else return![];}const validToken=(_0x3ea17d,_0x3a7065)=>{const _0x1936c5=_0x9aac6c,_0x4e7653=devices[_0x3a7065]['ip'];if(!_0x3ea17d)return{'error':_0x1936c5(0x22a)};for(let _0xa43bba of blacklist){if(_0xa43bba[_0x1936c5(0x191)]==_0x3ea17d)return{'error':_0x1936c5(0x228)};}let _0x106c5a;try{_0x106c5a=jwt[_0x1936c5(0x21a)](_0x3ea17d,secure[_0x1936c5(0x207)]+_0x3a7065);}catch{return{'error':_0x1936c5(0x20c)};}if(!_0x106c5a[_0x1936c5(0x22e)](_0x1936c5(0x174))&&!_0x106c5a[_0x1936c5(0x22e)]('username')||!_0x106c5a[_0x1936c5(0x22e)](_0x1936c5(0x1a2)))return{'error':_0x1936c5(0x1de)};if(!_0x106c5a['hasOwnProperty'](_0x1936c5(0x116))&&_0x106c5a[_0x1936c5(0x22e)](_0x1936c5(0x174))){const {clientip:_0x289a8c}=_0x106c5a;return _0x4e7653==_0x289a8c?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1936c5(0x19d)};}else{if(_0x106c5a['hasOwnProperty'](_0x1936c5(0x116))&&_0x106c5a[_0x1936c5(0x22e)](_0x1936c5(0x174))){const {username:_0x3ba67b,clientip:_0x3844c8}=_0x106c5a;return settings[_0x1936c5(0x139)]==_0x3ba67b&&_0x4e7653==_0x3844c8?{'success':_0x1936c5(0x1bc)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x2f19f4=>{const _0x4625cd=_0x9aac6c;if(_0x2f19f4){const _0x2939c8=devices[_0x2f19f4]['ip'];return jwt[_0x4625cd(0x1ab)]({'username':settings[_0x4625cd(0x139)],'clientip':_0x2939c8},secure[_0x4625cd(0x207)]+_0x2f19f4,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x367c5a=>{const _0x349284=_0x9aac6c;if(_0x367c5a){const _0x5791c2=devices[_0x367c5a]['ip'];return jwt[_0x349284(0x1ab)]({'clientip':_0x5791c2},secure[_0x349284(0x207)]+_0x367c5a,{'expiresIn':devices[_0x367c5a][_0x349284(0x146)][_0x349284(0x221)]*0x3c});}else return![];},telegramIpApproved=_0x51b277=>{const _0x371474=_0x9aac6c;let _0x2453be=![];return devices[_0x51b277][_0x371474(0x146)]&&devices[_0x51b277]['telegramIpApproval'][_0x371474(0x221)]!='reject'&&(_0x2453be=devices[_0x51b277][_0x371474(0x146)]['clientip']==devices[_0x51b277]['ip']&&new Date()[_0x371474(0x245)]()-devices[_0x51b277][_0x371474(0x146)][_0x371474(0x216)]<devices[_0x51b277]['telegramIpApproval'][_0x371474(0x221)]*0x3c*0x3e8),_0x2453be;},telegram2FaApproved=_0xc02c9f=>{const _0x5df028=_0x9aac6c;let _0x5ae0dc=![];return devices[_0xc02c9f][_0x5df028(0x1f9)]&&devices[_0xc02c9f]['telegram2FaApproval']['expiry']!=_0x5df028(0x23b)&&(_0x5ae0dc=devices[_0xc02c9f][_0x5df028(0x1f9)]['clientip']==devices[_0xc02c9f]['ip']&&new Date()[_0x5df028(0x245)]()-devices[_0xc02c9f][_0x5df028(0x1f9)]['timestamp']<devices[_0xc02c9f][_0x5df028(0x1f9)]['expiry']*0x3c*0x3e8),_0x5ae0dc;},normalizeIP=_0x2c96f6=>{const _0x49dc04=_0x9aac6c;let _0x5912a4=null,_0x372c60=null;if(ipaddr[_0x49dc04(0x199)](_0x2c96f6)){const _0x1a988a=ipaddr[_0x49dc04(0x144)](_0x2c96f6);_0x1a988a['kind']()===_0x49dc04(0x125)?(_0x1a988a['isIPv4MappedAddress']()&&(_0x5912a4=_0x1a988a[_0x49dc04(0x1fe)]()[_0x49dc04(0x1d5)]()),_0x372c60=_0x1a988a[_0x49dc04(0x1d5)]()):(_0x5912a4=_0x1a988a[_0x49dc04(0x1d5)](),_0x372c60=_0x1a988a[_0x49dc04(0x148)]()['toString']());}return{'show':_0x5912a4?_0x5912a4:_0x372c60,'store':_0x372c60};};