const _0x2c43c1=_0x4fa4;(function(_0x136746,_0x1e4ea7){const _0x90faae=_0x4fa4,_0x2ff9d1=_0x136746();while(!![]){try{const _0x1893e9=-parseInt(_0x90faae(0x349))/0x1*(parseInt(_0x90faae(0x1cb))/0x2)+parseInt(_0x90faae(0x2b0))/0x3*(parseInt(_0x90faae(0x21b))/0x4)+-parseInt(_0x90faae(0x1b1))/0x5+parseInt(_0x90faae(0x219))/0x6*(-parseInt(_0x90faae(0x26d))/0x7)+-parseInt(_0x90faae(0x391))/0x8*(-parseInt(_0x90faae(0x2a8))/0x9)+-parseInt(_0x90faae(0x1d8))/0xa*(-parseInt(_0x90faae(0x39c))/0xb)+-parseInt(_0x90faae(0x370))/0xc*(-parseInt(_0x90faae(0x31b))/0xd);if(_0x1893e9===_0x1e4ea7)break;else _0x2ff9d1['push'](_0x2ff9d1['shift']());}catch(_0x26b457){_0x2ff9d1['push'](_0x2ff9d1['shift']());}}}(_0xc6a1,0xf1bfb));const _0x153740=function(){let _0x138855=!![];return function(_0xa2257b,_0x5238e4){const _0x140e42=_0x138855?function(){if(_0x5238e4){const _0x5f3846=_0x5238e4['apply'](_0xa2257b,arguments);return _0x5238e4=null,_0x5f3846;}}:function(){};return _0x138855=![],_0x140e42;};}(),_0x2eeb99=_0x153740(this,function(){const _0x5a76c2=_0x4fa4;return _0x2eeb99[_0x5a76c2(0x253)]()[_0x5a76c2(0x227)](_0x5a76c2(0x1d3))[_0x5a76c2(0x253)]()[_0x5a76c2(0x397)](_0x2eeb99)[_0x5a76c2(0x227)]('(((.+)+)+)+$');});_0x2eeb99();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x2c43c1(0x1a9)),fs=require('fs'),fns=require(_0x2c43c1(0x1e4)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x2c43c1(0x2e3)),crypto=require('crypto'),Crypt=require(_0x2c43c1(0x2ec))[_0x2c43c1(0x33d)],RSA=require(_0x2c43c1(0x2ec))[_0x2c43c1(0x311)],bcrypt=require('bcryptjs'),jwt=require(_0x2c43c1(0x1dc)),ipaddr=require('ipaddr.js'),argv=require(_0x2c43c1(0x36b))(process[_0x2c43c1(0x372)][_0x2c43c1(0x319)](0x2))[_0x2c43c1(0x372)],uuidRandom=require(_0x2c43c1(0x304)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x2c43c1(0x34c)),axios=require(_0x2c43c1(0x2e1)),{GraphQLClient,gql}=require(_0x2c43c1(0x213)),util=require(_0x2c43c1(0x329)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x2c43c1(0x288)]||_0x2c43c1(0x201),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x2c43c1(0x286)](_0x2c43c1(0x1e8)+PORT+_0x2c43c1(0x24e)),process[_0x2c43c1(0x317)](0x1));const HOST=argv[_0x2c43c1(0x323)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x2c43c1(0x20c)];let bbpath=_0x2c43c1(0x2a0),bbpath2='';const botfile=_0x2c43c1(0x221),configfile=_0x2c43c1(0x310),settingsfile=_0x2c43c1(0x2ea),securefile=_0x2c43c1(0x392),environment=require('./'+bbpath2+'version.json')[_0x2c43c1(0x29b)]||_0x2c43c1(0x3a8),maxBackups=0xa;let validInstallation=!![];!fs[_0x2c43c1(0x376)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2c43c1(0x342)),configpath=userID?bbpath+_0x2c43c1(0x303)+userID+'/':bbpath+_0x2c43c1(0x303),configbackuppath=configpath+_0x2c43c1(0x1d0),logspath=userID?bbpath+_0x2c43c1(0x232)+userID+'/':bbpath+_0x2c43c1(0x232),zippath=userID?bbpath+_0x2c43c1(0x289)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x2c43c1(0x2fa)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x2c43c1(0x1f8)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x2c43c1(0x23f)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x2c43c1(0x23f)](configbackuppath);!fs[_0x2c43c1(0x376)](logspath)&&fs[_0x2c43c1(0x23f)](logspath);!fs[_0x2c43c1(0x376)](zippath)&&fs[_0x2c43c1(0x23f)](zippath);!fs['existsSync'](temppath)&&fs[_0x2c43c1(0x23f)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2c43c1(0x2f8)]({'bots':[]})[_0x2c43c1(0x224)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x4fa4(_0xacb039,_0x4fed01){const _0x4514de=_0xc6a1();return _0x4fa4=function(_0x2eeb99,_0x153740){_0x2eeb99=_0x2eeb99-0x1a4;let _0xc6a17a=_0x4514de[_0x2eeb99];return _0xc6a17a;},_0x4fa4(_0xacb039,_0x4fed01);}dbSettings[_0x2c43c1(0x2f8)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2c43c1(0x2fc),'onepagemode':![]}})[_0x2c43c1(0x224)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2c43c1(0x2f8)]({'secure':{},'blacklist':[]})[_0x2c43c1(0x224)]();let crypt=new Crypt({'md':_0x2c43c1(0x243),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x2c43c1(0x2e2)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x2c43c1(0x2b2)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2c43c1(0x31e)]&&(settings[_0x2c43c1(0x31e)]!=''&&settings['telegramToken']!=_0x2c43c1(0x1c3))&&settings['telegramUsername']&&settings[_0x2c43c1(0x2ef)]!='')initTelegram();const parseColor=(_0x5ca84e,_0x5604c0)=>{const _0x3a96f1=_0x2c43c1,_0x2b2cb1=/#[A-Z]{3}#/g;if(typeof _0x5ca84e==_0x3a96f1(0x341)){!_0x5604c0?_0x5ca84e=_0x5ca84e[_0x3a96f1(0x2c2)](_0x2b2cb1,''):(_0x5ca84e=_0x5ca84e[_0x3a96f1(0x2c2)](/#BLU#/g,_0x3a96f1(0x260)),_0x5ca84e=_0x5ca84e['replace'](/#RED#/g,_0x3a96f1(0x3a2)),_0x5ca84e=_0x5ca84e[_0x3a96f1(0x2c2)](/#YEL#/g,_0x3a96f1(0x2e4)),_0x5ca84e=_0x5ca84e[_0x3a96f1(0x2c2)](/#MAG#/g,_0x3a96f1(0x337)),_0x5ca84e=_0x5ca84e[_0x3a96f1(0x2c2)](/#CYA#/g,_0x3a96f1(0x263)),_0x5ca84e=_0x5ca84e['replace'](/#RES#/g,_0x3a96f1(0x2bd)));;}return _0x5ca84e;},logger={'screen':_0x424287=>{const _0x501f1a=_0x2c43c1;console[_0x501f1a(0x286)](parseColor(_0x424287,!![]));},'simple':_0x1c39cd=>{const _0x53c170=_0x2c43c1;console[_0x53c170(0x286)](parseColor(_0x1c39cd,!![])),loggerfile[_0x53c170(0x224)](util[_0x53c170(0x373)](parseColor(_0x1c39cd,![]))+'\x0a');},'full':async _0x4f95f7=>{const _0x1c714b=_0x2c43c1,_0x37cea1=getTimeStamp()+_0x1c714b(0x25c)+_0x4f95f7;console[_0x1c714b(0x286)](parseColor(_0x37cea1,!![])),loggerfile[_0x1c714b(0x224)](util[_0x1c714b(0x373)](parseColor(_0x37cea1,![]))+'\x0a');if(tgBot&&settings[_0x1c714b(0x2b1)]&&settings[_0x1c714b(0x299)]!=_0x1c714b(0x365))await sendTelegram(settings['telegramChatId'],_0x1c714b(0x248)+parseColor(_0x4f95f7,![]));},'debug':async(_0x554232,_0x4b23ea='')=>{const _0xa0ccd0=_0x2c43c1,_0x563025=getTimeStamp()+_0xa0ccd0(0x1c7)+_0x554232;if(debugging)console[_0xa0ccd0(0x286)](parseColor(_0x563025,!![]));loggerfile[_0xa0ccd0(0x224)](util[_0xa0ccd0(0x373)](parseColor(_0x563025,![]))+'\x0a');if(_0x4b23ea){if(debugging)console['log'](_0x4b23ea);loggerfile[_0xa0ccd0(0x224)](util[_0xa0ccd0(0x373)](_0x4b23ea)+'\x0a');}}};let terminating=![];process['on'](_0x2c43c1(0x2ab),function(_0xeba77d){const _0x545ca8=_0x2c43c1;logger[_0x545ca8(0x3a9)](_0xeba77d);}),process['on'](_0x2c43c1(0x317),()=>{const _0x136039=_0x2c43c1;stopAllBots(),process[_0x136039(0x317)](0x0);}),process['on'](_0x2c43c1(0x2ad),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x2c43c1(0x296)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2c43c1(0x331)),app=express(),http=require('http')['createServer'](app);app[_0x2c43c1(0x1aa)](fileUpload({'useTempFiles':!![]})),app[_0x2c43c1(0x1d9)]('/download/:type',async(_0xc09174,_0x40a6b8)=>{const _0x62fede=_0x2c43c1,_0x3dc5bc=_0xc09174[_0x62fede(0x34a)][_0x62fede(0x25e)],_0x51623d=getClientsWithBotID(_0x62fede(0x1e1)),_0x13b657=_0xc09174[_0x62fede(0x3a1)]['uuid'],_0x350496=timelyDecrypt(_0x13b657,![]),_0x578ba3=_0x51623d[_0x62fede(0x2b5)](_0x4b34f6=>_0x4b34f6[_0x62fede(0x32a)]==_0x350496);if(_0x578ba3){const _0x20ccc5=normalizeIP(_0xc09174[_0x62fede(0x361)]['remoteAddress'])['store'],_0xaf31e9=_0xc09174['headers']['tkn'];if(validateAccess(_0xaf31e9,_0x350496,_0x20ccc5)[_0x62fede(0x3aa)])_0x3dc5bc=='backup'&&await backupConfigFiles(),await zipFiles(_0x3dc5bc),_0x40a6b8['download'](zippath+(_0x3dc5bc+_0x62fede(0x27e)),_0x53842c=>{const _0x45ea5a=_0x62fede;_0x53842c&&(logger[_0x45ea5a(0x3a7)](_0x45ea5a(0x1d5)+_0x3dc5bc),logger[_0x45ea5a(0x3a9)](_0x53842c));});else logger[_0x62fede(0x3a7)](_0x62fede(0x2e7)+_0x3dc5bc+_0x62fede(0x293));}else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x3dc5bc+_0x62fede(0x1ac));}),app[_0x2c43c1(0x387)](_0x2c43c1(0x220),async(_0x2c892c,_0x56da31)=>{const _0xe287f8=_0x2c43c1,_0x4d6c6b=getClientsWithBotID(_0xe287f8(0x1e1)),_0x5ae257=_0x2c892c[_0xe287f8(0x3a1)][_0xe287f8(0x32a)],_0x2cdc60=timelyDecrypt(_0x5ae257,![]),_0x8978db=_0x4d6c6b['find'](_0x20e7e=>_0x20e7e[_0xe287f8(0x32a)]==_0x2cdc60);logger[_0xe287f8(0x2af)](_0xe287f8(0x1c2));if(_0x8978db){const _0x54a9ed=normalizeIP(_0x2c892c['socket'][_0xe287f8(0x200)])[_0xe287f8(0x29a)],_0x549998=_0x2c892c['headers'][_0xe287f8(0x321)];if(validateAccess(_0x549998,_0x2cdc60,_0x54a9ed)['allow']){if(_0x2c892c[_0xe287f8(0x20b)]){const _0x38f271=_0x2c892c[_0xe287f8(0x20b)]['backupfile'];await _0x38f271['mv'](temppath+_0x38f271[_0xe287f8(0x1ba)]),_0x56da31[_0xe287f8(0x27c)]({'status':!![],'message':_0xe287f8(0x272)});const _0x4432aa=getBotsWithMode();_0x4432aa[_0xe287f8(0x31c)]>0x0?confirmRestore(temppath,_0x38f271[_0xe287f8(0x1ba)]):unzipFile(temppath,_0x38f271[_0xe287f8(0x1ba)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0xe287f8(0x3a7)](_0xe287f8(0x388));}),app[_0x2c43c1(0x1aa)](express['static'](path[_0x2c43c1(0x2b3)](__dirname,bbpath2,_0x2c43c1(0x29d)))),app[_0x2c43c1(0x1aa)](express[_0x2c43c1(0x398)](path[_0x2c43c1(0x2b3)](__dirname,bbpath2,'build'))),app[_0x2c43c1(0x1d9)]('/',function(_0x5de359,_0x1ef8e0){const _0x2e6411=_0x2c43c1;_0x1ef8e0[_0x2e6411(0x36c)](path[_0x2e6411(0x2b3)](__dirname,bbpath2,_0x2e6411(0x29d),_0x2e6411(0x1cd)));}),app['get'](_0x2c43c1(0x24a),function(_0x50dd44,_0x343471){const _0x191026=_0x2c43c1;_0x343471[_0x191026(0x36c)](path[_0x191026(0x2b3)](__dirname,bbpath2,_0x191026(0x2d5),_0x191026(0x1cd)));}),app[_0x2c43c1(0x1d9)](_0x2c43c1(0x1a4),(_0x142fc6,_0x2ae8fa)=>{const _0x258980=_0x2c43c1;_0x2ae8fa['sendFile'](path[_0x258980(0x2b3)](__dirname,bbpath2,'build',_0x258980(0x1cd)));}),app[_0x2c43c1(0x1d9)](_0x2c43c1(0x212),(_0x29d660,_0x5781ed)=>{const _0x3f838e=_0x2c43c1;_0x5781ed[_0x3f838e(0x36c)](path[_0x3f838e(0x2b3)](__dirname,bbpath2,_0x3f838e(0x2d5),'index.html'));}),app[_0x2c43c1(0x1d9)](_0x2c43c1(0x26b),(_0xcaf6d7,_0xab2398)=>{const _0x414383=_0x2c43c1;_0xab2398[_0x414383(0x36c)](path['join'](__dirname,bbpath2,'build',_0x414383(0x1cd)));}),app[_0x2c43c1(0x1d9)](_0x2c43c1(0x34e),(_0x459149,_0x1eaba4)=>{const _0x12cde4=_0x2c43c1;_0x1eaba4['sendFile'](path[_0x12cde4(0x2b3)](__dirname,bbpath2,_0x12cde4(0x2d5),'index.html'));}),app[_0x2c43c1(0x1d9)](_0x2c43c1(0x28d),(_0x272a2b,_0x4bf4fa)=>{const _0x480fca=_0x2c43c1;_0x4bf4fa['sendFile'](path[_0x480fca(0x2b3)](__dirname,bbpath2,_0x480fca(0x2d5),'index.html'));}),app[_0x2c43c1(0x1d9)](_0x2c43c1(0x225),(_0x2603b,_0x41831a)=>{const _0x53966d=_0x2c43c1;_0x41831a[_0x53966d(0x36c)](path[_0x53966d(0x2b3)](__dirname,bbpath2,'build',_0x53966d(0x1cd)));});if(HOST)http[_0x2c43c1(0x1c0)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5cd4fd=_0x2c43c1;let _0x2b0c16=_0x5cd4fd(0x284);const _0x118407=networkInterfaces(),_0xf6b372={};for(const _0x262b4a of Object[_0x5cd4fd(0x36f)](_0x118407)){for(const _0x4258ed of _0x118407[_0x262b4a]){if((_0x4258ed['family']==_0x5cd4fd(0x3a3)||_0x4258ed[_0x5cd4fd(0x230)]==0x4)&&!_0x4258ed[_0x5cd4fd(0x37c)]){const _0x1d3076=ipaddr[_0x5cd4fd(0x363)](_0x4258ed[_0x5cd4fd(0x378)])[_0x5cd4fd(0x2b8)]();_0x1d3076!=_0x5cd4fd(0x1c6)&&(!_0xf6b372[_0x262b4a]&&(_0xf6b372[_0x262b4a]=[]),_0xf6b372[_0x262b4a][_0x5cd4fd(0x26e)](_0x4258ed[_0x5cd4fd(0x378)]),_0x2b0c16=_0x4258ed[_0x5cd4fd(0x378)]);}}}return{'serverip':_0x2b0c16,'netinterfaces':_0xf6b372};}async function startServer(){const _0xc42fa6=_0x2c43c1,{serverip:_0x3a2bb1,netinterfaces:_0x28b7c0}=getServerIP();logger[_0xc42fa6(0x3a9)](''),logger[_0xc42fa6(0x3a9)](_0xc42fa6(0x281)),await logger[_0xc42fa6(0x3a7)](_0xc42fa6(0x325)+serverversion+'#RES#\x20'+(environment==_0xc42fa6(0x2c7)?'(staging)':'')+'\x0a'+(_0xc42fa6(0x1e2)+PORT+_0xc42fa6(0x346))+(_0xc42fa6(0x228)+_0x3a2bb1+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0xc42fa6(0x281));if(config['length']!=0x0)for(const _0x1234ac of config){const _0x1745c2=_0x1234ac[_0xc42fa6(0x2c4)]=='auto'?'a':'m';if(_0x1234ac[_0xc42fa6(0x24d)]=='enabled'||_0x1234ac[_0xc42fa6(0x24d)]==_0xc42fa6(0x1c8))await logger[_0xc42fa6(0x3a7)](_0xc42fa6(0x2ed)+_0x1745c2+')\x20|\x20Bot\x20'+_0x1234ac['botID']+'\x20|\x20'+_0x1234ac[_0xc42fa6(0x32f)]),startBot([_0x1234ac[_0xc42fa6(0x324)],userID],{'cwd':bbpath},function(_0x168c7b){const _0x57f31b=_0xc42fa6;if(_0x168c7b)logger[_0x57f31b(0x3a7)](_0x168c7b);});else(_0x1234ac[_0xc42fa6(0x24d)]==_0xc42fa6(0x1bd)||_0x1234ac['status']=='new-disabled')&&await logger[_0xc42fa6(0x3a7)]('Idling\x20('+_0x1745c2+_0xc42fa6(0x2ee)+_0x1234ac[_0xc42fa6(0x324)]+'\x20|\x20'+_0x1234ac[_0xc42fa6(0x32f)]);}else!newBot&&logger['simple'](_0xc42fa6(0x1ed));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0xc42fa6(0x2af)]('Node.js\x20v'+nodeversion),await logger[_0xc42fa6(0x2af)](_0xc42fa6(0x2ac),_0x28b7c0);}function startSocket(){io['on']('connection',_0x2a6ae1=>{const _0x108748=_0x4fa4;let _0x2158ad,_0x10bbc1,_0x5efd0b,_0x1f1be2,_0x1ab64f;const _0xd214fe=_0x2a6ae1['handshake']['headers']['referer'];_0x10bbc1=_0xd214fe[_0x108748(0x266)](/bot[0-9]{3}/);if(_0x10bbc1)_0x5efd0b=_0x10bbc1[0x0]['match'](/[0-9]{3}/);if(_0x5efd0b)_0x2158ad=_0x5efd0b[0x0];else _0x2158ad='botmanager';const _0x3cc63a=_0x2a6ae1[_0x108748(0x37b)][_0x108748(0x32e)][_0x108748(0x33f)];if(!_0x3cc63a)_0x2a6ae1[_0x108748(0x320)](_0x108748(0x24d),{'publicKey':secure[_0x108748(0x2e8)]});else{_0x1f1be2=timelyDecrypt(_0x3cc63a,![]);if(!_0x1f1be2)_0x2a6ae1[_0x108748(0x320)](_0x108748(0x24d),{'publicKey':secure[_0x108748(0x2e8)]});else{_0x1ab64f=normalizeIP(_0x2a6ae1[_0x108748(0x2d4)][_0x108748(0x200)])[_0x108748(0x29a)];if(!devices[_0x1f1be2])devices[_0x1f1be2]={'uuid':_0x1f1be2,'access':{'token':null}};devices[_0x1f1be2]['ip']=_0x1ab64f;const _0x3176b7=addClient(_0x2a6ae1['id'],_0x1f1be2,_0x2158ad);setAccess(_0x3176b7),emitMessages(),_0x2a6ae1['on'](_0x108748(0x1e9),_0x4d6b85=>{const _0x545dee=_0x108748,_0x1bae62=timelyDecrypt(_0x4d6b85[_0x545dee(0x254)]);if(_0x1bae62){_0x4d6b85={'username':_0x4d6b85[_0x545dee(0x1f5)],'password':_0x1bae62},devices[_0x1f1be2]['access']=validateCredentials(_0x4d6b85,_0x1f1be2);if(devices[_0x1f1be2][_0x545dee(0x2fe)][_0x545dee(0x3aa)]==![]&&devices[_0x1f1be2][_0x545dee(0x2fe)][_0x545dee(0x33a)]=='2FA\x20login\x20required')_0x2a6ae1[_0x545dee(0x320)]('status',{'access':devices[_0x1f1be2][_0x545dee(0x2fe)]}),loginAccess2FA(_0x1f1be2,_0x1ab64f);else{if(devices[_0x1f1be2]['access'][_0x545dee(0x3aa)]==![]&&devices[_0x1f1be2][_0x545dee(0x2fe)]['reason']==_0x545dee(0x26f))_0x2a6ae1['emit']('status',{'access':devices[_0x1f1be2][_0x545dee(0x2fe)]});else devices[_0x1f1be2][_0x545dee(0x2fe)][_0x545dee(0x3aa)]&&devices[_0x1f1be2][_0x545dee(0x2fe)][_0x545dee(0x33a)]==_0x545dee(0x1c5)&&(getClientsWithUuid(_0x1f1be2)[_0x545dee(0x2a5)](_0x3c71=>{setAccess(_0x3c71);}),logger[_0x545dee(0x2af)](_0x545dee(0x28e)+_0x1f1be2[_0x545dee(0x319)](-0x8)),setTokenRefresh(_0x1f1be2),setSessionTimeout(_0x545dee(0x1e9),_0x1f1be2));}}else logger[_0x545dee(0x3a7)](_0x545dee(0x313));}),_0x2a6ae1['on'](_0x108748(0x35a),()=>{resetPassword();}),_0x2a6ae1['on']('disconnect',_0x12dead=>{removeClient(_0x2a6ae1['id']);}),_0x2158ad==_0x108748(0x1e1)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1f3943){const _0x275912=_0x2c43c1;if(_0x1f3943!=_0x275912(0x1e1)&&config[_0x275912(0x2c8)]!=''){if(pid[_0x1f3943])pid[_0x1f3943]['send']({'function':_0x275912(0x1e7),'args':null});}_0x1f3943!='botmanager'&&broadcastToBots(_0x275912(0x1be),JSON[_0x275912(0x294)](config));}function reloadBotManager(){const _0x228d59=_0x2c43c1;getClientsWithBotID(_0x228d59(0x1e1))['forEach'](_0x1e5867=>{const _0x60e85f=_0x228d59;getSocket(_0x1e5867['id'])[_0x60e85f(0x320)](_0x60e85f(0x24d),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0xe0746e){const _0x29be87=_0x2c43c1;return io['sockets'][_0x29be87(0x384)][_0x29be87(0x1d9)](_0xe0746e);}function setAccess(_0x45841e){const _0x151b62=_0x2c43c1,_0x2cc42f=getSocket(_0x45841e['id']),_0xe9624b=_0x45841e[_0x151b62(0x32a)],_0x2c2d5e=_0x45841e[_0x151b62(0x353)];devices[_0xe9624b]['access']=validateAccess(devices[_0xe9624b]['access']['token'],_0xe9624b),logger['debug'](_0x151b62(0x377)+devices[_0xe9624b][_0x151b62(0x2fe)][_0x151b62(0x33a)]+'\x20|\x20client:\x20...'+_0x45841e['id'][_0x151b62(0x319)](-0x8)+_0x151b62(0x26c)+_0xe9624b[_0x151b62(0x319)](-0x8)),_0x2cc42f[_0x151b62(0x2b3)](_0xe9624b);if(devices[_0xe9624b][_0x151b62(0x2fe)][_0x151b62(0x3aa)]){_0x2cc42f['join'](_0x2c2d5e);if(_0x2c2d5e==_0x151b62(0x1e1))initializeSocketBotManager(_0x2cc42f);else initializeSocketBot(_0x2cc42f);initClient(_0x2c2d5e);}devices[_0xe9624b]['access'][_0x151b62(0x37e)]&&devices[_0xe9624b][_0x151b62(0x2fe)]['reason']==_0x151b62(0x2b7)&&setSessionTimeout(_0x151b62(0x214),_0xe9624b),devices[_0xe9624b]['access'][_0x151b62(0x37e)]&&devices[_0xe9624b][_0x151b62(0x2fe)][_0x151b62(0x33a)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x151b62(0x1e9),_0xe9624b),_0x2cc42f[_0x151b62(0x320)](_0x151b62(0x24d),{'status':_0x45841e[_0x151b62(0x1d6)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xe9624b][_0x151b62(0x2fe)],'externalip':devices[_0xe9624b]['ip'],'publicKey':secure[_0x151b62(0x2e8)],'userid':settings[_0x151b62(0x33b)],'validInstallation':validInstallation}),devices[_0xe9624b][_0x151b62(0x2fe)][_0x151b62(0x3aa)]==![]&&devices[_0xe9624b][_0x151b62(0x2fe)]['reason']==_0x151b62(0x3a4)&&temporaryAccess2FA(_0xe9624b,devices[_0xe9624b]['ip']);}function setSessionTimeout(_0x3b0729,_0x1e43fd){const _0x2f4e50=_0x2c43c1;let _0x26f1bd;if(_0x3b0729=='login')_0x26f1bd=loginExpiry*0x3c*0x3e8;else _0x26f1bd=devices[_0x1e43fd][_0x2f4e50(0x366)][_0x2f4e50(0x2ca)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1e43fd][_0x2f4e50(0x366)]['timestamp']);if(devices[_0x1e43fd][_0x2f4e50(0x39a)])clearTimeout(devices[_0x1e43fd][_0x2f4e50(0x39a)]);devices[_0x1e43fd][_0x2f4e50(0x39a)]=setTimeout(()=>{const _0xe24daf=_0x2f4e50;if(devices[_0x1e43fd][_0xe24daf(0x295)])clearTimeout(devices[_0x1e43fd][_0xe24daf(0x295)]);removeSocketListeners(_0x1e43fd),addBlacklist(_0x1e43fd),devices[_0x1e43fd][_0xe24daf(0x366)]=null,devices[_0x1e43fd][_0xe24daf(0x251)]=null,devices[_0x1e43fd][_0xe24daf(0x2fe)][_0xe24daf(0x37e)]=null,logger[_0xe24daf(0x2af)](_0xe24daf(0x34f)+_0x1e43fd[_0xe24daf(0x319)](-0x8)),devices[_0x1e43fd][_0xe24daf(0x2fe)]=validateAccess(devices[_0x1e43fd][_0xe24daf(0x2fe)]['token'],_0x1e43fd),!(devices[_0x1e43fd]['access']['allow']&&devices[_0x1e43fd][_0xe24daf(0x2fe)][_0xe24daf(0x33a)]==_0xe24daf(0x31a))&&(_0x3b0729=='login'?io['to'](_0x1e43fd)[_0xe24daf(0x320)](_0xe24daf(0x24d),{'access':{'allow':![],'reason':_0xe24daf(0x2f9),'token':null}}):io['to'](_0x1e43fd)[_0xe24daf(0x320)](_0xe24daf(0x24d),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x1e43fd][_0xe24daf(0x2fe)][_0xe24daf(0x37e)]=null;},_0x26f1bd);}function setTokenRefresh(_0x48e67e){const _0x2aba6a=_0x2c43c1;if(devices[_0x48e67e][_0x2aba6a(0x295)])clearTimeout(devices[_0x48e67e][_0x2aba6a(0x295)]);devices[_0x48e67e][_0x2aba6a(0x295)]=setTimeout(()=>{const _0x51572e=_0x2aba6a;getClientsWithUuid(_0x48e67e)['length']!=0x0?(devices[_0x48e67e][_0x51572e(0x2fe)]=refreshToken(_0x48e67e),io['to'](_0x48e67e)[_0x51572e(0x320)](_0x51572e(0x24d),{'status':_0x51572e(0x1f0),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x48e67e][_0x51572e(0x2fe)],'externalip':devices[_0x48e67e]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x48e67e)):clearTimeout(devices[_0x48e67e][_0x51572e(0x295)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x55128a){const _0x57ed7c=_0x2c43c1,_0x2a9085=getClient(_0x55128a['id'])[_0x57ed7c(0x32a)];_0x55128a[_0x57ed7c(0x320)](_0x57ed7c(0x1be),config),_0x55128a[_0x57ed7c(0x320)](_0x57ed7c(0x37f),cleanSettings()),_0x55128a['on']('add-bot',_0x20afc2=>{const _0x867072=_0x57ed7c;if(validateAccess(_0x20afc2,_0x2a9085)[_0x867072(0x3aa)])addBot();else logger[_0x867072(0x3a7)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x55128a['on'](_0x57ed7c(0x1af),(_0x1d6d9e,_0xc46f43)=>{const _0xad4112=_0x57ed7c;if(validateAccess(_0xc46f43,_0x2a9085)[_0xad4112(0x3aa)])toggleBot(_0x1d6d9e['botID'],_0x1d6d9e['status'],_0x1d6d9e[_0xad4112(0x343)]);else logger[_0xad4112(0x3a7)](_0xad4112(0x30e));}),_0x55128a['on']('toggle-bot-mode',(_0x3e1a62,_0x27672a)=>{const _0x1ac6d3=_0x57ed7c;if(validateAccess(_0x27672a,_0x2a9085)['allow'])toggleBotMode(_0x3e1a62);else logger[_0x1ac6d3(0x3a7)](_0x1ac6d3(0x30e));}),_0x55128a['on'](_0x57ed7c(0x1b3),(_0xcb9016,_0x408cf9)=>{const _0x2ae4c1=_0x57ed7c;if(validateAccess(_0x408cf9,_0x2a9085)[_0x2ae4c1(0x3aa)])deleteBot(_0xcb9016);else logger[_0x2ae4c1(0x3a7)](_0x2ae4c1(0x2dc));}),_0x55128a['on'](_0x57ed7c(0x2f4),(_0xb23f0d,_0x5d239e)=>{const _0xf1eb71=_0x57ed7c;if(validateAccess(_0x5d239e,_0x2a9085)[_0xf1eb71(0x3aa)])storeSettings(_0xb23f0d,!![]);else logger[_0xf1eb71(0x3a7)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x55128a['on'](_0x57ed7c(0x258),_0x7d1e4f=>{const _0x18c352=_0x57ed7c;if(validateAccess(_0x7d1e4f,_0x2a9085)['allow'])updateBB(_0x18c352(0x362));else logger[_0x18c352(0x3a7)](_0x18c352(0x1ee));}),_0x55128a['on'](_0x57ed7c(0x23a),_0x2c0524=>{const _0x251600=_0x57ed7c;if(validateAccess(_0x2c0524,_0x2a9085)['allow'])updateBB(_0x251600(0x2cc));else logger[_0x251600(0x3a7)](_0x251600(0x32b));}),_0x55128a['on']('get-backup-files',_0x2d07c1=>{const _0x101142=_0x57ed7c;if(validateAccess(_0x2d07c1,_0x2a9085)[_0x101142(0x3aa)]){const _0x3ab86e=getClient(_0x55128a['id']);if(_0x3ab86e)getBackupFiles(_0x3ab86e[_0x101142(0x32a)]);else logger[_0x101142(0x3a7)](_0x101142(0x2f0));}else logger['full'](_0x101142(0x30b));}),_0x55128a['on'](_0x57ed7c(0x1fc),(_0x120cd6,_0x22a7cd)=>{const _0x46855a=_0x57ed7c;if(validateAccess(_0x22a7cd,_0x2a9085)[_0x46855a(0x3aa)])restoreBackupFile(_0x120cd6);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x55128a['on'](_0x57ed7c(0x1f3),_0x435042=>{const _0x215cfd=_0x57ed7c;if(validateAccess(_0x435042,_0x2a9085)[_0x215cfd(0x3aa)])getMessages();else logger[_0x215cfd(0x3a7)](_0x215cfd(0x22e));}),_0x55128a['on']('confirm-message',(_0x2715a0,_0x5c8b59)=>{const _0x38cb90=_0x57ed7c;if(validateAccess(_0x5c8b59,_0x2a9085)['allow'])confirmMessage(_0x2715a0);else logger['full'](_0x38cb90(0x2dd));}),_0x55128a['on']('logout',_0x487648=>{const _0x41e960=_0x57ed7c;if(validateAccess(_0x487648,_0x2a9085)[_0x41e960(0x3aa)]){if(devices[_0x2a9085]['pidRefreshToken'])clearTimeout(devices[_0x2a9085]['pidRefreshToken']);if(devices[_0x2a9085][_0x41e960(0x39a)])clearTimeout(devices[_0x2a9085][_0x41e960(0x39a)]);removeSocketListeners(getClient(_0x55128a['id'])[_0x41e960(0x32a)]),addBlacklist(_0x2a9085),devices[_0x2a9085][_0x41e960(0x366)]=null,devices[_0x2a9085][_0x41e960(0x251)]=null,devices[_0x2a9085][_0x41e960(0x2fe)]['token']=null,logger[_0x41e960(0x2af)](_0x41e960(0x3a6)+_0x2a9085[_0x41e960(0x319)](-0x8)),io['to'](getClient(_0x55128a['id'])[_0x41e960(0x32a)])[_0x41e960(0x320)]('status',{'access':{'allow':![],'reason':_0x41e960(0x39e),'token':null}});}else logger[_0x41e960(0x3a7)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x3fca49){const _0xb1d3d=_0x2c43c1,_0x43fa7c=getClient(_0x3fca49['id'])['bot'],_0x322d9e=getClient(_0x3fca49['id'])[_0xb1d3d(0x32a)];_0x3fca49['on'](_0xb1d3d(0x32c),(_0x19e52b,_0x2ee861)=>{const _0x1a1fba=_0xb1d3d;if(validateAccess(_0x2ee861,_0x322d9e)[_0x1a1fba(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x1a1fba(0x27c)]({'function':_0x1a1fba(0x236),'args':_0x19e52b});}else logger[_0x1a1fba(0x3a7)](_0x1a1fba(0x2c9));}),_0x3fca49['on'](_0xb1d3d(0x2c6),(_0x121491,_0x2b43ce)=>{const _0x543095=_0xb1d3d;if(validateAccess(_0x2b43ce,_0x322d9e)[_0x543095(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x543095(0x27c)]({'function':_0x543095(0x23d),'args':_0x121491});}else logger[_0x543095(0x3a7)](_0x543095(0x1f6));}),_0x3fca49['on'](_0xb1d3d(0x2d9),(_0x42f658,_0xa131cb)=>{const _0x1bd5ed=_0xb1d3d;if(validateAccess(_0xa131cb,_0x322d9e)[_0x1bd5ed(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c]['send']({'function':'getPortfolio','args':_0x42f658});}else logger[_0x1bd5ed(0x3a7)](_0x1bd5ed(0x298));}),_0x3fca49['on'](_0xb1d3d(0x283),(_0x3d184b,_0x451b01)=>{const _0x2d4a76=_0xb1d3d;if(validateAccess(_0x451b01,_0x322d9e)['allow']){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x2d4a76(0x27c)]({'function':_0x2d4a76(0x271),'args':_0x3d184b});}else logger[_0x2d4a76(0x3a7)](_0x2d4a76(0x216));}),_0x3fca49['on'](_0xb1d3d(0x1ef),(_0x3b1731,_0xb9e2a)=>{const _0x52531e=_0xb1d3d;if(validateAccess(_0xb9e2a,_0x322d9e)[_0x52531e(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x52531e(0x27c)]({'function':'storeHeadless','args':_0x3b1731});}else logger['full'](_0x52531e(0x332));}),_0x3fca49['on'](_0xb1d3d(0x1bb),(_0x460cd3,_0x4d71e7)=>{const _0x5a2bbb=_0xb1d3d;if(validateAccess(_0x4d71e7,_0x322d9e)[_0x5a2bbb(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c]['send']({'function':_0x5a2bbb(0x242),'args':_0x460cd3});}else logger[_0x5a2bbb(0x3a7)](_0x5a2bbb(0x390));}),_0x3fca49['on'](_0xb1d3d(0x297),_0x12cb15=>{const _0x4bfa46=_0xb1d3d;if(validateAccess(_0x12cb15,_0x322d9e)[_0x4bfa46(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x4bfa46(0x27c)]({'function':_0x4bfa46(0x2eb),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x3fca49['on'](_0xb1d3d(0x381),_0x5bb322=>{const _0x1459f2=_0xb1d3d;if(validateAccess(_0x5bb322,_0x322d9e)[_0x1459f2(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x1459f2(0x27c)]({'function':_0x1459f2(0x1a5),'args':null});}else logger[_0x1459f2(0x3a7)](_0x1459f2(0x23c));}),_0x3fca49['on'](_0xb1d3d(0x389),(_0x1221b4,_0x16ce46)=>{const _0x5aad06=_0xb1d3d;if(validateAccess(_0x16ce46,_0x322d9e)[_0x5aad06(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c]['send']({'function':_0x5aad06(0x1cc),'args':_0x1221b4});}else logger[_0x5aad06(0x3a7)](_0x5aad06(0x28f));}),_0x3fca49['on'](_0xb1d3d(0x1da),_0x56e0b6=>{const _0x45ee8d=_0xb1d3d;if(validateAccess(_0x56e0b6,_0x322d9e)[_0x45ee8d(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x45ee8d(0x27c)]({'function':_0x45ee8d(0x2f3),'args':null});}else logger[_0x45ee8d(0x3a7)](_0x45ee8d(0x315));}),_0x3fca49['on'](_0xb1d3d(0x267),_0x3ec081=>{const _0x148620=_0xb1d3d;if(validateAccess(_0x3ec081,_0x322d9e)[_0x148620(0x3aa)]){if(pid[_0x43fa7c])pid[_0x43fa7c][_0x148620(0x27c)]({'function':_0x148620(0x292),'args':null});}else logger[_0x148620(0x3a7)](_0x148620(0x1ad));}),_0x3fca49['on'](_0xb1d3d(0x258),_0x54ccf4=>{const _0x276361=_0xb1d3d;if(validateAccess(_0x54ccf4,_0x322d9e)[_0x276361(0x3aa)])updateBB(_0x276361(0x362));else logger[_0x276361(0x3a7)](_0x276361(0x1ee));}),_0x3fca49['on'](_0xb1d3d(0x1f3),_0x33e67e=>{const _0x2c66d9=_0xb1d3d;if(validateAccess(_0x33e67e,_0x322d9e)[_0x2c66d9(0x3aa)])getMessages();else logger[_0x2c66d9(0x3a7)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3fca49['on']('confirm-message',(_0x507211,_0x34a834)=>{const _0x32bc56=_0xb1d3d;if(validateAccess(_0x34a834,_0x322d9e)[_0x32bc56(0x3aa)])confirmMessage(_0x507211);else logger[_0x32bc56(0x3a7)](_0x32bc56(0x2dd));}),_0x3fca49['on']('logout',_0x434887=>{const _0x16adbc=_0xb1d3d;if(validateAccess(_0x434887,_0x322d9e)['allow']){if(devices[_0x322d9e][_0x16adbc(0x295)])clearTimeout(devices[_0x322d9e][_0x16adbc(0x295)]);if(devices[_0x322d9e][_0x16adbc(0x39a)])clearTimeout(devices[_0x322d9e][_0x16adbc(0x39a)]);removeSocketListeners(getClient(_0x3fca49['id'])[_0x16adbc(0x32a)]),addBlacklist(_0x322d9e),devices[_0x322d9e][_0x16adbc(0x366)]=null,devices[_0x322d9e][_0x16adbc(0x251)]=null,devices[_0x322d9e][_0x16adbc(0x2fe)][_0x16adbc(0x37e)]=null,logger['debug'](_0x16adbc(0x3a6)+_0x322d9e[_0x16adbc(0x319)](-0x8)),io['to'](getClient(_0x3fca49['id'])[_0x16adbc(0x32a)])['emit'](_0x16adbc(0x24d),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x16adbc(0x3a7)](_0x16adbc(0x318));});}function removeSocketListeners(_0x53ce82){const _0x1ef6e2=_0x2c43c1;getClientsWithUuid(_0x53ce82)[_0x1ef6e2(0x2a5)](_0x3ea10d=>{const _0x57e6a1=_0x1ef6e2;getSocket(_0x3ea10d['id'])[_0x57e6a1(0x1cf)]();});}function cleanSettings(){const _0x48d9d9=_0x2c43c1;let _0x5db4b5=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x5db4b5={..._0x5db4b5,'telegramToken':'************'}),settings[_0x48d9d9(0x2d7)]&&settings['bbPassword']!=''&&(_0x5db4b5={..._0x5db4b5,'bbPassword':_0x48d9d9(0x1b7)}),(settings[_0x48d9d9(0x2d7)]&&settings[_0x48d9d9(0x2d7)]==_0x48d9d9(0x1c3)||settings[_0x48d9d9(0x31e)]&&settings['telegramToken']==_0x48d9d9(0x1c3))&&(_0x5db4b5={..._0x5db4b5,'restored':{'password':settings[_0x48d9d9(0x2d7)]==_0x48d9d9(0x1c3),'telegram':settings[_0x48d9d9(0x31e)]==_0x48d9d9(0x1c3)}}),_0x5db4b5;}async function updateBB(_0x1e6f14){const _0x557e8f=_0x2c43c1;await backupConfigFiles(),installingUpdate=!![],config[_0x557e8f(0x2a5)](_0x199c52=>{restartBot(_0x199c52['botID']);});if(_0x1e6f14==_0x557e8f(0x362))process['send']({'update':!![],'environment':environment},_0x2b1a77=>{});else _0x1e6f14=='reinstall'&&process[_0x557e8f(0x27c)]({'reinstall':!![],'environment':environment},_0x3cfdc6=>{});}function startBot(_0x181de3,_0x524cb6,_0x482443){const _0x43a788=_0x2c43c1;if(debugging)_0x181de3[_0x43a788(0x26e)]('-d');let _0x444147=![];const _0x495860=_0x181de3[0x0];_0x524cb6={..._0x524cb6,'stdio':[_0x43a788(0x233),'inherit',_0x43a788(0x233),'ipc']},pid[_0x495860]=childProcess[_0x43a788(0x374)](botfile,_0x181de3,_0x524cb6),pid[_0x495860]['on'](_0x43a788(0x1db),_0x505ced=>{const _0x1edf5e=_0x43a788;switch(Object[_0x1edf5e(0x36f)](_0x505ced)[0x0]){case _0x1edf5e(0x32f):updateBotName(_0x495860,_0x505ced['botname']);break;case _0x1edf5e(0x1c4):updateBotManager();break;case _0x1edf5e(0x24d):updateStatus(_0x495860,_0x505ced[_0x1edf5e(0x24d)]);break;case'live':updateLive(_0x495860,_0x505ced[_0x1edf5e(0x343)]);break;case'started':updateLive(_0x495860,_0x505ced['started']),io['to'](_0x495860)[_0x1edf5e(0x320)](_0x1edf5e(0x24d),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x1edf5e(0x2d0):_0x505ced['stop']==_0x1edf5e(0x1fa)&&restartBot(_0x495860);_0x505ced[_0x1edf5e(0x2d0)]==_0x1edf5e(0x1fe)&&toggleBot(_0x495860,_0x1edf5e(0x1bd),'stopped');break;case _0x1edf5e(0x2db):sendTelegramBot(_0x495860,_0x505ced[_0x1edf5e(0x2db)]);break;case'telegrammsg':sendTelegramMsg(_0x505ced[_0x1edf5e(0x22c)]);break;case _0x1edf5e(0x250):io['to'](_0x495860)['emit'](_0x505ced[_0x1edf5e(0x250)],_0x505ced[_0x1edf5e(0x328)]);break;}}),pid[_0x495860]['on']('error',function(_0x4d9ecb){if(_0x444147)return;_0x444147=!![],_0x482443(_0x4d9ecb);}),pid[_0x495860]['on'](_0x43a788(0x317),async function(_0xb1bee){const _0x597ce5=_0x43a788;if(terminating)return;if(installingUpdate){logger[_0x597ce5(0x2af)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io['close']();return;}if(_0x444147)return;_0x444147=!![],_0x482443(null);const _0x3fc000=dbConfig['get'](_0x597ce5(0x1be))['find']({'botID':_0x495860})['value']();_0x3fc000&&(_0x3fc000[_0x597ce5(0x24d)]==_0x597ce5(0x36d)||_0x3fc000['status']==_0x597ce5(0x1c8))&&(await sleep(0x3e8),updateLive(_0x495860,_0x597ce5(0x2a9)),logger[_0x597ce5(0x3a7)](_0x597ce5(0x300)+_0x495860),startBot([_0x495860,userID],{'cwd':bbpath},function(_0x508c60){const _0x1ccf81=_0x597ce5;if(_0x508c60)logger[_0x1ccf81(0x3a7)](_0x508c60);}));});}function stopBot(_0xe3268e){const _0x191112=_0x2c43c1;getClientsWithBotID(_0xe3268e)[_0x191112(0x2a5)](_0x21ad7d=>{getSocket(_0x21ad7d['id'])['disconnect'](!![]),removeClient(_0x21ad7d['id']);}),pid[_0xe3268e]&&(pid[_0xe3268e][_0x191112(0x1fe)](),pid[_0xe3268e]=null);}function stopAllBots(){const _0x7e72f=_0x2c43c1;terminating=!![];const _0x394e87=getEnabledBots();_0x394e87[_0x7e72f(0x2a5)](_0x26a839=>{stopBot(_0x26a839['botID']);});}function restartBot(_0x333b71){const _0x3cd030=_0x2c43c1;if(pid[_0x333b71])pid[_0x333b71][_0x3cd030(0x1fe)]();}function addBot(){const _0x506f21=_0x2c43c1;let _0x3b0ced;for(let _0x1bfebe=0x1;_0x1bfebe<0x3e9;_0x1bfebe++){_0x3b0ced=_0x1bfebe[_0x506f21(0x253)]()[_0x506f21(0x2d3)](0x3,'0');let _0x3a4f65=config[_0x506f21(0x2b5)](_0x334089=>_0x334089[_0x506f21(0x324)]==_0x3b0ced);if(!_0x3a4f65)break;}if(_0x3b0ced===_0x506f21(0x2b9)){logger[_0x506f21(0x3a7)](_0x506f21(0x22a));return;}logger[_0x506f21(0x3a7)](_0x506f21(0x2c3)+_0x3b0ced),dbConfig['get'](_0x506f21(0x1be))[_0x506f21(0x26e)]({'botID':_0x3b0ced,'botname':_0x506f21(0x24c)+_0x3b0ced,'status':_0x506f21(0x1c8),'live':''})[_0x506f21(0x224)](),startBot([_0x3b0ced,userID],{'cwd':bbpath},function(_0x4ad7a1){const _0x27158f=_0x506f21;if(_0x4ad7a1)logger[_0x27158f(0x3a7)](_0x4ad7a1);}),config=getConfiguration(),io['to'](_0x506f21(0x1e1))[_0x506f21(0x320)](_0x506f21(0x1be),config),broadcastToBots(_0x506f21(0x1be),JSON[_0x506f21(0x294)](config));}function deleteBot(_0xfe9e02){const _0x45f2e8=_0x2c43c1;getClientsWithBotID(_0xfe9e02)[_0x45f2e8(0x2a5)](_0x10a8ca=>{const _0x54d41d=_0x45f2e8;getSocket(_0x10a8ca['id'])[_0x54d41d(0x32d)](!![]),removeClient(_0x10a8ca['id']);}),dbConfig[_0x45f2e8(0x1d9)](_0x45f2e8(0x1be))['remove']({'botID':_0xfe9e02})[_0x45f2e8(0x224)](),logger[_0x45f2e8(0x3a7)](_0x45f2e8(0x33c)+_0xfe9e02),stopBot(_0xfe9e02);try{if(fs[_0x45f2e8(0x376)](path[_0x45f2e8(0x2b3)](configpath,'bot-'+_0xfe9e02+'-config.json')))fs['unlinkSync'](path[_0x45f2e8(0x2b3)](configpath,_0x45f2e8(0x21e)+_0xfe9e02+_0x45f2e8(0x20e)));if(fs[_0x45f2e8(0x376)](path[_0x45f2e8(0x2b3)](configpath,_0x45f2e8(0x21e)+_0xfe9e02+_0x45f2e8(0x356))))fs[_0x45f2e8(0x235)](path[_0x45f2e8(0x2b3)](configpath,_0x45f2e8(0x21e)+_0xfe9e02+'-events.json'));if(fs[_0x45f2e8(0x376)](path[_0x45f2e8(0x2b3)](configpath,'bot-'+_0xfe9e02+_0x45f2e8(0x207))))fs[_0x45f2e8(0x235)](path[_0x45f2e8(0x2b3)](configpath,_0x45f2e8(0x21e)+_0xfe9e02+'-performance.json'));if(fs[_0x45f2e8(0x376)](path[_0x45f2e8(0x2b3)](configpath,'bot-'+_0xfe9e02+_0x45f2e8(0x34b))))fs['unlinkSync'](path['join'](configpath,'bot-'+_0xfe9e02+_0x45f2e8(0x34b)));}catch(_0x5a81f0){if(_0x5a81f0)logger[_0x45f2e8(0x3a7)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x5a81f0);}config=getConfiguration(),io['to'](_0x45f2e8(0x1e1))[_0x45f2e8(0x320)](_0x45f2e8(0x1be),config),broadcastToBots(_0x45f2e8(0x1be),JSON['stringify'](config));}function toggleBot(_0x497be0,_0x436afc,_0x48dec3){const _0xd13786=_0x2c43c1;dbConfig[_0xd13786(0x1d9)](_0xd13786(0x1be))[_0xd13786(0x2b5)]({'botID':_0x497be0})[_0xd13786(0x25b)]({'status':_0x436afc})[_0xd13786(0x25b)]({'live':_0x48dec3})[_0xd13786(0x224)]();if(_0x436afc=='enabled'||_0x436afc==_0xd13786(0x1c8))logger[_0xd13786(0x3a7)](_0xd13786(0x22b)+_0x497be0),startBot([_0x497be0,userID],{'cwd':bbpath},function(_0x91b352){if(_0x91b352)logger['full'](_0x91b352);});else(_0x436afc=='disabled'||_0x436afc==_0xd13786(0x1bc))&&(logger[_0xd13786(0x3a7)](_0xd13786(0x21c)+_0x497be0),stopBot(_0x497be0));config=getConfiguration(),io['to']('botmanager')[_0xd13786(0x320)](_0xd13786(0x1be),config),broadcastToBots(_0xd13786(0x1be),JSON[_0xd13786(0x294)](config));}function toggleStatus(_0x302f3c){const _0x43d75b=_0x2c43c1;let _0x4c6c36=dbConfig[_0x43d75b(0x1d9)](_0x43d75b(0x1be))[_0x43d75b(0x2b5)]({'botID':_0x302f3c})['value'](),_0xde954f;if(_0x4c6c36[_0x43d75b(0x24d)]==='enabled')_0xde954f=_0x43d75b(0x1bd);else{if(_0x4c6c36[_0x43d75b(0x24d)]===_0x43d75b(0x1c8))_0xde954f='new-disabled';else{if(_0x4c6c36[_0x43d75b(0x24d)]==='new-disabled')_0xde954f=_0x43d75b(0x1c8);else{if(_0x4c6c36[_0x43d75b(0x24d)]==='disabled')_0xde954f=_0x43d75b(0x36d);}}}return _0xde954f;}function updateStatus(_0x1e1ef5,_0x19cd09){const _0x586231=_0x2c43c1;dbConfig[_0x586231(0x1d9)](_0x586231(0x1be))[_0x586231(0x2b5)]({'botID':_0x1e1ef5})[_0x586231(0x25b)]({'status':_0x19cd09})['write'](),config=getConfiguration(),io['to'](_0x586231(0x1e1))[_0x586231(0x320)](_0x586231(0x1be),config),broadcastToBots(_0x586231(0x1be),JSON[_0x586231(0x294)](config));}function updateLive(_0x462089,_0x1f7e61){const _0x4e5885=_0x2c43c1;dbConfig['get'](_0x4e5885(0x1be))[_0x4e5885(0x2b5)]({'botID':_0x462089})['assign']({'live':_0x1f7e61})[_0x4e5885(0x224)](),config=getConfiguration(),io['to']('botmanager')[_0x4e5885(0x320)](_0x4e5885(0x1be),config),broadcastToBots(_0x4e5885(0x1be),JSON[_0x4e5885(0x294)](config));}function updateBotName(_0x147d6d,_0x44ec8e){const _0x32a90b=_0x2c43c1;dbConfig[_0x32a90b(0x1d9)](_0x32a90b(0x1be))[_0x32a90b(0x2b5)]({'botID':_0x147d6d})[_0x32a90b(0x25b)]({'botname':_0x44ec8e})[_0x32a90b(0x224)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x32a90b(0x1be),config),broadcastToBots(_0x32a90b(0x1be),JSON[_0x32a90b(0x294)](config));}function updateBotManager(){const _0x492264=_0x2c43c1;config=getConfiguration(),io['to']('botmanager')[_0x492264(0x320)](_0x492264(0x1be),config),broadcastToBots(_0x492264(0x1be),JSON[_0x492264(0x294)](config));}function toggleBotMode(_0x4e232a){const _0x1d7e63=_0x2c43c1;if(pid[_0x4e232a])pid[_0x4e232a][_0x1d7e63(0x27c)]({'function':'toggleBotMode','args':null});else{const _0x5a8e37=configpath+_0x1d7e63(0x21e)+_0x4e232a+_0x1d7e63(0x20e),_0x118adc=fs[_0x1d7e63(0x24b)](_0x5a8e37),_0x3ba06b=JSON[_0x1d7e63(0x363)](_0x118adc),_0x2931cb=_0x3ba06b[_0x1d7e63(0x353)][0x0]['headless'];_0x3ba06b[_0x1d7e63(0x353)][0x0][_0x1d7e63(0x3a0)]=!_0x2931cb;const _0x3e8838=JSON[_0x1d7e63(0x294)](_0x3ba06b,null,0x2);fs[_0x1d7e63(0x1e0)](_0x5a8e37,_0x3e8838),config=getConfiguration(),io['to']('botmanager')['emit'](_0x1d7e63(0x1be),config),broadcastToBots(_0x1d7e63(0x1be),JSON['stringify'](config));}}function validateTelegram(_0x5868b8){const _0x46464c=_0x2c43c1;if(_0x5868b8[_0x46464c(0x38a)][_0x46464c(0x1f5)]!=settings[_0x46464c(0x2ef)]&&'@'+_0x5868b8['from'][_0x46464c(0x1f5)]!=settings[_0x46464c(0x2ef)]||_0x5868b8[_0x46464c(0x316)]['id']!=settings['telegramChatId'])return sendTelegram(_0x5868b8[_0x46464c(0x316)]['id'],_0x46464c(0x2e5),{'parse_mode':_0x46464c(0x358)}),![];return!![];}async function initTelegram(){const _0x3ac5ac=_0x2c43c1;if(tgBot)tgBot[_0x3ac5ac(0x2d0)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x3ac5ac(0x31e)]);let _0x5967ad=_0x3ac5ac(0x2bb);_0x5967ad+='\x0a',_0x5967ad+=_0x3ac5ac(0x22f),_0x5967ad+=_0x3ac5ac(0x21d),_0x5967ad+=_0x3ac5ac(0x29c),_0x5967ad+=_0x3ac5ac(0x30c),_0x5967ad+=_0x3ac5ac(0x2fb),_0x5967ad+='/off\x20-\x20stop\x20bot(s)\x0a',_0x5967ad+=_0x3ac5ac(0x36e),_0x5967ad+='/names\x20-\x20show\x20bot\x20names\x0a',_0x5967ad+=_0x3ac5ac(0x1d7),_0x5967ad+=_0x3ac5ac(0x237),_0x5967ad+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x5967ad+=_0x3ac5ac(0x1c9),_0x5967ad+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x5967ad+=_0x3ac5ac(0x204);let _0x3bd04b=_0x3ac5ac(0x305);_0x3bd04b+='\x0a',_0x3bd04b+=_0x5967ad,tgBot[_0x3ac5ac(0x261)]((_0x2a65ae,_0x1956ad)=>{const _0x30bbc1=_0x3ac5ac;logger[_0x30bbc1(0x3a9)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x30bbc1(0x2af)](_0x30bbc1(0x29e),_0x2a65ae);}),tgBot[_0x3ac5ac(0x1aa)](async(_0x217270,_0x5bb415)=>{const _0x56615f=_0x3ac5ac;if(!(!settings[_0x56615f(0x2b1)]&&_0x217270[_0x56615f(0x362)][_0x56615f(0x1db)]['text']=='/start')){if(!validateTelegram(_0x217270))return;}_0x5bb415();}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x2a6),async _0x37497c=>{const _0xf206f8=_0x3ac5ac;if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x37497c[_0xf206f8(0x316)]['id']);updateSetting(_0xf206f8(0x39f),!![]);if(!validateTelegram(_0x37497c))return;await sendTelegram(_0x37497c[_0xf206f8(0x316)]['id'],_0x3bd04b);}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x2de),async _0x1d0baa=>{const _0x1ad890=_0x3ac5ac;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1d0baa[_0x1ad890(0x316)]['id'],_0x1ad890(0x1eb));}),tgBot['command'](_0x3ac5ac(0x33e),async _0xbf8730=>{const _0x164c8f=_0x3ac5ac;await sendTelegram(_0xbf8730[_0x164c8f(0x316)]['id'],_0x164c8f(0x344)),updateSetting(_0x164c8f(0x39f),![]);}),tgBot['command']('config',async _0x1df399=>{const _0x299606=_0x3ac5ac,_0x5f0dc9=Markup[_0x299606(0x36a)]([Markup[_0x299606(0x38c)][_0x299606(0x1a7)]('Orders','config_orders'),Markup[_0x299606(0x38c)][_0x299606(0x1a7)](_0x299606(0x35f),'config_alerts'),Markup['button'][_0x299606(0x1a7)](_0x299606(0x252),_0x299606(0x2a2))]);_0x1df399[_0x299606(0x2d2)](_0x299606(0x2df),_0x5f0dc9);}),tgBot[_0x3ac5ac(0x217)](_0x3ac5ac(0x326),async _0x1c6118=>{const _0x2d5b88=_0x3ac5ac;_0x1c6118[_0x2d5b88(0x312)](),updateSetting('telegramEvents',_0x2d5b88(0x365)),updateSetting(_0x2d5b88(0x39f),!![]),await sendTelegram(_0x1c6118['chat']['id'],_0x2d5b88(0x2c0));}),tgBot['action'](_0x3ac5ac(0x22d),async _0x4224e3=>{const _0x4828fc=_0x3ac5ac;_0x4224e3[_0x4828fc(0x312)](),updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4224e3[_0x4828fc(0x316)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x3ac5ac(0x217)](_0x3ac5ac(0x2a2),async _0x383579=>{const _0x11f1de=_0x3ac5ac;_0x383579[_0x11f1de(0x312)](),updateSetting(_0x11f1de(0x299),'all'),updateSetting(_0x11f1de(0x39f),!![]),await sendTelegram(_0x383579[_0x11f1de(0x316)]['id'],_0x11f1de(0x31d));}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x24d),async _0x588232=>{const _0x3c7e56=_0x3ac5ac,_0x1dcac7=getBotsWithMode();let _0x4702d4=_0x3c7e56(0x2b4);config['forEach'](_0xf899bb=>{const _0x4319b5=_0x3c7e56,_0x5077be=_0x1dcac7['find'](_0x286a8d=>_0x286a8d[_0x4319b5(0x324)]==_0xf899bb[_0x4319b5(0x324)])[_0x4319b5(0x2c4)];_0x4702d4+=_0x4319b5(0x24c)+_0xf899bb[_0x4319b5(0x324)]+':\x20'+_0xf899bb[_0x4319b5(0x24d)]+_0x4319b5(0x247)+_0x5077be+'\x20|\x20'+_0xf899bb[_0x4319b5(0x343)]+'\x0a';}),_0x4702d4+='\x0a',_0x4702d4+=_0x3c7e56(0x334),_0x4702d4+=!settings[_0x3c7e56(0x39f)]?_0x3c7e56(0x255):_0x3c7e56(0x1d2),_0x4702d4+=settings[_0x3c7e56(0x39f)]?settings[_0x3c7e56(0x299)]==_0x3c7e56(0x2d1)?_0x3c7e56(0x20a):_0x3c7e56(0x29f)+settings['telegramEvents']+_0x3c7e56(0x309):'',await sendTelegram(_0x588232['chat']['id'],_0x4702d4,{'parse_mode':_0x3c7e56(0x358)});}),tgBot['command'](_0x3ac5ac(0x1fa),async _0x5c1cf1=>{const _0x32561d=_0x3ac5ac,_0x4e9181=getEnabledBots();if(_0x4e9181[_0x32561d(0x31c)]==0x0)await sendTelegram(_0x5c1cf1[_0x32561d(0x316)]['id'],_0x32561d(0x23b));else{if(_0x4e9181[_0x32561d(0x31c)]>0x1)_0x4e9181[_0x32561d(0x26e)]({'botID':_0x32561d(0x2d1)});let _0x48886c=[],_0x5498f7=[];const _0x477fff=_0x4e9181['length']%0x4==0x0||_0x4e9181[_0x32561d(0x31c)]%0x4==0x3||_0x4e9181[_0x32561d(0x31c)]%0x3==0x1?0x4:0x3;let _0x44ac31=0x0;_0x4e9181[_0x32561d(0x2a5)]((_0x31f33c,_0x354c41)=>{const _0x1cd51c=_0x32561d;if(_0x354c41%_0x477fff==0x0)_0x5498f7=[];_0x5498f7[_0x1cd51c(0x26e)](Markup['button'][_0x1cd51c(0x1a7)](_0x31f33c[_0x1cd51c(0x324)]==_0x1cd51c(0x2d1)?_0x1cd51c(0x35b):_0x1cd51c(0x24c)+_0x31f33c[_0x1cd51c(0x324)],_0x1cd51c(0x350)+_0x31f33c[_0x1cd51c(0x324)])),_0x354c41%_0x477fff==0x0&&(_0x48886c[_0x44ac31]=_0x5498f7,_0x44ac31++);});const _0x4bf6e0=Markup[_0x32561d(0x36a)](_0x48886c);_0x5c1cf1[_0x32561d(0x2d2)](_0x32561d(0x2cf),_0x4bf6e0);}}),tgBot['action'](/restart_(.+)/,async _0x1495c=>{const _0x458068=_0x3ac5ac,_0x1c396b=_0x1495c[_0x458068(0x266)][0x1];_0x1495c['editMessageReplyMarkup'](),_0x1c396b==_0x458068(0x2d1)?config['forEach'](_0xabe85a=>{restartBot(_0xabe85a['botID']);}):restartBot(_0x1c396b);}),tgBot[_0x3ac5ac(0x2f2)]('on',async _0x51f971=>{const _0x1fcbd6=_0x3ac5ac,_0x2d91cc=getDisabledBots();if(_0x2d91cc[_0x1fcbd6(0x31c)]==0x0)await sendTelegram(_0x51f971[_0x1fcbd6(0x316)]['id'],_0x1fcbd6(0x371));else{if(_0x2d91cc[_0x1fcbd6(0x31c)]>0x1)_0x2d91cc[_0x1fcbd6(0x26e)]({'botID':_0x1fcbd6(0x2d1)});let _0x42374c=[],_0x3ea6da=[];const _0x167731=_0x2d91cc[_0x1fcbd6(0x31c)]%0x4==0x0||_0x2d91cc[_0x1fcbd6(0x31c)]%0x4==0x3||_0x2d91cc[_0x1fcbd6(0x31c)]%0x3==0x1?0x4:0x3;let _0x1d14fc=0x0;_0x2d91cc[_0x1fcbd6(0x2a5)]((_0x32e563,_0x54a2f2)=>{const _0x499334=_0x1fcbd6;if(_0x54a2f2%_0x167731==0x0)_0x3ea6da=[];_0x3ea6da[_0x499334(0x26e)](Markup[_0x499334(0x38c)][_0x499334(0x1a7)](_0x32e563[_0x499334(0x324)]==_0x499334(0x2d1)?_0x499334(0x35b):_0x499334(0x24c)+_0x32e563[_0x499334(0x324)],_0x499334(0x1ec)+_0x32e563[_0x499334(0x324)])),_0x54a2f2%_0x167731==0x0&&(_0x42374c[_0x1d14fc]=_0x3ea6da,_0x1d14fc++);});const _0x3040a8=Markup[_0x1fcbd6(0x36a)](_0x42374c);_0x51f971[_0x1fcbd6(0x2d2)](_0x1fcbd6(0x28c),_0x3040a8);}}),tgBot[_0x3ac5ac(0x217)](/on_(.+)/,async _0x533899=>{const _0x5a5b8e=_0x3ac5ac,_0x1be6df=_0x533899['match'][0x1];_0x533899[_0x5a5b8e(0x312)]();if(_0x1be6df==_0x5a5b8e(0x2d1)){const _0x4f316d=getDisabledBots();await sendTelegram(_0x533899[_0x5a5b8e(0x316)]['id'],_0x5a5b8e(0x202)),_0x4f316d[_0x5a5b8e(0x2a5)](_0x4c5996=>{const _0x3966d8=_0x5a5b8e;if(_0x4c5996[_0x3966d8(0x324)]!='all')toggleBot(_0x4c5996['botID'],toggleStatus(_0x4c5996[_0x3966d8(0x324)]),'stopped');});}else await sendTelegram(_0x533899[_0x5a5b8e(0x316)]['id'],_0x5a5b8e(0x249)+_0x1be6df),toggleBot(_0x1be6df,toggleStatus(_0x1be6df),_0x5a5b8e(0x2a9));}),tgBot['command'](_0x3ac5ac(0x38f),async _0x390ac1=>{const _0x5bdd8a=_0x3ac5ac,_0x459902=getEnabledBots();if(_0x459902['length']==0x0)await sendTelegram(_0x390ac1[_0x5bdd8a(0x316)]['id'],_0x5bdd8a(0x23b));else{if(_0x459902[_0x5bdd8a(0x31c)]>0x1)_0x459902['push']({'botID':_0x5bdd8a(0x2d1)});let _0x42b0fb=[],_0x43d32b=[];const _0x1ab34c=_0x459902[_0x5bdd8a(0x31c)]%0x4==0x0||_0x459902['length']%0x4==0x3||_0x459902['length']%0x3==0x1?0x4:0x3;let _0x155db4=0x0;_0x459902['forEach']((_0x5949bf,_0x1d6987)=>{const _0x29773e=_0x5bdd8a;if(_0x1d6987%_0x1ab34c==0x0)_0x43d32b=[];_0x43d32b['push'](Markup[_0x29773e(0x38c)][_0x29773e(0x1a7)](_0x5949bf[_0x29773e(0x324)]=='all'?_0x29773e(0x35b):_0x29773e(0x24c)+_0x5949bf['botID'],'off_'+_0x5949bf[_0x29773e(0x324)])),_0x1d6987%_0x1ab34c==0x0&&(_0x42b0fb[_0x155db4]=_0x43d32b,_0x155db4++);});const _0x1f816b=Markup['inlineKeyboard'](_0x42b0fb);_0x390ac1[_0x5bdd8a(0x2d2)](_0x5bdd8a(0x27a),_0x1f816b);}}),tgBot[_0x3ac5ac(0x217)](/off_(.+)/,async _0x417848=>{const _0x1d7a6f=_0x3ac5ac,_0x540713=_0x417848[_0x1d7a6f(0x266)][0x1];_0x417848[_0x1d7a6f(0x312)]();if(_0x540713=='all'){const _0xe1e102=getEnabledBots();await sendTelegram(_0x417848[_0x1d7a6f(0x316)]['id'],_0x1d7a6f(0x20d)),_0xe1e102[_0x1d7a6f(0x2a5)](_0x1b3b5d=>{const _0x3ef338=_0x1d7a6f;if(_0x1b3b5d['botID']!=_0x3ef338(0x2d1))toggleBot(_0x1b3b5d[_0x3ef338(0x324)],toggleStatus(_0x1b3b5d['botID']),'stopped');});}else await sendTelegram(_0x417848[_0x1d7a6f(0x316)]['id'],_0x1d7a6f(0x240)+_0x540713),toggleBot(_0x540713,toggleStatus(_0x540713),_0x1d7a6f(0x2a9));}),tgBot[_0x3ac5ac(0x2f2)]('metrics',async _0x23c881=>{const _0x3aa5f5=_0x3ac5ac,_0x2e389b=getEnabledBots();if(_0x2e389b['length']==0x0)await sendTelegram(_0x23c881[_0x3aa5f5(0x316)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2e389b[_0x3aa5f5(0x31c)]>0x1){let _0x520a4f=[],_0xbb1c4b=[];const _0x50497f=_0x2e389b[_0x3aa5f5(0x31c)]%0x4==0x0||_0x2e389b[_0x3aa5f5(0x31c)]%0x4==0x3||_0x2e389b['length']%0x3==0x1?0x4:0x3;let _0x3ec8d9=0x0;_0x2e389b[_0x3aa5f5(0x2a5)]((_0x3d0f60,_0x410f45)=>{const _0x5e0ff7=_0x3aa5f5;if(_0x410f45%_0x50497f==0x0)_0xbb1c4b=[];_0xbb1c4b[_0x5e0ff7(0x26e)](Markup[_0x5e0ff7(0x38c)][_0x5e0ff7(0x1a7)](_0x5e0ff7(0x24c)+_0x3d0f60[_0x5e0ff7(0x324)],_0x5e0ff7(0x1ab)+_0x3d0f60[_0x5e0ff7(0x324)])),_0x410f45%_0x50497f==0x0&&(_0x520a4f[_0x3ec8d9]=_0xbb1c4b,_0x3ec8d9++);});const _0x31f452=Markup[_0x3aa5f5(0x36a)](_0x520a4f);_0x23c881[_0x3aa5f5(0x2d2)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x31f452);}else{const _0x21a036=_0x2e389b[0x0]['botID'];if(pid[_0x21a036])pid[_0x21a036][_0x3aa5f5(0x27c)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x3ac5ac(0x217)](/metrics_(.+)/,async _0x26882d=>{const _0x348d94=_0x3ac5ac,_0x21e7b3=_0x26882d[_0x348d94(0x266)][0x1];_0x26882d[_0x348d94(0x312)]();if(pid[_0x21e7b3])pid[_0x21e7b3][_0x348d94(0x27c)]({'function':_0x348d94(0x380),'args':null});}),tgBot[_0x3ac5ac(0x2f2)]('portfolio',async _0x505373=>{const _0x309b6e=_0x3ac5ac,_0x3b174a=getEnabledBots();if(_0x3b174a[_0x309b6e(0x31c)]==0x0)await sendTelegram(_0x505373[_0x309b6e(0x316)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3b174a[_0x309b6e(0x31c)]>0x1){let _0x12623f=[],_0x1b6b66=[];const _0x38a0d2=_0x3b174a[_0x309b6e(0x31c)]%0x4==0x0||_0x3b174a[_0x309b6e(0x31c)]%0x4==0x3||_0x3b174a[_0x309b6e(0x31c)]%0x3==0x1?0x4:0x3;let _0xece9c=0x0;_0x3b174a[_0x309b6e(0x2a5)]((_0x5ec6b1,_0x157f23)=>{const _0x5dba67=_0x309b6e;if(_0x157f23%_0x38a0d2==0x0)_0x1b6b66=[];_0x1b6b66[_0x5dba67(0x26e)](Markup[_0x5dba67(0x38c)][_0x5dba67(0x1a7)](_0x5dba67(0x24c)+_0x5ec6b1[_0x5dba67(0x324)],_0x5dba67(0x1bf)+_0x5ec6b1['botID'])),_0x157f23%_0x38a0d2==0x0&&(_0x12623f[_0xece9c]=_0x1b6b66,_0xece9c++);});const _0x3ddd7b=Markup[_0x309b6e(0x36a)](_0x12623f);_0x505373[_0x309b6e(0x2d2)](_0x309b6e(0x379),_0x3ddd7b);}else{const _0x40ebc7=_0x3b174a[0x0]['botID'];if(pid[_0x40ebc7])pid[_0x40ebc7][_0x309b6e(0x27c)]({'function':_0x309b6e(0x35c),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x4b38a0=>{const _0x22dff2=_0x3ac5ac,_0x43a4f1=_0x4b38a0[_0x22dff2(0x266)][0x1];_0x4b38a0['editMessageReplyMarkup']();if(pid[_0x43a4f1])pid[_0x43a4f1][_0x22dff2(0x27c)]({'function':_0x22dff2(0x35c),'args':null});}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x362),async _0x194b2f=>{const _0x1b3c8b=_0x3ac5ac;await getMessages();if(!updateAvailable)await sendTelegram(_0x194b2f['chat']['id'],_0x1b3c8b(0x1b9));else{if(!validInstallation)await sendTelegram(_0x194b2f['chat']['id'],_0x1b3c8b(0x280));else{const _0x2948fb=Markup['inlineKeyboard']([Markup[_0x1b3c8b(0x38c)]['callback']('Yes',_0x1b3c8b(0x307)),Markup['button'][_0x1b3c8b(0x1a7)]('No',_0x1b3c8b(0x1df))]);_0x194b2f['reply'](_0x1b3c8b(0x2da),_0x2948fb);}}}),tgBot[_0x3ac5ac(0x217)](/update_(.+)/,async _0x4338d2=>{const _0x377729=_0x3ac5ac,_0x123fca=_0x4338d2[_0x377729(0x266)][0x1];_0x4338d2[_0x377729(0x312)](),_0x123fca=='yes'&&(await sendTelegram(_0x4338d2['chat']['id'],_0x377729(0x274)),updateBB(_0x377729(0x362))),_0x123fca=='no'&&await sendTelegram(_0x4338d2['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x2cc),async _0x1afa27=>{const _0x2f46be=_0x3ac5ac;if(!validInstallation)await sendTelegram(_0x1afa27[_0x2f46be(0x316)]['id'],_0x2f46be(0x339));else{const _0x37fe05=Markup['inlineKeyboard']([Markup[_0x2f46be(0x38c)][_0x2f46be(0x1a7)](_0x2f46be(0x256),'reinstall_yes'),Markup[_0x2f46be(0x38c)]['callback']('No',_0x2f46be(0x2ba))]);_0x1afa27[_0x2f46be(0x2d2)](_0x2f46be(0x273),_0x37fe05);}}),tgBot[_0x3ac5ac(0x217)](/reinstall_(.+)/,async _0x3193ad=>{const _0x5a4870=_0x3ac5ac,_0x537ce7=_0x3193ad[_0x5a4870(0x266)][0x1];_0x3193ad[_0x5a4870(0x312)](),_0x537ce7==_0x5a4870(0x2b6)&&(await sendTelegram(_0x3193ad['chat']['id'],_0x5a4870(0x218)),updateBB(_0x5a4870(0x2cc))),_0x537ce7=='no'&&await sendTelegram(_0x3193ad[_0x5a4870(0x316)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x20f),async _0x14f4da=>{const _0x363fa3=_0x3ac5ac,_0xf638c2=getBotsWithMode();if(_0xf638c2[_0x363fa3(0x31c)]==0x0)await sendTelegram(_0x14f4da[_0x363fa3(0x316)]['id'],_0x363fa3(0x23b));else{let _0x389ea7=[],_0x1aecfd=[];const _0x3466fd=0x2;let _0x1b6e2c=0x0;_0xf638c2[_0x363fa3(0x2a5)]((_0x4f67df,_0x198201)=>{const _0x41eee9=_0x363fa3;if(_0x198201%_0x3466fd==0x0)_0x1aecfd=[];_0x1aecfd[_0x41eee9(0x26e)](Markup['button'][_0x41eee9(0x1a7)](_0x41eee9(0x24c)+_0x4f67df['botID']+'\x20('+_0x4f67df['mode']+')',_0x41eee9(0x27f)+_0x4f67df[_0x41eee9(0x324)])),_0x198201%_0x3466fd==0x0&&(_0x389ea7[_0x1b6e2c]=_0x1aecfd,_0x1b6e2c++);});const _0x3471e8=Markup['inlineKeyboard'](_0x389ea7);_0x14f4da[_0x363fa3(0x2d2)](_0x363fa3(0x1a8),_0x3471e8);}}),tgBot[_0x3ac5ac(0x217)](/toggle_(.+)/,async _0x444946=>{const _0x28a4f2=_0x3ac5ac,_0x2ed119=_0x444946['match'][0x1];_0x444946[_0x28a4f2(0x312)]();const _0x1e4049=getBotsWithMode(),_0x2ec673=_0x1e4049['find'](_0x17b906=>_0x17b906[_0x28a4f2(0x324)]==_0x2ed119),_0x122047=_0x2ec673['mode']==_0x28a4f2(0x2ff)?_0x28a4f2(0x1f7):_0x28a4f2(0x2ff);await sendTelegram(_0x444946[_0x28a4f2(0x316)]['id'],_0x28a4f2(0x2c5)+_0x2ed119+_0x28a4f2(0x231)+_0x122047+_0x28a4f2(0x1e3)),toggleBotMode(_0x2ed119);}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x205),async _0x1154d5=>{const _0x31dbd3=_0x3ac5ac;let _0xa4f9c5='';config[_0x31dbd3(0x2a5)](_0x934a6a=>{const _0x2114ed=_0x31dbd3;_0xa4f9c5+='Bot\x20'+_0x934a6a['botID']+':\x20'+_0x934a6a[_0x2114ed(0x32f)]+'\x0a';}),await sendTelegram(_0x1154d5[_0x31dbd3(0x316)]['id'],_0xa4f9c5,{'parse_mode':_0x31dbd3(0x358)});}),tgBot[_0x3ac5ac(0x2f2)](_0x3ac5ac(0x1a6),async _0x55d759=>{await sendTelegram(_0x55d759['chat']['id'],_0x5967ad);}),process[_0x3ac5ac(0x1d1)]('SIGINT',()=>tgBot[_0x3ac5ac(0x2d0)]('SIGINT')),process[_0x3ac5ac(0x1d1)](_0x3ac5ac(0x2ad),()=>tgBot[_0x3ac5ac(0x2d0)](_0x3ac5ac(0x2ad))),tgBot[_0x3ac5ac(0x38e)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x31719e,_0x4b2b29,_0x347242){const _0x2e89a2=_0x2c43c1;_0x347242={..._0x347242,'disable_web_page_preview':!![]};try{await tgBot[_0x2e89a2(0x2db)][_0x2e89a2(0x239)](_0x31719e,_0x4b2b29,_0x347242);}catch(_0x5d6c28){console[_0x2e89a2(0x286)](_0x2e89a2(0x208),_0x5d6c28);}}async function sendTelegramBot(_0x3f1660,_0x33a8db){const _0x3ea027=_0x2c43c1;if(settings['telegramEnabled']){if(settings[_0x3ea027(0x299)]=='all'||(_0x33a8db[_0x3ea027(0x25e)]==_0x3ea027(0x222)||_0x33a8db[_0x3ea027(0x25e)]==_0x3ea027(0x35e)||_0x33a8db[_0x3ea027(0x25e)]==_0x3ea027(0x1ea))&&settings['telegramEvents']==_0x3ea027(0x355)||_0x33a8db[_0x3ea027(0x25e)]==_0x3ea027(0x306)&&settings[_0x3ea027(0x299)]==_0x3ea027(0x365)){if(tgBot&&settings[_0x3ea027(0x2b1)]){if(_0x33a8db[_0x3ea027(0x385)])await sendTelegram(settings['telegramChatId'],_0x33a8db[_0x3ea027(0x32f)]+_0x3ea027(0x209)+_0x33a8db[_0x3ea027(0x394)]);else await sendTelegram(settings['telegramChatId'],_0x3ea027(0x24c)+_0x3f1660+'\x20>\x20'+_0x33a8db[_0x3ea027(0x394)]);}}}}async function sendTelegramMsg(_0x37a0f3,_0x2e9092='HTML'){const _0x189658=_0x2c43c1;return settings[_0x189658(0x39f)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x37a0f3,{'parse_mode':_0x2e9092}),!![]):![];}function getDeviceWithIp(_0x9f6f7b){const _0x52bd3e=_0x2c43c1;return devices[_0x52bd3e(0x2b5)](_0x8085d3=>_0x8085d3['ip']===_0x9f6f7b);}async function temporaryAccess2FA(_0x2d1838,_0x5117ca){const _0x4aa3b9=_0x2c43c1;let _0x304f78=new Date(),_0x3343e3=![];if(lastIpApproval){if(_0x304f78-lastIpApproval<0x1388)_0x3343e3=!![];}lastIpApproval=new Date();if(_0x3343e3)return;if(tgBot&&settings[_0x4aa3b9(0x2b1)]){const _0x4ac5e6=uuidRandom();tmpStorage[_0x4ac5e6]={'uuid':_0x2d1838,'externalip':_0x5117ca};const _0x59697a=Markup[_0x4aa3b9(0x36a)]([Markup[_0x4aa3b9(0x38c)][_0x4aa3b9(0x1a7)]('5\x20min','tempaccess_5_'+_0x4ac5e6),Markup[_0x4aa3b9(0x38c)]['callback'](_0x4aa3b9(0x1e5),_0x4aa3b9(0x2bf)+_0x4ac5e6),Markup[_0x4aa3b9(0x38c)]['callback']('30\x20min',_0x4aa3b9(0x25f)+_0x4ac5e6),Markup[_0x4aa3b9(0x38c)][_0x4aa3b9(0x1a7)]('reject',_0x4aa3b9(0x264)+_0x4ac5e6)]);await sendTelegram(settings[_0x4aa3b9(0x2b1)],_0x4aa3b9(0x30a)+normalizeIP(_0x5117ca)[_0x4aa3b9(0x21a)]+'\x20?',_0x59697a),tgBot[_0x4aa3b9(0x217)](/tempaccess_(.+)_(.+)/,async _0x1722fb=>{const _0x449d6d=_0x4aa3b9,_0x2f0f65=_0x1722fb[_0x449d6d(0x266)][0x1],_0x2fe7a3=_0x1722fb[_0x449d6d(0x266)][0x2],{uuid:_0xca9af6,externalip:_0x3201de}=tmpStorage[_0x2fe7a3];delete tmpStorage[_0x2fe7a3],_0x1722fb[_0x449d6d(0x312)](),devices[_0xca9af6][_0x449d6d(0x366)]={'clientip':_0x3201de,'timestamp':new Date()[_0x449d6d(0x333)](),'expiry':_0x2f0f65},_0x2f0f65!='reject'?(await sendTelegram(_0x1722fb['chat']['id'],_0x449d6d(0x2f6)+_0x2f0f65+'\x20minutes',{'parse_mode':_0x449d6d(0x358)}),io['to'](_0xca9af6)['emit'](_0x449d6d(0x24d),{'access':{'allow':![],'reason':_0x449d6d(0x335),'token':null}})):(await sendTelegram(_0x1722fb[_0x449d6d(0x316)]['id'],_0x449d6d(0x229)),io['to'](_0xca9af6)[_0x449d6d(0x320)]('status',{'access':{'allow':![],'reason':_0x449d6d(0x357),'token':null}}));});}}async function loginAccess2FA(_0x4d7ba6,_0x510afa){const _0x1f3e72=_0x2c43c1;if(tgBot&&settings['telegramChatId']){const _0x5200cb=uuidRandom();tmpStorage[_0x5200cb]={'uuid':_0x4d7ba6,'externalip':_0x510afa};const _0xbd832e=Markup[_0x1f3e72(0x36a)]([Markup['button'][_0x1f3e72(0x1a7)](_0x1f3e72(0x367),_0x1f3e72(0x27b)+loginExpiry+'_'+_0x5200cb),Markup[_0x1f3e72(0x38c)][_0x1f3e72(0x1a7)](_0x1f3e72(0x1fb),_0x1f3e72(0x1d4)+_0x5200cb)]);await sendTelegram(settings[_0x1f3e72(0x2b1)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x510afa)[_0x1f3e72(0x21a)]+'\x20?',_0xbd832e),tgBot[_0x1f3e72(0x217)](/login2fa_(.+)_(.+)/,async _0x214aca=>{const _0x49ada2=_0x1f3e72,_0x345dd4=_0x214aca[_0x49ada2(0x266)][0x1],_0xa0988f=_0x214aca[_0x49ada2(0x266)][0x2],{uuid:_0xf1f997,externalip:_0x5c21e8}=tmpStorage[_0xa0988f];delete tmpStorage[_0xa0988f],_0x214aca[_0x49ada2(0x312)](),devices[_0xf1f997][_0x49ada2(0x251)]={'clientip':_0x5c21e8,'timestamp':new Date()['getTime'](),'expiry':_0x345dd4},_0x345dd4!='reject'?(await sendTelegram(_0x214aca[_0x49ada2(0x316)]['id'],_0x49ada2(0x351),{'parse_mode':'HTML'}),io['to'](_0xf1f997)[_0x49ada2(0x320)]('status',{'access':{'allow':![],'reason':_0x49ada2(0x335),'token':null}})):(await sendTelegram(_0x214aca['chat']['id'],'Login\x20rejected'),io['to'](_0xf1f997)[_0x49ada2(0x320)](_0x49ada2(0x24d),{'access':{'allow':![],'reason':_0x49ada2(0x25d),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1cb55c=_0x2c43c1;return dbConfig['get']('bots')[_0x1cb55c(0x245)](_0x1cb55c(0x324))[_0x1cb55c(0x2be)]({'status':_0x1cb55c(0x36d)})['value']()||[];}function getDisabledBots(){const _0x48a7eb=_0x2c43c1;return dbConfig[_0x48a7eb(0x1d9)]('bots')[_0x48a7eb(0x245)](_0x48a7eb(0x324))['filter']({'status':_0x48a7eb(0x1bd)})[_0x48a7eb(0x2d6)]()||[];}function getBotAttributes(_0x54051d){const _0x1d1406=_0x2c43c1;let _0x5ddc35={};const _0x40dca9=configpath+_0x1d1406(0x21e)+_0x54051d+_0x1d1406(0x20e),_0x3d175c=fs[_0x1d1406(0x376)](_0x40dca9);if(_0x3d175c){const _0x45ceff=fs['readFileSync'](_0x40dca9);try{const _0x43556e=JSON[_0x1d1406(0x363)](_0x45ceff),_0x19fd57=_0x43556e?_0x43556e[_0x1d1406(0x353)][0x0][_0x1d1406(0x3a0)]:![];_0x5ddc35['mode']=_0x19fd57?_0x1d1406(0x2ff):'manual',_0x5ddc35[_0x1d1406(0x32f)]=_0x43556e?_0x43556e[_0x1d1406(0x353)][0x0]['botname']:_0x1d1406(0x24c)+_0x54051d;}catch(_0xfb27a3){_0x5ddc35[_0x1d1406(0x2c4)]=_0x1d1406(0x1f7),_0x5ddc35['botname']=_0x1d1406(0x24c)+_0x54051d;}}else _0x5ddc35[_0x1d1406(0x2c4)]='manual',_0x5ddc35[_0x1d1406(0x32f)]=_0x1d1406(0x24c)+_0x54051d;return _0x5ddc35;}function getBotsWithMode(){const _0x27ba09=_0x2c43c1,_0x4790ad=dbConfig[_0x27ba09(0x1d9)](_0x27ba09(0x1be))[_0x27ba09(0x245)]('botID')['value']()||[];return _0x4790ad['forEach'](_0x5747a1=>{const _0x5c3b27=_0x27ba09;let _0x2821c1=getBotAttributes(_0x5747a1[_0x5c3b27(0x324)]);_0x5747a1[_0x5c3b27(0x2c4)]=_0x2821c1[_0x5c3b27(0x2c4)];}),_0x4790ad;}function getBotExchanges(){const _0x1c9dc2=_0x2c43c1;let _0x885a5e=[];const _0x1df1cf=dbConfig[_0x1c9dc2(0x1d9)](_0x1c9dc2(0x1be))[_0x1c9dc2(0x245)](_0x1c9dc2(0x324))[_0x1c9dc2(0x2d6)]()||[];_0x1df1cf[_0x1c9dc2(0x2a5)](_0x38d78d=>{const _0x10e8fd=_0x1c9dc2;if(_0x38d78d[_0x10e8fd(0x24d)]==_0x10e8fd(0x36d)){const _0x9d394=configpath+_0x10e8fd(0x21e)+_0x38d78d[_0x10e8fd(0x324)]+_0x10e8fd(0x20e),_0x23e084=fs[_0x10e8fd(0x376)](_0x9d394);let _0x408c3b;if(_0x23e084){const _0x545f82=fs[_0x10e8fd(0x24b)](_0x9d394);try{const _0x3bccfa=JSON[_0x10e8fd(0x363)](_0x545f82);_0x408c3b=_0x3bccfa?_0x3bccfa[_0x10e8fd(0x353)][0x0][_0x10e8fd(0x1fd)]:null;}catch(_0x1643bc){}}if(_0x408c3b)_0x885a5e['push'](_0x408c3b);}});const _0xb0f4a2=[...new Set(_0x885a5e)][_0x1c9dc2(0x340)]();return _0xb0f4a2;}async function initUser(){const _0x2a91cf=_0x2c43c1;if(!settings[_0x2a91cf(0x33b)]){const _0xcc00d=uuidRandom();mixpanel[_0x2a91cf(0x368)](_0xcc00d),updateSetting(_0x2a91cf(0x33b),_0xcc00d);}}async function initSecure(){const _0x3aa3a6=_0x2c43c1;let _0x48cc88=getSecure();if(!_0x48cc88[_0x3aa3a6(0x215)](_0x3aa3a6(0x2a7))){let _0x34c781=await generateKeys();_0x48cc88['publicKey']=_0x34c781[_0x3aa3a6(0x2e8)],_0x48cc88[_0x3aa3a6(0x375)]=_0x34c781['privateKey'],_0x48cc88[_0x3aa3a6(0x2a7)]=crypto[_0x3aa3a6(0x290)](0x20)[_0x3aa3a6(0x253)](_0x3aa3a6(0x2a4));;storeSecure(_0x48cc88);}}function getSettings(){const _0x6a1fde=_0x2c43c1;return dbSettings[_0x6a1fde(0x1d9)](_0x6a1fde(0x37f))[_0x6a1fde(0x2d6)]()||{};}function getSecure(){const _0x1fb902=_0x2c43c1;return dbSecure[_0x1fb902(0x1d9)](_0x1fb902(0x203))[_0x1fb902(0x2d6)]()||{};}function getBlacklist(){const _0x2112d6=_0x2c43c1;return dbSecure[_0x2112d6(0x1d9)](_0x2112d6(0x206))['value']()||[];}function broadcastToBots(_0x1f6554,_0x4fa603){const _0x45dc6c=_0x2c43c1;config[_0x45dc6c(0x2a5)](_0x3568f1=>{const _0x536a6a=_0x45dc6c;if(_0x3568f1[_0x536a6a(0x24d)]==_0x536a6a(0x36d)&&_0x3568f1['live']=='running'||_0x3568f1[_0x536a6a(0x24d)]=='new'&&_0x3568f1['live']==_0x536a6a(0x1f1)){if(pid[_0x3568f1['botID']])pid[_0x3568f1[_0x536a6a(0x324)]][_0x536a6a(0x27c)]({[_0x1f6554]:_0x4fa603});}});}function storeSettings(_0xcbccbf,_0x51b798=![]){const _0x255017=_0x2c43c1;_0xcbccbf={...settings,..._0xcbccbf};if(_0x51b798&&_0xcbccbf['bbPassword']!=_0x255017(0x1b7)&&_0xcbccbf[_0x255017(0x2d7)]!=_0x255017(0x1c3)&&_0xcbccbf[_0x255017(0x2d7)]!=''){const _0x5c5f64=crypt[_0x255017(0x314)](secure['privateKey'],_0xcbccbf['bbPassword'])[_0x255017(0x1db)][_0x255017(0x359)]('@')[0x0],_0x523d36=bcrypt['hashSync'](_0x5c5f64,saltRounds);_0xcbccbf={..._0xcbccbf,'bbPassword':_0x523d36};}if(_0x51b798&&_0xcbccbf['telegramToken']!='************'&&_0xcbccbf[_0x255017(0x31e)]!=_0x255017(0x1c3)&&_0xcbccbf[_0x255017(0x31e)]!=''){const _0x110c29=crypt[_0x255017(0x314)](secure[_0x255017(0x375)],_0xcbccbf[_0x255017(0x31e)])['message'][_0x255017(0x359)]('@')[0x0];_0xcbccbf={..._0xcbccbf,'telegramToken':_0x110c29};}const _0x5bae8f=_0xcbccbf[_0x255017(0x31e)]!=_0x255017(0x1b7)&&_0xcbccbf['telegramToken']!=settings[_0x255017(0x31e)]||_0xcbccbf[_0x255017(0x2ef)]!=settings[_0x255017(0x2ef)],_0x2219e1=_0xcbccbf[_0x255017(0x31e)]==''||_0xcbccbf[_0x255017(0x2ef)]=='';_0x5bae8f&&(_0xcbccbf[_0x255017(0x2b1)]=null,_0xcbccbf[_0x255017(0x299)]=_0x255017(0x2d1));for(const [_0x15d82b,_0x3e98a7]of Object[_0x255017(0x285)](_0xcbccbf)){if(_0x15d82b=='telegramToken'&&_0x3e98a7=='************'){_0xcbccbf['telegramToken']=settings['telegramToken'];continue;};if(_0x15d82b==_0x255017(0x2d7)&&_0x3e98a7==_0x255017(0x1b7)){_0xcbccbf[_0x255017(0x2d7)]=settings['bbPassword'];continue;};dbSettings[_0x255017(0x21f)](_0x255017(0x26a)+_0x15d82b,_0x3e98a7)[_0x255017(0x224)]();}settings=_0xcbccbf,io['to'](_0x255017(0x1e1))['emit']('settings',cleanSettings()),broadcastToBots(_0x255017(0x1b5),settings['timeshift']),broadcastToBots(_0x255017(0x2f7),settings[_0x255017(0x2f7)]);if(_0x5bae8f&&!_0x2219e1)initTelegram();if(_0x5bae8f&&_0x2219e1)disableTelegram();getAllClients()['forEach'](_0x4c8479=>{const _0x467707=_0x255017;getSocket(_0x4c8479['id'])['emit']('status',{'access':{'allow':![],'reason':_0x467707(0x335),'token':null}});});}function updateSetting(_0x4cedbb,_0x26ba81){const _0xbef3de=_0x2c43c1;dbSettings[_0xbef3de(0x21f)](_0xbef3de(0x26a)+_0x4cedbb,_0x26ba81)[_0xbef3de(0x224)](),settings=getSettings(),io['to'](_0xbef3de(0x1e1))[_0xbef3de(0x320)](_0xbef3de(0x37f),cleanSettings());}function storeSecure(_0x4d0d3a){const _0x4b7da9=_0x2c43c1;dbSecure[_0x4b7da9(0x1d9)]('secure')[_0x4b7da9(0x26e)](_0x4d0d3a)[_0x4b7da9(0x224)](),secure=_0x4d0d3a;}function addBlacklist(_0xe78e3e){const _0x473679=_0x2c43c1;cleanBlacklist();let _0x841ea7;devices[_0xe78e3e][_0x473679(0x366)]?_0x841ea7=Math['max'](devices[_0xe78e3e][_0x473679(0x366)][_0x473679(0x2ca)],loginExpiry):_0x841ea7=loginExpiry,dbSecure[_0x473679(0x1d9)](_0x473679(0x206))[_0x473679(0x26e)]({'expiry':new Date()[_0x473679(0x333)]()+_0x841ea7*0x3c*0x3e8,'token':devices[_0xe78e3e][_0x473679(0x2fe)]['token']})[_0x473679(0x224)](),blacklist=dbSecure[_0x473679(0x1d9)](_0x473679(0x206))['value']();}function cleanBlacklist(){const _0x174ead=_0x2c43c1;let _0x333cf5=dbSecure[_0x174ead(0x1d9)](_0x174ead(0x206))[_0x174ead(0x1b2)]()[_0x174ead(0x2d6)](),_0x52c88e=new Date()[_0x174ead(0x333)]();_0x333cf5[_0x174ead(0x2a5)](_0x15fbfd=>{const _0x2e71eb=_0x174ead;_0x15fbfd[_0x2e71eb(0x2ca)]<_0x52c88e&&dbSecure[_0x2e71eb(0x1d9)](_0x2e71eb(0x206))['remove']({'expiry':_0x15fbfd['expiry']})[_0x2e71eb(0x224)]();});}function initStates(){const _0x13c7e3=_0x2c43c1;let _0x159264=getConfiguration();_0x159264[_0x13c7e3(0x2a5)](_0x2f899a=>{_0x2f899a['live']='stopped';}),storeConfiguration(_0x159264);}function onKeys(){const _0x512c07=new RSA();return new Promise(_0x8b4f92=>{const _0x140e1c=_0x4fa4;_0x512c07[_0x140e1c(0x268)]()[_0x140e1c(0x393)](_0x57dcb1=>{_0x8b4f92(_0x57dcb1);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x44f287=_0x2c43c1;let _0x4eac1c=getSettings(),_0x25d207=![];!_0x4eac1c[_0x44f287(0x215)](_0x44f287(0x1de))&&(_0x4eac1c['lastmsgtelegram']=0x0,_0x25d207=!![]);!_0x4eac1c['hasOwnProperty']('lastmsgemitted')&&(_0x4eac1c[_0x44f287(0x369)]=0x0,_0x25d207=!![]);!_0x4eac1c[_0x44f287(0x215)]('latestversion')&&(_0x4eac1c[_0x44f287(0x348)]=_0x44f287(0x2fc),_0x25d207=!![]);!_0x4eac1c[_0x44f287(0x215)]('onepagemode')&&(_0x4eac1c[_0x44f287(0x2f7)]=![],_0x25d207=!![]);if(_0x25d207)storeSettings(_0x4eac1c);try{fs[_0x44f287(0x2aa)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x279bc9=>{const _0x12a43b=_0x44f287;if(!_0x279bc9['isDirectory']()){if(!_0x279bc9[_0x12a43b(0x1ba)][_0x12a43b(0x38b)]('backup-full@'))fs[_0x12a43b(0x235)](configbackuppath+_0x279bc9[_0x12a43b(0x1ba)]);}else fs[_0x12a43b(0x301)](configbackuppath+_0x279bc9[_0x12a43b(0x1ba)],{'recursive':!![]});});}catch(_0x5011a7){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x5011a7);}}function storeConfiguration(_0x5d1c90){const _0x21a250=_0x2c43c1;dbConfig['get']('bots')[_0x21a250(0x1b8)]()[_0x21a250(0x224)](),dbConfig['get'](_0x21a250(0x1be))[_0x21a250(0x26e)](..._0x5d1c90)[_0x21a250(0x224)](),config=_0x5d1c90;}async function resetPassword(){const _0x539462=_0x2c43c1;if(tgBot&&settings[_0x539462(0x2b1)]){const _0xe83fe5=Markup['inlineKeyboard']([Markup[_0x539462(0x38c)][_0x539462(0x1a7)](_0x539462(0x2b6),_0x539462(0x30f)),Markup['button'][_0x539462(0x1a7)]('no',_0x539462(0x277))]);await sendTelegram(settings[_0x539462(0x2b1)],_0x539462(0x2e6),_0xe83fe5),tgBot[_0x539462(0x217)](/resetpw_(.+)/,async _0x416560=>{const _0x4ed0c3=_0x539462,_0x4dd1de=_0x416560[_0x4ed0c3(0x266)][0x1];_0x416560[_0x4ed0c3(0x312)]();if(_0x4dd1de!='no'){const _0x56591d=0xf,_0x4682c4='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x24540b=Array[_0x4ed0c3(0x38a)](crypto[_0x4ed0c3(0x226)](new Uint32Array(_0x56591d)))[_0x4ed0c3(0x399)](_0x5825f7=>_0x4682c4[_0x5825f7%_0x4682c4['length']])[_0x4ed0c3(0x2b3)](''),_0x5f2c81=bcrypt[_0x4ed0c3(0x291)](_0x24540b,saltRounds);storeSettings({'bbPassword':_0x5f2c81}),await sendTelegram(_0x416560[_0x4ed0c3(0x316)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x24540b,{'parse_mode':_0x4ed0c3(0x358)});}else await sendTelegram(_0x416560[_0x4ed0c3(0x316)]['id'],_0x4ed0c3(0x23e));});}}async function confirmRestore(_0x35c57d,_0x4d3452){const _0x1f6b98=_0x2c43c1;io['to']('botmanager')[_0x1f6b98(0x320)](_0x1f6b98(0x1b6),_0x1f6b98(0x2bc),_0x1f6b98(0x1ea));if(tgBot&&settings[_0x1f6b98(0x2b1)]){const _0x1a0650=uuidRandom();tmpStorage[_0x1a0650]={'path':_0x35c57d,'filename':_0x4d3452};const _0x4407e8=Markup[_0x1f6b98(0x36a)]([Markup[_0x1f6b98(0x38c)][_0x1f6b98(0x1a7)](_0x1f6b98(0x2b6),_0x1f6b98(0x1ca)+_0x1a0650),Markup[_0x1f6b98(0x38c)][_0x1f6b98(0x1a7)]('no',_0x1f6b98(0x37a)+_0x1a0650)]);await sendTelegram(settings[_0x1f6b98(0x2b1)],_0x1f6b98(0x396),_0x4407e8),tgBot['action'](/restore_(.+)_(.+)/,async _0x10e469=>{const _0x10059d=_0x1f6b98,_0x1e66e6=_0x10e469[_0x10059d(0x266)][0x1],_0x85f7d9=_0x10e469[_0x10059d(0x266)][0x2],{path:_0x32265e,filename:_0x58c99d}=tmpStorage[_0x85f7d9];delete tmpStorage[_0x85f7d9],_0x10e469['editMessageReplyMarkup'](),_0x1e66e6==_0x10059d(0x2b6)?(logger[_0x10059d(0x2af)](_0x10059d(0x25a)),await sendTelegram(_0x10e469['chat']['id'],_0x10059d(0x278),{'parse_mode':'HTML'}),unzipFile(_0x32265e,_0x58c99d)):(logger[_0x10059d(0x2af)](_0x10059d(0x1ff)),await sendTelegram(_0x10e469[_0x10059d(0x316)]['id'],_0x10059d(0x1ff)));});}}function getServerTime(){const _0x2f933e=_0x2c43c1,_0x44d46b=new Date();return _0x44d46b['getFullYear']()+'/'+(_0x44d46b[_0x2f933e(0x28a)]()+0x1)[_0x2f933e(0x253)]()[_0x2f933e(0x2d3)](0x2,'0')+'/'+_0x44d46b[_0x2f933e(0x1f2)]()[_0x2f933e(0x253)]()['padStart'](0x2,'0')+'\x20'+_0x44d46b[_0x2f933e(0x1f4)]()[_0x2f933e(0x253)]()['padStart'](0x2,'0')+':'+_0x44d46b['getMinutes']()[_0x2f933e(0x253)]()[_0x2f933e(0x2d3)](0x2,'0')+':'+_0x44d46b[_0x2f933e(0x386)]()['toString']()[_0x2f933e(0x2d3)](0x2,'0');}function _0xc6a1(){const _0x3de9f2=['1361018fJJqEG','placeOrder','index.html','apiPassword','removeAllListeners','backup/','once','Notifications\x20enabled\x0a','(((.+)+)+)+$','login2fa_reject_','Failed\x20to\x20download\x20','server','/status\x20-\x20show\x20bot(s)\x20status\x0a','1875870wnETfu','get','cancel-loading','message','jsonwebtoken','copyFileSync','lastmsgtelegram','update_no','writeFileSync','botmanager','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','\x20mode','date-fns','15\x20min','DEFLATE','initclient','Error:\x20Invalid\x20argument\x20','login','success','Notifications\x20enabled','on_','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','store-headless','connected','running','getDate','get-messages','getHours','username','Unauthorized\x20attempt\x20to\x20delete\x20alerts','manual','temp/','backup','restart','reject','restore-backup-file','exchange','kill','Restore\x20process\x20aborted','remoteAddress','3000','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','secure','/help\x20-\x20show\x20available\x20commands\x0a','names','blacklist','-performance.json','Telegram\x20error:','\x20>\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','files','node','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','-config.json','toggle','bbUsername','Invalid\x20IP\x20address','/:bot/performance','graphql-request','2FA','hasOwnProperty','Unauthorized\x20attempt\x20to\x20store\x20configuration','action','Starting\x20Balance\x20Bot\x20reinstallation','6bmclPK','show','68cCOChy','Disabled\x20Bot\x20','/disable\x20-\x20disable\x20notifications\x0a','bot-','set','/upload-backup','bot.js','error','Invalid\x20username\x20or\x20IP\x20address','write','/:bot/support','randomFillSync','search','=>\x20Go\x20to\x20#CYA#http://','Temporary\x20access\x20rejected','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Enabled\x20Bot\x20','telegrammsg','config_alerts','Unauthorized\x20attempt\x20to\x20get\x20messages','/enable\x20-\x20enable\x20notifications\x0a','family','\x20to\x20','logs/','inherit','add','unlinkSync','emitHistory','/metrics\x20-\x20show\x20bot\x20performance\x0a','output-000.log','sendMessage','reinstall-bb','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','deleteHistoryAlerts','Password\x20reset\x20rejected','mkdirSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','2FA\x20login\x20token\x20generated','storeFiat','sha256','Invalid\x20authentication\x20token\x20(2)','sortBy','No\x20authentication\x20token','\x20|\x20','Bot\x20Mgr\x20>\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','/:bot','readFileSync','Bot\x20','status',',\x20must\x20be\x20a\x204\x20digit\x20number','backup-full','function','telegram2FaApproval','All','toString','password','Notifications\x20disabled\x0a','Yes','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','update-bb','test','Restore\x20process\x20confirmed','assign',':\x20Bot\x20Mgr\x20>\x20','2FA\x20login\x20rejected','type','tempaccess_30_','\x1b[34m','catch','title','\x1b[36m','tempaccess_reject_','file','match','show-config','generateKeyPairAsync','compareSync','settings.','/:bot/coins','\x20|\x20user:\x20...','9008405hTFeGS','push','invalid\x20credentials','output-002.log','storeConfiguration','File\x20uploaded','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Starting\x20Balance\x20Bot\x20update','::ffff:127.0.0.1','isDirectory','resetpw_no','Restoring\x20bot(s)\x20from\x20backup','endsWith','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','login2fa_','send','bbvReceive','.zip','toggle_','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','-----------------------------------------------------------------------------------','sign','store-configuration','[ip-address]','entries','log','Invalid\x20authentication\x20token\x20(1)','port','zip/','getMonth','login\x20required','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/:bot/configuration','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','randomBytes','hashSync','showConfig','\x20(1)','stringify','pidRefreshToken','version','reset-history','Unauthorized\x20attempt\x20to\x20get\x20portfolio','telegramEvents','store','environment','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','build2','Telegraf\x20error:','Notifications\x20types:\x20','bb/','mtime','config_all','generate','hex','forEach','start','secret','3043863HzYTFT','stopped','readdirSync','uncaughtException','Network\x20Interfaces:','SIGTERM','temporaryAccessAllowed','debug','256206umnQQq','telegramChatId','api-eu.mixpanel.com','join','<b>Balance\x20Bot\x20Status:</b>\x0a','find','yes','temporary\x20token\x20generated','range','1000','reinstall_no','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','\x1b[0m','filter','tempaccess_15_','Ok,\x20will\x20send\x20order\x20notifications\x20only','output-001.log','replace','Starting\x20new\x20bot\x20|\x20Bot\x20','mode','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','delete-alerts','staging','apiKey','Unauthorized\x20attempt\x20to\x20get\x20events','expiry','loginRequired','reinstall','request','bbvNew','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','stop','all','reply','padStart','conn','build','value','bbPassword','messages','get-portfolio','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','telegram','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20confirm\x20message','enable','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','binary','axios','init','path','\x1b[33m','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20download\x20','publicKey','whitelistEnabled','bb-settings.json','resetHistory','hybrid-crypto-js','Starting\x20(',')\x20\x20\x20|\x20Bot\x20','telegramUsername','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','any','command','cancelLoading','store-settings','Server','Access\x20enabled\x20for\x20','onepagemode','defaults','access\x20timeout','createWriteStream','/on\x20-\x20start\x20bot(s)\x0a','0.0.0','data','access','auto','Restarting\x20Bot\x20','rmSync','node-zip','config/','uuid-random','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','order','update_yes','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','\x20only\x0a','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/restart\x20-\x20restart\x20bot(s)\x0a','backup-full.zip','Unauthorized\x20attempt\x20to\x20update\x20bot','resetpw_yes','bb-config.json','RSA','editMessageReplyMarkup','Unauthorized\x20login\x20attempt\x20(timeout)','decrypt','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','chat','exit','Unauthorized\x20attempt\x20to\x20log\x20out','slice','login\x20not\x20required','1027qVhTSY','length','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','telegramToken','Markdown','emit','tkn','kind','host','botID','Starting\x20#RED#Balance\x20Bot\x20v','config_orders','output-003.log','args','util','uuid','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','get-logs','disconnect','auth','botname','backup-full@','express','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getTime','<b>Telegram\x20Bot\x20Status:</b>\x0a','reload','$1_$2_$3','\x1b[35m','https://api.ipify.org?format=json','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','reason','userid','Deleted\x20Bot\x20','Crypt','disable','encryptedUuid','sort','string','clients','live','Notifications\x20disabled','Restore\x20backup\x20file\x20','#RES#\x20if\x20running\x20locally\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','latestversion','2jdNVKQ','params','-results.json','mixpanel','Token\x20blacklisted','/:bot/history','Session\x20expired\x20for\x20user\x20...','restart_','Login\x20accepted','::1','bot','includes','alerts','-events.json','temporary\x20access\x20rejected','HTML','split','reset-password','All\x20bots','sendPortfolioTelegram','login\x20token\x20valid','warning','Alerts','Backup\x20file\x20unzipped\x20and\x20stored','socket','update','parse','track','orders','telegramIpApproval','accept','alias','lastmsgemitted','inlineKeyboard','yargs/yargs','sendFile','enabled','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','keys','393684KNNUvs','All\x20bots\x20running\x20right\x20now','argv','format','fork','privateKey','existsSync','Setting\x20access:\x20','address','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','restore_no_','handshake','internal','number','token','settings','sendMetricsTelegram','get-starting-balances','User\x20has\x20been\x20validated','clientip','sockets','showname','getSeconds','post','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','place-order','from','startsWith','button','isValid','launch','off','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','8DjIjKM','bb-secure.json','then','event','toIPv4MappedAddress','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','constructor','static','map','pidExpireLogin','statSync','44SqoBdw','_data','logged\x20out','telegramEnabled','headless','headers','\x1b[31m','IPv4','2FA\x20required','toIPv4Address','Logged\x20out\x20user\x20...','full','production','simple','allow','ipv6','apiSecret','/:bot/portfolio','getStartingBalances','help','callback','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','child_process','use','metrics_','\x20(2)','Unauthorized\x20attempt\x20to\x20show\x20configuration','timestamp','update-bot','size','7470030BpnsHQ','cloneDeep','delete-bot','getMinutes','timeshift','notification','************','remove','Your\x20installation\x20is\x20already\x20up\x20to\x20date','name','store-fiat','new-disabled','disabled','bots','portfolio_','listen','getFullYear','Backup\x20file\x20uploaded','***','updatebotmanager','login\x20token\x20generated','private',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','new','/update\x20-\x20update\x20Balance\x20Bot\x0a','restore_yes_'];_0xc6a1=function(){return _0x3de9f2;};return _0xc6a1();}function getTimeStamp(){const _0x369c6d=_0x2c43c1,_0x1e06a3=shiftedTime();return _0x1e06a3[_0x369c6d(0x1c1)]()+'/'+(_0x1e06a3[_0x369c6d(0x28a)]()+0x1)[_0x369c6d(0x253)]()[_0x369c6d(0x2d3)](0x2,'0')+'/'+_0x1e06a3['getDate']()[_0x369c6d(0x253)]()[_0x369c6d(0x2d3)](0x2,'0')+'\x20'+_0x1e06a3['getHours']()[_0x369c6d(0x253)]()[_0x369c6d(0x2d3)](0x2,'0')+':'+_0x1e06a3[_0x369c6d(0x1b4)]()[_0x369c6d(0x253)]()[_0x369c6d(0x2d3)](0x2,'0')+':'+_0x1e06a3[_0x369c6d(0x386)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x19f953=_0x2c43c1,_0x5e837a=shiftedTime();return _0x5e837a['getFullYear']()+(_0x5e837a['getMonth']()+0x1)[_0x19f953(0x253)]()[_0x19f953(0x2d3)](0x2,'0')+_0x5e837a[_0x19f953(0x1f2)]()['toString']()[_0x19f953(0x2d3)](0x2,'0')+'-'+_0x5e837a[_0x19f953(0x1f4)]()[_0x19f953(0x253)]()[_0x19f953(0x2d3)](0x2,'0')+_0x5e837a[_0x19f953(0x1b4)]()[_0x19f953(0x253)]()[_0x19f953(0x2d3)](0x2,'0')+_0x5e837a[_0x19f953(0x386)]()[_0x19f953(0x253)]()[_0x19f953(0x2d3)](0x2,'0');}function shiftedTime(){const _0x339db5=_0x2c43c1,_0x53c910=new Date();let _0x346b48=_0x53c910;if(settings[_0x339db5(0x1b5)]&&settings['timeshift']!==0x0)_0x346b48=fns[_0x339db5(0x234)](_0x53c910,{'hours':settings['timeshift']});return _0x346b48;}function startScheduler(){const _0x301a33=new Date()['getUTCHours'](),_0xc87119=shiftedTime()['getHours']();_0xc87119==0x4&&backupConfigFiles();_0xc87119==0x0&&rotateLogFiles();_0x301a33%0x6==0x0&&triggerAnalytics();_0x301a33%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x46e5fc){const _0x45fd5f=_0x2c43c1;logger[_0x45fd5f(0x2af)](_0x45fd5f(0x345)+_0x46e5fc);const _0x4b6a2c=getBotsWithMode();_0x4b6a2c[_0x45fd5f(0x31c)]>0x0?confirmRestore(configbackuppath,_0x46e5fc):unzipFile(configbackuppath,_0x46e5fc);}async function getBackupFiles(_0x4c1afa=null){const _0x484753=_0x2c43c1;let _0x3f5346=[],_0x46c398=fs[_0x484753(0x2aa)](configbackuppath,{'withFileTypes':!![]});_0x46c398[_0x484753(0x340)]((_0x3f8390,_0x3f3243)=>_0x3f8390[_0x484753(0x1ba)]<_0x3f3243[_0x484753(0x1ba)]?0x1:_0x3f3243[_0x484753(0x1ba)]<_0x3f8390[_0x484753(0x1ba)]?-0x1:0x0),_0x46c398['forEach'](_0x3fb6ce=>{const _0x2ff590=_0x484753;if(!_0x3fb6ce[_0x2ff590(0x276)]()&&_0x3fb6ce[_0x2ff590(0x1ba)][_0x2ff590(0x38b)](_0x2ff590(0x330))&&_0x3fb6ce['name'][_0x2ff590(0x279)](_0x2ff590(0x27e))){const _0x537ae2=formatDate(fs[_0x2ff590(0x39b)](configbackuppath+_0x3fb6ce['name'])[_0x2ff590(0x2a1)]);_0x3f5346[_0x2ff590(0x26e)]({'name':_0x3fb6ce['name'],'mtime':_0x537ae2});}});if(_0x4c1afa)io['to'](_0x4c1afa)[_0x484753(0x320)]('backup-files',_0x3f5346);else return _0x3f5346;}async function backupConfigFiles(){const _0x26d080=_0x2c43c1;await zipFiles(_0x26d080(0x24f));const _0x190b46=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x26d080(0x30d),configbackuppath+(_0x26d080(0x330)+_0x190b46+_0x26d080(0x27e)));let _0x3cf45b=fs[_0x26d080(0x2aa)](configbackuppath,{'withFileTypes':!![]});_0x3cf45b[_0x26d080(0x340)]((_0x2da4bf,_0x4ec104)=>_0x2da4bf[_0x26d080(0x1ba)]<_0x4ec104[_0x26d080(0x1ba)]?0x1:_0x4ec104[_0x26d080(0x1ba)]<_0x2da4bf[_0x26d080(0x1ba)]?-0x1:0x0),_0x3cf45b[_0x26d080(0x31c)]>maxBackups&&fs[_0x26d080(0x235)](configbackuppath+_0x3cf45b[_0x3cf45b[_0x26d080(0x31c)]-0x1][_0x26d080(0x1ba)]);}function rotateLogFiles(){const _0x12fab9=_0x2c43c1,_0x3bd129=fs[_0x12fab9(0x39b)](logspath+_0x12fab9(0x238)),_0x348cd6=_0x3bd129[_0x12fab9(0x1b0)]/0x400;if(_0x348cd6>0x64){let _0xf58b77=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0xf58b77[_0x12fab9(0x340)]((_0x4b8f88,_0x3c92b4)=>_0x4b8f88[_0x12fab9(0x1ba)]<_0x3c92b4[_0x12fab9(0x1ba)]?0x1:_0x3c92b4[_0x12fab9(0x1ba)]<_0x4b8f88[_0x12fab9(0x1ba)]?-0x1:0x0),_0xf58b77['forEach'](_0x47bace=>{const _0x3c505c=_0x12fab9;if(_0x47bace[_0x3c505c(0x1ba)]=='output-002.log')fs['copyFileSync'](logspath+_0x47bace[_0x3c505c(0x1ba)],logspath+_0x3c505c(0x327));if(_0x47bace[_0x3c505c(0x1ba)]==_0x3c505c(0x2c1))fs[_0x3c505c(0x1dd)](logspath+_0x47bace[_0x3c505c(0x1ba)],logspath+_0x3c505c(0x270));_0x47bace[_0x3c505c(0x1ba)]==_0x3c505c(0x238)&&(fs[_0x3c505c(0x1dd)](logspath+_0x47bace[_0x3c505c(0x1ba)],logspath+_0x3c505c(0x2c1)),fs[_0x3c505c(0x1e0)](logspath+_0x47bace[_0x3c505c(0x1ba)],''));});}}async function zipFiles(_0x2bba9d){const _0x3e1e8f=_0x2c43c1;let _0x243e4f;if(_0x2bba9d=='logs')_0x243e4f=logspath;if(_0x2bba9d==_0x3e1e8f(0x1f9))_0x243e4f=configpath;if(_0x2bba9d==_0x3e1e8f(0x24f))_0x243e4f=configpath;let _0x50e7ad=fs[_0x3e1e8f(0x2aa)](_0x243e4f,{'withFileTypes':!![]});const _0x568d54=new require(_0x3e1e8f(0x302))();_0x50e7ad[_0x3e1e8f(0x2a5)](_0x5b3998=>{const _0x38dfe8=_0x3e1e8f;if(!_0x5b3998['isDirectory']()){let _0x1274aa=fs[_0x38dfe8(0x24b)](_0x243e4f+_0x5b3998[_0x38dfe8(0x1ba)]);if(_0x2bba9d==_0x38dfe8(0x1f9)){const _0x21c8e2=/^bot-[0-9]{3}-config.json$/,_0x3f8b1e=_0x21c8e2[_0x38dfe8(0x259)](_0x5b3998[_0x38dfe8(0x1ba)]);if(_0x3f8b1e){const _0x5198b5=JSON[_0x38dfe8(0x363)](_0x1274aa);if(_0x5198b5[_0x38dfe8(0x353)][0x0]){_0x5198b5[_0x38dfe8(0x353)][0x0][_0x38dfe8(0x2c8)]=_0x38dfe8(0x1c3),_0x5198b5['bot'][0x0][_0x38dfe8(0x3ac)]='***';if(_0x5198b5[_0x38dfe8(0x353)][0x0][_0x38dfe8(0x1ce)])_0x5198b5[_0x38dfe8(0x353)][0x0][_0x38dfe8(0x1ce)]=_0x38dfe8(0x1c3);}_0x1274aa=JSON['stringify'](_0x5198b5,null,0x2);}if(_0x5b3998[_0x38dfe8(0x1ba)]=='bb-settings.json'){const _0x1aae7e=JSON['parse'](_0x1274aa);if(_0x1aae7e[_0x38dfe8(0x37f)]['loginRequired'])_0x1aae7e[_0x38dfe8(0x37f)][_0x38dfe8(0x2cb)]=![];if(_0x1aae7e[_0x38dfe8(0x37f)][_0x38dfe8(0x2d7)])_0x1aae7e[_0x38dfe8(0x37f)][_0x38dfe8(0x2d7)]=_0x38dfe8(0x1c3);if(_0x1aae7e['settings'][_0x38dfe8(0x31e)])_0x1aae7e[_0x38dfe8(0x37f)]['telegramToken']=_0x38dfe8(0x1c3);if(_0x1aae7e[_0x38dfe8(0x37f)][_0x38dfe8(0x2b1)])_0x1aae7e[_0x38dfe8(0x37f)][_0x38dfe8(0x2b1)]=null;_0x1274aa=JSON[_0x38dfe8(0x294)](_0x1aae7e,null,0x2);}if(_0x5b3998['name']!=_0x38dfe8(0x392))_0x568d54[_0x38dfe8(0x265)](_0x5b3998['name'],_0x1274aa);}else _0x568d54[_0x38dfe8(0x265)](_0x5b3998[_0x38dfe8(0x1ba)],_0x1274aa);}});const _0x558dc7=_0x568d54[_0x3e1e8f(0x2a3)]({'base64':![],'compression':_0x3e1e8f(0x1e6)});fs[_0x3e1e8f(0x1e0)](zippath+(_0x2bba9d+_0x3e1e8f(0x27e)),_0x558dc7,_0x3e1e8f(0x2e0));}async function unzipFile(_0x10a8d,_0x211c72){const _0x389816=_0x2c43c1;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x989240=>{const _0x2ddc41=_0x4fa4;if(!_0x989240['isDirectory']())fs['rmSync'](configpath+_0x989240[_0x2ddc41(0x1ba)]);});const _0x3130a=fs[_0x389816(0x24b)](_0x10a8d+_0x211c72,_0x389816(0x2e0)),_0x51d725=new require(_0x389816(0x302))(_0x3130a,{'base64':![],'checkCRC32':!![]});Object[_0x389816(0x36f)](_0x51d725[_0x389816(0x20b)])[_0x389816(0x2a5)](_0x401470=>{const _0x253f57=_0x389816,_0x33043c=_0x51d725['files'][_0x401470];fs[_0x253f57(0x1e0)](configpath+_0x33043c[_0x253f57(0x1ba)],_0x33043c[_0x253f57(0x39d)]);}),fs[_0x389816(0x2aa)](temppath,{'withFileTypes':!![]})[_0x389816(0x2a5)](_0x410049=>{const _0x5d888e=_0x389816;if(!_0x410049[_0x5d888e(0x276)]())fs[_0x5d888e(0x301)](temppath+_0x410049[_0x5d888e(0x1ba)]);}),logger[_0x389816(0x2af)](_0x389816(0x360)),process['send']({'restore':!![]},_0x1c03b6=>{});}async function getPublicIp(){const _0x41848d=_0x2c43c1;try{const _0x1d2cff=await axios[_0x41848d(0x1d9)](_0x41848d(0x338));publicip=_0x1d2cff[_0x41848d(0x2fd)]['ip'];}catch(_0x4249d5){}}async function triggerAnalytics(){const _0x3e1bab=_0x2c43c1;if(!publicip)await getPublicIp();const _0x56465f=getBotsWithMode();let _0x40b9d2=0x0;_0x56465f[_0x3e1bab(0x2a5)](_0xb1c213=>{const _0x4a146c=_0x3e1bab;if(_0xb1c213[_0x4a146c(0x24d)]==='enabled')_0x40b9d2++;});const _0x47a29f=getBotExchanges();mixpanel[_0x3e1bab(0x364)](_0x3e1bab(0x2f5),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x56465f[_0x3e1bab(0x31c)],'numbotsenabled':_0x40b9d2,'exchanges':_0x47a29f,'environment':environment});}async function getMessages(){const _0x3f966a=_0x2c43c1,_0x495d91='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x586867=new GraphQLClient(_0x495d91),_0x3e5bf0={'authorization':_0x3f966a(0x308)},_0x2e137a=serverversion[_0x3f966a(0x359)]('.'),_0x24dd8d=_0x2e137a[0x0]+'.'+_0x2e137a[0x1],_0x1e8037=Math['min'](settings[_0x3f966a(0x1de)],settings['lastmsgemitted']),_0xe1f48d={'last':parseInt(_0x1e8037),'bbm':_0x24dd8d},_0x58c44f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x35fd3b;try{_0x35fd3b=await _0x586867[_0x3f966a(0x2cd)](_0x58c44f,_0xe1f48d,_0x3e5bf0);}catch(_0x5217a6){}if(_0x35fd3b&&_0x35fd3b[_0x3f966a(0x2d8)]){let _0x196053=settings[_0x3f966a(0x1de)];newMessages=[];for(const _0x4b13a7 of _0x35fd3b[_0x3f966a(0x2d8)]){newMessages[_0x3f966a(0x26e)](_0x4b13a7);let _0x8c27a1=![];_0x4b13a7['bbvNew']&&(updateSetting(_0x3f966a(0x348),_0x4b13a7[_0x3f966a(0x2ce)]),_0x8c27a1=isNewerVersion(serverversion,_0x4b13a7['bbvNew'])||serverversion==_0x4b13a7['bbvNew']);if(!_0x8c27a1&&_0x4b13a7[_0x3f966a(0x37d)]>_0x196053){if(_0x4b13a7[_0x3f966a(0x27d)]===_0x3f966a(0x2f1)||serverversion[_0x3f966a(0x38b)](_0x4b13a7[_0x3f966a(0x27d)])){let _0x1f11ba=''+_0x4b13a7[_0x3f966a(0x262)]+'\x0a\x0a'+_0x4b13a7[_0x3f966a(0x1db)];const _0x30d094=await sendTelegramMsg(toTelegramMarkdown(_0x1f11ba),_0x3f966a(0x31f));if(_0x30d094)_0x196053=_0x4b13a7[_0x3f966a(0x37d)];}}}updateAvailable=isNewerVersion(settings[_0x3f966a(0x348)],serverversion),updateSetting(_0x3f966a(0x1de),_0x196053),emitMessages();}}function emitMessages(){const _0x45714e=_0x2c43c1,_0x5e79c6=settings[_0x45714e(0x369)];let _0x312e60=[];newMessages[_0x45714e(0x2a5)](_0x52042f=>{const _0x4ca1c6=_0x45714e;_0x52042f[_0x4ca1c6(0x37d)]>_0x5e79c6&&_0x312e60[_0x4ca1c6(0x26e)](_0x52042f);}),_0x312e60[_0x45714e(0x31c)]>0x0&&getAllClients()[_0x45714e(0x2a5)](_0x1a059d=>{const _0x2798e7=_0x45714e;getSocket(_0x1a059d['id'])[_0x2798e7(0x320)](_0x2798e7(0x1db),_0x312e60);});}function confirmMessage(_0x12fbf6){const _0x1a24ca=_0x2c43c1;updateSetting(_0x1a24ca(0x369),Number(_0x12fbf6));}function isNewerVersion(_0x15ba2f,_0x4996f1){const _0x36c886=_0x2c43c1,_0x42440f=_0x4996f1[_0x36c886(0x359)]('.'),_0x2ca12f=_0x15ba2f[_0x36c886(0x359)]('.');for(var _0x5087cf=0x0;_0x5087cf<_0x2ca12f['length'];_0x5087cf++){const _0x265901=~~_0x2ca12f[_0x5087cf],_0x19379a=~~_0x42440f[_0x5087cf];if(_0x265901>_0x19379a)return!![];if(_0x265901<_0x19379a)return![];}return![];}function toTelegramMarkdown(_0x5556c6){const _0x22f6a8=_0x2c43c1,_0x1909ec=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x446918=/\*{2}(.+?)\*{2}/gim;return _0x5556c6=_0x5556c6[_0x22f6a8(0x2c2)](_0x1909ec,_0x22f6a8(0x336))[_0x22f6a8(0x2c2)](_0x446918,'*$1*'),_0x5556c6;}async function validateConfigFile(){const _0x1705f7=_0x2c43c1,_0xe1a98f=dbConfig[_0x1705f7(0x1d9)](_0x1705f7(0x1be))[_0x1705f7(0x245)](_0x1705f7(0x324))[_0x1705f7(0x2d6)]()||[];if(_0xe1a98f['length']==0x0){let _0x313454=0x0,_0x578de2=[];const _0x256b24=/^bot-([0-9]{3})-config.json$/,_0x3b7e16=fs[_0x1705f7(0x2aa)](configpath);_0x3b7e16[_0x1705f7(0x2a5)](_0x34f620=>{const _0x151502=_0x1705f7,_0x37383a=_0x256b24['exec'](_0x34f620);if(_0x37383a){const _0x373899=_0x37383a[0x1];let _0x14230f=getBotAttributes(_0x373899);_0x578de2[_0x151502(0x26e)]({'botID':_0x373899,'botname':_0x14230f['botname'],'status':_0x151502(0x1bd),'live':_0x151502(0x2a9)}),_0x313454++;}}),_0x313454!=0x0&&(dbConfig[_0x1705f7(0x1d9)]('bots')['assign'](_0x578de2)[_0x1705f7(0x224)](),config=_0x578de2,restoredConfigFile=_0x313454);}}async function restoreConfigNotify(_0x1fb3f7){const _0x136df0=_0x2c43c1;let _0x576906;if(restoredConfigFile==0x1)_0x576906=_0x136df0(0x347);else _0x576906=_0x136df0(0x257);if(_0x1fb3f7)io['to'](_0x136df0(0x1e1))[_0x136df0(0x320)](_0x136df0(0x1b6),_0x576906);else{logger[_0x136df0(0x3a9)](_0x136df0(0x281)),logger[_0x136df0(0x3a9)](_0x576906),logger[_0x136df0(0x3a9)](_0x136df0(0x281)),logger['simple']('');if(tgBot&&settings[_0x136df0(0x2b1)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x136df0(0x2b1)],_0x136df0(0x248)+_0x576906);}}function validateCredentials(_0x4b4190,_0x249e42){const _0x5dc84a=_0x2c43c1;if(_0x4b4190[_0x5dc84a(0x1f5)]==settings[_0x5dc84a(0x210)]&&bcrypt[_0x5dc84a(0x269)](_0x4b4190[_0x5dc84a(0x254)],settings[_0x5dc84a(0x2d7)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5cc12b=generateLoginToken(_0x249e42);return{'allow':!![],'reason':_0x5dc84a(0x1c5),'token':_0x5cc12b};}}else return{'allow':![],'reason':_0x5dc84a(0x26f),'token':null};}function refreshToken(_0x4a1c1f){const _0x4313f9=_0x2c43c1,_0x4f6c7e=generateLoginToken(_0x4a1c1f);return{'allow':!![],'reason':_0x4313f9(0x1c5),'token':_0x4f6c7e};}function validateAccess(_0x3f42ce,_0x4fd56e,_0x26a61c){const _0x3bc748=_0x2c43c1,_0x58f063=_0x26a61c?_0x26a61c:devices[_0x4fd56e]['ip'];let _0xc34339;const _0x4ddd04=_0x21fc18=>{const _0x4e47be=_0x4fa4;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x4fd56e)){const _0x8672a7=generateLoginToken(_0x4fd56e);return{'allow':!![],'reason':_0x4e47be(0x241),'token':_0x8672a7};}else return{'allow':![],'reason':_0x4e47be(0x28b),'token':null};}else return _0xc34339=validToken(_0x21fc18,_0x4fd56e),_0xc34339[_0x4e47be(0x215)](_0x4e47be(0x1ea))?{'allow':!![],'reason':_0x4e47be(0x35d),'token':_0x21fc18}:{'allow':![],'reason':_0x4e47be(0x28b),'token':null};}else return{'allow':!![],'reason':_0x4e47be(0x31a),'token':null};};if(settings[_0x3bc748(0x2e9)]){let _0x187ce3=[...settings['whitelist'],_0x3bc748(0x352),_0x3bc748(0x275),'127.0.0.1'];if(_0x187ce3[_0x3bc748(0x354)](_0x58f063))return _0x4ddd04(_0x3f42ce);else{_0xc34339=validToken(_0x3f42ce,_0x4fd56e);if(_0xc34339[_0x3bc748(0x215)](_0x3bc748(0x1ea)))return _0x4ddd04(_0x3f42ce);else{if(telegramIpApproved(_0x4fd56e)){const _0x1535ab=generateToken(_0x4fd56e);return _0xc34339=_0x4ddd04(_0x3f42ce),_0xc34339[_0x3bc748(0x3aa)]?{'allow':!![],'reason':_0x3bc748(0x2b7),'token':_0x1535ab}:_0xc34339;}else return settings[_0x3bc748(0x2ae)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4ddd04(_0x3f42ce);}function timelyDecrypt(_0x1a7a5d,_0x151bec=!![]){const _0x3ab450=_0x2c43c1;if(_0x1a7a5d)try{const _0x5e3c95=crypt[_0x3ab450(0x314)](secure['privateKey'],_0x1a7a5d)[_0x3ab450(0x1db)],_0x117f40=_0x5e3c95['split']('@')[0x0],_0x3dd3d8=_0x5e3c95['split']('@')[0x1],_0x4d6ab6=new Date()[_0x3ab450(0x333)]();if(_0x151bec){if(_0x4d6ab6-_0x3dd3d8<maxSecretAge*0x3e8)return _0x117f40;else return![];}else return _0x117f40;}catch(_0x2c2754){return![];}else return![];}const validToken=(_0x1e1a73,_0x1c71e7)=>{const _0x50b6e8=_0x2c43c1,_0x4b87f6=devices[_0x1c71e7]['ip'];if(!_0x1e1a73)return{'error':_0x50b6e8(0x246)};for(let _0x4b7330 of blacklist){if(_0x4b7330[_0x50b6e8(0x37e)]==_0x1e1a73)return{'error':_0x50b6e8(0x34d)};}let _0xfb57e6;try{_0xfb57e6=jwt['verify'](_0x1e1a73,secure['secret']+_0x1c71e7);}catch{return{'error':_0x50b6e8(0x287)};}if(!_0xfb57e6[_0x50b6e8(0x215)](_0x50b6e8(0x383))&&!_0xfb57e6[_0x50b6e8(0x215)](_0x50b6e8(0x1f5))||!_0xfb57e6['hasOwnProperty']('exp'))return{'error':_0x50b6e8(0x244)};if(!_0xfb57e6[_0x50b6e8(0x215)](_0x50b6e8(0x1f5))&&_0xfb57e6['hasOwnProperty'](_0x50b6e8(0x383))){const {clientip:_0x5ab3e9}=_0xfb57e6;return _0x4b87f6==_0x5ab3e9?{'success':_0x50b6e8(0x382)}:{'error':_0x50b6e8(0x211)};}else{if(_0xfb57e6['hasOwnProperty']('username')&&_0xfb57e6[_0x50b6e8(0x215)](_0x50b6e8(0x383))){const {username:_0x49eecf,clientip:_0x4a882b}=_0xfb57e6;return settings[_0x50b6e8(0x210)]==_0x49eecf&&_0x4b87f6==_0x4a882b?{'success':_0x50b6e8(0x382)}:{'error':_0x50b6e8(0x223)};}}},generateLoginToken=_0x166451=>{const _0x185553=_0x2c43c1;if(_0x166451){const _0x581745=devices[_0x166451]['ip'];return jwt[_0x185553(0x282)]({'username':settings[_0x185553(0x210)],'clientip':_0x581745},secure[_0x185553(0x2a7)]+_0x166451,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x62478a=>{const _0x539aa0=_0x2c43c1;if(_0x62478a){const _0x581da5=devices[_0x62478a]['ip'];return jwt[_0x539aa0(0x282)]({'clientip':_0x581da5},secure[_0x539aa0(0x2a7)]+_0x62478a,{'expiresIn':devices[_0x62478a][_0x539aa0(0x366)][_0x539aa0(0x2ca)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x22e510=>{const _0x4eb1c6=_0x2c43c1;let _0x323874=![];return devices[_0x22e510]['telegramIpApproval']&&devices[_0x22e510][_0x4eb1c6(0x366)]['expiry']!=_0x4eb1c6(0x1fb)&&(_0x323874=devices[_0x22e510][_0x4eb1c6(0x366)]['clientip']==devices[_0x22e510]['ip']&&new Date()[_0x4eb1c6(0x333)]()-devices[_0x22e510][_0x4eb1c6(0x366)][_0x4eb1c6(0x1ae)]<devices[_0x22e510][_0x4eb1c6(0x366)]['expiry']*0x3c*0x3e8),_0x323874;},telegram2FaApproved=_0x4bc26c=>{const _0x6fb125=_0x2c43c1;let _0x280edd=![];return devices[_0x4bc26c][_0x6fb125(0x251)]&&devices[_0x4bc26c][_0x6fb125(0x251)][_0x6fb125(0x2ca)]!=_0x6fb125(0x1fb)&&(_0x280edd=devices[_0x4bc26c][_0x6fb125(0x251)][_0x6fb125(0x383)]==devices[_0x4bc26c]['ip']&&new Date()[_0x6fb125(0x333)]()-devices[_0x4bc26c]['telegram2FaApproval'][_0x6fb125(0x1ae)]<devices[_0x4bc26c][_0x6fb125(0x251)][_0x6fb125(0x2ca)]*0x3c*0x3e8),_0x280edd;},normalizeIP=_0x2952c3=>{const _0x7f628=_0x2c43c1;let _0x248c54=null,_0x41df52=null;if(ipaddr[_0x7f628(0x38d)](_0x2952c3)){const _0x59d81f=ipaddr['parse'](_0x2952c3);_0x59d81f[_0x7f628(0x322)]()===_0x7f628(0x3ab)?(_0x59d81f['isIPv4MappedAddress']()&&(_0x248c54=_0x59d81f[_0x7f628(0x3a5)]()[_0x7f628(0x253)]()),_0x41df52=_0x59d81f['toString']()):(_0x248c54=_0x59d81f['toString'](),_0x41df52=_0x59d81f[_0x7f628(0x395)]()[_0x7f628(0x253)]());}return{'show':_0x248c54?_0x248c54:_0x41df52,'store':_0x41df52};};function formatDate(_0x2146c2){const _0x3220cd=_0x2c43c1;return _0x2146c2[_0x3220cd(0x1c1)]()+'/'+(_0x2146c2[_0x3220cd(0x28a)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x2146c2['getDate']()[_0x3220cd(0x253)]()['padStart'](0x2,'0')+'\x20'+_0x2146c2[_0x3220cd(0x1f4)]()[_0x3220cd(0x253)]()[_0x3220cd(0x2d3)](0x2,'0')+':'+_0x2146c2[_0x3220cd(0x1b4)]()[_0x3220cd(0x253)]()[_0x3220cd(0x2d3)](0x2,'0')+':'+_0x2146c2[_0x3220cd(0x386)]()[_0x3220cd(0x253)]()[_0x3220cd(0x2d3)](0x2,'0');}function sleep(_0x4f5fb7){return new Promise(_0xac2b13=>setTimeout(_0xac2b13,_0x4f5fb7));}