const _0x41dc7e=_0x5afd;(function(_0x2d903c,_0x4cf3cb){const _0x3a5afa=_0x5afd,_0x26f2fb=_0x2d903c();while(!![]){try{const _0x27adf5=parseInt(_0x3a5afa(0x238))/0x1*(-parseInt(_0x3a5afa(0x1ac))/0x2)+parseInt(_0x3a5afa(0x175))/0x3+parseInt(_0x3a5afa(0x2a9))/0x4+-parseInt(_0x3a5afa(0x2e1))/0x5+parseInt(_0x3a5afa(0x1af))/0x6*(-parseInt(_0x3a5afa(0x1bb))/0x7)+parseInt(_0x3a5afa(0x1b9))/0x8+-parseInt(_0x3a5afa(0x1bd))/0x9*(-parseInt(_0x3a5afa(0x270))/0xa);if(_0x27adf5===_0x4cf3cb)break;else _0x26f2fb['push'](_0x26f2fb['shift']());}catch(_0x20a6ae){_0x26f2fb['push'](_0x26f2fb['shift']());}}}(_0x48aa,0xf19c6));const _0x3b2c7d=function(){let _0x4f205e=!![];return function(_0x4c09c0,_0x325040){const _0x485678=_0x4f205e?function(){const _0x7b326a=_0x5afd;if(_0x325040){const _0x427ff6=_0x325040[_0x7b326a(0x1a3)](_0x4c09c0,arguments);return _0x325040=null,_0x427ff6;}}:function(){};return _0x4f205e=![],_0x485678;};}(),_0x3d8357=_0x3b2c7d(this,function(){const _0x52a69e=_0x5afd;return _0x3d8357['toString']()[_0x52a69e(0x130)](_0x52a69e(0x2a3))[_0x52a69e(0x128)]()[_0x52a69e(0x2de)](_0x3d8357)[_0x52a69e(0x130)]('(((.+)+)+)+$');});_0x3d8357();'use strict';process[_0x41dc7e(0x231)][_0x41dc7e(0x2b6)]=0x1;const childProcess=require(_0x41dc7e(0x1e5)),fs=require('fs'),fns=require(_0x41dc7e(0x13a)),low=require(_0x41dc7e(0x186)),FileSync=require(_0x41dc7e(0x2d2)),path=require(_0x41dc7e(0x23c)),crypto=require(_0x41dc7e(0x255)),Crypt=require(_0x41dc7e(0x20f))[_0x41dc7e(0x1c2)],RSA=require(_0x41dc7e(0x20f))[_0x41dc7e(0x28d)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x41dc7e(0x14b)),argv=require(_0x41dc7e(0x13f))(process[_0x41dc7e(0x146)]['slice'](0x2))[_0x41dc7e(0x146)],uuidRandom=require(_0x41dc7e(0x12f)),TelegramBot=require(_0x41dc7e(0x285)),Mixpanel=require('mixpanel'),axios=require(_0x41dc7e(0x1a0)),{GraphQLClient,gql}=require(_0x41dc7e(0x2ce)),util=require(_0x41dc7e(0x172)),fileUpload=require(_0x41dc7e(0x22d)),{networkInterfaces}=require('os'),PORT=argv[_0x41dc7e(0x298)]||_0x41dc7e(0x207),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x41dc7e(0x24a)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x41dc7e(0x250)),process['exit'](0x1));const HOST=argv[_0x41dc7e(0x259)]||null,userID=argv[_0x41dc7e(0x1ae)]||'',debugging=argv['d']||![],nodeversion=process[_0x41dc7e(0x16c)][_0x41dc7e(0x1cd)];let bbpath=_0x41dc7e(0x264),bbpath2='';const botfile='bot.js',configfile=_0x41dc7e(0x2dc),settingsfile='bb-settings.json',securefile=_0x41dc7e(0x1dd),environment=require('./'+bbpath2+'version.json')[_0x41dc7e(0x273)]||_0x41dc7e(0x199),maxBackups=0xa;let validInstallation=!![];!fs[_0x41dc7e(0x287)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x41dc7e(0x24f)),configpath=userID?bbpath+_0x41dc7e(0x280)+userID+'/':bbpath+_0x41dc7e(0x280),configbackuppath=configpath+_0x41dc7e(0x2c4),logspath=userID?bbpath+_0x41dc7e(0x1ab)+userID+'/':bbpath+_0x41dc7e(0x1ab),zippath=userID?bbpath+_0x41dc7e(0x202)+userID+'/':bbpath+_0x41dc7e(0x202),loggerfile=fs[_0x41dc7e(0x276)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';function _0x48aa(){const _0x4a4291=['conn','api-eu.mixpanel.com','versions','update-bot','blacklist','accept','5\x20min','build','util','secure','output-001.log','1679661hbTRnl','/:bot/support','Yes','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','size','createServer','address','mode','event','*$1*','any','started','map','join','headers','invalid\x20credentials','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','lowdb','listen','Unauthorized\x20attempt\x20to\x20download\x20','Starting\x20#RED#Balance\x20Bot\x20v','files','reinstall','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','User\x20has\x20been\x20validated','userid','telegramUsername','Unauthorized\x20attempt\x20to\x20get\x20messages','login\x20token\x20generated','-config.json','reset-password','hashSync','onepagemode','temporary\x20access\x20rejected','***','parse','production','removeListener','storeFiat','yes','/off\x20-\x20stop\x20bot(s)\x0a','botmanager','\x20mode','axios','telegramIpApproval','remoteAddress','apply','readFileSync','Invalid\x20IP\x20address','No\x20authentication\x20token','127.0.0.1','telegramChatId','Unauthorized\x20attempt\x20to\x20get\x20portfolio','filter','logs/','657328JCpdow','index.html','user','1246314ufMyoN','/on\x20-\x20start\x20bot(s)\x0a','manual','includes','auto','\x20(2)','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','string','notification','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','5423624PeCWdd','add','49FZeKDW','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','1782OOtjBN','\x20(1)','restore-backup-file','delete-bot','initclient','Crypt','startsWith','private','Ok,\x20will\x20send\x20order\x20notifications\x20only','hex','live','connected','backup-full@','2FA\x20login\x20rejected','update-bb','-events.json','node','enabled','\x1b[0m','deleteHistoryAlerts','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','static','orders','sendPortfolioTelegram','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','botID','Unauthorized\x20attempt\x20to\x20update\x20bot','token','request','/help\x20-\x20show\x20available\x20commands\x0a','full','write','bb-secure.json','http','defaults','Restoring\x20bot(s)\x20from\x20backup','split','-----------------------------------------------------------------------------------','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','exchange','child_process','params','/download/:type','tkn','all','************','format','.zip','sockets','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','backupfile','Restarting\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','telegramToken','Enabled\x20Bot\x20','copyFileSync','\x20|\x20user:\x20...','Password\x20has\x20been\x20reset\x20to:\x20','toIPv4Address','publicKey','logged\x20out','Markdown','1000','stop','slice','new-disabled','30\x20min','zip/','error','2FA\x20login\x20token\x20generated','clientip','Notifications\x20types:\x20','3000','/upload-backup','password','/:bot','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20store\x20configuration','randomBytes','getTime','hybrid-crypto-js','get-messages','unlinkSync','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','ipc','bot','bot-','delete-alerts','Bot\x20Mgr\x20>\x20','pidRefreshToken','disconnect','reinstall-bb','init','generate','telegram','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','isIPv4MappedAddress','Setting\x20access:\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','get','Logged\x20out\x20user\x20...','Unauthorized\x20attempt\x20to\x20confirm\x20message','Starting\x20Balance\x20Bot\x20update','reason','entries','uuid','<b>Balance\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','assign','ipv6','express-fileupload','exp','store','rmSync','env','match','track','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','new','#RES#\x20','simple','1cDFsAg','showConfig','access','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','path','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','inherit','Notifications\x20enabled\x0a','debug','Orders','statSync','secret','range','temporary\x20token\x20generated','getUTCHours','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','resetHistory','compareSync','log','pidExpireLogin','Restore\x20backup\x20file\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','clients',',\x20must\x20be\x20a\x204\x20digit\x20number','settings','Idling\x20bot\x20\x20\x20|\x20Bot\x20','data','/restart\x20-\x20restart\x20bot(s)\x0a','crypto','file','/disable\x20-\x20disable\x20notifications\x0a','stringify','host','decrypt','apiKey','show','find','forEach','login\x20not\x20required','keys','callback_query','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20add\x20bot','bb/','download','RSA-OAEP','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','\x1b[35m','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','\x20|\x20','from','bbvNew','onText','/:bot/coins','91240fpqwos','Backup\x20file\x20uploaded','store-fiat','environment','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','padStart','createWriteStream','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','store-configuration','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','output-000.log','Unauthorized\x20attempt\x20to\x20show\x20configuration','getHours','Starting\x20bot\x20|\x20Bot\x20','place-order','HTML','config/','name','status','#RES#\x20if\x20running\x20locally\x0a','username','node-telegram-bot-api','=>\x20Go\x20to\x20#CYA#http://','existsSync','get-backup-files','\x20minutes','auth','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Restore\x20process\x20aborted','RSA','toggleBotMode','sha256','-performance.json','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','number','isDirectory','get-starting-balances','Alerts','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','port','remove','message','function','\x20>\x20','latestversion','mtime','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','emit','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','SIGINT','(((.+)+)+)+$','connection','allow','Login\x20rejected','Invalid\x20Telegram\x20token','getSeconds','2511788vmMAPz','get-logs','DEFLATE','timestamp','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Server','</b>\x20?','Deleted\x20Bot\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','output-002.log','Notifications\x20disabled\x0a','Node.js\x20v','Bot\x20','NTBA_FIX_319','File\x20uploaded','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','answerCallbackQuery','bbvReceive','value','Network\x20Interfaces:','running','/status\x20-\x20show\x20bot(s)\x20status\x0a','toIPv4MappedAddress','internal','getPortfolio','logout','::ffff:127.0.0.1','backup/','lastmsgemitted','push','#RES#\x20if\x20running\x20on\x20server','set','https://api.ipify.org?format=json','\x1b[36m','All\x20bots','readdirSync','2FA','graphql-request','bbPassword','timeshift','temporary\x20access\x20not\x20allowed','lowdb/adapters/FileSync','\x1b[31m','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','max','getMinutes','[ip-address]','loginRequired','reject','access\x20timeout','bb-config.json','getFullYear','constructor','<b>Telegram\x20Bot\x20Status:</b>\x0a','catch','4500020LNPJXb','sendMetricsTelegram','express','store-settings','handshake','-results.json','backup-full.zip','apiPassword','build2','sortBy','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','polling_error','Invalid\x20username\x20or\x20IP\x20address','bbUsername','then','::1','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','send','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','replace','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','storeHeadless','toggle-bot-mode','/names\x20-\x20show\x20bot\x20names\x0a','lastmsgtelegram','binary','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','backup-full','/:bot/history','stopPolling','backup','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','writeFileSync','type','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','sendMessage','Unauthorized\x20attempt\x20to\x20log\x20out','botname','exit','toString','getMonth','socket','\x1b[33m','alerts','apiSecret','telegramEnabled','uuid-random','search','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','login\x20token\x20valid','cloneDeep','headless','sendFile','generateKeyPairAsync','Allow\x20login\x20from\x20IP\x20address\x20<b>','referer','Login\x20accepted','date-fns','login\x20required','bots','verify','add-bot','yargs/yargs','hasOwnProperty','messages','Your\x20installation\x20is\x20already\x20up\x20to\x20date','privateKey','Logged\x20in\x20user\x20...','2FA\x20required','argv','once','family','0.0.0','Failed\x20to\x20download\x20','ipaddr.js','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','success','placeOrder','disabled','2FA\x20login\x20required','use','length','node-zip','updatebotmanager','telegramEvents','sort','update','mkdirSync','/:bot/performance','$1_$2_$3','chat','kill','getDate','login','reload','socket.io','Error\x20while\x20deleting\x20config\x20files:\x20','stopped','\x20only\x0a','temporaryAccessAllowed','expiry','alias','Invalid\x20authentication\x20token\x20(1)','Starting\x20Balance\x20Bot\x20reinstallation','Session\x20expired\x20for\x20user\x20...'];_0x48aa=function(){return _0x4a4291;};return _0x48aa();}!fs[_0x41dc7e(0x287)](configpath)&&fs[_0x41dc7e(0x158)](configpath);!fs[_0x41dc7e(0x287)](configbackuppath)&&fs[_0x41dc7e(0x158)](configbackuppath);!fs[_0x41dc7e(0x287)](logspath)&&fs[_0x41dc7e(0x158)](logspath);!fs[_0x41dc7e(0x287)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x41dc7e(0x287)](temppath)&&fs[_0x41dc7e(0x158)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x41dc7e(0x1df)]({'bots':[]})[_0x41dc7e(0x1dc)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x41dc7e(0x1df)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x41dc7e(0x149),'onepagemode':![]}})[_0x41dc7e(0x1dc)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x41dc7e(0x1df)]({'secure':{},'blacklist':[]})[_0x41dc7e(0x1dc)]();let crypt=new Crypt({'md':_0x41dc7e(0x28f),'rsaStandard':_0x41dc7e(0x266)});const saltRounds=0xa,mixpanel=Mixpanel[_0x41dc7e(0x21b)](_0x41dc7e(0x1f3),{'host':_0x41dc7e(0x16b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x41dc7e(0x1f4)]&&settings[_0x41dc7e(0x1f4)]!=''&&settings['telegramUsername']&&settings[_0x41dc7e(0x18f)]!='')initTelegram();const parseColor=(_0x1b0ef8,_0x34e28b)=>{const _0x77af77=_0x41dc7e,_0x44eb84=/#[A-Z]{3}#/g;if(typeof _0x1b0ef8==_0x77af77(0x1b6)){!_0x34e28b?_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](_0x44eb84,''):(_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](/#BLU#/g,'\x1b[34m'),_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](/#RED#/g,_0x77af77(0x2d3)),_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](/#YEL#/g,_0x77af77(0x12b)),_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](/#MAG#/g,_0x77af77(0x268)),_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](/#CYA#/g,_0x77af77(0x2ca)),_0x1b0ef8=_0x1b0ef8[_0x77af77(0x113)](/#RES#/g,_0x77af77(0x1cf)));;}return _0x1b0ef8;},logger={'screen':_0x653992=>{const _0x4e502b=_0x41dc7e;console[_0x4e502b(0x24a)](parseColor(_0x653992,!![]));},'simple':_0x4ef7d5=>{const _0x297249=_0x41dc7e;console[_0x297249(0x24a)](parseColor(_0x4ef7d5,!![])),loggerfile[_0x297249(0x1dc)](util[_0x297249(0x1eb)](parseColor(_0x4ef7d5,![]))+'\x0a');},'full':async _0x4fc554=>{const _0x40d490=_0x41dc7e,_0x549837=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4fc554;console[_0x40d490(0x24a)](parseColor(_0x549837,!![])),loggerfile[_0x40d490(0x1dc)](util[_0x40d490(0x1eb)](parseColor(_0x549837,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x40d490(0x155)]!=_0x40d490(0x1d3))await tgBot[_0x40d490(0x124)](settings['telegramChatId'],_0x40d490(0x217)+parseColor(_0x4fc554,![]))[_0x40d490(0x2e0)](_0xb82b69=>{telegramError(_0xb82b69);});},'debug':async(_0x6ec24c,_0x44aa02='')=>{const _0x5c8a2=_0x41dc7e,_0x367d6e=getTimeStamp()+_0x5c8a2(0x1f2)+_0x6ec24c;if(debugging)console['log'](parseColor(_0x367d6e,!![]));loggerfile[_0x5c8a2(0x1dc)](util['format'](parseColor(_0x367d6e,![]))+'\x0a');if(_0x44aa02){if(debugging)console[_0x5c8a2(0x24a)](_0x44aa02);loggerfile[_0x5c8a2(0x1dc)](util[_0x5c8a2(0x1eb)](_0x44aa02)+'\x0a');}}};process['on']('uncaughtException',function(_0x2928be){logger['simple'](_0x2928be);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x41dc7e(0x2e3)),app=express(),http=require(_0x41dc7e(0x1de))[_0x41dc7e(0x17a)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x41dc7e(0x222)](_0x41dc7e(0x1e7),async(_0x37f8e8,_0x4c238b)=>{const _0x5b43bd=_0x41dc7e,_0x4555bb=_0x37f8e8[_0x5b43bd(0x1e6)][_0x5b43bd(0x122)],_0x4b8eed=getClientsWithBotID(_0x5b43bd(0x19e)),_0x3bf2ff=_0x37f8e8['headers'][_0x5b43bd(0x228)],_0x39bb15=timelyDecrypt(_0x3bf2ff,![]),_0x2044ea=_0x4b8eed['find'](_0x1829f1=>_0x1829f1[_0x5b43bd(0x228)]==_0x39bb15);if(_0x2044ea){const _0x49bbc2=normalizeIP(_0x37f8e8[_0x5b43bd(0x12a)]['remoteAddress'])['store'],_0x1379d9=_0x37f8e8[_0x5b43bd(0x183)][_0x5b43bd(0x1e8)];if(validateAccess(_0x1379d9,_0x39bb15,_0x49bbc2)[_0x5b43bd(0x2a5)])_0x4555bb==_0x5b43bd(0x11f)&&await backupConfigFiles(),await zipFiles(_0x4555bb),_0x4c238b[_0x5b43bd(0x265)](zippath+(_0x4555bb+_0x5b43bd(0x1ec)),_0x5bd0ba=>{const _0x4686fd=_0x5b43bd;_0x5bd0ba&&(logger[_0x4686fd(0x1db)](_0x4686fd(0x14a)+_0x4555bb),logger[_0x4686fd(0x237)](_0x5bd0ba));});else logger['full'](_0x5b43bd(0x188)+_0x4555bb+_0x5b43bd(0x1be));}else logger[_0x5b43bd(0x1db)](_0x5b43bd(0x188)+_0x4555bb+_0x5b43bd(0x1b4));}),app['post'](_0x41dc7e(0x208),async(_0x2aec46,_0x32ecc2)=>{const _0x581b95=_0x41dc7e,_0x4bd476=getClientsWithBotID(_0x581b95(0x19e)),_0x57b57e=_0x2aec46[_0x581b95(0x183)][_0x581b95(0x228)],_0x19e3b1=timelyDecrypt(_0x57b57e,![]),_0x5d9ffa=_0x4bd476[_0x581b95(0x25d)](_0x449589=>_0x449589['uuid']==_0x19e3b1);logger[_0x581b95(0x240)](_0x581b95(0x271));if(_0x5d9ffa){const _0x34a763=normalizeIP(_0x2aec46[_0x581b95(0x12a)][_0x581b95(0x1a2)])[_0x581b95(0x22f)],_0x2a190e=_0x2aec46[_0x581b95(0x183)][_0x581b95(0x1e8)];if(validateAccess(_0x2a190e,_0x19e3b1,_0x34a763)[_0x581b95(0x2a5)]){if(_0x2aec46[_0x581b95(0x18a)]){const _0x4c29a1=_0x2aec46[_0x581b95(0x18a)][_0x581b95(0x1f0)];await _0x4c29a1['mv'](temppath+_0x4c29a1[_0x581b95(0x281)]),_0x32ecc2[_0x581b95(0x2f2)]({'status':!![],'message':_0x581b95(0x2b7)});const _0xd0cb43=getBotsWithMode();_0xd0cb43[_0x581b95(0x152)]>0x0?confirmRestore(temppath,_0x4c29a1[_0x581b95(0x281)]):unzipFile(temppath,_0x4c29a1[_0x581b95(0x281)]);}}else logger[_0x581b95(0x1db)](_0x581b95(0x296));}else logger[_0x581b95(0x1db)](_0x581b95(0x291));}),app[_0x41dc7e(0x151)](express[_0x41dc7e(0x1d2)](path[_0x41dc7e(0x182)](__dirname,bbpath2,'build2'))),app[_0x41dc7e(0x151)](express[_0x41dc7e(0x1d2)](path[_0x41dc7e(0x182)](__dirname,bbpath2,'build'))),app[_0x41dc7e(0x222)]('/',function(_0x4e3b24,_0x159a8a){const _0x125945=_0x41dc7e;_0x159a8a['sendFile'](path[_0x125945(0x182)](__dirname,bbpath2,_0x125945(0x2e9),_0x125945(0x1ad)));}),app['get'](_0x41dc7e(0x20a),function(_0xd5e417,_0x311c6d){const _0x27f6ef=_0x41dc7e;_0x311c6d['sendFile'](path[_0x27f6ef(0x182)](__dirname,bbpath2,_0x27f6ef(0x171),_0x27f6ef(0x1ad)));}),app[_0x41dc7e(0x222)]('/:bot/portfolio',(_0x376398,_0x5e3a39)=>{const _0x5a2a5d=_0x41dc7e;_0x5e3a39[_0x5a2a5d(0x135)](path[_0x5a2a5d(0x182)](__dirname,bbpath2,_0x5a2a5d(0x171),_0x5a2a5d(0x1ad)));}),app['get'](_0x41dc7e(0x159),(_0x4b848b,_0x34a682)=>{const _0x150dd6=_0x41dc7e;_0x34a682[_0x150dd6(0x135)](path[_0x150dd6(0x182)](__dirname,bbpath2,_0x150dd6(0x171),_0x150dd6(0x1ad)));}),app[_0x41dc7e(0x222)](_0x41dc7e(0x26f),(_0x172be1,_0xd41c4e)=>{const _0x1a3187=_0x41dc7e;_0xd41c4e[_0x1a3187(0x135)](path['join'](__dirname,bbpath2,_0x1a3187(0x171),_0x1a3187(0x1ad)));}),app[_0x41dc7e(0x222)](_0x41dc7e(0x11d),(_0x4c82a8,_0x4f18c3)=>{const _0x5e4562=_0x41dc7e;_0x4f18c3[_0x5e4562(0x135)](path[_0x5e4562(0x182)](__dirname,bbpath2,_0x5e4562(0x171),_0x5e4562(0x1ad)));}),app['get']('/:bot/configuration',(_0x47befa,_0x4d0a23)=>{const _0x3fab51=_0x41dc7e;_0x4d0a23[_0x3fab51(0x135)](path['join'](__dirname,bbpath2,_0x3fab51(0x171),'index.html'));}),app[_0x41dc7e(0x222)](_0x41dc7e(0x176),(_0x465bc1,_0x5400f9)=>{const _0x48e5b2=_0x41dc7e;_0x5400f9[_0x48e5b2(0x135)](path[_0x48e5b2(0x182)](__dirname,bbpath2,'build',_0x48e5b2(0x1ad)));});if(HOST)http[_0x41dc7e(0x187)](PORT,HOST);else http[_0x41dc7e(0x187)](PORT);const io=require(_0x41dc7e(0x160))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x11bd5b=_0x41dc7e;let _0x50ddf6=_0x11bd5b(0x2d8);const _0x26601a=networkInterfaces(),_0x2ad6b4={};for(const _0x103b91 of Object[_0x11bd5b(0x260)](_0x26601a)){for(const _0x232d40 of _0x26601a[_0x103b91]){if((_0x232d40[_0x11bd5b(0x148)]=='IPv4'||_0x232d40[_0x11bd5b(0x148)]==0x4)&&!_0x232d40[_0x11bd5b(0x2c0)]){const _0x2b5f5a=ipaddr[_0x11bd5b(0x198)](_0x232d40[_0x11bd5b(0x17b)])[_0x11bd5b(0x244)]();_0x2b5f5a!=_0x11bd5b(0x1c4)&&(!_0x2ad6b4[_0x103b91]&&(_0x2ad6b4[_0x103b91]=[]),_0x2ad6b4[_0x103b91][_0x11bd5b(0x2c6)](_0x232d40[_0x11bd5b(0x17b)]),_0x50ddf6=_0x232d40[_0x11bd5b(0x17b)]);}}}return{'serverip':_0x50ddf6,'netinterfaces':_0x2ad6b4};}function _0x5afd(_0x45630f,_0x431d73){const _0x24e63f=_0x48aa();return _0x5afd=function(_0x3d8357,_0x3b2c7d){_0x3d8357=_0x3d8357-0x113;let _0x48aad2=_0x24e63f[_0x3d8357];return _0x48aad2;},_0x5afd(_0x45630f,_0x431d73);}async function startServer(){const _0x3841a2=_0x41dc7e,{serverip:_0xc72f53,netinterfaces:_0x38332f}=getServerIP();logger[_0x3841a2(0x237)](''),logger[_0x3841a2(0x237)](_0x3841a2(0x1e2)),await logger[_0x3841a2(0x1db)](_0x3841a2(0x189)+serverversion+_0x3841a2(0x236)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x3841a2(0x1ee)+PORT+_0x3841a2(0x283))+(_0x3841a2(0x286)+_0xc72f53+':'+PORT+_0x3841a2(0x2c7))),logger[_0x3841a2(0x237)](_0x3841a2(0x1e2));if(config['length']!=0x0)for(const _0x4bce77 of config){if(_0x4bce77['status']=='enabled'||_0x4bce77[_0x3841a2(0x282)]==_0x3841a2(0x235))await logger[_0x3841a2(0x1db)](_0x3841a2(0x27d)+_0x4bce77[_0x3841a2(0x1d6)]+'\x20|\x20'+_0x4bce77[_0x3841a2(0x126)]),startBot([_0x4bce77[_0x3841a2(0x1d6)],userID],{'cwd':bbpath},function(_0x2d08ef){const _0x2159cb=_0x3841a2;if(_0x2d08ef)logger[_0x2159cb(0x1db)](_0x2d08ef);});else(_0x4bce77[_0x3841a2(0x282)]==_0x3841a2(0x14f)||_0x4bce77[_0x3841a2(0x282)]==_0x3841a2(0x200))&&await logger[_0x3841a2(0x1db)](_0x3841a2(0x252)+_0x4bce77[_0x3841a2(0x1d6)]+_0x3841a2(0x26b)+_0x4bce77[_0x3841a2(0x126)]);}else!newBot&&logger[_0x3841a2(0x237)](_0x3841a2(0x2ad));if(newBot)addBot();logger[_0x3841a2(0x237)](_0x3841a2(0x1e2)),logger[_0x3841a2(0x237)](''),await logger[_0x3841a2(0x240)](_0x3841a2(0x2b4)+nodeversion),await logger['debug'](_0x3841a2(0x2bc),_0x38332f);}function startSocket(){const _0x11fb9f=_0x41dc7e;io['on'](_0x11fb9f(0x2a4),_0x5927a7=>{const _0x3dd55a=_0x11fb9f;let _0x2bbee2,_0x10f1b7,_0x360e53,_0x34c412,_0x160074;const _0x3e8c4f=_0x5927a7[_0x3dd55a(0x2e5)][_0x3dd55a(0x183)][_0x3dd55a(0x138)];_0x10f1b7=_0x3e8c4f[_0x3dd55a(0x232)](/bot[0-9]{3}/);if(_0x10f1b7)_0x360e53=_0x10f1b7[0x0]['match'](/[0-9]{3}/);if(_0x360e53)_0x2bbee2=_0x360e53[0x0];else _0x2bbee2=_0x3dd55a(0x19e);const _0x59eded=_0x5927a7[_0x3dd55a(0x2e5)][_0x3dd55a(0x28a)]['encryptedUuid'];if(!_0x59eded)_0x5927a7[_0x3dd55a(0x2a0)](_0x3dd55a(0x282),{'publicKey':secure['publicKey']});else{_0x34c412=timelyDecrypt(_0x59eded,![]);if(!_0x34c412)_0x5927a7[_0x3dd55a(0x2a0)](_0x3dd55a(0x282),{'publicKey':secure[_0x3dd55a(0x1fa)]});else{_0x160074=normalizeIP(_0x5927a7[_0x3dd55a(0x16a)]['remoteAddress'])[_0x3dd55a(0x22f)];if(!devices[_0x34c412])devices[_0x34c412]={'uuid':_0x34c412,'access':{'token':null}};devices[_0x34c412]['ip']=_0x160074;const _0x4cfd31=addClient(_0x5927a7['id'],_0x34c412,_0x2bbee2);setAccess(_0x4cfd31),emitMessages(),_0x5927a7['on'](_0x3dd55a(0x15e),_0x444521=>{const _0x4a8647=_0x3dd55a,_0x1ecf9a=timelyDecrypt(_0x444521[_0x4a8647(0x209)]);if(_0x1ecf9a){_0x444521={'username':_0x444521[_0x4a8647(0x284)],'password':_0x1ecf9a},devices[_0x34c412][_0x4a8647(0x23a)]=validateCredentials(_0x444521,_0x34c412);if(devices[_0x34c412]['access']['allow']==![]&&devices[_0x34c412][_0x4a8647(0x23a)][_0x4a8647(0x226)]=='2FA\x20login\x20required')_0x5927a7[_0x4a8647(0x2a0)]('status',{'access':devices[_0x34c412]['access']}),loginAccess2FA(_0x34c412,_0x160074);else{if(devices[_0x34c412]['access']['allow']==![]&&devices[_0x34c412]['access'][_0x4a8647(0x226)]==_0x4a8647(0x184))_0x5927a7[_0x4a8647(0x2a0)](_0x4a8647(0x282),{'access':devices[_0x34c412][_0x4a8647(0x23a)]});else devices[_0x34c412]['access'][_0x4a8647(0x2a5)]&&devices[_0x34c412][_0x4a8647(0x23a)][_0x4a8647(0x226)]==_0x4a8647(0x191)&&(getClientsWithUuid(_0x34c412)['forEach'](_0x341a39=>{setAccess(_0x341a39);}),logger[_0x4a8647(0x240)](_0x4a8647(0x144)+_0x34c412[_0x4a8647(0x1ff)](-0x8)),setTokenRefresh(_0x34c412),setSessionTimeout(_0x4a8647(0x15e),_0x34c412));}}else logger[_0x4a8647(0x1db)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x5927a7['on'](_0x3dd55a(0x193),()=>{resetPassword();}),_0x5927a7['on'](_0x3dd55a(0x219),_0x5153cc=>{removeClient(_0x5927a7['id']);}),_0x2bbee2==_0x3dd55a(0x19e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x32e642){const _0x477f16=_0x41dc7e;if(_0x32e642!=_0x477f16(0x19e)&&config[_0x477f16(0x25b)]!=''){if(pid[_0x32e642])pid[_0x32e642]['send']({'function':_0x477f16(0x1c1),'args':null});}_0x32e642!='botmanager'&&broadcastToBots(_0x477f16(0x13c),JSON['stringify'](config));}function reloadBotManager(){const _0x1e3d19=_0x41dc7e;getClientsWithBotID(_0x1e3d19(0x19e))[_0x1e3d19(0x25e)](_0x37bcd4=>{const _0x23c8d7=_0x1e3d19;getSocket(_0x37bcd4['id'])['emit'](_0x23c8d7(0x282),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x58c40b){const _0x5ae3fa=_0x41dc7e;return io[_0x5ae3fa(0x1ed)][_0x5ae3fa(0x1ed)][_0x5ae3fa(0x222)](_0x58c40b);}function setAccess(_0xf75f2a){const _0x4e1c88=_0x41dc7e,_0x23d1ec=getSocket(_0xf75f2a['id']),_0x135300=_0xf75f2a[_0x4e1c88(0x228)],_0xc7b3d=_0xf75f2a[_0x4e1c88(0x214)];devices[_0x135300]['access']=validateAccess(devices[_0x135300][_0x4e1c88(0x23a)]['token'],_0x135300),logger['debug'](_0x4e1c88(0x220)+devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x226)]+'\x20|\x20client:\x20...'+_0xf75f2a['id']['slice'](-0x8)+_0x4e1c88(0x1f7)+_0x135300[_0x4e1c88(0x1ff)](-0x8)),_0x23d1ec['join'](_0x135300);if(devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x2a5)]){_0x23d1ec[_0x4e1c88(0x182)](_0xc7b3d);if(_0xc7b3d=='botmanager')initializeSocketBotManager(_0x23d1ec);else initializeSocketBot(_0x23d1ec);initClient(_0xc7b3d);}devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x1d8)]&&devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x226)]==_0x4e1c88(0x245)&&setSessionTimeout(_0x4e1c88(0x2cd),_0x135300),devices[_0x135300]['access']['token']&&devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x226)]==_0x4e1c88(0x204)&&setSessionTimeout('login',_0x135300),_0x23d1ec['emit'](_0x4e1c88(0x282),{'status':_0xf75f2a['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x135300][_0x4e1c88(0x23a)],'externalip':devices[_0x135300]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x2a5)]==![]&&devices[_0x135300][_0x4e1c88(0x23a)][_0x4e1c88(0x226)]==_0x4e1c88(0x145)&&temporaryAccess2FA(_0x135300,devices[_0x135300]['ip']);}function setSessionTimeout(_0x19e27e,_0x462abd){const _0x10bd40=_0x41dc7e;let _0x303a53;if(_0x19e27e=='login')_0x303a53=loginExpiry*0x3c*0x3e8;else _0x303a53=devices[_0x462abd]['telegramIpApproval'][_0x10bd40(0x165)]*0x3c*0x3e8-(new Date()[_0x10bd40(0x20e)]()-devices[_0x462abd][_0x10bd40(0x1a1)][_0x10bd40(0x2ac)]);if(devices[_0x462abd]['pidExpireLogin'])clearTimeout(devices[_0x462abd]['pidExpireLogin']);devices[_0x462abd]['pidExpireLogin']=setTimeout(()=>{const _0xce93ad=_0x10bd40;if(devices[_0x462abd][_0xce93ad(0x218)])clearTimeout(devices[_0x462abd][_0xce93ad(0x218)]);removeSocketListeners(_0x462abd),addBlacklist(_0x462abd),devices[_0x462abd][_0xce93ad(0x1a1)]=null,devices[_0x462abd]['telegram2FaApproval']=null,devices[_0x462abd]['access']['token']=null,logger['debug'](_0xce93ad(0x169)+_0x462abd[_0xce93ad(0x1ff)](-0x8)),devices[_0x462abd][_0xce93ad(0x23a)]=validateAccess(devices[_0x462abd][_0xce93ad(0x23a)]['token'],_0x462abd),!(devices[_0x462abd][_0xce93ad(0x23a)][_0xce93ad(0x2a5)]&&devices[_0x462abd][_0xce93ad(0x23a)]['reason']=='login\x20not\x20required')&&(_0x19e27e==_0xce93ad(0x15e)?io['to'](_0x462abd)[_0xce93ad(0x2a0)]('status',{'access':{'allow':![],'reason':_0xce93ad(0x2db),'token':null}}):io['to'](_0x462abd)[_0xce93ad(0x2a0)](_0xce93ad(0x282),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x462abd][_0xce93ad(0x23a)]['token']=null;},_0x303a53);}function setTokenRefresh(_0x21b82d){const _0x129f87=_0x41dc7e;if(devices[_0x21b82d][_0x129f87(0x218)])clearTimeout(devices[_0x21b82d]['pidRefreshToken']);devices[_0x21b82d]['pidRefreshToken']=setTimeout(()=>{const _0x2fa7d6=_0x129f87;getClientsWithUuid(_0x21b82d)[_0x2fa7d6(0x152)]!=0x0?(devices[_0x21b82d][_0x2fa7d6(0x23a)]=refreshToken(_0x21b82d),io['to'](_0x21b82d)['emit'](_0x2fa7d6(0x282),{'status':_0x2fa7d6(0x1c8),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x21b82d]['access'],'externalip':devices[_0x21b82d]['ip'],'publicKey':secure[_0x2fa7d6(0x1fa)],'validInstallation':validInstallation}),setTokenRefresh(_0x21b82d)):clearTimeout(devices[_0x21b82d][_0x2fa7d6(0x218)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2ac44c){const _0x3cf9c8=_0x41dc7e,_0x4710af=getClient(_0x2ac44c['id'])[_0x3cf9c8(0x228)];_0x2ac44c['emit'](_0x3cf9c8(0x13c),config),_0x2ac44c[_0x3cf9c8(0x2a0)](_0x3cf9c8(0x251),cleanSettings()),_0x2ac44c['on'](_0x3cf9c8(0x13e),_0x488a9f=>{const _0x40fe26=_0x3cf9c8;if(validateAccess(_0x488a9f,_0x4710af)[_0x40fe26(0x2a5)])addBot();else logger[_0x40fe26(0x1db)](_0x40fe26(0x263));}),_0x2ac44c['on'](_0x3cf9c8(0x16d),(_0x5908af,_0x7dc623)=>{const _0xf90c8f=_0x3cf9c8;if(validateAccess(_0x7dc623,_0x4710af)[_0xf90c8f(0x2a5)])toggleBot(_0x5908af['botID'],_0x5908af['status'],_0x5908af['live']);else logger['full'](_0xf90c8f(0x1d7));}),_0x2ac44c['on'](_0x3cf9c8(0x116),(_0x549ef5,_0x10b970)=>{const _0x3ca06e=_0x3cf9c8;if(validateAccess(_0x10b970,_0x4710af)[_0x3ca06e(0x2a5)])toggleBotMode(_0x549ef5);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2ac44c['on'](_0x3cf9c8(0x1c0),(_0x2973a4,_0x3b6785)=>{const _0x377cc5=_0x3cf9c8;if(validateAccess(_0x3b6785,_0x4710af)[_0x377cc5(0x2a5)])deleteBot(_0x2973a4);else logger[_0x377cc5(0x1db)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x2ac44c['on'](_0x3cf9c8(0x2e4),(_0x1c4d41,_0x4ecd2d)=>{const _0x5ecfae=_0x3cf9c8;if(validateAccess(_0x4ecd2d,_0x4710af)[_0x5ecfae(0x2a5)])storeSettings(_0x1c4d41,!![]);else logger[_0x5ecfae(0x1db)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2ac44c['on'](_0x3cf9c8(0x1cb),_0x4ad10d=>{const _0x39375b=_0x3cf9c8;if(validateAccess(_0x4ad10d,_0x4710af)[_0x39375b(0x2a5)])updateBB(_0x39375b(0x157));else logger['full'](_0x39375b(0x2eb));}),_0x2ac44c['on'](_0x3cf9c8(0x21a),_0x381bf6=>{const _0x2bfd66=_0x3cf9c8;if(validateAccess(_0x381bf6,_0x4710af)[_0x2bfd66(0x2a5)])updateBB('reinstall');else logger['full'](_0x2bfd66(0x22a));}),_0x2ac44c['on'](_0x3cf9c8(0x288),_0xb5fec7=>{const _0x30517c=_0x3cf9c8;if(validateAccess(_0xb5fec7,_0x4710af)[_0x30517c(0x2a5)]){const _0x4d68df=getClient(_0x2ac44c['id']);if(_0x4d68df)getBackupFiles(_0x4d68df[_0x30517c(0x228)]);else logger[_0x30517c(0x1db)](_0x30517c(0x11b));}else logger[_0x30517c(0x1db)](_0x30517c(0x269));}),_0x2ac44c['on'](_0x3cf9c8(0x1bf),(_0x3ddb6a,_0x365a9)=>{const _0xdb66fc=_0x3cf9c8;if(validateAccess(_0x365a9,_0x4710af)['allow'])restoreBackupFile(_0x3ddb6a);else logger[_0xdb66fc(0x1db)](_0xdb66fc(0x247));}),_0x2ac44c['on'](_0x3cf9c8(0x210),_0x3fdcf4=>{const _0x2bfedd=_0x3cf9c8;if(validateAccess(_0x3fdcf4,_0x4710af)[_0x2bfedd(0x2a5)])getMessages();else logger[_0x2bfedd(0x1db)](_0x2bfedd(0x190));}),_0x2ac44c['on']('confirm-message',(_0x33fcb4,_0x345dcd)=>{const _0x5b9fd7=_0x3cf9c8;if(validateAccess(_0x345dcd,_0x4710af)[_0x5b9fd7(0x2a5)])confirmMessage(_0x33fcb4);else logger[_0x5b9fd7(0x1db)](_0x5b9fd7(0x224));}),_0x2ac44c['on'](_0x3cf9c8(0x2c2),_0x1246e1=>{const _0x4b82df=_0x3cf9c8;if(validateAccess(_0x1246e1,_0x4710af)[_0x4b82df(0x2a5)]){if(devices[_0x4710af][_0x4b82df(0x218)])clearTimeout(devices[_0x4710af][_0x4b82df(0x218)]);if(devices[_0x4710af][_0x4b82df(0x24b)])clearTimeout(devices[_0x4710af][_0x4b82df(0x24b)]);removeSocketListeners(getClient(_0x2ac44c['id'])[_0x4b82df(0x228)]),addBlacklist(_0x4710af),devices[_0x4710af][_0x4b82df(0x1a1)]=null,devices[_0x4710af]['telegram2FaApproval']=null,devices[_0x4710af][_0x4b82df(0x23a)][_0x4b82df(0x1d8)]=null,logger['debug'](_0x4b82df(0x223)+_0x4710af[_0x4b82df(0x1ff)](-0x8)),io['to'](getClient(_0x2ac44c['id'])[_0x4b82df(0x228)])[_0x4b82df(0x2a0)](_0x4b82df(0x282),{'access':{'allow':![],'reason':_0x4b82df(0x1fb),'token':null}});}else logger['full'](_0x4b82df(0x125));});}function initializeSocketBot(_0x3ef6b2){const _0x1b5228=_0x41dc7e,_0x2c5986=getClient(_0x3ef6b2['id'])[_0x1b5228(0x214)],_0x15224f=getClient(_0x3ef6b2['id'])[_0x1b5228(0x228)];_0x3ef6b2['on'](_0x1b5228(0x2aa),(_0x47e94c,_0x3cd49e)=>{const _0x460b32=_0x1b5228;if(validateAccess(_0x3cd49e,_0x15224f)[_0x460b32(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986][_0x460b32(0x2f2)]({'function':'emitHistory','args':_0x47e94c});}else logger[_0x460b32(0x1db)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x3ef6b2['on'](_0x1b5228(0x216),(_0x3ee6c3,_0x343699)=>{const _0x3439ac=_0x1b5228;if(validateAccess(_0x343699,_0x15224f)['allow']){if(pid[_0x2c5986])pid[_0x2c5986][_0x3439ac(0x2f2)]({'function':_0x3439ac(0x1d0),'args':_0x3ee6c3});}else logger['full'](_0x3439ac(0x221));}),_0x3ef6b2['on']('get-portfolio',(_0x4f1d69,_0x2b9a51)=>{const _0x4b9ebb=_0x1b5228;if(validateAccess(_0x2b9a51,_0x15224f)['allow']){if(pid[_0x2c5986])pid[_0x2c5986][_0x4b9ebb(0x2f2)]({'function':_0x4b9ebb(0x2c1),'args':_0x4f1d69});}else logger['full'](_0x4b9ebb(0x1a9));}),_0x3ef6b2['on'](_0x1b5228(0x278),(_0x3f6178,_0x24547e)=>{const _0x1a030f=_0x1b5228;if(validateAccess(_0x24547e,_0x15224f)[_0x1a030f(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986][_0x1a030f(0x2f2)]({'function':'storeConfiguration','args':_0x3f6178});}else logger['full'](_0x1a030f(0x20c));}),_0x3ef6b2['on']('store-headless',(_0xf63506,_0x201b0c)=>{const _0x5648fa=_0x1b5228;if(validateAccess(_0x201b0c,_0x15224f)[_0x5648fa(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986][_0x5648fa(0x2f2)]({'function':_0x5648fa(0x115),'args':_0xf63506});}else logger[_0x5648fa(0x1db)](_0x5648fa(0x14c));}),_0x3ef6b2['on'](_0x1b5228(0x272),(_0x54e6d6,_0x34de8e)=>{const _0x430bf6=_0x1b5228;if(validateAccess(_0x34de8e,_0x15224f)[_0x430bf6(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986]['send']({'function':_0x430bf6(0x19b),'args':_0x54e6d6});}else logger['full'](_0x430bf6(0x120));}),_0x3ef6b2['on']('reset-history',_0x11eb5e=>{const _0x814b6f=_0x1b5228;if(validateAccess(_0x11eb5e,_0x15224f)['allow']){if(pid[_0x2c5986])pid[_0x2c5986][_0x814b6f(0x2f2)]({'function':_0x814b6f(0x248),'args':null});}else logger[_0x814b6f(0x1db)](_0x814b6f(0x11a));}),_0x3ef6b2['on'](_0x1b5228(0x294),_0xe7eac7=>{const _0x2097eb=_0x1b5228;if(validateAccess(_0xe7eac7,_0x15224f)['allow']){if(pid[_0x2c5986])pid[_0x2c5986][_0x2097eb(0x2f2)]({'function':'getStartingBalances','args':null});}else logger[_0x2097eb(0x1db)](_0x2097eb(0x279));}),_0x3ef6b2['on'](_0x1b5228(0x27e),(_0x4df02e,_0x45a278)=>{const _0x43811e=_0x1b5228;if(validateAccess(_0x45a278,_0x15224f)[_0x43811e(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986][_0x43811e(0x2f2)]({'function':_0x43811e(0x14e),'args':_0x4df02e});}else logger[_0x43811e(0x1db)](_0x43811e(0x26a));}),_0x3ef6b2['on']('cancel-loading',_0x16637f=>{const _0x4580fa=_0x1b5228;if(validateAccess(_0x16637f,_0x15224f)[_0x4580fa(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986][_0x4580fa(0x2f2)]({'function':'cancelLoading','args':null});}else logger['full'](_0x4580fa(0x24e));}),_0x3ef6b2['on']('show-config',_0x567d7e=>{const _0x1d3e29=_0x1b5228;if(validateAccess(_0x567d7e,_0x15224f)[_0x1d3e29(0x2a5)]){if(pid[_0x2c5986])pid[_0x2c5986][_0x1d3e29(0x2f2)]({'function':_0x1d3e29(0x239),'args':null});}else logger[_0x1d3e29(0x1db)](_0x1d3e29(0x27b));}),_0x3ef6b2['on'](_0x1b5228(0x1cb),_0x57db0e=>{const _0x3809da=_0x1b5228;if(validateAccess(_0x57db0e,_0x15224f)[_0x3809da(0x2a5)])updateBB(_0x3809da(0x157));else logger[_0x3809da(0x1db)](_0x3809da(0x2eb));}),_0x3ef6b2['on'](_0x1b5228(0x210),_0xa9527=>{const _0x2582c2=_0x1b5228;if(validateAccess(_0xa9527,_0x15224f)['allow'])getMessages();else logger[_0x2582c2(0x1db)](_0x2582c2(0x190));}),_0x3ef6b2['on']('confirm-message',(_0x34b3b9,_0x161c3b)=>{const _0x63437=_0x1b5228;if(validateAccess(_0x161c3b,_0x15224f)[_0x63437(0x2a5)])confirmMessage(_0x34b3b9);else logger['full'](_0x63437(0x224));}),_0x3ef6b2['on']('logout',_0x5a1444=>{const _0x4f6029=_0x1b5228;if(validateAccess(_0x5a1444,_0x15224f)['allow']){if(devices[_0x15224f][_0x4f6029(0x218)])clearTimeout(devices[_0x15224f][_0x4f6029(0x218)]);if(devices[_0x15224f]['pidExpireLogin'])clearTimeout(devices[_0x15224f][_0x4f6029(0x24b)]);removeSocketListeners(getClient(_0x3ef6b2['id'])[_0x4f6029(0x228)]),addBlacklist(_0x15224f),devices[_0x15224f]['telegramIpApproval']=null,devices[_0x15224f][_0x4f6029(0x20b)]=null,devices[_0x15224f][_0x4f6029(0x23a)][_0x4f6029(0x1d8)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x15224f['slice'](-0x8)),io['to'](getClient(_0x3ef6b2['id'])[_0x4f6029(0x228)])[_0x4f6029(0x2a0)](_0x4f6029(0x282),{'access':{'allow':![],'reason':_0x4f6029(0x1fb),'token':null}});}else logger[_0x4f6029(0x1db)](_0x4f6029(0x125));});}function removeSocketListeners(_0x189652){const _0x3acdd4=_0x41dc7e;getClientsWithUuid(_0x189652)[_0x3acdd4(0x25e)](_0x31a67d=>{getSocket(_0x31a67d['id'])['removeAllListeners']();});}function cleanSettings(){const _0x2f4d6f=_0x41dc7e;let _0x315b96=settings;return settings[_0x2f4d6f(0x1f4)]&&settings[_0x2f4d6f(0x1f4)]!=''&&(_0x315b96={..._0x315b96,'telegramToken':_0x2f4d6f(0x1ea)}),settings['bbPassword']&&settings[_0x2f4d6f(0x2cf)]!=''&&(_0x315b96={..._0x315b96,'bbPassword':_0x2f4d6f(0x1ea)}),(settings[_0x2f4d6f(0x2cf)]&&settings[_0x2f4d6f(0x2cf)]==_0x2f4d6f(0x197)||settings[_0x2f4d6f(0x1f4)]&&settings[_0x2f4d6f(0x1f4)]==_0x2f4d6f(0x197))&&(_0x315b96={..._0x315b96,'restored':{'password':settings[_0x2f4d6f(0x2cf)]=='***','telegram':settings[_0x2f4d6f(0x1f4)]==_0x2f4d6f(0x197)}}),_0x315b96;}async function updateBB(_0x395c34){const _0x221e05=_0x41dc7e;await backupConfigFiles(),installingUpdate=!![],config[_0x221e05(0x25e)](_0x494ecd=>{const _0x32d722=_0x221e05;restartBot(_0x494ecd[_0x32d722(0x1d6)]);});if(_0x395c34=='update')process[_0x221e05(0x2f2)]({'update':!![],'environment':environment},_0xba5c94=>{});else _0x395c34==_0x221e05(0x18b)&&process[_0x221e05(0x2f2)]({'reinstall':!![],'environment':environment},_0x21e6f4=>{});}function startBot(_0x1f6d55,_0x4ad2f3,_0x25b3ac){const _0x2188e3=_0x41dc7e;if(debugging)_0x1f6d55['push']('-d');let _0x1b9a09=![];const _0x3226d0=_0x1f6d55[0x0];_0x4ad2f3={..._0x4ad2f3,'stdio':['inherit',_0x2188e3(0x23e),_0x2188e3(0x23e),_0x2188e3(0x213)]},pid[_0x3226d0]=childProcess['fork'](botfile,_0x1f6d55,_0x4ad2f3),pid[_0x3226d0]['on'](_0x2188e3(0x29a),_0x112f0d=>{const _0x3445ed=_0x2188e3;switch(Object[_0x3445ed(0x260)](_0x112f0d)[0x0]){case _0x3445ed(0x126):updateBotName(_0x3226d0,_0x112f0d[_0x3445ed(0x126)]);break;case _0x3445ed(0x154):updateBotManager();break;case'status':updateStatus(_0x3226d0,_0x112f0d[_0x3445ed(0x282)]);break;case'live':updateLive(_0x3226d0,_0x112f0d[_0x3445ed(0x1c7)]);break;case _0x3445ed(0x180):updateLive(_0x3226d0,_0x112f0d[_0x3445ed(0x180)]),io['to'](_0x3226d0)[_0x3445ed(0x2a0)](_0x3445ed(0x282),{'access':{'allow':![],'reason':_0x3445ed(0x15f),'token':null}});break;case _0x3445ed(0x1fe):_0x112f0d[_0x3445ed(0x1fe)]=='restart'&&restartBot(_0x3226d0);_0x112f0d[_0x3445ed(0x1fe)]==_0x3445ed(0x15c)&&toggleBot(_0x3226d0,'disabled','stopped');break;case _0x3445ed(0x21d):sendTelegram(_0x3226d0,_0x112f0d[_0x3445ed(0x21d)]);break;case'telegrammsg':sendTelegramMsg(_0x112f0d['telegrammsg']);break;case _0x3445ed(0x29b):io['to'](_0x3226d0)[_0x3445ed(0x2a0)](_0x112f0d['function'],_0x112f0d['args']);break;}}),pid[_0x3226d0]['on'](_0x2188e3(0x203),function(_0x3c32e3){if(_0x1b9a09)return;_0x1b9a09=!![],_0x25b3ac(_0x3c32e3);}),pid[_0x3226d0]['on'](_0x2188e3(0x127),async function(_0x5caa40){const _0x4165cf=_0x2188e3;if(installingUpdate)return;if(_0x1b9a09)return;_0x1b9a09=!![],_0x25b3ac(null);const _0x54b6c0=dbConfig[_0x4165cf(0x222)](_0x4165cf(0x13c))[_0x4165cf(0x25d)]({'botID':_0x3226d0})[_0x4165cf(0x2bb)]();_0x54b6c0&&(_0x54b6c0[_0x4165cf(0x282)]=='enabled'||_0x54b6c0[_0x4165cf(0x282)]==_0x4165cf(0x235))&&(await sleep(0x3e8),updateLive(_0x3226d0,_0x4165cf(0x162)),logger[_0x4165cf(0x1db)](_0x4165cf(0x1f1)+_0x3226d0),startBot([_0x3226d0,userID],{'cwd':bbpath},function(_0x3b3727){if(_0x3b3727)logger['full'](_0x3b3727);}));});}function stopBot(_0x532e67){const _0x10bbff=_0x41dc7e;getClientsWithBotID(_0x532e67)[_0x10bbff(0x25e)](_0x735c0d=>{getSocket(_0x735c0d['id'])['disconnect'](!![]),removeClient(_0x735c0d['id']);}),pid[_0x532e67]&&(pid[_0x532e67][_0x10bbff(0x15c)](),pid[_0x532e67]=null);}function restartBot(_0x59501b){const _0x2f739a=_0x41dc7e;if(pid[_0x59501b])pid[_0x59501b][_0x2f739a(0x15c)]();}function addBot(){const _0x40cf68=_0x41dc7e;let _0x1b64ed;for(let _0x35c31c=0x1;_0x35c31c<0x3e9;_0x35c31c++){_0x1b64ed=_0x35c31c['toString']()[_0x40cf68(0x275)](0x3,'0');let _0x58bf2c=config['find'](_0x31b345=>_0x31b345[_0x40cf68(0x1d6)]==_0x1b64ed);if(!_0x58bf2c)break;}if(_0x1b64ed===_0x40cf68(0x1fd)){logger[_0x40cf68(0x1db)](_0x40cf68(0x28b));return;}logger[_0x40cf68(0x1db)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1b64ed),dbConfig[_0x40cf68(0x222)](_0x40cf68(0x13c))[_0x40cf68(0x2c6)]({'botID':_0x1b64ed,'botname':_0x40cf68(0x2b5)+_0x1b64ed,'status':_0x40cf68(0x235),'live':''})['write'](),startBot([_0x1b64ed,userID],{'cwd':bbpath},function(_0x5f4d48){const _0x44f529=_0x40cf68;if(_0x5f4d48)logger[_0x44f529(0x1db)](_0x5f4d48);}),config=getConfiguration(),io['to'](_0x40cf68(0x19e))[_0x40cf68(0x2a0)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0xaba6f7){const _0x2f13d4=_0x41dc7e;getClientsWithBotID(_0xaba6f7)['forEach'](_0x16e20e=>{const _0x1d7ec4=_0x5afd;getSocket(_0x16e20e['id'])[_0x1d7ec4(0x219)](!![]),removeClient(_0x16e20e['id']);}),dbConfig['get'](_0x2f13d4(0x13c))[_0x2f13d4(0x299)]({'botID':_0xaba6f7})[_0x2f13d4(0x1dc)](),logger['full'](_0x2f13d4(0x2b0)+_0xaba6f7),stopBot(_0xaba6f7);try{if(fs[_0x2f13d4(0x287)](path[_0x2f13d4(0x182)](configpath,'bot-'+_0xaba6f7+'-config.json')))fs[_0x2f13d4(0x211)](path[_0x2f13d4(0x182)](configpath,_0x2f13d4(0x215)+_0xaba6f7+_0x2f13d4(0x192)));if(fs['existsSync'](path[_0x2f13d4(0x182)](configpath,_0x2f13d4(0x215)+_0xaba6f7+_0x2f13d4(0x1cc))))fs['unlinkSync'](path[_0x2f13d4(0x182)](configpath,_0x2f13d4(0x215)+_0xaba6f7+_0x2f13d4(0x1cc)));if(fs[_0x2f13d4(0x287)](path['join'](configpath,_0x2f13d4(0x215)+_0xaba6f7+_0x2f13d4(0x290))))fs[_0x2f13d4(0x211)](path['join'](configpath,_0x2f13d4(0x215)+_0xaba6f7+'-performance.json'));if(fs[_0x2f13d4(0x287)](path['join'](configpath,_0x2f13d4(0x215)+_0xaba6f7+_0x2f13d4(0x2e6))))fs['unlinkSync'](path[_0x2f13d4(0x182)](configpath,_0x2f13d4(0x215)+_0xaba6f7+'-results.json'));}catch(_0x136471){if(_0x136471)logger[_0x2f13d4(0x1db)](_0x2f13d4(0x161),_0x136471);}config=getConfiguration(),io['to'](_0x2f13d4(0x19e))['emit'](_0x2f13d4(0x13c),config),broadcastToBots(_0x2f13d4(0x13c),JSON[_0x2f13d4(0x258)](config));}function toggleBot(_0x394fee,_0x2d3523,_0xc09645){const _0x40c0d0=_0x41dc7e;dbConfig['get'](_0x40c0d0(0x13c))[_0x40c0d0(0x25d)]({'botID':_0x394fee})[_0x40c0d0(0x22b)]({'status':_0x2d3523})[_0x40c0d0(0x22b)]({'live':_0xc09645})[_0x40c0d0(0x1dc)]();if(_0x2d3523=='enabled'||_0x2d3523==_0x40c0d0(0x235))logger['full'](_0x40c0d0(0x1f5)+_0x394fee),startBot([_0x394fee,userID],{'cwd':bbpath},function(_0x31bade){const _0x561313=_0x40c0d0;if(_0x31bade)logger[_0x561313(0x1db)](_0x31bade);});else(_0x2d3523=='disabled'||_0x2d3523==_0x40c0d0(0x200))&&(logger[_0x40c0d0(0x1db)]('Disabled\x20Bot\x20'+_0x394fee),stopBot(_0x394fee));config=getConfiguration(),io['to'](_0x40c0d0(0x19e))[_0x40c0d0(0x2a0)](_0x40c0d0(0x13c),config),broadcastToBots(_0x40c0d0(0x13c),JSON[_0x40c0d0(0x258)](config));}function toggleStatus(_0x3b75f6){const _0x3ec4cf=_0x41dc7e;let _0x2f3d75=dbConfig[_0x3ec4cf(0x222)](_0x3ec4cf(0x13c))[_0x3ec4cf(0x25d)]({'botID':_0x3b75f6})[_0x3ec4cf(0x2bb)](),_0xe481cb;if(_0x2f3d75[_0x3ec4cf(0x282)]===_0x3ec4cf(0x1ce))_0xe481cb=_0x3ec4cf(0x14f);else{if(_0x2f3d75[_0x3ec4cf(0x282)]===_0x3ec4cf(0x235))_0xe481cb=_0x3ec4cf(0x200);else{if(_0x2f3d75[_0x3ec4cf(0x282)]===_0x3ec4cf(0x200))_0xe481cb=_0x3ec4cf(0x235);else{if(_0x2f3d75[_0x3ec4cf(0x282)]==='disabled')_0xe481cb='enabled';}}}return _0xe481cb;}function updateStatus(_0x238af5,_0x46f174){const _0x34fbb4=_0x41dc7e;dbConfig[_0x34fbb4(0x222)](_0x34fbb4(0x13c))[_0x34fbb4(0x25d)]({'botID':_0x238af5})['assign']({'status':_0x46f174})[_0x34fbb4(0x1dc)](),config=getConfiguration(),io['to'](_0x34fbb4(0x19e))['emit'](_0x34fbb4(0x13c),config),broadcastToBots(_0x34fbb4(0x13c),JSON[_0x34fbb4(0x258)](config));}function updateLive(_0x1e00f1,_0x480252){const _0x4db732=_0x41dc7e;dbConfig[_0x4db732(0x222)](_0x4db732(0x13c))[_0x4db732(0x25d)]({'botID':_0x1e00f1})[_0x4db732(0x22b)]({'live':_0x480252})[_0x4db732(0x1dc)](),config=getConfiguration(),io['to'](_0x4db732(0x19e))[_0x4db732(0x2a0)](_0x4db732(0x13c),config),broadcastToBots('bots',JSON[_0x4db732(0x258)](config));}function updateBotName(_0x6fb58f,_0x5c16b3){const _0x4424ad=_0x41dc7e;dbConfig[_0x4424ad(0x222)](_0x4424ad(0x13c))[_0x4424ad(0x25d)]({'botID':_0x6fb58f})[_0x4424ad(0x22b)]({'botname':_0x5c16b3})[_0x4424ad(0x1dc)](),config=getConfiguration(),io['to'](_0x4424ad(0x19e))[_0x4424ad(0x2a0)](_0x4424ad(0x13c),config),broadcastToBots(_0x4424ad(0x13c),JSON['stringify'](config));}function updateBotManager(){const _0x21b04b=_0x41dc7e;config=getConfiguration(),io['to']('botmanager')[_0x21b04b(0x2a0)](_0x21b04b(0x13c),config),broadcastToBots(_0x21b04b(0x13c),JSON[_0x21b04b(0x258)](config));}function toggleBotMode(_0x3e3b79){const _0x1e28fc=_0x41dc7e;if(pid[_0x3e3b79])pid[_0x3e3b79]['send']({'function':_0x1e28fc(0x28e),'args':null});else{const _0x552fa7=configpath+'bot-'+_0x3e3b79+'-config.json',_0x2e8afa=fs[_0x1e28fc(0x1a4)](_0x552fa7),_0x27f9de=JSON[_0x1e28fc(0x198)](_0x2e8afa),_0x477eb0=_0x27f9de[_0x1e28fc(0x214)][0x0]['headless'];_0x27f9de['bot'][0x0]['headless']=!_0x477eb0;const _0x3628f3=JSON[_0x1e28fc(0x258)](_0x27f9de,null,0x2);fs['writeFileSync'](_0x552fa7,_0x3628f3),config=getConfiguration(),io['to'](_0x1e28fc(0x19e))[_0x1e28fc(0x2a0)]('bots',config),broadcastToBots('bots',JSON[_0x1e28fc(0x258)](config));}}function telegramError(_0x3f0993){const _0x2143ed=_0x41dc7e;logger[_0x2143ed(0x237)](getTimeStamp()+_0x2143ed(0x2d5));}function validateTelegram(_0x2633f9){const _0x1350e4=_0x41dc7e;if(_0x2633f9[_0x1350e4(0x26c)]['username']!=settings[_0x1350e4(0x18f)]&&'@'+_0x2633f9[_0x1350e4(0x26c)][_0x1350e4(0x284)]!=settings['telegramUsername'])return tgBot['sendMessage'](_0x2633f9['chat']['id'],_0x1350e4(0x267),{'parse_mode':'HTML'})[_0x1350e4(0x2e0)](_0x1a8aa3=>{telegramError(_0x1a8aa3);}),![];return!![];}async function initTelegram(){const _0x39e263=_0x41dc7e;if(tgBot)tgBot[_0x39e263(0x11e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x36473c='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x36473c+='\x0a',_0x36473c+='/enable\x20-\x20enable\x20notifications\x0a',_0x36473c+=_0x39e263(0x257),_0x36473c+=_0x39e263(0x212),_0x36473c+=_0x39e263(0x254),_0x36473c+=_0x39e263(0x1b0),_0x36473c+=_0x39e263(0x19d),_0x36473c+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x36473c+=_0x39e263(0x117),_0x36473c+=_0x39e263(0x2be),_0x36473c+=_0x39e263(0x2b1),_0x36473c+=_0x39e263(0x1ef),_0x36473c+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x36473c+=_0x39e263(0x23b),_0x36473c+=_0x39e263(0x1da);let _0x52883b=_0x39e263(0x2d4);_0x52883b+='\x0a',_0x52883b+=_0x36473c,tgBot['onText'](/\/start/,_0x1a5573=>{const _0x2a37b3=_0x39e263;if(!validateTelegram(_0x1a5573))return;if(settings[_0x2a37b3(0x1a8)]!=_0x1a5573[_0x2a37b3(0x15b)]['id'])updateSetting(_0x2a37b3(0x1a8),_0x1a5573[_0x2a37b3(0x15b)]['id']);updateSetting(_0x2a37b3(0x12e),!![]),tgBot[_0x2a37b3(0x124)](_0x1a5573[_0x2a37b3(0x15b)]['id'],_0x52883b)[_0x2a37b3(0x2e0)](_0x2765c8=>{telegramError(_0x2765c8);});}),tgBot[_0x39e263(0x26e)](/\/enable/,_0x307328=>{const _0x4b3055=_0x39e263;if(!validateTelegram(_0x307328))return;if(settings[_0x4b3055(0x1a8)]!=_0x307328[_0x4b3055(0x15b)]['id'])updateSetting('telegramChatId',_0x307328[_0x4b3055(0x15b)]['id']);updateSetting(_0x4b3055(0x12e),!![]),tgBot[_0x4b3055(0x124)](_0x307328[_0x4b3055(0x15b)]['id'],'Notifications\x20enabled')[_0x4b3055(0x2e0)](_0x2f13e3=>{telegramError(_0x2f13e3);});}),tgBot[_0x39e263(0x26e)](/\/config/,async _0x5753dd=>{const _0x40e7d3=_0x39e263;if(!validateTelegram(_0x5753dd))return;tgBot[_0x40e7d3(0x19a)](_0x40e7d3(0x261)),tgBot['sendMessage'](_0x5753dd[_0x40e7d3(0x15b)]['id'],_0x40e7d3(0x18c),{'reply_markup':{'inline_keyboard':[[{'text':_0x40e7d3(0x241),'callback_data':_0x40e7d3(0x1d3)},{'text':_0x40e7d3(0x295),'callback_data':_0x40e7d3(0x12c)},{'text':'All','callback_data':_0x40e7d3(0x1e9)}]]}})['catch'](_0x1315d7=>{telegramError(_0x1315d7);}),tgBot['on'](_0x40e7d3(0x261),async _0x28af66=>{const _0x20b096=_0x40e7d3,_0x2807d5=_0x28af66[_0x20b096(0x253)],_0x404a06=_0x28af66[_0x20b096(0x29a)];tgBot[_0x20b096(0x2b9)](_0x28af66['id'])[_0x20b096(0x2ef)](async()=>{const _0xb4f2bf=_0x20b096;_0x2807d5==_0xb4f2bf(0x1d3)&&(updateSetting(_0xb4f2bf(0x155),_0xb4f2bf(0x1d3)),updateSetting('telegramEnabled',!![]),await tgBot[_0xb4f2bf(0x124)](_0x404a06[_0xb4f2bf(0x15b)]['id'],_0xb4f2bf(0x1c5))[_0xb4f2bf(0x2e0)](_0x1e1f57=>{telegramError(_0x1e1f57);}));_0x2807d5==_0xb4f2bf(0x12c)&&(updateSetting(_0xb4f2bf(0x155),_0xb4f2bf(0x12c)),updateSetting(_0xb4f2bf(0x12e),!![]),await tgBot[_0xb4f2bf(0x124)](_0x404a06[_0xb4f2bf(0x15b)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0xb4f2bf(0x2e0)](_0x5eeab3=>{telegramError(_0x5eeab3);}));_0x2807d5==_0xb4f2bf(0x1e9)&&(updateSetting('telegramEvents',_0xb4f2bf(0x1e9)),updateSetting(_0xb4f2bf(0x12e),!![]),await tgBot[_0xb4f2bf(0x124)](_0x404a06[_0xb4f2bf(0x15b)]['id'],_0xb4f2bf(0x1d1))[_0xb4f2bf(0x2e0)](_0x418c5b=>{telegramError(_0x418c5b);}));if(!settings['telegramChatId'])tgBot[_0xb4f2bf(0x124)](_0x404a06['chat']['id'],_0xb4f2bf(0x1e3))[_0xb4f2bf(0x2e0)](_0x59d07a=>{telegramError(_0x59d07a);});}),tgBot[_0x20b096(0x19a)](_0x20b096(0x261));});}),tgBot[_0x39e263(0x26e)](/\/status/,_0x5bb2a1=>{const _0x1bd1c2=_0x39e263;if(!validateTelegram(_0x5bb2a1))return;const _0x37ee82=getBotsWithMode();let _0x46959c=_0x1bd1c2(0x229);config['forEach'](_0x31082d=>{const _0x43caac=_0x1bd1c2,_0x25c32a=_0x37ee82[_0x43caac(0x25d)](_0x7f4f8e=>_0x7f4f8e[_0x43caac(0x1d6)]==_0x31082d[_0x43caac(0x1d6)])[_0x43caac(0x17c)];_0x46959c+='Bot\x20'+_0x31082d[_0x43caac(0x1d6)]+':\x20'+_0x31082d['status']+_0x43caac(0x26b)+_0x25c32a+_0x43caac(0x26b)+_0x31082d[_0x43caac(0x1c7)]+'\x0a';}),_0x46959c+='\x0a',_0x46959c+=_0x1bd1c2(0x2df),_0x46959c+=!settings[_0x1bd1c2(0x12e)]?_0x1bd1c2(0x2b3):_0x1bd1c2(0x23f),_0x46959c+=settings['telegramEnabled']?settings['telegramEvents']==_0x1bd1c2(0x1e9)?_0x1bd1c2(0x24d):_0x1bd1c2(0x206)+settings[_0x1bd1c2(0x155)]+_0x1bd1c2(0x163):'',tgBot[_0x1bd1c2(0x124)](_0x5bb2a1[_0x1bd1c2(0x15b)]['id'],_0x46959c,{'parse_mode':_0x1bd1c2(0x27f)})[_0x1bd1c2(0x2e0)](_0x1d9439=>{telegramError(_0x1d9439);});}),tgBot[_0x39e263(0x26e)](/\/restart/,_0x777c40=>{const _0x3a9905=_0x39e263;if(!validateTelegram(_0x777c40))return;tgBot[_0x3a9905(0x19a)](_0x3a9905(0x261));const _0x3f4f75=getEnabledBots();if(_0x3f4f75[_0x3a9905(0x152)]==0x0)tgBot['sendMessage'](_0x777c40[_0x3a9905(0x15b)]['id'],_0x3a9905(0x262))[_0x3a9905(0x2e0)](_0x907f4c=>{telegramError(_0x907f4c);});else{if(_0x3f4f75[_0x3a9905(0x152)]>0x1)_0x3f4f75[_0x3a9905(0x2c6)]({'botID':_0x3a9905(0x1e9)});let _0x47e295=[],_0x2039d0=[];const _0x32ca00=_0x3f4f75[_0x3a9905(0x152)]%0x4==0x0||_0x3f4f75['length']%0x4==0x3||_0x3f4f75[_0x3a9905(0x152)]%0x3==0x1?0x4:0x3;let _0x38e412=0x0;_0x3f4f75['forEach']((_0x15c32c,_0xa1181)=>{const _0x1dd310=_0x3a9905;if(_0xa1181%_0x32ca00==0x0)_0x2039d0=[];_0x2039d0['push']({'text':_0x15c32c['botID']==_0x1dd310(0x1e9)?'All\x20bots':_0x1dd310(0x2b5)+_0x15c32c['botID'],'callback_data':_0x15c32c['botID']}),_0xa1181%_0x32ca00==0x0&&(_0x47e295[_0x38e412]=_0x2039d0,_0x38e412++);}),tgBot[_0x3a9905(0x124)](_0x777c40[_0x3a9905(0x15b)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x47e295}})[_0x3a9905(0x2e0)](_0x50c2c4=>{telegramError(_0x50c2c4);}),tgBot['on'](_0x3a9905(0x261),async _0x40e7a7=>{const _0x248be0=_0x3a9905,_0x193a28=_0x40e7a7[_0x248be0(0x253)],_0x2fb358=_0x40e7a7[_0x248be0(0x29a)];tgBot['answerCallbackQuery'](_0x40e7a7['id'])[_0x248be0(0x2ef)](async()=>{const _0x1c3309=_0x248be0;_0x193a28==_0x1c3309(0x1e9)?config[_0x1c3309(0x25e)](_0x40589f=>{const _0x536a21=_0x1c3309;restartBot(_0x40589f[_0x536a21(0x1d6)]);}):restartBot(_0x193a28);}),tgBot['removeListener'](_0x248be0(0x261));});}}),tgBot[_0x39e263(0x26e)](/\/on/,_0x1636d9=>{const _0x1cd6b3=_0x39e263;if(!validateTelegram(_0x1636d9))return;tgBot[_0x1cd6b3(0x19a)](_0x1cd6b3(0x261));const _0x238638=getDisabledBots();if(_0x238638[_0x1cd6b3(0x152)]==0x0)tgBot[_0x1cd6b3(0x124)](_0x1636d9['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x1cd6b3(0x2e0)](_0x59ffff=>{telegramError(_0x59ffff);});else{if(_0x238638[_0x1cd6b3(0x152)]>0x1)_0x238638[_0x1cd6b3(0x2c6)]({'botID':'all'});let _0x57bb19=[],_0x2fb2e3=[];const _0x436d7d=_0x238638[_0x1cd6b3(0x152)]%0x4==0x0||_0x238638[_0x1cd6b3(0x152)]%0x4==0x3||_0x238638[_0x1cd6b3(0x152)]%0x3==0x1?0x4:0x3;let _0x3cfd4f=0x0;_0x238638[_0x1cd6b3(0x25e)]((_0x2a9ed4,_0x2d8d99)=>{const _0x447c8e=_0x1cd6b3;if(_0x2d8d99%_0x436d7d==0x0)_0x2fb2e3=[];_0x2fb2e3[_0x447c8e(0x2c6)]({'text':_0x2a9ed4[_0x447c8e(0x1d6)]==_0x447c8e(0x1e9)?_0x447c8e(0x2cb):'Bot\x20'+_0x2a9ed4[_0x447c8e(0x1d6)],'callback_data':_0x2a9ed4['botID']}),_0x2d8d99%_0x436d7d==0x0&&(_0x57bb19[_0x3cfd4f]=_0x2fb2e3,_0x3cfd4f++);}),tgBot[_0x1cd6b3(0x124)](_0x1636d9[_0x1cd6b3(0x15b)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x57bb19}})['catch'](_0x200696=>{telegramError(_0x200696);}),tgBot['on']('callback_query',async _0x565762=>{const _0x3dc87c=_0x1cd6b3,_0x6d4e74=_0x565762[_0x3dc87c(0x253)],_0x3e2429=_0x565762[_0x3dc87c(0x29a)];tgBot[_0x3dc87c(0x2b9)](_0x565762['id'])[_0x3dc87c(0x2ef)](async()=>{const _0x3587ee=_0x3dc87c;_0x6d4e74==_0x3587ee(0x1e9)?(tgBot[_0x3587ee(0x124)](_0x3e2429[_0x3587ee(0x15b)]['id'],_0x3587ee(0x23d))[_0x3587ee(0x2e0)](_0x47f2a0=>{telegramError(_0x47f2a0);}),_0x238638[_0x3587ee(0x25e)](_0x19738f=>{const _0x52c25c=_0x3587ee;if(_0x19738f['botID']!='all')toggleBot(_0x19738f[_0x52c25c(0x1d6)],toggleStatus(_0x19738f[_0x52c25c(0x1d6)]),'stopped');})):(tgBot[_0x3587ee(0x124)](_0x3e2429['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x6d4e74)['catch'](_0xcd9cce=>{telegramError(_0xcd9cce);}),toggleBot(_0x6d4e74,toggleStatus(_0x6d4e74),_0x3587ee(0x162)));}),tgBot[_0x3dc87c(0x19a)]('callback_query');});}}),tgBot[_0x39e263(0x26e)](/\/off/,_0x1f1d8a=>{const _0x31538c=_0x39e263;if(!validateTelegram(_0x1f1d8a))return;tgBot[_0x31538c(0x19a)](_0x31538c(0x261));const _0xb56932=getEnabledBots();if(_0xb56932[_0x31538c(0x152)]==0x0)tgBot[_0x31538c(0x124)](_0x1f1d8a[_0x31538c(0x15b)]['id'],_0x31538c(0x262))[_0x31538c(0x2e0)](_0x24f28a=>{telegramError(_0x24f28a);});else{if(_0xb56932[_0x31538c(0x152)]>0x1)_0xb56932[_0x31538c(0x2c6)]({'botID':_0x31538c(0x1e9)});let _0x1cfab7=[],_0x510f69=[];const _0x37fb51=_0xb56932[_0x31538c(0x152)]%0x4==0x0||_0xb56932[_0x31538c(0x152)]%0x4==0x3||_0xb56932[_0x31538c(0x152)]%0x3==0x1?0x4:0x3;let _0x528a57=0x0;_0xb56932[_0x31538c(0x25e)]((_0x5d7f1f,_0x257fec)=>{const _0x33f359=_0x31538c;if(_0x257fec%_0x37fb51==0x0)_0x510f69=[];_0x510f69[_0x33f359(0x2c6)]({'text':_0x5d7f1f[_0x33f359(0x1d6)]==_0x33f359(0x1e9)?_0x33f359(0x2cb):_0x33f359(0x2b5)+_0x5d7f1f[_0x33f359(0x1d6)],'callback_data':_0x5d7f1f[_0x33f359(0x1d6)]}),_0x257fec%_0x37fb51==0x0&&(_0x1cfab7[_0x528a57]=_0x510f69,_0x528a57++);}),tgBot[_0x31538c(0x124)](_0x1f1d8a[_0x31538c(0x15b)]['id'],_0x31538c(0x1b5),{'reply_markup':{'inline_keyboard':_0x1cfab7}})['catch'](_0x422b05=>{telegramError(_0x422b05);}),tgBot['on']('callback_query',async _0x3a4adf=>{const _0x2451a5=_0x31538c,_0x2a0ecc=_0x3a4adf[_0x2451a5(0x253)],_0x3d86f5=_0x3a4adf['message'];tgBot['answerCallbackQuery'](_0x3a4adf['id'])[_0x2451a5(0x2ef)](async()=>{const _0x783aa=_0x2451a5;_0x2a0ecc==_0x783aa(0x1e9)?(tgBot[_0x783aa(0x124)](_0x3d86f5[_0x783aa(0x15b)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x4fc971=>{telegramError(_0x4fc971);}),_0xb56932[_0x783aa(0x25e)](_0x2698cc=>{const _0xa26ba0=_0x783aa;if(_0x2698cc[_0xa26ba0(0x1d6)]!=_0xa26ba0(0x1e9))toggleBot(_0x2698cc['botID'],toggleStatus(_0x2698cc['botID']),_0xa26ba0(0x162));})):(tgBot[_0x783aa(0x124)](_0x3d86f5[_0x783aa(0x15b)]['id'],_0x783aa(0x185)+_0x2a0ecc)['catch'](_0x2eb11f=>{telegramError(_0x2eb11f);}),toggleBot(_0x2a0ecc,toggleStatus(_0x2a0ecc),_0x783aa(0x162)));}),tgBot['removeListener'](_0x2451a5(0x261));});}}),tgBot['onText'](/\/metrics/,_0x3e6794=>{const _0x34049a=_0x39e263;if(!validateTelegram(_0x3e6794))return;tgBot[_0x34049a(0x19a)](_0x34049a(0x261));const _0x1134b9=getEnabledBots();if(_0x1134b9[_0x34049a(0x152)]==0x0)tgBot[_0x34049a(0x124)](_0x3e6794['chat']['id'],_0x34049a(0x262))['catch'](_0x5929c2=>{telegramError(_0x5929c2);});else{if(_0x1134b9[_0x34049a(0x152)]>0x1){let _0x315584=[],_0x522ffd=[];const _0xa047f9=_0x1134b9[_0x34049a(0x152)]%0x4==0x0||_0x1134b9[_0x34049a(0x152)]%0x4==0x3||_0x1134b9[_0x34049a(0x152)]%0x3==0x1?0x4:0x3;let _0x4b1aa9=0x0;_0x1134b9[_0x34049a(0x25e)]((_0x532e12,_0x26cc43)=>{const _0x127879=_0x34049a;if(_0x26cc43%_0xa047f9==0x0)_0x522ffd=[];_0x522ffd[_0x127879(0x2c6)]({'text':_0x127879(0x2b5)+_0x532e12['botID'],'callback_data':_0x532e12[_0x127879(0x1d6)]}),_0x26cc43%_0xa047f9==0x0&&(_0x315584[_0x4b1aa9]=_0x522ffd,_0x4b1aa9++);}),tgBot[_0x34049a(0x124)](_0x3e6794[_0x34049a(0x15b)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x315584}})[_0x34049a(0x2e0)](_0x16904d=>{telegramError(_0x16904d);}),tgBot['on']('callback_query',async _0x1aad73=>{const _0x52bee1=_0x34049a,_0x3d85c7=_0x1aad73[_0x52bee1(0x253)],_0x5ae68c=_0x1aad73[_0x52bee1(0x29a)];tgBot[_0x52bee1(0x2b9)](_0x1aad73['id'])[_0x52bee1(0x2ef)](async()=>{const _0x57d667=_0x52bee1;if(pid[_0x3d85c7])pid[_0x3d85c7][_0x57d667(0x2f2)]({'function':_0x57d667(0x2e2),'args':null});}),tgBot[_0x52bee1(0x19a)]('callback_query');});}else{const _0x3f3f3f=_0x1134b9[0x0]['botID'];if(pid[_0x3f3f3f])pid[_0x3f3f3f][_0x34049a(0x2f2)]({'function':_0x34049a(0x2e2),'args':null});}}}),tgBot[_0x39e263(0x26e)](/\/portfolio/,_0xad1a5e=>{const _0x3f1a1f=_0x39e263;if(!validateTelegram(_0xad1a5e))return;tgBot['removeListener'](_0x3f1a1f(0x261));const _0x182023=getEnabledBots();if(_0x182023[_0x3f1a1f(0x152)]==0x0)tgBot[_0x3f1a1f(0x124)](_0xad1a5e[_0x3f1a1f(0x15b)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x12750e=>{telegramError(_0x12750e);});else{if(_0x182023['length']>0x1){let _0x44db5c=[],_0x32e855=[];const _0x16d78c=_0x182023[_0x3f1a1f(0x152)]%0x4==0x0||_0x182023['length']%0x4==0x3||_0x182023[_0x3f1a1f(0x152)]%0x3==0x1?0x4:0x3;let _0x49ae09=0x0;_0x182023[_0x3f1a1f(0x25e)]((_0x1c0e74,_0x757ef1)=>{const _0x1cb294=_0x3f1a1f;if(_0x757ef1%_0x16d78c==0x0)_0x32e855=[];_0x32e855['push']({'text':_0x1cb294(0x2b5)+_0x1c0e74[_0x1cb294(0x1d6)],'callback_data':_0x1c0e74['botID']}),_0x757ef1%_0x16d78c==0x0&&(_0x44db5c[_0x49ae09]=_0x32e855,_0x49ae09++);}),tgBot['sendMessage'](_0xad1a5e[_0x3f1a1f(0x15b)]['id'],_0x3f1a1f(0x234),{'reply_markup':{'inline_keyboard':_0x44db5c}})['catch'](_0x38a5ef=>{telegramError(_0x38a5ef);}),tgBot['on']('callback_query',async _0x129e9b=>{const _0x5f3eb6=_0x3f1a1f,_0x14203e=_0x129e9b['data'],_0x43e09a=_0x129e9b[_0x5f3eb6(0x29a)];tgBot[_0x5f3eb6(0x2b9)](_0x129e9b['id'])[_0x5f3eb6(0x2ef)](async()=>{const _0x1e4310=_0x5f3eb6;if(pid[_0x14203e])pid[_0x14203e][_0x1e4310(0x2f2)]({'function':_0x1e4310(0x1d4),'args':null});}),tgBot[_0x5f3eb6(0x19a)]('callback_query');});}else{const _0x4f93ba=_0x182023[0x0][_0x3f1a1f(0x1d6)];if(pid[_0x4f93ba])pid[_0x4f93ba]['send']({'function':_0x3f1a1f(0x1d4),'args':null});}}}),tgBot[_0x39e263(0x26e)](/\/update/,async _0x1f23f5=>{const _0x4ef685=_0x39e263;if(!validateTelegram(_0x1f23f5))return;tgBot['removeListener'](_0x4ef685(0x261)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x1f23f5[_0x4ef685(0x15b)]['id'],_0x4ef685(0x142))['catch'](_0x115025=>{telegramError(_0x115025);});else!validInstallation?tgBot[_0x4ef685(0x124)](_0x1f23f5['chat']['id'],_0x4ef685(0x29f))['catch'](_0x3f1c3d=>{telegramError(_0x3f1c3d);}):(tgBot['sendMessage'](_0x1f23f5['chat']['id'],_0x4ef685(0x2f1),{'reply_markup':{'inline_keyboard':[[{'text':_0x4ef685(0x177),'callback_data':_0x4ef685(0x19c)},{'text':'No','callback_data':'no'}]]}})[_0x4ef685(0x2e0)](_0x22b671=>{telegramError(_0x22b671);}),tgBot['on']('callback_query',async _0x4ef227=>{const _0x215440=_0x4ef685,_0x46540f=_0x4ef227[_0x215440(0x253)],_0x89ac4e=_0x4ef227['message'];tgBot[_0x215440(0x2b9)](_0x4ef227['id'])[_0x215440(0x2ef)](async()=>{const _0x2e4409=_0x215440;_0x46540f==_0x2e4409(0x19c)&&(await tgBot[_0x2e4409(0x124)](_0x89ac4e[_0x2e4409(0x15b)]['id'],_0x2e4409(0x225))[_0x2e4409(0x2e0)](_0x383751=>{telegramError(_0x383751);}),updateBB(_0x2e4409(0x157))),_0x46540f=='no'&&await tgBot[_0x2e4409(0x124)](_0x89ac4e[_0x2e4409(0x15b)]['id'],_0x2e4409(0x114))[_0x2e4409(0x2e0)](_0x561e0a=>{telegramError(_0x561e0a);});}),tgBot[_0x215440(0x19a)]('callback_query');}));}),tgBot['onText'](/\/reinstall/,async _0x5d5f02=>{const _0x6b20ec=_0x39e263;if(!validateTelegram(_0x5d5f02))return;tgBot[_0x6b20ec(0x19a)](_0x6b20ec(0x261)),!validInstallation?tgBot[_0x6b20ec(0x124)](_0x5d5f02[_0x6b20ec(0x15b)]['id'],_0x6b20ec(0x277))[_0x6b20ec(0x2e0)](_0x4e0395=>{telegramError(_0x4e0395);}):(tgBot['sendMessage'](_0x5d5f02['chat']['id'],_0x6b20ec(0x2a1),{'reply_markup':{'inline_keyboard':[[{'text':_0x6b20ec(0x177),'callback_data':_0x6b20ec(0x19c)},{'text':'No','callback_data':'no'}]]}})[_0x6b20ec(0x2e0)](_0x122277=>{telegramError(_0x122277);}),tgBot['on'](_0x6b20ec(0x261),async _0x48bfef=>{const _0x9ce3ec=_0x6b20ec,_0x333581=_0x48bfef[_0x9ce3ec(0x253)],_0x25c61e=_0x48bfef[_0x9ce3ec(0x29a)];tgBot[_0x9ce3ec(0x2b9)](_0x48bfef['id'])[_0x9ce3ec(0x2ef)](async()=>{const _0x1d6b7a=_0x9ce3ec;_0x333581==_0x1d6b7a(0x19c)&&(await tgBot[_0x1d6b7a(0x124)](_0x25c61e[_0x1d6b7a(0x15b)]['id'],_0x1d6b7a(0x168))[_0x1d6b7a(0x2e0)](_0x52fc1b=>{telegramError(_0x52fc1b);}),updateBB(_0x1d6b7a(0x18b))),_0x333581=='no'&&await tgBot['sendMessage'](_0x25c61e[_0x1d6b7a(0x15b)]['id'],_0x1d6b7a(0x131))[_0x1d6b7a(0x2e0)](_0x3d3639=>{telegramError(_0x3d3639);});}),tgBot['removeListener'](_0x9ce3ec(0x261));}));}),tgBot[_0x39e263(0x26e)](/\/toggle/,_0x107d50=>{const _0x1d3ad7=_0x39e263;if(!validateTelegram(_0x107d50))return;tgBot[_0x1d3ad7(0x19a)]('callback_query');const _0x48c74e=getBotsWithMode();if(_0x48c74e['length']==0x0)tgBot[_0x1d3ad7(0x124)](_0x107d50[_0x1d3ad7(0x15b)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0xd8d358=>{telegramError(_0xd8d358);});else{let _0x34d3cb=[],_0x11df7e=[];const _0x405aa2=0x2;let _0x3c6d3d=0x0;_0x48c74e['forEach']((_0x1c5aa5,_0x408921)=>{const _0x5da132=_0x1d3ad7;if(_0x408921%_0x405aa2==0x0)_0x11df7e=[];_0x11df7e[_0x5da132(0x2c6)]({'text':_0x5da132(0x2b5)+_0x1c5aa5['botID']+'\x20('+_0x1c5aa5[_0x5da132(0x17c)]+')','callback_data':_0x1c5aa5[_0x5da132(0x1d6)]}),_0x408921%_0x405aa2==0x0&&(_0x34d3cb[_0x3c6d3d]=_0x11df7e,_0x3c6d3d++);}),tgBot[_0x1d3ad7(0x124)](_0x107d50[_0x1d3ad7(0x15b)]['id'],_0x1d3ad7(0x2b8),{'reply_markup':{'inline_keyboard':_0x34d3cb}})[_0x1d3ad7(0x2e0)](_0x321f22=>{telegramError(_0x321f22);}),tgBot['on'](_0x1d3ad7(0x261),async _0x552432=>{const _0x40f555=_0x1d3ad7,_0x2a72e9=_0x552432[_0x40f555(0x253)],_0x512139=_0x552432[_0x40f555(0x29a)];tgBot[_0x40f555(0x2b9)](_0x552432['id'])[_0x40f555(0x2ef)](async()=>{const _0x41e6f1=_0x40f555,_0x3d3ee3=_0x48c74e['find'](_0x4cc692=>_0x4cc692[_0x41e6f1(0x1d6)]==_0x2a72e9),_0x2eedfd=_0x3d3ee3[_0x41e6f1(0x17c)]==_0x41e6f1(0x1b3)?_0x41e6f1(0x1b1):_0x41e6f1(0x1b3);tgBot[_0x41e6f1(0x124)](_0x512139[_0x41e6f1(0x15b)]['id'],_0x41e6f1(0x178)+_0x2a72e9+'\x20to\x20'+_0x2eedfd+_0x41e6f1(0x19f))['catch'](_0x28a5da=>{telegramError(_0x28a5da);}),toggleBotMode(_0x2a72e9);}),tgBot['removeListener'](_0x40f555(0x261));});}}),tgBot[_0x39e263(0x26e)](/\/names/,_0x56bf94=>{const _0x125547=_0x39e263;if(!validateTelegram(_0x56bf94))return;let _0x3d84fb='';config[_0x125547(0x25e)](_0x4d3ca4=>{const _0x14a95a=_0x125547;_0x3d84fb+='Bot\x20'+_0x4d3ca4['botID']+':\x20'+_0x4d3ca4[_0x14a95a(0x126)]+'\x0a';}),tgBot[_0x125547(0x124)](_0x56bf94['chat']['id'],_0x3d84fb,{'parse_mode':_0x125547(0x27f)})[_0x125547(0x2e0)](_0x192db4=>{telegramError(_0x192db4);});}),tgBot[_0x39e263(0x26e)](/\/disable/,_0x3428d4=>{const _0x2d35fe=_0x39e263;if(!validateTelegram(_0x3428d4))return;tgBot[_0x2d35fe(0x124)](_0x3428d4[_0x2d35fe(0x15b)]['id'],'Notifications\x20disabled')['catch'](_0x2d3814=>{telegramError(_0x2d3814);}),updateSetting(_0x2d35fe(0x12e),![]);}),tgBot[_0x39e263(0x26e)](/\/help/,_0x4887cd=>{const _0x21285a=_0x39e263;if(!validateTelegram(_0x4887cd))return;tgBot[_0x21285a(0x124)](_0x4887cd['chat']['id'],_0x36473c)[_0x21285a(0x2e0)](_0x28cae3=>{telegramError(_0x28cae3);});}),tgBot['on'](_0x39e263(0x2ec),_0x177bbe=>{const _0x3f9044=_0x39e263;_0x177bbe['toString']()[_0x3f9044(0x1b2)]('404\x20Not\x20Found')&&(logger[_0x3f9044(0x1db)](_0x3f9044(0x2a7)),tgBot[_0x3f9044(0x11e)](),tgBot=null,io['to'](_0x3f9044(0x19e))[_0x3f9044(0x2a0)](_0x3f9044(0x1b7),_0x3f9044(0x2a7)));}),process[_0x39e263(0x147)](_0x39e263(0x2a2),()=>{const _0x10bab4=_0x39e263;if(tgBot)tgBot[_0x10bab4(0x11e)]();process[_0x10bab4(0x127)](0x1);}),process[_0x39e263(0x147)]('SIGTERM',()=>{const _0x2ed0b2=_0x39e263;if(tgBot)tgBot['stopPolling']();process[_0x2ed0b2(0x127)](0x1);});}}function disableTelegram(){const _0x125feb=_0x41dc7e;tgBot&&(tgBot[_0x125feb(0x11e)](),tgBot=null);}function sendTelegram(_0x23d2ea,_0x51daed){const _0xbad05=_0x41dc7e;if(settings[_0xbad05(0x12e)]){if(settings[_0xbad05(0x155)]==_0xbad05(0x1e9)||(_0x51daed['type']=='error'||_0x51daed['type']=='warning'||_0x51daed['type']==_0xbad05(0x14d))&&settings[_0xbad05(0x155)]==_0xbad05(0x12c)||_0x51daed[_0xbad05(0x122)]=='order'&&settings[_0xbad05(0x155)]==_0xbad05(0x1d3)){if(tgBot&&settings['telegramChatId']){if(_0x51daed['showname'])tgBot[_0xbad05(0x124)](settings[_0xbad05(0x1a8)],_0x51daed['botname']+'\x20>\x20'+_0x51daed['event'])[_0xbad05(0x2e0)](_0x1bed54=>{telegramError(_0x1bed54);});else tgBot[_0xbad05(0x124)](settings[_0xbad05(0x1a8)],'Bot\x20'+_0x23d2ea+_0xbad05(0x29c)+_0x51daed[_0xbad05(0x17d)])[_0xbad05(0x2e0)](_0x449a7d=>{telegramError(_0x449a7d);});}}}}async function sendTelegramMsg(_0x3c51d7,_0x2f3e85=_0x41dc7e(0x27f)){const _0x56a05f=_0x41dc7e;return settings[_0x56a05f(0x12e)]&&tgBot&&settings[_0x56a05f(0x1a8)]?(await tgBot[_0x56a05f(0x124)](settings['telegramChatId'],_0x3c51d7,{'parse_mode':_0x2f3e85})[_0x56a05f(0x2e0)](_0x43209a=>{telegramError(_0x43209a);}),!![]):![];}function getDeviceWithIp(_0x164418){const _0x2cdd95=_0x41dc7e;return devices[_0x2cdd95(0x25d)](_0x2034f7=>_0x2034f7['ip']===_0x164418);}function temporaryAccess2FA(_0x18986c,_0xf9c5){const _0x5e0c69=_0x41dc7e;let _0xf04c66=new Date(),_0x3c199b=![];if(lastIpApproval){if(_0xf04c66-lastIpApproval<0x1388)_0x3c199b=!![];}lastIpApproval=new Date();if(_0x3c199b)return;tgBot&&settings[_0x5e0c69(0x1a8)]&&(tgBot[_0x5e0c69(0x19a)](_0x5e0c69(0x261)),tgBot[_0x5e0c69(0x124)](settings[_0x5e0c69(0x1a8)],_0x5e0c69(0x2f3)+normalizeIP(_0xf9c5)[_0x5e0c69(0x25c)]+'</b>\x20?',{'parse_mode':_0x5e0c69(0x27f),'reply_markup':{'inline_keyboard':[[{'text':_0x5e0c69(0x170),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x5e0c69(0x201),'callback_data':'30'},{'text':_0x5e0c69(0x2da),'callback_data':_0x5e0c69(0x2da)}]]}})[_0x5e0c69(0x2e0)](_0x54a92c=>{telegramError(_0x54a92c);}),tgBot['on'](_0x5e0c69(0x261),async _0x28fe35=>{const _0x2aca50=_0x5e0c69,_0x3cadcb=_0x28fe35[_0x2aca50(0x253)],_0x355fb0=_0x28fe35['message'];tgBot[_0x2aca50(0x2b9)](_0x28fe35['id'])['then'](async()=>{const _0x59bd9=_0x2aca50;devices[_0x18986c][_0x59bd9(0x1a1)]={'clientip':_0xf9c5,'timestamp':new Date()[_0x59bd9(0x20e)](),'expiry':_0x3cadcb},_0x3cadcb!=_0x59bd9(0x2da)?(await tgBot[_0x59bd9(0x124)](_0x355fb0['chat']['id'],'Access\x20enabled\x20for\x20'+_0x3cadcb+_0x59bd9(0x289),{'parse_mode':_0x59bd9(0x27f)})[_0x59bd9(0x2e0)](_0x4ccc47=>{telegramError(_0x4ccc47);}),io['to'](_0x18986c)[_0x59bd9(0x2a0)](_0x59bd9(0x282),{'access':{'allow':![],'reason':_0x59bd9(0x15f),'token':null}})):(await tgBot[_0x59bd9(0x124)](_0x355fb0['chat']['id'],'Temporary\x20access\x20rejected')[_0x59bd9(0x2e0)](_0x20693f=>{telegramError(_0x20693f);}),io['to'](_0x18986c)[_0x59bd9(0x2a0)](_0x59bd9(0x282),{'access':{'allow':![],'reason':_0x59bd9(0x196),'token':null}}));}),tgBot[_0x2aca50(0x19a)](_0x2aca50(0x261));}));}function loginAccess2FA(_0xc67b40,_0x3c9e36){const _0x4a22b8=_0x41dc7e;tgBot&&settings[_0x4a22b8(0x1a8)]&&(tgBot['removeListener'](_0x4a22b8(0x261)),tgBot[_0x4a22b8(0x124)](settings[_0x4a22b8(0x1a8)],_0x4a22b8(0x137)+normalizeIP(_0x3c9e36)[_0x4a22b8(0x25c)]+_0x4a22b8(0x2af),{'parse_mode':_0x4a22b8(0x27f),'reply_markup':{'inline_keyboard':[[{'text':_0x4a22b8(0x16f),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x4a22b8(0x2da)}]]}})[_0x4a22b8(0x2e0)](_0x38e1ee=>{telegramError(_0x38e1ee);}),tgBot['on'](_0x4a22b8(0x261),async _0x2afa86=>{const _0x1a8d71=_0x4a22b8,_0x5c09d1=_0x2afa86[_0x1a8d71(0x253)],_0x4eb70f=_0x2afa86[_0x1a8d71(0x29a)];tgBot['answerCallbackQuery'](_0x2afa86['id'])[_0x1a8d71(0x2ef)](async()=>{const _0x3eeecc=_0x1a8d71;devices[_0xc67b40][_0x3eeecc(0x20b)]={'clientip':_0x3c9e36,'timestamp':new Date()[_0x3eeecc(0x20e)](),'expiry':_0x5c09d1},_0x5c09d1!='reject'?(await tgBot['sendMessage'](_0x4eb70f[_0x3eeecc(0x15b)]['id'],_0x3eeecc(0x139),{'parse_mode':_0x3eeecc(0x27f)})[_0x3eeecc(0x2e0)](_0x4aa3f0=>{telegramError(_0x4aa3f0);}),io['to'](_0xc67b40)['emit'](_0x3eeecc(0x282),{'access':{'allow':![],'reason':_0x3eeecc(0x15f),'token':null}})):(await tgBot[_0x3eeecc(0x124)](_0x4eb70f['chat']['id'],_0x3eeecc(0x2a6))[_0x3eeecc(0x2e0)](_0x426c95=>{telegramError(_0x426c95);}),io['to'](_0xc67b40)['emit'](_0x3eeecc(0x282),{'access':{'allow':![],'reason':_0x3eeecc(0x1ca),'token':null}}));}),tgBot[_0x1a8d71(0x19a)](_0x1a8d71(0x261));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x26b8d1=_0x41dc7e;return dbConfig[_0x26b8d1(0x222)](_0x26b8d1(0x13c))[_0x26b8d1(0x2ea)]('botID')['filter']({'status':_0x26b8d1(0x1ce)})[_0x26b8d1(0x2bb)]()||[];}function getDisabledBots(){const _0x44b5bb=_0x41dc7e;return dbConfig['get']('bots')[_0x44b5bb(0x2ea)]('botID')[_0x44b5bb(0x1aa)]({'status':_0x44b5bb(0x14f)})[_0x44b5bb(0x2bb)]()||[];}function getBotAttributes(_0x50683d){const _0x3379cf=_0x41dc7e;let _0x1634b2={};const _0xb6c658=configpath+_0x3379cf(0x215)+_0x50683d+'-config.json',_0x538392=fs[_0x3379cf(0x287)](_0xb6c658);if(_0x538392){const _0x3b28f4=fs[_0x3379cf(0x1a4)](_0xb6c658);try{const _0x1d7d43=JSON['parse'](_0x3b28f4),_0x6077f0=_0x1d7d43?_0x1d7d43[_0x3379cf(0x214)][0x0][_0x3379cf(0x134)]:![];_0x1634b2['mode']=_0x6077f0?'auto':_0x3379cf(0x1b1),_0x1634b2[_0x3379cf(0x126)]=_0x1d7d43?_0x1d7d43[_0x3379cf(0x214)][0x0]['botname']:_0x3379cf(0x2b5)+_0x50683d;}catch(_0x301797){_0x1634b2[_0x3379cf(0x17c)]=_0x3379cf(0x1b1),_0x1634b2[_0x3379cf(0x126)]=_0x3379cf(0x2b5)+_0x50683d;}}else _0x1634b2['mode']=_0x3379cf(0x1b1),_0x1634b2['botname']='Bot\x20'+_0x50683d;return _0x1634b2;}function getBotsWithMode(){const _0x10443c=_0x41dc7e,_0x284050=dbConfig[_0x10443c(0x222)](_0x10443c(0x13c))['sortBy'](_0x10443c(0x1d6))[_0x10443c(0x2bb)]()||[];return _0x284050[_0x10443c(0x25e)](_0x1e4ff1=>{const _0x386e82=_0x10443c;let _0x5ef237=getBotAttributes(_0x1e4ff1[_0x386e82(0x1d6)]);_0x1e4ff1[_0x386e82(0x17c)]=_0x5ef237[_0x386e82(0x17c)];}),_0x284050;}function getBotExchanges(){const _0x18d8e2=_0x41dc7e;let _0x34b788=[];const _0x5310ff=dbConfig[_0x18d8e2(0x222)](_0x18d8e2(0x13c))[_0x18d8e2(0x2ea)]('botID')[_0x18d8e2(0x2bb)]()||[];_0x5310ff[_0x18d8e2(0x25e)](_0xaeae31=>{const _0x34964a=_0x18d8e2;if(_0xaeae31[_0x34964a(0x282)]==_0x34964a(0x1ce)){const _0x325204=configpath+_0x34964a(0x215)+_0xaeae31[_0x34964a(0x1d6)]+_0x34964a(0x192),_0x48a087=fs[_0x34964a(0x287)](_0x325204);let _0x50fbc4;if(_0x48a087){const _0x55f618=fs[_0x34964a(0x1a4)](_0x325204);try{const _0x37e652=JSON['parse'](_0x55f618);_0x50fbc4=_0x37e652?_0x37e652[_0x34964a(0x214)][0x0][_0x34964a(0x1e4)]:null;}catch(_0x191244){}}if(_0x50fbc4)_0x34b788[_0x34964a(0x2c6)](_0x50fbc4);}});const _0x99e047=[...new Set(_0x34b788)][_0x18d8e2(0x156)]();return _0x99e047;}async function initUser(){const _0x48968b=_0x41dc7e;if(!settings[_0x48968b(0x18e)]){const _0x5f446b=uuidRandom();mixpanel[_0x48968b(0x166)](_0x5f446b),updateSetting(_0x48968b(0x18e),_0x5f446b);}}async function initSecure(){const _0x1947f7=_0x41dc7e;let _0x122037=getSecure();if(!_0x122037[_0x1947f7(0x140)](_0x1947f7(0x243))){let _0x3480c1=await generateKeys();_0x122037[_0x1947f7(0x1fa)]=_0x3480c1['publicKey'],_0x122037['privateKey']=_0x3480c1['privateKey'],_0x122037[_0x1947f7(0x243)]=crypto[_0x1947f7(0x20d)](0x20)[_0x1947f7(0x128)](_0x1947f7(0x1c6));;storeSecure(_0x122037);}}function getSettings(){const _0x5d87ba=_0x41dc7e;return dbSettings[_0x5d87ba(0x222)](_0x5d87ba(0x251))[_0x5d87ba(0x2bb)]()||{};}function getSecure(){const _0x42914d=_0x41dc7e;return dbSecure[_0x42914d(0x222)](_0x42914d(0x173))[_0x42914d(0x2bb)]()||{};}function getBlacklist(){const _0x1a88d4=_0x41dc7e;return dbSecure[_0x1a88d4(0x222)]('blacklist')[_0x1a88d4(0x2bb)]()||[];}function broadcastToBots(_0x3f20ca,_0x500871){const _0xbb829f=_0x41dc7e;config[_0xbb829f(0x25e)](_0x1dfcd8=>{const _0x102935=_0xbb829f;if(_0x1dfcd8[_0x102935(0x282)]==_0x102935(0x1ce)&&_0x1dfcd8[_0x102935(0x1c7)]==_0x102935(0x2bd)||_0x1dfcd8[_0x102935(0x282)]==_0x102935(0x235)&&_0x1dfcd8['live']=='running'){if(pid[_0x1dfcd8[_0x102935(0x1d6)]])pid[_0x1dfcd8[_0x102935(0x1d6)]]['send']({[_0x3f20ca]:_0x500871});}});}function storeSettings(_0xc0e87a,_0x20e644=![]){const _0x4b588d=_0x41dc7e;_0xc0e87a={...settings,..._0xc0e87a};if(_0x20e644&&_0xc0e87a[_0x4b588d(0x2cf)]!=_0x4b588d(0x1ea)&&_0xc0e87a[_0x4b588d(0x2cf)]!=_0x4b588d(0x197)&&_0xc0e87a[_0x4b588d(0x2cf)]!=''){const _0x3ecf79=crypt[_0x4b588d(0x25a)](secure[_0x4b588d(0x143)],_0xc0e87a[_0x4b588d(0x2cf)])[_0x4b588d(0x29a)][_0x4b588d(0x1e1)]('@')[0x0],_0x4a6fe5=bcrypt[_0x4b588d(0x194)](_0x3ecf79,saltRounds);_0xc0e87a={..._0xc0e87a,'bbPassword':_0x4a6fe5};}if(_0x20e644&&_0xc0e87a[_0x4b588d(0x1f4)]!=_0x4b588d(0x1ea)&&_0xc0e87a[_0x4b588d(0x1f4)]!=_0x4b588d(0x197)&&_0xc0e87a[_0x4b588d(0x1f4)]!=''){const _0x3456b6=crypt[_0x4b588d(0x25a)](secure['privateKey'],_0xc0e87a['telegramToken'])['message']['split']('@')[0x0];_0xc0e87a={..._0xc0e87a,'telegramToken':_0x3456b6};}const _0x4affd9=_0xc0e87a[_0x4b588d(0x1f4)]!=_0x4b588d(0x1ea)&&_0xc0e87a[_0x4b588d(0x1f4)]!=settings[_0x4b588d(0x1f4)]||_0xc0e87a[_0x4b588d(0x18f)]!=settings[_0x4b588d(0x18f)],_0x215819=_0xc0e87a[_0x4b588d(0x1f4)]==''||_0xc0e87a['telegramUsername']=='';if(_0x4affd9)_0xc0e87a[_0x4b588d(0x155)]=_0x4b588d(0x1e9);for(const [_0x59f99f,_0x113408]of Object[_0x4b588d(0x227)](_0xc0e87a)){if(_0x59f99f==_0x4b588d(0x1f4)&&_0x113408=='************'){_0xc0e87a[_0x4b588d(0x1f4)]=settings[_0x4b588d(0x1f4)];continue;};if(_0x59f99f==_0x4b588d(0x2cf)&&_0x113408==_0x4b588d(0x1ea)){_0xc0e87a[_0x4b588d(0x2cf)]=settings[_0x4b588d(0x2cf)];continue;};dbSettings[_0x4b588d(0x2c8)]('settings.'+_0x59f99f,_0x113408)['write']();}settings=_0xc0e87a,io['to']('botmanager')[_0x4b588d(0x2a0)](_0x4b588d(0x251),cleanSettings()),broadcastToBots(_0x4b588d(0x2d0),settings[_0x4b588d(0x2d0)]),broadcastToBots(_0x4b588d(0x195),settings[_0x4b588d(0x195)]);if(_0x4affd9&&!_0x215819)initTelegram();if(_0x4affd9&&_0x215819)disableTelegram();getAllClients()[_0x4b588d(0x25e)](_0x3e2eed=>{const _0x4c66cd=_0x4b588d;getSocket(_0x3e2eed['id'])[_0x4c66cd(0x2a0)](_0x4c66cd(0x282),{'access':{'allow':![],'reason':_0x4c66cd(0x15f),'token':null}});});}function updateSetting(_0x2e009f,_0x3db167){const _0x5105db=_0x41dc7e;dbSettings[_0x5105db(0x2c8)]('settings.'+_0x2e009f,_0x3db167)[_0x5105db(0x1dc)](),settings=getSettings(),io['to'](_0x5105db(0x19e))[_0x5105db(0x2a0)](_0x5105db(0x251),cleanSettings());}function storeSecure(_0x4c5b8b){const _0xad0545=_0x41dc7e;dbSecure[_0xad0545(0x222)](_0xad0545(0x173))[_0xad0545(0x2c6)](_0x4c5b8b)[_0xad0545(0x1dc)](),secure=_0x4c5b8b;}function addBlacklist(_0x4b8aae){const _0x39f1d6=_0x41dc7e;cleanBlacklist();let _0x2a0c1c;devices[_0x4b8aae]['telegramIpApproval']?_0x2a0c1c=Math[_0x39f1d6(0x2d6)](devices[_0x4b8aae][_0x39f1d6(0x1a1)][_0x39f1d6(0x165)],loginExpiry):_0x2a0c1c=loginExpiry,dbSecure[_0x39f1d6(0x222)](_0x39f1d6(0x16e))[_0x39f1d6(0x2c6)]({'expiry':new Date()[_0x39f1d6(0x20e)]()+_0x2a0c1c*0x3c*0x3e8,'token':devices[_0x4b8aae][_0x39f1d6(0x23a)][_0x39f1d6(0x1d8)]})[_0x39f1d6(0x1dc)](),blacklist=dbSecure['get'](_0x39f1d6(0x16e))[_0x39f1d6(0x2bb)]();}function cleanBlacklist(){const _0x7c84e8=_0x41dc7e;let _0x5c5fcd=dbSecure['get'](_0x7c84e8(0x16e))[_0x7c84e8(0x133)]()['value'](),_0x22724d=new Date()[_0x7c84e8(0x20e)]();_0x5c5fcd['forEach'](_0x12f2a8=>{const _0x51a7e6=_0x7c84e8;_0x12f2a8[_0x51a7e6(0x165)]<_0x22724d&&dbSecure['get'](_0x51a7e6(0x16e))['remove']({'expiry':_0x12f2a8['expiry']})[_0x51a7e6(0x1dc)]();});}function initStates(){const _0x41543f=_0x41dc7e;let _0x292e61=getConfiguration();_0x292e61[_0x41543f(0x25e)](_0x1b0217=>{const _0x16f01b=_0x41543f;_0x1b0217[_0x16f01b(0x1c7)]=_0x16f01b(0x162);}),storeConfiguration(_0x292e61);}function onKeys(){const _0x30b3a7=new RSA();return new Promise(_0x1c3e11=>{const _0xcf308a=_0x5afd;_0x30b3a7[_0xcf308a(0x136)]()[_0xcf308a(0x2ef)](_0x96c139=>{_0x1c3e11(_0x96c139);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x516bf9=_0x41dc7e;let _0x152eac=getSettings(),_0x31b4d3=![];!_0x152eac[_0x516bf9(0x140)](_0x516bf9(0x118))&&(_0x152eac[_0x516bf9(0x118)]=0x0,_0x31b4d3=!![]);!_0x152eac[_0x516bf9(0x140)](_0x516bf9(0x2c5))&&(_0x152eac[_0x516bf9(0x2c5)]=0x0,_0x31b4d3=!![]);!_0x152eac['hasOwnProperty'](_0x516bf9(0x29d))&&(_0x152eac[_0x516bf9(0x29d)]=_0x516bf9(0x149),_0x31b4d3=!![]);!_0x152eac['hasOwnProperty'](_0x516bf9(0x195))&&(_0x152eac[_0x516bf9(0x195)]=![],_0x31b4d3=!![]);if(_0x31b4d3)storeSettings(_0x152eac);try{fs[_0x516bf9(0x2cc)](configbackuppath,{'withFileTypes':!![]})[_0x516bf9(0x25e)](_0x3b64bc=>{const _0x1b1896=_0x516bf9;if(!_0x3b64bc['isDirectory']()){if(!_0x3b64bc[_0x1b1896(0x281)][_0x1b1896(0x1c3)](_0x1b1896(0x1c9)))fs[_0x1b1896(0x211)](configbackuppath+_0x3b64bc[_0x1b1896(0x281)]);}else fs[_0x1b1896(0x230)](configbackuppath+_0x3b64bc['name'],{'recursive':!![]});});}catch(_0x1c9e45){logger[_0x516bf9(0x240)]('Error\x20removing\x20old\x20backup\x20files:',_0x1c9e45);}}function storeConfiguration(_0x53bc57){const _0x5b10aa=_0x41dc7e;dbConfig['get'](_0x5b10aa(0x13c))['remove']()[_0x5b10aa(0x1dc)](),_0x53bc57[_0x5b10aa(0x25e)](_0x43b01c=>{const _0x4eec4f=_0x5b10aa;delete _0x43b01c[_0x4eec4f(0x17c)];}),dbConfig['get'](_0x5b10aa(0x13c))[_0x5b10aa(0x2c6)](..._0x53bc57)[_0x5b10aa(0x1dc)](),config=_0x53bc57;}function resetPassword(){const _0x1dcbd8=_0x41dc7e;tgBot&&settings[_0x1dcbd8(0x1a8)]&&(tgBot[_0x1dcbd8(0x19a)]('callback_query'),tgBot[_0x1dcbd8(0x124)](settings[_0x1dcbd8(0x1a8)],_0x1dcbd8(0x297),{'parse_mode':_0x1dcbd8(0x27f),'reply_markup':{'inline_keyboard':[[{'text':_0x1dcbd8(0x19c),'callback_data':_0x1dcbd8(0x19c)},{'text':'no','callback_data':'no'}]]}})[_0x1dcbd8(0x2e0)](_0x5613c8=>{telegramError(_0x5613c8);}),tgBot['on']('callback_query',async _0x498232=>{const _0x3a5165=_0x1dcbd8,_0x47c898=_0x498232['data'],_0x56ddb6=_0x498232[_0x3a5165(0x29a)];tgBot['answerCallbackQuery'](_0x498232['id'])[_0x3a5165(0x2ef)](async()=>{const _0x176cf5=_0x3a5165;if(_0x47c898!='no'){const _0x176f6b=0xf,_0x1647c9=_0x176cf5(0x1bc),_0x4ef42d=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x176f6b)))[_0x176cf5(0x181)](_0x405fc9=>_0x1647c9[_0x405fc9%_0x1647c9[_0x176cf5(0x152)]])[_0x176cf5(0x182)](''),_0x1e3eb8=bcrypt[_0x176cf5(0x194)](_0x4ef42d,saltRounds);storeSettings({'bbPassword':_0x1e3eb8}),await tgBot['sendMessage'](_0x56ddb6[_0x176cf5(0x15b)]['id'],_0x176cf5(0x1f8)+_0x4ef42d,{'parse_mode':_0x176cf5(0x27f)})['catch'](_0x5cfda6=>{telegramError(_0x5cfda6);});}else await tgBot[_0x176cf5(0x124)](_0x56ddb6['chat']['id'],'Password\x20reset\x20rejected')['catch'](_0x2e6780=>{telegramError(_0x2e6780);});}),tgBot[_0x3a5165(0x19a)](_0x3a5165(0x261));}));}async function confirmRestore(_0x1effa7,_0x53b269){const _0xa4d9e4=_0x41dc7e;io['to'](_0xa4d9e4(0x19e))[_0xa4d9e4(0x2a0)](_0xa4d9e4(0x1b7),_0xa4d9e4(0x21e),_0xa4d9e4(0x14d)),tgBot&&settings[_0xa4d9e4(0x1a8)]&&(tgBot['removeListener'](_0xa4d9e4(0x261)),await tgBot['sendMessage'](settings[_0xa4d9e4(0x1a8)],_0xa4d9e4(0x123),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0xa4d9e4(0x19c),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0xa4d9e4(0x2e0)](_0x545284=>{telegramError(_0x545284);}),tgBot['on'](_0xa4d9e4(0x261),async _0xdc4342=>{const _0x20a6b2=_0xa4d9e4,_0x4334f5=_0xdc4342[_0x20a6b2(0x253)],_0x379b90=_0xdc4342[_0x20a6b2(0x29a)];tgBot[_0x20a6b2(0x2b9)](_0xdc4342['id'])[_0x20a6b2(0x2ef)](async()=>{const _0x38fdba=_0x20a6b2;_0x4334f5==_0x38fdba(0x19c)?(await tgBot[_0x38fdba(0x124)](_0x379b90[_0x38fdba(0x15b)]['id'],_0x38fdba(0x1e0),{'parse_mode':_0x38fdba(0x27f)})[_0x38fdba(0x2e0)](_0x499596=>{telegramError(_0x499596);}),unzipFile(_0x1effa7,_0x53b269)):(logger['debug'](_0x38fdba(0x28c)),await tgBot[_0x38fdba(0x124)](_0x379b90['chat']['id'],'Restore\x20process\x20aborted')[_0x38fdba(0x2e0)](_0x4bca31=>{telegramError(_0x4bca31);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x3f472a=_0x41dc7e,_0x5acb2f=new Date();return _0x5acb2f[_0x3f472a(0x2dd)]()+'/'+(_0x5acb2f[_0x3f472a(0x129)]()+0x1)[_0x3f472a(0x128)]()['padStart'](0x2,'0')+'/'+_0x5acb2f[_0x3f472a(0x15d)]()[_0x3f472a(0x128)]()[_0x3f472a(0x275)](0x2,'0')+'\x20'+_0x5acb2f[_0x3f472a(0x27c)]()['toString']()[_0x3f472a(0x275)](0x2,'0')+':'+_0x5acb2f[_0x3f472a(0x2d7)]()[_0x3f472a(0x128)]()[_0x3f472a(0x275)](0x2,'0')+':'+_0x5acb2f[_0x3f472a(0x2a8)]()[_0x3f472a(0x128)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x5e5c2c=_0x41dc7e,_0x3e02e2=shiftedTime();return _0x3e02e2[_0x5e5c2c(0x2dd)]()+'/'+(_0x3e02e2[_0x5e5c2c(0x129)]()+0x1)[_0x5e5c2c(0x128)]()[_0x5e5c2c(0x275)](0x2,'0')+'/'+_0x3e02e2[_0x5e5c2c(0x15d)]()[_0x5e5c2c(0x128)]()[_0x5e5c2c(0x275)](0x2,'0')+'\x20'+_0x3e02e2[_0x5e5c2c(0x27c)]()[_0x5e5c2c(0x128)]()[_0x5e5c2c(0x275)](0x2,'0')+':'+_0x3e02e2[_0x5e5c2c(0x2d7)]()[_0x5e5c2c(0x128)]()[_0x5e5c2c(0x275)](0x2,'0')+':'+_0x3e02e2[_0x5e5c2c(0x2a8)]()[_0x5e5c2c(0x128)]()[_0x5e5c2c(0x275)](0x2,'0');}function getCleanTimeStamp(){const _0x1b7419=_0x41dc7e,_0x532b78=shiftedTime();return _0x532b78[_0x1b7419(0x2dd)]()+(_0x532b78[_0x1b7419(0x129)]()+0x1)['toString']()['padStart'](0x2,'0')+_0x532b78[_0x1b7419(0x15d)]()[_0x1b7419(0x128)]()[_0x1b7419(0x275)](0x2,'0')+'-'+_0x532b78['getHours']()[_0x1b7419(0x128)]()[_0x1b7419(0x275)](0x2,'0')+_0x532b78[_0x1b7419(0x2d7)]()['toString']()[_0x1b7419(0x275)](0x2,'0')+_0x532b78[_0x1b7419(0x2a8)]()[_0x1b7419(0x128)]()[_0x1b7419(0x275)](0x2,'0');}function shiftedTime(){const _0x32f179=_0x41dc7e,_0x4e5e27=new Date();let _0xf083ef=_0x4e5e27;if(settings['timeshift']&&settings[_0x32f179(0x2d0)]!==0x0)_0xf083ef=fns[_0x32f179(0x1ba)](_0x4e5e27,{'hours':settings['timeshift']});return _0xf083ef;}function startScheduler(){const _0x3a1849=_0x41dc7e,_0x5cd466=new Date()[_0x3a1849(0x246)](),_0x13ac00=shiftedTime()[_0x3a1849(0x27c)]();_0x13ac00==0x4&&backupConfigFiles();_0x13ac00==0x0&&rotateLogFiles();_0x5cd466%0x6==0x0&&triggerAnalytics();_0x5cd466%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x493b23){const _0x46f1ef=_0x41dc7e;logger[_0x46f1ef(0x240)](_0x46f1ef(0x24c)+_0x493b23);const _0x39e3ce=getBotsWithMode();_0x39e3ce[_0x46f1ef(0x152)]>0x0?confirmRestore(configbackuppath,_0x493b23):unzipFile(configbackuppath,_0x493b23);}async function getBackupFiles(_0x2f3553=null){const _0x372593=_0x41dc7e;let _0x447bc7=[],_0x59751f=fs[_0x372593(0x2cc)](configbackuppath,{'withFileTypes':!![]});_0x59751f[_0x372593(0x156)]((_0x2f59c7,_0x1a164f)=>_0x2f59c7[_0x372593(0x281)]<_0x1a164f['name']?0x1:_0x1a164f[_0x372593(0x281)]<_0x2f59c7[_0x372593(0x281)]?-0x1:0x0),_0x59751f[_0x372593(0x25e)](_0x2099a8=>{const _0x3c9308=_0x372593;if(!_0x2099a8[_0x3c9308(0x293)]()&&_0x2099a8['name']['startsWith'](_0x3c9308(0x1c9))&&_0x2099a8[_0x3c9308(0x281)]['endsWith']('.zip')){const _0x394a62=formatDate(fs[_0x3c9308(0x242)](configbackuppath+_0x2099a8[_0x3c9308(0x281)])[_0x3c9308(0x29e)]);_0x447bc7['push']({'name':_0x2099a8[_0x3c9308(0x281)],'mtime':_0x394a62});}});if(_0x2f3553)io['to'](_0x2f3553)[_0x372593(0x2a0)]('backup-files',_0x447bc7);else return _0x447bc7;}async function backupConfigFiles(){const _0x6d2c88=_0x41dc7e;await zipFiles('backup-full');const _0x46d4c1=getCleanTimeStamp();fs[_0x6d2c88(0x1f6)](zippath+_0x6d2c88(0x2e7),configbackuppath+('backup-full@'+_0x46d4c1+_0x6d2c88(0x1ec)));let _0x22f071=fs[_0x6d2c88(0x2cc)](configbackuppath,{'withFileTypes':!![]});_0x22f071[_0x6d2c88(0x156)]((_0x4e8240,_0x31ec14)=>_0x4e8240['name']<_0x31ec14[_0x6d2c88(0x281)]?0x1:_0x31ec14[_0x6d2c88(0x281)]<_0x4e8240[_0x6d2c88(0x281)]?-0x1:0x0),_0x22f071[_0x6d2c88(0x152)]>maxBackups&&fs[_0x6d2c88(0x211)](configbackuppath+_0x22f071[_0x22f071[_0x6d2c88(0x152)]-0x1]['name']);}function rotateLogFiles(){const _0xbf6d38=_0x41dc7e,_0x1bc9f2=fs[_0xbf6d38(0x242)](logspath+_0xbf6d38(0x27a)),_0x295432=_0x1bc9f2[_0xbf6d38(0x179)]/0x400;if(_0x295432>0x64){let _0x385bf9=fs[_0xbf6d38(0x2cc)](logspath,{'withFileTypes':!![]});_0x385bf9['sort']((_0x47dd80,_0x5575d4)=>_0x47dd80[_0xbf6d38(0x281)]<_0x5575d4['name']?0x1:_0x5575d4[_0xbf6d38(0x281)]<_0x47dd80[_0xbf6d38(0x281)]?-0x1:0x0),_0x385bf9['forEach'](_0x2d3e1b=>{const _0x593d75=_0xbf6d38;if(_0x2d3e1b['name']=='output-002.log')fs[_0x593d75(0x1f6)](logspath+_0x2d3e1b['name'],logspath+'output-003.log');if(_0x2d3e1b[_0x593d75(0x281)]==_0x593d75(0x174))fs[_0x593d75(0x1f6)](logspath+_0x2d3e1b[_0x593d75(0x281)],logspath+_0x593d75(0x2b2));_0x2d3e1b[_0x593d75(0x281)]==_0x593d75(0x27a)&&(fs['copyFileSync'](logspath+_0x2d3e1b[_0x593d75(0x281)],logspath+'output-001.log'),fs[_0x593d75(0x121)](logspath+_0x2d3e1b[_0x593d75(0x281)],''));});}}async function zipFiles(_0xfe0754){const _0x3b5b39=_0x41dc7e;let _0x518fbd;if(_0xfe0754=='logs')_0x518fbd=logspath;if(_0xfe0754==_0x3b5b39(0x11f))_0x518fbd=configpath;if(_0xfe0754==_0x3b5b39(0x11c))_0x518fbd=configpath;let _0x305199=fs[_0x3b5b39(0x2cc)](_0x518fbd,{'withFileTypes':!![]});const _0x4f0401=new require(_0x3b5b39(0x153))();_0x305199[_0x3b5b39(0x25e)](_0x820b1=>{const _0x384ea0=_0x3b5b39;if(!_0x820b1[_0x384ea0(0x293)]()){let _0x3b5388=fs[_0x384ea0(0x1a4)](_0x518fbd+_0x820b1[_0x384ea0(0x281)]);if(_0xfe0754==_0x384ea0(0x11f)){const _0x1c073f=/^bot-[0-9]{3}-config.json$/,_0xe25930=_0x1c073f['test'](_0x820b1[_0x384ea0(0x281)]);if(_0xe25930){const _0x5e8c89=JSON[_0x384ea0(0x198)](_0x3b5388);if(_0x5e8c89['bot'][0x0]){_0x5e8c89['bot'][0x0]['apiKey']=_0x384ea0(0x197),_0x5e8c89['bot'][0x0][_0x384ea0(0x12d)]=_0x384ea0(0x197);if(_0x5e8c89[_0x384ea0(0x214)][0x0][_0x384ea0(0x2e8)])_0x5e8c89[_0x384ea0(0x214)][0x0]['apiPassword']='***';}_0x3b5388=JSON[_0x384ea0(0x258)](_0x5e8c89,null,0x2);}if(_0x820b1[_0x384ea0(0x281)]=='bb-settings.json'){const _0x243e20=JSON[_0x384ea0(0x198)](_0x3b5388);if(_0x243e20[_0x384ea0(0x251)]['loginRequired'])_0x243e20[_0x384ea0(0x251)][_0x384ea0(0x2d9)]=![];if(_0x243e20[_0x384ea0(0x251)][_0x384ea0(0x2cf)])_0x243e20[_0x384ea0(0x251)][_0x384ea0(0x2cf)]='***';if(_0x243e20[_0x384ea0(0x251)]['telegramToken'])_0x243e20[_0x384ea0(0x251)]['telegramToken']=_0x384ea0(0x197);if(_0x243e20[_0x384ea0(0x251)][_0x384ea0(0x1a8)])_0x243e20[_0x384ea0(0x251)][_0x384ea0(0x1a8)]=null;_0x3b5388=JSON[_0x384ea0(0x258)](_0x243e20,null,0x2);}if(_0x820b1[_0x384ea0(0x281)]!=_0x384ea0(0x1dd))_0x4f0401[_0x384ea0(0x256)](_0x820b1[_0x384ea0(0x281)],_0x3b5388);}else _0x4f0401[_0x384ea0(0x256)](_0x820b1[_0x384ea0(0x281)],_0x3b5388);}});const _0x223602=_0x4f0401[_0x3b5b39(0x21c)]({'base64':![],'compression':_0x3b5b39(0x2ab)});fs['writeFileSync'](zippath+(_0xfe0754+_0x3b5b39(0x1ec)),_0x223602,_0x3b5b39(0x119));}async function unzipFile(_0x37e4e0,_0x37a272){const _0x564594=_0x41dc7e;fs[_0x564594(0x2cc)](configpath,{'withFileTypes':!![]})[_0x564594(0x25e)](_0x311f07=>{const _0x3556ac=_0x564594;if(!_0x311f07[_0x3556ac(0x293)]())fs[_0x3556ac(0x230)](configpath+_0x311f07[_0x3556ac(0x281)]);});const _0x1e9de0=fs[_0x564594(0x1a4)](_0x37e4e0+_0x37a272,_0x564594(0x119)),_0x201822=new require(_0x564594(0x153))(_0x1e9de0,{'base64':![],'checkCRC32':!![]});Object[_0x564594(0x260)](_0x201822[_0x564594(0x18a)])[_0x564594(0x25e)](_0x19b66d=>{const _0x5ef53f=_0x564594,_0x277c83=_0x201822[_0x5ef53f(0x18a)][_0x19b66d];fs[_0x5ef53f(0x121)](configpath+_0x277c83[_0x5ef53f(0x281)],_0x277c83['_data']);}),fs[_0x564594(0x2cc)](temppath,{'withFileTypes':!![]})['forEach'](_0x5132df=>{const _0x665730=_0x564594;if(!_0x5132df['isDirectory']())fs['rmSync'](temppath+_0x5132df[_0x665730(0x281)]);}),logger[_0x564594(0x240)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x564594(0x2f2)]({'restore':!![]},_0x1500ca=>{});}async function getPublicIp(){const _0x2b03a5=_0x41dc7e;try{const _0x5946c5=await axios[_0x2b03a5(0x222)](_0x2b03a5(0x2c9));publicip=_0x5946c5[_0x2b03a5(0x253)]['ip'];}catch(_0x15bd2c){}}async function triggerAnalytics(){const _0x300475=_0x41dc7e;if(!publicip)await getPublicIp();const _0x2d1fe1=getBotsWithMode();let _0x406f11=0x0;_0x2d1fe1[_0x300475(0x25e)](_0x3aa530=>{const _0x1d2dce=_0x300475;if(_0x3aa530['status']===_0x1d2dce(0x1ce))_0x406f11++;});const _0x53df15=getBotExchanges();mixpanel[_0x300475(0x233)](_0x300475(0x2ae),{'distinct_id':settings[_0x300475(0x18e)],'ip':publicip,'version':serverversion,'numbots':_0x2d1fe1[_0x300475(0x152)],'numbotsenabled':_0x406f11,'exchanges':_0x53df15,'environment':environment});}async function getMessages(){const _0x5dc02b=_0x41dc7e,_0x19ab80=_0x5dc02b(0x1d5),_0x2255f7=new GraphQLClient(_0x19ab80),_0x5e968a={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x2dbeb5=serverversion[_0x5dc02b(0x1e1)]('.'),_0x75fd8e=_0x2dbeb5[0x0]+'.'+_0x2dbeb5[0x1],_0x2f6fcf=Math['min'](settings[_0x5dc02b(0x118)],settings[_0x5dc02b(0x2c5)]),_0x44694a={'last':parseInt(_0x2f6fcf),'bbm':_0x75fd8e},_0x2f048b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2d62fb;try{_0x2d62fb=await _0x2255f7[_0x5dc02b(0x1d9)](_0x2f048b,_0x44694a,_0x5e968a);}catch(_0x2349ae){}if(_0x2d62fb&&_0x2d62fb[_0x5dc02b(0x141)]){let _0x83d3e3=settings['lastmsgtelegram'];newMessages=[];for(const _0x3ca665 of _0x2d62fb[_0x5dc02b(0x141)]){newMessages[_0x5dc02b(0x2c6)](_0x3ca665);let _0x1d74a7=![];_0x3ca665[_0x5dc02b(0x26d)]&&(updateSetting(_0x5dc02b(0x29d),_0x3ca665['bbvNew']),_0x1d74a7=isNewerVersion(serverversion,_0x3ca665['bbvNew'])||serverversion==_0x3ca665[_0x5dc02b(0x26d)]);if(!_0x1d74a7&&_0x3ca665['number']>_0x83d3e3){if(_0x3ca665[_0x5dc02b(0x2ba)]===_0x5dc02b(0x17f)||serverversion[_0x5dc02b(0x1c3)](_0x3ca665[_0x5dc02b(0x2ba)])){let _0x5c4524=''+_0x3ca665['title']+'\x0a\x0a'+_0x3ca665[_0x5dc02b(0x29a)];const _0x19b12b=await sendTelegramMsg(toTelegramMarkdown(_0x5c4524),_0x5dc02b(0x1fc));if(_0x19b12b)_0x83d3e3=_0x3ca665[_0x5dc02b(0x292)];}}}updateAvailable=isNewerVersion(settings[_0x5dc02b(0x29d)],serverversion),updateSetting(_0x5dc02b(0x118),_0x83d3e3),emitMessages();}}function emitMessages(){const _0x515c4f=_0x41dc7e,_0x2dd554=settings[_0x515c4f(0x2c5)];let _0x2a0233=[];newMessages['forEach'](_0x38ae0b=>{const _0x406745=_0x515c4f;_0x38ae0b[_0x406745(0x292)]>_0x2dd554&&_0x2a0233[_0x406745(0x2c6)](_0x38ae0b);}),_0x2a0233[_0x515c4f(0x152)]>0x0&&getAllClients()[_0x515c4f(0x25e)](_0x7076ab=>{const _0x585299=_0x515c4f;getSocket(_0x7076ab['id'])[_0x585299(0x2a0)]('message',_0x2a0233);});}function confirmMessage(_0x137b37){updateSetting('lastmsgemitted',Number(_0x137b37));}function isNewerVersion(_0xdcc796,_0x261cae){const _0x2abb27=_0x41dc7e,_0x5af6fe=_0x261cae[_0x2abb27(0x1e1)]('.'),_0x4357b0=_0xdcc796['split']('.');for(var _0x1a7382=0x0;_0x1a7382<_0x4357b0['length'];_0x1a7382++){const _0x12c791=~~_0x4357b0[_0x1a7382],_0x13fdc0=~~_0x5af6fe[_0x1a7382];if(_0x12c791>_0x13fdc0)return!![];if(_0x12c791<_0x13fdc0)return![];}return![];}function toTelegramMarkdown(_0x1f66c7){const _0x10f754=_0x41dc7e,_0x18cb49=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x20fa1d=/\*{2}(.+?)\*{2}/gim;return _0x1f66c7=_0x1f66c7[_0x10f754(0x113)](_0x18cb49,_0x10f754(0x15a))[_0x10f754(0x113)](_0x20fa1d,_0x10f754(0x17e)),_0x1f66c7;}async function validateConfigFile(){const _0x480222=_0x41dc7e,_0x2b637a=dbConfig[_0x480222(0x222)](_0x480222(0x13c))[_0x480222(0x2ea)](_0x480222(0x1d6))[_0x480222(0x2bb)]()||[];if(_0x2b637a[_0x480222(0x152)]==0x0){let _0x2d8615=0x0,_0x1fe2d4=[];const _0x45406b=/^bot-([0-9]{3})-config.json$/,_0x2a3e85=fs['readdirSync'](configpath);_0x2a3e85['forEach'](_0x48a4b5=>{const _0x452ea6=_0x480222,_0x525cfe=_0x45406b['exec'](_0x48a4b5);if(_0x525cfe){const _0x4408e3=_0x525cfe[0x1];let _0x4d35d0=getBotAttributes(_0x4408e3);_0x1fe2d4[_0x452ea6(0x2c6)]({'botID':_0x4408e3,'botname':_0x4d35d0[_0x452ea6(0x126)],'status':_0x452ea6(0x14f),'live':_0x452ea6(0x162)}),_0x2d8615++;}}),_0x2d8615!=0x0&&(dbConfig['get'](_0x480222(0x13c))[_0x480222(0x22b)](_0x1fe2d4)[_0x480222(0x1dc)](),config=_0x1fe2d4,restoredConfigFile=_0x2d8615);}}async function restoreConfigNotify(_0x485e08){const _0x45e7b0=_0x41dc7e;let _0x3bafbe;if(restoredConfigFile==0x1)_0x3bafbe=_0x45e7b0(0x1b8);else _0x3bafbe=_0x45e7b0(0x274);if(_0x485e08)io['to']('botmanager')[_0x45e7b0(0x2a0)](_0x45e7b0(0x1b7),_0x3bafbe);else{logger[_0x45e7b0(0x237)](_0x45e7b0(0x1e2)),logger['simple'](_0x3bafbe),logger['simple'](_0x45e7b0(0x1e2)),logger[_0x45e7b0(0x237)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x45e7b0(0x155)]!=_0x45e7b0(0x1d3))tgBot[_0x45e7b0(0x124)](settings[_0x45e7b0(0x1a8)],_0x45e7b0(0x217)+_0x3bafbe)[_0x45e7b0(0x2e0)](_0x1fd0da=>{telegramError(_0x1fd0da);});}}function validateCredentials(_0x2e12de,_0x17a15a){const _0xb456db=_0x41dc7e;if(_0x2e12de[_0xb456db(0x284)]==settings['bbUsername']&&bcrypt[_0xb456db(0x249)](_0x2e12de[_0xb456db(0x209)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0xb456db(0x150),'token':null};else{const _0x54fa8d=generateLoginToken(_0x17a15a);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x54fa8d};}}else return{'allow':![],'reason':_0xb456db(0x184),'token':null};}function refreshToken(_0x1c442d){const _0xd3fc1f=_0x41dc7e,_0x3401de=generateLoginToken(_0x1c442d);return{'allow':!![],'reason':_0xd3fc1f(0x191),'token':_0x3401de};}function validateAccess(_0x322bec,_0x5aa32e,_0x272733){const _0x464fa5=_0x41dc7e,_0x1b5f1f=_0x272733?_0x272733:devices[_0x5aa32e]['ip'];let _0x45fd93;const _0x2f8a4b=_0x2730cb=>{const _0x6bc9c7=_0x5afd;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x5aa32e)){const _0x5ed4a0=generateLoginToken(_0x5aa32e);return{'allow':!![],'reason':_0x6bc9c7(0x204),'token':_0x5ed4a0};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x45fd93=validToken(_0x2730cb,_0x5aa32e),_0x45fd93[_0x6bc9c7(0x140)](_0x6bc9c7(0x14d))?{'allow':!![],'reason':_0x6bc9c7(0x132),'token':_0x2730cb}:{'allow':![],'reason':_0x6bc9c7(0x13b),'token':null};}else return{'allow':!![],'reason':_0x6bc9c7(0x25f),'token':null};};if(settings['whitelistEnabled']){let _0x2f22b2=[...settings['whitelist'],_0x464fa5(0x2f0),_0x464fa5(0x2c3),_0x464fa5(0x1a7)];if(_0x2f22b2[_0x464fa5(0x1b2)](_0x1b5f1f))return _0x2f8a4b(_0x322bec);else{_0x45fd93=validToken(_0x322bec,_0x5aa32e);if(_0x45fd93['hasOwnProperty'](_0x464fa5(0x14d)))return _0x2f8a4b(_0x322bec);else{if(telegramIpApproved(_0x5aa32e)){const _0x139a98=generateToken(_0x5aa32e);return _0x45fd93=_0x2f8a4b(_0x322bec),_0x45fd93[_0x464fa5(0x2a5)]?{'allow':!![],'reason':_0x464fa5(0x245),'token':_0x139a98}:_0x45fd93;}else return settings[_0x464fa5(0x164)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x464fa5(0x2d1),'token':null};}}}else return _0x2f8a4b(_0x322bec);}function timelyDecrypt(_0x6db1b4,_0x4e2125=!![]){const _0x59696a=_0x41dc7e;if(_0x6db1b4)try{const _0x39a478=crypt[_0x59696a(0x25a)](secure['privateKey'],_0x6db1b4)[_0x59696a(0x29a)],_0x4e0a84=_0x39a478[_0x59696a(0x1e1)]('@')[0x0],_0x434cc0=_0x39a478[_0x59696a(0x1e1)]('@')[0x1],_0x524329=new Date()['getTime']();if(_0x4e2125){if(_0x524329-_0x434cc0<maxSecretAge*0x3e8)return _0x4e0a84;else return![];}else return _0x4e0a84;}catch(_0x3090de){return![];}else return![];}const validToken=(_0x54a6da,_0xcc2ff1)=>{const _0x1ff70b=_0x41dc7e,_0xad8741=devices[_0xcc2ff1]['ip'];if(!_0x54a6da)return{'error':_0x1ff70b(0x1a6)};for(let _0x4f3979 of blacklist){if(_0x4f3979[_0x1ff70b(0x1d8)]==_0x54a6da)return{'error':'Token\x20blacklisted'};}let _0x2af5a1;try{_0x2af5a1=jwt[_0x1ff70b(0x13d)](_0x54a6da,secure[_0x1ff70b(0x243)]+_0xcc2ff1);}catch{return{'error':_0x1ff70b(0x167)};}if(!_0x2af5a1['hasOwnProperty'](_0x1ff70b(0x205))&&!_0x2af5a1[_0x1ff70b(0x140)](_0x1ff70b(0x284))||!_0x2af5a1[_0x1ff70b(0x140)](_0x1ff70b(0x22e)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x2af5a1['hasOwnProperty']('username')&&_0x2af5a1['hasOwnProperty'](_0x1ff70b(0x205))){const {clientip:_0x238719}=_0x2af5a1;return _0xad8741==_0x238719?{'success':_0x1ff70b(0x18d)}:{'error':_0x1ff70b(0x1a5)};}else{if(_0x2af5a1['hasOwnProperty'](_0x1ff70b(0x284))&&_0x2af5a1[_0x1ff70b(0x140)](_0x1ff70b(0x205))){const {username:_0x59e352,clientip:_0x119d99}=_0x2af5a1;return settings[_0x1ff70b(0x2ee)]==_0x59e352&&_0xad8741==_0x119d99?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1ff70b(0x2ed)};}}},generateLoginToken=_0x2b8a32=>{const _0x5cac3c=_0x41dc7e;if(_0x2b8a32){const _0x2c112a=devices[_0x2b8a32]['ip'];return jwt['sign']({'username':settings[_0x5cac3c(0x2ee)],'clientip':_0x2c112a},secure['secret']+_0x2b8a32,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x371339=>{const _0x1ec397=_0x41dc7e;if(_0x371339){const _0x579326=devices[_0x371339]['ip'];return jwt['sign']({'clientip':_0x579326},secure['secret']+_0x371339,{'expiresIn':devices[_0x371339][_0x1ec397(0x1a1)][_0x1ec397(0x165)]*0x3c});}else return![];},telegramIpApproved=_0x2fecea=>{const _0x56da96=_0x41dc7e;let _0x50dcc6=![];return devices[_0x2fecea][_0x56da96(0x1a1)]&&devices[_0x2fecea][_0x56da96(0x1a1)][_0x56da96(0x165)]!=_0x56da96(0x2da)&&(_0x50dcc6=devices[_0x2fecea]['telegramIpApproval']['clientip']==devices[_0x2fecea]['ip']&&new Date()[_0x56da96(0x20e)]()-devices[_0x2fecea][_0x56da96(0x1a1)][_0x56da96(0x2ac)]<devices[_0x2fecea][_0x56da96(0x1a1)]['expiry']*0x3c*0x3e8),_0x50dcc6;},telegram2FaApproved=_0x558b27=>{const _0x3f449f=_0x41dc7e;let _0x586605=![];return devices[_0x558b27][_0x3f449f(0x20b)]&&devices[_0x558b27]['telegram2FaApproval'][_0x3f449f(0x165)]!=_0x3f449f(0x2da)&&(_0x586605=devices[_0x558b27]['telegram2FaApproval'][_0x3f449f(0x205)]==devices[_0x558b27]['ip']&&new Date()[_0x3f449f(0x20e)]()-devices[_0x558b27]['telegram2FaApproval'][_0x3f449f(0x2ac)]<devices[_0x558b27][_0x3f449f(0x20b)][_0x3f449f(0x165)]*0x3c*0x3e8),_0x586605;},normalizeIP=_0x39936c=>{const _0x4e5919=_0x41dc7e;let _0x2e545b=null,_0x25ce9f=null;if(ipaddr['isValid'](_0x39936c)){const _0x451c38=ipaddr[_0x4e5919(0x198)](_0x39936c);_0x451c38['kind']()===_0x4e5919(0x22c)?(_0x451c38[_0x4e5919(0x21f)]()&&(_0x2e545b=_0x451c38[_0x4e5919(0x1f9)]()['toString']()),_0x25ce9f=_0x451c38['toString']()):(_0x2e545b=_0x451c38[_0x4e5919(0x128)](),_0x25ce9f=_0x451c38[_0x4e5919(0x2bf)]()[_0x4e5919(0x128)]());}return{'show':_0x2e545b?_0x2e545b:_0x25ce9f,'store':_0x25ce9f};};function formatDate(_0x456cfe){const _0xe0a6d=_0x41dc7e;return _0x456cfe[_0xe0a6d(0x2dd)]()+'/'+(_0x456cfe[_0xe0a6d(0x129)]()+0x1)[_0xe0a6d(0x128)]()[_0xe0a6d(0x275)](0x2,'0')+'/'+_0x456cfe[_0xe0a6d(0x15d)]()[_0xe0a6d(0x128)]()[_0xe0a6d(0x275)](0x2,'0')+'\x20'+_0x456cfe[_0xe0a6d(0x27c)]()['toString']()[_0xe0a6d(0x275)](0x2,'0')+':'+_0x456cfe[_0xe0a6d(0x2d7)]()['toString']()[_0xe0a6d(0x275)](0x2,'0')+':'+_0x456cfe[_0xe0a6d(0x2a8)]()['toString']()[_0xe0a6d(0x275)](0x2,'0');}function sleep(_0x48b657){return new Promise(_0xb02d6d=>setTimeout(_0xb02d6d,_0x48b657));}