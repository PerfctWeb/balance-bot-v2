const _0x2a3cae=_0x2654;(function(_0x5108cb,_0x5aac2b){const _0x5d1060=_0x2654,_0x12865c=_0x5108cb();while(!![]){try{const _0x1f376e=-parseInt(_0x5d1060(0x329))/0x1+parseInt(_0x5d1060(0x234))/0x2+-parseInt(_0x5d1060(0x2c4))/0x3+parseInt(_0x5d1060(0x2fb))/0x4*(parseInt(_0x5d1060(0x306))/0x5)+parseInt(_0x5d1060(0x1e5))/0x6+parseInt(_0x5d1060(0x20f))/0x7*(parseInt(_0x5d1060(0x205))/0x8)+parseInt(_0x5d1060(0x31d))/0x9*(parseInt(_0x5d1060(0x30b))/0xa);if(_0x1f376e===_0x5aac2b)break;else _0x12865c['push'](_0x12865c['shift']());}catch(_0x3ab6eb){_0x12865c['push'](_0x12865c['shift']());}}}(_0x1857,0xaf09c));const _0x2aaafd=function(){let _0x3da9cd=!![];return function(_0x999a0f,_0x13d7a9){const _0x422835=_0x3da9cd?function(){const _0x1fc01b=_0x2654;if(_0x13d7a9){const _0x357ff9=_0x13d7a9[_0x1fc01b(0x32c)](_0x999a0f,arguments);return _0x13d7a9=null,_0x357ff9;}}:function(){};return _0x3da9cd=![],_0x422835;};}(),_0x59e805=_0x2aaafd(this,function(){const _0x31db97=_0x2654;return _0x59e805[_0x31db97(0x2d1)]()[_0x31db97(0x2ec)](_0x31db97(0x1e6))[_0x31db97(0x2d1)]()['constructor'](_0x59e805)[_0x31db97(0x2ec)](_0x31db97(0x1e6));});_0x59e805();'use strict';process[_0x2a3cae(0x316)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),FileSync=require(_0x2a3cae(0x328)),fs=require('fs'),fns=require(_0x2a3cae(0x2a1)),low=require('lowdb'),path=require(_0x2a3cae(0x320)),crypto=require(_0x2a3cae(0x22b)),Crypt=require('hybrid-crypto-js')[_0x2a3cae(0x247)],RSA=require('hybrid-crypto-js')[_0x2a3cae(0x2a7)],bcrypt=require('bcryptjs'),jwt=require(_0x2a3cae(0x32f)),analyticsLib=require(_0x2a3cae(0x28d))[_0x2a3cae(0x245)],googleAnalytics=require(_0x2a3cae(0x29d))[_0x2a3cae(0x245)],ipaddr=require(_0x2a3cae(0x2ff)),argv=require(_0x2a3cae(0x203))(process[_0x2a3cae(0x32b)][_0x2a3cae(0x258)](0x2))[_0x2a3cae(0x32b)],PORT=argv[_0x2a3cae(0x1e9)]||_0x2a3cae(0x201),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x2a3cae(0x24d)](PORT))return console[_0x2a3cae(0x1dc)](_0x2a3cae(0x2d3)+PORT+_0x2a3cae(0x22d)),process['exit'](0x1);const HOST=argv[_0x2a3cae(0x325)]||null,userID=argv[_0x2a3cae(0x317)]||'';let bbpath=_0x2a3cae(0x32d),bbpath2='';const botfile=_0x2a3cae(0x251),configfile=_0x2a3cae(0x275),settingsfile=_0x2a3cae(0x2a2),securefile=_0x2a3cae(0x285),validInstallation=fs['existsSync'](_0x2a3cae(0x319));!fs[_0x2a3cae(0x257)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2a3cae(0x21a)),configpath=userID?bbpath+_0x2a3cae(0x2d0)+userID+'/':bbpath+_0x2a3cae(0x2d0),configbackuppath=configpath+_0x2a3cae(0x2d8);!fs[_0x2a3cae(0x257)](configpath)&&fs[_0x2a3cae(0x1fd)](configpath);!fs[_0x2a3cae(0x257)](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x2a3cae(0x246)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2a3cae(0x26f)]({'settings':{'timeshift':0x0}})[_0x2a3cae(0x246)]();function _0x1857(){const _0x126374=['************','data','Unauthorized\x20attempt\x20to\x20store\x20configuration','filter','static','compareSync','getTime','server','Ok,\x20will\x20send\x20order\x20notifications\x20only','match','Token\x20blacklisted','\x20minutes','Balance\x20Bot','Invalid\x20IP\x20address','idling\x20bot\x20\x20\x20|\x20Bot\x20','add','store-headless','connection','hashSync','join','No\x20bots\x20running\x20right\x20now','defaults','placeOrder','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','socket.io','restart','padStart','bb-config.json','No\x20authentication\x20token','reset-password','once','1000','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','isIPv4MappedAddress','send','Login\x20rejected','/:bot/performance','<b>Balance\x20Bot\x20status:</b>\x0a','orders','login\x20required','answerCallbackQuery','expiry','login\x20not\x20required','bb-secure.json','enabled','Unauthorized\x20attempt\x20to\x20update\x20settings','privateKey','find','telegramEnabled','clientip','All\x20bots','analytics','Notifications\x20disabled','bbPassword','set','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','\x20>\x20','bbUsername','update-bb','\x20only\x0a','/:bot/history','update-bot','User\x20has\x20been\x20validated','Alerts','invalid\x20credentials','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','All\x20bots\x20running\x20right\x20now','@analytics/google-analytics','getSeconds','add-bot','stopPolling','date-fns','bb-settings.json','conn','sign','\x20/\x20','accept','RSA','30\x20min','HTML','stopped','disabled','getUTCHours','delete-bot','chat','bot-','notification','args','map','keys','cancel-loading','show','Notifications\x20enabled\x0a','temporary\x20access\x20rejected','remoteAddress','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','temporary\x20access\x20not\x20allowed','then','handshake','telegramEvents','reject','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/:bot/portfolio','emit','3327210QdzNPn','Notifications\x20enabled','starting\x20new\x20bot\x20|\x20Bot\x20','\x20|\x20','secure','split','forEach','whitelistEnabled','parse','Unauthorized\x20attempt\x20to\x20add\x20bot','get-logs','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','config/','toString','referer','Error:\x20Invalid\x20argument\x20','pidRefreshToken','uuid','secret','bots','backup/','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','live','botmanager','sortBy','/off\x20-\x20stop\x20bot(s)\x0a','node-telegram-bot-api','timeshift','2FA\x20required','cancelLoading','inherit','::ffff:127.0.0.1','cloneDeep','running','telegramUsername','Password\x20has\x20been\x20reset\x20to:\x20','/status\x20-\x20show\x20bot(s)\x20status\x0a','/:bot','Allow\x20login\x20from\x20IP\x20address\x20<b>','bot','search','isDirectory','connected','catch','get','username','listen','initclient','access\x20timeout','Balance\x20Bot\x20Server','password','starting\x20bot\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','5\x20min','index.html','1708TNtclX','copyFileSync','randomFillSync','loginRequired','ipaddr.js','http','SIGTERM','Temporary\x20access\x20rejected','encryptedUuid','removeListener','build2','15295sCJOSt','alerts','Unauthorized\x20attempt\x20to\x20update\x20bot','2FA\x20login\x20token\x20generated','disconnect','1870Iedyey','Invalid\x20Telegram\x20token','telegramIpApproval','telegram','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','deleted\x20Bot\x20','Password\x20reset\x20rejected','hasOwnProperty','Invalid\x20authentication\x20token\x20(2)','function','-events.json','env','user','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','../install.js','blacklist','entries','name','37917qaKDIZ','15\x20min','/help\x20-\x20show\x20available\x20commands\x0a','path','removeAllListeners','type','status','https://hodlerhacks.com','host','telegram2FaApproval','stop','lowdb/adapters/FileSync','1104269YOdCgo','logged\x20out','argv','apply','bb/','yes','jsonwebtoken','sendMessage','all','place-order','getDate','version.json','log','getMinutes','toIPv4Address','kill','express','-results.json','2FA','getPortfolio','logout','2871666OhygPD','(((.+)+)+)+$','login\x20token\x20valid','SIGINT','port','Invalid\x20authentication\x20token\x20(1)','2FA\x20login\x20required','Unauthorized\x20login\x20attempt\x20(timeout)','verify','/disable\x20-\x20disable\x20notifications\x0a','sha256','botID',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','store-configuration','-----------------------------------------------------------------------------------','getFullYear','use','settings.','error','exit','started','randomBytes','botname','Notifications\x20disabled\x0a','mkdirSync','disabled\x20Bot\x20','whitelist','reload','3000','-performance.json','yargs/yargs','build','8iTeLXy','message','event','/:bot/coins','new-disabled','headers','sendFile','decrypt','temporary\x20access\x20timeout','readdirSync','242599VRJLYv','telegramToken','Bot\x20','allow','telegramChatId','Notifications\x20types:\x20','UA-192771731-1','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','token','onText','2FA\x20login\x20rejected','clients','get-starting-balances','remove','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','getMonth','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','page','pidExpireLogin','callback_query','ipc','emitHistory','fork','enabled\x20Bot\x20','publicKey','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','store-settings','crypto','generateKeyPairAsync',',\x20must\x20be\x20a\x204\x20digit\x20number','timestamp','404\x20Not\x20Found','127.0.0.1','f2aRequired','polling_error','reason','646006NEAOeV','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','push','value','get-portfolio','unlinkSync','createServer','Access\x20enabled\x20for\x20','Login\x20accepted','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','assign','new','max','Orders','access','from','default','write','Crypt','Unauthorized\x20attempt\x20to\x20log\x20out','<b>Telegram\x20bot\x20status:</b>\x0a','success','sockets','::1','test','login','-config.json','storeConfiguration','bot.js','login\x20token\x20generated','/restart\x20-\x20restart\x20bot(s)\x0a','length','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','settings','existsSync','slice','temporaryAccessAllowed'];_0x1857=function(){return _0x126374;};return _0x1857();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2a3cae(0x26f)]({'secure':{},'blacklist':[]})[_0x2a3cae(0x246)]();let crypt=new Crypt({'md':_0x2a3cae(0x1ef),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2a3cae(0x1db))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x2a3cae(0x1e0)),app=express(),http=require(_0x2a3cae(0x300))[_0x2a3cae(0x23a)](app);app[_0x2a3cae(0x1f5)](express[_0x2a3cae(0x25e)](path[_0x2a3cae(0x26d)](__dirname,bbpath2,_0x2a3cae(0x305)))),app['use'](express[_0x2a3cae(0x25e)](path[_0x2a3cae(0x26d)](__dirname,bbpath2,'build'))),app[_0x2a3cae(0x2f0)]('/',function(_0x14db91,_0x163f20){const _0xe8e0a5=_0x2a3cae;_0x163f20['sendFile'](path['join'](__dirname,bbpath2,'build2',_0xe8e0a5(0x2fa)));}),app[_0x2a3cae(0x2f0)](_0x2a3cae(0x2e9),function(_0x79ca71,_0x1bd57e){const _0x258c4c=_0x2a3cae;_0x1bd57e[_0x258c4c(0x20b)](path[_0x258c4c(0x26d)](__dirname,bbpath2,_0x258c4c(0x204),_0x258c4c(0x2fa)));}),app[_0x2a3cae(0x2f0)](_0x2a3cae(0x2c2),(_0x13fd5a,_0x1e3d9a)=>{const _0x52de71=_0x2a3cae;_0x1e3d9a['sendFile'](path[_0x52de71(0x26d)](__dirname,bbpath2,_0x52de71(0x204),_0x52de71(0x2fa)));}),app['get'](_0x2a3cae(0x27e),(_0xb2d1d3,_0x55904a)=>{const _0x44cf69=_0x2a3cae;_0x55904a['sendFile'](path['join'](__dirname,bbpath2,'build',_0x44cf69(0x2fa)));}),app[_0x2a3cae(0x2f0)](_0x2a3cae(0x208),(_0x405185,_0x14f49d)=>{const _0x55618c=_0x2a3cae;_0x14f49d[_0x55618c(0x20b)](path['join'](__dirname,bbpath2,_0x55618c(0x204),'index.html'));}),app[_0x2a3cae(0x2f0)](_0x2a3cae(0x296),(_0xea33cf,_0x5763c0)=>{const _0x59be74=_0x2a3cae;_0x5763c0['sendFile'](path[_0x59be74(0x26d)](__dirname,bbpath2,_0x59be74(0x204),_0x59be74(0x2fa)));}),app[_0x2a3cae(0x2f0)]('/:bot/configuration',(_0x1f84d6,_0x41467e)=>{const _0x2d9109=_0x2a3cae;_0x41467e['sendFile'](path[_0x2d9109(0x26d)](__dirname,bbpath2,'build','index.html'));}),app[_0x2a3cae(0x2f0)]('/:bot/support',(_0x4562a6,_0x1d95eb)=>{const _0x4ec992=_0x2a3cae;_0x1d95eb['sendFile'](path[_0x4ec992(0x26d)](__dirname,bbpath2,_0x4ec992(0x204),_0x4ec992(0x2fa)));});if(HOST)http[_0x2a3cae(0x2f2)](PORT,HOST);else http['listen'](PORT);const io=require(_0x2a3cae(0x272))(http,{}),analytics=analyticsLib({'app':_0x2a3cae(0x266),'plugins':[googleAnalytics({'trackingId':_0x2a3cae(0x215)})]}),TelegramBot=require(_0x2a3cae(0x2de));let tgBot;if(settings[_0x2a3cae(0x210)]&&settings[_0x2a3cae(0x210)]!=''&&settings[_0x2a3cae(0x2e6)]&&settings[_0x2a3cae(0x2e6)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x1b6b5c=_0x2a3cae;console['log'](''),console[_0x1b6b5c(0x1dc)](_0x1b6b5c(0x1f3)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x1b6b5c(0x1dc)](_0x1b6b5c(0x1f3));if(config[_0x1b6b5c(0x254)]!=0x0)config[_0x1b6b5c(0x2ca)](_0x287f55=>{const _0x2c9635=_0x1b6b5c;if(_0x287f55[_0x2c9635(0x323)]=='enabled'||_0x287f55[_0x2c9635(0x323)]==_0x2c9635(0x240))logging(_0x2c9635(0x2f7)+_0x287f55['botID']+'\x20|\x20'+_0x287f55[_0x2c9635(0x1fb)]),startBot([_0x287f55[_0x2c9635(0x1f0)],userID],{'cwd':bbpath},function(_0x491f2c){if(_0x491f2c)logging(_0x491f2c);});else(_0x287f55[_0x2c9635(0x323)]==_0x2c9635(0x2ab)||_0x287f55['status']=='new-disabled')&&logging(_0x2c9635(0x268)+_0x287f55[_0x2c9635(0x1f0)]+_0x2c9635(0x2c7)+_0x287f55[_0x2c9635(0x1fb)]);});else!newBot&&console['log']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x1b6b5c(0x1dc)]('-----------------------------------------------------------------------------------'),console[_0x1b6b5c(0x1dc)]('');}function startSocket(){const _0x2a77b5=_0x2a3cae;io['on'](_0x2a77b5(0x26b),_0x217978=>{const _0x27061b=_0x2a77b5;let _0x3432d4,_0x14b0e5,_0x5e7387,_0x53d6fc,_0x438e38;const _0x165870=_0x217978[_0x27061b(0x2be)][_0x27061b(0x20a)][_0x27061b(0x2d2)];_0x14b0e5=_0x165870[_0x27061b(0x263)](/bot[0-9]{3}/);if(_0x14b0e5)_0x5e7387=_0x14b0e5[0x0][_0x27061b(0x263)](/[0-9]{3}/);if(_0x5e7387)_0x3432d4=_0x5e7387[0x0];else _0x3432d4=_0x27061b(0x2db);const _0x3b8401=_0x217978['handshake']['auth'][_0x27061b(0x303)];if(!_0x3b8401)_0x217978[_0x27061b(0x2c3)](_0x27061b(0x323),{'publicKey':secure['publicKey']});else{_0x53d6fc=timelyDecrypt(_0x3b8401,![]);if(!_0x53d6fc)_0x217978[_0x27061b(0x2c3)](_0x27061b(0x323),{'publicKey':secure[_0x27061b(0x227)]});else{_0x438e38=normalizeIP(_0x217978[_0x27061b(0x2a3)][_0x27061b(0x2b8)])['store'];if(!devices[_0x53d6fc])devices[_0x53d6fc]={'uuid':_0x53d6fc,'access':{'token':null}};devices[_0x53d6fc]['ip']=_0x438e38;const _0x211296=addClient(_0x217978['id'],_0x53d6fc,_0x3432d4);setAccess(_0x211296),_0x217978['on'](_0x27061b(0x24e),_0x449980=>{const _0x3928d4=_0x27061b,_0x4e20cf=timelyDecrypt(_0x449980[_0x3928d4(0x2f6)]);if(_0x4e20cf){_0x449980={'username':_0x449980[_0x3928d4(0x2f1)],'password':_0x4e20cf},devices[_0x53d6fc][_0x3928d4(0x243)]=validateCredentials(_0x449980,_0x53d6fc);if(devices[_0x53d6fc][_0x3928d4(0x243)][_0x3928d4(0x212)]==![]&&devices[_0x53d6fc][_0x3928d4(0x243)][_0x3928d4(0x233)]==_0x3928d4(0x1eb))_0x217978['emit'](_0x3928d4(0x323),{'access':devices[_0x53d6fc]['access']}),loginAccess2FA(_0x53d6fc,_0x438e38);else{if(devices[_0x53d6fc][_0x3928d4(0x243)][_0x3928d4(0x212)]==![]&&devices[_0x53d6fc][_0x3928d4(0x243)][_0x3928d4(0x233)]=='invalid\x20credentials')_0x217978[_0x3928d4(0x2c3)](_0x3928d4(0x323),{'access':devices[_0x53d6fc][_0x3928d4(0x243)]});else devices[_0x53d6fc][_0x3928d4(0x243)][_0x3928d4(0x212)]&&devices[_0x53d6fc][_0x3928d4(0x243)][_0x3928d4(0x233)]==_0x3928d4(0x252)&&(getClientsWithUuid(_0x53d6fc)[_0x3928d4(0x2ca)](_0x1a5ccd=>{setAccess(_0x1a5ccd);}),setTokenRefresh(_0x53d6fc),setSessionTimeout(_0x3928d4(0x24e),_0x53d6fc));}}else logging(_0x3928d4(0x1ec));}),_0x217978['on'](_0x27061b(0x277),()=>{resetPassword();}),_0x217978['on'](_0x27061b(0x30a),_0x491fd4=>{removeClient(_0x217978['id']);});}}});}function initClient(_0x3dd374){const _0x15128a=_0x2a3cae;if(_0x3dd374!='botmanager'&&config['apiKey']!=''){if(pid[_0x3dd374])pid[_0x3dd374][_0x15128a(0x27c)]({'function':_0x15128a(0x2f3),'args':null});}}function getSocket(_0x13864c){const _0x3dd2ff=_0x2a3cae;return io[_0x3dd2ff(0x24b)][_0x3dd2ff(0x24b)][_0x3dd2ff(0x2f0)](_0x13864c);}function setAccess(_0x333f62){const _0x3072f5=_0x2a3cae,_0xf03d6=getSocket(_0x333f62['id']),_0x33084f=_0x333f62[_0x3072f5(0x2d5)],_0x4f15e6=_0x333f62[_0x3072f5(0x2eb)];devices[_0x33084f][_0x3072f5(0x243)]=validateAccess(devices[_0x33084f][_0x3072f5(0x243)][_0x3072f5(0x217)],_0x33084f),_0xf03d6[_0x3072f5(0x26d)](_0x33084f);if(devices[_0x33084f][_0x3072f5(0x243)][_0x3072f5(0x212)]){_0xf03d6[_0x3072f5(0x26d)](_0x4f15e6);if(_0x4f15e6==_0x3072f5(0x2db))initializeSocketBotManager(_0xf03d6);else initializeSocketBot(_0xf03d6);initClient(_0x4f15e6);}devices[_0x33084f][_0x3072f5(0x243)][_0x3072f5(0x217)]&&devices[_0x33084f][_0x3072f5(0x243)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3072f5(0x1e2),_0x33084f),devices[_0x33084f][_0x3072f5(0x243)][_0x3072f5(0x217)]&&devices[_0x33084f][_0x3072f5(0x243)][_0x3072f5(0x233)]==_0x3072f5(0x309)&&setSessionTimeout('login',_0x33084f),_0xf03d6['emit'](_0x3072f5(0x323),{'status':_0x333f62[_0x3072f5(0x261)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x33084f][_0x3072f5(0x243)],'externalip':devices[_0x33084f]['ip'],'publicKey':secure[_0x3072f5(0x227)],'validInstallation':validInstallation}),devices[_0x33084f][_0x3072f5(0x243)]['allow']==![]&&devices[_0x33084f][_0x3072f5(0x243)][_0x3072f5(0x233)]==_0x3072f5(0x2e0)&&temporaryAccess2FA(_0x33084f,devices[_0x33084f]['ip']);}function setSessionTimeout(_0x1a93e0,_0x8e276e){const _0x2e6a9f=_0x2a3cae;let _0x2e8b5a;if(_0x1a93e0=='login')_0x2e8b5a=loginExpiry*0x3c*0x3e8;else _0x2e8b5a=devices[_0x8e276e]['telegramIpApproval'][_0x2e6a9f(0x283)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x8e276e]['telegramIpApproval'][_0x2e6a9f(0x22e)]);if(devices[_0x8e276e][_0x2e6a9f(0x221)])clearTimeout(devices[_0x8e276e]['pidExpireLogin']);devices[_0x8e276e][_0x2e6a9f(0x221)]=setTimeout(()=>{const _0x30fc56=_0x2e6a9f;if(devices[_0x8e276e][_0x30fc56(0x2d4)])clearTimeout(devices[_0x8e276e]['pidRefreshToken']);removeSocketListeners(_0x8e276e),addBlacklist(_0x8e276e),devices[_0x8e276e][_0x30fc56(0x30d)]=null,devices[_0x8e276e][_0x30fc56(0x326)]=null,devices[_0x8e276e][_0x30fc56(0x243)][_0x30fc56(0x217)]=null,devices[_0x8e276e]['access']=validateAccess(devices[_0x8e276e][_0x30fc56(0x243)]['token'],_0x8e276e),!(devices[_0x8e276e]['access'][_0x30fc56(0x212)]&&devices[_0x8e276e][_0x30fc56(0x243)][_0x30fc56(0x233)]==_0x30fc56(0x284))&&(_0x1a93e0==_0x30fc56(0x24e)?io['to'](_0x8e276e)[_0x30fc56(0x2c3)](_0x30fc56(0x323),{'access':{'allow':![],'reason':_0x30fc56(0x2f4),'token':null}}):io['to'](_0x8e276e)[_0x30fc56(0x2c3)](_0x30fc56(0x323),{'access':{'allow':![],'reason':_0x30fc56(0x20d),'token':null}})),devices[_0x8e276e][_0x30fc56(0x243)][_0x30fc56(0x217)]=null;},_0x2e8b5a);}function setTokenRefresh(_0x4c67a9){const _0x518747=_0x2a3cae;if(devices[_0x4c67a9][_0x518747(0x2d4)])clearTimeout(devices[_0x4c67a9]['pidRefreshToken']);devices[_0x4c67a9][_0x518747(0x2d4)]=setTimeout(()=>{const _0x39e3bc=_0x518747;getClientsWithUuid(_0x4c67a9)['length']!=0x0?(devices[_0x4c67a9]['access']=refreshToken(_0x4c67a9),io['to'](_0x4c67a9)[_0x39e3bc(0x2c3)](_0x39e3bc(0x323),{'status':_0x39e3bc(0x2ee),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4c67a9][_0x39e3bc(0x243)],'externalip':devices[_0x4c67a9]['ip'],'publicKey':secure[_0x39e3bc(0x227)],'validInstallation':validInstallation}),setTokenRefresh(_0x4c67a9)):clearTimeout(devices[_0x4c67a9][_0x39e3bc(0x2d4)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3691a2){const _0x32b23a=_0x2a3cae,_0x5cc706=getClient(_0x3691a2['id'])[_0x32b23a(0x2d5)];_0x3691a2['emit'](_0x32b23a(0x2d7),config),_0x3691a2[_0x32b23a(0x2c3)](_0x32b23a(0x256),cleanSettings()),_0x3691a2['on'](_0x32b23a(0x29f),_0x5d6f89=>{const _0x4ddcb2=_0x32b23a;if(validateAccess(_0x5d6f89,_0x5cc706)['allow'])addBot();else logging(_0x4ddcb2(0x2cd));}),_0x3691a2['on'](_0x32b23a(0x297),(_0x539c1f,_0x25a751)=>{const _0x5bfae0=_0x32b23a;if(validateAccess(_0x25a751,_0x5cc706)[_0x5bfae0(0x212)])toggleBot(_0x539c1f[_0x5bfae0(0x1f0)],_0x539c1f[_0x5bfae0(0x323)],_0x539c1f[_0x5bfae0(0x2da)]);else logging(_0x5bfae0(0x308));}),_0x3691a2['on'](_0x32b23a(0x2ad),(_0x2eab56,_0x4da2cd)=>{const _0x454572=_0x32b23a;if(validateAccess(_0x4da2cd,_0x5cc706)[_0x454572(0x212)])deleteBot(_0x2eab56);else logging(_0x454572(0x2f8));}),_0x3691a2['on'](_0x32b23a(0x22a),(_0x355a62,_0x2e7492)=>{if(validateAccess(_0x2e7492,_0x5cc706)['allow'])storeSettings(_0x355a62,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3691a2['on'](_0x32b23a(0x294),(_0x1e96d8,_0x42e2df)=>{const _0x4d0498=_0x32b23a;if(validateAccess(_0x42e2df,_0x5cc706)[_0x4d0498(0x212)])updateBB();else logging(_0x4d0498(0x287));}),_0x3691a2['on'](_0x32b23a(0x1e4),_0x224f67=>{const _0x2f342f=_0x32b23a;if(validateAccess(_0x224f67,_0x5cc706)['allow']){if(devices[_0x5cc706][_0x2f342f(0x2d4)])clearTimeout(devices[_0x5cc706][_0x2f342f(0x2d4)]);if(devices[_0x5cc706][_0x2f342f(0x221)])clearTimeout(devices[_0x5cc706]['pidExpireLogin']);removeSocketListeners(getClient(_0x3691a2['id'])[_0x2f342f(0x2d5)]),addBlacklist(_0x5cc706),devices[_0x5cc706][_0x2f342f(0x30d)]=null,devices[_0x5cc706][_0x2f342f(0x326)]=null,devices[_0x5cc706][_0x2f342f(0x243)][_0x2f342f(0x217)]=null,io['to'](getClient(_0x3691a2['id'])[_0x2f342f(0x2d5)])['emit']('status',{'access':{'allow':![],'reason':_0x2f342f(0x32a),'token':null}});}else logging(_0x2f342f(0x248));});}function initializeSocketBot(_0x3b8ab6){const _0x7d6a32=_0x2a3cae,_0xe4c515=getClient(_0x3b8ab6['id'])['bot'],_0x429692=getClient(_0x3b8ab6['id'])[_0x7d6a32(0x2d5)];_0x3b8ab6['on'](_0x7d6a32(0x2ce),(_0x30b464,_0x4b3c0a)=>{const _0x312b5c=_0x7d6a32;if(validateAccess(_0x4b3c0a,_0x429692)['allow']){if(pid[_0xe4c515])pid[_0xe4c515]['send']({'function':_0x312b5c(0x224),'args':_0x30b464});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x3b8ab6['on'](_0x7d6a32(0x238),(_0x309d68,_0x49bf4f)=>{const _0x468ef6=_0x7d6a32;if(validateAccess(_0x49bf4f,_0x429692)['allow']){if(pid[_0xe4c515])pid[_0xe4c515]['send']({'function':_0x468ef6(0x1e3),'args':_0x309d68});}else logging(_0x468ef6(0x23d));}),_0x3b8ab6['on'](_0x7d6a32(0x1f2),(_0x548676,_0x4fe310)=>{const _0x138fee=_0x7d6a32;if(validateAccess(_0x4fe310,_0x429692)[_0x138fee(0x212)]){if(pid[_0xe4c515])pid[_0xe4c515][_0x138fee(0x27c)]({'function':_0x138fee(0x250),'args':_0x548676});}else logging(_0x138fee(0x25c));}),_0x3b8ab6['on'](_0x7d6a32(0x26a),(_0x5d5bdd,_0x6d9617)=>{const _0x2ac4b7=_0x7d6a32;if(validateAccess(_0x6d9617,_0x429692)[_0x2ac4b7(0x212)]){if(pid[_0xe4c515])pid[_0xe4c515][_0x2ac4b7(0x27c)]({'function':'storeHeadless','args':_0x5d5bdd});}else logging(_0x2ac4b7(0x2bb));}),_0x3b8ab6['on'](_0x7d6a32(0x21b),_0x409eff=>{const _0x1afe0a=_0x7d6a32;if(validateAccess(_0x409eff,_0x429692)[_0x1afe0a(0x212)]){if(pid[_0xe4c515])pid[_0xe4c515][_0x1afe0a(0x27c)]({'function':'getStartingBalances','args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x3b8ab6['on'](_0x7d6a32(0x332),(_0x4c3a96,_0x6c2d14)=>{const _0x342202=_0x7d6a32;if(validateAccess(_0x6c2d14,_0x429692)['allow']){if(pid[_0xe4c515])pid[_0xe4c515][_0x342202(0x27c)]({'function':_0x342202(0x270),'args':_0x4c3a96});}else logging(_0x342202(0x23e));}),_0x3b8ab6['on'](_0x7d6a32(0x2b4),_0x164cc1=>{const _0x1aa99d=_0x7d6a32;if(validateAccess(_0x164cc1,_0x429692)['allow']){if(pid[_0xe4c515])pid[_0xe4c515][_0x1aa99d(0x27c)]({'function':_0x1aa99d(0x2e1),'args':null});}else logging(_0x1aa99d(0x235));}),_0x3b8ab6['on']('logout',_0xd8a5a4=>{const _0xb13d1b=_0x7d6a32;if(validateAccess(_0xd8a5a4,_0x429692)['allow']){if(devices[_0x429692][_0xb13d1b(0x2d4)])clearTimeout(devices[_0x429692]['pidRefreshToken']);if(devices[_0x429692][_0xb13d1b(0x221)])clearTimeout(devices[_0x429692][_0xb13d1b(0x221)]);removeSocketListeners(getClient(_0x3b8ab6['id'])[_0xb13d1b(0x2d5)]),addBlacklist(_0x429692),devices[_0x429692][_0xb13d1b(0x30d)]=null,devices[_0x429692]['telegram2FaApproval']=null,devices[_0x429692][_0xb13d1b(0x243)][_0xb13d1b(0x217)]=null,io['to'](getClient(_0x3b8ab6['id'])[_0xb13d1b(0x2d5)])[_0xb13d1b(0x2c3)](_0xb13d1b(0x323),{'access':{'allow':![],'reason':_0xb13d1b(0x32a),'token':null}});}else logging(_0xb13d1b(0x248));});}function removeSocketListeners(_0x1d9f34){getClientsWithUuid(_0x1d9f34)['forEach'](_0x2277cc=>{const _0x58a4b2=_0x2654;getSocket(_0x2277cc['id'])[_0x58a4b2(0x321)]();});}function cleanSettings(){const _0x3bfdb4=_0x2a3cae;let _0x5de261=settings;return settings[_0x3bfdb4(0x210)]&&settings[_0x3bfdb4(0x210)]!=''&&(_0x5de261={..._0x5de261,'telegramToken':'************'}),settings[_0x3bfdb4(0x28f)]&&settings[_0x3bfdb4(0x28f)]!=''&&(_0x5de261={..._0x5de261,'bbPassword':_0x3bfdb4(0x25a)}),_0x5de261;}function updateBB(){const _0x3efc50=_0x2a3cae;installingUpdate=!![],config[_0x3efc50(0x2ca)](_0x476dcb=>{const _0x4824a2=_0x3efc50;restartBot(_0x476dcb[_0x4824a2(0x1f0)]);}),process[_0x3efc50(0x27c)]({'update':!![]},_0x136467=>{});}function startBot(_0x2d4036,_0x5b7341,_0x24a703){const _0x15aa56=_0x2a3cae;let _0x1bf2d1=![];const _0x26d85b=_0x2d4036[0x0];_0x5b7341={..._0x5b7341,'stdio':[_0x15aa56(0x2e2),'inherit','inherit',_0x15aa56(0x223)]},pid[_0x26d85b]=childProcess[_0x15aa56(0x225)](botfile,_0x2d4036,_0x5b7341),pid[_0x26d85b]['on'](_0x15aa56(0x206),_0x360dc0=>{const _0x2c8325=_0x15aa56;switch(Object[_0x2c8325(0x2b3)](_0x360dc0)[0x0]){case _0x2c8325(0x1fb):updateBotName(_0x26d85b,_0x360dc0[_0x2c8325(0x1fb)]);break;case'status':updateStatus(_0x26d85b,_0x360dc0['status']);break;case'live':updateLive(_0x26d85b,_0x360dc0[_0x2c8325(0x2da)]);break;case'started':updateLive(_0x26d85b,_0x360dc0[_0x2c8325(0x1f9)]),io['to'](_0x26d85b)[_0x2c8325(0x2c3)]('status',{'access':{'allow':![],'reason':_0x2c8325(0x200),'token':null}});break;case _0x2c8325(0x327):_0x360dc0['stop']==_0x2c8325(0x273)&&restartBot(_0x26d85b);_0x360dc0[_0x2c8325(0x327)]==_0x2c8325(0x1df)&&toggleBot(_0x26d85b,_0x2c8325(0x2ab),'stopped');break;case _0x2c8325(0x30e):sendTelegram(_0x26d85b,_0x360dc0[_0x2c8325(0x30e)]);break;case'function':io['to'](_0x26d85b)[_0x2c8325(0x2c3)](_0x360dc0[_0x2c8325(0x314)],_0x360dc0[_0x2c8325(0x2b1)]);break;}}),pid[_0x26d85b]['on']('error',function(_0x4c9158){if(_0x1bf2d1)return;_0x1bf2d1=!![],_0x24a703(_0x4c9158);}),pid[_0x26d85b]['on']('exit',function(_0x8e7dfa){const _0x29155d=_0x15aa56;if(installingUpdate)return;if(_0x1bf2d1)return;_0x1bf2d1=!![],_0x24a703(null);const _0x3de77f=dbConfig[_0x29155d(0x2f0)](_0x29155d(0x2d7))[_0x29155d(0x289)]({'botID':_0x26d85b})[_0x29155d(0x237)]();_0x3de77f&&(_0x3de77f[_0x29155d(0x323)]==_0x29155d(0x286)||_0x3de77f[_0x29155d(0x323)]==_0x29155d(0x240))&&(updateLive(_0x26d85b,_0x29155d(0x2aa)),logging('restarting\x20Bot\x20'+_0x26d85b),startBot([_0x26d85b,userID],{'cwd':bbpath},function(_0x57c805){if(_0x57c805)logging(_0x57c805);}));});}function stopBot(_0xe6e6ec){const _0x21aae5=_0x2a3cae;getClientsWithBotID(_0xe6e6ec)[_0x21aae5(0x2ca)](_0x408f53=>{const _0x2da292=_0x21aae5;getSocket(_0x408f53['id'])[_0x2da292(0x30a)](!![]),removeClient(_0x408f53['id']);});if(pid[_0xe6e6ec])pid[_0xe6e6ec][_0x21aae5(0x1df)]();}function restartBot(_0x247dda){const _0x21d1c0=_0x2a3cae;if(pid[_0x247dda])pid[_0x247dda][_0x21d1c0(0x1df)]();}function addBot(){const _0xcc93ee=_0x2a3cae;let _0x5e17c6;for(let _0x2b79cc=0x1;_0x2b79cc<0x3e9;_0x2b79cc++){_0x5e17c6=_0x2b79cc[_0xcc93ee(0x2d1)]()[_0xcc93ee(0x274)](0x3,'0');let _0x4bb47d=config['find'](_0x3d2e7d=>_0x3d2e7d[_0xcc93ee(0x1f0)]==_0x5e17c6);if(!_0x4bb47d)break;}if(_0x5e17c6===_0xcc93ee(0x279)){logging(_0xcc93ee(0x291));return;}logging(_0xcc93ee(0x2c6)+_0x5e17c6),dbConfig['get'](_0xcc93ee(0x2d7))['push']({'botID':_0x5e17c6,'botname':_0xcc93ee(0x211)+_0x5e17c6,'status':_0xcc93ee(0x240),'live':''})[_0xcc93ee(0x246)](),startBot([_0x5e17c6,userID],{'cwd':bbpath},function(_0x5961cc){if(_0x5961cc)logging(_0x5961cc);}),config=getConfiguration(),io['to']('botmanager')[_0xcc93ee(0x2c3)](_0xcc93ee(0x2d7),config);}function deleteBot(_0x33ba70){const _0x279f65=_0x2a3cae;getClientsWithBotID(_0x33ba70)['forEach'](_0x54fcf5=>{const _0x184296=_0x2654;getSocket(_0x54fcf5['id'])[_0x184296(0x30a)](!![]),removeClient(_0x54fcf5['id']);}),dbConfig['get']('bots')[_0x279f65(0x21c)]({'botID':_0x33ba70})[_0x279f65(0x246)](),logging(_0x279f65(0x310)+_0x33ba70),stopBot(_0x33ba70);try{fs[_0x279f65(0x239)](path[_0x279f65(0x26d)](configpath,'bot-'+_0x33ba70+_0x279f65(0x24f))),fs['unlinkSync'](path[_0x279f65(0x26d)](configpath,_0x279f65(0x2af)+_0x33ba70+_0x279f65(0x315))),fs[_0x279f65(0x239)](path[_0x279f65(0x26d)](configpath,_0x279f65(0x2af)+_0x33ba70+_0x279f65(0x202))),fs['unlinkSync'](path['join'](configpath,_0x279f65(0x2af)+_0x33ba70+_0x279f65(0x1e1)));}catch(_0x3cf5be){if(_0x3cf5be)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x3cf5be);}config=getConfiguration(),io['to'](_0x279f65(0x2db))[_0x279f65(0x2c3)]('bots',config);}function toggleBot(_0x3fe4ec,_0x11bb67,_0x1bd08f){const _0x450302=_0x2a3cae;dbConfig[_0x450302(0x2f0)](_0x450302(0x2d7))['find']({'botID':_0x3fe4ec})['assign']({'status':_0x11bb67})[_0x450302(0x23f)]({'live':_0x1bd08f})[_0x450302(0x246)]();if(_0x11bb67==_0x450302(0x286)||_0x11bb67==_0x450302(0x240))logging(_0x450302(0x226)+_0x3fe4ec),startBot([_0x3fe4ec,userID],{'cwd':bbpath},function(_0x1cfa2e){if(_0x1cfa2e)logging(_0x1cfa2e);});else(_0x11bb67==_0x450302(0x2ab)||_0x11bb67==_0x450302(0x209))&&(logging(_0x450302(0x1fe)+_0x3fe4ec),stopBot(_0x3fe4ec));config=getConfiguration(),io['to'](_0x450302(0x2db))[_0x450302(0x2c3)]('bots',config);}function toggleStatus(_0x54bbbc){const _0x44bc65=_0x2a3cae;let _0x4dada8=dbConfig[_0x44bc65(0x2f0)](_0x44bc65(0x2d7))[_0x44bc65(0x289)]({'botID':_0x54bbbc})[_0x44bc65(0x237)](),_0x33be24;if(_0x4dada8[_0x44bc65(0x323)]==='enabled')_0x33be24=_0x44bc65(0x2ab);else{if(_0x4dada8[_0x44bc65(0x323)]===_0x44bc65(0x240))_0x33be24='new-disabled';else{if(_0x4dada8[_0x44bc65(0x323)]===_0x44bc65(0x209))_0x33be24='new';else{if(_0x4dada8[_0x44bc65(0x323)]==='disabled')_0x33be24=_0x44bc65(0x286);}}}return _0x33be24;}function updateStatus(_0x3ec862,_0x123385){const _0x5847a1=_0x2a3cae;dbConfig[_0x5847a1(0x2f0)](_0x5847a1(0x2d7))[_0x5847a1(0x289)]({'botID':_0x3ec862})['assign']({'status':_0x123385})[_0x5847a1(0x246)](),config=getConfiguration(),io['to'](_0x5847a1(0x2db))[_0x5847a1(0x2c3)](_0x5847a1(0x2d7),config);}function updateLive(_0x145d4d,_0x1d12db){const _0x5257db=_0x2a3cae;dbConfig[_0x5257db(0x2f0)](_0x5257db(0x2d7))[_0x5257db(0x289)]({'botID':_0x145d4d})[_0x5257db(0x23f)]({'live':_0x1d12db})[_0x5257db(0x246)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config);}function updateBotName(_0x32501e,_0x6c3728){const _0x4b18df=_0x2a3cae;dbConfig[_0x4b18df(0x2f0)]('bots')[_0x4b18df(0x289)]({'botID':_0x32501e})[_0x4b18df(0x23f)]({'botname':_0x6c3728})[_0x4b18df(0x246)](),config=getConfiguration(),io['to'](_0x4b18df(0x2db))[_0x4b18df(0x2c3)]('bots',config);}function _0x2654(_0x42b918,_0xc20436){const _0x5a0131=_0x1857();return _0x2654=function(_0x59e805,_0x2aaafd){_0x59e805=_0x59e805-0x1da;let _0x1857e6=_0x5a0131[_0x59e805];return _0x1857e6;},_0x2654(_0x42b918,_0xc20436);}function telegramError(_0x287fe4){const _0x2dc4e6=_0x2a3cae;console[_0x2dc4e6(0x1dc)](getTimeStamp()+_0x2dc4e6(0x1f1));}function validateTelegram(_0x3a2f63){const _0x657409=_0x2a3cae;if(_0x3a2f63[_0x657409(0x244)][_0x657409(0x2f1)]!=settings[_0x657409(0x2e6)]&&'@'+_0x3a2f63[_0x657409(0x244)][_0x657409(0x2f1)]!=settings[_0x657409(0x2e6)])return tgBot[_0x657409(0x330)](_0x3a2f63[_0x657409(0x2ae)]['id'],_0x657409(0x2b9),{'parse_mode':_0x657409(0x2a9)})[_0x657409(0x2ef)](_0x3674b6=>{telegramError(_0x3674b6);}),![];return!![];}async function initTelegram(){const _0x1ab606=_0x2a3cae;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1ab606(0x210)],{'polling':!![]});let _0x10f6f7='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x10f6f7+='\x0a',_0x10f6f7+='/enable\x20-\x20enable\x20notifications\x0a',_0x10f6f7+=_0x1ab606(0x1ee),_0x10f6f7+=_0x1ab606(0x318),_0x10f6f7+=_0x1ab606(0x253),_0x10f6f7+='/on\x20-\x20start\x20bot(s)\x0a',_0x10f6f7+=_0x1ab606(0x2dd),_0x10f6f7+=_0x1ab606(0x2e8),_0x10f6f7+=_0x1ab606(0x31f);let _0x25d97b='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x25d97b+='\x0a',_0x25d97b+=_0x10f6f7,tgBot[_0x1ab606(0x218)](/\/start/,_0x2f0b60=>{const _0x12c36d=_0x1ab606;if(!validateTelegram(_0x2f0b60))return;if(settings['telegramChatId']!=_0x2f0b60[_0x12c36d(0x2ae)]['id'])updateSetting('telegramChatId',_0x2f0b60[_0x12c36d(0x2ae)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x12c36d(0x330)](_0x2f0b60[_0x12c36d(0x2ae)]['id'],_0x25d97b)[_0x12c36d(0x2ef)](_0x4cea0a=>{telegramError(_0x4cea0a);});}),tgBot[_0x1ab606(0x218)](/\/enable/,_0x85d1a8=>{const _0x4e684c=_0x1ab606;if(!validateTelegram(_0x85d1a8))return;if(settings['telegramChatId']!=_0x85d1a8[_0x4e684c(0x2ae)]['id'])updateSetting(_0x4e684c(0x213),_0x85d1a8['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x4e684c(0x330)](_0x85d1a8['chat']['id'],_0x4e684c(0x2c5))[_0x4e684c(0x2ef)](_0x41448a=>{telegramError(_0x41448a);});}),tgBot[_0x1ab606(0x218)](/\/config/,async _0x1b9407=>{const _0x1a96df=_0x1ab606;if(!validateTelegram(_0x1b9407))return;tgBot[_0x1a96df(0x304)](_0x1a96df(0x222)),tgBot[_0x1a96df(0x330)](_0x1b9407[_0x1a96df(0x2ae)]['id'],_0x1a96df(0x216),{'reply_markup':{'inline_keyboard':[[{'text':_0x1a96df(0x242),'callback_data':_0x1a96df(0x280)},{'text':_0x1a96df(0x299),'callback_data':_0x1a96df(0x307)},{'text':'All','callback_data':_0x1a96df(0x331)}]]}})[_0x1a96df(0x2ef)](_0x335062=>{telegramError(_0x335062);}),tgBot['on'](_0x1a96df(0x222),async _0x27c0dc=>{const _0x103b7d=_0x1a96df,_0x375746=_0x27c0dc[_0x103b7d(0x25b)],_0x3a5b14=_0x27c0dc[_0x103b7d(0x206)];tgBot[_0x103b7d(0x282)](_0x27c0dc['id'])[_0x103b7d(0x2bd)](async()=>{const _0x3934f1=_0x103b7d;_0x375746==_0x3934f1(0x280)&&(updateSetting('telegramEvents',_0x3934f1(0x280)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x3a5b14[_0x3934f1(0x2ae)]['id'],_0x3934f1(0x262))[_0x3934f1(0x2ef)](_0x538a93=>{telegramError(_0x538a93);}));_0x375746==_0x3934f1(0x307)&&(updateSetting('telegramEvents',_0x3934f1(0x307)),updateSetting(_0x3934f1(0x28a),!![]),await tgBot[_0x3934f1(0x330)](_0x3a5b14[_0x3934f1(0x2ae)]['id'],_0x3934f1(0x228))[_0x3934f1(0x2ef)](_0x350ca2=>{telegramError(_0x350ca2);}));_0x375746=='all'&&(updateSetting(_0x3934f1(0x2bf),_0x3934f1(0x331)),updateSetting(_0x3934f1(0x28a),!![]),await tgBot[_0x3934f1(0x330)](_0x3a5b14[_0x3934f1(0x2ae)]['id'],_0x3934f1(0x2c1))[_0x3934f1(0x2ef)](_0x38ecc4=>{telegramError(_0x38ecc4);}));if(!settings[_0x3934f1(0x213)])tgBot[_0x3934f1(0x330)](_0x3a5b14['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x3934f1(0x2ef)](_0x4e7640=>{telegramError(_0x4e7640);});}),tgBot['removeListener'](_0x103b7d(0x222));});}),tgBot[_0x1ab606(0x218)](/\/status/,_0x114335=>{const _0x424f4f=_0x1ab606;if(!validateTelegram(_0x114335))return;let _0x4722cf=_0x424f4f(0x27f);config['forEach'](_0x28184d=>{const _0x483885=_0x424f4f;_0x4722cf+=_0x483885(0x211)+_0x28184d[_0x483885(0x1f0)]+'\x20|\x20'+_0x28184d[_0x483885(0x1fb)]+':\x20'+_0x28184d['status']+_0x483885(0x2a5)+_0x28184d[_0x483885(0x2da)]+'\x0a';}),_0x4722cf+='\x0a',_0x4722cf+=_0x424f4f(0x249),_0x4722cf+=!settings[_0x424f4f(0x28a)]?_0x424f4f(0x1fc):_0x424f4f(0x2b6),_0x4722cf+=settings['telegramEnabled']?settings[_0x424f4f(0x2bf)]==_0x424f4f(0x331)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x424f4f(0x214)+settings[_0x424f4f(0x2bf)]+_0x424f4f(0x295):'',tgBot['sendMessage'](_0x114335[_0x424f4f(0x2ae)]['id'],_0x4722cf,{'parse_mode':_0x424f4f(0x2a9)})['catch'](_0x43fa06=>{telegramError(_0x43fa06);});}),tgBot['onText'](/\/restart/,_0x52c814=>{const _0x3e7385=_0x1ab606;if(!validateTelegram(_0x52c814))return;tgBot[_0x3e7385(0x304)](_0x3e7385(0x222));const _0x458699=getEnabledBots();if(_0x458699['length']==0x0)tgBot[_0x3e7385(0x330)](_0x52c814[_0x3e7385(0x2ae)]['id'],_0x3e7385(0x26e))[_0x3e7385(0x2ef)](_0x2fdbf4=>{telegramError(_0x2fdbf4);});else{if(_0x458699[_0x3e7385(0x254)]>0x1)_0x458699[_0x3e7385(0x236)]({'botID':_0x3e7385(0x331)});let _0x7e51ce=[],_0x531a3d=[];const _0x2cc2ad=_0x458699[_0x3e7385(0x254)]%0x4==0x0||_0x458699[_0x3e7385(0x254)]%0x4==0x3||_0x458699[_0x3e7385(0x254)]%0x3==0x1?0x4:0x3;let _0x111add=0x0;_0x458699[_0x3e7385(0x2ca)]((_0x1b1995,_0x566631)=>{const _0x110333=_0x3e7385;if(_0x566631%_0x2cc2ad==0x0)_0x531a3d=[];_0x531a3d['push']({'text':_0x1b1995[_0x110333(0x1f0)]==_0x110333(0x331)?'All\x20bots':_0x110333(0x211)+_0x1b1995[_0x110333(0x1f0)],'callback_data':_0x1b1995[_0x110333(0x1f0)]}),_0x566631%_0x2cc2ad==0x0&&(_0x7e51ce[_0x111add]=_0x531a3d,_0x111add++);}),tgBot['sendMessage'](_0x52c814[_0x3e7385(0x2ae)]['id'],_0x3e7385(0x21f),{'reply_markup':{'inline_keyboard':_0x7e51ce}})[_0x3e7385(0x2ef)](_0x2d0714=>{telegramError(_0x2d0714);}),tgBot['on']('callback_query',async _0xd32495=>{const _0x2f2b55=_0x3e7385,_0x320469=_0xd32495['data'],_0x30781d=_0xd32495[_0x2f2b55(0x206)];tgBot[_0x2f2b55(0x282)](_0xd32495['id'])[_0x2f2b55(0x2bd)](async()=>{const _0x11028c=_0x2f2b55;if(_0x320469==_0x11028c(0x331)){if(settings[_0x11028c(0x2bf)]==_0x11028c(0x280))tgBot['sendMessage'](_0x30781d[_0x11028c(0x2ae)]['id'],_0x11028c(0x2d9))[_0x11028c(0x2ef)](_0x5b1698=>{telegramError(_0x5b1698);});config['forEach'](_0xa717df=>{restartBot(_0xa717df['botID']);});}else{if(settings[_0x11028c(0x2bf)]=='orders')tgBot[_0x11028c(0x330)](_0x30781d[_0x11028c(0x2ae)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x320469)[_0x11028c(0x2ef)](_0x2ed02f=>{telegramError(_0x2ed02f);});restartBot(_0x320469);}}),tgBot['removeListener'](_0x2f2b55(0x222));});}}),tgBot[_0x1ab606(0x218)](/\/on/,_0x5aa6d4=>{const _0x4ab2e0=_0x1ab606;if(!validateTelegram(_0x5aa6d4))return;tgBot[_0x4ab2e0(0x304)](_0x4ab2e0(0x222));const _0x320d9c=getDisabledBots();if(_0x320d9c[_0x4ab2e0(0x254)]==0x0)tgBot[_0x4ab2e0(0x330)](_0x5aa6d4['chat']['id'],_0x4ab2e0(0x29c))['catch'](_0x10da42=>{telegramError(_0x10da42);});else{if(_0x320d9c[_0x4ab2e0(0x254)]>0x1)_0x320d9c[_0x4ab2e0(0x236)]({'botID':_0x4ab2e0(0x331)});let _0x5bf762=[],_0x272eb4=[];const _0x1a5b79=_0x320d9c[_0x4ab2e0(0x254)]%0x4==0x0||_0x320d9c[_0x4ab2e0(0x254)]%0x4==0x3||_0x320d9c[_0x4ab2e0(0x254)]%0x3==0x1?0x4:0x3;let _0x5ad6fc=0x0;_0x320d9c['forEach']((_0x49095d,_0x46ca39)=>{const _0x16b927=_0x4ab2e0;if(_0x46ca39%_0x1a5b79==0x0)_0x272eb4=[];_0x272eb4['push']({'text':_0x49095d[_0x16b927(0x1f0)]==_0x16b927(0x331)?_0x16b927(0x28c):_0x16b927(0x211)+_0x49095d['botID'],'callback_data':_0x49095d[_0x16b927(0x1f0)]}),_0x46ca39%_0x1a5b79==0x0&&(_0x5bf762[_0x5ad6fc]=_0x272eb4,_0x5ad6fc++);}),tgBot['sendMessage'](_0x5aa6d4[_0x4ab2e0(0x2ae)]['id'],_0x4ab2e0(0x21d),{'reply_markup':{'inline_keyboard':_0x5bf762}})[_0x4ab2e0(0x2ef)](_0x291798=>{telegramError(_0x291798);}),tgBot['on'](_0x4ab2e0(0x222),async _0x4c57a0=>{const _0x355be8=_0x4ab2e0,_0x5d5757=_0x4c57a0[_0x355be8(0x25b)],_0x44d970=_0x4c57a0['message'];tgBot[_0x355be8(0x282)](_0x4c57a0['id'])['then'](async()=>{const _0x108425=_0x355be8;if(_0x5d5757==_0x108425(0x331)){if(settings[_0x108425(0x2bf)]==_0x108425(0x280))tgBot[_0x108425(0x330)](_0x44d970[_0x108425(0x2ae)]['id'],_0x108425(0x229))[_0x108425(0x2ef)](_0x65694a=>{telegramError(_0x65694a);});_0x320d9c[_0x108425(0x2ca)](_0x4e5cec=>{const _0x4d0395=_0x108425;if(_0x4e5cec['botID']!=_0x4d0395(0x331))toggleBot(_0x4e5cec[_0x4d0395(0x1f0)],toggleStatus(_0x4e5cec['botID']),_0x4d0395(0x2aa));});}else{if(settings[_0x108425(0x2bf)]==_0x108425(0x280))tgBot['sendMessage'](_0x44d970['chat']['id'],_0x108425(0x271)+_0x5d5757)[_0x108425(0x2ef)](_0x4fcd5a=>{telegramError(_0x4fcd5a);});toggleBot(_0x5d5757,toggleStatus(_0x5d5757),_0x108425(0x2aa));}}),tgBot['removeListener'](_0x355be8(0x222));});}}),tgBot[_0x1ab606(0x218)](/\/off/,_0x12c7aa=>{const _0x4a50c6=_0x1ab606;if(!validateTelegram(_0x12c7aa))return;tgBot[_0x4a50c6(0x304)](_0x4a50c6(0x222));const _0x508659=getEnabledBots();if(_0x508659['length']==0x0)tgBot[_0x4a50c6(0x330)](_0x12c7aa['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x56763a=>{telegramError(_0x56763a);});else{if(_0x508659[_0x4a50c6(0x254)]>0x1)_0x508659[_0x4a50c6(0x236)]({'botID':_0x4a50c6(0x331)});let _0x28c73e=[],_0x5b513f=[];const _0x2d08c1=_0x508659[_0x4a50c6(0x254)]%0x4==0x0||_0x508659[_0x4a50c6(0x254)]%0x4==0x3||_0x508659[_0x4a50c6(0x254)]%0x3==0x1?0x4:0x3;let _0x3492a6=0x0;_0x508659[_0x4a50c6(0x2ca)]((_0x5033bc,_0x497b95)=>{const _0x45a3f8=_0x4a50c6;if(_0x497b95%_0x2d08c1==0x0)_0x5b513f=[];_0x5b513f['push']({'text':_0x5033bc[_0x45a3f8(0x1f0)]==_0x45a3f8(0x331)?_0x45a3f8(0x28c):_0x45a3f8(0x211)+_0x5033bc[_0x45a3f8(0x1f0)],'callback_data':_0x5033bc[_0x45a3f8(0x1f0)]}),_0x497b95%_0x2d08c1==0x0&&(_0x28c73e[_0x3492a6]=_0x5b513f,_0x3492a6++);}),tgBot[_0x4a50c6(0x330)](_0x12c7aa[_0x4a50c6(0x2ae)]['id'],_0x4a50c6(0x255),{'reply_markup':{'inline_keyboard':_0x28c73e}})[_0x4a50c6(0x2ef)](_0x565039=>{telegramError(_0x565039);}),tgBot['on']('callback_query',async _0x1978cb=>{const _0x2eb62b=_0x4a50c6,_0x5c026=_0x1978cb['data'],_0x4e2fd8=_0x1978cb[_0x2eb62b(0x206)];tgBot[_0x2eb62b(0x282)](_0x1978cb['id'])[_0x2eb62b(0x2bd)](async()=>{const _0x44da44=_0x2eb62b;if(_0x5c026=='all'){if(settings[_0x44da44(0x2bf)]==_0x44da44(0x280))tgBot['sendMessage'](_0x4e2fd8[_0x44da44(0x2ae)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0xf39863=>{telegramError(_0xf39863);});_0x508659[_0x44da44(0x2ca)](_0x3aa11d=>{const _0x3d2b4d=_0x44da44;if(_0x3aa11d[_0x3d2b4d(0x1f0)]!='all')toggleBot(_0x3aa11d[_0x3d2b4d(0x1f0)],toggleStatus(_0x3aa11d['botID']),_0x3d2b4d(0x2aa));});}else{if(settings[_0x44da44(0x2bf)]=='orders')tgBot[_0x44da44(0x330)](_0x4e2fd8[_0x44da44(0x2ae)]['id'],_0x44da44(0x27a)+_0x5c026)['catch'](_0x3748f8=>{telegramError(_0x3748f8);});toggleBot(_0x5c026,toggleStatus(_0x5c026),_0x44da44(0x2aa));}}),tgBot[_0x2eb62b(0x304)](_0x2eb62b(0x222));});}}),tgBot[_0x1ab606(0x218)](/\/disable/,_0x69c8af=>{const _0xe064d5=_0x1ab606;if(!validateTelegram(_0x69c8af))return;tgBot[_0xe064d5(0x330)](_0x69c8af[_0xe064d5(0x2ae)]['id'],_0xe064d5(0x28e))['catch'](_0x3ff4be=>{telegramError(_0x3ff4be);}),updateSetting(_0xe064d5(0x28a),![]);}),tgBot[_0x1ab606(0x218)](/\/help/,_0x5141ce=>{const _0x153d07=_0x1ab606;if(!validateTelegram(_0x5141ce))return;tgBot[_0x153d07(0x330)](_0x5141ce[_0x153d07(0x2ae)]['id'],_0x10f6f7)[_0x153d07(0x2ef)](_0x1fb96e=>{telegramError(_0x1fb96e);});}),tgBot['on'](_0x1ab606(0x232),_0x5cb9ee=>{const _0x32672b=_0x1ab606;_0x5cb9ee[_0x32672b(0x2d1)]()['includes'](_0x32672b(0x22f))&&(logging(_0x32672b(0x30c)),tgBot[_0x32672b(0x2a0)](),tgBot=null,io['to'](_0x32672b(0x2db))['emit'](_0x32672b(0x2b0),_0x32672b(0x30c)));}),process[_0x1ab606(0x278)](_0x1ab606(0x1e8),()=>{const _0xf7782e=_0x1ab606;if(tgBot)tgBot[_0xf7782e(0x2a0)]();process[_0xf7782e(0x1f8)](0x1);}),process['once'](_0x1ab606(0x301),()=>{const _0x41eaa4=_0x1ab606;if(tgBot)tgBot[_0x41eaa4(0x2a0)]();process['exit'](0x1);});}}function disableTelegram(){const _0x260233=_0x2a3cae;tgBot&&(tgBot[_0x260233(0x2a0)](),tgBot=null);}function sendTelegram(_0x4bd325,_0x478299){const _0x5e45c3=_0x2a3cae;if(settings['telegramEnabled']){if(settings[_0x5e45c3(0x2bf)]=='all'||(_0x478299[_0x5e45c3(0x322)]==_0x5e45c3(0x1f7)||_0x478299['type']==_0x5e45c3(0x24a))&&settings[_0x5e45c3(0x2bf)]=='alerts'||_0x478299[_0x5e45c3(0x322)]=='order'&&settings[_0x5e45c3(0x2bf)]==_0x5e45c3(0x280)){if(tgBot&&settings[_0x5e45c3(0x213)]){if(_0x478299['showname'])tgBot[_0x5e45c3(0x330)](settings['telegramChatId'],_0x478299['botname']+_0x5e45c3(0x292)+_0x478299[_0x5e45c3(0x207)])[_0x5e45c3(0x2ef)](_0x12411e=>{telegramError(_0x12411e);});else tgBot[_0x5e45c3(0x330)](settings[_0x5e45c3(0x213)],_0x5e45c3(0x211)+_0x4bd325+_0x5e45c3(0x292)+_0x478299[_0x5e45c3(0x207)])[_0x5e45c3(0x2ef)](_0x1f8ff5=>{telegramError(_0x1f8ff5);});}}}}function getDeviceWithIp(_0x42866a){const _0xaef2d0=_0x2a3cae;return devices[_0xaef2d0(0x289)](_0x44af45=>_0x44af45['ip']===_0x42866a);}function temporaryAccess2FA(_0xf23efb,_0x4b6af5){const _0x5f5a25=_0x2a3cae;let _0x15f31b=new Date(),_0x35458e=![];if(lastIpApproval){if(_0x15f31b-lastIpApproval<0x1388)_0x35458e=!![];}lastIpApproval=new Date();if(_0x35458e)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x5f5a25(0x304)](_0x5f5a25(0x222)),tgBot['sendMessage'](settings[_0x5f5a25(0x213)],_0x5f5a25(0x30f)+normalizeIP(_0x4b6af5)[_0x5f5a25(0x2b5)]+'</b>\x20?',{'parse_mode':_0x5f5a25(0x2a9),'reply_markup':{'inline_keyboard':[[{'text':_0x5f5a25(0x2f9),'callback_data':'5'},{'text':_0x5f5a25(0x31e),'callback_data':'15'},{'text':_0x5f5a25(0x2a8),'callback_data':'30'},{'text':'reject','callback_data':'reject'}]]}})[_0x5f5a25(0x2ef)](_0x48b2b6=>{telegramError(_0x48b2b6);}),tgBot['on']('callback_query',async _0x2481ac=>{const _0x304ba0=_0x5f5a25,_0x3d7853=_0x2481ac[_0x304ba0(0x25b)],_0x2f2c57=_0x2481ac['message'];tgBot['answerCallbackQuery'](_0x2481ac['id'])[_0x304ba0(0x2bd)](async()=>{const _0x5ee8ba=_0x304ba0;devices[_0xf23efb][_0x5ee8ba(0x30d)]={'clientip':_0x4b6af5,'timestamp':new Date()[_0x5ee8ba(0x260)](),'expiry':_0x3d7853},_0x3d7853!=_0x5ee8ba(0x2c0)?(await tgBot['sendMessage'](_0x2f2c57[_0x5ee8ba(0x2ae)]['id'],_0x5ee8ba(0x23b)+_0x3d7853+_0x5ee8ba(0x265),{'parse_mode':_0x5ee8ba(0x2a9)})[_0x5ee8ba(0x2ef)](_0x51e70d=>{telegramError(_0x51e70d);}),io['to'](_0xf23efb)[_0x5ee8ba(0x2c3)](_0x5ee8ba(0x323),{'access':{'allow':![],'reason':_0x5ee8ba(0x200),'token':null}})):(await tgBot[_0x5ee8ba(0x330)](_0x2f2c57[_0x5ee8ba(0x2ae)]['id'],_0x5ee8ba(0x302))[_0x5ee8ba(0x2ef)](_0x3a72a9=>{telegramError(_0x3a72a9);}),io['to'](_0xf23efb)[_0x5ee8ba(0x2c3)](_0x5ee8ba(0x323),{'access':{'allow':![],'reason':_0x5ee8ba(0x2b7),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x257418,_0x3a5a75){const _0x131cdb=_0x2a3cae;tgBot&&settings[_0x131cdb(0x213)]&&(tgBot[_0x131cdb(0x304)](_0x131cdb(0x222)),tgBot[_0x131cdb(0x330)](settings[_0x131cdb(0x213)],_0x131cdb(0x2ea)+normalizeIP(_0x3a5a75)[_0x131cdb(0x2b5)]+'</b>\x20?',{'parse_mode':_0x131cdb(0x2a9),'reply_markup':{'inline_keyboard':[[{'text':_0x131cdb(0x2a6),'callback_data':loginExpiry},{'text':_0x131cdb(0x2c0),'callback_data':'reject'}]]}})[_0x131cdb(0x2ef)](_0x28bde8=>{telegramError(_0x28bde8);}),tgBot['on']('callback_query',async _0x37f1d3=>{const _0x158784=_0x131cdb,_0x5984d0=_0x37f1d3[_0x158784(0x25b)],_0x496db7=_0x37f1d3[_0x158784(0x206)];tgBot[_0x158784(0x282)](_0x37f1d3['id'])['then'](async()=>{const _0x2119ec=_0x158784;devices[_0x257418][_0x2119ec(0x326)]={'clientip':_0x3a5a75,'timestamp':new Date()[_0x2119ec(0x260)](),'expiry':_0x5984d0},_0x5984d0!=_0x2119ec(0x2c0)?(await tgBot[_0x2119ec(0x330)](_0x496db7['chat']['id'],_0x2119ec(0x23c),{'parse_mode':_0x2119ec(0x2a9)})['catch'](_0x190530=>{telegramError(_0x190530);}),io['to'](_0x257418)[_0x2119ec(0x2c3)]('status',{'access':{'allow':![],'reason':_0x2119ec(0x200),'token':null}})):(await tgBot[_0x2119ec(0x330)](_0x496db7[_0x2119ec(0x2ae)]['id'],_0x2119ec(0x27d))[_0x2119ec(0x2ef)](_0x722954=>{telegramError(_0x722954);}),io['to'](_0x257418)[_0x2119ec(0x2c3)]('status',{'access':{'allow':![],'reason':_0x2119ec(0x219),'token':null}}));}),tgBot[_0x158784(0x304)](_0x158784(0x222));}));}function getConfiguration(){const _0x44f14c=_0x2a3cae;return dbConfig[_0x44f14c(0x2f0)](_0x44f14c(0x2d7))[_0x44f14c(0x2dc)](_0x44f14c(0x1f0))['value']()||[];}function getEnabledBots(){const _0x2b7cde=_0x2a3cae;return dbConfig[_0x2b7cde(0x2f0)]('bots')[_0x2b7cde(0x2dc)]('botID')[_0x2b7cde(0x25d)]({'status':_0x2b7cde(0x286)})[_0x2b7cde(0x237)]()||[];}function getDisabledBots(){const _0x290af4=_0x2a3cae;return dbConfig[_0x290af4(0x2f0)]('bots')[_0x290af4(0x2dc)](_0x290af4(0x1f0))[_0x290af4(0x25d)]({'status':_0x290af4(0x2ab)})['value']()||[];}function getSettings(){const _0x535544=_0x2a3cae;return dbSettings[_0x535544(0x2f0)](_0x535544(0x256))[_0x535544(0x237)]()||{'timeshift':0x0};}function getSecure(){const _0x4f2ead=_0x2a3cae;return dbSecure[_0x4f2ead(0x2f0)](_0x4f2ead(0x2c8))[_0x4f2ead(0x237)]()||{};}function getBlacklist(){const _0x55bec9=_0x2a3cae;return dbSecure[_0x55bec9(0x2f0)]('blacklist')[_0x55bec9(0x237)]()||[];}function broadcastToBots(_0x3749cb,_0x370548){const _0xd6a71f=_0x2a3cae;config[_0xd6a71f(0x2ca)](_0x4ca2ed=>{const _0x581e0e=_0xd6a71f;if(_0x4ca2ed[_0x581e0e(0x323)]=='enabled'&&_0x4ca2ed[_0x581e0e(0x2da)]==_0x581e0e(0x2e5)){if(pid[_0x4ca2ed[_0x581e0e(0x1f0)]])pid[_0x4ca2ed[_0x581e0e(0x1f0)]][_0x581e0e(0x27c)]({[_0x3749cb]:_0x370548});}});}function storeSettings(_0x260358,_0x2058ca=![]){const _0x270cff=_0x2a3cae;_0x260358={...settings,..._0x260358};if(_0x2058ca&&_0x260358[_0x270cff(0x28f)]!=_0x270cff(0x25a)&&_0x260358[_0x270cff(0x28f)]!=''){const _0x2dd984=crypt['decrypt'](secure[_0x270cff(0x288)],_0x260358[_0x270cff(0x28f)])[_0x270cff(0x206)][_0x270cff(0x2c9)]('@')[0x0],_0x2001e2=bcrypt[_0x270cff(0x26c)](_0x2dd984,saltRounds);_0x260358={..._0x260358,'bbPassword':_0x2001e2};}if(_0x2058ca&&_0x260358[_0x270cff(0x210)]!=_0x270cff(0x25a)&&_0x260358[_0x270cff(0x210)]!=''){const _0x5249f7=crypt['decrypt'](secure[_0x270cff(0x288)],_0x260358['telegramToken'])['message'][_0x270cff(0x2c9)]('@')[0x0];_0x260358={..._0x260358,'telegramToken':_0x5249f7};}const _0xc0eb8f=_0x260358['telegramToken']!='************'&&_0x260358[_0x270cff(0x210)]!=settings[_0x270cff(0x210)]||_0x260358[_0x270cff(0x2e6)]!=settings[_0x270cff(0x2e6)],_0x3fd6ad=_0x260358[_0x270cff(0x210)]==''||_0x260358['telegramUsername']=='';if(_0xc0eb8f)_0x260358[_0x270cff(0x2bf)]='all';for(const [_0xff4733,_0x2e728f]of Object[_0x270cff(0x31b)](_0x260358)){if(_0xff4733==_0x270cff(0x210)&&_0x2e728f==_0x270cff(0x25a)){_0x260358[_0x270cff(0x210)]=settings['telegramToken'];continue;};if(_0xff4733=='bbPassword'&&_0x2e728f==_0x270cff(0x25a)){_0x260358[_0x270cff(0x28f)]=settings[_0x270cff(0x28f)];continue;};dbSettings[_0x270cff(0x290)](_0x270cff(0x1f6)+_0xff4733,_0x2e728f)[_0x270cff(0x246)]();}settings=_0x260358,io['to']('botmanager')['emit'](_0x270cff(0x256),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']);if(_0xc0eb8f&&!_0x3fd6ad)initTelegram();if(_0xc0eb8f&&_0x3fd6ad)disableTelegram();getAllClients()[_0x270cff(0x2ca)](_0x5ca6f2=>{const _0xa95c29=_0x270cff;getSocket(_0x5ca6f2['id'])[_0xa95c29(0x2c3)](_0xa95c29(0x323),{'access':{'allow':![],'reason':_0xa95c29(0x200),'token':null}});});}function updateSetting(_0xe198c9,_0x27dc4e){const _0xa95f85=_0x2a3cae;dbSettings[_0xa95f85(0x290)](_0xa95f85(0x1f6)+_0xe198c9,_0x27dc4e)[_0xa95f85(0x246)](),settings=getSettings(),io['to']('botmanager')[_0xa95f85(0x2c3)]('settings',cleanSettings());}function storeSecure(_0x29ea2e){const _0x7d3236=_0x2a3cae;dbSecure[_0x7d3236(0x2f0)](_0x7d3236(0x2c8))[_0x7d3236(0x236)](_0x29ea2e)[_0x7d3236(0x246)](),secure=_0x29ea2e;}function addBlacklist(_0x3f207d){const _0x132692=_0x2a3cae;cleanBlacklist();let _0x3cf712;devices[_0x3f207d]['telegramIpApproval']?_0x3cf712=Math[_0x132692(0x241)](devices[_0x3f207d][_0x132692(0x30d)][_0x132692(0x283)],loginExpiry):_0x3cf712=loginExpiry,dbSecure[_0x132692(0x2f0)](_0x132692(0x31a))[_0x132692(0x236)]({'expiry':new Date()[_0x132692(0x260)]()+_0x3cf712*0x3c*0x3e8,'token':devices[_0x3f207d][_0x132692(0x243)]['token']})[_0x132692(0x246)](),blacklist=dbSecure['get']('blacklist')[_0x132692(0x237)]();}function cleanBlacklist(){const _0x418ba0=_0x2a3cae;let _0x417212=dbSecure[_0x418ba0(0x2f0)]('blacklist')[_0x418ba0(0x2e4)]()[_0x418ba0(0x237)](),_0x22e9f4=new Date()[_0x418ba0(0x260)]();_0x417212[_0x418ba0(0x2ca)](_0x2494a6=>{const _0x5d792d=_0x418ba0;_0x2494a6['expiry']<_0x22e9f4&&dbSecure['get'](_0x5d792d(0x31a))[_0x5d792d(0x21c)]({'expiry':_0x2494a6[_0x5d792d(0x283)]})['write']();});}function initStates(){let _0x36d453=getConfiguration();_0x36d453['forEach'](_0x5af1fd=>{const _0x2730b3=_0x2654;_0x5af1fd['live']=_0x2730b3(0x2aa);}),storeConfiguration(_0x36d453);}function onKeys(){const _0x27e2c5=new RSA();return new Promise(_0x3be370=>{const _0x438089=_0x2654;_0x27e2c5[_0x438089(0x22c)]()[_0x438089(0x2bd)](_0x2d4615=>{_0x3be370(_0x2d4615);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x308e37=_0x2a3cae;let _0xfebbea=getConfiguration(),_0x5a0355=![];_0xfebbea[_0x308e37(0x2ca)](_0x20ceaf=>{const _0x7c11b=_0x308e37;if(_0x20ceaf[_0x7c11b(0x323)]==_0x7c11b(0x2e5))_0x20ceaf[_0x7c11b(0x323)]=_0x7c11b(0x286),_0x5a0355=!![];else _0x20ceaf[_0x7c11b(0x323)]==_0x7c11b(0x2aa)&&(_0x20ceaf[_0x7c11b(0x323)]=_0x7c11b(0x2ab),_0x5a0355=!![]);});if(_0x5a0355)storeConfiguration(_0xfebbea);let _0x4a974c=getSecure();if(!_0x4a974c['hasOwnProperty'](_0x308e37(0x2d6))){let _0x15ce9c=await generateKeys();_0x4a974c[_0x308e37(0x227)]=_0x15ce9c[_0x308e37(0x227)],_0x4a974c['privateKey']=_0x15ce9c['privateKey'],_0x4a974c[_0x308e37(0x2d6)]=crypto[_0x308e37(0x1fa)](0x20)[_0x308e37(0x2d1)]('hex');;storeSecure(_0x4a974c);}let _0x50069a=getSettings();_0x5a0355=![];!_0x50069a[_0x308e37(0x312)]('loginRequired')&&(_0x50069a['loginRequired']=![],_0x50069a[_0x308e37(0x293)]='',_0x50069a['bbPassword']='',_0x50069a[_0x308e37(0x231)]=![],_0x5a0355=!![]);!_0x50069a[_0x308e37(0x312)]('whitelistEnabled')&&(_0x50069a['whitelistEnabled']=![],_0x50069a[_0x308e37(0x1ff)]=[],_0x50069a['temporaryAccessAllowed']=![],_0x5a0355=!![]);if(!_0x50069a[_0x308e37(0x312)](_0x308e37(0x28a))){if(_0x50069a[_0x308e37(0x213)])_0x50069a[_0x308e37(0x28a)]=!![];else _0x50069a[_0x308e37(0x28a)]=![];_0x5a0355=!![];}if(_0x5a0355)storeSettings(_0x50069a);}function storeConfiguration(_0x27f852){const _0x5e240f=_0x2a3cae;dbConfig[_0x5e240f(0x2f0)]('bots')[_0x5e240f(0x21c)]()['write'](),dbConfig[_0x5e240f(0x2f0)]('bots')[_0x5e240f(0x236)](..._0x27f852)[_0x5e240f(0x246)](),config=_0x27f852;}function resetPassword(){const _0x5e865c=_0x2a3cae;tgBot&&settings[_0x5e865c(0x213)]&&(tgBot[_0x5e865c(0x304)](_0x5e865c(0x222)),tgBot[_0x5e865c(0x330)](settings['telegramChatId'],_0x5e865c(0x2cf),{'parse_mode':_0x5e865c(0x2a9),'reply_markup':{'inline_keyboard':[[{'text':_0x5e865c(0x32e),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x5e865c(0x2ef)](_0x241703=>{telegramError(_0x241703);}),tgBot['on'](_0x5e865c(0x222),async _0x47ff86=>{const _0x1234bd=_0x5e865c,_0x118b15=_0x47ff86['data'],_0x4c1c4b=_0x47ff86[_0x1234bd(0x206)];tgBot['answerCallbackQuery'](_0x47ff86['id'])[_0x1234bd(0x2bd)](async()=>{const _0x521ce3=_0x1234bd;if(_0x118b15!='no'){const _0x1590bc=0xf,_0x5ee9b6=_0x521ce3(0x29b),_0x147278=Array[_0x521ce3(0x244)](crypto[_0x521ce3(0x2fd)](new Uint32Array(_0x1590bc)))[_0x521ce3(0x2b2)](_0x5af8fe=>_0x5ee9b6[_0x5af8fe%_0x5ee9b6[_0x521ce3(0x254)]])['join'](''),_0x91a14f=bcrypt[_0x521ce3(0x26c)](_0x147278,saltRounds);storeSettings({'bbPassword':_0x91a14f}),await tgBot['sendMessage'](_0x4c1c4b[_0x521ce3(0x2ae)]['id'],_0x521ce3(0x2e7)+_0x147278,{'parse_mode':_0x521ce3(0x2a9)})[_0x521ce3(0x2ef)](_0x3bf9ef=>{telegramError(_0x3bf9ef);});}else await tgBot[_0x521ce3(0x330)](_0x4c1c4b[_0x521ce3(0x2ae)]['id'],_0x521ce3(0x311))[_0x521ce3(0x2ef)](_0x3efb88=>{telegramError(_0x3efb88);});}),tgBot['removeListener']('callback_query');}));}function logging(_0x191d8f){const _0x4cd1e6=_0x2a3cae;console[_0x4cd1e6(0x1dc)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x191d8f);if(tgBot&&settings[_0x4cd1e6(0x213)]&&settings[_0x4cd1e6(0x2bf)]!=_0x4cd1e6(0x280))tgBot[_0x4cd1e6(0x330)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x191d8f)[_0x4cd1e6(0x2ef)](_0x1a9449=>{telegramError(_0x1a9449);});}function getServerTime(){const _0x18eb2f=_0x2a3cae,_0x2f5608=new Date();return _0x2f5608[_0x18eb2f(0x1f4)]()+'/'+(_0x2f5608[_0x18eb2f(0x21e)]()+0x1)[_0x18eb2f(0x2d1)]()[_0x18eb2f(0x274)](0x2,'0')+'/'+_0x2f5608[_0x18eb2f(0x1da)]()[_0x18eb2f(0x2d1)]()[_0x18eb2f(0x274)](0x2,'0')+'\x20'+_0x2f5608['getHours']()[_0x18eb2f(0x2d1)]()[_0x18eb2f(0x274)](0x2,'0')+':'+_0x2f5608[_0x18eb2f(0x1dd)]()[_0x18eb2f(0x2d1)]()[_0x18eb2f(0x274)](0x2,'0')+':'+_0x2f5608[_0x18eb2f(0x29e)]()[_0x18eb2f(0x2d1)]()[_0x18eb2f(0x274)](0x2,'0');}function getTimeStamp(){const _0x4bff44=_0x2a3cae,_0x354549=shiftedTime();return _0x354549[_0x4bff44(0x1f4)]()+'/'+(_0x354549['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x354549['getDate']()[_0x4bff44(0x2d1)]()[_0x4bff44(0x274)](0x2,'0')+'\x20'+_0x354549['getHours']()[_0x4bff44(0x2d1)]()[_0x4bff44(0x274)](0x2,'0')+':'+_0x354549[_0x4bff44(0x1dd)]()[_0x4bff44(0x2d1)]()[_0x4bff44(0x274)](0x2,'0')+':'+_0x354549[_0x4bff44(0x29e)]()[_0x4bff44(0x2d1)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x466a40=_0x2a3cae,_0x3f214e=new Date();let _0x8996c2=_0x3f214e;if(settings[_0x466a40(0x2df)]&&settings[_0x466a40(0x2df)]!==0x0)_0x8996c2=fns[_0x466a40(0x269)](_0x3f214e,{'hours':settings[_0x466a40(0x2df)]});return _0x8996c2;}function startScheduler(){const _0xa69ff7=_0x2a3cae;let _0x4f796f=new Date()[_0xa69ff7(0x2ac)]();_0x4f796f==0x1&&backupConfigFiles();_0x4f796f==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0xf12bc2=_0x2a3cae;fs[_0xf12bc2(0x20e)](configpath,{'withFileTypes':!![]})[_0xf12bc2(0x2ca)](_0x3adcf3=>{const _0x32ece0=_0xf12bc2;if(!_0x3adcf3[_0x32ece0(0x2ed)]())fs[_0x32ece0(0x2fc)](configpath+_0x3adcf3[_0x32ece0(0x31c)],configbackuppath+_0x3adcf3['name']);});}function triggerAnalytics(){const _0x233c1e=_0x2a3cae;analytics[_0x233c1e(0x220)]({'title':_0x233c1e(0x2f5),'href':_0x233c1e(0x324),'path':'/v'+serverversion});}function validateCredentials(_0x26652c,_0x294969){const _0x4ae6dc=_0x2a3cae;if(_0x26652c[_0x4ae6dc(0x2f1)]==settings[_0x4ae6dc(0x293)]&&bcrypt[_0x4ae6dc(0x25f)](_0x26652c[_0x4ae6dc(0x2f6)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x4ae6dc(0x1eb),'token':null};else{const _0x1a79cf=generateLoginToken(_0x294969);return{'allow':!![],'reason':_0x4ae6dc(0x252),'token':_0x1a79cf};}}else return{'allow':![],'reason':_0x4ae6dc(0x29a),'token':null};}function refreshToken(_0x1f6ca5){const _0x246602=_0x2a3cae,_0x159185=generateLoginToken(_0x1f6ca5);return{'allow':!![],'reason':_0x246602(0x252),'token':_0x159185};}function validateAccess(_0x43b949,_0x3c877a){const _0x538ca4=_0x2a3cae;let _0x3949bd=devices[_0x3c877a]['ip'],_0x3c3b23;const _0x5a5d6c=_0xf74b93=>{const _0xe8a99b=_0x2654;if(settings[_0xe8a99b(0x2fe)]){if(settings[_0xe8a99b(0x231)]){if(telegram2FaApproved(_0x3c877a)){const _0x1445d0=generateLoginToken(_0x3c877a);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1445d0};}else return{'allow':![],'reason':_0xe8a99b(0x281),'token':null};}else return _0x3c3b23=validToken(_0xf74b93,_0x3c877a),_0x3c3b23[_0xe8a99b(0x312)](_0xe8a99b(0x24a))?{'allow':!![],'reason':_0xe8a99b(0x1e7),'token':_0xf74b93}:{'allow':![],'reason':_0xe8a99b(0x281),'token':null};}else return{'allow':!![],'reason':_0xe8a99b(0x284),'token':null};};if(settings[_0x538ca4(0x2cb)]){let _0xeef88e=[...settings[_0x538ca4(0x1ff)],_0x538ca4(0x24c),_0x538ca4(0x2e3),_0x538ca4(0x230)];if(_0xeef88e['includes'](_0x3949bd))return _0x5a5d6c(_0x43b949);else{_0x3c3b23=validToken(_0x43b949,_0x3c877a);if(_0x3c3b23[_0x538ca4(0x312)](_0x538ca4(0x24a)))return _0x5a5d6c(_0x43b949);else{if(telegramIpApproved(_0x3c877a)){const _0x460658=generateToken(_0x3c877a);return _0x3c3b23=_0x5a5d6c(_0x43b949),_0x3c3b23['allow']?{'allow':!![],'reason':_0x538ca4(0x2ba),'token':_0x460658}:_0x3c3b23;}else return settings[_0x538ca4(0x259)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x538ca4(0x2bc),'token':null};}}}else return _0x5a5d6c(_0x43b949);}function timelyDecrypt(_0x3bd34c,_0x1394bb=!![]){const _0x490876=_0x2a3cae;if(_0x3bd34c)try{const _0x1a2186=crypt[_0x490876(0x20c)](secure[_0x490876(0x288)],_0x3bd34c)[_0x490876(0x206)],_0x11580c=_0x1a2186[_0x490876(0x2c9)]('@')[0x0],_0x3f3162=_0x1a2186[_0x490876(0x2c9)]('@')[0x1],_0x380438=new Date()[_0x490876(0x260)]();if(_0x1394bb){if(_0x380438-_0x3f3162<maxSecretAge*0x3e8)return _0x11580c;else return![];}else return _0x11580c;}catch(_0xf90f23){return![];}else return![];}const validToken=(_0x2bcba9,_0x27b79b)=>{const _0x493580=_0x2a3cae,_0x5a03b8=devices[_0x27b79b]['ip'];if(!_0x2bcba9)return{'error':_0x493580(0x276)};for(let _0x3fa5d9 of blacklist){if(_0x3fa5d9[_0x493580(0x217)]==_0x2bcba9)return{'error':_0x493580(0x264)};}let _0x15d85a;try{_0x15d85a=jwt[_0x493580(0x1ed)](_0x2bcba9,secure[_0x493580(0x2d6)]+_0x27b79b);}catch{return{'error':_0x493580(0x1ea)};}if(!_0x15d85a['hasOwnProperty']('clientip')&&!_0x15d85a['hasOwnProperty'](_0x493580(0x2f1))||!_0x15d85a['hasOwnProperty']('exp'))return{'error':_0x493580(0x313)};if(!_0x15d85a['hasOwnProperty'](_0x493580(0x2f1))&&_0x15d85a[_0x493580(0x312)](_0x493580(0x28b))){const {clientip:_0x3416f1}=_0x15d85a;return _0x5a03b8==_0x3416f1?{'success':_0x493580(0x298)}:{'error':_0x493580(0x267)};}else{if(_0x15d85a[_0x493580(0x312)]('username')&&_0x15d85a[_0x493580(0x312)](_0x493580(0x28b))){const {username:_0x5197dd,clientip:_0xf22826}=_0x15d85a;return settings[_0x493580(0x293)]==_0x5197dd&&_0x5a03b8==_0xf22826?{'success':_0x493580(0x298)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x40d759=>{const _0xabc0ff=_0x2a3cae;if(_0x40d759){const _0x512da3=devices[_0x40d759]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x512da3},secure[_0xabc0ff(0x2d6)]+_0x40d759,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x236331=>{const _0x253ef8=_0x2a3cae;if(_0x236331){const _0xa75469=devices[_0x236331]['ip'];return jwt[_0x253ef8(0x2a4)]({'clientip':_0xa75469},secure[_0x253ef8(0x2d6)]+_0x236331,{'expiresIn':devices[_0x236331][_0x253ef8(0x30d)][_0x253ef8(0x283)]*0x3c});}else return![];},telegramIpApproved=_0x3501df=>{const _0xe86631=_0x2a3cae;let _0x41fb43=![];return devices[_0x3501df]['telegramIpApproval']&&devices[_0x3501df][_0xe86631(0x30d)]['expiry']!='reject'&&(_0x41fb43=devices[_0x3501df]['telegramIpApproval'][_0xe86631(0x28b)]==devices[_0x3501df]['ip']&&new Date()[_0xe86631(0x260)]()-devices[_0x3501df][_0xe86631(0x30d)][_0xe86631(0x22e)]<devices[_0x3501df][_0xe86631(0x30d)][_0xe86631(0x283)]*0x3c*0x3e8),_0x41fb43;},telegram2FaApproved=_0x66d58=>{const _0xd98c70=_0x2a3cae;let _0x4b6622=![];return devices[_0x66d58][_0xd98c70(0x326)]&&devices[_0x66d58][_0xd98c70(0x326)][_0xd98c70(0x283)]!=_0xd98c70(0x2c0)&&(_0x4b6622=devices[_0x66d58][_0xd98c70(0x326)][_0xd98c70(0x28b)]==devices[_0x66d58]['ip']&&new Date()[_0xd98c70(0x260)]()-devices[_0x66d58][_0xd98c70(0x326)][_0xd98c70(0x22e)]<devices[_0x66d58][_0xd98c70(0x326)][_0xd98c70(0x283)]*0x3c*0x3e8),_0x4b6622;},normalizeIP=_0x38a587=>{const _0x2d7e5e=_0x2a3cae;let _0x256496=null,_0x86a7cc=null;if(ipaddr['isValid'](_0x38a587)){const _0x11aba3=ipaddr[_0x2d7e5e(0x2cc)](_0x38a587);_0x11aba3['kind']()==='ipv6'?(_0x11aba3[_0x2d7e5e(0x27b)]()&&(_0x256496=_0x11aba3[_0x2d7e5e(0x1de)]()[_0x2d7e5e(0x2d1)]()),_0x86a7cc=_0x11aba3[_0x2d7e5e(0x2d1)]()):(_0x256496=_0x11aba3[_0x2d7e5e(0x2d1)](),_0x86a7cc=_0x11aba3['toIPv4MappedAddress']()['toString']());}return{'show':_0x256496?_0x256496:_0x86a7cc,'store':_0x86a7cc};};