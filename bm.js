const _0x40367a=_0x1c13;(function(_0x3f35df,_0x1e5bc2){const _0x37b605=_0x1c13,_0x9abe21=_0x3f35df();while(!![]){try{const _0x367678=-parseInt(_0x37b605(0x15f))/0x1+parseInt(_0x37b605(0x16d))/0x2+parseInt(_0x37b605(0x16f))/0x3*(-parseInt(_0x37b605(0x225))/0x4)+parseInt(_0x37b605(0x221))/0x5+parseInt(_0x37b605(0x1ac))/0x6+parseInt(_0x37b605(0x178))/0x7+-parseInt(_0x37b605(0x17d))/0x8;if(_0x367678===_0x1e5bc2)break;else _0x9abe21['push'](_0x9abe21['shift']());}catch(_0x56bc9c){_0x9abe21['push'](_0x9abe21['shift']());}}}(_0x5963,0xe703b));const _0x1a412a=function(){let _0x38442d=!![];return function(_0xb04a31,_0x1031fc){const _0x211665=_0x38442d?function(){if(_0x1031fc){const _0x1a9f53=_0x1031fc['apply'](_0xb04a31,arguments);return _0x1031fc=null,_0x1a9f53;}}:function(){};return _0x38442d=![],_0x211665;};}(),_0x47af80=_0x1a412a(this,function(){const _0x228c7c=_0x1c13;return _0x47af80['toString']()['search'](_0x228c7c(0x12b))['toString']()['constructor'](_0x47af80)[_0x228c7c(0x17b)](_0x228c7c(0x12b));});_0x47af80();'use strict';process[_0x40367a(0x1ea)][_0x40367a(0x10e)]=0x1;function _0x5963(){const _0x2490df=['analytics','All\x20bots\x20running\x20right\x20now','privateKey','forEach','get-logs','Unauthorized\x20attempt\x20to\x20update\x20settings','/on\x20-\x20start\x20bot(s)\x0a','temporary\x20token\x20generated','Unauthorized\x20login\x20attempt\x20(timeout)','order','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','f2aRequired','readdirSync','telegram','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','removeListener','Password\x20has\x20been\x20reset\x20to:\x20','/:bot/support','No\x20authentication\x20token','storeHeadless','slice','5\x20min','mkdirSync','callback_query','once','conn','notification','RSA-OAEP','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','compareSync','Unauthorized\x20login\x20attempt\x20(public\x20key)','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','randomFillSync','length','new-disabled','3962050nrTfzX','telegramIpApproval','write','Notifications\x20disabled\x0a','4keKLsU','getMinutes','secret','whitelistEnabled','getUTCHours','Login\x20accepted','sendFile','Ok,\x20will\x20send\x20alert\x20notifications\x20only','bots','telegramChatId','getTime','starting\x20bot\x20|\x20Bot\x20','success','/disable\x20-\x20disable\x20notifications\x0a','message','backup/','disabled','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','telegramEvents','disabled\x20Bot\x20','bcryptjs','reject','\x20>\x20','keys','storeConfiguration','status','cancel-loading','uuid','default','show','<b>Balance\x20Bot\x20status:</b>\x0a','value','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','pidRefreshToken','settings','headers','stopPolling','bot','initclient','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','isValid','map','referer','page','get','Bot\x20Mgr\x20>\x20','NTBA_FIX_319','isIPv4MappedAddress','reason','reload','removeAllListeners','User\x20has\x20been\x20validated','log','/:bot/portfolio','telegramToken','bot.js','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','\x20minutes','\x20only\x0a','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','hashSync','connection','test','Unauthorized\x20attempt\x20to\x20store\x20configuration','use','Error:\x20Invalid\x20argument\x20','logout','orders','pidExpireLogin','/:bot/configuration','jsonwebtoken','Balance\x20Bot\x20Server','started','name','version','(((.+)+)+)+$','/:bot/performance','answerCallbackQuery','Invalid\x20Telegram\x20token','Temporary\x20access\x20rejected','SIGTERM','bot-','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20delete\x20bot','login\x20token\x20valid','telegramUsername','index.html','getFullYear','catch','timeshift','Token\x20blacklisted','sortBy','Orders','express','2FA\x20login\x20required','getSeconds','live','SIGINT','Notifications\x20enabled','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','set','path','Bot\x20','emit','allow','2FA\x20login\x20token\x20generated','stopped','defaults','Unauthorized\x20attempt\x20to\x20update\x20bot','No\x20bots\x20running\x20right\x20now','3000','exp','send','expiry','user','clientip','2FA','login\x20not\x20required','function','store-configuration','Access\x20enabled\x20for\x20','alerts','http','restarting\x20Bot\x20','timestamp','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','store','1212373fpYoQv','apiKey','toString','************','unlinkSync','30\x20min','join','login\x20token\x20generated','/off\x20-\x20stop\x20bot(s)\x0a','server','new','15\x20min','accept','kind','2858206zXteSR','config/','5153415VgEdlo','from','includes','temporary\x20access\x20rejected','idling\x20bot\x20\x20\x20|\x20Bot\x20','clients','bbPassword','getMonth','split','12342897aPbBIM','then','bbUsername','search','hex','9898624eXuHoQ','push','find','1000','update-bb','assign','args','child_process','/enable\x20-\x20enable\x20notifications\x0a','Crypt','temporaryAccessAllowed','botname','node-telegram-bot-api','Unauthorized\x20attempt\x20to\x20get\x20portfolio','<b>Telegram\x20bot\x20status:</b>\x0a','entries','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','username','access','bb-secure.json','whitelist','exit','Invalid\x20username\x20or\x20IP\x20address','decrypt','lowdb/adapters/FileSync','stop','Unauthorized\x20attempt\x20to\x20get\x20logs','running','filter','RSA','UA-192771731-1','Invalid\x20IP\x20address','/:bot','bb-config.json','\x20|\x20','telegramEnabled','connected','enabled','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','deleted\x20Bot\x20','createServer','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','data','cloneDeep','telegram2FaApproval',',\x20must\x20be\x20a\x204\x20digit\x20number','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','6773742imnJWx','inherit','getStartingBalances','login','event','secure','build2','botmanager','randomBytes','argv','onText','blacklist','build','all','disconnect','https://hodlerhacks.com','sign','padStart','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','publicKey','crypto','store-headless',':\x20Bot\x20Mgr\x20>\x20','password','sendMessage','invalid\x20credentials','ipc','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Alerts','cancelLoading','remove','loginRequired','hasOwnProperty','handshake','hybrid-crypto-js','emitHistory','toIPv4Address','Notifications\x20disabled','date-fns','login\x20required','-----------------------------------------------------------------------------------','static','kill','::1','showname','port','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','placeOrder','/help\x20-\x20show\x20available\x20commands\x0a','getDate','Password\x20reset\x20rejected','Invalid\x20authentication\x20token\x20(2)','token','type','/:bot/coins','get-portfolio','enabled\x20Bot\x20','reset-password','\x20/\x20','ipaddr.js','-performance.json','match','env','Balance\x20Bot','error\x20while\x20deleting\x20config\x20files:\x20','</b>\x20?','delete-bot','All\x20bots','Ok,\x20will\x20send\x20order\x20notifications\x20only','ipv6','botID',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','HTML','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','2FA\x20required','chat','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','existsSync','sockets','getHours','error','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'];_0x5963=function(){return _0x2490df;};return _0x5963();}const childProcess=require(_0x40367a(0x184)),FileSync=require(_0x40367a(0x195)),fs=require('fs'),fns=require(_0x40367a(0x1d2)),low=require('lowdb'),path=require(_0x40367a(0x145)),crypto=require(_0x40367a(0x1c0)),Crypt=require(_0x40367a(0x1ce))[_0x40367a(0x186)],RSA=require(_0x40367a(0x1ce))[_0x40367a(0x19a)],bcrypt=require(_0x40367a(0xf4)),jwt=require(_0x40367a(0x126)),analyticsLib=require(_0x40367a(0x1fe))[_0x40367a(0xfc)],googleAnalytics=require('@analytics/google-analytics')[_0x40367a(0xfc)],ipaddr=require(_0x40367a(0x1e7)),argv=require('yargs/yargs')(process[_0x40367a(0x1b5)][_0x40367a(0x212)](0x2))[_0x40367a(0x1b5)],PORT=argv[_0x40367a(0x1d9)]||_0x40367a(0x14e),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x40367a(0x11e)](PORT))return console['log'](_0x40367a(0x121)+PORT+_0x40367a(0x1aa)),process[_0x40367a(0x192)](0x1);const HOST=argv['host']||null,userID=argv[_0x40367a(0x152)]||'';let bbpath='bb/',bbpath2='';const botfile=_0x40367a(0x117),configfile=_0x40367a(0x19e),settingsfile='bb-settings.json',securefile=_0x40367a(0x190);!fs[_0x40367a(0x1f9)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x40367a(0x174)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x40367a(0x16e),configbackuppath=configpath+_0x40367a(0xef);!fs[_0x40367a(0x1f9)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x40367a(0x1f9)](configbackuppath)&&fs[_0x40367a(0x214)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x40367a(0x14b)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0x40367a(0x223)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x40367a(0x223)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x40367a(0x219)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x40367a(0x12a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x40367a(0x13d)),app=express(),http=require(_0x40367a(0x15a))[_0x40367a(0x1a5)](app);app[_0x40367a(0x120)](express[_0x40367a(0x1d5)](path[_0x40367a(0x165)](__dirname,bbpath2,_0x40367a(0x1b2)))),app['use'](express[_0x40367a(0x1d5)](path['join'](__dirname,bbpath2,_0x40367a(0x1b8)))),app[_0x40367a(0x10c)]('/',function(_0x317be4,_0x28e5ac){const _0x54ad45=_0x40367a;_0x28e5ac['sendFile'](path[_0x54ad45(0x165)](__dirname,bbpath2,_0x54ad45(0x1b2),_0x54ad45(0x136)));}),app[_0x40367a(0x10c)](_0x40367a(0x19d),function(_0x8f1940,_0x345b76){const _0x1d77a1=_0x40367a;_0x345b76['sendFile'](path['join'](__dirname,bbpath2,_0x1d77a1(0x1b8),_0x1d77a1(0x136)));}),app[_0x40367a(0x10c)](_0x40367a(0x115),(_0x1fb6c4,_0x1403ab)=>{const _0x5c967b=_0x40367a;_0x1403ab[_0x5c967b(0x22b)](path[_0x5c967b(0x165)](__dirname,bbpath2,_0x5c967b(0x1b8),'index.html'));}),app[_0x40367a(0x10c)](_0x40367a(0x12c),(_0x597ec5,_0x1573d9)=>{const _0x1a90ab=_0x40367a;_0x1573d9[_0x1a90ab(0x22b)](path['join'](__dirname,bbpath2,'build',_0x1a90ab(0x136)));}),app[_0x40367a(0x10c)](_0x40367a(0x1e2),(_0x170749,_0x22d23b)=>{const _0x16f73b=_0x40367a;_0x22d23b['sendFile'](path[_0x16f73b(0x165)](__dirname,bbpath2,_0x16f73b(0x1b8),_0x16f73b(0x136)));}),app[_0x40367a(0x10c)]('/:bot/history',(_0xb1aa3c,_0x4e77e2)=>{const _0x10b5db=_0x40367a;_0x4e77e2[_0x10b5db(0x22b)](path[_0x10b5db(0x165)](__dirname,bbpath2,_0x10b5db(0x1b8),'index.html'));}),app[_0x40367a(0x10c)](_0x40367a(0x125),(_0xf7e2ee,_0xbfd47c)=>{const _0x9e3e66=_0x40367a;_0xbfd47c[_0x9e3e66(0x22b)](path[_0x9e3e66(0x165)](__dirname,bbpath2,_0x9e3e66(0x1b8),'index.html'));}),app['get'](_0x40367a(0x20f),(_0xef563b,_0x48418e)=>{const _0x47b1cb=_0x40367a;_0x48418e['sendFile'](path[_0x47b1cb(0x165)](__dirname,bbpath2,_0x47b1cb(0x1b8),_0x47b1cb(0x136)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x40367a(0x1eb),'plugins':[googleAnalytics({'trackingId':_0x40367a(0x19b)})]}),TelegramBot=require(_0x40367a(0x189));let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x40367a(0x135)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x3ef745=_0x40367a;console[_0x3ef745(0x114)](''),console['log'](_0x3ef745(0x1d4)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x3ef745(0x114)]('-----------------------------------------------------------------------------------');if(config[_0x3ef745(0x21f)]!=0x0)config['forEach'](_0x4b6f61=>{const _0x170286=_0x3ef745;if(_0x4b6f61[_0x170286(0xf9)]=='enabled'||_0x4b6f61[_0x170286(0xf9)]==_0x170286(0x169))logging(_0x170286(0x230)+_0x4b6f61[_0x170286(0x1f2)]+_0x170286(0x19f)+_0x4b6f61[_0x170286(0x188)]),startBot([_0x4b6f61[_0x170286(0x1f2)],userID],{'cwd':bbpath},function(_0x21fc77){if(_0x21fc77)logging(_0x21fc77);});else(_0x4b6f61[_0x170286(0xf9)]=='disabled'||_0x4b6f61[_0x170286(0xf9)]==_0x170286(0x220))&&logging(_0x170286(0x173)+_0x4b6f61['botID']+_0x170286(0x19f)+_0x4b6f61[_0x170286(0x188)]);});else!newBot&&console[_0x3ef745(0x114)](_0x3ef745(0x1ab));if(newBot)addBot();console['log'](_0x3ef745(0x1d4)),console[_0x3ef745(0x114)]('');}function startSocket(){const _0x4b859c=_0x40367a;io['on'](_0x4b859c(0x11d),_0x498750=>{const _0x18174e=_0x4b859c;let _0x3edf8d,_0x5aba06,_0x5446f0,_0x5c737c,_0xa69d0c;const _0x443469=_0x498750[_0x18174e(0x1cd)][_0x18174e(0x103)][_0x18174e(0x10a)];_0x5aba06=_0x443469[_0x18174e(0x1e9)](/bot[0-9]{3}/);if(_0x5aba06)_0x5446f0=_0x5aba06[0x0][_0x18174e(0x1e9)](/[0-9]{3}/);if(_0x5446f0)_0x3edf8d=_0x5446f0[0x0];else _0x3edf8d=_0x18174e(0x1b3);const _0x31a0e0=_0x498750[_0x18174e(0x1cd)]['auth']['encryptedUuid'];if(!_0x31a0e0)_0x498750[_0x18174e(0x147)](_0x18174e(0xf9),{'publicKey':secure[_0x18174e(0x1bf)]});else{_0x5c737c=timelyDecrypt(_0x31a0e0,![]);if(!_0x5c737c)logging(_0x18174e(0x21c));else{_0xa69d0c=normalizeIP(_0x498750[_0x18174e(0x217)]['remoteAddress'])[_0x18174e(0x15e)];if(!devices[_0x5c737c])devices[_0x5c737c]={'uuid':_0x5c737c,'access':{'token':null}};devices[_0x5c737c]['ip']=_0xa69d0c;const _0x1beb91=addClient(_0x498750['id'],_0x5c737c,_0x3edf8d);setAccess(_0x1beb91),_0x498750['on'](_0x18174e(0x1af),_0x2846c4=>{const _0x2b626c=_0x18174e,_0x2d3e75=timelyDecrypt(_0x2846c4['password']);if(_0x2d3e75){_0x2846c4={'username':_0x2846c4[_0x2b626c(0x18e)],'password':_0x2d3e75},devices[_0x5c737c]['access']=validateCredentials(_0x2846c4,_0x5c737c);if(devices[_0x5c737c][_0x2b626c(0x18f)]['allow']==![]&&devices[_0x5c737c][_0x2b626c(0x18f)]['reason']==_0x2b626c(0x13e))_0x498750['emit'](_0x2b626c(0xf9),{'access':devices[_0x5c737c][_0x2b626c(0x18f)]}),loginAccess2FA(_0x5c737c,_0xa69d0c);else{if(devices[_0x5c737c][_0x2b626c(0x18f)][_0x2b626c(0x148)]==![]&&devices[_0x5c737c][_0x2b626c(0x18f)][_0x2b626c(0x110)]==_0x2b626c(0x1c5))_0x498750[_0x2b626c(0x147)](_0x2b626c(0xf9),{'access':devices[_0x5c737c][_0x2b626c(0x18f)]});else devices[_0x5c737c][_0x2b626c(0x18f)][_0x2b626c(0x148)]&&devices[_0x5c737c]['access'][_0x2b626c(0x110)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5c737c)[_0x2b626c(0x201)](_0x3af4e0=>{setAccess(_0x3af4e0);}),setTokenRefresh(_0x5c737c),setSessionTimeout(_0x2b626c(0x1af),_0x5c737c));}}else logging(_0x2b626c(0x206));}),_0x498750['on'](_0x18174e(0x1e5),()=>{resetPassword();}),_0x498750['on'](_0x18174e(0x1ba),_0x476a28=>{removeClient(_0x498750['id']);});}}});}function initClient(_0x53316d){const _0x2c9fde=_0x40367a;if(_0x53316d!=_0x2c9fde(0x1b3)&&config[_0x2c9fde(0x160)]!=''){if(pid[_0x53316d])pid[_0x53316d][_0x2c9fde(0x150)]({'function':_0x2c9fde(0x106),'args':null});}}function getSocket(_0x225823){const _0x3249d8=_0x40367a;return io['sockets'][_0x3249d8(0x1fa)][_0x3249d8(0x10c)](_0x225823);}function setAccess(_0x1ece96){const _0x943ce7=_0x40367a,_0x2180d6=getSocket(_0x1ece96['id']),_0xd12fc1=_0x1ece96[_0x943ce7(0xfb)],_0x5ecf48=_0x1ece96[_0x943ce7(0x105)];devices[_0xd12fc1][_0x943ce7(0x18f)]=validateAccess(devices[_0xd12fc1]['access']['token'],_0xd12fc1),_0x2180d6['join'](_0xd12fc1);if(devices[_0xd12fc1][_0x943ce7(0x18f)]['allow']){_0x2180d6[_0x943ce7(0x165)](_0x5ecf48);if(_0x5ecf48==_0x943ce7(0x1b3))initializeSocketBotManager(_0x2180d6);else initializeSocketBot(_0x2180d6);initClient(_0x5ecf48);}devices[_0xd12fc1]['access'][_0x943ce7(0x1e0)]&&devices[_0xd12fc1]['access'][_0x943ce7(0x110)]==_0x943ce7(0x205)&&setSessionTimeout(_0x943ce7(0x154),_0xd12fc1),devices[_0xd12fc1][_0x943ce7(0x18f)]['token']&&devices[_0xd12fc1]['access'][_0x943ce7(0x110)]==_0x943ce7(0x149)&&setSessionTimeout('login',_0xd12fc1),_0x2180d6[_0x943ce7(0x147)](_0x943ce7(0xf9),{'status':_0x1ece96[_0x943ce7(0x168)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xd12fc1][_0x943ce7(0x18f)],'externalip':devices[_0xd12fc1]['ip'],'publicKey':secure['publicKey']}),devices[_0xd12fc1][_0x943ce7(0x18f)]['allow']==![]&&devices[_0xd12fc1][_0x943ce7(0x18f)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0xd12fc1,devices[_0xd12fc1]['ip']);}function setSessionTimeout(_0x4d4d8a,_0x53332f){const _0x247e80=_0x40367a;let _0x445d32;if(_0x4d4d8a==_0x247e80(0x1af))_0x445d32=loginExpiry*0x3c*0x3e8;else _0x445d32=devices[_0x53332f][_0x247e80(0x222)][_0x247e80(0x151)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x53332f][_0x247e80(0x222)]['timestamp']);if(devices[_0x53332f]['pidExpireLogin'])clearTimeout(devices[_0x53332f][_0x247e80(0x124)]);devices[_0x53332f][_0x247e80(0x124)]=setTimeout(()=>{const _0x2c0390=_0x247e80;if(devices[_0x53332f][_0x2c0390(0x101)])clearTimeout(devices[_0x53332f][_0x2c0390(0x101)]);removeSocketListeners(_0x53332f),addBlacklist(_0x53332f),devices[_0x53332f][_0x2c0390(0x222)]=null,devices[_0x53332f][_0x2c0390(0x1a9)]=null,devices[_0x53332f][_0x2c0390(0x18f)][_0x2c0390(0x1e0)]=null,devices[_0x53332f][_0x2c0390(0x18f)]=validateAccess(devices[_0x53332f][_0x2c0390(0x18f)][_0x2c0390(0x1e0)],_0x53332f),!(devices[_0x53332f][_0x2c0390(0x18f)][_0x2c0390(0x148)]&&devices[_0x53332f][_0x2c0390(0x18f)][_0x2c0390(0x110)]==_0x2c0390(0x155))&&(_0x4d4d8a==_0x2c0390(0x1af)?io['to'](_0x53332f)[_0x2c0390(0x147)](_0x2c0390(0xf9),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x53332f)[_0x2c0390(0x147)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x53332f]['access']['token']=null;},_0x445d32);}function setTokenRefresh(_0x528eb0){const _0x308222=_0x40367a;if(devices[_0x528eb0][_0x308222(0x101)])clearTimeout(devices[_0x528eb0][_0x308222(0x101)]);devices[_0x528eb0]['pidRefreshToken']=setTimeout(()=>{const _0x3bb695=_0x308222;getClientsWithUuid(_0x528eb0)[_0x3bb695(0x21f)]!=0x0?(devices[_0x528eb0][_0x3bb695(0x18f)]=refreshToken(_0x528eb0),io['to'](_0x528eb0)[_0x3bb695(0x147)]('status',{'status':_0x3bb695(0x1a1),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x528eb0][_0x3bb695(0x18f)],'externalip':devices[_0x528eb0]['ip'],'publicKey':secure[_0x3bb695(0x1bf)]}),setTokenRefresh(_0x528eb0)):clearTimeout(devices[_0x528eb0][_0x3bb695(0x101)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function _0x1c13(_0x46c2d1,_0x1cfab0){const _0x1cc63a=_0x5963();return _0x1c13=function(_0x47af80,_0x1a412a){_0x47af80=_0x47af80-0xed;let _0x596341=_0x1cc63a[_0x47af80];return _0x596341;},_0x1c13(_0x46c2d1,_0x1cfab0);}function initializeSocketBotManager(_0x22217f){const _0x3a6542=_0x40367a,_0x3897c4=getClient(_0x22217f['id'])[_0x3a6542(0xfb)];_0x22217f[_0x3a6542(0x147)](_0x3a6542(0x22d),config),_0x22217f[_0x3a6542(0x147)](_0x3a6542(0x102),cleanSettings()),_0x22217f['on']('add-bot',_0x101b44=>{const _0x47fd71=_0x3a6542;if(validateAccess(_0x101b44,_0x3897c4)[_0x47fd71(0x148)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x22217f['on']('update-bot',(_0x10cb7f,_0x5ce01f)=>{const _0x4ab525=_0x3a6542;if(validateAccess(_0x5ce01f,_0x3897c4)['allow'])toggleBot(_0x10cb7f[_0x4ab525(0x1f2)],_0x10cb7f[_0x4ab525(0xf9)],_0x10cb7f[_0x4ab525(0x140)]);else logging(_0x4ab525(0x14c));}),_0x22217f['on'](_0x3a6542(0x1ee),(_0x19e3a6,_0x32bbde)=>{const _0x394bc9=_0x3a6542;if(validateAccess(_0x32bbde,_0x3897c4)['allow'])deleteBot(_0x19e3a6);else logging(_0x394bc9(0x133));}),_0x22217f['on']('store-settings',(_0x2415d2,_0x4fb115)=>{const _0x57f5db=_0x3a6542;if(validateAccess(_0x4fb115,_0x3897c4)[_0x57f5db(0x148)])storeSettings(_0x2415d2,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x22217f['on'](_0x3a6542(0x181),(_0xfcf76c,_0x6c248d)=>{const _0x5c6bcb=_0x3a6542;if(validateAccess(_0x6c248d,_0x3897c4)[_0x5c6bcb(0x148)])updateBB();else logging(_0x5c6bcb(0x203));}),_0x22217f['on'](_0x3a6542(0x122),_0x3c265d=>{const _0x422943=_0x3a6542;if(validateAccess(_0x3c265d,_0x3897c4)[_0x422943(0x148)]){if(devices[_0x3897c4]['pidRefreshToken'])clearTimeout(devices[_0x3897c4]['pidRefreshToken']);if(devices[_0x3897c4][_0x422943(0x124)])clearTimeout(devices[_0x3897c4][_0x422943(0x124)]);removeSocketListeners(getClient(_0x22217f['id'])[_0x422943(0xfb)]),addBlacklist(_0x3897c4),devices[_0x3897c4][_0x422943(0x222)]=null,devices[_0x3897c4][_0x422943(0x1a9)]=null,devices[_0x3897c4][_0x422943(0x18f)]['token']=null,io['to'](getClient(_0x22217f['id'])['uuid'])[_0x422943(0x147)](_0x422943(0xf9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x422943(0x132));});}function initializeSocketBot(_0x1cef44){const _0x453ead=_0x40367a,_0x35cdb4=getClient(_0x1cef44['id'])['bot'],_0x5e8092=getClient(_0x1cef44['id'])[_0x453ead(0xfb)];_0x1cef44['on'](_0x453ead(0x202),(_0x327f42,_0x1b102a)=>{const _0x6723d8=_0x453ead;if(validateAccess(_0x1b102a,_0x5e8092)['allow']){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x6723d8(0x150)]({'function':_0x6723d8(0x1cf),'args':_0x327f42});}else logging(_0x6723d8(0x197));}),_0x1cef44['on'](_0x453ead(0x1e3),(_0x3a3c4f,_0x54859f)=>{const _0x94592b=_0x453ead;if(validateAccess(_0x54859f,_0x5e8092)['allow']){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x94592b(0x150)]({'function':'getPortfolio','args':_0x3a3c4f});}else logging(_0x94592b(0x18a));}),_0x1cef44['on'](_0x453ead(0x157),(_0x4e44cd,_0x486541)=>{const _0x545345=_0x453ead;if(validateAccess(_0x486541,_0x5e8092)[_0x545345(0x148)]){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x545345(0x150)]({'function':_0x545345(0xf8),'args':_0x4e44cd});}else logging(_0x545345(0x11f));}),_0x1cef44['on'](_0x453ead(0x1c1),(_0x5a36ac,_0x14a4c7)=>{const _0x37568d=_0x453ead;if(validateAccess(_0x14a4c7,_0x5e8092)['allow']){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x37568d(0x150)]({'function':_0x37568d(0x211),'args':_0x5a36ac});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x1cef44['on']('get-starting-balances',_0x5cca0c=>{const _0x2e4f1=_0x453ead;if(validateAccess(_0x5cca0c,_0x5e8092)[_0x2e4f1(0x148)]){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x2e4f1(0x150)]({'function':_0x2e4f1(0x1ae),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1cef44['on']('place-order',(_0x2c2083,_0x8dbf4c)=>{const _0x31762f=_0x453ead;if(validateAccess(_0x8dbf4c,_0x5e8092)['allow']){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x31762f(0x150)]({'function':_0x31762f(0x1db),'args':_0x2c2083});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x1cef44['on'](_0x453ead(0xfa),_0x174189=>{const _0x532370=_0x453ead;if(validateAccess(_0x174189,_0x5e8092)['allow']){if(pid[_0x35cdb4])pid[_0x35cdb4][_0x532370(0x150)]({'function':_0x532370(0x1c9),'args':null});}else logging(_0x532370(0x1a3));}),_0x1cef44['on'](_0x453ead(0x122),_0x59218d=>{const _0x16d437=_0x453ead;if(validateAccess(_0x59218d,_0x5e8092)[_0x16d437(0x148)]){if(devices[_0x5e8092]['pidRefreshToken'])clearTimeout(devices[_0x5e8092][_0x16d437(0x101)]);if(devices[_0x5e8092][_0x16d437(0x124)])clearTimeout(devices[_0x5e8092][_0x16d437(0x124)]);removeSocketListeners(getClient(_0x1cef44['id'])[_0x16d437(0xfb)]),addBlacklist(_0x5e8092),devices[_0x5e8092]['telegramIpApproval']=null,devices[_0x5e8092][_0x16d437(0x1a9)]=null,devices[_0x5e8092]['access'][_0x16d437(0x1e0)]=null,io['to'](getClient(_0x1cef44['id'])[_0x16d437(0xfb)])[_0x16d437(0x147)](_0x16d437(0xf9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x16d437(0x132));});}function removeSocketListeners(_0x523f6e){const _0x16f5f9=_0x40367a;getClientsWithUuid(_0x523f6e)[_0x16f5f9(0x201)](_0x2abd13=>{const _0x1db224=_0x16f5f9;getSocket(_0x2abd13['id'])[_0x1db224(0x112)]();});}function cleanSettings(){const _0x10319e=_0x40367a;let _0x32f484=settings;return settings[_0x10319e(0x116)]&&settings[_0x10319e(0x116)]!=''&&(_0x32f484={..._0x32f484,'telegramToken':'************'}),settings[_0x10319e(0x175)]&&settings[_0x10319e(0x175)]!=''&&(_0x32f484={..._0x32f484,'bbPassword':_0x10319e(0x162)}),_0x32f484;}function updateBB(){const _0x422451=_0x40367a;process[_0x422451(0x150)]({'update':!![]});}function startBot(_0x49ec6e,_0x42e004,_0x3852e8){const _0x2998dd=_0x40367a;let _0x58c9ae=![];const _0x3aea52=_0x49ec6e[0x0];_0x42e004={..._0x42e004,'stdio':[_0x2998dd(0x1ad),_0x2998dd(0x1ad),_0x2998dd(0x1ad),_0x2998dd(0x1c6)]},pid[_0x3aea52]=childProcess['fork'](botfile,_0x49ec6e,_0x42e004),pid[_0x3aea52]['on'](_0x2998dd(0xee),_0x172799=>{const _0x4f8f0c=_0x2998dd;switch(Object[_0x4f8f0c(0xf7)](_0x172799)[0x0]){case _0x4f8f0c(0x188):updateBotName(_0x3aea52,_0x172799[_0x4f8f0c(0x188)]);break;case'status':updateStatus(_0x3aea52,_0x172799['status']);break;case _0x4f8f0c(0x140):updateLive(_0x3aea52,_0x172799[_0x4f8f0c(0x140)]);break;case _0x4f8f0c(0x128):updateLive(_0x3aea52,_0x172799['started']),io['to'](_0x3aea52)[_0x4f8f0c(0x147)](_0x4f8f0c(0xf9),{'access':{'allow':![],'reason':_0x4f8f0c(0x111),'token':null}});break;case'stop':_0x172799[_0x4f8f0c(0x196)]=='restart'&&stopBot(_0x3aea52);_0x172799[_0x4f8f0c(0x196)]==_0x4f8f0c(0x1d6)&&toggleBot(_0x3aea52,_0x4f8f0c(0xf0),_0x4f8f0c(0x14a));break;case'telegram':sendTelegram(_0x3aea52,_0x172799[_0x4f8f0c(0x20b)]);break;case _0x4f8f0c(0x156):io['to'](_0x3aea52)[_0x4f8f0c(0x147)](_0x172799[_0x4f8f0c(0x156)],_0x172799[_0x4f8f0c(0x183)]);break;}}),pid[_0x3aea52]['on']('error',function(_0xb1d1d6){if(_0x58c9ae)return;_0x58c9ae=!![],_0x3852e8(_0xb1d1d6);}),pid[_0x3aea52]['on'](_0x2998dd(0x192),function(_0x1a5a90){const _0x1e1b3f=_0x2998dd;if(_0x58c9ae)return;_0x58c9ae=!![],_0x3852e8(null);const _0x75df01=dbConfig[_0x1e1b3f(0x10c)](_0x1e1b3f(0x22d))[_0x1e1b3f(0x17f)]({'botID':_0x3aea52})['value']();_0x75df01&&(_0x75df01[_0x1e1b3f(0xf9)]==_0x1e1b3f(0x1a2)||_0x75df01[_0x1e1b3f(0xf9)]==_0x1e1b3f(0x169))&&(updateLive(_0x3aea52,_0x1e1b3f(0x14a)),logging(_0x1e1b3f(0x15b)+_0x3aea52),startBot([_0x3aea52,userID],{'cwd':bbpath},function(_0x45c9f8){if(_0x45c9f8)logging(_0x45c9f8);}));});}function stopBot(_0x53ebf8){const _0x4a3b60=_0x40367a;getClientsWithBotID(_0x53ebf8)[_0x4a3b60(0x201)](_0x2610df=>{getSocket(_0x2610df['id'])['disconnect'](!![]),removeClient(_0x2610df['id']);});if(pid[_0x53ebf8])pid[_0x53ebf8][_0x4a3b60(0x1d6)]();}function addBot(){const _0x1aa3f4=_0x40367a;let _0x7d76db;for(let _0x577e43=0x1;_0x577e43<0x3e9;_0x577e43++){_0x7d76db=_0x577e43[_0x1aa3f4(0x161)]()[_0x1aa3f4(0x1bd)](0x3,'0');let _0x1b6b2b=config['find'](_0xbcac19=>_0xbcac19[_0x1aa3f4(0x1f2)]==_0x7d76db);if(!_0x1b6b2b)break;}if(_0x7d76db===_0x1aa3f4(0x180)){logging(_0x1aa3f4(0x118));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x7d76db),dbConfig['get'](_0x1aa3f4(0x22d))[_0x1aa3f4(0x17e)]({'botID':_0x7d76db,'botname':_0x1aa3f4(0x146)+_0x7d76db,'status':_0x1aa3f4(0x169),'live':''})[_0x1aa3f4(0x223)](),startBot([_0x7d76db,userID],{'cwd':bbpath},function(_0x38f61b){if(_0x38f61b)logging(_0x38f61b);}),config=getConfiguration(),io['to'](_0x1aa3f4(0x1b3))['emit'](_0x1aa3f4(0x22d),config);}function deleteBot(_0x3199c1){const _0x46815a=_0x40367a;getClientsWithBotID(_0x3199c1)[_0x46815a(0x201)](_0x486c23=>{const _0x4491ea=_0x46815a;getSocket(_0x486c23['id'])[_0x4491ea(0x1ba)](!![]),removeClient(_0x486c23['id']);}),dbConfig[_0x46815a(0x10c)](_0x46815a(0x22d))[_0x46815a(0x1ca)]({'botID':_0x3199c1})['write'](),logging(_0x46815a(0x1a4)+_0x3199c1),stopBot(_0x3199c1);try{fs[_0x46815a(0x163)](path[_0x46815a(0x165)](configpath,_0x46815a(0x131)+_0x3199c1+'-config.json')),fs[_0x46815a(0x163)](path[_0x46815a(0x165)](configpath,_0x46815a(0x131)+_0x3199c1+'-events.json')),fs[_0x46815a(0x163)](path[_0x46815a(0x165)](configpath,'bot-'+_0x3199c1+_0x46815a(0x1e8))),fs[_0x46815a(0x163)](path['join'](configpath,'bot-'+_0x3199c1+'-results.json'));}catch(_0x1fc612){if(_0x1fc612)logging(_0x46815a(0x1ec),_0x1fc612);}config=getConfiguration(),io['to'](_0x46815a(0x1b3))[_0x46815a(0x147)](_0x46815a(0x22d),config);}function toggleBot(_0x220c98,_0xd255b9,_0x2bdadb){const _0x1e0b4e=_0x40367a;dbConfig[_0x1e0b4e(0x10c)](_0x1e0b4e(0x22d))[_0x1e0b4e(0x17f)]({'botID':_0x220c98})['assign']({'status':_0xd255b9})[_0x1e0b4e(0x182)]({'live':_0x2bdadb})[_0x1e0b4e(0x223)]();if(_0xd255b9==_0x1e0b4e(0x1a2)||_0xd255b9==_0x1e0b4e(0x169))logging(_0x1e0b4e(0x1e4)+_0x220c98),startBot([_0x220c98,userID],{'cwd':bbpath},function(_0x472ecb){if(_0x472ecb)logging(_0x472ecb);});else(_0xd255b9==_0x1e0b4e(0xf0)||_0xd255b9==_0x1e0b4e(0x220))&&(logging(_0x1e0b4e(0xf3)+_0x220c98),stopBot(_0x220c98));config=getConfiguration(),io['to']('botmanager')[_0x1e0b4e(0x147)](_0x1e0b4e(0x22d),config);}function toggleStatus(_0x54f960){const _0x1a0938=_0x40367a;let _0x1a9c79=dbConfig[_0x1a0938(0x10c)](_0x1a0938(0x22d))[_0x1a0938(0x17f)]({'botID':_0x54f960})[_0x1a0938(0xff)](),_0x5f939e;if(_0x1a9c79[_0x1a0938(0xf9)]===_0x1a0938(0x1a2))_0x5f939e=_0x1a0938(0xf0);else{if(_0x1a9c79[_0x1a0938(0xf9)]==='new')_0x5f939e='new-disabled';else{if(_0x1a9c79[_0x1a0938(0xf9)]===_0x1a0938(0x220))_0x5f939e='new';else{if(_0x1a9c79[_0x1a0938(0xf9)]===_0x1a0938(0xf0))_0x5f939e=_0x1a0938(0x1a2);}}}return _0x5f939e;}function updateStatus(_0x3bf0f6,_0x476b61){const _0x580b22=_0x40367a;dbConfig[_0x580b22(0x10c)](_0x580b22(0x22d))[_0x580b22(0x17f)]({'botID':_0x3bf0f6})[_0x580b22(0x182)]({'status':_0x476b61})[_0x580b22(0x223)](),config=getConfiguration(),io['to'](_0x580b22(0x1b3))[_0x580b22(0x147)](_0x580b22(0x22d),config);}function updateLive(_0x1542d2,_0x5822d1){const _0x411c14=_0x40367a;dbConfig[_0x411c14(0x10c)](_0x411c14(0x22d))['find']({'botID':_0x1542d2})[_0x411c14(0x182)]({'live':_0x5822d1})[_0x411c14(0x223)](),config=getConfiguration(),io['to'](_0x411c14(0x1b3))[_0x411c14(0x147)]('bots',config);}function updateBotName(_0x3d0e64,_0x5ebf4d){const _0x114622=_0x40367a;dbConfig[_0x114622(0x10c)](_0x114622(0x22d))['find']({'botID':_0x3d0e64})[_0x114622(0x182)]({'botname':_0x5ebf4d})[_0x114622(0x223)](),config=getConfiguration(),io['to'](_0x114622(0x1b3))[_0x114622(0x147)](_0x114622(0x22d),config);}function telegramError(_0x2a7114){const _0xdd9d17=_0x40367a;console['log'](getTimeStamp()+_0xdd9d17(0x1f3));}function validateTelegram(_0x35e71a){const _0x587224=_0x40367a;if(_0x35e71a[_0x587224(0x170)][_0x587224(0x18e)]!=settings[_0x587224(0x135)]&&'@'+_0x35e71a[_0x587224(0x170)][_0x587224(0x18e)]!=settings[_0x587224(0x135)])return tgBot[_0x587224(0x1c4)](_0x35e71a[_0x587224(0x1f7)]['id'],_0x587224(0x21a),{'parse_mode':'HTML'})[_0x587224(0x138)](_0x52cef3=>{telegramError(_0x52cef3);}),![];return!![];}async function initTelegram(){const _0x17f1a8=_0x40367a;if(tgBot)tgBot[_0x17f1a8(0x104)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x17f1a8(0x116)],{'polling':!![]});let _0x3664e8=_0x17f1a8(0x1c7);_0x3664e8+='\x0a',_0x3664e8+=_0x17f1a8(0x185),_0x3664e8+=_0x17f1a8(0xed),_0x3664e8+=_0x17f1a8(0x20c),_0x3664e8+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3664e8+=_0x17f1a8(0x204),_0x3664e8+=_0x17f1a8(0x167),_0x3664e8+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x3664e8+=_0x17f1a8(0x1dc);let _0x23e650=_0x17f1a8(0x21d);_0x23e650+='\x0a',_0x23e650+=_0x3664e8,tgBot[_0x17f1a8(0x1b6)](/\/start/,_0x241d94=>{const _0x3d5788=_0x17f1a8;if(!validateTelegram(_0x241d94))return;if(settings[_0x3d5788(0x22e)]!=_0x241d94['chat']['id'])updateSetting(_0x3d5788(0x22e),_0x241d94[_0x3d5788(0x1f7)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x3d5788(0x1c4)](_0x241d94[_0x3d5788(0x1f7)]['id'],_0x23e650)['catch'](_0x3cfa7c=>{telegramError(_0x3cfa7c);});}),tgBot['onText'](/\/enable/,_0x42a4b7=>{const _0x213f2c=_0x17f1a8;if(!validateTelegram(_0x42a4b7))return;if(settings[_0x213f2c(0x22e)]!=_0x42a4b7['chat']['id'])updateSetting(_0x213f2c(0x22e),_0x42a4b7[_0x213f2c(0x1f7)]['id']);updateSetting(_0x213f2c(0x1a0),!![]),tgBot[_0x213f2c(0x1c4)](_0x42a4b7[_0x213f2c(0x1f7)]['id'],_0x213f2c(0x142))[_0x213f2c(0x138)](_0x4ead29=>{telegramError(_0x4ead29);});}),tgBot[_0x17f1a8(0x1b6)](/\/config/,async _0x2ac089=>{const _0x5930ed=_0x17f1a8;if(!validateTelegram(_0x2ac089))return;tgBot[_0x5930ed(0x20d)](_0x5930ed(0x215)),tgBot[_0x5930ed(0x1c4)](_0x2ac089[_0x5930ed(0x1f7)]['id'],_0x5930ed(0x11b),{'reply_markup':{'inline_keyboard':[[{'text':_0x5930ed(0x13c),'callback_data':_0x5930ed(0x123)},{'text':_0x5930ed(0x1c8),'callback_data':_0x5930ed(0x159)},{'text':'All','callback_data':'all'}]]}})[_0x5930ed(0x138)](_0x1055d5=>{telegramError(_0x1055d5);}),tgBot['on']('callback_query',async _0x1e0abb=>{const _0x281f81=_0x5930ed,_0x44d232=_0x1e0abb[_0x281f81(0x1a7)],_0x3fef24=_0x1e0abb[_0x281f81(0xee)];tgBot[_0x281f81(0x12d)](_0x1e0abb['id'])[_0x281f81(0x179)](async()=>{const _0x4c7036=_0x281f81;_0x44d232==_0x4c7036(0x123)&&(updateSetting(_0x4c7036(0xf2),'orders'),updateSetting(_0x4c7036(0x1a0),!![]),await tgBot['sendMessage'](_0x3fef24[_0x4c7036(0x1f7)]['id'],_0x4c7036(0x1f0))[_0x4c7036(0x138)](_0x300afb=>{telegramError(_0x300afb);}));_0x44d232==_0x4c7036(0x159)&&(updateSetting(_0x4c7036(0xf2),_0x4c7036(0x159)),updateSetting(_0x4c7036(0x1a0),!![]),await tgBot[_0x4c7036(0x1c4)](_0x3fef24['chat']['id'],_0x4c7036(0x22c))[_0x4c7036(0x138)](_0x8f78b8=>{telegramError(_0x8f78b8);}));_0x44d232=='all'&&(updateSetting(_0x4c7036(0xf2),_0x4c7036(0x1b9)),updateSetting(_0x4c7036(0x1a0),!![]),await tgBot[_0x4c7036(0x1c4)](_0x3fef24['chat']['id'],_0x4c7036(0x1da))[_0x4c7036(0x138)](_0x323abc=>{telegramError(_0x323abc);}));if(!settings['telegramChatId'])tgBot[_0x4c7036(0x1c4)](_0x3fef24[_0x4c7036(0x1f7)]['id'],_0x4c7036(0x1a6))[_0x4c7036(0x138)](_0x1cbb80=>{telegramError(_0x1cbb80);});}),tgBot[_0x281f81(0x20d)](_0x281f81(0x215));});}),tgBot[_0x17f1a8(0x1b6)](/\/status/,_0x5d5f2a=>{const _0x2e0b4e=_0x17f1a8;if(!validateTelegram(_0x5d5f2a))return;let _0x289bba=_0x2e0b4e(0xfe);config[_0x2e0b4e(0x201)](_0x10a9c9=>{const _0x57c412=_0x2e0b4e;_0x289bba+=_0x57c412(0x146)+_0x10a9c9[_0x57c412(0x1f2)]+_0x57c412(0x19f)+_0x10a9c9[_0x57c412(0x188)]+':\x20'+_0x10a9c9[_0x57c412(0xf9)]+_0x57c412(0x1e6)+_0x10a9c9[_0x57c412(0x140)]+'\x0a';}),_0x289bba+='\x0a',_0x289bba+=_0x2e0b4e(0x18b),_0x289bba+=!settings[_0x2e0b4e(0x1a0)]?_0x2e0b4e(0x224):'Notifications\x20enabled\x0a',_0x289bba+=settings[_0x2e0b4e(0x1a0)]?settings[_0x2e0b4e(0xf2)]==_0x2e0b4e(0x1b9)?_0x2e0b4e(0x107):'Notifications\x20types:\x20'+settings[_0x2e0b4e(0xf2)]+_0x2e0b4e(0x11a):'',tgBot['sendMessage'](_0x5d5f2a[_0x2e0b4e(0x1f7)]['id'],_0x289bba,{'parse_mode':'HTML'})[_0x2e0b4e(0x138)](_0x24101b=>{telegramError(_0x24101b);});}),tgBot['onText'](/\/restart/,_0x4d955d=>{const _0x4aa17d=_0x17f1a8;if(!validateTelegram(_0x4d955d))return;tgBot[_0x4aa17d(0x20d)]('callback_query');const _0x106787=getEnabledBots();if(_0x106787[_0x4aa17d(0x21f)]==0x0)tgBot[_0x4aa17d(0x1c4)](_0x4d955d['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x4aa17d(0x138)](_0x1039ec=>{telegramError(_0x1039ec);});else{if(_0x106787['length']>0x1)_0x106787[_0x4aa17d(0x17e)]({'botID':_0x4aa17d(0x1b9)});let _0x4b6d4d=[],_0x49eff9=[];const _0x33c836=_0x106787[_0x4aa17d(0x21f)]%0x4==0x0||_0x106787[_0x4aa17d(0x21f)]%0x4==0x3||_0x106787[_0x4aa17d(0x21f)]%0x3==0x1?0x4:0x3;let _0x1d02e3=0x0;_0x106787[_0x4aa17d(0x201)]((_0x148cad,_0x115a11)=>{const _0x55a959=_0x4aa17d;if(_0x115a11%_0x33c836==0x0)_0x49eff9=[];_0x49eff9['push']({'text':_0x148cad[_0x55a959(0x1f2)]==_0x55a959(0x1b9)?_0x55a959(0x1ef):'Bot\x20'+_0x148cad[_0x55a959(0x1f2)],'callback_data':_0x148cad[_0x55a959(0x1f2)]}),_0x115a11%_0x33c836==0x0&&(_0x4b6d4d[_0x1d02e3]=_0x49eff9,_0x1d02e3++);}),tgBot['sendMessage'](_0x4d955d[_0x4aa17d(0x1f7)]['id'],_0x4aa17d(0x15d),{'reply_markup':{'inline_keyboard':_0x4b6d4d}})[_0x4aa17d(0x138)](_0x2cd697=>{telegramError(_0x2cd697);}),tgBot['on']('callback_query',async _0x2c0e8=>{const _0x5ae73e=_0x4aa17d,_0x65d7b5=_0x2c0e8['data'],_0x188850=_0x2c0e8[_0x5ae73e(0xee)];tgBot[_0x5ae73e(0x12d)](_0x2c0e8['id'])[_0x5ae73e(0x179)](async()=>{const _0x358f26=_0x5ae73e;if(_0x65d7b5==_0x358f26(0x1b9)){if(settings[_0x358f26(0xf2)]==_0x358f26(0x123))tgBot['sendMessage'](_0x188850[_0x358f26(0x1f7)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')[_0x358f26(0x138)](_0xcbb934=>{telegramError(_0xcbb934);});config[_0x358f26(0x201)](_0x4915b7=>{const _0x2caf56=_0x358f26;stopBot(_0x4915b7[_0x2caf56(0x1f2)]);});}else{if(settings[_0x358f26(0xf2)]=='orders')tgBot[_0x358f26(0x1c4)](_0x188850[_0x358f26(0x1f7)]['id'],_0x358f26(0x1fd)+_0x65d7b5)[_0x358f26(0x138)](_0x46dca4=>{telegramError(_0x46dca4);});stopBot(_0x65d7b5);}}),tgBot['removeListener'](_0x5ae73e(0x215));});}}),tgBot[_0x17f1a8(0x1b6)](/\/on/,_0x465e55=>{const _0x6f4063=_0x17f1a8;if(!validateTelegram(_0x465e55))return;tgBot[_0x6f4063(0x20d)](_0x6f4063(0x215));const _0x14bfca=getDisabledBots();if(_0x14bfca[_0x6f4063(0x21f)]==0x0)tgBot[_0x6f4063(0x1c4)](_0x465e55[_0x6f4063(0x1f7)]['id'],_0x6f4063(0x1ff))['catch'](_0x355573=>{telegramError(_0x355573);});else{if(_0x14bfca[_0x6f4063(0x21f)]>0x1)_0x14bfca['push']({'botID':_0x6f4063(0x1b9)});let _0x59f6c7=[],_0x1e026d=[];const _0x3fcf6d=_0x14bfca[_0x6f4063(0x21f)]%0x4==0x0||_0x14bfca[_0x6f4063(0x21f)]%0x4==0x3||_0x14bfca['length']%0x3==0x1?0x4:0x3;let _0x9078af=0x0;_0x14bfca[_0x6f4063(0x201)]((_0xc779c1,_0xa3269e)=>{const _0x5321ec=_0x6f4063;if(_0xa3269e%_0x3fcf6d==0x0)_0x1e026d=[];_0x1e026d[_0x5321ec(0x17e)]({'text':_0xc779c1[_0x5321ec(0x1f2)]==_0x5321ec(0x1b9)?_0x5321ec(0x1ef):'Bot\x20'+_0xc779c1[_0x5321ec(0x1f2)],'callback_data':_0xc779c1[_0x5321ec(0x1f2)]}),_0xa3269e%_0x3fcf6d==0x0&&(_0x59f6c7[_0x9078af]=_0x1e026d,_0x9078af++);}),tgBot[_0x6f4063(0x1c4)](_0x465e55[_0x6f4063(0x1f7)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x59f6c7}})[_0x6f4063(0x138)](_0x3db900=>{telegramError(_0x3db900);}),tgBot['on'](_0x6f4063(0x215),async _0x4c808a=>{const _0x15cabc=_0x6f4063,_0x34d5fd=_0x4c808a['data'],_0x31ba97=_0x4c808a[_0x15cabc(0xee)];tgBot[_0x15cabc(0x12d)](_0x4c808a['id'])['then'](async()=>{const _0x32506c=_0x15cabc;if(_0x34d5fd==_0x32506c(0x1b9)){if(settings[_0x32506c(0xf2)]=='orders')tgBot[_0x32506c(0x1c4)](_0x31ba97[_0x32506c(0x1f7)]['id'],_0x32506c(0xf1))[_0x32506c(0x138)](_0x56ed49=>{telegramError(_0x56ed49);});_0x14bfca[_0x32506c(0x201)](_0x16c95d=>{const _0x4512bb=_0x32506c;if(_0x16c95d['botID']!=_0x4512bb(0x1b9))toggleBot(_0x16c95d[_0x4512bb(0x1f2)],toggleStatus(_0x16c95d[_0x4512bb(0x1f2)]),'stopped');});}else{if(settings['telegramEvents']=='orders')tgBot[_0x32506c(0x1c4)](_0x31ba97[_0x32506c(0x1f7)]['id'],_0x32506c(0x18d)+_0x34d5fd)[_0x32506c(0x138)](_0x4263c2=>{telegramError(_0x4263c2);});toggleBot(_0x34d5fd,toggleStatus(_0x34d5fd),_0x32506c(0x14a));}}),tgBot[_0x15cabc(0x20d)](_0x15cabc(0x215));});}}),tgBot[_0x17f1a8(0x1b6)](/\/off/,_0x402c88=>{const _0x3f8358=_0x17f1a8;if(!validateTelegram(_0x402c88))return;tgBot[_0x3f8358(0x20d)](_0x3f8358(0x215));const _0x12f94f=getEnabledBots();if(_0x12f94f[_0x3f8358(0x21f)]==0x0)tgBot[_0x3f8358(0x1c4)](_0x402c88[_0x3f8358(0x1f7)]['id'],_0x3f8358(0x14d))[_0x3f8358(0x138)](_0x5c5241=>{telegramError(_0x5c5241);});else{if(_0x12f94f[_0x3f8358(0x21f)]>0x1)_0x12f94f[_0x3f8358(0x17e)]({'botID':_0x3f8358(0x1b9)});let _0x27b753=[],_0x24a6e4=[];const _0x126135=_0x12f94f[_0x3f8358(0x21f)]%0x4==0x0||_0x12f94f['length']%0x4==0x3||_0x12f94f[_0x3f8358(0x21f)]%0x3==0x1?0x4:0x3;let _0x248cd0=0x0;_0x12f94f[_0x3f8358(0x201)]((_0x3ca02b,_0x236445)=>{const _0x2c411c=_0x3f8358;if(_0x236445%_0x126135==0x0)_0x24a6e4=[];_0x24a6e4[_0x2c411c(0x17e)]({'text':_0x3ca02b[_0x2c411c(0x1f2)]==_0x2c411c(0x1b9)?_0x2c411c(0x1ef):_0x2c411c(0x146)+_0x3ca02b['botID'],'callback_data':_0x3ca02b[_0x2c411c(0x1f2)]}),_0x236445%_0x126135==0x0&&(_0x27b753[_0x248cd0]=_0x24a6e4,_0x248cd0++);}),tgBot[_0x3f8358(0x1c4)](_0x402c88[_0x3f8358(0x1f7)]['id'],_0x3f8358(0x143),{'reply_markup':{'inline_keyboard':_0x27b753}})[_0x3f8358(0x138)](_0x232e0a=>{telegramError(_0x232e0a);}),tgBot['on']('callback_query',async _0x488593=>{const _0x5d89f8=_0x3f8358,_0x46b96d=_0x488593[_0x5d89f8(0x1a7)],_0x4be162=_0x488593[_0x5d89f8(0xee)];tgBot[_0x5d89f8(0x12d)](_0x488593['id'])[_0x5d89f8(0x179)](async()=>{const _0x58d93f=_0x5d89f8;if(_0x46b96d=='all'){if(settings[_0x58d93f(0xf2)]==_0x58d93f(0x123))tgBot[_0x58d93f(0x1c4)](_0x4be162['chat']['id'],_0x58d93f(0x1f8))[_0x58d93f(0x138)](_0x273dc7=>{telegramError(_0x273dc7);});_0x12f94f['forEach'](_0x52ce50=>{const _0x1fd3c2=_0x58d93f;if(_0x52ce50[_0x1fd3c2(0x1f2)]!=_0x1fd3c2(0x1b9))toggleBot(_0x52ce50['botID'],toggleStatus(_0x52ce50['botID']),_0x1fd3c2(0x14a));});}else{if(settings['telegramEvents']==_0x58d93f(0x123))tgBot['sendMessage'](_0x4be162['chat']['id'],_0x58d93f(0x100)+_0x46b96d)[_0x58d93f(0x138)](_0x5546c5=>{telegramError(_0x5546c5);});toggleBot(_0x46b96d,toggleStatus(_0x46b96d),_0x58d93f(0x14a));}}),tgBot[_0x5d89f8(0x20d)](_0x5d89f8(0x215));});}}),tgBot[_0x17f1a8(0x1b6)](/\/disable/,_0x3af45e=>{const _0x1e8dce=_0x17f1a8;if(!validateTelegram(_0x3af45e))return;tgBot[_0x1e8dce(0x1c4)](_0x3af45e[_0x1e8dce(0x1f7)]['id'],_0x1e8dce(0x1d1))[_0x1e8dce(0x138)](_0x2f36d0=>{telegramError(_0x2f36d0);}),updateSetting(_0x1e8dce(0x1a0),![]);}),tgBot[_0x17f1a8(0x1b6)](/\/help/,_0x1a635b=>{const _0x1938fb=_0x17f1a8;if(!validateTelegram(_0x1a635b))return;tgBot['sendMessage'](_0x1a635b['chat']['id'],_0x3664e8)[_0x1938fb(0x138)](_0x4875db=>{telegramError(_0x4875db);});}),tgBot['on']('polling_error',_0x4c4fa8=>{const _0x3ffdfb=_0x17f1a8;_0x4c4fa8[_0x3ffdfb(0x161)]()[_0x3ffdfb(0x171)]('404\x20Not\x20Found')&&(logging(_0x3ffdfb(0x12e)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x3ffdfb(0x1b3))[_0x3ffdfb(0x147)](_0x3ffdfb(0x218),'Invalid\x20Telegram\x20token'));}),process['once'](_0x17f1a8(0x141),()=>{const _0x333c08=_0x17f1a8;if(tgBot)tgBot[_0x333c08(0x104)]();process[_0x333c08(0x192)](0x1);}),process[_0x17f1a8(0x216)](_0x17f1a8(0x130),()=>{const _0x3cfb44=_0x17f1a8;if(tgBot)tgBot['stopPolling']();process[_0x3cfb44(0x192)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x27395d,_0x56745f){const _0x5c7ba6=_0x40367a;if(settings[_0x5c7ba6(0x1a0)]){if(settings[_0x5c7ba6(0xf2)]==_0x5c7ba6(0x1b9)||(_0x56745f[_0x5c7ba6(0x1e1)]==_0x5c7ba6(0x1fc)||_0x56745f['type']==_0x5c7ba6(0x231))&&settings['telegramEvents']=='alerts'||_0x56745f[_0x5c7ba6(0x1e1)]==_0x5c7ba6(0x207)&&settings['telegramEvents']==_0x5c7ba6(0x123)){if(tgBot&&settings[_0x5c7ba6(0x22e)]){if(_0x56745f[_0x5c7ba6(0x1d8)])tgBot[_0x5c7ba6(0x1c4)](settings[_0x5c7ba6(0x22e)],_0x56745f[_0x5c7ba6(0x188)]+'\x20>\x20'+_0x56745f['event'])[_0x5c7ba6(0x138)](_0x109281=>{telegramError(_0x109281);});else tgBot[_0x5c7ba6(0x1c4)](settings['telegramChatId'],_0x5c7ba6(0x146)+_0x27395d+_0x5c7ba6(0xf6)+_0x56745f[_0x5c7ba6(0x1b0)])[_0x5c7ba6(0x138)](_0x499044=>{telegramError(_0x499044);});}}}}function getDeviceWithIp(_0x4932a8){return devices['find'](_0xd622b9=>_0xd622b9['ip']===_0x4932a8);}function temporaryAccess2FA(_0x30a0fe,_0x337b0b){const _0x305b6d=_0x40367a;let _0x4c2e7f=new Date(),_0x36ffcc=![];if(lastIpApproval){if(_0x4c2e7f-lastIpApproval<0x1388)_0x36ffcc=!![];}lastIpApproval=new Date();if(_0x36ffcc)return;tgBot&&settings[_0x305b6d(0x22e)]&&(tgBot[_0x305b6d(0x20d)](_0x305b6d(0x215)),tgBot[_0x305b6d(0x1c4)](settings[_0x305b6d(0x22e)],_0x305b6d(0x208)+normalizeIP(_0x337b0b)[_0x305b6d(0xfd)]+_0x305b6d(0x1ed),{'parse_mode':_0x305b6d(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x305b6d(0x213),'callback_data':'5'},{'text':_0x305b6d(0x16a),'callback_data':'15'},{'text':_0x305b6d(0x164),'callback_data':'30'},{'text':_0x305b6d(0xf5),'callback_data':_0x305b6d(0xf5)}]]}})[_0x305b6d(0x138)](_0x3a99f3=>{telegramError(_0x3a99f3);}),tgBot['on'](_0x305b6d(0x215),async _0x23ca6b=>{const _0x595be7=_0x305b6d,_0x58538f=_0x23ca6b[_0x595be7(0x1a7)],_0xff3bed=_0x23ca6b[_0x595be7(0xee)];tgBot[_0x595be7(0x12d)](_0x23ca6b['id'])[_0x595be7(0x179)](async()=>{const _0x501f96=_0x595be7;devices[_0x30a0fe]['telegramIpApproval']={'clientip':_0x337b0b,'timestamp':new Date()['getTime'](),'expiry':_0x58538f},_0x58538f!=_0x501f96(0xf5)?(await tgBot[_0x501f96(0x1c4)](_0xff3bed[_0x501f96(0x1f7)]['id'],_0x501f96(0x158)+_0x58538f+_0x501f96(0x119),{'parse_mode':_0x501f96(0x1f4)})[_0x501f96(0x138)](_0x3bab78=>{telegramError(_0x3bab78);}),io['to'](_0x30a0fe)[_0x501f96(0x147)](_0x501f96(0xf9),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x501f96(0x1c4)](_0xff3bed[_0x501f96(0x1f7)]['id'],_0x501f96(0x12f))['catch'](_0x422b97=>{telegramError(_0x422b97);}),io['to'](_0x30a0fe)[_0x501f96(0x147)](_0x501f96(0xf9),{'access':{'allow':![],'reason':_0x501f96(0x172),'token':null}}));}),tgBot[_0x595be7(0x20d)](_0x595be7(0x215));}));}function loginAccess2FA(_0x2a0db9,_0x25552e){const _0x13edb8=_0x40367a;tgBot&&settings[_0x13edb8(0x22e)]&&(tgBot[_0x13edb8(0x20d)]('callback_query'),tgBot[_0x13edb8(0x1c4)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x25552e)[_0x13edb8(0xfd)]+'</b>\x20?',{'parse_mode':_0x13edb8(0x1f4),'reply_markup':{'inline_keyboard':[[{'text':_0x13edb8(0x16b),'callback_data':loginExpiry},{'text':_0x13edb8(0xf5),'callback_data':_0x13edb8(0xf5)}]]}})[_0x13edb8(0x138)](_0x41f7c7=>{telegramError(_0x41f7c7);}),tgBot['on'](_0x13edb8(0x215),async _0x5d1557=>{const _0x2746ee=_0x13edb8,_0x1fc3f7=_0x5d1557[_0x2746ee(0x1a7)],_0x115eef=_0x5d1557[_0x2746ee(0xee)];tgBot[_0x2746ee(0x12d)](_0x5d1557['id'])['then'](async()=>{const _0x3bbb59=_0x2746ee;devices[_0x2a0db9][_0x3bbb59(0x1a9)]={'clientip':_0x25552e,'timestamp':new Date()[_0x3bbb59(0x22f)](),'expiry':_0x1fc3f7},_0x1fc3f7!=_0x3bbb59(0xf5)?(await tgBot[_0x3bbb59(0x1c4)](_0x115eef[_0x3bbb59(0x1f7)]['id'],_0x3bbb59(0x22a),{'parse_mode':_0x3bbb59(0x1f4)})[_0x3bbb59(0x138)](_0x7bfa09=>{telegramError(_0x7bfa09);}),io['to'](_0x2a0db9)[_0x3bbb59(0x147)](_0x3bbb59(0xf9),{'access':{'allow':![],'reason':_0x3bbb59(0x111),'token':null}})):(await tgBot['sendMessage'](_0x115eef['chat']['id'],'Login\x20rejected')['catch'](_0x5c1c1c=>{telegramError(_0x5c1c1c);}),io['to'](_0x2a0db9)[_0x3bbb59(0x147)](_0x3bbb59(0xf9),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x2746ee(0x20d)](_0x2746ee(0x215));}));}function getConfiguration(){const _0x206e9d=_0x40367a;return dbConfig[_0x206e9d(0x10c)]('bots')['sortBy'](_0x206e9d(0x1f2))[_0x206e9d(0xff)]()||[];}function getEnabledBots(){const _0x185d76=_0x40367a;return dbConfig[_0x185d76(0x10c)](_0x185d76(0x22d))[_0x185d76(0x13b)]('botID')[_0x185d76(0x199)]({'status':'enabled'})[_0x185d76(0xff)]()||[];}function getDisabledBots(){const _0xf664a8=_0x40367a;return dbConfig[_0xf664a8(0x10c)]('bots')[_0xf664a8(0x13b)](_0xf664a8(0x1f2))[_0xf664a8(0x199)]({'status':_0xf664a8(0xf0)})[_0xf664a8(0xff)]()||[];}function getSettings(){const _0x2bdc17=_0x40367a;return dbSettings['get'](_0x2bdc17(0x102))[_0x2bdc17(0xff)]()||{'timeshift':0x0};}function getSecure(){const _0x2a7579=_0x40367a;return dbSecure['get'](_0x2a7579(0x1b1))[_0x2a7579(0xff)]()||{};}function getBlacklist(){const _0x128708=_0x40367a;return dbSecure['get'](_0x128708(0x1b7))[_0x128708(0xff)]()||[];}function broadcastToBots(_0x3adca6,_0x53cb44){config['forEach'](_0x412a2e=>{const _0x1220fc=_0x1c13;if(_0x412a2e['status']=='enabled'&&_0x412a2e[_0x1220fc(0x140)]==_0x1220fc(0x198)){if(pid[_0x412a2e[_0x1220fc(0x1f2)]])pid[_0x412a2e['botID']][_0x1220fc(0x150)]({[_0x3adca6]:_0x53cb44});}});}function storeSettings(_0x3e5495,_0x1664af=![]){const _0x18bad1=_0x40367a;_0x3e5495={...settings,..._0x3e5495};if(_0x1664af&&_0x3e5495[_0x18bad1(0x175)]!='************'&&_0x3e5495[_0x18bad1(0x175)]!=''){const _0x43f7ec=crypt[_0x18bad1(0x194)](secure[_0x18bad1(0x200)],_0x3e5495[_0x18bad1(0x175)])['message']['split']('@')[0x0],_0x5b87eb=bcrypt[_0x18bad1(0x11c)](_0x43f7ec,saltRounds);_0x3e5495={..._0x3e5495,'bbPassword':_0x5b87eb};}if(_0x1664af&&_0x3e5495[_0x18bad1(0x116)]!=_0x18bad1(0x162)&&_0x3e5495[_0x18bad1(0x116)]!=''){const _0x9db3cf=crypt[_0x18bad1(0x194)](secure[_0x18bad1(0x200)],_0x3e5495[_0x18bad1(0x116)])['message']['split']('@')[0x0];_0x3e5495={..._0x3e5495,'telegramToken':_0x9db3cf};}const _0x5c21cd=_0x3e5495[_0x18bad1(0x116)]!=_0x18bad1(0x162)&&_0x3e5495['telegramToken']!=settings[_0x18bad1(0x116)]||_0x3e5495['telegramUsername']!=settings[_0x18bad1(0x135)],_0x4d844a=_0x3e5495['telegramToken']==''||_0x3e5495[_0x18bad1(0x135)]=='';if(_0x5c21cd)_0x3e5495[_0x18bad1(0xf2)]=_0x18bad1(0x1b9);for(const [_0x38135e,_0x129341]of Object[_0x18bad1(0x18c)](_0x3e5495)){if(_0x38135e==_0x18bad1(0x116)&&_0x129341==_0x18bad1(0x162)){_0x3e5495[_0x18bad1(0x116)]=settings[_0x18bad1(0x116)];continue;};if(_0x38135e==_0x18bad1(0x175)&&_0x129341==_0x18bad1(0x162)){_0x3e5495[_0x18bad1(0x175)]=settings['bbPassword'];continue;};dbSettings['set']('settings.'+_0x38135e,_0x129341)['write']();}settings=_0x3e5495,io['to'](_0x18bad1(0x1b3))[_0x18bad1(0x147)](_0x18bad1(0x102),cleanSettings()),broadcastToBots(_0x18bad1(0x139),settings[_0x18bad1(0x139)]);if(_0x5c21cd&&!_0x4d844a)initTelegram();if(_0x5c21cd&&_0x4d844a)disableTelegram();getAllClients()['forEach'](_0xd70187=>{const _0x323545=_0x18bad1;getSocket(_0xd70187['id'])[_0x323545(0x147)](_0x323545(0xf9),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x417302,_0x1ce572){const _0x415a2e=_0x40367a;dbSettings[_0x415a2e(0x144)]('settings.'+_0x417302,_0x1ce572)[_0x415a2e(0x223)](),settings=getSettings(),io['to']('botmanager')[_0x415a2e(0x147)](_0x415a2e(0x102),cleanSettings());}function storeSecure(_0x10bb38){const _0xfdb851=_0x40367a;dbSecure[_0xfdb851(0x10c)](_0xfdb851(0x1b1))['push'](_0x10bb38)['write'](),secure=_0x10bb38;}function addBlacklist(_0x1f391b){const _0x1eb0e8=_0x40367a;cleanBlacklist();let _0x399faf;devices[_0x1f391b][_0x1eb0e8(0x222)]?_0x399faf=Math['max'](devices[_0x1f391b]['telegramIpApproval']['expiry'],loginExpiry):_0x399faf=loginExpiry,dbSecure[_0x1eb0e8(0x10c)]('blacklist')['push']({'expiry':new Date()[_0x1eb0e8(0x22f)]()+_0x399faf*0x3c*0x3e8,'token':devices[_0x1f391b][_0x1eb0e8(0x18f)][_0x1eb0e8(0x1e0)]})[_0x1eb0e8(0x223)](),blacklist=dbSecure[_0x1eb0e8(0x10c)](_0x1eb0e8(0x1b7))[_0x1eb0e8(0xff)]();}function cleanBlacklist(){const _0x235bf6=_0x40367a;let _0x25eff1=dbSecure[_0x235bf6(0x10c)]('blacklist')[_0x235bf6(0x1a8)]()[_0x235bf6(0xff)](),_0x59dcbb=new Date()[_0x235bf6(0x22f)]();_0x25eff1[_0x235bf6(0x201)](_0x1131a4=>{const _0x502d1e=_0x235bf6;_0x1131a4[_0x502d1e(0x151)]<_0x59dcbb&&dbSecure[_0x502d1e(0x10c)](_0x502d1e(0x1b7))['remove']({'expiry':_0x1131a4[_0x502d1e(0x151)]})[_0x502d1e(0x223)]();});}function initStates(){let _0x239f3b=getConfiguration();_0x239f3b['forEach'](_0xe7e604=>{const _0x331a8c=_0x1c13;_0xe7e604['live']=_0x331a8c(0x14a);}),storeConfiguration(_0x239f3b);}function onKeys(){const _0x49b770=new RSA();return new Promise(_0x2fb7e7=>{_0x49b770['generateKeyPairAsync']()['then'](_0x3642fb=>{_0x2fb7e7(_0x3642fb);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0xd3a879=_0x40367a;let _0x522bef=getConfiguration(),_0x3c803e=![];_0x522bef[_0xd3a879(0x201)](_0x4818ae=>{const _0x576738=_0xd3a879;if(_0x4818ae[_0x576738(0xf9)]=='running')_0x4818ae[_0x576738(0xf9)]='enabled',_0x3c803e=!![];else _0x4818ae[_0x576738(0xf9)]==_0x576738(0x14a)&&(_0x4818ae[_0x576738(0xf9)]=_0x576738(0xf0),_0x3c803e=!![]);});if(_0x3c803e)storeConfiguration(_0x522bef);let _0x41040f=getSecure();if(!_0x41040f[_0xd3a879(0x1cc)](_0xd3a879(0x227))){let _0x5cbe23=await generateKeys();_0x41040f['publicKey']=_0x5cbe23[_0xd3a879(0x1bf)],_0x41040f[_0xd3a879(0x200)]=_0x5cbe23[_0xd3a879(0x200)],_0x41040f[_0xd3a879(0x227)]=crypto[_0xd3a879(0x1b4)](0x20)['toString'](_0xd3a879(0x17c));;storeSecure(_0x41040f);}let _0x3dbc5f=getSettings();_0x3c803e=![];!_0x3dbc5f[_0xd3a879(0x1cc)](_0xd3a879(0x1cb))&&(_0x3dbc5f['loginRequired']=![],_0x3dbc5f[_0xd3a879(0x17a)]='',_0x3dbc5f['bbPassword']='',_0x3dbc5f[_0xd3a879(0x209)]=![],_0x3c803e=!![]);!_0x3dbc5f[_0xd3a879(0x1cc)](_0xd3a879(0x228))&&(_0x3dbc5f['whitelistEnabled']=![],_0x3dbc5f[_0xd3a879(0x191)]=[],_0x3dbc5f[_0xd3a879(0x187)]=![],_0x3c803e=!![]);if(!_0x3dbc5f[_0xd3a879(0x1cc)](_0xd3a879(0x1a0))){if(_0x3dbc5f['telegramChatId'])_0x3dbc5f['telegramEnabled']=!![];else _0x3dbc5f[_0xd3a879(0x1a0)]=![];_0x3c803e=!![];}if(_0x3c803e)storeSettings(_0x3dbc5f);}function storeConfiguration(_0x69bda){const _0x320b44=_0x40367a;dbConfig[_0x320b44(0x10c)](_0x320b44(0x22d))[_0x320b44(0x1ca)]()[_0x320b44(0x223)](),dbConfig['get'](_0x320b44(0x22d))['push'](..._0x69bda)['write'](),config=_0x69bda;}function resetPassword(){const _0x5a6b69=_0x40367a;tgBot&&settings[_0x5a6b69(0x22e)]&&(tgBot[_0x5a6b69(0x20d)](_0x5a6b69(0x215)),tgBot[_0x5a6b69(0x1c4)](settings['telegramChatId'],_0x5a6b69(0x1f5),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x5a6b69(0x138)](_0x40a0eb=>{telegramError(_0x40a0eb);}),tgBot['on'](_0x5a6b69(0x215),async _0x3aae95=>{const _0x33e2ab=_0x5a6b69,_0x33e407=_0x3aae95[_0x33e2ab(0x1a7)],_0x19a994=_0x3aae95[_0x33e2ab(0xee)];tgBot['answerCallbackQuery'](_0x3aae95['id'])[_0x33e2ab(0x179)](async()=>{const _0x20c734=_0x33e2ab;if(_0x33e407!='no'){const _0x9f6a16=0xf,_0x4a7676=_0x20c734(0x1be),_0x1fdf23=Array[_0x20c734(0x170)](crypto[_0x20c734(0x21e)](new Uint32Array(_0x9f6a16)))[_0x20c734(0x109)](_0x233ec8=>_0x4a7676[_0x233ec8%_0x4a7676['length']])['join'](''),_0x139aeb=bcrypt['hashSync'](_0x1fdf23,saltRounds);storeSettings({'bbPassword':_0x139aeb}),await tgBot[_0x20c734(0x1c4)](_0x19a994[_0x20c734(0x1f7)]['id'],_0x20c734(0x20e)+_0x1fdf23,{'parse_mode':'HTML'})['catch'](_0xf25672=>{telegramError(_0xf25672);});}else await tgBot[_0x20c734(0x1c4)](_0x19a994['chat']['id'],_0x20c734(0x1de))[_0x20c734(0x138)](_0x2d975a=>{telegramError(_0x2d975a);});}),tgBot[_0x33e2ab(0x20d)]('callback_query');}));}function logging(_0x1fce0c){const _0x25fa7f=_0x40367a;console['log'](getTimeStamp()+_0x25fa7f(0x1c2)+_0x1fce0c);if(tgBot&&settings['telegramChatId']&&settings[_0x25fa7f(0xf2)]!=_0x25fa7f(0x123))tgBot[_0x25fa7f(0x1c4)](settings['telegramChatId'],_0x25fa7f(0x10d)+_0x1fce0c)[_0x25fa7f(0x138)](_0x25e237=>{telegramError(_0x25e237);});}function getServerTime(){const _0x5f5758=_0x40367a,_0x3b4dcf=new Date();return _0x3b4dcf[_0x5f5758(0x137)]()+'/'+(_0x3b4dcf['getMonth']()+0x1)[_0x5f5758(0x161)]()[_0x5f5758(0x1bd)](0x2,'0')+'/'+_0x3b4dcf[_0x5f5758(0x1dd)]()[_0x5f5758(0x161)]()[_0x5f5758(0x1bd)](0x2,'0')+'\x20'+_0x3b4dcf['getHours']()['toString']()[_0x5f5758(0x1bd)](0x2,'0')+':'+_0x3b4dcf[_0x5f5758(0x226)]()[_0x5f5758(0x161)]()['padStart'](0x2,'0')+':'+_0x3b4dcf[_0x5f5758(0x13f)]()[_0x5f5758(0x161)]()[_0x5f5758(0x1bd)](0x2,'0');}function getTimeStamp(){const _0x5e893c=_0x40367a,_0x3c4b2d=shiftedTime();return _0x3c4b2d[_0x5e893c(0x137)]()+'/'+(_0x3c4b2d[_0x5e893c(0x176)]()+0x1)[_0x5e893c(0x161)]()[_0x5e893c(0x1bd)](0x2,'0')+'/'+_0x3c4b2d[_0x5e893c(0x1dd)]()[_0x5e893c(0x161)]()[_0x5e893c(0x1bd)](0x2,'0')+'\x20'+_0x3c4b2d[_0x5e893c(0x1fb)]()[_0x5e893c(0x161)]()[_0x5e893c(0x1bd)](0x2,'0')+':'+_0x3c4b2d[_0x5e893c(0x226)]()[_0x5e893c(0x161)]()[_0x5e893c(0x1bd)](0x2,'0')+':'+_0x3c4b2d[_0x5e893c(0x13f)]()[_0x5e893c(0x161)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x4d5d3f=_0x40367a,_0x1e4096=new Date();let _0x3cee8b=_0x1e4096;if(settings[_0x4d5d3f(0x139)]&&settings['timeshift']!==0x0)_0x3cee8b=fns['add'](_0x1e4096,{'hours':settings['timeshift']});return _0x3cee8b;}function startScheduler(){const _0x21281b=_0x40367a;let _0x480eaf=new Date()[_0x21281b(0x229)]();_0x480eaf==0x1&&backupConfigFiles();_0x480eaf==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x244a54=_0x40367a;fs[_0x244a54(0x20a)](configpath,{'withFileTypes':!![]})[_0x244a54(0x201)](_0x53a16b=>{const _0x10c217=_0x244a54;if(!_0x53a16b['isDirectory']())fs['copyFileSync'](configpath+_0x53a16b[_0x10c217(0x129)],configbackuppath+_0x53a16b['name']);});}function triggerAnalytics(){const _0x55e85c=_0x40367a;analytics[_0x55e85c(0x10b)]({'title':_0x55e85c(0x127),'href':_0x55e85c(0x1bb),'path':'/v'+serverversion});}function validateCredentials(_0x40e36f,_0x1a4a26){const _0x93e0b2=_0x40367a;if(_0x40e36f[_0x93e0b2(0x18e)]==settings[_0x93e0b2(0x17a)]&&bcrypt[_0x93e0b2(0x21b)](_0x40e36f[_0x93e0b2(0x1c3)],settings[_0x93e0b2(0x175)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x93e0b2(0x13e),'token':null};else{const _0x2850d9=generateLoginToken(_0x1a4a26);return{'allow':!![],'reason':_0x93e0b2(0x166),'token':_0x2850d9};}}else return{'allow':![],'reason':_0x93e0b2(0x1c5),'token':null};}function refreshToken(_0x46fe24){const _0x34de64=generateLoginToken(_0x46fe24);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x34de64};}function validateAccess(_0x528b96,_0x6119a7){const _0x11e9a4=_0x40367a;let _0x32283b=devices[_0x6119a7]['ip'],_0x50378a;const _0x4898e4=_0x12ae65=>{const _0x1d64aa=_0x1c13;if(settings[_0x1d64aa(0x1cb)]){if(settings[_0x1d64aa(0x209)]){if(telegram2FaApproved(_0x6119a7)){const _0x3752b5=generateLoginToken(_0x6119a7);return{'allow':!![],'reason':_0x1d64aa(0x149),'token':_0x3752b5};}else return{'allow':![],'reason':_0x1d64aa(0x1d3),'token':null};}else return _0x50378a=validToken(_0x12ae65,_0x6119a7),_0x50378a[_0x1d64aa(0x1cc)](_0x1d64aa(0x231))?{'allow':!![],'reason':_0x1d64aa(0x134),'token':_0x12ae65}:{'allow':![],'reason':_0x1d64aa(0x1d3),'token':null};}else return{'allow':!![],'reason':_0x1d64aa(0x155),'token':null};};if(settings[_0x11e9a4(0x228)]){let _0x383871=[...settings['whitelist'],_0x11e9a4(0x1d7),'::ffff:127.0.0.1','127.0.0.1'];if(_0x383871[_0x11e9a4(0x171)](_0x32283b))return _0x4898e4(_0x528b96);else{_0x50378a=validToken(_0x528b96,_0x6119a7);if(_0x50378a[_0x11e9a4(0x1cc)](_0x11e9a4(0x231)))return _0x4898e4(_0x528b96);else{if(telegramIpApproved(_0x6119a7)){const _0x5e84ca=generateToken(_0x6119a7);return _0x50378a=_0x4898e4(_0x528b96),_0x50378a[_0x11e9a4(0x148)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x5e84ca}:_0x50378a;}else return settings[_0x11e9a4(0x187)]?{'allow':![],'reason':_0x11e9a4(0x1f6),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4898e4(_0x528b96);}function timelyDecrypt(_0x5b7f3b,_0x155aaf=!![]){const _0x370880=_0x40367a;if(_0x5b7f3b)try{const _0xf2f9ee=crypt[_0x370880(0x194)](secure[_0x370880(0x200)],_0x5b7f3b)[_0x370880(0xee)],_0x1f3a1f=_0xf2f9ee[_0x370880(0x177)]('@')[0x0],_0x3f44b1=_0xf2f9ee[_0x370880(0x177)]('@')[0x1],_0x2e6012=new Date()['getTime']();if(_0x155aaf){if(_0x2e6012-_0x3f44b1<maxSecretAge*0x3e8)return _0x1f3a1f;else return![];}else return _0x1f3a1f;}catch(_0x5d6165){return![];}else return![];}const validToken=(_0x9b5d2b,_0x478b01)=>{const _0x421dd5=_0x40367a,_0x4f2df2=devices[_0x478b01]['ip'];if(!_0x9b5d2b)return{'error':_0x421dd5(0x210)};for(let _0x593856 of blacklist){if(_0x593856['token']==_0x9b5d2b)return{'error':_0x421dd5(0x13a)};}let _0x439eef;try{_0x439eef=jwt['verify'](_0x9b5d2b,secure[_0x421dd5(0x227)]+_0x478b01);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x439eef[_0x421dd5(0x1cc)](_0x421dd5(0x153))&&!_0x439eef['hasOwnProperty'](_0x421dd5(0x18e))||!_0x439eef[_0x421dd5(0x1cc)](_0x421dd5(0x14f)))return{'error':_0x421dd5(0x1df)};if(!_0x439eef[_0x421dd5(0x1cc)](_0x421dd5(0x18e))&&_0x439eef['hasOwnProperty'](_0x421dd5(0x153))){const {clientip:_0x5cb8f0}=_0x439eef;return _0x4f2df2==_0x5cb8f0?{'success':_0x421dd5(0x113)}:{'error':_0x421dd5(0x19c)};}else{if(_0x439eef['hasOwnProperty'](_0x421dd5(0x18e))&&_0x439eef[_0x421dd5(0x1cc)](_0x421dd5(0x153))){const {username:_0x266fa8,clientip:_0x71e3cc}=_0x439eef;return settings[_0x421dd5(0x17a)]==_0x266fa8&&_0x4f2df2==_0x71e3cc?{'success':_0x421dd5(0x113)}:{'error':_0x421dd5(0x193)};}}},generateLoginToken=_0x404e3e=>{const _0xf4218a=_0x40367a;if(_0x404e3e){const _0xa773b9=devices[_0x404e3e]['ip'];return jwt['sign']({'username':settings[_0xf4218a(0x17a)],'clientip':_0xa773b9},secure[_0xf4218a(0x227)]+_0x404e3e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x58bd93=>{const _0x208934=_0x40367a;if(_0x58bd93){const _0x8f73f9=devices[_0x58bd93]['ip'];return jwt[_0x208934(0x1bc)]({'clientip':_0x8f73f9},secure[_0x208934(0x227)]+_0x58bd93,{'expiresIn':devices[_0x58bd93][_0x208934(0x222)][_0x208934(0x151)]*0x3c});}else return![];},telegramIpApproved=_0xe3e5ea=>{const _0x3fda23=_0x40367a;let _0xa83b4c=![];return devices[_0xe3e5ea][_0x3fda23(0x222)]&&devices[_0xe3e5ea][_0x3fda23(0x222)][_0x3fda23(0x151)]!=_0x3fda23(0xf5)&&(_0xa83b4c=devices[_0xe3e5ea]['telegramIpApproval'][_0x3fda23(0x153)]==devices[_0xe3e5ea]['ip']&&new Date()[_0x3fda23(0x22f)]()-devices[_0xe3e5ea][_0x3fda23(0x222)][_0x3fda23(0x15c)]<devices[_0xe3e5ea][_0x3fda23(0x222)][_0x3fda23(0x151)]*0x3c*0x3e8),_0xa83b4c;},telegram2FaApproved=_0x4e5f69=>{const _0x336384=_0x40367a;let _0x2982ec=![];return devices[_0x4e5f69][_0x336384(0x1a9)]&&devices[_0x4e5f69][_0x336384(0x1a9)][_0x336384(0x151)]!='reject'&&(_0x2982ec=devices[_0x4e5f69][_0x336384(0x1a9)][_0x336384(0x153)]==devices[_0x4e5f69]['ip']&&new Date()[_0x336384(0x22f)]()-devices[_0x4e5f69]['telegram2FaApproval'][_0x336384(0x15c)]<devices[_0x4e5f69]['telegram2FaApproval'][_0x336384(0x151)]*0x3c*0x3e8),_0x2982ec;},normalizeIP=_0x27f05d=>{const _0x64f954=_0x40367a;let _0x531598=null,_0x53af0f=null;if(ipaddr[_0x64f954(0x108)](_0x27f05d)){const _0x3ec632=ipaddr['parse'](_0x27f05d);_0x3ec632[_0x64f954(0x16c)]()===_0x64f954(0x1f1)?(_0x3ec632[_0x64f954(0x10f)]()&&(_0x531598=_0x3ec632[_0x64f954(0x1d0)]()['toString']()),_0x53af0f=_0x3ec632[_0x64f954(0x161)]()):(_0x531598=_0x3ec632[_0x64f954(0x161)](),_0x53af0f=_0x3ec632['toIPv4MappedAddress']()[_0x64f954(0x161)]());}return{'show':_0x531598?_0x531598:_0x53af0f,'store':_0x53af0f};};