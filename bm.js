const _0x517b6=_0xa5da;(function(_0x400aa6,_0x4d8581){const _0xf4db80=_0xa5da,_0x1b5a19=_0x400aa6();while(!![]){try{const _0x161d74=parseInt(_0xf4db80(0x30f))/0x1*(parseInt(_0xf4db80(0x318))/0x2)+-parseInt(_0xf4db80(0x271))/0x3+-parseInt(_0xf4db80(0x29a))/0x4+parseInt(_0xf4db80(0x2e9))/0x5+parseInt(_0xf4db80(0x207))/0x6+parseInt(_0xf4db80(0x1b4))/0x7+parseInt(_0xf4db80(0x2cf))/0x8*(-parseInt(_0xf4db80(0x1fb))/0x9);if(_0x161d74===_0x4d8581)break;else _0x1b5a19['push'](_0x1b5a19['shift']());}catch(_0x222213){_0x1b5a19['push'](_0x1b5a19['shift']());}}}(_0xbbc8,0xc1483));const _0x243bb1=function(){let _0x5b726a=!![];return function(_0x9b55f7,_0x433087){const _0xd2ca1=_0x5b726a?function(){const _0x41686b=_0xa5da;if(_0x433087){const _0x6b29f4=_0x433087[_0x41686b(0x2be)](_0x9b55f7,arguments);return _0x433087=null,_0x6b29f4;}}:function(){};return _0x5b726a=![],_0xd2ca1;};}(),_0x51e28e=_0x243bb1(this,function(){const _0x5d6298=_0xa5da;return _0x51e28e[_0x5d6298(0x338)]()['search'](_0x5d6298(0x339))[_0x5d6298(0x338)]()[_0x5d6298(0x197)](_0x51e28e)['search'](_0x5d6298(0x339));});_0x51e28e();'use strict';process[_0x517b6(0x19c)][_0x517b6(0x2ec)]=0x1;const childProcess=require(_0x517b6(0x2c9)),fs=require('fs'),fns=require(_0x517b6(0x2df)),low=require(_0x517b6(0x2bf)),FileSync=require(_0x517b6(0x296)),path=require(_0x517b6(0x347)),crypto=require(_0x517b6(0x21b)),Crypt=require(_0x517b6(0x1ca))['Crypt'],RSA=require('hybrid-crypto-js')[_0x517b6(0x223)],bcrypt=require(_0x517b6(0x34b)),jwt=require(_0x517b6(0x2f1)),ipaddr=require(_0x517b6(0x2ea)),argv=require('yargs/yargs')(process[_0x517b6(0x2fd)]['slice'](0x2))['argv'],uuidRandom=require(_0x517b6(0x30d)),{Telegraf,Markup}=require(_0x517b6(0x227)),Mixpanel=require(_0x517b6(0x31e)),axios=require(_0x517b6(0x1c5)),{GraphQLClient,gql}=require(_0x517b6(0x372)),util=require(_0x517b6(0x1a2)),fileUpload=require(_0x517b6(0x2c5)),{networkInterfaces}=require('os'),PORT=argv[_0x517b6(0x2e7)]||_0x517b6(0x24f),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x517b6(0x322)](_0x517b6(0x1c3)+PORT+_0x517b6(0x308)),process[_0x517b6(0x1c9)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x517b6(0x222)][_0x517b6(0x192)];let bbpath=_0x517b6(0x187),bbpath2='';const botfile='bot.js',configfile=_0x517b6(0x2e4),settingsfile=_0x517b6(0x2ef),securefile=_0x517b6(0x331),environment=require('./'+bbpath2+'version.json')[_0x517b6(0x193)]||_0x517b6(0x330),maxBackups=0xa;let validInstallation=!![];!fs[_0x517b6(0x1dc)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x517b6(0x257)),configpath=userID?bbpath+_0x517b6(0x18d)+userID+'/':bbpath+_0x517b6(0x18d),configbackuppath=configpath+_0x517b6(0x359),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x517b6(0x1b9),zippath=userID?bbpath+_0x517b6(0x2bc)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x517b6(0x297)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x517b6(0x226)+userID+'/':bbpath+_0x517b6(0x226);!fs[_0x517b6(0x1dc)](configpath)&&fs[_0x517b6(0x1d5)](configpath);!fs[_0x517b6(0x1dc)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x517b6(0x1dc)](logspath)&&fs[_0x517b6(0x1d5)](logspath);!fs[_0x517b6(0x1dc)](zippath)&&fs[_0x517b6(0x1d5)](zippath);!fs[_0x517b6(0x1dc)](temppath)&&fs[_0x517b6(0x1d5)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x517b6(0x208)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x517b6(0x208)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x517b6(0x260)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x517b6(0x260)]();let crypt=new Crypt({'md':_0x517b6(0x22b),'rsaStandard':_0x517b6(0x2f3)});const saltRounds=0xa,mixpanel=Mixpanel[_0x517b6(0x1e3)](_0x517b6(0x1ee),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x517b6(0x23e)]&&(settings[_0x517b6(0x23e)]!=''&&settings['telegramToken']!=_0x517b6(0x22a))&&settings[_0x517b6(0x2c2)]&&settings[_0x517b6(0x2c2)]!='')initTelegram();const parseColor=(_0x3435ad,_0x559517)=>{const _0x9db080=_0x517b6,_0xaacc93=/#[A-Z]{3}#/g;if(typeof _0x3435ad==_0x9db080(0x2e8)){!_0x559517?_0x3435ad=_0x3435ad['replace'](_0xaacc93,''):(_0x3435ad=_0x3435ad[_0x9db080(0x18e)](/#BLU#/g,'\x1b[34m'),_0x3435ad=_0x3435ad[_0x9db080(0x18e)](/#RED#/g,'\x1b[31m'),_0x3435ad=_0x3435ad[_0x9db080(0x18e)](/#YEL#/g,_0x9db080(0x22c)),_0x3435ad=_0x3435ad[_0x9db080(0x18e)](/#MAG#/g,_0x9db080(0x1e8)),_0x3435ad=_0x3435ad['replace'](/#CYA#/g,_0x9db080(0x2bb)),_0x3435ad=_0x3435ad[_0x9db080(0x18e)](/#RES#/g,_0x9db080(0x23c)));;}return _0x3435ad;},logger={'screen':_0xb4a889=>{const _0x3ea979=_0x517b6;console[_0x3ea979(0x322)](parseColor(_0xb4a889,!![]));},'simple':_0x3d8c6b=>{const _0x153d7f=_0x517b6;console[_0x153d7f(0x322)](parseColor(_0x3d8c6b,!![])),loggerfile[_0x153d7f(0x260)](util[_0x153d7f(0x18f)](parseColor(_0x3d8c6b,![]))+'\x0a');},'full':async _0x444fc0=>{const _0x10d496=_0x517b6,_0x1e099e=getTimeStamp()+_0x10d496(0x1dd)+_0x444fc0;console['log'](parseColor(_0x1e099e,!![])),loggerfile['write'](util[_0x10d496(0x18f)](parseColor(_0x1e099e,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x10d496(0x311)]!=_0x10d496(0x368))await sendTelegram(settings[_0x10d496(0x1ed)],_0x10d496(0x1bf)+parseColor(_0x444fc0,![]));},'debug':async(_0x528d9f,_0x9d7b8c='')=>{const _0x1c8dc8=_0x517b6,_0x40de88=getTimeStamp()+_0x1c8dc8(0x316)+_0x528d9f;if(debugging)console[_0x1c8dc8(0x322)](parseColor(_0x40de88,!![]));loggerfile[_0x1c8dc8(0x260)](util[_0x1c8dc8(0x18f)](parseColor(_0x40de88,![]))+'\x0a');if(_0x9d7b8c){if(debugging)console[_0x1c8dc8(0x322)](_0x9d7b8c);loggerfile[_0x1c8dc8(0x260)](util[_0x1c8dc8(0x18f)](_0x9d7b8c)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x554c92){logger['simple'](_0x554c92);}),process['on'](_0x517b6(0x1c9),()=>{stopAllBots();}),process['on'](_0x517b6(0x30e),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x517b6(0x2d5))[_0x517b6(0x2ad)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x517b6(0x2a9)),app=express(),http=require(_0x517b6(0x317))['createServer'](app);app[_0x517b6(0x1b3)](fileUpload({'useTempFiles':!![]})),app[_0x517b6(0x2f6)]('/download/:type',async(_0x22eab1,_0x2e09bd)=>{const _0x4bacad=_0x517b6,_0x2ce9a8=_0x22eab1[_0x4bacad(0x2b8)][_0x4bacad(0x228)],_0x3f2266=getClientsWithBotID(_0x4bacad(0x364)),_0x4f34ca=_0x22eab1[_0x4bacad(0x2c6)]['uuid'],_0x30a6f0=timelyDecrypt(_0x4f34ca,![]),_0x18eb10=_0x3f2266['find'](_0x4adea6=>_0x4adea6['uuid']==_0x30a6f0);if(_0x18eb10){const _0x18f00c=normalizeIP(_0x22eab1[_0x4bacad(0x195)][_0x4bacad(0x17f)])[_0x4bacad(0x1ab)],_0x1d5d33=_0x22eab1[_0x4bacad(0x2c6)][_0x4bacad(0x19f)];if(validateAccess(_0x1d5d33,_0x30a6f0,_0x18f00c)[_0x4bacad(0x20b)])_0x2ce9a8==_0x4bacad(0x363)&&await backupConfigFiles(),await zipFiles(_0x2ce9a8),_0x2e09bd['download'](zippath+(_0x2ce9a8+_0x4bacad(0x254)),_0x515b27=>{const _0x2e0be1=_0x4bacad;_0x515b27&&(logger['full'](_0x2e0be1(0x2dd)+_0x2ce9a8),logger[_0x2e0be1(0x1d7)](_0x515b27));});else logger[_0x4bacad(0x275)](_0x4bacad(0x2a4)+_0x2ce9a8+_0x4bacad(0x2d8));}else logger['full'](_0x4bacad(0x2a4)+_0x2ce9a8+_0x4bacad(0x28e));}),app[_0x517b6(0x36e)](_0x517b6(0x29c),async(_0x292b5e,_0x253040)=>{const _0x3f58ac=_0x517b6,_0x15351c=getClientsWithBotID('botmanager'),_0x3b7684=_0x292b5e['headers'][_0x3f58ac(0x1f1)],_0x4e36e1=timelyDecrypt(_0x3b7684,![]),_0x518c43=_0x15351c['find'](_0x291528=>_0x291528[_0x3f58ac(0x1f1)]==_0x4e36e1);logger[_0x3f58ac(0x204)](_0x3f58ac(0x1f6));if(_0x518c43){const _0x148291=normalizeIP(_0x292b5e['socket']['remoteAddress'])[_0x3f58ac(0x1ab)],_0x5b9d04=_0x292b5e[_0x3f58ac(0x2c6)][_0x3f58ac(0x19f)];if(validateAccess(_0x5b9d04,_0x4e36e1,_0x148291)[_0x3f58ac(0x20b)]){if(_0x292b5e[_0x3f58ac(0x2fb)]){const _0x1b1b3c=_0x292b5e[_0x3f58ac(0x2fb)][_0x3f58ac(0x2a3)];await _0x1b1b3c['mv'](temppath+_0x1b1b3c[_0x3f58ac(0x307)]),_0x253040[_0x3f58ac(0x298)]({'status':!![],'message':_0x3f58ac(0x2b0)});const _0x5d6786=getBotsWithMode();_0x5d6786[_0x3f58ac(0x236)]>0x0?confirmRestore(temppath,_0x1b1b3c[_0x3f58ac(0x307)]):unzipFile(temppath,_0x1b1b3c[_0x3f58ac(0x307)]);}}else logger[_0x3f58ac(0x275)](_0x3f58ac(0x21c));}else logger[_0x3f58ac(0x275)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x517b6(0x1b3)](express[_0x517b6(0x365)](path[_0x517b6(0x2a6)](__dirname,bbpath2,_0x517b6(0x1b5)))),app[_0x517b6(0x1b3)](express[_0x517b6(0x365)](path[_0x517b6(0x2a6)](__dirname,bbpath2,_0x517b6(0x21a)))),app[_0x517b6(0x2f6)]('/',function(_0x3b9cd3,_0x27567d){const _0xa088fe=_0x517b6;_0x27567d[_0xa088fe(0x255)](path[_0xa088fe(0x2a6)](__dirname,bbpath2,_0xa088fe(0x1b5),_0xa088fe(0x2b1)));}),app['get']('/:bot',function(_0x4844c1,_0x138a11){const _0x5c2fcb=_0x517b6;_0x138a11['sendFile'](path['join'](__dirname,bbpath2,_0x5c2fcb(0x21a),'index.html'));}),app[_0x517b6(0x2f6)]('/:bot/portfolio',(_0x2b1ad7,_0x581116)=>{const _0x149487=_0x517b6;_0x581116[_0x149487(0x255)](path[_0x149487(0x2a6)](__dirname,bbpath2,_0x149487(0x21a),_0x149487(0x2b1)));}),app[_0x517b6(0x2f6)](_0x517b6(0x18a),(_0x18d9ae,_0x3aa247)=>{const _0x3fc8d1=_0x517b6;_0x3aa247[_0x3fc8d1(0x255)](path[_0x3fc8d1(0x2a6)](__dirname,bbpath2,_0x3fc8d1(0x21a),_0x3fc8d1(0x2b1)));}),app['get'](_0x517b6(0x265),(_0x3739ba,_0x14e81a)=>{const _0xd12ca=_0x517b6;_0x14e81a[_0xd12ca(0x255)](path[_0xd12ca(0x2a6)](__dirname,bbpath2,_0xd12ca(0x21a),'index.html'));}),app['get'](_0x517b6(0x300),(_0x450027,_0x46d9ea)=>{const _0x26d06d=_0x517b6;_0x46d9ea[_0x26d06d(0x255)](path[_0x26d06d(0x2a6)](__dirname,bbpath2,'build','index.html'));}),app[_0x517b6(0x2f6)](_0x517b6(0x1eb),(_0x1f7653,_0x5750bc)=>{const _0x23ac38=_0x517b6;_0x5750bc[_0x23ac38(0x255)](path[_0x23ac38(0x2a6)](__dirname,bbpath2,'build',_0x23ac38(0x2b1)));}),app[_0x517b6(0x2f6)](_0x517b6(0x32f),(_0x27753c,_0x170867)=>{const _0x5aa3ba=_0x517b6;_0x170867['sendFile'](path['join'](__dirname,bbpath2,_0x5aa3ba(0x21a),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x517b6(0x1f8)](PORT);const io=require(_0x517b6(0x1a7))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1e3924=_0x517b6;let _0xe75a0d=_0x1e3924(0x224);const _0x31e299=networkInterfaces(),_0x4bd472={};for(const _0x41c5cf of Object[_0x1e3924(0x377)](_0x31e299)){for(const _0x51ff1e of _0x31e299[_0x41c5cf]){if((_0x51ff1e[_0x1e3924(0x312)]==_0x1e3924(0x23b)||_0x51ff1e['family']==0x4)&&!_0x51ff1e[_0x1e3924(0x1c4)]){const _0x28dece=ipaddr[_0x1e3924(0x360)](_0x51ff1e[_0x1e3924(0x2d6)])[_0x1e3924(0x17e)]();_0x28dece!=_0x1e3924(0x209)&&(!_0x4bd472[_0x41c5cf]&&(_0x4bd472[_0x41c5cf]=[]),_0x4bd472[_0x41c5cf][_0x1e3924(0x350)](_0x51ff1e['address']),_0xe75a0d=_0x51ff1e[_0x1e3924(0x2d6)]);}}}return{'serverip':_0xe75a0d,'netinterfaces':_0x4bd472};}async function startServer(){const _0x4246a8=_0x517b6,{serverip:_0x13553c,netinterfaces:_0xf9dd2f}=getServerIP();logger[_0x4246a8(0x1d7)](''),logger['simple'](_0x4246a8(0x1b6)),await logger[_0x4246a8(0x275)](_0x4246a8(0x235)+serverversion+_0x4246a8(0x1ad)+(environment==_0x4246a8(0x378)?_0x4246a8(0x30c):'')+'\x0a'+(_0x4246a8(0x367)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x4246a8(0x2c0)+_0x13553c+':'+PORT+_0x4246a8(0x333))),logger[_0x4246a8(0x1d7)]('-----------------------------------------------------------------------------------');if(config[_0x4246a8(0x236)]!=0x0)for(const _0x150c35 of config){const _0x165751=_0x150c35['mode']==_0x4246a8(0x1c1)?'a':'m';if(_0x150c35[_0x4246a8(0x356)]==_0x4246a8(0x327)||_0x150c35[_0x4246a8(0x356)]=='new')await logger[_0x4246a8(0x275)]('Starting\x20('+_0x165751+_0x4246a8(0x302)+_0x150c35[_0x4246a8(0x21f)]+_0x4246a8(0x248)+_0x150c35['botname']),startBot([_0x150c35[_0x4246a8(0x21f)],userID],{'cwd':bbpath},function(_0x2e837b){const _0x32829d=_0x4246a8;if(_0x2e837b)logger[_0x32829d(0x275)](_0x2e837b);});else(_0x150c35[_0x4246a8(0x356)]=='disabled'||_0x150c35['status']==_0x4246a8(0x370))&&await logger[_0x4246a8(0x275)](_0x4246a8(0x1a8)+_0x165751+_0x4246a8(0x280)+_0x150c35[_0x4246a8(0x21f)]+_0x4246a8(0x248)+_0x150c35[_0x4246a8(0x180)]);}else!newBot&&logger[_0x4246a8(0x1d7)](_0x4246a8(0x2a0));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x4246a8(0x1d7)](''),await logger[_0x4246a8(0x204)](_0x4246a8(0x181)+nodeversion),await logger['debug'](_0x4246a8(0x19e),_0xf9dd2f);}function startSocket(){const _0x2a11bd=_0x517b6;io['on'](_0x2a11bd(0x36f),_0x2e78c0=>{const _0x6e06f2=_0x2a11bd;let _0x2c2d49,_0x58100a,_0x427fbf,_0x34b41a,_0x1e6898;const _0x43fec6=_0x2e78c0[_0x6e06f2(0x2bd)][_0x6e06f2(0x2c6)][_0x6e06f2(0x376)];_0x58100a=_0x43fec6[_0x6e06f2(0x1cc)](/bot[0-9]{3}/);if(_0x58100a)_0x427fbf=_0x58100a[0x0][_0x6e06f2(0x1cc)](/[0-9]{3}/);if(_0x427fbf)_0x2c2d49=_0x427fbf[0x0];else _0x2c2d49=_0x6e06f2(0x364);const _0x11f34a=_0x2e78c0[_0x6e06f2(0x2bd)][_0x6e06f2(0x329)][_0x6e06f2(0x1ac)];if(!_0x11f34a)_0x2e78c0[_0x6e06f2(0x340)]('status',{'publicKey':secure[_0x6e06f2(0x1e1)]});else{_0x34b41a=timelyDecrypt(_0x11f34a,![]);if(!_0x34b41a)_0x2e78c0[_0x6e06f2(0x340)](_0x6e06f2(0x356),{'publicKey':secure[_0x6e06f2(0x1e1)]});else{_0x1e6898=normalizeIP(_0x2e78c0[_0x6e06f2(0x276)][_0x6e06f2(0x17f)])[_0x6e06f2(0x1ab)];if(!devices[_0x34b41a])devices[_0x34b41a]={'uuid':_0x34b41a,'access':{'token':null}};devices[_0x34b41a]['ip']=_0x1e6898;const _0x2b714d=addClient(_0x2e78c0['id'],_0x34b41a,_0x2c2d49);setAccess(_0x2b714d),emitMessages(),_0x2e78c0['on'](_0x6e06f2(0x2f0),_0x2a1966=>{const _0x33c1ae=_0x6e06f2,_0x16b401=timelyDecrypt(_0x2a1966['password']);if(_0x16b401){_0x2a1966={'username':_0x2a1966['username'],'password':_0x16b401},devices[_0x34b41a]['access']=validateCredentials(_0x2a1966,_0x34b41a);if(devices[_0x34b41a][_0x33c1ae(0x313)][_0x33c1ae(0x20b)]==![]&&devices[_0x34b41a]['access'][_0x33c1ae(0x294)]==_0x33c1ae(0x194))_0x2e78c0[_0x33c1ae(0x340)](_0x33c1ae(0x356),{'access':devices[_0x34b41a][_0x33c1ae(0x313)]}),loginAccess2FA(_0x34b41a,_0x1e6898);else{if(devices[_0x34b41a]['access'][_0x33c1ae(0x20b)]==![]&&devices[_0x34b41a][_0x33c1ae(0x313)][_0x33c1ae(0x294)]==_0x33c1ae(0x33b))_0x2e78c0[_0x33c1ae(0x340)](_0x33c1ae(0x356),{'access':devices[_0x34b41a][_0x33c1ae(0x313)]});else devices[_0x34b41a][_0x33c1ae(0x313)]['allow']&&devices[_0x34b41a][_0x33c1ae(0x313)][_0x33c1ae(0x294)]==_0x33c1ae(0x1be)&&(getClientsWithUuid(_0x34b41a)[_0x33c1ae(0x1d6)](_0x3dd6de=>{setAccess(_0x3dd6de);}),logger[_0x33c1ae(0x204)](_0x33c1ae(0x252)+_0x34b41a['slice'](-0x8)),setTokenRefresh(_0x34b41a),setSessionTimeout('login',_0x34b41a));}}else logger[_0x33c1ae(0x275)](_0x33c1ae(0x29e));}),_0x2e78c0['on']('reset-password',()=>{resetPassword();}),_0x2e78c0['on']('disconnect',_0x518ef6=>{removeClient(_0x2e78c0['id']);}),_0x2c2d49==_0x6e06f2(0x364)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x387239){const _0x724871=_0x517b6;if(_0x387239!=_0x724871(0x364)&&config['apiKey']!=''){if(pid[_0x387239])pid[_0x387239][_0x724871(0x298)]({'function':'initclient','args':null});}_0x387239!='botmanager'&&broadcastToBots(_0x724871(0x2b2),JSON[_0x724871(0x324)](config));}function reloadBotManager(){const _0x514097=_0x517b6;getClientsWithBotID('botmanager')[_0x514097(0x1d6)](_0xc91372=>{const _0x3284f8=_0x514097;getSocket(_0xc91372['id'])['emit'](_0x3284f8(0x356),{'access':{'allow':![],'reason':_0x3284f8(0x2e3),'token':null}});});}function getSocket(_0x5e9198){const _0x3385df=_0x517b6;return io[_0x3385df(0x206)]['sockets'][_0x3385df(0x2f6)](_0x5e9198);}function setAccess(_0x495adb){const _0x2e5238=_0x517b6,_0x5f59fe=getSocket(_0x495adb['id']),_0xe0a06f=_0x495adb[_0x2e5238(0x1f1)],_0x6850f1=_0x495adb['bot'];devices[_0xe0a06f][_0x2e5238(0x313)]=validateAccess(devices[_0xe0a06f]['access']['token'],_0xe0a06f),logger['debug'](_0x2e5238(0x310)+devices[_0xe0a06f][_0x2e5238(0x313)][_0x2e5238(0x294)]+_0x2e5238(0x36a)+_0x495adb['id']['slice'](-0x8)+_0x2e5238(0x33a)+_0xe0a06f[_0x2e5238(0x221)](-0x8)),_0x5f59fe[_0x2e5238(0x2a6)](_0xe0a06f);if(devices[_0xe0a06f][_0x2e5238(0x313)][_0x2e5238(0x20b)]){_0x5f59fe['join'](_0x6850f1);if(_0x6850f1==_0x2e5238(0x364))initializeSocketBotManager(_0x5f59fe);else initializeSocketBot(_0x5f59fe);initClient(_0x6850f1);}devices[_0xe0a06f][_0x2e5238(0x313)][_0x2e5238(0x2ed)]&&devices[_0xe0a06f][_0x2e5238(0x313)][_0x2e5238(0x294)]==_0x2e5238(0x1b2)&&setSessionTimeout(_0x2e5238(0x1da),_0xe0a06f),devices[_0xe0a06f]['access'][_0x2e5238(0x2ed)]&&devices[_0xe0a06f]['access']['reason']==_0x2e5238(0x348)&&setSessionTimeout(_0x2e5238(0x2f0),_0xe0a06f),_0x5f59fe[_0x2e5238(0x340)](_0x2e5238(0x356),{'status':_0x495adb[_0x2e5238(0x1a1)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xe0a06f][_0x2e5238(0x313)],'externalip':devices[_0xe0a06f]['ip'],'publicKey':secure[_0x2e5238(0x1e1)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0xe0a06f][_0x2e5238(0x313)][_0x2e5238(0x20b)]==![]&&devices[_0xe0a06f][_0x2e5238(0x313)][_0x2e5238(0x294)]==_0x2e5238(0x199)&&temporaryAccess2FA(_0xe0a06f,devices[_0xe0a06f]['ip']);}function setSessionTimeout(_0x301358,_0x1e8333){const _0x4795da=_0x517b6;let _0x38fc69;if(_0x301358==_0x4795da(0x2f0))_0x38fc69=loginExpiry*0x3c*0x3e8;else _0x38fc69=devices[_0x1e8333][_0x4795da(0x1bd)][_0x4795da(0x2ae)]*0x3c*0x3e8-(new Date()[_0x4795da(0x28a)]()-devices[_0x1e8333][_0x4795da(0x1bd)]['timestamp']);if(devices[_0x1e8333][_0x4795da(0x214)])clearTimeout(devices[_0x1e8333][_0x4795da(0x214)]);devices[_0x1e8333][_0x4795da(0x214)]=setTimeout(()=>{const _0x3d3ea5=_0x4795da;if(devices[_0x1e8333][_0x3d3ea5(0x32d)])clearTimeout(devices[_0x1e8333][_0x3d3ea5(0x32d)]);removeSocketListeners(_0x1e8333),addBlacklist(_0x1e8333),devices[_0x1e8333]['telegramIpApproval']=null,devices[_0x1e8333][_0x3d3ea5(0x205)]=null,devices[_0x1e8333]['access'][_0x3d3ea5(0x2ed)]=null,logger['debug'](_0x3d3ea5(0x303)+_0x1e8333['slice'](-0x8)),devices[_0x1e8333][_0x3d3ea5(0x313)]=validateAccess(devices[_0x1e8333][_0x3d3ea5(0x313)][_0x3d3ea5(0x2ed)],_0x1e8333),!(devices[_0x1e8333][_0x3d3ea5(0x313)]['allow']&&devices[_0x1e8333][_0x3d3ea5(0x313)][_0x3d3ea5(0x294)]==_0x3d3ea5(0x2a2))&&(_0x301358=='login'?io['to'](_0x1e8333)[_0x3d3ea5(0x340)](_0x3d3ea5(0x356),{'access':{'allow':![],'reason':_0x3d3ea5(0x2d1),'token':null}}):io['to'](_0x1e8333)[_0x3d3ea5(0x340)]('status',{'access':{'allow':![],'reason':_0x3d3ea5(0x2c8),'token':null}})),devices[_0x1e8333][_0x3d3ea5(0x313)][_0x3d3ea5(0x2ed)]=null;},_0x38fc69);}function setTokenRefresh(_0x11f410){const _0x4b5117=_0x517b6;if(devices[_0x11f410]['pidRefreshToken'])clearTimeout(devices[_0x11f410]['pidRefreshToken']);devices[_0x11f410][_0x4b5117(0x32d)]=setTimeout(()=>{const _0x2b040f=_0x4b5117;getClientsWithUuid(_0x11f410)[_0x2b040f(0x236)]!=0x0?(devices[_0x11f410][_0x2b040f(0x313)]=refreshToken(_0x11f410),io['to'](_0x11f410)['emit']('status',{'status':_0x2b040f(0x2e5),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x11f410]['access'],'externalip':devices[_0x11f410]['ip'],'publicKey':secure[_0x2b040f(0x1e1)],'validInstallation':validInstallation}),setTokenRefresh(_0x11f410)):clearTimeout(devices[_0x11f410][_0x2b040f(0x32d)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x13f154){const _0x22fc98=_0x517b6,_0x2398c8=getClient(_0x13f154['id'])[_0x22fc98(0x1f1)];_0x13f154['emit']('bots',config),_0x13f154['emit'](_0x22fc98(0x240),cleanSettings()),_0x13f154['on'](_0x22fc98(0x336),_0x2b0fee=>{const _0x266fb3=_0x22fc98;if(validateAccess(_0x2b0fee,_0x2398c8)[_0x266fb3(0x20b)])addBot();else logger[_0x266fb3(0x275)](_0x266fb3(0x2e1));}),_0x13f154['on'](_0x22fc98(0x27a),(_0x1a8edc,_0x40e410)=>{const _0x54bdd0=_0x22fc98;if(validateAccess(_0x40e410,_0x2398c8)[_0x54bdd0(0x20b)])toggleBot(_0x1a8edc[_0x54bdd0(0x21f)],_0x1a8edc[_0x54bdd0(0x356)],_0x1a8edc[_0x54bdd0(0x349)]);else logger[_0x54bdd0(0x275)](_0x54bdd0(0x32e));}),_0x13f154['on']('toggle-bot-mode',(_0x47bd90,_0x5e1de3)=>{const _0x22d9c8=_0x22fc98;if(validateAccess(_0x5e1de3,_0x2398c8)[_0x22d9c8(0x20b)])toggleBotMode(_0x47bd90);else logger[_0x22d9c8(0x275)](_0x22d9c8(0x32e));}),_0x13f154['on']('delete-bot',(_0x5b6343,_0x4c9d32)=>{const _0x4fcaa5=_0x22fc98;if(validateAccess(_0x4c9d32,_0x2398c8)[_0x4fcaa5(0x20b)])deleteBot(_0x5b6343);else logger[_0x4fcaa5(0x275)](_0x4fcaa5(0x354));}),_0x13f154['on'](_0x22fc98(0x20d),(_0x22e23b,_0x5264a6)=>{const _0x454f60=_0x22fc98;if(validateAccess(_0x5264a6,_0x2398c8)[_0x454f60(0x20b)])storeSettings(_0x22e23b,!![]);else logger[_0x454f60(0x275)](_0x454f60(0x267));}),_0x13f154['on'](_0x22fc98(0x2a5),_0x32d417=>{const _0x4ff020=_0x22fc98;if(validateAccess(_0x32d417,_0x2398c8)[_0x4ff020(0x20b)])updateBB('update');else logger[_0x4ff020(0x275)](_0x4ff020(0x2dc));}),_0x13f154['on'](_0x22fc98(0x2da),_0x3584f7=>{const _0x1b7f18=_0x22fc98;if(validateAccess(_0x3584f7,_0x2398c8)[_0x1b7f18(0x20b)])updateBB(_0x1b7f18(0x2c7));else logger[_0x1b7f18(0x275)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x13f154['on'](_0x22fc98(0x219),_0x3343d2=>{const _0x8182ed=_0x22fc98;if(validateAccess(_0x3343d2,_0x2398c8)[_0x8182ed(0x20b)]){const _0x3cce44=getClient(_0x13f154['id']);if(_0x3cce44)getBackupFiles(_0x3cce44[_0x8182ed(0x1f1)]);else logger[_0x8182ed(0x275)](_0x8182ed(0x17b));}else logger[_0x8182ed(0x275)](_0x8182ed(0x191));}),_0x13f154['on']('restore-backup-file',(_0x3b9add,_0x1c626b)=>{const _0x19e55b=_0x22fc98;if(validateAccess(_0x1c626b,_0x2398c8)[_0x19e55b(0x20b)])restoreBackupFile(_0x3b9add);else logger[_0x19e55b(0x275)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x13f154['on'](_0x22fc98(0x306),_0x4284dc=>{const _0xd433cb=_0x22fc98;if(validateAccess(_0x4284dc,_0x2398c8)[_0xd433cb(0x20b)])getMessages();else logger[_0xd433cb(0x275)](_0xd433cb(0x32b));}),_0x13f154['on'](_0x22fc98(0x332),(_0x33cee1,_0x82f100)=>{const _0x425df0=_0x22fc98;if(validateAccess(_0x82f100,_0x2398c8)[_0x425df0(0x20b)])confirmMessage(_0x33cee1);else logger[_0x425df0(0x275)](_0x425df0(0x1a0));}),_0x13f154['on'](_0x22fc98(0x21d),_0x17c1da=>{const _0x3d970c=_0x22fc98;if(validateAccess(_0x17c1da,_0x2398c8)['allow']){if(devices[_0x2398c8]['pidRefreshToken'])clearTimeout(devices[_0x2398c8][_0x3d970c(0x32d)]);if(devices[_0x2398c8][_0x3d970c(0x214)])clearTimeout(devices[_0x2398c8][_0x3d970c(0x214)]);removeSocketListeners(getClient(_0x13f154['id'])[_0x3d970c(0x1f1)]),addBlacklist(_0x2398c8),devices[_0x2398c8]['telegramIpApproval']=null,devices[_0x2398c8][_0x3d970c(0x205)]=null,devices[_0x2398c8][_0x3d970c(0x313)][_0x3d970c(0x2ed)]=null,logger['debug'](_0x3d970c(0x31a)+_0x2398c8[_0x3d970c(0x221)](-0x8)),io['to'](getClient(_0x13f154['id'])['uuid'])['emit'](_0x3d970c(0x356),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3d970c(0x275)](_0x3d970c(0x369));});}function initializeSocketBot(_0x346dd7){const _0x4d70d2=_0x517b6,_0x4ba9f6=getClient(_0x346dd7['id'])[_0x4d70d2(0x2a1)],_0x469088=getClient(_0x346dd7['id'])['uuid'];_0x346dd7['on'](_0x4d70d2(0x2f5),(_0x44ed82,_0x97368c)=>{const _0x332cdc=_0x4d70d2;if(validateAccess(_0x97368c,_0x469088)['allow']){if(pid[_0x4ba9f6])pid[_0x4ba9f6][_0x332cdc(0x298)]({'function':'emitHistory','args':_0x44ed82});}else logger[_0x332cdc(0x275)](_0x332cdc(0x2cb));}),_0x346dd7['on']('delete-alerts',(_0x1775e,_0x28910b)=>{const _0x574701=_0x4d70d2;if(validateAccess(_0x28910b,_0x469088)[_0x574701(0x20b)]){if(pid[_0x4ba9f6])pid[_0x4ba9f6][_0x574701(0x298)]({'function':_0x574701(0x19a),'args':_0x1775e});}else logger[_0x574701(0x275)](_0x574701(0x321));}),_0x346dd7['on'](_0x4d70d2(0x2f2),(_0x4db5d2,_0x3f9fdd)=>{const _0x38217d=_0x4d70d2;if(validateAccess(_0x3f9fdd,_0x469088)[_0x38217d(0x20b)]){if(pid[_0x4ba9f6])pid[_0x4ba9f6][_0x38217d(0x298)]({'function':_0x38217d(0x346),'args':_0x4db5d2});}else logger['full'](_0x38217d(0x1b0));}),_0x346dd7['on'](_0x4d70d2(0x304),(_0x2d6fb8,_0x169f1c)=>{const _0x46124f=_0x4d70d2;if(validateAccess(_0x169f1c,_0x469088)['allow']){if(pid[_0x4ba9f6])pid[_0x4ba9f6]['send']({'function':'storeConfiguration','args':_0x2d6fb8});}else logger[_0x46124f(0x275)](_0x46124f(0x35d));}),_0x346dd7['on'](_0x4d70d2(0x213),(_0xb6d028,_0x3408c0)=>{const _0x6743a8=_0x4d70d2;if(validateAccess(_0x3408c0,_0x469088)[_0x6743a8(0x20b)]){if(pid[_0x4ba9f6])pid[_0x4ba9f6][_0x6743a8(0x298)]({'function':_0x6743a8(0x2ff),'args':_0xb6d028});}else logger[_0x6743a8(0x275)](_0x6743a8(0x25b));}),_0x346dd7['on'](_0x4d70d2(0x2e6),(_0x437cdc,_0x3f101a)=>{const _0x5d2958=_0x4d70d2;if(validateAccess(_0x3f101a,_0x469088)[_0x5d2958(0x20b)]){if(pid[_0x4ba9f6])pid[_0x4ba9f6]['send']({'function':'storeFiat','args':_0x437cdc});}else logger[_0x5d2958(0x275)](_0x5d2958(0x34a));}),_0x346dd7['on'](_0x4d70d2(0x357),_0x187151=>{const _0x206eef=_0x4d70d2;if(validateAccess(_0x187151,_0x469088)['allow']){if(pid[_0x4ba9f6])pid[_0x4ba9f6][_0x206eef(0x298)]({'function':_0x206eef(0x362),'args':null});}else logger['full'](_0x206eef(0x1b1));}),_0x346dd7['on'](_0x4d70d2(0x17c),_0x3ef892=>{const _0x4e8d50=_0x4d70d2;if(validateAccess(_0x3ef892,_0x469088)[_0x4e8d50(0x20b)]){if(pid[_0x4ba9f6])pid[_0x4ba9f6]['send']({'function':_0x4e8d50(0x361),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x346dd7['on'](_0x4d70d2(0x1b8),(_0x516609,_0x3aca6e)=>{const _0x15a773=_0x4d70d2;if(validateAccess(_0x3aca6e,_0x469088)['allow']){if(pid[_0x4ba9f6])pid[_0x4ba9f6]['send']({'function':'placeOrder','args':_0x516609});}else logger[_0x15a773(0x275)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x346dd7['on'](_0x4d70d2(0x19d),_0x4474cd=>{const _0x53426b=_0x4d70d2;if(validateAccess(_0x4474cd,_0x469088)['allow']){if(pid[_0x4ba9f6])pid[_0x4ba9f6][_0x53426b(0x298)]({'function':_0x53426b(0x183),'args':null});}else logger[_0x53426b(0x275)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x346dd7['on']('show-config',_0x249626=>{const _0x2befc5=_0x4d70d2;if(validateAccess(_0x249626,_0x469088)[_0x2befc5(0x20b)]){if(pid[_0x4ba9f6])pid[_0x4ba9f6]['send']({'function':_0x2befc5(0x24e),'args':null});}else logger['full'](_0x2befc5(0x2f7));}),_0x346dd7['on'](_0x4d70d2(0x2a5),_0x54eda6=>{const _0x583403=_0x4d70d2;if(validateAccess(_0x54eda6,_0x469088)[_0x583403(0x20b)])updateBB(_0x583403(0x371));else logger['full'](_0x583403(0x2dc));}),_0x346dd7['on'](_0x4d70d2(0x306),_0x5b845f=>{const _0x39bb43=_0x4d70d2;if(validateAccess(_0x5b845f,_0x469088)[_0x39bb43(0x20b)])getMessages();else logger[_0x39bb43(0x275)](_0x39bb43(0x32b));}),_0x346dd7['on']('confirm-message',(_0x3cfc3f,_0x2ea20c)=>{const _0x3c9d26=_0x4d70d2;if(validateAccess(_0x2ea20c,_0x469088)[_0x3c9d26(0x20b)])confirmMessage(_0x3cfc3f);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x346dd7['on']('logout',_0x50ae2d=>{const _0x2d6c72=_0x4d70d2;if(validateAccess(_0x50ae2d,_0x469088)[_0x2d6c72(0x20b)]){if(devices[_0x469088][_0x2d6c72(0x32d)])clearTimeout(devices[_0x469088][_0x2d6c72(0x32d)]);if(devices[_0x469088]['pidExpireLogin'])clearTimeout(devices[_0x469088][_0x2d6c72(0x214)]);removeSocketListeners(getClient(_0x346dd7['id'])[_0x2d6c72(0x1f1)]),addBlacklist(_0x469088),devices[_0x469088][_0x2d6c72(0x1bd)]=null,devices[_0x469088][_0x2d6c72(0x205)]=null,devices[_0x469088][_0x2d6c72(0x313)]['token']=null,logger[_0x2d6c72(0x204)]('Logged\x20out\x20user\x20...'+_0x469088[_0x2d6c72(0x221)](-0x8)),io['to'](getClient(_0x346dd7['id'])[_0x2d6c72(0x1f1)])['emit'](_0x2d6c72(0x356),{'access':{'allow':![],'reason':_0x2d6c72(0x231),'token':null}});}else logger[_0x2d6c72(0x275)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x187e7a){const _0xd158d2=_0x517b6;getClientsWithUuid(_0x187e7a)[_0xd158d2(0x1d6)](_0x207000=>{const _0x1eed34=_0xd158d2;getSocket(_0x207000['id'])[_0x1eed34(0x289)]();});}function cleanSettings(){const _0x2fa5ea=_0x517b6;let _0x5465cd=settings;return settings[_0x2fa5ea(0x23e)]&&settings[_0x2fa5ea(0x23e)]!=''&&(_0x5465cd={..._0x5465cd,'telegramToken':_0x2fa5ea(0x2e0)}),settings[_0x2fa5ea(0x1d0)]&&settings[_0x2fa5ea(0x1d0)]!=''&&(_0x5465cd={..._0x5465cd,'bbPassword':_0x2fa5ea(0x2e0)}),(settings[_0x2fa5ea(0x1d0)]&&settings[_0x2fa5ea(0x1d0)]==_0x2fa5ea(0x22a)||settings[_0x2fa5ea(0x23e)]&&settings['telegramToken']==_0x2fa5ea(0x22a))&&(_0x5465cd={..._0x5465cd,'restored':{'password':settings['bbPassword']==_0x2fa5ea(0x22a),'telegram':settings[_0x2fa5ea(0x23e)]==_0x2fa5ea(0x22a)}}),_0x5465cd;}async function updateBB(_0x10a2bc){const _0x26d45f=_0x517b6;await backupConfigFiles(),installingUpdate=!![],config[_0x26d45f(0x1d6)](_0x128169=>{restartBot(_0x128169['botID']);});if(_0x10a2bc==_0x26d45f(0x371))process[_0x26d45f(0x298)]({'update':!![],'environment':environment},_0x684168=>{});else _0x10a2bc==_0x26d45f(0x2c7)&&process[_0x26d45f(0x298)]({'reinstall':!![],'environment':environment},_0x4ac0cb=>{});}function startBot(_0x4acd97,_0x5bd7da,_0x7ef043){const _0x50d5c9=_0x517b6;if(debugging)_0x4acd97[_0x50d5c9(0x350)]('-d');let _0x3a7032=![];const _0x56fc9f=_0x4acd97[0x0];_0x5bd7da={..._0x5bd7da,'stdio':[_0x50d5c9(0x27e),'inherit',_0x50d5c9(0x27e),_0x50d5c9(0x237)]},pid[_0x56fc9f]=childProcess[_0x50d5c9(0x1e0)](botfile,_0x4acd97,_0x5bd7da),pid[_0x56fc9f]['on'](_0x50d5c9(0x334),_0x5870bb=>{const _0x58a9c0=_0x50d5c9;switch(Object[_0x58a9c0(0x377)](_0x5870bb)[0x0]){case _0x58a9c0(0x180):updateBotName(_0x56fc9f,_0x5870bb['botname']);break;case _0x58a9c0(0x335):updateBotManager();break;case'status':updateStatus(_0x56fc9f,_0x5870bb[_0x58a9c0(0x356)]);break;case'live':updateLive(_0x56fc9f,_0x5870bb[_0x58a9c0(0x349)]);break;case _0x58a9c0(0x225):updateLive(_0x56fc9f,_0x5870bb[_0x58a9c0(0x225)]),io['to'](_0x56fc9f)[_0x58a9c0(0x340)](_0x58a9c0(0x356),{'access':{'allow':![],'reason':_0x58a9c0(0x2e3),'token':null}});break;case _0x58a9c0(0x266):_0x5870bb[_0x58a9c0(0x266)]==_0x58a9c0(0x355)&&restartBot(_0x56fc9f);_0x5870bb[_0x58a9c0(0x266)]==_0x58a9c0(0x2f8)&&toggleBot(_0x56fc9f,_0x58a9c0(0x1d8),_0x58a9c0(0x1c2));break;case _0x58a9c0(0x179):sendTelegramBot(_0x56fc9f,_0x5870bb[_0x58a9c0(0x179)]);break;case _0x58a9c0(0x2eb):sendTelegramMsg(_0x5870bb[_0x58a9c0(0x2eb)]);break;case _0x58a9c0(0x23f):io['to'](_0x56fc9f)[_0x58a9c0(0x340)](_0x5870bb['function'],_0x5870bb['args']);break;}}),pid[_0x56fc9f]['on'](_0x50d5c9(0x374),function(_0x18d890){if(_0x3a7032)return;_0x3a7032=!![],_0x7ef043(_0x18d890);}),pid[_0x56fc9f]['on'](_0x50d5c9(0x1c9),async function(_0x5943a2){const _0x5bcf77=_0x50d5c9;if(terminating)return;if(installingUpdate){logger[_0x5bcf77(0x204)](_0x5bcf77(0x305)),io['close']();return;}if(_0x3a7032)return;_0x3a7032=!![],_0x7ef043(null);const _0x7e3d5e=dbConfig['get']('bots')[_0x5bcf77(0x1bc)]({'botID':_0x56fc9f})[_0x5bcf77(0x217)]();_0x7e3d5e&&(_0x7e3d5e[_0x5bcf77(0x356)]==_0x5bcf77(0x327)||_0x7e3d5e['status']=='new')&&(await sleep(0x3e8),updateLive(_0x56fc9f,_0x5bcf77(0x1c2)),logger[_0x5bcf77(0x275)](_0x5bcf77(0x2ca)+_0x56fc9f),startBot([_0x56fc9f,userID],{'cwd':bbpath},function(_0x1c5c95){const _0x5bd02a=_0x5bcf77;if(_0x1c5c95)logger[_0x5bd02a(0x275)](_0x1c5c95);}));});}function stopBot(_0x3cd387){const _0x690a6c=_0x517b6;getClientsWithBotID(_0x3cd387)[_0x690a6c(0x1d6)](_0x31116e=>{const _0x10635c=_0x690a6c;getSocket(_0x31116e['id'])[_0x10635c(0x29d)](!![]),removeClient(_0x31116e['id']);}),pid[_0x3cd387]&&(pid[_0x3cd387][_0x690a6c(0x2f8)](),pid[_0x3cd387]=null);}function stopAllBots(){terminating=!![];const _0x11adbf=getEnabledBots();_0x11adbf['forEach'](_0x4ea128=>{const _0x2ae26e=_0xa5da;stopBot(_0x4ea128[_0x2ae26e(0x21f)]);});}function restartBot(_0x155dce){if(pid[_0x155dce])pid[_0x155dce]['kill']();}function addBot(){const _0x712ff=_0x517b6;let _0x3f080c;for(let _0x58d2f3=0x1;_0x58d2f3<0x3e9;_0x58d2f3++){_0x3f080c=_0x58d2f3[_0x712ff(0x338)]()[_0x712ff(0x32c)](0x3,'0');let _0x17ced5=config[_0x712ff(0x1bc)](_0x472452=>_0x472452[_0x712ff(0x21f)]==_0x3f080c);if(!_0x17ced5)break;}if(_0x3f080c===_0x712ff(0x345)){logger[_0x712ff(0x275)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x712ff(0x275)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x3f080c),dbConfig[_0x712ff(0x2f6)]('bots')[_0x712ff(0x350)]({'botID':_0x3f080c,'botname':_0x712ff(0x19b)+_0x3f080c,'status':_0x712ff(0x186),'live':''})[_0x712ff(0x260)](),startBot([_0x3f080c,userID],{'cwd':bbpath},function(_0x5af336){const _0x2d82aa=_0x712ff;if(_0x5af336)logger[_0x2d82aa(0x275)](_0x5af336);}),config=getConfiguration(),io['to']('botmanager')[_0x712ff(0x340)](_0x712ff(0x2b2),config),broadcastToBots(_0x712ff(0x2b2),JSON['stringify'](config));}function deleteBot(_0x3ef56e){const _0x5310aa=_0x517b6;getClientsWithBotID(_0x3ef56e)['forEach'](_0xc42f2d=>{const _0x33ead3=_0xa5da;getSocket(_0xc42f2d['id'])[_0x33ead3(0x29d)](!![]),removeClient(_0xc42f2d['id']);}),dbConfig[_0x5310aa(0x2f6)](_0x5310aa(0x2b2))['remove']({'botID':_0x3ef56e})['write'](),logger['full'](_0x5310aa(0x1fe)+_0x3ef56e),stopBot(_0x3ef56e);try{if(fs[_0x5310aa(0x1dc)](path[_0x5310aa(0x2a6)](configpath,'bot-'+_0x3ef56e+_0x5310aa(0x287))))fs[_0x5310aa(0x20a)](path[_0x5310aa(0x2a6)](configpath,_0x5310aa(0x22f)+_0x3ef56e+_0x5310aa(0x287)));if(fs['existsSync'](path['join'](configpath,'bot-'+_0x3ef56e+'-events.json')))fs['unlinkSync'](path[_0x5310aa(0x2a6)](configpath,'bot-'+_0x3ef56e+'-events.json'));if(fs[_0x5310aa(0x1dc)](path[_0x5310aa(0x2a6)](configpath,_0x5310aa(0x22f)+_0x3ef56e+'-performance.json')))fs[_0x5310aa(0x20a)](path['join'](configpath,_0x5310aa(0x22f)+_0x3ef56e+_0x5310aa(0x1a4)));if(fs[_0x5310aa(0x1dc)](path[_0x5310aa(0x2a6)](configpath,'bot-'+_0x3ef56e+_0x5310aa(0x234))))fs[_0x5310aa(0x20a)](path['join'](configpath,_0x5310aa(0x22f)+_0x3ef56e+_0x5310aa(0x234)));}catch(_0x536b66){if(_0x536b66)logger['full'](_0x5310aa(0x250),_0x536b66);}config=getConfiguration(),io['to'](_0x5310aa(0x364))[_0x5310aa(0x340)](_0x5310aa(0x2b2),config),broadcastToBots(_0x5310aa(0x2b2),JSON[_0x5310aa(0x324)](config));}function toggleBot(_0x58959c,_0x5a1641,_0x38a5c0){const _0xcd5d29=_0x517b6;dbConfig[_0xcd5d29(0x2f6)](_0xcd5d29(0x2b2))[_0xcd5d29(0x1bc)]({'botID':_0x58959c})[_0xcd5d29(0x25f)]({'status':_0x5a1641})[_0xcd5d29(0x25f)]({'live':_0x38a5c0})[_0xcd5d29(0x260)]();if(_0x5a1641==_0xcd5d29(0x327)||_0x5a1641==_0xcd5d29(0x186))logger['full'](_0xcd5d29(0x21e)+_0x58959c),startBot([_0x58959c,userID],{'cwd':bbpath},function(_0x18f25b){const _0x1d4acf=_0xcd5d29;if(_0x18f25b)logger[_0x1d4acf(0x275)](_0x18f25b);});else(_0x5a1641==_0xcd5d29(0x1d8)||_0x5a1641=='new-disabled')&&(logger['full'](_0xcd5d29(0x242)+_0x58959c),stopBot(_0x58959c));config=getConfiguration(),io['to']('botmanager')[_0xcd5d29(0x340)](_0xcd5d29(0x2b2),config),broadcastToBots('bots',JSON[_0xcd5d29(0x324)](config));}function toggleStatus(_0x5f23b3){const _0x49e0b0=_0x517b6;let _0xc6ffa1=dbConfig[_0x49e0b0(0x2f6)](_0x49e0b0(0x2b2))[_0x49e0b0(0x1bc)]({'botID':_0x5f23b3})[_0x49e0b0(0x217)](),_0x1f07a1;if(_0xc6ffa1[_0x49e0b0(0x356)]===_0x49e0b0(0x327))_0x1f07a1=_0x49e0b0(0x1d8);else{if(_0xc6ffa1['status']==='new')_0x1f07a1=_0x49e0b0(0x370);else{if(_0xc6ffa1[_0x49e0b0(0x356)]===_0x49e0b0(0x370))_0x1f07a1=_0x49e0b0(0x186);else{if(_0xc6ffa1[_0x49e0b0(0x356)]===_0x49e0b0(0x1d8))_0x1f07a1=_0x49e0b0(0x327);}}}return _0x1f07a1;}function updateStatus(_0x4036c,_0x803f16){const _0x12f331=_0x517b6;dbConfig['get'](_0x12f331(0x2b2))[_0x12f331(0x1bc)]({'botID':_0x4036c})[_0x12f331(0x25f)]({'status':_0x803f16})['write'](),config=getConfiguration(),io['to'](_0x12f331(0x364))[_0x12f331(0x340)](_0x12f331(0x2b2),config),broadcastToBots(_0x12f331(0x2b2),JSON[_0x12f331(0x324)](config));}function updateLive(_0x455ecb,_0xad1af6){const _0x67011b=_0x517b6;dbConfig[_0x67011b(0x2f6)](_0x67011b(0x2b2))[_0x67011b(0x1bc)]({'botID':_0x455ecb})[_0x67011b(0x25f)]({'live':_0xad1af6})[_0x67011b(0x260)](),config=getConfiguration(),io['to'](_0x67011b(0x364))[_0x67011b(0x340)](_0x67011b(0x2b2),config),broadcastToBots('bots',JSON[_0x67011b(0x324)](config));}function updateBotName(_0x4a53f4,_0x361612){const _0x369cad=_0x517b6;dbConfig['get'](_0x369cad(0x2b2))[_0x369cad(0x1bc)]({'botID':_0x4a53f4})[_0x369cad(0x25f)]({'botname':_0x361612})[_0x369cad(0x260)](),config=getConfiguration(),io['to'](_0x369cad(0x364))[_0x369cad(0x340)](_0x369cad(0x2b2),config),broadcastToBots(_0x369cad(0x2b2),JSON[_0x369cad(0x324)](config));}function updateBotManager(){const _0x3438a6=_0x517b6;config=getConfiguration(),io['to'](_0x3438a6(0x364))[_0x3438a6(0x340)](_0x3438a6(0x2b2),config),broadcastToBots(_0x3438a6(0x2b2),JSON['stringify'](config));}function toggleBotMode(_0x591cee){const _0x12f7d1=_0x517b6;if(pid[_0x591cee])pid[_0x591cee]['send']({'function':'toggleBotMode','args':null});else{const _0x3ce052=configpath+_0x12f7d1(0x22f)+_0x591cee+'-config.json',_0x15aa4a=fs['readFileSync'](_0x3ce052),_0x466f94=JSON['parse'](_0x15aa4a),_0x3f2104=_0x466f94['bot'][0x0][_0x12f7d1(0x270)];_0x466f94[_0x12f7d1(0x2a1)][0x0][_0x12f7d1(0x270)]=!_0x3f2104;const _0x1da0d4=JSON[_0x12f7d1(0x324)](_0x466f94,null,0x2);fs[_0x12f7d1(0x32a)](_0x3ce052,_0x1da0d4),config=getConfiguration(),io['to'](_0x12f7d1(0x364))[_0x12f7d1(0x340)](_0x12f7d1(0x2b2),config),broadcastToBots(_0x12f7d1(0x2b2),JSON['stringify'](config));}}function validateTelegram(_0x512874){const _0x260dc6=_0x517b6;if(_0x512874[_0x260dc6(0x27d)][_0x260dc6(0x2a7)]!=settings['telegramUsername']&&'@'+_0x512874[_0x260dc6(0x27d)][_0x260dc6(0x2a7)]!=settings[_0x260dc6(0x2c2)]||_0x512874[_0x260dc6(0x28f)]['id']!=settings[_0x260dc6(0x1ed)])return sendTelegram(_0x512874['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x260dc6(0x2ee)}),![];return!![];}async function initTelegram(){const _0x2b0839=_0x517b6;if(tgBot)tgBot[_0x2b0839(0x266)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x222b28=_0x2b0839(0x1ea);_0x222b28+='\x0a',_0x222b28+=_0x2b0839(0x1cd),_0x222b28+=_0x2b0839(0x1e6),_0x222b28+=_0x2b0839(0x2e2),_0x222b28+=_0x2b0839(0x1e5),_0x222b28+=_0x2b0839(0x35f),_0x222b28+=_0x2b0839(0x1e4),_0x222b28+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x222b28+=_0x2b0839(0x1d2),_0x222b28+=_0x2b0839(0x25a),_0x222b28+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x222b28+=_0x2b0839(0x1a9),_0x222b28+=_0x2b0839(0x2cd),_0x222b28+=_0x2b0839(0x2af),_0x222b28+=_0x2b0839(0x373);let _0xad5c8b=_0x2b0839(0x264);_0xad5c8b+='\x0a',_0xad5c8b+=_0x222b28,tgBot[_0x2b0839(0x34e)]((_0x679ed,_0x2d0a7d)=>{const _0x48cb5e=_0x2b0839;logger[_0x48cb5e(0x1d7)](getTimeStamp()+_0x48cb5e(0x325)),logger[_0x48cb5e(0x204)](_0x48cb5e(0x1cb),_0x679ed);}),tgBot[_0x2b0839(0x1b3)](async(_0x2b4e0f,_0x119e22)=>{const _0x48d641=_0x2b0839;if(!(!settings[_0x48d641(0x1ed)]&&_0x2b4e0f[_0x48d641(0x371)][_0x48d641(0x334)]['text']=='/start')){if(!validateTelegram(_0x2b4e0f))return;}_0x119e22();}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x2fe),async _0x57cf5b=>{const _0x121d85=_0x2b0839;if(!settings[_0x121d85(0x1ed)])updateSetting(_0x121d85(0x1ed),_0x57cf5b[_0x121d85(0x28f)]['id']);updateSetting(_0x121d85(0x177),!![]);if(!validateTelegram(_0x57cf5b))return;await sendTelegram(_0x57cf5b[_0x121d85(0x28f)]['id'],_0xad5c8b);}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x31c),async _0x3510d5=>{const _0x4cd273=_0x2b0839;updateSetting(_0x4cd273(0x177),!![]),await sendTelegram(_0x3510d5['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x26b),async _0x958055=>{const _0x2719c1=_0x2b0839;await sendTelegram(_0x958055[_0x2719c1(0x28f)]['id'],_0x2719c1(0x23d)),updateSetting('telegramEnabled',![]);}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x25e),async _0x4260f2=>{const _0x5b3486=_0x2b0839,_0x1b3eb6=Markup[_0x5b3486(0x1df)]([Markup[_0x5b3486(0x1a6)][_0x5b3486(0x36b)](_0x5b3486(0x2d0),_0x5b3486(0x344)),Markup[_0x5b3486(0x1a6)][_0x5b3486(0x36b)](_0x5b3486(0x20f),_0x5b3486(0x2b6)),Markup[_0x5b3486(0x1a6)][_0x5b3486(0x36b)](_0x5b3486(0x2c4),_0x5b3486(0x2fc))]);_0x4260f2[_0x5b3486(0x2f4)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x1b3eb6);}),tgBot[_0x2b0839(0x273)]('config_orders',async _0x1b5f75=>{const _0x349f1c=_0x2b0839;_0x1b5f75[_0x349f1c(0x24b)](),updateSetting(_0x349f1c(0x311),_0x349f1c(0x368)),updateSetting(_0x349f1c(0x177),!![]),await sendTelegram(_0x1b5f75['chat']['id'],_0x349f1c(0x343));}),tgBot[_0x2b0839(0x273)](_0x2b0839(0x2b6),async _0x1c7aa1=>{const _0x22fc9e=_0x2b0839;_0x1c7aa1[_0x22fc9e(0x24b)](),updateSetting(_0x22fc9e(0x311),_0x22fc9e(0x24c)),updateSetting(_0x22fc9e(0x177),!![]),await sendTelegram(_0x1c7aa1[_0x22fc9e(0x28f)]['id'],_0x22fc9e(0x178));}),tgBot[_0x2b0839(0x273)](_0x2b0839(0x2fc),async _0x598145=>{const _0x47d790=_0x2b0839;_0x598145['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x47d790(0x175)),updateSetting(_0x47d790(0x177),!![]),await sendTelegram(_0x598145[_0x47d790(0x28f)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x2b0839(0x196)]('status',async _0x36aa07=>{const _0x5e3761=_0x2b0839,_0x37c60d=getBotsWithMode();let _0x5d57c3=_0x5e3761(0x2c3);config[_0x5e3761(0x1d6)](_0x3f3836=>{const _0xdddba5=_0x5e3761,_0x5d83bd=_0x37c60d['find'](_0x2a6e72=>_0x2a6e72[_0xdddba5(0x21f)]==_0x3f3836[_0xdddba5(0x21f)])[_0xdddba5(0x30a)];_0x5d57c3+=_0xdddba5(0x19b)+_0x3f3836[_0xdddba5(0x21f)]+':\x20'+_0x3f3836[_0xdddba5(0x356)]+_0xdddba5(0x248)+_0x5d83bd+'\x20|\x20'+_0x3f3836[_0xdddba5(0x349)]+'\x0a';}),_0x5d57c3+='\x0a',_0x5d57c3+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x5d57c3+=!settings[_0x5e3761(0x177)]?_0x5e3761(0x2d2):'Notifications\x20enabled\x0a',_0x5d57c3+=settings[_0x5e3761(0x177)]?settings[_0x5e3761(0x311)]==_0x5e3761(0x175)?_0x5e3761(0x31b):_0x5e3761(0x26d)+settings[_0x5e3761(0x311)]+'\x20only\x0a':'',await sendTelegram(_0x36aa07[_0x5e3761(0x28f)]['id'],_0x5d57c3,{'parse_mode':_0x5e3761(0x2ee)});}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x355),async _0x451061=>{const _0x1e0adf=_0x2b0839,_0x1eacf5=getEnabledBots();if(_0x1eacf5[_0x1e0adf(0x236)]==0x0)await sendTelegram(_0x451061[_0x1e0adf(0x28f)]['id'],_0x1e0adf(0x28d));else{if(_0x1eacf5[_0x1e0adf(0x236)]>0x1)_0x1eacf5[_0x1e0adf(0x350)]({'botID':'all'});let _0x49caf2=[],_0x8ec759=[];const _0x193c33=_0x1eacf5['length']%0x4==0x0||_0x1eacf5[_0x1e0adf(0x236)]%0x4==0x3||_0x1eacf5[_0x1e0adf(0x236)]%0x3==0x1?0x4:0x3;let _0x55aa6b=0x0;_0x1eacf5[_0x1e0adf(0x1d6)]((_0x549738,_0x11f035)=>{const _0x356483=_0x1e0adf;if(_0x11f035%_0x193c33==0x0)_0x8ec759=[];_0x8ec759['push'](Markup[_0x356483(0x1a6)]['callback'](_0x549738[_0x356483(0x21f)]==_0x356483(0x175)?'All\x20bots':_0x356483(0x19b)+_0x549738[_0x356483(0x21f)],_0x356483(0x272)+_0x549738[_0x356483(0x21f)])),_0x11f035%_0x193c33==0x0&&(_0x49caf2[_0x55aa6b]=_0x8ec759,_0x55aa6b++);});const _0x3d6eb1=Markup[_0x1e0adf(0x1df)](_0x49caf2);_0x451061[_0x1e0adf(0x2f4)](_0x1e0adf(0x2d4),_0x3d6eb1);}}),tgBot[_0x2b0839(0x273)](/restart_(.+)/,async _0x426130=>{const _0x281abe=_0x2b0839,_0x58ac24=_0x426130[_0x281abe(0x1cc)][0x1];_0x426130[_0x281abe(0x24b)](),_0x58ac24=='all'?config['forEach'](_0x3ac36f=>{const _0x251d19=_0x281abe;restartBot(_0x3ac36f[_0x251d19(0x21f)]);}):restartBot(_0x58ac24);}),tgBot[_0x2b0839(0x196)]('on',async _0x1e932b=>{const _0x333e3c=_0x2b0839,_0x552660=getDisabledBots();if(_0x552660[_0x333e3c(0x236)]==0x0)await sendTelegram(_0x1e932b[_0x333e3c(0x28f)]['id'],_0x333e3c(0x379));else{if(_0x552660[_0x333e3c(0x236)]>0x1)_0x552660[_0x333e3c(0x350)]({'botID':_0x333e3c(0x175)});let _0x2fc627=[],_0x1f9fc7=[];const _0x3b816b=_0x552660[_0x333e3c(0x236)]%0x4==0x0||_0x552660[_0x333e3c(0x236)]%0x4==0x3||_0x552660['length']%0x3==0x1?0x4:0x3;let _0x515ed7=0x0;_0x552660[_0x333e3c(0x1d6)]((_0x1b2e95,_0x435270)=>{const _0x51ea13=_0x333e3c;if(_0x435270%_0x3b816b==0x0)_0x1f9fc7=[];_0x1f9fc7['push'](Markup[_0x51ea13(0x1a6)][_0x51ea13(0x36b)](_0x1b2e95[_0x51ea13(0x21f)]==_0x51ea13(0x175)?_0x51ea13(0x375):_0x51ea13(0x19b)+_0x1b2e95[_0x51ea13(0x21f)],_0x51ea13(0x27f)+_0x1b2e95[_0x51ea13(0x21f)])),_0x435270%_0x3b816b==0x0&&(_0x2fc627[_0x515ed7]=_0x1f9fc7,_0x515ed7++);});const _0x513bf3=Markup['inlineKeyboard'](_0x2fc627);_0x1e932b[_0x333e3c(0x2f4)](_0x333e3c(0x20e),_0x513bf3);}}),tgBot[_0x2b0839(0x273)](/on_(.+)/,async _0x3c0c92=>{const _0x390438=_0x2b0839,_0x1a810f=_0x3c0c92[_0x390438(0x1cc)][0x1];_0x3c0c92[_0x390438(0x24b)]();if(_0x1a810f==_0x390438(0x175)){const _0x5dbcd8=getDisabledBots();await sendTelegram(_0x3c0c92[_0x390438(0x28f)]['id'],_0x390438(0x1ce)),_0x5dbcd8[_0x390438(0x1d6)](_0x271045=>{const _0x29226c=_0x390438;if(_0x271045[_0x29226c(0x21f)]!=_0x29226c(0x175))toggleBot(_0x271045[_0x29226c(0x21f)],toggleStatus(_0x271045[_0x29226c(0x21f)]),_0x29226c(0x1c2));});}else await sendTelegram(_0x3c0c92['chat']['id'],_0x390438(0x220)+_0x1a810f),toggleBot(_0x1a810f,toggleStatus(_0x1a810f),_0x390438(0x1c2));}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x351),async _0xbbc7cf=>{const _0x82aad1=_0x2b0839,_0x10c667=getEnabledBots();if(_0x10c667['length']==0x0)await sendTelegram(_0xbbc7cf[_0x82aad1(0x28f)]['id'],_0x82aad1(0x28d));else{if(_0x10c667[_0x82aad1(0x236)]>0x1)_0x10c667[_0x82aad1(0x350)]({'botID':'all'});let _0x56dede=[],_0xf44c47=[];const _0x4cfa82=_0x10c667[_0x82aad1(0x236)]%0x4==0x0||_0x10c667[_0x82aad1(0x236)]%0x4==0x3||_0x10c667[_0x82aad1(0x236)]%0x3==0x1?0x4:0x3;let _0x5b5002=0x0;_0x10c667[_0x82aad1(0x1d6)]((_0x46f3f2,_0x9b613f)=>{const _0x22d34b=_0x82aad1;if(_0x9b613f%_0x4cfa82==0x0)_0xf44c47=[];_0xf44c47[_0x22d34b(0x350)](Markup['button'][_0x22d34b(0x36b)](_0x46f3f2['botID']==_0x22d34b(0x175)?_0x22d34b(0x375):_0x22d34b(0x19b)+_0x46f3f2['botID'],'off_'+_0x46f3f2[_0x22d34b(0x21f)])),_0x9b613f%_0x4cfa82==0x0&&(_0x56dede[_0x5b5002]=_0xf44c47,_0x5b5002++);});const _0x14bf51=Markup['inlineKeyboard'](_0x56dede);_0xbbc7cf[_0x82aad1(0x2f4)](_0x82aad1(0x2d9),_0x14bf51);}}),tgBot[_0x2b0839(0x273)](/off_(.+)/,async _0x4a13a4=>{const _0x153d80=_0x2b0839,_0xbb9a37=_0x4a13a4[_0x153d80(0x1cc)][0x1];_0x4a13a4[_0x153d80(0x24b)]();if(_0xbb9a37==_0x153d80(0x175)){const _0x4cc449=getEnabledBots();await sendTelegram(_0x4a13a4['chat']['id'],_0x153d80(0x1f5)),_0x4cc449['forEach'](_0x2fe9a6=>{const _0xcd0cdf=_0x153d80;if(_0x2fe9a6[_0xcd0cdf(0x21f)]!='all')toggleBot(_0x2fe9a6[_0xcd0cdf(0x21f)],toggleStatus(_0x2fe9a6[_0xcd0cdf(0x21f)]),_0xcd0cdf(0x1c2));});}else await sendTelegram(_0x4a13a4[_0x153d80(0x28f)]['id'],_0x153d80(0x2a8)+_0xbb9a37),toggleBot(_0xbb9a37,toggleStatus(_0xbb9a37),_0x153d80(0x1c2));}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x2b7),async _0x3e3331=>{const _0x24bb17=_0x2b0839,_0x3b791b=getEnabledBots();if(_0x3b791b[_0x24bb17(0x236)]==0x0)await sendTelegram(_0x3e3331[_0x24bb17(0x28f)]['id'],_0x24bb17(0x28d));else{if(_0x3b791b[_0x24bb17(0x236)]>0x1){let _0x28fd4c=[],_0x5949f8=[];const _0x2a17ed=_0x3b791b['length']%0x4==0x0||_0x3b791b[_0x24bb17(0x236)]%0x4==0x3||_0x3b791b[_0x24bb17(0x236)]%0x3==0x1?0x4:0x3;let _0x1bdb0b=0x0;_0x3b791b['forEach']((_0x5bc1ba,_0x5f2c36)=>{const _0x244c62=_0x24bb17;if(_0x5f2c36%_0x2a17ed==0x0)_0x5949f8=[];_0x5949f8['push'](Markup[_0x244c62(0x1a6)]['callback'](_0x244c62(0x19b)+_0x5bc1ba['botID'],'metrics_'+_0x5bc1ba[_0x244c62(0x21f)])),_0x5f2c36%_0x2a17ed==0x0&&(_0x28fd4c[_0x1bdb0b]=_0x5949f8,_0x1bdb0b++);});const _0x2dae29=Markup[_0x24bb17(0x1df)](_0x28fd4c);_0x3e3331[_0x24bb17(0x2f4)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x2dae29);}else{const _0x17a566=_0x3b791b[0x0][_0x24bb17(0x21f)];if(pid[_0x17a566])pid[_0x17a566][_0x24bb17(0x298)]({'function':_0x24bb17(0x20c),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0xf5d87c=>{const _0x5d5c1e=_0x2b0839,_0x404ce0=_0xf5d87c['match'][0x1];_0xf5d87c['editMessageReplyMarkup']();if(pid[_0x404ce0])pid[_0x404ce0]['send']({'function':_0x5d5c1e(0x20c),'args':null});}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x18b),async _0x22777c=>{const _0x1462eb=_0x2b0839,_0x5972b0=getEnabledBots();if(_0x5972b0[_0x1462eb(0x236)]==0x0)await sendTelegram(_0x22777c['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x5972b0[_0x1462eb(0x236)]>0x1){let _0x40147e=[],_0x4cc0c8=[];const _0x403386=_0x5972b0['length']%0x4==0x0||_0x5972b0[_0x1462eb(0x236)]%0x4==0x3||_0x5972b0[_0x1462eb(0x236)]%0x3==0x1?0x4:0x3;let _0x5af47d=0x0;_0x5972b0[_0x1462eb(0x1d6)]((_0x47c68a,_0x1460dd)=>{const _0x3b2a98=_0x1462eb;if(_0x1460dd%_0x403386==0x0)_0x4cc0c8=[];_0x4cc0c8[_0x3b2a98(0x350)](Markup[_0x3b2a98(0x1a6)][_0x3b2a98(0x36b)]('Bot\x20'+_0x47c68a[_0x3b2a98(0x21f)],_0x3b2a98(0x342)+_0x47c68a['botID'])),_0x1460dd%_0x403386==0x0&&(_0x40147e[_0x5af47d]=_0x4cc0c8,_0x5af47d++);});const _0x4ddbca=Markup[_0x1462eb(0x1df)](_0x40147e);_0x22777c['reply'](_0x1462eb(0x301),_0x4ddbca);}else{const _0x334582=_0x5972b0[0x0][_0x1462eb(0x21f)];if(pid[_0x334582])pid[_0x334582][_0x1462eb(0x298)]({'function':_0x1462eb(0x189),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x4617b4=>{const _0x21562f=_0x2b0839,_0x431d4b=_0x4617b4['match'][0x1];_0x4617b4[_0x21562f(0x24b)]();if(pid[_0x431d4b])pid[_0x431d4b][_0x21562f(0x298)]({'function':_0x21562f(0x189),'args':null});}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x371),async _0x2b604e=>{const _0x475182=_0x2b0839;await getMessages();if(!updateAvailable)await sendTelegram(_0x2b604e[_0x475182(0x28f)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x2b604e[_0x475182(0x28f)]['id'],_0x475182(0x229));else{const _0x265a2c=Markup['inlineKeyboard']([Markup[_0x475182(0x1a6)][_0x475182(0x36b)](_0x475182(0x1fa),_0x475182(0x249)),Markup[_0x475182(0x1a6)][_0x475182(0x36b)]('No',_0x475182(0x2ba))]);_0x2b604e[_0x475182(0x2f4)](_0x475182(0x258),_0x265a2c);}}}),tgBot['action'](/update_(.+)/,async _0x1c35a8=>{const _0x44771e=_0x2b0839,_0x29866a=_0x1c35a8[_0x44771e(0x1cc)][0x1];_0x1c35a8[_0x44771e(0x24b)](),_0x29866a=='yes'&&(await sendTelegram(_0x1c35a8[_0x44771e(0x28f)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x44771e(0x371))),_0x29866a=='no'&&await sendTelegram(_0x1c35a8[_0x44771e(0x28f)]['id'],_0x44771e(0x25d));}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x2c7),async _0x4c9075=>{const _0x424c9a=_0x2b0839;if(!validInstallation)await sendTelegram(_0x4c9075[_0x424c9a(0x28f)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x50d3fe=Markup[_0x424c9a(0x1df)]([Markup['button'][_0x424c9a(0x36b)](_0x424c9a(0x1fa),'reinstall_yes'),Markup[_0x424c9a(0x1a6)][_0x424c9a(0x36b)]('No',_0x424c9a(0x326))]);_0x4c9075[_0x424c9a(0x2f4)](_0x424c9a(0x278),_0x50d3fe);}}),tgBot[_0x2b0839(0x273)](/reinstall_(.+)/,async _0x4dd9c6=>{const _0x59d17e=_0x2b0839,_0x52b31b=_0x4dd9c6[_0x59d17e(0x1cc)][0x1];_0x4dd9c6['editMessageReplyMarkup'](),_0x52b31b==_0x59d17e(0x309)&&(await sendTelegram(_0x4dd9c6[_0x59d17e(0x28f)]['id'],_0x59d17e(0x251)),updateBB(_0x59d17e(0x2c7))),_0x52b31b=='no'&&await sendTelegram(_0x4dd9c6['chat']['id'],_0x59d17e(0x1ba));}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x2db),async _0x2e59ab=>{const _0x1c6884=_0x2b0839,_0x5b677e=getBotsWithMode();if(_0x5b677e['length']==0x0)await sendTelegram(_0x2e59ab[_0x1c6884(0x28f)]['id'],_0x1c6884(0x28d));else{let _0xa31deb=[],_0x318212=[];const _0x344592=0x2;let _0x1de462=0x0;_0x5b677e[_0x1c6884(0x1d6)]((_0x66ac42,_0x5d544f)=>{const _0x1c03a6=_0x1c6884;if(_0x5d544f%_0x344592==0x0)_0x318212=[];_0x318212[_0x1c03a6(0x350)](Markup[_0x1c03a6(0x1a6)]['callback'](_0x1c03a6(0x19b)+_0x66ac42[_0x1c03a6(0x21f)]+'\x20('+_0x66ac42[_0x1c03a6(0x30a)]+')','toggle_'+_0x66ac42[_0x1c03a6(0x21f)])),_0x5d544f%_0x344592==0x0&&(_0xa31deb[_0x1de462]=_0x318212,_0x1de462++);});const _0x5806f7=Markup[_0x1c6884(0x1df)](_0xa31deb);_0x2e59ab['reply'](_0x1c6884(0x36c),_0x5806f7);}}),tgBot[_0x2b0839(0x273)](/toggle_(.+)/,async _0x31806e=>{const _0x1f0b4d=_0x2b0839,_0x3bbe60=_0x31806e[_0x1f0b4d(0x1cc)][0x1];_0x31806e[_0x1f0b4d(0x24b)]();const _0x5da042=getBotsWithMode(),_0x2a5737=_0x5da042[_0x1f0b4d(0x1bc)](_0x21f166=>_0x21f166['botID']==_0x3bbe60),_0x1b7749=_0x2a5737[_0x1f0b4d(0x30a)]=='auto'?_0x1f0b4d(0x2de):_0x1f0b4d(0x1c1);await sendTelegram(_0x31806e[_0x1f0b4d(0x28f)]['id'],_0x1f0b4d(0x295)+_0x3bbe60+_0x1f0b4d(0x31f)+_0x1b7749+_0x1f0b4d(0x26a)),toggleBotMode(_0x3bbe60);}),tgBot['command'](_0x2b0839(0x1db),async _0x15c9af=>{const _0x5d7a8e=_0x2b0839;let _0x55a06b='';config['forEach'](_0x5dba26=>{const _0x35a28a=_0xa5da;_0x55a06b+=_0x35a28a(0x19b)+_0x5dba26[_0x35a28a(0x21f)]+':\x20'+_0x5dba26[_0x35a28a(0x180)]+'\x0a';}),await sendTelegram(_0x15c9af[_0x5d7a8e(0x28f)]['id'],_0x55a06b,{'parse_mode':'HTML'});}),tgBot[_0x2b0839(0x196)](_0x2b0839(0x352),async _0x4bc081=>{const _0x2b0758=_0x2b0839;await sendTelegram(_0x4bc081[_0x2b0758(0x28f)]['id'],_0x222b28);}),process['once'](_0x2b0839(0x30e),()=>tgBot[_0x2b0839(0x266)](_0x2b0839(0x30e))),process[_0x2b0839(0x17d)](_0x2b0839(0x27b),()=>tgBot['stop'](_0x2b0839(0x27b))),tgBot[_0x2b0839(0x24a)]();}}function disableTelegram(){const _0x1d1b94=_0x517b6;tgBot&&tgBot[_0x1d1b94(0x266)]();}async function sendTelegram(_0x12c38d,_0x227ce7,_0x2e1931){const _0x4580a4=_0x517b6;try{await tgBot[_0x4580a4(0x179)][_0x4580a4(0x1d3)](_0x12c38d,_0x227ce7,_0x2e1931);}catch(_0x2be23c){console['log'](_0x4580a4(0x246),_0x2be23c);}}async function sendTelegramBot(_0xeb6fff,_0x5e7a20){const _0xbf134c=_0x517b6;if(settings[_0xbf134c(0x177)]){if(settings[_0xbf134c(0x311)]==_0xbf134c(0x175)||(_0x5e7a20[_0xbf134c(0x228)]==_0xbf134c(0x374)||_0x5e7a20['type']=='warning'||_0x5e7a20[_0xbf134c(0x228)]==_0xbf134c(0x200))&&settings[_0xbf134c(0x311)]==_0xbf134c(0x24c)||_0x5e7a20[_0xbf134c(0x228)]=='order'&&settings[_0xbf134c(0x311)]==_0xbf134c(0x368)){if(tgBot&&settings[_0xbf134c(0x1ed)]){if(_0x5e7a20[_0xbf134c(0x341)])await sendTelegram(settings['telegramChatId'],_0x5e7a20['botname']+_0xbf134c(0x292)+_0x5e7a20['event']);else await sendTelegram(settings[_0xbf134c(0x1ed)],'Bot\x20'+_0xeb6fff+'\x20>\x20'+_0x5e7a20[_0xbf134c(0x1f3)]);}}}}async function sendTelegramMsg(_0x3f3447,_0x5e5c2a=_0x517b6(0x2ee)){const _0x440fda=_0x517b6;return settings['telegramEnabled']&&tgBot&&settings[_0x440fda(0x1ed)]?(await sendTelegram(settings[_0x440fda(0x1ed)],_0x3f3447,{'parse_mode':_0x5e5c2a}),!![]):![];}function getDeviceWithIp(_0x2ad32c){return devices['find'](_0xefd681=>_0xefd681['ip']===_0x2ad32c);}async function temporaryAccess2FA(_0x1dd71c,_0x1416e4){const _0x2bbba3=_0x517b6;let _0x302f97=new Date(),_0xdff9b4=![];if(lastIpApproval){if(_0x302f97-lastIpApproval<0x1388)_0xdff9b4=!![];}lastIpApproval=new Date();if(_0xdff9b4)return;if(tgBot&&settings[_0x2bbba3(0x1ed)]){const _0x5946ed=uuidRandom();tmpStorage[_0x5946ed]={'uuid':_0x1dd71c,'externalip':_0x1416e4};const _0x58989b=Markup['inlineKeyboard']([Markup[_0x2bbba3(0x1a6)][_0x2bbba3(0x36b)](_0x2bbba3(0x1f9),_0x2bbba3(0x1ae)+_0x5946ed),Markup['button'][_0x2bbba3(0x36b)](_0x2bbba3(0x1b7),_0x2bbba3(0x290)+_0x5946ed),Markup[_0x2bbba3(0x1a6)][_0x2bbba3(0x36b)](_0x2bbba3(0x184),'tempaccess_30_'+_0x5946ed),Markup[_0x2bbba3(0x1a6)][_0x2bbba3(0x36b)](_0x2bbba3(0x1f7),'tempaccess_reject_'+_0x5946ed)]);await sendTelegram(settings[_0x2bbba3(0x1ed)],_0x2bbba3(0x358)+normalizeIP(_0x1416e4)[_0x2bbba3(0x29b)]+'\x20?',_0x58989b),tgBot[_0x2bbba3(0x273)](/tempaccess_(.+)_(.+)/,async _0x2b6fe3=>{const _0x5ba7c8=_0x2bbba3,_0x599e5b=_0x2b6fe3[_0x5ba7c8(0x1cc)][0x1],_0x291a3f=_0x2b6fe3[_0x5ba7c8(0x1cc)][0x2],{uuid:_0x14d57b,externalip:_0x1f9ee9}=tmpStorage[_0x291a3f];delete tmpStorage[_0x291a3f],_0x2b6fe3[_0x5ba7c8(0x24b)](),devices[_0x14d57b][_0x5ba7c8(0x1bd)]={'clientip':_0x1f9ee9,'timestamp':new Date()[_0x5ba7c8(0x28a)](),'expiry':_0x599e5b},_0x599e5b!='reject'?(await sendTelegram(_0x2b6fe3['chat']['id'],_0x5ba7c8(0x26c)+_0x599e5b+'\x20minutes',{'parse_mode':_0x5ba7c8(0x2ee)}),io['to'](_0x14d57b)[_0x5ba7c8(0x340)](_0x5ba7c8(0x356),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x2b6fe3[_0x5ba7c8(0x28f)]['id'],_0x5ba7c8(0x279)),io['to'](_0x14d57b)[_0x5ba7c8(0x340)](_0x5ba7c8(0x356),{'access':{'allow':![],'reason':_0x5ba7c8(0x1af),'token':null}}));});}}async function loginAccess2FA(_0x5384a6,_0x53018c){const _0x2e89bf=_0x517b6;if(tgBot&&settings[_0x2e89bf(0x1ed)]){const _0x296f2e=uuidRandom();tmpStorage[_0x296f2e]={'uuid':_0x5384a6,'externalip':_0x53018c};const _0xd8bc16=Markup[_0x2e89bf(0x1df)]([Markup[_0x2e89bf(0x1a6)][_0x2e89bf(0x36b)](_0x2e89bf(0x314),_0x2e89bf(0x203)+loginExpiry+'_'+_0x296f2e),Markup[_0x2e89bf(0x1a6)][_0x2e89bf(0x36b)]('reject',_0x2e89bf(0x2b9)+_0x296f2e)]);await sendTelegram(settings['telegramChatId'],_0x2e89bf(0x288)+normalizeIP(_0x53018c)[_0x2e89bf(0x29b)]+'\x20?',_0xd8bc16),tgBot[_0x2e89bf(0x273)](/login2fa_(.+)_(.+)/,async _0x55a75a=>{const _0xeb56fc=_0x2e89bf,_0x3e20cf=_0x55a75a[_0xeb56fc(0x1cc)][0x1],_0x40bcb7=_0x55a75a[_0xeb56fc(0x1cc)][0x2],{uuid:_0x4f7770,externalip:_0x3147cb}=tmpStorage[_0x40bcb7];delete tmpStorage[_0x40bcb7],_0x55a75a[_0xeb56fc(0x24b)](),devices[_0x4f7770][_0xeb56fc(0x205)]={'clientip':_0x3147cb,'timestamp':new Date()['getTime'](),'expiry':_0x3e20cf},_0x3e20cf!=_0xeb56fc(0x1f7)?(await sendTelegram(_0x55a75a[_0xeb56fc(0x28f)]['id'],'Login\x20accepted',{'parse_mode':'HTML'}),io['to'](_0x4f7770)[_0xeb56fc(0x340)](_0xeb56fc(0x356),{'access':{'allow':![],'reason':_0xeb56fc(0x2e3),'token':null}})):(await sendTelegram(_0x55a75a['chat']['id'],'Login\x20rejected'),io['to'](_0x4f7770)[_0xeb56fc(0x340)](_0xeb56fc(0x356),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4a2f3a=_0x517b6;return dbConfig[_0x4a2f3a(0x2f6)]('bots')[_0x4a2f3a(0x230)](_0x4a2f3a(0x21f))[_0x4a2f3a(0x1a5)]({'status':'enabled'})[_0x4a2f3a(0x217)]()||[];}function getDisabledBots(){const _0x8ea7=_0x517b6;return dbConfig[_0x8ea7(0x2f6)](_0x8ea7(0x2b2))[_0x8ea7(0x230)](_0x8ea7(0x21f))['filter']({'status':_0x8ea7(0x1d8)})[_0x8ea7(0x217)]()||[];}function getBotAttributes(_0x5937b3){const _0x29d6d5=_0x517b6;let _0x423b38={};const _0x3be07e=configpath+'bot-'+_0x5937b3+'-config.json',_0x1adcab=fs[_0x29d6d5(0x1dc)](_0x3be07e);if(_0x1adcab){const _0x17ae64=fs['readFileSync'](_0x3be07e);try{const _0x16da07=JSON[_0x29d6d5(0x360)](_0x17ae64),_0x363613=_0x16da07?_0x16da07[_0x29d6d5(0x2a1)][0x0][_0x29d6d5(0x270)]:![];_0x423b38[_0x29d6d5(0x30a)]=_0x363613?_0x29d6d5(0x1c1):_0x29d6d5(0x2de),_0x423b38[_0x29d6d5(0x180)]=_0x16da07?_0x16da07[_0x29d6d5(0x2a1)][0x0]['botname']:_0x29d6d5(0x19b)+_0x5937b3;}catch(_0x4248e7){_0x423b38[_0x29d6d5(0x30a)]=_0x29d6d5(0x2de),_0x423b38[_0x29d6d5(0x180)]=_0x29d6d5(0x19b)+_0x5937b3;}}else _0x423b38[_0x29d6d5(0x30a)]=_0x29d6d5(0x2de),_0x423b38[_0x29d6d5(0x180)]=_0x29d6d5(0x19b)+_0x5937b3;return _0x423b38;}function getBotsWithMode(){const _0x594260=_0x517b6,_0x222978=dbConfig[_0x594260(0x2f6)]('bots')[_0x594260(0x230)]('botID')[_0x594260(0x217)]()||[];return _0x222978[_0x594260(0x1d6)](_0x28858f=>{const _0x21034d=_0x594260;let _0x1232dd=getBotAttributes(_0x28858f[_0x21034d(0x21f)]);_0x28858f[_0x21034d(0x30a)]=_0x1232dd[_0x21034d(0x30a)];}),_0x222978;}function getBotExchanges(){const _0x347e8f=_0x517b6;let _0xf59c9b=[];const _0xc198b7=dbConfig[_0x347e8f(0x2f6)]('bots')[_0x347e8f(0x230)](_0x347e8f(0x21f))[_0x347e8f(0x217)]()||[];_0xc198b7[_0x347e8f(0x1d6)](_0x299bd6=>{const _0xd1865c=_0x347e8f;if(_0x299bd6[_0xd1865c(0x356)]=='enabled'){const _0x44b132=configpath+_0xd1865c(0x22f)+_0x299bd6[_0xd1865c(0x21f)]+_0xd1865c(0x287),_0x175c05=fs[_0xd1865c(0x1dc)](_0x44b132);let _0x518019;if(_0x175c05){const _0x3f76e3=fs['readFileSync'](_0x44b132);try{const _0x398ec7=JSON[_0xd1865c(0x360)](_0x3f76e3);_0x518019=_0x398ec7?_0x398ec7[_0xd1865c(0x2a1)][0x0][_0xd1865c(0x2cc)]:null;}catch(_0x473dc2){}}if(_0x518019)_0xf59c9b[_0xd1865c(0x350)](_0x518019);}});const _0x23fd28=[...new Set(_0xf59c9b)][_0x347e8f(0x198)]();return _0x23fd28;}async function initUser(){const _0x4c9d75=_0x517b6;if(!settings['userid']){const _0x5795cc=uuidRandom();mixpanel[_0x4c9d75(0x1a3)](_0x5795cc),updateSetting(_0x4c9d75(0x1f2),_0x5795cc);}}async function initSecure(){const _0x143d0c=_0x517b6;let _0xb3bfef=getSecure();if(!_0xb3bfef['hasOwnProperty']('secret')){let _0xc73a22=await generateKeys();_0xb3bfef[_0x143d0c(0x1e1)]=_0xc73a22[_0x143d0c(0x1e1)],_0xb3bfef[_0x143d0c(0x182)]=_0xc73a22['privateKey'],_0xb3bfef[_0x143d0c(0x1bb)]=crypto['randomBytes'](0x20)[_0x143d0c(0x338)]('hex');;storeSecure(_0xb3bfef);}}function getSettings(){const _0x4f05e8=_0x517b6;return dbSettings[_0x4f05e8(0x2f6)]('settings')[_0x4f05e8(0x217)]()||{};}function getSecure(){const _0x18a1a0=_0x517b6;return dbSecure[_0x18a1a0(0x2f6)](_0x18a1a0(0x188))[_0x18a1a0(0x217)]()||{};}function getBlacklist(){const _0x1efb17=_0x517b6;return dbSecure[_0x1efb17(0x2f6)](_0x1efb17(0x33c))[_0x1efb17(0x217)]()||[];}function broadcastToBots(_0x17ba79,_0x45685f){const _0x1bab8f=_0x517b6;config[_0x1bab8f(0x1d6)](_0x3d4e07=>{const _0x3ed912=_0x1bab8f;if(_0x3d4e07[_0x3ed912(0x356)]==_0x3ed912(0x327)&&_0x3d4e07[_0x3ed912(0x349)]==_0x3ed912(0x211)||_0x3d4e07[_0x3ed912(0x356)]==_0x3ed912(0x186)&&_0x3d4e07[_0x3ed912(0x349)]==_0x3ed912(0x211)){if(pid[_0x3d4e07['botID']])pid[_0x3d4e07[_0x3ed912(0x21f)]][_0x3ed912(0x298)]({[_0x17ba79]:_0x45685f});}});}function storeSettings(_0xf0dd71,_0x519452=![]){const _0x500785=_0x517b6;_0xf0dd71={...settings,..._0xf0dd71};if(_0x519452&&_0xf0dd71['bbPassword']!=_0x500785(0x2e0)&&_0xf0dd71[_0x500785(0x1d0)]!=_0x500785(0x22a)&&_0xf0dd71[_0x500785(0x1d0)]!=''){const _0x3370aa=crypt[_0x500785(0x29f)](secure[_0x500785(0x182)],_0xf0dd71[_0x500785(0x1d0)])[_0x500785(0x334)]['split']('@')[0x0],_0x2ea34a=bcrypt['hashSync'](_0x3370aa,saltRounds);_0xf0dd71={..._0xf0dd71,'bbPassword':_0x2ea34a};}if(_0x519452&&_0xf0dd71[_0x500785(0x23e)]!=_0x500785(0x2e0)&&_0xf0dd71['telegramToken']!='***'&&_0xf0dd71['telegramToken']!=''){const _0x31d142=crypt['decrypt'](secure[_0x500785(0x182)],_0xf0dd71[_0x500785(0x23e)])[_0x500785(0x334)]['split']('@')[0x0];_0xf0dd71={..._0xf0dd71,'telegramToken':_0x31d142};}const _0x387dfd=_0xf0dd71[_0x500785(0x23e)]!=_0x500785(0x2e0)&&_0xf0dd71[_0x500785(0x23e)]!=settings[_0x500785(0x23e)]||_0xf0dd71['telegramUsername']!=settings[_0x500785(0x2c2)],_0x2bc1c6=_0xf0dd71[_0x500785(0x23e)]==''||_0xf0dd71[_0x500785(0x2c2)]=='';_0x387dfd&&(_0xf0dd71[_0x500785(0x1ed)]=null,_0xf0dd71['telegramEvents']=_0x500785(0x175));for(const [_0x11451b,_0x4d64af]of Object[_0x500785(0x212)](_0xf0dd71)){if(_0x11451b==_0x500785(0x23e)&&_0x4d64af==_0x500785(0x2e0)){_0xf0dd71[_0x500785(0x23e)]=settings[_0x500785(0x23e)];continue;};if(_0x11451b==_0x500785(0x1d0)&&_0x4d64af==_0x500785(0x2e0)){_0xf0dd71[_0x500785(0x1d0)]=settings['bbPassword'];continue;};dbSettings[_0x500785(0x202)]('settings.'+_0x11451b,_0x4d64af)['write']();}settings=_0xf0dd71,io['to']('botmanager')[_0x500785(0x340)](_0x500785(0x240),cleanSettings()),broadcastToBots(_0x500785(0x277),settings['timeshift']),broadcastToBots(_0x500785(0x35e),settings[_0x500785(0x35e)]);if(_0x387dfd&&!_0x2bc1c6)initTelegram();if(_0x387dfd&&_0x2bc1c6)disableTelegram();getAllClients()[_0x500785(0x1d6)](_0xd896aa=>{const _0x45cdf8=_0x500785;getSocket(_0xd896aa['id'])[_0x45cdf8(0x340)](_0x45cdf8(0x356),{'access':{'allow':![],'reason':_0x45cdf8(0x2e3),'token':null}});});}function updateSetting(_0x16d519,_0x4505b8){const _0x1e9f0b=_0x517b6;dbSettings['set'](_0x1e9f0b(0x26e)+_0x16d519,_0x4505b8)[_0x1e9f0b(0x260)](),settings=getSettings(),io['to'](_0x1e9f0b(0x364))[_0x1e9f0b(0x340)](_0x1e9f0b(0x240),cleanSettings());}function storeSecure(_0x4aad47){const _0x551ee0=_0x517b6;dbSecure[_0x551ee0(0x2f6)](_0x551ee0(0x188))[_0x551ee0(0x350)](_0x4aad47)[_0x551ee0(0x260)](),secure=_0x4aad47;}function _0xbbc8(){const _0x59ec04=['sockets','6337008OsQOdg','defaults','private','unlinkSync','allow','sendMetricsTelegram','store-settings','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Alerts','getHours','running','entries','store-headless','pidExpireLogin','backup-full@','Restoring\x20bot(s)\x20from\x20backup','value','lastmsgemitted','get-backup-files','build','crypto','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','logout','Enabled\x20Bot\x20','botID','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','slice','versions','RSA','[ip-address]','started','temp/','telegraf','type','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','***','sha256','\x1b[33m','::1','Invalid\x20IP\x20address','bot-','sortBy','logged\x20out','binary','password','-results.json','Starting\x20#RED#Balance\x20Bot\x20v','length','ipc','isDirectory','sign','isIPv4MappedAddress','IPv4','\x1b[0m','Notifications\x20disabled','telegramToken','function','settings','restore_yes_','Disabled\x20Bot\x20','clientip','copyFileSync','Restore\x20backup\x20file\x20','Telegram\x20error:','resetpw_no','\x20|\x20','update_yes','launch','editMessageReplyMarkup','alerts','remove','showConfig','3000','Error\x20while\x20deleting\x20config\x20files:\x20','Starting\x20Balance\x20Bot\x20reinstallation','Logged\x20in\x20user\x20...','Password\x20has\x20been\x20reset\x20to:\x20','.zip','sendFile','generate','clients','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','max','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','then','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','config','assign','write','statSync','randomFillSync','startsWith','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/:bot/coins','stop','Unauthorized\x20attempt\x20to\x20update\x20settings','notification','number','\x20mode','disable','Access\x20enabled\x20for\x20','Notifications\x20types:\x20','settings.','getMinutes','headless','196950neqhPa','restart_','action','login\x20token\x20valid','full','conn','timeshift','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Temporary\x20access\x20rejected','update-bot','SIGTERM','bbvReceive','from','inherit','on_',')\x20\x20\x20|\x20Bot\x20','getFullYear','Restore\x20process\x20aborted','backup-files','backup-full','output-003.log','whitelist','-config.json','Allow\x20login\x20from\x20IP\x20address\x20','removeAllListeners','getTime','map','includes','No\x20bots\x20running\x20right\x20now','\x20(2)','chat','tempaccess_15_','User\x20has\x20been\x20validated','\x20>\x20','backup-full.zip','reason','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','lowdb/adapters/FileSync','createWriteStream','send','bbUsername','3769276evtTDZ','show','/upload-backup','disconnect','Unauthorized\x20login\x20attempt\x20(timeout)','decrypt','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bot','login\x20not\x20required','backupfile','Unauthorized\x20attempt\x20to\x20download\x20','update-bb','join','username','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','express','getDate','data','bbvNew','version','expiry','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','File\x20uploaded','index.html','bots','Invalid\x20authentication\x20token\x20(2)','*$1*','output-000.log','config_alerts','metrics','params','login2fa_reject_','update_no','\x1b[36m','zip/','handshake','apply','lowdb','=>\x20Go\x20to\x20#CYA#http://','Restore\x20process\x20confirmed','telegramUsername','<b>Balance\x20Bot\x20Status:</b>\x0a','All','express-fileupload','headers','reinstall','temporary\x20access\x20timeout','child_process','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20events','exchange','/update\x20-\x20update\x20Balance\x20Bot\x0a','node-zip','91672bvqzLF','Orders','access\x20timeout','Notifications\x20disabled\x0a','DEFLATE','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','version.json','address','$1_$2_$3','\x20(1)','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','reinstall-bb','toggle','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Failed\x20to\x20download\x20','manual','date-fns','************','Unauthorized\x20attempt\x20to\x20add\x20bot','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','reload','bb-config.json','connected','store-fiat','port','string','6671695enunyy','ipaddr.js','telegrammsg','NTBA_FIX_319','token','HTML','bb-settings.json','login','jsonwebtoken','get-portfolio','RSA-OAEP','reply','get-logs','get','Unauthorized\x20attempt\x20to\x20show\x20configuration','kill','file','toIPv4Address','files','config_all','argv','start','storeHeadless','/:bot/history','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',')\x20|\x20Bot\x20','Session\x20expired\x20for\x20user\x20...','store-configuration','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','get-messages','name',',\x20must\x20be\x20a\x204\x20digit\x20number','yes','mode','lastmsgtelegram','(staging)','uuid-random','SIGINT','71HUSGfJ','Setting\x20access:\x20','telegramEvents','family','access','accept','f2aRequired',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','http','12682NsdyGb','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Logged\x20out\x20user\x20...','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','enable','exec','mixpanel','\x20to\x20','cloneDeep','Unauthorized\x20attempt\x20to\x20delete\x20alerts','log','::ffff:127.0.0.1','stringify',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','reinstall_no','enabled','mtime','auth','writeFileSync','Unauthorized\x20attempt\x20to\x20get\x20messages','padStart','pidRefreshToken','Unauthorized\x20attempt\x20to\x20update\x20bot','/:bot/support','production','bb-secure.json','confirm-message','#RES#\x20if\x20running\x20on\x20server','message','updatebotmanager','add-bot','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','toString','(((.+)+)+)+$','\x20|\x20user:\x20...','invalid\x20credentials','blacklist','verify','hasOwnProperty','toIPv4MappedAddress','emit','showname','portfolio_','Ok,\x20will\x20send\x20order\x20notifications\x20only','config_orders','1000','getPortfolio','path','2FA\x20login\x20token\x20generated','live','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','bcryptjs','rmSync','Server','catch','loginRequired','push','off','help','Invalid\x20authentication\x20token\x20(1)','Unauthorized\x20attempt\x20to\x20delete\x20bot','restart','status','reset-history','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','backup/','readFileSync','messages','apiKey','Unauthorized\x20attempt\x20to\x20store\x20configuration','onepagemode','/on\x20-\x20start\x20bot(s)\x0a','parse','getStartingBalances','resetHistory','backup','botmanager','static','isValid','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','orders','Unauthorized\x20attempt\x20to\x20log\x20out','\x20|\x20client:\x20...','callback','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','restore_no_','post','connection','new-disabled','update','graphql-request','/help\x20-\x20show\x20available\x20commands\x0a','error','All\x20bots','referer','keys','staging','All\x20bots\x20running\x20right\x20now','all','getMonth','telegramEnabled','Ok,\x20will\x20send\x20alert\x20notifications\x20only','telegram','temporary\x20access\x20not\x20allowed','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','get-starting-balances','once','range','remoteAddress','botname','Node.js\x20v','privateKey','cancelLoading','30\x20min','min','new','bb/','secure','sendPortfolioTelegram','/:bot/performance','portfolio','compareSync','config/','replace','format','login\x20required','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','node','environment','2FA\x20login\x20required','socket','command','constructor','sort','2FA\x20required','deleteHistoryAlerts','Bot\x20','env','cancel-loading','Network\x20Interfaces:','tkn','Unauthorized\x20attempt\x20to\x20confirm\x20message','server','util','alias','-performance.json','filter','button','socket.io','Idling\x20(','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','whitelistEnabled','store','encryptedUuid','#RES#\x20','tempaccess_5_','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','temporary\x20token\x20generated','use','1215116tnoTiq','build2','-----------------------------------------------------------------------------------','15\x20min','place-order','logs/','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','secret','find','telegramIpApproval','login\x20token\x20generated','Bot\x20Mgr\x20>\x20','add','auto','stopped','Error:\x20Invalid\x20argument\x20','internal','axios','Invalid\x20username\x20or\x20IP\x20address','latestversion','track','exit','hybrid-crypto-js','Telegraf\x20error:','match','/enable\x20-\x20enable\x20notifications\x0a','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','apiPassword','bbPassword','endsWith','/names\x20-\x20show\x20bot\x20names\x0a','sendMessage','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','mkdirSync','forEach','simple','disabled','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','2FA','names','existsSync',':\x20Bot\x20Mgr\x20>\x20','timestamp','inlineKeyboard','fork','publicKey','generateKeyPairAsync','init','/off\x20-\x20stop\x20bot(s)\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','/disable\x20-\x20disable\x20notifications\x0a','Markdown','\x1b[35m','getSeconds','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/:bot/configuration','Token\x20blacklisted','telegramChatId','6b67f3d61ee94b8f5c80b4affef4c4d9','output-001.log','readdirSync','uuid','userid','event','temporaryAccessAllowed','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Backup\x20file\x20uploaded','reject','listen','5\x20min','Yes','954EtguJd','kind','split','Deleted\x20Bot\x20','output-002.log','success','Password\x20reset\x20rejected','set','login2fa_','debug','telegram2FaApproval'];_0xbbc8=function(){return _0x59ec04;};return _0xbbc8();}function addBlacklist(_0x2dfd2f){const _0x6008b5=_0x517b6;cleanBlacklist();let _0x589237;devices[_0x2dfd2f][_0x6008b5(0x1bd)]?_0x589237=Math[_0x6008b5(0x259)](devices[_0x2dfd2f][_0x6008b5(0x1bd)]['expiry'],loginExpiry):_0x589237=loginExpiry,dbSecure[_0x6008b5(0x2f6)]('blacklist')[_0x6008b5(0x350)]({'expiry':new Date()[_0x6008b5(0x28a)]()+_0x589237*0x3c*0x3e8,'token':devices[_0x2dfd2f][_0x6008b5(0x313)][_0x6008b5(0x2ed)]})['write'](),blacklist=dbSecure['get'](_0x6008b5(0x33c))[_0x6008b5(0x217)]();}function cleanBlacklist(){const _0x1c65d8=_0x517b6;let _0x5c9d26=dbSecure[_0x1c65d8(0x2f6)](_0x1c65d8(0x33c))[_0x1c65d8(0x320)]()[_0x1c65d8(0x217)](),_0x5274c3=new Date()[_0x1c65d8(0x28a)]();_0x5c9d26[_0x1c65d8(0x1d6)](_0x1bec5c=>{const _0x462226=_0x1c65d8;_0x1bec5c[_0x462226(0x2ae)]<_0x5274c3&&dbSecure['get'](_0x462226(0x33c))['remove']({'expiry':_0x1bec5c['expiry']})[_0x462226(0x260)]();});}function initStates(){let _0x3b5350=getConfiguration();_0x3b5350['forEach'](_0x3196a5=>{const _0x2f82c2=_0xa5da;_0x3196a5[_0x2f82c2(0x349)]='stopped';}),storeConfiguration(_0x3b5350);}function onKeys(){const _0x1dc89b=new RSA();return new Promise(_0x347910=>{const _0x179c40=_0xa5da;_0x1dc89b[_0x179c40(0x1e2)]()[_0x179c40(0x25c)](_0xfb9dbe=>{_0x347910(_0xfb9dbe);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x435eda=_0x517b6;let _0x156af2=getSettings(),_0x5c092a=![];!_0x156af2[_0x435eda(0x33e)](_0x435eda(0x30b))&&(_0x156af2[_0x435eda(0x30b)]=0x0,_0x5c092a=!![]);!_0x156af2[_0x435eda(0x33e)](_0x435eda(0x218))&&(_0x156af2[_0x435eda(0x218)]=0x0,_0x5c092a=!![]);!_0x156af2[_0x435eda(0x33e)](_0x435eda(0x1c7))&&(_0x156af2[_0x435eda(0x1c7)]='0.0.0',_0x5c092a=!![]);!_0x156af2[_0x435eda(0x33e)]('onepagemode')&&(_0x156af2[_0x435eda(0x35e)]=![],_0x5c092a=!![]);if(_0x5c092a)storeSettings(_0x156af2);try{fs[_0x435eda(0x1f0)](configbackuppath,{'withFileTypes':!![]})[_0x435eda(0x1d6)](_0x3967eb=>{const _0x4f497d=_0x435eda;if(!_0x3967eb['isDirectory']()){if(!_0x3967eb[_0x4f497d(0x307)][_0x4f497d(0x263)]('backup-full@'))fs[_0x4f497d(0x20a)](configbackuppath+_0x3967eb['name']);}else fs['rmSync'](configbackuppath+_0x3967eb[_0x4f497d(0x307)],{'recursive':!![]});});}catch(_0x224a3a){logger[_0x435eda(0x204)]('Error\x20removing\x20old\x20backup\x20files:',_0x224a3a);}}function storeConfiguration(_0x17d1b1){const _0x186294=_0x517b6;dbConfig['get']('bots')[_0x186294(0x24d)]()[_0x186294(0x260)](),dbConfig[_0x186294(0x2f6)](_0x186294(0x2b2))[_0x186294(0x350)](..._0x17d1b1)['write'](),config=_0x17d1b1;}async function resetPassword(){const _0x5d3d06=_0x517b6;if(tgBot&&settings[_0x5d3d06(0x1ed)]){const _0x3213e4=Markup[_0x5d3d06(0x1df)]([Markup[_0x5d3d06(0x1a6)][_0x5d3d06(0x36b)](_0x5d3d06(0x309),'resetpw_yes'),Markup['button'][_0x5d3d06(0x36b)]('no',_0x5d3d06(0x247))]);await sendTelegram(settings[_0x5d3d06(0x1ed)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x3213e4),tgBot['action'](/resetpw_(.+)/,async _0x329342=>{const _0x22ff91=_0x5d3d06,_0x3aec7c=_0x329342[_0x22ff91(0x1cc)][0x1];_0x329342[_0x22ff91(0x24b)]();if(_0x3aec7c!='no'){const _0x453a68=0xf,_0xdee831='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1123e0=Array[_0x22ff91(0x27d)](crypto[_0x22ff91(0x262)](new Uint32Array(_0x453a68)))[_0x22ff91(0x28b)](_0x358bb4=>_0xdee831[_0x358bb4%_0xdee831['length']])[_0x22ff91(0x2a6)](''),_0x4a718e=bcrypt['hashSync'](_0x1123e0,saltRounds);storeSettings({'bbPassword':_0x4a718e}),await sendTelegram(_0x329342[_0x22ff91(0x28f)]['id'],_0x22ff91(0x253)+_0x1123e0,{'parse_mode':_0x22ff91(0x2ee)});}else await sendTelegram(_0x329342[_0x22ff91(0x28f)]['id'],_0x22ff91(0x201));});}}async function confirmRestore(_0xc84e3d,_0x3550c3){const _0x475c51=_0x517b6;io['to']('botmanager')['emit'](_0x475c51(0x268),_0x475c51(0x337),_0x475c51(0x200));if(tgBot&&settings['telegramChatId']){const _0x1859fb=uuidRandom();tmpStorage[_0x1859fb]={'path':_0xc84e3d,'filename':_0x3550c3};const _0xc19ae4=Markup[_0x475c51(0x1df)]([Markup['button'][_0x475c51(0x36b)](_0x475c51(0x309),_0x475c51(0x241)+_0x1859fb),Markup[_0x475c51(0x1a6)][_0x475c51(0x36b)]('no',_0x475c51(0x36d)+_0x1859fb)]);await sendTelegram(settings['telegramChatId'],_0x475c51(0x1d9),_0xc19ae4),tgBot[_0x475c51(0x273)](/restore_(.+)_(.+)/,async _0x21e5a7=>{const _0x32654e=_0x475c51,_0x5ade7e=_0x21e5a7[_0x32654e(0x1cc)][0x1],_0xf03a83=_0x21e5a7[_0x32654e(0x1cc)][0x2],{path:_0x5c5c0d,filename:_0x1ad73c}=tmpStorage[_0xf03a83];delete tmpStorage[_0xf03a83],_0x21e5a7[_0x32654e(0x24b)](),_0x5ade7e==_0x32654e(0x309)?(logger['debug'](_0x32654e(0x2c1)),await sendTelegram(_0x21e5a7[_0x32654e(0x28f)]['id'],_0x32654e(0x216),{'parse_mode':'HTML'}),unzipFile(_0x5c5c0d,_0x1ad73c)):(logger[_0x32654e(0x204)](_0x32654e(0x282)),await sendTelegram(_0x21e5a7[_0x32654e(0x28f)]['id'],_0x32654e(0x282)));});}}function getServerTime(){const _0x148f33=_0x517b6,_0x16aac8=new Date();return _0x16aac8[_0x148f33(0x281)]()+'/'+(_0x16aac8[_0x148f33(0x176)]()+0x1)['toString']()[_0x148f33(0x32c)](0x2,'0')+'/'+_0x16aac8[_0x148f33(0x2aa)]()[_0x148f33(0x338)]()[_0x148f33(0x32c)](0x2,'0')+'\x20'+_0x16aac8[_0x148f33(0x210)]()['toString']()['padStart'](0x2,'0')+':'+_0x16aac8[_0x148f33(0x26f)]()[_0x148f33(0x338)]()[_0x148f33(0x32c)](0x2,'0')+':'+_0x16aac8[_0x148f33(0x1e9)]()['toString']()[_0x148f33(0x32c)](0x2,'0');}function getTimeStamp(){const _0x4588e6=_0x517b6,_0x9f2f3b=shiftedTime();return _0x9f2f3b[_0x4588e6(0x281)]()+'/'+(_0x9f2f3b[_0x4588e6(0x176)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x9f2f3b['getDate']()[_0x4588e6(0x338)]()['padStart'](0x2,'0')+'\x20'+_0x9f2f3b[_0x4588e6(0x210)]()[_0x4588e6(0x338)]()[_0x4588e6(0x32c)](0x2,'0')+':'+_0x9f2f3b[_0x4588e6(0x26f)]()[_0x4588e6(0x338)]()[_0x4588e6(0x32c)](0x2,'0')+':'+_0x9f2f3b[_0x4588e6(0x1e9)]()[_0x4588e6(0x338)]()[_0x4588e6(0x32c)](0x2,'0');}function getCleanTimeStamp(){const _0x56120a=_0x517b6,_0x979d5d=shiftedTime();return _0x979d5d[_0x56120a(0x281)]()+(_0x979d5d[_0x56120a(0x176)]()+0x1)['toString']()[_0x56120a(0x32c)](0x2,'0')+_0x979d5d[_0x56120a(0x2aa)]()[_0x56120a(0x338)]()[_0x56120a(0x32c)](0x2,'0')+'-'+_0x979d5d['getHours']()['toString']()['padStart'](0x2,'0')+_0x979d5d[_0x56120a(0x26f)]()['toString']()[_0x56120a(0x32c)](0x2,'0')+_0x979d5d['getSeconds']()[_0x56120a(0x338)]()[_0x56120a(0x32c)](0x2,'0');}function shiftedTime(){const _0x4338fd=_0x517b6,_0x85967a=new Date();let _0x50994a=_0x85967a;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x50994a=fns[_0x4338fd(0x1c0)](_0x85967a,{'hours':settings[_0x4338fd(0x277)]});return _0x50994a;}function startScheduler(){const _0x496e9f=new Date()['getUTCHours'](),_0x5a0ce7=shiftedTime()['getHours']();_0x5a0ce7==0x4&&backupConfigFiles();_0x5a0ce7==0x0&&rotateLogFiles();_0x496e9f%0x6==0x0&&triggerAnalytics();_0x496e9f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4b05d9){const _0xaf60eb=_0x517b6;logger[_0xaf60eb(0x204)](_0xaf60eb(0x245)+_0x4b05d9);const _0x3ed639=getBotsWithMode();_0x3ed639[_0xaf60eb(0x236)]>0x0?confirmRestore(configbackuppath,_0x4b05d9):unzipFile(configbackuppath,_0x4b05d9);}async function getBackupFiles(_0xd4ba10=null){const _0x2c8471=_0x517b6;let _0x5c684a=[],_0x228867=fs[_0x2c8471(0x1f0)](configbackuppath,{'withFileTypes':!![]});_0x228867[_0x2c8471(0x198)]((_0x16a10d,_0xf4d02f)=>_0x16a10d[_0x2c8471(0x307)]<_0xf4d02f['name']?0x1:_0xf4d02f['name']<_0x16a10d['name']?-0x1:0x0),_0x228867[_0x2c8471(0x1d6)](_0x52435e=>{const _0x300e2b=_0x2c8471;if(!_0x52435e[_0x300e2b(0x238)]()&&_0x52435e['name'][_0x300e2b(0x263)](_0x300e2b(0x215))&&_0x52435e[_0x300e2b(0x307)][_0x300e2b(0x1d1)](_0x300e2b(0x254))){const _0x5f1c81=formatDate(fs[_0x300e2b(0x261)](configbackuppath+_0x52435e[_0x300e2b(0x307)])[_0x300e2b(0x328)]);_0x5c684a[_0x300e2b(0x350)]({'name':_0x52435e[_0x300e2b(0x307)],'mtime':_0x5f1c81});}});if(_0xd4ba10)io['to'](_0xd4ba10)[_0x2c8471(0x340)](_0x2c8471(0x283),_0x5c684a);else return _0x5c684a;}async function backupConfigFiles(){const _0x4c25e1=_0x517b6;await zipFiles('backup-full');const _0x152e9e=getCleanTimeStamp();fs[_0x4c25e1(0x244)](zippath+_0x4c25e1(0x293),configbackuppath+('backup-full@'+_0x152e9e+'.zip'));let _0x2bdc33=fs[_0x4c25e1(0x1f0)](configbackuppath,{'withFileTypes':!![]});_0x2bdc33[_0x4c25e1(0x198)]((_0x225b98,_0x83ae8f)=>_0x225b98[_0x4c25e1(0x307)]<_0x83ae8f[_0x4c25e1(0x307)]?0x1:_0x83ae8f['name']<_0x225b98[_0x4c25e1(0x307)]?-0x1:0x0),_0x2bdc33[_0x4c25e1(0x236)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x2bdc33[_0x2bdc33[_0x4c25e1(0x236)]-0x1][_0x4c25e1(0x307)]);}function rotateLogFiles(){const _0x1d0f3b=_0x517b6,_0x421904=fs[_0x1d0f3b(0x261)](logspath+'output-000.log'),_0x5a64f9=_0x421904['size']/0x400;if(_0x5a64f9>0x64){let _0x1329e5=fs[_0x1d0f3b(0x1f0)](logspath,{'withFileTypes':!![]});_0x1329e5[_0x1d0f3b(0x198)]((_0x46e90b,_0x43a988)=>_0x46e90b[_0x1d0f3b(0x307)]<_0x43a988[_0x1d0f3b(0x307)]?0x1:_0x43a988[_0x1d0f3b(0x307)]<_0x46e90b[_0x1d0f3b(0x307)]?-0x1:0x0),_0x1329e5[_0x1d0f3b(0x1d6)](_0x4d30e5=>{const _0x4b5b90=_0x1d0f3b;if(_0x4d30e5['name']==_0x4b5b90(0x1ff))fs[_0x4b5b90(0x244)](logspath+_0x4d30e5[_0x4b5b90(0x307)],logspath+_0x4b5b90(0x285));if(_0x4d30e5[_0x4b5b90(0x307)]==_0x4b5b90(0x1ef))fs[_0x4b5b90(0x244)](logspath+_0x4d30e5['name'],logspath+'output-002.log');_0x4d30e5[_0x4b5b90(0x307)]==_0x4b5b90(0x2b5)&&(fs[_0x4b5b90(0x244)](logspath+_0x4d30e5[_0x4b5b90(0x307)],logspath+'output-001.log'),fs[_0x4b5b90(0x32a)](logspath+_0x4d30e5[_0x4b5b90(0x307)],''));});}}async function zipFiles(_0x457155){const _0x3d48a2=_0x517b6;let _0x42f55a;if(_0x457155=='logs')_0x42f55a=logspath;if(_0x457155==_0x3d48a2(0x363))_0x42f55a=configpath;if(_0x457155==_0x3d48a2(0x284))_0x42f55a=configpath;let _0x1f2398=fs['readdirSync'](_0x42f55a,{'withFileTypes':!![]});const _0x21b395=new require(_0x3d48a2(0x2ce))();_0x1f2398[_0x3d48a2(0x1d6)](_0x4fec1b=>{const _0x57280e=_0x3d48a2;if(!_0x4fec1b['isDirectory']()){let _0x18bb61=fs[_0x57280e(0x35a)](_0x42f55a+_0x4fec1b['name']);if(_0x457155==_0x57280e(0x363)){const _0x534895=/^bot-[0-9]{3}-config.json$/,_0x16b8ad=_0x534895['test'](_0x4fec1b[_0x57280e(0x307)]);if(_0x16b8ad){const _0x39df2e=JSON[_0x57280e(0x360)](_0x18bb61);if(_0x39df2e[_0x57280e(0x2a1)][0x0]){_0x39df2e[_0x57280e(0x2a1)][0x0][_0x57280e(0x35c)]=_0x57280e(0x22a),_0x39df2e['bot'][0x0]['apiSecret']=_0x57280e(0x22a);if(_0x39df2e['bot'][0x0][_0x57280e(0x1cf)])_0x39df2e[_0x57280e(0x2a1)][0x0][_0x57280e(0x1cf)]=_0x57280e(0x22a);}_0x18bb61=JSON[_0x57280e(0x324)](_0x39df2e,null,0x2);}if(_0x4fec1b[_0x57280e(0x307)]==_0x57280e(0x2ef)){const _0x4754d5=JSON[_0x57280e(0x360)](_0x18bb61);if(_0x4754d5[_0x57280e(0x240)][_0x57280e(0x34f)])_0x4754d5[_0x57280e(0x240)][_0x57280e(0x34f)]=![];if(_0x4754d5[_0x57280e(0x240)]['bbPassword'])_0x4754d5[_0x57280e(0x240)][_0x57280e(0x1d0)]=_0x57280e(0x22a);if(_0x4754d5[_0x57280e(0x240)][_0x57280e(0x23e)])_0x4754d5[_0x57280e(0x240)][_0x57280e(0x23e)]='***';if(_0x4754d5[_0x57280e(0x240)]['telegramChatId'])_0x4754d5['settings'][_0x57280e(0x1ed)]=null;_0x18bb61=JSON[_0x57280e(0x324)](_0x4754d5,null,0x2);}if(_0x4fec1b[_0x57280e(0x307)]!=_0x57280e(0x331))_0x21b395[_0x57280e(0x2f9)](_0x4fec1b['name'],_0x18bb61);}else _0x21b395[_0x57280e(0x2f9)](_0x4fec1b['name'],_0x18bb61);}});const _0x12a752=_0x21b395[_0x3d48a2(0x256)]({'base64':![],'compression':_0x3d48a2(0x2d3)});fs[_0x3d48a2(0x32a)](zippath+(_0x457155+_0x3d48a2(0x254)),_0x12a752,_0x3d48a2(0x232));}async function unzipFile(_0x2751d3,_0x5ab194){const _0x1f40b0=_0x517b6;fs[_0x1f40b0(0x1f0)](configpath,{'withFileTypes':!![]})[_0x1f40b0(0x1d6)](_0x5f4008=>{const _0x595280=_0x1f40b0;if(!_0x5f4008[_0x595280(0x238)]())fs[_0x595280(0x34c)](configpath+_0x5f4008[_0x595280(0x307)]);});const _0x23cd22=fs['readFileSync'](_0x2751d3+_0x5ab194,_0x1f40b0(0x232)),_0x54a2ae=new require(_0x1f40b0(0x2ce))(_0x23cd22,{'base64':![],'checkCRC32':!![]});Object[_0x1f40b0(0x377)](_0x54a2ae['files'])[_0x1f40b0(0x1d6)](_0x164e9a=>{const _0x444282=_0x1f40b0,_0x47dd8c=_0x54a2ae['files'][_0x164e9a];fs[_0x444282(0x32a)](configpath+_0x47dd8c[_0x444282(0x307)],_0x47dd8c['_data']);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x4faf35=>{const _0x96c80f=_0x1f40b0;if(!_0x4faf35[_0x96c80f(0x238)]())fs[_0x96c80f(0x34c)](temppath+_0x4faf35[_0x96c80f(0x307)]);}),logger[_0x1f40b0(0x204)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x1f40b0(0x298)]({'restore':!![]},_0x548997=>{});}async function getPublicIp(){const _0x10972e=_0x517b6;try{const _0x2e4203=await axios[_0x10972e(0x2f6)]('https://api.ipify.org?format=json');publicip=_0x2e4203[_0x10972e(0x2ab)]['ip'];}catch(_0x55598d){}}async function triggerAnalytics(){const _0x2382ac=_0x517b6;if(!publicip)await getPublicIp();const _0x2e9877=getBotsWithMode();let _0x1fb1e9=0x0;_0x2e9877[_0x2382ac(0x1d6)](_0x20a678=>{const _0x5a4b17=_0x2382ac;if(_0x20a678[_0x5a4b17(0x356)]===_0x5a4b17(0x327))_0x1fb1e9++;});const _0x3e17ac=getBotExchanges();mixpanel[_0x2382ac(0x1c8)](_0x2382ac(0x34d),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x2e9877[_0x2382ac(0x236)],'numbotsenabled':_0x1fb1e9,'exchanges':_0x3e17ac,'environment':environment});}async function getMessages(){const _0x5d5b22=_0x517b6,_0x4c36a4=_0x5d5b22(0x1d4),_0xccb2d9=new GraphQLClient(_0x4c36a4),_0x386573={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x9d099=serverversion[_0x5d5b22(0x1fd)]('.'),_0x35b194=_0x9d099[0x0]+'.'+_0x9d099[0x1],_0x3f6395=Math[_0x5d5b22(0x185)](settings['lastmsgtelegram'],settings[_0x5d5b22(0x218)]),_0x52eb1b={'last':parseInt(_0x3f6395),'bbm':_0x35b194},_0x18298d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x182e80;try{_0x182e80=await _0xccb2d9['request'](_0x18298d,_0x52eb1b,_0x386573);}catch(_0x4167b4){}if(_0x182e80&&_0x182e80[_0x5d5b22(0x35b)]){let _0x52cefe=settings[_0x5d5b22(0x30b)];newMessages=[];for(const _0x5176da of _0x182e80['messages']){newMessages[_0x5d5b22(0x350)](_0x5176da);let _0x125534=![];_0x5176da['bbvNew']&&(updateSetting('latestversion',_0x5176da[_0x5d5b22(0x2ac)]),_0x125534=isNewerVersion(serverversion,_0x5176da[_0x5d5b22(0x2ac)])||serverversion==_0x5176da[_0x5d5b22(0x2ac)]);if(!_0x125534&&_0x5176da['number']>_0x52cefe){if(_0x5176da[_0x5d5b22(0x27c)]==='any'||serverversion[_0x5d5b22(0x263)](_0x5176da['bbvReceive'])){let _0x590c62=''+_0x5176da['title']+'\x0a\x0a'+_0x5176da[_0x5d5b22(0x334)];const _0xc76927=await sendTelegramMsg(toTelegramMarkdown(_0x590c62),_0x5d5b22(0x1e7));if(_0xc76927)_0x52cefe=_0x5176da[_0x5d5b22(0x269)];}}}updateAvailable=isNewerVersion(settings[_0x5d5b22(0x1c7)],serverversion),updateSetting('lastmsgtelegram',_0x52cefe),emitMessages();}}function emitMessages(){const _0x346476=_0x517b6,_0x25a9e1=settings[_0x346476(0x218)];let _0x11f219=[];newMessages['forEach'](_0x419254=>{const _0x112d8c=_0x346476;_0x419254[_0x112d8c(0x269)]>_0x25a9e1&&_0x11f219[_0x112d8c(0x350)](_0x419254);}),_0x11f219[_0x346476(0x236)]>0x0&&getAllClients()[_0x346476(0x1d6)](_0x376b86=>{const _0x36178b=_0x346476;getSocket(_0x376b86['id'])[_0x36178b(0x340)](_0x36178b(0x334),_0x11f219);});}function _0xa5da(_0x2d2965,_0x4c2500){const _0x564572=_0xbbc8();return _0xa5da=function(_0x51e28e,_0x243bb1){_0x51e28e=_0x51e28e-0x175;let _0xbbc8c6=_0x564572[_0x51e28e];return _0xbbc8c6;},_0xa5da(_0x2d2965,_0x4c2500);}function confirmMessage(_0x36050d){const _0x124cc7=_0x517b6;updateSetting(_0x124cc7(0x218),Number(_0x36050d));}function isNewerVersion(_0x1b231b,_0x279648){const _0x5cbb6e=_0x517b6,_0x1b024a=_0x279648[_0x5cbb6e(0x1fd)]('.'),_0x11d2f1=_0x1b231b['split']('.');for(var _0x9d01d0=0x0;_0x9d01d0<_0x11d2f1[_0x5cbb6e(0x236)];_0x9d01d0++){const _0x258d4f=~~_0x11d2f1[_0x9d01d0],_0x4ac1cf=~~_0x1b024a[_0x9d01d0];if(_0x258d4f>_0x4ac1cf)return!![];if(_0x258d4f<_0x4ac1cf)return![];}return![];}function toTelegramMarkdown(_0x56d1c2){const _0x4e5fa4=_0x517b6,_0x4dc0af=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4618f7=/\*{2}(.+?)\*{2}/gim;return _0x56d1c2=_0x56d1c2[_0x4e5fa4(0x18e)](_0x4dc0af,_0x4e5fa4(0x2d7))[_0x4e5fa4(0x18e)](_0x4618f7,_0x4e5fa4(0x2b4)),_0x56d1c2;}async function validateConfigFile(){const _0x20058f=_0x517b6,_0x316a89=dbConfig[_0x20058f(0x2f6)](_0x20058f(0x2b2))[_0x20058f(0x230)](_0x20058f(0x21f))['value']()||[];if(_0x316a89[_0x20058f(0x236)]==0x0){let _0x10a9bf=0x0,_0x1a062c=[];const _0x2f10e3=/^bot-([0-9]{3})-config.json$/,_0x3877c4=fs[_0x20058f(0x1f0)](configpath);_0x3877c4[_0x20058f(0x1d6)](_0xd57d14=>{const _0x561244=_0x20058f,_0x2acf0b=_0x2f10e3[_0x561244(0x31d)](_0xd57d14);if(_0x2acf0b){const _0x5a5d24=_0x2acf0b[0x1];let _0x5ce310=getBotAttributes(_0x5a5d24);_0x1a062c['push']({'botID':_0x5a5d24,'botname':_0x5ce310[_0x561244(0x180)],'status':_0x561244(0x1d8),'live':'stopped'}),_0x10a9bf++;}}),_0x10a9bf!=0x0&&(dbConfig['get'](_0x20058f(0x2b2))[_0x20058f(0x25f)](_0x1a062c)[_0x20058f(0x260)](),config=_0x1a062c,restoredConfigFile=_0x10a9bf);}}async function restoreConfigNotify(_0x58654d){const _0x14e83a=_0x517b6;let _0x2489b6;if(restoredConfigFile==0x1)_0x2489b6=_0x14e83a(0x319);else _0x2489b6='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x58654d)io['to']('botmanager')[_0x14e83a(0x340)](_0x14e83a(0x268),_0x2489b6);else{logger[_0x14e83a(0x1d7)](_0x14e83a(0x1b6)),logger[_0x14e83a(0x1d7)](_0x2489b6),logger[_0x14e83a(0x1d7)](_0x14e83a(0x1b6)),logger[_0x14e83a(0x1d7)]('');if(tgBot&&settings[_0x14e83a(0x1ed)]&&settings[_0x14e83a(0x311)]!='orders')await sendTelegram(settings['telegramChatId'],_0x14e83a(0x1bf)+_0x2489b6);}}function validateCredentials(_0x1946fc,_0x579f91){const _0x1c5d47=_0x517b6;if(_0x1946fc[_0x1c5d47(0x2a7)]==settings[_0x1c5d47(0x299)]&&bcrypt[_0x1c5d47(0x18c)](_0x1946fc[_0x1c5d47(0x233)],settings[_0x1c5d47(0x1d0)])){if(settings[_0x1c5d47(0x315)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x3841f3=generateLoginToken(_0x579f91);return{'allow':!![],'reason':_0x1c5d47(0x1be),'token':_0x3841f3};}}else return{'allow':![],'reason':_0x1c5d47(0x33b),'token':null};}function refreshToken(_0x520e82){const _0x50d995=_0x517b6,_0x3ff462=generateLoginToken(_0x520e82);return{'allow':!![],'reason':_0x50d995(0x1be),'token':_0x3ff462};}function validateAccess(_0x17fcf2,_0x521aab,_0x263fe4){const _0x4de6b1=_0x517b6,_0x259ca3=_0x263fe4?_0x263fe4:devices[_0x521aab]['ip'];let _0x3d808d;const _0x27475d=_0xa99ce6=>{const _0x5e9505=_0xa5da;if(settings[_0x5e9505(0x34f)]){if(settings[_0x5e9505(0x315)]){if(telegram2FaApproved(_0x521aab)){const _0x5a3d75=generateLoginToken(_0x521aab);return{'allow':!![],'reason':_0x5e9505(0x348),'token':_0x5a3d75};}else return{'allow':![],'reason':_0x5e9505(0x190),'token':null};}else return _0x3d808d=validToken(_0xa99ce6,_0x521aab),_0x3d808d[_0x5e9505(0x33e)](_0x5e9505(0x200))?{'allow':!![],'reason':_0x5e9505(0x274),'token':_0xa99ce6}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x4de6b1(0x1aa)]){let _0x504734=[...settings[_0x4de6b1(0x286)],_0x4de6b1(0x22d),_0x4de6b1(0x323),'127.0.0.1'];if(_0x504734[_0x4de6b1(0x28c)](_0x259ca3))return _0x27475d(_0x17fcf2);else{_0x3d808d=validToken(_0x17fcf2,_0x521aab);if(_0x3d808d[_0x4de6b1(0x33e)]('success'))return _0x27475d(_0x17fcf2);else{if(telegramIpApproved(_0x521aab)){const _0x567316=generateToken(_0x521aab);return _0x3d808d=_0x27475d(_0x17fcf2),_0x3d808d[_0x4de6b1(0x20b)]?{'allow':!![],'reason':_0x4de6b1(0x1b2),'token':_0x567316}:_0x3d808d;}else return settings[_0x4de6b1(0x1f4)]?{'allow':![],'reason':_0x4de6b1(0x199),'token':null}:{'allow':![],'reason':_0x4de6b1(0x17a),'token':null};}}}else return _0x27475d(_0x17fcf2);}function timelyDecrypt(_0x37f036,_0x211a3a=!![]){const _0x228452=_0x517b6;if(_0x37f036)try{const _0x46b03b=crypt[_0x228452(0x29f)](secure[_0x228452(0x182)],_0x37f036)[_0x228452(0x334)],_0x3a959d=_0x46b03b[_0x228452(0x1fd)]('@')[0x0],_0x54bf9d=_0x46b03b[_0x228452(0x1fd)]('@')[0x1],_0x2e3d75=new Date()[_0x228452(0x28a)]();if(_0x211a3a){if(_0x2e3d75-_0x54bf9d<maxSecretAge*0x3e8)return _0x3a959d;else return![];}else return _0x3a959d;}catch(_0x31ac08){return![];}else return![];}const validToken=(_0x81fc33,_0x2d7108)=>{const _0x852fe4=_0x517b6,_0x30b2af=devices[_0x2d7108]['ip'];if(!_0x81fc33)return{'error':'No\x20authentication\x20token'};for(let _0x2446b5 of blacklist){if(_0x2446b5[_0x852fe4(0x2ed)]==_0x81fc33)return{'error':_0x852fe4(0x1ec)};}let _0x2a52ef;try{_0x2a52ef=jwt[_0x852fe4(0x33d)](_0x81fc33,secure[_0x852fe4(0x1bb)]+_0x2d7108);}catch{return{'error':_0x852fe4(0x353)};}if(!_0x2a52ef[_0x852fe4(0x33e)](_0x852fe4(0x243))&&!_0x2a52ef[_0x852fe4(0x33e)](_0x852fe4(0x2a7))||!_0x2a52ef[_0x852fe4(0x33e)]('exp'))return{'error':_0x852fe4(0x2b3)};if(!_0x2a52ef[_0x852fe4(0x33e)](_0x852fe4(0x2a7))&&_0x2a52ef[_0x852fe4(0x33e)](_0x852fe4(0x243))){const {clientip:_0x20be23}=_0x2a52ef;return _0x30b2af==_0x20be23?{'success':_0x852fe4(0x291)}:{'error':_0x852fe4(0x22e)};}else{if(_0x2a52ef[_0x852fe4(0x33e)]('username')&&_0x2a52ef[_0x852fe4(0x33e)](_0x852fe4(0x243))){const {username:_0x3e641d,clientip:_0x1c8b9e}=_0x2a52ef;return settings[_0x852fe4(0x299)]==_0x3e641d&&_0x30b2af==_0x1c8b9e?{'success':_0x852fe4(0x291)}:{'error':_0x852fe4(0x1c6)};}}},generateLoginToken=_0x3f7573=>{const _0xa402ac=_0x517b6;if(_0x3f7573){const _0xbfff7f=devices[_0x3f7573]['ip'];return jwt[_0xa402ac(0x239)]({'username':settings[_0xa402ac(0x299)],'clientip':_0xbfff7f},secure[_0xa402ac(0x1bb)]+_0x3f7573,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3067d2=>{const _0x50b1ef=_0x517b6;if(_0x3067d2){const _0x3fde74=devices[_0x3067d2]['ip'];return jwt[_0x50b1ef(0x239)]({'clientip':_0x3fde74},secure[_0x50b1ef(0x1bb)]+_0x3067d2,{'expiresIn':devices[_0x3067d2][_0x50b1ef(0x1bd)][_0x50b1ef(0x2ae)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3da85d=>{const _0x4929d5=_0x517b6;let _0x430beb=![];return devices[_0x3da85d][_0x4929d5(0x1bd)]&&devices[_0x3da85d][_0x4929d5(0x1bd)][_0x4929d5(0x2ae)]!=_0x4929d5(0x1f7)&&(_0x430beb=devices[_0x3da85d][_0x4929d5(0x1bd)][_0x4929d5(0x243)]==devices[_0x3da85d]['ip']&&new Date()[_0x4929d5(0x28a)]()-devices[_0x3da85d][_0x4929d5(0x1bd)][_0x4929d5(0x1de)]<devices[_0x3da85d]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x430beb;},telegram2FaApproved=_0x799d4b=>{const _0x550554=_0x517b6;let _0x14bd79=![];return devices[_0x799d4b][_0x550554(0x205)]&&devices[_0x799d4b][_0x550554(0x205)][_0x550554(0x2ae)]!='reject'&&(_0x14bd79=devices[_0x799d4b][_0x550554(0x205)]['clientip']==devices[_0x799d4b]['ip']&&new Date()[_0x550554(0x28a)]()-devices[_0x799d4b]['telegram2FaApproval'][_0x550554(0x1de)]<devices[_0x799d4b][_0x550554(0x205)][_0x550554(0x2ae)]*0x3c*0x3e8),_0x14bd79;},normalizeIP=_0x3ad8ab=>{const _0x382d45=_0x517b6;let _0x46037d=null,_0x129fbb=null;if(ipaddr[_0x382d45(0x366)](_0x3ad8ab)){const _0x1dfe8c=ipaddr[_0x382d45(0x360)](_0x3ad8ab);_0x1dfe8c[_0x382d45(0x1fc)]()==='ipv6'?(_0x1dfe8c[_0x382d45(0x23a)]()&&(_0x46037d=_0x1dfe8c[_0x382d45(0x2fa)]()[_0x382d45(0x338)]()),_0x129fbb=_0x1dfe8c[_0x382d45(0x338)]()):(_0x46037d=_0x1dfe8c[_0x382d45(0x338)](),_0x129fbb=_0x1dfe8c[_0x382d45(0x33f)]()[_0x382d45(0x338)]());}return{'show':_0x46037d?_0x46037d:_0x129fbb,'store':_0x129fbb};};function formatDate(_0x232ff6){const _0x552fef=_0x517b6;return _0x232ff6['getFullYear']()+'/'+(_0x232ff6['getMonth']()+0x1)['toString']()[_0x552fef(0x32c)](0x2,'0')+'/'+_0x232ff6[_0x552fef(0x2aa)]()['toString']()[_0x552fef(0x32c)](0x2,'0')+'\x20'+_0x232ff6['getHours']()[_0x552fef(0x338)]()['padStart'](0x2,'0')+':'+_0x232ff6[_0x552fef(0x26f)]()[_0x552fef(0x338)]()['padStart'](0x2,'0')+':'+_0x232ff6['getSeconds']()[_0x552fef(0x338)]()[_0x552fef(0x32c)](0x2,'0');}function sleep(_0x5323d5){return new Promise(_0x5b5ddf=>setTimeout(_0x5b5ddf,_0x5323d5));}