function _0x3572(_0x213563,_0x460123){const _0x2aa703=_0x19fa();return _0x3572=function(_0x139948,_0x5101ea){_0x139948=_0x139948-0x168;let _0x19fa88=_0x2aa703[_0x139948];return _0x19fa88;},_0x3572(_0x213563,_0x460123);}const _0x549688=_0x3572;(function(_0x48e3bc,_0x2d8e19){const _0x3e15aa=_0x3572,_0x16fa2a=_0x48e3bc();while(!![]){try{const _0x524d14=-parseInt(_0x3e15aa(0x315))/0x1*(-parseInt(_0x3e15aa(0x29b))/0x2)+parseInt(_0x3e15aa(0x1dc))/0x3+-parseInt(_0x3e15aa(0x2ab))/0x4*(-parseInt(_0x3e15aa(0x21b))/0x5)+parseInt(_0x3e15aa(0x306))/0x6*(parseInt(_0x3e15aa(0x281))/0x7)+parseInt(_0x3e15aa(0x1ff))/0x8+-parseInt(_0x3e15aa(0x23b))/0x9+-parseInt(_0x3e15aa(0x186))/0xa;if(_0x524d14===_0x2d8e19)break;else _0x16fa2a['push'](_0x16fa2a['shift']());}catch(_0x416346){_0x16fa2a['push'](_0x16fa2a['shift']());}}}(_0x19fa,0x5d8cc));const _0x5101ea=function(){let _0xb61165=!![];return function(_0x1cab66,_0x5205b8){const _0x4f40c9=_0xb61165?function(){const _0x5bdd6d=_0x3572;if(_0x5205b8){const _0x1dffb0=_0x5205b8[_0x5bdd6d(0x321)](_0x1cab66,arguments);return _0x5205b8=null,_0x1dffb0;}}:function(){};return _0xb61165=![],_0x4f40c9;};}(),_0x139948=_0x5101ea(this,function(){const _0x57c455=_0x3572;return _0x139948['toString']()['search'](_0x57c455(0x1ce))[_0x57c455(0x2c5)]()[_0x57c455(0x264)](_0x139948)[_0x57c455(0x16a)](_0x57c455(0x1ce));});_0x139948();'use strict';process[_0x549688(0x22e)][_0x549688(0x1d9)]=0x1;const childProcess=require(_0x549688(0x1f1)),fs=require('fs'),fns=require('date-fns'),low=require(_0x549688(0x214)),FileSync=require(_0x549688(0x29e)),path=require('path'),crypto=require(_0x549688(0x2b0)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x549688(0x20d))[_0x549688(0x2a2)],bcrypt=require(_0x549688(0x33d)),jwt=require(_0x549688(0x17e)),ipaddr=require('ipaddr.js'),argv=require(_0x549688(0x1bd))(process[_0x549688(0x2b6)]['slice'](0x2))['argv'],uuidRandom=require(_0x549688(0x2a6)),TelegramBot=require(_0x549688(0x33f)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x549688(0x216)),util=require(_0x549688(0x33a)),fileUpload=require(_0x549688(0x302)),{networkInterfaces}=require('os'),PORT=argv[_0x549688(0x247)]||_0x549688(0x24c),pattern=/^[0-9]{2,4}$/;!pattern[_0x549688(0x255)](PORT)&&(console[_0x549688(0x249)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x549688(0x192)),process[_0x549688(0x2cf)](0x1));const HOST=argv[_0x549688(0x2fb)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x549688(0x267)][_0x549688(0x22f)];let bbpath=_0x549688(0x31a),bbpath2='';const botfile=_0x549688(0x2f6),configfile='bb-config.json',settingsfile=_0x549688(0x2fd),securefile=_0x549688(0x2e9),environment=require('./'+bbpath2+_0x549688(0x2b1))['environment']||_0x549688(0x1a7),maxBackups=0xa;let validInstallation=!![];!fs[_0x549688(0x200)](bbpath+botfile)&&(bbpath='',validInstallation=![]);function _0x19fa(){const _0x582489=['mkdirSync','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','2FA\x20required','No\x20authentication\x20token','getTime','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','headers','404\x20Not\x20Found','Unauthorized\x20attempt\x20to\x20update\x20bot','timeshift','Backup\x20file\x20uploaded','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','login\x20required','getSeconds','confirm-message','-config.json','/names\x20-\x20show\x20bot\x20names\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','length','parse','util','answerCallbackQuery','telegram2FaApproval','bcryptjs','toIPv4Address','node-telegram-bot-api','\x20>\x20','apiKey','search','add','Alerts','simple','botID','Unauthorized\x20attempt\x20to\x20confirm\x20message','status','emit','set','ipc','started','catch','uncaughtException','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','error','=>\x20Go\x20to\x20#CYA#http://','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/:bot/support','Error\x20removing\x20old\x20backup\x20files:','login','jsonwebtoken','stopPolling','Notifications\x20disabled\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','disconnect','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','hashSync','track','14521060mazLxP','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','latestversion','Unauthorized\x20attempt\x20to\x20get\x20events','temporary\x20token\x20generated','name','socket','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','pidRefreshToken','generate','Unauthorized\x20attempt\x20to\x20get\x20messages',',\x20must\x20be\x20a\x204\x20digit\x20number','unlinkSync','Backup\x20file\x20unzipped\x20and\x20stored','disabled','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','verify','messages','temp/','readdirSync','stop','All\x20bots','storeFiat','update','order','output-002.log','backupfile','(staging)','output-000.log','telegramChatId','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','production','init','socket.io','bbvNew','telegram','Bot\x20Mgr\x20>\x20','sendMetricsTelegram','push','Restore\x20process\x20aborted','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','map','backup/','sockets','secure','server','All','binary','<b>Telegram\x20Bot\x20Status:</b>\x0a','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','fork','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','forEach','yargs/yargs','User\x20has\x20been\x20validated','stringify','No\x20bots\x20running\x20right\x20now','Invalid\x20Telegram\x20token','getDate','find','Starting\x20#RED#Balance\x20Bot\x20v','Unauthorized\x20attempt\x20to\x20update\x20settings','/upload-backup','from','1000','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','sort','bot','Notifications\x20types:\x20','all','(((.+)+)+)+$','HTML','Starting\x20bot\x20|\x20Bot\x20','.zip','telegramIpApproval','build','2FA\x20login\x20rejected','Starting\x20new\x20bot\x20|\x20Bot\x20','</b>\x20?','delete-alerts','/output-000.log','NTBA_FIX_319','kind','mode','2168511dykXlJ','Enabled\x20Bot\x20','store-fiat','private','callback_query','cancel-loading','hasOwnProperty','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','format','https://api.ipify.org?format=json','telegramUsername','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','deleteHistoryAlerts','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20show\x20configuration','value','new-disabled','\x1b[31m','Unauthorized\x20attempt\x20to\x20get\x20portfolio','logs/','\x1b[34m','child_process','readFileSync',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','file','/metrics\x20-\x20show\x20bot\x20performance\x0a','store','Unauthorized\x20login\x20attempt\x20(timeout)','remoteAddress','f2aRequired','Yes','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','place-order','polling_error','enabled','3351888WpwiCc','existsSync','sendPortfolioTelegram','***','sendFile','pidExpireLogin','sortBy','#RES#\x20if\x20running\x20locally\x0a','toggle-bot-mode','/download/:type','cancelLoading','RSA-OAEP','bbUsername','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','hybrid-crypto-js','function','storeHeadless','entries','backup-full','\x20|\x20client:\x20...','temporary\x20access\x20rejected','lowdb','split','graphql-request','get-starting-balances','http','\x20to\x20','Restarting\x20Bot\x20','1325wQOSKL','timestamp','onepagemode','referer','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','isIPv4MappedAddress','replace','listen','botmanager','output-003.log','download','request','/help\x20-\x20show\x20available\x20commands\x0a','message','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','includes','IPv4','blacklist','event','env','node','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','\x20(2)','[ip-address]','apiPassword','family','Access\x20enabled\x20for\x20','::ffff:127.0.0.1','once','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','endsWith','2732364qZmKqp','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','<b>Balance\x20Bot\x20Status:</b>\x0a','string','/enable\x20-\x20enable\x20notifications\x0a','running','logs','full','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','any','conn','showname','port','#RES#\x20','log','sign','bbPassword','3000','_data','allow','6b67f3d61ee94b8f5c80b4affef4c4d9','Error\x20while\x20deleting\x20config\x20files:\x20','join','2FA','Login\x20accepted','-events.json','test','restart','privateKey','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','zip/','output-001.log','/:bot/coins','loginRequired','Disabled\x20Bot\x20','Bot\x20','-performance.json','generateKeyPairAsync','get-backup-files','uuid','Orders','constructor','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','debug','versions','exp','0.0.0','auto','removeListener','inherit','\x20only\x0a','2FA\x20login\x20required','/:bot/history','Deleted\x20Bot\x20','handshake','Allow\x20login\x20from\x20IP\x20address\x20<b>','remove','telegramEvents','Server','statSync','node-zip','getHours','staging','emitHistory','Unauthorized\x20attempt\x20to\x20store\x20configuration','/:bot/configuration','/on\x20-\x20start\x20bot(s)\x0a','write','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','clientip','39697dhzGnc','new','add-bot','getFullYear','backup-full@','rmSync','manual','*$1*','data','resetHistory','onText','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','slice','login\x20not\x20required','Network\x20Interfaces:','login\x20token\x20valid','send','auth','logout','title','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','getStartingBalances','compareSync','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','telegrammsg','toggleBotMode','6896UhtTSv','telegramToken','127.0.0.1','lowdb/adapters/FileSync','orders','delete-bot','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','RSA','randomFillSync','File\x20uploaded','telegramEnabled','uuid-random','index.html','api-eu.mixpanel.com','post','createWriteStream','11528ghzyoj','2FA\x20login\x20token\x20generated','settings.','params','Notifications\x20enabled','crypto','version.json','lastmsgtelegram','password','stopped','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','argv','\x1b[36m','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','keys','copyFileSync','userid','reason','chat','restore-backup-file','then','sendMessage','bbvReceive','assign','removeAllListeners','static','toString','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','update-bot','username','Session\x20expired\x20for\x20user\x20...','/:bot','clients','backup','Temporary\x20access\x20rejected','secret','exit','\x20|\x20user:\x20...','botname','encryptedUuid','address','update-bb','-----------------------------------------------------------------------------------','reinstall','store-settings','\x20minutes','Unauthorized\x20attempt\x20to\x20delete\x20bot','settings','************','login\x20token\x20generated','kill','padStart','show','tkn','token','bots','notification','config/','reset-history','expiry','number','type','bb-secure.json','reload','decrypt','store-configuration','\x20mode','build2','\x20(1)','15\x20min','-results.json','exec','getPortfolio','/update\x20-\x20update\x20Balance\x20Bot\x0a','get','bot.js','filter','backup-files','startsWith','Unauthorized\x20attempt\x20to\x20log\x20out','host','::1','bb-settings.json','publicKey','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','express-fileupload','writeFileSync','logged\x20out','cloneDeep','90GtXWhe','lastmsgemitted','alerts','getMinutes','live','/disable\x20-\x20disable\x20notifications\x0a',':\x20Bot\x20Mgr\x20>\x20','reset-password','headless','access','reject','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','bot-','/off\x20-\x20stop\x20bot(s)\x0a','invalid\x20credentials','43uStPsl','use','\x20|\x20','\x1b[0m','getMonth','bb/','5\x20min','files','whitelistEnabled','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','isValid','match','apply','success','yes','isDirectory','connected'];_0x19fa=function(){return _0x582489;};return _0x19fa();}const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x549688(0x2cb)),configpath=userID?bbpath+_0x549688(0x2e4)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x549688(0x1b2),logspath=userID?bbpath+_0x549688(0x1ef)+userID+'/':bbpath+_0x549688(0x1ef),zippath=userID?bbpath+_0x549688(0x259)+userID+'/':bbpath+_0x549688(0x259),loggerfile=fs[_0x549688(0x2aa)](logspath+_0x549688(0x1d8),{'flags':'a'}),temppath=userID?bbpath+_0x549688(0x199)+userID+'/':bbpath+'temp/';!fs[_0x549688(0x200)](configpath)&&fs[_0x549688(0x326)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x549688(0x200)](logspath)&&fs[_0x549688(0x326)](logspath);!fs[_0x549688(0x200)](zippath)&&fs[_0x549688(0x326)](zippath);!fs[_0x549688(0x200)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x549688(0x27e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x549688(0x269),'onepagemode':![]}})[_0x549688(0x27e)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x549688(0x27e)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x549688(0x20a)});const saltRounds=0xa,mixpanel=Mixpanel[_0x549688(0x1a8)](_0x549688(0x24f),{'host':_0x549688(0x2a8)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x549688(0x29c)]!=''&&settings[_0x549688(0x1e6)]&&settings[_0x549688(0x1e6)]!='')initTelegram();const parseColor=(_0x11bd90,_0x26649b)=>{const _0x4291d6=_0x549688,_0x58d62e=/#[A-Z]{3}#/g;if(typeof _0x11bd90==_0x4291d6(0x23e)){!_0x26649b?_0x11bd90=_0x11bd90['replace'](_0x58d62e,''):(_0x11bd90=_0x11bd90[_0x4291d6(0x221)](/#BLU#/g,_0x4291d6(0x1f0)),_0x11bd90=_0x11bd90['replace'](/#RED#/g,_0x4291d6(0x1ed)),_0x11bd90=_0x11bd90[_0x4291d6(0x221)](/#YEL#/g,'\x1b[33m'),_0x11bd90=_0x11bd90['replace'](/#MAG#/g,'\x1b[35m'),_0x11bd90=_0x11bd90[_0x4291d6(0x221)](/#CYA#/g,_0x4291d6(0x2b7)),_0x11bd90=_0x11bd90[_0x4291d6(0x221)](/#RES#/g,_0x4291d6(0x318)));;}return _0x11bd90;},logger={'screen':_0x2970d0=>{const _0x521500=_0x549688;console[_0x521500(0x249)](parseColor(_0x2970d0,!![]));},'simple':_0x1e5de4=>{const _0xfacec9=_0x549688;console['log'](parseColor(_0x1e5de4,!![])),loggerfile['write'](util[_0xfacec9(0x1e4)](parseColor(_0x1e5de4,![]))+'\x0a');},'full':async _0x4515db=>{const _0x12d117=_0x549688,_0x1603c7=getTimeStamp()+_0x12d117(0x30c)+_0x4515db;console[_0x12d117(0x249)](parseColor(_0x1603c7,!![])),loggerfile['write'](util[_0x12d117(0x1e4)](parseColor(_0x1603c7,![]))+'\x0a');if(tgBot&&settings[_0x12d117(0x1a4)]&&settings[_0x12d117(0x274)]!='orders')await tgBot[_0x12d117(0x2c0)](settings[_0x12d117(0x1a4)],_0x12d117(0x1ac)+parseColor(_0x4515db,![]))['catch'](_0x3b6581=>{telegramError(_0x3b6581);});},'debug':async(_0x44cf72,_0x44ab59='')=>{const _0x5e8651=_0x549688,_0x2a044d=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x44cf72;if(debugging)console['log'](parseColor(_0x2a044d,!![]));loggerfile[_0x5e8651(0x27e)](util[_0x5e8651(0x1e4)](parseColor(_0x2a044d,![]))+'\x0a');if(_0x44ab59){if(debugging)console[_0x5e8651(0x249)](_0x44ab59);loggerfile[_0x5e8651(0x27e)](util[_0x5e8651(0x1e4)](_0x44ab59)+'\x0a');}}};process['on'](_0x549688(0x176),function(_0x5c87d1){const _0x21c9e5=_0x549688;logger[_0x21c9e5(0x16d)](_0x5c87d1);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x549688(0x2b1))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x549688(0x218))['createServer'](app);app[_0x549688(0x316)](fileUpload({'useTempFiles':!![]})),app['get'](_0x549688(0x208),async(_0x271c7a,_0x28e8a3)=>{const _0x4e156e=_0x549688,_0x80b017=_0x271c7a[_0x4e156e(0x2ae)][_0x4e156e(0x2e8)],_0x51f488=getClientsWithBotID(_0x4e156e(0x223)),_0x51a67d=_0x271c7a['headers'][_0x4e156e(0x262)],_0x85a33f=timelyDecrypt(_0x51a67d,![]),_0x322ae0=_0x51f488['find'](_0x46dbdb=>_0x46dbdb[_0x4e156e(0x262)]==_0x85a33f);if(_0x322ae0){const _0x22772e=normalizeIP(_0x271c7a[_0x4e156e(0x18c)][_0x4e156e(0x1f8)])['store'],_0x407714=_0x271c7a['headers'][_0x4e156e(0x2e0)];if(validateAccess(_0x407714,_0x85a33f,_0x22772e)[_0x4e156e(0x24e)])_0x80b017==_0x4e156e(0x2cc)&&await backupConfigFiles(),await zipFiles(_0x80b017),_0x28e8a3[_0x4e156e(0x225)](zippath+(_0x80b017+_0x4e156e(0x1d1)),_0x5d90ff=>{const _0x457e41=_0x4e156e;_0x5d90ff&&(logger['full']('Failed\x20to\x20download\x20'+_0x80b017),logger[_0x457e41(0x16d)](_0x5d90ff));});else logger[_0x4e156e(0x242)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x80b017+_0x4e156e(0x2ef));}else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x80b017+_0x4e156e(0x231));}),app[_0x549688(0x2a9)](_0x549688(0x1c6),async(_0x49bfea,_0x481b4c)=>{const _0xa7913d=_0x549688,_0x4163df=getClientsWithBotID(_0xa7913d(0x223)),_0x2eb493=_0x49bfea['headers'][_0xa7913d(0x262)],_0x551deb=timelyDecrypt(_0x2eb493,![]),_0x340d8d=_0x4163df[_0xa7913d(0x1c3)](_0x24c7fc=>_0x24c7fc[_0xa7913d(0x262)]==_0x551deb);logger['debug'](_0xa7913d(0x330));if(_0x340d8d){const _0x149039=normalizeIP(_0x49bfea[_0xa7913d(0x18c)]['remoteAddress'])['store'],_0x140f78=_0x49bfea[_0xa7913d(0x32c)][_0xa7913d(0x2e0)];if(validateAccess(_0x140f78,_0x551deb,_0x149039)[_0xa7913d(0x24e)]){if(_0x49bfea[_0xa7913d(0x31c)]){const _0x26432b=_0x49bfea['files'][_0xa7913d(0x1a1)];await _0x26432b['mv'](temppath+_0x26432b[_0xa7913d(0x18b)]),_0x481b4c[_0xa7913d(0x291)]({'status':!![],'message':_0xa7913d(0x2a4)});const _0x88fa16=getBotsWithMode();_0x88fa16[_0xa7913d(0x338)]>0x0?confirmRestore(temppath,_0x26432b[_0xa7913d(0x18b)]):unzipFile(temppath,_0x26432b[_0xa7913d(0x18b)]);}}else logger['full'](_0xa7913d(0x1e3));}else logger['full'](_0xa7913d(0x311));}),app['use'](express[_0x549688(0x2c4)](path[_0x549688(0x251)](__dirname,bbpath2,_0x549688(0x2ee)))),app['use'](express[_0x549688(0x2c4)](path['join'](__dirname,bbpath2,_0x549688(0x1d3)))),app[_0x549688(0x2f5)]('/',function(_0xc463fe,_0x1cdcd1){const _0x2e5326=_0x549688;_0x1cdcd1[_0x2e5326(0x203)](path[_0x2e5326(0x251)](__dirname,bbpath2,_0x2e5326(0x2ee),_0x2e5326(0x2a7)));}),app[_0x549688(0x2f5)](_0x549688(0x2ca),function(_0x3a6c26,_0x1551ec){const _0x229f5a=_0x549688;_0x1551ec[_0x229f5a(0x203)](path['join'](__dirname,bbpath2,'build',_0x229f5a(0x2a7)));}),app[_0x549688(0x2f5)]('/:bot/portfolio',(_0x1dce7b,_0x18d41b)=>{const _0x20b670=_0x549688;_0x18d41b[_0x20b670(0x203)](path[_0x20b670(0x251)](__dirname,bbpath2,_0x20b670(0x1d3),_0x20b670(0x2a7)));}),app[_0x549688(0x2f5)]('/:bot/performance',(_0x573530,_0x27d8b0)=>{const _0x116d80=_0x549688;_0x27d8b0[_0x116d80(0x203)](path[_0x116d80(0x251)](__dirname,bbpath2,_0x116d80(0x1d3),'index.html'));}),app['get'](_0x549688(0x25b),(_0x5c893c,_0x31f995)=>{const _0x179837=_0x549688;_0x31f995[_0x179837(0x203)](path[_0x179837(0x251)](__dirname,bbpath2,_0x179837(0x1d3),'index.html'));}),app[_0x549688(0x2f5)](_0x549688(0x26f),(_0x319f26,_0x4d754d)=>{const _0x4c2f6c=_0x549688;_0x4d754d[_0x4c2f6c(0x203)](path[_0x4c2f6c(0x251)](__dirname,bbpath2,_0x4c2f6c(0x1d3),_0x4c2f6c(0x2a7)));}),app[_0x549688(0x2f5)](_0x549688(0x27c),(_0x4c63cf,_0x387a85)=>{const _0x2e6c74=_0x549688;_0x387a85[_0x2e6c74(0x203)](path[_0x2e6c74(0x251)](__dirname,bbpath2,'build','index.html'));}),app[_0x549688(0x2f5)](_0x549688(0x17b),(_0x32f269,_0x54af41)=>{const _0x2765e5=_0x549688;_0x54af41[_0x2765e5(0x203)](path['join'](__dirname,bbpath2,_0x2765e5(0x1d3),'index.html'));});if(HOST)http[_0x549688(0x222)](PORT,HOST);else http[_0x549688(0x222)](PORT);const io=require(_0x549688(0x1a9))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x126bb0=_0x549688;let _0x1eda53=_0x126bb0(0x232);const _0x47d35e=networkInterfaces(),_0x36a7e9={};for(const _0x10c892 of Object['keys'](_0x47d35e)){for(const _0x126139 of _0x47d35e[_0x10c892]){if((_0x126139[_0x126bb0(0x234)]==_0x126bb0(0x22b)||_0x126139[_0x126bb0(0x234)]==0x4)&&!_0x126139['internal']){const _0x2df2e5=ipaddr['parse'](_0x126139['address'])['range']();_0x2df2e5!=_0x126bb0(0x1df)&&(!_0x36a7e9[_0x10c892]&&(_0x36a7e9[_0x10c892]=[]),_0x36a7e9[_0x10c892][_0x126bb0(0x1ae)](_0x126139[_0x126bb0(0x2d3)]),_0x1eda53=_0x126139[_0x126bb0(0x2d3)]);}}}return{'serverip':_0x1eda53,'netinterfaces':_0x36a7e9};}async function startServer(){const _0x5c50ff=_0x549688,{serverip:_0x83b40a,netinterfaces:_0x241683}=getServerIP();logger[_0x5c50ff(0x16d)](''),logger[_0x5c50ff(0x16d)]('-----------------------------------------------------------------------------------'),await logger[_0x5c50ff(0x242)](_0x5c50ff(0x1c4)+serverversion+_0x5c50ff(0x248)+(environment==_0x5c50ff(0x279)?_0x5c50ff(0x1a2):'')+'\x0a'+(_0x5c50ff(0x1bb)+PORT+_0x5c50ff(0x206))+(_0x5c50ff(0x179)+_0x83b40a+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x5c50ff(0x16d)](_0x5c50ff(0x2d5));if(config[_0x5c50ff(0x338)]!=0x0)for(const _0x4d31c5 of config){if(_0x4d31c5['status']==_0x5c50ff(0x1fe)||_0x4d31c5[_0x5c50ff(0x170)]=='new')await logger[_0x5c50ff(0x242)](_0x5c50ff(0x1d0)+_0x4d31c5[_0x5c50ff(0x16e)]+_0x5c50ff(0x317)+_0x4d31c5[_0x5c50ff(0x2d1)]),startBot([_0x4d31c5[_0x5c50ff(0x16e)],userID],{'cwd':bbpath},function(_0x544bea){if(_0x544bea)logger['full'](_0x544bea);});else(_0x4d31c5[_0x5c50ff(0x170)]==_0x5c50ff(0x195)||_0x4d31c5['status']==_0x5c50ff(0x1ec))&&await logger[_0x5c50ff(0x242)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x4d31c5[_0x5c50ff(0x16e)]+_0x5c50ff(0x317)+_0x4d31c5['botname']);}else!newBot&&logger[_0x5c50ff(0x16d)](_0x5c50ff(0x2b5));if(newBot)addBot();logger[_0x5c50ff(0x16d)]('-----------------------------------------------------------------------------------'),logger[_0x5c50ff(0x16d)](''),await logger[_0x5c50ff(0x266)]('Node.js\x20v'+nodeversion),await logger[_0x5c50ff(0x266)](_0x5c50ff(0x28f),_0x241683);}function startSocket(){io['on']('connection',_0x1a6e9f=>{const _0x2f0e5b=_0x3572;let _0x1a7c3f,_0xaf27aa,_0x1fa9d5,_0x38aad3,_0x46d1c3;const _0x5468da=_0x1a6e9f['handshake']['headers'][_0x2f0e5b(0x21e)];_0xaf27aa=_0x5468da['match'](/bot[0-9]{3}/);if(_0xaf27aa)_0x1fa9d5=_0xaf27aa[0x0][_0x2f0e5b(0x320)](/[0-9]{3}/);if(_0x1fa9d5)_0x1a7c3f=_0x1fa9d5[0x0];else _0x1a7c3f=_0x2f0e5b(0x223);const _0x7bab2c=_0x1a6e9f[_0x2f0e5b(0x271)][_0x2f0e5b(0x292)][_0x2f0e5b(0x2d2)];if(!_0x7bab2c)_0x1a6e9f['emit'](_0x2f0e5b(0x170),{'publicKey':secure[_0x2f0e5b(0x2fe)]});else{_0x38aad3=timelyDecrypt(_0x7bab2c,![]);if(!_0x38aad3)_0x1a6e9f[_0x2f0e5b(0x171)](_0x2f0e5b(0x170),{'publicKey':secure[_0x2f0e5b(0x2fe)]});else{_0x46d1c3=normalizeIP(_0x1a6e9f[_0x2f0e5b(0x245)][_0x2f0e5b(0x1f8)])[_0x2f0e5b(0x1f6)];if(!devices[_0x38aad3])devices[_0x38aad3]={'uuid':_0x38aad3,'access':{'token':null}};devices[_0x38aad3]['ip']=_0x46d1c3;const _0x137595=addClient(_0x1a6e9f['id'],_0x38aad3,_0x1a7c3f);setAccess(_0x137595),emitMessages(),_0x1a6e9f['on']('login',_0x2907b4=>{const _0x5065d7=_0x2f0e5b,_0x5acb0c=timelyDecrypt(_0x2907b4[_0x5065d7(0x2b3)]);if(_0x5acb0c){_0x2907b4={'username':_0x2907b4['username'],'password':_0x5acb0c},devices[_0x38aad3][_0x5065d7(0x30f)]=validateCredentials(_0x2907b4,_0x38aad3);if(devices[_0x38aad3][_0x5065d7(0x30f)]['allow']==![]&&devices[_0x38aad3]['access']['reason']==_0x5065d7(0x26e))_0x1a6e9f[_0x5065d7(0x171)](_0x5065d7(0x170),{'access':devices[_0x38aad3][_0x5065d7(0x30f)]}),loginAccess2FA(_0x38aad3,_0x46d1c3);else{if(devices[_0x38aad3][_0x5065d7(0x30f)]['allow']==![]&&devices[_0x38aad3]['access'][_0x5065d7(0x2bc)]==_0x5065d7(0x314))_0x1a6e9f['emit'](_0x5065d7(0x170),{'access':devices[_0x38aad3][_0x5065d7(0x30f)]});else devices[_0x38aad3][_0x5065d7(0x30f)][_0x5065d7(0x24e)]&&devices[_0x38aad3][_0x5065d7(0x30f)][_0x5065d7(0x2bc)]==_0x5065d7(0x2dc)&&(getClientsWithUuid(_0x38aad3)[_0x5065d7(0x1bc)](_0x504c02=>{setAccess(_0x504c02);}),logger[_0x5065d7(0x266)]('Logged\x20in\x20user\x20...'+_0x38aad3[_0x5065d7(0x28d)](-0x8)),setTokenRefresh(_0x38aad3),setSessionTimeout(_0x5065d7(0x17d),_0x38aad3));}}else logger['full'](_0x5065d7(0x1f7));}),_0x1a6e9f['on'](_0x2f0e5b(0x30d),()=>{resetPassword();}),_0x1a6e9f['on'](_0x2f0e5b(0x182),_0x100d9f=>{removeClient(_0x1a6e9f['id']);}),_0x1a7c3f==_0x2f0e5b(0x223)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x10cece){const _0xe204c=_0x549688;if(_0x10cece!=_0xe204c(0x223)&&config[_0xe204c(0x169)]!=''){if(pid[_0x10cece])pid[_0x10cece]['send']({'function':'initclient','args':null});}_0x10cece!=_0xe204c(0x223)&&broadcastToBots(_0xe204c(0x2e2),JSON[_0xe204c(0x1bf)](config));}function reloadBotManager(){const _0x36f580=_0x549688;getClientsWithBotID('botmanager')[_0x36f580(0x1bc)](_0x44a4f7=>{const _0x4fcc4a=_0x36f580;getSocket(_0x44a4f7['id'])['emit'](_0x4fcc4a(0x170),{'access':{'allow':![],'reason':_0x4fcc4a(0x2ea),'token':null}});});}function getSocket(_0x1bf20f){const _0x43bf2a=_0x549688;return io[_0x43bf2a(0x1b3)][_0x43bf2a(0x1b3)][_0x43bf2a(0x2f5)](_0x1bf20f);}function setAccess(_0x2cb9be){const _0x4e4229=_0x549688,_0x1cfab6=getSocket(_0x2cb9be['id']),_0x5cd95d=_0x2cb9be[_0x4e4229(0x262)],_0x15b404=_0x2cb9be[_0x4e4229(0x1cb)];devices[_0x5cd95d][_0x4e4229(0x30f)]=validateAccess(devices[_0x5cd95d][_0x4e4229(0x30f)]['token'],_0x5cd95d),logger[_0x4e4229(0x266)]('Setting\x20access:\x20'+devices[_0x5cd95d]['access'][_0x4e4229(0x2bc)]+_0x4e4229(0x212)+_0x2cb9be['id'][_0x4e4229(0x28d)](-0x8)+_0x4e4229(0x2d0)+_0x5cd95d['slice'](-0x8)),_0x1cfab6[_0x4e4229(0x251)](_0x5cd95d);if(devices[_0x5cd95d][_0x4e4229(0x30f)][_0x4e4229(0x24e)]){_0x1cfab6[_0x4e4229(0x251)](_0x15b404);if(_0x15b404==_0x4e4229(0x223))initializeSocketBotManager(_0x1cfab6);else initializeSocketBot(_0x1cfab6);initClient(_0x15b404);}devices[_0x5cd95d][_0x4e4229(0x30f)][_0x4e4229(0x2e1)]&&devices[_0x5cd95d][_0x4e4229(0x30f)][_0x4e4229(0x2bc)]==_0x4e4229(0x18a)&&setSessionTimeout(_0x4e4229(0x252),_0x5cd95d),devices[_0x5cd95d][_0x4e4229(0x30f)][_0x4e4229(0x2e1)]&&devices[_0x5cd95d]['access'][_0x4e4229(0x2bc)]==_0x4e4229(0x2ac)&&setSessionTimeout('login',_0x5cd95d),_0x1cfab6[_0x4e4229(0x171)](_0x4e4229(0x170),{'status':_0x2cb9be[_0x4e4229(0x1b5)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5cd95d][_0x4e4229(0x30f)],'externalip':devices[_0x5cd95d]['ip'],'publicKey':secure[_0x4e4229(0x2fe)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x5cd95d]['access']['allow']==![]&&devices[_0x5cd95d][_0x4e4229(0x30f)][_0x4e4229(0x2bc)]==_0x4e4229(0x328)&&temporaryAccess2FA(_0x5cd95d,devices[_0x5cd95d]['ip']);}function setSessionTimeout(_0x32dbe0,_0x2c04ee){const _0x579916=_0x549688;let _0x174633;if(_0x32dbe0==_0x579916(0x17d))_0x174633=loginExpiry*0x3c*0x3e8;else _0x174633=devices[_0x2c04ee][_0x579916(0x1d2)][_0x579916(0x2e6)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x2c04ee]['telegramIpApproval'][_0x579916(0x21c)]);if(devices[_0x2c04ee]['pidExpireLogin'])clearTimeout(devices[_0x2c04ee]['pidExpireLogin']);devices[_0x2c04ee][_0x579916(0x204)]=setTimeout(()=>{const _0x174438=_0x579916;if(devices[_0x2c04ee][_0x174438(0x18f)])clearTimeout(devices[_0x2c04ee][_0x174438(0x18f)]);removeSocketListeners(_0x2c04ee),addBlacklist(_0x2c04ee),devices[_0x2c04ee][_0x174438(0x1d2)]=null,devices[_0x2c04ee][_0x174438(0x33c)]=null,devices[_0x2c04ee][_0x174438(0x30f)][_0x174438(0x2e1)]=null,logger[_0x174438(0x266)](_0x174438(0x2c9)+_0x2c04ee['slice'](-0x8)),devices[_0x2c04ee][_0x174438(0x30f)]=validateAccess(devices[_0x2c04ee]['access'][_0x174438(0x2e1)],_0x2c04ee),!(devices[_0x2c04ee]['access']['allow']&&devices[_0x2c04ee][_0x174438(0x30f)][_0x174438(0x2bc)]==_0x174438(0x28e))&&(_0x32dbe0==_0x174438(0x17d)?io['to'](_0x2c04ee)[_0x174438(0x171)](_0x174438(0x170),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x2c04ee)[_0x174438(0x171)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x2c04ee]['access'][_0x174438(0x2e1)]=null;},_0x174633);}function setTokenRefresh(_0x2ed4cc){const _0x369b18=_0x549688;if(devices[_0x2ed4cc][_0x369b18(0x18f)])clearTimeout(devices[_0x2ed4cc]['pidRefreshToken']);devices[_0x2ed4cc][_0x369b18(0x18f)]=setTimeout(()=>{const _0x1119cd=_0x369b18;getClientsWithUuid(_0x2ed4cc)[_0x1119cd(0x338)]!=0x0?(devices[_0x2ed4cc]['access']=refreshToken(_0x2ed4cc),io['to'](_0x2ed4cc)[_0x1119cd(0x171)]('status',{'status':_0x1119cd(0x325),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2ed4cc][_0x1119cd(0x30f)],'externalip':devices[_0x2ed4cc]['ip'],'publicKey':secure[_0x1119cd(0x2fe)],'validInstallation':validInstallation}),setTokenRefresh(_0x2ed4cc)):clearTimeout(devices[_0x2ed4cc][_0x1119cd(0x18f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2784e8){const _0x3fbcda=_0x549688,_0x293c7c=getClient(_0x2784e8['id'])[_0x3fbcda(0x262)];_0x2784e8['emit']('bots',config),_0x2784e8[_0x3fbcda(0x171)](_0x3fbcda(0x2da),cleanSettings()),_0x2784e8['on'](_0x3fbcda(0x283),_0x2e44d8=>{const _0x3092af=_0x3fbcda;if(validateAccess(_0x2e44d8,_0x293c7c)[_0x3092af(0x24e)])addBot();else logger[_0x3092af(0x242)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2784e8['on'](_0x3fbcda(0x2c7),(_0x5874e9,_0x265b6f)=>{const _0x2d7e4c=_0x3fbcda;if(validateAccess(_0x265b6f,_0x293c7c)[_0x2d7e4c(0x24e)])toggleBot(_0x5874e9[_0x2d7e4c(0x16e)],_0x5874e9[_0x2d7e4c(0x170)],_0x5874e9['live']);else logger[_0x2d7e4c(0x242)](_0x2d7e4c(0x32e));}),_0x2784e8['on'](_0x3fbcda(0x207),(_0x59a1c2,_0x373543)=>{const _0x88ccd2=_0x3fbcda;if(validateAccess(_0x373543,_0x293c7c)['allow'])toggleBotMode(_0x59a1c2);else logger[_0x88ccd2(0x242)](_0x88ccd2(0x32e));}),_0x2784e8['on'](_0x3fbcda(0x2a0),(_0x34a33b,_0xd57593)=>{const _0x2eee5f=_0x3fbcda;if(validateAccess(_0xd57593,_0x293c7c)[_0x2eee5f(0x24e)])deleteBot(_0x34a33b);else logger[_0x2eee5f(0x242)](_0x2eee5f(0x2d9));}),_0x2784e8['on'](_0x3fbcda(0x2d7),(_0x1bfcf8,_0xe7228c)=>{const _0x5c9ea0=_0x3fbcda;if(validateAccess(_0xe7228c,_0x293c7c)[_0x5c9ea0(0x24e)])storeSettings(_0x1bfcf8,!![]);else logger['full'](_0x5c9ea0(0x1c5));}),_0x2784e8['on'](_0x3fbcda(0x2d4),_0x265993=>{const _0x36e22b=_0x3fbcda;if(validateAccess(_0x265993,_0x293c7c)['allow'])updateBB(_0x36e22b(0x19e));else logger[_0x36e22b(0x242)](_0x36e22b(0x1fb));}),_0x2784e8['on']('reinstall-bb',_0x482c14=>{const _0x592216=_0x3fbcda;if(validateAccess(_0x482c14,_0x293c7c)[_0x592216(0x24e)])updateBB(_0x592216(0x2d6));else logger[_0x592216(0x242)](_0x592216(0x327));}),_0x2784e8['on'](_0x3fbcda(0x261),_0xa2ba58=>{const _0x247d42=_0x3fbcda;if(validateAccess(_0xa2ba58,_0x293c7c)[_0x247d42(0x24e)]){const _0x3c82e5=getClient(_0x2784e8['id']);if(_0x3c82e5)getBackupFiles(_0x3c82e5[_0x247d42(0x262)]);else logger[_0x247d42(0x242)](_0x247d42(0x331));}else logger['full'](_0x247d42(0x18e));}),_0x2784e8['on'](_0x3fbcda(0x2be),(_0xbd71e6,_0x993b00)=>{const _0x56a718=_0x3fbcda;if(validateAccess(_0x993b00,_0x293c7c)['allow'])restoreBackupFile(_0xbd71e6);else logger[_0x56a718(0x242)](_0x56a718(0x2ff));}),_0x2784e8['on']('get-messages',_0x399a5d=>{const _0x3e5786=_0x3fbcda;if(validateAccess(_0x399a5d,_0x293c7c)[_0x3e5786(0x24e)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2784e8['on'](_0x3fbcda(0x334),(_0x5d047f,_0x446e9e)=>{const _0x310e9c=_0x3fbcda;if(validateAccess(_0x446e9e,_0x293c7c)[_0x310e9c(0x24e)])confirmMessage(_0x5d047f);else logger['full'](_0x310e9c(0x16f));}),_0x2784e8['on']('logout',_0xda9aa0=>{const _0x4b8140=_0x3fbcda;if(validateAccess(_0xda9aa0,_0x293c7c)[_0x4b8140(0x24e)]){if(devices[_0x293c7c]['pidRefreshToken'])clearTimeout(devices[_0x293c7c][_0x4b8140(0x18f)]);if(devices[_0x293c7c]['pidExpireLogin'])clearTimeout(devices[_0x293c7c][_0x4b8140(0x204)]);removeSocketListeners(getClient(_0x2784e8['id'])[_0x4b8140(0x262)]),addBlacklist(_0x293c7c),devices[_0x293c7c][_0x4b8140(0x1d2)]=null,devices[_0x293c7c][_0x4b8140(0x33c)]=null,devices[_0x293c7c][_0x4b8140(0x30f)]['token']=null,logger[_0x4b8140(0x266)]('Logged\x20out\x20user\x20...'+_0x293c7c[_0x4b8140(0x28d)](-0x8)),io['to'](getClient(_0x2784e8['id'])[_0x4b8140(0x262)])[_0x4b8140(0x171)](_0x4b8140(0x170),{'access':{'allow':![],'reason':_0x4b8140(0x304),'token':null}});}else logger[_0x4b8140(0x242)](_0x4b8140(0x2fa));});}function initializeSocketBot(_0x100981){const _0x5d0517=_0x549688,_0x5f0bf9=getClient(_0x100981['id'])[_0x5d0517(0x1cb)],_0x4e5a8f=getClient(_0x100981['id'])[_0x5d0517(0x262)];_0x100981['on']('get-logs',(_0x343f19,_0x18fcb9)=>{const _0x9c635a=_0x5d0517;if(validateAccess(_0x18fcb9,_0x4e5a8f)[_0x9c635a(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9][_0x9c635a(0x291)]({'function':_0x9c635a(0x27a),'args':_0x343f19});}else logger[_0x9c635a(0x242)](_0x9c635a(0x189));}),_0x100981['on'](_0x5d0517(0x1d7),(_0x172202,_0x297559)=>{const _0x1644da=_0x5d0517;if(validateAccess(_0x297559,_0x4e5a8f)['allow']){if(pid[_0x5f0bf9])pid[_0x5f0bf9][_0x1644da(0x291)]({'function':_0x1644da(0x1e8),'args':_0x172202});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x100981['on']('get-portfolio',(_0x43b0e,_0x155898)=>{const _0x2c7b65=_0x5d0517;if(validateAccess(_0x155898,_0x4e5a8f)[_0x2c7b65(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9][_0x2c7b65(0x291)]({'function':_0x2c7b65(0x2f3),'args':_0x43b0e});}else logger[_0x2c7b65(0x242)](_0x2c7b65(0x1ee));}),_0x100981['on'](_0x5d0517(0x2ec),(_0x4e787d,_0x4290c1)=>{const _0x2e9a60=_0x5d0517;if(validateAccess(_0x4290c1,_0x4e5a8f)[_0x2e9a60(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9][_0x2e9a60(0x291)]({'function':'storeConfiguration','args':_0x4e787d});}else logger[_0x2e9a60(0x242)](_0x2e9a60(0x27b));}),_0x100981['on']('store-headless',(_0x13364c,_0x5b8ba9)=>{const _0x47836a=_0x5d0517;if(validateAccess(_0x5b8ba9,_0x4e5a8f)[_0x47836a(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9]['send']({'function':_0x47836a(0x20f),'args':_0x13364c});}else logger[_0x47836a(0x242)](_0x47836a(0x258));}),_0x100981['on'](_0x5d0517(0x1de),(_0x5b9312,_0x24ec9b)=>{const _0x10335a=_0x5d0517;if(validateAccess(_0x24ec9b,_0x4e5a8f)['allow']){if(pid[_0x5f0bf9])pid[_0x5f0bf9]['send']({'function':_0x10335a(0x19d),'args':_0x5b9312});}else logger[_0x10335a(0x242)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x100981['on'](_0x5d0517(0x2e5),_0x21ecde=>{const _0x449066=_0x5d0517;if(validateAccess(_0x21ecde,_0x4e5a8f)[_0x449066(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9][_0x449066(0x291)]({'function':_0x449066(0x28a),'args':null});}else logger[_0x449066(0x242)](_0x449066(0x301));}),_0x100981['on'](_0x5d0517(0x217),_0x34aa3d=>{const _0xa9208e=_0x5d0517;if(validateAccess(_0x34aa3d,_0x4e5a8f)[_0xa9208e(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9]['send']({'function':_0xa9208e(0x296),'args':null});}else logger[_0xa9208e(0x242)](_0xa9208e(0x239));}),_0x100981['on'](_0x5d0517(0x1fc),(_0x989b47,_0x304a9c)=>{const _0x233420=_0x5d0517;if(validateAccess(_0x304a9c,_0x4e5a8f)[_0x233420(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9]['send']({'function':'placeOrder','args':_0x989b47});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x100981['on'](_0x5d0517(0x1e1),_0x453a59=>{const _0x5ec0df=_0x5d0517;if(validateAccess(_0x453a59,_0x4e5a8f)[_0x5ec0df(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9]['send']({'function':_0x5ec0df(0x209),'args':null});}else logger[_0x5ec0df(0x242)](_0x5ec0df(0x243));}),_0x100981['on']('show-config',_0x134b46=>{const _0x3f5d4b=_0x5d0517;if(validateAccess(_0x134b46,_0x4e5a8f)[_0x3f5d4b(0x24e)]){if(pid[_0x5f0bf9])pid[_0x5f0bf9][_0x3f5d4b(0x291)]({'function':'showConfig','args':null});}else logger[_0x3f5d4b(0x242)](_0x3f5d4b(0x1ea));}),_0x100981['on']('update-bb',_0x4f0210=>{const _0x325976=_0x5d0517;if(validateAccess(_0x4f0210,_0x4e5a8f)[_0x325976(0x24e)])updateBB(_0x325976(0x19e));else logger[_0x325976(0x242)](_0x325976(0x1fb));}),_0x100981['on']('get-messages',_0x48975f=>{const _0x483318=_0x5d0517;if(validateAccess(_0x48975f,_0x4e5a8f)['allow'])getMessages();else logger[_0x483318(0x242)](_0x483318(0x191));}),_0x100981['on'](_0x5d0517(0x334),(_0x74e020,_0x4b091f)=>{const _0x4b24d6=_0x5d0517;if(validateAccess(_0x4b091f,_0x4e5a8f)[_0x4b24d6(0x24e)])confirmMessage(_0x74e020);else logger['full'](_0x4b24d6(0x16f));}),_0x100981['on'](_0x5d0517(0x293),_0x26ea4f=>{const _0x44ac7e=_0x5d0517;if(validateAccess(_0x26ea4f,_0x4e5a8f)[_0x44ac7e(0x24e)]){if(devices[_0x4e5a8f][_0x44ac7e(0x18f)])clearTimeout(devices[_0x4e5a8f][_0x44ac7e(0x18f)]);if(devices[_0x4e5a8f][_0x44ac7e(0x204)])clearTimeout(devices[_0x4e5a8f][_0x44ac7e(0x204)]);removeSocketListeners(getClient(_0x100981['id'])[_0x44ac7e(0x262)]),addBlacklist(_0x4e5a8f),devices[_0x4e5a8f][_0x44ac7e(0x1d2)]=null,devices[_0x4e5a8f]['telegram2FaApproval']=null,devices[_0x4e5a8f][_0x44ac7e(0x30f)][_0x44ac7e(0x2e1)]=null,logger[_0x44ac7e(0x266)]('Logged\x20out\x20user\x20...'+_0x4e5a8f[_0x44ac7e(0x28d)](-0x8)),io['to'](getClient(_0x100981['id'])[_0x44ac7e(0x262)])[_0x44ac7e(0x171)](_0x44ac7e(0x170),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x44ac7e(0x242)](_0x44ac7e(0x2fa));});}function removeSocketListeners(_0x44c0c5){const _0x2692bf=_0x549688;getClientsWithUuid(_0x44c0c5)[_0x2692bf(0x1bc)](_0x265c4e=>{const _0x2a0078=_0x2692bf;getSocket(_0x265c4e['id'])[_0x2a0078(0x2c3)]();});}function cleanSettings(){const _0x4b9882=_0x549688;let _0x27ed62=settings;return settings['telegramToken']&&settings[_0x4b9882(0x29c)]!=''&&(_0x27ed62={..._0x27ed62,'telegramToken':_0x4b9882(0x2db)}),settings['bbPassword']&&settings[_0x4b9882(0x24b)]!=''&&(_0x27ed62={..._0x27ed62,'bbPassword':_0x4b9882(0x2db)}),(settings[_0x4b9882(0x24b)]&&settings['bbPassword']==_0x4b9882(0x202)||settings['telegramToken']&&settings['telegramToken']=='***')&&(_0x27ed62={..._0x27ed62,'restored':{'password':settings[_0x4b9882(0x24b)]==_0x4b9882(0x202),'telegram':settings[_0x4b9882(0x29c)]==_0x4b9882(0x202)}}),_0x27ed62;}async function updateBB(_0xebce69){const _0x59cf=_0x549688;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x37c594=>{const _0x2b7b36=_0x3572;restartBot(_0x37c594[_0x2b7b36(0x16e)]);});if(_0xebce69=='update')process[_0x59cf(0x291)]({'update':!![],'environment':environment},_0x136f9c=>{});else _0xebce69==_0x59cf(0x2d6)&&process[_0x59cf(0x291)]({'reinstall':!![],'environment':environment},_0x33430c=>{});}function startBot(_0x207ac0,_0x5a6efe,_0x6b1efc){const _0x3cefb3=_0x549688;if(debugging)_0x207ac0['push']('-d');let _0x5a7c8b=![];const _0x3568d6=_0x207ac0[0x0];_0x5a6efe={..._0x5a6efe,'stdio':['inherit',_0x3cefb3(0x26c),_0x3cefb3(0x26c),_0x3cefb3(0x173)]},pid[_0x3568d6]=childProcess[_0x3cefb3(0x1ba)](botfile,_0x207ac0,_0x5a6efe),pid[_0x3568d6]['on'](_0x3cefb3(0x228),_0x48ff01=>{const _0x33d221=_0x3cefb3;switch(Object[_0x33d221(0x2b9)](_0x48ff01)[0x0]){case'botname':updateBotName(_0x3568d6,_0x48ff01[_0x33d221(0x2d1)]);break;case'updatebotmanager':updateBotManager();break;case _0x33d221(0x170):updateStatus(_0x3568d6,_0x48ff01['status']);break;case'live':updateLive(_0x3568d6,_0x48ff01[_0x33d221(0x30a)]);break;case _0x33d221(0x174):updateLive(_0x3568d6,_0x48ff01[_0x33d221(0x174)]),io['to'](_0x3568d6)[_0x33d221(0x171)](_0x33d221(0x170),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x33d221(0x19b):_0x48ff01[_0x33d221(0x19b)]==_0x33d221(0x256)&&restartBot(_0x3568d6);_0x48ff01['stop']==_0x33d221(0x2dd)&&toggleBot(_0x3568d6,'disabled',_0x33d221(0x2b4));break;case _0x33d221(0x1ab):sendTelegram(_0x3568d6,_0x48ff01[_0x33d221(0x1ab)]);break;case _0x33d221(0x299):sendTelegramMsg(_0x48ff01[_0x33d221(0x299)]);break;case'function':io['to'](_0x3568d6)[_0x33d221(0x171)](_0x48ff01[_0x33d221(0x20e)],_0x48ff01['args']);break;}}),pid[_0x3568d6]['on'](_0x3cefb3(0x178),function(_0x5d5efa){if(_0x5a7c8b)return;_0x5a7c8b=!![],_0x6b1efc(_0x5d5efa);}),pid[_0x3568d6]['on'](_0x3cefb3(0x2cf),async function(_0x2f3720){const _0x5a6648=_0x3cefb3;if(installingUpdate)return;if(_0x5a7c8b)return;_0x5a7c8b=!![],_0x6b1efc(null);const _0x2ad37e=dbConfig['get']('bots')['find']({'botID':_0x3568d6})[_0x5a6648(0x1eb)]();_0x2ad37e&&(_0x2ad37e[_0x5a6648(0x170)]==_0x5a6648(0x1fe)||_0x2ad37e['status']==_0x5a6648(0x282))&&(await sleep(0x3e8),updateLive(_0x3568d6,'stopped'),logger['full'](_0x5a6648(0x21a)+_0x3568d6),startBot([_0x3568d6,userID],{'cwd':bbpath},function(_0x26ccce){const _0x14d6f0=_0x5a6648;if(_0x26ccce)logger[_0x14d6f0(0x242)](_0x26ccce);}));});}function stopBot(_0x1c716a){const _0x507add=_0x549688;getClientsWithBotID(_0x1c716a)['forEach'](_0x582c31=>{const _0x489eec=_0x3572;getSocket(_0x582c31['id'])[_0x489eec(0x182)](!![]),removeClient(_0x582c31['id']);}),pid[_0x1c716a]&&(pid[_0x1c716a][_0x507add(0x2dd)](),pid[_0x1c716a]=null);}function restartBot(_0x51124d){const _0x3fa69c=_0x549688;if(pid[_0x51124d])pid[_0x51124d][_0x3fa69c(0x2dd)]();}function addBot(){const _0x98f83d=_0x549688;let _0x21c6f9;for(let _0x3ca4a1=0x1;_0x3ca4a1<0x3e9;_0x3ca4a1++){_0x21c6f9=_0x3ca4a1[_0x98f83d(0x2c5)]()[_0x98f83d(0x2de)](0x3,'0');let _0x1e8c74=config[_0x98f83d(0x1c3)](_0x1a4ad5=>_0x1a4ad5[_0x98f83d(0x16e)]==_0x21c6f9);if(!_0x1e8c74)break;}if(_0x21c6f9===_0x98f83d(0x1c8)){logger['full'](_0x98f83d(0x196));return;}logger[_0x98f83d(0x242)](_0x98f83d(0x1d5)+_0x21c6f9),dbConfig[_0x98f83d(0x2f5)](_0x98f83d(0x2e2))[_0x98f83d(0x1ae)]({'botID':_0x21c6f9,'botname':'Bot\x20'+_0x21c6f9,'status':_0x98f83d(0x282),'live':''})[_0x98f83d(0x27e)](),startBot([_0x21c6f9,userID],{'cwd':bbpath},function(_0x1471a0){const _0x14460d=_0x98f83d;if(_0x1471a0)logger[_0x14460d(0x242)](_0x1471a0);}),config=getConfiguration(),io['to'](_0x98f83d(0x223))[_0x98f83d(0x171)](_0x98f83d(0x2e2),config),broadcastToBots(_0x98f83d(0x2e2),JSON['stringify'](config));}function deleteBot(_0x446498){const _0x5a5b9e=_0x549688;getClientsWithBotID(_0x446498)[_0x5a5b9e(0x1bc)](_0x5cfc1b=>{const _0x5ad8e9=_0x5a5b9e;getSocket(_0x5cfc1b['id'])[_0x5ad8e9(0x182)](!![]),removeClient(_0x5cfc1b['id']);}),dbConfig['get'](_0x5a5b9e(0x2e2))[_0x5a5b9e(0x273)]({'botID':_0x446498})['write'](),logger['full'](_0x5a5b9e(0x270)+_0x446498),stopBot(_0x446498);try{if(fs['existsSync'](path[_0x5a5b9e(0x251)](configpath,_0x5a5b9e(0x312)+_0x446498+'-config.json')))fs[_0x5a5b9e(0x193)](path[_0x5a5b9e(0x251)](configpath,_0x5a5b9e(0x312)+_0x446498+_0x5a5b9e(0x335)));if(fs[_0x5a5b9e(0x200)](path[_0x5a5b9e(0x251)](configpath,'bot-'+_0x446498+_0x5a5b9e(0x254))))fs[_0x5a5b9e(0x193)](path[_0x5a5b9e(0x251)](configpath,_0x5a5b9e(0x312)+_0x446498+_0x5a5b9e(0x254)));if(fs[_0x5a5b9e(0x200)](path[_0x5a5b9e(0x251)](configpath,_0x5a5b9e(0x312)+_0x446498+_0x5a5b9e(0x25f))))fs[_0x5a5b9e(0x193)](path[_0x5a5b9e(0x251)](configpath,'bot-'+_0x446498+_0x5a5b9e(0x25f)));if(fs['existsSync'](path[_0x5a5b9e(0x251)](configpath,_0x5a5b9e(0x312)+_0x446498+_0x5a5b9e(0x2f1))))fs['unlinkSync'](path[_0x5a5b9e(0x251)](configpath,_0x5a5b9e(0x312)+_0x446498+_0x5a5b9e(0x2f1)));}catch(_0x560ccc){if(_0x560ccc)logger[_0x5a5b9e(0x242)](_0x5a5b9e(0x250),_0x560ccc);}config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x5a5b9e(0x2e2),JSON['stringify'](config));}function toggleBot(_0x283f03,_0x56c5b8,_0x4c4f09){const _0xa16d32=_0x549688;dbConfig['get'](_0xa16d32(0x2e2))[_0xa16d32(0x1c3)]({'botID':_0x283f03})[_0xa16d32(0x2c2)]({'status':_0x56c5b8})[_0xa16d32(0x2c2)]({'live':_0x4c4f09})[_0xa16d32(0x27e)]();if(_0x56c5b8==_0xa16d32(0x1fe)||_0x56c5b8==_0xa16d32(0x282))logger[_0xa16d32(0x242)](_0xa16d32(0x1dd)+_0x283f03),startBot([_0x283f03,userID],{'cwd':bbpath},function(_0x46f843){const _0x58a836=_0xa16d32;if(_0x46f843)logger[_0x58a836(0x242)](_0x46f843);});else(_0x56c5b8==_0xa16d32(0x195)||_0x56c5b8=='new-disabled')&&(logger['full'](_0xa16d32(0x25d)+_0x283f03),stopBot(_0x283f03));config=getConfiguration(),io['to']('botmanager')[_0xa16d32(0x171)]('bots',config),broadcastToBots(_0xa16d32(0x2e2),JSON[_0xa16d32(0x1bf)](config));}function toggleStatus(_0x220324){const _0x340e81=_0x549688;let _0x4b1836=dbConfig[_0x340e81(0x2f5)]('bots')[_0x340e81(0x1c3)]({'botID':_0x220324})[_0x340e81(0x1eb)](),_0x5df087;if(_0x4b1836[_0x340e81(0x170)]===_0x340e81(0x1fe))_0x5df087=_0x340e81(0x195);else{if(_0x4b1836[_0x340e81(0x170)]==='new')_0x5df087=_0x340e81(0x1ec);else{if(_0x4b1836[_0x340e81(0x170)]===_0x340e81(0x1ec))_0x5df087=_0x340e81(0x282);else{if(_0x4b1836[_0x340e81(0x170)]===_0x340e81(0x195))_0x5df087='enabled';}}}return _0x5df087;}function updateStatus(_0x49beee,_0xe98481){const _0x3ffa7b=_0x549688;dbConfig[_0x3ffa7b(0x2f5)](_0x3ffa7b(0x2e2))[_0x3ffa7b(0x1c3)]({'botID':_0x49beee})[_0x3ffa7b(0x2c2)]({'status':_0xe98481})[_0x3ffa7b(0x27e)](),config=getConfiguration(),io['to'](_0x3ffa7b(0x223))['emit']('bots',config),broadcastToBots('bots',JSON[_0x3ffa7b(0x1bf)](config));}function updateLive(_0x209d8b,_0x468b46){const _0x5efdd0=_0x549688;dbConfig[_0x5efdd0(0x2f5)](_0x5efdd0(0x2e2))[_0x5efdd0(0x1c3)]({'botID':_0x209d8b})[_0x5efdd0(0x2c2)]({'live':_0x468b46})[_0x5efdd0(0x27e)](),config=getConfiguration(),io['to']('botmanager')[_0x5efdd0(0x171)](_0x5efdd0(0x2e2),config),broadcastToBots(_0x5efdd0(0x2e2),JSON[_0x5efdd0(0x1bf)](config));}function updateBotName(_0x3c5165,_0x36a58a){const _0x1e0af6=_0x549688;dbConfig[_0x1e0af6(0x2f5)]('bots')['find']({'botID':_0x3c5165})[_0x1e0af6(0x2c2)]({'botname':_0x36a58a})[_0x1e0af6(0x27e)](),config=getConfiguration(),io['to'](_0x1e0af6(0x223))[_0x1e0af6(0x171)]('bots',config),broadcastToBots(_0x1e0af6(0x2e2),JSON[_0x1e0af6(0x1bf)](config));}function updateBotManager(){const _0x32da37=_0x549688;config=getConfiguration(),io['to'](_0x32da37(0x223))[_0x32da37(0x171)](_0x32da37(0x2e2),config),broadcastToBots('bots',JSON[_0x32da37(0x1bf)](config));}function toggleBotMode(_0x121bdf){const _0x3ae105=_0x549688;if(pid[_0x121bdf])pid[_0x121bdf][_0x3ae105(0x291)]({'function':_0x3ae105(0x29a),'args':null});else{const _0x30eb90=configpath+'bot-'+_0x121bdf+'-config.json',_0x4192bd=fs[_0x3ae105(0x1f2)](_0x30eb90),_0x6768e2=JSON['parse'](_0x4192bd),_0x23885b=_0x6768e2[_0x3ae105(0x1cb)][0x0]['headless'];_0x6768e2['bot'][0x0][_0x3ae105(0x30e)]=!_0x23885b;const _0xc4c3fb=JSON[_0x3ae105(0x1bf)](_0x6768e2,null,0x2);fs['writeFileSync'](_0x30eb90,_0xc4c3fb),config=getConfiguration(),io['to'](_0x3ae105(0x223))[_0x3ae105(0x171)](_0x3ae105(0x2e2),config),broadcastToBots(_0x3ae105(0x2e2),JSON[_0x3ae105(0x1bf)](config));}}function telegramError(_0x2af3b2){const _0x32e479=_0x549688;logger[_0x32e479(0x16d)](getTimeStamp()+_0x32e479(0x1f3));}function validateTelegram(_0x57d3e3){const _0x3068c4=_0x549688;if(_0x57d3e3[_0x3068c4(0x1c7)][_0x3068c4(0x2c8)]!=settings[_0x3068c4(0x1e6)]&&'@'+_0x57d3e3[_0x3068c4(0x1c7)][_0x3068c4(0x2c8)]!=settings[_0x3068c4(0x1e6)])return tgBot[_0x3068c4(0x2c0)](_0x57d3e3['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x3068c4(0x1cf)})['catch'](_0x1e769b=>{telegramError(_0x1e769b);}),![];return!![];}async function initTelegram(){const _0x54f147=_0x549688;if(tgBot)tgBot[_0x54f147(0x17f)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x567300='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x567300+='\x0a',_0x567300+=_0x54f147(0x23f),_0x567300+=_0x54f147(0x30b),_0x567300+=_0x54f147(0x1c9),_0x567300+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x567300+=_0x54f147(0x27d),_0x567300+=_0x54f147(0x313),_0x567300+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x567300+=_0x54f147(0x336),_0x567300+=_0x54f147(0x181),_0x567300+=_0x54f147(0x1f5),_0x567300+=_0x54f147(0x2a1),_0x567300+=_0x54f147(0x2f4),_0x567300+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x567300+=_0x54f147(0x227);let _0x409cb3='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x409cb3+='\x0a',_0x409cb3+=_0x567300,tgBot['onText'](/\/start/,_0x147aa1=>{const _0x350f50=_0x54f147;if(!validateTelegram(_0x147aa1))return;if(settings[_0x350f50(0x1a4)]!=_0x147aa1[_0x350f50(0x2bd)]['id'])updateSetting(_0x350f50(0x1a4),_0x147aa1[_0x350f50(0x2bd)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x350f50(0x2c0)](_0x147aa1[_0x350f50(0x2bd)]['id'],_0x409cb3)[_0x350f50(0x175)](_0xce2682=>{telegramError(_0xce2682);});}),tgBot['onText'](/\/enable/,_0x123ee9=>{const _0x4c1b26=_0x54f147;if(!validateTelegram(_0x123ee9))return;if(settings[_0x4c1b26(0x1a4)]!=_0x123ee9['chat']['id'])updateSetting(_0x4c1b26(0x1a4),_0x123ee9[_0x4c1b26(0x2bd)]['id']);updateSetting(_0x4c1b26(0x2a5),!![]),tgBot[_0x4c1b26(0x2c0)](_0x123ee9[_0x4c1b26(0x2bd)]['id'],_0x4c1b26(0x2af))[_0x4c1b26(0x175)](_0x420ef6=>{telegramError(_0x420ef6);});}),tgBot[_0x54f147(0x28b)](/\/config/,async _0x305254=>{const _0x1bb88e=_0x54f147;if(!validateTelegram(_0x305254))return;tgBot[_0x1bb88e(0x26b)](_0x1bb88e(0x1e0)),tgBot[_0x1bb88e(0x2c0)](_0x305254[_0x1bb88e(0x2bd)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x1bb88e(0x263),'callback_data':_0x1bb88e(0x29f)},{'text':_0x1bb88e(0x16c),'callback_data':'alerts'},{'text':_0x1bb88e(0x1b6),'callback_data':_0x1bb88e(0x1cd)}]]}})[_0x1bb88e(0x175)](_0x106767=>{telegramError(_0x106767);}),tgBot['on'](_0x1bb88e(0x1e0),async _0x259c91=>{const _0xeb5653=_0x1bb88e,_0x45e7aa=_0x259c91[_0xeb5653(0x289)],_0x5c1bd7=_0x259c91[_0xeb5653(0x228)];tgBot[_0xeb5653(0x33b)](_0x259c91['id'])[_0xeb5653(0x2bf)](async()=>{const _0x8681b8=_0xeb5653;_0x45e7aa=='orders'&&(updateSetting(_0x8681b8(0x274),_0x8681b8(0x29f)),updateSetting(_0x8681b8(0x2a5),!![]),await tgBot['sendMessage'](_0x5c1bd7[_0x8681b8(0x2bd)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x10a660=>{telegramError(_0x10a660);}));_0x45e7aa==_0x8681b8(0x308)&&(updateSetting('telegramEvents',_0x8681b8(0x308)),updateSetting(_0x8681b8(0x2a5),!![]),await tgBot[_0x8681b8(0x2c0)](_0x5c1bd7['chat']['id'],_0x8681b8(0x337))[_0x8681b8(0x175)](_0xd1c7b9=>{telegramError(_0xd1c7b9);}));_0x45e7aa==_0x8681b8(0x1cd)&&(updateSetting(_0x8681b8(0x274),_0x8681b8(0x1cd)),updateSetting(_0x8681b8(0x2a5),!![]),await tgBot['sendMessage'](_0x5c1bd7['chat']['id'],_0x8681b8(0x20c))[_0x8681b8(0x175)](_0x2266a3=>{telegramError(_0x2266a3);}));if(!settings[_0x8681b8(0x1a4)])tgBot[_0x8681b8(0x2c0)](_0x5c1bd7[_0x8681b8(0x2bd)]['id'],_0x8681b8(0x1a6))[_0x8681b8(0x175)](_0x14f8db=>{telegramError(_0x14f8db);});}),tgBot[_0xeb5653(0x26b)](_0xeb5653(0x1e0));});}),tgBot[_0x54f147(0x28b)](/\/status/,_0x557a82=>{const _0x9692d6=_0x54f147;if(!validateTelegram(_0x557a82))return;const _0x205e1f=getBotsWithMode();let _0x5caeca=_0x9692d6(0x23d);config[_0x9692d6(0x1bc)](_0x512d9c=>{const _0x58a461=_0x9692d6,_0x33806f=_0x205e1f[_0x58a461(0x1c3)](_0x6e069c=>_0x6e069c[_0x58a461(0x16e)]==_0x512d9c['botID'])['mode'];_0x5caeca+=_0x58a461(0x25e)+_0x512d9c[_0x58a461(0x16e)]+':\x20'+_0x512d9c[_0x58a461(0x170)]+_0x58a461(0x317)+_0x33806f+'\x20|\x20'+_0x512d9c[_0x58a461(0x30a)]+'\x0a';}),_0x5caeca+='\x0a',_0x5caeca+=_0x9692d6(0x1b8),_0x5caeca+=!settings[_0x9692d6(0x2a5)]?_0x9692d6(0x180):'Notifications\x20enabled\x0a',_0x5caeca+=settings['telegramEnabled']?settings[_0x9692d6(0x274)]==_0x9692d6(0x1cd)?_0x9692d6(0x21f):_0x9692d6(0x1cc)+settings[_0x9692d6(0x274)]+_0x9692d6(0x26d):'',tgBot[_0x9692d6(0x2c0)](_0x557a82[_0x9692d6(0x2bd)]['id'],_0x5caeca,{'parse_mode':_0x9692d6(0x1cf)})[_0x9692d6(0x175)](_0x157e49=>{telegramError(_0x157e49);});}),tgBot[_0x54f147(0x28b)](/\/restart/,_0x3f1abe=>{const _0x36e949=_0x54f147;if(!validateTelegram(_0x3f1abe))return;tgBot[_0x36e949(0x26b)](_0x36e949(0x1e0));const _0x1c09d8=getEnabledBots();if(_0x1c09d8[_0x36e949(0x338)]==0x0)tgBot[_0x36e949(0x2c0)](_0x3f1abe[_0x36e949(0x2bd)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x36e949(0x175)](_0x376d95=>{telegramError(_0x376d95);});else{if(_0x1c09d8[_0x36e949(0x338)]>0x1)_0x1c09d8['push']({'botID':_0x36e949(0x1cd)});let _0x360526=[],_0x45db82=[];const _0x4aa1e8=_0x1c09d8[_0x36e949(0x338)]%0x4==0x0||_0x1c09d8[_0x36e949(0x338)]%0x4==0x3||_0x1c09d8[_0x36e949(0x338)]%0x3==0x1?0x4:0x3;let _0x1223e1=0x0;_0x1c09d8[_0x36e949(0x1bc)]((_0x445ffe,_0x39dd59)=>{const _0xbd46ad=_0x36e949;if(_0x39dd59%_0x4aa1e8==0x0)_0x45db82=[];_0x45db82[_0xbd46ad(0x1ae)]({'text':_0x445ffe['botID']==_0xbd46ad(0x1cd)?'All\x20bots':_0xbd46ad(0x25e)+_0x445ffe[_0xbd46ad(0x16e)],'callback_data':_0x445ffe['botID']}),_0x39dd59%_0x4aa1e8==0x0&&(_0x360526[_0x1223e1]=_0x45db82,_0x1223e1++);}),tgBot[_0x36e949(0x2c0)](_0x3f1abe[_0x36e949(0x2bd)]['id'],_0x36e949(0x27f),{'reply_markup':{'inline_keyboard':_0x360526}})[_0x36e949(0x175)](_0x303e71=>{telegramError(_0x303e71);}),tgBot['on'](_0x36e949(0x1e0),async _0x1d2a9d=>{const _0x1de964=_0x36e949,_0xefc9a5=_0x1d2a9d[_0x1de964(0x289)],_0x2e37da=_0x1d2a9d[_0x1de964(0x228)];tgBot[_0x1de964(0x33b)](_0x1d2a9d['id'])['then'](async()=>{const _0x187d3a=_0x1de964;_0xefc9a5==_0x187d3a(0x1cd)?config[_0x187d3a(0x1bc)](_0x445faa=>{const _0x27ff03=_0x187d3a;restartBot(_0x445faa[_0x27ff03(0x16e)]);}):restartBot(_0xefc9a5);}),tgBot[_0x1de964(0x26b)](_0x1de964(0x1e0));});}}),tgBot[_0x54f147(0x28b)](/\/on/,_0x572519=>{const _0x3a8dd9=_0x54f147;if(!validateTelegram(_0x572519))return;tgBot[_0x3a8dd9(0x26b)](_0x3a8dd9(0x1e0));const _0x4aa231=getDisabledBots();if(_0x4aa231[_0x3a8dd9(0x338)]==0x0)tgBot[_0x3a8dd9(0x2c0)](_0x572519[_0x3a8dd9(0x2bd)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x3a8dd9(0x175)](_0x59f133=>{telegramError(_0x59f133);});else{if(_0x4aa231[_0x3a8dd9(0x338)]>0x1)_0x4aa231[_0x3a8dd9(0x1ae)]({'botID':_0x3a8dd9(0x1cd)});let _0x345962=[],_0x30a726=[];const _0xcc776d=_0x4aa231['length']%0x4==0x0||_0x4aa231['length']%0x4==0x3||_0x4aa231[_0x3a8dd9(0x338)]%0x3==0x1?0x4:0x3;let _0x1acbc5=0x0;_0x4aa231['forEach']((_0x18bf5b,_0x3ef80d)=>{const _0x1dd60c=_0x3a8dd9;if(_0x3ef80d%_0xcc776d==0x0)_0x30a726=[];_0x30a726[_0x1dd60c(0x1ae)]({'text':_0x18bf5b[_0x1dd60c(0x16e)]==_0x1dd60c(0x1cd)?_0x1dd60c(0x19c):_0x1dd60c(0x25e)+_0x18bf5b[_0x1dd60c(0x16e)],'callback_data':_0x18bf5b[_0x1dd60c(0x16e)]}),_0x3ef80d%_0xcc776d==0x0&&(_0x345962[_0x1acbc5]=_0x30a726,_0x1acbc5++);}),tgBot['sendMessage'](_0x572519[_0x3a8dd9(0x2bd)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x345962}})[_0x3a8dd9(0x175)](_0x2c19cd=>{telegramError(_0x2c19cd);}),tgBot['on'](_0x3a8dd9(0x1e0),async _0x1d5faf=>{const _0x88203d=_0x3a8dd9,_0x2b4bd7=_0x1d5faf[_0x88203d(0x289)],_0x5d35e7=_0x1d5faf[_0x88203d(0x228)];tgBot[_0x88203d(0x33b)](_0x1d5faf['id'])['then'](async()=>{const _0x44e83e=_0x88203d;_0x2b4bd7==_0x44e83e(0x1cd)?(tgBot['sendMessage'](_0x5d35e7['chat']['id'],_0x44e83e(0x295))[_0x44e83e(0x175)](_0x52db25=>{telegramError(_0x52db25);}),_0x4aa231[_0x44e83e(0x1bc)](_0x55d96e=>{const _0x3339ed=_0x44e83e;if(_0x55d96e[_0x3339ed(0x16e)]!='all')toggleBot(_0x55d96e['botID'],toggleStatus(_0x55d96e[_0x3339ed(0x16e)]),_0x3339ed(0x2b4));})):(tgBot['sendMessage'](_0x5d35e7[_0x44e83e(0x2bd)]['id'],_0x44e83e(0x183)+_0x2b4bd7)[_0x44e83e(0x175)](_0x328e15=>{telegramError(_0x328e15);}),toggleBot(_0x2b4bd7,toggleStatus(_0x2b4bd7),_0x44e83e(0x2b4)));}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/off/,_0x5ac8aa=>{const _0x144f0f=_0x54f147;if(!validateTelegram(_0x5ac8aa))return;tgBot[_0x144f0f(0x26b)]('callback_query');const _0x23216f=getEnabledBots();if(_0x23216f[_0x144f0f(0x338)]==0x0)tgBot[_0x144f0f(0x2c0)](_0x5ac8aa[_0x144f0f(0x2bd)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x144f0f(0x175)](_0x558ecc=>{telegramError(_0x558ecc);});else{if(_0x23216f['length']>0x1)_0x23216f['push']({'botID':_0x144f0f(0x1cd)});let _0x339f2a=[],_0x3a6818=[];const _0x2e3ed8=_0x23216f[_0x144f0f(0x338)]%0x4==0x0||_0x23216f[_0x144f0f(0x338)]%0x4==0x3||_0x23216f['length']%0x3==0x1?0x4:0x3;let _0x3e6e18=0x0;_0x23216f[_0x144f0f(0x1bc)]((_0x5f31b3,_0x4172da)=>{const _0x25dd3c=_0x144f0f;if(_0x4172da%_0x2e3ed8==0x0)_0x3a6818=[];_0x3a6818[_0x25dd3c(0x1ae)]({'text':_0x5f31b3[_0x25dd3c(0x16e)]==_0x25dd3c(0x1cd)?_0x25dd3c(0x19c):_0x25dd3c(0x25e)+_0x5f31b3[_0x25dd3c(0x16e)],'callback_data':_0x5f31b3[_0x25dd3c(0x16e)]}),_0x4172da%_0x2e3ed8==0x0&&(_0x339f2a[_0x3e6e18]=_0x3a6818,_0x3e6e18++);}),tgBot[_0x144f0f(0x2c0)](_0x5ac8aa[_0x144f0f(0x2bd)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x339f2a}})[_0x144f0f(0x175)](_0x13a927=>{telegramError(_0x13a927);}),tgBot['on'](_0x144f0f(0x1e0),async _0x777d2b=>{const _0x477e8d=_0x144f0f,_0x159f13=_0x777d2b[_0x477e8d(0x289)],_0x178895=_0x777d2b[_0x477e8d(0x228)];tgBot[_0x477e8d(0x33b)](_0x777d2b['id'])[_0x477e8d(0x2bf)](async()=>{const _0x3f7e98=_0x477e8d;_0x159f13==_0x3f7e98(0x1cd)?(tgBot[_0x3f7e98(0x2c0)](_0x178895[_0x3f7e98(0x2bd)]['id'],_0x3f7e98(0x298))[_0x3f7e98(0x175)](_0x2465e3=>{telegramError(_0x2465e3);}),_0x23216f['forEach'](_0x1f5c73=>{const _0x3bfe91=_0x3f7e98;if(_0x1f5c73[_0x3bfe91(0x16e)]!=_0x3bfe91(0x1cd))toggleBot(_0x1f5c73[_0x3bfe91(0x16e)],toggleStatus(_0x1f5c73[_0x3bfe91(0x16e)]),_0x3bfe91(0x2b4));})):(tgBot[_0x3f7e98(0x2c0)](_0x178895[_0x3f7e98(0x2bd)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x159f13)[_0x3f7e98(0x175)](_0x568d1f=>{telegramError(_0x568d1f);}),toggleBot(_0x159f13,toggleStatus(_0x159f13),_0x3f7e98(0x2b4)));}),tgBot['removeListener'](_0x477e8d(0x1e0));});}}),tgBot[_0x54f147(0x28b)](/\/metrics/,_0x20294f=>{const _0x545ddd=_0x54f147;if(!validateTelegram(_0x20294f))return;tgBot[_0x545ddd(0x26b)]('callback_query');const _0x386e9c=getEnabledBots();if(_0x386e9c[_0x545ddd(0x338)]==0x0)tgBot['sendMessage'](_0x20294f[_0x545ddd(0x2bd)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x545ddd(0x175)](_0x1f8796=>{telegramError(_0x1f8796);});else{if(_0x386e9c[_0x545ddd(0x338)]>0x1){let _0x58510e=[],_0x3c6684=[];const _0xf0163f=_0x386e9c[_0x545ddd(0x338)]%0x4==0x0||_0x386e9c['length']%0x4==0x3||_0x386e9c[_0x545ddd(0x338)]%0x3==0x1?0x4:0x3;let _0x197fb5=0x0;_0x386e9c[_0x545ddd(0x1bc)]((_0x4bef49,_0x9d57bd)=>{const _0x383556=_0x545ddd;if(_0x9d57bd%_0xf0163f==0x0)_0x3c6684=[];_0x3c6684[_0x383556(0x1ae)]({'text':_0x383556(0x25e)+_0x4bef49[_0x383556(0x16e)],'callback_data':_0x4bef49[_0x383556(0x16e)]}),_0x9d57bd%_0xf0163f==0x0&&(_0x58510e[_0x197fb5]=_0x3c6684,_0x197fb5++);}),tgBot[_0x545ddd(0x2c0)](_0x20294f[_0x545ddd(0x2bd)]['id'],_0x545ddd(0x230),{'reply_markup':{'inline_keyboard':_0x58510e}})[_0x545ddd(0x175)](_0x10a20a=>{telegramError(_0x10a20a);}),tgBot['on'](_0x545ddd(0x1e0),async _0x255762=>{const _0x7fcdd3=_0x545ddd,_0x3bd0e3=_0x255762[_0x7fcdd3(0x289)],_0x329adb=_0x255762['message'];tgBot[_0x7fcdd3(0x33b)](_0x255762['id'])[_0x7fcdd3(0x2bf)](async()=>{const _0xe0bf41=_0x7fcdd3;if(pid[_0x3bd0e3])pid[_0x3bd0e3][_0xe0bf41(0x291)]({'function':_0xe0bf41(0x1ad),'args':null});}),tgBot['removeListener'](_0x7fcdd3(0x1e0));});}else{const _0x953fc0=_0x386e9c[0x0][_0x545ddd(0x16e)];if(pid[_0x953fc0])pid[_0x953fc0][_0x545ddd(0x291)]({'function':_0x545ddd(0x1ad),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x3e6d49=>{const _0xced66=_0x54f147;if(!validateTelegram(_0x3e6d49))return;tgBot[_0xced66(0x26b)](_0xced66(0x1e0));const _0x254ecb=getEnabledBots();if(_0x254ecb[_0xced66(0x338)]==0x0)tgBot[_0xced66(0x2c0)](_0x3e6d49[_0xced66(0x2bd)]['id'],_0xced66(0x1c0))[_0xced66(0x175)](_0x4d0f1e=>{telegramError(_0x4d0f1e);});else{if(_0x254ecb[_0xced66(0x338)]>0x1){let _0x5ea151=[],_0x2b3e2d=[];const _0x3930ff=_0x254ecb['length']%0x4==0x0||_0x254ecb['length']%0x4==0x3||_0x254ecb[_0xced66(0x338)]%0x3==0x1?0x4:0x3;let _0x3becd2=0x0;_0x254ecb['forEach']((_0x14f16a,_0x5cfe05)=>{const _0x31557d=_0xced66;if(_0x5cfe05%_0x3930ff==0x0)_0x2b3e2d=[];_0x2b3e2d[_0x31557d(0x1ae)]({'text':_0x31557d(0x25e)+_0x14f16a[_0x31557d(0x16e)],'callback_data':_0x14f16a['botID']}),_0x5cfe05%_0x3930ff==0x0&&(_0x5ea151[_0x3becd2]=_0x2b3e2d,_0x3becd2++);}),tgBot[_0xced66(0x2c0)](_0x3e6d49['chat']['id'],_0xced66(0x32b),{'reply_markup':{'inline_keyboard':_0x5ea151}})['catch'](_0x4f3f88=>{telegramError(_0x4f3f88);}),tgBot['on'](_0xced66(0x1e0),async _0x256aae=>{const _0x8c4554=_0xced66,_0x1afbe7=_0x256aae[_0x8c4554(0x289)],_0x4d1fb5=_0x256aae[_0x8c4554(0x228)];tgBot[_0x8c4554(0x33b)](_0x256aae['id'])['then'](async()=>{if(pid[_0x1afbe7])pid[_0x1afbe7]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x8c4554(0x26b)](_0x8c4554(0x1e0));});}else{const _0x335c6f=_0x254ecb[0x0]['botID'];if(pid[_0x335c6f])pid[_0x335c6f][_0xced66(0x291)]({'function':_0xced66(0x201),'args':null});}}}),tgBot['onText'](/\/update/,async _0x31c4a8=>{const _0x2bb9df=_0x54f147;if(!validateTelegram(_0x31c4a8))return;tgBot[_0x2bb9df(0x26b)](_0x2bb9df(0x1e0)),await getMessages();if(!updateAvailable)tgBot[_0x2bb9df(0x2c0)](_0x31c4a8[_0x2bb9df(0x2bd)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x2bb9df(0x175)](_0x47fa9a=>{telegramError(_0x47fa9a);});else!validInstallation?tgBot[_0x2bb9df(0x2c0)](_0x31c4a8['chat']['id'],_0x2bb9df(0x1e7))[_0x2bb9df(0x175)](_0x326018=>{telegramError(_0x326018);}):(tgBot[_0x2bb9df(0x2c0)](_0x31c4a8[_0x2bb9df(0x2bd)]['id'],_0x2bb9df(0x17a),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x2bb9df(0x323)},{'text':'No','callback_data':'no'}]]}})[_0x2bb9df(0x175)](_0x240a5b=>{telegramError(_0x240a5b);}),tgBot['on']('callback_query',async _0x6553dc=>{const _0xd845c4=_0x2bb9df,_0x543815=_0x6553dc[_0xd845c4(0x289)],_0x133367=_0x6553dc['message'];tgBot[_0xd845c4(0x33b)](_0x6553dc['id'])['then'](async()=>{const _0x36ac39=_0xd845c4;_0x543815=='yes'&&(await tgBot['sendMessage'](_0x133367[_0x36ac39(0x2bd)]['id'],_0x36ac39(0x238))[_0x36ac39(0x175)](_0x3a5175=>{telegramError(_0x3a5175);}),updateBB(_0x36ac39(0x19e))),_0x543815=='no'&&await tgBot[_0x36ac39(0x2c0)](_0x133367[_0x36ac39(0x2bd)]['id'],_0x36ac39(0x2b8))['catch'](_0x37087d=>{telegramError(_0x37087d);});}),tgBot[_0xd845c4(0x26b)](_0xd845c4(0x1e0));}));}),tgBot['onText'](/\/reinstall/,async _0x46f14a=>{const _0x1941f4=_0x54f147;if(!validateTelegram(_0x46f14a))return;tgBot[_0x1941f4(0x26b)]('callback_query'),!validInstallation?tgBot[_0x1941f4(0x2c0)](_0x46f14a[_0x1941f4(0x2bd)]['id'],_0x1941f4(0x229))['catch'](_0x5aa95a=>{telegramError(_0x5aa95a);}):(tgBot[_0x1941f4(0x2c0)](_0x46f14a[_0x1941f4(0x2bd)]['id'],_0x1941f4(0x31e),{'reply_markup':{'inline_keyboard':[[{'text':_0x1941f4(0x1fa),'callback_data':_0x1941f4(0x323)},{'text':'No','callback_data':'no'}]]}})[_0x1941f4(0x175)](_0x40bd55=>{telegramError(_0x40bd55);}),tgBot['on'](_0x1941f4(0x1e0),async _0x3b7240=>{const _0x27cd72=_0x1941f4,_0x85960d=_0x3b7240[_0x27cd72(0x289)],_0x46af07=_0x3b7240[_0x27cd72(0x228)];tgBot[_0x27cd72(0x33b)](_0x3b7240['id'])[_0x27cd72(0x2bf)](async()=>{const _0x43463a=_0x27cd72;_0x85960d==_0x43463a(0x323)&&(await tgBot['sendMessage'](_0x46af07[_0x43463a(0x2bd)]['id'],_0x43463a(0x300))[_0x43463a(0x175)](_0x24c57d=>{telegramError(_0x24c57d);}),updateBB(_0x43463a(0x2d6))),_0x85960d=='no'&&await tgBot['sendMessage'](_0x46af07[_0x43463a(0x2bd)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x43463a(0x175)](_0x386cf0=>{telegramError(_0x386cf0);});}),tgBot[_0x27cd72(0x26b)](_0x27cd72(0x1e0));}));}),tgBot[_0x54f147(0x28b)](/\/toggle/,_0xcac6c5=>{const _0x51b49e=_0x54f147;if(!validateTelegram(_0xcac6c5))return;tgBot[_0x51b49e(0x26b)](_0x51b49e(0x1e0));const _0x1f8815=getBotsWithMode();if(_0x1f8815['length']==0x0)tgBot['sendMessage'](_0xcac6c5[_0x51b49e(0x2bd)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x1168cd=>{telegramError(_0x1168cd);});else{let _0x2f9ceb=[],_0x45b690=[];const _0x165fdc=0x2;let _0x2166a1=0x0;_0x1f8815[_0x51b49e(0x1bc)]((_0xaea429,_0x415bc8)=>{const _0xcb24e6=_0x51b49e;if(_0x415bc8%_0x165fdc==0x0)_0x45b690=[];_0x45b690[_0xcb24e6(0x1ae)]({'text':_0xcb24e6(0x25e)+_0xaea429['botID']+'\x20('+_0xaea429[_0xcb24e6(0x1db)]+')','callback_data':_0xaea429[_0xcb24e6(0x16e)]}),_0x415bc8%_0x165fdc==0x0&&(_0x2f9ceb[_0x2166a1]=_0x45b690,_0x2166a1++);}),tgBot[_0x51b49e(0x2c0)](_0xcac6c5[_0x51b49e(0x2bd)]['id'],_0x51b49e(0x28c),{'reply_markup':{'inline_keyboard':_0x2f9ceb}})[_0x51b49e(0x175)](_0x12c9d2=>{telegramError(_0x12c9d2);}),tgBot['on'](_0x51b49e(0x1e0),async _0x463957=>{const _0x48db48=_0x51b49e,_0x11b85f=_0x463957[_0x48db48(0x289)],_0x3712e6=_0x463957[_0x48db48(0x228)];tgBot[_0x48db48(0x33b)](_0x463957['id'])[_0x48db48(0x2bf)](async()=>{const _0x597841=_0x48db48,_0x23c79a=_0x1f8815[_0x597841(0x1c3)](_0x2c6e70=>_0x2c6e70[_0x597841(0x16e)]==_0x11b85f),_0xa31de7=_0x23c79a['mode']=='auto'?'manual':_0x597841(0x26a);tgBot[_0x597841(0x2c0)](_0x3712e6[_0x597841(0x2bd)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x11b85f+_0x597841(0x219)+_0xa31de7+_0x597841(0x2ed))[_0x597841(0x175)](_0x5148b3=>{telegramError(_0x5148b3);}),toggleBotMode(_0x11b85f);}),tgBot[_0x48db48(0x26b)](_0x48db48(0x1e0));});}}),tgBot[_0x54f147(0x28b)](/\/names/,_0x59fd1b=>{const _0x2f7cbe=_0x54f147;if(!validateTelegram(_0x59fd1b))return;let _0x112c13='';config['forEach'](_0x1a6bc3=>{const _0x382b0e=_0x3572;_0x112c13+=_0x382b0e(0x25e)+_0x1a6bc3[_0x382b0e(0x16e)]+':\x20'+_0x1a6bc3[_0x382b0e(0x2d1)]+'\x0a';}),tgBot['sendMessage'](_0x59fd1b[_0x2f7cbe(0x2bd)]['id'],_0x112c13,{'parse_mode':_0x2f7cbe(0x1cf)})['catch'](_0x3a04b9=>{telegramError(_0x3a04b9);});}),tgBot[_0x54f147(0x28b)](/\/disable/,_0x150b9d=>{const _0x4e151f=_0x54f147;if(!validateTelegram(_0x150b9d))return;tgBot[_0x4e151f(0x2c0)](_0x150b9d[_0x4e151f(0x2bd)]['id'],'Notifications\x20disabled')[_0x4e151f(0x175)](_0x1223ea=>{telegramError(_0x1223ea);}),updateSetting(_0x4e151f(0x2a5),![]);}),tgBot['onText'](/\/help/,_0x1f7648=>{const _0xb7ec79=_0x54f147;if(!validateTelegram(_0x1f7648))return;tgBot['sendMessage'](_0x1f7648[_0xb7ec79(0x2bd)]['id'],_0x567300)[_0xb7ec79(0x175)](_0x419934=>{telegramError(_0x419934);});}),tgBot['on'](_0x54f147(0x1fd),_0x36f29f=>{const _0x7cfc84=_0x54f147;_0x36f29f[_0x7cfc84(0x2c5)]()[_0x7cfc84(0x22a)](_0x7cfc84(0x32d))&&(logger[_0x7cfc84(0x242)](_0x7cfc84(0x1c1)),tgBot[_0x7cfc84(0x17f)](),tgBot=null,io['to'](_0x7cfc84(0x223))[_0x7cfc84(0x171)]('notification',_0x7cfc84(0x1c1)));}),process[_0x54f147(0x237)]('SIGINT',()=>{const _0x12c7b4=_0x54f147;if(tgBot)tgBot[_0x12c7b4(0x17f)]();process[_0x12c7b4(0x2cf)](0x1);}),process['once']('SIGTERM',()=>{const _0x248f09=_0x54f147;if(tgBot)tgBot[_0x248f09(0x17f)]();process[_0x248f09(0x2cf)](0x1);});}}function disableTelegram(){const _0xaf15d4=_0x549688;tgBot&&(tgBot[_0xaf15d4(0x17f)](),tgBot=null);}function sendTelegram(_0x3389b2,_0x4ef822){const _0x236eaf=_0x549688;if(settings[_0x236eaf(0x2a5)]){if(settings['telegramEvents']=='all'||(_0x4ef822[_0x236eaf(0x2e8)]=='error'||_0x4ef822[_0x236eaf(0x2e8)]=='warning'||_0x4ef822['type']==_0x236eaf(0x322))&&settings['telegramEvents']==_0x236eaf(0x308)||_0x4ef822[_0x236eaf(0x2e8)]==_0x236eaf(0x19f)&&settings[_0x236eaf(0x274)]==_0x236eaf(0x29f)){if(tgBot&&settings[_0x236eaf(0x1a4)]){if(_0x4ef822[_0x236eaf(0x246)])tgBot['sendMessage'](settings[_0x236eaf(0x1a4)],_0x4ef822[_0x236eaf(0x2d1)]+_0x236eaf(0x168)+_0x4ef822[_0x236eaf(0x22d)])[_0x236eaf(0x175)](_0x2f398d=>{telegramError(_0x2f398d);});else tgBot[_0x236eaf(0x2c0)](settings[_0x236eaf(0x1a4)],_0x236eaf(0x25e)+_0x3389b2+_0x236eaf(0x168)+_0x4ef822[_0x236eaf(0x22d)])[_0x236eaf(0x175)](_0x36a229=>{telegramError(_0x36a229);});}}}}async function sendTelegramMsg(_0x4afaa3,_0x6ce329=_0x549688(0x1cf)){const _0x5613d5=_0x549688;return settings[_0x5613d5(0x2a5)]&&tgBot&&settings[_0x5613d5(0x1a4)]?(await tgBot['sendMessage'](settings[_0x5613d5(0x1a4)],_0x4afaa3,{'parse_mode':_0x6ce329})[_0x5613d5(0x175)](_0x45ac4d=>{telegramError(_0x45ac4d);}),!![]):![];}function getDeviceWithIp(_0x3bcecd){const _0x5a0c1f=_0x549688;return devices[_0x5a0c1f(0x1c3)](_0x132c20=>_0x132c20['ip']===_0x3bcecd);}function temporaryAccess2FA(_0x201eae,_0x3d3b82){const _0x19def1=_0x549688;let _0x4428a5=new Date(),_0x4e7c71=![];if(lastIpApproval){if(_0x4428a5-lastIpApproval<0x1388)_0x4e7c71=!![];}lastIpApproval=new Date();if(_0x4e7c71)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x19def1(0x26b)](_0x19def1(0x1e0)),tgBot[_0x19def1(0x2c0)](settings[_0x19def1(0x1a4)],_0x19def1(0x1b9)+normalizeIP(_0x3d3b82)[_0x19def1(0x2df)]+_0x19def1(0x1d6),{'parse_mode':_0x19def1(0x1cf),'reply_markup':{'inline_keyboard':[[{'text':_0x19def1(0x31b),'callback_data':'5'},{'text':_0x19def1(0x2f0),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x19def1(0x310),'callback_data':_0x19def1(0x310)}]]}})[_0x19def1(0x175)](_0x3172bb=>{telegramError(_0x3172bb);}),tgBot['on'](_0x19def1(0x1e0),async _0x58fb8c=>{const _0x4063d3=_0x19def1,_0x25a26e=_0x58fb8c['data'],_0x10eca6=_0x58fb8c[_0x4063d3(0x228)];tgBot['answerCallbackQuery'](_0x58fb8c['id'])[_0x4063d3(0x2bf)](async()=>{const _0x11dd2b=_0x4063d3;devices[_0x201eae][_0x11dd2b(0x1d2)]={'clientip':_0x3d3b82,'timestamp':new Date()['getTime'](),'expiry':_0x25a26e},_0x25a26e!=_0x11dd2b(0x310)?(await tgBot['sendMessage'](_0x10eca6[_0x11dd2b(0x2bd)]['id'],_0x11dd2b(0x235)+_0x25a26e+_0x11dd2b(0x2d8),{'parse_mode':_0x11dd2b(0x1cf)})['catch'](_0x506e81=>{telegramError(_0x506e81);}),io['to'](_0x201eae)[_0x11dd2b(0x171)](_0x11dd2b(0x170),{'access':{'allow':![],'reason':_0x11dd2b(0x2ea),'token':null}})):(await tgBot[_0x11dd2b(0x2c0)](_0x10eca6[_0x11dd2b(0x2bd)]['id'],_0x11dd2b(0x2cd))[_0x11dd2b(0x175)](_0x265d42=>{telegramError(_0x265d42);}),io['to'](_0x201eae)[_0x11dd2b(0x171)](_0x11dd2b(0x170),{'access':{'allow':![],'reason':_0x11dd2b(0x213),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x24ab7b,_0x166b04){const _0x22ef8f=_0x549688;tgBot&&settings[_0x22ef8f(0x1a4)]&&(tgBot[_0x22ef8f(0x26b)](_0x22ef8f(0x1e0)),tgBot[_0x22ef8f(0x2c0)](settings[_0x22ef8f(0x1a4)],_0x22ef8f(0x272)+normalizeIP(_0x166b04)['show']+_0x22ef8f(0x1d6),{'parse_mode':_0x22ef8f(0x1cf),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x22ef8f(0x310),'callback_data':_0x22ef8f(0x310)}]]}})[_0x22ef8f(0x175)](_0x120032=>{telegramError(_0x120032);}),tgBot['on'](_0x22ef8f(0x1e0),async _0x236809=>{const _0x3cac5a=_0x22ef8f,_0x53a05f=_0x236809[_0x3cac5a(0x289)],_0x400325=_0x236809[_0x3cac5a(0x228)];tgBot[_0x3cac5a(0x33b)](_0x236809['id'])[_0x3cac5a(0x2bf)](async()=>{const _0x80a784=_0x3cac5a;devices[_0x24ab7b][_0x80a784(0x33c)]={'clientip':_0x166b04,'timestamp':new Date()['getTime'](),'expiry':_0x53a05f},_0x53a05f!=_0x80a784(0x310)?(await tgBot[_0x80a784(0x2c0)](_0x400325['chat']['id'],_0x80a784(0x253),{'parse_mode':_0x80a784(0x1cf)})[_0x80a784(0x175)](_0x322d3b=>{telegramError(_0x322d3b);}),io['to'](_0x24ab7b)[_0x80a784(0x171)](_0x80a784(0x170),{'access':{'allow':![],'reason':_0x80a784(0x2ea),'token':null}})):(await tgBot[_0x80a784(0x2c0)](_0x400325[_0x80a784(0x2bd)]['id'],'Login\x20rejected')[_0x80a784(0x175)](_0x5df9a6=>{telegramError(_0x5df9a6);}),io['to'](_0x24ab7b)[_0x80a784(0x171)](_0x80a784(0x170),{'access':{'allow':![],'reason':_0x80a784(0x1d4),'token':null}}));}),tgBot[_0x3cac5a(0x26b)](_0x3cac5a(0x1e0));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x8aad02=_0x549688;return dbConfig[_0x8aad02(0x2f5)](_0x8aad02(0x2e2))[_0x8aad02(0x205)](_0x8aad02(0x16e))[_0x8aad02(0x2f7)]({'status':_0x8aad02(0x1fe)})[_0x8aad02(0x1eb)]()||[];}function getDisabledBots(){const _0x192087=_0x549688;return dbConfig[_0x192087(0x2f5)]('bots')[_0x192087(0x205)]('botID')['filter']({'status':_0x192087(0x195)})[_0x192087(0x1eb)]()||[];}function getBotAttributes(_0x486ab8){const _0x4ab086=_0x549688;let _0x3683e6={};const _0x3438a7=configpath+_0x4ab086(0x312)+_0x486ab8+_0x4ab086(0x335),_0x39b52f=fs[_0x4ab086(0x200)](_0x3438a7);if(_0x39b52f){const _0x4eb22f=fs['readFileSync'](_0x3438a7);try{const _0x1a7eaf=JSON[_0x4ab086(0x339)](_0x4eb22f),_0x2e0a51=_0x1a7eaf?_0x1a7eaf['bot'][0x0]['headless']:![];_0x3683e6[_0x4ab086(0x1db)]=_0x2e0a51?_0x4ab086(0x26a):_0x4ab086(0x287),_0x3683e6[_0x4ab086(0x2d1)]=_0x1a7eaf?_0x1a7eaf[_0x4ab086(0x1cb)][0x0][_0x4ab086(0x2d1)]:_0x4ab086(0x25e)+_0x486ab8;}catch(_0x6fa10d){_0x3683e6[_0x4ab086(0x1db)]=_0x4ab086(0x287),_0x3683e6['botname']=_0x4ab086(0x25e)+_0x486ab8;}}else _0x3683e6['mode']='manual',_0x3683e6[_0x4ab086(0x2d1)]=_0x4ab086(0x25e)+_0x486ab8;return _0x3683e6;}function getBotsWithMode(){const _0x35fa1d=_0x549688,_0x624dc8=dbConfig[_0x35fa1d(0x2f5)](_0x35fa1d(0x2e2))[_0x35fa1d(0x205)](_0x35fa1d(0x16e))[_0x35fa1d(0x1eb)]()||[];return _0x624dc8[_0x35fa1d(0x1bc)](_0x193157=>{const _0x871a05=_0x35fa1d;let _0x158bd2=getBotAttributes(_0x193157[_0x871a05(0x16e)]);_0x193157[_0x871a05(0x1db)]=_0x158bd2[_0x871a05(0x1db)];}),_0x624dc8;}function getBotExchanges(){const _0x97947a=_0x549688;let _0xfadb00=[];const _0x46ab1b=dbConfig[_0x97947a(0x2f5)](_0x97947a(0x2e2))['sortBy'](_0x97947a(0x16e))[_0x97947a(0x1eb)]()||[];_0x46ab1b[_0x97947a(0x1bc)](_0x2d9ea1=>{const _0x32c5ec=_0x97947a;if(_0x2d9ea1[_0x32c5ec(0x170)]==_0x32c5ec(0x1fe)){const _0x336ad8=configpath+'bot-'+_0x2d9ea1['botID']+_0x32c5ec(0x335),_0x310237=fs['existsSync'](_0x336ad8);let _0x162aaa;if(_0x310237){const _0x2fb887=fs[_0x32c5ec(0x1f2)](_0x336ad8);try{const _0x395d1e=JSON[_0x32c5ec(0x339)](_0x2fb887);_0x162aaa=_0x395d1e?_0x395d1e[_0x32c5ec(0x1cb)][0x0]['exchange']:null;}catch(_0x3754e7){}}if(_0x162aaa)_0xfadb00[_0x32c5ec(0x1ae)](_0x162aaa);}});const _0x63ddd4=[...new Set(_0xfadb00)]['sort']();return _0x63ddd4;}async function initUser(){const _0x17d39e=_0x549688;if(!settings[_0x17d39e(0x2bb)]){const _0x44f9da=uuidRandom();mixpanel['alias'](_0x44f9da),updateSetting(_0x17d39e(0x2bb),_0x44f9da);}}async function initSecure(){const _0x1398ea=_0x549688;let _0x3c2ff2=getSecure();if(!_0x3c2ff2['hasOwnProperty'](_0x1398ea(0x2ce))){let _0x50abbd=await generateKeys();_0x3c2ff2[_0x1398ea(0x2fe)]=_0x50abbd[_0x1398ea(0x2fe)],_0x3c2ff2[_0x1398ea(0x257)]=_0x50abbd[_0x1398ea(0x257)],_0x3c2ff2[_0x1398ea(0x2ce)]=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x3c2ff2);}}function getSettings(){const _0x204a60=_0x549688;return dbSettings[_0x204a60(0x2f5)]('settings')[_0x204a60(0x1eb)]()||{};}function getSecure(){const _0x4b5136=_0x549688;return dbSecure[_0x4b5136(0x2f5)](_0x4b5136(0x1b4))[_0x4b5136(0x1eb)]()||{};}function getBlacklist(){const _0x823a09=_0x549688;return dbSecure[_0x823a09(0x2f5)](_0x823a09(0x22c))['value']()||[];}function broadcastToBots(_0xc4c093,_0xae8068){config['forEach'](_0x2a8f02=>{const _0x827377=_0x3572;if(_0x2a8f02[_0x827377(0x170)]==_0x827377(0x1fe)&&_0x2a8f02[_0x827377(0x30a)]==_0x827377(0x240)||_0x2a8f02[_0x827377(0x170)]=='new'&&_0x2a8f02[_0x827377(0x30a)]==_0x827377(0x240)){if(pid[_0x2a8f02['botID']])pid[_0x2a8f02['botID']][_0x827377(0x291)]({[_0xc4c093]:_0xae8068});}});}function storeSettings(_0x2bfd2f,_0x49e754=![]){const _0x25f955=_0x549688;_0x2bfd2f={...settings,..._0x2bfd2f};if(_0x49e754&&_0x2bfd2f['bbPassword']!='************'&&_0x2bfd2f[_0x25f955(0x24b)]!='***'&&_0x2bfd2f[_0x25f955(0x24b)]!=''){const _0x41ee82=crypt[_0x25f955(0x2eb)](secure['privateKey'],_0x2bfd2f[_0x25f955(0x24b)])[_0x25f955(0x228)]['split']('@')[0x0],_0xa7b9da=bcrypt[_0x25f955(0x184)](_0x41ee82,saltRounds);_0x2bfd2f={..._0x2bfd2f,'bbPassword':_0xa7b9da};}if(_0x49e754&&_0x2bfd2f[_0x25f955(0x29c)]!=_0x25f955(0x2db)&&_0x2bfd2f[_0x25f955(0x29c)]!=_0x25f955(0x202)&&_0x2bfd2f[_0x25f955(0x29c)]!=''){const _0x26272e=crypt[_0x25f955(0x2eb)](secure[_0x25f955(0x257)],_0x2bfd2f['telegramToken'])[_0x25f955(0x228)]['split']('@')[0x0];_0x2bfd2f={..._0x2bfd2f,'telegramToken':_0x26272e};}const _0x30fca5=_0x2bfd2f[_0x25f955(0x29c)]!=_0x25f955(0x2db)&&_0x2bfd2f[_0x25f955(0x29c)]!=settings[_0x25f955(0x29c)]||_0x2bfd2f[_0x25f955(0x1e6)]!=settings[_0x25f955(0x1e6)],_0x136f99=_0x2bfd2f[_0x25f955(0x29c)]==''||_0x2bfd2f['telegramUsername']=='';if(_0x30fca5)_0x2bfd2f[_0x25f955(0x274)]='all';for(const [_0x1103ab,_0x14a24c]of Object[_0x25f955(0x210)](_0x2bfd2f)){if(_0x1103ab==_0x25f955(0x29c)&&_0x14a24c==_0x25f955(0x2db)){_0x2bfd2f[_0x25f955(0x29c)]=settings[_0x25f955(0x29c)];continue;};if(_0x1103ab==_0x25f955(0x24b)&&_0x14a24c=='************'){_0x2bfd2f['bbPassword']=settings[_0x25f955(0x24b)];continue;};dbSettings[_0x25f955(0x172)](_0x25f955(0x2ad)+_0x1103ab,_0x14a24c)['write']();}settings=_0x2bfd2f,io['to']('botmanager')[_0x25f955(0x171)](_0x25f955(0x2da),cleanSettings()),broadcastToBots(_0x25f955(0x32f),settings[_0x25f955(0x32f)]),broadcastToBots(_0x25f955(0x21d),settings['onepagemode']);if(_0x30fca5&&!_0x136f99)initTelegram();if(_0x30fca5&&_0x136f99)disableTelegram();getAllClients()[_0x25f955(0x1bc)](_0x3a393b=>{const _0x516d62=_0x25f955;getSocket(_0x3a393b['id'])[_0x516d62(0x171)]('status',{'access':{'allow':![],'reason':_0x516d62(0x2ea),'token':null}});});}function updateSetting(_0x2e77c8,_0x1b6d70){const _0x4f00de=_0x549688;dbSettings[_0x4f00de(0x172)]('settings.'+_0x2e77c8,_0x1b6d70)['write'](),settings=getSettings(),io['to'](_0x4f00de(0x223))[_0x4f00de(0x171)](_0x4f00de(0x2da),cleanSettings());}function storeSecure(_0x111623){const _0x418f81=_0x549688;dbSecure[_0x418f81(0x2f5)](_0x418f81(0x1b4))['push'](_0x111623)[_0x418f81(0x27e)](),secure=_0x111623;}function addBlacklist(_0x4b9e4e){const _0x14433e=_0x549688;cleanBlacklist();let _0x15e262;devices[_0x4b9e4e][_0x14433e(0x1d2)]?_0x15e262=Math['max'](devices[_0x4b9e4e]['telegramIpApproval'][_0x14433e(0x2e6)],loginExpiry):_0x15e262=loginExpiry,dbSecure['get'](_0x14433e(0x22c))['push']({'expiry':new Date()['getTime']()+_0x15e262*0x3c*0x3e8,'token':devices[_0x4b9e4e]['access'][_0x14433e(0x2e1)]})['write'](),blacklist=dbSecure[_0x14433e(0x2f5)](_0x14433e(0x22c))[_0x14433e(0x1eb)]();}function cleanBlacklist(){const _0x124872=_0x549688;let _0x533c95=dbSecure['get']('blacklist')[_0x124872(0x305)]()[_0x124872(0x1eb)](),_0x38879a=new Date()[_0x124872(0x32a)]();_0x533c95[_0x124872(0x1bc)](_0x4d684c=>{const _0x5ab49c=_0x124872;_0x4d684c['expiry']<_0x38879a&&dbSecure[_0x5ab49c(0x2f5)](_0x5ab49c(0x22c))['remove']({'expiry':_0x4d684c[_0x5ab49c(0x2e6)]})[_0x5ab49c(0x27e)]();});}function initStates(){const _0x2a9ff8=_0x549688;let _0x55c967=getConfiguration();_0x55c967[_0x2a9ff8(0x1bc)](_0x385407=>{const _0x1ad225=_0x2a9ff8;_0x385407[_0x1ad225(0x30a)]='stopped';}),storeConfiguration(_0x55c967);}function onKeys(){const _0x1fc327=new RSA();return new Promise(_0x22463b=>{const _0xe4d093=_0x3572;_0x1fc327[_0xe4d093(0x260)]()[_0xe4d093(0x2bf)](_0x14ee5a=>{_0x22463b(_0x14ee5a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4f301d=_0x549688;let _0x702844=getSettings(),_0x37ef8b=![];!_0x702844['hasOwnProperty']('lastmsgtelegram')&&(_0x702844[_0x4f301d(0x2b2)]=0x0,_0x37ef8b=!![]);!_0x702844['hasOwnProperty'](_0x4f301d(0x307))&&(_0x702844[_0x4f301d(0x307)]=0x0,_0x37ef8b=!![]);!_0x702844[_0x4f301d(0x1e2)](_0x4f301d(0x188))&&(_0x702844[_0x4f301d(0x188)]='0.0.0',_0x37ef8b=!![]);!_0x702844['hasOwnProperty']('onepagemode')&&(_0x702844[_0x4f301d(0x21d)]=![],_0x37ef8b=!![]);if(_0x37ef8b)storeSettings(_0x702844);try{fs[_0x4f301d(0x19a)](configbackuppath,{'withFileTypes':!![]})[_0x4f301d(0x1bc)](_0x44c86a=>{const _0x15e56f=_0x4f301d;if(!_0x44c86a[_0x15e56f(0x324)]()){if(!_0x44c86a[_0x15e56f(0x18b)][_0x15e56f(0x2f9)](_0x15e56f(0x285)))fs[_0x15e56f(0x193)](configbackuppath+_0x44c86a[_0x15e56f(0x18b)]);}else fs[_0x15e56f(0x286)](configbackuppath+_0x44c86a[_0x15e56f(0x18b)],{'recursive':!![]});});}catch(_0x41ca46){logger['debug'](_0x4f301d(0x17c),_0x41ca46);}}function storeConfiguration(_0x4da504){const _0x5bdbd3=_0x549688;dbConfig[_0x5bdbd3(0x2f5)](_0x5bdbd3(0x2e2))[_0x5bdbd3(0x273)]()[_0x5bdbd3(0x27e)](),_0x4da504[_0x5bdbd3(0x1bc)](_0x38667d=>{const _0x3d04b5=_0x5bdbd3;delete _0x38667d[_0x3d04b5(0x1db)];}),dbConfig[_0x5bdbd3(0x2f5)](_0x5bdbd3(0x2e2))[_0x5bdbd3(0x1ae)](..._0x4da504)['write'](),config=_0x4da504;}function resetPassword(){const _0x4732df=_0x549688;tgBot&&settings[_0x4732df(0x1a4)]&&(tgBot['removeListener'](_0x4732df(0x1e0)),tgBot[_0x4732df(0x2c0)](settings['telegramChatId'],_0x4732df(0x23c),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x4732df(0x323)},{'text':'no','callback_data':'no'}]]}})[_0x4732df(0x175)](_0x433b7a=>{telegramError(_0x433b7a);}),tgBot['on']('callback_query',async _0x34ae77=>{const _0x658881=_0x4732df,_0x4b5557=_0x34ae77['data'],_0x30192c=_0x34ae77[_0x658881(0x228)];tgBot[_0x658881(0x33b)](_0x34ae77['id'])['then'](async()=>{const _0x1fa6fa=_0x658881;if(_0x4b5557!='no'){const _0x168317=0xf,_0x40bad5=_0x1fa6fa(0x1a5),_0x2402d5=Array[_0x1fa6fa(0x1c7)](crypto[_0x1fa6fa(0x2a3)](new Uint32Array(_0x168317)))[_0x1fa6fa(0x1b1)](_0x4d31b4=>_0x40bad5[_0x4d31b4%_0x40bad5[_0x1fa6fa(0x338)]])[_0x1fa6fa(0x251)](''),_0x25d9ec=bcrypt[_0x1fa6fa(0x184)](_0x2402d5,saltRounds);storeSettings({'bbPassword':_0x25d9ec}),await tgBot['sendMessage'](_0x30192c[_0x1fa6fa(0x2bd)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x2402d5,{'parse_mode':_0x1fa6fa(0x1cf)})[_0x1fa6fa(0x175)](_0x352549=>{telegramError(_0x352549);});}else await tgBot['sendMessage'](_0x30192c[_0x1fa6fa(0x2bd)]['id'],'Password\x20reset\x20rejected')[_0x1fa6fa(0x175)](_0x5ee921=>{telegramError(_0x5ee921);});}),tgBot[_0x658881(0x26b)](_0x658881(0x1e0));}));}async function confirmRestore(_0x12578e,_0x302fa3){const _0x5f2d9d=_0x549688;io['to'](_0x5f2d9d(0x223))['emit']('notification',_0x5f2d9d(0x177),_0x5f2d9d(0x322)),tgBot&&settings[_0x5f2d9d(0x1a4)]&&(tgBot[_0x5f2d9d(0x26b)](_0x5f2d9d(0x1e0)),await tgBot['sendMessage'](settings[_0x5f2d9d(0x1a4)],_0x5f2d9d(0x265),{'parse_mode':_0x5f2d9d(0x1cf),'reply_markup':{'inline_keyboard':[[{'text':_0x5f2d9d(0x323),'callback_data':_0x5f2d9d(0x323)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x3f1f5b=>{telegramError(_0x3f1f5b);}),tgBot['on'](_0x5f2d9d(0x1e0),async _0x52d3a3=>{const _0x440210=_0x5f2d9d,_0x419ba3=_0x52d3a3[_0x440210(0x289)],_0x4a91a8=_0x52d3a3[_0x440210(0x228)];tgBot[_0x440210(0x33b)](_0x52d3a3['id'])[_0x440210(0x2bf)](async()=>{const _0x3cc822=_0x440210;_0x419ba3==_0x3cc822(0x323)?(await tgBot['sendMessage'](_0x4a91a8[_0x3cc822(0x2bd)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x3cc822(0x1cf)})['catch'](_0x351f87=>{telegramError(_0x351f87);}),unzipFile(_0x12578e,_0x302fa3)):(logger['debug'](_0x3cc822(0x1af)),await tgBot[_0x3cc822(0x2c0)](_0x4a91a8[_0x3cc822(0x2bd)]['id'],_0x3cc822(0x1af))['catch'](_0x454ec0=>{telegramError(_0x454ec0);}));}),tgBot[_0x440210(0x26b)](_0x440210(0x1e0));}));}function getServerTime(){const _0x5d4dd1=_0x549688,_0x2ddedc=new Date();return _0x2ddedc[_0x5d4dd1(0x284)]()+'/'+(_0x2ddedc[_0x5d4dd1(0x319)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x2ddedc[_0x5d4dd1(0x1c2)]()[_0x5d4dd1(0x2c5)]()[_0x5d4dd1(0x2de)](0x2,'0')+'\x20'+_0x2ddedc[_0x5d4dd1(0x278)]()[_0x5d4dd1(0x2c5)]()[_0x5d4dd1(0x2de)](0x2,'0')+':'+_0x2ddedc[_0x5d4dd1(0x309)]()[_0x5d4dd1(0x2c5)]()[_0x5d4dd1(0x2de)](0x2,'0')+':'+_0x2ddedc[_0x5d4dd1(0x333)]()[_0x5d4dd1(0x2c5)]()[_0x5d4dd1(0x2de)](0x2,'0');}function getTimeStamp(){const _0xbc5254=_0x549688,_0x23bc52=shiftedTime();return _0x23bc52[_0xbc5254(0x284)]()+'/'+(_0x23bc52[_0xbc5254(0x319)]()+0x1)['toString']()[_0xbc5254(0x2de)](0x2,'0')+'/'+_0x23bc52['getDate']()[_0xbc5254(0x2c5)]()[_0xbc5254(0x2de)](0x2,'0')+'\x20'+_0x23bc52[_0xbc5254(0x278)]()[_0xbc5254(0x2c5)]()[_0xbc5254(0x2de)](0x2,'0')+':'+_0x23bc52[_0xbc5254(0x309)]()[_0xbc5254(0x2c5)]()[_0xbc5254(0x2de)](0x2,'0')+':'+_0x23bc52[_0xbc5254(0x333)]()[_0xbc5254(0x2c5)]()[_0xbc5254(0x2de)](0x2,'0');}function getCleanTimeStamp(){const _0x27059c=_0x549688,_0x30f1e7=shiftedTime();return _0x30f1e7[_0x27059c(0x284)]()+(_0x30f1e7[_0x27059c(0x319)]()+0x1)[_0x27059c(0x2c5)]()['padStart'](0x2,'0')+_0x30f1e7[_0x27059c(0x1c2)]()[_0x27059c(0x2c5)]()[_0x27059c(0x2de)](0x2,'0')+'-'+_0x30f1e7[_0x27059c(0x278)]()[_0x27059c(0x2c5)]()['padStart'](0x2,'0')+_0x30f1e7['getMinutes']()[_0x27059c(0x2c5)]()[_0x27059c(0x2de)](0x2,'0')+_0x30f1e7[_0x27059c(0x333)]()[_0x27059c(0x2c5)]()[_0x27059c(0x2de)](0x2,'0');}function shiftedTime(){const _0x2131f1=_0x549688,_0x36ca09=new Date();let _0x1ef018=_0x36ca09;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x1ef018=fns[_0x2131f1(0x16b)](_0x36ca09,{'hours':settings['timeshift']});return _0x1ef018;}function startScheduler(){const _0x4845f6=_0x549688,_0x321b86=new Date()['getUTCHours'](),_0x545422=shiftedTime()[_0x4845f6(0x278)]();_0x545422==0x4&&backupConfigFiles();_0x545422==0x0&&rotateLogFiles();_0x321b86%0x6==0x0&&triggerAnalytics();_0x321b86%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x522873){logger['debug']('Restore\x20backup\x20file\x20'+_0x522873);const _0x2d59db=getBotsWithMode();_0x2d59db['length']>0x0?confirmRestore(configbackuppath,_0x522873):unzipFile(configbackuppath,_0x522873);}async function getBackupFiles(_0x22d460=null){const _0x2ce23c=_0x549688;let _0x597601=[],_0x434a33=fs[_0x2ce23c(0x19a)](configbackuppath,{'withFileTypes':!![]});_0x434a33[_0x2ce23c(0x1ca)]((_0x1e23f3,_0x59303f)=>_0x1e23f3[_0x2ce23c(0x18b)]<_0x59303f[_0x2ce23c(0x18b)]?0x1:_0x59303f[_0x2ce23c(0x18b)]<_0x1e23f3[_0x2ce23c(0x18b)]?-0x1:0x0),_0x434a33[_0x2ce23c(0x1bc)](_0x9d519b=>{const _0x344123=_0x2ce23c;if(!_0x9d519b[_0x344123(0x324)]()&&_0x9d519b['name']['startsWith'](_0x344123(0x285))&&_0x9d519b[_0x344123(0x18b)][_0x344123(0x23a)]('.zip')){const _0x4b6600=formatDate(fs[_0x344123(0x276)](configbackuppath+_0x9d519b[_0x344123(0x18b)])['mtime']);_0x597601[_0x344123(0x1ae)]({'name':_0x9d519b[_0x344123(0x18b)],'mtime':_0x4b6600});}});if(_0x22d460)io['to'](_0x22d460)[_0x2ce23c(0x171)](_0x2ce23c(0x2f8),_0x597601);else return _0x597601;}async function backupConfigFiles(){const _0x1551ba=_0x549688;await zipFiles(_0x1551ba(0x211));const _0x550c1c=getCleanTimeStamp();fs[_0x1551ba(0x2ba)](zippath+'backup-full.zip',configbackuppath+(_0x1551ba(0x285)+_0x550c1c+_0x1551ba(0x1d1)));let _0x18235b=fs[_0x1551ba(0x19a)](configbackuppath,{'withFileTypes':!![]});_0x18235b['sort']((_0x59a238,_0x242295)=>_0x59a238[_0x1551ba(0x18b)]<_0x242295[_0x1551ba(0x18b)]?0x1:_0x242295[_0x1551ba(0x18b)]<_0x59a238['name']?-0x1:0x0),_0x18235b[_0x1551ba(0x338)]>maxBackups&&fs[_0x1551ba(0x193)](configbackuppath+_0x18235b[_0x18235b[_0x1551ba(0x338)]-0x1][_0x1551ba(0x18b)]);}function rotateLogFiles(){const _0x49cb82=_0x549688,_0x418630=fs[_0x49cb82(0x276)](logspath+_0x49cb82(0x1a3)),_0x4cda93=_0x418630['size']/0x400;if(_0x4cda93>0x64){let _0x5082b5=fs[_0x49cb82(0x19a)](logspath,{'withFileTypes':!![]});_0x5082b5[_0x49cb82(0x1ca)]((_0x5bef5a,_0x13018f)=>_0x5bef5a[_0x49cb82(0x18b)]<_0x13018f[_0x49cb82(0x18b)]?0x1:_0x13018f[_0x49cb82(0x18b)]<_0x5bef5a[_0x49cb82(0x18b)]?-0x1:0x0),_0x5082b5['forEach'](_0x477242=>{const _0x10c106=_0x49cb82;if(_0x477242[_0x10c106(0x18b)]==_0x10c106(0x1a0))fs[_0x10c106(0x2ba)](logspath+_0x477242[_0x10c106(0x18b)],logspath+_0x10c106(0x224));if(_0x477242[_0x10c106(0x18b)]==_0x10c106(0x25a))fs['copyFileSync'](logspath+_0x477242['name'],logspath+_0x10c106(0x1a0));_0x477242['name']==_0x10c106(0x1a3)&&(fs['copyFileSync'](logspath+_0x477242[_0x10c106(0x18b)],logspath+_0x10c106(0x25a)),fs[_0x10c106(0x303)](logspath+_0x477242[_0x10c106(0x18b)],''));});}}async function zipFiles(_0x2e6f53){const _0x363e71=_0x549688;let _0x32da97;if(_0x2e6f53==_0x363e71(0x241))_0x32da97=logspath;if(_0x2e6f53==_0x363e71(0x2cc))_0x32da97=configpath;if(_0x2e6f53==_0x363e71(0x211))_0x32da97=configpath;let _0x326021=fs[_0x363e71(0x19a)](_0x32da97,{'withFileTypes':!![]});const _0x18ce8a=new require(_0x363e71(0x277))();_0x326021['forEach'](_0x2d4b87=>{const _0x5295b7=_0x363e71;if(!_0x2d4b87[_0x5295b7(0x324)]()){let _0x29120c=fs[_0x5295b7(0x1f2)](_0x32da97+_0x2d4b87[_0x5295b7(0x18b)]);if(_0x2e6f53==_0x5295b7(0x2cc)){const _0x4baa85=/^bot-[0-9]{3}-config.json$/,_0x1f3aa6=_0x4baa85[_0x5295b7(0x255)](_0x2d4b87['name']);if(_0x1f3aa6){const _0x49a69b=JSON[_0x5295b7(0x339)](_0x29120c);if(_0x49a69b['bot'][0x0]){_0x49a69b[_0x5295b7(0x1cb)][0x0][_0x5295b7(0x169)]=_0x5295b7(0x202),_0x49a69b['bot'][0x0]['apiSecret']=_0x5295b7(0x202);if(_0x49a69b[_0x5295b7(0x1cb)][0x0][_0x5295b7(0x233)])_0x49a69b['bot'][0x0][_0x5295b7(0x233)]=_0x5295b7(0x202);}_0x29120c=JSON[_0x5295b7(0x1bf)](_0x49a69b,null,0x2);}if(_0x2d4b87[_0x5295b7(0x18b)]=='bb-settings.json'){const _0x2b085a=JSON[_0x5295b7(0x339)](_0x29120c);if(_0x2b085a['settings'][_0x5295b7(0x25c)])_0x2b085a[_0x5295b7(0x2da)][_0x5295b7(0x25c)]=![];if(_0x2b085a[_0x5295b7(0x2da)][_0x5295b7(0x24b)])_0x2b085a[_0x5295b7(0x2da)][_0x5295b7(0x24b)]=_0x5295b7(0x202);if(_0x2b085a['settings'][_0x5295b7(0x29c)])_0x2b085a[_0x5295b7(0x2da)]['telegramToken']=_0x5295b7(0x202);if(_0x2b085a[_0x5295b7(0x2da)][_0x5295b7(0x1a4)])_0x2b085a[_0x5295b7(0x2da)][_0x5295b7(0x1a4)]=null;_0x29120c=JSON[_0x5295b7(0x1bf)](_0x2b085a,null,0x2);}if(_0x2d4b87[_0x5295b7(0x18b)]!='bb-secure.json')_0x18ce8a['file'](_0x2d4b87['name'],_0x29120c);}else _0x18ce8a[_0x5295b7(0x1f4)](_0x2d4b87[_0x5295b7(0x18b)],_0x29120c);}});const _0x6850be=_0x18ce8a[_0x363e71(0x190)]({'base64':![],'compression':'DEFLATE'});fs[_0x363e71(0x303)](zippath+(_0x2e6f53+_0x363e71(0x1d1)),_0x6850be,_0x363e71(0x1b7));}async function unzipFile(_0x2762bd,_0x27533d){const _0x50cc92=_0x549688;fs[_0x50cc92(0x19a)](configpath,{'withFileTypes':!![]})[_0x50cc92(0x1bc)](_0x1d249a=>{const _0x324d9a=_0x50cc92;if(!_0x1d249a[_0x324d9a(0x324)]())fs['rmSync'](configpath+_0x1d249a['name']);});const _0x5b2a18=fs[_0x50cc92(0x1f2)](_0x2762bd+_0x27533d,_0x50cc92(0x1b7)),_0x344f=new require(_0x50cc92(0x277))(_0x5b2a18,{'base64':![],'checkCRC32':!![]});Object[_0x50cc92(0x2b9)](_0x344f['files'])['forEach'](_0x192b43=>{const _0x37fdb7=_0x50cc92,_0x179319=_0x344f[_0x37fdb7(0x31c)][_0x192b43];fs[_0x37fdb7(0x303)](configpath+_0x179319[_0x37fdb7(0x18b)],_0x179319[_0x37fdb7(0x24d)]);}),fs[_0x50cc92(0x19a)](temppath,{'withFileTypes':!![]})[_0x50cc92(0x1bc)](_0x32ab5d=>{const _0x4d87ca=_0x50cc92;if(!_0x32ab5d[_0x4d87ca(0x324)]())fs[_0x4d87ca(0x286)](temppath+_0x32ab5d['name']);}),logger[_0x50cc92(0x266)](_0x50cc92(0x194)),process[_0x50cc92(0x291)]({'restore':!![]},_0x25dcf5=>{});}async function getPublicIp(){const _0x95a861=_0x549688;try{const _0x2ef314=await axios[_0x95a861(0x2f5)](_0x95a861(0x1e5));publicip=_0x2ef314[_0x95a861(0x289)]['ip'];}catch(_0xe6b8f3){}}async function triggerAnalytics(){const _0x16791a=_0x549688;if(!publicip)await getPublicIp();const _0x1d0124=getBotsWithMode();let _0x16f65e=0x0;_0x1d0124[_0x16791a(0x1bc)](_0x3ee3d7=>{const _0x12e5b6=_0x16791a;if(_0x3ee3d7[_0x12e5b6(0x170)]==='enabled')_0x16f65e++;});const _0x390e8c=getBotExchanges();mixpanel[_0x16791a(0x185)](_0x16791a(0x275),{'distinct_id':settings[_0x16791a(0x2bb)],'ip':publicip,'version':serverversion,'numbots':_0x1d0124['length'],'numbotsenabled':_0x16f65e,'exchanges':_0x390e8c,'environment':environment});}async function getMessages(){const _0x1698e9=_0x549688,_0x15861a=_0x1698e9(0x1b0),_0x185505=new GraphQLClient(_0x15861a),_0x19d9f9={'authorization':_0x1698e9(0x2c6)},_0x4737a7=serverversion[_0x1698e9(0x215)]('.'),_0x277098=_0x4737a7[0x0]+'.'+_0x4737a7[0x1],_0x4c7b73=Math['min'](settings['lastmsgtelegram'],settings[_0x1698e9(0x307)]),_0x19c448={'last':parseInt(_0x4c7b73),'bbm':_0x277098},_0x4c2273=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4f000f;try{_0x4f000f=await _0x185505[_0x1698e9(0x226)](_0x4c2273,_0x19c448,_0x19d9f9);}catch(_0xcbef11){}if(_0x4f000f&&_0x4f000f['messages']){let _0x2a61f7=settings[_0x1698e9(0x2b2)];newMessages=[];for(const _0x2a03ea of _0x4f000f[_0x1698e9(0x198)]){newMessages[_0x1698e9(0x1ae)](_0x2a03ea);let _0x2acde1=![];_0x2a03ea[_0x1698e9(0x1aa)]&&(updateSetting(_0x1698e9(0x188),_0x2a03ea[_0x1698e9(0x1aa)]),_0x2acde1=isNewerVersion(serverversion,_0x2a03ea['bbvNew'])||serverversion==_0x2a03ea[_0x1698e9(0x1aa)]);if(!_0x2acde1&&_0x2a03ea[_0x1698e9(0x2e7)]>_0x2a61f7){if(_0x2a03ea[_0x1698e9(0x2c1)]===_0x1698e9(0x244)||serverversion['startsWith'](_0x2a03ea[_0x1698e9(0x2c1)])){let _0x1f1272=''+_0x2a03ea[_0x1698e9(0x294)]+'\x0a\x0a'+_0x2a03ea[_0x1698e9(0x228)];const _0x4fce8d=await sendTelegramMsg(toTelegramMarkdown(_0x1f1272),'Markdown');if(_0x4fce8d)_0x2a61f7=_0x2a03ea[_0x1698e9(0x2e7)];}}}updateAvailable=isNewerVersion(settings[_0x1698e9(0x188)],serverversion),updateSetting('lastmsgtelegram',_0x2a61f7),emitMessages();}}function emitMessages(){const _0x11c706=_0x549688,_0x128942=settings[_0x11c706(0x307)];let _0x393ffd=[];newMessages[_0x11c706(0x1bc)](_0x3ee924=>{const _0x111f58=_0x11c706;_0x3ee924['number']>_0x128942&&_0x393ffd[_0x111f58(0x1ae)](_0x3ee924);}),_0x393ffd[_0x11c706(0x338)]>0x0&&getAllClients()[_0x11c706(0x1bc)](_0x42e097=>{const _0xcaa39e=_0x11c706;getSocket(_0x42e097['id'])[_0xcaa39e(0x171)](_0xcaa39e(0x228),_0x393ffd);});}function confirmMessage(_0x4e2dd){const _0x1373ea=_0x549688;updateSetting(_0x1373ea(0x307),Number(_0x4e2dd));}function isNewerVersion(_0xc77651,_0x2c9fb1){const _0x4db99d=_0x549688,_0x593732=_0x2c9fb1[_0x4db99d(0x215)]('.'),_0x9a3289=_0xc77651[_0x4db99d(0x215)]('.');for(var _0x45af0a=0x0;_0x45af0a<_0x9a3289[_0x4db99d(0x338)];_0x45af0a++){const _0x9d8684=~~_0x9a3289[_0x45af0a],_0x4dedbe=~~_0x593732[_0x45af0a];if(_0x9d8684>_0x4dedbe)return!![];if(_0x9d8684<_0x4dedbe)return![];}return![];}function toTelegramMarkdown(_0x4f2873){const _0x4b87b4=_0x549688,_0x39c9ac=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x26c632=/\*{2}(.+?)\*{2}/gim;return _0x4f2873=_0x4f2873['replace'](_0x39c9ac,'$1_$2_$3')[_0x4b87b4(0x221)](_0x26c632,_0x4b87b4(0x288)),_0x4f2873;}async function validateConfigFile(){const _0x42bf84=_0x549688,_0x157a40=dbConfig[_0x42bf84(0x2f5)]('bots')[_0x42bf84(0x205)](_0x42bf84(0x16e))[_0x42bf84(0x1eb)]()||[];if(_0x157a40[_0x42bf84(0x338)]==0x0){let _0x3e8e83=0x0,_0x3dba31=[];const _0x27dc1b=/^bot-([0-9]{3})-config.json$/,_0x2d2fa1=fs[_0x42bf84(0x19a)](configpath);_0x2d2fa1[_0x42bf84(0x1bc)](_0x23da97=>{const _0x151fa0=_0x42bf84,_0x2a3e5a=_0x27dc1b[_0x151fa0(0x2f2)](_0x23da97);if(_0x2a3e5a){const _0x2ce787=_0x2a3e5a[0x1];let _0x5bb9ea=getBotAttributes(_0x2ce787);_0x3dba31[_0x151fa0(0x1ae)]({'botID':_0x2ce787,'botname':_0x5bb9ea[_0x151fa0(0x2d1)],'status':'disabled','live':_0x151fa0(0x2b4)}),_0x3e8e83++;}}),_0x3e8e83!=0x0&&(dbConfig['get']('bots')[_0x42bf84(0x2c2)](_0x3dba31)[_0x42bf84(0x27e)](),config=_0x3dba31,restoredConfigFile=_0x3e8e83);}}async function restoreConfigNotify(_0x585311){const _0x279da0=_0x549688;let _0x359a53;if(restoredConfigFile==0x1)_0x359a53='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x359a53=_0x279da0(0x187);if(_0x585311)io['to'](_0x279da0(0x223))[_0x279da0(0x171)](_0x279da0(0x2e3),_0x359a53);else{logger[_0x279da0(0x16d)]('-----------------------------------------------------------------------------------'),logger[_0x279da0(0x16d)](_0x359a53),logger[_0x279da0(0x16d)](_0x279da0(0x2d5)),logger['simple']('');if(tgBot&&settings[_0x279da0(0x1a4)]&&settings[_0x279da0(0x274)]!=_0x279da0(0x29f))tgBot[_0x279da0(0x2c0)](settings[_0x279da0(0x1a4)],'Bot\x20Mgr\x20>\x20'+_0x359a53)[_0x279da0(0x175)](_0xae31ab=>{telegramError(_0xae31ab);});}}function validateCredentials(_0x1ed624,_0x471f38){const _0x40d17b=_0x549688;if(_0x1ed624[_0x40d17b(0x2c8)]==settings['bbUsername']&&bcrypt[_0x40d17b(0x297)](_0x1ed624[_0x40d17b(0x2b3)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x47e1a4=generateLoginToken(_0x471f38);return{'allow':!![],'reason':_0x40d17b(0x2dc),'token':_0x47e1a4};}}else return{'allow':![],'reason':_0x40d17b(0x314),'token':null};}function refreshToken(_0x292fdb){const _0x15d55f=generateLoginToken(_0x292fdb);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x15d55f};}function validateAccess(_0x513525,_0x141b22,_0x48600d){const _0xee486=_0x549688,_0x294da8=_0x48600d?_0x48600d:devices[_0x141b22]['ip'];let _0x2ede4f;const _0x1c7701=_0x5eb3f5=>{const _0x195cf7=_0x3572;if(settings[_0x195cf7(0x25c)]){if(settings[_0x195cf7(0x1f9)]){if(telegram2FaApproved(_0x141b22)){const _0x9613f3=generateLoginToken(_0x141b22);return{'allow':!![],'reason':_0x195cf7(0x2ac),'token':_0x9613f3};}else return{'allow':![],'reason':_0x195cf7(0x332),'token':null};}else return _0x2ede4f=validToken(_0x5eb3f5,_0x141b22),_0x2ede4f[_0x195cf7(0x1e2)](_0x195cf7(0x322))?{'allow':!![],'reason':_0x195cf7(0x290),'token':_0x5eb3f5}:{'allow':![],'reason':_0x195cf7(0x332),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0xee486(0x31d)]){let _0x320f60=[...settings['whitelist'],_0xee486(0x2fc),_0xee486(0x236),_0xee486(0x29d)];if(_0x320f60[_0xee486(0x22a)](_0x294da8))return _0x1c7701(_0x513525);else{_0x2ede4f=validToken(_0x513525,_0x141b22);if(_0x2ede4f[_0xee486(0x1e2)]('success'))return _0x1c7701(_0x513525);else{if(telegramIpApproved(_0x141b22)){const _0x32fc67=generateToken(_0x141b22);return _0x2ede4f=_0x1c7701(_0x513525),_0x2ede4f[_0xee486(0x24e)]?{'allow':!![],'reason':_0xee486(0x18a),'token':_0x32fc67}:_0x2ede4f;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0xee486(0x328),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x1c7701(_0x513525);}function timelyDecrypt(_0x554b49,_0x268972=!![]){const _0x33681d=_0x549688;if(_0x554b49)try{const _0x47288c=crypt[_0x33681d(0x2eb)](secure[_0x33681d(0x257)],_0x554b49)['message'],_0x5e723c=_0x47288c[_0x33681d(0x215)]('@')[0x0],_0x4c500d=_0x47288c['split']('@')[0x1],_0x105276=new Date()[_0x33681d(0x32a)]();if(_0x268972){if(_0x105276-_0x4c500d<maxSecretAge*0x3e8)return _0x5e723c;else return![];}else return _0x5e723c;}catch(_0x2b71f1){return![];}else return![];}const validToken=(_0x2a40cb,_0x2d5147)=>{const _0x2c8493=_0x549688,_0x1c21d3=devices[_0x2d5147]['ip'];if(!_0x2a40cb)return{'error':_0x2c8493(0x329)};for(let _0x1be832 of blacklist){if(_0x1be832['token']==_0x2a40cb)return{'error':_0x2c8493(0x1e9)};}let _0x12e2fb;try{_0x12e2fb=jwt[_0x2c8493(0x197)](_0x2a40cb,secure['secret']+_0x2d5147);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x12e2fb[_0x2c8493(0x1e2)](_0x2c8493(0x280))&&!_0x12e2fb['hasOwnProperty'](_0x2c8493(0x2c8))||!_0x12e2fb[_0x2c8493(0x1e2)](_0x2c8493(0x268)))return{'error':_0x2c8493(0x18d)};if(!_0x12e2fb[_0x2c8493(0x1e2)](_0x2c8493(0x2c8))&&_0x12e2fb['hasOwnProperty']('clientip')){const {clientip:_0x45b997}=_0x12e2fb;return _0x1c21d3==_0x45b997?{'success':_0x2c8493(0x1be)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x12e2fb['hasOwnProperty'](_0x2c8493(0x2c8))&&_0x12e2fb['hasOwnProperty'](_0x2c8493(0x280))){const {username:_0x2d62bf,clientip:_0x7a5b29}=_0x12e2fb;return settings[_0x2c8493(0x20b)]==_0x2d62bf&&_0x1c21d3==_0x7a5b29?{'success':_0x2c8493(0x1be)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x50a76a=>{const _0x2af005=_0x549688;if(_0x50a76a){const _0x1581d0=devices[_0x50a76a]['ip'];return jwt[_0x2af005(0x24a)]({'username':settings[_0x2af005(0x20b)],'clientip':_0x1581d0},secure['secret']+_0x50a76a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x55d85c=>{const _0x39d740=_0x549688;if(_0x55d85c){const _0x14e2fc=devices[_0x55d85c]['ip'];return jwt[_0x39d740(0x24a)]({'clientip':_0x14e2fc},secure[_0x39d740(0x2ce)]+_0x55d85c,{'expiresIn':devices[_0x55d85c][_0x39d740(0x1d2)][_0x39d740(0x2e6)]*0x3c});}else return![];},telegramIpApproved=_0x20ff61=>{const _0x4f4524=_0x549688;let _0x456bd3=![];return devices[_0x20ff61]['telegramIpApproval']&&devices[_0x20ff61][_0x4f4524(0x1d2)][_0x4f4524(0x2e6)]!='reject'&&(_0x456bd3=devices[_0x20ff61][_0x4f4524(0x1d2)][_0x4f4524(0x280)]==devices[_0x20ff61]['ip']&&new Date()[_0x4f4524(0x32a)]()-devices[_0x20ff61][_0x4f4524(0x1d2)][_0x4f4524(0x21c)]<devices[_0x20ff61][_0x4f4524(0x1d2)][_0x4f4524(0x2e6)]*0x3c*0x3e8),_0x456bd3;},telegram2FaApproved=_0x2ba0a6=>{const _0x2a2f40=_0x549688;let _0x2644a0=![];return devices[_0x2ba0a6]['telegram2FaApproval']&&devices[_0x2ba0a6][_0x2a2f40(0x33c)][_0x2a2f40(0x2e6)]!='reject'&&(_0x2644a0=devices[_0x2ba0a6]['telegram2FaApproval'][_0x2a2f40(0x280)]==devices[_0x2ba0a6]['ip']&&new Date()[_0x2a2f40(0x32a)]()-devices[_0x2ba0a6]['telegram2FaApproval']['timestamp']<devices[_0x2ba0a6][_0x2a2f40(0x33c)][_0x2a2f40(0x2e6)]*0x3c*0x3e8),_0x2644a0;},normalizeIP=_0x212e5e=>{const _0x3f3cf9=_0x549688;let _0xa5122d=null,_0x225679=null;if(ipaddr[_0x3f3cf9(0x31f)](_0x212e5e)){const _0x1ec809=ipaddr[_0x3f3cf9(0x339)](_0x212e5e);_0x1ec809[_0x3f3cf9(0x1da)]()==='ipv6'?(_0x1ec809[_0x3f3cf9(0x220)]()&&(_0xa5122d=_0x1ec809[_0x3f3cf9(0x33e)]()[_0x3f3cf9(0x2c5)]()),_0x225679=_0x1ec809['toString']()):(_0xa5122d=_0x1ec809['toString'](),_0x225679=_0x1ec809['toIPv4MappedAddress']()[_0x3f3cf9(0x2c5)]());}return{'show':_0xa5122d?_0xa5122d:_0x225679,'store':_0x225679};};function formatDate(_0x3d6dc9){const _0x2f6a94=_0x549688;return _0x3d6dc9['getFullYear']()+'/'+(_0x3d6dc9['getMonth']()+0x1)['toString']()[_0x2f6a94(0x2de)](0x2,'0')+'/'+_0x3d6dc9[_0x2f6a94(0x1c2)]()[_0x2f6a94(0x2c5)]()[_0x2f6a94(0x2de)](0x2,'0')+'\x20'+_0x3d6dc9[_0x2f6a94(0x278)]()[_0x2f6a94(0x2c5)]()[_0x2f6a94(0x2de)](0x2,'0')+':'+_0x3d6dc9['getMinutes']()[_0x2f6a94(0x2c5)]()[_0x2f6a94(0x2de)](0x2,'0')+':'+_0x3d6dc9[_0x2f6a94(0x333)]()[_0x2f6a94(0x2c5)]()['padStart'](0x2,'0');}function sleep(_0x4faf72){return new Promise(_0x41ab8b=>setTimeout(_0x41ab8b,_0x4faf72));}