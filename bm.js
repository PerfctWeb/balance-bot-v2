const _0xdef235=_0x193b;(function(_0x311c8e,_0x2a6740){const _0x41e56e=_0x193b,_0x57e28c=_0x311c8e();while(!![]){try{const _0x5a9408=parseInt(_0x41e56e(0x234))/0x1*(-parseInt(_0x41e56e(0x1ff))/0x2)+parseInt(_0x41e56e(0x131))/0x3*(parseInt(_0x41e56e(0x266))/0x4)+-parseInt(_0x41e56e(0x197))/0x5*(parseInt(_0x41e56e(0x15f))/0x6)+parseInt(_0x41e56e(0x13e))/0x7+parseInt(_0x41e56e(0x1cc))/0x8*(-parseInt(_0x41e56e(0x145))/0x9)+-parseInt(_0x41e56e(0x134))/0xa*(-parseInt(_0x41e56e(0x26b))/0xb)+-parseInt(_0x41e56e(0x175))/0xc*(-parseInt(_0x41e56e(0x1f0))/0xd);if(_0x5a9408===_0x2a6740)break;else _0x57e28c['push'](_0x57e28c['shift']());}catch(_0x74f78a){_0x57e28c['push'](_0x57e28c['shift']());}}}(_0xe310,0x36d74));const _0x5c0823=function(){let _0x16c532=!![];return function(_0x14da22,_0x14e199){const _0x619cb2=_0x16c532?function(){const _0x4e3fe4=_0x193b;if(_0x14e199){const _0x108e0b=_0x14e199[_0x4e3fe4(0x1fd)](_0x14da22,arguments);return _0x14e199=null,_0x108e0b;}}:function(){};return _0x16c532=![],_0x619cb2;};}(),_0x3bcd3c=_0x5c0823(this,function(){const _0x17e49d=_0x193b;return _0x3bcd3c[_0x17e49d(0x251)]()[_0x17e49d(0x1b1)]('(((.+)+)+)+$')[_0x17e49d(0x251)]()['constructor'](_0x3bcd3c)[_0x17e49d(0x1b1)]('(((.+)+)+)+$');});_0x3bcd3c();'use strict';process[_0xdef235(0x1a7)][_0xdef235(0x249)]=0x1;const childProcess=require('child_process'),FileSync=require(_0xdef235(0x217)),fs=require('fs'),fns=require(_0xdef235(0x151)),low=require(_0xdef235(0x216)),path=require(_0xdef235(0x191)),crypto=require(_0xdef235(0x25b)),Crypt=require(_0xdef235(0x26f))[_0xdef235(0x14e)],RSA=require(_0xdef235(0x26f))[_0xdef235(0x143)],bcrypt=require('bcryptjs'),jwt=require(_0xdef235(0x1ce)),analyticsLib=require(_0xdef235(0x1fc))['default'],googleAnalytics=require(_0xdef235(0x1ec))['default'],ipaddr=require('ipaddr.js'),argv=require(_0xdef235(0x1a5))(process['argv'][_0xdef235(0x15e)](0x2))[_0xdef235(0x209)],PORT=argv[_0xdef235(0x162)]||_0xdef235(0x1e6),pattern=/^[0-9]{2,4}$/;if(!pattern[_0xdef235(0x203)](PORT))return console[_0xdef235(0x1ab)](_0xdef235(0x192)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xdef235(0x139)](0x1);const HOST=argv[_0xdef235(0x136)]||null,userID=argv[_0xdef235(0x1b5)]||'';let bbpath='bb/',bbpath2='';const botfile=_0xdef235(0x22b),configfile=_0xdef235(0x190),settingsfile='bb-settings.json',securefile=_0xdef235(0x20a);!fs[_0xdef235(0x275)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xdef235(0x1a4)),configpath=userID?bbpath+_0xdef235(0x18a)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0xdef235(0x272);!fs[_0xdef235(0x275)](configpath)&&fs[_0xdef235(0x215)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xdef235(0x15a)]({'bots':[]})[_0xdef235(0x157)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0xdef235(0x157)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0xdef235(0x213),'rsaStandard':_0xdef235(0x24f)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xdef235(0x214))[_0xdef235(0x16a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0xdef235(0x19b)),app=express(),http=require(_0xdef235(0x174))['createServer'](app);app[_0xdef235(0x196)](express['static'](path[_0xdef235(0x259)](__dirname,bbpath2,_0xdef235(0x181)))),app[_0xdef235(0x196)](express[_0xdef235(0x130)](path[_0xdef235(0x259)](__dirname,bbpath2,_0xdef235(0x245)))),app[_0xdef235(0x1da)]('/',function(_0x2bf751,_0x1c5b54){const _0x29e7a7=_0xdef235;_0x1c5b54['sendFile'](path[_0x29e7a7(0x259)](__dirname,bbpath2,_0x29e7a7(0x181),'index.html'));}),app[_0xdef235(0x1da)](_0xdef235(0x16b),function(_0x12f55e,_0x50cd34){const _0x31e907=_0xdef235;_0x50cd34[_0x31e907(0x232)](path[_0x31e907(0x259)](__dirname,bbpath2,_0x31e907(0x245),_0x31e907(0x13d)));}),app[_0xdef235(0x1da)]('/:bot/portfolio',(_0x4640d5,_0x51d779)=>{const _0x45993e=_0xdef235;_0x51d779[_0x45993e(0x232)](path[_0x45993e(0x259)](__dirname,bbpath2,_0x45993e(0x245),_0x45993e(0x13d)));}),app[_0xdef235(0x1da)](_0xdef235(0x20b),(_0x1fd08a,_0x90b9d2)=>{const _0xd3b014=_0xdef235;_0x90b9d2[_0xd3b014(0x232)](path[_0xd3b014(0x259)](__dirname,bbpath2,'build',_0xd3b014(0x13d)));}),app['get']('/:bot/coins',(_0x57abe0,_0x32516f)=>{const _0x3d665e=_0xdef235;_0x32516f[_0x3d665e(0x232)](path[_0x3d665e(0x259)](__dirname,bbpath2,_0x3d665e(0x245),_0x3d665e(0x13d)));}),app[_0xdef235(0x1da)](_0xdef235(0x184),(_0x4c6fcf,_0x5f08c)=>{const _0x288e0c=_0xdef235;_0x5f08c[_0x288e0c(0x232)](path[_0x288e0c(0x259)](__dirname,bbpath2,_0x288e0c(0x245),_0x288e0c(0x13d)));}),app['get'](_0xdef235(0x147),(_0x3868ef,_0x31f9b0)=>{const _0x39d617=_0xdef235;_0x31f9b0[_0x39d617(0x232)](path['join'](__dirname,bbpath2,_0x39d617(0x245),_0x39d617(0x13d)));}),app[_0xdef235(0x1da)]('/:bot/support',(_0x38d80c,_0x4fb871)=>{const _0x48822e=_0xdef235;_0x4fb871[_0x48822e(0x232)](path[_0x48822e(0x259)](__dirname,bbpath2,_0x48822e(0x245),'index.html'));});function _0x193b(_0x47b9f9,_0x489af3){const _0x547df9=_0xe310();return _0x193b=function(_0x3bcd3c,_0x5c0823){_0x3bcd3c=_0x3bcd3c-0x130;let _0xe31041=_0x547df9[_0x3bcd3c];return _0xe31041;},_0x193b(_0x47b9f9,_0x489af3);}if(HOST)http['listen'](PORT,HOST);else http[_0xdef235(0x18b)](PORT);const io=require(_0xdef235(0x255))(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':_0xdef235(0x21f)})]}),TelegramBot=require(_0xdef235(0x165));let tgBot;if(settings[_0xdef235(0x211)]&&settings[_0xdef235(0x211)]!=''&&settings[_0xdef235(0x199)]&&settings[_0xdef235(0x199)]!='')initTelegram();function _0xe310(){const _0x411c65=['bbUsername','Crypt','bots','unlinkSync','date-fns','place-order','callback_query','pidExpireLogin','temporary\x20access\x20not\x20allowed','logged\x20out','write','Notifications\x20enabled\x0a','keys','defaults','botname','User\x20has\x20been\x20validated','Bot\x20Mgr\x20>\x20','slice','6GVvGpd','set','args','port','get-portfolio','getDate','node-telegram-bot-api','Invalid\x20Telegram\x20token','5\x20min','hashSync','Notifications\x20types:\x20','version','/:bot','error\x20while\x20deleting\x20config\x20files:\x20','randomFillSync','No\x20bots\x20running\x20right\x20now','Invalid\x20username\x20or\x20IP\x20address','uuid','delete-bot','function','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','http','24nedPJu','https://hodlerhacks.com','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','includes','length','1000','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','stopped','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','secure','get-logs','logout','build2','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','HTML','/:bot/history','getMinutes','running','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20store\x20configuration','blacklist','config/','listen','Ok,\x20will\x20send\x20order\x20notifications\x20only','privateKey','Notifications\x20enabled','isDirectory','bb-config.json','path','Error:\x20Invalid\x20argument\x20','catch','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','padStart','use','756955LpUwQE','temporary\x20token\x20generated','telegramUsername','removeListener','express','kill','then','-config.json','clientip','pidRefreshToken','placeOrder','getStartingBalances','username','clients','yargs/yargs','store-settings','env','Allow\x20login\x20from\x20IP\x20address\x20<b>','telegram2FaApproval','type','log','status','sortBy','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','new','new-disabled','search','telegramChatId','enabled\x20Bot\x20','update-bb','user','SIGTERM','emit','reason','telegramIpApproval','auth','publicKey','push','idling\x20bot\x20\x20\x20|\x20Bot\x20','/enable\x20-\x20enable\x20notifications\x0a','Invalid\x20authentication\x20token\x20(1)','decrypt','</b>\x20?','All','match','send','conn','reload','telegramEvents','forEach','store-configuration','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','telegram','16XkhUjc','All\x20bots\x20running\x20right\x20now','jsonwebtoken','Bot\x20','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20update\x20bot','kind','message','\x20>\x20','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','botID','alerts','notification','botmanager','get','/on\x20-\x20start\x20bot(s)\x0a','deleted\x20Bot\x20','allow','login\x20token\x20valid','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','-performance.json','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Access\x20enabled\x20for\x20','encryptedUuid','getTime','SIGINT','3000','disabled','timeshift','Unauthorized\x20attempt\x20to\x20update\x20settings','cancel-loading','30\x20min','@analytics/google-analytics','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','\x20|\x20','2469064HKlBud','yes','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getFullYear','generateKeyPairAsync','/status\x20-\x20show\x20bot(s)\x20status\x0a','compareSync','-----------------------------------------------------------------------------------','bot','Temporary\x20access\x20rejected','expiry','/restart\x20-\x20restart\x20bot(s)\x0a','analytics','apply','getHours','618166DDMBdX','<b>Telegram\x20bot\x20status:</b>\x0a','sign','live','test','add','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','bbPassword',':\x20Bot\x20Mgr\x20>\x20','All\x20bots','argv','bb-secure.json','/:bot/performance','login\x20required','cancelLoading','/off\x20-\x20stop\x20bot(s)\x0a','get-starting-balances','toIPv4Address','telegramToken','answerCallbackQuery','sha256','version.json','mkdirSync','lowdb','lowdb/adapters/FileSync','hex','************','settings.','Unauthorized\x20attempt\x20to\x20log\x20out','/disable\x20-\x20disable\x20notifications\x0a','access','invalid\x20credentials','UA-192771731-1','readdirSync','reset-password','showname','whitelist','\x20/\x20','settings','<b>Balance\x20Bot\x20status:</b>\x0a','max','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','2FA','bot.js','chat','remove','inherit','remoteAddress','temporaryAccessAllowed','enabled','sendFile','disconnect','1HNYMVY','127.0.0.1','order','show','isIPv4MappedAddress','sendMessage','reject','connection','initclient','data','assign','timestamp','Unauthorized\x20login\x20attempt\x20(timeout)','2FA\x20required','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','temporary\x20access\x20rejected','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','build','::ffff:127.0.0.1','add-bot','Invalid\x20IP\x20address','NTBA_FIX_319','telegramEnabled','temporary\x20access\x20timeout','login','Invalid\x20authentication\x20token\x20(2)','from','RSA-OAEP','Unauthorized\x20attempt\x20to\x20add\x20bot','toString','once','hasOwnProperty','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','socket.io','No\x20authentication\x20token','find','password','join','all','crypto','bot-','\x20minutes','Ok,\x20will\x20send\x20alert\x20notifications\x20only','whitelistEnabled','started','login\x20not\x20required','referer','loginRequired','2FA\x20login\x20token\x20generated','handshake','4hyBZvd','/help\x20-\x20show\x20available\x20commands\x0a','connected','entries',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','33RoUaKL','token','stop','secret','hybrid-crypto-js','success','f2aRequired','backup/','Alerts','polling_error','existsSync','static','501783WLJSKN','verify','onText','623650iCjhyJ','Balance\x20Bot\x20Server','host','login\x20token\x20generated','sockets','exit','Unauthorized\x20attempt\x20to\x20get\x20logs','isValid','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','index.html','1372336VgnhBr','cloneDeep','getMonth','headers','split','RSA','stopPolling','1103211VLxDaa','orders','/:bot/configuration','randomBytes','error','name','-results.json','value'];_0xe310=function(){return _0x411c65;};return _0xe310();}initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x43a65d=_0xdef235;console[_0x43a65d(0x1ab)](''),console['log'](_0x43a65d(0x1f7)),logging(_0x43a65d(0x1df)+PORT),console[_0x43a65d(0x1ab)](_0x43a65d(0x1f7));if(config[_0x43a65d(0x179)]!=0x0)config[_0x43a65d(0x1c8)](_0x53ebef=>{const _0x5e22ba=_0x43a65d;if(_0x53ebef[_0x5e22ba(0x1ac)]==_0x5e22ba(0x231)||_0x53ebef[_0x5e22ba(0x1ac)]==_0x5e22ba(0x1af))logging('starting\x20bot\x20|\x20Bot\x20'+_0x53ebef[_0x5e22ba(0x1d6)]+_0x5e22ba(0x1ef)+_0x53ebef[_0x5e22ba(0x15b)]),startBot([_0x53ebef[_0x5e22ba(0x1d6)],userID],{'cwd':bbpath},function(_0x217ae4){if(_0x217ae4)logging(_0x217ae4);});else(_0x53ebef[_0x5e22ba(0x1ac)]==_0x5e22ba(0x1e7)||_0x53ebef[_0x5e22ba(0x1ac)]=='new-disabled')&&logging(_0x5e22ba(0x1bd)+_0x53ebef[_0x5e22ba(0x1d6)]+_0x5e22ba(0x1ef)+_0x53ebef[_0x5e22ba(0x15b)]);});else!newBot&&console['log'](_0x43a65d(0x1f2));if(newBot)addBot();console['log']('-----------------------------------------------------------------------------------'),console['log']('');}function startSocket(){const _0x23569b=_0xdef235;io['on'](_0x23569b(0x23b),_0x5b3751=>{const _0x2ad462=_0x23569b;let _0x1041a5,_0x358f66,_0x462c39,_0x3388ee,_0x567d36;const _0x5b54e2=_0x5b3751[_0x2ad462(0x265)][_0x2ad462(0x141)][_0x2ad462(0x262)];_0x358f66=_0x5b54e2['match'](/bot[0-9]{3}/);if(_0x358f66)_0x462c39=_0x358f66[0x0][_0x2ad462(0x1c3)](/[0-9]{3}/);if(_0x462c39)_0x1041a5=_0x462c39[0x0];else _0x1041a5=_0x2ad462(0x1d9);const _0x3ac297=_0x5b3751[_0x2ad462(0x265)][_0x2ad462(0x1ba)][_0x2ad462(0x1e3)];if(!_0x3ac297)_0x5b3751['emit'](_0x2ad462(0x1ac),{'publicKey':secure[_0x2ad462(0x1bb)]});else{_0x3388ee=timelyDecrypt(_0x3ac297,![]);if(!_0x3388ee)_0x5b3751['emit'](_0x2ad462(0x1ac),{'publicKey':secure[_0x2ad462(0x1bb)]});else{_0x567d36=normalizeIP(_0x5b3751[_0x2ad462(0x1c5)][_0x2ad462(0x22f)])['store'];if(!devices[_0x3388ee])devices[_0x3388ee]={'uuid':_0x3388ee,'access':{'token':null}};devices[_0x3388ee]['ip']=_0x567d36;const _0x3dc739=addClient(_0x5b3751['id'],_0x3388ee,_0x1041a5);setAccess(_0x3dc739),_0x5b3751['on'](_0x2ad462(0x24c),_0xda1814=>{const _0x3c9351=_0x2ad462,_0x2e8f16=timelyDecrypt(_0xda1814[_0x3c9351(0x258)]);if(_0x2e8f16){_0xda1814={'username':_0xda1814[_0x3c9351(0x1a3)],'password':_0x2e8f16},devices[_0x3388ee][_0x3c9351(0x21d)]=validateCredentials(_0xda1814,_0x3388ee);if(devices[_0x3388ee]['access'][_0x3c9351(0x1dd)]==![]&&devices[_0x3388ee]['access'][_0x3c9351(0x1b8)]=='2FA\x20login\x20required')_0x5b3751[_0x3c9351(0x1b7)]('status',{'access':devices[_0x3388ee][_0x3c9351(0x21d)]}),loginAccess2FA(_0x3388ee,_0x567d36);else{if(devices[_0x3388ee][_0x3c9351(0x21d)][_0x3c9351(0x1dd)]==![]&&devices[_0x3388ee][_0x3c9351(0x21d)][_0x3c9351(0x1b8)]==_0x3c9351(0x21e))_0x5b3751[_0x3c9351(0x1b7)](_0x3c9351(0x1ac),{'access':devices[_0x3388ee][_0x3c9351(0x21d)]});else devices[_0x3388ee]['access'][_0x3c9351(0x1dd)]&&devices[_0x3388ee]['access']['reason']==_0x3c9351(0x137)&&(getClientsWithUuid(_0x3388ee)['forEach'](_0x2c6cc4=>{setAccess(_0x2c6cc4);}),setTokenRefresh(_0x3388ee),setSessionTimeout(_0x3c9351(0x24c),_0x3388ee));}}else logging(_0x3c9351(0x240));}),_0x5b3751['on'](_0x2ad462(0x221),()=>{resetPassword();}),_0x5b3751['on'](_0x2ad462(0x233),_0x12caaf=>{removeClient(_0x5b3751['id']);});}}});}function initClient(_0x18e837){const _0x105a5d=_0xdef235;if(_0x18e837!=_0x105a5d(0x1d9)&&config['apiKey']!=''){if(pid[_0x18e837])pid[_0x18e837][_0x105a5d(0x1c4)]({'function':_0x105a5d(0x23c),'args':null});}}function getSocket(_0x19f1ce){const _0x47de89=_0xdef235;return io['sockets'][_0x47de89(0x138)][_0x47de89(0x1da)](_0x19f1ce);}function setAccess(_0x5947d8){const _0x40fab7=_0xdef235,_0x49266a=getSocket(_0x5947d8['id']),_0xf77635=_0x5947d8[_0x40fab7(0x170)],_0x4d45f9=_0x5947d8[_0x40fab7(0x1f8)];devices[_0xf77635][_0x40fab7(0x21d)]=validateAccess(devices[_0xf77635][_0x40fab7(0x21d)][_0x40fab7(0x26c)],_0xf77635),_0x49266a[_0x40fab7(0x259)](_0xf77635);if(devices[_0xf77635][_0x40fab7(0x21d)][_0x40fab7(0x1dd)]){_0x49266a['join'](_0x4d45f9);if(_0x4d45f9==_0x40fab7(0x1d9))initializeSocketBotManager(_0x49266a);else initializeSocketBot(_0x49266a);initClient(_0x4d45f9);}devices[_0xf77635]['access']['token']&&devices[_0xf77635][_0x40fab7(0x21d)][_0x40fab7(0x1b8)]==_0x40fab7(0x198)&&setSessionTimeout(_0x40fab7(0x22a),_0xf77635),devices[_0xf77635][_0x40fab7(0x21d)][_0x40fab7(0x26c)]&&devices[_0xf77635][_0x40fab7(0x21d)][_0x40fab7(0x1b8)]==_0x40fab7(0x264)&&setSessionTimeout(_0x40fab7(0x24c),_0xf77635),_0x49266a[_0x40fab7(0x1b7)](_0x40fab7(0x1ac),{'status':_0x5947d8['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xf77635][_0x40fab7(0x21d)],'externalip':devices[_0xf77635]['ip'],'publicKey':secure['publicKey']}),devices[_0xf77635][_0x40fab7(0x21d)][_0x40fab7(0x1dd)]==![]&&devices[_0xf77635]['access'][_0x40fab7(0x1b8)]==_0x40fab7(0x241)&&temporaryAccess2FA(_0xf77635,devices[_0xf77635]['ip']);}function setSessionTimeout(_0x3221df,_0x1bfe6f){const _0x5edea1=_0xdef235;let _0x593035;if(_0x3221df==_0x5edea1(0x24c))_0x593035=loginExpiry*0x3c*0x3e8;else _0x593035=devices[_0x1bfe6f][_0x5edea1(0x1b9)][_0x5edea1(0x1fa)]*0x3c*0x3e8-(new Date()[_0x5edea1(0x1e4)]()-devices[_0x1bfe6f][_0x5edea1(0x1b9)]['timestamp']);if(devices[_0x1bfe6f][_0x5edea1(0x154)])clearTimeout(devices[_0x1bfe6f][_0x5edea1(0x154)]);devices[_0x1bfe6f][_0x5edea1(0x154)]=setTimeout(()=>{const _0x5b470d=_0x5edea1;if(devices[_0x1bfe6f]['pidRefreshToken'])clearTimeout(devices[_0x1bfe6f][_0x5b470d(0x1a0)]);removeSocketListeners(_0x1bfe6f),addBlacklist(_0x1bfe6f),devices[_0x1bfe6f][_0x5b470d(0x1b9)]=null,devices[_0x1bfe6f][_0x5b470d(0x1a9)]=null,devices[_0x1bfe6f][_0x5b470d(0x21d)][_0x5b470d(0x26c)]=null,devices[_0x1bfe6f][_0x5b470d(0x21d)]=validateAccess(devices[_0x1bfe6f][_0x5b470d(0x21d)]['token'],_0x1bfe6f),!(devices[_0x1bfe6f][_0x5b470d(0x21d)][_0x5b470d(0x1dd)]&&devices[_0x1bfe6f][_0x5b470d(0x21d)][_0x5b470d(0x1b8)]==_0x5b470d(0x261))&&(_0x3221df==_0x5b470d(0x24c)?io['to'](_0x1bfe6f)[_0x5b470d(0x1b7)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1bfe6f)['emit'](_0x5b470d(0x1ac),{'access':{'allow':![],'reason':_0x5b470d(0x24b),'token':null}})),devices[_0x1bfe6f][_0x5b470d(0x21d)]['token']=null;},_0x593035);}function setTokenRefresh(_0x253364){const _0xb6dac6=_0xdef235;if(devices[_0x253364][_0xb6dac6(0x1a0)])clearTimeout(devices[_0x253364][_0xb6dac6(0x1a0)]);devices[_0x253364]['pidRefreshToken']=setTimeout(()=>{const _0x5ccdc0=_0xb6dac6;getClientsWithUuid(_0x253364)[_0x5ccdc0(0x179)]!=0x0?(devices[_0x253364][_0x5ccdc0(0x21d)]=refreshToken(_0x253364),io['to'](_0x253364)[_0x5ccdc0(0x1b7)](_0x5ccdc0(0x1ac),{'status':_0x5ccdc0(0x268),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x253364]['access'],'externalip':devices[_0x253364]['ip'],'publicKey':secure[_0x5ccdc0(0x1bb)]}),setTokenRefresh(_0x253364)):clearTimeout(devices[_0x253364][_0x5ccdc0(0x1a0)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1b022e){const _0x1f8616=_0xdef235,_0x1c4edf=getClient(_0x1b022e['id'])[_0x1f8616(0x170)];_0x1b022e[_0x1f8616(0x1b7)]('bots',config),_0x1b022e[_0x1f8616(0x1b7)](_0x1f8616(0x225),cleanSettings()),_0x1b022e['on'](_0x1f8616(0x247),_0x177699=>{const _0x2959c1=_0x1f8616;if(validateAccess(_0x177699,_0x1c4edf)[_0x2959c1(0x1dd)])addBot();else logging(_0x2959c1(0x250));}),_0x1b022e['on']('update-bot',(_0x5b4db0,_0x2159fb)=>{const _0x359c2f=_0x1f8616;if(validateAccess(_0x2159fb,_0x1c4edf)['allow'])toggleBot(_0x5b4db0[_0x359c2f(0x1d6)],_0x5b4db0['status'],_0x5b4db0[_0x359c2f(0x202)]);else logging(_0x359c2f(0x1d1));}),_0x1b022e['on'](_0x1f8616(0x171),(_0x35a1ff,_0x2315b1)=>{if(validateAccess(_0x2315b1,_0x1c4edf)['allow'])deleteBot(_0x35a1ff);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1b022e['on'](_0x1f8616(0x1a6),(_0x52573c,_0x31ff3d)=>{const _0x1ed3c9=_0x1f8616;if(validateAccess(_0x31ff3d,_0x1c4edf)[_0x1ed3c9(0x1dd)])storeSettings(_0x52573c,!![]);else logging(_0x1ed3c9(0x1e9));}),_0x1b022e['on'](_0x1f8616(0x1b4),(_0x4d40bb,_0x44a992)=>{const _0x4d1212=_0x1f8616;if(validateAccess(_0x44a992,_0x1c4edf)[_0x4d1212(0x1dd)])updateBB();else logging(_0x4d1212(0x1e9));}),_0x1b022e['on'](_0x1f8616(0x180),_0xc2fcc1=>{const _0x82b73c=_0x1f8616;if(validateAccess(_0xc2fcc1,_0x1c4edf)['allow']){if(devices[_0x1c4edf][_0x82b73c(0x1a0)])clearTimeout(devices[_0x1c4edf][_0x82b73c(0x1a0)]);if(devices[_0x1c4edf][_0x82b73c(0x154)])clearTimeout(devices[_0x1c4edf][_0x82b73c(0x154)]);removeSocketListeners(getClient(_0x1b022e['id'])[_0x82b73c(0x170)]),addBlacklist(_0x1c4edf),devices[_0x1c4edf][_0x82b73c(0x1b9)]=null,devices[_0x1c4edf][_0x82b73c(0x1a9)]=null,devices[_0x1c4edf][_0x82b73c(0x21d)][_0x82b73c(0x26c)]=null,io['to'](getClient(_0x1b022e['id'])[_0x82b73c(0x170)])[_0x82b73c(0x1b7)](_0x82b73c(0x1ac),{'access':{'allow':![],'reason':_0x82b73c(0x156),'token':null}});}else logging(_0x82b73c(0x21b));});}function initializeSocketBot(_0x1363e8){const _0x19faa1=_0xdef235,_0x1bd260=getClient(_0x1363e8['id'])[_0x19faa1(0x1f8)],_0x15170f=getClient(_0x1363e8['id'])['uuid'];_0x1363e8['on'](_0x19faa1(0x17f),(_0x170bf5,_0x40595d)=>{const _0x2b877a=_0x19faa1;if(validateAccess(_0x40595d,_0x15170f)[_0x2b877a(0x1dd)]){if(pid[_0x1bd260])pid[_0x1bd260][_0x2b877a(0x1c4)]({'function':'emitHistory','args':_0x170bf5});}else logging(_0x2b877a(0x13a));}),_0x1363e8['on'](_0x19faa1(0x163),(_0x5b980b,_0x199f84)=>{if(validateAccess(_0x199f84,_0x15170f)['allow']){if(pid[_0x1bd260])pid[_0x1bd260]['send']({'function':'getPortfolio','args':_0x5b980b});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1363e8['on'](_0x19faa1(0x1c9),(_0x4c95bd,_0x3eaff6)=>{const _0x2ecd86=_0x19faa1;if(validateAccess(_0x3eaff6,_0x15170f)['allow']){if(pid[_0x1bd260])pid[_0x1bd260]['send']({'function':'storeConfiguration','args':_0x4c95bd});}else logging(_0x2ecd86(0x188));}),_0x1363e8['on']('store-headless',(_0x370ffd,_0x2794dd)=>{const _0x4f40b1=_0x19faa1;if(validateAccess(_0x2794dd,_0x15170f)[_0x4f40b1(0x1dd)]){if(pid[_0x1bd260])pid[_0x1bd260][_0x4f40b1(0x1c4)]({'function':'storeHeadless','args':_0x370ffd});}else logging(_0x4f40b1(0x177));}),_0x1363e8['on'](_0x19faa1(0x20f),_0x46f136=>{const _0x3f0c14=_0x19faa1;if(validateAccess(_0x46f136,_0x15170f)['allow']){if(pid[_0x1bd260])pid[_0x1bd260][_0x3f0c14(0x1c4)]({'function':_0x3f0c14(0x1a2),'args':null});}else logging(_0x3f0c14(0x205));}),_0x1363e8['on'](_0x19faa1(0x152),(_0x116244,_0x32b2f3)=>{const _0x11fa3a=_0x19faa1;if(validateAccess(_0x32b2f3,_0x15170f)[_0x11fa3a(0x1dd)]){if(pid[_0x1bd260])pid[_0x1bd260][_0x11fa3a(0x1c4)]({'function':_0x11fa3a(0x1a1),'args':_0x116244});}else logging(_0x11fa3a(0x1d5));}),_0x1363e8['on'](_0x19faa1(0x1ea),_0xb7c534=>{const _0x49644b=_0x19faa1;if(validateAccess(_0xb7c534,_0x15170f)[_0x49644b(0x1dd)]){if(pid[_0x1bd260])pid[_0x1bd260][_0x49644b(0x1c4)]({'function':_0x49644b(0x20d),'args':null});}else logging(_0x49644b(0x17b));}),_0x1363e8['on'](_0x19faa1(0x180),_0x218ab2=>{const _0x417a38=_0x19faa1;if(validateAccess(_0x218ab2,_0x15170f)[_0x417a38(0x1dd)]){if(devices[_0x15170f][_0x417a38(0x1a0)])clearTimeout(devices[_0x15170f][_0x417a38(0x1a0)]);if(devices[_0x15170f][_0x417a38(0x154)])clearTimeout(devices[_0x15170f][_0x417a38(0x154)]);removeSocketListeners(getClient(_0x1363e8['id'])[_0x417a38(0x170)]),addBlacklist(_0x15170f),devices[_0x15170f][_0x417a38(0x1b9)]=null,devices[_0x15170f]['telegram2FaApproval']=null,devices[_0x15170f][_0x417a38(0x21d)][_0x417a38(0x26c)]=null,io['to'](getClient(_0x1363e8['id'])['uuid'])[_0x417a38(0x1b7)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x417a38(0x21b));});}function removeSocketListeners(_0x5675b4){getClientsWithUuid(_0x5675b4)['forEach'](_0xce9e0c=>{getSocket(_0xce9e0c['id'])['removeAllListeners']();});}function cleanSettings(){const _0x3ca304=_0xdef235;let _0x48e42b=settings;return settings[_0x3ca304(0x211)]&&settings['telegramToken']!=''&&(_0x48e42b={..._0x48e42b,'telegramToken':_0x3ca304(0x219)}),settings[_0x3ca304(0x206)]&&settings[_0x3ca304(0x206)]!=''&&(_0x48e42b={..._0x48e42b,'bbPassword':_0x3ca304(0x219)}),_0x48e42b;}function updateBB(){const _0x47bc82=_0xdef235;installingUpdate=!![],config[_0x47bc82(0x1c8)](_0xea8679=>{restartBot(_0xea8679['botID']);}),process[_0x47bc82(0x1c4)]({'update':!![]},_0x347b92=>{});}function startBot(_0x5bcaf7,_0x134bd7,_0x326b3d){const _0x12816e=_0xdef235;let _0x2548c6=![];const _0x10f0e6=_0x5bcaf7[0x0];_0x134bd7={..._0x134bd7,'stdio':[_0x12816e(0x22e),_0x12816e(0x22e),'inherit','ipc']},pid[_0x10f0e6]=childProcess['fork'](botfile,_0x5bcaf7,_0x134bd7),pid[_0x10f0e6]['on'](_0x12816e(0x1d3),_0xb7fc0c=>{const _0x45d4c2=_0x12816e;switch(Object[_0x45d4c2(0x159)](_0xb7fc0c)[0x0]){case _0x45d4c2(0x15b):updateBotName(_0x10f0e6,_0xb7fc0c['botname']);break;case _0x45d4c2(0x1ac):updateStatus(_0x10f0e6,_0xb7fc0c[_0x45d4c2(0x1ac)]);break;case _0x45d4c2(0x202):updateLive(_0x10f0e6,_0xb7fc0c[_0x45d4c2(0x202)]);break;case'started':updateLive(_0x10f0e6,_0xb7fc0c[_0x45d4c2(0x260)]),io['to'](_0x10f0e6)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x45d4c2(0x26d):_0xb7fc0c[_0x45d4c2(0x26d)]=='restart'&&restartBot(_0x10f0e6);_0xb7fc0c[_0x45d4c2(0x26d)]==_0x45d4c2(0x19c)&&toggleBot(_0x10f0e6,_0x45d4c2(0x1e7),_0x45d4c2(0x17c));break;case _0x45d4c2(0x1cb):sendTelegram(_0x10f0e6,_0xb7fc0c[_0x45d4c2(0x1cb)]);break;case _0x45d4c2(0x172):io['to'](_0x10f0e6)[_0x45d4c2(0x1b7)](_0xb7fc0c[_0x45d4c2(0x172)],_0xb7fc0c[_0x45d4c2(0x161)]);break;}}),pid[_0x10f0e6]['on'](_0x12816e(0x149),function(_0x144bc1){if(_0x2548c6)return;_0x2548c6=!![],_0x326b3d(_0x144bc1);}),pid[_0x10f0e6]['on'](_0x12816e(0x139),function(_0x30ff0a){const _0x2205c6=_0x12816e;if(installingUpdate)return;if(_0x2548c6)return;_0x2548c6=!![],_0x326b3d(null);const _0x286da0=dbConfig['get'](_0x2205c6(0x14f))['find']({'botID':_0x10f0e6})['value']();_0x286da0&&(_0x286da0[_0x2205c6(0x1ac)]==_0x2205c6(0x231)||_0x286da0[_0x2205c6(0x1ac)]==_0x2205c6(0x1af))&&(updateLive(_0x10f0e6,'stopped'),logging('restarting\x20Bot\x20'+_0x10f0e6),startBot([_0x10f0e6,userID],{'cwd':bbpath},function(_0x418170){if(_0x418170)logging(_0x418170);}));});}function stopBot(_0x5610ec){const _0x33d68d=_0xdef235;getClientsWithBotID(_0x5610ec)[_0x33d68d(0x1c8)](_0x41e3d8=>{const _0x50dabf=_0x33d68d;getSocket(_0x41e3d8['id'])[_0x50dabf(0x233)](!![]),removeClient(_0x41e3d8['id']);});if(pid[_0x5610ec])pid[_0x5610ec]['kill']();}function restartBot(_0x4dc1df){const _0x1f5e91=_0xdef235;if(pid[_0x4dc1df])pid[_0x4dc1df][_0x1f5e91(0x19c)]();}function addBot(){const _0x1be76f=_0xdef235;let _0x2f14db;for(let _0xf14116=0x1;_0xf14116<0x3e9;_0xf14116++){_0x2f14db=_0xf14116[_0x1be76f(0x251)]()[_0x1be76f(0x195)](0x3,'0');let _0x82b819=config[_0x1be76f(0x257)](_0xcee257=>_0xcee257[_0x1be76f(0x1d6)]==_0x2f14db);if(!_0x82b819)break;}if(_0x2f14db===_0x1be76f(0x17a)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x2f14db),dbConfig[_0x1be76f(0x1da)](_0x1be76f(0x14f))[_0x1be76f(0x1bc)]({'botID':_0x2f14db,'botname':_0x1be76f(0x1cf)+_0x2f14db,'status':_0x1be76f(0x1af),'live':''})[_0x1be76f(0x157)](),startBot([_0x2f14db,userID],{'cwd':bbpath},function(_0x2ed22e){if(_0x2ed22e)logging(_0x2ed22e);}),config=getConfiguration(),io['to'](_0x1be76f(0x1d9))['emit'](_0x1be76f(0x14f),config);}function deleteBot(_0x16c443){const _0x1733da=_0xdef235;getClientsWithBotID(_0x16c443)[_0x1733da(0x1c8)](_0x3b9604=>{const _0x4691c9=_0x1733da;getSocket(_0x3b9604['id'])[_0x4691c9(0x233)](!![]),removeClient(_0x3b9604['id']);}),dbConfig[_0x1733da(0x1da)]('bots')[_0x1733da(0x22d)]({'botID':_0x16c443})['write'](),logging(_0x1733da(0x1dc)+_0x16c443),stopBot(_0x16c443);try{fs[_0x1733da(0x150)](path[_0x1733da(0x259)](configpath,_0x1733da(0x25c)+_0x16c443+_0x1733da(0x19e))),fs[_0x1733da(0x150)](path['join'](configpath,_0x1733da(0x25c)+_0x16c443+'-events.json')),fs['unlinkSync'](path[_0x1733da(0x259)](configpath,'bot-'+_0x16c443+_0x1733da(0x1e0))),fs[_0x1733da(0x150)](path['join'](configpath,'bot-'+_0x16c443+_0x1733da(0x14b)));}catch(_0x1277a0){if(_0x1277a0)logging(_0x1733da(0x16c),_0x1277a0);}config=getConfiguration(),io['to'](_0x1733da(0x1d9))[_0x1733da(0x1b7)](_0x1733da(0x14f),config);}function toggleBot(_0x3c4d7a,_0x450450,_0x27739c){const _0x5b3e43=_0xdef235;dbConfig[_0x5b3e43(0x1da)](_0x5b3e43(0x14f))['find']({'botID':_0x3c4d7a})['assign']({'status':_0x450450})['assign']({'live':_0x27739c})['write']();if(_0x450450==_0x5b3e43(0x231)||_0x450450=='new')logging(_0x5b3e43(0x1b3)+_0x3c4d7a),startBot([_0x3c4d7a,userID],{'cwd':bbpath},function(_0x2b01fb){if(_0x2b01fb)logging(_0x2b01fb);});else(_0x450450==_0x5b3e43(0x1e7)||_0x450450==_0x5b3e43(0x1b0))&&(logging('disabled\x20Bot\x20'+_0x3c4d7a),stopBot(_0x3c4d7a));config=getConfiguration(),io['to']('botmanager')[_0x5b3e43(0x1b7)](_0x5b3e43(0x14f),config);}function toggleStatus(_0x3bd3dd){const _0x20ab0a=_0xdef235;let _0x397ddf=dbConfig[_0x20ab0a(0x1da)]('bots')[_0x20ab0a(0x257)]({'botID':_0x3bd3dd})[_0x20ab0a(0x14c)](),_0x303737;if(_0x397ddf['status']===_0x20ab0a(0x231))_0x303737=_0x20ab0a(0x1e7);else{if(_0x397ddf[_0x20ab0a(0x1ac)]==='new')_0x303737=_0x20ab0a(0x1b0);else{if(_0x397ddf[_0x20ab0a(0x1ac)]===_0x20ab0a(0x1b0))_0x303737='new';else{if(_0x397ddf[_0x20ab0a(0x1ac)]==='disabled')_0x303737='enabled';}}}return _0x303737;}function updateStatus(_0x48a00a,_0x4d27a9){const _0x423a68=_0xdef235;dbConfig[_0x423a68(0x1da)](_0x423a68(0x14f))[_0x423a68(0x257)]({'botID':_0x48a00a})[_0x423a68(0x23e)]({'status':_0x4d27a9})[_0x423a68(0x157)](),config=getConfiguration(),io['to'](_0x423a68(0x1d9))[_0x423a68(0x1b7)](_0x423a68(0x14f),config);}function updateLive(_0xdcd512,_0x30a3d7){const _0x528c36=_0xdef235;dbConfig[_0x528c36(0x1da)](_0x528c36(0x14f))['find']({'botID':_0xdcd512})[_0x528c36(0x23e)]({'live':_0x30a3d7})[_0x528c36(0x157)](),config=getConfiguration(),io['to'](_0x528c36(0x1d9))[_0x528c36(0x1b7)](_0x528c36(0x14f),config);}function updateBotName(_0x4da045,_0xdce69c){const _0x53c34d=_0xdef235;dbConfig[_0x53c34d(0x1da)](_0x53c34d(0x14f))['find']({'botID':_0x4da045})['assign']({'botname':_0xdce69c})[_0x53c34d(0x157)](),config=getConfiguration(),io['to'](_0x53c34d(0x1d9))['emit'](_0x53c34d(0x14f),config);}function telegramError(_0x39ae71){const _0x4a8bcb=_0xdef235;console[_0x4a8bcb(0x1ab)](getTimeStamp()+_0x4a8bcb(0x26a));}function validateTelegram(_0x5c9a6c){const _0x325a12=_0xdef235;if(_0x5c9a6c['from'][_0x325a12(0x1a3)]!=settings[_0x325a12(0x199)]&&'@'+_0x5c9a6c[_0x325a12(0x24e)][_0x325a12(0x1a3)]!=settings[_0x325a12(0x199)])return tgBot[_0x325a12(0x239)](_0x5c9a6c[_0x325a12(0x22c)]['id'],_0x325a12(0x244),{'parse_mode':'HTML'})[_0x325a12(0x193)](_0x35c719=>{telegramError(_0x35c719);}),![];return!![];}async function initTelegram(){const _0x34265f=_0xdef235;if(tgBot)tgBot[_0x34265f(0x144)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x34265f(0x211)],{'polling':!![]});let _0x1217da='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x1217da+='\x0a',_0x1217da+=_0x34265f(0x1be),_0x1217da+=_0x34265f(0x21c),_0x1217da+=_0x34265f(0x17d),_0x1217da+=_0x34265f(0x1fb),_0x1217da+=_0x34265f(0x1db),_0x1217da+=_0x34265f(0x20e),_0x1217da+=_0x34265f(0x1f5),_0x1217da+=_0x34265f(0x267);let _0x52b372=_0x34265f(0x242);_0x52b372+='\x0a',_0x52b372+=_0x1217da,tgBot[_0x34265f(0x133)](/\/start/,_0x55398e=>{const _0x19aa19=_0x34265f;if(!validateTelegram(_0x55398e))return;if(settings[_0x19aa19(0x1b2)]!=_0x55398e[_0x19aa19(0x22c)]['id'])updateSetting(_0x19aa19(0x1b2),_0x55398e['chat']['id']);updateSetting(_0x19aa19(0x24a),!![]),tgBot[_0x19aa19(0x239)](_0x55398e['chat']['id'],_0x52b372)[_0x19aa19(0x193)](_0x57b511=>{telegramError(_0x57b511);});}),tgBot['onText'](/\/enable/,_0x4c3f00=>{const _0x59b753=_0x34265f;if(!validateTelegram(_0x4c3f00))return;if(settings[_0x59b753(0x1b2)]!=_0x4c3f00[_0x59b753(0x22c)]['id'])updateSetting(_0x59b753(0x1b2),_0x4c3f00[_0x59b753(0x22c)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x59b753(0x239)](_0x4c3f00[_0x59b753(0x22c)]['id'],_0x59b753(0x18e))[_0x59b753(0x193)](_0x34b7b8=>{telegramError(_0x34b7b8);});}),tgBot[_0x34265f(0x133)](/\/config/,async _0x477152=>{const _0x5ebff3=_0x34265f;if(!validateTelegram(_0x477152))return;tgBot['removeListener']('callback_query'),tgBot[_0x5ebff3(0x239)](_0x477152[_0x5ebff3(0x22c)]['id'],_0x5ebff3(0x182),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x5ebff3(0x146)},{'text':_0x5ebff3(0x273),'callback_data':'alerts'},{'text':_0x5ebff3(0x1c2),'callback_data':_0x5ebff3(0x25a)}]]}})[_0x5ebff3(0x193)](_0x4d097f=>{telegramError(_0x4d097f);}),tgBot['on'](_0x5ebff3(0x153),async _0x466f70=>{const _0x2a3153=_0x5ebff3,_0x497019=_0x466f70[_0x2a3153(0x23d)],_0x2024a6=_0x466f70[_0x2a3153(0x1d3)];tgBot[_0x2a3153(0x212)](_0x466f70['id'])[_0x2a3153(0x19d)](async()=>{const _0x1d7481=_0x2a3153;_0x497019==_0x1d7481(0x146)&&(updateSetting('telegramEvents',_0x1d7481(0x146)),updateSetting(_0x1d7481(0x24a),!![]),await tgBot['sendMessage'](_0x2024a6[_0x1d7481(0x22c)]['id'],_0x1d7481(0x18c))['catch'](_0x5cd0cd=>{telegramError(_0x5cd0cd);}));_0x497019==_0x1d7481(0x1d7)&&(updateSetting(_0x1d7481(0x1c7),_0x1d7481(0x1d7)),updateSetting(_0x1d7481(0x24a),!![]),await tgBot[_0x1d7481(0x239)](_0x2024a6[_0x1d7481(0x22c)]['id'],_0x1d7481(0x25e))['catch'](_0x22d8df=>{telegramError(_0x22d8df);}));_0x497019=='all'&&(updateSetting(_0x1d7481(0x1c7),_0x1d7481(0x25a)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1d7481(0x239)](_0x2024a6[_0x1d7481(0x22c)]['id'],_0x1d7481(0x254))[_0x1d7481(0x193)](_0xcfcd25=>{telegramError(_0xcfcd25);}));if(!settings['telegramChatId'])tgBot[_0x1d7481(0x239)](_0x2024a6[_0x1d7481(0x22c)]['id'],_0x1d7481(0x1e1))[_0x1d7481(0x193)](_0x2a90a7=>{telegramError(_0x2a90a7);});}),tgBot[_0x2a3153(0x19a)](_0x2a3153(0x153));});}),tgBot['onText'](/\/status/,_0x3172c1=>{const _0x1e5a61=_0x34265f;if(!validateTelegram(_0x3172c1))return;let _0x58fb5d=_0x1e5a61(0x226);config[_0x1e5a61(0x1c8)](_0x5a0c05=>{const _0x5ce05f=_0x1e5a61;_0x58fb5d+=_0x5ce05f(0x1cf)+_0x5a0c05[_0x5ce05f(0x1d6)]+_0x5ce05f(0x1ef)+_0x5a0c05[_0x5ce05f(0x15b)]+':\x20'+_0x5a0c05[_0x5ce05f(0x1ac)]+_0x5ce05f(0x224)+_0x5a0c05[_0x5ce05f(0x202)]+'\x0a';}),_0x58fb5d+='\x0a',_0x58fb5d+=_0x1e5a61(0x200),_0x58fb5d+=!settings[_0x1e5a61(0x24a)]?'Notifications\x20disabled\x0a':_0x1e5a61(0x158),_0x58fb5d+=settings[_0x1e5a61(0x24a)]?settings['telegramEvents']==_0x1e5a61(0x25a)?_0x1e5a61(0x194):_0x1e5a61(0x169)+settings[_0x1e5a61(0x1c7)]+'\x20only\x0a':'',tgBot[_0x1e5a61(0x239)](_0x3172c1[_0x1e5a61(0x22c)]['id'],_0x58fb5d,{'parse_mode':_0x1e5a61(0x183)})[_0x1e5a61(0x193)](_0x65ce85=>{telegramError(_0x65ce85);});}),tgBot['onText'](/\/restart/,_0x5ce693=>{const _0x1e5489=_0x34265f;if(!validateTelegram(_0x5ce693))return;tgBot[_0x1e5489(0x19a)]('callback_query');const _0x4f5a47=getEnabledBots();if(_0x4f5a47['length']==0x0)tgBot[_0x1e5489(0x239)](_0x5ce693[_0x1e5489(0x22c)]['id'],_0x1e5489(0x16e))[_0x1e5489(0x193)](_0x1057a6=>{telegramError(_0x1057a6);});else{if(_0x4f5a47[_0x1e5489(0x179)]>0x1)_0x4f5a47[_0x1e5489(0x1bc)]({'botID':'all'});let _0x183f9c=[],_0x567219=[];const _0x5074c1=_0x4f5a47[_0x1e5489(0x179)]%0x4==0x0||_0x4f5a47[_0x1e5489(0x179)]%0x4==0x3||_0x4f5a47[_0x1e5489(0x179)]%0x3==0x1?0x4:0x3;let _0x271036=0x0;_0x4f5a47[_0x1e5489(0x1c8)]((_0x549b74,_0x570aed)=>{const _0x4b5aa1=_0x1e5489;if(_0x570aed%_0x5074c1==0x0)_0x567219=[];_0x567219['push']({'text':_0x549b74['botID']==_0x4b5aa1(0x25a)?'All\x20bots':_0x4b5aa1(0x1cf)+_0x549b74['botID'],'callback_data':_0x549b74['botID']}),_0x570aed%_0x5074c1==0x0&&(_0x183f9c[_0x271036]=_0x567219,_0x271036++);}),tgBot[_0x1e5489(0x239)](_0x5ce693[_0x1e5489(0x22c)]['id'],_0x1e5489(0x13c),{'reply_markup':{'inline_keyboard':_0x183f9c}})[_0x1e5489(0x193)](_0x270af7=>{telegramError(_0x270af7);}),tgBot['on'](_0x1e5489(0x153),async _0x595c28=>{const _0x470556=_0x1e5489,_0x16f19a=_0x595c28[_0x470556(0x23d)],_0x47b554=_0x595c28[_0x470556(0x1d3)];tgBot[_0x470556(0x212)](_0x595c28['id'])['then'](async()=>{const _0x1d5257=_0x470556;if(_0x16f19a==_0x1d5257(0x25a)){if(settings[_0x1d5257(0x1c7)]==_0x1d5257(0x146))tgBot[_0x1d5257(0x239)](_0x47b554[_0x1d5257(0x22c)]['id'],_0x1d5257(0x1d0))[_0x1d5257(0x193)](_0x2edd15=>{telegramError(_0x2edd15);});config[_0x1d5257(0x1c8)](_0x429104=>{const _0x40ae0e=_0x1d5257;restartBot(_0x429104[_0x40ae0e(0x1d6)]);});}else{if(settings[_0x1d5257(0x1c7)]==_0x1d5257(0x146))tgBot[_0x1d5257(0x239)](_0x47b554[_0x1d5257(0x22c)]['id'],_0x1d5257(0x1ae)+_0x16f19a)[_0x1d5257(0x193)](_0x59daf9=>{telegramError(_0x59daf9);});restartBot(_0x16f19a);}}),tgBot[_0x470556(0x19a)]('callback_query');});}}),tgBot[_0x34265f(0x133)](/\/on/,_0x2c3565=>{const _0x29bb46=_0x34265f;if(!validateTelegram(_0x2c3565))return;tgBot['removeListener'](_0x29bb46(0x153));const _0x5a4357=getDisabledBots();if(_0x5a4357[_0x29bb46(0x179)]==0x0)tgBot[_0x29bb46(0x239)](_0x2c3565[_0x29bb46(0x22c)]['id'],_0x29bb46(0x1cd))[_0x29bb46(0x193)](_0x310303=>{telegramError(_0x310303);});else{if(_0x5a4357[_0x29bb46(0x179)]>0x1)_0x5a4357[_0x29bb46(0x1bc)]({'botID':_0x29bb46(0x25a)});let _0x7a363d=[],_0x344eac=[];const _0x109309=_0x5a4357[_0x29bb46(0x179)]%0x4==0x0||_0x5a4357[_0x29bb46(0x179)]%0x4==0x3||_0x5a4357['length']%0x3==0x1?0x4:0x3;let _0x1ef9a3=0x0;_0x5a4357['forEach']((_0x1b4081,_0x4e9c1e)=>{const _0x58436b=_0x29bb46;if(_0x4e9c1e%_0x109309==0x0)_0x344eac=[];_0x344eac['push']({'text':_0x1b4081[_0x58436b(0x1d6)]=='all'?'All\x20bots':_0x58436b(0x1cf)+_0x1b4081['botID'],'callback_data':_0x1b4081[_0x58436b(0x1d6)]}),_0x4e9c1e%_0x109309==0x0&&(_0x7a363d[_0x1ef9a3]=_0x344eac,_0x1ef9a3++);}),tgBot[_0x29bb46(0x239)](_0x2c3565[_0x29bb46(0x22c)]['id'],_0x29bb46(0x173),{'reply_markup':{'inline_keyboard':_0x7a363d}})[_0x29bb46(0x193)](_0x95d9bb=>{telegramError(_0x95d9bb);}),tgBot['on']('callback_query',async _0x911d2a=>{const _0x2ebed1=_0x29bb46,_0x3e5c86=_0x911d2a['data'],_0x29832f=_0x911d2a[_0x2ebed1(0x1d3)];tgBot[_0x2ebed1(0x212)](_0x911d2a['id'])['then'](async()=>{const _0x5aea71=_0x2ebed1;if(_0x3e5c86==_0x5aea71(0x25a)){if(settings['telegramEvents']=='orders')tgBot[_0x5aea71(0x239)](_0x29832f[_0x5aea71(0x22c)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x1e2fe5=>{telegramError(_0x1e2fe5);});_0x5a4357['forEach'](_0x1ba88f=>{const _0x26aa71=_0x5aea71;if(_0x1ba88f['botID']!=_0x26aa71(0x25a))toggleBot(_0x1ba88f[_0x26aa71(0x1d6)],toggleStatus(_0x1ba88f[_0x26aa71(0x1d6)]),_0x26aa71(0x17c));});}else{if(settings[_0x5aea71(0x1c7)]==_0x5aea71(0x146))tgBot[_0x5aea71(0x239)](_0x29832f['chat']['id'],_0x5aea71(0x1ed)+_0x3e5c86)['catch'](_0x2533bd=>{telegramError(_0x2533bd);});toggleBot(_0x3e5c86,toggleStatus(_0x3e5c86),_0x5aea71(0x17c));}}),tgBot[_0x2ebed1(0x19a)](_0x2ebed1(0x153));});}}),tgBot['onText'](/\/off/,_0x4d55c2=>{const _0x194bf4=_0x34265f;if(!validateTelegram(_0x4d55c2))return;tgBot[_0x194bf4(0x19a)](_0x194bf4(0x153));const _0x58d8e0=getEnabledBots();if(_0x58d8e0[_0x194bf4(0x179)]==0x0)tgBot[_0x194bf4(0x239)](_0x4d55c2[_0x194bf4(0x22c)]['id'],_0x194bf4(0x16e))[_0x194bf4(0x193)](_0x38db25=>{telegramError(_0x38db25);});else{if(_0x58d8e0[_0x194bf4(0x179)]>0x1)_0x58d8e0[_0x194bf4(0x1bc)]({'botID':_0x194bf4(0x25a)});let _0x435390=[],_0x30f1a7=[];const _0x5f05d6=_0x58d8e0[_0x194bf4(0x179)]%0x4==0x0||_0x58d8e0['length']%0x4==0x3||_0x58d8e0[_0x194bf4(0x179)]%0x3==0x1?0x4:0x3;let _0x472724=0x0;_0x58d8e0[_0x194bf4(0x1c8)]((_0x5c48a1,_0x2ea788)=>{const _0x18cc75=_0x194bf4;if(_0x2ea788%_0x5f05d6==0x0)_0x30f1a7=[];_0x30f1a7[_0x18cc75(0x1bc)]({'text':_0x5c48a1[_0x18cc75(0x1d6)]==_0x18cc75(0x25a)?_0x18cc75(0x208):_0x18cc75(0x1cf)+_0x5c48a1['botID'],'callback_data':_0x5c48a1[_0x18cc75(0x1d6)]}),_0x2ea788%_0x5f05d6==0x0&&(_0x435390[_0x472724]=_0x30f1a7,_0x472724++);}),tgBot[_0x194bf4(0x239)](_0x4d55c2[_0x194bf4(0x22c)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x435390}})[_0x194bf4(0x193)](_0x4696cc=>{telegramError(_0x4696cc);}),tgBot['on'](_0x194bf4(0x153),async _0x2056e5=>{const _0x5917b5=_0x194bf4,_0x193dee=_0x2056e5[_0x5917b5(0x23d)],_0x33b07c=_0x2056e5[_0x5917b5(0x1d3)];tgBot[_0x5917b5(0x212)](_0x2056e5['id'])[_0x5917b5(0x19d)](async()=>{const _0x171223=_0x5917b5;if(_0x193dee==_0x171223(0x25a)){if(settings[_0x171223(0x1c7)]=='orders')tgBot[_0x171223(0x239)](_0x33b07c[_0x171223(0x22c)]['id'],_0x171223(0x1ee))['catch'](_0x248f6e=>{telegramError(_0x248f6e);});_0x58d8e0[_0x171223(0x1c8)](_0x457a33=>{const _0x787f64=_0x171223;if(_0x457a33[_0x787f64(0x1d6)]!=_0x787f64(0x25a))toggleBot(_0x457a33[_0x787f64(0x1d6)],toggleStatus(_0x457a33[_0x787f64(0x1d6)]),_0x787f64(0x17c));});}else{if(settings['telegramEvents']==_0x171223(0x146))tgBot[_0x171223(0x239)](_0x33b07c['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x193dee)[_0x171223(0x193)](_0x54bc72=>{telegramError(_0x54bc72);});toggleBot(_0x193dee,toggleStatus(_0x193dee),'stopped');}}),tgBot[_0x5917b5(0x19a)](_0x5917b5(0x153));});}}),tgBot[_0x34265f(0x133)](/\/disable/,_0x4131f4=>{const _0x349a71=_0x34265f;if(!validateTelegram(_0x4131f4))return;tgBot['sendMessage'](_0x4131f4[_0x349a71(0x22c)]['id'],_0x349a71(0x187))[_0x349a71(0x193)](_0x5d0c44=>{telegramError(_0x5d0c44);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x284fdd=>{const _0x3dac8c=_0x34265f;if(!validateTelegram(_0x284fdd))return;tgBot['sendMessage'](_0x284fdd[_0x3dac8c(0x22c)]['id'],_0x1217da)[_0x3dac8c(0x193)](_0x1dfc61=>{telegramError(_0x1dfc61);});}),tgBot['on'](_0x34265f(0x274),_0x478be5=>{const _0x27ed16=_0x34265f;_0x478be5['toString']()[_0x27ed16(0x178)]('404\x20Not\x20Found')&&(logging('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null,io['to'](_0x27ed16(0x1d9))['emit'](_0x27ed16(0x1d8),_0x27ed16(0x166)));}),process['once'](_0x34265f(0x1e5),()=>{const _0x25af8b=_0x34265f;if(tgBot)tgBot[_0x25af8b(0x144)]();process[_0x25af8b(0x139)](0x1);}),process[_0x34265f(0x252)](_0x34265f(0x1b6),()=>{const _0x5ae659=_0x34265f;if(tgBot)tgBot[_0x5ae659(0x144)]();process[_0x5ae659(0x139)](0x1);});}}function disableTelegram(){const _0x5a9cdc=_0xdef235;tgBot&&(tgBot[_0x5a9cdc(0x144)](),tgBot=null);}function sendTelegram(_0x28ddac,_0xd2574b){const _0x562fad=_0xdef235;if(settings[_0x562fad(0x24a)]){if(settings[_0x562fad(0x1c7)]==_0x562fad(0x25a)||(_0xd2574b[_0x562fad(0x1aa)]==_0x562fad(0x149)||_0xd2574b[_0x562fad(0x1aa)]==_0x562fad(0x270))&&settings[_0x562fad(0x1c7)]==_0x562fad(0x1d7)||_0xd2574b['type']==_0x562fad(0x236)&&settings[_0x562fad(0x1c7)]==_0x562fad(0x146)){if(tgBot&&settings['telegramChatId']){if(_0xd2574b[_0x562fad(0x222)])tgBot[_0x562fad(0x239)](settings[_0x562fad(0x1b2)],_0xd2574b[_0x562fad(0x15b)]+_0x562fad(0x1d4)+_0xd2574b['event'])[_0x562fad(0x193)](_0x59fb30=>{telegramError(_0x59fb30);});else tgBot[_0x562fad(0x239)](settings[_0x562fad(0x1b2)],_0x562fad(0x1cf)+_0x28ddac+_0x562fad(0x1d4)+_0xd2574b['event'])[_0x562fad(0x193)](_0x2c3b01=>{telegramError(_0x2c3b01);});}}}}function getDeviceWithIp(_0x125132){const _0xa0e52f=_0xdef235;return devices[_0xa0e52f(0x257)](_0x6570c1=>_0x6570c1['ip']===_0x125132);}function temporaryAccess2FA(_0xb64ce6,_0x248182){const _0x419de4=_0xdef235;let _0x45ae2a=new Date(),_0x16cc20=![];if(lastIpApproval){if(_0x45ae2a-lastIpApproval<0x1388)_0x16cc20=!![];}lastIpApproval=new Date();if(_0x16cc20)return;tgBot&&settings[_0x419de4(0x1b2)]&&(tgBot[_0x419de4(0x19a)](_0x419de4(0x153)),tgBot[_0x419de4(0x239)](settings['telegramChatId'],_0x419de4(0x228)+normalizeIP(_0x248182)[_0x419de4(0x237)]+_0x419de4(0x1c1),{'parse_mode':_0x419de4(0x183),'reply_markup':{'inline_keyboard':[[{'text':_0x419de4(0x167),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x419de4(0x1eb),'callback_data':'30'},{'text':_0x419de4(0x23a),'callback_data':'reject'}]]}})[_0x419de4(0x193)](_0x3809e3=>{telegramError(_0x3809e3);}),tgBot['on'](_0x419de4(0x153),async _0x1e625b=>{const _0x52ce96=_0x419de4,_0x16fc2c=_0x1e625b['data'],_0x2dfcd9=_0x1e625b[_0x52ce96(0x1d3)];tgBot[_0x52ce96(0x212)](_0x1e625b['id'])[_0x52ce96(0x19d)](async()=>{const _0x1b7b5c=_0x52ce96;devices[_0xb64ce6][_0x1b7b5c(0x1b9)]={'clientip':_0x248182,'timestamp':new Date()[_0x1b7b5c(0x1e4)](),'expiry':_0x16fc2c},_0x16fc2c!='reject'?(await tgBot[_0x1b7b5c(0x239)](_0x2dfcd9[_0x1b7b5c(0x22c)]['id'],_0x1b7b5c(0x1e2)+_0x16fc2c+_0x1b7b5c(0x25d),{'parse_mode':_0x1b7b5c(0x183)})[_0x1b7b5c(0x193)](_0x49a7db=>{telegramError(_0x49a7db);}),io['to'](_0xb64ce6)[_0x1b7b5c(0x1b7)](_0x1b7b5c(0x1ac),{'access':{'allow':![],'reason':_0x1b7b5c(0x1c6),'token':null}})):(await tgBot['sendMessage'](_0x2dfcd9[_0x1b7b5c(0x22c)]['id'],_0x1b7b5c(0x1f9))[_0x1b7b5c(0x193)](_0x431c43=>{telegramError(_0x431c43);}),io['to'](_0xb64ce6)['emit'](_0x1b7b5c(0x1ac),{'access':{'allow':![],'reason':_0x1b7b5c(0x243),'token':null}}));}),tgBot[_0x52ce96(0x19a)](_0x52ce96(0x153));}));}function loginAccess2FA(_0x157d7b,_0x62035){const _0xb0a40a=_0xdef235;tgBot&&settings[_0xb0a40a(0x1b2)]&&(tgBot[_0xb0a40a(0x19a)](_0xb0a40a(0x153)),tgBot['sendMessage'](settings[_0xb0a40a(0x1b2)],_0xb0a40a(0x1a8)+normalizeIP(_0x62035)['show']+_0xb0a40a(0x1c1),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0xb0a40a(0x23a),'callback_data':_0xb0a40a(0x23a)}]]}})[_0xb0a40a(0x193)](_0x2f1fd5=>{telegramError(_0x2f1fd5);}),tgBot['on'](_0xb0a40a(0x153),async _0x4c0cc4=>{const _0x2dca43=_0xb0a40a,_0x51cd0c=_0x4c0cc4[_0x2dca43(0x23d)],_0x180a0f=_0x4c0cc4[_0x2dca43(0x1d3)];tgBot[_0x2dca43(0x212)](_0x4c0cc4['id'])[_0x2dca43(0x19d)](async()=>{const _0x3f0f07=_0x2dca43;devices[_0x157d7b][_0x3f0f07(0x1a9)]={'clientip':_0x62035,'timestamp':new Date()['getTime'](),'expiry':_0x51cd0c},_0x51cd0c!=_0x3f0f07(0x23a)?(await tgBot['sendMessage'](_0x180a0f[_0x3f0f07(0x22c)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0x3f0f07(0x193)](_0x2a0121=>{telegramError(_0x2a0121);}),io['to'](_0x157d7b)['emit'](_0x3f0f07(0x1ac),{'access':{'allow':![],'reason':_0x3f0f07(0x1c6),'token':null}})):(await tgBot['sendMessage'](_0x180a0f['chat']['id'],'Login\x20rejected')['catch'](_0x54d28f=>{telegramError(_0x54d28f);}),io['to'](_0x157d7b)['emit'](_0x3f0f07(0x1ac),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener']('callback_query');}));}function getConfiguration(){const _0x3e695a=_0xdef235;return dbConfig['get']('bots')[_0x3e695a(0x1ad)](_0x3e695a(0x1d6))[_0x3e695a(0x14c)]()||[];}function getEnabledBots(){const _0x70de54=_0xdef235;return dbConfig[_0x70de54(0x1da)](_0x70de54(0x14f))[_0x70de54(0x1ad)]('botID')['filter']({'status':'enabled'})[_0x70de54(0x14c)]()||[];}function getDisabledBots(){const _0x158183=_0xdef235;return dbConfig[_0x158183(0x1da)](_0x158183(0x14f))['sortBy'](_0x158183(0x1d6))['filter']({'status':_0x158183(0x1e7)})['value']()||[];}function getSettings(){const _0x2e795f=_0xdef235;return dbSettings['get'](_0x2e795f(0x225))['value']()||{'timeshift':0x0};}function getSecure(){const _0x46571e=_0xdef235;return dbSecure[_0x46571e(0x1da)](_0x46571e(0x17e))[_0x46571e(0x14c)]()||{};}function getBlacklist(){const _0x50ab30=_0xdef235;return dbSecure[_0x50ab30(0x1da)](_0x50ab30(0x189))[_0x50ab30(0x14c)]()||[];}function broadcastToBots(_0x1011c2,_0x31b55b){const _0x2d8335=_0xdef235;config[_0x2d8335(0x1c8)](_0x3209e8=>{const _0xe89c13=_0x2d8335;if(_0x3209e8[_0xe89c13(0x1ac)]==_0xe89c13(0x231)&&_0x3209e8[_0xe89c13(0x202)]==_0xe89c13(0x186)){if(pid[_0x3209e8[_0xe89c13(0x1d6)]])pid[_0x3209e8[_0xe89c13(0x1d6)]][_0xe89c13(0x1c4)]({[_0x1011c2]:_0x31b55b});}});}function storeSettings(_0x1afbac,_0x4d3b31=![]){const _0x5ba710=_0xdef235;_0x1afbac={...settings,..._0x1afbac};if(_0x4d3b31&&_0x1afbac[_0x5ba710(0x206)]!=_0x5ba710(0x219)&&_0x1afbac[_0x5ba710(0x206)]!=''){const _0x4408bd=crypt[_0x5ba710(0x1c0)](secure[_0x5ba710(0x18d)],_0x1afbac[_0x5ba710(0x206)])[_0x5ba710(0x1d3)][_0x5ba710(0x142)]('@')[0x0],_0x4a6b0e=bcrypt[_0x5ba710(0x168)](_0x4408bd,saltRounds);_0x1afbac={..._0x1afbac,'bbPassword':_0x4a6b0e};}if(_0x4d3b31&&_0x1afbac[_0x5ba710(0x211)]!=_0x5ba710(0x219)&&_0x1afbac['telegramToken']!=''){const _0x393072=crypt[_0x5ba710(0x1c0)](secure[_0x5ba710(0x18d)],_0x1afbac[_0x5ba710(0x211)])[_0x5ba710(0x1d3)][_0x5ba710(0x142)]('@')[0x0];_0x1afbac={..._0x1afbac,'telegramToken':_0x393072};}const _0x12cd35=_0x1afbac[_0x5ba710(0x211)]!='************'&&_0x1afbac['telegramToken']!=settings[_0x5ba710(0x211)]||_0x1afbac['telegramUsername']!=settings[_0x5ba710(0x199)],_0x22ce85=_0x1afbac[_0x5ba710(0x211)]==''||_0x1afbac[_0x5ba710(0x199)]=='';if(_0x12cd35)_0x1afbac['telegramEvents']=_0x5ba710(0x25a);for(const [_0x177ff5,_0x287b90]of Object[_0x5ba710(0x269)](_0x1afbac)){if(_0x177ff5==_0x5ba710(0x211)&&_0x287b90==_0x5ba710(0x219)){_0x1afbac[_0x5ba710(0x211)]=settings[_0x5ba710(0x211)];continue;};if(_0x177ff5==_0x5ba710(0x206)&&_0x287b90==_0x5ba710(0x219)){_0x1afbac[_0x5ba710(0x206)]=settings[_0x5ba710(0x206)];continue;};dbSettings[_0x5ba710(0x160)](_0x5ba710(0x21a)+_0x177ff5,_0x287b90)[_0x5ba710(0x157)]();}settings=_0x1afbac,io['to'](_0x5ba710(0x1d9))[_0x5ba710(0x1b7)](_0x5ba710(0x225),cleanSettings()),broadcastToBots(_0x5ba710(0x1e8),settings[_0x5ba710(0x1e8)]);if(_0x12cd35&&!_0x22ce85)initTelegram();if(_0x12cd35&&_0x22ce85)disableTelegram();getAllClients()[_0x5ba710(0x1c8)](_0x3e5289=>{const _0x5423ce=_0x5ba710;getSocket(_0x3e5289['id'])[_0x5423ce(0x1b7)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x363d12,_0x4d5a32){const _0x406488=_0xdef235;dbSettings['set'](_0x406488(0x21a)+_0x363d12,_0x4d5a32)[_0x406488(0x157)](),settings=getSettings(),io['to'](_0x406488(0x1d9))[_0x406488(0x1b7)](_0x406488(0x225),cleanSettings());}function storeSecure(_0xfc15db){const _0xde758a=_0xdef235;dbSecure[_0xde758a(0x1da)](_0xde758a(0x17e))[_0xde758a(0x1bc)](_0xfc15db)[_0xde758a(0x157)](),secure=_0xfc15db;}function addBlacklist(_0x53dbff){const _0x3350ce=_0xdef235;cleanBlacklist();let _0x5b9b30;devices[_0x53dbff]['telegramIpApproval']?_0x5b9b30=Math[_0x3350ce(0x227)](devices[_0x53dbff][_0x3350ce(0x1b9)][_0x3350ce(0x1fa)],loginExpiry):_0x5b9b30=loginExpiry,dbSecure['get'](_0x3350ce(0x189))[_0x3350ce(0x1bc)]({'expiry':new Date()[_0x3350ce(0x1e4)]()+_0x5b9b30*0x3c*0x3e8,'token':devices[_0x53dbff][_0x3350ce(0x21d)][_0x3350ce(0x26c)]})[_0x3350ce(0x157)](),blacklist=dbSecure['get']('blacklist')[_0x3350ce(0x14c)]();}function cleanBlacklist(){const _0x1b9ce4=_0xdef235;let _0x558a1c=dbSecure['get']('blacklist')[_0x1b9ce4(0x13f)]()[_0x1b9ce4(0x14c)](),_0x5227fc=new Date()[_0x1b9ce4(0x1e4)]();_0x558a1c[_0x1b9ce4(0x1c8)](_0x5dc634=>{const _0x700615=_0x1b9ce4;_0x5dc634[_0x700615(0x1fa)]<_0x5227fc&&dbSecure['get'](_0x700615(0x189))[_0x700615(0x22d)]({'expiry':_0x5dc634[_0x700615(0x1fa)]})[_0x700615(0x157)]();});}function initStates(){const _0x2e1599=_0xdef235;let _0x23ed0a=getConfiguration();_0x23ed0a[_0x2e1599(0x1c8)](_0x1f636c=>{const _0x17af5f=_0x2e1599;_0x1f636c['live']=_0x17af5f(0x17c);}),storeConfiguration(_0x23ed0a);}function onKeys(){const _0x459ea4=new RSA();return new Promise(_0x11e945=>{const _0x48c4cf=_0x193b;_0x459ea4[_0x48c4cf(0x1f4)]()[_0x48c4cf(0x19d)](_0x5b441f=>{_0x11e945(_0x5b441f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x32167a=_0xdef235;let _0x36cece=getConfiguration(),_0x520754=![];_0x36cece[_0x32167a(0x1c8)](_0x3931c1=>{const _0x45a3d9=_0x32167a;if(_0x3931c1[_0x45a3d9(0x1ac)]==_0x45a3d9(0x186))_0x3931c1[_0x45a3d9(0x1ac)]=_0x45a3d9(0x231),_0x520754=!![];else _0x3931c1[_0x45a3d9(0x1ac)]==_0x45a3d9(0x17c)&&(_0x3931c1['status']=_0x45a3d9(0x1e7),_0x520754=!![]);});if(_0x520754)storeConfiguration(_0x36cece);let _0x1d1f45=getSecure();if(!_0x1d1f45['hasOwnProperty'](_0x32167a(0x26e))){let _0x3a167d=await generateKeys();_0x1d1f45[_0x32167a(0x1bb)]=_0x3a167d['publicKey'],_0x1d1f45[_0x32167a(0x18d)]=_0x3a167d[_0x32167a(0x18d)],_0x1d1f45['secret']=crypto[_0x32167a(0x148)](0x20)[_0x32167a(0x251)](_0x32167a(0x218));;storeSecure(_0x1d1f45);}let _0x447b19=getSettings();_0x520754=![];!_0x447b19['hasOwnProperty']('loginRequired')&&(_0x447b19[_0x32167a(0x263)]=![],_0x447b19[_0x32167a(0x14d)]='',_0x447b19[_0x32167a(0x206)]='',_0x447b19[_0x32167a(0x271)]=![],_0x520754=!![]);!_0x447b19[_0x32167a(0x253)](_0x32167a(0x25f))&&(_0x447b19[_0x32167a(0x25f)]=![],_0x447b19[_0x32167a(0x223)]=[],_0x447b19[_0x32167a(0x230)]=![],_0x520754=!![]);if(!_0x447b19[_0x32167a(0x253)](_0x32167a(0x24a))){if(_0x447b19['telegramChatId'])_0x447b19['telegramEnabled']=!![];else _0x447b19[_0x32167a(0x24a)]=![];_0x520754=!![];}if(_0x520754)storeSettings(_0x447b19);}function storeConfiguration(_0x2c31c3){const _0x1b271d=_0xdef235;dbConfig[_0x1b271d(0x1da)]('bots')[_0x1b271d(0x22d)]()[_0x1b271d(0x157)](),dbConfig[_0x1b271d(0x1da)]('bots')[_0x1b271d(0x1bc)](..._0x2c31c3)[_0x1b271d(0x157)](),config=_0x2c31c3;}function resetPassword(){const _0x4e56bd=_0xdef235;tgBot&&settings[_0x4e56bd(0x1b2)]&&(tgBot[_0x4e56bd(0x19a)](_0x4e56bd(0x153)),tgBot[_0x4e56bd(0x239)](settings['telegramChatId'],_0x4e56bd(0x1ca),{'parse_mode':_0x4e56bd(0x183),'reply_markup':{'inline_keyboard':[[{'text':_0x4e56bd(0x1f1),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4e56bd(0x193)](_0x5376e0=>{telegramError(_0x5376e0);}),tgBot['on'](_0x4e56bd(0x153),async _0x1dd980=>{const _0x71a013=_0x4e56bd,_0x1cf21b=_0x1dd980[_0x71a013(0x23d)],_0x2260e9=_0x1dd980['message'];tgBot[_0x71a013(0x212)](_0x1dd980['id'])[_0x71a013(0x19d)](async()=>{const _0x3b1393=_0x71a013;if(_0x1cf21b!='no'){const _0x2407d6=0xf,_0x1a3d8e=_0x3b1393(0x229),_0x433f20=Array[_0x3b1393(0x24e)](crypto[_0x3b1393(0x16d)](new Uint32Array(_0x2407d6)))['map'](_0x27a8ae=>_0x1a3d8e[_0x27a8ae%_0x1a3d8e['length']])[_0x3b1393(0x259)](''),_0x521a66=bcrypt[_0x3b1393(0x168)](_0x433f20,saltRounds);storeSettings({'bbPassword':_0x521a66}),await tgBot[_0x3b1393(0x239)](_0x2260e9[_0x3b1393(0x22c)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x433f20,{'parse_mode':_0x3b1393(0x183)})[_0x3b1393(0x193)](_0x205239=>{telegramError(_0x205239);});}else await tgBot[_0x3b1393(0x239)](_0x2260e9[_0x3b1393(0x22c)]['id'],'Password\x20reset\x20rejected')[_0x3b1393(0x193)](_0x52aecc=>{telegramError(_0x52aecc);});}),tgBot[_0x71a013(0x19a)](_0x71a013(0x153));}));}function logging(_0x16e20b){const _0xa31045=_0xdef235;console[_0xa31045(0x1ab)](getTimeStamp()+_0xa31045(0x207)+_0x16e20b);if(tgBot&&settings['telegramChatId']&&settings[_0xa31045(0x1c7)]!=_0xa31045(0x146))tgBot[_0xa31045(0x239)](settings[_0xa31045(0x1b2)],_0xa31045(0x15d)+_0x16e20b)[_0xa31045(0x193)](_0x3a5e9d=>{telegramError(_0x3a5e9d);});}function getServerTime(){const _0x1df5b6=_0xdef235,_0x220780=new Date();return _0x220780[_0x1df5b6(0x1f3)]()+'/'+(_0x220780['getMonth']()+0x1)[_0x1df5b6(0x251)]()['padStart'](0x2,'0')+'/'+_0x220780['getDate']()[_0x1df5b6(0x251)]()['padStart'](0x2,'0')+'\x20'+_0x220780[_0x1df5b6(0x1fe)]()[_0x1df5b6(0x251)]()['padStart'](0x2,'0')+':'+_0x220780[_0x1df5b6(0x185)]()[_0x1df5b6(0x251)]()[_0x1df5b6(0x195)](0x2,'0')+':'+_0x220780['getSeconds']()[_0x1df5b6(0x251)]()[_0x1df5b6(0x195)](0x2,'0');}function getTimeStamp(){const _0x68f313=_0xdef235,_0x588564=shiftedTime();return _0x588564[_0x68f313(0x1f3)]()+'/'+(_0x588564[_0x68f313(0x140)]()+0x1)[_0x68f313(0x251)]()[_0x68f313(0x195)](0x2,'0')+'/'+_0x588564[_0x68f313(0x164)]()[_0x68f313(0x251)]()[_0x68f313(0x195)](0x2,'0')+'\x20'+_0x588564[_0x68f313(0x1fe)]()['toString']()[_0x68f313(0x195)](0x2,'0')+':'+_0x588564[_0x68f313(0x185)]()[_0x68f313(0x251)]()[_0x68f313(0x195)](0x2,'0')+':'+_0x588564['getSeconds']()[_0x68f313(0x251)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x3ff047=_0xdef235,_0x1c9000=new Date();let _0x30b0c9=_0x1c9000;if(settings[_0x3ff047(0x1e8)]&&settings[_0x3ff047(0x1e8)]!==0x0)_0x30b0c9=fns[_0x3ff047(0x204)](_0x1c9000,{'hours':settings['timeshift']});return _0x30b0c9;}function startScheduler(){let _0x55ce70=new Date()['getUTCHours']();_0x55ce70==0x1&&backupConfigFiles();_0x55ce70==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x1494f8=_0xdef235;fs[_0x1494f8(0x220)](configpath,{'withFileTypes':!![]})[_0x1494f8(0x1c8)](_0x55491c=>{const _0x32f6dc=_0x1494f8;if(!_0x55491c[_0x32f6dc(0x18f)]())fs['copyFileSync'](configpath+_0x55491c[_0x32f6dc(0x14a)],configbackuppath+_0x55491c['name']);});}function triggerAnalytics(){const _0x2068a4=_0xdef235;analytics['page']({'title':_0x2068a4(0x135),'href':_0x2068a4(0x176),'path':'/v'+serverversion});}function validateCredentials(_0x461d06,_0x3258c1){const _0x7e0cbe=_0xdef235;if(_0x461d06[_0x7e0cbe(0x1a3)]==settings['bbUsername']&&bcrypt[_0x7e0cbe(0x1f6)](_0x461d06[_0x7e0cbe(0x258)],settings[_0x7e0cbe(0x206)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x23b9d7=generateLoginToken(_0x3258c1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x23b9d7};}}else return{'allow':![],'reason':_0x7e0cbe(0x21e),'token':null};}function refreshToken(_0x14bc01){const _0x4c5e88=_0xdef235,_0x13c116=generateLoginToken(_0x14bc01);return{'allow':!![],'reason':_0x4c5e88(0x137),'token':_0x13c116};}function validateAccess(_0x257145,_0x4b6f1e){const _0x1b6895=_0xdef235;let _0x3a2bbc=devices[_0x4b6f1e]['ip'],_0x559f1c;const _0x858f6c=_0x39b9f8=>{const _0x2e5341=_0x193b;if(settings[_0x2e5341(0x263)]){if(settings[_0x2e5341(0x271)]){if(telegram2FaApproved(_0x4b6f1e)){const _0x377e75=generateLoginToken(_0x4b6f1e);return{'allow':!![],'reason':_0x2e5341(0x264),'token':_0x377e75};}else return{'allow':![],'reason':_0x2e5341(0x20c),'token':null};}else return _0x559f1c=validToken(_0x39b9f8,_0x4b6f1e),_0x559f1c['hasOwnProperty']('success')?{'allow':!![],'reason':_0x2e5341(0x1de),'token':_0x39b9f8}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x2e5341(0x261),'token':null};};if(settings[_0x1b6895(0x25f)]){let _0x58094d=[...settings[_0x1b6895(0x223)],'::1',_0x1b6895(0x246),_0x1b6895(0x235)];if(_0x58094d[_0x1b6895(0x178)](_0x3a2bbc))return _0x858f6c(_0x257145);else{_0x559f1c=validToken(_0x257145,_0x4b6f1e);if(_0x559f1c['hasOwnProperty']('success'))return _0x858f6c(_0x257145);else{if(telegramIpApproved(_0x4b6f1e)){const _0x47a9a2=generateToken(_0x4b6f1e);return _0x559f1c=_0x858f6c(_0x257145),_0x559f1c[_0x1b6895(0x1dd)]?{'allow':!![],'reason':_0x1b6895(0x198),'token':_0x47a9a2}:_0x559f1c;}else return settings[_0x1b6895(0x230)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x1b6895(0x155),'token':null};}}}else return _0x858f6c(_0x257145);}function timelyDecrypt(_0xf6aec6,_0xad5f5d=!![]){const _0x1a7692=_0xdef235;if(_0xf6aec6)try{const _0x482954=crypt[_0x1a7692(0x1c0)](secure[_0x1a7692(0x18d)],_0xf6aec6)[_0x1a7692(0x1d3)],_0x43fcd8=_0x482954[_0x1a7692(0x142)]('@')[0x0],_0x3138cd=_0x482954['split']('@')[0x1],_0x528223=new Date()[_0x1a7692(0x1e4)]();if(_0xad5f5d){if(_0x528223-_0x3138cd<maxSecretAge*0x3e8)return _0x43fcd8;else return![];}else return _0x43fcd8;}catch(_0x3a5375){return![];}else return![];}const validToken=(_0x5925bd,_0x48d0a0)=>{const _0x555f90=_0xdef235,_0xe01012=devices[_0x48d0a0]['ip'];if(!_0x5925bd)return{'error':_0x555f90(0x256)};for(let _0x111ccb of blacklist){if(_0x111ccb[_0x555f90(0x26c)]==_0x5925bd)return{'error':'Token\x20blacklisted'};}let _0x387e00;try{_0x387e00=jwt[_0x555f90(0x132)](_0x5925bd,secure[_0x555f90(0x26e)]+_0x48d0a0);}catch{return{'error':_0x555f90(0x1bf)};}if(!_0x387e00[_0x555f90(0x253)](_0x555f90(0x19f))&&!_0x387e00[_0x555f90(0x253)](_0x555f90(0x1a3))||!_0x387e00['hasOwnProperty']('exp'))return{'error':_0x555f90(0x24d)};if(!_0x387e00[_0x555f90(0x253)]('username')&&_0x387e00['hasOwnProperty'](_0x555f90(0x19f))){const {clientip:_0x182b69}=_0x387e00;return _0xe01012==_0x182b69?{'success':_0x555f90(0x15c)}:{'error':_0x555f90(0x248)};}else{if(_0x387e00[_0x555f90(0x253)](_0x555f90(0x1a3))&&_0x387e00[_0x555f90(0x253)](_0x555f90(0x19f))){const {username:_0x37ba79,clientip:_0x350f2d}=_0x387e00;return settings['bbUsername']==_0x37ba79&&_0xe01012==_0x350f2d?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x555f90(0x16f)};}}},generateLoginToken=_0x865b0=>{const _0x3aa041=_0xdef235;if(_0x865b0){const _0xb20372=devices[_0x865b0]['ip'];return jwt[_0x3aa041(0x201)]({'username':settings['bbUsername'],'clientip':_0xb20372},secure[_0x3aa041(0x26e)]+_0x865b0,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x723d68=>{const _0x133e67=_0xdef235;if(_0x723d68){const _0x1a50a4=devices[_0x723d68]['ip'];return jwt['sign']({'clientip':_0x1a50a4},secure[_0x133e67(0x26e)]+_0x723d68,{'expiresIn':devices[_0x723d68][_0x133e67(0x1b9)][_0x133e67(0x1fa)]*0x3c});}else return![];},telegramIpApproved=_0x5d7389=>{const _0x4f5d47=_0xdef235;let _0xe92a48=![];return devices[_0x5d7389][_0x4f5d47(0x1b9)]&&devices[_0x5d7389][_0x4f5d47(0x1b9)][_0x4f5d47(0x1fa)]!=_0x4f5d47(0x23a)&&(_0xe92a48=devices[_0x5d7389][_0x4f5d47(0x1b9)][_0x4f5d47(0x19f)]==devices[_0x5d7389]['ip']&&new Date()[_0x4f5d47(0x1e4)]()-devices[_0x5d7389][_0x4f5d47(0x1b9)][_0x4f5d47(0x23f)]<devices[_0x5d7389][_0x4f5d47(0x1b9)][_0x4f5d47(0x1fa)]*0x3c*0x3e8),_0xe92a48;},telegram2FaApproved=_0x3f05f5=>{const _0x2bdf07=_0xdef235;let _0x23478f=![];return devices[_0x3f05f5][_0x2bdf07(0x1a9)]&&devices[_0x3f05f5]['telegram2FaApproval']['expiry']!=_0x2bdf07(0x23a)&&(_0x23478f=devices[_0x3f05f5]['telegram2FaApproval'][_0x2bdf07(0x19f)]==devices[_0x3f05f5]['ip']&&new Date()['getTime']()-devices[_0x3f05f5]['telegram2FaApproval'][_0x2bdf07(0x23f)]<devices[_0x3f05f5][_0x2bdf07(0x1a9)][_0x2bdf07(0x1fa)]*0x3c*0x3e8),_0x23478f;},normalizeIP=_0x1c8d99=>{const _0x1841d6=_0xdef235;let _0x30c04a=null,_0x33169f=null;if(ipaddr[_0x1841d6(0x13b)](_0x1c8d99)){const _0x3da9df=ipaddr['parse'](_0x1c8d99);_0x3da9df[_0x1841d6(0x1d2)]()==='ipv6'?(_0x3da9df[_0x1841d6(0x238)]()&&(_0x30c04a=_0x3da9df[_0x1841d6(0x210)]()[_0x1841d6(0x251)]()),_0x33169f=_0x3da9df[_0x1841d6(0x251)]()):(_0x30c04a=_0x3da9df['toString'](),_0x33169f=_0x3da9df['toIPv4MappedAddress']()[_0x1841d6(0x251)]());}return{'show':_0x30c04a?_0x30c04a:_0x33169f,'store':_0x33169f};};