const _0x34d593=_0x2ebb;(function(_0x55e20d,_0x38353a){const _0x32300c=_0x2ebb,_0x469caf=_0x55e20d();while(!![]){try{const _0x47b780=parseInt(_0x32300c(0x39f))/0x1+parseInt(_0x32300c(0x313))/0x2+parseInt(_0x32300c(0x230))/0x3+parseInt(_0x32300c(0x2c8))/0x4*(parseInt(_0x32300c(0x350))/0x5)+-parseInt(_0x32300c(0x35f))/0x6*(-parseInt(_0x32300c(0x2f2))/0x7)+parseInt(_0x32300c(0x3c1))/0x8*(-parseInt(_0x32300c(0x26e))/0x9)+parseInt(_0x32300c(0x3a7))/0xa*(-parseInt(_0x32300c(0x275))/0xb);if(_0x47b780===_0x38353a)break;else _0x469caf['push'](_0x469caf['shift']());}catch(_0x14bd91){_0x469caf['push'](_0x469caf['shift']());}}}(_0x10c2,0xe17e5));const _0xd42cf8=function(){let _0x17d185=!![];return function(_0xfa4bc4,_0x1ecef9){const _0x135b68=_0x17d185?function(){const _0x573531=_0x2ebb;if(_0x1ecef9){const _0x5b9a07=_0x1ecef9[_0x573531(0x21c)](_0xfa4bc4,arguments);return _0x1ecef9=null,_0x5b9a07;}}:function(){};return _0x17d185=![],_0x135b68;};}(),_0xefc510=_0xd42cf8(this,function(){const _0x34c1ef=_0x2ebb;return _0xefc510[_0x34c1ef(0x3a1)]()[_0x34c1ef(0x348)](_0x34c1ef(0x24c))['toString']()['constructor'](_0xefc510)[_0x34c1ef(0x348)](_0x34c1ef(0x24c));});_0xefc510();'use strict';process['env'][_0x34d593(0x200)]=0x1;const childProcess=require(_0x34d593(0x26a)),fs=require('fs'),fns=require(_0x34d593(0x38f)),low=require(_0x34d593(0x30b)),FileSync=require(_0x34d593(0x28e)),path=require(_0x34d593(0x269)),crypto=require(_0x34d593(0x24a)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x34d593(0x2ea))[_0x34d593(0x321)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x34d593(0x3ae)),argv=require(_0x34d593(0x218))(process[_0x34d593(0x389)][_0x34d593(0x258)](0x2))[_0x34d593(0x389)],uuidRandom=require(_0x34d593(0x2fa)),{Telegraf,Markup}=require(_0x34d593(0x35c)),Mixpanel=require(_0x34d593(0x303)),axios=require(_0x34d593(0x2aa)),{GraphQLClient,gql}=require(_0x34d593(0x352)),util=require(_0x34d593(0x205)),fileUpload=require(_0x34d593(0x217)),{networkInterfaces}=require('os'),PORT=argv[_0x34d593(0x237)]||_0x34d593(0x233),pattern=/^[0-9]{2,4}$/;!pattern[_0x34d593(0x3f1)](PORT)&&(console['log'](_0x34d593(0x2df)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x34d593(0x2f3)]||null,userID=argv[_0x34d593(0x2a7)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x34d593(0x353)];let bbpath='bb/',bbpath2='';const botfile=_0x34d593(0x263),configfile=_0x34d593(0x30f),settingsfile=_0x34d593(0x399),securefile=_0x34d593(0x319),environment=require('./'+bbpath2+_0x34d593(0x288))['environment']||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x34d593(0x2e4)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x34d593(0x32c)),configpath=userID?bbpath+_0x34d593(0x37d)+userID+'/':bbpath+_0x34d593(0x37d),configbackuppath=configpath+_0x34d593(0x2c6),logspath=userID?bbpath+_0x34d593(0x298)+userID+'/':bbpath+_0x34d593(0x298),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x34d593(0x342),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x34d593(0x224)+userID+'/':bbpath+_0x34d593(0x224);!fs[_0x34d593(0x2e4)](configpath)&&fs[_0x34d593(0x20b)](configpath);!fs[_0x34d593(0x2e4)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x34d593(0x2e4)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x34d593(0x2e4)](zippath)&&fs[_0x34d593(0x20b)](zippath);!fs[_0x34d593(0x2e4)](temppath)&&fs[_0x34d593(0x20b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x34d593(0x3ce)]({'bots':[]})[_0x34d593(0x285)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x34d593(0x3ce)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x34d593(0x293),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x34d593(0x3ce)]({'secure':{},'blacklist':[]})[_0x34d593(0x285)]();let crypt=new Crypt({'md':_0x34d593(0x2b6),'rsaStandard':_0x34d593(0x2c3)});const saltRounds=0xa,mixpanel=Mixpanel[_0x34d593(0x2a1)](_0x34d593(0x26c),{'host':_0x34d593(0x3d7)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x34d593(0x28b)]!=''&&settings[_0x34d593(0x28b)]!=_0x34d593(0x3e9))&&settings[_0x34d593(0x372)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x1cb4d3,_0x46112f)=>{const _0x388ddd=_0x34d593,_0x2749cf=/#[A-Z]{3}#/g;if(typeof _0x1cb4d3=='string'){!_0x46112f?_0x1cb4d3=_0x1cb4d3[_0x388ddd(0x2c1)](_0x2749cf,''):(_0x1cb4d3=_0x1cb4d3['replace'](/#BLU#/g,'\x1b[34m'),_0x1cb4d3=_0x1cb4d3['replace'](/#RED#/g,_0x388ddd(0x3db)),_0x1cb4d3=_0x1cb4d3[_0x388ddd(0x2c1)](/#YEL#/g,_0x388ddd(0x314)),_0x1cb4d3=_0x1cb4d3[_0x388ddd(0x2c1)](/#MAG#/g,_0x388ddd(0x3ab)),_0x1cb4d3=_0x1cb4d3[_0x388ddd(0x2c1)](/#CYA#/g,_0x388ddd(0x235)),_0x1cb4d3=_0x1cb4d3[_0x388ddd(0x2c1)](/#RES#/g,_0x388ddd(0x28d)));;}return _0x1cb4d3;},logger={'screen':_0x4083ee=>{const _0x9550e1=_0x34d593;console[_0x9550e1(0x227)](parseColor(_0x4083ee,!![]));},'simple':_0xfc2376=>{const _0x2e29bc=_0x34d593;console['log'](parseColor(_0xfc2376,!![])),loggerfile[_0x2e29bc(0x285)](util['format'](parseColor(_0xfc2376,![]))+'\x0a');},'full':async _0x13c587=>{const _0x400ccd=_0x34d593,_0x4be693=getTimeStamp()+_0x400ccd(0x383)+_0x13c587;console[_0x400ccd(0x227)](parseColor(_0x4be693,!![])),loggerfile[_0x400ccd(0x285)](util[_0x400ccd(0x3d5)](parseColor(_0x4be693,![]))+'\x0a');if(tgBot&&settings[_0x400ccd(0x23a)]&&settings[_0x400ccd(0x391)]!=_0x400ccd(0x3b4))await sendTelegram(settings[_0x400ccd(0x23a)],_0x400ccd(0x394)+parseColor(_0x13c587,![]));},'debug':async(_0xbce662,_0x1faffa='')=>{const _0x3da6d8=_0x34d593,_0x3a36b6=getTimeStamp()+_0x3da6d8(0x38c)+_0xbce662;if(debugging)console[_0x3da6d8(0x227)](parseColor(_0x3a36b6,!![]));loggerfile[_0x3da6d8(0x285)](util[_0x3da6d8(0x3d5)](parseColor(_0x3a36b6,![]))+'\x0a');if(_0x1faffa){if(debugging)console[_0x3da6d8(0x227)](_0x1faffa);loggerfile['write'](util[_0x3da6d8(0x3d5)](_0x1faffa)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x38a48b){const _0x314661=_0x34d593;_0x38a48b[_0x314661(0x3a1)]()['includes'](_0x314661(0x3ca))?(logger['simple'](_0x314661(0x35d)+_0x38a48b['port']+'#RES#'),process[_0x314661(0x2d4)]({'terminate':!![]},_0x4562f8=>{})):logger[_0x314661(0x2eb)](_0x38a48b);}),process['on'](_0x34d593(0x375),()=>{const _0x229a1f=_0x34d593;stopAllBots(),process[_0x229a1f(0x375)](0x0);}),process['on'](_0x34d593(0x38e),()=>{const _0x16fa58=_0x34d593;stopAllBots(),process[_0x16fa58(0x375)](0x0);}),process['on'](_0x34d593(0x20d),()=>{const _0x20b64b=_0x34d593;stopAllBots(),process[_0x20b64b(0x375)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x34d593(0x288))[_0x34d593(0x335)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x34d593(0x3e6))[_0x34d593(0x3e5)](app);app[_0x34d593(0x254)](fileUpload({'useTempFiles':!![]})),app['get'](_0x34d593(0x2cb),async(_0x1b3b87,_0x2f78e7)=>{const _0x5493ab=_0x34d593,_0x25fe82=_0x1b3b87[_0x5493ab(0x3ba)][_0x5493ab(0x3c5)],_0x441dfb=getClientsWithBotID('botmanager'),_0x74b74c=_0x1b3b87[_0x5493ab(0x2b3)][_0x5493ab(0x28a)],_0x74ef80=timelyDecrypt(_0x74b74c,![]),_0x145ea7=_0x441dfb[_0x5493ab(0x2c0)](_0xbd5711=>_0xbd5711[_0x5493ab(0x28a)]==_0x74ef80);if(_0x145ea7){const _0x4fd440=normalizeIP(_0x1b3b87[_0x5493ab(0x3be)][_0x5493ab(0x241)])[_0x5493ab(0x32f)],_0x2b1c53=_0x1b3b87[_0x5493ab(0x2b3)][_0x5493ab(0x2bf)];if(validateAccess(_0x2b1c53,_0x74ef80,_0x4fd440)[_0x5493ab(0x302)])_0x25fe82==_0x5493ab(0x2fc)&&await backupConfigFiles(),await zipFiles(_0x25fe82),_0x2f78e7['download'](zippath+(_0x25fe82+_0x5493ab(0x2fe)),_0x22a2a4=>{const _0x46371b=_0x5493ab;_0x22a2a4&&(logger[_0x46371b(0x23e)](_0x46371b(0x253)+_0x25fe82),logger[_0x46371b(0x2eb)](_0x22a2a4));});else logger[_0x5493ab(0x23e)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x25fe82+_0x5493ab(0x309));}else logger[_0x5493ab(0x23e)](_0x5493ab(0x3f6)+_0x25fe82+_0x5493ab(0x222));}),app[_0x34d593(0x300)](_0x34d593(0x2b5),async(_0x39af1a,_0x5cb1dc)=>{const _0x10820b=_0x34d593,_0x4a27cc=getClientsWithBotID('botmanager'),_0x1af816=_0x39af1a[_0x10820b(0x2b3)][_0x10820b(0x28a)],_0xadf949=timelyDecrypt(_0x1af816,![]),_0x15a18c=_0x4a27cc[_0x10820b(0x2c0)](_0x3f410f=>_0x3f410f[_0x10820b(0x28a)]==_0xadf949);logger['debug'](_0x10820b(0x37c));if(_0x15a18c){const _0x2ac534=normalizeIP(_0x39af1a[_0x10820b(0x3be)]['remoteAddress'])[_0x10820b(0x32f)],_0x38d103=_0x39af1a[_0x10820b(0x2b3)][_0x10820b(0x2bf)];if(validateAccess(_0x38d103,_0xadf949,_0x2ac534)['allow']){if(_0x39af1a[_0x10820b(0x29c)]){const _0x5655c2=_0x39af1a[_0x10820b(0x29c)][_0x10820b(0x281)];await _0x5655c2['mv'](temppath+_0x5655c2[_0x10820b(0x36a)]),_0x5cb1dc[_0x10820b(0x2d4)]({'status':!![],'message':_0x10820b(0x326)});const _0x2f8263=getBotsWithMode();_0x2f8263[_0x10820b(0x27c)]>0x0?confirmRestore(temppath,_0x5655c2[_0x10820b(0x36a)]):unzipFile(temppath,_0x5655c2[_0x10820b(0x36a)]);}}else logger[_0x10820b(0x23e)](_0x10820b(0x3b5));}else logger['full'](_0x10820b(0x212));}),app[_0x34d593(0x254)](express[_0x34d593(0x2ca)](path['join'](__dirname,bbpath2,'build2'))),app[_0x34d593(0x254)](express[_0x34d593(0x2ca)](path[_0x34d593(0x286)](__dirname,bbpath2,_0x34d593(0x208)))),app[_0x34d593(0x271)]('/',function(_0x135f45,_0x2e4230){const _0x1bc746=_0x34d593;_0x2e4230[_0x1bc746(0x246)](path['join'](__dirname,bbpath2,'build2','index.html'));}),app[_0x34d593(0x271)](_0x34d593(0x3b1),function(_0x1b834c,_0xaa930a){const _0x247cc4=_0x34d593;_0xaa930a['sendFile'](path[_0x247cc4(0x286)](__dirname,bbpath2,_0x247cc4(0x208),_0x247cc4(0x244)));}),app[_0x34d593(0x271)](_0x34d593(0x3aa),(_0x3134f6,_0x338414)=>{const _0x136daa=_0x34d593;_0x338414[_0x136daa(0x246)](path['join'](__dirname,bbpath2,_0x136daa(0x208),'index.html'));}),app['get'](_0x34d593(0x392),(_0x2cd23c,_0x207f8b)=>{const _0x562c28=_0x34d593;_0x207f8b[_0x562c28(0x246)](path[_0x562c28(0x286)](__dirname,bbpath2,_0x562c28(0x208),'index.html'));}),app[_0x34d593(0x271)](_0x34d593(0x2f1),(_0x11cfd2,_0xa7abcf)=>{const _0x7fffef=_0x34d593;_0xa7abcf[_0x7fffef(0x246)](path[_0x7fffef(0x286)](__dirname,bbpath2,_0x7fffef(0x208),'index.html'));}),app[_0x34d593(0x271)]('/:bot/history',(_0x53dce6,_0xaae7e5)=>{const _0x1fb1a8=_0x34d593;_0xaae7e5['sendFile'](path[_0x1fb1a8(0x286)](__dirname,bbpath2,'build','index.html'));}),app[_0x34d593(0x271)](_0x34d593(0x385),(_0x18574e,_0x367807)=>{const _0x496c60=_0x34d593;_0x367807[_0x496c60(0x246)](path['join'](__dirname,bbpath2,_0x496c60(0x208),_0x496c60(0x244)));}),app['get']('/:bot/support',(_0x7e1f06,_0x4ec575)=>{const _0x2f8212=_0x34d593;_0x4ec575['sendFile'](path[_0x2f8212(0x286)](__dirname,bbpath2,_0x2f8212(0x208),'index.html'));});if(HOST)http[_0x34d593(0x23d)](PORT,HOST);else http[_0x34d593(0x23d)](PORT);function _0x2ebb(_0x2c86f6,_0x4846e0){const _0x11d5a9=_0x10c2();return _0x2ebb=function(_0xefc510,_0xd42cf8){_0xefc510=_0xefc510-0x1f3;let _0x10c20f=_0x11d5a9[_0xefc510];return _0x10c20f;},_0x2ebb(_0x2c86f6,_0x4846e0);}const io=require(_0x34d593(0x219))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1502dd=_0x34d593;let _0x22d319=_0x1502dd(0x3b8);const _0x159b4f=networkInterfaces(),_0x3c62f0={};for(const _0x5e670b of Object['keys'](_0x159b4f)){for(const _0x185a0e of _0x159b4f[_0x5e670b]){if((_0x185a0e[_0x1502dd(0x1fc)]=='IPv4'||_0x185a0e[_0x1502dd(0x1fc)]==0x4)&&!_0x185a0e[_0x1502dd(0x2ed)]){const _0x17616f=ipaddr[_0x1502dd(0x22a)](_0x185a0e['address'])[_0x1502dd(0x295)]();_0x17616f!='private'&&(!_0x3c62f0[_0x5e670b]&&(_0x3c62f0[_0x5e670b]=[]),_0x3c62f0[_0x5e670b][_0x1502dd(0x2d1)](_0x185a0e[_0x1502dd(0x359)]),_0x22d319=_0x185a0e[_0x1502dd(0x359)]);}}}return{'serverip':_0x22d319,'netinterfaces':_0x3c62f0};}async function startServer(){const _0x4bc2a8=_0x34d593,{serverip:_0x3895dc,netinterfaces:_0x3a7d49}=getServerIP();logger['simple'](''),logger[_0x4bc2a8(0x2eb)](_0x4bc2a8(0x32e)),await logger[_0x4bc2a8(0x23e)](_0x4bc2a8(0x3e7)+serverversion+'#RES#\x20'+(environment==_0x4bc2a8(0x330)?_0x4bc2a8(0x261):'')+'\x0a'+(_0x4bc2a8(0x21d)+PORT+_0x4bc2a8(0x262))+('=>\x20Go\x20to\x20#CYA#http://'+_0x3895dc+':'+PORT+_0x4bc2a8(0x318))),logger['simple'](_0x4bc2a8(0x32e));if(config[_0x4bc2a8(0x27c)]!=0x0)for(const _0x5de888 of config){const _0x446f72=_0x5de888['mode']==_0x4bc2a8(0x231)?'a':'m';if(_0x5de888['status']==_0x4bc2a8(0x3bc)||_0x5de888[_0x4bc2a8(0x2c9)]==_0x4bc2a8(0x270))await logger['full'](_0x4bc2a8(0x24f)+_0x446f72+')\x20|\x20Bot\x20'+_0x5de888['botID']+'\x20|\x20'+_0x5de888[_0x4bc2a8(0x2a9)]),startBot([_0x5de888[_0x4bc2a8(0x379)],userID],{'cwd':bbpath},function(_0x489ee6){const _0x37bfa9=_0x4bc2a8;if(_0x489ee6)logger[_0x37bfa9(0x23e)](_0x489ee6);});else(_0x5de888['status']==_0x4bc2a8(0x204)||_0x5de888[_0x4bc2a8(0x2c9)]==_0x4bc2a8(0x307))&&await logger[_0x4bc2a8(0x23e)]('Idling\x20('+_0x446f72+_0x4bc2a8(0x334)+_0x5de888['botID']+_0x4bc2a8(0x33b)+_0x5de888[_0x4bc2a8(0x2a9)]);}else!newBot&&logger[_0x4bc2a8(0x2eb)](_0x4bc2a8(0x25e));if(newBot)addBot();logger[_0x4bc2a8(0x2eb)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x4bc2a8(0x2e2)]('Node.js\x20v'+nodeversion),await logger[_0x4bc2a8(0x2e2)](_0x4bc2a8(0x26b),_0x3a7d49);}function startSocket(){const _0x465424=_0x34d593;io['on'](_0x465424(0x210),_0x2b55a5=>{const _0x56ca69=_0x465424;let _0x1f4e2c,_0x46c365,_0x4b08d4,_0xdecff4,_0x506069;const _0x199d41=_0x2b55a5['handshake']['headers'][_0x56ca69(0x28f)];_0x46c365=_0x199d41[_0x56ca69(0x30c)](/bot[0-9]{3}/);if(_0x46c365)_0x4b08d4=_0x46c365[0x0][_0x56ca69(0x30c)](/[0-9]{3}/);if(_0x4b08d4)_0x1f4e2c=_0x4b08d4[0x0];else _0x1f4e2c=_0x56ca69(0x282);const _0x159643=_0x2b55a5[_0x56ca69(0x238)][_0x56ca69(0x315)][_0x56ca69(0x2f7)];if(!_0x159643)_0x2b55a5[_0x56ca69(0x2db)](_0x56ca69(0x2c9),{'publicKey':secure[_0x56ca69(0x337)]});else{_0xdecff4=timelyDecrypt(_0x159643,![]);if(!_0xdecff4)_0x2b55a5[_0x56ca69(0x2db)](_0x56ca69(0x2c9),{'publicKey':secure[_0x56ca69(0x337)]});else{_0x506069=normalizeIP(_0x2b55a5[_0x56ca69(0x25a)][_0x56ca69(0x241)])[_0x56ca69(0x32f)];if(!devices[_0xdecff4])devices[_0xdecff4]={'uuid':_0xdecff4,'access':{'token':null}};devices[_0xdecff4]['ip']=_0x506069;const _0x418708=addClient(_0x2b55a5['id'],_0xdecff4,_0x1f4e2c);setAccess(_0x418708),emitMessages(),_0x2b55a5['on'](_0x56ca69(0x36b),_0x38975d=>{const _0x135143=_0x56ca69,_0x43c50a=timelyDecrypt(_0x38975d[_0x135143(0x3ef)],!![],'|@|');if(_0x43c50a){_0x38975d={'username':_0x38975d['username'],'password':_0x43c50a},devices[_0xdecff4][_0x135143(0x34c)]=validateCredentials(_0x38975d,_0xdecff4);if(devices[_0xdecff4]['access'][_0x135143(0x302)]==![]&&devices[_0xdecff4]['access'][_0x135143(0x3d6)]==_0x135143(0x393))_0x2b55a5['emit'](_0x135143(0x2c9),{'access':devices[_0xdecff4]['access']}),loginAccess2FA(_0xdecff4,_0x506069);else{if(devices[_0xdecff4][_0x135143(0x34c)][_0x135143(0x302)]==![]&&devices[_0xdecff4][_0x135143(0x34c)]['reason']=='invalid\x20credentials')_0x2b55a5[_0x135143(0x2db)](_0x135143(0x2c9),{'access':devices[_0xdecff4][_0x135143(0x34c)]});else devices[_0xdecff4][_0x135143(0x34c)][_0x135143(0x302)]&&devices[_0xdecff4]['access'][_0x135143(0x3d6)]==_0x135143(0x2e0)&&(getClientsWithUuid(_0xdecff4)[_0x135143(0x2ba)](_0x371493=>{setAccess(_0x371493);}),logger[_0x135143(0x2e2)](_0x135143(0x366)+_0xdecff4[_0x135143(0x258)](-0x8)),setTokenRefresh(_0xdecff4),setSessionTimeout(_0x135143(0x36b),_0xdecff4));}}else logger[_0x135143(0x23e)](_0x135143(0x277));}),_0x2b55a5['on'](_0x56ca69(0x274),()=>{resetPassword();}),_0x2b55a5['on'](_0x56ca69(0x272),_0x4b0401=>{removeClient(_0x2b55a5['id']);}),_0x1f4e2c==_0x56ca69(0x282)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x7cd638){const _0x53a62f=_0x34d593;if(_0x7cd638!=_0x53a62f(0x282)&&config[_0x53a62f(0x3bd)]!=''){if(pid[_0x7cd638])pid[_0x7cd638]['send']({'function':_0x53a62f(0x3ed),'args':null});}_0x7cd638!=_0x53a62f(0x282)&&broadcastToBots(_0x53a62f(0x27e),JSON[_0x53a62f(0x3f3)](config));}function reloadBotManager(){const _0x6e98b8=_0x34d593;getClientsWithBotID(_0x6e98b8(0x282))[_0x6e98b8(0x2ba)](_0x3d2614=>{const _0x4a60b9=_0x6e98b8;getSocket(_0x3d2614['id'])[_0x4a60b9(0x2db)](_0x4a60b9(0x2c9),{'access':{'allow':![],'reason':_0x4a60b9(0x2b4),'token':null}});});}function getSocket(_0x18bcbf){const _0x3a41ae=_0x34d593;return io[_0x3a41ae(0x229)]['sockets'][_0x3a41ae(0x271)](_0x18bcbf);}function setAccess(_0x342028){const _0x47ec49=_0x34d593,_0x485abe=getSocket(_0x342028['id']),_0x1d53a4=_0x342028[_0x47ec49(0x28a)],_0x48dc64=_0x342028[_0x47ec49(0x299)];devices[_0x1d53a4][_0x47ec49(0x34c)]=validateAccess(devices[_0x1d53a4][_0x47ec49(0x34c)][_0x47ec49(0x2de)],_0x1d53a4),logger[_0x47ec49(0x2e2)](_0x47ec49(0x2f9)+devices[_0x1d53a4][_0x47ec49(0x34c)][_0x47ec49(0x3d6)]+_0x47ec49(0x3f2)+_0x342028['id'][_0x47ec49(0x258)](-0x8)+_0x47ec49(0x349)+_0x1d53a4[_0x47ec49(0x258)](-0x8)),_0x485abe[_0x47ec49(0x286)](_0x1d53a4);if(devices[_0x1d53a4][_0x47ec49(0x34c)]['allow']){_0x485abe['join'](_0x48dc64);if(_0x48dc64==_0x47ec49(0x282))initializeSocketBotManager(_0x485abe);else initializeSocketBot(_0x485abe);initClient(_0x48dc64);}devices[_0x1d53a4]['access'][_0x47ec49(0x2de)]&&devices[_0x1d53a4][_0x47ec49(0x34c)][_0x47ec49(0x3d6)]==_0x47ec49(0x25f)&&setSessionTimeout(_0x47ec49(0x381),_0x1d53a4),devices[_0x1d53a4][_0x47ec49(0x34c)][_0x47ec49(0x2de)]&&devices[_0x1d53a4]['access'][_0x47ec49(0x3d6)]==_0x47ec49(0x3d0)&&setSessionTimeout(_0x47ec49(0x36b),_0x1d53a4),_0x485abe[_0x47ec49(0x2db)]('status',{'status':_0x342028[_0x47ec49(0x37f)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1d53a4]['access'],'externalip':devices[_0x1d53a4]['ip'],'publicKey':secure[_0x47ec49(0x337)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x1d53a4]['access'][_0x47ec49(0x302)]==![]&&devices[_0x1d53a4][_0x47ec49(0x34c)]['reason']==_0x47ec49(0x33c)&&temporaryAccess2FA(_0x1d53a4,devices[_0x1d53a4]['ip']);}function setSessionTimeout(_0x313dac,_0x40b40d){const _0x4272bc=_0x34d593;let _0x5885d5;if(_0x313dac==_0x4272bc(0x36b))_0x5885d5=loginExpiry*0x3c*0x3e8;else _0x5885d5=devices[_0x40b40d][_0x4272bc(0x2d9)][_0x4272bc(0x39e)]*0x3c*0x3e8-(new Date()[_0x4272bc(0x3f0)]()-devices[_0x40b40d][_0x4272bc(0x2d9)][_0x4272bc(0x365)]);if(devices[_0x40b40d][_0x4272bc(0x2bb)])clearTimeout(devices[_0x40b40d][_0x4272bc(0x2bb)]);devices[_0x40b40d][_0x4272bc(0x2bb)]=setTimeout(()=>{const _0x1bd2dd=_0x4272bc;if(devices[_0x40b40d][_0x1bd2dd(0x2a0)])clearTimeout(devices[_0x40b40d][_0x1bd2dd(0x2a0)]);removeSocketListeners(_0x40b40d),addBlacklist(_0x40b40d),devices[_0x40b40d][_0x1bd2dd(0x2d9)]=null,devices[_0x40b40d][_0x1bd2dd(0x3df)]=null,devices[_0x40b40d]['access'][_0x1bd2dd(0x2de)]=null,logger['debug'](_0x1bd2dd(0x37a)+_0x40b40d[_0x1bd2dd(0x258)](-0x8)),devices[_0x40b40d]['access']=validateAccess(devices[_0x40b40d]['access'][_0x1bd2dd(0x2de)],_0x40b40d),!(devices[_0x40b40d]['access'][_0x1bd2dd(0x302)]&&devices[_0x40b40d][_0x1bd2dd(0x34c)][_0x1bd2dd(0x3d6)]==_0x1bd2dd(0x2b0))&&(_0x313dac==_0x1bd2dd(0x36b)?io['to'](_0x40b40d)[_0x1bd2dd(0x2db)](_0x1bd2dd(0x2c9),{'access':{'allow':![],'reason':_0x1bd2dd(0x356),'token':null}}):io['to'](_0x40b40d)[_0x1bd2dd(0x2db)](_0x1bd2dd(0x2c9),{'access':{'allow':![],'reason':_0x1bd2dd(0x27d),'token':null}})),devices[_0x40b40d]['access'][_0x1bd2dd(0x2de)]=null;},_0x5885d5);}function setTokenRefresh(_0x5e1ef8){const _0x463c8f=_0x34d593;if(devices[_0x5e1ef8][_0x463c8f(0x2a0)])clearTimeout(devices[_0x5e1ef8]['pidRefreshToken']);devices[_0x5e1ef8][_0x463c8f(0x2a0)]=setTimeout(()=>{const _0x166e20=_0x463c8f;getClientsWithUuid(_0x5e1ef8)[_0x166e20(0x27c)]!=0x0?(devices[_0x5e1ef8][_0x166e20(0x34c)]=refreshToken(_0x5e1ef8),io['to'](_0x5e1ef8)['emit']('status',{'status':_0x166e20(0x279),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5e1ef8]['access'],'externalip':devices[_0x5e1ef8]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x5e1ef8)):clearTimeout(devices[_0x5e1ef8]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4fee08){const _0x223a9e=_0x34d593,_0x104784=getClient(_0x4fee08['id'])[_0x223a9e(0x28a)];_0x4fee08[_0x223a9e(0x2db)](_0x223a9e(0x27e),config),_0x4fee08[_0x223a9e(0x2db)](_0x223a9e(0x1fd),cleanSettings()),_0x4fee08['on']('add-bot',_0x2dbf74=>{const _0x4057f9=_0x223a9e;if(validateAccess(_0x2dbf74,_0x104784)[_0x4057f9(0x302)])addBot();else logger[_0x4057f9(0x23e)](_0x4057f9(0x329));}),_0x4fee08['on'](_0x223a9e(0x211),(_0x337a91,_0x429420)=>{const _0x3a9be4=_0x223a9e;if(validateAccess(_0x429420,_0x104784)['allow'])toggleBot(_0x337a91[_0x3a9be4(0x379)],_0x337a91[_0x3a9be4(0x2c9)],_0x337a91[_0x3a9be4(0x3c4)]);else logger['full'](_0x3a9be4(0x377));}),_0x4fee08['on']('toggle-bot-mode',(_0x386fce,_0x1e49d2)=>{const _0x231bc6=_0x223a9e;if(validateAccess(_0x1e49d2,_0x104784)[_0x231bc6(0x302)])toggleBotMode(_0x386fce);else logger['full'](_0x231bc6(0x377));}),_0x4fee08['on'](_0x223a9e(0x255),(_0x3a3e05,_0x398930)=>{const _0x37bcfb=_0x223a9e;if(validateAccess(_0x398930,_0x104784)['allow'])deleteBot(_0x3a3e05);else logger['full'](_0x37bcfb(0x2d5));}),_0x4fee08['on'](_0x223a9e(0x2af),(_0x398f70,_0xdcc97c)=>{const _0x22af7b=_0x223a9e;if(validateAccess(_0xdcc97c,_0x104784)['allow'])storeSettings(_0x398f70,!![]);else logger['full'](_0x22af7b(0x2e6));}),_0x4fee08['on'](_0x223a9e(0x228),_0x5daaa4=>{const _0x350a81=_0x223a9e;if(validateAccess(_0x5daaa4,_0x104784)[_0x350a81(0x302)])updateBB(_0x350a81(0x382));else logger['full'](_0x350a81(0x367));}),_0x4fee08['on'](_0x223a9e(0x3c0),_0x59d6c8=>{const _0x5cd081=_0x223a9e;if(validateAccess(_0x59d6c8,_0x104784)['allow'])updateBB(_0x5cd081(0x386));else logger[_0x5cd081(0x23e)](_0x5cd081(0x2bd));}),_0x4fee08['on']('get-backup-files',_0x466195=>{const _0x4248fd=_0x223a9e;if(validateAccess(_0x466195,_0x104784)[_0x4248fd(0x302)]){const _0x28db9f=getClient(_0x4fee08['id']);if(_0x28db9f)getBackupFiles(_0x28db9f[_0x4248fd(0x28a)]);else logger[_0x4248fd(0x23e)](_0x4248fd(0x2b2));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x4fee08['on'](_0x223a9e(0x312),(_0x48f5d7,_0x1578ed)=>{const _0xceef4a=_0x223a9e;if(validateAccess(_0x1578ed,_0x104784)[_0xceef4a(0x302)])restoreBackupFile(_0x48f5d7);else logger['full'](_0xceef4a(0x1f7));}),_0x4fee08['on'](_0x223a9e(0x3ec),_0x24e03c=>{const _0x42fb6c=_0x223a9e;if(validateAccess(_0x24e03c,_0x104784)[_0x42fb6c(0x302)])getMessages();else logger['full'](_0x42fb6c(0x36f));}),_0x4fee08['on']('confirm-message',(_0x9b454e,_0x570757)=>{const _0x1ceb2a=_0x223a9e;if(validateAccess(_0x570757,_0x104784)[_0x1ceb2a(0x302)])confirmMessage(_0x9b454e);else logger[_0x1ceb2a(0x23e)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4fee08['on'](_0x223a9e(0x294),_0x20973e=>{const _0xbe11d5=_0x223a9e;if(validateAccess(_0x20973e,_0x104784)[_0xbe11d5(0x302)]){if(devices[_0x104784][_0xbe11d5(0x2a0)])clearTimeout(devices[_0x104784][_0xbe11d5(0x2a0)]);if(devices[_0x104784][_0xbe11d5(0x2bb)])clearTimeout(devices[_0x104784][_0xbe11d5(0x2bb)]);removeSocketListeners(getClient(_0x4fee08['id'])['uuid']),addBlacklist(_0x104784),devices[_0x104784]['telegramIpApproval']=null,devices[_0x104784][_0xbe11d5(0x3df)]=null,devices[_0x104784][_0xbe11d5(0x34c)]['token']=null,logger[_0xbe11d5(0x2e2)](_0xbe11d5(0x322)+_0x104784[_0xbe11d5(0x258)](-0x8)),io['to'](getClient(_0x4fee08['id'])['uuid'])[_0xbe11d5(0x2db)](_0xbe11d5(0x2c9),{'access':{'allow':![],'reason':_0xbe11d5(0x2dd),'token':null}});}else logger[_0xbe11d5(0x23e)](_0xbe11d5(0x3d2));});}function initializeSocketBot(_0x2ed442){const _0x5ede55=_0x34d593,_0x239b26=getClient(_0x2ed442['id'])[_0x5ede55(0x299)],_0x7c91b6=getClient(_0x2ed442['id'])[_0x5ede55(0x28a)];_0x2ed442['on']('get-logs',(_0x3a51f1,_0x483e05)=>{const _0x1b4569=_0x5ede55;if(validateAccess(_0x483e05,_0x7c91b6)[_0x1b4569(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x1b4569(0x2d4)]({'function':_0x1b4569(0x31b),'args':_0x3a51f1});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x2ed442['on'](_0x5ede55(0x292),(_0x4f9473,_0x45ccef)=>{const _0x54eed7=_0x5ede55;if(validateAccess(_0x45ccef,_0x7c91b6)[_0x54eed7(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x54eed7(0x2d4)]({'function':_0x54eed7(0x2cc),'args':_0x4f9473});}else logger[_0x54eed7(0x23e)](_0x54eed7(0x3e0));}),_0x2ed442['on'](_0x5ede55(0x3cf),(_0x1683d9,_0x15479e)=>{const _0x577d3a=_0x5ede55;if(validateAccess(_0x15479e,_0x7c91b6)[_0x577d3a(0x302)]){if(pid[_0x239b26])pid[_0x239b26]['send']({'function':_0x577d3a(0x35e),'args':_0x1683d9});}else logger[_0x577d3a(0x23e)](_0x577d3a(0x397));}),_0x2ed442['on'](_0x5ede55(0x3d9),(_0x4848b9,_0x3cae58)=>{const _0x5e19a4=_0x5ede55;if(validateAccess(_0x3cae58,_0x7c91b6)[_0x5e19a4(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x5e19a4(0x2d4)]({'function':_0x5e19a4(0x257),'args':_0x4848b9});}else logger['full'](_0x5e19a4(0x2ab));}),_0x2ed442['on'](_0x5ede55(0x242),(_0x1f722b,_0x27a8c2)=>{const _0x180f56=_0x5ede55;if(validateAccess(_0x27a8c2,_0x7c91b6)[_0x180f56(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x180f56(0x2d4)]({'function':_0x180f56(0x29f),'args':_0x1f722b});}else logger[_0x180f56(0x23e)](_0x180f56(0x376));}),_0x2ed442['on'](_0x5ede55(0x2be),(_0x4b8cba,_0x3b1010)=>{const _0x53e1ba=_0x5ede55;if(validateAccess(_0x3b1010,_0x7c91b6)[_0x53e1ba(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x53e1ba(0x2d4)]({'function':_0x53e1ba(0x27f),'args':_0x4b8cba});}else logger[_0x53e1ba(0x23e)](_0x53e1ba(0x341));}),_0x2ed442['on'](_0x5ede55(0x3ea),_0x21243a=>{const _0x50d20e=_0x5ede55;if(validateAccess(_0x21243a,_0x7c91b6)[_0x50d20e(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x50d20e(0x2d4)]({'function':'resetHistory','args':null});}else logger[_0x50d20e(0x23e)](_0x50d20e(0x206));}),_0x2ed442['on'](_0x5ede55(0x2e5),_0x236e37=>{const _0x5b602a=_0x5ede55;if(validateAccess(_0x236e37,_0x7c91b6)['allow']){if(pid[_0x239b26])pid[_0x239b26][_0x5b602a(0x2d4)]({'function':_0x5b602a(0x3c2),'args':null});}else logger[_0x5b602a(0x23e)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2ed442['on'](_0x5ede55(0x22e),(_0xbb7fb0,_0x3c9d57)=>{const _0x4fd33c=_0x5ede55;if(validateAccess(_0x3c9d57,_0x7c91b6)['allow']){if(pid[_0x239b26])pid[_0x239b26][_0x4fd33c(0x2d4)]({'function':_0x4fd33c(0x3d1),'args':_0xbb7fb0});}else logger[_0x4fd33c(0x23e)](_0x4fd33c(0x2f6));}),_0x2ed442['on'](_0x5ede55(0x2e3),_0x561dec=>{const _0x53a160=_0x5ede55;if(validateAccess(_0x561dec,_0x7c91b6)[_0x53a160(0x302)]){if(pid[_0x239b26])pid[_0x239b26]['send']({'function':_0x53a160(0x20c),'args':null});}else logger[_0x53a160(0x23e)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x2ed442['on'](_0x5ede55(0x395),_0x3e9167=>{const _0x17cc9e=_0x5ede55;if(validateAccess(_0x3e9167,_0x7c91b6)[_0x17cc9e(0x302)]){if(pid[_0x239b26])pid[_0x239b26][_0x17cc9e(0x2d4)]({'function':'showConfig','args':null});}else logger[_0x17cc9e(0x23e)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2ed442['on']('update-bb',_0x136175=>{const _0x53ab45=_0x5ede55;if(validateAccess(_0x136175,_0x7c91b6)[_0x53ab45(0x302)])updateBB('update');else logger['full'](_0x53ab45(0x367));}),_0x2ed442['on'](_0x5ede55(0x3ec),_0x59791b=>{const _0x36050f=_0x5ede55;if(validateAccess(_0x59791b,_0x7c91b6)[_0x36050f(0x302)])getMessages();else logger[_0x36050f(0x23e)](_0x36050f(0x36f));}),_0x2ed442['on'](_0x5ede55(0x3d4),(_0x50ad0a,_0x518176)=>{const _0x6bf73a=_0x5ede55;if(validateAccess(_0x518176,_0x7c91b6)[_0x6bf73a(0x302)])confirmMessage(_0x50ad0a);else logger[_0x6bf73a(0x23e)](_0x6bf73a(0x36c));}),_0x2ed442['on'](_0x5ede55(0x294),_0x14eed5=>{const _0x2e6f45=_0x5ede55;if(validateAccess(_0x14eed5,_0x7c91b6)['allow']){if(devices[_0x7c91b6]['pidRefreshToken'])clearTimeout(devices[_0x7c91b6]['pidRefreshToken']);if(devices[_0x7c91b6][_0x2e6f45(0x2bb)])clearTimeout(devices[_0x7c91b6][_0x2e6f45(0x2bb)]);removeSocketListeners(getClient(_0x2ed442['id'])[_0x2e6f45(0x28a)]),addBlacklist(_0x7c91b6),devices[_0x7c91b6][_0x2e6f45(0x2d9)]=null,devices[_0x7c91b6]['telegram2FaApproval']=null,devices[_0x7c91b6][_0x2e6f45(0x34c)][_0x2e6f45(0x2de)]=null,logger[_0x2e6f45(0x2e2)](_0x2e6f45(0x322)+_0x7c91b6[_0x2e6f45(0x258)](-0x8)),io['to'](getClient(_0x2ed442['id'])[_0x2e6f45(0x28a)])[_0x2e6f45(0x2db)](_0x2e6f45(0x2c9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x2e6f45(0x23e)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x5229b2){const _0x55653d=_0x34d593;getClientsWithUuid(_0x5229b2)[_0x55653d(0x2ba)](_0x3da06d=>{const _0x302f36=_0x55653d;getSocket(_0x3da06d['id'])[_0x302f36(0x301)]();});}function cleanSettings(){const _0x5033ce=_0x34d593;let _0x464727=settings;return settings[_0x5033ce(0x28b)]&&settings[_0x5033ce(0x28b)]!=''&&(_0x464727={..._0x464727,'telegramToken':_0x5033ce(0x24b)}),settings['bbPassword']&&settings[_0x5033ce(0x2b8)]!=''&&(_0x464727={..._0x464727,'bbPassword':_0x5033ce(0x24b)}),settings['marketcapApi']&&settings[_0x5033ce(0x3dd)]!=''&&(_0x464727={..._0x464727,'marketcapApi':_0x5033ce(0x24b)}),(settings['bbPassword']&&settings[_0x5033ce(0x2b8)]==_0x5033ce(0x3e9)||settings[_0x5033ce(0x28b)]&&settings[_0x5033ce(0x28b)]==_0x5033ce(0x3e9)||settings['marketcapApi']&&settings[_0x5033ce(0x3dd)]==_0x5033ce(0x3e9))&&(_0x464727={..._0x464727,'restored':{'password':settings['bbPassword']==_0x5033ce(0x3e9),'telegram':settings['telegramToken']==_0x5033ce(0x3e9),'marketcap':settings['marketcapApi']==_0x5033ce(0x3e9)}}),_0x464727;}async function updateBB(_0x5775c1){const _0x163166=_0x34d593;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0xc02215=>{const _0x3022ad=_0x2ebb;restartBot(_0xc02215[_0x3022ad(0x379)]);});if(_0x5775c1=='update')process[_0x163166(0x2d4)]({'update':!![],'environment':environment},_0x2d973b=>{});else _0x5775c1=='reinstall'&&process[_0x163166(0x2d4)]({'reinstall':!![],'environment':environment},_0x18daa2=>{});}function startBot(_0x3d6d8d,_0x25deb5,_0x2c2376){const _0x3fa43c=_0x34d593;if(debugging)_0x3d6d8d[_0x3fa43c(0x2d1)]('-d');let _0x4862f7=![];const _0x47b0a8=_0x3d6d8d[0x0];_0x25deb5={..._0x25deb5,'stdio':['inherit',_0x3fa43c(0x347),_0x3fa43c(0x347),'ipc']},pid[_0x47b0a8]=childProcess[_0x3fa43c(0x2ef)](botfile,_0x3d6d8d,_0x25deb5),pid[_0x47b0a8]['on'](_0x3fa43c(0x289),_0x300d01=>{const _0x4c218d=_0x3fa43c;switch(Object['keys'](_0x300d01)[0x0]){case'botname':updateBotName(_0x47b0a8,_0x300d01[_0x4c218d(0x2a9)]);break;case'updatebotmanager':updateBotManager();break;case _0x4c218d(0x2c9):updateStatus(_0x47b0a8,_0x300d01[_0x4c218d(0x2c9)]);break;case'live':updateLive(_0x47b0a8,_0x300d01[_0x4c218d(0x3c4)]);break;case _0x4c218d(0x345):updateLive(_0x47b0a8,_0x300d01[_0x4c218d(0x345)]),io['to'](_0x47b0a8)[_0x4c218d(0x2db)]('status',{'access':{'allow':![],'reason':_0x4c218d(0x2b4),'token':null}});break;case _0x4c218d(0x30e):_0x300d01['stop']==_0x4c218d(0x364)&&restartBot(_0x47b0a8);_0x300d01['stop']==_0x4c218d(0x273)&&toggleBot(_0x47b0a8,'disabled',_0x4c218d(0x24e));break;case _0x4c218d(0x32a):sendTelegramBot(_0x47b0a8,_0x300d01['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x300d01[_0x4c218d(0x2bc)]);break;case _0x4c218d(0x239):io['to'](_0x47b0a8)[_0x4c218d(0x2db)](_0x300d01[_0x4c218d(0x239)],_0x300d01['args']);break;}}),pid[_0x47b0a8]['on'](_0x3fa43c(0x36d),function(_0xbc6581){if(_0x4862f7)return;_0x4862f7=!![],_0x2c2376(_0xbc6581);}),pid[_0x47b0a8]['on']('exit',async function(_0x20ba92){const _0x4bd19e=_0x3fa43c;if(terminating)return;if(installingUpdate){logger[_0x4bd19e(0x2e2)](_0x4bd19e(0x304)),io['close']();return;}if(_0x4862f7)return;_0x4862f7=!![],_0x2c2376(null);const _0x586fa9=dbConfig['get']('bots')[_0x4bd19e(0x2c0)]({'botID':_0x47b0a8})[_0x4bd19e(0x378)]();_0x586fa9&&(_0x586fa9[_0x4bd19e(0x2c9)]==_0x4bd19e(0x3bc)||_0x586fa9[_0x4bd19e(0x2c9)]==_0x4bd19e(0x270))&&(await sleep(0x3e8),updateLive(_0x47b0a8,'stopped'),_0x20ba92==0x7?logger[_0x4bd19e(0x2e2)](_0x4bd19e(0x31f)+_0x47b0a8):logger[_0x4bd19e(0x23e)](_0x4bd19e(0x3cc)+_0x47b0a8),startBot([_0x47b0a8,userID],{'cwd':bbpath},function(_0x2d9edf){const _0x3ff41f=_0x4bd19e;if(_0x2d9edf)logger[_0x3ff41f(0x23e)](_0x2d9edf);}));});}function stopBot(_0xafb6b4){const _0x3a4e9c=_0x34d593;getClientsWithBotID(_0xafb6b4)[_0x3a4e9c(0x2ba)](_0x5f17bc=>{const _0x40a0c4=_0x3a4e9c;getSocket(_0x5f17bc['id'])[_0x40a0c4(0x272)](!![]),removeClient(_0x5f17bc['id']);}),pid[_0xafb6b4]&&(pid[_0xafb6b4][_0x3a4e9c(0x273)](),pid[_0xafb6b4]=null);}function stopAllBots(){terminating=!![];const _0x3ac4d3=getEnabledBots();_0x3ac4d3['forEach'](_0x3aa0b8=>{const _0x4ca9d0=_0x2ebb;stopBot(_0x3aa0b8[_0x4ca9d0(0x379)]);});}function restartBot(_0x200075){const _0x506586=_0x34d593;if(pid[_0x200075])pid[_0x200075][_0x506586(0x273)]();}function restartAllBots(){const _0x2d111c=_0x34d593,_0x58c094=getEnabledBots();_0x58c094[_0x2d111c(0x2ba)](()=>{const _0x49872d=_0x2d111c;broadcastToBots('function',_0x49872d(0x2a8));});}function addBot(){const _0x2c5f73=_0x34d593;let _0xbe4846;for(let _0x1ac7b0=0x1;_0x1ac7b0<0x3e9;_0x1ac7b0++){_0xbe4846=_0x1ac7b0[_0x2c5f73(0x3a1)]()[_0x2c5f73(0x3cb)](0x3,'0');let _0xa272bf=config[_0x2c5f73(0x2c0)](_0x64c699=>_0x64c699['botID']==_0xbe4846);if(!_0xa272bf)break;}if(_0xbe4846===_0x2c5f73(0x29b)){logger[_0x2c5f73(0x23e)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x2c5f73(0x23e)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0xbe4846),dbConfig[_0x2c5f73(0x271)](_0x2c5f73(0x27e))[_0x2c5f73(0x2d1)]({'botID':_0xbe4846,'botname':_0x2c5f73(0x29a)+_0xbe4846,'status':_0x2c5f73(0x270),'live':''})[_0x2c5f73(0x285)](),startBot([_0xbe4846,userID],{'cwd':bbpath},function(_0x3d8c37){if(_0x3d8c37)logger['full'](_0x3d8c37);}),config=getConfiguration(),io['to']('botmanager')[_0x2c5f73(0x2db)]('bots',config),broadcastToBots(_0x2c5f73(0x27e),JSON[_0x2c5f73(0x3f3)](config));}function deleteBot(_0x3d68d6){const _0x4c1da0=_0x34d593;getClientsWithBotID(_0x3d68d6)[_0x4c1da0(0x2ba)](_0x3c9eb4=>{const _0x30e0b8=_0x4c1da0;getSocket(_0x3c9eb4['id'])[_0x30e0b8(0x272)](!![]),removeClient(_0x3c9eb4['id']);}),dbConfig[_0x4c1da0(0x271)]('bots')[_0x4c1da0(0x339)]({'botID':_0x3d68d6})[_0x4c1da0(0x285)](),logger['full']('Deleted\x20Bot\x20'+_0x3d68d6),stopBot(_0x3d68d6);try{if(fs[_0x4c1da0(0x2e4)](path[_0x4c1da0(0x286)](configpath,_0x4c1da0(0x2b1)+_0x3d68d6+_0x4c1da0(0x1ff))))fs[_0x4c1da0(0x2ad)](path[_0x4c1da0(0x286)](configpath,'bot-'+_0x3d68d6+_0x4c1da0(0x1ff)));if(fs[_0x4c1da0(0x2e4)](path[_0x4c1da0(0x286)](configpath,'bot-'+_0x3d68d6+_0x4c1da0(0x361))))fs[_0x4c1da0(0x2ad)](path['join'](configpath,_0x4c1da0(0x2b1)+_0x3d68d6+_0x4c1da0(0x361)));if(fs[_0x4c1da0(0x2e4)](path[_0x4c1da0(0x286)](configpath,_0x4c1da0(0x2b1)+_0x3d68d6+'-performance.json')))fs['unlinkSync'](path[_0x4c1da0(0x286)](configpath,'bot-'+_0x3d68d6+'-performance.json'));if(fs[_0x4c1da0(0x2e4)](path['join'](configpath,_0x4c1da0(0x2b1)+_0x3d68d6+_0x4c1da0(0x216))))fs[_0x4c1da0(0x2ad)](path[_0x4c1da0(0x286)](configpath,_0x4c1da0(0x2b1)+_0x3d68d6+'-results.json'));}catch(_0x4cec6d){if(_0x4cec6d)logger[_0x4c1da0(0x23e)](_0x4c1da0(0x283),_0x4cec6d);}config=getConfiguration(),io['to'](_0x4c1da0(0x282))[_0x4c1da0(0x2db)](_0x4c1da0(0x27e),config),broadcastToBots('bots',JSON[_0x4c1da0(0x3f3)](config));}function toggleBot(_0x8c4091,_0x148ee9,_0x2db710){const _0x56fdcd=_0x34d593;dbConfig[_0x56fdcd(0x271)](_0x56fdcd(0x27e))[_0x56fdcd(0x2c0)]({'botID':_0x8c4091})[_0x56fdcd(0x284)]({'status':_0x148ee9})['assign']({'live':_0x2db710})['write']();if(_0x148ee9==_0x56fdcd(0x3bc)||_0x148ee9==_0x56fdcd(0x270))logger['full'](_0x56fdcd(0x3f5)+_0x8c4091),startBot([_0x8c4091,userID],{'cwd':bbpath},function(_0x38677b){if(_0x38677b)logger['full'](_0x38677b);});else(_0x148ee9==_0x56fdcd(0x204)||_0x148ee9==_0x56fdcd(0x307))&&(logger[_0x56fdcd(0x23e)]('Disabled\x20Bot\x20'+_0x8c4091),stopBot(_0x8c4091));config=getConfiguration(),io['to']('botmanager')[_0x56fdcd(0x2db)]('bots',config),broadcastToBots('bots',JSON[_0x56fdcd(0x3f3)](config));}function toggleStatus(_0x28083b){const _0x13da22=_0x34d593;let _0x39d76f=dbConfig[_0x13da22(0x271)]('bots')['find']({'botID':_0x28083b})[_0x13da22(0x378)](),_0x23bacb;if(_0x39d76f[_0x13da22(0x2c9)]===_0x13da22(0x3bc))_0x23bacb='disabled';else{if(_0x39d76f['status']===_0x13da22(0x270))_0x23bacb=_0x13da22(0x307);else{if(_0x39d76f[_0x13da22(0x2c9)]===_0x13da22(0x307))_0x23bacb=_0x13da22(0x270);else{if(_0x39d76f['status']==='disabled')_0x23bacb=_0x13da22(0x3bc);}}}return _0x23bacb;}function updateStatus(_0x3ae1de,_0x137e5f){const _0x130715=_0x34d593;dbConfig[_0x130715(0x271)]('bots')[_0x130715(0x2c0)]({'botID':_0x3ae1de})['assign']({'status':_0x137e5f})[_0x130715(0x285)](),config=getConfiguration(),io['to'](_0x130715(0x282))[_0x130715(0x2db)](_0x130715(0x27e),config),broadcastToBots(_0x130715(0x27e),JSON[_0x130715(0x3f3)](config));}function updateLive(_0x29eeaa,_0x1158b0){const _0x332241=_0x34d593;dbConfig[_0x332241(0x271)]('bots')['find']({'botID':_0x29eeaa})[_0x332241(0x284)]({'live':_0x1158b0})[_0x332241(0x285)](),config=getConfiguration(),io['to'](_0x332241(0x282))['emit']('bots',config),broadcastToBots('bots',JSON[_0x332241(0x3f3)](config));}function updateBotName(_0x13ad5f,_0x15a10b){const _0x40dcdb=_0x34d593;dbConfig[_0x40dcdb(0x271)](_0x40dcdb(0x27e))[_0x40dcdb(0x2c0)]({'botID':_0x13ad5f})[_0x40dcdb(0x284)]({'botname':_0x15a10b})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x40dcdb(0x2db)](_0x40dcdb(0x27e),config),broadcastToBots(_0x40dcdb(0x27e),JSON[_0x40dcdb(0x3f3)](config));}function updateBotManager(){const _0x61f294=_0x34d593;config=getConfiguration(),io['to'](_0x61f294(0x282))[_0x61f294(0x2db)](_0x61f294(0x27e),config),broadcastToBots(_0x61f294(0x27e),JSON[_0x61f294(0x3f3)](config));}function toggleBotMode(_0x5ec9dd){const _0x444d4f=_0x34d593;if(pid[_0x5ec9dd])pid[_0x5ec9dd]['send']({'function':_0x444d4f(0x252),'args':null});else{const _0x59c998=configpath+_0x444d4f(0x2b1)+_0x5ec9dd+_0x444d4f(0x1ff),_0x19e6db=fs[_0x444d4f(0x305)](_0x59c998),_0x360259=JSON[_0x444d4f(0x22a)](_0x19e6db),_0x278ae3=_0x360259[_0x444d4f(0x299)][0x0][_0x444d4f(0x34d)];_0x360259['bot'][0x0][_0x444d4f(0x34d)]=!_0x278ae3;const _0x157ac3=JSON[_0x444d4f(0x3f3)](_0x360259,null,0x2);fs[_0x444d4f(0x3af)](_0x59c998,_0x157ac3),config=getConfiguration(),io['to'](_0x444d4f(0x282))[_0x444d4f(0x2db)](_0x444d4f(0x27e),config),broadcastToBots(_0x444d4f(0x27e),JSON['stringify'](config));}}function validateTelegram(_0x4d2ead){const _0x5cc647=_0x34d593;if(_0x4d2ead[_0x5cc647(0x24d)]['username']!=settings[_0x5cc647(0x372)]&&'@'+_0x4d2ead[_0x5cc647(0x24d)][_0x5cc647(0x3b2)]!=settings[_0x5cc647(0x372)]||_0x4d2ead[_0x5cc647(0x2a3)]['id']!=settings[_0x5cc647(0x23a)])return sendTelegram(_0x4d2ead[_0x5cc647(0x2a3)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x5cc647(0x280)}),![];return!![];}async function initTelegram(){const _0x2ba0f4=_0x34d593;if(tgBot)tgBot[_0x2ba0f4(0x30e)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x2ba0f4(0x28b)]);let _0x427066='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x427066+='\x0a',_0x427066+=_0x2ba0f4(0x3e1),_0x427066+=_0x2ba0f4(0x2a5),_0x427066+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x427066+=_0x2ba0f4(0x2c2),_0x427066+=_0x2ba0f4(0x3a5),_0x427066+=_0x2ba0f4(0x30a),_0x427066+=_0x2ba0f4(0x3e4),_0x427066+=_0x2ba0f4(0x311),_0x427066+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x427066+=_0x2ba0f4(0x2e7),_0x427066+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x427066+=_0x2ba0f4(0x37e),_0x427066+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x427066+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3e0333='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x3e0333+='\x0a',_0x3e0333+=_0x427066,tgBot[_0x2ba0f4(0x317)]((_0x240072,_0x202647)=>{const _0x28b859=_0x2ba0f4;logger[_0x28b859(0x2eb)](getTimeStamp()+_0x28b859(0x29e)),logger['debug']('Telegraf\x20error:',_0x240072);}),tgBot[_0x2ba0f4(0x254)](async(_0x1dfaf4,_0x3d18bf)=>{const _0x46b09f=_0x2ba0f4;if(!(!settings[_0x46b09f(0x23a)]&&_0x1dfaf4['update'][_0x46b09f(0x289)][_0x46b09f(0x265)]==_0x46b09f(0x223))){if(!validateTelegram(_0x1dfaf4))return;}_0x3d18bf();}),tgBot['command'](_0x2ba0f4(0x3a6),async _0x5a37a2=>{const _0x59ca69=_0x2ba0f4;if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x5a37a2['chat']['id']);updateSetting(_0x59ca69(0x316),!![]);if(!validateTelegram(_0x5a37a2))return;await sendTelegram(_0x5a37a2[_0x59ca69(0x2a3)]['id'],_0x3e0333);}),tgBot[_0x2ba0f4(0x1fe)](_0x2ba0f4(0x340),async _0x190c8f=>{const _0x28e7cf=_0x2ba0f4;updateSetting(_0x28e7cf(0x316),!![]),await sendTelegram(_0x190c8f[_0x28e7cf(0x2a3)]['id'],_0x28e7cf(0x22c));}),tgBot[_0x2ba0f4(0x1fe)](_0x2ba0f4(0x234),async _0x477361=>{const _0x2128db=_0x2ba0f4;await sendTelegram(_0x477361[_0x2128db(0x2a3)]['id'],'Notifications\x20disabled'),updateSetting(_0x2128db(0x316),![]);}),tgBot[_0x2ba0f4(0x1fe)](_0x2ba0f4(0x39a),async _0xc9b9c7=>{const _0x1d03ff=_0x2ba0f4,_0x9b0910=Markup[_0x1d03ff(0x3eb)]([Markup[_0x1d03ff(0x267)]['callback']('Orders',_0x1d03ff(0x2b7)),Markup['button'][_0x1d03ff(0x226)]('Alerts',_0x1d03ff(0x358)),Markup[_0x1d03ff(0x267)][_0x1d03ff(0x226)]('All',_0x1d03ff(0x20f))]);_0xc9b9c7['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x9b0910);}),tgBot['action'](_0x2ba0f4(0x2b7),async _0x3ab5a8=>{const _0x65352e=_0x2ba0f4;_0x3ab5a8[_0x65352e(0x39d)](),updateSetting(_0x65352e(0x391),_0x65352e(0x3b4)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3ab5a8[_0x65352e(0x2a3)]['id'],_0x65352e(0x387));}),tgBot[_0x2ba0f4(0x266)](_0x2ba0f4(0x358),async _0x5d6a1d=>{const _0x4593ae=_0x2ba0f4;_0x5d6a1d['editMessageReplyMarkup'](),updateSetting(_0x4593ae(0x391),_0x4593ae(0x22f)),updateSetting(_0x4593ae(0x316),!![]),await sendTelegram(_0x5d6a1d[_0x4593ae(0x2a3)]['id'],_0x4593ae(0x240));}),tgBot[_0x2ba0f4(0x266)](_0x2ba0f4(0x20f),async _0x2d6827=>{const _0x4e4b04=_0x2ba0f4;_0x2d6827['editMessageReplyMarkup'](),updateSetting(_0x4e4b04(0x391),_0x4e4b04(0x278)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x2d6827[_0x4e4b04(0x2a3)]['id'],_0x4e4b04(0x2d8));}),tgBot[_0x2ba0f4(0x1fe)]('status',async _0x536d72=>{const _0x19526c=_0x2ba0f4,_0x56595e=getBotsWithMode();let _0x5950bd='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x19526c(0x2ba)](_0x226e5e=>{const _0x339e0d=_0x19526c,_0x14e731=_0x56595e['find'](_0x43fcb0=>_0x43fcb0[_0x339e0d(0x379)]==_0x226e5e[_0x339e0d(0x379)])[_0x339e0d(0x201)];_0x5950bd+='Bot\x20'+_0x226e5e['botID']+':\x20'+_0x226e5e[_0x339e0d(0x2c9)]+_0x339e0d(0x33b)+_0x14e731+_0x339e0d(0x33b)+_0x226e5e['live']+'\x0a';}),_0x5950bd+='\x0a',_0x5950bd+=_0x19526c(0x33d),_0x5950bd+=!settings[_0x19526c(0x316)]?_0x19526c(0x3ee):_0x19526c(0x3d3),_0x5950bd+=settings['telegramEnabled']?settings['telegramEvents']==_0x19526c(0x278)?_0x19526c(0x3c3):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x19526c(0x3b3):'',await sendTelegram(_0x536d72['chat']['id'],_0x5950bd,{'parse_mode':'HTML'});}),tgBot['command'](_0x2ba0f4(0x364),async _0x29b19a=>{const _0x560bf0=_0x2ba0f4,_0x1a7e89=getEnabledBots();if(_0x1a7e89[_0x560bf0(0x27c)]==0x0)await sendTelegram(_0x29b19a[_0x560bf0(0x2a3)]['id'],_0x560bf0(0x39c));else{if(_0x1a7e89['length']>0x1)_0x1a7e89[_0x560bf0(0x2d1)]({'botID':'all'});let _0x3ffb8b=[],_0x5b4f6b=[];const _0x4c0ac1=_0x1a7e89[_0x560bf0(0x27c)]%0x4==0x0||_0x1a7e89[_0x560bf0(0x27c)]%0x4==0x3||_0x1a7e89['length']%0x3==0x1?0x4:0x3;let _0x1c81dd=0x0;_0x1a7e89[_0x560bf0(0x2ba)]((_0x2ee99a,_0x2f44d3)=>{const _0x251fb9=_0x560bf0;if(_0x2f44d3%_0x4c0ac1==0x0)_0x5b4f6b=[];_0x5b4f6b['push'](Markup[_0x251fb9(0x267)][_0x251fb9(0x226)](_0x2ee99a[_0x251fb9(0x379)]==_0x251fb9(0x278)?_0x251fb9(0x390):_0x251fb9(0x29a)+_0x2ee99a[_0x251fb9(0x379)],_0x251fb9(0x34b)+_0x2ee99a[_0x251fb9(0x379)])),_0x2f44d3%_0x4c0ac1==0x0&&(_0x3ffb8b[_0x1c81dd]=_0x5b4f6b,_0x1c81dd++);});const _0x313037=Markup['inlineKeyboard'](_0x3ffb8b);_0x29b19a[_0x560bf0(0x260)](_0x560bf0(0x34e),_0x313037);}}),tgBot['action'](/restart_(.+)/,async _0x10ba45=>{const _0x2aa7a0=_0x2ba0f4,_0xbd4469=_0x10ba45[_0x2aa7a0(0x30c)][0x1];_0x10ba45[_0x2aa7a0(0x39d)](),_0xbd4469=='all'?config[_0x2aa7a0(0x2ba)](_0x1f38eb=>{const _0x4e0c37=_0x2aa7a0;restartBot(_0x1f38eb[_0x4e0c37(0x379)]);}):restartBot(_0xbd4469);}),tgBot[_0x2ba0f4(0x1fe)]('on',async _0x5b60bb=>{const _0x4947f7=_0x2ba0f4,_0x42bec1=getDisabledBots();if(_0x42bec1[_0x4947f7(0x27c)]==0x0)await sendTelegram(_0x5b60bb[_0x4947f7(0x2a3)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x42bec1[_0x4947f7(0x27c)]>0x1)_0x42bec1[_0x4947f7(0x2d1)]({'botID':_0x4947f7(0x278)});let _0x52ed00=[],_0x2eb5c2=[];const _0x272e58=_0x42bec1[_0x4947f7(0x27c)]%0x4==0x0||_0x42bec1['length']%0x4==0x3||_0x42bec1[_0x4947f7(0x27c)]%0x3==0x1?0x4:0x3;let _0x286064=0x0;_0x42bec1[_0x4947f7(0x2ba)]((_0x4bfbdf,_0x3279b7)=>{const _0x3c9343=_0x4947f7;if(_0x3279b7%_0x272e58==0x0)_0x2eb5c2=[];_0x2eb5c2['push'](Markup[_0x3c9343(0x267)][_0x3c9343(0x226)](_0x4bfbdf[_0x3c9343(0x379)]==_0x3c9343(0x278)?_0x3c9343(0x390):_0x3c9343(0x29a)+_0x4bfbdf[_0x3c9343(0x379)],_0x3c9343(0x3e2)+_0x4bfbdf[_0x3c9343(0x379)])),_0x3279b7%_0x272e58==0x0&&(_0x52ed00[_0x286064]=_0x2eb5c2,_0x286064++);});const _0x9dd4=Markup[_0x4947f7(0x3eb)](_0x52ed00);_0x5b60bb[_0x4947f7(0x260)](_0x4947f7(0x2ff),_0x9dd4);}}),tgBot['action'](/on_(.+)/,async _0x4a3b37=>{const _0x433713=_0x2ba0f4,_0x29c78a=_0x4a3b37['match'][0x1];_0x4a3b37[_0x433713(0x39d)]();if(_0x29c78a==_0x433713(0x278)){const _0x44d407=getDisabledBots();await sendTelegram(_0x4a3b37['chat']['id'],_0x433713(0x3e8)),_0x44d407[_0x433713(0x2ba)](_0x370d61=>{const _0x13bb0d=_0x433713;if(_0x370d61[_0x13bb0d(0x379)]!=_0x13bb0d(0x278))toggleBot(_0x370d61['botID'],toggleStatus(_0x370d61['botID']),_0x13bb0d(0x24e));});}else await sendTelegram(_0x4a3b37[_0x433713(0x2a3)]['id'],_0x433713(0x23c)+_0x29c78a),toggleBot(_0x29c78a,toggleStatus(_0x29c78a),_0x433713(0x24e));}),tgBot[_0x2ba0f4(0x1fe)]('off',async _0x1f0fc6=>{const _0x435d6b=_0x2ba0f4,_0x5d9c62=getEnabledBots();if(_0x5d9c62[_0x435d6b(0x27c)]==0x0)await sendTelegram(_0x1f0fc6['chat']['id'],_0x435d6b(0x39c));else{if(_0x5d9c62['length']>0x1)_0x5d9c62['push']({'botID':_0x435d6b(0x278)});let _0x106c72=[],_0x56954e=[];const _0x416ae1=_0x5d9c62[_0x435d6b(0x27c)]%0x4==0x0||_0x5d9c62[_0x435d6b(0x27c)]%0x4==0x3||_0x5d9c62[_0x435d6b(0x27c)]%0x3==0x1?0x4:0x3;let _0x2497f0=0x0;_0x5d9c62[_0x435d6b(0x2ba)]((_0x259b04,_0x934b1f)=>{const _0xbfef2f=_0x435d6b;if(_0x934b1f%_0x416ae1==0x0)_0x56954e=[];_0x56954e['push'](Markup['button']['callback'](_0x259b04['botID']=='all'?_0xbfef2f(0x390):_0xbfef2f(0x29a)+_0x259b04[_0xbfef2f(0x379)],_0xbfef2f(0x21e)+_0x259b04[_0xbfef2f(0x379)])),_0x934b1f%_0x416ae1==0x0&&(_0x106c72[_0x2497f0]=_0x56954e,_0x2497f0++);});const _0x2e807a=Markup[_0x435d6b(0x3eb)](_0x106c72);_0x1f0fc6['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x2e807a);}}),tgBot[_0x2ba0f4(0x266)](/off_(.+)/,async _0x5b3a03=>{const _0x2fccc0=_0x2ba0f4,_0x97dcbe=_0x5b3a03['match'][0x1];_0x5b3a03[_0x2fccc0(0x39d)]();if(_0x97dcbe==_0x2fccc0(0x278)){const _0xbb56d5=getEnabledBots();await sendTelegram(_0x5b3a03[_0x2fccc0(0x2a3)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0xbb56d5[_0x2fccc0(0x2ba)](_0x537b99=>{const _0x4ad834=_0x2fccc0;if(_0x537b99[_0x4ad834(0x379)]!='all')toggleBot(_0x537b99[_0x4ad834(0x379)],toggleStatus(_0x537b99[_0x4ad834(0x379)]),_0x4ad834(0x24e));});}else await sendTelegram(_0x5b3a03[_0x2fccc0(0x2a3)]['id'],_0x2fccc0(0x333)+_0x97dcbe),toggleBot(_0x97dcbe,toggleStatus(_0x97dcbe),_0x2fccc0(0x24e));}),tgBot[_0x2ba0f4(0x1fe)]('metrics',async _0x1948e2=>{const _0x52e650=_0x2ba0f4,_0x963067=getEnabledBots();if(_0x963067[_0x52e650(0x27c)]==0x0)await sendTelegram(_0x1948e2[_0x52e650(0x2a3)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x963067['length']>0x1){let _0x3868a9=[],_0x79560f=[];const _0xc523a5=_0x963067[_0x52e650(0x27c)]%0x4==0x0||_0x963067[_0x52e650(0x27c)]%0x4==0x3||_0x963067[_0x52e650(0x27c)]%0x3==0x1?0x4:0x3;let _0x587d4b=0x0;_0x963067[_0x52e650(0x2ba)]((_0x45b25d,_0x433188)=>{const _0x49fa26=_0x52e650;if(_0x433188%_0xc523a5==0x0)_0x79560f=[];_0x79560f[_0x49fa26(0x2d1)](Markup[_0x49fa26(0x267)][_0x49fa26(0x226)](_0x49fa26(0x29a)+_0x45b25d[_0x49fa26(0x379)],_0x49fa26(0x3a0)+_0x45b25d[_0x49fa26(0x379)])),_0x433188%_0xc523a5==0x0&&(_0x3868a9[_0x587d4b]=_0x79560f,_0x587d4b++);});const _0x4f4cc4=Markup[_0x52e650(0x3eb)](_0x3868a9);_0x1948e2['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x4f4cc4);}else{const _0x5bb269=_0x963067[0x0][_0x52e650(0x379)];if(pid[_0x5bb269])pid[_0x5bb269][_0x52e650(0x2d4)]({'function':_0x52e650(0x343),'args':null});}}}),tgBot[_0x2ba0f4(0x266)](/metrics_(.+)/,async _0x1c9ef5=>{const _0x54258d=_0x2ba0f4,_0x345d20=_0x1c9ef5[_0x54258d(0x30c)][0x1];_0x1c9ef5[_0x54258d(0x39d)]();if(pid[_0x345d20])pid[_0x345d20][_0x54258d(0x2d4)]({'function':_0x54258d(0x343),'args':null});}),tgBot[_0x2ba0f4(0x1fe)](_0x2ba0f4(0x1fb),async _0xbb017b=>{const _0x351760=_0x2ba0f4,_0x3d5cc2=getEnabledBots();if(_0x3d5cc2[_0x351760(0x27c)]==0x0)await sendTelegram(_0xbb017b[_0x351760(0x2a3)]['id'],_0x351760(0x39c));else{if(_0x3d5cc2['length']>0x1){let _0x8d7077=[],_0x1d80f3=[];const _0x260141=_0x3d5cc2[_0x351760(0x27c)]%0x4==0x0||_0x3d5cc2[_0x351760(0x27c)]%0x4==0x3||_0x3d5cc2[_0x351760(0x27c)]%0x3==0x1?0x4:0x3;let _0x4e8911=0x0;_0x3d5cc2[_0x351760(0x2ba)]((_0x4c81fe,_0x206eb5)=>{const _0x1e6518=_0x351760;if(_0x206eb5%_0x260141==0x0)_0x1d80f3=[];_0x1d80f3[_0x1e6518(0x2d1)](Markup['button'][_0x1e6518(0x226)](_0x1e6518(0x29a)+_0x4c81fe[_0x1e6518(0x379)],_0x1e6518(0x3da)+_0x4c81fe[_0x1e6518(0x379)])),_0x206eb5%_0x260141==0x0&&(_0x8d7077[_0x4e8911]=_0x1d80f3,_0x4e8911++);});const _0x2ea952=Markup[_0x351760(0x3eb)](_0x8d7077);_0xbb017b['reply'](_0x351760(0x236),_0x2ea952);}else{const _0x4adea3=_0x3d5cc2[0x0][_0x351760(0x379)];if(pid[_0x4adea3])pid[_0x4adea3][_0x351760(0x2d4)]({'function':_0x351760(0x2ac),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x319ea1=>{const _0x185488=_0x2ba0f4,_0x46c8b9=_0x319ea1[_0x185488(0x30c)][0x1];_0x319ea1[_0x185488(0x39d)]();if(pid[_0x46c8b9])pid[_0x46c8b9][_0x185488(0x2d4)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x2ba0f4(0x1fe)](_0x2ba0f4(0x382),async _0x49b6df=>{const _0x122142=_0x2ba0f4;await getMessages();if(!updateAvailable)await sendTelegram(_0x49b6df[_0x122142(0x2a3)]['id'],_0x122142(0x344));else{if(!validInstallation)await sendTelegram(_0x49b6df[_0x122142(0x2a3)]['id'],_0x122142(0x2f8));else{const _0x3e634e=Markup[_0x122142(0x3eb)]([Markup['button'][_0x122142(0x226)](_0x122142(0x384),_0x122142(0x251)),Markup[_0x122142(0x267)][_0x122142(0x226)]('No',_0x122142(0x354))]);_0x49b6df[_0x122142(0x260)](_0x122142(0x1f9),_0x3e634e);}}}),tgBot['action'](/update_(.+)/,async _0x1c8fe5=>{const _0x2543d7=_0x2ba0f4,_0x40b248=_0x1c8fe5[_0x2543d7(0x30c)][0x1];_0x1c8fe5[_0x2543d7(0x39d)](),_0x40b248==_0x2543d7(0x3b0)&&(await sendTelegram(_0x1c8fe5[_0x2543d7(0x2a3)]['id'],_0x2543d7(0x23f)),updateBB(_0x2543d7(0x382))),_0x40b248=='no'&&await sendTelegram(_0x1c8fe5[_0x2543d7(0x2a3)]['id'],_0x2543d7(0x268));}),tgBot[_0x2ba0f4(0x1fe)](_0x2ba0f4(0x386),async _0x811416=>{const _0x46efdc=_0x2ba0f4;if(!validInstallation)await sendTelegram(_0x811416[_0x46efdc(0x2a3)]['id'],_0x46efdc(0x32d));else{const _0x53a0ca=Markup[_0x46efdc(0x3eb)]([Markup[_0x46efdc(0x267)][_0x46efdc(0x226)]('Yes',_0x46efdc(0x396)),Markup[_0x46efdc(0x267)]['callback']('No','reinstall_no')]);_0x811416[_0x46efdc(0x260)](_0x46efdc(0x34f),_0x53a0ca);}}),tgBot[_0x2ba0f4(0x266)](/reinstall_(.+)/,async _0x166ba6=>{const _0x382fad=_0x2ba0f4,_0x584d75=_0x166ba6[_0x382fad(0x30c)][0x1];_0x166ba6['editMessageReplyMarkup'](),_0x584d75==_0x382fad(0x3b0)&&(await sendTelegram(_0x166ba6['chat']['id'],_0x382fad(0x3a9)),updateBB(_0x382fad(0x386))),_0x584d75=='no'&&await sendTelegram(_0x166ba6[_0x382fad(0x2a3)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x2ba0f4(0x1fe)]('toggle',async _0xad5070=>{const _0x317c06=_0x2ba0f4,_0x316114=getBotsWithMode();if(_0x316114['length']==0x0)await sendTelegram(_0xad5070['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x18d153=[],_0x42623e=[];const _0x5b3456=0x2;let _0x38a9ee=0x0;_0x316114['forEach']((_0x50314c,_0x1f3aec)=>{const _0x1f71f7=_0x2ebb;if(_0x1f3aec%_0x5b3456==0x0)_0x42623e=[];_0x42623e[_0x1f71f7(0x2d1)](Markup[_0x1f71f7(0x267)][_0x1f71f7(0x226)](_0x1f71f7(0x29a)+_0x50314c[_0x1f71f7(0x379)]+'\x20('+_0x50314c[_0x1f71f7(0x201)]+')',_0x1f71f7(0x388)+_0x50314c[_0x1f71f7(0x379)])),_0x1f3aec%_0x5b3456==0x0&&(_0x18d153[_0x38a9ee]=_0x42623e,_0x38a9ee++);});const _0x3640e0=Markup[_0x317c06(0x3eb)](_0x18d153);_0xad5070[_0x317c06(0x260)](_0x317c06(0x3ad),_0x3640e0);}}),tgBot['action'](/toggle_(.+)/,async _0x4b33a4=>{const _0x98794a=_0x2ba0f4,_0x4a3a88=_0x4b33a4['match'][0x1];_0x4b33a4[_0x98794a(0x39d)]();const _0x31106d=getBotsWithMode(),_0xd731fd=_0x31106d[_0x98794a(0x2c0)](_0x2173d6=>_0x2173d6['botID']==_0x4a3a88),_0x176cb5=_0xd731fd['mode']==_0x98794a(0x231)?'manual':_0x98794a(0x231);await sendTelegram(_0x4b33a4[_0x98794a(0x2a3)]['id'],_0x98794a(0x23b)+_0x4a3a88+_0x98794a(0x25b)+_0x176cb5+_0x98794a(0x3a2)),toggleBotMode(_0x4a3a88);}),tgBot['command'](_0x2ba0f4(0x27b),async _0x79200c=>{const _0x4633b2=_0x2ba0f4;let _0x515eb3='';config[_0x4633b2(0x2ba)](_0x56bf41=>{const _0x381469=_0x4633b2;_0x515eb3+=_0x381469(0x29a)+_0x56bf41[_0x381469(0x379)]+':\x20'+_0x56bf41[_0x381469(0x2a9)]+'\x0a';}),await sendTelegram(_0x79200c['chat']['id'],_0x515eb3,{'parse_mode':_0x4633b2(0x280)});}),tgBot['command']('help',async _0x30aa6c=>{const _0x3a2ad8=_0x2ba0f4;await sendTelegram(_0x30aa6c[_0x3a2ad8(0x2a3)]['id'],_0x427066);}),process['once'](_0x2ba0f4(0x20d),()=>tgBot['stop'](_0x2ba0f4(0x20d))),process[_0x2ba0f4(0x380)](_0x2ba0f4(0x38e),()=>tgBot[_0x2ba0f4(0x30e)]('SIGTERM')),tgBot['launch']();}}function disableTelegram(){const _0x317533=_0x34d593;tgBot&&tgBot[_0x317533(0x30e)]();}async function sendTelegram(_0x363182,_0xd4ebb0,_0xcf1b40){const _0x29d6ab=_0x34d593;_0xcf1b40={..._0xcf1b40,'disable_web_page_preview':!![]};try{await tgBot['telegram']['sendMessage'](_0x363182,_0xd4ebb0,_0xcf1b40);}catch(_0x912dc2){console[_0x29d6ab(0x227)](_0x29d6ab(0x2c4),_0x912dc2);}}async function sendTelegramBot(_0x555f81,_0x358bd3){const _0x44ffc4=_0x34d593;if(settings[_0x44ffc4(0x316)]){if(settings['telegramEvents']==_0x44ffc4(0x278)||(_0x358bd3[_0x44ffc4(0x3c5)]==_0x44ffc4(0x36d)||_0x358bd3['type']==_0x44ffc4(0x2fb)||_0x358bd3[_0x44ffc4(0x3c5)]=='success')&&settings['telegramEvents']==_0x44ffc4(0x22f)||_0x358bd3[_0x44ffc4(0x3c5)]==_0x44ffc4(0x3a8)&&settings[_0x44ffc4(0x391)]==_0x44ffc4(0x3b4)){if(tgBot&&settings[_0x44ffc4(0x23a)]){if(_0x358bd3[_0x44ffc4(0x209)])await sendTelegram(settings[_0x44ffc4(0x23a)],_0x358bd3[_0x44ffc4(0x2a9)]+_0x44ffc4(0x3f4)+_0x358bd3[_0x44ffc4(0x39b)]);else await sendTelegram(settings[_0x44ffc4(0x23a)],_0x44ffc4(0x29a)+_0x555f81+_0x44ffc4(0x3f4)+_0x358bd3[_0x44ffc4(0x39b)]);}}}}async function sendTelegramMsg(_0x277899,_0x317100=_0x34d593(0x280)){const _0x11e28e=_0x34d593;return settings[_0x11e28e(0x316)]&&tgBot&&settings[_0x11e28e(0x23a)]?(await sendTelegram(settings[_0x11e28e(0x23a)],_0x277899,{'parse_mode':_0x317100}),!![]):![];}function getDeviceWithIp(_0x1c75df){return devices['find'](_0x38e4db=>_0x38e4db['ip']===_0x1c75df);}async function temporaryAccess2FA(_0x143e76,_0x2ff877){const _0x534c9f=_0x34d593;let _0x1acbb0=new Date(),_0x67f07f=![];if(lastIpApproval){if(_0x1acbb0-lastIpApproval<0x1388)_0x67f07f=!![];}lastIpApproval=new Date();if(_0x67f07f)return;if(tgBot&&settings[_0x534c9f(0x23a)]){const _0x49b0ee=uuidRandom();tmpStorage[_0x49b0ee]={'uuid':_0x143e76,'externalip':_0x2ff877};const _0x4e6201=Markup[_0x534c9f(0x3eb)]([Markup[_0x534c9f(0x267)][_0x534c9f(0x226)](_0x534c9f(0x2a6),_0x534c9f(0x2c7)+_0x49b0ee),Markup[_0x534c9f(0x267)][_0x534c9f(0x226)](_0x534c9f(0x297),_0x534c9f(0x21a)+_0x49b0ee),Markup[_0x534c9f(0x267)][_0x534c9f(0x226)]('30\x20min','tempaccess_30_'+_0x49b0ee),Markup[_0x534c9f(0x267)][_0x534c9f(0x226)](_0x534c9f(0x21b),_0x534c9f(0x30d)+_0x49b0ee)]);await sendTelegram(settings[_0x534c9f(0x23a)],_0x534c9f(0x2ee)+normalizeIP(_0x2ff877)['show']+'\x20?',_0x4e6201),tgBot[_0x534c9f(0x266)](/tempaccess_(.+)_(.+)/,async _0x4f0da7=>{const _0x5eb2cf=_0x534c9f,_0x4cf095=_0x4f0da7['match'][0x1],_0x1a86d7=_0x4f0da7[_0x5eb2cf(0x30c)][0x2],{uuid:_0x1094ee,externalip:_0x1b9d49}=tmpStorage[_0x1a86d7];delete tmpStorage[_0x1a86d7],_0x4f0da7[_0x5eb2cf(0x39d)](),devices[_0x1094ee][_0x5eb2cf(0x2d9)]={'clientip':_0x1b9d49,'timestamp':new Date()[_0x5eb2cf(0x3f0)](),'expiry':_0x4cf095},_0x4cf095!=_0x5eb2cf(0x21b)?(await sendTelegram(_0x4f0da7[_0x5eb2cf(0x2a3)]['id'],_0x5eb2cf(0x248)+_0x4cf095+_0x5eb2cf(0x2dc),{'parse_mode':_0x5eb2cf(0x280)}),io['to'](_0x1094ee)[_0x5eb2cf(0x2db)](_0x5eb2cf(0x2c9),{'access':{'allow':![],'reason':_0x5eb2cf(0x2b4),'token':null}})):(await sendTelegram(_0x4f0da7['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x1094ee)[_0x5eb2cf(0x2db)](_0x5eb2cf(0x2c9),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x11322d,_0x146154){const _0x39578e=_0x34d593;if(tgBot&&settings['telegramChatId']){const _0x525227=uuidRandom();tmpStorage[_0x525227]={'uuid':_0x11322d,'externalip':_0x146154};const _0x4617cc=Markup[_0x39578e(0x3eb)]([Markup[_0x39578e(0x267)][_0x39578e(0x226)](_0x39578e(0x33a),_0x39578e(0x26f)+loginExpiry+'_'+_0x525227),Markup[_0x39578e(0x267)]['callback'](_0x39578e(0x21b),'login2fa_reject_'+_0x525227)]);await sendTelegram(settings[_0x39578e(0x23a)],_0x39578e(0x38a)+normalizeIP(_0x146154)[_0x39578e(0x2cd)]+'\x20?',_0x4617cc),tgBot[_0x39578e(0x266)](/login2fa_(.+)_(.+)/,async _0x4d0cc7=>{const _0x4a829f=_0x39578e,_0x2e02d=_0x4d0cc7[_0x4a829f(0x30c)][0x1],_0x2abda9=_0x4d0cc7[_0x4a829f(0x30c)][0x2],{uuid:_0x3266eb,externalip:_0x21be15}=tmpStorage[_0x2abda9];delete tmpStorage[_0x2abda9],_0x4d0cc7[_0x4a829f(0x39d)](),devices[_0x3266eb][_0x4a829f(0x3df)]={'clientip':_0x21be15,'timestamp':new Date()[_0x4a829f(0x3f0)](),'expiry':_0x2e02d},_0x2e02d!='reject'?(await sendTelegram(_0x4d0cc7[_0x4a829f(0x2a3)]['id'],'Login\x20accepted',{'parse_mode':_0x4a829f(0x280)}),io['to'](_0x3266eb)[_0x4a829f(0x2db)](_0x4a829f(0x2c9),{'access':{'allow':![],'reason':_0x4a829f(0x2b4),'token':null}})):(await sendTelegram(_0x4d0cc7[_0x4a829f(0x2a3)]['id'],'Login\x20rejected'),io['to'](_0x3266eb)[_0x4a829f(0x2db)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3705a0=_0x34d593;return dbConfig['get'](_0x3705a0(0x27e))[_0x3705a0(0x368)](_0x3705a0(0x379))[_0x3705a0(0x35a)]({'status':_0x3705a0(0x3bc)})[_0x3705a0(0x378)]()||[];}function getDisabledBots(){const _0xf044eb=_0x34d593;return dbConfig['get']('bots')[_0xf044eb(0x368)]('botID')[_0xf044eb(0x35a)]({'status':'disabled'})[_0xf044eb(0x378)]()||[];}function getBotAttributes(_0x3049e1){const _0x50d9e2=_0x34d593;let _0x4987b8={};const _0x571f3d=configpath+_0x50d9e2(0x2b1)+_0x3049e1+_0x50d9e2(0x1ff),_0x3e8122=fs[_0x50d9e2(0x2e4)](_0x571f3d);if(_0x3e8122){const _0xd74fa6=fs[_0x50d9e2(0x305)](_0x571f3d);try{const _0x56ba75=JSON[_0x50d9e2(0x22a)](_0xd74fa6),_0x5e926e=_0x56ba75?_0x56ba75[_0x50d9e2(0x299)][0x0][_0x50d9e2(0x34d)]:![];_0x4987b8['mode']=_0x5e926e?_0x50d9e2(0x231):'manual',_0x4987b8['botname']=_0x56ba75?_0x56ba75[_0x50d9e2(0x299)][0x0][_0x50d9e2(0x2a9)]:_0x50d9e2(0x29a)+_0x3049e1;}catch(_0x58ae8d){_0x4987b8['mode']='manual',_0x4987b8['botname']=_0x50d9e2(0x29a)+_0x3049e1;}}else _0x4987b8[_0x50d9e2(0x201)]=_0x50d9e2(0x336),_0x4987b8[_0x50d9e2(0x2a9)]=_0x50d9e2(0x29a)+_0x3049e1;return _0x4987b8;}function getBotsWithMode(){const _0x974f30=_0x34d593,_0xd5a1d8=dbConfig[_0x974f30(0x271)](_0x974f30(0x27e))[_0x974f30(0x368)]('botID')[_0x974f30(0x378)]()||[];return _0xd5a1d8['forEach'](_0xa407b7=>{const _0x5c9c2b=_0x974f30;let _0xfb0824=getBotAttributes(_0xa407b7[_0x5c9c2b(0x379)]);_0xa407b7[_0x5c9c2b(0x201)]=_0xfb0824[_0x5c9c2b(0x201)];}),_0xd5a1d8;}function getBotExchanges(){const _0x3a1f94=_0x34d593;let _0x10a607=[];const _0x461a97=dbConfig['get'](_0x3a1f94(0x27e))[_0x3a1f94(0x368)]('botID')['value']()||[];_0x461a97[_0x3a1f94(0x2ba)](_0x7227c6=>{const _0x17a4f8=_0x3a1f94;if(_0x7227c6['status']==_0x17a4f8(0x3bc)){const _0x38e50e=configpath+_0x17a4f8(0x2b1)+_0x7227c6[_0x17a4f8(0x379)]+_0x17a4f8(0x1ff),_0x5ede53=fs['existsSync'](_0x38e50e);let _0xf56bca;if(_0x5ede53){const _0xb14dd0=fs[_0x17a4f8(0x305)](_0x38e50e);try{const _0x82fead=JSON['parse'](_0xb14dd0);_0xf56bca=_0x82fead?_0x82fead[_0x17a4f8(0x299)][0x0]['exchange']:null;}catch(_0x3c48cf){}}if(_0xf56bca)_0x10a607[_0x17a4f8(0x2d1)](_0xf56bca);}});const _0x8d4c0a=[...new Set(_0x10a607)][_0x3a1f94(0x33e)]();return _0x8d4c0a;}async function initUser(){const _0x24c92c=_0x34d593;if(!settings[_0x24c92c(0x306)]){const _0xe25d36=uuidRandom();mixpanel['alias'](_0xe25d36),updateSetting(_0x24c92c(0x306),_0xe25d36);}}async function initSecure(){const _0x5b24d7=_0x34d593;let _0x477db3=getSecure();if(!_0x477db3[_0x5b24d7(0x398)](_0x5b24d7(0x310))){let _0x9d3075=await generateKeys();_0x477db3[_0x5b24d7(0x337)]=_0x9d3075['publicKey'],_0x477db3[_0x5b24d7(0x2da)]=_0x9d3075[_0x5b24d7(0x2da)],_0x477db3[_0x5b24d7(0x310)]=crypto['randomBytes'](0x20)[_0x5b24d7(0x3a1)]('hex');;storeSecure(_0x477db3);}}function getSettings(){const _0x1df95d=_0x34d593;return dbSettings[_0x1df95d(0x271)](_0x1df95d(0x1fd))[_0x1df95d(0x378)]()||{};}function getSecure(){const _0x28e270=_0x34d593;return dbSecure[_0x28e270(0x271)](_0x28e270(0x2ec))[_0x28e270(0x378)]()||{};}function getBlacklist(){const _0x3c0fde=_0x34d593;return dbSecure[_0x3c0fde(0x271)](_0x3c0fde(0x232))['value']()||[];}function broadcastToBots(_0xa04175,_0x1ccf0a){const _0x5d4104=_0x34d593;config[_0x5d4104(0x2ba)](_0x22b906=>{const _0x593156=_0x5d4104;if(_0x22b906[_0x593156(0x2c9)]=='enabled'&&_0x22b906[_0x593156(0x3c4)]==_0x593156(0x363)||_0x22b906[_0x593156(0x2c9)]==_0x593156(0x270)&&_0x22b906[_0x593156(0x3c4)]==_0x593156(0x363)){if(pid[_0x22b906['botID']])pid[_0x22b906[_0x593156(0x379)]][_0x593156(0x2d4)]({[_0xa04175]:_0x1ccf0a});}});}async function storeSettings(_0x145aa5,_0x48cd58=![]){const _0x3742d6=_0x34d593;_0x145aa5={...settings,..._0x145aa5};if(_0x48cd58&&_0x145aa5[_0x3742d6(0x2b8)]!=_0x3742d6(0x24b)&&_0x145aa5[_0x3742d6(0x2b8)]!=_0x3742d6(0x3e9)&&_0x145aa5[_0x3742d6(0x2b8)]!=''){const _0x1499f8=crypt['decrypt'](secure[_0x3742d6(0x2da)],_0x145aa5[_0x3742d6(0x2b8)])[_0x3742d6(0x289)][_0x3742d6(0x221)](_0x3742d6(0x338))[0x0],_0xe59105=bcrypt['hashSync'](_0x1499f8,saltRounds);_0x145aa5={..._0x145aa5,'bbPassword':_0xe59105};}if(_0x48cd58&&_0x145aa5[_0x3742d6(0x28b)]!='************'&&_0x145aa5[_0x3742d6(0x28b)]!=_0x3742d6(0x3e9)&&_0x145aa5['telegramToken']!=''){const _0x2460ac=crypt[_0x3742d6(0x2e9)](secure[_0x3742d6(0x2da)],_0x145aa5[_0x3742d6(0x28b)])['message']['split'](_0x3742d6(0x338))[0x0];_0x145aa5={..._0x145aa5,'telegramToken':_0x2460ac};}if(_0x48cd58&&_0x145aa5['marketcapApi']!=_0x3742d6(0x24b)&&_0x145aa5[_0x3742d6(0x3dd)]!=_0x3742d6(0x3e9)&&_0x145aa5[_0x3742d6(0x3dd)]!=''){const _0x16b979=crypt[_0x3742d6(0x2e9)](secure['privateKey'],_0x145aa5[_0x3742d6(0x3dd)])[_0x3742d6(0x289)][_0x3742d6(0x221)]('|@|')[0x0];_0x145aa5={..._0x145aa5,'marketcapApi':_0x16b979};}const _0x7d4ef1=_0x145aa5['telegramToken']!=_0x3742d6(0x24b)&&_0x145aa5[_0x3742d6(0x28b)]!=settings[_0x3742d6(0x28b)]||_0x145aa5[_0x3742d6(0x372)]!=settings[_0x3742d6(0x372)],_0x220600=_0x145aa5['telegramToken']==''||_0x145aa5[_0x3742d6(0x372)]=='',_0x4aa1b1=_0x145aa5[_0x3742d6(0x3dd)]&&_0x145aa5['marketcapApi']!=_0x3742d6(0x24b)&&_0x145aa5[_0x3742d6(0x3dd)]!=settings[_0x3742d6(0x28b)];_0x7d4ef1&&(_0x145aa5[_0x3742d6(0x23a)]=null,_0x145aa5['telegramEvents']='all');for(const [_0x319d3e,_0xc9e499]of Object[_0x3742d6(0x215)](_0x145aa5)){if(_0x319d3e==_0x3742d6(0x28b)&&_0xc9e499==_0x3742d6(0x24b)){_0x145aa5[_0x3742d6(0x28b)]=settings[_0x3742d6(0x28b)];continue;};if(_0x319d3e==_0x3742d6(0x2b8)&&_0xc9e499==_0x3742d6(0x24b)){_0x145aa5[_0x3742d6(0x2b8)]=settings[_0x3742d6(0x2b8)];continue;};if(_0x319d3e==_0x3742d6(0x3dd)&&_0xc9e499=='************'){_0x145aa5[_0x3742d6(0x3dd)]=settings[_0x3742d6(0x3dd)];continue;};dbSettings[_0x3742d6(0x26d)](_0x3742d6(0x2d7)+_0x319d3e,_0xc9e499)[_0x3742d6(0x285)]();}settings=_0x145aa5,io['to'](_0x3742d6(0x282))[_0x3742d6(0x2db)]('settings',cleanSettings()),broadcastToBots(_0x3742d6(0x346),settings[_0x3742d6(0x346)]),broadcastToBots(_0x3742d6(0x22d),settings[_0x3742d6(0x22d)]),broadcastToBots('marketcapApi',settings['marketcapApi']);if(_0x7d4ef1&&!_0x220600)initTelegram();if(_0x7d4ef1&&_0x220600)disableTelegram();getAllClients()[_0x3742d6(0x2ba)](_0x4e28b8=>{const _0x435ea0=_0x3742d6;getSocket(_0x4e28b8['id'])[_0x435ea0(0x2db)]('status',{'access':{'allow':![],'reason':'reload','token':null}});}),_0x4aa1b1&&(await sleep(0xbb8),testMarketcapApi(_0x145aa5[_0x3742d6(0x3dd)]));}async function testMarketcapApi(_0x23861b){const _0x38329f=_0x34d593,_0x59900e=['BCT',_0x38329f(0x3c7)];try{await axios['get'](_0x38329f(0x373),{'headers':{'X-CMC_PRO_API_KEY':_0x23861b},'params':{'symbol':_0x59900e[_0x38329f(0x3a1)]()}});}catch(_0x332cb1){_0x332cb1[_0x38329f(0x3a1)]()[_0x38329f(0x324)]('status\x20code\x20401')?(io['to'](_0x38329f(0x282))[_0x38329f(0x2db)]('notification','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x38329f(0x23e)](_0x38329f(0x320))):(io['to'](_0x38329f(0x282))['emit'](_0x38329f(0x3de),_0x38329f(0x34a)),logger[_0x38329f(0x23e)](_0x38329f(0x34a)),logger['debug'](_0x38329f(0x250),_0x332cb1[_0x38329f(0x3a1)]()+_0x38329f(0x2ae)+_0x332cb1['code']));return;}logger[_0x38329f(0x2e2)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x1c5e34,_0x3521a3){const _0x1e8076=_0x34d593;dbSettings[_0x1e8076(0x26d)](_0x1e8076(0x2d7)+_0x1c5e34,_0x3521a3)[_0x1e8076(0x285)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x1e8076(0x1fd),cleanSettings());}function storeSecure(_0xfc1d92){const _0x3cfe33=_0x34d593;dbSecure['get'](_0x3cfe33(0x2ec))[_0x3cfe33(0x2d1)](_0xfc1d92)[_0x3cfe33(0x285)](),secure=_0xfc1d92;}function addBlacklist(_0x5f3a92){const _0x4e5d32=_0x34d593;cleanBlacklist();let _0x56543;devices[_0x5f3a92][_0x4e5d32(0x2d9)]?_0x56543=Math[_0x4e5d32(0x325)](devices[_0x5f3a92][_0x4e5d32(0x2d9)][_0x4e5d32(0x39e)],loginExpiry):_0x56543=loginExpiry,dbSecure[_0x4e5d32(0x271)]('blacklist')[_0x4e5d32(0x2d1)]({'expiry':new Date()[_0x4e5d32(0x3f0)]()+_0x56543*0x3c*0x3e8,'token':devices[_0x5f3a92]['access'][_0x4e5d32(0x2de)]})[_0x4e5d32(0x285)](),blacklist=dbSecure['get'](_0x4e5d32(0x232))['value']();}function _0x10c2(){const _0x5626a9=['child_process','Network\x20Interfaces:','6b67f3d61ee94b8f5c80b4affef4c4d9','set','10841877FLOJuK','login2fa_','new','get','disconnect','kill','reset-password','16071RcfZMK','User\x20has\x20been\x20validated','Unauthorized\x20login\x20attempt\x20(timeout)','all','connected','whitelist','names','length','temporary\x20access\x20timeout','bots','storeFiat','HTML','backupfile','botmanager','Error\x20while\x20deleting\x20config\x20files:\x20','assign','write','join','keys','version.json','message','uuid','telegramToken','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','\x1b[0m','lowdb/adapters/FileSync','referer','generate','::ffff:127.0.0.1','delete-alerts','0.0.0','logout','range','mtime','15\x20min','logs/','bot','Bot\x20','1000','files','Token\x20blacklisted',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','storeHeadless','pidRefreshToken','init','getDate','chat','exec','/disable\x20-\x20disable\x20notifications\x0a','5\x20min','user','silentRestart','botname','axios','Unauthorized\x20attempt\x20to\x20store\x20configuration','sendPortfolioTelegram','unlinkSync','\x20-\x20','store-settings','login\x20not\x20required','bot-','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','headers','reload','/upload-backup','sha256','config_orders','bbPassword','getSeconds','forEach','pidExpireLogin','telegrammsg','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','store-fiat','tkn','find','replace','/restart\x20-\x20restart\x20bot(s)\x0a','RSA-OAEP','Telegram\x20error:','whitelistEnabled','backup/','tempaccess_5_','796wsdnAc','status','static','/download/:type','deleteHistoryAlerts','show','bbvNew','loginRequired','getMinutes','push','Invalid\x20username\x20or\x20IP\x20address','getFullYear','send','Unauthorized\x20attempt\x20to\x20delete\x20bot','sign','settings.','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','telegramIpApproval','privateKey','emit','\x20minutes','logged\x20out','token','Error:\x20Invalid\x20argument\x20','login\x20token\x20generated','clientip','debug','cancel-loading','existsSync','get-starting-balances','Unauthorized\x20attempt\x20to\x20update\x20settings','/metrics\x20-\x20show\x20bot\x20performance\x0a','isValid','decrypt','hybrid-crypto-js','simple','secure','internal','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','fork','Restore\x20process\x20aborted','/:bot/coins','63JLCzcT','host','verify','success','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','encryptedUuid','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Setting\x20access:\x20','uuid-random','warning','backup','cloneDeep','.zip','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','post','removeAllListeners','allow','mixpanel','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','readFileSync','userid','new-disabled','number','\x20(1)','/off\x20-\x20stop\x20bot(s)\x0a','lowdb','match','tempaccess_reject_','stop','bb-config.json','secret','/names\x20-\x20show\x20bot\x20names\x0a','restore-backup-file','3069280pwRHxS','\x1b[33m','auth','telegramEnabled','catch','#RES#\x20if\x20running\x20on\x20server','bb-secure.json','login\x20token\x20valid','emitHistory','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','messages','Markdown','Restarting\x20(silent)\x20Bot\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','RSA','Logged\x20out\x20user\x20...','restore_no_','includes','max','File\x20uploaded','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','ipv6','Unauthorized\x20attempt\x20to\x20add\x20bot','telegram','Password\x20reset\x20rejected','clients','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','-----------------------------------------------------------------------------------','store','staging','backup-files','No\x20authentication\x20token','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20',')\x20\x20\x20|\x20Bot\x20','version','manual','publicKey','|@|','remove','accept','\x20|\x20','2FA\x20required','<b>Telegram\x20Bot\x20Status:</b>\x0a','sort','getMonth','enable','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','zip/','sendMetricsTelegram','Your\x20installation\x20is\x20already\x20up\x20to\x20date','started','timeshift','inherit','search','\x20|\x20user:\x20...','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','restart_','access','headless','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','10015JJCscE','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','graphql-request','node','update_no','binary','access\x20timeout','startsWith','config_alerts','address','filter','Backup\x20file\x20unzipped\x20and\x20stored','telegraf','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','getPortfolio','535158FsvtWY','output-001.log','-events.json','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','running','restart','timestamp','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','sortBy','title','name','login','Unauthorized\x20attempt\x20to\x20confirm\x20message','error','output-003.log','Unauthorized\x20attempt\x20to\x20get\x20messages','add','any','telegramUsername','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','toIPv4MappedAddress','exit','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20bot','value','botID','Session\x20expired\x20for\x20user\x20...','apiSecret','Backup\x20file\x20uploaded','config/','/update\x20-\x20update\x20Balance\x20Bot\x0a','server','once','2FA','update',':\x20Bot\x20Mgr\x20>\x20','Yes','/:bot/configuration','reinstall','Ok,\x20will\x20send\x20order\x20notifications\x20only','toggle_','argv','Allow\x20login\x20from\x20IP\x20address\x20','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','track','SIGTERM','date-fns','All\x20bots','telegramEvents','/:bot/performance','2FA\x20login\x20required','Bot\x20Mgr\x20>\x20','show-config','reinstall_yes','Unauthorized\x20attempt\x20to\x20get\x20portfolio','hasOwnProperty','bb-settings.json','config','event','No\x20bots\x20running\x20right\x20now','editMessageReplyMarkup','expiry','942551tncYJc','metrics_','toString','\x20mode','latestversion','data','/on\x20-\x20start\x20bot(s)\x0a','start','23060nGLjDk','order','Starting\x20Balance\x20Bot\x20reinstallation','/:bot/portfolio','\x1b[35m','Restoring\x20bot(s)\x20from\x20backup','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','ipaddr.js','writeFileSync','yes','/:bot','username','\x20only\x0a','orders','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','endsWith','$1_$2_$3','[ip-address]','copyFileSync','params','getHours','enabled','apiKey','socket','then','reinstall-bb','8CKcMaz','getStartingBalances','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','live','type','backup-full.zip','ETH','statSync','_data','address\x20already\x20in\x20use','padStart','Restarting\x20Bot\x20','output-002.log','defaults','get-portfolio','2FA\x20login\x20token\x20generated','placeOrder','Unauthorized\x20attempt\x20to\x20log\x20out','Notifications\x20enabled\x0a','confirm-message','format','reason','api-eu.mixpanel.com','Restore\x20backup\x20file\x20','store-configuration','portfolio_','\x1b[31m','Invalid\x20authentication\x20token\x20(1)','marketcapApi','notification','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/enable\x20-\x20enable\x20notifications\x0a','on_','lastmsgemitted','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','createServer','http','Starting\x20#RED#Balance\x20Bot\x20v','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','***','reset-history','inlineKeyboard','get-messages','initclient','Notifications\x20disabled\x0a','password','getTime','test','\x20|\x20client:\x20...','stringify','\x20>\x20','Enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20download\x20','exp','rmSync','kind','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Invalid\x20IP\x20address','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','login\x20required','portfolio','family','settings','command','-config.json','NTBA_FIX_319','mode','isDirectory','backup-full@','disabled','util','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','*$1*','build','showname','request','mkdirSync','cancelLoading','SIGINT','bbvReceive','config_all','connection','update-bot','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','temporary\x20access\x20not\x20allowed','backup-full','entries','-results.json','express-fileupload','yargs/yargs','socket.io','tempaccess_15_','reject','apply','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','off_','restore_yes_','127.0.0.1','split','\x20(2)','/start','temp/','Invalid\x20authentication\x20token\x20(2)','callback','log','update-bb','sockets','parse','hashSync','Notifications\x20enabled','onepagemode','place-order','alerts','5456445Irrguf','auto','blacklist','3000','disable','\x1b[36m','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','port','handshake','function','telegramChatId','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','listen','full','Starting\x20Balance\x20Bot\x20update','Ok,\x20will\x20send\x20alert\x20notifications\x20only','remoteAddress','store-headless','output-000.log','index.html','resetpw_yes','sendFile','isIPv4MappedAddress','Access\x20enabled\x20for\x20','lastmsgtelegram','crypto','************','(((.+)+)+)+$','from','stopped','Starting\x20(','Error\x20details:','update_yes','toggleBotMode','Failed\x20to\x20download\x20','use','delete-bot','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','storeConfiguration','slice','apiPassword','conn','\x20to\x20','f2aRequired','bbUsername','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','temporary\x20token\x20generated','reply','(staging)','#RES#\x20if\x20running\x20locally\x0a','bot.js','readdirSync','text','action','button','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','path'];_0x10c2=function(){return _0x5626a9;};return _0x10c2();}function cleanBlacklist(){const _0x1dc898=_0x34d593;let _0x340ff4=dbSecure[_0x1dc898(0x271)](_0x1dc898(0x232))[_0x1dc898(0x2fd)]()['value'](),_0x5b2416=new Date()[_0x1dc898(0x3f0)]();_0x340ff4[_0x1dc898(0x2ba)](_0x331828=>{const _0x5cd8c7=_0x1dc898;_0x331828[_0x5cd8c7(0x39e)]<_0x5b2416&&dbSecure[_0x5cd8c7(0x271)](_0x5cd8c7(0x232))['remove']({'expiry':_0x331828[_0x5cd8c7(0x39e)]})[_0x5cd8c7(0x285)]();});}function initStates(){const _0x5a51ba=_0x34d593;let _0x1bcd27=getConfiguration();_0x1bcd27[_0x5a51ba(0x2ba)](_0x22d5fe=>{const _0x518790=_0x5a51ba;_0x22d5fe[_0x518790(0x3c4)]=_0x518790(0x24e);}),storeConfiguration(_0x1bcd27);}function onKeys(){const _0x362785=new RSA();return new Promise(_0x20f582=>{const _0x5c6686=_0x2ebb;_0x362785['generateKeyPairAsync']()[_0x5c6686(0x3bf)](_0x3d68d3=>{_0x20f582(_0x3d68d3);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3f6760=_0x34d593;let _0x37b75a=getSettings(),_0x3f5903=![];!_0x37b75a[_0x3f6760(0x398)](_0x3f6760(0x249))&&(_0x37b75a['lastmsgtelegram']=0x0,_0x3f5903=!![]);!_0x37b75a['hasOwnProperty'](_0x3f6760(0x3e3))&&(_0x37b75a[_0x3f6760(0x3e3)]=0x0,_0x3f5903=!![]);!_0x37b75a['hasOwnProperty'](_0x3f6760(0x3a3))&&(_0x37b75a[_0x3f6760(0x3a3)]='0.0.0',_0x3f5903=!![]);!_0x37b75a[_0x3f6760(0x398)](_0x3f6760(0x22d))&&(_0x37b75a['onepagemode']=![],_0x3f5903=!![]);!_0x37b75a[_0x3f6760(0x398)](_0x3f6760(0x3dd))&&(_0x37b75a[_0x3f6760(0x3dd)]='',_0x3f5903=!![]);if(_0x3f5903)storeSettings(_0x37b75a);try{fs[_0x3f6760(0x264)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x4ec1e8=>{const _0x5df3fd=_0x3f6760;if(!_0x4ec1e8[_0x5df3fd(0x202)]()){if(!_0x4ec1e8[_0x5df3fd(0x36a)]['startsWith']('backup-full@'))fs[_0x5df3fd(0x2ad)](configbackuppath+_0x4ec1e8[_0x5df3fd(0x36a)]);}else fs[_0x5df3fd(0x1f4)](configbackuppath+_0x4ec1e8[_0x5df3fd(0x36a)],{'recursive':!![]});});}catch(_0x8bcf35){logger[_0x3f6760(0x2e2)]('Error\x20removing\x20old\x20backup\x20files:',_0x8bcf35);}}function storeConfiguration(_0x325201){const _0x5db384=_0x34d593;dbConfig[_0x5db384(0x271)](_0x5db384(0x27e))[_0x5db384(0x339)]()[_0x5db384(0x285)](),dbConfig['get'](_0x5db384(0x27e))[_0x5db384(0x2d1)](..._0x325201)[_0x5db384(0x285)](),config=_0x325201;}async function resetPassword(){const _0x30731a=_0x34d593;if(tgBot&&settings[_0x30731a(0x23a)]){const _0x1551aa=Markup['inlineKeyboard']([Markup[_0x30731a(0x267)]['callback'](_0x30731a(0x3b0),_0x30731a(0x245)),Markup[_0x30731a(0x267)][_0x30731a(0x226)]('no','resetpw_no')]);await sendTelegram(settings[_0x30731a(0x23a)],_0x30731a(0x351),_0x1551aa),tgBot[_0x30731a(0x266)](/resetpw_(.+)/,async _0x4a8314=>{const _0x276c67=_0x30731a,_0x10afa4=_0x4a8314[_0x276c67(0x30c)][0x1];_0x4a8314['editMessageReplyMarkup']();if(_0x10afa4!='no'){const _0x523b39=0xf,_0x5047df=_0x276c67(0x327),_0x89016f=Array[_0x276c67(0x24d)](crypto['randomFillSync'](new Uint32Array(_0x523b39)))['map'](_0x387ed9=>_0x5047df[_0x387ed9%_0x5047df[_0x276c67(0x27c)]])[_0x276c67(0x286)](''),_0x2eac7e=bcrypt[_0x276c67(0x22b)](_0x89016f,saltRounds);storeSettings({'bbPassword':_0x2eac7e}),await sendTelegram(_0x4a8314[_0x276c67(0x2a3)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x89016f,{'parse_mode':_0x276c67(0x280)});}else await sendTelegram(_0x4a8314[_0x276c67(0x2a3)]['id'],_0x276c67(0x32b));});}}async function confirmRestore(_0x4dbcaf,_0x50bbe1){const _0x4cb261=_0x34d593;io['to'](_0x4cb261(0x282))[_0x4cb261(0x2db)](_0x4cb261(0x3de),_0x4cb261(0x38b),_0x4cb261(0x2f5));if(tgBot&&settings[_0x4cb261(0x23a)]){const _0x582639=uuidRandom();tmpStorage[_0x582639]={'path':_0x4dbcaf,'filename':_0x50bbe1};const _0x1488b5=Markup['inlineKeyboard']([Markup[_0x4cb261(0x267)]['callback'](_0x4cb261(0x3b0),_0x4cb261(0x21f)+_0x582639),Markup['button'][_0x4cb261(0x226)]('no',_0x4cb261(0x323)+_0x582639)]);await sendTelegram(settings[_0x4cb261(0x23a)],_0x4cb261(0x256),_0x1488b5),tgBot[_0x4cb261(0x266)](/restore_(.+)_(.+)/,async _0x5dbd8f=>{const _0x37efab=_0x4cb261,_0x91dd64=_0x5dbd8f[_0x37efab(0x30c)][0x1],_0x41cf58=_0x5dbd8f[_0x37efab(0x30c)][0x2],{path:_0x17d23,filename:_0x3935cc}=tmpStorage[_0x41cf58];delete tmpStorage[_0x41cf58],_0x5dbd8f[_0x37efab(0x39d)](),_0x91dd64==_0x37efab(0x3b0)?(logger[_0x37efab(0x2e2)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x5dbd8f[_0x37efab(0x2a3)]['id'],_0x37efab(0x3ac),{'parse_mode':_0x37efab(0x280)}),unzipFile(_0x17d23,_0x3935cc)):(logger[_0x37efab(0x2e2)](_0x37efab(0x2f0)),await sendTelegram(_0x5dbd8f[_0x37efab(0x2a3)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x313ca7=_0x34d593,_0x55706b=new Date();return _0x55706b[_0x313ca7(0x2d3)]()+'/'+(_0x55706b[_0x313ca7(0x33f)]()+0x1)[_0x313ca7(0x3a1)]()[_0x313ca7(0x3cb)](0x2,'0')+'/'+_0x55706b[_0x313ca7(0x2a2)]()['toString']()[_0x313ca7(0x3cb)](0x2,'0')+'\x20'+_0x55706b[_0x313ca7(0x3bb)]()['toString']()[_0x313ca7(0x3cb)](0x2,'0')+':'+_0x55706b['getMinutes']()[_0x313ca7(0x3a1)]()[_0x313ca7(0x3cb)](0x2,'0')+':'+_0x55706b[_0x313ca7(0x2b9)]()[_0x313ca7(0x3a1)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x13a391=_0x34d593,_0x3d6b61=shiftedTime();return _0x3d6b61[_0x13a391(0x2d3)]()+'/'+(_0x3d6b61['getMonth']()+0x1)[_0x13a391(0x3a1)]()[_0x13a391(0x3cb)](0x2,'0')+'/'+_0x3d6b61[_0x13a391(0x2a2)]()[_0x13a391(0x3a1)]()['padStart'](0x2,'0')+'\x20'+_0x3d6b61[_0x13a391(0x3bb)]()[_0x13a391(0x3a1)]()[_0x13a391(0x3cb)](0x2,'0')+':'+_0x3d6b61[_0x13a391(0x2d0)]()['toString']()['padStart'](0x2,'0')+':'+_0x3d6b61[_0x13a391(0x2b9)]()[_0x13a391(0x3a1)]()[_0x13a391(0x3cb)](0x2,'0');}function getCleanTimeStamp(){const _0x440e03=_0x34d593,_0x7b8072=shiftedTime();return _0x7b8072[_0x440e03(0x2d3)]()+(_0x7b8072['getMonth']()+0x1)[_0x440e03(0x3a1)]()[_0x440e03(0x3cb)](0x2,'0')+_0x7b8072[_0x440e03(0x2a2)]()[_0x440e03(0x3a1)]()[_0x440e03(0x3cb)](0x2,'0')+'-'+_0x7b8072[_0x440e03(0x3bb)]()['toString']()[_0x440e03(0x3cb)](0x2,'0')+_0x7b8072[_0x440e03(0x2d0)]()['toString']()['padStart'](0x2,'0')+_0x7b8072['getSeconds']()[_0x440e03(0x3a1)]()[_0x440e03(0x3cb)](0x2,'0');}function shiftedTime(){const _0x4ed9b5=_0x34d593,_0x859c16=new Date();let _0x2b679e=_0x859c16;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x2b679e=fns[_0x4ed9b5(0x370)](_0x859c16,{'hours':settings[_0x4ed9b5(0x346)]});return _0x2b679e;}async function startScheduler(){const _0x1ac042=new Date()['getUTCHours'](),_0x2b4cf8=shiftedTime()['getHours']();_0x2b4cf8==0x4&&backupConfigFiles(),_0x2b4cf8==0xb&&restartAllBots(),_0x2b4cf8==0x0&&rotateLogFiles(),_0x1ac042%0x6==0x0&&triggerAnalytics(),_0x1ac042%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5d36de){const _0x4c727e=_0x34d593;logger[_0x4c727e(0x2e2)](_0x4c727e(0x3d8)+_0x5d36de);const _0x495dcd=getBotsWithMode();_0x495dcd['length']>0x0?confirmRestore(configbackuppath,_0x5d36de):unzipFile(configbackuppath,_0x5d36de);}async function getBackupFiles(_0x30ec84=null){const _0x25fde0=_0x34d593;let _0x196eba=[],_0x14f200=fs[_0x25fde0(0x264)](configbackuppath,{'withFileTypes':!![]});_0x14f200[_0x25fde0(0x33e)]((_0x44d46a,_0x5c6535)=>_0x44d46a[_0x25fde0(0x36a)]<_0x5c6535[_0x25fde0(0x36a)]?0x1:_0x5c6535['name']<_0x44d46a[_0x25fde0(0x36a)]?-0x1:0x0),_0x14f200[_0x25fde0(0x2ba)](_0x20f86c=>{const _0x517739=_0x25fde0;if(!_0x20f86c[_0x517739(0x202)]()&&_0x20f86c[_0x517739(0x36a)]['startsWith'](_0x517739(0x203))&&_0x20f86c[_0x517739(0x36a)][_0x517739(0x3b6)]('.zip')){const _0x76c7aa=formatDate(fs[_0x517739(0x3c8)](configbackuppath+_0x20f86c['name'])[_0x517739(0x296)]);_0x196eba['push']({'name':_0x20f86c[_0x517739(0x36a)],'mtime':_0x76c7aa});}});if(_0x30ec84)io['to'](_0x30ec84)['emit'](_0x25fde0(0x331),_0x196eba);else return _0x196eba;}async function backupConfigFiles(){const _0x54ede7=_0x34d593;await zipFiles(_0x54ede7(0x214));const _0x58f5b6=getCleanTimeStamp();fs[_0x54ede7(0x3b9)](zippath+_0x54ede7(0x3c6),configbackuppath+(_0x54ede7(0x203)+_0x58f5b6+_0x54ede7(0x2fe)));let _0xa6b0fd=fs[_0x54ede7(0x264)](configbackuppath,{'withFileTypes':!![]});_0xa6b0fd[_0x54ede7(0x33e)]((_0x533c97,_0x1d5072)=>_0x533c97[_0x54ede7(0x36a)]<_0x1d5072[_0x54ede7(0x36a)]?0x1:_0x1d5072[_0x54ede7(0x36a)]<_0x533c97[_0x54ede7(0x36a)]?-0x1:0x0),_0xa6b0fd['length']>maxBackups&&fs[_0x54ede7(0x2ad)](configbackuppath+_0xa6b0fd[_0xa6b0fd[_0x54ede7(0x27c)]-0x1][_0x54ede7(0x36a)]);}function rotateLogFiles(){const _0x40d5f5=_0x34d593,_0x4f911b=fs[_0x40d5f5(0x3c8)](logspath+_0x40d5f5(0x243)),_0x423fb2=_0x4f911b['size']/0x400;if(_0x423fb2>0x64){let _0x5293aa=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x5293aa[_0x40d5f5(0x33e)]((_0x1e80f0,_0x768478)=>_0x1e80f0[_0x40d5f5(0x36a)]<_0x768478['name']?0x1:_0x768478[_0x40d5f5(0x36a)]<_0x1e80f0['name']?-0x1:0x0),_0x5293aa[_0x40d5f5(0x2ba)](_0x28de5c=>{const _0x5df435=_0x40d5f5;if(_0x28de5c['name']==_0x5df435(0x3cd))fs['copyFileSync'](logspath+_0x28de5c['name'],logspath+_0x5df435(0x36e));if(_0x28de5c[_0x5df435(0x36a)]==_0x5df435(0x360))fs['copyFileSync'](logspath+_0x28de5c[_0x5df435(0x36a)],logspath+_0x5df435(0x3cd));_0x28de5c['name']==_0x5df435(0x243)&&(fs['copyFileSync'](logspath+_0x28de5c['name'],logspath+_0x5df435(0x360)),fs[_0x5df435(0x3af)](logspath+_0x28de5c[_0x5df435(0x36a)],''));});}}async function zipFiles(_0x278717){const _0x1db76d=_0x34d593;let _0x33c7aa;if(_0x278717=='logs')_0x33c7aa=logspath;if(_0x278717==_0x1db76d(0x2fc))_0x33c7aa=configpath;if(_0x278717==_0x1db76d(0x214))_0x33c7aa=configpath;let _0x259a95=fs[_0x1db76d(0x264)](_0x33c7aa,{'withFileTypes':!![]});const _0x1f9450=new require('node-zip')();_0x259a95[_0x1db76d(0x2ba)](_0x2add83=>{const _0x4d3112=_0x1db76d;if(!_0x2add83[_0x4d3112(0x202)]()){let _0x3989ff=fs[_0x4d3112(0x305)](_0x33c7aa+_0x2add83['name']);if(_0x278717==_0x4d3112(0x2fc)){const _0x577852=/^bot-[0-9]{3}-config.json$/,_0x13bef5=_0x577852[_0x4d3112(0x3f1)](_0x2add83[_0x4d3112(0x36a)]);if(_0x13bef5){const _0x1080bd=JSON[_0x4d3112(0x22a)](_0x3989ff);if(_0x1080bd[_0x4d3112(0x299)][0x0]){_0x1080bd[_0x4d3112(0x299)][0x0]['apiKey']=_0x4d3112(0x3e9),_0x1080bd['bot'][0x0][_0x4d3112(0x37b)]=_0x4d3112(0x3e9);if(_0x1080bd[_0x4d3112(0x299)][0x0]['apiPassword'])_0x1080bd[_0x4d3112(0x299)][0x0][_0x4d3112(0x259)]=_0x4d3112(0x3e9);}_0x3989ff=JSON[_0x4d3112(0x3f3)](_0x1080bd,null,0x2);}if(_0x2add83[_0x4d3112(0x36a)]==_0x4d3112(0x399)){const _0x3ade35=JSON[_0x4d3112(0x22a)](_0x3989ff);if(_0x3ade35[_0x4d3112(0x1fd)][_0x4d3112(0x2cf)])_0x3ade35[_0x4d3112(0x1fd)]['loginRequired']=![];if(_0x3ade35[_0x4d3112(0x1fd)][_0x4d3112(0x2b8)])_0x3ade35['settings'][_0x4d3112(0x2b8)]=_0x4d3112(0x3e9);if(_0x3ade35[_0x4d3112(0x1fd)]['telegramToken'])_0x3ade35[_0x4d3112(0x1fd)]['telegramToken']=_0x4d3112(0x3e9);if(_0x3ade35['settings']['telegramChatId'])_0x3ade35['settings'][_0x4d3112(0x23a)]=null;if(_0x3ade35['settings']['marketcapApi'])_0x3ade35[_0x4d3112(0x1fd)][_0x4d3112(0x3dd)]=_0x4d3112(0x3e9);_0x3989ff=JSON[_0x4d3112(0x3f3)](_0x3ade35,null,0x2);}if(_0x2add83[_0x4d3112(0x36a)]!=_0x4d3112(0x319))_0x1f9450['file'](_0x2add83['name'],_0x3989ff);}else _0x1f9450['file'](_0x2add83[_0x4d3112(0x36a)],_0x3989ff);}});const _0x5ef47f=_0x1f9450[_0x1db76d(0x290)]({'base64':![],'compression':'DEFLATE'});fs[_0x1db76d(0x3af)](zippath+(_0x278717+'.zip'),_0x5ef47f,_0x1db76d(0x355));}async function unzipFile(_0x43d7d9,_0x1bddda){const _0x9f6efc=_0x34d593;fs[_0x9f6efc(0x264)](configpath,{'withFileTypes':!![]})[_0x9f6efc(0x2ba)](_0x593565=>{const _0x210662=_0x9f6efc;if(!_0x593565[_0x210662(0x202)]())fs[_0x210662(0x1f4)](configpath+_0x593565[_0x210662(0x36a)]);});const _0x5c523b=fs[_0x9f6efc(0x305)](_0x43d7d9+_0x1bddda,'binary'),_0x2bd0d6=new require('node-zip')(_0x5c523b,{'base64':![],'checkCRC32':!![]});Object[_0x9f6efc(0x287)](_0x2bd0d6[_0x9f6efc(0x29c)])[_0x9f6efc(0x2ba)](_0x1ee56b=>{const _0x4bd3f8=_0x9f6efc,_0x1f28c7=_0x2bd0d6['files'][_0x1ee56b];fs[_0x4bd3f8(0x3af)](configpath+_0x1f28c7[_0x4bd3f8(0x36a)],_0x1f28c7[_0x4bd3f8(0x3c9)]);}),fs[_0x9f6efc(0x264)](temppath,{'withFileTypes':!![]})['forEach'](_0x581d70=>{const _0xe45ab9=_0x9f6efc;if(!_0x581d70[_0xe45ab9(0x202)]())fs[_0xe45ab9(0x1f4)](temppath+_0x581d70[_0xe45ab9(0x36a)]);}),logger[_0x9f6efc(0x2e2)](_0x9f6efc(0x35b)),process['send']({'restore':!![]},_0x2a3c1a=>{});}async function getPublicIp(){const _0x7462a3=_0x34d593;try{const _0x1da3a8=await axios[_0x7462a3(0x271)]('https://api.ipify.org?format=json');publicip=_0x1da3a8[_0x7462a3(0x3a4)]['ip'];}catch(_0x228910){}}async function triggerAnalytics(){const _0x42528d=_0x34d593;if(!publicip)await getPublicIp();const _0x968b97=getBotsWithMode();let _0x5d70b3=0x0;_0x968b97['forEach'](_0x566a93=>{const _0x52ca4b=_0x2ebb;if(_0x566a93['status']===_0x52ca4b(0x3bc))_0x5d70b3++;});const _0x3ec630=getBotExchanges();mixpanel[_0x42528d(0x38d)]('Server',{'distinct_id':settings[_0x42528d(0x306)],'ip':publicip,'version':serverversion,'numbots':_0x968b97['length'],'numbotsenabled':_0x5d70b3,'exchanges':_0x3ec630,'environment':environment});}async function getMessages(){const _0x22ef9f=_0x34d593,_0x5c4fc1=_0x22ef9f(0x362),_0x1f84fa=new GraphQLClient(_0x5c4fc1),_0x5b102e={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5b5acc=serverversion[_0x22ef9f(0x221)]('.'),_0x42acd1=_0x5b5acc[0x0]+'.'+_0x5b5acc[0x1],_0x51e701=Math['min'](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x4124fd={'last':parseInt(_0x51e701),'bbm':_0x42acd1},_0xf65460=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5e2cae;try{_0x5e2cae=await _0x1f84fa[_0x22ef9f(0x20a)](_0xf65460,_0x4124fd,_0x5b102e);}catch(_0x25c774){}if(_0x5e2cae&&_0x5e2cae[_0x22ef9f(0x31d)]){let _0xbb1ec9=settings[_0x22ef9f(0x249)];newMessages=[];for(const _0x457bd0 of _0x5e2cae[_0x22ef9f(0x31d)]){newMessages[_0x22ef9f(0x2d1)](_0x457bd0);let _0x2e569b=![];_0x457bd0['bbvNew']&&(updateSetting(_0x22ef9f(0x3a3),_0x457bd0[_0x22ef9f(0x2ce)]),_0x2e569b=isNewerVersion(serverversion,_0x457bd0[_0x22ef9f(0x2ce)])||serverversion==_0x457bd0[_0x22ef9f(0x2ce)]);if(!_0x2e569b&&_0x457bd0[_0x22ef9f(0x308)]>_0xbb1ec9){if(_0x457bd0[_0x22ef9f(0x20e)]===_0x22ef9f(0x371)||serverversion[_0x22ef9f(0x357)](_0x457bd0['bbvReceive'])){let _0xa2077e=''+_0x457bd0[_0x22ef9f(0x369)]+'\x0a\x0a'+_0x457bd0[_0x22ef9f(0x289)];const _0x143286=await sendTelegramMsg(toTelegramMarkdown(_0xa2077e),_0x22ef9f(0x31e));if(_0x143286)_0xbb1ec9=_0x457bd0['number'];}}}updateAvailable=isNewerVersion(settings[_0x22ef9f(0x3a3)],serverversion),updateSetting(_0x22ef9f(0x249),_0xbb1ec9),emitMessages();}}function emitMessages(){const _0x3eb6d1=_0x34d593,_0x149a18=settings[_0x3eb6d1(0x3e3)];let _0x2affe8=[];newMessages[_0x3eb6d1(0x2ba)](_0x22c969=>{const _0x5eddb1=_0x3eb6d1;_0x22c969[_0x5eddb1(0x308)]>_0x149a18&&_0x2affe8[_0x5eddb1(0x2d1)](_0x22c969);}),_0x2affe8['length']>0x0&&getAllClients()[_0x3eb6d1(0x2ba)](_0x4f9ec5=>{const _0x3f32c4=_0x3eb6d1;getSocket(_0x4f9ec5['id'])[_0x3f32c4(0x2db)](_0x3f32c4(0x289),_0x2affe8);});}function confirmMessage(_0x5e43b9){const _0x46d672=_0x34d593;updateSetting(_0x46d672(0x3e3),Number(_0x5e43b9));}function isNewerVersion(_0x5d1c22,_0x5b5dd5){const _0x4a6844=_0x34d593,_0x417206=_0x5b5dd5[_0x4a6844(0x221)]('.'),_0x1b5cee=_0x5d1c22['split']('.');for(var _0x370d7b=0x0;_0x370d7b<_0x1b5cee[_0x4a6844(0x27c)];_0x370d7b++){const _0x2e8772=~~_0x1b5cee[_0x370d7b],_0x23a7ff=~~_0x417206[_0x370d7b];if(_0x2e8772>_0x23a7ff)return!![];if(_0x2e8772<_0x23a7ff)return![];}return![];}function toTelegramMarkdown(_0x1e5139){const _0x44afb3=_0x34d593,_0x1ce325=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x335408=/\*{2}(.+?)\*{2}/gim;return _0x1e5139=_0x1e5139['replace'](_0x1ce325,_0x44afb3(0x3b7))[_0x44afb3(0x2c1)](_0x335408,_0x44afb3(0x207)),_0x1e5139;}async function validateConfigFile(){const _0x433549=_0x34d593,_0x8de757=dbConfig[_0x433549(0x271)]('bots')[_0x433549(0x368)](_0x433549(0x379))[_0x433549(0x378)]()||[];if(_0x8de757[_0x433549(0x27c)]==0x0){let _0x405eaa=0x0,_0xab2072=[];const _0x6e2e0e=/^bot-([0-9]{3})-config.json$/,_0x2dd6b2=fs[_0x433549(0x264)](configpath);_0x2dd6b2[_0x433549(0x2ba)](_0xad2f91=>{const _0x1f4ef7=_0x433549,_0x3e1447=_0x6e2e0e[_0x1f4ef7(0x2a4)](_0xad2f91);if(_0x3e1447){const _0x5a45f2=_0x3e1447[0x1];let _0x249dbc=getBotAttributes(_0x5a45f2);_0xab2072[_0x1f4ef7(0x2d1)]({'botID':_0x5a45f2,'botname':_0x249dbc[_0x1f4ef7(0x2a9)],'status':'disabled','live':_0x1f4ef7(0x24e)}),_0x405eaa++;}}),_0x405eaa!=0x0&&(dbConfig[_0x433549(0x271)](_0x433549(0x27e))['assign'](_0xab2072)[_0x433549(0x285)](),config=_0xab2072,restoredConfigFile=_0x405eaa);}}async function restoreConfigNotify(_0x2ea4dd){const _0xa79eaf=_0x34d593;let _0x4a9db0;if(restoredConfigFile==0x1)_0x4a9db0=_0xa79eaf(0x31c);else _0x4a9db0=_0xa79eaf(0x28c);if(_0x2ea4dd)io['to']('botmanager')[_0xa79eaf(0x2db)](_0xa79eaf(0x3de),_0x4a9db0);else{logger[_0xa79eaf(0x2eb)](_0xa79eaf(0x32e)),logger[_0xa79eaf(0x2eb)](_0x4a9db0),logger[_0xa79eaf(0x2eb)](_0xa79eaf(0x32e)),logger[_0xa79eaf(0x2eb)]('');if(tgBot&&settings[_0xa79eaf(0x23a)]&&settings[_0xa79eaf(0x391)]!='orders')await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x4a9db0);}}function validateCredentials(_0x45bbb7,_0x3eda2e){const _0x18f2ed=_0x34d593;if(_0x45bbb7[_0x18f2ed(0x3b2)]==settings[_0x18f2ed(0x25d)]&&bcrypt['compareSync'](_0x45bbb7[_0x18f2ed(0x3ef)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x18f2ed(0x393),'token':null};else{const _0x4a6474=generateLoginToken(_0x3eda2e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4a6474};}}else return{'allow':![],'reason':_0x18f2ed(0x1f6),'token':null};}function refreshToken(_0x2a7f13){const _0x342a96=_0x34d593,_0x566f2c=generateLoginToken(_0x2a7f13);return{'allow':!![],'reason':_0x342a96(0x2e0),'token':_0x566f2c};}function validateAccess(_0x131d0e,_0x455562,_0x589e16){const _0x2d79f8=_0x34d593,_0x1977d6=_0x589e16?_0x589e16:devices[_0x455562]['ip'];let _0x5c931d;const _0x4a28f3=_0x3104c1=>{const _0x4f298e=_0x2ebb;if(settings[_0x4f298e(0x2cf)]){if(settings[_0x4f298e(0x25c)]){if(telegram2FaApproved(_0x455562)){const _0x216b30=generateLoginToken(_0x455562);return{'allow':!![],'reason':_0x4f298e(0x3d0),'token':_0x216b30};}else return{'allow':![],'reason':_0x4f298e(0x1fa),'token':null};}else return _0x5c931d=validToken(_0x3104c1,_0x455562),_0x5c931d[_0x4f298e(0x398)](_0x4f298e(0x2f5))?{'allow':!![],'reason':_0x4f298e(0x31a),'token':_0x3104c1}:{'allow':![],'reason':_0x4f298e(0x1fa),'token':null};}else return{'allow':!![],'reason':_0x4f298e(0x2b0),'token':null};};if(settings[_0x2d79f8(0x2c5)]){let _0x1b7e81=[...settings[_0x2d79f8(0x27a)],'::1',_0x2d79f8(0x291),_0x2d79f8(0x220)];if(_0x1b7e81[_0x2d79f8(0x324)](_0x1977d6))return _0x4a28f3(_0x131d0e);else{_0x5c931d=validToken(_0x131d0e,_0x455562);if(_0x5c931d['hasOwnProperty'](_0x2d79f8(0x2f5)))return _0x4a28f3(_0x131d0e);else{if(telegramIpApproved(_0x455562)){const _0x370457=generateToken(_0x455562);return _0x5c931d=_0x4a28f3(_0x131d0e),_0x5c931d['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x370457}:_0x5c931d;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x2d79f8(0x33c),'token':null}:{'allow':![],'reason':_0x2d79f8(0x213),'token':null};}}}else return _0x4a28f3(_0x131d0e);}function timelyDecrypt(_0x6920a0,_0x2925be,_0x538f52='@'){const _0x289e0e=_0x34d593;if(_0x6920a0)try{const _0x4f2473=crypt[_0x289e0e(0x2e9)](secure[_0x289e0e(0x2da)],_0x6920a0)['message'],_0x1c4efc=_0x4f2473[_0x289e0e(0x221)](_0x538f52)[0x0],_0x3d326c=_0x4f2473[_0x289e0e(0x221)](_0x538f52)[0x1],_0x583e9e=new Date()[_0x289e0e(0x3f0)]();if(_0x2925be){if(_0x583e9e-_0x3d326c<maxSecretAge*0x3e8)return _0x1c4efc;else return![];}else return _0x1c4efc;}catch(_0x338de9){return![];}else return![];}const validToken=(_0x5da8e4,_0x2b6a6e)=>{const _0x52d1b0=_0x34d593,_0x3eb90f=devices[_0x2b6a6e]['ip'];if(!_0x5da8e4)return{'error':_0x52d1b0(0x332)};for(let _0xad524d of blacklist){if(_0xad524d[_0x52d1b0(0x2de)]==_0x5da8e4)return{'error':_0x52d1b0(0x29d)};}let _0x3fa2c6;try{_0x3fa2c6=jwt[_0x52d1b0(0x2f4)](_0x5da8e4,secure['secret']+_0x2b6a6e);}catch{return{'error':_0x52d1b0(0x3dc)};}if(!_0x3fa2c6[_0x52d1b0(0x398)]('clientip')&&!_0x3fa2c6[_0x52d1b0(0x398)](_0x52d1b0(0x3b2))||!_0x3fa2c6[_0x52d1b0(0x398)](_0x52d1b0(0x1f3)))return{'error':_0x52d1b0(0x225)};if(!_0x3fa2c6[_0x52d1b0(0x398)](_0x52d1b0(0x3b2))&&_0x3fa2c6[_0x52d1b0(0x398)](_0x52d1b0(0x2e1))){const {clientip:_0x2e1cbe}=_0x3fa2c6;return _0x3eb90f==_0x2e1cbe?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x52d1b0(0x1f8)};}else{if(_0x3fa2c6[_0x52d1b0(0x398)](_0x52d1b0(0x3b2))&&_0x3fa2c6[_0x52d1b0(0x398)](_0x52d1b0(0x2e1))){const {username:_0x5a7861,clientip:_0x14fb7c}=_0x3fa2c6;return settings[_0x52d1b0(0x25d)]==_0x5a7861&&_0x3eb90f==_0x14fb7c?{'success':_0x52d1b0(0x276)}:{'error':_0x52d1b0(0x2d2)};}}},generateLoginToken=_0x117749=>{const _0x3b7d63=_0x34d593;if(_0x117749){const _0x5125ce=devices[_0x117749]['ip'];return jwt[_0x3b7d63(0x2d6)]({'username':settings[_0x3b7d63(0x25d)],'clientip':_0x5125ce},secure[_0x3b7d63(0x310)]+_0x117749,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x275038=>{const _0x530aca=_0x34d593;if(_0x275038){const _0x4d43d4=devices[_0x275038]['ip'];return jwt[_0x530aca(0x2d6)]({'clientip':_0x4d43d4},secure['secret']+_0x275038,{'expiresIn':devices[_0x275038][_0x530aca(0x2d9)][_0x530aca(0x39e)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5373a8=>{const _0x455457=_0x34d593;let _0x49de77=![];return devices[_0x5373a8][_0x455457(0x2d9)]&&devices[_0x5373a8][_0x455457(0x2d9)][_0x455457(0x39e)]!='reject'&&(_0x49de77=devices[_0x5373a8][_0x455457(0x2d9)][_0x455457(0x2e1)]==devices[_0x5373a8]['ip']&&new Date()[_0x455457(0x3f0)]()-devices[_0x5373a8][_0x455457(0x2d9)][_0x455457(0x365)]<devices[_0x5373a8][_0x455457(0x2d9)]['expiry']*0x3c*0x3e8),_0x49de77;},telegram2FaApproved=_0x323ab7=>{const _0x4dc516=_0x34d593;let _0xaa541d=![];return devices[_0x323ab7][_0x4dc516(0x3df)]&&devices[_0x323ab7]['telegram2FaApproval'][_0x4dc516(0x39e)]!=_0x4dc516(0x21b)&&(_0xaa541d=devices[_0x323ab7][_0x4dc516(0x3df)]['clientip']==devices[_0x323ab7]['ip']&&new Date()[_0x4dc516(0x3f0)]()-devices[_0x323ab7][_0x4dc516(0x3df)][_0x4dc516(0x365)]<devices[_0x323ab7]['telegram2FaApproval'][_0x4dc516(0x39e)]*0x3c*0x3e8),_0xaa541d;},normalizeIP=_0x3c5c64=>{const _0x179976=_0x34d593;let _0x555752=null,_0x3a8754=null;if(ipaddr[_0x179976(0x2e8)](_0x3c5c64)){const _0x14e187=ipaddr[_0x179976(0x22a)](_0x3c5c64);_0x14e187[_0x179976(0x1f5)]()===_0x179976(0x328)?(_0x14e187[_0x179976(0x247)]()&&(_0x555752=_0x14e187['toIPv4Address']()[_0x179976(0x3a1)]()),_0x3a8754=_0x14e187[_0x179976(0x3a1)]()):(_0x555752=_0x14e187[_0x179976(0x3a1)](),_0x3a8754=_0x14e187[_0x179976(0x374)]()['toString']());}return{'show':_0x555752?_0x555752:_0x3a8754,'store':_0x3a8754};};function formatDate(_0x154f10){const _0xf26a10=_0x34d593;return _0x154f10['getFullYear']()+'/'+(_0x154f10['getMonth']()+0x1)[_0xf26a10(0x3a1)]()[_0xf26a10(0x3cb)](0x2,'0')+'/'+_0x154f10[_0xf26a10(0x2a2)]()['toString']()[_0xf26a10(0x3cb)](0x2,'0')+'\x20'+_0x154f10[_0xf26a10(0x3bb)]()['toString']()['padStart'](0x2,'0')+':'+_0x154f10[_0xf26a10(0x2d0)]()[_0xf26a10(0x3a1)]()[_0xf26a10(0x3cb)](0x2,'0')+':'+_0x154f10['getSeconds']()['toString']()[_0xf26a10(0x3cb)](0x2,'0');}function sleep(_0x4d8043){return new Promise(_0x1c4f74=>setTimeout(_0x1c4f74,_0x4d8043));}