const _0x502ecd=_0xd83d;(function(_0x153f68,_0x3762f9){const _0x4c2fb6=_0xd83d,_0x2f29c3=_0x153f68();while(!![]){try{const _0x3b71a=-parseInt(_0x4c2fb6(0x2a9))/0x1+-parseInt(_0x4c2fb6(0x238))/0x2+-parseInt(_0x4c2fb6(0x2ad))/0x3+parseInt(_0x4c2fb6(0x27f))/0x4*(parseInt(_0x4c2fb6(0x2a6))/0x5)+-parseInt(_0x4c2fb6(0x296))/0x6+-parseInt(_0x4c2fb6(0x19e))/0x7+parseInt(_0x4c2fb6(0x1b5))/0x8;if(_0x3b71a===_0x3762f9)break;else _0x2f29c3['push'](_0x2f29c3['shift']());}catch(_0x16a3fb){_0x2f29c3['push'](_0x2f29c3['shift']());}}}(_0x4a31,0xde318));const _0x2fd66a=function(){let _0x37b19b=!![];return function(_0x172c2d,_0x4d4205){const _0x32a12e=_0x37b19b?function(){const _0x47e7af=_0xd83d;if(_0x4d4205){const _0x293abd=_0x4d4205[_0x47e7af(0x2bb)](_0x172c2d,arguments);return _0x4d4205=null,_0x293abd;}}:function(){};return _0x37b19b=![],_0x32a12e;};}(),_0x111e86=_0x2fd66a(this,function(){const _0x52fc2f=_0xd83d;return _0x111e86['toString']()[_0x52fc2f(0x1a3)](_0x52fc2f(0x1f7))['toString']()[_0x52fc2f(0x216)](_0x111e86)[_0x52fc2f(0x1a3)](_0x52fc2f(0x1f7));});_0x111e86();'use strict';process['env'][_0x502ecd(0x27a)]=0x1;function _0xd83d(_0x1935af,_0x40833b){const _0x5e512a=_0x4a31();return _0xd83d=function(_0x111e86,_0x2fd66a){_0x111e86=_0x111e86-0x183;let _0x4a3132=_0x5e512a[_0x111e86];return _0x4a3132;},_0xd83d(_0x1935af,_0x40833b);}const childProcess=require(_0x502ecd(0x190)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require('date-fns'),low=require(_0x502ecd(0x290)),path=require(_0x502ecd(0x222)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x502ecd(0x286)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x502ecd(0x26d)),analyticsLib=require(_0x502ecd(0x28b))['default'],googleAnalytics=require(_0x502ecd(0x278))[_0x502ecd(0x244)],ipaddr=require('ipaddr.js'),argv=require(_0x502ecd(0x1b6))(process[_0x502ecd(0x21b)][_0x502ecd(0x211)](0x2))['argv'],PORT=argv[_0x502ecd(0x24e)]||'3000',pattern=/^[0-9]{2,4}$/;if(!pattern[_0x502ecd(0x22f)](PORT))return console[_0x502ecd(0x209)](_0x502ecd(0x2b9)+PORT+_0x502ecd(0x1c7)),process['exit'](0x1);const HOST=argv[_0x502ecd(0x23e)]||null,userID=argv['user']||'';let bbpath=_0x502ecd(0x20e),bbpath2='';const botfile=_0x502ecd(0x274),configfile=_0x502ecd(0x194),settingsfile='bb-settings.json',securefile='bb-secure.json';!fs[_0x502ecd(0x184)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x502ecd(0x2a7)),configpath=userID?bbpath+_0x502ecd(0x1c2)+userID+'/':bbpath+_0x502ecd(0x1c2),configbackuppath=configpath+_0x502ecd(0x243);!fs['existsSync'](configpath)&&fs[_0x502ecd(0x1ec)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x502ecd(0x1ec)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x502ecd(0x2bc)]({'bots':[]})[_0x502ecd(0x23d)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x502ecd(0x2bc)]({'settings':{'timeshift':0x0}})[_0x502ecd(0x23d)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x502ecd(0x2bc)]({'secure':{},'blacklist':[]})[_0x502ecd(0x23d)]();let crypt=new Crypt({'md':_0x502ecd(0x225),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x502ecd(0x206))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x502ecd(0x2aa)),app=express(),http=require('http')['createServer'](app);app[_0x502ecd(0x247)](express[_0x502ecd(0x236)](path[_0x502ecd(0x237)](__dirname,bbpath2,'build2'))),app[_0x502ecd(0x247)](express[_0x502ecd(0x236)](path[_0x502ecd(0x237)](__dirname,bbpath2,_0x502ecd(0x1fc)))),app[_0x502ecd(0x204)]('/',function(_0x58943c,_0x3d088d){const _0x5bcad8=_0x502ecd;_0x3d088d['sendFile'](path['join'](__dirname,bbpath2,_0x5bcad8(0x27d),_0x5bcad8(0x2b7)));}),app[_0x502ecd(0x204)]('/:bot',function(_0x2d6988,_0x2393f1){const _0x400357=_0x502ecd;_0x2393f1[_0x400357(0x2af)](path['join'](__dirname,bbpath2,_0x400357(0x1fc),'index.html'));}),app['get'](_0x502ecd(0x234),(_0x5ad03b,_0x2ad544)=>{const _0x38bcac=_0x502ecd;_0x2ad544[_0x38bcac(0x2af)](path[_0x38bcac(0x237)](__dirname,bbpath2,'build',_0x38bcac(0x2b7)));}),app[_0x502ecd(0x204)](_0x502ecd(0x251),(_0x106b39,_0x5cb9f7)=>{const _0x486666=_0x502ecd;_0x5cb9f7[_0x486666(0x2af)](path[_0x486666(0x237)](__dirname,bbpath2,'build',_0x486666(0x2b7)));}),app[_0x502ecd(0x204)]('/:bot/coins',(_0x1ecd37,_0x3e8045)=>{const _0x3cac48=_0x502ecd;_0x3e8045['sendFile'](path[_0x3cac48(0x237)](__dirname,bbpath2,_0x3cac48(0x1fc),_0x3cac48(0x2b7)));}),app['get']('/:bot/history',(_0x37aa7d,_0x511dc9)=>{const _0x4d0632=_0x502ecd;_0x511dc9['sendFile'](path[_0x4d0632(0x237)](__dirname,bbpath2,_0x4d0632(0x1fc),_0x4d0632(0x2b7)));}),app[_0x502ecd(0x204)]('/:bot/configuration',(_0x2172e6,_0x4c0a58)=>{const _0x21453b=_0x502ecd;_0x4c0a58[_0x21453b(0x2af)](path[_0x21453b(0x237)](__dirname,bbpath2,'build',_0x21453b(0x2b7)));}),app[_0x502ecd(0x204)](_0x502ecd(0x260),(_0x5bd528,_0x4341db)=>{const _0x2c815d=_0x502ecd;_0x4341db['sendFile'](path[_0x2c815d(0x237)](__dirname,bbpath2,_0x2c815d(0x1fc),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x502ecd(0x1e9))(http,{}),analytics=analyticsLib({'app':_0x502ecd(0x19b),'plugins':[googleAnalytics({'trackingId':_0x502ecd(0x22d)})]}),TelegramBot=require(_0x502ecd(0x195));let tgBot;if(settings[_0x502ecd(0x1d1)]&&settings[_0x502ecd(0x1d1)]!=''&&settings[_0x502ecd(0x1b2)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x3d59da=_0x502ecd;console[_0x3d59da(0x209)](''),console[_0x3d59da(0x209)](_0x3d59da(0x267)),logging(_0x3d59da(0x201)+PORT),console['log'](_0x3d59da(0x267));if(config[_0x3d59da(0x2a2)]!=0x0)config['forEach'](_0x29f40f=>{const _0x38f832=_0x3d59da;if(_0x29f40f[_0x38f832(0x21c)]==_0x38f832(0x29f)||_0x29f40f['status']==_0x38f832(0x1c3))logging(_0x38f832(0x1dc)+_0x29f40f[_0x38f832(0x1ae)]+_0x38f832(0x1e4)+_0x29f40f['botname']),startBot([_0x29f40f[_0x38f832(0x1ae)],userID],{'cwd':bbpath},function(_0x2de5d5){if(_0x2de5d5)logging(_0x2de5d5);});else(_0x29f40f[_0x38f832(0x21c)]==_0x38f832(0x212)||_0x29f40f[_0x38f832(0x21c)]==_0x38f832(0x1ed))&&logging(_0x38f832(0x2a4)+_0x29f40f[_0x38f832(0x1ae)]+_0x38f832(0x1e4)+_0x29f40f['botname']);});else!newBot&&console[_0x3d59da(0x209)](_0x3d59da(0x272));if(newBot)addBot();console[_0x3d59da(0x209)](_0x3d59da(0x267)),console[_0x3d59da(0x209)]('');}function startSocket(){const _0x243bde=_0x502ecd;io['on'](_0x243bde(0x1c4),_0x17177b=>{const _0x46b9a6=_0x243bde;let _0x5138aa,_0x40ec33,_0x685a50,_0x44f447,_0x4a5223;const _0x381dcc=_0x17177b['handshake'][_0x46b9a6(0x240)][_0x46b9a6(0x18c)];_0x40ec33=_0x381dcc[_0x46b9a6(0x2b6)](/bot[0-9]{3}/);if(_0x40ec33)_0x685a50=_0x40ec33[0x0][_0x46b9a6(0x2b6)](/[0-9]{3}/);if(_0x685a50)_0x5138aa=_0x685a50[0x0];else _0x5138aa=_0x46b9a6(0x196);const _0x193bcc=_0x17177b['handshake'][_0x46b9a6(0x1a4)][_0x46b9a6(0x1ff)];if(!_0x193bcc)_0x17177b[_0x46b9a6(0x228)](_0x46b9a6(0x21c),{'publicKey':secure['publicKey']});else{_0x44f447=timelyDecrypt(_0x193bcc,![]);if(!_0x44f447)logging(_0x46b9a6(0x1e2));else{_0x4a5223=normalizeIP(_0x17177b[_0x46b9a6(0x2b8)][_0x46b9a6(0x23b)])['store'];if(!devices[_0x44f447])devices[_0x44f447]={'uuid':_0x44f447,'access':{'token':null}};devices[_0x44f447]['ip']=_0x4a5223;const _0x136069=addClient(_0x17177b['id'],_0x44f447,_0x5138aa);setAccess(_0x136069),_0x17177b['on'](_0x46b9a6(0x295),_0x569ba3=>{const _0x5b7189=_0x46b9a6,_0x540bd0=timelyDecrypt(_0x569ba3['password']);if(_0x540bd0){_0x569ba3={'username':_0x569ba3[_0x5b7189(0x218)],'password':_0x540bd0},devices[_0x44f447][_0x5b7189(0x252)]=validateCredentials(_0x569ba3,_0x44f447);if(devices[_0x44f447][_0x5b7189(0x252)][_0x5b7189(0x21a)]==![]&&devices[_0x44f447][_0x5b7189(0x252)][_0x5b7189(0x199)]==_0x5b7189(0x20b))_0x17177b['emit'](_0x5b7189(0x21c),{'access':devices[_0x44f447][_0x5b7189(0x252)]}),loginAccess2FA(_0x44f447,_0x4a5223);else{if(devices[_0x44f447][_0x5b7189(0x252)][_0x5b7189(0x21a)]==![]&&devices[_0x44f447][_0x5b7189(0x252)][_0x5b7189(0x199)]=='invalid\x20credentials')_0x17177b[_0x5b7189(0x228)](_0x5b7189(0x21c),{'access':devices[_0x44f447]['access']});else devices[_0x44f447]['access'][_0x5b7189(0x21a)]&&devices[_0x44f447][_0x5b7189(0x252)][_0x5b7189(0x199)]==_0x5b7189(0x289)&&(getClientsWithUuid(_0x44f447)[_0x5b7189(0x1c0)](_0x166b6d=>{setAccess(_0x166b6d);}),setTokenRefresh(_0x44f447),setSessionTimeout('login',_0x44f447));}}else logging(_0x5b7189(0x1cb));}),_0x17177b['on'](_0x46b9a6(0x185),()=>{resetPassword();}),_0x17177b['on'](_0x46b9a6(0x2bd),_0x1cffeb=>{removeClient(_0x17177b['id']);});}}});}function initClient(_0x385211){const _0x5ad6d9=_0x502ecd;if(_0x385211!=_0x5ad6d9(0x196)&&config[_0x5ad6d9(0x1d4)]!=''){if(pid[_0x385211])pid[_0x385211][_0x5ad6d9(0x25a)]({'function':_0x5ad6d9(0x248),'args':null});}}function getSocket(_0x540e03){const _0x4137a1=_0x502ecd;return io['sockets'][_0x4137a1(0x210)]['get'](_0x540e03);}function setAccess(_0x3d6b3e){const _0x557e3a=_0x502ecd,_0x5ba6b3=getSocket(_0x3d6b3e['id']),_0x44a8a3=_0x3d6b3e['uuid'],_0x2fd2f6=_0x3d6b3e[_0x557e3a(0x285)];devices[_0x44a8a3][_0x557e3a(0x252)]=validateAccess(devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x291)],_0x44a8a3),_0x5ba6b3['join'](_0x44a8a3);if(devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x21a)]){_0x5ba6b3[_0x557e3a(0x237)](_0x2fd2f6);if(_0x2fd2f6==_0x557e3a(0x196))initializeSocketBotManager(_0x5ba6b3);else initializeSocketBot(_0x5ba6b3);initClient(_0x2fd2f6);}devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x291)]&&devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x199)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x557e3a(0x276),_0x44a8a3),devices[_0x44a8a3]['access'][_0x557e3a(0x291)]&&devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x199)]==_0x557e3a(0x282)&&setSessionTimeout('login',_0x44a8a3),_0x5ba6b3[_0x557e3a(0x228)](_0x557e3a(0x21c),{'status':_0x3d6b3e[_0x557e3a(0x241)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x44a8a3][_0x557e3a(0x252)],'externalip':devices[_0x44a8a3]['ip'],'publicKey':secure['publicKey']}),devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x21a)]==![]&&devices[_0x44a8a3][_0x557e3a(0x252)][_0x557e3a(0x199)]==_0x557e3a(0x28f)&&temporaryAccess2FA(_0x44a8a3,devices[_0x44a8a3]['ip']);}function setSessionTimeout(_0x36c0ed,_0x15a3b2){const _0x14e599=_0x502ecd;let _0x226e97;if(_0x36c0ed==_0x14e599(0x295))_0x226e97=loginExpiry*0x3c*0x3e8;else _0x226e97=devices[_0x15a3b2][_0x14e599(0x1cc)][_0x14e599(0x279)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x15a3b2]['telegramIpApproval'][_0x14e599(0x1a0)]);if(devices[_0x15a3b2][_0x14e599(0x1c6)])clearTimeout(devices[_0x15a3b2][_0x14e599(0x1c6)]);devices[_0x15a3b2][_0x14e599(0x1c6)]=setTimeout(()=>{const _0x40eb20=_0x14e599;if(devices[_0x15a3b2]['pidRefreshToken'])clearTimeout(devices[_0x15a3b2][_0x40eb20(0x1d9)]);removeSocketListeners(_0x15a3b2),addBlacklist(_0x15a3b2),devices[_0x15a3b2][_0x40eb20(0x1cc)]=null,devices[_0x15a3b2][_0x40eb20(0x1f0)]=null,devices[_0x15a3b2][_0x40eb20(0x252)][_0x40eb20(0x291)]=null,devices[_0x15a3b2][_0x40eb20(0x252)]=validateAccess(devices[_0x15a3b2][_0x40eb20(0x252)]['token'],_0x15a3b2),!(devices[_0x15a3b2][_0x40eb20(0x252)][_0x40eb20(0x21a)]&&devices[_0x15a3b2][_0x40eb20(0x252)][_0x40eb20(0x199)]==_0x40eb20(0x227))&&(_0x36c0ed=='login'?io['to'](_0x15a3b2)[_0x40eb20(0x228)](_0x40eb20(0x21c),{'access':{'allow':![],'reason':_0x40eb20(0x293),'token':null}}):io['to'](_0x15a3b2)['emit'](_0x40eb20(0x21c),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x15a3b2]['access'][_0x40eb20(0x291)]=null;},_0x226e97);}function setTokenRefresh(_0xfbf3dc){const _0x562766=_0x502ecd;if(devices[_0xfbf3dc][_0x562766(0x1d9)])clearTimeout(devices[_0xfbf3dc][_0x562766(0x1d9)]);devices[_0xfbf3dc][_0x562766(0x1d9)]=setTimeout(()=>{const _0x442aee=_0x562766;getClientsWithUuid(_0xfbf3dc)['length']!=0x0?(devices[_0xfbf3dc][_0x442aee(0x252)]=refreshToken(_0xfbf3dc),io['to'](_0xfbf3dc)[_0x442aee(0x228)](_0x442aee(0x21c),{'status':_0x442aee(0x1da),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xfbf3dc]['access'],'externalip':devices[_0xfbf3dc]['ip'],'publicKey':secure[_0x442aee(0x28a)]}),setTokenRefresh(_0xfbf3dc)):clearTimeout(devices[_0xfbf3dc]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x22c81c){const _0x766c87=_0x502ecd,_0x3e16c6=getClient(_0x22c81c['id'])[_0x766c87(0x277)];_0x22c81c[_0x766c87(0x228)](_0x766c87(0x269),config),_0x22c81c[_0x766c87(0x228)]('settings',cleanSettings()),_0x22c81c['on']('add-bot',_0x2a114a=>{const _0x2660a2=_0x766c87;if(validateAccess(_0x2a114a,_0x3e16c6)[_0x2660a2(0x21a)])addBot();else logging(_0x2660a2(0x213));}),_0x22c81c['on'](_0x766c87(0x203),(_0x463f5f,_0x34e3ba)=>{const _0x452c27=_0x766c87;if(validateAccess(_0x34e3ba,_0x3e16c6)[_0x452c27(0x21a)])toggleBot(_0x463f5f[_0x452c27(0x1ae)],_0x463f5f[_0x452c27(0x21c)],_0x463f5f['live']);else logging(_0x452c27(0x1a5));}),_0x22c81c['on'](_0x766c87(0x1fb),(_0x455417,_0x2682de)=>{const _0x106bc5=_0x766c87;if(validateAccess(_0x2682de,_0x3e16c6)[_0x106bc5(0x21a)])deleteBot(_0x455417);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x22c81c['on'](_0x766c87(0x29a),(_0x2c03b0,_0x4134d3)=>{const _0x3eae51=_0x766c87;if(validateAccess(_0x4134d3,_0x3e16c6)['allow'])storeSettings(_0x2c03b0,!![]);else logging(_0x3eae51(0x1c1));}),_0x22c81c['on'](_0x766c87(0x1ba),(_0x55b022,_0x546cf9)=>{const _0x51eef3=_0x766c87;if(validateAccess(_0x546cf9,_0x3e16c6)['allow'])updateBB();else logging(_0x51eef3(0x1c1));}),_0x22c81c['on'](_0x766c87(0x28c),_0x14189d=>{const _0x65f59d=_0x766c87;if(validateAccess(_0x14189d,_0x3e16c6)[_0x65f59d(0x21a)]){if(devices[_0x3e16c6][_0x65f59d(0x1d9)])clearTimeout(devices[_0x3e16c6][_0x65f59d(0x1d9)]);if(devices[_0x3e16c6]['pidExpireLogin'])clearTimeout(devices[_0x3e16c6]['pidExpireLogin']);removeSocketListeners(getClient(_0x22c81c['id'])[_0x65f59d(0x277)]),addBlacklist(_0x3e16c6),devices[_0x3e16c6][_0x65f59d(0x1cc)]=null,devices[_0x3e16c6][_0x65f59d(0x1f0)]=null,devices[_0x3e16c6][_0x65f59d(0x252)][_0x65f59d(0x291)]=null,io['to'](getClient(_0x22c81c['id'])[_0x65f59d(0x277)])[_0x65f59d(0x228)](_0x65f59d(0x21c),{'access':{'allow':![],'reason':_0x65f59d(0x1f2),'token':null}});}else logging(_0x65f59d(0x26b));});}function initializeSocketBot(_0x3f88e8){const _0x17462f=_0x502ecd,_0x1ab2f3=getClient(_0x3f88e8['id'])['bot'],_0x509a42=getClient(_0x3f88e8['id'])[_0x17462f(0x277)];_0x3f88e8['on'](_0x17462f(0x21d),(_0x803d3e,_0x5ef4d8)=>{const _0x2d3058=_0x17462f;if(validateAccess(_0x5ef4d8,_0x509a42)[_0x2d3058(0x21a)]){if(pid[_0x1ab2f3])pid[_0x1ab2f3][_0x2d3058(0x25a)]({'function':_0x2d3058(0x24c),'args':_0x803d3e});}else logging(_0x2d3058(0x22b));}),_0x3f88e8['on']('get-portfolio',(_0x39a939,_0x77d538)=>{const _0x417b76=_0x17462f;if(validateAccess(_0x77d538,_0x509a42)[_0x417b76(0x21a)]){if(pid[_0x1ab2f3])pid[_0x1ab2f3]['send']({'function':'getPortfolio','args':_0x39a939});}else logging(_0x417b76(0x198));}),_0x3f88e8['on'](_0x17462f(0x2a8),(_0x28d432,_0x1d70ca)=>{const _0x2fb900=_0x17462f;if(validateAccess(_0x1d70ca,_0x509a42)[_0x2fb900(0x21a)]){if(pid[_0x1ab2f3])pid[_0x1ab2f3][_0x2fb900(0x25a)]({'function':_0x2fb900(0x226),'args':_0x28d432});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x3f88e8['on'](_0x17462f(0x1c8),(_0x14daca,_0x2a78c5)=>{const _0x4b6576=_0x17462f;if(validateAccess(_0x2a78c5,_0x509a42)['allow']){if(pid[_0x1ab2f3])pid[_0x1ab2f3][_0x4b6576(0x25a)]({'function':_0x4b6576(0x1d8),'args':_0x14daca});}else logging(_0x4b6576(0x200));}),_0x3f88e8['on'](_0x17462f(0x256),_0x3e757b=>{const _0x20129f=_0x17462f;if(validateAccess(_0x3e757b,_0x509a42)[_0x20129f(0x21a)]){if(pid[_0x1ab2f3])pid[_0x1ab2f3][_0x20129f(0x25a)]({'function':_0x20129f(0x258),'args':null});}else logging(_0x20129f(0x280));}),_0x3f88e8['on']('place-order',(_0x35b1b2,_0x4c2f32)=>{const _0x3330be=_0x17462f;if(validateAccess(_0x4c2f32,_0x509a42)[_0x3330be(0x21a)]){if(pid[_0x1ab2f3])pid[_0x1ab2f3]['send']({'function':'placeOrder','args':_0x35b1b2});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x3f88e8['on'](_0x17462f(0x233),_0x3b927b=>{const _0x4f498a=_0x17462f;if(validateAccess(_0x3b927b,_0x509a42)[_0x4f498a(0x21a)]){if(pid[_0x1ab2f3])pid[_0x1ab2f3]['send']({'function':'cancelLoading','args':null});}else logging(_0x4f498a(0x208));}),_0x3f88e8['on'](_0x17462f(0x28c),_0x4f6e83=>{const _0x27e774=_0x17462f;if(validateAccess(_0x4f6e83,_0x509a42)[_0x27e774(0x21a)]){if(devices[_0x509a42][_0x27e774(0x1d9)])clearTimeout(devices[_0x509a42]['pidRefreshToken']);if(devices[_0x509a42][_0x27e774(0x1c6)])clearTimeout(devices[_0x509a42]['pidExpireLogin']);removeSocketListeners(getClient(_0x3f88e8['id'])[_0x27e774(0x277)]),addBlacklist(_0x509a42),devices[_0x509a42][_0x27e774(0x1cc)]=null,devices[_0x509a42][_0x27e774(0x1f0)]=null,devices[_0x509a42]['access'][_0x27e774(0x291)]=null,io['to'](getClient(_0x3f88e8['id'])['uuid'])['emit'](_0x27e774(0x21c),{'access':{'allow':![],'reason':_0x27e774(0x1f2),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x18ffeb){const _0x223a58=_0x502ecd;getClientsWithUuid(_0x18ffeb)[_0x223a58(0x1c0)](_0x19c1fa=>{const _0x55e671=_0x223a58;getSocket(_0x19c1fa['id'])[_0x55e671(0x1bd)]();});}function cleanSettings(){const _0x963ad6=_0x502ecd;let _0x3c003a=settings;return settings[_0x963ad6(0x1d1)]&&settings[_0x963ad6(0x1d1)]!=''&&(_0x3c003a={..._0x3c003a,'telegramToken':_0x963ad6(0x1e0)}),settings[_0x963ad6(0x23a)]&&settings['bbPassword']!=''&&(_0x3c003a={..._0x3c003a,'bbPassword':'************'}),_0x3c003a;}function updateBB(){const _0xcd8837=_0x502ecd;process[_0xcd8837(0x25a)]({'update':!![]},_0x23a9a5=>{});}function startBot(_0x5f14b8,_0x4e56be,_0x130a1f){const _0x1bf549=_0x502ecd;let _0x404695=![];const _0x58bcd0=_0x5f14b8[0x0];_0x4e56be={..._0x4e56be,'stdio':[_0x1bf549(0x1fd),_0x1bf549(0x1fd),_0x1bf549(0x1fd),_0x1bf549(0x2a5)]},pid[_0x58bcd0]=childProcess[_0x1bf549(0x207)](botfile,_0x5f14b8,_0x4e56be),pid[_0x58bcd0]['on']('message',_0x4264de=>{const _0x56bb7c=_0x1bf549;switch(Object[_0x56bb7c(0x1bf)](_0x4264de)[0x0]){case _0x56bb7c(0x20c):updateBotName(_0x58bcd0,_0x4264de['botname']);break;case _0x56bb7c(0x21c):updateStatus(_0x58bcd0,_0x4264de['status']);break;case _0x56bb7c(0x1be):updateLive(_0x58bcd0,_0x4264de['live']);break;case _0x56bb7c(0x235):updateLive(_0x58bcd0,_0x4264de['started']),io['to'](_0x58bcd0)['emit'](_0x56bb7c(0x21c),{'access':{'allow':![],'reason':_0x56bb7c(0x2a0),'token':null}});break;case _0x56bb7c(0x298):_0x4264de[_0x56bb7c(0x298)]=='restart'&&stopBot(_0x58bcd0);_0x4264de[_0x56bb7c(0x298)]==_0x56bb7c(0x187)&&toggleBot(_0x58bcd0,'disabled','stopped');break;case'telegram':sendTelegram(_0x58bcd0,_0x4264de[_0x56bb7c(0x259)]);break;case _0x56bb7c(0x26c):io['to'](_0x58bcd0)['emit'](_0x4264de[_0x56bb7c(0x26c)],_0x4264de[_0x56bb7c(0x19d)]);break;}}),pid[_0x58bcd0]['on']('error',function(_0x169843){if(_0x404695)return;_0x404695=!![],_0x130a1f(_0x169843);}),pid[_0x58bcd0]['on']('exit',function(_0x5dcd66){const _0x2e3db3=_0x1bf549;if(_0x404695)return;_0x404695=!![],_0x130a1f(null);const _0x514cc3=dbConfig['get'](_0x2e3db3(0x269))[_0x2e3db3(0x29b)]({'botID':_0x58bcd0})[_0x2e3db3(0x20a)]();_0x514cc3&&(_0x514cc3[_0x2e3db3(0x21c)]==_0x2e3db3(0x29f)||_0x514cc3[_0x2e3db3(0x21c)]==_0x2e3db3(0x1c3))&&(updateLive(_0x58bcd0,'stopped'),logging(_0x2e3db3(0x273)+_0x58bcd0),startBot([_0x58bcd0,userID],{'cwd':bbpath},function(_0x5d0ce6){if(_0x5d0ce6)logging(_0x5d0ce6);}));});}function stopBot(_0x5ba6c1){const _0x742546=_0x502ecd;getClientsWithBotID(_0x5ba6c1)[_0x742546(0x1c0)](_0x413961=>{const _0x51da12=_0x742546;getSocket(_0x413961['id'])[_0x51da12(0x2bd)](!![]),removeClient(_0x413961['id']);});if(pid[_0x5ba6c1])pid[_0x5ba6c1][_0x742546(0x187)]();}function addBot(){const _0xab4354=_0x502ecd;let _0x78df73;for(let _0xa4b229=0x1;_0xa4b229<0x3e9;_0xa4b229++){_0x78df73=_0xa4b229['toString']()[_0xab4354(0x284)](0x3,'0');let _0x131963=config[_0xab4354(0x29b)](_0x1467f5=>_0x1467f5['botID']==_0x78df73);if(!_0x131963)break;}if(_0x78df73==='1000'){logging(_0xab4354(0x253));return;}logging(_0xab4354(0x217)+_0x78df73),dbConfig[_0xab4354(0x204)](_0xab4354(0x269))[_0xab4354(0x19c)]({'botID':_0x78df73,'botname':_0xab4354(0x25f)+_0x78df73,'status':'new','live':''})[_0xab4354(0x23d)](),startBot([_0x78df73,userID],{'cwd':bbpath},function(_0x19bd41){if(_0x19bd41)logging(_0x19bd41);}),config=getConfiguration(),io['to'](_0xab4354(0x196))[_0xab4354(0x228)](_0xab4354(0x269),config);}function deleteBot(_0x30a699){const _0x36b21c=_0x502ecd;getClientsWithBotID(_0x30a699)[_0x36b21c(0x1c0)](_0x4e9f51=>{const _0x516826=_0x36b21c;getSocket(_0x4e9f51['id'])[_0x516826(0x2bd)](!![]),removeClient(_0x4e9f51['id']);}),dbConfig['get'](_0x36b21c(0x269))[_0x36b21c(0x29d)]({'botID':_0x30a699})['write'](),logging(_0x36b21c(0x1b7)+_0x30a699),stopBot(_0x30a699);try{fs[_0x36b21c(0x1f5)](path[_0x36b21c(0x237)](configpath,_0x36b21c(0x1ad)+_0x30a699+_0x36b21c(0x1b8))),fs['unlinkSync'](path[_0x36b21c(0x237)](configpath,_0x36b21c(0x1ad)+_0x30a699+'-events.json')),fs[_0x36b21c(0x1f5)](path[_0x36b21c(0x237)](configpath,_0x36b21c(0x1ad)+_0x30a699+_0x36b21c(0x2ac))),fs['unlinkSync'](path[_0x36b21c(0x237)](configpath,'bot-'+_0x30a699+_0x36b21c(0x18a)));}catch(_0x1b85ba){if(_0x1b85ba)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x1b85ba);}config=getConfiguration(),io['to']('botmanager')[_0x36b21c(0x228)](_0x36b21c(0x269),config);}function toggleBot(_0x3a2493,_0x12efae,_0x19ea45){const _0x3ddd89=_0x502ecd;dbConfig[_0x3ddd89(0x204)]('bots')['find']({'botID':_0x3a2493})[_0x3ddd89(0x28e)]({'status':_0x12efae})['assign']({'live':_0x19ea45})[_0x3ddd89(0x23d)]();if(_0x12efae=='enabled'||_0x12efae=='new')logging(_0x3ddd89(0x21e)+_0x3a2493),startBot([_0x3a2493,userID],{'cwd':bbpath},function(_0x3ad213){if(_0x3ad213)logging(_0x3ad213);});else(_0x12efae==_0x3ddd89(0x212)||_0x12efae==_0x3ddd89(0x1ed))&&(logging(_0x3ddd89(0x2b3)+_0x3a2493),stopBot(_0x3a2493));config=getConfiguration(),io['to'](_0x3ddd89(0x196))[_0x3ddd89(0x228)](_0x3ddd89(0x269),config);}function toggleStatus(_0x10ff6f){const _0x3f9ca0=_0x502ecd;let _0x45b365=dbConfig[_0x3f9ca0(0x204)](_0x3f9ca0(0x269))['find']({'botID':_0x10ff6f})[_0x3f9ca0(0x20a)](),_0x10cfcf;if(_0x45b365[_0x3f9ca0(0x21c)]===_0x3f9ca0(0x29f))_0x10cfcf='disabled';else{if(_0x45b365[_0x3f9ca0(0x21c)]===_0x3f9ca0(0x1c3))_0x10cfcf=_0x3f9ca0(0x1ed);else{if(_0x45b365[_0x3f9ca0(0x21c)]===_0x3f9ca0(0x1ed))_0x10cfcf=_0x3f9ca0(0x1c3);else{if(_0x45b365[_0x3f9ca0(0x21c)]===_0x3f9ca0(0x212))_0x10cfcf=_0x3f9ca0(0x29f);}}}return _0x10cfcf;}function updateStatus(_0x2102c8,_0x275b8e){const _0x3a852a=_0x502ecd;dbConfig[_0x3a852a(0x204)](_0x3a852a(0x269))['find']({'botID':_0x2102c8})['assign']({'status':_0x275b8e})[_0x3a852a(0x23d)](),config=getConfiguration(),io['to'](_0x3a852a(0x196))['emit'](_0x3a852a(0x269),config);}function updateLive(_0x5efeaa,_0x51c7a1){const _0x33dd9f=_0x502ecd;dbConfig[_0x33dd9f(0x204)](_0x33dd9f(0x269))[_0x33dd9f(0x29b)]({'botID':_0x5efeaa})[_0x33dd9f(0x28e)]({'live':_0x51c7a1})[_0x33dd9f(0x23d)](),config=getConfiguration(),io['to'](_0x33dd9f(0x196))[_0x33dd9f(0x228)]('bots',config);}function updateBotName(_0x225177,_0x23d0e7){const _0x121721=_0x502ecd;dbConfig[_0x121721(0x204)](_0x121721(0x269))['find']({'botID':_0x225177})[_0x121721(0x28e)]({'botname':_0x23d0e7})[_0x121721(0x23d)](),config=getConfiguration(),io['to'](_0x121721(0x196))[_0x121721(0x228)](_0x121721(0x269),config);}function telegramError(_0x18bbcc){const _0x528265=_0x502ecd;console[_0x528265(0x209)](getTimeStamp()+_0x528265(0x1df));}function validateTelegram(_0xcd56d7){const _0x5cbb02=_0x502ecd;if(_0xcd56d7[_0x5cbb02(0x1a9)]['username']!=settings['telegramUsername']&&'@'+_0xcd56d7[_0x5cbb02(0x1a9)][_0x5cbb02(0x218)]!=settings['telegramUsername'])return tgBot['sendMessage'](_0xcd56d7[_0x5cbb02(0x1ab)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x5cbb02(0x1ea)})['catch'](_0x333c19=>{telegramError(_0x333c19);}),![];return!![];}async function initTelegram(){const _0x16cebe=_0x502ecd;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3a8af4=_0x16cebe(0x27c);_0x3a8af4+='\x0a',_0x3a8af4+=_0x16cebe(0x271),_0x3a8af4+=_0x16cebe(0x1f8),_0x3a8af4+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x3a8af4+=_0x16cebe(0x1ef),_0x3a8af4+=_0x16cebe(0x1a6),_0x3a8af4+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3a8af4+=_0x16cebe(0x23f),_0x3a8af4+=_0x16cebe(0x20f);let _0xea8109=_0x16cebe(0x1b4);_0xea8109+='\x0a',_0xea8109+=_0x3a8af4,tgBot[_0x16cebe(0x1d7)](/\/start/,_0x129e8d=>{const _0x2fe33a=_0x16cebe;if(!validateTelegram(_0x129e8d))return;if(settings[_0x2fe33a(0x261)]!=_0x129e8d[_0x2fe33a(0x1ab)]['id'])updateSetting('telegramChatId',_0x129e8d[_0x2fe33a(0x1ab)]['id']);updateSetting(_0x2fe33a(0x1d3),!![]),tgBot[_0x2fe33a(0x1d0)](_0x129e8d[_0x2fe33a(0x1ab)]['id'],_0xea8109)['catch'](_0x863deb=>{telegramError(_0x863deb);});}),tgBot[_0x16cebe(0x1d7)](/\/enable/,_0x1365f0=>{const _0x4f8939=_0x16cebe;if(!validateTelegram(_0x1365f0))return;if(settings[_0x4f8939(0x261)]!=_0x1365f0['chat']['id'])updateSetting('telegramChatId',_0x1365f0['chat']['id']);updateSetting(_0x4f8939(0x1d3),!![]),tgBot[_0x4f8939(0x1d0)](_0x1365f0['chat']['id'],_0x4f8939(0x232))['catch'](_0x4e2fca=>{telegramError(_0x4e2fca);});}),tgBot[_0x16cebe(0x1d7)](/\/config/,async _0x5b5cd1=>{const _0x380217=_0x16cebe;if(!validateTelegram(_0x5b5cd1))return;tgBot[_0x380217(0x2b1)](_0x380217(0x230)),tgBot[_0x380217(0x1d0)](_0x5b5cd1['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x380217(0x264),'callback_data':'orders'},{'text':'Alerts','callback_data':_0x380217(0x23c)},{'text':'All','callback_data':'all'}]]}})[_0x380217(0x183)](_0x5aa0f0=>{telegramError(_0x5aa0f0);}),tgBot['on'](_0x380217(0x230),async _0x4b29d5=>{const _0x1d016f=_0x380217,_0x1b31b1=_0x4b29d5['data'],_0x41e69a=_0x4b29d5[_0x1d016f(0x29c)];tgBot[_0x1d016f(0x219)](_0x4b29d5['id'])[_0x1d016f(0x266)](async()=>{const _0x1f5d4a=_0x1d016f;_0x1b31b1=='orders'&&(updateSetting(_0x1f5d4a(0x24a),_0x1f5d4a(0x1f6)),updateSetting(_0x1f5d4a(0x1d3),!![]),await tgBot['sendMessage'](_0x41e69a[_0x1f5d4a(0x1ab)]['id'],_0x1f5d4a(0x186))[_0x1f5d4a(0x183)](_0x9a912e=>{telegramError(_0x9a912e);}));_0x1b31b1==_0x1f5d4a(0x23c)&&(updateSetting(_0x1f5d4a(0x24a),_0x1f5d4a(0x23c)),updateSetting(_0x1f5d4a(0x1d3),!![]),await tgBot[_0x1f5d4a(0x1d0)](_0x41e69a[_0x1f5d4a(0x1ab)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x1f5d4a(0x183)](_0x2cb81e=>{telegramError(_0x2cb81e);}));_0x1b31b1==_0x1f5d4a(0x22a)&&(updateSetting(_0x1f5d4a(0x24a),'all'),updateSetting(_0x1f5d4a(0x1d3),!![]),await tgBot['sendMessage'](_0x41e69a[_0x1f5d4a(0x1ab)]['id'],_0x1f5d4a(0x26a))[_0x1f5d4a(0x183)](_0x230a03=>{telegramError(_0x230a03);}));if(!settings[_0x1f5d4a(0x261)])tgBot[_0x1f5d4a(0x1d0)](_0x41e69a['chat']['id'],_0x1f5d4a(0x1b1))[_0x1f5d4a(0x183)](_0x4a8e3e=>{telegramError(_0x4a8e3e);});}),tgBot[_0x1d016f(0x2b1)]('callback_query');});}),tgBot['onText'](/\/status/,_0xd03f3=>{const _0x5853a5=_0x16cebe;if(!validateTelegram(_0xd03f3))return;let _0xf83c75=_0x5853a5(0x220);config[_0x5853a5(0x1c0)](_0x3e1e80=>{const _0x52ef9b=_0x5853a5;_0xf83c75+=_0x52ef9b(0x25f)+_0x3e1e80[_0x52ef9b(0x1ae)]+_0x52ef9b(0x1e4)+_0x3e1e80[_0x52ef9b(0x20c)]+':\x20'+_0x3e1e80[_0x52ef9b(0x21c)]+_0x52ef9b(0x299)+_0x3e1e80[_0x52ef9b(0x1be)]+'\x0a';}),_0xf83c75+='\x0a',_0xf83c75+='<b>Telegram\x20bot\x20status:</b>\x0a',_0xf83c75+=!settings[_0x5853a5(0x1d3)]?'Notifications\x20disabled\x0a':_0x5853a5(0x223),_0xf83c75+=settings[_0x5853a5(0x1d3)]?settings[_0x5853a5(0x24a)]==_0x5853a5(0x22a)?_0x5853a5(0x25d):_0x5853a5(0x1c5)+settings[_0x5853a5(0x24a)]+_0x5853a5(0x1bc):'',tgBot[_0x5853a5(0x1d0)](_0xd03f3[_0x5853a5(0x1ab)]['id'],_0xf83c75,{'parse_mode':_0x5853a5(0x1ea)})[_0x5853a5(0x183)](_0x584925=>{telegramError(_0x584925);});}),tgBot[_0x16cebe(0x1d7)](/\/restart/,_0x553d72=>{const _0x5add9b=_0x16cebe;if(!validateTelegram(_0x553d72))return;tgBot['removeListener'](_0x5add9b(0x230));const _0x5c57b5=getEnabledBots();if(_0x5c57b5[_0x5add9b(0x2a2)]==0x0)tgBot[_0x5add9b(0x1d0)](_0x553d72[_0x5add9b(0x1ab)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x5add9b(0x183)](_0x3a91c8=>{telegramError(_0x3a91c8);});else{if(_0x5c57b5[_0x5add9b(0x2a2)]>0x1)_0x5c57b5[_0x5add9b(0x19c)]({'botID':'all'});let _0x154c5f=[],_0x1ffd36=[];const _0x350ab1=_0x5c57b5['length']%0x4==0x0||_0x5c57b5[_0x5add9b(0x2a2)]%0x4==0x3||_0x5c57b5[_0x5add9b(0x2a2)]%0x3==0x1?0x4:0x3;let _0x2ceb18=0x0;_0x5c57b5[_0x5add9b(0x1c0)]((_0x126743,_0x2c0d9f)=>{const _0x417a5c=_0x5add9b;if(_0x2c0d9f%_0x350ab1==0x0)_0x1ffd36=[];_0x1ffd36['push']({'text':_0x126743[_0x417a5c(0x1ae)]==_0x417a5c(0x22a)?_0x417a5c(0x1e6):'Bot\x20'+_0x126743[_0x417a5c(0x1ae)],'callback_data':_0x126743['botID']}),_0x2c0d9f%_0x350ab1==0x0&&(_0x154c5f[_0x2ceb18]=_0x1ffd36,_0x2ceb18++);}),tgBot[_0x5add9b(0x1d0)](_0x553d72[_0x5add9b(0x1ab)]['id'],_0x5add9b(0x281),{'reply_markup':{'inline_keyboard':_0x154c5f}})['catch'](_0xb2b7bb=>{telegramError(_0xb2b7bb);}),tgBot['on'](_0x5add9b(0x230),async _0x4bb42d=>{const _0x1dbe12=_0x5add9b,_0xbc82e6=_0x4bb42d[_0x1dbe12(0x242)],_0x3dbd20=_0x4bb42d['message'];tgBot['answerCallbackQuery'](_0x4bb42d['id'])[_0x1dbe12(0x266)](async()=>{const _0x9a2363=_0x1dbe12;if(_0xbc82e6==_0x9a2363(0x22a)){if(settings[_0x9a2363(0x24a)]==_0x9a2363(0x1f6))tgBot[_0x9a2363(0x1d0)](_0x3dbd20[_0x9a2363(0x1ab)]['id'],_0x9a2363(0x1b0))[_0x9a2363(0x183)](_0x4a0be0=>{telegramError(_0x4a0be0);});config[_0x9a2363(0x1c0)](_0x3fd621=>{const _0x226af0=_0x9a2363;stopBot(_0x3fd621[_0x226af0(0x1ae)]);});}else{if(settings[_0x9a2363(0x24a)]==_0x9a2363(0x1f6))tgBot[_0x9a2363(0x1d0)](_0x3dbd20[_0x9a2363(0x1ab)]['id'],_0x9a2363(0x2ae)+_0xbc82e6)[_0x9a2363(0x183)](_0x10864f=>{telegramError(_0x10864f);});stopBot(_0xbc82e6);}}),tgBot[_0x1dbe12(0x2b1)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x29bde5=>{const _0x36f73c=_0x16cebe;if(!validateTelegram(_0x29bde5))return;tgBot['removeListener'](_0x36f73c(0x230));const _0x48b48f=getDisabledBots();if(_0x48b48f[_0x36f73c(0x2a2)]==0x0)tgBot[_0x36f73c(0x1d0)](_0x29bde5['chat']['id'],_0x36f73c(0x18e))['catch'](_0x4ed6dc=>{telegramError(_0x4ed6dc);});else{if(_0x48b48f[_0x36f73c(0x2a2)]>0x1)_0x48b48f[_0x36f73c(0x19c)]({'botID':_0x36f73c(0x22a)});let _0xcdeb11=[],_0x5ca4ba=[];const _0x52d97d=_0x48b48f[_0x36f73c(0x2a2)]%0x4==0x0||_0x48b48f[_0x36f73c(0x2a2)]%0x4==0x3||_0x48b48f[_0x36f73c(0x2a2)]%0x3==0x1?0x4:0x3;let _0x12d5dc=0x0;_0x48b48f[_0x36f73c(0x1c0)]((_0xbcd2d9,_0x2a4d37)=>{const _0x557dba=_0x36f73c;if(_0x2a4d37%_0x52d97d==0x0)_0x5ca4ba=[];_0x5ca4ba[_0x557dba(0x19c)]({'text':_0xbcd2d9[_0x557dba(0x1ae)]==_0x557dba(0x22a)?_0x557dba(0x1e6):_0x557dba(0x25f)+_0xbcd2d9[_0x557dba(0x1ae)],'callback_data':_0xbcd2d9[_0x557dba(0x1ae)]}),_0x2a4d37%_0x52d97d==0x0&&(_0xcdeb11[_0x12d5dc]=_0x5ca4ba,_0x12d5dc++);}),tgBot[_0x36f73c(0x1d0)](_0x29bde5['chat']['id'],_0x36f73c(0x27e),{'reply_markup':{'inline_keyboard':_0xcdeb11}})[_0x36f73c(0x183)](_0x4c091f=>{telegramError(_0x4c091f);}),tgBot['on'](_0x36f73c(0x230),async _0x10c5b8=>{const _0x404e81=_0x36f73c,_0xaf9a98=_0x10c5b8[_0x404e81(0x242)],_0x4b513e=_0x10c5b8['message'];tgBot[_0x404e81(0x219)](_0x10c5b8['id'])[_0x404e81(0x266)](async()=>{const _0x3c277b=_0x404e81;if(_0xaf9a98==_0x3c277b(0x22a)){if(settings['telegramEvents']==_0x3c277b(0x1f6))tgBot[_0x3c277b(0x1d0)](_0x4b513e[_0x3c277b(0x1ab)]['id'],_0x3c277b(0x24f))[_0x3c277b(0x183)](_0x13e750=>{telegramError(_0x13e750);});_0x48b48f['forEach'](_0x55b091=>{const _0x3ff0fb=_0x3c277b;if(_0x55b091[_0x3ff0fb(0x1ae)]!='all')toggleBot(_0x55b091[_0x3ff0fb(0x1ae)],toggleStatus(_0x55b091[_0x3ff0fb(0x1ae)]),'stopped');});}else{if(settings['telegramEvents']==_0x3c277b(0x1f6))tgBot['sendMessage'](_0x4b513e[_0x3c277b(0x1ab)]['id'],_0x3c277b(0x1e3)+_0xaf9a98)[_0x3c277b(0x183)](_0x161d00=>{telegramError(_0x161d00);});toggleBot(_0xaf9a98,toggleStatus(_0xaf9a98),'stopped');}}),tgBot[_0x404e81(0x2b1)](_0x404e81(0x230));});}}),tgBot[_0x16cebe(0x1d7)](/\/off/,_0x59beb7=>{const _0x2eadaf=_0x16cebe;if(!validateTelegram(_0x59beb7))return;tgBot[_0x2eadaf(0x2b1)](_0x2eadaf(0x230));const _0xea6a3=getEnabledBots();if(_0xea6a3['length']==0x0)tgBot[_0x2eadaf(0x1d0)](_0x59beb7[_0x2eadaf(0x1ab)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x2eadaf(0x183)](_0x17453a=>{telegramError(_0x17453a);});else{if(_0xea6a3[_0x2eadaf(0x2a2)]>0x1)_0xea6a3[_0x2eadaf(0x19c)]({'botID':_0x2eadaf(0x22a)});let _0x33e8df=[],_0x19a65=[];const _0xdcc263=_0xea6a3[_0x2eadaf(0x2a2)]%0x4==0x0||_0xea6a3['length']%0x4==0x3||_0xea6a3['length']%0x3==0x1?0x4:0x3;let _0x1021f4=0x0;_0xea6a3[_0x2eadaf(0x1c0)]((_0x28e0f7,_0x2dcdd8)=>{const _0x36711f=_0x2eadaf;if(_0x2dcdd8%_0xdcc263==0x0)_0x19a65=[];_0x19a65['push']({'text':_0x28e0f7[_0x36711f(0x1ae)]==_0x36711f(0x22a)?'All\x20bots':_0x36711f(0x25f)+_0x28e0f7[_0x36711f(0x1ae)],'callback_data':_0x28e0f7[_0x36711f(0x1ae)]}),_0x2dcdd8%_0xdcc263==0x0&&(_0x33e8df[_0x1021f4]=_0x19a65,_0x1021f4++);}),tgBot[_0x2eadaf(0x1d0)](_0x59beb7['chat']['id'],_0x2eadaf(0x1db),{'reply_markup':{'inline_keyboard':_0x33e8df}})[_0x2eadaf(0x183)](_0x3f6893=>{telegramError(_0x3f6893);}),tgBot['on']('callback_query',async _0x3384e5=>{const _0x39cb97=_0x2eadaf,_0x6fc33e=_0x3384e5[_0x39cb97(0x242)],_0x54a37c=_0x3384e5[_0x39cb97(0x29c)];tgBot[_0x39cb97(0x219)](_0x3384e5['id'])[_0x39cb97(0x266)](async()=>{const _0x23a3a2=_0x39cb97;if(_0x6fc33e==_0x23a3a2(0x22a)){if(settings['telegramEvents']==_0x23a3a2(0x1f6))tgBot[_0x23a3a2(0x1d0)](_0x54a37c[_0x23a3a2(0x1ab)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x3411f5=>{telegramError(_0x3411f5);});_0xea6a3[_0x23a3a2(0x1c0)](_0x3b17e3=>{const _0x38d904=_0x23a3a2;if(_0x3b17e3[_0x38d904(0x1ae)]!=_0x38d904(0x22a))toggleBot(_0x3b17e3[_0x38d904(0x1ae)],toggleStatus(_0x3b17e3[_0x38d904(0x1ae)]),'stopped');});}else{if(settings[_0x23a3a2(0x24a)]==_0x23a3a2(0x1f6))tgBot[_0x23a3a2(0x1d0)](_0x54a37c['chat']['id'],_0x23a3a2(0x28d)+_0x6fc33e)['catch'](_0x396a2c=>{telegramError(_0x396a2c);});toggleBot(_0x6fc33e,toggleStatus(_0x6fc33e),_0x23a3a2(0x257));}}),tgBot[_0x39cb97(0x2b1)](_0x39cb97(0x230));});}}),tgBot[_0x16cebe(0x1d7)](/\/disable/,_0x1aa5f0=>{const _0x195eb7=_0x16cebe;if(!validateTelegram(_0x1aa5f0))return;tgBot['sendMessage'](_0x1aa5f0['chat']['id'],'Notifications\x20disabled')[_0x195eb7(0x183)](_0x46aee8=>{telegramError(_0x46aee8);}),updateSetting(_0x195eb7(0x1d3),![]);}),tgBot[_0x16cebe(0x1d7)](/\/help/,_0x3863a=>{const _0x2a0aec=_0x16cebe;if(!validateTelegram(_0x3863a))return;tgBot[_0x2a0aec(0x1d0)](_0x3863a[_0x2a0aec(0x1ab)]['id'],_0x3a8af4)['catch'](_0x57a9b3=>{telegramError(_0x57a9b3);});}),tgBot['on'](_0x16cebe(0x297),_0x3aa149=>{const _0x1af58b=_0x16cebe;_0x3aa149['toString']()['includes'](_0x1af58b(0x27b))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x1af58b(0x1cf)](),tgBot=null,io['to']('botmanager')[_0x1af58b(0x228)](_0x1af58b(0x1f9),_0x1af58b(0x1a2)));}),process[_0x16cebe(0x2a3)](_0x16cebe(0x2be),()=>{const _0x265b9e=_0x16cebe;if(tgBot)tgBot[_0x265b9e(0x1cf)]();process[_0x265b9e(0x1fa)](0x1);}),process[_0x16cebe(0x2a3)]('SIGTERM',()=>{const _0x90429a=_0x16cebe;if(tgBot)tgBot['stopPolling']();process[_0x90429a(0x1fa)](0x1);});}}function disableTelegram(){const _0x5e0cdb=_0x502ecd;tgBot&&(tgBot[_0x5e0cdb(0x1cf)](),tgBot=null);}function sendTelegram(_0x3d371c,_0x23563c){const _0x4382b2=_0x502ecd;if(settings['telegramEnabled']){if(settings[_0x4382b2(0x24a)]==_0x4382b2(0x22a)||(_0x23563c[_0x4382b2(0x197)]==_0x4382b2(0x224)||_0x23563c[_0x4382b2(0x197)]=='success')&&settings[_0x4382b2(0x24a)]==_0x4382b2(0x23c)||_0x23563c[_0x4382b2(0x197)]==_0x4382b2(0x239)&&settings[_0x4382b2(0x24a)]==_0x4382b2(0x1f6)){if(tgBot&&settings['telegramChatId']){if(_0x23563c[_0x4382b2(0x288)])tgBot[_0x4382b2(0x1d0)](settings[_0x4382b2(0x261)],_0x23563c[_0x4382b2(0x20c)]+_0x4382b2(0x24d)+_0x23563c['event'])[_0x4382b2(0x183)](_0xeaebc2=>{telegramError(_0xeaebc2);});else tgBot[_0x4382b2(0x1d0)](settings[_0x4382b2(0x261)],_0x4382b2(0x25f)+_0x3d371c+_0x4382b2(0x24d)+_0x23563c[_0x4382b2(0x205)])[_0x4382b2(0x183)](_0x44f3e7=>{telegramError(_0x44f3e7);});}}}}function getDeviceWithIp(_0x4f5113){return devices['find'](_0x1a3ce7=>_0x1a3ce7['ip']===_0x4f5113);}function temporaryAccess2FA(_0x1a037a,_0x34f692){const _0x759fc5=_0x502ecd;let _0x2d1351=new Date(),_0x4a2f43=![];if(lastIpApproval){if(_0x2d1351-lastIpApproval<0x1388)_0x4a2f43=!![];}lastIpApproval=new Date();if(_0x4a2f43)return;tgBot&&settings[_0x759fc5(0x261)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x759fc5(0x1d0)](settings[_0x759fc5(0x261)],_0x759fc5(0x1b9)+normalizeIP(_0x34f692)[_0x759fc5(0x29e)]+_0x759fc5(0x2b2),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x759fc5(0x1ca),'callback_data':'5'},{'text':_0x759fc5(0x25c),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x759fc5(0x191),'callback_data':'reject'}]]}})[_0x759fc5(0x183)](_0x1f3114=>{telegramError(_0x1f3114);}),tgBot['on']('callback_query',async _0x2f1125=>{const _0x1260a6=_0x759fc5,_0x352e7c=_0x2f1125[_0x1260a6(0x242)],_0x58db92=_0x2f1125['message'];tgBot[_0x1260a6(0x219)](_0x2f1125['id'])[_0x1260a6(0x266)](async()=>{const _0x3f8885=_0x1260a6;devices[_0x1a037a][_0x3f8885(0x1cc)]={'clientip':_0x34f692,'timestamp':new Date()[_0x3f8885(0x25e)](),'expiry':_0x352e7c},_0x352e7c!='reject'?(await tgBot['sendMessage'](_0x58db92[_0x3f8885(0x1ab)]['id'],_0x3f8885(0x1e7)+_0x352e7c+_0x3f8885(0x1aa),{'parse_mode':_0x3f8885(0x1ea)})['catch'](_0x492dda=>{telegramError(_0x492dda);}),io['to'](_0x1a037a)[_0x3f8885(0x228)](_0x3f8885(0x21c),{'access':{'allow':![],'reason':_0x3f8885(0x2a0),'token':null}})):(await tgBot[_0x3f8885(0x1d0)](_0x58db92[_0x3f8885(0x1ab)]['id'],_0x3f8885(0x1e1))['catch'](_0x2f89cd=>{telegramError(_0x2f89cd);}),io['to'](_0x1a037a)[_0x3f8885(0x228)](_0x3f8885(0x21c),{'access':{'allow':![],'reason':_0x3f8885(0x287),'token':null}}));}),tgBot[_0x1260a6(0x2b1)]('callback_query');}));}function loginAccess2FA(_0x472a1d,_0xbba73a){const _0x25171b=_0x502ecd;tgBot&&settings[_0x25171b(0x261)]&&(tgBot[_0x25171b(0x2b1)](_0x25171b(0x230)),tgBot[_0x25171b(0x1d0)](settings['telegramChatId'],_0x25171b(0x20d)+normalizeIP(_0xbba73a)[_0x25171b(0x29e)]+_0x25171b(0x2b2),{'parse_mode':_0x25171b(0x1ea),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x25171b(0x191),'callback_data':_0x25171b(0x191)}]]}})[_0x25171b(0x183)](_0x5840a8=>{telegramError(_0x5840a8);}),tgBot['on'](_0x25171b(0x230),async _0x40e60c=>{const _0x2bc426=_0x25171b,_0x297a49=_0x40e60c[_0x2bc426(0x242)],_0x5c8309=_0x40e60c[_0x2bc426(0x29c)];tgBot[_0x2bc426(0x219)](_0x40e60c['id'])['then'](async()=>{const _0x5745fa=_0x2bc426;devices[_0x472a1d][_0x5745fa(0x1f0)]={'clientip':_0xbba73a,'timestamp':new Date()[_0x5745fa(0x25e)](),'expiry':_0x297a49},_0x297a49!=_0x5745fa(0x191)?(await tgBot[_0x5745fa(0x1d0)](_0x5c8309[_0x5745fa(0x1ab)]['id'],_0x5745fa(0x245),{'parse_mode':_0x5745fa(0x1ea)})['catch'](_0x4160b8=>{telegramError(_0x4160b8);}),io['to'](_0x472a1d)[_0x5745fa(0x228)](_0x5745fa(0x21c),{'access':{'allow':![],'reason':_0x5745fa(0x2a0),'token':null}})):(await tgBot[_0x5745fa(0x1d0)](_0x5c8309[_0x5745fa(0x1ab)]['id'],'Login\x20rejected')[_0x5745fa(0x183)](_0x4ae22a=>{telegramError(_0x4ae22a);}),io['to'](_0x472a1d)[_0x5745fa(0x228)](_0x5745fa(0x21c),{'access':{'allow':![],'reason':_0x5745fa(0x19f),'token':null}}));}),tgBot['removeListener'](_0x2bc426(0x230));}));}function getConfiguration(){const _0x196cce=_0x502ecd;return dbConfig['get'](_0x196cce(0x269))[_0x196cce(0x1ee)]('botID')[_0x196cce(0x20a)]()||[];}function getEnabledBots(){const _0x2353f0=_0x502ecd;return dbConfig['get'](_0x2353f0(0x269))[_0x2353f0(0x1ee)](_0x2353f0(0x1ae))[_0x2353f0(0x270)]({'status':'enabled'})[_0x2353f0(0x20a)]()||[];}function _0x4a31(){const _0x3131ba=['Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','2FA\x20login\x20token\x20generated','kind','padStart','bot','Crypt','temporary\x20access\x20rejected','showname','login\x20token\x20generated','publicKey','analytics','logout','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','assign','2FA\x20required','lowdb','token','Bot\x20Mgr\x20>\x20','access\x20timeout','copyFileSync','login','7447662zEFNEm','polling_error','stop','\x20/\x20','store-settings','find','message','remove','show','enabled','reload','cloneDeep','length','once','idling\x20bot\x20\x20\x20|\x20Bot\x20','ipc','5SYLnIB','clients','store-configuration','1062854npSIbW','express','split','-performance.json','5079891BidkQR','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','sendFile','randomFillSync','removeListener','</b>\x20?','disabled\x20Bot\x20','getFullYear','running','match','index.html','conn','Error:\x20Invalid\x20argument\x20','name','apply','defaults','disconnect','SIGINT','temporaryAccessAllowed','catch','existsSync','reset-password','Ok,\x20will\x20send\x20order\x20notifications\x20only','kill','whitelist','page','-results.json','readdirSync','referer','isDirectory','All\x20bots\x20running\x20right\x20now','getUTCHours','child_process','reject','getMinutes','success','bb-config.json','node-telegram-bot-api','botmanager','type','Unauthorized\x20attempt\x20to\x20get\x20portfolio','reason','randomBytes','Balance\x20Bot','push','args','1917951REHfCV','2FA\x20login\x20rejected','timestamp','settings.','Invalid\x20Telegram\x20token','search','auth','Unauthorized\x20attempt\x20to\x20update\x20bot','/on\x20-\x20start\x20bot(s)\x0a','login\x20required','Balance\x20Bot\x20Server','from','\x20minutes','chat','getMonth','bot-','botID','timeshift','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','telegramUsername','compareSync','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','36173480MWtKLj','yargs/yargs','deleted\x20Bot\x20','-config.json','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','update-bb','Password\x20has\x20been\x20reset\x20to:\x20','\x20only\x0a','removeAllListeners','live','keys','forEach','Unauthorized\x20attempt\x20to\x20update\x20settings','config/','new','connection','Notifications\x20types:\x20','pidExpireLogin',',\x20must\x20be\x20a\x204\x20digit\x20number','store-headless','toIPv4MappedAddress','5\x20min','Unauthorized\x20login\x20attempt\x20(timeout)','telegramIpApproval','set','hasOwnProperty','stopPolling','sendMessage','telegramToken','loginRequired','telegramEnabled','apiKey','bbUsername','toIPv4Address','onText','storeHeadless','pidRefreshToken','connected','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','starting\x20bot\x20|\x20Bot\x20','temporary\x20token\x20generated','blacklist',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','************','Temporary\x20access\x20rejected','Unauthorized\x20login\x20attempt\x20(public\x20key)','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','\x20|\x20','::ffff:127.0.0.1','All\x20bots','Access\x20enabled\x20for\x20','parse','socket.io','HTML','No\x20authentication\x20token','mkdirSync','new-disabled','sortBy','/restart\x20-\x20restart\x20bot(s)\x0a','telegram2FaApproval','secret','logged\x20out','toString','decrypt','unlinkSync','orders','(((.+)+)+)+$','/disable\x20-\x20disable\x20notifications\x0a','notification','exit','delete-bot','build','inherit','clientip','encryptedUuid','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','isIPv4MappedAddress','update-bot','get','event','version.json','fork','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','log','value','2FA\x20login\x20required','botname','Allow\x20login\x20from\x20IP\x20address\x20<b>','bb/','/help\x20-\x20show\x20available\x20commands\x0a','sockets','slice','disabled','Unauthorized\x20attempt\x20to\x20add\x20bot','sign','privateKey','constructor','starting\x20new\x20bot\x20|\x20Bot\x20','username','answerCallbackQuery','allow','argv','status','get-logs','enabled\x20Bot\x20','https://hodlerhacks.com','<b>Balance\x20Bot\x20status:</b>\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','path','Notifications\x20enabled\x0a','error','sha256','storeConfiguration','login\x20not\x20required','emit','f2aRequired','all','Unauthorized\x20attempt\x20to\x20get\x20logs','login\x20token\x20valid','UA-192771731-1','Invalid\x20IP\x20address','test','callback_query','temporary\x20access\x20not\x20allowed','Notifications\x20enabled','cancel-loading','/:bot/portfolio','started','static','join','1294026gUQuWl','order','bbPassword','remoteAddress','alerts','write','host','/status\x20-\x20show\x20bot(s)\x20status\x0a','headers','server','data','backup/','default','Login\x20accepted','settings','use','initclient','map','telegramEvents','getSeconds','emitHistory','\x20>\x20','port','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','secure','/:bot/performance','access','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Invalid\x20authentication\x20token\x20(2)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','get-starting-balances','stopped','getStartingBalances','telegram','send','whitelistEnabled','15\x20min','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','getTime','Bot\x20','/:bot/support','telegramChatId','127.0.0.1','User\x20has\x20been\x20validated','Orders',':\x20Bot\x20Mgr\x20>\x20','then','-----------------------------------------------------------------------------------','Invalid\x20authentication\x20token\x20(1)','bots','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20log\x20out','function','jsonwebtoken','hashSync','getHours','filter','/enable\x20-\x20enable\x20notifications\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','restarting\x20Bot\x20','bot.js','max','2FA','uuid','@analytics/google-analytics','expiry','NTBA_FIX_319','404\x20Not\x20Found','You\x20can\x20use\x20the\x20following\x20commands:\x0a','build2','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','5227412EKopWR','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances'];_0x4a31=function(){return _0x3131ba;};return _0x4a31();}function getDisabledBots(){const _0x356100=_0x502ecd;return dbConfig['get']('bots')[_0x356100(0x1ee)]('botID')[_0x356100(0x270)]({'status':_0x356100(0x212)})[_0x356100(0x20a)]()||[];}function getSettings(){const _0x31812f=_0x502ecd;return dbSettings[_0x31812f(0x204)](_0x31812f(0x246))[_0x31812f(0x20a)]()||{'timeshift':0x0};}function getSecure(){const _0x380dbf=_0x502ecd;return dbSecure[_0x380dbf(0x204)](_0x380dbf(0x250))[_0x380dbf(0x20a)]()||{};}function getBlacklist(){const _0x1b6ae1=_0x502ecd;return dbSecure[_0x1b6ae1(0x204)]('blacklist')[_0x1b6ae1(0x20a)]()||[];}function broadcastToBots(_0x5c2cfe,_0x17784b){const _0x2764b1=_0x502ecd;config[_0x2764b1(0x1c0)](_0x10be55=>{const _0x4aa986=_0x2764b1;if(_0x10be55[_0x4aa986(0x21c)]==_0x4aa986(0x29f)&&_0x10be55['live']==_0x4aa986(0x2b5)){if(pid[_0x10be55['botID']])pid[_0x10be55['botID']][_0x4aa986(0x25a)]({[_0x5c2cfe]:_0x17784b});}});}function storeSettings(_0x5aa053,_0x4fac09=![]){const _0x252010=_0x502ecd;_0x5aa053={...settings,..._0x5aa053};if(_0x4fac09&&_0x5aa053[_0x252010(0x23a)]!=_0x252010(0x1e0)&&_0x5aa053[_0x252010(0x23a)]!=''){const _0x4813f6=crypt[_0x252010(0x1f4)](secure[_0x252010(0x215)],_0x5aa053[_0x252010(0x23a)])[_0x252010(0x29c)][_0x252010(0x2ab)]('@')[0x0],_0x51209c=bcrypt['hashSync'](_0x4813f6,saltRounds);_0x5aa053={..._0x5aa053,'bbPassword':_0x51209c};}if(_0x4fac09&&_0x5aa053[_0x252010(0x1d1)]!=_0x252010(0x1e0)&&_0x5aa053[_0x252010(0x1d1)]!=''){const _0x28b8c4=crypt[_0x252010(0x1f4)](secure['privateKey'],_0x5aa053[_0x252010(0x1d1)])['message'][_0x252010(0x2ab)]('@')[0x0];_0x5aa053={..._0x5aa053,'telegramToken':_0x28b8c4};}const _0x1d79df=_0x5aa053[_0x252010(0x1d1)]!='************'&&_0x5aa053[_0x252010(0x1d1)]!=settings[_0x252010(0x1d1)]||_0x5aa053[_0x252010(0x1b2)]!=settings[_0x252010(0x1b2)],_0x5cb5bc=_0x5aa053[_0x252010(0x1d1)]==''||_0x5aa053[_0x252010(0x1b2)]=='';if(_0x1d79df)_0x5aa053[_0x252010(0x24a)]=_0x252010(0x22a);for(const [_0x428602,_0x118784]of Object['entries'](_0x5aa053)){if(_0x428602==_0x252010(0x1d1)&&_0x118784==_0x252010(0x1e0)){_0x5aa053['telegramToken']=settings[_0x252010(0x1d1)];continue;};if(_0x428602==_0x252010(0x23a)&&_0x118784==_0x252010(0x1e0)){_0x5aa053[_0x252010(0x23a)]=settings['bbPassword'];continue;};dbSettings['set'](_0x252010(0x1a1)+_0x428602,_0x118784)[_0x252010(0x23d)]();}settings=_0x5aa053,io['to']('botmanager')[_0x252010(0x228)]('settings',cleanSettings()),broadcastToBots(_0x252010(0x1af),settings['timeshift']);if(_0x1d79df&&!_0x5cb5bc)initTelegram();if(_0x1d79df&&_0x5cb5bc)disableTelegram();getAllClients()['forEach'](_0x535a57=>{const _0xecafff=_0x252010;getSocket(_0x535a57['id'])[_0xecafff(0x228)](_0xecafff(0x21c),{'access':{'allow':![],'reason':_0xecafff(0x2a0),'token':null}});});}function updateSetting(_0x772908,_0x541249){const _0x137c6d=_0x502ecd;dbSettings[_0x137c6d(0x1cd)](_0x137c6d(0x1a1)+_0x772908,_0x541249)[_0x137c6d(0x23d)](),settings=getSettings(),io['to']('botmanager')[_0x137c6d(0x228)](_0x137c6d(0x246),cleanSettings());}function storeSecure(_0x47c667){const _0x42f449=_0x502ecd;dbSecure[_0x42f449(0x204)]('secure')[_0x42f449(0x19c)](_0x47c667)[_0x42f449(0x23d)](),secure=_0x47c667;}function addBlacklist(_0x2a5b3a){const _0x2b4836=_0x502ecd;cleanBlacklist();let _0xb17b5f;devices[_0x2a5b3a][_0x2b4836(0x1cc)]?_0xb17b5f=Math[_0x2b4836(0x275)](devices[_0x2a5b3a][_0x2b4836(0x1cc)][_0x2b4836(0x279)],loginExpiry):_0xb17b5f=loginExpiry,dbSecure['get'](_0x2b4836(0x1de))['push']({'expiry':new Date()[_0x2b4836(0x25e)]()+_0xb17b5f*0x3c*0x3e8,'token':devices[_0x2a5b3a]['access']['token']})[_0x2b4836(0x23d)](),blacklist=dbSecure['get'](_0x2b4836(0x1de))[_0x2b4836(0x20a)]();}function cleanBlacklist(){const _0x33e7ba=_0x502ecd;let _0x3fac09=dbSecure[_0x33e7ba(0x204)](_0x33e7ba(0x1de))[_0x33e7ba(0x2a1)]()[_0x33e7ba(0x20a)](),_0x531f65=new Date()[_0x33e7ba(0x25e)]();_0x3fac09[_0x33e7ba(0x1c0)](_0x33f5de=>{const _0x1df717=_0x33e7ba;_0x33f5de[_0x1df717(0x279)]<_0x531f65&&dbSecure[_0x1df717(0x204)](_0x1df717(0x1de))[_0x1df717(0x29d)]({'expiry':_0x33f5de['expiry']})[_0x1df717(0x23d)]();});}function initStates(){const _0x461b80=_0x502ecd;let _0x5c2daf=getConfiguration();_0x5c2daf[_0x461b80(0x1c0)](_0x5c2ba6=>{const _0x48536d=_0x461b80;_0x5c2ba6[_0x48536d(0x1be)]=_0x48536d(0x257);}),storeConfiguration(_0x5c2daf);}function onKeys(){const _0x998393=new RSA();return new Promise(_0x137c16=>{const _0x5eda0a=_0xd83d;_0x998393['generateKeyPairAsync']()[_0x5eda0a(0x266)](_0x5e959e=>{_0x137c16(_0x5e959e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x44201a=_0x502ecd;let _0x1db7b5=getConfiguration(),_0x283d4c=![];_0x1db7b5[_0x44201a(0x1c0)](_0x1ad793=>{const _0x3a3e23=_0x44201a;if(_0x1ad793[_0x3a3e23(0x21c)]=='running')_0x1ad793[_0x3a3e23(0x21c)]='enabled',_0x283d4c=!![];else _0x1ad793['status']=='stopped'&&(_0x1ad793[_0x3a3e23(0x21c)]=_0x3a3e23(0x212),_0x283d4c=!![]);});if(_0x283d4c)storeConfiguration(_0x1db7b5);let _0x2b8853=getSecure();if(!_0x2b8853[_0x44201a(0x1ce)](_0x44201a(0x1f1))){let _0x8ace79=await generateKeys();_0x2b8853[_0x44201a(0x28a)]=_0x8ace79['publicKey'],_0x2b8853[_0x44201a(0x215)]=_0x8ace79[_0x44201a(0x215)],_0x2b8853['secret']=crypto[_0x44201a(0x19a)](0x20)['toString']('hex');;storeSecure(_0x2b8853);}let _0x5c64cf=getSettings();_0x283d4c=![];!_0x5c64cf['hasOwnProperty'](_0x44201a(0x1d2))&&(_0x5c64cf[_0x44201a(0x1d2)]=![],_0x5c64cf['bbUsername']='',_0x5c64cf[_0x44201a(0x23a)]='',_0x5c64cf[_0x44201a(0x229)]=![],_0x283d4c=!![]);!_0x5c64cf[_0x44201a(0x1ce)]('whitelistEnabled')&&(_0x5c64cf[_0x44201a(0x25b)]=![],_0x5c64cf[_0x44201a(0x188)]=[],_0x5c64cf[_0x44201a(0x2bf)]=![],_0x283d4c=!![]);if(!_0x5c64cf['hasOwnProperty'](_0x44201a(0x1d3))){if(_0x5c64cf[_0x44201a(0x261)])_0x5c64cf['telegramEnabled']=!![];else _0x5c64cf[_0x44201a(0x1d3)]=![];_0x283d4c=!![];}if(_0x283d4c)storeSettings(_0x5c64cf);}function storeConfiguration(_0x388752){const _0xd12c80=_0x502ecd;dbConfig[_0xd12c80(0x204)](_0xd12c80(0x269))[_0xd12c80(0x29d)]()['write'](),dbConfig[_0xd12c80(0x204)](_0xd12c80(0x269))[_0xd12c80(0x19c)](..._0x388752)[_0xd12c80(0x23d)](),config=_0x388752;}function resetPassword(){const _0x1ad171=_0x502ecd;tgBot&&settings[_0x1ad171(0x261)]&&(tgBot[_0x1ad171(0x2b1)]('callback_query'),tgBot[_0x1ad171(0x1d0)](settings[_0x1ad171(0x261)],_0x1ad171(0x255),{'parse_mode':_0x1ad171(0x1ea),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1e596b=>{telegramError(_0x1e596b);}),tgBot['on']('callback_query',async _0x581f53=>{const _0xd488e1=_0x1ad171,_0x199b9e=_0x581f53['data'],_0x11d127=_0x581f53[_0xd488e1(0x29c)];tgBot['answerCallbackQuery'](_0x581f53['id'])['then'](async()=>{const _0x49683d=_0xd488e1;if(_0x199b9e!='no'){const _0x37e942=0xf,_0x20b119=_0x49683d(0x221),_0x1cae69=Array[_0x49683d(0x1a9)](crypto[_0x49683d(0x2b0)](new Uint32Array(_0x37e942)))[_0x49683d(0x249)](_0x4764f5=>_0x20b119[_0x4764f5%_0x20b119[_0x49683d(0x2a2)]])[_0x49683d(0x237)](''),_0x4d7b15=bcrypt[_0x49683d(0x26e)](_0x1cae69,saltRounds);storeSettings({'bbPassword':_0x4d7b15}),await tgBot[_0x49683d(0x1d0)](_0x11d127['chat']['id'],_0x49683d(0x1bb)+_0x1cae69,{'parse_mode':_0x49683d(0x1ea)})[_0x49683d(0x183)](_0x5f5191=>{telegramError(_0x5f5191);});}else await tgBot[_0x49683d(0x1d0)](_0x11d127[_0x49683d(0x1ab)]['id'],'Password\x20reset\x20rejected')[_0x49683d(0x183)](_0x3fc5ed=>{telegramError(_0x3fc5ed);});}),tgBot[_0xd488e1(0x2b1)](_0xd488e1(0x230));}));}function logging(_0x5c5a17){const _0x83c35b=_0x502ecd;console[_0x83c35b(0x209)](getTimeStamp()+_0x83c35b(0x265)+_0x5c5a17);if(tgBot&&settings[_0x83c35b(0x261)]&&settings[_0x83c35b(0x24a)]!=_0x83c35b(0x1f6))tgBot['sendMessage'](settings[_0x83c35b(0x261)],_0x83c35b(0x292)+_0x5c5a17)[_0x83c35b(0x183)](_0x1bea6a=>{telegramError(_0x1bea6a);});}function getServerTime(){const _0x5e76c5=_0x502ecd,_0x14ef2c=new Date();return _0x14ef2c[_0x5e76c5(0x2b4)]()+'/'+(_0x14ef2c['getMonth']()+0x1)['toString']()[_0x5e76c5(0x284)](0x2,'0')+'/'+_0x14ef2c['getDate']()[_0x5e76c5(0x1f3)]()[_0x5e76c5(0x284)](0x2,'0')+'\x20'+_0x14ef2c[_0x5e76c5(0x26f)]()[_0x5e76c5(0x1f3)]()[_0x5e76c5(0x284)](0x2,'0')+':'+_0x14ef2c['getMinutes']()[_0x5e76c5(0x1f3)]()[_0x5e76c5(0x284)](0x2,'0')+':'+_0x14ef2c[_0x5e76c5(0x24b)]()['toString']()[_0x5e76c5(0x284)](0x2,'0');}function getTimeStamp(){const _0x4d8307=_0x502ecd,_0x3e9084=shiftedTime();return _0x3e9084[_0x4d8307(0x2b4)]()+'/'+(_0x3e9084[_0x4d8307(0x1ac)]()+0x1)['toString']()[_0x4d8307(0x284)](0x2,'0')+'/'+_0x3e9084['getDate']()[_0x4d8307(0x1f3)]()[_0x4d8307(0x284)](0x2,'0')+'\x20'+_0x3e9084[_0x4d8307(0x26f)]()[_0x4d8307(0x1f3)]()[_0x4d8307(0x284)](0x2,'0')+':'+_0x3e9084[_0x4d8307(0x192)]()[_0x4d8307(0x1f3)]()[_0x4d8307(0x284)](0x2,'0')+':'+_0x3e9084[_0x4d8307(0x24b)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x544027=_0x502ecd,_0x465717=new Date();let _0x10a8cc=_0x465717;if(settings[_0x544027(0x1af)]&&settings['timeshift']!==0x0)_0x10a8cc=fns['add'](_0x465717,{'hours':settings['timeshift']});return _0x10a8cc;}function startScheduler(){const _0x3e3898=_0x502ecd;let _0x121f65=new Date()[_0x3e3898(0x18f)]();_0x121f65==0x1&&backupConfigFiles();_0x121f65==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x3b4e2d=_0x502ecd;fs[_0x3b4e2d(0x18b)](configpath,{'withFileTypes':!![]})[_0x3b4e2d(0x1c0)](_0x5a5087=>{const _0x48c0fb=_0x3b4e2d;if(!_0x5a5087[_0x48c0fb(0x18d)]())fs[_0x48c0fb(0x294)](configpath+_0x5a5087[_0x48c0fb(0x2ba)],configbackuppath+_0x5a5087[_0x48c0fb(0x2ba)]);});}function triggerAnalytics(){const _0x187e4d=_0x502ecd;analytics[_0x187e4d(0x189)]({'title':_0x187e4d(0x1a8),'href':_0x187e4d(0x21f),'path':'/v'+serverversion});}function validateCredentials(_0x8f65b2,_0x15d7c8){const _0x597b7b=_0x502ecd;if(_0x8f65b2[_0x597b7b(0x218)]==settings[_0x597b7b(0x1d5)]&&bcrypt[_0x597b7b(0x1b3)](_0x8f65b2['password'],settings[_0x597b7b(0x23a)])){if(settings[_0x597b7b(0x229)])return{'allow':![],'reason':_0x597b7b(0x20b),'token':null};else{const _0x301969=generateLoginToken(_0x15d7c8);return{'allow':!![],'reason':_0x597b7b(0x289),'token':_0x301969};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x480e5){const _0x5a9523=_0x502ecd,_0x33c0f2=generateLoginToken(_0x480e5);return{'allow':!![],'reason':_0x5a9523(0x289),'token':_0x33c0f2};}function validateAccess(_0x170ffb,_0x39c540){const _0x2e5698=_0x502ecd;let _0x48f08d=devices[_0x39c540]['ip'],_0x30ae37;const _0x5708eb=_0x29138a=>{const _0x1f61eb=_0xd83d;if(settings[_0x1f61eb(0x1d2)]){if(settings[_0x1f61eb(0x229)]){if(telegram2FaApproved(_0x39c540)){const _0xdfa894=generateLoginToken(_0x39c540);return{'allow':!![],'reason':_0x1f61eb(0x282),'token':_0xdfa894};}else return{'allow':![],'reason':_0x1f61eb(0x1a7),'token':null};}else return _0x30ae37=validToken(_0x29138a,_0x39c540),_0x30ae37[_0x1f61eb(0x1ce)](_0x1f61eb(0x193))?{'allow':!![],'reason':_0x1f61eb(0x22c),'token':_0x29138a}:{'allow':![],'reason':_0x1f61eb(0x1a7),'token':null};}else return{'allow':!![],'reason':_0x1f61eb(0x227),'token':null};};if(settings['whitelistEnabled']){let _0x58fcb2=[...settings[_0x2e5698(0x188)],'::1',_0x2e5698(0x1e5),_0x2e5698(0x262)];if(_0x58fcb2['includes'](_0x48f08d))return _0x5708eb(_0x170ffb);else{_0x30ae37=validToken(_0x170ffb,_0x39c540);if(_0x30ae37[_0x2e5698(0x1ce)](_0x2e5698(0x193)))return _0x5708eb(_0x170ffb);else{if(telegramIpApproved(_0x39c540)){const _0x2dafbd=generateToken(_0x39c540);return _0x30ae37=_0x5708eb(_0x170ffb),_0x30ae37['allow']?{'allow':!![],'reason':_0x2e5698(0x1dd),'token':_0x2dafbd}:_0x30ae37;}else return settings[_0x2e5698(0x2bf)]?{'allow':![],'reason':_0x2e5698(0x28f),'token':null}:{'allow':![],'reason':_0x2e5698(0x231),'token':null};}}}else return _0x5708eb(_0x170ffb);}function timelyDecrypt(_0x7c492d,_0x3fcf76=!![]){const _0x555ae4=_0x502ecd;if(_0x7c492d)try{const _0x4b1428=crypt['decrypt'](secure[_0x555ae4(0x215)],_0x7c492d)[_0x555ae4(0x29c)],_0x1ad728=_0x4b1428[_0x555ae4(0x2ab)]('@')[0x0],_0x385668=_0x4b1428['split']('@')[0x1],_0x34526e=new Date()['getTime']();if(_0x3fcf76){if(_0x34526e-_0x385668<maxSecretAge*0x3e8)return _0x1ad728;else return![];}else return _0x1ad728;}catch(_0x59feb1){return![];}else return![];}const validToken=(_0x54bda2,_0x125e3c)=>{const _0x29e5d0=_0x502ecd,_0x15445f=devices[_0x125e3c]['ip'];if(!_0x54bda2)return{'error':_0x29e5d0(0x1eb)};for(let _0x2c72c8 of blacklist){if(_0x2c72c8['token']==_0x54bda2)return{'error':'Token\x20blacklisted'};}let _0xb548f8;try{_0xb548f8=jwt['verify'](_0x54bda2,secure[_0x29e5d0(0x1f1)]+_0x125e3c);}catch{return{'error':_0x29e5d0(0x268)};}if(!_0xb548f8[_0x29e5d0(0x1ce)](_0x29e5d0(0x1fe))&&!_0xb548f8[_0x29e5d0(0x1ce)](_0x29e5d0(0x218))||!_0xb548f8[_0x29e5d0(0x1ce)]('exp'))return{'error':_0x29e5d0(0x254)};if(!_0xb548f8[_0x29e5d0(0x1ce)]('username')&&_0xb548f8['hasOwnProperty'](_0x29e5d0(0x1fe))){const {clientip:_0x4e76b8}=_0xb548f8;return _0x15445f==_0x4e76b8?{'success':_0x29e5d0(0x263)}:{'error':_0x29e5d0(0x22e)};}else{if(_0xb548f8[_0x29e5d0(0x1ce)](_0x29e5d0(0x218))&&_0xb548f8['hasOwnProperty'](_0x29e5d0(0x1fe))){const {username:_0x33349a,clientip:_0x1f0a72}=_0xb548f8;return settings[_0x29e5d0(0x1d5)]==_0x33349a&&_0x15445f==_0x1f0a72?{'success':_0x29e5d0(0x263)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x5524b4=>{const _0x3e4438=_0x502ecd;if(_0x5524b4){const _0x280877=devices[_0x5524b4]['ip'];return jwt['sign']({'username':settings[_0x3e4438(0x1d5)],'clientip':_0x280877},secure[_0x3e4438(0x1f1)]+_0x5524b4,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5b0a7d=>{const _0x24a06c=_0x502ecd;if(_0x5b0a7d){const _0x5989de=devices[_0x5b0a7d]['ip'];return jwt[_0x24a06c(0x214)]({'clientip':_0x5989de},secure[_0x24a06c(0x1f1)]+_0x5b0a7d,{'expiresIn':devices[_0x5b0a7d]['telegramIpApproval'][_0x24a06c(0x279)]*0x3c});}else return![];},telegramIpApproved=_0x2eede6=>{const _0x333c26=_0x502ecd;let _0x8b72ff=![];return devices[_0x2eede6][_0x333c26(0x1cc)]&&devices[_0x2eede6][_0x333c26(0x1cc)][_0x333c26(0x279)]!=_0x333c26(0x191)&&(_0x8b72ff=devices[_0x2eede6][_0x333c26(0x1cc)][_0x333c26(0x1fe)]==devices[_0x2eede6]['ip']&&new Date()['getTime']()-devices[_0x2eede6]['telegramIpApproval'][_0x333c26(0x1a0)]<devices[_0x2eede6][_0x333c26(0x1cc)][_0x333c26(0x279)]*0x3c*0x3e8),_0x8b72ff;},telegram2FaApproved=_0x397444=>{const _0x4b0743=_0x502ecd;let _0x4f0e63=![];return devices[_0x397444][_0x4b0743(0x1f0)]&&devices[_0x397444]['telegram2FaApproval']['expiry']!=_0x4b0743(0x191)&&(_0x4f0e63=devices[_0x397444]['telegram2FaApproval'][_0x4b0743(0x1fe)]==devices[_0x397444]['ip']&&new Date()[_0x4b0743(0x25e)]()-devices[_0x397444]['telegram2FaApproval']['timestamp']<devices[_0x397444][_0x4b0743(0x1f0)][_0x4b0743(0x279)]*0x3c*0x3e8),_0x4f0e63;},normalizeIP=_0x34d8b1=>{const _0x2541e0=_0x502ecd;let _0x419abe=null,_0x5a07fa=null;if(ipaddr['isValid'](_0x34d8b1)){const _0x5e1c56=ipaddr[_0x2541e0(0x1e8)](_0x34d8b1);_0x5e1c56[_0x2541e0(0x283)]()==='ipv6'?(_0x5e1c56[_0x2541e0(0x202)]()&&(_0x419abe=_0x5e1c56[_0x2541e0(0x1d6)]()[_0x2541e0(0x1f3)]()),_0x5a07fa=_0x5e1c56['toString']()):(_0x419abe=_0x5e1c56[_0x2541e0(0x1f3)](),_0x5a07fa=_0x5e1c56[_0x2541e0(0x1c9)]()[_0x2541e0(0x1f3)]());}return{'show':_0x419abe?_0x419abe:_0x5a07fa,'store':_0x5a07fa};};