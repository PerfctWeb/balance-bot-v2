const _0x2a1284=_0x26ea;(function(_0x291254,_0x1c5dbc){const _0x29722e=_0x26ea,_0x1218b6=_0x291254();while(!![]){try{const _0x57959c=parseInt(_0x29722e(0x1ff))/0x1+-parseInt(_0x29722e(0x1d9))/0x2*(-parseInt(_0x29722e(0x210))/0x3)+parseInt(_0x29722e(0x227))/0x4+parseInt(_0x29722e(0x216))/0x5*(parseInt(_0x29722e(0x254))/0x6)+-parseInt(_0x29722e(0x278))/0x7*(parseInt(_0x29722e(0x1da))/0x8)+-parseInt(_0x29722e(0x307))/0x9*(-parseInt(_0x29722e(0x266))/0xa)+-parseInt(_0x29722e(0x223))/0xb;if(_0x57959c===_0x1c5dbc)break;else _0x1218b6['push'](_0x1218b6['shift']());}catch(_0x3ed8e4){_0x1218b6['push'](_0x1218b6['shift']());}}}(_0x1054,0x41d0c));const _0x51b5c1=function(){let _0x436d58=!![];return function(_0x15234a,_0x430cd7){const _0x510ff3=_0x436d58?function(){const _0x17d9e8=_0x26ea;if(_0x430cd7){const _0x36e998=_0x430cd7[_0x17d9e8(0x1e4)](_0x15234a,arguments);return _0x430cd7=null,_0x36e998;}}:function(){};return _0x436d58=![],_0x510ff3;};}(),_0x5d4c85=_0x51b5c1(this,function(){const _0x2d23ce=_0x26ea;return _0x5d4c85[_0x2d23ce(0x284)]()[_0x2d23ce(0x2d4)](_0x2d23ce(0x269))['toString']()[_0x2d23ce(0x21d)](_0x5d4c85)[_0x2d23ce(0x2d4)](_0x2d23ce(0x269));});_0x5d4c85();'use strict';process[_0x2a1284(0x2aa)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x2a1284(0x1fd)),FileSync=require(_0x2a1284(0x25d)),fs=require('fs'),fns=require(_0x2a1284(0x2e5)),low=require('lowdb'),path=require('path'),crypto=require(_0x2a1284(0x226)),Crypt=require('hybrid-crypto-js')[_0x2a1284(0x205)],RSA=require(_0x2a1284(0x276))['RSA'],bcrypt=require(_0x2a1284(0x2d3)),jwt=require(_0x2a1284(0x1e9)),analyticsLib=require('analytics')[_0x2a1284(0x246)],googleAnalytics=require('@analytics/google-analytics')[_0x2a1284(0x246)],ipaddr=require(_0x2a1284(0x2bc)),argv=require('yargs/yargs')(process[_0x2a1284(0x29b)][_0x2a1284(0x1f8)](0x2))[_0x2a1284(0x29b)],PORT=argv['port']||_0x2a1284(0x293),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x2a1284(0x2ac)](PORT))return console[_0x2a1284(0x29e)](_0x2a1284(0x242)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x2a1284(0x2f9)](0x1);const HOST=argv[_0x2a1284(0x1e5)]||null,userID=argv[_0x2a1284(0x271)]||'';let bbpath=_0x2a1284(0x295),bbpath2='';const botfile=_0x2a1284(0x2d5),configfile=_0x2a1284(0x267),settingsfile=_0x2a1284(0x2a9),securefile=_0x2a1284(0x225);!fs[_0x2a1284(0x25c)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2a1284(0x30d)),configpath=userID?bbpath+_0x2a1284(0x259)+userID+'/':bbpath+_0x2a1284(0x259),configbackuppath=configpath+_0x2a1284(0x21c);!fs['existsSync'](configpath)&&fs[_0x2a1284(0x22a)](configpath);!fs[_0x2a1284(0x25c)](configbackuppath)&&fs[_0x2a1284(0x22a)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2a1284(0x268)]({'bots':[]})[_0x2a1284(0x2a5)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2a1284(0x268)]({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2a1284(0x268)]({'secure':{},'blacklist':[]})[_0x2a1284(0x2a5)]();let crypt=new Crypt({'md':_0x2a1284(0x2a3),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2a1284(0x2fa))['version'];console['log']('server:',serverversion);const maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require('http')[_0x2a1284(0x243)](app);app[_0x2a1284(0x247)](express['static'](path[_0x2a1284(0x309)](__dirname,bbpath,_0x2a1284(0x202)))),app['use'](express['static'](path['join'](__dirname,bbpath,_0x2a1284(0x2ba)))),app[_0x2a1284(0x26c)]('/',function(_0x5d0f75,_0xec5e3f){const _0xad38a2=_0x2a1284;_0xec5e3f[_0xad38a2(0x28c)](path['join'](__dirname,bbpath,_0xad38a2(0x202),_0xad38a2(0x249)));}),app[_0x2a1284(0x26c)](_0x2a1284(0x260),function(_0x55a845,_0x3d7bd8){const _0x300f5e=_0x2a1284;_0x3d7bd8[_0x300f5e(0x28c)](path[_0x300f5e(0x309)](__dirname,bbpath,_0x300f5e(0x2ba),'index.html'));}),app[_0x2a1284(0x26c)]('/:bot/portfolio',(_0x3c156e,_0x1f6203)=>{const _0x465e18=_0x2a1284;_0x1f6203['sendFile'](path[_0x465e18(0x309)](__dirname,bbpath,_0x465e18(0x2ba),_0x465e18(0x249)));}),app[_0x2a1284(0x26c)]('/:bot/performance',(_0x5b678b,_0x35781f)=>{const _0x374f4e=_0x2a1284;_0x35781f[_0x374f4e(0x28c)](path['join'](__dirname,bbpath,_0x374f4e(0x2ba),_0x374f4e(0x249)));}),app[_0x2a1284(0x26c)](_0x2a1284(0x2b5),(_0x5353c8,_0x1828bf)=>{const _0x532b65=_0x2a1284;_0x1828bf[_0x532b65(0x28c)](path[_0x532b65(0x309)](__dirname,bbpath,_0x532b65(0x2ba),'index.html'));}),app[_0x2a1284(0x26c)]('/:bot/history',(_0x54c9c6,_0x288f9c)=>{const _0x571b9e=_0x2a1284;_0x288f9c[_0x571b9e(0x28c)](path['join'](__dirname,bbpath,_0x571b9e(0x2ba),_0x571b9e(0x249)));}),app[_0x2a1284(0x26c)]('/:bot/configuration',(_0x3d21d7,_0x3303e7)=>{const _0x275c4e=_0x2a1284;_0x3303e7['sendFile'](path['join'](__dirname,bbpath,_0x275c4e(0x2ba),'index.html'));}),app[_0x2a1284(0x26c)]('/:bot/support',(_0x3fd1dd,_0x317201)=>{const _0x50a790=_0x2a1284;_0x317201['sendFile'](path[_0x50a790(0x309)](__dirname,bbpath,_0x50a790(0x2ba),_0x50a790(0x249)));});if(HOST)http[_0x2a1284(0x304)](PORT,HOST);else http[_0x2a1284(0x304)](PORT);const io=require(_0x2a1284(0x2f4))(http,{}),analytics=analyticsLib({'app':_0x2a1284(0x2d1),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x2a1284(0x1ed));let tgBot;if(settings[_0x2a1284(0x2f0)]&&settings[_0x2a1284(0x2f0)]!=''&&settings['telegramUsername']&&settings[_0x2a1284(0x1fe)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x12b80a=_0x2a1284;console[_0x12b80a(0x29e)](''),console[_0x12b80a(0x29e)](_0x12b80a(0x1dd)),logging(_0x12b80a(0x20f)+PORT),console[_0x12b80a(0x29e)](_0x12b80a(0x1dd));if(config[_0x12b80a(0x2d2)]!=0x0)config['forEach'](_0x142153=>{const _0x4c284c=_0x12b80a;if(_0x142153[_0x4c284c(0x24a)]=='enabled'||_0x142153[_0x4c284c(0x24a)]==_0x4c284c(0x25f))logging('starting\x20bot\x20|\x20Bot\x20'+_0x142153[_0x4c284c(0x21e)]+_0x4c284c(0x30c)+_0x142153[_0x4c284c(0x234)]),startBot([_0x142153['botID'],userID],{'cwd':bbpath},function(_0x4ab783){if(_0x4ab783)logging(_0x4ab783);});else(_0x142153[_0x4c284c(0x24a)]=='disabled'||_0x142153['status']==_0x4c284c(0x30b))&&logging(_0x4c284c(0x230)+_0x142153[_0x4c284c(0x21e)]+'\x20|\x20'+_0x142153[_0x4c284c(0x234)]);});else!newBot&&console[_0x12b80a(0x29e)](_0x12b80a(0x264));if(newBot)addBot();console[_0x12b80a(0x29e)](_0x12b80a(0x1dd)),console[_0x12b80a(0x29e)]('');}function startSocket(){io['on']('connection',_0x16b1be=>{const _0x5248e4=_0x26ea;let _0x1659dc,_0x4a217b,_0x49505e,_0x1a29c4,_0x5c0729;const _0xfb98cf=_0x16b1be[_0x5248e4(0x21a)][_0x5248e4(0x236)][_0x5248e4(0x2ce)];_0x4a217b=_0xfb98cf[_0x5248e4(0x1eb)](/bot[0-9]{3}/);if(_0x4a217b)_0x49505e=_0x4a217b[0x0][_0x5248e4(0x1eb)](/[0-9]{3}/);if(_0x49505e)_0x1659dc=_0x49505e[0x0];else _0x1659dc=_0x5248e4(0x1e7);const _0x16363b=_0x16b1be[_0x5248e4(0x21a)][_0x5248e4(0x1fb)]['encryptedUuid'];if(!_0x16363b)_0x16b1be['emit'](_0x5248e4(0x24a),{'publicKey':secure[_0x5248e4(0x2fe)]});else{_0x1a29c4=timelyDecrypt(_0x16363b,![]);if(!_0x1a29c4)logging(_0x5248e4(0x287));else{_0x5c0729=normalizeIP(_0x16b1be[_0x5248e4(0x24b)][_0x5248e4(0x22d)])[_0x5248e4(0x22f)];if(!devices[_0x1a29c4])devices[_0x1a29c4]={'uuid':_0x1a29c4,'access':{'token':null}};devices[_0x1a29c4]['ip']=_0x5c0729;const _0x157999=addClient(_0x16b1be['id'],_0x1a29c4,_0x1659dc);setAccess(_0x157999),_0x16b1be['on'](_0x5248e4(0x23b),_0x369c60=>{const _0x1cdb26=_0x5248e4,_0x467df0=timelyDecrypt(_0x369c60[_0x1cdb26(0x211)]);if(_0x467df0){_0x369c60={'username':_0x369c60[_0x1cdb26(0x2bb)],'password':_0x467df0},devices[_0x1a29c4][_0x1cdb26(0x1f2)]=validateCredentials(_0x369c60,_0x1a29c4);if(devices[_0x1a29c4]['access'][_0x1cdb26(0x298)]==![]&&devices[_0x1a29c4][_0x1cdb26(0x1f2)][_0x1cdb26(0x311)]==_0x1cdb26(0x22e))_0x16b1be[_0x1cdb26(0x303)](_0x1cdb26(0x24a),{'access':devices[_0x1a29c4][_0x1cdb26(0x1f2)]}),loginAccess2FA(_0x1a29c4,_0x5c0729);else{if(devices[_0x1a29c4][_0x1cdb26(0x1f2)][_0x1cdb26(0x298)]==![]&&devices[_0x1a29c4][_0x1cdb26(0x1f2)]['reason']==_0x1cdb26(0x296))_0x16b1be[_0x1cdb26(0x303)](_0x1cdb26(0x24a),{'access':devices[_0x1a29c4][_0x1cdb26(0x1f2)]});else devices[_0x1a29c4][_0x1cdb26(0x1f2)][_0x1cdb26(0x298)]&&devices[_0x1a29c4][_0x1cdb26(0x1f2)][_0x1cdb26(0x311)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1a29c4)['forEach'](_0x155091=>{setAccess(_0x155091);}),setTokenRefresh(_0x1a29c4),setSessionTimeout(_0x1cdb26(0x23b),_0x1a29c4));}}else logging(_0x1cdb26(0x2eb));}),_0x16b1be['on'](_0x5248e4(0x280),()=>{resetPassword();}),_0x16b1be['on'](_0x5248e4(0x2ef),_0x345bac=>{removeClient(_0x16b1be['id']);});}}});}function initClient(_0x87cafe){const _0x4e10b2=_0x2a1284;if(_0x87cafe!=_0x4e10b2(0x1e7)&&config[_0x4e10b2(0x245)]!=''){if(pid[_0x87cafe])pid[_0x87cafe]['send']({'function':_0x4e10b2(0x294),'args':null});}}function getSocket(_0xaf96f9){const _0xe078f4=_0x2a1284;return io[_0xe078f4(0x2f6)][_0xe078f4(0x2f6)][_0xe078f4(0x26c)](_0xaf96f9);}function setAccess(_0x403cc8){const _0x268b4d=_0x2a1284,_0x36c17f=getSocket(_0x403cc8['id']),_0xf24626=_0x403cc8[_0x268b4d(0x2c0)],_0x1f9f10=_0x403cc8[_0x268b4d(0x1f1)];devices[_0xf24626][_0x268b4d(0x1f2)]=validateAccess(devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x1f4)],_0xf24626),_0x36c17f['join'](_0xf24626);if(devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x298)]){_0x36c17f[_0x268b4d(0x309)](_0x1f9f10);if(_0x1f9f10==_0x268b4d(0x1e7))initializeSocketBotManager(_0x36c17f);else initializeSocketBot(_0x36c17f);initClient(_0x1f9f10);}devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x1f4)]&&devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x311)]==_0x268b4d(0x302)&&setSessionTimeout(_0x268b4d(0x2b4),_0xf24626),devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x1f4)]&&devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x311)]==_0x268b4d(0x1ea)&&setSessionTimeout(_0x268b4d(0x23b),_0xf24626),_0x36c17f[_0x268b4d(0x303)]('status',{'status':_0x403cc8[_0x268b4d(0x2a0)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xf24626]['access'],'externalip':devices[_0xf24626]['ip'],'publicKey':secure[_0x268b4d(0x2fe)]}),devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x298)]==![]&&devices[_0xf24626][_0x268b4d(0x1f2)][_0x268b4d(0x311)]==_0x268b4d(0x30a)&&temporaryAccess2FA(_0xf24626,devices[_0xf24626]['ip']);}function setSessionTimeout(_0x2a831e,_0x11ce1f){const _0x2239c8=_0x2a1284;let _0x10293f;if(_0x2a831e=='login')_0x10293f=loginExpiry*0x3c*0x3e8;else _0x10293f=devices[_0x11ce1f][_0x2239c8(0x274)][_0x2239c8(0x1f5)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x11ce1f][_0x2239c8(0x274)][_0x2239c8(0x2f7)]);if(devices[_0x11ce1f][_0x2239c8(0x2a6)])clearTimeout(devices[_0x11ce1f][_0x2239c8(0x2a6)]);devices[_0x11ce1f][_0x2239c8(0x2a6)]=setTimeout(()=>{const _0x1487bd=_0x2239c8;if(devices[_0x11ce1f]['pidRefreshToken'])clearTimeout(devices[_0x11ce1f][_0x1487bd(0x2cf)]);removeSocketListeners(_0x11ce1f),addBlacklist(_0x11ce1f),devices[_0x11ce1f][_0x1487bd(0x274)]=null,devices[_0x11ce1f][_0x1487bd(0x286)]=null,devices[_0x11ce1f]['access']['token']=null,devices[_0x11ce1f][_0x1487bd(0x1f2)]=validateAccess(devices[_0x11ce1f]['access']['token'],_0x11ce1f),!(devices[_0x11ce1f][_0x1487bd(0x1f2)][_0x1487bd(0x298)]&&devices[_0x11ce1f][_0x1487bd(0x1f2)]['reason']==_0x1487bd(0x213))&&(_0x2a831e=='login'?io['to'](_0x11ce1f)[_0x1487bd(0x303)](_0x1487bd(0x24a),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x11ce1f)[_0x1487bd(0x303)](_0x1487bd(0x24a),{'access':{'allow':![],'reason':_0x1487bd(0x21b),'token':null}})),devices[_0x11ce1f][_0x1487bd(0x1f2)][_0x1487bd(0x1f4)]=null;},_0x10293f);}function setTokenRefresh(_0x4345e9){const _0x28ecaa=_0x2a1284;if(devices[_0x4345e9][_0x28ecaa(0x2cf)])clearTimeout(devices[_0x4345e9][_0x28ecaa(0x2cf)]);devices[_0x4345e9][_0x28ecaa(0x2cf)]=setTimeout(()=>{const _0x21670d=_0x28ecaa;getClientsWithUuid(_0x4345e9)[_0x21670d(0x2d2)]!=0x0?(devices[_0x4345e9][_0x21670d(0x1f2)]=refreshToken(_0x4345e9),io['to'](_0x4345e9)['emit'](_0x21670d(0x24a),{'status':_0x21670d(0x2f1),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4345e9][_0x21670d(0x1f2)],'externalip':devices[_0x4345e9]['ip'],'publicKey':secure[_0x21670d(0x2fe)]}),setTokenRefresh(_0x4345e9)):clearTimeout(devices[_0x4345e9][_0x21670d(0x2cf)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x212d95){const _0x19854c=_0x2a1284,_0xd11d07=getClient(_0x212d95['id'])[_0x19854c(0x2c0)];_0x212d95['emit'](_0x19854c(0x1e8),config),_0x212d95[_0x19854c(0x303)](_0x19854c(0x204),cleanSettings()),_0x212d95['on']('add-bot',_0x2f91d3=>{const _0x50c1ef=_0x19854c;if(validateAccess(_0x2f91d3,_0xd11d07)[_0x50c1ef(0x298)])addBot();else logging(_0x50c1ef(0x2b7));}),_0x212d95['on'](_0x19854c(0x235),(_0x27e1ef,_0x3a3bd9)=>{const _0x2073bc=_0x19854c;if(validateAccess(_0x3a3bd9,_0xd11d07)['allow'])toggleBot(_0x27e1ef['botID'],_0x27e1ef['status'],_0x27e1ef[_0x2073bc(0x27d)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x212d95['on']('delete-bot',(_0xaaca17,_0xee8d62)=>{const _0xa7411f=_0x19854c;if(validateAccess(_0xee8d62,_0xd11d07)[_0xa7411f(0x298)])deleteBot(_0xaaca17);else logging(_0xa7411f(0x289));}),_0x212d95['on'](_0x19854c(0x306),(_0x291e36,_0x3d907c)=>{const _0xe065f8=_0x19854c;if(validateAccess(_0x3d907c,_0xd11d07)['allow'])storeSettings(_0x291e36,!![]);else logging(_0xe065f8(0x2a7));}),_0x212d95['on']('update-bb',(_0x1b6c2f,_0x562419)=>{const _0x2e43c9=_0x19854c;if(validateAccess(_0x562419,_0xd11d07)[_0x2e43c9(0x298)])updateBB();else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x212d95['on'](_0x19854c(0x283),_0x899d4b=>{const _0x541a4d=_0x19854c;if(validateAccess(_0x899d4b,_0xd11d07)['allow']){if(devices[_0xd11d07][_0x541a4d(0x2cf)])clearTimeout(devices[_0xd11d07][_0x541a4d(0x2cf)]);if(devices[_0xd11d07][_0x541a4d(0x2a6)])clearTimeout(devices[_0xd11d07][_0x541a4d(0x2a6)]);removeSocketListeners(getClient(_0x212d95['id'])[_0x541a4d(0x2c0)]),addBlacklist(_0xd11d07),devices[_0xd11d07][_0x541a4d(0x274)]=null,devices[_0xd11d07][_0x541a4d(0x286)]=null,devices[_0xd11d07][_0x541a4d(0x1f2)][_0x541a4d(0x1f4)]=null,io['to'](getClient(_0x212d95['id'])['uuid'])[_0x541a4d(0x303)](_0x541a4d(0x24a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x108045){const _0x46406c=_0x2a1284,_0x514a49=getClient(_0x108045['id'])[_0x46406c(0x1f1)],_0x270a72=getClient(_0x108045['id'])['uuid'];_0x108045['on']('get-logs',(_0x4da6f3,_0x5a880f)=>{const _0x2ee500=_0x46406c;if(validateAccess(_0x5a880f,_0x270a72)[_0x2ee500(0x298)]){if(pid[_0x514a49])pid[_0x514a49]['send']({'function':_0x2ee500(0x1dc),'args':_0x4da6f3});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x108045['on']('get-portfolio',(_0x310d3b,_0x22b538)=>{const _0x5b6b7b=_0x46406c;if(validateAccess(_0x22b538,_0x270a72)['allow']){if(pid[_0x514a49])pid[_0x514a49][_0x5b6b7b(0x20d)]({'function':_0x5b6b7b(0x217),'args':_0x310d3b});}else logging(_0x5b6b7b(0x24c));}),_0x108045['on']('store-configuration',(_0x9bb8bb,_0x230c1c)=>{const _0x418c4a=_0x46406c;if(validateAccess(_0x230c1c,_0x270a72)[_0x418c4a(0x298)]){if(pid[_0x514a49])pid[_0x514a49][_0x418c4a(0x20d)]({'function':_0x418c4a(0x239),'args':_0x9bb8bb});}else logging(_0x418c4a(0x220));}),_0x108045['on'](_0x46406c(0x2c3),(_0x1ba285,_0x42bdad)=>{const _0x278aa2=_0x46406c;if(validateAccess(_0x42bdad,_0x270a72)[_0x278aa2(0x298)]){if(pid[_0x514a49])pid[_0x514a49][_0x278aa2(0x20d)]({'function':'storeHeadless','args':_0x1ba285});}else logging(_0x278aa2(0x2c2));}),_0x108045['on'](_0x46406c(0x2da),_0x284a12=>{const _0x5f3edb=_0x46406c;if(validateAccess(_0x284a12,_0x270a72)[_0x5f3edb(0x298)]){if(pid[_0x514a49])pid[_0x514a49]['send']({'function':_0x5f3edb(0x209),'args':null});}else logging(_0x5f3edb(0x203));}),_0x108045['on'](_0x46406c(0x2ae),(_0x4a5e1a,_0x21efdb)=>{const _0x19f30f=_0x46406c;if(validateAccess(_0x21efdb,_0x270a72)[_0x19f30f(0x298)]){if(pid[_0x514a49])pid[_0x514a49]['send']({'function':'placeOrder','args':_0x4a5e1a});}else logging(_0x19f30f(0x22b));}),_0x108045['on']('cancel-loading',_0x484c4b=>{const _0x439f07=_0x46406c;if(validateAccess(_0x484c4b,_0x270a72)[_0x439f07(0x298)]){if(pid[_0x514a49])pid[_0x514a49][_0x439f07(0x20d)]({'function':_0x439f07(0x1df),'args':null});}else logging(_0x439f07(0x25b));}),_0x108045['on'](_0x46406c(0x283),_0x236a26=>{const _0x4eca36=_0x46406c;if(validateAccess(_0x236a26,_0x270a72)['allow']){if(devices[_0x270a72]['pidRefreshToken'])clearTimeout(devices[_0x270a72][_0x4eca36(0x2cf)]);if(devices[_0x270a72][_0x4eca36(0x2a6)])clearTimeout(devices[_0x270a72]['pidExpireLogin']);removeSocketListeners(getClient(_0x108045['id'])[_0x4eca36(0x2c0)]),addBlacklist(_0x270a72),devices[_0x270a72][_0x4eca36(0x274)]=null,devices[_0x270a72]['telegram2FaApproval']=null,devices[_0x270a72]['access'][_0x4eca36(0x1f4)]=null,io['to'](getClient(_0x108045['id'])[_0x4eca36(0x2c0)])[_0x4eca36(0x303)](_0x4eca36(0x24a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x4eca36(0x2c6));});}function removeSocketListeners(_0x319375){const _0x4d4f0f=_0x2a1284;getClientsWithUuid(_0x319375)[_0x4d4f0f(0x2a4)](_0x5a44b1=>{const _0x444b63=_0x4d4f0f;getSocket(_0x5a44b1['id'])[_0x444b63(0x1ee)]();});}function cleanSettings(){const _0x5b0a40=_0x2a1284;let _0x19cc69=settings;return settings[_0x5b0a40(0x2f0)]&&settings[_0x5b0a40(0x2f0)]!=''&&(_0x19cc69={..._0x19cc69,'telegramToken':_0x5b0a40(0x237)}),settings[_0x5b0a40(0x1d5)]&&settings[_0x5b0a40(0x1d5)]!=''&&(_0x19cc69={..._0x19cc69,'bbPassword':_0x5b0a40(0x237)}),_0x19cc69;}function updateBB(){const _0x2ce310=_0x2a1284;process[_0x2ce310(0x20d)]({'update':!![]});}function startBot(_0x505da9,_0x2ca6c7,_0x4dc4d7){const _0xb804d3=_0x2a1284;let _0x3984b5=![];const _0x274779=_0x505da9[0x0];_0x2ca6c7={..._0x2ca6c7,'stdio':['inherit',_0xb804d3(0x23a),_0xb804d3(0x23a),_0xb804d3(0x251)]},pid[_0x274779]=childProcess[_0xb804d3(0x29d)](botfile,_0x505da9,_0x2ca6c7),pid[_0x274779]['on'](_0xb804d3(0x208),_0x4708f4=>{const _0x424ecd=_0xb804d3;switch(Object[_0x424ecd(0x241)](_0x4708f4)[0x0]){case _0x424ecd(0x234):updateBotName(_0x274779,_0x4708f4[_0x424ecd(0x234)]);break;case'status':updateStatus(_0x274779,_0x4708f4[_0x424ecd(0x24a)]);break;case _0x424ecd(0x27d):updateLive(_0x274779,_0x4708f4[_0x424ecd(0x27d)]);break;case'started':updateLive(_0x274779,_0x4708f4[_0x424ecd(0x25a)]),io['to'](_0x274779)[_0x424ecd(0x303)]('status',{'access':{'allow':![],'reason':_0x424ecd(0x2e7),'token':null}});break;case'stop':_0x4708f4[_0x424ecd(0x2b2)]==_0x424ecd(0x2b9)&&stopBot(_0x274779);_0x4708f4[_0x424ecd(0x2b2)]==_0x424ecd(0x2de)&&toggleBot(_0x274779,_0x424ecd(0x1f9),_0x424ecd(0x219));break;case _0x424ecd(0x26a):sendTelegram(_0x274779,_0x4708f4['telegram']);break;case _0x424ecd(0x310):io['to'](_0x274779)[_0x424ecd(0x303)](_0x4708f4['function'],_0x4708f4[_0x424ecd(0x23f)]);break;}}),pid[_0x274779]['on'](_0xb804d3(0x28d),function(_0x50a566){if(_0x3984b5)return;_0x3984b5=!![],_0x4dc4d7(_0x50a566);}),pid[_0x274779]['on'](_0xb804d3(0x2f9),function(_0x55c1aa){const _0x2ed041=_0xb804d3;if(_0x3984b5)return;_0x3984b5=!![],_0x4dc4d7(null);const _0x4849aa=dbConfig[_0x2ed041(0x26c)](_0x2ed041(0x1e8))[_0x2ed041(0x279)]({'botID':_0x274779})[_0x2ed041(0x250)]();_0x4849aa&&(_0x4849aa['status']==_0x2ed041(0x248)||_0x4849aa[_0x2ed041(0x24a)]==_0x2ed041(0x25f))&&(updateLive(_0x274779,_0x2ed041(0x219)),logging(_0x2ed041(0x291)+_0x274779),startBot([_0x274779,userID],{'cwd':bbpath},function(_0x380ad4){if(_0x380ad4)logging(_0x380ad4);}));});}function stopBot(_0x3b95d6){const _0x532d7e=_0x2a1284;getClientsWithBotID(_0x3b95d6)['forEach'](_0x56f821=>{const _0x43f27f=_0x26ea;getSocket(_0x56f821['id'])[_0x43f27f(0x2ef)](!![]),removeClient(_0x56f821['id']);});if(pid[_0x3b95d6])pid[_0x3b95d6][_0x532d7e(0x2de)]();}function addBot(){const _0x292c15=_0x2a1284;let _0x35462c;for(let _0x4185a9=0x1;_0x4185a9<0x3e9;_0x4185a9++){_0x35462c=_0x4185a9[_0x292c15(0x284)]()[_0x292c15(0x20c)](0x3,'0');let _0x14965f=config['find'](_0x551102=>_0x551102[_0x292c15(0x21e)]==_0x35462c);if(!_0x14965f)break;}if(_0x35462c===_0x292c15(0x24d)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x292c15(0x22c)+_0x35462c),dbConfig[_0x292c15(0x26c)](_0x292c15(0x1e8))[_0x292c15(0x2a1)]({'botID':_0x35462c,'botname':'Bot\x20'+_0x35462c,'status':_0x292c15(0x25f),'live':''})['write'](),startBot([_0x35462c,userID],{'cwd':bbpath},function(_0x1f958d){if(_0x1f958d)logging(_0x1f958d);}),config=getConfiguration(),io['to'](_0x292c15(0x1e7))[_0x292c15(0x303)](_0x292c15(0x1e8),config);}function deleteBot(_0x4580b0){const _0x29e141=_0x2a1284;getClientsWithBotID(_0x4580b0)[_0x29e141(0x2a4)](_0x56eda9=>{const _0x2a8a09=_0x29e141;getSocket(_0x56eda9['id'])[_0x2a8a09(0x2ef)](!![]),removeClient(_0x56eda9['id']);}),dbConfig['get'](_0x29e141(0x1e8))[_0x29e141(0x2b1)]({'botID':_0x4580b0})[_0x29e141(0x2a5)](),logging('deleted\x20Bot\x20'+_0x4580b0),stopBot(_0x4580b0);try{fs[_0x29e141(0x229)](path[_0x29e141(0x309)](configpath,'bot-'+_0x4580b0+_0x29e141(0x2d6))),fs[_0x29e141(0x229)](path[_0x29e141(0x309)](configpath,_0x29e141(0x20a)+_0x4580b0+_0x29e141(0x2fd))),fs[_0x29e141(0x229)](path[_0x29e141(0x309)](configpath,_0x29e141(0x20a)+_0x4580b0+_0x29e141(0x218))),fs[_0x29e141(0x229)](path[_0x29e141(0x309)](configpath,_0x29e141(0x20a)+_0x4580b0+_0x29e141(0x2ee)));}catch(_0x2db791){if(_0x2db791)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x2db791);}config=getConfiguration(),io['to'](_0x29e141(0x1e7))[_0x29e141(0x303)](_0x29e141(0x1e8),config);}function toggleBot(_0x372d97,_0x5594a3,_0x26d2ed){const _0x4dd980=_0x2a1284;dbConfig['get'](_0x4dd980(0x1e8))[_0x4dd980(0x279)]({'botID':_0x372d97})['assign']({'status':_0x5594a3})['assign']({'live':_0x26d2ed})[_0x4dd980(0x2a5)]();if(_0x5594a3==_0x4dd980(0x248)||_0x5594a3==_0x4dd980(0x25f))logging(_0x4dd980(0x2cb)+_0x372d97),startBot([_0x372d97,userID],{'cwd':bbpath},function(_0x4f1e06){if(_0x4f1e06)logging(_0x4f1e06);});else(_0x5594a3==_0x4dd980(0x1f9)||_0x5594a3==_0x4dd980(0x30b))&&(logging('disabled\x20Bot\x20'+_0x372d97),stopBot(_0x372d97));config=getConfiguration(),io['to'](_0x4dd980(0x1e7))['emit']('bots',config);}function toggleStatus(_0x2119b3){const _0x302c92=_0x2a1284;let _0x43884c=dbConfig[_0x302c92(0x26c)](_0x302c92(0x1e8))['find']({'botID':_0x2119b3})[_0x302c92(0x250)](),_0x2b9555;if(_0x43884c['status']==='enabled')_0x2b9555=_0x302c92(0x1f9);else{if(_0x43884c['status']===_0x302c92(0x25f))_0x2b9555=_0x302c92(0x30b);else{if(_0x43884c['status']===_0x302c92(0x30b))_0x2b9555=_0x302c92(0x25f);else{if(_0x43884c[_0x302c92(0x24a)]===_0x302c92(0x1f9))_0x2b9555=_0x302c92(0x248);}}}return _0x2b9555;}function updateStatus(_0x2c22e1,_0x229702){const _0x4c9d3a=_0x2a1284;dbConfig['get'](_0x4c9d3a(0x1e8))['find']({'botID':_0x2c22e1})[_0x4c9d3a(0x221)]({'status':_0x229702})[_0x4c9d3a(0x2a5)](),config=getConfiguration(),io['to']('botmanager')[_0x4c9d3a(0x303)](_0x4c9d3a(0x1e8),config);}function updateLive(_0x5dc394,_0x2fc61b){const _0x5ebd7e=_0x2a1284;dbConfig[_0x5ebd7e(0x26c)]('bots')['find']({'botID':_0x5dc394})[_0x5ebd7e(0x221)]({'live':_0x2fc61b})[_0x5ebd7e(0x2a5)](),config=getConfiguration(),io['to'](_0x5ebd7e(0x1e7))[_0x5ebd7e(0x303)]('bots',config);}function updateBotName(_0x200950,_0x40ce9d){const _0x31e917=_0x2a1284;dbConfig[_0x31e917(0x26c)](_0x31e917(0x1e8))[_0x31e917(0x279)]({'botID':_0x200950})[_0x31e917(0x221)]({'botname':_0x40ce9d})[_0x31e917(0x2a5)](),config=getConfiguration(),io['to'](_0x31e917(0x1e7))[_0x31e917(0x303)](_0x31e917(0x1e8),config);}function telegramError(_0x3ee5f4){console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x333693){const _0x1b6118=_0x2a1284;if(_0x333693[_0x1b6118(0x29c)][_0x1b6118(0x2bb)]!=settings[_0x1b6118(0x1fe)]&&'@'+_0x333693[_0x1b6118(0x29c)][_0x1b6118(0x2bb)]!=settings[_0x1b6118(0x1fe)])return tgBot[_0x1b6118(0x2e6)](_0x333693[_0x1b6118(0x2fb)]['id'],_0x1b6118(0x2b8),{'parse_mode':_0x1b6118(0x1fc)})[_0x1b6118(0x222)](_0x2c3377=>{telegramError(_0x2c3377);}),![];return!![];}function _0x1054(){const _0x4fea12=['push','bbUsername','sha256','forEach','write','pidExpireLogin','Unauthorized\x20attempt\x20to\x20update\x20settings','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','bb-settings.json','env','<b>Telegram\x20bot\x20status:</b>\x0a','test','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','place-order','Allow\x20login\x20from\x20IP\x20address\x20<b>','running','remove','stop','decrypt','2FA','/:bot/coins','filter','Unauthorized\x20attempt\x20to\x20add\x20bot','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','restart','build','username','ipaddr.js','temporary\x20access\x20not\x20allowed','map','showname','uuid','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','store-headless','login\x20token\x20generated','getSeconds','Unauthorized\x20attempt\x20to\x20log\x20out','yes','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','kind','accept','enabled\x20Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','getMinutes','referer','pidRefreshToken','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Balance\x20Bot','length','bcryptjs','search','bot.js','-config.json','clientip','isDirectory','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','get-starting-balances','getDate','sign','/enable\x20-\x20enable\x20notifications\x0a','kill','No\x20bots\x20running\x20right\x20now','https://hodlerhacks.com','generateKeyPairAsync','Login\x20accepted','getFullYear','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','date-fns','sendMessage','reload','blacklist','answerCallbackQuery','loginRequired','Unauthorized\x20login\x20attempt\x20(timeout)','/status\x20-\x20show\x20bot(s)\x20status\x0a','name','-results.json','disconnect','telegramToken','connected','login\x20token\x20valid','Notifications\x20disabled\x0a','socket.io','\x20only\x0a','sockets','timestamp','settings.','exit','version.json','chat','secure','-events.json','publicKey','Password\x20has\x20been\x20reset\x20to:\x20','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','reject','temporary\x20token\x20generated','emit','listen','Notifications\x20enabled\x0a','store-settings','755712KyUhqg','orders','join','2FA\x20required','new-disabled','\x20|\x20','clients','alerts','2FA\x20login\x20rejected','function','reason','isValid','bbPassword','127.0.0.1','All\x20bots','privateKey','35294RAQzfF','1550464JJCpmi','Token\x20blacklisted','emitHistory','-----------------------------------------------------------------------------------',':\x20Bot\x20Mgr\x20>\x20','cancelLoading','ipv6','Invalid\x20authentication\x20token\x20(1)','hasOwnProperty','includes','apply','host','onText','botmanager','bots','jsonwebtoken','2FA\x20login\x20token\x20generated','match','add','node-telegram-bot-api','removeAllListeners','all','whitelist','bot','access','copyFileSync','token','expiry','temporaryAccessAllowed','/on\x20-\x20start\x20bot(s)\x0a','slice','disabled','/disable\x20-\x20disable\x20notifications\x0a','auth','HTML','child_process','telegramUsername','452532vSIDjo','User\x20has\x20been\x20validated','Invalid\x20Telegram\x20token','build2','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','settings','Crypt','randomBytes','removeListener','message','getStartingBalances','bot-','type','padStart','send','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','12SjdCUz','password','30\x20min','login\x20not\x20required','telegramEnabled','verify','1095RAXlPm','getPortfolio','-performance.json','stopped','handshake','temporary\x20access\x20timeout','backup/','constructor','botID','notification','Unauthorized\x20attempt\x20to\x20store\x20configuration','assign','catch','5224164AAptZh','::ffff:127.0.0.1','bb-secure.json','crypto','387724WuCIoo','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','unlinkSync','mkdirSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','starting\x20new\x20bot\x20|\x20Bot\x20','remoteAddress','2FA\x20login\x20required','store','idling\x20bot\x20\x20\x20|\x20Bot\x20','::1','whitelistEnabled','secret','botname','update-bot','headers','************','15\x20min','storeConfiguration','inherit','login','Bot\x20','polling_error','timeshift','args','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','keys','Error:\x20Invalid\x20argument\x20','createServer','SIGINT','apiKey','default','use','enabled','index.html','status','conn','Unauthorized\x20attempt\x20to\x20get\x20portfolio','1000','stopPolling','event','value','ipc','Login\x20rejected','page','1818JQoEKU','set','Alerts','sortBy','callback_query','config/','started','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','existsSync','lowdb/adapters/FileSync','Access\x20enabled\x20for\x20','new','/:bot','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','\x20/\x20','\x20>\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','show','30SXmfzu','bb-config.json','defaults','(((.+)+)+)+$','telegram','login\x20required','get','Temporary\x20access\x20rejected','<b>Balance\x20Bot\x20status:</b>\x0a','All','data','user','Bot\x20Mgr\x20>\x20','/restart\x20-\x20restart\x20bot(s)\x0a','telegramIpApproval','hex','hybrid-crypto-js','compareSync','7IFLLZY','find','once','f2aRequired','/help\x20-\x20show\x20available\x20commands\x0a','live','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','reset-password','</b>\x20?','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','logout','toString','getMonth','telegram2FaApproval','Unauthorized\x20login\x20attempt\x20(public\x20key)','getHours','Unauthorized\x20attempt\x20to\x20delete\x20bot','then','telegramChatId','sendFile','error','getTime','hashSync','Balance\x20Bot\x20Server','restarting\x20Bot\x20','isIPv4MappedAddress','3000','initclient','bb/','invalid\x20credentials','No\x20authentication\x20token','allow','success','Ok,\x20will\x20send\x20alert\x20notifications\x20only','argv','from','fork','log','telegramEvents','server'];_0x1054=function(){return _0x4fea12;};return _0x1054();}async function initTelegram(){const _0x1cff2f=_0x2a1284;if(tgBot)tgBot[_0x1cff2f(0x24e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1cff2f(0x2f0)],{'polling':!![]});let _0x2eba5b='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x2eba5b+='\x0a',_0x2eba5b+=_0x1cff2f(0x2dd),_0x2eba5b+=_0x1cff2f(0x1fa),_0x2eba5b+=_0x1cff2f(0x2a8),_0x2eba5b+=_0x1cff2f(0x273),_0x2eba5b+=_0x1cff2f(0x1f7),_0x2eba5b+='/off\x20-\x20stop\x20bot(s)\x0a',_0x2eba5b+=_0x1cff2f(0x2ec),_0x2eba5b+=_0x1cff2f(0x27c);let _0x75f4fe=_0x1cff2f(0x20e);_0x75f4fe+='\x0a',_0x75f4fe+=_0x2eba5b,tgBot[_0x1cff2f(0x1e6)](/\/start/,_0xbd923c=>{const _0x58edf5=_0x1cff2f;if(!validateTelegram(_0xbd923c))return;if(settings[_0x58edf5(0x28b)]!=_0xbd923c[_0x58edf5(0x2fb)]['id'])updateSetting(_0x58edf5(0x28b),_0xbd923c[_0x58edf5(0x2fb)]['id']);updateSetting(_0x58edf5(0x214),!![]),tgBot[_0x58edf5(0x2e6)](_0xbd923c[_0x58edf5(0x2fb)]['id'],_0x75f4fe)[_0x58edf5(0x222)](_0x5a6f2f=>{telegramError(_0x5a6f2f);});}),tgBot[_0x1cff2f(0x1e6)](/\/enable/,_0x3cd4ac=>{const _0x450c1f=_0x1cff2f;if(!validateTelegram(_0x3cd4ac))return;if(settings[_0x450c1f(0x28b)]!=_0x3cd4ac[_0x450c1f(0x2fb)]['id'])updateSetting('telegramChatId',_0x3cd4ac[_0x450c1f(0x2fb)]['id']);updateSetting(_0x450c1f(0x214),!![]),tgBot[_0x450c1f(0x2e6)](_0x3cd4ac[_0x450c1f(0x2fb)]['id'],'Notifications\x20enabled')[_0x450c1f(0x222)](_0x1806ba=>{telegramError(_0x1806ba);});}),tgBot[_0x1cff2f(0x1e6)](/\/config/,async _0x170a9f=>{const _0x33222f=_0x1cff2f;if(!validateTelegram(_0x170a9f))return;tgBot[_0x33222f(0x207)]('callback_query'),tgBot[_0x33222f(0x2e6)](_0x170a9f[_0x33222f(0x2fb)]['id'],_0x33222f(0x261),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x33222f(0x256),'callback_data':_0x33222f(0x30e)},{'text':_0x33222f(0x26f),'callback_data':_0x33222f(0x1ef)}]]}})[_0x33222f(0x222)](_0x5d315a=>{telegramError(_0x5d315a);}),tgBot['on'](_0x33222f(0x258),async _0x52fb11=>{const _0x4588ca=_0x33222f,_0x1cbe21=_0x52fb11['data'],_0x43c719=_0x52fb11['message'];tgBot[_0x4588ca(0x2e9)](_0x52fb11['id'])[_0x4588ca(0x28a)](async()=>{const _0x1c302b=_0x4588ca;_0x1cbe21==_0x1c302b(0x308)&&(updateSetting(_0x1c302b(0x29f),_0x1c302b(0x308)),updateSetting(_0x1c302b(0x214),!![]),await tgBot[_0x1c302b(0x2e6)](_0x43c719['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x1c302b(0x222)](_0x510ca2=>{telegramError(_0x510ca2);}));_0x1cbe21==_0x1c302b(0x30e)&&(updateSetting(_0x1c302b(0x29f),_0x1c302b(0x30e)),updateSetting(_0x1c302b(0x214),!![]),await tgBot[_0x1c302b(0x2e6)](_0x43c719[_0x1c302b(0x2fb)]['id'],_0x1c302b(0x29a))[_0x1c302b(0x222)](_0x4921ab=>{telegramError(_0x4921ab);}));_0x1cbe21==_0x1c302b(0x1ef)&&(updateSetting(_0x1c302b(0x29f),_0x1c302b(0x1ef)),updateSetting(_0x1c302b(0x214),!![]),await tgBot[_0x1c302b(0x2e6)](_0x43c719[_0x1c302b(0x2fb)]['id'],_0x1c302b(0x228))[_0x1c302b(0x222)](_0x3b6eed=>{telegramError(_0x3b6eed);}));if(!settings[_0x1c302b(0x28b)])tgBot[_0x1c302b(0x2e6)](_0x43c719['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x1c302b(0x222)](_0x194d3d=>{telegramError(_0x194d3d);});}),tgBot[_0x4588ca(0x207)](_0x4588ca(0x258));});}),tgBot[_0x1cff2f(0x1e6)](/\/status/,_0x37dec7=>{const _0x27a3f9=_0x1cff2f;if(!validateTelegram(_0x37dec7))return;let _0x1c480a=_0x27a3f9(0x26e);config['forEach'](_0x5abf19=>{const _0x5161e0=_0x27a3f9;_0x1c480a+=_0x5161e0(0x23c)+_0x5abf19['botID']+'\x20|\x20'+_0x5abf19[_0x5161e0(0x234)]+':\x20'+_0x5abf19[_0x5161e0(0x24a)]+_0x5161e0(0x262)+_0x5abf19[_0x5161e0(0x27d)]+'\x0a';}),_0x1c480a+='\x0a',_0x1c480a+=_0x27a3f9(0x2ab),_0x1c480a+=!settings[_0x27a3f9(0x214)]?_0x27a3f9(0x2f3):_0x27a3f9(0x305),_0x1c480a+=settings[_0x27a3f9(0x214)]?settings[_0x27a3f9(0x29f)]==_0x27a3f9(0x1ef)?_0x27a3f9(0x27e):'Notifications\x20types:\x20'+settings[_0x27a3f9(0x29f)]+_0x27a3f9(0x2f5):'',tgBot['sendMessage'](_0x37dec7[_0x27a3f9(0x2fb)]['id'],_0x1c480a,{'parse_mode':_0x27a3f9(0x1fc)})[_0x27a3f9(0x222)](_0x1f1986=>{telegramError(_0x1f1986);});}),tgBot[_0x1cff2f(0x1e6)](/\/restart/,_0x9dd322=>{const _0x4a36f9=_0x1cff2f;if(!validateTelegram(_0x9dd322))return;tgBot['removeListener'](_0x4a36f9(0x258));const _0x2583b3=getEnabledBots();if(_0x2583b3[_0x4a36f9(0x2d2)]==0x0)tgBot[_0x4a36f9(0x2e6)](_0x9dd322[_0x4a36f9(0x2fb)]['id'],_0x4a36f9(0x2df))[_0x4a36f9(0x222)](_0x469cc7=>{telegramError(_0x469cc7);});else{if(_0x2583b3['length']>0x1)_0x2583b3['push']({'botID':'all'});let _0x1a7880=[],_0x7dcd0d=[];const _0x531585=_0x2583b3[_0x4a36f9(0x2d2)]%0x4==0x0||_0x2583b3[_0x4a36f9(0x2d2)]%0x4==0x3||_0x2583b3[_0x4a36f9(0x2d2)]%0x3==0x1?0x4:0x3;let _0x315bb0=0x0;_0x2583b3[_0x4a36f9(0x2a4)]((_0x5948e6,_0x4d60c0)=>{const _0x345110=_0x4a36f9;if(_0x4d60c0%_0x531585==0x0)_0x7dcd0d=[];_0x7dcd0d[_0x345110(0x2a1)]({'text':_0x5948e6[_0x345110(0x21e)]==_0x345110(0x1ef)?'All\x20bots':_0x345110(0x23c)+_0x5948e6[_0x345110(0x21e)],'callback_data':_0x5948e6[_0x345110(0x21e)]}),_0x4d60c0%_0x531585==0x0&&(_0x1a7880[_0x315bb0]=_0x7dcd0d,_0x315bb0++);}),tgBot[_0x4a36f9(0x2e6)](_0x9dd322[_0x4a36f9(0x2fb)]['id'],_0x4a36f9(0x27f),{'reply_markup':{'inline_keyboard':_0x1a7880}})['catch'](_0x14e260=>{telegramError(_0x14e260);}),tgBot['on'](_0x4a36f9(0x258),async _0x1b2223=>{const _0x11d1c2=_0x4a36f9,_0xe97854=_0x1b2223[_0x11d1c2(0x270)],_0x177257=_0x1b2223[_0x11d1c2(0x208)];tgBot['answerCallbackQuery'](_0x1b2223['id'])['then'](async()=>{const _0x53af6c=_0x11d1c2;if(_0xe97854==_0x53af6c(0x1ef)){if(settings['telegramEvents']=='orders')tgBot[_0x53af6c(0x2e6)](_0x177257[_0x53af6c(0x2fb)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')[_0x53af6c(0x222)](_0x2f564c=>{telegramError(_0x2f564c);});config[_0x53af6c(0x2a4)](_0x302493=>{const _0xa9fd0=_0x53af6c;stopBot(_0x302493[_0xa9fd0(0x21e)]);});}else{if(settings['telegramEvents']=='orders')tgBot['sendMessage'](_0x177257[_0x53af6c(0x2fb)]['id'],_0x53af6c(0x2d9)+_0xe97854)[_0x53af6c(0x222)](_0x2f03cc=>{telegramError(_0x2f03cc);});stopBot(_0xe97854);}}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/on/,_0x5d1dc9=>{const _0x4866b1=_0x1cff2f;if(!validateTelegram(_0x5d1dc9))return;tgBot[_0x4866b1(0x207)](_0x4866b1(0x258));const _0x39c316=getDisabledBots();if(_0x39c316['length']==0x0)tgBot['sendMessage'](_0x5d1dc9[_0x4866b1(0x2fb)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x4866b1(0x222)](_0x532caf=>{telegramError(_0x532caf);});else{if(_0x39c316[_0x4866b1(0x2d2)]>0x1)_0x39c316['push']({'botID':_0x4866b1(0x1ef)});let _0x4045f0=[],_0x31f468=[];const _0x48609c=_0x39c316[_0x4866b1(0x2d2)]%0x4==0x0||_0x39c316['length']%0x4==0x3||_0x39c316['length']%0x3==0x1?0x4:0x3;let _0x1276d3=0x0;_0x39c316[_0x4866b1(0x2a4)]((_0x721a05,_0x370036)=>{const _0x32dc52=_0x4866b1;if(_0x370036%_0x48609c==0x0)_0x31f468=[];_0x31f468[_0x32dc52(0x2a1)]({'text':_0x721a05[_0x32dc52(0x21e)]==_0x32dc52(0x1ef)?_0x32dc52(0x1d7):_0x32dc52(0x23c)+_0x721a05[_0x32dc52(0x21e)],'callback_data':_0x721a05[_0x32dc52(0x21e)]}),_0x370036%_0x48609c==0x0&&(_0x4045f0[_0x1276d3]=_0x31f468,_0x1276d3++);}),tgBot[_0x4866b1(0x2e6)](_0x5d1dc9[_0x4866b1(0x2fb)]['id'],_0x4866b1(0x2cc),{'reply_markup':{'inline_keyboard':_0x4045f0}})[_0x4866b1(0x222)](_0xc3bd89=>{telegramError(_0xc3bd89);}),tgBot['on'](_0x4866b1(0x258),async _0x2902e8=>{const _0x43503b=_0x4866b1,_0x1a4597=_0x2902e8[_0x43503b(0x270)],_0x11688c=_0x2902e8['message'];tgBot[_0x43503b(0x2e9)](_0x2902e8['id'])[_0x43503b(0x28a)](async()=>{const _0x3e7824=_0x43503b;if(_0x1a4597==_0x3e7824(0x1ef)){if(settings['telegramEvents']=='orders')tgBot[_0x3e7824(0x2e6)](_0x11688c[_0x3e7824(0x2fb)]['id'],_0x3e7824(0x282))[_0x3e7824(0x222)](_0x5da439=>{telegramError(_0x5da439);});_0x39c316[_0x3e7824(0x2a4)](_0x3e4f67=>{const _0x306c39=_0x3e7824;if(_0x3e4f67[_0x306c39(0x21e)]!='all')toggleBot(_0x3e4f67[_0x306c39(0x21e)],toggleStatus(_0x3e4f67[_0x306c39(0x21e)]),_0x306c39(0x219));});}else{if(settings[_0x3e7824(0x29f)]==_0x3e7824(0x308))tgBot[_0x3e7824(0x2e6)](_0x11688c[_0x3e7824(0x2fb)]['id'],_0x3e7824(0x2c8)+_0x1a4597)['catch'](_0x100c16=>{telegramError(_0x100c16);});toggleBot(_0x1a4597,toggleStatus(_0x1a4597),_0x3e7824(0x219));}}),tgBot['removeListener'](_0x43503b(0x258));});}}),tgBot[_0x1cff2f(0x1e6)](/\/off/,_0x13ae3d=>{const _0x5adb0a=_0x1cff2f;if(!validateTelegram(_0x13ae3d))return;tgBot[_0x5adb0a(0x207)]('callback_query');const _0x5403a9=getEnabledBots();if(_0x5403a9[_0x5adb0a(0x2d2)]==0x0)tgBot['sendMessage'](_0x13ae3d[_0x5adb0a(0x2fb)]['id'],_0x5adb0a(0x2df))[_0x5adb0a(0x222)](_0x138a91=>{telegramError(_0x138a91);});else{if(_0x5403a9[_0x5adb0a(0x2d2)]>0x1)_0x5403a9[_0x5adb0a(0x2a1)]({'botID':_0x5adb0a(0x1ef)});let _0xf0d2f5=[],_0x349654=[];const _0x12729e=_0x5403a9[_0x5adb0a(0x2d2)]%0x4==0x0||_0x5403a9[_0x5adb0a(0x2d2)]%0x4==0x3||_0x5403a9['length']%0x3==0x1?0x4:0x3;let _0x27d6bb=0x0;_0x5403a9[_0x5adb0a(0x2a4)]((_0x201636,_0x5ba732)=>{const _0x4ef45d=_0x5adb0a;if(_0x5ba732%_0x12729e==0x0)_0x349654=[];_0x349654[_0x4ef45d(0x2a1)]({'text':_0x201636[_0x4ef45d(0x21e)]==_0x4ef45d(0x1ef)?_0x4ef45d(0x1d7):_0x4ef45d(0x23c)+_0x201636[_0x4ef45d(0x21e)],'callback_data':_0x201636[_0x4ef45d(0x21e)]}),_0x5ba732%_0x12729e==0x0&&(_0xf0d2f5[_0x27d6bb]=_0x349654,_0x27d6bb++);}),tgBot['sendMessage'](_0x13ae3d[_0x5adb0a(0x2fb)]['id'],_0x5adb0a(0x240),{'reply_markup':{'inline_keyboard':_0xf0d2f5}})[_0x5adb0a(0x222)](_0x5c467d=>{telegramError(_0x5c467d);}),tgBot['on'](_0x5adb0a(0x258),async _0x1da038=>{const _0x5e0d21=_0x5adb0a,_0x65ea65=_0x1da038[_0x5e0d21(0x270)],_0x1368f7=_0x1da038[_0x5e0d21(0x208)];tgBot[_0x5e0d21(0x2e9)](_0x1da038['id'])[_0x5e0d21(0x28a)](async()=>{const _0x337def=_0x5e0d21;if(_0x65ea65==_0x337def(0x1ef)){if(settings[_0x337def(0x29f)]=='orders')tgBot['sendMessage'](_0x1368f7[_0x337def(0x2fb)]['id'],_0x337def(0x2e4))['catch'](_0x249b32=>{telegramError(_0x249b32);});_0x5403a9[_0x337def(0x2a4)](_0x215536=>{const _0x147cd8=_0x337def;if(_0x215536[_0x147cd8(0x21e)]!=_0x147cd8(0x1ef))toggleBot(_0x215536['botID'],toggleStatus(_0x215536[_0x147cd8(0x21e)]),_0x147cd8(0x219));});}else{if(settings['telegramEvents']==_0x337def(0x308))tgBot['sendMessage'](_0x1368f7[_0x337def(0x2fb)]['id'],_0x337def(0x2d0)+_0x65ea65)['catch'](_0x4862a2=>{telegramError(_0x4862a2);});toggleBot(_0x65ea65,toggleStatus(_0x65ea65),_0x337def(0x219));}}),tgBot[_0x5e0d21(0x207)](_0x5e0d21(0x258));});}}),tgBot[_0x1cff2f(0x1e6)](/\/disable/,_0x309995=>{const _0x18f0bd=_0x1cff2f;if(!validateTelegram(_0x309995))return;tgBot[_0x18f0bd(0x2e6)](_0x309995[_0x18f0bd(0x2fb)]['id'],'Notifications\x20disabled')[_0x18f0bd(0x222)](_0x379360=>{telegramError(_0x379360);}),updateSetting(_0x18f0bd(0x214),![]);}),tgBot['onText'](/\/help/,_0x37e2e6=>{const _0x2f8634=_0x1cff2f;if(!validateTelegram(_0x37e2e6))return;tgBot['sendMessage'](_0x37e2e6[_0x2f8634(0x2fb)]['id'],_0x2eba5b)[_0x2f8634(0x222)](_0x34fd02=>{telegramError(_0x34fd02);});}),tgBot['on'](_0x1cff2f(0x23d),_0x4e43c0=>{const _0x98e887=_0x1cff2f;_0x4e43c0[_0x98e887(0x284)]()[_0x98e887(0x1e3)]('404\x20Not\x20Found')&&(logging(_0x98e887(0x201)),tgBot[_0x98e887(0x24e)](),tgBot=null,io['to'](_0x98e887(0x1e7))[_0x98e887(0x303)](_0x98e887(0x21f),_0x98e887(0x201)));}),process[_0x1cff2f(0x27a)](_0x1cff2f(0x244),()=>{const _0xe5fcde=_0x1cff2f;if(tgBot)tgBot[_0xe5fcde(0x24e)]();process['exit'](0x1);}),process[_0x1cff2f(0x27a)]('SIGTERM',()=>{const _0x152767=_0x1cff2f;if(tgBot)tgBot[_0x152767(0x24e)]();process[_0x152767(0x2f9)](0x1);});}}function disableTelegram(){const _0x40c3b9=_0x2a1284;tgBot&&(tgBot[_0x40c3b9(0x24e)](),tgBot=null);}function sendTelegram(_0x3f7b13,_0x5bb6d7){const _0x1b7af7=_0x2a1284;if(settings['telegramEnabled']){if(settings[_0x1b7af7(0x29f)]==_0x1b7af7(0x1ef)||(_0x5bb6d7[_0x1b7af7(0x20b)]==_0x1b7af7(0x28d)||_0x5bb6d7[_0x1b7af7(0x20b)]==_0x1b7af7(0x299))&&settings[_0x1b7af7(0x29f)]=='alerts'||_0x5bb6d7[_0x1b7af7(0x20b)]=='order'&&settings['telegramEvents']==_0x1b7af7(0x308)){if(tgBot&&settings[_0x1b7af7(0x28b)]){if(_0x5bb6d7[_0x1b7af7(0x2bf)])tgBot[_0x1b7af7(0x2e6)](settings[_0x1b7af7(0x28b)],_0x5bb6d7['botname']+_0x1b7af7(0x263)+_0x5bb6d7[_0x1b7af7(0x24f)])[_0x1b7af7(0x222)](_0x40a7b5=>{telegramError(_0x40a7b5);});else tgBot[_0x1b7af7(0x2e6)](settings['telegramChatId'],_0x1b7af7(0x23c)+_0x3f7b13+_0x1b7af7(0x263)+_0x5bb6d7[_0x1b7af7(0x24f)])[_0x1b7af7(0x222)](_0x409a72=>{telegramError(_0x409a72);});}}}}function getDeviceWithIp(_0x38c05a){return devices['find'](_0x52b568=>_0x52b568['ip']===_0x38c05a);}function temporaryAccess2FA(_0xbea54a,_0x391f7e){const _0x1eeb32=_0x2a1284;let _0x332086=new Date(),_0x17dcbf=![];if(lastIpApproval){if(_0x332086-lastIpApproval<0x1388)_0x17dcbf=!![];}lastIpApproval=new Date();if(_0x17dcbf)return;tgBot&&settings[_0x1eeb32(0x28b)]&&(tgBot[_0x1eeb32(0x207)](_0x1eeb32(0x258)),tgBot['sendMessage'](settings[_0x1eeb32(0x28b)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x391f7e)[_0x1eeb32(0x265)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x1eeb32(0x238),'callback_data':'15'},{'text':_0x1eeb32(0x212),'callback_data':'30'},{'text':'reject','callback_data':_0x1eeb32(0x301)}]]}})[_0x1eeb32(0x222)](_0x2ac6b7=>{telegramError(_0x2ac6b7);}),tgBot['on'](_0x1eeb32(0x258),async _0x359584=>{const _0x3c6425=_0x1eeb32,_0x4fe8b8=_0x359584[_0x3c6425(0x270)],_0x3ea838=_0x359584[_0x3c6425(0x208)];tgBot[_0x3c6425(0x2e9)](_0x359584['id'])[_0x3c6425(0x28a)](async()=>{const _0x59226c=_0x3c6425;devices[_0xbea54a]['telegramIpApproval']={'clientip':_0x391f7e,'timestamp':new Date()[_0x59226c(0x28e)](),'expiry':_0x4fe8b8},_0x4fe8b8!=_0x59226c(0x301)?(await tgBot['sendMessage'](_0x3ea838['chat']['id'],_0x59226c(0x25e)+_0x4fe8b8+'\x20minutes',{'parse_mode':_0x59226c(0x1fc)})['catch'](_0x4efef0=>{telegramError(_0x4efef0);}),io['to'](_0xbea54a)[_0x59226c(0x303)](_0x59226c(0x24a),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x3ea838[_0x59226c(0x2fb)]['id'],_0x59226c(0x26d))[_0x59226c(0x222)](_0xfb64fc=>{telegramError(_0xfb64fc);}),io['to'](_0xbea54a)[_0x59226c(0x303)](_0x59226c(0x24a),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot['removeListener'](_0x3c6425(0x258));}));}function loginAccess2FA(_0x2db6f7,_0x14a8f6){const _0x4a4bd0=_0x2a1284;tgBot&&settings[_0x4a4bd0(0x28b)]&&(tgBot['removeListener'](_0x4a4bd0(0x258)),tgBot[_0x4a4bd0(0x2e6)](settings['telegramChatId'],_0x4a4bd0(0x2af)+normalizeIP(_0x14a8f6)[_0x4a4bd0(0x265)]+_0x4a4bd0(0x281),{'parse_mode':_0x4a4bd0(0x1fc),'reply_markup':{'inline_keyboard':[[{'text':_0x4a4bd0(0x2ca),'callback_data':loginExpiry},{'text':_0x4a4bd0(0x301),'callback_data':'reject'}]]}})[_0x4a4bd0(0x222)](_0x33afb3=>{telegramError(_0x33afb3);}),tgBot['on'](_0x4a4bd0(0x258),async _0x4e7d59=>{const _0x119d5f=_0x4a4bd0,_0x5df57b=_0x4e7d59['data'],_0x5189d8=_0x4e7d59[_0x119d5f(0x208)];tgBot[_0x119d5f(0x2e9)](_0x4e7d59['id'])['then'](async()=>{const _0x53ad4d=_0x119d5f;devices[_0x2db6f7]['telegram2FaApproval']={'clientip':_0x14a8f6,'timestamp':new Date()[_0x53ad4d(0x28e)](),'expiry':_0x5df57b},_0x5df57b!=_0x53ad4d(0x301)?(await tgBot[_0x53ad4d(0x2e6)](_0x5189d8['chat']['id'],_0x53ad4d(0x2e2),{'parse_mode':_0x53ad4d(0x1fc)})['catch'](_0x5d9929=>{telegramError(_0x5d9929);}),io['to'](_0x2db6f7)[_0x53ad4d(0x303)](_0x53ad4d(0x24a),{'access':{'allow':![],'reason':_0x53ad4d(0x2e7),'token':null}})):(await tgBot[_0x53ad4d(0x2e6)](_0x5189d8[_0x53ad4d(0x2fb)]['id'],_0x53ad4d(0x252))['catch'](_0x44495b=>{telegramError(_0x44495b);}),io['to'](_0x2db6f7)[_0x53ad4d(0x303)](_0x53ad4d(0x24a),{'access':{'allow':![],'reason':_0x53ad4d(0x30f),'token':null}}));}),tgBot[_0x119d5f(0x207)](_0x119d5f(0x258));}));}function getConfiguration(){const _0xb82d1=_0x2a1284;return dbConfig[_0xb82d1(0x26c)](_0xb82d1(0x1e8))[_0xb82d1(0x257)](_0xb82d1(0x21e))['value']()||[];}function getEnabledBots(){const _0x4f1644=_0x2a1284;return dbConfig[_0x4f1644(0x26c)](_0x4f1644(0x1e8))[_0x4f1644(0x257)](_0x4f1644(0x21e))['filter']({'status':_0x4f1644(0x248)})['value']()||[];}function getDisabledBots(){const _0x3a5d48=_0x2a1284;return dbConfig[_0x3a5d48(0x26c)](_0x3a5d48(0x1e8))[_0x3a5d48(0x257)](_0x3a5d48(0x21e))[_0x3a5d48(0x2b6)]({'status':_0x3a5d48(0x1f9)})[_0x3a5d48(0x250)]()||[];}function getSettings(){const _0x4eedcb=_0x2a1284;return dbSettings[_0x4eedcb(0x26c)](_0x4eedcb(0x204))[_0x4eedcb(0x250)]()||{'timeshift':0x0};}function _0x26ea(_0x243c63,_0x3dfd2b){const _0x45cefd=_0x1054();return _0x26ea=function(_0x5d4c85,_0x51b5c1){_0x5d4c85=_0x5d4c85-0x1d5;let _0x105450=_0x45cefd[_0x5d4c85];return _0x105450;},_0x26ea(_0x243c63,_0x3dfd2b);}function getSecure(){const _0x54c8fb=_0x2a1284;return dbSecure['get'](_0x54c8fb(0x2fc))[_0x54c8fb(0x250)]()||{};}function getBlacklist(){const _0x2d109f=_0x2a1284;return dbSecure['get'](_0x2d109f(0x2e8))[_0x2d109f(0x250)]()||[];}function broadcastToBots(_0x237300,_0x34c0af){const _0x13c97e=_0x2a1284;config[_0x13c97e(0x2a4)](_0x2a11fb=>{const _0x542dd0=_0x13c97e;if(_0x2a11fb['status']=='enabled'&&_0x2a11fb['live']==_0x542dd0(0x2b0)){if(pid[_0x2a11fb[_0x542dd0(0x21e)]])pid[_0x2a11fb['botID']][_0x542dd0(0x20d)]({[_0x237300]:_0x34c0af});}});}function storeSettings(_0xc36dc3,_0x110302=![]){const _0x324af2=_0x2a1284;_0xc36dc3={...settings,..._0xc36dc3};if(_0x110302&&_0xc36dc3[_0x324af2(0x1d5)]!=_0x324af2(0x237)&&_0xc36dc3[_0x324af2(0x1d5)]!=''){const _0x27b0d7=crypt[_0x324af2(0x2b3)](secure[_0x324af2(0x1d8)],_0xc36dc3[_0x324af2(0x1d5)])[_0x324af2(0x208)]['split']('@')[0x0],_0x415f4e=bcrypt[_0x324af2(0x28f)](_0x27b0d7,saltRounds);_0xc36dc3={..._0xc36dc3,'bbPassword':_0x415f4e};}if(_0x110302&&_0xc36dc3[_0x324af2(0x2f0)]!='************'&&_0xc36dc3[_0x324af2(0x2f0)]!=''){const _0x843447=crypt['decrypt'](secure[_0x324af2(0x1d8)],_0xc36dc3[_0x324af2(0x2f0)])['message']['split']('@')[0x0];_0xc36dc3={..._0xc36dc3,'telegramToken':_0x843447};}const _0x1d0376=_0xc36dc3[_0x324af2(0x2f0)]!=_0x324af2(0x237)&&_0xc36dc3['telegramToken']!=settings['telegramToken']||_0xc36dc3[_0x324af2(0x1fe)]!=settings['telegramUsername'],_0x5ed52d=_0xc36dc3[_0x324af2(0x2f0)]==''||_0xc36dc3['telegramUsername']=='';if(_0x1d0376)_0xc36dc3[_0x324af2(0x29f)]=_0x324af2(0x1ef);for(const [_0x1f157d,_0x3efd7b]of Object['entries'](_0xc36dc3)){if(_0x1f157d==_0x324af2(0x2f0)&&_0x3efd7b==_0x324af2(0x237)){_0xc36dc3[_0x324af2(0x2f0)]=settings[_0x324af2(0x2f0)];continue;};if(_0x1f157d==_0x324af2(0x1d5)&&_0x3efd7b==_0x324af2(0x237)){_0xc36dc3[_0x324af2(0x1d5)]=settings['bbPassword'];continue;};dbSettings[_0x324af2(0x255)](_0x324af2(0x2f8)+_0x1f157d,_0x3efd7b)['write']();}settings=_0xc36dc3,io['to'](_0x324af2(0x1e7))[_0x324af2(0x303)](_0x324af2(0x204),cleanSettings()),broadcastToBots(_0x324af2(0x23e),settings['timeshift']);if(_0x1d0376&&!_0x5ed52d)initTelegram();if(_0x1d0376&&_0x5ed52d)disableTelegram();getAllClients()[_0x324af2(0x2a4)](_0x5ef4f7=>{const _0x50cd23=_0x324af2;getSocket(_0x5ef4f7['id'])[_0x50cd23(0x303)](_0x50cd23(0x24a),{'access':{'allow':![],'reason':_0x50cd23(0x2e7),'token':null}});});}function updateSetting(_0x31fd07,_0x2ed753){const _0x3bc370=_0x2a1284;dbSettings['set']('settings.'+_0x31fd07,_0x2ed753)[_0x3bc370(0x2a5)](),settings=getSettings(),io['to'](_0x3bc370(0x1e7))[_0x3bc370(0x303)](_0x3bc370(0x204),cleanSettings());}function storeSecure(_0x34d398){const _0x4a7f43=_0x2a1284;dbSecure[_0x4a7f43(0x26c)](_0x4a7f43(0x2fc))[_0x4a7f43(0x2a1)](_0x34d398)[_0x4a7f43(0x2a5)](),secure=_0x34d398;}function addBlacklist(_0x39587a){const _0xd4a5ec=_0x2a1284;cleanBlacklist();let _0x5bfa58;devices[_0x39587a][_0xd4a5ec(0x274)]?_0x5bfa58=Math['max'](devices[_0x39587a][_0xd4a5ec(0x274)]['expiry'],loginExpiry):_0x5bfa58=loginExpiry,dbSecure[_0xd4a5ec(0x26c)]('blacklist')[_0xd4a5ec(0x2a1)]({'expiry':new Date()[_0xd4a5ec(0x28e)]()+_0x5bfa58*0x3c*0x3e8,'token':devices[_0x39587a][_0xd4a5ec(0x1f2)][_0xd4a5ec(0x1f4)]})[_0xd4a5ec(0x2a5)](),blacklist=dbSecure[_0xd4a5ec(0x26c)]('blacklist')[_0xd4a5ec(0x250)]();}function cleanBlacklist(){const _0xe045ef=_0x2a1284;let _0x21000e=dbSecure['get'](_0xe045ef(0x2e8))['cloneDeep']()[_0xe045ef(0x250)](),_0x4d1539=new Date()[_0xe045ef(0x28e)]();_0x21000e['forEach'](_0x2446ff=>{const _0x5a0a7a=_0xe045ef;_0x2446ff[_0x5a0a7a(0x1f5)]<_0x4d1539&&dbSecure[_0x5a0a7a(0x26c)](_0x5a0a7a(0x2e8))[_0x5a0a7a(0x2b1)]({'expiry':_0x2446ff[_0x5a0a7a(0x1f5)]})[_0x5a0a7a(0x2a5)]();});}function initStates(){const _0x316f2f=_0x2a1284;let _0x41a2df=getConfiguration();_0x41a2df[_0x316f2f(0x2a4)](_0x27805e=>{const _0x44deba=_0x316f2f;_0x27805e[_0x44deba(0x27d)]=_0x44deba(0x219);}),storeConfiguration(_0x41a2df);}function onKeys(){const _0x54bf35=new RSA();return new Promise(_0x1c24e7=>{const _0xe71721=_0x26ea;_0x54bf35[_0xe71721(0x2e1)]()['then'](_0x18304a=>{_0x1c24e7(_0x18304a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5265e3=_0x2a1284;let _0x315133=getConfiguration(),_0x512b98=![];_0x315133[_0x5265e3(0x2a4)](_0x1f9efb=>{const _0x4653c7=_0x5265e3;if(_0x1f9efb[_0x4653c7(0x24a)]==_0x4653c7(0x2b0))_0x1f9efb[_0x4653c7(0x24a)]=_0x4653c7(0x248),_0x512b98=!![];else _0x1f9efb[_0x4653c7(0x24a)]==_0x4653c7(0x219)&&(_0x1f9efb[_0x4653c7(0x24a)]=_0x4653c7(0x1f9),_0x512b98=!![]);});if(_0x512b98)storeConfiguration(_0x315133);let _0x3bc2fb=getSecure();if(!_0x3bc2fb[_0x5265e3(0x1e2)](_0x5265e3(0x233))){let _0x2b77f6=await generateKeys();_0x3bc2fb['publicKey']=_0x2b77f6[_0x5265e3(0x2fe)],_0x3bc2fb[_0x5265e3(0x1d8)]=_0x2b77f6[_0x5265e3(0x1d8)],_0x3bc2fb[_0x5265e3(0x233)]=crypto[_0x5265e3(0x206)](0x20)[_0x5265e3(0x284)](_0x5265e3(0x275));;storeSecure(_0x3bc2fb);}let _0x200ef5=getSettings();_0x512b98=![];!_0x200ef5[_0x5265e3(0x1e2)](_0x5265e3(0x2ea))&&(_0x200ef5[_0x5265e3(0x2ea)]=![],_0x200ef5[_0x5265e3(0x2a2)]='',_0x200ef5[_0x5265e3(0x1d5)]='',_0x200ef5[_0x5265e3(0x27b)]=![],_0x512b98=!![]);!_0x200ef5['hasOwnProperty']('whitelistEnabled')&&(_0x200ef5['whitelistEnabled']=![],_0x200ef5[_0x5265e3(0x1f0)]=[],_0x200ef5[_0x5265e3(0x1f6)]=![],_0x512b98=!![]);if(!_0x200ef5['hasOwnProperty'](_0x5265e3(0x214))){if(_0x200ef5['telegramChatId'])_0x200ef5[_0x5265e3(0x214)]=!![];else _0x200ef5['telegramEnabled']=![];_0x512b98=!![];}if(_0x512b98)storeSettings(_0x200ef5);}function storeConfiguration(_0x54277d){const _0x569887=_0x2a1284;dbConfig['get'](_0x569887(0x1e8))[_0x569887(0x2b1)]()['write'](),dbConfig[_0x569887(0x26c)](_0x569887(0x1e8))[_0x569887(0x2a1)](..._0x54277d)[_0x569887(0x2a5)](),config=_0x54277d;}function resetPassword(){const _0x2ef858=_0x2a1284;tgBot&&settings[_0x2ef858(0x28b)]&&(tgBot[_0x2ef858(0x207)](_0x2ef858(0x258)),tgBot['sendMessage'](settings[_0x2ef858(0x28b)],_0x2ef858(0x300),{'parse_mode':_0x2ef858(0x1fc),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x2ef858(0x2c7)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2534b2=>{telegramError(_0x2534b2);}),tgBot['on'](_0x2ef858(0x258),async _0x3f794c=>{const _0x31b244=_0x2ef858,_0x3ff4d2=_0x3f794c[_0x31b244(0x270)],_0x123b9a=_0x3f794c['message'];tgBot[_0x31b244(0x2e9)](_0x3f794c['id'])[_0x31b244(0x28a)](async()=>{const _0xeeb6c8=_0x31b244;if(_0x3ff4d2!='no'){const _0x46b841=0xf,_0x114823=_0xeeb6c8(0x2ad),_0x14e8a7=Array[_0xeeb6c8(0x29c)](crypto['randomFillSync'](new Uint32Array(_0x46b841)))[_0xeeb6c8(0x2be)](_0x15b509=>_0x114823[_0x15b509%_0x114823['length']])['join'](''),_0x53621f=bcrypt[_0xeeb6c8(0x28f)](_0x14e8a7,saltRounds);storeSettings({'bbPassword':_0x53621f}),await tgBot['sendMessage'](_0x123b9a[_0xeeb6c8(0x2fb)]['id'],_0xeeb6c8(0x2ff)+_0x14e8a7,{'parse_mode':'HTML'})[_0xeeb6c8(0x222)](_0x2bb899=>{telegramError(_0x2bb899);});}else await tgBot['sendMessage'](_0x123b9a[_0xeeb6c8(0x2fb)]['id'],'Password\x20reset\x20rejected')['catch'](_0x3cc5ee=>{telegramError(_0x3cc5ee);});}),tgBot[_0x31b244(0x207)]('callback_query');}));}function logging(_0x3b26a2){const _0x249b13=_0x2a1284;console['log'](getTimeStamp()+_0x249b13(0x1de)+_0x3b26a2);if(tgBot&&settings[_0x249b13(0x28b)]&&settings[_0x249b13(0x29f)]!=_0x249b13(0x308))tgBot[_0x249b13(0x2e6)](settings[_0x249b13(0x28b)],_0x249b13(0x272)+_0x3b26a2)[_0x249b13(0x222)](_0xc2375=>{telegramError(_0xc2375);});}function getServerTime(){const _0x5d0283=_0x2a1284,_0x178e5c=new Date();return _0x178e5c[_0x5d0283(0x2e3)]()+'/'+(_0x178e5c[_0x5d0283(0x285)]()+0x1)[_0x5d0283(0x284)]()[_0x5d0283(0x20c)](0x2,'0')+'/'+_0x178e5c[_0x5d0283(0x2db)]()[_0x5d0283(0x284)]()[_0x5d0283(0x20c)](0x2,'0')+'\x20'+_0x178e5c[_0x5d0283(0x288)]()[_0x5d0283(0x284)]()[_0x5d0283(0x20c)](0x2,'0')+':'+_0x178e5c[_0x5d0283(0x2cd)]()[_0x5d0283(0x284)]()[_0x5d0283(0x20c)](0x2,'0')+':'+_0x178e5c[_0x5d0283(0x2c5)]()[_0x5d0283(0x284)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x3a6ab1=_0x2a1284,_0x3f2f75=shiftedTime();return _0x3f2f75['getFullYear']()+'/'+(_0x3f2f75[_0x3a6ab1(0x285)]()+0x1)[_0x3a6ab1(0x284)]()[_0x3a6ab1(0x20c)](0x2,'0')+'/'+_0x3f2f75['getDate']()['toString']()[_0x3a6ab1(0x20c)](0x2,'0')+'\x20'+_0x3f2f75['getHours']()['toString']()[_0x3a6ab1(0x20c)](0x2,'0')+':'+_0x3f2f75[_0x3a6ab1(0x2cd)]()[_0x3a6ab1(0x284)]()[_0x3a6ab1(0x20c)](0x2,'0')+':'+_0x3f2f75[_0x3a6ab1(0x2c5)]()['toString']()[_0x3a6ab1(0x20c)](0x2,'0');}function shiftedTime(){const _0x271e60=_0x2a1284,_0x4255e9=new Date();let _0x435690=_0x4255e9;if(settings[_0x271e60(0x23e)]&&settings[_0x271e60(0x23e)]!==0x0)_0x435690=fns[_0x271e60(0x1ec)](_0x4255e9,{'hours':settings['timeshift']});return _0x435690;}function startScheduler(){let _0x328d44=new Date()['getUTCHours']();_0x328d44==0x1&&backupConfigFiles();_0x328d44==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x383735=>{const _0x2d1823=_0x26ea;if(!_0x383735[_0x2d1823(0x2d8)]())fs[_0x2d1823(0x1f3)](configpath+_0x383735[_0x2d1823(0x2ed)],configbackuppath+_0x383735[_0x2d1823(0x2ed)]);});}function triggerAnalytics(){const _0x385964=_0x2a1284;analytics[_0x385964(0x253)]({'title':_0x385964(0x290),'href':_0x385964(0x2e0),'path':'/v'+serverversion});}function validateCredentials(_0x5e7c75,_0x3b5218){const _0x3b86a6=_0x2a1284;if(_0x5e7c75[_0x3b86a6(0x2bb)]==settings['bbUsername']&&bcrypt[_0x3b86a6(0x277)](_0x5e7c75[_0x3b86a6(0x211)],settings[_0x3b86a6(0x1d5)])){if(settings[_0x3b86a6(0x27b)])return{'allow':![],'reason':_0x3b86a6(0x22e),'token':null};else{const _0x14c45d=generateLoginToken(_0x3b5218);return{'allow':!![],'reason':_0x3b86a6(0x2c4),'token':_0x14c45d};}}else return{'allow':![],'reason':_0x3b86a6(0x296),'token':null};}function refreshToken(_0xa5263d){const _0x1306ef=generateLoginToken(_0xa5263d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1306ef};}function validateAccess(_0x3ef6ee,_0x285812){const _0x3f14ca=_0x2a1284;let _0xd18368=devices[_0x285812]['ip'],_0x82aafa;const _0x4c96e5=_0x16ba6c=>{const _0x47ae55=_0x26ea;if(settings['loginRequired']){if(settings[_0x47ae55(0x27b)]){if(telegram2FaApproved(_0x285812)){const _0x295019=generateLoginToken(_0x285812);return{'allow':!![],'reason':_0x47ae55(0x1ea),'token':_0x295019};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x82aafa=validToken(_0x16ba6c,_0x285812),_0x82aafa[_0x47ae55(0x1e2)](_0x47ae55(0x299))?{'allow':!![],'reason':_0x47ae55(0x2f2),'token':_0x16ba6c}:{'allow':![],'reason':_0x47ae55(0x26b),'token':null};}else return{'allow':!![],'reason':_0x47ae55(0x213),'token':null};};if(settings[_0x3f14ca(0x232)]){let _0x3b25f5=[...settings['whitelist'],_0x3f14ca(0x231),_0x3f14ca(0x224),_0x3f14ca(0x1d6)];if(_0x3b25f5[_0x3f14ca(0x1e3)](_0xd18368))return _0x4c96e5(_0x3ef6ee);else{_0x82aafa=validToken(_0x3ef6ee,_0x285812);if(_0x82aafa[_0x3f14ca(0x1e2)]('success'))return _0x4c96e5(_0x3ef6ee);else{if(telegramIpApproved(_0x285812)){const _0xe4d620=generateToken(_0x285812);return _0x82aafa=_0x4c96e5(_0x3ef6ee),_0x82aafa[_0x3f14ca(0x298)]?{'allow':!![],'reason':_0x3f14ca(0x302),'token':_0xe4d620}:_0x82aafa;}else return settings[_0x3f14ca(0x1f6)]?{'allow':![],'reason':_0x3f14ca(0x30a),'token':null}:{'allow':![],'reason':_0x3f14ca(0x2bd),'token':null};}}}else return _0x4c96e5(_0x3ef6ee);}function timelyDecrypt(_0x2718ce,_0x7b3b7e=!![]){const _0x2dab36=_0x2a1284;if(_0x2718ce)try{const _0x2bc14a=crypt[_0x2dab36(0x2b3)](secure['privateKey'],_0x2718ce)[_0x2dab36(0x208)],_0x25dffe=_0x2bc14a['split']('@')[0x0],_0x139614=_0x2bc14a['split']('@')[0x1],_0x1604f3=new Date()['getTime']();if(_0x7b3b7e){if(_0x1604f3-_0x139614<maxSecretAge*0x3e8)return _0x25dffe;else return![];}else return _0x25dffe;}catch(_0x5647bb){return![];}else return![];}const validToken=(_0x33620a,_0x59463d)=>{const _0x9a84d7=_0x2a1284,_0x265f0e=devices[_0x59463d]['ip'];if(!_0x33620a)return{'error':_0x9a84d7(0x297)};for(let _0x4db99d of blacklist){if(_0x4db99d[_0x9a84d7(0x1f4)]==_0x33620a)return{'error':_0x9a84d7(0x1db)};}let _0x3c1819;try{_0x3c1819=jwt[_0x9a84d7(0x215)](_0x33620a,secure['secret']+_0x59463d);}catch{return{'error':_0x9a84d7(0x1e1)};}if(!_0x3c1819[_0x9a84d7(0x1e2)](_0x9a84d7(0x2d7))&&!_0x3c1819[_0x9a84d7(0x1e2)](_0x9a84d7(0x2bb))||!_0x3c1819[_0x9a84d7(0x1e2)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3c1819['hasOwnProperty']('username')&&_0x3c1819[_0x9a84d7(0x1e2)]('clientip')){const {clientip:_0x5c8f5b}=_0x3c1819;return _0x265f0e==_0x5c8f5b?{'success':_0x9a84d7(0x200)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x3c1819['hasOwnProperty']('username')&&_0x3c1819[_0x9a84d7(0x1e2)](_0x9a84d7(0x2d7))){const {username:_0x329413,clientip:_0x2c5c16}=_0x3c1819;return settings[_0x9a84d7(0x2a2)]==_0x329413&&_0x265f0e==_0x2c5c16?{'success':_0x9a84d7(0x200)}:{'error':_0x9a84d7(0x2c1)};}}},generateLoginToken=_0x8a7c1a=>{const _0x17269b=_0x2a1284;if(_0x8a7c1a){const _0xd56ce1=devices[_0x8a7c1a]['ip'];return jwt[_0x17269b(0x2dc)]({'username':settings[_0x17269b(0x2a2)],'clientip':_0xd56ce1},secure['secret']+_0x8a7c1a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x53b10=>{const _0x58b97c=_0x2a1284;if(_0x53b10){const _0x7a9af5=devices[_0x53b10]['ip'];return jwt[_0x58b97c(0x2dc)]({'clientip':_0x7a9af5},secure['secret']+_0x53b10,{'expiresIn':devices[_0x53b10][_0x58b97c(0x274)][_0x58b97c(0x1f5)]*0x3c});}else return![];},telegramIpApproved=_0x3a9cd7=>{const _0x39122f=_0x2a1284;let _0x415242=![];return devices[_0x3a9cd7][_0x39122f(0x274)]&&devices[_0x3a9cd7][_0x39122f(0x274)][_0x39122f(0x1f5)]!=_0x39122f(0x301)&&(_0x415242=devices[_0x3a9cd7]['telegramIpApproval'][_0x39122f(0x2d7)]==devices[_0x3a9cd7]['ip']&&new Date()[_0x39122f(0x28e)]()-devices[_0x3a9cd7][_0x39122f(0x274)][_0x39122f(0x2f7)]<devices[_0x3a9cd7][_0x39122f(0x274)][_0x39122f(0x1f5)]*0x3c*0x3e8),_0x415242;},telegram2FaApproved=_0x4a0480=>{const _0x53da7f=_0x2a1284;let _0x202e3d=![];return devices[_0x4a0480]['telegram2FaApproval']&&devices[_0x4a0480]['telegram2FaApproval'][_0x53da7f(0x1f5)]!=_0x53da7f(0x301)&&(_0x202e3d=devices[_0x4a0480]['telegram2FaApproval']['clientip']==devices[_0x4a0480]['ip']&&new Date()[_0x53da7f(0x28e)]()-devices[_0x4a0480]['telegram2FaApproval'][_0x53da7f(0x2f7)]<devices[_0x4a0480]['telegram2FaApproval'][_0x53da7f(0x1f5)]*0x3c*0x3e8),_0x202e3d;},normalizeIP=_0x122d87=>{const _0x527734=_0x2a1284;let _0x1d0c88=null,_0x393443=null;if(ipaddr[_0x527734(0x312)](_0x122d87)){const _0x18aef7=ipaddr['parse'](_0x122d87);_0x18aef7[_0x527734(0x2c9)]()===_0x527734(0x1e0)?(_0x18aef7[_0x527734(0x292)]()&&(_0x1d0c88=_0x18aef7['toIPv4Address']()[_0x527734(0x284)]()),_0x393443=_0x18aef7[_0x527734(0x284)]()):(_0x1d0c88=_0x18aef7[_0x527734(0x284)](),_0x393443=_0x18aef7['toIPv4MappedAddress']()['toString']());}return{'show':_0x1d0c88?_0x1d0c88:_0x393443,'store':_0x393443};};