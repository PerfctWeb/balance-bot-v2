const _0x15ffe5=_0x2963;(function(_0x3949ac,_0x28839a){const _0x5cf64b=_0x2963,_0x2c03e2=_0x3949ac();while(!![]){try{const _0x4cd9c0=parseInt(_0x5cf64b(0x132))/0x1*(-parseInt(_0x5cf64b(0x1dc))/0x2)+-parseInt(_0x5cf64b(0x13c))/0x3+parseInt(_0x5cf64b(0x139))/0x4*(-parseInt(_0x5cf64b(0x156))/0x5)+-parseInt(_0x5cf64b(0x1be))/0x6*(-parseInt(_0x5cf64b(0x1a2))/0x7)+-parseInt(_0x5cf64b(0x1a7))/0x8+-parseInt(_0x5cf64b(0x101))/0x9+parseInt(_0x5cf64b(0xe7))/0xa;if(_0x4cd9c0===_0x28839a)break;else _0x2c03e2['push'](_0x2c03e2['shift']());}catch(_0x5eaa74){_0x2c03e2['push'](_0x2c03e2['shift']());}}}(_0x12f9,0x680b4));const _0x5860db=function(){let _0x2eb1af=!![];return function(_0x5565ae,_0x3827f2){const _0x5661c5=_0x2eb1af?function(){const _0x5805bb=_0x2963;if(_0x3827f2){const _0x373985=_0x3827f2[_0x5805bb(0xf3)](_0x5565ae,arguments);return _0x3827f2=null,_0x373985;}}:function(){};return _0x2eb1af=![],_0x5661c5;};}(),_0x4a263f=_0x5860db(this,function(){const _0x3d096e=_0x2963;return _0x4a263f[_0x3d096e(0xf8)]()[_0x3d096e(0x15b)](_0x3d096e(0x1c9))[_0x3d096e(0xf8)]()[_0x3d096e(0x100)](_0x4a263f)[_0x3d096e(0x15b)](_0x3d096e(0x1c9));});_0x4a263f();'use strict';process[_0x15ffe5(0x137)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x15ffe5(0x174)),FileSync=require(_0x15ffe5(0xec)),fs=require('fs'),fns=require(_0x15ffe5(0x13a)),low=require(_0x15ffe5(0x1d2)),path=require(_0x15ffe5(0x1db)),crypto=require(_0x15ffe5(0x103)),Crypt=require(_0x15ffe5(0x10d))[_0x15ffe5(0xdf)],RSA=require(_0x15ffe5(0x10d))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x15ffe5(0x1da)),analyticsLib=require(_0x15ffe5(0x21f))[_0x15ffe5(0x175)],googleAnalytics=require(_0x15ffe5(0x1ab))[_0x15ffe5(0x175)],ipaddr=require('ipaddr.js'),argv=require(_0x15ffe5(0x19f))(process[_0x15ffe5(0x167)][_0x15ffe5(0x176)](0x2))[_0x15ffe5(0x167)],PORT=argv['port']||_0x15ffe5(0x200),pattern=/^[0-9]{2,4}$/;if(!pattern['test'](PORT))return console[_0x15ffe5(0x152)](_0x15ffe5(0x1ce)+PORT+_0x15ffe5(0x16f)),process[_0x15ffe5(0x110)](0x1);const HOST=argv['host']||null,userID=argv[_0x15ffe5(0x214)]||'';let bbpath=_0x15ffe5(0x131),bbpath2='';const botfile=_0x15ffe5(0x219),configfile=_0x15ffe5(0x1bc),settingsfile=_0x15ffe5(0x1b5),securefile=_0x15ffe5(0x1af);!fs['existsSync'](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x15ffe5(0xf9)),configpath=userID?bbpath+_0x15ffe5(0x1d3)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x15ffe5(0x19e);!fs[_0x15ffe5(0x187)](configpath)&&fs[_0x15ffe5(0x1b8)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x15ffe5(0x1b8)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x15ffe5(0x1de)]({'bots':[]})[_0x15ffe5(0x109)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0x15ffe5(0x109)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);function _0x12f9(){const _0x250fd6=['data','\x20only\x0a','@analytics/google-analytics','Alerts','\x20minutes','order','bb-secure.json','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Invalid\x20authentication\x20token\x20(2)','once','status','enabled\x20Bot\x20','bb-settings.json','pidExpireLogin','Balance\x20Bot','mkdirSync','token','yes','add-bot','bb-config.json','stopPolling','444LyEUQQ','new','<b>Telegram\x20bot\x20status:</b>\x0a','clientip','value','started','emit','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','telegramEvents','ipc','getMinutes','(((.+)+)+)+$','cloneDeep','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','deleted\x20Bot\x20','\x20|\x20','Error:\x20Invalid\x20argument\x20','starting\x20bot\x20|\x20Bot\x20','all','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','lowdb','config/','toIPv4Address','onText','storeConfiguration','Ok,\x20will\x20send\x20order\x20notifications\x20only','Token\x20blacklisted','/enable\x20-\x20enable\x20notifications\x0a','jsonwebtoken','path','387542uZwmGA','reload','defaults','Unauthorized\x20attempt\x20to\x20update\x20bot','exp','30\x20min','from','page','unlinkSync','store-configuration','error\x20while\x20deleting\x20config\x20files:\x20','botID','chat','bots','find','alerts','User\x20has\x20been\x20validated','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','-config.json','-results.json','sockets','getUTCHours','access','expiry','Login\x20rejected','stop','</b>\x20?','sortBy','forEach','<b>Balance\x20Bot\x20status:</b>\x0a','store','allow','inherit','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','telegram','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','3000','use','2FA\x20login\x20rejected','handshake','\x20/\x20','login\x20token\x20generated','SIGINT','/:bot/support','assign','args','Access\x20enabled\x20for\x20','blacklist','live','bot-','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','logout','/off\x20-\x20stop\x20bot(s)\x0a','telegramChatId','login\x20required','hasOwnProperty','user','createServer','Unauthorized\x20attempt\x20to\x20delete\x20bot','remove','::1','bot.js','************','sign','password','polling_error','hex','analytics','HTML','temporaryAccessAllowed','isValid','/:bot/coins','No\x20bots\x20running\x20right\x20now','get-portfolio','Crypt','version','pidRefreshToken','reset-password','idling\x20bot\x20\x20\x20|\x20Bot\x20','404\x20Not\x20Found','Unauthorized\x20attempt\x20to\x20store\x20configuration','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','26202230FgFKSX','telegram2FaApproval','match','starting\x20new\x20bot\x20|\x20Bot\x20','answerCallbackQuery','lowdb/adapters/FileSync','success','padStart','kill','length','readdirSync','All\x20bots\x20running\x20right\x20now','apply','isDirectory','bbPassword','push','Unauthorized\x20attempt\x20to\x20get\x20portfolio','toString','clients','getFullYear','Notifications\x20enabled','enabled','orders','headers','fork','constructor','3617217RKEzVl','/:bot/performance','crypto','hashSync','privateKey','Bot\x20','send','settings','write','sendFile','/:bot/portfolio','apiKey','hybrid-crypto-js','sendMessage','update-bot','exit','cancelLoading','telegramUsername','disabled\x20Bot\x20','https://hodlerhacks.com','node-telegram-bot-api','All','No\x20authentication\x20token','/disable\x20-\x20disable\x20notifications\x0a','listen','Unauthorized\x20login\x20attempt\x20(timeout)','botname','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','callback_query','new-disabled',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','telegramToken','SIGTERM','index.html','message','restart','includes','uuid','restarting\x20Bot\x20','then','event','Allow\x20login\x20from\x20IP\x20address\x20<b>','temporary\x20access\x20not\x20allowed','disabled','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Invalid\x20authentication\x20token\x20(1)','show','cancel-loading','bb/','1dOPGUb','map','secret','store-headless','Notifications\x20types:\x20','env','isIPv4MappedAddress','4BRwCUm','date-fns','function','2104053rFnBcV','whitelistEnabled','loginRequired','bot','temporary\x20token\x20generated','getTime','1000','Password\x20reset\x20rejected','UA-192771731-1','temporary\x20access\x20timeout','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','socket.io','You\x20can\x20use\x20the\x20following\x20commands:\x0a','referer','timeshift','getMonth','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','static','running','notification','telegramIpApproval','Orders','log','/help\x20-\x20show\x20available\x20commands\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getPortfolio','2647095tKUQTc','secure','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','5\x20min','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','search','Unauthorized\x20attempt\x20to\x20add\x20bot','getStartingBalances','removeListener','kind','f2aRequired','connected','set','/:bot','Invalid\x20Telegram\x20token','http','publicKey','argv','Unauthorized\x20attempt\x20to\x20update\x20settings','-performance.json','2FA\x20login\x20required','filter','Notifications\x20disabled','timestamp','Balance\x20Bot\x20Server',',\x20must\x20be\x20a\x204\x20digit\x20number','catch','settings.','compareSync','Notifications\x20enabled\x0a','child_process','default','slice','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','login\x20not\x20required','error','botmanager','2FA\x20required','get','get-starting-balances','::ffff:127.0.0.1','reject','login','build2','reason','server','stopped','split','randomFillSync','existsSync','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','name','username','verify','getDate','randomBytes','logged\x20out','parse','2FA','join','max','\x20>\x20','remoteAddress','disconnect','All\x20bots','decrypt','getHours','getSeconds','Unauthorized\x20attempt\x20to\x20log\x20out','placeOrder','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Notifications\x20disabled\x0a','backup/','yargs/yargs','-----------------------------------------------------------------------------------','entries','26327jfJkGV','bbUsername','2FA\x20login\x20token\x20generated',':\x20Bot\x20Mgr\x20>\x20','telegramEnabled','5167352AMHfpP','build'];_0x12f9=function(){return _0x250fd6;};return _0x12f9();}dbSecure[_0x15ffe5(0x1de)]({'secure':{},'blacklist':[]})[_0x15ffe5(0x109)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x15ffe5(0xe0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0x15ffe5(0x165))[_0x15ffe5(0x215)](app);app[_0x15ffe5(0x201)](express[_0x15ffe5(0x14d)](path[_0x15ffe5(0x191)](__dirname,bbpath2,_0x15ffe5(0x181)))),app[_0x15ffe5(0x201)](express[_0x15ffe5(0x14d)](path[_0x15ffe5(0x191)](__dirname,bbpath2,_0x15ffe5(0x1a8)))),app[_0x15ffe5(0x17c)]('/',function(_0x39db97,_0x4057a0){const _0x42c9a2=_0x15ffe5;_0x4057a0[_0x42c9a2(0x10a)](path[_0x42c9a2(0x191)](__dirname,bbpath2,_0x42c9a2(0x181),_0x42c9a2(0x122)));}),app[_0x15ffe5(0x17c)](_0x15ffe5(0x163),function(_0x5e8533,_0x584d8b){const _0xb3cb29=_0x15ffe5;_0x584d8b[_0xb3cb29(0x10a)](path[_0xb3cb29(0x191)](__dirname,bbpath2,_0xb3cb29(0x1a8),_0xb3cb29(0x122)));}),app[_0x15ffe5(0x17c)](_0x15ffe5(0x10b),(_0x568b7b,_0x28597b)=>{const _0x188139=_0x15ffe5;_0x28597b[_0x188139(0x10a)](path['join'](__dirname,bbpath2,_0x188139(0x1a8),_0x188139(0x122)));}),app[_0x15ffe5(0x17c)](_0x15ffe5(0x102),(_0x139f53,_0x38ddc4)=>{const _0x19439c=_0x15ffe5;_0x38ddc4['sendFile'](path[_0x19439c(0x191)](__dirname,bbpath2,'build',_0x19439c(0x122)));}),app['get'](_0x15ffe5(0xdc),(_0x177273,_0x43c1e5)=>{const _0x14b366=_0x15ffe5;_0x43c1e5['sendFile'](path[_0x14b366(0x191)](__dirname,bbpath2,_0x14b366(0x1a8),_0x14b366(0x122)));}),app[_0x15ffe5(0x17c)]('/:bot/history',(_0x3d6b2b,_0x395442)=>{const _0x36aa30=_0x15ffe5;_0x395442[_0x36aa30(0x10a)](path['join'](__dirname,bbpath2,_0x36aa30(0x1a8),_0x36aa30(0x122)));}),app[_0x15ffe5(0x17c)]('/:bot/configuration',(_0x1ec6aa,_0x3eb313)=>{const _0x4e639a=_0x15ffe5;_0x3eb313[_0x4e639a(0x10a)](path[_0x4e639a(0x191)](__dirname,bbpath2,_0x4e639a(0x1a8),'index.html'));}),app[_0x15ffe5(0x17c)](_0x15ffe5(0x207),(_0x45409b,_0x4abbb3)=>{const _0x3a4af8=_0x15ffe5;_0x4abbb3['sendFile'](path[_0x3a4af8(0x191)](__dirname,bbpath2,_0x3a4af8(0x1a8),_0x3a4af8(0x122)));});if(HOST)http[_0x15ffe5(0x119)](PORT,HOST);else http[_0x15ffe5(0x119)](PORT);const io=require(_0x15ffe5(0x147))(http,{}),analytics=analyticsLib({'app':_0x15ffe5(0x1b7),'plugins':[googleAnalytics({'trackingId':_0x15ffe5(0x144)})]}),TelegramBot=require(_0x15ffe5(0x115));let tgBot;if(settings['telegramToken']&&settings[_0x15ffe5(0x120)]!=''&&settings[_0x15ffe5(0x112)]&&settings[_0x15ffe5(0x112)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x12d94b=_0x15ffe5;console[_0x12d94b(0x152)](''),console[_0x12d94b(0x152)](_0x12d94b(0x1a0)),logging(_0x12d94b(0x14c)+PORT),console[_0x12d94b(0x152)]('-----------------------------------------------------------------------------------');if(config[_0x12d94b(0xf0)]!=0x0)config[_0x12d94b(0x1f8)](_0x5dfe28=>{const _0x845088=_0x12d94b;if(_0x5dfe28[_0x845088(0x1b3)]==_0x845088(0xfc)||_0x5dfe28['status']==_0x845088(0x1bf))logging(_0x845088(0x1cf)+_0x5dfe28['botID']+_0x845088(0x1cd)+_0x5dfe28[_0x845088(0x11b)]),startBot([_0x5dfe28[_0x845088(0x1e7)],userID],{'cwd':bbpath},function(_0x145746){if(_0x145746)logging(_0x145746);});else(_0x5dfe28[_0x845088(0x1b3)]==_0x845088(0x12c)||_0x5dfe28['status']==_0x845088(0x11e))&&logging(_0x845088(0xe3)+_0x5dfe28[_0x845088(0x1e7)]+_0x845088(0x1cd)+_0x5dfe28['botname']);});else!newBot&&console[_0x12d94b(0x152)](_0x12d94b(0x158));if(newBot)addBot();console[_0x12d94b(0x152)](_0x12d94b(0x1a0)),console[_0x12d94b(0x152)]('');}function startSocket(){io['on']('connection',_0x18473c=>{const _0x50b021=_0x2963;let _0x32a0c6,_0x2a7f7d,_0x3fa4e2,_0x150b97,_0x2fbf60;const _0x120fc6=_0x18473c[_0x50b021(0x203)][_0x50b021(0xfe)][_0x50b021(0x149)];_0x2a7f7d=_0x120fc6[_0x50b021(0xe9)](/bot[0-9]{3}/);if(_0x2a7f7d)_0x3fa4e2=_0x2a7f7d[0x0][_0x50b021(0xe9)](/[0-9]{3}/);if(_0x3fa4e2)_0x32a0c6=_0x3fa4e2[0x0];else _0x32a0c6=_0x50b021(0x17a);const _0x266e4a=_0x18473c['handshake']['auth']['encryptedUuid'];if(!_0x266e4a)_0x18473c['emit'](_0x50b021(0x1b3),{'publicKey':secure['publicKey']});else{_0x150b97=timelyDecrypt(_0x266e4a,![]);if(!_0x150b97)logging('Unauthorized\x20login\x20attempt\x20(public\x20key)');else{_0x2fbf60=normalizeIP(_0x18473c['conn'][_0x50b021(0x194)])[_0x50b021(0x1fa)];if(!devices[_0x150b97])devices[_0x150b97]={'uuid':_0x150b97,'access':{'token':null}};devices[_0x150b97]['ip']=_0x2fbf60;const _0x365ead=addClient(_0x18473c['id'],_0x150b97,_0x32a0c6);setAccess(_0x365ead),_0x18473c['on'](_0x50b021(0x180),_0x4061da=>{const _0x17d048=_0x50b021,_0x33feac=timelyDecrypt(_0x4061da[_0x17d048(0x21c)]);if(_0x33feac){_0x4061da={'username':_0x4061da['username'],'password':_0x33feac},devices[_0x150b97][_0x17d048(0x1f2)]=validateCredentials(_0x4061da,_0x150b97);if(devices[_0x150b97][_0x17d048(0x1f2)][_0x17d048(0x1fb)]==![]&&devices[_0x150b97][_0x17d048(0x1f2)][_0x17d048(0x182)]==_0x17d048(0x16a))_0x18473c[_0x17d048(0x1c4)](_0x17d048(0x1b3),{'access':devices[_0x150b97]['access']}),loginAccess2FA(_0x150b97,_0x2fbf60);else{if(devices[_0x150b97][_0x17d048(0x1f2)][_0x17d048(0x1fb)]==![]&&devices[_0x150b97]['access'][_0x17d048(0x182)]=='invalid\x20credentials')_0x18473c['emit'](_0x17d048(0x1b3),{'access':devices[_0x150b97][_0x17d048(0x1f2)]});else devices[_0x150b97][_0x17d048(0x1f2)][_0x17d048(0x1fb)]&&devices[_0x150b97][_0x17d048(0x1f2)][_0x17d048(0x182)]==_0x17d048(0x205)&&(getClientsWithUuid(_0x150b97)['forEach'](_0x566622=>{setAccess(_0x566622);}),setTokenRefresh(_0x150b97),setSessionTimeout(_0x17d048(0x180),_0x150b97));}}else logging(_0x17d048(0x11a));}),_0x18473c['on'](_0x50b021(0xe2),()=>{resetPassword();}),_0x18473c['on'](_0x50b021(0x195),_0x3e1636=>{removeClient(_0x18473c['id']);});}}});}function initClient(_0xa0c2bc){const _0xb0c289=_0x15ffe5;if(_0xa0c2bc!=_0xb0c289(0x17a)&&config[_0xb0c289(0x10c)]!=''){if(pid[_0xa0c2bc])pid[_0xa0c2bc][_0xb0c289(0x107)]({'function':'initclient','args':null});}}function getSocket(_0x5f4586){const _0x1ae5c7=_0x15ffe5;return io['sockets'][_0x1ae5c7(0x1f0)][_0x1ae5c7(0x17c)](_0x5f4586);}function setAccess(_0x232b3d){const _0x36f14e=_0x15ffe5,_0x46e86e=getSocket(_0x232b3d['id']),_0x2f42e6=_0x232b3d['uuid'],_0x2cf901=_0x232b3d[_0x36f14e(0x13f)];devices[_0x2f42e6]['access']=validateAccess(devices[_0x2f42e6]['access'][_0x36f14e(0x1b9)],_0x2f42e6),_0x46e86e['join'](_0x2f42e6);if(devices[_0x2f42e6][_0x36f14e(0x1f2)][_0x36f14e(0x1fb)]){_0x46e86e[_0x36f14e(0x191)](_0x2cf901);if(_0x2cf901=='botmanager')initializeSocketBotManager(_0x46e86e);else initializeSocketBot(_0x46e86e);initClient(_0x2cf901);}devices[_0x2f42e6][_0x36f14e(0x1f2)][_0x36f14e(0x1b9)]&&devices[_0x2f42e6][_0x36f14e(0x1f2)][_0x36f14e(0x182)]==_0x36f14e(0x140)&&setSessionTimeout(_0x36f14e(0x190),_0x2f42e6),devices[_0x2f42e6]['access'][_0x36f14e(0x1b9)]&&devices[_0x2f42e6][_0x36f14e(0x1f2)]['reason']==_0x36f14e(0x1a4)&&setSessionTimeout(_0x36f14e(0x180),_0x2f42e6),_0x46e86e[_0x36f14e(0x1c4)]('status',{'status':_0x232b3d[_0x36f14e(0x183)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2f42e6][_0x36f14e(0x1f2)],'externalip':devices[_0x2f42e6]['ip'],'publicKey':secure[_0x36f14e(0x166)]}),devices[_0x2f42e6]['access']['allow']==![]&&devices[_0x2f42e6][_0x36f14e(0x1f2)][_0x36f14e(0x182)]==_0x36f14e(0x17b)&&temporaryAccess2FA(_0x2f42e6,devices[_0x2f42e6]['ip']);}function setSessionTimeout(_0xc0347f,_0x3e1dd0){const _0x1e021=_0x15ffe5;let _0x92810d;if(_0xc0347f==_0x1e021(0x180))_0x92810d=loginExpiry*0x3c*0x3e8;else _0x92810d=devices[_0x3e1dd0]['telegramIpApproval'][_0x1e021(0x1f3)]*0x3c*0x3e8-(new Date()[_0x1e021(0x141)]()-devices[_0x3e1dd0][_0x1e021(0x150)][_0x1e021(0x16d)]);if(devices[_0x3e1dd0][_0x1e021(0x1b6)])clearTimeout(devices[_0x3e1dd0]['pidExpireLogin']);devices[_0x3e1dd0][_0x1e021(0x1b6)]=setTimeout(()=>{const _0x150c0d=_0x1e021;if(devices[_0x3e1dd0][_0x150c0d(0xe1)])clearTimeout(devices[_0x3e1dd0][_0x150c0d(0xe1)]);removeSocketListeners(_0x3e1dd0),addBlacklist(_0x3e1dd0),devices[_0x3e1dd0][_0x150c0d(0x150)]=null,devices[_0x3e1dd0][_0x150c0d(0xe8)]=null,devices[_0x3e1dd0][_0x150c0d(0x1f2)]['token']=null,devices[_0x3e1dd0][_0x150c0d(0x1f2)]=validateAccess(devices[_0x3e1dd0][_0x150c0d(0x1f2)][_0x150c0d(0x1b9)],_0x3e1dd0),!(devices[_0x3e1dd0][_0x150c0d(0x1f2)][_0x150c0d(0x1fb)]&&devices[_0x3e1dd0][_0x150c0d(0x1f2)][_0x150c0d(0x182)]==_0x150c0d(0x178))&&(_0xc0347f==_0x150c0d(0x180)?io['to'](_0x3e1dd0)[_0x150c0d(0x1c4)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x3e1dd0)['emit'](_0x150c0d(0x1b3),{'access':{'allow':![],'reason':_0x150c0d(0x145),'token':null}})),devices[_0x3e1dd0]['access']['token']=null;},_0x92810d);}function setTokenRefresh(_0x3324ac){const _0x40618f=_0x15ffe5;if(devices[_0x3324ac][_0x40618f(0xe1)])clearTimeout(devices[_0x3324ac][_0x40618f(0xe1)]);devices[_0x3324ac]['pidRefreshToken']=setTimeout(()=>{const _0xa0fd8d=_0x40618f;getClientsWithUuid(_0x3324ac)[_0xa0fd8d(0xf0)]!=0x0?(devices[_0x3324ac][_0xa0fd8d(0x1f2)]=refreshToken(_0x3324ac),io['to'](_0x3324ac)[_0xa0fd8d(0x1c4)]('status',{'status':_0xa0fd8d(0x161),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3324ac][_0xa0fd8d(0x1f2)],'externalip':devices[_0x3324ac]['ip'],'publicKey':secure[_0xa0fd8d(0x166)]}),setTokenRefresh(_0x3324ac)):clearTimeout(devices[_0x3324ac][_0xa0fd8d(0xe1)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xf6f298){const _0x15b3e1=_0x15ffe5,_0x197019=getClient(_0xf6f298['id'])[_0x15b3e1(0x126)];_0xf6f298[_0x15b3e1(0x1c4)](_0x15b3e1(0x1e9),config),_0xf6f298[_0x15b3e1(0x1c4)](_0x15b3e1(0x108),cleanSettings()),_0xf6f298['on'](_0x15b3e1(0x1bb),_0x63c8a8=>{const _0x21b1db=_0x15b3e1;if(validateAccess(_0x63c8a8,_0x197019)[_0x21b1db(0x1fb)])addBot();else logging(_0x21b1db(0x15c));}),_0xf6f298['on'](_0x15b3e1(0x10f),(_0x1075e2,_0x219e15)=>{const _0x511005=_0x15b3e1;if(validateAccess(_0x219e15,_0x197019)[_0x511005(0x1fb)])toggleBot(_0x1075e2['botID'],_0x1075e2[_0x511005(0x1b3)],_0x1075e2[_0x511005(0x20c)]);else logging(_0x511005(0x1df));}),_0xf6f298['on']('delete-bot',(_0x31fa22,_0x5895be)=>{const _0x5dff8a=_0x15b3e1;if(validateAccess(_0x5895be,_0x197019)['allow'])deleteBot(_0x31fa22);else logging(_0x5dff8a(0x216));}),_0xf6f298['on']('store-settings',(_0x10463b,_0x584f9f)=>{const _0x3335e6=_0x15b3e1;if(validateAccess(_0x584f9f,_0x197019)[_0x3335e6(0x1fb)])storeSettings(_0x10463b,!![]);else logging(_0x3335e6(0x168));}),_0xf6f298['on']('update-bb',(_0x25abb3,_0x406363)=>{const _0x2f4a4b=_0x15b3e1;if(validateAccess(_0x406363,_0x197019)['allow'])updateBB();else logging(_0x2f4a4b(0x168));}),_0xf6f298['on'](_0x15b3e1(0x20f),_0x115fe2=>{const _0x4f7fa8=_0x15b3e1;if(validateAccess(_0x115fe2,_0x197019)[_0x4f7fa8(0x1fb)]){if(devices[_0x197019]['pidRefreshToken'])clearTimeout(devices[_0x197019][_0x4f7fa8(0xe1)]);if(devices[_0x197019][_0x4f7fa8(0x1b6)])clearTimeout(devices[_0x197019][_0x4f7fa8(0x1b6)]);removeSocketListeners(getClient(_0xf6f298['id'])['uuid']),addBlacklist(_0x197019),devices[_0x197019][_0x4f7fa8(0x150)]=null,devices[_0x197019][_0x4f7fa8(0xe8)]=null,devices[_0x197019][_0x4f7fa8(0x1f2)][_0x4f7fa8(0x1b9)]=null,io['to'](getClient(_0xf6f298['id'])[_0x4f7fa8(0x126)])[_0x4f7fa8(0x1c4)](_0x4f7fa8(0x1b3),{'access':{'allow':![],'reason':_0x4f7fa8(0x18e),'token':null}});}else logging(_0x4f7fa8(0x19a));});}function initializeSocketBot(_0x5b6477){const _0x56dcdf=_0x15ffe5,_0x591c48=getClient(_0x5b6477['id'])[_0x56dcdf(0x13f)],_0x19c794=getClient(_0x5b6477['id'])[_0x56dcdf(0x126)];_0x5b6477['on']('get-logs',(_0x35417e,_0x2192c8)=>{const _0x3b37ee=_0x56dcdf;if(validateAccess(_0x2192c8,_0x19c794)[_0x3b37ee(0x1fb)]){if(pid[_0x591c48])pid[_0x591c48]['send']({'function':'emitHistory','args':_0x35417e});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x5b6477['on'](_0x56dcdf(0xde),(_0x1b841b,_0x29386f)=>{const _0xd82a7a=_0x56dcdf;if(validateAccess(_0x29386f,_0x19c794)['allow']){if(pid[_0x591c48])pid[_0x591c48][_0xd82a7a(0x107)]({'function':_0xd82a7a(0x155),'args':_0x1b841b});}else logging(_0xd82a7a(0xf7));}),_0x5b6477['on'](_0x56dcdf(0x1e5),(_0x3a035c,_0x1f4793)=>{const _0x4a7a45=_0x56dcdf;if(validateAccess(_0x1f4793,_0x19c794)[_0x4a7a45(0x1fb)]){if(pid[_0x591c48])pid[_0x591c48][_0x4a7a45(0x107)]({'function':_0x4a7a45(0x1d6),'args':_0x3a035c});}else logging(_0x4a7a45(0xe5));}),_0x5b6477['on'](_0x56dcdf(0x135),(_0x24ea4,_0x4e8936)=>{const _0x5e37e7=_0x56dcdf;if(validateAccess(_0x4e8936,_0x19c794)['allow']){if(pid[_0x591c48])pid[_0x591c48][_0x5e37e7(0x107)]({'function':'storeHeadless','args':_0x24ea4});}else logging(_0x5e37e7(0x1ff));}),_0x5b6477['on'](_0x56dcdf(0x17d),_0x416ac4=>{const _0x418600=_0x56dcdf;if(validateAccess(_0x416ac4,_0x19c794)[_0x418600(0x1fb)]){if(pid[_0x591c48])pid[_0x591c48][_0x418600(0x107)]({'function':_0x418600(0x15d),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x5b6477['on']('place-order',(_0x51a057,_0x3c73a1)=>{const _0x5f41dd=_0x56dcdf;if(validateAccess(_0x3c73a1,_0x19c794)[_0x5f41dd(0x1fb)]){if(pid[_0x591c48])pid[_0x591c48]['send']({'function':_0x5f41dd(0x19b),'args':_0x51a057});}else logging(_0x5f41dd(0x1cb));}),_0x5b6477['on'](_0x56dcdf(0x130),_0x45826c=>{const _0x4ec953=_0x56dcdf;if(validateAccess(_0x45826c,_0x19c794)[_0x4ec953(0x1fb)]){if(pid[_0x591c48])pid[_0x591c48][_0x4ec953(0x107)]({'function':_0x4ec953(0x111),'args':null});}else logging(_0x4ec953(0x12d));}),_0x5b6477['on']('logout',_0x62faf7=>{const _0x4e5ef3=_0x56dcdf;if(validateAccess(_0x62faf7,_0x19c794)[_0x4e5ef3(0x1fb)]){if(devices[_0x19c794][_0x4e5ef3(0xe1)])clearTimeout(devices[_0x19c794][_0x4e5ef3(0xe1)]);if(devices[_0x19c794][_0x4e5ef3(0x1b6)])clearTimeout(devices[_0x19c794][_0x4e5ef3(0x1b6)]);removeSocketListeners(getClient(_0x5b6477['id'])[_0x4e5ef3(0x126)]),addBlacklist(_0x19c794),devices[_0x19c794][_0x4e5ef3(0x150)]=null,devices[_0x19c794][_0x4e5ef3(0xe8)]=null,devices[_0x19c794][_0x4e5ef3(0x1f2)]['token']=null,io['to'](getClient(_0x5b6477['id'])[_0x4e5ef3(0x126)])['emit'](_0x4e5ef3(0x1b3),{'access':{'allow':![],'reason':_0x4e5ef3(0x18e),'token':null}});}else logging(_0x4e5ef3(0x19a));});}function removeSocketListeners(_0x2f5041){const _0x441716=_0x15ffe5;getClientsWithUuid(_0x2f5041)[_0x441716(0x1f8)](_0x33de61=>{getSocket(_0x33de61['id'])['removeAllListeners']();});}function cleanSettings(){const _0x28583c=_0x15ffe5;let _0x3abebe=settings;return settings[_0x28583c(0x120)]&&settings[_0x28583c(0x120)]!=''&&(_0x3abebe={..._0x3abebe,'telegramToken':_0x28583c(0x21a)}),settings[_0x28583c(0xf5)]&&settings[_0x28583c(0xf5)]!=''&&(_0x3abebe={..._0x3abebe,'bbPassword':_0x28583c(0x21a)}),_0x3abebe;}function updateBB(){const _0x31b7eb=_0x15ffe5;process[_0x31b7eb(0x107)]({'update':!![]});}function startBot(_0x2e9913,_0x582c5e,_0x53694b){const _0x23cf7d=_0x15ffe5;let _0x4b843b=![];const _0x62abed=_0x2e9913[0x0];_0x582c5e={..._0x582c5e,'stdio':[_0x23cf7d(0x1fc),'inherit',_0x23cf7d(0x1fc),_0x23cf7d(0x1c7)]},pid[_0x62abed]=childProcess[_0x23cf7d(0xff)](botfile,_0x2e9913,_0x582c5e),pid[_0x62abed]['on'](_0x23cf7d(0x123),_0x50ff57=>{const _0x573734=_0x23cf7d;switch(Object['keys'](_0x50ff57)[0x0]){case'botname':updateBotName(_0x62abed,_0x50ff57[_0x573734(0x11b)]);break;case _0x573734(0x1b3):updateStatus(_0x62abed,_0x50ff57[_0x573734(0x1b3)]);break;case _0x573734(0x20c):updateLive(_0x62abed,_0x50ff57[_0x573734(0x20c)]);break;case _0x573734(0x1c3):updateLive(_0x62abed,_0x50ff57['started']),io['to'](_0x62abed)[_0x573734(0x1c4)]('status',{'access':{'allow':![],'reason':_0x573734(0x1dd),'token':null}});break;case _0x573734(0x1f5):_0x50ff57[_0x573734(0x1f5)]==_0x573734(0x124)&&stopBot(_0x62abed);_0x50ff57[_0x573734(0x1f5)]=='kill'&&toggleBot(_0x62abed,_0x573734(0x12c),_0x573734(0x184));break;case _0x573734(0x1fe):sendTelegram(_0x62abed,_0x50ff57[_0x573734(0x1fe)]);break;case _0x573734(0x13b):io['to'](_0x62abed)[_0x573734(0x1c4)](_0x50ff57[_0x573734(0x13b)],_0x50ff57[_0x573734(0x209)]);break;}}),pid[_0x62abed]['on']('error',function(_0xe9d2cb){if(_0x4b843b)return;_0x4b843b=!![],_0x53694b(_0xe9d2cb);}),pid[_0x62abed]['on'](_0x23cf7d(0x110),function(_0x144309){const _0x3ee360=_0x23cf7d;if(_0x4b843b)return;_0x4b843b=!![],_0x53694b(null);const _0x41c7a3=dbConfig[_0x3ee360(0x17c)](_0x3ee360(0x1e9))['find']({'botID':_0x62abed})[_0x3ee360(0x1c2)]();_0x41c7a3&&(_0x41c7a3['status']=='enabled'||_0x41c7a3[_0x3ee360(0x1b3)]==_0x3ee360(0x1bf))&&(updateLive(_0x62abed,_0x3ee360(0x184)),logging(_0x3ee360(0x127)+_0x62abed),startBot([_0x62abed,userID],{'cwd':bbpath},function(_0x15ec5a){if(_0x15ec5a)logging(_0x15ec5a);}));});}function stopBot(_0x405c57){const _0x7ac4a6=_0x15ffe5;getClientsWithBotID(_0x405c57)[_0x7ac4a6(0x1f8)](_0x275f3f=>{const _0x5109a2=_0x7ac4a6;getSocket(_0x275f3f['id'])[_0x5109a2(0x195)](!![]),removeClient(_0x275f3f['id']);});if(pid[_0x405c57])pid[_0x405c57][_0x7ac4a6(0xef)]();}function _0x2963(_0x3e6810,_0x5a0a74){const _0x35eb16=_0x12f9();return _0x2963=function(_0x4a263f,_0x5860db){_0x4a263f=_0x4a263f-0xdb;let _0x12f9a9=_0x35eb16[_0x4a263f];return _0x12f9a9;},_0x2963(_0x3e6810,_0x5a0a74);}function addBot(){const _0x40ec0e=_0x15ffe5;let _0x132517;for(let _0x493800=0x1;_0x493800<0x3e9;_0x493800++){_0x132517=_0x493800[_0x40ec0e(0xf8)]()[_0x40ec0e(0xee)](0x3,'0');let _0x138878=config[_0x40ec0e(0x1ea)](_0x5145f3=>_0x5145f3[_0x40ec0e(0x1e7)]==_0x132517);if(!_0x138878)break;}if(_0x132517===_0x40ec0e(0x142)){logging(_0x40ec0e(0x146));return;}logging(_0x40ec0e(0xea)+_0x132517),dbConfig[_0x40ec0e(0x17c)](_0x40ec0e(0x1e9))['push']({'botID':_0x132517,'botname':_0x40ec0e(0x106)+_0x132517,'status':'new','live':''})[_0x40ec0e(0x109)](),startBot([_0x132517,userID],{'cwd':bbpath},function(_0x501c2b){if(_0x501c2b)logging(_0x501c2b);}),config=getConfiguration(),io['to'](_0x40ec0e(0x17a))['emit'](_0x40ec0e(0x1e9),config);}function deleteBot(_0x396d6a){const _0x2a679a=_0x15ffe5;getClientsWithBotID(_0x396d6a)['forEach'](_0x3620a9=>{getSocket(_0x3620a9['id'])['disconnect'](!![]),removeClient(_0x3620a9['id']);}),dbConfig[_0x2a679a(0x17c)](_0x2a679a(0x1e9))[_0x2a679a(0x217)]({'botID':_0x396d6a})[_0x2a679a(0x109)](),logging(_0x2a679a(0x1cc)+_0x396d6a),stopBot(_0x396d6a);try{fs[_0x2a679a(0x1e4)](path[_0x2a679a(0x191)](configpath,_0x2a679a(0x20d)+_0x396d6a+_0x2a679a(0x1ee))),fs['unlinkSync'](path[_0x2a679a(0x191)](configpath,_0x2a679a(0x20d)+_0x396d6a+'-events.json')),fs[_0x2a679a(0x1e4)](path['join'](configpath,_0x2a679a(0x20d)+_0x396d6a+_0x2a679a(0x169))),fs[_0x2a679a(0x1e4)](path[_0x2a679a(0x191)](configpath,_0x2a679a(0x20d)+_0x396d6a+_0x2a679a(0x1ef)));}catch(_0x11b697){if(_0x11b697)logging(_0x2a679a(0x1e6),_0x11b697);}config=getConfiguration(),io['to'](_0x2a679a(0x17a))[_0x2a679a(0x1c4)](_0x2a679a(0x1e9),config);}function toggleBot(_0x4046af,_0x28098b,_0x2bd97e){const _0x9399a6=_0x15ffe5;dbConfig['get'](_0x9399a6(0x1e9))[_0x9399a6(0x1ea)]({'botID':_0x4046af})[_0x9399a6(0x208)]({'status':_0x28098b})[_0x9399a6(0x208)]({'live':_0x2bd97e})[_0x9399a6(0x109)]();if(_0x28098b==_0x9399a6(0xfc)||_0x28098b==_0x9399a6(0x1bf))logging(_0x9399a6(0x1b4)+_0x4046af),startBot([_0x4046af,userID],{'cwd':bbpath},function(_0x3422b8){if(_0x3422b8)logging(_0x3422b8);});else(_0x28098b==_0x9399a6(0x12c)||_0x28098b==_0x9399a6(0x11e))&&(logging(_0x9399a6(0x113)+_0x4046af),stopBot(_0x4046af));config=getConfiguration(),io['to']('botmanager')[_0x9399a6(0x1c4)]('bots',config);}function toggleStatus(_0x4ac5ce){const _0x20664f=_0x15ffe5;let _0x697993=dbConfig[_0x20664f(0x17c)](_0x20664f(0x1e9))[_0x20664f(0x1ea)]({'botID':_0x4ac5ce})[_0x20664f(0x1c2)](),_0x5ddcac;if(_0x697993['status']==='enabled')_0x5ddcac=_0x20664f(0x12c);else{if(_0x697993[_0x20664f(0x1b3)]===_0x20664f(0x1bf))_0x5ddcac=_0x20664f(0x11e);else{if(_0x697993[_0x20664f(0x1b3)]===_0x20664f(0x11e))_0x5ddcac=_0x20664f(0x1bf);else{if(_0x697993[_0x20664f(0x1b3)]===_0x20664f(0x12c))_0x5ddcac=_0x20664f(0xfc);}}}return _0x5ddcac;}function updateStatus(_0x5be6c0,_0x42541f){const _0x398a18=_0x15ffe5;dbConfig[_0x398a18(0x17c)]('bots')[_0x398a18(0x1ea)]({'botID':_0x5be6c0})[_0x398a18(0x208)]({'status':_0x42541f})[_0x398a18(0x109)](),config=getConfiguration(),io['to'](_0x398a18(0x17a))['emit']('bots',config);}function updateLive(_0x5f551b,_0x522d8d){const _0x564a5d=_0x15ffe5;dbConfig[_0x564a5d(0x17c)]('bots')['find']({'botID':_0x5f551b})[_0x564a5d(0x208)]({'live':_0x522d8d})['write'](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config);}function updateBotName(_0x3896b8,_0x3d5381){const _0x15602b=_0x15ffe5;dbConfig['get'](_0x15602b(0x1e9))[_0x15602b(0x1ea)]({'botID':_0x3896b8})[_0x15602b(0x208)]({'botname':_0x3d5381})['write'](),config=getConfiguration(),io['to'](_0x15602b(0x17a))[_0x15602b(0x1c4)](_0x15602b(0x1e9),config);}function telegramError(_0x509503){const _0x50208f=_0x15ffe5;console[_0x50208f(0x152)](getTimeStamp()+_0x50208f(0x11f));}function validateTelegram(_0x49b803){const _0x55b7a7=_0x15ffe5;if(_0x49b803[_0x55b7a7(0x1e2)][_0x55b7a7(0x18a)]!=settings[_0x55b7a7(0x112)]&&'@'+_0x49b803[_0x55b7a7(0x1e2)][_0x55b7a7(0x18a)]!=settings['telegramUsername'])return tgBot[_0x55b7a7(0x10e)](_0x49b803[_0x55b7a7(0x1e8)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x55b7a7(0x220)})[_0x55b7a7(0x170)](_0x6b83ea=>{telegramError(_0x6b83ea);}),![];return!![];}async function initTelegram(){const _0x3a0d04=_0x15ffe5;if(tgBot)tgBot[_0x3a0d04(0x1bd)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x193319=_0x3a0d04(0x148);_0x193319+='\x0a',_0x193319+=_0x3a0d04(0x1d9),_0x193319+=_0x3a0d04(0x118),_0x193319+=_0x3a0d04(0x11c),_0x193319+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x193319+='/on\x20-\x20start\x20bot(s)\x0a',_0x193319+=_0x3a0d04(0x210),_0x193319+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x193319+=_0x3a0d04(0x153);let _0xfd03d4='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0xfd03d4+='\x0a',_0xfd03d4+=_0x193319,tgBot[_0x3a0d04(0x1d5)](/\/start/,_0x525c16=>{const _0x241e5b=_0x3a0d04;if(!validateTelegram(_0x525c16))return;if(settings[_0x241e5b(0x211)]!=_0x525c16['chat']['id'])updateSetting(_0x241e5b(0x211),_0x525c16['chat']['id']);updateSetting(_0x241e5b(0x1a6),!![]),tgBot['sendMessage'](_0x525c16[_0x241e5b(0x1e8)]['id'],_0xfd03d4)[_0x241e5b(0x170)](_0x60880e=>{telegramError(_0x60880e);});}),tgBot[_0x3a0d04(0x1d5)](/\/enable/,_0x2a0274=>{const _0x2e1b90=_0x3a0d04;if(!validateTelegram(_0x2a0274))return;if(settings['telegramChatId']!=_0x2a0274['chat']['id'])updateSetting(_0x2e1b90(0x211),_0x2a0274[_0x2e1b90(0x1e8)]['id']);updateSetting(_0x2e1b90(0x1a6),!![]),tgBot[_0x2e1b90(0x10e)](_0x2a0274[_0x2e1b90(0x1e8)]['id'],_0x2e1b90(0xfb))[_0x2e1b90(0x170)](_0x850b7d=>{telegramError(_0x850b7d);});}),tgBot[_0x3a0d04(0x1d5)](/\/config/,async _0x5a6434=>{const _0x5da988=_0x3a0d04;if(!validateTelegram(_0x5a6434))return;tgBot[_0x5da988(0x15e)]('callback_query'),tgBot[_0x5da988(0x10e)](_0x5a6434['chat']['id'],_0x5da988(0x1d1),{'reply_markup':{'inline_keyboard':[[{'text':_0x5da988(0x151),'callback_data':_0x5da988(0xfd)},{'text':_0x5da988(0x1ac),'callback_data':_0x5da988(0x1eb)},{'text':_0x5da988(0x116),'callback_data':_0x5da988(0x1d0)}]]}})[_0x5da988(0x170)](_0x2a0ea8=>{telegramError(_0x2a0ea8);}),tgBot['on'](_0x5da988(0x11d),async _0x18eacb=>{const _0x38b178=_0x5da988,_0x295316=_0x18eacb[_0x38b178(0x1a9)],_0x5843ae=_0x18eacb[_0x38b178(0x123)];tgBot[_0x38b178(0xeb)](_0x18eacb['id'])[_0x38b178(0x128)](async()=>{const _0x37d4cd=_0x38b178;_0x295316==_0x37d4cd(0xfd)&&(updateSetting(_0x37d4cd(0x1c6),'orders'),updateSetting(_0x37d4cd(0x1a6),!![]),await tgBot[_0x37d4cd(0x10e)](_0x5843ae[_0x37d4cd(0x1e8)]['id'],_0x37d4cd(0x1d7))[_0x37d4cd(0x170)](_0x4efe7c=>{telegramError(_0x4efe7c);}));_0x295316==_0x37d4cd(0x1eb)&&(updateSetting(_0x37d4cd(0x1c6),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x37d4cd(0x10e)](_0x5843ae[_0x37d4cd(0x1e8)]['id'],_0x37d4cd(0x1b0))['catch'](_0x22b291=>{telegramError(_0x22b291);}));_0x295316==_0x37d4cd(0x1d0)&&(updateSetting('telegramEvents',_0x37d4cd(0x1d0)),updateSetting('telegramEnabled',!![]),await tgBot[_0x37d4cd(0x10e)](_0x5843ae[_0x37d4cd(0x1e8)]['id'],_0x37d4cd(0x154))[_0x37d4cd(0x170)](_0x4daeb9=>{telegramError(_0x4daeb9);}));if(!settings[_0x37d4cd(0x211)])tgBot[_0x37d4cd(0x10e)](_0x5843ae[_0x37d4cd(0x1e8)]['id'],_0x37d4cd(0x15a))[_0x37d4cd(0x170)](_0xd5a186=>{telegramError(_0xd5a186);});}),tgBot['removeListener'](_0x38b178(0x11d));});}),tgBot['onText'](/\/status/,_0x3ad4bb=>{const _0x2bc477=_0x3a0d04;if(!validateTelegram(_0x3ad4bb))return;let _0xdc782e=_0x2bc477(0x1f9);config[_0x2bc477(0x1f8)](_0x3124c8=>{const _0x531a8c=_0x2bc477;_0xdc782e+=_0x531a8c(0x106)+_0x3124c8[_0x531a8c(0x1e7)]+_0x531a8c(0x1cd)+_0x3124c8['botname']+':\x20'+_0x3124c8['status']+_0x531a8c(0x204)+_0x3124c8[_0x531a8c(0x20c)]+'\x0a';}),_0xdc782e+='\x0a',_0xdc782e+=_0x2bc477(0x1c0),_0xdc782e+=!settings['telegramEnabled']?_0x2bc477(0x19d):_0x2bc477(0x173),_0xdc782e+=settings[_0x2bc477(0x1a6)]?settings[_0x2bc477(0x1c6)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x2bc477(0x136)+settings[_0x2bc477(0x1c6)]+_0x2bc477(0x1aa):'',tgBot[_0x2bc477(0x10e)](_0x3ad4bb[_0x2bc477(0x1e8)]['id'],_0xdc782e,{'parse_mode':_0x2bc477(0x220)})[_0x2bc477(0x170)](_0x1cc266=>{telegramError(_0x1cc266);});}),tgBot[_0x3a0d04(0x1d5)](/\/restart/,_0x49d4e6=>{const _0x37ba70=_0x3a0d04;if(!validateTelegram(_0x49d4e6))return;tgBot[_0x37ba70(0x15e)](_0x37ba70(0x11d));const _0x5dfe55=getEnabledBots();if(_0x5dfe55[_0x37ba70(0xf0)]==0x0)tgBot[_0x37ba70(0x10e)](_0x49d4e6['chat']['id'],_0x37ba70(0xdd))['catch'](_0x4d6a43=>{telegramError(_0x4d6a43);});else{if(_0x5dfe55['length']>0x1)_0x5dfe55[_0x37ba70(0xf6)]({'botID':_0x37ba70(0x1d0)});let _0x14d1f6=[],_0x323d7a=[];const _0x442648=_0x5dfe55['length']%0x4==0x0||_0x5dfe55[_0x37ba70(0xf0)]%0x4==0x3||_0x5dfe55[_0x37ba70(0xf0)]%0x3==0x1?0x4:0x3;let _0x3dae27=0x0;_0x5dfe55[_0x37ba70(0x1f8)]((_0x27d61e,_0x174a7e)=>{const _0x5e55bf=_0x37ba70;if(_0x174a7e%_0x442648==0x0)_0x323d7a=[];_0x323d7a[_0x5e55bf(0xf6)]({'text':_0x27d61e['botID']==_0x5e55bf(0x1d0)?_0x5e55bf(0x196):_0x5e55bf(0x106)+_0x27d61e[_0x5e55bf(0x1e7)],'callback_data':_0x27d61e['botID']}),_0x174a7e%_0x442648==0x0&&(_0x14d1f6[_0x3dae27]=_0x323d7a,_0x3dae27++);}),tgBot[_0x37ba70(0x10e)](_0x49d4e6[_0x37ba70(0x1e8)]['id'],_0x37ba70(0x1ed),{'reply_markup':{'inline_keyboard':_0x14d1f6}})[_0x37ba70(0x170)](_0x8b1ed5=>{telegramError(_0x8b1ed5);}),tgBot['on']('callback_query',async _0x1414dd=>{const _0x2e08d1=_0x37ba70,_0x322bdb=_0x1414dd['data'],_0x1d6396=_0x1414dd[_0x2e08d1(0x123)];tgBot[_0x2e08d1(0xeb)](_0x1414dd['id'])['then'](async()=>{const _0x74809f=_0x2e08d1;if(_0x322bdb==_0x74809f(0x1d0)){if(settings[_0x74809f(0x1c6)]==_0x74809f(0xfd))tgBot[_0x74809f(0x10e)](_0x1d6396[_0x74809f(0x1e8)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')[_0x74809f(0x170)](_0x33f755=>{telegramError(_0x33f755);});config['forEach'](_0x5ba03d=>{const _0x275d54=_0x74809f;stopBot(_0x5ba03d[_0x275d54(0x1e7)]);});}else{if(settings[_0x74809f(0x1c6)]==_0x74809f(0xfd))tgBot['sendMessage'](_0x1d6396['chat']['id'],_0x74809f(0x177)+_0x322bdb)['catch'](_0x59b530=>{telegramError(_0x59b530);});stopBot(_0x322bdb);}}),tgBot[_0x2e08d1(0x15e)]('callback_query');});}}),tgBot[_0x3a0d04(0x1d5)](/\/on/,_0x511830=>{const _0x259129=_0x3a0d04;if(!validateTelegram(_0x511830))return;tgBot[_0x259129(0x15e)](_0x259129(0x11d));const _0x5c95af=getDisabledBots();if(_0x5c95af[_0x259129(0xf0)]==0x0)tgBot[_0x259129(0x10e)](_0x511830['chat']['id'],_0x259129(0xf2))['catch'](_0x6fc39=>{telegramError(_0x6fc39);});else{if(_0x5c95af['length']>0x1)_0x5c95af[_0x259129(0xf6)]({'botID':'all'});let _0x349b9e=[],_0x3f725e=[];const _0x2e6f77=_0x5c95af['length']%0x4==0x0||_0x5c95af[_0x259129(0xf0)]%0x4==0x3||_0x5c95af[_0x259129(0xf0)]%0x3==0x1?0x4:0x3;let _0x23f2c2=0x0;_0x5c95af[_0x259129(0x1f8)]((_0x4b6e47,_0x454132)=>{const _0x4f7f82=_0x259129;if(_0x454132%_0x2e6f77==0x0)_0x3f725e=[];_0x3f725e[_0x4f7f82(0xf6)]({'text':_0x4b6e47[_0x4f7f82(0x1e7)]=='all'?'All\x20bots':_0x4f7f82(0x106)+_0x4b6e47[_0x4f7f82(0x1e7)],'callback_data':_0x4b6e47[_0x4f7f82(0x1e7)]}),_0x454132%_0x2e6f77==0x0&&(_0x349b9e[_0x23f2c2]=_0x3f725e,_0x23f2c2++);}),tgBot[_0x259129(0x10e)](_0x511830[_0x259129(0x1e8)]['id'],_0x259129(0x19c),{'reply_markup':{'inline_keyboard':_0x349b9e}})[_0x259129(0x170)](_0x3d2d4e=>{telegramError(_0x3d2d4e);}),tgBot['on'](_0x259129(0x11d),async _0x1a833e=>{const _0x1f9666=_0x259129,_0x51ab57=_0x1a833e['data'],_0xa8ca68=_0x1a833e[_0x1f9666(0x123)];tgBot[_0x1f9666(0xeb)](_0x1a833e['id'])[_0x1f9666(0x128)](async()=>{const _0x319f25=_0x1f9666;if(_0x51ab57==_0x319f25(0x1d0)){if(settings['telegramEvents']==_0x319f25(0xfd))tgBot[_0x319f25(0x10e)](_0xa8ca68[_0x319f25(0x1e8)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x319f25(0x170)](_0x1a580e=>{telegramError(_0x1a580e);});_0x5c95af[_0x319f25(0x1f8)](_0x53e4da=>{const _0x5f409f=_0x319f25;if(_0x53e4da[_0x5f409f(0x1e7)]!=_0x5f409f(0x1d0))toggleBot(_0x53e4da['botID'],toggleStatus(_0x53e4da['botID']),_0x5f409f(0x184));});}else{if(settings['telegramEvents']==_0x319f25(0xfd))tgBot[_0x319f25(0x10e)](_0xa8ca68[_0x319f25(0x1e8)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x51ab57)[_0x319f25(0x170)](_0x4eccd1=>{telegramError(_0x4eccd1);});toggleBot(_0x51ab57,toggleStatus(_0x51ab57),_0x319f25(0x184));}}),tgBot['removeListener'](_0x1f9666(0x11d));});}}),tgBot[_0x3a0d04(0x1d5)](/\/off/,_0x234594=>{const _0x4d53a1=_0x3a0d04;if(!validateTelegram(_0x234594))return;tgBot['removeListener']('callback_query');const _0x35aeae=getEnabledBots();if(_0x35aeae[_0x4d53a1(0xf0)]==0x0)tgBot[_0x4d53a1(0x10e)](_0x234594['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x4e07d7=>{telegramError(_0x4e07d7);});else{if(_0x35aeae[_0x4d53a1(0xf0)]>0x1)_0x35aeae[_0x4d53a1(0xf6)]({'botID':'all'});let _0xfd63ce=[],_0x784df5=[];const _0x19e53a=_0x35aeae[_0x4d53a1(0xf0)]%0x4==0x0||_0x35aeae[_0x4d53a1(0xf0)]%0x4==0x3||_0x35aeae[_0x4d53a1(0xf0)]%0x3==0x1?0x4:0x3;let _0x584cce=0x0;_0x35aeae[_0x4d53a1(0x1f8)]((_0x3849b3,_0xf116ce)=>{const _0x6ae312=_0x4d53a1;if(_0xf116ce%_0x19e53a==0x0)_0x784df5=[];_0x784df5['push']({'text':_0x3849b3[_0x6ae312(0x1e7)]==_0x6ae312(0x1d0)?_0x6ae312(0x196):_0x6ae312(0x106)+_0x3849b3[_0x6ae312(0x1e7)],'callback_data':_0x3849b3[_0x6ae312(0x1e7)]}),_0xf116ce%_0x19e53a==0x0&&(_0xfd63ce[_0x584cce]=_0x784df5,_0x584cce++);}),tgBot[_0x4d53a1(0x10e)](_0x234594['chat']['id'],_0x4d53a1(0x20e),{'reply_markup':{'inline_keyboard':_0xfd63ce}})['catch'](_0x39fb2e=>{telegramError(_0x39fb2e);}),tgBot['on'](_0x4d53a1(0x11d),async _0x411895=>{const _0x56da7a=_0x4d53a1,_0x4b1095=_0x411895[_0x56da7a(0x1a9)],_0x4b0908=_0x411895[_0x56da7a(0x123)];tgBot[_0x56da7a(0xeb)](_0x411895['id'])[_0x56da7a(0x128)](async()=>{const _0x3f39b9=_0x56da7a;if(_0x4b1095==_0x3f39b9(0x1d0)){if(settings[_0x3f39b9(0x1c6)]==_0x3f39b9(0xfd))tgBot[_0x3f39b9(0x10e)](_0x4b0908[_0x3f39b9(0x1e8)]['id'],_0x3f39b9(0x188))[_0x3f39b9(0x170)](_0x297435=>{telegramError(_0x297435);});_0x35aeae[_0x3f39b9(0x1f8)](_0x5f2f86=>{const _0x18bf5f=_0x3f39b9;if(_0x5f2f86[_0x18bf5f(0x1e7)]!=_0x18bf5f(0x1d0))toggleBot(_0x5f2f86[_0x18bf5f(0x1e7)],toggleStatus(_0x5f2f86['botID']),_0x18bf5f(0x184));});}else{if(settings[_0x3f39b9(0x1c6)]==_0x3f39b9(0xfd))tgBot[_0x3f39b9(0x10e)](_0x4b0908[_0x3f39b9(0x1e8)]['id'],_0x3f39b9(0x1c5)+_0x4b1095)[_0x3f39b9(0x170)](_0x5c0907=>{telegramError(_0x5c0907);});toggleBot(_0x4b1095,toggleStatus(_0x4b1095),_0x3f39b9(0x184));}}),tgBot['removeListener'](_0x56da7a(0x11d));});}}),tgBot[_0x3a0d04(0x1d5)](/\/disable/,_0x214aba=>{const _0x2210f4=_0x3a0d04;if(!validateTelegram(_0x214aba))return;tgBot[_0x2210f4(0x10e)](_0x214aba[_0x2210f4(0x1e8)]['id'],_0x2210f4(0x16c))[_0x2210f4(0x170)](_0x4ac114=>{telegramError(_0x4ac114);}),updateSetting(_0x2210f4(0x1a6),![]);}),tgBot[_0x3a0d04(0x1d5)](/\/help/,_0x7e7699=>{const _0x1ef324=_0x3a0d04;if(!validateTelegram(_0x7e7699))return;tgBot[_0x1ef324(0x10e)](_0x7e7699[_0x1ef324(0x1e8)]['id'],_0x193319)[_0x1ef324(0x170)](_0xcceeb0=>{telegramError(_0xcceeb0);});}),tgBot['on'](_0x3a0d04(0x21d),_0x5e9f6b=>{const _0x5670cc=_0x3a0d04;_0x5e9f6b[_0x5670cc(0xf8)]()[_0x5670cc(0x125)](_0x5670cc(0xe4))&&(logging(_0x5670cc(0x164)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x5670cc(0x17a))[_0x5670cc(0x1c4)](_0x5670cc(0x14f),_0x5670cc(0x164)));}),process[_0x3a0d04(0x1b2)](_0x3a0d04(0x206),()=>{const _0x53a145=_0x3a0d04;if(tgBot)tgBot[_0x53a145(0x1bd)]();process['exit'](0x1);}),process[_0x3a0d04(0x1b2)](_0x3a0d04(0x121),()=>{const _0x11b3a4=_0x3a0d04;if(tgBot)tgBot[_0x11b3a4(0x1bd)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1f890a,_0x1c379f){const _0x227d98=_0x15ffe5;if(settings[_0x227d98(0x1a6)]){if(settings[_0x227d98(0x1c6)]=='all'||(_0x1c379f['type']==_0x227d98(0x179)||_0x1c379f['type']=='success')&&settings[_0x227d98(0x1c6)]==_0x227d98(0x1eb)||_0x1c379f['type']==_0x227d98(0x1ae)&&settings['telegramEvents']==_0x227d98(0xfd)){if(tgBot&&settings['telegramChatId']){if(_0x1c379f['showname'])tgBot[_0x227d98(0x10e)](settings['telegramChatId'],_0x1c379f[_0x227d98(0x11b)]+_0x227d98(0x193)+_0x1c379f[_0x227d98(0x129)])[_0x227d98(0x170)](_0x1f527c=>{telegramError(_0x1f527c);});else tgBot['sendMessage'](settings[_0x227d98(0x211)],_0x227d98(0x106)+_0x1f890a+_0x227d98(0x193)+_0x1c379f['event'])[_0x227d98(0x170)](_0x3e15ba=>{telegramError(_0x3e15ba);});}}}}function getDeviceWithIp(_0x477841){const _0x1a9856=_0x15ffe5;return devices[_0x1a9856(0x1ea)](_0x27009a=>_0x27009a['ip']===_0x477841);}function temporaryAccess2FA(_0x297f14,_0x171ae0){const _0x51b6e0=_0x15ffe5;let _0x4593a4=new Date(),_0x49f61c=![];if(lastIpApproval){if(_0x4593a4-lastIpApproval<0x1388)_0x49f61c=!![];}lastIpApproval=new Date();if(_0x49f61c)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x51b6e0(0x11d)),tgBot[_0x51b6e0(0x10e)](settings[_0x51b6e0(0x211)],_0x51b6e0(0xe6)+normalizeIP(_0x171ae0)[_0x51b6e0(0x12f)]+_0x51b6e0(0x1f6),{'parse_mode':_0x51b6e0(0x220),'reply_markup':{'inline_keyboard':[[{'text':_0x51b6e0(0x159),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x51b6e0(0x1e1),'callback_data':'30'},{'text':_0x51b6e0(0x17f),'callback_data':_0x51b6e0(0x17f)}]]}})[_0x51b6e0(0x170)](_0x2a59b3=>{telegramError(_0x2a59b3);}),tgBot['on'](_0x51b6e0(0x11d),async _0x176b0e=>{const _0x32a03a=_0x51b6e0,_0x20eeb2=_0x176b0e[_0x32a03a(0x1a9)],_0xddaf31=_0x176b0e['message'];tgBot[_0x32a03a(0xeb)](_0x176b0e['id'])[_0x32a03a(0x128)](async()=>{const _0x43b418=_0x32a03a;devices[_0x297f14][_0x43b418(0x150)]={'clientip':_0x171ae0,'timestamp':new Date()['getTime'](),'expiry':_0x20eeb2},_0x20eeb2!='reject'?(await tgBot['sendMessage'](_0xddaf31['chat']['id'],_0x43b418(0x20a)+_0x20eeb2+_0x43b418(0x1ad),{'parse_mode':'HTML'})[_0x43b418(0x170)](_0x5e887b=>{telegramError(_0x5e887b);}),io['to'](_0x297f14)[_0x43b418(0x1c4)](_0x43b418(0x1b3),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x43b418(0x10e)](_0xddaf31[_0x43b418(0x1e8)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x10d074=>{telegramError(_0x10d074);}),io['to'](_0x297f14)[_0x43b418(0x1c4)](_0x43b418(0x1b3),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x32a03a(0x15e)](_0x32a03a(0x11d));}));}function loginAccess2FA(_0x52cb9a,_0x58bf90){const _0x390b72=_0x15ffe5;tgBot&&settings[_0x390b72(0x211)]&&(tgBot[_0x390b72(0x15e)]('callback_query'),tgBot[_0x390b72(0x10e)](settings[_0x390b72(0x211)],_0x390b72(0x12a)+normalizeIP(_0x58bf90)[_0x390b72(0x12f)]+_0x390b72(0x1f6),{'parse_mode':_0x390b72(0x220),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x390b72(0x17f),'callback_data':_0x390b72(0x17f)}]]}})[_0x390b72(0x170)](_0x429348=>{telegramError(_0x429348);}),tgBot['on'](_0x390b72(0x11d),async _0xa789a9=>{const _0x7e15=_0x390b72,_0x3a418f=_0xa789a9[_0x7e15(0x1a9)],_0x54daf9=_0xa789a9[_0x7e15(0x123)];tgBot['answerCallbackQuery'](_0xa789a9['id'])[_0x7e15(0x128)](async()=>{const _0x3c945f=_0x7e15;devices[_0x52cb9a][_0x3c945f(0xe8)]={'clientip':_0x58bf90,'timestamp':new Date()['getTime'](),'expiry':_0x3a418f},_0x3a418f!=_0x3c945f(0x17f)?(await tgBot[_0x3c945f(0x10e)](_0x54daf9[_0x3c945f(0x1e8)]['id'],'Login\x20accepted',{'parse_mode':_0x3c945f(0x220)})[_0x3c945f(0x170)](_0xb2dd73=>{telegramError(_0xb2dd73);}),io['to'](_0x52cb9a)[_0x3c945f(0x1c4)]('status',{'access':{'allow':![],'reason':_0x3c945f(0x1dd),'token':null}})):(await tgBot['sendMessage'](_0x54daf9['chat']['id'],_0x3c945f(0x1f4))[_0x3c945f(0x170)](_0x16b085=>{telegramError(_0x16b085);}),io['to'](_0x52cb9a)[_0x3c945f(0x1c4)](_0x3c945f(0x1b3),{'access':{'allow':![],'reason':_0x3c945f(0x202),'token':null}}));}),tgBot[_0x7e15(0x15e)]('callback_query');}));}function getConfiguration(){const _0x1339ef=_0x15ffe5;return dbConfig['get'](_0x1339ef(0x1e9))['sortBy']('botID')[_0x1339ef(0x1c2)]()||[];}function getEnabledBots(){const _0x1edd9f=_0x15ffe5;return dbConfig[_0x1edd9f(0x17c)](_0x1edd9f(0x1e9))['sortBy']('botID')[_0x1edd9f(0x16b)]({'status':_0x1edd9f(0xfc)})[_0x1edd9f(0x1c2)]()||[];}function getDisabledBots(){const _0x4e4c7b=_0x15ffe5;return dbConfig[_0x4e4c7b(0x17c)](_0x4e4c7b(0x1e9))[_0x4e4c7b(0x1f7)]('botID')[_0x4e4c7b(0x16b)]({'status':_0x4e4c7b(0x12c)})[_0x4e4c7b(0x1c2)]()||[];}function getSettings(){const _0x2f00e1=_0x15ffe5;return dbSettings[_0x2f00e1(0x17c)](_0x2f00e1(0x108))[_0x2f00e1(0x1c2)]()||{'timeshift':0x0};}function getSecure(){const _0xc0e1ef=_0x15ffe5;return dbSecure[_0xc0e1ef(0x17c)]('secure')[_0xc0e1ef(0x1c2)]()||{};}function getBlacklist(){const _0x1d236c=_0x15ffe5;return dbSecure[_0x1d236c(0x17c)](_0x1d236c(0x20b))[_0x1d236c(0x1c2)]()||[];}function broadcastToBots(_0x1b30db,_0x374f10){const _0x136017=_0x15ffe5;config[_0x136017(0x1f8)](_0x22aeae=>{const _0x1c97d0=_0x136017;if(_0x22aeae[_0x1c97d0(0x1b3)]==_0x1c97d0(0xfc)&&_0x22aeae[_0x1c97d0(0x20c)]==_0x1c97d0(0x14e)){if(pid[_0x22aeae[_0x1c97d0(0x1e7)]])pid[_0x22aeae[_0x1c97d0(0x1e7)]]['send']({[_0x1b30db]:_0x374f10});}});}function storeSettings(_0x3ca1d7,_0x190ccb=![]){const _0x5660eb=_0x15ffe5;_0x3ca1d7={...settings,..._0x3ca1d7};if(_0x190ccb&&_0x3ca1d7[_0x5660eb(0xf5)]!='************'&&_0x3ca1d7['bbPassword']!=''){const _0xc322b2=crypt[_0x5660eb(0x197)](secure['privateKey'],_0x3ca1d7[_0x5660eb(0xf5)])[_0x5660eb(0x123)][_0x5660eb(0x185)]('@')[0x0],_0x180872=bcrypt[_0x5660eb(0x104)](_0xc322b2,saltRounds);_0x3ca1d7={..._0x3ca1d7,'bbPassword':_0x180872};}if(_0x190ccb&&_0x3ca1d7[_0x5660eb(0x120)]!=_0x5660eb(0x21a)&&_0x3ca1d7[_0x5660eb(0x120)]!=''){const _0x2b10b6=crypt['decrypt'](secure[_0x5660eb(0x105)],_0x3ca1d7[_0x5660eb(0x120)])[_0x5660eb(0x123)][_0x5660eb(0x185)]('@')[0x0];_0x3ca1d7={..._0x3ca1d7,'telegramToken':_0x2b10b6};}const _0x3433ef=_0x3ca1d7[_0x5660eb(0x120)]!='************'&&_0x3ca1d7[_0x5660eb(0x120)]!=settings['telegramToken']||_0x3ca1d7[_0x5660eb(0x112)]!=settings[_0x5660eb(0x112)],_0x1e8c78=_0x3ca1d7[_0x5660eb(0x120)]==''||_0x3ca1d7[_0x5660eb(0x112)]=='';if(_0x3433ef)_0x3ca1d7['telegramEvents']='all';for(const [_0x57fb43,_0x3f63e3]of Object[_0x5660eb(0x1a1)](_0x3ca1d7)){if(_0x57fb43==_0x5660eb(0x120)&&_0x3f63e3==_0x5660eb(0x21a)){_0x3ca1d7[_0x5660eb(0x120)]=settings[_0x5660eb(0x120)];continue;};if(_0x57fb43=='bbPassword'&&_0x3f63e3==_0x5660eb(0x21a)){_0x3ca1d7[_0x5660eb(0xf5)]=settings[_0x5660eb(0xf5)];continue;};dbSettings['set'](_0x5660eb(0x171)+_0x57fb43,_0x3f63e3)[_0x5660eb(0x109)]();}settings=_0x3ca1d7,io['to']('botmanager')[_0x5660eb(0x1c4)]('settings',cleanSettings()),broadcastToBots(_0x5660eb(0x14a),settings[_0x5660eb(0x14a)]);if(_0x3433ef&&!_0x1e8c78)initTelegram();if(_0x3433ef&&_0x1e8c78)disableTelegram();getAllClients()[_0x5660eb(0x1f8)](_0x1f77a5=>{const _0x3fe95f=_0x5660eb;getSocket(_0x1f77a5['id'])[_0x3fe95f(0x1c4)](_0x3fe95f(0x1b3),{'access':{'allow':![],'reason':_0x3fe95f(0x1dd),'token':null}});});}function updateSetting(_0x269fd3,_0x139858){const _0x2d1af6=_0x15ffe5;dbSettings[_0x2d1af6(0x162)]('settings.'+_0x269fd3,_0x139858)[_0x2d1af6(0x109)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x2d1af6(0x108),cleanSettings());}function storeSecure(_0x214d6b){const _0x3fc084=_0x15ffe5;dbSecure[_0x3fc084(0x17c)](_0x3fc084(0x157))['push'](_0x214d6b)[_0x3fc084(0x109)](),secure=_0x214d6b;}function addBlacklist(_0xa8d1f4){const _0x324f40=_0x15ffe5;cleanBlacklist();let _0x53b474;devices[_0xa8d1f4][_0x324f40(0x150)]?_0x53b474=Math[_0x324f40(0x192)](devices[_0xa8d1f4][_0x324f40(0x150)]['expiry'],loginExpiry):_0x53b474=loginExpiry,dbSecure[_0x324f40(0x17c)](_0x324f40(0x20b))[_0x324f40(0xf6)]({'expiry':new Date()['getTime']()+_0x53b474*0x3c*0x3e8,'token':devices[_0xa8d1f4][_0x324f40(0x1f2)][_0x324f40(0x1b9)]})[_0x324f40(0x109)](),blacklist=dbSecure[_0x324f40(0x17c)](_0x324f40(0x20b))[_0x324f40(0x1c2)]();}function cleanBlacklist(){const _0x133d98=_0x15ffe5;let _0x306e38=dbSecure['get'](_0x133d98(0x20b))[_0x133d98(0x1ca)]()[_0x133d98(0x1c2)](),_0x3f059d=new Date()[_0x133d98(0x141)]();_0x306e38[_0x133d98(0x1f8)](_0x1e91bc=>{const _0x5c80ae=_0x133d98;_0x1e91bc[_0x5c80ae(0x1f3)]<_0x3f059d&&dbSecure[_0x5c80ae(0x17c)]('blacklist')[_0x5c80ae(0x217)]({'expiry':_0x1e91bc[_0x5c80ae(0x1f3)]})['write']();});}function initStates(){const _0x15f6f2=_0x15ffe5;let _0x3dee3d=getConfiguration();_0x3dee3d[_0x15f6f2(0x1f8)](_0x27c54d=>{const _0x483610=_0x15f6f2;_0x27c54d[_0x483610(0x20c)]=_0x483610(0x184);}),storeConfiguration(_0x3dee3d);}function onKeys(){const _0x5caa5a=new RSA();return new Promise(_0xf90878=>{_0x5caa5a['generateKeyPairAsync']()['then'](_0x31783d=>{_0xf90878(_0x31783d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x37bf4b=_0x15ffe5;let _0x3fe8e1=getConfiguration(),_0x343be5=![];_0x3fe8e1[_0x37bf4b(0x1f8)](_0x16de35=>{const _0x2731e6=_0x37bf4b;if(_0x16de35[_0x2731e6(0x1b3)]=='running')_0x16de35[_0x2731e6(0x1b3)]=_0x2731e6(0xfc),_0x343be5=!![];else _0x16de35[_0x2731e6(0x1b3)]==_0x2731e6(0x184)&&(_0x16de35[_0x2731e6(0x1b3)]=_0x2731e6(0x12c),_0x343be5=!![]);});if(_0x343be5)storeConfiguration(_0x3fe8e1);let _0x5bc2f6=getSecure();if(!_0x5bc2f6[_0x37bf4b(0x213)](_0x37bf4b(0x134))){let _0x1d3b1=await generateKeys();_0x5bc2f6[_0x37bf4b(0x166)]=_0x1d3b1[_0x37bf4b(0x166)],_0x5bc2f6['privateKey']=_0x1d3b1[_0x37bf4b(0x105)],_0x5bc2f6[_0x37bf4b(0x134)]=crypto[_0x37bf4b(0x18d)](0x20)[_0x37bf4b(0xf8)](_0x37bf4b(0x21e));;storeSecure(_0x5bc2f6);}let _0x5dd5d2=getSettings();_0x343be5=![];!_0x5dd5d2['hasOwnProperty']('loginRequired')&&(_0x5dd5d2[_0x37bf4b(0x13e)]=![],_0x5dd5d2[_0x37bf4b(0x1a3)]='',_0x5dd5d2[_0x37bf4b(0xf5)]='',_0x5dd5d2[_0x37bf4b(0x160)]=![],_0x343be5=!![]);!_0x5dd5d2[_0x37bf4b(0x213)](_0x37bf4b(0x13d))&&(_0x5dd5d2[_0x37bf4b(0x13d)]=![],_0x5dd5d2['whitelist']=[],_0x5dd5d2['temporaryAccessAllowed']=![],_0x343be5=!![]);if(!_0x5dd5d2['hasOwnProperty'](_0x37bf4b(0x1a6))){if(_0x5dd5d2[_0x37bf4b(0x211)])_0x5dd5d2['telegramEnabled']=!![];else _0x5dd5d2[_0x37bf4b(0x1a6)]=![];_0x343be5=!![];}if(_0x343be5)storeSettings(_0x5dd5d2);}function storeConfiguration(_0x14e446){const _0x137226=_0x15ffe5;dbConfig['get'](_0x137226(0x1e9))[_0x137226(0x217)]()['write'](),dbConfig[_0x137226(0x17c)](_0x137226(0x1e9))['push'](..._0x14e446)[_0x137226(0x109)](),config=_0x14e446;}function resetPassword(){const _0x1f2541=_0x15ffe5;tgBot&&settings[_0x1f2541(0x211)]&&(tgBot[_0x1f2541(0x15e)](_0x1f2541(0x11d)),tgBot['sendMessage'](settings[_0x1f2541(0x211)],_0x1f2541(0x1fd),{'parse_mode':_0x1f2541(0x220),'reply_markup':{'inline_keyboard':[[{'text':_0x1f2541(0x1ba),'callback_data':_0x1f2541(0x1ba)},{'text':'no','callback_data':'no'}]]}})[_0x1f2541(0x170)](_0x2ba084=>{telegramError(_0x2ba084);}),tgBot['on'](_0x1f2541(0x11d),async _0x4664ca=>{const _0x3579f4=_0x1f2541,_0x544cc8=_0x4664ca['data'],_0xb9c54a=_0x4664ca[_0x3579f4(0x123)];tgBot[_0x3579f4(0xeb)](_0x4664ca['id'])[_0x3579f4(0x128)](async()=>{const _0x7bc21c=_0x3579f4;if(_0x544cc8!='no'){const _0x544b4c=0xf,_0x5e0027='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x185363=Array['from'](crypto[_0x7bc21c(0x186)](new Uint32Array(_0x544b4c)))[_0x7bc21c(0x133)](_0x39f639=>_0x5e0027[_0x39f639%_0x5e0027[_0x7bc21c(0xf0)]])[_0x7bc21c(0x191)](''),_0x376f54=bcrypt['hashSync'](_0x185363,saltRounds);storeSettings({'bbPassword':_0x376f54}),await tgBot[_0x7bc21c(0x10e)](_0xb9c54a[_0x7bc21c(0x1e8)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x185363,{'parse_mode':'HTML'})[_0x7bc21c(0x170)](_0x1de895=>{telegramError(_0x1de895);});}else await tgBot[_0x7bc21c(0x10e)](_0xb9c54a[_0x7bc21c(0x1e8)]['id'],_0x7bc21c(0x143))[_0x7bc21c(0x170)](_0x4ca76b=>{telegramError(_0x4ca76b);});}),tgBot['removeListener'](_0x3579f4(0x11d));}));}function logging(_0x3f7a0d){const _0x406e01=_0x15ffe5;console[_0x406e01(0x152)](getTimeStamp()+_0x406e01(0x1a5)+_0x3f7a0d);if(tgBot&&settings[_0x406e01(0x211)]&&settings[_0x406e01(0x1c6)]!=_0x406e01(0xfd))tgBot[_0x406e01(0x10e)](settings[_0x406e01(0x211)],'Bot\x20Mgr\x20>\x20'+_0x3f7a0d)[_0x406e01(0x170)](_0x4bea92=>{telegramError(_0x4bea92);});}function getServerTime(){const _0x28927c=_0x15ffe5,_0x55a339=new Date();return _0x55a339[_0x28927c(0xfa)]()+'/'+(_0x55a339[_0x28927c(0x14b)]()+0x1)[_0x28927c(0xf8)]()[_0x28927c(0xee)](0x2,'0')+'/'+_0x55a339['getDate']()[_0x28927c(0xf8)]()[_0x28927c(0xee)](0x2,'0')+'\x20'+_0x55a339[_0x28927c(0x198)]()[_0x28927c(0xf8)]()['padStart'](0x2,'0')+':'+_0x55a339['getMinutes']()[_0x28927c(0xf8)]()[_0x28927c(0xee)](0x2,'0')+':'+_0x55a339['getSeconds']()[_0x28927c(0xf8)]()[_0x28927c(0xee)](0x2,'0');}function getTimeStamp(){const _0x3f23c6=_0x15ffe5,_0x8e0b43=shiftedTime();return _0x8e0b43[_0x3f23c6(0xfa)]()+'/'+(_0x8e0b43[_0x3f23c6(0x14b)]()+0x1)[_0x3f23c6(0xf8)]()[_0x3f23c6(0xee)](0x2,'0')+'/'+_0x8e0b43[_0x3f23c6(0x18c)]()[_0x3f23c6(0xf8)]()[_0x3f23c6(0xee)](0x2,'0')+'\x20'+_0x8e0b43[_0x3f23c6(0x198)]()[_0x3f23c6(0xf8)]()['padStart'](0x2,'0')+':'+_0x8e0b43[_0x3f23c6(0x1c8)]()[_0x3f23c6(0xf8)]()['padStart'](0x2,'0')+':'+_0x8e0b43[_0x3f23c6(0x199)]()[_0x3f23c6(0xf8)]()[_0x3f23c6(0xee)](0x2,'0');}function shiftedTime(){const _0x1f71ed=_0x15ffe5,_0x3006c3=new Date();let _0x5c7030=_0x3006c3;if(settings[_0x1f71ed(0x14a)]&&settings[_0x1f71ed(0x14a)]!==0x0)_0x5c7030=fns['add'](_0x3006c3,{'hours':settings[_0x1f71ed(0x14a)]});return _0x5c7030;}function startScheduler(){const _0x302232=_0x15ffe5;let _0x1dc328=new Date()[_0x302232(0x1f1)]();_0x1dc328==0x1&&backupConfigFiles();_0x1dc328==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x11d063=_0x15ffe5;fs[_0x11d063(0xf1)](configpath,{'withFileTypes':!![]})['forEach'](_0x477793=>{const _0x2b41f7=_0x11d063;if(!_0x477793[_0x2b41f7(0xf4)]())fs['copyFileSync'](configpath+_0x477793[_0x2b41f7(0x189)],configbackuppath+_0x477793[_0x2b41f7(0x189)]);});}function triggerAnalytics(){const _0x1c7976=_0x15ffe5;analytics[_0x1c7976(0x1e3)]({'title':_0x1c7976(0x16e),'href':_0x1c7976(0x114),'path':'/v'+serverversion});}function validateCredentials(_0x1b15ae,_0x369072){const _0x1a346e=_0x15ffe5;if(_0x1b15ae[_0x1a346e(0x18a)]==settings['bbUsername']&&bcrypt[_0x1a346e(0x172)](_0x1b15ae[_0x1a346e(0x21c)],settings['bbPassword'])){if(settings[_0x1a346e(0x160)])return{'allow':![],'reason':_0x1a346e(0x16a),'token':null};else{const _0x2e48de=generateLoginToken(_0x369072);return{'allow':!![],'reason':_0x1a346e(0x205),'token':_0x2e48de};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x586b92){const _0x78525c=_0x15ffe5,_0x1038b5=generateLoginToken(_0x586b92);return{'allow':!![],'reason':_0x78525c(0x205),'token':_0x1038b5};}function validateAccess(_0x2e64c2,_0x22ddc1){const _0x13a01b=_0x15ffe5;let _0x2790dc=devices[_0x22ddc1]['ip'],_0x103b57;const _0x307007=_0x4173a6=>{const _0x554b35=_0x2963;if(settings[_0x554b35(0x13e)]){if(settings[_0x554b35(0x160)]){if(telegram2FaApproved(_0x22ddc1)){const _0x2b10df=generateLoginToken(_0x22ddc1);return{'allow':!![],'reason':_0x554b35(0x1a4),'token':_0x2b10df};}else return{'allow':![],'reason':_0x554b35(0x212),'token':null};}else return _0x103b57=validToken(_0x4173a6,_0x22ddc1),_0x103b57[_0x554b35(0x213)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4173a6}:{'allow':![],'reason':_0x554b35(0x212),'token':null};}else return{'allow':!![],'reason':_0x554b35(0x178),'token':null};};if(settings[_0x13a01b(0x13d)]){let _0x1f544a=[...settings['whitelist'],_0x13a01b(0x218),_0x13a01b(0x17e),'127.0.0.1'];if(_0x1f544a[_0x13a01b(0x125)](_0x2790dc))return _0x307007(_0x2e64c2);else{_0x103b57=validToken(_0x2e64c2,_0x22ddc1);if(_0x103b57[_0x13a01b(0x213)](_0x13a01b(0xed)))return _0x307007(_0x2e64c2);else{if(telegramIpApproved(_0x22ddc1)){const _0x4e2f91=generateToken(_0x22ddc1);return _0x103b57=_0x307007(_0x2e64c2),_0x103b57[_0x13a01b(0x1fb)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x4e2f91}:_0x103b57;}else return settings[_0x13a01b(0x221)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x13a01b(0x12b),'token':null};}}}else return _0x307007(_0x2e64c2);}function timelyDecrypt(_0x964b8d,_0xd56ff5=!![]){const _0x3d91d0=_0x15ffe5;if(_0x964b8d)try{const _0x1f6820=crypt[_0x3d91d0(0x197)](secure[_0x3d91d0(0x105)],_0x964b8d)[_0x3d91d0(0x123)],_0x2799a5=_0x1f6820[_0x3d91d0(0x185)]('@')[0x0],_0x33f306=_0x1f6820[_0x3d91d0(0x185)]('@')[0x1],_0x15d199=new Date()[_0x3d91d0(0x141)]();if(_0xd56ff5){if(_0x15d199-_0x33f306<maxSecretAge*0x3e8)return _0x2799a5;else return![];}else return _0x2799a5;}catch(_0x4209a2){return![];}else return![];}const validToken=(_0x4c97e4,_0x1e88f9)=>{const _0x3c070d=_0x15ffe5,_0x51d113=devices[_0x1e88f9]['ip'];if(!_0x4c97e4)return{'error':_0x3c070d(0x117)};for(let _0x288bda of blacklist){if(_0x288bda[_0x3c070d(0x1b9)]==_0x4c97e4)return{'error':_0x3c070d(0x1d8)};}let _0x267fe8;try{_0x267fe8=jwt[_0x3c070d(0x18b)](_0x4c97e4,secure['secret']+_0x1e88f9);}catch{return{'error':_0x3c070d(0x12e)};}if(!_0x267fe8[_0x3c070d(0x213)](_0x3c070d(0x1c1))&&!_0x267fe8[_0x3c070d(0x213)](_0x3c070d(0x18a))||!_0x267fe8['hasOwnProperty'](_0x3c070d(0x1e0)))return{'error':_0x3c070d(0x1b1)};if(!_0x267fe8['hasOwnProperty'](_0x3c070d(0x18a))&&_0x267fe8[_0x3c070d(0x213)](_0x3c070d(0x1c1))){const {clientip:_0x58fb83}=_0x267fe8;return _0x51d113==_0x58fb83?{'success':_0x3c070d(0x1ec)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x267fe8['hasOwnProperty'](_0x3c070d(0x18a))&&_0x267fe8['hasOwnProperty'](_0x3c070d(0x1c1))){const {username:_0x5b3ca5,clientip:_0x42b8fc}=_0x267fe8;return settings[_0x3c070d(0x1a3)]==_0x5b3ca5&&_0x51d113==_0x42b8fc?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x4eb127=>{const _0x4003d5=_0x15ffe5;if(_0x4eb127){const _0xc9cf7b=devices[_0x4eb127]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0xc9cf7b},secure[_0x4003d5(0x134)]+_0x4eb127,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1091ed=>{const _0x469b19=_0x15ffe5;if(_0x1091ed){const _0x1b55b3=devices[_0x1091ed]['ip'];return jwt[_0x469b19(0x21b)]({'clientip':_0x1b55b3},secure['secret']+_0x1091ed,{'expiresIn':devices[_0x1091ed][_0x469b19(0x150)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x36959f=>{const _0x5319cb=_0x15ffe5;let _0x4ac1c6=![];return devices[_0x36959f][_0x5319cb(0x150)]&&devices[_0x36959f][_0x5319cb(0x150)]['expiry']!='reject'&&(_0x4ac1c6=devices[_0x36959f]['telegramIpApproval'][_0x5319cb(0x1c1)]==devices[_0x36959f]['ip']&&new Date()['getTime']()-devices[_0x36959f][_0x5319cb(0x150)]['timestamp']<devices[_0x36959f][_0x5319cb(0x150)][_0x5319cb(0x1f3)]*0x3c*0x3e8),_0x4ac1c6;},telegram2FaApproved=_0x934c87=>{const _0x13bebe=_0x15ffe5;let _0x35d392=![];return devices[_0x934c87][_0x13bebe(0xe8)]&&devices[_0x934c87][_0x13bebe(0xe8)]['expiry']!=_0x13bebe(0x17f)&&(_0x35d392=devices[_0x934c87][_0x13bebe(0xe8)][_0x13bebe(0x1c1)]==devices[_0x934c87]['ip']&&new Date()[_0x13bebe(0x141)]()-devices[_0x934c87][_0x13bebe(0xe8)][_0x13bebe(0x16d)]<devices[_0x934c87][_0x13bebe(0xe8)][_0x13bebe(0x1f3)]*0x3c*0x3e8),_0x35d392;},normalizeIP=_0x10699d=>{const _0x4f76b=_0x15ffe5;let _0x3e9647=null,_0x2d10ed=null;if(ipaddr[_0x4f76b(0xdb)](_0x10699d)){const _0x4db0a5=ipaddr[_0x4f76b(0x18f)](_0x10699d);_0x4db0a5[_0x4f76b(0x15f)]()==='ipv6'?(_0x4db0a5[_0x4f76b(0x138)]()&&(_0x3e9647=_0x4db0a5[_0x4f76b(0x1d4)]()['toString']()),_0x2d10ed=_0x4db0a5[_0x4f76b(0xf8)]()):(_0x3e9647=_0x4db0a5[_0x4f76b(0xf8)](),_0x2d10ed=_0x4db0a5['toIPv4MappedAddress']()[_0x4f76b(0xf8)]());}return{'show':_0x3e9647?_0x3e9647:_0x2d10ed,'store':_0x2d10ed};};