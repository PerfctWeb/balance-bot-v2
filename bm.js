const _0x386a01=_0x2786;(function(_0x398565,_0x499c75){const _0x54925c=_0x2786,_0x3b18b2=_0x398565();while(!![]){try{const _0x18fd0e=parseInt(_0x54925c(0x252))/0x1*(-parseInt(_0x54925c(0x182))/0x2)+parseInt(_0x54925c(0x15d))/0x3*(-parseInt(_0x54925c(0x195))/0x4)+-parseInt(_0x54925c(0x2a1))/0x5*(-parseInt(_0x54925c(0x32c))/0x6)+-parseInt(_0x54925c(0x164))/0x7*(-parseInt(_0x54925c(0x309))/0x8)+-parseInt(_0x54925c(0x318))/0x9*(parseInt(_0x54925c(0x1ec))/0xa)+-parseInt(_0x54925c(0x257))/0xb+parseInt(_0x54925c(0x174))/0xc;if(_0x18fd0e===_0x499c75)break;else _0x3b18b2['push'](_0x3b18b2['shift']());}catch(_0x10e47f){_0x3b18b2['push'](_0x3b18b2['shift']());}}}(_0x1823,0x83879));const _0x4c76f1=function(){let _0x355bc2=!![];return function(_0x59531c,_0x18d7bc){const _0x2cf53c=_0x355bc2?function(){const _0x5e9a41=_0x2786;if(_0x18d7bc){const _0x16bb73=_0x18d7bc[_0x5e9a41(0x2b5)](_0x59531c,arguments);return _0x18d7bc=null,_0x16bb73;}}:function(){};return _0x355bc2=![],_0x2cf53c;};}(),_0x465eaf=_0x4c76f1(this,function(){const _0x298a3a=_0x2786;return _0x465eaf[_0x298a3a(0x1f8)]()[_0x298a3a(0x1f6)](_0x298a3a(0x30d))[_0x298a3a(0x1f8)]()[_0x298a3a(0x2be)](_0x465eaf)[_0x298a3a(0x1f6)](_0x298a3a(0x30d));});_0x465eaf();'use strict';process[_0x386a01(0x173)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x386a01(0x230)),low=require(_0x386a01(0x233)),FileSync=require(_0x386a01(0x19a)),path=require(_0x386a01(0x21c)),crypto=require(_0x386a01(0x1c4)),Crypt=require('hybrid-crypto-js')[_0x386a01(0x2c1)],RSA=require('hybrid-crypto-js')[_0x386a01(0x271)],bcrypt=require(_0x386a01(0x1e6)),jwt=require(_0x386a01(0x19e)),ipaddr=require('ipaddr.js'),argv=require(_0x386a01(0x2e5))(process[_0x386a01(0x21a)][_0x386a01(0x18f)](0x2))[_0x386a01(0x21a)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x386a01(0x288)),Mixpanel=require(_0x386a01(0x1c8)),axios=require(_0x386a01(0x160)),{GraphQLClient,gql}=require(_0x386a01(0x28c)),util=require(_0x386a01(0x23a)),fileUpload=require(_0x386a01(0x295)),PORT=argv[_0x386a01(0x1a4)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x386a01(0x26e)](PORT)&&(console[_0x386a01(0x1f1)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x386a01(0x277)),process[_0x386a01(0x29e)](0x1));const HOST=argv[_0x386a01(0x2b1)]||null,userID=argv[_0x386a01(0x1a3)]||'',debugging=argv['d']||![];let bbpath='bb/',bbpath2='';const botfile=_0x386a01(0x1cd),configfile=_0x386a01(0x306),settingsfile=_0x386a01(0x1ae),securefile=_0x386a01(0x189),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);function _0x1823(){const _0xed0803=['Starting\x20Balance\x20Bot\x20update','2FA','crypto','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','replace','Alerts','mixpanel','filter','add','https://api.ipify.org?format=json','manual','bot.js','temporary\x20access\x20rejected','/update\x20-\x20update\x20Balance\x20Bot\x0a','Session\x20expired\x20for\x20user\x20...','</b>\x20?','/:bot/performance','telegram2FaApproval','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','decrypt','stop','getMinutes','/help\x20-\x20show\x20available\x20commands\x0a','full','getFullYear','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','forEach','Idling\x20bot\x20\x20\x20|\x20Bot\x20','/names\x20-\x20show\x20bot\x20names\x0a','whitelist','15\x20min','deleteHistoryAlerts','sendPortfolioTelegram','showname','\x20|\x20','telegramIpApproval','bcryptjs','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','allow','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','toggleBotMode','240UPLPJT','reinstall','stopPolling','\x20(2)','bbvNew','log','bots','http','find','userid','search','new-disabled','toString','store','reject','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','copyFileSync','set','backup-full@','backup-full','removeListener','Temporary\x20access\x20rejected','pidRefreshToken','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20get\x20portfolio','\x20only\x0a','get-messages','exp','restore-backup-file','Yes','HTML','chat','remove','Markdown','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','rmSync','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','join','Unauthorized\x20attempt\x20to\x20download\x20','compareSync','args','title','/:bot/configuration','number','show','argv','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','path','binary','telegramEnabled','catch','generateKeyPairAsync','2FA\x20required','bbPassword','::1',':\x20Bot\x20Mgr\x20>\x20','Invalid\x20IP\x20address','remoteAddress','use','readdirSync','login\x20token\x20generated','split','Unauthorized\x20attempt\x20to\x20update\x20bot','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','connected','storeFiat','files','date-fns','logout','No\x20authentication\x20token','lowdb','Unauthorized\x20attempt\x20to\x20show\x20configuration','Your\x20installation\x20is\x20already\x20up\x20to\x20date','readFileSync','secure','send','exchange','util','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','\x20to\x20','bbvReceive','output-003.log','clientip','once','getDate','Failed\x20to\x20download\x20','Notifications\x20types:\x20','updatebotmanager','entries','settings','telegramChatId','Invalid\x20authentication\x20token\x20(2)','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Starting\x20Balance\x20Bot\x20reinstallation','then','-events.json','All\x20bots','cancelLoading','cloneDeep','inherit','/status\x20-\x20show\x20bot(s)\x20status\x0a','165157oYGJsa','getUTCHours','$1_$2_$3','blacklist','update-bb','3437522quKFmg','timestamp','params','\x20mode','debug','build2','get-backup-files','f2aRequired','padStart','endsWith','server','output-000.log','conn','Logged\x20out\x20user\x20...','sign','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','encryptedUuid','min','Deleted\x20Bot\x20','temporary\x20token\x20generated','function','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','/:bot/support','test','settings.','track','RSA','disconnect','Restore\x20backup\x20file\x20','storeConfiguration','writeFileSync','data',',\x20must\x20be\x20a\x204\x20digit\x20number','callback_query','Notifications\x20enabled\x0a','enabled','onepagemode','removeAllListeners','/enable\x20-\x20enable\x20notifications\x0a','length','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','hasOwnProperty','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','loginRequired','defaults','Bot\x20Mgr\x20>\x20','sockets','404\x20Not\x20Found','/:bot','node-telegram-bot-api','emit','Notifications\x20disabled\x0a','max','graphql-request','login\x20not\x20required','6b67f3d61ee94b8f5c80b4affef4c4d9','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Restarting\x20Bot\x20','telegram','Disabled\x20Bot\x20','push','alias','express-fileupload','output-002.log','Enabled\x20Bot\x20','includes','initclient','stringify','temporary\x20access\x20not\x20allowed','*$1*','mode','exit','message','publicKey','5hZrrXk','password','sortBy','write','Access\x20enabled\x20for\x20','statSync','alerts','order','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Notifications\x20disabled','stopped','Ok,\x20will\x20send\x20order\x20notifications\x20only','request','store-headless','Orders','live','host','Restore\x20process\x20aborted','apiSecret','connection','apply','place-order','Unauthorized\x20attempt\x20to\x20confirm\x20message','node-zip','Setting\x20access:\x20','toggle-bot-mode','delete-alerts','exec','lastmsgtelegram','constructor','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Crypt','build','disabled','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','access\x20timeout','index.html','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20delete\x20alerts','All','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','simple','tkn','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','telegrammsg','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Unauthorized\x20attempt\x20to\x20add\x20bot','toIPv4MappedAddress','showConfig','0.0.0','update-bot','botID','name','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','/metrics\x20-\x20show\x20bot\x20performance\x0a','isValid','existsSync','notification','generate','parse','unlinkSync','login','backup','sort','backup-files','/on\x20-\x20start\x20bot(s)\x0a','getHours','yargs/yargs','cancel-loading','latestversion','sendMetricsTelegram','Password\x20has\x20been\x20reset\x20to:\x20','toIPv4Address','logged\x20out','started','1000',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','type','running','zip/','/download/:type','token','createWriteStream','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','headless','botmanager','bbUsername','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','username','sendMessage','SIGINT','timeshift','storeHeadless','telegramUsername','backupfile','uncaughtException','Unauthorized\x20attempt\x20to\x20update\x20settings','socket.io','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','init','bb-config.json','file','Unauthorized\x20attempt\x20to\x20store\x20configuration','136144VYTWUY','mkdirSync','lastmsgemitted','Server','(((.+)+)+)+$','bot','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','messages','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','temp/','randomFillSync','all','telegramEvents','.zip','378783NOgcGI','yes','auto','version.json','Allow\x20login\x20from\x20IP\x20address\x20<b>','-performance.json','getMonth','listen','-config.json','isDirectory','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','getTime','invalid\x20credentials','expiry','auth','startsWith','Restoring\x20bot(s)\x20from\x20backup','config/','emitHistory','polling_error','1171182nIKCyY','update','socket','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','show-config','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','_data','verify','1510269JxbYsZ','new','bot-','axios','answerCallbackQuery','RSA-OAEP','File\x20uploaded','42gxbBgo','store-settings','30\x20min','kill','************','Invalid\x20Telegram\x20token','\x20|\x20user:\x20...','127.0.0.1','getSeconds','/:bot/history','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','add-bot','ipv6','\x20>\x20','5\x20min','env','28773204KbKaYY','botname','reason','map','Backup\x20file\x20uploaded','confirm-message','whitelistEnabled','DEFLATE','pidExpireLogin','match','value','headers','login\x20required','2FA\x20login\x20required','4BDkWpy','backup/','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','createServer','store-configuration','api-eu.mixpanel.com','bb-secure.json','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Login\x20accepted','assign','-----------------------------------------------------------------------------------','Unauthorized\x20login\x20attempt\x20(timeout)','slice','restart','telegramToken','Invalid\x20username\x20or\x20IP\x20address','uuid','Backup\x20file\x20unzipped\x20and\x20stored','4hhYCHj','apiKey','format','Bot\x20','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','lowdb/adapters/FileSync','kind','onText','***','jsonwebtoken','static','/off\x20-\x20stop\x20bot(s)\x0a','sendFile','get','user','port','reload','delete-bot','output-001.log','referer','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','\x20minutes','secret','All\x20bots\x20running\x20right\x20now','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','bb-settings.json','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','reset-password','Unauthorized\x20attempt\x20to\x20log\x20out','2FA\x20login\x20rejected','logs','Starting\x20new\x20bot\x20|\x20Bot\x20','success','User\x20has\x20been\x20validated','error','status','<b>Balance\x20Bot\x20Status:</b>\x0a','handshake','orders','from','temporary\x20access\x20timeout','privateKey','2FA\x20login\x20token\x20generated','temporaryAccessAllowed','access'];_0x1823=function(){return _0xed0803;};return _0x1823();}const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x386a01(0x329),configbackuppath=configpath+_0x386a01(0x183),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x386a01(0x2f1)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x386a01(0x2f4)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x386a01(0x313)+userID+'/':bbpath+_0x386a01(0x313);!fs[_0x386a01(0x2da)](configpath)&&fs[_0x386a01(0x30a)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x386a01(0x2da)](logspath)&&fs[_0x386a01(0x30a)](logspath);!fs[_0x386a01(0x2da)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x386a01(0x283)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x386a01(0x2d3),'onepagemode':![]}})[_0x386a01(0x2a4)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x386a01(0x283)]({'secure':{},'blacklist':[]})[_0x386a01(0x2a4)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x386a01(0x162)});const saltRounds=0xa,mixpanel=Mixpanel[_0x386a01(0x305)](_0x386a01(0x28e),{'host':_0x386a01(0x188)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x386a01(0x191)]!=''&&settings[_0x386a01(0x2ff)]&&settings[_0x386a01(0x2ff)]!='')initTelegram();const logger={'screen':_0x4570ad=>{const _0x381f33=_0x386a01;console[_0x381f33(0x1f1)](_0x4570ad);},'simple':_0x38170a=>{const _0x39da3b=_0x386a01;console['log'](_0x38170a),loggerfile[_0x39da3b(0x2a4)](util[_0x39da3b(0x197)](_0x38170a)+'\x0a');},'full':async _0x3e910b=>{const _0x2cdbab=_0x386a01,_0x4250d5=getTimeStamp()+_0x2cdbab(0x224)+_0x3e910b;console['log'](_0x4250d5),loggerfile[_0x2cdbab(0x2a4)](util[_0x2cdbab(0x197)](_0x4250d5)+'\x0a');if(tgBot&&settings[_0x2cdbab(0x247)]&&settings[_0x2cdbab(0x316)]!=_0x2cdbab(0x1bb))await tgBot[_0x2cdbab(0x2fb)](settings[_0x2cdbab(0x247)],_0x2cdbab(0x284)+_0x3e910b)[_0x2cdbab(0x21f)](_0x13c4d5=>{telegramError(_0x13c4d5);});},'debug':async(_0x4e9d43,_0xdb7544='')=>{const _0xd9d914=_0x386a01,_0x54dd35=getTimeStamp()+_0xd9d914(0x1fc)+_0x4e9d43;if(debugging)console[_0xd9d914(0x1f1)](_0x54dd35);loggerfile[_0xd9d914(0x2a4)](util['format'](_0x54dd35)+'\x0a');if(_0xdb7544){if(debugging)console['log'](_0xdb7544);loggerfile['write'](util[_0xd9d914(0x197)](_0xdb7544)+'\x0a');}}};process['on'](_0x386a01(0x301),function(_0x114c24){const _0x3acc0f=_0x386a01;logger[_0x3acc0f(0x2cb)](_0x114c24);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x386a01(0x31b))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x2786(_0x1788a3,_0x13ba78){const _0x2421df=_0x1823();return _0x2786=function(_0x465eaf,_0x4c76f1){_0x465eaf=_0x465eaf-0x15b;let _0x182339=_0x2421df[_0x465eaf];return _0x182339;},_0x2786(_0x1788a3,_0x13ba78);}const express=require('express'),app=express(),http=require(_0x386a01(0x1f3))[_0x386a01(0x186)](app);app[_0x386a01(0x227)](fileUpload({'useTempFiles':!![]})),app[_0x386a01(0x1a2)](_0x386a01(0x2f2),async(_0x4d6d92,_0x51e35e)=>{const _0x46e36c=_0x386a01,_0x3f1285=_0x4d6d92[_0x46e36c(0x259)][_0x46e36c(0x2ef)],_0x18f7b0=getClientsWithBotID(_0x46e36c(0x2f7)),_0x14c184=_0x4d6d92[_0x46e36c(0x17f)][_0x46e36c(0x193)],_0x1969f9=timelyDecrypt(_0x14c184,![]),_0x1a6760=_0x18f7b0[_0x46e36c(0x1f4)](_0x5033f3=>_0x5033f3[_0x46e36c(0x193)]==_0x1969f9);if(_0x1a6760){const _0x484ad1=normalizeIP(_0x4d6d92[_0x46e36c(0x32e)]['remoteAddress'])[_0x46e36c(0x1f9)],_0x4bd4aa=_0x4d6d92[_0x46e36c(0x17f)][_0x46e36c(0x2cc)];if(validateAccess(_0x4bd4aa,_0x1969f9,_0x484ad1)[_0x46e36c(0x1e8)])_0x3f1285=='backup'&&await backupConfigFiles(),await zipFiles(_0x3f1285),_0x51e35e['download'](zippath+(_0x3f1285+_0x46e36c(0x317)),_0x162403=>{const _0x499455=_0x46e36c;_0x162403&&(logger[_0x499455(0x1d9)](_0x499455(0x242)+_0x3f1285),logger[_0x499455(0x2cb)](_0x162403));});else logger[_0x46e36c(0x1d9)](_0x46e36c(0x213)+_0x3f1285+'\x20(1)');}else logger[_0x46e36c(0x1d9)](_0x46e36c(0x213)+_0x3f1285+_0x46e36c(0x1ef));}),app['post']('/upload-backup',async(_0x440de2,_0x2a768f)=>{const _0x696af4=_0x386a01,_0x592a60=getClientsWithBotID('botmanager'),_0x738323=_0x440de2[_0x696af4(0x17f)][_0x696af4(0x193)],_0x183096=timelyDecrypt(_0x738323,![]),_0x2718e0=_0x592a60['find'](_0x5be084=>_0x5be084['uuid']==_0x183096);logger[_0x696af4(0x25b)](_0x696af4(0x178));if(_0x2718e0){const _0x4997bd=normalizeIP(_0x440de2['socket'][_0x696af4(0x226)])['store'],_0x549e9c=_0x440de2['headers'][_0x696af4(0x2cc)];if(validateAccess(_0x549e9c,_0x183096,_0x4997bd)['allow']){if(_0x440de2[_0x696af4(0x22f)]){const _0x46f29b=_0x440de2[_0x696af4(0x22f)][_0x696af4(0x300)];await _0x46f29b['mv'](temppath+_0x46f29b[_0x696af4(0x2d6)]),_0x2a768f[_0x696af4(0x238)]({'status':!![],'message':_0x696af4(0x163)});const _0x398e92=getBotsWithMode();_0x398e92['length']>0x0?confirmRestore(temppath,_0x46f29b[_0x696af4(0x2d6)]):unzipFile(temppath,_0x46f29b[_0x696af4(0x2d6)]);}}else logger[_0x696af4(0x1d9)](_0x696af4(0x26c));}else logger[_0x696af4(0x1d9)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x386a01(0x227)](express[_0x386a01(0x19f)](path['join'](__dirname,bbpath2,_0x386a01(0x25c)))),app[_0x386a01(0x227)](express[_0x386a01(0x19f)](path[_0x386a01(0x212)](__dirname,bbpath2,'build'))),app[_0x386a01(0x1a2)]('/',function(_0x514cec,_0x14bcb2){const _0xbe09e1=_0x386a01;_0x14bcb2[_0xbe09e1(0x1a1)](path[_0xbe09e1(0x212)](__dirname,bbpath2,_0xbe09e1(0x25c),'index.html'));}),app[_0x386a01(0x1a2)](_0x386a01(0x287),function(_0x4d8f75,_0x5306f0){const _0x19ec04=_0x386a01;_0x5306f0[_0x19ec04(0x1a1)](path[_0x19ec04(0x212)](__dirname,bbpath2,'build',_0x19ec04(0x2c6)));}),app[_0x386a01(0x1a2)]('/:bot/portfolio',(_0x27ccb8,_0xb4c848)=>{const _0x4f7144=_0x386a01;_0xb4c848['sendFile'](path[_0x4f7144(0x212)](__dirname,bbpath2,'build',_0x4f7144(0x2c6)));}),app[_0x386a01(0x1a2)](_0x386a01(0x1d2),(_0x42a384,_0x5ba0cf)=>{const _0x50faeb=_0x386a01;_0x5ba0cf[_0x50faeb(0x1a1)](path[_0x50faeb(0x212)](__dirname,bbpath2,'build',_0x50faeb(0x2c6)));}),app[_0x386a01(0x1a2)]('/:bot/coins',(_0x24d5b5,_0x27d09b)=>{const _0x1ca2c6=_0x386a01;_0x27d09b[_0x1ca2c6(0x1a1)](path[_0x1ca2c6(0x212)](__dirname,bbpath2,'build','index.html'));}),app[_0x386a01(0x1a2)](_0x386a01(0x16d),(_0x4c8d64,_0x122d09)=>{const _0x320a76=_0x386a01;_0x122d09[_0x320a76(0x1a1)](path[_0x320a76(0x212)](__dirname,bbpath2,_0x320a76(0x2c2),_0x320a76(0x2c6)));}),app[_0x386a01(0x1a2)](_0x386a01(0x217),(_0x3db908,_0x73b87b)=>{const _0x1513c5=_0x386a01;_0x73b87b[_0x1513c5(0x1a1)](path[_0x1513c5(0x212)](__dirname,bbpath2,'build','index.html'));}),app[_0x386a01(0x1a2)](_0x386a01(0x26d),(_0xecce6d,_0x11fafb)=>{const _0x2c07f5=_0x386a01;_0x11fafb[_0x2c07f5(0x1a1)](path['join'](__dirname,bbpath2,_0x2c07f5(0x2c2),_0x2c07f5(0x2c6)));});if(HOST)http[_0x386a01(0x31f)](PORT,HOST);else http[_0x386a01(0x31f)](PORT);const io=require(_0x386a01(0x303))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x37fd4c=_0x386a01;logger[_0x37fd4c(0x2cb)](''),logger[_0x37fd4c(0x2cb)](_0x37fd4c(0x18d)),await logger[_0x37fd4c(0x1d9)]('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),logger[_0x37fd4c(0x2cb)](_0x37fd4c(0x18d));if(config[_0x37fd4c(0x27e)]!=0x0)for(const _0x159ac3 of config){if(_0x159ac3['status']==_0x37fd4c(0x27a)||_0x159ac3[_0x37fd4c(0x1b8)]=='new')await logger[_0x37fd4c(0x1d9)]('Starting\x20bot\x20|\x20Bot\x20'+_0x159ac3[_0x37fd4c(0x2d5)]+_0x37fd4c(0x1e4)+_0x159ac3[_0x37fd4c(0x175)]),startBot([_0x159ac3[_0x37fd4c(0x2d5)],userID],{'cwd':bbpath},function(_0x261f95){const _0x41abf0=_0x37fd4c;if(_0x261f95)logger[_0x41abf0(0x1d9)](_0x261f95);});else(_0x159ac3[_0x37fd4c(0x1b8)]==_0x37fd4c(0x2c3)||_0x159ac3['status']==_0x37fd4c(0x1f7))&&await logger[_0x37fd4c(0x1d9)](_0x37fd4c(0x1dd)+_0x159ac3['botID']+_0x37fd4c(0x1e4)+_0x159ac3[_0x37fd4c(0x175)]);}else!newBot&&logger['simple'](_0x37fd4c(0x266));if(newBot)addBot();logger[_0x37fd4c(0x2cb)](_0x37fd4c(0x18d)),logger[_0x37fd4c(0x2cb)]('');}function startSocket(){const _0x25c71a=_0x386a01;io['on'](_0x25c71a(0x2b4),_0x25547b=>{const _0x7eba13=_0x25c71a;let _0x42958c,_0x381665,_0x329e70,_0x22be7e,_0x1d2cc5;const _0xa906ea=_0x25547b[_0x7eba13(0x1ba)]['headers'][_0x7eba13(0x1a8)];_0x381665=_0xa906ea[_0x7eba13(0x17d)](/bot[0-9]{3}/);if(_0x381665)_0x329e70=_0x381665[0x0]['match'](/[0-9]{3}/);if(_0x329e70)_0x42958c=_0x329e70[0x0];else _0x42958c=_0x7eba13(0x2f7);const _0x54d3b7=_0x25547b['handshake'][_0x7eba13(0x326)][_0x7eba13(0x267)];if(!_0x54d3b7)_0x25547b[_0x7eba13(0x289)](_0x7eba13(0x1b8),{'publicKey':secure[_0x7eba13(0x2a0)]});else{_0x22be7e=timelyDecrypt(_0x54d3b7,![]);if(!_0x22be7e)_0x25547b[_0x7eba13(0x289)](_0x7eba13(0x1b8),{'publicKey':secure[_0x7eba13(0x2a0)]});else{_0x1d2cc5=normalizeIP(_0x25547b[_0x7eba13(0x263)][_0x7eba13(0x226)])[_0x7eba13(0x1f9)];if(!devices[_0x22be7e])devices[_0x22be7e]={'uuid':_0x22be7e,'access':{'token':null}};devices[_0x22be7e]['ip']=_0x1d2cc5;const _0x58df9f=addClient(_0x25547b['id'],_0x22be7e,_0x42958c);setAccess(_0x58df9f),emitMessages(),_0x25547b['on'](_0x7eba13(0x2df),_0xc2eaea=>{const _0x25f9c7=_0x7eba13,_0x443dbc=timelyDecrypt(_0xc2eaea[_0x25f9c7(0x2a2)]);if(_0x443dbc){_0xc2eaea={'username':_0xc2eaea[_0x25f9c7(0x2fa)],'password':_0x443dbc},devices[_0x22be7e][_0x25f9c7(0x1c1)]=validateCredentials(_0xc2eaea,_0x22be7e);if(devices[_0x22be7e]['access']['allow']==![]&&devices[_0x22be7e]['access']['reason']=='2FA\x20login\x20required')_0x25547b['emit'](_0x25f9c7(0x1b8),{'access':devices[_0x22be7e]['access']}),loginAccess2FA(_0x22be7e,_0x1d2cc5);else{if(devices[_0x22be7e][_0x25f9c7(0x1c1)][_0x25f9c7(0x1e8)]==![]&&devices[_0x22be7e][_0x25f9c7(0x1c1)][_0x25f9c7(0x176)]==_0x25f9c7(0x324))_0x25547b[_0x25f9c7(0x289)]('status',{'access':devices[_0x22be7e][_0x25f9c7(0x1c1)]});else devices[_0x22be7e][_0x25f9c7(0x1c1)][_0x25f9c7(0x1e8)]&&devices[_0x22be7e][_0x25f9c7(0x1c1)][_0x25f9c7(0x176)]==_0x25f9c7(0x229)&&(getClientsWithUuid(_0x22be7e)[_0x25f9c7(0x1dc)](_0x54955b=>{setAccess(_0x54955b);}),logger[_0x25f9c7(0x25b)](_0x25f9c7(0x204)+_0x22be7e[_0x25f9c7(0x18f)](-0x8)),setTokenRefresh(_0x22be7e),setSessionTimeout(_0x25f9c7(0x2df),_0x22be7e));}}else logger[_0x25f9c7(0x1d9)](_0x25f9c7(0x18e));}),_0x25547b['on'](_0x7eba13(0x1b0),()=>{resetPassword();}),_0x25547b['on'](_0x7eba13(0x272),_0x4c2318=>{removeClient(_0x25547b['id']);}),_0x42958c=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3688a6){const _0x129904=_0x386a01;if(_0x3688a6!=_0x129904(0x2f7)&&config[_0x129904(0x196)]!=''){if(pid[_0x3688a6])pid[_0x3688a6][_0x129904(0x238)]({'function':_0x129904(0x299),'args':null});}_0x3688a6!='botmanager'&&broadcastToBots(_0x129904(0x1f2),JSON[_0x129904(0x29a)](config));}function reloadBotManager(){const _0x509f29=_0x386a01;getClientsWithBotID(_0x509f29(0x2f7))[_0x509f29(0x1dc)](_0x241570=>{const _0x230c2c=_0x509f29;getSocket(_0x241570['id'])['emit']('status',{'access':{'allow':![],'reason':_0x230c2c(0x1a5),'token':null}});});}function getSocket(_0x18ae7b){const _0x23fd16=_0x386a01;return io[_0x23fd16(0x285)][_0x23fd16(0x285)]['get'](_0x18ae7b);}function setAccess(_0x2eb64c){const _0x1855dc=_0x386a01,_0x398833=getSocket(_0x2eb64c['id']),_0xefbb73=_0x2eb64c[_0x1855dc(0x193)],_0x38a355=_0x2eb64c['bot'];devices[_0xefbb73][_0x1855dc(0x1c1)]=validateAccess(devices[_0xefbb73]['access'][_0x1855dc(0x2f3)],_0xefbb73),logger[_0x1855dc(0x25b)](_0x1855dc(0x2b9)+devices[_0xefbb73][_0x1855dc(0x1c1)]['reason']+'\x20|\x20client:\x20...'+_0x2eb64c['id'][_0x1855dc(0x18f)](-0x8)+_0x1855dc(0x16a)+_0xefbb73[_0x1855dc(0x18f)](-0x8)),_0x398833[_0x1855dc(0x212)](_0xefbb73);if(devices[_0xefbb73][_0x1855dc(0x1c1)]['allow']){_0x398833[_0x1855dc(0x212)](_0x38a355);if(_0x38a355==_0x1855dc(0x2f7))initializeSocketBotManager(_0x398833);else initializeSocketBot(_0x398833);initClient(_0x38a355);}devices[_0xefbb73][_0x1855dc(0x1c1)][_0x1855dc(0x2f3)]&&devices[_0xefbb73][_0x1855dc(0x1c1)][_0x1855dc(0x176)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x1855dc(0x1c3),_0xefbb73),devices[_0xefbb73][_0x1855dc(0x1c1)][_0x1855dc(0x2f3)]&&devices[_0xefbb73][_0x1855dc(0x1c1)][_0x1855dc(0x176)]==_0x1855dc(0x1bf)&&setSessionTimeout(_0x1855dc(0x2df),_0xefbb73),_0x398833[_0x1855dc(0x289)](_0x1855dc(0x1b8),{'status':_0x2eb64c[_0x1855dc(0x261)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xefbb73][_0x1855dc(0x1c1)],'externalip':devices[_0xefbb73]['ip'],'publicKey':secure[_0x1855dc(0x2a0)],'userid':settings[_0x1855dc(0x1f5)],'validInstallation':validInstallation}),devices[_0xefbb73]['access'][_0x1855dc(0x1e8)]==![]&&devices[_0xefbb73][_0x1855dc(0x1c1)]['reason']==_0x1855dc(0x221)&&temporaryAccess2FA(_0xefbb73,devices[_0xefbb73]['ip']);}function setSessionTimeout(_0x11619e,_0x46a661){const _0x2be9f2=_0x386a01;let _0x3e2f40;if(_0x11619e==_0x2be9f2(0x2df))_0x3e2f40=loginExpiry*0x3c*0x3e8;else _0x3e2f40=devices[_0x46a661][_0x2be9f2(0x1e5)][_0x2be9f2(0x325)]*0x3c*0x3e8-(new Date()[_0x2be9f2(0x323)]()-devices[_0x46a661][_0x2be9f2(0x1e5)][_0x2be9f2(0x258)]);if(devices[_0x46a661][_0x2be9f2(0x17c)])clearTimeout(devices[_0x46a661][_0x2be9f2(0x17c)]);devices[_0x46a661][_0x2be9f2(0x17c)]=setTimeout(()=>{const _0x42be33=_0x2be9f2;if(devices[_0x46a661][_0x42be33(0x203)])clearTimeout(devices[_0x46a661][_0x42be33(0x203)]);removeSocketListeners(_0x46a661),addBlacklist(_0x46a661),devices[_0x46a661][_0x42be33(0x1e5)]=null,devices[_0x46a661][_0x42be33(0x1d3)]=null,devices[_0x46a661][_0x42be33(0x1c1)][_0x42be33(0x2f3)]=null,logger['debug'](_0x42be33(0x1d0)+_0x46a661[_0x42be33(0x18f)](-0x8)),devices[_0x46a661][_0x42be33(0x1c1)]=validateAccess(devices[_0x46a661]['access'][_0x42be33(0x2f3)],_0x46a661),!(devices[_0x46a661][_0x42be33(0x1c1)][_0x42be33(0x1e8)]&&devices[_0x46a661]['access']['reason']==_0x42be33(0x28d))&&(_0x11619e=='login'?io['to'](_0x46a661)[_0x42be33(0x289)](_0x42be33(0x1b8),{'access':{'allow':![],'reason':_0x42be33(0x2c5),'token':null}}):io['to'](_0x46a661)['emit'](_0x42be33(0x1b8),{'access':{'allow':![],'reason':_0x42be33(0x1bd),'token':null}})),devices[_0x46a661][_0x42be33(0x1c1)][_0x42be33(0x2f3)]=null;},_0x3e2f40);}function setTokenRefresh(_0x36d777){const _0x4b5721=_0x386a01;if(devices[_0x36d777]['pidRefreshToken'])clearTimeout(devices[_0x36d777][_0x4b5721(0x203)]);devices[_0x36d777][_0x4b5721(0x203)]=setTimeout(()=>{const _0x320ebb=_0x4b5721;getClientsWithUuid(_0x36d777)['length']!=0x0?(devices[_0x36d777]['access']=refreshToken(_0x36d777),io['to'](_0x36d777)[_0x320ebb(0x289)](_0x320ebb(0x1b8),{'status':_0x320ebb(0x22d),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x36d777][_0x320ebb(0x1c1)],'externalip':devices[_0x36d777]['ip'],'publicKey':secure[_0x320ebb(0x2a0)],'validInstallation':validInstallation}),setTokenRefresh(_0x36d777)):clearTimeout(devices[_0x36d777][_0x320ebb(0x203)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x291116){const _0xe50408=_0x386a01,_0x51d2a0=getClient(_0x291116['id'])['uuid'];_0x291116[_0xe50408(0x289)]('bots',config),_0x291116[_0xe50408(0x289)](_0xe50408(0x246),cleanSettings()),_0x291116['on'](_0xe50408(0x16f),_0x3b55e0=>{const _0x421d09=_0xe50408;if(validateAccess(_0x3b55e0,_0x51d2a0)[_0x421d09(0x1e8)])addBot();else logger['full'](_0x421d09(0x2d0));}),_0x291116['on'](_0xe50408(0x2d4),(_0x53ae85,_0x22df8b)=>{const _0x404d74=_0xe50408;if(validateAccess(_0x22df8b,_0x51d2a0)[_0x404d74(0x1e8)])toggleBot(_0x53ae85[_0x404d74(0x2d5)],_0x53ae85[_0x404d74(0x1b8)],_0x53ae85[_0x404d74(0x2b0)]);else logger[_0x404d74(0x1d9)](_0x404d74(0x22b));}),_0x291116['on'](_0xe50408(0x2ba),(_0x466939,_0x462f0d)=>{const _0x26b81f=_0xe50408;if(validateAccess(_0x462f0d,_0x51d2a0)[_0x26b81f(0x1e8)])toggleBotMode(_0x466939);else logger['full'](_0x26b81f(0x22b));}),_0x291116['on'](_0xe50408(0x1a6),(_0x44a92c,_0x3534cf)=>{if(validateAccess(_0x3534cf,_0x51d2a0)['allow'])deleteBot(_0x44a92c);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x291116['on'](_0xe50408(0x165),(_0x3b2946,_0x975b48)=>{const _0x533ec8=_0xe50408;if(validateAccess(_0x975b48,_0x51d2a0)[_0x533ec8(0x1e8)])storeSettings(_0x3b2946,!![]);else logger[_0x533ec8(0x1d9)](_0x533ec8(0x302));}),_0x291116['on'](_0xe50408(0x256),_0x1d9c74=>{const _0x595c33=_0xe50408;if(validateAccess(_0x1d9c74,_0x51d2a0)['allow'])updateBB(_0x595c33(0x32d));else logger[_0x595c33(0x1d9)](_0x595c33(0x304));}),_0x291116['on']('reinstall-bb',_0x2ebee3=>{const _0x11abb5=_0xe50408;if(validateAccess(_0x2ebee3,_0x51d2a0)['allow'])updateBB('reinstall');else logger[_0x11abb5(0x1d9)](_0x11abb5(0x322));}),_0x291116['on'](_0xe50408(0x25d),_0x4d178c=>{const _0x23db44=_0xe50408;if(validateAccess(_0x4d178c,_0x51d2a0)[_0x23db44(0x1e8)]){const _0x5799db=getClient(_0x291116['id']);if(_0x5799db)getBackupFiles(_0x5799db[_0x23db44(0x193)]);else logger['full'](_0x23db44(0x1af));}else logger[_0x23db44(0x1d9)](_0x23db44(0x185));}),_0x291116['on'](_0xe50408(0x209),(_0x296c88,_0x5269d3)=>{const _0x5c8460=_0xe50408;if(validateAccess(_0x5269d3,_0x51d2a0)[_0x5c8460(0x1e8)])restoreBackupFile(_0x296c88);else logger[_0x5c8460(0x1d9)](_0x5c8460(0x2c0));}),_0x291116['on'](_0xe50408(0x207),_0x514cbc=>{const _0x4e60b6=_0xe50408;if(validateAccess(_0x514cbc,_0x51d2a0)[_0x4e60b6(0x1e8)])getMessages();else logger[_0x4e60b6(0x1d9)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x291116['on'](_0xe50408(0x179),(_0x208dc7,_0x267c0b)=>{const _0x535c95=_0xe50408;if(validateAccess(_0x267c0b,_0x51d2a0)[_0x535c95(0x1e8)])confirmMessage(_0x208dc7);else logger[_0x535c95(0x1d9)](_0x535c95(0x2b7));}),_0x291116['on'](_0xe50408(0x231),_0x1391bb=>{const _0x3394ad=_0xe50408;if(validateAccess(_0x1391bb,_0x51d2a0)[_0x3394ad(0x1e8)]){if(devices[_0x51d2a0][_0x3394ad(0x203)])clearTimeout(devices[_0x51d2a0][_0x3394ad(0x203)]);if(devices[_0x51d2a0][_0x3394ad(0x17c)])clearTimeout(devices[_0x51d2a0]['pidExpireLogin']);removeSocketListeners(getClient(_0x291116['id'])[_0x3394ad(0x193)]),addBlacklist(_0x51d2a0),devices[_0x51d2a0]['telegramIpApproval']=null,devices[_0x51d2a0][_0x3394ad(0x1d3)]=null,devices[_0x51d2a0]['access']['token']=null,logger['debug'](_0x3394ad(0x264)+_0x51d2a0[_0x3394ad(0x18f)](-0x8)),io['to'](getClient(_0x291116['id'])[_0x3394ad(0x193)])[_0x3394ad(0x289)](_0x3394ad(0x1b8),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x3394ad(0x1b1));});}function initializeSocketBot(_0x2dcf58){const _0x4911df=_0x386a01,_0x17e40a=getClient(_0x2dcf58['id'])[_0x4911df(0x30e)],_0x110b0f=getClient(_0x2dcf58['id'])[_0x4911df(0x193)];_0x2dcf58['on']('get-logs',(_0x40bcb5,_0x97a477)=>{const _0x2e8b14=_0x4911df;if(validateAccess(_0x97a477,_0x110b0f)['allow']){if(pid[_0x17e40a])pid[_0x17e40a][_0x2e8b14(0x238)]({'function':_0x2e8b14(0x32a),'args':_0x40bcb5});}else logger[_0x2e8b14(0x1d9)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x2dcf58['on'](_0x4911df(0x2bb),(_0x2bd8b3,_0x5c0988)=>{const _0xa29c65=_0x4911df;if(validateAccess(_0x5c0988,_0x110b0f)[_0xa29c65(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a]['send']({'function':_0xa29c65(0x1e1),'args':_0x2bd8b3});}else logger['full'](_0xa29c65(0x2c8));}),_0x2dcf58['on']('get-portfolio',(_0x195716,_0x101c35)=>{const _0x3ffa26=_0x4911df;if(validateAccess(_0x101c35,_0x110b0f)[_0x3ffa26(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a]['send']({'function':'getPortfolio','args':_0x195716});}else logger['full'](_0x3ffa26(0x205));}),_0x2dcf58['on'](_0x4911df(0x187),(_0x4c701b,_0x5dbe3c)=>{const _0x42513b=_0x4911df;if(validateAccess(_0x5dbe3c,_0x110b0f)[_0x42513b(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a]['send']({'function':_0x42513b(0x274),'args':_0x4c701b});}else logger['full'](_0x42513b(0x308));}),_0x2dcf58['on'](_0x4911df(0x2ae),(_0x197a36,_0x1bd1b0)=>{const _0x537464=_0x4911df;if(validateAccess(_0x1bd1b0,_0x110b0f)[_0x537464(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a][_0x537464(0x238)]({'function':_0x537464(0x2fe),'args':_0x197a36});}else logger['full'](_0x537464(0x312));}),_0x2dcf58['on']('store-fiat',(_0x4c004,_0x4de2fa)=>{const _0x6feeec=_0x4911df;if(validateAccess(_0x4de2fa,_0x110b0f)['allow']){if(pid[_0x17e40a])pid[_0x17e40a]['send']({'function':_0x6feeec(0x22e),'args':_0x4c004});}else logger[_0x6feeec(0x1d9)](_0x6feeec(0x1e9));}),_0x2dcf58['on']('reset-history',_0x389fbb=>{const _0x204b2c=_0x4911df;if(validateAccess(_0x389fbb,_0x110b0f)[_0x204b2c(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a][_0x204b2c(0x238)]({'function':'resetHistory','args':null});}else logger[_0x204b2c(0x1d9)](_0x204b2c(0x1db));}),_0x2dcf58['on']('get-starting-balances',_0xcfd935=>{const _0x8042f5=_0x4911df;if(validateAccess(_0xcfd935,_0x110b0f)[_0x8042f5(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a][_0x8042f5(0x238)]({'function':'getStartingBalances','args':null});}else logger[_0x8042f5(0x1d9)](_0x8042f5(0x2f5));}),_0x2dcf58['on'](_0x4911df(0x2b6),(_0x50cb86,_0x4532a2)=>{const _0x494aca=_0x4911df;if(validateAccess(_0x4532a2,_0x110b0f)['allow']){if(pid[_0x17e40a])pid[_0x17e40a]['send']({'function':'placeOrder','args':_0x50cb86});}else logger[_0x494aca(0x1d9)](_0x494aca(0x1ea));}),_0x2dcf58['on'](_0x4911df(0x2e6),_0x5dd6ba=>{const _0x295b47=_0x4911df;if(validateAccess(_0x5dd6ba,_0x110b0f)[_0x295b47(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a]['send']({'function':_0x295b47(0x24e),'args':null});}else logger[_0x295b47(0x1d9)](_0x295b47(0x2cd));}),_0x2dcf58['on'](_0x4911df(0x330),_0x3a1422=>{const _0x496f76=_0x4911df;if(validateAccess(_0x3a1422,_0x110b0f)[_0x496f76(0x1e8)]){if(pid[_0x17e40a])pid[_0x17e40a][_0x496f76(0x238)]({'function':_0x496f76(0x2d2),'args':null});}else logger['full'](_0x496f76(0x234));}),_0x2dcf58['on']('update-bb',_0x53c54b=>{const _0x1881cb=_0x4911df;if(validateAccess(_0x53c54b,_0x110b0f)[_0x1881cb(0x1e8)])updateBB(_0x1881cb(0x32d));else logger[_0x1881cb(0x1d9)](_0x1881cb(0x304));}),_0x2dcf58['on'](_0x4911df(0x207),_0x476369=>{const _0x2c5099=_0x4911df;if(validateAccess(_0x476369,_0x110b0f)[_0x2c5099(0x1e8)])getMessages();else logger[_0x2c5099(0x1d9)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2dcf58['on'](_0x4911df(0x179),(_0x381c,_0x2c514c)=>{const _0xb1d5aa=_0x4911df;if(validateAccess(_0x2c514c,_0x110b0f)[_0xb1d5aa(0x1e8)])confirmMessage(_0x381c);else logger[_0xb1d5aa(0x1d9)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2dcf58['on'](_0x4911df(0x231),_0x321d27=>{const _0x357535=_0x4911df;if(validateAccess(_0x321d27,_0x110b0f)[_0x357535(0x1e8)]){if(devices[_0x110b0f][_0x357535(0x203)])clearTimeout(devices[_0x110b0f][_0x357535(0x203)]);if(devices[_0x110b0f]['pidExpireLogin'])clearTimeout(devices[_0x110b0f][_0x357535(0x17c)]);removeSocketListeners(getClient(_0x2dcf58['id'])[_0x357535(0x193)]),addBlacklist(_0x110b0f),devices[_0x110b0f]['telegramIpApproval']=null,devices[_0x110b0f][_0x357535(0x1d3)]=null,devices[_0x110b0f][_0x357535(0x1c1)]['token']=null,logger[_0x357535(0x25b)](_0x357535(0x264)+_0x110b0f[_0x357535(0x18f)](-0x8)),io['to'](getClient(_0x2dcf58['id'])[_0x357535(0x193)])[_0x357535(0x289)](_0x357535(0x1b8),{'access':{'allow':![],'reason':_0x357535(0x2eb),'token':null}});}else logger['full'](_0x357535(0x1b1));});}function removeSocketListeners(_0x423d25){const _0xb09a47=_0x386a01;getClientsWithUuid(_0x423d25)[_0xb09a47(0x1dc)](_0x211e4c=>{const _0x2b6acb=_0xb09a47;getSocket(_0x211e4c['id'])[_0x2b6acb(0x27c)]();});}function cleanSettings(){const _0x3893db=_0x386a01;let _0x98251e=settings;return settings['telegramToken']&&settings[_0x3893db(0x191)]!=''&&(_0x98251e={..._0x98251e,'telegramToken':_0x3893db(0x168)}),settings[_0x3893db(0x222)]&&settings[_0x3893db(0x222)]!=''&&(_0x98251e={..._0x98251e,'bbPassword':_0x3893db(0x168)}),(settings[_0x3893db(0x222)]&&settings['bbPassword']==_0x3893db(0x19d)||settings[_0x3893db(0x191)]&&settings[_0x3893db(0x191)]=='***')&&(_0x98251e={..._0x98251e,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x3893db(0x191)]=='***'}}),_0x98251e;}async function updateBB(_0x19a46e){const _0xdb3819=_0x386a01;await backupConfigFiles(),installingUpdate=!![],config[_0xdb3819(0x1dc)](_0x591942=>{const _0x13bf56=_0xdb3819;restartBot(_0x591942[_0x13bf56(0x2d5)]);}),logger['debug']('Starting\x20Balance\x20Bot\x20'+_0x19a46e);if(_0x19a46e==_0xdb3819(0x32d))process[_0xdb3819(0x238)]({'update':!![]},_0x3de845=>{});else _0x19a46e=='reinstall'&&process[_0xdb3819(0x238)]({'reinstall':!![]},_0x233251=>{});}function startBot(_0x42e8d8,_0x2e58bd,_0x7b02e3){const _0x46943c=_0x386a01;if(debugging)_0x42e8d8[_0x46943c(0x293)]('-d');let _0xa72054=![];const _0x432036=_0x42e8d8[0x0];_0x2e58bd={..._0x2e58bd,'stdio':[_0x46943c(0x250),'inherit','inherit','ipc']},pid[_0x432036]=childProcess['fork'](botfile,_0x42e8d8,_0x2e58bd),pid[_0x432036]['on'](_0x46943c(0x29f),_0x87359b=>{const _0x5207d7=_0x46943c;switch(Object['keys'](_0x87359b)[0x0]){case _0x5207d7(0x175):updateBotName(_0x432036,_0x87359b[_0x5207d7(0x175)]);break;case _0x5207d7(0x244):updateBotManager();break;case'status':updateStatus(_0x432036,_0x87359b[_0x5207d7(0x1b8)]);break;case _0x5207d7(0x2b0):updateLive(_0x432036,_0x87359b[_0x5207d7(0x2b0)]);break;case _0x5207d7(0x2ec):updateLive(_0x432036,_0x87359b[_0x5207d7(0x2ec)]),io['to'](_0x432036)['emit'](_0x5207d7(0x1b8),{'access':{'allow':![],'reason':_0x5207d7(0x1a5),'token':null}});break;case'stop':_0x87359b[_0x5207d7(0x1d6)]==_0x5207d7(0x190)&&restartBot(_0x432036);_0x87359b['stop']=='kill'&&toggleBot(_0x432036,'disabled',_0x5207d7(0x2ab));break;case'telegram':sendTelegram(_0x432036,_0x87359b[_0x5207d7(0x291)]);break;case _0x5207d7(0x2ce):sendTelegramMsg(_0x87359b[_0x5207d7(0x2ce)]);break;case _0x5207d7(0x26b):io['to'](_0x432036)['emit'](_0x87359b[_0x5207d7(0x26b)],_0x87359b[_0x5207d7(0x215)]);break;}}),pid[_0x432036]['on'](_0x46943c(0x1b7),function(_0x3ff4aa){if(_0xa72054)return;_0xa72054=!![],_0x7b02e3(_0x3ff4aa);}),pid[_0x432036]['on'](_0x46943c(0x29e),async function(_0x365fa3){const _0x35aabe=_0x46943c;if(installingUpdate)return;if(_0xa72054)return;_0xa72054=!![],_0x7b02e3(null);const _0x285227=dbConfig[_0x35aabe(0x1a2)](_0x35aabe(0x1f2))[_0x35aabe(0x1f4)]({'botID':_0x432036})[_0x35aabe(0x17e)]();_0x285227&&(_0x285227['status']=='enabled'||_0x285227[_0x35aabe(0x1b8)]==_0x35aabe(0x15e))&&(await sleep(0x3e8),updateLive(_0x432036,_0x35aabe(0x2ab)),logger[_0x35aabe(0x1d9)](_0x35aabe(0x290)+_0x432036),startBot([_0x432036,userID],{'cwd':bbpath},function(_0xb74f74){const _0x5041e3=_0x35aabe;if(_0xb74f74)logger[_0x5041e3(0x1d9)](_0xb74f74);}));});}function stopBot(_0x4fea2c){const _0x4e48e1=_0x386a01;getClientsWithBotID(_0x4fea2c)[_0x4e48e1(0x1dc)](_0x50e6e4=>{getSocket(_0x50e6e4['id'])['disconnect'](!![]),removeClient(_0x50e6e4['id']);}),pid[_0x4fea2c]&&(pid[_0x4fea2c][_0x4e48e1(0x167)](),pid[_0x4fea2c]=null);}function restartBot(_0x308dad){if(pid[_0x308dad])pid[_0x308dad]['kill']();}function addBot(){const _0x20e9e2=_0x386a01;let _0x599759;for(let _0xcc76e0=0x1;_0xcc76e0<0x3e9;_0xcc76e0++){_0x599759=_0xcc76e0['toString']()[_0x20e9e2(0x25f)](0x3,'0');let _0x446201=config[_0x20e9e2(0x1f4)](_0x2e7b4e=>_0x2e7b4e['botID']==_0x599759);if(!_0x446201)break;}if(_0x599759===_0x20e9e2(0x2ed)){logger['full'](_0x20e9e2(0x18a));return;}logger[_0x20e9e2(0x1d9)](_0x20e9e2(0x1b4)+_0x599759),dbConfig['get']('bots')['push']({'botID':_0x599759,'botname':'Bot\x20'+_0x599759,'status':_0x20e9e2(0x15e),'live':''})[_0x20e9e2(0x2a4)](),startBot([_0x599759,userID],{'cwd':bbpath},function(_0x5785c4){const _0x1af43c=_0x20e9e2;if(_0x5785c4)logger[_0x1af43c(0x1d9)](_0x5785c4);}),config=getConfiguration(),io['to']('botmanager')[_0x20e9e2(0x289)](_0x20e9e2(0x1f2),config),broadcastToBots('bots',JSON[_0x20e9e2(0x29a)](config));}function deleteBot(_0x3e1146){const _0x3732b6=_0x386a01;getClientsWithBotID(_0x3e1146)['forEach'](_0x1cc832=>{const _0x441c7f=_0x2786;getSocket(_0x1cc832['id'])[_0x441c7f(0x272)](!![]),removeClient(_0x1cc832['id']);}),dbConfig['get'](_0x3732b6(0x1f2))[_0x3732b6(0x20d)]({'botID':_0x3e1146})[_0x3732b6(0x2a4)](),logger[_0x3732b6(0x1d9)](_0x3732b6(0x269)+_0x3e1146),stopBot(_0x3e1146);try{if(fs[_0x3732b6(0x2da)](path[_0x3732b6(0x212)](configpath,_0x3732b6(0x15f)+_0x3e1146+_0x3732b6(0x320))))fs['unlinkSync'](path[_0x3732b6(0x212)](configpath,_0x3732b6(0x15f)+_0x3e1146+_0x3732b6(0x320)));if(fs[_0x3732b6(0x2da)](path['join'](configpath,_0x3732b6(0x15f)+_0x3e1146+_0x3732b6(0x24c))))fs['unlinkSync'](path['join'](configpath,_0x3732b6(0x15f)+_0x3e1146+'-events.json'));if(fs['existsSync'](path[_0x3732b6(0x212)](configpath,'bot-'+_0x3e1146+_0x3732b6(0x31d))))fs[_0x3732b6(0x2de)](path['join'](configpath,_0x3732b6(0x15f)+_0x3e1146+_0x3732b6(0x31d)));if(fs[_0x3732b6(0x2da)](path['join'](configpath,_0x3732b6(0x15f)+_0x3e1146+'-results.json')))fs['unlinkSync'](path['join'](configpath,_0x3732b6(0x15f)+_0x3e1146+'-results.json'));}catch(_0xc69568){if(_0xc69568)logger[_0x3732b6(0x1d9)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0xc69568);}config=getConfiguration(),io['to']('botmanager')[_0x3732b6(0x289)]('bots',config),broadcastToBots('bots',JSON[_0x3732b6(0x29a)](config));}function toggleBot(_0x227206,_0x173029,_0x2d5b8e){const _0x2a5aaf=_0x386a01;dbConfig['get'](_0x2a5aaf(0x1f2))[_0x2a5aaf(0x1f4)]({'botID':_0x227206})[_0x2a5aaf(0x18c)]({'status':_0x173029})['assign']({'live':_0x2d5b8e})[_0x2a5aaf(0x2a4)]();if(_0x173029==_0x2a5aaf(0x27a)||_0x173029==_0x2a5aaf(0x15e))logger[_0x2a5aaf(0x1d9)](_0x2a5aaf(0x297)+_0x227206),startBot([_0x227206,userID],{'cwd':bbpath},function(_0x3a4846){const _0x360969=_0x2a5aaf;if(_0x3a4846)logger[_0x360969(0x1d9)](_0x3a4846);});else(_0x173029=='disabled'||_0x173029==_0x2a5aaf(0x1f7))&&(logger[_0x2a5aaf(0x1d9)](_0x2a5aaf(0x292)+_0x227206),stopBot(_0x227206));config=getConfiguration(),io['to']('botmanager')[_0x2a5aaf(0x289)](_0x2a5aaf(0x1f2),config),broadcastToBots(_0x2a5aaf(0x1f2),JSON[_0x2a5aaf(0x29a)](config));}function toggleStatus(_0xe06f38){const _0x5044dd=_0x386a01;let _0x107447=dbConfig[_0x5044dd(0x1a2)](_0x5044dd(0x1f2))[_0x5044dd(0x1f4)]({'botID':_0xe06f38})[_0x5044dd(0x17e)](),_0x2a4bbf;if(_0x107447['status']===_0x5044dd(0x27a))_0x2a4bbf='disabled';else{if(_0x107447[_0x5044dd(0x1b8)]==='new')_0x2a4bbf=_0x5044dd(0x1f7);else{if(_0x107447[_0x5044dd(0x1b8)]===_0x5044dd(0x1f7))_0x2a4bbf=_0x5044dd(0x15e);else{if(_0x107447[_0x5044dd(0x1b8)]===_0x5044dd(0x2c3))_0x2a4bbf='enabled';}}}return _0x2a4bbf;}function updateStatus(_0x4a6fcd,_0x1f5225){const _0x316996=_0x386a01;dbConfig[_0x316996(0x1a2)](_0x316996(0x1f2))[_0x316996(0x1f4)]({'botID':_0x4a6fcd})[_0x316996(0x18c)]({'status':_0x1f5225})[_0x316996(0x2a4)](),config=getConfiguration(),io['to'](_0x316996(0x2f7))[_0x316996(0x289)]('bots',config),broadcastToBots(_0x316996(0x1f2),JSON[_0x316996(0x29a)](config));}function updateLive(_0x583d37,_0x242a20){const _0x57fcd0=_0x386a01;dbConfig['get'](_0x57fcd0(0x1f2))[_0x57fcd0(0x1f4)]({'botID':_0x583d37})['assign']({'live':_0x242a20})[_0x57fcd0(0x2a4)](),config=getConfiguration(),io['to'](_0x57fcd0(0x2f7))[_0x57fcd0(0x289)](_0x57fcd0(0x1f2),config),broadcastToBots(_0x57fcd0(0x1f2),JSON[_0x57fcd0(0x29a)](config));}function updateBotName(_0x90c8ab,_0x48e780){const _0x38bc29=_0x386a01;dbConfig[_0x38bc29(0x1a2)](_0x38bc29(0x1f2))[_0x38bc29(0x1f4)]({'botID':_0x90c8ab})[_0x38bc29(0x18c)]({'botname':_0x48e780})[_0x38bc29(0x2a4)](),config=getConfiguration(),io['to'](_0x38bc29(0x2f7))['emit'](_0x38bc29(0x1f2),config),broadcastToBots(_0x38bc29(0x1f2),JSON[_0x38bc29(0x29a)](config));}function updateBotManager(){const _0x2c716e=_0x386a01;config=getConfiguration(),io['to'](_0x2c716e(0x2f7))[_0x2c716e(0x289)](_0x2c716e(0x1f2),config),broadcastToBots(_0x2c716e(0x1f2),JSON[_0x2c716e(0x29a)](config));}function toggleBotMode(_0x2dc891){const _0x49f8b3=_0x386a01;if(pid[_0x2dc891])pid[_0x2dc891][_0x49f8b3(0x238)]({'function':_0x49f8b3(0x1eb),'args':null});else{const _0x3d2ef7=configpath+_0x49f8b3(0x15f)+_0x2dc891+_0x49f8b3(0x320),_0x214809=fs[_0x49f8b3(0x236)](_0x3d2ef7),_0x11ca62=JSON[_0x49f8b3(0x2dd)](_0x214809),_0x33fa7f=_0x11ca62[_0x49f8b3(0x30e)][0x0][_0x49f8b3(0x2f6)];_0x11ca62[_0x49f8b3(0x30e)][0x0]['headless']=!_0x33fa7f;const _0x501b12=JSON['stringify'](_0x11ca62,null,0x2);fs[_0x49f8b3(0x275)](_0x3d2ef7,_0x501b12),config=getConfiguration(),io['to'](_0x49f8b3(0x2f7))['emit'](_0x49f8b3(0x1f2),config),broadcastToBots(_0x49f8b3(0x1f2),JSON[_0x49f8b3(0x29a)](config));}}function telegramError(_0x3c4c98){const _0xc7ab71=_0x386a01;logger['simple'](getTimeStamp()+_0xc7ab71(0x2ee));}function validateTelegram(_0x23851e){const _0x46e184=_0x386a01;if(_0x23851e[_0x46e184(0x1bc)][_0x46e184(0x2fa)]!=settings[_0x46e184(0x2ff)]&&'@'+_0x23851e[_0x46e184(0x1bc)][_0x46e184(0x2fa)]!=settings['telegramUsername'])return tgBot[_0x46e184(0x2fb)](_0x23851e[_0x46e184(0x20c)]['id'],_0x46e184(0x281),{'parse_mode':_0x46e184(0x20b)})[_0x46e184(0x21f)](_0x31d363=>{telegramError(_0x31d363);}),![];return!![];}async function initTelegram(){const _0x495f1d=_0x386a01;if(tgBot)tgBot[_0x495f1d(0x1ee)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x495f1d(0x191)],{'polling':!![]});let _0x564a82='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x564a82+='\x0a',_0x564a82+=_0x495f1d(0x27d),_0x564a82+='/disable\x20-\x20disable\x20notifications\x0a',_0x564a82+=_0x495f1d(0x20f),_0x564a82+=_0x495f1d(0x2bf),_0x564a82+=_0x495f1d(0x2e3),_0x564a82+=_0x495f1d(0x1a0),_0x564a82+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x564a82+=_0x495f1d(0x1de),_0x564a82+=_0x495f1d(0x251),_0x564a82+=_0x495f1d(0x2d8),_0x564a82+=_0x495f1d(0x199),_0x564a82+=_0x495f1d(0x1cf),_0x564a82+=_0x495f1d(0x2f9),_0x564a82+=_0x495f1d(0x1d8);let _0x36c880=_0x495f1d(0x184);_0x36c880+='\x0a',_0x36c880+=_0x564a82,tgBot[_0x495f1d(0x19c)](/\/start/,_0x491878=>{const _0x1f8bc3=_0x495f1d;if(!validateTelegram(_0x491878))return;if(settings['telegramChatId']!=_0x491878[_0x1f8bc3(0x20c)]['id'])updateSetting('telegramChatId',_0x491878['chat']['id']);updateSetting(_0x1f8bc3(0x21e),!![]),tgBot[_0x1f8bc3(0x2fb)](_0x491878['chat']['id'],_0x36c880)[_0x1f8bc3(0x21f)](_0x54bdb0=>{telegramError(_0x54bdb0);});}),tgBot[_0x495f1d(0x19c)](/\/enable/,_0x350974=>{const _0x3eb8e7=_0x495f1d;if(!validateTelegram(_0x350974))return;if(settings[_0x3eb8e7(0x247)]!=_0x350974['chat']['id'])updateSetting(_0x3eb8e7(0x247),_0x350974[_0x3eb8e7(0x20c)]['id']);updateSetting(_0x3eb8e7(0x21e),!![]),tgBot[_0x3eb8e7(0x2fb)](_0x350974[_0x3eb8e7(0x20c)]['id'],'Notifications\x20enabled')[_0x3eb8e7(0x21f)](_0x4fc197=>{telegramError(_0x4fc197);});}),tgBot[_0x495f1d(0x19c)](/\/config/,async _0xc8cef2=>{const _0x419bfe=_0x495f1d;if(!validateTelegram(_0xc8cef2))return;tgBot[_0x419bfe(0x201)](_0x419bfe(0x278)),tgBot[_0x419bfe(0x2fb)](_0xc8cef2[_0x419bfe(0x20c)]['id'],_0x419bfe(0x2a9),{'reply_markup':{'inline_keyboard':[[{'text':_0x419bfe(0x2af),'callback_data':_0x419bfe(0x1bb)},{'text':_0x419bfe(0x1c7),'callback_data':_0x419bfe(0x2a7)},{'text':_0x419bfe(0x2c9),'callback_data':_0x419bfe(0x315)}]]}})['catch'](_0x337a26=>{telegramError(_0x337a26);}),tgBot['on'](_0x419bfe(0x278),async _0x4620d4=>{const _0x3a32ff=_0x419bfe,_0x1c1288=_0x4620d4[_0x3a32ff(0x276)],_0x3e5238=_0x4620d4['message'];tgBot['answerCallbackQuery'](_0x4620d4['id'])['then'](async()=>{const _0x47714a=_0x3a32ff;_0x1c1288==_0x47714a(0x1bb)&&(updateSetting(_0x47714a(0x316),_0x47714a(0x1bb)),updateSetting(_0x47714a(0x21e),!![]),await tgBot[_0x47714a(0x2fb)](_0x3e5238[_0x47714a(0x20c)]['id'],_0x47714a(0x2ac))[_0x47714a(0x21f)](_0x3c251d=>{telegramError(_0x3c251d);}));_0x1c1288==_0x47714a(0x2a7)&&(updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x47714a(0x2fb)](_0x3e5238[_0x47714a(0x20c)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x47714a(0x21f)](_0x5d6c9b=>{telegramError(_0x5d6c9b);}));_0x1c1288=='all'&&(updateSetting(_0x47714a(0x316),_0x47714a(0x315)),updateSetting(_0x47714a(0x21e),!![]),await tgBot[_0x47714a(0x2fb)](_0x3e5238[_0x47714a(0x20c)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x47714a(0x21f)](_0x479893=>{telegramError(_0x479893);}));if(!settings['telegramChatId'])tgBot[_0x47714a(0x2fb)](_0x3e5238[_0x47714a(0x20c)]['id'],_0x47714a(0x2d7))[_0x47714a(0x21f)](_0x4ef8a5=>{telegramError(_0x4ef8a5);});}),tgBot[_0x3a32ff(0x201)](_0x3a32ff(0x278));});}),tgBot[_0x495f1d(0x19c)](/\/status/,_0x3b3f30=>{const _0x3d03f6=_0x495f1d;if(!validateTelegram(_0x3b3f30))return;const _0x5219ee=getBotsWithMode();let _0x42693c=_0x3d03f6(0x1b9);config[_0x3d03f6(0x1dc)](_0x99be0=>{const _0xd7a1cb=_0x3d03f6,_0x2e1545=_0x5219ee[_0xd7a1cb(0x1f4)](_0x587087=>_0x587087['botID']==_0x99be0[_0xd7a1cb(0x2d5)])['mode'];_0x42693c+='Bot\x20'+_0x99be0[_0xd7a1cb(0x2d5)]+':\x20'+_0x99be0[_0xd7a1cb(0x1b8)]+_0xd7a1cb(0x1e4)+_0x2e1545+'\x20|\x20'+_0x99be0[_0xd7a1cb(0x2b0)]+'\x0a';}),_0x42693c+='\x0a',_0x42693c+=_0x3d03f6(0x2c7),_0x42693c+=!settings[_0x3d03f6(0x21e)]?_0x3d03f6(0x28a):_0x3d03f6(0x279),_0x42693c+=settings[_0x3d03f6(0x21e)]?settings[_0x3d03f6(0x316)]==_0x3d03f6(0x315)?_0x3d03f6(0x211):_0x3d03f6(0x243)+settings[_0x3d03f6(0x316)]+_0x3d03f6(0x206):'',tgBot[_0x3d03f6(0x2fb)](_0x3b3f30[_0x3d03f6(0x20c)]['id'],_0x42693c,{'parse_mode':_0x3d03f6(0x20b)})[_0x3d03f6(0x21f)](_0x3c5e95=>{telegramError(_0x3c5e95);});}),tgBot[_0x495f1d(0x19c)](/\/restart/,_0x1a4b05=>{const _0x5a6bcd=_0x495f1d;if(!validateTelegram(_0x1a4b05))return;tgBot[_0x5a6bcd(0x201)]('callback_query');const _0x42d498=getEnabledBots();if(_0x42d498[_0x5a6bcd(0x27e)]==0x0)tgBot[_0x5a6bcd(0x2fb)](_0x1a4b05[_0x5a6bcd(0x20c)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x5a6bcd(0x21f)](_0x2def89=>{telegramError(_0x2def89);});else{if(_0x42d498[_0x5a6bcd(0x27e)]>0x1)_0x42d498[_0x5a6bcd(0x293)]({'botID':'all'});let _0x5cbf65=[],_0x5c767a=[];const _0x209bf6=_0x42d498[_0x5a6bcd(0x27e)]%0x4==0x0||_0x42d498[_0x5a6bcd(0x27e)]%0x4==0x3||_0x42d498[_0x5a6bcd(0x27e)]%0x3==0x1?0x4:0x3;let _0x305dd6=0x0;_0x42d498[_0x5a6bcd(0x1dc)]((_0x5d28e3,_0x5bcc4e)=>{const _0x271abc=_0x5a6bcd;if(_0x5bcc4e%_0x209bf6==0x0)_0x5c767a=[];_0x5c767a['push']({'text':_0x5d28e3[_0x271abc(0x2d5)]=='all'?_0x271abc(0x24d):_0x271abc(0x198)+_0x5d28e3[_0x271abc(0x2d5)],'callback_data':_0x5d28e3[_0x271abc(0x2d5)]}),_0x5bcc4e%_0x209bf6==0x0&&(_0x5cbf65[_0x305dd6]=_0x5c767a,_0x305dd6++);}),tgBot[_0x5a6bcd(0x2fb)](_0x1a4b05[_0x5a6bcd(0x20c)]['id'],_0x5a6bcd(0x1a9),{'reply_markup':{'inline_keyboard':_0x5cbf65}})[_0x5a6bcd(0x21f)](_0x3d9100=>{telegramError(_0x3d9100);}),tgBot['on'](_0x5a6bcd(0x278),async _0x3279f2=>{const _0x42fa17=_0x5a6bcd,_0x49c7a0=_0x3279f2[_0x42fa17(0x276)],_0x4860c0=_0x3279f2[_0x42fa17(0x29f)];tgBot[_0x42fa17(0x161)](_0x3279f2['id'])[_0x42fa17(0x24b)](async()=>{const _0xe80c15=_0x42fa17;_0x49c7a0==_0xe80c15(0x315)?config[_0xe80c15(0x1dc)](_0xcdc910=>{restartBot(_0xcdc910['botID']);}):restartBot(_0x49c7a0);}),tgBot[_0x42fa17(0x201)]('callback_query');});}}),tgBot[_0x495f1d(0x19c)](/\/on/,_0x2d20af=>{const _0x4dda91=_0x495f1d;if(!validateTelegram(_0x2d20af))return;tgBot[_0x4dda91(0x201)]('callback_query');const _0x59744d=getDisabledBots();if(_0x59744d[_0x4dda91(0x27e)]==0x0)tgBot['sendMessage'](_0x2d20af['chat']['id'],_0x4dda91(0x1ac))[_0x4dda91(0x21f)](_0x5919d8=>{telegramError(_0x5919d8);});else{if(_0x59744d[_0x4dda91(0x27e)]>0x1)_0x59744d[_0x4dda91(0x293)]({'botID':_0x4dda91(0x315)});let _0x4d6c97=[],_0x2f0cd2=[];const _0x5aa015=_0x59744d[_0x4dda91(0x27e)]%0x4==0x0||_0x59744d['length']%0x4==0x3||_0x59744d[_0x4dda91(0x27e)]%0x3==0x1?0x4:0x3;let _0x168870=0x0;_0x59744d[_0x4dda91(0x1dc)]((_0x5d3c76,_0x42239f)=>{const _0x322a93=_0x4dda91;if(_0x42239f%_0x5aa015==0x0)_0x2f0cd2=[];_0x2f0cd2[_0x322a93(0x293)]({'text':_0x5d3c76[_0x322a93(0x2d5)]==_0x322a93(0x315)?_0x322a93(0x24d):'Bot\x20'+_0x5d3c76['botID'],'callback_data':_0x5d3c76[_0x322a93(0x2d5)]}),_0x42239f%_0x5aa015==0x0&&(_0x4d6c97[_0x168870]=_0x2f0cd2,_0x168870++);}),tgBot[_0x4dda91(0x2fb)](_0x2d20af[_0x4dda91(0x20c)]['id'],_0x4dda91(0x2ca),{'reply_markup':{'inline_keyboard':_0x4d6c97}})['catch'](_0x2eb46a=>{telegramError(_0x2eb46a);}),tgBot['on'](_0x4dda91(0x278),async _0x2c4be3=>{const _0x174d12=_0x4dda91,_0x1313bc=_0x2c4be3[_0x174d12(0x276)],_0xd44354=_0x2c4be3['message'];tgBot[_0x174d12(0x161)](_0x2c4be3['id'])['then'](async()=>{const _0x229826=_0x174d12;_0x1313bc==_0x229826(0x315)?(tgBot[_0x229826(0x2fb)](_0xd44354[_0x229826(0x20c)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x229826(0x21f)](_0x4fbac1=>{telegramError(_0x4fbac1);}),_0x59744d[_0x229826(0x1dc)](_0x33d522=>{const _0x3f1104=_0x229826;if(_0x33d522[_0x3f1104(0x2d5)]!=_0x3f1104(0x315))toggleBot(_0x33d522['botID'],toggleStatus(_0x33d522[_0x3f1104(0x2d5)]),_0x3f1104(0x2ab));})):(tgBot[_0x229826(0x2fb)](_0xd44354[_0x229826(0x20c)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x1313bc)['catch'](_0xa58e05=>{telegramError(_0xa58e05);}),toggleBot(_0x1313bc,toggleStatus(_0x1313bc),'stopped'));}),tgBot[_0x174d12(0x201)](_0x174d12(0x278));});}}),tgBot[_0x495f1d(0x19c)](/\/off/,_0x466571=>{const _0x2251bc=_0x495f1d;if(!validateTelegram(_0x466571))return;tgBot[_0x2251bc(0x201)]('callback_query');const _0x59fb04=getEnabledBots();if(_0x59fb04[_0x2251bc(0x27e)]==0x0)tgBot[_0x2251bc(0x2fb)](_0x466571[_0x2251bc(0x20c)]['id'],_0x2251bc(0x311))[_0x2251bc(0x21f)](_0x301e35=>{telegramError(_0x301e35);});else{if(_0x59fb04[_0x2251bc(0x27e)]>0x1)_0x59fb04[_0x2251bc(0x293)]({'botID':'all'});let _0x10ded5=[],_0x57d1fc=[];const _0x4672ff=_0x59fb04[_0x2251bc(0x27e)]%0x4==0x0||_0x59fb04[_0x2251bc(0x27e)]%0x4==0x3||_0x59fb04[_0x2251bc(0x27e)]%0x3==0x1?0x4:0x3;let _0x20b12a=0x0;_0x59fb04[_0x2251bc(0x1dc)]((_0x1038b4,_0x1947dc)=>{const _0xd6321a=_0x2251bc;if(_0x1947dc%_0x4672ff==0x0)_0x57d1fc=[];_0x57d1fc[_0xd6321a(0x293)]({'text':_0x1038b4[_0xd6321a(0x2d5)]==_0xd6321a(0x315)?_0xd6321a(0x24d):_0xd6321a(0x198)+_0x1038b4[_0xd6321a(0x2d5)],'callback_data':_0x1038b4[_0xd6321a(0x2d5)]}),_0x1947dc%_0x4672ff==0x0&&(_0x10ded5[_0x20b12a]=_0x57d1fc,_0x20b12a++);}),tgBot[_0x2251bc(0x2fb)](_0x466571[_0x2251bc(0x20c)]['id'],_0x2251bc(0x32f),{'reply_markup':{'inline_keyboard':_0x10ded5}})[_0x2251bc(0x21f)](_0x47a5a5=>{telegramError(_0x47a5a5);}),tgBot['on'](_0x2251bc(0x278),async _0x6b22da=>{const _0x263d0e=_0x2251bc,_0x42e5e5=_0x6b22da[_0x263d0e(0x276)],_0x28ea4c=_0x6b22da[_0x263d0e(0x29f)];tgBot[_0x263d0e(0x161)](_0x6b22da['id'])[_0x263d0e(0x24b)](async()=>{const _0x5f2c59=_0x263d0e;_0x42e5e5==_0x5f2c59(0x315)?(tgBot[_0x5f2c59(0x2fb)](_0x28ea4c['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x5f2c59(0x21f)](_0x2e187f=>{telegramError(_0x2e187f);}),_0x59fb04[_0x5f2c59(0x1dc)](_0x49653a=>{const _0x1a6300=_0x5f2c59;if(_0x49653a['botID']!=_0x1a6300(0x315))toggleBot(_0x49653a[_0x1a6300(0x2d5)],toggleStatus(_0x49653a[_0x1a6300(0x2d5)]),_0x1a6300(0x2ab));})):(tgBot[_0x5f2c59(0x2fb)](_0x28ea4c['chat']['id'],_0x5f2c59(0x1d4)+_0x42e5e5)[_0x5f2c59(0x21f)](_0x207cef=>{telegramError(_0x207cef);}),toggleBot(_0x42e5e5,toggleStatus(_0x42e5e5),'stopped'));}),tgBot[_0x263d0e(0x201)](_0x263d0e(0x278));});}}),tgBot[_0x495f1d(0x19c)](/\/metrics/,_0x5aaf8f=>{const _0x3e05fc=_0x495f1d;if(!validateTelegram(_0x5aaf8f))return;tgBot[_0x3e05fc(0x201)]('callback_query');const _0x41a441=getEnabledBots();if(_0x41a441[_0x3e05fc(0x27e)]==0x0)tgBot[_0x3e05fc(0x2fb)](_0x5aaf8f[_0x3e05fc(0x20c)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x551601=>{telegramError(_0x551601);});else{if(_0x41a441[_0x3e05fc(0x27e)]>0x1){let _0x4b8dcd=[],_0x50b4d5=[];const _0x427446=_0x41a441[_0x3e05fc(0x27e)]%0x4==0x0||_0x41a441['length']%0x4==0x3||_0x41a441['length']%0x3==0x1?0x4:0x3;let _0x3baa19=0x0;_0x41a441[_0x3e05fc(0x1dc)]((_0x45ce5b,_0x4ab659)=>{const _0x20b550=_0x3e05fc;if(_0x4ab659%_0x427446==0x0)_0x50b4d5=[];_0x50b4d5['push']({'text':_0x20b550(0x198)+_0x45ce5b[_0x20b550(0x2d5)],'callback_data':_0x45ce5b[_0x20b550(0x2d5)]}),_0x4ab659%_0x427446==0x0&&(_0x4b8dcd[_0x3baa19]=_0x50b4d5,_0x3baa19++);}),tgBot[_0x3e05fc(0x2fb)](_0x5aaf8f[_0x3e05fc(0x20c)]['id'],_0x3e05fc(0x28f),{'reply_markup':{'inline_keyboard':_0x4b8dcd}})[_0x3e05fc(0x21f)](_0x10c7e7=>{telegramError(_0x10c7e7);}),tgBot['on']('callback_query',async _0x1170bb=>{const _0x5c4d94=_0x3e05fc,_0x3b058e=_0x1170bb['data'],_0x5793be=_0x1170bb['message'];tgBot[_0x5c4d94(0x161)](_0x1170bb['id'])[_0x5c4d94(0x24b)](async()=>{const _0x1ab2b2=_0x5c4d94;if(pid[_0x3b058e])pid[_0x3b058e][_0x1ab2b2(0x238)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x5c4d94(0x201)](_0x5c4d94(0x278));});}else{const _0x5a1546=_0x41a441[0x0][_0x3e05fc(0x2d5)];if(pid[_0x5a1546])pid[_0x5a1546][_0x3e05fc(0x238)]({'function':_0x3e05fc(0x2e8),'args':null});}}}),tgBot[_0x495f1d(0x19c)](/\/portfolio/,_0x6c55b1=>{const _0x3f6c62=_0x495f1d;if(!validateTelegram(_0x6c55b1))return;tgBot[_0x3f6c62(0x201)](_0x3f6c62(0x278));const _0x357241=getEnabledBots();if(_0x357241['length']==0x0)tgBot[_0x3f6c62(0x2fb)](_0x6c55b1[_0x3f6c62(0x20c)]['id'],_0x3f6c62(0x311))[_0x3f6c62(0x21f)](_0x11a063=>{telegramError(_0x11a063);});else{if(_0x357241[_0x3f6c62(0x27e)]>0x1){let _0x463c59=[],_0x1887ea=[];const _0x1de941=_0x357241['length']%0x4==0x0||_0x357241[_0x3f6c62(0x27e)]%0x4==0x3||_0x357241[_0x3f6c62(0x27e)]%0x3==0x1?0x4:0x3;let _0xa5fd99=0x0;_0x357241['forEach']((_0xf05f47,_0x5a2f36)=>{const _0x2169d1=_0x3f6c62;if(_0x5a2f36%_0x1de941==0x0)_0x1887ea=[];_0x1887ea[_0x2169d1(0x293)]({'text':'Bot\x20'+_0xf05f47[_0x2169d1(0x2d5)],'callback_data':_0xf05f47[_0x2169d1(0x2d5)]}),_0x5a2f36%_0x1de941==0x0&&(_0x463c59[_0xa5fd99]=_0x1887ea,_0xa5fd99++);}),tgBot[_0x3f6c62(0x2fb)](_0x6c55b1[_0x3f6c62(0x20c)]['id'],_0x3f6c62(0x2cf),{'reply_markup':{'inline_keyboard':_0x463c59}})['catch'](_0xd6e195=>{telegramError(_0xd6e195);}),tgBot['on'](_0x3f6c62(0x278),async _0x168fcc=>{const _0x35860c=_0x3f6c62,_0x25de4f=_0x168fcc[_0x35860c(0x276)],_0x20fc17=_0x168fcc['message'];tgBot['answerCallbackQuery'](_0x168fcc['id'])[_0x35860c(0x24b)](async()=>{const _0x2ecc25=_0x35860c;if(pid[_0x25de4f])pid[_0x25de4f][_0x2ecc25(0x238)]({'function':_0x2ecc25(0x1e2),'args':null});}),tgBot[_0x35860c(0x201)](_0x35860c(0x278));});}else{const _0x311a25=_0x357241[0x0][_0x3f6c62(0x2d5)];if(pid[_0x311a25])pid[_0x311a25][_0x3f6c62(0x238)]({'function':_0x3f6c62(0x1e2),'args':null});}}}),tgBot['onText'](/\/update/,async _0x343e9e=>{const _0x58bb62=_0x495f1d;if(!validateTelegram(_0x343e9e))return;tgBot[_0x58bb62(0x201)](_0x58bb62(0x278)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x343e9e[_0x58bb62(0x20c)]['id'],_0x58bb62(0x235))['catch'](_0x1a84b2=>{telegramError(_0x1a84b2);});else!validInstallation?tgBot[_0x58bb62(0x2fb)](_0x343e9e[_0x58bb62(0x20c)]['id'],_0x58bb62(0x16e))[_0x58bb62(0x21f)](_0x52336a=>{telegramError(_0x52336a);}):(tgBot[_0x58bb62(0x2fb)](_0x343e9e['chat']['id'],_0x58bb62(0x23b),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x58bb62(0x319)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x4fcd1f=>{telegramError(_0x4fcd1f);}),tgBot['on'](_0x58bb62(0x278),async _0x355a9a=>{const _0x32e8a3=_0x58bb62,_0x1d39b2=_0x355a9a[_0x32e8a3(0x276)],_0x11412b=_0x355a9a[_0x32e8a3(0x29f)];tgBot['answerCallbackQuery'](_0x355a9a['id'])[_0x32e8a3(0x24b)](async()=>{const _0x514348=_0x32e8a3;_0x1d39b2==_0x514348(0x319)&&(await tgBot['sendMessage'](_0x11412b[_0x514348(0x20c)]['id'],_0x514348(0x1c2))[_0x514348(0x21f)](_0x39b7af=>{telegramError(_0x39b7af);}),updateBB(_0x514348(0x32d))),_0x1d39b2=='no'&&await tgBot[_0x514348(0x2fb)](_0x11412b[_0x514348(0x20c)]['id'],_0x514348(0x1e7))['catch'](_0x205f77=>{telegramError(_0x205f77);});}),tgBot[_0x32e8a3(0x201)](_0x32e8a3(0x278));}));}),tgBot[_0x495f1d(0x19c)](/\/reinstall/,async _0x1da2b4=>{const _0x250284=_0x495f1d;if(!validateTelegram(_0x1da2b4))return;tgBot[_0x250284(0x201)](_0x250284(0x278)),!validInstallation?tgBot['sendMessage'](_0x1da2b4['chat']['id'],_0x250284(0x27f))[_0x250284(0x21f)](_0x165121=>{telegramError(_0x165121);}):(tgBot[_0x250284(0x2fb)](_0x1da2b4[_0x250284(0x20c)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x250284(0x20a),'callback_data':_0x250284(0x319)},{'text':'No','callback_data':'no'}]]}})[_0x250284(0x21f)](_0x87b01=>{telegramError(_0x87b01);}),tgBot['on'](_0x250284(0x278),async _0xd50c32=>{const _0x21d9cd=_0x250284,_0x1585f7=_0xd50c32[_0x21d9cd(0x276)],_0x3f74e7=_0xd50c32[_0x21d9cd(0x29f)];tgBot[_0x21d9cd(0x161)](_0xd50c32['id'])[_0x21d9cd(0x24b)](async()=>{const _0x3261a3=_0x21d9cd;_0x1585f7=='yes'&&(await tgBot[_0x3261a3(0x2fb)](_0x3f74e7[_0x3261a3(0x20c)]['id'],_0x3261a3(0x24a))[_0x3261a3(0x21f)](_0x8fa044=>{telegramError(_0x8fa044);}),updateBB(_0x3261a3(0x1ed))),_0x1585f7=='no'&&await tgBot['sendMessage'](_0x3f74e7['chat']['id'],_0x3261a3(0x1fb))[_0x3261a3(0x21f)](_0x5d364e=>{telegramError(_0x5d364e);});}),tgBot[_0x21d9cd(0x201)](_0x21d9cd(0x278));}));}),tgBot[_0x495f1d(0x19c)](/\/toggle/,_0x5e479a=>{const _0x21546f=_0x495f1d;if(!validateTelegram(_0x5e479a))return;tgBot[_0x21546f(0x201)](_0x21546f(0x278));const _0x2b6976=getBotsWithMode();if(_0x2b6976[_0x21546f(0x27e)]==0x0)tgBot[_0x21546f(0x2fb)](_0x5e479a[_0x21546f(0x20c)]['id'],_0x21546f(0x311))[_0x21546f(0x21f)](_0x38ac0e=>{telegramError(_0x38ac0e);});else{let _0x528e3f=[],_0x53b873=[];const _0x500cf7=0x2;let _0x10e83d=0x0;_0x2b6976['forEach']((_0x3a204b,_0x3eedff)=>{const _0x5394f6=_0x21546f;if(_0x3eedff%_0x500cf7==0x0)_0x53b873=[];_0x53b873[_0x5394f6(0x293)]({'text':_0x5394f6(0x198)+_0x3a204b[_0x5394f6(0x2d5)]+'\x20('+_0x3a204b['mode']+')','callback_data':_0x3a204b[_0x5394f6(0x2d5)]}),_0x3eedff%_0x500cf7==0x0&&(_0x528e3f[_0x10e83d]=_0x53b873,_0x10e83d++);}),tgBot[_0x21546f(0x2fb)](_0x5e479a['chat']['id'],_0x21546f(0x30f),{'reply_markup':{'inline_keyboard':_0x528e3f}})[_0x21546f(0x21f)](_0x13eaa0=>{telegramError(_0x13eaa0);}),tgBot['on'](_0x21546f(0x278),async _0x59a209=>{const _0x33a44b=_0x21546f,_0x59449e=_0x59a209[_0x33a44b(0x276)],_0x413298=_0x59a209[_0x33a44b(0x29f)];tgBot[_0x33a44b(0x161)](_0x59a209['id'])[_0x33a44b(0x24b)](async()=>{const _0x4832dd=_0x33a44b,_0x4f71b5=_0x2b6976['find'](_0x525042=>_0x525042[_0x4832dd(0x2d5)]==_0x59449e),_0x6f36f=_0x4f71b5[_0x4832dd(0x29d)]==_0x4832dd(0x31a)?_0x4832dd(0x1cc):'auto';tgBot['sendMessage'](_0x413298[_0x4832dd(0x20c)]['id'],_0x4832dd(0x21b)+_0x59449e+_0x4832dd(0x23c)+_0x6f36f+_0x4832dd(0x25a))[_0x4832dd(0x21f)](_0x212fd8=>{telegramError(_0x212fd8);}),toggleBotMode(_0x59449e);}),tgBot[_0x33a44b(0x201)]('callback_query');});}}),tgBot['onText'](/\/names/,_0x1a985e=>{const _0x2e2b3a=_0x495f1d;if(!validateTelegram(_0x1a985e))return;let _0x1b9aae='';config[_0x2e2b3a(0x1dc)](_0x1d3466=>{const _0x1612c8=_0x2e2b3a;_0x1b9aae+='Bot\x20'+_0x1d3466[_0x1612c8(0x2d5)]+':\x20'+_0x1d3466[_0x1612c8(0x175)]+'\x0a';}),tgBot[_0x2e2b3a(0x2fb)](_0x1a985e[_0x2e2b3a(0x20c)]['id'],_0x1b9aae,{'parse_mode':_0x2e2b3a(0x20b)})[_0x2e2b3a(0x21f)](_0x53d372=>{telegramError(_0x53d372);});}),tgBot[_0x495f1d(0x19c)](/\/disable/,_0x193f2c=>{const _0x4d5b03=_0x495f1d;if(!validateTelegram(_0x193f2c))return;tgBot['sendMessage'](_0x193f2c[_0x4d5b03(0x20c)]['id'],_0x4d5b03(0x2aa))[_0x4d5b03(0x21f)](_0x2470bc=>{telegramError(_0x2470bc);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x495f1d(0x19c)](/\/help/,_0x8e80=>{const _0x50ae13=_0x495f1d;if(!validateTelegram(_0x8e80))return;tgBot['sendMessage'](_0x8e80['chat']['id'],_0x564a82)[_0x50ae13(0x21f)](_0x472591=>{telegramError(_0x472591);});}),tgBot['on'](_0x495f1d(0x32b),_0x5f1969=>{const _0x120311=_0x495f1d;_0x5f1969[_0x120311(0x1f8)]()[_0x120311(0x298)](_0x120311(0x286))&&(logger[_0x120311(0x1d9)](_0x120311(0x169)),tgBot[_0x120311(0x1ee)](),tgBot=null,io['to'](_0x120311(0x2f7))[_0x120311(0x289)](_0x120311(0x2db),'Invalid\x20Telegram\x20token'));}),process[_0x495f1d(0x240)](_0x495f1d(0x2fc),()=>{const _0x13a479=_0x495f1d;if(tgBot)tgBot['stopPolling']();process[_0x13a479(0x29e)](0x1);}),process[_0x495f1d(0x240)]('SIGTERM',()=>{const _0x266243=_0x495f1d;if(tgBot)tgBot[_0x266243(0x1ee)]();process[_0x266243(0x29e)](0x1);});}}function disableTelegram(){const _0x3e4d77=_0x386a01;tgBot&&(tgBot[_0x3e4d77(0x1ee)](),tgBot=null);}function sendTelegram(_0xa7c550,_0x387cef){const _0x2b992f=_0x386a01;if(settings[_0x2b992f(0x21e)]){if(settings[_0x2b992f(0x316)]=='all'||(_0x387cef[_0x2b992f(0x2ef)]=='error'||_0x387cef[_0x2b992f(0x2ef)]=='warning'||_0x387cef['type']==_0x2b992f(0x1b5))&&settings['telegramEvents']==_0x2b992f(0x2a7)||_0x387cef[_0x2b992f(0x2ef)]==_0x2b992f(0x2a8)&&settings[_0x2b992f(0x316)]=='orders'){if(tgBot&&settings[_0x2b992f(0x247)]){if(_0x387cef[_0x2b992f(0x1e3)])tgBot[_0x2b992f(0x2fb)](settings['telegramChatId'],_0x387cef[_0x2b992f(0x175)]+_0x2b992f(0x171)+_0x387cef['event'])['catch'](_0x58d8c0=>{telegramError(_0x58d8c0);});else tgBot[_0x2b992f(0x2fb)](settings['telegramChatId'],_0x2b992f(0x198)+_0xa7c550+_0x2b992f(0x171)+_0x387cef['event'])[_0x2b992f(0x21f)](_0x152408=>{telegramError(_0x152408);});}}}}async function sendTelegramMsg(_0x5c8fde,_0xa3b364='HTML'){const _0x2dd9da=_0x386a01;return settings[_0x2dd9da(0x21e)]&&tgBot&&settings[_0x2dd9da(0x247)]?(await tgBot['sendMessage'](settings['telegramChatId'],_0x5c8fde,{'parse_mode':_0xa3b364})[_0x2dd9da(0x21f)](_0x4e956b=>{telegramError(_0x4e956b);}),!![]):![];}function getDeviceWithIp(_0x52d097){const _0x15b7c9=_0x386a01;return devices[_0x15b7c9(0x1f4)](_0x2d00cd=>_0x2d00cd['ip']===_0x52d097);}function temporaryAccess2FA(_0x599537,_0x1a6bec){const _0x539997=_0x386a01;let _0x58bcb6=new Date(),_0x54da5c=![];if(lastIpApproval){if(_0x58bcb6-lastIpApproval<0x1388)_0x54da5c=!![];}lastIpApproval=new Date();if(_0x54da5c)return;tgBot&&settings[_0x539997(0x247)]&&(tgBot['removeListener'](_0x539997(0x278)),tgBot[_0x539997(0x2fb)](settings[_0x539997(0x247)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1a6bec)[_0x539997(0x219)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x539997(0x172),'callback_data':'5'},{'text':_0x539997(0x1e0),'callback_data':'15'},{'text':_0x539997(0x166),'callback_data':'30'},{'text':'reject','callback_data':_0x539997(0x1fa)}]]}})[_0x539997(0x21f)](_0x538eb0=>{telegramError(_0x538eb0);}),tgBot['on'](_0x539997(0x278),async _0x629d16=>{const _0x37d6c7=_0x539997,_0x287247=_0x629d16[_0x37d6c7(0x276)],_0x4f49ab=_0x629d16['message'];tgBot[_0x37d6c7(0x161)](_0x629d16['id'])[_0x37d6c7(0x24b)](async()=>{const _0x3b50ba=_0x37d6c7;devices[_0x599537][_0x3b50ba(0x1e5)]={'clientip':_0x1a6bec,'timestamp':new Date()['getTime'](),'expiry':_0x287247},_0x287247!=_0x3b50ba(0x1fa)?(await tgBot[_0x3b50ba(0x2fb)](_0x4f49ab['chat']['id'],_0x3b50ba(0x2a5)+_0x287247+_0x3b50ba(0x1aa),{'parse_mode':_0x3b50ba(0x20b)})[_0x3b50ba(0x21f)](_0x357f7a=>{telegramError(_0x357f7a);}),io['to'](_0x599537)[_0x3b50ba(0x289)](_0x3b50ba(0x1b8),{'access':{'allow':![],'reason':_0x3b50ba(0x1a5),'token':null}})):(await tgBot[_0x3b50ba(0x2fb)](_0x4f49ab[_0x3b50ba(0x20c)]['id'],_0x3b50ba(0x202))['catch'](_0xfc6a9a=>{telegramError(_0xfc6a9a);}),io['to'](_0x599537)[_0x3b50ba(0x289)](_0x3b50ba(0x1b8),{'access':{'allow':![],'reason':_0x3b50ba(0x1ce),'token':null}}));}),tgBot[_0x37d6c7(0x201)](_0x37d6c7(0x278));}));}function loginAccess2FA(_0x16d4a4,_0x5473e6){const _0x562156=_0x386a01;tgBot&&settings[_0x562156(0x247)]&&(tgBot['removeListener'](_0x562156(0x278)),tgBot[_0x562156(0x2fb)](settings['telegramChatId'],_0x562156(0x31c)+normalizeIP(_0x5473e6)['show']+_0x562156(0x1d1),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x562156(0x1fa),'callback_data':'reject'}]]}})[_0x562156(0x21f)](_0x467b57=>{telegramError(_0x467b57);}),tgBot['on']('callback_query',async _0x303c62=>{const _0x1965fc=_0x562156,_0x13d6ec=_0x303c62[_0x1965fc(0x276)],_0x4c3dab=_0x303c62[_0x1965fc(0x29f)];tgBot[_0x1965fc(0x161)](_0x303c62['id'])[_0x1965fc(0x24b)](async()=>{const _0x4180e5=_0x1965fc;devices[_0x16d4a4][_0x4180e5(0x1d3)]={'clientip':_0x5473e6,'timestamp':new Date()[_0x4180e5(0x323)](),'expiry':_0x13d6ec},_0x13d6ec!=_0x4180e5(0x1fa)?(await tgBot[_0x4180e5(0x2fb)](_0x4c3dab[_0x4180e5(0x20c)]['id'],_0x4180e5(0x18b),{'parse_mode':_0x4180e5(0x20b)})[_0x4180e5(0x21f)](_0x45773e=>{telegramError(_0x45773e);}),io['to'](_0x16d4a4)[_0x4180e5(0x289)](_0x4180e5(0x1b8),{'access':{'allow':![],'reason':_0x4180e5(0x1a5),'token':null}})):(await tgBot['sendMessage'](_0x4c3dab[_0x4180e5(0x20c)]['id'],'Login\x20rejected')['catch'](_0x477cb3=>{telegramError(_0x477cb3);}),io['to'](_0x16d4a4)[_0x4180e5(0x289)](_0x4180e5(0x1b8),{'access':{'allow':![],'reason':_0x4180e5(0x1b2),'token':null}}));}),tgBot[_0x1965fc(0x201)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x540cec=_0x386a01;return dbConfig[_0x540cec(0x1a2)]('bots')[_0x540cec(0x2a3)](_0x540cec(0x2d5))[_0x540cec(0x1c9)]({'status':'enabled'})[_0x540cec(0x17e)]()||[];}function getDisabledBots(){const _0x7cd24e=_0x386a01;return dbConfig[_0x7cd24e(0x1a2)]('bots')['sortBy'](_0x7cd24e(0x2d5))['filter']({'status':_0x7cd24e(0x2c3)})[_0x7cd24e(0x17e)]()||[];}function getBotAttributes(_0x1760c2){const _0x45e7c0=_0x386a01;let _0x403791={};const _0x59daa9=configpath+_0x45e7c0(0x15f)+_0x1760c2+_0x45e7c0(0x320),_0x5eaec1=fs[_0x45e7c0(0x2da)](_0x59daa9);if(_0x5eaec1){const _0x2691a7=fs[_0x45e7c0(0x236)](_0x59daa9);try{const _0x49c9f0=JSON[_0x45e7c0(0x2dd)](_0x2691a7),_0x14c5d4=_0x49c9f0?_0x49c9f0[_0x45e7c0(0x30e)][0x0][_0x45e7c0(0x2f6)]:![];_0x403791[_0x45e7c0(0x29d)]=_0x14c5d4?_0x45e7c0(0x31a):_0x45e7c0(0x1cc),_0x403791[_0x45e7c0(0x175)]=_0x49c9f0?_0x49c9f0[_0x45e7c0(0x30e)][0x0][_0x45e7c0(0x175)]:'Bot\x20'+_0x1760c2;}catch(_0x4b6ffc){_0x403791[_0x45e7c0(0x29d)]=_0x45e7c0(0x1cc),_0x403791[_0x45e7c0(0x175)]='Bot\x20'+_0x1760c2;}}else _0x403791[_0x45e7c0(0x29d)]='manual',_0x403791[_0x45e7c0(0x175)]='Bot\x20'+_0x1760c2;return _0x403791;}function getBotsWithMode(){const _0x67529f=_0x386a01,_0x46c2a3=dbConfig[_0x67529f(0x1a2)]('bots')['sortBy'](_0x67529f(0x2d5))['value']()||[];return _0x46c2a3[_0x67529f(0x1dc)](_0x413a43=>{const _0x12f3a9=_0x67529f;let _0x240aa9=getBotAttributes(_0x413a43['botID']);_0x413a43['mode']=_0x240aa9[_0x12f3a9(0x29d)];}),_0x46c2a3;}function getBotExchanges(){const _0xd0b5b0=_0x386a01;let _0x3af755=[];const _0x5377c2=dbConfig[_0xd0b5b0(0x1a2)](_0xd0b5b0(0x1f2))[_0xd0b5b0(0x2a3)](_0xd0b5b0(0x2d5))[_0xd0b5b0(0x17e)]()||[];_0x5377c2[_0xd0b5b0(0x1dc)](_0x47f5b4=>{const _0x548fdb=_0xd0b5b0;if(_0x47f5b4[_0x548fdb(0x1b8)]==_0x548fdb(0x27a)){const _0x1fdfae=configpath+_0x548fdb(0x15f)+_0x47f5b4['botID']+_0x548fdb(0x320),_0x369e46=fs['existsSync'](_0x1fdfae);let _0x15138f;if(_0x369e46){const _0x38af5e=fs[_0x548fdb(0x236)](_0x1fdfae);try{const _0x1ed515=JSON['parse'](_0x38af5e);_0x15138f=_0x1ed515?_0x1ed515[_0x548fdb(0x30e)][0x0][_0x548fdb(0x239)]:null;}catch(_0x5e57cd){}}if(_0x15138f)_0x3af755[_0x548fdb(0x293)](_0x15138f);}});const _0x2a116e=[...new Set(_0x3af755)]['sort']();return _0x2a116e;}async function initUser(){const _0x68eba6=_0x386a01;if(!settings[_0x68eba6(0x1f5)]){const _0x3e7fe7=uuidRandom();mixpanel[_0x68eba6(0x294)](_0x3e7fe7),updateSetting(_0x68eba6(0x1f5),_0x3e7fe7);}}async function initSecure(){const _0x2362bb=_0x386a01;let _0xc3930b=getSecure();if(!_0xc3930b[_0x2362bb(0x280)](_0x2362bb(0x1ab))){let _0x3e597c=await generateKeys();_0xc3930b[_0x2362bb(0x2a0)]=_0x3e597c[_0x2362bb(0x2a0)],_0xc3930b['privateKey']=_0x3e597c[_0x2362bb(0x1be)],_0xc3930b[_0x2362bb(0x1ab)]=crypto['randomBytes'](0x20)[_0x2362bb(0x1f8)]('hex');;storeSecure(_0xc3930b);}}function getSettings(){const _0x58617d=_0x386a01;return dbSettings[_0x58617d(0x1a2)](_0x58617d(0x246))[_0x58617d(0x17e)]()||{};}function getSecure(){const _0x2ab707=_0x386a01;return dbSecure[_0x2ab707(0x1a2)](_0x2ab707(0x237))[_0x2ab707(0x17e)]()||{};}function getBlacklist(){const _0x4a1df5=_0x386a01;return dbSecure['get'](_0x4a1df5(0x255))[_0x4a1df5(0x17e)]()||[];}function broadcastToBots(_0x1933e7,_0x5aa130){const _0x2406ec=_0x386a01;config[_0x2406ec(0x1dc)](_0x2c09e9=>{const _0x5867d2=_0x2406ec;if(_0x2c09e9['status']==_0x5867d2(0x27a)&&_0x2c09e9[_0x5867d2(0x2b0)]==_0x5867d2(0x2f0)||_0x2c09e9[_0x5867d2(0x1b8)]==_0x5867d2(0x15e)&&_0x2c09e9[_0x5867d2(0x2b0)]=='running'){if(pid[_0x2c09e9[_0x5867d2(0x2d5)]])pid[_0x2c09e9[_0x5867d2(0x2d5)]][_0x5867d2(0x238)]({[_0x1933e7]:_0x5aa130});}});}function storeSettings(_0x60d248,_0x3b4f59=![]){const _0x4d3fa1=_0x386a01;_0x60d248={...settings,..._0x60d248};if(_0x3b4f59&&_0x60d248['bbPassword']!=_0x4d3fa1(0x168)&&_0x60d248[_0x4d3fa1(0x222)]!='***'&&_0x60d248[_0x4d3fa1(0x222)]!=''){const _0x45874e=crypt[_0x4d3fa1(0x1d5)](secure['privateKey'],_0x60d248[_0x4d3fa1(0x222)])[_0x4d3fa1(0x29f)][_0x4d3fa1(0x22a)]('@')[0x0],_0x256dd1=bcrypt['hashSync'](_0x45874e,saltRounds);_0x60d248={..._0x60d248,'bbPassword':_0x256dd1};}if(_0x3b4f59&&_0x60d248[_0x4d3fa1(0x191)]!=_0x4d3fa1(0x168)&&_0x60d248['telegramToken']!='***'&&_0x60d248[_0x4d3fa1(0x191)]!=''){const _0x556a8f=crypt[_0x4d3fa1(0x1d5)](secure['privateKey'],_0x60d248[_0x4d3fa1(0x191)])[_0x4d3fa1(0x29f)][_0x4d3fa1(0x22a)]('@')[0x0];_0x60d248={..._0x60d248,'telegramToken':_0x556a8f};}const _0x3c53b8=_0x60d248[_0x4d3fa1(0x191)]!=_0x4d3fa1(0x168)&&_0x60d248[_0x4d3fa1(0x191)]!=settings[_0x4d3fa1(0x191)]||_0x60d248[_0x4d3fa1(0x2ff)]!=settings[_0x4d3fa1(0x2ff)],_0xe3f832=_0x60d248['telegramToken']==''||_0x60d248[_0x4d3fa1(0x2ff)]=='';if(_0x3c53b8)_0x60d248[_0x4d3fa1(0x316)]='all';for(const [_0x1f5679,_0x102d49]of Object[_0x4d3fa1(0x245)](_0x60d248)){if(_0x1f5679==_0x4d3fa1(0x191)&&_0x102d49==_0x4d3fa1(0x168)){_0x60d248[_0x4d3fa1(0x191)]=settings[_0x4d3fa1(0x191)];continue;};if(_0x1f5679=='bbPassword'&&_0x102d49==_0x4d3fa1(0x168)){_0x60d248[_0x4d3fa1(0x222)]=settings[_0x4d3fa1(0x222)];continue;};dbSettings[_0x4d3fa1(0x1fe)](_0x4d3fa1(0x26f)+_0x1f5679,_0x102d49)[_0x4d3fa1(0x2a4)]();}settings=_0x60d248,io['to'](_0x4d3fa1(0x2f7))[_0x4d3fa1(0x289)](_0x4d3fa1(0x246),cleanSettings()),broadcastToBots(_0x4d3fa1(0x2fd),settings['timeshift']),broadcastToBots(_0x4d3fa1(0x27b),settings[_0x4d3fa1(0x27b)]);if(_0x3c53b8&&!_0xe3f832)initTelegram();if(_0x3c53b8&&_0xe3f832)disableTelegram();getAllClients()[_0x4d3fa1(0x1dc)](_0x1e8300=>{const _0x17a1ec=_0x4d3fa1;getSocket(_0x1e8300['id'])[_0x17a1ec(0x289)]('status',{'access':{'allow':![],'reason':_0x17a1ec(0x1a5),'token':null}});});}function updateSetting(_0x4fa75c,_0x163184){const _0x21b5fa=_0x386a01;dbSettings['set'](_0x21b5fa(0x26f)+_0x4fa75c,_0x163184)[_0x21b5fa(0x2a4)](),settings=getSettings(),io['to'](_0x21b5fa(0x2f7))['emit'](_0x21b5fa(0x246),cleanSettings());}function storeSecure(_0x174b9b){const _0x4c08a8=_0x386a01;dbSecure['get'](_0x4c08a8(0x237))[_0x4c08a8(0x293)](_0x174b9b)[_0x4c08a8(0x2a4)](),secure=_0x174b9b;}function addBlacklist(_0x2a7d4a){const _0x139819=_0x386a01;cleanBlacklist();let _0x45a826;devices[_0x2a7d4a][_0x139819(0x1e5)]?_0x45a826=Math[_0x139819(0x28b)](devices[_0x2a7d4a][_0x139819(0x1e5)]['expiry'],loginExpiry):_0x45a826=loginExpiry,dbSecure[_0x139819(0x1a2)](_0x139819(0x255))['push']({'expiry':new Date()['getTime']()+_0x45a826*0x3c*0x3e8,'token':devices[_0x2a7d4a]['access'][_0x139819(0x2f3)]})[_0x139819(0x2a4)](),blacklist=dbSecure[_0x139819(0x1a2)](_0x139819(0x255))[_0x139819(0x17e)]();}function cleanBlacklist(){const _0x3429b0=_0x386a01;let _0x11bea8=dbSecure[_0x3429b0(0x1a2)](_0x3429b0(0x255))[_0x3429b0(0x24f)]()[_0x3429b0(0x17e)](),_0xe73796=new Date()['getTime']();_0x11bea8['forEach'](_0x5b5c93=>{const _0x5c530b=_0x3429b0;_0x5b5c93[_0x5c530b(0x325)]<_0xe73796&&dbSecure[_0x5c530b(0x1a2)]('blacklist')['remove']({'expiry':_0x5b5c93[_0x5c530b(0x325)]})['write']();});}function initStates(){const _0x405b91=_0x386a01;let _0x498537=getConfiguration();_0x498537[_0x405b91(0x1dc)](_0x51f9ee=>{const _0x146900=_0x405b91;_0x51f9ee[_0x146900(0x2b0)]=_0x146900(0x2ab);}),storeConfiguration(_0x498537);}function onKeys(){const _0x2a285e=new RSA();return new Promise(_0x35ca98=>{const _0x137417=_0x2786;_0x2a285e[_0x137417(0x220)]()[_0x137417(0x24b)](_0x58a956=>{_0x35ca98(_0x58a956);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x256448=_0x386a01;let _0x44842d=getSettings(),_0x308681=![];!_0x44842d[_0x256448(0x280)]('lastmsgtelegram')&&(_0x44842d[_0x256448(0x2bd)]=0x0,_0x308681=!![]);!_0x44842d[_0x256448(0x280)]('lastmsgemitted')&&(_0x44842d[_0x256448(0x30b)]=0x0,_0x308681=!![]);!_0x44842d['hasOwnProperty'](_0x256448(0x2e7))&&(_0x44842d['latestversion']=_0x256448(0x2d3),_0x308681=!![]);!_0x44842d[_0x256448(0x280)](_0x256448(0x27b))&&(_0x44842d[_0x256448(0x27b)]=![],_0x308681=!![]);if(_0x308681)storeSettings(_0x44842d);}function storeConfiguration(_0x5cb367){const _0x4e4e4d=_0x386a01;dbConfig[_0x4e4e4d(0x1a2)](_0x4e4e4d(0x1f2))[_0x4e4e4d(0x20d)]()[_0x4e4e4d(0x2a4)](),_0x5cb367[_0x4e4e4d(0x1dc)](_0x2e9875=>{const _0x427199=_0x4e4e4d;delete _0x2e9875[_0x427199(0x29d)];}),dbConfig[_0x4e4e4d(0x1a2)](_0x4e4e4d(0x1f2))[_0x4e4e4d(0x293)](..._0x5cb367)[_0x4e4e4d(0x2a4)](),config=_0x5cb367;}function resetPassword(){const _0x4d8a9f=_0x386a01;tgBot&&settings[_0x4d8a9f(0x247)]&&(tgBot[_0x4d8a9f(0x201)](_0x4d8a9f(0x278)),tgBot[_0x4d8a9f(0x2fb)](settings[_0x4d8a9f(0x247)],_0x4d8a9f(0x22c),{'parse_mode':_0x4d8a9f(0x20b),'reply_markup':{'inline_keyboard':[[{'text':_0x4d8a9f(0x319),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4d8a9f(0x21f)](_0x1f22ee=>{telegramError(_0x1f22ee);}),tgBot['on'](_0x4d8a9f(0x278),async _0x4b96ae=>{const _0x255e6b=_0x4d8a9f,_0x25de55=_0x4b96ae[_0x255e6b(0x276)],_0x4e9121=_0x4b96ae[_0x255e6b(0x29f)];tgBot[_0x255e6b(0x161)](_0x4b96ae['id'])[_0x255e6b(0x24b)](async()=>{const _0x4bff4a=_0x255e6b;if(_0x25de55!='no'){const _0x56fe51=0xf,_0x3252ab=_0x4bff4a(0x249),_0x3b94e9=Array[_0x4bff4a(0x1bc)](crypto[_0x4bff4a(0x314)](new Uint32Array(_0x56fe51)))[_0x4bff4a(0x177)](_0x5830dd=>_0x3252ab[_0x5830dd%_0x3252ab['length']])['join'](''),_0x50644a=bcrypt['hashSync'](_0x3b94e9,saltRounds);storeSettings({'bbPassword':_0x50644a}),await tgBot[_0x4bff4a(0x2fb)](_0x4e9121[_0x4bff4a(0x20c)]['id'],_0x4bff4a(0x2e9)+_0x3b94e9,{'parse_mode':_0x4bff4a(0x20b)})[_0x4bff4a(0x21f)](_0x119235=>{telegramError(_0x119235);});}else await tgBot['sendMessage'](_0x4e9121[_0x4bff4a(0x20c)]['id'],'Password\x20reset\x20rejected')[_0x4bff4a(0x21f)](_0x57fc1b=>{telegramError(_0x57fc1b);});}),tgBot[_0x255e6b(0x201)]('callback_query');}));}async function confirmRestore(_0x5ef398,_0x2ee129){const _0x4dc306=_0x386a01;io['to'](_0x4dc306(0x2f7))['emit']('notification',_0x4dc306(0x331),'success'),tgBot&&settings[_0x4dc306(0x247)]&&(tgBot['removeListener'](_0x4dc306(0x278)),await tgBot[_0x4dc306(0x2fb)](settings[_0x4dc306(0x247)],_0x4dc306(0x1ad),{'parse_mode':_0x4dc306(0x20b),'reply_markup':{'inline_keyboard':[[{'text':_0x4dc306(0x319),'callback_data':_0x4dc306(0x319)},{'text':'no','callback_data':'no'}]]}})[_0x4dc306(0x21f)](_0x446f25=>{telegramError(_0x446f25);}),tgBot['on'](_0x4dc306(0x278),async _0x3fe750=>{const _0x4badd2=_0x4dc306,_0x3cbb28=_0x3fe750['data'],_0x13d3ed=_0x3fe750[_0x4badd2(0x29f)];tgBot[_0x4badd2(0x161)](_0x3fe750['id'])['then'](async()=>{const _0x2585d0=_0x4badd2;_0x3cbb28==_0x2585d0(0x319)?(await tgBot[_0x2585d0(0x2fb)](_0x13d3ed['chat']['id'],_0x2585d0(0x328),{'parse_mode':_0x2585d0(0x20b)})[_0x2585d0(0x21f)](_0xd65446=>{telegramError(_0xd65446);}),unzipFile(_0x5ef398,_0x2ee129)):(logger['debug'](_0x2585d0(0x2b2)),await tgBot[_0x2585d0(0x2fb)](_0x13d3ed[_0x2585d0(0x20c)]['id'],'Restore\x20process\x20aborted')['catch'](_0x21ab3e=>{telegramError(_0x21ab3e);}));}),tgBot[_0x4badd2(0x201)]('callback_query');}));}function getServerTime(){const _0x4ac591=_0x386a01,_0x84b695=new Date();return _0x84b695[_0x4ac591(0x1da)]()+'/'+(_0x84b695[_0x4ac591(0x31e)]()+0x1)['toString']()[_0x4ac591(0x25f)](0x2,'0')+'/'+_0x84b695[_0x4ac591(0x241)]()[_0x4ac591(0x1f8)]()['padStart'](0x2,'0')+'\x20'+_0x84b695[_0x4ac591(0x2e4)]()[_0x4ac591(0x1f8)]()[_0x4ac591(0x25f)](0x2,'0')+':'+_0x84b695[_0x4ac591(0x1d7)]()[_0x4ac591(0x1f8)]()[_0x4ac591(0x25f)](0x2,'0')+':'+_0x84b695['getSeconds']()['toString']()[_0x4ac591(0x25f)](0x2,'0');}function getTimeStamp(){const _0x5e2501=_0x386a01,_0x418075=shiftedTime();return _0x418075[_0x5e2501(0x1da)]()+'/'+(_0x418075[_0x5e2501(0x31e)]()+0x1)['toString']()[_0x5e2501(0x25f)](0x2,'0')+'/'+_0x418075[_0x5e2501(0x241)]()[_0x5e2501(0x1f8)]()[_0x5e2501(0x25f)](0x2,'0')+'\x20'+_0x418075[_0x5e2501(0x2e4)]()[_0x5e2501(0x1f8)]()['padStart'](0x2,'0')+':'+_0x418075[_0x5e2501(0x1d7)]()[_0x5e2501(0x1f8)]()[_0x5e2501(0x25f)](0x2,'0')+':'+_0x418075[_0x5e2501(0x16c)]()[_0x5e2501(0x1f8)]()[_0x5e2501(0x25f)](0x2,'0');}function getCleanTimeStamp(){const _0x5e405b=_0x386a01,_0x2ec5f2=shiftedTime();return _0x2ec5f2[_0x5e405b(0x1da)]()+(_0x2ec5f2[_0x5e405b(0x31e)]()+0x1)[_0x5e405b(0x1f8)]()['padStart'](0x2,'0')+_0x2ec5f2[_0x5e405b(0x241)]()[_0x5e405b(0x1f8)]()[_0x5e405b(0x25f)](0x2,'0')+'-'+_0x2ec5f2['getHours']()[_0x5e405b(0x1f8)]()['padStart'](0x2,'0')+_0x2ec5f2['getMinutes']()[_0x5e405b(0x1f8)]()['padStart'](0x2,'0')+_0x2ec5f2['getSeconds']()[_0x5e405b(0x1f8)]()[_0x5e405b(0x25f)](0x2,'0');}function shiftedTime(){const _0x2b9494=_0x386a01,_0x31430=new Date();let _0x468e38=_0x31430;if(settings[_0x2b9494(0x2fd)]&&settings['timeshift']!==0x0)_0x468e38=fns[_0x2b9494(0x1ca)](_0x31430,{'hours':settings[_0x2b9494(0x2fd)]});return _0x468e38;}function startScheduler(){const _0x276211=_0x386a01,_0x324346=new Date()[_0x276211(0x253)](),_0x1b1859=shiftedTime()[_0x276211(0x2e4)]();_0x1b1859==0x4&&backupConfigFiles();_0x1b1859==0x0&&rotateLogFiles();_0x324346%0x6==0x0&&triggerAnalytics();_0x324346%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1060e5){const _0x19ea04=_0x386a01;logger['debug'](_0x19ea04(0x273)+_0x1060e5);const _0x32add3=getBotsWithMode();_0x32add3[_0x19ea04(0x27e)]>0x0?confirmRestore(configbackuppath,_0x1060e5):unzipFile(configbackuppath,_0x1060e5);}async function getBackupFiles(_0x206d8e=null){const _0x2c6dce=_0x386a01;let _0x554908=[],_0x4a2b27=fs[_0x2c6dce(0x228)](configbackuppath,{'withFileTypes':!![]});_0x4a2b27[_0x2c6dce(0x2e1)]((_0x424a96,_0x42b68d)=>_0x424a96[_0x2c6dce(0x2d6)]<_0x42b68d[_0x2c6dce(0x2d6)]?0x1:_0x42b68d[_0x2c6dce(0x2d6)]<_0x424a96['name']?-0x1:0x0),_0x4a2b27[_0x2c6dce(0x1dc)](_0x5318fa=>{const _0x188027=_0x2c6dce;if(!_0x5318fa[_0x188027(0x321)]()&&_0x5318fa[_0x188027(0x2d6)][_0x188027(0x327)](_0x188027(0x1ff))&&_0x5318fa[_0x188027(0x2d6)][_0x188027(0x260)](_0x188027(0x317))){const _0x38e8a7=formatDate(fs['statSync'](configbackuppath+_0x5318fa[_0x188027(0x2d6)])['mtime']);_0x554908['push']({'name':_0x5318fa['name'],'mtime':_0x38e8a7});}});if(_0x206d8e)io['to'](_0x206d8e)[_0x2c6dce(0x289)](_0x2c6dce(0x2e2),_0x554908);else return _0x554908;}async function backupConfigFiles(){const _0x26e23d=_0x386a01;await zipFiles(_0x26e23d(0x200));const _0x55b881=getCleanTimeStamp();fs[_0x26e23d(0x1fd)](zippath+'backup-full.zip',configbackuppath+(_0x26e23d(0x1ff)+_0x55b881+_0x26e23d(0x317)));let _0x5e9cc6=fs[_0x26e23d(0x228)](configbackuppath,{'withFileTypes':!![]});_0x5e9cc6[_0x26e23d(0x2e1)]((_0x482518,_0x2a3204)=>_0x482518[_0x26e23d(0x2d6)]<_0x2a3204['name']?0x1:_0x2a3204['name']<_0x482518[_0x26e23d(0x2d6)]?-0x1:0x0),_0x5e9cc6[_0x26e23d(0x27e)]>maxBackups&&fs[_0x26e23d(0x2de)](configbackuppath+_0x5e9cc6[maxBackups][_0x26e23d(0x2d6)]);}function rotateLogFiles(){const _0x39aa43=_0x386a01,_0xb3f6f9=fs[_0x39aa43(0x2a6)](logspath+'output-000.log'),_0xe8c25a=_0xb3f6f9['size']/0x400;if(_0xe8c25a>0x64){let _0x2c2bf8=fs[_0x39aa43(0x228)](logspath,{'withFileTypes':!![]});_0x2c2bf8['sort']((_0x202b8c,_0x2baa39)=>_0x202b8c[_0x39aa43(0x2d6)]<_0x2baa39[_0x39aa43(0x2d6)]?0x1:_0x2baa39[_0x39aa43(0x2d6)]<_0x202b8c['name']?-0x1:0x0),_0x2c2bf8['forEach'](_0xd6f66e=>{const _0x1f32d8=_0x39aa43;if(_0xd6f66e[_0x1f32d8(0x2d6)]==_0x1f32d8(0x296))fs[_0x1f32d8(0x1fd)](logspath+_0xd6f66e[_0x1f32d8(0x2d6)],logspath+_0x1f32d8(0x23e));if(_0xd6f66e[_0x1f32d8(0x2d6)]==_0x1f32d8(0x1a7))fs[_0x1f32d8(0x1fd)](logspath+_0xd6f66e[_0x1f32d8(0x2d6)],logspath+_0x1f32d8(0x296));_0xd6f66e['name']==_0x1f32d8(0x262)&&(fs[_0x1f32d8(0x1fd)](logspath+_0xd6f66e[_0x1f32d8(0x2d6)],logspath+'output-001.log'),fs[_0x1f32d8(0x275)](logspath+_0xd6f66e[_0x1f32d8(0x2d6)],''));});}}async function zipFiles(_0x999b93){const _0x34d8cd=_0x386a01;let _0x30d606;if(_0x999b93==_0x34d8cd(0x1b3))_0x30d606=logspath;if(_0x999b93==_0x34d8cd(0x2e0))_0x30d606=configpath;if(_0x999b93=='backup-full')_0x30d606=configpath;let _0x1a2969=fs['readdirSync'](_0x30d606,{'withFileTypes':!![]});const _0x7cf600=new require(_0x34d8cd(0x2b8))();_0x1a2969[_0x34d8cd(0x1dc)](_0x2ba9e5=>{const _0x3abc23=_0x34d8cd;if(!_0x2ba9e5[_0x3abc23(0x321)]()){let _0x52395a=fs[_0x3abc23(0x236)](_0x30d606+_0x2ba9e5[_0x3abc23(0x2d6)]);if(_0x999b93=='backup'){const _0x355a1d=/^bot-[0-9]{3}-config.json$/,_0x51c97c=_0x355a1d[_0x3abc23(0x26e)](_0x2ba9e5['name']);if(_0x51c97c){const _0x7ab51a=JSON[_0x3abc23(0x2dd)](_0x52395a);_0x7ab51a[_0x3abc23(0x30e)][0x0]&&(_0x7ab51a[_0x3abc23(0x30e)][0x0][_0x3abc23(0x196)]=_0x3abc23(0x19d),_0x7ab51a['bot'][0x0][_0x3abc23(0x2b3)]='***'),_0x52395a=JSON[_0x3abc23(0x29a)](_0x7ab51a,null,0x2);}if(_0x2ba9e5[_0x3abc23(0x2d6)]==_0x3abc23(0x1ae)){const _0xcfffaf=JSON['parse'](_0x52395a);if(_0xcfffaf[_0x3abc23(0x246)][_0x3abc23(0x282)])_0xcfffaf[_0x3abc23(0x246)]['loginRequired']=![];if(_0xcfffaf[_0x3abc23(0x246)][_0x3abc23(0x222)])_0xcfffaf[_0x3abc23(0x246)]['bbPassword']='***';if(_0xcfffaf[_0x3abc23(0x246)]['telegramToken'])_0xcfffaf['settings'][_0x3abc23(0x191)]=_0x3abc23(0x19d);if(_0xcfffaf['settings'][_0x3abc23(0x247)])_0xcfffaf['settings'][_0x3abc23(0x247)]=null;_0x52395a=JSON['stringify'](_0xcfffaf,null,0x2);}if(_0x2ba9e5[_0x3abc23(0x2d6)]!=_0x3abc23(0x189))_0x7cf600[_0x3abc23(0x307)](_0x2ba9e5[_0x3abc23(0x2d6)],_0x52395a);}else _0x7cf600[_0x3abc23(0x307)](_0x2ba9e5[_0x3abc23(0x2d6)],_0x52395a);}});const _0x444113=_0x7cf600[_0x34d8cd(0x2dc)]({'base64':![],'compression':_0x34d8cd(0x17b)});fs[_0x34d8cd(0x275)](zippath+(_0x999b93+_0x34d8cd(0x317)),_0x444113,_0x34d8cd(0x21d));}async function unzipFile(_0x17615d,_0x503d17){const _0x41cb83=_0x386a01;fs[_0x41cb83(0x228)](configpath,{'withFileTypes':!![]})['forEach'](_0x421736=>{const _0x5cb0b2=_0x41cb83;if(!_0x421736[_0x5cb0b2(0x321)]())fs[_0x5cb0b2(0x210)](configpath+_0x421736['name']);});const _0xc155b8=fs[_0x41cb83(0x236)](_0x17615d+_0x503d17,_0x41cb83(0x21d)),_0x30f0e0=new require(_0x41cb83(0x2b8))(_0xc155b8,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x30f0e0[_0x41cb83(0x22f)])[_0x41cb83(0x1dc)](_0x597903=>{const _0x17c108=_0x41cb83,_0x549b6a=_0x30f0e0[_0x17c108(0x22f)][_0x597903];fs[_0x17c108(0x275)](configpath+_0x549b6a['name'],_0x549b6a[_0x17c108(0x15b)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x41cb83(0x1dc)](_0xff8b77=>{const _0x33cf9e=_0x41cb83;if(!_0xff8b77[_0x33cf9e(0x321)]())fs[_0x33cf9e(0x210)](temppath+_0xff8b77[_0x33cf9e(0x2d6)]);}),logger[_0x41cb83(0x25b)](_0x41cb83(0x194)),process[_0x41cb83(0x238)]({'restore':!![]},_0x26430a=>{});}async function getPublicIp(){const _0x5c5804=_0x386a01;try{const _0x19b5db=await axios[_0x5c5804(0x1a2)](_0x5c5804(0x1cb));publicip=_0x19b5db[_0x5c5804(0x276)]['ip'];}catch(_0x151584){}}async function triggerAnalytics(){const _0xdcdc9a=_0x386a01;if(!publicip)await getPublicIp();const _0x280d70=getBotsWithMode();let _0x35e87c=0x0;_0x280d70[_0xdcdc9a(0x1dc)](_0x3dbf2c=>{const _0x159fb1=_0xdcdc9a;if(_0x3dbf2c[_0x159fb1(0x1b8)]===_0x159fb1(0x27a))_0x35e87c++;});const _0x5f2736=getBotExchanges();mixpanel[_0xdcdc9a(0x270)](_0xdcdc9a(0x30c),{'distinct_id':settings[_0xdcdc9a(0x1f5)],'ip':publicip,'version':serverversion,'numbots':_0x280d70[_0xdcdc9a(0x27e)],'numbotsenabled':_0x35e87c,'exchanges':_0x5f2736});}async function getMessages(){const _0x392dda=_0x386a01,_0x5558d4='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4eb1df=new GraphQLClient(_0x5558d4),_0x254a0c={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x4aeb81=serverversion['split']('.'),_0x28a469=_0x4aeb81[0x0]+'.'+_0x4aeb81[0x1],_0x5da39d=Math[_0x392dda(0x268)](settings[_0x392dda(0x2bd)],settings[_0x392dda(0x30b)]),_0x48809b={'last':parseInt(_0x5da39d),'bbm':_0x28a469},_0x5b2546=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3f4cb3;try{_0x3f4cb3=await _0x4eb1df[_0x392dda(0x2ad)](_0x5b2546,_0x48809b,_0x254a0c);}catch(_0x1fd2c6){}if(_0x3f4cb3&&_0x3f4cb3[_0x392dda(0x310)]){let _0x31ae9f=settings[_0x392dda(0x2bd)];newMessages=[];for(const _0x5f53f3 of _0x3f4cb3[_0x392dda(0x310)]){newMessages['push'](_0x5f53f3);if(_0x5f53f3[_0x392dda(0x1f0)])updateSetting(_0x392dda(0x2e7),_0x5f53f3[_0x392dda(0x1f0)]);let _0x15e213=_0x5f53f3[_0x392dda(0x1f0)]?serverversion>=_0x5f53f3[_0x392dda(0x1f0)]:![];if(!_0x15e213&&_0x5f53f3[_0x392dda(0x218)]>_0x31ae9f){if(_0x5f53f3[_0x392dda(0x23d)]==='any'||serverversion['startsWith'](_0x5f53f3['bbvReceive'])){let _0x3a7652=''+_0x5f53f3[_0x392dda(0x216)]+'\x0a\x0a'+_0x5f53f3['message'];const _0x47ea07=await sendTelegramMsg(toTelegramMarkdown(_0x3a7652),_0x392dda(0x20e));if(_0x47ea07)_0x31ae9f=_0x5f53f3[_0x392dda(0x218)];}}}updateAvailable=isNewerVersion(settings[_0x392dda(0x2e7)],serverversion),updateSetting(_0x392dda(0x2bd),_0x31ae9f),emitMessages();}}function emitMessages(){const _0x3c7a4f=_0x386a01,_0x55cb70=settings['lastmsgemitted'];let _0x4e7f0a=[];newMessages[_0x3c7a4f(0x1dc)](_0x316426=>{const _0x4cc36d=_0x3c7a4f;_0x316426[_0x4cc36d(0x218)]>_0x55cb70&&_0x4e7f0a['push'](_0x316426);}),_0x4e7f0a[_0x3c7a4f(0x27e)]>0x0&&getAllClients()[_0x3c7a4f(0x1dc)](_0x208d0f=>{const _0x482866=_0x3c7a4f;getSocket(_0x208d0f['id'])[_0x482866(0x289)](_0x482866(0x29f),_0x4e7f0a);});}function confirmMessage(_0x5e795a){updateSetting('lastmsgemitted',Number(_0x5e795a));}function isNewerVersion(_0xe1e409,_0x2ab0e8){const _0x2a5cd8=_0x386a01,_0x5e13ee=_0x2ab0e8['split']('.'),_0x565a25=_0xe1e409['split']('.');for(var _0x184057=0x0;_0x184057<_0x565a25[_0x2a5cd8(0x27e)];_0x184057++){const _0x3446b4=~~_0x565a25[_0x184057],_0x216fd6=~~_0x5e13ee[_0x184057];if(_0x3446b4>_0x216fd6)return!![];if(_0x3446b4<_0x216fd6)return![];}return![];}function toTelegramMarkdown(_0x1e752d){const _0x386149=_0x386a01,_0x23d197=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x28bf9a=/\*{2}(.+?)\*{2}/gim;return _0x1e752d=_0x1e752d[_0x386149(0x1c6)](_0x23d197,_0x386149(0x254))[_0x386149(0x1c6)](_0x28bf9a,_0x386149(0x29c)),_0x1e752d;}async function validateConfigFile(){const _0x3088ea=_0x386a01,_0xd133a0=dbConfig[_0x3088ea(0x1a2)](_0x3088ea(0x1f2))[_0x3088ea(0x2a3)]('botID')[_0x3088ea(0x17e)]()||[];if(_0xd133a0[_0x3088ea(0x27e)]==0x0){let _0x1f4423=0x0,_0xea8300=[];const _0x2f912f=/^bot-([0-9]{3})-config.json$/,_0x515174=fs[_0x3088ea(0x228)](configpath);_0x515174[_0x3088ea(0x1dc)](_0x2d5fed=>{const _0x142fef=_0x3088ea,_0x193c93=_0x2f912f[_0x142fef(0x2bc)](_0x2d5fed);if(_0x193c93){const _0xb89d01=_0x193c93[0x1];let _0x38d4bd=getBotAttributes(_0xb89d01);_0xea8300[_0x142fef(0x293)]({'botID':_0xb89d01,'botname':_0x38d4bd[_0x142fef(0x175)],'status':_0x142fef(0x2c3),'live':'stopped'}),_0x1f4423++;}}),_0x1f4423!=0x0&&(dbConfig[_0x3088ea(0x1a2)](_0x3088ea(0x1f2))[_0x3088ea(0x18c)](_0xea8300)[_0x3088ea(0x2a4)](),config=_0xea8300,restoredConfigFile=_0x1f4423);}}async function restoreConfigNotify(_0x5f44f6){const _0x1562e3=_0x386a01;let _0x490958;if(restoredConfigFile==0x1)_0x490958=_0x1562e3(0x2c4);else _0x490958=_0x1562e3(0x1c5);if(_0x5f44f6)io['to'](_0x1562e3(0x2f7))[_0x1562e3(0x289)](_0x1562e3(0x2db),_0x490958);else{logger[_0x1562e3(0x2cb)](_0x1562e3(0x18d)),logger[_0x1562e3(0x2cb)](_0x490958),logger[_0x1562e3(0x2cb)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x1562e3(0x247)]&&settings[_0x1562e3(0x316)]!=_0x1562e3(0x1bb))tgBot['sendMessage'](settings[_0x1562e3(0x247)],'Bot\x20Mgr\x20>\x20'+_0x490958)[_0x1562e3(0x21f)](_0x1e6083=>{telegramError(_0x1e6083);});}}function validateCredentials(_0x2a28c6,_0x4c948f){const _0x521b17=_0x386a01;if(_0x2a28c6[_0x521b17(0x2fa)]==settings['bbUsername']&&bcrypt[_0x521b17(0x214)](_0x2a28c6['password'],settings[_0x521b17(0x222)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x521b17(0x181),'token':null};else{const _0x379496=generateLoginToken(_0x4c948f);return{'allow':!![],'reason':_0x521b17(0x229),'token':_0x379496};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x5b4a73){const _0x426248=_0x386a01,_0x2ec1fa=generateLoginToken(_0x5b4a73);return{'allow':!![],'reason':_0x426248(0x229),'token':_0x2ec1fa};}function validateAccess(_0x25accc,_0x2b6a9c,_0x895142){const _0xe0f7f0=_0x386a01,_0x6e41fc=_0x895142?_0x895142:devices[_0x2b6a9c]['ip'];let _0x3bd8b0;const _0x38a48c=_0x4c1913=>{const _0x24e39c=_0x2786;if(settings[_0x24e39c(0x282)]){if(settings[_0x24e39c(0x25e)]){if(telegram2FaApproved(_0x2b6a9c)){const _0x16e8eb=generateLoginToken(_0x2b6a9c);return{'allow':!![],'reason':_0x24e39c(0x1bf),'token':_0x16e8eb};}else return{'allow':![],'reason':_0x24e39c(0x180),'token':null};}else return _0x3bd8b0=validToken(_0x4c1913,_0x2b6a9c),_0x3bd8b0['hasOwnProperty'](_0x24e39c(0x1b5))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4c1913}:{'allow':![],'reason':_0x24e39c(0x180),'token':null};}else return{'allow':!![],'reason':_0x24e39c(0x28d),'token':null};};if(settings[_0xe0f7f0(0x17a)]){let _0x281cc1=[...settings[_0xe0f7f0(0x1df)],_0xe0f7f0(0x223),'::ffff:127.0.0.1',_0xe0f7f0(0x16b)];if(_0x281cc1[_0xe0f7f0(0x298)](_0x6e41fc))return _0x38a48c(_0x25accc);else{_0x3bd8b0=validToken(_0x25accc,_0x2b6a9c);if(_0x3bd8b0[_0xe0f7f0(0x280)]('success'))return _0x38a48c(_0x25accc);else{if(telegramIpApproved(_0x2b6a9c)){const _0x10b72b=generateToken(_0x2b6a9c);return _0x3bd8b0=_0x38a48c(_0x25accc),_0x3bd8b0[_0xe0f7f0(0x1e8)]?{'allow':!![],'reason':_0xe0f7f0(0x26a),'token':_0x10b72b}:_0x3bd8b0;}else return settings[_0xe0f7f0(0x1c0)]?{'allow':![],'reason':_0xe0f7f0(0x221),'token':null}:{'allow':![],'reason':_0xe0f7f0(0x29b),'token':null};}}}else return _0x38a48c(_0x25accc);}function timelyDecrypt(_0x33b556,_0x4d0bb9=!![]){const _0x51c7e8=_0x386a01;if(_0x33b556)try{const _0x1fffb1=crypt[_0x51c7e8(0x1d5)](secure[_0x51c7e8(0x1be)],_0x33b556)['message'],_0x28e2dd=_0x1fffb1[_0x51c7e8(0x22a)]('@')[0x0],_0x4f5b41=_0x1fffb1[_0x51c7e8(0x22a)]('@')[0x1],_0x4a53a6=new Date()['getTime']();if(_0x4d0bb9){if(_0x4a53a6-_0x4f5b41<maxSecretAge*0x3e8)return _0x28e2dd;else return![];}else return _0x28e2dd;}catch(_0x2104f4){return![];}else return![];}const validToken=(_0x501bb2,_0x4479e9)=>{const _0x207377=_0x386a01,_0x165fc5=devices[_0x4479e9]['ip'];if(!_0x501bb2)return{'error':_0x207377(0x232)};for(let _0x8a2fac of blacklist){if(_0x8a2fac['token']==_0x501bb2)return{'error':'Token\x20blacklisted'};}let _0x18fadd;try{_0x18fadd=jwt[_0x207377(0x15c)](_0x501bb2,secure['secret']+_0x4479e9);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x18fadd[_0x207377(0x280)](_0x207377(0x23f))&&!_0x18fadd[_0x207377(0x280)](_0x207377(0x2fa))||!_0x18fadd[_0x207377(0x280)](_0x207377(0x208)))return{'error':_0x207377(0x248)};if(!_0x18fadd[_0x207377(0x280)]('username')&&_0x18fadd[_0x207377(0x280)]('clientip')){const {clientip:_0x43622a}=_0x18fadd;return _0x165fc5==_0x43622a?{'success':_0x207377(0x1b6)}:{'error':_0x207377(0x225)};}else{if(_0x18fadd[_0x207377(0x280)]('username')&&_0x18fadd['hasOwnProperty'](_0x207377(0x23f))){const {username:_0x3654a5,clientip:_0x14bd77}=_0x18fadd;return settings[_0x207377(0x2f8)]==_0x3654a5&&_0x165fc5==_0x14bd77?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x207377(0x192)};}}},generateLoginToken=_0x291df6=>{const _0x5520b6=_0x386a01;if(_0x291df6){const _0x1b52ed=devices[_0x291df6]['ip'];return jwt[_0x5520b6(0x265)]({'username':settings[_0x5520b6(0x2f8)],'clientip':_0x1b52ed},secure[_0x5520b6(0x1ab)]+_0x291df6,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x29bd86=>{const _0x5b7d0b=_0x386a01;if(_0x29bd86){const _0x59a7ad=devices[_0x29bd86]['ip'];return jwt[_0x5b7d0b(0x265)]({'clientip':_0x59a7ad},secure[_0x5b7d0b(0x1ab)]+_0x29bd86,{'expiresIn':devices[_0x29bd86][_0x5b7d0b(0x1e5)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x517483=>{const _0x322424=_0x386a01;let _0x54c577=![];return devices[_0x517483][_0x322424(0x1e5)]&&devices[_0x517483][_0x322424(0x1e5)][_0x322424(0x325)]!=_0x322424(0x1fa)&&(_0x54c577=devices[_0x517483]['telegramIpApproval'][_0x322424(0x23f)]==devices[_0x517483]['ip']&&new Date()[_0x322424(0x323)]()-devices[_0x517483][_0x322424(0x1e5)][_0x322424(0x258)]<devices[_0x517483][_0x322424(0x1e5)][_0x322424(0x325)]*0x3c*0x3e8),_0x54c577;},telegram2FaApproved=_0x57f6fb=>{const _0x31348c=_0x386a01;let _0x1d579e=![];return devices[_0x57f6fb][_0x31348c(0x1d3)]&&devices[_0x57f6fb][_0x31348c(0x1d3)][_0x31348c(0x325)]!=_0x31348c(0x1fa)&&(_0x1d579e=devices[_0x57f6fb][_0x31348c(0x1d3)]['clientip']==devices[_0x57f6fb]['ip']&&new Date()[_0x31348c(0x323)]()-devices[_0x57f6fb][_0x31348c(0x1d3)][_0x31348c(0x258)]<devices[_0x57f6fb][_0x31348c(0x1d3)][_0x31348c(0x325)]*0x3c*0x3e8),_0x1d579e;},normalizeIP=_0x57d424=>{const _0x2bc755=_0x386a01;let _0x531d29=null,_0xde564=null;if(ipaddr[_0x2bc755(0x2d9)](_0x57d424)){const _0x1ea10f=ipaddr[_0x2bc755(0x2dd)](_0x57d424);_0x1ea10f[_0x2bc755(0x19b)]()===_0x2bc755(0x170)?(_0x1ea10f['isIPv4MappedAddress']()&&(_0x531d29=_0x1ea10f[_0x2bc755(0x2ea)]()[_0x2bc755(0x1f8)]()),_0xde564=_0x1ea10f[_0x2bc755(0x1f8)]()):(_0x531d29=_0x1ea10f[_0x2bc755(0x1f8)](),_0xde564=_0x1ea10f[_0x2bc755(0x2d1)]()[_0x2bc755(0x1f8)]());}return{'show':_0x531d29?_0x531d29:_0xde564,'store':_0xde564};};function formatDate(_0x3b49a7){const _0x5bd7b9=_0x386a01;return _0x3b49a7['getFullYear']()+'/'+(_0x3b49a7[_0x5bd7b9(0x31e)]()+0x1)[_0x5bd7b9(0x1f8)]()[_0x5bd7b9(0x25f)](0x2,'0')+'/'+_0x3b49a7[_0x5bd7b9(0x241)]()[_0x5bd7b9(0x1f8)]()['padStart'](0x2,'0')+'\x20'+_0x3b49a7[_0x5bd7b9(0x2e4)]()['toString']()['padStart'](0x2,'0')+':'+_0x3b49a7[_0x5bd7b9(0x1d7)]()['toString']()[_0x5bd7b9(0x25f)](0x2,'0')+':'+_0x3b49a7['getSeconds']()['toString']()['padStart'](0x2,'0');}function sleep(_0x5ad57d){return new Promise(_0x254ec7=>setTimeout(_0x254ec7,_0x5ad57d));}