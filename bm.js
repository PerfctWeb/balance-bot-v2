const _0x22bffb=_0xba24;(function(_0x10e74d,_0xed80ce){const _0x28a489=_0xba24,_0x2b5dcc=_0x10e74d();while(!![]){try{const _0x20dd5e=parseInt(_0x28a489(0x23d))/0x1*(-parseInt(_0x28a489(0x21f))/0x2)+parseInt(_0x28a489(0x2a7))/0x3*(parseInt(_0x28a489(0x24a))/0x4)+-parseInt(_0x28a489(0x110))/0x5*(parseInt(_0x28a489(0x15a))/0x6)+-parseInt(_0x28a489(0x241))/0x7*(parseInt(_0x28a489(0x1bd))/0x8)+parseInt(_0x28a489(0x119))/0x9*(parseInt(_0x28a489(0x2c1))/0xa)+-parseInt(_0x28a489(0x132))/0xb*(parseInt(_0x28a489(0x193))/0xc)+parseInt(_0x28a489(0x1c0))/0xd;if(_0x20dd5e===_0xed80ce)break;else _0x2b5dcc['push'](_0x2b5dcc['shift']());}catch(_0xffc52b){_0x2b5dcc['push'](_0x2b5dcc['shift']());}}}(_0x13ee,0x573b0));const _0x5eb81b=function(){let _0xe42abf=!![];return function(_0x4fdbea,_0x146b92){const _0x4fab26=_0xe42abf?function(){const _0x289e46=_0xba24;if(_0x146b92){const _0x3408ce=_0x146b92[_0x289e46(0x1bb)](_0x4fdbea,arguments);return _0x146b92=null,_0x3408ce;}}:function(){};return _0xe42abf=![],_0x4fab26;};}(),_0x47a26a=_0x5eb81b(this,function(){const _0x1d00e0=_0xba24;return _0x47a26a[_0x1d00e0(0x2ad)]()['search']('(((.+)+)+)+$')['toString']()['constructor'](_0x47a26a)[_0x1d00e0(0x216)](_0x1d00e0(0x1e8));});_0x47a26a();'use strict';process[_0x22bffb(0x1e0)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x22bffb(0x14e)),fs=require('fs'),fns=require(_0x22bffb(0x221)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x22bffb(0xfb)),Crypt=require('hybrid-crypto-js')[_0x22bffb(0x145)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x22bffb(0x276)),jwt=require('jsonwebtoken'),ipaddr=require(_0x22bffb(0x151)),argv=require(_0x22bffb(0x1f8))(process[_0x22bffb(0x102)][_0x22bffb(0x288)](0x2))[_0x22bffb(0x102)],uuidRandom=require(_0x22bffb(0x268)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x22bffb(0xf9)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x22bffb(0x217)),fileUpload=require(_0x22bffb(0x13b)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x22bffb(0x199)](_0x22bffb(0x2be)+PORT+_0x22bffb(0x297)),process[_0x22bffb(0x1c4)](0x1));const HOST=argv[_0x22bffb(0x20a)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions']['node'],environment=require('./version.json')['environment']||'production';let bbpath=_0x22bffb(0x1db),bbpath2='';const botfile='bot.js',configfile=_0x22bffb(0xf7),settingsfile=_0x22bffb(0x108),securefile=_0x22bffb(0x172),maxBackups=0xa;let validInstallation=!![];!fs[_0x22bffb(0x2aa)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x22bffb(0x1f9)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x22bffb(0x118),zippath=userID?bbpath+_0x22bffb(0x1d0)+userID+'/':bbpath+_0x22bffb(0x1d0),loggerfile=fs['createWriteStream'](logspath+_0x22bffb(0x18e),{'flags':'a'}),temppath=userID?bbpath+_0x22bffb(0x19a)+userID+'/':bbpath+_0x22bffb(0x19a);!fs[_0x22bffb(0x2aa)](configpath)&&fs[_0x22bffb(0x10f)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x22bffb(0x10f)](configbackuppath);!fs[_0x22bffb(0x2aa)](logspath)&&fs[_0x22bffb(0x10f)](logspath);!fs['existsSync'](zippath)&&fs[_0x22bffb(0x10f)](zippath);!fs[_0x22bffb(0x2aa)](temppath)&&fs[_0x22bffb(0x10f)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x22bffb(0x1d4)]({'bots':[]})[_0x22bffb(0x16c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x22bffb(0x1d4)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x22bffb(0x25d),'onepagemode':![]}})[_0x22bffb(0x16c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x22bffb(0x175)});const saltRounds=0xa,mixpanel=Mixpanel[_0x22bffb(0xfd)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x22bffb(0x1e6)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x22bffb(0x264)]!='')initTelegram();const parseColor=(_0x75c031,_0x4923c0)=>{const _0x540e51=_0x22bffb,_0x32d610=/#[A-Z]{3}#/g;if(typeof _0x75c031==_0x540e51(0x11d)){!_0x4923c0?_0x75c031=_0x75c031[_0x540e51(0x22e)](_0x32d610,''):(_0x75c031=_0x75c031['replace'](/#BLU#/g,_0x540e51(0x1cc)),_0x75c031=_0x75c031[_0x540e51(0x22e)](/#RED#/g,_0x540e51(0x1fe)),_0x75c031=_0x75c031[_0x540e51(0x22e)](/#YEL#/g,_0x540e51(0x1df)),_0x75c031=_0x75c031[_0x540e51(0x22e)](/#MAG#/g,_0x540e51(0xf4)),_0x75c031=_0x75c031['replace'](/#CYA#/g,_0x540e51(0x112)),_0x75c031=_0x75c031[_0x540e51(0x22e)](/#RES#/g,'\x1b[0m'));;}return _0x75c031;},logger={'screen':_0x18a77c=>{const _0x24cf80=_0x22bffb;console[_0x24cf80(0x199)](parseColor(_0x18a77c,!![]));},'simple':_0x5dd4f7=>{const _0x3ee0a8=_0x22bffb;console[_0x3ee0a8(0x199)](parseColor(_0x5dd4f7,!![])),loggerfile[_0x3ee0a8(0x16c)](util['format'](parseColor(_0x5dd4f7,![]))+'\x0a');},'full':async _0x58c56c=>{const _0x1099fd=_0x22bffb,_0x323d8c=getTimeStamp()+_0x1099fd(0x226)+_0x58c56c;console[_0x1099fd(0x199)](parseColor(_0x323d8c,!![])),loggerfile[_0x1099fd(0x16c)](util[_0x1099fd(0x26a)](parseColor(_0x323d8c,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x1099fd(0x105)]!=_0x1099fd(0x1af))await tgBot[_0x1099fd(0x230)](settings[_0x1099fd(0xef)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x58c56c,![]))[_0x1099fd(0x28b)](_0x47e062=>{telegramError(_0x47e062);});},'debug':async(_0x177190,_0x3ef3aa='')=>{const _0x48f565=_0x22bffb,_0x24833e=getTimeStamp()+_0x48f565(0x1ea)+_0x177190;if(debugging)console['log'](parseColor(_0x24833e,!![]));loggerfile['write'](util[_0x48f565(0x26a)](parseColor(_0x24833e,![]))+'\x0a');if(_0x3ef3aa){if(debugging)console['log'](_0x3ef3aa);loggerfile[_0x48f565(0x16c)](util['format'](_0x3ef3aa)+'\x0a');}}};process['on'](_0x22bffb(0x23c),function(_0x126eee){const _0x3cca45=_0x22bffb;logger[_0x3cca45(0x146)](_0x126eee);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x22bffb(0x186))[_0x22bffb(0x1b5)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x22bffb(0x14f)),app=express(),http=require('http')[_0x22bffb(0x154)](app);app[_0x22bffb(0x244)](fileUpload({'useTempFiles':!![]})),app[_0x22bffb(0x24b)](_0x22bffb(0x298),async(_0x3103ba,_0x1237a8)=>{const _0x15b7ef=_0x22bffb,_0x5bcefb=_0x3103ba[_0x15b7ef(0x1bc)]['type'],_0x3cae6a=getClientsWithBotID(_0x15b7ef(0x1f4)),_0x339722=_0x3103ba[_0x15b7ef(0x232)][_0x15b7ef(0x26b)],_0x49f701=timelyDecrypt(_0x339722,![]),_0x585301=_0x3cae6a['find'](_0x186d89=>_0x186d89[_0x15b7ef(0x26b)]==_0x49f701);if(_0x585301){const _0xa5156e=normalizeIP(_0x3103ba[_0x15b7ef(0x1ed)][_0x15b7ef(0x2b9)])[_0x15b7ef(0x152)],_0x390e1d=_0x3103ba[_0x15b7ef(0x232)][_0x15b7ef(0x1ec)];if(validateAccess(_0x390e1d,_0x49f701,_0xa5156e)['allow'])_0x5bcefb=='backup'&&await backupConfigFiles(),await zipFiles(_0x5bcefb),_0x1237a8[_0x15b7ef(0x12b)](zippath+(_0x5bcefb+_0x15b7ef(0x219)),_0x67aa1a=>{const _0x298c02=_0x15b7ef;_0x67aa1a&&(logger['full']('Failed\x20to\x20download\x20'+_0x5bcefb),logger[_0x298c02(0x146)](_0x67aa1a));});else logger[_0x15b7ef(0x1c9)](_0x15b7ef(0x188)+_0x5bcefb+_0x15b7ef(0x2b4));}else logger[_0x15b7ef(0x1c9)](_0x15b7ef(0x188)+_0x5bcefb+_0x15b7ef(0x22d));}),app[_0x22bffb(0x1e4)](_0x22bffb(0x2bf),async(_0x49e596,_0x37a274)=>{const _0x5e9688=_0x22bffb,_0x410886=getClientsWithBotID(_0x5e9688(0x1f4)),_0x35a90f=_0x49e596[_0x5e9688(0x232)][_0x5e9688(0x26b)],_0x303101=timelyDecrypt(_0x35a90f,![]),_0x6c1263=_0x410886[_0x5e9688(0x2ac)](_0x43e15b=>_0x43e15b[_0x5e9688(0x26b)]==_0x303101);logger[_0x5e9688(0x23b)](_0x5e9688(0x2a3));if(_0x6c1263){const _0x4907dd=normalizeIP(_0x49e596[_0x5e9688(0x1ed)]['remoteAddress'])[_0x5e9688(0x152)],_0x312cdd=_0x49e596[_0x5e9688(0x232)][_0x5e9688(0x1ec)];if(validateAccess(_0x312cdd,_0x303101,_0x4907dd)['allow']){if(_0x49e596['files']){const _0x4de099=_0x49e596[_0x5e9688(0x125)][_0x5e9688(0x2b8)];await _0x4de099['mv'](temppath+_0x4de099['name']),_0x37a274[_0x5e9688(0x17c)]({'status':!![],'message':_0x5e9688(0x164)});const _0x44ee97=getBotsWithMode();_0x44ee97[_0x5e9688(0x208)]>0x0?confirmRestore(temppath,_0x4de099[_0x5e9688(0x213)]):unzipFile(temppath,_0x4de099[_0x5e9688(0x213)]);}}else logger[_0x5e9688(0x1c9)](_0x5e9688(0x16a));}else logger[_0x5e9688(0x1c9)](_0x5e9688(0x242));}),app[_0x22bffb(0x244)](express['static'](path[_0x22bffb(0x24f)](__dirname,bbpath2,'build2'))),app['use'](express[_0x22bffb(0x13a)](path['join'](__dirname,bbpath2,_0x22bffb(0x22a)))),app[_0x22bffb(0x24b)]('/',function(_0x5237c8,_0xae3e53){const _0x308cbe=_0x22bffb;_0xae3e53[_0x308cbe(0x189)](path[_0x308cbe(0x24f)](__dirname,bbpath2,_0x308cbe(0x1e3),_0x308cbe(0x138)));}),app[_0x22bffb(0x24b)](_0x22bffb(0x24c),function(_0x5aab11,_0x59c303){const _0xdac7dd=_0x22bffb;_0x59c303[_0xdac7dd(0x189)](path[_0xdac7dd(0x24f)](__dirname,bbpath2,_0xdac7dd(0x22a),'index.html'));}),app[_0x22bffb(0x24b)](_0x22bffb(0x250),(_0x6bfd32,_0x526cc5)=>{const _0x57a885=_0x22bffb;_0x526cc5[_0x57a885(0x189)](path['join'](__dirname,bbpath2,_0x57a885(0x22a),_0x57a885(0x138)));}),app[_0x22bffb(0x24b)](_0x22bffb(0x19e),(_0x3e78df,_0x35772b)=>{const _0x4cd891=_0x22bffb;_0x35772b[_0x4cd891(0x189)](path[_0x4cd891(0x24f)](__dirname,bbpath2,'build',_0x4cd891(0x138)));}),app[_0x22bffb(0x24b)](_0x22bffb(0x15b),(_0x549ff1,_0x4ea522)=>{const _0x572bfa=_0x22bffb;_0x4ea522['sendFile'](path[_0x572bfa(0x24f)](__dirname,bbpath2,_0x572bfa(0x22a),_0x572bfa(0x138)));}),app[_0x22bffb(0x24b)](_0x22bffb(0x28c),(_0x130289,_0x3a35d7)=>{const _0xec3d47=_0x22bffb;_0x3a35d7[_0xec3d47(0x189)](path[_0xec3d47(0x24f)](__dirname,bbpath2,_0xec3d47(0x22a),_0xec3d47(0x138)));}),app['get'](_0x22bffb(0x293),(_0x1fa623,_0x3884dc)=>{const _0x22e19b=_0x22bffb;_0x3884dc['sendFile'](path[_0x22e19b(0x24f)](__dirname,bbpath2,_0x22e19b(0x22a),'index.html'));}),app[_0x22bffb(0x24b)](_0x22bffb(0x21a),(_0x10dddd,_0x20375e)=>{const _0x49ede5=_0x22bffb;_0x20375e['sendFile'](path[_0x49ede5(0x24f)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x22bffb(0x23f)](PORT,HOST);else http[_0x22bffb(0x23f)](PORT);const io=require(_0x22bffb(0x251))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2d66c6=_0x22bffb;let _0x311801=_0x2d66c6(0x18d);const _0x4870b2=networkInterfaces(),_0x32ae2f={};for(const _0x1ecc6b of Object[_0x2d66c6(0x166)](_0x4870b2)){for(const _0x302e0a of _0x4870b2[_0x1ecc6b]){if((_0x302e0a[_0x2d66c6(0xfe)]==_0x2d66c6(0x1aa)||_0x302e0a['family']==0x4)&&!_0x302e0a[_0x2d66c6(0x15f)]){const _0xc31cf6=ipaddr[_0x2d66c6(0x279)](_0x302e0a[_0x2d66c6(0x19b)])[_0x2d66c6(0x25e)]();_0xc31cf6!='private'&&(!_0x32ae2f[_0x1ecc6b]&&(_0x32ae2f[_0x1ecc6b]=[]),_0x32ae2f[_0x1ecc6b][_0x2d66c6(0x159)](_0x302e0a[_0x2d66c6(0x19b)]),_0x311801=_0x302e0a[_0x2d66c6(0x19b)]);}}}return{'serverip':_0x311801,'netinterfaces':_0x32ae2f};}async function startServer(){const _0x2ca6fc=_0x22bffb,{serverip:_0xbc71d5,netinterfaces:_0x464af4}=getServerIP();logger[_0x2ca6fc(0x146)](''),logger[_0x2ca6fc(0x146)](_0x2ca6fc(0x17a)),await logger[_0x2ca6fc(0x1c9)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x2ca6fc(0x211)+(environment==_0x2ca6fc(0xf3)?'(staging)':'')+'\x0a'+(_0x2ca6fc(0x114)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2ca6fc(0x29c)+_0xbc71d5+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x2ca6fc(0x146)](_0x2ca6fc(0x17a));if(config[_0x2ca6fc(0x208)]!=0x0)for(const _0x54f3ad of config){if(_0x54f3ad[_0x2ca6fc(0x10a)]==_0x2ca6fc(0x14d)||_0x54f3ad[_0x2ca6fc(0x10a)]=='new')await logger[_0x2ca6fc(0x1c9)](_0x2ca6fc(0x1e7)+_0x54f3ad['botID']+_0x2ca6fc(0xeb)+_0x54f3ad[_0x2ca6fc(0x20f)]),startBot([_0x54f3ad[_0x2ca6fc(0x1cf)],userID],{'cwd':bbpath},function(_0x4a4348){const _0x51049c=_0x2ca6fc;if(_0x4a4348)logger[_0x51049c(0x1c9)](_0x4a4348);});else(_0x54f3ad[_0x2ca6fc(0x10a)]==_0x2ca6fc(0x21c)||_0x54f3ad[_0x2ca6fc(0x10a)]==_0x2ca6fc(0x18f))&&await logger[_0x2ca6fc(0x1c9)](_0x2ca6fc(0x20d)+_0x54f3ad[_0x2ca6fc(0x1cf)]+_0x2ca6fc(0xeb)+_0x54f3ad[_0x2ca6fc(0x20f)]);}else!newBot&&logger[_0x2ca6fc(0x146)](_0x2ca6fc(0x299));if(newBot)addBot();logger[_0x2ca6fc(0x146)](_0x2ca6fc(0x17a)),logger['simple'](''),await logger['debug'](_0x2ca6fc(0x29b)+nodeversion),await logger[_0x2ca6fc(0x23b)](_0x2ca6fc(0x1cd),_0x464af4);}function startSocket(){const _0x439ca6=_0x22bffb;io['on'](_0x439ca6(0x177),_0x57a91a=>{const _0xc66b55=_0x439ca6;let _0x5d92fe,_0x26d909,_0x1afefd,_0x3eac2d,_0x3bcbf3;const _0x5d2183=_0x57a91a[_0xc66b55(0x16b)]['headers'][_0xc66b55(0x239)];_0x26d909=_0x5d2183['match'](/bot[0-9]{3}/);if(_0x26d909)_0x1afefd=_0x26d909[0x0][_0xc66b55(0xf8)](/[0-9]{3}/);if(_0x1afefd)_0x5d92fe=_0x1afefd[0x0];else _0x5d92fe=_0xc66b55(0x1f4);const _0x1acefb=_0x57a91a[_0xc66b55(0x16b)][_0xc66b55(0x25b)]['encryptedUuid'];if(!_0x1acefb)_0x57a91a[_0xc66b55(0x13f)](_0xc66b55(0x10a),{'publicKey':secure[_0xc66b55(0x25a)]});else{_0x3eac2d=timelyDecrypt(_0x1acefb,![]);if(!_0x3eac2d)_0x57a91a[_0xc66b55(0x13f)](_0xc66b55(0x10a),{'publicKey':secure[_0xc66b55(0x25a)]});else{_0x3bcbf3=normalizeIP(_0x57a91a['conn'][_0xc66b55(0x2b9)])['store'];if(!devices[_0x3eac2d])devices[_0x3eac2d]={'uuid':_0x3eac2d,'access':{'token':null}};devices[_0x3eac2d]['ip']=_0x3bcbf3;const _0x262d06=addClient(_0x57a91a['id'],_0x3eac2d,_0x5d92fe);setAccess(_0x262d06),emitMessages(),_0x57a91a['on'](_0xc66b55(0x27a),_0x2bce24=>{const _0x57a691=_0xc66b55,_0x4f5b4a=timelyDecrypt(_0x2bce24[_0x57a691(0x29f)]);if(_0x4f5b4a){_0x2bce24={'username':_0x2bce24[_0x57a691(0x163)],'password':_0x4f5b4a},devices[_0x3eac2d]['access']=validateCredentials(_0x2bce24,_0x3eac2d);if(devices[_0x3eac2d][_0x57a691(0x290)]['allow']==![]&&devices[_0x3eac2d]['access'][_0x57a691(0x19c)]==_0x57a691(0xf6))_0x57a91a[_0x57a691(0x13f)](_0x57a691(0x10a),{'access':devices[_0x3eac2d][_0x57a691(0x290)]}),loginAccess2FA(_0x3eac2d,_0x3bcbf3);else{if(devices[_0x3eac2d]['access'][_0x57a691(0x225)]==![]&&devices[_0x3eac2d][_0x57a691(0x290)][_0x57a691(0x19c)]==_0x57a691(0x187))_0x57a91a[_0x57a691(0x13f)](_0x57a691(0x10a),{'access':devices[_0x3eac2d][_0x57a691(0x290)]});else devices[_0x3eac2d]['access'][_0x57a691(0x225)]&&devices[_0x3eac2d][_0x57a691(0x290)][_0x57a691(0x19c)]==_0x57a691(0x137)&&(getClientsWithUuid(_0x3eac2d)['forEach'](_0x51e53c=>{setAccess(_0x51e53c);}),logger[_0x57a691(0x23b)](_0x57a691(0x144)+_0x3eac2d[_0x57a691(0x288)](-0x8)),setTokenRefresh(_0x3eac2d),setSessionTimeout(_0x57a691(0x27a),_0x3eac2d));}}else logger[_0x57a691(0x1c9)](_0x57a691(0x284));}),_0x57a91a['on'](_0xc66b55(0x25f),()=>{resetPassword();}),_0x57a91a['on'](_0xc66b55(0x270),_0x1fd55a=>{removeClient(_0x57a91a['id']);}),_0x5d92fe==_0xc66b55(0x1f4)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x33bdca){const _0x471422=_0x22bffb;if(_0x33bdca!=_0x471422(0x1f4)&&config[_0x471422(0x158)]!=''){if(pid[_0x33bdca])pid[_0x33bdca]['send']({'function':'initclient','args':null});}_0x33bdca!=_0x471422(0x1f4)&&broadcastToBots(_0x471422(0x24e),JSON[_0x471422(0x196)](config));}function reloadBotManager(){const _0x4aa034=_0x22bffb;getClientsWithBotID('botmanager')[_0x4aa034(0x135)](_0x38fe37=>{const _0x1d2916=_0x4aa034;getSocket(_0x38fe37['id'])['emit'](_0x1d2916(0x10a),{'access':{'allow':![],'reason':_0x1d2916(0x1b4),'token':null}});});}function getSocket(_0x3f7462){const _0xb965c7=_0x22bffb;return io[_0xb965c7(0x256)][_0xb965c7(0x256)][_0xb965c7(0x24b)](_0x3f7462);}function _0x13ee(){const _0x5364b5=['Unauthorized\x20attempt\x20to\x20get\x20events','privateKey','download','***','generate','\x20|\x20user:\x20...','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20delete\x20bot','bbvReceive','363550CbQkqy','mode','removeListener','forEach','fork','login\x20token\x20generated','index.html','readdirSync','static','express-fileupload','_data','headless','\x20|\x20client:\x20...','emit','alias','binary','Starting\x20Balance\x20Bot\x20update','lastmsgtelegram','Logged\x20in\x20user\x20...','Crypt','simple','get-messages','cancel-loading','readFileSync','reset-history','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Invalid\x20username\x20or\x20IP\x20address','enabled','child_process','express','$1_$2_$3','ipaddr.js','store','deleteHistoryAlerts','createServer','file','temporary\x20access\x20timeout','/help\x20-\x20show\x20available\x20commands\x0a','apiKey','push','42KHdnJJ','/:bot/coins','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','live','Session\x20expired\x20for\x20user\x20...','internal','Password\x20has\x20been\x20reset\x20to:\x20','hasOwnProperty','success','username','File\x20uploaded','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','keys','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','handshake','write','/disable\x20-\x20disable\x20notifications\x0a','exec','hashSync','Password\x20reset\x20rejected','timeshift','bb-secure.json','2FA','bot-','RSA-OAEP','telegram2FaApproval','connection','entries','get-portfolio','-----------------------------------------------------------------------------------','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','send','show','restart','value','Your\x20installation\x20is\x20already\x20up\x20to\x20date','ipc','User\x20has\x20been\x20validated','</b>\x20?','Invalid\x20Telegram\x20token','running','version.json','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20download\x20','sendFile','telegramIpApproval','randomFillSync','blacklist','[ip-address]','/output-000.log','new-disabled','store-settings','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','notification','24MvbkaX','bbPassword','access\x20timeout','stringify','mtime','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','log','temp/','address','reason','get-starting-balances','/:bot/performance','/off\x20-\x20stop\x20bot(s)\x0a','data','bbvNew','storeHeadless','filter','compareSync','Orders','connected','all','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','1000','IPv4','/metrics\x20-\x20show\x20bot\x20performance\x0a','logout','whitelist','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','orders','Unauthorized\x20attempt\x20to\x20log\x20out','order','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','type','reload','version','any','lastmsgemitted','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','split','127.0.0.1','apply','params','328NPMvFB','\x20mode','backup','13843830gpcIjT','toggleBotMode','You\x20can\x20use\x20the\x20following\x20commands:\x0a','store-configuration','exit','then','getMonth','store-headless','update-bb','full','clientip','randomBytes','\x1b[34m','Network\x20Interfaces:','includes','botID','zip/','stop','No\x20bots\x20running\x20right\x20now','delete-bot','defaults','number','-performance.json','Backup\x20file\x20unzipped\x20and\x20stored','output-001.log','SIGTERM','test','bb/','login\x20required','backup-files','login\x20token\x20valid','\x1b[33m','env','from','f2aRequired','build2','post','kill','telegramToken','Starting\x20bot\x20|\x20Bot\x20','(((.+)+)+)+$','logs',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','tkn','socket','settings.','sign','bot','Restarting\x20Bot\x20','logged\x20out','/on\x20-\x20start\x20bot(s)\x0a','botmanager','timestamp','isValid','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','yargs/yargs','clients','Unauthorized\x20attempt\x20to\x20update\x20bot','temporaryAccessAllowed','************','Bot\x20','\x1b[31m','Logged\x20out\x20user\x20...','storeFiat','remove','add-bot','backup-full.zip','token','writeFileSync','Invalid\x20authentication\x20token\x20(2)','\x20to\x20','length','Error\x20removing\x20old\x20backup\x20files:','host','copyFileSync','stopped','Idling\x20bot\x20\x20\x20|\x20Bot\x20','accept','botname','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','#RES#\x20','update','name','answerCallbackQuery','manual','search','util','request','.zip','/:bot/support','Restore\x20process\x20aborted','disabled','startsWith','size','2376VCqZvV','apiSecret','date-fns','output-002.log','resetHistory','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','allow',':\x20Bot\x20Mgr\x20>\x20','Ok,\x20will\x20send\x20alert\x20notifications\x20only','settings','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','build','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','2FA\x20login\x20token\x20generated','\x20(2)','replace','5\x20min','sendMessage','Unauthorized\x20attempt\x20to\x20get\x20messages','headers','hex','pidExpireLogin','exp','-config.json','title','/status\x20-\x20show\x20bot(s)\x20status\x0a','referer','once','debug','uncaughtException','456XjmkwF','store-fiat','listen','new','44877soiFsV','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','storeConfiguration','use','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','30\x20min','polling_error','::1','args','4IbMfuL','get','/:bot','function','bots','join','/:bot/portfolio','socket.io','inherit','Notifications\x20enabled','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Notifications\x20enabled\x0a','sockets','removeAllListeners','confirm-message','apiPassword','publicKey','auth','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','0.0.0','range','reset-password','pidRefreshToken','SIGINT','whitelistEnabled','decrypt','telegramUsername','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','unlinkSync','generateKeyPairAsync','uuid-random','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','format','uuid','Ok,\x20will\x20send\x20order\x20notifications\x20only','verify','loginRequired','getMinutes','disconnect','isDirectory','reject','show-config','All','Deleted\x20Bot\x20','bcryptjs','backup-full','<b>Balance\x20Bot\x20Status:</b>\x0a','parse','login','temporary\x20access\x20not\x20allowed','update-bot','error','node-zip','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getTime','event','output-000.log','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20login\x20attempt\x20(timeout)','rmSync','Yes','telegramEnabled','slice','telegram','server','catch','/:bot/history','onepagemode','Restoring\x20bot(s)\x20from\x20backup','::ffff:127.0.0.1','access','message','Unauthorized\x20attempt\x20to\x20confirm\x20message','/:bot/configuration','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','stopPolling',',\x20must\x20be\x20a\x204\x20digit\x20number','/download/:type','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20show\x20configuration','Node.js\x20v','=>\x20Go\x20to\x20#CYA#http://','assign','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','password','getFullYear','-events.json','\x20minutes','Backup\x20file\x20uploaded','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','getUTCHours','Unauthorized\x20attempt\x20to\x20delete\x20alerts','1018056nziBsb','Setting\x20access:\x20','<b>Telegram\x20Bot\x20Status:</b>\x0a','existsSync','chat','find','toString','login\x20not\x20required','Login\x20rejected','Access\x20enabled\x20for\x20','404\x20Not\x20Found','userid','statSync','\x20(1)','onText','restore-backup-file','expiry','backupfile','remoteAddress','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','callback_query','cancelLoading','telegrammsg','Error:\x20Invalid\x20argument\x20','/upload-backup','endsWith','20MJCWgh','output-003.log','reinstall','Unauthorized\x20attempt\x20to\x20store\x20configuration','2FA\x20required','-results.json','\x20|\x20','latestversion','Bot\x20Mgr\x20>\x20','sort','telegramChatId','secret','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','\x20>\x20','staging','\x1b[35m','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','2FA\x20login\x20required','bb-config.json','match','axios','messages','crypto','padStart','init','family','backup-full@','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Server','argv','auto','yes','telegramEvents','Disabled\x20Bot\x20','sortBy','bb-settings.json','exchange','status','alerts','getDate','/restart\x20-\x20restart\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','mkdirSync','424895oDijPg','getSeconds','\x1b[36m','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','delete-alerts','Notifications\x20types:\x20','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','logs/','1883547YaGbRE','HTML','warning','get-backup-files','string','bbUsername','getPortfolio','All\x20bots','15\x20min','set','DEFLATE','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','files','getHours','Unauthorized\x20attempt\x20to\x20add\x20bot','temporary\x20access\x20rejected'];_0x13ee=function(){return _0x5364b5;};return _0x13ee();}function setAccess(_0x5c0ccf){const _0x2e9b9e=_0x22bffb,_0xa4e2ce=getSocket(_0x5c0ccf['id']),_0x41b22e=_0x5c0ccf['uuid'],_0x4b1334=_0x5c0ccf[_0x2e9b9e(0x1f0)];devices[_0x41b22e][_0x2e9b9e(0x290)]=validateAccess(devices[_0x41b22e][_0x2e9b9e(0x290)][_0x2e9b9e(0x204)],_0x41b22e),logger[_0x2e9b9e(0x23b)](_0x2e9b9e(0x2a8)+devices[_0x41b22e]['access'][_0x2e9b9e(0x19c)]+_0x2e9b9e(0x13e)+_0x5c0ccf['id'][_0x2e9b9e(0x288)](-0x8)+_0x2e9b9e(0x12e)+_0x41b22e[_0x2e9b9e(0x288)](-0x8)),_0xa4e2ce[_0x2e9b9e(0x24f)](_0x41b22e);if(devices[_0x41b22e][_0x2e9b9e(0x290)][_0x2e9b9e(0x225)]){_0xa4e2ce[_0x2e9b9e(0x24f)](_0x4b1334);if(_0x4b1334=='botmanager')initializeSocketBotManager(_0xa4e2ce);else initializeSocketBot(_0xa4e2ce);initClient(_0x4b1334);}devices[_0x41b22e][_0x2e9b9e(0x290)][_0x2e9b9e(0x204)]&&devices[_0x41b22e][_0x2e9b9e(0x290)][_0x2e9b9e(0x19c)]==_0x2e9b9e(0x12f)&&setSessionTimeout(_0x2e9b9e(0x173),_0x41b22e),devices[_0x41b22e][_0x2e9b9e(0x290)]['token']&&devices[_0x41b22e][_0x2e9b9e(0x290)][_0x2e9b9e(0x19c)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x2e9b9e(0x27a),_0x41b22e),_0xa4e2ce[_0x2e9b9e(0x13f)]('status',{'status':_0x5c0ccf[_0x2e9b9e(0x28a)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x41b22e]['access'],'externalip':devices[_0x41b22e]['ip'],'publicKey':secure[_0x2e9b9e(0x25a)],'userid':settings[_0x2e9b9e(0x2b2)],'validInstallation':validInstallation}),devices[_0x41b22e][_0x2e9b9e(0x290)][_0x2e9b9e(0x225)]==![]&&devices[_0x41b22e][_0x2e9b9e(0x290)]['reason']==_0x2e9b9e(0xe9)&&temporaryAccess2FA(_0x41b22e,devices[_0x41b22e]['ip']);}function setSessionTimeout(_0x2dcb14,_0x522b9c){const _0x4b7267=_0x22bffb;let _0xba612;if(_0x2dcb14=='login')_0xba612=loginExpiry*0x3c*0x3e8;else _0xba612=devices[_0x522b9c][_0x4b7267(0x18a)][_0x4b7267(0x2b7)]*0x3c*0x3e8-(new Date()[_0x4b7267(0x280)]()-devices[_0x522b9c]['telegramIpApproval'][_0x4b7267(0x1f5)]);if(devices[_0x522b9c][_0x4b7267(0x234)])clearTimeout(devices[_0x522b9c]['pidExpireLogin']);devices[_0x522b9c]['pidExpireLogin']=setTimeout(()=>{const _0x18859b=_0x4b7267;if(devices[_0x522b9c][_0x18859b(0x260)])clearTimeout(devices[_0x522b9c][_0x18859b(0x260)]);removeSocketListeners(_0x522b9c),addBlacklist(_0x522b9c),devices[_0x522b9c][_0x18859b(0x18a)]=null,devices[_0x522b9c][_0x18859b(0x176)]=null,devices[_0x522b9c][_0x18859b(0x290)][_0x18859b(0x204)]=null,logger['debug'](_0x18859b(0x15e)+_0x522b9c[_0x18859b(0x288)](-0x8)),devices[_0x522b9c]['access']=validateAccess(devices[_0x522b9c][_0x18859b(0x290)][_0x18859b(0x204)],_0x522b9c),!(devices[_0x522b9c]['access']['allow']&&devices[_0x522b9c]['access']['reason']=='login\x20not\x20required')&&(_0x2dcb14=='login'?io['to'](_0x522b9c)[_0x18859b(0x13f)](_0x18859b(0x10a),{'access':{'allow':![],'reason':_0x18859b(0x195),'token':null}}):io['to'](_0x522b9c)[_0x18859b(0x13f)](_0x18859b(0x10a),{'access':{'allow':![],'reason':_0x18859b(0x156),'token':null}})),devices[_0x522b9c][_0x18859b(0x290)][_0x18859b(0x204)]=null;},_0xba612);}function setTokenRefresh(_0x3b9aa7){const _0xc1ae5c=_0x22bffb;if(devices[_0x3b9aa7][_0xc1ae5c(0x260)])clearTimeout(devices[_0x3b9aa7][_0xc1ae5c(0x260)]);devices[_0x3b9aa7][_0xc1ae5c(0x260)]=setTimeout(()=>{const _0xa4d277=_0xc1ae5c;getClientsWithUuid(_0x3b9aa7)[_0xa4d277(0x208)]!=0x0?(devices[_0x3b9aa7][_0xa4d277(0x290)]=refreshToken(_0x3b9aa7),io['to'](_0x3b9aa7)[_0xa4d277(0x13f)](_0xa4d277(0x10a),{'status':_0xa4d277(0x1a6),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3b9aa7][_0xa4d277(0x290)],'externalip':devices[_0x3b9aa7]['ip'],'publicKey':secure[_0xa4d277(0x25a)],'validInstallation':validInstallation}),setTokenRefresh(_0x3b9aa7)):clearTimeout(devices[_0x3b9aa7][_0xa4d277(0x260)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x406b7c){const _0x50a580=_0x22bffb,_0x5eb7e9=getClient(_0x406b7c['id'])[_0x50a580(0x26b)];_0x406b7c[_0x50a580(0x13f)]('bots',config),_0x406b7c[_0x50a580(0x13f)](_0x50a580(0x228),cleanSettings()),_0x406b7c['on'](_0x50a580(0x202),_0x18366b=>{const _0x34d4f9=_0x50a580;if(validateAccess(_0x18366b,_0x5eb7e9)[_0x34d4f9(0x225)])addBot();else logger['full'](_0x34d4f9(0x127));}),_0x406b7c['on'](_0x50a580(0x27c),(_0x34aa86,_0x185cc4)=>{const _0x48afa3=_0x50a580;if(validateAccess(_0x185cc4,_0x5eb7e9)[_0x48afa3(0x225)])toggleBot(_0x34aa86[_0x48afa3(0x1cf)],_0x34aa86[_0x48afa3(0x10a)],_0x34aa86[_0x48afa3(0x15d)]);else logger[_0x48afa3(0x1c9)](_0x48afa3(0x1fa));}),_0x406b7c['on']('toggle-bot-mode',(_0x31d6c3,_0x2a8273)=>{const _0x39b185=_0x50a580;if(validateAccess(_0x2a8273,_0x5eb7e9)[_0x39b185(0x225)])toggleBotMode(_0x31d6c3);else logger[_0x39b185(0x1c9)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x406b7c['on'](_0x50a580(0x1d3),(_0x29102a,_0x26f871)=>{const _0x2ba779=_0x50a580;if(validateAccess(_0x26f871,_0x5eb7e9)['allow'])deleteBot(_0x29102a);else logger[_0x2ba779(0x1c9)](_0x2ba779(0x130));}),_0x406b7c['on'](_0x50a580(0x190),(_0x377b06,_0xfbd171)=>{const _0x5cf7af=_0x50a580;if(validateAccess(_0xfbd171,_0x5eb7e9)[_0x5cf7af(0x225)])storeSettings(_0x377b06,!![]);else logger[_0x5cf7af(0x1c9)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x406b7c['on'](_0x50a580(0x1c8),_0x30c131=>{const _0xd383ba=_0x50a580;if(validateAccess(_0x30c131,_0x5eb7e9)['allow'])updateBB(_0xd383ba(0x212));else logger['full'](_0xd383ba(0x15c));}),_0x406b7c['on']('reinstall-bb',_0x3e4ee1=>{const _0x2ca50a=_0x50a580;if(validateAccess(_0x3e4ee1,_0x5eb7e9)[_0x2ca50a(0x225)])updateBB(_0x2ca50a(0xe7));else logger[_0x2ca50a(0x1c9)](_0x2ca50a(0x169));}),_0x406b7c['on'](_0x50a580(0x11c),_0x19272d=>{const _0x5f3650=_0x50a580;if(validateAccess(_0x19272d,_0x5eb7e9)['allow']){const _0x27aac9=getClient(_0x406b7c['id']);if(_0x27aac9)getBackupFiles(_0x27aac9[_0x5f3650(0x26b)]);else logger[_0x5f3650(0x1c9)](_0x5f3650(0x1eb));}else logger[_0x5f3650(0x1c9)](_0x5f3650(0x117));}),_0x406b7c['on'](_0x50a580(0x2b6),(_0x5533e1,_0x3534f8)=>{const _0x1c08f9=_0x50a580;if(validateAccess(_0x3534f8,_0x5eb7e9)[_0x1c08f9(0x225)])restoreBackupFile(_0x5533e1);else logger['full'](_0x1c08f9(0x22b));}),_0x406b7c['on'](_0x50a580(0x147),_0x17a13a=>{const _0x34e89a=_0x50a580;if(validateAccess(_0x17a13a,_0x5eb7e9)[_0x34e89a(0x225)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x406b7c['on'](_0x50a580(0x258),(_0x305be6,_0x562a3d)=>{const _0x29bdf8=_0x50a580;if(validateAccess(_0x562a3d,_0x5eb7e9)[_0x29bdf8(0x225)])confirmMessage(_0x305be6);else logger['full'](_0x29bdf8(0x292));}),_0x406b7c['on'](_0x50a580(0x1ac),_0x537f90=>{const _0x76a940=_0x50a580;if(validateAccess(_0x537f90,_0x5eb7e9)[_0x76a940(0x225)]){if(devices[_0x5eb7e9][_0x76a940(0x260)])clearTimeout(devices[_0x5eb7e9][_0x76a940(0x260)]);if(devices[_0x5eb7e9][_0x76a940(0x234)])clearTimeout(devices[_0x5eb7e9][_0x76a940(0x234)]);removeSocketListeners(getClient(_0x406b7c['id'])[_0x76a940(0x26b)]),addBlacklist(_0x5eb7e9),devices[_0x5eb7e9][_0x76a940(0x18a)]=null,devices[_0x5eb7e9]['telegram2FaApproval']=null,devices[_0x5eb7e9][_0x76a940(0x290)][_0x76a940(0x204)]=null,logger[_0x76a940(0x23b)](_0x76a940(0x1ff)+_0x5eb7e9[_0x76a940(0x288)](-0x8)),io['to'](getClient(_0x406b7c['id'])[_0x76a940(0x26b)])[_0x76a940(0x13f)](_0x76a940(0x10a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x76a940(0x1b0));});}function initializeSocketBot(_0x5b12eb){const _0x136d8b=_0x22bffb,_0x4df1be=getClient(_0x5b12eb['id'])[_0x136d8b(0x1f0)],_0x4b0de9=getClient(_0x5b12eb['id'])['uuid'];_0x5b12eb['on']('get-logs',(_0x34605d,_0x390dd8)=>{const _0x5e4f2f=_0x136d8b;if(validateAccess(_0x390dd8,_0x4b0de9)['allow']){if(pid[_0x4df1be])pid[_0x4df1be][_0x5e4f2f(0x17c)]({'function':'emitHistory','args':_0x34605d});}else logger[_0x5e4f2f(0x1c9)](_0x5e4f2f(0x129));}),_0x5b12eb['on'](_0x136d8b(0x115),(_0x3884a7,_0x4d21fb)=>{const _0x142c58=_0x136d8b;if(validateAccess(_0x4d21fb,_0x4b0de9)[_0x142c58(0x225)]){if(pid[_0x4df1be])pid[_0x4df1be][_0x142c58(0x17c)]({'function':_0x142c58(0x153),'args':_0x3884a7});}else logger[_0x142c58(0x1c9)](_0x142c58(0x2a6));}),_0x5b12eb['on'](_0x136d8b(0x179),(_0x25eccb,_0x10d817)=>{const _0x1061f0=_0x136d8b;if(validateAccess(_0x10d817,_0x4b0de9)['allow']){if(pid[_0x4df1be])pid[_0x4df1be][_0x1061f0(0x17c)]({'function':_0x1061f0(0x11f),'args':_0x25eccb});}else logger[_0x1061f0(0x1c9)](_0x1061f0(0x283));}),_0x5b12eb['on'](_0x136d8b(0x1c3),(_0x3c0cca,_0x52d5ec)=>{const _0x278a87=_0x136d8b;if(validateAccess(_0x52d5ec,_0x4b0de9)['allow']){if(pid[_0x4df1be])pid[_0x4df1be][_0x278a87(0x17c)]({'function':_0x278a87(0x243),'args':_0x3c0cca});}else logger[_0x278a87(0x1c9)](_0x278a87(0xe8));}),_0x5b12eb['on'](_0x136d8b(0x1c7),(_0x2c7efd,_0x5a4422)=>{const _0x319bca=_0x136d8b;if(validateAccess(_0x5a4422,_0x4b0de9)['allow']){if(pid[_0x4df1be])pid[_0x4df1be][_0x319bca(0x17c)]({'function':_0x319bca(0x1a2),'args':_0x2c7efd});}else logger[_0x319bca(0x1c9)](_0x319bca(0x229));}),_0x5b12eb['on'](_0x136d8b(0x23e),(_0x4226f0,_0x108b96)=>{const _0x5b56f9=_0x136d8b;if(validateAccess(_0x108b96,_0x4b0de9)[_0x5b56f9(0x225)]){if(pid[_0x4df1be])pid[_0x4df1be][_0x5b56f9(0x17c)]({'function':_0x5b56f9(0x200),'args':_0x4226f0});}else logger[_0x5b56f9(0x1c9)](_0x5b56f9(0x29e));}),_0x5b12eb['on'](_0x136d8b(0x14a),_0x281ad4=>{const _0xa8fa66=_0x136d8b;if(validateAccess(_0x281ad4,_0x4b0de9)['allow']){if(pid[_0x4df1be])pid[_0x4df1be][_0xa8fa66(0x17c)]({'function':_0xa8fa66(0x223),'args':null});}else logger[_0xa8fa66(0x1c9)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x5b12eb['on'](_0x136d8b(0x19d),_0x1d335e=>{const _0x4c6ca9=_0x136d8b;if(validateAccess(_0x1d335e,_0x4b0de9)[_0x4c6ca9(0x225)]){if(pid[_0x4df1be])pid[_0x4df1be][_0x4c6ca9(0x17c)]({'function':'getStartingBalances','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x5b12eb['on']('place-order',(_0x20c41b,_0x1245c6)=>{const _0x41d28d=_0x136d8b;if(validateAccess(_0x1245c6,_0x4b0de9)[_0x41d28d(0x225)]){if(pid[_0x4df1be])pid[_0x4df1be][_0x41d28d(0x17c)]({'function':'placeOrder','args':_0x20c41b});}else logger[_0x41d28d(0x1c9)](_0x41d28d(0x1f7));}),_0x5b12eb['on'](_0x136d8b(0x148),_0x14fede=>{const _0x687340=_0x136d8b;if(validateAccess(_0x14fede,_0x4b0de9)['allow']){if(pid[_0x4df1be])pid[_0x4df1be][_0x687340(0x17c)]({'function':_0x687340(0x2bc),'args':null});}else logger[_0x687340(0x1c9)](_0x687340(0x269));}),_0x5b12eb['on'](_0x136d8b(0x273),_0x40a0e8=>{const _0xdbfa96=_0x136d8b;if(validateAccess(_0x40a0e8,_0x4b0de9)[_0xdbfa96(0x225)]){if(pid[_0x4df1be])pid[_0x4df1be][_0xdbfa96(0x17c)]({'function':'showConfig','args':null});}else logger['full'](_0xdbfa96(0x29a));}),_0x5b12eb['on'](_0x136d8b(0x1c8),_0x357e32=>{const _0x16864a=_0x136d8b;if(validateAccess(_0x357e32,_0x4b0de9)[_0x16864a(0x225)])updateBB(_0x16864a(0x212));else logger[_0x16864a(0x1c9)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5b12eb['on'](_0x136d8b(0x147),_0x9f2bc2=>{const _0x2586fd=_0x136d8b;if(validateAccess(_0x9f2bc2,_0x4b0de9)['allow'])getMessages();else logger['full'](_0x2586fd(0x231));}),_0x5b12eb['on'](_0x136d8b(0x258),(_0x5eebda,_0x503db8)=>{const _0x12bbb7=_0x136d8b;if(validateAccess(_0x503db8,_0x4b0de9)[_0x12bbb7(0x225)])confirmMessage(_0x5eebda);else logger[_0x12bbb7(0x1c9)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x5b12eb['on'](_0x136d8b(0x1ac),_0x24be15=>{const _0x1eb402=_0x136d8b;if(validateAccess(_0x24be15,_0x4b0de9)[_0x1eb402(0x225)]){if(devices[_0x4b0de9][_0x1eb402(0x260)])clearTimeout(devices[_0x4b0de9][_0x1eb402(0x260)]);if(devices[_0x4b0de9][_0x1eb402(0x234)])clearTimeout(devices[_0x4b0de9]['pidExpireLogin']);removeSocketListeners(getClient(_0x5b12eb['id'])[_0x1eb402(0x26b)]),addBlacklist(_0x4b0de9),devices[_0x4b0de9][_0x1eb402(0x18a)]=null,devices[_0x4b0de9][_0x1eb402(0x176)]=null,devices[_0x4b0de9][_0x1eb402(0x290)][_0x1eb402(0x204)]=null,logger[_0x1eb402(0x23b)](_0x1eb402(0x1ff)+_0x4b0de9[_0x1eb402(0x288)](-0x8)),io['to'](getClient(_0x5b12eb['id'])[_0x1eb402(0x26b)])['emit'](_0x1eb402(0x10a),{'access':{'allow':![],'reason':_0x1eb402(0x1f2),'token':null}});}else logger[_0x1eb402(0x1c9)](_0x1eb402(0x1b0));});}function removeSocketListeners(_0x50089d){const _0x2de7fe=_0x22bffb;getClientsWithUuid(_0x50089d)[_0x2de7fe(0x135)](_0xf23a30=>{const _0xf895f=_0x2de7fe;getSocket(_0xf23a30['id'])[_0xf895f(0x257)]();});}function cleanSettings(){const _0x2ac27c=_0x22bffb;let _0x347ec8=settings;return settings[_0x2ac27c(0x1e6)]&&settings[_0x2ac27c(0x1e6)]!=''&&(_0x347ec8={..._0x347ec8,'telegramToken':_0x2ac27c(0x1fc)}),settings[_0x2ac27c(0x194)]&&settings[_0x2ac27c(0x194)]!=''&&(_0x347ec8={..._0x347ec8,'bbPassword':'************'}),(settings[_0x2ac27c(0x194)]&&settings[_0x2ac27c(0x194)]=='***'||settings['telegramToken']&&settings[_0x2ac27c(0x1e6)]==_0x2ac27c(0x12c))&&(_0x347ec8={..._0x347ec8,'restored':{'password':settings[_0x2ac27c(0x194)]=='***','telegram':settings[_0x2ac27c(0x1e6)]==_0x2ac27c(0x12c)}}),_0x347ec8;}async function updateBB(_0x2aead5){const _0x15d6d2=_0x22bffb;await backupConfigFiles(),installingUpdate=!![],config[_0x15d6d2(0x135)](_0x258f36=>{const _0x4a554f=_0x15d6d2;restartBot(_0x258f36[_0x4a554f(0x1cf)]);});if(_0x2aead5=='update')process[_0x15d6d2(0x17c)]({'update':!![],'environment':environment},_0x4a7588=>{});else _0x2aead5==_0x15d6d2(0xe7)&&process[_0x15d6d2(0x17c)]({'reinstall':!![],'environment':environment},_0x26198a=>{});}function startBot(_0x515fa6,_0x452c78,_0x58d036){const _0x506377=_0x22bffb;if(debugging)_0x515fa6[_0x506377(0x159)]('-d');let _0x4d7b6c=![];const _0x1c5953=_0x515fa6[0x0];_0x452c78={..._0x452c78,'stdio':[_0x506377(0x252),_0x506377(0x252),_0x506377(0x252),_0x506377(0x181)]},pid[_0x1c5953]=childProcess[_0x506377(0x136)](botfile,_0x515fa6,_0x452c78),pid[_0x1c5953]['on']('message',_0x36d31d=>{const _0xbd983b=_0x506377;switch(Object['keys'](_0x36d31d)[0x0]){case _0xbd983b(0x20f):updateBotName(_0x1c5953,_0x36d31d[_0xbd983b(0x20f)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x1c5953,_0x36d31d[_0xbd983b(0x10a)]);break;case'live':updateLive(_0x1c5953,_0x36d31d[_0xbd983b(0x15d)]);break;case'started':updateLive(_0x1c5953,_0x36d31d['started']),io['to'](_0x1c5953)[_0xbd983b(0x13f)](_0xbd983b(0x10a),{'access':{'allow':![],'reason':_0xbd983b(0x1b4),'token':null}});break;case _0xbd983b(0x1d1):_0x36d31d[_0xbd983b(0x1d1)]==_0xbd983b(0x17e)&&restartBot(_0x1c5953);_0x36d31d[_0xbd983b(0x1d1)]=='kill'&&toggleBot(_0x1c5953,_0xbd983b(0x21c),_0xbd983b(0x20c));break;case _0xbd983b(0x289):sendTelegram(_0x1c5953,_0x36d31d[_0xbd983b(0x289)]);break;case _0xbd983b(0x2bd):sendTelegramMsg(_0x36d31d[_0xbd983b(0x2bd)]);break;case _0xbd983b(0x24d):io['to'](_0x1c5953)[_0xbd983b(0x13f)](_0x36d31d[_0xbd983b(0x24d)],_0x36d31d[_0xbd983b(0x249)]);break;}}),pid[_0x1c5953]['on'](_0x506377(0x27d),function(_0x5abb30){if(_0x4d7b6c)return;_0x4d7b6c=!![],_0x58d036(_0x5abb30);}),pid[_0x1c5953]['on'](_0x506377(0x1c4),async function(_0x2f4b0c){const _0x35a0ac=_0x506377;if(installingUpdate)return;if(_0x4d7b6c)return;_0x4d7b6c=!![],_0x58d036(null);const _0x241c51=dbConfig[_0x35a0ac(0x24b)](_0x35a0ac(0x24e))[_0x35a0ac(0x2ac)]({'botID':_0x1c5953})[_0x35a0ac(0x17f)]();_0x241c51&&(_0x241c51[_0x35a0ac(0x10a)]==_0x35a0ac(0x14d)||_0x241c51[_0x35a0ac(0x10a)]==_0x35a0ac(0x240))&&(await sleep(0x3e8),updateLive(_0x1c5953,_0x35a0ac(0x20c)),logger[_0x35a0ac(0x1c9)](_0x35a0ac(0x1f1)+_0x1c5953),startBot([_0x1c5953,userID],{'cwd':bbpath},function(_0x3e5826){const _0x404746=_0x35a0ac;if(_0x3e5826)logger[_0x404746(0x1c9)](_0x3e5826);}));});}function stopBot(_0x1ff8e6){const _0x169f89=_0x22bffb;getClientsWithBotID(_0x1ff8e6)['forEach'](_0x55e4a0=>{const _0x3d160b=_0xba24;getSocket(_0x55e4a0['id'])[_0x3d160b(0x270)](!![]),removeClient(_0x55e4a0['id']);}),pid[_0x1ff8e6]&&(pid[_0x1ff8e6][_0x169f89(0x1e5)](),pid[_0x1ff8e6]=null);}function restartBot(_0x207450){const _0xefcf07=_0x22bffb;if(pid[_0x207450])pid[_0x207450][_0xefcf07(0x1e5)]();}function _0xba24(_0x17b204,_0x17bd87){const _0x19708d=_0x13ee();return _0xba24=function(_0x47a26a,_0x5eb81b){_0x47a26a=_0x47a26a-0xe6;let _0x13ee0c=_0x19708d[_0x47a26a];return _0x13ee0c;},_0xba24(_0x17b204,_0x17bd87);}function addBot(){const _0x371219=_0x22bffb;let _0x288ca9;for(let _0x5a246d=0x1;_0x5a246d<0x3e9;_0x5a246d++){_0x288ca9=_0x5a246d[_0x371219(0x2ad)]()['padStart'](0x3,'0');let _0x5f49e4=config[_0x371219(0x2ac)](_0x19fbfb=>_0x19fbfb[_0x371219(0x1cf)]==_0x288ca9);if(!_0x5f49e4)break;}if(_0x288ca9===_0x371219(0x1a9)){logger['full'](_0x371219(0x167));return;}logger[_0x371219(0x1c9)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x288ca9),dbConfig[_0x371219(0x24b)](_0x371219(0x24e))[_0x371219(0x159)]({'botID':_0x288ca9,'botname':_0x371219(0x1fd)+_0x288ca9,'status':'new','live':''})[_0x371219(0x16c)](),startBot([_0x288ca9,userID],{'cwd':bbpath},function(_0x8f86e){if(_0x8f86e)logger['full'](_0x8f86e);}),config=getConfiguration(),io['to'](_0x371219(0x1f4))[_0x371219(0x13f)](_0x371219(0x24e),config),broadcastToBots(_0x371219(0x24e),JSON['stringify'](config));}function deleteBot(_0x107685){const _0xe40c92=_0x22bffb;getClientsWithBotID(_0x107685)[_0xe40c92(0x135)](_0x44fd40=>{getSocket(_0x44fd40['id'])['disconnect'](!![]),removeClient(_0x44fd40['id']);}),dbConfig['get'](_0xe40c92(0x24e))[_0xe40c92(0x201)]({'botID':_0x107685})[_0xe40c92(0x16c)](),logger['full'](_0xe40c92(0x275)+_0x107685),stopBot(_0x107685);try{if(fs[_0xe40c92(0x2aa)](path[_0xe40c92(0x24f)](configpath,_0xe40c92(0x174)+_0x107685+_0xe40c92(0x236))))fs['unlinkSync'](path[_0xe40c92(0x24f)](configpath,'bot-'+_0x107685+_0xe40c92(0x236)));if(fs[_0xe40c92(0x2aa)](path[_0xe40c92(0x24f)](configpath,_0xe40c92(0x174)+_0x107685+'-events.json')))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x107685+_0xe40c92(0x2a1)));if(fs['existsSync'](path['join'](configpath,_0xe40c92(0x174)+_0x107685+'-performance.json')))fs['unlinkSync'](path['join'](configpath,_0xe40c92(0x174)+_0x107685+_0xe40c92(0x1d6)));if(fs[_0xe40c92(0x2aa)](path[_0xe40c92(0x24f)](configpath,_0xe40c92(0x174)+_0x107685+_0xe40c92(0xea))))fs[_0xe40c92(0x266)](path[_0xe40c92(0x24f)](configpath,_0xe40c92(0x174)+_0x107685+_0xe40c92(0xea)));}catch(_0x48f55c){if(_0x48f55c)logger[_0xe40c92(0x1c9)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x48f55c);}config=getConfiguration(),io['to'](_0xe40c92(0x1f4))[_0xe40c92(0x13f)](_0xe40c92(0x24e),config),broadcastToBots(_0xe40c92(0x24e),JSON[_0xe40c92(0x196)](config));}function toggleBot(_0x6b2511,_0x4b2429,_0x1b11fb){const _0x5f4f39=_0x22bffb;dbConfig['get'](_0x5f4f39(0x24e))['find']({'botID':_0x6b2511})[_0x5f4f39(0x29d)]({'status':_0x4b2429})['assign']({'live':_0x1b11fb})[_0x5f4f39(0x16c)]();if(_0x4b2429==_0x5f4f39(0x14d)||_0x4b2429==_0x5f4f39(0x240))logger['full']('Enabled\x20Bot\x20'+_0x6b2511),startBot([_0x6b2511,userID],{'cwd':bbpath},function(_0x5c4e3b){const _0xcdc5bd=_0x5f4f39;if(_0x5c4e3b)logger[_0xcdc5bd(0x1c9)](_0x5c4e3b);});else(_0x4b2429==_0x5f4f39(0x21c)||_0x4b2429=='new-disabled')&&(logger[_0x5f4f39(0x1c9)](_0x5f4f39(0x106)+_0x6b2511),stopBot(_0x6b2511));config=getConfiguration(),io['to'](_0x5f4f39(0x1f4))['emit'](_0x5f4f39(0x24e),config),broadcastToBots('bots',JSON[_0x5f4f39(0x196)](config));}function toggleStatus(_0x31cc2d){const _0x564d27=_0x22bffb;let _0x44687c=dbConfig['get']('bots')['find']({'botID':_0x31cc2d})[_0x564d27(0x17f)](),_0x330afe;if(_0x44687c[_0x564d27(0x10a)]===_0x564d27(0x14d))_0x330afe=_0x564d27(0x21c);else{if(_0x44687c[_0x564d27(0x10a)]===_0x564d27(0x240))_0x330afe=_0x564d27(0x18f);else{if(_0x44687c['status']===_0x564d27(0x18f))_0x330afe=_0x564d27(0x240);else{if(_0x44687c[_0x564d27(0x10a)]===_0x564d27(0x21c))_0x330afe=_0x564d27(0x14d);}}}return _0x330afe;}function updateStatus(_0x3fd474,_0x179d0d){const _0x5e456d=_0x22bffb;dbConfig[_0x5e456d(0x24b)]('bots')['find']({'botID':_0x3fd474})[_0x5e456d(0x29d)]({'status':_0x179d0d})[_0x5e456d(0x16c)](),config=getConfiguration(),io['to'](_0x5e456d(0x1f4))['emit'](_0x5e456d(0x24e),config),broadcastToBots('bots',JSON[_0x5e456d(0x196)](config));}function updateLive(_0x73f172,_0x28eb36){const _0x4467b6=_0x22bffb;dbConfig[_0x4467b6(0x24b)](_0x4467b6(0x24e))['find']({'botID':_0x73f172})[_0x4467b6(0x29d)]({'live':_0x28eb36})[_0x4467b6(0x16c)](),config=getConfiguration(),io['to'](_0x4467b6(0x1f4))[_0x4467b6(0x13f)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x425e8b,_0x2f9e33){const _0x23fc02=_0x22bffb;dbConfig[_0x23fc02(0x24b)]('bots')[_0x23fc02(0x2ac)]({'botID':_0x425e8b})[_0x23fc02(0x29d)]({'botname':_0x2f9e33})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x23fc02(0x13f)](_0x23fc02(0x24e),config),broadcastToBots(_0x23fc02(0x24e),JSON[_0x23fc02(0x196)](config));}function updateBotManager(){const _0x18f517=_0x22bffb;config=getConfiguration(),io['to']('botmanager')['emit'](_0x18f517(0x24e),config),broadcastToBots(_0x18f517(0x24e),JSON['stringify'](config));}function toggleBotMode(_0x1f29f4){const _0x5f2a3f=_0x22bffb;if(pid[_0x1f29f4])pid[_0x1f29f4][_0x5f2a3f(0x17c)]({'function':_0x5f2a3f(0x1c1),'args':null});else{const _0x51a1b0=configpath+_0x5f2a3f(0x174)+_0x1f29f4+_0x5f2a3f(0x236),_0xcd6fb0=fs[_0x5f2a3f(0x149)](_0x51a1b0),_0x17af74=JSON[_0x5f2a3f(0x279)](_0xcd6fb0),_0x4a884e=_0x17af74[_0x5f2a3f(0x1f0)][0x0][_0x5f2a3f(0x13d)];_0x17af74[_0x5f2a3f(0x1f0)][0x0][_0x5f2a3f(0x13d)]=!_0x4a884e;const _0x560e5a=JSON[_0x5f2a3f(0x196)](_0x17af74,null,0x2);fs[_0x5f2a3f(0x205)](_0x51a1b0,_0x560e5a),config=getConfiguration(),io['to'](_0x5f2a3f(0x1f4))[_0x5f2a3f(0x13f)](_0x5f2a3f(0x24e),config),broadcastToBots(_0x5f2a3f(0x24e),JSON[_0x5f2a3f(0x196)](config));}}function telegramError(_0x3760df){const _0xaba847=_0x22bffb;logger[_0xaba847(0x146)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x16b65b){const _0x56425c=_0x22bffb;if(_0x16b65b['from']['username']!=settings[_0x56425c(0x264)]&&'@'+_0x16b65b[_0x56425c(0x1e1)]['username']!=settings[_0x56425c(0x264)])return tgBot[_0x56425c(0x230)](_0x16b65b[_0x56425c(0x2ab)]['id'],_0x56425c(0x1b2),{'parse_mode':_0x56425c(0x11a)})[_0x56425c(0x28b)](_0x1dd2e2=>{telegramError(_0x1dd2e2);}),![];return!![];}async function initTelegram(){const _0xe684d9=_0x22bffb;if(tgBot)tgBot[_0xe684d9(0x296)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xe684d9(0x1e6)],{'polling':!![]});let _0x2f74a6=_0xe684d9(0x1c2);_0x2f74a6+='\x0a',_0x2f74a6+='/enable\x20-\x20enable\x20notifications\x0a',_0x2f74a6+=_0xe684d9(0x16d),_0x2f74a6+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x2f74a6+=_0xe684d9(0x10d),_0x2f74a6+=_0xe684d9(0x1f3),_0x2f74a6+=_0xe684d9(0x19f),_0x2f74a6+=_0xe684d9(0x224),_0x2f74a6+='/names\x20-\x20show\x20bot\x20names\x0a',_0x2f74a6+=_0xe684d9(0x238),_0x2f74a6+=_0xe684d9(0x1ab),_0x2f74a6+=_0xe684d9(0x294),_0x2f74a6+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x2f74a6+=_0xe684d9(0x198),_0x2f74a6+=_0xe684d9(0x157);let _0x4e58bb=_0xe684d9(0x191);_0x4e58bb+='\x0a',_0x4e58bb+=_0x2f74a6,tgBot['onText'](/\/start/,_0x4b6a77=>{const _0x572ece=_0xe684d9;if(!validateTelegram(_0x4b6a77))return;if(settings['telegramChatId']!=_0x4b6a77[_0x572ece(0x2ab)]['id'])updateSetting('telegramChatId',_0x4b6a77[_0x572ece(0x2ab)]['id']);updateSetting(_0x572ece(0x287),!![]),tgBot[_0x572ece(0x230)](_0x4b6a77[_0x572ece(0x2ab)]['id'],_0x4e58bb)[_0x572ece(0x28b)](_0x39d85c=>{telegramError(_0x39d85c);});}),tgBot[_0xe684d9(0x2b5)](/\/enable/,_0x5e8666=>{const _0x210604=_0xe684d9;if(!validateTelegram(_0x5e8666))return;if(settings[_0x210604(0xef)]!=_0x5e8666[_0x210604(0x2ab)]['id'])updateSetting(_0x210604(0xef),_0x5e8666['chat']['id']);updateSetting(_0x210604(0x287),!![]),tgBot[_0x210604(0x230)](_0x5e8666[_0x210604(0x2ab)]['id'],_0x210604(0x253))[_0x210604(0x28b)](_0x23e658=>{telegramError(_0x23e658);});}),tgBot['onText'](/\/config/,async _0x36457d=>{const _0x263735=_0xe684d9;if(!validateTelegram(_0x36457d))return;tgBot[_0x263735(0x134)]('callback_query'),tgBot[_0x263735(0x230)](_0x36457d['chat']['id'],_0x263735(0x25c),{'reply_markup':{'inline_keyboard':[[{'text':_0x263735(0x1a5),'callback_data':_0x263735(0x1af)},{'text':'Alerts','callback_data':_0x263735(0x10b)},{'text':_0x263735(0x274),'callback_data':_0x263735(0x1a7)}]]}})[_0x263735(0x28b)](_0x5083c9=>{telegramError(_0x5083c9);}),tgBot['on'](_0x263735(0x2bb),async _0x5d3dc2=>{const _0x1a14c6=_0x263735,_0x3b04c4=_0x5d3dc2['data'],_0x2f3f36=_0x5d3dc2[_0x1a14c6(0x291)];tgBot['answerCallbackQuery'](_0x5d3dc2['id'])['then'](async()=>{const _0x4d2f4f=_0x1a14c6;_0x3b04c4==_0x4d2f4f(0x1af)&&(updateSetting(_0x4d2f4f(0x105),'orders'),updateSetting(_0x4d2f4f(0x287),!![]),await tgBot[_0x4d2f4f(0x230)](_0x2f3f36[_0x4d2f4f(0x2ab)]['id'],_0x4d2f4f(0x26c))[_0x4d2f4f(0x28b)](_0x3a1b9c=>{telegramError(_0x3a1b9c);}));_0x3b04c4==_0x4d2f4f(0x10b)&&(updateSetting(_0x4d2f4f(0x105),_0x4d2f4f(0x10b)),updateSetting(_0x4d2f4f(0x287),!![]),await tgBot[_0x4d2f4f(0x230)](_0x2f3f36['chat']['id'],_0x4d2f4f(0x227))[_0x4d2f4f(0x28b)](_0x46d0b9=>{telegramError(_0x46d0b9);}));_0x3b04c4==_0x4d2f4f(0x1a7)&&(updateSetting(_0x4d2f4f(0x105),'all'),updateSetting(_0x4d2f4f(0x287),!![]),await tgBot[_0x4d2f4f(0x230)](_0x2f3f36['chat']['id'],_0x4d2f4f(0x27f))[_0x4d2f4f(0x28b)](_0x199a7f=>{telegramError(_0x199a7f);}));if(!settings[_0x4d2f4f(0xef)])tgBot['sendMessage'](_0x2f3f36[_0x4d2f4f(0x2ab)]['id'],_0x4d2f4f(0x1ae))['catch'](_0x4c0e4d=>{telegramError(_0x4c0e4d);});}),tgBot['removeListener'](_0x1a14c6(0x2bb));});}),tgBot[_0xe684d9(0x2b5)](/\/status/,_0x3f0827=>{const _0x13ee0e=_0xe684d9;if(!validateTelegram(_0x3f0827))return;const _0x17f748=getBotsWithMode();let _0xee17bd=_0x13ee0e(0x278);config[_0x13ee0e(0x135)](_0x59a71a=>{const _0x388ee0=_0x13ee0e,_0xe84872=_0x17f748['find'](_0x504fbd=>_0x504fbd[_0x388ee0(0x1cf)]==_0x59a71a[_0x388ee0(0x1cf)])['mode'];_0xee17bd+=_0x388ee0(0x1fd)+_0x59a71a[_0x388ee0(0x1cf)]+':\x20'+_0x59a71a[_0x388ee0(0x10a)]+'\x20|\x20'+_0xe84872+'\x20|\x20'+_0x59a71a[_0x388ee0(0x15d)]+'\x0a';}),_0xee17bd+='\x0a',_0xee17bd+=_0x13ee0e(0x2a9),_0xee17bd+=!settings[_0x13ee0e(0x287)]?'Notifications\x20disabled\x0a':_0x13ee0e(0x255),_0xee17bd+=settings[_0x13ee0e(0x287)]?settings[_0x13ee0e(0x105)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x13ee0e(0x116)+settings[_0x13ee0e(0x105)]+'\x20only\x0a':'',tgBot[_0x13ee0e(0x230)](_0x3f0827[_0x13ee0e(0x2ab)]['id'],_0xee17bd,{'parse_mode':_0x13ee0e(0x11a)})['catch'](_0x4a2caa=>{telegramError(_0x4a2caa);});}),tgBot[_0xe684d9(0x2b5)](/\/restart/,_0x5745d8=>{const _0x536f46=_0xe684d9;if(!validateTelegram(_0x5745d8))return;tgBot['removeListener'](_0x536f46(0x2bb));const _0x535c99=getEnabledBots();if(_0x535c99[_0x536f46(0x208)]==0x0)tgBot[_0x536f46(0x230)](_0x5745d8[_0x536f46(0x2ab)]['id'],_0x536f46(0x1d2))[_0x536f46(0x28b)](_0x2b7248=>{telegramError(_0x2b7248);});else{if(_0x535c99[_0x536f46(0x208)]>0x1)_0x535c99[_0x536f46(0x159)]({'botID':_0x536f46(0x1a7)});let _0xc4121f=[],_0x4139b4=[];const _0x2a5fb3=_0x535c99[_0x536f46(0x208)]%0x4==0x0||_0x535c99[_0x536f46(0x208)]%0x4==0x3||_0x535c99[_0x536f46(0x208)]%0x3==0x1?0x4:0x3;let _0x1960cc=0x0;_0x535c99[_0x536f46(0x135)]((_0x29c38b,_0x182712)=>{const _0x2a6772=_0x536f46;if(_0x182712%_0x2a5fb3==0x0)_0x4139b4=[];_0x4139b4[_0x2a6772(0x159)]({'text':_0x29c38b[_0x2a6772(0x1cf)]==_0x2a6772(0x1a7)?_0x2a6772(0x120):_0x2a6772(0x1fd)+_0x29c38b[_0x2a6772(0x1cf)],'callback_data':_0x29c38b[_0x2a6772(0x1cf)]}),_0x182712%_0x2a5fb3==0x0&&(_0xc4121f[_0x1960cc]=_0x4139b4,_0x1960cc++);}),tgBot[_0x536f46(0x230)](_0x5745d8[_0x536f46(0x2ab)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0xc4121f}})[_0x536f46(0x28b)](_0x1b0fa3=>{telegramError(_0x1b0fa3);}),tgBot['on'](_0x536f46(0x2bb),async _0x961009=>{const _0x57e8d8=_0x536f46,_0x12417c=_0x961009[_0x57e8d8(0x1a0)],_0x52bd0c=_0x961009[_0x57e8d8(0x291)];tgBot[_0x57e8d8(0x214)](_0x961009['id'])[_0x57e8d8(0x1c5)](async()=>{const _0x3b1844=_0x57e8d8;_0x12417c=='all'?config[_0x3b1844(0x135)](_0x26f0a4=>{restartBot(_0x26f0a4['botID']);}):restartBot(_0x12417c);}),tgBot[_0x57e8d8(0x134)]('callback_query');});}}),tgBot[_0xe684d9(0x2b5)](/\/on/,_0x32f1cf=>{const _0x2ffd90=_0xe684d9;if(!validateTelegram(_0x32f1cf))return;tgBot[_0x2ffd90(0x134)](_0x2ffd90(0x2bb));const _0xccb6b2=getDisabledBots();if(_0xccb6b2[_0x2ffd90(0x208)]==0x0)tgBot[_0x2ffd90(0x230)](_0x32f1cf[_0x2ffd90(0x2ab)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x2ffd90(0x28b)](_0x11b43d=>{telegramError(_0x11b43d);});else{if(_0xccb6b2['length']>0x1)_0xccb6b2[_0x2ffd90(0x159)]({'botID':'all'});let _0x5c3bcd=[],_0x562292=[];const _0x530e9d=_0xccb6b2[_0x2ffd90(0x208)]%0x4==0x0||_0xccb6b2[_0x2ffd90(0x208)]%0x4==0x3||_0xccb6b2[_0x2ffd90(0x208)]%0x3==0x1?0x4:0x3;let _0x5e4f0d=0x0;_0xccb6b2[_0x2ffd90(0x135)]((_0x40fbd3,_0x3cb9b7)=>{const _0x15d0ac=_0x2ffd90;if(_0x3cb9b7%_0x530e9d==0x0)_0x562292=[];_0x562292['push']({'text':_0x40fbd3[_0x15d0ac(0x1cf)]==_0x15d0ac(0x1a7)?'All\x20bots':_0x15d0ac(0x1fd)+_0x40fbd3[_0x15d0ac(0x1cf)],'callback_data':_0x40fbd3[_0x15d0ac(0x1cf)]}),_0x3cb9b7%_0x530e9d==0x0&&(_0x5c3bcd[_0x5e4f0d]=_0x562292,_0x5e4f0d++);}),tgBot[_0x2ffd90(0x230)](_0x32f1cf[_0x2ffd90(0x2ab)]['id'],_0x2ffd90(0x2a4),{'reply_markup':{'inline_keyboard':_0x5c3bcd}})['catch'](_0x1a4b66=>{telegramError(_0x1a4b66);}),tgBot['on']('callback_query',async _0xe322fc=>{const _0x3ebea5=_0x2ffd90,_0x2fa537=_0xe322fc['data'],_0x1ad9a6=_0xe322fc[_0x3ebea5(0x291)];tgBot[_0x3ebea5(0x214)](_0xe322fc['id'])['then'](async()=>{const _0x4268ba=_0x3ebea5;_0x2fa537==_0x4268ba(0x1a7)?(tgBot[_0x4268ba(0x230)](_0x1ad9a6[_0x4268ba(0x2ab)]['id'],_0x4268ba(0x124))[_0x4268ba(0x28b)](_0x238c8d=>{telegramError(_0x238c8d);}),_0xccb6b2[_0x4268ba(0x135)](_0x3867bf=>{const _0x16b746=_0x4268ba;if(_0x3867bf[_0x16b746(0x1cf)]!=_0x16b746(0x1a7))toggleBot(_0x3867bf[_0x16b746(0x1cf)],toggleStatus(_0x3867bf[_0x16b746(0x1cf)]),_0x16b746(0x20c));})):(tgBot[_0x4268ba(0x230)](_0x1ad9a6['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x2fa537)[_0x4268ba(0x28b)](_0x1ae89a=>{telegramError(_0x1ae89a);}),toggleBot(_0x2fa537,toggleStatus(_0x2fa537),_0x4268ba(0x20c)));}),tgBot[_0x3ebea5(0x134)](_0x3ebea5(0x2bb));});}}),tgBot[_0xe684d9(0x2b5)](/\/off/,_0x1e2c9e=>{const _0x44d2bb=_0xe684d9;if(!validateTelegram(_0x1e2c9e))return;tgBot[_0x44d2bb(0x134)](_0x44d2bb(0x2bb));const _0x5a3e9f=getEnabledBots();if(_0x5a3e9f[_0x44d2bb(0x208)]==0x0)tgBot[_0x44d2bb(0x230)](_0x1e2c9e[_0x44d2bb(0x2ab)]['id'],_0x44d2bb(0x1d2))['catch'](_0x3b4603=>{telegramError(_0x3b4603);});else{if(_0x5a3e9f['length']>0x1)_0x5a3e9f[_0x44d2bb(0x159)]({'botID':_0x44d2bb(0x1a7)});let _0x553e6d=[],_0x28e1a8=[];const _0x335dcb=_0x5a3e9f[_0x44d2bb(0x208)]%0x4==0x0||_0x5a3e9f[_0x44d2bb(0x208)]%0x4==0x3||_0x5a3e9f['length']%0x3==0x1?0x4:0x3;let _0x76e6c9=0x0;_0x5a3e9f[_0x44d2bb(0x135)]((_0x42a6a7,_0x5e6a25)=>{const _0x2e0228=_0x44d2bb;if(_0x5e6a25%_0x335dcb==0x0)_0x28e1a8=[];_0x28e1a8['push']({'text':_0x42a6a7[_0x2e0228(0x1cf)]=='all'?'All\x20bots':_0x2e0228(0x1fd)+_0x42a6a7[_0x2e0228(0x1cf)],'callback_data':_0x42a6a7[_0x2e0228(0x1cf)]}),_0x5e6a25%_0x335dcb==0x0&&(_0x553e6d[_0x76e6c9]=_0x28e1a8,_0x76e6c9++);}),tgBot[_0x44d2bb(0x230)](_0x1e2c9e[_0x44d2bb(0x2ab)]['id'],_0x44d2bb(0x2ba),{'reply_markup':{'inline_keyboard':_0x553e6d}})[_0x44d2bb(0x28b)](_0x196205=>{telegramError(_0x196205);}),tgBot['on'](_0x44d2bb(0x2bb),async _0x1dd817=>{const _0x45b1a7=_0x44d2bb,_0x126438=_0x1dd817['data'],_0x3b84c8=_0x1dd817[_0x45b1a7(0x291)];tgBot[_0x45b1a7(0x214)](_0x1dd817['id'])[_0x45b1a7(0x1c5)](async()=>{const _0x476702=_0x45b1a7;_0x126438==_0x476702(0x1a7)?(tgBot['sendMessage'](_0x3b84c8[_0x476702(0x2ab)]['id'],_0x476702(0x1a8))['catch'](_0x3165e9=>{telegramError(_0x3165e9);}),_0x5a3e9f[_0x476702(0x135)](_0x394fdb=>{const _0x1a8525=_0x476702;if(_0x394fdb[_0x1a8525(0x1cf)]!=_0x1a8525(0x1a7))toggleBot(_0x394fdb['botID'],toggleStatus(_0x394fdb[_0x1a8525(0x1cf)]),'stopped');})):(tgBot[_0x476702(0x230)](_0x3b84c8['chat']['id'],_0x476702(0x10e)+_0x126438)['catch'](_0x2482d3=>{telegramError(_0x2482d3);}),toggleBot(_0x126438,toggleStatus(_0x126438),_0x476702(0x20c)));}),tgBot[_0x45b1a7(0x134)](_0x45b1a7(0x2bb));});}}),tgBot[_0xe684d9(0x2b5)](/\/metrics/,_0x1dba41=>{const _0x4b882f=_0xe684d9;if(!validateTelegram(_0x1dba41))return;tgBot[_0x4b882f(0x134)]('callback_query');const _0x1153c6=getEnabledBots();if(_0x1153c6[_0x4b882f(0x208)]==0x0)tgBot[_0x4b882f(0x230)](_0x1dba41['chat']['id'],_0x4b882f(0x1d2))[_0x4b882f(0x28b)](_0x34a4df=>{telegramError(_0x34a4df);});else{if(_0x1153c6[_0x4b882f(0x208)]>0x1){let _0x19c3c5=[],_0x547977=[];const _0x17f7f6=_0x1153c6[_0x4b882f(0x208)]%0x4==0x0||_0x1153c6[_0x4b882f(0x208)]%0x4==0x3||_0x1153c6[_0x4b882f(0x208)]%0x3==0x1?0x4:0x3;let _0x371a58=0x0;_0x1153c6['forEach']((_0x42c4a7,_0x468a20)=>{const _0x39a66d=_0x4b882f;if(_0x468a20%_0x17f7f6==0x0)_0x547977=[];_0x547977[_0x39a66d(0x159)]({'text':'Bot\x20'+_0x42c4a7[_0x39a66d(0x1cf)],'callback_data':_0x42c4a7[_0x39a66d(0x1cf)]}),_0x468a20%_0x17f7f6==0x0&&(_0x19c3c5[_0x371a58]=_0x547977,_0x371a58++);}),tgBot['sendMessage'](_0x1dba41['chat']['id'],_0x4b882f(0x17b),{'reply_markup':{'inline_keyboard':_0x19c3c5}})[_0x4b882f(0x28b)](_0x50ba38=>{telegramError(_0x50ba38);}),tgBot['on'](_0x4b882f(0x2bb),async _0x10f635=>{const _0xb3475a=_0x4b882f,_0x7106e9=_0x10f635[_0xb3475a(0x1a0)],_0x5aa180=_0x10f635['message'];tgBot[_0xb3475a(0x214)](_0x10f635['id'])[_0xb3475a(0x1c5)](async()=>{const _0x1ec7bd=_0xb3475a;if(pid[_0x7106e9])pid[_0x7106e9][_0x1ec7bd(0x17c)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0xb3475a(0x134)](_0xb3475a(0x2bb));});}else{const _0x10e6af=_0x1153c6[0x0]['botID'];if(pid[_0x10e6af])pid[_0x10e6af]['send']({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0xe684d9(0x2b5)](/\/portfolio/,_0x527856=>{const _0x227083=_0xe684d9;if(!validateTelegram(_0x527856))return;tgBot[_0x227083(0x134)]('callback_query');const _0x3541d9=getEnabledBots();if(_0x3541d9['length']==0x0)tgBot['sendMessage'](_0x527856[_0x227083(0x2ab)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x227083(0x28b)](_0x4d5cd0=>{telegramError(_0x4d5cd0);});else{if(_0x3541d9[_0x227083(0x208)]>0x1){let _0xcb097e=[],_0xb7f00c=[];const _0x2a1617=_0x3541d9[_0x227083(0x208)]%0x4==0x0||_0x3541d9[_0x227083(0x208)]%0x4==0x3||_0x3541d9[_0x227083(0x208)]%0x3==0x1?0x4:0x3;let _0x160657=0x0;_0x3541d9[_0x227083(0x135)]((_0x3ed115,_0x2a9822)=>{const _0x1b5261=_0x227083;if(_0x2a9822%_0x2a1617==0x0)_0xb7f00c=[];_0xb7f00c[_0x1b5261(0x159)]({'text':_0x1b5261(0x1fd)+_0x3ed115[_0x1b5261(0x1cf)],'callback_data':_0x3ed115['botID']}),_0x2a9822%_0x2a1617==0x0&&(_0xcb097e[_0x160657]=_0xb7f00c,_0x160657++);}),tgBot[_0x227083(0x230)](_0x527856[_0x227083(0x2ab)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0xcb097e}})['catch'](_0x3e80c4=>{telegramError(_0x3e80c4);}),tgBot['on'](_0x227083(0x2bb),async _0x217295=>{const _0x50e7fb=_0x227083,_0x357239=_0x217295[_0x50e7fb(0x1a0)],_0x98d7f4=_0x217295[_0x50e7fb(0x291)];tgBot[_0x50e7fb(0x214)](_0x217295['id'])[_0x50e7fb(0x1c5)](async()=>{const _0x834043=_0x50e7fb;if(pid[_0x357239])pid[_0x357239][_0x834043(0x17c)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x50e7fb(0x134)](_0x50e7fb(0x2bb));});}else{const _0x222aaf=_0x3541d9[0x0]['botID'];if(pid[_0x222aaf])pid[_0x222aaf][_0x227083(0x17c)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0xe684d9(0x2b5)](/\/update/,async _0x35cf18=>{const _0x45e5cd=_0xe684d9;if(!validateTelegram(_0x35cf18))return;tgBot[_0x45e5cd(0x134)](_0x45e5cd(0x2bb)),await getMessages();if(!updateAvailable)tgBot[_0x45e5cd(0x230)](_0x35cf18['chat']['id'],_0x45e5cd(0x180))[_0x45e5cd(0x28b)](_0x4e648b=>{telegramError(_0x4e648b);});else!validInstallation?tgBot['sendMessage'](_0x35cf18['chat']['id'],_0x45e5cd(0x254))['catch'](_0x5d1ef8=>{telegramError(_0x5d1ef8);}):(tgBot['sendMessage'](_0x35cf18[_0x45e5cd(0x2ab)]['id'],_0x45e5cd(0x165),{'reply_markup':{'inline_keyboard':[[{'text':_0x45e5cd(0x286),'callback_data':_0x45e5cd(0x104)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x5f0f17=>{telegramError(_0x5f0f17);}),tgBot['on'](_0x45e5cd(0x2bb),async _0x4739ef=>{const _0x7df041=_0x45e5cd,_0x4f0f52=_0x4739ef[_0x7df041(0x1a0)],_0x23ba85=_0x4739ef['message'];tgBot['answerCallbackQuery'](_0x4739ef['id'])['then'](async()=>{const _0x1ce6b1=_0x7df041;_0x4f0f52==_0x1ce6b1(0x104)&&(await tgBot['sendMessage'](_0x23ba85['chat']['id'],_0x1ce6b1(0x142))[_0x1ce6b1(0x28b)](_0x395a39=>{telegramError(_0x395a39);}),updateBB(_0x1ce6b1(0x212))),_0x4f0f52=='no'&&await tgBot['sendMessage'](_0x23ba85[_0x1ce6b1(0x2ab)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x1ce6b1(0x28b)](_0x5765d5=>{telegramError(_0x5765d5);});}),tgBot[_0x7df041(0x134)](_0x7df041(0x2bb));}));}),tgBot[_0xe684d9(0x2b5)](/\/reinstall/,async _0x2af667=>{const _0x2ba44d=_0xe684d9;if(!validateTelegram(_0x2af667))return;tgBot[_0x2ba44d(0x134)](_0x2ba44d(0x2bb)),!validInstallation?tgBot[_0x2ba44d(0x230)](_0x2af667['chat']['id'],_0x2ba44d(0x245))[_0x2ba44d(0x28b)](_0x5043cf=>{telegramError(_0x5043cf);}):(tgBot[_0x2ba44d(0x230)](_0x2af667['chat']['id'],_0x2ba44d(0x265),{'reply_markup':{'inline_keyboard':[[{'text':_0x2ba44d(0x286),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x2ba44d(0x28b)](_0x57ffb4=>{telegramError(_0x57ffb4);}),tgBot['on']('callback_query',async _0x5accb9=>{const _0x1b65f2=_0x2ba44d,_0x4775e5=_0x5accb9[_0x1b65f2(0x1a0)],_0x38449d=_0x5accb9[_0x1b65f2(0x291)];tgBot[_0x1b65f2(0x214)](_0x5accb9['id'])['then'](async()=>{const _0x19da2c=_0x1b65f2;_0x4775e5==_0x19da2c(0x104)&&(await tgBot[_0x19da2c(0x230)](_0x38449d[_0x19da2c(0x2ab)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x19da2c(0x28b)](_0x47335e=>{telegramError(_0x47335e);}),updateBB(_0x19da2c(0xe7))),_0x4775e5=='no'&&await tgBot[_0x19da2c(0x230)](_0x38449d['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x19da2c(0x28b)](_0x3aedb5=>{telegramError(_0x3aedb5);});}),tgBot['removeListener'](_0x1b65f2(0x2bb));}));}),tgBot[_0xe684d9(0x2b5)](/\/toggle/,_0x1e7b62=>{const _0x45f992=_0xe684d9;if(!validateTelegram(_0x1e7b62))return;tgBot[_0x45f992(0x134)](_0x45f992(0x2bb));const _0x679628=getBotsWithMode();if(_0x679628[_0x45f992(0x208)]==0x0)tgBot['sendMessage'](_0x1e7b62[_0x45f992(0x2ab)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x45f992(0x28b)](_0x2c5418=>{telegramError(_0x2c5418);});else{let _0x4e4a90=[],_0x8d72e7=[];const _0xb04775=0x2;let _0x59ce2f=0x0;_0x679628[_0x45f992(0x135)]((_0x54b9f8,_0x5b00dd)=>{const _0x31db8a=_0x45f992;if(_0x5b00dd%_0xb04775==0x0)_0x8d72e7=[];_0x8d72e7[_0x31db8a(0x159)]({'text':_0x31db8a(0x1fd)+_0x54b9f8[_0x31db8a(0x1cf)]+'\x20('+_0x54b9f8[_0x31db8a(0x133)]+')','callback_data':_0x54b9f8[_0x31db8a(0x1cf)]}),_0x5b00dd%_0xb04775==0x0&&(_0x4e4a90[_0x59ce2f]=_0x8d72e7,_0x59ce2f++);}),tgBot[_0x45f992(0x230)](_0x1e7b62[_0x45f992(0x2ab)]['id'],_0x45f992(0x113),{'reply_markup':{'inline_keyboard':_0x4e4a90}})[_0x45f992(0x28b)](_0xe4e1fb=>{telegramError(_0xe4e1fb);}),tgBot['on'](_0x45f992(0x2bb),async _0x26c5de=>{const _0x402dfa=_0x45f992,_0xfad17f=_0x26c5de[_0x402dfa(0x1a0)],_0x4e04ff=_0x26c5de[_0x402dfa(0x291)];tgBot[_0x402dfa(0x214)](_0x26c5de['id'])['then'](async()=>{const _0x5585c4=_0x402dfa,_0x1c4f12=_0x679628['find'](_0x4f236a=>_0x4f236a[_0x5585c4(0x1cf)]==_0xfad17f),_0x3abb7b=_0x1c4f12[_0x5585c4(0x133)]==_0x5585c4(0x103)?_0x5585c4(0x215):_0x5585c4(0x103);tgBot[_0x5585c4(0x230)](_0x4e04ff[_0x5585c4(0x2ab)]['id'],_0x5585c4(0xf1)+_0xfad17f+_0x5585c4(0x207)+_0x3abb7b+_0x5585c4(0x1be))['catch'](_0x2d8db8=>{telegramError(_0x2d8db8);}),toggleBotMode(_0xfad17f);}),tgBot[_0x402dfa(0x134)](_0x402dfa(0x2bb));});}}),tgBot[_0xe684d9(0x2b5)](/\/names/,_0x3a2750=>{const _0x53d5e4=_0xe684d9;if(!validateTelegram(_0x3a2750))return;let _0x30ab13='';config['forEach'](_0x12e216=>{const _0x2576d9=_0xba24;_0x30ab13+=_0x2576d9(0x1fd)+_0x12e216[_0x2576d9(0x1cf)]+':\x20'+_0x12e216[_0x2576d9(0x20f)]+'\x0a';}),tgBot[_0x53d5e4(0x230)](_0x3a2750[_0x53d5e4(0x2ab)]['id'],_0x30ab13,{'parse_mode':'HTML'})[_0x53d5e4(0x28b)](_0x22d543=>{telegramError(_0x22d543);});}),tgBot[_0xe684d9(0x2b5)](/\/disable/,_0x1a9edb=>{const _0x2cbd2e=_0xe684d9;if(!validateTelegram(_0x1a9edb))return;tgBot[_0x2cbd2e(0x230)](_0x1a9edb[_0x2cbd2e(0x2ab)]['id'],'Notifications\x20disabled')[_0x2cbd2e(0x28b)](_0x2e700a=>{telegramError(_0x2e700a);}),updateSetting(_0x2cbd2e(0x287),![]);}),tgBot[_0xe684d9(0x2b5)](/\/help/,_0x295f35=>{const _0x5a661f=_0xe684d9;if(!validateTelegram(_0x295f35))return;tgBot[_0x5a661f(0x230)](_0x295f35['chat']['id'],_0x2f74a6)[_0x5a661f(0x28b)](_0x4d8a01=>{telegramError(_0x4d8a01);});}),tgBot['on'](_0xe684d9(0x247),_0x3588a5=>{const _0x198732=_0xe684d9;_0x3588a5[_0x198732(0x2ad)]()['includes'](_0x198732(0x2b1))&&(logger[_0x198732(0x1c9)](_0x198732(0x184)),tgBot[_0x198732(0x296)](),tgBot=null,io['to'](_0x198732(0x1f4))[_0x198732(0x13f)](_0x198732(0x192),_0x198732(0x184)));}),process[_0xe684d9(0x23a)](_0xe684d9(0x261),()=>{const _0x4c8b0d=_0xe684d9;if(tgBot)tgBot[_0x4c8b0d(0x296)]();process['exit'](0x1);}),process[_0xe684d9(0x23a)](_0xe684d9(0x1d9),()=>{const _0x502b00=_0xe684d9;if(tgBot)tgBot['stopPolling']();process[_0x502b00(0x1c4)](0x1);});}}function disableTelegram(){const _0x2a681c=_0x22bffb;tgBot&&(tgBot[_0x2a681c(0x296)](),tgBot=null);}function sendTelegram(_0x330727,_0x385c7f){const _0x27927d=_0x22bffb;if(settings['telegramEnabled']){if(settings[_0x27927d(0x105)]=='all'||(_0x385c7f[_0x27927d(0x1b3)]=='error'||_0x385c7f['type']==_0x27927d(0x11b)||_0x385c7f['type']==_0x27927d(0x162))&&settings[_0x27927d(0x105)]==_0x27927d(0x10b)||_0x385c7f[_0x27927d(0x1b3)]==_0x27927d(0x1b1)&&settings[_0x27927d(0x105)]=='orders'){if(tgBot&&settings[_0x27927d(0xef)]){if(_0x385c7f['showname'])tgBot[_0x27927d(0x230)](settings[_0x27927d(0xef)],_0x385c7f[_0x27927d(0x20f)]+_0x27927d(0xf2)+_0x385c7f[_0x27927d(0x281)])['catch'](_0x4be832=>{telegramError(_0x4be832);});else tgBot[_0x27927d(0x230)](settings[_0x27927d(0xef)],'Bot\x20'+_0x330727+'\x20>\x20'+_0x385c7f[_0x27927d(0x281)])[_0x27927d(0x28b)](_0x6e44=>{telegramError(_0x6e44);});}}}}async function sendTelegramMsg(_0x5c8f7b,_0x1c310e=_0x22bffb(0x11a)){const _0x36fbc8=_0x22bffb;return settings[_0x36fbc8(0x287)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings['telegramChatId'],_0x5c8f7b,{'parse_mode':_0x1c310e})['catch'](_0x4507e8=>{telegramError(_0x4507e8);}),!![]):![];}function getDeviceWithIp(_0x18ad7c){const _0x497d8e=_0x22bffb;return devices[_0x497d8e(0x2ac)](_0xdd86f6=>_0xdd86f6['ip']===_0x18ad7c);}function temporaryAccess2FA(_0x161cdb,_0x419e2e){const _0x549490=_0x22bffb;let _0x336c83=new Date(),_0x1632d1=![];if(lastIpApproval){if(_0x336c83-lastIpApproval<0x1388)_0x1632d1=!![];}lastIpApproval=new Date();if(_0x1632d1)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x549490(0x134)]('callback_query'),tgBot[_0x549490(0x230)](settings['telegramChatId'],_0x549490(0x210)+normalizeIP(_0x419e2e)[_0x549490(0x17d)]+_0x549490(0x183),{'parse_mode':_0x549490(0x11a),'reply_markup':{'inline_keyboard':[[{'text':_0x549490(0x22f),'callback_data':'5'},{'text':_0x549490(0x121),'callback_data':'15'},{'text':_0x549490(0x246),'callback_data':'30'},{'text':_0x549490(0x272),'callback_data':_0x549490(0x272)}]]}})['catch'](_0x44f856=>{telegramError(_0x44f856);}),tgBot['on'](_0x549490(0x2bb),async _0x167060=>{const _0x37a2ff=_0x549490,_0x4b57b2=_0x167060[_0x37a2ff(0x1a0)],_0x46d8f5=_0x167060[_0x37a2ff(0x291)];tgBot[_0x37a2ff(0x214)](_0x167060['id'])[_0x37a2ff(0x1c5)](async()=>{const _0x928233=_0x37a2ff;devices[_0x161cdb][_0x928233(0x18a)]={'clientip':_0x419e2e,'timestamp':new Date()[_0x928233(0x280)](),'expiry':_0x4b57b2},_0x4b57b2!=_0x928233(0x272)?(await tgBot[_0x928233(0x230)](_0x46d8f5[_0x928233(0x2ab)]['id'],_0x928233(0x2b0)+_0x4b57b2+_0x928233(0x2a2),{'parse_mode':_0x928233(0x11a)})[_0x928233(0x28b)](_0x257a1d=>{telegramError(_0x257a1d);}),io['to'](_0x161cdb)['emit'](_0x928233(0x10a),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x928233(0x230)](_0x46d8f5[_0x928233(0x2ab)]['id'],'Temporary\x20access\x20rejected')[_0x928233(0x28b)](_0x477bc3=>{telegramError(_0x477bc3);}),io['to'](_0x161cdb)[_0x928233(0x13f)](_0x928233(0x10a),{'access':{'allow':![],'reason':_0x928233(0x128),'token':null}}));}),tgBot[_0x37a2ff(0x134)](_0x37a2ff(0x2bb));}));}function loginAccess2FA(_0x4e5f85,_0x1d01e1){const _0x2d564f=_0x22bffb;tgBot&&settings[_0x2d564f(0xef)]&&(tgBot[_0x2d564f(0x134)]('callback_query'),tgBot[_0x2d564f(0x230)](settings[_0x2d564f(0xef)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1d01e1)[_0x2d564f(0x17d)]+_0x2d564f(0x183),{'parse_mode':_0x2d564f(0x11a),'reply_markup':{'inline_keyboard':[[{'text':_0x2d564f(0x20e),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x2d564f(0x272)}]]}})[_0x2d564f(0x28b)](_0xe82ada=>{telegramError(_0xe82ada);}),tgBot['on'](_0x2d564f(0x2bb),async _0x1ea42e=>{const _0xa975f5=_0x2d564f,_0x50af71=_0x1ea42e[_0xa975f5(0x1a0)],_0x143368=_0x1ea42e[_0xa975f5(0x291)];tgBot[_0xa975f5(0x214)](_0x1ea42e['id'])[_0xa975f5(0x1c5)](async()=>{const _0x4d2ba2=_0xa975f5;devices[_0x4e5f85][_0x4d2ba2(0x176)]={'clientip':_0x1d01e1,'timestamp':new Date()[_0x4d2ba2(0x280)](),'expiry':_0x50af71},_0x50af71!='reject'?(await tgBot['sendMessage'](_0x143368[_0x4d2ba2(0x2ab)]['id'],'Login\x20accepted',{'parse_mode':_0x4d2ba2(0x11a)})[_0x4d2ba2(0x28b)](_0x33820d=>{telegramError(_0x33820d);}),io['to'](_0x4e5f85)['emit']('status',{'access':{'allow':![],'reason':_0x4d2ba2(0x1b4),'token':null}})):(await tgBot[_0x4d2ba2(0x230)](_0x143368[_0x4d2ba2(0x2ab)]['id'],_0x4d2ba2(0x2af))['catch'](_0x3aa979=>{telegramError(_0x3aa979);}),io['to'](_0x4e5f85)[_0x4d2ba2(0x13f)]('status',{'access':{'allow':![],'reason':_0x4d2ba2(0x168),'token':null}}));}),tgBot[_0xa975f5(0x134)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1e06ef=_0x22bffb;return dbConfig[_0x1e06ef(0x24b)](_0x1e06ef(0x24e))[_0x1e06ef(0x107)](_0x1e06ef(0x1cf))[_0x1e06ef(0x1a3)]({'status':_0x1e06ef(0x14d)})[_0x1e06ef(0x17f)]()||[];}function getDisabledBots(){const _0xf1a94a=_0x22bffb;return dbConfig[_0xf1a94a(0x24b)](_0xf1a94a(0x24e))[_0xf1a94a(0x107)]('botID')[_0xf1a94a(0x1a3)]({'status':_0xf1a94a(0x21c)})[_0xf1a94a(0x17f)]()||[];}function getBotAttributes(_0x5850bd){const _0x4dc747=_0x22bffb;let _0x48bd33={};const _0x2b1cc8=configpath+_0x4dc747(0x174)+_0x5850bd+_0x4dc747(0x236),_0x2ecfc9=fs[_0x4dc747(0x2aa)](_0x2b1cc8);if(_0x2ecfc9){const _0x131d54=fs[_0x4dc747(0x149)](_0x2b1cc8);try{const _0x14b297=JSON[_0x4dc747(0x279)](_0x131d54),_0x4660b6=_0x14b297?_0x14b297[_0x4dc747(0x1f0)][0x0][_0x4dc747(0x13d)]:![];_0x48bd33[_0x4dc747(0x133)]=_0x4660b6?_0x4dc747(0x103):'manual',_0x48bd33[_0x4dc747(0x20f)]=_0x14b297?_0x14b297['bot'][0x0][_0x4dc747(0x20f)]:_0x4dc747(0x1fd)+_0x5850bd;}catch(_0x1f9df9){_0x48bd33['mode']=_0x4dc747(0x215),_0x48bd33[_0x4dc747(0x20f)]=_0x4dc747(0x1fd)+_0x5850bd;}}else _0x48bd33[_0x4dc747(0x133)]=_0x4dc747(0x215),_0x48bd33[_0x4dc747(0x20f)]=_0x4dc747(0x1fd)+_0x5850bd;return _0x48bd33;}function getBotsWithMode(){const _0x707c57=_0x22bffb,_0x2b0320=dbConfig['get'](_0x707c57(0x24e))[_0x707c57(0x107)](_0x707c57(0x1cf))[_0x707c57(0x17f)]()||[];return _0x2b0320[_0x707c57(0x135)](_0x3df1d3=>{const _0x53b15b=_0x707c57;let _0x5ed287=getBotAttributes(_0x3df1d3[_0x53b15b(0x1cf)]);_0x3df1d3[_0x53b15b(0x133)]=_0x5ed287['mode'];}),_0x2b0320;}function getBotExchanges(){const _0x463493=_0x22bffb;let _0x41d62d=[];const _0x29e63c=dbConfig['get'](_0x463493(0x24e))['sortBy'](_0x463493(0x1cf))[_0x463493(0x17f)]()||[];_0x29e63c[_0x463493(0x135)](_0xd96929=>{const _0x6de3db=_0x463493;if(_0xd96929[_0x6de3db(0x10a)]=='enabled'){const _0x16c61a=configpath+_0x6de3db(0x174)+_0xd96929['botID']+'-config.json',_0x3b8bda=fs[_0x6de3db(0x2aa)](_0x16c61a);let _0x3af9d9;if(_0x3b8bda){const _0x1c656c=fs['readFileSync'](_0x16c61a);try{const _0xe88db=JSON[_0x6de3db(0x279)](_0x1c656c);_0x3af9d9=_0xe88db?_0xe88db['bot'][0x0][_0x6de3db(0x109)]:null;}catch(_0x100de7){}}if(_0x3af9d9)_0x41d62d[_0x6de3db(0x159)](_0x3af9d9);}});const _0x137336=[...new Set(_0x41d62d)][_0x463493(0xee)]();return _0x137336;}async function initUser(){const _0x19980c=_0x22bffb;if(!settings[_0x19980c(0x2b2)]){const _0x52f3d8=uuidRandom();mixpanel[_0x19980c(0x140)](_0x52f3d8),updateSetting(_0x19980c(0x2b2),_0x52f3d8);}}async function initSecure(){const _0x4338e3=_0x22bffb;let _0x455bba=getSecure();if(!_0x455bba[_0x4338e3(0x161)](_0x4338e3(0xf0))){let _0x522756=await generateKeys();_0x455bba[_0x4338e3(0x25a)]=_0x522756[_0x4338e3(0x25a)],_0x455bba[_0x4338e3(0x12a)]=_0x522756['privateKey'],_0x455bba['secret']=crypto[_0x4338e3(0x1cb)](0x20)[_0x4338e3(0x2ad)](_0x4338e3(0x233));;storeSecure(_0x455bba);}}function getSettings(){const _0x4d4426=_0x22bffb;return dbSettings[_0x4d4426(0x24b)](_0x4d4426(0x228))[_0x4d4426(0x17f)]()||{};}function getSecure(){const _0x52edff=_0x22bffb;return dbSecure[_0x52edff(0x24b)]('secure')[_0x52edff(0x17f)]()||{};}function getBlacklist(){const _0x1c9cb0=_0x22bffb;return dbSecure[_0x1c9cb0(0x24b)]('blacklist')[_0x1c9cb0(0x17f)]()||[];}function broadcastToBots(_0x2efc17,_0x5c59c5){const _0x1b7e1e=_0x22bffb;config[_0x1b7e1e(0x135)](_0x522d0a=>{const _0x5d3ffe=_0x1b7e1e;if(_0x522d0a[_0x5d3ffe(0x10a)]==_0x5d3ffe(0x14d)&&_0x522d0a[_0x5d3ffe(0x15d)]==_0x5d3ffe(0x185)||_0x522d0a[_0x5d3ffe(0x10a)]=='new'&&_0x522d0a['live']=='running'){if(pid[_0x522d0a[_0x5d3ffe(0x1cf)]])pid[_0x522d0a['botID']][_0x5d3ffe(0x17c)]({[_0x2efc17]:_0x5c59c5});}});}function storeSettings(_0x26b115,_0x48639b=![]){const _0x3a8bd5=_0x22bffb;_0x26b115={...settings,..._0x26b115};if(_0x48639b&&_0x26b115[_0x3a8bd5(0x194)]!=_0x3a8bd5(0x1fc)&&_0x26b115['bbPassword']!=_0x3a8bd5(0x12c)&&_0x26b115[_0x3a8bd5(0x194)]!=''){const _0x1e0b9c=crypt['decrypt'](secure[_0x3a8bd5(0x12a)],_0x26b115[_0x3a8bd5(0x194)])[_0x3a8bd5(0x291)][_0x3a8bd5(0x1b9)]('@')[0x0],_0x197c3e=bcrypt[_0x3a8bd5(0x16f)](_0x1e0b9c,saltRounds);_0x26b115={..._0x26b115,'bbPassword':_0x197c3e};}if(_0x48639b&&_0x26b115[_0x3a8bd5(0x1e6)]!='************'&&_0x26b115[_0x3a8bd5(0x1e6)]!=_0x3a8bd5(0x12c)&&_0x26b115['telegramToken']!=''){const _0x3c6b9c=crypt['decrypt'](secure['privateKey'],_0x26b115['telegramToken'])['message'][_0x3a8bd5(0x1b9)]('@')[0x0];_0x26b115={..._0x26b115,'telegramToken':_0x3c6b9c};}const _0xe75272=_0x26b115[_0x3a8bd5(0x1e6)]!=_0x3a8bd5(0x1fc)&&_0x26b115[_0x3a8bd5(0x1e6)]!=settings[_0x3a8bd5(0x1e6)]||_0x26b115[_0x3a8bd5(0x264)]!=settings[_0x3a8bd5(0x264)],_0x514ee5=_0x26b115[_0x3a8bd5(0x1e6)]==''||_0x26b115['telegramUsername']=='';if(_0xe75272)_0x26b115[_0x3a8bd5(0x105)]=_0x3a8bd5(0x1a7);for(const [_0xecff29,_0x16a3f7]of Object[_0x3a8bd5(0x178)](_0x26b115)){if(_0xecff29==_0x3a8bd5(0x1e6)&&_0x16a3f7==_0x3a8bd5(0x1fc)){_0x26b115[_0x3a8bd5(0x1e6)]=settings[_0x3a8bd5(0x1e6)];continue;};if(_0xecff29==_0x3a8bd5(0x194)&&_0x16a3f7==_0x3a8bd5(0x1fc)){_0x26b115[_0x3a8bd5(0x194)]=settings[_0x3a8bd5(0x194)];continue;};dbSettings[_0x3a8bd5(0x122)](_0x3a8bd5(0x1ee)+_0xecff29,_0x16a3f7)[_0x3a8bd5(0x16c)]();}settings=_0x26b115,io['to'](_0x3a8bd5(0x1f4))['emit']('settings',cleanSettings()),broadcastToBots(_0x3a8bd5(0x171),settings['timeshift']),broadcastToBots(_0x3a8bd5(0x28d),settings[_0x3a8bd5(0x28d)]);if(_0xe75272&&!_0x514ee5)initTelegram();if(_0xe75272&&_0x514ee5)disableTelegram();getAllClients()['forEach'](_0x11192e=>{const _0x41b710=_0x3a8bd5;getSocket(_0x11192e['id'])[_0x41b710(0x13f)](_0x41b710(0x10a),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x31c823,_0x4bad9e){const _0x1f2dab=_0x22bffb;dbSettings[_0x1f2dab(0x122)](_0x1f2dab(0x1ee)+_0x31c823,_0x4bad9e)[_0x1f2dab(0x16c)](),settings=getSettings(),io['to'](_0x1f2dab(0x1f4))[_0x1f2dab(0x13f)]('settings',cleanSettings());}function storeSecure(_0x32051){const _0x1cb7f5=_0x22bffb;dbSecure[_0x1cb7f5(0x24b)]('secure')[_0x1cb7f5(0x159)](_0x32051)[_0x1cb7f5(0x16c)](),secure=_0x32051;}function addBlacklist(_0x30cc93){const _0x3f4a2b=_0x22bffb;cleanBlacklist();let _0xe52fe1;devices[_0x30cc93][_0x3f4a2b(0x18a)]?_0xe52fe1=Math['max'](devices[_0x30cc93][_0x3f4a2b(0x18a)][_0x3f4a2b(0x2b7)],loginExpiry):_0xe52fe1=loginExpiry,dbSecure[_0x3f4a2b(0x24b)](_0x3f4a2b(0x18c))[_0x3f4a2b(0x159)]({'expiry':new Date()['getTime']()+_0xe52fe1*0x3c*0x3e8,'token':devices[_0x30cc93]['access']['token']})[_0x3f4a2b(0x16c)](),blacklist=dbSecure[_0x3f4a2b(0x24b)](_0x3f4a2b(0x18c))['value']();}function cleanBlacklist(){const _0x5a63e1=_0x22bffb;let _0x5c2573=dbSecure[_0x5a63e1(0x24b)](_0x5a63e1(0x18c))['cloneDeep']()['value'](),_0x3f4f01=new Date()['getTime']();_0x5c2573['forEach'](_0x5099b7=>{const _0x3cfdf9=_0x5a63e1;_0x5099b7[_0x3cfdf9(0x2b7)]<_0x3f4f01&&dbSecure[_0x3cfdf9(0x24b)](_0x3cfdf9(0x18c))[_0x3cfdf9(0x201)]({'expiry':_0x5099b7[_0x3cfdf9(0x2b7)]})[_0x3cfdf9(0x16c)]();});}function initStates(){const _0x55db40=_0x22bffb;let _0x1abdf5=getConfiguration();_0x1abdf5[_0x55db40(0x135)](_0x5b1506=>{const _0x9ed314=_0x55db40;_0x5b1506[_0x9ed314(0x15d)]=_0x9ed314(0x20c);}),storeConfiguration(_0x1abdf5);}function onKeys(){const _0x441c3f=new RSA();return new Promise(_0x3a2960=>{const _0x93f6f1=_0xba24;_0x441c3f[_0x93f6f1(0x267)]()[_0x93f6f1(0x1c5)](_0xcb150d=>{_0x3a2960(_0xcb150d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2af4ce=_0x22bffb;let _0x110a06=getSettings(),_0x2d669e=![];!_0x110a06['hasOwnProperty'](_0x2af4ce(0x143))&&(_0x110a06[_0x2af4ce(0x143)]=0x0,_0x2d669e=!![]);!_0x110a06[_0x2af4ce(0x161)](_0x2af4ce(0x1b7))&&(_0x110a06[_0x2af4ce(0x1b7)]=0x0,_0x2d669e=!![]);!_0x110a06[_0x2af4ce(0x161)](_0x2af4ce(0xec))&&(_0x110a06[_0x2af4ce(0xec)]=_0x2af4ce(0x25d),_0x2d669e=!![]);!_0x110a06[_0x2af4ce(0x161)](_0x2af4ce(0x28d))&&(_0x110a06['onepagemode']=![],_0x2d669e=!![]);if(_0x2d669e)storeSettings(_0x110a06);try{fs[_0x2af4ce(0x139)](configbackuppath,{'withFileTypes':!![]})[_0x2af4ce(0x135)](_0x1f2e3f=>{const _0x170bf5=_0x2af4ce;if(!_0x1f2e3f[_0x170bf5(0x271)]()){if(!_0x1f2e3f['name'][_0x170bf5(0x21d)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x1f2e3f['name']);}else fs[_0x170bf5(0x285)](configbackuppath+_0x1f2e3f[_0x170bf5(0x213)],{'recursive':!![]});});}catch(_0x4c35ec){logger[_0x2af4ce(0x23b)](_0x2af4ce(0x209),_0x4c35ec);}}function storeConfiguration(_0x3a8ec4){const _0x28f136=_0x22bffb;dbConfig['get']('bots')[_0x28f136(0x201)]()[_0x28f136(0x16c)](),_0x3a8ec4[_0x28f136(0x135)](_0x12c26c=>{const _0x3fa60e=_0x28f136;delete _0x12c26c[_0x3fa60e(0x133)];}),dbConfig[_0x28f136(0x24b)](_0x28f136(0x24e))[_0x28f136(0x159)](..._0x3a8ec4)[_0x28f136(0x16c)](),config=_0x3a8ec4;}function resetPassword(){const _0xa9648c=_0x22bffb;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0xa9648c(0x2bb)),tgBot[_0xa9648c(0x230)](settings[_0xa9648c(0xef)],_0xa9648c(0x100),{'parse_mode':_0xa9648c(0x11a),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0xa9648c(0x104)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x268408=>{telegramError(_0x268408);}),tgBot['on'](_0xa9648c(0x2bb),async _0x3a92cc=>{const _0x5bb286=_0xa9648c,_0x3682cb=_0x3a92cc[_0x5bb286(0x1a0)],_0x22f07e=_0x3a92cc['message'];tgBot['answerCallbackQuery'](_0x3a92cc['id'])[_0x5bb286(0x1c5)](async()=>{const _0x3c4c9f=_0x5bb286;if(_0x3682cb!='no'){const _0x5d465c=0xf,_0x2b73fe='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x42a98c=Array[_0x3c4c9f(0x1e1)](crypto[_0x3c4c9f(0x18b)](new Uint32Array(_0x5d465c)))['map'](_0x542cb2=>_0x2b73fe[_0x542cb2%_0x2b73fe[_0x3c4c9f(0x208)]])[_0x3c4c9f(0x24f)](''),_0x2130df=bcrypt['hashSync'](_0x42a98c,saltRounds);storeSettings({'bbPassword':_0x2130df}),await tgBot[_0x3c4c9f(0x230)](_0x22f07e[_0x3c4c9f(0x2ab)]['id'],_0x3c4c9f(0x160)+_0x42a98c,{'parse_mode':_0x3c4c9f(0x11a)})[_0x3c4c9f(0x28b)](_0x2a1344=>{telegramError(_0x2a1344);});}else await tgBot['sendMessage'](_0x22f07e['chat']['id'],_0x3c4c9f(0x170))[_0x3c4c9f(0x28b)](_0x278699=>{telegramError(_0x278699);});}),tgBot[_0x5bb286(0x134)](_0x5bb286(0x2bb));}));}async function confirmRestore(_0x182671,_0xb236a2){const _0x36b1da=_0x22bffb;io['to'](_0x36b1da(0x1f4))[_0x36b1da(0x13f)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x36b1da(0x162)),tgBot&&settings[_0x36b1da(0xef)]&&(tgBot[_0x36b1da(0x134)](_0x36b1da(0x2bb)),await tgBot[_0x36b1da(0x230)](settings[_0x36b1da(0xef)],_0x36b1da(0xf5),{'parse_mode':_0x36b1da(0x11a),'reply_markup':{'inline_keyboard':[[{'text':_0x36b1da(0x104),'callback_data':_0x36b1da(0x104)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x29393f=>{telegramError(_0x29393f);}),tgBot['on'](_0x36b1da(0x2bb),async _0xaa80b6=>{const _0x563874=_0x36b1da,_0x200be1=_0xaa80b6[_0x563874(0x1a0)],_0x38c5d2=_0xaa80b6['message'];tgBot[_0x563874(0x214)](_0xaa80b6['id'])[_0x563874(0x1c5)](async()=>{const _0x3c9885=_0x563874;_0x200be1==_0x3c9885(0x104)?(await tgBot[_0x3c9885(0x230)](_0x38c5d2[_0x3c9885(0x2ab)]['id'],_0x3c9885(0x28e),{'parse_mode':_0x3c9885(0x11a)})['catch'](_0x34ccb4=>{telegramError(_0x34ccb4);}),unzipFile(_0x182671,_0xb236a2)):(logger['debug'](_0x3c9885(0x21b)),await tgBot[_0x3c9885(0x230)](_0x38c5d2['chat']['id'],'Restore\x20process\x20aborted')[_0x3c9885(0x28b)](_0x430d6b=>{telegramError(_0x430d6b);}));}),tgBot[_0x563874(0x134)](_0x563874(0x2bb));}));}function getServerTime(){const _0x25c3e6=_0x22bffb,_0x304dae=new Date();return _0x304dae['getFullYear']()+'/'+(_0x304dae[_0x25c3e6(0x1c6)]()+0x1)[_0x25c3e6(0x2ad)]()[_0x25c3e6(0xfc)](0x2,'0')+'/'+_0x304dae[_0x25c3e6(0x10c)]()[_0x25c3e6(0x2ad)]()[_0x25c3e6(0xfc)](0x2,'0')+'\x20'+_0x304dae[_0x25c3e6(0x126)]()[_0x25c3e6(0x2ad)]()[_0x25c3e6(0xfc)](0x2,'0')+':'+_0x304dae[_0x25c3e6(0x26f)]()['toString']()['padStart'](0x2,'0')+':'+_0x304dae['getSeconds']()[_0x25c3e6(0x2ad)]()[_0x25c3e6(0xfc)](0x2,'0');}function getTimeStamp(){const _0x1b5df4=_0x22bffb,_0x52729a=shiftedTime();return _0x52729a['getFullYear']()+'/'+(_0x52729a[_0x1b5df4(0x1c6)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x52729a[_0x1b5df4(0x10c)]()[_0x1b5df4(0x2ad)]()[_0x1b5df4(0xfc)](0x2,'0')+'\x20'+_0x52729a[_0x1b5df4(0x126)]()[_0x1b5df4(0x2ad)]()[_0x1b5df4(0xfc)](0x2,'0')+':'+_0x52729a['getMinutes']()['toString']()[_0x1b5df4(0xfc)](0x2,'0')+':'+_0x52729a['getSeconds']()['toString']()[_0x1b5df4(0xfc)](0x2,'0');}function getCleanTimeStamp(){const _0x29d2e0=_0x22bffb,_0x2b03b1=shiftedTime();return _0x2b03b1[_0x29d2e0(0x2a0)]()+(_0x2b03b1['getMonth']()+0x1)[_0x29d2e0(0x2ad)]()['padStart'](0x2,'0')+_0x2b03b1[_0x29d2e0(0x10c)]()['toString']()['padStart'](0x2,'0')+'-'+_0x2b03b1[_0x29d2e0(0x126)]()[_0x29d2e0(0x2ad)]()['padStart'](0x2,'0')+_0x2b03b1[_0x29d2e0(0x26f)]()[_0x29d2e0(0x2ad)]()[_0x29d2e0(0xfc)](0x2,'0')+_0x2b03b1[_0x29d2e0(0x111)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x1d6210=_0x22bffb,_0x156e87=new Date();let _0x3e36d6=_0x156e87;if(settings[_0x1d6210(0x171)]&&settings['timeshift']!==0x0)_0x3e36d6=fns['add'](_0x156e87,{'hours':settings[_0x1d6210(0x171)]});return _0x3e36d6;}function startScheduler(){const _0x2d32d9=_0x22bffb,_0x6288cf=new Date()[_0x2d32d9(0x2a5)](),_0xf5d8b=shiftedTime()[_0x2d32d9(0x126)]();_0xf5d8b==0x4&&backupConfigFiles();_0xf5d8b==0x0&&rotateLogFiles();_0x6288cf%0x6==0x0&&triggerAnalytics();_0x6288cf%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4e780c){const _0x195bd9=_0x22bffb;logger['debug']('Restore\x20backup\x20file\x20'+_0x4e780c);const _0x19a5e1=getBotsWithMode();_0x19a5e1[_0x195bd9(0x208)]>0x0?confirmRestore(configbackuppath,_0x4e780c):unzipFile(configbackuppath,_0x4e780c);}async function getBackupFiles(_0x31c3a6=null){const _0xa1fc21=_0x22bffb;let _0x387192=[],_0x1588d1=fs[_0xa1fc21(0x139)](configbackuppath,{'withFileTypes':!![]});_0x1588d1[_0xa1fc21(0xee)]((_0x423d8c,_0x3d4c0e)=>_0x423d8c['name']<_0x3d4c0e[_0xa1fc21(0x213)]?0x1:_0x3d4c0e[_0xa1fc21(0x213)]<_0x423d8c['name']?-0x1:0x0),_0x1588d1[_0xa1fc21(0x135)](_0x345400=>{const _0x326c9a=_0xa1fc21;if(!_0x345400[_0x326c9a(0x271)]()&&_0x345400[_0x326c9a(0x213)][_0x326c9a(0x21d)](_0x326c9a(0xff))&&_0x345400[_0x326c9a(0x213)][_0x326c9a(0x2c0)](_0x326c9a(0x219))){const _0x342198=formatDate(fs[_0x326c9a(0x2b3)](configbackuppath+_0x345400['name'])[_0x326c9a(0x197)]);_0x387192[_0x326c9a(0x159)]({'name':_0x345400[_0x326c9a(0x213)],'mtime':_0x342198});}});if(_0x31c3a6)io['to'](_0x31c3a6)[_0xa1fc21(0x13f)](_0xa1fc21(0x1dd),_0x387192);else return _0x387192;}async function backupConfigFiles(){const _0x4af152=_0x22bffb;await zipFiles(_0x4af152(0x277));const _0x3179d4=getCleanTimeStamp();fs[_0x4af152(0x20b)](zippath+_0x4af152(0x203),configbackuppath+(_0x4af152(0xff)+_0x3179d4+_0x4af152(0x219)));let _0x1eb8fd=fs[_0x4af152(0x139)](configbackuppath,{'withFileTypes':!![]});_0x1eb8fd[_0x4af152(0xee)]((_0x17039a,_0x5655a7)=>_0x17039a[_0x4af152(0x213)]<_0x5655a7['name']?0x1:_0x5655a7[_0x4af152(0x213)]<_0x17039a[_0x4af152(0x213)]?-0x1:0x0),_0x1eb8fd[_0x4af152(0x208)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x1eb8fd[_0x1eb8fd[_0x4af152(0x208)]-0x1][_0x4af152(0x213)]);}function rotateLogFiles(){const _0x35a738=_0x22bffb,_0x506139=fs['statSync'](logspath+'output-000.log'),_0x5377d5=_0x506139[_0x35a738(0x21e)]/0x400;if(_0x5377d5>0x64){let _0x1722c9=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x1722c9[_0x35a738(0xee)]((_0x3466ac,_0x50cf2b)=>_0x3466ac['name']<_0x50cf2b[_0x35a738(0x213)]?0x1:_0x50cf2b[_0x35a738(0x213)]<_0x3466ac[_0x35a738(0x213)]?-0x1:0x0),_0x1722c9['forEach'](_0x17a486=>{const _0x2ec14f=_0x35a738;if(_0x17a486[_0x2ec14f(0x213)]==_0x2ec14f(0x222))fs[_0x2ec14f(0x20b)](logspath+_0x17a486[_0x2ec14f(0x213)],logspath+_0x2ec14f(0xe6));if(_0x17a486[_0x2ec14f(0x213)]==_0x2ec14f(0x1d8))fs[_0x2ec14f(0x20b)](logspath+_0x17a486[_0x2ec14f(0x213)],logspath+_0x2ec14f(0x222));_0x17a486[_0x2ec14f(0x213)]==_0x2ec14f(0x282)&&(fs[_0x2ec14f(0x20b)](logspath+_0x17a486[_0x2ec14f(0x213)],logspath+_0x2ec14f(0x1d8)),fs['writeFileSync'](logspath+_0x17a486['name'],''));});}}async function zipFiles(_0x24cb99){const _0xc564e9=_0x22bffb;let _0x1c3bd4;if(_0x24cb99==_0xc564e9(0x1e9))_0x1c3bd4=logspath;if(_0x24cb99==_0xc564e9(0x1bf))_0x1c3bd4=configpath;if(_0x24cb99==_0xc564e9(0x277))_0x1c3bd4=configpath;let _0x415885=fs['readdirSync'](_0x1c3bd4,{'withFileTypes':!![]});const _0x5ca408=new require(_0xc564e9(0x27e))();_0x415885[_0xc564e9(0x135)](_0x346c00=>{const _0x405fe1=_0xc564e9;if(!_0x346c00[_0x405fe1(0x271)]()){let _0x15f4da=fs[_0x405fe1(0x149)](_0x1c3bd4+_0x346c00['name']);if(_0x24cb99==_0x405fe1(0x1bf)){const _0x3c9a6f=/^bot-[0-9]{3}-config.json$/,_0x1c2220=_0x3c9a6f[_0x405fe1(0x1da)](_0x346c00[_0x405fe1(0x213)]);if(_0x1c2220){const _0x319e0a=JSON[_0x405fe1(0x279)](_0x15f4da);if(_0x319e0a[_0x405fe1(0x1f0)][0x0]){_0x319e0a[_0x405fe1(0x1f0)][0x0][_0x405fe1(0x158)]=_0x405fe1(0x12c),_0x319e0a['bot'][0x0][_0x405fe1(0x220)]=_0x405fe1(0x12c);if(_0x319e0a[_0x405fe1(0x1f0)][0x0][_0x405fe1(0x259)])_0x319e0a['bot'][0x0]['apiPassword']=_0x405fe1(0x12c);}_0x15f4da=JSON[_0x405fe1(0x196)](_0x319e0a,null,0x2);}if(_0x346c00[_0x405fe1(0x213)]==_0x405fe1(0x108)){const _0x8c38af=JSON[_0x405fe1(0x279)](_0x15f4da);if(_0x8c38af['settings'][_0x405fe1(0x26e)])_0x8c38af[_0x405fe1(0x228)]['loginRequired']=![];if(_0x8c38af[_0x405fe1(0x228)][_0x405fe1(0x194)])_0x8c38af[_0x405fe1(0x228)]['bbPassword']=_0x405fe1(0x12c);if(_0x8c38af[_0x405fe1(0x228)][_0x405fe1(0x1e6)])_0x8c38af[_0x405fe1(0x228)][_0x405fe1(0x1e6)]=_0x405fe1(0x12c);if(_0x8c38af[_0x405fe1(0x228)]['telegramChatId'])_0x8c38af[_0x405fe1(0x228)][_0x405fe1(0xef)]=null;_0x15f4da=JSON[_0x405fe1(0x196)](_0x8c38af,null,0x2);}if(_0x346c00['name']!='bb-secure.json')_0x5ca408[_0x405fe1(0x155)](_0x346c00[_0x405fe1(0x213)],_0x15f4da);}else _0x5ca408[_0x405fe1(0x155)](_0x346c00['name'],_0x15f4da);}});const _0x50c050=_0x5ca408[_0xc564e9(0x12d)]({'base64':![],'compression':_0xc564e9(0x123)});fs['writeFileSync'](zippath+(_0x24cb99+_0xc564e9(0x219)),_0x50c050,_0xc564e9(0x141));}async function unzipFile(_0x4a0538,_0x45afc3){const _0x17df8e=_0x22bffb;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0xf8d841=>{const _0x314563=_0xba24;if(!_0xf8d841[_0x314563(0x271)]())fs[_0x314563(0x285)](configpath+_0xf8d841[_0x314563(0x213)]);});const _0x181d74=fs[_0x17df8e(0x149)](_0x4a0538+_0x45afc3,_0x17df8e(0x141)),_0x2b0abf=new require('node-zip')(_0x181d74,{'base64':![],'checkCRC32':!![]});Object[_0x17df8e(0x166)](_0x2b0abf[_0x17df8e(0x125)])[_0x17df8e(0x135)](_0x507d63=>{const _0x40b367=_0x17df8e,_0x3bef9e=_0x2b0abf[_0x40b367(0x125)][_0x507d63];fs[_0x40b367(0x205)](configpath+_0x3bef9e[_0x40b367(0x213)],_0x3bef9e[_0x40b367(0x13c)]);}),fs[_0x17df8e(0x139)](temppath,{'withFileTypes':!![]})['forEach'](_0x1b4726=>{const _0x3994be=_0x17df8e;if(!_0x1b4726['isDirectory']())fs[_0x3994be(0x285)](temppath+_0x1b4726[_0x3994be(0x213)]);}),logger[_0x17df8e(0x23b)](_0x17df8e(0x1d7)),process['send']({'restore':!![]},_0x2e2b6d=>{});}async function getPublicIp(){const _0x46a300=_0x22bffb;try{const _0x201f81=await axios['get']('https://api.ipify.org?format=json');publicip=_0x201f81[_0x46a300(0x1a0)]['ip'];}catch(_0x29d23a){}}async function triggerAnalytics(){const _0x1bb3c2=_0x22bffb;if(!publicip)await getPublicIp();const _0x1e48b1=getBotsWithMode();let _0x25e293=0x0;_0x1e48b1['forEach'](_0x41f1d9=>{const _0x34fbfa=_0xba24;if(_0x41f1d9[_0x34fbfa(0x10a)]==='enabled')_0x25e293++;});const _0x79dee8=getBotExchanges();mixpanel['track'](_0x1bb3c2(0x101),{'distinct_id':settings[_0x1bb3c2(0x2b2)],'ip':publicip,'version':serverversion,'numbots':_0x1e48b1[_0x1bb3c2(0x208)],'numbotsenabled':_0x25e293,'exchanges':_0x79dee8});}async function getMessages(){const _0x46aa21=_0x22bffb,_0x50fe7f=_0x46aa21(0x14b),_0x5c5ecc=new GraphQLClient(_0x50fe7f),_0x4ac2fe={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x38c3b7=serverversion[_0x46aa21(0x1b9)]('.'),_0x1501a7=_0x38c3b7[0x0]+'.'+_0x38c3b7[0x1],_0x444d72=Math['min'](settings[_0x46aa21(0x143)],settings[_0x46aa21(0x1b7)]),_0x854105={'last':parseInt(_0x444d72),'bbm':_0x1501a7},_0x44469c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x28d31a;try{_0x28d31a=await _0x5c5ecc[_0x46aa21(0x218)](_0x44469c,_0x854105,_0x4ac2fe);}catch(_0x19446d){}if(_0x28d31a&&_0x28d31a[_0x46aa21(0xfa)]){let _0x4f3dc1=settings[_0x46aa21(0x143)];newMessages=[];for(const _0x4a185c of _0x28d31a['messages']){newMessages[_0x46aa21(0x159)](_0x4a185c);if(_0x4a185c[_0x46aa21(0x1a1)])updateSetting(_0x46aa21(0xec),_0x4a185c[_0x46aa21(0x1a1)]);let _0x411a06=_0x4a185c[_0x46aa21(0x1a1)]?serverversion>=_0x4a185c[_0x46aa21(0x1a1)]:![];if(!_0x411a06&&_0x4a185c[_0x46aa21(0x1d5)]>_0x4f3dc1){if(_0x4a185c[_0x46aa21(0x131)]===_0x46aa21(0x1b6)||serverversion['startsWith'](_0x4a185c[_0x46aa21(0x131)])){let _0x5ed449=''+_0x4a185c[_0x46aa21(0x237)]+'\x0a\x0a'+_0x4a185c[_0x46aa21(0x291)];const _0x537f3d=await sendTelegramMsg(toTelegramMarkdown(_0x5ed449),'Markdown');if(_0x537f3d)_0x4f3dc1=_0x4a185c['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x46aa21(0x143),_0x4f3dc1),emitMessages();}}function emitMessages(){const _0x4708ba=_0x22bffb,_0x5ad4c3=settings[_0x4708ba(0x1b7)];let _0x501a4e=[];newMessages[_0x4708ba(0x135)](_0x39dfbe=>{const _0x1509c0=_0x4708ba;_0x39dfbe[_0x1509c0(0x1d5)]>_0x5ad4c3&&_0x501a4e[_0x1509c0(0x159)](_0x39dfbe);}),_0x501a4e[_0x4708ba(0x208)]>0x0&&getAllClients()[_0x4708ba(0x135)](_0x3a09d0=>{const _0x1040b5=_0x4708ba;getSocket(_0x3a09d0['id'])[_0x1040b5(0x13f)](_0x1040b5(0x291),_0x501a4e);});}function confirmMessage(_0x83c470){const _0x535529=_0x22bffb;updateSetting(_0x535529(0x1b7),Number(_0x83c470));}function isNewerVersion(_0x4864f1,_0x581786){const _0x5d39df=_0x22bffb,_0x252aa2=_0x581786[_0x5d39df(0x1b9)]('.'),_0x14c864=_0x4864f1['split']('.');for(var _0x26f791=0x0;_0x26f791<_0x14c864[_0x5d39df(0x208)];_0x26f791++){const _0x4015a4=~~_0x14c864[_0x26f791],_0x5b53dc=~~_0x252aa2[_0x26f791];if(_0x4015a4>_0x5b53dc)return!![];if(_0x4015a4<_0x5b53dc)return![];}return![];}function toTelegramMarkdown(_0x4b53ed){const _0x131d35=_0x22bffb,_0x5b2051=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x432139=/\*{2}(.+?)\*{2}/gim;return _0x4b53ed=_0x4b53ed['replace'](_0x5b2051,_0x131d35(0x150))[_0x131d35(0x22e)](_0x432139,'*$1*'),_0x4b53ed;}async function validateConfigFile(){const _0x4f43fc=_0x22bffb,_0x1b1014=dbConfig[_0x4f43fc(0x24b)](_0x4f43fc(0x24e))[_0x4f43fc(0x107)](_0x4f43fc(0x1cf))['value']()||[];if(_0x1b1014['length']==0x0){let _0x557545=0x0,_0xcf2d3c=[];const _0xf13304=/^bot-([0-9]{3})-config.json$/,_0x1a04ff=fs['readdirSync'](configpath);_0x1a04ff['forEach'](_0x466465=>{const _0x49a7c7=_0x4f43fc,_0x35316a=_0xf13304[_0x49a7c7(0x16e)](_0x466465);if(_0x35316a){const _0x1613e0=_0x35316a[0x1];let _0x29dc4e=getBotAttributes(_0x1613e0);_0xcf2d3c['push']({'botID':_0x1613e0,'botname':_0x29dc4e[_0x49a7c7(0x20f)],'status':'disabled','live':'stopped'}),_0x557545++;}}),_0x557545!=0x0&&(dbConfig['get'](_0x4f43fc(0x24e))[_0x4f43fc(0x29d)](_0xcf2d3c)['write'](),config=_0xcf2d3c,restoredConfigFile=_0x557545);}}async function restoreConfigNotify(_0x643708){const _0x346553=_0x22bffb;let _0x40d4a6;if(restoredConfigFile==0x1)_0x40d4a6=_0x346553(0x295);else _0x40d4a6=_0x346553(0x1b8);if(_0x643708)io['to'](_0x346553(0x1f4))['emit'](_0x346553(0x192),_0x40d4a6);else{logger[_0x346553(0x146)](_0x346553(0x17a)),logger[_0x346553(0x146)](_0x40d4a6),logger[_0x346553(0x146)](_0x346553(0x17a)),logger[_0x346553(0x146)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x346553(0x105)]!=_0x346553(0x1af))tgBot[_0x346553(0x230)](settings[_0x346553(0xef)],_0x346553(0xed)+_0x40d4a6)[_0x346553(0x28b)](_0x4536e4=>{telegramError(_0x4536e4);});}}function validateCredentials(_0x2b9440,_0x298aad){const _0x399590=_0x22bffb;if(_0x2b9440[_0x399590(0x163)]==settings[_0x399590(0x11e)]&&bcrypt[_0x399590(0x1a4)](_0x2b9440[_0x399590(0x29f)],settings[_0x399590(0x194)])){if(settings[_0x399590(0x1e2)])return{'allow':![],'reason':_0x399590(0xf6),'token':null};else{const _0x138df4=generateLoginToken(_0x298aad);return{'allow':!![],'reason':_0x399590(0x137),'token':_0x138df4};}}else return{'allow':![],'reason':_0x399590(0x187),'token':null};}function refreshToken(_0x3693f9){const _0x36c0e3=_0x22bffb,_0x58c473=generateLoginToken(_0x3693f9);return{'allow':!![],'reason':_0x36c0e3(0x137),'token':_0x58c473};}function validateAccess(_0x3fd332,_0x14b10a,_0x4d126f){const _0x4b4211=_0x22bffb,_0xa29fb1=_0x4d126f?_0x4d126f:devices[_0x14b10a]['ip'];let _0x2c094f;const _0x150a6f=_0x4c539c=>{const _0x56cc7a=_0xba24;if(settings[_0x56cc7a(0x26e)]){if(settings[_0x56cc7a(0x1e2)]){if(telegram2FaApproved(_0x14b10a)){const _0x209b07=generateLoginToken(_0x14b10a);return{'allow':!![],'reason':_0x56cc7a(0x22c),'token':_0x209b07};}else return{'allow':![],'reason':_0x56cc7a(0x1dc),'token':null};}else return _0x2c094f=validToken(_0x4c539c,_0x14b10a),_0x2c094f[_0x56cc7a(0x161)]('success')?{'allow':!![],'reason':_0x56cc7a(0x1de),'token':_0x4c539c}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x56cc7a(0x2ae),'token':null};};if(settings[_0x4b4211(0x262)]){let _0x5d4820=[...settings[_0x4b4211(0x1ad)],_0x4b4211(0x248),_0x4b4211(0x28f),_0x4b4211(0x1ba)];if(_0x5d4820[_0x4b4211(0x1ce)](_0xa29fb1))return _0x150a6f(_0x3fd332);else{_0x2c094f=validToken(_0x3fd332,_0x14b10a);if(_0x2c094f[_0x4b4211(0x161)]('success'))return _0x150a6f(_0x3fd332);else{if(telegramIpApproved(_0x14b10a)){const _0x34cf4d=generateToken(_0x14b10a);return _0x2c094f=_0x150a6f(_0x3fd332),_0x2c094f[_0x4b4211(0x225)]?{'allow':!![],'reason':_0x4b4211(0x12f),'token':_0x34cf4d}:_0x2c094f;}else return settings[_0x4b4211(0x1fb)]?{'allow':![],'reason':_0x4b4211(0xe9),'token':null}:{'allow':![],'reason':_0x4b4211(0x27b),'token':null};}}}else return _0x150a6f(_0x3fd332);}function timelyDecrypt(_0x28b125,_0x58fef5=!![]){const _0x343aa5=_0x22bffb;if(_0x28b125)try{const _0x6aa3a7=crypt[_0x343aa5(0x263)](secure[_0x343aa5(0x12a)],_0x28b125)[_0x343aa5(0x291)],_0x30adcd=_0x6aa3a7[_0x343aa5(0x1b9)]('@')[0x0],_0x33d5ac=_0x6aa3a7[_0x343aa5(0x1b9)]('@')[0x1],_0xbae20a=new Date()[_0x343aa5(0x280)]();if(_0x58fef5){if(_0xbae20a-_0x33d5ac<maxSecretAge*0x3e8)return _0x30adcd;else return![];}else return _0x30adcd;}catch(_0x532881){return![];}else return![];}const validToken=(_0x3560fb,_0x566ccc)=>{const _0x11a9b8=_0x22bffb,_0x55ccf2=devices[_0x566ccc]['ip'];if(!_0x3560fb)return{'error':'No\x20authentication\x20token'};for(let _0x269df7 of blacklist){if(_0x269df7[_0x11a9b8(0x204)]==_0x3560fb)return{'error':'Token\x20blacklisted'};}let _0x2c406e;try{_0x2c406e=jwt[_0x11a9b8(0x26d)](_0x3560fb,secure['secret']+_0x566ccc);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x2c406e[_0x11a9b8(0x161)](_0x11a9b8(0x1ca))&&!_0x2c406e[_0x11a9b8(0x161)](_0x11a9b8(0x163))||!_0x2c406e[_0x11a9b8(0x161)](_0x11a9b8(0x235)))return{'error':_0x11a9b8(0x206)};if(!_0x2c406e[_0x11a9b8(0x161)](_0x11a9b8(0x163))&&_0x2c406e[_0x11a9b8(0x161)]('clientip')){const {clientip:_0x2eeee5}=_0x2c406e;return _0x55ccf2==_0x2eeee5?{'success':_0x11a9b8(0x182)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x2c406e['hasOwnProperty']('username')&&_0x2c406e['hasOwnProperty'](_0x11a9b8(0x1ca))){const {username:_0x419d3b,clientip:_0x4d5e9b}=_0x2c406e;return settings[_0x11a9b8(0x11e)]==_0x419d3b&&_0x55ccf2==_0x4d5e9b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x11a9b8(0x14c)};}}},generateLoginToken=_0x42f220=>{const _0x3c043c=_0x22bffb;if(_0x42f220){const _0x5e1f20=devices[_0x42f220]['ip'];return jwt[_0x3c043c(0x1ef)]({'username':settings['bbUsername'],'clientip':_0x5e1f20},secure[_0x3c043c(0xf0)]+_0x42f220,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x146913=>{const _0x3bf8ec=_0x22bffb;if(_0x146913){const _0x5980c2=devices[_0x146913]['ip'];return jwt[_0x3bf8ec(0x1ef)]({'clientip':_0x5980c2},secure['secret']+_0x146913,{'expiresIn':devices[_0x146913][_0x3bf8ec(0x18a)][_0x3bf8ec(0x2b7)]*0x3c});}else return![];},telegramIpApproved=_0x4ee88f=>{const _0x5fa71c=_0x22bffb;let _0x46aaff=![];return devices[_0x4ee88f]['telegramIpApproval']&&devices[_0x4ee88f][_0x5fa71c(0x18a)][_0x5fa71c(0x2b7)]!='reject'&&(_0x46aaff=devices[_0x4ee88f][_0x5fa71c(0x18a)]['clientip']==devices[_0x4ee88f]['ip']&&new Date()[_0x5fa71c(0x280)]()-devices[_0x4ee88f][_0x5fa71c(0x18a)][_0x5fa71c(0x1f5)]<devices[_0x4ee88f][_0x5fa71c(0x18a)]['expiry']*0x3c*0x3e8),_0x46aaff;},telegram2FaApproved=_0x17b622=>{const _0x1ba55a=_0x22bffb;let _0x23998f=![];return devices[_0x17b622][_0x1ba55a(0x176)]&&devices[_0x17b622]['telegram2FaApproval'][_0x1ba55a(0x2b7)]!=_0x1ba55a(0x272)&&(_0x23998f=devices[_0x17b622]['telegram2FaApproval'][_0x1ba55a(0x1ca)]==devices[_0x17b622]['ip']&&new Date()[_0x1ba55a(0x280)]()-devices[_0x17b622][_0x1ba55a(0x176)]['timestamp']<devices[_0x17b622]['telegram2FaApproval'][_0x1ba55a(0x2b7)]*0x3c*0x3e8),_0x23998f;},normalizeIP=_0x501e86=>{const _0x2f0866=_0x22bffb;let _0x374684=null,_0x56d48f=null;if(ipaddr[_0x2f0866(0x1f6)](_0x501e86)){const _0x5b584e=ipaddr[_0x2f0866(0x279)](_0x501e86);_0x5b584e['kind']()==='ipv6'?(_0x5b584e['isIPv4MappedAddress']()&&(_0x374684=_0x5b584e['toIPv4Address']()[_0x2f0866(0x2ad)]()),_0x56d48f=_0x5b584e[_0x2f0866(0x2ad)]()):(_0x374684=_0x5b584e[_0x2f0866(0x2ad)](),_0x56d48f=_0x5b584e['toIPv4MappedAddress']()[_0x2f0866(0x2ad)]());}return{'show':_0x374684?_0x374684:_0x56d48f,'store':_0x56d48f};};function formatDate(_0x250658){const _0x235154=_0x22bffb;return _0x250658['getFullYear']()+'/'+(_0x250658['getMonth']()+0x1)['toString']()[_0x235154(0xfc)](0x2,'0')+'/'+_0x250658[_0x235154(0x10c)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x250658['getHours']()[_0x235154(0x2ad)]()[_0x235154(0xfc)](0x2,'0')+':'+_0x250658['getMinutes']()[_0x235154(0x2ad)]()[_0x235154(0xfc)](0x2,'0')+':'+_0x250658['getSeconds']()[_0x235154(0x2ad)]()[_0x235154(0xfc)](0x2,'0');}function sleep(_0x244128){return new Promise(_0x6bee54=>setTimeout(_0x6bee54,_0x244128));}