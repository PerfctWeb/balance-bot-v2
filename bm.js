const _0x3ea1f7=_0x17b4;(function(_0x57442d,_0xa87acf){const _0x14bf9e=_0x17b4,_0x257e24=_0x57442d();while(!![]){try{const _0xcff54b=parseInt(_0x14bf9e(0xfe))/0x1*(parseInt(_0x14bf9e(0x189))/0x2)+-parseInt(_0x14bf9e(0x1d8))/0x3*(parseInt(_0x14bf9e(0x256))/0x4)+-parseInt(_0x14bf9e(0x143))/0x5*(-parseInt(_0x14bf9e(0x24f))/0x6)+-parseInt(_0x14bf9e(0x24b))/0x7+-parseInt(_0x14bf9e(0x19a))/0x8+-parseInt(_0x14bf9e(0x269))/0x9*(-parseInt(_0x14bf9e(0xe0))/0xa)+parseInt(_0x14bf9e(0x284))/0xb;if(_0xcff54b===_0xa87acf)break;else _0x257e24['push'](_0x257e24['shift']());}catch(_0x55cf1d){_0x257e24['push'](_0x257e24['shift']());}}}(_0x1af9,0x237f6));const _0x4663f6=function(){let _0x30905b=!![];return function(_0x4ca740,_0x16e39f){const _0x37be83=_0x30905b?function(){if(_0x16e39f){const _0xa8cc53=_0x16e39f['apply'](_0x4ca740,arguments);return _0x16e39f=null,_0xa8cc53;}}:function(){};return _0x30905b=![],_0x37be83;};}(),_0x3d14c0=_0x4663f6(this,function(){const _0x304b31=_0x17b4;return _0x3d14c0[_0x304b31(0xf8)]()[_0x304b31(0xd6)](_0x304b31(0x153))['toString']()['constructor'](_0x3d14c0)[_0x304b31(0xd6)](_0x304b31(0x153));});_0x3d14c0();'use strict';process[_0x3ea1f7(0x229)][_0x3ea1f7(0x10d)]=0x1;const childProcess=require(_0x3ea1f7(0x10a)),fs=require('fs'),fns=require(_0x3ea1f7(0x1c7)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require('crypto'),Crypt=require(_0x3ea1f7(0x24e))[_0x3ea1f7(0xdf)],RSA=require('hybrid-crypto-js')[_0x3ea1f7(0x115)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x3ea1f7(0x1fb)),argv=require(_0x3ea1f7(0x28b))(process[_0x3ea1f7(0x1f2)][_0x3ea1f7(0x1c0)](0x2))[_0x3ea1f7(0x1f2)],uuidRandom=require(_0x3ea1f7(0x164)),TelegramBot=require(_0x3ea1f7(0x158)),Mixpanel=require(_0x3ea1f7(0x203)),axios=require('axios'),{GraphQLClient,gql}=require(_0x3ea1f7(0x233)),util=require(_0x3ea1f7(0x1ac)),fileUpload=require(_0x3ea1f7(0x28c)),PORT=argv[_0x3ea1f7(0x280)]||_0x3ea1f7(0x265),pattern=/^[0-9]{2,4}$/;!pattern[_0x3ea1f7(0x10e)](PORT)&&(console[_0x3ea1f7(0x1fe)](_0x3ea1f7(0x1d1)+PORT+_0x3ea1f7(0x23b)),process[_0x3ea1f7(0x163)](0x1));const HOST=argv[_0x3ea1f7(0x167)]||null,userID=argv['user']||'',debugging=argv['d']||![];let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0x3ea1f7(0x199),settingsfile=_0x3ea1f7(0x104),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3ea1f7(0x1dd)),configpath=userID?bbpath+_0x3ea1f7(0x15d)+userID+'/':bbpath+_0x3ea1f7(0x15d),configbackuppath=configpath+_0x3ea1f7(0x174),logspath=userID?bbpath+_0x3ea1f7(0x1f9)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x3ea1f7(0x215)+userID+'/':bbpath+_0x3ea1f7(0x215),loggerfile=fs[_0x3ea1f7(0x277)](logspath+_0x3ea1f7(0x14e),{'flags':'a'}),temppath=userID?bbpath+_0x3ea1f7(0x170)+userID+'/':bbpath+_0x3ea1f7(0x170);!fs[_0x3ea1f7(0x255)](configpath)&&fs[_0x3ea1f7(0x20c)](configpath);!fs[_0x3ea1f7(0x255)](configbackuppath)&&fs[_0x3ea1f7(0x20c)](configbackuppath);!fs[_0x3ea1f7(0x255)](logspath)&&fs[_0x3ea1f7(0x20c)](logspath);function _0x1af9(){const _0x307190=['-events.json','answerCallbackQuery','temp/','set','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Server','backup/','telegramIpApproval','restart','Unauthorized\x20attempt\x20to\x20download\x20','-results.json','https://api.ipify.org?format=json','-----------------------------------------------------------------------------------','rmSync','entries','show','getSeconds','isValid','filter','use','stop','temporary\x20access\x20timeout','number','send','telegrammsg','Invalid\x20username\x20or\x20IP\x20address','*$1*','85498tXkIGM','stopped','length','SIGINT','5\x20min','headless','\x20only\x0a','replace','restarting\x20Bot\x20','backup-files','post','password','Unauthorized\x20attempt\x20to\x20add\x20bot','value','backupfile','find','bb-config.json','1779728CDikUb','orders','getUTCHours','cancel-loading',':\x20Bot\x20Mgr\x20>\x20','kill','hasOwnProperty','callback_query','Allow\x20login\x20from\x20IP\x20address\x20<b>','messages','removeListener','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','\x20mode','version.json','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','username','all','util','conn','Unauthorized\x20attempt\x20to\x20confirm\x20message','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','initclient','Password\x20has\x20been\x20reset\x20to:\x20','.zip','toIPv4Address','Failed\x20to\x20download\x20','socket.io','update-bot','sha256','then','running','Logged\x20out\x20user\x20...','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Login\x20rejected','readFileSync','event','token','slice','clientip','add','forEach','message','decrypt','file','date-fns','telegramChatId','Unauthorized\x20attempt\x20to\x20delete\x20bot','bot','temporaryAccessAllowed','enabled','telegram2FaApproval','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','login\x20not\x20required','access','Error:\x20Invalid\x20argument\x20','files','error','inherit','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','171NkOAhD','place-order','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Ok,\x20will\x20send\x20alert\x20notifications\x20only','output-000.log','clients','/update\x20-\x20update\x20Balance\x20Bot\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','userid','data','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','endsWith','loginRequired','name','notification','disabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','fork','-performance.json','secret','build','temporary\x20token\x20generated','bbvNew','push','argv','login\x20token\x20generated','/on\x20-\x20start\x20bot(s)\x0a','allow','bots','backup','pidExpireLogin','logs/','status','ipaddr.js','init','sockets','log','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','::1','exec','lastmsgtelegram','mixpanel','track','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','apiKey','chat','node-zip','/names\x20-\x20show\x20bot\x20names\x0a','store-headless','Backup\x20file\x20uploaded','mkdirSync','getFullYear','getTime','2FA\x20login\x20required','1000','output-003.log','Unauthorized\x20attempt\x20to\x20update\x20bot','Restoring\x20bot(s)\x20from\x20backup','storeConfiguration','zip/','/:bot/portfolio','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','verify','Temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20log\x20out','timestamp','hashSync','emitHistory','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20store\x20configuration','static','function','debug','invalid\x20credentials','bbvReceive','getMonth','restore-backup-file','includes','once','env','/:bot/history','telegram','\x20to\x20','blacklist','get-messages','statSync','polling_error','sendFile','/:bot','graphql-request','copyFileSync','showname','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/download/:type','format','sort','success',',\x20must\x20be\x20a\x204\x20digit\x20number','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','removeAllListeners','assign','mode','createServer','store-settings','update-bb','storeHeadless','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bbPassword','lastmsgemitted','ipv6','temporary\x20access\x20rejected','bbUsername','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','1369102DuOAJj','cloneDeep','getStartingBalances','hybrid-crypto-js','186ljQpeW','2FA\x20login\x20rejected','parse','type','isIPv4MappedAddress','botname','existsSync','6764fTEdHr','Starting\x20Balance\x20Bot\x20update','All\x20bots','starting\x20new\x20bot\x20|\x20Bot\x20','login','catch','0.0.0','min','Unauthorized\x20attempt\x20to\x20show\x20configuration','socket','\x20|\x20','reload','defaults','get','apiSecret','3000','telegramEnabled','stringify','ipc','137241vQNayZ','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','error\x20while\x20deleting\x20config\x20files:\x20','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','/enable\x20-\x20enable\x20notifications\x0a','botmanager','starting\x20bot\x20|\x20Bot\x20','botID','join','max','Notifications\x20enabled\x0a','2FA','<b>Balance\x20Bot\x20Status:</b>\x0a','30\x20min','createWriteStream','Bot\x20','output-001.log','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20delete\x20alerts','15\x20min','Setting\x20access:\x20','404\x20Not\x20Found','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','port','</b>\x20?','reason','access\x20timeout','3659755YaMaEn','build2','kind','new','Invalid\x20Telegram\x20token','live','from','yargs/yargs','express-fileupload','f2aRequired','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','store','headers','settings','HTML','reject','api-eu.mixpanel.com','Token\x20blacklisted','write','timeshift','readdirSync','search','telegramUsername','update','logs','params','publicKey','startsWith','login\x20token\x20valid','-config.json','Crypt','140SCARFq','2FA\x20required','simple','stopPolling','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','emit','express','All','storeFiat','yes','handshake','/disable\x20-\x20disable\x20notifications\x0a','idling\x20bot\x20\x20\x20|\x20Bot\x20','getDate','Restore\x20process\x20aborted','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20get\x20events','deleted\x20Bot\x20','sendPortfolioTelegram','getHours','secure','login\x20required','reset-history','bb-secure.json','toString','alerts','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','DEFLATE','remoteAddress','Invalid\x20authentication\x20token\x20(1)','1brtsvS','Notifications\x20types:\x20','Alerts','Password\x20reset\x20rejected','match','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','bb-settings.json','RSA-OAEP','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','listen','map','latestversion','child_process','User\x20has\x20been\x20validated','pidRefreshToken','NTBA_FIX_319','test','Invalid\x20authentication\x20token\x20(2)','Backup\x20file\x20unzipped\x20and\x20stored','Notifications\x20enabled','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20login\x20attempt\x20(timeout)','/metrics\x20-\x20show\x20bot\x20performance\x0a','RSA','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','::ffff:127.0.0.1','enabled\x20Bot\x20','writeFileSync','onepagemode','toggle-bot-mode','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','sortBy','showConfig','index.html','bot-','Session\x20expired\x20for\x20user\x20...','started','request','whitelistEnabled','/off\x20-\x20stop\x20bot(s)\x0a','Ok,\x20will\x20send\x20order\x20notifications\x20only','remove','onText','whitelist','Markdown','/help\x20-\x20show\x20available\x20commands\x0a','disabled','***','sign','reset-password','unlinkSync','compareSync','backup-full@','resetHistory','************','uncaughtException','accept','2FA\x20login\x20token\x20generated','No\x20bots\x20running\x20right\x20now','<b>Telegram\x20Bot\x20Status:</b>\x0a','uuid','full','version','/:bot/coins','download','warning','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegramToken','11435QSujKa','No\x20authentication\x20token','/:bot/support','auto','settings.','referer','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','tkn','get-backup-files','split','/output-000.log','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Logged\x20in\x20user\x20...','getMinutes','sendMessage','(((.+)+)+)+$','privateKey','logged\x20out','Yes','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','node-telegram-bot-api','deleteHistoryAlerts','delete-bot','manual','isDirectory','config/','padStart','disconnect','Notifications\x20disabled\x0a','keys','\x20(1)','exit','uuid-random','store-fiat','Access\x20enabled\x20for\x20','host','expiry','telegramEvents','All\x20bots\x20running\x20right\x20now','File\x20uploaded','new-disabled','\x20minutes'];_0x1af9=function(){return _0x307190;};return _0x1af9();}!fs[_0x3ea1f7(0x255)](zippath)&&fs[_0x3ea1f7(0x20c)](zippath);!fs[_0x3ea1f7(0x255)](temppath)&&fs[_0x3ea1f7(0x20c)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x3ea1f7(0xd3)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3ea1f7(0x262)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3ea1f7(0x25c),'onepagemode':![]}})[_0x3ea1f7(0xd3)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3ea1f7(0x262)]({'secure':{},'blacklist':[]})[_0x3ea1f7(0xd3)]();let crypt=new Crypt({'md':_0x3ea1f7(0x1b7),'rsaStandard':_0x3ea1f7(0x105)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3ea1f7(0x1fc)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x3ea1f7(0xd1)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x3ea1f7(0x142)]!=''&&settings['telegramUsername']&&settings[_0x3ea1f7(0xd7)]!='')initTelegram();const logger={'screen':_0x45ec07=>{console['log'](_0x45ec07);},'simple':_0x170144=>{const _0x1fb116=_0x3ea1f7;console['log'](_0x170144),loggerfile[_0x1fb116(0xd3)](util[_0x1fb116(0x238)](_0x170144)+'\x0a');},'full':async _0xcdaf42=>{const _0xb16dcf=_0x3ea1f7,_0xac2863=getTimeStamp()+_0xb16dcf(0x19e)+_0xcdaf42;console[_0xb16dcf(0x1fe)](_0xac2863),loggerfile['write'](util['format'](_0xac2863)+'\x0a');if(tgBot&&settings[_0xb16dcf(0x1c8)]&&settings[_0xb16dcf(0x169)]!=_0xb16dcf(0x19b))await tgBot[_0xb16dcf(0x152)](settings[_0xb16dcf(0x1c8)],'Bot\x20Mgr\x20>\x20'+_0xcdaf42)[_0xb16dcf(0x25b)](_0x1d94eb=>{telegramError(_0x1d94eb);});},'debug':async(_0x5b8c31,_0x659162='')=>{const _0x23e534=_0x3ea1f7,_0x24ad27=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x5b8c31;if(debugging)console['log'](_0x24ad27);loggerfile[_0x23e534(0xd3)](util['format'](_0x24ad27)+'\x0a');if(_0x659162){if(debugging)console['log'](_0x659162);loggerfile['write'](util[_0x23e534(0x238)](_0x659162)+'\x0a');}}};process['on'](_0x3ea1f7(0x136),function(_0x353f2f){logger['simple'](_0x353f2f);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3ea1f7(0x1a7))[_0x3ea1f7(0x13d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3ea1f7(0xe6)),app=express(),http=require('http')[_0x3ea1f7(0x240)](app);app[_0x3ea1f7(0x181)](fileUpload({'useTempFiles':!![]})),app[_0x3ea1f7(0x263)](_0x3ea1f7(0x237),async(_0x56165b,_0x15d65d)=>{const _0x198edf=_0x3ea1f7,_0x494ff5=_0x56165b[_0x198edf(0xda)]['type'],_0x18a70a=getClientsWithBotID(_0x198edf(0x26e)),_0x1c7383=_0x56165b[_0x198edf(0x290)][_0x198edf(0x13b)],_0x1cc72c=timelyDecrypt(_0x1c7383,![]),_0x541386=_0x18a70a[_0x198edf(0x198)](_0x17cf31=>_0x17cf31[_0x198edf(0x13b)]==_0x1cc72c);if(_0x541386){const _0x59864a=normalizeIP(_0x56165b['socket']['remoteAddress'])[_0x198edf(0x28f)],_0x26b4b9=_0x56165b[_0x198edf(0x290)][_0x198edf(0x14b)];if(validateAccess(_0x26b4b9,_0x1cc72c,_0x59864a)[_0x198edf(0x1f5)])_0x494ff5==_0x198edf(0x1f7)&&await backupConfigFiles(),await zipFiles(_0x494ff5),_0x15d65d[_0x198edf(0x13f)](zippath+(_0x494ff5+_0x198edf(0x1b2)),_0x3531b5=>{const _0x5b46ba=_0x198edf;_0x3531b5&&(logger[_0x5b46ba(0x13c)](_0x5b46ba(0x1b4)+_0x494ff5),logger[_0x5b46ba(0xe2)](_0x3531b5));});else logger[_0x198edf(0x13c)](_0x198edf(0x177)+_0x494ff5+_0x198edf(0x162));}else logger[_0x198edf(0x13c)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x494ff5+'\x20(2)');}),app[_0x3ea1f7(0x193)]('/upload-backup',async(_0x172ec3,_0x4d52ab)=>{const _0x5a4e49=_0x3ea1f7,_0x58760a=getClientsWithBotID(_0x5a4e49(0x26e)),_0x3d799b=_0x172ec3[_0x5a4e49(0x290)][_0x5a4e49(0x13b)],_0x447f6e=timelyDecrypt(_0x3d799b,![]),_0x10d78f=_0x58760a[_0x5a4e49(0x198)](_0x1dfa9d=>_0x1dfa9d['uuid']==_0x447f6e);logger[_0x5a4e49(0x222)](_0x5a4e49(0x20b));if(_0x10d78f){const _0x177f7c=normalizeIP(_0x172ec3[_0x5a4e49(0x25f)][_0x5a4e49(0xfc)])[_0x5a4e49(0x28f)],_0x253354=_0x172ec3[_0x5a4e49(0x290)]['tkn'];if(validateAccess(_0x253354,_0x447f6e,_0x177f7c)[_0x5a4e49(0x1f5)]){if(_0x172ec3['files']){const _0x4363f4=_0x172ec3[_0x5a4e49(0x1d2)][_0x5a4e49(0x197)];await _0x4363f4['mv'](temppath+_0x4363f4['name']),_0x4d52ab[_0x5a4e49(0x185)]({'status':!![],'message':_0x5a4e49(0x16b)});const _0xcb4909=getBotsWithMode();_0xcb4909[_0x5a4e49(0x18b)]>0x0?confirmRestore(temppath,_0x4363f4[_0x5a4e49(0x1e7)]):unzipFile(temppath,_0x4363f4[_0x5a4e49(0x1e7)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x5a4e49(0x13c)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x3ea1f7(0x181)](express[_0x3ea1f7(0x220)](path['join'](__dirname,bbpath2,_0x3ea1f7(0x285)))),app[_0x3ea1f7(0x181)](express['static'](path[_0x3ea1f7(0x271)](__dirname,bbpath2,'build'))),app[_0x3ea1f7(0x263)]('/',function(_0x43c7bb,_0x299778){const _0x150bc9=_0x3ea1f7;_0x299778[_0x150bc9(0x231)](path[_0x150bc9(0x271)](__dirname,bbpath2,'build2',_0x150bc9(0x120)));}),app[_0x3ea1f7(0x263)](_0x3ea1f7(0x232),function(_0x2ba5fc,_0x1c1298){const _0x32d79d=_0x3ea1f7;_0x1c1298[_0x32d79d(0x231)](path['join'](__dirname,bbpath2,_0x32d79d(0x1ee),_0x32d79d(0x120)));}),app['get'](_0x3ea1f7(0x216),(_0x4e0370,_0x332550)=>{const _0x579c07=_0x3ea1f7;_0x332550['sendFile'](path['join'](__dirname,bbpath2,_0x579c07(0x1ee),_0x579c07(0x120)));}),app[_0x3ea1f7(0x263)]('/:bot/performance',(_0x505762,_0x279ba3)=>{const _0x3f1547=_0x3ea1f7;_0x279ba3[_0x3f1547(0x231)](path[_0x3f1547(0x271)](__dirname,bbpath2,_0x3f1547(0x1ee),_0x3f1547(0x120)));}),app[_0x3ea1f7(0x263)](_0x3ea1f7(0x13e),(_0x5028eb,_0x261388)=>{const _0x22d53a=_0x3ea1f7;_0x261388[_0x22d53a(0x231)](path['join'](__dirname,bbpath2,_0x22d53a(0x1ee),_0x22d53a(0x120)));}),app[_0x3ea1f7(0x263)](_0x3ea1f7(0x22a),(_0x261165,_0x16bba9)=>{const _0x5bf1e4=_0x3ea1f7;_0x16bba9[_0x5bf1e4(0x231)](path[_0x5bf1e4(0x271)](__dirname,bbpath2,_0x5bf1e4(0x1ee),'index.html'));}),app[_0x3ea1f7(0x263)]('/:bot/configuration',(_0x5884b3,_0xd580ad)=>{const _0x4ed429=_0x3ea1f7;_0xd580ad[_0x4ed429(0x231)](path[_0x4ed429(0x271)](__dirname,bbpath2,_0x4ed429(0x1ee),_0x4ed429(0x120)));}),app[_0x3ea1f7(0x263)](_0x3ea1f7(0x145),(_0x4b942f,_0x4fc3c4)=>{const _0x599c86=_0x3ea1f7;_0x4fc3c4[_0x599c86(0x231)](path[_0x599c86(0x271)](__dirname,bbpath2,_0x599c86(0x1ee),'index.html'));});if(HOST)http[_0x3ea1f7(0x107)](PORT,HOST);else http['listen'](PORT);const io=require(_0x3ea1f7(0x1b5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x5f37e5=_0x3ea1f7;logger[_0x5f37e5(0xe2)](''),logger[_0x5f37e5(0xe2)](_0x5f37e5(0x17a)),await logger['full'](_0x5f37e5(0x1d5)+PORT),logger['simple'](_0x5f37e5(0x17a));if(config[_0x5f37e5(0x18b)]!=0x0)for(const _0x24240f of config){if(_0x24240f[_0x5f37e5(0x1fa)]==_0x5f37e5(0x1cc)||_0x24240f[_0x5f37e5(0x1fa)]==_0x5f37e5(0x287))await logger[_0x5f37e5(0x13c)](_0x5f37e5(0x26f)+_0x24240f['botID']+'\x20|\x20'+_0x24240f[_0x5f37e5(0x254)]),startBot([_0x24240f[_0x5f37e5(0x270)],userID],{'cwd':bbpath},function(_0x408786){if(_0x408786)logger['full'](_0x408786);});else(_0x24240f[_0x5f37e5(0x1fa)]==_0x5f37e5(0x12d)||_0x24240f[_0x5f37e5(0x1fa)]==_0x5f37e5(0x16c))&&await logger['full'](_0x5f37e5(0xec)+_0x24240f[_0x5f37e5(0x270)]+_0x5f37e5(0x260)+_0x24240f[_0x5f37e5(0x254)]);}else!newBot&&logger['simple'](_0x5f37e5(0x244));if(newBot)addBot();logger[_0x5f37e5(0xe2)](_0x5f37e5(0x17a)),logger[_0x5f37e5(0xe2)]('');}function startSocket(){io['on']('connection',_0xb54da=>{const _0x3423ea=_0x17b4;let _0x34a4cc,_0x558500,_0x3cce00,_0x17c765,_0x5bb8d5;const _0x546475=_0xb54da[_0x3423ea(0xea)][_0x3423ea(0x290)][_0x3423ea(0x148)];_0x558500=_0x546475['match'](/bot[0-9]{3}/);if(_0x558500)_0x3cce00=_0x558500[0x0][_0x3423ea(0x102)](/[0-9]{3}/);if(_0x3cce00)_0x34a4cc=_0x3cce00[0x0];else _0x34a4cc=_0x3423ea(0x26e);const _0x3890e2=_0xb54da[_0x3423ea(0xea)]['auth']['encryptedUuid'];if(!_0x3890e2)_0xb54da[_0x3423ea(0xe5)](_0x3423ea(0x1fa),{'publicKey':secure['publicKey']});else{_0x17c765=timelyDecrypt(_0x3890e2,![]);if(!_0x17c765)_0xb54da['emit'](_0x3423ea(0x1fa),{'publicKey':secure[_0x3423ea(0xdb)]});else{_0x5bb8d5=normalizeIP(_0xb54da[_0x3423ea(0x1ad)][_0x3423ea(0xfc)])[_0x3423ea(0x28f)];if(!devices[_0x17c765])devices[_0x17c765]={'uuid':_0x17c765,'access':{'token':null}};devices[_0x17c765]['ip']=_0x5bb8d5;const _0xaaa93=addClient(_0xb54da['id'],_0x17c765,_0x34a4cc);setAccess(_0xaaa93),emitMessages(),_0xb54da['on'](_0x3423ea(0x25a),_0xf7423d=>{const _0x30e2b4=_0x3423ea,_0x265394=timelyDecrypt(_0xf7423d[_0x30e2b4(0x194)]);if(_0x265394){_0xf7423d={'username':_0xf7423d[_0x30e2b4(0x1aa)],'password':_0x265394},devices[_0x17c765]['access']=validateCredentials(_0xf7423d,_0x17c765);if(devices[_0x17c765]['access'][_0x30e2b4(0x1f5)]==![]&&devices[_0x17c765][_0x30e2b4(0x1d0)][_0x30e2b4(0x282)]=='2FA\x20login\x20required')_0xb54da[_0x30e2b4(0xe5)]('status',{'access':devices[_0x17c765][_0x30e2b4(0x1d0)]}),loginAccess2FA(_0x17c765,_0x5bb8d5);else{if(devices[_0x17c765][_0x30e2b4(0x1d0)][_0x30e2b4(0x1f5)]==![]&&devices[_0x17c765][_0x30e2b4(0x1d0)][_0x30e2b4(0x282)]==_0x30e2b4(0x223))_0xb54da['emit'](_0x30e2b4(0x1fa),{'access':devices[_0x17c765]['access']});else devices[_0x17c765][_0x30e2b4(0x1d0)]['allow']&&devices[_0x17c765][_0x30e2b4(0x1d0)][_0x30e2b4(0x282)]==_0x30e2b4(0x1f3)&&(getClientsWithUuid(_0x17c765)[_0x30e2b4(0x1c3)](_0xbafd35=>{setAccess(_0xbafd35);}),logger[_0x30e2b4(0x222)](_0x30e2b4(0x150)+_0x17c765[_0x30e2b4(0x1c0)](-0x8)),setTokenRefresh(_0x17c765),setSessionTimeout(_0x30e2b4(0x25a),_0x17c765));}}else logger['full'](_0x30e2b4(0x113));}),_0xb54da['on'](_0x3423ea(0x130),()=>{resetPassword();}),_0xb54da['on'](_0x3423ea(0x15f),_0x1c2159=>{removeClient(_0xb54da['id']);}),_0x34a4cc==_0x3423ea(0x26e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x15c514){const _0x13db65=_0x3ea1f7;if(_0x15c514!='botmanager'&&config['apiKey']!=''){if(pid[_0x15c514])pid[_0x15c514]['send']({'function':_0x13db65(0x1b0),'args':null});}_0x15c514!='botmanager'&&broadcastToBots(_0x13db65(0x1f6),JSON['stringify'](config));}function reloadBotManager(){const _0x37c071=_0x3ea1f7;getClientsWithBotID(_0x37c071(0x26e))[_0x37c071(0x1c3)](_0xed05e=>{const _0x457b96=_0x37c071;getSocket(_0xed05e['id'])['emit'](_0x457b96(0x1fa),{'access':{'allow':![],'reason':_0x457b96(0x261),'token':null}});});}function getSocket(_0x44a213){const _0x3d5e6e=_0x3ea1f7;return io[_0x3d5e6e(0x1fd)][_0x3d5e6e(0x1fd)]['get'](_0x44a213);}function setAccess(_0xf27b56){const _0x31f7f7=_0x3ea1f7,_0x41527c=getSocket(_0xf27b56['id']),_0x155e25=_0xf27b56[_0x31f7f7(0x13b)],_0x1e02f7=_0xf27b56['bot'];devices[_0x155e25]['access']=validateAccess(devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x1bf)],_0x155e25),logger[_0x31f7f7(0x222)](_0x31f7f7(0x27d)+devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x282)]+'\x20|\x20client:\x20...'+_0xf27b56['id'][_0x31f7f7(0x1c0)](-0x8)+'\x20|\x20user:\x20...'+_0x155e25['slice'](-0x8)),_0x41527c['join'](_0x155e25);if(devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x1f5)]){_0x41527c[_0x31f7f7(0x271)](_0x1e02f7);if(_0x1e02f7==_0x31f7f7(0x26e))initializeSocketBotManager(_0x41527c);else initializeSocketBot(_0x41527c);initClient(_0x1e02f7);}devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x1bf)]&&devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x282)]==_0x31f7f7(0x1ef)&&setSessionTimeout(_0x31f7f7(0x274),_0x155e25),devices[_0x155e25]['access'][_0x31f7f7(0x1bf)]&&devices[_0x155e25]['access'][_0x31f7f7(0x282)]==_0x31f7f7(0x138)&&setSessionTimeout(_0x31f7f7(0x25a),_0x155e25),_0x41527c[_0x31f7f7(0xe5)](_0x31f7f7(0x1fa),{'status':_0xf27b56['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x155e25][_0x31f7f7(0x1d0)],'externalip':devices[_0x155e25]['ip'],'publicKey':secure[_0x31f7f7(0xdb)],'userid':settings[_0x31f7f7(0x1e1)],'validInstallation':validInstallation}),devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x1f5)]==![]&&devices[_0x155e25][_0x31f7f7(0x1d0)][_0x31f7f7(0x282)]==_0x31f7f7(0xe1)&&temporaryAccess2FA(_0x155e25,devices[_0x155e25]['ip']);}function setSessionTimeout(_0x2d9790,_0x422d9a){const _0x510593=_0x3ea1f7;let _0x589e44;if(_0x2d9790==_0x510593(0x25a))_0x589e44=loginExpiry*0x3c*0x3e8;else _0x589e44=devices[_0x422d9a][_0x510593(0x175)][_0x510593(0x168)]*0x3c*0x3e8-(new Date()[_0x510593(0x20e)]()-devices[_0x422d9a][_0x510593(0x175)][_0x510593(0x21b)]);if(devices[_0x422d9a][_0x510593(0x1f8)])clearTimeout(devices[_0x422d9a]['pidExpireLogin']);devices[_0x422d9a][_0x510593(0x1f8)]=setTimeout(()=>{const _0x3aee5f=_0x510593;if(devices[_0x422d9a]['pidRefreshToken'])clearTimeout(devices[_0x422d9a][_0x3aee5f(0x10c)]);removeSocketListeners(_0x422d9a),addBlacklist(_0x422d9a),devices[_0x422d9a][_0x3aee5f(0x175)]=null,devices[_0x422d9a]['telegram2FaApproval']=null,devices[_0x422d9a][_0x3aee5f(0x1d0)][_0x3aee5f(0x1bf)]=null,logger['debug'](_0x3aee5f(0x122)+_0x422d9a[_0x3aee5f(0x1c0)](-0x8)),devices[_0x422d9a]['access']=validateAccess(devices[_0x422d9a]['access']['token'],_0x422d9a),!(devices[_0x422d9a]['access'][_0x3aee5f(0x1f5)]&&devices[_0x422d9a][_0x3aee5f(0x1d0)][_0x3aee5f(0x282)]=='login\x20not\x20required')&&(_0x2d9790=='login'?io['to'](_0x422d9a)['emit']('status',{'access':{'allow':![],'reason':_0x3aee5f(0x283),'token':null}}):io['to'](_0x422d9a)[_0x3aee5f(0xe5)](_0x3aee5f(0x1fa),{'access':{'allow':![],'reason':_0x3aee5f(0x183),'token':null}})),devices[_0x422d9a][_0x3aee5f(0x1d0)]['token']=null;},_0x589e44);}function setTokenRefresh(_0x159b85){const _0xa8e053=_0x3ea1f7;if(devices[_0x159b85][_0xa8e053(0x10c)])clearTimeout(devices[_0x159b85][_0xa8e053(0x10c)]);devices[_0x159b85][_0xa8e053(0x10c)]=setTimeout(()=>{const _0x3c4fc1=_0xa8e053;getClientsWithUuid(_0x159b85)['length']!=0x0?(devices[_0x159b85][_0x3c4fc1(0x1d0)]=refreshToken(_0x159b85),io['to'](_0x159b85)[_0x3c4fc1(0xe5)](_0x3c4fc1(0x1fa),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x159b85]['access'],'externalip':devices[_0x159b85]['ip'],'publicKey':secure[_0x3c4fc1(0xdb)],'validInstallation':validInstallation}),setTokenRefresh(_0x159b85)):clearTimeout(devices[_0x159b85][_0x3c4fc1(0x10c)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x534bd5){const _0x29ad39=_0x3ea1f7,_0x153d81=getClient(_0x534bd5['id'])[_0x29ad39(0x13b)];_0x534bd5[_0x29ad39(0xe5)](_0x29ad39(0x1f6),config),_0x534bd5[_0x29ad39(0xe5)](_0x29ad39(0x291),cleanSettings()),_0x534bd5['on']('add-bot',_0x4a2ab4=>{const _0x5d64a0=_0x29ad39;if(validateAccess(_0x4a2ab4,_0x153d81)[_0x5d64a0(0x1f5)])addBot();else logger[_0x5d64a0(0x13c)](_0x5d64a0(0x195));}),_0x534bd5['on'](_0x29ad39(0x1b6),(_0x327af5,_0x45a5be)=>{const _0x51ca01=_0x29ad39;if(validateAccess(_0x45a5be,_0x153d81)[_0x51ca01(0x1f5)])toggleBot(_0x327af5[_0x51ca01(0x270)],_0x327af5[_0x51ca01(0x1fa)],_0x327af5[_0x51ca01(0x289)]);else logger[_0x51ca01(0x13c)](_0x51ca01(0x212));}),_0x534bd5['on'](_0x29ad39(0x11b),(_0x245022,_0x468e54)=>{const _0x3943ec=_0x29ad39;if(validateAccess(_0x468e54,_0x153d81)['allow'])toggleBotMode(_0x245022);else logger[_0x3943ec(0x13c)](_0x3943ec(0x212));}),_0x534bd5['on'](_0x29ad39(0x15a),(_0x4eb7c5,_0x1d6c14)=>{const _0xbae016=_0x29ad39;if(validateAccess(_0x1d6c14,_0x153d81)[_0xbae016(0x1f5)])deleteBot(_0x4eb7c5);else logger[_0xbae016(0x13c)](_0xbae016(0x1c9));}),_0x534bd5['on'](_0x29ad39(0x241),(_0x165a19,_0x5b5d57)=>{const _0x5a605f=_0x29ad39;if(validateAccess(_0x5b5d57,_0x153d81)[_0x5a605f(0x1f5)])storeSettings(_0x165a19,!![]);else logger[_0x5a605f(0x13c)](_0x5a605f(0x1ea));}),_0x534bd5['on']('update-bb',_0x30c929=>{const _0x2086ea=_0x29ad39;if(validateAccess(_0x30c929,_0x153d81)[_0x2086ea(0x1f5)])updateBB(_0x2086ea(0xd8));else logger[_0x2086ea(0x13c)](_0x2086ea(0x1d6));}),_0x534bd5['on']('reinstall-bb',_0x10fe84=>{const _0x490dc5=_0x29ad39;if(validateAccess(_0x10fe84,_0x153d81)[_0x490dc5(0x1f5)])updateBB('reinstall');else logger[_0x490dc5(0x13c)](_0x490dc5(0x26a));}),_0x534bd5['on'](_0x29ad39(0x14c),_0x301e81=>{const _0x53394f=_0x29ad39;if(validateAccess(_0x301e81,_0x153d81)[_0x53394f(0x1f5)]){const _0x4c3030=getClient(_0x534bd5['id']);if(_0x4c3030)getBackupFiles(_0x4c3030[_0x53394f(0x13b)]);else logger[_0x53394f(0x13c)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x53394f(0x13c)](_0x53394f(0x1ff));}),_0x534bd5['on'](_0x29ad39(0x226),(_0x1b28d6,_0x5b0686)=>{const _0x59b458=_0x29ad39;if(validateAccess(_0x5b0686,_0x153d81)['allow'])restoreBackupFile(_0x1b28d6);else logger['full'](_0x59b458(0x1da));}),_0x534bd5['on']('get-messages',_0x1240d7=>{const _0x370b41=_0x29ad39;if(validateAccess(_0x1240d7,_0x153d81)[_0x370b41(0x1f5)])getMessages();else logger[_0x370b41(0x13c)](_0x370b41(0x1a9));}),_0x534bd5['on']('confirm-message',(_0x40cfa9,_0x26da1c)=>{const _0x27ada6=_0x29ad39;if(validateAccess(_0x26da1c,_0x153d81)[_0x27ada6(0x1f5)])confirmMessage(_0x40cfa9);else logger[_0x27ada6(0x13c)](_0x27ada6(0x1ae));}),_0x534bd5['on']('logout',_0x8511ca=>{const _0x158a70=_0x29ad39;if(validateAccess(_0x8511ca,_0x153d81)[_0x158a70(0x1f5)]){if(devices[_0x153d81][_0x158a70(0x10c)])clearTimeout(devices[_0x153d81][_0x158a70(0x10c)]);if(devices[_0x153d81][_0x158a70(0x1f8)])clearTimeout(devices[_0x153d81]['pidExpireLogin']);removeSocketListeners(getClient(_0x534bd5['id'])[_0x158a70(0x13b)]),addBlacklist(_0x153d81),devices[_0x153d81][_0x158a70(0x175)]=null,devices[_0x153d81]['telegram2FaApproval']=null,devices[_0x153d81]['access'][_0x158a70(0x1bf)]=null,logger[_0x158a70(0x222)]('Logged\x20out\x20user\x20...'+_0x153d81[_0x158a70(0x1c0)](-0x8)),io['to'](getClient(_0x534bd5['id'])[_0x158a70(0x13b)])[_0x158a70(0xe5)](_0x158a70(0x1fa),{'access':{'allow':![],'reason':_0x158a70(0x155),'token':null}});}else logger[_0x158a70(0x13c)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x24f478){const _0x35eee9=_0x3ea1f7,_0x2cc76f=getClient(_0x24f478['id'])[_0x35eee9(0x1ca)],_0x5a2c08=getClient(_0x24f478['id'])['uuid'];_0x24f478['on']('get-logs',(_0x59a0aa,_0x105418)=>{const _0x43df38=_0x35eee9;if(validateAccess(_0x105418,_0x5a2c08)[_0x43df38(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f]['send']({'function':_0x43df38(0x21d),'args':_0x59a0aa});}else logger[_0x43df38(0x13c)](_0x43df38(0xf0));}),_0x24f478['on']('delete-alerts',(_0x207b16,_0x305324)=>{const _0x40d9e2=_0x35eee9;if(validateAccess(_0x305324,_0x5a2c08)[_0x40d9e2(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f][_0x40d9e2(0x185)]({'function':_0x40d9e2(0x159),'args':_0x207b16});}else logger[_0x40d9e2(0x13c)](_0x40d9e2(0x27b));}),_0x24f478['on']('get-portfolio',(_0x27e86f,_0x5e9362)=>{const _0x1f9033=_0x35eee9;if(validateAccess(_0x5e9362,_0x5a2c08)['allow']){if(pid[_0x2cc76f])pid[_0x2cc76f]['send']({'function':'getPortfolio','args':_0x27e86f});}else logger[_0x1f9033(0x13c)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x24f478['on']('store-configuration',(_0x54db83,_0x3fb8d5)=>{const _0x1143a5=_0x35eee9;if(validateAccess(_0x3fb8d5,_0x5a2c08)[_0x1143a5(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f]['send']({'function':_0x1143a5(0x214),'args':_0x54db83});}else logger[_0x1143a5(0x13c)](_0x1143a5(0x21f));}),_0x24f478['on'](_0x35eee9(0x20a),(_0x75685b,_0x1f3662)=>{const _0x55cc5d=_0x35eee9;if(validateAccess(_0x1f3662,_0x5a2c08)[_0x55cc5d(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f][_0x55cc5d(0x185)]({'function':_0x55cc5d(0x243),'args':_0x75685b});}else logger[_0x55cc5d(0x13c)](_0x55cc5d(0x103));}),_0x24f478['on'](_0x35eee9(0x165),(_0x7acfef,_0x335712)=>{const _0x59d7a9=_0x35eee9;if(validateAccess(_0x335712,_0x5a2c08)[_0x59d7a9(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f][_0x59d7a9(0x185)]({'function':_0x59d7a9(0xe8),'args':_0x7acfef});}else logger[_0x59d7a9(0x13c)](_0x59d7a9(0x1e3));}),_0x24f478['on'](_0x35eee9(0xf6),_0x36a7e5=>{const _0xba0e3d=_0x35eee9;if(validateAccess(_0x36a7e5,_0x5a2c08)['allow']){if(pid[_0x2cc76f])pid[_0x2cc76f]['send']({'function':_0xba0e3d(0x134),'args':null});}else logger[_0xba0e3d(0x13c)](_0xba0e3d(0x1e0));}),_0x24f478['on']('get-starting-balances',_0x5ca387=>{const _0x17d970=_0x35eee9;if(validateAccess(_0x5ca387,_0x5a2c08)['allow']){if(pid[_0x2cc76f])pid[_0x2cc76f][_0x17d970(0x185)]({'function':_0x17d970(0x24d),'args':null});}else logger[_0x17d970(0x13c)](_0x17d970(0x28e));}),_0x24f478['on'](_0x35eee9(0x1d9),(_0x40fe27,_0x2f7b3d)=>{const _0x43883d=_0x35eee9;if(validateAccess(_0x2f7b3d,_0x5a2c08)[_0x43883d(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f]['send']({'function':'placeOrder','args':_0x40fe27});}else logger[_0x43883d(0x13c)](_0x43883d(0x236));}),_0x24f478['on'](_0x35eee9(0x19d),_0x42e983=>{const _0x198e52=_0x35eee9;if(validateAccess(_0x42e983,_0x5a2c08)[_0x198e52(0x1f5)]){if(pid[_0x2cc76f])pid[_0x2cc76f][_0x198e52(0x185)]({'function':'cancelLoading','args':null});}else logger[_0x198e52(0x13c)](_0x198e52(0x1e4));}),_0x24f478['on']('show-config',_0x22ec20=>{const _0x30678b=_0x35eee9;if(validateAccess(_0x22ec20,_0x5a2c08)['allow']){if(pid[_0x2cc76f])pid[_0x2cc76f]['send']({'function':_0x30678b(0x11f),'args':null});}else logger['full'](_0x30678b(0x25e));}),_0x24f478['on'](_0x35eee9(0x242),_0x5d9936=>{const _0x26e62e=_0x35eee9;if(validateAccess(_0x5d9936,_0x5a2c08)[_0x26e62e(0x1f5)])updateBB(_0x26e62e(0xd8));else logger[_0x26e62e(0x13c)](_0x26e62e(0x1d6));}),_0x24f478['on'](_0x35eee9(0x22e),_0x169df5=>{const _0x1e3d3e=_0x35eee9;if(validateAccess(_0x169df5,_0x5a2c08)[_0x1e3d3e(0x1f5)])getMessages();else logger[_0x1e3d3e(0x13c)](_0x1e3d3e(0x1a9));}),_0x24f478['on']('confirm-message',(_0x80685b,_0x5de50e)=>{const _0x1b5929=_0x35eee9;if(validateAccess(_0x5de50e,_0x5a2c08)[_0x1b5929(0x1f5)])confirmMessage(_0x80685b);else logger[_0x1b5929(0x13c)](_0x1b5929(0x1ae));}),_0x24f478['on']('logout',_0x181b62=>{const _0x5a936c=_0x35eee9;if(validateAccess(_0x181b62,_0x5a2c08)['allow']){if(devices[_0x5a2c08][_0x5a936c(0x10c)])clearTimeout(devices[_0x5a2c08][_0x5a936c(0x10c)]);if(devices[_0x5a2c08]['pidExpireLogin'])clearTimeout(devices[_0x5a2c08][_0x5a936c(0x1f8)]);removeSocketListeners(getClient(_0x24f478['id'])['uuid']),addBlacklist(_0x5a2c08),devices[_0x5a2c08][_0x5a936c(0x175)]=null,devices[_0x5a2c08][_0x5a936c(0x1cd)]=null,devices[_0x5a2c08][_0x5a936c(0x1d0)][_0x5a936c(0x1bf)]=null,logger[_0x5a936c(0x222)](_0x5a936c(0x1ba)+_0x5a2c08[_0x5a936c(0x1c0)](-0x8)),io['to'](getClient(_0x24f478['id'])[_0x5a936c(0x13b)])[_0x5a936c(0xe5)]('status',{'access':{'allow':![],'reason':_0x5a936c(0x155),'token':null}});}else logger['full'](_0x5a936c(0x21a));});}function removeSocketListeners(_0x32d196){const _0x48140b=_0x3ea1f7;getClientsWithUuid(_0x32d196)[_0x48140b(0x1c3)](_0x3a91a0=>{const _0x4c47df=_0x48140b;getSocket(_0x3a91a0['id'])[_0x4c47df(0x23d)]();});}function cleanSettings(){const _0x5430c1=_0x3ea1f7;let _0x2afc8b=settings;return settings[_0x5430c1(0x142)]&&settings[_0x5430c1(0x142)]!=''&&(_0x2afc8b={..._0x2afc8b,'telegramToken':_0x5430c1(0x135)}),settings[_0x5430c1(0x245)]&&settings['bbPassword']!=''&&(_0x2afc8b={..._0x2afc8b,'bbPassword':_0x5430c1(0x135)}),(settings['bbPassword']&&settings[_0x5430c1(0x245)]==_0x5430c1(0x12e)||settings[_0x5430c1(0x142)]&&settings[_0x5430c1(0x142)]==_0x5430c1(0x12e))&&(_0x2afc8b={..._0x2afc8b,'restored':{'password':settings[_0x5430c1(0x245)]=='***','telegram':settings[_0x5430c1(0x142)]==_0x5430c1(0x12e)}}),_0x2afc8b;}async function updateBB(_0x27f520){const _0x10157a=_0x3ea1f7;await backupConfigFiles(),installingUpdate=!![],config[_0x10157a(0x1c3)](_0x582dfa=>{const _0x1029fb=_0x10157a;restartBot(_0x582dfa[_0x1029fb(0x270)]);}),logger['debug']('Starting\x20Balance\x20Bot\x20'+_0x27f520);if(_0x27f520==_0x10157a(0xd8))process['send']({'update':!![]},_0x56449b=>{});else _0x27f520=='reinstall'&&process['send']({'reinstall':!![]},_0x151c38=>{});}function startBot(_0x324a70,_0x32b09c,_0x230274){const _0x10bcdc=_0x3ea1f7;if(debugging)_0x324a70[_0x10bcdc(0x1f1)]('-d');let _0x57f42d=![];const _0x13c53b=_0x324a70[0x0];_0x32b09c={..._0x32b09c,'stdio':[_0x10bcdc(0x1d4),_0x10bcdc(0x1d4),_0x10bcdc(0x1d4),_0x10bcdc(0x268)]},pid[_0x13c53b]=childProcess[_0x10bcdc(0x1eb)](botfile,_0x324a70,_0x32b09c),pid[_0x13c53b]['on']('message',_0x5cf567=>{const _0x3aa89a=_0x10bcdc;switch(Object[_0x3aa89a(0x161)](_0x5cf567)[0x0]){case _0x3aa89a(0x254):updateBotName(_0x13c53b,_0x5cf567['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x3aa89a(0x1fa):updateStatus(_0x13c53b,_0x5cf567[_0x3aa89a(0x1fa)]);break;case _0x3aa89a(0x289):updateLive(_0x13c53b,_0x5cf567['live']);break;case _0x3aa89a(0x123):updateLive(_0x13c53b,_0x5cf567['started']),io['to'](_0x13c53b)['emit'](_0x3aa89a(0x1fa),{'access':{'allow':![],'reason':_0x3aa89a(0x261),'token':null}});break;case _0x3aa89a(0x182):_0x5cf567[_0x3aa89a(0x182)]==_0x3aa89a(0x176)&&restartBot(_0x13c53b);_0x5cf567[_0x3aa89a(0x182)]==_0x3aa89a(0x19f)&&toggleBot(_0x13c53b,'disabled',_0x3aa89a(0x18a));break;case'telegram':sendTelegram(_0x13c53b,_0x5cf567[_0x3aa89a(0x22b)]);break;case _0x3aa89a(0x186):sendTelegramMsg(_0x5cf567['telegrammsg']);break;case _0x3aa89a(0x221):io['to'](_0x13c53b)[_0x3aa89a(0xe5)](_0x5cf567[_0x3aa89a(0x221)],_0x5cf567['args']);break;}}),pid[_0x13c53b]['on'](_0x10bcdc(0x1d3),function(_0x515112){if(_0x57f42d)return;_0x57f42d=!![],_0x230274(_0x515112);}),pid[_0x13c53b]['on']('exit',async function(_0x420755){const _0x56e827=_0x10bcdc;if(installingUpdate)return;if(_0x57f42d)return;_0x57f42d=!![],_0x230274(null);const _0x509051=dbConfig[_0x56e827(0x263)]('bots')[_0x56e827(0x198)]({'botID':_0x13c53b})[_0x56e827(0x196)]();_0x509051&&(_0x509051[_0x56e827(0x1fa)]==_0x56e827(0x1cc)||_0x509051[_0x56e827(0x1fa)]=='new')&&(await sleep(0x3e8),updateLive(_0x13c53b,_0x56e827(0x18a)),logger[_0x56e827(0x13c)](_0x56e827(0x191)+_0x13c53b),startBot([_0x13c53b,userID],{'cwd':bbpath},function(_0x4a9981){const _0x2bc366=_0x56e827;if(_0x4a9981)logger[_0x2bc366(0x13c)](_0x4a9981);}));});}function stopBot(_0x2abf74){const _0x113e7e=_0x3ea1f7;getClientsWithBotID(_0x2abf74)['forEach'](_0x1ed6fb=>{const _0x2ac107=_0x17b4;getSocket(_0x1ed6fb['id'])[_0x2ac107(0x15f)](!![]),removeClient(_0x1ed6fb['id']);}),pid[_0x2abf74]&&(pid[_0x2abf74][_0x113e7e(0x19f)](),pid[_0x2abf74]=null);}function restartBot(_0x3041f1){const _0x27e2a7=_0x3ea1f7;if(pid[_0x3041f1])pid[_0x3041f1][_0x27e2a7(0x19f)]();}function addBot(){const _0x5dd737=_0x3ea1f7;let _0x4649a2;for(let _0x2aede4=0x1;_0x2aede4<0x3e9;_0x2aede4++){_0x4649a2=_0x2aede4[_0x5dd737(0xf8)]()['padStart'](0x3,'0');let _0x33e33b=config[_0x5dd737(0x198)](_0x435b28=>_0x435b28['botID']==_0x4649a2);if(!_0x33e33b)break;}if(_0x4649a2===_0x5dd737(0x210)){logger[_0x5dd737(0x13c)](_0x5dd737(0x141));return;}logger['full'](_0x5dd737(0x259)+_0x4649a2),dbConfig[_0x5dd737(0x263)](_0x5dd737(0x1f6))[_0x5dd737(0x1f1)]({'botID':_0x4649a2,'botname':_0x5dd737(0x278)+_0x4649a2,'status':'new','live':''})[_0x5dd737(0xd3)](),startBot([_0x4649a2,userID],{'cwd':bbpath},function(_0x1c0415){const _0x2930e1=_0x5dd737;if(_0x1c0415)logger[_0x2930e1(0x13c)](_0x1c0415);}),config=getConfiguration(),io['to'](_0x5dd737(0x26e))[_0x5dd737(0xe5)](_0x5dd737(0x1f6),config),broadcastToBots('bots',JSON[_0x5dd737(0x267)](config));}function deleteBot(_0x5c3e83){const _0x317fee=_0x3ea1f7;getClientsWithBotID(_0x5c3e83)['forEach'](_0x3f573e=>{const _0x5ad806=_0x17b4;getSocket(_0x3f573e['id'])[_0x5ad806(0x15f)](!![]),removeClient(_0x3f573e['id']);}),dbConfig['get']('bots')[_0x317fee(0x128)]({'botID':_0x5c3e83})[_0x317fee(0xd3)](),logger['full'](_0x317fee(0xf1)+_0x5c3e83),stopBot(_0x5c3e83);try{if(fs[_0x317fee(0x255)](path['join'](configpath,_0x317fee(0x121)+_0x5c3e83+_0x317fee(0xde))))fs[_0x317fee(0x131)](path[_0x317fee(0x271)](configpath,'bot-'+_0x5c3e83+_0x317fee(0xde)));if(fs[_0x317fee(0x255)](path[_0x317fee(0x271)](configpath,_0x317fee(0x121)+_0x5c3e83+_0x317fee(0x16e))))fs[_0x317fee(0x131)](path[_0x317fee(0x271)](configpath,_0x317fee(0x121)+_0x5c3e83+_0x317fee(0x16e)));if(fs[_0x317fee(0x255)](path['join'](configpath,'bot-'+_0x5c3e83+_0x317fee(0x1ec))))fs[_0x317fee(0x131)](path[_0x317fee(0x271)](configpath,'bot-'+_0x5c3e83+'-performance.json'));if(fs['existsSync'](path['join'](configpath,_0x317fee(0x121)+_0x5c3e83+_0x317fee(0x178))))fs['unlinkSync'](path[_0x317fee(0x271)](configpath,'bot-'+_0x5c3e83+_0x317fee(0x178)));}catch(_0x3c4d2c){if(_0x3c4d2c)logger[_0x317fee(0x13c)](_0x317fee(0x26b),_0x3c4d2c);}config=getConfiguration(),io['to'](_0x317fee(0x26e))[_0x317fee(0xe5)]('bots',config),broadcastToBots(_0x317fee(0x1f6),JSON['stringify'](config));}function toggleBot(_0xe2190e,_0x9f4b0a,_0x325a41){const _0x4e4e21=_0x3ea1f7;dbConfig['get'](_0x4e4e21(0x1f6))[_0x4e4e21(0x198)]({'botID':_0xe2190e})[_0x4e4e21(0x23e)]({'status':_0x9f4b0a})['assign']({'live':_0x325a41})[_0x4e4e21(0xd3)]();if(_0x9f4b0a==_0x4e4e21(0x1cc)||_0x9f4b0a=='new')logger[_0x4e4e21(0x13c)](_0x4e4e21(0x118)+_0xe2190e),startBot([_0xe2190e,userID],{'cwd':bbpath},function(_0x121c91){const _0x1280cf=_0x4e4e21;if(_0x121c91)logger[_0x1280cf(0x13c)](_0x121c91);});else(_0x9f4b0a==_0x4e4e21(0x12d)||_0x9f4b0a=='new-disabled')&&(logger['full'](_0x4e4e21(0x1e9)+_0xe2190e),stopBot(_0xe2190e));config=getConfiguration(),io['to'](_0x4e4e21(0x26e))[_0x4e4e21(0xe5)](_0x4e4e21(0x1f6),config),broadcastToBots(_0x4e4e21(0x1f6),JSON[_0x4e4e21(0x267)](config));}function toggleStatus(_0x3e582e){const _0x3f2457=_0x3ea1f7;let _0x1f4cc2=dbConfig[_0x3f2457(0x263)](_0x3f2457(0x1f6))[_0x3f2457(0x198)]({'botID':_0x3e582e})['value'](),_0x3eb540;if(_0x1f4cc2[_0x3f2457(0x1fa)]===_0x3f2457(0x1cc))_0x3eb540=_0x3f2457(0x12d);else{if(_0x1f4cc2[_0x3f2457(0x1fa)]===_0x3f2457(0x287))_0x3eb540=_0x3f2457(0x16c);else{if(_0x1f4cc2['status']===_0x3f2457(0x16c))_0x3eb540=_0x3f2457(0x287);else{if(_0x1f4cc2[_0x3f2457(0x1fa)]===_0x3f2457(0x12d))_0x3eb540=_0x3f2457(0x1cc);}}}return _0x3eb540;}function updateStatus(_0x449d6f,_0x117bec){const _0x45dafe=_0x3ea1f7;dbConfig[_0x45dafe(0x263)](_0x45dafe(0x1f6))[_0x45dafe(0x198)]({'botID':_0x449d6f})[_0x45dafe(0x23e)]({'status':_0x117bec})[_0x45dafe(0xd3)](),config=getConfiguration(),io['to'](_0x45dafe(0x26e))[_0x45dafe(0xe5)](_0x45dafe(0x1f6),config),broadcastToBots('bots',JSON[_0x45dafe(0x267)](config));}function updateLive(_0x5ca97d,_0x1820ef){const _0x571e30=_0x3ea1f7;dbConfig[_0x571e30(0x263)](_0x571e30(0x1f6))[_0x571e30(0x198)]({'botID':_0x5ca97d})[_0x571e30(0x23e)]({'live':_0x1820ef})[_0x571e30(0xd3)](),config=getConfiguration(),io['to'](_0x571e30(0x26e))[_0x571e30(0xe5)](_0x571e30(0x1f6),config),broadcastToBots('bots',JSON[_0x571e30(0x267)](config));}function updateBotName(_0x3546e6,_0xb70efc){const _0x5ef466=_0x3ea1f7;dbConfig[_0x5ef466(0x263)](_0x5ef466(0x1f6))[_0x5ef466(0x198)]({'botID':_0x3546e6})[_0x5ef466(0x23e)]({'botname':_0xb70efc})[_0x5ef466(0xd3)](),config=getConfiguration(),io['to'](_0x5ef466(0x26e))['emit']('bots',config),broadcastToBots('bots',JSON[_0x5ef466(0x267)](config));}function updateBotManager(){const _0x23dc5f=_0x3ea1f7;config=getConfiguration(),io['to'](_0x23dc5f(0x26e))[_0x23dc5f(0xe5)](_0x23dc5f(0x1f6),config),broadcastToBots(_0x23dc5f(0x1f6),JSON['stringify'](config));}function toggleBotMode(_0x194203){const _0x2b7cc8=_0x3ea1f7;if(pid[_0x194203])pid[_0x194203][_0x2b7cc8(0x185)]({'function':'toggleBotMode','args':null});else{const _0x5bdcdd=configpath+'bot-'+_0x194203+_0x2b7cc8(0xde),_0x4bfbc1=fs[_0x2b7cc8(0x1bd)](_0x5bdcdd),_0x4637f7=JSON[_0x2b7cc8(0x251)](_0x4bfbc1),_0x552761=_0x4637f7['bot'][0x0][_0x2b7cc8(0x18e)];_0x4637f7[_0x2b7cc8(0x1ca)][0x0]['headless']=!_0x552761;const _0x2ac60b=JSON[_0x2b7cc8(0x267)](_0x4637f7,null,0x2);fs[_0x2b7cc8(0x119)](_0x5bdcdd,_0x2ac60b),config=getConfiguration(),io['to']('botmanager')[_0x2b7cc8(0xe5)](_0x2b7cc8(0x1f6),config),broadcastToBots(_0x2b7cc8(0x1f6),JSON[_0x2b7cc8(0x267)](config));}}function telegramError(_0x2da9b3){logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x368e61){const _0x7b6685=_0x3ea1f7;if(_0x368e61[_0x7b6685(0x28a)][_0x7b6685(0x1aa)]!=settings[_0x7b6685(0xd7)]&&'@'+_0x368e61[_0x7b6685(0x28a)][_0x7b6685(0x1aa)]!=settings[_0x7b6685(0xd7)])return tgBot['sendMessage'](_0x368e61[_0x7b6685(0x207)]['id'],_0x7b6685(0x11d),{'parse_mode':_0x7b6685(0x292)})['catch'](_0x5122fa=>{telegramError(_0x5122fa);}),![];return!![];}async function initTelegram(){const _0x32fc81=_0x3ea1f7;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x33b543='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x33b543+='\x0a',_0x33b543+=_0x32fc81(0x26d),_0x33b543+=_0x32fc81(0xeb),_0x33b543+=_0x32fc81(0x217),_0x33b543+=_0x32fc81(0x1a8),_0x33b543+=_0x32fc81(0x1f4),_0x33b543+=_0x32fc81(0x126),_0x33b543+=_0x32fc81(0x157),_0x33b543+=_0x32fc81(0x209),_0x33b543+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x33b543+=_0x32fc81(0x114),_0x33b543+=_0x32fc81(0x26c),_0x33b543+=_0x32fc81(0x1de),_0x33b543+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x33b543+=_0x32fc81(0x12c);let _0xa02f23=_0x32fc81(0x1ce);_0xa02f23+='\x0a',_0xa02f23+=_0x33b543,tgBot['onText'](/\/start/,_0x4f7d86=>{const _0x11fc4c=_0x32fc81;if(!validateTelegram(_0x4f7d86))return;if(settings[_0x11fc4c(0x1c8)]!=_0x4f7d86[_0x11fc4c(0x207)]['id'])updateSetting(_0x11fc4c(0x1c8),_0x4f7d86[_0x11fc4c(0x207)]['id']);updateSetting(_0x11fc4c(0x266),!![]),tgBot[_0x11fc4c(0x152)](_0x4f7d86[_0x11fc4c(0x207)]['id'],_0xa02f23)[_0x11fc4c(0x25b)](_0x3c735d=>{telegramError(_0x3c735d);});}),tgBot['onText'](/\/enable/,_0x1c3adc=>{const _0x5da8ba=_0x32fc81;if(!validateTelegram(_0x1c3adc))return;if(settings[_0x5da8ba(0x1c8)]!=_0x1c3adc[_0x5da8ba(0x207)]['id'])updateSetting('telegramChatId',_0x1c3adc[_0x5da8ba(0x207)]['id']);updateSetting(_0x5da8ba(0x266),!![]),tgBot[_0x5da8ba(0x152)](_0x1c3adc['chat']['id'],_0x5da8ba(0x111))[_0x5da8ba(0x25b)](_0x28d314=>{telegramError(_0x28d314);});}),tgBot[_0x32fc81(0x129)](/\/config/,async _0x8a301c=>{const _0x35762e=_0x32fc81;if(!validateTelegram(_0x8a301c))return;tgBot[_0x35762e(0x1a4)]('callback_query'),tgBot['sendMessage'](_0x8a301c['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x35762e(0x19b)},{'text':_0x35762e(0x100),'callback_data':_0x35762e(0xf9)},{'text':_0x35762e(0xe7),'callback_data':'all'}]]}})[_0x35762e(0x25b)](_0x24b4a2=>{telegramError(_0x24b4a2);}),tgBot['on'](_0x35762e(0x1a1),async _0x10b56b=>{const _0x51c3c2=_0x35762e,_0x58855b=_0x10b56b['data'],_0x2a4b45=_0x10b56b[_0x51c3c2(0x1c4)];tgBot[_0x51c3c2(0x16f)](_0x10b56b['id'])['then'](async()=>{const _0x112ac5=_0x51c3c2;_0x58855b==_0x112ac5(0x19b)&&(updateSetting(_0x112ac5(0x169),_0x112ac5(0x19b)),updateSetting(_0x112ac5(0x266),!![]),await tgBot[_0x112ac5(0x152)](_0x2a4b45[_0x112ac5(0x207)]['id'],_0x112ac5(0x127))[_0x112ac5(0x25b)](_0x1fff0a=>{telegramError(_0x1fff0a);}));_0x58855b==_0x112ac5(0xf9)&&(updateSetting(_0x112ac5(0x169),_0x112ac5(0xf9)),updateSetting(_0x112ac5(0x266),!![]),await tgBot[_0x112ac5(0x152)](_0x2a4b45[_0x112ac5(0x207)]['id'],_0x112ac5(0x1db))['catch'](_0xec792=>{telegramError(_0xec792);}));_0x58855b==_0x112ac5(0x1ab)&&(updateSetting('telegramEvents',_0x112ac5(0x1ab)),updateSetting(_0x112ac5(0x266),!![]),await tgBot['sendMessage'](_0x2a4b45[_0x112ac5(0x207)]['id'],_0x112ac5(0x27f))[_0x112ac5(0x25b)](_0x136969=>{telegramError(_0x136969);}));if(!settings[_0x112ac5(0x1c8)])tgBot[_0x112ac5(0x152)](_0x2a4b45[_0x112ac5(0x207)]['id'],_0x112ac5(0x205))['catch'](_0x38fe37=>{telegramError(_0x38fe37);});}),tgBot[_0x51c3c2(0x1a4)](_0x51c3c2(0x1a1));});}),tgBot[_0x32fc81(0x129)](/\/status/,_0x128d38=>{const _0xb21184=_0x32fc81;if(!validateTelegram(_0x128d38))return;const _0x7f7ac2=getBotsWithMode();let _0x4df81e=_0xb21184(0x275);config[_0xb21184(0x1c3)](_0xbed111=>{const _0x31f654=_0xb21184,_0x21cd01=_0x7f7ac2[_0x31f654(0x198)](_0x59eeaf=>_0x59eeaf['botID']==_0xbed111[_0x31f654(0x270)])['mode'];_0x4df81e+=_0x31f654(0x278)+_0xbed111[_0x31f654(0x270)]+':\x20'+_0xbed111[_0x31f654(0x1fa)]+_0x31f654(0x260)+_0x21cd01+_0x31f654(0x260)+_0xbed111['live']+'\x0a';}),_0x4df81e+='\x0a',_0x4df81e+=_0xb21184(0x13a),_0x4df81e+=!settings[_0xb21184(0x266)]?_0xb21184(0x160):_0xb21184(0x273),_0x4df81e+=settings[_0xb21184(0x266)]?settings[_0xb21184(0x169)]==_0xb21184(0x1ab)?_0xb21184(0xfa):_0xb21184(0xff)+settings[_0xb21184(0x169)]+_0xb21184(0x18f):'',tgBot['sendMessage'](_0x128d38[_0xb21184(0x207)]['id'],_0x4df81e,{'parse_mode':_0xb21184(0x292)})[_0xb21184(0x25b)](_0x5caa6e=>{telegramError(_0x5caa6e);});}),tgBot[_0x32fc81(0x129)](/\/restart/,_0x2dacc0=>{const _0x424418=_0x32fc81;if(!validateTelegram(_0x2dacc0))return;tgBot[_0x424418(0x1a4)](_0x424418(0x1a1));const _0x27bb32=getEnabledBots();if(_0x27bb32[_0x424418(0x18b)]==0x0)tgBot[_0x424418(0x152)](_0x2dacc0['chat']['id'],_0x424418(0x139))[_0x424418(0x25b)](_0x3637ef=>{telegramError(_0x3637ef);});else{if(_0x27bb32[_0x424418(0x18b)]>0x1)_0x27bb32[_0x424418(0x1f1)]({'botID':'all'});let _0x23b004=[],_0x312043=[];const _0x41ae66=_0x27bb32[_0x424418(0x18b)]%0x4==0x0||_0x27bb32[_0x424418(0x18b)]%0x4==0x3||_0x27bb32['length']%0x3==0x1?0x4:0x3;let _0x483369=0x0;_0x27bb32['forEach']((_0x580af8,_0x17df26)=>{const _0x927847=_0x424418;if(_0x17df26%_0x41ae66==0x0)_0x312043=[];_0x312043[_0x927847(0x1f1)]({'text':_0x580af8[_0x927847(0x270)]==_0x927847(0x1ab)?'All\x20bots':_0x927847(0x278)+_0x580af8[_0x927847(0x270)],'callback_data':_0x580af8[_0x927847(0x270)]}),_0x17df26%_0x41ae66==0x0&&(_0x23b004[_0x483369]=_0x312043,_0x483369++);}),tgBot[_0x424418(0x152)](_0x2dacc0[_0x424418(0x207)]['id'],_0x424418(0xe4),{'reply_markup':{'inline_keyboard':_0x23b004}})[_0x424418(0x25b)](_0x12562b=>{telegramError(_0x12562b);}),tgBot['on'](_0x424418(0x1a1),async _0x3ec282=>{const _0x4414cd=_0x424418,_0x1ae577=_0x3ec282['data'],_0x44c10f=_0x3ec282[_0x4414cd(0x1c4)];tgBot[_0x4414cd(0x16f)](_0x3ec282['id'])[_0x4414cd(0x1b8)](async()=>{const _0x532e1f=_0x4414cd;_0x1ae577==_0x532e1f(0x1ab)?config['forEach'](_0x209b49=>{restartBot(_0x209b49['botID']);}):restartBot(_0x1ae577);}),tgBot['removeListener'](_0x4414cd(0x1a1));});}}),tgBot[_0x32fc81(0x129)](/\/on/,_0x40a19d=>{const _0x116d46=_0x32fc81;if(!validateTelegram(_0x40a19d))return;tgBot[_0x116d46(0x1a4)](_0x116d46(0x1a1));const _0x242706=getDisabledBots();if(_0x242706['length']==0x0)tgBot['sendMessage'](_0x40a19d[_0x116d46(0x207)]['id'],_0x116d46(0x16a))[_0x116d46(0x25b)](_0x493f07=>{telegramError(_0x493f07);});else{if(_0x242706[_0x116d46(0x18b)]>0x1)_0x242706[_0x116d46(0x1f1)]({'botID':'all'});let _0xc7c1da=[],_0x44a7a3=[];const _0x265fd3=_0x242706['length']%0x4==0x0||_0x242706[_0x116d46(0x18b)]%0x4==0x3||_0x242706[_0x116d46(0x18b)]%0x3==0x1?0x4:0x3;let _0x11e5c5=0x0;_0x242706[_0x116d46(0x1c3)]((_0x2cb42b,_0x4419a3)=>{const _0x58f1cc=_0x116d46;if(_0x4419a3%_0x265fd3==0x0)_0x44a7a3=[];_0x44a7a3[_0x58f1cc(0x1f1)]({'text':_0x2cb42b[_0x58f1cc(0x270)]=='all'?_0x58f1cc(0x258):_0x58f1cc(0x278)+_0x2cb42b[_0x58f1cc(0x270)],'callback_data':_0x2cb42b[_0x58f1cc(0x270)]}),_0x4419a3%_0x265fd3==0x0&&(_0xc7c1da[_0x11e5c5]=_0x44a7a3,_0x11e5c5++);}),tgBot[_0x116d46(0x152)](_0x40a19d[_0x116d46(0x207)]['id'],_0x116d46(0x149),{'reply_markup':{'inline_keyboard':_0xc7c1da}})[_0x116d46(0x25b)](_0x4a4189=>{telegramError(_0x4a4189);}),tgBot['on'](_0x116d46(0x1a1),async _0x3ed670=>{const _0x42dfdf=_0x116d46,_0x8388a9=_0x3ed670['data'],_0x1d03a8=_0x3ed670[_0x42dfdf(0x1c4)];tgBot[_0x42dfdf(0x16f)](_0x3ed670['id'])[_0x42dfdf(0x1b8)](async()=>{const _0x5562e4=_0x42dfdf;_0x8388a9==_0x5562e4(0x1ab)?(tgBot[_0x5562e4(0x152)](_0x1d03a8[_0x5562e4(0x207)]['id'],_0x5562e4(0x1af))[_0x5562e4(0x25b)](_0x585a87=>{telegramError(_0x585a87);}),_0x242706[_0x5562e4(0x1c3)](_0x539056=>{const _0x151681=_0x5562e4;if(_0x539056[_0x151681(0x270)]!=_0x151681(0x1ab))toggleBot(_0x539056[_0x151681(0x270)],toggleStatus(_0x539056['botID']),_0x151681(0x18a));})):(tgBot['sendMessage'](_0x1d03a8[_0x5562e4(0x207)]['id'],_0x5562e4(0x1a5)+_0x8388a9)[_0x5562e4(0x25b)](_0x29c0e0=>{telegramError(_0x29c0e0);}),toggleBot(_0x8388a9,toggleStatus(_0x8388a9),_0x5562e4(0x18a)));}),tgBot['removeListener'](_0x42dfdf(0x1a1));});}}),tgBot[_0x32fc81(0x129)](/\/off/,_0x1ca7d8=>{const _0x213e33=_0x32fc81;if(!validateTelegram(_0x1ca7d8))return;tgBot[_0x213e33(0x1a4)]('callback_query');const _0xabae52=getEnabledBots();if(_0xabae52[_0x213e33(0x18b)]==0x0)tgBot[_0x213e33(0x152)](_0x1ca7d8['chat']['id'],_0x213e33(0x139))[_0x213e33(0x25b)](_0x56634d=>{telegramError(_0x56634d);});else{if(_0xabae52['length']>0x1)_0xabae52[_0x213e33(0x1f1)]({'botID':_0x213e33(0x1ab)});let _0x168bc8=[],_0x5e6c2a=[];const _0x1ac8d6=_0xabae52[_0x213e33(0x18b)]%0x4==0x0||_0xabae52[_0x213e33(0x18b)]%0x4==0x3||_0xabae52['length']%0x3==0x1?0x4:0x3;let _0x1cd9e8=0x0;_0xabae52[_0x213e33(0x1c3)]((_0x320984,_0x4f5202)=>{const _0xd20014=_0x213e33;if(_0x4f5202%_0x1ac8d6==0x0)_0x5e6c2a=[];_0x5e6c2a[_0xd20014(0x1f1)]({'text':_0x320984[_0xd20014(0x270)]==_0xd20014(0x1ab)?'All\x20bots':_0xd20014(0x278)+_0x320984[_0xd20014(0x270)],'callback_data':_0x320984[_0xd20014(0x270)]}),_0x4f5202%_0x1ac8d6==0x0&&(_0x168bc8[_0x1cd9e8]=_0x5e6c2a,_0x1cd9e8++);}),tgBot[_0x213e33(0x152)](_0x1ca7d8[_0x213e33(0x207)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x168bc8}})[_0x213e33(0x25b)](_0x2010e1=>{telegramError(_0x2010e1);}),tgBot['on']('callback_query',async _0x1f079f=>{const _0x9ffaa0=_0x213e33,_0x2b2030=_0x1f079f['data'],_0xfc89d7=_0x1f079f[_0x9ffaa0(0x1c4)];tgBot[_0x9ffaa0(0x16f)](_0x1f079f['id'])[_0x9ffaa0(0x1b8)](async()=>{const _0x341e5d=_0x9ffaa0;_0x2b2030==_0x341e5d(0x1ab)?(tgBot['sendMessage'](_0xfc89d7['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x341e5d(0x25b)](_0x5723b4=>{telegramError(_0x5723b4);}),_0xabae52[_0x341e5d(0x1c3)](_0x27a75f=>{const _0x4d3c0d=_0x341e5d;if(_0x27a75f[_0x4d3c0d(0x270)]!=_0x4d3c0d(0x1ab))toggleBot(_0x27a75f[_0x4d3c0d(0x270)],toggleStatus(_0x27a75f[_0x4d3c0d(0x270)]),_0x4d3c0d(0x18a));})):(tgBot[_0x341e5d(0x152)](_0xfc89d7[_0x341e5d(0x207)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x2b2030)['catch'](_0x336cf0=>{telegramError(_0x336cf0);}),toggleBot(_0x2b2030,toggleStatus(_0x2b2030),_0x341e5d(0x18a)));}),tgBot[_0x9ffaa0(0x1a4)]('callback_query');});}}),tgBot[_0x32fc81(0x129)](/\/metrics/,_0x4158b7=>{const _0x4e3291=_0x32fc81;if(!validateTelegram(_0x4158b7))return;tgBot[_0x4e3291(0x1a4)](_0x4e3291(0x1a1));const _0x5b471a=getEnabledBots();if(_0x5b471a[_0x4e3291(0x18b)]==0x0)tgBot['sendMessage'](_0x4158b7['chat']['id'],_0x4e3291(0x139))[_0x4e3291(0x25b)](_0x403180=>{telegramError(_0x403180);});else{if(_0x5b471a[_0x4e3291(0x18b)]>0x1){let _0x58aa68=[],_0x1477a3=[];const _0x1a8acf=_0x5b471a[_0x4e3291(0x18b)]%0x4==0x0||_0x5b471a[_0x4e3291(0x18b)]%0x4==0x3||_0x5b471a['length']%0x3==0x1?0x4:0x3;let _0x220a50=0x0;_0x5b471a['forEach']((_0xd50e04,_0x5817a1)=>{const _0x136b0b=_0x4e3291;if(_0x5817a1%_0x1a8acf==0x0)_0x1477a3=[];_0x1477a3[_0x136b0b(0x1f1)]({'text':_0x136b0b(0x278)+_0xd50e04[_0x136b0b(0x270)],'callback_data':_0xd50e04['botID']}),_0x5817a1%_0x1a8acf==0x0&&(_0x58aa68[_0x220a50]=_0x1477a3,_0x220a50++);}),tgBot[_0x4e3291(0x152)](_0x4158b7[_0x4e3291(0x207)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x58aa68}})[_0x4e3291(0x25b)](_0x371f31=>{telegramError(_0x371f31);}),tgBot['on'](_0x4e3291(0x1a1),async _0x4242fa=>{const _0xc2a658=_0x4e3291,_0x4b39c9=_0x4242fa[_0xc2a658(0x1e2)],_0x4e4a55=_0x4242fa[_0xc2a658(0x1c4)];tgBot[_0xc2a658(0x16f)](_0x4242fa['id'])['then'](async()=>{const _0x24bdbd=_0xc2a658;if(pid[_0x4b39c9])pid[_0x4b39c9]['send']({'function':_0x24bdbd(0x21e),'args':null});}),tgBot[_0xc2a658(0x1a4)]('callback_query');});}else{const _0x1596f6=_0x5b471a[0x0][_0x4e3291(0x270)];if(pid[_0x1596f6])pid[_0x1596f6][_0x4e3291(0x185)]({'function':_0x4e3291(0x21e),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x5f41e5=>{const _0x3c409c=_0x32fc81;if(!validateTelegram(_0x5f41e5))return;tgBot['removeListener'](_0x3c409c(0x1a1));const _0x462425=getEnabledBots();if(_0x462425['length']==0x0)tgBot[_0x3c409c(0x152)](_0x5f41e5['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x5a9e4b=>{telegramError(_0x5a9e4b);});else{if(_0x462425['length']>0x1){let _0x22c72a=[],_0x171f3d=[];const _0x1f6716=_0x462425[_0x3c409c(0x18b)]%0x4==0x0||_0x462425['length']%0x4==0x3||_0x462425['length']%0x3==0x1?0x4:0x3;let _0x71f28c=0x0;_0x462425[_0x3c409c(0x1c3)]((_0x363c60,_0x24a793)=>{const _0x1d9b97=_0x3c409c;if(_0x24a793%_0x1f6716==0x0)_0x171f3d=[];_0x171f3d[_0x1d9b97(0x1f1)]({'text':_0x1d9b97(0x278)+_0x363c60[_0x1d9b97(0x270)],'callback_data':_0x363c60[_0x1d9b97(0x270)]}),_0x24a793%_0x1f6716==0x0&&(_0x22c72a[_0x71f28c]=_0x171f3d,_0x71f28c++);}),tgBot[_0x3c409c(0x152)](_0x5f41e5[_0x3c409c(0x207)]['id'],_0x3c409c(0x23c),{'reply_markup':{'inline_keyboard':_0x22c72a}})[_0x3c409c(0x25b)](_0x56ca32=>{telegramError(_0x56ca32);}),tgBot['on'](_0x3c409c(0x1a1),async _0x36bc23=>{const _0x20eba=_0x3c409c,_0x19222a=_0x36bc23[_0x20eba(0x1e2)],_0x568edf=_0x36bc23[_0x20eba(0x1c4)];tgBot['answerCallbackQuery'](_0x36bc23['id'])[_0x20eba(0x1b8)](async()=>{const _0x4584d0=_0x20eba;if(pid[_0x19222a])pid[_0x19222a][_0x4584d0(0x185)]({'function':_0x4584d0(0xf2),'args':null});}),tgBot[_0x20eba(0x1a4)](_0x20eba(0x1a1));});}else{const _0x745ca2=_0x462425[0x0][_0x3c409c(0x270)];if(pid[_0x745ca2])pid[_0x745ca2][_0x3c409c(0x185)]({'function':_0x3c409c(0xf2),'args':null});}}}),tgBot['onText'](/\/update/,async _0x2b91f1=>{const _0x36864a=_0x32fc81;if(!validateTelegram(_0x2b91f1))return;tgBot[_0x36864a(0x1a4)](_0x36864a(0x1a1)),await getMessages();if(!updateAvailable)tgBot[_0x36864a(0x152)](_0x2b91f1[_0x36864a(0x207)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x29cb24=>{telegramError(_0x29cb24);});else!validInstallation?tgBot[_0x36864a(0x152)](_0x2b91f1[_0x36864a(0x207)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')['catch'](_0x4b31af=>{telegramError(_0x4b31af);}):(tgBot[_0x36864a(0x152)](_0x2b91f1['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x36864a(0x156),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0x2d3bb0=>{telegramError(_0x2d3bb0);}),tgBot['on'](_0x36864a(0x1a1),async _0x15896b=>{const _0x3ab545=_0x36864a,_0x5ddd08=_0x15896b[_0x3ab545(0x1e2)],_0x5302c0=_0x15896b[_0x3ab545(0x1c4)];tgBot[_0x3ab545(0x16f)](_0x15896b['id'])['then'](async()=>{const _0x348d5d=_0x3ab545;_0x5ddd08==_0x348d5d(0xe9)&&(await tgBot[_0x348d5d(0x152)](_0x5302c0[_0x348d5d(0x207)]['id'],_0x348d5d(0x257))[_0x348d5d(0x25b)](_0x306d88=>{telegramError(_0x306d88);}),updateBB(_0x348d5d(0xd8))),_0x5ddd08=='no'&&await tgBot[_0x348d5d(0x152)](_0x5302c0[_0x348d5d(0x207)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x348d5d(0x25b)](_0x3e1aac=>{telegramError(_0x3e1aac);});}),tgBot[_0x3ab545(0x1a4)](_0x3ab545(0x1a1));}));}),tgBot[_0x32fc81(0x129)](/\/reinstall/,async _0x1c2f87=>{const _0x1cb6c1=_0x32fc81;if(!validateTelegram(_0x1c2f87))return;tgBot['removeListener'](_0x1cb6c1(0x1a1)),!validInstallation?tgBot[_0x1cb6c1(0x152)](_0x1c2f87['chat']['id'],_0x1cb6c1(0x106))['catch'](_0x319413=>{telegramError(_0x319413);}):(tgBot[_0x1cb6c1(0x152)](_0x1c2f87[_0x1cb6c1(0x207)]['id'],_0x1cb6c1(0x11c),{'reply_markup':{'inline_keyboard':[[{'text':_0x1cb6c1(0x156),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x1cb6c1(0x25b)](_0x5d03aa=>{telegramError(_0x5d03aa);}),tgBot['on'](_0x1cb6c1(0x1a1),async _0x53e7e0=>{const _0x3a9f1f=_0x1cb6c1,_0x3bd59b=_0x53e7e0[_0x3a9f1f(0x1e2)],_0x1fcc59=_0x53e7e0[_0x3a9f1f(0x1c4)];tgBot[_0x3a9f1f(0x16f)](_0x53e7e0['id'])['then'](async()=>{const _0x145ac3=_0x3a9f1f;_0x3bd59b=='yes'&&(await tgBot[_0x145ac3(0x152)](_0x1fcc59[_0x145ac3(0x207)]['id'],_0x145ac3(0x27a))['catch'](_0x29e04c=>{telegramError(_0x29e04c);}),updateBB('reinstall')),_0x3bd59b=='no'&&await tgBot[_0x145ac3(0x152)](_0x1fcc59[_0x145ac3(0x207)]['id'],_0x145ac3(0x116))[_0x145ac3(0x25b)](_0x46d72b=>{telegramError(_0x46d72b);});}),tgBot['removeListener'](_0x3a9f1f(0x1a1));}));}),tgBot[_0x32fc81(0x129)](/\/toggle/,_0x207dba=>{const _0x178487=_0x32fc81;if(!validateTelegram(_0x207dba))return;tgBot['removeListener']('callback_query');const _0x2479da=getBotsWithMode();if(_0x2479da[_0x178487(0x18b)]==0x0)tgBot[_0x178487(0x152)](_0x207dba['chat']['id'],_0x178487(0x139))[_0x178487(0x25b)](_0x363b37=>{telegramError(_0x363b37);});else{let _0x138c4a=[],_0xad4d2b=[];const _0x325105=0x2;let _0x498d9b=0x0;_0x2479da[_0x178487(0x1c3)]((_0x45ea86,_0x1fa681)=>{const _0xe7eba3=_0x178487;if(_0x1fa681%_0x325105==0x0)_0xad4d2b=[];_0xad4d2b['push']({'text':_0xe7eba3(0x278)+_0x45ea86[_0xe7eba3(0x270)]+'\x20('+_0x45ea86['mode']+')','callback_data':_0x45ea86[_0xe7eba3(0x270)]}),_0x1fa681%_0x325105==0x0&&(_0x138c4a[_0x498d9b]=_0xad4d2b,_0x498d9b++);}),tgBot[_0x178487(0x152)](_0x207dba['chat']['id'],_0x178487(0x1d7),{'reply_markup':{'inline_keyboard':_0x138c4a}})[_0x178487(0x25b)](_0x5b3eaa=>{telegramError(_0x5b3eaa);}),tgBot['on'](_0x178487(0x1a1),async _0x1d2a73=>{const _0x1a1b55=_0x178487,_0x57a7fb=_0x1d2a73[_0x1a1b55(0x1e2)],_0x422a6b=_0x1d2a73[_0x1a1b55(0x1c4)];tgBot['answerCallbackQuery'](_0x1d2a73['id'])['then'](async()=>{const _0x2a66d4=_0x1a1b55,_0x32a429=_0x2479da[_0x2a66d4(0x198)](_0x4fae08=>_0x4fae08[_0x2a66d4(0x270)]==_0x57a7fb),_0x86f299=_0x32a429[_0x2a66d4(0x23f)]==_0x2a66d4(0x146)?'manual':_0x2a66d4(0x146);tgBot['sendMessage'](_0x422a6b[_0x2a66d4(0x207)]['id'],_0x2a66d4(0x14f)+_0x57a7fb+_0x2a66d4(0x22c)+_0x86f299+_0x2a66d4(0x1a6))['catch'](_0x31baa6=>{telegramError(_0x31baa6);}),toggleBotMode(_0x57a7fb);}),tgBot[_0x1a1b55(0x1a4)](_0x1a1b55(0x1a1));});}}),tgBot[_0x32fc81(0x129)](/\/names/,_0x248fcb=>{const _0x5e1af1=_0x32fc81;if(!validateTelegram(_0x248fcb))return;let _0x57d58c='';config['forEach'](_0x99f14b=>{const _0x3018d3=_0x17b4;_0x57d58c+='Bot\x20'+_0x99f14b[_0x3018d3(0x270)]+':\x20'+_0x99f14b[_0x3018d3(0x254)]+'\x0a';}),tgBot['sendMessage'](_0x248fcb[_0x5e1af1(0x207)]['id'],_0x57d58c,{'parse_mode':_0x5e1af1(0x292)})[_0x5e1af1(0x25b)](_0x5c7044=>{telegramError(_0x5c7044);});}),tgBot['onText'](/\/disable/,_0x7e54e3=>{const _0x2a691a=_0x32fc81;if(!validateTelegram(_0x7e54e3))return;tgBot[_0x2a691a(0x152)](_0x7e54e3[_0x2a691a(0x207)]['id'],_0x2a691a(0xef))['catch'](_0x52290d=>{telegramError(_0x52290d);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x32fc81(0x129)](/\/help/,_0x5946c3=>{const _0x52999c=_0x32fc81;if(!validateTelegram(_0x5946c3))return;tgBot['sendMessage'](_0x5946c3[_0x52999c(0x207)]['id'],_0x33b543)[_0x52999c(0x25b)](_0x4c8018=>{telegramError(_0x4c8018);});}),tgBot['on'](_0x32fc81(0x230),_0x1fed98=>{const _0x381861=_0x32fc81;_0x1fed98[_0x381861(0xf8)]()[_0x381861(0x227)](_0x381861(0x27e))&&(logger[_0x381861(0x13c)](_0x381861(0x288)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x381861(0x26e))[_0x381861(0xe5)](_0x381861(0x1e8),_0x381861(0x288)));}),process[_0x32fc81(0x228)](_0x32fc81(0x18c),()=>{const _0x5a3e5c=_0x32fc81;if(tgBot)tgBot[_0x5a3e5c(0xe3)]();process['exit'](0x1);}),process[_0x32fc81(0x228)]('SIGTERM',()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){const _0x178909=_0x3ea1f7;tgBot&&(tgBot[_0x178909(0xe3)](),tgBot=null);}function sendTelegram(_0x4a21b1,_0x592cf2){const _0x6052d2=_0x3ea1f7;if(settings[_0x6052d2(0x266)]){if(settings[_0x6052d2(0x169)]=='all'||(_0x592cf2[_0x6052d2(0x252)]==_0x6052d2(0x1d3)||_0x592cf2['type']==_0x6052d2(0x140)||_0x592cf2['type']==_0x6052d2(0x23a))&&settings[_0x6052d2(0x169)]==_0x6052d2(0xf9)||_0x592cf2[_0x6052d2(0x252)]=='order'&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x6052d2(0x1c8)]){if(_0x592cf2[_0x6052d2(0x235)])tgBot[_0x6052d2(0x152)](settings['telegramChatId'],_0x592cf2[_0x6052d2(0x254)]+'\x20>\x20'+_0x592cf2[_0x6052d2(0x1be)])['catch'](_0x578d0c=>{telegramError(_0x578d0c);});else tgBot['sendMessage'](settings[_0x6052d2(0x1c8)],_0x6052d2(0x278)+_0x4a21b1+'\x20>\x20'+_0x592cf2[_0x6052d2(0x1be)])[_0x6052d2(0x25b)](_0x448248=>{telegramError(_0x448248);});}}}}async function sendTelegramMsg(_0x433a4f,_0x101c75=_0x3ea1f7(0x292)){const _0x19b65e=_0x3ea1f7;return settings[_0x19b65e(0x266)]&&tgBot&&settings[_0x19b65e(0x1c8)]?(await tgBot[_0x19b65e(0x152)](settings['telegramChatId'],_0x433a4f,{'parse_mode':_0x101c75})[_0x19b65e(0x25b)](_0x2f52fd=>{telegramError(_0x2f52fd);}),!![]):![];}function getDeviceWithIp(_0x23598d){const _0x9c76e=_0x3ea1f7;return devices[_0x9c76e(0x198)](_0x2af4e0=>_0x2af4e0['ip']===_0x23598d);}function temporaryAccess2FA(_0x3877e2,_0x13883c){const _0x3f45da=_0x3ea1f7;let _0x5dd229=new Date(),_0x1d52fa=![];if(lastIpApproval){if(_0x5dd229-lastIpApproval<0x1388)_0x1d52fa=!![];}lastIpApproval=new Date();if(_0x1d52fa)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x3f45da(0x1a4)](_0x3f45da(0x1a1)),tgBot[_0x3f45da(0x152)](settings[_0x3f45da(0x1c8)],_0x3f45da(0x1bb)+normalizeIP(_0x13883c)[_0x3f45da(0x17d)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3f45da(0x18d),'callback_data':'5'},{'text':_0x3f45da(0x27c),'callback_data':'15'},{'text':_0x3f45da(0x276),'callback_data':'30'},{'text':_0x3f45da(0xd0),'callback_data':_0x3f45da(0xd0)}]]}})[_0x3f45da(0x25b)](_0x4fc672=>{telegramError(_0x4fc672);}),tgBot['on'](_0x3f45da(0x1a1),async _0x5261e0=>{const _0x8410ea=_0x3f45da,_0x4df107=_0x5261e0[_0x8410ea(0x1e2)],_0x4dc58e=_0x5261e0[_0x8410ea(0x1c4)];tgBot['answerCallbackQuery'](_0x5261e0['id'])[_0x8410ea(0x1b8)](async()=>{const _0x13ae6e=_0x8410ea;devices[_0x3877e2]['telegramIpApproval']={'clientip':_0x13883c,'timestamp':new Date()[_0x13ae6e(0x20e)](),'expiry':_0x4df107},_0x4df107!=_0x13ae6e(0xd0)?(await tgBot[_0x13ae6e(0x152)](_0x4dc58e[_0x13ae6e(0x207)]['id'],_0x13ae6e(0x166)+_0x4df107+_0x13ae6e(0x16d),{'parse_mode':_0x13ae6e(0x292)})[_0x13ae6e(0x25b)](_0xcd17b=>{telegramError(_0xcd17b);}),io['to'](_0x3877e2)[_0x13ae6e(0xe5)](_0x13ae6e(0x1fa),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x13ae6e(0x152)](_0x4dc58e['chat']['id'],_0x13ae6e(0x219))['catch'](_0x2d20ee=>{telegramError(_0x2d20ee);}),io['to'](_0x3877e2)[_0x13ae6e(0xe5)](_0x13ae6e(0x1fa),{'access':{'allow':![],'reason':_0x13ae6e(0x248),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x496c9f,_0x3e061f){const _0x28c97d=_0x3ea1f7;tgBot&&settings[_0x28c97d(0x1c8)]&&(tgBot[_0x28c97d(0x1a4)](_0x28c97d(0x1a1)),tgBot[_0x28c97d(0x152)](settings[_0x28c97d(0x1c8)],_0x28c97d(0x1a2)+normalizeIP(_0x3e061f)[_0x28c97d(0x17d)]+_0x28c97d(0x281),{'parse_mode':_0x28c97d(0x292),'reply_markup':{'inline_keyboard':[[{'text':_0x28c97d(0x137),'callback_data':loginExpiry},{'text':_0x28c97d(0xd0),'callback_data':'reject'}]]}})['catch'](_0x199642=>{telegramError(_0x199642);}),tgBot['on']('callback_query',async _0x8e52a9=>{const _0x15e03a=_0x28c97d,_0x13ce8c=_0x8e52a9[_0x15e03a(0x1e2)],_0x1bc195=_0x8e52a9[_0x15e03a(0x1c4)];tgBot[_0x15e03a(0x16f)](_0x8e52a9['id'])[_0x15e03a(0x1b8)](async()=>{const _0x3e533b=_0x15e03a;devices[_0x496c9f]['telegram2FaApproval']={'clientip':_0x3e061f,'timestamp':new Date()[_0x3e533b(0x20e)](),'expiry':_0x13ce8c},_0x13ce8c!=_0x3e533b(0xd0)?(await tgBot[_0x3e533b(0x152)](_0x1bc195[_0x3e533b(0x207)]['id'],'Login\x20accepted',{'parse_mode':_0x3e533b(0x292)})[_0x3e533b(0x25b)](_0x370f6a=>{telegramError(_0x370f6a);}),io['to'](_0x496c9f)[_0x3e533b(0xe5)](_0x3e533b(0x1fa),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x3e533b(0x152)](_0x1bc195[_0x3e533b(0x207)]['id'],_0x3e533b(0x1bc))[_0x3e533b(0x25b)](_0x131653=>{telegramError(_0x131653);}),io['to'](_0x496c9f)[_0x3e533b(0xe5)](_0x3e533b(0x1fa),{'access':{'allow':![],'reason':_0x3e533b(0x250),'token':null}}));}),tgBot[_0x15e03a(0x1a4)](_0x15e03a(0x1a1));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x43bf06=_0x3ea1f7;return dbConfig[_0x43bf06(0x263)](_0x43bf06(0x1f6))[_0x43bf06(0x11e)]('botID')[_0x43bf06(0x180)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x4169f3=_0x3ea1f7;return dbConfig[_0x4169f3(0x263)](_0x4169f3(0x1f6))['sortBy'](_0x4169f3(0x270))[_0x4169f3(0x180)]({'status':_0x4169f3(0x12d)})[_0x4169f3(0x196)]()||[];}function getBotAttributes(_0x8dd528){const _0x223f79=_0x3ea1f7;let _0xa3895={};const _0x21a142=configpath+'bot-'+_0x8dd528+_0x223f79(0xde),_0xe62718=fs['existsSync'](_0x21a142);if(_0xe62718){const _0x153dc7=fs[_0x223f79(0x1bd)](_0x21a142);try{const _0x11a81b=JSON['parse'](_0x153dc7),_0x5d648f=_0x11a81b?_0x11a81b[_0x223f79(0x1ca)][0x0]['headless']:![];_0xa3895[_0x223f79(0x23f)]=_0x5d648f?_0x223f79(0x146):_0x223f79(0x15b),_0xa3895['botname']=_0x11a81b?_0x11a81b[_0x223f79(0x1ca)][0x0]['botname']:_0x223f79(0x278)+_0x8dd528;}catch(_0x5c806b){_0xa3895[_0x223f79(0x23f)]=_0x223f79(0x15b),_0xa3895['botname']='Bot\x20'+_0x8dd528;}}else _0xa3895[_0x223f79(0x23f)]='manual',_0xa3895[_0x223f79(0x254)]=_0x223f79(0x278)+_0x8dd528;return _0xa3895;}function getBotsWithMode(){const _0x240e82=_0x3ea1f7,_0x111932=dbConfig[_0x240e82(0x263)]('bots')[_0x240e82(0x11e)]('botID')[_0x240e82(0x196)]()||[];return _0x111932[_0x240e82(0x1c3)](_0x284289=>{const _0x3a39d7=_0x240e82;let _0x2dfeb4=getBotAttributes(_0x284289[_0x3a39d7(0x270)]);_0x284289[_0x3a39d7(0x23f)]=_0x2dfeb4[_0x3a39d7(0x23f)];}),_0x111932;}function getBotExchanges(){const _0x2cceba=_0x3ea1f7;let _0x1cb2c3=[];const _0x1853e7=dbConfig['get'](_0x2cceba(0x1f6))[_0x2cceba(0x11e)](_0x2cceba(0x270))[_0x2cceba(0x196)]()||[];_0x1853e7[_0x2cceba(0x1c3)](_0x5820d8=>{const _0x40b6d9=_0x2cceba;if(_0x5820d8[_0x40b6d9(0x1fa)]==_0x40b6d9(0x1cc)){const _0x7debc1=configpath+_0x40b6d9(0x121)+_0x5820d8[_0x40b6d9(0x270)]+'-config.json',_0xb7ce99=fs[_0x40b6d9(0x255)](_0x7debc1);let _0x42f105;if(_0xb7ce99){const _0x21f816=fs[_0x40b6d9(0x1bd)](_0x7debc1);try{const _0x3ed0c2=JSON[_0x40b6d9(0x251)](_0x21f816);_0x42f105=_0x3ed0c2?_0x3ed0c2[_0x40b6d9(0x1ca)][0x0]['exchange']:null;}catch(_0x3d011a){}}if(_0x42f105)_0x1cb2c3[_0x40b6d9(0x1f1)](_0x42f105);}});const _0xf3fcd9=[...new Set(_0x1cb2c3)][_0x2cceba(0x239)]();return _0xf3fcd9;}async function initUser(){const _0x52100a=_0x3ea1f7;if(!settings[_0x52100a(0x1e1)]){const _0x4d82c3=uuidRandom();mixpanel['alias'](_0x4d82c3),updateSetting('userid',_0x4d82c3);}}async function initSecure(){const _0x5cdf82=_0x3ea1f7;let _0x2028dc=getSecure();if(!_0x2028dc[_0x5cdf82(0x1a0)](_0x5cdf82(0x1ed))){let _0x55e338=await generateKeys();_0x2028dc['publicKey']=_0x55e338[_0x5cdf82(0xdb)],_0x2028dc['privateKey']=_0x55e338[_0x5cdf82(0x154)],_0x2028dc[_0x5cdf82(0x1ed)]=crypto['randomBytes'](0x20)[_0x5cdf82(0xf8)]('hex');;storeSecure(_0x2028dc);}}function getSettings(){const _0x1ed0c7=_0x3ea1f7;return dbSettings[_0x1ed0c7(0x263)]('settings')[_0x1ed0c7(0x196)]()||{};}function getSecure(){const _0x8d41dc=_0x3ea1f7;return dbSecure[_0x8d41dc(0x263)](_0x8d41dc(0xf4))['value']()||{};}function getBlacklist(){const _0x155256=_0x3ea1f7;return dbSecure[_0x155256(0x263)]('blacklist')[_0x155256(0x196)]()||[];}function broadcastToBots(_0x1c2350,_0x4ec20e){const _0x411892=_0x3ea1f7;config[_0x411892(0x1c3)](_0x5e1529=>{const _0x444413=_0x411892;if(_0x5e1529[_0x444413(0x1fa)]==_0x444413(0x1cc)&&_0x5e1529[_0x444413(0x289)]==_0x444413(0x1b9)){if(pid[_0x5e1529[_0x444413(0x270)]])pid[_0x5e1529[_0x444413(0x270)]][_0x444413(0x185)]({[_0x1c2350]:_0x4ec20e});}});}function storeSettings(_0x49a941,_0x5356e=![]){const _0x39a80e=_0x3ea1f7;_0x49a941={...settings,..._0x49a941};if(_0x5356e&&_0x49a941[_0x39a80e(0x245)]!=_0x39a80e(0x135)&&_0x49a941['bbPassword']!='***'&&_0x49a941['bbPassword']!=''){const _0x17289f=crypt['decrypt'](secure[_0x39a80e(0x154)],_0x49a941['bbPassword'])[_0x39a80e(0x1c4)][_0x39a80e(0x14d)]('@')[0x0],_0x51c868=bcrypt[_0x39a80e(0x21c)](_0x17289f,saltRounds);_0x49a941={..._0x49a941,'bbPassword':_0x51c868};}if(_0x5356e&&_0x49a941[_0x39a80e(0x142)]!=_0x39a80e(0x135)&&_0x49a941[_0x39a80e(0x142)]!=_0x39a80e(0x12e)&&_0x49a941[_0x39a80e(0x142)]!=''){const _0xec64fa=crypt['decrypt'](secure[_0x39a80e(0x154)],_0x49a941[_0x39a80e(0x142)])[_0x39a80e(0x1c4)]['split']('@')[0x0];_0x49a941={..._0x49a941,'telegramToken':_0xec64fa};}const _0x5c6dc4=_0x49a941[_0x39a80e(0x142)]!='************'&&_0x49a941[_0x39a80e(0x142)]!=settings['telegramToken']||_0x49a941['telegramUsername']!=settings['telegramUsername'],_0x135353=_0x49a941[_0x39a80e(0x142)]==''||_0x49a941[_0x39a80e(0xd7)]=='';if(_0x5c6dc4)_0x49a941['telegramEvents']=_0x39a80e(0x1ab);for(const [_0x4a2d3c,_0x31de27]of Object[_0x39a80e(0x17c)](_0x49a941)){if(_0x4a2d3c=='telegramToken'&&_0x31de27==_0x39a80e(0x135)){_0x49a941[_0x39a80e(0x142)]=settings[_0x39a80e(0x142)];continue;};if(_0x4a2d3c==_0x39a80e(0x245)&&_0x31de27==_0x39a80e(0x135)){_0x49a941[_0x39a80e(0x245)]=settings['bbPassword'];continue;};dbSettings['set'](_0x39a80e(0x147)+_0x4a2d3c,_0x31de27)[_0x39a80e(0xd3)]();}settings=_0x49a941,io['to']('botmanager')[_0x39a80e(0xe5)](_0x39a80e(0x291),cleanSettings()),broadcastToBots(_0x39a80e(0xd4),settings[_0x39a80e(0xd4)]),broadcastToBots(_0x39a80e(0x11a),settings[_0x39a80e(0x11a)]);if(_0x5c6dc4&&!_0x135353)initTelegram();if(_0x5c6dc4&&_0x135353)disableTelegram();getAllClients()[_0x39a80e(0x1c3)](_0x263312=>{const _0x321096=_0x39a80e;getSocket(_0x263312['id'])[_0x321096(0xe5)](_0x321096(0x1fa),{'access':{'allow':![],'reason':_0x321096(0x261),'token':null}});});}function updateSetting(_0x1d492b,_0x986b6f){const _0x1b1c7c=_0x3ea1f7;dbSettings[_0x1b1c7c(0x171)](_0x1b1c7c(0x147)+_0x1d492b,_0x986b6f)[_0x1b1c7c(0xd3)](),settings=getSettings(),io['to'](_0x1b1c7c(0x26e))[_0x1b1c7c(0xe5)]('settings',cleanSettings());}function storeSecure(_0x1132ca){const _0x4d7c9b=_0x3ea1f7;dbSecure[_0x4d7c9b(0x263)](_0x4d7c9b(0xf4))[_0x4d7c9b(0x1f1)](_0x1132ca)[_0x4d7c9b(0xd3)](),secure=_0x1132ca;}function _0x17b4(_0x42ede9,_0x33fb87){const _0x1c0056=_0x1af9();return _0x17b4=function(_0x3d14c0,_0x4663f6){_0x3d14c0=_0x3d14c0-0xd0;let _0x1af92c=_0x1c0056[_0x3d14c0];return _0x1af92c;},_0x17b4(_0x42ede9,_0x33fb87);}function addBlacklist(_0x105d17){const _0x4f15d8=_0x3ea1f7;cleanBlacklist();let _0x3879cf;devices[_0x105d17][_0x4f15d8(0x175)]?_0x3879cf=Math[_0x4f15d8(0x272)](devices[_0x105d17]['telegramIpApproval'][_0x4f15d8(0x168)],loginExpiry):_0x3879cf=loginExpiry,dbSecure['get']('blacklist')['push']({'expiry':new Date()[_0x4f15d8(0x20e)]()+_0x3879cf*0x3c*0x3e8,'token':devices[_0x105d17][_0x4f15d8(0x1d0)][_0x4f15d8(0x1bf)]})['write'](),blacklist=dbSecure['get'](_0x4f15d8(0x22d))['value']();}function cleanBlacklist(){const _0x548d24=_0x3ea1f7;let _0x3fe9d0=dbSecure['get']('blacklist')[_0x548d24(0x24c)]()['value'](),_0x2899f7=new Date()['getTime']();_0x3fe9d0[_0x548d24(0x1c3)](_0x14a24a=>{const _0x341b1a=_0x548d24;_0x14a24a['expiry']<_0x2899f7&&dbSecure[_0x341b1a(0x263)]('blacklist')[_0x341b1a(0x128)]({'expiry':_0x14a24a[_0x341b1a(0x168)]})['write']();});}function initStates(){const _0x3d15c8=_0x3ea1f7;let _0x5f157f=getConfiguration();_0x5f157f[_0x3d15c8(0x1c3)](_0x2c85ec=>{_0x2c85ec['live']='stopped';}),storeConfiguration(_0x5f157f);}function onKeys(){const _0x1be1ee=new RSA();return new Promise(_0x37e25f=>{const _0x29886e=_0x17b4;_0x1be1ee['generateKeyPairAsync']()[_0x29886e(0x1b8)](_0x2d45d1=>{_0x37e25f(_0x2d45d1);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x11e515=_0x3ea1f7;let _0x31d8a2=getSettings(),_0x5f29e2=![];!_0x31d8a2[_0x11e515(0x1a0)](_0x11e515(0x202))&&(_0x31d8a2[_0x11e515(0x202)]=0x0,_0x5f29e2=!![]);!_0x31d8a2[_0x11e515(0x1a0)]('lastmsgemitted')&&(_0x31d8a2['lastmsgemitted']=0x0,_0x5f29e2=!![]);!_0x31d8a2['hasOwnProperty'](_0x11e515(0x109))&&(_0x31d8a2[_0x11e515(0x109)]=_0x11e515(0x25c),_0x5f29e2=!![]);!_0x31d8a2[_0x11e515(0x1a0)](_0x11e515(0x11a))&&(_0x31d8a2['onepagemode']=![],_0x5f29e2=!![]);if(_0x5f29e2)storeSettings(_0x31d8a2);}function storeConfiguration(_0x222ef3){const _0x236525=_0x3ea1f7;dbConfig[_0x236525(0x263)]('bots')['remove']()[_0x236525(0xd3)](),_0x222ef3[_0x236525(0x1c3)](_0xa8389f=>{const _0x2661c9=_0x236525;delete _0xa8389f[_0x2661c9(0x23f)];}),dbConfig[_0x236525(0x263)](_0x236525(0x1f6))[_0x236525(0x1f1)](..._0x222ef3)[_0x236525(0xd3)](),config=_0x222ef3;}function resetPassword(){const _0x427f63=_0x3ea1f7;tgBot&&settings[_0x427f63(0x1c8)]&&(tgBot[_0x427f63(0x1a4)](_0x427f63(0x1a1)),tgBot[_0x427f63(0x152)](settings[_0x427f63(0x1c8)],_0x427f63(0x172),{'parse_mode':_0x427f63(0x292),'reply_markup':{'inline_keyboard':[[{'text':_0x427f63(0xe9),'callback_data':_0x427f63(0xe9)},{'text':'no','callback_data':'no'}]]}})[_0x427f63(0x25b)](_0x2978a3=>{telegramError(_0x2978a3);}),tgBot['on'](_0x427f63(0x1a1),async _0x148c4b=>{const _0x81be3d=_0x427f63,_0x2b6efb=_0x148c4b[_0x81be3d(0x1e2)],_0x543039=_0x148c4b[_0x81be3d(0x1c4)];tgBot[_0x81be3d(0x16f)](_0x148c4b['id'])[_0x81be3d(0x1b8)](async()=>{const _0x4abbfe=_0x81be3d;if(_0x2b6efb!='no'){const _0x273c1d=0xf,_0x2e2932='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1b24ee=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x273c1d)))[_0x4abbfe(0x108)](_0x3830fd=>_0x2e2932[_0x3830fd%_0x2e2932[_0x4abbfe(0x18b)]])['join'](''),_0x27f9fe=bcrypt[_0x4abbfe(0x21c)](_0x1b24ee,saltRounds);storeSettings({'bbPassword':_0x27f9fe}),await tgBot[_0x4abbfe(0x152)](_0x543039[_0x4abbfe(0x207)]['id'],_0x4abbfe(0x1b1)+_0x1b24ee,{'parse_mode':_0x4abbfe(0x292)})[_0x4abbfe(0x25b)](_0x55d321=>{telegramError(_0x55d321);});}else await tgBot[_0x4abbfe(0x152)](_0x543039['chat']['id'],_0x4abbfe(0x101))[_0x4abbfe(0x25b)](_0x72216e=>{telegramError(_0x72216e);});}),tgBot[_0x81be3d(0x1a4)]('callback_query');}));}async function confirmRestore(_0x302a15,_0x20591e){const _0x1f87e1=_0x3ea1f7;io['to'](_0x1f87e1(0x26e))['emit'](_0x1f87e1(0x1e8),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x1f87e1(0x23a)),tgBot&&settings[_0x1f87e1(0x1c8)]&&(tgBot['removeListener']('callback_query'),await tgBot['sendMessage'](settings[_0x1f87e1(0x1c8)],_0x1f87e1(0x1df),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1f87e1(0xe9),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x1f87e1(0x25b)](_0x5cab14=>{telegramError(_0x5cab14);}),tgBot['on'](_0x1f87e1(0x1a1),async _0x282951=>{const _0x4d2380=_0x1f87e1,_0x3ff0f3=_0x282951[_0x4d2380(0x1e2)],_0x261cc3=_0x282951[_0x4d2380(0x1c4)];tgBot[_0x4d2380(0x16f)](_0x282951['id'])[_0x4d2380(0x1b8)](async()=>{const _0x2a096e=_0x4d2380;_0x3ff0f3=='yes'?(await tgBot[_0x2a096e(0x152)](_0x261cc3[_0x2a096e(0x207)]['id'],_0x2a096e(0x213),{'parse_mode':_0x2a096e(0x292)})[_0x2a096e(0x25b)](_0x1f5d94=>{telegramError(_0x1f5d94);}),unzipFile(_0x302a15,_0x20591e)):(logger[_0x2a096e(0x222)](_0x2a096e(0xee)),await tgBot[_0x2a096e(0x152)](_0x261cc3[_0x2a096e(0x207)]['id'],_0x2a096e(0xee))[_0x2a096e(0x25b)](_0x30b92e=>{telegramError(_0x30b92e);}));}),tgBot['removeListener'](_0x4d2380(0x1a1));}));}function getServerTime(){const _0x3ec5cc=_0x3ea1f7,_0x2db179=new Date();return _0x2db179['getFullYear']()+'/'+(_0x2db179['getMonth']()+0x1)[_0x3ec5cc(0xf8)]()['padStart'](0x2,'0')+'/'+_0x2db179['getDate']()[_0x3ec5cc(0xf8)]()['padStart'](0x2,'0')+'\x20'+_0x2db179['getHours']()[_0x3ec5cc(0xf8)]()[_0x3ec5cc(0x15e)](0x2,'0')+':'+_0x2db179[_0x3ec5cc(0x151)]()[_0x3ec5cc(0xf8)]()[_0x3ec5cc(0x15e)](0x2,'0')+':'+_0x2db179[_0x3ec5cc(0x17e)]()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x176306=_0x3ea1f7,_0x350525=shiftedTime();return _0x350525['getFullYear']()+'/'+(_0x350525[_0x176306(0x225)]()+0x1)[_0x176306(0xf8)]()['padStart'](0x2,'0')+'/'+_0x350525[_0x176306(0xed)]()[_0x176306(0xf8)]()[_0x176306(0x15e)](0x2,'0')+'\x20'+_0x350525[_0x176306(0xf3)]()[_0x176306(0xf8)]()[_0x176306(0x15e)](0x2,'0')+':'+_0x350525[_0x176306(0x151)]()['toString']()[_0x176306(0x15e)](0x2,'0')+':'+_0x350525[_0x176306(0x17e)]()[_0x176306(0xf8)]()[_0x176306(0x15e)](0x2,'0');}function getCleanTimeStamp(){const _0x43860a=_0x3ea1f7,_0x160d1f=shiftedTime();return _0x160d1f[_0x43860a(0x20d)]()+(_0x160d1f[_0x43860a(0x225)]()+0x1)[_0x43860a(0xf8)]()[_0x43860a(0x15e)](0x2,'0')+_0x160d1f[_0x43860a(0xed)]()[_0x43860a(0xf8)]()[_0x43860a(0x15e)](0x2,'0')+'-'+_0x160d1f[_0x43860a(0xf3)]()[_0x43860a(0xf8)]()['padStart'](0x2,'0')+_0x160d1f[_0x43860a(0x151)]()[_0x43860a(0xf8)]()[_0x43860a(0x15e)](0x2,'0')+_0x160d1f[_0x43860a(0x17e)]()[_0x43860a(0xf8)]()[_0x43860a(0x15e)](0x2,'0');}function shiftedTime(){const _0x492c51=_0x3ea1f7,_0x2949d7=new Date();let _0x2ba4c2=_0x2949d7;if(settings[_0x492c51(0xd4)]&&settings['timeshift']!==0x0)_0x2ba4c2=fns[_0x492c51(0x1c2)](_0x2949d7,{'hours':settings['timeshift']});return _0x2ba4c2;}function startScheduler(){const _0x20a8fa=_0x3ea1f7,_0x2c49ea=new Date()[_0x20a8fa(0x19c)](),_0x4520d0=shiftedTime()[_0x20a8fa(0xf3)]();_0x4520d0==0x4&&backupConfigFiles();_0x4520d0==0x0&&rotateLogFiles();_0x2c49ea%0x6==0x0&&triggerAnalytics();_0x2c49ea%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5a97df){const _0xb8d8c8=_0x3ea1f7;logger[_0xb8d8c8(0x222)]('Restore\x20backup\x20file\x20'+_0x5a97df);const _0x2762b1=getBotsWithMode();_0x2762b1[_0xb8d8c8(0x18b)]>0x0?confirmRestore(configbackuppath,_0x5a97df):unzipFile(configbackuppath,_0x5a97df);}async function getBackupFiles(_0xf11549=null){const _0x486f69=_0x3ea1f7;let _0x2163c7=[],_0x4a4a93=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4a4a93[_0x486f69(0x239)]((_0x2c4b12,_0x5e8bfd)=>_0x2c4b12[_0x486f69(0x1e7)]<_0x5e8bfd[_0x486f69(0x1e7)]?0x1:_0x5e8bfd[_0x486f69(0x1e7)]<_0x2c4b12['name']?-0x1:0x0),_0x4a4a93[_0x486f69(0x1c3)](_0xc688c8=>{const _0x420705=_0x486f69;if(!_0xc688c8['isDirectory']()&&_0xc688c8[_0x420705(0x1e7)][_0x420705(0xdc)](_0x420705(0x133))&&_0xc688c8[_0x420705(0x1e7)][_0x420705(0x1e5)](_0x420705(0x1b2))){const _0x438582=formatDate(fs[_0x420705(0x22f)](configbackuppath+_0xc688c8[_0x420705(0x1e7)])['mtime']);_0x2163c7['push']({'name':_0xc688c8[_0x420705(0x1e7)],'mtime':_0x438582});}});if(_0xf11549)io['to'](_0xf11549)[_0x486f69(0xe5)](_0x486f69(0x192),_0x2163c7);else return _0x2163c7;}async function backupConfigFiles(){const _0x2227fa=_0x3ea1f7;await zipFiles('backup-full');const _0x398d93=getCleanTimeStamp();fs[_0x2227fa(0x234)](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x398d93+_0x2227fa(0x1b2)));let _0x3f9679=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3f9679[_0x2227fa(0x239)]((_0x331afe,_0x1d1c56)=>_0x331afe['name']<_0x1d1c56['name']?0x1:_0x1d1c56[_0x2227fa(0x1e7)]<_0x331afe[_0x2227fa(0x1e7)]?-0x1:0x0),_0x3f9679[_0x2227fa(0x18b)]>maxBackups&&fs[_0x2227fa(0x131)](configbackuppath+_0x3f9679[maxBackups][_0x2227fa(0x1e7)]);}function rotateLogFiles(){const _0xe596f5=_0x3ea1f7,_0x1b7eb6=fs[_0xe596f5(0x22f)](logspath+_0xe596f5(0x1dc)),_0x4f7e95=_0x1b7eb6['size']/0x400;if(_0x4f7e95>0x64){let _0x31216f=fs[_0xe596f5(0xd5)](logspath,{'withFileTypes':!![]});_0x31216f[_0xe596f5(0x239)]((_0x49e7d2,_0x3d6cfa)=>_0x49e7d2[_0xe596f5(0x1e7)]<_0x3d6cfa[_0xe596f5(0x1e7)]?0x1:_0x3d6cfa[_0xe596f5(0x1e7)]<_0x49e7d2[_0xe596f5(0x1e7)]?-0x1:0x0),_0x31216f[_0xe596f5(0x1c3)](_0xaaa7ee=>{const _0x2e2539=_0xe596f5;if(_0xaaa7ee[_0x2e2539(0x1e7)]=='output-002.log')fs['copyFileSync'](logspath+_0xaaa7ee[_0x2e2539(0x1e7)],logspath+_0x2e2539(0x211));if(_0xaaa7ee['name']==_0x2e2539(0x279))fs[_0x2e2539(0x234)](logspath+_0xaaa7ee[_0x2e2539(0x1e7)],logspath+'output-002.log');_0xaaa7ee[_0x2e2539(0x1e7)]==_0x2e2539(0x1dc)&&(fs[_0x2e2539(0x234)](logspath+_0xaaa7ee[_0x2e2539(0x1e7)],logspath+_0x2e2539(0x279)),fs[_0x2e2539(0x119)](logspath+_0xaaa7ee[_0x2e2539(0x1e7)],''));});}}async function zipFiles(_0x4298bd){const _0x46d7a9=_0x3ea1f7;let _0x26fced;if(_0x4298bd==_0x46d7a9(0xd9))_0x26fced=logspath;if(_0x4298bd=='backup')_0x26fced=configpath;if(_0x4298bd=='backup-full')_0x26fced=configpath;let _0x150d84=fs[_0x46d7a9(0xd5)](_0x26fced,{'withFileTypes':!![]});const _0x24cd76=new require(_0x46d7a9(0x208))();_0x150d84[_0x46d7a9(0x1c3)](_0x89fe33=>{const _0x2e5cc3=_0x46d7a9;if(!_0x89fe33[_0x2e5cc3(0x15c)]()){let _0x1af34e=fs[_0x2e5cc3(0x1bd)](_0x26fced+_0x89fe33[_0x2e5cc3(0x1e7)]);if(_0x4298bd=='backup'){const _0x2b3ba6=/^bot-[0-9]{3}-config.json$/,_0x1c1fc4=_0x2b3ba6[_0x2e5cc3(0x10e)](_0x89fe33[_0x2e5cc3(0x1e7)]);if(_0x1c1fc4){const _0x342b16=JSON['parse'](_0x1af34e);_0x342b16[_0x2e5cc3(0x1ca)][0x0]&&(_0x342b16['bot'][0x0][_0x2e5cc3(0x206)]='***',_0x342b16[_0x2e5cc3(0x1ca)][0x0][_0x2e5cc3(0x264)]='***'),_0x1af34e=JSON[_0x2e5cc3(0x267)](_0x342b16,null,0x2);}if(_0x89fe33[_0x2e5cc3(0x1e7)]==_0x2e5cc3(0x104)){const _0x2d4294=JSON[_0x2e5cc3(0x251)](_0x1af34e);if(_0x2d4294[_0x2e5cc3(0x291)]['loginRequired'])_0x2d4294['settings'][_0x2e5cc3(0x1e6)]=![];if(_0x2d4294[_0x2e5cc3(0x291)][_0x2e5cc3(0x245)])_0x2d4294[_0x2e5cc3(0x291)][_0x2e5cc3(0x245)]=_0x2e5cc3(0x12e);if(_0x2d4294[_0x2e5cc3(0x291)][_0x2e5cc3(0x142)])_0x2d4294[_0x2e5cc3(0x291)][_0x2e5cc3(0x142)]=_0x2e5cc3(0x12e);if(_0x2d4294[_0x2e5cc3(0x291)][_0x2e5cc3(0x1c8)])_0x2d4294[_0x2e5cc3(0x291)][_0x2e5cc3(0x1c8)]=null;_0x1af34e=JSON[_0x2e5cc3(0x267)](_0x2d4294,null,0x2);}if(_0x89fe33['name']!=_0x2e5cc3(0xf7))_0x24cd76[_0x2e5cc3(0x1c6)](_0x89fe33[_0x2e5cc3(0x1e7)],_0x1af34e);}else _0x24cd76[_0x2e5cc3(0x1c6)](_0x89fe33['name'],_0x1af34e);}});const _0x5e02d9=_0x24cd76['generate']({'base64':![],'compression':_0x46d7a9(0xfb)});fs[_0x46d7a9(0x119)](zippath+(_0x4298bd+_0x46d7a9(0x1b2)),_0x5e02d9,'binary');}async function unzipFile(_0x3f2951,_0x458ce9){const _0x12964c=_0x3ea1f7;fs[_0x12964c(0xd5)](configpath,{'withFileTypes':!![]})[_0x12964c(0x1c3)](_0x233df9=>{const _0x8bd95c=_0x12964c;if(!_0x233df9[_0x8bd95c(0x15c)]())fs[_0x8bd95c(0x17b)](configpath+_0x233df9[_0x8bd95c(0x1e7)]);});const _0x238492=fs[_0x12964c(0x1bd)](_0x3f2951+_0x458ce9,'binary'),_0x39136e=new require(_0x12964c(0x208))(_0x238492,{'base64':![],'checkCRC32':!![]});Object[_0x12964c(0x161)](_0x39136e[_0x12964c(0x1d2)])['forEach'](_0x3a1542=>{const _0x100eec=_0x12964c,_0x46404f=_0x39136e[_0x100eec(0x1d2)][_0x3a1542];fs['writeFileSync'](configpath+_0x46404f['name'],_0x46404f['_data']);}),fs[_0x12964c(0xd5)](temppath,{'withFileTypes':!![]})['forEach'](_0xdaa670=>{const _0x5c4a9d=_0x12964c;if(!_0xdaa670[_0x5c4a9d(0x15c)]())fs[_0x5c4a9d(0x17b)](temppath+_0xdaa670[_0x5c4a9d(0x1e7)]);}),logger[_0x12964c(0x222)](_0x12964c(0x110)),process[_0x12964c(0x185)]({'restore':!![]},_0x4510ae=>{});}async function getPublicIp(){const _0x185be0=_0x3ea1f7;try{const _0x6b96cb=await axios[_0x185be0(0x263)](_0x185be0(0x179));publicip=_0x6b96cb[_0x185be0(0x1e2)]['ip'];}catch(_0x269780){}}async function triggerAnalytics(){const _0x5b6761=_0x3ea1f7;if(!publicip)await getPublicIp();const _0x3061dc=getBotsWithMode();let _0x1abef0=0x0;_0x3061dc['forEach'](_0x4655a6=>{const _0x3f9282=_0x17b4;if(_0x4655a6[_0x3f9282(0x1fa)]===_0x3f9282(0x1cc))_0x1abef0++;});const _0x5c6921=getBotExchanges();mixpanel[_0x5b6761(0x204)](_0x5b6761(0x173),{'distinct_id':settings[_0x5b6761(0x1e1)],'ip':publicip,'version':serverversion,'numbots':_0x3061dc[_0x5b6761(0x18b)],'numbotsenabled':_0x1abef0,'exchanges':_0x5c6921});}async function getMessages(){const _0x337b4e=_0x3ea1f7,_0xbe2cc6=_0x337b4e(0x24a),_0x5609bb=new GraphQLClient(_0xbe2cc6),_0x1a7ae9={'authorization':_0x337b4e(0x112)},_0x3c40a5=serverversion[_0x337b4e(0x14d)]('.'),_0x3be922=_0x3c40a5[0x0]+'.'+_0x3c40a5[0x1],_0x5ba3b0=Math[_0x337b4e(0x25d)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x5b2f40={'last':parseInt(_0x5ba3b0),'bbm':_0x3be922},_0x2180fe=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x36aa19;try{_0x36aa19=await _0x5609bb[_0x337b4e(0x124)](_0x2180fe,_0x5b2f40,_0x1a7ae9);}catch(_0x313a5e){}if(_0x36aa19&&_0x36aa19[_0x337b4e(0x1a3)]){let _0x3d532e=settings[_0x337b4e(0x202)];newMessages=[];for(const _0x434cc5 of _0x36aa19[_0x337b4e(0x1a3)]){newMessages[_0x337b4e(0x1f1)](_0x434cc5);if(_0x434cc5[_0x337b4e(0x1f0)])updateSetting('latestversion',_0x434cc5[_0x337b4e(0x1f0)]);let _0x52c412=_0x434cc5[_0x337b4e(0x1f0)]?serverversion>=_0x434cc5['bbvNew']:![];if(!_0x52c412&&_0x434cc5['number']>_0x3d532e){if(_0x434cc5[_0x337b4e(0x224)]==='any'||serverversion[_0x337b4e(0xdc)](_0x434cc5[_0x337b4e(0x224)])){let _0x40271c=''+_0x434cc5['title']+'\x0a\x0a'+_0x434cc5[_0x337b4e(0x1c4)];const _0x17600a=await sendTelegramMsg(toTelegramMarkdown(_0x40271c),_0x337b4e(0x12b));if(_0x17600a)_0x3d532e=_0x434cc5[_0x337b4e(0x184)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x337b4e(0x202),_0x3d532e),emitMessages();}}function emitMessages(){const _0x151d92=_0x3ea1f7,_0x2e55b4=settings[_0x151d92(0x246)];let _0x32fa99=[];newMessages[_0x151d92(0x1c3)](_0xf0e8a5=>{const _0x147fc6=_0x151d92;_0xf0e8a5[_0x147fc6(0x184)]>_0x2e55b4&&_0x32fa99[_0x147fc6(0x1f1)](_0xf0e8a5);}),_0x32fa99['length']>0x0&&getAllClients()[_0x151d92(0x1c3)](_0xeb2754=>{const _0x4771af=_0x151d92;getSocket(_0xeb2754['id'])[_0x4771af(0xe5)](_0x4771af(0x1c4),_0x32fa99);});}function confirmMessage(_0x449d2d){const _0xe2479=_0x3ea1f7;updateSetting(_0xe2479(0x246),Number(_0x449d2d));}function isNewerVersion(_0x22bdce,_0x4c7112){const _0x35fef2=_0x3ea1f7,_0x437a97=_0x4c7112['split']('.'),_0x52a66e=_0x22bdce[_0x35fef2(0x14d)]('.');for(var _0xbb138f=0x0;_0xbb138f<_0x52a66e[_0x35fef2(0x18b)];_0xbb138f++){const _0x4ae82d=~~_0x52a66e[_0xbb138f],_0x5cea19=~~_0x437a97[_0xbb138f];if(_0x4ae82d>_0x5cea19)return!![];if(_0x4ae82d<_0x5cea19)return![];}return![];}function toTelegramMarkdown(_0x1968af){const _0x2bdc31=_0x3ea1f7,_0x2a82df=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x267d0b=/\*{2}(.+?)\*{2}/gim;return _0x1968af=_0x1968af[_0x2bdc31(0x190)](_0x2a82df,'$1_$2_$3')[_0x2bdc31(0x190)](_0x267d0b,_0x2bdc31(0x188)),_0x1968af;}async function validateConfigFile(){const _0x52d0eb=_0x3ea1f7,_0x34dc4d=dbConfig[_0x52d0eb(0x263)](_0x52d0eb(0x1f6))[_0x52d0eb(0x11e)](_0x52d0eb(0x270))[_0x52d0eb(0x196)]()||[];if(_0x34dc4d['length']==0x0){let _0x176a05=0x0,_0x9d1629=[];const _0x4e05b4=/^bot-([0-9]{3})-config.json$/,_0x5b9210=fs[_0x52d0eb(0xd5)](configpath);_0x5b9210[_0x52d0eb(0x1c3)](_0x1bb425=>{const _0x3ff867=_0x52d0eb,_0x35487f=_0x4e05b4[_0x3ff867(0x201)](_0x1bb425);if(_0x35487f){const _0x258cc9=_0x35487f[0x1];let _0x110723=getBotAttributes(_0x258cc9);_0x9d1629[_0x3ff867(0x1f1)]({'botID':_0x258cc9,'botname':_0x110723[_0x3ff867(0x254)],'status':_0x3ff867(0x12d),'live':_0x3ff867(0x18a)}),_0x176a05++;}}),_0x176a05!=0x0&&(dbConfig['get']('bots')[_0x52d0eb(0x23e)](_0x9d1629)[_0x52d0eb(0xd3)](),config=_0x9d1629,restoredConfigFile=_0x176a05);}}async function restoreConfigNotify(_0x2c64ce){const _0x490505=_0x3ea1f7;let _0x40acad;if(restoredConfigFile==0x1)_0x40acad='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x40acad=_0x490505(0x14a);if(_0x2c64ce)io['to'](_0x490505(0x26e))['emit'](_0x490505(0x1e8),_0x40acad);else{logger[_0x490505(0xe2)]('-----------------------------------------------------------------------------------'),logger[_0x490505(0xe2)](_0x40acad),logger[_0x490505(0xe2)](_0x490505(0x17a)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x490505(0x169)]!=_0x490505(0x19b))tgBot[_0x490505(0x152)](settings[_0x490505(0x1c8)],'Bot\x20Mgr\x20>\x20'+_0x40acad)[_0x490505(0x25b)](_0x553308=>{telegramError(_0x553308);});}}function validateCredentials(_0xe7270b,_0x38660b){const _0x3dacda=_0x3ea1f7;if(_0xe7270b[_0x3dacda(0x1aa)]==settings[_0x3dacda(0x249)]&&bcrypt[_0x3dacda(0x132)](_0xe7270b[_0x3dacda(0x194)],settings[_0x3dacda(0x245)])){if(settings[_0x3dacda(0x28d)])return{'allow':![],'reason':_0x3dacda(0x20f),'token':null};else{const _0x2848f2=generateLoginToken(_0x38660b);return{'allow':!![],'reason':_0x3dacda(0x1f3),'token':_0x2848f2};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0xde448c){const _0x2b42d6=generateLoginToken(_0xde448c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2b42d6};}function validateAccess(_0x11d220,_0x592465,_0x532b5c){const _0x4f005c=_0x3ea1f7,_0x296011=_0x532b5c?_0x532b5c:devices[_0x592465]['ip'];let _0x3fa240;const _0x4f945d=_0x4caa04=>{const _0x12a50d=_0x17b4;if(settings[_0x12a50d(0x1e6)]){if(settings[_0x12a50d(0x28d)]){if(telegram2FaApproved(_0x592465)){const _0x5186dc=generateLoginToken(_0x592465);return{'allow':!![],'reason':_0x12a50d(0x138),'token':_0x5186dc};}else return{'allow':![],'reason':_0x12a50d(0xf5),'token':null};}else return _0x3fa240=validToken(_0x4caa04,_0x592465),_0x3fa240[_0x12a50d(0x1a0)](_0x12a50d(0x23a))?{'allow':!![],'reason':_0x12a50d(0xdd),'token':_0x4caa04}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x12a50d(0x1cf),'token':null};};if(settings[_0x4f005c(0x125)]){let _0x4715d8=[...settings[_0x4f005c(0x12a)],_0x4f005c(0x200),_0x4f005c(0x117),'127.0.0.1'];if(_0x4715d8['includes'](_0x296011))return _0x4f945d(_0x11d220);else{_0x3fa240=validToken(_0x11d220,_0x592465);if(_0x3fa240['hasOwnProperty'](_0x4f005c(0x23a)))return _0x4f945d(_0x11d220);else{if(telegramIpApproved(_0x592465)){const _0x169c68=generateToken(_0x592465);return _0x3fa240=_0x4f945d(_0x11d220),_0x3fa240[_0x4f005c(0x1f5)]?{'allow':!![],'reason':_0x4f005c(0x1ef),'token':_0x169c68}:_0x3fa240;}else return settings[_0x4f005c(0x1cb)]?{'allow':![],'reason':_0x4f005c(0xe1),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4f945d(_0x11d220);}function timelyDecrypt(_0x126bf0,_0x4efd90=!![]){const _0x5e1cbb=_0x3ea1f7;if(_0x126bf0)try{const _0x5ca762=crypt[_0x5e1cbb(0x1c5)](secure['privateKey'],_0x126bf0)[_0x5e1cbb(0x1c4)],_0x55a601=_0x5ca762[_0x5e1cbb(0x14d)]('@')[0x0],_0x31aa21=_0x5ca762['split']('@')[0x1],_0x5bd020=new Date()['getTime']();if(_0x4efd90){if(_0x5bd020-_0x31aa21<maxSecretAge*0x3e8)return _0x55a601;else return![];}else return _0x55a601;}catch(_0x5456e6){return![];}else return![];}const validToken=(_0x162d7b,_0x260575)=>{const _0x169c65=_0x3ea1f7,_0x5e1a4a=devices[_0x260575]['ip'];if(!_0x162d7b)return{'error':_0x169c65(0x144)};for(let _0x514a18 of blacklist){if(_0x514a18[_0x169c65(0x1bf)]==_0x162d7b)return{'error':_0x169c65(0xd2)};}let _0x549b56;try{_0x549b56=jwt[_0x169c65(0x218)](_0x162d7b,secure[_0x169c65(0x1ed)]+_0x260575);}catch{return{'error':_0x169c65(0xfd)};}if(!_0x549b56['hasOwnProperty']('clientip')&&!_0x549b56['hasOwnProperty'](_0x169c65(0x1aa))||!_0x549b56[_0x169c65(0x1a0)]('exp'))return{'error':_0x169c65(0x10f)};if(!_0x549b56[_0x169c65(0x1a0)](_0x169c65(0x1aa))&&_0x549b56[_0x169c65(0x1a0)](_0x169c65(0x1c1))){const {clientip:_0x48fa18}=_0x549b56;return _0x5e1a4a==_0x48fa18?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x549b56[_0x169c65(0x1a0)]('username')&&_0x549b56[_0x169c65(0x1a0)](_0x169c65(0x1c1))){const {username:_0x2d126e,clientip:_0x5be1ab}=_0x549b56;return settings[_0x169c65(0x249)]==_0x2d126e&&_0x5e1a4a==_0x5be1ab?{'success':_0x169c65(0x10b)}:{'error':_0x169c65(0x187)};}}},generateLoginToken=_0x49ae98=>{const _0x1023cd=_0x3ea1f7;if(_0x49ae98){const _0x25c8e5=devices[_0x49ae98]['ip'];return jwt[_0x1023cd(0x12f)]({'username':settings[_0x1023cd(0x249)],'clientip':_0x25c8e5},secure[_0x1023cd(0x1ed)]+_0x49ae98,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xab62e=>{const _0x3fe9cf=_0x3ea1f7;if(_0xab62e){const _0xfaaf43=devices[_0xab62e]['ip'];return jwt['sign']({'clientip':_0xfaaf43},secure[_0x3fe9cf(0x1ed)]+_0xab62e,{'expiresIn':devices[_0xab62e][_0x3fe9cf(0x175)][_0x3fe9cf(0x168)]*0x3c});}else return![];},telegramIpApproved=_0x1e0d17=>{const _0x3250bc=_0x3ea1f7;let _0x3a9906=![];return devices[_0x1e0d17]['telegramIpApproval']&&devices[_0x1e0d17][_0x3250bc(0x175)][_0x3250bc(0x168)]!=_0x3250bc(0xd0)&&(_0x3a9906=devices[_0x1e0d17][_0x3250bc(0x175)]['clientip']==devices[_0x1e0d17]['ip']&&new Date()[_0x3250bc(0x20e)]()-devices[_0x1e0d17][_0x3250bc(0x175)][_0x3250bc(0x21b)]<devices[_0x1e0d17][_0x3250bc(0x175)][_0x3250bc(0x168)]*0x3c*0x3e8),_0x3a9906;},telegram2FaApproved=_0x5c4cd3=>{const _0x108e8d=_0x3ea1f7;let _0x354641=![];return devices[_0x5c4cd3]['telegram2FaApproval']&&devices[_0x5c4cd3][_0x108e8d(0x1cd)][_0x108e8d(0x168)]!=_0x108e8d(0xd0)&&(_0x354641=devices[_0x5c4cd3]['telegram2FaApproval'][_0x108e8d(0x1c1)]==devices[_0x5c4cd3]['ip']&&new Date()['getTime']()-devices[_0x5c4cd3][_0x108e8d(0x1cd)][_0x108e8d(0x21b)]<devices[_0x5c4cd3][_0x108e8d(0x1cd)][_0x108e8d(0x168)]*0x3c*0x3e8),_0x354641;},normalizeIP=_0x4fecc7=>{const _0x55cd90=_0x3ea1f7;let _0x7695a=null,_0x2ca94b=null;if(ipaddr[_0x55cd90(0x17f)](_0x4fecc7)){const _0x33d78e=ipaddr[_0x55cd90(0x251)](_0x4fecc7);_0x33d78e[_0x55cd90(0x286)]()===_0x55cd90(0x247)?(_0x33d78e[_0x55cd90(0x253)]()&&(_0x7695a=_0x33d78e[_0x55cd90(0x1b3)]()[_0x55cd90(0xf8)]()),_0x2ca94b=_0x33d78e['toString']()):(_0x7695a=_0x33d78e[_0x55cd90(0xf8)](),_0x2ca94b=_0x33d78e['toIPv4MappedAddress']()[_0x55cd90(0xf8)]());}return{'show':_0x7695a?_0x7695a:_0x2ca94b,'store':_0x2ca94b};};function formatDate(_0x4a7eda){const _0x154c6c=_0x3ea1f7;return _0x4a7eda['getFullYear']()+'/'+(_0x4a7eda[_0x154c6c(0x225)]()+0x1)[_0x154c6c(0xf8)]()[_0x154c6c(0x15e)](0x2,'0')+'/'+_0x4a7eda[_0x154c6c(0xed)]()[_0x154c6c(0xf8)]()['padStart'](0x2,'0')+'\x20'+_0x4a7eda[_0x154c6c(0xf3)]()[_0x154c6c(0xf8)]()[_0x154c6c(0x15e)](0x2,'0')+':'+_0x4a7eda[_0x154c6c(0x151)]()[_0x154c6c(0xf8)]()[_0x154c6c(0x15e)](0x2,'0')+':'+_0x4a7eda['getSeconds']()[_0x154c6c(0xf8)]()[_0x154c6c(0x15e)](0x2,'0');}function sleep(_0xa3f3fc){return new Promise(_0x145378=>setTimeout(_0x145378,_0xa3f3fc));}