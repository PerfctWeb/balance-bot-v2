function _0x6c6a(){const _0xe4adc=['decrypt','\x20|\x20client:\x20...','auto','build2','createWriteStream','once','params','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Unauthorized\x20attempt\x20to\x20log\x20out','config/','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','3000','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','keys','update-bot','inherit','defaults','settings.','temporary\x20access\x20rejected','-events.json','restore-backup-file','sortBy','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','text','/:bot/configuration','api-eu.mixpanel.com','join','index.html','storeFiat','***','logged\x20out','settings','warning','store-headless','path','sha256','Restarting\x20Bot\x20','pidRefreshToken','reply','verify','handshake','15\x20min','port','help','event','success','tempaccess_30_','userid','pidExpireLogin','4780944Kwuagm','_data','use','store-configuration','\x20to\x20','kind','bbPassword',')\x20\x20\x20|\x20Bot\x20','reason','telegramEnabled','set','toggle','button','includes','toIPv4MappedAddress','\x20only\x0a','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','backup/','logs','login\x20required','9dTHCmh','copyFileSync','127.0.0.1','latestversion','remoteAddress','express-fileupload','sendPortfolioTelegram','replace','uuid-random','getFullYear','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','#RES#\x20if\x20running\x20on\x20server','randomFillSync','off','timeshift','staging','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','login\x20not\x20required','production','add-bot','<b>Balance\x20Bot\x20Status:</b>\x0a','binary','getUTCHours','\x1b[31m','isDirectory','getHours','value','place-order','config_orders','tempaccess_reject_','padStart','connected','listen','bot-','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Error\x20while\x20deleting\x20config\x20files:\x20','\x20|\x20','/upload-backup','length','status','statSync','hybrid-crypto-js','emit','delete-bot','Starting\x20Balance\x20Bot\x20update','*$1*','endsWith','lastmsgtelegram','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','2FA\x20login\x20required','Bot\x20','rmSync','/download/:type','mtime','output-001.log','createServer','updatebotmanager','graphql-request','address\x20already\x20in\x20use','update-bb','secret','::ffff:127.0.0.1','clientip','type','lowdb','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Starting\x20(','forEach','ETH','-performance.json','function','command','output-003.log','family','botmanager','backup-full.zip','2445940URlFwa','11XntUCY','inlineKeyboard','filter','************','jsonwebtoken','launch','version','host','::1','alerts','marketcapApi','post','sockets','test','\x1b[35m','started','Invalid\x20IP\x20address','disabled','logout','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','init','-----------------------------------------------------------------------------------','showname','bb-secure.json','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','string','exec','initclient','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','compareSync','/start','timestamp','get','2574504KHTkAV','config_all','apiPassword','<b>Telegram\x20Bot\x20Status:</b>\x0a','conn','bb-config.json','Error\x20details:','SIGTERM','/metrics\x20-\x20show\x20bot\x20performance\x0a','server','write','simple','stop','callback','1417435ctsPnW','getDate','editMessageReplyMarkup','invalid\x20credentials','headless','secure','Telegram\x20error:','Unauthorized\x20attempt\x20to\x20update\x20settings',',\x20must\x20be\x20a\x204\x20digit\x20number','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','getMonth','resetHistory','match','debug','sendMetricsTelegram','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Ok,\x20will\x20send\x20alert\x20notifications\x20only','store-settings','CoinMarketCap\x20API\x20key\x20validated','isValid','parse','resetpw_no','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','whitelist','status\x20code\x20401','action','generate','find','catch','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','headers','\x1b[36m','HTML','login','\x20(1)','/:bot','Invalid\x20authentication\x20token\x20(1)','getMinutes','bbUsername','Yes','expiry','(((.+)+)+)+$','2FA\x20required','Notifications\x20disabled\x0a','orders','Orders','Error\x20removing\x20old\x20backup\x20files:','download','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Error:\x20Invalid\x20argument\x20','log','uuid','/output-000.log','token','name','error','sendMessage','constructor','getTime','messages','get-messages','yes','socket','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','reinstall-bb','telegramIpApproval','User\x20has\x20been\x20validated','new-disabled','apiKey',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','referer','argv','backup','version.json','Notifications\x20enabled','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','portfolio_','whitelistEnabled','reject','Unauthorized\x20attempt\x20to\x20get\x20messages','f2aRequired','RSA-OAEP','2FA','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','ipaddr.js','\x20|\x20user:\x20...','randomBytes','Disabled\x20Bot\x20','login\x20token\x20generated','close','emitHistory','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','private','hex','address','sort','lastmsgemitted','Invalid\x20authentication\x20token\x20(2)','disable','date-fns','loginRequired','bots','files','any','cancel-loading','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Enabled\x20Bot\x20','Bot\x20Mgr\x20>\x20','get-portfolio','Temporary\x20access\x20rejected','Notifications\x20enabled\x0a','output-002.log','telegramToken','Deleted\x20Bot\x20','store','exit','from','update','user','temporary\x20access\x20timeout','portfolio','-config.json','resetpw_yes','existsSync','notification','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Access\x20enabled\x20for\x20','backup-full','6b67f3d61ee94b8f5c80b4affef4c4d9','uncaughtException','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','backup-files','node','sign','split','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','12zwkjgG','isIPv4MappedAddress','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','update_yes','kill','stringify','config','5\x20min','backup-full@','all','/update\x20-\x20update\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','build','assign','message','alias','Alerts','bb-settings.json','storeConfiguration','botname','request','getSeconds','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Login\x20rejected','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','new','All\x20bots\x20running\x20right\x20now','auth','Unauthorized\x20login\x20attempt\x20(timeout)','#RES#\x20',':\x20Bot\x20Mgr\x20>\x20','reset-password','2FA\x20login\x20rejected','readdirSync','cancelLoading','get-backup-files','stopped','bbvReceive','update_no','child_process','manual','/disable\x20-\x20disable\x20notifications\x0a','Password\x20reset\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20portfolio','password','7NHoJwL','restart_','Session\x20expired\x20for\x20user\x20...','Password\x20has\x20been\x20reset\x20to:\x20','toString','apiSecret','args','Failed\x20to\x20download\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','node-zip','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','output-000.log','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Your\x20installation\x20is\x20already\x20up\x20to\x20date','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','telegramEvents','11668712KGYOqi','static','reload','Restore\x20process\x20confirmed','/help\x20-\x20show\x20available\x20commands\x0a','Setting\x20access:\x20','number','publicKey','socket.io','privateKey','All','restart','temporary\x20access\x20not\x20allowed','writeFileSync','enabled','telegraf','toggle-bot-mode','format','then','send','Markdown','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','ipc','|@|','bbvNew','internal','mixpanel','\x1b[0m','bot','Ok,\x20will\x20send\x20order\x20notifications\x20only','login2fa_reject_','username','=>\x20Go\x20to\x20#CYA#http://','DEFLATE','exp','size','remove','IPv4','sendFile','logs/','SIGINT','onepagemode','telegramUsername','file','mode','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','104546zFujvX','Backup\x20file\x20uploaded','tkn','No\x20bots\x20running\x20right\x20now','reinstall_yes','/:bot/history','Idling\x20(','http','zip/','hashSync','confirm-message','lowdb/adapters/FileSync','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','removeAllListeners','(staging)','botID','Backup\x20file\x20unzipped\x20and\x20stored','get-starting-balances','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','running','chat','slice','All\x20bots','range','Login\x20accepted','util','config_alerts','readFileSync','telegramChatId','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','login\x20token\x20valid','-results.json','Logged\x20out\x20user\x20...','Token\x20blacklisted','crypto','reinstall','disconnect','Unauthorized\x20attempt\x20to\x20delete\x20bot','allow',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Node.js\x20v','toIPv4Address','30\x20min','.zip','Unauthorized\x20attempt\x20to\x20show\x20configuration','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Restore\x20process\x20aborted','Unauthorized\x20attempt\x20to\x20add\x20bot','Logged\x20in\x20user\x20...','access','/:bot/portfolio','temp/','live','blacklist','push','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','get-logs','telegram','temporary\x20token\x20generated','\x20mode','Restoring\x20bot(s)\x20from\x20backup','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20download\x20','unlinkSync','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',')\x20|\x20Bot\x20','Telegraf\x20error:','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20confirm\x20message','#RES#\x20if\x20running\x20locally\x0a','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','hasOwnProperty','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','search','axios','File\x20uploaded','showConfig','on_','3407064aIijOl','startsWith','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegram2FaApproval','entries','order','Crypt','\x20>\x20','/on\x20-\x20start\x20bot(s)\x0a','mkdirSync','[ip-address]','full'];_0x6c6a=function(){return _0xe4adc;};return _0x6c6a();}const _0x4c9701=_0x1bd5;(function(_0x4fa8fa,_0x52ca4b){const _0x2e4325=_0x1bd5,_0xb0ca2c=_0x4fa8fa();while(!![]){try{const _0x136718=parseInt(_0x2e4325(0x23a))/0x1*(-parseInt(_0x2e4325(0x14d))/0x2)+parseInt(_0x2e4325(0x25b))/0x3+-parseInt(_0x2e4325(0xe0))/0x4*(parseInt(_0x2e4325(0x269))/0x5)+parseInt(_0x2e4325(0x1d9))/0x6+parseInt(_0x2e4325(0x10e))/0x7*(-parseInt(_0x2e4325(0x19c))/0x8)+-parseInt(_0x2e4325(0x1ed))/0x9*(parseInt(_0x2e4325(0x239))/0xa)+parseInt(_0x2e4325(0x11f))/0xb;if(_0x136718===_0x52ca4b)break;else _0xb0ca2c['push'](_0xb0ca2c['shift']());}catch(_0x345088){_0xb0ca2c['push'](_0xb0ca2c['shift']());}}}(_0x6c6a,0x97543));const _0x3bdd9b=function(){let _0x41a928=!![];return function(_0x420ff0,_0x1c831f){const _0x155b32=_0x41a928?function(){if(_0x1c831f){const _0x222179=_0x1c831f['apply'](_0x420ff0,arguments);return _0x1c831f=null,_0x222179;}}:function(){};return _0x41a928=![],_0x155b32;};}(),_0x971153=_0x3bdd9b(this,function(){const _0x41be46=_0x1bd5;return _0x971153['toString']()['search'](_0x41be46(0x81))['toString']()[_0x41be46(0x91)](_0x971153)[_0x41be46(0x197)](_0x41be46(0x81));});_0x971153();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x4c9701(0x108)),fs=require('fs'),fns=require(_0x4c9701(0xbb)),low=require(_0x4c9701(0x22d)),FileSync=require(_0x4c9701(0x158)),path=require(_0x4c9701(0x1ca)),crypto=require(_0x4c9701(0x170)),Crypt=require(_0x4c9701(0x216))[_0x4c9701(0x1a2)],RSA=require(_0x4c9701(0x216))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x4c9701(0x23e)),ipaddr=require(_0x4c9701(0xac)),argv=require('yargs/yargs')(process[_0x4c9701(0x9f)]['slice'](0x2))[_0x4c9701(0x9f)],uuidRandom=require(_0x4c9701(0x1f5)),{Telegraf,Markup}=require(_0x4c9701(0x12e)),Mixpanel=require(_0x4c9701(0x139)),axios=require(_0x4c9701(0x198)),{GraphQLClient,gql}=require(_0x4c9701(0x226)),util=require(_0x4c9701(0x166)),fileUpload=require(_0x4c9701(0x1f2)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x4c9701(0x1b3),pattern=/^[0-9]{2,4}$/;!pattern[_0x4c9701(0x247)](PORT)&&(console[_0x4c9701(0x8a)](_0x4c9701(0x89)+PORT+_0x4c9701(0x271)),process[_0x4c9701(0xcb)](0x1));const HOST=argv[_0x4c9701(0x241)]||null,userID=argv[_0x4c9701(0xce)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x4c9701(0xdc)];let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0x4c9701(0x260),settingsfile=_0x4c9701(0xf2),securefile=_0x4c9701(0x251),environment=require('./'+bbpath2+_0x4c9701(0xa1))['environment']||_0x4c9701(0x1ff),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4c9701(0xd3)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x4c9701(0x1b1)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x4c9701(0x1ea),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x4c9701(0x146),zippath=userID?bbpath+_0x4c9701(0x155)+userID+'/':bbpath+_0x4c9701(0x155),loggerfile=fs[_0x4c9701(0x1ac)](logspath+_0x4c9701(0x8c),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x4c9701(0x181);!fs[_0x4c9701(0xd3)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x4c9701(0xd3)](configbackuppath)&&fs[_0x4c9701(0x1a5)](configbackuppath);!fs[_0x4c9701(0xd3)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs[_0x4c9701(0x1a5)](zippath);!fs['existsSync'](temppath)&&fs[_0x4c9701(0x1a5)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4c9701(0x1b8)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x4c9701(0x265)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x4c9701(0x265)]();let crypt=new Crypt({'md':_0x4c9701(0x1cb),'rsaStandard':_0x4c9701(0xa9)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4c9701(0x24e)](_0x4c9701(0xd8),{'host':_0x4c9701(0x1c1)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4c9701(0xc8)]&&(settings[_0x4c9701(0xc8)]!=''&&settings[_0x4c9701(0xc8)]!=_0x4c9701(0x1c5))&&settings[_0x4c9701(0x149)]&&settings[_0x4c9701(0x149)]!='')initTelegram();const parseColor=(_0x65aef9,_0x4fca6b)=>{const _0x362f0d=_0x4c9701,_0x321def=/#[A-Z]{3}#/g;if(typeof _0x65aef9==_0x362f0d(0x253)){!_0x4fca6b?_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](_0x321def,''):(_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](/#BLU#/g,'\x1b[34m'),_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](/#RED#/g,_0x362f0d(0x204)),_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](/#YEL#/g,'\x1b[33m'),_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](/#MAG#/g,_0x362f0d(0x248)),_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](/#CYA#/g,_0x362f0d(0x288)),_0x65aef9=_0x65aef9[_0x362f0d(0x1f4)](/#RES#/g,_0x362f0d(0x13a)));;}return _0x65aef9;},logger={'screen':_0x147bfa=>{const _0x3eef69=_0x4c9701;console[_0x3eef69(0x8a)](parseColor(_0x147bfa,!![]));},'simple':_0x5d1c07=>{const _0x26caac=_0x4c9701;console[_0x26caac(0x8a)](parseColor(_0x5d1c07,!![])),loggerfile[_0x26caac(0x265)](util[_0x26caac(0x130)](parseColor(_0x5d1c07,![]))+'\x0a');},'full':async _0x1ab49a=>{const _0x3c2759=_0x4c9701,_0x33b241=getTimeStamp()+_0x3c2759(0xff)+_0x1ab49a;console['log'](parseColor(_0x33b241,!![])),loggerfile['write'](util[_0x3c2759(0x130)](parseColor(_0x33b241,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x3c2759(0x11e)]!=_0x3c2759(0x84))await sendTelegram(settings['telegramChatId'],_0x3c2759(0xc3)+parseColor(_0x1ab49a,![]));},'debug':async(_0x3f51f4,_0x244e01='')=>{const _0x5cb893=_0x4c9701,_0x3be46b=getTimeStamp()+_0x5cb893(0x9d)+_0x3f51f4;if(debugging)console[_0x5cb893(0x8a)](parseColor(_0x3be46b,!![]));loggerfile[_0x5cb893(0x265)](util[_0x5cb893(0x130)](parseColor(_0x3be46b,![]))+'\x0a');if(_0x244e01){if(debugging)console[_0x5cb893(0x8a)](_0x244e01);loggerfile[_0x5cb893(0x265)](util['format'](_0x244e01)+'\x0a');}}};let terminating=![];process['on'](_0x4c9701(0xd9),function(_0x2c1c9e){const _0x536810=_0x4c9701;_0x2c1c9e[_0x536810(0x112)]()[_0x536810(0x1e6)](_0x536810(0x227))?(logger[_0x536810(0x266)](_0x536810(0xdf)+_0x2c1c9e[_0x536810(0x1d2)]+'#RES#'),process[_0x536810(0x132)]({'terminate':!![]},_0xdbc199=>{})):logger['simple'](_0x2c1c9e);}),process['on'](_0x4c9701(0xcb),()=>{const _0x50ea6a=_0x4c9701;stopAllBots(),process[_0x50ea6a(0xcb)](0x0);}),process['on'](_0x4c9701(0x262),()=>{const _0x5e8bcc=_0x4c9701;stopAllBots(),process[_0x5e8bcc(0xcb)](0x0);}),process['on']('SIGINT',()=>{const _0xeab975=_0x4c9701;stopAllBots(),process[_0xeab975(0xcb)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4c9701(0xa1))[_0x4c9701(0x240)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x4c9701(0x154))[_0x4c9701(0x224)](app);app[_0x4c9701(0x1db)](fileUpload({'useTempFiles':!![]})),app[_0x4c9701(0x25a)](_0x4c9701(0x221),async(_0xa2982f,_0x1b2877)=>{const _0x4258fb=_0x4c9701,_0x3e5632=_0xa2982f[_0x4258fb(0x1ae)][_0x4258fb(0x22c)],_0x135d2e=getClientsWithBotID('botmanager'),_0x131b39=_0xa2982f[_0x4258fb(0x287)][_0x4258fb(0x8b)],_0x970d5f=timelyDecrypt(_0x131b39,![]),_0x4a9ff0=_0x135d2e[_0x4258fb(0x284)](_0x5c9580=>_0x5c9580['uuid']==_0x970d5f);if(_0x4a9ff0){const _0x412b10=normalizeIP(_0xa2982f[_0x4258fb(0x96)][_0x4258fb(0x1f1)])[_0x4258fb(0xca)],_0x3cc333=_0xa2982f['headers']['tkn'];if(validateAccess(_0x3cc333,_0x970d5f,_0x412b10)[_0x4258fb(0x174)])_0x3e5632==_0x4258fb(0xa0)&&await backupConfigFiles(),await zipFiles(_0x3e5632),_0x1b2877[_0x4258fb(0x87)](zippath+(_0x3e5632+_0x4258fb(0x179)),_0x145fd0=>{const _0x42cfee=_0x4258fb;_0x145fd0&&(logger[_0x42cfee(0x1a7)](_0x42cfee(0x115)+_0x3e5632),logger[_0x42cfee(0x266)](_0x145fd0));});else logger[_0x4258fb(0x1a7)](_0x4258fb(0x18c)+_0x3e5632+_0x4258fb(0x28b));}else logger[_0x4258fb(0x1a7)](_0x4258fb(0x18c)+_0x3e5632+'\x20(2)');}),app[_0x4c9701(0x245)](_0x4c9701(0x212),async(_0x2312a2,_0x122b56)=>{const _0x15edf9=_0x4c9701,_0x35b631=getClientsWithBotID('botmanager'),_0x32430b=_0x2312a2['headers']['uuid'],_0x328d6f=timelyDecrypt(_0x32430b,![]),_0x2ce80a=_0x35b631[_0x15edf9(0x284)](_0x243bd4=>_0x243bd4['uuid']==_0x328d6f);logger['debug'](_0x15edf9(0x14e));if(_0x2ce80a){const _0x253190=normalizeIP(_0x2312a2[_0x15edf9(0x96)][_0x15edf9(0x1f1)])[_0x15edf9(0xca)],_0x5d1898=_0x2312a2[_0x15edf9(0x287)][_0x15edf9(0x14f)];if(validateAccess(_0x5d1898,_0x328d6f,_0x253190)[_0x15edf9(0x174)]){if(_0x2312a2['files']){const _0x52f4a8=_0x2312a2['files']['backupfile'];await _0x52f4a8['mv'](temppath+_0x52f4a8['name']),_0x122b56['send']({'status':!![],'message':_0x15edf9(0x199)});const _0x3a5b09=getBotsWithMode();_0x3a5b09[_0x15edf9(0x213)]>0x0?confirmRestore(temppath,_0x52f4a8[_0x15edf9(0x8e)]):unzipFile(temppath,_0x52f4a8[_0x15edf9(0x8e)]);}}else logger[_0x15edf9(0x1a7)](_0x15edf9(0xb3));}else logger[_0x15edf9(0x1a7)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x4c9701(0x1db)](express[_0x4c9701(0x120)](path[_0x4c9701(0x1c2)](__dirname,bbpath2,_0x4c9701(0x1ab)))),app[_0x4c9701(0x1db)](express[_0x4c9701(0x120)](path['join'](__dirname,bbpath2,'build'))),app['get']('/',function(_0x4b00b6,_0x3ea277){const _0x193b39=_0x4c9701;_0x3ea277[_0x193b39(0x145)](path['join'](__dirname,bbpath2,_0x193b39(0x1ab),_0x193b39(0x1c3)));}),app[_0x4c9701(0x25a)](_0x4c9701(0x28c),function(_0x4230ab,_0x2ec72a){const _0x502cb8=_0x4c9701;_0x2ec72a['sendFile'](path[_0x502cb8(0x1c2)](__dirname,bbpath2,_0x502cb8(0xed),_0x502cb8(0x1c3)));}),app['get'](_0x4c9701(0x180),(_0x1e5b7e,_0x8f649b)=>{const _0x27373a=_0x4c9701;_0x8f649b[_0x27373a(0x145)](path[_0x27373a(0x1c2)](__dirname,bbpath2,_0x27373a(0xed),'index.html'));}),app[_0x4c9701(0x25a)]('/:bot/performance',(_0x523ad6,_0x1baf66)=>{const _0x3333ec=_0x4c9701;_0x1baf66[_0x3333ec(0x145)](path[_0x3333ec(0x1c2)](__dirname,bbpath2,_0x3333ec(0xed),'index.html'));}),app['get']('/:bot/coins',(_0x333d63,_0x16924a)=>{const _0x5bd8eb=_0x4c9701;_0x16924a[_0x5bd8eb(0x145)](path[_0x5bd8eb(0x1c2)](__dirname,bbpath2,_0x5bd8eb(0xed),_0x5bd8eb(0x1c3)));}),app['get'](_0x4c9701(0x152),(_0x3ddf88,_0x11d8a5)=>{const _0x37b3a0=_0x4c9701;_0x11d8a5[_0x37b3a0(0x145)](path[_0x37b3a0(0x1c2)](__dirname,bbpath2,'build',_0x37b3a0(0x1c3)));}),app[_0x4c9701(0x25a)](_0x4c9701(0x1c0),(_0x58a9c7,_0x4d2512)=>{const _0x359933=_0x4c9701;_0x4d2512['sendFile'](path[_0x359933(0x1c2)](__dirname,bbpath2,_0x359933(0xed),_0x359933(0x1c3)));}),app[_0x4c9701(0x25a)]('/:bot/support',(_0x5eff1f,_0x4b99a2)=>{const _0x30a6f4=_0x4c9701;_0x4b99a2[_0x30a6f4(0x145)](path['join'](__dirname,bbpath2,_0x30a6f4(0xed),_0x30a6f4(0x1c3)));});if(HOST)http[_0x4c9701(0x20d)](PORT,HOST);else http[_0x4c9701(0x20d)](PORT);const io=require(_0x4c9701(0x127))(http,{});init();function _0x1bd5(_0x3005ba,_0x13e657){const _0xaa9889=_0x6c6a();return _0x1bd5=function(_0x971153,_0x3bdd9b){_0x971153=_0x971153-0x7f;let _0x6c6ae=_0xaa9889[_0x971153];return _0x6c6ae;},_0x1bd5(_0x3005ba,_0x13e657);}async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x50c5e4=_0x4c9701;let _0x151cbf=_0x50c5e4(0x1a6);const _0x5be10e=networkInterfaces(),_0x1a630e={};for(const _0x3207e9 of Object['keys'](_0x5be10e)){for(const _0x5e2a17 of _0x5be10e[_0x3207e9]){if((_0x5e2a17[_0x50c5e4(0x236)]==_0x50c5e4(0x144)||_0x5e2a17['family']==0x4)&&!_0x5e2a17[_0x50c5e4(0x138)]){const _0x16a3e9=ipaddr[_0x50c5e4(0x27d)](_0x5e2a17[_0x50c5e4(0xb6)])[_0x50c5e4(0x164)]();_0x16a3e9!=_0x50c5e4(0xb4)&&(!_0x1a630e[_0x3207e9]&&(_0x1a630e[_0x3207e9]=[]),_0x1a630e[_0x3207e9][_0x50c5e4(0x184)](_0x5e2a17[_0x50c5e4(0xb6)]),_0x151cbf=_0x5e2a17[_0x50c5e4(0xb6)]);}}}return{'serverip':_0x151cbf,'netinterfaces':_0x1a630e};}async function startServer(){const _0x14aaaa=_0x4c9701,{serverip:_0x149a52,netinterfaces:_0x463810}=getServerIP();logger[_0x14aaaa(0x266)](''),logger[_0x14aaaa(0x266)](_0x14aaaa(0x24f)),await logger[_0x14aaaa(0x1a7)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x14aaaa(0xfe)+(environment==_0x14aaaa(0x1fc)?_0x14aaaa(0x15b):'')+'\x0a'+(_0x14aaaa(0xab)+PORT+_0x14aaaa(0x193))+(_0x14aaaa(0x13f)+_0x149a52+':'+PORT+_0x14aaaa(0x1f8))),logger[_0x14aaaa(0x266)](_0x14aaaa(0x24f));if(config[_0x14aaaa(0x213)]!=0x0)for(const _0x1f8164 of config){const _0x38c4eb=_0x1f8164[_0x14aaaa(0x14b)]=='auto'?'a':'m';if(_0x1f8164[_0x14aaaa(0x214)]==_0x14aaaa(0x12d)||_0x1f8164[_0x14aaaa(0x214)]==_0x14aaaa(0xfa))await logger[_0x14aaaa(0x1a7)](_0x14aaaa(0x22f)+_0x38c4eb+_0x14aaaa(0x18f)+_0x1f8164[_0x14aaaa(0x15c)]+'\x20|\x20'+_0x1f8164[_0x14aaaa(0xf4)]),startBot([_0x1f8164[_0x14aaaa(0x15c)],userID],{'cwd':bbpath},function(_0x47678e){const _0x2de2e0=_0x14aaaa;if(_0x47678e)logger[_0x2de2e0(0x1a7)](_0x47678e);});else(_0x1f8164[_0x14aaaa(0x214)]==_0x14aaaa(0x24b)||_0x1f8164[_0x14aaaa(0x214)]==_0x14aaaa(0x9b))&&await logger['full'](_0x14aaaa(0x153)+_0x38c4eb+_0x14aaaa(0x1e0)+_0x1f8164[_0x14aaaa(0x15c)]+_0x14aaaa(0x211)+_0x1f8164[_0x14aaaa(0xf4)]);}else!newBot&&logger[_0x14aaaa(0x266)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x14aaaa(0x266)]('-----------------------------------------------------------------------------------'),logger[_0x14aaaa(0x266)](''),await logger[_0x14aaaa(0x276)](_0x14aaaa(0x176)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x463810);}function startSocket(){io['on']('connection',_0x26583d=>{const _0x8f6288=_0x1bd5;let _0x663a18,_0x380b98,_0x3376bd,_0x5cbba3,_0x242f7b;const _0x383ddc=_0x26583d[_0x8f6288(0x1d0)]['headers'][_0x8f6288(0x9e)];_0x380b98=_0x383ddc[_0x8f6288(0x275)](/bot[0-9]{3}/);if(_0x380b98)_0x3376bd=_0x380b98[0x0][_0x8f6288(0x275)](/[0-9]{3}/);if(_0x3376bd)_0x663a18=_0x3376bd[0x0];else _0x663a18='botmanager';const _0x381a40=_0x26583d[_0x8f6288(0x1d0)][_0x8f6288(0xfc)]['encryptedUuid'];if(!_0x381a40)_0x26583d['emit'](_0x8f6288(0x214),{'publicKey':secure[_0x8f6288(0x126)]});else{_0x5cbba3=timelyDecrypt(_0x381a40,![]);if(!_0x5cbba3)_0x26583d['emit'](_0x8f6288(0x214),{'publicKey':secure[_0x8f6288(0x126)]});else{_0x242f7b=normalizeIP(_0x26583d[_0x8f6288(0x25f)]['remoteAddress'])['store'];if(!devices[_0x5cbba3])devices[_0x5cbba3]={'uuid':_0x5cbba3,'access':{'token':null}};devices[_0x5cbba3]['ip']=_0x242f7b;const _0x13b982=addClient(_0x26583d['id'],_0x5cbba3,_0x663a18);setAccess(_0x13b982),emitMessages(),_0x26583d['on'](_0x8f6288(0x28a),_0x25f0c0=>{const _0x2a88e6=_0x8f6288,_0x2d9a59=timelyDecrypt(_0x25f0c0[_0x2a88e6(0x10d)],!![],_0x2a88e6(0x136));if(_0x2d9a59){_0x25f0c0={'username':_0x25f0c0[_0x2a88e6(0x13e)],'password':_0x2d9a59},devices[_0x5cbba3][_0x2a88e6(0x17f)]=validateCredentials(_0x25f0c0,_0x5cbba3);if(devices[_0x5cbba3][_0x2a88e6(0x17f)][_0x2a88e6(0x174)]==![]&&devices[_0x5cbba3][_0x2a88e6(0x17f)][_0x2a88e6(0x1e1)]==_0x2a88e6(0x21e))_0x26583d[_0x2a88e6(0x217)](_0x2a88e6(0x214),{'access':devices[_0x5cbba3]['access']}),loginAccess2FA(_0x5cbba3,_0x242f7b);else{if(devices[_0x5cbba3][_0x2a88e6(0x17f)][_0x2a88e6(0x174)]==![]&&devices[_0x5cbba3][_0x2a88e6(0x17f)]['reason']==_0x2a88e6(0x26c))_0x26583d[_0x2a88e6(0x217)]('status',{'access':devices[_0x5cbba3][_0x2a88e6(0x17f)]});else devices[_0x5cbba3]['access'][_0x2a88e6(0x174)]&&devices[_0x5cbba3][_0x2a88e6(0x17f)][_0x2a88e6(0x1e1)]==_0x2a88e6(0xb0)&&(getClientsWithUuid(_0x5cbba3)[_0x2a88e6(0x230)](_0x785520=>{setAccess(_0x785520);}),logger['debug'](_0x2a88e6(0x17e)+_0x5cbba3[_0x2a88e6(0x162)](-0x8)),setTokenRefresh(_0x5cbba3),setSessionTimeout(_0x2a88e6(0x28a),_0x5cbba3));}}else logger[_0x2a88e6(0x1a7)](_0x2a88e6(0xfd));}),_0x26583d['on'](_0x8f6288(0x100),()=>{resetPassword();}),_0x26583d['on'](_0x8f6288(0x172),_0x3b53ab=>{removeClient(_0x26583d['id']);}),_0x663a18==_0x8f6288(0x237)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x25ca51){const _0x7616ec=_0x4c9701;if(_0x25ca51!='botmanager'&&config[_0x7616ec(0x9c)]!=''){if(pid[_0x25ca51])pid[_0x25ca51][_0x7616ec(0x132)]({'function':_0x7616ec(0x255),'args':null});}_0x25ca51!=_0x7616ec(0x237)&&broadcastToBots(_0x7616ec(0xbd),JSON[_0x7616ec(0xe5)](config));}function reloadBotManager(){const _0x3a3a65=_0x4c9701;getClientsWithBotID(_0x3a3a65(0x237))['forEach'](_0xe23554=>{const _0x56d465=_0x3a3a65;getSocket(_0xe23554['id'])[_0x56d465(0x217)](_0x56d465(0x214),{'access':{'allow':![],'reason':_0x56d465(0x121),'token':null}});});}function getSocket(_0x4fb33a){const _0x4ad33c=_0x4c9701;return io['sockets'][_0x4ad33c(0x246)][_0x4ad33c(0x25a)](_0x4fb33a);}function setAccess(_0x42b380){const _0x1a4c85=_0x4c9701,_0x846c2b=getSocket(_0x42b380['id']),_0x287ba1=_0x42b380[_0x1a4c85(0x8b)],_0xdf5b1d=_0x42b380[_0x1a4c85(0x13b)];devices[_0x287ba1][_0x1a4c85(0x17f)]=validateAccess(devices[_0x287ba1]['access'][_0x1a4c85(0x8d)],_0x287ba1),logger[_0x1a4c85(0x276)](_0x1a4c85(0x124)+devices[_0x287ba1][_0x1a4c85(0x17f)]['reason']+_0x1a4c85(0x1a9)+_0x42b380['id']['slice'](-0x8)+_0x1a4c85(0xad)+_0x287ba1[_0x1a4c85(0x162)](-0x8)),_0x846c2b[_0x1a4c85(0x1c2)](_0x287ba1);if(devices[_0x287ba1][_0x1a4c85(0x17f)][_0x1a4c85(0x174)]){_0x846c2b[_0x1a4c85(0x1c2)](_0xdf5b1d);if(_0xdf5b1d==_0x1a4c85(0x237))initializeSocketBotManager(_0x846c2b);else initializeSocketBot(_0x846c2b);initClient(_0xdf5b1d);}devices[_0x287ba1][_0x1a4c85(0x17f)][_0x1a4c85(0x8d)]&&devices[_0x287ba1][_0x1a4c85(0x17f)][_0x1a4c85(0x1e1)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x1a4c85(0xaa),_0x287ba1),devices[_0x287ba1]['access']['token']&&devices[_0x287ba1][_0x1a4c85(0x17f)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x1a4c85(0x28a),_0x287ba1),_0x846c2b[_0x1a4c85(0x217)](_0x1a4c85(0x214),{'status':_0x42b380[_0x1a4c85(0x264)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x287ba1][_0x1a4c85(0x17f)],'externalip':devices[_0x287ba1]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x1a4c85(0x1d7)],'validInstallation':validInstallation}),devices[_0x287ba1][_0x1a4c85(0x17f)][_0x1a4c85(0x174)]==![]&&devices[_0x287ba1]['access'][_0x1a4c85(0x1e1)]==_0x1a4c85(0x82)&&temporaryAccess2FA(_0x287ba1,devices[_0x287ba1]['ip']);}function setSessionTimeout(_0x1dffa9,_0x573263){const _0xa263d0=_0x4c9701;let _0xd1d3dd;if(_0x1dffa9==_0xa263d0(0x28a))_0xd1d3dd=loginExpiry*0x3c*0x3e8;else _0xd1d3dd=devices[_0x573263]['telegramIpApproval'][_0xa263d0(0x80)]*0x3c*0x3e8-(new Date()[_0xa263d0(0x92)]()-devices[_0x573263]['telegramIpApproval'][_0xa263d0(0x259)]);if(devices[_0x573263][_0xa263d0(0x1d8)])clearTimeout(devices[_0x573263][_0xa263d0(0x1d8)]);devices[_0x573263]['pidExpireLogin']=setTimeout(()=>{const _0x412eaa=_0xa263d0;if(devices[_0x573263][_0x412eaa(0x1cd)])clearTimeout(devices[_0x573263][_0x412eaa(0x1cd)]);removeSocketListeners(_0x573263),addBlacklist(_0x573263),devices[_0x573263]['telegramIpApproval']=null,devices[_0x573263][_0x412eaa(0x19f)]=null,devices[_0x573263][_0x412eaa(0x17f)][_0x412eaa(0x8d)]=null,logger['debug'](_0x412eaa(0x110)+_0x573263['slice'](-0x8)),devices[_0x573263][_0x412eaa(0x17f)]=validateAccess(devices[_0x573263]['access']['token'],_0x573263),!(devices[_0x573263][_0x412eaa(0x17f)][_0x412eaa(0x174)]&&devices[_0x573263][_0x412eaa(0x17f)][_0x412eaa(0x1e1)]==_0x412eaa(0x1fe))&&(_0x1dffa9==_0x412eaa(0x28a)?io['to'](_0x573263)[_0x412eaa(0x217)](_0x412eaa(0x214),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x573263)['emit'](_0x412eaa(0x214),{'access':{'allow':![],'reason':_0x412eaa(0xcf),'token':null}})),devices[_0x573263][_0x412eaa(0x17f)]['token']=null;},_0xd1d3dd);}function setTokenRefresh(_0x5a18d2){const _0x535e42=_0x4c9701;if(devices[_0x5a18d2][_0x535e42(0x1cd)])clearTimeout(devices[_0x5a18d2][_0x535e42(0x1cd)]);devices[_0x5a18d2][_0x535e42(0x1cd)]=setTimeout(()=>{const _0x25f9dd=_0x535e42;getClientsWithUuid(_0x5a18d2)[_0x25f9dd(0x213)]!=0x0?(devices[_0x5a18d2][_0x25f9dd(0x17f)]=refreshToken(_0x5a18d2),io['to'](_0x5a18d2)[_0x25f9dd(0x217)](_0x25f9dd(0x214),{'status':_0x25f9dd(0x20c),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5a18d2]['access'],'externalip':devices[_0x5a18d2]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x5a18d2)):clearTimeout(devices[_0x5a18d2][_0x25f9dd(0x1cd)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x307a70){const _0x1665fe=_0x4c9701,_0x7467f4=getClient(_0x307a70['id'])[_0x1665fe(0x8b)];_0x307a70[_0x1665fe(0x217)](_0x1665fe(0xbd),config),_0x307a70[_0x1665fe(0x217)](_0x1665fe(0x1c7),cleanSettings()),_0x307a70['on'](_0x1665fe(0x200),_0x39a630=>{const _0x1dab6e=_0x1665fe;if(validateAccess(_0x39a630,_0x7467f4)[_0x1dab6e(0x174)])addBot();else logger[_0x1dab6e(0x1a7)](_0x1dab6e(0x17d));}),_0x307a70['on'](_0x1665fe(0x1b6),(_0x358909,_0x1e6dea)=>{const _0x93730e=_0x1665fe;if(validateAccess(_0x1e6dea,_0x7467f4)[_0x93730e(0x174)])toggleBot(_0x358909[_0x93730e(0x15c)],_0x358909[_0x93730e(0x214)],_0x358909[_0x93730e(0x182)]);else logger[_0x93730e(0x1a7)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x307a70['on'](_0x1665fe(0x12f),(_0x37fbd7,_0x5b564c)=>{const _0x1f9796=_0x1665fe;if(validateAccess(_0x5b564c,_0x7467f4)[_0x1f9796(0x174)])toggleBotMode(_0x37fbd7);else logger[_0x1f9796(0x1a7)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x307a70['on'](_0x1665fe(0x218),(_0x283da9,_0xcd2c88)=>{const _0x28950a=_0x1665fe;if(validateAccess(_0xcd2c88,_0x7467f4)[_0x28950a(0x174)])deleteBot(_0x283da9);else logger[_0x28950a(0x1a7)](_0x28950a(0x173));}),_0x307a70['on'](_0x1665fe(0x27a),(_0x5f4b30,_0x15b993)=>{const _0x24e19e=_0x1665fe;if(validateAccess(_0x15b993,_0x7467f4)[_0x24e19e(0x174)])storeSettings(_0x5f4b30,!![]);else logger[_0x24e19e(0x1a7)](_0x24e19e(0x270));}),_0x307a70['on'](_0x1665fe(0x228),_0x225acb=>{const _0x3a873f=_0x1665fe;if(validateAccess(_0x225acb,_0x7467f4)[_0x3a873f(0x174)])updateBB('update');else logger[_0x3a873f(0x1a7)](_0x3a873f(0xa3));}),_0x307a70['on'](_0x1665fe(0x98),_0x5b4fc5=>{const _0x5a1fd5=_0x1665fe;if(validateAccess(_0x5b4fc5,_0x7467f4)[_0x5a1fd5(0x174)])updateBB(_0x5a1fd5(0x171));else logger[_0x5a1fd5(0x1a7)](_0x5a1fd5(0x119));}),_0x307a70['on'](_0x1665fe(0x104),_0x473482=>{const _0xa63d06=_0x1665fe;if(validateAccess(_0x473482,_0x7467f4)['allow']){const _0x303d5f=getClient(_0x307a70['id']);if(_0x303d5f)getBackupFiles(_0x303d5f[_0xa63d06(0x8b)]);else logger[_0xa63d06(0x1a7)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0xa63d06(0x1a7)](_0xa63d06(0x1b4));}),_0x307a70['on'](_0x1665fe(0x1bc),(_0x589cf4,_0x360147)=>{const _0x3f0d21=_0x1665fe;if(validateAccess(_0x360147,_0x7467f4)[_0x3f0d21(0x174)])restoreBackupFile(_0x589cf4);else logger[_0x3f0d21(0x1a7)](_0x3f0d21(0x16b));}),_0x307a70['on'](_0x1665fe(0x94),_0x45d315=>{const _0x1a2776=_0x1665fe;if(validateAccess(_0x45d315,_0x7467f4)[_0x1a2776(0x174)])getMessages();else logger[_0x1a2776(0x1a7)](_0x1a2776(0xa7));}),_0x307a70['on']('confirm-message',(_0x15cd99,_0x14361f)=>{const _0x419395=_0x1665fe;if(validateAccess(_0x14361f,_0x7467f4)[_0x419395(0x174)])confirmMessage(_0x15cd99);else logger['full'](_0x419395(0x192));}),_0x307a70['on']('logout',_0x2149e6=>{const _0x1243f1=_0x1665fe;if(validateAccess(_0x2149e6,_0x7467f4)[_0x1243f1(0x174)]){if(devices[_0x7467f4]['pidRefreshToken'])clearTimeout(devices[_0x7467f4][_0x1243f1(0x1cd)]);if(devices[_0x7467f4][_0x1243f1(0x1d8)])clearTimeout(devices[_0x7467f4][_0x1243f1(0x1d8)]);removeSocketListeners(getClient(_0x307a70['id'])[_0x1243f1(0x8b)]),addBlacklist(_0x7467f4),devices[_0x7467f4][_0x1243f1(0x99)]=null,devices[_0x7467f4][_0x1243f1(0x19f)]=null,devices[_0x7467f4][_0x1243f1(0x17f)][_0x1243f1(0x8d)]=null,logger[_0x1243f1(0x276)](_0x1243f1(0x16e)+_0x7467f4[_0x1243f1(0x162)](-0x8)),io['to'](getClient(_0x307a70['id'])['uuid'])[_0x1243f1(0x217)](_0x1243f1(0x214),{'access':{'allow':![],'reason':_0x1243f1(0x1c6),'token':null}});}else logger['full'](_0x1243f1(0x1b0));});}function initializeSocketBot(_0x38e578){const _0x3e5040=_0x4c9701,_0x54434a=getClient(_0x38e578['id'])[_0x3e5040(0x13b)],_0x3837a8=getClient(_0x38e578['id'])[_0x3e5040(0x8b)];_0x38e578['on'](_0x3e5040(0x186),(_0x32d910,_0x323495)=>{const _0x357269=_0x3e5040;if(validateAccess(_0x323495,_0x3837a8)[_0x357269(0x174)]){if(pid[_0x54434a])pid[_0x54434a]['send']({'function':_0x357269(0xb2),'args':_0x32d910});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x38e578['on']('delete-alerts',(_0x54d044,_0x5f57a9)=>{const _0x182022=_0x3e5040;if(validateAccess(_0x5f57a9,_0x3837a8)['allow']){if(pid[_0x54434a])pid[_0x54434a][_0x182022(0x132)]({'function':'deleteHistoryAlerts','args':_0x54d044});}else logger[_0x182022(0x1a7)](_0x182022(0xc1));}),_0x38e578['on'](_0x3e5040(0xc4),(_0x5bd5cf,_0x4eaf3e)=>{const _0x1120f1=_0x3e5040;if(validateAccess(_0x4eaf3e,_0x3837a8)['allow']){if(pid[_0x54434a])pid[_0x54434a]['send']({'function':'getPortfolio','args':_0x5bd5cf});}else logger[_0x1120f1(0x1a7)](_0x1120f1(0x10c));}),_0x38e578['on'](_0x3e5040(0x1dc),(_0x46d912,_0x38ca71)=>{const _0x3eec8f=_0x3e5040;if(validateAccess(_0x38ca71,_0x3837a8)[_0x3eec8f(0x174)]){if(pid[_0x54434a])pid[_0x54434a][_0x3eec8f(0x132)]({'function':_0x3eec8f(0xf3),'args':_0x46d912});}else logger[_0x3eec8f(0x1a7)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x38e578['on'](_0x3e5040(0x1c9),(_0x301fff,_0x9d7286)=>{const _0x5692a7=_0x3e5040;if(validateAccess(_0x9d7286,_0x3837a8)[_0x5692a7(0x174)]){if(pid[_0x54434a])pid[_0x54434a][_0x5692a7(0x132)]({'function':'storeHeadless','args':_0x301fff});}else logger[_0x5692a7(0x1a7)](_0x5692a7(0x1be));}),_0x38e578['on']('store-fiat',(_0x3ccc93,_0x540caf)=>{const _0x171d76=_0x3e5040;if(validateAccess(_0x540caf,_0x3837a8)['allow']){if(pid[_0x54434a])pid[_0x54434a][_0x171d76(0x132)]({'function':_0x171d76(0x1c4),'args':_0x3ccc93});}else logger[_0x171d76(0x1a7)](_0x171d76(0x252));}),_0x38e578['on']('reset-history',_0x203b43=>{const _0x5f1883=_0x3e5040;if(validateAccess(_0x203b43,_0x3837a8)[_0x5f1883(0x174)]){if(pid[_0x54434a])pid[_0x54434a][_0x5f1883(0x132)]({'function':_0x5f1883(0x274),'args':null});}else logger[_0x5f1883(0x1a7)](_0x5f1883(0xeb));}),_0x38e578['on'](_0x3e5040(0x15e),_0x2d7ca8=>{const _0x5c0fe0=_0x3e5040;if(validateAccess(_0x2d7ca8,_0x3837a8)[_0x5c0fe0(0x174)]){if(pid[_0x54434a])pid[_0x54434a][_0x5c0fe0(0x132)]({'function':'getStartingBalances','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x38e578['on'](_0x3e5040(0x208),(_0x39aa99,_0x4010dc)=>{const _0x500967=_0x3e5040;if(validateAccess(_0x4010dc,_0x3837a8)[_0x500967(0x174)]){if(pid[_0x54434a])pid[_0x54434a][_0x500967(0x132)]({'function':'placeOrder','args':_0x39aa99});}else logger[_0x500967(0x1a7)](_0x500967(0x15f));}),_0x38e578['on'](_0x3e5040(0xc0),_0x5b2c03=>{const _0x188934=_0x3e5040;if(validateAccess(_0x5b2c03,_0x3837a8)[_0x188934(0x174)]){if(pid[_0x54434a])pid[_0x54434a][_0x188934(0x132)]({'function':_0x188934(0x103),'args':null});}else logger[_0x188934(0x1a7)](_0x188934(0x1af));}),_0x38e578['on']('show-config',_0x2b3fc7=>{const _0x21fac0=_0x3e5040;if(validateAccess(_0x2b3fc7,_0x3837a8)[_0x21fac0(0x174)]){if(pid[_0x54434a])pid[_0x54434a]['send']({'function':_0x21fac0(0x19a),'args':null});}else logger[_0x21fac0(0x1a7)](_0x21fac0(0x17a));}),_0x38e578['on'](_0x3e5040(0x228),_0x57a5ab=>{const _0xa2c7dc=_0x3e5040;if(validateAccess(_0x57a5ab,_0x3837a8)[_0xa2c7dc(0x174)])updateBB(_0xa2c7dc(0xcd));else logger[_0xa2c7dc(0x1a7)](_0xa2c7dc(0xa3));}),_0x38e578['on'](_0x3e5040(0x94),_0x5ade9e=>{const _0x1b03dc=_0x3e5040;if(validateAccess(_0x5ade9e,_0x3837a8)[_0x1b03dc(0x174)])getMessages();else logger[_0x1b03dc(0x1a7)](_0x1b03dc(0xa7));}),_0x38e578['on'](_0x3e5040(0x157),(_0x16a554,_0x1f889b)=>{const _0x80d74c=_0x3e5040;if(validateAccess(_0x1f889b,_0x3837a8)[_0x80d74c(0x174)])confirmMessage(_0x16a554);else logger[_0x80d74c(0x1a7)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x38e578['on'](_0x3e5040(0x24c),_0x465a50=>{const _0x1929ee=_0x3e5040;if(validateAccess(_0x465a50,_0x3837a8)[_0x1929ee(0x174)]){if(devices[_0x3837a8][_0x1929ee(0x1cd)])clearTimeout(devices[_0x3837a8][_0x1929ee(0x1cd)]);if(devices[_0x3837a8][_0x1929ee(0x1d8)])clearTimeout(devices[_0x3837a8]['pidExpireLogin']);removeSocketListeners(getClient(_0x38e578['id'])[_0x1929ee(0x8b)]),addBlacklist(_0x3837a8),devices[_0x3837a8][_0x1929ee(0x99)]=null,devices[_0x3837a8][_0x1929ee(0x19f)]=null,devices[_0x3837a8][_0x1929ee(0x17f)]['token']=null,logger['debug'](_0x1929ee(0x16e)+_0x3837a8[_0x1929ee(0x162)](-0x8)),io['to'](getClient(_0x38e578['id'])[_0x1929ee(0x8b)])[_0x1929ee(0x217)](_0x1929ee(0x214),{'access':{'allow':![],'reason':_0x1929ee(0x1c6),'token':null}});}else logger[_0x1929ee(0x1a7)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x336e10){const _0x102e98=_0x4c9701;getClientsWithUuid(_0x336e10)[_0x102e98(0x230)](_0x2e55c0=>{const _0x553f3c=_0x102e98;getSocket(_0x2e55c0['id'])[_0x553f3c(0x15a)]();});}function cleanSettings(){const _0x87c81d=_0x4c9701;let _0x247a0e=settings;return settings[_0x87c81d(0xc8)]&&settings[_0x87c81d(0xc8)]!=''&&(_0x247a0e={..._0x247a0e,'telegramToken':_0x87c81d(0x23d)}),settings[_0x87c81d(0x1df)]&&settings[_0x87c81d(0x1df)]!=''&&(_0x247a0e={..._0x247a0e,'bbPassword':_0x87c81d(0x23d)}),settings[_0x87c81d(0x244)]&&settings['marketcapApi']!=''&&(_0x247a0e={..._0x247a0e,'marketcapApi':_0x87c81d(0x23d)}),(settings[_0x87c81d(0x1df)]&&settings[_0x87c81d(0x1df)]==_0x87c81d(0x1c5)||settings['telegramToken']&&settings[_0x87c81d(0xc8)]==_0x87c81d(0x1c5)||settings[_0x87c81d(0x244)]&&settings[_0x87c81d(0x244)]=='***')&&(_0x247a0e={..._0x247a0e,'restored':{'password':settings[_0x87c81d(0x1df)]==_0x87c81d(0x1c5),'telegram':settings[_0x87c81d(0xc8)]==_0x87c81d(0x1c5),'marketcap':settings[_0x87c81d(0x244)]==_0x87c81d(0x1c5)}}),_0x247a0e;}async function updateBB(_0x10964d){const _0x346584=_0x4c9701;await backupConfigFiles(),installingUpdate=!![],config[_0x346584(0x230)](_0x528185=>{const _0x4cec95=_0x346584;restartBot(_0x528185[_0x4cec95(0x15c)]);});if(_0x10964d==_0x346584(0xcd))process['send']({'update':!![],'environment':environment},_0x299669=>{});else _0x10964d==_0x346584(0x171)&&process[_0x346584(0x132)]({'reinstall':!![],'environment':environment},_0x35ef5e=>{});}function startBot(_0x5991a6,_0x286a03,_0x5eb2cc){const _0x365c23=_0x4c9701;if(debugging)_0x5991a6[_0x365c23(0x184)]('-d');let _0x13988e=![];const _0x53c3d3=_0x5991a6[0x0];_0x286a03={..._0x286a03,'stdio':['inherit',_0x365c23(0x1b7),'inherit',_0x365c23(0x135)]},pid[_0x53c3d3]=childProcess['fork'](botfile,_0x5991a6,_0x286a03),pid[_0x53c3d3]['on'](_0x365c23(0xef),_0x6bb9df=>{const _0x4b56cb=_0x365c23;switch(Object[_0x4b56cb(0x1b5)](_0x6bb9df)[0x0]){case'botname':updateBotName(_0x53c3d3,_0x6bb9df[_0x4b56cb(0xf4)]);break;case _0x4b56cb(0x225):updateBotManager();break;case'status':updateStatus(_0x53c3d3,_0x6bb9df[_0x4b56cb(0x214)]);break;case _0x4b56cb(0x182):updateLive(_0x53c3d3,_0x6bb9df['live']);break;case'started':updateLive(_0x53c3d3,_0x6bb9df[_0x4b56cb(0x249)]),io['to'](_0x53c3d3)[_0x4b56cb(0x217)](_0x4b56cb(0x214),{'access':{'allow':![],'reason':_0x4b56cb(0x121),'token':null}});break;case _0x4b56cb(0x267):_0x6bb9df[_0x4b56cb(0x267)]==_0x4b56cb(0x12a)&&restartBot(_0x53c3d3);_0x6bb9df[_0x4b56cb(0x267)]==_0x4b56cb(0xe4)&&toggleBot(_0x53c3d3,'disabled','stopped');break;case _0x4b56cb(0x187):sendTelegramBot(_0x53c3d3,_0x6bb9df[_0x4b56cb(0x187)]);break;case'telegrammsg':sendTelegramMsg(_0x6bb9df['telegrammsg']);break;case _0x4b56cb(0x233):io['to'](_0x53c3d3)['emit'](_0x6bb9df[_0x4b56cb(0x233)],_0x6bb9df[_0x4b56cb(0x114)]);break;}}),pid[_0x53c3d3]['on']('error',function(_0x421e31){if(_0x13988e)return;_0x13988e=!![],_0x5eb2cc(_0x421e31);}),pid[_0x53c3d3]['on'](_0x365c23(0xcb),async function(_0x4f382f){const _0x21462c=_0x365c23;if(terminating)return;if(installingUpdate){logger['debug'](_0x21462c(0x272)),io[_0x21462c(0xb1)]();return;}if(_0x13988e)return;_0x13988e=!![],_0x5eb2cc(null);const _0x5bbca4=dbConfig[_0x21462c(0x25a)]('bots')[_0x21462c(0x284)]({'botID':_0x53c3d3})[_0x21462c(0x207)]();_0x5bbca4&&(_0x5bbca4[_0x21462c(0x214)]==_0x21462c(0x12d)||_0x5bbca4['status']==_0x21462c(0xfa))&&(await sleep(0x3e8),updateLive(_0x53c3d3,'stopped'),logger[_0x21462c(0x1a7)](_0x21462c(0x1cc)+_0x53c3d3),startBot([_0x53c3d3,userID],{'cwd':bbpath},function(_0x3e3c28){const _0x25d25b=_0x21462c;if(_0x3e3c28)logger[_0x25d25b(0x1a7)](_0x3e3c28);}));});}function stopBot(_0x3953d2){const _0x43aa6d=_0x4c9701;getClientsWithBotID(_0x3953d2)[_0x43aa6d(0x230)](_0x45a441=>{const _0x13bc44=_0x43aa6d;getSocket(_0x45a441['id'])[_0x13bc44(0x172)](!![]),removeClient(_0x45a441['id']);}),pid[_0x3953d2]&&(pid[_0x3953d2][_0x43aa6d(0xe4)](),pid[_0x3953d2]=null);}function stopAllBots(){terminating=!![];const _0x37e0b4=getEnabledBots();_0x37e0b4['forEach'](_0x174b54=>{const _0x352e1b=_0x1bd5;stopBot(_0x174b54[_0x352e1b(0x15c)]);});}function restartBot(_0x508aef){if(pid[_0x508aef])pid[_0x508aef]['kill']();}function addBot(){const _0xb4abf=_0x4c9701;let _0x3f900f;for(let _0x290638=0x1;_0x290638<0x3e9;_0x290638++){_0x3f900f=_0x290638[_0xb4abf(0x112)]()['padStart'](0x3,'0');let _0x12bf1a=config[_0xb4abf(0x284)](_0x136d8a=>_0x136d8a['botID']==_0x3f900f);if(!_0x12bf1a)break;}if(_0x3f900f==='1000'){logger['full'](_0xb4abf(0x286));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x3f900f),dbConfig[_0xb4abf(0x25a)]('bots')[_0xb4abf(0x184)]({'botID':_0x3f900f,'botname':_0xb4abf(0x21f)+_0x3f900f,'status':_0xb4abf(0xfa),'live':''})[_0xb4abf(0x265)](),startBot([_0x3f900f,userID],{'cwd':bbpath},function(_0xb505d0){const _0xd59bfc=_0xb4abf;if(_0xb505d0)logger[_0xd59bfc(0x1a7)](_0xb505d0);}),config=getConfiguration(),io['to'](_0xb4abf(0x237))[_0xb4abf(0x217)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x20042b){const _0x15af67=_0x4c9701;getClientsWithBotID(_0x20042b)[_0x15af67(0x230)](_0x1fb594=>{getSocket(_0x1fb594['id'])['disconnect'](!![]),removeClient(_0x1fb594['id']);}),dbConfig[_0x15af67(0x25a)]('bots')[_0x15af67(0x143)]({'botID':_0x20042b})[_0x15af67(0x265)](),logger[_0x15af67(0x1a7)](_0x15af67(0xc9)+_0x20042b),stopBot(_0x20042b);try{if(fs['existsSync'](path[_0x15af67(0x1c2)](configpath,'bot-'+_0x20042b+_0x15af67(0xd1))))fs[_0x15af67(0x18d)](path['join'](configpath,_0x15af67(0x20e)+_0x20042b+_0x15af67(0xd1)));if(fs['existsSync'](path[_0x15af67(0x1c2)](configpath,'bot-'+_0x20042b+_0x15af67(0x1bb))))fs[_0x15af67(0x18d)](path[_0x15af67(0x1c2)](configpath,_0x15af67(0x20e)+_0x20042b+_0x15af67(0x1bb)));if(fs[_0x15af67(0xd3)](path['join'](configpath,_0x15af67(0x20e)+_0x20042b+_0x15af67(0x232))))fs[_0x15af67(0x18d)](path[_0x15af67(0x1c2)](configpath,'bot-'+_0x20042b+_0x15af67(0x232)));if(fs[_0x15af67(0xd3)](path[_0x15af67(0x1c2)](configpath,_0x15af67(0x20e)+_0x20042b+_0x15af67(0x16d))))fs[_0x15af67(0x18d)](path[_0x15af67(0x1c2)](configpath,_0x15af67(0x20e)+_0x20042b+_0x15af67(0x16d)));}catch(_0x3bd059){if(_0x3bd059)logger[_0x15af67(0x1a7)](_0x15af67(0x210),_0x3bd059);}config=getConfiguration(),io['to'](_0x15af67(0x237))[_0x15af67(0x217)](_0x15af67(0xbd),config),broadcastToBots(_0x15af67(0xbd),JSON[_0x15af67(0xe5)](config));}function toggleBot(_0x5e1482,_0x3c5f39,_0x31d435){const _0x217a8d=_0x4c9701;dbConfig['get']('bots')[_0x217a8d(0x284)]({'botID':_0x5e1482})[_0x217a8d(0xee)]({'status':_0x3c5f39})[_0x217a8d(0xee)]({'live':_0x31d435})[_0x217a8d(0x265)]();if(_0x3c5f39=='enabled'||_0x3c5f39==_0x217a8d(0xfa))logger[_0x217a8d(0x1a7)](_0x217a8d(0xc2)+_0x5e1482),startBot([_0x5e1482,userID],{'cwd':bbpath},function(_0x33b1ec){if(_0x33b1ec)logger['full'](_0x33b1ec);});else(_0x3c5f39==_0x217a8d(0x24b)||_0x3c5f39==_0x217a8d(0x9b))&&(logger['full'](_0x217a8d(0xaf)+_0x5e1482),stopBot(_0x5e1482));config=getConfiguration(),io['to'](_0x217a8d(0x237))[_0x217a8d(0x217)](_0x217a8d(0xbd),config),broadcastToBots(_0x217a8d(0xbd),JSON['stringify'](config));}function toggleStatus(_0x4e9b69){const _0x44aad6=_0x4c9701;let _0x3415fd=dbConfig[_0x44aad6(0x25a)](_0x44aad6(0xbd))[_0x44aad6(0x284)]({'botID':_0x4e9b69})['value'](),_0x3ed02f;if(_0x3415fd[_0x44aad6(0x214)]===_0x44aad6(0x12d))_0x3ed02f=_0x44aad6(0x24b);else{if(_0x3415fd[_0x44aad6(0x214)]===_0x44aad6(0xfa))_0x3ed02f=_0x44aad6(0x9b);else{if(_0x3415fd[_0x44aad6(0x214)]===_0x44aad6(0x9b))_0x3ed02f=_0x44aad6(0xfa);else{if(_0x3415fd[_0x44aad6(0x214)]===_0x44aad6(0x24b))_0x3ed02f=_0x44aad6(0x12d);}}}return _0x3ed02f;}function updateStatus(_0x58ab42,_0x360189){const _0x21645f=_0x4c9701;dbConfig[_0x21645f(0x25a)](_0x21645f(0xbd))[_0x21645f(0x284)]({'botID':_0x58ab42})[_0x21645f(0xee)]({'status':_0x360189})[_0x21645f(0x265)](),config=getConfiguration(),io['to'](_0x21645f(0x237))['emit'](_0x21645f(0xbd),config),broadcastToBots('bots',JSON[_0x21645f(0xe5)](config));}function updateLive(_0x25ca12,_0x4cc808){const _0x483e1a=_0x4c9701;dbConfig[_0x483e1a(0x25a)]('bots')[_0x483e1a(0x284)]({'botID':_0x25ca12})[_0x483e1a(0xee)]({'live':_0x4cc808})['write'](),config=getConfiguration(),io['to'](_0x483e1a(0x237))[_0x483e1a(0x217)]('bots',config),broadcastToBots(_0x483e1a(0xbd),JSON['stringify'](config));}function updateBotName(_0x28b6ef,_0x524c93){const _0x5a1247=_0x4c9701;dbConfig[_0x5a1247(0x25a)](_0x5a1247(0xbd))[_0x5a1247(0x284)]({'botID':_0x28b6ef})[_0x5a1247(0xee)]({'botname':_0x524c93})[_0x5a1247(0x265)](),config=getConfiguration(),io['to']('botmanager')[_0x5a1247(0x217)](_0x5a1247(0xbd),config),broadcastToBots(_0x5a1247(0xbd),JSON['stringify'](config));}function updateBotManager(){const _0x407a07=_0x4c9701;config=getConfiguration(),io['to'](_0x407a07(0x237))[_0x407a07(0x217)](_0x407a07(0xbd),config),broadcastToBots('bots',JSON[_0x407a07(0xe5)](config));}function toggleBotMode(_0x4bef02){const _0x558339=_0x4c9701;if(pid[_0x4bef02])pid[_0x4bef02][_0x558339(0x132)]({'function':'toggleBotMode','args':null});else{const _0x180ed9=configpath+_0x558339(0x20e)+_0x4bef02+_0x558339(0xd1),_0x1ac738=fs[_0x558339(0x168)](_0x180ed9),_0x131071=JSON[_0x558339(0x27d)](_0x1ac738),_0x197927=_0x131071['bot'][0x0][_0x558339(0x26d)];_0x131071['bot'][0x0][_0x558339(0x26d)]=!_0x197927;const _0x50073a=JSON[_0x558339(0xe5)](_0x131071,null,0x2);fs[_0x558339(0x12c)](_0x180ed9,_0x50073a),config=getConfiguration(),io['to'](_0x558339(0x237))['emit'](_0x558339(0xbd),config),broadcastToBots(_0x558339(0xbd),JSON[_0x558339(0xe5)](config));}}function validateTelegram(_0x272b49){const _0x4926c6=_0x4c9701;if(_0x272b49[_0x4926c6(0xcc)][_0x4926c6(0x13e)]!=settings[_0x4926c6(0x149)]&&'@'+_0x272b49[_0x4926c6(0xcc)]['username']!=settings[_0x4926c6(0x149)]||_0x272b49['chat']['id']!=settings[_0x4926c6(0x169)])return sendTelegram(_0x272b49[_0x4926c6(0x161)]['id'],_0x4926c6(0x134),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x57db33=_0x4c9701;if(tgBot)tgBot[_0x57db33(0x267)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x45e8be='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x45e8be+='\x0a',_0x45e8be+='/enable\x20-\x20enable\x20notifications\x0a',_0x45e8be+=_0x57db33(0x10a),_0x45e8be+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x45e8be+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x45e8be+=_0x57db33(0x1a4),_0x45e8be+='/off\x20-\x20stop\x20bot(s)\x0a',_0x45e8be+=_0x57db33(0xf7),_0x45e8be+='/names\x20-\x20show\x20bot\x20names\x0a',_0x45e8be+=_0x57db33(0x16a),_0x45e8be+=_0x57db33(0x263),_0x45e8be+=_0x57db33(0xd5),_0x45e8be+=_0x57db33(0xea),_0x45e8be+=_0x57db33(0x159),_0x45e8be+=_0x57db33(0x123);let _0x2ea240=_0x57db33(0x1fd);_0x2ea240+='\x0a',_0x2ea240+=_0x45e8be,tgBot[_0x57db33(0x285)]((_0x205d82,_0x97e55d)=>{const _0x6ac870=_0x57db33;logger[_0x6ac870(0x266)](getTimeStamp()+_0x6ac870(0x175)),logger['debug'](_0x6ac870(0x190),_0x205d82);}),tgBot['use'](async(_0x4d92d0,_0x4a6f40)=>{const _0x3b74aa=_0x57db33;if(!(!settings[_0x3b74aa(0x169)]&&_0x4d92d0[_0x3b74aa(0xcd)][_0x3b74aa(0xef)][_0x3b74aa(0x1bf)]==_0x3b74aa(0x258))){if(!validateTelegram(_0x4d92d0))return;}_0x4a6f40();}),tgBot[_0x57db33(0x234)]('start',async _0xcca513=>{const _0x30439b=_0x57db33;if(!settings[_0x30439b(0x169)])updateSetting(_0x30439b(0x169),_0xcca513[_0x30439b(0x161)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0xcca513))return;await sendTelegram(_0xcca513['chat']['id'],_0x2ea240);}),tgBot[_0x57db33(0x234)]('enable',async _0x3c2d37=>{const _0xcc0a46=_0x57db33;updateSetting(_0xcc0a46(0x1e2),!![]),await sendTelegram(_0x3c2d37[_0xcc0a46(0x161)]['id'],_0xcc0a46(0xa2));}),tgBot['command'](_0x57db33(0xba),async _0x2886a1=>{const _0x12d28f=_0x57db33;await sendTelegram(_0x2886a1[_0x12d28f(0x161)]['id'],_0x12d28f(0x18b)),updateSetting(_0x12d28f(0x1e2),![]);}),tgBot['command'](_0x57db33(0xe6),async _0x286a3d=>{const _0x6972f4=_0x57db33,_0x390cbc=Markup[_0x6972f4(0x23b)]([Markup[_0x6972f4(0x1e5)]['callback'](_0x6972f4(0x85),'config_orders'),Markup[_0x6972f4(0x1e5)][_0x6972f4(0x268)](_0x6972f4(0xf1),'config_alerts'),Markup['button'][_0x6972f4(0x268)](_0x6972f4(0x129),'config_all')]);_0x286a3d[_0x6972f4(0x1ce)](_0x6972f4(0xda),_0x390cbc);}),tgBot[_0x57db33(0x282)](_0x57db33(0x209),async _0x411c91=>{const _0x4f8ab8=_0x57db33;_0x411c91[_0x4f8ab8(0x26b)](),updateSetting(_0x4f8ab8(0x11e),_0x4f8ab8(0x84)),updateSetting(_0x4f8ab8(0x1e2),!![]),await sendTelegram(_0x411c91[_0x4f8ab8(0x161)]['id'],_0x4f8ab8(0x13c));}),tgBot['action'](_0x57db33(0x167),async _0x176ac8=>{const _0x26e0f4=_0x57db33;_0x176ac8['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x26e0f4(0x243)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x176ac8[_0x26e0f4(0x161)]['id'],_0x26e0f4(0x279));}),tgBot[_0x57db33(0x282)](_0x57db33(0x25c),async _0xcb3d7=>{const _0x570b38=_0x57db33;_0xcb3d7[_0x570b38(0x26b)](),updateSetting(_0x570b38(0x11e),_0x570b38(0xe9)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0xcb3d7[_0x570b38(0x161)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x57db33(0x234)](_0x57db33(0x214),async _0x2862a3=>{const _0xe7ce49=_0x57db33,_0x4ce960=getBotsWithMode();let _0x532028=_0xe7ce49(0x201);config[_0xe7ce49(0x230)](_0x1bf76b=>{const _0x4fdf59=_0xe7ce49,_0x142f24=_0x4ce960[_0x4fdf59(0x284)](_0x2ed31d=>_0x2ed31d['botID']==_0x1bf76b['botID'])['mode'];_0x532028+=_0x4fdf59(0x21f)+_0x1bf76b[_0x4fdf59(0x15c)]+':\x20'+_0x1bf76b[_0x4fdf59(0x214)]+'\x20|\x20'+_0x142f24+_0x4fdf59(0x211)+_0x1bf76b[_0x4fdf59(0x182)]+'\x0a';}),_0x532028+='\x0a',_0x532028+=_0xe7ce49(0x25e),_0x532028+=!settings[_0xe7ce49(0x1e2)]?_0xe7ce49(0x83):_0xe7ce49(0xc6),_0x532028+=settings['telegramEnabled']?settings[_0xe7ce49(0x11e)]==_0xe7ce49(0xe9)?_0xe7ce49(0xe2):'Notifications\x20types:\x20'+settings[_0xe7ce49(0x11e)]+_0xe7ce49(0x1e8):'',await sendTelegram(_0x2862a3[_0xe7ce49(0x161)]['id'],_0x532028,{'parse_mode':_0xe7ce49(0x289)});}),tgBot[_0x57db33(0x234)](_0x57db33(0x12a),async _0x2d19da=>{const _0x66675b=_0x57db33,_0x283a53=getEnabledBots();if(_0x283a53[_0x66675b(0x213)]==0x0)await sendTelegram(_0x2d19da[_0x66675b(0x161)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x283a53[_0x66675b(0x213)]>0x1)_0x283a53[_0x66675b(0x184)]({'botID':'all'});let _0x1ceea5=[],_0x162207=[];const _0x537ce2=_0x283a53[_0x66675b(0x213)]%0x4==0x0||_0x283a53['length']%0x4==0x3||_0x283a53[_0x66675b(0x213)]%0x3==0x1?0x4:0x3;let _0x41180b=0x0;_0x283a53[_0x66675b(0x230)]((_0xe314f1,_0x536178)=>{const _0x458e5a=_0x66675b;if(_0x536178%_0x537ce2==0x0)_0x162207=[];_0x162207[_0x458e5a(0x184)](Markup[_0x458e5a(0x1e5)][_0x458e5a(0x268)](_0xe314f1['botID']=='all'?'All\x20bots':_0x458e5a(0x21f)+_0xe314f1['botID'],_0x458e5a(0x10f)+_0xe314f1[_0x458e5a(0x15c)])),_0x536178%_0x537ce2==0x0&&(_0x1ceea5[_0x41180b]=_0x162207,_0x41180b++);});const _0x5c15bc=Markup[_0x66675b(0x23b)](_0x1ceea5);_0x2d19da['reply'](_0x66675b(0x97),_0x5c15bc);}}),tgBot[_0x57db33(0x282)](/restart_(.+)/,async _0x2964b6=>{const _0x2773d1=_0x57db33,_0x4e855d=_0x2964b6[_0x2773d1(0x275)][0x1];_0x2964b6['editMessageReplyMarkup'](),_0x4e855d==_0x2773d1(0xe9)?config['forEach'](_0x5aaeeb=>{const _0x37d00f=_0x2773d1;restartBot(_0x5aaeeb[_0x37d00f(0x15c)]);}):restartBot(_0x4e855d);}),tgBot['command']('on',async _0x168b37=>{const _0x45a513=_0x57db33,_0x3bdb61=getDisabledBots();if(_0x3bdb61[_0x45a513(0x213)]==0x0)await sendTelegram(_0x168b37['chat']['id'],_0x45a513(0xfb));else{if(_0x3bdb61[_0x45a513(0x213)]>0x1)_0x3bdb61[_0x45a513(0x184)]({'botID':_0x45a513(0xe9)});let _0x46ae77=[],_0x5508d6=[];const _0x57711d=_0x3bdb61[_0x45a513(0x213)]%0x4==0x0||_0x3bdb61[_0x45a513(0x213)]%0x4==0x3||_0x3bdb61[_0x45a513(0x213)]%0x3==0x1?0x4:0x3;let _0x3449a3=0x0;_0x3bdb61['forEach']((_0x5c0100,_0x835d42)=>{const _0x299212=_0x45a513;if(_0x835d42%_0x57711d==0x0)_0x5508d6=[];_0x5508d6[_0x299212(0x184)](Markup[_0x299212(0x1e5)][_0x299212(0x268)](_0x5c0100[_0x299212(0x15c)]=='all'?'All\x20bots':'Bot\x20'+_0x5c0100[_0x299212(0x15c)],_0x299212(0x19b)+_0x5c0100['botID'])),_0x835d42%_0x57711d==0x0&&(_0x46ae77[_0x3449a3]=_0x5508d6,_0x3449a3++);});const _0x1b638d=Markup[_0x45a513(0x23b)](_0x46ae77);_0x168b37[_0x45a513(0x1ce)](_0x45a513(0x22e),_0x1b638d);}}),tgBot[_0x57db33(0x282)](/on_(.+)/,async _0x226462=>{const _0x4920e1=_0x57db33,_0x31280a=_0x226462[_0x4920e1(0x275)][0x1];_0x226462[_0x4920e1(0x26b)]();if(_0x31280a==_0x4920e1(0xe9)){const _0x40d738=getDisabledBots();await sendTelegram(_0x226462['chat']['id'],_0x4920e1(0xf9)),_0x40d738[_0x4920e1(0x230)](_0x45ec47=>{const _0x2e215e=_0x4920e1;if(_0x45ec47[_0x2e215e(0x15c)]!=_0x2e215e(0xe9))toggleBot(_0x45ec47['botID'],toggleStatus(_0x45ec47[_0x2e215e(0x15c)]),_0x2e215e(0x105));});}else await sendTelegram(_0x226462[_0x4920e1(0x161)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x31280a),toggleBot(_0x31280a,toggleStatus(_0x31280a),_0x4920e1(0x105));}),tgBot[_0x57db33(0x234)](_0x57db33(0x1fa),async _0xf271d9=>{const _0x5d2731=_0x57db33,_0x59556b=getEnabledBots();if(_0x59556b['length']==0x0)await sendTelegram(_0xf271d9['chat']['id'],_0x5d2731(0x150));else{if(_0x59556b[_0x5d2731(0x213)]>0x1)_0x59556b[_0x5d2731(0x184)]({'botID':_0x5d2731(0xe9)});let _0x2edfa3=[],_0x50d779=[];const _0x1030fa=_0x59556b[_0x5d2731(0x213)]%0x4==0x0||_0x59556b[_0x5d2731(0x213)]%0x4==0x3||_0x59556b['length']%0x3==0x1?0x4:0x3;let _0x109970=0x0;_0x59556b[_0x5d2731(0x230)]((_0x49536f,_0x37d6af)=>{const _0x870302=_0x5d2731;if(_0x37d6af%_0x1030fa==0x0)_0x50d779=[];_0x50d779['push'](Markup[_0x870302(0x1e5)][_0x870302(0x268)](_0x49536f[_0x870302(0x15c)]==_0x870302(0xe9)?_0x870302(0x163):_0x870302(0x21f)+_0x49536f[_0x870302(0x15c)],'off_'+_0x49536f[_0x870302(0x15c)])),_0x37d6af%_0x1030fa==0x0&&(_0x2edfa3[_0x109970]=_0x50d779,_0x109970++);});const _0x281b7e=Markup[_0x5d2731(0x23b)](_0x2edfa3);_0xf271d9[_0x5d2731(0x1ce)](_0x5d2731(0x256),_0x281b7e);}}),tgBot[_0x57db33(0x282)](/off_(.+)/,async _0x40c702=>{const _0x1b62be=_0x57db33,_0x2a2cac=_0x40c702[_0x1b62be(0x275)][0x1];_0x40c702[_0x1b62be(0x26b)]();if(_0x2a2cac=='all'){const _0x3f6c20=getEnabledBots();await sendTelegram(_0x40c702[_0x1b62be(0x161)]['id'],_0x1b62be(0x27f)),_0x3f6c20['forEach'](_0x143718=>{const _0x19ddfa=_0x1b62be;if(_0x143718['botID']!='all')toggleBot(_0x143718[_0x19ddfa(0x15c)],toggleStatus(_0x143718['botID']),'stopped');});}else await sendTelegram(_0x40c702[_0x1b62be(0x161)]['id'],_0x1b62be(0x88)+_0x2a2cac),toggleBot(_0x2a2cac,toggleStatus(_0x2a2cac),_0x1b62be(0x105));}),tgBot[_0x57db33(0x234)]('metrics',async _0x544600=>{const _0x418014=_0x57db33,_0x4d66a9=getEnabledBots();if(_0x4d66a9['length']==0x0)await sendTelegram(_0x544600[_0x418014(0x161)]['id'],_0x418014(0x150));else{if(_0x4d66a9['length']>0x1){let _0xa9cc64=[],_0x5b268f=[];const _0x299e94=_0x4d66a9[_0x418014(0x213)]%0x4==0x0||_0x4d66a9['length']%0x4==0x3||_0x4d66a9[_0x418014(0x213)]%0x3==0x1?0x4:0x3;let _0x30f2af=0x0;_0x4d66a9[_0x418014(0x230)]((_0xf8916d,_0x2516dc)=>{const _0xdce6b6=_0x418014;if(_0x2516dc%_0x299e94==0x0)_0x5b268f=[];_0x5b268f[_0xdce6b6(0x184)](Markup['button'][_0xdce6b6(0x268)](_0xdce6b6(0x21f)+_0xf8916d['botID'],'metrics_'+_0xf8916d[_0xdce6b6(0x15c)])),_0x2516dc%_0x299e94==0x0&&(_0xa9cc64[_0x30f2af]=_0x5b268f,_0x30f2af++);});const _0x3c18f3=Markup['inlineKeyboard'](_0xa9cc64);_0x544600[_0x418014(0x1ce)](_0x418014(0x11d),_0x3c18f3);}else{const _0x2e7ee8=_0x4d66a9[0x0]['botID'];if(pid[_0x2e7ee8])pid[_0x2e7ee8]['send']({'function':_0x418014(0x277),'args':null});}}}),tgBot[_0x57db33(0x282)](/metrics_(.+)/,async _0x9c7b91=>{const _0x5bc225=_0x57db33,_0x5a0947=_0x9c7b91[_0x5bc225(0x275)][0x1];_0x9c7b91[_0x5bc225(0x26b)]();if(pid[_0x5a0947])pid[_0x5a0947]['send']({'function':_0x5bc225(0x277),'args':null});}),tgBot[_0x57db33(0x234)](_0x57db33(0xd0),async _0x5ef885=>{const _0x12d66b=_0x57db33,_0x22f938=getEnabledBots();if(_0x22f938[_0x12d66b(0x213)]==0x0)await sendTelegram(_0x5ef885[_0x12d66b(0x161)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x22f938['length']>0x1){let _0x3bb590=[],_0x2de2d6=[];const _0x51f19a=_0x22f938[_0x12d66b(0x213)]%0x4==0x0||_0x22f938[_0x12d66b(0x213)]%0x4==0x3||_0x22f938[_0x12d66b(0x213)]%0x3==0x1?0x4:0x3;let _0x3d9d0b=0x0;_0x22f938[_0x12d66b(0x230)]((_0x46bb87,_0x54d51a)=>{const _0x52ee19=_0x12d66b;if(_0x54d51a%_0x51f19a==0x0)_0x2de2d6=[];_0x2de2d6[_0x52ee19(0x184)](Markup[_0x52ee19(0x1e5)][_0x52ee19(0x268)](_0x52ee19(0x21f)+_0x46bb87['botID'],_0x52ee19(0xa4)+_0x46bb87['botID'])),_0x54d51a%_0x51f19a==0x0&&(_0x3bb590[_0x3d9d0b]=_0x2de2d6,_0x3d9d0b++);});const _0x29084a=Markup[_0x12d66b(0x23b)](_0x3bb590);_0x5ef885['reply'](_0x12d66b(0x116),_0x29084a);}else{const _0x40af5=_0x22f938[0x0]['botID'];if(pid[_0x40af5])pid[_0x40af5]['send']({'function':_0x12d66b(0x1f3),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x1a6f3e=>{const _0x37d8f6=_0x57db33,_0x31689f=_0x1a6f3e[_0x37d8f6(0x275)][0x1];_0x1a6f3e[_0x37d8f6(0x26b)]();if(pid[_0x31689f])pid[_0x31689f]['send']({'function':_0x37d8f6(0x1f3),'args':null});}),tgBot[_0x57db33(0x234)](_0x57db33(0xcd),async _0x22dfeb=>{const _0x4b6c88=_0x57db33;await getMessages();if(!updateAvailable)await sendTelegram(_0x22dfeb[_0x4b6c88(0x161)]['id'],_0x4b6c88(0x11c));else{if(!validInstallation)await sendTelegram(_0x22dfeb[_0x4b6c88(0x161)]['id'],_0x4b6c88(0x17b));else{const _0x374eb5=Markup['inlineKeyboard']([Markup[_0x4b6c88(0x1e5)][_0x4b6c88(0x268)](_0x4b6c88(0x7f),_0x4b6c88(0xe3)),Markup[_0x4b6c88(0x1e5)][_0x4b6c88(0x268)]('No',_0x4b6c88(0x107))]);_0x22dfeb[_0x4b6c88(0x1ce)](_0x4b6c88(0x278),_0x374eb5);}}}),tgBot['action'](/update_(.+)/,async _0x2bee58=>{const _0x23bfd1=_0x57db33,_0x201a37=_0x2bee58['match'][0x1];_0x2bee58[_0x23bfd1(0x26b)](),_0x201a37==_0x23bfd1(0x95)&&(await sendTelegram(_0x2bee58[_0x23bfd1(0x161)]['id'],_0x23bfd1(0x219)),updateBB(_0x23bfd1(0xcd))),_0x201a37=='no'&&await sendTelegram(_0x2bee58['chat']['id'],_0x23bfd1(0x11b));}),tgBot['command'](_0x57db33(0x171),async _0x2cb9fe=>{const _0x25c10f=_0x57db33;if(!validInstallation)await sendTelegram(_0x2cb9fe[_0x25c10f(0x161)]['id'],_0x25c10f(0x19e));else{const _0x481813=Markup[_0x25c10f(0x23b)]([Markup[_0x25c10f(0x1e5)][_0x25c10f(0x268)](_0x25c10f(0x7f),_0x25c10f(0x151)),Markup[_0x25c10f(0x1e5)]['callback']('No','reinstall_no')]);_0x2cb9fe[_0x25c10f(0x1ce)](_0x25c10f(0x1e9),_0x481813);}}),tgBot['action'](/reinstall_(.+)/,async _0x5d9c67=>{const _0xf21778=_0x57db33,_0x393276=_0x5d9c67[_0xf21778(0x275)][0x1];_0x5d9c67[_0xf21778(0x26b)](),_0x393276==_0xf21778(0x95)&&(await sendTelegram(_0x5d9c67[_0xf21778(0x161)]['id'],_0xf21778(0x118)),updateBB(_0xf21778(0x171))),_0x393276=='no'&&await sendTelegram(_0x5d9c67[_0xf21778(0x161)]['id'],_0xf21778(0x185));}),tgBot[_0x57db33(0x234)](_0x57db33(0x1e4),async _0x15760c=>{const _0x53c83b=_0x57db33,_0x50607a=getBotsWithMode();if(_0x50607a[_0x53c83b(0x213)]==0x0)await sendTelegram(_0x15760c['chat']['id'],_0x53c83b(0x150));else{let _0xfd9acf=[],_0x37d8ab=[];const _0x3d2b9b=0x2;let _0x39fb69=0x0;_0x50607a[_0x53c83b(0x230)]((_0x5e430f,_0x4c59b0)=>{const _0x30aeed=_0x53c83b;if(_0x4c59b0%_0x3d2b9b==0x0)_0x37d8ab=[];_0x37d8ab[_0x30aeed(0x184)](Markup[_0x30aeed(0x1e5)]['callback'](_0x30aeed(0x21f)+_0x5e430f[_0x30aeed(0x15c)]+'\x20('+_0x5e430f[_0x30aeed(0x14b)]+')','toggle_'+_0x5e430f[_0x30aeed(0x15c)])),_0x4c59b0%_0x3d2b9b==0x0&&(_0xfd9acf[_0x39fb69]=_0x37d8ab,_0x39fb69++);});const _0x2bec51=Markup[_0x53c83b(0x23b)](_0xfd9acf);_0x15760c[_0x53c83b(0x1ce)](_0x53c83b(0xec),_0x2bec51);}}),tgBot[_0x57db33(0x282)](/toggle_(.+)/,async _0x47d05a=>{const _0x5e8aab=_0x57db33,_0x21eca3=_0x47d05a[_0x5e8aab(0x275)][0x1];_0x47d05a[_0x5e8aab(0x26b)]();const _0x319f76=getBotsWithMode(),_0x37aaf1=_0x319f76[_0x5e8aab(0x284)](_0x1c4ce3=>_0x1c4ce3['botID']==_0x21eca3),_0x5c0f2b=_0x37aaf1[_0x5e8aab(0x14b)]==_0x5e8aab(0x1aa)?_0x5e8aab(0x109):_0x5e8aab(0x1aa);await sendTelegram(_0x47d05a['chat']['id'],_0x5e8aab(0x1b2)+_0x21eca3+_0x5e8aab(0x1dd)+_0x5c0f2b+_0x5e8aab(0x189)),toggleBotMode(_0x21eca3);}),tgBot[_0x57db33(0x234)]('names',async _0x5b2286=>{const _0x1142e1=_0x57db33;let _0x56decc='';config[_0x1142e1(0x230)](_0xf41fd=>{const _0x358925=_0x1142e1;_0x56decc+=_0x358925(0x21f)+_0xf41fd[_0x358925(0x15c)]+':\x20'+_0xf41fd[_0x358925(0xf4)]+'\x0a';}),await sendTelegram(_0x5b2286[_0x1142e1(0x161)]['id'],_0x56decc,{'parse_mode':_0x1142e1(0x289)});}),tgBot['command'](_0x57db33(0x1d3),async _0x543fd0=>{const _0x401b51=_0x57db33;await sendTelegram(_0x543fd0[_0x401b51(0x161)]['id'],_0x45e8be);}),process[_0x57db33(0x1ad)](_0x57db33(0x147),()=>tgBot[_0x57db33(0x267)](_0x57db33(0x147))),process[_0x57db33(0x1ad)](_0x57db33(0x262),()=>tgBot[_0x57db33(0x267)](_0x57db33(0x262))),tgBot[_0x57db33(0x23f)]();}}function disableTelegram(){const _0x15abc0=_0x4c9701;tgBot&&tgBot[_0x15abc0(0x267)]();}async function sendTelegram(_0x8e4cf8,_0x1018ed,_0x330285){const _0x52c415=_0x4c9701;_0x330285={..._0x330285,'disable_web_page_preview':!![]};try{await tgBot[_0x52c415(0x187)][_0x52c415(0x90)](_0x8e4cf8,_0x1018ed,_0x330285);}catch(_0x25a7c4){console[_0x52c415(0x8a)](_0x52c415(0x26f),_0x25a7c4);}}async function sendTelegramBot(_0x3a1b00,_0x29c816){const _0x311763=_0x4c9701;if(settings[_0x311763(0x1e2)]){if(settings[_0x311763(0x11e)]==_0x311763(0xe9)||(_0x29c816[_0x311763(0x22c)]==_0x311763(0x8f)||_0x29c816['type']==_0x311763(0x1c8)||_0x29c816['type']==_0x311763(0x1d5))&&settings[_0x311763(0x11e)]==_0x311763(0x243)||_0x29c816[_0x311763(0x22c)]==_0x311763(0x1a1)&&settings[_0x311763(0x11e)]==_0x311763(0x84)){if(tgBot&&settings['telegramChatId']){if(_0x29c816[_0x311763(0x250)])await sendTelegram(settings['telegramChatId'],_0x29c816[_0x311763(0xf4)]+_0x311763(0x1a3)+_0x29c816[_0x311763(0x1d4)]);else await sendTelegram(settings['telegramChatId'],'Bot\x20'+_0x3a1b00+'\x20>\x20'+_0x29c816['event']);}}}}async function sendTelegramMsg(_0x319eca,_0x504db0=_0x4c9701(0x289)){const _0x1425ea=_0x4c9701;return settings['telegramEnabled']&&tgBot&&settings[_0x1425ea(0x169)]?(await sendTelegram(settings['telegramChatId'],_0x319eca,{'parse_mode':_0x504db0}),!![]):![];}function getDeviceWithIp(_0x317b78){const _0x23eb72=_0x4c9701;return devices[_0x23eb72(0x284)](_0x5ebf24=>_0x5ebf24['ip']===_0x317b78);}async function temporaryAccess2FA(_0x39a70a,_0x3f30b6){const _0x3fd447=_0x4c9701;let _0x58c56f=new Date(),_0x4edd98=![];if(lastIpApproval){if(_0x58c56f-lastIpApproval<0x1388)_0x4edd98=!![];}lastIpApproval=new Date();if(_0x4edd98)return;if(tgBot&&settings[_0x3fd447(0x169)]){const _0x19cf0e=uuidRandom();tmpStorage[_0x19cf0e]={'uuid':_0x39a70a,'externalip':_0x3f30b6};const _0x18c108=Markup[_0x3fd447(0x23b)]([Markup[_0x3fd447(0x1e5)][_0x3fd447(0x268)](_0x3fd447(0xe7),'tempaccess_5_'+_0x19cf0e),Markup[_0x3fd447(0x1e5)][_0x3fd447(0x268)](_0x3fd447(0x1d1),'tempaccess_15_'+_0x19cf0e),Markup[_0x3fd447(0x1e5)][_0x3fd447(0x268)](_0x3fd447(0x178),_0x3fd447(0x1d6)+_0x19cf0e),Markup[_0x3fd447(0x1e5)][_0x3fd447(0x268)](_0x3fd447(0xa6),_0x3fd447(0x20a)+_0x19cf0e)]);await sendTelegram(settings[_0x3fd447(0x169)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x3f30b6)['show']+'\x20?',_0x18c108),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x389522=>{const _0x401bf3=_0x3fd447,_0x37cd2b=_0x389522[_0x401bf3(0x275)][0x1],_0x2314a1=_0x389522['match'][0x2],{uuid:_0x16a6f9,externalip:_0x4dfde6}=tmpStorage[_0x2314a1];delete tmpStorage[_0x2314a1],_0x389522['editMessageReplyMarkup'](),devices[_0x16a6f9][_0x401bf3(0x99)]={'clientip':_0x4dfde6,'timestamp':new Date()[_0x401bf3(0x92)](),'expiry':_0x37cd2b},_0x37cd2b!='reject'?(await sendTelegram(_0x389522[_0x401bf3(0x161)]['id'],_0x401bf3(0xd6)+_0x37cd2b+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x16a6f9)['emit']('status',{'access':{'allow':![],'reason':_0x401bf3(0x121),'token':null}})):(await sendTelegram(_0x389522['chat']['id'],_0x401bf3(0xc5)),io['to'](_0x16a6f9)[_0x401bf3(0x217)](_0x401bf3(0x214),{'access':{'allow':![],'reason':_0x401bf3(0x1ba),'token':null}}));});}}async function loginAccess2FA(_0xdcc2b1,_0x5412e0){const _0x856e92=_0x4c9701;if(tgBot&&settings[_0x856e92(0x169)]){const _0x1ac1f8=uuidRandom();tmpStorage[_0x1ac1f8]={'uuid':_0xdcc2b1,'externalip':_0x5412e0};const _0x1e84db=Markup['inlineKeyboard']([Markup[_0x856e92(0x1e5)][_0x856e92(0x268)]('accept','login2fa_'+loginExpiry+'_'+_0x1ac1f8),Markup[_0x856e92(0x1e5)]['callback'](_0x856e92(0xa6),_0x856e92(0x13d)+_0x1ac1f8)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x5412e0)['show']+'\x20?',_0x1e84db),tgBot[_0x856e92(0x282)](/login2fa_(.+)_(.+)/,async _0x4c0c7c=>{const _0x50fd2f=_0x856e92,_0x1f4319=_0x4c0c7c[_0x50fd2f(0x275)][0x1],_0x5a3a88=_0x4c0c7c[_0x50fd2f(0x275)][0x2],{uuid:_0x2756c2,externalip:_0x24201e}=tmpStorage[_0x5a3a88];delete tmpStorage[_0x5a3a88],_0x4c0c7c[_0x50fd2f(0x26b)](),devices[_0x2756c2]['telegram2FaApproval']={'clientip':_0x24201e,'timestamp':new Date()[_0x50fd2f(0x92)](),'expiry':_0x1f4319},_0x1f4319!=_0x50fd2f(0xa6)?(await sendTelegram(_0x4c0c7c[_0x50fd2f(0x161)]['id'],_0x50fd2f(0x165),{'parse_mode':_0x50fd2f(0x289)}),io['to'](_0x2756c2)[_0x50fd2f(0x217)]('status',{'access':{'allow':![],'reason':_0x50fd2f(0x121),'token':null}})):(await sendTelegram(_0x4c0c7c['chat']['id'],_0x50fd2f(0xf8)),io['to'](_0x2756c2)[_0x50fd2f(0x217)]('status',{'access':{'allow':![],'reason':_0x50fd2f(0x101),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x39cc54=_0x4c9701;return dbConfig['get'](_0x39cc54(0xbd))[_0x39cc54(0x1bd)](_0x39cc54(0x15c))[_0x39cc54(0x23c)]({'status':'enabled'})[_0x39cc54(0x207)]()||[];}function getDisabledBots(){const _0x1741da=_0x4c9701;return dbConfig['get'](_0x1741da(0xbd))[_0x1741da(0x1bd)](_0x1741da(0x15c))[_0x1741da(0x23c)]({'status':_0x1741da(0x24b)})[_0x1741da(0x207)]()||[];}function getBotAttributes(_0x230f0a){const _0x3d2aa8=_0x4c9701;let _0x23c2cb={};const _0x5a440c=configpath+_0x3d2aa8(0x20e)+_0x230f0a+'-config.json',_0x5875db=fs[_0x3d2aa8(0xd3)](_0x5a440c);if(_0x5875db){const _0x4f0ab2=fs['readFileSync'](_0x5a440c);try{const _0x1eb3c3=JSON['parse'](_0x4f0ab2),_0x2e900a=_0x1eb3c3?_0x1eb3c3[_0x3d2aa8(0x13b)][0x0][_0x3d2aa8(0x26d)]:![];_0x23c2cb['mode']=_0x2e900a?'auto':_0x3d2aa8(0x109),_0x23c2cb[_0x3d2aa8(0xf4)]=_0x1eb3c3?_0x1eb3c3[_0x3d2aa8(0x13b)][0x0]['botname']:_0x3d2aa8(0x21f)+_0x230f0a;}catch(_0x32e728){_0x23c2cb['mode']='manual',_0x23c2cb['botname']=_0x3d2aa8(0x21f)+_0x230f0a;}}else _0x23c2cb[_0x3d2aa8(0x14b)]='manual',_0x23c2cb[_0x3d2aa8(0xf4)]=_0x3d2aa8(0x21f)+_0x230f0a;return _0x23c2cb;}function getBotsWithMode(){const _0x159128=_0x4c9701,_0x527e33=dbConfig[_0x159128(0x25a)](_0x159128(0xbd))[_0x159128(0x1bd)]('botID')[_0x159128(0x207)]()||[];return _0x527e33['forEach'](_0x1ff48e=>{const _0x459abd=_0x159128;let _0x243821=getBotAttributes(_0x1ff48e[_0x459abd(0x15c)]);_0x1ff48e['mode']=_0x243821[_0x459abd(0x14b)];}),_0x527e33;}function getBotExchanges(){const _0x5dfaa5=_0x4c9701;let _0x3d3ade=[];const _0x1e59ba=dbConfig[_0x5dfaa5(0x25a)]('bots')[_0x5dfaa5(0x1bd)](_0x5dfaa5(0x15c))['value']()||[];_0x1e59ba[_0x5dfaa5(0x230)](_0x4d0bc0=>{const _0x3faf95=_0x5dfaa5;if(_0x4d0bc0[_0x3faf95(0x214)]==_0x3faf95(0x12d)){const _0x425ee5=configpath+'bot-'+_0x4d0bc0[_0x3faf95(0x15c)]+_0x3faf95(0xd1),_0x5b4034=fs[_0x3faf95(0xd3)](_0x425ee5);let _0x2e5132;if(_0x5b4034){const _0x226602=fs[_0x3faf95(0x168)](_0x425ee5);try{const _0xe66778=JSON[_0x3faf95(0x27d)](_0x226602);_0x2e5132=_0xe66778?_0xe66778[_0x3faf95(0x13b)][0x0]['exchange']:null;}catch(_0x463333){}}if(_0x2e5132)_0x3d3ade[_0x3faf95(0x184)](_0x2e5132);}});const _0x4ddddd=[...new Set(_0x3d3ade)]['sort']();return _0x4ddddd;}async function initUser(){const _0x4b088d=_0x4c9701;if(!settings[_0x4b088d(0x1d7)]){const _0x23f6b8=uuidRandom();mixpanel[_0x4b088d(0xf0)](_0x23f6b8),updateSetting('userid',_0x23f6b8);}}async function initSecure(){const _0x1a0bdb=_0x4c9701;let _0x2a0130=getSecure();if(!_0x2a0130[_0x1a0bdb(0x195)](_0x1a0bdb(0x229))){let _0x2e3716=await generateKeys();_0x2a0130[_0x1a0bdb(0x126)]=_0x2e3716[_0x1a0bdb(0x126)],_0x2a0130[_0x1a0bdb(0x128)]=_0x2e3716[_0x1a0bdb(0x128)],_0x2a0130['secret']=crypto[_0x1a0bdb(0xae)](0x20)[_0x1a0bdb(0x112)](_0x1a0bdb(0xb5));;storeSecure(_0x2a0130);}}function getSettings(){const _0x4a01ec=_0x4c9701;return dbSettings['get'](_0x4a01ec(0x1c7))[_0x4a01ec(0x207)]()||{};}function getSecure(){const _0x15155c=_0x4c9701;return dbSecure[_0x15155c(0x25a)](_0x15155c(0x26e))['value']()||{};}function getBlacklist(){const _0x190e9e=_0x4c9701;return dbSecure[_0x190e9e(0x25a)](_0x190e9e(0x183))[_0x190e9e(0x207)]()||[];}function broadcastToBots(_0x549c09,_0x2bbbe1){const _0xbdc61c=_0x4c9701;config[_0xbdc61c(0x230)](_0x17fcca=>{const _0x5b0a64=_0xbdc61c;if(_0x17fcca[_0x5b0a64(0x214)]==_0x5b0a64(0x12d)&&_0x17fcca['live']==_0x5b0a64(0x160)||_0x17fcca[_0x5b0a64(0x214)]==_0x5b0a64(0xfa)&&_0x17fcca['live']==_0x5b0a64(0x160)){if(pid[_0x17fcca[_0x5b0a64(0x15c)]])pid[_0x17fcca[_0x5b0a64(0x15c)]][_0x5b0a64(0x132)]({[_0x549c09]:_0x2bbbe1});}});}async function storeSettings(_0x4a48e2,_0x8c27bc=![]){const _0x2f4211=_0x4c9701;_0x4a48e2={...settings,..._0x4a48e2};if(_0x8c27bc&&_0x4a48e2[_0x2f4211(0x1df)]!=_0x2f4211(0x23d)&&_0x4a48e2[_0x2f4211(0x1df)]!='***'&&_0x4a48e2[_0x2f4211(0x1df)]!=''){const _0x58660e=crypt['decrypt'](secure['privateKey'],_0x4a48e2[_0x2f4211(0x1df)])[_0x2f4211(0xef)][_0x2f4211(0xde)]('|@|')[0x0],_0x2c4f16=bcrypt[_0x2f4211(0x156)](_0x58660e,saltRounds);_0x4a48e2={..._0x4a48e2,'bbPassword':_0x2c4f16};}if(_0x8c27bc&&_0x4a48e2[_0x2f4211(0xc8)]!='************'&&_0x4a48e2[_0x2f4211(0xc8)]!=_0x2f4211(0x1c5)&&_0x4a48e2[_0x2f4211(0xc8)]!=''){const _0x2277ad=crypt[_0x2f4211(0x1a8)](secure['privateKey'],_0x4a48e2[_0x2f4211(0xc8)])['message'][_0x2f4211(0xde)](_0x2f4211(0x136))[0x0];_0x4a48e2={..._0x4a48e2,'telegramToken':_0x2277ad};}if(_0x8c27bc&&_0x4a48e2[_0x2f4211(0x244)]!='************'&&_0x4a48e2['marketcapApi']!='***'&&_0x4a48e2[_0x2f4211(0x244)]!=''){const _0x5608fb=crypt[_0x2f4211(0x1a8)](secure[_0x2f4211(0x128)],_0x4a48e2['marketcapApi'])[_0x2f4211(0xef)][_0x2f4211(0xde)]('|@|')[0x0];_0x4a48e2={..._0x4a48e2,'marketcapApi':_0x5608fb};}const _0x51bca6=_0x4a48e2['telegramToken']!=_0x2f4211(0x23d)&&_0x4a48e2[_0x2f4211(0xc8)]!=settings[_0x2f4211(0xc8)]||_0x4a48e2[_0x2f4211(0x149)]!=settings[_0x2f4211(0x149)],_0xff0623=_0x4a48e2[_0x2f4211(0xc8)]==''||_0x4a48e2[_0x2f4211(0x149)]=='',_0x34a2ef=_0x4a48e2[_0x2f4211(0x244)]&&_0x4a48e2[_0x2f4211(0x244)]!=_0x2f4211(0x23d)&&_0x4a48e2[_0x2f4211(0x244)]!=settings[_0x2f4211(0xc8)];_0x51bca6&&(_0x4a48e2[_0x2f4211(0x169)]=null,_0x4a48e2['telegramEvents']=_0x2f4211(0xe9));for(const [_0x344cab,_0x213098]of Object[_0x2f4211(0x1a0)](_0x4a48e2)){if(_0x344cab==_0x2f4211(0xc8)&&_0x213098==_0x2f4211(0x23d)){_0x4a48e2['telegramToken']=settings[_0x2f4211(0xc8)];continue;};if(_0x344cab==_0x2f4211(0x1df)&&_0x213098==_0x2f4211(0x23d)){_0x4a48e2[_0x2f4211(0x1df)]=settings[_0x2f4211(0x1df)];continue;};if(_0x344cab=='marketcapApi'&&_0x213098==_0x2f4211(0x23d)){_0x4a48e2['marketcapApi']=settings['marketcapApi'];continue;};dbSettings[_0x2f4211(0x1e3)]('settings.'+_0x344cab,_0x213098)['write']();}settings=_0x4a48e2,io['to'](_0x2f4211(0x237))['emit'](_0x2f4211(0x1c7),cleanSettings()),broadcastToBots(_0x2f4211(0x1fb),settings[_0x2f4211(0x1fb)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots(_0x2f4211(0x244),settings[_0x2f4211(0x244)]);if(_0x51bca6&&!_0xff0623)initTelegram();if(_0x51bca6&&_0xff0623)disableTelegram();getAllClients()[_0x2f4211(0x230)](_0x109a75=>{const _0x4cb2b3=_0x2f4211;getSocket(_0x109a75['id'])[_0x4cb2b3(0x217)](_0x4cb2b3(0x214),{'access':{'allow':![],'reason':_0x4cb2b3(0x121),'token':null}});}),_0x34a2ef&&(await sleep(0xbb8),testMarketcapApi(_0x4a48e2[_0x2f4211(0x244)]));}async function testMarketcapApi(_0x55ead0){const _0x526a6a=_0x4c9701,_0x11b140=['BCT',_0x526a6a(0x231)];try{await axios[_0x526a6a(0x25a)](_0x526a6a(0x24d),{'headers':{'X-CMC_PRO_API_KEY':_0x55ead0},'params':{'symbol':_0x11b140[_0x526a6a(0x112)]()}});}catch(_0x1ddba2){_0x1ddba2['toString']()[_0x526a6a(0x1e6)](_0x526a6a(0x281))?(io['to']('botmanager')['emit'](_0x526a6a(0xd4),_0x526a6a(0x194)),logger[_0x526a6a(0x1a7)](_0x526a6a(0x194))):(io['to'](_0x526a6a(0x237))[_0x526a6a(0x217)]('notification',_0x526a6a(0x196)),logger[_0x526a6a(0x1a7)](_0x526a6a(0x196)),logger[_0x526a6a(0x276)](_0x526a6a(0x261),_0x1ddba2[_0x526a6a(0x112)]()+'\x20-\x20'+_0x1ddba2['code']));return;}logger[_0x526a6a(0x276)](_0x526a6a(0x27b));}function updateSetting(_0x3741a3,_0x295a01){const _0x1eb653=_0x4c9701;dbSettings[_0x1eb653(0x1e3)](_0x1eb653(0x1b9)+_0x3741a3,_0x295a01)[_0x1eb653(0x265)](),settings=getSettings(),io['to'](_0x1eb653(0x237))['emit']('settings',cleanSettings());}function storeSecure(_0x4d1fda){const _0x5babd3=_0x4c9701;dbSecure[_0x5babd3(0x25a)](_0x5babd3(0x26e))[_0x5babd3(0x184)](_0x4d1fda)['write'](),secure=_0x4d1fda;}function addBlacklist(_0x53604d){const _0x30a996=_0x4c9701;cleanBlacklist();let _0x1cf0f7;devices[_0x53604d][_0x30a996(0x99)]?_0x1cf0f7=Math['max'](devices[_0x53604d][_0x30a996(0x99)][_0x30a996(0x80)],loginExpiry):_0x1cf0f7=loginExpiry,dbSecure[_0x30a996(0x25a)](_0x30a996(0x183))[_0x30a996(0x184)]({'expiry':new Date()[_0x30a996(0x92)]()+_0x1cf0f7*0x3c*0x3e8,'token':devices[_0x53604d]['access'][_0x30a996(0x8d)]})['write'](),blacklist=dbSecure[_0x30a996(0x25a)](_0x30a996(0x183))[_0x30a996(0x207)]();}function cleanBlacklist(){const _0x509153=_0x4c9701;let _0x2e0eb9=dbSecure[_0x509153(0x25a)](_0x509153(0x183))['cloneDeep']()[_0x509153(0x207)](),_0x3cdd21=new Date()['getTime']();_0x2e0eb9['forEach'](_0x2485cf=>{const _0x32f9c0=_0x509153;_0x2485cf[_0x32f9c0(0x80)]<_0x3cdd21&&dbSecure[_0x32f9c0(0x25a)](_0x32f9c0(0x183))['remove']({'expiry':_0x2485cf[_0x32f9c0(0x80)]})['write']();});}function initStates(){let _0x961b13=getConfiguration();_0x961b13['forEach'](_0x511a00=>{const _0x2223e7=_0x1bd5;_0x511a00[_0x2223e7(0x182)]=_0x2223e7(0x105);}),storeConfiguration(_0x961b13);}function onKeys(){const _0x54c738=new RSA();return new Promise(_0x22fdd1=>{const _0x27da5a=_0x1bd5;_0x54c738['generateKeyPairAsync']()[_0x27da5a(0x131)](_0x83c0f2=>{_0x22fdd1(_0x83c0f2);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x627328=_0x4c9701;let _0xfedd2c=getSettings(),_0xd6fb6a=![];!_0xfedd2c[_0x627328(0x195)](_0x627328(0x21c))&&(_0xfedd2c[_0x627328(0x21c)]=0x0,_0xd6fb6a=!![]);!_0xfedd2c[_0x627328(0x195)](_0x627328(0xb8))&&(_0xfedd2c['lastmsgemitted']=0x0,_0xd6fb6a=!![]);!_0xfedd2c[_0x627328(0x195)](_0x627328(0x1f0))&&(_0xfedd2c['latestversion']='0.0.0',_0xd6fb6a=!![]);!_0xfedd2c[_0x627328(0x195)](_0x627328(0x148))&&(_0xfedd2c[_0x627328(0x148)]=![],_0xd6fb6a=!![]);!_0xfedd2c['hasOwnProperty']('marketcapApi')&&(_0xfedd2c[_0x627328(0x244)]='',_0xd6fb6a=!![]);if(_0xd6fb6a)storeSettings(_0xfedd2c);try{fs[_0x627328(0x102)](configbackuppath,{'withFileTypes':!![]})[_0x627328(0x230)](_0x541ec9=>{const _0x3ced52=_0x627328;if(!_0x541ec9[_0x3ced52(0x205)]()){if(!_0x541ec9[_0x3ced52(0x8e)][_0x3ced52(0x19d)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x541ec9[_0x3ced52(0x8e)]);}else fs[_0x3ced52(0x220)](configbackuppath+_0x541ec9[_0x3ced52(0x8e)],{'recursive':!![]});});}catch(_0x4b7b49){logger[_0x627328(0x276)](_0x627328(0x86),_0x4b7b49);}}function storeConfiguration(_0x2f2338){const _0x1af962=_0x4c9701;dbConfig[_0x1af962(0x25a)](_0x1af962(0xbd))['remove']()[_0x1af962(0x265)](),dbConfig['get'](_0x1af962(0xbd))[_0x1af962(0x184)](..._0x2f2338)[_0x1af962(0x265)](),config=_0x2f2338;}async function resetPassword(){const _0x57497a=_0x4c9701;if(tgBot&&settings['telegramChatId']){const _0x1becfc=Markup[_0x57497a(0x23b)]([Markup[_0x57497a(0x1e5)][_0x57497a(0x268)](_0x57497a(0x95),_0x57497a(0xd2)),Markup[_0x57497a(0x1e5)]['callback']('no',_0x57497a(0x27e))]);await sendTelegram(settings['telegramChatId'],_0x57497a(0x1f7),_0x1becfc),tgBot[_0x57497a(0x282)](/resetpw_(.+)/,async _0xff8199=>{const _0x2f3905=_0x57497a,_0x7b3f8d=_0xff8199[_0x2f3905(0x275)][0x1];_0xff8199[_0x2f3905(0x26b)]();if(_0x7b3f8d!='no'){const _0x1ac544=0xf,_0x497b76='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0xdd0c7f=Array['from'](crypto[_0x2f3905(0x1f9)](new Uint32Array(_0x1ac544)))['map'](_0x33ac68=>_0x497b76[_0x33ac68%_0x497b76[_0x2f3905(0x213)]])[_0x2f3905(0x1c2)](''),_0x28d5ba=bcrypt[_0x2f3905(0x156)](_0xdd0c7f,saltRounds);storeSettings({'bbPassword':_0x28d5ba}),await sendTelegram(_0xff8199['chat']['id'],_0x2f3905(0x111)+_0xdd0c7f,{'parse_mode':_0x2f3905(0x289)});}else await sendTelegram(_0xff8199[_0x2f3905(0x161)]['id'],_0x2f3905(0x10b));});}}async function confirmRestore(_0x33b989,_0x448d33){const _0x4e3231=_0x4c9701;io['to'](_0x4e3231(0x237))[_0x4e3231(0x217)]('notification',_0x4e3231(0x21d),'success');if(tgBot&&settings['telegramChatId']){const _0xcff425=uuidRandom();tmpStorage[_0xcff425]={'path':_0x33b989,'filename':_0x448d33};const _0x562572=Markup['inlineKeyboard']([Markup['button'][_0x4e3231(0x268)](_0x4e3231(0x95),'restore_yes_'+_0xcff425),Markup[_0x4e3231(0x1e5)][_0x4e3231(0x268)]('no','restore_no_'+_0xcff425)]);await sendTelegram(settings[_0x4e3231(0x169)],_0x4e3231(0x18e),_0x562572),tgBot[_0x4e3231(0x282)](/restore_(.+)_(.+)/,async _0x18152d=>{const _0x1f8807=_0x4e3231,_0x42cee4=_0x18152d[_0x1f8807(0x275)][0x1],_0x8d054b=_0x18152d[_0x1f8807(0x275)][0x2],{path:_0x68ab36,filename:_0x592043}=tmpStorage[_0x8d054b];delete tmpStorage[_0x8d054b],_0x18152d[_0x1f8807(0x26b)](),_0x42cee4==_0x1f8807(0x95)?(logger['debug'](_0x1f8807(0x122)),await sendTelegram(_0x18152d[_0x1f8807(0x161)]['id'],_0x1f8807(0x18a),{'parse_mode':_0x1f8807(0x289)}),unzipFile(_0x68ab36,_0x592043)):(logger[_0x1f8807(0x276)](_0x1f8807(0x17c)),await sendTelegram(_0x18152d['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x4bd699=_0x4c9701,_0x5b01d5=new Date();return _0x5b01d5['getFullYear']()+'/'+(_0x5b01d5[_0x4bd699(0x273)]()+0x1)[_0x4bd699(0x112)]()[_0x4bd699(0x20b)](0x2,'0')+'/'+_0x5b01d5['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x5b01d5[_0x4bd699(0x206)]()[_0x4bd699(0x112)]()[_0x4bd699(0x20b)](0x2,'0')+':'+_0x5b01d5['getMinutes']()[_0x4bd699(0x112)]()[_0x4bd699(0x20b)](0x2,'0')+':'+_0x5b01d5[_0x4bd699(0xf6)]()['toString']()[_0x4bd699(0x20b)](0x2,'0');}function getTimeStamp(){const _0x59b38c=_0x4c9701,_0x1efb28=shiftedTime();return _0x1efb28[_0x59b38c(0x1f6)]()+'/'+(_0x1efb28['getMonth']()+0x1)[_0x59b38c(0x112)]()['padStart'](0x2,'0')+'/'+_0x1efb28[_0x59b38c(0x26a)]()[_0x59b38c(0x112)]()[_0x59b38c(0x20b)](0x2,'0')+'\x20'+_0x1efb28[_0x59b38c(0x206)]()[_0x59b38c(0x112)]()[_0x59b38c(0x20b)](0x2,'0')+':'+_0x1efb28['getMinutes']()[_0x59b38c(0x112)]()[_0x59b38c(0x20b)](0x2,'0')+':'+_0x1efb28[_0x59b38c(0xf6)]()[_0x59b38c(0x112)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x412cc0=_0x4c9701,_0x336ae5=shiftedTime();return _0x336ae5['getFullYear']()+(_0x336ae5[_0x412cc0(0x273)]()+0x1)['toString']()[_0x412cc0(0x20b)](0x2,'0')+_0x336ae5[_0x412cc0(0x26a)]()[_0x412cc0(0x112)]()['padStart'](0x2,'0')+'-'+_0x336ae5[_0x412cc0(0x206)]()[_0x412cc0(0x112)]()[_0x412cc0(0x20b)](0x2,'0')+_0x336ae5[_0x412cc0(0x28e)]()[_0x412cc0(0x112)]()[_0x412cc0(0x20b)](0x2,'0')+_0x336ae5[_0x412cc0(0xf6)]()['toString']()[_0x412cc0(0x20b)](0x2,'0');}function shiftedTime(){const _0x27223a=_0x4c9701,_0x1b7bc0=new Date();let _0x3d607a=_0x1b7bc0;if(settings[_0x27223a(0x1fb)]&&settings['timeshift']!==0x0)_0x3d607a=fns['add'](_0x1b7bc0,{'hours':settings[_0x27223a(0x1fb)]});return _0x3d607a;}async function startScheduler(){const _0x35ec5a=_0x4c9701,_0x5a6fb2=new Date()[_0x35ec5a(0x203)](),_0x4854e0=shiftedTime()[_0x35ec5a(0x206)]();_0x4854e0==0x4&&backupConfigFiles(),_0x4854e0==0x0&&rotateLogFiles(),_0x5a6fb2%0x6==0x0&&triggerAnalytics(),_0x5a6fb2%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x520454){const _0x128294=_0x4c9701;logger[_0x128294(0x276)]('Restore\x20backup\x20file\x20'+_0x520454);const _0x1b4e01=getBotsWithMode();_0x1b4e01[_0x128294(0x213)]>0x0?confirmRestore(configbackuppath,_0x520454):unzipFile(configbackuppath,_0x520454);}async function getBackupFiles(_0x533dc3=null){const _0x59896d=_0x4c9701;let _0x58a499=[],_0x2f9535=fs[_0x59896d(0x102)](configbackuppath,{'withFileTypes':!![]});_0x2f9535[_0x59896d(0xb7)]((_0x3a8c87,_0x14e61d)=>_0x3a8c87[_0x59896d(0x8e)]<_0x14e61d['name']?0x1:_0x14e61d[_0x59896d(0x8e)]<_0x3a8c87[_0x59896d(0x8e)]?-0x1:0x0),_0x2f9535[_0x59896d(0x230)](_0x13474c=>{const _0x3a7b35=_0x59896d;if(!_0x13474c[_0x3a7b35(0x205)]()&&_0x13474c[_0x3a7b35(0x8e)][_0x3a7b35(0x19d)](_0x3a7b35(0xe8))&&_0x13474c['name'][_0x3a7b35(0x21b)]('.zip')){const _0x3cfb98=formatDate(fs[_0x3a7b35(0x215)](configbackuppath+_0x13474c[_0x3a7b35(0x8e)])[_0x3a7b35(0x222)]);_0x58a499[_0x3a7b35(0x184)]({'name':_0x13474c['name'],'mtime':_0x3cfb98});}});if(_0x533dc3)io['to'](_0x533dc3)[_0x59896d(0x217)](_0x59896d(0xdb),_0x58a499);else return _0x58a499;}async function backupConfigFiles(){const _0x4c54b2=_0x4c9701;await zipFiles(_0x4c54b2(0xd7));const _0x108cf8=getCleanTimeStamp();fs[_0x4c54b2(0x1ee)](zippath+_0x4c54b2(0x238),configbackuppath+('backup-full@'+_0x108cf8+'.zip'));let _0x124dd5=fs[_0x4c54b2(0x102)](configbackuppath,{'withFileTypes':!![]});_0x124dd5[_0x4c54b2(0xb7)]((_0x5044d3,_0x483b0b)=>_0x5044d3[_0x4c54b2(0x8e)]<_0x483b0b[_0x4c54b2(0x8e)]?0x1:_0x483b0b['name']<_0x5044d3[_0x4c54b2(0x8e)]?-0x1:0x0),_0x124dd5[_0x4c54b2(0x213)]>maxBackups&&fs[_0x4c54b2(0x18d)](configbackuppath+_0x124dd5[_0x124dd5[_0x4c54b2(0x213)]-0x1][_0x4c54b2(0x8e)]);}function rotateLogFiles(){const _0x27aa55=_0x4c9701,_0x3a3eed=fs[_0x27aa55(0x215)](logspath+_0x27aa55(0x11a)),_0x27bfcb=_0x3a3eed[_0x27aa55(0x142)]/0x400;if(_0x27bfcb>0x64){let _0x43be49=fs[_0x27aa55(0x102)](logspath,{'withFileTypes':!![]});_0x43be49[_0x27aa55(0xb7)]((_0x3650c2,_0x2fc3cf)=>_0x3650c2[_0x27aa55(0x8e)]<_0x2fc3cf[_0x27aa55(0x8e)]?0x1:_0x2fc3cf[_0x27aa55(0x8e)]<_0x3650c2[_0x27aa55(0x8e)]?-0x1:0x0),_0x43be49[_0x27aa55(0x230)](_0x4e0f86=>{const _0x1a0dc1=_0x27aa55;if(_0x4e0f86['name']==_0x1a0dc1(0xc7))fs[_0x1a0dc1(0x1ee)](logspath+_0x4e0f86[_0x1a0dc1(0x8e)],logspath+_0x1a0dc1(0x235));if(_0x4e0f86['name']=='output-001.log')fs[_0x1a0dc1(0x1ee)](logspath+_0x4e0f86[_0x1a0dc1(0x8e)],logspath+_0x1a0dc1(0xc7));_0x4e0f86['name']==_0x1a0dc1(0x11a)&&(fs['copyFileSync'](logspath+_0x4e0f86[_0x1a0dc1(0x8e)],logspath+_0x1a0dc1(0x223)),fs[_0x1a0dc1(0x12c)](logspath+_0x4e0f86['name'],''));});}}async function zipFiles(_0xae9d2a){const _0x14f8b8=_0x4c9701;let _0x2e0f23;if(_0xae9d2a==_0x14f8b8(0x1eb))_0x2e0f23=logspath;if(_0xae9d2a==_0x14f8b8(0xa0))_0x2e0f23=configpath;if(_0xae9d2a==_0x14f8b8(0xd7))_0x2e0f23=configpath;let _0x32b1de=fs[_0x14f8b8(0x102)](_0x2e0f23,{'withFileTypes':!![]});const _0x5d91f8=new require(_0x14f8b8(0x117))();_0x32b1de[_0x14f8b8(0x230)](_0x463ba6=>{const _0x23168c=_0x14f8b8;if(!_0x463ba6[_0x23168c(0x205)]()){let _0x473161=fs['readFileSync'](_0x2e0f23+_0x463ba6[_0x23168c(0x8e)]);if(_0xae9d2a==_0x23168c(0xa0)){const _0x5d0418=/^bot-[0-9]{3}-config.json$/,_0x584a9b=_0x5d0418[_0x23168c(0x247)](_0x463ba6[_0x23168c(0x8e)]);if(_0x584a9b){const _0x216ae6=JSON[_0x23168c(0x27d)](_0x473161);if(_0x216ae6['bot'][0x0]){_0x216ae6[_0x23168c(0x13b)][0x0]['apiKey']=_0x23168c(0x1c5),_0x216ae6['bot'][0x0][_0x23168c(0x113)]='***';if(_0x216ae6[_0x23168c(0x13b)][0x0]['apiPassword'])_0x216ae6[_0x23168c(0x13b)][0x0][_0x23168c(0x25d)]=_0x23168c(0x1c5);}_0x473161=JSON[_0x23168c(0xe5)](_0x216ae6,null,0x2);}if(_0x463ba6[_0x23168c(0x8e)]==_0x23168c(0xf2)){const _0x5c233f=JSON['parse'](_0x473161);if(_0x5c233f['settings'][_0x23168c(0xbc)])_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0xbc)]=![];if(_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0x1df)])_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0x1df)]='***';if(_0x5c233f[_0x23168c(0x1c7)]['telegramToken'])_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0xc8)]=_0x23168c(0x1c5);if(_0x5c233f[_0x23168c(0x1c7)]['telegramChatId'])_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0x169)]=null;if(_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0x244)])_0x5c233f[_0x23168c(0x1c7)][_0x23168c(0x244)]=_0x23168c(0x1c5);_0x473161=JSON['stringify'](_0x5c233f,null,0x2);}if(_0x463ba6[_0x23168c(0x8e)]!=_0x23168c(0x251))_0x5d91f8['file'](_0x463ba6[_0x23168c(0x8e)],_0x473161);}else _0x5d91f8[_0x23168c(0x14a)](_0x463ba6[_0x23168c(0x8e)],_0x473161);}});const _0x270107=_0x5d91f8[_0x14f8b8(0x283)]({'base64':![],'compression':_0x14f8b8(0x140)});fs['writeFileSync'](zippath+(_0xae9d2a+_0x14f8b8(0x179)),_0x270107,_0x14f8b8(0x202));}async function unzipFile(_0x1cca55,_0x594c4c){const _0x15c396=_0x4c9701;fs[_0x15c396(0x102)](configpath,{'withFileTypes':!![]})[_0x15c396(0x230)](_0x293149=>{const _0x1d0ccb=_0x15c396;if(!_0x293149[_0x1d0ccb(0x205)]())fs['rmSync'](configpath+_0x293149[_0x1d0ccb(0x8e)]);});const _0x1da05a=fs['readFileSync'](_0x1cca55+_0x594c4c,_0x15c396(0x202)),_0x469985=new require('node-zip')(_0x1da05a,{'base64':![],'checkCRC32':!![]});Object[_0x15c396(0x1b5)](_0x469985[_0x15c396(0xbe)])[_0x15c396(0x230)](_0x110c6e=>{const _0x202b4e=_0x15c396,_0x1b9979=_0x469985[_0x202b4e(0xbe)][_0x110c6e];fs[_0x202b4e(0x12c)](configpath+_0x1b9979[_0x202b4e(0x8e)],_0x1b9979[_0x202b4e(0x1da)]);}),fs[_0x15c396(0x102)](temppath,{'withFileTypes':!![]})[_0x15c396(0x230)](_0x11b48f=>{const _0x2c238e=_0x15c396;if(!_0x11b48f[_0x2c238e(0x205)]())fs[_0x2c238e(0x220)](temppath+_0x11b48f[_0x2c238e(0x8e)]);}),logger['debug'](_0x15c396(0x15d)),process['send']({'restore':!![]},_0x1743fe=>{});}async function getPublicIp(){const _0x42fe8a=_0x4c9701;try{const _0x9c1b58=await axios[_0x42fe8a(0x25a)]('https://api.ipify.org?format=json');publicip=_0x9c1b58['data']['ip'];}catch(_0x3a394e){}}async function triggerAnalytics(){const _0x579195=_0x4c9701;if(!publicip)await getPublicIp();const _0x621b25=getBotsWithMode();let _0x129fe2=0x0;_0x621b25[_0x579195(0x230)](_0xe51531=>{const _0x2d9fc4=_0x579195;if(_0xe51531[_0x2d9fc4(0x214)]===_0x2d9fc4(0x12d))_0x129fe2++;});const _0x423c32=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x621b25['length'],'numbotsenabled':_0x129fe2,'exchanges':_0x423c32,'environment':environment});}async function getMessages(){const _0x521da8=_0x4c9701,_0x29ca12='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x28fe44=new GraphQLClient(_0x29ca12),_0x21aa1d={'authorization':_0x521da8(0x20f)},_0x55f54d=serverversion['split']('.'),_0x1c7180=_0x55f54d[0x0]+'.'+_0x55f54d[0x1],_0x2e1772=Math['min'](settings[_0x521da8(0x21c)],settings['lastmsgemitted']),_0x236236={'last':parseInt(_0x2e1772),'bbm':_0x1c7180},_0x456fe5=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x28db2c;try{_0x28db2c=await _0x28fe44[_0x521da8(0xf5)](_0x456fe5,_0x236236,_0x21aa1d);}catch(_0x3802fa){}if(_0x28db2c&&_0x28db2c[_0x521da8(0x93)]){let _0xbc412f=settings[_0x521da8(0x21c)];newMessages=[];for(const _0x19bc73 of _0x28db2c['messages']){newMessages[_0x521da8(0x184)](_0x19bc73);let _0x44ab31=![];_0x19bc73['bbvNew']&&(updateSetting(_0x521da8(0x1f0),_0x19bc73[_0x521da8(0x137)]),_0x44ab31=isNewerVersion(serverversion,_0x19bc73[_0x521da8(0x137)])||serverversion==_0x19bc73[_0x521da8(0x137)]);if(!_0x44ab31&&_0x19bc73[_0x521da8(0x125)]>_0xbc412f){if(_0x19bc73[_0x521da8(0x106)]===_0x521da8(0xbf)||serverversion[_0x521da8(0x19d)](_0x19bc73[_0x521da8(0x106)])){let _0x45ca9e=''+_0x19bc73['title']+'\x0a\x0a'+_0x19bc73[_0x521da8(0xef)];const _0x3c13b2=await sendTelegramMsg(toTelegramMarkdown(_0x45ca9e),_0x521da8(0x133));if(_0x3c13b2)_0xbc412f=_0x19bc73[_0x521da8(0x125)];}}}updateAvailable=isNewerVersion(settings[_0x521da8(0x1f0)],serverversion),updateSetting(_0x521da8(0x21c),_0xbc412f),emitMessages();}}function emitMessages(){const _0xdab3dc=_0x4c9701,_0x3567f3=settings[_0xdab3dc(0xb8)];let _0x155a38=[];newMessages[_0xdab3dc(0x230)](_0x42bd1d=>{const _0x1052db=_0xdab3dc;_0x42bd1d[_0x1052db(0x125)]>_0x3567f3&&_0x155a38[_0x1052db(0x184)](_0x42bd1d);}),_0x155a38[_0xdab3dc(0x213)]>0x0&&getAllClients()['forEach'](_0x4d9425=>{const _0x1ad9bf=_0xdab3dc;getSocket(_0x4d9425['id'])[_0x1ad9bf(0x217)](_0x1ad9bf(0xef),_0x155a38);});}function confirmMessage(_0x482804){const _0x1e0a5f=_0x4c9701;updateSetting(_0x1e0a5f(0xb8),Number(_0x482804));}function isNewerVersion(_0x1b66ca,_0x2eca3d){const _0x204e7e=_0x4c9701,_0x42b96d=_0x2eca3d['split']('.'),_0x251d48=_0x1b66ca[_0x204e7e(0xde)]('.');for(var _0xd44cef=0x0;_0xd44cef<_0x251d48['length'];_0xd44cef++){const _0x477594=~~_0x251d48[_0xd44cef],_0xfe3d09=~~_0x42b96d[_0xd44cef];if(_0x477594>_0xfe3d09)return!![];if(_0x477594<_0xfe3d09)return![];}return![];}function toTelegramMarkdown(_0x24e8ba){const _0x4b5bb8=_0x4c9701,_0x49c6eb=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x23d2a6=/\*{2}(.+?)\*{2}/gim;return _0x24e8ba=_0x24e8ba[_0x4b5bb8(0x1f4)](_0x49c6eb,'$1_$2_$3')[_0x4b5bb8(0x1f4)](_0x23d2a6,_0x4b5bb8(0x21a)),_0x24e8ba;}async function validateConfigFile(){const _0x1676b6=_0x4c9701,_0x58b96a=dbConfig[_0x1676b6(0x25a)](_0x1676b6(0xbd))[_0x1676b6(0x1bd)](_0x1676b6(0x15c))['value']()||[];if(_0x58b96a[_0x1676b6(0x213)]==0x0){let _0x3130c0=0x0,_0x181f52=[];const _0xdd1365=/^bot-([0-9]{3})-config.json$/,_0x1f491c=fs['readdirSync'](configpath);_0x1f491c[_0x1676b6(0x230)](_0x4c87df=>{const _0x5f47e8=_0x1676b6,_0x5d88a2=_0xdd1365[_0x5f47e8(0x254)](_0x4c87df);if(_0x5d88a2){const _0x59e825=_0x5d88a2[0x1];let _0x114e04=getBotAttributes(_0x59e825);_0x181f52[_0x5f47e8(0x184)]({'botID':_0x59e825,'botname':_0x114e04['botname'],'status':_0x5f47e8(0x24b),'live':_0x5f47e8(0x105)}),_0x3130c0++;}}),_0x3130c0!=0x0&&(dbConfig[_0x1676b6(0x25a)]('bots')[_0x1676b6(0xee)](_0x181f52)[_0x1676b6(0x265)](),config=_0x181f52,restoredConfigFile=_0x3130c0);}}async function restoreConfigNotify(_0x2b2e7a){const _0x250de0=_0x4c9701;let _0x30e914;if(restoredConfigFile==0x1)_0x30e914=_0x250de0(0x14c);else _0x30e914='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x2b2e7a)io['to'](_0x250de0(0x237))[_0x250de0(0x217)](_0x250de0(0xd4),_0x30e914);else{logger['simple'](_0x250de0(0x24f)),logger[_0x250de0(0x266)](_0x30e914),logger[_0x250de0(0x266)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x250de0(0x169)]&&settings['telegramEvents']!=_0x250de0(0x84))await sendTelegram(settings[_0x250de0(0x169)],_0x250de0(0xc3)+_0x30e914);}}function validateCredentials(_0x16a61c,_0x81b598){const _0x1f8043=_0x4c9701;if(_0x16a61c['username']==settings[_0x1f8043(0x28f)]&&bcrypt[_0x1f8043(0x257)](_0x16a61c['password'],settings[_0x1f8043(0x1df)])){if(settings[_0x1f8043(0xa8)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x40e0e5=generateLoginToken(_0x81b598);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x40e0e5};}}else return{'allow':![],'reason':_0x1f8043(0x26c),'token':null};}function refreshToken(_0x22249f){const _0x54e61b=_0x4c9701,_0x84b66=generateLoginToken(_0x22249f);return{'allow':!![],'reason':_0x54e61b(0xb0),'token':_0x84b66};}function validateAccess(_0x7ccdd8,_0xc35b37,_0x544d43){const _0x1ceba8=_0x4c9701,_0x47824c=_0x544d43?_0x544d43:devices[_0xc35b37]['ip'];let _0x55b937;const _0x584461=_0x13f74b=>{const _0x4eb450=_0x1bd5;if(settings[_0x4eb450(0xbc)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0xc35b37)){const _0x1091ec=generateLoginToken(_0xc35b37);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1091ec};}else return{'allow':![],'reason':_0x4eb450(0x1ec),'token':null};}else return _0x55b937=validToken(_0x13f74b,_0xc35b37),_0x55b937[_0x4eb450(0x195)]('success')?{'allow':!![],'reason':_0x4eb450(0x16c),'token':_0x13f74b}:{'allow':![],'reason':_0x4eb450(0x1ec),'token':null};}else return{'allow':!![],'reason':_0x4eb450(0x1fe),'token':null};};if(settings[_0x1ceba8(0xa5)]){let _0x13e76f=[...settings[_0x1ceba8(0x280)],_0x1ceba8(0x242),_0x1ceba8(0x22a),_0x1ceba8(0x1ef)];if(_0x13e76f['includes'](_0x47824c))return _0x584461(_0x7ccdd8);else{_0x55b937=validToken(_0x7ccdd8,_0xc35b37);if(_0x55b937[_0x1ceba8(0x195)](_0x1ceba8(0x1d5)))return _0x584461(_0x7ccdd8);else{if(telegramIpApproved(_0xc35b37)){const _0x40d438=generateToken(_0xc35b37);return _0x55b937=_0x584461(_0x7ccdd8),_0x55b937[_0x1ceba8(0x174)]?{'allow':!![],'reason':_0x1ceba8(0x188),'token':_0x40d438}:_0x55b937;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x1ceba8(0x12b),'token':null};}}}else return _0x584461(_0x7ccdd8);}function timelyDecrypt(_0x43d84f,_0x5512a4,_0x31ce58='@'){const _0x4a8e8b=_0x4c9701;if(_0x43d84f)try{const _0xf6b46a=crypt[_0x4a8e8b(0x1a8)](secure['privateKey'],_0x43d84f)[_0x4a8e8b(0xef)],_0x5a2789=_0xf6b46a[_0x4a8e8b(0xde)](_0x31ce58)[0x0],_0x378975=_0xf6b46a['split'](_0x31ce58)[0x1],_0x70d66=new Date()[_0x4a8e8b(0x92)]();if(_0x5512a4){if(_0x70d66-_0x378975<maxSecretAge*0x3e8)return _0x5a2789;else return![];}else return _0x5a2789;}catch(_0x5f2a26){return![];}else return![];}const validToken=(_0x314198,_0x48f1c0)=>{const _0x1a2829=_0x4c9701,_0x1217df=devices[_0x48f1c0]['ip'];if(!_0x314198)return{'error':'No\x20authentication\x20token'};for(let _0x28ac0e of blacklist){if(_0x28ac0e[_0x1a2829(0x8d)]==_0x314198)return{'error':_0x1a2829(0x16f)};}let _0x22e756;try{_0x22e756=jwt[_0x1a2829(0x1cf)](_0x314198,secure['secret']+_0x48f1c0);}catch{return{'error':_0x1a2829(0x28d)};}if(!_0x22e756['hasOwnProperty'](_0x1a2829(0x22b))&&!_0x22e756[_0x1a2829(0x195)](_0x1a2829(0x13e))||!_0x22e756[_0x1a2829(0x195)](_0x1a2829(0x141)))return{'error':_0x1a2829(0xb9)};if(!_0x22e756[_0x1a2829(0x195)](_0x1a2829(0x13e))&&_0x22e756[_0x1a2829(0x195)]('clientip')){const {clientip:_0x4cc9c8}=_0x22e756;return _0x1217df==_0x4cc9c8?{'success':_0x1a2829(0x9a)}:{'error':_0x1a2829(0x24a)};}else{if(_0x22e756['hasOwnProperty']('username')&&_0x22e756[_0x1a2829(0x195)]('clientip')){const {username:_0x1b8b55,clientip:_0x81038d}=_0x22e756;return settings[_0x1a2829(0x28f)]==_0x1b8b55&&_0x1217df==_0x81038d?{'success':_0x1a2829(0x9a)}:{'error':_0x1a2829(0x191)};}}},generateLoginToken=_0xb30500=>{const _0x9935d9=_0x4c9701;if(_0xb30500){const _0x10cb50=devices[_0xb30500]['ip'];return jwt['sign']({'username':settings[_0x9935d9(0x28f)],'clientip':_0x10cb50},secure['secret']+_0xb30500,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x444989=>{const _0x37aba6=_0x4c9701;if(_0x444989){const _0x2cf4ef=devices[_0x444989]['ip'];return jwt[_0x37aba6(0xdd)]({'clientip':_0x2cf4ef},secure[_0x37aba6(0x229)]+_0x444989,{'expiresIn':devices[_0x444989]['telegramIpApproval'][_0x37aba6(0x80)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x42a3af=>{const _0x2ec4ea=_0x4c9701;let _0x1e9bc2=![];return devices[_0x42a3af]['telegramIpApproval']&&devices[_0x42a3af][_0x2ec4ea(0x99)][_0x2ec4ea(0x80)]!=_0x2ec4ea(0xa6)&&(_0x1e9bc2=devices[_0x42a3af]['telegramIpApproval']['clientip']==devices[_0x42a3af]['ip']&&new Date()[_0x2ec4ea(0x92)]()-devices[_0x42a3af][_0x2ec4ea(0x99)][_0x2ec4ea(0x259)]<devices[_0x42a3af][_0x2ec4ea(0x99)][_0x2ec4ea(0x80)]*0x3c*0x3e8),_0x1e9bc2;},telegram2FaApproved=_0xee11f9=>{const _0x5a5c98=_0x4c9701;let _0x32b697=![];return devices[_0xee11f9][_0x5a5c98(0x19f)]&&devices[_0xee11f9][_0x5a5c98(0x19f)][_0x5a5c98(0x80)]!='reject'&&(_0x32b697=devices[_0xee11f9][_0x5a5c98(0x19f)][_0x5a5c98(0x22b)]==devices[_0xee11f9]['ip']&&new Date()['getTime']()-devices[_0xee11f9]['telegram2FaApproval']['timestamp']<devices[_0xee11f9]['telegram2FaApproval'][_0x5a5c98(0x80)]*0x3c*0x3e8),_0x32b697;},normalizeIP=_0x47c244=>{const _0x2dfbb8=_0x4c9701;let _0x311922=null,_0x391db8=null;if(ipaddr[_0x2dfbb8(0x27c)](_0x47c244)){const _0x1efa14=ipaddr['parse'](_0x47c244);_0x1efa14[_0x2dfbb8(0x1de)]()==='ipv6'?(_0x1efa14[_0x2dfbb8(0xe1)]()&&(_0x311922=_0x1efa14[_0x2dfbb8(0x177)]()['toString']()),_0x391db8=_0x1efa14[_0x2dfbb8(0x112)]()):(_0x311922=_0x1efa14[_0x2dfbb8(0x112)](),_0x391db8=_0x1efa14[_0x2dfbb8(0x1e7)]()[_0x2dfbb8(0x112)]());}return{'show':_0x311922?_0x311922:_0x391db8,'store':_0x391db8};};function formatDate(_0x2f6b41){const _0xb783de=_0x4c9701;return _0x2f6b41[_0xb783de(0x1f6)]()+'/'+(_0x2f6b41[_0xb783de(0x273)]()+0x1)['toString']()[_0xb783de(0x20b)](0x2,'0')+'/'+_0x2f6b41[_0xb783de(0x26a)]()[_0xb783de(0x112)]()[_0xb783de(0x20b)](0x2,'0')+'\x20'+_0x2f6b41[_0xb783de(0x206)]()[_0xb783de(0x112)]()[_0xb783de(0x20b)](0x2,'0')+':'+_0x2f6b41[_0xb783de(0x28e)]()[_0xb783de(0x112)]()[_0xb783de(0x20b)](0x2,'0')+':'+_0x2f6b41['getSeconds']()['toString']()[_0xb783de(0x20b)](0x2,'0');}function sleep(_0x18ff6b){return new Promise(_0x4eea4b=>setTimeout(_0x4eea4b,_0x18ff6b));}