const _0x2a54ee=_0x16b4;(function(_0x1fcd19,_0x481db7){const _0x8893b2=_0x16b4,_0x1d316d=_0x1fcd19();while(!![]){try{const _0x579b69=-parseInt(_0x8893b2(0x205))/0x1+-parseInt(_0x8893b2(0x252))/0x2*(-parseInt(_0x8893b2(0x39b))/0x3)+-parseInt(_0x8893b2(0x365))/0x4+parseInt(_0x8893b2(0x324))/0x5+-parseInt(_0x8893b2(0x3ac))/0x6*(parseInt(_0x8893b2(0x1af))/0x7)+parseInt(_0x8893b2(0x327))/0x8+parseInt(_0x8893b2(0x2dd))/0x9;if(_0x579b69===_0x481db7)break;else _0x1d316d['push'](_0x1d316d['shift']());}catch(_0x33c287){_0x1d316d['push'](_0x1d316d['shift']());}}}(_0x5bd4,0xf1110));const _0x3592c1=function(){let _0x3966cf=!![];return function(_0x1db5ca,_0x54d69e){const _0x1e9c13=_0x3966cf?function(){const _0x19e761=_0x16b4;if(_0x54d69e){const _0x2840cf=_0x54d69e[_0x19e761(0x306)](_0x1db5ca,arguments);return _0x54d69e=null,_0x2840cf;}}:function(){};return _0x3966cf=![],_0x1e9c13;};}(),_0xdaf8d7=_0x3592c1(this,function(){const _0x3cd532=_0x16b4;return _0xdaf8d7['toString']()[_0x3cd532(0x2b9)](_0x3cd532(0x1e3))[_0x3cd532(0x1cf)]()[_0x3cd532(0x2aa)](_0xdaf8d7)['search'](_0x3cd532(0x1e3));});_0xdaf8d7();'use strict';process[_0x2a54ee(0x2c6)][_0x2a54ee(0x2c9)]=0x1;const childProcess=require(_0x2a54ee(0x2e3)),fs=require('fs'),fns=require(_0x2a54ee(0x325)),low=require(_0x2a54ee(0x370)),FileSync=require(_0x2a54ee(0x22c)),path=require(_0x2a54ee(0x1ae)),crypto=require('crypto'),Crypt=require(_0x2a54ee(0x1bc))[_0x2a54ee(0x222)],RSA=require(_0x2a54ee(0x1bc))[_0x2a54ee(0x2c5)],bcrypt=require('bcryptjs'),jwt=require(_0x2a54ee(0x2e2)),ipaddr=require('ipaddr.js'),argv=require(_0x2a54ee(0x258))(process[_0x2a54ee(0x3a7)][_0x2a54ee(0x395)](0x2))[_0x2a54ee(0x3a7)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x2a54ee(0x36a)),Mixpanel=require(_0x2a54ee(0x21d)),axios=require(_0x2a54ee(0x1c4)),{GraphQLClient,gql}=require(_0x2a54ee(0x3b6)),util=require('util'),fileUpload=require(_0x2a54ee(0x30a)),{networkInterfaces}=require('os'),PORT=argv[_0x2a54ee(0x1f6)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x2a54ee(0x2ca)](PORT)&&(console[_0x2a54ee(0x28a)](_0x2a54ee(0x273)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x2a54ee(0x1b3)](0x1));const HOST=argv[_0x2a54ee(0x206)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x2a54ee(0x290)]['node'];let bbpath=_0x2a54ee(0x1e4),bbpath2='';const botfile=_0x2a54ee(0x30d),configfile=_0x2a54ee(0x35a),settingsfile=_0x2a54ee(0x2d4),securefile=_0x2a54ee(0x31d),environment=require('./'+bbpath2+_0x2a54ee(0x1ca))['environment']||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x2a54ee(0x1fd)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2a54ee(0x350)),configpath=userID?bbpath+_0x2a54ee(0x1c6)+userID+'/':bbpath+_0x2a54ee(0x1c6),configbackuppath=configpath+_0x2a54ee(0x35d),logspath=userID?bbpath+_0x2a54ee(0x34d)+userID+'/':bbpath+_0x2a54ee(0x34d),zippath=userID?bbpath+_0x2a54ee(0x339)+userID+'/':bbpath+_0x2a54ee(0x339),loggerfile=fs['createWriteStream'](logspath+_0x2a54ee(0x242),{'flags':'a'}),temppath=userID?bbpath+_0x2a54ee(0x274)+userID+'/':bbpath+_0x2a54ee(0x274);!fs['existsSync'](configpath)&&fs[_0x2a54ee(0x225)](configpath);!fs[_0x2a54ee(0x1fd)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x2a54ee(0x1fd)](logspath)&&fs[_0x2a54ee(0x225)](logspath);!fs[_0x2a54ee(0x1fd)](zippath)&&fs[_0x2a54ee(0x225)](zippath);!fs[_0x2a54ee(0x1fd)](temppath)&&fs[_0x2a54ee(0x225)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2a54ee(0x33a)]({'bots':[]})[_0x2a54ee(0x28f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2a54ee(0x33a)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2a54ee(0x280),'onepagemode':![],'marketcapApi':''}})[_0x2a54ee(0x28f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2a54ee(0x33a)]({'secure':{},'blacklist':[]})[_0x2a54ee(0x28f)]();let crypt=new Crypt({'md':_0x2a54ee(0x3ab),'rsaStandard':_0x2a54ee(0x322)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2a54ee(0x23c)](_0x2a54ee(0x2ad),{'host':_0x2a54ee(0x2ba)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2a54ee(0x363)]&&(settings['telegramToken']!=''&&settings[_0x2a54ee(0x363)]!=_0x2a54ee(0x2de))&&settings[_0x2a54ee(0x317)]&&settings[_0x2a54ee(0x317)]!='')initTelegram();const parseColor=(_0x4db370,_0x2df79e)=>{const _0x45dde4=_0x2a54ee,_0x2690fb=/#[A-Z]{3}#/g;if(typeof _0x4db370==_0x45dde4(0x2fd)){!_0x2df79e?_0x4db370=_0x4db370[_0x45dde4(0x353)](_0x2690fb,''):(_0x4db370=_0x4db370[_0x45dde4(0x353)](/#BLU#/g,'\x1b[34m'),_0x4db370=_0x4db370[_0x45dde4(0x353)](/#RED#/g,_0x45dde4(0x2c7)),_0x4db370=_0x4db370[_0x45dde4(0x353)](/#YEL#/g,_0x45dde4(0x1d2)),_0x4db370=_0x4db370[_0x45dde4(0x353)](/#MAG#/g,_0x45dde4(0x2bb)),_0x4db370=_0x4db370[_0x45dde4(0x353)](/#CYA#/g,_0x45dde4(0x399)),_0x4db370=_0x4db370[_0x45dde4(0x353)](/#RES#/g,_0x45dde4(0x271)));;}return _0x4db370;},logger={'screen':_0x19bf18=>{const _0x116d40=_0x2a54ee;console[_0x116d40(0x28a)](parseColor(_0x19bf18,!![]));},'simple':_0x4bc8bb=>{const _0x12cd6c=_0x2a54ee;console[_0x12cd6c(0x28a)](parseColor(_0x4bc8bb,!![])),loggerfile[_0x12cd6c(0x28f)](util[_0x12cd6c(0x2fc)](parseColor(_0x4bc8bb,![]))+'\x0a');},'full':async _0x35bf92=>{const _0x396802=_0x2a54ee,_0x56eb16=getTimeStamp()+_0x396802(0x311)+_0x35bf92;console[_0x396802(0x28a)](parseColor(_0x56eb16,!![])),loggerfile[_0x396802(0x28f)](util[_0x396802(0x2fc)](parseColor(_0x56eb16,![]))+'\x0a');if(tgBot&&settings[_0x396802(0x29a)]&&settings['telegramEvents']!=_0x396802(0x1c7))await sendTelegram(settings['telegramChatId'],_0x396802(0x360)+parseColor(_0x35bf92,![]));},'debug':async(_0x4274c0,_0x770d4e='')=>{const _0x622bbe=_0x2a54ee,_0x1d4aee=getTimeStamp()+_0x622bbe(0x237)+_0x4274c0;if(debugging)console[_0x622bbe(0x28a)](parseColor(_0x1d4aee,!![]));loggerfile[_0x622bbe(0x28f)](util[_0x622bbe(0x2fc)](parseColor(_0x1d4aee,![]))+'\x0a');if(_0x770d4e){if(debugging)console['log'](_0x770d4e);loggerfile[_0x622bbe(0x28f)](util[_0x622bbe(0x2fc)](_0x770d4e)+'\x0a');}}};let terminating=![];function _0x5bd4(){const _0x561b67=['Restore\x20process\x20aborted','zip/','defaults','privateKey','entries',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','started','name','hashSync','placeOrder','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','off','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','updatebotmanager','static','All\x20bots\x20running\x20right\x20now','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','forEach','bbvNew','getTime','bbUsername','logs/','remove','text','clients','/enable\x20-\x20enable\x20notifications\x0a','sendFile','replace','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','botmanager','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','telegram','<b>Balance\x20Bot\x20Status:</b>\x0a','temporary\x20access\x20not\x20allowed','bb-config.json','button','showname','backup/','Unauthorized\x20attempt\x20to\x20update\x20bot','\x20to\x20','Bot\x20Mgr\x20>\x20','telegram2FaApproval','Notifications\x20enabled','telegramToken','confirm-message','6270812mZokds','address','auth','2FA\x20required','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegraf','new-disabled','chat','\x20(1)','randomFillSync','telegramIpApproval','lowdb','telegrammsg','output-001.log','No\x20authentication\x20token','binary','config_alerts','track','HTML','get-messages','Network\x20Interfaces:','$1_$2_$3','getDate','/:bot/history','All\x20bots','internal','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','staging','Notifications\x20enabled\x0a','botID','Markdown','/download/:type','backup-full@','send','\x20(2)','secret','/:bot/configuration','login2fa_reject_','token','getUTCHours','set','lastmsgtelegram','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','inlineKeyboard','update-bb','all','kill','version','slice',')\x20\x20\x20|\x20Bot\x20','Restoring\x20bot(s)\x20from\x20backup','mode','\x1b[36m','join','15ceOvyh','pidRefreshToken','access','sendMetricsTelegram','getSeconds','event','telegramEvents','=>\x20Go\x20to\x20#CYA#http://','bots','login2fa_','status','store','argv','restart_','running','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','sha256','1577808HOUyxU','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Notifications\x20types:\x20','************','filter','hex','stringify','Telegraf\x20error:','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','logged\x20out','graphql-request','127.0.0.1','Notifications\x20disabled\x0a','inherit','User\x20has\x20been\x20validated','#RES#','Invalid\x20authentication\x20token\x20(1)','login\x20required','reinstall','Backup\x20file\x20unzipped\x20and\x20stored','Unauthorized\x20attempt\x20to\x20delete\x20alerts','toIPv4MappedAddress','assign','messages','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','resetpw_no','path','28oYtVyx','::ffff:127.0.0.1','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','exit','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','temporary\x20token\x20generated','number','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','enabled','debug','Bot\x20','keys','hybrid-crypto-js','cancelLoading','Password\x20has\x20been\x20reset\x20to:\x20','No\x20bots\x20running\x20right\x20now','/start','exec','settings.','accept','axios','toggle_','config/','orders','-----------------------------------------------------------------------------------','pidExpireLogin','version.json','remoteAddress','toggleBotMode','getMinutes','.zip','toString','/update\x20-\x20update\x20Balance\x20Bot\x0a','file','\x1b[33m','Access\x20enabled\x20for\x20','\x20mode','/help\x20-\x20show\x20available\x20commands\x0a','Restore\x20backup\x20file\x20','disconnect','warning','success','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','login','get-starting-balances','message','login\x20token\x20generated','catch','includes','Unauthorized\x20attempt\x20to\x20get\x20events','delete-alerts','(((.+)+)+)+$','bb/','kind','-performance.json','tempaccess_reject_','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','whitelist','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','find','Logged\x20out\x20user\x20...','add','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','https://api.ipify.org?format=json','temporary\x20access\x20timeout','resetpw_yes','CoinMarketCap\x20API\x20key\x20validated','output-002.log','update_no','port','portfolio_','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','metrics','Your\x20installation\x20is\x20already\x20up\x20to\x20date','uncaughtException','notification','existsSync','Session\x20expired\x20for\x20user\x20...','/:bot/performance','getStartingBalances','Orders','output-000.log','2FA\x20login\x20required','bbPassword','1629265qaanxj','host','_data','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','express','reinstall_no','new','\x20minutes','restore_no_','/:bot','title','\x20|\x20','decrypt','full','callback','\x20only\x0a','startsWith','on_','timestamp','once','clientip','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','any','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','mixpanel','initclient','Login\x20accepted','bot','tempaccess_30_','Crypt','match','[ip-address]','mkdirSync','bbvReceive','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Server','readdirSync','connected','lowdb/adapters/FileSync','timeshift','files','30\x20min','live','logout','error','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','|@|','Alerts','secure',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','action','Logged\x20in\x20user\x20...','close','isIPv4MappedAddress','init','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','tkn','listen','reply','copyFileSync','/output-000.log','post','/:bot/portfolio','then','BCT','config_all','username','push','1000','connection','Enabled\x20Bot\x20','get-logs','reason','publicKey','telegramEnabled','node-zip','618254sdZnlo','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','size','backup-files','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','yargs/yargs','resetHistory','Unauthorized\x20attempt\x20to\x20delete\x20bot','botname','sort','Unauthorized\x20login\x20attempt\x20(timeout)','Starting\x20new\x20bot\x20|\x20Bot\x20','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','download','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Restore\x20process\x20confirmed','get-backup-files','off_','tempaccess_5_','headers','build','value','getHours','split','#RES#\x20if\x20running\x20on\x20server','from','isDirectory','deleteHistoryAlerts','disabled','headless','\x1b[0m','apiPassword','Error:\x20Invalid\x20argument\x20','temp/','SIGTERM','alerts','/on\x20-\x20start\x20bot(s)\x0a','getPortfolio','parse','sockets','add-bot','handshake','Notifications\x20disabled','unlinkSync','-events.json','0.0.0','enable','latestversion','output-003.log','server','params','bot-','userid','reload','toggle','log','Starting\x20Balance\x20Bot\x20reinstallation','backup-full.zip','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Yes','write','versions','verify','blacklist','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','whitelistEnabled','<b>Telegram\x20Bot\x20Status:</b>\x0a','Temporary\x20access\x20rejected','compareSync','names','expiry','telegramChatId','config','padStart','(staging)','reinstall-bb','readFileSync','socket','simple','metrics_','All','File\x20uploaded','-results.json','Invalid\x20IP\x20address','update','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','onepagemode','constructor','Starting\x20(','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','6b67f3d61ee94b8f5c80b4affef4c4d9','2FA','\x20>\x20','stopped','login\x20not\x20required','Login\x20rejected','build2','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','yes','data','temporaryAccessAllowed','manual','search','api-eu.mixpanel.com','\x1b[35m','referer','command','stop','sortBy','/metrics\x20-\x20show\x20bot\x20performance\x0a','store-headless','portfolio','type','/upload-backup','RSA','env','\x1b[31m','#RES#\x20','NTBA_FIX_319','test','marketcapApi','login\x20token\x20valid','address\x20already\x20in\x20use','uuid','reject','Allow\x20login\x20from\x20IP\x20address\x20','Backup\x20file\x20uploaded','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','getFullYear','bb-settings.json','backup',')\x20|\x20Bot\x20','emit','Setting\x20access:\x20','hasOwnProperty','lastmsgemitted','Restarting\x20Bot\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','16386372YZoNfl','***','family','DEFLATE','editMessageReplyMarkup','jsonwebtoken','child_process','generate','backupfile','config_orders','Unauthorized\x20attempt\x20to\x20download\x20','Node.js\x20v','apiKey','settings','\x20|\x20user:\x20...','-config.json','store-fiat','index.html','restart','Starting\x20Balance\x20Bot\x20update','help','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','backup-full','temporary\x20access\x20rejected','SIGINT','getMonth','exchange','showConfig','Unauthorized\x20attempt\x20to\x20confirm\x20message','Telegram\x20error:','restore-backup-file','format','string','use','toIPv4Address','createServer','f2aRequired','writeFileSync','#RES#\x20if\x20running\x20locally\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','Error\x20removing\x20old\x20backup\x20files:','apply','15\x20min','endsWith','::1','express-fileupload','ETH','get','bot.js','\x20|\x20client:\x20...','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20log\x20out',':\x20Bot\x20Mgr\x20>\x20','reinstall_yes','Starting\x20#RED#Balance\x20Bot\x20v','sendMessage','Unauthorized\x20attempt\x20to\x20show\x20configuration','auto','telegramUsername','/:bot/support','Unauthorized\x20attempt\x20to\x20get\x20messages','min','statSync','store-configuration','bb-secure.json','disable','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','range','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','RSA-OAEP','Invalid\x20username\x20or\x20IP\x20address','4669605bmtior','date-fns','sign','7487872gTNQJu','You\x20can\x20use\x20the\x20following\x20commands:\x0a','sendPortfolioTelegram','private','code','/status\x20-\x20show\x20bot(s)\x20status\x0a','invalid\x20credentials','storeFiat','delete-bot','length','isValid','status\x20code\x20401','rmSync','store-settings','loginRequired','allow','Ok,\x20will\x20send\x20order\x20notifications\x20only'];_0x5bd4=function(){return _0x561b67;};return _0x5bd4();}process['on'](_0x2a54ee(0x1fb),function(_0x12997f){const _0x36b3c6=_0x2a54ee;_0x12997f[_0x36b3c6(0x1cf)]()[_0x36b3c6(0x1e0)](_0x36b3c6(0x2cd))?(logger[_0x36b3c6(0x2a1)](_0x36b3c6(0x1ee)+_0x12997f[_0x36b3c6(0x1f6)]+_0x36b3c6(0x3bb)),process[_0x36b3c6(0x386)]({'terminate':!![]},_0x40136a=>{})):logger[_0x36b3c6(0x2a1)](_0x12997f);}),process['on'](_0x2a54ee(0x1b3),()=>{const _0x6ca92f=_0x2a54ee;stopAllBots(),process[_0x6ca92f(0x1b3)](0x0);}),process['on']('SIGTERM',()=>{const _0x3ebd5d=_0x2a54ee;stopAllBots(),process[_0x3ebd5d(0x1b3)](0x0);}),process['on'](_0x2a54ee(0x2f5),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2a54ee(0x1ca))[_0x2a54ee(0x394)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2a54ee(0x209)),app=express(),http=require('http')[_0x2a54ee(0x300)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x2a54ee(0x30c)](_0x2a54ee(0x384),async(_0x501d70,_0x4c0056)=>{const _0x1fefa9=_0x2a54ee,_0x36d387=_0x501d70[_0x1fefa9(0x285)][_0x1fefa9(0x2c3)],_0x249f3f=getClientsWithBotID(_0x1fefa9(0x355)),_0x4f1578=_0x501d70['headers']['uuid'],_0x52ba50=timelyDecrypt(_0x4f1578,![]),_0x45ed21=_0x249f3f['find'](_0x143762=>_0x143762[_0x1fefa9(0x2ce)]==_0x52ba50);if(_0x45ed21){const _0xbd9faf=normalizeIP(_0x501d70[_0x1fefa9(0x2a0)]['remoteAddress'])[_0x1fefa9(0x3a6)],_0x2dbe25=_0x501d70[_0x1fefa9(0x266)][_0x1fefa9(0x23e)];if(validateAccess(_0x2dbe25,_0x52ba50,_0xbd9faf)['allow'])_0x36d387==_0x1fefa9(0x2d5)&&await backupConfigFiles(),await zipFiles(_0x36d387),_0x4c0056[_0x1fefa9(0x260)](zippath+(_0x36d387+_0x1fefa9(0x1ce)),_0x922629=>{const _0x1da78d=_0x1fefa9;_0x922629&&(logger[_0x1da78d(0x212)](_0x1da78d(0x30f)+_0x36d387),logger[_0x1da78d(0x2a1)](_0x922629));});else logger[_0x1fefa9(0x212)](_0x1fefa9(0x2e7)+_0x36d387+_0x1fefa9(0x36d));}else logger[_0x1fefa9(0x212)](_0x1fefa9(0x2e7)+_0x36d387+_0x1fefa9(0x387));}),app[_0x2a54ee(0x243)](_0x2a54ee(0x2c4),async(_0x31fca7,_0x40c6ff)=>{const _0x47fa43=_0x2a54ee,_0xb45da8=getClientsWithBotID(_0x47fa43(0x355)),_0x105afc=_0x31fca7[_0x47fa43(0x266)][_0x47fa43(0x2ce)],_0x395f13=timelyDecrypt(_0x105afc,![]),_0x12c1aa=_0xb45da8[_0x47fa43(0x1eb)](_0x10a171=>_0x10a171[_0x47fa43(0x2ce)]==_0x395f13);logger[_0x47fa43(0x1b9)](_0x47fa43(0x2d1));if(_0x12c1aa){const _0x14937d=normalizeIP(_0x31fca7[_0x47fa43(0x2a0)][_0x47fa43(0x1cb)])[_0x47fa43(0x3a6)],_0x4679b7=_0x31fca7[_0x47fa43(0x266)]['tkn'];if(validateAccess(_0x4679b7,_0x395f13,_0x14937d)[_0x47fa43(0x336)]){if(_0x31fca7['files']){const _0x18fac1=_0x31fca7[_0x47fa43(0x22e)][_0x47fa43(0x2e5)];await _0x18fac1['mv'](temppath+_0x18fac1[_0x47fa43(0x33f)]),_0x40c6ff[_0x47fa43(0x386)]({'status':!![],'message':_0x47fa43(0x2a4)});const _0x582184=getBotsWithMode();_0x582184[_0x47fa43(0x330)]>0x0?confirmRestore(temppath,_0x18fac1['name']):unzipFile(temppath,_0x18fac1[_0x47fa43(0x33f)]);}}else logger[_0x47fa43(0x212)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x47fa43(0x212)](_0x47fa43(0x1f8));}),app[_0x2a54ee(0x2fe)](express[_0x2a54ee(0x346)](path[_0x2a54ee(0x39a)](__dirname,bbpath2,_0x2a54ee(0x2b3)))),app['use'](express[_0x2a54ee(0x346)](path['join'](__dirname,bbpath2,_0x2a54ee(0x267)))),app['get']('/',function(_0x1ed22,_0x519714){const _0x996521=_0x2a54ee;_0x519714[_0x996521(0x352)](path[_0x996521(0x39a)](__dirname,bbpath2,'build2',_0x996521(0x2ee)));}),app[_0x2a54ee(0x30c)](_0x2a54ee(0x20e),function(_0x574a4d,_0x386941){const _0x3f4819=_0x2a54ee;_0x386941[_0x3f4819(0x352)](path['join'](__dirname,bbpath2,_0x3f4819(0x267),_0x3f4819(0x2ee)));}),app[_0x2a54ee(0x30c)](_0x2a54ee(0x244),(_0x3a580d,_0xddaf4e)=>{const _0x29b952=_0x2a54ee;_0xddaf4e[_0x29b952(0x352)](path['join'](__dirname,bbpath2,_0x29b952(0x267),'index.html'));}),app[_0x2a54ee(0x30c)](_0x2a54ee(0x1ff),(_0x19b9a3,_0x50b084)=>{const _0x5b6a25=_0x2a54ee;_0x50b084[_0x5b6a25(0x352)](path[_0x5b6a25(0x39a)](__dirname,bbpath2,'build','index.html'));}),app[_0x2a54ee(0x30c)]('/:bot/coins',(_0x4ffcf2,_0x3d2503)=>{const _0x1f7950=_0x2a54ee;_0x3d2503['sendFile'](path[_0x1f7950(0x39a)](__dirname,bbpath2,_0x1f7950(0x267),_0x1f7950(0x2ee)));}),app[_0x2a54ee(0x30c)](_0x2a54ee(0x37c),(_0x43a6d7,_0x580e6b)=>{const _0x12e3fd=_0x2a54ee;_0x580e6b[_0x12e3fd(0x352)](path[_0x12e3fd(0x39a)](__dirname,bbpath2,_0x12e3fd(0x267),'index.html'));}),app[_0x2a54ee(0x30c)](_0x2a54ee(0x389),(_0xd55974,_0x3f54f3)=>{const _0x5ec8aa=_0x2a54ee;_0x3f54f3[_0x5ec8aa(0x352)](path[_0x5ec8aa(0x39a)](__dirname,bbpath2,_0x5ec8aa(0x267),'index.html'));}),app[_0x2a54ee(0x30c)](_0x2a54ee(0x318),(_0x15d17a,_0x1296e6)=>{const _0x24e2fb=_0x2a54ee;_0x1296e6[_0x24e2fb(0x352)](path[_0x24e2fb(0x39a)](__dirname,bbpath2,'build',_0x24e2fb(0x2ee)));});if(HOST)http[_0x2a54ee(0x23f)](PORT,HOST);else http[_0x2a54ee(0x23f)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5dc3a9=_0x2a54ee;let _0x1c6fd4=_0x5dc3a9(0x224);const _0x27ca02=networkInterfaces(),_0x4bb654={};for(const _0xf00e9 of Object['keys'](_0x27ca02)){for(const _0x56a879 of _0x27ca02[_0xf00e9]){if((_0x56a879[_0x5dc3a9(0x2df)]=='IPv4'||_0x56a879['family']==0x4)&&!_0x56a879[_0x5dc3a9(0x37e)]){const _0x9c665=ipaddr[_0x5dc3a9(0x279)](_0x56a879[_0x5dc3a9(0x366)])[_0x5dc3a9(0x320)]();_0x9c665!=_0x5dc3a9(0x32a)&&(!_0x4bb654[_0xf00e9]&&(_0x4bb654[_0xf00e9]=[]),_0x4bb654[_0xf00e9]['push'](_0x56a879[_0x5dc3a9(0x366)]),_0x1c6fd4=_0x56a879[_0x5dc3a9(0x366)]);}}}return{'serverip':_0x1c6fd4,'netinterfaces':_0x4bb654};}async function startServer(){const _0x3e3b2f=_0x2a54ee,{serverip:_0x228682,netinterfaces:_0x3bf51c}=getServerIP();logger['simple'](''),logger[_0x3e3b2f(0x2a1)]('-----------------------------------------------------------------------------------'),await logger[_0x3e3b2f(0x212)](_0x3e3b2f(0x313)+serverversion+_0x3e3b2f(0x2c8)+(environment==_0x3e3b2f(0x380)?_0x3e3b2f(0x29d):'')+'\x0a'+(_0x3e3b2f(0x25f)+PORT+_0x3e3b2f(0x303))+(_0x3e3b2f(0x3a2)+_0x228682+':'+PORT+_0x3e3b2f(0x26b))),logger[_0x3e3b2f(0x2a1)](_0x3e3b2f(0x1c8));if(config[_0x3e3b2f(0x330)]!=0x0)for(const _0x1da8aa of config){const _0x136803=_0x1da8aa['mode']=='auto'?'a':'m';if(_0x1da8aa['status']=='enabled'||_0x1da8aa['status']=='new')await logger[_0x3e3b2f(0x212)](_0x3e3b2f(0x2ab)+_0x136803+_0x3e3b2f(0x2d6)+_0x1da8aa['botID']+_0x3e3b2f(0x210)+_0x1da8aa[_0x3e3b2f(0x25b)]),startBot([_0x1da8aa['botID'],userID],{'cwd':bbpath},function(_0x546990){const _0x33c75d=_0x3e3b2f;if(_0x546990)logger[_0x33c75d(0x212)](_0x546990);});else(_0x1da8aa[_0x3e3b2f(0x3a5)]==_0x3e3b2f(0x26f)||_0x1da8aa['status']==_0x3e3b2f(0x36b))&&await logger[_0x3e3b2f(0x212)]('Idling\x20('+_0x136803+_0x3e3b2f(0x396)+_0x1da8aa[_0x3e3b2f(0x382)]+_0x3e3b2f(0x210)+_0x1da8aa[_0x3e3b2f(0x25b)]);}else!newBot&&logger[_0x3e3b2f(0x2a1)](_0x3e3b2f(0x321));if(newBot)addBot();logger[_0x3e3b2f(0x2a1)](_0x3e3b2f(0x1c8)),logger[_0x3e3b2f(0x2a1)](''),await logger[_0x3e3b2f(0x1b9)](_0x3e3b2f(0x2e8)+nodeversion),await logger['debug'](_0x3e3b2f(0x379),_0x3bf51c);}function startSocket(){const _0x3d9048=_0x2a54ee;io['on'](_0x3d9048(0x24b),_0x26fe45=>{const _0x462daf=_0x3d9048;let _0x506063,_0x5ae0ee,_0x25d731,_0x14f94a,_0x307538;const _0x1ff1c5=_0x26fe45['handshake'][_0x462daf(0x266)][_0x462daf(0x2bc)];_0x5ae0ee=_0x1ff1c5[_0x462daf(0x223)](/bot[0-9]{3}/);if(_0x5ae0ee)_0x25d731=_0x5ae0ee[0x0][_0x462daf(0x223)](/[0-9]{3}/);if(_0x25d731)_0x506063=_0x25d731[0x0];else _0x506063=_0x462daf(0x355);const _0x3b17dc=_0x26fe45[_0x462daf(0x27c)][_0x462daf(0x367)]['encryptedUuid'];if(!_0x3b17dc)_0x26fe45[_0x462daf(0x2d7)](_0x462daf(0x3a5),{'publicKey':secure[_0x462daf(0x24f)]});else{_0x14f94a=timelyDecrypt(_0x3b17dc,![]);if(!_0x14f94a)_0x26fe45['emit']('status',{'publicKey':secure[_0x462daf(0x24f)]});else{_0x307538=normalizeIP(_0x26fe45['conn']['remoteAddress'])[_0x462daf(0x3a6)];if(!devices[_0x14f94a])devices[_0x14f94a]={'uuid':_0x14f94a,'access':{'token':null}};devices[_0x14f94a]['ip']=_0x307538;const _0x710ad2=addClient(_0x26fe45['id'],_0x14f94a,_0x506063);setAccess(_0x710ad2),emitMessages(),_0x26fe45['on']('login',_0x22e8a7=>{const _0xd1cc50=_0x462daf,_0x2f543e=timelyDecrypt(_0x22e8a7['password'],!![],_0xd1cc50(0x234));if(_0x2f543e){_0x22e8a7={'username':_0x22e8a7['username'],'password':_0x2f543e},devices[_0x14f94a][_0xd1cc50(0x39d)]=validateCredentials(_0x22e8a7,_0x14f94a);if(devices[_0x14f94a][_0xd1cc50(0x39d)][_0xd1cc50(0x336)]==![]&&devices[_0x14f94a][_0xd1cc50(0x39d)][_0xd1cc50(0x24e)]==_0xd1cc50(0x203))_0x26fe45[_0xd1cc50(0x2d7)](_0xd1cc50(0x3a5),{'access':devices[_0x14f94a][_0xd1cc50(0x39d)]}),loginAccess2FA(_0x14f94a,_0x307538);else{if(devices[_0x14f94a][_0xd1cc50(0x39d)][_0xd1cc50(0x336)]==![]&&devices[_0x14f94a][_0xd1cc50(0x39d)]['reason']=='invalid\x20credentials')_0x26fe45[_0xd1cc50(0x2d7)](_0xd1cc50(0x3a5),{'access':devices[_0x14f94a][_0xd1cc50(0x39d)]});else devices[_0x14f94a][_0xd1cc50(0x39d)]['allow']&&devices[_0x14f94a][_0xd1cc50(0x39d)][_0xd1cc50(0x24e)]==_0xd1cc50(0x1de)&&(getClientsWithUuid(_0x14f94a)['forEach'](_0x20b636=>{setAccess(_0x20b636);}),logger[_0xd1cc50(0x1b9)](_0xd1cc50(0x239)+_0x14f94a[_0xd1cc50(0x395)](-0x8)),setTokenRefresh(_0x14f94a),setSessionTimeout(_0xd1cc50(0x1db),_0x14f94a));}}else logger[_0xd1cc50(0x212)](_0xd1cc50(0x25d));}),_0x26fe45['on']('reset-password',()=>{resetPassword();}),_0x26fe45['on'](_0x462daf(0x1d7),_0x2050f2=>{removeClient(_0x26fe45['id']);}),_0x506063==_0x462daf(0x355)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1cc49a){const _0x39b493=_0x2a54ee;if(_0x1cc49a!=_0x39b493(0x355)&&config[_0x39b493(0x2e9)]!=''){if(pid[_0x1cc49a])pid[_0x1cc49a][_0x39b493(0x386)]({'function':_0x39b493(0x21e),'args':null});}_0x1cc49a!=_0x39b493(0x355)&&broadcastToBots(_0x39b493(0x3a3),JSON['stringify'](config));}function reloadBotManager(){const _0x3b2aeb=_0x2a54ee;getClientsWithBotID('botmanager')[_0x3b2aeb(0x349)](_0x1e8338=>{const _0x99448a=_0x3b2aeb;getSocket(_0x1e8338['id'])[_0x99448a(0x2d7)](_0x99448a(0x3a5),{'access':{'allow':![],'reason':_0x99448a(0x288),'token':null}});});}function getSocket(_0x4af1d1){const _0x2aec78=_0x2a54ee;return io[_0x2aec78(0x27a)]['sockets'][_0x2aec78(0x30c)](_0x4af1d1);}function setAccess(_0x4d680){const _0x24e498=_0x2a54ee,_0x5dd9ef=getSocket(_0x4d680['id']),_0x84f141=_0x4d680[_0x24e498(0x2ce)],_0x33a385=_0x4d680[_0x24e498(0x220)];devices[_0x84f141][_0x24e498(0x39d)]=validateAccess(devices[_0x84f141]['access']['token'],_0x84f141),logger[_0x24e498(0x1b9)](_0x24e498(0x2d8)+devices[_0x84f141][_0x24e498(0x39d)][_0x24e498(0x24e)]+_0x24e498(0x30e)+_0x4d680['id'][_0x24e498(0x395)](-0x8)+_0x24e498(0x2eb)+_0x84f141['slice'](-0x8)),_0x5dd9ef[_0x24e498(0x39a)](_0x84f141);if(devices[_0x84f141][_0x24e498(0x39d)][_0x24e498(0x336)]){_0x5dd9ef[_0x24e498(0x39a)](_0x33a385);if(_0x33a385==_0x24e498(0x355))initializeSocketBotManager(_0x5dd9ef);else initializeSocketBot(_0x5dd9ef);initClient(_0x33a385);}devices[_0x84f141][_0x24e498(0x39d)][_0x24e498(0x38b)]&&devices[_0x84f141][_0x24e498(0x39d)]['reason']==_0x24e498(0x1b5)&&setSessionTimeout(_0x24e498(0x2ae),_0x84f141),devices[_0x84f141][_0x24e498(0x39d)][_0x24e498(0x38b)]&&devices[_0x84f141][_0x24e498(0x39d)][_0x24e498(0x24e)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x24e498(0x1db),_0x84f141),_0x5dd9ef[_0x24e498(0x2d7)](_0x24e498(0x3a5),{'status':_0x4d680[_0x24e498(0x284)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x84f141][_0x24e498(0x39d)],'externalip':devices[_0x84f141]['ip'],'publicKey':secure[_0x24e498(0x24f)],'userid':settings[_0x24e498(0x287)],'validInstallation':validInstallation}),devices[_0x84f141][_0x24e498(0x39d)]['allow']==![]&&devices[_0x84f141][_0x24e498(0x39d)][_0x24e498(0x24e)]==_0x24e498(0x368)&&temporaryAccess2FA(_0x84f141,devices[_0x84f141]['ip']);}function setSessionTimeout(_0x228be6,_0xe4706b){const _0x4efe68=_0x2a54ee;let _0x399940;if(_0x228be6==_0x4efe68(0x1db))_0x399940=loginExpiry*0x3c*0x3e8;else _0x399940=devices[_0xe4706b]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x4efe68(0x34b)]()-devices[_0xe4706b]['telegramIpApproval']['timestamp']);if(devices[_0xe4706b]['pidExpireLogin'])clearTimeout(devices[_0xe4706b][_0x4efe68(0x1c9)]);devices[_0xe4706b]['pidExpireLogin']=setTimeout(()=>{const _0x25b612=_0x4efe68;if(devices[_0xe4706b]['pidRefreshToken'])clearTimeout(devices[_0xe4706b][_0x25b612(0x39c)]);removeSocketListeners(_0xe4706b),addBlacklist(_0xe4706b),devices[_0xe4706b][_0x25b612(0x36f)]=null,devices[_0xe4706b]['telegram2FaApproval']=null,devices[_0xe4706b][_0x25b612(0x39d)][_0x25b612(0x38b)]=null,logger['debug'](_0x25b612(0x1fe)+_0xe4706b[_0x25b612(0x395)](-0x8)),devices[_0xe4706b][_0x25b612(0x39d)]=validateAccess(devices[_0xe4706b][_0x25b612(0x39d)]['token'],_0xe4706b),!(devices[_0xe4706b][_0x25b612(0x39d)][_0x25b612(0x336)]&&devices[_0xe4706b][_0x25b612(0x39d)][_0x25b612(0x24e)]==_0x25b612(0x2b1))&&(_0x228be6==_0x25b612(0x1db)?io['to'](_0xe4706b)[_0x25b612(0x2d7)](_0x25b612(0x3a5),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xe4706b)[_0x25b612(0x2d7)](_0x25b612(0x3a5),{'access':{'allow':![],'reason':_0x25b612(0x1f1),'token':null}})),devices[_0xe4706b]['access'][_0x25b612(0x38b)]=null;},_0x399940);}function setTokenRefresh(_0x284e81){const _0x55b151=_0x2a54ee;if(devices[_0x284e81]['pidRefreshToken'])clearTimeout(devices[_0x284e81][_0x55b151(0x39c)]);devices[_0x284e81][_0x55b151(0x39c)]=setTimeout(()=>{const _0x476b85=_0x55b151;getClientsWithUuid(_0x284e81)[_0x476b85(0x330)]!=0x0?(devices[_0x284e81][_0x476b85(0x39d)]=refreshToken(_0x284e81),io['to'](_0x284e81)[_0x476b85(0x2d7)]('status',{'status':_0x476b85(0x22b),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x284e81][_0x476b85(0x39d)],'externalip':devices[_0x284e81]['ip'],'publicKey':secure[_0x476b85(0x24f)],'validInstallation':validInstallation}),setTokenRefresh(_0x284e81)):clearTimeout(devices[_0x284e81][_0x476b85(0x39c)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x10c817){const _0x2ddcc2=_0x2a54ee,_0x2e8652=getClient(_0x10c817['id'])[_0x2ddcc2(0x2ce)];_0x10c817[_0x2ddcc2(0x2d7)](_0x2ddcc2(0x3a3),config),_0x10c817[_0x2ddcc2(0x2d7)](_0x2ddcc2(0x2ea),cleanSettings()),_0x10c817['on'](_0x2ddcc2(0x27b),_0x4ee215=>{const _0x47f7dd=_0x2ddcc2;if(validateAccess(_0x4ee215,_0x2e8652)[_0x47f7dd(0x336)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x10c817['on']('update-bot',(_0x4b1632,_0x1c71bc)=>{const _0x54f8e7=_0x2ddcc2;if(validateAccess(_0x1c71bc,_0x2e8652)[_0x54f8e7(0x336)])toggleBot(_0x4b1632[_0x54f8e7(0x382)],_0x4b1632['status'],_0x4b1632[_0x54f8e7(0x230)]);else logger[_0x54f8e7(0x212)](_0x54f8e7(0x35e));}),_0x10c817['on']('toggle-bot-mode',(_0x4eb0ad,_0x4d8319)=>{const _0x23539f=_0x2ddcc2;if(validateAccess(_0x4d8319,_0x2e8652)[_0x23539f(0x336)])toggleBotMode(_0x4eb0ad);else logger[_0x23539f(0x212)](_0x23539f(0x35e));}),_0x10c817['on'](_0x2ddcc2(0x32f),(_0x3237af,_0x2ffe06)=>{const _0x41b009=_0x2ddcc2;if(validateAccess(_0x2ffe06,_0x2e8652)[_0x41b009(0x336)])deleteBot(_0x3237af);else logger[_0x41b009(0x212)](_0x41b009(0x25a));}),_0x10c817['on'](_0x2ddcc2(0x334),(_0x36b0b7,_0x2e7b4f)=>{const _0x48b66c=_0x2ddcc2;if(validateAccess(_0x2e7b4f,_0x2e8652)[_0x48b66c(0x336)])storeSettings(_0x36b0b7,!![]);else logger[_0x48b66c(0x212)](_0x48b66c(0x304));}),_0x10c817['on'](_0x2ddcc2(0x391),_0x4c4198=>{const _0x322324=_0x2ddcc2;if(validateAccess(_0x4c4198,_0x2e8652)[_0x322324(0x336)])updateBB(_0x322324(0x2a7));else logger[_0x322324(0x212)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x10c817['on'](_0x2ddcc2(0x29e),_0x172813=>{const _0x49de14=_0x2ddcc2;if(validateAccess(_0x172813,_0x2e8652)[_0x49de14(0x336)])updateBB(_0x49de14(0x1a6));else logger[_0x49de14(0x212)](_0x49de14(0x227));}),_0x10c817['on'](_0x2ddcc2(0x263),_0x3ff818=>{const _0x9d07a3=_0x2ddcc2;if(validateAccess(_0x3ff818,_0x2e8652)[_0x9d07a3(0x336)]){const _0x284241=getClient(_0x10c817['id']);if(_0x284241)getBackupFiles(_0x284241['uuid']);else logger['full'](_0x9d07a3(0x1ef));}else logger['full'](_0x9d07a3(0x2ac));}),_0x10c817['on'](_0x2ddcc2(0x2fb),(_0x29ac66,_0x1d2da3)=>{const _0x3ec4df=_0x2ddcc2;if(validateAccess(_0x1d2da3,_0x2e8652)[_0x3ec4df(0x336)])restoreBackupFile(_0x29ac66);else logger[_0x3ec4df(0x212)](_0x3ec4df(0x2f2));}),_0x10c817['on'](_0x2ddcc2(0x378),_0x409f13=>{const _0x540b98=_0x2ddcc2;if(validateAccess(_0x409f13,_0x2e8652)[_0x540b98(0x336)])getMessages();else logger[_0x540b98(0x212)](_0x540b98(0x319));}),_0x10c817['on']('confirm-message',(_0x29f36d,_0x225882)=>{const _0x28705a=_0x2ddcc2;if(validateAccess(_0x225882,_0x2e8652)[_0x28705a(0x336)])confirmMessage(_0x29f36d);else logger[_0x28705a(0x212)](_0x28705a(0x2f9));}),_0x10c817['on']('logout',_0x6e52f5=>{const _0x2d3d42=_0x2ddcc2;if(validateAccess(_0x6e52f5,_0x2e8652)[_0x2d3d42(0x336)]){if(devices[_0x2e8652]['pidRefreshToken'])clearTimeout(devices[_0x2e8652][_0x2d3d42(0x39c)]);if(devices[_0x2e8652][_0x2d3d42(0x1c9)])clearTimeout(devices[_0x2e8652][_0x2d3d42(0x1c9)]);removeSocketListeners(getClient(_0x10c817['id'])[_0x2d3d42(0x2ce)]),addBlacklist(_0x2e8652),devices[_0x2e8652]['telegramIpApproval']=null,devices[_0x2e8652][_0x2d3d42(0x361)]=null,devices[_0x2e8652][_0x2d3d42(0x39d)]['token']=null,logger[_0x2d3d42(0x1b9)](_0x2d3d42(0x1ec)+_0x2e8652[_0x2d3d42(0x395)](-0x8)),io['to'](getClient(_0x10c817['id'])[_0x2d3d42(0x2ce)])[_0x2d3d42(0x2d7)](_0x2d3d42(0x3a5),{'access':{'allow':![],'reason':_0x2d3d42(0x3b5),'token':null}});}else logger[_0x2d3d42(0x212)](_0x2d3d42(0x310));});}function initializeSocketBot(_0x53111f){const _0x24dc9c=_0x2a54ee,_0x1d1a97=getClient(_0x53111f['id'])['bot'],_0x235aa5=getClient(_0x53111f['id'])[_0x24dc9c(0x2ce)];_0x53111f['on'](_0x24dc9c(0x24d),(_0x2ac074,_0x488dd3)=>{const _0x2ee855=_0x24dc9c;if(validateAccess(_0x488dd3,_0x235aa5)[_0x2ee855(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x2ee855(0x386)]({'function':'emitHistory','args':_0x2ac074});}else logger[_0x2ee855(0x212)](_0x2ee855(0x1e1));}),_0x53111f['on'](_0x24dc9c(0x1e2),(_0x5d6ac7,_0x1c2e9d)=>{const _0x3f28a7=_0x24dc9c;if(validateAccess(_0x1c2e9d,_0x235aa5)[_0x3f28a7(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x3f28a7(0x386)]({'function':_0x3f28a7(0x26e),'args':_0x5d6ac7});}else logger[_0x3f28a7(0x212)](_0x3f28a7(0x1a8));}),_0x53111f['on']('get-portfolio',(_0x12f825,_0x384e6f)=>{const _0x358d5f=_0x24dc9c;if(validateAccess(_0x384e6f,_0x235aa5)[_0x358d5f(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97]['send']({'function':_0x358d5f(0x278),'args':_0x12f825});}else logger[_0x358d5f(0x212)](_0x358d5f(0x228));}),_0x53111f['on'](_0x24dc9c(0x31c),(_0x169e61,_0x2fe4e2)=>{const _0x174e7f=_0x24dc9c;if(validateAccess(_0x2fe4e2,_0x235aa5)[_0x174e7f(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x174e7f(0x386)]({'function':'storeConfiguration','args':_0x169e61});}else logger[_0x174e7f(0x212)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x53111f['on'](_0x24dc9c(0x2c1),(_0xe59856,_0x5474cf)=>{const _0x1339cf=_0x24dc9c;if(validateAccess(_0x5474cf,_0x235aa5)[_0x1339cf(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97]['send']({'function':'storeHeadless','args':_0xe59856});}else logger[_0x1339cf(0x212)](_0x1339cf(0x261));}),_0x53111f['on'](_0x24dc9c(0x2ed),(_0x18a903,_0x5dafe1)=>{const _0x43d0f3=_0x24dc9c;if(validateAccess(_0x5dafe1,_0x235aa5)[_0x43d0f3(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x43d0f3(0x386)]({'function':_0x43d0f3(0x32e),'args':_0x18a903});}else logger['full'](_0x43d0f3(0x1e8));}),_0x53111f['on']('reset-history',_0x57159e=>{const _0x2f00a2=_0x24dc9c;if(validateAccess(_0x57159e,_0x235aa5)['allow']){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x2f00a2(0x386)]({'function':_0x2f00a2(0x259),'args':null});}else logger['full'](_0x2f00a2(0x1ac));}),_0x53111f['on'](_0x24dc9c(0x1dc),_0x31c5e2=>{const _0x35ccde=_0x24dc9c;if(validateAccess(_0x31c5e2,_0x235aa5)['allow']){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x35ccde(0x386)]({'function':_0x35ccde(0x200),'args':null});}else logger[_0x35ccde(0x212)](_0x35ccde(0x3aa));}),_0x53111f['on']('place-order',(_0xc8cf7d,_0x139938)=>{const _0x1da02d=_0x24dc9c;if(validateAccess(_0x139938,_0x235aa5)[_0x1da02d(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x1da02d(0x386)]({'function':_0x1da02d(0x341),'args':_0xc8cf7d});}else logger[_0x1da02d(0x212)](_0x1da02d(0x356));}),_0x53111f['on']('cancel-loading',_0x5a5a11=>{const _0x29b037=_0x24dc9c;if(validateAccess(_0x5a5a11,_0x235aa5)[_0x29b037(0x336)]){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x29b037(0x386)]({'function':_0x29b037(0x1bd),'args':null});}else logger[_0x29b037(0x212)](_0x29b037(0x3ad));}),_0x53111f['on']('show-config',_0x8afd4b=>{const _0x87b253=_0x24dc9c;if(validateAccess(_0x8afd4b,_0x235aa5)['allow']){if(pid[_0x1d1a97])pid[_0x1d1a97][_0x87b253(0x386)]({'function':_0x87b253(0x2f8),'args':null});}else logger[_0x87b253(0x212)](_0x87b253(0x315));}),_0x53111f['on'](_0x24dc9c(0x391),_0x16af86=>{const _0x936b11=_0x24dc9c;if(validateAccess(_0x16af86,_0x235aa5)['allow'])updateBB(_0x936b11(0x2a7));else logger[_0x936b11(0x212)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x53111f['on'](_0x24dc9c(0x378),_0x5be1a9=>{const _0x226150=_0x24dc9c;if(validateAccess(_0x5be1a9,_0x235aa5)['allow'])getMessages();else logger[_0x226150(0x212)](_0x226150(0x319));}),_0x53111f['on'](_0x24dc9c(0x364),(_0x112b4e,_0x12ac71)=>{const _0x3b7e5c=_0x24dc9c;if(validateAccess(_0x12ac71,_0x235aa5)[_0x3b7e5c(0x336)])confirmMessage(_0x112b4e);else logger[_0x3b7e5c(0x212)](_0x3b7e5c(0x2f9));}),_0x53111f['on'](_0x24dc9c(0x231),_0x5a1023=>{const _0x3eefd9=_0x24dc9c;if(validateAccess(_0x5a1023,_0x235aa5)[_0x3eefd9(0x336)]){if(devices[_0x235aa5][_0x3eefd9(0x39c)])clearTimeout(devices[_0x235aa5]['pidRefreshToken']);if(devices[_0x235aa5][_0x3eefd9(0x1c9)])clearTimeout(devices[_0x235aa5][_0x3eefd9(0x1c9)]);removeSocketListeners(getClient(_0x53111f['id'])['uuid']),addBlacklist(_0x235aa5),devices[_0x235aa5][_0x3eefd9(0x36f)]=null,devices[_0x235aa5][_0x3eefd9(0x361)]=null,devices[_0x235aa5]['access']['token']=null,logger[_0x3eefd9(0x1b9)](_0x3eefd9(0x1ec)+_0x235aa5['slice'](-0x8)),io['to'](getClient(_0x53111f['id'])['uuid'])[_0x3eefd9(0x2d7)](_0x3eefd9(0x3a5),{'access':{'allow':![],'reason':_0x3eefd9(0x3b5),'token':null}});}else logger[_0x3eefd9(0x212)](_0x3eefd9(0x310));});}function removeSocketListeners(_0x50dbb0){getClientsWithUuid(_0x50dbb0)['forEach'](_0x1e3761=>{getSocket(_0x1e3761['id'])['removeAllListeners']();});}function cleanSettings(){const _0x4207c5=_0x2a54ee;let _0x52e6c8=settings;return settings[_0x4207c5(0x363)]&&settings['telegramToken']!=''&&(_0x52e6c8={..._0x52e6c8,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x4207c5(0x204)]!=''&&(_0x52e6c8={..._0x52e6c8,'bbPassword':'************'}),settings[_0x4207c5(0x2cb)]&&settings[_0x4207c5(0x2cb)]!=''&&(_0x52e6c8={..._0x52e6c8,'marketcapApi':_0x4207c5(0x3af)}),(settings[_0x4207c5(0x204)]&&settings[_0x4207c5(0x204)]==_0x4207c5(0x2de)||settings[_0x4207c5(0x363)]&&settings[_0x4207c5(0x363)]==_0x4207c5(0x2de)||settings['marketcapApi']&&settings[_0x4207c5(0x2cb)]==_0x4207c5(0x2de))&&(_0x52e6c8={..._0x52e6c8,'restored':{'password':settings[_0x4207c5(0x204)]=='***','telegram':settings[_0x4207c5(0x363)]==_0x4207c5(0x2de),'marketcap':settings[_0x4207c5(0x2cb)]==_0x4207c5(0x2de)}}),_0x52e6c8;}async function updateBB(_0x47357b){const _0xc75162=_0x2a54ee;await backupConfigFiles(),installingUpdate=!![],config[_0xc75162(0x349)](_0x27c02f=>{const _0xf45cc5=_0xc75162;restartBot(_0x27c02f[_0xf45cc5(0x382)]);});if(_0x47357b=='update')process[_0xc75162(0x386)]({'update':!![],'environment':environment},_0xfb94b0=>{});else _0x47357b==_0xc75162(0x1a6)&&process['send']({'reinstall':!![],'environment':environment},_0x5c1dde=>{});}function startBot(_0x4f8483,_0xbed215,_0x366e3d){const _0x432cf4=_0x2a54ee;if(debugging)_0x4f8483[_0x432cf4(0x249)]('-d');let _0x2dc9a5=![];const _0x3da060=_0x4f8483[0x0];_0xbed215={..._0xbed215,'stdio':[_0x432cf4(0x3b9),_0x432cf4(0x3b9),_0x432cf4(0x3b9),'ipc']},pid[_0x3da060]=childProcess['fork'](botfile,_0x4f8483,_0xbed215),pid[_0x3da060]['on']('message',_0x53f9f2=>{const _0x4a1c7d=_0x432cf4;switch(Object[_0x4a1c7d(0x1bb)](_0x53f9f2)[0x0]){case _0x4a1c7d(0x25b):updateBotName(_0x3da060,_0x53f9f2['botname']);break;case _0x4a1c7d(0x345):updateBotManager();break;case _0x4a1c7d(0x3a5):updateStatus(_0x3da060,_0x53f9f2['status']);break;case'live':updateLive(_0x3da060,_0x53f9f2[_0x4a1c7d(0x230)]);break;case'started':updateLive(_0x3da060,_0x53f9f2[_0x4a1c7d(0x33e)]),io['to'](_0x3da060)['emit']('status',{'access':{'allow':![],'reason':_0x4a1c7d(0x288),'token':null}});break;case _0x4a1c7d(0x2be):_0x53f9f2[_0x4a1c7d(0x2be)]==_0x4a1c7d(0x2ef)&&restartBot(_0x3da060);_0x53f9f2[_0x4a1c7d(0x2be)]==_0x4a1c7d(0x393)&&toggleBot(_0x3da060,_0x4a1c7d(0x26f),_0x4a1c7d(0x2b0));break;case'telegram':sendTelegramBot(_0x3da060,_0x53f9f2[_0x4a1c7d(0x357)]);break;case _0x4a1c7d(0x371):sendTelegramMsg(_0x53f9f2['telegrammsg']);break;case'function':io['to'](_0x3da060)['emit'](_0x53f9f2['function'],_0x53f9f2['args']);break;}}),pid[_0x3da060]['on'](_0x432cf4(0x232),function(_0x2701b2){if(_0x2dc9a5)return;_0x2dc9a5=!![],_0x366e3d(_0x2701b2);}),pid[_0x3da060]['on'](_0x432cf4(0x1b3),async function(_0x593df3){const _0x3d5b1c=_0x432cf4;if(terminating)return;if(installingUpdate){logger[_0x3d5b1c(0x1b9)](_0x3d5b1c(0x31f)),io[_0x3d5b1c(0x23a)]();return;}if(_0x2dc9a5)return;_0x2dc9a5=!![],_0x366e3d(null);const _0x296fa3=dbConfig[_0x3d5b1c(0x30c)]('bots')[_0x3d5b1c(0x1eb)]({'botID':_0x3da060})[_0x3d5b1c(0x268)]();_0x296fa3&&(_0x296fa3[_0x3d5b1c(0x3a5)]==_0x3d5b1c(0x1b8)||_0x296fa3[_0x3d5b1c(0x3a5)]=='new')&&(await sleep(0x3e8),updateLive(_0x3da060,_0x3d5b1c(0x2b0)),logger[_0x3d5b1c(0x212)](_0x3d5b1c(0x2db)+_0x3da060),startBot([_0x3da060,userID],{'cwd':bbpath},function(_0x16cd19){if(_0x16cd19)logger['full'](_0x16cd19);}));});}function stopBot(_0x73ddba){const _0x2d9c3a=_0x2a54ee;getClientsWithBotID(_0x73ddba)['forEach'](_0x57c623=>{const _0x55cb99=_0x16b4;getSocket(_0x57c623['id'])[_0x55cb99(0x1d7)](!![]),removeClient(_0x57c623['id']);}),pid[_0x73ddba]&&(pid[_0x73ddba][_0x2d9c3a(0x393)](),pid[_0x73ddba]=null);}function stopAllBots(){const _0x22f3f6=_0x2a54ee;terminating=!![];const _0x444b97=getEnabledBots();_0x444b97[_0x22f3f6(0x349)](_0x146569=>{const _0x18ae17=_0x22f3f6;stopBot(_0x146569[_0x18ae17(0x382)]);});}function restartBot(_0x3311a5){const _0x2b77fc=_0x2a54ee;if(pid[_0x3311a5])pid[_0x3311a5][_0x2b77fc(0x393)]();}function addBot(){const _0x12c076=_0x2a54ee;let _0x3c82ec;for(let _0x4a6292=0x1;_0x4a6292<0x3e9;_0x4a6292++){_0x3c82ec=_0x4a6292['toString']()[_0x12c076(0x29c)](0x3,'0');let _0x10f5cf=config[_0x12c076(0x1eb)](_0x352da7=>_0x352da7[_0x12c076(0x382)]==_0x3c82ec);if(!_0x10f5cf)break;}if(_0x3c82ec===_0x12c076(0x24a)){logger[_0x12c076(0x212)](_0x12c076(0x38f));return;}logger['full'](_0x12c076(0x25e)+_0x3c82ec),dbConfig[_0x12c076(0x30c)]('bots')[_0x12c076(0x249)]({'botID':_0x3c82ec,'botname':_0x12c076(0x1ba)+_0x3c82ec,'status':_0x12c076(0x20b),'live':''})[_0x12c076(0x28f)](),startBot([_0x3c82ec,userID],{'cwd':bbpath},function(_0xff0153){const _0x31b7d9=_0x12c076;if(_0xff0153)logger[_0x31b7d9(0x212)](_0xff0153);}),config=getConfiguration(),io['to'](_0x12c076(0x355))['emit']('bots',config),broadcastToBots('bots',JSON[_0x12c076(0x3b2)](config));}function deleteBot(_0x1dd991){const _0x39d2b5=_0x2a54ee;getClientsWithBotID(_0x1dd991)[_0x39d2b5(0x349)](_0x498257=>{const _0x15b79e=_0x39d2b5;getSocket(_0x498257['id'])[_0x15b79e(0x1d7)](!![]),removeClient(_0x498257['id']);}),dbConfig[_0x39d2b5(0x30c)](_0x39d2b5(0x3a3))[_0x39d2b5(0x34e)]({'botID':_0x1dd991})[_0x39d2b5(0x28f)](),logger[_0x39d2b5(0x212)]('Deleted\x20Bot\x20'+_0x1dd991),stopBot(_0x1dd991);try{if(fs['existsSync'](path['join'](configpath,_0x39d2b5(0x286)+_0x1dd991+_0x39d2b5(0x2ec))))fs['unlinkSync'](path[_0x39d2b5(0x39a)](configpath,_0x39d2b5(0x286)+_0x1dd991+_0x39d2b5(0x2ec)));if(fs[_0x39d2b5(0x1fd)](path[_0x39d2b5(0x39a)](configpath,_0x39d2b5(0x286)+_0x1dd991+'-events.json')))fs[_0x39d2b5(0x27e)](path['join'](configpath,_0x39d2b5(0x286)+_0x1dd991+_0x39d2b5(0x27f)));if(fs[_0x39d2b5(0x1fd)](path['join'](configpath,_0x39d2b5(0x286)+_0x1dd991+_0x39d2b5(0x1e6))))fs[_0x39d2b5(0x27e)](path[_0x39d2b5(0x39a)](configpath,_0x39d2b5(0x286)+_0x1dd991+'-performance.json'));if(fs[_0x39d2b5(0x1fd)](path['join'](configpath,'bot-'+_0x1dd991+_0x39d2b5(0x2a5))))fs['unlinkSync'](path[_0x39d2b5(0x39a)](configpath,_0x39d2b5(0x286)+_0x1dd991+_0x39d2b5(0x2a5)));}catch(_0x5556e7){if(_0x5556e7)logger[_0x39d2b5(0x212)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x5556e7);}config=getConfiguration(),io['to'](_0x39d2b5(0x355))[_0x39d2b5(0x2d7)](_0x39d2b5(0x3a3),config),broadcastToBots('bots',JSON[_0x39d2b5(0x3b2)](config));}function toggleBot(_0x5becd8,_0x1fd70f,_0x38c994){const _0x5017b3=_0x2a54ee;dbConfig[_0x5017b3(0x30c)](_0x5017b3(0x3a3))[_0x5017b3(0x1eb)]({'botID':_0x5becd8})[_0x5017b3(0x1aa)]({'status':_0x1fd70f})[_0x5017b3(0x1aa)]({'live':_0x38c994})[_0x5017b3(0x28f)]();if(_0x1fd70f==_0x5017b3(0x1b8)||_0x1fd70f==_0x5017b3(0x20b))logger[_0x5017b3(0x212)](_0x5017b3(0x24c)+_0x5becd8),startBot([_0x5becd8,userID],{'cwd':bbpath},function(_0x2ca1ec){const _0x24fe74=_0x5017b3;if(_0x2ca1ec)logger[_0x24fe74(0x212)](_0x2ca1ec);});else(_0x1fd70f=='disabled'||_0x1fd70f=='new-disabled')&&(logger[_0x5017b3(0x212)]('Disabled\x20Bot\x20'+_0x5becd8),stopBot(_0x5becd8));config=getConfiguration(),io['to'](_0x5017b3(0x355))[_0x5017b3(0x2d7)](_0x5017b3(0x3a3),config),broadcastToBots(_0x5017b3(0x3a3),JSON[_0x5017b3(0x3b2)](config));}function toggleStatus(_0x1d317d){const _0x5d01a4=_0x2a54ee;let _0x224469=dbConfig[_0x5d01a4(0x30c)](_0x5d01a4(0x3a3))['find']({'botID':_0x1d317d})['value'](),_0x33d45b;if(_0x224469[_0x5d01a4(0x3a5)]==='enabled')_0x33d45b=_0x5d01a4(0x26f);else{if(_0x224469[_0x5d01a4(0x3a5)]===_0x5d01a4(0x20b))_0x33d45b=_0x5d01a4(0x36b);else{if(_0x224469[_0x5d01a4(0x3a5)]==='new-disabled')_0x33d45b='new';else{if(_0x224469[_0x5d01a4(0x3a5)]===_0x5d01a4(0x26f))_0x33d45b='enabled';}}}return _0x33d45b;}function updateStatus(_0x438df0,_0x4c6268){const _0x96377c=_0x2a54ee;dbConfig[_0x96377c(0x30c)](_0x96377c(0x3a3))[_0x96377c(0x1eb)]({'botID':_0x438df0})[_0x96377c(0x1aa)]({'status':_0x4c6268})[_0x96377c(0x28f)](),config=getConfiguration(),io['to'](_0x96377c(0x355))[_0x96377c(0x2d7)](_0x96377c(0x3a3),config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x5d98d2,_0x11b933){const _0x49a3ae=_0x2a54ee;dbConfig['get'](_0x49a3ae(0x3a3))[_0x49a3ae(0x1eb)]({'botID':_0x5d98d2})[_0x49a3ae(0x1aa)]({'live':_0x11b933})[_0x49a3ae(0x28f)](),config=getConfiguration(),io['to']('botmanager')[_0x49a3ae(0x2d7)](_0x49a3ae(0x3a3),config),broadcastToBots('bots',JSON[_0x49a3ae(0x3b2)](config));}function updateBotName(_0x563b59,_0x3b1b54){const _0x505f42=_0x2a54ee;dbConfig[_0x505f42(0x30c)]('bots')['find']({'botID':_0x563b59})['assign']({'botname':_0x3b1b54})[_0x505f42(0x28f)](),config=getConfiguration(),io['to']('botmanager')[_0x505f42(0x2d7)]('bots',config),broadcastToBots('bots',JSON[_0x505f42(0x3b2)](config));}function updateBotManager(){const _0x1de5b7=_0x2a54ee;config=getConfiguration(),io['to'](_0x1de5b7(0x355))['emit'](_0x1de5b7(0x3a3),config),broadcastToBots(_0x1de5b7(0x3a3),JSON[_0x1de5b7(0x3b2)](config));}function toggleBotMode(_0x3b6176){const _0x1d801f=_0x2a54ee;if(pid[_0x3b6176])pid[_0x3b6176][_0x1d801f(0x386)]({'function':_0x1d801f(0x1cc),'args':null});else{const _0x36c402=configpath+_0x1d801f(0x286)+_0x3b6176+_0x1d801f(0x2ec),_0xd7822b=fs[_0x1d801f(0x29f)](_0x36c402),_0x20ab3e=JSON[_0x1d801f(0x279)](_0xd7822b),_0x996aa6=_0x20ab3e[_0x1d801f(0x220)][0x0][_0x1d801f(0x270)];_0x20ab3e['bot'][0x0][_0x1d801f(0x270)]=!_0x996aa6;const _0x3eb7d8=JSON['stringify'](_0x20ab3e,null,0x2);fs[_0x1d801f(0x302)](_0x36c402,_0x3eb7d8),config=getConfiguration(),io['to'](_0x1d801f(0x355))[_0x1d801f(0x2d7)](_0x1d801f(0x3a3),config),broadcastToBots(_0x1d801f(0x3a3),JSON[_0x1d801f(0x3b2)](config));}}function validateTelegram(_0x372845){const _0x15c6d0=_0x2a54ee;if(_0x372845[_0x15c6d0(0x26c)][_0x15c6d0(0x248)]!=settings[_0x15c6d0(0x317)]&&'@'+_0x372845[_0x15c6d0(0x26c)][_0x15c6d0(0x248)]!=settings['telegramUsername']||_0x372845[_0x15c6d0(0x36c)]['id']!=settings[_0x15c6d0(0x29a)])return sendTelegram(_0x372845[_0x15c6d0(0x36c)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x15c6d0(0x377)}),![];return!![];}async function initTelegram(){const _0x5132a8=_0x2a54ee;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x5132a8(0x363)]);let _0x122baa=_0x5132a8(0x328);_0x122baa+='\x0a',_0x122baa+=_0x5132a8(0x351),_0x122baa+='/disable\x20-\x20disable\x20notifications\x0a',_0x122baa+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x122baa+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x122baa+=_0x5132a8(0x277),_0x122baa+='/off\x20-\x20stop\x20bot(s)\x0a',_0x122baa+=_0x5132a8(0x1da),_0x122baa+='/names\x20-\x20show\x20bot\x20names\x0a',_0x122baa+=_0x5132a8(0x32c),_0x122baa+=_0x5132a8(0x2c0),_0x122baa+=_0x5132a8(0x1b4),_0x122baa+=_0x5132a8(0x1d0),_0x122baa+=_0x5132a8(0x342),_0x122baa+=_0x5132a8(0x1d5);let _0x2f9146='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2f9146+='\x0a',_0x2f9146+=_0x122baa,tgBot[_0x5132a8(0x1df)]((_0x2ad743,_0x1f94b6)=>{const _0x189963=_0x5132a8;logger[_0x189963(0x2a1)](getTimeStamp()+_0x189963(0x33d)),logger[_0x189963(0x1b9)](_0x189963(0x3b3),_0x2ad743);}),tgBot[_0x5132a8(0x2fe)](async(_0x4dce5b,_0x2a4ddf)=>{const _0x2d555b=_0x5132a8;if(!(!settings['telegramChatId']&&_0x4dce5b[_0x2d555b(0x2a7)][_0x2d555b(0x1dd)][_0x2d555b(0x34f)]==_0x2d555b(0x1c0))){if(!validateTelegram(_0x4dce5b))return;}_0x2a4ddf();}),tgBot[_0x5132a8(0x2bd)]('start',async _0xbd3e2=>{const _0x3799e8=_0x5132a8;if(!settings[_0x3799e8(0x29a)])updateSetting(_0x3799e8(0x29a),_0xbd3e2[_0x3799e8(0x36c)]['id']);updateSetting(_0x3799e8(0x250),!![]);if(!validateTelegram(_0xbd3e2))return;await sendTelegram(_0xbd3e2[_0x3799e8(0x36c)]['id'],_0x2f9146);}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x281),async _0x5a2d36=>{const _0x58c31b=_0x5132a8;updateSetting(_0x58c31b(0x250),!![]),await sendTelegram(_0x5a2d36['chat']['id'],_0x58c31b(0x362));}),tgBot['command'](_0x5132a8(0x31e),async _0x3db77d=>{const _0x40551e=_0x5132a8;await sendTelegram(_0x3db77d[_0x40551e(0x36c)]['id'],_0x40551e(0x27d)),updateSetting(_0x40551e(0x250),![]);}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x29b),async _0x5bce20=>{const _0x4a6b33=_0x5132a8,_0xd838b4=Markup[_0x4a6b33(0x390)]([Markup[_0x4a6b33(0x35b)][_0x4a6b33(0x213)](_0x4a6b33(0x201),'config_orders'),Markup[_0x4a6b33(0x35b)]['callback'](_0x4a6b33(0x235),'config_alerts'),Markup[_0x4a6b33(0x35b)][_0x4a6b33(0x213)](_0x4a6b33(0x2a3),_0x4a6b33(0x247))]);_0x5bce20[_0x4a6b33(0x240)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0xd838b4);}),tgBot[_0x5132a8(0x238)](_0x5132a8(0x2e6),async _0x2d2ed6=>{const _0x5179b4=_0x5132a8;_0x2d2ed6['editMessageReplyMarkup'](),updateSetting(_0x5179b4(0x3a1),_0x5179b4(0x1c7)),updateSetting(_0x5179b4(0x250),!![]),await sendTelegram(_0x2d2ed6[_0x5179b4(0x36c)]['id'],_0x5179b4(0x337));}),tgBot[_0x5132a8(0x238)](_0x5132a8(0x375),async _0x88039b=>{const _0x1618aa=_0x5132a8;_0x88039b[_0x1618aa(0x2e1)](),updateSetting(_0x1618aa(0x3a1),_0x1618aa(0x276)),updateSetting(_0x1618aa(0x250),!![]),await sendTelegram(_0x88039b[_0x1618aa(0x36c)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x5132a8(0x238)](_0x5132a8(0x247),async _0x1b5204=>{const _0x3ac2b6=_0x5132a8;_0x1b5204['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x3ac2b6(0x392)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1b5204[_0x3ac2b6(0x36c)]['id'],_0x3ac2b6(0x344));}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x3a5),async _0x5babe7=>{const _0x118ebd=_0x5132a8,_0x139c24=getBotsWithMode();let _0x24f071=_0x118ebd(0x358);config[_0x118ebd(0x349)](_0x59797e=>{const _0x454539=_0x118ebd,_0xe87a7c=_0x139c24[_0x454539(0x1eb)](_0x1387b0=>_0x1387b0[_0x454539(0x382)]==_0x59797e[_0x454539(0x382)])[_0x454539(0x398)];_0x24f071+=_0x454539(0x1ba)+_0x59797e[_0x454539(0x382)]+':\x20'+_0x59797e[_0x454539(0x3a5)]+_0x454539(0x210)+_0xe87a7c+_0x454539(0x210)+_0x59797e['live']+'\x0a';}),_0x24f071+='\x0a',_0x24f071+=_0x118ebd(0x295),_0x24f071+=!settings[_0x118ebd(0x250)]?_0x118ebd(0x3b8):_0x118ebd(0x381),_0x24f071+=settings[_0x118ebd(0x250)]?settings[_0x118ebd(0x3a1)]==_0x118ebd(0x392)?_0x118ebd(0x2b4):_0x118ebd(0x3ae)+settings['telegramEvents']+_0x118ebd(0x214):'',await sendTelegram(_0x5babe7[_0x118ebd(0x36c)]['id'],_0x24f071,{'parse_mode':_0x118ebd(0x377)});}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x2ef),async _0x455deb=>{const _0xe7ece1=_0x5132a8,_0x47902c=getEnabledBots();if(_0x47902c[_0xe7ece1(0x330)]==0x0)await sendTelegram(_0x455deb[_0xe7ece1(0x36c)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x47902c[_0xe7ece1(0x330)]>0x1)_0x47902c[_0xe7ece1(0x249)]({'botID':_0xe7ece1(0x392)});let _0x2cb609=[],_0x1a9074=[];const _0x30f59f=_0x47902c[_0xe7ece1(0x330)]%0x4==0x0||_0x47902c[_0xe7ece1(0x330)]%0x4==0x3||_0x47902c[_0xe7ece1(0x330)]%0x3==0x1?0x4:0x3;let _0x1e4bb3=0x0;_0x47902c['forEach']((_0x1aa28e,_0x136193)=>{const _0xb84990=_0xe7ece1;if(_0x136193%_0x30f59f==0x0)_0x1a9074=[];_0x1a9074[_0xb84990(0x249)](Markup[_0xb84990(0x35b)][_0xb84990(0x213)](_0x1aa28e[_0xb84990(0x382)]==_0xb84990(0x392)?_0xb84990(0x37d):_0xb84990(0x1ba)+_0x1aa28e['botID'],_0xb84990(0x3a8)+_0x1aa28e[_0xb84990(0x382)])),_0x136193%_0x30f59f==0x0&&(_0x2cb609[_0x1e4bb3]=_0x1a9074,_0x1e4bb3++);});const _0x383cb9=Markup[_0xe7ece1(0x390)](_0x2cb609);_0x455deb[_0xe7ece1(0x240)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x383cb9);}}),tgBot['action'](/restart_(.+)/,async _0x1ae2db=>{const _0x4176e4=_0x5132a8,_0x5c08bf=_0x1ae2db[_0x4176e4(0x223)][0x1];_0x1ae2db['editMessageReplyMarkup'](),_0x5c08bf==_0x4176e4(0x392)?config['forEach'](_0x2b28c8=>{restartBot(_0x2b28c8['botID']);}):restartBot(_0x5c08bf);}),tgBot[_0x5132a8(0x2bd)]('on',async _0x5d09f9=>{const _0x371305=_0x5132a8,_0x24c2a5=getDisabledBots();if(_0x24c2a5[_0x371305(0x330)]==0x0)await sendTelegram(_0x5d09f9[_0x371305(0x36c)]['id'],_0x371305(0x347));else{if(_0x24c2a5[_0x371305(0x330)]>0x1)_0x24c2a5['push']({'botID':_0x371305(0x392)});let _0x32d936=[],_0x139320=[];const _0x50d4d2=_0x24c2a5['length']%0x4==0x0||_0x24c2a5['length']%0x4==0x3||_0x24c2a5[_0x371305(0x330)]%0x3==0x1?0x4:0x3;let _0x4106b1=0x0;_0x24c2a5[_0x371305(0x349)]((_0x4eaeed,_0x22efbd)=>{const _0x346388=_0x371305;if(_0x22efbd%_0x50d4d2==0x0)_0x139320=[];_0x139320[_0x346388(0x249)](Markup['button'][_0x346388(0x213)](_0x4eaeed[_0x346388(0x382)]==_0x346388(0x392)?_0x346388(0x37d):_0x346388(0x1ba)+_0x4eaeed[_0x346388(0x382)],_0x346388(0x216)+_0x4eaeed[_0x346388(0x382)])),_0x22efbd%_0x50d4d2==0x0&&(_0x32d936[_0x4106b1]=_0x139320,_0x4106b1++);});const _0x2ee953=Markup['inlineKeyboard'](_0x32d936);_0x5d09f9['reply'](_0x371305(0x1b2),_0x2ee953);}}),tgBot['action'](/on_(.+)/,async _0x1534f6=>{const _0x53146e=_0x5132a8,_0xa30783=_0x1534f6[_0x53146e(0x223)][0x1];_0x1534f6[_0x53146e(0x2e1)]();if(_0xa30783==_0x53146e(0x392)){const _0x1c2d63=getDisabledBots();await sendTelegram(_0x1534f6[_0x53146e(0x36c)]['id'],_0x53146e(0x257)),_0x1c2d63[_0x53146e(0x349)](_0x162d04=>{const _0x3b7c31=_0x53146e;if(_0x162d04[_0x3b7c31(0x382)]!='all')toggleBot(_0x162d04[_0x3b7c31(0x382)],toggleStatus(_0x162d04[_0x3b7c31(0x382)]),'stopped');});}else await sendTelegram(_0x1534f6[_0x53146e(0x36c)]['id'],_0x53146e(0x253)+_0xa30783),toggleBot(_0xa30783,toggleStatus(_0xa30783),'stopped');}),tgBot['command'](_0x5132a8(0x343),async _0x2d59b7=>{const _0x2fd807=_0x5132a8,_0x5389bc=getEnabledBots();if(_0x5389bc[_0x2fd807(0x330)]==0x0)await sendTelegram(_0x2d59b7[_0x2fd807(0x36c)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x5389bc[_0x2fd807(0x330)]>0x1)_0x5389bc[_0x2fd807(0x249)]({'botID':_0x2fd807(0x392)});let _0x29570d=[],_0x150932=[];const _0x2c42d4=_0x5389bc[_0x2fd807(0x330)]%0x4==0x0||_0x5389bc['length']%0x4==0x3||_0x5389bc['length']%0x3==0x1?0x4:0x3;let _0x272cfa=0x0;_0x5389bc[_0x2fd807(0x349)]((_0x24738c,_0x48b685)=>{const _0x20d1c9=_0x2fd807;if(_0x48b685%_0x2c42d4==0x0)_0x150932=[];_0x150932[_0x20d1c9(0x249)](Markup[_0x20d1c9(0x35b)][_0x20d1c9(0x213)](_0x24738c[_0x20d1c9(0x382)]=='all'?_0x20d1c9(0x37d):_0x20d1c9(0x1ba)+_0x24738c[_0x20d1c9(0x382)],_0x20d1c9(0x264)+_0x24738c['botID'])),_0x48b685%_0x2c42d4==0x0&&(_0x29570d[_0x272cfa]=_0x150932,_0x272cfa++);});const _0x35e883=Markup[_0x2fd807(0x390)](_0x29570d);_0x2d59b7['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x35e883);}}),tgBot[_0x5132a8(0x238)](/off_(.+)/,async _0x2dd6a0=>{const _0x50397c=_0x5132a8,_0x17d868=_0x2dd6a0['match'][0x1];_0x2dd6a0['editMessageReplyMarkup']();if(_0x17d868==_0x50397c(0x392)){const _0x10206b=getEnabledBots();await sendTelegram(_0x2dd6a0['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x10206b[_0x50397c(0x349)](_0x58b78b=>{const _0x260fe0=_0x50397c;if(_0x58b78b[_0x260fe0(0x382)]!=_0x260fe0(0x392))toggleBot(_0x58b78b[_0x260fe0(0x382)],toggleStatus(_0x58b78b[_0x260fe0(0x382)]),'stopped');});}else await sendTelegram(_0x2dd6a0[_0x50397c(0x36c)]['id'],_0x50397c(0x233)+_0x17d868),toggleBot(_0x17d868,toggleStatus(_0x17d868),_0x50397c(0x2b0));}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x1f9),async _0x290b3e=>{const _0x5102bf=_0x5132a8,_0x5171=getEnabledBots();if(_0x5171['length']==0x0)await sendTelegram(_0x290b3e['chat']['id'],_0x5102bf(0x1bf));else{if(_0x5171['length']>0x1){let _0x4271ca=[],_0x202a0a=[];const _0x2690ce=_0x5171['length']%0x4==0x0||_0x5171[_0x5102bf(0x330)]%0x4==0x3||_0x5171[_0x5102bf(0x330)]%0x3==0x1?0x4:0x3;let _0x258d95=0x0;_0x5171[_0x5102bf(0x349)]((_0x40e32d,_0x2106dc)=>{const _0x1a6042=_0x5102bf;if(_0x2106dc%_0x2690ce==0x0)_0x202a0a=[];_0x202a0a['push'](Markup['button'][_0x1a6042(0x213)]('Bot\x20'+_0x40e32d[_0x1a6042(0x382)],_0x1a6042(0x2a2)+_0x40e32d['botID'])),_0x2106dc%_0x2690ce==0x0&&(_0x4271ca[_0x258d95]=_0x202a0a,_0x258d95++);});const _0x434a1a=Markup[_0x5102bf(0x390)](_0x4271ca);_0x290b3e['reply'](_0x5102bf(0x37f),_0x434a1a);}else{const _0x42ff23=_0x5171[0x0][_0x5102bf(0x382)];if(pid[_0x42ff23])pid[_0x42ff23][_0x5102bf(0x386)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x5132a8(0x238)](/metrics_(.+)/,async _0x2ec93d=>{const _0x46058a=_0x5132a8,_0x41ad8b=_0x2ec93d['match'][0x1];_0x2ec93d['editMessageReplyMarkup']();if(pid[_0x41ad8b])pid[_0x41ad8b][_0x46058a(0x386)]({'function':_0x46058a(0x39e),'args':null});}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x2c2),async _0x4a05a5=>{const _0x38d484=_0x5132a8,_0x19b406=getEnabledBots();if(_0x19b406[_0x38d484(0x330)]==0x0)await sendTelegram(_0x4a05a5[_0x38d484(0x36c)]['id'],_0x38d484(0x1bf));else{if(_0x19b406['length']>0x1){let _0x1e2666=[],_0x379ead=[];const _0x3ea55c=_0x19b406[_0x38d484(0x330)]%0x4==0x0||_0x19b406[_0x38d484(0x330)]%0x4==0x3||_0x19b406[_0x38d484(0x330)]%0x3==0x1?0x4:0x3;let _0x45c158=0x0;_0x19b406[_0x38d484(0x349)]((_0x535aa8,_0x313f91)=>{const _0x59ae3c=_0x38d484;if(_0x313f91%_0x3ea55c==0x0)_0x379ead=[];_0x379ead[_0x59ae3c(0x249)](Markup[_0x59ae3c(0x35b)][_0x59ae3c(0x213)]('Bot\x20'+_0x535aa8[_0x59ae3c(0x382)],_0x59ae3c(0x1f7)+_0x535aa8[_0x59ae3c(0x382)])),_0x313f91%_0x3ea55c==0x0&&(_0x1e2666[_0x45c158]=_0x379ead,_0x45c158++);});const _0x1e78a4=Markup[_0x38d484(0x390)](_0x1e2666);_0x4a05a5[_0x38d484(0x240)](_0x38d484(0x2d2),_0x1e78a4);}else{const _0x312dec=_0x19b406[0x0][_0x38d484(0x382)];if(pid[_0x312dec])pid[_0x312dec][_0x38d484(0x386)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x5132a8(0x238)](/portfolio_(.+)/,async _0x54cd9a=>{const _0x2ccb31=_0x5132a8,_0x480bce=_0x54cd9a[_0x2ccb31(0x223)][0x1];_0x54cd9a[_0x2ccb31(0x2e1)]();if(pid[_0x480bce])pid[_0x480bce]['send']({'function':_0x2ccb31(0x329),'args':null});}),tgBot['command']('update',async _0x106673=>{const _0x3d5fe0=_0x5132a8;await getMessages();if(!updateAvailable)await sendTelegram(_0x106673['chat']['id'],_0x3d5fe0(0x1fa));else{if(!validInstallation)await sendTelegram(_0x106673[_0x3d5fe0(0x36c)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x546fe5=Markup['inlineKeyboard']([Markup[_0x3d5fe0(0x35b)][_0x3d5fe0(0x213)](_0x3d5fe0(0x28e),'update_yes'),Markup[_0x3d5fe0(0x35b)][_0x3d5fe0(0x213)]('No',_0x3d5fe0(0x1f5))]);_0x106673[_0x3d5fe0(0x240)](_0x3d5fe0(0x1ea),_0x546fe5);}}}),tgBot[_0x5132a8(0x238)](/update_(.+)/,async _0x571af1=>{const _0x377715=_0x5132a8,_0x34c225=_0x571af1[_0x377715(0x223)][0x1];_0x571af1['editMessageReplyMarkup'](),_0x34c225=='yes'&&(await sendTelegram(_0x571af1[_0x377715(0x36c)]['id'],_0x377715(0x2f0)),updateBB(_0x377715(0x2a7))),_0x34c225=='no'&&await sendTelegram(_0x571af1['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x1a6),async _0xfdbbe3=>{const _0x51f222=_0x5132a8;if(!validInstallation)await sendTelegram(_0xfdbbe3[_0x51f222(0x36c)]['id'],_0x51f222(0x369));else{const _0x4dd92d=Markup[_0x51f222(0x390)]([Markup[_0x51f222(0x35b)]['callback'](_0x51f222(0x28e),_0x51f222(0x312)),Markup[_0x51f222(0x35b)][_0x51f222(0x213)]('No',_0x51f222(0x20a))]);_0xfdbbe3['reply'](_0x51f222(0x256),_0x4dd92d);}}),tgBot[_0x5132a8(0x238)](/reinstall_(.+)/,async _0x2daa50=>{const _0x27ad41=_0x5132a8,_0x5c49b2=_0x2daa50['match'][0x1];_0x2daa50[_0x27ad41(0x2e1)](),_0x5c49b2==_0x27ad41(0x2b5)&&(await sendTelegram(_0x2daa50[_0x27ad41(0x36c)]['id'],_0x27ad41(0x28b)),updateBB(_0x27ad41(0x1a6))),_0x5c49b2=='no'&&await sendTelegram(_0x2daa50[_0x27ad41(0x36c)]['id'],_0x27ad41(0x2a8));}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x289),async _0x1d03b3=>{const _0x2fb898=_0x5132a8,_0x40eb66=getBotsWithMode();if(_0x40eb66[_0x2fb898(0x330)]==0x0)await sendTelegram(_0x1d03b3[_0x2fb898(0x36c)]['id'],_0x2fb898(0x1bf));else{let _0x3493ba=[],_0x54f55a=[];const _0x35b9fd=0x2;let _0x4710bf=0x0;_0x40eb66[_0x2fb898(0x349)]((_0xb60ed7,_0xde7664)=>{const _0x13d5ff=_0x2fb898;if(_0xde7664%_0x35b9fd==0x0)_0x54f55a=[];_0x54f55a[_0x13d5ff(0x249)](Markup['button'][_0x13d5ff(0x213)](_0x13d5ff(0x1ba)+_0xb60ed7[_0x13d5ff(0x382)]+'\x20('+_0xb60ed7['mode']+')',_0x13d5ff(0x1c5)+_0xb60ed7['botID'])),_0xde7664%_0x35b9fd==0x0&&(_0x3493ba[_0x4710bf]=_0x54f55a,_0x4710bf++);});const _0x8b766c=Markup['inlineKeyboard'](_0x3493ba);_0x1d03b3[_0x2fb898(0x240)](_0x2fb898(0x28d),_0x8b766c);}}),tgBot[_0x5132a8(0x238)](/toggle_(.+)/,async _0x4efa74=>{const _0x597cc4=_0x5132a8,_0x117d77=_0x4efa74[_0x597cc4(0x223)][0x1];_0x4efa74[_0x597cc4(0x2e1)]();const _0x35d9f0=getBotsWithMode(),_0x3240c6=_0x35d9f0[_0x597cc4(0x1eb)](_0x223e14=>_0x223e14['botID']==_0x117d77),_0x40a96e=_0x3240c6[_0x597cc4(0x398)]==_0x597cc4(0x316)?'manual':_0x597cc4(0x316);await sendTelegram(_0x4efa74['chat']['id'],_0x597cc4(0x1b7)+_0x117d77+_0x597cc4(0x35f)+_0x40a96e+_0x597cc4(0x1d4)),toggleBotMode(_0x117d77);}),tgBot['command'](_0x5132a8(0x298),async _0x3c015d=>{const _0x466ffb=_0x5132a8;let _0x3494ed='';config[_0x466ffb(0x349)](_0x403543=>{const _0x37f8c2=_0x466ffb;_0x3494ed+='Bot\x20'+_0x403543[_0x37f8c2(0x382)]+':\x20'+_0x403543[_0x37f8c2(0x25b)]+'\x0a';}),await sendTelegram(_0x3c015d[_0x466ffb(0x36c)]['id'],_0x3494ed,{'parse_mode':'HTML'});}),tgBot[_0x5132a8(0x2bd)](_0x5132a8(0x2f1),async _0x3d2dac=>{const _0x3e547d=_0x5132a8;await sendTelegram(_0x3d2dac[_0x3e547d(0x36c)]['id'],_0x122baa);}),process[_0x5132a8(0x218)](_0x5132a8(0x2f5),()=>tgBot[_0x5132a8(0x2be)](_0x5132a8(0x2f5))),process[_0x5132a8(0x218)]('SIGTERM',()=>tgBot[_0x5132a8(0x2be)](_0x5132a8(0x275))),tgBot['launch']();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x4c89aa,_0x90eefa,_0x39002d){const _0x45f242=_0x2a54ee;_0x39002d={..._0x39002d,'disable_web_page_preview':!![]};try{await tgBot[_0x45f242(0x357)][_0x45f242(0x314)](_0x4c89aa,_0x90eefa,_0x39002d);}catch(_0x324cbf){console[_0x45f242(0x28a)](_0x45f242(0x2fa),_0x324cbf);}}function _0x16b4(_0x4f49a8,_0x54215d){const _0x8c7008=_0x5bd4();return _0x16b4=function(_0xdaf8d7,_0x3592c1){_0xdaf8d7=_0xdaf8d7-0x1a4;let _0x5bd421=_0x8c7008[_0xdaf8d7];return _0x5bd421;},_0x16b4(_0x4f49a8,_0x54215d);}async function sendTelegramBot(_0x4e1a88,_0x4f9237){const _0x44922b=_0x2a54ee;if(settings[_0x44922b(0x250)]){if(settings[_0x44922b(0x3a1)]==_0x44922b(0x392)||(_0x4f9237[_0x44922b(0x2c3)]==_0x44922b(0x232)||_0x4f9237[_0x44922b(0x2c3)]==_0x44922b(0x1d8)||_0x4f9237[_0x44922b(0x2c3)]=='success')&&settings['telegramEvents']==_0x44922b(0x276)||_0x4f9237[_0x44922b(0x2c3)]=='order'&&settings[_0x44922b(0x3a1)]=='orders'){if(tgBot&&settings[_0x44922b(0x29a)]){if(_0x4f9237[_0x44922b(0x35c)])await sendTelegram(settings[_0x44922b(0x29a)],_0x4f9237['botname']+_0x44922b(0x2af)+_0x4f9237['event']);else await sendTelegram(settings[_0x44922b(0x29a)],'Bot\x20'+_0x4e1a88+'\x20>\x20'+_0x4f9237[_0x44922b(0x3a0)]);}}}}async function sendTelegramMsg(_0x4ab10e,_0x4f196f=_0x2a54ee(0x377)){const _0x24bc74=_0x2a54ee;return settings[_0x24bc74(0x250)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x24bc74(0x29a)],_0x4ab10e,{'parse_mode':_0x4f196f}),!![]):![];}function getDeviceWithIp(_0x228c4d){const _0x103043=_0x2a54ee;return devices[_0x103043(0x1eb)](_0x13c3c4=>_0x13c3c4['ip']===_0x228c4d);}async function temporaryAccess2FA(_0x273537,_0x275ff5){const _0xd7678d=_0x2a54ee;let _0x2a306b=new Date(),_0x18ace7=![];if(lastIpApproval){if(_0x2a306b-lastIpApproval<0x1388)_0x18ace7=!![];}lastIpApproval=new Date();if(_0x18ace7)return;if(tgBot&&settings[_0xd7678d(0x29a)]){const _0x3a82a0=uuidRandom();tmpStorage[_0x3a82a0]={'uuid':_0x273537,'externalip':_0x275ff5};const _0x4134c2=Markup[_0xd7678d(0x390)]([Markup[_0xd7678d(0x35b)][_0xd7678d(0x213)]('5\x20min',_0xd7678d(0x265)+_0x3a82a0),Markup['button'][_0xd7678d(0x213)](_0xd7678d(0x307),'tempaccess_15_'+_0x3a82a0),Markup[_0xd7678d(0x35b)][_0xd7678d(0x213)](_0xd7678d(0x22f),_0xd7678d(0x221)+_0x3a82a0),Markup[_0xd7678d(0x35b)][_0xd7678d(0x213)](_0xd7678d(0x2cf),_0xd7678d(0x1e7)+_0x3a82a0)]);await sendTelegram(settings['telegramChatId'],_0xd7678d(0x354)+normalizeIP(_0x275ff5)['show']+'\x20?',_0x4134c2),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0xea9af3=>{const _0x41fa59=_0xd7678d,_0xe9c55f=_0xea9af3[_0x41fa59(0x223)][0x1],_0x39fec1=_0xea9af3[_0x41fa59(0x223)][0x2],{uuid:_0x597815,externalip:_0x2f9c93}=tmpStorage[_0x39fec1];delete tmpStorage[_0x39fec1],_0xea9af3['editMessageReplyMarkup'](),devices[_0x597815]['telegramIpApproval']={'clientip':_0x2f9c93,'timestamp':new Date()[_0x41fa59(0x34b)](),'expiry':_0xe9c55f},_0xe9c55f!=_0x41fa59(0x2cf)?(await sendTelegram(_0xea9af3['chat']['id'],_0x41fa59(0x1d3)+_0xe9c55f+_0x41fa59(0x20c),{'parse_mode':_0x41fa59(0x377)}),io['to'](_0x597815)['emit'](_0x41fa59(0x3a5),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0xea9af3['chat']['id'],_0x41fa59(0x296)),io['to'](_0x597815)[_0x41fa59(0x2d7)](_0x41fa59(0x3a5),{'access':{'allow':![],'reason':_0x41fa59(0x2f4),'token':null}}));});}}async function loginAccess2FA(_0x520901,_0x37d913){const _0x2fcaec=_0x2a54ee;if(tgBot&&settings[_0x2fcaec(0x29a)]){const _0x12bbe6=uuidRandom();tmpStorage[_0x12bbe6]={'uuid':_0x520901,'externalip':_0x37d913};const _0x45cb10=Markup['inlineKeyboard']([Markup[_0x2fcaec(0x35b)]['callback'](_0x2fcaec(0x1c3),_0x2fcaec(0x3a4)+loginExpiry+'_'+_0x12bbe6),Markup['button'][_0x2fcaec(0x213)](_0x2fcaec(0x2cf),_0x2fcaec(0x38a)+_0x12bbe6)]);await sendTelegram(settings[_0x2fcaec(0x29a)],_0x2fcaec(0x2d0)+normalizeIP(_0x37d913)['show']+'\x20?',_0x45cb10),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x3a5f5d=>{const _0x5b602b=_0x2fcaec,_0x4b7050=_0x3a5f5d[_0x5b602b(0x223)][0x1],_0x1766b6=_0x3a5f5d['match'][0x2],{uuid:_0x41d0d9,externalip:_0x28b169}=tmpStorage[_0x1766b6];delete tmpStorage[_0x1766b6],_0x3a5f5d[_0x5b602b(0x2e1)](),devices[_0x41d0d9][_0x5b602b(0x361)]={'clientip':_0x28b169,'timestamp':new Date()[_0x5b602b(0x34b)](),'expiry':_0x4b7050},_0x4b7050!=_0x5b602b(0x2cf)?(await sendTelegram(_0x3a5f5d[_0x5b602b(0x36c)]['id'],_0x5b602b(0x21f),{'parse_mode':'HTML'}),io['to'](_0x41d0d9)[_0x5b602b(0x2d7)](_0x5b602b(0x3a5),{'access':{'allow':![],'reason':_0x5b602b(0x288),'token':null}})):(await sendTelegram(_0x3a5f5d[_0x5b602b(0x36c)]['id'],_0x5b602b(0x2b2)),io['to'](_0x41d0d9)[_0x5b602b(0x2d7)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x469604=_0x2a54ee;return dbConfig['get'](_0x469604(0x3a3))[_0x469604(0x2bf)](_0x469604(0x382))[_0x469604(0x3b0)]({'status':_0x469604(0x1b8)})[_0x469604(0x268)]()||[];}function getDisabledBots(){const _0x144d14=_0x2a54ee;return dbConfig[_0x144d14(0x30c)](_0x144d14(0x3a3))[_0x144d14(0x2bf)](_0x144d14(0x382))[_0x144d14(0x3b0)]({'status':_0x144d14(0x26f)})[_0x144d14(0x268)]()||[];}function getBotAttributes(_0x4cdcc7){const _0x2d68b3=_0x2a54ee;let _0x5f449b={};const _0x1b8c6c=configpath+_0x2d68b3(0x286)+_0x4cdcc7+_0x2d68b3(0x2ec),_0x19d4be=fs[_0x2d68b3(0x1fd)](_0x1b8c6c);if(_0x19d4be){const _0x357e27=fs[_0x2d68b3(0x29f)](_0x1b8c6c);try{const _0x408cf8=JSON[_0x2d68b3(0x279)](_0x357e27),_0x6a2075=_0x408cf8?_0x408cf8[_0x2d68b3(0x220)][0x0][_0x2d68b3(0x270)]:![];_0x5f449b[_0x2d68b3(0x398)]=_0x6a2075?_0x2d68b3(0x316):_0x2d68b3(0x2b8),_0x5f449b['botname']=_0x408cf8?_0x408cf8[_0x2d68b3(0x220)][0x0]['botname']:_0x2d68b3(0x1ba)+_0x4cdcc7;}catch(_0x3fe804){_0x5f449b['mode']='manual',_0x5f449b['botname']=_0x2d68b3(0x1ba)+_0x4cdcc7;}}else _0x5f449b[_0x2d68b3(0x398)]=_0x2d68b3(0x2b8),_0x5f449b[_0x2d68b3(0x25b)]=_0x2d68b3(0x1ba)+_0x4cdcc7;return _0x5f449b;}function getBotsWithMode(){const _0x2b8ee6=_0x2a54ee,_0x37473b=dbConfig[_0x2b8ee6(0x30c)](_0x2b8ee6(0x3a3))['sortBy'](_0x2b8ee6(0x382))['value']()||[];return _0x37473b[_0x2b8ee6(0x349)](_0x2c8011=>{const _0x32d026=_0x2b8ee6;let _0x3df566=getBotAttributes(_0x2c8011[_0x32d026(0x382)]);_0x2c8011[_0x32d026(0x398)]=_0x3df566[_0x32d026(0x398)];}),_0x37473b;}function getBotExchanges(){const _0x6de38f=_0x2a54ee;let _0x484347=[];const _0x427b55=dbConfig['get'](_0x6de38f(0x3a3))[_0x6de38f(0x2bf)](_0x6de38f(0x382))['value']()||[];_0x427b55['forEach'](_0x4086c4=>{const _0x1df304=_0x6de38f;if(_0x4086c4[_0x1df304(0x3a5)]=='enabled'){const _0x170563=configpath+'bot-'+_0x4086c4[_0x1df304(0x382)]+_0x1df304(0x2ec),_0x3091d2=fs[_0x1df304(0x1fd)](_0x170563);let _0x52f30e;if(_0x3091d2){const _0x1a0e2c=fs[_0x1df304(0x29f)](_0x170563);try{const _0x3721b6=JSON[_0x1df304(0x279)](_0x1a0e2c);_0x52f30e=_0x3721b6?_0x3721b6[_0x1df304(0x220)][0x0][_0x1df304(0x2f7)]:null;}catch(_0x2e7d3d){}}if(_0x52f30e)_0x484347[_0x1df304(0x249)](_0x52f30e);}});const _0x5e16f2=[...new Set(_0x484347)]['sort']();return _0x5e16f2;}async function initUser(){const _0xb3ac6f=_0x2a54ee;if(!settings[_0xb3ac6f(0x287)]){const _0x1b6ce6=uuidRandom();mixpanel['alias'](_0x1b6ce6),updateSetting(_0xb3ac6f(0x287),_0x1b6ce6);}}async function initSecure(){const _0x522fa7=_0x2a54ee;let _0x5727c7=getSecure();if(!_0x5727c7[_0x522fa7(0x2d9)](_0x522fa7(0x388))){let _0x1bb71c=await generateKeys();_0x5727c7[_0x522fa7(0x24f)]=_0x1bb71c['publicKey'],_0x5727c7['privateKey']=_0x1bb71c[_0x522fa7(0x33b)],_0x5727c7[_0x522fa7(0x388)]=crypto['randomBytes'](0x20)['toString'](_0x522fa7(0x3b1));;storeSecure(_0x5727c7);}}function getSettings(){const _0x1850a8=_0x2a54ee;return dbSettings[_0x1850a8(0x30c)](_0x1850a8(0x2ea))[_0x1850a8(0x268)]()||{};}function getSecure(){const _0x340fab=_0x2a54ee;return dbSecure[_0x340fab(0x30c)](_0x340fab(0x236))[_0x340fab(0x268)]()||{};}function getBlacklist(){const _0x5248bb=_0x2a54ee;return dbSecure[_0x5248bb(0x30c)](_0x5248bb(0x292))['value']()||[];}function broadcastToBots(_0x4115f6,_0x464055){const _0x4c43be=_0x2a54ee;config[_0x4c43be(0x349)](_0x1b5877=>{const _0x91eba6=_0x4c43be;if(_0x1b5877[_0x91eba6(0x3a5)]==_0x91eba6(0x1b8)&&_0x1b5877[_0x91eba6(0x230)]=='running'||_0x1b5877[_0x91eba6(0x3a5)]=='new'&&_0x1b5877[_0x91eba6(0x230)]==_0x91eba6(0x3a9)){if(pid[_0x1b5877[_0x91eba6(0x382)]])pid[_0x1b5877['botID']][_0x91eba6(0x386)]({[_0x4115f6]:_0x464055});}});}async function storeSettings(_0x540b38,_0xddd451=![]){const _0x247205=_0x2a54ee;_0x540b38={...settings,..._0x540b38};if(_0xddd451&&_0x540b38[_0x247205(0x204)]!=_0x247205(0x3af)&&_0x540b38[_0x247205(0x204)]!=_0x247205(0x2de)&&_0x540b38[_0x247205(0x204)]!=''){const _0x311d6f=crypt['decrypt'](secure['privateKey'],_0x540b38['bbPassword'])[_0x247205(0x1dd)]['split'](_0x247205(0x234))[0x0],_0x1996b7=bcrypt[_0x247205(0x340)](_0x311d6f,saltRounds);_0x540b38={..._0x540b38,'bbPassword':_0x1996b7};}if(_0xddd451&&_0x540b38['telegramToken']!=_0x247205(0x3af)&&_0x540b38['telegramToken']!=_0x247205(0x2de)&&_0x540b38[_0x247205(0x363)]!=''){const _0x18169e=crypt[_0x247205(0x211)](secure['privateKey'],_0x540b38[_0x247205(0x363)])[_0x247205(0x1dd)][_0x247205(0x26a)](_0x247205(0x234))[0x0];_0x540b38={..._0x540b38,'telegramToken':_0x18169e};}if(_0xddd451&&_0x540b38['marketcapApi']!=_0x247205(0x3af)&&_0x540b38[_0x247205(0x2cb)]!='***'&&_0x540b38['marketcapApi']!=''){const _0x35c9e2=crypt[_0x247205(0x211)](secure[_0x247205(0x33b)],_0x540b38[_0x247205(0x2cb)])[_0x247205(0x1dd)][_0x247205(0x26a)]('|@|')[0x0];_0x540b38={..._0x540b38,'marketcapApi':_0x35c9e2};}const _0x124377=_0x540b38['telegramToken']!='************'&&_0x540b38[_0x247205(0x363)]!=settings[_0x247205(0x363)]||_0x540b38[_0x247205(0x317)]!=settings[_0x247205(0x317)],_0x9bd16a=_0x540b38[_0x247205(0x363)]==''||_0x540b38['telegramUsername']=='',_0xa6bf00=_0x540b38[_0x247205(0x2cb)]&&_0x540b38[_0x247205(0x2cb)]!=_0x247205(0x3af)&&_0x540b38[_0x247205(0x2cb)]!=settings['telegramToken'];_0x124377&&(_0x540b38[_0x247205(0x29a)]=null,_0x540b38['telegramEvents']=_0x247205(0x392));for(const [_0x5b9bcb,_0x2e91ae]of Object[_0x247205(0x33c)](_0x540b38)){if(_0x5b9bcb==_0x247205(0x363)&&_0x2e91ae=='************'){_0x540b38[_0x247205(0x363)]=settings[_0x247205(0x363)];continue;};if(_0x5b9bcb==_0x247205(0x204)&&_0x2e91ae=='************'){_0x540b38[_0x247205(0x204)]=settings[_0x247205(0x204)];continue;};if(_0x5b9bcb==_0x247205(0x2cb)&&_0x2e91ae==_0x247205(0x3af)){_0x540b38[_0x247205(0x2cb)]=settings['marketcapApi'];continue;};dbSettings[_0x247205(0x38d)](_0x247205(0x1c2)+_0x5b9bcb,_0x2e91ae)['write']();}settings=_0x540b38,io['to'](_0x247205(0x355))[_0x247205(0x2d7)](_0x247205(0x2ea),cleanSettings()),broadcastToBots(_0x247205(0x22d),settings[_0x247205(0x22d)]),broadcastToBots('onepagemode',settings[_0x247205(0x2a9)]),broadcastToBots(_0x247205(0x2cb),settings[_0x247205(0x2cb)]);if(_0x124377&&!_0x9bd16a)initTelegram();if(_0x124377&&_0x9bd16a)disableTelegram();getAllClients()['forEach'](_0x16f97a=>{getSocket(_0x16f97a['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});}),_0xa6bf00&&(await sleep(0xbb8),testMarketcapApi(_0x540b38['marketcapApi']));}async function testMarketcapApi(_0x176f3c){const _0x5081b0=_0x2a54ee,_0x33df85=[_0x5081b0(0x246),_0x5081b0(0x30b)];try{await axios[_0x5081b0(0x30c)](_0x5081b0(0x21a),{'headers':{'X-CMC_PRO_API_KEY':_0x176f3c},'params':{'symbol':_0x33df85[_0x5081b0(0x1cf)]()}});}catch(_0x135b7d){_0x135b7d[_0x5081b0(0x1cf)]()[_0x5081b0(0x1e0)](_0x5081b0(0x332))?(io['to']('botmanager')[_0x5081b0(0x2d7)](_0x5081b0(0x1fc),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x5081b0(0x212)](_0x5081b0(0x1b1))):(io['to'](_0x5081b0(0x355))['emit']('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x5081b0(0x212)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x5081b0(0x1b9)]('Error\x20details:',_0x135b7d['toString']()+'\x20-\x20'+_0x135b7d[_0x5081b0(0x32b)]));return;}logger[_0x5081b0(0x1b9)](_0x5081b0(0x1f3));}function updateSetting(_0x222a23,_0x2485ef){const _0x4ccaad=_0x2a54ee;dbSettings[_0x4ccaad(0x38d)](_0x4ccaad(0x1c2)+_0x222a23,_0x2485ef)[_0x4ccaad(0x28f)](),settings=getSettings(),io['to'](_0x4ccaad(0x355))[_0x4ccaad(0x2d7)](_0x4ccaad(0x2ea),cleanSettings());}function storeSecure(_0x397be8){const _0x41886c=_0x2a54ee;dbSecure['get']('secure')[_0x41886c(0x249)](_0x397be8)[_0x41886c(0x28f)](),secure=_0x397be8;}function addBlacklist(_0x320eb0){const _0x31a43f=_0x2a54ee;cleanBlacklist();let _0x2f62d9;devices[_0x320eb0]['telegramIpApproval']?_0x2f62d9=Math['max'](devices[_0x320eb0][_0x31a43f(0x36f)]['expiry'],loginExpiry):_0x2f62d9=loginExpiry,dbSecure[_0x31a43f(0x30c)](_0x31a43f(0x292))[_0x31a43f(0x249)]({'expiry':new Date()['getTime']()+_0x2f62d9*0x3c*0x3e8,'token':devices[_0x320eb0][_0x31a43f(0x39d)][_0x31a43f(0x38b)]})[_0x31a43f(0x28f)](),blacklist=dbSecure[_0x31a43f(0x30c)](_0x31a43f(0x292))['value']();}function cleanBlacklist(){const _0x4b5bde=_0x2a54ee;let _0x1c2494=dbSecure['get'](_0x4b5bde(0x292))['cloneDeep']()['value'](),_0x41fa0d=new Date()['getTime']();_0x1c2494[_0x4b5bde(0x349)](_0x3bd3d4=>{const _0x3c8a90=_0x4b5bde;_0x3bd3d4[_0x3c8a90(0x299)]<_0x41fa0d&&dbSecure[_0x3c8a90(0x30c)]('blacklist')[_0x3c8a90(0x34e)]({'expiry':_0x3bd3d4[_0x3c8a90(0x299)]})[_0x3c8a90(0x28f)]();});}function initStates(){const _0x8ffc=_0x2a54ee;let _0x4afa8b=getConfiguration();_0x4afa8b[_0x8ffc(0x349)](_0x3d4372=>{const _0x284348=_0x8ffc;_0x3d4372[_0x284348(0x230)]='stopped';}),storeConfiguration(_0x4afa8b);}function onKeys(){const _0xde3fc=new RSA();return new Promise(_0x452445=>{const _0x25b17a=_0x16b4;_0xde3fc['generateKeyPairAsync']()[_0x25b17a(0x245)](_0x2af68b=>{_0x452445(_0x2af68b);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3ff030=_0x2a54ee;let _0x27be18=getSettings(),_0x5ec66a=![];!_0x27be18['hasOwnProperty'](_0x3ff030(0x38e))&&(_0x27be18[_0x3ff030(0x38e)]=0x0,_0x5ec66a=!![]);!_0x27be18['hasOwnProperty'](_0x3ff030(0x2da))&&(_0x27be18[_0x3ff030(0x2da)]=0x0,_0x5ec66a=!![]);!_0x27be18[_0x3ff030(0x2d9)](_0x3ff030(0x282))&&(_0x27be18['latestversion']=_0x3ff030(0x280),_0x5ec66a=!![]);!_0x27be18[_0x3ff030(0x2d9)]('onepagemode')&&(_0x27be18[_0x3ff030(0x2a9)]=![],_0x5ec66a=!![]);!_0x27be18[_0x3ff030(0x2d9)](_0x3ff030(0x2cb))&&(_0x27be18[_0x3ff030(0x2cb)]='',_0x5ec66a=!![]);if(_0x5ec66a)storeSettings(_0x27be18);try{fs[_0x3ff030(0x22a)](configbackuppath,{'withFileTypes':!![]})[_0x3ff030(0x349)](_0x11c8f7=>{const _0xd434b5=_0x3ff030;if(!_0x11c8f7[_0xd434b5(0x26d)]()){if(!_0x11c8f7['name'][_0xd434b5(0x215)](_0xd434b5(0x385)))fs[_0xd434b5(0x27e)](configbackuppath+_0x11c8f7[_0xd434b5(0x33f)]);}else fs[_0xd434b5(0x333)](configbackuppath+_0x11c8f7[_0xd434b5(0x33f)],{'recursive':!![]});});}catch(_0x10cb00){logger[_0x3ff030(0x1b9)](_0x3ff030(0x305),_0x10cb00);}}function storeConfiguration(_0x225c58){const _0x7d1547=_0x2a54ee;dbConfig[_0x7d1547(0x30c)](_0x7d1547(0x3a3))[_0x7d1547(0x34e)]()[_0x7d1547(0x28f)](),dbConfig[_0x7d1547(0x30c)](_0x7d1547(0x3a3))[_0x7d1547(0x249)](..._0x225c58)['write'](),config=_0x225c58;}async function resetPassword(){const _0x5570dd=_0x2a54ee;if(tgBot&&settings['telegramChatId']){const _0x2db4b5=Markup[_0x5570dd(0x390)]([Markup[_0x5570dd(0x35b)][_0x5570dd(0x213)](_0x5570dd(0x2b5),_0x5570dd(0x1f2)),Markup[_0x5570dd(0x35b)][_0x5570dd(0x213)]('no',_0x5570dd(0x1ad))]);await sendTelegram(settings[_0x5570dd(0x29a)],_0x5570dd(0x23d),_0x2db4b5),tgBot['action'](/resetpw_(.+)/,async _0x479218=>{const _0x427908=_0x5570dd,_0x1fedfa=_0x479218[_0x427908(0x223)][0x1];_0x479218[_0x427908(0x2e1)]();if(_0x1fedfa!='no'){const _0x568aaf=0xf,_0x1ae96d='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x2d9089=Array[_0x427908(0x26c)](crypto[_0x427908(0x36e)](new Uint32Array(_0x568aaf)))['map'](_0x16125c=>_0x1ae96d[_0x16125c%_0x1ae96d[_0x427908(0x330)]])[_0x427908(0x39a)](''),_0x192517=bcrypt[_0x427908(0x340)](_0x2d9089,saltRounds);storeSettings({'bbPassword':_0x192517}),await sendTelegram(_0x479218[_0x427908(0x36c)]['id'],_0x427908(0x1be)+_0x2d9089,{'parse_mode':'HTML'});}else await sendTelegram(_0x479218[_0x427908(0x36c)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x58cd9,_0x4af837){const _0x32d570=_0x2a54ee;io['to']('botmanager')[_0x32d570(0x2d7)](_0x32d570(0x1fc),_0x32d570(0x348),_0x32d570(0x1d9));if(tgBot&&settings[_0x32d570(0x29a)]){const _0x2f99de=uuidRandom();tmpStorage[_0x2f99de]={'path':_0x58cd9,'filename':_0x4af837};const _0x55b603=Markup[_0x32d570(0x390)]([Markup['button']['callback']('yes','restore_yes_'+_0x2f99de),Markup[_0x32d570(0x35b)][_0x32d570(0x213)]('no',_0x32d570(0x20d)+_0x2f99de)]);await sendTelegram(settings[_0x32d570(0x29a)],_0x32d570(0x293),_0x55b603),tgBot[_0x32d570(0x238)](/restore_(.+)_(.+)/,async _0xd6b437=>{const _0x121ae2=_0x32d570,_0x3b106d=_0xd6b437['match'][0x1],_0x2331ee=_0xd6b437[_0x121ae2(0x223)][0x2],{path:_0x582ff1,filename:_0x5c9141}=tmpStorage[_0x2331ee];delete tmpStorage[_0x2331ee],_0xd6b437['editMessageReplyMarkup'](),_0x3b106d==_0x121ae2(0x2b5)?(logger[_0x121ae2(0x1b9)](_0x121ae2(0x262)),await sendTelegram(_0xd6b437[_0x121ae2(0x36c)]['id'],_0x121ae2(0x397),{'parse_mode':_0x121ae2(0x377)}),unzipFile(_0x582ff1,_0x5c9141)):(logger[_0x121ae2(0x1b9)]('Restore\x20process\x20aborted'),await sendTelegram(_0xd6b437[_0x121ae2(0x36c)]['id'],_0x121ae2(0x338)));});}}function getServerTime(){const _0x5eac4c=_0x2a54ee,_0x20c3ac=new Date();return _0x20c3ac['getFullYear']()+'/'+(_0x20c3ac[_0x5eac4c(0x2f6)]()+0x1)[_0x5eac4c(0x1cf)]()[_0x5eac4c(0x29c)](0x2,'0')+'/'+_0x20c3ac[_0x5eac4c(0x37b)]()[_0x5eac4c(0x1cf)]()[_0x5eac4c(0x29c)](0x2,'0')+'\x20'+_0x20c3ac[_0x5eac4c(0x269)]()[_0x5eac4c(0x1cf)]()[_0x5eac4c(0x29c)](0x2,'0')+':'+_0x20c3ac['getMinutes']()[_0x5eac4c(0x1cf)]()['padStart'](0x2,'0')+':'+_0x20c3ac[_0x5eac4c(0x39f)]()[_0x5eac4c(0x1cf)]()[_0x5eac4c(0x29c)](0x2,'0');}function getTimeStamp(){const _0x730e4c=_0x2a54ee,_0x52ae46=shiftedTime();return _0x52ae46['getFullYear']()+'/'+(_0x52ae46[_0x730e4c(0x2f6)]()+0x1)[_0x730e4c(0x1cf)]()[_0x730e4c(0x29c)](0x2,'0')+'/'+_0x52ae46[_0x730e4c(0x37b)]()[_0x730e4c(0x1cf)]()[_0x730e4c(0x29c)](0x2,'0')+'\x20'+_0x52ae46[_0x730e4c(0x269)]()[_0x730e4c(0x1cf)]()['padStart'](0x2,'0')+':'+_0x52ae46['getMinutes']()['toString']()[_0x730e4c(0x29c)](0x2,'0')+':'+_0x52ae46['getSeconds']()[_0x730e4c(0x1cf)]()[_0x730e4c(0x29c)](0x2,'0');}function getCleanTimeStamp(){const _0x538278=_0x2a54ee,_0x5777ae=shiftedTime();return _0x5777ae[_0x538278(0x2d3)]()+(_0x5777ae['getMonth']()+0x1)[_0x538278(0x1cf)]()[_0x538278(0x29c)](0x2,'0')+_0x5777ae[_0x538278(0x37b)]()[_0x538278(0x1cf)]()[_0x538278(0x29c)](0x2,'0')+'-'+_0x5777ae[_0x538278(0x269)]()[_0x538278(0x1cf)]()['padStart'](0x2,'0')+_0x5777ae['getMinutes']()[_0x538278(0x1cf)]()[_0x538278(0x29c)](0x2,'0')+_0x5777ae[_0x538278(0x39f)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x38ca8e=_0x2a54ee,_0x233c0a=new Date();let _0x1ee9d9=_0x233c0a;if(settings[_0x38ca8e(0x22d)]&&settings[_0x38ca8e(0x22d)]!==0x0)_0x1ee9d9=fns[_0x38ca8e(0x1ed)](_0x233c0a,{'hours':settings[_0x38ca8e(0x22d)]});return _0x1ee9d9;}async function startScheduler(){const _0x174cf5=_0x2a54ee,_0x13d10a=new Date()[_0x174cf5(0x38c)](),_0x882fbe=shiftedTime()[_0x174cf5(0x269)]();_0x882fbe==0x4&&backupConfigFiles(),_0x882fbe==0x0&&rotateLogFiles(),_0x13d10a%0x6==0x0&&triggerAnalytics(),_0x13d10a%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5df0f1){const _0x30af0f=_0x2a54ee;logger['debug'](_0x30af0f(0x1d6)+_0x5df0f1);const _0x104e1e=getBotsWithMode();_0x104e1e[_0x30af0f(0x330)]>0x0?confirmRestore(configbackuppath,_0x5df0f1):unzipFile(configbackuppath,_0x5df0f1);}async function getBackupFiles(_0x571ca9=null){const _0x1fb1fb=_0x2a54ee;let _0x1f8e97=[],_0xa0ddbd=fs[_0x1fb1fb(0x22a)](configbackuppath,{'withFileTypes':!![]});_0xa0ddbd['sort']((_0x1fccbd,_0x4fc7bb)=>_0x1fccbd['name']<_0x4fc7bb[_0x1fb1fb(0x33f)]?0x1:_0x4fc7bb[_0x1fb1fb(0x33f)]<_0x1fccbd['name']?-0x1:0x0),_0xa0ddbd[_0x1fb1fb(0x349)](_0x2f6983=>{const _0x33ba05=_0x1fb1fb;if(!_0x2f6983[_0x33ba05(0x26d)]()&&_0x2f6983[_0x33ba05(0x33f)][_0x33ba05(0x215)](_0x33ba05(0x385))&&_0x2f6983[_0x33ba05(0x33f)][_0x33ba05(0x308)](_0x33ba05(0x1ce))){const _0x2b49e3=formatDate(fs['statSync'](configbackuppath+_0x2f6983[_0x33ba05(0x33f)])['mtime']);_0x1f8e97['push']({'name':_0x2f6983['name'],'mtime':_0x2b49e3});}});if(_0x571ca9)io['to'](_0x571ca9)[_0x1fb1fb(0x2d7)](_0x1fb1fb(0x255),_0x1f8e97);else return _0x1f8e97;}async function backupConfigFiles(){const _0x26589c=_0x2a54ee;await zipFiles(_0x26589c(0x2f3));const _0x4b8882=getCleanTimeStamp();fs[_0x26589c(0x241)](zippath+_0x26589c(0x28c),configbackuppath+('backup-full@'+_0x4b8882+_0x26589c(0x1ce)));let _0x4eeac0=fs[_0x26589c(0x22a)](configbackuppath,{'withFileTypes':!![]});_0x4eeac0[_0x26589c(0x25c)]((_0x231e6,_0x3df1ac)=>_0x231e6[_0x26589c(0x33f)]<_0x3df1ac[_0x26589c(0x33f)]?0x1:_0x3df1ac[_0x26589c(0x33f)]<_0x231e6[_0x26589c(0x33f)]?-0x1:0x0),_0x4eeac0[_0x26589c(0x330)]>maxBackups&&fs[_0x26589c(0x27e)](configbackuppath+_0x4eeac0[_0x4eeac0[_0x26589c(0x330)]-0x1][_0x26589c(0x33f)]);}function rotateLogFiles(){const _0x516ee9=_0x2a54ee,_0x9bea12=fs[_0x516ee9(0x31b)](logspath+'output-000.log'),_0x3ae47c=_0x9bea12[_0x516ee9(0x254)]/0x400;if(_0x3ae47c>0x64){let _0x11fd7e=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x11fd7e['sort']((_0x4039f7,_0x3f825f)=>_0x4039f7[_0x516ee9(0x33f)]<_0x3f825f[_0x516ee9(0x33f)]?0x1:_0x3f825f[_0x516ee9(0x33f)]<_0x4039f7[_0x516ee9(0x33f)]?-0x1:0x0),_0x11fd7e[_0x516ee9(0x349)](_0x54c53e=>{const _0xca57e1=_0x516ee9;if(_0x54c53e[_0xca57e1(0x33f)]=='output-002.log')fs['copyFileSync'](logspath+_0x54c53e[_0xca57e1(0x33f)],logspath+_0xca57e1(0x283));if(_0x54c53e[_0xca57e1(0x33f)]==_0xca57e1(0x372))fs[_0xca57e1(0x241)](logspath+_0x54c53e[_0xca57e1(0x33f)],logspath+_0xca57e1(0x1f4));_0x54c53e[_0xca57e1(0x33f)]==_0xca57e1(0x202)&&(fs['copyFileSync'](logspath+_0x54c53e['name'],logspath+_0xca57e1(0x372)),fs[_0xca57e1(0x302)](logspath+_0x54c53e[_0xca57e1(0x33f)],''));});}}async function zipFiles(_0x1fc738){const _0x5d6ef4=_0x2a54ee;let _0x2c505e;if(_0x1fc738=='logs')_0x2c505e=logspath;if(_0x1fc738=='backup')_0x2c505e=configpath;if(_0x1fc738=='backup-full')_0x2c505e=configpath;let _0x4048b3=fs[_0x5d6ef4(0x22a)](_0x2c505e,{'withFileTypes':!![]});const _0x1fb36c=new require(_0x5d6ef4(0x251))();_0x4048b3[_0x5d6ef4(0x349)](_0x153ba4=>{const _0x568aa6=_0x5d6ef4;if(!_0x153ba4['isDirectory']()){let _0x499f06=fs[_0x568aa6(0x29f)](_0x2c505e+_0x153ba4[_0x568aa6(0x33f)]);if(_0x1fc738==_0x568aa6(0x2d5)){const _0x2b0bc2=/^bot-[0-9]{3}-config.json$/,_0x56a054=_0x2b0bc2[_0x568aa6(0x2ca)](_0x153ba4[_0x568aa6(0x33f)]);if(_0x56a054){const _0x302a94=JSON[_0x568aa6(0x279)](_0x499f06);if(_0x302a94[_0x568aa6(0x220)][0x0]){_0x302a94['bot'][0x0][_0x568aa6(0x2e9)]=_0x568aa6(0x2de),_0x302a94[_0x568aa6(0x220)][0x0]['apiSecret']='***';if(_0x302a94['bot'][0x0][_0x568aa6(0x272)])_0x302a94[_0x568aa6(0x220)][0x0]['apiPassword']=_0x568aa6(0x2de);}_0x499f06=JSON[_0x568aa6(0x3b2)](_0x302a94,null,0x2);}if(_0x153ba4['name']==_0x568aa6(0x2d4)){const _0x71904f=JSON[_0x568aa6(0x279)](_0x499f06);if(_0x71904f[_0x568aa6(0x2ea)][_0x568aa6(0x335)])_0x71904f['settings'][_0x568aa6(0x335)]=![];if(_0x71904f[_0x568aa6(0x2ea)][_0x568aa6(0x204)])_0x71904f[_0x568aa6(0x2ea)][_0x568aa6(0x204)]=_0x568aa6(0x2de);if(_0x71904f[_0x568aa6(0x2ea)][_0x568aa6(0x363)])_0x71904f[_0x568aa6(0x2ea)]['telegramToken']='***';if(_0x71904f[_0x568aa6(0x2ea)][_0x568aa6(0x29a)])_0x71904f[_0x568aa6(0x2ea)][_0x568aa6(0x29a)]=null;if(_0x71904f['settings']['marketcapApi'])_0x71904f['settings']['marketcapApi']=_0x568aa6(0x2de);_0x499f06=JSON[_0x568aa6(0x3b2)](_0x71904f,null,0x2);}if(_0x153ba4[_0x568aa6(0x33f)]!='bb-secure.json')_0x1fb36c[_0x568aa6(0x1d1)](_0x153ba4[_0x568aa6(0x33f)],_0x499f06);}else _0x1fb36c['file'](_0x153ba4[_0x568aa6(0x33f)],_0x499f06);}});const _0x563aed=_0x1fb36c[_0x5d6ef4(0x2e4)]({'base64':![],'compression':_0x5d6ef4(0x2e0)});fs['writeFileSync'](zippath+(_0x1fc738+_0x5d6ef4(0x1ce)),_0x563aed,_0x5d6ef4(0x374));}async function unzipFile(_0x4b8e10,_0x7f8101){const _0x40ee36=_0x2a54ee;fs[_0x40ee36(0x22a)](configpath,{'withFileTypes':!![]})[_0x40ee36(0x349)](_0x1aa9d7=>{const _0x4990ed=_0x40ee36;if(!_0x1aa9d7[_0x4990ed(0x26d)]())fs['rmSync'](configpath+_0x1aa9d7['name']);});const _0x567380=fs[_0x40ee36(0x29f)](_0x4b8e10+_0x7f8101,_0x40ee36(0x374)),_0x3708c3=new require(_0x40ee36(0x251))(_0x567380,{'base64':![],'checkCRC32':!![]});Object[_0x40ee36(0x1bb)](_0x3708c3[_0x40ee36(0x22e)])[_0x40ee36(0x349)](_0x5645d4=>{const _0x52426e=_0x40ee36,_0x353d6c=_0x3708c3[_0x52426e(0x22e)][_0x5645d4];fs[_0x52426e(0x302)](configpath+_0x353d6c['name'],_0x353d6c[_0x52426e(0x207)]);}),fs[_0x40ee36(0x22a)](temppath,{'withFileTypes':!![]})['forEach'](_0x3b5e59=>{const _0x3d6151=_0x40ee36;if(!_0x3b5e59[_0x3d6151(0x26d)]())fs[_0x3d6151(0x333)](temppath+_0x3b5e59['name']);}),logger[_0x40ee36(0x1b9)](_0x40ee36(0x1a7)),process[_0x40ee36(0x386)]({'restore':!![]},_0x2b9fc7=>{});}async function getPublicIp(){const _0x49b195=_0x2a54ee;try{const _0x3e1813=await axios[_0x49b195(0x30c)](_0x49b195(0x1f0));publicip=_0x3e1813[_0x49b195(0x2b6)]['ip'];}catch(_0x54df61){}}async function triggerAnalytics(){const _0x4579c7=_0x2a54ee;if(!publicip)await getPublicIp();const _0xb9eed8=getBotsWithMode();let _0xcb3be1=0x0;_0xb9eed8[_0x4579c7(0x349)](_0x4ac520=>{const _0x3cb56d=_0x4579c7;if(_0x4ac520[_0x3cb56d(0x3a5)]===_0x3cb56d(0x1b8))_0xcb3be1++;});const _0x2a7a02=getBotExchanges();mixpanel[_0x4579c7(0x376)](_0x4579c7(0x229),{'distinct_id':settings[_0x4579c7(0x287)],'ip':publicip,'version':serverversion,'numbots':_0xb9eed8[_0x4579c7(0x330)],'numbotsenabled':_0xcb3be1,'exchanges':_0x2a7a02,'environment':environment});}async function getMessages(){const _0x5920a0=_0x2a54ee,_0x204bfe=_0x5920a0(0x208),_0x2ae088=new GraphQLClient(_0x204bfe),_0x447adc={'authorization':_0x5920a0(0x2dc)},_0x38ee0f=serverversion[_0x5920a0(0x26a)]('.'),_0x5477c4=_0x38ee0f[0x0]+'.'+_0x38ee0f[0x1],_0x51ae61=Math[_0x5920a0(0x31a)](settings[_0x5920a0(0x38e)],settings[_0x5920a0(0x2da)]),_0x1aea2e={'last':parseInt(_0x51ae61),'bbm':_0x5477c4},_0x4f5250=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2ddc88;try{_0x2ddc88=await _0x2ae088['request'](_0x4f5250,_0x1aea2e,_0x447adc);}catch(_0x4cc43f){}if(_0x2ddc88&&_0x2ddc88[_0x5920a0(0x1ab)]){let _0x2ed789=settings['lastmsgtelegram'];newMessages=[];for(const _0x5d9be5 of _0x2ddc88['messages']){newMessages['push'](_0x5d9be5);let _0x263307=![];_0x5d9be5[_0x5920a0(0x34a)]&&(updateSetting('latestversion',_0x5d9be5['bbvNew']),_0x263307=isNewerVersion(serverversion,_0x5d9be5[_0x5920a0(0x34a)])||serverversion==_0x5d9be5[_0x5920a0(0x34a)]);if(!_0x263307&&_0x5d9be5['number']>_0x2ed789){if(_0x5d9be5[_0x5920a0(0x226)]===_0x5920a0(0x21b)||serverversion['startsWith'](_0x5d9be5[_0x5920a0(0x226)])){let _0x4c819c=''+_0x5d9be5[_0x5920a0(0x20f)]+'\x0a\x0a'+_0x5d9be5[_0x5920a0(0x1dd)];const _0x2f0d90=await sendTelegramMsg(toTelegramMarkdown(_0x4c819c),_0x5920a0(0x383));if(_0x2f0d90)_0x2ed789=_0x5d9be5[_0x5920a0(0x1b6)];}}}updateAvailable=isNewerVersion(settings[_0x5920a0(0x282)],serverversion),updateSetting('lastmsgtelegram',_0x2ed789),emitMessages();}}function emitMessages(){const _0x7ec14a=_0x2a54ee,_0x193d6d=settings[_0x7ec14a(0x2da)];let _0x56fd5f=[];newMessages[_0x7ec14a(0x349)](_0x1ffdb8=>{const _0x1dcc2b=_0x7ec14a;_0x1ffdb8['number']>_0x193d6d&&_0x56fd5f[_0x1dcc2b(0x249)](_0x1ffdb8);}),_0x56fd5f[_0x7ec14a(0x330)]>0x0&&getAllClients()[_0x7ec14a(0x349)](_0x3e40ba=>{getSocket(_0x3e40ba['id'])['emit']('message',_0x56fd5f);});}function confirmMessage(_0x11c61a){const _0x226b6d=_0x2a54ee;updateSetting(_0x226b6d(0x2da),Number(_0x11c61a));}function isNewerVersion(_0x40c1a4,_0x59ecb0){const _0x1abf9b=_0x2a54ee,_0x91976=_0x59ecb0[_0x1abf9b(0x26a)]('.'),_0xfa47e6=_0x40c1a4[_0x1abf9b(0x26a)]('.');for(var _0x5a4eea=0x0;_0x5a4eea<_0xfa47e6[_0x1abf9b(0x330)];_0x5a4eea++){const _0x70cc33=~~_0xfa47e6[_0x5a4eea],_0x26898e=~~_0x91976[_0x5a4eea];if(_0x70cc33>_0x26898e)return!![];if(_0x70cc33<_0x26898e)return![];}return![];}function toTelegramMarkdown(_0x300ad7){const _0x34a901=_0x2a54ee,_0xe78f72=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xfbb318=/\*{2}(.+?)\*{2}/gim;return _0x300ad7=_0x300ad7[_0x34a901(0x353)](_0xe78f72,_0x34a901(0x37a))[_0x34a901(0x353)](_0xfbb318,'*$1*'),_0x300ad7;}async function validateConfigFile(){const _0x30cce8=_0x2a54ee,_0xf07ded=dbConfig[_0x30cce8(0x30c)](_0x30cce8(0x3a3))['sortBy']('botID')[_0x30cce8(0x268)]()||[];if(_0xf07ded[_0x30cce8(0x330)]==0x0){let _0x432acf=0x0,_0x119924=[];const _0xfcebfd=/^bot-([0-9]{3})-config.json$/,_0x5ddfd2=fs['readdirSync'](configpath);_0x5ddfd2['forEach'](_0x590268=>{const _0xb5ad1b=_0x30cce8,_0x250f52=_0xfcebfd[_0xb5ad1b(0x1c1)](_0x590268);if(_0x250f52){const _0x56f81d=_0x250f52[0x1];let _0x476db1=getBotAttributes(_0x56f81d);_0x119924[_0xb5ad1b(0x249)]({'botID':_0x56f81d,'botname':_0x476db1[_0xb5ad1b(0x25b)],'status':_0xb5ad1b(0x26f),'live':_0xb5ad1b(0x2b0)}),_0x432acf++;}}),_0x432acf!=0x0&&(dbConfig[_0x30cce8(0x30c)]('bots')['assign'](_0x119924)[_0x30cce8(0x28f)](),config=_0x119924,restoredConfigFile=_0x432acf);}}async function restoreConfigNotify(_0x32f334){const _0x11ed84=_0x2a54ee;let _0x51d620;if(restoredConfigFile==0x1)_0x51d620=_0x11ed84(0x3b4);else _0x51d620=_0x11ed84(0x21c);if(_0x32f334)io['to'](_0x11ed84(0x355))[_0x11ed84(0x2d7)](_0x11ed84(0x1fc),_0x51d620);else{logger['simple'](_0x11ed84(0x1c8)),logger[_0x11ed84(0x2a1)](_0x51d620),logger[_0x11ed84(0x2a1)](_0x11ed84(0x1c8)),logger[_0x11ed84(0x2a1)]('');if(tgBot&&settings[_0x11ed84(0x29a)]&&settings[_0x11ed84(0x3a1)]!=_0x11ed84(0x1c7))await sendTelegram(settings[_0x11ed84(0x29a)],_0x11ed84(0x360)+_0x51d620);}}function validateCredentials(_0x8bfd4e,_0x24ce4b){const _0x34633b=_0x2a54ee;if(_0x8bfd4e[_0x34633b(0x248)]==settings[_0x34633b(0x34c)]&&bcrypt[_0x34633b(0x297)](_0x8bfd4e['password'],settings[_0x34633b(0x204)])){if(settings[_0x34633b(0x301)])return{'allow':![],'reason':_0x34633b(0x203),'token':null};else{const _0x4df588=generateLoginToken(_0x24ce4b);return{'allow':!![],'reason':_0x34633b(0x1de),'token':_0x4df588};}}else return{'allow':![],'reason':_0x34633b(0x32d),'token':null};}function refreshToken(_0x26fdd4){const _0x4dd331=generateLoginToken(_0x26fdd4);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4dd331};}function validateAccess(_0x5a6e98,_0x206329,_0x1012d2){const _0xf12df2=_0x2a54ee,_0x5b883f=_0x1012d2?_0x1012d2:devices[_0x206329]['ip'];let _0xfbba71;const _0x41053c=_0x2e613f=>{const _0x93bfe9=_0x16b4;if(settings[_0x93bfe9(0x335)]){if(settings[_0x93bfe9(0x301)]){if(telegram2FaApproved(_0x206329)){const _0x13e9f8=generateLoginToken(_0x206329);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x13e9f8};}else return{'allow':![],'reason':_0x93bfe9(0x1a5),'token':null};}else return _0xfbba71=validToken(_0x2e613f,_0x206329),_0xfbba71[_0x93bfe9(0x2d9)]('success')?{'allow':!![],'reason':_0x93bfe9(0x2cc),'token':_0x2e613f}:{'allow':![],'reason':_0x93bfe9(0x1a5),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0xf12df2(0x294)]){let _0x1eca85=[...settings[_0xf12df2(0x1e9)],_0xf12df2(0x309),_0xf12df2(0x1b0),_0xf12df2(0x3b7)];if(_0x1eca85[_0xf12df2(0x1e0)](_0x5b883f))return _0x41053c(_0x5a6e98);else{_0xfbba71=validToken(_0x5a6e98,_0x206329);if(_0xfbba71[_0xf12df2(0x2d9)](_0xf12df2(0x1d9)))return _0x41053c(_0x5a6e98);else{if(telegramIpApproved(_0x206329)){const _0x346fc1=generateToken(_0x206329);return _0xfbba71=_0x41053c(_0x5a6e98),_0xfbba71[_0xf12df2(0x336)]?{'allow':!![],'reason':_0xf12df2(0x1b5),'token':_0x346fc1}:_0xfbba71;}else return settings[_0xf12df2(0x2b7)]?{'allow':![],'reason':_0xf12df2(0x368),'token':null}:{'allow':![],'reason':_0xf12df2(0x359),'token':null};}}}else return _0x41053c(_0x5a6e98);}function timelyDecrypt(_0x235ca9,_0x20f271,_0x3b03c1='@'){const _0x4f2547=_0x2a54ee;if(_0x235ca9)try{const _0x5351c1=crypt['decrypt'](secure[_0x4f2547(0x33b)],_0x235ca9)[_0x4f2547(0x1dd)],_0x5a7e7c=_0x5351c1[_0x4f2547(0x26a)](_0x3b03c1)[0x0],_0x55c936=_0x5351c1[_0x4f2547(0x26a)](_0x3b03c1)[0x1],_0x1315da=new Date()[_0x4f2547(0x34b)]();if(_0x20f271){if(_0x1315da-_0x55c936<maxSecretAge*0x3e8)return _0x5a7e7c;else return![];}else return _0x5a7e7c;}catch(_0x2b4b40){return![];}else return![];}const validToken=(_0x409a0f,_0x8ac40)=>{const _0x193029=_0x2a54ee,_0x581728=devices[_0x8ac40]['ip'];if(!_0x409a0f)return{'error':_0x193029(0x373)};for(let _0xd6b9c5 of blacklist){if(_0xd6b9c5[_0x193029(0x38b)]==_0x409a0f)return{'error':'Token\x20blacklisted'};}let _0x2158d5;try{_0x2158d5=jwt[_0x193029(0x291)](_0x409a0f,secure['secret']+_0x8ac40);}catch{return{'error':_0x193029(0x1a4)};}if(!_0x2158d5['hasOwnProperty']('clientip')&&!_0x2158d5['hasOwnProperty']('username')||!_0x2158d5[_0x193029(0x2d9)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x2158d5[_0x193029(0x2d9)](_0x193029(0x248))&&_0x2158d5['hasOwnProperty'](_0x193029(0x219))){const {clientip:_0x376c9c}=_0x2158d5;return _0x581728==_0x376c9c?{'success':_0x193029(0x3ba)}:{'error':_0x193029(0x2a6)};}else{if(_0x2158d5[_0x193029(0x2d9)]('username')&&_0x2158d5[_0x193029(0x2d9)]('clientip')){const {username:_0x4e471c,clientip:_0x40fb57}=_0x2158d5;return settings['bbUsername']==_0x4e471c&&_0x581728==_0x40fb57?{'success':_0x193029(0x3ba)}:{'error':_0x193029(0x323)};}}},generateLoginToken=_0x1791cc=>{const _0x59cc22=_0x2a54ee;if(_0x1791cc){const _0x1cd394=devices[_0x1791cc]['ip'];return jwt[_0x59cc22(0x326)]({'username':settings[_0x59cc22(0x34c)],'clientip':_0x1cd394},secure['secret']+_0x1791cc,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xdea92f=>{const _0x45400d=_0x2a54ee;if(_0xdea92f){const _0x473e11=devices[_0xdea92f]['ip'];return jwt[_0x45400d(0x326)]({'clientip':_0x473e11},secure[_0x45400d(0x388)]+_0xdea92f,{'expiresIn':devices[_0xdea92f][_0x45400d(0x36f)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x9d696e=>{const _0x663808=_0x2a54ee;let _0x5a248d=![];return devices[_0x9d696e]['telegramIpApproval']&&devices[_0x9d696e][_0x663808(0x36f)][_0x663808(0x299)]!='reject'&&(_0x5a248d=devices[_0x9d696e][_0x663808(0x36f)]['clientip']==devices[_0x9d696e]['ip']&&new Date()['getTime']()-devices[_0x9d696e][_0x663808(0x36f)][_0x663808(0x217)]<devices[_0x9d696e][_0x663808(0x36f)][_0x663808(0x299)]*0x3c*0x3e8),_0x5a248d;},telegram2FaApproved=_0x28d832=>{const _0x2d1bba=_0x2a54ee;let _0xd07b47=![];return devices[_0x28d832]['telegram2FaApproval']&&devices[_0x28d832]['telegram2FaApproval'][_0x2d1bba(0x299)]!=_0x2d1bba(0x2cf)&&(_0xd07b47=devices[_0x28d832][_0x2d1bba(0x361)][_0x2d1bba(0x219)]==devices[_0x28d832]['ip']&&new Date()[_0x2d1bba(0x34b)]()-devices[_0x28d832][_0x2d1bba(0x361)][_0x2d1bba(0x217)]<devices[_0x28d832]['telegram2FaApproval'][_0x2d1bba(0x299)]*0x3c*0x3e8),_0xd07b47;},normalizeIP=_0x22921b=>{const _0x3e7411=_0x2a54ee;let _0x40bf54=null,_0xc1b5af=null;if(ipaddr[_0x3e7411(0x331)](_0x22921b)){const _0x26fe59=ipaddr['parse'](_0x22921b);_0x26fe59[_0x3e7411(0x1e5)]()==='ipv6'?(_0x26fe59[_0x3e7411(0x23b)]()&&(_0x40bf54=_0x26fe59[_0x3e7411(0x2ff)]()[_0x3e7411(0x1cf)]()),_0xc1b5af=_0x26fe59[_0x3e7411(0x1cf)]()):(_0x40bf54=_0x26fe59[_0x3e7411(0x1cf)](),_0xc1b5af=_0x26fe59[_0x3e7411(0x1a9)]()[_0x3e7411(0x1cf)]());}return{'show':_0x40bf54?_0x40bf54:_0xc1b5af,'store':_0xc1b5af};};function formatDate(_0x51a683){const _0x6b1082=_0x2a54ee;return _0x51a683[_0x6b1082(0x2d3)]()+'/'+(_0x51a683[_0x6b1082(0x2f6)]()+0x1)[_0x6b1082(0x1cf)]()[_0x6b1082(0x29c)](0x2,'0')+'/'+_0x51a683[_0x6b1082(0x37b)]()[_0x6b1082(0x1cf)]()[_0x6b1082(0x29c)](0x2,'0')+'\x20'+_0x51a683[_0x6b1082(0x269)]()[_0x6b1082(0x1cf)]()[_0x6b1082(0x29c)](0x2,'0')+':'+_0x51a683[_0x6b1082(0x1cd)]()[_0x6b1082(0x1cf)]()[_0x6b1082(0x29c)](0x2,'0')+':'+_0x51a683[_0x6b1082(0x39f)]()['toString']()[_0x6b1082(0x29c)](0x2,'0');}function sleep(_0x733875){return new Promise(_0x2333f3=>setTimeout(_0x2333f3,_0x733875));}