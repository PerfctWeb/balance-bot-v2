const _0x4155af=_0x5dfa;(function(_0x164be3,_0x4c8ef7){const _0x1606c4=_0x5dfa,_0x3adad2=_0x164be3();while(!![]){try{const _0x4e8449=-parseInt(_0x1606c4(0x2d8))/0x1+parseInt(_0x1606c4(0x1e0))/0x2*(parseInt(_0x1606c4(0x277))/0x3)+-parseInt(_0x1606c4(0x20f))/0x4+-parseInt(_0x1606c4(0x2cd))/0x5+-parseInt(_0x1606c4(0x364))/0x6*(parseInt(_0x1606c4(0x31c))/0x7)+-parseInt(_0x1606c4(0x3de))/0x8*(-parseInt(_0x1606c4(0x1fb))/0x9)+parseInt(_0x1606c4(0x2b9))/0xa;if(_0x4e8449===_0x4c8ef7)break;else _0x3adad2['push'](_0x3adad2['shift']());}catch(_0x58ddbd){_0x3adad2['push'](_0x3adad2['shift']());}}}(_0x216a,0xa6515));const _0x16f36b=function(){let _0x320bde=!![];return function(_0x2bd7c1,_0x5152b5){const _0x585237=_0x320bde?function(){const _0x555da6=_0x5dfa;if(_0x5152b5){const _0xbb0b58=_0x5152b5[_0x555da6(0x234)](_0x2bd7c1,arguments);return _0x5152b5=null,_0xbb0b58;}}:function(){};return _0x320bde=![],_0x585237;};}(),_0x1fcc3e=_0x16f36b(this,function(){const _0x4c7cd1=_0x5dfa;return _0x1fcc3e[_0x4c7cd1(0x2d9)]()[_0x4c7cd1(0x233)](_0x4c7cd1(0x26b))[_0x4c7cd1(0x2d9)]()[_0x4c7cd1(0x355)](_0x1fcc3e)[_0x4c7cd1(0x233)](_0x4c7cd1(0x26b));});_0x1fcc3e();'use strict';process[_0x4155af(0x255)][_0x4155af(0x25c)]=0x1;const childProcess=require(_0x4155af(0x3e3)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require(_0x4155af(0x303)),path=require(_0x4155af(0x326)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x4155af(0x270)),ipaddr=require(_0x4155af(0x3b3)),argv=require('yargs/yargs')(process[_0x4155af(0x317)]['slice'](0x2))['argv'],uuidRandom=require(_0x4155af(0x297)),{Telegraf,Markup}=require(_0x4155af(0x3c9)),Mixpanel=require('mixpanel'),axios=require(_0x4155af(0x281)),{GraphQLClient,gql}=require(_0x4155af(0x30e)),util=require(_0x4155af(0x33f)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x4155af(0x1f2)]||_0x4155af(0x20e),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x4155af(0x1e6)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x4155af(0x287)](0x1));const HOST=argv[_0x4155af(0x3cd)]||null,userID=argv[_0x4155af(0x38b)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x4155af(0x3a7)];let bbpath=_0x4155af(0x259),bbpath2='';const botfile=_0x4155af(0x260),configfile=_0x4155af(0x225),settingsfile=_0x4155af(0x204),securefile=_0x4155af(0x28b),environment=require('./'+bbpath2+'version.json')[_0x4155af(0x1f3)]||_0x4155af(0x23c),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4155af(0x3d7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4155af(0x211)),configpath=userID?bbpath+_0x4155af(0x3a6)+userID+'/':bbpath+_0x4155af(0x3a6),configbackuppath=configpath+_0x4155af(0x25e),logspath=userID?bbpath+_0x4155af(0x3a2)+userID+'/':bbpath+_0x4155af(0x3a2),zippath=userID?bbpath+_0x4155af(0x22d)+userID+'/':bbpath+_0x4155af(0x22d),loggerfile=fs[_0x4155af(0x348)](logspath+_0x4155af(0x35b),{'flags':'a'}),temppath=userID?bbpath+_0x4155af(0x341)+userID+'/':bbpath+_0x4155af(0x341);!fs[_0x4155af(0x3d7)](configpath)&&fs[_0x4155af(0x307)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4155af(0x3d7)](logspath)&&fs[_0x4155af(0x307)](logspath);!fs[_0x4155af(0x3d7)](zippath)&&fs[_0x4155af(0x307)](zippath);!fs[_0x4155af(0x3d7)](temppath)&&fs[_0x4155af(0x307)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x4155af(0x1ff)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4155af(0x2f8)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4155af(0x39f),'onepagemode':![],'marketcapApi':''}})[_0x4155af(0x1ff)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4155af(0x2f8)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x4155af(0x2f2)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x4155af(0x3d0),{'host':_0x4155af(0x2ea)});function _0x5dfa(_0x448484,_0x46b839){const _0x2a90b4=_0x216a();return _0x5dfa=function(_0x1fcc3e,_0x16f36b){_0x1fcc3e=_0x1fcc3e-0x1d5;let _0x216a3c=_0x2a90b4[_0x1fcc3e];return _0x216a3c;},_0x5dfa(_0x448484,_0x46b839);}let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4155af(0x2e6)]&&(settings['telegramToken']!=''&&settings[_0x4155af(0x2e6)]!='***')&&settings[_0x4155af(0x366)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x52c80d,_0x4eb5d5)=>{const _0x19def7=_0x4155af,_0x36b598=/#[A-Z]{3}#/g;if(typeof _0x52c80d==_0x19def7(0x327)){!_0x4eb5d5?_0x52c80d=_0x52c80d[_0x19def7(0x27e)](_0x36b598,''):(_0x52c80d=_0x52c80d[_0x19def7(0x27e)](/#BLU#/g,_0x19def7(0x286)),_0x52c80d=_0x52c80d['replace'](/#RED#/g,_0x19def7(0x376)),_0x52c80d=_0x52c80d[_0x19def7(0x27e)](/#YEL#/g,'\x1b[33m'),_0x52c80d=_0x52c80d['replace'](/#MAG#/g,_0x19def7(0x34f)),_0x52c80d=_0x52c80d['replace'](/#CYA#/g,_0x19def7(0x2d4)),_0x52c80d=_0x52c80d[_0x19def7(0x27e)](/#RES#/g,_0x19def7(0x360)));;}return _0x52c80d;},logger={'screen':_0x473923=>{const _0x1ef036=_0x4155af;console[_0x1ef036(0x301)](parseColor(_0x473923,!![]));},'simple':_0x4ef422=>{const _0xc0bb27=_0x4155af;console[_0xc0bb27(0x301)](parseColor(_0x4ef422,!![])),loggerfile[_0xc0bb27(0x1ff)](util['format'](parseColor(_0x4ef422,![]))+'\x0a');},'full':async _0x3f42c7=>{const _0x37a5b7=_0x4155af,_0x165de6=getTimeStamp()+_0x37a5b7(0x2dd)+_0x3f42c7;console['log'](parseColor(_0x165de6,!![])),loggerfile[_0x37a5b7(0x1ff)](util[_0x37a5b7(0x28a)](parseColor(_0x165de6,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x37a5b7(0x378)]!='orders')await sendTelegram(settings[_0x37a5b7(0x285)],_0x37a5b7(0x2ff)+parseColor(_0x3f42c7,![]));},'debug':async(_0x582a90,_0x5a32de='')=>{const _0x2d66ce=_0x4155af,_0x5f2d7d=getTimeStamp()+_0x2d66ce(0x232)+_0x582a90;if(debugging)console[_0x2d66ce(0x301)](parseColor(_0x5f2d7d,!![]));loggerfile[_0x2d66ce(0x1ff)](util['format'](parseColor(_0x5f2d7d,![]))+'\x0a');if(_0x5a32de){if(debugging)console[_0x2d66ce(0x301)](_0x5a32de);loggerfile[_0x2d66ce(0x1ff)](util[_0x2d66ce(0x28a)](_0x5a32de)+'\x0a');}}};let terminating=![];process['on'](_0x4155af(0x32a),function(_0x4ea90b){const _0x14eca6=_0x4155af;_0x4ea90b[_0x14eca6(0x2d9)]()[_0x14eca6(0x271)](_0x14eca6(0x217))?(logger[_0x14eca6(0x3d3)](_0x14eca6(0x245)+_0x4ea90b[_0x14eca6(0x1f2)]+_0x14eca6(0x28c)),process['send']({'terminate':!![]},_0x407663=>{})):logger[_0x14eca6(0x3d3)](_0x4ea90b);}),process['on'](_0x4155af(0x287),()=>{const _0x2d09e0=_0x4155af;stopAllBots(),process[_0x2d09e0(0x287)](0x0);}),process['on']('SIGTERM',()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x3550f8=_0x4155af;stopAllBots(),process[_0x3550f8(0x287)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4155af(0x263))[_0x4155af(0x3d9)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4155af(0x27b)),app=express(),http=require(_0x4155af(0x388))['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x4155af(0x2b0)](_0x4155af(0x250),async(_0x5720cb,_0x36091b)=>{const _0x408e45=_0x4155af,_0x10bd26=_0x5720cb['params'][_0x408e45(0x22e)],_0x2facff=getClientsWithBotID(_0x408e45(0x370)),_0x24fc96=_0x5720cb['headers']['uuid'],_0x40e49b=timelyDecrypt(_0x24fc96,![]),_0x2e00a7=_0x2facff[_0x408e45(0x22f)](_0x1d3850=>_0x1d3850[_0x408e45(0x311)]==_0x40e49b);if(_0x2e00a7){const _0x2caac5=normalizeIP(_0x5720cb['socket'][_0x408e45(0x35c)])[_0x408e45(0x3ce)],_0x466c05=_0x5720cb[_0x408e45(0x2bd)][_0x408e45(0x2ad)];if(validateAccess(_0x466c05,_0x40e49b,_0x2caac5)[_0x408e45(0x2a1)])_0x10bd26==_0x408e45(0x2d7)&&await backupConfigFiles(),await zipFiles(_0x10bd26),_0x36091b['download'](zippath+(_0x10bd26+_0x408e45(0x2ca)),_0x23411d=>{const _0x3c4f5b=_0x408e45;_0x23411d&&(logger[_0x3c4f5b(0x243)](_0x3c4f5b(0x24b)+_0x10bd26),logger[_0x3c4f5b(0x3d3)](_0x23411d));});else logger[_0x408e45(0x243)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x10bd26+_0x408e45(0x36a));}else logger['full'](_0x408e45(0x2f4)+_0x10bd26+_0x408e45(0x3db));}),app['post']('/upload-backup',async(_0x5934d7,_0x57f2e6)=>{const _0x3be433=_0x4155af,_0xf47506=getClientsWithBotID(_0x3be433(0x370)),_0x1e0370=_0x5934d7[_0x3be433(0x2bd)][_0x3be433(0x311)],_0x1505a2=timelyDecrypt(_0x1e0370,![]),_0x43a491=_0xf47506[_0x3be433(0x22f)](_0x27a1b4=>_0x27a1b4['uuid']==_0x1505a2);logger[_0x3be433(0x3d5)](_0x3be433(0x1f0));if(_0x43a491){const _0xeb119c=normalizeIP(_0x5934d7['socket'][_0x3be433(0x35c)])['store'],_0x2f46bb=_0x5934d7[_0x3be433(0x2bd)]['tkn'];if(validateAccess(_0x2f46bb,_0x1505a2,_0xeb119c)['allow']){if(_0x5934d7[_0x3be433(0x2f9)]){const _0x56aec6=_0x5934d7['files']['backupfile'];await _0x56aec6['mv'](temppath+_0x56aec6[_0x3be433(0x237)]),_0x57f2e6[_0x3be433(0x352)]({'status':!![],'message':_0x3be433(0x3be)});const _0x53dbbc=getBotsWithMode();_0x53dbbc[_0x3be433(0x1f7)]>0x0?confirmRestore(temppath,_0x56aec6[_0x3be433(0x237)]):unzipFile(temppath,_0x56aec6[_0x3be433(0x237)]);}}else logger['full'](_0x3be433(0x2a3));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x4155af(0x363)](express[_0x4155af(0x26d)](path['join'](__dirname,bbpath2,_0x4155af(0x29d)))),app[_0x4155af(0x363)](express[_0x4155af(0x26d)](path['join'](__dirname,bbpath2,_0x4155af(0x274)))),app[_0x4155af(0x2b0)]('/',function(_0x56f28c,_0x5d8c47){const _0x20393f=_0x4155af;_0x5d8c47[_0x20393f(0x205)](path[_0x20393f(0x23d)](__dirname,bbpath2,_0x20393f(0x29d),_0x20393f(0x35e)));}),app[_0x4155af(0x2b0)](_0x4155af(0x3bc),function(_0x1ad5e3,_0x226bef){const _0x20f168=_0x4155af;_0x226bef['sendFile'](path[_0x20f168(0x23d)](__dirname,bbpath2,_0x20f168(0x274),_0x20f168(0x35e)));}),app[_0x4155af(0x2b0)]('/:bot/portfolio',(_0x520646,_0x5ae248)=>{const _0x2ff109=_0x4155af;_0x5ae248['sendFile'](path[_0x2ff109(0x23d)](__dirname,bbpath2,_0x2ff109(0x274),'index.html'));}),app[_0x4155af(0x2b0)]('/:bot/performance',(_0x1b9bb2,_0x1e1246)=>{const _0x2ebb21=_0x4155af;_0x1e1246[_0x2ebb21(0x205)](path[_0x2ebb21(0x23d)](__dirname,bbpath2,_0x2ebb21(0x274),_0x2ebb21(0x35e)));}),app[_0x4155af(0x2b0)](_0x4155af(0x339),(_0x316713,_0x5f2705)=>{const _0x3375e0=_0x4155af;_0x5f2705['sendFile'](path[_0x3375e0(0x23d)](__dirname,bbpath2,_0x3375e0(0x274),_0x3375e0(0x35e)));}),app[_0x4155af(0x2b0)]('/:bot/history',(_0x13996a,_0x1395ca)=>{const _0x2947a3=_0x4155af;_0x1395ca[_0x2947a3(0x205)](path[_0x2947a3(0x23d)](__dirname,bbpath2,_0x2947a3(0x274),'index.html'));}),app[_0x4155af(0x2b0)](_0x4155af(0x398),(_0x4518f5,_0x3ecf87)=>{const _0x478a5d=_0x4155af;_0x3ecf87['sendFile'](path[_0x478a5d(0x23d)](__dirname,bbpath2,_0x478a5d(0x274),_0x478a5d(0x35e)));}),app[_0x4155af(0x2b0)](_0x4155af(0x37b),(_0x1f1428,_0x49d119)=>{const _0x1e866f=_0x4155af;_0x49d119[_0x1e866f(0x205)](path[_0x1e866f(0x23d)](__dirname,bbpath2,'build',_0x1e866f(0x35e)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x4155af(0x22c))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xb50a16=_0x4155af;let _0x1a072a=_0xb50a16(0x3e6);const _0x242165=networkInterfaces(),_0x1249b8={};for(const _0x16d275 of Object[_0xb50a16(0x25d)](_0x242165)){for(const _0x5e893a of _0x242165[_0x16d275]){if((_0x5e893a[_0xb50a16(0x392)]==_0xb50a16(0x38d)||_0x5e893a[_0xb50a16(0x392)]==0x4)&&!_0x5e893a[_0xb50a16(0x241)]){const _0x463fdf=ipaddr['parse'](_0x5e893a[_0xb50a16(0x23a)])['range']();_0x463fdf!=_0xb50a16(0x2ef)&&(!_0x1249b8[_0x16d275]&&(_0x1249b8[_0x16d275]=[]),_0x1249b8[_0x16d275][_0xb50a16(0x23f)](_0x5e893a[_0xb50a16(0x23a)]),_0x1a072a=_0x5e893a[_0xb50a16(0x23a)]);}}}return{'serverip':_0x1a072a,'netinterfaces':_0x1249b8};}async function startServer(){const _0x263003=_0x4155af,{serverip:_0x2e4f07,netinterfaces:_0x265e8e}=getServerIP();logger['simple'](''),logger[_0x263003(0x3d3)](_0x263003(0x2ee)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x263003(0x21c)+(environment==_0x263003(0x369)?_0x263003(0x2ae):'')+'\x0a'+(_0x263003(0x2f5)+PORT+_0x263003(0x389))+('=>\x20Go\x20to\x20#CYA#http://'+_0x2e4f07+':'+PORT+_0x263003(0x223))),logger[_0x263003(0x3d3)](_0x263003(0x2ee));if(config[_0x263003(0x1f7)]!=0x0)for(const _0x1cdb18 of config){const _0xe328c5=_0x1cdb18[_0x263003(0x268)]==_0x263003(0x36c)?'a':'m';if(_0x1cdb18['status']==_0x263003(0x238)||_0x1cdb18['status']==_0x263003(0x39c))await logger[_0x263003(0x243)](_0x263003(0x1fd)+_0xe328c5+_0x263003(0x359)+_0x1cdb18[_0x263003(0x20a)]+_0x263003(0x30b)+_0x1cdb18[_0x263003(0x3dd)]),startBot([_0x1cdb18[_0x263003(0x20a)],userID],{'cwd':bbpath},function(_0x543401){if(_0x543401)logger['full'](_0x543401);});else(_0x1cdb18['status']==_0x263003(0x1e2)||_0x1cdb18[_0x263003(0x345)]==_0x263003(0x3af))&&await logger[_0x263003(0x243)](_0x263003(0x275)+_0xe328c5+_0x263003(0x379)+_0x1cdb18[_0x263003(0x20a)]+_0x263003(0x30b)+_0x1cdb18[_0x263003(0x3dd)]);}else!newBot&&logger[_0x263003(0x3d3)](_0x263003(0x244));if(newBot)addBot();logger['simple'](_0x263003(0x2ee)),logger[_0x263003(0x3d3)](''),await logger[_0x263003(0x3d5)](_0x263003(0x231)+nodeversion),await logger[_0x263003(0x3d5)]('Network\x20Interfaces:',_0x265e8e);}function startSocket(){const _0x1aae55=_0x4155af;io['on'](_0x1aae55(0x3ba),_0x145be6=>{const _0x4528f5=_0x1aae55;let _0x397246,_0x7286b,_0x529e26,_0x32100d,_0xf7ce3f;const _0x4804b8=_0x145be6['handshake'][_0x4528f5(0x2bd)][_0x4528f5(0x361)];_0x7286b=_0x4804b8[_0x4528f5(0x3c2)](/bot[0-9]{3}/);if(_0x7286b)_0x529e26=_0x7286b[0x0][_0x4528f5(0x3c2)](/[0-9]{3}/);if(_0x529e26)_0x397246=_0x529e26[0x0];else _0x397246=_0x4528f5(0x370);const _0x4e821b=_0x145be6[_0x4528f5(0x292)][_0x4528f5(0x206)]['encryptedUuid'];if(!_0x4e821b)_0x145be6['emit'](_0x4528f5(0x345),{'publicKey':secure[_0x4528f5(0x2d5)]});else{_0x32100d=timelyDecrypt(_0x4e821b,![]);if(!_0x32100d)_0x145be6[_0x4528f5(0x322)](_0x4528f5(0x345),{'publicKey':secure[_0x4528f5(0x2d5)]});else{_0xf7ce3f=normalizeIP(_0x145be6[_0x4528f5(0x247)]['remoteAddress'])[_0x4528f5(0x3ce)];if(!devices[_0x32100d])devices[_0x32100d]={'uuid':_0x32100d,'access':{'token':null}};devices[_0x32100d]['ip']=_0xf7ce3f;const _0x1b3864=addClient(_0x145be6['id'],_0x32100d,_0x397246);setAccess(_0x1b3864),emitMessages(),_0x145be6['on']('login',_0x335708=>{const _0x574514=_0x4528f5,_0x49c67f=timelyDecrypt(_0x335708[_0x574514(0x228)],!![],_0x574514(0x1f5));if(_0x49c67f){_0x335708={'username':_0x335708[_0x574514(0x2d1)],'password':_0x49c67f},devices[_0x32100d][_0x574514(0x1d9)]=validateCredentials(_0x335708,_0x32100d);if(devices[_0x32100d]['access']['allow']==![]&&devices[_0x32100d][_0x574514(0x1d9)][_0x574514(0x330)]==_0x574514(0x2fb))_0x145be6[_0x574514(0x322)](_0x574514(0x345),{'access':devices[_0x32100d][_0x574514(0x1d9)]}),loginAccess2FA(_0x32100d,_0xf7ce3f);else{if(devices[_0x32100d][_0x574514(0x1d9)][_0x574514(0x2a1)]==![]&&devices[_0x32100d]['access']['reason']==_0x574514(0x3b2))_0x145be6[_0x574514(0x322)](_0x574514(0x345),{'access':devices[_0x32100d][_0x574514(0x1d9)]});else devices[_0x32100d][_0x574514(0x1d9)][_0x574514(0x2a1)]&&devices[_0x32100d]['access'][_0x574514(0x330)]==_0x574514(0x235)&&(getClientsWithUuid(_0x32100d)[_0x574514(0x2a2)](_0x3ae8fc=>{setAccess(_0x3ae8fc);}),logger[_0x574514(0x3d5)](_0x574514(0x36f)+_0x32100d[_0x574514(0x27d)](-0x8)),setTokenRefresh(_0x32100d),setSessionTimeout('login',_0x32100d));}}else logger[_0x574514(0x243)](_0x574514(0x216));}),_0x145be6['on'](_0x4528f5(0x26c),()=>{resetPassword();}),_0x145be6['on'](_0x4528f5(0x300),_0x573a46=>{removeClient(_0x145be6['id']);}),_0x397246==_0x4528f5(0x370)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5d3a62){const _0x17eba3=_0x4155af;if(_0x5d3a62!=_0x17eba3(0x370)&&config['apiKey']!=''){if(pid[_0x5d3a62])pid[_0x5d3a62][_0x17eba3(0x352)]({'function':_0x17eba3(0x2b5),'args':null});}_0x5d3a62!=_0x17eba3(0x370)&&broadcastToBots('bots',JSON[_0x17eba3(0x393)](config));}function reloadBotManager(){const _0x438af8=_0x4155af;getClientsWithBotID(_0x438af8(0x370))[_0x438af8(0x2a2)](_0x5a64d4=>{const _0x698dfe=_0x438af8;getSocket(_0x5a64d4['id'])[_0x698dfe(0x322)]('status',{'access':{'allow':![],'reason':_0x698dfe(0x213),'token':null}});});}function getSocket(_0x201bb9){const _0x5f5008=_0x4155af;return io[_0x5f5008(0x2e5)]['sockets'][_0x5f5008(0x2b0)](_0x201bb9);}function setAccess(_0x57e499){const _0xc24ae8=_0x4155af,_0x4eba1d=getSocket(_0x57e499['id']),_0x238141=_0x57e499[_0xc24ae8(0x311)],_0x619c05=_0x57e499[_0xc24ae8(0x29f)];devices[_0x238141][_0xc24ae8(0x1d9)]=validateAccess(devices[_0x238141][_0xc24ae8(0x1d9)]['token'],_0x238141),logger['debug'](_0xc24ae8(0x312)+devices[_0x238141][_0xc24ae8(0x1d9)]['reason']+'\x20|\x20client:\x20...'+_0x57e499['id']['slice'](-0x8)+_0xc24ae8(0x39a)+_0x238141[_0xc24ae8(0x27d)](-0x8)),_0x4eba1d[_0xc24ae8(0x23d)](_0x238141);if(devices[_0x238141][_0xc24ae8(0x1d9)][_0xc24ae8(0x2a1)]){_0x4eba1d[_0xc24ae8(0x23d)](_0x619c05);if(_0x619c05==_0xc24ae8(0x370))initializeSocketBotManager(_0x4eba1d);else initializeSocketBot(_0x4eba1d);initClient(_0x619c05);}devices[_0x238141]['access']['token']&&devices[_0x238141][_0xc24ae8(0x1d9)][_0xc24ae8(0x330)]==_0xc24ae8(0x284)&&setSessionTimeout(_0xc24ae8(0x20c),_0x238141),devices[_0x238141][_0xc24ae8(0x1d9)][_0xc24ae8(0x278)]&&devices[_0x238141]['access']['reason']==_0xc24ae8(0x386)&&setSessionTimeout(_0xc24ae8(0x384),_0x238141),_0x4eba1d[_0xc24ae8(0x322)](_0xc24ae8(0x345),{'status':_0x57e499[_0xc24ae8(0x2fc)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x238141]['access'],'externalip':devices[_0x238141]['ip'],'publicKey':secure[_0xc24ae8(0x2d5)],'userid':settings[_0xc24ae8(0x3ac)],'validInstallation':validInstallation}),devices[_0x238141][_0xc24ae8(0x1d9)][_0xc24ae8(0x2a1)]==![]&&devices[_0x238141]['access']['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x238141,devices[_0x238141]['ip']);}function setSessionTimeout(_0x2ff274,_0x3c842f){const _0x1dc139=_0x4155af;let _0x1c9c72;if(_0x2ff274==_0x1dc139(0x384))_0x1c9c72=loginExpiry*0x3c*0x3e8;else _0x1c9c72=devices[_0x3c842f][_0x1dc139(0x1f8)][_0x1dc139(0x2b8)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x3c842f][_0x1dc139(0x1f8)][_0x1dc139(0x3c0)]);if(devices[_0x3c842f]['pidExpireLogin'])clearTimeout(devices[_0x3c842f][_0x1dc139(0x1e9)]);devices[_0x3c842f][_0x1dc139(0x1e9)]=setTimeout(()=>{const _0x5d5859=_0x1dc139;if(devices[_0x3c842f][_0x5d5859(0x347)])clearTimeout(devices[_0x3c842f][_0x5d5859(0x347)]);removeSocketListeners(_0x3c842f),addBlacklist(_0x3c842f),devices[_0x3c842f][_0x5d5859(0x1f8)]=null,devices[_0x3c842f]['telegram2FaApproval']=null,devices[_0x3c842f][_0x5d5859(0x1d9)][_0x5d5859(0x278)]=null,logger[_0x5d5859(0x3d5)](_0x5d5859(0x336)+_0x3c842f[_0x5d5859(0x27d)](-0x8)),devices[_0x3c842f][_0x5d5859(0x1d9)]=validateAccess(devices[_0x3c842f][_0x5d5859(0x1d9)][_0x5d5859(0x278)],_0x3c842f),!(devices[_0x3c842f][_0x5d5859(0x1d9)]['allow']&&devices[_0x3c842f]['access'][_0x5d5859(0x330)]=='login\x20not\x20required')&&(_0x2ff274=='login'?io['to'](_0x3c842f)['emit'](_0x5d5859(0x345),{'access':{'allow':![],'reason':_0x5d5859(0x32d),'token':null}}):io['to'](_0x3c842f)[_0x5d5859(0x322)](_0x5d5859(0x345),{'access':{'allow':![],'reason':_0x5d5859(0x290),'token':null}})),devices[_0x3c842f]['access'][_0x5d5859(0x278)]=null;},_0x1c9c72);}function setTokenRefresh(_0x4b1bd4){const _0x2a739d=_0x4155af;if(devices[_0x4b1bd4][_0x2a739d(0x347)])clearTimeout(devices[_0x4b1bd4]['pidRefreshToken']);devices[_0x4b1bd4][_0x2a739d(0x347)]=setTimeout(()=>{const _0x35b908=_0x2a739d;getClientsWithUuid(_0x4b1bd4)[_0x35b908(0x1f7)]!=0x0?(devices[_0x4b1bd4][_0x35b908(0x1d9)]=refreshToken(_0x4b1bd4),io['to'](_0x4b1bd4)[_0x35b908(0x322)](_0x35b908(0x345),{'status':_0x35b908(0x29e),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4b1bd4][_0x35b908(0x1d9)],'externalip':devices[_0x4b1bd4]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x4b1bd4)):clearTimeout(devices[_0x4b1bd4][_0x35b908(0x347)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2f102a){const _0x27f94b=_0x4155af,_0x390b30=getClient(_0x2f102a['id'])['uuid'];_0x2f102a[_0x27f94b(0x322)](_0x27f94b(0x26e),config),_0x2f102a[_0x27f94b(0x322)](_0x27f94b(0x3c3),cleanSettings()),_0x2f102a['on'](_0x27f94b(0x2e1),_0x40c17a=>{const _0x15dd29=_0x27f94b;if(validateAccess(_0x40c17a,_0x390b30)[_0x15dd29(0x2a1)])addBot();else logger[_0x15dd29(0x243)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2f102a['on']('update-bot',(_0x506b8a,_0x3b51fd)=>{const _0x86e648=_0x27f94b;if(validateAccess(_0x3b51fd,_0x390b30)[_0x86e648(0x2a1)])toggleBot(_0x506b8a['botID'],_0x506b8a[_0x86e648(0x345)],_0x506b8a['live']);else logger['full'](_0x86e648(0x1de));}),_0x2f102a['on']('toggle-bot-mode',(_0x4879a4,_0x4bd63b)=>{const _0x188436=_0x27f94b;if(validateAccess(_0x4bd63b,_0x390b30)[_0x188436(0x2a1)])toggleBotMode(_0x4879a4);else logger[_0x188436(0x243)](_0x188436(0x1de));}),_0x2f102a['on']('delete-bot',(_0x266611,_0x75e373)=>{const _0x3cd8e8=_0x27f94b;if(validateAccess(_0x75e373,_0x390b30)[_0x3cd8e8(0x2a1)])deleteBot(_0x266611);else logger['full'](_0x3cd8e8(0x280));}),_0x2f102a['on'](_0x27f94b(0x2e9),(_0x23897c,_0x38643a)=>{const _0xa5e40=_0x27f94b;if(validateAccess(_0x38643a,_0x390b30)[_0xa5e40(0x2a1)])storeSettings(_0x23897c,!![]);else logger[_0xa5e40(0x243)](_0xa5e40(0x1f9));}),_0x2f102a['on'](_0x27f94b(0x251),_0x4f9d30=>{const _0x284122=_0x27f94b;if(validateAccess(_0x4f9d30,_0x390b30)[_0x284122(0x2a1)])updateBB('update');else logger[_0x284122(0x243)](_0x284122(0x28f));}),_0x2f102a['on']('reinstall-bb',_0x6f1095=>{const _0x619d01=_0x27f94b;if(validateAccess(_0x6f1095,_0x390b30)[_0x619d01(0x2a1)])updateBB('reinstall');else logger[_0x619d01(0x243)](_0x619d01(0x2d2));}),_0x2f102a['on'](_0x27f94b(0x201),_0x30cc5b=>{const _0x39957f=_0x27f94b;if(validateAccess(_0x30cc5b,_0x390b30)[_0x39957f(0x2a1)]){const _0x434614=getClient(_0x2f102a['id']);if(_0x434614)getBackupFiles(_0x434614['uuid']);else logger[_0x39957f(0x243)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x39957f(0x243)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x2f102a['on'](_0x27f94b(0x342),(_0x465541,_0x3a6c33)=>{const _0x398dd9=_0x27f94b;if(validateAccess(_0x3a6c33,_0x390b30)['allow'])restoreBackupFile(_0x465541);else logger[_0x398dd9(0x243)](_0x398dd9(0x302));}),_0x2f102a['on'](_0x27f94b(0x349),_0x1e7e21=>{const _0x274f51=_0x27f94b;if(validateAccess(_0x1e7e21,_0x390b30)[_0x274f51(0x2a1)])getMessages();else logger[_0x274f51(0x243)](_0x274f51(0x372));}),_0x2f102a['on'](_0x27f94b(0x353),(_0x3f40d9,_0x386acf)=>{const _0xb5abe6=_0x27f94b;if(validateAccess(_0x386acf,_0x390b30)[_0xb5abe6(0x2a1)])confirmMessage(_0x3f40d9);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2f102a['on'](_0x27f94b(0x2b4),_0x581628=>{const _0x29bc71=_0x27f94b;if(validateAccess(_0x581628,_0x390b30)[_0x29bc71(0x2a1)]){if(devices[_0x390b30]['pidRefreshToken'])clearTimeout(devices[_0x390b30][_0x29bc71(0x347)]);if(devices[_0x390b30][_0x29bc71(0x1e9)])clearTimeout(devices[_0x390b30]['pidExpireLogin']);removeSocketListeners(getClient(_0x2f102a['id'])[_0x29bc71(0x311)]),addBlacklist(_0x390b30),devices[_0x390b30][_0x29bc71(0x1f8)]=null,devices[_0x390b30]['telegram2FaApproval']=null,devices[_0x390b30][_0x29bc71(0x1d9)][_0x29bc71(0x278)]=null,logger[_0x29bc71(0x3d5)](_0x29bc71(0x2c6)+_0x390b30[_0x29bc71(0x27d)](-0x8)),io['to'](getClient(_0x2f102a['id'])[_0x29bc71(0x311)])[_0x29bc71(0x322)](_0x29bc71(0x345),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x29bc71(0x243)](_0x29bc71(0x220));});}function initializeSocketBot(_0x207f59){const _0x346ae7=_0x4155af,_0x32eda4=getClient(_0x207f59['id'])[_0x346ae7(0x29f)],_0x458ba9=getClient(_0x207f59['id'])[_0x346ae7(0x311)];_0x207f59['on'](_0x346ae7(0x2af),(_0x1e5372,_0x2bb4fd)=>{const _0x28f7c6=_0x346ae7;if(validateAccess(_0x2bb4fd,_0x458ba9)[_0x28f7c6(0x2a1)]){if(pid[_0x32eda4])pid[_0x32eda4][_0x28f7c6(0x352)]({'function':_0x28f7c6(0x1e5),'args':_0x1e5372});}else logger[_0x28f7c6(0x243)](_0x28f7c6(0x37e));}),_0x207f59['on'](_0x346ae7(0x2ec),(_0x116a22,_0x19d64d)=>{const _0x2920b4=_0x346ae7;if(validateAccess(_0x19d64d,_0x458ba9)[_0x2920b4(0x2a1)]){if(pid[_0x32eda4])pid[_0x32eda4]['send']({'function':_0x2920b4(0x2a8),'args':_0x116a22});}else logger['full'](_0x2920b4(0x37c));}),_0x207f59['on'](_0x346ae7(0x2c2),(_0x508e32,_0x5456d1)=>{const _0x311286=_0x346ae7;if(validateAccess(_0x5456d1,_0x458ba9)[_0x311286(0x2a1)]){if(pid[_0x32eda4])pid[_0x32eda4]['send']({'function':_0x311286(0x26a),'args':_0x508e32});}else logger[_0x311286(0x243)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x207f59['on']('store-configuration',(_0x4bcbf8,_0x151b0a)=>{const _0x41c0d2=_0x346ae7;if(validateAccess(_0x151b0a,_0x458ba9)[_0x41c0d2(0x2a1)]){if(pid[_0x32eda4])pid[_0x32eda4][_0x41c0d2(0x352)]({'function':_0x41c0d2(0x24a),'args':_0x4bcbf8});}else logger[_0x41c0d2(0x243)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x207f59['on'](_0x346ae7(0x25a),(_0x4685b0,_0xa8d250)=>{const _0x412245=_0x346ae7;if(validateAccess(_0xa8d250,_0x458ba9)[_0x412245(0x2a1)]){if(pid[_0x32eda4])pid[_0x32eda4][_0x412245(0x352)]({'function':'storeHeadless','args':_0x4685b0});}else logger['full'](_0x412245(0x30a));}),_0x207f59['on'](_0x346ae7(0x305),(_0x5effe9,_0x1ef605)=>{const _0xf088c8=_0x346ae7;if(validateAccess(_0x1ef605,_0x458ba9)['allow']){if(pid[_0x32eda4])pid[_0x32eda4][_0xf088c8(0x352)]({'function':_0xf088c8(0x2bf),'args':_0x5effe9});}else logger[_0xf088c8(0x243)](_0xf088c8(0x3a9));}),_0x207f59['on'](_0x346ae7(0x295),_0x11de65=>{const _0x586a4d=_0x346ae7;if(validateAccess(_0x11de65,_0x458ba9)['allow']){if(pid[_0x32eda4])pid[_0x32eda4][_0x586a4d(0x352)]({'function':_0x586a4d(0x2c3),'args':null});}else logger['full'](_0x586a4d(0x227));}),_0x207f59['on'](_0x346ae7(0x316),_0x55033f=>{const _0x5b11a7=_0x346ae7;if(validateAccess(_0x55033f,_0x458ba9)['allow']){if(pid[_0x32eda4])pid[_0x32eda4][_0x5b11a7(0x352)]({'function':_0x5b11a7(0x215),'args':null});}else logger[_0x5b11a7(0x243)](_0x5b11a7(0x26f));}),_0x207f59['on']('place-order',(_0x3d58a5,_0x20fc1e)=>{const _0x4fbd43=_0x346ae7;if(validateAccess(_0x20fc1e,_0x458ba9)['allow']){if(pid[_0x32eda4])pid[_0x32eda4][_0x4fbd43(0x352)]({'function':_0x4fbd43(0x21b),'args':_0x3d58a5});}else logger[_0x4fbd43(0x243)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x207f59['on'](_0x346ae7(0x329),_0x51be0b=>{const _0x5c748a=_0x346ae7;if(validateAccess(_0x51be0b,_0x458ba9)['allow']){if(pid[_0x32eda4])pid[_0x32eda4][_0x5c748a(0x352)]({'function':'cancelLoading','args':null});}else logger[_0x5c748a(0x243)](_0x5c748a(0x282));}),_0x207f59['on'](_0x346ae7(0x2b3),_0x1d44ab=>{const _0x4f7ff2=_0x346ae7;if(validateAccess(_0x1d44ab,_0x458ba9)['allow']){if(pid[_0x32eda4])pid[_0x32eda4][_0x4f7ff2(0x352)]({'function':_0x4f7ff2(0x2c9),'args':null});}else logger[_0x4f7ff2(0x243)](_0x4f7ff2(0x3da));}),_0x207f59['on'](_0x346ae7(0x251),_0x3fd8c7=>{const _0x88702d=_0x346ae7;if(validateAccess(_0x3fd8c7,_0x458ba9)[_0x88702d(0x2a1)])updateBB(_0x88702d(0x29c));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x207f59['on'](_0x346ae7(0x349),_0x1ced83=>{const _0x5323f8=_0x346ae7;if(validateAccess(_0x1ced83,_0x458ba9)['allow'])getMessages();else logger['full'](_0x5323f8(0x372));}),_0x207f59['on'](_0x346ae7(0x353),(_0x5a4ec9,_0x448bbf)=>{const _0x33c602=_0x346ae7;if(validateAccess(_0x448bbf,_0x458ba9)[_0x33c602(0x2a1)])confirmMessage(_0x5a4ec9);else logger['full'](_0x33c602(0x1dc));}),_0x207f59['on'](_0x346ae7(0x2b4),_0x439c07=>{const _0x3a212d=_0x346ae7;if(validateAccess(_0x439c07,_0x458ba9)[_0x3a212d(0x2a1)]){if(devices[_0x458ba9][_0x3a212d(0x347)])clearTimeout(devices[_0x458ba9][_0x3a212d(0x347)]);if(devices[_0x458ba9][_0x3a212d(0x1e9)])clearTimeout(devices[_0x458ba9]['pidExpireLogin']);removeSocketListeners(getClient(_0x207f59['id'])[_0x3a212d(0x311)]),addBlacklist(_0x458ba9),devices[_0x458ba9][_0x3a212d(0x1f8)]=null,devices[_0x458ba9]['telegram2FaApproval']=null,devices[_0x458ba9][_0x3a212d(0x1d9)]['token']=null,logger[_0x3a212d(0x3d5)]('Logged\x20out\x20user\x20...'+_0x458ba9['slice'](-0x8)),io['to'](getClient(_0x207f59['id'])[_0x3a212d(0x311)])[_0x3a212d(0x322)](_0x3a212d(0x345),{'access':{'allow':![],'reason':_0x3a212d(0x2dc),'token':null}});}else logger[_0x3a212d(0x243)](_0x3a212d(0x220));});}function removeSocketListeners(_0x597728){getClientsWithUuid(_0x597728)['forEach'](_0x816ba4=>{getSocket(_0x816ba4['id'])['removeAllListeners']();});}function cleanSettings(){const _0x4709b5=_0x4155af;let _0x2f2d0a=settings;return settings[_0x4709b5(0x2e6)]&&settings[_0x4709b5(0x2e6)]!=''&&(_0x2f2d0a={..._0x2f2d0a,'telegramToken':_0x4709b5(0x279)}),settings[_0x4709b5(0x2de)]&&settings[_0x4709b5(0x2de)]!=''&&(_0x2f2d0a={..._0x2f2d0a,'bbPassword':_0x4709b5(0x279)}),settings[_0x4709b5(0x306)]&&settings['marketcapApi']!=''&&(_0x2f2d0a={..._0x2f2d0a,'marketcapApi':'************'}),(settings[_0x4709b5(0x2de)]&&settings[_0x4709b5(0x2de)]==_0x4709b5(0x219)||settings[_0x4709b5(0x2e6)]&&settings[_0x4709b5(0x2e6)]==_0x4709b5(0x219)||settings[_0x4709b5(0x306)]&&settings['marketcapApi']==_0x4709b5(0x219))&&(_0x2f2d0a={..._0x2f2d0a,'restored':{'password':settings[_0x4709b5(0x2de)]==_0x4709b5(0x219),'telegram':settings[_0x4709b5(0x2e6)]==_0x4709b5(0x219),'marketcap':settings[_0x4709b5(0x306)]==_0x4709b5(0x219)}}),_0x2f2d0a;}async function updateBB(_0x198eab){const _0x2bd452=_0x4155af;await backupConfigFiles(),installingUpdate=!![],config[_0x2bd452(0x2a2)](_0x35f829=>{const _0x18d6d4=_0x2bd452;restartBot(_0x35f829[_0x18d6d4(0x20a)]);});if(_0x198eab==_0x2bd452(0x29c))process['send']({'update':!![],'environment':environment},_0x1c2364=>{});else _0x198eab==_0x2bd452(0x3c7)&&process[_0x2bd452(0x352)]({'reinstall':!![],'environment':environment},_0x4d5640=>{});}function startBot(_0xf09a0,_0x3e3440,_0x11271e){const _0x43c9ee=_0x4155af;if(debugging)_0xf09a0[_0x43c9ee(0x23f)]('-d');let _0x527045=![];const _0x489525=_0xf09a0[0x0];_0x3e3440={..._0x3e3440,'stdio':[_0x43c9ee(0x391),_0x43c9ee(0x391),'inherit',_0x43c9ee(0x1f1)]},pid[_0x489525]=childProcess[_0x43c9ee(0x2eb)](botfile,_0xf09a0,_0x3e3440),pid[_0x489525]['on'](_0x43c9ee(0x310),_0x2051dd=>{const _0xf6191c=_0x43c9ee;switch(Object[_0xf6191c(0x25d)](_0x2051dd)[0x0]){case _0xf6191c(0x3dd):updateBotName(_0x489525,_0x2051dd['botname']);break;case _0xf6191c(0x354):updateBotManager();break;case _0xf6191c(0x345):updateStatus(_0x489525,_0x2051dd[_0xf6191c(0x345)]);break;case'live':updateLive(_0x489525,_0x2051dd[_0xf6191c(0x230)]);break;case _0xf6191c(0x29b):updateLive(_0x489525,_0x2051dd[_0xf6191c(0x29b)]),io['to'](_0x489525)[_0xf6191c(0x322)]('status',{'access':{'allow':![],'reason':_0xf6191c(0x213),'token':null}});break;case'stop':_0x2051dd[_0xf6191c(0x31a)]==_0xf6191c(0x1fe)&&restartBot(_0x489525);_0x2051dd[_0xf6191c(0x31a)]==_0xf6191c(0x242)&&toggleBot(_0x489525,_0xf6191c(0x1e2),_0xf6191c(0x371));break;case _0xf6191c(0x293):sendTelegramBot(_0x489525,_0x2051dd[_0xf6191c(0x293)]);break;case'telegrammsg':sendTelegramMsg(_0x2051dd[_0xf6191c(0x273)]);break;case _0xf6191c(0x39e):io['to'](_0x489525)['emit'](_0x2051dd[_0xf6191c(0x39e)],_0x2051dd[_0xf6191c(0x2fe)]);break;}}),pid[_0x489525]['on'](_0x43c9ee(0x31d),function(_0x55b77e){if(_0x527045)return;_0x527045=!![],_0x11271e(_0x55b77e);}),pid[_0x489525]['on']('exit',async function(_0x45ea64){const _0x349aed=_0x43c9ee;if(terminating)return;if(installingUpdate){logger[_0x349aed(0x3d5)](_0x349aed(0x3d4)),io[_0x349aed(0x27a)]();return;}if(_0x527045)return;_0x527045=!![],_0x11271e(null);const _0xb3bbb8=dbConfig['get']('bots')[_0x349aed(0x22f)]({'botID':_0x489525})[_0x349aed(0x399)]();_0xb3bbb8&&(_0xb3bbb8['status']=='enabled'||_0xb3bbb8[_0x349aed(0x345)]==_0x349aed(0x39c))&&(await sleep(0x3e8),updateLive(_0x489525,_0x349aed(0x371)),logger[_0x349aed(0x243)](_0x349aed(0x340)+_0x489525),startBot([_0x489525,userID],{'cwd':bbpath},function(_0x473cd6){if(_0x473cd6)logger['full'](_0x473cd6);}));});}function stopBot(_0x2650be){const _0x448724=_0x4155af;getClientsWithBotID(_0x2650be)[_0x448724(0x2a2)](_0x4cdedd=>{const _0x4bd93c=_0x448724;getSocket(_0x4cdedd['id'])[_0x4bd93c(0x300)](!![]),removeClient(_0x4cdedd['id']);}),pid[_0x2650be]&&(pid[_0x2650be][_0x448724(0x242)](),pid[_0x2650be]=null);}function stopAllBots(){const _0x433ecf=_0x4155af;terminating=!![];const _0x451f24=getEnabledBots();_0x451f24[_0x433ecf(0x2a2)](_0x57a7d=>{const _0x226398=_0x433ecf;stopBot(_0x57a7d[_0x226398(0x20a)]);});}function restartBot(_0x5b9e24){const _0x3ef2a4=_0x4155af;if(pid[_0x5b9e24])pid[_0x5b9e24][_0x3ef2a4(0x242)]();}function addBot(){const _0x416c83=_0x4155af;let _0x5e0337;for(let _0x515d09=0x1;_0x515d09<0x3e9;_0x515d09++){_0x5e0337=_0x515d09[_0x416c83(0x2d9)]()['padStart'](0x3,'0');let _0x495847=config[_0x416c83(0x22f)](_0x899a4c=>_0x899a4c['botID']==_0x5e0337);if(!_0x495847)break;}if(_0x5e0337===_0x416c83(0x3b9)){logger[_0x416c83(0x243)](_0x416c83(0x37d));return;}logger['full'](_0x416c83(0x3e0)+_0x5e0337),dbConfig[_0x416c83(0x2b0)](_0x416c83(0x26e))[_0x416c83(0x23f)]({'botID':_0x5e0337,'botname':_0x416c83(0x1db)+_0x5e0337,'status':'new','live':''})['write'](),startBot([_0x5e0337,userID],{'cwd':bbpath},function(_0x3b8622){const _0x33cdef=_0x416c83;if(_0x3b8622)logger[_0x33cdef(0x243)](_0x3b8622);}),config=getConfiguration(),io['to'](_0x416c83(0x370))[_0x416c83(0x322)](_0x416c83(0x26e),config),broadcastToBots('bots',JSON[_0x416c83(0x393)](config));}function deleteBot(_0x38ef2f){const _0x28e115=_0x4155af;getClientsWithBotID(_0x38ef2f)[_0x28e115(0x2a2)](_0x4294c2=>{const _0x47249e=_0x28e115;getSocket(_0x4294c2['id'])[_0x47249e(0x300)](!![]),removeClient(_0x4294c2['id']);}),dbConfig[_0x28e115(0x2b0)](_0x28e115(0x26e))[_0x28e115(0x31e)]({'botID':_0x38ef2f})['write'](),logger[_0x28e115(0x243)](_0x28e115(0x30d)+_0x38ef2f),stopBot(_0x38ef2f);try{if(fs[_0x28e115(0x3d7)](path[_0x28e115(0x23d)](configpath,'bot-'+_0x38ef2f+'-config.json')))fs[_0x28e115(0x22a)](path[_0x28e115(0x23d)](configpath,_0x28e115(0x2ce)+_0x38ef2f+_0x28e115(0x2a6)));if(fs[_0x28e115(0x3d7)](path['join'](configpath,_0x28e115(0x2ce)+_0x38ef2f+'-events.json')))fs[_0x28e115(0x22a)](path[_0x28e115(0x23d)](configpath,_0x28e115(0x2ce)+_0x38ef2f+_0x28e115(0x387)));if(fs[_0x28e115(0x3d7)](path[_0x28e115(0x23d)](configpath,_0x28e115(0x2ce)+_0x38ef2f+_0x28e115(0x319))))fs['unlinkSync'](path[_0x28e115(0x23d)](configpath,'bot-'+_0x38ef2f+_0x28e115(0x319)));if(fs['existsSync'](path[_0x28e115(0x23d)](configpath,_0x28e115(0x2ce)+_0x38ef2f+_0x28e115(0x2e7))))fs['unlinkSync'](path['join'](configpath,_0x28e115(0x2ce)+_0x38ef2f+_0x28e115(0x2e7)));}catch(_0x2ed5f6){if(_0x2ed5f6)logger[_0x28e115(0x243)](_0x28e115(0x1d5),_0x2ed5f6);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x28e115(0x26e),config),broadcastToBots(_0x28e115(0x26e),JSON[_0x28e115(0x393)](config));}function toggleBot(_0x2121e7,_0x3aa9ca,_0x2a9f37){const _0x39a985=_0x4155af;dbConfig[_0x39a985(0x2b0)](_0x39a985(0x26e))['find']({'botID':_0x2121e7})[_0x39a985(0x2cb)]({'status':_0x3aa9ca})[_0x39a985(0x2cb)]({'live':_0x2a9f37})['write']();if(_0x3aa9ca==_0x39a985(0x238)||_0x3aa9ca=='new')logger[_0x39a985(0x243)](_0x39a985(0x2be)+_0x2121e7),startBot([_0x2121e7,userID],{'cwd':bbpath},function(_0x23ad8e){if(_0x23ad8e)logger['full'](_0x23ad8e);});else(_0x3aa9ca=='disabled'||_0x3aa9ca==_0x39a985(0x3af))&&(logger[_0x39a985(0x243)](_0x39a985(0x3b8)+_0x2121e7),stopBot(_0x2121e7));config=getConfiguration(),io['to'](_0x39a985(0x370))['emit'](_0x39a985(0x26e),config),broadcastToBots(_0x39a985(0x26e),JSON[_0x39a985(0x393)](config));}function toggleStatus(_0x5dd038){const _0x1107bb=_0x4155af;let _0x3161c0=dbConfig[_0x1107bb(0x2b0)](_0x1107bb(0x26e))[_0x1107bb(0x22f)]({'botID':_0x5dd038})[_0x1107bb(0x399)](),_0x9394d9;if(_0x3161c0[_0x1107bb(0x345)]==='enabled')_0x9394d9=_0x1107bb(0x1e2);else{if(_0x3161c0['status']===_0x1107bb(0x39c))_0x9394d9=_0x1107bb(0x3af);else{if(_0x3161c0['status']===_0x1107bb(0x3af))_0x9394d9='new';else{if(_0x3161c0['status']===_0x1107bb(0x1e2))_0x9394d9=_0x1107bb(0x238);}}}return _0x9394d9;}function updateStatus(_0x2869c9,_0x17df84){const _0x3856c5=_0x4155af;dbConfig[_0x3856c5(0x2b0)](_0x3856c5(0x26e))[_0x3856c5(0x22f)]({'botID':_0x2869c9})[_0x3856c5(0x2cb)]({'status':_0x17df84})[_0x3856c5(0x1ff)](),config=getConfiguration(),io['to'](_0x3856c5(0x370))[_0x3856c5(0x322)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x38a8de,_0x4004fe){const _0x1cd9b9=_0x4155af;dbConfig[_0x1cd9b9(0x2b0)](_0x1cd9b9(0x26e))['find']({'botID':_0x38a8de})['assign']({'live':_0x4004fe})['write'](),config=getConfiguration(),io['to'](_0x1cd9b9(0x370))['emit'](_0x1cd9b9(0x26e),config),broadcastToBots(_0x1cd9b9(0x26e),JSON[_0x1cd9b9(0x393)](config));}function updateBotName(_0x58f82b,_0x293dc6){const _0x798e4=_0x4155af;dbConfig[_0x798e4(0x2b0)](_0x798e4(0x26e))[_0x798e4(0x22f)]({'botID':_0x58f82b})['assign']({'botname':_0x293dc6})['write'](),config=getConfiguration(),io['to'](_0x798e4(0x370))[_0x798e4(0x322)](_0x798e4(0x26e),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x40c81e=_0x4155af;config=getConfiguration(),io['to'](_0x40c81e(0x370))[_0x40c81e(0x322)]('bots',config),broadcastToBots(_0x40c81e(0x26e),JSON[_0x40c81e(0x393)](config));}function toggleBotMode(_0x222bba){const _0x5a1307=_0x4155af;if(pid[_0x222bba])pid[_0x222bba]['send']({'function':'toggleBotMode','args':null});else{const _0x2d7d96=configpath+_0x5a1307(0x2ce)+_0x222bba+_0x5a1307(0x2a6),_0xb8c3db=fs[_0x5a1307(0x2ac)](_0x2d7d96),_0xb69632=JSON['parse'](_0xb8c3db),_0x4d3649=_0xb69632[_0x5a1307(0x29f)][0x0]['headless'];_0xb69632[_0x5a1307(0x29f)][0x0]['headless']=!_0x4d3649;const _0x4cecde=JSON[_0x5a1307(0x393)](_0xb69632,null,0x2);fs[_0x5a1307(0x25b)](_0x2d7d96,_0x4cecde),config=getConfiguration(),io['to'](_0x5a1307(0x370))[_0x5a1307(0x322)](_0x5a1307(0x26e),config),broadcastToBots('bots',JSON[_0x5a1307(0x393)](config));}}function validateTelegram(_0x2d5725){const _0x4a6523=_0x4155af;if(_0x2d5725[_0x4a6523(0x2cc)][_0x4a6523(0x2d1)]!=settings[_0x4a6523(0x366)]&&'@'+_0x2d5725['from'][_0x4a6523(0x2d1)]!=settings[_0x4a6523(0x366)]||_0x2d5725[_0x4a6523(0x210)]['id']!=settings[_0x4a6523(0x285)])return sendTelegram(_0x2d5725[_0x4a6523(0x210)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x4a6523(0x1fa)}),![];return!![];}async function initTelegram(){const _0x26ba69=_0x4155af;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x26ba69(0x2e6)]);let _0x311c3c=_0x26ba69(0x3d8);_0x311c3c+='\x0a',_0x311c3c+=_0x26ba69(0x2bb),_0x311c3c+=_0x26ba69(0x3ca),_0x311c3c+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x311c3c+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x311c3c+='/on\x20-\x20start\x20bot(s)\x0a',_0x311c3c+=_0x26ba69(0x365),_0x311c3c+=_0x26ba69(0x356),_0x311c3c+=_0x26ba69(0x2cf),_0x311c3c+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x311c3c+=_0x26ba69(0x2e8),_0x311c3c+=_0x26ba69(0x385),_0x311c3c+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x311c3c+=_0x26ba69(0x36b),_0x311c3c+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3e8b75=_0x26ba69(0x249);_0x3e8b75+='\x0a',_0x3e8b75+=_0x311c3c,tgBot[_0x26ba69(0x321)]((_0x13c2de,_0x432fea)=>{const _0x4e7d92=_0x26ba69;logger[_0x4e7d92(0x3d3)](getTimeStamp()+_0x4e7d92(0x1ea)),logger['debug']('Telegraf\x20error:',_0x13c2de);}),tgBot['use'](async(_0x579b96,_0x80998c)=>{const _0x2fc431=_0x26ba69;if(!(!settings[_0x2fc431(0x285)]&&_0x579b96[_0x2fc431(0x29c)][_0x2fc431(0x310)][_0x2fc431(0x2da)]==_0x2fc431(0x28e))){if(!validateTelegram(_0x579b96))return;}_0x80998c();}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x331),async _0x4f9049=>{const _0x388c75=_0x26ba69;if(!settings[_0x388c75(0x285)])updateSetting(_0x388c75(0x285),_0x4f9049['chat']['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x4f9049))return;await sendTelegram(_0x4f9049['chat']['id'],_0x3e8b75);}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x21d),async _0x2fb49b=>{const _0xecd139=_0x26ba69;updateSetting(_0xecd139(0x3d2),!![]),await sendTelegram(_0x2fb49b[_0xecd139(0x210)]['id'],_0xecd139(0x381));}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x1e4),async _0xf4c028=>{const _0x18b528=_0x26ba69;await sendTelegram(_0xf4c028['chat']['id'],_0x18b528(0x253)),updateSetting(_0x18b528(0x3d2),![]);}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x24e),async _0x2bc99d=>{const _0x2e58f5=_0x26ba69,_0x130605=Markup['inlineKeyboard']([Markup['button'][_0x2e58f5(0x256)](_0x2e58f5(0x367),_0x2e58f5(0x3ad)),Markup[_0x2e58f5(0x294)][_0x2e58f5(0x256)](_0x2e58f5(0x36d),_0x2e58f5(0x35d)),Markup[_0x2e58f5(0x294)][_0x2e58f5(0x256)](_0x2e58f5(0x200),_0x2e58f5(0x2a4))]);_0x2bc99d[_0x2e58f5(0x291)](_0x2e58f5(0x368),_0x130605);}),tgBot['action'](_0x26ba69(0x3ad),async _0x4a56cd=>{const _0x1f21e2=_0x26ba69;_0x4a56cd[_0x1f21e2(0x1da)](),updateSetting(_0x1f21e2(0x378),'orders'),updateSetting(_0x1f21e2(0x3d2),!![]),await sendTelegram(_0x4a56cd['chat']['id'],_0x1f21e2(0x1e8));}),tgBot[_0x26ba69(0x1e1)](_0x26ba69(0x35d),async _0x45538b=>{const _0x33f3bc=_0x26ba69;_0x45538b['editMessageReplyMarkup'](),updateSetting(_0x33f3bc(0x378),_0x33f3bc(0x2b2)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x45538b[_0x33f3bc(0x210)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot['action']('config_all',async _0x10d19a=>{const _0xd44aac=_0x26ba69;_0x10d19a[_0xd44aac(0x1da)](),updateSetting(_0xd44aac(0x378),_0xd44aac(0x328)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x10d19a[_0xd44aac(0x210)]['id'],_0xd44aac(0x2b6));}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x345),async _0x53a706=>{const _0x261110=_0x26ba69,_0x211ccc=getBotsWithMode();let _0x1a6ae7=_0x261110(0x1ed);config[_0x261110(0x2a2)](_0x45669a=>{const _0x1b8c22=_0x261110,_0x23808e=_0x211ccc[_0x1b8c22(0x22f)](_0x46215a=>_0x46215a[_0x1b8c22(0x20a)]==_0x45669a[_0x1b8c22(0x20a)])[_0x1b8c22(0x268)];_0x1a6ae7+=_0x1b8c22(0x1db)+_0x45669a[_0x1b8c22(0x20a)]+':\x20'+_0x45669a[_0x1b8c22(0x345)]+_0x1b8c22(0x30b)+_0x23808e+'\x20|\x20'+_0x45669a[_0x1b8c22(0x230)]+'\x0a';}),_0x1a6ae7+='\x0a',_0x1a6ae7+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x1a6ae7+=!settings[_0x261110(0x3d2)]?_0x261110(0x1fc):_0x261110(0x3c6),_0x1a6ae7+=settings['telegramEnabled']?settings['telegramEvents']=='all'?_0x261110(0x2f6):_0x261110(0x3c5)+settings[_0x261110(0x378)]+_0x261110(0x325):'',await sendTelegram(_0x53a706['chat']['id'],_0x1a6ae7,{'parse_mode':_0x261110(0x1fa)});}),tgBot[_0x26ba69(0x2d0)]('restart',async _0x3b4dcc=>{const _0x5ec2f9=_0x26ba69,_0x537351=getEnabledBots();if(_0x537351[_0x5ec2f9(0x1f7)]==0x0)await sendTelegram(_0x3b4dcc[_0x5ec2f9(0x210)]['id'],_0x5ec2f9(0x3aa));else{if(_0x537351[_0x5ec2f9(0x1f7)]>0x1)_0x537351[_0x5ec2f9(0x23f)]({'botID':_0x5ec2f9(0x328)});let _0x25de93=[],_0x1e8173=[];const _0x33b13d=_0x537351['length']%0x4==0x0||_0x537351['length']%0x4==0x3||_0x537351[_0x5ec2f9(0x1f7)]%0x3==0x1?0x4:0x3;let _0x2af4c4=0x0;_0x537351[_0x5ec2f9(0x2a2)]((_0xc0cba9,_0xef4bee)=>{const _0x22e311=_0x5ec2f9;if(_0xef4bee%_0x33b13d==0x0)_0x1e8173=[];_0x1e8173[_0x22e311(0x23f)](Markup[_0x22e311(0x294)]['callback'](_0xc0cba9[_0x22e311(0x20a)]==_0x22e311(0x328)?_0x22e311(0x1d7):_0x22e311(0x1db)+_0xc0cba9[_0x22e311(0x20a)],_0x22e311(0x288)+_0xc0cba9[_0x22e311(0x20a)])),_0xef4bee%_0x33b13d==0x0&&(_0x25de93[_0x2af4c4]=_0x1e8173,_0x2af4c4++);});const _0x5ada18=Markup[_0x5ec2f9(0x3dc)](_0x25de93);_0x3b4dcc[_0x5ec2f9(0x291)](_0x5ec2f9(0x1d8),_0x5ada18);}}),tgBot[_0x26ba69(0x1e1)](/restart_(.+)/,async _0x34285a=>{const _0x3bf500=_0x26ba69,_0x585c6d=_0x34285a['match'][0x1];_0x34285a[_0x3bf500(0x1da)](),_0x585c6d==_0x3bf500(0x328)?config[_0x3bf500(0x2a2)](_0x2bdcba=>{restartBot(_0x2bdcba['botID']);}):restartBot(_0x585c6d);}),tgBot[_0x26ba69(0x2d0)]('on',async _0x1904b5=>{const _0x4eeeea=_0x26ba69,_0xec1589=getDisabledBots();if(_0xec1589['length']==0x0)await sendTelegram(_0x1904b5[_0x4eeeea(0x210)]['id'],_0x4eeeea(0x20d));else{if(_0xec1589[_0x4eeeea(0x1f7)]>0x1)_0xec1589[_0x4eeeea(0x23f)]({'botID':_0x4eeeea(0x328)});let _0x1eea32=[],_0x1c253b=[];const _0x5e7aa7=_0xec1589[_0x4eeeea(0x1f7)]%0x4==0x0||_0xec1589[_0x4eeeea(0x1f7)]%0x4==0x3||_0xec1589[_0x4eeeea(0x1f7)]%0x3==0x1?0x4:0x3;let _0x460b58=0x0;_0xec1589[_0x4eeeea(0x2a2)]((_0x1e7fba,_0x33294b)=>{const _0x3c3b15=_0x4eeeea;if(_0x33294b%_0x5e7aa7==0x0)_0x1c253b=[];_0x1c253b[_0x3c3b15(0x23f)](Markup['button'][_0x3c3b15(0x256)](_0x1e7fba[_0x3c3b15(0x20a)]=='all'?'All\x20bots':_0x3c3b15(0x1db)+_0x1e7fba[_0x3c3b15(0x20a)],_0x3c3b15(0x1ee)+_0x1e7fba['botID'])),_0x33294b%_0x5e7aa7==0x0&&(_0x1eea32[_0x460b58]=_0x1c253b,_0x460b58++);});const _0x351309=Markup[_0x4eeeea(0x3dc)](_0x1eea32);_0x1904b5[_0x4eeeea(0x291)](_0x4eeeea(0x32b),_0x351309);}}),tgBot['action'](/on_(.+)/,async _0x3c1bf5=>{const _0x397a48=_0x26ba69,_0x4f247a=_0x3c1bf5['match'][0x1];_0x3c1bf5[_0x397a48(0x1da)]();if(_0x4f247a=='all'){const _0x1ed3f6=getDisabledBots();await sendTelegram(_0x3c1bf5['chat']['id'],_0x397a48(0x2c8)),_0x1ed3f6[_0x397a48(0x2a2)](_0x20c975=>{const _0x2b32de=_0x397a48;if(_0x20c975[_0x2b32de(0x20a)]!=_0x2b32de(0x328))toggleBot(_0x20c975[_0x2b32de(0x20a)],toggleStatus(_0x20c975[_0x2b32de(0x20a)]),_0x2b32de(0x371));});}else await sendTelegram(_0x3c1bf5[_0x397a48(0x210)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4f247a),toggleBot(_0x4f247a,toggleStatus(_0x4f247a),'stopped');}),tgBot['command']('off',async _0x1d841a=>{const _0x881827=_0x26ba69,_0x19c973=getEnabledBots();if(_0x19c973[_0x881827(0x1f7)]==0x0)await sendTelegram(_0x1d841a[_0x881827(0x210)]['id'],_0x881827(0x3aa));else{if(_0x19c973[_0x881827(0x1f7)]>0x1)_0x19c973[_0x881827(0x23f)]({'botID':_0x881827(0x328)});let _0x449dd4=[],_0x2fb5cd=[];const _0x327b76=_0x19c973[_0x881827(0x1f7)]%0x4==0x0||_0x19c973[_0x881827(0x1f7)]%0x4==0x3||_0x19c973['length']%0x3==0x1?0x4:0x3;let _0x309032=0x0;_0x19c973[_0x881827(0x2a2)]((_0x1d5999,_0xf7b1da)=>{const _0xd9e286=_0x881827;if(_0xf7b1da%_0x327b76==0x0)_0x2fb5cd=[];_0x2fb5cd[_0xd9e286(0x23f)](Markup['button'][_0xd9e286(0x256)](_0x1d5999[_0xd9e286(0x20a)]==_0xd9e286(0x328)?_0xd9e286(0x1d7):'Bot\x20'+_0x1d5999['botID'],_0xd9e286(0x3bd)+_0x1d5999[_0xd9e286(0x20a)])),_0xf7b1da%_0x327b76==0x0&&(_0x449dd4[_0x309032]=_0x2fb5cd,_0x309032++);});const _0x541f30=Markup['inlineKeyboard'](_0x449dd4);_0x1d841a[_0x881827(0x291)](_0x881827(0x2a5),_0x541f30);}}),tgBot[_0x26ba69(0x1e1)](/off_(.+)/,async _0x1b572d=>{const _0x30b0fe=_0x26ba69,_0x3cc120=_0x1b572d[_0x30b0fe(0x3c2)][0x1];_0x1b572d[_0x30b0fe(0x1da)]();if(_0x3cc120==_0x30b0fe(0x328)){const _0x4158b0=getEnabledBots();await sendTelegram(_0x1b572d[_0x30b0fe(0x210)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x4158b0[_0x30b0fe(0x2a2)](_0x552330=>{const _0x574d98=_0x30b0fe;if(_0x552330[_0x574d98(0x20a)]!=_0x574d98(0x328))toggleBot(_0x552330['botID'],toggleStatus(_0x552330['botID']),_0x574d98(0x371));});}else await sendTelegram(_0x1b572d[_0x30b0fe(0x210)]['id'],_0x30b0fe(0x2fd)+_0x3cc120),toggleBot(_0x3cc120,toggleStatus(_0x3cc120),_0x30b0fe(0x371));}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x335),async _0x4457d9=>{const _0x1ee486=_0x26ba69,_0x59fa11=getEnabledBots();if(_0x59fa11[_0x1ee486(0x1f7)]==0x0)await sendTelegram(_0x4457d9['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x59fa11[_0x1ee486(0x1f7)]>0x1){let _0x5d6fee=[],_0x55b89d=[];const _0xdd9520=_0x59fa11[_0x1ee486(0x1f7)]%0x4==0x0||_0x59fa11[_0x1ee486(0x1f7)]%0x4==0x3||_0x59fa11[_0x1ee486(0x1f7)]%0x3==0x1?0x4:0x3;let _0x43e362=0x0;_0x59fa11[_0x1ee486(0x2a2)]((_0x546500,_0x151208)=>{const _0x23b7f1=_0x1ee486;if(_0x151208%_0xdd9520==0x0)_0x55b89d=[];_0x55b89d['push'](Markup[_0x23b7f1(0x294)][_0x23b7f1(0x256)](_0x23b7f1(0x1db)+_0x546500[_0x23b7f1(0x20a)],_0x23b7f1(0x39d)+_0x546500[_0x23b7f1(0x20a)])),_0x151208%_0xdd9520==0x0&&(_0x5d6fee[_0x43e362]=_0x55b89d,_0x43e362++);});const _0xc73117=Markup[_0x1ee486(0x3dc)](_0x5d6fee);_0x4457d9[_0x1ee486(0x291)](_0x1ee486(0x30c),_0xc73117);}else{const _0xa5226f=_0x59fa11[0x0][_0x1ee486(0x20a)];if(pid[_0xa5226f])pid[_0xa5226f][_0x1ee486(0x352)]({'function':_0x1ee486(0x2c4),'args':null});}}}),tgBot[_0x26ba69(0x1e1)](/metrics_(.+)/,async _0x3d5cd6=>{const _0x477bcd=_0x26ba69,_0x1ec04f=_0x3d5cd6[_0x477bcd(0x3c2)][0x1];_0x3d5cd6[_0x477bcd(0x1da)]();if(pid[_0x1ec04f])pid[_0x1ec04f][_0x477bcd(0x352)]({'function':_0x477bcd(0x2c4),'args':null});}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x31b),async _0x412461=>{const _0x402214=_0x26ba69,_0x4e180b=getEnabledBots();if(_0x4e180b['length']==0x0)await sendTelegram(_0x412461[_0x402214(0x210)]['id'],_0x402214(0x3aa));else{if(_0x4e180b[_0x402214(0x1f7)]>0x1){let _0x2fab5f=[],_0x182ca2=[];const _0x2a7bbc=_0x4e180b[_0x402214(0x1f7)]%0x4==0x0||_0x4e180b[_0x402214(0x1f7)]%0x4==0x3||_0x4e180b['length']%0x3==0x1?0x4:0x3;let _0x3c43a7=0x0;_0x4e180b[_0x402214(0x2a2)]((_0x1e30b5,_0x1bda5e)=>{const _0x2ad8ee=_0x402214;if(_0x1bda5e%_0x2a7bbc==0x0)_0x182ca2=[];_0x182ca2[_0x2ad8ee(0x23f)](Markup['button'][_0x2ad8ee(0x256)]('Bot\x20'+_0x1e30b5[_0x2ad8ee(0x20a)],'portfolio_'+_0x1e30b5['botID'])),_0x1bda5e%_0x2a7bbc==0x0&&(_0x2fab5f[_0x3c43a7]=_0x182ca2,_0x3c43a7++);});const _0x6a822a=Markup[_0x402214(0x3dc)](_0x2fab5f);_0x412461[_0x402214(0x291)](_0x402214(0x276),_0x6a822a);}else{const _0x22c9df=_0x4e180b[0x0][_0x402214(0x20a)];if(pid[_0x22c9df])pid[_0x22c9df][_0x402214(0x352)]({'function':_0x402214(0x2bc),'args':null});}}}),tgBot[_0x26ba69(0x1e1)](/portfolio_(.+)/,async _0x3398af=>{const _0x126edd=_0x26ba69,_0x7bb52d=_0x3398af[_0x126edd(0x3c2)][0x1];_0x3398af[_0x126edd(0x1da)]();if(pid[_0x7bb52d])pid[_0x7bb52d][_0x126edd(0x352)]({'function':_0x126edd(0x2bc),'args':null});}),tgBot[_0x26ba69(0x2d0)]('update',async _0x1587ab=>{const _0x16236e=_0x26ba69;await getMessages();if(!updateAvailable)await sendTelegram(_0x1587ab['chat']['id'],_0x16236e(0x33b));else{if(!validInstallation)await sendTelegram(_0x1587ab[_0x16236e(0x210)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x3383c0=Markup['inlineKeyboard']([Markup[_0x16236e(0x294)][_0x16236e(0x256)]('Yes',_0x16236e(0x333)),Markup[_0x16236e(0x294)]['callback']('No',_0x16236e(0x246))]);_0x1587ab['reply'](_0x16236e(0x2c5),_0x3383c0);}}}),tgBot[_0x26ba69(0x1e1)](/update_(.+)/,async _0x280a2e=>{const _0x2eaa92=_0x26ba69,_0x31d4f9=_0x280a2e['match'][0x1];_0x280a2e[_0x2eaa92(0x1da)](),_0x31d4f9==_0x2eaa92(0x377)&&(await sendTelegram(_0x280a2e[_0x2eaa92(0x210)]['id'],_0x2eaa92(0x3e1)),updateBB('update')),_0x31d4f9=='no'&&await sendTelegram(_0x280a2e[_0x2eaa92(0x210)]['id'],_0x2eaa92(0x266));}),tgBot[_0x26ba69(0x2d0)](_0x26ba69(0x3c7),async _0x1eebd6=>{const _0x5ceb1b=_0x26ba69;if(!validInstallation)await sendTelegram(_0x1eebd6[_0x5ceb1b(0x210)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x46cfb4=Markup[_0x5ceb1b(0x3dc)]([Markup[_0x5ceb1b(0x294)][_0x5ceb1b(0x256)](_0x5ceb1b(0x1f6),_0x5ceb1b(0x272)),Markup['button']['callback']('No',_0x5ceb1b(0x36e))]);_0x1eebd6[_0x5ceb1b(0x291)](_0x5ceb1b(0x3ab),_0x46cfb4);}}),tgBot[_0x26ba69(0x1e1)](/reinstall_(.+)/,async _0x3ba5a2=>{const _0x444c5a=_0x26ba69,_0x4e9dd4=_0x3ba5a2[_0x444c5a(0x3c2)][0x1];_0x3ba5a2[_0x444c5a(0x1da)](),_0x4e9dd4=='yes'&&(await sendTelegram(_0x3ba5a2[_0x444c5a(0x210)]['id'],_0x444c5a(0x3a3)),updateBB(_0x444c5a(0x3c7))),_0x4e9dd4=='no'&&await sendTelegram(_0x3ba5a2[_0x444c5a(0x210)]['id'],_0x444c5a(0x3e4));}),tgBot['command'](_0x26ba69(0x203),async _0x45abed=>{const _0x1fc474=_0x26ba69,_0xa10ce4=getBotsWithMode();if(_0xa10ce4['length']==0x0)await sendTelegram(_0x45abed[_0x1fc474(0x210)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x18658b=[],_0x529fbf=[];const _0x2ee1b5=0x2;let _0x3a6f0e=0x0;_0xa10ce4[_0x1fc474(0x2a2)]((_0x3580a6,_0x3dfd59)=>{const _0x2dbe78=_0x1fc474;if(_0x3dfd59%_0x2ee1b5==0x0)_0x529fbf=[];_0x529fbf['push'](Markup['button'][_0x2dbe78(0x256)](_0x2dbe78(0x1db)+_0x3580a6[_0x2dbe78(0x20a)]+'\x20('+_0x3580a6[_0x2dbe78(0x268)]+')',_0x2dbe78(0x34a)+_0x3580a6['botID'])),_0x3dfd59%_0x2ee1b5==0x0&&(_0x18658b[_0x3a6f0e]=_0x529fbf,_0x3a6f0e++);});const _0x3ffd17=Markup[_0x1fc474(0x3dc)](_0x18658b);_0x45abed['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x3ffd17);}}),tgBot[_0x26ba69(0x1e1)](/toggle_(.+)/,async _0x4c6399=>{const _0x253a0b=_0x26ba69,_0xff477a=_0x4c6399['match'][0x1];_0x4c6399['editMessageReplyMarkup']();const _0x18d578=getBotsWithMode(),_0x20c75a=_0x18d578[_0x253a0b(0x22f)](_0x4f7e98=>_0x4f7e98['botID']==_0xff477a),_0x53f1f0=_0x20c75a['mode']==_0x253a0b(0x36c)?_0x253a0b(0x202):_0x253a0b(0x36c);await sendTelegram(_0x4c6399['chat']['id'],_0x253a0b(0x21f)+_0xff477a+'\x20to\x20'+_0x53f1f0+_0x253a0b(0x337)),toggleBotMode(_0xff477a);}),tgBot[_0x26ba69(0x2d0)]('names',async _0x5aa9d2=>{const _0x19c80b=_0x26ba69;let _0x4286da='';config[_0x19c80b(0x2a2)](_0x28623a=>{const _0x211e11=_0x19c80b;_0x4286da+='Bot\x20'+_0x28623a[_0x211e11(0x20a)]+':\x20'+_0x28623a[_0x211e11(0x3dd)]+'\x0a';}),await sendTelegram(_0x5aa9d2[_0x19c80b(0x210)]['id'],_0x4286da,{'parse_mode':_0x19c80b(0x1fa)});}),tgBot['command']('help',async _0x1872cc=>{const _0x4ed1f4=_0x26ba69;await sendTelegram(_0x1872cc[_0x4ed1f4(0x210)]['id'],_0x311c3c);}),process[_0x26ba69(0x344)](_0x26ba69(0x23e),()=>tgBot[_0x26ba69(0x31a)](_0x26ba69(0x23e))),process[_0x26ba69(0x344)](_0x26ba69(0x33d),()=>tgBot[_0x26ba69(0x31a)](_0x26ba69(0x33d))),tgBot[_0x26ba69(0x3b0)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0xccc808,_0x528da4,_0x1696a3){const _0x3dc025=_0x4155af;_0x1696a3={..._0x1696a3,'disable_web_page_preview':!![]};try{await tgBot[_0x3dc025(0x293)]['sendMessage'](_0xccc808,_0x528da4,_0x1696a3);}catch(_0x42f40b){console[_0x3dc025(0x301)](_0x3dc025(0x236),_0x42f40b);}}async function sendTelegramBot(_0x54a2e4,_0x463526){const _0x4e8152=_0x4155af;if(settings[_0x4e8152(0x3d2)]){if(settings[_0x4e8152(0x378)]==_0x4e8152(0x328)||(_0x463526[_0x4e8152(0x22e)]==_0x4e8152(0x31d)||_0x463526[_0x4e8152(0x22e)]==_0x4e8152(0x313)||_0x463526[_0x4e8152(0x22e)]==_0x4e8152(0x2f1))&&settings['telegramEvents']==_0x4e8152(0x2b2)||_0x463526[_0x4e8152(0x22e)]==_0x4e8152(0x3b5)&&settings['telegramEvents']==_0x4e8152(0x3df)){if(tgBot&&settings[_0x4e8152(0x285)]){if(_0x463526[_0x4e8152(0x3a0)])await sendTelegram(settings[_0x4e8152(0x285)],_0x463526[_0x4e8152(0x3dd)]+_0x4e8152(0x3a4)+_0x463526[_0x4e8152(0x3a8)]);else await sendTelegram(settings['telegramChatId'],_0x4e8152(0x1db)+_0x54a2e4+_0x4e8152(0x3a4)+_0x463526[_0x4e8152(0x3a8)]);}}}}async function sendTelegramMsg(_0x457a1d,_0x3f5501=_0x4155af(0x1fa)){const _0x19f209=_0x4155af;return settings[_0x19f209(0x3d2)]&&tgBot&&settings[_0x19f209(0x285)]?(await sendTelegram(settings['telegramChatId'],_0x457a1d,{'parse_mode':_0x3f5501}),!![]):![];}function getDeviceWithIp(_0x2e059f){const _0x5a4fc8=_0x4155af;return devices[_0x5a4fc8(0x22f)](_0x4f69b4=>_0x4f69b4['ip']===_0x2e059f);}async function temporaryAccess2FA(_0x3cbc8a,_0x47a38f){const _0x4d6150=_0x4155af;let _0x4d7f28=new Date(),_0x23a40e=![];if(lastIpApproval){if(_0x4d7f28-lastIpApproval<0x1388)_0x23a40e=!![];}lastIpApproval=new Date();if(_0x23a40e)return;if(tgBot&&settings[_0x4d6150(0x285)]){const _0x4f5c9e=uuidRandom();tmpStorage[_0x4f5c9e]={'uuid':_0x3cbc8a,'externalip':_0x47a38f};const _0x586cbb=Markup['inlineKeyboard']([Markup[_0x4d6150(0x294)][_0x4d6150(0x256)]('5\x20min','tempaccess_5_'+_0x4f5c9e),Markup['button'][_0x4d6150(0x256)](_0x4d6150(0x38e),_0x4d6150(0x208)+_0x4f5c9e),Markup['button'][_0x4d6150(0x256)]('30\x20min',_0x4d6150(0x27c)+_0x4f5c9e),Markup[_0x4d6150(0x294)][_0x4d6150(0x256)](_0x4d6150(0x31f),_0x4d6150(0x2d3)+_0x4f5c9e)]);await sendTelegram(settings[_0x4d6150(0x285)],_0x4d6150(0x3c4)+normalizeIP(_0x47a38f)[_0x4d6150(0x3e5)]+'\x20?',_0x586cbb),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x1f8d99=>{const _0x13e9b7=_0x4d6150,_0x64625f=_0x1f8d99[_0x13e9b7(0x3c2)][0x1],_0x1d77e2=_0x1f8d99['match'][0x2],{uuid:_0x41e302,externalip:_0x52d7aa}=tmpStorage[_0x1d77e2];delete tmpStorage[_0x1d77e2],_0x1f8d99[_0x13e9b7(0x1da)](),devices[_0x41e302][_0x13e9b7(0x1f8)]={'clientip':_0x52d7aa,'timestamp':new Date()[_0x13e9b7(0x374)](),'expiry':_0x64625f},_0x64625f!='reject'?(await sendTelegram(_0x1f8d99['chat']['id'],_0x13e9b7(0x2b7)+_0x64625f+'\x20minutes',{'parse_mode':_0x13e9b7(0x1fa)}),io['to'](_0x41e302)['emit'](_0x13e9b7(0x345),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x1f8d99['chat']['id'],_0x13e9b7(0x383)),io['to'](_0x41e302)[_0x13e9b7(0x322)](_0x13e9b7(0x345),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x32e80f,_0x400b4c){const _0x316bc8=_0x4155af;if(tgBot&&settings[_0x316bc8(0x285)]){const _0x2fa6a9=uuidRandom();tmpStorage[_0x2fa6a9]={'uuid':_0x32e80f,'externalip':_0x400b4c};const _0x5b45b3=Markup[_0x316bc8(0x3dc)]([Markup[_0x316bc8(0x294)]['callback'](_0x316bc8(0x375),_0x316bc8(0x1e7)+loginExpiry+'_'+_0x2fa6a9),Markup[_0x316bc8(0x294)][_0x316bc8(0x256)](_0x316bc8(0x31f),_0x316bc8(0x296)+_0x2fa6a9)]);await sendTelegram(settings['telegramChatId'],_0x316bc8(0x254)+normalizeIP(_0x400b4c)['show']+'\x20?',_0x5b45b3),tgBot[_0x316bc8(0x1e1)](/login2fa_(.+)_(.+)/,async _0x204707=>{const _0x1fbef7=_0x316bc8,_0x1a63ca=_0x204707['match'][0x1],_0x26bfc5=_0x204707[_0x1fbef7(0x3c2)][0x2],{uuid:_0x2820b0,externalip:_0x298e85}=tmpStorage[_0x26bfc5];delete tmpStorage[_0x26bfc5],_0x204707['editMessageReplyMarkup'](),devices[_0x2820b0][_0x1fbef7(0x314)]={'clientip':_0x298e85,'timestamp':new Date()['getTime'](),'expiry':_0x1a63ca},_0x1a63ca!=_0x1fbef7(0x31f)?(await sendTelegram(_0x204707[_0x1fbef7(0x210)]['id'],_0x1fbef7(0x2c7),{'parse_mode':_0x1fbef7(0x1fa)}),io['to'](_0x2820b0)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x204707[_0x1fbef7(0x210)]['id'],_0x1fbef7(0x3b1)),io['to'](_0x2820b0)[_0x1fbef7(0x322)]('status',{'access':{'allow':![],'reason':_0x1fbef7(0x338),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x500588=_0x4155af;return dbConfig[_0x500588(0x2b0)](_0x500588(0x26e))[_0x500588(0x2a7)]('botID')[_0x500588(0x1d6)]({'status':_0x500588(0x238)})[_0x500588(0x399)]()||[];}function getDisabledBots(){const _0x4e4e2b=_0x4155af;return dbConfig[_0x4e4e2b(0x2b0)](_0x4e4e2b(0x26e))[_0x4e4e2b(0x2a7)](_0x4e4e2b(0x20a))['filter']({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x2bc64e){const _0x50c1a3=_0x4155af;let _0x44f04c={};const _0x36dcd4=configpath+_0x50c1a3(0x2ce)+_0x2bc64e+_0x50c1a3(0x2a6),_0x325de3=fs[_0x50c1a3(0x3d7)](_0x36dcd4);if(_0x325de3){const _0x77d3bc=fs[_0x50c1a3(0x2ac)](_0x36dcd4);try{const _0x4a0793=JSON[_0x50c1a3(0x2ba)](_0x77d3bc),_0x2b2e8e=_0x4a0793?_0x4a0793[_0x50c1a3(0x29f)][0x0][_0x50c1a3(0x2f0)]:![];_0x44f04c['mode']=_0x2b2e8e?_0x50c1a3(0x36c):'manual',_0x44f04c[_0x50c1a3(0x3dd)]=_0x4a0793?_0x4a0793[_0x50c1a3(0x29f)][0x0][_0x50c1a3(0x3dd)]:_0x50c1a3(0x1db)+_0x2bc64e;}catch(_0x1820fe){_0x44f04c[_0x50c1a3(0x268)]='manual',_0x44f04c['botname']='Bot\x20'+_0x2bc64e;}}else _0x44f04c[_0x50c1a3(0x268)]=_0x50c1a3(0x202),_0x44f04c[_0x50c1a3(0x3dd)]=_0x50c1a3(0x1db)+_0x2bc64e;return _0x44f04c;}function _0x216a(){const _0x1fbaf1=['bb-config.json','generateKeyPairAsync','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','password','add','unlinkSync','secure','socket.io','zip/','type','find','live','Node.js\x20v',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','search','apply','login\x20token\x20generated','Telegram\x20error:','name','enabled','getFullYear','address','Token\x20blacklisted','production','join','SIGINT','push','running','internal','kill','full','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','update_no','conn','file','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','storeConfiguration','Failed\x20to\x20download\x20','startsWith','isDirectory','config','test','/download/:type','update-bb','blacklist','Notifications\x20disabled','Allow\x20login\x20from\x20IP\x20address\x20','env','callback','timeshift','messages','bb/','store-headless','writeFileSync','NTBA_FIX_319','keys','backup/','hex','bot.js','Error\x20removing\x20old\x20backup\x20files:','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','version.json','restore_no_','Restore\x20process\x20confirmed','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','f2aRequired','mode','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getPortfolio','(((.+)+)+)+$','reset-password','static','bots','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','jsonwebtoken','includes','reinstall_yes','telegrammsg','build','Idling\x20(','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','238101ySRdjI','token','************','close','express','tempaccess_30_','slice','replace','bbUsername','Unauthorized\x20attempt\x20to\x20delete\x20bot','axios','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','temporary\x20token\x20generated','telegramChatId','\x1b[34m','exit','restart_','backup-full@','format','bb-secure.json','#RES#','data','/start','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','temporary\x20access\x20timeout','reply','handshake','telegram','button','reset-history','login2fa_reject_','uuid-random','exp','CoinMarketCap\x20API\x20key\x20validated','Markdown','started','update','build2','connected','bot','login\x20token\x20valid','allow','forEach','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','config_all','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','-config.json','sortBy','deleteHistoryAlerts','resetpw_yes','rmSync','onepagemode','readFileSync','tkn','(staging)','get-logs','get','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','alerts','show-config','logout','initclient','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Access\x20enabled\x20for\x20','expiry','23150320UhlIYT','parse','/enable\x20-\x20enable\x20notifications\x0a','sendPortfolioTelegram','headers','Enabled\x20Bot\x20','storeFiat','bbvNew','backup-full.zip','get-portfolio','resetHistory','sendMetricsTelegram','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Logged\x20out\x20user\x20...','Login\x20accepted','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','showConfig','.zip','assign','from','650585xViveF','bot-','/names\x20-\x20show\x20bot\x20names\x0a','command','username','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','tempaccess_reject_','\x1b[36m','publicKey','logs','backup','835545yCVrcu','toString','text','then','logged\x20out',':\x20Bot\x20Mgr\x20>\x20','bbPassword','apiSecret','restore_yes_','add-bot','map','isValid','max','sockets','telegramToken','-results.json','/metrics\x20-\x20show\x20bot\x20performance\x0a','store-settings','api-eu.mixpanel.com','fork','delete-alerts','hasOwnProperty','-----------------------------------------------------------------------------------','private','headless','success','RSA-OAEP','Invalid\x20authentication\x20token\x20(1)','Unauthorized\x20attempt\x20to\x20download\x20','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','defaults','files','Restore\x20process\x20aborted','2FA\x20login\x20required','server','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','args','Bot\x20Mgr\x20>\x20','disconnect','log','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','lowdb/adapters/FileSync','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','store-fiat','marketcapApi','mkdirSync','number','output-002.log','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','\x20|\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Deleted\x20Bot\x20','graphql-request','resetpw_no','message','uuid','Setting\x20access:\x20','warning','telegram2FaApproval','notification','get-starting-balances','argv','getUTCHours','-performance.json','stop','portfolio','7hybfrq','error','remove','reject','Backup\x20file\x20unzipped\x20and\x20stored','catch','emit','toIPv4MappedAddress','secret','\x20only\x0a','path','string','all','cancel-loading','uncaughtException','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','\x20-\x20','access\x20timeout','whitelist','User\x20has\x20been\x20validated','reason','start','Restore\x20backup\x20file\x20','update_yes','https://api.ipify.org?format=json','metrics','Session\x20expired\x20for\x20user\x20...','\x20mode','2FA\x20login\x20rejected','/:bot/coins','entries','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Invalid\x20authentication\x20token\x20(2)','SIGTERM','backup-full','util','Restarting\x20Bot\x20','temp/','restore-backup-file','output-001.log','once','status','node-zip','pidRefreshToken','createWriteStream','get-messages','toggle_','randomBytes','*$1*','Invalid\x20username\x20or\x20IP\x20address','temporaryAccessAllowed','\x1b[35m','bbvReceive','loginRequired','send','confirm-message','updatebotmanager','constructor','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Invalid\x20IP\x20address','any',')\x20|\x20Bot\x20','getSeconds','/output-000.log','remoteAddress','config_alerts','index.html','whitelistEnabled','\x1b[0m','referer','sign','use','2351442hNCZfx','/off\x20-\x20stop\x20bot(s)\x0a','telegramUsername','Orders','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','staging','\x20(1)','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','auto','Alerts','reinstall_no','Logged\x20in\x20user\x20...','botmanager','stopped','Unauthorized\x20attempt\x20to\x20get\x20messages','alias','getTime','accept','\x1b[31m','yes','telegramEvents',')\x20\x20\x20|\x20Bot\x20','ipv6','/:bot/support','Unauthorized\x20attempt\x20to\x20delete\x20alerts','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20get\x20events','ETH','split','Notifications\x20enabled','::1','Temporary\x20access\x20rejected','login','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','2FA\x20login\x20token\x20generated','-events.json','http','#RES#\x20if\x20running\x20locally\x0a','exec','user','isIPv4MappedAddress','IPv4','15\x20min','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','getMonth','inherit','family','stringify','set','BCT','min','getMinutes','/:bot/configuration','value','\x20|\x20user:\x20...','getHours','new','metrics_','function','0.0.0','showname','settings.','logs/','Starting\x20Balance\x20Bot\x20reinstallation','\x20>\x20','decrypt','config/','node','event','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','No\x20bots\x20running\x20right\x20now','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','userid','config_orders','127.0.0.1','new-disabled','launch','Login\x20rejected','invalid\x20credentials','ipaddr.js','getDate','order','output-000.log','toIPv4Address','Disabled\x20Bot\x20','1000','connection','privateKey','/:bot','off_','File\x20uploaded','readdirSync','timestamp','statSync','match','settings','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Notifications\x20types:\x20','Notifications\x20enabled\x0a','reinstall','kind','telegraf','/disable\x20-\x20disable\x20notifications\x0a','output-003.log','randomFillSync','host','store','clientip','6b67f3d61ee94b8f5c80b4affef4c4d9','Restoring\x20bot(s)\x20from\x20backup','telegramEnabled','simple','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','debug','latestversion','existsSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','version','Unauthorized\x20attempt\x20to\x20show\x20configuration','\x20(2)','inlineKeyboard','botname','8gbjqMF','orders','Starting\x20new\x20bot\x20|\x20Bot\x20','Starting\x20Balance\x20Bot\x20update','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','child_process','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','show','[ip-address]','Error\x20while\x20deleting\x20config\x20files:\x20','filter','All\x20bots','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','access','editMessageReplyMarkup','Bot\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','copyFileSync','Unauthorized\x20attempt\x20to\x20update\x20bot','mtime','2jIGBOJ','action','disabled','compareSync','disable','emitHistory','Error:\x20Invalid\x20argument\x20','login2fa_','Ok,\x20will\x20send\x20order\x20notifications\x20only','pidExpireLogin',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','hashSync','Password\x20has\x20been\x20reset\x20to:\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','on_','Server','Backup\x20file\x20uploaded','ipc','port','environment','lastmsgtelegram','|@|','Yes','length','telegramIpApproval','Unauthorized\x20attempt\x20to\x20update\x20settings','HTML','4103991JMgmhJ','Notifications\x20disabled\x0a','Starting\x20(','restart','write','All','get-backup-files','manual','toggle','bb-settings.json','sendFile','auth','padStart','tempaccess_15_','binary','botID','login\x20required','2FA','All\x20bots\x20running\x20right\x20now','3000','3246368GuRzsy','chat','clients','lastmsgemitted','reload','backup-files','getStartingBalances','Unauthorized\x20login\x20attempt\x20(timeout)','address\x20already\x20in\x20use','sort','***','status\x20code\x20401','placeOrder','#RES#\x20','enable','apiPassword','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20log\x20out','DEFLATE','track','#RES#\x20if\x20running\x20on\x20server','login\x20not\x20required'];_0x216a=function(){return _0x1fbaf1;};return _0x216a();}function getBotsWithMode(){const _0x458d62=_0x4155af,_0x164379=dbConfig['get']('bots')[_0x458d62(0x2a7)](_0x458d62(0x20a))[_0x458d62(0x399)]()||[];return _0x164379[_0x458d62(0x2a2)](_0x19946e=>{const _0x4c23d6=_0x458d62;let _0x2aea05=getBotAttributes(_0x19946e[_0x4c23d6(0x20a)]);_0x19946e[_0x4c23d6(0x268)]=_0x2aea05[_0x4c23d6(0x268)];}),_0x164379;}function getBotExchanges(){const _0xf895d3=_0x4155af;let _0x5cc390=[];const _0x241f34=dbConfig[_0xf895d3(0x2b0)](_0xf895d3(0x26e))[_0xf895d3(0x2a7)](_0xf895d3(0x20a))[_0xf895d3(0x399)]()||[];_0x241f34['forEach'](_0x1affb3=>{const _0x30d689=_0xf895d3;if(_0x1affb3[_0x30d689(0x345)]=='enabled'){const _0x51c354=configpath+_0x30d689(0x2ce)+_0x1affb3[_0x30d689(0x20a)]+_0x30d689(0x2a6),_0x5638e5=fs[_0x30d689(0x3d7)](_0x51c354);let _0x606586;if(_0x5638e5){const _0x2b08c2=fs['readFileSync'](_0x51c354);try{const _0x23b1a5=JSON[_0x30d689(0x2ba)](_0x2b08c2);_0x606586=_0x23b1a5?_0x23b1a5[_0x30d689(0x29f)][0x0]['exchange']:null;}catch(_0xa29243){}}if(_0x606586)_0x5cc390[_0x30d689(0x23f)](_0x606586);}});const _0x4c063e=[...new Set(_0x5cc390)][_0xf895d3(0x218)]();return _0x4c063e;}async function initUser(){const _0x415a7c=_0x4155af;if(!settings['userid']){const _0x4bd378=uuidRandom();mixpanel[_0x415a7c(0x373)](_0x4bd378),updateSetting(_0x415a7c(0x3ac),_0x4bd378);}}async function initSecure(){const _0x99fea5=_0x4155af;let _0xcd7d7c=getSecure();if(!_0xcd7d7c['hasOwnProperty'](_0x99fea5(0x324))){let _0x21e107=await generateKeys();_0xcd7d7c[_0x99fea5(0x2d5)]=_0x21e107[_0x99fea5(0x2d5)],_0xcd7d7c[_0x99fea5(0x3bb)]=_0x21e107[_0x99fea5(0x3bb)],_0xcd7d7c['secret']=crypto[_0x99fea5(0x34b)](0x20)[_0x99fea5(0x2d9)](_0x99fea5(0x25f));;storeSecure(_0xcd7d7c);}}function getSettings(){const _0x4fdb92=_0x4155af;return dbSettings[_0x4fdb92(0x2b0)](_0x4fdb92(0x3c3))[_0x4fdb92(0x399)]()||{};}function getSecure(){const _0x18c8ec=_0x4155af;return dbSecure[_0x18c8ec(0x2b0)]('secure')[_0x18c8ec(0x399)]()||{};}function getBlacklist(){const _0xb8a345=_0x4155af;return dbSecure[_0xb8a345(0x2b0)]('blacklist')[_0xb8a345(0x399)]()||[];}function broadcastToBots(_0x2cde5e,_0x537893){config['forEach'](_0x167eec=>{const _0x4c3345=_0x5dfa;if(_0x167eec['status']==_0x4c3345(0x238)&&_0x167eec['live']=='running'||_0x167eec[_0x4c3345(0x345)]==_0x4c3345(0x39c)&&_0x167eec[_0x4c3345(0x230)]==_0x4c3345(0x240)){if(pid[_0x167eec['botID']])pid[_0x167eec[_0x4c3345(0x20a)]][_0x4c3345(0x352)]({[_0x2cde5e]:_0x537893});}});}async function storeSettings(_0x215174,_0x177635=![]){const _0x3f36e9=_0x4155af;_0x215174={...settings,..._0x215174};if(_0x177635&&_0x215174['bbPassword']!=_0x3f36e9(0x279)&&_0x215174[_0x3f36e9(0x2de)]!='***'&&_0x215174[_0x3f36e9(0x2de)]!=''){const _0x597645=crypt['decrypt'](secure[_0x3f36e9(0x3bb)],_0x215174['bbPassword'])[_0x3f36e9(0x310)][_0x3f36e9(0x380)]('|@|')[0x0],_0x2aeb0b=bcrypt['hashSync'](_0x597645,saltRounds);_0x215174={..._0x215174,'bbPassword':_0x2aeb0b};}if(_0x177635&&_0x215174['telegramToken']!=_0x3f36e9(0x279)&&_0x215174['telegramToken']!=_0x3f36e9(0x219)&&_0x215174[_0x3f36e9(0x2e6)]!=''){const _0x4c65d6=crypt[_0x3f36e9(0x3a5)](secure[_0x3f36e9(0x3bb)],_0x215174['telegramToken'])['message'][_0x3f36e9(0x380)](_0x3f36e9(0x1f5))[0x0];_0x215174={..._0x215174,'telegramToken':_0x4c65d6};}if(_0x177635&&_0x215174[_0x3f36e9(0x306)]!=_0x3f36e9(0x279)&&_0x215174[_0x3f36e9(0x306)]!=_0x3f36e9(0x219)&&_0x215174['marketcapApi']!=''){const _0x3d3691=crypt[_0x3f36e9(0x3a5)](secure['privateKey'],_0x215174[_0x3f36e9(0x306)])[_0x3f36e9(0x310)][_0x3f36e9(0x380)](_0x3f36e9(0x1f5))[0x0];_0x215174={..._0x215174,'marketcapApi':_0x3d3691};}const _0x194ff7=_0x215174[_0x3f36e9(0x2e6)]!='************'&&_0x215174[_0x3f36e9(0x2e6)]!=settings[_0x3f36e9(0x2e6)]||_0x215174[_0x3f36e9(0x366)]!=settings['telegramUsername'],_0x4ba22e=_0x215174[_0x3f36e9(0x2e6)]==''||_0x215174[_0x3f36e9(0x366)]=='',_0x52522b=_0x215174['marketcapApi']&&_0x215174[_0x3f36e9(0x306)]!=_0x3f36e9(0x279)&&_0x215174['marketcapApi']!=settings[_0x3f36e9(0x2e6)];_0x194ff7&&(_0x215174[_0x3f36e9(0x285)]=null,_0x215174[_0x3f36e9(0x378)]=_0x3f36e9(0x328));for(const [_0x733ec8,_0x2ac4e2]of Object[_0x3f36e9(0x33a)](_0x215174)){if(_0x733ec8==_0x3f36e9(0x2e6)&&_0x2ac4e2=='************'){_0x215174[_0x3f36e9(0x2e6)]=settings[_0x3f36e9(0x2e6)];continue;};if(_0x733ec8==_0x3f36e9(0x2de)&&_0x2ac4e2==_0x3f36e9(0x279)){_0x215174[_0x3f36e9(0x2de)]=settings['bbPassword'];continue;};if(_0x733ec8==_0x3f36e9(0x306)&&_0x2ac4e2==_0x3f36e9(0x279)){_0x215174['marketcapApi']=settings['marketcapApi'];continue;};dbSettings[_0x3f36e9(0x394)](_0x3f36e9(0x3a1)+_0x733ec8,_0x2ac4e2)['write']();}settings=_0x215174,io['to'](_0x3f36e9(0x370))['emit']('settings',cleanSettings()),broadcastToBots(_0x3f36e9(0x257),settings[_0x3f36e9(0x257)]),broadcastToBots(_0x3f36e9(0x2ab),settings['onepagemode']),broadcastToBots(_0x3f36e9(0x306),settings[_0x3f36e9(0x306)]);if(_0x194ff7&&!_0x4ba22e)initTelegram();if(_0x194ff7&&_0x4ba22e)disableTelegram();getAllClients()[_0x3f36e9(0x2a2)](_0x3b6f4f=>{const _0x3a2d45=_0x3f36e9;getSocket(_0x3b6f4f['id'])[_0x3a2d45(0x322)](_0x3a2d45(0x345),{'access':{'allow':![],'reason':_0x3a2d45(0x213),'token':null}});}),_0x52522b&&(await sleep(0xbb8),testMarketcapApi(_0x215174[_0x3f36e9(0x306)]));}async function testMarketcapApi(_0x58425b){const _0x403307=_0x4155af,_0x806c64=[_0x403307(0x395),_0x403307(0x37f)];try{await axios['get']('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x58425b},'params':{'symbol':_0x806c64[_0x403307(0x2d9)]()}});}catch(_0x4e98fc){_0x4e98fc['toString']()['includes'](_0x403307(0x21a))?(io['to'](_0x403307(0x370))[_0x403307(0x322)]('notification',_0x403307(0x3e2)),logger['full'](_0x403307(0x3e2))):(io['to'](_0x403307(0x370))['emit'](_0x403307(0x315),_0x403307(0x262)),logger[_0x403307(0x243)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x403307(0x3d5)]('Error\x20details:',_0x4e98fc[_0x403307(0x2d9)]()+_0x403307(0x32c)+_0x4e98fc['code']));return;}logger[_0x403307(0x3d5)](_0x403307(0x299));}function updateSetting(_0x363ba3,_0x54e44e){const _0x2f86b0=_0x4155af;dbSettings['set']('settings.'+_0x363ba3,_0x54e44e)[_0x2f86b0(0x1ff)](),settings=getSettings(),io['to'](_0x2f86b0(0x370))[_0x2f86b0(0x322)](_0x2f86b0(0x3c3),cleanSettings());}function storeSecure(_0x31c1ee){const _0x334f5a=_0x4155af;dbSecure[_0x334f5a(0x2b0)](_0x334f5a(0x22b))[_0x334f5a(0x23f)](_0x31c1ee)[_0x334f5a(0x1ff)](),secure=_0x31c1ee;}function addBlacklist(_0x28a574){const _0x3ab7c5=_0x4155af;cleanBlacklist();let _0x2f65a3;devices[_0x28a574][_0x3ab7c5(0x1f8)]?_0x2f65a3=Math[_0x3ab7c5(0x2e4)](devices[_0x28a574]['telegramIpApproval'][_0x3ab7c5(0x2b8)],loginExpiry):_0x2f65a3=loginExpiry,dbSecure[_0x3ab7c5(0x2b0)](_0x3ab7c5(0x252))[_0x3ab7c5(0x23f)]({'expiry':new Date()[_0x3ab7c5(0x374)]()+_0x2f65a3*0x3c*0x3e8,'token':devices[_0x28a574][_0x3ab7c5(0x1d9)][_0x3ab7c5(0x278)]})[_0x3ab7c5(0x1ff)](),blacklist=dbSecure[_0x3ab7c5(0x2b0)]('blacklist')[_0x3ab7c5(0x399)]();}function cleanBlacklist(){const _0x1ca7af=_0x4155af;let _0x38a200=dbSecure['get'](_0x1ca7af(0x252))['cloneDeep']()[_0x1ca7af(0x399)](),_0x2a7c3b=new Date()[_0x1ca7af(0x374)]();_0x38a200[_0x1ca7af(0x2a2)](_0x5d930a=>{const _0x2e211=_0x1ca7af;_0x5d930a['expiry']<_0x2a7c3b&&dbSecure['get']('blacklist')[_0x2e211(0x31e)]({'expiry':_0x5d930a['expiry']})[_0x2e211(0x1ff)]();});}function initStates(){const _0x435cb7=_0x4155af;let _0x585dfc=getConfiguration();_0x585dfc[_0x435cb7(0x2a2)](_0x216f20=>{const _0x499572=_0x435cb7;_0x216f20[_0x499572(0x230)]=_0x499572(0x371);}),storeConfiguration(_0x585dfc);}function onKeys(){const _0x58de32=new RSA();return new Promise(_0x53c770=>{const _0x13f0c1=_0x5dfa;_0x58de32[_0x13f0c1(0x226)]()[_0x13f0c1(0x2db)](_0x27f73d=>{_0x53c770(_0x27f73d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5062a1=_0x4155af;let _0x5259a5=getSettings(),_0x5d8999=![];!_0x5259a5['hasOwnProperty'](_0x5062a1(0x1f4))&&(_0x5259a5['lastmsgtelegram']=0x0,_0x5d8999=!![]);!_0x5259a5[_0x5062a1(0x2ed)](_0x5062a1(0x212))&&(_0x5259a5[_0x5062a1(0x212)]=0x0,_0x5d8999=!![]);!_0x5259a5[_0x5062a1(0x2ed)](_0x5062a1(0x3d6))&&(_0x5259a5[_0x5062a1(0x3d6)]=_0x5062a1(0x39f),_0x5d8999=!![]);!_0x5259a5['hasOwnProperty']('onepagemode')&&(_0x5259a5[_0x5062a1(0x2ab)]=![],_0x5d8999=!![]);!_0x5259a5['hasOwnProperty'](_0x5062a1(0x306))&&(_0x5259a5['marketcapApi']='',_0x5d8999=!![]);if(_0x5d8999)storeSettings(_0x5259a5);try{fs[_0x5062a1(0x3bf)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x1eed2a=>{const _0x18c70c=_0x5062a1;if(!_0x1eed2a[_0x18c70c(0x24d)]()){if(!_0x1eed2a[_0x18c70c(0x237)][_0x18c70c(0x24c)](_0x18c70c(0x289)))fs['unlinkSync'](configbackuppath+_0x1eed2a['name']);}else fs[_0x18c70c(0x2aa)](configbackuppath+_0x1eed2a[_0x18c70c(0x237)],{'recursive':!![]});});}catch(_0x50abb8){logger[_0x5062a1(0x3d5)](_0x5062a1(0x261),_0x50abb8);}}function storeConfiguration(_0x15787a){const _0x104b9d=_0x4155af;dbConfig[_0x104b9d(0x2b0)](_0x104b9d(0x26e))[_0x104b9d(0x31e)]()[_0x104b9d(0x1ff)](),dbConfig['get'](_0x104b9d(0x26e))[_0x104b9d(0x23f)](..._0x15787a)[_0x104b9d(0x1ff)](),config=_0x15787a;}async function resetPassword(){const _0xb16746=_0x4155af;if(tgBot&&settings[_0xb16746(0x285)]){const _0x2c7440=Markup[_0xb16746(0x3dc)]([Markup[_0xb16746(0x294)][_0xb16746(0x256)](_0xb16746(0x377),_0xb16746(0x2a9)),Markup[_0xb16746(0x294)][_0xb16746(0x256)]('no',_0xb16746(0x30f))]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x2c7440),tgBot[_0xb16746(0x1e1)](/resetpw_(.+)/,async _0x3f3c60=>{const _0x69a46c=_0xb16746,_0x1cc0d0=_0x3f3c60[_0x69a46c(0x3c2)][0x1];_0x3f3c60['editMessageReplyMarkup']();if(_0x1cc0d0!='no'){const _0x420b7b=0xf,_0x4ddb0f=_0x69a46c(0x283),_0x2c6655=Array[_0x69a46c(0x2cc)](crypto[_0x69a46c(0x3cc)](new Uint32Array(_0x420b7b)))[_0x69a46c(0x2e2)](_0x30bd07=>_0x4ddb0f[_0x30bd07%_0x4ddb0f['length']])[_0x69a46c(0x23d)](''),_0x4054c6=bcrypt[_0x69a46c(0x1eb)](_0x2c6655,saltRounds);storeSettings({'bbPassword':_0x4054c6}),await sendTelegram(_0x3f3c60['chat']['id'],_0x69a46c(0x1ec)+_0x2c6655,{'parse_mode':'HTML'});}else await sendTelegram(_0x3f3c60[_0x69a46c(0x210)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x577b47,_0x1adc30){const _0x14b110=_0x4155af;io['to']('botmanager')[_0x14b110(0x322)](_0x14b110(0x315),_0x14b110(0x2f7),'success');if(tgBot&&settings[_0x14b110(0x285)]){const _0x458335=uuidRandom();tmpStorage[_0x458335]={'path':_0x577b47,'filename':_0x1adc30};const _0x2206ac=Markup[_0x14b110(0x3dc)]([Markup[_0x14b110(0x294)][_0x14b110(0x256)](_0x14b110(0x377),_0x14b110(0x2e0)+_0x458335),Markup[_0x14b110(0x294)]['callback']('no',_0x14b110(0x264)+_0x458335)]);await sendTelegram(settings[_0x14b110(0x285)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x2206ac),tgBot[_0x14b110(0x1e1)](/restore_(.+)_(.+)/,async _0x4ed816=>{const _0x368373=_0x14b110,_0x534ecb=_0x4ed816[_0x368373(0x3c2)][0x1],_0x598b45=_0x4ed816['match'][0x2],{path:_0x1edbcd,filename:_0x3b7837}=tmpStorage[_0x598b45];delete tmpStorage[_0x598b45],_0x4ed816['editMessageReplyMarkup'](),_0x534ecb==_0x368373(0x377)?(logger['debug'](_0x368373(0x265)),await sendTelegram(_0x4ed816[_0x368373(0x210)]['id'],_0x368373(0x3d1),{'parse_mode':'HTML'}),unzipFile(_0x1edbcd,_0x3b7837)):(logger[_0x368373(0x3d5)](_0x368373(0x2fa)),await sendTelegram(_0x4ed816[_0x368373(0x210)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x503d4c=_0x4155af,_0x4db342=new Date();return _0x4db342[_0x503d4c(0x239)]()+'/'+(_0x4db342[_0x503d4c(0x390)]()+0x1)['toString']()[_0x503d4c(0x207)](0x2,'0')+'/'+_0x4db342[_0x503d4c(0x3b4)]()[_0x503d4c(0x2d9)]()['padStart'](0x2,'0')+'\x20'+_0x4db342[_0x503d4c(0x39b)]()['toString']()['padStart'](0x2,'0')+':'+_0x4db342[_0x503d4c(0x397)]()['toString']()[_0x503d4c(0x207)](0x2,'0')+':'+_0x4db342['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1ce020=_0x4155af,_0x432ea4=shiftedTime();return _0x432ea4['getFullYear']()+'/'+(_0x432ea4[_0x1ce020(0x390)]()+0x1)[_0x1ce020(0x2d9)]()[_0x1ce020(0x207)](0x2,'0')+'/'+_0x432ea4['getDate']()[_0x1ce020(0x2d9)]()['padStart'](0x2,'0')+'\x20'+_0x432ea4[_0x1ce020(0x39b)]()[_0x1ce020(0x2d9)]()[_0x1ce020(0x207)](0x2,'0')+':'+_0x432ea4[_0x1ce020(0x397)]()['toString']()[_0x1ce020(0x207)](0x2,'0')+':'+_0x432ea4[_0x1ce020(0x35a)]()[_0x1ce020(0x2d9)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x4c16b0=_0x4155af,_0x2b4c4a=shiftedTime();return _0x2b4c4a[_0x4c16b0(0x239)]()+(_0x2b4c4a[_0x4c16b0(0x390)]()+0x1)[_0x4c16b0(0x2d9)]()[_0x4c16b0(0x207)](0x2,'0')+_0x2b4c4a[_0x4c16b0(0x3b4)]()[_0x4c16b0(0x2d9)]()[_0x4c16b0(0x207)](0x2,'0')+'-'+_0x2b4c4a['getHours']()['toString']()['padStart'](0x2,'0')+_0x2b4c4a[_0x4c16b0(0x397)]()[_0x4c16b0(0x2d9)]()['padStart'](0x2,'0')+_0x2b4c4a['getSeconds']()[_0x4c16b0(0x2d9)]()[_0x4c16b0(0x207)](0x2,'0');}function shiftedTime(){const _0x5bebab=_0x4155af,_0x374702=new Date();let _0x166b33=_0x374702;if(settings[_0x5bebab(0x257)]&&settings[_0x5bebab(0x257)]!==0x0)_0x166b33=fns[_0x5bebab(0x229)](_0x374702,{'hours':settings[_0x5bebab(0x257)]});return _0x166b33;}async function startScheduler(){const _0x52b9a1=_0x4155af,_0x230738=new Date()[_0x52b9a1(0x318)](),_0x924b46=shiftedTime()[_0x52b9a1(0x39b)]();_0x924b46==0x4&&backupConfigFiles(),_0x924b46==0x0&&rotateLogFiles(),_0x230738%0x6==0x0&&triggerAnalytics(),_0x230738%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x53ec52){const _0x19ae84=_0x4155af;logger['debug'](_0x19ae84(0x332)+_0x53ec52);const _0x5a29a6=getBotsWithMode();_0x5a29a6['length']>0x0?confirmRestore(configbackuppath,_0x53ec52):unzipFile(configbackuppath,_0x53ec52);}async function getBackupFiles(_0x3287c6=null){const _0x152e04=_0x4155af;let _0x503610=[],_0x4bb35c=fs[_0x152e04(0x3bf)](configbackuppath,{'withFileTypes':!![]});_0x4bb35c[_0x152e04(0x218)]((_0x5e2fa5,_0x5ea5c9)=>_0x5e2fa5['name']<_0x5ea5c9['name']?0x1:_0x5ea5c9['name']<_0x5e2fa5[_0x152e04(0x237)]?-0x1:0x0),_0x4bb35c[_0x152e04(0x2a2)](_0x222208=>{const _0x275c91=_0x152e04;if(!_0x222208[_0x275c91(0x24d)]()&&_0x222208[_0x275c91(0x237)][_0x275c91(0x24c)](_0x275c91(0x289))&&_0x222208['name']['endsWith']('.zip')){const _0x59ef68=formatDate(fs[_0x275c91(0x3c1)](configbackuppath+_0x222208[_0x275c91(0x237)])[_0x275c91(0x1df)]);_0x503610[_0x275c91(0x23f)]({'name':_0x222208[_0x275c91(0x237)],'mtime':_0x59ef68});}});if(_0x3287c6)io['to'](_0x3287c6)[_0x152e04(0x322)](_0x152e04(0x214),_0x503610);else return _0x503610;}async function backupConfigFiles(){const _0x47a432=_0x4155af;await zipFiles('backup-full');const _0x21bdec=getCleanTimeStamp();fs[_0x47a432(0x1dd)](zippath+_0x47a432(0x2c1),configbackuppath+(_0x47a432(0x289)+_0x21bdec+'.zip'));let _0x3a36fe=fs[_0x47a432(0x3bf)](configbackuppath,{'withFileTypes':!![]});_0x3a36fe['sort']((_0x3100f7,_0x3a5c59)=>_0x3100f7[_0x47a432(0x237)]<_0x3a5c59['name']?0x1:_0x3a5c59[_0x47a432(0x237)]<_0x3100f7[_0x47a432(0x237)]?-0x1:0x0),_0x3a36fe[_0x47a432(0x1f7)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x3a36fe[_0x3a36fe['length']-0x1][_0x47a432(0x237)]);}function rotateLogFiles(){const _0x15c9ce=_0x4155af,_0x321f86=fs['statSync'](logspath+_0x15c9ce(0x3b6)),_0x100e3e=_0x321f86['size']/0x400;if(_0x100e3e>0x64){let _0x1119f6=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x1119f6[_0x15c9ce(0x218)]((_0x4d362b,_0x56441e)=>_0x4d362b[_0x15c9ce(0x237)]<_0x56441e['name']?0x1:_0x56441e['name']<_0x4d362b[_0x15c9ce(0x237)]?-0x1:0x0),_0x1119f6[_0x15c9ce(0x2a2)](_0x558c2f=>{const _0x19b5cc=_0x15c9ce;if(_0x558c2f[_0x19b5cc(0x237)]=='output-002.log')fs['copyFileSync'](logspath+_0x558c2f[_0x19b5cc(0x237)],logspath+_0x19b5cc(0x3cb));if(_0x558c2f[_0x19b5cc(0x237)]=='output-001.log')fs[_0x19b5cc(0x1dd)](logspath+_0x558c2f['name'],logspath+_0x19b5cc(0x309));_0x558c2f[_0x19b5cc(0x237)]==_0x19b5cc(0x3b6)&&(fs[_0x19b5cc(0x1dd)](logspath+_0x558c2f[_0x19b5cc(0x237)],logspath+_0x19b5cc(0x343)),fs['writeFileSync'](logspath+_0x558c2f[_0x19b5cc(0x237)],''));});}}async function zipFiles(_0x235627){const _0x1daa29=_0x4155af;let _0x319baf;if(_0x235627==_0x1daa29(0x2d6))_0x319baf=logspath;if(_0x235627=='backup')_0x319baf=configpath;if(_0x235627==_0x1daa29(0x33e))_0x319baf=configpath;let _0x5dd33f=fs[_0x1daa29(0x3bf)](_0x319baf,{'withFileTypes':!![]});const _0x455ab9=new require(_0x1daa29(0x346))();_0x5dd33f[_0x1daa29(0x2a2)](_0x4ff0a6=>{const _0x19148a=_0x1daa29;if(!_0x4ff0a6[_0x19148a(0x24d)]()){let _0x4dc4dc=fs['readFileSync'](_0x319baf+_0x4ff0a6['name']);if(_0x235627=='backup'){const _0x599975=/^bot-[0-9]{3}-config.json$/,_0x10fd56=_0x599975[_0x19148a(0x24f)](_0x4ff0a6[_0x19148a(0x237)]);if(_0x10fd56){const _0x35542a=JSON[_0x19148a(0x2ba)](_0x4dc4dc);if(_0x35542a[_0x19148a(0x29f)][0x0]){_0x35542a[_0x19148a(0x29f)][0x0]['apiKey']=_0x19148a(0x219),_0x35542a[_0x19148a(0x29f)][0x0][_0x19148a(0x2df)]=_0x19148a(0x219);if(_0x35542a[_0x19148a(0x29f)][0x0][_0x19148a(0x21e)])_0x35542a['bot'][0x0]['apiPassword']='***';}_0x4dc4dc=JSON[_0x19148a(0x393)](_0x35542a,null,0x2);}if(_0x4ff0a6[_0x19148a(0x237)]==_0x19148a(0x204)){const _0x34930e=JSON[_0x19148a(0x2ba)](_0x4dc4dc);if(_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x351)])_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x351)]=![];if(_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x2de)])_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x2de)]='***';if(_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x2e6)])_0x34930e['settings']['telegramToken']='***';if(_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x285)])_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x285)]=null;if(_0x34930e[_0x19148a(0x3c3)][_0x19148a(0x306)])_0x34930e['settings'][_0x19148a(0x306)]=_0x19148a(0x219);_0x4dc4dc=JSON[_0x19148a(0x393)](_0x34930e,null,0x2);}if(_0x4ff0a6[_0x19148a(0x237)]!='bb-secure.json')_0x455ab9['file'](_0x4ff0a6['name'],_0x4dc4dc);}else _0x455ab9[_0x19148a(0x248)](_0x4ff0a6[_0x19148a(0x237)],_0x4dc4dc);}});const _0x974710=_0x455ab9['generate']({'base64':![],'compression':_0x1daa29(0x221)});fs[_0x1daa29(0x25b)](zippath+(_0x235627+'.zip'),_0x974710,_0x1daa29(0x209));}async function unzipFile(_0x2bf871,_0x2c8ec2){const _0x291e4c=_0x4155af;fs[_0x291e4c(0x3bf)](configpath,{'withFileTypes':!![]})['forEach'](_0x489c66=>{const _0x14b6a4=_0x291e4c;if(!_0x489c66[_0x14b6a4(0x24d)]())fs[_0x14b6a4(0x2aa)](configpath+_0x489c66[_0x14b6a4(0x237)]);});const _0x1c46fa=fs[_0x291e4c(0x2ac)](_0x2bf871+_0x2c8ec2,'binary'),_0xb881c2=new require(_0x291e4c(0x346))(_0x1c46fa,{'base64':![],'checkCRC32':!![]});Object[_0x291e4c(0x25d)](_0xb881c2[_0x291e4c(0x2f9)])[_0x291e4c(0x2a2)](_0x355d22=>{const _0x3b286b=_0x291e4c,_0x34e36a=_0xb881c2[_0x3b286b(0x2f9)][_0x355d22];fs[_0x3b286b(0x25b)](configpath+_0x34e36a[_0x3b286b(0x237)],_0x34e36a['_data']);}),fs[_0x291e4c(0x3bf)](temppath,{'withFileTypes':!![]})['forEach'](_0x1dfdd9=>{const _0x32cf3a=_0x291e4c;if(!_0x1dfdd9[_0x32cf3a(0x24d)]())fs[_0x32cf3a(0x2aa)](temppath+_0x1dfdd9[_0x32cf3a(0x237)]);}),logger['debug'](_0x291e4c(0x320)),process['send']({'restore':!![]},_0x4214ad=>{});}async function getPublicIp(){const _0x1c8c6a=_0x4155af;try{const _0x523fe6=await axios['get'](_0x1c8c6a(0x334));publicip=_0x523fe6[_0x1c8c6a(0x28d)]['ip'];}catch(_0x531795){}}async function triggerAnalytics(){const _0x4b1d66=_0x4155af;if(!publicip)await getPublicIp();const _0x100274=getBotsWithMode();let _0x2cbca5=0x0;_0x100274[_0x4b1d66(0x2a2)](_0x2ad7bd=>{const _0x4d7bd2=_0x4b1d66;if(_0x2ad7bd[_0x4d7bd2(0x345)]==='enabled')_0x2cbca5++;});const _0xf99e3=getBotExchanges();mixpanel[_0x4b1d66(0x222)](_0x4b1d66(0x1ef),{'distinct_id':settings[_0x4b1d66(0x3ac)],'ip':publicip,'version':serverversion,'numbots':_0x100274[_0x4b1d66(0x1f7)],'numbotsenabled':_0x2cbca5,'exchanges':_0xf99e3,'environment':environment});}async function getMessages(){const _0x3c96f8=_0x4155af,_0x5233a6=_0x3c96f8(0x2b1),_0x18624c=new GraphQLClient(_0x5233a6),_0x19174b={'authorization':_0x3c96f8(0x304)},_0x13a005=serverversion[_0x3c96f8(0x380)]('.'),_0x48acc3=_0x13a005[0x0]+'.'+_0x13a005[0x1],_0x380eca=Math[_0x3c96f8(0x396)](settings[_0x3c96f8(0x1f4)],settings[_0x3c96f8(0x212)]),_0x4d5035={'last':parseInt(_0x380eca),'bbm':_0x48acc3},_0x19b55b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x72e1f3;try{_0x72e1f3=await _0x18624c['request'](_0x19b55b,_0x4d5035,_0x19174b);}catch(_0x368ae3){}if(_0x72e1f3&&_0x72e1f3[_0x3c96f8(0x258)]){let _0x1fb3f0=settings[_0x3c96f8(0x1f4)];newMessages=[];for(const _0xbd4742 of _0x72e1f3['messages']){newMessages[_0x3c96f8(0x23f)](_0xbd4742);let _0x4b4cd3=![];_0xbd4742[_0x3c96f8(0x2c0)]&&(updateSetting(_0x3c96f8(0x3d6),_0xbd4742['bbvNew']),_0x4b4cd3=isNewerVersion(serverversion,_0xbd4742['bbvNew'])||serverversion==_0xbd4742[_0x3c96f8(0x2c0)]);if(!_0x4b4cd3&&_0xbd4742['number']>_0x1fb3f0){if(_0xbd4742[_0x3c96f8(0x350)]===_0x3c96f8(0x358)||serverversion[_0x3c96f8(0x24c)](_0xbd4742[_0x3c96f8(0x350)])){let _0x6bfadc=''+_0xbd4742['title']+'\x0a\x0a'+_0xbd4742[_0x3c96f8(0x310)];const _0x311067=await sendTelegramMsg(toTelegramMarkdown(_0x6bfadc),_0x3c96f8(0x29a));if(_0x311067)_0x1fb3f0=_0xbd4742[_0x3c96f8(0x308)];}}}updateAvailable=isNewerVersion(settings[_0x3c96f8(0x3d6)],serverversion),updateSetting(_0x3c96f8(0x1f4),_0x1fb3f0),emitMessages();}}function emitMessages(){const _0x5286cc=_0x4155af,_0x45494d=settings[_0x5286cc(0x212)];let _0x2b9b82=[];newMessages[_0x5286cc(0x2a2)](_0x36965d=>{const _0x2bb24c=_0x5286cc;_0x36965d[_0x2bb24c(0x308)]>_0x45494d&&_0x2b9b82['push'](_0x36965d);}),_0x2b9b82[_0x5286cc(0x1f7)]>0x0&&getAllClients()[_0x5286cc(0x2a2)](_0x2c52a1=>{const _0x391a39=_0x5286cc;getSocket(_0x2c52a1['id'])['emit'](_0x391a39(0x310),_0x2b9b82);});}function confirmMessage(_0x57cf82){const _0x23ec60=_0x4155af;updateSetting(_0x23ec60(0x212),Number(_0x57cf82));}function isNewerVersion(_0x133742,_0x4d39fa){const _0x14a50b=_0x4155af,_0x374d3e=_0x4d39fa['split']('.'),_0x2919d7=_0x133742[_0x14a50b(0x380)]('.');for(var _0x31b9fc=0x0;_0x31b9fc<_0x2919d7[_0x14a50b(0x1f7)];_0x31b9fc++){const _0x46f03d=~~_0x2919d7[_0x31b9fc],_0xcdb11c=~~_0x374d3e[_0x31b9fc];if(_0x46f03d>_0xcdb11c)return!![];if(_0x46f03d<_0xcdb11c)return![];}return![];}function toTelegramMarkdown(_0xd678a5){const _0x4f0794=_0x4155af,_0x418b76=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2089d6=/\*{2}(.+?)\*{2}/gim;return _0xd678a5=_0xd678a5[_0x4f0794(0x27e)](_0x418b76,'$1_$2_$3')[_0x4f0794(0x27e)](_0x2089d6,_0x4f0794(0x34c)),_0xd678a5;}async function validateConfigFile(){const _0x1e8a62=_0x4155af,_0x21bb29=dbConfig[_0x1e8a62(0x2b0)](_0x1e8a62(0x26e))[_0x1e8a62(0x2a7)](_0x1e8a62(0x20a))[_0x1e8a62(0x399)]()||[];if(_0x21bb29[_0x1e8a62(0x1f7)]==0x0){let _0x46eca8=0x0,_0x48deef=[];const _0x10fb98=/^bot-([0-9]{3})-config.json$/,_0x3447b3=fs[_0x1e8a62(0x3bf)](configpath);_0x3447b3['forEach'](_0x31ba8f=>{const _0x413637=_0x1e8a62,_0x375caa=_0x10fb98[_0x413637(0x38a)](_0x31ba8f);if(_0x375caa){const _0x2a5736=_0x375caa[0x1];let _0x457ae4=getBotAttributes(_0x2a5736);_0x48deef['push']({'botID':_0x2a5736,'botname':_0x457ae4['botname'],'status':_0x413637(0x1e2),'live':'stopped'}),_0x46eca8++;}}),_0x46eca8!=0x0&&(dbConfig[_0x1e8a62(0x2b0)](_0x1e8a62(0x26e))['assign'](_0x48deef)[_0x1e8a62(0x1ff)](),config=_0x48deef,restoredConfigFile=_0x46eca8);}}async function restoreConfigNotify(_0x170311){const _0x161c81=_0x4155af;let _0x3423b3;if(restoredConfigFile==0x1)_0x3423b3=_0x161c81(0x269);else _0x3423b3=_0x161c81(0x38f);if(_0x170311)io['to']('botmanager')[_0x161c81(0x322)](_0x161c81(0x315),_0x3423b3);else{logger[_0x161c81(0x3d3)](_0x161c81(0x2ee)),logger[_0x161c81(0x3d3)](_0x3423b3),logger[_0x161c81(0x3d3)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x161c81(0x285)]&&settings[_0x161c81(0x378)]!=_0x161c81(0x3df))await sendTelegram(settings[_0x161c81(0x285)],_0x161c81(0x2ff)+_0x3423b3);}}function validateCredentials(_0x1e521c,_0x48c69b){const _0x77ec4c=_0x4155af;if(_0x1e521c[_0x77ec4c(0x2d1)]==settings[_0x77ec4c(0x27f)]&&bcrypt[_0x77ec4c(0x1e3)](_0x1e521c[_0x77ec4c(0x228)],settings[_0x77ec4c(0x2de)])){if(settings[_0x77ec4c(0x267)])return{'allow':![],'reason':_0x77ec4c(0x2fb),'token':null};else{const _0x25bd87=generateLoginToken(_0x48c69b);return{'allow':!![],'reason':_0x77ec4c(0x235),'token':_0x25bd87};}}else return{'allow':![],'reason':_0x77ec4c(0x3b2),'token':null};}function refreshToken(_0x554c88){const _0x1d2a01=generateLoginToken(_0x554c88);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1d2a01};}function validateAccess(_0x2fca23,_0x64ef6d,_0x561006){const _0x46cda4=_0x4155af,_0x543798=_0x561006?_0x561006:devices[_0x64ef6d]['ip'];let _0x4475b1;const _0x4ff751=_0x35e56b=>{const _0x3ac70b=_0x5dfa;if(settings[_0x3ac70b(0x351)]){if(settings[_0x3ac70b(0x267)]){if(telegram2FaApproved(_0x64ef6d)){const _0x2f9e81=generateLoginToken(_0x64ef6d);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x2f9e81};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x4475b1=validToken(_0x35e56b,_0x64ef6d),_0x4475b1[_0x3ac70b(0x2ed)](_0x3ac70b(0x2f1))?{'allow':!![],'reason':_0x3ac70b(0x2a0),'token':_0x35e56b}:{'allow':![],'reason':_0x3ac70b(0x20b),'token':null};}else return{'allow':!![],'reason':_0x3ac70b(0x224),'token':null};};if(settings[_0x46cda4(0x35f)]){let _0x5bf28a=[...settings[_0x46cda4(0x32e)],_0x46cda4(0x382),'::ffff:127.0.0.1',_0x46cda4(0x3ae)];if(_0x5bf28a['includes'](_0x543798))return _0x4ff751(_0x2fca23);else{_0x4475b1=validToken(_0x2fca23,_0x64ef6d);if(_0x4475b1[_0x46cda4(0x2ed)](_0x46cda4(0x2f1)))return _0x4ff751(_0x2fca23);else{if(telegramIpApproved(_0x64ef6d)){const _0x10bbe3=generateToken(_0x64ef6d);return _0x4475b1=_0x4ff751(_0x2fca23),_0x4475b1[_0x46cda4(0x2a1)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x10bbe3}:_0x4475b1;}else return settings[_0x46cda4(0x34e)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4ff751(_0x2fca23);}function timelyDecrypt(_0x99a6ea,_0x2d495,_0x17bdd6='@'){const _0x48239d=_0x4155af;if(_0x99a6ea)try{const _0x3a7065=crypt[_0x48239d(0x3a5)](secure[_0x48239d(0x3bb)],_0x99a6ea)[_0x48239d(0x310)],_0x550052=_0x3a7065[_0x48239d(0x380)](_0x17bdd6)[0x0],_0x2dc6db=_0x3a7065['split'](_0x17bdd6)[0x1],_0x3d16e1=new Date()[_0x48239d(0x374)]();if(_0x2d495){if(_0x3d16e1-_0x2dc6db<maxSecretAge*0x3e8)return _0x550052;else return![];}else return _0x550052;}catch(_0x330d31){return![];}else return![];}const validToken=(_0x37dedc,_0x2b3d4b)=>{const _0x34336d=_0x4155af,_0x459ee7=devices[_0x2b3d4b]['ip'];if(!_0x37dedc)return{'error':'No\x20authentication\x20token'};for(let _0xcc5cb2 of blacklist){if(_0xcc5cb2['token']==_0x37dedc)return{'error':_0x34336d(0x23b)};}let _0x17ad19;try{_0x17ad19=jwt['verify'](_0x37dedc,secure['secret']+_0x2b3d4b);}catch{return{'error':_0x34336d(0x2f3)};}if(!_0x17ad19['hasOwnProperty']('clientip')&&!_0x17ad19[_0x34336d(0x2ed)](_0x34336d(0x2d1))||!_0x17ad19[_0x34336d(0x2ed)](_0x34336d(0x298)))return{'error':_0x34336d(0x33c)};if(!_0x17ad19[_0x34336d(0x2ed)]('username')&&_0x17ad19[_0x34336d(0x2ed)]('clientip')){const {clientip:_0x513c46}=_0x17ad19;return _0x459ee7==_0x513c46?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x34336d(0x357)};}else{if(_0x17ad19['hasOwnProperty'](_0x34336d(0x2d1))&&_0x17ad19['hasOwnProperty']('clientip')){const {username:_0x354dc0,clientip:_0x119b41}=_0x17ad19;return settings[_0x34336d(0x27f)]==_0x354dc0&&_0x459ee7==_0x119b41?{'success':_0x34336d(0x32f)}:{'error':_0x34336d(0x34d)};}}},generateLoginToken=_0x51f3ce=>{const _0x231b37=_0x4155af;if(_0x51f3ce){const _0xf16fb5=devices[_0x51f3ce]['ip'];return jwt[_0x231b37(0x362)]({'username':settings['bbUsername'],'clientip':_0xf16fb5},secure[_0x231b37(0x324)]+_0x51f3ce,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x51c13f=>{const _0xf45445=_0x4155af;if(_0x51c13f){const _0x54529a=devices[_0x51c13f]['ip'];return jwt[_0xf45445(0x362)]({'clientip':_0x54529a},secure['secret']+_0x51c13f,{'expiresIn':devices[_0x51c13f][_0xf45445(0x1f8)][_0xf45445(0x2b8)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x109b65=>{const _0x419c26=_0x4155af;let _0x18e967=![];return devices[_0x109b65]['telegramIpApproval']&&devices[_0x109b65]['telegramIpApproval']['expiry']!=_0x419c26(0x31f)&&(_0x18e967=devices[_0x109b65]['telegramIpApproval']['clientip']==devices[_0x109b65]['ip']&&new Date()['getTime']()-devices[_0x109b65][_0x419c26(0x1f8)][_0x419c26(0x3c0)]<devices[_0x109b65]['telegramIpApproval'][_0x419c26(0x2b8)]*0x3c*0x3e8),_0x18e967;},telegram2FaApproved=_0x3d42cb=>{const _0xd15d66=_0x4155af;let _0x2b7aeb=![];return devices[_0x3d42cb]['telegram2FaApproval']&&devices[_0x3d42cb]['telegram2FaApproval'][_0xd15d66(0x2b8)]!=_0xd15d66(0x31f)&&(_0x2b7aeb=devices[_0x3d42cb][_0xd15d66(0x314)][_0xd15d66(0x3cf)]==devices[_0x3d42cb]['ip']&&new Date()[_0xd15d66(0x374)]()-devices[_0x3d42cb][_0xd15d66(0x314)]['timestamp']<devices[_0x3d42cb]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x2b7aeb;},normalizeIP=_0x56fed6=>{const _0x8ad55c=_0x4155af;let _0x1503f3=null,_0x5dad0e=null;if(ipaddr[_0x8ad55c(0x2e3)](_0x56fed6)){const _0x5c97a6=ipaddr[_0x8ad55c(0x2ba)](_0x56fed6);_0x5c97a6[_0x8ad55c(0x3c8)]()===_0x8ad55c(0x37a)?(_0x5c97a6[_0x8ad55c(0x38c)]()&&(_0x1503f3=_0x5c97a6[_0x8ad55c(0x3b7)]()[_0x8ad55c(0x2d9)]()),_0x5dad0e=_0x5c97a6[_0x8ad55c(0x2d9)]()):(_0x1503f3=_0x5c97a6[_0x8ad55c(0x2d9)](),_0x5dad0e=_0x5c97a6[_0x8ad55c(0x323)]()[_0x8ad55c(0x2d9)]());}return{'show':_0x1503f3?_0x1503f3:_0x5dad0e,'store':_0x5dad0e};};function formatDate(_0x2d4989){const _0x3a3269=_0x4155af;return _0x2d4989['getFullYear']()+'/'+(_0x2d4989[_0x3a3269(0x390)]()+0x1)[_0x3a3269(0x2d9)]()[_0x3a3269(0x207)](0x2,'0')+'/'+_0x2d4989[_0x3a3269(0x3b4)]()[_0x3a3269(0x2d9)]()[_0x3a3269(0x207)](0x2,'0')+'\x20'+_0x2d4989[_0x3a3269(0x39b)]()[_0x3a3269(0x2d9)]()[_0x3a3269(0x207)](0x2,'0')+':'+_0x2d4989[_0x3a3269(0x397)]()[_0x3a3269(0x2d9)]()[_0x3a3269(0x207)](0x2,'0')+':'+_0x2d4989['getSeconds']()['toString']()[_0x3a3269(0x207)](0x2,'0');}function sleep(_0x42b286){return new Promise(_0x5bbf64=>setTimeout(_0x5bbf64,_0x42b286));}