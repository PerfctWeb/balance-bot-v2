const _0x2f2667=_0x1a51;(function(_0x24bf77,_0x3125f2){const _0x25bca0=_0x1a51,_0x347302=_0x24bf77();while(!![]){try{const _0x247655=-parseInt(_0x25bca0(0x337))/0x1*(-parseInt(_0x25bca0(0x20b))/0x2)+parseInt(_0x25bca0(0x2b5))/0x3+-parseInt(_0x25bca0(0x2b7))/0x4+-parseInt(_0x25bca0(0x219))/0x5*(-parseInt(_0x25bca0(0x197))/0x6)+parseInt(_0x25bca0(0x214))/0x7+-parseInt(_0x25bca0(0x278))/0x8*(-parseInt(_0x25bca0(0x31b))/0x9)+parseInt(_0x25bca0(0x2b3))/0xa*(-parseInt(_0x25bca0(0x198))/0xb);if(_0x247655===_0x3125f2)break;else _0x347302['push'](_0x347302['shift']());}catch(_0x1f27e0){_0x347302['push'](_0x347302['shift']());}}}(_0xf4ef,0x54e99));const _0x25b0aa=function(){let _0x162335=!![];return function(_0x3d3452,_0x351223){const _0x12519e=_0x162335?function(){const _0x2fbc0a=_0x1a51;if(_0x351223){const _0x4794a2=_0x351223[_0x2fbc0a(0x2ff)](_0x3d3452,arguments);return _0x351223=null,_0x4794a2;}}:function(){};return _0x162335=![],_0x12519e;};}(),_0x2f0a18=_0x25b0aa(this,function(){const _0xdb5c3=_0x1a51;return _0x2f0a18[_0xdb5c3(0x23e)]()[_0xdb5c3(0x230)]('(((.+)+)+)+$')[_0xdb5c3(0x23e)]()[_0xdb5c3(0x26a)](_0x2f0a18)[_0xdb5c3(0x230)](_0xdb5c3(0x1a7));});_0x2f0a18();'use strict';process['env']['NTBA_FIX_319']=0x1;function _0xf4ef(){const _0x33632e=['Unauthorized\x20attempt\x20to\x20update\x20bot','759008VRamfk','randomFillSync','restore-backup-file','version','send','unlinkSync','Restore\x20process\x20aborted','.zip','bb/','write','login\x20token\x20generated','ipc','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','yes','HTML','telegramChatId','</b>\x20?','logout','RSA','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','f2aRequired','telegramIpApproval','Your\x20installation\x20is\x20already\x20up\x20to\x20date','token','toggle-bot-mode','publicKey','0.0.0','status','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','getSeconds','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','/:bot/history','confirm-message','(staging)','username','emit','yargs/yargs','No\x20bots\x20running\x20right\x20now','init','host','Session\x20expired\x20for\x20user\x20...','Logged\x20in\x20user\x20...','value','Ok,\x20will\x20send\x20order\x20notifications\x20only','uuid','pidRefreshToken','logs','************','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','headers','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','filter','_data','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','onText','join','debug','error','util','90dpBBBm','initclient','821415NvFOaj','http','2483244fekkrQ','Starting\x20bot\x20|\x20Bot\x20','catch','https://api.ipify.org?format=json','isValid','/status\x20-\x20show\x20bot(s)\x20status\x0a','sendMetricsTelegram','accept','\x20(2)','Allow\x20login\x20from\x20IP\x20address\x20<b>','static','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','alerts','pidExpireLogin','/upload-backup','apiSecret','Restoring\x20bot(s)\x20from\x20backup','exit','connected','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20login\x20attempt\x20(timeout)','2FA\x20login\x20required','3000','started','<b>Telegram\x20Bot\x20Status:</b>\x0a','latestversion','encryptedUuid','date-fns','blacklist','number','startsWith','Enabled\x20Bot\x20','access','settings','length','existsSync','getMinutes','Unauthorized\x20attempt\x20to\x20delete\x20alerts','onepagemode','forEach','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','function','match','bcryptjs','\x20(1)','socket.io','node','port','Bot\x20Mgr\x20>\x20','bbvNew','data','bb-settings.json','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','backup-full.zip','127.0.0.1','user','parse','use','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','bb-secure.json','Unauthorized\x20attempt\x20to\x20get\x20events','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','generateKeyPairAsync','Invalid\x20username\x20or\x20IP\x20address','lastmsgemitted','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','\x1b[35m','access\x20timeout','Token\x20blacklisted','resetHistory','min','getDate','apply','::ffff:127.0.0.1','jsonwebtoken','-performance.json','sockets','/:bot','updatebotmanager','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','socket','Temporary\x20access\x20rejected','from','\x20|\x20user:\x20...','All\x20bots\x20running\x20right\x20now','bots','exec','Node.js\x20v','success','Notifications\x20disabled\x0a','disabled','userid','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','binary','getHours','6b67f3d61ee94b8f5c80b4affef4c4d9','sort','readFileSync','getStartingBalances','sha256','9zWTOow','Notifications\x20disabled','file','store-fiat','readdirSync','running','remove','-----------------------------------------------------------------------------------','push','sendPortfolioTelegram','You\x20can\x20use\x20the\x20following\x20commands:\x0a','inherit','fork','store','zip/','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/download/:type','loginRequired','polling_error','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Restarting\x20Bot\x20','backup-full@','removeListener','Password\x20reset\x20rejected','chat','apiPassword','find','67zntrzn','config/','\x1b[36m','#RES#\x20if\x20running\x20locally\x0a','logs/','get','sortBy','uuid-random','all','new-disabled','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','graphql-request','type','string','mode','\x1b[34m','Unauthorized\x20attempt\x20to\x20confirm\x20message','Network\x20Interfaces:','split','reload','removeAllListeners','replace','::1','IPv4','30\x20min','environment','get-portfolio','/names\x20-\x20show\x20bot\x20names\x0a','deleteHistoryAlerts','title','telegrammsg','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','test','stringify','connection','Error\x20while\x20deleting\x20config\x20files:\x20','RSA-OAEP','Invalid\x20IP\x20address','once','All\x20bots','Restore\x20backup\x20file\x20','exchange','5\x20min','Error\x20removing\x20old\x20backup\x20files:','*$1*','secure','sendMessage','hasOwnProperty','telegramEnabled','1000','timestamp','Notifications\x20types:\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','index.html','build2','backup','Yes','toIPv4Address','reinstall',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','User\x20has\x20been\x20validated','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','\x20to\x20','Disabled\x20Bot\x20','notification','output-002.log','login\x20not\x20required','SIGTERM','express-fileupload','showname','lowdb','2447574VtdhjL','286528uvajgj','api-eu.mixpanel.com','timeshift','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','full','botID','Setting\x20access:\x20','Starting\x20Balance\x20Bot\x20reinstallation',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','SIGINT','apiKey','getPortfolio','backup-full','enabled','(((.+)+)+)+$','whitelist','temporary\x20access\x20timeout','referer','set','Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','\x20mode','[ip-address]','stop','name','logged\x20out','isDirectory','stopPolling','simple','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Invalid\x20authentication\x20token\x20(2)','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','request','settings.','login\x20required','***','Unauthorized\x20attempt\x20to\x20log\x20out','node-zip','sign','bbUsername','placeOrder','orders','$1_$2_$3','callback_query','remoteAddress','assign','Logged\x20out\x20user\x20...','new','\x20|\x20','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','reset-history','hybrid-crypto-js','delete-bot','telegram2FaApproval','writeFileSync','message','answerCallbackQuery','backupfile','storeConfiguration','endsWith','verify','/:bot/configuration','log','express','cancelLoading','keys','secret','temporary\x20token\x20generated','place-order','axios','Server','/metrics\x20-\x20show\x20bot\x20performance\x0a','delete-alerts','padStart','\x20>\x20','bbPassword','Starting\x20#RED#Balance\x20Bot\x20v','post','\x1b[31m','child_process','expiry','404\x20Not\x20Found','Unauthorized\x20attempt\x20to\x20get\x20messages','/output-000.log','/:bot/support','max','Login\x20rejected','Starting\x20Balance\x20Bot\x20update','listen','/update\x20-\x20update\x20Balance\x20Bot\x0a','headless','getTime','version.json','login\x20token\x20valid','manual','whitelistEnabled','\x1b[33m','format','range','getFullYear','Ok,\x20will\x20send\x20alert\x20notifications\x20only','entries','compareSync','ipv6','invalid\x20credentials','tkn','get-logs','size','build','order','allow','DEFLATE','messages','5914lUbMJv','args','Markdown','slice','-results.json','Access\x20enabled\x20for\x20','telegram','Notifications\x20enabled\x0a','#RES#\x20','1598205cWtzVs','update','then','bbvReceive','disconnect','5oSyQTW','password','output-003.log','Invalid\x20Telegram\x20token','mkdirSync','defaults','=>\x20Go\x20to\x20#CYA#http://','show','storeHeadless','botmanager','store-headless','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','createServer','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','get-messages','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','clientip','showConfig','hashSync','copyFileSync','login','handshake','exp','search','Unauthorized\x20attempt\x20to\x20delete\x20bot','auto','storeFiat','botname','reset-password','files','add-bot','Unauthorized\x20attempt\x20to\x20download\x20','update-bb','temp/','Notifications\x20enabled','telegramEvents','includes','toString','ipaddr.js','internal','reject','uncaughtException','-events.json','lastmsgtelegram','cancel-loading','/off\x20-\x20stop\x20bot(s)\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','any','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','Starting\x20new\x20bot\x20|\x20Bot\x20','argv','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','reason','-config.json','address',':\x20Bot\x20Mgr\x20>\x20','bot','output-000.log','live','track','add','Unauthorized\x20attempt\x20to\x20store\x20configuration','lowdb/adapters/FileSync','privateKey','conn','versions','bot.js','telegramUsername','decrypt','node-telegram-bot-api','#RES#\x20if\x20running\x20on\x20server',',\x20must\x20be\x20a\x204\x20digit\x20number','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','telegramToken','2FA','kill','bot-','stopped','\x20only\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','constructor','sendFile','mixpanel','2FA\x20login\x20token\x20generated','rmSync','getMonth','2FA\x20login\x20rejected','/disable\x20-\x20disable\x20notifications\x0a','staging','/:bot/coins','map','2FA\x20required','crypto'];_0xf4ef=function(){return _0x33632e;};return _0xf4ef();}const childProcess=require(_0x2f2667(0x1e9)),fs=require('fs'),fns=require(_0x2f2667(0x2d2)),low=require(_0x2f2667(0x196)),FileSync=require(_0x2f2667(0x258)),path=require('path'),crypto=require(_0x2f2667(0x276)),Crypt=require(_0x2f2667(0x1cd))['Crypt'],RSA=require(_0x2f2667(0x1cd))[_0x2f2667(0x28a)],bcrypt=require(_0x2f2667(0x2e2)),jwt=require(_0x2f2667(0x301)),ipaddr=require(_0x2f2667(0x23f)),argv=require(_0x2f2667(0x29c))(process['argv'][_0x2f2667(0x20e)](0x2))[_0x2f2667(0x24c)],uuidRandom=require(_0x2f2667(0x157)),TelegramBot=require(_0x2f2667(0x25f)),Mixpanel=require(_0x2f2667(0x26c)),axios=require(_0x2f2667(0x1df)),{GraphQLClient,gql}=require(_0x2f2667(0x15b)),util=require(_0x2f2667(0x2b2)),fileUpload=require(_0x2f2667(0x194)),{networkInterfaces}=require('os'),PORT=argv[_0x2f2667(0x2e6)]||_0x2f2667(0x2cd),pattern=/^[0-9]{2,4}$/;!pattern[_0x2f2667(0x170)](PORT)&&(console[_0x2f2667(0x1d8)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x2f2667(0x261)),process['exit'](0x1));const HOST=argv[_0x2f2667(0x29f)]||null,userID=argv[_0x2f2667(0x2ee)]||'',debugging=argv['d']||![],nodeversion=process[_0x2f2667(0x25b)][_0x2f2667(0x2e5)];let bbpath=_0x2f2667(0x280),bbpath2='';const botfile=_0x2f2667(0x25c),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+'version.json')[_0x2f2667(0x169)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x2f2667(0x2da)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x2f2667(0x338),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x2f2667(0x33b)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x2f2667(0x329)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+_0x2f2667(0x1ed),{'flags':'a'}),temppath=userID?bbpath+_0x2f2667(0x23a)+userID+'/':bbpath+_0x2f2667(0x23a);!fs[_0x2f2667(0x2da)](configpath)&&fs[_0x2f2667(0x21d)](configpath);!fs[_0x2f2667(0x2da)](configbackuppath)&&fs[_0x2f2667(0x21d)](configbackuppath);!fs[_0x2f2667(0x2da)](logspath)&&fs[_0x2f2667(0x21d)](logspath);!fs[_0x2f2667(0x2da)](zippath)&&fs[_0x2f2667(0x21d)](zippath);!fs['existsSync'](temppath)&&fs[_0x2f2667(0x21d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2f2667(0x21e)]({'bots':[]})[_0x2f2667(0x281)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2f2667(0x21e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2f2667(0x292),'onepagemode':![]}})[_0x2f2667(0x281)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2f2667(0x21e)]({'secure':{},'blacklist':[]})[_0x2f2667(0x281)]();let crypt=new Crypt({'md':_0x2f2667(0x31a),'rsaStandard':_0x2f2667(0x174)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2f2667(0x29e)](_0x2f2667(0x316),{'host':_0x2f2667(0x199)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2f2667(0x263)]&&settings[_0x2f2667(0x263)]!=''&&settings[_0x2f2667(0x25d)]&&settings[_0x2f2667(0x25d)]!='')initTelegram();const parseColor=(_0x497fc4,_0x49cb15)=>{const _0x254459=_0x2f2667,_0x785504=/#[A-Z]{3}#/g;if(typeof _0x497fc4==_0x254459(0x15d)){!_0x49cb15?_0x497fc4=_0x497fc4[_0x254459(0x165)](_0x785504,''):(_0x497fc4=_0x497fc4[_0x254459(0x165)](/#BLU#/g,_0x254459(0x15f)),_0x497fc4=_0x497fc4['replace'](/#RED#/g,_0x254459(0x1e8)),_0x497fc4=_0x497fc4[_0x254459(0x165)](/#YEL#/g,_0x254459(0x1fa)),_0x497fc4=_0x497fc4['replace'](/#MAG#/g,_0x254459(0x2f9)),_0x497fc4=_0x497fc4[_0x254459(0x165)](/#CYA#/g,_0x254459(0x339)),_0x497fc4=_0x497fc4[_0x254459(0x165)](/#RES#/g,'\x1b[0m'));;}return _0x497fc4;},logger={'screen':_0x4d85b4=>{const _0x3efab0=_0x2f2667;console[_0x3efab0(0x1d8)](parseColor(_0x4d85b4,!![]));},'simple':_0x4588c2=>{const _0x20f2ed=_0x2f2667;console[_0x20f2ed(0x1d8)](parseColor(_0x4588c2,!![])),loggerfile['write'](util['format'](parseColor(_0x4588c2,![]))+'\x0a');},'full':async _0x465f10=>{const _0x6816da=_0x2f2667,_0x1908c0=getTimeStamp()+_0x6816da(0x251)+_0x465f10;console['log'](parseColor(_0x1908c0,!![])),loggerfile[_0x6816da(0x281)](util[_0x6816da(0x1fb)](parseColor(_0x1908c0,![]))+'\x0a');if(tgBot&&settings[_0x6816da(0x287)]&&settings[_0x6816da(0x23c)]!=_0x6816da(0x1c3))await tgBot['sendMessage'](settings[_0x6816da(0x287)],_0x6816da(0x2e7)+parseColor(_0x465f10,![]))[_0x6816da(0x2b9)](_0x42f853=>{telegramError(_0x42f853);});},'debug':async(_0x4e8a62,_0x30a9d5='')=>{const _0x1548d0=_0x2f2667,_0x16c813=getTimeStamp()+_0x1548d0(0x1a1)+_0x4e8a62;if(debugging)console[_0x1548d0(0x1d8)](parseColor(_0x16c813,!![]));loggerfile[_0x1548d0(0x281)](util[_0x1548d0(0x1fb)](parseColor(_0x16c813,![]))+'\x0a');if(_0x30a9d5){if(debugging)console[_0x1548d0(0x1d8)](_0x30a9d5);loggerfile[_0x1548d0(0x281)](util[_0x1548d0(0x1fb)](_0x30a9d5)+'\x0a');}}};process['on'](_0x2f2667(0x242),function(_0xd22d19){const _0x1f12d5=_0x2f2667;logger[_0x1f12d5(0x1b6)](_0xd22d19);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2f2667(0x1f6))[_0x2f2667(0x27b)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2f2667(0x1d9)),app=express(),http=require(_0x2f2667(0x2b6))[_0x2f2667(0x225)](app);app[_0x2f2667(0x2f0)](fileUpload({'useTempFiles':!![]})),app['get'](_0x2f2667(0x32c),async(_0x44835e,_0x31623c)=>{const _0x16b610=_0x2f2667,_0x3e78cd=_0x44835e['params'][_0x16b610(0x15c)],_0x4e2349=getClientsWithBotID(_0x16b610(0x222)),_0x2afb46=_0x44835e[_0x16b610(0x2a9)][_0x16b610(0x2a4)],_0x28d4b1=timelyDecrypt(_0x2afb46,![]),_0x2a5a53=_0x4e2349[_0x16b610(0x336)](_0xb23f2=>_0xb23f2[_0x16b610(0x2a4)]==_0x28d4b1);if(_0x2a5a53){const _0x16c831=normalizeIP(_0x44835e[_0x16b610(0x307)]['remoteAddress'])[_0x16b610(0x328)],_0x174b16=_0x44835e[_0x16b610(0x2a9)][_0x16b610(0x203)];if(validateAccess(_0x174b16,_0x28d4b1,_0x16c831)[_0x16b610(0x208)])_0x3e78cd==_0x16b610(0x187)&&await backupConfigFiles(),await zipFiles(_0x3e78cd),_0x31623c['download'](zippath+(_0x3e78cd+_0x16b610(0x27f)),_0x3885f4=>{const _0x2c9c3a=_0x16b610;_0x3885f4&&(logger[_0x2c9c3a(0x19d)]('Failed\x20to\x20download\x20'+_0x3e78cd),logger[_0x2c9c3a(0x1b6)](_0x3885f4));});else logger[_0x16b610(0x19d)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x3e78cd+_0x16b610(0x2e3));}else logger[_0x16b610(0x19d)](_0x16b610(0x238)+_0x3e78cd+_0x16b610(0x2bf));}),app[_0x2f2667(0x1e7)](_0x2f2667(0x2c5),async(_0x389c1e,_0x5256e4)=>{const _0x549353=_0x2f2667,_0x21c146=getClientsWithBotID(_0x549353(0x222)),_0x282c46=_0x389c1e[_0x549353(0x2a9)][_0x549353(0x2a4)],_0xe267a4=timelyDecrypt(_0x282c46,![]),_0x1eec6d=_0x21c146['find'](_0x3d491e=>_0x3d491e['uuid']==_0xe267a4);logger[_0x549353(0x2b0)]('Backup\x20file\x20uploaded');if(_0x1eec6d){const _0x195b62=normalizeIP(_0x389c1e[_0x549353(0x307)][_0x549353(0x1c6)])[_0x549353(0x328)],_0x4700f2=_0x389c1e['headers'][_0x549353(0x203)];if(validateAccess(_0x4700f2,_0xe267a4,_0x195b62)[_0x549353(0x208)]){if(_0x389c1e[_0x549353(0x236)]){const _0x3b6a5c=_0x389c1e[_0x549353(0x236)][_0x549353(0x1d3)];await _0x3b6a5c['mv'](temppath+_0x3b6a5c[_0x549353(0x1b2)]),_0x5256e4[_0x549353(0x27c)]({'status':!![],'message':'File\x20uploaded'});const _0x4b28d5=getBotsWithMode();_0x4b28d5[_0x549353(0x2d9)]>0x0?confirmRestore(temppath,_0x3b6a5c[_0x549353(0x1b2)]):unzipFile(temppath,_0x3b6a5c[_0x549353(0x1b2)]);}}else logger[_0x549353(0x19d)](_0x549353(0x269));}else logger[_0x549353(0x19d)](_0x549353(0x262));}),app[_0x2f2667(0x2f0)](express[_0x2f2667(0x2c1)](path[_0x2f2667(0x2af)](__dirname,bbpath2,_0x2f2667(0x186)))),app[_0x2f2667(0x2f0)](express['static'](path['join'](__dirname,bbpath2,'build'))),app[_0x2f2667(0x33c)]('/',function(_0x3fa4b9,_0x17ab0a){const _0x29f2f3=_0x2f2667;_0x17ab0a[_0x29f2f3(0x26b)](path[_0x29f2f3(0x2af)](__dirname,bbpath2,_0x29f2f3(0x186),_0x29f2f3(0x185)));}),app[_0x2f2667(0x33c)](_0x2f2667(0x304),function(_0x3aae0d,_0x3547ef){const _0x19eb6f=_0x2f2667;_0x3547ef[_0x19eb6f(0x26b)](path[_0x19eb6f(0x2af)](__dirname,bbpath2,_0x19eb6f(0x206),'index.html'));}),app[_0x2f2667(0x33c)]('/:bot/portfolio',(_0x4f6728,_0xc23d84)=>{const _0x1d27eb=_0x2f2667;_0xc23d84['sendFile'](path['join'](__dirname,bbpath2,'build',_0x1d27eb(0x185)));}),app[_0x2f2667(0x33c)]('/:bot/performance',(_0x318f67,_0x1f564e)=>{const _0x302784=_0x2f2667;_0x1f564e[_0x302784(0x26b)](path[_0x302784(0x2af)](__dirname,bbpath2,_0x302784(0x206),'index.html'));}),app['get'](_0x2f2667(0x273),(_0x373d12,_0x1f1d6a)=>{const _0x30c97a=_0x2f2667;_0x1f1d6a[_0x30c97a(0x26b)](path[_0x30c97a(0x2af)](__dirname,bbpath2,_0x30c97a(0x206),_0x30c97a(0x185)));}),app[_0x2f2667(0x33c)](_0x2f2667(0x297),(_0x2ce89b,_0x389276)=>{const _0x1a4119=_0x2f2667;_0x389276[_0x1a4119(0x26b)](path[_0x1a4119(0x2af)](__dirname,bbpath2,_0x1a4119(0x206),_0x1a4119(0x185)));}),app['get'](_0x2f2667(0x1d7),(_0x478924,_0x2493fd)=>{const _0x29f85d=_0x2f2667;_0x2493fd[_0x29f85d(0x26b)](path['join'](__dirname,bbpath2,_0x29f85d(0x206),_0x29f85d(0x185)));}),app[_0x2f2667(0x33c)](_0x2f2667(0x1ee),(_0x3d0281,_0x189237)=>{const _0x5e0794=_0x2f2667;_0x189237[_0x5e0794(0x26b)](path[_0x5e0794(0x2af)](__dirname,bbpath2,_0x5e0794(0x206),_0x5e0794(0x185)));});if(HOST)http[_0x2f2667(0x1f2)](PORT,HOST);else http[_0x2f2667(0x1f2)](PORT);const io=require(_0x2f2667(0x2e4))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4d238c=_0x2f2667;let _0x569892=_0x4d238c(0x1b0);const _0x175ffb=networkInterfaces(),_0x834e6e={};for(const _0x24e664 of Object[_0x4d238c(0x1db)](_0x175ffb)){for(const _0x202b7a of _0x175ffb[_0x24e664]){if((_0x202b7a['family']==_0x4d238c(0x167)||_0x202b7a['family']==0x4)&&!_0x202b7a[_0x4d238c(0x240)]){const _0x4cf185=ipaddr[_0x4d238c(0x2ef)](_0x202b7a[_0x4d238c(0x250)])[_0x4d238c(0x1fc)]();_0x4cf185!='private'&&(!_0x834e6e[_0x24e664]&&(_0x834e6e[_0x24e664]=[]),_0x834e6e[_0x24e664][_0x4d238c(0x323)](_0x202b7a[_0x4d238c(0x250)]),_0x569892=_0x202b7a[_0x4d238c(0x250)]);}}}return{'serverip':_0x569892,'netinterfaces':_0x834e6e};}async function startServer(){const _0x1a92a3=_0x2f2667,{serverip:_0x22dd19,netinterfaces:_0x11d8ba}=getServerIP();logger[_0x1a92a3(0x1b6)](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x1a92a3(0x19d)](_0x1a92a3(0x1e6)+serverversion+_0x1a92a3(0x213)+(environment==_0x1a92a3(0x272)?_0x1a92a3(0x299):'')+'\x0a'+(_0x1a92a3(0x1cb)+PORT+_0x1a92a3(0x33a))+(_0x1a92a3(0x21f)+_0x22dd19+':'+PORT+_0x1a92a3(0x260))),logger[_0x1a92a3(0x1b6)](_0x1a92a3(0x322));if(config[_0x1a92a3(0x2d9)]!=0x0)for(const _0x540a4f of config){if(_0x540a4f['status']=='enabled'||_0x540a4f['status']==_0x1a92a3(0x1c9))await logger[_0x1a92a3(0x19d)](_0x1a92a3(0x2b8)+_0x540a4f['botID']+'\x20|\x20'+_0x540a4f['botname']),startBot([_0x540a4f[_0x1a92a3(0x19e)],userID],{'cwd':bbpath},function(_0xd93544){const _0x445766=_0x1a92a3;if(_0xd93544)logger[_0x445766(0x19d)](_0xd93544);});else(_0x540a4f['status']==_0x1a92a3(0x311)||_0x540a4f['status']==_0x1a92a3(0x159))&&await logger['full'](_0x1a92a3(0x249)+_0x540a4f[_0x1a92a3(0x19e)]+_0x1a92a3(0x1ca)+_0x540a4f['botname']);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x1a92a3(0x1b6)](_0x1a92a3(0x322)),logger['simple'](''),await logger[_0x1a92a3(0x2b0)](_0x1a92a3(0x30e)+nodeversion),await logger[_0x1a92a3(0x2b0)](_0x1a92a3(0x161),_0x11d8ba);}function startSocket(){const _0x28bd12=_0x2f2667;io['on'](_0x28bd12(0x172),_0x19b302=>{const _0x3bc915=_0x28bd12;let _0x5aff6e,_0x24dbad,_0x35076b,_0x134d08,_0x53636b;const _0x9d1b7e=_0x19b302[_0x3bc915(0x22e)][_0x3bc915(0x2a9)][_0x3bc915(0x1aa)];_0x24dbad=_0x9d1b7e[_0x3bc915(0x2e1)](/bot[0-9]{3}/);if(_0x24dbad)_0x35076b=_0x24dbad[0x0][_0x3bc915(0x2e1)](/[0-9]{3}/);if(_0x35076b)_0x5aff6e=_0x35076b[0x0];else _0x5aff6e=_0x3bc915(0x222);const _0x4d8722=_0x19b302[_0x3bc915(0x22e)]['auth'][_0x3bc915(0x2d1)];if(!_0x4d8722)_0x19b302[_0x3bc915(0x29b)]('status',{'publicKey':secure[_0x3bc915(0x291)]});else{_0x134d08=timelyDecrypt(_0x4d8722,![]);if(!_0x134d08)_0x19b302[_0x3bc915(0x29b)]('status',{'publicKey':secure[_0x3bc915(0x291)]});else{_0x53636b=normalizeIP(_0x19b302[_0x3bc915(0x25a)][_0x3bc915(0x1c6)])['store'];if(!devices[_0x134d08])devices[_0x134d08]={'uuid':_0x134d08,'access':{'token':null}};devices[_0x134d08]['ip']=_0x53636b;const _0x4479f2=addClient(_0x19b302['id'],_0x134d08,_0x5aff6e);setAccess(_0x4479f2),emitMessages(),_0x19b302['on'](_0x3bc915(0x22d),_0x22f394=>{const _0x3f4d89=_0x3bc915,_0x1c1931=timelyDecrypt(_0x22f394['password']);if(_0x1c1931){_0x22f394={'username':_0x22f394[_0x3f4d89(0x29a)],'password':_0x1c1931},devices[_0x134d08][_0x3f4d89(0x2d7)]=validateCredentials(_0x22f394,_0x134d08);if(devices[_0x134d08][_0x3f4d89(0x2d7)]['allow']==![]&&devices[_0x134d08][_0x3f4d89(0x2d7)][_0x3f4d89(0x24e)]=='2FA\x20login\x20required')_0x19b302[_0x3f4d89(0x29b)](_0x3f4d89(0x293),{'access':devices[_0x134d08][_0x3f4d89(0x2d7)]}),loginAccess2FA(_0x134d08,_0x53636b);else{if(devices[_0x134d08][_0x3f4d89(0x2d7)][_0x3f4d89(0x208)]==![]&&devices[_0x134d08][_0x3f4d89(0x2d7)][_0x3f4d89(0x24e)]==_0x3f4d89(0x202))_0x19b302[_0x3f4d89(0x29b)]('status',{'access':devices[_0x134d08][_0x3f4d89(0x2d7)]});else devices[_0x134d08][_0x3f4d89(0x2d7)][_0x3f4d89(0x208)]&&devices[_0x134d08][_0x3f4d89(0x2d7)][_0x3f4d89(0x24e)]==_0x3f4d89(0x282)&&(getClientsWithUuid(_0x134d08)[_0x3f4d89(0x2de)](_0x15d200=>{setAccess(_0x15d200);}),logger[_0x3f4d89(0x2b0)](_0x3f4d89(0x2a1)+_0x134d08[_0x3f4d89(0x20e)](-0x8)),setTokenRefresh(_0x134d08),setSessionTimeout(_0x3f4d89(0x22d),_0x134d08));}}else logger[_0x3f4d89(0x19d)](_0x3f4d89(0x2cb));}),_0x19b302['on'](_0x3bc915(0x235),()=>{resetPassword();}),_0x19b302['on'](_0x3bc915(0x218),_0x56ccb0=>{removeClient(_0x19b302['id']);}),_0x5aff6e==_0x3bc915(0x222)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4bb9e7){const _0x45427f=_0x2f2667;if(_0x4bb9e7!=_0x45427f(0x222)&&config[_0x45427f(0x1a3)]!=''){if(pid[_0x4bb9e7])pid[_0x4bb9e7][_0x45427f(0x27c)]({'function':_0x45427f(0x2b4),'args':null});}_0x4bb9e7!='botmanager'&&broadcastToBots(_0x45427f(0x30c),JSON[_0x45427f(0x171)](config));}function reloadBotManager(){const _0x23e2f0=_0x2f2667;getClientsWithBotID(_0x23e2f0(0x222))[_0x23e2f0(0x2de)](_0x47b185=>{const _0x1fb879=_0x23e2f0;getSocket(_0x47b185['id'])[_0x1fb879(0x29b)](_0x1fb879(0x293),{'access':{'allow':![],'reason':_0x1fb879(0x163),'token':null}});});}function getSocket(_0x4fccaa){const _0x373a6c=_0x2f2667;return io[_0x373a6c(0x303)][_0x373a6c(0x303)][_0x373a6c(0x33c)](_0x4fccaa);}function setAccess(_0x4d08a9){const _0x317359=_0x2f2667,_0x53c529=getSocket(_0x4d08a9['id']),_0x7934f0=_0x4d08a9[_0x317359(0x2a4)],_0x464369=_0x4d08a9[_0x317359(0x252)];devices[_0x7934f0][_0x317359(0x2d7)]=validateAccess(devices[_0x7934f0]['access'][_0x317359(0x28f)],_0x7934f0),logger[_0x317359(0x2b0)](_0x317359(0x19f)+devices[_0x7934f0][_0x317359(0x2d7)][_0x317359(0x24e)]+'\x20|\x20client:\x20...'+_0x4d08a9['id']['slice'](-0x8)+_0x317359(0x30a)+_0x7934f0['slice'](-0x8)),_0x53c529[_0x317359(0x2af)](_0x7934f0);if(devices[_0x7934f0][_0x317359(0x2d7)][_0x317359(0x208)]){_0x53c529[_0x317359(0x2af)](_0x464369);if(_0x464369=='botmanager')initializeSocketBotManager(_0x53c529);else initializeSocketBot(_0x53c529);initClient(_0x464369);}devices[_0x7934f0][_0x317359(0x2d7)][_0x317359(0x28f)]&&devices[_0x7934f0][_0x317359(0x2d7)][_0x317359(0x24e)]==_0x317359(0x1dd)&&setSessionTimeout(_0x317359(0x264),_0x7934f0),devices[_0x7934f0]['access'][_0x317359(0x28f)]&&devices[_0x7934f0][_0x317359(0x2d7)][_0x317359(0x24e)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x317359(0x22d),_0x7934f0),_0x53c529[_0x317359(0x29b)](_0x317359(0x293),{'status':_0x4d08a9['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x7934f0]['access'],'externalip':devices[_0x7934f0]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x7934f0][_0x317359(0x2d7)][_0x317359(0x208)]==![]&&devices[_0x7934f0][_0x317359(0x2d7)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x7934f0,devices[_0x7934f0]['ip']);}function setSessionTimeout(_0x4476b0,_0x6aecc1){const _0x5be241=_0x2f2667;let _0x143d20;if(_0x4476b0==_0x5be241(0x22d))_0x143d20=loginExpiry*0x3c*0x3e8;else _0x143d20=devices[_0x6aecc1]['telegramIpApproval'][_0x5be241(0x1ea)]*0x3c*0x3e8-(new Date()[_0x5be241(0x1f5)]()-devices[_0x6aecc1][_0x5be241(0x28d)][_0x5be241(0x182)]);if(devices[_0x6aecc1][_0x5be241(0x2c4)])clearTimeout(devices[_0x6aecc1][_0x5be241(0x2c4)]);devices[_0x6aecc1][_0x5be241(0x2c4)]=setTimeout(()=>{const _0xe49447=_0x5be241;if(devices[_0x6aecc1][_0xe49447(0x2a5)])clearTimeout(devices[_0x6aecc1][_0xe49447(0x2a5)]);removeSocketListeners(_0x6aecc1),addBlacklist(_0x6aecc1),devices[_0x6aecc1][_0xe49447(0x28d)]=null,devices[_0x6aecc1][_0xe49447(0x1cf)]=null,devices[_0x6aecc1][_0xe49447(0x2d7)][_0xe49447(0x28f)]=null,logger['debug'](_0xe49447(0x2a0)+_0x6aecc1[_0xe49447(0x20e)](-0x8)),devices[_0x6aecc1][_0xe49447(0x2d7)]=validateAccess(devices[_0x6aecc1][_0xe49447(0x2d7)][_0xe49447(0x28f)],_0x6aecc1),!(devices[_0x6aecc1][_0xe49447(0x2d7)][_0xe49447(0x208)]&&devices[_0x6aecc1][_0xe49447(0x2d7)]['reason']=='login\x20not\x20required')&&(_0x4476b0==_0xe49447(0x22d)?io['to'](_0x6aecc1)['emit'](_0xe49447(0x293),{'access':{'allow':![],'reason':_0xe49447(0x2fa),'token':null}}):io['to'](_0x6aecc1)[_0xe49447(0x29b)]('status',{'access':{'allow':![],'reason':_0xe49447(0x1a9),'token':null}})),devices[_0x6aecc1][_0xe49447(0x2d7)][_0xe49447(0x28f)]=null;},_0x143d20);}function setTokenRefresh(_0x400e51){const _0x4e2e93=_0x2f2667;if(devices[_0x400e51]['pidRefreshToken'])clearTimeout(devices[_0x400e51][_0x4e2e93(0x2a5)]);devices[_0x400e51]['pidRefreshToken']=setTimeout(()=>{const _0x4850c5=_0x4e2e93;getClientsWithUuid(_0x400e51)[_0x4850c5(0x2d9)]!=0x0?(devices[_0x400e51][_0x4850c5(0x2d7)]=refreshToken(_0x400e51),io['to'](_0x400e51)[_0x4850c5(0x29b)](_0x4850c5(0x293),{'status':_0x4850c5(0x2c9),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x400e51]['access'],'externalip':devices[_0x400e51]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x400e51)):clearTimeout(devices[_0x400e51]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x549795){const _0x34e0f3=_0x2f2667,_0x1ebedf=getClient(_0x549795['id'])[_0x34e0f3(0x2a4)];_0x549795[_0x34e0f3(0x29b)](_0x34e0f3(0x30c),config),_0x549795[_0x34e0f3(0x29b)](_0x34e0f3(0x2d8),cleanSettings()),_0x549795['on'](_0x34e0f3(0x237),_0x33b99b=>{const _0x24c9c6=_0x34e0f3;if(validateAccess(_0x33b99b,_0x1ebedf)['allow'])addBot();else logger[_0x24c9c6(0x19d)](_0x24c9c6(0x24a));}),_0x549795['on']('update-bot',(_0x3ad1da,_0x788265)=>{const _0x4a8658=_0x34e0f3;if(validateAccess(_0x788265,_0x1ebedf)[_0x4a8658(0x208)])toggleBot(_0x3ad1da[_0x4a8658(0x19e)],_0x3ad1da[_0x4a8658(0x293)],_0x3ad1da[_0x4a8658(0x254)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x549795['on'](_0x34e0f3(0x290),(_0x3f9ec4,_0x566fd9)=>{const _0x9b8ab2=_0x34e0f3;if(validateAccess(_0x566fd9,_0x1ebedf)['allow'])toggleBotMode(_0x3f9ec4);else logger[_0x9b8ab2(0x19d)](_0x9b8ab2(0x277));}),_0x549795['on'](_0x34e0f3(0x1ce),(_0x3982c0,_0x44b399)=>{const _0x1330c0=_0x34e0f3;if(validateAccess(_0x44b399,_0x1ebedf)[_0x1330c0(0x208)])deleteBot(_0x3982c0);else logger[_0x1330c0(0x19d)](_0x1330c0(0x231));}),_0x549795['on']('store-settings',(_0xfed56,_0x23f0e8)=>{const _0x475114=_0x34e0f3;if(validateAccess(_0x23f0e8,_0x1ebedf)['allow'])storeSettings(_0xfed56,!![]);else logger[_0x475114(0x19d)](_0x475114(0x1ad));}),_0x549795['on'](_0x34e0f3(0x239),_0x4d6587=>{const _0x12e2a9=_0x34e0f3;if(validateAccess(_0x4d6587,_0x1ebedf)[_0x12e2a9(0x208)])updateBB(_0x12e2a9(0x215));else logger['full'](_0x12e2a9(0x2ad));}),_0x549795['on']('reinstall-bb',_0x24fd3a=>{const _0x1f2010=_0x34e0f3;if(validateAccess(_0x24fd3a,_0x1ebedf)[_0x1f2010(0x208)])updateBB(_0x1f2010(0x18a));else logger['full'](_0x1f2010(0x24d));}),_0x549795['on']('get-backup-files',_0x210215=>{const _0x2f84a6=_0x34e0f3;if(validateAccess(_0x210215,_0x1ebedf)[_0x2f84a6(0x208)]){const _0x4f4a93=getClient(_0x549795['id']);if(_0x4f4a93)getBackupFiles(_0x4f4a93[_0x2f84a6(0x2a4)]);else logger[_0x2f84a6(0x19d)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x2f84a6(0x19d)](_0x2f84a6(0x2df));}),_0x549795['on'](_0x34e0f3(0x27a),(_0x44bc6b,_0x5b4716)=>{const _0x116af3=_0x34e0f3;if(validateAccess(_0x5b4716,_0x1ebedf)[_0x116af3(0x208)])restoreBackupFile(_0x44bc6b);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x549795['on']('get-messages',_0x1cc8d5=>{const _0x10779c=_0x34e0f3;if(validateAccess(_0x1cc8d5,_0x1ebedf)[_0x10779c(0x208)])getMessages();else logger[_0x10779c(0x19d)](_0x10779c(0x1ec));}),_0x549795['on'](_0x34e0f3(0x298),(_0x516c30,_0x12b03c)=>{const _0x3bf9b8=_0x34e0f3;if(validateAccess(_0x12b03c,_0x1ebedf)['allow'])confirmMessage(_0x516c30);else logger[_0x3bf9b8(0x19d)](_0x3bf9b8(0x160));}),_0x549795['on'](_0x34e0f3(0x289),_0x1ea469=>{const _0x5cabe2=_0x34e0f3;if(validateAccess(_0x1ea469,_0x1ebedf)[_0x5cabe2(0x208)]){if(devices[_0x1ebedf][_0x5cabe2(0x2a5)])clearTimeout(devices[_0x1ebedf][_0x5cabe2(0x2a5)]);if(devices[_0x1ebedf][_0x5cabe2(0x2c4)])clearTimeout(devices[_0x1ebedf]['pidExpireLogin']);removeSocketListeners(getClient(_0x549795['id'])[_0x5cabe2(0x2a4)]),addBlacklist(_0x1ebedf),devices[_0x1ebedf][_0x5cabe2(0x28d)]=null,devices[_0x1ebedf][_0x5cabe2(0x1cf)]=null,devices[_0x1ebedf]['access']['token']=null,logger[_0x5cabe2(0x2b0)](_0x5cabe2(0x1c8)+_0x1ebedf[_0x5cabe2(0x20e)](-0x8)),io['to'](getClient(_0x549795['id'])[_0x5cabe2(0x2a4)])[_0x5cabe2(0x29b)](_0x5cabe2(0x293),{'access':{'allow':![],'reason':_0x5cabe2(0x1b3),'token':null}});}else logger[_0x5cabe2(0x19d)](_0x5cabe2(0x1be));});}function initializeSocketBot(_0x42494c){const _0x35e847=_0x2f2667,_0x1cb57f=getClient(_0x42494c['id'])[_0x35e847(0x252)],_0x1c425c=getClient(_0x42494c['id'])[_0x35e847(0x2a4)];_0x42494c['on'](_0x35e847(0x204),(_0xdc09bf,_0x5dac57)=>{const _0x5304df=_0x35e847;if(validateAccess(_0x5dac57,_0x1c425c)['allow']){if(pid[_0x1cb57f])pid[_0x1cb57f][_0x5304df(0x27c)]({'function':'emitHistory','args':_0xdc09bf});}else logger['full'](_0x5304df(0x2f3));}),_0x42494c['on'](_0x35e847(0x1e2),(_0xe9859f,_0x699b3e)=>{const _0x3e0bc0=_0x35e847;if(validateAccess(_0x699b3e,_0x1c425c)['allow']){if(pid[_0x1cb57f])pid[_0x1cb57f][_0x3e0bc0(0x27c)]({'function':_0x3e0bc0(0x16c),'args':_0xe9859f});}else logger[_0x3e0bc0(0x19d)](_0x3e0bc0(0x2dc));}),_0x42494c['on'](_0x35e847(0x16a),(_0x63345c,_0x11ce34)=>{const _0x26a56c=_0x35e847;if(validateAccess(_0x11ce34,_0x1c425c)['allow']){if(pid[_0x1cb57f])pid[_0x1cb57f][_0x26a56c(0x27c)]({'function':_0x26a56c(0x1a4),'args':_0x63345c});}else logger[_0x26a56c(0x19d)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x42494c['on']('store-configuration',(_0x446ef8,_0x1bf2dd)=>{const _0x5d200f=_0x35e847;if(validateAccess(_0x1bf2dd,_0x1c425c)[_0x5d200f(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f]['send']({'function':_0x5d200f(0x1d4),'args':_0x446ef8});}else logger['full'](_0x5d200f(0x257));}),_0x42494c['on'](_0x35e847(0x223),(_0x17d466,_0x73eff9)=>{const _0x5b1857=_0x35e847;if(validateAccess(_0x73eff9,_0x1c425c)[_0x5b1857(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f]['send']({'function':_0x5b1857(0x221),'args':_0x17d466});}else logger[_0x5b1857(0x19d)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x42494c['on'](_0x35e847(0x31e),(_0x23908f,_0x42ba74)=>{const _0x28c47b=_0x35e847;if(validateAccess(_0x42ba74,_0x1c425c)[_0x28c47b(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f][_0x28c47b(0x27c)]({'function':_0x28c47b(0x233),'args':_0x23908f});}else logger[_0x28c47b(0x19d)](_0x28c47b(0x224));}),_0x42494c['on'](_0x35e847(0x1cc),_0x48523d=>{const _0x45b314=_0x35e847;if(validateAccess(_0x48523d,_0x1c425c)[_0x45b314(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f]['send']({'function':_0x45b314(0x2fc),'args':null});}else logger[_0x45b314(0x19d)](_0x45b314(0x294));}),_0x42494c['on']('get-starting-balances',_0x2d6eb5=>{const _0x47b9d3=_0x35e847;if(validateAccess(_0x2d6eb5,_0x1c425c)[_0x47b9d3(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f][_0x47b9d3(0x27c)]({'function':_0x47b9d3(0x319),'args':null});}else logger[_0x47b9d3(0x19d)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x42494c['on'](_0x35e847(0x1de),(_0x44c6e9,_0x4ad2ec)=>{const _0x389d1f=_0x35e847;if(validateAccess(_0x4ad2ec,_0x1c425c)[_0x389d1f(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f]['send']({'function':_0x389d1f(0x1c2),'args':_0x44c6e9});}else logger['full'](_0x389d1f(0x2ca));}),_0x42494c['on'](_0x35e847(0x245),_0x13c1ff=>{const _0x16763e=_0x35e847;if(validateAccess(_0x13c1ff,_0x1c425c)[_0x16763e(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f]['send']({'function':_0x16763e(0x1da),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x42494c['on']('show-config',_0x39bdb0=>{const _0x22d1ae=_0x35e847;if(validateAccess(_0x39bdb0,_0x1c425c)[_0x22d1ae(0x208)]){if(pid[_0x1cb57f])pid[_0x1cb57f][_0x22d1ae(0x27c)]({'function':_0x22d1ae(0x22a),'args':null});}else logger[_0x22d1ae(0x19d)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x42494c['on']('update-bb',_0x163122=>{const _0x4459b6=_0x35e847;if(validateAccess(_0x163122,_0x1c425c)['allow'])updateBB('update');else logger[_0x4459b6(0x19d)](_0x4459b6(0x2ad));}),_0x42494c['on'](_0x35e847(0x227),_0x18ab23=>{const _0x4a0f37=_0x35e847;if(validateAccess(_0x18ab23,_0x1c425c)['allow'])getMessages();else logger['full'](_0x4a0f37(0x1ec));}),_0x42494c['on'](_0x35e847(0x298),(_0x5ed530,_0x46d7bf)=>{const _0x245027=_0x35e847;if(validateAccess(_0x46d7bf,_0x1c425c)[_0x245027(0x208)])confirmMessage(_0x5ed530);else logger['full'](_0x245027(0x160));}),_0x42494c['on'](_0x35e847(0x289),_0x243454=>{const _0x3b6612=_0x35e847;if(validateAccess(_0x243454,_0x1c425c)['allow']){if(devices[_0x1c425c][_0x3b6612(0x2a5)])clearTimeout(devices[_0x1c425c]['pidRefreshToken']);if(devices[_0x1c425c][_0x3b6612(0x2c4)])clearTimeout(devices[_0x1c425c]['pidExpireLogin']);removeSocketListeners(getClient(_0x42494c['id'])['uuid']),addBlacklist(_0x1c425c),devices[_0x1c425c][_0x3b6612(0x28d)]=null,devices[_0x1c425c][_0x3b6612(0x1cf)]=null,devices[_0x1c425c][_0x3b6612(0x2d7)][_0x3b6612(0x28f)]=null,logger[_0x3b6612(0x2b0)](_0x3b6612(0x1c8)+_0x1c425c[_0x3b6612(0x20e)](-0x8)),io['to'](getClient(_0x42494c['id'])[_0x3b6612(0x2a4)])[_0x3b6612(0x29b)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3b6612(0x19d)](_0x3b6612(0x1be));});}function removeSocketListeners(_0x2ebf63){const _0x319bda=_0x2f2667;getClientsWithUuid(_0x2ebf63)[_0x319bda(0x2de)](_0x562dbe=>{const _0x10fb2a=_0x319bda;getSocket(_0x562dbe['id'])[_0x10fb2a(0x164)]();});}function cleanSettings(){const _0x3bd70a=_0x2f2667;let _0xee4503=settings;return settings[_0x3bd70a(0x263)]&&settings['telegramToken']!=''&&(_0xee4503={..._0xee4503,'telegramToken':_0x3bd70a(0x2a7)}),settings['bbPassword']&&settings[_0x3bd70a(0x1e5)]!=''&&(_0xee4503={..._0xee4503,'bbPassword':_0x3bd70a(0x2a7)}),(settings[_0x3bd70a(0x1e5)]&&settings['bbPassword']==_0x3bd70a(0x1bd)||settings[_0x3bd70a(0x263)]&&settings[_0x3bd70a(0x263)]=='***')&&(_0xee4503={..._0xee4503,'restored':{'password':settings[_0x3bd70a(0x1e5)]=='***','telegram':settings[_0x3bd70a(0x263)]==_0x3bd70a(0x1bd)}}),_0xee4503;}async function updateBB(_0x54f2b5){const _0x38ff8d=_0x2f2667;await backupConfigFiles(),installingUpdate=!![],config[_0x38ff8d(0x2de)](_0x11aba1=>{const _0x15ad1d=_0x38ff8d;restartBot(_0x11aba1[_0x15ad1d(0x19e)]);});if(_0x54f2b5=='update')process['send']({'update':!![],'environment':environment},_0x9fe2de=>{});else _0x54f2b5==_0x38ff8d(0x18a)&&process[_0x38ff8d(0x27c)]({'reinstall':!![],'environment':environment},_0x2b5e4c=>{});}function startBot(_0x4b8ab3,_0x3080c7,_0x169a9d){const _0x4824eb=_0x2f2667;if(debugging)_0x4b8ab3[_0x4824eb(0x323)]('-d');let _0x6e8abd=![];const _0xa1e7f6=_0x4b8ab3[0x0];_0x3080c7={..._0x3080c7,'stdio':[_0x4824eb(0x326),_0x4824eb(0x326),_0x4824eb(0x326),_0x4824eb(0x283)]},pid[_0xa1e7f6]=childProcess[_0x4824eb(0x327)](botfile,_0x4b8ab3,_0x3080c7),pid[_0xa1e7f6]['on'](_0x4824eb(0x1d1),_0x4e293b=>{const _0x28fa10=_0x4824eb;switch(Object[_0x28fa10(0x1db)](_0x4e293b)[0x0]){case _0x28fa10(0x234):updateBotName(_0xa1e7f6,_0x4e293b[_0x28fa10(0x234)]);break;case _0x28fa10(0x305):updateBotManager();break;case _0x28fa10(0x293):updateStatus(_0xa1e7f6,_0x4e293b[_0x28fa10(0x293)]);break;case _0x28fa10(0x254):updateLive(_0xa1e7f6,_0x4e293b[_0x28fa10(0x254)]);break;case _0x28fa10(0x2ce):updateLive(_0xa1e7f6,_0x4e293b[_0x28fa10(0x2ce)]),io['to'](_0xa1e7f6)[_0x28fa10(0x29b)](_0x28fa10(0x293),{'access':{'allow':![],'reason':_0x28fa10(0x163),'token':null}});break;case _0x28fa10(0x1b1):_0x4e293b['stop']=='restart'&&restartBot(_0xa1e7f6);_0x4e293b['stop']==_0x28fa10(0x265)&&toggleBot(_0xa1e7f6,_0x28fa10(0x311),_0x28fa10(0x267));break;case'telegram':sendTelegram(_0xa1e7f6,_0x4e293b[_0x28fa10(0x211)]);break;case _0x28fa10(0x16e):sendTelegramMsg(_0x4e293b[_0x28fa10(0x16e)]);break;case _0x28fa10(0x2e0):io['to'](_0xa1e7f6)[_0x28fa10(0x29b)](_0x4e293b[_0x28fa10(0x2e0)],_0x4e293b[_0x28fa10(0x20c)]);break;}}),pid[_0xa1e7f6]['on']('error',function(_0x5f59d8){if(_0x6e8abd)return;_0x6e8abd=!![],_0x169a9d(_0x5f59d8);}),pid[_0xa1e7f6]['on'](_0x4824eb(0x2c8),async function(_0x5bb4b8){const _0x583a3a=_0x4824eb;if(installingUpdate)return;if(_0x6e8abd)return;_0x6e8abd=!![],_0x169a9d(null);const _0x31b683=dbConfig[_0x583a3a(0x33c)]('bots')[_0x583a3a(0x336)]({'botID':_0xa1e7f6})['value']();_0x31b683&&(_0x31b683[_0x583a3a(0x293)]==_0x583a3a(0x1a6)||_0x31b683['status']=='new')&&(await sleep(0x3e8),updateLive(_0xa1e7f6,_0x583a3a(0x267)),logger[_0x583a3a(0x19d)](_0x583a3a(0x330)+_0xa1e7f6),startBot([_0xa1e7f6,userID],{'cwd':bbpath},function(_0x9c79d5){const _0xa8e81a=_0x583a3a;if(_0x9c79d5)logger[_0xa8e81a(0x19d)](_0x9c79d5);}));});}function stopBot(_0x36cffc){const _0x5a7d95=_0x2f2667;getClientsWithBotID(_0x36cffc)['forEach'](_0x1e5812=>{const _0x44fd2c=_0x1a51;getSocket(_0x1e5812['id'])[_0x44fd2c(0x218)](!![]),removeClient(_0x1e5812['id']);}),pid[_0x36cffc]&&(pid[_0x36cffc][_0x5a7d95(0x265)](),pid[_0x36cffc]=null);}function restartBot(_0x57b338){const _0x2a3650=_0x2f2667;if(pid[_0x57b338])pid[_0x57b338][_0x2a3650(0x265)]();}function addBot(){const _0x52903e=_0x2f2667;let _0x33a5e5;for(let _0x11c12e=0x1;_0x11c12e<0x3e9;_0x11c12e++){_0x33a5e5=_0x11c12e['toString']()[_0x52903e(0x1e3)](0x3,'0');let _0x123cb4=config[_0x52903e(0x336)](_0x196156=>_0x196156[_0x52903e(0x19e)]==_0x33a5e5);if(!_0x123cb4)break;}if(_0x33a5e5===_0x52903e(0x181)){logger[_0x52903e(0x19d)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x52903e(0x19d)](_0x52903e(0x24b)+_0x33a5e5),dbConfig[_0x52903e(0x33c)](_0x52903e(0x30c))[_0x52903e(0x323)]({'botID':_0x33a5e5,'botname':_0x52903e(0x1ac)+_0x33a5e5,'status':'new','live':''})[_0x52903e(0x281)](),startBot([_0x33a5e5,userID],{'cwd':bbpath},function(_0x43d9ce){const _0x93c215=_0x52903e;if(_0x43d9ce)logger[_0x93c215(0x19d)](_0x43d9ce);}),config=getConfiguration(),io['to'](_0x52903e(0x222))['emit']('bots',config),broadcastToBots(_0x52903e(0x30c),JSON[_0x52903e(0x171)](config));}function deleteBot(_0x3c05a8){const _0x1c8e9f=_0x2f2667;getClientsWithBotID(_0x3c05a8)['forEach'](_0x4f49de=>{getSocket(_0x4f49de['id'])['disconnect'](!![]),removeClient(_0x4f49de['id']);}),dbConfig[_0x1c8e9f(0x33c)](_0x1c8e9f(0x30c))['remove']({'botID':_0x3c05a8})[_0x1c8e9f(0x281)](),logger['full']('Deleted\x20Bot\x20'+_0x3c05a8),stopBot(_0x3c05a8);try{if(fs['existsSync'](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+'-config.json')))fs[_0x1c8e9f(0x27d)](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+'-config.json'));if(fs[_0x1c8e9f(0x2da)](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+_0x1c8e9f(0x243))))fs[_0x1c8e9f(0x27d)](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+_0x1c8e9f(0x243)));if(fs['existsSync'](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+_0x1c8e9f(0x302))))fs['unlinkSync'](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+'-performance.json'));if(fs[_0x1c8e9f(0x2da)](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+_0x1c8e9f(0x20f))))fs[_0x1c8e9f(0x27d)](path[_0x1c8e9f(0x2af)](configpath,_0x1c8e9f(0x266)+_0x3c05a8+'-results.json'));}catch(_0x18b0d7){if(_0x18b0d7)logger[_0x1c8e9f(0x19d)](_0x1c8e9f(0x173),_0x18b0d7);}config=getConfiguration(),io['to']('botmanager')[_0x1c8e9f(0x29b)](_0x1c8e9f(0x30c),config),broadcastToBots('bots',JSON[_0x1c8e9f(0x171)](config));}function toggleBot(_0x5d8ca7,_0x3f2cf8,_0x3cc3bf){const _0x51b3ed=_0x2f2667;dbConfig[_0x51b3ed(0x33c)]('bots')['find']({'botID':_0x5d8ca7})[_0x51b3ed(0x1c7)]({'status':_0x3f2cf8})[_0x51b3ed(0x1c7)]({'live':_0x3cc3bf})[_0x51b3ed(0x281)]();if(_0x3f2cf8=='enabled'||_0x3f2cf8==_0x51b3ed(0x1c9))logger[_0x51b3ed(0x19d)](_0x51b3ed(0x2d6)+_0x5d8ca7),startBot([_0x5d8ca7,userID],{'cwd':bbpath},function(_0x2b6da1){const _0x3ab157=_0x51b3ed;if(_0x2b6da1)logger[_0x3ab157(0x19d)](_0x2b6da1);});else(_0x3f2cf8=='disabled'||_0x3f2cf8==_0x51b3ed(0x159))&&(logger[_0x51b3ed(0x19d)](_0x51b3ed(0x18f)+_0x5d8ca7),stopBot(_0x5d8ca7));config=getConfiguration(),io['to'](_0x51b3ed(0x222))[_0x51b3ed(0x29b)](_0x51b3ed(0x30c),config),broadcastToBots(_0x51b3ed(0x30c),JSON[_0x51b3ed(0x171)](config));}function toggleStatus(_0x24f8fc){const _0x4a0051=_0x2f2667;let _0x2766df=dbConfig['get']('bots')[_0x4a0051(0x336)]({'botID':_0x24f8fc})[_0x4a0051(0x2a2)](),_0x5d38a0;if(_0x2766df[_0x4a0051(0x293)]===_0x4a0051(0x1a6))_0x5d38a0=_0x4a0051(0x311);else{if(_0x2766df[_0x4a0051(0x293)]===_0x4a0051(0x1c9))_0x5d38a0=_0x4a0051(0x159);else{if(_0x2766df[_0x4a0051(0x293)]===_0x4a0051(0x159))_0x5d38a0=_0x4a0051(0x1c9);else{if(_0x2766df['status']===_0x4a0051(0x311))_0x5d38a0=_0x4a0051(0x1a6);}}}return _0x5d38a0;}function updateStatus(_0x14d3a3,_0x4493d5){const _0x583b64=_0x2f2667;dbConfig[_0x583b64(0x33c)]('bots')[_0x583b64(0x336)]({'botID':_0x14d3a3})[_0x583b64(0x1c7)]({'status':_0x4493d5})[_0x583b64(0x281)](),config=getConfiguration(),io['to']('botmanager')[_0x583b64(0x29b)](_0x583b64(0x30c),config),broadcastToBots('bots',JSON[_0x583b64(0x171)](config));}function updateLive(_0x3f2370,_0x2b6adb){const _0x133dd4=_0x2f2667;dbConfig[_0x133dd4(0x33c)](_0x133dd4(0x30c))[_0x133dd4(0x336)]({'botID':_0x3f2370})[_0x133dd4(0x1c7)]({'live':_0x2b6adb})[_0x133dd4(0x281)](),config=getConfiguration(),io['to'](_0x133dd4(0x222))['emit'](_0x133dd4(0x30c),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x29cd5d,_0x57cf30){const _0x1f0e97=_0x2f2667;dbConfig[_0x1f0e97(0x33c)](_0x1f0e97(0x30c))[_0x1f0e97(0x336)]({'botID':_0x29cd5d})[_0x1f0e97(0x1c7)]({'botname':_0x57cf30})['write'](),config=getConfiguration(),io['to'](_0x1f0e97(0x222))[_0x1f0e97(0x29b)](_0x1f0e97(0x30c),config),broadcastToBots(_0x1f0e97(0x30c),JSON[_0x1f0e97(0x171)](config));}function updateBotManager(){const _0x1a82f2=_0x2f2667;config=getConfiguration(),io['to']('botmanager')[_0x1a82f2(0x29b)](_0x1a82f2(0x30c),config),broadcastToBots(_0x1a82f2(0x30c),JSON[_0x1a82f2(0x171)](config));}function toggleBotMode(_0x4fb612){const _0x11911e=_0x2f2667;if(pid[_0x4fb612])pid[_0x4fb612]['send']({'function':'toggleBotMode','args':null});else{const _0x4a2970=configpath+_0x11911e(0x266)+_0x4fb612+'-config.json',_0x378def=fs[_0x11911e(0x318)](_0x4a2970),_0x3e2217=JSON['parse'](_0x378def),_0x45015f=_0x3e2217[_0x11911e(0x252)][0x0][_0x11911e(0x1f4)];_0x3e2217[_0x11911e(0x252)][0x0][_0x11911e(0x1f4)]=!_0x45015f;const _0x51cefa=JSON[_0x11911e(0x171)](_0x3e2217,null,0x2);fs['writeFileSync'](_0x4a2970,_0x51cefa),config=getConfiguration(),io['to']('botmanager')[_0x11911e(0x29b)](_0x11911e(0x30c),config),broadcastToBots('bots',JSON[_0x11911e(0x171)](config));}}function telegramError(_0x1de978){const _0x5ae751=_0x2f2667;logger[_0x5ae751(0x1b6)](getTimeStamp()+_0x5ae751(0x18b));}function validateTelegram(_0x4aa8f3){const _0x4c40b7=_0x2f2667;if(_0x4aa8f3['from'][_0x4c40b7(0x29a)]!=settings[_0x4c40b7(0x25d)]&&'@'+_0x4aa8f3[_0x4c40b7(0x309)][_0x4c40b7(0x29a)]!=settings[_0x4c40b7(0x25d)])return tgBot['sendMessage'](_0x4aa8f3[_0x4c40b7(0x334)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x4c40b7(0x2b9)](_0x36612e=>{telegramError(_0x36612e);}),![];return!![];}async function initTelegram(){const _0x381e75=_0x2f2667;if(tgBot)tgBot[_0x381e75(0x1b5)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x381e75(0x263)],{'polling':!![]});let _0x2d6d3a=_0x381e75(0x325);_0x2d6d3a+='\x0a',_0x2d6d3a+='/enable\x20-\x20enable\x20notifications\x0a',_0x2d6d3a+=_0x381e75(0x271),_0x2d6d3a+=_0x381e75(0x1b7),_0x2d6d3a+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x2d6d3a+='/on\x20-\x20start\x20bot(s)\x0a',_0x2d6d3a+=_0x381e75(0x246),_0x2d6d3a+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x2d6d3a+=_0x381e75(0x16b),_0x2d6d3a+=_0x381e75(0x2bc),_0x2d6d3a+=_0x381e75(0x1e1),_0x2d6d3a+=_0x381e75(0x18d),_0x2d6d3a+=_0x381e75(0x1f3),_0x2d6d3a+=_0x381e75(0x228),_0x2d6d3a+='/help\x20-\x20show\x20available\x20commands\x0a';let _0xebdf10=_0x381e75(0x1b9);_0xebdf10+='\x0a',_0xebdf10+=_0x2d6d3a,tgBot[_0x381e75(0x2ae)](/\/start/,_0x14ecdf=>{const _0x17ad8f=_0x381e75;if(!validateTelegram(_0x14ecdf))return;if(settings[_0x17ad8f(0x287)]!=_0x14ecdf[_0x17ad8f(0x334)]['id'])updateSetting(_0x17ad8f(0x287),_0x14ecdf[_0x17ad8f(0x334)]['id']);updateSetting(_0x17ad8f(0x180),!![]),tgBot[_0x17ad8f(0x17e)](_0x14ecdf[_0x17ad8f(0x334)]['id'],_0xebdf10)[_0x17ad8f(0x2b9)](_0x16a2ba=>{telegramError(_0x16a2ba);});}),tgBot['onText'](/\/enable/,_0x4c3ca0=>{const _0x41ccb4=_0x381e75;if(!validateTelegram(_0x4c3ca0))return;if(settings['telegramChatId']!=_0x4c3ca0[_0x41ccb4(0x334)]['id'])updateSetting(_0x41ccb4(0x287),_0x4c3ca0['chat']['id']);updateSetting(_0x41ccb4(0x180),!![]),tgBot['sendMessage'](_0x4c3ca0[_0x41ccb4(0x334)]['id'],_0x41ccb4(0x23b))[_0x41ccb4(0x2b9)](_0x48f3e8=>{telegramError(_0x48f3e8);});}),tgBot[_0x381e75(0x2ae)](/\/config/,async _0x51b1b0=>{const _0x2e09ee=_0x381e75;if(!validateTelegram(_0x51b1b0))return;tgBot[_0x2e09ee(0x332)](_0x2e09ee(0x1c5)),tgBot[_0x2e09ee(0x17e)](_0x51b1b0[_0x2e09ee(0x334)]['id'],_0x2e09ee(0x306),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':'Alerts','callback_data':_0x2e09ee(0x2c3)},{'text':'All','callback_data':_0x2e09ee(0x158)}]]}})[_0x2e09ee(0x2b9)](_0x20e74c=>{telegramError(_0x20e74c);}),tgBot['on'](_0x2e09ee(0x1c5),async _0x32ef98=>{const _0x4a282b=_0x2e09ee,_0x49bb39=_0x32ef98[_0x4a282b(0x2e9)],_0x2f675a=_0x32ef98['message'];tgBot['answerCallbackQuery'](_0x32ef98['id'])[_0x4a282b(0x216)](async()=>{const _0x5628ff=_0x4a282b;_0x49bb39==_0x5628ff(0x1c3)&&(updateSetting(_0x5628ff(0x23c),_0x5628ff(0x1c3)),updateSetting(_0x5628ff(0x180),!![]),await tgBot[_0x5628ff(0x17e)](_0x2f675a[_0x5628ff(0x334)]['id'],_0x5628ff(0x2a3))[_0x5628ff(0x2b9)](_0x24f72e=>{telegramError(_0x24f72e);}));_0x49bb39==_0x5628ff(0x2c3)&&(updateSetting(_0x5628ff(0x23c),_0x5628ff(0x2c3)),updateSetting(_0x5628ff(0x180),!![]),await tgBot[_0x5628ff(0x17e)](_0x2f675a[_0x5628ff(0x334)]['id'],_0x5628ff(0x1fe))[_0x5628ff(0x2b9)](_0x2030f6=>{telegramError(_0x2030f6);}));_0x49bb39=='all'&&(updateSetting(_0x5628ff(0x23c),'all'),updateSetting(_0x5628ff(0x180),!![]),await tgBot[_0x5628ff(0x17e)](_0x2f675a['chat']['id'],_0x5628ff(0x2f1))[_0x5628ff(0x2b9)](_0x181fdf=>{telegramError(_0x181fdf);}));if(!settings[_0x5628ff(0x287)])tgBot[_0x5628ff(0x17e)](_0x2f675a[_0x5628ff(0x334)]['id'],_0x5628ff(0x16f))[_0x5628ff(0x2b9)](_0x2b8a9c=>{telegramError(_0x2b8a9c);});}),tgBot[_0x4a282b(0x332)](_0x4a282b(0x1c5));});}),tgBot['onText'](/\/status/,_0x374e22=>{const _0x19128a=_0x381e75;if(!validateTelegram(_0x374e22))return;const _0x5e5ea4=getBotsWithMode();let _0x1945f0='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x81b95b=>{const _0x3761f7=_0x1a51,_0x4dac9c=_0x5e5ea4['find'](_0x47bafe=>_0x47bafe['botID']==_0x81b95b[_0x3761f7(0x19e)])[_0x3761f7(0x15e)];_0x1945f0+='Bot\x20'+_0x81b95b['botID']+':\x20'+_0x81b95b[_0x3761f7(0x293)]+_0x3761f7(0x1ca)+_0x4dac9c+_0x3761f7(0x1ca)+_0x81b95b['live']+'\x0a';}),_0x1945f0+='\x0a',_0x1945f0+=_0x19128a(0x2cf),_0x1945f0+=!settings[_0x19128a(0x180)]?_0x19128a(0x310):_0x19128a(0x212),_0x1945f0+=settings['telegramEnabled']?settings[_0x19128a(0x23c)]==_0x19128a(0x158)?_0x19128a(0x2a8):_0x19128a(0x183)+settings[_0x19128a(0x23c)]+_0x19128a(0x268):'',tgBot['sendMessage'](_0x374e22[_0x19128a(0x334)]['id'],_0x1945f0,{'parse_mode':_0x19128a(0x286)})[_0x19128a(0x2b9)](_0x467eea=>{telegramError(_0x467eea);});}),tgBot[_0x381e75(0x2ae)](/\/restart/,_0x3782c3=>{const _0x314317=_0x381e75;if(!validateTelegram(_0x3782c3))return;tgBot['removeListener'](_0x314317(0x1c5));const _0xa22bea=getEnabledBots();if(_0xa22bea[_0x314317(0x2d9)]==0x0)tgBot[_0x314317(0x17e)](_0x3782c3[_0x314317(0x334)]['id'],_0x314317(0x29d))[_0x314317(0x2b9)](_0x28ca76=>{telegramError(_0x28ca76);});else{if(_0xa22bea['length']>0x1)_0xa22bea[_0x314317(0x323)]({'botID':_0x314317(0x158)});let _0x95be50=[],_0x3886f6=[];const _0x46c4d6=_0xa22bea[_0x314317(0x2d9)]%0x4==0x0||_0xa22bea[_0x314317(0x2d9)]%0x4==0x3||_0xa22bea[_0x314317(0x2d9)]%0x3==0x1?0x4:0x3;let _0x3aedff=0x0;_0xa22bea['forEach']((_0x4842a5,_0x4c92e4)=>{const _0x42331b=_0x314317;if(_0x4c92e4%_0x46c4d6==0x0)_0x3886f6=[];_0x3886f6[_0x42331b(0x323)]({'text':_0x4842a5[_0x42331b(0x19e)]==_0x42331b(0x158)?_0x42331b(0x177):_0x42331b(0x1ac)+_0x4842a5[_0x42331b(0x19e)],'callback_data':_0x4842a5[_0x42331b(0x19e)]}),_0x4c92e4%_0x46c4d6==0x0&&(_0x95be50[_0x3aedff]=_0x3886f6,_0x3aedff++);}),tgBot[_0x314317(0x17e)](_0x3782c3[_0x314317(0x334)]['id'],_0x314317(0x2eb),{'reply_markup':{'inline_keyboard':_0x95be50}})[_0x314317(0x2b9)](_0x34d4e4=>{telegramError(_0x34d4e4);}),tgBot['on'](_0x314317(0x1c5),async _0x29381f=>{const _0x239344=_0x314317,_0x31b5c5=_0x29381f[_0x239344(0x2e9)],_0x1f2206=_0x29381f[_0x239344(0x1d1)];tgBot[_0x239344(0x1d2)](_0x29381f['id'])[_0x239344(0x216)](async()=>{const _0x20de45=_0x239344;_0x31b5c5==_0x20de45(0x158)?config['forEach'](_0x5a1802=>{restartBot(_0x5a1802['botID']);}):restartBot(_0x31b5c5);}),tgBot['removeListener'](_0x239344(0x1c5));});}}),tgBot[_0x381e75(0x2ae)](/\/on/,_0x1339e2=>{const _0x5c4c7e=_0x381e75;if(!validateTelegram(_0x1339e2))return;tgBot[_0x5c4c7e(0x332)]('callback_query');const _0x47a5ca=getDisabledBots();if(_0x47a5ca[_0x5c4c7e(0x2d9)]==0x0)tgBot[_0x5c4c7e(0x17e)](_0x1339e2[_0x5c4c7e(0x334)]['id'],_0x5c4c7e(0x30b))['catch'](_0x2167fe=>{telegramError(_0x2167fe);});else{if(_0x47a5ca['length']>0x1)_0x47a5ca[_0x5c4c7e(0x323)]({'botID':_0x5c4c7e(0x158)});let _0x419491=[],_0x1da78a=[];const _0x182173=_0x47a5ca[_0x5c4c7e(0x2d9)]%0x4==0x0||_0x47a5ca['length']%0x4==0x3||_0x47a5ca[_0x5c4c7e(0x2d9)]%0x3==0x1?0x4:0x3;let _0x227911=0x0;_0x47a5ca[_0x5c4c7e(0x2de)]((_0x515a17,_0x3d85e8)=>{const _0x5bc964=_0x5c4c7e;if(_0x3d85e8%_0x182173==0x0)_0x1da78a=[];_0x1da78a[_0x5bc964(0x323)]({'text':_0x515a17[_0x5bc964(0x19e)]==_0x5bc964(0x158)?'All\x20bots':_0x5bc964(0x1ac)+_0x515a17[_0x5bc964(0x19e)],'callback_data':_0x515a17['botID']}),_0x3d85e8%_0x182173==0x0&&(_0x419491[_0x227911]=_0x1da78a,_0x227911++);}),tgBot[_0x5c4c7e(0x17e)](_0x1339e2[_0x5c4c7e(0x334)]['id'],_0x5c4c7e(0x15a),{'reply_markup':{'inline_keyboard':_0x419491}})[_0x5c4c7e(0x2b9)](_0x1630d1=>{telegramError(_0x1630d1);}),tgBot['on']('callback_query',async _0x4edb44=>{const _0x261dda=_0x5c4c7e,_0x4dbf6a=_0x4edb44[_0x261dda(0x2e9)],_0x3f8981=_0x4edb44[_0x261dda(0x1d1)];tgBot[_0x261dda(0x1d2)](_0x4edb44['id'])[_0x261dda(0x216)](async()=>{const _0x3f9cef=_0x261dda;_0x4dbf6a==_0x3f9cef(0x158)?(tgBot[_0x3f9cef(0x17e)](_0x3f8981[_0x3f9cef(0x334)]['id'],_0x3f9cef(0x184))[_0x3f9cef(0x2b9)](_0xa76f4b=>{telegramError(_0xa76f4b);}),_0x47a5ca[_0x3f9cef(0x2de)](_0x4346e1=>{const _0x18f9f6=_0x3f9cef;if(_0x4346e1[_0x18f9f6(0x19e)]!=_0x18f9f6(0x158))toggleBot(_0x4346e1['botID'],toggleStatus(_0x4346e1[_0x18f9f6(0x19e)]),_0x18f9f6(0x267));})):(tgBot['sendMessage'](_0x3f8981['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4dbf6a)[_0x3f9cef(0x2b9)](_0x42e4c3=>{telegramError(_0x42e4c3);}),toggleBot(_0x4dbf6a,toggleStatus(_0x4dbf6a),_0x3f9cef(0x267)));}),tgBot[_0x261dda(0x332)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x1800c6=>{const _0x173498=_0x381e75;if(!validateTelegram(_0x1800c6))return;tgBot[_0x173498(0x332)](_0x173498(0x1c5));const _0x411051=getEnabledBots();if(_0x411051[_0x173498(0x2d9)]==0x0)tgBot[_0x173498(0x17e)](_0x1800c6['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x15f181=>{telegramError(_0x15f181);});else{if(_0x411051[_0x173498(0x2d9)]>0x1)_0x411051[_0x173498(0x323)]({'botID':_0x173498(0x158)});let _0x2fccb7=[],_0x4a6026=[];const _0x224676=_0x411051[_0x173498(0x2d9)]%0x4==0x0||_0x411051[_0x173498(0x2d9)]%0x4==0x3||_0x411051[_0x173498(0x2d9)]%0x3==0x1?0x4:0x3;let _0x187345=0x0;_0x411051[_0x173498(0x2de)]((_0x4f4f1b,_0x56baf8)=>{const _0x3f8ff1=_0x173498;if(_0x56baf8%_0x224676==0x0)_0x4a6026=[];_0x4a6026['push']({'text':_0x4f4f1b[_0x3f8ff1(0x19e)]==_0x3f8ff1(0x158)?'All\x20bots':_0x3f8ff1(0x1ac)+_0x4f4f1b[_0x3f8ff1(0x19e)],'callback_data':_0x4f4f1b[_0x3f8ff1(0x19e)]}),_0x56baf8%_0x224676==0x0&&(_0x2fccb7[_0x187345]=_0x4a6026,_0x187345++);}),tgBot[_0x173498(0x17e)](_0x1800c6[_0x173498(0x334)]['id'],_0x173498(0x296),{'reply_markup':{'inline_keyboard':_0x2fccb7}})[_0x173498(0x2b9)](_0x3ba474=>{telegramError(_0x3ba474);}),tgBot['on'](_0x173498(0x1c5),async _0x317701=>{const _0x53313e=_0x173498,_0x572e9a=_0x317701[_0x53313e(0x2e9)],_0x52532f=_0x317701['message'];tgBot[_0x53313e(0x1d2)](_0x317701['id'])[_0x53313e(0x216)](async()=>{const _0x284650=_0x53313e;_0x572e9a=='all'?(tgBot[_0x284650(0x17e)](_0x52532f['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x284650(0x2b9)](_0x6ff4f4=>{telegramError(_0x6ff4f4);}),_0x411051[_0x284650(0x2de)](_0xae6590=>{const _0x1dbdb4=_0x284650;if(_0xae6590['botID']!=_0x1dbdb4(0x158))toggleBot(_0xae6590[_0x1dbdb4(0x19e)],toggleStatus(_0xae6590[_0x1dbdb4(0x19e)]),'stopped');})):(tgBot['sendMessage'](_0x52532f[_0x284650(0x334)]['id'],_0x284650(0x284)+_0x572e9a)[_0x284650(0x2b9)](_0x3a70c8=>{telegramError(_0x3a70c8);}),toggleBot(_0x572e9a,toggleStatus(_0x572e9a),_0x284650(0x267)));}),tgBot[_0x53313e(0x332)](_0x53313e(0x1c5));});}}),tgBot[_0x381e75(0x2ae)](/\/metrics/,_0x1dc9ad=>{const _0x1a1a34=_0x381e75;if(!validateTelegram(_0x1dc9ad))return;tgBot[_0x1a1a34(0x332)](_0x1a1a34(0x1c5));const _0x235234=getEnabledBots();if(_0x235234['length']==0x0)tgBot[_0x1a1a34(0x17e)](_0x1dc9ad[_0x1a1a34(0x334)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x1a1a34(0x2b9)](_0x2407e9=>{telegramError(_0x2407e9);});else{if(_0x235234[_0x1a1a34(0x2d9)]>0x1){let _0x27827c=[],_0x4cf99c=[];const _0x42ad31=_0x235234[_0x1a1a34(0x2d9)]%0x4==0x0||_0x235234[_0x1a1a34(0x2d9)]%0x4==0x3||_0x235234[_0x1a1a34(0x2d9)]%0x3==0x1?0x4:0x3;let _0x21e6e8=0x0;_0x235234[_0x1a1a34(0x2de)]((_0x11f668,_0x428f63)=>{const _0x151655=_0x1a1a34;if(_0x428f63%_0x42ad31==0x0)_0x4cf99c=[];_0x4cf99c['push']({'text':_0x151655(0x1ac)+_0x11f668[_0x151655(0x19e)],'callback_data':_0x11f668['botID']}),_0x428f63%_0x42ad31==0x0&&(_0x27827c[_0x21e6e8]=_0x4cf99c,_0x21e6e8++);}),tgBot[_0x1a1a34(0x17e)](_0x1dc9ad[_0x1a1a34(0x334)]['id'],_0x1a1a34(0x313),{'reply_markup':{'inline_keyboard':_0x27827c}})[_0x1a1a34(0x2b9)](_0x8167ba=>{telegramError(_0x8167ba);}),tgBot['on'](_0x1a1a34(0x1c5),async _0x29b188=>{const _0x3abf71=_0x1a1a34,_0x2c69a7=_0x29b188['data'],_0x513a23=_0x29b188[_0x3abf71(0x1d1)];tgBot['answerCallbackQuery'](_0x29b188['id'])['then'](async()=>{const _0x33c019=_0x3abf71;if(pid[_0x2c69a7])pid[_0x2c69a7][_0x33c019(0x27c)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x3abf71(0x332)](_0x3abf71(0x1c5));});}else{const _0xec566=_0x235234[0x0][_0x1a1a34(0x19e)];if(pid[_0xec566])pid[_0xec566][_0x1a1a34(0x27c)]({'function':_0x1a1a34(0x2bd),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x4445e8=>{const _0x571599=_0x381e75;if(!validateTelegram(_0x4445e8))return;tgBot[_0x571599(0x332)](_0x571599(0x1c5));const _0x2b4d61=getEnabledBots();if(_0x2b4d61[_0x571599(0x2d9)]==0x0)tgBot['sendMessage'](_0x4445e8[_0x571599(0x334)]['id'],_0x571599(0x29d))['catch'](_0x3dc940=>{telegramError(_0x3dc940);});else{if(_0x2b4d61[_0x571599(0x2d9)]>0x1){let _0x340477=[],_0x4d3b51=[];const _0x45fafe=_0x2b4d61[_0x571599(0x2d9)]%0x4==0x0||_0x2b4d61[_0x571599(0x2d9)]%0x4==0x3||_0x2b4d61[_0x571599(0x2d9)]%0x3==0x1?0x4:0x3;let _0x33cf81=0x0;_0x2b4d61[_0x571599(0x2de)]((_0x4f49d1,_0x173d05)=>{const _0x1dce4f=_0x571599;if(_0x173d05%_0x45fafe==0x0)_0x4d3b51=[];_0x4d3b51[_0x1dce4f(0x323)]({'text':_0x1dce4f(0x1ac)+_0x4f49d1[_0x1dce4f(0x19e)],'callback_data':_0x4f49d1[_0x1dce4f(0x19e)]}),_0x173d05%_0x45fafe==0x0&&(_0x340477[_0x33cf81]=_0x4d3b51,_0x33cf81++);}),tgBot['sendMessage'](_0x4445e8[_0x571599(0x334)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x340477}})['catch'](_0xa9842d=>{telegramError(_0xa9842d);}),tgBot['on'](_0x571599(0x1c5),async _0x145843=>{const _0x2b89c9=_0x571599,_0x3c3aa0=_0x145843[_0x2b89c9(0x2e9)],_0x35f31b=_0x145843[_0x2b89c9(0x1d1)];tgBot['answerCallbackQuery'](_0x145843['id'])[_0x2b89c9(0x216)](async()=>{const _0x40f638=_0x2b89c9;if(pid[_0x3c3aa0])pid[_0x3c3aa0][_0x40f638(0x27c)]({'function':_0x40f638(0x324),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x4f853a=_0x2b4d61[0x0][_0x571599(0x19e)];if(pid[_0x4f853a])pid[_0x4f853a][_0x571599(0x27c)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['onText'](/\/update/,async _0x208982=>{const _0x359afb=_0x381e75;if(!validateTelegram(_0x208982))return;tgBot['removeListener']('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x359afb(0x17e)](_0x208982[_0x359afb(0x334)]['id'],_0x359afb(0x28e))['catch'](_0x333b9c=>{telegramError(_0x333b9c);});else!validInstallation?tgBot['sendMessage'](_0x208982['chat']['id'],_0x359afb(0x1ae))[_0x359afb(0x2b9)](_0x3d4edc=>{telegramError(_0x3d4edc);}):(tgBot[_0x359afb(0x17e)](_0x208982[_0x359afb(0x334)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x359afb(0x188),'callback_data':_0x359afb(0x285)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x29e063=>{telegramError(_0x29e063);}),tgBot['on'](_0x359afb(0x1c5),async _0x195bb3=>{const _0x1c7f22=_0x359afb,_0x5742d9=_0x195bb3[_0x1c7f22(0x2e9)],_0x1b2a01=_0x195bb3[_0x1c7f22(0x1d1)];tgBot[_0x1c7f22(0x1d2)](_0x195bb3['id'])[_0x1c7f22(0x216)](async()=>{const _0x4c9c2f=_0x1c7f22;_0x5742d9==_0x4c9c2f(0x285)&&(await tgBot[_0x4c9c2f(0x17e)](_0x1b2a01[_0x4c9c2f(0x334)]['id'],_0x4c9c2f(0x1f1))[_0x4c9c2f(0x2b9)](_0xdf18f6=>{telegramError(_0xdf18f6);}),updateBB(_0x4c9c2f(0x215))),_0x5742d9=='no'&&await tgBot['sendMessage'](_0x1b2a01[_0x4c9c2f(0x334)]['id'],_0x4c9c2f(0x2f8))['catch'](_0x18f88c=>{telegramError(_0x18f88c);});}),tgBot[_0x1c7f22(0x332)](_0x1c7f22(0x1c5));}));}),tgBot[_0x381e75(0x2ae)](/\/reinstall/,async _0x5316b3=>{const _0x4d8f9b=_0x381e75;if(!validateTelegram(_0x5316b3))return;tgBot['removeListener']('callback_query'),!validInstallation?tgBot[_0x4d8f9b(0x17e)](_0x5316b3[_0x4d8f9b(0x334)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x4d8f9b(0x2b9)](_0x496b4d=>{telegramError(_0x496b4d);}):(tgBot[_0x4d8f9b(0x17e)](_0x5316b3[_0x4d8f9b(0x334)]['id'],_0x4d8f9b(0x32a),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x4d8f9b(0x285)},{'text':'No','callback_data':'no'}]]}})[_0x4d8f9b(0x2b9)](_0x457397=>{telegramError(_0x457397);}),tgBot['on'](_0x4d8f9b(0x1c5),async _0x39e0be=>{const _0x291dae=_0x4d8f9b,_0x1542d7=_0x39e0be[_0x291dae(0x2e9)],_0x3def92=_0x39e0be[_0x291dae(0x1d1)];tgBot[_0x291dae(0x1d2)](_0x39e0be['id'])[_0x291dae(0x216)](async()=>{const _0x4ee242=_0x291dae;_0x1542d7==_0x4ee242(0x285)&&(await tgBot['sendMessage'](_0x3def92[_0x4ee242(0x334)]['id'],_0x4ee242(0x1a0))[_0x4ee242(0x2b9)](_0x53f663=>{telegramError(_0x53f663);}),updateBB(_0x4ee242(0x18a))),_0x1542d7=='no'&&await tgBot[_0x4ee242(0x17e)](_0x3def92[_0x4ee242(0x334)]['id'],_0x4ee242(0x226))[_0x4ee242(0x2b9)](_0x4adbdf=>{telegramError(_0x4adbdf);});}),tgBot[_0x291dae(0x332)](_0x291dae(0x1c5));}));}),tgBot[_0x381e75(0x2ae)](/\/toggle/,_0x3b2f8f=>{const _0x3ddd00=_0x381e75;if(!validateTelegram(_0x3b2f8f))return;tgBot[_0x3ddd00(0x332)](_0x3ddd00(0x1c5));const _0x17c43a=getBotsWithMode();if(_0x17c43a[_0x3ddd00(0x2d9)]==0x0)tgBot[_0x3ddd00(0x17e)](_0x3b2f8f[_0x3ddd00(0x334)]['id'],_0x3ddd00(0x29d))['catch'](_0x5a2c3b=>{telegramError(_0x5a2c3b);});else{let _0x5e14d9=[],_0x3d662c=[];const _0x1c051c=0x2;let _0x149e74=0x0;_0x17c43a['forEach']((_0x408952,_0x1de905)=>{const _0x3ec46b=_0x3ddd00;if(_0x1de905%_0x1c051c==0x0)_0x3d662c=[];_0x3d662c[_0x3ec46b(0x323)]({'text':_0x3ec46b(0x1ac)+_0x408952[_0x3ec46b(0x19e)]+'\x20('+_0x408952[_0x3ec46b(0x15e)]+')','callback_data':_0x408952[_0x3ec46b(0x19e)]}),_0x1de905%_0x1c051c==0x0&&(_0x5e14d9[_0x149e74]=_0x3d662c,_0x149e74++);}),tgBot['sendMessage'](_0x3b2f8f['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x5e14d9}})[_0x3ddd00(0x2b9)](_0x3987c3=>{telegramError(_0x3987c3);}),tgBot['on']('callback_query',async _0x4ce4db=>{const _0x37dcc9=_0x3ddd00,_0x52d870=_0x4ce4db[_0x37dcc9(0x2e9)],_0x3b4307=_0x4ce4db[_0x37dcc9(0x1d1)];tgBot[_0x37dcc9(0x1d2)](_0x4ce4db['id'])[_0x37dcc9(0x216)](async()=>{const _0x1dd984=_0x37dcc9,_0x37d733=_0x17c43a['find'](_0x4927ad=>_0x4927ad[_0x1dd984(0x19e)]==_0x52d870),_0x19cb71=_0x37d733['mode']==_0x1dd984(0x232)?_0x1dd984(0x1f8):_0x1dd984(0x232);tgBot[_0x1dd984(0x17e)](_0x3b4307[_0x1dd984(0x334)]['id'],_0x1dd984(0x2c2)+_0x52d870+_0x1dd984(0x18e)+_0x19cb71+_0x1dd984(0x1af))[_0x1dd984(0x2b9)](_0xfc2aa=>{telegramError(_0xfc2aa);}),toggleBotMode(_0x52d870);}),tgBot[_0x37dcc9(0x332)](_0x37dcc9(0x1c5));});}}),tgBot['onText'](/\/names/,_0x2b9108=>{const _0x3c0dff=_0x381e75;if(!validateTelegram(_0x2b9108))return;let _0x4ef749='';config['forEach'](_0xe0b05f=>{const _0x120904=_0x1a51;_0x4ef749+=_0x120904(0x1ac)+_0xe0b05f[_0x120904(0x19e)]+':\x20'+_0xe0b05f[_0x120904(0x234)]+'\x0a';}),tgBot[_0x3c0dff(0x17e)](_0x2b9108['chat']['id'],_0x4ef749,{'parse_mode':_0x3c0dff(0x286)})['catch'](_0x1bfd7d=>{telegramError(_0x1bfd7d);});}),tgBot[_0x381e75(0x2ae)](/\/disable/,_0x11885f=>{const _0x3f4654=_0x381e75;if(!validateTelegram(_0x11885f))return;tgBot['sendMessage'](_0x11885f[_0x3f4654(0x334)]['id'],_0x3f4654(0x31c))[_0x3f4654(0x2b9)](_0x244384=>{telegramError(_0x244384);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x381e75(0x2ae)](/\/help/,_0x185db0=>{const _0x25c46e=_0x381e75;if(!validateTelegram(_0x185db0))return;tgBot[_0x25c46e(0x17e)](_0x185db0['chat']['id'],_0x2d6d3a)[_0x25c46e(0x2b9)](_0x5d2b7e=>{telegramError(_0x5d2b7e);});}),tgBot['on'](_0x381e75(0x32e),_0x12a1e3=>{const _0x4c9214=_0x381e75;_0x12a1e3['toString']()[_0x4c9214(0x23d)](_0x4c9214(0x1eb))&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x4c9214(0x1b5)](),tgBot=null,io['to'](_0x4c9214(0x222))[_0x4c9214(0x29b)](_0x4c9214(0x190),_0x4c9214(0x21c)));}),process[_0x381e75(0x176)](_0x381e75(0x1a2),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x381e75(0x176)](_0x381e75(0x193),()=>{const _0x367158=_0x381e75;if(tgBot)tgBot['stopPolling']();process[_0x367158(0x2c8)](0x1);});}}function disableTelegram(){const _0x202370=_0x2f2667;tgBot&&(tgBot[_0x202370(0x1b5)](),tgBot=null);}function sendTelegram(_0x6ada54,_0x304eb4){const _0x4fc8d8=_0x2f2667;if(settings[_0x4fc8d8(0x180)]){if(settings['telegramEvents']=='all'||(_0x304eb4[_0x4fc8d8(0x15c)]==_0x4fc8d8(0x2b1)||_0x304eb4[_0x4fc8d8(0x15c)]=='warning'||_0x304eb4[_0x4fc8d8(0x15c)]==_0x4fc8d8(0x30f))&&settings[_0x4fc8d8(0x23c)]==_0x4fc8d8(0x2c3)||_0x304eb4[_0x4fc8d8(0x15c)]==_0x4fc8d8(0x207)&&settings[_0x4fc8d8(0x23c)]==_0x4fc8d8(0x1c3)){if(tgBot&&settings[_0x4fc8d8(0x287)]){if(_0x304eb4[_0x4fc8d8(0x195)])tgBot[_0x4fc8d8(0x17e)](settings[_0x4fc8d8(0x287)],_0x304eb4[_0x4fc8d8(0x234)]+'\x20>\x20'+_0x304eb4['event'])[_0x4fc8d8(0x2b9)](_0x16f35d=>{telegramError(_0x16f35d);});else tgBot['sendMessage'](settings[_0x4fc8d8(0x287)],_0x4fc8d8(0x1ac)+_0x6ada54+_0x4fc8d8(0x1e4)+_0x304eb4['event'])['catch'](_0x46d487=>{telegramError(_0x46d487);});}}}}async function sendTelegramMsg(_0x23599d,_0x5efb1f=_0x2f2667(0x286)){const _0x59dd21=_0x2f2667;return settings[_0x59dd21(0x180)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x59dd21(0x17e)](settings['telegramChatId'],_0x23599d,{'parse_mode':_0x5efb1f})[_0x59dd21(0x2b9)](_0x9a2c21=>{telegramError(_0x9a2c21);}),!![]):![];}function getDeviceWithIp(_0x4c8835){const _0x25accf=_0x2f2667;return devices[_0x25accf(0x336)](_0x506cf9=>_0x506cf9['ip']===_0x4c8835);}function temporaryAccess2FA(_0x56e980,_0x135b7e){const _0x5805a5=_0x2f2667;let _0x137a16=new Date(),_0x150935=![];if(lastIpApproval){if(_0x137a16-lastIpApproval<0x1388)_0x150935=!![];}lastIpApproval=new Date();if(_0x150935)return;tgBot&&settings[_0x5805a5(0x287)]&&(tgBot[_0x5805a5(0x332)](_0x5805a5(0x1c5)),tgBot[_0x5805a5(0x17e)](settings[_0x5805a5(0x287)],_0x5805a5(0x32b)+normalizeIP(_0x135b7e)[_0x5805a5(0x220)]+_0x5805a5(0x288),{'parse_mode':_0x5805a5(0x286),'reply_markup':{'inline_keyboard':[[{'text':_0x5805a5(0x17a),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x5805a5(0x168),'callback_data':'30'},{'text':_0x5805a5(0x241),'callback_data':_0x5805a5(0x241)}]]}})[_0x5805a5(0x2b9)](_0x21228c=>{telegramError(_0x21228c);}),tgBot['on'](_0x5805a5(0x1c5),async _0x2e915e=>{const _0x1e384e=_0x5805a5,_0x568b02=_0x2e915e[_0x1e384e(0x2e9)],_0x292ed1=_0x2e915e[_0x1e384e(0x1d1)];tgBot['answerCallbackQuery'](_0x2e915e['id'])[_0x1e384e(0x216)](async()=>{const _0x594101=_0x1e384e;devices[_0x56e980]['telegramIpApproval']={'clientip':_0x135b7e,'timestamp':new Date()['getTime'](),'expiry':_0x568b02},_0x568b02!=_0x594101(0x241)?(await tgBot[_0x594101(0x17e)](_0x292ed1['chat']['id'],_0x594101(0x210)+_0x568b02+'\x20minutes',{'parse_mode':'HTML'})['catch'](_0x146c47=>{telegramError(_0x146c47);}),io['to'](_0x56e980)[_0x594101(0x29b)]('status',{'access':{'allow':![],'reason':_0x594101(0x163),'token':null}})):(await tgBot[_0x594101(0x17e)](_0x292ed1[_0x594101(0x334)]['id'],_0x594101(0x308))['catch'](_0x35aa02=>{telegramError(_0x35aa02);}),io['to'](_0x56e980)['emit'](_0x594101(0x293),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot['removeListener'](_0x1e384e(0x1c5));}));}function loginAccess2FA(_0x2c10db,_0x230376){const _0x16dd2d=_0x2f2667;tgBot&&settings[_0x16dd2d(0x287)]&&(tgBot[_0x16dd2d(0x332)](_0x16dd2d(0x1c5)),tgBot['sendMessage'](settings[_0x16dd2d(0x287)],_0x16dd2d(0x2c0)+normalizeIP(_0x230376)[_0x16dd2d(0x220)]+_0x16dd2d(0x288),{'parse_mode':_0x16dd2d(0x286),'reply_markup':{'inline_keyboard':[[{'text':_0x16dd2d(0x2be),'callback_data':loginExpiry},{'text':_0x16dd2d(0x241),'callback_data':_0x16dd2d(0x241)}]]}})[_0x16dd2d(0x2b9)](_0x1fcf40=>{telegramError(_0x1fcf40);}),tgBot['on'](_0x16dd2d(0x1c5),async _0x386298=>{const _0x57db05=_0x16dd2d,_0x12375a=_0x386298['data'],_0x59bbf0=_0x386298['message'];tgBot[_0x57db05(0x1d2)](_0x386298['id'])[_0x57db05(0x216)](async()=>{const _0x5c2589=_0x57db05;devices[_0x2c10db][_0x5c2589(0x1cf)]={'clientip':_0x230376,'timestamp':new Date()[_0x5c2589(0x1f5)](),'expiry':_0x12375a},_0x12375a!=_0x5c2589(0x241)?(await tgBot[_0x5c2589(0x17e)](_0x59bbf0['chat']['id'],'Login\x20accepted',{'parse_mode':_0x5c2589(0x286)})['catch'](_0xcea055=>{telegramError(_0xcea055);}),io['to'](_0x2c10db)['emit'](_0x5c2589(0x293),{'access':{'allow':![],'reason':_0x5c2589(0x163),'token':null}})):(await tgBot[_0x5c2589(0x17e)](_0x59bbf0[_0x5c2589(0x334)]['id'],_0x5c2589(0x1f0))['catch'](_0x34e685=>{telegramError(_0x34e685);}),io['to'](_0x2c10db)['emit']('status',{'access':{'allow':![],'reason':_0x5c2589(0x270),'token':null}}));}),tgBot[_0x57db05(0x332)](_0x57db05(0x1c5));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4b863f=_0x2f2667;return dbConfig['get'](_0x4b863f(0x30c))[_0x4b863f(0x156)](_0x4b863f(0x19e))[_0x4b863f(0x2ab)]({'status':_0x4b863f(0x1a6)})[_0x4b863f(0x2a2)]()||[];}function getDisabledBots(){const _0x55996c=_0x2f2667;return dbConfig[_0x55996c(0x33c)](_0x55996c(0x30c))[_0x55996c(0x156)](_0x55996c(0x19e))['filter']({'status':_0x55996c(0x311)})[_0x55996c(0x2a2)]()||[];}function getBotAttributes(_0x3ab847){const _0xc4c736=_0x2f2667;let _0x17c0ef={};const _0x3e127c=configpath+'bot-'+_0x3ab847+_0xc4c736(0x24f),_0x26607b=fs[_0xc4c736(0x2da)](_0x3e127c);if(_0x26607b){const _0x28e39b=fs[_0xc4c736(0x318)](_0x3e127c);try{const _0x17d857=JSON['parse'](_0x28e39b),_0x17642e=_0x17d857?_0x17d857[_0xc4c736(0x252)][0x0][_0xc4c736(0x1f4)]:![];_0x17c0ef[_0xc4c736(0x15e)]=_0x17642e?_0xc4c736(0x232):_0xc4c736(0x1f8),_0x17c0ef['botname']=_0x17d857?_0x17d857[_0xc4c736(0x252)][0x0][_0xc4c736(0x234)]:_0xc4c736(0x1ac)+_0x3ab847;}catch(_0x4171ad){_0x17c0ef[_0xc4c736(0x15e)]=_0xc4c736(0x1f8),_0x17c0ef[_0xc4c736(0x234)]=_0xc4c736(0x1ac)+_0x3ab847;}}else _0x17c0ef[_0xc4c736(0x15e)]=_0xc4c736(0x1f8),_0x17c0ef[_0xc4c736(0x234)]='Bot\x20'+_0x3ab847;return _0x17c0ef;}function getBotsWithMode(){const _0x2acdae=_0x2f2667,_0x94da14=dbConfig[_0x2acdae(0x33c)](_0x2acdae(0x30c))[_0x2acdae(0x156)](_0x2acdae(0x19e))[_0x2acdae(0x2a2)]()||[];return _0x94da14[_0x2acdae(0x2de)](_0x13024c=>{const _0x5d3f54=_0x2acdae;let _0x42b1f4=getBotAttributes(_0x13024c[_0x5d3f54(0x19e)]);_0x13024c[_0x5d3f54(0x15e)]=_0x42b1f4[_0x5d3f54(0x15e)];}),_0x94da14;}function getBotExchanges(){const _0x19f684=_0x2f2667;let _0x8fe23a=[];const _0x537192=dbConfig[_0x19f684(0x33c)](_0x19f684(0x30c))[_0x19f684(0x156)](_0x19f684(0x19e))[_0x19f684(0x2a2)]()||[];_0x537192[_0x19f684(0x2de)](_0x3c95e9=>{const _0x12cf93=_0x19f684;if(_0x3c95e9[_0x12cf93(0x293)]=='enabled'){const _0x49871b=configpath+'bot-'+_0x3c95e9[_0x12cf93(0x19e)]+'-config.json',_0xa8ece1=fs[_0x12cf93(0x2da)](_0x49871b);let _0x1dbb18;if(_0xa8ece1){const _0x30b333=fs['readFileSync'](_0x49871b);try{const _0x3b36e=JSON['parse'](_0x30b333);_0x1dbb18=_0x3b36e?_0x3b36e[_0x12cf93(0x252)][0x0][_0x12cf93(0x179)]:null;}catch(_0x30718e){}}if(_0x1dbb18)_0x8fe23a['push'](_0x1dbb18);}});const _0x42a6cf=[...new Set(_0x8fe23a)][_0x19f684(0x317)]();return _0x42a6cf;}async function initUser(){const _0x5c32aa=_0x2f2667;if(!settings[_0x5c32aa(0x312)]){const _0x4a3f48=uuidRandom();mixpanel['alias'](_0x4a3f48),updateSetting(_0x5c32aa(0x312),_0x4a3f48);}}async function initSecure(){const _0x46a869=_0x2f2667;let _0x575744=getSecure();if(!_0x575744[_0x46a869(0x17f)]('secret')){let _0x2b1529=await generateKeys();_0x575744[_0x46a869(0x291)]=_0x2b1529[_0x46a869(0x291)],_0x575744[_0x46a869(0x259)]=_0x2b1529[_0x46a869(0x259)],_0x575744['secret']=crypto['randomBytes'](0x20)[_0x46a869(0x23e)]('hex');;storeSecure(_0x575744);}}function getSettings(){const _0x1ed85e=_0x2f2667;return dbSettings['get'](_0x1ed85e(0x2d8))[_0x1ed85e(0x2a2)]()||{};}function getSecure(){const _0x35c7f7=_0x2f2667;return dbSecure[_0x35c7f7(0x33c)](_0x35c7f7(0x17d))[_0x35c7f7(0x2a2)]()||{};}function getBlacklist(){const _0x2e5079=_0x2f2667;return dbSecure['get'](_0x2e5079(0x2d3))[_0x2e5079(0x2a2)]()||[];}function broadcastToBots(_0x12a7d7,_0x427380){const _0x52c7b4=_0x2f2667;config[_0x52c7b4(0x2de)](_0x28a68f=>{const _0x478e7d=_0x52c7b4;if(_0x28a68f[_0x478e7d(0x293)]==_0x478e7d(0x1a6)&&_0x28a68f[_0x478e7d(0x254)]=='running'||_0x28a68f[_0x478e7d(0x293)]=='new'&&_0x28a68f['live']==_0x478e7d(0x320)){if(pid[_0x28a68f[_0x478e7d(0x19e)]])pid[_0x28a68f[_0x478e7d(0x19e)]]['send']({[_0x12a7d7]:_0x427380});}});}function storeSettings(_0x1074ef,_0xfb9c71=![]){const _0x4cad3b=_0x2f2667;_0x1074ef={...settings,..._0x1074ef};if(_0xfb9c71&&_0x1074ef[_0x4cad3b(0x1e5)]!=_0x4cad3b(0x2a7)&&_0x1074ef['bbPassword']!=_0x4cad3b(0x1bd)&&_0x1074ef[_0x4cad3b(0x1e5)]!=''){const _0x162324=crypt['decrypt'](secure[_0x4cad3b(0x259)],_0x1074ef[_0x4cad3b(0x1e5)])['message']['split']('@')[0x0],_0x58bb47=bcrypt['hashSync'](_0x162324,saltRounds);_0x1074ef={..._0x1074ef,'bbPassword':_0x58bb47};}if(_0xfb9c71&&_0x1074ef['telegramToken']!=_0x4cad3b(0x2a7)&&_0x1074ef[_0x4cad3b(0x263)]!=_0x4cad3b(0x1bd)&&_0x1074ef[_0x4cad3b(0x263)]!=''){const _0x83bd78=crypt[_0x4cad3b(0x25e)](secure[_0x4cad3b(0x259)],_0x1074ef[_0x4cad3b(0x263)])[_0x4cad3b(0x1d1)][_0x4cad3b(0x162)]('@')[0x0];_0x1074ef={..._0x1074ef,'telegramToken':_0x83bd78};}const _0x44c360=_0x1074ef['telegramToken']!=_0x4cad3b(0x2a7)&&_0x1074ef['telegramToken']!=settings[_0x4cad3b(0x263)]||_0x1074ef[_0x4cad3b(0x25d)]!=settings[_0x4cad3b(0x25d)],_0x5b42be=_0x1074ef[_0x4cad3b(0x263)]==''||_0x1074ef[_0x4cad3b(0x25d)]=='';if(_0x44c360)_0x1074ef['telegramEvents']=_0x4cad3b(0x158);for(const [_0x5e73af,_0x590f87]of Object[_0x4cad3b(0x1ff)](_0x1074ef)){if(_0x5e73af==_0x4cad3b(0x263)&&_0x590f87==_0x4cad3b(0x2a7)){_0x1074ef[_0x4cad3b(0x263)]=settings[_0x4cad3b(0x263)];continue;};if(_0x5e73af==_0x4cad3b(0x1e5)&&_0x590f87==_0x4cad3b(0x2a7)){_0x1074ef[_0x4cad3b(0x1e5)]=settings[_0x4cad3b(0x1e5)];continue;};dbSettings[_0x4cad3b(0x1ab)](_0x4cad3b(0x1bb)+_0x5e73af,_0x590f87)[_0x4cad3b(0x281)]();}settings=_0x1074ef,io['to'](_0x4cad3b(0x222))[_0x4cad3b(0x29b)](_0x4cad3b(0x2d8),cleanSettings()),broadcastToBots(_0x4cad3b(0x19a),settings[_0x4cad3b(0x19a)]),broadcastToBots(_0x4cad3b(0x2dd),settings[_0x4cad3b(0x2dd)]);if(_0x44c360&&!_0x5b42be)initTelegram();if(_0x44c360&&_0x5b42be)disableTelegram();getAllClients()[_0x4cad3b(0x2de)](_0x52b149=>{const _0xd80408=_0x4cad3b;getSocket(_0x52b149['id'])[_0xd80408(0x29b)]('status',{'access':{'allow':![],'reason':_0xd80408(0x163),'token':null}});});}function updateSetting(_0x39a049,_0x1af7df){const _0xffbd10=_0x2f2667;dbSettings[_0xffbd10(0x1ab)]('settings.'+_0x39a049,_0x1af7df)['write'](),settings=getSettings(),io['to'](_0xffbd10(0x222))['emit'](_0xffbd10(0x2d8),cleanSettings());}function storeSecure(_0x40732e){const _0x4ab59f=_0x2f2667;dbSecure[_0x4ab59f(0x33c)](_0x4ab59f(0x17d))[_0x4ab59f(0x323)](_0x40732e)[_0x4ab59f(0x281)](),secure=_0x40732e;}function addBlacklist(_0x2e8ce7){const _0x23db89=_0x2f2667;cleanBlacklist();let _0x4abef3;devices[_0x2e8ce7][_0x23db89(0x28d)]?_0x4abef3=Math[_0x23db89(0x1ef)](devices[_0x2e8ce7][_0x23db89(0x28d)]['expiry'],loginExpiry):_0x4abef3=loginExpiry,dbSecure['get'](_0x23db89(0x2d3))['push']({'expiry':new Date()[_0x23db89(0x1f5)]()+_0x4abef3*0x3c*0x3e8,'token':devices[_0x2e8ce7]['access'][_0x23db89(0x28f)]})[_0x23db89(0x281)](),blacklist=dbSecure['get'](_0x23db89(0x2d3))['value']();}function cleanBlacklist(){const _0x1d8629=_0x2f2667;let _0x4c8e79=dbSecure[_0x1d8629(0x33c)](_0x1d8629(0x2d3))['cloneDeep']()[_0x1d8629(0x2a2)](),_0x34bfd5=new Date()[_0x1d8629(0x1f5)]();_0x4c8e79['forEach'](_0x15546b=>{const _0x284945=_0x1d8629;_0x15546b[_0x284945(0x1ea)]<_0x34bfd5&&dbSecure[_0x284945(0x33c)](_0x284945(0x2d3))[_0x284945(0x321)]({'expiry':_0x15546b['expiry']})['write']();});}function initStates(){const _0x213e2a=_0x2f2667;let _0x3b0144=getConfiguration();_0x3b0144[_0x213e2a(0x2de)](_0xce6f8=>{const _0x2e02fd=_0x213e2a;_0xce6f8[_0x2e02fd(0x254)]=_0x2e02fd(0x267);}),storeConfiguration(_0x3b0144);}function onKeys(){const _0x5239b9=new RSA();return new Promise(_0x2e36cc=>{const _0x39f9f2=_0x1a51;_0x5239b9[_0x39f9f2(0x2f5)]()[_0x39f9f2(0x216)](_0x4f8ba3=>{_0x2e36cc(_0x4f8ba3);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2d29cf=_0x2f2667;let _0x1d64f5=getSettings(),_0x2f2da8=![];!_0x1d64f5['hasOwnProperty'](_0x2d29cf(0x244))&&(_0x1d64f5['lastmsgtelegram']=0x0,_0x2f2da8=!![]);!_0x1d64f5['hasOwnProperty'](_0x2d29cf(0x2f7))&&(_0x1d64f5['lastmsgemitted']=0x0,_0x2f2da8=!![]);!_0x1d64f5[_0x2d29cf(0x17f)](_0x2d29cf(0x2d0))&&(_0x1d64f5[_0x2d29cf(0x2d0)]=_0x2d29cf(0x292),_0x2f2da8=!![]);!_0x1d64f5[_0x2d29cf(0x17f)](_0x2d29cf(0x2dd))&&(_0x1d64f5[_0x2d29cf(0x2dd)]=![],_0x2f2da8=!![]);if(_0x2f2da8)storeSettings(_0x1d64f5);try{fs[_0x2d29cf(0x31f)](configbackuppath,{'withFileTypes':!![]})[_0x2d29cf(0x2de)](_0x47a7d0=>{const _0xcd71fc=_0x2d29cf;if(!_0x47a7d0['isDirectory']()){if(!_0x47a7d0[_0xcd71fc(0x1b2)][_0xcd71fc(0x2d5)](_0xcd71fc(0x331)))fs[_0xcd71fc(0x27d)](configbackuppath+_0x47a7d0[_0xcd71fc(0x1b2)]);}else fs[_0xcd71fc(0x26e)](configbackuppath+_0x47a7d0[_0xcd71fc(0x1b2)],{'recursive':!![]});});}catch(_0x1f4831){logger[_0x2d29cf(0x2b0)](_0x2d29cf(0x17b),_0x1f4831);}}function storeConfiguration(_0x4ba1b6){const _0x10954d=_0x2f2667;dbConfig['get'](_0x10954d(0x30c))[_0x10954d(0x321)]()['write'](),_0x4ba1b6['forEach'](_0x20902e=>{const _0x10ec70=_0x10954d;delete _0x20902e[_0x10ec70(0x15e)];}),dbConfig['get'](_0x10954d(0x30c))[_0x10954d(0x323)](..._0x4ba1b6)[_0x10954d(0x281)](),config=_0x4ba1b6;}function resetPassword(){const _0x1fa8dc=_0x2f2667;tgBot&&settings['telegramChatId']&&(tgBot[_0x1fa8dc(0x332)](_0x1fa8dc(0x1c5)),tgBot[_0x1fa8dc(0x17e)](settings[_0x1fa8dc(0x287)],_0x1fa8dc(0x19b),{'parse_mode':_0x1fa8dc(0x286),'reply_markup':{'inline_keyboard':[[{'text':_0x1fa8dc(0x285),'callback_data':_0x1fa8dc(0x285)},{'text':'no','callback_data':'no'}]]}})[_0x1fa8dc(0x2b9)](_0x2e7220=>{telegramError(_0x2e7220);}),tgBot['on'](_0x1fa8dc(0x1c5),async _0x5ca37d=>{const _0x24a093=_0x1fa8dc,_0x5bf0aa=_0x5ca37d[_0x24a093(0x2e9)],_0x2968aa=_0x5ca37d['message'];tgBot[_0x24a093(0x1d2)](_0x5ca37d['id'])[_0x24a093(0x216)](async()=>{const _0x199e51=_0x24a093;if(_0x5bf0aa!='no'){const _0x488797=0xf,_0x3e6296=_0x199e51(0x19c),_0x1720e3=Array[_0x199e51(0x309)](crypto[_0x199e51(0x279)](new Uint32Array(_0x488797)))[_0x199e51(0x274)](_0xd9ac57=>_0x3e6296[_0xd9ac57%_0x3e6296[_0x199e51(0x2d9)]])['join'](''),_0x402f98=bcrypt[_0x199e51(0x22b)](_0x1720e3,saltRounds);storeSettings({'bbPassword':_0x402f98}),await tgBot['sendMessage'](_0x2968aa[_0x199e51(0x334)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1720e3,{'parse_mode':_0x199e51(0x286)})['catch'](_0x3d7da8=>{telegramError(_0x3d7da8);});}else await tgBot[_0x199e51(0x17e)](_0x2968aa[_0x199e51(0x334)]['id'],_0x199e51(0x333))[_0x199e51(0x2b9)](_0x52c504=>{telegramError(_0x52c504);});}),tgBot[_0x24a093(0x332)]('callback_query');}));}async function confirmRestore(_0x608d37,_0x2cc3b2){const _0x344a9d=_0x2f2667;io['to'](_0x344a9d(0x222))[_0x344a9d(0x29b)](_0x344a9d(0x190),_0x344a9d(0x28b),_0x344a9d(0x30f)),tgBot&&settings[_0x344a9d(0x287)]&&(tgBot['removeListener'](_0x344a9d(0x1c5)),await tgBot['sendMessage'](settings['telegramChatId'],_0x344a9d(0x247),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x344a9d(0x285),'callback_data':_0x344a9d(0x285)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x5e3e46=>{telegramError(_0x5e3e46);}),tgBot['on']('callback_query',async _0x5a5bb9=>{const _0x1fee31=_0x344a9d,_0x25966b=_0x5a5bb9[_0x1fee31(0x2e9)],_0x202a98=_0x5a5bb9[_0x1fee31(0x1d1)];tgBot[_0x1fee31(0x1d2)](_0x5a5bb9['id'])[_0x1fee31(0x216)](async()=>{const _0x9b980c=_0x1fee31;_0x25966b=='yes'?(await tgBot[_0x9b980c(0x17e)](_0x202a98[_0x9b980c(0x334)]['id'],_0x9b980c(0x2c7),{'parse_mode':_0x9b980c(0x286)})[_0x9b980c(0x2b9)](_0x5f2dca=>{telegramError(_0x5f2dca);}),unzipFile(_0x608d37,_0x2cc3b2)):(logger[_0x9b980c(0x2b0)](_0x9b980c(0x27e)),await tgBot[_0x9b980c(0x17e)](_0x202a98[_0x9b980c(0x334)]['id'],'Restore\x20process\x20aborted')['catch'](_0x5ae4fc=>{telegramError(_0x5ae4fc);}));}),tgBot[_0x1fee31(0x332)](_0x1fee31(0x1c5));}));}function getServerTime(){const _0x21e4e7=_0x2f2667,_0x15df1a=new Date();return _0x15df1a['getFullYear']()+'/'+(_0x15df1a['getMonth']()+0x1)[_0x21e4e7(0x23e)]()[_0x21e4e7(0x1e3)](0x2,'0')+'/'+_0x15df1a['getDate']()[_0x21e4e7(0x23e)]()['padStart'](0x2,'0')+'\x20'+_0x15df1a['getHours']()[_0x21e4e7(0x23e)]()[_0x21e4e7(0x1e3)](0x2,'0')+':'+_0x15df1a[_0x21e4e7(0x2db)]()[_0x21e4e7(0x23e)]()[_0x21e4e7(0x1e3)](0x2,'0')+':'+_0x15df1a[_0x21e4e7(0x295)]()[_0x21e4e7(0x23e)]()[_0x21e4e7(0x1e3)](0x2,'0');}function getTimeStamp(){const _0x3e3a0e=_0x2f2667,_0x3ce425=shiftedTime();return _0x3ce425[_0x3e3a0e(0x1fd)]()+'/'+(_0x3ce425[_0x3e3a0e(0x26f)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x3ce425[_0x3e3a0e(0x2fe)]()['toString']()[_0x3e3a0e(0x1e3)](0x2,'0')+'\x20'+_0x3ce425[_0x3e3a0e(0x315)]()['toString']()['padStart'](0x2,'0')+':'+_0x3ce425[_0x3e3a0e(0x2db)]()['toString']()[_0x3e3a0e(0x1e3)](0x2,'0')+':'+_0x3ce425[_0x3e3a0e(0x295)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x367991=_0x2f2667,_0x32af86=shiftedTime();return _0x32af86[_0x367991(0x1fd)]()+(_0x32af86[_0x367991(0x26f)]()+0x1)[_0x367991(0x23e)]()[_0x367991(0x1e3)](0x2,'0')+_0x32af86[_0x367991(0x2fe)]()[_0x367991(0x23e)]()[_0x367991(0x1e3)](0x2,'0')+'-'+_0x32af86[_0x367991(0x315)]()['toString']()[_0x367991(0x1e3)](0x2,'0')+_0x32af86[_0x367991(0x2db)]()['toString']()[_0x367991(0x1e3)](0x2,'0')+_0x32af86[_0x367991(0x295)]()['toString']()[_0x367991(0x1e3)](0x2,'0');}function shiftedTime(){const _0x5d1d4d=_0x2f2667,_0x5ed254=new Date();let _0x5286a9=_0x5ed254;if(settings[_0x5d1d4d(0x19a)]&&settings[_0x5d1d4d(0x19a)]!==0x0)_0x5286a9=fns[_0x5d1d4d(0x256)](_0x5ed254,{'hours':settings[_0x5d1d4d(0x19a)]});return _0x5286a9;}function startScheduler(){const _0x4f6d9e=_0x2f2667,_0x36450b=new Date()['getUTCHours'](),_0x5ced3d=shiftedTime()[_0x4f6d9e(0x315)]();_0x5ced3d==0x4&&backupConfigFiles();_0x5ced3d==0x0&&rotateLogFiles();_0x36450b%0x6==0x0&&triggerAnalytics();_0x36450b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2d9443){const _0x132842=_0x2f2667;logger[_0x132842(0x2b0)](_0x132842(0x178)+_0x2d9443);const _0x2c1632=getBotsWithMode();_0x2c1632[_0x132842(0x2d9)]>0x0?confirmRestore(configbackuppath,_0x2d9443):unzipFile(configbackuppath,_0x2d9443);}async function getBackupFiles(_0x260e58=null){const _0x205608=_0x2f2667;let _0x198088=[],_0x3b859f=fs[_0x205608(0x31f)](configbackuppath,{'withFileTypes':!![]});_0x3b859f[_0x205608(0x317)]((_0x1b2893,_0x486c40)=>_0x1b2893['name']<_0x486c40[_0x205608(0x1b2)]?0x1:_0x486c40[_0x205608(0x1b2)]<_0x1b2893['name']?-0x1:0x0),_0x3b859f[_0x205608(0x2de)](_0x2ea75a=>{const _0x26c213=_0x205608;if(!_0x2ea75a[_0x26c213(0x1b4)]()&&_0x2ea75a['name'][_0x26c213(0x2d5)](_0x26c213(0x331))&&_0x2ea75a[_0x26c213(0x1b2)][_0x26c213(0x1d5)]('.zip')){const _0x3aff68=formatDate(fs['statSync'](configbackuppath+_0x2ea75a[_0x26c213(0x1b2)])['mtime']);_0x198088[_0x26c213(0x323)]({'name':_0x2ea75a[_0x26c213(0x1b2)],'mtime':_0x3aff68});}});if(_0x260e58)io['to'](_0x260e58)[_0x205608(0x29b)]('backup-files',_0x198088);else return _0x198088;}async function backupConfigFiles(){const _0x1569cf=_0x2f2667;await zipFiles(_0x1569cf(0x1a5));const _0x5eb208=getCleanTimeStamp();fs[_0x1569cf(0x22c)](zippath+_0x1569cf(0x2ec),configbackuppath+(_0x1569cf(0x331)+_0x5eb208+'.zip'));let _0x8c3d5b=fs[_0x1569cf(0x31f)](configbackuppath,{'withFileTypes':!![]});_0x8c3d5b[_0x1569cf(0x317)]((_0xe31210,_0x563792)=>_0xe31210[_0x1569cf(0x1b2)]<_0x563792[_0x1569cf(0x1b2)]?0x1:_0x563792[_0x1569cf(0x1b2)]<_0xe31210[_0x1569cf(0x1b2)]?-0x1:0x0),_0x8c3d5b[_0x1569cf(0x2d9)]>maxBackups&&fs[_0x1569cf(0x27d)](configbackuppath+_0x8c3d5b[_0x8c3d5b[_0x1569cf(0x2d9)]-0x1][_0x1569cf(0x1b2)]);}function rotateLogFiles(){const _0x1bea8d=_0x2f2667,_0x246ec0=fs['statSync'](logspath+_0x1bea8d(0x253)),_0x2e1194=_0x246ec0[_0x1bea8d(0x205)]/0x400;if(_0x2e1194>0x64){let _0x451849=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x451849[_0x1bea8d(0x317)]((_0x19238e,_0x1f34e3)=>_0x19238e['name']<_0x1f34e3[_0x1bea8d(0x1b2)]?0x1:_0x1f34e3[_0x1bea8d(0x1b2)]<_0x19238e['name']?-0x1:0x0),_0x451849[_0x1bea8d(0x2de)](_0x1e5984=>{const _0x41b025=_0x1bea8d;if(_0x1e5984[_0x41b025(0x1b2)]==_0x41b025(0x191))fs[_0x41b025(0x22c)](logspath+_0x1e5984[_0x41b025(0x1b2)],logspath+_0x41b025(0x21b));if(_0x1e5984['name']=='output-001.log')fs['copyFileSync'](logspath+_0x1e5984[_0x41b025(0x1b2)],logspath+_0x41b025(0x191));_0x1e5984[_0x41b025(0x1b2)]==_0x41b025(0x253)&&(fs['copyFileSync'](logspath+_0x1e5984['name'],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x1e5984[_0x41b025(0x1b2)],''));});}}async function zipFiles(_0x29d4e5){const _0x1eaecc=_0x2f2667;let _0x1f5147;if(_0x29d4e5==_0x1eaecc(0x2a6))_0x1f5147=logspath;if(_0x29d4e5==_0x1eaecc(0x187))_0x1f5147=configpath;if(_0x29d4e5==_0x1eaecc(0x1a5))_0x1f5147=configpath;let _0x174652=fs[_0x1eaecc(0x31f)](_0x1f5147,{'withFileTypes':!![]});const _0x2fc419=new require(_0x1eaecc(0x1bf))();_0x174652[_0x1eaecc(0x2de)](_0x1f35b7=>{const _0x375a70=_0x1eaecc;if(!_0x1f35b7[_0x375a70(0x1b4)]()){let _0x58acd1=fs[_0x375a70(0x318)](_0x1f5147+_0x1f35b7[_0x375a70(0x1b2)]);if(_0x29d4e5==_0x375a70(0x187)){const _0x2c411e=/^bot-[0-9]{3}-config.json$/,_0x22e924=_0x2c411e[_0x375a70(0x170)](_0x1f35b7['name']);if(_0x22e924){const _0x11689c=JSON[_0x375a70(0x2ef)](_0x58acd1);if(_0x11689c['bot'][0x0]){_0x11689c[_0x375a70(0x252)][0x0][_0x375a70(0x1a3)]='***',_0x11689c[_0x375a70(0x252)][0x0][_0x375a70(0x2c6)]=_0x375a70(0x1bd);if(_0x11689c[_0x375a70(0x252)][0x0]['apiPassword'])_0x11689c[_0x375a70(0x252)][0x0][_0x375a70(0x335)]=_0x375a70(0x1bd);}_0x58acd1=JSON[_0x375a70(0x171)](_0x11689c,null,0x2);}if(_0x1f35b7[_0x375a70(0x1b2)]==_0x375a70(0x2ea)){const _0x211558=JSON[_0x375a70(0x2ef)](_0x58acd1);if(_0x211558[_0x375a70(0x2d8)][_0x375a70(0x32d)])_0x211558[_0x375a70(0x2d8)][_0x375a70(0x32d)]=![];if(_0x211558['settings'][_0x375a70(0x1e5)])_0x211558[_0x375a70(0x2d8)][_0x375a70(0x1e5)]=_0x375a70(0x1bd);if(_0x211558[_0x375a70(0x2d8)][_0x375a70(0x263)])_0x211558[_0x375a70(0x2d8)][_0x375a70(0x263)]='***';if(_0x211558[_0x375a70(0x2d8)][_0x375a70(0x287)])_0x211558[_0x375a70(0x2d8)][_0x375a70(0x287)]=null;_0x58acd1=JSON[_0x375a70(0x171)](_0x211558,null,0x2);}if(_0x1f35b7[_0x375a70(0x1b2)]!=_0x375a70(0x2f2))_0x2fc419[_0x375a70(0x31d)](_0x1f35b7[_0x375a70(0x1b2)],_0x58acd1);}else _0x2fc419['file'](_0x1f35b7['name'],_0x58acd1);}});const _0x59d9ed=_0x2fc419['generate']({'base64':![],'compression':_0x1eaecc(0x209)});fs[_0x1eaecc(0x1d0)](zippath+(_0x29d4e5+_0x1eaecc(0x27f)),_0x59d9ed,_0x1eaecc(0x314));}async function unzipFile(_0x2473f7,_0x4e971f){const _0x43e841=_0x2f2667;fs[_0x43e841(0x31f)](configpath,{'withFileTypes':!![]})[_0x43e841(0x2de)](_0x41c972=>{const _0xd38041=_0x43e841;if(!_0x41c972[_0xd38041(0x1b4)]())fs[_0xd38041(0x26e)](configpath+_0x41c972[_0xd38041(0x1b2)]);});const _0x5b5160=fs[_0x43e841(0x318)](_0x2473f7+_0x4e971f,_0x43e841(0x314)),_0xf5150b=new require(_0x43e841(0x1bf))(_0x5b5160,{'base64':![],'checkCRC32':!![]});Object['keys'](_0xf5150b[_0x43e841(0x236)])[_0x43e841(0x2de)](_0x3e91c9=>{const _0x2ade56=_0x43e841,_0x56abd0=_0xf5150b[_0x2ade56(0x236)][_0x3e91c9];fs[_0x2ade56(0x1d0)](configpath+_0x56abd0[_0x2ade56(0x1b2)],_0x56abd0[_0x2ade56(0x2ac)]);}),fs[_0x43e841(0x31f)](temppath,{'withFileTypes':!![]})['forEach'](_0xa1602d=>{const _0x3cc40b=_0x43e841;if(!_0xa1602d[_0x3cc40b(0x1b4)]())fs[_0x3cc40b(0x26e)](temppath+_0xa1602d[_0x3cc40b(0x1b2)]);}),logger[_0x43e841(0x2b0)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x43e841(0x27c)]({'restore':!![]},_0x31704e=>{});}async function getPublicIp(){const _0x52012e=_0x2f2667;try{const _0x375517=await axios[_0x52012e(0x33c)](_0x52012e(0x2ba));publicip=_0x375517[_0x52012e(0x2e9)]['ip'];}catch(_0x97121){}}async function triggerAnalytics(){const _0x538836=_0x2f2667;if(!publicip)await getPublicIp();const _0x5e3901=getBotsWithMode();let _0x5e98c6=0x0;_0x5e3901[_0x538836(0x2de)](_0x4b6e4d=>{const _0x5bf926=_0x538836;if(_0x4b6e4d['status']===_0x5bf926(0x1a6))_0x5e98c6++;});const _0x548f48=getBotExchanges();mixpanel[_0x538836(0x255)](_0x538836(0x1e0),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x5e3901['length'],'numbotsenabled':_0x5e98c6,'exchanges':_0x548f48,'environment':environment});}async function getMessages(){const _0x2056c1=_0x2f2667,_0x753f0c='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x1d1652=new GraphQLClient(_0x753f0c),_0x4674ca={'authorization':_0x2056c1(0x32f)},_0x5f10ec=serverversion[_0x2056c1(0x162)]('.'),_0x36db5d=_0x5f10ec[0x0]+'.'+_0x5f10ec[0x1],_0xbf5134=Math[_0x2056c1(0x2fd)](settings[_0x2056c1(0x244)],settings['lastmsgemitted']),_0x564009={'last':parseInt(_0xbf5134),'bbm':_0x36db5d},_0x40cde0=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x405bd3;try{_0x405bd3=await _0x1d1652[_0x2056c1(0x1ba)](_0x40cde0,_0x564009,_0x4674ca);}catch(_0x4c352){}if(_0x405bd3&&_0x405bd3['messages']){let _0x5d7003=settings['lastmsgtelegram'];newMessages=[];for(const _0x3661f0 of _0x405bd3[_0x2056c1(0x20a)]){newMessages['push'](_0x3661f0);let _0x17fdb0=![];_0x3661f0[_0x2056c1(0x2e8)]&&(updateSetting(_0x2056c1(0x2d0),_0x3661f0[_0x2056c1(0x2e8)]),_0x17fdb0=isNewerVersion(serverversion,_0x3661f0[_0x2056c1(0x2e8)])||serverversion==_0x3661f0['bbvNew']);if(!_0x17fdb0&&_0x3661f0[_0x2056c1(0x2d4)]>_0x5d7003){if(_0x3661f0[_0x2056c1(0x217)]===_0x2056c1(0x248)||serverversion['startsWith'](_0x3661f0[_0x2056c1(0x217)])){let _0x134a18=''+_0x3661f0[_0x2056c1(0x16d)]+'\x0a\x0a'+_0x3661f0['message'];const _0x1bc981=await sendTelegramMsg(toTelegramMarkdown(_0x134a18),_0x2056c1(0x20d));if(_0x1bc981)_0x5d7003=_0x3661f0[_0x2056c1(0x2d4)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x2056c1(0x244),_0x5d7003),emitMessages();}}function emitMessages(){const _0x1c552c=_0x2f2667,_0x4cfbae=settings[_0x1c552c(0x2f7)];let _0xe53366=[];newMessages[_0x1c552c(0x2de)](_0x1cd17d=>{const _0x5f18ed=_0x1c552c;_0x1cd17d[_0x5f18ed(0x2d4)]>_0x4cfbae&&_0xe53366['push'](_0x1cd17d);}),_0xe53366[_0x1c552c(0x2d9)]>0x0&&getAllClients()[_0x1c552c(0x2de)](_0x5f0c4e=>{const _0x52587c=_0x1c552c;getSocket(_0x5f0c4e['id'])[_0x52587c(0x29b)](_0x52587c(0x1d1),_0xe53366);});}function confirmMessage(_0x550b50){const _0x55a4a7=_0x2f2667;updateSetting(_0x55a4a7(0x2f7),Number(_0x550b50));}function isNewerVersion(_0x59c2d4,_0x42b992){const _0x1d357d=_0x2f2667,_0x4c6e09=_0x42b992[_0x1d357d(0x162)]('.'),_0x1bed3c=_0x59c2d4[_0x1d357d(0x162)]('.');for(var _0x1abb20=0x0;_0x1abb20<_0x1bed3c[_0x1d357d(0x2d9)];_0x1abb20++){const _0x26c743=~~_0x1bed3c[_0x1abb20],_0x146e5e=~~_0x4c6e09[_0x1abb20];if(_0x26c743>_0x146e5e)return!![];if(_0x26c743<_0x146e5e)return![];}return![];}function toTelegramMarkdown(_0x16df2f){const _0x44d520=_0x2f2667,_0x428ef5=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x34958a=/\*{2}(.+?)\*{2}/gim;return _0x16df2f=_0x16df2f[_0x44d520(0x165)](_0x428ef5,_0x44d520(0x1c4))[_0x44d520(0x165)](_0x34958a,_0x44d520(0x17c)),_0x16df2f;}function _0x1a51(_0x40b696,_0x31afd8){const _0x41498b=_0xf4ef();return _0x1a51=function(_0x2f0a18,_0x25b0aa){_0x2f0a18=_0x2f0a18-0x156;let _0xf4efdd=_0x41498b[_0x2f0a18];return _0xf4efdd;},_0x1a51(_0x40b696,_0x31afd8);}async function validateConfigFile(){const _0x297867=_0x2f2667,_0x2337da=dbConfig[_0x297867(0x33c)](_0x297867(0x30c))['sortBy']('botID')['value']()||[];if(_0x2337da[_0x297867(0x2d9)]==0x0){let _0x2b9a13=0x0,_0x396d95=[];const _0x48a729=/^bot-([0-9]{3})-config.json$/,_0x13b515=fs[_0x297867(0x31f)](configpath);_0x13b515[_0x297867(0x2de)](_0x237163=>{const _0x79d3de=_0x297867,_0x13d71f=_0x48a729[_0x79d3de(0x30d)](_0x237163);if(_0x13d71f){const _0x57eee2=_0x13d71f[0x1];let _0x582826=getBotAttributes(_0x57eee2);_0x396d95[_0x79d3de(0x323)]({'botID':_0x57eee2,'botname':_0x582826[_0x79d3de(0x234)],'status':_0x79d3de(0x311),'live':'stopped'}),_0x2b9a13++;}}),_0x2b9a13!=0x0&&(dbConfig[_0x297867(0x33c)](_0x297867(0x30c))['assign'](_0x396d95)[_0x297867(0x281)](),config=_0x396d95,restoredConfigFile=_0x2b9a13);}}async function restoreConfigNotify(_0x206c9c){const _0x18cf6c=_0x2f2667;let _0x1e0648;if(restoredConfigFile==0x1)_0x1e0648=_0x18cf6c(0x2aa);else _0x1e0648=_0x18cf6c(0x2f4);if(_0x206c9c)io['to'](_0x18cf6c(0x222))[_0x18cf6c(0x29b)](_0x18cf6c(0x190),_0x1e0648);else{logger[_0x18cf6c(0x1b6)]('-----------------------------------------------------------------------------------'),logger[_0x18cf6c(0x1b6)](_0x1e0648),logger['simple'](_0x18cf6c(0x322)),logger['simple']('');if(tgBot&&settings[_0x18cf6c(0x287)]&&settings[_0x18cf6c(0x23c)]!=_0x18cf6c(0x1c3))tgBot[_0x18cf6c(0x17e)](settings[_0x18cf6c(0x287)],'Bot\x20Mgr\x20>\x20'+_0x1e0648)[_0x18cf6c(0x2b9)](_0x5bab0b=>{telegramError(_0x5bab0b);});}}function validateCredentials(_0x1a7948,_0x443817){const _0x4b8281=_0x2f2667;if(_0x1a7948[_0x4b8281(0x29a)]==settings[_0x4b8281(0x1c1)]&&bcrypt[_0x4b8281(0x200)](_0x1a7948[_0x4b8281(0x21a)],settings[_0x4b8281(0x1e5)])){if(settings[_0x4b8281(0x28c)])return{'allow':![],'reason':_0x4b8281(0x2cc),'token':null};else{const _0x372fad=generateLoginToken(_0x443817);return{'allow':!![],'reason':_0x4b8281(0x282),'token':_0x372fad};}}else return{'allow':![],'reason':_0x4b8281(0x202),'token':null};}function refreshToken(_0x44c4cf){const _0x5b6e83=_0x2f2667,_0x34e87f=generateLoginToken(_0x44c4cf);return{'allow':!![],'reason':_0x5b6e83(0x282),'token':_0x34e87f};}function validateAccess(_0xc6dd0d,_0xc7645,_0x48df43){const _0x5f0d52=_0x2f2667,_0xec0892=_0x48df43?_0x48df43:devices[_0xc7645]['ip'];let _0x5dc839;const _0x50b965=_0x8359e4=>{const _0x188bf3=_0x1a51;if(settings[_0x188bf3(0x32d)]){if(settings[_0x188bf3(0x28c)]){if(telegram2FaApproved(_0xc7645)){const _0x5be2c8=generateLoginToken(_0xc7645);return{'allow':!![],'reason':_0x188bf3(0x26d),'token':_0x5be2c8};}else return{'allow':![],'reason':_0x188bf3(0x1bc),'token':null};}else return _0x5dc839=validToken(_0x8359e4,_0xc7645),_0x5dc839['hasOwnProperty'](_0x188bf3(0x30f))?{'allow':!![],'reason':_0x188bf3(0x1f7),'token':_0x8359e4}:{'allow':![],'reason':_0x188bf3(0x1bc),'token':null};}else return{'allow':!![],'reason':_0x188bf3(0x192),'token':null};};if(settings[_0x5f0d52(0x1f9)]){let _0x598988=[...settings[_0x5f0d52(0x1a8)],_0x5f0d52(0x166),_0x5f0d52(0x300),_0x5f0d52(0x2ed)];if(_0x598988[_0x5f0d52(0x23d)](_0xec0892))return _0x50b965(_0xc6dd0d);else{_0x5dc839=validToken(_0xc6dd0d,_0xc7645);if(_0x5dc839[_0x5f0d52(0x17f)](_0x5f0d52(0x30f)))return _0x50b965(_0xc6dd0d);else{if(telegramIpApproved(_0xc7645)){const _0x31d0e2=generateToken(_0xc7645);return _0x5dc839=_0x50b965(_0xc6dd0d),_0x5dc839[_0x5f0d52(0x208)]?{'allow':!![],'reason':_0x5f0d52(0x1dd),'token':_0x31d0e2}:_0x5dc839;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x5f0d52(0x275),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x50b965(_0xc6dd0d);}function timelyDecrypt(_0xde14db,_0x36dd0d=!![]){const _0x1e3e50=_0x2f2667;if(_0xde14db)try{const _0x1dd0b6=crypt[_0x1e3e50(0x25e)](secure['privateKey'],_0xde14db)[_0x1e3e50(0x1d1)],_0x37dedb=_0x1dd0b6['split']('@')[0x0],_0x3ccf88=_0x1dd0b6['split']('@')[0x1],_0x3bc8d1=new Date()[_0x1e3e50(0x1f5)]();if(_0x36dd0d){if(_0x3bc8d1-_0x3ccf88<maxSecretAge*0x3e8)return _0x37dedb;else return![];}else return _0x37dedb;}catch(_0x8de8a6){return![];}else return![];}const validToken=(_0x3de128,_0x139380)=>{const _0x5c39de=_0x2f2667,_0x12dde2=devices[_0x139380]['ip'];if(!_0x3de128)return{'error':'No\x20authentication\x20token'};for(let _0x78bf67 of blacklist){if(_0x78bf67['token']==_0x3de128)return{'error':_0x5c39de(0x2fb)};}let _0xdf3081;try{_0xdf3081=jwt[_0x5c39de(0x1d6)](_0x3de128,secure[_0x5c39de(0x1dc)]+_0x139380);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0xdf3081[_0x5c39de(0x17f)](_0x5c39de(0x229))&&!_0xdf3081[_0x5c39de(0x17f)](_0x5c39de(0x29a))||!_0xdf3081['hasOwnProperty'](_0x5c39de(0x22f)))return{'error':_0x5c39de(0x1b8)};if(!_0xdf3081['hasOwnProperty'](_0x5c39de(0x29a))&&_0xdf3081[_0x5c39de(0x17f)](_0x5c39de(0x229))){const {clientip:_0x4406cf}=_0xdf3081;return _0x12dde2==_0x4406cf?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x5c39de(0x175)};}else{if(_0xdf3081[_0x5c39de(0x17f)]('username')&&_0xdf3081[_0x5c39de(0x17f)](_0x5c39de(0x229))){const {username:_0x217429,clientip:_0x5b8e57}=_0xdf3081;return settings[_0x5c39de(0x1c1)]==_0x217429&&_0x12dde2==_0x5b8e57?{'success':_0x5c39de(0x18c)}:{'error':_0x5c39de(0x2f6)};}}},generateLoginToken=_0xa7da2c=>{const _0x414a54=_0x2f2667;if(_0xa7da2c){const _0x35cb02=devices[_0xa7da2c]['ip'];return jwt[_0x414a54(0x1c0)]({'username':settings[_0x414a54(0x1c1)],'clientip':_0x35cb02},secure[_0x414a54(0x1dc)]+_0xa7da2c,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x593065=>{const _0x342f35=_0x2f2667;if(_0x593065){const _0x5f4414=devices[_0x593065]['ip'];return jwt['sign']({'clientip':_0x5f4414},secure[_0x342f35(0x1dc)]+_0x593065,{'expiresIn':devices[_0x593065][_0x342f35(0x28d)][_0x342f35(0x1ea)]*0x3c});}else return![];},telegramIpApproved=_0x313e40=>{const _0x4f9764=_0x2f2667;let _0x6416f3=![];return devices[_0x313e40]['telegramIpApproval']&&devices[_0x313e40][_0x4f9764(0x28d)][_0x4f9764(0x1ea)]!='reject'&&(_0x6416f3=devices[_0x313e40][_0x4f9764(0x28d)]['clientip']==devices[_0x313e40]['ip']&&new Date()[_0x4f9764(0x1f5)]()-devices[_0x313e40][_0x4f9764(0x28d)][_0x4f9764(0x182)]<devices[_0x313e40][_0x4f9764(0x28d)][_0x4f9764(0x1ea)]*0x3c*0x3e8),_0x6416f3;},telegram2FaApproved=_0x2addbd=>{const _0x51f2ea=_0x2f2667;let _0x383dff=![];return devices[_0x2addbd][_0x51f2ea(0x1cf)]&&devices[_0x2addbd][_0x51f2ea(0x1cf)][_0x51f2ea(0x1ea)]!='reject'&&(_0x383dff=devices[_0x2addbd][_0x51f2ea(0x1cf)]['clientip']==devices[_0x2addbd]['ip']&&new Date()['getTime']()-devices[_0x2addbd]['telegram2FaApproval']['timestamp']<devices[_0x2addbd][_0x51f2ea(0x1cf)][_0x51f2ea(0x1ea)]*0x3c*0x3e8),_0x383dff;},normalizeIP=_0x1ddabb=>{const _0x2334a7=_0x2f2667;let _0xa16463=null,_0x4cf1f0=null;if(ipaddr[_0x2334a7(0x2bb)](_0x1ddabb)){const _0x330b5b=ipaddr[_0x2334a7(0x2ef)](_0x1ddabb);_0x330b5b['kind']()===_0x2334a7(0x201)?(_0x330b5b['isIPv4MappedAddress']()&&(_0xa16463=_0x330b5b[_0x2334a7(0x189)]()[_0x2334a7(0x23e)]()),_0x4cf1f0=_0x330b5b['toString']()):(_0xa16463=_0x330b5b[_0x2334a7(0x23e)](),_0x4cf1f0=_0x330b5b['toIPv4MappedAddress']()[_0x2334a7(0x23e)]());}return{'show':_0xa16463?_0xa16463:_0x4cf1f0,'store':_0x4cf1f0};};function formatDate(_0x2a1008){const _0x3174a9=_0x2f2667;return _0x2a1008[_0x3174a9(0x1fd)]()+'/'+(_0x2a1008['getMonth']()+0x1)[_0x3174a9(0x23e)]()[_0x3174a9(0x1e3)](0x2,'0')+'/'+_0x2a1008[_0x3174a9(0x2fe)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2a1008['getHours']()['toString']()[_0x3174a9(0x1e3)](0x2,'0')+':'+_0x2a1008[_0x3174a9(0x2db)]()[_0x3174a9(0x23e)]()[_0x3174a9(0x1e3)](0x2,'0')+':'+_0x2a1008['getSeconds']()[_0x3174a9(0x23e)]()[_0x3174a9(0x1e3)](0x2,'0');}function sleep(_0x107421){return new Promise(_0x289db9=>setTimeout(_0x289db9,_0x107421));}