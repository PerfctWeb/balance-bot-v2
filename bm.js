const _0x43ec7f=_0x2f3c;(function(_0x3e73d1,_0x4a65ab){const _0x180921=_0x2f3c,_0x9e4cc4=_0x3e73d1();while(!![]){try{const _0x3324a9=-parseInt(_0x180921(0x20b))/0x1+parseInt(_0x180921(0x272))/0x2*(parseInt(_0x180921(0x267))/0x3)+parseInt(_0x180921(0x23a))/0x4+parseInt(_0x180921(0x2bd))/0x5+-parseInt(_0x180921(0x2dc))/0x6*(parseInt(_0x180921(0x28d))/0x7)+-parseInt(_0x180921(0x34f))/0x8*(-parseInt(_0x180921(0x208))/0x9)+-parseInt(_0x180921(0x355))/0xa;if(_0x3324a9===_0x4a65ab)break;else _0x9e4cc4['push'](_0x9e4cc4['shift']());}catch(_0xd9d1ff){_0x9e4cc4['push'](_0x9e4cc4['shift']());}}}(_0x5e80,0x315e7));const _0x131ec5=function(){let _0x574c2a=!![];return function(_0x648d4a,_0x360051){const _0x233c60=_0x574c2a?function(){const _0x5ad2da=_0x2f3c;if(_0x360051){const _0x16a828=_0x360051[_0x5ad2da(0x2f6)](_0x648d4a,arguments);return _0x360051=null,_0x16a828;}}:function(){};return _0x574c2a=![],_0x233c60;};}(),_0x1cea0c=_0x131ec5(this,function(){const _0x29f801=_0x2f3c;return _0x1cea0c[_0x29f801(0x1e8)]()[_0x29f801(0x353)](_0x29f801(0x24c))['toString']()['constructor'](_0x1cea0c)[_0x29f801(0x353)](_0x29f801(0x24c));});_0x1cea0c();'use strict';process[_0x43ec7f(0x1d0)][_0x43ec7f(0x252)]=0x1;const childProcess=require(_0x43ec7f(0x28e)),fs=require('fs'),fns=require('date-fns'),low=require(_0x43ec7f(0x1e9)),FileSync=require(_0x43ec7f(0x2cb)),path=require('path'),crypto=require(_0x43ec7f(0x257)),Crypt=require(_0x43ec7f(0x29d))[_0x43ec7f(0x33f)],RSA=require(_0x43ec7f(0x29d))[_0x43ec7f(0x345)],bcrypt=require('bcryptjs'),jwt=require(_0x43ec7f(0x1df)),ipaddr=require(_0x43ec7f(0x23d)),argv=require(_0x43ec7f(0x354))(process[_0x43ec7f(0x30c)][_0x43ec7f(0x266)](0x2))[_0x43ec7f(0x30c)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x43ec7f(0x2d0)),Mixpanel=require(_0x43ec7f(0x333)),axios=require(_0x43ec7f(0x328)),{GraphQLClient,gql}=require(_0x43ec7f(0x213)),util=require('util'),fileUpload=require(_0x43ec7f(0x1fe)),PORT=argv[_0x43ec7f(0x256)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x43ec7f(0x1d8)](PORT)&&(console[_0x43ec7f(0x270)](_0x43ec7f(0x2a2)+PORT+_0x43ec7f(0x26a)),process[_0x43ec7f(0x27a)](0x1));function _0x5e80(){const _0x465b20=['NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','args','reason','toString','lowdb','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','pidExpireLogin','function','username','update-bot','success','storeHeadless','add-bot','logged\x20out','$1_$2_$3','yes','botID','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','cancelLoading','kind','/:bot/coins','zip/','listen','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','settings','express-fileupload','Server','conn','backup','encryptedUuid','value','Unauthorized\x20attempt\x20to\x20add\x20bot','2FA\x20login\x20required','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','18VJuDbf','.zip','polling_error','108551tsrfrt','Unauthorized\x20attempt\x20to\x20get\x20portfolio','clientip','files','referer','whitelist','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','config/','graphql-request','Unauthorized\x20attempt\x20to\x20confirm\x20message','timeshift','All\x20bots\x20running\x20right\x20now','updatebotmanager','catch','0.0.0','replace','randomFillSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','/names\x20-\x20show\x20bot\x20names\x0a','getMonth','showname','format','Bot\x20Mgr\x20>\x20','get-starting-balances','decrypt','HTML','Temporary\x20access\x20rejected','telegramEnabled','exec','use','status','get-messages','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','stopPolling','place-order','accept','No\x20bots\x20running\x20right\x20now','build','title','Password\x20has\x20been\x20reset\x20to:\x20','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','name','write','Invalid\x20authentication\x20token\x20(2)','generate','You\x20can\x20use\x20the\x20following\x20commands:\x0a','exp','372916GRMGCu','all','send','ipaddr.js','temporary\x20access\x20not\x20allowed','sign','sha256','password','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/disable\x20-\x20disable\x20notifications\x0a','type','mode','pidRefreshToken','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20bot','temp/','Invalid\x20username\x20or\x20IP\x20address','/status\x20-\x20show\x20bot(s)\x20status\x0a','(((.+)+)+)+$','RSA-OAEP','removeAllListeners','sort','includes','secret','NTBA_FIX_319','uncaughtException','max','\x20mode','port','crypto','Notifications\x20disabled\x0a','::1','starting\x20bot\x20|\x20Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','entries','emitHistory','writeFileSync','toggle-bot-mode','error\x20while\x20deleting\x20config\x20files:\x20','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','disabled\x20Bot\x20','telegramEvents','getSeconds','slice','12xsZbYJ','set','************',',\x20must\x20be\x20a\x204\x20digit\x20number','1000','handshake','hasOwnProperty','delete-alerts','placeOrder','log','init','185140SiDPuG','botname','emit','Invalid\x20Telegram\x20token','message','starting\x20new\x20bot\x20|\x20Bot\x20','store-headless','static','exit','Unauthorized\x20attempt\x20to\x20get\x20messages','bot','allow','size','/:bot/portfolio','isIPv4MappedAddress','length','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','temporary\x20token\x20generated','ipc','bots','enabled\x20Bot\x20','Notifications\x20enabled\x0a','telegram2FaApproval','Notifications\x20enabled','store','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','expiry','217Hgymar','child_process','split','publicKey','Bot\x20','logs','orders','Invalid\x20IP\x20address','_data','once','copyFileSync','Notifications\x20types:\x20','login\x20token\x20valid','filter','match','randomBytes','hybrid-crypto-js','timestamp','hashSync','file','Notifications\x20disabled','Error:\x20Invalid\x20argument\x20','data','***','find','remove','/download/:type',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','simple','Markdown','login\x20not\x20required','loginRequired','login\x20required','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','track','get-logs','getUTCHours','min','\x20only\x0a','bb-settings.json','*$1*','telegrammsg','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','secure','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','bbPassword','/:bot/history','reload','1781685QiaRKO','telegramUsername','lastmsgtelegram','createServer','bb-config.json','::ffff:127.0.0.1','update-bb','DEFLATE','\x20minutes','getTime','add','telegramToken','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','compareSync','lowdb/adapters/FileSync','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','No\x20authentication\x20token','stop','node-telegram-bot-api','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','All\x20bots','Ok,\x20will\x20send\x20order\x20notifications\x20only','30\x20min','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','botmanager','output-003.log','bbUsername','isDirectory','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','temporaryAccessAllowed','75474JQoRIs','\x20(2)','access','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','node-zip','alerts','\x20to\x20','idling\x20bot\x20\x20\x20|\x20Bot\x20','parse','user','show','\x20|\x20','from','enabled','login\x20token\x20generated','error','2FA\x20required','SIGINT','-----------------------------------------------------------------------------------','Unauthorized\x20login\x20attempt\x20(timeout)','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','push','Unauthorized\x20attempt\x20to\x20update\x20settings','request','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','messages','apply','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','logout','f2aRequired','apiSecret','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','-events.json','Unauthorized\x20attempt\x20to\x20log\x20out','getFullYear','number','apiKey','restart','notification','http','Restoring\x20bot(s)\x20from\x20backup','showConfig','index.html','inherit','delete-bot','join','ipv6','/:bot','argv','All','toggleBotMode','privateKey','Failed\x20to\x20download\x20','headers','headless','callback_query','server','padStart','output-000.log','manual','whitelistEnabled','Restore\x20process\x20aborted','live','get','6b67f3d61ee94b8f5c80b4affef4c4d9','token','getHours','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','keys','User\x20has\x20been\x20validated','onText','Orders','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','sockets','-config.json','disconnect','axios','404\x20Not\x20Found','/:bot/configuration','\x20>\x20','kill','new-disabled','socket','readdirSync','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','any','params','mixpanel','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','event','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','generateKeyPairAsync','version','binary','chat','stringify','defaults','connection','full','Crypt','readFileSync','new','Unauthorized\x20attempt\x20to\x20get\x20logs','Unauthorized\x20attempt\x20to\x20download\x20','uuid','RSA','mkdirSync','2FA','sendMessage','login','settings.','bbvNew','existsSync','express','createWriteStream','1184136IDjhHu','Alerts','rmSync','bot-','search','yargs/yargs','4151650UYZMyi','telegramChatId','remoteAddress','auto','storeConfiguration','telegram','sortBy',':\x20Bot\x20Mgr\x20>\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','output-002.log','getMinutes','connected','stopped','latestversion','bot.js','Token\x20blacklisted','tkn','started','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20delete\x20bot','-results.json','reject','sendPortfolioTelegram','lastmsgemitted','output-001.log','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','getDate','store-configuration','disabled','initclient','SIGTERM','2FA\x20login\x20token\x20generated','/restart\x20-\x20restart\x20bot(s)\x0a','/enable\x20-\x20enable\x20notifications\x0a','cancel-loading','blacklist','toIPv4Address','logs/','Unauthorized\x20attempt\x20to\x20delete\x20alerts','download','env','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','userid','telegramIpApproval','answerCallbackQuery','getStartingBalances','unlinkSync','then','test','cloneDeep','hex','bbvReceive','forEach','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','-performance.json','jsonwebtoken','removeListener','sendFile','assign','get-portfolio','post'];_0x5e80=function(){return _0x465b20;};return _0x5e80();}const HOST=argv['host']||null,userID=argv[_0x43ec7f(0x2e5)]||'';let bbpath='bb/',bbpath2='';const botfile=_0x43ec7f(0x363),configfile=_0x43ec7f(0x2c1),settingsfile=_0x43ec7f(0x2b4),securefile='bb-secure.json';let validInstallation=!![];!fs[_0x43ec7f(0x34c)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x43ec7f(0x212),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x43ec7f(0x1cd)+userID+'/':bbpath+_0x43ec7f(0x1cd),zippath=userID?bbpath+_0x43ec7f(0x1fa)+userID+'/':bbpath+_0x43ec7f(0x1fa),loggerfile=fs[_0x43ec7f(0x34e)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x43ec7f(0x249);!fs['existsSync'](configpath)&&fs[_0x43ec7f(0x346)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x43ec7f(0x346)](configbackuppath);!fs[_0x43ec7f(0x34c)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x43ec7f(0x34c)](zippath)&&fs[_0x43ec7f(0x346)](zippath);!fs[_0x43ec7f(0x34c)](temppath)&&fs[_0x43ec7f(0x346)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x2f3c(_0x45a266,_0x2a384c){const _0x9220b=_0x5e80();return _0x2f3c=function(_0x1cea0c,_0x131ec5){_0x1cea0c=_0x1cea0c-0x1c6;let _0x5e80c1=_0x9220b[_0x1cea0c];return _0x5e80c1;},_0x2f3c(_0x45a266,_0x2a384c);}dbConfig['defaults']({'bots':[]})[_0x43ec7f(0x235)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x43ec7f(0x33c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x43ec7f(0x219)}})[_0x43ec7f(0x235)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x43ec7f(0x33c)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x43ec7f(0x240),'rsaStandard':_0x43ec7f(0x24d)});const saltRounds=0xa,mixpanel=Mixpanel[_0x43ec7f(0x271)](_0x43ec7f(0x31c),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings[_0x43ec7f(0x2be)]&&settings[_0x43ec7f(0x2be)]!='')initTelegram();const logger={'screen':_0x4ff443=>{const _0xfc4357=_0x43ec7f;console[_0xfc4357(0x270)](_0x4ff443);},'simple':_0x41175d=>{const _0x1ad098=_0x43ec7f;console[_0x1ad098(0x270)](_0x41175d),loggerfile[_0x1ad098(0x235)](util[_0x1ad098(0x220)](_0x41175d)+'\x0a');},'full':async _0x35d8d0=>{const _0x3e73e7=_0x43ec7f,_0xd319f=getTimeStamp()+_0x3e73e7(0x35c)+_0x35d8d0;console[_0x3e73e7(0x270)](_0xd319f),loggerfile[_0x3e73e7(0x235)](util[_0x3e73e7(0x220)](_0xd319f)+'\x0a');if(tgBot&&settings[_0x3e73e7(0x356)]&&settings[_0x3e73e7(0x264)]!=_0x3e73e7(0x293))await tgBot['sendMessage'](settings[_0x3e73e7(0x356)],'Bot\x20Mgr\x20>\x20'+_0x35d8d0)[_0x3e73e7(0x218)](_0x135b78=>{telegramError(_0x135b78);});}};process['on'](_0x43ec7f(0x253),function(_0x5a0658){logger['simple'](_0x5a0658);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x43ec7f(0x338)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x43ec7f(0x34d)),app=express(),http=require(_0x43ec7f(0x303))[_0x43ec7f(0x2c0)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x43ec7f(0x2a7),async(_0x2edf6b,_0x4acddb)=>{const _0x5b8f11=_0x43ec7f,_0xb14d7d=_0x2edf6b[_0x5b8f11(0x332)][_0x5b8f11(0x244)],_0x2a241c=getClientsWithBotID(_0x5b8f11(0x2d6)),_0x349b5e=_0x2edf6b['headers'][_0x5b8f11(0x344)],_0x4ba45e=timelyDecrypt(_0x349b5e,![]),_0x4eb3e5=_0x2a241c['find'](_0x245f6b=>_0x245f6b[_0x5b8f11(0x344)]==_0x4ba45e);if(_0x4eb3e5){const _0x532225=normalizeIP(_0x2edf6b[_0x5b8f11(0x32e)][_0x5b8f11(0x357)])[_0x5b8f11(0x28a)],_0x43d79e=_0x2edf6b[_0x5b8f11(0x311)]['tkn'];if(validateAccess(_0x43d79e,_0x4ba45e,_0x532225)['allow'])await zipFiles(_0xb14d7d),_0x4acddb[_0x5b8f11(0x1cf)](zippath+(_0xb14d7d+_0x5b8f11(0x209)),_0x235316=>{const _0x5fb146=_0x5b8f11;_0x235316&&(logger[_0x5fb146(0x33e)](_0x5fb146(0x310)+_0xb14d7d),logger[_0x5fb146(0x2a9)](_0x235316));});else logger[_0x5b8f11(0x33e)](_0x5b8f11(0x343)+_0xb14d7d+'\x20(1)');}else logger[_0x5b8f11(0x33e)](_0x5b8f11(0x343)+_0xb14d7d+_0x5b8f11(0x2dd));}),app[_0x43ec7f(0x1e4)]('/upload-backup',async(_0x4fbfa9,_0x5e9551)=>{const _0x32b48f=_0x43ec7f,_0x3e0543=getClientsWithBotID(_0x32b48f(0x2d6)),_0x42955d=_0x4fbfa9[_0x32b48f(0x311)][_0x32b48f(0x344)],_0x2b8dec=timelyDecrypt(_0x42955d,![]),_0x9ede38=_0x3e0543[_0x32b48f(0x2a5)](_0x2a3ce6=>_0x2a3ce6['uuid']==_0x2b8dec);if(_0x9ede38){const _0x26d477=normalizeIP(_0x4fbfa9[_0x32b48f(0x32e)][_0x32b48f(0x357)])[_0x32b48f(0x28a)],_0x67ce33=_0x4fbfa9[_0x32b48f(0x311)][_0x32b48f(0x365)];if(validateAccess(_0x67ce33,_0x2b8dec,_0x26d477)[_0x32b48f(0x27d)]){if(_0x4fbfa9[_0x32b48f(0x20e)]){const _0x534b19=_0x4fbfa9[_0x32b48f(0x20e)]['backupfile'];await _0x534b19['mv'](temppath+_0x534b19[_0x32b48f(0x234)]),_0x5e9551['send']({'status':!![],'message':'File\x20uploaded'});const _0x5c87da=getBotsWithMode();_0x5c87da[_0x32b48f(0x281)]>0x0?confirmRestore(temppath,_0x534b19[_0x32b48f(0x234)]):unzipFile(temppath,_0x534b19[_0x32b48f(0x234)]);}}else logger['full'](_0x32b48f(0x28b));}else logger['full'](_0x32b48f(0x262));}),app[_0x43ec7f(0x228)](express[_0x43ec7f(0x279)](path[_0x43ec7f(0x309)](__dirname,bbpath2,'build2'))),app['use'](express[_0x43ec7f(0x279)](path[_0x43ec7f(0x309)](__dirname,bbpath2,_0x43ec7f(0x230)))),app[_0x43ec7f(0x31b)]('/',function(_0x599417,_0x2e6030){const _0x529571=_0x43ec7f;_0x2e6030[_0x529571(0x1e1)](path[_0x529571(0x309)](__dirname,bbpath2,'build2',_0x529571(0x306)));}),app[_0x43ec7f(0x31b)](_0x43ec7f(0x30b),function(_0x243a86,_0xd9606f){const _0x19c52b=_0x43ec7f;_0xd9606f[_0x19c52b(0x1e1)](path[_0x19c52b(0x309)](__dirname,bbpath2,'build',_0x19c52b(0x306)));}),app['get'](_0x43ec7f(0x27f),(_0x5a7d6a,_0x6a2cea)=>{const _0x1420ca=_0x43ec7f;_0x6a2cea[_0x1420ca(0x1e1)](path[_0x1420ca(0x309)](__dirname,bbpath2,_0x1420ca(0x230),_0x1420ca(0x306)));}),app[_0x43ec7f(0x31b)]('/:bot/performance',(_0x2398cb,_0x21e9d5)=>{const _0x5cf5d9=_0x43ec7f;_0x21e9d5['sendFile'](path['join'](__dirname,bbpath2,'build',_0x5cf5d9(0x306)));}),app['get'](_0x43ec7f(0x1f9),(_0x3ddc03,_0x3bb8d2)=>{const _0x263b99=_0x43ec7f;_0x3bb8d2[_0x263b99(0x1e1)](path[_0x263b99(0x309)](__dirname,bbpath2,_0x263b99(0x230),_0x263b99(0x306)));}),app[_0x43ec7f(0x31b)](_0x43ec7f(0x2bb),(_0x28f74f,_0x5505ad)=>{const _0x2f3d83=_0x43ec7f;_0x5505ad[_0x2f3d83(0x1e1)](path['join'](__dirname,bbpath2,_0x2f3d83(0x230),_0x2f3d83(0x306)));}),app[_0x43ec7f(0x31b)](_0x43ec7f(0x32a),(_0x1b3bba,_0x25f9a7)=>{const _0xc75e29=_0x43ec7f;_0x25f9a7[_0xc75e29(0x1e1)](path[_0xc75e29(0x309)](__dirname,bbpath2,'build',_0xc75e29(0x306)));}),app['get']('/:bot/support',(_0x5ac1b4,_0x439d84)=>{const _0x5d5daf=_0x43ec7f;_0x439d84[_0x5d5daf(0x1e1)](path['join'](__dirname,bbpath2,_0x5d5daf(0x230),_0x5d5daf(0x306)));});if(HOST)http['listen'](PORT,HOST);else http[_0x43ec7f(0x1fb)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x4fc28e=_0x43ec7f;logger[_0x4fc28e(0x2a9)](''),logger[_0x4fc28e(0x2a9)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x4fc28e(0x336)+PORT),logger[_0x4fc28e(0x2a9)](_0x4fc28e(0x2ee));if(config[_0x4fc28e(0x281)]!=0x0)for(const _0x2544fc of config){if(_0x2544fc[_0x4fc28e(0x229)]=='enabled'||_0x2544fc[_0x4fc28e(0x229)]==_0x4fc28e(0x341))await logger[_0x4fc28e(0x33e)](_0x4fc28e(0x25a)+_0x2544fc['botID']+_0x4fc28e(0x2e7)+_0x2544fc[_0x4fc28e(0x273)]),startBot([_0x2544fc[_0x4fc28e(0x1f5)],userID],{'cwd':bbpath},function(_0x55bb9d){const _0x50ae00=_0x4fc28e;if(_0x55bb9d)logger[_0x50ae00(0x33e)](_0x55bb9d);});else(_0x2544fc[_0x4fc28e(0x229)]==_0x4fc28e(0x371)||_0x2544fc['status']==_0x4fc28e(0x32d))&&await logger[_0x4fc28e(0x33e)](_0x4fc28e(0x2e3)+_0x2544fc[_0x4fc28e(0x1f5)]+_0x4fc28e(0x2e7)+_0x2544fc[_0x4fc28e(0x273)]);}else!newBot&&logger[_0x4fc28e(0x2a9)](_0x4fc28e(0x1fc));if(newBot)addBot();logger[_0x4fc28e(0x2a9)](_0x4fc28e(0x2ee)),logger[_0x4fc28e(0x2a9)]('');}function startSocket(){const _0x2c1234=_0x43ec7f;io['on'](_0x2c1234(0x33d),_0x36443c=>{const _0x5337f1=_0x2c1234;let _0x108e0d,_0x5cdcc7,_0x12bb4a,_0x27d87a,_0x59c104;const _0x5f51a0=_0x36443c[_0x5337f1(0x26c)][_0x5337f1(0x311)][_0x5337f1(0x20f)];_0x5cdcc7=_0x5f51a0[_0x5337f1(0x29b)](/bot[0-9]{3}/);if(_0x5cdcc7)_0x12bb4a=_0x5cdcc7[0x0][_0x5337f1(0x29b)](/[0-9]{3}/);if(_0x12bb4a)_0x108e0d=_0x12bb4a[0x0];else _0x108e0d=_0x5337f1(0x2d6);const _0x4b9548=_0x36443c[_0x5337f1(0x26c)]['auth'][_0x5337f1(0x202)];if(!_0x4b9548)_0x36443c[_0x5337f1(0x274)](_0x5337f1(0x229),{'publicKey':secure[_0x5337f1(0x290)]});else{_0x27d87a=timelyDecrypt(_0x4b9548,![]);if(!_0x27d87a)_0x36443c[_0x5337f1(0x274)](_0x5337f1(0x229),{'publicKey':secure[_0x5337f1(0x290)]});else{_0x59c104=normalizeIP(_0x36443c[_0x5337f1(0x200)][_0x5337f1(0x357)])[_0x5337f1(0x28a)];if(!devices[_0x27d87a])devices[_0x27d87a]={'uuid':_0x27d87a,'access':{'token':null}};devices[_0x27d87a]['ip']=_0x59c104;const _0x3025ac=addClient(_0x36443c['id'],_0x27d87a,_0x108e0d);setAccess(_0x3025ac),emitMessages(),_0x36443c['on'](_0x5337f1(0x349),_0x2a913d=>{const _0x74d3ef=_0x5337f1,_0x10c7a2=timelyDecrypt(_0x2a913d[_0x74d3ef(0x241)]);if(_0x10c7a2){_0x2a913d={'username':_0x2a913d[_0x74d3ef(0x1ed)],'password':_0x10c7a2},devices[_0x27d87a][_0x74d3ef(0x2de)]=validateCredentials(_0x2a913d,_0x27d87a);if(devices[_0x27d87a][_0x74d3ef(0x2de)][_0x74d3ef(0x27d)]==![]&&devices[_0x27d87a][_0x74d3ef(0x2de)][_0x74d3ef(0x1e7)]==_0x74d3ef(0x205))_0x36443c['emit'](_0x74d3ef(0x229),{'access':devices[_0x27d87a][_0x74d3ef(0x2de)]}),loginAccess2FA(_0x27d87a,_0x59c104);else{if(devices[_0x27d87a][_0x74d3ef(0x2de)][_0x74d3ef(0x27d)]==![]&&devices[_0x27d87a][_0x74d3ef(0x2de)][_0x74d3ef(0x1e7)]==_0x74d3ef(0x206))_0x36443c['emit'](_0x74d3ef(0x229),{'access':devices[_0x27d87a][_0x74d3ef(0x2de)]});else devices[_0x27d87a]['access'][_0x74d3ef(0x27d)]&&devices[_0x27d87a][_0x74d3ef(0x2de)][_0x74d3ef(0x1e7)]==_0x74d3ef(0x2ea)&&(getClientsWithUuid(_0x27d87a)[_0x74d3ef(0x1dc)](_0x2083eb=>{setAccess(_0x2083eb);}),setTokenRefresh(_0x27d87a),setSessionTimeout(_0x74d3ef(0x349),_0x27d87a));}}else logger['full'](_0x74d3ef(0x2ef));}),_0x36443c['on']('reset-password',()=>{resetPassword();}),_0x36443c['on'](_0x5337f1(0x327),_0x493dec=>{removeClient(_0x36443c['id']);}),_0x108e0d==_0x5337f1(0x2d6)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x218c43){const _0x1d20b5=_0x43ec7f;if(_0x218c43!=_0x1d20b5(0x2d6)&&config[_0x1d20b5(0x300)]!=''){if(pid[_0x218c43])pid[_0x218c43]['send']({'function':_0x1d20b5(0x372),'args':null});}}function reloadBotManager(){const _0x4d75b5=_0x43ec7f;getClientsWithBotID(_0x4d75b5(0x2d6))[_0x4d75b5(0x1dc)](_0x23f31b=>{const _0x1e1ab9=_0x4d75b5;getSocket(_0x23f31b['id'])['emit'](_0x1e1ab9(0x229),{'access':{'allow':![],'reason':_0x1e1ab9(0x2bc),'token':null}});});}function getSocket(_0x521352){const _0x58218a=_0x43ec7f;return io[_0x58218a(0x325)][_0x58218a(0x325)]['get'](_0x521352);}function setAccess(_0x5c4ab6){const _0x8effce=_0x43ec7f,_0x24c51b=getSocket(_0x5c4ab6['id']),_0x2ecc7f=_0x5c4ab6[_0x8effce(0x344)],_0x580042=_0x5c4ab6[_0x8effce(0x27c)];devices[_0x2ecc7f][_0x8effce(0x2de)]=validateAccess(devices[_0x2ecc7f][_0x8effce(0x2de)][_0x8effce(0x31d)],_0x2ecc7f),_0x24c51b['join'](_0x2ecc7f);if(devices[_0x2ecc7f][_0x8effce(0x2de)][_0x8effce(0x27d)]){_0x24c51b[_0x8effce(0x309)](_0x580042);if(_0x580042==_0x8effce(0x2d6))initializeSocketBotManager(_0x24c51b);else initializeSocketBot(_0x24c51b);initClient(_0x580042);}devices[_0x2ecc7f][_0x8effce(0x2de)]['token']&&devices[_0x2ecc7f][_0x8effce(0x2de)][_0x8effce(0x1e7)]==_0x8effce(0x283)&&setSessionTimeout(_0x8effce(0x347),_0x2ecc7f),devices[_0x2ecc7f][_0x8effce(0x2de)][_0x8effce(0x31d)]&&devices[_0x2ecc7f]['access'][_0x8effce(0x1e7)]==_0x8effce(0x1c7)&&setSessionTimeout(_0x8effce(0x349),_0x2ecc7f),_0x24c51b[_0x8effce(0x274)]('status',{'status':_0x5c4ab6[_0x8effce(0x314)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2ecc7f][_0x8effce(0x2de)],'externalip':devices[_0x2ecc7f]['ip'],'publicKey':secure[_0x8effce(0x290)],'userid':settings[_0x8effce(0x1d2)],'validInstallation':validInstallation}),devices[_0x2ecc7f][_0x8effce(0x2de)][_0x8effce(0x27d)]==![]&&devices[_0x2ecc7f][_0x8effce(0x2de)][_0x8effce(0x1e7)]==_0x8effce(0x2ec)&&temporaryAccess2FA(_0x2ecc7f,devices[_0x2ecc7f]['ip']);}function setSessionTimeout(_0x33c1c2,_0x137737){const _0x539bca=_0x43ec7f;let _0x733255;if(_0x33c1c2==_0x539bca(0x349))_0x733255=loginExpiry*0x3c*0x3e8;else _0x733255=devices[_0x137737][_0x539bca(0x1d3)]['expiry']*0x3c*0x3e8-(new Date()[_0x539bca(0x2c6)]()-devices[_0x137737][_0x539bca(0x1d3)][_0x539bca(0x29e)]);if(devices[_0x137737][_0x539bca(0x1eb)])clearTimeout(devices[_0x137737][_0x539bca(0x1eb)]);devices[_0x137737][_0x539bca(0x1eb)]=setTimeout(()=>{const _0x23056c=_0x539bca;if(devices[_0x137737]['pidRefreshToken'])clearTimeout(devices[_0x137737]['pidRefreshToken']);removeSocketListeners(_0x137737),addBlacklist(_0x137737),devices[_0x137737]['telegramIpApproval']=null,devices[_0x137737]['telegram2FaApproval']=null,devices[_0x137737][_0x23056c(0x2de)][_0x23056c(0x31d)]=null,devices[_0x137737][_0x23056c(0x2de)]=validateAccess(devices[_0x137737]['access']['token'],_0x137737),!(devices[_0x137737][_0x23056c(0x2de)][_0x23056c(0x27d)]&&devices[_0x137737]['access']['reason']==_0x23056c(0x2ab))&&(_0x33c1c2==_0x23056c(0x349)?io['to'](_0x137737)[_0x23056c(0x274)](_0x23056c(0x229),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x137737)['emit'](_0x23056c(0x229),{'access':{'allow':![],'reason':_0x23056c(0x2cc),'token':null}})),devices[_0x137737]['access'][_0x23056c(0x31d)]=null;},_0x733255);}function setTokenRefresh(_0x1a2894){const _0x4906d8=_0x43ec7f;if(devices[_0x1a2894][_0x4906d8(0x246)])clearTimeout(devices[_0x1a2894][_0x4906d8(0x246)]);devices[_0x1a2894][_0x4906d8(0x246)]=setTimeout(()=>{const _0x758dea=_0x4906d8;getClientsWithUuid(_0x1a2894)[_0x758dea(0x281)]!=0x0?(devices[_0x1a2894][_0x758dea(0x2de)]=refreshToken(_0x1a2894),io['to'](_0x1a2894)['emit'](_0x758dea(0x229),{'status':_0x758dea(0x360),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1a2894]['access'],'externalip':devices[_0x1a2894]['ip'],'publicKey':secure[_0x758dea(0x290)],'validInstallation':validInstallation}),setTokenRefresh(_0x1a2894)):clearTimeout(devices[_0x1a2894]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3d751c){const _0x41edfb=_0x43ec7f,_0x581eee=getClient(_0x3d751c['id'])[_0x41edfb(0x344)];_0x3d751c['emit'](_0x41edfb(0x285),config),_0x3d751c[_0x41edfb(0x274)]('settings',cleanSettings()),_0x3d751c['on'](_0x41edfb(0x1f1),_0x45b32f=>{const _0x3172d3=_0x41edfb;if(validateAccess(_0x45b32f,_0x581eee)[_0x3172d3(0x27d)])addBot();else logger[_0x3172d3(0x33e)](_0x3172d3(0x204));}),_0x3d751c['on'](_0x41edfb(0x1ee),(_0x1ae6a0,_0x3fae1d)=>{const _0x406b58=_0x41edfb;if(validateAccess(_0x3fae1d,_0x581eee)[_0x406b58(0x27d)])toggleBot(_0x1ae6a0['botID'],_0x1ae6a0[_0x406b58(0x229)],_0x1ae6a0[_0x406b58(0x31a)]);else logger['full'](_0x406b58(0x248));}),_0x3d751c['on'](_0x41edfb(0x25f),(_0x4819e3,_0x5e1489)=>{const _0xffb2a7=_0x41edfb;if(validateAccess(_0x5e1489,_0x581eee)['allow'])toggleBotMode(_0x4819e3);else logger['full'](_0xffb2a7(0x248));}),_0x3d751c['on'](_0x41edfb(0x308),(_0x35c603,_0x3cd292)=>{const _0x36ea04=_0x41edfb;if(validateAccess(_0x3cd292,_0x581eee)[_0x36ea04(0x27d)])deleteBot(_0x35c603);else logger[_0x36ea04(0x33e)](_0x36ea04(0x368));}),_0x3d751c['on']('store-settings',(_0x5b8e57,_0xd97933)=>{const _0x1e6e87=_0x41edfb;if(validateAccess(_0xd97933,_0x581eee)['allow'])storeSettings(_0x5b8e57,!![]);else logger[_0x1e6e87(0x33e)](_0x1e6e87(0x2f2));}),_0x3d751c['on'](_0x41edfb(0x2c3),_0x366598=>{const _0x78c396=_0x41edfb;if(validateAccess(_0x366598,_0x581eee)[_0x78c396(0x27d)])updateBB();else logger[_0x78c396(0x33e)](_0x78c396(0x2ae));}),_0x3d751c['on']('get-messages',_0x1ca939=>{const _0x301039=_0x41edfb;if(validateAccess(_0x1ca939,_0x581eee)['allow'])getMessages();else logger[_0x301039(0x33e)](_0x301039(0x27b));}),_0x3d751c['on']('confirm-message',(_0x387560,_0x23bb3a)=>{const _0x59dea3=_0x41edfb;if(validateAccess(_0x23bb3a,_0x581eee)[_0x59dea3(0x27d)])confirmMessage(_0x387560);else logger[_0x59dea3(0x33e)](_0x59dea3(0x214));}),_0x3d751c['on'](_0x41edfb(0x2f8),_0x4f9ce1=>{const _0x147412=_0x41edfb;if(validateAccess(_0x4f9ce1,_0x581eee)[_0x147412(0x27d)]){if(devices[_0x581eee]['pidRefreshToken'])clearTimeout(devices[_0x581eee][_0x147412(0x246)]);if(devices[_0x581eee]['pidExpireLogin'])clearTimeout(devices[_0x581eee][_0x147412(0x1eb)]);removeSocketListeners(getClient(_0x3d751c['id'])['uuid']),addBlacklist(_0x581eee),devices[_0x581eee][_0x147412(0x1d3)]=null,devices[_0x581eee][_0x147412(0x288)]=null,devices[_0x581eee][_0x147412(0x2de)][_0x147412(0x31d)]=null,io['to'](getClient(_0x3d751c['id'])[_0x147412(0x344)])[_0x147412(0x274)](_0x147412(0x229),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x147412(0x2fd));});}function initializeSocketBot(_0x55e85e){const _0x4dd0c6=_0x43ec7f,_0xe7ccf9=getClient(_0x55e85e['id'])[_0x4dd0c6(0x27c)],_0x5a5dd1=getClient(_0x55e85e['id'])[_0x4dd0c6(0x344)];_0x55e85e['on'](_0x4dd0c6(0x2b0),(_0xe620a7,_0xfcd570)=>{const _0x2dc373=_0x4dd0c6;if(validateAccess(_0xfcd570,_0x5a5dd1)[_0x2dc373(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x2dc373(0x23c)]({'function':_0x2dc373(0x25d),'args':_0xe620a7});}else logger['full'](_0x2dc373(0x342));}),_0x55e85e['on'](_0x4dd0c6(0x26e),(_0x534543,_0x9bfb56)=>{const _0x223454=_0x4dd0c6;if(validateAccess(_0x9bfb56,_0x5a5dd1)[_0x223454(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9]['send']({'function':'deleteHistoryAlerts','args':_0x534543});}else logger[_0x223454(0x33e)](_0x223454(0x1ce));}),_0x55e85e['on'](_0x4dd0c6(0x1e3),(_0x26c547,_0x1befa5)=>{const _0x186cef=_0x4dd0c6;if(validateAccess(_0x1befa5,_0x5a5dd1)[_0x186cef(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x186cef(0x23c)]({'function':'getPortfolio','args':_0x26c547});}else logger[_0x186cef(0x33e)](_0x186cef(0x20c));}),_0x55e85e['on'](_0x4dd0c6(0x370),(_0x5695ef,_0x2572bc)=>{const _0x1e079d=_0x4dd0c6;if(validateAccess(_0x2572bc,_0x5a5dd1)[_0x1e079d(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x1e079d(0x23c)]({'function':_0x1e079d(0x359),'args':_0x5695ef});}else logger[_0x1e079d(0x33e)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x55e85e['on'](_0x4dd0c6(0x278),(_0x3a1faf,_0x176186)=>{const _0x57a549=_0x4dd0c6;if(validateAccess(_0x176186,_0x5a5dd1)[_0x57a549(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x57a549(0x23c)]({'function':_0x57a549(0x1f0),'args':_0x3a1faf});}else logger[_0x57a549(0x33e)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x55e85e['on'](_0x4dd0c6(0x222),_0x5038f5=>{const _0x103063=_0x4dd0c6;if(validateAccess(_0x5038f5,_0x5a5dd1)[_0x103063(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x103063(0x23c)]({'function':_0x103063(0x1d5),'args':null});}else logger[_0x103063(0x33e)](_0x103063(0x207));}),_0x55e85e['on'](_0x4dd0c6(0x22d),(_0xd5a196,_0x43d7be)=>{const _0x562619=_0x4dd0c6;if(validateAccess(_0x43d7be,_0x5a5dd1)['allow']){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x562619(0x23c)]({'function':_0x562619(0x26f),'args':_0xd5a196});}else logger[_0x562619(0x33e)](_0x562619(0x2cd));}),_0x55e85e['on'](_0x4dd0c6(0x1ca),_0x3a976d=>{const _0x2d05d3=_0x4dd0c6;if(validateAccess(_0x3a976d,_0x5a5dd1)[_0x2d05d3(0x27d)]){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x2d05d3(0x23c)]({'function':_0x2d05d3(0x1f7),'args':null});}else logger[_0x2d05d3(0x33e)](_0x2d05d3(0x1f6));}),_0x55e85e['on']('show-config',_0x467427=>{const _0x476df5=_0x4dd0c6;if(validateAccess(_0x467427,_0x5a5dd1)['allow']){if(pid[_0xe7ccf9])pid[_0xe7ccf9][_0x476df5(0x23c)]({'function':_0x476df5(0x305),'args':null});}else logger[_0x476df5(0x33e)](_0x476df5(0x247));}),_0x55e85e['on'](_0x4dd0c6(0x2c3),_0x3a0683=>{const _0x4c6c82=_0x4dd0c6;if(validateAccess(_0x3a0683,_0x5a5dd1)[_0x4c6c82(0x27d)])updateBB();else logger[_0x4c6c82(0x33e)](_0x4c6c82(0x2ae));}),_0x55e85e['on'](_0x4dd0c6(0x22a),_0x1822f3=>{const _0x10224b=_0x4dd0c6;if(validateAccess(_0x1822f3,_0x5a5dd1)[_0x10224b(0x27d)])getMessages();else logger['full'](_0x10224b(0x27b));}),_0x55e85e['on']('confirm-message',(_0x339f2c,_0x644aac)=>{const _0xfdaf6d=_0x4dd0c6;if(validateAccess(_0x644aac,_0x5a5dd1)['allow'])confirmMessage(_0x339f2c);else logger[_0xfdaf6d(0x33e)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x55e85e['on']('logout',_0x1622da=>{const _0x1b86b8=_0x4dd0c6;if(validateAccess(_0x1622da,_0x5a5dd1)[_0x1b86b8(0x27d)]){if(devices[_0x5a5dd1][_0x1b86b8(0x246)])clearTimeout(devices[_0x5a5dd1][_0x1b86b8(0x246)]);if(devices[_0x5a5dd1][_0x1b86b8(0x1eb)])clearTimeout(devices[_0x5a5dd1][_0x1b86b8(0x1eb)]);removeSocketListeners(getClient(_0x55e85e['id'])[_0x1b86b8(0x344)]),addBlacklist(_0x5a5dd1),devices[_0x5a5dd1]['telegramIpApproval']=null,devices[_0x5a5dd1]['telegram2FaApproval']=null,devices[_0x5a5dd1][_0x1b86b8(0x2de)][_0x1b86b8(0x31d)]=null,io['to'](getClient(_0x55e85e['id'])['uuid'])[_0x1b86b8(0x274)](_0x1b86b8(0x229),{'access':{'allow':![],'reason':_0x1b86b8(0x1f2),'token':null}});}else logger[_0x1b86b8(0x33e)](_0x1b86b8(0x2fd));});}function removeSocketListeners(_0x28e08c){getClientsWithUuid(_0x28e08c)['forEach'](_0x1ef7ab=>{const _0xe33ccb=_0x2f3c;getSocket(_0x1ef7ab['id'])[_0xe33ccb(0x24e)]();});}function cleanSettings(){const _0x1ebe9d=_0x43ec7f;let _0x2bd371=settings;return settings[_0x1ebe9d(0x2c8)]&&settings['telegramToken']!=''&&(_0x2bd371={..._0x2bd371,'telegramToken':_0x1ebe9d(0x269)}),settings[_0x1ebe9d(0x2ba)]&&settings[_0x1ebe9d(0x2ba)]!=''&&(_0x2bd371={..._0x2bd371,'bbPassword':_0x1ebe9d(0x269)}),(settings[_0x1ebe9d(0x2ba)]&&settings[_0x1ebe9d(0x2ba)]==_0x1ebe9d(0x2a4)||settings['telegramToken']&&settings[_0x1ebe9d(0x2c8)]==_0x1ebe9d(0x2a4))&&(_0x2bd371={..._0x2bd371,'restored':{'password':settings[_0x1ebe9d(0x2ba)]==_0x1ebe9d(0x2a4),'telegram':settings[_0x1ebe9d(0x2c8)]=='***'}}),_0x2bd371;}function updateBB(){const _0x107ff8=_0x43ec7f;installingUpdate=!![],config[_0x107ff8(0x1dc)](_0x40b262=>{const _0x57db95=_0x107ff8;restartBot(_0x40b262[_0x57db95(0x1f5)]);}),process[_0x107ff8(0x23c)]({'update':!![]},_0x54a409=>{});}function startBot(_0x1c9f27,_0x487daf,_0x14b355){const _0x2c4ea7=_0x43ec7f;let _0x35cea1=![];const _0x2dd282=_0x1c9f27[0x0];_0x487daf={..._0x487daf,'stdio':[_0x2c4ea7(0x307),_0x2c4ea7(0x307),_0x2c4ea7(0x307),_0x2c4ea7(0x284)]},pid[_0x2dd282]=childProcess['fork'](botfile,_0x1c9f27,_0x487daf),pid[_0x2dd282]['on'](_0x2c4ea7(0x276),_0x17e230=>{const _0x16fd77=_0x2c4ea7;switch(Object['keys'](_0x17e230)[0x0]){case _0x16fd77(0x273):updateBotName(_0x2dd282,_0x17e230[_0x16fd77(0x273)]);break;case _0x16fd77(0x217):updateBotManager();break;case _0x16fd77(0x229):updateStatus(_0x2dd282,_0x17e230['status']);break;case _0x16fd77(0x31a):updateLive(_0x2dd282,_0x17e230['live']);break;case _0x16fd77(0x366):updateLive(_0x2dd282,_0x17e230[_0x16fd77(0x366)]),io['to'](_0x2dd282)[_0x16fd77(0x274)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x17e230[_0x16fd77(0x2cf)]==_0x16fd77(0x301)&&restartBot(_0x2dd282);_0x17e230[_0x16fd77(0x2cf)]=='kill'&&toggleBot(_0x2dd282,_0x16fd77(0x371),_0x16fd77(0x361));break;case _0x16fd77(0x35a):sendTelegram(_0x2dd282,_0x17e230[_0x16fd77(0x35a)]);break;case _0x16fd77(0x2b6):sendTelegramMsg(_0x17e230[_0x16fd77(0x2b6)]);break;case _0x16fd77(0x1ec):io['to'](_0x2dd282)[_0x16fd77(0x274)](_0x17e230[_0x16fd77(0x1ec)],_0x17e230[_0x16fd77(0x1e6)]);break;}}),pid[_0x2dd282]['on'](_0x2c4ea7(0x2eb),function(_0x586b93){if(_0x35cea1)return;_0x35cea1=!![],_0x14b355(_0x586b93);}),pid[_0x2dd282]['on'](_0x2c4ea7(0x27a),async function(_0x318bd7){const _0x50f5ec=_0x2c4ea7;if(installingUpdate)return;if(_0x35cea1)return;_0x35cea1=!![],_0x14b355(null);const _0x5231ee=dbConfig[_0x50f5ec(0x31b)](_0x50f5ec(0x285))[_0x50f5ec(0x2a5)]({'botID':_0x2dd282})[_0x50f5ec(0x203)]();_0x5231ee&&(_0x5231ee['status']==_0x50f5ec(0x2e9)||_0x5231ee['status']=='new')&&(await sleep(0x3e8),updateLive(_0x2dd282,'stopped'),logger['full']('restarting\x20Bot\x20'+_0x2dd282),startBot([_0x2dd282,userID],{'cwd':bbpath},function(_0x5499ae){const _0x32d43c=_0x50f5ec;if(_0x5499ae)logger[_0x32d43c(0x33e)](_0x5499ae);}));});}function stopBot(_0x3a7007){const _0x1a585c=_0x43ec7f;getClientsWithBotID(_0x3a7007)['forEach'](_0x40a426=>{const _0x35b47d=_0x2f3c;getSocket(_0x40a426['id'])[_0x35b47d(0x327)](!![]),removeClient(_0x40a426['id']);}),pid[_0x3a7007]&&(pid[_0x3a7007][_0x1a585c(0x32c)](),pid[_0x3a7007]=null);}function restartBot(_0x4e4bd6){const _0x340951=_0x43ec7f;if(pid[_0x4e4bd6])pid[_0x4e4bd6][_0x340951(0x32c)]();}function addBot(){const _0x1010bf=_0x43ec7f;let _0x3c8230;for(let _0x28b7a9=0x1;_0x28b7a9<0x3e9;_0x28b7a9++){_0x3c8230=_0x28b7a9[_0x1010bf(0x1e8)]()[_0x1010bf(0x315)](0x3,'0');let _0x3bc4f2=config[_0x1010bf(0x2a5)](_0x2938a2=>_0x2938a2[_0x1010bf(0x1f5)]==_0x3c8230);if(!_0x3bc4f2)break;}if(_0x3c8230===_0x1010bf(0x26b)){logger['full'](_0x1010bf(0x2d1));return;}logger[_0x1010bf(0x33e)](_0x1010bf(0x277)+_0x3c8230),dbConfig['get'](_0x1010bf(0x285))[_0x1010bf(0x2f1)]({'botID':_0x3c8230,'botname':_0x1010bf(0x291)+_0x3c8230,'status':_0x1010bf(0x341),'live':''})[_0x1010bf(0x235)](),startBot([_0x3c8230,userID],{'cwd':bbpath},function(_0x42619){const _0x19426a=_0x1010bf;if(_0x42619)logger[_0x19426a(0x33e)](_0x42619);}),config=getConfiguration(),io['to'](_0x1010bf(0x2d6))[_0x1010bf(0x274)](_0x1010bf(0x285),config);}function deleteBot(_0x33c626){const _0x3af8e4=_0x43ec7f;getClientsWithBotID(_0x33c626)[_0x3af8e4(0x1dc)](_0x339dac=>{const _0x5b5f25=_0x3af8e4;getSocket(_0x339dac['id'])[_0x5b5f25(0x327)](!![]),removeClient(_0x339dac['id']);}),dbConfig[_0x3af8e4(0x31b)](_0x3af8e4(0x285))[_0x3af8e4(0x2a6)]({'botID':_0x33c626})[_0x3af8e4(0x235)](),logger[_0x3af8e4(0x33e)]('deleted\x20Bot\x20'+_0x33c626),stopBot(_0x33c626);try{fs[_0x3af8e4(0x1d6)](path[_0x3af8e4(0x309)](configpath,_0x3af8e4(0x352)+_0x33c626+_0x3af8e4(0x326))),fs[_0x3af8e4(0x1d6)](path[_0x3af8e4(0x309)](configpath,_0x3af8e4(0x352)+_0x33c626+_0x3af8e4(0x2fc))),fs[_0x3af8e4(0x1d6)](path[_0x3af8e4(0x309)](configpath,'bot-'+_0x33c626+_0x3af8e4(0x1de))),fs[_0x3af8e4(0x1d6)](path[_0x3af8e4(0x309)](configpath,_0x3af8e4(0x352)+_0x33c626+_0x3af8e4(0x369)));}catch(_0x5ba9e2){if(_0x5ba9e2)logger['full'](_0x3af8e4(0x260),_0x5ba9e2);}config=getConfiguration(),io['to'](_0x3af8e4(0x2d6))[_0x3af8e4(0x274)](_0x3af8e4(0x285),config);}function toggleBot(_0x3809f9,_0x3fa0c1,_0x5094cb){const _0x3f463c=_0x43ec7f;dbConfig[_0x3f463c(0x31b)]('bots')[_0x3f463c(0x2a5)]({'botID':_0x3809f9})[_0x3f463c(0x1e2)]({'status':_0x3fa0c1})[_0x3f463c(0x1e2)]({'live':_0x5094cb})['write']();if(_0x3fa0c1==_0x3f463c(0x2e9)||_0x3fa0c1=='new')logger[_0x3f463c(0x33e)](_0x3f463c(0x286)+_0x3809f9),startBot([_0x3809f9,userID],{'cwd':bbpath},function(_0x15d01d){const _0x25b0be=_0x3f463c;if(_0x15d01d)logger[_0x25b0be(0x33e)](_0x15d01d);});else(_0x3fa0c1==_0x3f463c(0x371)||_0x3fa0c1=='new-disabled')&&(logger[_0x3f463c(0x33e)](_0x3f463c(0x263)+_0x3809f9),stopBot(_0x3809f9));config=getConfiguration(),io['to'](_0x3f463c(0x2d6))[_0x3f463c(0x274)](_0x3f463c(0x285),config);}function toggleStatus(_0x1a1450){const _0x3b6684=_0x43ec7f;let _0x18c862=dbConfig[_0x3b6684(0x31b)]('bots')['find']({'botID':_0x1a1450})[_0x3b6684(0x203)](),_0x2dab7e;if(_0x18c862[_0x3b6684(0x229)]==='enabled')_0x2dab7e='disabled';else{if(_0x18c862[_0x3b6684(0x229)]===_0x3b6684(0x341))_0x2dab7e=_0x3b6684(0x32d);else{if(_0x18c862[_0x3b6684(0x229)]===_0x3b6684(0x32d))_0x2dab7e='new';else{if(_0x18c862[_0x3b6684(0x229)]===_0x3b6684(0x371))_0x2dab7e=_0x3b6684(0x2e9);}}}return _0x2dab7e;}function updateStatus(_0x5db5f5,_0x2fe67a){const _0x4ec044=_0x43ec7f;dbConfig[_0x4ec044(0x31b)]('bots')['find']({'botID':_0x5db5f5})[_0x4ec044(0x1e2)]({'status':_0x2fe67a})[_0x4ec044(0x235)](),config=getConfiguration(),io['to'](_0x4ec044(0x2d6))[_0x4ec044(0x274)](_0x4ec044(0x285),config);}function updateLive(_0x1c9a8a,_0x4d1c5c){const _0xd68ace=_0x43ec7f;dbConfig[_0xd68ace(0x31b)](_0xd68ace(0x285))[_0xd68ace(0x2a5)]({'botID':_0x1c9a8a})[_0xd68ace(0x1e2)]({'live':_0x4d1c5c})[_0xd68ace(0x235)](),config=getConfiguration(),io['to'](_0xd68ace(0x2d6))[_0xd68ace(0x274)]('bots',config);}function updateBotName(_0x523b0b,_0x50df51){const _0x26b2c8=_0x43ec7f;dbConfig[_0x26b2c8(0x31b)](_0x26b2c8(0x285))[_0x26b2c8(0x2a5)]({'botID':_0x523b0b})['assign']({'botname':_0x50df51})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x26b2c8(0x285),config);}function updateBotManager(){const _0x3186b1=_0x43ec7f;config=getConfiguration(),io['to'](_0x3186b1(0x2d6))['emit'](_0x3186b1(0x285),config);}function toggleBotMode(_0x53974c){const _0x465725=_0x43ec7f;if(pid[_0x53974c])pid[_0x53974c]['send']({'function':_0x465725(0x30e),'args':null});else{const _0x418c57=configpath+'bot-'+_0x53974c+_0x465725(0x326),_0x5d915a=fs['readFileSync'](_0x418c57),_0x124340=JSON[_0x465725(0x2e4)](_0x5d915a),_0x518620=_0x124340['bot'][0x0][_0x465725(0x312)];_0x124340[_0x465725(0x27c)][0x0][_0x465725(0x312)]=!_0x518620;const _0x53e50f=JSON[_0x465725(0x33b)](_0x124340,null,0x2);fs[_0x465725(0x25e)](_0x418c57,_0x53e50f),config=getConfiguration(),io['to']('botmanager')[_0x465725(0x274)](_0x465725(0x285),config);}}function telegramError(_0x53297c){const _0xa91861=_0x43ec7f;logger[_0xa91861(0x2a9)](getTimeStamp()+_0xa91861(0x2a8));}function validateTelegram(_0x1aade8){const _0x483049=_0x43ec7f;if(_0x1aade8['from'][_0x483049(0x1ed)]!=settings[_0x483049(0x2be)]&&'@'+_0x1aade8[_0x483049(0x2e8)][_0x483049(0x1ed)]!=settings[_0x483049(0x2be)])return tgBot['sendMessage'](_0x1aade8[_0x483049(0x33a)]['id'],_0x483049(0x282),{'parse_mode':_0x483049(0x224)})[_0x483049(0x218)](_0x3618ca=>{telegramError(_0x3618ca);}),![];return!![];}async function initTelegram(){const _0x15230b=_0x43ec7f;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0xe5c5b4=_0x15230b(0x238);_0xe5c5b4+='\x0a',_0xe5c5b4+=_0x15230b(0x1c9),_0xe5c5b4+=_0x15230b(0x243),_0xe5c5b4+=_0x15230b(0x242),_0xe5c5b4+=_0x15230b(0x1c8),_0xe5c5b4+='/on\x20-\x20start\x20bot(s)\x0a',_0xe5c5b4+='/off\x20-\x20stop\x20bot(s)\x0a',_0xe5c5b4+=_0x15230b(0x233),_0xe5c5b4+=_0x15230b(0x21d),_0xe5c5b4+=_0x15230b(0x24b),_0xe5c5b4+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0xe5c5b4+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0xe5c5b4+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x399b58=_0x15230b(0x2fb);_0x399b58+='\x0a',_0x399b58+=_0xe5c5b4,tgBot[_0x15230b(0x322)](/\/start/,_0x2e8ab5=>{const _0x36e677=_0x15230b;if(!validateTelegram(_0x2e8ab5))return;if(settings[_0x36e677(0x356)]!=_0x2e8ab5[_0x36e677(0x33a)]['id'])updateSetting('telegramChatId',_0x2e8ab5[_0x36e677(0x33a)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x36e677(0x348)](_0x2e8ab5[_0x36e677(0x33a)]['id'],_0x399b58)['catch'](_0x23de03=>{telegramError(_0x23de03);});}),tgBot[_0x15230b(0x322)](/\/enable/,_0x5bdabd=>{const _0xe82bf5=_0x15230b;if(!validateTelegram(_0x5bdabd))return;if(settings[_0xe82bf5(0x356)]!=_0x5bdabd['chat']['id'])updateSetting(_0xe82bf5(0x356),_0x5bdabd[_0xe82bf5(0x33a)]['id']);updateSetting(_0xe82bf5(0x226),!![]),tgBot['sendMessage'](_0x5bdabd[_0xe82bf5(0x33a)]['id'],_0xe82bf5(0x289))[_0xe82bf5(0x218)](_0x55f947=>{telegramError(_0x55f947);});}),tgBot[_0x15230b(0x322)](/\/config/,async _0x583c1b=>{const _0x3b0fbd=_0x15230b;if(!validateTelegram(_0x583c1b))return;tgBot['removeListener'](_0x3b0fbd(0x313)),tgBot[_0x3b0fbd(0x348)](_0x583c1b['chat']['id'],_0x3b0fbd(0x2da),{'reply_markup':{'inline_keyboard':[[{'text':_0x3b0fbd(0x323),'callback_data':_0x3b0fbd(0x293)},{'text':_0x3b0fbd(0x350),'callback_data':_0x3b0fbd(0x2e1)},{'text':_0x3b0fbd(0x30d),'callback_data':_0x3b0fbd(0x23b)}]]}})[_0x3b0fbd(0x218)](_0x2d491e=>{telegramError(_0x2d491e);}),tgBot['on']('callback_query',async _0x99fd2c=>{const _0x35bed0=_0x3b0fbd,_0x7c47e9=_0x99fd2c[_0x35bed0(0x2a3)],_0x12ec3f=_0x99fd2c[_0x35bed0(0x276)];tgBot['answerCallbackQuery'](_0x99fd2c['id'])[_0x35bed0(0x1d7)](async()=>{const _0x3c44d0=_0x35bed0;_0x7c47e9==_0x3c44d0(0x293)&&(updateSetting(_0x3c44d0(0x264),_0x3c44d0(0x293)),updateSetting(_0x3c44d0(0x226),!![]),await tgBot[_0x3c44d0(0x348)](_0x12ec3f[_0x3c44d0(0x33a)]['id'],_0x3c44d0(0x2d3))[_0x3c44d0(0x218)](_0x5de1af=>{telegramError(_0x5de1af);}));_0x7c47e9=='alerts'&&(updateSetting(_0x3c44d0(0x264),_0x3c44d0(0x2e1)),updateSetting(_0x3c44d0(0x226),!![]),await tgBot[_0x3c44d0(0x348)](_0x12ec3f[_0x3c44d0(0x33a)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x3c44d0(0x218)](_0x25318d=>{telegramError(_0x25318d);}));_0x7c47e9=='all'&&(updateSetting('telegramEvents','all'),updateSetting(_0x3c44d0(0x226),!![]),await tgBot[_0x3c44d0(0x348)](_0x12ec3f['chat']['id'],_0x3c44d0(0x2f7))[_0x3c44d0(0x218)](_0x338e19=>{telegramError(_0x338e19);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x12ec3f[_0x3c44d0(0x33a)]['id'],_0x3c44d0(0x1d1))[_0x3c44d0(0x218)](_0x40e1e1=>{telegramError(_0x40e1e1);});}),tgBot[_0x35bed0(0x1e0)](_0x35bed0(0x313));});}),tgBot['onText'](/\/status/,_0x223030=>{const _0x51a0c7=_0x15230b;if(!validateTelegram(_0x223030))return;const _0x47af77=getBotsWithMode();let _0x4f1ead=_0x51a0c7(0x35d);config[_0x51a0c7(0x1dc)](_0x12d812=>{const _0x315327=_0x51a0c7,_0x4ce8fe=_0x47af77[_0x315327(0x2a5)](_0x13d610=>_0x13d610[_0x315327(0x1f5)]==_0x12d812[_0x315327(0x1f5)])[_0x315327(0x245)];_0x4f1ead+=_0x315327(0x291)+_0x12d812[_0x315327(0x1f5)]+':\x20'+_0x12d812[_0x315327(0x229)]+_0x315327(0x2e7)+_0x4ce8fe+_0x315327(0x2e7)+_0x12d812[_0x315327(0x31a)]+'\x0a';}),_0x4f1ead+='\x0a',_0x4f1ead+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4f1ead+=!settings[_0x51a0c7(0x226)]?_0x51a0c7(0x258):_0x51a0c7(0x287),_0x4f1ead+=settings['telegramEnabled']?settings['telegramEvents']==_0x51a0c7(0x23b)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x51a0c7(0x298)+settings['telegramEvents']+_0x51a0c7(0x2b3):'',tgBot[_0x51a0c7(0x348)](_0x223030['chat']['id'],_0x4f1ead,{'parse_mode':_0x51a0c7(0x224)})[_0x51a0c7(0x218)](_0x4db01c=>{telegramError(_0x4db01c);});}),tgBot['onText'](/\/restart/,_0x33ec61=>{const _0x592dbe=_0x15230b;if(!validateTelegram(_0x33ec61))return;tgBot[_0x592dbe(0x1e0)](_0x592dbe(0x313));const _0x157e50=getEnabledBots();if(_0x157e50[_0x592dbe(0x281)]==0x0)tgBot[_0x592dbe(0x348)](_0x33ec61[_0x592dbe(0x33a)]['id'],_0x592dbe(0x22f))[_0x592dbe(0x218)](_0x1c2102=>{telegramError(_0x1c2102);});else{if(_0x157e50[_0x592dbe(0x281)]>0x1)_0x157e50[_0x592dbe(0x2f1)]({'botID':_0x592dbe(0x23b)});let _0x109cc3=[],_0x47567d=[];const _0x3e33a7=_0x157e50[_0x592dbe(0x281)]%0x4==0x0||_0x157e50[_0x592dbe(0x281)]%0x4==0x3||_0x157e50['length']%0x3==0x1?0x4:0x3;let _0xa39334=0x0;_0x157e50['forEach']((_0x2893bb,_0x11bca1)=>{const _0x51a15f=_0x592dbe;if(_0x11bca1%_0x3e33a7==0x0)_0x47567d=[];_0x47567d[_0x51a15f(0x2f1)]({'text':_0x2893bb[_0x51a15f(0x1f5)]==_0x51a15f(0x23b)?_0x51a15f(0x2d2):_0x51a15f(0x291)+_0x2893bb[_0x51a15f(0x1f5)],'callback_data':_0x2893bb['botID']}),_0x11bca1%_0x3e33a7==0x0&&(_0x109cc3[_0xa39334]=_0x47567d,_0xa39334++);}),tgBot['sendMessage'](_0x33ec61[_0x592dbe(0x33a)]['id'],_0x592dbe(0x2d5),{'reply_markup':{'inline_keyboard':_0x109cc3}})[_0x592dbe(0x218)](_0x37f63c=>{telegramError(_0x37f63c);}),tgBot['on'](_0x592dbe(0x313),async _0x540840=>{const _0x55dc5a=_0x592dbe,_0x189df2=_0x540840['data'],_0x212553=_0x540840['message'];tgBot[_0x55dc5a(0x1d4)](_0x540840['id'])[_0x55dc5a(0x1d7)](async()=>{const _0x47d8b5=_0x55dc5a;_0x189df2==_0x47d8b5(0x23b)?config['forEach'](_0x302fe3=>{const _0x2e7a09=_0x47d8b5;restartBot(_0x302fe3[_0x2e7a09(0x1f5)]);}):restartBot(_0x189df2);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x15230b(0x322)](/\/on/,_0x4256ea=>{const _0x26d92d=_0x15230b;if(!validateTelegram(_0x4256ea))return;tgBot[_0x26d92d(0x1e0)](_0x26d92d(0x313));const _0x445955=getDisabledBots();if(_0x445955[_0x26d92d(0x281)]==0x0)tgBot[_0x26d92d(0x348)](_0x4256ea[_0x26d92d(0x33a)]['id'],_0x26d92d(0x216))['catch'](_0x18a67c=>{telegramError(_0x18a67c);});else{if(_0x445955['length']>0x1)_0x445955[_0x26d92d(0x2f1)]({'botID':_0x26d92d(0x23b)});let _0x1a822e=[],_0x2534de=[];const _0x1c59d2=_0x445955[_0x26d92d(0x281)]%0x4==0x0||_0x445955[_0x26d92d(0x281)]%0x4==0x3||_0x445955['length']%0x3==0x1?0x4:0x3;let _0x50e705=0x0;_0x445955[_0x26d92d(0x1dc)]((_0x4602ad,_0x2dfd79)=>{const _0x1d2884=_0x26d92d;if(_0x2dfd79%_0x1c59d2==0x0)_0x2534de=[];_0x2534de[_0x1d2884(0x2f1)]({'text':_0x4602ad[_0x1d2884(0x1f5)]==_0x1d2884(0x23b)?_0x1d2884(0x2d2):_0x1d2884(0x291)+_0x4602ad[_0x1d2884(0x1f5)],'callback_data':_0x4602ad['botID']}),_0x2dfd79%_0x1c59d2==0x0&&(_0x1a822e[_0x50e705]=_0x2534de,_0x50e705++);}),tgBot['sendMessage'](_0x4256ea[_0x26d92d(0x33a)]['id'],_0x26d92d(0x334),{'reply_markup':{'inline_keyboard':_0x1a822e}})[_0x26d92d(0x218)](_0x4027c1=>{telegramError(_0x4027c1);}),tgBot['on'](_0x26d92d(0x313),async _0x28d99b=>{const _0x492c8d=_0x26d92d,_0x524d9b=_0x28d99b[_0x492c8d(0x2a3)],_0x1bf44a=_0x28d99b[_0x492c8d(0x276)];tgBot[_0x492c8d(0x1d4)](_0x28d99b['id'])[_0x492c8d(0x1d7)](async()=>{const _0x5c1bf4=_0x492c8d;_0x524d9b==_0x5c1bf4(0x23b)?(tgBot[_0x5c1bf4(0x348)](_0x1bf44a[_0x5c1bf4(0x33a)]['id'],_0x5c1bf4(0x31f))[_0x5c1bf4(0x218)](_0x578f14=>{telegramError(_0x578f14);}),_0x445955[_0x5c1bf4(0x1dc)](_0x21311f=>{const _0x54eda7=_0x5c1bf4;if(_0x21311f[_0x54eda7(0x1f5)]!=_0x54eda7(0x23b))toggleBot(_0x21311f[_0x54eda7(0x1f5)],toggleStatus(_0x21311f['botID']),_0x54eda7(0x361));})):(tgBot[_0x5c1bf4(0x348)](_0x1bf44a[_0x5c1bf4(0x33a)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x524d9b)[_0x5c1bf4(0x218)](_0x2f7940=>{telegramError(_0x2f7940);}),toggleBot(_0x524d9b,toggleStatus(_0x524d9b),_0x5c1bf4(0x361)));}),tgBot[_0x492c8d(0x1e0)](_0x492c8d(0x313));});}}),tgBot[_0x15230b(0x322)](/\/off/,_0x2314bb=>{const _0x4e32ce=_0x15230b;if(!validateTelegram(_0x2314bb))return;tgBot[_0x4e32ce(0x1e0)](_0x4e32ce(0x313));const _0x50b0b6=getEnabledBots();if(_0x50b0b6[_0x4e32ce(0x281)]==0x0)tgBot[_0x4e32ce(0x348)](_0x2314bb['chat']['id'],_0x4e32ce(0x22f))[_0x4e32ce(0x218)](_0x15e8c1=>{telegramError(_0x15e8c1);});else{if(_0x50b0b6[_0x4e32ce(0x281)]>0x1)_0x50b0b6[_0x4e32ce(0x2f1)]({'botID':_0x4e32ce(0x23b)});let _0x2624ce=[],_0x2e42c1=[];const _0x41f626=_0x50b0b6['length']%0x4==0x0||_0x50b0b6[_0x4e32ce(0x281)]%0x4==0x3||_0x50b0b6[_0x4e32ce(0x281)]%0x3==0x1?0x4:0x3;let _0x50e6f5=0x0;_0x50b0b6[_0x4e32ce(0x1dc)]((_0x195b4f,_0x554b3f)=>{const _0x4da7a4=_0x4e32ce;if(_0x554b3f%_0x41f626==0x0)_0x2e42c1=[];_0x2e42c1[_0x4da7a4(0x2f1)]({'text':_0x195b4f[_0x4da7a4(0x1f5)]==_0x4da7a4(0x23b)?'All\x20bots':_0x4da7a4(0x291)+_0x195b4f[_0x4da7a4(0x1f5)],'callback_data':_0x195b4f[_0x4da7a4(0x1f5)]}),_0x554b3f%_0x41f626==0x0&&(_0x2624ce[_0x50e6f5]=_0x2e42c1,_0x50e6f5++);}),tgBot['sendMessage'](_0x2314bb[_0x4e32ce(0x33a)]['id'],_0x4e32ce(0x1ea),{'reply_markup':{'inline_keyboard':_0x2624ce}})[_0x4e32ce(0x218)](_0x3ede40=>{telegramError(_0x3ede40);}),tgBot['on'](_0x4e32ce(0x313),async _0x19c2ce=>{const _0x134212=_0x4e32ce,_0x308577=_0x19c2ce['data'],_0x325fbb=_0x19c2ce[_0x134212(0x276)];tgBot[_0x134212(0x1d4)](_0x19c2ce['id'])[_0x134212(0x1d7)](async()=>{const _0x444987=_0x134212;_0x308577=='all'?(tgBot[_0x444987(0x348)](_0x325fbb[_0x444987(0x33a)]['id'],_0x444987(0x330))['catch'](_0x5654c9=>{telegramError(_0x5654c9);}),_0x50b0b6[_0x444987(0x1dc)](_0x1ea48e=>{const _0x42d065=_0x444987;if(_0x1ea48e[_0x42d065(0x1f5)]!=_0x42d065(0x23b))toggleBot(_0x1ea48e[_0x42d065(0x1f5)],toggleStatus(_0x1ea48e[_0x42d065(0x1f5)]),_0x42d065(0x361));})):(tgBot[_0x444987(0x348)](_0x325fbb[_0x444987(0x33a)]['id'],_0x444987(0x2f4)+_0x308577)[_0x444987(0x218)](_0x19b36d=>{telegramError(_0x19b36d);}),toggleBot(_0x308577,toggleStatus(_0x308577),'stopped'));}),tgBot[_0x134212(0x1e0)]('callback_query');});}}),tgBot[_0x15230b(0x322)](/\/portfolio/,_0x47fd9b=>{const _0x37a780=_0x15230b;if(!validateTelegram(_0x47fd9b))return;tgBot[_0x37a780(0x1e0)](_0x37a780(0x313));const _0x5be1a8=getEnabledBots();if(_0x5be1a8['length']==0x0)tgBot['sendMessage'](_0x47fd9b['chat']['id'],_0x37a780(0x22f))['catch'](_0x49ad15=>{telegramError(_0x49ad15);});else{if(_0x5be1a8[_0x37a780(0x281)]>0x1){let _0x1478ff=[],_0x8cc88d=[];const _0x301032=_0x5be1a8['length']%0x4==0x0||_0x5be1a8[_0x37a780(0x281)]%0x4==0x3||_0x5be1a8[_0x37a780(0x281)]%0x3==0x1?0x4:0x3;let _0x76c81e=0x0;_0x5be1a8[_0x37a780(0x1dc)]((_0x4d6af6,_0x5f4c92)=>{const _0x455fd5=_0x37a780;if(_0x5f4c92%_0x301032==0x0)_0x8cc88d=[];_0x8cc88d[_0x455fd5(0x2f1)]({'text':_0x455fd5(0x291)+_0x4d6af6['botID'],'callback_data':_0x4d6af6['botID']}),_0x5f4c92%_0x301032==0x0&&(_0x1478ff[_0x76c81e]=_0x8cc88d,_0x76c81e++);}),tgBot['sendMessage'](_0x47fd9b[_0x37a780(0x33a)]['id'],_0x37a780(0x21c),{'reply_markup':{'inline_keyboard':_0x1478ff}})[_0x37a780(0x218)](_0xf80a5f=>{telegramError(_0xf80a5f);}),tgBot['on']('callback_query',async _0xa17b7a=>{const _0x2e9f1e=_0x37a780,_0x4909ad=_0xa17b7a[_0x2e9f1e(0x2a3)],_0x61e725=_0xa17b7a['message'];tgBot[_0x2e9f1e(0x1d4)](_0xa17b7a['id'])[_0x2e9f1e(0x1d7)](async()=>{const _0x588d2e=_0x2e9f1e;if(pid[_0x4909ad])pid[_0x4909ad][_0x588d2e(0x23c)]({'function':_0x588d2e(0x36b),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x1ed85c=_0x5be1a8[0x0]['botID'];if(pid[_0x1ed85c])pid[_0x1ed85c][_0x37a780(0x23c)]({'function':_0x37a780(0x36b),'args':null});}}}),tgBot[_0x15230b(0x322)](/\/update/,async _0x1d7060=>{const _0x4f9956=_0x15230b;if(!validateTelegram(_0x1d7060))return;tgBot[_0x4f9956(0x1e0)](_0x4f9956(0x313)),await getMessages();if(!updateAvailable)tgBot[_0x4f9956(0x348)](_0x1d7060[_0x4f9956(0x33a)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x4f9956(0x218)](_0x911830=>{telegramError(_0x911830);});else!validInstallation?tgBot['sendMessage'](_0x1d7060[_0x4f9956(0x33a)]['id'],_0x4f9956(0x211))['catch'](_0x446683=>{telegramError(_0x446683);}):(tgBot[_0x4f9956(0x348)](_0x1d7060[_0x4f9956(0x33a)]['id'],_0x4f9956(0x25b),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x4f9956(0x218)](_0x5c878e=>{telegramError(_0x5c878e);}),tgBot['on'](_0x4f9956(0x313),async _0xe9bd02=>{const _0x358999=_0x4f9956,_0x10072d=_0xe9bd02[_0x358999(0x2a3)],_0x11034e=_0xe9bd02[_0x358999(0x276)];tgBot[_0x358999(0x1d4)](_0xe9bd02['id'])[_0x358999(0x1d7)](async()=>{const _0x18efa0=_0x358999;_0x10072d==_0x18efa0(0x1f4)&&(await tgBot[_0x18efa0(0x348)](_0x11034e[_0x18efa0(0x33a)]['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0x599b7a=>{telegramError(_0x599b7a);}),updateBB());_0x10072d=='no'&&await tgBot['sendMessage'](_0x11034e[_0x18efa0(0x33a)]['id'],_0x18efa0(0x324))['catch'](_0x191e03=>{telegramError(_0x191e03);});if(!settings[_0x18efa0(0x356)])tgBot[_0x18efa0(0x348)](_0x11034e[_0x18efa0(0x33a)]['id'],_0x18efa0(0x1d1))['catch'](_0x29b01c=>{telegramError(_0x29b01c);});}),tgBot['removeListener'](_0x358999(0x313));}));}),tgBot[_0x15230b(0x322)](/\/toggle/,_0x77a9de=>{const _0x28099d=_0x15230b;if(!validateTelegram(_0x77a9de))return;tgBot[_0x28099d(0x1e0)](_0x28099d(0x313));const _0x207a11=getBotsWithMode();if(_0x207a11['length']==0x0)tgBot[_0x28099d(0x348)](_0x77a9de[_0x28099d(0x33a)]['id'],_0x28099d(0x22f))[_0x28099d(0x218)](_0xda1637=>{telegramError(_0xda1637);});else{let _0x158d49=[],_0x1d4477=[];const _0x1f01cd=0x2;let _0x466787=0x0;_0x207a11[_0x28099d(0x1dc)]((_0x3911cc,_0x55c1c2)=>{const _0x35ffe9=_0x28099d;if(_0x55c1c2%_0x1f01cd==0x0)_0x1d4477=[];_0x1d4477[_0x35ffe9(0x2f1)]({'text':_0x35ffe9(0x291)+_0x3911cc[_0x35ffe9(0x1f5)]+'\x20('+_0x3911cc[_0x35ffe9(0x245)]+')','callback_data':_0x3911cc['botID']}),_0x55c1c2%_0x1f01cd==0x0&&(_0x158d49[_0x466787]=_0x1d4477,_0x466787++);}),tgBot[_0x28099d(0x348)](_0x77a9de['chat']['id'],_0x28099d(0x2b9),{'reply_markup':{'inline_keyboard':_0x158d49}})['catch'](_0x489a61=>{telegramError(_0x489a61);}),tgBot['on']('callback_query',async _0xe4a30=>{const _0x5a8726=_0x28099d,_0x47f3e8=_0xe4a30[_0x5a8726(0x2a3)],_0x327c31=_0xe4a30[_0x5a8726(0x276)];tgBot[_0x5a8726(0x1d4)](_0xe4a30['id'])[_0x5a8726(0x1d7)](async()=>{const _0x4f0410=_0x5a8726,_0x2f6726=_0x207a11[_0x4f0410(0x2a5)](_0xb1ea27=>_0xb1ea27[_0x4f0410(0x1f5)]==_0x47f3e8),_0x632449=_0x2f6726[_0x4f0410(0x245)]==_0x4f0410(0x358)?_0x4f0410(0x317):_0x4f0410(0x358);tgBot['sendMessage'](_0x327c31[_0x4f0410(0x33a)]['id'],_0x4f0410(0x2df)+_0x47f3e8+_0x4f0410(0x2e2)+_0x632449+_0x4f0410(0x255))[_0x4f0410(0x218)](_0xf97607=>{telegramError(_0xf97607);}),toggleBotMode(_0x47f3e8);}),tgBot[_0x5a8726(0x1e0)](_0x5a8726(0x313));});}}),tgBot[_0x15230b(0x322)](/\/names/,_0x62f8a=>{const _0x56ae1d=_0x15230b;if(!validateTelegram(_0x62f8a))return;let _0x318ca4='';config[_0x56ae1d(0x1dc)](_0xd6eea7=>{const _0x326fe4=_0x56ae1d;_0x318ca4+=_0x326fe4(0x291)+_0xd6eea7[_0x326fe4(0x1f5)]+':\x20'+_0xd6eea7[_0x326fe4(0x273)]+'\x0a';}),tgBot['sendMessage'](_0x62f8a['chat']['id'],_0x318ca4,{'parse_mode':_0x56ae1d(0x224)})[_0x56ae1d(0x218)](_0x373c72=>{telegramError(_0x373c72);});}),tgBot[_0x15230b(0x322)](/\/disable/,_0x275c10=>{const _0x4315a0=_0x15230b;if(!validateTelegram(_0x275c10))return;tgBot['sendMessage'](_0x275c10[_0x4315a0(0x33a)]['id'],_0x4315a0(0x2a1))['catch'](_0x201bcc=>{telegramError(_0x201bcc);}),updateSetting(_0x4315a0(0x226),![]);}),tgBot['onText'](/\/help/,_0x152b06=>{const _0x25528f=_0x15230b;if(!validateTelegram(_0x152b06))return;tgBot['sendMessage'](_0x152b06['chat']['id'],_0xe5c5b4)[_0x25528f(0x218)](_0x5527e6=>{telegramError(_0x5527e6);});}),tgBot['on'](_0x15230b(0x20a),_0x5d9370=>{const _0x13008e=_0x15230b;_0x5d9370[_0x13008e(0x1e8)]()[_0x13008e(0x250)](_0x13008e(0x329))&&(logger['full'](_0x13008e(0x275)),tgBot[_0x13008e(0x22c)](),tgBot=null,io['to'](_0x13008e(0x2d6))['emit'](_0x13008e(0x302),_0x13008e(0x275)));}),process[_0x15230b(0x296)](_0x15230b(0x2ed),()=>{const _0x5daedd=_0x15230b;if(tgBot)tgBot[_0x5daedd(0x22c)]();process[_0x5daedd(0x27a)](0x1);}),process[_0x15230b(0x296)](_0x15230b(0x1c6),()=>{const _0xec4a50=_0x15230b;if(tgBot)tgBot[_0xec4a50(0x22c)]();process[_0xec4a50(0x27a)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x255c76,_0x3e905d){const _0x18e9b7=_0x43ec7f;if(settings[_0x18e9b7(0x226)]){if(settings['telegramEvents']=='all'||(_0x3e905d['type']=='error'||_0x3e905d['type']=='warning'||_0x3e905d['type']==_0x18e9b7(0x1ef))&&settings[_0x18e9b7(0x264)]==_0x18e9b7(0x2e1)||_0x3e905d['type']=='order'&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x18e9b7(0x356)]){if(_0x3e905d[_0x18e9b7(0x21f)])tgBot['sendMessage'](settings[_0x18e9b7(0x356)],_0x3e905d[_0x18e9b7(0x273)]+_0x18e9b7(0x32b)+_0x3e905d[_0x18e9b7(0x335)])['catch'](_0x4898c2=>{telegramError(_0x4898c2);});else tgBot[_0x18e9b7(0x348)](settings[_0x18e9b7(0x356)],_0x18e9b7(0x291)+_0x255c76+'\x20>\x20'+_0x3e905d[_0x18e9b7(0x335)])[_0x18e9b7(0x218)](_0x2b0f5c=>{telegramError(_0x2b0f5c);});}}}}async function sendTelegramMsg(_0x7cc9c3,_0x5232e8=_0x43ec7f(0x224)){const _0x29cd5f=_0x43ec7f;return settings[_0x29cd5f(0x226)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0x29cd5f(0x356)],_0x7cc9c3,{'parse_mode':_0x5232e8})['catch'](_0x1c0543=>{telegramError(_0x1c0543);}),!![]):![];}function getDeviceWithIp(_0x361780){const _0x32c276=_0x43ec7f;return devices[_0x32c276(0x2a5)](_0x136c2b=>_0x136c2b['ip']===_0x361780);}function temporaryAccess2FA(_0x5642c0,_0x25daee){const _0x10b720=_0x43ec7f;let _0x185b52=new Date(),_0x4b20f0=![];if(lastIpApproval){if(_0x185b52-lastIpApproval<0x1388)_0x4b20f0=!![];}lastIpApproval=new Date();if(_0x4b20f0)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x10b720(0x1e0)](_0x10b720(0x313)),tgBot[_0x10b720(0x348)](settings['telegramChatId'],_0x10b720(0x1dd)+normalizeIP(_0x25daee)[_0x10b720(0x2e6)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x10b720(0x2d4),'callback_data':'30'},{'text':'reject','callback_data':_0x10b720(0x36a)}]]}})[_0x10b720(0x218)](_0x349562=>{telegramError(_0x349562);}),tgBot['on']('callback_query',async _0x1fc54f=>{const _0x17a9eb=_0x10b720,_0x1b6389=_0x1fc54f[_0x17a9eb(0x2a3)],_0x48d55e=_0x1fc54f[_0x17a9eb(0x276)];tgBot[_0x17a9eb(0x1d4)](_0x1fc54f['id'])[_0x17a9eb(0x1d7)](async()=>{const _0x23d013=_0x17a9eb;devices[_0x5642c0][_0x23d013(0x1d3)]={'clientip':_0x25daee,'timestamp':new Date()[_0x23d013(0x2c6)](),'expiry':_0x1b6389},_0x1b6389!=_0x23d013(0x36a)?(await tgBot['sendMessage'](_0x48d55e['chat']['id'],'Access\x20enabled\x20for\x20'+_0x1b6389+_0x23d013(0x2c5),{'parse_mode':_0x23d013(0x224)})[_0x23d013(0x218)](_0xc5ec4b=>{telegramError(_0xc5ec4b);}),io['to'](_0x5642c0)[_0x23d013(0x274)](_0x23d013(0x229),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x48d55e[_0x23d013(0x33a)]['id'],_0x23d013(0x225))[_0x23d013(0x218)](_0x340faa=>{telegramError(_0x340faa);}),io['to'](_0x5642c0)['emit'](_0x23d013(0x229),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x17a9eb(0x1e0)](_0x17a9eb(0x313));}));}function loginAccess2FA(_0x42083c,_0x2987a8){const _0x4de039=_0x43ec7f;tgBot&&settings[_0x4de039(0x356)]&&(tgBot[_0x4de039(0x1e0)](_0x4de039(0x313)),tgBot['sendMessage'](settings[_0x4de039(0x356)],_0x4de039(0x367)+normalizeIP(_0x2987a8)[_0x4de039(0x2e6)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4de039(0x22e),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x4de039(0x36a)}]]}})['catch'](_0xc1a996=>{telegramError(_0xc1a996);}),tgBot['on'](_0x4de039(0x313),async _0x5b9f4a=>{const _0x32d3e5=_0x4de039,_0x39c2a0=_0x5b9f4a['data'],_0x5144e9=_0x5b9f4a[_0x32d3e5(0x276)];tgBot[_0x32d3e5(0x1d4)](_0x5b9f4a['id'])[_0x32d3e5(0x1d7)](async()=>{const _0x500cab=_0x32d3e5;devices[_0x42083c][_0x500cab(0x288)]={'clientip':_0x2987a8,'timestamp':new Date()[_0x500cab(0x2c6)](),'expiry':_0x39c2a0},_0x39c2a0!='reject'?(await tgBot[_0x500cab(0x348)](_0x5144e9[_0x500cab(0x33a)]['id'],'Login\x20accepted',{'parse_mode':_0x500cab(0x224)})[_0x500cab(0x218)](_0x3b4f22=>{telegramError(_0x3b4f22);}),io['to'](_0x42083c)[_0x500cab(0x274)](_0x500cab(0x229),{'access':{'allow':![],'reason':_0x500cab(0x2bc),'token':null}})):(await tgBot['sendMessage'](_0x5144e9[_0x500cab(0x33a)]['id'],'Login\x20rejected')[_0x500cab(0x218)](_0x3eecfb=>{telegramError(_0x3eecfb);}),io['to'](_0x42083c)[_0x500cab(0x274)](_0x500cab(0x229),{'access':{'allow':![],'reason':_0x500cab(0x261),'token':null}}));}),tgBot[_0x32d3e5(0x1e0)](_0x32d3e5(0x313));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x333808=_0x43ec7f;return dbConfig[_0x333808(0x31b)](_0x333808(0x285))[_0x333808(0x35b)](_0x333808(0x1f5))[_0x333808(0x29a)]({'status':_0x333808(0x2e9)})[_0x333808(0x203)]()||[];}function getDisabledBots(){const _0x47d7ea=_0x43ec7f;return dbConfig[_0x47d7ea(0x31b)](_0x47d7ea(0x285))[_0x47d7ea(0x35b)](_0x47d7ea(0x1f5))[_0x47d7ea(0x29a)]({'status':_0x47d7ea(0x371)})['value']()||[];}function getBotAttributes(_0x435f97){const _0x43fafe=_0x43ec7f;let _0x38c93a={};const _0x43d543=configpath+_0x43fafe(0x352)+_0x435f97+_0x43fafe(0x326),_0x129e83=fs[_0x43fafe(0x34c)](_0x43d543);if(_0x129e83){const _0x1d2373=fs[_0x43fafe(0x340)](_0x43d543);try{const _0x5a46c2=JSON[_0x43fafe(0x2e4)](_0x1d2373),_0x45a032=_0x5a46c2?_0x5a46c2[_0x43fafe(0x27c)][0x0]['headless']:![];_0x38c93a['mode']=_0x45a032?_0x43fafe(0x358):_0x43fafe(0x317),_0x38c93a[_0x43fafe(0x273)]=_0x5a46c2?_0x5a46c2['bot'][0x0][_0x43fafe(0x273)]:'Bot\x20'+_0x435f97;}catch(_0x59c68b){_0x38c93a['mode']=_0x43fafe(0x317),_0x38c93a[_0x43fafe(0x273)]=_0x43fafe(0x291)+_0x435f97;}}else _0x38c93a['mode']=_0x43fafe(0x317),_0x38c93a[_0x43fafe(0x273)]=_0x43fafe(0x291)+_0x435f97;return _0x38c93a;}function getBotsWithMode(){const _0x2fc11e=_0x43ec7f,_0x125776=dbConfig['get'](_0x2fc11e(0x285))[_0x2fc11e(0x35b)](_0x2fc11e(0x1f5))['value']()||[];return _0x125776[_0x2fc11e(0x1dc)](_0x30aad1=>{const _0x300010=_0x2fc11e;let _0x4b5ad1=getBotAttributes(_0x30aad1[_0x300010(0x1f5)]);_0x30aad1[_0x300010(0x245)]=_0x4b5ad1[_0x300010(0x245)];}),_0x125776;}async function initUser(){const _0x46040d=_0x43ec7f;if(!settings[_0x46040d(0x1d2)]){const _0x353c91=uuidRandom();mixpanel['alias'](_0x353c91),updateSetting(_0x46040d(0x1d2),_0x353c91);}}async function initSecure(){const _0x28b767=_0x43ec7f;let _0x7788fb=getSecure();if(!_0x7788fb[_0x28b767(0x26d)](_0x28b767(0x251))){let _0x4cdb8d=await generateKeys();_0x7788fb['publicKey']=_0x4cdb8d[_0x28b767(0x290)],_0x7788fb['privateKey']=_0x4cdb8d[_0x28b767(0x30f)],_0x7788fb[_0x28b767(0x251)]=crypto[_0x28b767(0x29c)](0x20)[_0x28b767(0x1e8)](_0x28b767(0x1da));;storeSecure(_0x7788fb);}}function getSettings(){const _0x528734=_0x43ec7f;return dbSettings[_0x528734(0x31b)]('settings')[_0x528734(0x203)]()||{};}function getSecure(){const _0x55a212=_0x43ec7f;return dbSecure[_0x55a212(0x31b)](_0x55a212(0x2b8))[_0x55a212(0x203)]()||{};}function getBlacklist(){const _0x31c985=_0x43ec7f;return dbSecure[_0x31c985(0x31b)]('blacklist')['value']()||[];}function broadcastToBots(_0x22d1c4,_0x1cfa48){const _0x3836ff=_0x43ec7f;config[_0x3836ff(0x1dc)](_0x448123=>{const _0x2a6044=_0x3836ff;if(_0x448123[_0x2a6044(0x229)]==_0x2a6044(0x2e9)&&_0x448123[_0x2a6044(0x31a)]=='running'){if(pid[_0x448123[_0x2a6044(0x1f5)]])pid[_0x448123[_0x2a6044(0x1f5)]][_0x2a6044(0x23c)]({[_0x22d1c4]:_0x1cfa48});}});}function storeSettings(_0x52fc88,_0x437540=![]){const _0x393e73=_0x43ec7f;_0x52fc88={...settings,..._0x52fc88};if(_0x437540&&_0x52fc88[_0x393e73(0x2ba)]!=_0x393e73(0x269)&&_0x52fc88[_0x393e73(0x2ba)]!=_0x393e73(0x2a4)&&_0x52fc88['bbPassword']!=''){const _0x52c20f=crypt[_0x393e73(0x223)](secure[_0x393e73(0x30f)],_0x52fc88['bbPassword'])[_0x393e73(0x276)][_0x393e73(0x28f)]('@')[0x0],_0x410f4f=bcrypt[_0x393e73(0x29f)](_0x52c20f,saltRounds);_0x52fc88={..._0x52fc88,'bbPassword':_0x410f4f};}if(_0x437540&&_0x52fc88[_0x393e73(0x2c8)]!='************'&&_0x52fc88[_0x393e73(0x2c8)]!=_0x393e73(0x2a4)&&_0x52fc88[_0x393e73(0x2c8)]!=''){const _0x2ed4d7=crypt[_0x393e73(0x223)](secure[_0x393e73(0x30f)],_0x52fc88[_0x393e73(0x2c8)])[_0x393e73(0x276)]['split']('@')[0x0];_0x52fc88={..._0x52fc88,'telegramToken':_0x2ed4d7};}const _0x55a877=_0x52fc88[_0x393e73(0x2c8)]!=_0x393e73(0x269)&&_0x52fc88[_0x393e73(0x2c8)]!=settings[_0x393e73(0x2c8)]||_0x52fc88[_0x393e73(0x2be)]!=settings[_0x393e73(0x2be)],_0x48b131=_0x52fc88['telegramToken']==''||_0x52fc88['telegramUsername']=='';if(_0x55a877)_0x52fc88[_0x393e73(0x264)]='all';for(const [_0x24585f,_0x35fe25]of Object[_0x393e73(0x25c)](_0x52fc88)){if(_0x24585f==_0x393e73(0x2c8)&&_0x35fe25==_0x393e73(0x269)){_0x52fc88[_0x393e73(0x2c8)]=settings[_0x393e73(0x2c8)];continue;};if(_0x24585f==_0x393e73(0x2ba)&&_0x35fe25==_0x393e73(0x269)){_0x52fc88[_0x393e73(0x2ba)]=settings[_0x393e73(0x2ba)];continue;};dbSettings[_0x393e73(0x268)](_0x393e73(0x34a)+_0x24585f,_0x35fe25)['write']();}settings=_0x52fc88,io['to'](_0x393e73(0x2d6))[_0x393e73(0x274)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x393e73(0x215)]);if(_0x55a877&&!_0x48b131)initTelegram();if(_0x55a877&&_0x48b131)disableTelegram();getAllClients()[_0x393e73(0x1dc)](_0x502aa7=>{const _0x1a5525=_0x393e73;getSocket(_0x502aa7['id'])[_0x1a5525(0x274)](_0x1a5525(0x229),{'access':{'allow':![],'reason':_0x1a5525(0x2bc),'token':null}});});}function updateSetting(_0x2f90ad,_0x4ba65c){const _0x45e806=_0x43ec7f;dbSettings[_0x45e806(0x268)](_0x45e806(0x34a)+_0x2f90ad,_0x4ba65c)[_0x45e806(0x235)](),settings=getSettings(),io['to']('botmanager')[_0x45e806(0x274)](_0x45e806(0x1fd),cleanSettings());}function storeSecure(_0x4428fa){const _0x5ccb76=_0x43ec7f;dbSecure[_0x5ccb76(0x31b)](_0x5ccb76(0x2b8))[_0x5ccb76(0x2f1)](_0x4428fa)['write'](),secure=_0x4428fa;}function addBlacklist(_0x4efd30){const _0x3cb3db=_0x43ec7f;cleanBlacklist();let _0x10bc3c;devices[_0x4efd30][_0x3cb3db(0x1d3)]?_0x10bc3c=Math[_0x3cb3db(0x254)](devices[_0x4efd30][_0x3cb3db(0x1d3)]['expiry'],loginExpiry):_0x10bc3c=loginExpiry,dbSecure[_0x3cb3db(0x31b)](_0x3cb3db(0x1cb))[_0x3cb3db(0x2f1)]({'expiry':new Date()[_0x3cb3db(0x2c6)]()+_0x10bc3c*0x3c*0x3e8,'token':devices[_0x4efd30][_0x3cb3db(0x2de)][_0x3cb3db(0x31d)]})['write'](),blacklist=dbSecure[_0x3cb3db(0x31b)](_0x3cb3db(0x1cb))['value']();}function cleanBlacklist(){const _0x40d842=_0x43ec7f;let _0x2d3cc9=dbSecure['get']('blacklist')[_0x40d842(0x1d9)]()[_0x40d842(0x203)](),_0x5d7ad=new Date()[_0x40d842(0x2c6)]();_0x2d3cc9[_0x40d842(0x1dc)](_0x4ca6dd=>{const _0x13f574=_0x40d842;_0x4ca6dd['expiry']<_0x5d7ad&&dbSecure[_0x13f574(0x31b)]('blacklist')[_0x13f574(0x2a6)]({'expiry':_0x4ca6dd['expiry']})[_0x13f574(0x235)]();});}function initStates(){const _0x5e562c=_0x43ec7f;let _0x57bfa6=getConfiguration();_0x57bfa6[_0x5e562c(0x1dc)](_0x40db80=>{const _0x574470=_0x5e562c;_0x40db80[_0x574470(0x31a)]=_0x574470(0x361);}),storeConfiguration(_0x57bfa6);}function onKeys(){const _0x29591f=new RSA();return new Promise(_0x34ee74=>{const _0x1ec8b8=_0x2f3c;_0x29591f[_0x1ec8b8(0x337)]()[_0x1ec8b8(0x1d7)](_0x3da812=>{_0x34ee74(_0x3da812);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x510f90=_0x43ec7f;let _0x3194b2=getSettings(),_0x3644cd=![];!_0x3194b2['hasOwnProperty'](_0x510f90(0x2bf))&&(_0x3194b2[_0x510f90(0x2bf)]=0x0,_0x3644cd=!![]);!_0x3194b2['hasOwnProperty'](_0x510f90(0x36c))&&(_0x3194b2[_0x510f90(0x36c)]=0x0,_0x3644cd=!![]);!_0x3194b2[_0x510f90(0x26d)](_0x510f90(0x362))&&(_0x3194b2[_0x510f90(0x362)]=_0x510f90(0x219),_0x3644cd=!![]);if(_0x3644cd)storeSettings(_0x3194b2);}function storeConfiguration(_0x4fdf76){const _0x43ccaf=_0x43ec7f;dbConfig[_0x43ccaf(0x31b)]('bots')[_0x43ccaf(0x2a6)]()[_0x43ccaf(0x235)](),_0x4fdf76[_0x43ccaf(0x1dc)](_0x3791a9=>{const _0x1b6f4a=_0x43ccaf;delete _0x3791a9[_0x1b6f4a(0x245)];}),dbConfig[_0x43ccaf(0x31b)](_0x43ccaf(0x285))[_0x43ccaf(0x2f1)](..._0x4fdf76)['write'](),config=_0x4fdf76;}function resetPassword(){const _0x37baba=_0x43ec7f;tgBot&&settings[_0x37baba(0x356)]&&(tgBot[_0x37baba(0x1e0)]('callback_query'),tgBot[_0x37baba(0x348)](settings['telegramChatId'],_0x37baba(0x2c9),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x37baba(0x1f4),'callback_data':_0x37baba(0x1f4)},{'text':'no','callback_data':'no'}]]}})[_0x37baba(0x218)](_0x335913=>{telegramError(_0x335913);}),tgBot['on']('callback_query',async _0x2f01d7=>{const _0x4512d8=_0x37baba,_0x40663e=_0x2f01d7[_0x4512d8(0x2a3)],_0x51d051=_0x2f01d7['message'];tgBot[_0x4512d8(0x1d4)](_0x2f01d7['id'])[_0x4512d8(0x1d7)](async()=>{const _0x532efa=_0x4512d8;if(_0x40663e!='no'){const _0x401897=0xf,_0x5f38b4='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0xd7c150=Array[_0x532efa(0x2e8)](crypto[_0x532efa(0x21b)](new Uint32Array(_0x401897)))['map'](_0x401c30=>_0x5f38b4[_0x401c30%_0x5f38b4[_0x532efa(0x281)]])[_0x532efa(0x309)](''),_0x5c6492=bcrypt[_0x532efa(0x29f)](_0xd7c150,saltRounds);storeSettings({'bbPassword':_0x5c6492}),await tgBot[_0x532efa(0x348)](_0x51d051[_0x532efa(0x33a)]['id'],_0x532efa(0x232)+_0xd7c150,{'parse_mode':_0x532efa(0x224)})[_0x532efa(0x218)](_0x25c698=>{telegramError(_0x25c698);});}else await tgBot[_0x532efa(0x348)](_0x51d051[_0x532efa(0x33a)]['id'],'Password\x20reset\x20rejected')['catch'](_0x23b6ee=>{telegramError(_0x23b6ee);});}),tgBot[_0x4512d8(0x1e0)](_0x4512d8(0x313));}));}async function confirmRestore(_0x4f5161,_0x4fc624){const _0x56a7a0=_0x43ec7f;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),await tgBot[_0x56a7a0(0x348)](settings[_0x56a7a0(0x356)],_0x56a7a0(0x2f0),{'parse_mode':_0x56a7a0(0x224),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x56a7a0(0x1f4)},{'text':'no','callback_data':'no'}]]}})[_0x56a7a0(0x218)](_0x16e748=>{telegramError(_0x16e748);}),tgBot['on'](_0x56a7a0(0x313),async _0xb18982=>{const _0x2f26c9=_0x56a7a0,_0x3d4aae=_0xb18982[_0x2f26c9(0x2a3)],_0x3af455=_0xb18982[_0x2f26c9(0x276)];tgBot[_0x2f26c9(0x1d4)](_0xb18982['id'])[_0x2f26c9(0x1d7)](async()=>{const _0xe575ec=_0x2f26c9;_0x3d4aae=='yes'?(await tgBot[_0xe575ec(0x348)](_0x3af455[_0xe575ec(0x33a)]['id'],_0xe575ec(0x304),{'parse_mode':'HTML'})[_0xe575ec(0x218)](_0x783269=>{telegramError(_0x783269);}),unzipFile(_0x4f5161,_0x4fc624)):await tgBot[_0xe575ec(0x348)](_0x3af455[_0xe575ec(0x33a)]['id'],_0xe575ec(0x319))[_0xe575ec(0x218)](_0x474f97=>{telegramError(_0x474f97);});}),tgBot['removeListener'](_0x2f26c9(0x313));}));}function getServerTime(){const _0x38d7ab=_0x43ec7f,_0x58cb29=new Date();return _0x58cb29[_0x38d7ab(0x2fe)]()+'/'+(_0x58cb29[_0x38d7ab(0x21e)]()+0x1)['toString']()[_0x38d7ab(0x315)](0x2,'0')+'/'+_0x58cb29[_0x38d7ab(0x36f)]()[_0x38d7ab(0x1e8)]()['padStart'](0x2,'0')+'\x20'+_0x58cb29[_0x38d7ab(0x31e)]()['toString']()[_0x38d7ab(0x315)](0x2,'0')+':'+_0x58cb29[_0x38d7ab(0x35f)]()[_0x38d7ab(0x1e8)]()[_0x38d7ab(0x315)](0x2,'0')+':'+_0x58cb29[_0x38d7ab(0x265)]()[_0x38d7ab(0x1e8)]()[_0x38d7ab(0x315)](0x2,'0');}function getTimeStamp(){const _0x1a8377=_0x43ec7f,_0x4fedd3=shiftedTime();return _0x4fedd3[_0x1a8377(0x2fe)]()+'/'+(_0x4fedd3[_0x1a8377(0x21e)]()+0x1)['toString']()[_0x1a8377(0x315)](0x2,'0')+'/'+_0x4fedd3[_0x1a8377(0x36f)]()[_0x1a8377(0x1e8)]()[_0x1a8377(0x315)](0x2,'0')+'\x20'+_0x4fedd3[_0x1a8377(0x31e)]()[_0x1a8377(0x1e8)]()[_0x1a8377(0x315)](0x2,'0')+':'+_0x4fedd3[_0x1a8377(0x35f)]()[_0x1a8377(0x1e8)]()['padStart'](0x2,'0')+':'+_0x4fedd3[_0x1a8377(0x265)]()[_0x1a8377(0x1e8)]()[_0x1a8377(0x315)](0x2,'0');}function shiftedTime(){const _0x454719=_0x43ec7f,_0x54b4f7=new Date();let _0x40de6f=_0x54b4f7;if(settings[_0x454719(0x215)]&&settings['timeshift']!==0x0)_0x40de6f=fns[_0x454719(0x2c7)](_0x54b4f7,{'hours':settings['timeshift']});return _0x40de6f;}function startScheduler(){const _0xa74c14=_0x43ec7f,_0x1c483a=new Date()[_0xa74c14(0x2b1)](),_0x1744c0=shiftedTime()['getHours']();_0x1744c0==0x4&&backupConfigFiles();_0x1744c0==0x0&&rotateLogFiles();_0x1c483a%0x6==0x0&&triggerAnalytics();_0x1c483a%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x3061e7=_0x43ec7f;fs[_0x3061e7(0x32f)](configpath,{'withFileTypes':!![]})['forEach'](_0x3a4989=>{const _0x221949=_0x3061e7;if(!_0x3a4989[_0x221949(0x2d9)]())fs[_0x221949(0x297)](configpath+_0x3a4989[_0x221949(0x234)],configbackuppath+_0x3a4989[_0x221949(0x234)]);});}function rotateLogFiles(){const _0x29f14d=_0x43ec7f,_0x2caf56=fs['statSync'](logspath+_0x29f14d(0x316)),_0x9922dc=_0x2caf56[_0x29f14d(0x27e)]/0x400;if(_0x9922dc>0x32){let _0x2d6efa=fs[_0x29f14d(0x32f)](logspath,{'withFileTypes':!![]});_0x2d6efa[_0x29f14d(0x24f)]((_0x4fef10,_0x367b9c)=>_0x4fef10['name']<_0x367b9c[_0x29f14d(0x234)]?0x1:_0x367b9c[_0x29f14d(0x234)]<_0x4fef10[_0x29f14d(0x234)]?-0x1:0x0),_0x2d6efa[_0x29f14d(0x1dc)](_0x1c3442=>{const _0x4cf9eb=_0x29f14d;if(_0x1c3442[_0x4cf9eb(0x234)]==_0x4cf9eb(0x35e))fs[_0x4cf9eb(0x297)](logspath+_0x1c3442[_0x4cf9eb(0x234)],logspath+_0x4cf9eb(0x2d7));if(_0x1c3442[_0x4cf9eb(0x234)]==_0x4cf9eb(0x36d))fs['copyFileSync'](logspath+_0x1c3442['name'],logspath+_0x4cf9eb(0x35e));_0x1c3442[_0x4cf9eb(0x234)]==_0x4cf9eb(0x316)&&(fs[_0x4cf9eb(0x297)](logspath+_0x1c3442[_0x4cf9eb(0x234)],logspath+_0x4cf9eb(0x36d)),fs['writeFileSync'](logspath+_0x1c3442['name'],''));});}}async function zipFiles(_0x387172){const _0x47f24a=_0x43ec7f;let _0x3e7e71;if(_0x387172==_0x47f24a(0x292))_0x3e7e71=logspath;if(_0x387172==_0x47f24a(0x201))_0x3e7e71=configpath;let _0x56092c=fs[_0x47f24a(0x32f)](_0x3e7e71,{'withFileTypes':!![]});const _0x291dda=new require(_0x47f24a(0x2e0))();_0x56092c[_0x47f24a(0x1dc)](_0x137a63=>{const _0x5d8a73=_0x47f24a;if(!_0x137a63[_0x5d8a73(0x2d9)]()){let _0x174c98=fs[_0x5d8a73(0x340)](_0x3e7e71+_0x137a63[_0x5d8a73(0x234)]);const _0xc5d1b4=/^bot-[0-9]{3}-config.json$/,_0x1d4237=_0xc5d1b4[_0x5d8a73(0x1d8)](_0x137a63[_0x5d8a73(0x234)]);if(_0x1d4237){const _0x10b7cb=JSON[_0x5d8a73(0x2e4)](_0x174c98);_0x10b7cb[_0x5d8a73(0x27c)][0x0][_0x5d8a73(0x300)]=_0x5d8a73(0x2a4),_0x10b7cb[_0x5d8a73(0x27c)][0x0][_0x5d8a73(0x2fa)]=_0x5d8a73(0x2a4),_0x174c98=JSON[_0x5d8a73(0x33b)](_0x10b7cb,null,0x2);}if(_0x137a63[_0x5d8a73(0x234)]==_0x5d8a73(0x2b4)){const _0x5d7e52=JSON[_0x5d8a73(0x2e4)](_0x174c98);if(_0x5d7e52['settings']['loginRequired'])_0x5d7e52[_0x5d8a73(0x1fd)]['loginRequired']=![];if(_0x5d7e52[_0x5d8a73(0x1fd)]['bbPassword'])_0x5d7e52['settings']['bbPassword']='***';if(_0x5d7e52[_0x5d8a73(0x1fd)][_0x5d8a73(0x2c8)])_0x5d7e52[_0x5d8a73(0x1fd)][_0x5d8a73(0x2c8)]='***';if(_0x5d7e52[_0x5d8a73(0x1fd)][_0x5d8a73(0x356)])_0x5d7e52[_0x5d8a73(0x1fd)][_0x5d8a73(0x356)]=null;_0x174c98=JSON['stringify'](_0x5d7e52,null,0x2);}if(_0x137a63[_0x5d8a73(0x234)]!='bb-secure.json')_0x291dda[_0x5d8a73(0x2a0)](_0x137a63[_0x5d8a73(0x234)],_0x174c98);}});const _0x499ede=_0x291dda[_0x47f24a(0x237)]({'base64':![],'compression':_0x47f24a(0x2c4)});fs[_0x47f24a(0x25e)](zippath+(_0x387172+'.zip'),_0x499ede,_0x47f24a(0x339));}async function unzipFile(_0x1f37e6,_0x53b441){const _0x3ed90a=_0x43ec7f;await backupConfigFiles(),fs[_0x3ed90a(0x32f)](configpath,{'withFileTypes':!![]})['forEach'](_0x47d565=>{const _0x44827a=_0x3ed90a;if(!_0x47d565[_0x44827a(0x2d9)]())fs[_0x44827a(0x351)](configpath+_0x47d565[_0x44827a(0x234)]);});const _0x227858=fs[_0x3ed90a(0x340)](_0x1f37e6+_0x53b441,'binary'),_0x91e94d=new require(_0x3ed90a(0x2e0))(_0x227858,{'base64':![],'checkCRC32':!![]});Object[_0x3ed90a(0x320)](_0x91e94d[_0x3ed90a(0x20e)])[_0x3ed90a(0x1dc)](_0x5ee4bd=>{const _0x59223e=_0x3ed90a,_0xda5584=_0x91e94d['files'][_0x5ee4bd];fs['writeFileSync'](configpath+_0xda5584[_0x59223e(0x234)],_0xda5584[_0x59223e(0x295)]);}),fs[_0x3ed90a(0x32f)](temppath,{'withFileTypes':!![]})[_0x3ed90a(0x1dc)](_0xecf21d=>{const _0x5d9fd8=_0x3ed90a;if(!_0xecf21d[_0x5d9fd8(0x2d9)]())fs[_0x5d9fd8(0x351)](temppath+_0xecf21d[_0x5d9fd8(0x234)]);}),process[_0x3ed90a(0x23c)]({'restore':!![]},_0x3a12b9=>{});}async function getPublicIp(){const _0x5bdcfd=_0x43ec7f;try{const _0x5e20c6=await axios[_0x5bdcfd(0x31b)]('https://api.ipify.org?format=json');publicip=_0x5e20c6[_0x5bdcfd(0x2a3)]['ip'];}catch(_0x2bba93){}}async function triggerAnalytics(){const _0x54a3fc=_0x43ec7f;if(!publicip)await getPublicIp();const _0x410780=getBotsWithMode();let _0x2cb206=0x0;_0x410780[_0x54a3fc(0x1dc)](_0x9fe5c2=>{const _0x511e69=_0x54a3fc;if(_0x9fe5c2['status']===_0x511e69(0x2e9))_0x2cb206++;}),mixpanel[_0x54a3fc(0x2af)](_0x54a3fc(0x1ff),{'distinct_id':settings[_0x54a3fc(0x1d2)],'ip':publicip,'version':serverversion,'numbots':_0x410780[_0x54a3fc(0x281)],'numbotsenabled':_0x2cb206});}async function getMessages(){const _0x34bc12=_0x43ec7f,_0x53bd0a=_0x34bc12(0x2b7),_0x1e8b08=new GraphQLClient(_0x53bd0a),_0x426985={'authorization':_0x34bc12(0x36e)},_0xc1a2ec=serverversion[_0x34bc12(0x28f)]('.'),_0x1f83ce=_0xc1a2ec[0x0]+'.'+_0xc1a2ec[0x1],_0x39c88b=Math[_0x34bc12(0x2b2)](settings['lastmsgtelegram'],settings[_0x34bc12(0x36c)]),_0x308c23={'last':parseInt(_0x39c88b),'bbm':_0x1f83ce},_0x4bf32d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x33a213;try{_0x33a213=await _0x1e8b08[_0x34bc12(0x2f3)](_0x4bf32d,_0x308c23,_0x426985);}catch(_0x54d0c5){}if(_0x33a213&&_0x33a213[_0x34bc12(0x2f5)]){let _0x35b088=settings[_0x34bc12(0x2bf)];newMessages=[];for(const _0x320089 of _0x33a213[_0x34bc12(0x2f5)]){newMessages[_0x34bc12(0x2f1)](_0x320089);if(_0x320089[_0x34bc12(0x34b)])updateSetting(_0x34bc12(0x362),_0x320089[_0x34bc12(0x34b)]);let _0x380ad4=_0x320089['bbvNew']?serverversion>=_0x320089[_0x34bc12(0x34b)]:![];if(!_0x380ad4&&_0x320089[_0x34bc12(0x2ff)]>_0x35b088){if(_0x320089[_0x34bc12(0x1db)]===_0x34bc12(0x331)||serverversion['startsWith'](_0x320089[_0x34bc12(0x1db)])){let _0x1efafe=''+_0x320089[_0x34bc12(0x231)]+'\x0a\x0a'+_0x320089['message'];const _0x2c8a09=await sendTelegramMsg(toTelegramMarkdown(_0x1efafe),_0x34bc12(0x2aa));if(_0x2c8a09)_0x35b088=_0x320089[_0x34bc12(0x2ff)];}}}updateAvailable=isNewerVersion(settings[_0x34bc12(0x362)],serverversion),updateSetting('lastmsgtelegram',_0x35b088),emitMessages();}}function emitMessages(){const _0x4913a6=_0x43ec7f,_0xdd61ec=settings[_0x4913a6(0x36c)];let _0x2da3e8=[];newMessages[_0x4913a6(0x1dc)](_0x50e07f=>{const _0x27a5da=_0x4913a6;_0x50e07f[_0x27a5da(0x2ff)]>_0xdd61ec&&_0x2da3e8['push'](_0x50e07f);}),_0x2da3e8[_0x4913a6(0x281)]>0x0&&getAllClients()[_0x4913a6(0x1dc)](_0x15a963=>{const _0x505670=_0x4913a6;getSocket(_0x15a963['id'])['emit'](_0x505670(0x276),_0x2da3e8);});}function confirmMessage(_0x424ad3){const _0xa67f2d=_0x43ec7f;updateSetting(_0xa67f2d(0x36c),Number(_0x424ad3));}function isNewerVersion(_0xc8c4b,_0x3beaae){const _0x1b0444=_0x43ec7f,_0x4ebf3e=_0x3beaae[_0x1b0444(0x28f)]('.'),_0xd376ad=_0xc8c4b[_0x1b0444(0x28f)]('.');for(var _0x21f0c5=0x0;_0x21f0c5<_0xd376ad['length'];_0x21f0c5++){const _0x33033e=~~_0xd376ad[_0x21f0c5],_0x12210b=~~_0x4ebf3e[_0x21f0c5];if(_0x33033e>_0x12210b)return!![];if(_0x33033e<_0x12210b)return![];}return![];}function toTelegramMarkdown(_0x415719){const _0x4c3b2d=_0x43ec7f,_0x59fa6c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1de490=/\*{2}(.+?)\*{2}/gim;return _0x415719=_0x415719[_0x4c3b2d(0x21a)](_0x59fa6c,_0x4c3b2d(0x1f3))[_0x4c3b2d(0x21a)](_0x1de490,_0x4c3b2d(0x2b5)),_0x415719;}async function validateConfigFile(){const _0x842496=_0x43ec7f,_0x5c9cf7=dbConfig[_0x842496(0x31b)](_0x842496(0x285))[_0x842496(0x35b)](_0x842496(0x1f5))[_0x842496(0x203)]()||[];if(_0x5c9cf7[_0x842496(0x281)]==0x0){let _0x4dfb06=0x0,_0x3adf46=[];const _0x580331=/^bot-([0-9]{3})-config.json$/,_0x1d4861=fs[_0x842496(0x32f)](configpath);_0x1d4861[_0x842496(0x1dc)](_0x14a859=>{const _0x26c93e=_0x842496,_0x4ebc99=_0x580331[_0x26c93e(0x227)](_0x14a859);if(_0x4ebc99){const _0x4c7443=_0x4ebc99[0x1];let _0x5550db=getBotAttributes(_0x4c7443);_0x3adf46[_0x26c93e(0x2f1)]({'botID':_0x4c7443,'botname':_0x5550db[_0x26c93e(0x273)],'status':'disabled','live':'stopped'}),_0x4dfb06++;}}),_0x4dfb06!=0x0&&(dbConfig[_0x842496(0x31b)](_0x842496(0x285))[_0x842496(0x1e2)](_0x3adf46)['write'](),config=_0x3adf46,restoredConfigFile=_0x4dfb06);}}async function restoreConfigNotify(_0x41305c){const _0x5b8060=_0x43ec7f;let _0x228ad3;if(restoredConfigFile==0x1)_0x228ad3=_0x5b8060(0x1e5);else _0x228ad3=_0x5b8060(0x22b);if(_0x41305c)io['to'](_0x5b8060(0x2d6))[_0x5b8060(0x274)](_0x5b8060(0x302),_0x228ad3);else{logger[_0x5b8060(0x2a9)](_0x5b8060(0x2ee)),logger[_0x5b8060(0x2a9)](_0x228ad3),logger[_0x5b8060(0x2a9)]('-----------------------------------------------------------------------------------'),logger[_0x5b8060(0x2a9)]('');if(tgBot&&settings[_0x5b8060(0x356)]&&settings[_0x5b8060(0x264)]!=_0x5b8060(0x293))tgBot[_0x5b8060(0x348)](settings[_0x5b8060(0x356)],_0x5b8060(0x221)+_0x228ad3)[_0x5b8060(0x218)](_0x4b000e=>{telegramError(_0x4b000e);});}}function validateCredentials(_0x98a3d7,_0x50ba36){const _0x173c05=_0x43ec7f;if(_0x98a3d7['username']==settings[_0x173c05(0x2d8)]&&bcrypt[_0x173c05(0x2ca)](_0x98a3d7['password'],settings['bbPassword'])){if(settings[_0x173c05(0x2f9)])return{'allow':![],'reason':_0x173c05(0x205),'token':null};else{const _0x48ba85=generateLoginToken(_0x50ba36);return{'allow':!![],'reason':_0x173c05(0x2ea),'token':_0x48ba85};}}else return{'allow':![],'reason':_0x173c05(0x206),'token':null};}function refreshToken(_0x540aae){const _0x8ea679=_0x43ec7f,_0x24dcd4=generateLoginToken(_0x540aae);return{'allow':!![],'reason':_0x8ea679(0x2ea),'token':_0x24dcd4};}function validateAccess(_0x21b6a6,_0x108210,_0x2f375b){const _0x4e728a=_0x43ec7f,_0x17334=_0x2f375b?_0x2f375b:devices[_0x108210]['ip'];let _0x53f850;const _0x4f169b=_0x313a2f=>{const _0x511333=_0x2f3c;if(settings[_0x511333(0x2ac)]){if(settings[_0x511333(0x2f9)]){if(telegram2FaApproved(_0x108210)){const _0x49800f=generateLoginToken(_0x108210);return{'allow':!![],'reason':_0x511333(0x1c7),'token':_0x49800f};}else return{'allow':![],'reason':_0x511333(0x2ad),'token':null};}else return _0x53f850=validToken(_0x313a2f,_0x108210),_0x53f850['hasOwnProperty'](_0x511333(0x1ef))?{'allow':!![],'reason':_0x511333(0x299),'token':_0x313a2f}:{'allow':![],'reason':_0x511333(0x2ad),'token':null};}else return{'allow':!![],'reason':_0x511333(0x2ab),'token':null};};if(settings[_0x4e728a(0x318)]){let _0x319163=[...settings[_0x4e728a(0x210)],_0x4e728a(0x259),_0x4e728a(0x2c2),'127.0.0.1'];if(_0x319163['includes'](_0x17334))return _0x4f169b(_0x21b6a6);else{_0x53f850=validToken(_0x21b6a6,_0x108210);if(_0x53f850[_0x4e728a(0x26d)]('success'))return _0x4f169b(_0x21b6a6);else{if(telegramIpApproved(_0x108210)){const _0x12ada1=generateToken(_0x108210);return _0x53f850=_0x4f169b(_0x21b6a6),_0x53f850['allow']?{'allow':!![],'reason':_0x4e728a(0x283),'token':_0x12ada1}:_0x53f850;}else return settings[_0x4e728a(0x2db)]?{'allow':![],'reason':_0x4e728a(0x2ec),'token':null}:{'allow':![],'reason':_0x4e728a(0x23e),'token':null};}}}else return _0x4f169b(_0x21b6a6);}function timelyDecrypt(_0x41c18b,_0x5320ae=!![]){const _0x8cdcfa=_0x43ec7f;if(_0x41c18b)try{const _0x26c983=crypt[_0x8cdcfa(0x223)](secure[_0x8cdcfa(0x30f)],_0x41c18b)[_0x8cdcfa(0x276)],_0x393e6f=_0x26c983[_0x8cdcfa(0x28f)]('@')[0x0],_0x3e3820=_0x26c983[_0x8cdcfa(0x28f)]('@')[0x1],_0xd4acc6=new Date()[_0x8cdcfa(0x2c6)]();if(_0x5320ae){if(_0xd4acc6-_0x3e3820<maxSecretAge*0x3e8)return _0x393e6f;else return![];}else return _0x393e6f;}catch(_0x3825dd){return![];}else return![];}const validToken=(_0x5134a4,_0x10c2ce)=>{const _0x424894=_0x43ec7f,_0x1f3f68=devices[_0x10c2ce]['ip'];if(!_0x5134a4)return{'error':_0x424894(0x2ce)};for(let _0x10d8b6 of blacklist){if(_0x10d8b6[_0x424894(0x31d)]==_0x5134a4)return{'error':_0x424894(0x364)};}let _0x1bd17;try{_0x1bd17=jwt['verify'](_0x5134a4,secure[_0x424894(0x251)]+_0x10c2ce);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x1bd17[_0x424894(0x26d)](_0x424894(0x20d))&&!_0x1bd17[_0x424894(0x26d)]('username')||!_0x1bd17['hasOwnProperty'](_0x424894(0x239)))return{'error':_0x424894(0x236)};if(!_0x1bd17[_0x424894(0x26d)](_0x424894(0x1ed))&&_0x1bd17[_0x424894(0x26d)](_0x424894(0x20d))){const {clientip:_0x28f6a6}=_0x1bd17;return _0x1f3f68==_0x28f6a6?{'success':_0x424894(0x321)}:{'error':_0x424894(0x294)};}else{if(_0x1bd17[_0x424894(0x26d)](_0x424894(0x1ed))&&_0x1bd17['hasOwnProperty'](_0x424894(0x20d))){const {username:_0x1d0545,clientip:_0x436321}=_0x1bd17;return settings[_0x424894(0x2d8)]==_0x1d0545&&_0x1f3f68==_0x436321?{'success':_0x424894(0x321)}:{'error':_0x424894(0x24a)};}}},generateLoginToken=_0x332c4c=>{const _0x94cb20=_0x43ec7f;if(_0x332c4c){const _0x911b81=devices[_0x332c4c]['ip'];return jwt[_0x94cb20(0x23f)]({'username':settings['bbUsername'],'clientip':_0x911b81},secure[_0x94cb20(0x251)]+_0x332c4c,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1bf277=>{const _0x1bd1f0=_0x43ec7f;if(_0x1bf277){const _0x257bc4=devices[_0x1bf277]['ip'];return jwt[_0x1bd1f0(0x23f)]({'clientip':_0x257bc4},secure[_0x1bd1f0(0x251)]+_0x1bf277,{'expiresIn':devices[_0x1bf277][_0x1bd1f0(0x1d3)][_0x1bd1f0(0x28c)]*0x3c});}else return![];},telegramIpApproved=_0x18f1f5=>{const _0x271f5d=_0x43ec7f;let _0x402750=![];return devices[_0x18f1f5][_0x271f5d(0x1d3)]&&devices[_0x18f1f5]['telegramIpApproval'][_0x271f5d(0x28c)]!=_0x271f5d(0x36a)&&(_0x402750=devices[_0x18f1f5]['telegramIpApproval'][_0x271f5d(0x20d)]==devices[_0x18f1f5]['ip']&&new Date()[_0x271f5d(0x2c6)]()-devices[_0x18f1f5][_0x271f5d(0x1d3)][_0x271f5d(0x29e)]<devices[_0x18f1f5][_0x271f5d(0x1d3)][_0x271f5d(0x28c)]*0x3c*0x3e8),_0x402750;},telegram2FaApproved=_0x46810c=>{const _0x2fb8c1=_0x43ec7f;let _0x159d73=![];return devices[_0x46810c][_0x2fb8c1(0x288)]&&devices[_0x46810c]['telegram2FaApproval']['expiry']!=_0x2fb8c1(0x36a)&&(_0x159d73=devices[_0x46810c][_0x2fb8c1(0x288)][_0x2fb8c1(0x20d)]==devices[_0x46810c]['ip']&&new Date()[_0x2fb8c1(0x2c6)]()-devices[_0x46810c]['telegram2FaApproval'][_0x2fb8c1(0x29e)]<devices[_0x46810c][_0x2fb8c1(0x288)]['expiry']*0x3c*0x3e8),_0x159d73;},normalizeIP=_0x358f79=>{const _0x166319=_0x43ec7f;let _0x350921=null,_0x3a03ac=null;if(ipaddr['isValid'](_0x358f79)){const _0x50becb=ipaddr[_0x166319(0x2e4)](_0x358f79);_0x50becb[_0x166319(0x1f8)]()===_0x166319(0x30a)?(_0x50becb[_0x166319(0x280)]()&&(_0x350921=_0x50becb[_0x166319(0x1cc)]()[_0x166319(0x1e8)]()),_0x3a03ac=_0x50becb[_0x166319(0x1e8)]()):(_0x350921=_0x50becb[_0x166319(0x1e8)](),_0x3a03ac=_0x50becb['toIPv4MappedAddress']()[_0x166319(0x1e8)]());}return{'show':_0x350921?_0x350921:_0x3a03ac,'store':_0x3a03ac};};function sleep(_0xfe256a){return new Promise(_0x3679e7=>setTimeout(_0x3679e7,_0xfe256a));}