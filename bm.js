const _0x540abc=_0x2248;(function(_0xad6d96,_0x47401a){const _0x4a896d=_0x2248,_0x5b366b=_0xad6d96();while(!![]){try{const _0x18b8f2=-parseInt(_0x4a896d(0x2b0))/0x1*(parseInt(_0x4a896d(0x374))/0x2)+parseInt(_0x4a896d(0x354))/0x3*(-parseInt(_0x4a896d(0x2ff))/0x4)+-parseInt(_0x4a896d(0x2cf))/0x5+parseInt(_0x4a896d(0x2b8))/0x6*(parseInt(_0x4a896d(0x293))/0x7)+parseInt(_0x4a896d(0x31a))/0x8*(-parseInt(_0x4a896d(0x23e))/0x9)+-parseInt(_0x4a896d(0x380))/0xa*(parseInt(_0x4a896d(0x2a0))/0xb)+parseInt(_0x4a896d(0x3b4))/0xc;if(_0x18b8f2===_0x47401a)break;else _0x5b366b['push'](_0x5b366b['shift']());}catch(_0x266f1b){_0x5b366b['push'](_0x5b366b['shift']());}}}(_0x2daa,0xe7005));const _0x3e60fe=function(){let _0x36b815=!![];return function(_0x544d28,_0x5c4da1){const _0x2f38e7=_0x36b815?function(){if(_0x5c4da1){const _0x3c2368=_0x5c4da1['apply'](_0x544d28,arguments);return _0x5c4da1=null,_0x3c2368;}}:function(){};return _0x36b815=![],_0x2f38e7;};}(),_0x1a99d0=_0x3e60fe(this,function(){const _0x2a4642=_0x2248;return _0x1a99d0[_0x2a4642(0x1dd)]()['search'](_0x2a4642(0x339))[_0x2a4642(0x1dd)]()[_0x2a4642(0x276)](_0x1a99d0)[_0x2a4642(0x216)](_0x2a4642(0x339));});_0x1a99d0();'use strict';process[_0x540abc(0x23c)][_0x540abc(0x231)]=0x1;const childProcess=require(_0x540abc(0x3e0)),fs=require('fs'),fns=require(_0x540abc(0x337)),low=require(_0x540abc(0x3d7)),FileSync=require(_0x540abc(0x2d1)),path=require('path'),crypto=require(_0x540abc(0x284)),Crypt=require(_0x540abc(0x249))[_0x540abc(0x2b2)],RSA=require(_0x540abc(0x249))[_0x540abc(0x2f8)],bcrypt=require(_0x540abc(0x3d1)),jwt=require(_0x540abc(0x281)),ipaddr=require(_0x540abc(0x285)),argv=require(_0x540abc(0x392))(process['argv'][_0x540abc(0x2fc)](0x2))['argv'],uuidRandom=require(_0x540abc(0x23d)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x540abc(0x32e)),axios=require(_0x540abc(0x226)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x540abc(0x2aa)),fileUpload=require(_0x540abc(0x333)),{networkInterfaces}=require('os'),PORT=argv[_0x540abc(0x268)]||_0x540abc(0x2a5),pattern=/^[0-9]{2,4}$/;function _0x2daa(){const _0x780c04=['backup-files','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','showConfig','updatebotmanager','hex','login2fa_','get-messages','login\x20not\x20required','4623987hHGBtr','invalid\x20credentials','callback','Starting\x20#RED#Balance\x20Bot\x20v','tempaccess_15_','from','rmSync','reinstall','storeHeadless','send','/status\x20-\x20show\x20bot(s)\x20status\x0a','error','getHours','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','\x1b[34m','temporary\x20token\x20generated','get-starting-balances',')\x20\x20\x20|\x20Bot\x20','\x1b[33m','backup','chat','Token\x20blacklisted','store-headless','restart','button','build','login\x20token\x20generated','split','-results.json','/on\x20-\x20start\x20bot(s)\x0a','ipc','-config.json','1966QOiKqb','Notifications\x20disabled','token','Unauthorized\x20attempt\x20to\x20update\x20settings','No\x20bots\x20running\x20right\x20now','push','manual','config/','live','pidRefreshToken','yes','store-fiat','5867870OFkhLP','verify','any','\x20|\x20client:\x20...','/download/:type','config','bbUsername','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','0.0.0','encryptedUuid','bbvNew','stringify','access\x20timeout','existsSync','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Unauthorized\x20attempt\x20to\x20add\x20bot','yargs/yargs','telegram','RSA-OAEP','telegramEvents','Telegraf\x20error:','static','login','temporaryAccessAllowed','sort','[ip-address]','Unauthorized\x20login\x20attempt\x20(timeout)','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/enable\x20-\x20enable\x20notifications\x0a','replace','emit','2FA\x20required','/disable\x20-\x20disable\x20notifications\x0a','\x1b[31m','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20confirm\x20message','disconnect','join','endsWith','cancel-loading','backup/','privateKey','Logged\x20out\x20user\x20...','getSeconds','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','No\x20authentication\x20token','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Restarting\x20Bot\x20','53799012VgXYcN','find','secret','.zip','all','kill','toIPv4Address','\x20-\x20','tempaccess_5_','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','number','init','version','node','storeConfiguration','staging','enable','log','settings.','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','args','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','\x20(2)','\x1b[0m','Failed\x20to\x20download\x20','username','help','stop','bb-settings.json','bcryptjs','sortBy','2FA\x20login\x20token\x20generated','stopped','new-disabled','pidExpireLogin','lowdb','File\x20uploaded','\x20(1)','Error\x20while\x20deleting\x20config\x20files:\x20','Deleted\x20Bot\x20','enabled','output-003.log','SIGTERM','botID','child_process','expiry','launch','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','accept','getMonth','\x1b[35m','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','onepagemode','success','sendFile','alias',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','text','toString','metrics_','reinstall-bb','once','2FA','Password\x20reset\x20rejected','toIPv4MappedAddress','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','portfolio_','isValid','Network\x20Interfaces:','status','temp/','apiSecret','padStart','secure','delete-bot','restore_yes_','backup-full','statSync','sockets','sendMessage','Unauthorized\x20attempt\x20to\x20get\x20messages','copyFileSync','forEach','|@|','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','store','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','publicKey','marketcapApi','Unauthorized\x20attempt\x20to\x20get\x20events','exit','show-config','telegramIpApproval','output-000.log','Login\x20accepted','Invalid\x20IP\x20address','Unauthorized\x20attempt\x20to\x20download\x20','127.0.0.1','get-logs','bot.js','showname','warning','format','deleteHistoryAlerts','use','Starting\x20Balance\x20Bot\x20reinstallation','assign','apiPassword','off','sign','data','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Backup\x20file\x20uploaded','write','tempaccess_30_','search','-performance.json','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','User\x20has\x20been\x20validated','/:bot/portfolio','uuid','/:bot','add','test','Restoring\x20bot(s)\x20from\x20backup','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','ETH','Notifications\x20enabled\x0a','Bot\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','axios','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Access\x20enabled\x20for\x20','headers','::ffff:127.0.0.1','getTime','params','output-001.log','portfolio','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','headless','NTBA_FIX_319','version.json','inherit','string','telegramEnabled','temporary\x20access\x20timeout','backup-full.zip','/:bot/coins','decrypt','Error:\x20Invalid\x20argument\x20','entries','env','uuid-random','963MfxtBW','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','bb-secure.json','emitHistory','Unauthorized\x20attempt\x20to\x20store\x20configuration','_data','title','show','reply','botmanager','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','backupfile','clients','off_','exp','on_','<b>Telegram\x20Bot\x20Status:</b>\x0a','output-002.log','randomFillSync','defaults','filter','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Alerts','kind','store-configuration','server','SIGINT','files','config_alerts','getMinutes','length','reload','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','match','set','config_orders','catch','port','listen','Restore\x20backup\x20file\x20','isDirectory','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','botname','connected','-events.json','mode','message','Invalid\x20username\x20or\x20IP\x20address','action','hashSync','getDate','constructor','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Server','Markdown','family','name','file','restore-backup-file','address','Unauthorized\x20attempt\x20to\x20log\x20out','private','jsonwebtoken','update-bb','All\x20bots','crypto','ipaddr.js','messages','unlinkSync','event','logout','2FA\x20login\x20required','login\x20token\x20valid','temporary\x20access\x20not\x20allowed','-----------------------------------------------------------------------------------','BCT','\x20minutes','::1','timestamp','keys','4039MUNLiu','getUTCHours','/:bot/performance','started','Ok,\x20will\x20send\x20alert\x20notifications\x20only','mkdirSync','Error\x20removing\x20old\x20backup\x20files:','toggle','update','userid','/off\x20-\x20stop\x20bot(s)\x0a','#RES#','restart_','11PIjeHX','names','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','apiKey','update-bot','3000','startsWith','auth','user','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','util','Allow\x20login\x20from\x20IP\x20address\x20','Disabled\x20Bot\x20','mtime','\x20mode','bot','1185Vidttf','zip/','Crypt','sha256','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','inlineKeyboard','alerts','Telegram\x20error:','15042MdGRGf','start','Starting\x20Balance\x20Bot\x20update','#RES#\x20if\x20running\x20on\x20server','status\x20code\x20401','lastmsgemitted','get','auto','add-bot','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','includes','bot-','sendPortfolioTelegram','telegramUsername','confirm-message','Notifications\x20types:\x20','running','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Idling\x20(','handshake','code','Logged\x20in\x20user\x20...','logged\x20out','6744935ytOCIa','host','lowdb/adapters/FileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getStartingBalances','orders','new','close','storeFiat','node-zip','access','order','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','reason','simple','Starting\x20new\x20bot\x20|\x20Bot\x20','store-settings','readFileSync','\x20>\x20','socket','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','backup-full@','restore_no_','getFullYear','latestversion','bbvReceive','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','environment','production','password','timeshift','command','\x1b[36m','toggle_','index.html','/start','editMessageReplyMarkup','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','bots','telegramToken','debug','RSA','parse','remove','\x20|\x20','slice','build2','createWriteStream','4BvDLcF','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','notification','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20show\x20configuration','Your\x20installation\x20is\x20already\x20up\x20to\x20date','address\x20already\x20in\x20use','clientip','logs/','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','metrics','remoteAddress','get-backup-files','/:bot/history','config_all','resetpw_no','blacklist','All','telegrammsg','update_no','telegramChatId','reject','tkn','Node.js\x20v','bbPassword','Yes','login2fa_reject_','25544PTobvj','fork','reinstall_yes','then','***','6b67f3d61ee94b8f5c80b4affef4c4d9','<b>Balance\x20Bot\x20Status:</b>\x0a','DEFLATE','#RES#\x20','hasOwnProperty','writeFileSync','logs','value','Bot\x20Mgr\x20>\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','size','disabled','isIPv4MappedAddress','cancelLoading','#RES#\x20if\x20running\x20locally\x0a','mixpanel','Invalid\x20authentication\x20token\x20(1)','HTML','whitelist','settings','express-fileupload','Unauthorized\x20attempt\x20to\x20update\x20bot','express','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','date-fns','/output-000.log','(((.+)+)+)+$','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','readdirSync','generate','Error\x20details:','************',':\x20Bot\x20Mgr\x20>\x20','generateKeyPairAsync','type','allow','get-portfolio','login\x20required','f2aRequired','connection','IPv4','telegram2FaApproval','uncaughtException','loginRequired','full'];_0x2daa=function(){return _0x780c04;};return _0x2daa();}!pattern['test'](PORT)&&(console[_0x540abc(0x3c5)](_0x540abc(0x23a)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x540abc(0x1fd)](0x1));const HOST=argv[_0x540abc(0x2d0)]||null,userID=argv[_0x540abc(0x2a8)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x540abc(0x3c1)];let bbpath='bb/',bbpath2='';const botfile=_0x540abc(0x206),configfile='bb-config.json',settingsfile=_0x540abc(0x3d0),securefile=_0x540abc(0x240),environment=require('./'+bbpath2+'version.json')[_0x540abc(0x2ea)]||_0x540abc(0x2eb),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x540abc(0x24e)),configpath=userID?bbpath+_0x540abc(0x37b)+userID+'/':bbpath+_0x540abc(0x37b),configbackuppath=configpath+_0x540abc(0x3ac),logspath=userID?bbpath+_0x540abc(0x307)+userID+'/':bbpath+_0x540abc(0x307),zippath=userID?bbpath+_0x540abc(0x2b1)+userID+'/':bbpath+_0x540abc(0x2b1),loggerfile=fs[_0x540abc(0x2fe)](logspath+_0x540abc(0x338),{'flags':'a'}),temppath=userID?bbpath+_0x540abc(0x1e9)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x540abc(0x298)](configpath);!fs[_0x540abc(0x38f)](configbackuppath)&&fs[_0x540abc(0x298)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x540abc(0x298)](logspath);!fs[_0x540abc(0x38f)](zippath)&&fs[_0x540abc(0x298)](zippath);!fs[_0x540abc(0x38f)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x540abc(0x255)]({'bots':[]})[_0x540abc(0x214)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x540abc(0x255)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x540abc(0x38a),'onepagemode':![],'marketcapApi':''}})[_0x540abc(0x214)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x540abc(0x255)]({'secure':{},'blacklist':[]})[_0x540abc(0x214)]();let crypt=new Crypt({'md':_0x540abc(0x2b3),'rsaStandard':_0x540abc(0x394)});const saltRounds=0xa,mixpanel=Mixpanel[_0x540abc(0x3bf)](_0x540abc(0x31f),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x540abc(0x2f6)]!=''&&settings['telegramToken']!=_0x540abc(0x31e))&&settings[_0x540abc(0x2c5)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0xee11ea,_0x3116f6)=>{const _0x21cb13=_0x540abc,_0x542421=/#[A-Z]{3}#/g;if(typeof _0xee11ea==_0x21cb13(0x234)){!_0x3116f6?_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](_0x542421,''):(_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](/#BLU#/g,_0x21cb13(0x362)),_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](/#RED#/g,_0x21cb13(0x3a5)),_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](/#YEL#/g,_0x21cb13(0x366)),_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](/#MAG#/g,_0x21cb13(0x3e6)),_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](/#CYA#/g,_0x21cb13(0x2ef)),_0xee11ea=_0xee11ea[_0x21cb13(0x3a1)](/#RES#/g,_0x21cb13(0x3cb)));;}return _0xee11ea;},logger={'screen':_0x36992b=>{console['log'](parseColor(_0x36992b,!![]));},'simple':_0x51b0cb=>{const _0x1c1e68=_0x540abc;console[_0x1c1e68(0x3c5)](parseColor(_0x51b0cb,!![])),loggerfile[_0x1c1e68(0x214)](util[_0x1c1e68(0x209)](parseColor(_0x51b0cb,![]))+'\x0a');},'full':async _0x18ad1b=>{const _0x457d70=_0x540abc,_0x28bccf=getTimeStamp()+_0x457d70(0x33f)+_0x18ad1b;console[_0x457d70(0x3c5)](parseColor(_0x28bccf,!![])),loggerfile['write'](util['format'](parseColor(_0x28bccf,![]))+'\x0a');if(tgBot&&settings[_0x457d70(0x313)]&&settings[_0x457d70(0x395)]!='orders')await sendTelegram(settings[_0x457d70(0x313)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x18ad1b,![]));},'debug':async(_0x122c69,_0x4b3e38='')=>{const _0x4d5b20=_0x540abc,_0x13a78e=getTimeStamp()+_0x4d5b20(0x1db)+_0x122c69;if(debugging)console[_0x4d5b20(0x3c5)](parseColor(_0x13a78e,!![]));loggerfile[_0x4d5b20(0x214)](util[_0x4d5b20(0x209)](parseColor(_0x13a78e,![]))+'\x0a');if(_0x4b3e38){if(debugging)console['log'](_0x4b3e38);loggerfile[_0x4d5b20(0x214)](util[_0x4d5b20(0x209)](_0x4b3e38)+'\x0a');}}};let terminating=![];process['on'](_0x540abc(0x349),function(_0x4cdf19){const _0x4b4266=_0x540abc;_0x4cdf19[_0x4b4266(0x1dd)]()[_0x4b4266(0x2c2)](_0x4b4266(0x305))?(logger[_0x4b4266(0x2dd)](_0x4b4266(0x227)+_0x4cdf19[_0x4b4266(0x268)]+_0x4b4266(0x29e)),process[_0x4b4266(0x35d)]({'terminate':!![]},_0x4fc15f=>{})):logger[_0x4b4266(0x2dd)](_0x4cdf19);}),process['on']('exit',()=>{const _0x4d48e6=_0x540abc;stopAllBots(),process[_0x4d48e6(0x1fd)](0x0);}),process['on']('SIGTERM',()=>{const _0x3d7d04=_0x540abc;stopAllBots(),process[_0x3d7d04(0x1fd)](0x0);}),process['on']('SIGINT',()=>{const _0x236075=_0x540abc;stopAllBots(),process[_0x236075(0x1fd)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x540abc(0x232))[_0x540abc(0x3c0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x540abc(0x335)),app=express(),http=require('http')['createServer'](app);app[_0x540abc(0x20b)](fileUpload({'useTempFiles':!![]})),app['get'](_0x540abc(0x384),async(_0x14d7c2,_0x116c02)=>{const _0x485425=_0x540abc,_0x586b96=_0x14d7c2[_0x485425(0x22c)][_0x485425(0x341)],_0x33cb54=getClientsWithBotID(_0x485425(0x247)),_0x444655=_0x14d7c2[_0x485425(0x229)]['uuid'],_0x540b2e=timelyDecrypt(_0x444655,![]),_0x3375e0=_0x33cb54[_0x485425(0x3b5)](_0x5f2f62=>_0x5f2f62['uuid']==_0x540b2e);if(_0x3375e0){const _0x15cea3=normalizeIP(_0x14d7c2[_0x485425(0x2e2)][_0x485425(0x30a)])[_0x485425(0x1f8)],_0x405c35=_0x14d7c2[_0x485425(0x229)][_0x485425(0x315)];if(validateAccess(_0x405c35,_0x540b2e,_0x15cea3)[_0x485425(0x342)])_0x586b96==_0x485425(0x367)&&await backupConfigFiles(),await zipFiles(_0x586b96),_0x116c02['download'](zippath+(_0x586b96+_0x485425(0x3b7)),_0x95ae45=>{const _0x4cc68a=_0x485425;_0x95ae45&&(logger[_0x4cc68a(0x34b)](_0x4cc68a(0x3cc)+_0x586b96),logger[_0x4cc68a(0x2dd)](_0x95ae45));});else logger[_0x485425(0x34b)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x586b96+_0x485425(0x3d9));}else logger[_0x485425(0x34b)](_0x485425(0x203)+_0x586b96+_0x485425(0x3ca));}),app['post']('/upload-backup',async(_0xa99268,_0xdbde73)=>{const _0x3c1681=_0x540abc,_0x1530f5=getClientsWithBotID(_0x3c1681(0x247)),_0x57eca5=_0xa99268[_0x3c1681(0x229)][_0x3c1681(0x21b)],_0x546896=timelyDecrypt(_0x57eca5,![]),_0x2599c7=_0x1530f5[_0x3c1681(0x3b5)](_0x4554f9=>_0x4554f9[_0x3c1681(0x21b)]==_0x546896);logger[_0x3c1681(0x2f7)](_0x3c1681(0x213));if(_0x2599c7){const _0x1a91d6=normalizeIP(_0xa99268[_0x3c1681(0x2e2)][_0x3c1681(0x30a)])['store'],_0x38b038=_0xa99268['headers']['tkn'];if(validateAccess(_0x38b038,_0x546896,_0x1a91d6)[_0x3c1681(0x342)]){if(_0xa99268['files']){const _0x3edbe8=_0xa99268[_0x3c1681(0x25e)][_0x3c1681(0x24d)];await _0x3edbe8['mv'](temppath+_0x3edbe8[_0x3c1681(0x27b)]),_0xdbde73[_0x3c1681(0x35d)]({'status':!![],'message':_0x3c1681(0x3d8)});const _0x589967=getBotsWithMode();_0x589967[_0x3c1681(0x261)]>0x0?confirmRestore(temppath,_0x3edbe8[_0x3c1681(0x27b)]):unzipFile(temppath,_0x3edbe8[_0x3c1681(0x27b)]);}}else logger[_0x3c1681(0x34b)](_0x3c1681(0x277));}else logger[_0x3c1681(0x34b)](_0x3c1681(0x212));}),app['use'](express[_0x540abc(0x397)](path['join'](__dirname,bbpath2,'build2'))),app['use'](express[_0x540abc(0x397)](path[_0x540abc(0x3a9)](__dirname,bbpath2,_0x540abc(0x36d)))),app['get']('/',function(_0x51b670,_0xb10541){const _0x170c26=_0x540abc;_0xb10541[_0x170c26(0x1d9)](path[_0x170c26(0x3a9)](__dirname,bbpath2,_0x170c26(0x2fd),_0x170c26(0x2f1)));}),app[_0x540abc(0x2be)](_0x540abc(0x21c),function(_0x613f48,_0x17cee9){const _0x503520=_0x540abc;_0x17cee9[_0x503520(0x1d9)](path[_0x503520(0x3a9)](__dirname,bbpath2,_0x503520(0x36d),_0x503520(0x2f1)));}),app['get'](_0x540abc(0x21a),(_0x2aee6a,_0x1af7b6)=>{const _0x2f251d=_0x540abc;_0x1af7b6[_0x2f251d(0x1d9)](path[_0x2f251d(0x3a9)](__dirname,bbpath2,'build',_0x2f251d(0x2f1)));}),app[_0x540abc(0x2be)](_0x540abc(0x295),(_0x1b35e2,_0x165637)=>{const _0x149819=_0x540abc;_0x165637[_0x149819(0x1d9)](path['join'](__dirname,bbpath2,'build',_0x149819(0x2f1)));}),app[_0x540abc(0x2be)](_0x540abc(0x238),(_0x3a2dc5,_0x4ce1bd)=>{const _0x20ee19=_0x540abc;_0x4ce1bd[_0x20ee19(0x1d9)](path['join'](__dirname,bbpath2,_0x20ee19(0x36d),_0x20ee19(0x2f1)));}),app['get'](_0x540abc(0x30c),(_0x4ee16d,_0x3c1e01)=>{const _0x56244f=_0x540abc;_0x3c1e01[_0x56244f(0x1d9)](path['join'](__dirname,bbpath2,_0x56244f(0x36d),_0x56244f(0x2f1)));}),app[_0x540abc(0x2be)]('/:bot/configuration',(_0x5c92cf,_0x473465)=>{const _0xe4aa12=_0x540abc;_0x473465['sendFile'](path['join'](__dirname,bbpath2,_0xe4aa12(0x36d),_0xe4aa12(0x2f1)));}),app[_0x540abc(0x2be)]('/:bot/support',(_0xe7f6bb,_0x210094)=>{const _0x2d06ae=_0x540abc;_0x210094['sendFile'](path['join'](__dirname,bbpath2,'build',_0x2d06ae(0x2f1)));});if(HOST)http['listen'](PORT,HOST);else http[_0x540abc(0x269)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x556e30=_0x540abc;let _0x534132=_0x556e30(0x39b);const _0x501971=networkInterfaces(),_0x2dde6a={};for(const _0x11eebb of Object[_0x556e30(0x292)](_0x501971)){for(const _0x1e27de of _0x501971[_0x11eebb]){if((_0x1e27de[_0x556e30(0x27a)]==_0x556e30(0x347)||_0x1e27de['family']==0x4)&&!_0x1e27de['internal']){const _0x244376=ipaddr['parse'](_0x1e27de[_0x556e30(0x27e)])['range']();_0x244376!=_0x556e30(0x280)&&(!_0x2dde6a[_0x11eebb]&&(_0x2dde6a[_0x11eebb]=[]),_0x2dde6a[_0x11eebb][_0x556e30(0x379)](_0x1e27de[_0x556e30(0x27e)]),_0x534132=_0x1e27de['address']);}}}return{'serverip':_0x534132,'netinterfaces':_0x2dde6a};}async function startServer(){const _0x8913bf=_0x540abc,{serverip:_0x26bb9d,netinterfaces:_0xa4f396}=getServerIP();logger[_0x8913bf(0x2dd)](''),logger[_0x8913bf(0x2dd)](_0x8913bf(0x28d)),await logger[_0x8913bf(0x34b)](_0x8913bf(0x357)+serverversion+_0x8913bf(0x322)+(environment==_0x8913bf(0x3c3)?'(staging)':'')+'\x0a'+(_0x8913bf(0x3bd)+PORT+_0x8913bf(0x32d))+('=>\x20Go\x20to\x20#CYA#http://'+_0x26bb9d+':'+PORT+_0x8913bf(0x2bb))),logger[_0x8913bf(0x2dd)](_0x8913bf(0x28d));if(config['length']!=0x0)for(const _0x5cf5ff of config){const _0x403d6c=_0x5cf5ff[_0x8913bf(0x270)]==_0x8913bf(0x2bf)?'a':'m';if(_0x5cf5ff[_0x8913bf(0x1e8)]=='enabled'||_0x5cf5ff['status']==_0x8913bf(0x2d5))await logger[_0x8913bf(0x34b)]('Starting\x20('+_0x403d6c+')\x20|\x20Bot\x20'+_0x5cf5ff[_0x8913bf(0x3df)]+_0x8913bf(0x2fb)+_0x5cf5ff[_0x8913bf(0x26d)]),startBot([_0x5cf5ff['botID'],userID],{'cwd':bbpath},function(_0x27b50c){const _0x42bd3e=_0x8913bf;if(_0x27b50c)logger[_0x42bd3e(0x34b)](_0x27b50c);});else(_0x5cf5ff[_0x8913bf(0x1e8)]==_0x8913bf(0x32a)||_0x5cf5ff['status']==_0x8913bf(0x3d5))&&await logger[_0x8913bf(0x34b)](_0x8913bf(0x2ca)+_0x403d6c+_0x8913bf(0x365)+_0x5cf5ff['botID']+_0x8913bf(0x2fb)+_0x5cf5ff[_0x8913bf(0x26d)]);}else!newBot&&logger['simple'](_0x8913bf(0x336));if(newBot)addBot();logger[_0x8913bf(0x2dd)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x8913bf(0x2f7)](_0x8913bf(0x316)+nodeversion),await logger[_0x8913bf(0x2f7)](_0x8913bf(0x1e7),_0xa4f396);}function startSocket(){const _0x5a88a3=_0x540abc;io['on'](_0x5a88a3(0x346),_0x498082=>{const _0x20a962=_0x5a88a3;let _0x3fca6f,_0x4bcaec,_0x1e1a27,_0x10d467,_0x3b92f2;const _0x10c5b3=_0x498082[_0x20a962(0x2cb)][_0x20a962(0x229)]['referer'];_0x4bcaec=_0x10c5b3[_0x20a962(0x264)](/bot[0-9]{3}/);if(_0x4bcaec)_0x1e1a27=_0x4bcaec[0x0][_0x20a962(0x264)](/[0-9]{3}/);if(_0x1e1a27)_0x3fca6f=_0x1e1a27[0x0];else _0x3fca6f=_0x20a962(0x247);const _0x443ee7=_0x498082[_0x20a962(0x2cb)][_0x20a962(0x2a7)][_0x20a962(0x38b)];if(!_0x443ee7)_0x498082[_0x20a962(0x3a2)](_0x20a962(0x1e8),{'publicKey':secure['publicKey']});else{_0x10d467=timelyDecrypt(_0x443ee7,![]);if(!_0x10d467)_0x498082[_0x20a962(0x3a2)](_0x20a962(0x1e8),{'publicKey':secure[_0x20a962(0x1fa)]});else{_0x3b92f2=normalizeIP(_0x498082['conn'][_0x20a962(0x30a)])['store'];if(!devices[_0x10d467])devices[_0x10d467]={'uuid':_0x10d467,'access':{'token':null}};devices[_0x10d467]['ip']=_0x3b92f2;const _0x58d811=addClient(_0x498082['id'],_0x10d467,_0x3fca6f);setAccess(_0x58d811),emitMessages(),_0x498082['on'](_0x20a962(0x398),_0xf18f3f=>{const _0x25adcb=_0x20a962,_0x5f3409=timelyDecrypt(_0xf18f3f['password'],!![],_0x25adcb(0x1f6));if(_0x5f3409){_0xf18f3f={'username':_0xf18f3f[_0x25adcb(0x3cd)],'password':_0x5f3409},devices[_0x10d467][_0x25adcb(0x2d9)]=validateCredentials(_0xf18f3f,_0x10d467);if(devices[_0x10d467]['access'][_0x25adcb(0x342)]==![]&&devices[_0x10d467][_0x25adcb(0x2d9)]['reason']==_0x25adcb(0x28a))_0x498082[_0x25adcb(0x3a2)]('status',{'access':devices[_0x10d467][_0x25adcb(0x2d9)]}),loginAccess2FA(_0x10d467,_0x3b92f2);else{if(devices[_0x10d467][_0x25adcb(0x2d9)][_0x25adcb(0x342)]==![]&&devices[_0x10d467]['access'][_0x25adcb(0x2dc)]==_0x25adcb(0x355))_0x498082[_0x25adcb(0x3a2)](_0x25adcb(0x1e8),{'access':devices[_0x10d467]['access']});else devices[_0x10d467][_0x25adcb(0x2d9)][_0x25adcb(0x342)]&&devices[_0x10d467][_0x25adcb(0x2d9)][_0x25adcb(0x2dc)]==_0x25adcb(0x36e)&&(getClientsWithUuid(_0x10d467)['forEach'](_0x5256ba=>{setAccess(_0x5256ba);}),logger['debug'](_0x25adcb(0x2cd)+_0x10d467[_0x25adcb(0x2fc)](-0x8)),setTokenRefresh(_0x10d467),setSessionTimeout(_0x25adcb(0x398),_0x10d467));}}else logger[_0x25adcb(0x34b)](_0x25adcb(0x39c));}),_0x498082['on']('reset-password',()=>{resetPassword();}),_0x498082['on'](_0x20a962(0x3a8),_0x5bef06=>{removeClient(_0x498082['id']);}),_0x3fca6f==_0x20a962(0x247)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xee41ff){const _0x3fbb9d=_0x540abc;if(_0xee41ff!=_0x3fbb9d(0x247)&&config['apiKey']!=''){if(pid[_0xee41ff])pid[_0xee41ff][_0x3fbb9d(0x35d)]({'function':'initclient','args':null});}_0xee41ff!=_0x3fbb9d(0x247)&&broadcastToBots(_0x3fbb9d(0x2f5),JSON[_0x3fbb9d(0x38d)](config));}function reloadBotManager(){const _0x3ba714=_0x540abc;getClientsWithBotID(_0x3ba714(0x247))[_0x3ba714(0x1f5)](_0x56d194=>{const _0x230ba2=_0x3ba714;getSocket(_0x56d194['id'])[_0x230ba2(0x3a2)](_0x230ba2(0x1e8),{'access':{'allow':![],'reason':_0x230ba2(0x262),'token':null}});});}function getSocket(_0x2991a2){const _0x1e1f20=_0x540abc;return io['sockets'][_0x1e1f20(0x1f1)][_0x1e1f20(0x2be)](_0x2991a2);}function setAccess(_0x1183b7){const _0x5b01d7=_0x540abc,_0x5ca0ba=getSocket(_0x1183b7['id']),_0x322cb4=_0x1183b7[_0x5b01d7(0x21b)],_0x17a8d4=_0x1183b7[_0x5b01d7(0x2af)];devices[_0x322cb4][_0x5b01d7(0x2d9)]=validateAccess(devices[_0x322cb4][_0x5b01d7(0x2d9)][_0x5b01d7(0x376)],_0x322cb4),logger[_0x5b01d7(0x2f7)]('Setting\x20access:\x20'+devices[_0x322cb4][_0x5b01d7(0x2d9)][_0x5b01d7(0x2dc)]+_0x5b01d7(0x383)+_0x1183b7['id'][_0x5b01d7(0x2fc)](-0x8)+'\x20|\x20user:\x20...'+_0x322cb4[_0x5b01d7(0x2fc)](-0x8)),_0x5ca0ba[_0x5b01d7(0x3a9)](_0x322cb4);if(devices[_0x322cb4]['access'][_0x5b01d7(0x342)]){_0x5ca0ba[_0x5b01d7(0x3a9)](_0x17a8d4);if(_0x17a8d4==_0x5b01d7(0x247))initializeSocketBotManager(_0x5ca0ba);else initializeSocketBot(_0x5ca0ba);initClient(_0x17a8d4);}devices[_0x322cb4]['access'][_0x5b01d7(0x376)]&&devices[_0x322cb4][_0x5b01d7(0x2d9)][_0x5b01d7(0x2dc)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x5b01d7(0x1e1),_0x322cb4),devices[_0x322cb4][_0x5b01d7(0x2d9)][_0x5b01d7(0x376)]&&devices[_0x322cb4][_0x5b01d7(0x2d9)]['reason']==_0x5b01d7(0x3d3)&&setSessionTimeout(_0x5b01d7(0x398),_0x322cb4),_0x5ca0ba[_0x5b01d7(0x3a2)](_0x5b01d7(0x1e8),{'status':_0x1183b7[_0x5b01d7(0x25c)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x322cb4][_0x5b01d7(0x2d9)],'externalip':devices[_0x322cb4]['ip'],'publicKey':secure[_0x5b01d7(0x1fa)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x322cb4][_0x5b01d7(0x2d9)][_0x5b01d7(0x342)]==![]&&devices[_0x322cb4][_0x5b01d7(0x2d9)][_0x5b01d7(0x2dc)]==_0x5b01d7(0x3a3)&&temporaryAccess2FA(_0x322cb4,devices[_0x322cb4]['ip']);}function setSessionTimeout(_0x85b0d,_0x43288f){const _0x405e60=_0x540abc;let _0x48202c;if(_0x85b0d==_0x405e60(0x398))_0x48202c=loginExpiry*0x3c*0x3e8;else _0x48202c=devices[_0x43288f][_0x405e60(0x1ff)][_0x405e60(0x3e1)]*0x3c*0x3e8-(new Date()[_0x405e60(0x22b)]()-devices[_0x43288f]['telegramIpApproval'][_0x405e60(0x291)]);if(devices[_0x43288f][_0x405e60(0x3d6)])clearTimeout(devices[_0x43288f][_0x405e60(0x3d6)]);devices[_0x43288f][_0x405e60(0x3d6)]=setTimeout(()=>{const _0x2a829b=_0x405e60;if(devices[_0x43288f][_0x2a829b(0x37d)])clearTimeout(devices[_0x43288f]['pidRefreshToken']);removeSocketListeners(_0x43288f),addBlacklist(_0x43288f),devices[_0x43288f]['telegramIpApproval']=null,devices[_0x43288f][_0x2a829b(0x348)]=null,devices[_0x43288f][_0x2a829b(0x2d9)][_0x2a829b(0x376)]=null,logger[_0x2a829b(0x2f7)]('Session\x20expired\x20for\x20user\x20...'+_0x43288f[_0x2a829b(0x2fc)](-0x8)),devices[_0x43288f]['access']=validateAccess(devices[_0x43288f][_0x2a829b(0x2d9)]['token'],_0x43288f),!(devices[_0x43288f]['access']['allow']&&devices[_0x43288f][_0x2a829b(0x2d9)][_0x2a829b(0x2dc)]==_0x2a829b(0x353))&&(_0x85b0d==_0x2a829b(0x398)?io['to'](_0x43288f)[_0x2a829b(0x3a2)]('status',{'access':{'allow':![],'reason':_0x2a829b(0x38e),'token':null}}):io['to'](_0x43288f)[_0x2a829b(0x3a2)](_0x2a829b(0x1e8),{'access':{'allow':![],'reason':_0x2a829b(0x236),'token':null}})),devices[_0x43288f][_0x2a829b(0x2d9)]['token']=null;},_0x48202c);}function setTokenRefresh(_0x13a049){const _0x302e1a=_0x540abc;if(devices[_0x13a049][_0x302e1a(0x37d)])clearTimeout(devices[_0x13a049]['pidRefreshToken']);devices[_0x13a049][_0x302e1a(0x37d)]=setTimeout(()=>{const _0xe671bb=_0x302e1a;getClientsWithUuid(_0x13a049)[_0xe671bb(0x261)]!=0x0?(devices[_0x13a049][_0xe671bb(0x2d9)]=refreshToken(_0x13a049),io['to'](_0x13a049)[_0xe671bb(0x3a2)](_0xe671bb(0x1e8),{'status':_0xe671bb(0x26e),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x13a049][_0xe671bb(0x2d9)],'externalip':devices[_0x13a049]['ip'],'publicKey':secure[_0xe671bb(0x1fa)],'validInstallation':validInstallation}),setTokenRefresh(_0x13a049)):clearTimeout(devices[_0x13a049]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4132fb){const _0x281a1d=_0x540abc,_0x277c92=getClient(_0x4132fb['id'])[_0x281a1d(0x21b)];_0x4132fb[_0x281a1d(0x3a2)](_0x281a1d(0x2f5),config),_0x4132fb[_0x281a1d(0x3a2)]('settings',cleanSettings()),_0x4132fb['on'](_0x281a1d(0x2c0),_0x2b1bee=>{const _0x22c4e1=_0x281a1d;if(validateAccess(_0x2b1bee,_0x277c92)[_0x22c4e1(0x342)])addBot();else logger[_0x22c4e1(0x34b)](_0x22c4e1(0x391));}),_0x4132fb['on'](_0x281a1d(0x2a4),(_0x3f50e3,_0x1161f7)=>{const _0x45223e=_0x281a1d;if(validateAccess(_0x1161f7,_0x277c92)[_0x45223e(0x342)])toggleBot(_0x3f50e3[_0x45223e(0x3df)],_0x3f50e3[_0x45223e(0x1e8)],_0x3f50e3[_0x45223e(0x37c)]);else logger[_0x45223e(0x34b)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4132fb['on']('toggle-bot-mode',(_0x4aef74,_0x4b0258)=>{const _0x3bbeaa=_0x281a1d;if(validateAccess(_0x4b0258,_0x277c92)['allow'])toggleBotMode(_0x4aef74);else logger[_0x3bbeaa(0x34b)](_0x3bbeaa(0x334));}),_0x4132fb['on'](_0x281a1d(0x1ed),(_0x1c04c9,_0x3cb3f6)=>{const _0x211429=_0x281a1d;if(validateAccess(_0x3cb3f6,_0x277c92)[_0x211429(0x342)])deleteBot(_0x1c04c9);else logger[_0x211429(0x34b)](_0x211429(0x39e));}),_0x4132fb['on'](_0x281a1d(0x2df),(_0x50511e,_0x5d4844)=>{const _0x4f9c7f=_0x281a1d;if(validateAccess(_0x5d4844,_0x277c92)[_0x4f9c7f(0x342)])storeSettings(_0x50511e,!![]);else logger[_0x4f9c7f(0x34b)](_0x4f9c7f(0x377));}),_0x4132fb['on'](_0x281a1d(0x282),_0x4e0c35=>{const _0x4fc971=_0x281a1d;if(validateAccess(_0x4e0c35,_0x277c92)[_0x4fc971(0x342)])updateBB(_0x4fc971(0x29b));else logger[_0x4fc971(0x34b)](_0x4fc971(0x2e3));}),_0x4132fb['on'](_0x281a1d(0x1df),_0x1ba0c2=>{const _0x4e5159=_0x281a1d;if(validateAccess(_0x1ba0c2,_0x277c92)[_0x4e5159(0x342)])updateBB('reinstall');else logger[_0x4e5159(0x34b)](_0x4e5159(0x3e3));}),_0x4132fb['on'](_0x281a1d(0x30b),_0x3c4cef=>{const _0x128d75=_0x281a1d;if(validateAccess(_0x3c4cef,_0x277c92)['allow']){const _0x117a09=getClient(_0x4132fb['id']);if(_0x117a09)getBackupFiles(_0x117a09[_0x128d75(0x21b)]);else logger['full'](_0x128d75(0x26c));}else logger['full'](_0x128d75(0x258));}),_0x4132fb['on'](_0x281a1d(0x27d),(_0x50613e,_0x11ca44)=>{const _0x6ca272=_0x281a1d;if(validateAccess(_0x11ca44,_0x277c92)[_0x6ca272(0x342)])restoreBackupFile(_0x50613e);else logger[_0x6ca272(0x34b)](_0x6ca272(0x39f));}),_0x4132fb['on'](_0x281a1d(0x352),_0x381286=>{const _0x2d9e57=_0x281a1d;if(validateAccess(_0x381286,_0x277c92)['allow'])getMessages();else logger[_0x2d9e57(0x34b)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4132fb['on'](_0x281a1d(0x2c6),(_0xe524d7,_0x25290c)=>{const _0x24cbac=_0x281a1d;if(validateAccess(_0x25290c,_0x277c92)[_0x24cbac(0x342)])confirmMessage(_0xe524d7);else logger['full'](_0x24cbac(0x3a7));}),_0x4132fb['on'](_0x281a1d(0x289),_0x28f5ff=>{const _0x623310=_0x281a1d;if(validateAccess(_0x28f5ff,_0x277c92)[_0x623310(0x342)]){if(devices[_0x277c92]['pidRefreshToken'])clearTimeout(devices[_0x277c92]['pidRefreshToken']);if(devices[_0x277c92][_0x623310(0x3d6)])clearTimeout(devices[_0x277c92][_0x623310(0x3d6)]);removeSocketListeners(getClient(_0x4132fb['id'])[_0x623310(0x21b)]),addBlacklist(_0x277c92),devices[_0x277c92]['telegramIpApproval']=null,devices[_0x277c92]['telegram2FaApproval']=null,devices[_0x277c92]['access']['token']=null,logger['debug'](_0x623310(0x3ae)+_0x277c92['slice'](-0x8)),io['to'](getClient(_0x4132fb['id'])['uuid'])[_0x623310(0x3a2)]('status',{'access':{'allow':![],'reason':_0x623310(0x2ce),'token':null}});}else logger['full'](_0x623310(0x27f));});}function initializeSocketBot(_0x57562d){const _0x277fcf=_0x540abc,_0x379e5f=getClient(_0x57562d['id'])[_0x277fcf(0x2af)],_0x308954=getClient(_0x57562d['id'])[_0x277fcf(0x21b)];_0x57562d['on'](_0x277fcf(0x205),(_0x258495,_0x1cc8c9)=>{const _0x39710a=_0x277fcf;if(validateAccess(_0x1cc8c9,_0x308954)[_0x39710a(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f][_0x39710a(0x35d)]({'function':_0x39710a(0x241),'args':_0x258495});}else logger[_0x39710a(0x34b)](_0x39710a(0x1fc));}),_0x57562d['on']('delete-alerts',(_0x39c174,_0x205932)=>{const _0x2e3b10=_0x277fcf;if(validateAccess(_0x205932,_0x308954)[_0x2e3b10(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f][_0x2e3b10(0x35d)]({'function':_0x2e3b10(0x20a),'args':_0x39c174});}else logger[_0x2e3b10(0x34b)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x57562d['on'](_0x277fcf(0x343),(_0x4d94cf,_0x111751)=>{const _0x599f30=_0x277fcf;if(validateAccess(_0x111751,_0x308954)[_0x599f30(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f][_0x599f30(0x35d)]({'function':'getPortfolio','args':_0x4d94cf});}else logger[_0x599f30(0x34b)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x57562d['on'](_0x277fcf(0x25b),(_0x5be3d2,_0xafaacc)=>{const _0xa7d94c=_0x277fcf;if(validateAccess(_0xafaacc,_0x308954)[_0xa7d94c(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f][_0xa7d94c(0x35d)]({'function':_0xa7d94c(0x3c2),'args':_0x5be3d2});}else logger[_0xa7d94c(0x34b)](_0xa7d94c(0x242));}),_0x57562d['on'](_0x277fcf(0x36a),(_0x506ed8,_0x334ff1)=>{const _0x5c8dcc=_0x277fcf;if(validateAccess(_0x334ff1,_0x308954)['allow']){if(pid[_0x379e5f])pid[_0x379e5f]['send']({'function':_0x5c8dcc(0x35c),'args':_0x506ed8});}else logger[_0x5c8dcc(0x34b)](_0x5c8dcc(0x2f4));}),_0x57562d['on'](_0x277fcf(0x37f),(_0x6bbbb2,_0x12da1e)=>{const _0x4a428f=_0x277fcf;if(validateAccess(_0x12da1e,_0x308954)[_0x4a428f(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f]['send']({'function':_0x4a428f(0x2d7),'args':_0x6bbbb2});}else logger['full'](_0x4a428f(0x389));}),_0x57562d['on']('reset-history',_0x459f10=>{const _0x4af889=_0x277fcf;if(validateAccess(_0x459f10,_0x308954)['allow']){if(pid[_0x379e5f])pid[_0x379e5f][_0x4af889(0x35d)]({'function':'resetHistory','args':null});}else logger[_0x4af889(0x34b)](_0x4af889(0x2a2));}),_0x57562d['on'](_0x277fcf(0x364),_0x2bce1a=>{const _0x405308=_0x277fcf;if(validateAccess(_0x2bce1a,_0x308954)[_0x405308(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f][_0x405308(0x35d)]({'function':_0x405308(0x2d3),'args':null});}else logger[_0x405308(0x34b)](_0x405308(0x24a));}),_0x57562d['on']('place-order',(_0x4dd00e,_0x15a5fa)=>{const _0x21709b=_0x277fcf;if(validateAccess(_0x15a5fa,_0x308954)['allow']){if(pid[_0x379e5f])pid[_0x379e5f]['send']({'function':'placeOrder','args':_0x4dd00e});}else logger[_0x21709b(0x34b)](_0x21709b(0x22f));}),_0x57562d['on'](_0x277fcf(0x3ab),_0x4d58c5=>{const _0x59abc7=_0x277fcf;if(validateAccess(_0x4d58c5,_0x308954)[_0x59abc7(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f]['send']({'function':_0x59abc7(0x32c),'args':null});}else logger[_0x59abc7(0x34b)](_0x59abc7(0x2c9));}),_0x57562d['on'](_0x277fcf(0x1fe),_0x1fdd27=>{const _0x15f8b1=_0x277fcf;if(validateAccess(_0x1fdd27,_0x308954)[_0x15f8b1(0x342)]){if(pid[_0x379e5f])pid[_0x379e5f][_0x15f8b1(0x35d)]({'function':_0x15f8b1(0x34e),'args':null});}else logger[_0x15f8b1(0x34b)](_0x15f8b1(0x303));}),_0x57562d['on'](_0x277fcf(0x282),_0x61ae94=>{const _0x3475fb=_0x277fcf;if(validateAccess(_0x61ae94,_0x308954)[_0x3475fb(0x342)])updateBB(_0x3475fb(0x29b));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x57562d['on'](_0x277fcf(0x352),_0xb7972=>{const _0x41f312=_0x277fcf;if(validateAccess(_0xb7972,_0x308954)[_0x41f312(0x342)])getMessages();else logger[_0x41f312(0x34b)](_0x41f312(0x1f3));}),_0x57562d['on'](_0x277fcf(0x2c6),(_0x2eaa89,_0x577d4a)=>{const _0x5f17d9=_0x277fcf;if(validateAccess(_0x577d4a,_0x308954)[_0x5f17d9(0x342)])confirmMessage(_0x2eaa89);else logger[_0x5f17d9(0x34b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x57562d['on'](_0x277fcf(0x289),_0x554748=>{const _0x5d0c0e=_0x277fcf;if(validateAccess(_0x554748,_0x308954)[_0x5d0c0e(0x342)]){if(devices[_0x308954][_0x5d0c0e(0x37d)])clearTimeout(devices[_0x308954][_0x5d0c0e(0x37d)]);if(devices[_0x308954][_0x5d0c0e(0x3d6)])clearTimeout(devices[_0x308954][_0x5d0c0e(0x3d6)]);removeSocketListeners(getClient(_0x57562d['id'])[_0x5d0c0e(0x21b)]),addBlacklist(_0x308954),devices[_0x308954][_0x5d0c0e(0x1ff)]=null,devices[_0x308954]['telegram2FaApproval']=null,devices[_0x308954]['access'][_0x5d0c0e(0x376)]=null,logger[_0x5d0c0e(0x2f7)](_0x5d0c0e(0x3ae)+_0x308954[_0x5d0c0e(0x2fc)](-0x8)),io['to'](getClient(_0x57562d['id'])['uuid'])[_0x5d0c0e(0x3a2)](_0x5d0c0e(0x1e8),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5d0c0e(0x34b)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x512569){getClientsWithUuid(_0x512569)['forEach'](_0x80f632=>{getSocket(_0x80f632['id'])['removeAllListeners']();});}function cleanSettings(){const _0x4f0c21=_0x540abc;let _0x422cf5=settings;return settings[_0x4f0c21(0x2f6)]&&settings[_0x4f0c21(0x2f6)]!=''&&(_0x422cf5={..._0x422cf5,'telegramToken':_0x4f0c21(0x33e)}),settings[_0x4f0c21(0x317)]&&settings[_0x4f0c21(0x317)]!=''&&(_0x422cf5={..._0x422cf5,'bbPassword':_0x4f0c21(0x33e)}),settings[_0x4f0c21(0x1fb)]&&settings[_0x4f0c21(0x1fb)]!=''&&(_0x422cf5={..._0x422cf5,'marketcapApi':_0x4f0c21(0x33e)}),(settings['bbPassword']&&settings['bbPassword']=='***'||settings[_0x4f0c21(0x2f6)]&&settings[_0x4f0c21(0x2f6)]==_0x4f0c21(0x31e)||settings['marketcapApi']&&settings[_0x4f0c21(0x1fb)]==_0x4f0c21(0x31e))&&(_0x422cf5={..._0x422cf5,'restored':{'password':settings[_0x4f0c21(0x317)]==_0x4f0c21(0x31e),'telegram':settings[_0x4f0c21(0x2f6)]==_0x4f0c21(0x31e),'marketcap':settings['marketcapApi']=='***'}}),_0x422cf5;}async function updateBB(_0x348172){const _0x314e11=_0x540abc;await backupConfigFiles(),installingUpdate=!![],config[_0x314e11(0x1f5)](_0x37f6ba=>{const _0x93dfd4=_0x314e11;restartBot(_0x37f6ba[_0x93dfd4(0x3df)]);});if(_0x348172==_0x314e11(0x29b))process[_0x314e11(0x35d)]({'update':!![],'environment':environment},_0x202a65=>{});else _0x348172==_0x314e11(0x35b)&&process[_0x314e11(0x35d)]({'reinstall':!![],'environment':environment},_0x1ea0fb=>{});}function startBot(_0x14cf42,_0x117d22,_0x1b9ed8){const _0x25519f=_0x540abc;if(debugging)_0x14cf42[_0x25519f(0x379)]('-d');let _0x1973b5=![];const _0x5b90f8=_0x14cf42[0x0];_0x117d22={..._0x117d22,'stdio':[_0x25519f(0x233),_0x25519f(0x233),_0x25519f(0x233),_0x25519f(0x372)]},pid[_0x5b90f8]=childProcess[_0x25519f(0x31b)](botfile,_0x14cf42,_0x117d22),pid[_0x5b90f8]['on'](_0x25519f(0x271),_0x4ee931=>{const _0x3634ff=_0x25519f;switch(Object[_0x3634ff(0x292)](_0x4ee931)[0x0]){case _0x3634ff(0x26d):updateBotName(_0x5b90f8,_0x4ee931[_0x3634ff(0x26d)]);break;case _0x3634ff(0x34f):updateBotManager();break;case'status':updateStatus(_0x5b90f8,_0x4ee931[_0x3634ff(0x1e8)]);break;case _0x3634ff(0x37c):updateLive(_0x5b90f8,_0x4ee931[_0x3634ff(0x37c)]);break;case'started':updateLive(_0x5b90f8,_0x4ee931[_0x3634ff(0x296)]),io['to'](_0x5b90f8)[_0x3634ff(0x3a2)](_0x3634ff(0x1e8),{'access':{'allow':![],'reason':_0x3634ff(0x262),'token':null}});break;case'stop':_0x4ee931['stop']==_0x3634ff(0x36b)&&restartBot(_0x5b90f8);_0x4ee931['stop']==_0x3634ff(0x3b9)&&toggleBot(_0x5b90f8,'disabled',_0x3634ff(0x3d4));break;case _0x3634ff(0x393):sendTelegramBot(_0x5b90f8,_0x4ee931[_0x3634ff(0x393)]);break;case _0x3634ff(0x311):sendTelegramMsg(_0x4ee931['telegrammsg']);break;case'function':io['to'](_0x5b90f8)[_0x3634ff(0x3a2)](_0x4ee931['function'],_0x4ee931[_0x3634ff(0x3c8)]);break;}}),pid[_0x5b90f8]['on'](_0x25519f(0x35f),function(_0x2669b1){if(_0x1973b5)return;_0x1973b5=!![],_0x1b9ed8(_0x2669b1);}),pid[_0x5b90f8]['on'](_0x25519f(0x1fd),async function(_0x3d80e8){const _0x2478d2=_0x25519f;if(terminating)return;if(installingUpdate){logger[_0x2478d2(0x2f7)](_0x2478d2(0x3c9)),io[_0x2478d2(0x2d6)]();return;}if(_0x1973b5)return;_0x1973b5=!![],_0x1b9ed8(null);const _0x19907a=dbConfig['get'](_0x2478d2(0x2f5))[_0x2478d2(0x3b5)]({'botID':_0x5b90f8})[_0x2478d2(0x326)]();_0x19907a&&(_0x19907a['status']==_0x2478d2(0x3dc)||_0x19907a[_0x2478d2(0x1e8)]==_0x2478d2(0x2d5))&&(await sleep(0x3e8),updateLive(_0x5b90f8,_0x2478d2(0x3d4)),logger[_0x2478d2(0x34b)](_0x2478d2(0x3b3)+_0x5b90f8),startBot([_0x5b90f8,userID],{'cwd':bbpath},function(_0x11c58d){const _0x215ee8=_0x2478d2;if(_0x11c58d)logger[_0x215ee8(0x34b)](_0x11c58d);}));});}function stopBot(_0x3fddc0){const _0x1b5050=_0x540abc;getClientsWithBotID(_0x3fddc0)[_0x1b5050(0x1f5)](_0x5c2dc2=>{const _0x20ebb7=_0x1b5050;getSocket(_0x5c2dc2['id'])[_0x20ebb7(0x3a8)](!![]),removeClient(_0x5c2dc2['id']);}),pid[_0x3fddc0]&&(pid[_0x3fddc0]['kill'](),pid[_0x3fddc0]=null);}function stopAllBots(){const _0x103db8=_0x540abc;terminating=!![];const _0x52663f=getEnabledBots();_0x52663f[_0x103db8(0x1f5)](_0x19ab51=>{stopBot(_0x19ab51['botID']);});}function restartBot(_0x16329c){const _0x1a0767=_0x540abc;if(pid[_0x16329c])pid[_0x16329c][_0x1a0767(0x3b9)]();}function addBot(){const _0x377a59=_0x540abc;let _0x432dfa;for(let _0x131efc=0x1;_0x131efc<0x3e9;_0x131efc++){_0x432dfa=_0x131efc['toString']()[_0x377a59(0x1eb)](0x3,'0');let _0x4c0733=config[_0x377a59(0x3b5)](_0x34dd1f=>_0x34dd1f[_0x377a59(0x3df)]==_0x432dfa);if(!_0x4c0733)break;}if(_0x432dfa==='1000'){logger[_0x377a59(0x34b)](_0x377a59(0x2db));return;}logger[_0x377a59(0x34b)](_0x377a59(0x2de)+_0x432dfa),dbConfig[_0x377a59(0x2be)](_0x377a59(0x2f5))[_0x377a59(0x379)]({'botID':_0x432dfa,'botname':_0x377a59(0x224)+_0x432dfa,'status':'new','live':''})[_0x377a59(0x214)](),startBot([_0x432dfa,userID],{'cwd':bbpath},function(_0x5e7b45){const _0x3d8c87=_0x377a59;if(_0x5e7b45)logger[_0x3d8c87(0x34b)](_0x5e7b45);}),config=getConfiguration(),io['to'](_0x377a59(0x247))[_0x377a59(0x3a2)]('bots',config),broadcastToBots(_0x377a59(0x2f5),JSON[_0x377a59(0x38d)](config));}function deleteBot(_0x1ae62d){const _0x1dcbb3=_0x540abc;getClientsWithBotID(_0x1ae62d)['forEach'](_0x1dd0d9=>{const _0x33ff9e=_0x2248;getSocket(_0x1dd0d9['id'])[_0x33ff9e(0x3a8)](!![]),removeClient(_0x1dd0d9['id']);}),dbConfig[_0x1dcbb3(0x2be)](_0x1dcbb3(0x2f5))[_0x1dcbb3(0x2fa)]({'botID':_0x1ae62d})[_0x1dcbb3(0x214)](),logger[_0x1dcbb3(0x34b)](_0x1dcbb3(0x3db)+_0x1ae62d),stopBot(_0x1ae62d);try{if(fs[_0x1dcbb3(0x38f)](path['join'](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+_0x1dcbb3(0x373))))fs[_0x1dcbb3(0x287)](path[_0x1dcbb3(0x3a9)](configpath,'bot-'+_0x1ae62d+'-config.json'));if(fs[_0x1dcbb3(0x38f)](path[_0x1dcbb3(0x3a9)](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+_0x1dcbb3(0x26f))))fs[_0x1dcbb3(0x287)](path[_0x1dcbb3(0x3a9)](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+'-events.json'));if(fs[_0x1dcbb3(0x38f)](path[_0x1dcbb3(0x3a9)](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+_0x1dcbb3(0x217))))fs[_0x1dcbb3(0x287)](path[_0x1dcbb3(0x3a9)](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+'-performance.json'));if(fs[_0x1dcbb3(0x38f)](path[_0x1dcbb3(0x3a9)](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+_0x1dcbb3(0x370))))fs['unlinkSync'](path[_0x1dcbb3(0x3a9)](configpath,_0x1dcbb3(0x2c3)+_0x1ae62d+'-results.json'));}catch(_0x448271){if(_0x448271)logger[_0x1dcbb3(0x34b)](_0x1dcbb3(0x3da),_0x448271);}config=getConfiguration(),io['to'](_0x1dcbb3(0x247))[_0x1dcbb3(0x3a2)](_0x1dcbb3(0x2f5),config),broadcastToBots('bots',JSON[_0x1dcbb3(0x38d)](config));}function toggleBot(_0x2217b5,_0xa10da2,_0x1a0fc1){const _0x74af67=_0x540abc;dbConfig['get'](_0x74af67(0x2f5))['find']({'botID':_0x2217b5})[_0x74af67(0x20d)]({'status':_0xa10da2})[_0x74af67(0x20d)]({'live':_0x1a0fc1})[_0x74af67(0x214)]();if(_0xa10da2==_0x74af67(0x3dc)||_0xa10da2=='new')logger[_0x74af67(0x34b)]('Enabled\x20Bot\x20'+_0x2217b5),startBot([_0x2217b5,userID],{'cwd':bbpath},function(_0x2c28b5){const _0x150b39=_0x74af67;if(_0x2c28b5)logger[_0x150b39(0x34b)](_0x2c28b5);});else(_0xa10da2==_0x74af67(0x32a)||_0xa10da2==_0x74af67(0x3d5))&&(logger[_0x74af67(0x34b)](_0x74af67(0x2ac)+_0x2217b5),stopBot(_0x2217b5));config=getConfiguration(),io['to'](_0x74af67(0x247))[_0x74af67(0x3a2)](_0x74af67(0x2f5),config),broadcastToBots('bots',JSON[_0x74af67(0x38d)](config));}function toggleStatus(_0x5a6c25){const _0x126e67=_0x540abc;let _0x5d5f42=dbConfig[_0x126e67(0x2be)](_0x126e67(0x2f5))[_0x126e67(0x3b5)]({'botID':_0x5a6c25})[_0x126e67(0x326)](),_0x267b71;if(_0x5d5f42[_0x126e67(0x1e8)]==='enabled')_0x267b71=_0x126e67(0x32a);else{if(_0x5d5f42['status']===_0x126e67(0x2d5))_0x267b71=_0x126e67(0x3d5);else{if(_0x5d5f42[_0x126e67(0x1e8)]===_0x126e67(0x3d5))_0x267b71=_0x126e67(0x2d5);else{if(_0x5d5f42[_0x126e67(0x1e8)]===_0x126e67(0x32a))_0x267b71=_0x126e67(0x3dc);}}}return _0x267b71;}function updateStatus(_0x2c2670,_0x59dac5){const _0x19606b=_0x540abc;dbConfig['get'](_0x19606b(0x2f5))[_0x19606b(0x3b5)]({'botID':_0x2c2670})['assign']({'status':_0x59dac5})[_0x19606b(0x214)](),config=getConfiguration(),io['to']('botmanager')[_0x19606b(0x3a2)](_0x19606b(0x2f5),config),broadcastToBots(_0x19606b(0x2f5),JSON['stringify'](config));}function updateLive(_0x1e81c2,_0x5c0fb0){const _0x5e8821=_0x540abc;dbConfig[_0x5e8821(0x2be)](_0x5e8821(0x2f5))['find']({'botID':_0x1e81c2})[_0x5e8821(0x20d)]({'live':_0x5c0fb0})[_0x5e8821(0x214)](),config=getConfiguration(),io['to'](_0x5e8821(0x247))[_0x5e8821(0x3a2)](_0x5e8821(0x2f5),config),broadcastToBots(_0x5e8821(0x2f5),JSON[_0x5e8821(0x38d)](config));}function updateBotName(_0x444be9,_0x566e1e){const _0x561189=_0x540abc;dbConfig['get'](_0x561189(0x2f5))[_0x561189(0x3b5)]({'botID':_0x444be9})[_0x561189(0x20d)]({'botname':_0x566e1e})[_0x561189(0x214)](),config=getConfiguration(),io['to'](_0x561189(0x247))[_0x561189(0x3a2)](_0x561189(0x2f5),config),broadcastToBots(_0x561189(0x2f5),JSON[_0x561189(0x38d)](config));}function updateBotManager(){const _0x375d49=_0x540abc;config=getConfiguration(),io['to'](_0x375d49(0x247))['emit'](_0x375d49(0x2f5),config),broadcastToBots(_0x375d49(0x2f5),JSON[_0x375d49(0x38d)](config));}function toggleBotMode(_0x26b916){const _0x479ddf=_0x540abc;if(pid[_0x26b916])pid[_0x26b916][_0x479ddf(0x35d)]({'function':'toggleBotMode','args':null});else{const _0x2a61e5=configpath+_0x479ddf(0x2c3)+_0x26b916+_0x479ddf(0x373),_0x154eed=fs['readFileSync'](_0x2a61e5),_0x396788=JSON[_0x479ddf(0x2f9)](_0x154eed),_0x2f1ccd=_0x396788['bot'][0x0][_0x479ddf(0x230)];_0x396788[_0x479ddf(0x2af)][0x0][_0x479ddf(0x230)]=!_0x2f1ccd;const _0x101b58=JSON[_0x479ddf(0x38d)](_0x396788,null,0x2);fs[_0x479ddf(0x324)](_0x2a61e5,_0x101b58),config=getConfiguration(),io['to'](_0x479ddf(0x247))[_0x479ddf(0x3a2)](_0x479ddf(0x2f5),config),broadcastToBots(_0x479ddf(0x2f5),JSON[_0x479ddf(0x38d)](config));}}function validateTelegram(_0x2dca41){const _0x2b2211=_0x540abc;if(_0x2dca41[_0x2b2211(0x359)][_0x2b2211(0x3cd)]!=settings[_0x2b2211(0x2c5)]&&'@'+_0x2dca41['from']['username']!=settings[_0x2b2211(0x2c5)]||_0x2dca41['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x2dca41['chat']['id'],_0x2b2211(0x361),{'parse_mode':_0x2b2211(0x330)}),![];return!![];}async function initTelegram(){const _0xcacc22=_0x540abc;if(tgBot)tgBot[_0xcacc22(0x3cf)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0xcacc22(0x2f6)]);let _0x5d548c='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x5d548c+='\x0a',_0x5d548c+=_0xcacc22(0x3a0),_0x5d548c+=_0xcacc22(0x3a4),_0x5d548c+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5d548c+=_0xcacc22(0x221),_0x5d548c+=_0xcacc22(0x371),_0x5d548c+=_0xcacc22(0x29d),_0x5d548c+=_0xcacc22(0x2a9),_0x5d548c+='/names\x20-\x20show\x20bot\x20names\x0a',_0x5d548c+=_0xcacc22(0x35e),_0x5d548c+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x5d548c+=_0xcacc22(0x3e7),_0x5d548c+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x5d548c+=_0xcacc22(0x39d),_0x5d548c+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x110268='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x110268+='\x0a',_0x110268+=_0x5d548c,tgBot[_0xcacc22(0x267)]((_0x9741b7,_0x4b36ba)=>{const _0x2b3df2=_0xcacc22;logger['simple'](getTimeStamp()+_0x2b3df2(0x24b)),logger[_0x2b3df2(0x2f7)](_0x2b3df2(0x396),_0x9741b7);}),tgBot[_0xcacc22(0x20b)](async(_0x4efe62,_0x385dca)=>{const _0x4feb30=_0xcacc22;if(!(!settings['telegramChatId']&&_0x4efe62[_0x4feb30(0x29b)][_0x4feb30(0x271)][_0x4feb30(0x1dc)]==_0x4feb30(0x2f2))){if(!validateTelegram(_0x4efe62))return;}_0x385dca();}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x2b9),async _0x449c90=>{const _0x517da6=_0xcacc22;if(!settings[_0x517da6(0x313)])updateSetting(_0x517da6(0x313),_0x449c90[_0x517da6(0x368)]['id']);updateSetting(_0x517da6(0x235),!![]);if(!validateTelegram(_0x449c90))return;await sendTelegram(_0x449c90[_0x517da6(0x368)]['id'],_0x110268);}),tgBot['command'](_0xcacc22(0x3c4),async _0x45a38e=>{const _0x332799=_0xcacc22;updateSetting(_0x332799(0x235),!![]),await sendTelegram(_0x45a38e[_0x332799(0x368)]['id'],'Notifications\x20enabled');}),tgBot[_0xcacc22(0x2ee)]('disable',async _0x1ee20f=>{const _0x22871b=_0xcacc22;await sendTelegram(_0x1ee20f[_0x22871b(0x368)]['id'],_0x22871b(0x375)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0xcacc22(0x385),async _0x13818a=>{const _0x5ca161=_0xcacc22,_0x31f332=Markup[_0x5ca161(0x2b5)]([Markup[_0x5ca161(0x36c)]['callback']('Orders',_0x5ca161(0x266)),Markup[_0x5ca161(0x36c)][_0x5ca161(0x356)](_0x5ca161(0x259),_0x5ca161(0x25f)),Markup[_0x5ca161(0x36c)][_0x5ca161(0x356)](_0x5ca161(0x310),_0x5ca161(0x30d))]);_0x13818a[_0x5ca161(0x246)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x31f332);}),tgBot[_0xcacc22(0x273)](_0xcacc22(0x266),async _0x393b43=>{const _0x4e2c81=_0xcacc22;_0x393b43[_0x4e2c81(0x2f3)](),updateSetting('telegramEvents',_0x4e2c81(0x2d4)),updateSetting(_0x4e2c81(0x235),!![]),await sendTelegram(_0x393b43['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0xcacc22(0x273)](_0xcacc22(0x25f),async _0x37aacf=>{const _0x21ea13=_0xcacc22;_0x37aacf[_0x21ea13(0x2f3)](),updateSetting(_0x21ea13(0x395),_0x21ea13(0x2b6)),updateSetting(_0x21ea13(0x235),!![]),await sendTelegram(_0x37aacf[_0x21ea13(0x368)]['id'],_0x21ea13(0x297));}),tgBot[_0xcacc22(0x273)]('config_all',async _0x40bdf6=>{const _0x4574d9=_0xcacc22;_0x40bdf6['editMessageReplyMarkup'](),updateSetting('telegramEvents','all'),updateSetting(_0x4574d9(0x235),!![]),await sendTelegram(_0x40bdf6['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x1e8),async _0x21bb1e=>{const _0x2f7ea7=_0xcacc22,_0x34a7ec=getBotsWithMode();let _0x14edd2=_0x2f7ea7(0x320);config[_0x2f7ea7(0x1f5)](_0xde1499=>{const _0x117118=_0x2f7ea7,_0xad4ab8=_0x34a7ec[_0x117118(0x3b5)](_0xe214cc=>_0xe214cc[_0x117118(0x3df)]==_0xde1499['botID'])['mode'];_0x14edd2+=_0x117118(0x224)+_0xde1499[_0x117118(0x3df)]+':\x20'+_0xde1499[_0x117118(0x1e8)]+'\x20|\x20'+_0xad4ab8+'\x20|\x20'+_0xde1499[_0x117118(0x37c)]+'\x0a';}),_0x14edd2+='\x0a',_0x14edd2+=_0x2f7ea7(0x252),_0x14edd2+=!settings[_0x2f7ea7(0x235)]?'Notifications\x20disabled\x0a':_0x2f7ea7(0x223),_0x14edd2+=settings[_0x2f7ea7(0x235)]?settings[_0x2f7ea7(0x395)]==_0x2f7ea7(0x3b8)?_0x2f7ea7(0x220):_0x2f7ea7(0x2c7)+settings[_0x2f7ea7(0x395)]+'\x20only\x0a':'',await sendTelegram(_0x21bb1e[_0x2f7ea7(0x368)]['id'],_0x14edd2,{'parse_mode':'HTML'});}),tgBot['command']('restart',async _0x168291=>{const _0x3fdd96=_0xcacc22,_0x4f006a=getEnabledBots();if(_0x4f006a[_0x3fdd96(0x261)]==0x0)await sendTelegram(_0x168291[_0x3fdd96(0x368)]['id'],_0x3fdd96(0x378));else{if(_0x4f006a[_0x3fdd96(0x261)]>0x1)_0x4f006a[_0x3fdd96(0x379)]({'botID':_0x3fdd96(0x3b8)});let _0x493edf=[],_0x3bc3e4=[];const _0x3e3e09=_0x4f006a[_0x3fdd96(0x261)]%0x4==0x0||_0x4f006a[_0x3fdd96(0x261)]%0x4==0x3||_0x4f006a[_0x3fdd96(0x261)]%0x3==0x1?0x4:0x3;let _0x4c8d4d=0x0;_0x4f006a[_0x3fdd96(0x1f5)]((_0x5796a1,_0x2fe973)=>{const _0x49d00a=_0x3fdd96;if(_0x2fe973%_0x3e3e09==0x0)_0x3bc3e4=[];_0x3bc3e4[_0x49d00a(0x379)](Markup[_0x49d00a(0x36c)][_0x49d00a(0x356)](_0x5796a1[_0x49d00a(0x3df)]==_0x49d00a(0x3b8)?'All\x20bots':'Bot\x20'+_0x5796a1['botID'],_0x49d00a(0x29f)+_0x5796a1[_0x49d00a(0x3df)])),_0x2fe973%_0x3e3e09==0x0&&(_0x493edf[_0x4c8d4d]=_0x3bc3e4,_0x4c8d4d++);});const _0x1774f1=Markup[_0x3fdd96(0x2b5)](_0x493edf);_0x168291[_0x3fdd96(0x246)](_0x3fdd96(0x2d2),_0x1774f1);}}),tgBot[_0xcacc22(0x273)](/restart_(.+)/,async _0x5462c0=>{const _0x44ea61=_0xcacc22,_0x25dad4=_0x5462c0['match'][0x1];_0x5462c0[_0x44ea61(0x2f3)](),_0x25dad4==_0x44ea61(0x3b8)?config['forEach'](_0x334675=>{const _0x51cdb3=_0x44ea61;restartBot(_0x334675[_0x51cdb3(0x3df)]);}):restartBot(_0x25dad4);}),tgBot['command']('on',async _0x13ddb9=>{const _0x67ec0f=_0xcacc22,_0x2081fa=getDisabledBots();if(_0x2081fa['length']==0x0)await sendTelegram(_0x13ddb9[_0x67ec0f(0x368)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x2081fa[_0x67ec0f(0x261)]>0x1)_0x2081fa[_0x67ec0f(0x379)]({'botID':_0x67ec0f(0x3b8)});let _0x3c8651=[],_0x2dbb4d=[];const _0x2e9781=_0x2081fa[_0x67ec0f(0x261)]%0x4==0x0||_0x2081fa['length']%0x4==0x3||_0x2081fa[_0x67ec0f(0x261)]%0x3==0x1?0x4:0x3;let _0x4d9004=0x0;_0x2081fa['forEach']((_0x3e5e7f,_0x3b1967)=>{const _0x33c6d5=_0x67ec0f;if(_0x3b1967%_0x2e9781==0x0)_0x2dbb4d=[];_0x2dbb4d[_0x33c6d5(0x379)](Markup[_0x33c6d5(0x36c)][_0x33c6d5(0x356)](_0x3e5e7f[_0x33c6d5(0x3df)]=='all'?_0x33c6d5(0x283):_0x33c6d5(0x224)+_0x3e5e7f[_0x33c6d5(0x3df)],_0x33c6d5(0x251)+_0x3e5e7f[_0x33c6d5(0x3df)])),_0x3b1967%_0x2e9781==0x0&&(_0x3c8651[_0x4d9004]=_0x2dbb4d,_0x4d9004++);});const _0x7f524f=Markup[_0x67ec0f(0x2b5)](_0x3c8651);_0x13ddb9[_0x67ec0f(0x246)](_0x67ec0f(0x390),_0x7f524f);}}),tgBot['action'](/on_(.+)/,async _0x1411e3=>{const _0xa78aa2=_0xcacc22,_0xc1dcfd=_0x1411e3['match'][0x1];_0x1411e3['editMessageReplyMarkup']();if(_0xc1dcfd=='all'){const _0x2f5e69=getDisabledBots();await sendTelegram(_0x1411e3[_0xa78aa2(0x368)]['id'],_0xa78aa2(0x328)),_0x2f5e69[_0xa78aa2(0x1f5)](_0x39b4bf=>{const _0xa6a8c1=_0xa78aa2;if(_0x39b4bf[_0xa6a8c1(0x3df)]!='all')toggleBot(_0x39b4bf[_0xa6a8c1(0x3df)],toggleStatus(_0x39b4bf['botID']),_0xa6a8c1(0x3d4));});}else await sendTelegram(_0x1411e3['chat']['id'],_0xa78aa2(0x24c)+_0xc1dcfd),toggleBot(_0xc1dcfd,toggleStatus(_0xc1dcfd),_0xa78aa2(0x3d4));}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x20f),async _0x4723ad=>{const _0x48e707=_0xcacc22,_0x582e7c=getEnabledBots();if(_0x582e7c[_0x48e707(0x261)]==0x0)await sendTelegram(_0x4723ad[_0x48e707(0x368)]['id'],_0x48e707(0x378));else{if(_0x582e7c[_0x48e707(0x261)]>0x1)_0x582e7c['push']({'botID':_0x48e707(0x3b8)});let _0x2b4995=[],_0x446c5c=[];const _0x372a6c=_0x582e7c[_0x48e707(0x261)]%0x4==0x0||_0x582e7c['length']%0x4==0x3||_0x582e7c[_0x48e707(0x261)]%0x3==0x1?0x4:0x3;let _0x483451=0x0;_0x582e7c[_0x48e707(0x1f5)]((_0x24f3f0,_0x12e5b5)=>{const _0x4de234=_0x48e707;if(_0x12e5b5%_0x372a6c==0x0)_0x446c5c=[];_0x446c5c[_0x4de234(0x379)](Markup['button'][_0x4de234(0x356)](_0x24f3f0[_0x4de234(0x3df)]==_0x4de234(0x3b8)?_0x4de234(0x283):_0x4de234(0x224)+_0x24f3f0[_0x4de234(0x3df)],_0x4de234(0x24f)+_0x24f3f0[_0x4de234(0x3df)])),_0x12e5b5%_0x372a6c==0x0&&(_0x2b4995[_0x483451]=_0x446c5c,_0x483451++);});const _0x460c45=Markup[_0x48e707(0x2b5)](_0x2b4995);_0x4723ad[_0x48e707(0x246)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x460c45);}}),tgBot[_0xcacc22(0x273)](/off_(.+)/,async _0x326d36=>{const _0x330980=_0xcacc22,_0xac8cf7=_0x326d36[_0x330980(0x264)][0x1];_0x326d36[_0x330980(0x2f3)]();if(_0xac8cf7==_0x330980(0x3b8)){const _0x337f22=getEnabledBots();await sendTelegram(_0x326d36['chat']['id'],_0x330980(0x2b4)),_0x337f22['forEach'](_0x346027=>{const _0xa175c1=_0x330980;if(_0x346027[_0xa175c1(0x3df)]!='all')toggleBot(_0x346027[_0xa175c1(0x3df)],toggleStatus(_0x346027['botID']),_0xa175c1(0x3d4));});}else await sendTelegram(_0x326d36[_0x330980(0x368)]['id'],_0x330980(0x34d)+_0xac8cf7),toggleBot(_0xac8cf7,toggleStatus(_0xac8cf7),_0x330980(0x3d4));}),tgBot['command'](_0xcacc22(0x309),async _0x384d95=>{const _0x505dbb=_0xcacc22,_0x302774=getEnabledBots();if(_0x302774[_0x505dbb(0x261)]==0x0)await sendTelegram(_0x384d95['chat']['id'],_0x505dbb(0x378));else{if(_0x302774[_0x505dbb(0x261)]>0x1){let _0x8c3f4a=[],_0x69fef3=[];const _0x298053=_0x302774[_0x505dbb(0x261)]%0x4==0x0||_0x302774[_0x505dbb(0x261)]%0x4==0x3||_0x302774['length']%0x3==0x1?0x4:0x3;let _0x57e51c=0x0;_0x302774['forEach']((_0x4772a3,_0x5adc69)=>{const _0x208ca6=_0x505dbb;if(_0x5adc69%_0x298053==0x0)_0x69fef3=[];_0x69fef3[_0x208ca6(0x379)](Markup[_0x208ca6(0x36c)][_0x208ca6(0x356)]('Bot\x20'+_0x4772a3[_0x208ca6(0x3df)],_0x208ca6(0x1de)+_0x4772a3['botID'])),_0x5adc69%_0x298053==0x0&&(_0x8c3f4a[_0x57e51c]=_0x69fef3,_0x57e51c++);});const _0x3dd66d=Markup['inlineKeyboard'](_0x8c3f4a);_0x384d95[_0x505dbb(0x246)](_0x505dbb(0x2c1),_0x3dd66d);}else{const _0x98241e=_0x302774[0x0]['botID'];if(pid[_0x98241e])pid[_0x98241e]['send']({'function':_0x505dbb(0x302),'args':null});}}}),tgBot[_0xcacc22(0x273)](/metrics_(.+)/,async _0x2eff9a=>{const _0x18aad3=_0xcacc22,_0x3cd709=_0x2eff9a[_0x18aad3(0x264)][0x1];_0x2eff9a[_0x18aad3(0x2f3)]();if(pid[_0x3cd709])pid[_0x3cd709][_0x18aad3(0x35d)]({'function':_0x18aad3(0x302),'args':null});}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x22e),async _0x52e2f6=>{const _0x38653e=_0xcacc22,_0x37843e=getEnabledBots();if(_0x37843e[_0x38653e(0x261)]==0x0)await sendTelegram(_0x52e2f6[_0x38653e(0x368)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x37843e[_0x38653e(0x261)]>0x1){let _0x131fb8=[],_0xd76697=[];const _0x49443e=_0x37843e[_0x38653e(0x261)]%0x4==0x0||_0x37843e[_0x38653e(0x261)]%0x4==0x3||_0x37843e[_0x38653e(0x261)]%0x3==0x1?0x4:0x3;let _0x3481a4=0x0;_0x37843e[_0x38653e(0x1f5)]((_0x50daef,_0x578c36)=>{const _0x3f752b=_0x38653e;if(_0x578c36%_0x49443e==0x0)_0xd76697=[];_0xd76697[_0x3f752b(0x379)](Markup[_0x3f752b(0x36c)]['callback'](_0x3f752b(0x224)+_0x50daef[_0x3f752b(0x3df)],_0x3f752b(0x1e5)+_0x50daef[_0x3f752b(0x3df)])),_0x578c36%_0x49443e==0x0&&(_0x131fb8[_0x3481a4]=_0xd76697,_0x3481a4++);});const _0x365946=Markup[_0x38653e(0x2b5)](_0x131fb8);_0x52e2f6['reply'](_0x38653e(0x2e9),_0x365946);}else{const _0x1665ae=_0x37843e[0x0][_0x38653e(0x3df)];if(pid[_0x1665ae])pid[_0x1665ae][_0x38653e(0x35d)]({'function':_0x38653e(0x2c4),'args':null});}}}),tgBot[_0xcacc22(0x273)](/portfolio_(.+)/,async _0x4647c1=>{const _0x5766e5=_0xcacc22,_0x27689d=_0x4647c1['match'][0x1];_0x4647c1[_0x5766e5(0x2f3)]();if(pid[_0x27689d])pid[_0x27689d]['send']({'function':_0x5766e5(0x2c4),'args':null});}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x29b),async _0x364d02=>{const _0x2f9b3e=_0xcacc22;await getMessages();if(!updateAvailable)await sendTelegram(_0x364d02[_0x2f9b3e(0x368)]['id'],_0x2f9b3e(0x304));else{if(!validInstallation)await sendTelegram(_0x364d02['chat']['id'],_0x2f9b3e(0x218));else{const _0xddcc21=Markup['inlineKeyboard']([Markup[_0x2f9b3e(0x36c)][_0x2f9b3e(0x356)](_0x2f9b3e(0x318),'update_yes'),Markup[_0x2f9b3e(0x36c)][_0x2f9b3e(0x356)]('No',_0x2f9b3e(0x312))]);_0x364d02[_0x2f9b3e(0x246)](_0x2f9b3e(0x248),_0xddcc21);}}}),tgBot[_0xcacc22(0x273)](/update_(.+)/,async _0xad055b=>{const _0x1c6cc3=_0xcacc22,_0x1e8d84=_0xad055b['match'][0x1];_0xad055b['editMessageReplyMarkup'](),_0x1e8d84=='yes'&&(await sendTelegram(_0xad055b[_0x1c6cc3(0x368)]['id'],_0x1c6cc3(0x2ba)),updateBB('update')),_0x1e8d84=='no'&&await sendTelegram(_0xad055b['chat']['id'],_0x1c6cc3(0x3b2));}),tgBot[_0xcacc22(0x2ee)]('reinstall',async _0x524e89=>{const _0x1a6387=_0xcacc22;if(!validInstallation)await sendTelegram(_0x524e89['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x46ed7c=Markup[_0x1a6387(0x2b5)]([Markup['button'][_0x1a6387(0x356)]('Yes',_0x1a6387(0x31c)),Markup[_0x1a6387(0x36c)][_0x1a6387(0x356)]('No','reinstall_no')]);_0x524e89['reply'](_0x1a6387(0x3c7),_0x46ed7c);}}),tgBot['action'](/reinstall_(.+)/,async _0x421eaa=>{const _0x7a0f83=_0xcacc22,_0x42fbd6=_0x421eaa['match'][0x1];_0x421eaa[_0x7a0f83(0x2f3)](),_0x42fbd6=='yes'&&(await sendTelegram(_0x421eaa[_0x7a0f83(0x368)]['id'],_0x7a0f83(0x20c)),updateBB('reinstall')),_0x42fbd6=='no'&&await sendTelegram(_0x421eaa[_0x7a0f83(0x368)]['id'],_0x7a0f83(0x1e4));}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x29a),async _0x58ead9=>{const _0x49ff75=_0xcacc22,_0x44879d=getBotsWithMode();if(_0x44879d[_0x49ff75(0x261)]==0x0)await sendTelegram(_0x58ead9['chat']['id'],_0x49ff75(0x378));else{let _0x13d15c=[],_0x50f280=[];const _0x1c98f4=0x2;let _0x46794f=0x0;_0x44879d[_0x49ff75(0x1f5)]((_0x467fb1,_0x353bfb)=>{const _0x333ab4=_0x49ff75;if(_0x353bfb%_0x1c98f4==0x0)_0x50f280=[];_0x50f280[_0x333ab4(0x379)](Markup[_0x333ab4(0x36c)][_0x333ab4(0x356)]('Bot\x20'+_0x467fb1[_0x333ab4(0x3df)]+'\x20('+_0x467fb1[_0x333ab4(0x270)]+')',_0x333ab4(0x2f0)+_0x467fb1['botID'])),_0x353bfb%_0x1c98f4==0x0&&(_0x13d15c[_0x46794f]=_0x50f280,_0x46794f++);});const _0x1dbb49=Markup[_0x49ff75(0x2b5)](_0x13d15c);_0x58ead9['reply'](_0x49ff75(0x3b0),_0x1dbb49);}}),tgBot[_0xcacc22(0x273)](/toggle_(.+)/,async _0x1e26a8=>{const _0x11f430=_0xcacc22,_0x42a064=_0x1e26a8[_0x11f430(0x264)][0x1];_0x1e26a8[_0x11f430(0x2f3)]();const _0x5d56c5=getBotsWithMode(),_0x38e948=_0x5d56c5['find'](_0x183419=>_0x183419['botID']==_0x42a064),_0x558130=_0x38e948[_0x11f430(0x270)]==_0x11f430(0x2bf)?_0x11f430(0x37a):_0x11f430(0x2bf);await sendTelegram(_0x1e26a8[_0x11f430(0x368)]['id'],_0x11f430(0x225)+_0x42a064+'\x20to\x20'+_0x558130+_0x11f430(0x2ae)),toggleBotMode(_0x42a064);}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x2a1),async _0x1504b3=>{const _0x20ab8b=_0xcacc22;let _0x5e847d='';config[_0x20ab8b(0x1f5)](_0x3ee0ba=>{const _0x23859b=_0x20ab8b;_0x5e847d+='Bot\x20'+_0x3ee0ba[_0x23859b(0x3df)]+':\x20'+_0x3ee0ba[_0x23859b(0x26d)]+'\x0a';}),await sendTelegram(_0x1504b3['chat']['id'],_0x5e847d,{'parse_mode':_0x20ab8b(0x330)});}),tgBot[_0xcacc22(0x2ee)](_0xcacc22(0x3ce),async _0xe70718=>{const _0x45b3a5=_0xcacc22;await sendTelegram(_0xe70718[_0x45b3a5(0x368)]['id'],_0x5d548c);}),process['once'](_0xcacc22(0x25d),()=>tgBot['stop'](_0xcacc22(0x25d))),process[_0xcacc22(0x1e0)](_0xcacc22(0x3de),()=>tgBot[_0xcacc22(0x3cf)]('SIGTERM')),tgBot[_0xcacc22(0x3e2)]();}}function disableTelegram(){const _0x2468bd=_0x540abc;tgBot&&tgBot[_0x2468bd(0x3cf)]();}async function sendTelegram(_0x47416b,_0xe4816d,_0x115cd1){const _0x5cebff=_0x540abc;_0x115cd1={..._0x115cd1,'disable_web_page_preview':!![]};try{await tgBot[_0x5cebff(0x393)][_0x5cebff(0x1f2)](_0x47416b,_0xe4816d,_0x115cd1);}catch(_0x511742){console[_0x5cebff(0x3c5)](_0x5cebff(0x2b7),_0x511742);}}async function sendTelegramBot(_0x954602,_0x1c1363){const _0x365323=_0x540abc;if(settings[_0x365323(0x235)]){if(settings[_0x365323(0x395)]=='all'||(_0x1c1363[_0x365323(0x341)]=='error'||_0x1c1363[_0x365323(0x341)]==_0x365323(0x208)||_0x1c1363['type']==_0x365323(0x1d8))&&settings[_0x365323(0x395)]==_0x365323(0x2b6)||_0x1c1363[_0x365323(0x341)]==_0x365323(0x2da)&&settings[_0x365323(0x395)]=='orders'){if(tgBot&&settings[_0x365323(0x313)]){if(_0x1c1363[_0x365323(0x207)])await sendTelegram(settings[_0x365323(0x313)],_0x1c1363[_0x365323(0x26d)]+_0x365323(0x2e1)+_0x1c1363[_0x365323(0x288)]);else await sendTelegram(settings['telegramChatId'],_0x365323(0x224)+_0x954602+_0x365323(0x2e1)+_0x1c1363[_0x365323(0x288)]);}}}}async function sendTelegramMsg(_0x48cf77,_0x4e1d5d='HTML'){const _0x573899=_0x540abc;return settings[_0x573899(0x235)]&&tgBot&&settings[_0x573899(0x313)]?(await sendTelegram(settings['telegramChatId'],_0x48cf77,{'parse_mode':_0x4e1d5d}),!![]):![];}function getDeviceWithIp(_0x5f972b){const _0x2d9499=_0x540abc;return devices[_0x2d9499(0x3b5)](_0x21f1b5=>_0x21f1b5['ip']===_0x5f972b);}async function temporaryAccess2FA(_0x580e4d,_0x37701f){const _0x2713cb=_0x540abc;let _0x575b76=new Date(),_0x21c0b7=![];if(lastIpApproval){if(_0x575b76-lastIpApproval<0x1388)_0x21c0b7=!![];}lastIpApproval=new Date();if(_0x21c0b7)return;if(tgBot&&settings[_0x2713cb(0x313)]){const _0x10eb5f=uuidRandom();tmpStorage[_0x10eb5f]={'uuid':_0x580e4d,'externalip':_0x37701f};const _0x45ea5f=Markup[_0x2713cb(0x2b5)]([Markup['button'][_0x2713cb(0x356)]('5\x20min',_0x2713cb(0x3bc)+_0x10eb5f),Markup[_0x2713cb(0x36c)][_0x2713cb(0x356)]('15\x20min',_0x2713cb(0x358)+_0x10eb5f),Markup[_0x2713cb(0x36c)][_0x2713cb(0x356)]('30\x20min',_0x2713cb(0x215)+_0x10eb5f),Markup['button'][_0x2713cb(0x356)](_0x2713cb(0x314),'tempaccess_reject_'+_0x10eb5f)]);await sendTelegram(settings[_0x2713cb(0x313)],_0x2713cb(0x300)+normalizeIP(_0x37701f)[_0x2713cb(0x245)]+'\x20?',_0x45ea5f),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x8f019b=>{const _0x491c49=_0x2713cb,_0x745084=_0x8f019b[_0x491c49(0x264)][0x1],_0x194877=_0x8f019b[_0x491c49(0x264)][0x2],{uuid:_0x115028,externalip:_0x3e7fd2}=tmpStorage[_0x194877];delete tmpStorage[_0x194877],_0x8f019b['editMessageReplyMarkup'](),devices[_0x115028][_0x491c49(0x1ff)]={'clientip':_0x3e7fd2,'timestamp':new Date()[_0x491c49(0x22b)](),'expiry':_0x745084},_0x745084!='reject'?(await sendTelegram(_0x8f019b['chat']['id'],_0x491c49(0x228)+_0x745084+_0x491c49(0x28f),{'parse_mode':'HTML'}),io['to'](_0x115028)[_0x491c49(0x3a2)](_0x491c49(0x1e8),{'access':{'allow':![],'reason':_0x491c49(0x262),'token':null}})):(await sendTelegram(_0x8f019b[_0x491c49(0x368)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x115028)[_0x491c49(0x3a2)](_0x491c49(0x1e8),{'access':{'allow':![],'reason':_0x491c49(0x3a6),'token':null}}));});}}async function loginAccess2FA(_0x3609f3,_0x355bb6){const _0x219f22=_0x540abc;if(tgBot&&settings[_0x219f22(0x313)]){const _0x2e4911=uuidRandom();tmpStorage[_0x2e4911]={'uuid':_0x3609f3,'externalip':_0x355bb6};const _0x25a06b=Markup['inlineKeyboard']([Markup[_0x219f22(0x36c)][_0x219f22(0x356)](_0x219f22(0x3e4),_0x219f22(0x351)+loginExpiry+'_'+_0x2e4911),Markup[_0x219f22(0x36c)][_0x219f22(0x356)](_0x219f22(0x314),_0x219f22(0x319)+_0x2e4911)]);await sendTelegram(settings[_0x219f22(0x313)],_0x219f22(0x2ab)+normalizeIP(_0x355bb6)['show']+'\x20?',_0x25a06b),tgBot[_0x219f22(0x273)](/login2fa_(.+)_(.+)/,async _0x34dfff=>{const _0x4c7f52=_0x219f22,_0x1a5cbe=_0x34dfff[_0x4c7f52(0x264)][0x1],_0x1243a7=_0x34dfff[_0x4c7f52(0x264)][0x2],{uuid:_0x1a5ee8,externalip:_0x22acc1}=tmpStorage[_0x1243a7];delete tmpStorage[_0x1243a7],_0x34dfff[_0x4c7f52(0x2f3)](),devices[_0x1a5ee8][_0x4c7f52(0x348)]={'clientip':_0x22acc1,'timestamp':new Date()[_0x4c7f52(0x22b)](),'expiry':_0x1a5cbe},_0x1a5cbe!=_0x4c7f52(0x314)?(await sendTelegram(_0x34dfff['chat']['id'],_0x4c7f52(0x201),{'parse_mode':'HTML'}),io['to'](_0x1a5ee8)[_0x4c7f52(0x3a2)](_0x4c7f52(0x1e8),{'access':{'allow':![],'reason':_0x4c7f52(0x262),'token':null}})):(await sendTelegram(_0x34dfff['chat']['id'],'Login\x20rejected'),io['to'](_0x1a5ee8)[_0x4c7f52(0x3a2)](_0x4c7f52(0x1e8),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xecb825=_0x540abc;return dbConfig['get'](_0xecb825(0x2f5))[_0xecb825(0x3d2)]('botID')[_0xecb825(0x256)]({'status':_0xecb825(0x3dc)})[_0xecb825(0x326)]()||[];}function getDisabledBots(){const _0x5970e9=_0x540abc;return dbConfig[_0x5970e9(0x2be)](_0x5970e9(0x2f5))[_0x5970e9(0x3d2)](_0x5970e9(0x3df))['filter']({'status':_0x5970e9(0x32a)})[_0x5970e9(0x326)]()||[];}function getBotAttributes(_0x108700){const _0x1ea0bc=_0x540abc;let _0x4f1571={};const _0x53465d=configpath+'bot-'+_0x108700+_0x1ea0bc(0x373),_0x570363=fs[_0x1ea0bc(0x38f)](_0x53465d);if(_0x570363){const _0x505652=fs[_0x1ea0bc(0x2e0)](_0x53465d);try{const _0x4241e2=JSON[_0x1ea0bc(0x2f9)](_0x505652),_0x5cb3e4=_0x4241e2?_0x4241e2[_0x1ea0bc(0x2af)][0x0]['headless']:![];_0x4f1571['mode']=_0x5cb3e4?_0x1ea0bc(0x2bf):'manual',_0x4f1571[_0x1ea0bc(0x26d)]=_0x4241e2?_0x4241e2[_0x1ea0bc(0x2af)][0x0][_0x1ea0bc(0x26d)]:'Bot\x20'+_0x108700;}catch(_0x513c57){_0x4f1571[_0x1ea0bc(0x270)]=_0x1ea0bc(0x37a),_0x4f1571['botname']=_0x1ea0bc(0x224)+_0x108700;}}else _0x4f1571[_0x1ea0bc(0x270)]=_0x1ea0bc(0x37a),_0x4f1571[_0x1ea0bc(0x26d)]=_0x1ea0bc(0x224)+_0x108700;return _0x4f1571;}function getBotsWithMode(){const _0x5ae9a2=_0x540abc,_0x201c16=dbConfig[_0x5ae9a2(0x2be)](_0x5ae9a2(0x2f5))[_0x5ae9a2(0x3d2)](_0x5ae9a2(0x3df))[_0x5ae9a2(0x326)]()||[];return _0x201c16[_0x5ae9a2(0x1f5)](_0x3d4097=>{const _0x1c22f7=_0x5ae9a2;let _0x1882d1=getBotAttributes(_0x3d4097[_0x1c22f7(0x3df)]);_0x3d4097[_0x1c22f7(0x270)]=_0x1882d1['mode'];}),_0x201c16;}function getBotExchanges(){const _0x2c4d6a=_0x540abc;let _0x56e164=[];const _0x2fc004=dbConfig[_0x2c4d6a(0x2be)](_0x2c4d6a(0x2f5))[_0x2c4d6a(0x3d2)](_0x2c4d6a(0x3df))['value']()||[];_0x2fc004[_0x2c4d6a(0x1f5)](_0x5561bd=>{const _0x521ead=_0x2c4d6a;if(_0x5561bd[_0x521ead(0x1e8)]==_0x521ead(0x3dc)){const _0x1468b2=configpath+_0x521ead(0x2c3)+_0x5561bd[_0x521ead(0x3df)]+_0x521ead(0x373),_0x2660a0=fs[_0x521ead(0x38f)](_0x1468b2);let _0x2f1216;if(_0x2660a0){const _0x173c7b=fs[_0x521ead(0x2e0)](_0x1468b2);try{const _0x56a9c5=JSON[_0x521ead(0x2f9)](_0x173c7b);_0x2f1216=_0x56a9c5?_0x56a9c5[_0x521ead(0x2af)][0x0]['exchange']:null;}catch(_0x202c0a){}}if(_0x2f1216)_0x56e164[_0x521ead(0x379)](_0x2f1216);}});const _0x15025f=[...new Set(_0x56e164)][_0x2c4d6a(0x39a)]();return _0x15025f;}async function initUser(){const _0x175725=_0x540abc;if(!settings[_0x175725(0x29c)]){const _0xabf0b0=uuidRandom();mixpanel[_0x175725(0x1da)](_0xabf0b0),updateSetting(_0x175725(0x29c),_0xabf0b0);}}async function initSecure(){const _0x40dfe8=_0x540abc;let _0x53050d=getSecure();if(!_0x53050d[_0x40dfe8(0x323)](_0x40dfe8(0x3b6))){let _0x300de8=await generateKeys();_0x53050d[_0x40dfe8(0x1fa)]=_0x300de8[_0x40dfe8(0x1fa)],_0x53050d[_0x40dfe8(0x3ad)]=_0x300de8[_0x40dfe8(0x3ad)],_0x53050d['secret']=crypto['randomBytes'](0x20)[_0x40dfe8(0x1dd)](_0x40dfe8(0x350));;storeSecure(_0x53050d);}}function getSettings(){const _0x42ddbc=_0x540abc;return dbSettings['get'](_0x42ddbc(0x332))[_0x42ddbc(0x326)]()||{};}function getSecure(){const _0x39cdd2=_0x540abc;return dbSecure[_0x39cdd2(0x2be)](_0x39cdd2(0x1ec))[_0x39cdd2(0x326)]()||{};}function getBlacklist(){const _0x351d02=_0x540abc;return dbSecure[_0x351d02(0x2be)](_0x351d02(0x30f))['value']()||[];}function broadcastToBots(_0x2a9911,_0x4fe8b8){const _0x45c1cd=_0x540abc;config[_0x45c1cd(0x1f5)](_0x4cb3e0=>{const _0x480a0e=_0x45c1cd;if(_0x4cb3e0[_0x480a0e(0x1e8)]==_0x480a0e(0x3dc)&&_0x4cb3e0['live']==_0x480a0e(0x2c8)||_0x4cb3e0['status']=='new'&&_0x4cb3e0[_0x480a0e(0x37c)]==_0x480a0e(0x2c8)){if(pid[_0x4cb3e0[_0x480a0e(0x3df)]])pid[_0x4cb3e0[_0x480a0e(0x3df)]][_0x480a0e(0x35d)]({[_0x2a9911]:_0x4fe8b8});}});}async function storeSettings(_0x58a096,_0x51d364=![]){const _0x15e5bb=_0x540abc;_0x58a096={...settings,..._0x58a096};if(_0x51d364&&_0x58a096['bbPassword']!=_0x15e5bb(0x33e)&&_0x58a096[_0x15e5bb(0x317)]!=_0x15e5bb(0x31e)&&_0x58a096['bbPassword']!=''){const _0x1563a3=crypt[_0x15e5bb(0x239)](secure[_0x15e5bb(0x3ad)],_0x58a096[_0x15e5bb(0x317)])[_0x15e5bb(0x271)][_0x15e5bb(0x36f)](_0x15e5bb(0x1f6))[0x0],_0x48c5e5=bcrypt[_0x15e5bb(0x274)](_0x1563a3,saltRounds);_0x58a096={..._0x58a096,'bbPassword':_0x48c5e5};}if(_0x51d364&&_0x58a096[_0x15e5bb(0x2f6)]!=_0x15e5bb(0x33e)&&_0x58a096[_0x15e5bb(0x2f6)]!='***'&&_0x58a096[_0x15e5bb(0x2f6)]!=''){const _0x4c15b8=crypt['decrypt'](secure['privateKey'],_0x58a096[_0x15e5bb(0x2f6)])[_0x15e5bb(0x271)][_0x15e5bb(0x36f)](_0x15e5bb(0x1f6))[0x0];_0x58a096={..._0x58a096,'telegramToken':_0x4c15b8};}if(_0x51d364&&_0x58a096[_0x15e5bb(0x1fb)]!=_0x15e5bb(0x33e)&&_0x58a096['marketcapApi']!='***'&&_0x58a096[_0x15e5bb(0x1fb)]!=''){const _0x465389=crypt[_0x15e5bb(0x239)](secure['privateKey'],_0x58a096[_0x15e5bb(0x1fb)])[_0x15e5bb(0x271)][_0x15e5bb(0x36f)](_0x15e5bb(0x1f6))[0x0];_0x58a096={..._0x58a096,'marketcapApi':_0x465389};}const _0x5a5892=_0x58a096[_0x15e5bb(0x2f6)]!=_0x15e5bb(0x33e)&&_0x58a096[_0x15e5bb(0x2f6)]!=settings['telegramToken']||_0x58a096[_0x15e5bb(0x2c5)]!=settings[_0x15e5bb(0x2c5)],_0x3ddf8b=_0x58a096[_0x15e5bb(0x2f6)]==''||_0x58a096['telegramUsername']=='',_0x15f40f=_0x58a096[_0x15e5bb(0x1fb)]&&_0x58a096[_0x15e5bb(0x1fb)]!=_0x15e5bb(0x33e)&&_0x58a096[_0x15e5bb(0x1fb)]!=settings['telegramToken'];_0x5a5892&&(_0x58a096[_0x15e5bb(0x313)]=null,_0x58a096[_0x15e5bb(0x395)]=_0x15e5bb(0x3b8));for(const [_0x3a005b,_0x4c765e]of Object[_0x15e5bb(0x23b)](_0x58a096)){if(_0x3a005b==_0x15e5bb(0x2f6)&&_0x4c765e==_0x15e5bb(0x33e)){_0x58a096[_0x15e5bb(0x2f6)]=settings[_0x15e5bb(0x2f6)];continue;};if(_0x3a005b==_0x15e5bb(0x317)&&_0x4c765e==_0x15e5bb(0x33e)){_0x58a096['bbPassword']=settings['bbPassword'];continue;};if(_0x3a005b==_0x15e5bb(0x1fb)&&_0x4c765e==_0x15e5bb(0x33e)){_0x58a096[_0x15e5bb(0x1fb)]=settings[_0x15e5bb(0x1fb)];continue;};dbSettings[_0x15e5bb(0x265)](_0x15e5bb(0x3c6)+_0x3a005b,_0x4c765e)[_0x15e5bb(0x214)]();}settings=_0x58a096,io['to'](_0x15e5bb(0x247))[_0x15e5bb(0x3a2)](_0x15e5bb(0x332),cleanSettings()),broadcastToBots(_0x15e5bb(0x2ed),settings['timeshift']),broadcastToBots(_0x15e5bb(0x1d7),settings['onepagemode']),broadcastToBots(_0x15e5bb(0x1fb),settings[_0x15e5bb(0x1fb)]);if(_0x5a5892&&!_0x3ddf8b)initTelegram();if(_0x5a5892&&_0x3ddf8b)disableTelegram();getAllClients()[_0x15e5bb(0x1f5)](_0x20e7be=>{const _0x1fea4d=_0x15e5bb;getSocket(_0x20e7be['id'])[_0x1fea4d(0x3a2)](_0x1fea4d(0x1e8),{'access':{'allow':![],'reason':_0x1fea4d(0x262),'token':null}});}),_0x15f40f&&(await sleep(0xbb8),testMarketcapApi(_0x58a096[_0x15e5bb(0x1fb)]));}async function testMarketcapApi(_0x35a15c){const _0x454099=_0x540abc,_0x1235c1=[_0x454099(0x28e),_0x454099(0x222)];try{await axios[_0x454099(0x2be)](_0x454099(0x33a),{'headers':{'X-CMC_PRO_API_KEY':_0x35a15c},'params':{'symbol':_0x1235c1[_0x454099(0x1dd)]()}});}catch(_0x20bc4b){_0x20bc4b['toString']()[_0x454099(0x2c2)](_0x454099(0x2bc))?(io['to'](_0x454099(0x247))[_0x454099(0x3a2)](_0x454099(0x301),_0x454099(0x263)),logger[_0x454099(0x34b)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x454099(0x247))['emit'](_0x454099(0x301),_0x454099(0x23f)),logger[_0x454099(0x34b)](_0x454099(0x23f)),logger['debug'](_0x454099(0x33d),_0x20bc4b[_0x454099(0x1dd)]()+_0x454099(0x3bb)+_0x20bc4b[_0x454099(0x2cc)]));return;}logger[_0x454099(0x2f7)]('CoinMarketCap\x20API\x20key\x20validated');}function _0x2248(_0x238f4d,_0x40120a){const _0x4f14c0=_0x2daa();return _0x2248=function(_0x1a99d0,_0x3e60fe){_0x1a99d0=_0x1a99d0-0x1d7;let _0x2daa7c=_0x4f14c0[_0x1a99d0];return _0x2daa7c;},_0x2248(_0x238f4d,_0x40120a);}function updateSetting(_0x1b29e3,_0x217354){const _0x53f739=_0x540abc;dbSettings[_0x53f739(0x265)](_0x53f739(0x3c6)+_0x1b29e3,_0x217354)[_0x53f739(0x214)](),settings=getSettings(),io['to']('botmanager')[_0x53f739(0x3a2)]('settings',cleanSettings());}function storeSecure(_0x4267d2){const _0x5c0e71=_0x540abc;dbSecure[_0x5c0e71(0x2be)]('secure')[_0x5c0e71(0x379)](_0x4267d2)[_0x5c0e71(0x214)](),secure=_0x4267d2;}function addBlacklist(_0x4fa837){const _0x174b42=_0x540abc;cleanBlacklist();let _0x44229a;devices[_0x4fa837][_0x174b42(0x1ff)]?_0x44229a=Math['max'](devices[_0x4fa837]['telegramIpApproval'][_0x174b42(0x3e1)],loginExpiry):_0x44229a=loginExpiry,dbSecure[_0x174b42(0x2be)](_0x174b42(0x30f))[_0x174b42(0x379)]({'expiry':new Date()[_0x174b42(0x22b)]()+_0x44229a*0x3c*0x3e8,'token':devices[_0x4fa837]['access']['token']})[_0x174b42(0x214)](),blacklist=dbSecure[_0x174b42(0x2be)](_0x174b42(0x30f))[_0x174b42(0x326)]();}function cleanBlacklist(){const _0x5066a5=_0x540abc;let _0x20ca9b=dbSecure[_0x5066a5(0x2be)](_0x5066a5(0x30f))['cloneDeep']()[_0x5066a5(0x326)](),_0x373453=new Date()['getTime']();_0x20ca9b[_0x5066a5(0x1f5)](_0x5afd76=>{const _0x2470a8=_0x5066a5;_0x5afd76['expiry']<_0x373453&&dbSecure[_0x2470a8(0x2be)](_0x2470a8(0x30f))['remove']({'expiry':_0x5afd76[_0x2470a8(0x3e1)]})[_0x2470a8(0x214)]();});}function initStates(){const _0x4428af=_0x540abc;let _0x3f9590=getConfiguration();_0x3f9590[_0x4428af(0x1f5)](_0x472434=>{const _0x43ae18=_0x4428af;_0x472434[_0x43ae18(0x37c)]=_0x43ae18(0x3d4);}),storeConfiguration(_0x3f9590);}function onKeys(){const _0x213463=new RSA();return new Promise(_0x18173a=>{const _0xae7c65=_0x2248;_0x213463[_0xae7c65(0x340)]()[_0xae7c65(0x31d)](_0x123964=>{_0x18173a(_0x123964);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x23ff97=_0x540abc;let _0x100735=getSettings(),_0x248087=![];!_0x100735['hasOwnProperty'](_0x23ff97(0x257))&&(_0x100735[_0x23ff97(0x257)]=0x0,_0x248087=!![]);!_0x100735[_0x23ff97(0x323)](_0x23ff97(0x2bd))&&(_0x100735[_0x23ff97(0x2bd)]=0x0,_0x248087=!![]);!_0x100735[_0x23ff97(0x323)](_0x23ff97(0x2e7))&&(_0x100735[_0x23ff97(0x2e7)]='0.0.0',_0x248087=!![]);!_0x100735[_0x23ff97(0x323)](_0x23ff97(0x1d7))&&(_0x100735['onepagemode']=![],_0x248087=!![]);!_0x100735[_0x23ff97(0x323)](_0x23ff97(0x1fb))&&(_0x100735['marketcapApi']='',_0x248087=!![]);if(_0x248087)storeSettings(_0x100735);try{fs[_0x23ff97(0x33b)](configbackuppath,{'withFileTypes':!![]})[_0x23ff97(0x1f5)](_0x59f6a0=>{const _0x2e00fb=_0x23ff97;if(!_0x59f6a0['isDirectory']()){if(!_0x59f6a0['name'][_0x2e00fb(0x2a6)](_0x2e00fb(0x2e4)))fs[_0x2e00fb(0x287)](configbackuppath+_0x59f6a0[_0x2e00fb(0x27b)]);}else fs[_0x2e00fb(0x35a)](configbackuppath+_0x59f6a0[_0x2e00fb(0x27b)],{'recursive':!![]});});}catch(_0x4d4cac){logger[_0x23ff97(0x2f7)](_0x23ff97(0x299),_0x4d4cac);}}function storeConfiguration(_0x22bc2c){const _0x5cdf10=_0x540abc;dbConfig['get'](_0x5cdf10(0x2f5))[_0x5cdf10(0x2fa)]()[_0x5cdf10(0x214)](),dbConfig[_0x5cdf10(0x2be)]('bots')[_0x5cdf10(0x379)](..._0x22bc2c)[_0x5cdf10(0x214)](),config=_0x22bc2c;}async function resetPassword(){const _0x15a9d5=_0x540abc;if(tgBot&&settings[_0x15a9d5(0x313)]){const _0x1a688f=Markup['inlineKeyboard']([Markup[_0x15a9d5(0x36c)][_0x15a9d5(0x356)]('yes','resetpw_yes'),Markup[_0x15a9d5(0x36c)][_0x15a9d5(0x356)]('no',_0x15a9d5(0x30e))]);await sendTelegram(settings[_0x15a9d5(0x313)],_0x15a9d5(0x387),_0x1a688f),tgBot['action'](/resetpw_(.+)/,async _0x28bcda=>{const _0x1fe49d=_0x15a9d5,_0x1c9740=_0x28bcda[_0x1fe49d(0x264)][0x1];_0x28bcda[_0x1fe49d(0x2f3)]();if(_0x1c9740!='no'){const _0x334b6d=0xf,_0x5974ad=_0x1fe49d(0x1f9),_0x1d7b56=Array[_0x1fe49d(0x359)](crypto[_0x1fe49d(0x254)](new Uint32Array(_0x334b6d)))['map'](_0x33af15=>_0x5974ad[_0x33af15%_0x5974ad[_0x1fe49d(0x261)]])[_0x1fe49d(0x3a9)](''),_0x499518=bcrypt[_0x1fe49d(0x274)](_0x1d7b56,saltRounds);storeSettings({'bbPassword':_0x499518}),await sendTelegram(_0x28bcda[_0x1fe49d(0x368)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1d7b56,{'parse_mode':_0x1fe49d(0x330)});}else await sendTelegram(_0x28bcda[_0x1fe49d(0x368)]['id'],_0x1fe49d(0x1e2));});}}async function confirmRestore(_0x23ad14,_0x5d399e){const _0xe94544=_0x540abc;io['to'](_0xe94544(0x247))[_0xe94544(0x3a2)](_0xe94544(0x301),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0xe94544(0x1d8));if(tgBot&&settings[_0xe94544(0x313)]){const _0x3ea6d5=uuidRandom();tmpStorage[_0x3ea6d5]={'path':_0x23ad14,'filename':_0x5d399e};const _0x6f5cd6=Markup[_0xe94544(0x2b5)]([Markup[_0xe94544(0x36c)]['callback'](_0xe94544(0x37e),_0xe94544(0x1ee)+_0x3ea6d5),Markup[_0xe94544(0x36c)][_0xe94544(0x356)]('no',_0xe94544(0x2e5)+_0x3ea6d5)]);await sendTelegram(settings[_0xe94544(0x313)],_0xe94544(0x308),_0x6f5cd6),tgBot['action'](/restore_(.+)_(.+)/,async _0x45db3c=>{const _0x16ed2a=_0xe94544,_0x48008c=_0x45db3c[_0x16ed2a(0x264)][0x1],_0x2aaa78=_0x45db3c[_0x16ed2a(0x264)][0x2],{path:_0x24eab3,filename:_0x449373}=tmpStorage[_0x2aaa78];delete tmpStorage[_0x2aaa78],_0x45db3c['editMessageReplyMarkup'](),_0x48008c==_0x16ed2a(0x37e)?(logger['debug']('Restore\x20process\x20confirmed'),await sendTelegram(_0x45db3c[_0x16ed2a(0x368)]['id'],_0x16ed2a(0x21f),{'parse_mode':_0x16ed2a(0x330)}),unzipFile(_0x24eab3,_0x449373)):(logger[_0x16ed2a(0x2f7)]('Restore\x20process\x20aborted'),await sendTelegram(_0x45db3c['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0xf63f69=_0x540abc,_0x4f8ddd=new Date();return _0x4f8ddd['getFullYear']()+'/'+(_0x4f8ddd['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x4f8ddd[_0xf63f69(0x275)]()[_0xf63f69(0x1dd)]()['padStart'](0x2,'0')+'\x20'+_0x4f8ddd[_0xf63f69(0x360)]()[_0xf63f69(0x1dd)]()['padStart'](0x2,'0')+':'+_0x4f8ddd['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x4f8ddd['getSeconds']()[_0xf63f69(0x1dd)]()[_0xf63f69(0x1eb)](0x2,'0');}function getTimeStamp(){const _0xf4b588=_0x540abc,_0x5eeb14=shiftedTime();return _0x5eeb14[_0xf4b588(0x2e6)]()+'/'+(_0x5eeb14[_0xf4b588(0x3e5)]()+0x1)[_0xf4b588(0x1dd)]()[_0xf4b588(0x1eb)](0x2,'0')+'/'+_0x5eeb14[_0xf4b588(0x275)]()[_0xf4b588(0x1dd)]()['padStart'](0x2,'0')+'\x20'+_0x5eeb14[_0xf4b588(0x360)]()[_0xf4b588(0x1dd)]()[_0xf4b588(0x1eb)](0x2,'0')+':'+_0x5eeb14[_0xf4b588(0x260)]()[_0xf4b588(0x1dd)]()['padStart'](0x2,'0')+':'+_0x5eeb14[_0xf4b588(0x3af)]()[_0xf4b588(0x1dd)]()[_0xf4b588(0x1eb)](0x2,'0');}function getCleanTimeStamp(){const _0x2b945d=_0x540abc,_0x22404f=shiftedTime();return _0x22404f['getFullYear']()+(_0x22404f['getMonth']()+0x1)[_0x2b945d(0x1dd)]()[_0x2b945d(0x1eb)](0x2,'0')+_0x22404f[_0x2b945d(0x275)]()[_0x2b945d(0x1dd)]()[_0x2b945d(0x1eb)](0x2,'0')+'-'+_0x22404f[_0x2b945d(0x360)]()[_0x2b945d(0x1dd)]()[_0x2b945d(0x1eb)](0x2,'0')+_0x22404f[_0x2b945d(0x260)]()[_0x2b945d(0x1dd)]()['padStart'](0x2,'0')+_0x22404f[_0x2b945d(0x3af)]()[_0x2b945d(0x1dd)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x7e6524=_0x540abc,_0x2eb639=new Date();let _0x2547da=_0x2eb639;if(settings[_0x7e6524(0x2ed)]&&settings['timeshift']!==0x0)_0x2547da=fns[_0x7e6524(0x21d)](_0x2eb639,{'hours':settings[_0x7e6524(0x2ed)]});return _0x2547da;}async function startScheduler(){const _0x5df017=_0x540abc,_0x5a8cc9=new Date()[_0x5df017(0x294)](),_0x41ac5e=shiftedTime()[_0x5df017(0x360)]();_0x41ac5e==0x4&&backupConfigFiles(),_0x41ac5e==0x0&&rotateLogFiles(),_0x5a8cc9%0x6==0x0&&triggerAnalytics(),_0x5a8cc9%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x23f577){const _0x18b5cf=_0x540abc;logger[_0x18b5cf(0x2f7)](_0x18b5cf(0x26a)+_0x23f577);const _0x52ccc0=getBotsWithMode();_0x52ccc0['length']>0x0?confirmRestore(configbackuppath,_0x23f577):unzipFile(configbackuppath,_0x23f577);}async function getBackupFiles(_0x3a5110=null){const _0x4e06c1=_0x540abc;let _0x586075=[],_0x194097=fs[_0x4e06c1(0x33b)](configbackuppath,{'withFileTypes':!![]});_0x194097[_0x4e06c1(0x39a)]((_0x974b6a,_0x5ca835)=>_0x974b6a[_0x4e06c1(0x27b)]<_0x5ca835[_0x4e06c1(0x27b)]?0x1:_0x5ca835[_0x4e06c1(0x27b)]<_0x974b6a[_0x4e06c1(0x27b)]?-0x1:0x0),_0x194097['forEach'](_0x133bb4=>{const _0xa28d3d=_0x4e06c1;if(!_0x133bb4[_0xa28d3d(0x26b)]()&&_0x133bb4['name'][_0xa28d3d(0x2a6)](_0xa28d3d(0x2e4))&&_0x133bb4[_0xa28d3d(0x27b)][_0xa28d3d(0x3aa)]('.zip')){const _0xdc7296=formatDate(fs[_0xa28d3d(0x1f0)](configbackuppath+_0x133bb4[_0xa28d3d(0x27b)])[_0xa28d3d(0x2ad)]);_0x586075[_0xa28d3d(0x379)]({'name':_0x133bb4[_0xa28d3d(0x27b)],'mtime':_0xdc7296});}});if(_0x3a5110)io['to'](_0x3a5110)[_0x4e06c1(0x3a2)](_0x4e06c1(0x34c),_0x586075);else return _0x586075;}async function backupConfigFiles(){const _0x4cca6b=_0x540abc;await zipFiles(_0x4cca6b(0x1ef));const _0x25869=getCleanTimeStamp();fs[_0x4cca6b(0x1f4)](zippath+_0x4cca6b(0x237),configbackuppath+(_0x4cca6b(0x2e4)+_0x25869+_0x4cca6b(0x3b7)));let _0x1a0305=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1a0305['sort']((_0x418cdb,_0x4046cc)=>_0x418cdb[_0x4cca6b(0x27b)]<_0x4046cc['name']?0x1:_0x4046cc[_0x4cca6b(0x27b)]<_0x418cdb[_0x4cca6b(0x27b)]?-0x1:0x0),_0x1a0305[_0x4cca6b(0x261)]>maxBackups&&fs[_0x4cca6b(0x287)](configbackuppath+_0x1a0305[_0x1a0305['length']-0x1][_0x4cca6b(0x27b)]);}function rotateLogFiles(){const _0x315ec0=_0x540abc,_0xda8bbc=fs['statSync'](logspath+_0x315ec0(0x200)),_0xc3361d=_0xda8bbc[_0x315ec0(0x329)]/0x400;if(_0xc3361d>0x64){let _0x511893=fs[_0x315ec0(0x33b)](logspath,{'withFileTypes':!![]});_0x511893[_0x315ec0(0x39a)]((_0x2a2875,_0xad66f7)=>_0x2a2875['name']<_0xad66f7[_0x315ec0(0x27b)]?0x1:_0xad66f7['name']<_0x2a2875[_0x315ec0(0x27b)]?-0x1:0x0),_0x511893['forEach'](_0x35b484=>{const _0x284d16=_0x315ec0;if(_0x35b484[_0x284d16(0x27b)]==_0x284d16(0x253))fs[_0x284d16(0x1f4)](logspath+_0x35b484[_0x284d16(0x27b)],logspath+_0x284d16(0x3dd));if(_0x35b484[_0x284d16(0x27b)]==_0x284d16(0x22d))fs[_0x284d16(0x1f4)](logspath+_0x35b484[_0x284d16(0x27b)],logspath+_0x284d16(0x253));_0x35b484[_0x284d16(0x27b)]==_0x284d16(0x200)&&(fs[_0x284d16(0x1f4)](logspath+_0x35b484[_0x284d16(0x27b)],logspath+_0x284d16(0x22d)),fs[_0x284d16(0x324)](logspath+_0x35b484[_0x284d16(0x27b)],''));});}}async function zipFiles(_0x1bd39d){const _0x4b04ab=_0x540abc;let _0x5b2e38;if(_0x1bd39d==_0x4b04ab(0x325))_0x5b2e38=logspath;if(_0x1bd39d==_0x4b04ab(0x367))_0x5b2e38=configpath;if(_0x1bd39d==_0x4b04ab(0x1ef))_0x5b2e38=configpath;let _0x55595d=fs[_0x4b04ab(0x33b)](_0x5b2e38,{'withFileTypes':!![]});const _0x1e697d=new require(_0x4b04ab(0x2d8))();_0x55595d['forEach'](_0x30ad20=>{const _0xc50578=_0x4b04ab;if(!_0x30ad20[_0xc50578(0x26b)]()){let _0x842da9=fs[_0xc50578(0x2e0)](_0x5b2e38+_0x30ad20['name']);if(_0x1bd39d=='backup'){const _0x375ce9=/^bot-[0-9]{3}-config.json$/,_0x50f198=_0x375ce9[_0xc50578(0x21e)](_0x30ad20[_0xc50578(0x27b)]);if(_0x50f198){const _0x20b547=JSON[_0xc50578(0x2f9)](_0x842da9);if(_0x20b547[_0xc50578(0x2af)][0x0]){_0x20b547[_0xc50578(0x2af)][0x0][_0xc50578(0x2a3)]=_0xc50578(0x31e),_0x20b547[_0xc50578(0x2af)][0x0][_0xc50578(0x1ea)]=_0xc50578(0x31e);if(_0x20b547[_0xc50578(0x2af)][0x0]['apiPassword'])_0x20b547[_0xc50578(0x2af)][0x0][_0xc50578(0x20e)]=_0xc50578(0x31e);}_0x842da9=JSON['stringify'](_0x20b547,null,0x2);}if(_0x30ad20[_0xc50578(0x27b)]==_0xc50578(0x3d0)){const _0x1a071a=JSON[_0xc50578(0x2f9)](_0x842da9);if(_0x1a071a[_0xc50578(0x332)][_0xc50578(0x34a)])_0x1a071a[_0xc50578(0x332)]['loginRequired']=![];if(_0x1a071a['settings']['bbPassword'])_0x1a071a['settings']['bbPassword']=_0xc50578(0x31e);if(_0x1a071a['settings'][_0xc50578(0x2f6)])_0x1a071a[_0xc50578(0x332)]['telegramToken']=_0xc50578(0x31e);if(_0x1a071a[_0xc50578(0x332)][_0xc50578(0x313)])_0x1a071a[_0xc50578(0x332)][_0xc50578(0x313)]=null;if(_0x1a071a[_0xc50578(0x332)][_0xc50578(0x1fb)])_0x1a071a[_0xc50578(0x332)][_0xc50578(0x1fb)]='***';_0x842da9=JSON[_0xc50578(0x38d)](_0x1a071a,null,0x2);}if(_0x30ad20['name']!='bb-secure.json')_0x1e697d[_0xc50578(0x27c)](_0x30ad20['name'],_0x842da9);}else _0x1e697d[_0xc50578(0x27c)](_0x30ad20['name'],_0x842da9);}});const _0x2d69d5=_0x1e697d[_0x4b04ab(0x33c)]({'base64':![],'compression':_0x4b04ab(0x321)});fs[_0x4b04ab(0x324)](zippath+(_0x1bd39d+_0x4b04ab(0x3b7)),_0x2d69d5,'binary');}async function unzipFile(_0xd6f3c2,_0xb9bd9f){const _0x3d61a8=_0x540abc;fs[_0x3d61a8(0x33b)](configpath,{'withFileTypes':!![]})[_0x3d61a8(0x1f5)](_0x2f16cb=>{const _0x14e2ea=_0x3d61a8;if(!_0x2f16cb[_0x14e2ea(0x26b)]())fs[_0x14e2ea(0x35a)](configpath+_0x2f16cb[_0x14e2ea(0x27b)]);});const _0xfd8735=fs[_0x3d61a8(0x2e0)](_0xd6f3c2+_0xb9bd9f,'binary'),_0x4bd11d=new require('node-zip')(_0xfd8735,{'base64':![],'checkCRC32':!![]});Object[_0x3d61a8(0x292)](_0x4bd11d[_0x3d61a8(0x25e)])[_0x3d61a8(0x1f5)](_0x948604=>{const _0x975356=_0x3d61a8,_0x564f3a=_0x4bd11d[_0x975356(0x25e)][_0x948604];fs[_0x975356(0x324)](configpath+_0x564f3a[_0x975356(0x27b)],_0x564f3a[_0x975356(0x243)]);}),fs[_0x3d61a8(0x33b)](temppath,{'withFileTypes':!![]})['forEach'](_0x5e4ea8=>{const _0x3e055c=_0x3d61a8;if(!_0x5e4ea8['isDirectory']())fs[_0x3e055c(0x35a)](temppath+_0x5e4ea8[_0x3e055c(0x27b)]);}),logger[_0x3d61a8(0x2f7)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x3d61a8(0x35d)]({'restore':!![]},_0x3b39a0=>{});}async function getPublicIp(){const _0x47b58e=_0x540abc;try{const _0x22f40d=await axios[_0x47b58e(0x2be)]('https://api.ipify.org?format=json');publicip=_0x22f40d[_0x47b58e(0x211)]['ip'];}catch(_0x3e89f6){}}async function triggerAnalytics(){const _0x1e4c95=_0x540abc;if(!publicip)await getPublicIp();const _0x4250c2=getBotsWithMode();let _0x4df1af=0x0;_0x4250c2[_0x1e4c95(0x1f5)](_0x4ec763=>{const _0x1009e9=_0x1e4c95;if(_0x4ec763[_0x1009e9(0x1e8)]==='enabled')_0x4df1af++;});const _0x4884bc=getBotExchanges();mixpanel['track'](_0x1e4c95(0x278),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4250c2['length'],'numbotsenabled':_0x4df1af,'exchanges':_0x4884bc,'environment':environment});}async function getMessages(){const _0x4f86c7=_0x540abc,_0x201b05='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x217639=new GraphQLClient(_0x201b05),_0x9dd9fb={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x1da3d2=serverversion['split']('.'),_0x1c131d=_0x1da3d2[0x0]+'.'+_0x1da3d2[0x1],_0x4ef76b=Math['min'](settings[_0x4f86c7(0x257)],settings['lastmsgemitted']),_0x5038d={'last':parseInt(_0x4ef76b),'bbm':_0x1c131d},_0x2480f7=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x562aa6;try{_0x562aa6=await _0x217639['request'](_0x2480f7,_0x5038d,_0x9dd9fb);}catch(_0x40d441){}if(_0x562aa6&&_0x562aa6['messages']){let _0x3e0ca7=settings[_0x4f86c7(0x257)];newMessages=[];for(const _0x1433d2 of _0x562aa6[_0x4f86c7(0x286)]){newMessages[_0x4f86c7(0x379)](_0x1433d2);let _0x5897c1=![];_0x1433d2[_0x4f86c7(0x38c)]&&(updateSetting(_0x4f86c7(0x2e7),_0x1433d2[_0x4f86c7(0x38c)]),_0x5897c1=isNewerVersion(serverversion,_0x1433d2['bbvNew'])||serverversion==_0x1433d2[_0x4f86c7(0x38c)]);if(!_0x5897c1&&_0x1433d2[_0x4f86c7(0x3be)]>_0x3e0ca7){if(_0x1433d2['bbvReceive']===_0x4f86c7(0x382)||serverversion[_0x4f86c7(0x2a6)](_0x1433d2[_0x4f86c7(0x2e8)])){let _0x5f1494=''+_0x1433d2[_0x4f86c7(0x244)]+'\x0a\x0a'+_0x1433d2[_0x4f86c7(0x271)];const _0x5e4e1a=await sendTelegramMsg(toTelegramMarkdown(_0x5f1494),_0x4f86c7(0x279));if(_0x5e4e1a)_0x3e0ca7=_0x1433d2[_0x4f86c7(0x3be)];}}}updateAvailable=isNewerVersion(settings[_0x4f86c7(0x2e7)],serverversion),updateSetting(_0x4f86c7(0x257),_0x3e0ca7),emitMessages();}}function emitMessages(){const _0x4b9653=_0x540abc,_0x7c4732=settings[_0x4b9653(0x2bd)];let _0x179513=[];newMessages[_0x4b9653(0x1f5)](_0x241e9c=>{const _0x4d50d9=_0x4b9653;_0x241e9c[_0x4d50d9(0x3be)]>_0x7c4732&&_0x179513['push'](_0x241e9c);}),_0x179513[_0x4b9653(0x261)]>0x0&&getAllClients()[_0x4b9653(0x1f5)](_0x593fd5=>{const _0x3b0f66=_0x4b9653;getSocket(_0x593fd5['id'])[_0x3b0f66(0x3a2)]('message',_0x179513);});}function confirmMessage(_0x25d736){const _0x295d30=_0x540abc;updateSetting(_0x295d30(0x2bd),Number(_0x25d736));}function isNewerVersion(_0x5c9bce,_0x11cef4){const _0x29b7de=_0x540abc,_0x5efc44=_0x11cef4[_0x29b7de(0x36f)]('.'),_0x41d0bd=_0x5c9bce[_0x29b7de(0x36f)]('.');for(var _0x3ec9c4=0x0;_0x3ec9c4<_0x41d0bd[_0x29b7de(0x261)];_0x3ec9c4++){const _0x49f085=~~_0x41d0bd[_0x3ec9c4],_0x376609=~~_0x5efc44[_0x3ec9c4];if(_0x49f085>_0x376609)return!![];if(_0x49f085<_0x376609)return![];}return![];}function toTelegramMarkdown(_0x1429a8){const _0xb10054=_0x540abc,_0x26a71f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x25bb91=/\*{2}(.+?)\*{2}/gim;return _0x1429a8=_0x1429a8[_0xb10054(0x3a1)](_0x26a71f,'$1_$2_$3')[_0xb10054(0x3a1)](_0x25bb91,'*$1*'),_0x1429a8;}async function validateConfigFile(){const _0x16d5a0=_0x540abc,_0x56d901=dbConfig[_0x16d5a0(0x2be)](_0x16d5a0(0x2f5))[_0x16d5a0(0x3d2)]('botID')[_0x16d5a0(0x326)]()||[];if(_0x56d901[_0x16d5a0(0x261)]==0x0){let _0x828d1f=0x0,_0x219ed6=[];const _0x2a70dc=/^bot-([0-9]{3})-config.json$/,_0x30bdd6=fs[_0x16d5a0(0x33b)](configpath);_0x30bdd6['forEach'](_0x579e9a=>{const _0x47e879=_0x16d5a0,_0x71707a=_0x2a70dc['exec'](_0x579e9a);if(_0x71707a){const _0x203b12=_0x71707a[0x1];let _0x2eb688=getBotAttributes(_0x203b12);_0x219ed6[_0x47e879(0x379)]({'botID':_0x203b12,'botname':_0x2eb688['botname'],'status':_0x47e879(0x32a),'live':'stopped'}),_0x828d1f++;}}),_0x828d1f!=0x0&&(dbConfig[_0x16d5a0(0x2be)](_0x16d5a0(0x2f5))[_0x16d5a0(0x20d)](_0x219ed6)['write'](),config=_0x219ed6,restoredConfigFile=_0x828d1f);}}async function restoreConfigNotify(_0x1d4cc7){const _0x198c75=_0x540abc;let _0x1e2529;if(restoredConfigFile==0x1)_0x1e2529=_0x198c75(0x388);else _0x1e2529=_0x198c75(0x1f7);if(_0x1d4cc7)io['to'](_0x198c75(0x247))[_0x198c75(0x3a2)](_0x198c75(0x301),_0x1e2529);else{logger[_0x198c75(0x2dd)](_0x198c75(0x28d)),logger[_0x198c75(0x2dd)](_0x1e2529),logger[_0x198c75(0x2dd)](_0x198c75(0x28d)),logger[_0x198c75(0x2dd)]('');if(tgBot&&settings[_0x198c75(0x313)]&&settings[_0x198c75(0x395)]!='orders')await sendTelegram(settings[_0x198c75(0x313)],_0x198c75(0x327)+_0x1e2529);}}function validateCredentials(_0x4e230b,_0x178de7){const _0x3798ab=_0x540abc;if(_0x4e230b[_0x3798ab(0x3cd)]==settings[_0x3798ab(0x386)]&&bcrypt['compareSync'](_0x4e230b[_0x3798ab(0x2ec)],settings[_0x3798ab(0x317)])){if(settings[_0x3798ab(0x345)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x522447=generateLoginToken(_0x178de7);return{'allow':!![],'reason':_0x3798ab(0x36e),'token':_0x522447};}}else return{'allow':![],'reason':_0x3798ab(0x355),'token':null};}function refreshToken(_0x53fde1){const _0x767c12=generateLoginToken(_0x53fde1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x767c12};}function validateAccess(_0xc20d56,_0x4bfc6c,_0x394f22){const _0x74d300=_0x540abc,_0x1d2fa8=_0x394f22?_0x394f22:devices[_0x4bfc6c]['ip'];let _0x1e87f7;const _0x35d515=_0x20672f=>{const _0x238c4a=_0x2248;if(settings[_0x238c4a(0x34a)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x4bfc6c)){const _0xe0dbc0=generateLoginToken(_0x4bfc6c);return{'allow':!![],'reason':_0x238c4a(0x3d3),'token':_0xe0dbc0};}else return{'allow':![],'reason':_0x238c4a(0x344),'token':null};}else return _0x1e87f7=validToken(_0x20672f,_0x4bfc6c),_0x1e87f7[_0x238c4a(0x323)](_0x238c4a(0x1d8))?{'allow':!![],'reason':_0x238c4a(0x28b),'token':_0x20672f}:{'allow':![],'reason':_0x238c4a(0x344),'token':null};}else return{'allow':!![],'reason':_0x238c4a(0x353),'token':null};};if(settings['whitelistEnabled']){let _0x2f6343=[...settings[_0x74d300(0x331)],_0x74d300(0x290),_0x74d300(0x22a),_0x74d300(0x204)];if(_0x2f6343[_0x74d300(0x2c2)](_0x1d2fa8))return _0x35d515(_0xc20d56);else{_0x1e87f7=validToken(_0xc20d56,_0x4bfc6c);if(_0x1e87f7[_0x74d300(0x323)](_0x74d300(0x1d8)))return _0x35d515(_0xc20d56);else{if(telegramIpApproved(_0x4bfc6c)){const _0x3ad723=generateToken(_0x4bfc6c);return _0x1e87f7=_0x35d515(_0xc20d56),_0x1e87f7[_0x74d300(0x342)]?{'allow':!![],'reason':_0x74d300(0x363),'token':_0x3ad723}:_0x1e87f7;}else return settings[_0x74d300(0x399)]?{'allow':![],'reason':_0x74d300(0x3a3),'token':null}:{'allow':![],'reason':_0x74d300(0x28c),'token':null};}}}else return _0x35d515(_0xc20d56);}function timelyDecrypt(_0x5b827f,_0x41e207,_0x219221='@'){const _0x31a636=_0x540abc;if(_0x5b827f)try{const _0x469fc2=crypt['decrypt'](secure['privateKey'],_0x5b827f)[_0x31a636(0x271)],_0x26ffc3=_0x469fc2[_0x31a636(0x36f)](_0x219221)[0x0],_0x579033=_0x469fc2[_0x31a636(0x36f)](_0x219221)[0x1],_0xe033fb=new Date()['getTime']();if(_0x41e207){if(_0xe033fb-_0x579033<maxSecretAge*0x3e8)return _0x26ffc3;else return![];}else return _0x26ffc3;}catch(_0x35db3d){return![];}else return![];}const validToken=(_0xdb25a3,_0x16dc41)=>{const _0x2a30e2=_0x540abc,_0xf831b2=devices[_0x16dc41]['ip'];if(!_0xdb25a3)return{'error':_0x2a30e2(0x3b1)};for(let _0x426ee0 of blacklist){if(_0x426ee0[_0x2a30e2(0x376)]==_0xdb25a3)return{'error':_0x2a30e2(0x369)};}let _0x30b64c;try{_0x30b64c=jwt[_0x2a30e2(0x381)](_0xdb25a3,secure[_0x2a30e2(0x3b6)]+_0x16dc41);}catch{return{'error':_0x2a30e2(0x32f)};}if(!_0x30b64c[_0x2a30e2(0x323)]('clientip')&&!_0x30b64c['hasOwnProperty']('username')||!_0x30b64c[_0x2a30e2(0x323)](_0x2a30e2(0x250)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x30b64c[_0x2a30e2(0x323)](_0x2a30e2(0x3cd))&&_0x30b64c[_0x2a30e2(0x323)](_0x2a30e2(0x306))){const {clientip:_0x173c91}=_0x30b64c;return _0xf831b2==_0x173c91?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2a30e2(0x202)};}else{if(_0x30b64c[_0x2a30e2(0x323)](_0x2a30e2(0x3cd))&&_0x30b64c[_0x2a30e2(0x323)](_0x2a30e2(0x306))){const {username:_0x39a659,clientip:_0x4d7122}=_0x30b64c;return settings[_0x2a30e2(0x386)]==_0x39a659&&_0xf831b2==_0x4d7122?{'success':_0x2a30e2(0x219)}:{'error':_0x2a30e2(0x272)};}}},generateLoginToken=_0x31e71c=>{const _0x5b6b44=_0x540abc;if(_0x31e71c){const _0xc7b089=devices[_0x31e71c]['ip'];return jwt[_0x5b6b44(0x210)]({'username':settings[_0x5b6b44(0x386)],'clientip':_0xc7b089},secure[_0x5b6b44(0x3b6)]+_0x31e71c,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x2e9f5f=>{const _0x478eb8=_0x540abc;if(_0x2e9f5f){const _0x3d9270=devices[_0x2e9f5f]['ip'];return jwt[_0x478eb8(0x210)]({'clientip':_0x3d9270},secure[_0x478eb8(0x3b6)]+_0x2e9f5f,{'expiresIn':devices[_0x2e9f5f][_0x478eb8(0x1ff)][_0x478eb8(0x3e1)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x19bfae=>{const _0x38f539=_0x540abc;let _0x3577b6=![];return devices[_0x19bfae][_0x38f539(0x1ff)]&&devices[_0x19bfae][_0x38f539(0x1ff)][_0x38f539(0x3e1)]!=_0x38f539(0x314)&&(_0x3577b6=devices[_0x19bfae][_0x38f539(0x1ff)][_0x38f539(0x306)]==devices[_0x19bfae]['ip']&&new Date()[_0x38f539(0x22b)]()-devices[_0x19bfae][_0x38f539(0x1ff)][_0x38f539(0x291)]<devices[_0x19bfae][_0x38f539(0x1ff)][_0x38f539(0x3e1)]*0x3c*0x3e8),_0x3577b6;},telegram2FaApproved=_0x52694e=>{const _0x2f2c73=_0x540abc;let _0x5def0f=![];return devices[_0x52694e]['telegram2FaApproval']&&devices[_0x52694e]['telegram2FaApproval'][_0x2f2c73(0x3e1)]!=_0x2f2c73(0x314)&&(_0x5def0f=devices[_0x52694e]['telegram2FaApproval']['clientip']==devices[_0x52694e]['ip']&&new Date()[_0x2f2c73(0x22b)]()-devices[_0x52694e][_0x2f2c73(0x348)]['timestamp']<devices[_0x52694e][_0x2f2c73(0x348)]['expiry']*0x3c*0x3e8),_0x5def0f;},normalizeIP=_0x4a348=>{const _0x57a4b2=_0x540abc;let _0x4fb254=null,_0x2bdaad=null;if(ipaddr[_0x57a4b2(0x1e6)](_0x4a348)){const _0x2fbfb3=ipaddr[_0x57a4b2(0x2f9)](_0x4a348);_0x2fbfb3[_0x57a4b2(0x25a)]()==='ipv6'?(_0x2fbfb3[_0x57a4b2(0x32b)]()&&(_0x4fb254=_0x2fbfb3[_0x57a4b2(0x3ba)]()[_0x57a4b2(0x1dd)]()),_0x2bdaad=_0x2fbfb3[_0x57a4b2(0x1dd)]()):(_0x4fb254=_0x2fbfb3[_0x57a4b2(0x1dd)](),_0x2bdaad=_0x2fbfb3[_0x57a4b2(0x1e3)]()[_0x57a4b2(0x1dd)]());}return{'show':_0x4fb254?_0x4fb254:_0x2bdaad,'store':_0x2bdaad};};function formatDate(_0x494367){const _0x2bfeb1=_0x540abc;return _0x494367[_0x2bfeb1(0x2e6)]()+'/'+(_0x494367[_0x2bfeb1(0x3e5)]()+0x1)[_0x2bfeb1(0x1dd)]()[_0x2bfeb1(0x1eb)](0x2,'0')+'/'+_0x494367[_0x2bfeb1(0x275)]()[_0x2bfeb1(0x1dd)]()[_0x2bfeb1(0x1eb)](0x2,'0')+'\x20'+_0x494367[_0x2bfeb1(0x360)]()[_0x2bfeb1(0x1dd)]()[_0x2bfeb1(0x1eb)](0x2,'0')+':'+_0x494367[_0x2bfeb1(0x260)]()['toString']()[_0x2bfeb1(0x1eb)](0x2,'0')+':'+_0x494367[_0x2bfeb1(0x3af)]()[_0x2bfeb1(0x1dd)]()['padStart'](0x2,'0');}function sleep(_0x38ba04){return new Promise(_0x478b60=>setTimeout(_0x478b60,_0x38ba04));}