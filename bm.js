const _0x31d996=_0x2805;(function(_0x297161,_0x5193cc){const _0x1fc021=_0x2805,_0xd85912=_0x297161();while(!![]){try{const _0xccf691=-parseInt(_0x1fc021(0x224))/0x1+-parseInt(_0x1fc021(0x2ee))/0x2+-parseInt(_0x1fc021(0x1da))/0x3*(parseInt(_0x1fc021(0x1b5))/0x4)+parseInt(_0x1fc021(0x316))/0x5+parseInt(_0x1fc021(0x1fc))/0x6*(-parseInt(_0x1fc021(0x342))/0x7)+-parseInt(_0x1fc021(0x2d7))/0x8*(-parseInt(_0x1fc021(0x1e4))/0x9)+parseInt(_0x1fc021(0x34b))/0xa;if(_0xccf691===_0x5193cc)break;else _0xd85912['push'](_0xd85912['shift']());}catch(_0x5454c2){_0xd85912['push'](_0xd85912['shift']());}}}(_0x59b5,0x82ecf));const _0x86e510=function(){let _0x3a3759=!![];return function(_0x4c6f50,_0x17ba50){const _0x957ff7=_0x3a3759?function(){if(_0x17ba50){const _0x573ccf=_0x17ba50['apply'](_0x4c6f50,arguments);return _0x17ba50=null,_0x573ccf;}}:function(){};return _0x3a3759=![],_0x957ff7;};}(),_0xbf309e=_0x86e510(this,function(){const _0x5c423a=_0x2805;return _0xbf309e[_0x5c423a(0x258)]()[_0x5c423a(0x369)](_0x5c423a(0x2f0))[_0x5c423a(0x258)]()[_0x5c423a(0x23d)](_0xbf309e)['search'](_0x5c423a(0x2f0));});_0xbf309e();'use strict';process['env'][_0x31d996(0x204)]=0x1;const childProcess=require(_0x31d996(0x2f2)),fs=require('fs'),fns=require(_0x31d996(0x235)),low=require(_0x31d996(0x273)),FileSync=require(_0x31d996(0x1ea)),path=require(_0x31d996(0x35a)),crypto=require(_0x31d996(0x1a1)),Crypt=require(_0x31d996(0x2ff))['Crypt'],RSA=require(_0x31d996(0x2ff))['RSA'],bcrypt=require(_0x31d996(0x1dc)),jwt=require('jsonwebtoken'),ipaddr=require(_0x31d996(0x297)),argv=require(_0x31d996(0x2a6))(process['argv'][_0x31d996(0x231)](0x2))[_0x31d996(0x1d2)],uuidRandom=require('uuid-random'),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x31d996(0x206)),{networkInterfaces}=require('os'),PORT=argv[_0x31d996(0x27b)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x31d996(0x1d5)](_0x31d996(0x237)+PORT+_0x31d996(0x1ec)),process[_0x31d996(0x356)](0x1));const HOST=argv[_0x31d996(0x1c9)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x31d996(0x31c)],environment=require(_0x31d996(0x295))[_0x31d996(0x330)]||_0x31d996(0x270);let bbpath='bb/',bbpath2='';const botfile=_0x31d996(0x1f7),configfile='bb-config.json',settingsfile=_0x31d996(0x1cd),securefile=_0x31d996(0x1b1),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x31d996(0x200)),configpath=userID?bbpath+_0x31d996(0x1c2)+userID+'/':bbpath+_0x31d996(0x1c2),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x31d996(0x1c1),zippath=userID?bbpath+_0x31d996(0x35f)+userID+'/':bbpath+_0x31d996(0x35f),loggerfile=fs['createWriteStream'](logspath+_0x31d996(0x2b1),{'flags':'a'}),temppath=userID?bbpath+_0x31d996(0x2df)+userID+'/':bbpath+_0x31d996(0x2df);!fs[_0x31d996(0x2f9)](configpath)&&fs[_0x31d996(0x254)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x31d996(0x254)](configbackuppath);!fs[_0x31d996(0x2f9)](logspath)&&fs[_0x31d996(0x254)](logspath);!fs[_0x31d996(0x2f9)](zippath)&&fs[_0x31d996(0x254)](zippath);!fs[_0x31d996(0x2f9)](temppath)&&fs[_0x31d996(0x254)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x31d996(0x203)]({'bots':[]})[_0x31d996(0x20a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x31d996(0x240),'onepagemode':![]}})[_0x31d996(0x20a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();function _0x59b5(){const _0x4903ee=['live','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','2FA\x20login\x20required','telegrammsg','value','track','toggleBotMode','latestversion','bbPassword','\x20to\x20','reinstall','data','./version.json','/:bot/portfolio','ipaddr.js','warning','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','then','inherit','copyFileSync','Access\x20enabled\x20for\x20','settings.','new','orders','temporary\x20access\x20timeout','allow','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','alias','chat','yargs/yargs','lastmsgemitted','backup-full@','padStart','store','format','telegramToken','loginRequired','Unauthorized\x20attempt\x20to\x20get\x20messages','privateKey','min','/output-000.log','files','login\x20required','range','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','success','updatebotmanager','/:bot/history','15\x20min','output-003.log','disconnect','status','api-eu.mixpanel.com',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','sockets','get-portfolio','connection','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Server','stringify','accept','HTML','deleteHistoryAlerts','filter','\x1b[35m','logout','Token\x20blacklisted','keys','Disabled\x20Bot\x20','stop','\x20(1)','sortBy','place-order','build2','login\x20token\x20generated','name','/:bot','socket.io','176vOeFmZ','sendPortfolioTelegram','</b>\x20?','Notifications\x20enabled','SIGINT','secure','createServer','getHours','temp/','Starting\x20bot\x20|\x20Bot\x20','-config.json','All','_data','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','referer','mode','backup-full','getPortfolio','Logged\x20out\x20user\x20...','You\x20can\x20use\x20the\x20following\x20commands:\x0a','file','f2aRequired','exp','2133670chAGRp','toIPv4MappedAddress','(((.+)+)+)+$','confirm-message','child_process','address','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','timeshift','botmanager','reason','existsSync','socket','args','apiSecret','settings','https://api.ipify.org?format=json','hybrid-crypto-js','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','debug','/:bot/performance','error','restore-backup-file','access','all','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','send','messages','find','show','telegram2FaApproval','clientip','***','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Invalid\x20username\x20or\x20IP\x20address','Restore\x20backup\x20file\x20','token','/status\x20-\x20show\x20bot(s)\x20status\x0a','2985640JgCzIK','logs','params','User\x20has\x20been\x20validated','-performance.json','/enable\x20-\x20enable\x20notifications\x0a','node','split','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','DEFLATE','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','toggle-bot-mode','/on\x20-\x20start\x20bot(s)\x0a','running','enabled','/:bot/configuration','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','\x20only\x0a','store-configuration','sha256','get-backup-files','connected','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','removeListener','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','environment','resetHistory','bot','File\x20uploaded','2FA\x20login\x20token\x20generated','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Network\x20Interfaces:','logged\x20out','bbUsername','statSync','mtime','output-001.log','removeAllListeners','new-disabled','username','fork','map','parse','469AUFseQ','login','uuid','telegramUsername','get-messages',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','string','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','from','25812080HqvXMv','getStartingBalances','timestamp','Unauthorized\x20attempt\x20to\x20show\x20configuration','storeConfiguration','notification','blacklist','Bot\x20Mgr\x20>\x20','readdirSync','rmSync','\x20|\x20user:\x20...','exit','forEach','decrypt','add-bot','path','output-000.log','sort','backup','Unauthorized\x20attempt\x20to\x20log\x20out','zip/','password','\x20|\x20','get','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','placeOrder','No\x20bots\x20running\x20right\x20now','reset-history','1000','download','search','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getMonth','replace','getFullYear','getDate','::ffff:127.0.0.1','encryptedUuid','botID','sendMessage','delete-alerts','stopped','test','telegram','stopPolling','\x20minutes','generate','SIGTERM','catch','show-config','bot-','userid','crypto','Unauthorized\x20attempt\x20to\x20store\x20configuration','No\x20authentication\x20token','binary','Starting\x20Balance\x20Bot\x20reinstallation','temporary\x20access\x20not\x20allowed','getSeconds','bots','Restoring\x20bot(s)\x20from\x20backup','telegramEvents','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','temporary\x20access\x20rejected','simple','Enabled\x20Bot\x20','All\x20bots','Session\x20expired\x20for\x20user\x20...','bb-secure.json','internal','Unauthorized\x20attempt\x20to\x20add\x20bot','\x1b[0m','216IfrWie','toIPv4Address','pidRefreshToken','started','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20delete\x20alerts','callback_query','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','Alerts','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','writeFileSync','logs/','config/','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Notifications\x20disabled','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','ipc','reject','invalid\x20credentials','host','login\x20not\x20required','remoteAddress','onepagemode','bb-settings.json','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20get\x20events','node-zip','isDirectory','argv','IPv4','Orders','log','Unauthorized\x20attempt\x20to\x20delete\x20bot','hex','answerCallbackQuery','temporaryAccessAllowed','30657CEzwiX','reload','bcryptjs','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','function','backup-files','headless','getMinutes','assign','bbvReceive','66870XnxWYm','6b67f3d61ee94b8f5c80b4affef4c4d9','restart','Invalid\x20authentication\x20token\x20(1)','number','type','lowdb/adapters/FileSync','Error\x20removing\x20old\x20backup\x20files:',',\x20must\x20be\x20a\x204\x20digit\x20number','exec','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration',':\x20Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','\x20|\x20client:\x20...','use','Unauthorized\x20attempt\x20to\x20download\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','sendFile','push','bot.js','store-fiat','server','publicKey','telegramIpApproval','51336KeyORp','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Invalid\x20Telegram\x20token','order','clients','Backup\x20file\x20uploaded','/disable\x20-\x20disable\x20notifications\x0a','defaults','NTBA_FIX_319','tkn','express-fileupload','showname','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Restarting\x20Bot\x20','write','store-settings','full','#RES#\x20if\x20running\x20on\x20server','kind','output-002.log','<b>Balance\x20Bot\x20Status:</b>\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','whitelistEnabled','Bot\x20','Setting\x20access:\x20','auto','Backup\x20file\x20unzipped\x20and\x20stored','backupfile','remove','-results.json','/:bot/support','listen','polling_error','http','-----------------------------------------------------------------------------------','Invalid\x20IP\x20address','\x1b[36m','apiPassword','bbvNew','delete-bot','613612aBPDiR','::1','includes','\x1b[34m','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20update\x20bot','Starting\x20new\x20bot\x20|\x20Bot\x20','*$1*','Error\x20while\x20deleting\x20config\x20files:\x20','/restart\x20-\x20restart\x20bot(s)\x0a','5\x20min','\x20(2)','reinstall-bb','slice','telegramChatId','Unauthorized\x20attempt\x20to\x20confirm\x20message','readFileSync','date-fns','update-bb','Error:\x20Invalid\x20argument\x20','showConfig','entries','Restore\x20process\x20aborted','isIPv4MappedAddress','yes','constructor','backup-full.zip','initclient','0.0.0','add','index.html','hashSync','hasOwnProperty','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','length','getTime','/upload-backup','-events.json','\x20>\x20','(staging)','join','Idling\x20bot\x20\x20\x20|\x20Bot\x20','\x1b[33m','.zip','secret','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','[ip-address]','alerts','mkdirSync','lastmsgtelegram','emit','update','toString','sign','event','2FA','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Markdown','404\x20Not\x20Found','headers','kill','whitelist','family','RSA-OAEP','express','\x20mode','/update\x20-\x20update\x20Balance\x20Bot\x0a','onText','access\x20timeout','telegramEnabled','build','temporary\x20token\x20generated','Failed\x20to\x20download\x20','#RES#\x20if\x20running\x20locally\x0a','isValid','2FA\x20required','production','match','expiry','lowdb','apiKey','cancel-loading','version.json','Logged\x20in\x20user\x20...','startsWith','/metrics\x20-\x20show\x20bot\x20performance\x0a','All\x20bots\x20running\x20right\x20now','port','************','Invalid\x20authentication\x20token\x20(2)','compareSync','pidExpireLogin','unlinkSync','once','botname','disabled','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','message','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','manual','static'];_0x59b5=function(){return _0x4903ee;};return _0x59b5();}let crypt=new Crypt({'md':_0x31d996(0x32a),'rsaStandard':_0x31d996(0x263)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x31d996(0x1e5),{'host':_0x31d996(0x2bd)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x31d996(0x2ac)]&&settings[_0x31d996(0x2ac)]!=''&&settings[_0x31d996(0x345)]&&settings[_0x31d996(0x345)]!='')initTelegram();const parseColor=(_0x47206c,_0x167f68)=>{const _0x5a94c0=_0x31d996,_0x12ec4a=/#[A-Z]{3}#/g;if(typeof _0x47206c==_0x5a94c0(0x348)){!_0x167f68?_0x47206c=_0x47206c['replace'](_0x12ec4a,''):(_0x47206c=_0x47206c['replace'](/#BLU#/g,_0x5a94c0(0x227)),_0x47206c=_0x47206c[_0x5a94c0(0x36c)](/#RED#/g,'\x1b[31m'),_0x47206c=_0x47206c['replace'](/#YEL#/g,_0x5a94c0(0x24e)),_0x47206c=_0x47206c[_0x5a94c0(0x36c)](/#MAG#/g,_0x5a94c0(0x2c9)),_0x47206c=_0x47206c['replace'](/#CYA#/g,_0x5a94c0(0x220)),_0x47206c=_0x47206c[_0x5a94c0(0x36c)](/#RES#/g,_0x5a94c0(0x1b4)));;}return _0x47206c;},logger={'screen':_0x1e64dd=>{const _0x21125d=_0x31d996;console[_0x21125d(0x1d5)](parseColor(_0x1e64dd,!![]));},'simple':_0x38e665=>{const _0x2718bb=_0x31d996;console[_0x2718bb(0x1d5)](parseColor(_0x38e665,!![])),loggerfile[_0x2718bb(0x20a)](util['format'](parseColor(_0x38e665,![]))+'\x0a');},'full':async _0x2c56c4=>{const _0x2e418e=_0x31d996,_0x160056=getTimeStamp()+_0x2e418e(0x1ef)+_0x2c56c4;console['log'](parseColor(_0x160056,!![])),loggerfile['write'](util['format'](parseColor(_0x160056,![]))+'\x0a');if(tgBot&&settings[_0x2e418e(0x232)]&&settings[_0x2e418e(0x1aa)]!='orders')await tgBot[_0x2e418e(0x194)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x2c56c4,![]))[_0x2e418e(0x19d)](_0x3c2438=>{telegramError(_0x3c2438);});},'debug':async(_0xbe698,_0x26ec98='')=>{const _0x401982=_0x31d996,_0x393920=getTimeStamp()+_0x401982(0x347)+_0xbe698;if(debugging)console[_0x401982(0x1d5)](parseColor(_0x393920,!![]));loggerfile['write'](util[_0x401982(0x2ab)](parseColor(_0x393920,![]))+'\x0a');if(_0x26ec98){if(debugging)console[_0x401982(0x1d5)](_0x26ec98);loggerfile['write'](util[_0x401982(0x2ab)](_0x26ec98)+'\x0a');}}};process['on']('uncaughtException',function(_0x1fbba5){const _0x1b4bbb=_0x31d996;logger[_0x1b4bbb(0x1ad)](_0x1fbba5);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x31d996(0x276))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;function _0x2805(_0x58c17f,_0x227c2f){const _0x1b4f47=_0x59b5();return _0x2805=function(_0xbf309e,_0x86e510){_0xbf309e=_0xbf309e-0x18f;let _0x59b5d6=_0x1b4f47[_0xbf309e];return _0x59b5d6;},_0x2805(_0x58c17f,_0x227c2f);}let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x31d996(0x264)),app=express(),http=require(_0x31d996(0x21d))[_0x31d996(0x2dd)](app);app[_0x31d996(0x1f2)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x26a3e3,_0x2e9602)=>{const _0x51fbb3=_0x31d996,_0x2c82e6=_0x26a3e3[_0x51fbb3(0x318)][_0x51fbb3(0x1e9)],_0x5a3827=getClientsWithBotID(_0x51fbb3(0x2f7)),_0x4e892a=_0x26a3e3[_0x51fbb3(0x25f)][_0x51fbb3(0x344)],_0x4e1b93=timelyDecrypt(_0x4e892a,![]),_0x195296=_0x5a3827[_0x51fbb3(0x30c)](_0x1ae21c=>_0x1ae21c[_0x51fbb3(0x344)]==_0x4e1b93);if(_0x195296){const _0x2f893a=normalizeIP(_0x26a3e3['socket'][_0x51fbb3(0x1cb)])[_0x51fbb3(0x2aa)],_0x585fea=_0x26a3e3[_0x51fbb3(0x25f)][_0x51fbb3(0x205)];if(validateAccess(_0x585fea,_0x4e1b93,_0x2f893a)[_0x51fbb3(0x2a2)])_0x2c82e6==_0x51fbb3(0x35d)&&await backupConfigFiles(),await zipFiles(_0x2c82e6),_0x2e9602[_0x51fbb3(0x368)](zippath+(_0x2c82e6+'.zip'),_0x5f272f=>{const _0x4bbf14=_0x51fbb3;_0x5f272f&&(logger[_0x4bbf14(0x20c)](_0x4bbf14(0x26c)+_0x2c82e6),logger[_0x4bbf14(0x1ad)](_0x5f272f));});else logger['full'](_0x51fbb3(0x1f3)+_0x2c82e6+_0x51fbb3(0x2cf));}else logger[_0x51fbb3(0x20c)](_0x51fbb3(0x1f3)+_0x2c82e6+_0x51fbb3(0x22f));}),app['post'](_0x31d996(0x248),async(_0x31227a,_0xafdd05)=>{const _0x18b900=_0x31d996,_0x5e43a8=getClientsWithBotID(_0x18b900(0x2f7)),_0x340c11=_0x31227a[_0x18b900(0x25f)][_0x18b900(0x344)],_0x3c01be=timelyDecrypt(_0x340c11,![]),_0x37f102=_0x5e43a8[_0x18b900(0x30c)](_0x496799=>_0x496799['uuid']==_0x3c01be);logger['debug'](_0x18b900(0x201));if(_0x37f102){const _0x4d5fdf=normalizeIP(_0x31227a[_0x18b900(0x2fa)][_0x18b900(0x1cb)])[_0x18b900(0x2aa)],_0x5a3af6=_0x31227a[_0x18b900(0x25f)][_0x18b900(0x205)];if(validateAccess(_0x5a3af6,_0x3c01be,_0x4d5fdf)[_0x18b900(0x2a2)]){if(_0x31227a[_0x18b900(0x2b2)]){const _0x2202ee=_0x31227a[_0x18b900(0x2b2)][_0x18b900(0x217)];await _0x2202ee['mv'](temppath+_0x2202ee[_0x18b900(0x2d4)]),_0xafdd05[_0x18b900(0x30a)]({'status':!![],'message':_0x18b900(0x333)});const _0x432c59=getBotsWithMode();_0x432c59[_0x18b900(0x246)]>0x0?confirmRestore(temppath,_0x2202ee[_0x18b900(0x2d4)]):unzipFile(temppath,_0x2202ee[_0x18b900(0x2d4)]);}}else logger[_0x18b900(0x20c)](_0x18b900(0x1ab));}else logger[_0x18b900(0x20c)](_0x18b900(0x299));}),app['use'](express[_0x31d996(0x288)](path[_0x31d996(0x24c)](__dirname,bbpath2,_0x31d996(0x2d2)))),app[_0x31d996(0x1f2)](express[_0x31d996(0x288)](path[_0x31d996(0x24c)](__dirname,bbpath2,_0x31d996(0x26a)))),app[_0x31d996(0x362)]('/',function(_0x5e8ba1,_0x587ca3){const _0x53fe78=_0x31d996;_0x587ca3[_0x53fe78(0x1f5)](path['join'](__dirname,bbpath2,'build2',_0x53fe78(0x242)));}),app['get'](_0x31d996(0x2d5),function(_0x54be1f,_0x3ff6a8){const _0x43b8b0=_0x31d996;_0x3ff6a8['sendFile'](path[_0x43b8b0(0x24c)](__dirname,bbpath2,_0x43b8b0(0x26a),_0x43b8b0(0x242)));}),app[_0x31d996(0x362)](_0x31d996(0x296),(_0xd185ad,_0x23b620)=>{const _0x27ceca=_0x31d996;_0x23b620[_0x27ceca(0x1f5)](path[_0x27ceca(0x24c)](__dirname,bbpath2,_0x27ceca(0x26a),_0x27ceca(0x242)));}),app[_0x31d996(0x362)](_0x31d996(0x304),(_0x182199,_0x521dd7)=>{const _0x53a508=_0x31d996;_0x521dd7[_0x53a508(0x1f5)](path[_0x53a508(0x24c)](__dirname,bbpath2,_0x53a508(0x26a),_0x53a508(0x242)));}),app[_0x31d996(0x362)]('/:bot/coins',(_0x40d12c,_0x3e1234)=>{const _0x425775=_0x31d996;_0x3e1234[_0x425775(0x1f5)](path[_0x425775(0x24c)](__dirname,bbpath2,_0x425775(0x26a),_0x425775(0x242)));}),app[_0x31d996(0x362)](_0x31d996(0x2b8),(_0x17fbf8,_0x229444)=>{const _0x251ff1=_0x31d996;_0x229444[_0x251ff1(0x1f5)](path[_0x251ff1(0x24c)](__dirname,bbpath2,'build',_0x251ff1(0x242)));}),app['get'](_0x31d996(0x326),(_0x400327,_0x32a300)=>{const _0x52a345=_0x31d996;_0x32a300['sendFile'](path[_0x52a345(0x24c)](__dirname,bbpath2,_0x52a345(0x26a),_0x52a345(0x242)));}),app[_0x31d996(0x362)](_0x31d996(0x21a),(_0x465529,_0x55ca70)=>{const _0x149863=_0x31d996;_0x55ca70[_0x149863(0x1f5)](path[_0x149863(0x24c)](__dirname,bbpath2,'build',_0x149863(0x242)));});if(HOST)http[_0x31d996(0x21b)](PORT,HOST);else http[_0x31d996(0x21b)](PORT);const io=require(_0x31d996(0x2d6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2f1e8a=_0x31d996;let _0x37506f=_0x2f1e8a(0x252);const _0x3b93af=networkInterfaces(),_0x45d595={};for(const _0x5620be of Object[_0x2f1e8a(0x2cc)](_0x3b93af)){for(const _0x520281 of _0x3b93af[_0x5620be]){if((_0x520281[_0x2f1e8a(0x262)]==_0x2f1e8a(0x1d3)||_0x520281[_0x2f1e8a(0x262)]==0x4)&&!_0x520281[_0x2f1e8a(0x1b2)]){const _0x269968=ipaddr[_0x2f1e8a(0x341)](_0x520281[_0x2f1e8a(0x2f3)])[_0x2f1e8a(0x2b4)]();_0x269968!='private'&&(!_0x45d595[_0x5620be]&&(_0x45d595[_0x5620be]=[]),_0x45d595[_0x5620be]['push'](_0x520281[_0x2f1e8a(0x2f3)]),_0x37506f=_0x520281['address']);}}}return{'serverip':_0x37506f,'netinterfaces':_0x45d595};}async function startServer(){const _0x165d92=_0x31d996,{serverip:_0x296503,netinterfaces:_0x1ecdc6}=getServerIP();logger[_0x165d92(0x1ad)](''),logger[_0x165d92(0x1ad)](_0x165d92(0x21e)),await logger[_0x165d92(0x20c)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment=='staging'?_0x165d92(0x24b):'')+'\x0a'+(_0x165d92(0x1c5)+PORT+_0x165d92(0x26d))+('=>\x20Go\x20to\x20#CYA#http://'+_0x296503+':'+PORT+_0x165d92(0x20d))),logger[_0x165d92(0x1ad)](_0x165d92(0x21e));if(config['length']!=0x0)for(const _0x49febf of config){if(_0x49febf[_0x165d92(0x2bc)]=='enabled'||_0x49febf['status']==_0x165d92(0x29f))await logger[_0x165d92(0x20c)](_0x165d92(0x2e0)+_0x49febf[_0x165d92(0x193)]+_0x165d92(0x361)+_0x49febf[_0x165d92(0x282)]),startBot([_0x49febf[_0x165d92(0x193)],userID],{'cwd':bbpath},function(_0x5f369c){const _0x519d56=_0x165d92;if(_0x5f369c)logger[_0x519d56(0x20c)](_0x5f369c);});else(_0x49febf[_0x165d92(0x2bc)]==_0x165d92(0x283)||_0x49febf['status']==_0x165d92(0x33d))&&await logger['full'](_0x165d92(0x24d)+_0x49febf[_0x165d92(0x193)]+_0x165d92(0x361)+_0x49febf[_0x165d92(0x282)]);}else!newBot&&logger[_0x165d92(0x1ad)](_0x165d92(0x25c));if(newBot)addBot();logger[_0x165d92(0x1ad)]('-----------------------------------------------------------------------------------'),logger[_0x165d92(0x1ad)](''),await logger[_0x165d92(0x303)]('Node.js\x20v'+nodeversion),await logger[_0x165d92(0x303)](_0x165d92(0x336),_0x1ecdc6);}function startSocket(){const _0x37fb8f=_0x31d996;io['on'](_0x37fb8f(0x2c1),_0x28eece=>{const _0x188b1b=_0x37fb8f;let _0x5ac4bd,_0x1375b7,_0x5e0d72,_0x39975f,_0x1b059e;const _0x267664=_0x28eece['handshake'][_0x188b1b(0x25f)][_0x188b1b(0x2e5)];_0x1375b7=_0x267664[_0x188b1b(0x271)](/bot[0-9]{3}/);if(_0x1375b7)_0x5e0d72=_0x1375b7[0x0][_0x188b1b(0x271)](/[0-9]{3}/);if(_0x5e0d72)_0x5ac4bd=_0x5e0d72[0x0];else _0x5ac4bd=_0x188b1b(0x2f7);const _0x2fabb0=_0x28eece['handshake']['auth'][_0x188b1b(0x192)];if(!_0x2fabb0)_0x28eece[_0x188b1b(0x256)]('status',{'publicKey':secure['publicKey']});else{_0x39975f=timelyDecrypt(_0x2fabb0,![]);if(!_0x39975f)_0x28eece['emit']('status',{'publicKey':secure[_0x188b1b(0x1fa)]});else{_0x1b059e=normalizeIP(_0x28eece['conn']['remoteAddress'])[_0x188b1b(0x2aa)];if(!devices[_0x39975f])devices[_0x39975f]={'uuid':_0x39975f,'access':{'token':null}};devices[_0x39975f]['ip']=_0x1b059e;const _0x40ce65=addClient(_0x28eece['id'],_0x39975f,_0x5ac4bd);setAccess(_0x40ce65),emitMessages(),_0x28eece['on'](_0x188b1b(0x343),_0x5bce17=>{const _0x5a9df7=_0x188b1b,_0x47a72d=timelyDecrypt(_0x5bce17[_0x5a9df7(0x360)]);if(_0x47a72d){_0x5bce17={'username':_0x5bce17[_0x5a9df7(0x33e)],'password':_0x47a72d},devices[_0x39975f][_0x5a9df7(0x307)]=validateCredentials(_0x5bce17,_0x39975f);if(devices[_0x39975f][_0x5a9df7(0x307)][_0x5a9df7(0x2a2)]==![]&&devices[_0x39975f][_0x5a9df7(0x307)]['reason']==_0x5a9df7(0x28b))_0x28eece[_0x5a9df7(0x256)](_0x5a9df7(0x2bc),{'access':devices[_0x39975f]['access']}),loginAccess2FA(_0x39975f,_0x1b059e);else{if(devices[_0x39975f][_0x5a9df7(0x307)][_0x5a9df7(0x2a2)]==![]&&devices[_0x39975f][_0x5a9df7(0x307)][_0x5a9df7(0x2f8)]==_0x5a9df7(0x1c8))_0x28eece[_0x5a9df7(0x256)]('status',{'access':devices[_0x39975f][_0x5a9df7(0x307)]});else devices[_0x39975f][_0x5a9df7(0x307)]['allow']&&devices[_0x39975f][_0x5a9df7(0x307)][_0x5a9df7(0x2f8)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x39975f)[_0x5a9df7(0x357)](_0x282b8c=>{setAccess(_0x282b8c);}),logger[_0x5a9df7(0x303)](_0x5a9df7(0x277)+_0x39975f['slice'](-0x8)),setTokenRefresh(_0x39975f),setSessionTimeout(_0x5a9df7(0x343),_0x39975f));}}else logger[_0x5a9df7(0x20c)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x28eece['on']('reset-password',()=>{resetPassword();}),_0x28eece['on'](_0x188b1b(0x2bb),_0x399dc4=>{removeClient(_0x28eece['id']);}),_0x5ac4bd==_0x188b1b(0x2f7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3298cc){const _0x14e42f=_0x31d996;if(_0x3298cc!='botmanager'&&config[_0x14e42f(0x274)]!=''){if(pid[_0x3298cc])pid[_0x3298cc]['send']({'function':_0x14e42f(0x23f),'args':null});}_0x3298cc!=_0x14e42f(0x2f7)&&broadcastToBots('bots',JSON[_0x14e42f(0x2c4)](config));}function reloadBotManager(){const _0x48eb39=_0x31d996;getClientsWithBotID(_0x48eb39(0x2f7))['forEach'](_0x5f2417=>{const _0x45019d=_0x48eb39;getSocket(_0x5f2417['id'])[_0x45019d(0x256)]('status',{'access':{'allow':![],'reason':_0x45019d(0x1db),'token':null}});});}function getSocket(_0x41de4c){const _0x580e70=_0x31d996;return io[_0x580e70(0x2bf)][_0x580e70(0x2bf)][_0x580e70(0x362)](_0x41de4c);}function setAccess(_0x4aa25b){const _0x5d8a5f=_0x31d996,_0x151154=getSocket(_0x4aa25b['id']),_0x329012=_0x4aa25b[_0x5d8a5f(0x344)],_0x30c57e=_0x4aa25b[_0x5d8a5f(0x332)];devices[_0x329012][_0x5d8a5f(0x307)]=validateAccess(devices[_0x329012][_0x5d8a5f(0x307)][_0x5d8a5f(0x314)],_0x329012),logger[_0x5d8a5f(0x303)](_0x5d8a5f(0x214)+devices[_0x329012][_0x5d8a5f(0x307)][_0x5d8a5f(0x2f8)]+_0x5d8a5f(0x1f1)+_0x4aa25b['id'][_0x5d8a5f(0x231)](-0x8)+_0x5d8a5f(0x355)+_0x329012[_0x5d8a5f(0x231)](-0x8)),_0x151154[_0x5d8a5f(0x24c)](_0x329012);if(devices[_0x329012][_0x5d8a5f(0x307)][_0x5d8a5f(0x2a2)]){_0x151154['join'](_0x30c57e);if(_0x30c57e=='botmanager')initializeSocketBotManager(_0x151154);else initializeSocketBot(_0x151154);initClient(_0x30c57e);}devices[_0x329012][_0x5d8a5f(0x307)][_0x5d8a5f(0x314)]&&devices[_0x329012][_0x5d8a5f(0x307)]['reason']==_0x5d8a5f(0x26b)&&setSessionTimeout(_0x5d8a5f(0x25b),_0x329012),devices[_0x329012]['access'][_0x5d8a5f(0x314)]&&devices[_0x329012][_0x5d8a5f(0x307)][_0x5d8a5f(0x2f8)]==_0x5d8a5f(0x334)&&setSessionTimeout('login',_0x329012),_0x151154[_0x5d8a5f(0x256)](_0x5d8a5f(0x2bc),{'status':_0x4aa25b[_0x5d8a5f(0x1f9)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x329012][_0x5d8a5f(0x307)],'externalip':devices[_0x329012]['ip'],'publicKey':secure[_0x5d8a5f(0x1fa)],'userid':settings[_0x5d8a5f(0x1a0)],'validInstallation':validInstallation}),devices[_0x329012][_0x5d8a5f(0x307)]['allow']==![]&&devices[_0x329012]['access'][_0x5d8a5f(0x2f8)]=='2FA\x20required'&&temporaryAccess2FA(_0x329012,devices[_0x329012]['ip']);}function setSessionTimeout(_0x5a3c51,_0x5ef646){const _0x421680=_0x31d996;let _0xad0c90;if(_0x5a3c51==_0x421680(0x343))_0xad0c90=loginExpiry*0x3c*0x3e8;else _0xad0c90=devices[_0x5ef646]['telegramIpApproval'][_0x421680(0x272)]*0x3c*0x3e8-(new Date()[_0x421680(0x247)]()-devices[_0x5ef646][_0x421680(0x1fb)][_0x421680(0x34d)]);if(devices[_0x5ef646]['pidExpireLogin'])clearTimeout(devices[_0x5ef646][_0x421680(0x27f)]);devices[_0x5ef646][_0x421680(0x27f)]=setTimeout(()=>{const _0x39b5fa=_0x421680;if(devices[_0x5ef646][_0x39b5fa(0x1b7)])clearTimeout(devices[_0x5ef646][_0x39b5fa(0x1b7)]);removeSocketListeners(_0x5ef646),addBlacklist(_0x5ef646),devices[_0x5ef646][_0x39b5fa(0x1fb)]=null,devices[_0x5ef646][_0x39b5fa(0x30e)]=null,devices[_0x5ef646]['access'][_0x39b5fa(0x314)]=null,logger[_0x39b5fa(0x303)](_0x39b5fa(0x1b0)+_0x5ef646[_0x39b5fa(0x231)](-0x8)),devices[_0x5ef646][_0x39b5fa(0x307)]=validateAccess(devices[_0x5ef646][_0x39b5fa(0x307)][_0x39b5fa(0x314)],_0x5ef646),!(devices[_0x5ef646]['access'][_0x39b5fa(0x2a2)]&&devices[_0x5ef646][_0x39b5fa(0x307)][_0x39b5fa(0x2f8)]==_0x39b5fa(0x1ca))&&(_0x5a3c51==_0x39b5fa(0x343)?io['to'](_0x5ef646)[_0x39b5fa(0x256)](_0x39b5fa(0x2bc),{'access':{'allow':![],'reason':_0x39b5fa(0x268),'token':null}}):io['to'](_0x5ef646)[_0x39b5fa(0x256)]('status',{'access':{'allow':![],'reason':_0x39b5fa(0x2a1),'token':null}})),devices[_0x5ef646][_0x39b5fa(0x307)][_0x39b5fa(0x314)]=null;},_0xad0c90);}function setTokenRefresh(_0x1ee905){const _0x5b3a22=_0x31d996;if(devices[_0x1ee905][_0x5b3a22(0x1b7)])clearTimeout(devices[_0x1ee905][_0x5b3a22(0x1b7)]);devices[_0x1ee905]['pidRefreshToken']=setTimeout(()=>{const _0x4ad615=_0x5b3a22;getClientsWithUuid(_0x1ee905)[_0x4ad615(0x246)]!=0x0?(devices[_0x1ee905][_0x4ad615(0x307)]=refreshToken(_0x1ee905),io['to'](_0x1ee905)[_0x4ad615(0x256)](_0x4ad615(0x2bc),{'status':_0x4ad615(0x32c),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1ee905][_0x4ad615(0x307)],'externalip':devices[_0x1ee905]['ip'],'publicKey':secure[_0x4ad615(0x1fa)],'validInstallation':validInstallation}),setTokenRefresh(_0x1ee905)):clearTimeout(devices[_0x1ee905]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x16dd20){const _0x2d6a34=_0x31d996,_0x49cffa=getClient(_0x16dd20['id'])[_0x2d6a34(0x344)];_0x16dd20[_0x2d6a34(0x256)]('bots',config),_0x16dd20['emit'](_0x2d6a34(0x2fd),cleanSettings()),_0x16dd20['on'](_0x2d6a34(0x359),_0x34cab3=>{const _0x56e5ea=_0x2d6a34;if(validateAccess(_0x34cab3,_0x49cffa)[_0x56e5ea(0x2a2)])addBot();else logger[_0x56e5ea(0x20c)](_0x56e5ea(0x1b3));}),_0x16dd20['on']('update-bot',(_0x5481f5,_0x2b74e0)=>{const _0x2f9c66=_0x2d6a34;if(validateAccess(_0x2b74e0,_0x49cffa)['allow'])toggleBot(_0x5481f5['botID'],_0x5481f5[_0x2f9c66(0x2bc)],_0x5481f5[_0x2f9c66(0x289)]);else logger[_0x2f9c66(0x20c)](_0x2f9c66(0x229));}),_0x16dd20['on'](_0x2d6a34(0x322),(_0x5d38e7,_0x1119f2)=>{const _0x4105b7=_0x2d6a34;if(validateAccess(_0x1119f2,_0x49cffa)[_0x4105b7(0x2a2)])toggleBotMode(_0x5d38e7);else logger[_0x4105b7(0x20c)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x16dd20['on'](_0x2d6a34(0x223),(_0x15dedc,_0x2720bd)=>{const _0x58a1ed=_0x2d6a34;if(validateAccess(_0x2720bd,_0x49cffa)['allow'])deleteBot(_0x15dedc);else logger[_0x58a1ed(0x20c)](_0x58a1ed(0x1d6));}),_0x16dd20['on'](_0x2d6a34(0x20b),(_0x2c1e90,_0x1c7be9)=>{const _0x2db22c=_0x2d6a34;if(validateAccess(_0x1c7be9,_0x49cffa)[_0x2db22c(0x2a2)])storeSettings(_0x2c1e90,!![]);else logger['full'](_0x2db22c(0x1bd));}),_0x16dd20['on'](_0x2d6a34(0x236),_0x166c2c=>{const _0x2d101e=_0x2d6a34;if(validateAccess(_0x166c2c,_0x49cffa)[_0x2d101e(0x2a2)])updateBB(_0x2d101e(0x257));else logger[_0x2d101e(0x20c)](_0x2d101e(0x208));}),_0x16dd20['on'](_0x2d6a34(0x230),_0xf64c4f=>{const _0x1f0fb7=_0x2d6a34;if(validateAccess(_0xf64c4f,_0x49cffa)[_0x1f0fb7(0x2a2)])updateBB(_0x1f0fb7(0x293));else logger[_0x1f0fb7(0x20c)](_0x1f0fb7(0x284));}),_0x16dd20['on'](_0x2d6a34(0x32b),_0x208c2b=>{const _0x17c3c0=_0x2d6a34;if(validateAccess(_0x208c2b,_0x49cffa)[_0x17c3c0(0x2a2)]){const _0x280b22=getClient(_0x16dd20['id']);if(_0x280b22)getBackupFiles(_0x280b22[_0x17c3c0(0x344)]);else logger[_0x17c3c0(0x20c)](_0x17c3c0(0x1c3));}else logger[_0x17c3c0(0x20c)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x16dd20['on'](_0x2d6a34(0x306),(_0x1e5b7e,_0xa4fc6c)=>{const _0x47acea=_0x2d6a34;if(validateAccess(_0xa4fc6c,_0x49cffa)[_0x47acea(0x2a2)])restoreBackupFile(_0x1e5b7e);else logger[_0x47acea(0x20c)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x16dd20['on'](_0x2d6a34(0x346),_0x1ca8ad=>{const _0xe6ee8c=_0x2d6a34;if(validateAccess(_0x1ca8ad,_0x49cffa)['allow'])getMessages();else logger[_0xe6ee8c(0x20c)](_0xe6ee8c(0x2ae));}),_0x16dd20['on']('confirm-message',(_0x4af7fd,_0x13bb5a)=>{const _0x4cfa9c=_0x2d6a34;if(validateAccess(_0x13bb5a,_0x49cffa)[_0x4cfa9c(0x2a2)])confirmMessage(_0x4af7fd);else logger['full'](_0x4cfa9c(0x233));}),_0x16dd20['on'](_0x2d6a34(0x2ca),_0x17f408=>{const _0x59db9b=_0x2d6a34;if(validateAccess(_0x17f408,_0x49cffa)[_0x59db9b(0x2a2)]){if(devices[_0x49cffa][_0x59db9b(0x1b7)])clearTimeout(devices[_0x49cffa][_0x59db9b(0x1b7)]);if(devices[_0x49cffa]['pidExpireLogin'])clearTimeout(devices[_0x49cffa]['pidExpireLogin']);removeSocketListeners(getClient(_0x16dd20['id'])[_0x59db9b(0x344)]),addBlacklist(_0x49cffa),devices[_0x49cffa][_0x59db9b(0x1fb)]=null,devices[_0x49cffa][_0x59db9b(0x30e)]=null,devices[_0x49cffa]['access'][_0x59db9b(0x314)]=null,logger[_0x59db9b(0x303)]('Logged\x20out\x20user\x20...'+_0x49cffa[_0x59db9b(0x231)](-0x8)),io['to'](getClient(_0x16dd20['id'])[_0x59db9b(0x344)])[_0x59db9b(0x256)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x59db9b(0x20c)](_0x59db9b(0x35e));});}function initializeSocketBot(_0x4e6cc9){const _0x4e5d24=_0x31d996,_0x52bb12=getClient(_0x4e6cc9['id'])[_0x4e5d24(0x332)],_0x2231ba=getClient(_0x4e6cc9['id'])[_0x4e5d24(0x344)];_0x4e6cc9['on']('get-logs',(_0x528630,_0x444559)=>{const _0x376d21=_0x4e5d24;if(validateAccess(_0x444559,_0x2231ba)[_0x376d21(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12][_0x376d21(0x30a)]({'function':'emitHistory','args':_0x528630});}else logger['full'](_0x376d21(0x1cf));}),_0x4e6cc9['on'](_0x4e5d24(0x195),(_0xf7d4dc,_0x5cb0bd)=>{const _0x380ede=_0x4e5d24;if(validateAccess(_0x5cb0bd,_0x2231ba)['allow']){if(pid[_0x52bb12])pid[_0x52bb12][_0x380ede(0x30a)]({'function':_0x380ede(0x2c7),'args':_0xf7d4dc});}else logger[_0x380ede(0x20c)](_0x380ede(0x1ba));}),_0x4e6cc9['on'](_0x4e5d24(0x2c0),(_0x3a57bf,_0x362e03)=>{const _0x47993d=_0x4e5d24;if(validateAccess(_0x362e03,_0x2231ba)[_0x47993d(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12][_0x47993d(0x30a)]({'function':_0x47993d(0x2e8),'args':_0x3a57bf});}else logger['full'](_0x47993d(0x1f0));}),_0x4e6cc9['on'](_0x4e5d24(0x329),(_0x5a59ea,_0x1ab7bf)=>{const _0x5b71c5=_0x4e5d24;if(validateAccess(_0x1ab7bf,_0x2231ba)[_0x5b71c5(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12]['send']({'function':_0x5b71c5(0x34f),'args':_0x5a59ea});}else logger[_0x5b71c5(0x20c)](_0x5b71c5(0x1a2));}),_0x4e6cc9['on']('store-headless',(_0xae56cd,_0x45c7b8)=>{const _0x1ac1ee=_0x4e5d24;if(validateAccess(_0x45c7b8,_0x2231ba)[_0x1ac1ee(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12][_0x1ac1ee(0x30a)]({'function':'storeHeadless','args':_0xae56cd});}else logger[_0x1ac1ee(0x20c)](_0x1ac1ee(0x1ee));}),_0x4e6cc9['on'](_0x4e5d24(0x1f8),(_0x5f4a7f,_0x2d7216)=>{const _0xa9f81f=_0x4e5d24;if(validateAccess(_0x2d7216,_0x2231ba)['allow']){if(pid[_0x52bb12])pid[_0x52bb12][_0xa9f81f(0x30a)]({'function':'storeFiat','args':_0x5f4a7f});}else logger[_0xa9f81f(0x20c)](_0xa9f81f(0x28a));}),_0x4e6cc9['on'](_0x4e5d24(0x366),_0x1f474d=>{const _0x31aa41=_0x4e5d24;if(validateAccess(_0x1f474d,_0x2231ba)[_0x31aa41(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12]['send']({'function':_0x31aa41(0x331),'args':null});}else logger['full'](_0x31aa41(0x1dd));}),_0x4e6cc9['on']('get-starting-balances',_0x199e10=>{const _0xab6f9c=_0x4e5d24;if(validateAccess(_0x199e10,_0x2231ba)[_0xab6f9c(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12]['send']({'function':_0xab6f9c(0x34c),'args':null});}else logger[_0xab6f9c(0x20c)](_0xab6f9c(0x363));}),_0x4e6cc9['on'](_0x4e5d24(0x2d1),(_0x3ce5e1,_0x3dd640)=>{const _0x2b1bc2=_0x4e5d24;if(validateAccess(_0x3dd640,_0x2231ba)[_0x2b1bc2(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12][_0x2b1bc2(0x30a)]({'function':_0x2b1bc2(0x364),'args':_0x3ce5e1});}else logger[_0x2b1bc2(0x20c)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x4e6cc9['on'](_0x4e5d24(0x275),_0x38f42e=>{const _0x38d1b3=_0x4e5d24;if(validateAccess(_0x38f42e,_0x2231ba)[_0x38d1b3(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12][_0x38d1b3(0x30a)]({'function':'cancelLoading','args':null});}else logger[_0x38d1b3(0x20c)](_0x38d1b3(0x327));}),_0x4e6cc9['on'](_0x4e5d24(0x19e),_0x321699=>{const _0x1cfd6f=_0x4e5d24;if(validateAccess(_0x321699,_0x2231ba)[_0x1cfd6f(0x2a2)]){if(pid[_0x52bb12])pid[_0x52bb12][_0x1cfd6f(0x30a)]({'function':_0x1cfd6f(0x238),'args':null});}else logger['full'](_0x1cfd6f(0x34e));}),_0x4e6cc9['on'](_0x4e5d24(0x236),_0x11dc1a=>{const _0x1c0461=_0x4e5d24;if(validateAccess(_0x11dc1a,_0x2231ba)['allow'])updateBB('update');else logger['full'](_0x1c0461(0x208));}),_0x4e6cc9['on'](_0x4e5d24(0x346),_0x3f0987=>{const _0x4d2639=_0x4e5d24;if(validateAccess(_0x3f0987,_0x2231ba)[_0x4d2639(0x2a2)])getMessages();else logger[_0x4d2639(0x20c)](_0x4d2639(0x2ae));}),_0x4e6cc9['on'](_0x4e5d24(0x2f1),(_0x29b28f,_0x3de813)=>{const _0x509bcc=_0x4e5d24;if(validateAccess(_0x3de813,_0x2231ba)['allow'])confirmMessage(_0x29b28f);else logger[_0x509bcc(0x20c)](_0x509bcc(0x233));}),_0x4e6cc9['on']('logout',_0x1a34ee=>{const _0x3ad12c=_0x4e5d24;if(validateAccess(_0x1a34ee,_0x2231ba)[_0x3ad12c(0x2a2)]){if(devices[_0x2231ba][_0x3ad12c(0x1b7)])clearTimeout(devices[_0x2231ba][_0x3ad12c(0x1b7)]);if(devices[_0x2231ba][_0x3ad12c(0x27f)])clearTimeout(devices[_0x2231ba][_0x3ad12c(0x27f)]);removeSocketListeners(getClient(_0x4e6cc9['id'])['uuid']),addBlacklist(_0x2231ba),devices[_0x2231ba]['telegramIpApproval']=null,devices[_0x2231ba][_0x3ad12c(0x30e)]=null,devices[_0x2231ba][_0x3ad12c(0x307)]['token']=null,logger[_0x3ad12c(0x303)](_0x3ad12c(0x2e9)+_0x2231ba[_0x3ad12c(0x231)](-0x8)),io['to'](getClient(_0x4e6cc9['id'])[_0x3ad12c(0x344)])['emit'](_0x3ad12c(0x2bc),{'access':{'allow':![],'reason':_0x3ad12c(0x337),'token':null}});}else logger[_0x3ad12c(0x20c)](_0x3ad12c(0x35e));});}function removeSocketListeners(_0x50130d){getClientsWithUuid(_0x50130d)['forEach'](_0x40b926=>{const _0x1a8936=_0x2805;getSocket(_0x40b926['id'])[_0x1a8936(0x33c)]();});}function cleanSettings(){const _0x3f52ac=_0x31d996;let _0x342c99=settings;return settings[_0x3f52ac(0x2ac)]&&settings['telegramToken']!=''&&(_0x342c99={..._0x342c99,'telegramToken':_0x3f52ac(0x27c)}),settings[_0x3f52ac(0x291)]&&settings['bbPassword']!=''&&(_0x342c99={..._0x342c99,'bbPassword':'************'}),(settings[_0x3f52ac(0x291)]&&settings[_0x3f52ac(0x291)]==_0x3f52ac(0x310)||settings[_0x3f52ac(0x2ac)]&&settings[_0x3f52ac(0x2ac)]==_0x3f52ac(0x310))&&(_0x342c99={..._0x342c99,'restored':{'password':settings['bbPassword']==_0x3f52ac(0x310),'telegram':settings[_0x3f52ac(0x2ac)]==_0x3f52ac(0x310)}}),_0x342c99;}async function updateBB(_0x230559){const _0xeaba24=_0x31d996;await backupConfigFiles(),installingUpdate=!![],config[_0xeaba24(0x357)](_0xa38468=>{const _0x4934ac=_0xeaba24;restartBot(_0xa38468[_0x4934ac(0x193)]);});if(_0x230559=='update')process[_0xeaba24(0x30a)]({'update':!![],'environment':environment},_0xf8941d=>{});else _0x230559==_0xeaba24(0x293)&&process[_0xeaba24(0x30a)]({'reinstall':!![],'environment':environment},_0x2408a8=>{});}function startBot(_0x22e290,_0x58872d,_0xeda784){const _0x487b5d=_0x31d996;if(debugging)_0x22e290[_0x487b5d(0x1f6)]('-d');let _0x5a0238=![];const _0x54d7f9=_0x22e290[0x0];_0x58872d={..._0x58872d,'stdio':[_0x487b5d(0x29b),_0x487b5d(0x29b),'inherit',_0x487b5d(0x1c6)]},pid[_0x54d7f9]=childProcess[_0x487b5d(0x33f)](botfile,_0x22e290,_0x58872d),pid[_0x54d7f9]['on'](_0x487b5d(0x285),_0x2d8b3a=>{const _0x20b90f=_0x487b5d;switch(Object[_0x20b90f(0x2cc)](_0x2d8b3a)[0x0]){case'botname':updateBotName(_0x54d7f9,_0x2d8b3a[_0x20b90f(0x282)]);break;case _0x20b90f(0x2b7):updateBotManager();break;case _0x20b90f(0x2bc):updateStatus(_0x54d7f9,_0x2d8b3a[_0x20b90f(0x2bc)]);break;case _0x20b90f(0x289):updateLive(_0x54d7f9,_0x2d8b3a['live']);break;case _0x20b90f(0x1b8):updateLive(_0x54d7f9,_0x2d8b3a['started']),io['to'](_0x54d7f9)['emit'](_0x20b90f(0x2bc),{'access':{'allow':![],'reason':_0x20b90f(0x1db),'token':null}});break;case _0x20b90f(0x2ce):_0x2d8b3a['stop']==_0x20b90f(0x1e6)&&restartBot(_0x54d7f9);_0x2d8b3a[_0x20b90f(0x2ce)]==_0x20b90f(0x260)&&toggleBot(_0x54d7f9,_0x20b90f(0x283),_0x20b90f(0x196));break;case _0x20b90f(0x198):sendTelegram(_0x54d7f9,_0x2d8b3a['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x2d8b3a[_0x20b90f(0x28c)]);break;case _0x20b90f(0x1de):io['to'](_0x54d7f9)[_0x20b90f(0x256)](_0x2d8b3a['function'],_0x2d8b3a[_0x20b90f(0x2fb)]);break;}}),pid[_0x54d7f9]['on']('error',function(_0x593f80){if(_0x5a0238)return;_0x5a0238=!![],_0xeda784(_0x593f80);}),pid[_0x54d7f9]['on'](_0x487b5d(0x356),async function(_0x132719){const _0x17f29f=_0x487b5d;if(installingUpdate)return;if(_0x5a0238)return;_0x5a0238=!![],_0xeda784(null);const _0x4b3365=dbConfig[_0x17f29f(0x362)](_0x17f29f(0x1a8))['find']({'botID':_0x54d7f9})[_0x17f29f(0x28d)]();_0x4b3365&&(_0x4b3365[_0x17f29f(0x2bc)]==_0x17f29f(0x325)||_0x4b3365['status']==_0x17f29f(0x29f))&&(await sleep(0x3e8),updateLive(_0x54d7f9,_0x17f29f(0x196)),logger[_0x17f29f(0x20c)](_0x17f29f(0x209)+_0x54d7f9),startBot([_0x54d7f9,userID],{'cwd':bbpath},function(_0x591227){if(_0x591227)logger['full'](_0x591227);}));});}function stopBot(_0x242e5e){const _0x489f22=_0x31d996;getClientsWithBotID(_0x242e5e)['forEach'](_0x3b48b4=>{const _0x36c133=_0x2805;getSocket(_0x3b48b4['id'])[_0x36c133(0x2bb)](!![]),removeClient(_0x3b48b4['id']);}),pid[_0x242e5e]&&(pid[_0x242e5e][_0x489f22(0x260)](),pid[_0x242e5e]=null);}function restartBot(_0x414a36){if(pid[_0x414a36])pid[_0x414a36]['kill']();}function addBot(){const _0x3d82f3=_0x31d996;let _0x43b550;for(let _0x14c765=0x1;_0x14c765<0x3e9;_0x14c765++){_0x43b550=_0x14c765[_0x3d82f3(0x258)]()[_0x3d82f3(0x2a9)](0x3,'0');let _0x495801=config[_0x3d82f3(0x30c)](_0x3e5fda=>_0x3e5fda[_0x3d82f3(0x193)]==_0x43b550);if(!_0x495801)break;}if(_0x43b550===_0x3d82f3(0x367)){logger[_0x3d82f3(0x20c)](_0x3d82f3(0x2e4));return;}logger[_0x3d82f3(0x20c)](_0x3d82f3(0x22a)+_0x43b550),dbConfig[_0x3d82f3(0x362)]('bots')[_0x3d82f3(0x1f6)]({'botID':_0x43b550,'botname':_0x3d82f3(0x213)+_0x43b550,'status':_0x3d82f3(0x29f),'live':''})[_0x3d82f3(0x20a)](),startBot([_0x43b550,userID],{'cwd':bbpath},function(_0x41265a){const _0x314037=_0x3d82f3;if(_0x41265a)logger[_0x314037(0x20c)](_0x41265a);}),config=getConfiguration(),io['to'](_0x3d82f3(0x2f7))[_0x3d82f3(0x256)](_0x3d82f3(0x1a8),config),broadcastToBots(_0x3d82f3(0x1a8),JSON['stringify'](config));}function deleteBot(_0x43c7bf){const _0x1c672a=_0x31d996;getClientsWithBotID(_0x43c7bf)['forEach'](_0x35e845=>{const _0x49d40a=_0x2805;getSocket(_0x35e845['id'])[_0x49d40a(0x2bb)](!![]),removeClient(_0x35e845['id']);}),dbConfig[_0x1c672a(0x362)](_0x1c672a(0x1a8))[_0x1c672a(0x218)]({'botID':_0x43c7bf})['write'](),logger[_0x1c672a(0x20c)]('Deleted\x20Bot\x20'+_0x43c7bf),stopBot(_0x43c7bf);try{if(fs[_0x1c672a(0x2f9)](path[_0x1c672a(0x24c)](configpath,'bot-'+_0x43c7bf+_0x1c672a(0x2e1))))fs[_0x1c672a(0x280)](path[_0x1c672a(0x24c)](configpath,_0x1c672a(0x19f)+_0x43c7bf+_0x1c672a(0x2e1)));if(fs[_0x1c672a(0x2f9)](path[_0x1c672a(0x24c)](configpath,_0x1c672a(0x19f)+_0x43c7bf+_0x1c672a(0x249))))fs[_0x1c672a(0x280)](path[_0x1c672a(0x24c)](configpath,_0x1c672a(0x19f)+_0x43c7bf+_0x1c672a(0x249)));if(fs[_0x1c672a(0x2f9)](path[_0x1c672a(0x24c)](configpath,_0x1c672a(0x19f)+_0x43c7bf+_0x1c672a(0x31a))))fs[_0x1c672a(0x280)](path[_0x1c672a(0x24c)](configpath,_0x1c672a(0x19f)+_0x43c7bf+'-performance.json'));if(fs[_0x1c672a(0x2f9)](path[_0x1c672a(0x24c)](configpath,_0x1c672a(0x19f)+_0x43c7bf+'-results.json')))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x43c7bf+_0x1c672a(0x219)));}catch(_0x4ca0da){if(_0x4ca0da)logger[_0x1c672a(0x20c)](_0x1c672a(0x22c),_0x4ca0da);}config=getConfiguration(),io['to'](_0x1c672a(0x2f7))[_0x1c672a(0x256)](_0x1c672a(0x1a8),config),broadcastToBots(_0x1c672a(0x1a8),JSON['stringify'](config));}function toggleBot(_0x256f93,_0x3beda2,_0x19923c){const _0x503f3c=_0x31d996;dbConfig[_0x503f3c(0x362)](_0x503f3c(0x1a8))[_0x503f3c(0x30c)]({'botID':_0x256f93})[_0x503f3c(0x1e2)]({'status':_0x3beda2})[_0x503f3c(0x1e2)]({'live':_0x19923c})[_0x503f3c(0x20a)]();if(_0x3beda2==_0x503f3c(0x325)||_0x3beda2==_0x503f3c(0x29f))logger[_0x503f3c(0x20c)](_0x503f3c(0x1ae)+_0x256f93),startBot([_0x256f93,userID],{'cwd':bbpath},function(_0x161ad5){const _0x197989=_0x503f3c;if(_0x161ad5)logger[_0x197989(0x20c)](_0x161ad5);});else(_0x3beda2=='disabled'||_0x3beda2=='new-disabled')&&(logger[_0x503f3c(0x20c)](_0x503f3c(0x2cd)+_0x256f93),stopBot(_0x256f93));config=getConfiguration(),io['to'](_0x503f3c(0x2f7))[_0x503f3c(0x256)](_0x503f3c(0x1a8),config),broadcastToBots(_0x503f3c(0x1a8),JSON[_0x503f3c(0x2c4)](config));}function toggleStatus(_0x1d30e2){const _0x9456c7=_0x31d996;let _0x486427=dbConfig[_0x9456c7(0x362)]('bots')[_0x9456c7(0x30c)]({'botID':_0x1d30e2})[_0x9456c7(0x28d)](),_0x4890b7;if(_0x486427['status']==='enabled')_0x4890b7=_0x9456c7(0x283);else{if(_0x486427['status']===_0x9456c7(0x29f))_0x4890b7='new-disabled';else{if(_0x486427['status']===_0x9456c7(0x33d))_0x4890b7='new';else{if(_0x486427[_0x9456c7(0x2bc)]===_0x9456c7(0x283))_0x4890b7=_0x9456c7(0x325);}}}return _0x4890b7;}function updateStatus(_0x16e130,_0x27a991){const _0x1ac1ad=_0x31d996;dbConfig[_0x1ac1ad(0x362)](_0x1ac1ad(0x1a8))[_0x1ac1ad(0x30c)]({'botID':_0x16e130})['assign']({'status':_0x27a991})[_0x1ac1ad(0x20a)](),config=getConfiguration(),io['to'](_0x1ac1ad(0x2f7))['emit']('bots',config),broadcastToBots(_0x1ac1ad(0x1a8),JSON['stringify'](config));}function updateLive(_0x34863f,_0x1241ec){const _0x4be2f8=_0x31d996;dbConfig[_0x4be2f8(0x362)]('bots')[_0x4be2f8(0x30c)]({'botID':_0x34863f})[_0x4be2f8(0x1e2)]({'live':_0x1241ec})[_0x4be2f8(0x20a)](),config=getConfiguration(),io['to'](_0x4be2f8(0x2f7))[_0x4be2f8(0x256)]('bots',config),broadcastToBots(_0x4be2f8(0x1a8),JSON['stringify'](config));}function updateBotName(_0x52404d,_0x5d55e7){const _0x402d45=_0x31d996;dbConfig['get']('bots')[_0x402d45(0x30c)]({'botID':_0x52404d})[_0x402d45(0x1e2)]({'botname':_0x5d55e7})[_0x402d45(0x20a)](),config=getConfiguration(),io['to'](_0x402d45(0x2f7))[_0x402d45(0x256)](_0x402d45(0x1a8),config),broadcastToBots(_0x402d45(0x1a8),JSON[_0x402d45(0x2c4)](config));}function updateBotManager(){const _0x56f46c=_0x31d996;config=getConfiguration(),io['to'](_0x56f46c(0x2f7))['emit'](_0x56f46c(0x1a8),config),broadcastToBots(_0x56f46c(0x1a8),JSON[_0x56f46c(0x2c4)](config));}function toggleBotMode(_0x12230e){const _0x253933=_0x31d996;if(pid[_0x12230e])pid[_0x12230e][_0x253933(0x30a)]({'function':_0x253933(0x28f),'args':null});else{const _0x1547a3=configpath+_0x253933(0x19f)+_0x12230e+_0x253933(0x2e1),_0x4f8031=fs[_0x253933(0x234)](_0x1547a3),_0x1849e9=JSON[_0x253933(0x341)](_0x4f8031),_0x1a8eb6=_0x1849e9[_0x253933(0x332)][0x0][_0x253933(0x1e0)];_0x1849e9['bot'][0x0][_0x253933(0x1e0)]=!_0x1a8eb6;const _0x3ce186=JSON[_0x253933(0x2c4)](_0x1849e9,null,0x2);fs[_0x253933(0x1c0)](_0x1547a3,_0x3ce186),config=getConfiguration(),io['to'](_0x253933(0x2f7))[_0x253933(0x256)](_0x253933(0x1a8),config),broadcastToBots(_0x253933(0x1a8),JSON['stringify'](config));}}function telegramError(_0x5bc2e2){const _0x1346bb=_0x31d996;logger[_0x1346bb(0x1ad)](getTimeStamp()+_0x1346bb(0x2be));}function validateTelegram(_0xf1aaf6){const _0x1c08ce=_0x31d996;if(_0xf1aaf6['from'][_0x1c08ce(0x33e)]!=settings[_0x1c08ce(0x345)]&&'@'+_0xf1aaf6[_0x1c08ce(0x34a)][_0x1c08ce(0x33e)]!=settings[_0x1c08ce(0x345)])return tgBot[_0x1c08ce(0x194)](_0xf1aaf6[_0x1c08ce(0x2a5)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x1c08ce(0x2c6)})[_0x1c08ce(0x19d)](_0x470af2=>{telegramError(_0x470af2);}),![];return!![];}async function initTelegram(){const _0x16e5d7=_0x31d996;if(tgBot)tgBot[_0x16e5d7(0x199)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x16a036=_0x16e5d7(0x2ea);_0x16a036+='\x0a',_0x16a036+=_0x16e5d7(0x31b),_0x16a036+=_0x16e5d7(0x202),_0x16a036+=_0x16e5d7(0x251),_0x16a036+=_0x16e5d7(0x22d),_0x16a036+=_0x16e5d7(0x323),_0x16a036+='/off\x20-\x20stop\x20bot(s)\x0a',_0x16a036+=_0x16e5d7(0x245),_0x16a036+='/names\x20-\x20show\x20bot\x20names\x0a',_0x16a036+=_0x16e5d7(0x315),_0x16a036+=_0x16e5d7(0x279),_0x16a036+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x16a036+=_0x16e5d7(0x266),_0x16a036+=_0x16e5d7(0x2b5),_0x16a036+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x426b89=_0x16e5d7(0x32d);_0x426b89+='\x0a',_0x426b89+=_0x16a036,tgBot[_0x16e5d7(0x267)](/\/start/,_0x208e2e=>{const _0x1806e2=_0x16e5d7;if(!validateTelegram(_0x208e2e))return;if(settings[_0x1806e2(0x232)]!=_0x208e2e[_0x1806e2(0x2a5)]['id'])updateSetting(_0x1806e2(0x232),_0x208e2e['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x1806e2(0x194)](_0x208e2e['chat']['id'],_0x426b89)[_0x1806e2(0x19d)](_0x29d142=>{telegramError(_0x29d142);});}),tgBot[_0x16e5d7(0x267)](/\/enable/,_0x514b69=>{const _0x26aa39=_0x16e5d7;if(!validateTelegram(_0x514b69))return;if(settings[_0x26aa39(0x232)]!=_0x514b69[_0x26aa39(0x2a5)]['id'])updateSetting(_0x26aa39(0x232),_0x514b69['chat']['id']);updateSetting(_0x26aa39(0x269),!![]),tgBot[_0x26aa39(0x194)](_0x514b69[_0x26aa39(0x2a5)]['id'],_0x26aa39(0x2da))[_0x26aa39(0x19d)](_0x1a392b=>{telegramError(_0x1a392b);});}),tgBot['onText'](/\/config/,async _0x2732a7=>{const _0x3779ef=_0x16e5d7;if(!validateTelegram(_0x2732a7))return;tgBot[_0x3779ef(0x32e)]('callback_query'),tgBot['sendMessage'](_0x2732a7[_0x3779ef(0x2a5)]['id'],_0x3779ef(0x36a),{'reply_markup':{'inline_keyboard':[[{'text':_0x3779ef(0x1d4),'callback_data':_0x3779ef(0x2a0)},{'text':_0x3779ef(0x1be),'callback_data':_0x3779ef(0x253)},{'text':_0x3779ef(0x2e2),'callback_data':_0x3779ef(0x308)}]]}})[_0x3779ef(0x19d)](_0x53275f=>{telegramError(_0x53275f);}),tgBot['on'](_0x3779ef(0x1bb),async _0x1dddd8=>{const _0x53bfb3=_0x3779ef,_0x5af59d=_0x1dddd8[_0x53bfb3(0x294)],_0x1101cd=_0x1dddd8[_0x53bfb3(0x285)];tgBot['answerCallbackQuery'](_0x1dddd8['id'])[_0x53bfb3(0x29a)](async()=>{const _0x43f28e=_0x53bfb3;_0x5af59d==_0x43f28e(0x2a0)&&(updateSetting(_0x43f28e(0x1aa),'orders'),updateSetting(_0x43f28e(0x269),!![]),await tgBot['sendMessage'](_0x1101cd[_0x43f28e(0x2a5)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x43f28e(0x19d)](_0x35539a=>{telegramError(_0x35539a);}));_0x5af59d==_0x43f28e(0x253)&&(updateSetting(_0x43f28e(0x1aa),'alerts'),updateSetting(_0x43f28e(0x269),!![]),await tgBot['sendMessage'](_0x1101cd[_0x43f28e(0x2a5)]['id'],_0x43f28e(0x335))[_0x43f28e(0x19d)](_0x237d91=>{telegramError(_0x237d91);}));_0x5af59d=='all'&&(updateSetting(_0x43f28e(0x1aa),_0x43f28e(0x308)),updateSetting('telegramEnabled',!![]),await tgBot[_0x43f28e(0x194)](_0x1101cd['chat']['id'],_0x43f28e(0x309))[_0x43f28e(0x19d)](_0x5e3e7e=>{telegramError(_0x5e3e7e);}));if(!settings[_0x43f28e(0x232)])tgBot[_0x43f28e(0x194)](_0x1101cd[_0x43f28e(0x2a5)]['id'],_0x43f28e(0x1bf))[_0x43f28e(0x19d)](_0x5c3b02=>{telegramError(_0x5c3b02);});}),tgBot[_0x53bfb3(0x32e)](_0x53bfb3(0x1bb));});}),tgBot[_0x16e5d7(0x267)](/\/status/,_0x37104e=>{const _0x2a024d=_0x16e5d7;if(!validateTelegram(_0x37104e))return;const _0x232224=getBotsWithMode();let _0x11f0b0=_0x2a024d(0x210);config['forEach'](_0x2e040a=>{const _0x9c158d=_0x2a024d,_0x30a5d5=_0x232224[_0x9c158d(0x30c)](_0x2b7f06=>_0x2b7f06[_0x9c158d(0x193)]==_0x2e040a[_0x9c158d(0x193)])[_0x9c158d(0x2e6)];_0x11f0b0+=_0x9c158d(0x213)+_0x2e040a[_0x9c158d(0x193)]+':\x20'+_0x2e040a['status']+'\x20|\x20'+_0x30a5d5+_0x9c158d(0x361)+_0x2e040a[_0x9c158d(0x289)]+'\x0a';}),_0x11f0b0+='\x0a',_0x11f0b0+=_0x2a024d(0x1bc),_0x11f0b0+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x11f0b0+=settings[_0x2a024d(0x269)]?settings[_0x2a024d(0x1aa)]==_0x2a024d(0x308)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x2a024d(0x1aa)]+_0x2a024d(0x328):'',tgBot[_0x2a024d(0x194)](_0x37104e[_0x2a024d(0x2a5)]['id'],_0x11f0b0,{'parse_mode':_0x2a024d(0x2c6)})['catch'](_0x11bba6=>{telegramError(_0x11bba6);});}),tgBot['onText'](/\/restart/,_0x328c1f=>{const _0x510529=_0x16e5d7;if(!validateTelegram(_0x328c1f))return;tgBot[_0x510529(0x32e)]('callback_query');const _0x38a250=getEnabledBots();if(_0x38a250[_0x510529(0x246)]==0x0)tgBot[_0x510529(0x194)](_0x328c1f[_0x510529(0x2a5)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x382bb5=>{telegramError(_0x382bb5);});else{if(_0x38a250[_0x510529(0x246)]>0x1)_0x38a250[_0x510529(0x1f6)]({'botID':'all'});let _0x4a69b6=[],_0xaf7603=[];const _0x42a019=_0x38a250[_0x510529(0x246)]%0x4==0x0||_0x38a250[_0x510529(0x246)]%0x4==0x3||_0x38a250['length']%0x3==0x1?0x4:0x3;let _0x404d2f=0x0;_0x38a250['forEach']((_0x4c7ad2,_0x1761ab)=>{const _0x527f74=_0x510529;if(_0x1761ab%_0x42a019==0x0)_0xaf7603=[];_0xaf7603[_0x527f74(0x1f6)]({'text':_0x4c7ad2[_0x527f74(0x193)]==_0x527f74(0x308)?_0x527f74(0x1af):_0x527f74(0x213)+_0x4c7ad2['botID'],'callback_data':_0x4c7ad2[_0x527f74(0x193)]}),_0x1761ab%_0x42a019==0x0&&(_0x4a69b6[_0x404d2f]=_0xaf7603,_0x404d2f++);}),tgBot[_0x510529(0x194)](_0x328c1f[_0x510529(0x2a5)]['id'],_0x510529(0x1f4),{'reply_markup':{'inline_keyboard':_0x4a69b6}})[_0x510529(0x19d)](_0x1bf835=>{telegramError(_0x1bf835);}),tgBot['on'](_0x510529(0x1bb),async _0x8af299=>{const _0x41d32d=_0x510529,_0x3563c4=_0x8af299['data'],_0x4088ba=_0x8af299[_0x41d32d(0x285)];tgBot[_0x41d32d(0x1d8)](_0x8af299['id'])[_0x41d32d(0x29a)](async()=>{const _0xfedba=_0x41d32d;_0x3563c4==_0xfedba(0x308)?config[_0xfedba(0x357)](_0x3f5852=>{restartBot(_0x3f5852['botID']);}):restartBot(_0x3563c4);}),tgBot[_0x41d32d(0x32e)](_0x41d32d(0x1bb));});}}),tgBot['onText'](/\/on/,_0x7f62f4=>{const _0x8265f3=_0x16e5d7;if(!validateTelegram(_0x7f62f4))return;tgBot[_0x8265f3(0x32e)]('callback_query');const _0x327290=getDisabledBots();if(_0x327290[_0x8265f3(0x246)]==0x0)tgBot[_0x8265f3(0x194)](_0x7f62f4[_0x8265f3(0x2a5)]['id'],_0x8265f3(0x27a))[_0x8265f3(0x19d)](_0xc04f2f=>{telegramError(_0xc04f2f);});else{if(_0x327290[_0x8265f3(0x246)]>0x1)_0x327290[_0x8265f3(0x1f6)]({'botID':_0x8265f3(0x308)});let _0x34aad1=[],_0x55faeb=[];const _0x21c49a=_0x327290['length']%0x4==0x0||_0x327290[_0x8265f3(0x246)]%0x4==0x3||_0x327290[_0x8265f3(0x246)]%0x3==0x1?0x4:0x3;let _0x3c1c01=0x0;_0x327290[_0x8265f3(0x357)]((_0x19757c,_0x2f20dc)=>{const _0x33529a=_0x8265f3;if(_0x2f20dc%_0x21c49a==0x0)_0x55faeb=[];_0x55faeb[_0x33529a(0x1f6)]({'text':_0x19757c[_0x33529a(0x193)]==_0x33529a(0x308)?_0x33529a(0x1af):_0x33529a(0x213)+_0x19757c[_0x33529a(0x193)],'callback_data':_0x19757c[_0x33529a(0x193)]}),_0x2f20dc%_0x21c49a==0x0&&(_0x34aad1[_0x3c1c01]=_0x55faeb,_0x3c1c01++);}),tgBot['sendMessage'](_0x7f62f4[_0x8265f3(0x2a5)]['id'],_0x8265f3(0x300),{'reply_markup':{'inline_keyboard':_0x34aad1}})['catch'](_0x4f02d9=>{telegramError(_0x4f02d9);}),tgBot['on']('callback_query',async _0x2124b7=>{const _0x4950c7=_0x8265f3,_0x2afbcf=_0x2124b7[_0x4950c7(0x294)],_0x1d093e=_0x2124b7[_0x4950c7(0x285)];tgBot[_0x4950c7(0x1d8)](_0x2124b7['id'])[_0x4950c7(0x29a)](async()=>{const _0x597252=_0x4950c7;_0x2afbcf=='all'?(tgBot[_0x597252(0x194)](_0x1d093e[_0x597252(0x2a5)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x597252(0x19d)](_0x390c5e=>{telegramError(_0x390c5e);}),_0x327290[_0x597252(0x357)](_0x9c1d09=>{const _0x3f1769=_0x597252;if(_0x9c1d09[_0x3f1769(0x193)]!=_0x3f1769(0x308))toggleBot(_0x9c1d09['botID'],toggleStatus(_0x9c1d09[_0x3f1769(0x193)]),'stopped');})):(tgBot[_0x597252(0x194)](_0x1d093e[_0x597252(0x2a5)]['id'],_0x597252(0x2f4)+_0x2afbcf)[_0x597252(0x19d)](_0x391ff8=>{telegramError(_0x391ff8);}),toggleBot(_0x2afbcf,toggleStatus(_0x2afbcf),_0x597252(0x196)));}),tgBot[_0x4950c7(0x32e)](_0x4950c7(0x1bb));});}}),tgBot['onText'](/\/off/,_0x5e4759=>{const _0x572fb5=_0x16e5d7;if(!validateTelegram(_0x5e4759))return;tgBot[_0x572fb5(0x32e)](_0x572fb5(0x1bb));const _0xf7d88a=getEnabledBots();if(_0xf7d88a[_0x572fb5(0x246)]==0x0)tgBot[_0x572fb5(0x194)](_0x5e4759[_0x572fb5(0x2a5)]['id'],_0x572fb5(0x365))[_0x572fb5(0x19d)](_0x119dd8=>{telegramError(_0x119dd8);});else{if(_0xf7d88a['length']>0x1)_0xf7d88a[_0x572fb5(0x1f6)]({'botID':_0x572fb5(0x308)});let _0x28a0a7=[],_0x29b0f7=[];const _0x7c92b=_0xf7d88a[_0x572fb5(0x246)]%0x4==0x0||_0xf7d88a[_0x572fb5(0x246)]%0x4==0x3||_0xf7d88a[_0x572fb5(0x246)]%0x3==0x1?0x4:0x3;let _0x3650b1=0x0;_0xf7d88a[_0x572fb5(0x357)]((_0x361349,_0x417d0d)=>{const _0x57ef4f=_0x572fb5;if(_0x417d0d%_0x7c92b==0x0)_0x29b0f7=[];_0x29b0f7[_0x57ef4f(0x1f6)]({'text':_0x361349[_0x57ef4f(0x193)]==_0x57ef4f(0x308)?_0x57ef4f(0x1af):_0x57ef4f(0x213)+_0x361349['botID'],'callback_data':_0x361349[_0x57ef4f(0x193)]}),_0x417d0d%_0x7c92b==0x0&&(_0x28a0a7[_0x3650b1]=_0x29b0f7,_0x3650b1++);}),tgBot['sendMessage'](_0x5e4759[_0x572fb5(0x2a5)]['id'],_0x572fb5(0x211),{'reply_markup':{'inline_keyboard':_0x28a0a7}})['catch'](_0x4f7fad=>{telegramError(_0x4f7fad);}),tgBot['on']('callback_query',async _0x1ac6fd=>{const _0xf29019=_0x572fb5,_0x20aad8=_0x1ac6fd[_0xf29019(0x294)],_0x311ad9=_0x1ac6fd[_0xf29019(0x285)];tgBot['answerCallbackQuery'](_0x1ac6fd['id'])[_0xf29019(0x29a)](async()=>{const _0x1af95a=_0xf29019;_0x20aad8==_0x1af95a(0x308)?(tgBot[_0x1af95a(0x194)](_0x311ad9[_0x1af95a(0x2a5)]['id'],_0x1af95a(0x2c2))[_0x1af95a(0x19d)](_0x26cbd8=>{telegramError(_0x26cbd8);}),_0xf7d88a['forEach'](_0x1c85f8=>{const _0x3ba853=_0x1af95a;if(_0x1c85f8[_0x3ba853(0x193)]!=_0x3ba853(0x308))toggleBot(_0x1c85f8[_0x3ba853(0x193)],toggleStatus(_0x1c85f8[_0x3ba853(0x193)]),_0x3ba853(0x196));})):(tgBot[_0x1af95a(0x194)](_0x311ad9[_0x1af95a(0x2a5)]['id'],_0x1af95a(0x32f)+_0x20aad8)['catch'](_0xdde2e=>{telegramError(_0xdde2e);}),toggleBot(_0x20aad8,toggleStatus(_0x20aad8),_0x1af95a(0x196)));}),tgBot[_0xf29019(0x32e)](_0xf29019(0x1bb));});}}),tgBot[_0x16e5d7(0x267)](/\/metrics/,_0x3a73f3=>{const _0x1c9935=_0x16e5d7;if(!validateTelegram(_0x3a73f3))return;tgBot[_0x1c9935(0x32e)](_0x1c9935(0x1bb));const _0x119b21=getEnabledBots();if(_0x119b21[_0x1c9935(0x246)]==0x0)tgBot[_0x1c9935(0x194)](_0x3a73f3[_0x1c9935(0x2a5)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x1c9935(0x19d)](_0x2ba0d3=>{telegramError(_0x2ba0d3);});else{if(_0x119b21['length']>0x1){let _0x26843a=[],_0x46fb70=[];const _0x5e3443=_0x119b21['length']%0x4==0x0||_0x119b21[_0x1c9935(0x246)]%0x4==0x3||_0x119b21['length']%0x3==0x1?0x4:0x3;let _0x22fe79=0x0;_0x119b21[_0x1c9935(0x357)]((_0x408ca3,_0x40d656)=>{const _0x102e99=_0x1c9935;if(_0x40d656%_0x5e3443==0x0)_0x46fb70=[];_0x46fb70[_0x102e99(0x1f6)]({'text':_0x102e99(0x213)+_0x408ca3['botID'],'callback_data':_0x408ca3[_0x102e99(0x193)]}),_0x40d656%_0x5e3443==0x0&&(_0x26843a[_0x22fe79]=_0x46fb70,_0x22fe79++);}),tgBot[_0x1c9935(0x194)](_0x3a73f3[_0x1c9935(0x2a5)]['id'],_0x1c9935(0x2a3),{'reply_markup':{'inline_keyboard':_0x26843a}})['catch'](_0x196975=>{telegramError(_0x196975);}),tgBot['on']('callback_query',async _0x458554=>{const _0x4134d3=_0x1c9935,_0x1ba965=_0x458554[_0x4134d3(0x294)],_0x4ab23f=_0x458554[_0x4134d3(0x285)];tgBot[_0x4134d3(0x1d8)](_0x458554['id'])[_0x4134d3(0x29a)](async()=>{const _0x2a8e5e=_0x4134d3;if(pid[_0x1ba965])pid[_0x1ba965][_0x2a8e5e(0x30a)]({'function':_0x2a8e5e(0x1b9),'args':null});}),tgBot[_0x4134d3(0x32e)](_0x4134d3(0x1bb));});}else{const _0xb6bea8=_0x119b21[0x0][_0x1c9935(0x193)];if(pid[_0xb6bea8])pid[_0xb6bea8][_0x1c9935(0x30a)]({'function':_0x1c9935(0x1b9),'args':null});}}}),tgBot[_0x16e5d7(0x267)](/\/portfolio/,_0x4386e2=>{const _0x22792c=_0x16e5d7;if(!validateTelegram(_0x4386e2))return;tgBot[_0x22792c(0x32e)](_0x22792c(0x1bb));const _0x882430=getEnabledBots();if(_0x882430['length']==0x0)tgBot[_0x22792c(0x194)](_0x4386e2[_0x22792c(0x2a5)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x22792c(0x19d)](_0x8b216d=>{telegramError(_0x8b216d);});else{if(_0x882430[_0x22792c(0x246)]>0x1){let _0x277e84=[],_0x22c0d9=[];const _0x2ab291=_0x882430[_0x22792c(0x246)]%0x4==0x0||_0x882430[_0x22792c(0x246)]%0x4==0x3||_0x882430[_0x22792c(0x246)]%0x3==0x1?0x4:0x3;let _0x5f3a69=0x0;_0x882430['forEach']((_0x45275f,_0x4b0be5)=>{const _0x587440=_0x22792c;if(_0x4b0be5%_0x2ab291==0x0)_0x22c0d9=[];_0x22c0d9[_0x587440(0x1f6)]({'text':_0x587440(0x213)+_0x45275f['botID'],'callback_data':_0x45275f['botID']}),_0x4b0be5%_0x2ab291==0x0&&(_0x277e84[_0x5f3a69]=_0x22c0d9,_0x5f3a69++);}),tgBot['sendMessage'](_0x4386e2[_0x22792c(0x2a5)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x277e84}})[_0x22792c(0x19d)](_0x2e291f=>{telegramError(_0x2e291f);}),tgBot['on'](_0x22792c(0x1bb),async _0x49fdb7=>{const _0x3e994f=_0x22792c,_0x28da36=_0x49fdb7['data'],_0x34cb67=_0x49fdb7['message'];tgBot[_0x3e994f(0x1d8)](_0x49fdb7['id'])['then'](async()=>{const _0x4a7861=_0x3e994f;if(pid[_0x28da36])pid[_0x28da36][_0x4a7861(0x30a)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x3e994f(0x32e)](_0x3e994f(0x1bb));});}else{const _0x279409=_0x882430[0x0]['botID'];if(pid[_0x279409])pid[_0x279409]['send']({'function':_0x22792c(0x2d8),'args':null});}}}),tgBot[_0x16e5d7(0x267)](/\/update/,async _0x4c0321=>{const _0x5d91c1=_0x16e5d7;if(!validateTelegram(_0x4c0321))return;tgBot[_0x5d91c1(0x32e)](_0x5d91c1(0x1bb)),await getMessages();if(!updateAvailable)tgBot[_0x5d91c1(0x194)](_0x4c0321[_0x5d91c1(0x2a5)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x5d91c1(0x19d)](_0x41e581=>{telegramError(_0x41e581);});else!validInstallation?tgBot[_0x5d91c1(0x194)](_0x4c0321['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x5d91c1(0x19d)](_0x297913=>{telegramError(_0x297913);}):(tgBot[_0x5d91c1(0x194)](_0x4c0321[_0x5d91c1(0x2a5)]['id'],_0x5d91c1(0x31e),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x5d91c1(0x19d)](_0x42e05c=>{telegramError(_0x42e05c);}),tgBot['on'](_0x5d91c1(0x1bb),async _0x3f86b6=>{const _0x3631d1=_0x5d91c1,_0x464afe=_0x3f86b6[_0x3631d1(0x294)],_0x2d2ba1=_0x3f86b6[_0x3631d1(0x285)];tgBot['answerCallbackQuery'](_0x3f86b6['id'])['then'](async()=>{const _0x41a2d2=_0x3631d1;_0x464afe==_0x41a2d2(0x23c)&&(await tgBot[_0x41a2d2(0x194)](_0x2d2ba1[_0x41a2d2(0x2a5)]['id'],_0x41a2d2(0x228))[_0x41a2d2(0x19d)](_0xc0b832=>{telegramError(_0xc0b832);}),updateBB(_0x41a2d2(0x257))),_0x464afe=='no'&&await tgBot['sendMessage'](_0x2d2ba1[_0x41a2d2(0x2a5)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x41a2d2(0x19d)](_0x532920=>{telegramError(_0x532920);});}),tgBot['removeListener'](_0x3631d1(0x1bb));}));}),tgBot[_0x16e5d7(0x267)](/\/reinstall/,async _0x15ff32=>{const _0x5293d6=_0x16e5d7;if(!validateTelegram(_0x15ff32))return;tgBot[_0x5293d6(0x32e)](_0x5293d6(0x1bb)),!validInstallation?tgBot[_0x5293d6(0x194)](_0x15ff32[_0x5293d6(0x2a5)]['id'],_0x5293d6(0x349))[_0x5293d6(0x19d)](_0x2984be=>{telegramError(_0x2984be);}):(tgBot[_0x5293d6(0x194)](_0x15ff32[_0x5293d6(0x2a5)]['id'],_0x5293d6(0x302),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x5293d6(0x23c)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x509629=>{telegramError(_0x509629);}),tgBot['on'](_0x5293d6(0x1bb),async _0x2aff71=>{const _0x38de1c=_0x5293d6,_0x4f226d=_0x2aff71[_0x38de1c(0x294)],_0xd2e015=_0x2aff71['message'];tgBot['answerCallbackQuery'](_0x2aff71['id'])[_0x38de1c(0x29a)](async()=>{const _0x159850=_0x38de1c;_0x4f226d==_0x159850(0x23c)&&(await tgBot[_0x159850(0x194)](_0xd2e015[_0x159850(0x2a5)]['id'],_0x159850(0x1a5))['catch'](_0x4905eb=>{telegramError(_0x4905eb);}),updateBB(_0x159850(0x293))),_0x4f226d=='no'&&await tgBot[_0x159850(0x194)](_0xd2e015[_0x159850(0x2a5)]['id'],_0x159850(0x1fd))[_0x159850(0x19d)](_0x2e5d56=>{telegramError(_0x2e5d56);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x16e5d7(0x267)](/\/toggle/,_0x226321=>{const _0x334a81=_0x16e5d7;if(!validateTelegram(_0x226321))return;tgBot['removeListener'](_0x334a81(0x1bb));const _0x305e0d=getBotsWithMode();if(_0x305e0d['length']==0x0)tgBot[_0x334a81(0x194)](_0x226321[_0x334a81(0x2a5)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x334a81(0x19d)](_0x2d361e=>{telegramError(_0x2d361e);});else{let _0x1484a1=[],_0x405123=[];const _0x591517=0x2;let _0x34a6e7=0x0;_0x305e0d['forEach']((_0x1e2f1a,_0xb1237)=>{const _0x1cf662=_0x334a81;if(_0xb1237%_0x591517==0x0)_0x405123=[];_0x405123[_0x1cf662(0x1f6)]({'text':_0x1cf662(0x213)+_0x1e2f1a[_0x1cf662(0x193)]+'\x20('+_0x1e2f1a[_0x1cf662(0x2e6)]+')','callback_data':_0x1e2f1a[_0x1cf662(0x193)]}),_0xb1237%_0x591517==0x0&&(_0x1484a1[_0x34a6e7]=_0x405123,_0x34a6e7++);}),tgBot[_0x334a81(0x194)](_0x226321[_0x334a81(0x2a5)]['id'],_0x334a81(0x321),{'reply_markup':{'inline_keyboard':_0x1484a1}})[_0x334a81(0x19d)](_0x221a3f=>{telegramError(_0x221a3f);}),tgBot['on']('callback_query',async _0x233535=>{const _0x1b36ab=_0x334a81,_0x566f88=_0x233535['data'],_0x1f9b6b=_0x233535[_0x1b36ab(0x285)];tgBot[_0x1b36ab(0x1d8)](_0x233535['id'])[_0x1b36ab(0x29a)](async()=>{const _0x4133df=_0x1b36ab,_0x55b911=_0x305e0d[_0x4133df(0x30c)](_0x54c3bc=>_0x54c3bc[_0x4133df(0x193)]==_0x566f88),_0x572148=_0x55b911[_0x4133df(0x2e6)]==_0x4133df(0x215)?_0x4133df(0x287):_0x4133df(0x215);tgBot[_0x4133df(0x194)](_0x1f9b6b[_0x4133df(0x2a5)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x566f88+_0x4133df(0x292)+_0x572148+_0x4133df(0x265))[_0x4133df(0x19d)](_0x4508ec=>{telegramError(_0x4508ec);}),toggleBotMode(_0x566f88);}),tgBot['removeListener'](_0x1b36ab(0x1bb));});}}),tgBot[_0x16e5d7(0x267)](/\/names/,_0xfaea4e=>{const _0x323335=_0x16e5d7;if(!validateTelegram(_0xfaea4e))return;let _0x2da28c='';config['forEach'](_0x5842a5=>{const _0xe87698=_0x2805;_0x2da28c+=_0xe87698(0x213)+_0x5842a5['botID']+':\x20'+_0x5842a5[_0xe87698(0x282)]+'\x0a';}),tgBot[_0x323335(0x194)](_0xfaea4e[_0x323335(0x2a5)]['id'],_0x2da28c,{'parse_mode':_0x323335(0x2c6)})[_0x323335(0x19d)](_0x2843b8=>{telegramError(_0x2843b8);});}),tgBot[_0x16e5d7(0x267)](/\/disable/,_0x4f7718=>{const _0x10310e=_0x16e5d7;if(!validateTelegram(_0x4f7718))return;tgBot[_0x10310e(0x194)](_0x4f7718['chat']['id'],_0x10310e(0x1c4))[_0x10310e(0x19d)](_0x50b82b=>{telegramError(_0x50b82b);}),updateSetting(_0x10310e(0x269),![]);}),tgBot[_0x16e5d7(0x267)](/\/help/,_0x150113=>{const _0x35540b=_0x16e5d7;if(!validateTelegram(_0x150113))return;tgBot['sendMessage'](_0x150113[_0x35540b(0x2a5)]['id'],_0x16a036)['catch'](_0x13c094=>{telegramError(_0x13c094);});}),tgBot['on'](_0x16e5d7(0x21c),_0x33234c=>{const _0x1e5f8e=_0x16e5d7;_0x33234c[_0x1e5f8e(0x258)]()[_0x1e5f8e(0x226)](_0x1e5f8e(0x25e))&&(logger[_0x1e5f8e(0x20c)](_0x1e5f8e(0x1fe)),tgBot[_0x1e5f8e(0x199)](),tgBot=null,io['to'](_0x1e5f8e(0x2f7))[_0x1e5f8e(0x256)](_0x1e5f8e(0x350),_0x1e5f8e(0x1fe)));}),process['once'](_0x16e5d7(0x2db),()=>{const _0x264ae3=_0x16e5d7;if(tgBot)tgBot[_0x264ae3(0x199)]();process[_0x264ae3(0x356)](0x1);}),process[_0x16e5d7(0x281)](_0x16e5d7(0x19c),()=>{const _0x1d5936=_0x16e5d7;if(tgBot)tgBot[_0x1d5936(0x199)]();process[_0x1d5936(0x356)](0x1);});}}function disableTelegram(){const _0xa00bd8=_0x31d996;tgBot&&(tgBot[_0xa00bd8(0x199)](),tgBot=null);}function sendTelegram(_0x5d456a,_0x4833ac){const _0x361cf6=_0x31d996;if(settings[_0x361cf6(0x269)]){if(settings[_0x361cf6(0x1aa)]==_0x361cf6(0x308)||(_0x4833ac[_0x361cf6(0x1e9)]==_0x361cf6(0x305)||_0x4833ac['type']==_0x361cf6(0x298)||_0x4833ac[_0x361cf6(0x1e9)]==_0x361cf6(0x2b6))&&settings[_0x361cf6(0x1aa)]=='alerts'||_0x4833ac['type']==_0x361cf6(0x1ff)&&settings['telegramEvents']==_0x361cf6(0x2a0)){if(tgBot&&settings['telegramChatId']){if(_0x4833ac[_0x361cf6(0x207)])tgBot[_0x361cf6(0x194)](settings[_0x361cf6(0x232)],_0x4833ac['botname']+'\x20>\x20'+_0x4833ac[_0x361cf6(0x25a)])[_0x361cf6(0x19d)](_0x5d79=>{telegramError(_0x5d79);});else tgBot[_0x361cf6(0x194)](settings[_0x361cf6(0x232)],_0x361cf6(0x213)+_0x5d456a+_0x361cf6(0x24a)+_0x4833ac['event'])[_0x361cf6(0x19d)](_0x571fda=>{telegramError(_0x571fda);});}}}}async function sendTelegramMsg(_0xa41e80,_0x3e61b4=_0x31d996(0x2c6)){const _0x3bac79=_0x31d996;return settings[_0x3bac79(0x269)]&&tgBot&&settings[_0x3bac79(0x232)]?(await tgBot[_0x3bac79(0x194)](settings['telegramChatId'],_0xa41e80,{'parse_mode':_0x3e61b4})[_0x3bac79(0x19d)](_0x20ee93=>{telegramError(_0x20ee93);}),!![]):![];}function getDeviceWithIp(_0x98a675){const _0x1ca232=_0x31d996;return devices[_0x1ca232(0x30c)](_0xc16259=>_0xc16259['ip']===_0x98a675);}function temporaryAccess2FA(_0x464866,_0x58bc65){const _0x4976f5=_0x31d996;let _0x2e4215=new Date(),_0x5af530=![];if(lastIpApproval){if(_0x2e4215-lastIpApproval<0x1388)_0x5af530=!![];}lastIpApproval=new Date();if(_0x5af530)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings['telegramChatId'],_0x4976f5(0x2f5)+normalizeIP(_0x58bc65)[_0x4976f5(0x30d)]+_0x4976f5(0x2d9),{'parse_mode':_0x4976f5(0x2c6),'reply_markup':{'inline_keyboard':[[{'text':_0x4976f5(0x22e),'callback_data':'5'},{'text':_0x4976f5(0x2b9),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x4976f5(0x1c7),'callback_data':_0x4976f5(0x1c7)}]]}})[_0x4976f5(0x19d)](_0x2eb9fb=>{telegramError(_0x2eb9fb);}),tgBot['on'](_0x4976f5(0x1bb),async _0x43f7e3=>{const _0x1920fb=_0x4976f5,_0x4b82bb=_0x43f7e3[_0x1920fb(0x294)],_0x2a4456=_0x43f7e3[_0x1920fb(0x285)];tgBot[_0x1920fb(0x1d8)](_0x43f7e3['id'])['then'](async()=>{const _0x5bffc7=_0x1920fb;devices[_0x464866][_0x5bffc7(0x1fb)]={'clientip':_0x58bc65,'timestamp':new Date()[_0x5bffc7(0x247)](),'expiry':_0x4b82bb},_0x4b82bb!=_0x5bffc7(0x1c7)?(await tgBot[_0x5bffc7(0x194)](_0x2a4456['chat']['id'],_0x5bffc7(0x29d)+_0x4b82bb+_0x5bffc7(0x19a),{'parse_mode':_0x5bffc7(0x2c6)})['catch'](_0x1763fb=>{telegramError(_0x1763fb);}),io['to'](_0x464866)[_0x5bffc7(0x256)](_0x5bffc7(0x2bc),{'access':{'allow':![],'reason':_0x5bffc7(0x1db),'token':null}})):(await tgBot[_0x5bffc7(0x194)](_0x2a4456[_0x5bffc7(0x2a5)]['id'],'Temporary\x20access\x20rejected')[_0x5bffc7(0x19d)](_0x230432=>{telegramError(_0x230432);}),io['to'](_0x464866)[_0x5bffc7(0x256)]('status',{'access':{'allow':![],'reason':_0x5bffc7(0x1ac),'token':null}}));}),tgBot[_0x1920fb(0x32e)]('callback_query');}));}function loginAccess2FA(_0x32cc73,_0x17f4e0){const _0x25c554=_0x31d996;tgBot&&settings['telegramChatId']&&(tgBot[_0x25c554(0x32e)](_0x25c554(0x1bb)),tgBot[_0x25c554(0x194)](settings[_0x25c554(0x232)],_0x25c554(0x1ce)+normalizeIP(_0x17f4e0)[_0x25c554(0x30d)]+_0x25c554(0x2d9),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x25c554(0x2c5),'callback_data':loginExpiry},{'text':_0x25c554(0x1c7),'callback_data':_0x25c554(0x1c7)}]]}})[_0x25c554(0x19d)](_0x1a0ea7=>{telegramError(_0x1a0ea7);}),tgBot['on'](_0x25c554(0x1bb),async _0x2ec349=>{const _0x24245c=_0x25c554,_0x1dfff2=_0x2ec349['data'],_0x1efc9d=_0x2ec349[_0x24245c(0x285)];tgBot[_0x24245c(0x1d8)](_0x2ec349['id'])['then'](async()=>{const _0x4bfcfe=_0x24245c;devices[_0x32cc73]['telegram2FaApproval']={'clientip':_0x17f4e0,'timestamp':new Date()[_0x4bfcfe(0x247)](),'expiry':_0x1dfff2},_0x1dfff2!='reject'?(await tgBot[_0x4bfcfe(0x194)](_0x1efc9d['chat']['id'],'Login\x20accepted',{'parse_mode':_0x4bfcfe(0x2c6)})[_0x4bfcfe(0x19d)](_0x321858=>{telegramError(_0x321858);}),io['to'](_0x32cc73)[_0x4bfcfe(0x256)](_0x4bfcfe(0x2bc),{'access':{'allow':![],'reason':_0x4bfcfe(0x1db),'token':null}})):(await tgBot[_0x4bfcfe(0x194)](_0x1efc9d[_0x4bfcfe(0x2a5)]['id'],'Login\x20rejected')[_0x4bfcfe(0x19d)](_0x1903ad=>{telegramError(_0x1903ad);}),io['to'](_0x32cc73)[_0x4bfcfe(0x256)](_0x4bfcfe(0x2bc),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x24245c(0x32e)](_0x24245c(0x1bb));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x11c390=_0x31d996;return dbConfig[_0x11c390(0x362)]('bots')['sortBy'](_0x11c390(0x193))[_0x11c390(0x2c8)]({'status':_0x11c390(0x325)})['value']()||[];}function getDisabledBots(){const _0x5bfd3f=_0x31d996;return dbConfig[_0x5bfd3f(0x362)](_0x5bfd3f(0x1a8))['sortBy']('botID')['filter']({'status':_0x5bfd3f(0x283)})['value']()||[];}function getBotAttributes(_0x1ed080){const _0x16e2d8=_0x31d996;let _0x49ac09={};const _0x1ce192=configpath+'bot-'+_0x1ed080+'-config.json',_0x25907b=fs['existsSync'](_0x1ce192);if(_0x25907b){const _0x5157da=fs[_0x16e2d8(0x234)](_0x1ce192);try{const _0x5c7e04=JSON[_0x16e2d8(0x341)](_0x5157da),_0x234a24=_0x5c7e04?_0x5c7e04[_0x16e2d8(0x332)][0x0][_0x16e2d8(0x1e0)]:![];_0x49ac09[_0x16e2d8(0x2e6)]=_0x234a24?'auto':_0x16e2d8(0x287),_0x49ac09[_0x16e2d8(0x282)]=_0x5c7e04?_0x5c7e04[_0x16e2d8(0x332)][0x0][_0x16e2d8(0x282)]:_0x16e2d8(0x213)+_0x1ed080;}catch(_0x4212bd){_0x49ac09[_0x16e2d8(0x2e6)]=_0x16e2d8(0x287),_0x49ac09[_0x16e2d8(0x282)]='Bot\x20'+_0x1ed080;}}else _0x49ac09[_0x16e2d8(0x2e6)]=_0x16e2d8(0x287),_0x49ac09[_0x16e2d8(0x282)]=_0x16e2d8(0x213)+_0x1ed080;return _0x49ac09;}function getBotsWithMode(){const _0x5cb515=_0x31d996,_0x113bce=dbConfig[_0x5cb515(0x362)]('bots')[_0x5cb515(0x2d0)](_0x5cb515(0x193))['value']()||[];return _0x113bce[_0x5cb515(0x357)](_0xf33cf2=>{const _0x8bd2d9=_0x5cb515;let _0x567c39=getBotAttributes(_0xf33cf2['botID']);_0xf33cf2[_0x8bd2d9(0x2e6)]=_0x567c39['mode'];}),_0x113bce;}function getBotExchanges(){const _0x2643e7=_0x31d996;let _0x11f1e0=[];const _0x31884d=dbConfig['get'](_0x2643e7(0x1a8))[_0x2643e7(0x2d0)]('botID')['value']()||[];_0x31884d['forEach'](_0x1af7ba=>{const _0x2b0022=_0x2643e7;if(_0x1af7ba['status']==_0x2b0022(0x325)){const _0x5ece2b=configpath+_0x2b0022(0x19f)+_0x1af7ba[_0x2b0022(0x193)]+_0x2b0022(0x2e1),_0x145771=fs[_0x2b0022(0x2f9)](_0x5ece2b);let _0x2b05ca;if(_0x145771){const _0x1289cd=fs[_0x2b0022(0x234)](_0x5ece2b);try{const _0x112239=JSON[_0x2b0022(0x341)](_0x1289cd);_0x2b05ca=_0x112239?_0x112239[_0x2b0022(0x332)][0x0]['exchange']:null;}catch(_0x2ff4ba){}}if(_0x2b05ca)_0x11f1e0[_0x2b0022(0x1f6)](_0x2b05ca);}});const _0x177f81=[...new Set(_0x11f1e0)][_0x2643e7(0x35c)]();return _0x177f81;}async function initUser(){const _0x29ee7a=_0x31d996;if(!settings['userid']){const _0x59ad66=uuidRandom();mixpanel[_0x29ee7a(0x2a4)](_0x59ad66),updateSetting(_0x29ee7a(0x1a0),_0x59ad66);}}async function initSecure(){const _0x359f37=_0x31d996;let _0x4e555d=getSecure();if(!_0x4e555d[_0x359f37(0x244)](_0x359f37(0x250))){let _0x220557=await generateKeys();_0x4e555d[_0x359f37(0x1fa)]=_0x220557[_0x359f37(0x1fa)],_0x4e555d[_0x359f37(0x2af)]=_0x220557['privateKey'],_0x4e555d[_0x359f37(0x250)]=crypto['randomBytes'](0x20)[_0x359f37(0x258)](_0x359f37(0x1d7));;storeSecure(_0x4e555d);}}function getSettings(){const _0x2a0d24=_0x31d996;return dbSettings[_0x2a0d24(0x362)]('settings')['value']()||{};}function getSecure(){const _0x3f642b=_0x31d996;return dbSecure[_0x3f642b(0x362)](_0x3f642b(0x2dc))[_0x3f642b(0x28d)]()||{};}function getBlacklist(){const _0x991cfe=_0x31d996;return dbSecure['get'](_0x991cfe(0x351))[_0x991cfe(0x28d)]()||[];}function broadcastToBots(_0xe4da4,_0x2dacbc){const _0x453c35=_0x31d996;config[_0x453c35(0x357)](_0x23845c=>{const _0x3f4f8d=_0x453c35;if(_0x23845c[_0x3f4f8d(0x2bc)]==_0x3f4f8d(0x325)&&_0x23845c[_0x3f4f8d(0x289)]==_0x3f4f8d(0x324)||_0x23845c[_0x3f4f8d(0x2bc)]==_0x3f4f8d(0x29f)&&_0x23845c[_0x3f4f8d(0x289)]==_0x3f4f8d(0x324)){if(pid[_0x23845c[_0x3f4f8d(0x193)]])pid[_0x23845c[_0x3f4f8d(0x193)]]['send']({[_0xe4da4]:_0x2dacbc});}});}function storeSettings(_0x37f538,_0x1119d5=![]){const _0x1ca1d5=_0x31d996;_0x37f538={...settings,..._0x37f538};if(_0x1119d5&&_0x37f538[_0x1ca1d5(0x291)]!=_0x1ca1d5(0x27c)&&_0x37f538[_0x1ca1d5(0x291)]!=_0x1ca1d5(0x310)&&_0x37f538[_0x1ca1d5(0x291)]!=''){const _0x4ce98a=crypt[_0x1ca1d5(0x358)](secure[_0x1ca1d5(0x2af)],_0x37f538['bbPassword'])[_0x1ca1d5(0x285)][_0x1ca1d5(0x31d)]('@')[0x0],_0x3e4e3b=bcrypt[_0x1ca1d5(0x243)](_0x4ce98a,saltRounds);_0x37f538={..._0x37f538,'bbPassword':_0x3e4e3b};}if(_0x1119d5&&_0x37f538[_0x1ca1d5(0x2ac)]!='************'&&_0x37f538[_0x1ca1d5(0x2ac)]!=_0x1ca1d5(0x310)&&_0x37f538[_0x1ca1d5(0x2ac)]!=''){const _0x362385=crypt[_0x1ca1d5(0x358)](secure[_0x1ca1d5(0x2af)],_0x37f538[_0x1ca1d5(0x2ac)])[_0x1ca1d5(0x285)][_0x1ca1d5(0x31d)]('@')[0x0];_0x37f538={..._0x37f538,'telegramToken':_0x362385};}const _0xffc40f=_0x37f538[_0x1ca1d5(0x2ac)]!=_0x1ca1d5(0x27c)&&_0x37f538[_0x1ca1d5(0x2ac)]!=settings['telegramToken']||_0x37f538[_0x1ca1d5(0x345)]!=settings['telegramUsername'],_0xc6f6ae=_0x37f538['telegramToken']==''||_0x37f538[_0x1ca1d5(0x345)]=='';if(_0xffc40f)_0x37f538[_0x1ca1d5(0x1aa)]=_0x1ca1d5(0x308);for(const [_0x49eed8,_0x4f7714]of Object[_0x1ca1d5(0x239)](_0x37f538)){if(_0x49eed8=='telegramToken'&&_0x4f7714==_0x1ca1d5(0x27c)){_0x37f538['telegramToken']=settings[_0x1ca1d5(0x2ac)];continue;};if(_0x49eed8==_0x1ca1d5(0x291)&&_0x4f7714==_0x1ca1d5(0x27c)){_0x37f538[_0x1ca1d5(0x291)]=settings[_0x1ca1d5(0x291)];continue;};dbSettings['set'](_0x1ca1d5(0x29e)+_0x49eed8,_0x4f7714)[_0x1ca1d5(0x20a)]();}settings=_0x37f538,io['to'](_0x1ca1d5(0x2f7))[_0x1ca1d5(0x256)]('settings',cleanSettings()),broadcastToBots(_0x1ca1d5(0x2f6),settings[_0x1ca1d5(0x2f6)]),broadcastToBots('onepagemode',settings['onepagemode']);if(_0xffc40f&&!_0xc6f6ae)initTelegram();if(_0xffc40f&&_0xc6f6ae)disableTelegram();getAllClients()[_0x1ca1d5(0x357)](_0x428289=>{const _0x3ce0ec=_0x1ca1d5;getSocket(_0x428289['id'])[_0x3ce0ec(0x256)](_0x3ce0ec(0x2bc),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x495055,_0x36e8e3){const _0x5a5cab=_0x31d996;dbSettings['set'](_0x5a5cab(0x29e)+_0x495055,_0x36e8e3)[_0x5a5cab(0x20a)](),settings=getSettings(),io['to'](_0x5a5cab(0x2f7))[_0x5a5cab(0x256)](_0x5a5cab(0x2fd),cleanSettings());}function storeSecure(_0x5556ea){const _0x36fad2=_0x31d996;dbSecure[_0x36fad2(0x362)](_0x36fad2(0x2dc))['push'](_0x5556ea)[_0x36fad2(0x20a)](),secure=_0x5556ea;}function addBlacklist(_0x437244){const _0xf65ac0=_0x31d996;cleanBlacklist();let _0xbb780a;devices[_0x437244][_0xf65ac0(0x1fb)]?_0xbb780a=Math['max'](devices[_0x437244][_0xf65ac0(0x1fb)]['expiry'],loginExpiry):_0xbb780a=loginExpiry,dbSecure[_0xf65ac0(0x362)](_0xf65ac0(0x351))[_0xf65ac0(0x1f6)]({'expiry':new Date()[_0xf65ac0(0x247)]()+_0xbb780a*0x3c*0x3e8,'token':devices[_0x437244]['access']['token']})[_0xf65ac0(0x20a)](),blacklist=dbSecure[_0xf65ac0(0x362)]('blacklist')[_0xf65ac0(0x28d)]();}function cleanBlacklist(){const _0x451d6f=_0x31d996;let _0x1097f1=dbSecure[_0x451d6f(0x362)]('blacklist')['cloneDeep']()[_0x451d6f(0x28d)](),_0x51f8ae=new Date()['getTime']();_0x1097f1['forEach'](_0x5285f6=>{const _0x466f44=_0x451d6f;_0x5285f6[_0x466f44(0x272)]<_0x51f8ae&&dbSecure[_0x466f44(0x362)](_0x466f44(0x351))[_0x466f44(0x218)]({'expiry':_0x5285f6[_0x466f44(0x272)]})[_0x466f44(0x20a)]();});}function initStates(){let _0x2fb178=getConfiguration();_0x2fb178['forEach'](_0x534758=>{const _0xb47c58=_0x2805;_0x534758[_0xb47c58(0x289)]=_0xb47c58(0x196);}),storeConfiguration(_0x2fb178);}function onKeys(){const _0x3ab1e9=new RSA();return new Promise(_0x52f6b6=>{_0x3ab1e9['generateKeyPairAsync']()['then'](_0x585f8f=>{_0x52f6b6(_0x585f8f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0xff2157=_0x31d996;let _0x30ce3=getSettings(),_0x35b159=![];!_0x30ce3[_0xff2157(0x244)](_0xff2157(0x255))&&(_0x30ce3[_0xff2157(0x255)]=0x0,_0x35b159=!![]);!_0x30ce3[_0xff2157(0x244)](_0xff2157(0x2a7))&&(_0x30ce3[_0xff2157(0x2a7)]=0x0,_0x35b159=!![]);!_0x30ce3[_0xff2157(0x244)]('latestversion')&&(_0x30ce3['latestversion']=_0xff2157(0x240),_0x35b159=!![]);!_0x30ce3[_0xff2157(0x244)](_0xff2157(0x1cc))&&(_0x30ce3[_0xff2157(0x1cc)]=![],_0x35b159=!![]);if(_0x35b159)storeSettings(_0x30ce3);try{fs[_0xff2157(0x353)](configbackuppath,{'withFileTypes':!![]})[_0xff2157(0x357)](_0x8d7d77=>{const _0xca4f5d=_0xff2157;if(!_0x8d7d77[_0xca4f5d(0x1d1)]()){if(!_0x8d7d77[_0xca4f5d(0x2d4)][_0xca4f5d(0x278)](_0xca4f5d(0x2a8)))fs[_0xca4f5d(0x280)](configbackuppath+_0x8d7d77[_0xca4f5d(0x2d4)]);}else fs['rmSync'](configbackuppath+_0x8d7d77[_0xca4f5d(0x2d4)],{'recursive':!![]});});}catch(_0x1236eb){logger[_0xff2157(0x303)](_0xff2157(0x1eb),_0x1236eb);}}function storeConfiguration(_0x1fd49a){const _0x57869c=_0x31d996;dbConfig[_0x57869c(0x362)](_0x57869c(0x1a8))[_0x57869c(0x218)]()[_0x57869c(0x20a)](),_0x1fd49a['forEach'](_0x3abeb5=>{const _0x2a1eb5=_0x57869c;delete _0x3abeb5[_0x2a1eb5(0x2e6)];}),dbConfig[_0x57869c(0x362)](_0x57869c(0x1a8))['push'](..._0x1fd49a)[_0x57869c(0x20a)](),config=_0x1fd49a;}function resetPassword(){const _0x162c1d=_0x31d996;tgBot&&settings[_0x162c1d(0x232)]&&(tgBot[_0x162c1d(0x32e)](_0x162c1d(0x1bb)),tgBot[_0x162c1d(0x194)](settings[_0x162c1d(0x232)],_0x162c1d(0x320),{'parse_mode':_0x162c1d(0x2c6),'reply_markup':{'inline_keyboard':[[{'text':_0x162c1d(0x23c),'callback_data':_0x162c1d(0x23c)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x13917f=>{telegramError(_0x13917f);}),tgBot['on']('callback_query',async _0x19db9f=>{const _0x3e7db3=_0x162c1d,_0x404f05=_0x19db9f[_0x3e7db3(0x294)],_0x5741cf=_0x19db9f['message'];tgBot[_0x3e7db3(0x1d8)](_0x19db9f['id'])[_0x3e7db3(0x29a)](async()=>{const _0x5aabdc=_0x3e7db3;if(_0x404f05!='no'){const _0x48682f=0xf,_0x43123b=_0x5aabdc(0x301),_0x51d551=Array[_0x5aabdc(0x34a)](crypto['randomFillSync'](new Uint32Array(_0x48682f)))[_0x5aabdc(0x340)](_0x189ffa=>_0x43123b[_0x189ffa%_0x43123b['length']])[_0x5aabdc(0x24c)](''),_0x247240=bcrypt[_0x5aabdc(0x243)](_0x51d551,saltRounds);storeSettings({'bbPassword':_0x247240}),await tgBot[_0x5aabdc(0x194)](_0x5741cf[_0x5aabdc(0x2a5)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x51d551,{'parse_mode':_0x5aabdc(0x2c6)})[_0x5aabdc(0x19d)](_0x58f928=>{telegramError(_0x58f928);});}else await tgBot['sendMessage'](_0x5741cf[_0x5aabdc(0x2a5)]['id'],'Password\x20reset\x20rejected')['catch'](_0x3791cf=>{telegramError(_0x3791cf);});}),tgBot['removeListener'](_0x3e7db3(0x1bb));}));}async function confirmRestore(_0x433ea6,_0x2bb6f3){const _0x4bf19d=_0x31d996;io['to'](_0x4bf19d(0x2f7))[_0x4bf19d(0x256)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x4bf19d(0x2b6)),tgBot&&settings[_0x4bf19d(0x232)]&&(tgBot[_0x4bf19d(0x32e)](_0x4bf19d(0x1bb)),await tgBot[_0x4bf19d(0x194)](settings[_0x4bf19d(0x232)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x4bf19d(0x2c6),'reply_markup':{'inline_keyboard':[[{'text':_0x4bf19d(0x23c),'callback_data':_0x4bf19d(0x23c)},{'text':'no','callback_data':'no'}]]}})[_0x4bf19d(0x19d)](_0x15f8c7=>{telegramError(_0x15f8c7);}),tgBot['on'](_0x4bf19d(0x1bb),async _0x24f8a7=>{const _0x51c4a6=_0x4bf19d,_0x53f20d=_0x24f8a7['data'],_0x48f490=_0x24f8a7[_0x51c4a6(0x285)];tgBot['answerCallbackQuery'](_0x24f8a7['id'])[_0x51c4a6(0x29a)](async()=>{const _0xb2a230=_0x51c4a6;_0x53f20d==_0xb2a230(0x23c)?(await tgBot[_0xb2a230(0x194)](_0x48f490[_0xb2a230(0x2a5)]['id'],_0xb2a230(0x1a9),{'parse_mode':_0xb2a230(0x2c6)})[_0xb2a230(0x19d)](_0x5a875a=>{telegramError(_0x5a875a);}),unzipFile(_0x433ea6,_0x2bb6f3)):(logger['debug'](_0xb2a230(0x23a)),await tgBot['sendMessage'](_0x48f490[_0xb2a230(0x2a5)]['id'],'Restore\x20process\x20aborted')[_0xb2a230(0x19d)](_0x2637de=>{telegramError(_0x2637de);}));}),tgBot['removeListener'](_0x51c4a6(0x1bb));}));}function getServerTime(){const _0x465fb0=_0x31d996,_0x1a12b1=new Date();return _0x1a12b1[_0x465fb0(0x18f)]()+'/'+(_0x1a12b1['getMonth']()+0x1)[_0x465fb0(0x258)]()[_0x465fb0(0x2a9)](0x2,'0')+'/'+_0x1a12b1[_0x465fb0(0x190)]()['toString']()[_0x465fb0(0x2a9)](0x2,'0')+'\x20'+_0x1a12b1['getHours']()[_0x465fb0(0x258)]()[_0x465fb0(0x2a9)](0x2,'0')+':'+_0x1a12b1[_0x465fb0(0x1e1)]()[_0x465fb0(0x258)]()['padStart'](0x2,'0')+':'+_0x1a12b1[_0x465fb0(0x1a7)]()[_0x465fb0(0x258)]()[_0x465fb0(0x2a9)](0x2,'0');}function getTimeStamp(){const _0xcee95d=_0x31d996,_0x16bcca=shiftedTime();return _0x16bcca[_0xcee95d(0x18f)]()+'/'+(_0x16bcca[_0xcee95d(0x36b)]()+0x1)[_0xcee95d(0x258)]()[_0xcee95d(0x2a9)](0x2,'0')+'/'+_0x16bcca[_0xcee95d(0x190)]()[_0xcee95d(0x258)]()[_0xcee95d(0x2a9)](0x2,'0')+'\x20'+_0x16bcca[_0xcee95d(0x2de)]()[_0xcee95d(0x258)]()[_0xcee95d(0x2a9)](0x2,'0')+':'+_0x16bcca[_0xcee95d(0x1e1)]()['toString']()[_0xcee95d(0x2a9)](0x2,'0')+':'+_0x16bcca[_0xcee95d(0x1a7)]()[_0xcee95d(0x258)]()[_0xcee95d(0x2a9)](0x2,'0');}function getCleanTimeStamp(){const _0x36c377=_0x31d996,_0x324ac5=shiftedTime();return _0x324ac5[_0x36c377(0x18f)]()+(_0x324ac5[_0x36c377(0x36b)]()+0x1)[_0x36c377(0x258)]()[_0x36c377(0x2a9)](0x2,'0')+_0x324ac5[_0x36c377(0x190)]()['toString']()[_0x36c377(0x2a9)](0x2,'0')+'-'+_0x324ac5[_0x36c377(0x2de)]()['toString']()['padStart'](0x2,'0')+_0x324ac5[_0x36c377(0x1e1)]()[_0x36c377(0x258)]()['padStart'](0x2,'0')+_0x324ac5[_0x36c377(0x1a7)]()['toString']()[_0x36c377(0x2a9)](0x2,'0');}function shiftedTime(){const _0x574c30=_0x31d996,_0x11f355=new Date();let _0x5089ac=_0x11f355;if(settings['timeshift']&&settings[_0x574c30(0x2f6)]!==0x0)_0x5089ac=fns[_0x574c30(0x241)](_0x11f355,{'hours':settings[_0x574c30(0x2f6)]});return _0x5089ac;}function startScheduler(){const _0x2e951e=_0x31d996,_0x5bdc0b=new Date()['getUTCHours'](),_0x2f3412=shiftedTime()[_0x2e951e(0x2de)]();_0x2f3412==0x4&&backupConfigFiles();_0x2f3412==0x0&&rotateLogFiles();_0x5bdc0b%0x6==0x0&&triggerAnalytics();_0x5bdc0b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x41ba2a){const _0x51ba13=_0x31d996;logger[_0x51ba13(0x303)](_0x51ba13(0x313)+_0x41ba2a);const _0x202719=getBotsWithMode();_0x202719[_0x51ba13(0x246)]>0x0?confirmRestore(configbackuppath,_0x41ba2a):unzipFile(configbackuppath,_0x41ba2a);}async function getBackupFiles(_0x2f740c=null){const _0x2710e3=_0x31d996;let _0x47ace6=[],_0x55fa6f=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x55fa6f['sort']((_0x484edc,_0x86ad76)=>_0x484edc[_0x2710e3(0x2d4)]<_0x86ad76[_0x2710e3(0x2d4)]?0x1:_0x86ad76[_0x2710e3(0x2d4)]<_0x484edc['name']?-0x1:0x0),_0x55fa6f[_0x2710e3(0x357)](_0x2a3b4b=>{const _0x3ea16f=_0x2710e3;if(!_0x2a3b4b[_0x3ea16f(0x1d1)]()&&_0x2a3b4b['name']['startsWith'](_0x3ea16f(0x2a8))&&_0x2a3b4b[_0x3ea16f(0x2d4)]['endsWith'](_0x3ea16f(0x24f))){const _0x54f4e5=formatDate(fs[_0x3ea16f(0x339)](configbackuppath+_0x2a3b4b['name'])[_0x3ea16f(0x33a)]);_0x47ace6[_0x3ea16f(0x1f6)]({'name':_0x2a3b4b[_0x3ea16f(0x2d4)],'mtime':_0x54f4e5});}});if(_0x2f740c)io['to'](_0x2f740c)[_0x2710e3(0x256)](_0x2710e3(0x1df),_0x47ace6);else return _0x47ace6;}async function backupConfigFiles(){const _0x269ff0=_0x31d996;await zipFiles(_0x269ff0(0x2e7));const _0x44c5a8=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x269ff0(0x23e),configbackuppath+(_0x269ff0(0x2a8)+_0x44c5a8+_0x269ff0(0x24f)));let _0x2494e9=fs[_0x269ff0(0x353)](configbackuppath,{'withFileTypes':!![]});_0x2494e9[_0x269ff0(0x35c)]((_0x10bc24,_0x4db619)=>_0x10bc24[_0x269ff0(0x2d4)]<_0x4db619[_0x269ff0(0x2d4)]?0x1:_0x4db619[_0x269ff0(0x2d4)]<_0x10bc24[_0x269ff0(0x2d4)]?-0x1:0x0),_0x2494e9[_0x269ff0(0x246)]>maxBackups&&fs[_0x269ff0(0x280)](configbackuppath+_0x2494e9[_0x2494e9[_0x269ff0(0x246)]-0x1][_0x269ff0(0x2d4)]);}function rotateLogFiles(){const _0x1a0216=_0x31d996,_0x5ceea0=fs[_0x1a0216(0x339)](logspath+_0x1a0216(0x35b)),_0x1c0095=_0x5ceea0['size']/0x400;if(_0x1c0095>0x64){let _0x20784b=fs[_0x1a0216(0x353)](logspath,{'withFileTypes':!![]});_0x20784b[_0x1a0216(0x35c)]((_0x19f557,_0x4bf1b8)=>_0x19f557['name']<_0x4bf1b8[_0x1a0216(0x2d4)]?0x1:_0x4bf1b8['name']<_0x19f557[_0x1a0216(0x2d4)]?-0x1:0x0),_0x20784b['forEach'](_0x2ebb13=>{const _0xa4b52d=_0x1a0216;if(_0x2ebb13['name']==_0xa4b52d(0x20f))fs[_0xa4b52d(0x29c)](logspath+_0x2ebb13[_0xa4b52d(0x2d4)],logspath+_0xa4b52d(0x2ba));if(_0x2ebb13['name']==_0xa4b52d(0x33b))fs['copyFileSync'](logspath+_0x2ebb13[_0xa4b52d(0x2d4)],logspath+'output-002.log');_0x2ebb13['name']==_0xa4b52d(0x35b)&&(fs[_0xa4b52d(0x29c)](logspath+_0x2ebb13['name'],logspath+_0xa4b52d(0x33b)),fs[_0xa4b52d(0x1c0)](logspath+_0x2ebb13['name'],''));});}}async function zipFiles(_0x156b91){const _0x54b319=_0x31d996;let _0x4a7621;if(_0x156b91==_0x54b319(0x317))_0x4a7621=logspath;if(_0x156b91==_0x54b319(0x35d))_0x4a7621=configpath;if(_0x156b91==_0x54b319(0x2e7))_0x4a7621=configpath;let _0x4cd066=fs[_0x54b319(0x353)](_0x4a7621,{'withFileTypes':!![]});const _0xee3d85=new require(_0x54b319(0x1d0))();_0x4cd066[_0x54b319(0x357)](_0x1f39d0=>{const _0x126714=_0x54b319;if(!_0x1f39d0[_0x126714(0x1d1)]()){let _0x5cab8a=fs['readFileSync'](_0x4a7621+_0x1f39d0['name']);if(_0x156b91=='backup'){const _0x4a6ba6=/^bot-[0-9]{3}-config.json$/,_0x4ca9df=_0x4a6ba6[_0x126714(0x197)](_0x1f39d0[_0x126714(0x2d4)]);if(_0x4ca9df){const _0x29cb94=JSON[_0x126714(0x341)](_0x5cab8a);if(_0x29cb94[_0x126714(0x332)][0x0]){_0x29cb94['bot'][0x0][_0x126714(0x274)]=_0x126714(0x310),_0x29cb94[_0x126714(0x332)][0x0][_0x126714(0x2fc)]='***';if(_0x29cb94[_0x126714(0x332)][0x0][_0x126714(0x221)])_0x29cb94[_0x126714(0x332)][0x0]['apiPassword']=_0x126714(0x310);}_0x5cab8a=JSON[_0x126714(0x2c4)](_0x29cb94,null,0x2);}if(_0x1f39d0[_0x126714(0x2d4)]=='bb-settings.json'){const _0x3bf09c=JSON[_0x126714(0x341)](_0x5cab8a);if(_0x3bf09c[_0x126714(0x2fd)][_0x126714(0x2ad)])_0x3bf09c[_0x126714(0x2fd)][_0x126714(0x2ad)]=![];if(_0x3bf09c[_0x126714(0x2fd)][_0x126714(0x291)])_0x3bf09c['settings'][_0x126714(0x291)]=_0x126714(0x310);if(_0x3bf09c[_0x126714(0x2fd)]['telegramToken'])_0x3bf09c[_0x126714(0x2fd)][_0x126714(0x2ac)]='***';if(_0x3bf09c[_0x126714(0x2fd)][_0x126714(0x232)])_0x3bf09c[_0x126714(0x2fd)][_0x126714(0x232)]=null;_0x5cab8a=JSON[_0x126714(0x2c4)](_0x3bf09c,null,0x2);}if(_0x1f39d0[_0x126714(0x2d4)]!=_0x126714(0x1b1))_0xee3d85[_0x126714(0x2eb)](_0x1f39d0[_0x126714(0x2d4)],_0x5cab8a);}else _0xee3d85[_0x126714(0x2eb)](_0x1f39d0[_0x126714(0x2d4)],_0x5cab8a);}});const _0x16afa8=_0xee3d85[_0x54b319(0x19b)]({'base64':![],'compression':_0x54b319(0x31f)});fs['writeFileSync'](zippath+(_0x156b91+_0x54b319(0x24f)),_0x16afa8,_0x54b319(0x1a4));}async function unzipFile(_0x3e3ce8,_0x12aec9){const _0x2dccf4=_0x31d996;fs[_0x2dccf4(0x353)](configpath,{'withFileTypes':!![]})['forEach'](_0x10c250=>{const _0x3b9817=_0x2dccf4;if(!_0x10c250[_0x3b9817(0x1d1)]())fs[_0x3b9817(0x354)](configpath+_0x10c250[_0x3b9817(0x2d4)]);});const _0x3534c5=fs[_0x2dccf4(0x234)](_0x3e3ce8+_0x12aec9,_0x2dccf4(0x1a4)),_0x3f260d=new require(_0x2dccf4(0x1d0))(_0x3534c5,{'base64':![],'checkCRC32':!![]});Object[_0x2dccf4(0x2cc)](_0x3f260d[_0x2dccf4(0x2b2)])[_0x2dccf4(0x357)](_0x13fa4e=>{const _0x509400=_0x2dccf4,_0x468881=_0x3f260d['files'][_0x13fa4e];fs[_0x509400(0x1c0)](configpath+_0x468881[_0x509400(0x2d4)],_0x468881[_0x509400(0x2e3)]);}),fs[_0x2dccf4(0x353)](temppath,{'withFileTypes':!![]})['forEach'](_0x10ecfb=>{const _0x198e8f=_0x2dccf4;if(!_0x10ecfb['isDirectory']())fs[_0x198e8f(0x354)](temppath+_0x10ecfb['name']);}),logger[_0x2dccf4(0x303)](_0x2dccf4(0x216)),process['send']({'restore':!![]},_0x57557e=>{});}async function getPublicIp(){const _0x132ac0=_0x31d996;try{const _0x4ec898=await axios[_0x132ac0(0x362)](_0x132ac0(0x2fe));publicip=_0x4ec898['data']['ip'];}catch(_0x5397f0){}}async function triggerAnalytics(){const _0x2c8d41=_0x31d996;if(!publicip)await getPublicIp();const _0x457551=getBotsWithMode();let _0x1181b1=0x0;_0x457551['forEach'](_0x1436dc=>{const _0x2b3064=_0x2805;if(_0x1436dc['status']===_0x2b3064(0x325))_0x1181b1++;});const _0x3f96bf=getBotExchanges();mixpanel[_0x2c8d41(0x28e)](_0x2c8d41(0x2c3),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x457551['length'],'numbotsenabled':_0x1181b1,'exchanges':_0x3f96bf});}async function getMessages(){const _0xe5a025=_0x31d996,_0x325204=_0xe5a025(0x286),_0x3d268d=new GraphQLClient(_0x325204),_0x5825a2={'authorization':_0xe5a025(0x311)},_0x111ebd=serverversion['split']('.'),_0x29f2c0=_0x111ebd[0x0]+'.'+_0x111ebd[0x1],_0x5c906a=Math[_0xe5a025(0x2b0)](settings[_0xe5a025(0x255)],settings[_0xe5a025(0x2a7)]),_0x521268={'last':parseInt(_0x5c906a),'bbm':_0x29f2c0},_0x438f94=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2be3a5;try{_0x2be3a5=await _0x3d268d['request'](_0x438f94,_0x521268,_0x5825a2);}catch(_0x1cfcd7){}if(_0x2be3a5&&_0x2be3a5[_0xe5a025(0x30b)]){let _0x35a1e1=settings[_0xe5a025(0x255)];newMessages=[];for(const _0x5823fa of _0x2be3a5['messages']){newMessages[_0xe5a025(0x1f6)](_0x5823fa);if(_0x5823fa[_0xe5a025(0x222)])updateSetting(_0xe5a025(0x290),_0x5823fa[_0xe5a025(0x222)]);let _0x38b891=_0x5823fa[_0xe5a025(0x222)]?serverversion>=_0x5823fa[_0xe5a025(0x222)]:![];if(!_0x38b891&&_0x5823fa[_0xe5a025(0x1e8)]>_0x35a1e1){if(_0x5823fa[_0xe5a025(0x1e3)]==='any'||serverversion[_0xe5a025(0x278)](_0x5823fa[_0xe5a025(0x1e3)])){let _0x24fbba=''+_0x5823fa['title']+'\x0a\x0a'+_0x5823fa[_0xe5a025(0x285)];const _0x54f920=await sendTelegramMsg(toTelegramMarkdown(_0x24fbba),_0xe5a025(0x25d));if(_0x54f920)_0x35a1e1=_0x5823fa[_0xe5a025(0x1e8)];}}}updateAvailable=isNewerVersion(settings[_0xe5a025(0x290)],serverversion),updateSetting(_0xe5a025(0x255),_0x35a1e1),emitMessages();}}function emitMessages(){const _0x2e2fcf=_0x31d996,_0x2f4b65=settings['lastmsgemitted'];let _0xafbd90=[];newMessages['forEach'](_0x4970ad=>{const _0x4031c7=_0x2805;_0x4970ad[_0x4031c7(0x1e8)]>_0x2f4b65&&_0xafbd90[_0x4031c7(0x1f6)](_0x4970ad);}),_0xafbd90[_0x2e2fcf(0x246)]>0x0&&getAllClients()[_0x2e2fcf(0x357)](_0x4130c9=>{const _0x3c8a96=_0x2e2fcf;getSocket(_0x4130c9['id'])[_0x3c8a96(0x256)](_0x3c8a96(0x285),_0xafbd90);});}function confirmMessage(_0x1a8774){const _0x39b327=_0x31d996;updateSetting(_0x39b327(0x2a7),Number(_0x1a8774));}function isNewerVersion(_0xbb0eff,_0x45e7a3){const _0xcdac6b=_0x31d996,_0x2e03ea=_0x45e7a3[_0xcdac6b(0x31d)]('.'),_0x3967c5=_0xbb0eff['split']('.');for(var _0x185cc7=0x0;_0x185cc7<_0x3967c5['length'];_0x185cc7++){const _0x526c2f=~~_0x3967c5[_0x185cc7],_0x8c112c=~~_0x2e03ea[_0x185cc7];if(_0x526c2f>_0x8c112c)return!![];if(_0x526c2f<_0x8c112c)return![];}return![];}function toTelegramMarkdown(_0x237abd){const _0x46a76c=_0x31d996,_0x324c4c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x44f21f=/\*{2}(.+?)\*{2}/gim;return _0x237abd=_0x237abd[_0x46a76c(0x36c)](_0x324c4c,'$1_$2_$3')['replace'](_0x44f21f,_0x46a76c(0x22b)),_0x237abd;}async function validateConfigFile(){const _0x569495=_0x31d996,_0x37acf2=dbConfig[_0x569495(0x362)](_0x569495(0x1a8))[_0x569495(0x2d0)]('botID')[_0x569495(0x28d)]()||[];if(_0x37acf2['length']==0x0){let _0xc8e1cd=0x0,_0x34fd4a=[];const _0x556f7e=/^bot-([0-9]{3})-config.json$/,_0x10c36a=fs[_0x569495(0x353)](configpath);_0x10c36a[_0x569495(0x357)](_0x1b7a29=>{const _0x24505e=_0x569495,_0x528901=_0x556f7e[_0x24505e(0x1ed)](_0x1b7a29);if(_0x528901){const _0xd7da56=_0x528901[0x1];let _0x181d75=getBotAttributes(_0xd7da56);_0x34fd4a['push']({'botID':_0xd7da56,'botname':_0x181d75[_0x24505e(0x282)],'status':_0x24505e(0x283),'live':_0x24505e(0x196)}),_0xc8e1cd++;}}),_0xc8e1cd!=0x0&&(dbConfig[_0x569495(0x362)](_0x569495(0x1a8))[_0x569495(0x1e2)](_0x34fd4a)[_0x569495(0x20a)](),config=_0x34fd4a,restoredConfigFile=_0xc8e1cd);}}async function restoreConfigNotify(_0x488ed7){const _0x311194=_0x31d996;let _0x3a9308;if(restoredConfigFile==0x1)_0x3a9308='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x3a9308='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x488ed7)io['to'](_0x311194(0x2f7))[_0x311194(0x256)](_0x311194(0x350),_0x3a9308);else{logger['simple'](_0x311194(0x21e)),logger[_0x311194(0x1ad)](_0x3a9308),logger['simple']('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x311194(0x232)]&&settings[_0x311194(0x1aa)]!=_0x311194(0x2a0))tgBot[_0x311194(0x194)](settings[_0x311194(0x232)],_0x311194(0x352)+_0x3a9308)[_0x311194(0x19d)](_0x4c9101=>{telegramError(_0x4c9101);});}}function validateCredentials(_0x34b04d,_0x14220d){const _0x2ceaf1=_0x31d996;if(_0x34b04d[_0x2ceaf1(0x33e)]==settings['bbUsername']&&bcrypt[_0x2ceaf1(0x27e)](_0x34b04d[_0x2ceaf1(0x360)],settings[_0x2ceaf1(0x291)])){if(settings[_0x2ceaf1(0x2ec)])return{'allow':![],'reason':_0x2ceaf1(0x28b),'token':null};else{const _0x2ce1b5=generateLoginToken(_0x14220d);return{'allow':!![],'reason':_0x2ceaf1(0x2d3),'token':_0x2ce1b5};}}else return{'allow':![],'reason':_0x2ceaf1(0x1c8),'token':null};}function refreshToken(_0x22c660){const _0x5cf81b=_0x31d996,_0x106f99=generateLoginToken(_0x22c660);return{'allow':!![],'reason':_0x5cf81b(0x2d3),'token':_0x106f99};}function validateAccess(_0x438dcc,_0x4323b9,_0x23eb60){const _0x17ff3b=_0x31d996,_0x5c2929=_0x23eb60?_0x23eb60:devices[_0x4323b9]['ip'];let _0x1d4572;const _0x2e0730=_0x4956b0=>{const _0x94ae96=_0x2805;if(settings['loginRequired']){if(settings[_0x94ae96(0x2ec)]){if(telegram2FaApproved(_0x4323b9)){const _0x523d03=generateLoginToken(_0x4323b9);return{'allow':!![],'reason':_0x94ae96(0x334),'token':_0x523d03};}else return{'allow':![],'reason':_0x94ae96(0x2b3),'token':null};}else return _0x1d4572=validToken(_0x4956b0,_0x4323b9),_0x1d4572['hasOwnProperty'](_0x94ae96(0x2b6))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4956b0}:{'allow':![],'reason':_0x94ae96(0x2b3),'token':null};}else return{'allow':!![],'reason':_0x94ae96(0x1ca),'token':null};};if(settings[_0x17ff3b(0x212)]){let _0x1225f7=[...settings[_0x17ff3b(0x261)],_0x17ff3b(0x225),_0x17ff3b(0x191),'127.0.0.1'];if(_0x1225f7[_0x17ff3b(0x226)](_0x5c2929))return _0x2e0730(_0x438dcc);else{_0x1d4572=validToken(_0x438dcc,_0x4323b9);if(_0x1d4572[_0x17ff3b(0x244)](_0x17ff3b(0x2b6)))return _0x2e0730(_0x438dcc);else{if(telegramIpApproved(_0x4323b9)){const _0x4156f3=generateToken(_0x4323b9);return _0x1d4572=_0x2e0730(_0x438dcc),_0x1d4572[_0x17ff3b(0x2a2)]?{'allow':!![],'reason':_0x17ff3b(0x26b),'token':_0x4156f3}:_0x1d4572;}else return settings[_0x17ff3b(0x1d9)]?{'allow':![],'reason':_0x17ff3b(0x26f),'token':null}:{'allow':![],'reason':_0x17ff3b(0x1a6),'token':null};}}}else return _0x2e0730(_0x438dcc);}function timelyDecrypt(_0x59291d,_0x105d19=!![]){const _0x5a3d0d=_0x31d996;if(_0x59291d)try{const _0xe09c75=crypt[_0x5a3d0d(0x358)](secure[_0x5a3d0d(0x2af)],_0x59291d)[_0x5a3d0d(0x285)],_0x32e668=_0xe09c75['split']('@')[0x0],_0x5178e0=_0xe09c75[_0x5a3d0d(0x31d)]('@')[0x1],_0x4741fe=new Date()[_0x5a3d0d(0x247)]();if(_0x105d19){if(_0x4741fe-_0x5178e0<maxSecretAge*0x3e8)return _0x32e668;else return![];}else return _0x32e668;}catch(_0x5ed373){return![];}else return![];}const validToken=(_0x3f486b,_0x38b36f)=>{const _0x26b9da=_0x31d996,_0x3a405b=devices[_0x38b36f]['ip'];if(!_0x3f486b)return{'error':_0x26b9da(0x1a3)};for(let _0x51bb39 of blacklist){if(_0x51bb39[_0x26b9da(0x314)]==_0x3f486b)return{'error':_0x26b9da(0x2cb)};}let _0x3b2c82;try{_0x3b2c82=jwt['verify'](_0x3f486b,secure[_0x26b9da(0x250)]+_0x38b36f);}catch{return{'error':_0x26b9da(0x1e7)};}if(!_0x3b2c82[_0x26b9da(0x244)]('clientip')&&!_0x3b2c82[_0x26b9da(0x244)](_0x26b9da(0x33e))||!_0x3b2c82[_0x26b9da(0x244)](_0x26b9da(0x2ed)))return{'error':_0x26b9da(0x27d)};if(!_0x3b2c82[_0x26b9da(0x244)](_0x26b9da(0x33e))&&_0x3b2c82[_0x26b9da(0x244)](_0x26b9da(0x30f))){const {clientip:_0x2e5515}=_0x3b2c82;return _0x3a405b==_0x2e5515?{'success':_0x26b9da(0x319)}:{'error':_0x26b9da(0x21f)};}else{if(_0x3b2c82[_0x26b9da(0x244)]('username')&&_0x3b2c82[_0x26b9da(0x244)](_0x26b9da(0x30f))){const {username:_0x3dd333,clientip:_0x258957}=_0x3b2c82;return settings['bbUsername']==_0x3dd333&&_0x3a405b==_0x258957?{'success':_0x26b9da(0x319)}:{'error':_0x26b9da(0x312)};}}},generateLoginToken=_0x4b49d0=>{const _0x16bab9=_0x31d996;if(_0x4b49d0){const _0xf5bd32=devices[_0x4b49d0]['ip'];return jwt[_0x16bab9(0x259)]({'username':settings[_0x16bab9(0x338)],'clientip':_0xf5bd32},secure[_0x16bab9(0x250)]+_0x4b49d0,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x149f40=>{const _0xe02545=_0x31d996;if(_0x149f40){const _0x4df1ea=devices[_0x149f40]['ip'];return jwt[_0xe02545(0x259)]({'clientip':_0x4df1ea},secure[_0xe02545(0x250)]+_0x149f40,{'expiresIn':devices[_0x149f40][_0xe02545(0x1fb)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x1ac099=>{const _0x2f60c8=_0x31d996;let _0x314aab=![];return devices[_0x1ac099][_0x2f60c8(0x1fb)]&&devices[_0x1ac099][_0x2f60c8(0x1fb)][_0x2f60c8(0x272)]!=_0x2f60c8(0x1c7)&&(_0x314aab=devices[_0x1ac099][_0x2f60c8(0x1fb)][_0x2f60c8(0x30f)]==devices[_0x1ac099]['ip']&&new Date()[_0x2f60c8(0x247)]()-devices[_0x1ac099][_0x2f60c8(0x1fb)][_0x2f60c8(0x34d)]<devices[_0x1ac099][_0x2f60c8(0x1fb)][_0x2f60c8(0x272)]*0x3c*0x3e8),_0x314aab;},telegram2FaApproved=_0x5c217f=>{const _0x4f0d17=_0x31d996;let _0x815ddf=![];return devices[_0x5c217f]['telegram2FaApproval']&&devices[_0x5c217f]['telegram2FaApproval'][_0x4f0d17(0x272)]!=_0x4f0d17(0x1c7)&&(_0x815ddf=devices[_0x5c217f][_0x4f0d17(0x30e)][_0x4f0d17(0x30f)]==devices[_0x5c217f]['ip']&&new Date()[_0x4f0d17(0x247)]()-devices[_0x5c217f]['telegram2FaApproval']['timestamp']<devices[_0x5c217f][_0x4f0d17(0x30e)][_0x4f0d17(0x272)]*0x3c*0x3e8),_0x815ddf;},normalizeIP=_0x149351=>{const _0x38b592=_0x31d996;let _0x4ad3cc=null,_0x3e98c6=null;if(ipaddr[_0x38b592(0x26e)](_0x149351)){const _0x1b43f8=ipaddr[_0x38b592(0x341)](_0x149351);_0x1b43f8[_0x38b592(0x20e)]()==='ipv6'?(_0x1b43f8[_0x38b592(0x23b)]()&&(_0x4ad3cc=_0x1b43f8[_0x38b592(0x1b6)]()['toString']()),_0x3e98c6=_0x1b43f8[_0x38b592(0x258)]()):(_0x4ad3cc=_0x1b43f8[_0x38b592(0x258)](),_0x3e98c6=_0x1b43f8[_0x38b592(0x2ef)]()[_0x38b592(0x258)]());}return{'show':_0x4ad3cc?_0x4ad3cc:_0x3e98c6,'store':_0x3e98c6};};function formatDate(_0x3d0239){const _0x2e6483=_0x31d996;return _0x3d0239[_0x2e6483(0x18f)]()+'/'+(_0x3d0239[_0x2e6483(0x36b)]()+0x1)[_0x2e6483(0x258)]()[_0x2e6483(0x2a9)](0x2,'0')+'/'+_0x3d0239[_0x2e6483(0x190)]()['toString']()[_0x2e6483(0x2a9)](0x2,'0')+'\x20'+_0x3d0239[_0x2e6483(0x2de)]()[_0x2e6483(0x258)]()[_0x2e6483(0x2a9)](0x2,'0')+':'+_0x3d0239[_0x2e6483(0x1e1)]()[_0x2e6483(0x258)]()[_0x2e6483(0x2a9)](0x2,'0')+':'+_0x3d0239[_0x2e6483(0x1a7)]()[_0x2e6483(0x258)]()[_0x2e6483(0x2a9)](0x2,'0');}function sleep(_0x553aa1){return new Promise(_0xa57e62=>setTimeout(_0xa57e62,_0x553aa1));}