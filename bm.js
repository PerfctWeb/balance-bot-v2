const _0x27ee64=_0x2df2;(function(_0x36b9a1,_0x449448){const _0x1120cd=_0x2df2,_0x6de0d4=_0x36b9a1();while(!![]){try{const _0x446143=parseInt(_0x1120cd(0x27a))/0x1*(parseInt(_0x1120cd(0x298))/0x2)+-parseInt(_0x1120cd(0x27f))/0x3*(parseInt(_0x1120cd(0x251))/0x4)+-parseInt(_0x1120cd(0x1d8))/0x5*(parseInt(_0x1120cd(0x290))/0x6)+parseInt(_0x1120cd(0x302))/0x7+-parseInt(_0x1120cd(0x1c7))/0x8+parseInt(_0x1120cd(0x2cc))/0x9*(parseInt(_0x1120cd(0x263))/0xa)+parseInt(_0x1120cd(0x291))/0xb*(parseInt(_0x1120cd(0x225))/0xc);if(_0x446143===_0x449448)break;else _0x6de0d4['push'](_0x6de0d4['shift']());}catch(_0x5fd846){_0x6de0d4['push'](_0x6de0d4['shift']());}}}(_0x4232,0xf1f99));const _0x18cf01=function(){let _0x50402f=!![];return function(_0x10c021,_0x23c7b1){const _0x5a4512=_0x50402f?function(){const _0x385fa2=_0x2df2;if(_0x23c7b1){const _0x21bd6e=_0x23c7b1[_0x385fa2(0x265)](_0x10c021,arguments);return _0x23c7b1=null,_0x21bd6e;}}:function(){};return _0x50402f=![],_0x5a4512;};}(),_0x12c7f0=_0x18cf01(this,function(){const _0x3760ef=_0x2df2;return _0x12c7f0['toString']()[_0x3760ef(0x2fa)](_0x3760ef(0x28d))[_0x3760ef(0x2d0)]()[_0x3760ef(0x245)](_0x12c7f0)[_0x3760ef(0x2fa)](_0x3760ef(0x28d));});_0x12c7f0();'use strict';process[_0x27ee64(0x2c7)][_0x27ee64(0x199)]=0x1;const childProcess=require(_0x27ee64(0x1f0)),fs=require('fs'),fns=require(_0x27ee64(0x23f)),low=require(_0x27ee64(0x316)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x27ee64(0x200)),crypto=require('crypto'),Crypt=require(_0x27ee64(0x18f))[_0x27ee64(0x256)],RSA=require('hybrid-crypto-js')[_0x27ee64(0x2e9)],bcrypt=require(_0x27ee64(0x234)),jwt=require(_0x27ee64(0x1cd)),ipaddr=require(_0x27ee64(0x1d9)),argv=require('yargs/yargs')(process[_0x27ee64(0x284)]['slice'](0x2))[_0x27ee64(0x284)],uuidRandom=require(_0x27ee64(0x194)),TelegramBot=require(_0x27ee64(0x2c4)),Mixpanel=require(_0x27ee64(0x19a)),axios=require(_0x27ee64(0x22d)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x27ee64(0x2e4)),fileUpload=require('express-fileupload'),PORT=argv[_0x27ee64(0x24e)]||_0x27ee64(0x1da),pattern=/^[0-9]{2,4}$/;!pattern[_0x27ee64(0x28b)](PORT)&&(console[_0x27ee64(0x2e7)](_0x27ee64(0x2df)+PORT+_0x27ee64(0x1dc)),process['exit'](0x1));function _0x4232(){const _0x192520=['status','file','exec','RSA-OAEP','All\x20bots','replace','store-headless','hybrid-crypto-js','telegramEvents','You\x20can\x20use\x20the\x20following\x20commands:\x0a','404\x20Not\x20Found','logs','uuid-random','blacklist','Bot\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','invalid\x20credentials','NTBA_FIX_319','mixpanel','createWriteStream','reload','SIGINT','Orders','bot-','SIGTERM','existsSync','getTime','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','deleted\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','remoteAddress','/disable\x20-\x20disable\x20notifications\x0a','exit','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','getMinutes','Invalid\x20Telegram\x20token','User\x20has\x20been\x20validated','/status\x20-\x20show\x20bot(s)\x20status\x0a','filter','bb/','-----------------------------------------------------------------------------------','$1_$2_$3','enabled','latestversion','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','2FA\x20login\x20required','map','decrypt','restart','***','botID','send','auth','socket','apiSecret','error','emitHistory','from','sockets','userid','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Starting\x20Balance\x20Bot\x20update','Alerts','10258888efpPVl','No\x20authentication\x20token','botname','exp','conn','temporary\x20access\x20not\x20allowed','jsonwebtoken','getHours','name','restarting\x20Bot\x20','/download/:type','kind','bbUsername','stringify','username','socket.io','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','5052225oExztH','ipaddr.js','3000','/output-000.log',',\x20must\x20be\x20a\x204\x20digit\x20number','\x20only\x0a','padStart','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/update\x20-\x20update\x20Balance\x20Bot\x0a','logged\x20out','copyFileSync','zip/','Login\x20accepted','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','temporary\x20access\x20rejected','unlinkSync','::1','/on\x20-\x20start\x20bot(s)\x0a','notification','use','*$1*','removeListener','sendFile','lastmsgtelegram','child_process','expiry','init','Notifications\x20enabled\x0a','update-bb','Unauthorized\x20attempt\x20to\x20delete\x20alerts','.zip','full','Notifications\x20types:\x20','format','sendPortfolioTelegram','login\x20not\x20required','2FA\x20login\x20token\x20generated','/:bot/history','ipc','store','path','order',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','temporary\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','verify','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','forEach','generateKeyPairAsync','mkdirSync','Unauthorized\x20attempt\x20to\x20update\x20bot','Notifications\x20disabled','settings','_data','encryptedUuid','bb-secure.json','whitelist','Bot\x20Mgr\x20>\x20','createServer','bb-config.json','output-001.log','running','showConfig','getFullYear','login\x20required','allow','sign','bbvReceive','remove','\x20>\x20','************','temp/','chat','parse','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','getDate','callback_query','24qXgawU','telegramIpApproval','readFileSync','Unauthorized\x20attempt\x20to\x20show\x20configuration','settings.','<b>Balance\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','axios','botmanager','alerts','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','f2aRequired','Restoring\x20bot(s)\x20from\x20backup','telegramChatId','bcryptjs','write','post','login','showname','sendMessage','writeFileSync','getStartingBalances','static','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','date-fns','Unauthorized\x20attempt\x20to\x20log\x20out','answerCallbackQuery','compareSync','temporaryAccessAllowed','2FA','constructor','isValid','handshake','sortBy','Unauthorized\x20attempt\x20to\x20store\x20configuration','enabled\x20Bot\x20','get-messages','exchange','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','port','clients','push','4fJunOa','cancelLoading','uuid','Server','Access\x20enabled\x20for\x20','Crypt','function','output-002.log','bb-settings.json','telegram2FaApproval','messages','telegram','assign','\x20mode','emit','-config.json','bbvNew','get','50SAzRjW','polling_error','apply','entries','accept','::ffff:127.0.0.1','inherit','whitelistEnabled','new','/:bot/configuration','yes','files','headers','size','message','access','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','defaults','find','30\x20min','binary','update-bot','\x20to\x20','693261bYjWsy','apiKey','server','rmSync','No\x20bots\x20running\x20right\x20now','3755319mczkzn','join','\x20|\x20','listen','mode','argv','-performance.json','cancel-loading','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','event','-events.json','tkn','test','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','(((.+)+)+)+$','/restart\x20-\x20restart\x20bot(s)\x0a','secure','6sTmIdv','11366234fZwJnj','placeOrder','\x20(2)','catch','2FA\x20required','started','uncaughtException','2KSSfsX','then','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','includes','Unauthorized\x20attempt\x20to\x20confirm\x20message','match','ipv6','HTML','set','orders','host','starting\x20bot\x20|\x20Bot\x20','removeAllListeners','hasOwnProperty','Ok,\x20will\x20send\x20order\x20notifications\x20only','readdirSync','/enable\x20-\x20enable\x20notifications\x0a','version','Unauthorized\x20attempt\x20to\x20update\x20settings','https://api.ipify.org?format=json','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','pidExpireLogin','value','backup/','stopped','startsWith','disabled\x20Bot\x20','telegramEnabled','hashSync','disconnect','/names\x20-\x20show\x20bot\x20names\x0a','Token\x20blacklisted','logs/','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','data','All\x20bots\x20running\x20right\x20now','pidRefreshToken','randomFillSync','disabled','access\x20timeout','Unauthorized\x20attempt\x20to\x20delete\x20bot','stop','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','sort','node-telegram-bot-api','user','</b>\x20?','env','storeConfiguration','publicKey','privateKey','keys','564885WErUwR','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','timeshift','get-logs','toString','delete-alerts','number','length','build','0.0.0','reset-password','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','success','title','isDirectory','login\x20token\x20generated','Password\x20reset\x20rejected','max','/:bot/coins','Error:\x20Invalid\x20argument\x20','/upload-backup','secret','password','initclient','util','simple','/off\x20-\x20stop\x20bot(s)\x0a','log','token','RSA','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','node-zip','track','toIPv4MappedAddress','bbPassword','getSeconds','telegramToken','1000','loginRequired','Ok,\x20will\x20send\x20alert\x20notifications\x20only','split','bot.js','5\x20min','onText','-results.json','confirm-message','search','statSync','manual','stopPolling','config/','Unauthorized\x20login\x20attempt\x20(timeout)','clientip','build2','10234238VrGwqN','getMonth','get-starting-balances','type','reject','backupfile','/:bot/portfolio','reason','bots','6b67f3d61ee94b8f5c80b4affef4c4d9','/:bot','Login\x20rejected','kill','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','api-eu.mixpanel.com','storeHeadless','/:bot/performance','lastmsgemitted','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','toggle-bot-mode','lowdb','request','cloneDeep','headless','deleteHistoryAlerts','auto','index.html','store-settings','show-config','Password\x20has\x20been\x20reset\x20to:\x20','any','Unauthorized\x20attempt\x20to\x20download\x20','fork','show','timestamp','telegramUsername','login\x20token\x20valid','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','telegrammsg','output-003.log','Invalid\x20username\x20or\x20IP\x20address','idling\x20bot\x20\x20\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','live','/:bot/support','bot','all','new-disabled','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a'];_0x4232=function(){return _0x192520;};return _0x4232();}const HOST=argv[_0x27ee64(0x2a2)]||null,userID=argv[_0x27ee64(0x2c5)]||'';let bbpath=_0x27ee64(0x1af),bbpath2='';const botfile=_0x27ee64(0x2f5),configfile=_0x27ee64(0x213),settingsfile='bb-settings.json',securefile=_0x27ee64(0x20f);let validInstallation=!![];!fs[_0x27ee64(0x1a1)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x27ee64(0x24f)),configpath=userID?bbpath+_0x27ee64(0x2fe)+userID+'/':bbpath+_0x27ee64(0x2fe),configbackuppath=configpath+_0x27ee64(0x2af),logspath=userID?bbpath+_0x27ee64(0x2b8)+userID+'/':bbpath+_0x27ee64(0x2b8),zippath=userID?bbpath+_0x27ee64(0x1e3)+userID+'/':bbpath+_0x27ee64(0x1e3),loggerfile=fs[_0x27ee64(0x19b)](logspath+_0x27ee64(0x1db),{'flags':'a'}),temppath=userID?bbpath+_0x27ee64(0x21f)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x27ee64(0x1a1)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x27ee64(0x1a1)](logspath)&&fs[_0x27ee64(0x209)](logspath);!fs[_0x27ee64(0x1a1)](zippath)&&fs[_0x27ee64(0x209)](zippath);!fs['existsSync'](temppath)&&fs[_0x27ee64(0x209)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x27ee64(0x235)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x27ee64(0x274)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0'}})[_0x27ee64(0x235)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x27ee64(0x235)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x27ee64(0x18b)});const saltRounds=0xa,mixpanel=Mixpanel[_0x27ee64(0x1f2)](_0x27ee64(0x30b),{'host':_0x27ee64(0x310)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x27ee64(0x2f0)]&&settings[_0x27ee64(0x2f0)]!=''&&settings['telegramUsername']&&settings[_0x27ee64(0x325)]!='')initTelegram();const logger={'screen':_0x40fb7a=>{const _0x724a80=_0x27ee64;console[_0x724a80(0x2e7)](_0x40fb7a);},'simple':_0x17014a=>{const _0x160926=_0x27ee64;console['log'](_0x17014a),loggerfile[_0x160926(0x235)](util[_0x160926(0x1f9)](_0x17014a)+'\x0a');},'full':async _0x5d5198=>{const _0x5854b7=_0x27ee64,_0x155bef=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5d5198;console[_0x5854b7(0x2e7)](_0x155bef),loggerfile['write'](util[_0x5854b7(0x1f9)](_0x155bef)+'\x0a');if(tgBot&&settings[_0x5854b7(0x233)]&&settings['telegramEvents']!=_0x5854b7(0x2a1))await tgBot[_0x5854b7(0x239)](settings['telegramChatId'],_0x5854b7(0x211)+_0x5d5198)[_0x5854b7(0x294)](_0x12234b=>{telegramError(_0x12234b);});}};process['on'](_0x27ee64(0x297),function(_0x4447d0){const _0x4207f2=_0x27ee64;logger[_0x4207f2(0x2e5)](_0x4447d0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x27ee64(0x2a9)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x27ee64(0x212)](app);app[_0x27ee64(0x1eb)](fileUpload({'useTempFiles':!![]})),app['get'](_0x27ee64(0x1d1),async(_0x58262d,_0x256275)=>{const _0x39b28e=_0x27ee64,_0x4d8123=_0x58262d['params']['type'],_0x29a39c=getClientsWithBotID(_0x39b28e(0x22e)),_0x6966f3=_0x58262d[_0x39b28e(0x26f)]['uuid'],_0x1254b8=timelyDecrypt(_0x6966f3,![]),_0x51162c=_0x29a39c[_0x39b28e(0x275)](_0xf270c=>_0xf270c[_0x39b28e(0x253)]==_0x1254b8);if(_0x51162c){const _0x16ddc9=normalizeIP(_0x58262d[_0x39b28e(0x1bd)][_0x39b28e(0x1a6)])[_0x39b28e(0x1ff)],_0x5c217c=_0x58262d[_0x39b28e(0x26f)][_0x39b28e(0x28a)];if(validateAccess(_0x5c217c,_0x1254b8,_0x16ddc9)[_0x39b28e(0x219)])await zipFiles(_0x4d8123),_0x256275['download'](zippath+(_0x4d8123+_0x39b28e(0x1f6)),_0x39c321=>{const _0x377ebc=_0x39b28e;_0x39c321&&(logger[_0x377ebc(0x1f7)]('Failed\x20to\x20download\x20'+_0x4d8123),logger[_0x377ebc(0x2e5)](_0x39c321));});else logger[_0x39b28e(0x1f7)](_0x39b28e(0x321)+_0x4d8123+'\x20(1)');}else logger[_0x39b28e(0x1f7)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x4d8123+_0x39b28e(0x293));}),app[_0x27ee64(0x236)](_0x27ee64(0x2e0),async(_0x2cd941,_0xc9d451)=>{const _0x44d009=_0x27ee64,_0x2f37d5=getClientsWithBotID(_0x44d009(0x22e)),_0x4e8e02=_0x2cd941[_0x44d009(0x26f)][_0x44d009(0x253)],_0x4cfb1e=timelyDecrypt(_0x4e8e02,![]),_0x48726a=_0x2f37d5[_0x44d009(0x275)](_0x39a073=>_0x39a073['uuid']==_0x4cfb1e);if(_0x48726a){const _0x58f9f0=normalizeIP(_0x2cd941[_0x44d009(0x1bd)][_0x44d009(0x1a6)])[_0x44d009(0x1ff)],_0x1743bf=_0x2cd941['headers'][_0x44d009(0x28a)];if(validateAccess(_0x1743bf,_0x4cfb1e,_0x58f9f0)[_0x44d009(0x219)]){if(_0x2cd941[_0x44d009(0x26e)]){const _0x575292=_0x2cd941['files'][_0x44d009(0x307)];await _0x575292['mv'](temppath+_0x575292['name']),_0xc9d451[_0x44d009(0x1bb)]({'status':!![],'message':'File\x20uploaded'});const _0x42c69c=getBotsWithMode();_0x42c69c[_0x44d009(0x2d3)]>0x0?confirmRestore(temppath,_0x575292[_0x44d009(0x1cf)]):unzipFile(temppath,_0x575292[_0x44d009(0x1cf)]);}}else logger[_0x44d009(0x1f7)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x44d009(0x1f7)](_0x44d009(0x314));}),app[_0x27ee64(0x1eb)](express[_0x27ee64(0x23c)](path[_0x27ee64(0x280)](__dirname,bbpath2,_0x27ee64(0x301)))),app[_0x27ee64(0x1eb)](express['static'](path[_0x27ee64(0x280)](__dirname,bbpath2,_0x27ee64(0x2d4)))),app[_0x27ee64(0x262)]('/',function(_0x393256,_0xcd39aa){const _0x5e77e3=_0x27ee64;_0xcd39aa['sendFile'](path[_0x5e77e3(0x280)](__dirname,bbpath2,_0x5e77e3(0x301),_0x5e77e3(0x31c)));}),app[_0x27ee64(0x262)](_0x27ee64(0x30c),function(_0x23dbf3,_0x33879a){const _0xfae113=_0x27ee64;_0x33879a[_0xfae113(0x1ee)](path[_0xfae113(0x280)](__dirname,bbpath2,'build','index.html'));}),app[_0x27ee64(0x262)](_0x27ee64(0x308),(_0x4485c3,_0x4b849a)=>{const _0x3782b2=_0x27ee64;_0x4b849a['sendFile'](path['join'](__dirname,bbpath2,_0x3782b2(0x2d4),_0x3782b2(0x31c)));}),app[_0x27ee64(0x262)](_0x27ee64(0x312),(_0x1596c4,_0x4047fa)=>{const _0x696e25=_0x27ee64;_0x4047fa['sendFile'](path[_0x696e25(0x280)](__dirname,bbpath2,_0x696e25(0x2d4),_0x696e25(0x31c)));}),app[_0x27ee64(0x262)](_0x27ee64(0x2de),(_0x109ea8,_0x21433b)=>{const _0x3df559=_0x27ee64;_0x21433b[_0x3df559(0x1ee)](path[_0x3df559(0x280)](__dirname,bbpath2,_0x3df559(0x2d4),_0x3df559(0x31c)));}),app[_0x27ee64(0x262)](_0x27ee64(0x1fd),(_0x1fc288,_0x35379d)=>{const _0x4ef4e6=_0x27ee64;_0x35379d[_0x4ef4e6(0x1ee)](path[_0x4ef4e6(0x280)](__dirname,bbpath2,'build',_0x4ef4e6(0x31c)));}),app[_0x27ee64(0x262)](_0x27ee64(0x26c),(_0x2fe5c3,_0x528359)=>{const _0x18bdea=_0x27ee64;_0x528359[_0x18bdea(0x1ee)](path[_0x18bdea(0x280)](__dirname,bbpath2,_0x18bdea(0x2d4),'index.html'));}),app[_0x27ee64(0x262)](_0x27ee64(0x183),(_0x46c4a7,_0xa028f4)=>{const _0x5ed3fa=_0x27ee64;_0xa028f4[_0x5ed3fa(0x1ee)](path[_0x5ed3fa(0x280)](__dirname,bbpath2,_0x5ed3fa(0x2d4),_0x5ed3fa(0x31c)));});function _0x2df2(_0x41311d,_0x14d22a){const _0x548ca6=_0x4232();return _0x2df2=function(_0x12c7f0,_0x18cf01){_0x12c7f0=_0x12c7f0-0x180;let _0x423239=_0x548ca6[_0x12c7f0];return _0x423239;},_0x2df2(_0x41311d,_0x14d22a);}if(HOST)http[_0x27ee64(0x282)](PORT,HOST);else http[_0x27ee64(0x282)](PORT);const io=require(_0x27ee64(0x1d6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x363d4b=_0x27ee64;logger[_0x363d4b(0x2e5)](''),logger['simple'](_0x363d4b(0x1b0)),await logger['full'](_0x363d4b(0x206)+PORT),logger[_0x363d4b(0x2e5)](_0x363d4b(0x1b0));if(config[_0x363d4b(0x2d3)]!=0x0)for(const _0x69e33c of config){if(_0x69e33c[_0x363d4b(0x188)]==_0x363d4b(0x1b2)||_0x69e33c[_0x363d4b(0x188)]==_0x363d4b(0x26b))await logger[_0x363d4b(0x1f7)](_0x363d4b(0x2a3)+_0x69e33c[_0x363d4b(0x1ba)]+_0x363d4b(0x281)+_0x69e33c['botname']),startBot([_0x69e33c[_0x363d4b(0x1ba)],userID],{'cwd':bbpath},function(_0x43ec63){const _0x2905ce=_0x363d4b;if(_0x43ec63)logger[_0x2905ce(0x1f7)](_0x43ec63);});else(_0x69e33c['status']==_0x363d4b(0x2be)||_0x69e33c[_0x363d4b(0x188)]==_0x363d4b(0x186))&&await logger[_0x363d4b(0x1f7)](_0x363d4b(0x180)+_0x69e33c[_0x363d4b(0x1ba)]+'\x20|\x20'+_0x69e33c[_0x363d4b(0x1c9)]);}else!newBot&&logger[_0x363d4b(0x2e5)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x363d4b(0x2e5)]('-----------------------------------------------------------------------------------'),logger[_0x363d4b(0x2e5)]('');}function startSocket(){io['on']('connection',_0xec5f0c=>{const _0x3b10dd=_0x2df2;let _0x1e366b,_0x5ddabf,_0x3d7e30,_0xf82336,_0x2cecc4;const _0xb90b57=_0xec5f0c['handshake'][_0x3b10dd(0x26f)]['referer'];_0x5ddabf=_0xb90b57['match'](/bot[0-9]{3}/);if(_0x5ddabf)_0x3d7e30=_0x5ddabf[0x0][_0x3b10dd(0x29d)](/[0-9]{3}/);if(_0x3d7e30)_0x1e366b=_0x3d7e30[0x0];else _0x1e366b='botmanager';const _0x1a2bc4=_0xec5f0c[_0x3b10dd(0x247)][_0x3b10dd(0x1bc)][_0x3b10dd(0x20e)];if(!_0x1a2bc4)_0xec5f0c[_0x3b10dd(0x25f)](_0x3b10dd(0x188),{'publicKey':secure[_0x3b10dd(0x2c9)]});else{_0xf82336=timelyDecrypt(_0x1a2bc4,![]);if(!_0xf82336)_0xec5f0c['emit'](_0x3b10dd(0x188),{'publicKey':secure[_0x3b10dd(0x2c9)]});else{_0x2cecc4=normalizeIP(_0xec5f0c[_0x3b10dd(0x1cb)][_0x3b10dd(0x1a6)])[_0x3b10dd(0x1ff)];if(!devices[_0xf82336])devices[_0xf82336]={'uuid':_0xf82336,'access':{'token':null}};devices[_0xf82336]['ip']=_0x2cecc4;const _0x23b679=addClient(_0xec5f0c['id'],_0xf82336,_0x1e366b);setAccess(_0x23b679),emitMessages(),_0xec5f0c['on'](_0x3b10dd(0x237),_0x1dd3be=>{const _0x48937e=_0x3b10dd,_0x412a64=timelyDecrypt(_0x1dd3be[_0x48937e(0x2e2)]);if(_0x412a64){_0x1dd3be={'username':_0x1dd3be[_0x48937e(0x1d5)],'password':_0x412a64},devices[_0xf82336][_0x48937e(0x272)]=validateCredentials(_0x1dd3be,_0xf82336);if(devices[_0xf82336][_0x48937e(0x272)][_0x48937e(0x219)]==![]&&devices[_0xf82336][_0x48937e(0x272)][_0x48937e(0x309)]==_0x48937e(0x1b5))_0xec5f0c[_0x48937e(0x25f)](_0x48937e(0x188),{'access':devices[_0xf82336]['access']}),loginAccess2FA(_0xf82336,_0x2cecc4);else{if(devices[_0xf82336][_0x48937e(0x272)][_0x48937e(0x219)]==![]&&devices[_0xf82336][_0x48937e(0x272)]['reason']==_0x48937e(0x198))_0xec5f0c[_0x48937e(0x25f)](_0x48937e(0x188),{'access':devices[_0xf82336][_0x48937e(0x272)]});else devices[_0xf82336][_0x48937e(0x272)]['allow']&&devices[_0xf82336][_0x48937e(0x272)][_0x48937e(0x309)]==_0x48937e(0x2db)&&(getClientsWithUuid(_0xf82336)[_0x48937e(0x207)](_0x333b3a=>{setAccess(_0x333b3a);}),setTokenRefresh(_0xf82336),setSessionTimeout(_0x48937e(0x237),_0xf82336));}}else logger[_0x48937e(0x1f7)](_0x48937e(0x2ff));}),_0xec5f0c['on'](_0x3b10dd(0x2d6),()=>{resetPassword();}),_0xec5f0c['on'](_0x3b10dd(0x2b5),_0x18a56d=>{removeClient(_0xec5f0c['id']);}),_0x1e366b==_0x3b10dd(0x22e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2e6cd5){const _0x1c32b5=_0x27ee64;if(_0x2e6cd5!=_0x1c32b5(0x22e)&&config[_0x1c32b5(0x27b)]!=''){if(pid[_0x2e6cd5])pid[_0x2e6cd5]['send']({'function':_0x1c32b5(0x2e3),'args':null});}}function reloadBotManager(){const _0x500113=_0x27ee64;getClientsWithBotID('botmanager')[_0x500113(0x207)](_0x556d98=>{const _0x4723c4=_0x500113;getSocket(_0x556d98['id'])[_0x4723c4(0x25f)](_0x4723c4(0x188),{'access':{'allow':![],'reason':_0x4723c4(0x19c),'token':null}});});}function getSocket(_0x2f5d16){const _0x20e8e1=_0x27ee64;return io[_0x20e8e1(0x1c2)][_0x20e8e1(0x1c2)][_0x20e8e1(0x262)](_0x2f5d16);}function setAccess(_0xc4b5fb){const _0x138925=_0x27ee64,_0x38335c=getSocket(_0xc4b5fb['id']),_0x4e9e21=_0xc4b5fb[_0x138925(0x253)],_0x5261cd=_0xc4b5fb[_0x138925(0x184)];devices[_0x4e9e21][_0x138925(0x272)]=validateAccess(devices[_0x4e9e21][_0x138925(0x272)][_0x138925(0x2e8)],_0x4e9e21),_0x38335c[_0x138925(0x280)](_0x4e9e21);if(devices[_0x4e9e21]['access'][_0x138925(0x219)]){_0x38335c[_0x138925(0x280)](_0x5261cd);if(_0x5261cd==_0x138925(0x22e))initializeSocketBotManager(_0x38335c);else initializeSocketBot(_0x38335c);initClient(_0x5261cd);}devices[_0x4e9e21][_0x138925(0x272)]['token']&&devices[_0x4e9e21][_0x138925(0x272)][_0x138925(0x309)]==_0x138925(0x203)&&setSessionTimeout(_0x138925(0x244),_0x4e9e21),devices[_0x4e9e21]['access']['token']&&devices[_0x4e9e21][_0x138925(0x272)][_0x138925(0x309)]==_0x138925(0x1fc)&&setSessionTimeout(_0x138925(0x237),_0x4e9e21),_0x38335c['emit'](_0x138925(0x188),{'status':_0xc4b5fb[_0x138925(0x27c)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4e9e21][_0x138925(0x272)],'externalip':devices[_0x4e9e21]['ip'],'publicKey':secure[_0x138925(0x2c9)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x4e9e21][_0x138925(0x272)][_0x138925(0x219)]==![]&&devices[_0x4e9e21]['access']['reason']==_0x138925(0x295)&&temporaryAccess2FA(_0x4e9e21,devices[_0x4e9e21]['ip']);}function setSessionTimeout(_0x97440b,_0x1a6d37){const _0x1a2e07=_0x27ee64;let _0x30336c;if(_0x97440b==_0x1a2e07(0x237))_0x30336c=loginExpiry*0x3c*0x3e8;else _0x30336c=devices[_0x1a6d37][_0x1a2e07(0x226)][_0x1a2e07(0x1f1)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1a6d37][_0x1a2e07(0x226)][_0x1a2e07(0x324)]);if(devices[_0x1a6d37][_0x1a2e07(0x2ad)])clearTimeout(devices[_0x1a6d37][_0x1a2e07(0x2ad)]);devices[_0x1a6d37][_0x1a2e07(0x2ad)]=setTimeout(()=>{const _0x47af1c=_0x1a2e07;if(devices[_0x1a6d37][_0x47af1c(0x2bc)])clearTimeout(devices[_0x1a6d37]['pidRefreshToken']);removeSocketListeners(_0x1a6d37),addBlacklist(_0x1a6d37),devices[_0x1a6d37][_0x47af1c(0x226)]=null,devices[_0x1a6d37]['telegram2FaApproval']=null,devices[_0x1a6d37][_0x47af1c(0x272)][_0x47af1c(0x2e8)]=null,devices[_0x1a6d37]['access']=validateAccess(devices[_0x1a6d37]['access'][_0x47af1c(0x2e8)],_0x1a6d37),!(devices[_0x1a6d37][_0x47af1c(0x272)][_0x47af1c(0x219)]&&devices[_0x1a6d37][_0x47af1c(0x272)][_0x47af1c(0x309)]=='login\x20not\x20required')&&(_0x97440b==_0x47af1c(0x237)?io['to'](_0x1a6d37)['emit'](_0x47af1c(0x188),{'access':{'allow':![],'reason':_0x47af1c(0x2bf),'token':null}}):io['to'](_0x1a6d37)['emit'](_0x47af1c(0x188),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x1a6d37][_0x47af1c(0x272)][_0x47af1c(0x2e8)]=null;},_0x30336c);}function setTokenRefresh(_0x17baa3){const _0x59ed9b=_0x27ee64;if(devices[_0x17baa3][_0x59ed9b(0x2bc)])clearTimeout(devices[_0x17baa3][_0x59ed9b(0x2bc)]);devices[_0x17baa3][_0x59ed9b(0x2bc)]=setTimeout(()=>{const _0x49eac2=_0x59ed9b;getClientsWithUuid(_0x17baa3)[_0x49eac2(0x2d3)]!=0x0?(devices[_0x17baa3][_0x49eac2(0x272)]=refreshToken(_0x17baa3),io['to'](_0x17baa3)[_0x49eac2(0x25f)](_0x49eac2(0x188),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x17baa3][_0x49eac2(0x272)],'externalip':devices[_0x17baa3]['ip'],'publicKey':secure[_0x49eac2(0x2c9)],'validInstallation':validInstallation}),setTokenRefresh(_0x17baa3)):clearTimeout(devices[_0x17baa3][_0x49eac2(0x2bc)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x139b02){const _0x1e8ae6=_0x27ee64,_0x17530c=getClient(_0x139b02['id'])['uuid'];_0x139b02[_0x1e8ae6(0x25f)](_0x1e8ae6(0x30a),config),_0x139b02['emit']('settings',cleanSettings()),_0x139b02['on']('add-bot',_0x429cba=>{const _0x151b05=_0x1e8ae6;if(validateAccess(_0x429cba,_0x17530c)[_0x151b05(0x219)])addBot();else logger[_0x151b05(0x1f7)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x139b02['on'](_0x1e8ae6(0x278),(_0x2f2e5f,_0x39c0d3)=>{const _0xd6f1f2=_0x1e8ae6;if(validateAccess(_0x39c0d3,_0x17530c)[_0xd6f1f2(0x219)])toggleBot(_0x2f2e5f[_0xd6f1f2(0x1ba)],_0x2f2e5f[_0xd6f1f2(0x188)],_0x2f2e5f['live']);else logger[_0xd6f1f2(0x1f7)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x139b02['on'](_0x1e8ae6(0x315),(_0x1e128c,_0x25e4d6)=>{const _0x19ad83=_0x1e8ae6;if(validateAccess(_0x25e4d6,_0x17530c)[_0x19ad83(0x219)])toggleBotMode(_0x1e128c);else logger['full'](_0x19ad83(0x20a));}),_0x139b02['on']('delete-bot',(_0x145113,_0x5687e8)=>{const _0x113352=_0x1e8ae6;if(validateAccess(_0x5687e8,_0x17530c)['allow'])deleteBot(_0x145113);else logger[_0x113352(0x1f7)](_0x113352(0x2c0));}),_0x139b02['on'](_0x1e8ae6(0x31d),(_0x245aaf,_0x25e98f)=>{const _0x20cdbb=_0x1e8ae6;if(validateAccess(_0x25e98f,_0x17530c)[_0x20cdbb(0x219)])storeSettings(_0x245aaf,!![]);else logger[_0x20cdbb(0x1f7)](_0x20cdbb(0x2aa));}),_0x139b02['on']('update-bb',_0x207104=>{const _0x12a321=_0x1e8ae6;if(validateAccess(_0x207104,_0x17530c)[_0x12a321(0x219)])updateBB();else logger[_0x12a321(0x1f7)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x139b02['on']('get-messages',_0x482ad4=>{const _0x3dfd8d=_0x1e8ae6;if(validateAccess(_0x482ad4,_0x17530c)['allow'])getMessages();else logger[_0x3dfd8d(0x1f7)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x139b02['on'](_0x1e8ae6(0x2f9),(_0x8c1396,_0x2b6979)=>{const _0x5d8d94=_0x1e8ae6;if(validateAccess(_0x2b6979,_0x17530c)[_0x5d8d94(0x219)])confirmMessage(_0x8c1396);else logger[_0x5d8d94(0x1f7)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x139b02['on']('logout',_0x124b0c=>{const _0x54f121=_0x1e8ae6;if(validateAccess(_0x124b0c,_0x17530c)[_0x54f121(0x219)]){if(devices[_0x17530c]['pidRefreshToken'])clearTimeout(devices[_0x17530c][_0x54f121(0x2bc)]);if(devices[_0x17530c][_0x54f121(0x2ad)])clearTimeout(devices[_0x17530c]['pidExpireLogin']);removeSocketListeners(getClient(_0x139b02['id'])[_0x54f121(0x253)]),addBlacklist(_0x17530c),devices[_0x17530c][_0x54f121(0x226)]=null,devices[_0x17530c][_0x54f121(0x25a)]=null,devices[_0x17530c]['access'][_0x54f121(0x2e8)]=null,io['to'](getClient(_0x139b02['id'])[_0x54f121(0x253)])['emit'](_0x54f121(0x188),{'access':{'allow':![],'reason':_0x54f121(0x1e1),'token':null}});}else logger[_0x54f121(0x1f7)](_0x54f121(0x240));});}function initializeSocketBot(_0x47be87){const _0x295e79=_0x27ee64,_0x1ec42a=getClient(_0x47be87['id'])['bot'],_0xf152af=getClient(_0x47be87['id'])['uuid'];_0x47be87['on'](_0x295e79(0x2cf),(_0x3f21a0,_0x49d59e)=>{const _0x1e63b7=_0x295e79;if(validateAccess(_0x49d59e,_0xf152af)[_0x1e63b7(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a][_0x1e63b7(0x1bb)]({'function':_0x1e63b7(0x1c0),'args':_0x3f21a0});}else logger[_0x1e63b7(0x1f7)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x47be87['on'](_0x295e79(0x2d1),(_0x363a64,_0x2ffa90)=>{const _0x2cee86=_0x295e79;if(validateAccess(_0x2ffa90,_0xf152af)[_0x2cee86(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a][_0x2cee86(0x1bb)]({'function':_0x2cee86(0x31a),'args':_0x363a64});}else logger[_0x2cee86(0x1f7)](_0x2cee86(0x1f5));}),_0x47be87['on']('get-portfolio',(_0x3bef96,_0x227a82)=>{const _0x422af1=_0x295e79;if(validateAccess(_0x227a82,_0xf152af)[_0x422af1(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a]['send']({'function':'getPortfolio','args':_0x3bef96});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x47be87['on']('store-configuration',(_0x3fa3e1,_0x15f2e1)=>{const _0x967d34=_0x295e79;if(validateAccess(_0x15f2e1,_0xf152af)[_0x967d34(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a][_0x967d34(0x1bb)]({'function':_0x967d34(0x2c8),'args':_0x3fa3e1});}else logger[_0x967d34(0x1f7)](_0x967d34(0x249));}),_0x47be87['on'](_0x295e79(0x18e),(_0x4a35f,_0x243a2b)=>{const _0x4cbfe6=_0x295e79;if(validateAccess(_0x243a2b,_0xf152af)[_0x4cbfe6(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a][_0x4cbfe6(0x1bb)]({'function':_0x4cbfe6(0x311),'args':_0x4a35f});}else logger[_0x4cbfe6(0x1f7)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x47be87['on'](_0x295e79(0x304),_0x4ebb77=>{const _0x9a070c=_0x295e79;if(validateAccess(_0x4ebb77,_0xf152af)[_0x9a070c(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a][_0x9a070c(0x1bb)]({'function':_0x9a070c(0x23b),'args':null});}else logger[_0x9a070c(0x1f7)](_0x9a070c(0x273));}),_0x47be87['on']('place-order',(_0xeac7f1,_0x597191)=>{const _0x1b165b=_0x295e79;if(validateAccess(_0x597191,_0xf152af)[_0x1b165b(0x219)]){if(pid[_0x1ec42a])pid[_0x1ec42a][_0x1b165b(0x1bb)]({'function':_0x1b165b(0x292),'args':_0xeac7f1});}else logger[_0x1b165b(0x1f7)](_0x1b165b(0x1a9));}),_0x47be87['on'](_0x295e79(0x286),_0x761cc9=>{const _0x48afd2=_0x295e79;if(validateAccess(_0x761cc9,_0xf152af)['allow']){if(pid[_0x1ec42a])pid[_0x1ec42a]['send']({'function':_0x48afd2(0x252),'args':null});}else logger[_0x48afd2(0x1f7)](_0x48afd2(0x29a));}),_0x47be87['on'](_0x295e79(0x31e),_0x47630c=>{const _0x3bfc1a=_0x295e79;if(validateAccess(_0x47630c,_0xf152af)['allow']){if(pid[_0x1ec42a])pid[_0x1ec42a]['send']({'function':_0x3bfc1a(0x216),'args':null});}else logger[_0x3bfc1a(0x1f7)](_0x3bfc1a(0x228));}),_0x47be87['on'](_0x295e79(0x1f4),_0xb638b4=>{const _0x159497=_0x295e79;if(validateAccess(_0xb638b4,_0xf152af)[_0x159497(0x219)])updateBB();else logger[_0x159497(0x1f7)](_0x159497(0x23d));}),_0x47be87['on'](_0x295e79(0x24b),_0x139ee6=>{const _0x467209=_0x295e79;if(validateAccess(_0x139ee6,_0xf152af)[_0x467209(0x219)])getMessages();else logger[_0x467209(0x1f7)](_0x467209(0x22b));}),_0x47be87['on'](_0x295e79(0x2f9),(_0x47ec26,_0x9d4c2a)=>{const _0x3ec50a=_0x295e79;if(validateAccess(_0x9d4c2a,_0xf152af)[_0x3ec50a(0x219)])confirmMessage(_0x47ec26);else logger['full'](_0x3ec50a(0x29c));}),_0x47be87['on']('logout',_0x6982=>{const _0x4548e6=_0x295e79;if(validateAccess(_0x6982,_0xf152af)[_0x4548e6(0x219)]){if(devices[_0xf152af][_0x4548e6(0x2bc)])clearTimeout(devices[_0xf152af][_0x4548e6(0x2bc)]);if(devices[_0xf152af][_0x4548e6(0x2ad)])clearTimeout(devices[_0xf152af][_0x4548e6(0x2ad)]);removeSocketListeners(getClient(_0x47be87['id'])['uuid']),addBlacklist(_0xf152af),devices[_0xf152af]['telegramIpApproval']=null,devices[_0xf152af][_0x4548e6(0x25a)]=null,devices[_0xf152af][_0x4548e6(0x272)][_0x4548e6(0x2e8)]=null,io['to'](getClient(_0x47be87['id'])[_0x4548e6(0x253)])[_0x4548e6(0x25f)](_0x4548e6(0x188),{'access':{'allow':![],'reason':_0x4548e6(0x1e1),'token':null}});}else logger[_0x4548e6(0x1f7)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x720841){const _0xa77817=_0x27ee64;getClientsWithUuid(_0x720841)[_0xa77817(0x207)](_0x46d09b=>{const _0x5ad537=_0xa77817;getSocket(_0x46d09b['id'])[_0x5ad537(0x2a4)]();});}function cleanSettings(){const _0x2dd467=_0x27ee64;let _0x5b4e6f=settings;return settings[_0x2dd467(0x2f0)]&&settings['telegramToken']!=''&&(_0x5b4e6f={..._0x5b4e6f,'telegramToken':_0x2dd467(0x21e)}),settings[_0x2dd467(0x2ee)]&&settings['bbPassword']!=''&&(_0x5b4e6f={..._0x5b4e6f,'bbPassword':_0x2dd467(0x21e)}),(settings[_0x2dd467(0x2ee)]&&settings[_0x2dd467(0x2ee)]==_0x2dd467(0x1b9)||settings[_0x2dd467(0x2f0)]&&settings[_0x2dd467(0x2f0)]==_0x2dd467(0x1b9))&&(_0x5b4e6f={..._0x5b4e6f,'restored':{'password':settings[_0x2dd467(0x2ee)]==_0x2dd467(0x1b9),'telegram':settings['telegramToken']==_0x2dd467(0x1b9)}}),_0x5b4e6f;}function updateBB(){const _0x4475b0=_0x27ee64;installingUpdate=!![],config[_0x4475b0(0x207)](_0xc6303a=>{const _0x3eeaf5=_0x4475b0;restartBot(_0xc6303a[_0x3eeaf5(0x1ba)]);}),process[_0x4475b0(0x1bb)]({'update':!![]},_0x1ab6d6=>{});}function startBot(_0x2f549e,_0x871122,_0x13646d){const _0x5688bb=_0x27ee64;let _0xf0abb8=![];const _0x1e0345=_0x2f549e[0x0];_0x871122={..._0x871122,'stdio':[_0x5688bb(0x269),_0x5688bb(0x269),_0x5688bb(0x269),_0x5688bb(0x1fe)]},pid[_0x1e0345]=childProcess[_0x5688bb(0x322)](botfile,_0x2f549e,_0x871122),pid[_0x1e0345]['on'](_0x5688bb(0x271),_0xdc6dff=>{const _0x3b6967=_0x5688bb;switch(Object[_0x3b6967(0x2cb)](_0xdc6dff)[0x0]){case _0x3b6967(0x1c9):updateBotName(_0x1e0345,_0xdc6dff['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x3b6967(0x188):updateStatus(_0x1e0345,_0xdc6dff['status']);break;case _0x3b6967(0x182):updateLive(_0x1e0345,_0xdc6dff[_0x3b6967(0x182)]);break;case _0x3b6967(0x296):updateLive(_0x1e0345,_0xdc6dff[_0x3b6967(0x296)]),io['to'](_0x1e0345)[_0x3b6967(0x25f)](_0x3b6967(0x188),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3b6967(0x2c1):_0xdc6dff[_0x3b6967(0x2c1)]==_0x3b6967(0x1b8)&&restartBot(_0x1e0345);_0xdc6dff[_0x3b6967(0x2c1)]==_0x3b6967(0x30e)&&toggleBot(_0x1e0345,_0x3b6967(0x2be),_0x3b6967(0x2b0));break;case _0x3b6967(0x25c):sendTelegram(_0x1e0345,_0xdc6dff[_0x3b6967(0x25c)]);break;case'telegrammsg':sendTelegramMsg(_0xdc6dff[_0x3b6967(0x328)]);break;case _0x3b6967(0x257):io['to'](_0x1e0345)[_0x3b6967(0x25f)](_0xdc6dff[_0x3b6967(0x257)],_0xdc6dff['args']);break;}}),pid[_0x1e0345]['on']('error',function(_0x2c2267){if(_0xf0abb8)return;_0xf0abb8=!![],_0x13646d(_0x2c2267);}),pid[_0x1e0345]['on'](_0x5688bb(0x1a8),async function(_0x4f4e55){const _0x1e21c6=_0x5688bb;if(installingUpdate)return;if(_0xf0abb8)return;_0xf0abb8=!![],_0x13646d(null);const _0x4b12a1=dbConfig[_0x1e21c6(0x262)](_0x1e21c6(0x30a))['find']({'botID':_0x1e0345})[_0x1e21c6(0x2ae)]();_0x4b12a1&&(_0x4b12a1['status']==_0x1e21c6(0x1b2)||_0x4b12a1[_0x1e21c6(0x188)]==_0x1e21c6(0x26b))&&(await sleep(0x3e8),updateLive(_0x1e0345,_0x1e21c6(0x2b0)),logger[_0x1e21c6(0x1f7)](_0x1e21c6(0x1d0)+_0x1e0345),startBot([_0x1e0345,userID],{'cwd':bbpath},function(_0x30c1fe){const _0x10c88c=_0x1e21c6;if(_0x30c1fe)logger[_0x10c88c(0x1f7)](_0x30c1fe);}));});}function stopBot(_0xe8b989){const _0x535bb3=_0x27ee64;getClientsWithBotID(_0xe8b989)[_0x535bb3(0x207)](_0x4955ff=>{const _0x34b1f8=_0x535bb3;getSocket(_0x4955ff['id'])[_0x34b1f8(0x2b5)](!![]),removeClient(_0x4955ff['id']);}),pid[_0xe8b989]&&(pid[_0xe8b989][_0x535bb3(0x30e)](),pid[_0xe8b989]=null);}function restartBot(_0x5a3b8b){const _0x39707a=_0x27ee64;if(pid[_0x5a3b8b])pid[_0x5a3b8b][_0x39707a(0x30e)]();}function addBot(){const _0x8c0353=_0x27ee64;let _0xe8f0dd;for(let _0x1028bf=0x1;_0x1028bf<0x3e9;_0x1028bf++){_0xe8f0dd=_0x1028bf[_0x8c0353(0x2d0)]()['padStart'](0x3,'0');let _0x100c6a=config[_0x8c0353(0x275)](_0x3aef53=>_0x3aef53[_0x8c0353(0x1ba)]==_0xe8f0dd);if(!_0x100c6a)break;}if(_0xe8f0dd===_0x8c0353(0x2f1)){logger['full']('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x8c0353(0x1f7)]('starting\x20new\x20bot\x20|\x20Bot\x20'+_0xe8f0dd),dbConfig[_0x8c0353(0x262)](_0x8c0353(0x30a))[_0x8c0353(0x250)]({'botID':_0xe8f0dd,'botname':_0x8c0353(0x196)+_0xe8f0dd,'status':_0x8c0353(0x26b),'live':''})[_0x8c0353(0x235)](),startBot([_0xe8f0dd,userID],{'cwd':bbpath},function(_0x49d967){if(_0x49d967)logger['full'](_0x49d967);}),config=getConfiguration(),io['to'](_0x8c0353(0x22e))['emit']('bots',config);}function deleteBot(_0x40b839){const _0x4f096f=_0x27ee64;getClientsWithBotID(_0x40b839)['forEach'](_0x18ca78=>{getSocket(_0x18ca78['id'])['disconnect'](!![]),removeClient(_0x18ca78['id']);}),dbConfig[_0x4f096f(0x262)]('bots')[_0x4f096f(0x21c)]({'botID':_0x40b839})[_0x4f096f(0x235)](),logger['full'](_0x4f096f(0x1a4)+_0x40b839),stopBot(_0x40b839);try{if(fs['existsSync'](path['join'](configpath,_0x4f096f(0x19f)+_0x40b839+'-config.json')))fs[_0x4f096f(0x1e7)](path['join'](configpath,'bot-'+_0x40b839+'-config.json'));if(fs[_0x4f096f(0x1a1)](path[_0x4f096f(0x280)](configpath,_0x4f096f(0x19f)+_0x40b839+'-events.json')))fs['unlinkSync'](path[_0x4f096f(0x280)](configpath,_0x4f096f(0x19f)+_0x40b839+_0x4f096f(0x289)));if(fs[_0x4f096f(0x1a1)](path[_0x4f096f(0x280)](configpath,'bot-'+_0x40b839+_0x4f096f(0x285))))fs[_0x4f096f(0x1e7)](path[_0x4f096f(0x280)](configpath,'bot-'+_0x40b839+_0x4f096f(0x285)));if(fs[_0x4f096f(0x1a1)](path['join'](configpath,_0x4f096f(0x19f)+_0x40b839+_0x4f096f(0x2f8))))fs[_0x4f096f(0x1e7)](path['join'](configpath,_0x4f096f(0x19f)+_0x40b839+_0x4f096f(0x2f8)));}catch(_0x2fd4cd){if(_0x2fd4cd)logger['full']('error\x20while\x20deleting\x20config\x20files:\x20',_0x2fd4cd);}config=getConfiguration(),io['to'](_0x4f096f(0x22e))[_0x4f096f(0x25f)](_0x4f096f(0x30a),config);}function toggleBot(_0x5a19a5,_0x192d16,_0xbb91a7){const _0x29c654=_0x27ee64;dbConfig[_0x29c654(0x262)](_0x29c654(0x30a))['find']({'botID':_0x5a19a5})[_0x29c654(0x25d)]({'status':_0x192d16})['assign']({'live':_0xbb91a7})[_0x29c654(0x235)]();if(_0x192d16==_0x29c654(0x1b2)||_0x192d16==_0x29c654(0x26b))logger[_0x29c654(0x1f7)](_0x29c654(0x24a)+_0x5a19a5),startBot([_0x5a19a5,userID],{'cwd':bbpath},function(_0x162a3b){const _0x1eafbb=_0x29c654;if(_0x162a3b)logger[_0x1eafbb(0x1f7)](_0x162a3b);});else(_0x192d16==_0x29c654(0x2be)||_0x192d16==_0x29c654(0x186))&&(logger['full'](_0x29c654(0x2b2)+_0x5a19a5),stopBot(_0x5a19a5));config=getConfiguration(),io['to'](_0x29c654(0x22e))['emit'](_0x29c654(0x30a),config);}function toggleStatus(_0x2157bc){const _0xa0e15e=_0x27ee64;let _0x455702=dbConfig[_0xa0e15e(0x262)](_0xa0e15e(0x30a))[_0xa0e15e(0x275)]({'botID':_0x2157bc})[_0xa0e15e(0x2ae)](),_0x2ae357;if(_0x455702[_0xa0e15e(0x188)]===_0xa0e15e(0x1b2))_0x2ae357=_0xa0e15e(0x2be);else{if(_0x455702['status']===_0xa0e15e(0x26b))_0x2ae357=_0xa0e15e(0x186);else{if(_0x455702[_0xa0e15e(0x188)]==='new-disabled')_0x2ae357=_0xa0e15e(0x26b);else{if(_0x455702[_0xa0e15e(0x188)]===_0xa0e15e(0x2be))_0x2ae357=_0xa0e15e(0x1b2);}}}return _0x2ae357;}function updateStatus(_0x2d1e38,_0x5b2baa){const _0x38c77d=_0x27ee64;dbConfig[_0x38c77d(0x262)]('bots')[_0x38c77d(0x275)]({'botID':_0x2d1e38})[_0x38c77d(0x25d)]({'status':_0x5b2baa})[_0x38c77d(0x235)](),config=getConfiguration(),io['to'](_0x38c77d(0x22e))[_0x38c77d(0x25f)](_0x38c77d(0x30a),config);}function updateLive(_0x563604,_0x1474e9){const _0x15116f=_0x27ee64;dbConfig[_0x15116f(0x262)](_0x15116f(0x30a))['find']({'botID':_0x563604})[_0x15116f(0x25d)]({'live':_0x1474e9})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x15116f(0x25f)]('bots',config);}function updateBotName(_0x1d358c,_0x55e7d2){const _0x554d01=_0x27ee64;dbConfig[_0x554d01(0x262)](_0x554d01(0x30a))[_0x554d01(0x275)]({'botID':_0x1d358c})[_0x554d01(0x25d)]({'botname':_0x55e7d2})[_0x554d01(0x235)](),config=getConfiguration(),io['to']('botmanager')[_0x554d01(0x25f)]('bots',config);}function updateBotManager(){const _0x3f7dac=_0x27ee64;config=getConfiguration(),io['to'](_0x3f7dac(0x22e))[_0x3f7dac(0x25f)](_0x3f7dac(0x30a),config);}function toggleBotMode(_0x132853){const _0x19fc2c=_0x27ee64;if(pid[_0x132853])pid[_0x132853]['send']({'function':'toggleBotMode','args':null});else{const _0x4df7c3=configpath+_0x19fc2c(0x19f)+_0x132853+_0x19fc2c(0x260),_0x4dc013=fs[_0x19fc2c(0x227)](_0x4df7c3),_0x2c0149=JSON[_0x19fc2c(0x221)](_0x4dc013),_0x38b74c=_0x2c0149[_0x19fc2c(0x184)][0x0][_0x19fc2c(0x319)];_0x2c0149[_0x19fc2c(0x184)][0x0][_0x19fc2c(0x319)]=!_0x38b74c;const _0x17ed53=JSON[_0x19fc2c(0x1d4)](_0x2c0149,null,0x2);fs['writeFileSync'](_0x4df7c3,_0x17ed53),config=getConfiguration(),io['to'](_0x19fc2c(0x22e))[_0x19fc2c(0x25f)]('bots',config);}}function telegramError(_0x29a0cf){const _0x1876c7=_0x27ee64;logger['simple'](getTimeStamp()+_0x1876c7(0x202));}function validateTelegram(_0x2cff13){const _0x43963a=_0x27ee64;if(_0x2cff13[_0x43963a(0x1c1)]['username']!=settings[_0x43963a(0x325)]&&'@'+_0x2cff13['from']['username']!=settings[_0x43963a(0x325)])return tgBot[_0x43963a(0x239)](_0x2cff13['chat']['id'],_0x43963a(0x230),{'parse_mode':_0x43963a(0x29f)})[_0x43963a(0x294)](_0x1281ee=>{telegramError(_0x1281ee);}),![];return!![];}async function initTelegram(){const _0x135171=_0x27ee64;if(tgBot)tgBot[_0x135171(0x2fd)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x135171(0x2f0)],{'polling':!![]});let _0x58da38=_0x135171(0x191);_0x58da38+='\x0a',_0x58da38+=_0x135171(0x2a8),_0x58da38+=_0x135171(0x1a7),_0x58da38+=_0x135171(0x1d7),_0x58da38+=_0x135171(0x28e),_0x58da38+=_0x135171(0x1e9),_0x58da38+=_0x135171(0x2e6),_0x58da38+=_0x135171(0x2d7),_0x58da38+=_0x135171(0x2b6),_0x58da38+=_0x135171(0x1ad),_0x58da38+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x58da38+=_0x135171(0x1e0),_0x58da38+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x35ae3e=_0x135171(0x187);_0x35ae3e+='\x0a',_0x35ae3e+=_0x58da38,tgBot[_0x135171(0x2f7)](/\/start/,_0x37af11=>{const _0x3b72f3=_0x135171;if(!validateTelegram(_0x37af11))return;if(settings['telegramChatId']!=_0x37af11[_0x3b72f3(0x220)]['id'])updateSetting(_0x3b72f3(0x233),_0x37af11['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x3b72f3(0x239)](_0x37af11[_0x3b72f3(0x220)]['id'],_0x35ae3e)[_0x3b72f3(0x294)](_0x37375d=>{telegramError(_0x37375d);});}),tgBot[_0x135171(0x2f7)](/\/enable/,_0x57ff87=>{const _0x1f7eef=_0x135171;if(!validateTelegram(_0x57ff87))return;if(settings[_0x1f7eef(0x233)]!=_0x57ff87[_0x1f7eef(0x220)]['id'])updateSetting(_0x1f7eef(0x233),_0x57ff87[_0x1f7eef(0x220)]['id']);updateSetting(_0x1f7eef(0x2b3),!![]),tgBot[_0x1f7eef(0x239)](_0x57ff87[_0x1f7eef(0x220)]['id'],'Notifications\x20enabled')[_0x1f7eef(0x294)](_0x2b8241=>{telegramError(_0x2b8241);});}),tgBot[_0x135171(0x2f7)](/\/config/,async _0x5931ec=>{const _0x37dbb8=_0x135171;if(!validateTelegram(_0x5931ec))return;tgBot[_0x37dbb8(0x1ed)](_0x37dbb8(0x224)),tgBot[_0x37dbb8(0x239)](_0x5931ec['chat']['id'],_0x37dbb8(0x1c4),{'reply_markup':{'inline_keyboard':[[{'text':_0x37dbb8(0x19e),'callback_data':_0x37dbb8(0x2a1)},{'text':_0x37dbb8(0x1c6),'callback_data':_0x37dbb8(0x22f)},{'text':'All','callback_data':_0x37dbb8(0x185)}]]}})[_0x37dbb8(0x294)](_0x34703d=>{telegramError(_0x34703d);}),tgBot['on']('callback_query',async _0x59d407=>{const _0x3a7a2c=_0x37dbb8,_0x61c02a=_0x59d407[_0x3a7a2c(0x2ba)],_0x24aabf=_0x59d407[_0x3a7a2c(0x271)];tgBot[_0x3a7a2c(0x241)](_0x59d407['id'])['then'](async()=>{const _0x1cb666=_0x3a7a2c;_0x61c02a==_0x1cb666(0x2a1)&&(updateSetting('telegramEvents','orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x1cb666(0x239)](_0x24aabf[_0x1cb666(0x220)]['id'],_0x1cb666(0x2a6))[_0x1cb666(0x294)](_0x2e3aa1=>{telegramError(_0x2e3aa1);}));_0x61c02a==_0x1cb666(0x22f)&&(updateSetting(_0x1cb666(0x190),_0x1cb666(0x22f)),updateSetting(_0x1cb666(0x2b3),!![]),await tgBot['sendMessage'](_0x24aabf[_0x1cb666(0x220)]['id'],_0x1cb666(0x2f3))[_0x1cb666(0x294)](_0x5b3c67=>{telegramError(_0x5b3c67);}));_0x61c02a==_0x1cb666(0x185)&&(updateSetting(_0x1cb666(0x190),_0x1cb666(0x185)),updateSetting(_0x1cb666(0x2b3),!![]),await tgBot[_0x1cb666(0x239)](_0x24aabf[_0x1cb666(0x220)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x1cb666(0x294)](_0x8acf5f=>{telegramError(_0x8acf5f);}));if(!settings[_0x1cb666(0x233)])tgBot[_0x1cb666(0x239)](_0x24aabf['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x1cb666(0x294)](_0x55b391=>{telegramError(_0x55b391);});}),tgBot['removeListener'](_0x3a7a2c(0x224));});}),tgBot[_0x135171(0x2f7)](/\/status/,_0x51bebc=>{const _0x401f01=_0x135171;if(!validateTelegram(_0x51bebc))return;const _0x463756=getBotsWithMode();let _0x4d1407=_0x401f01(0x22a);config[_0x401f01(0x207)](_0x13d631=>{const _0x58d59f=_0x401f01,_0x57674b=_0x463756[_0x58d59f(0x275)](_0x7f5a18=>_0x7f5a18[_0x58d59f(0x1ba)]==_0x13d631[_0x58d59f(0x1ba)])[_0x58d59f(0x283)];_0x4d1407+=_0x58d59f(0x196)+_0x13d631[_0x58d59f(0x1ba)]+':\x20'+_0x13d631[_0x58d59f(0x188)]+_0x58d59f(0x281)+_0x57674b+_0x58d59f(0x281)+_0x13d631[_0x58d59f(0x182)]+'\x0a';}),_0x4d1407+='\x0a',_0x4d1407+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4d1407+=!settings[_0x401f01(0x2b3)]?'Notifications\x20disabled\x0a':_0x401f01(0x1f3),_0x4d1407+=settings[_0x401f01(0x2b3)]?settings[_0x401f01(0x190)]==_0x401f01(0x185)?_0x401f01(0x197):_0x401f01(0x1f8)+settings['telegramEvents']+_0x401f01(0x1dd):'',tgBot[_0x401f01(0x239)](_0x51bebc[_0x401f01(0x220)]['id'],_0x4d1407,{'parse_mode':_0x401f01(0x29f)})[_0x401f01(0x294)](_0x4b23a6=>{telegramError(_0x4b23a6);});}),tgBot[_0x135171(0x2f7)](/\/restart/,_0x4015e4=>{const _0x1b7741=_0x135171;if(!validateTelegram(_0x4015e4))return;tgBot[_0x1b7741(0x1ed)](_0x1b7741(0x224));const _0x11065b=getEnabledBots();if(_0x11065b['length']==0x0)tgBot[_0x1b7741(0x239)](_0x4015e4[_0x1b7741(0x220)]['id'],_0x1b7741(0x27e))[_0x1b7741(0x294)](_0x535007=>{telegramError(_0x535007);});else{if(_0x11065b[_0x1b7741(0x2d3)]>0x1)_0x11065b[_0x1b7741(0x250)]({'botID':'all'});let _0x535759=[],_0x22c562=[];const _0x1a4db1=_0x11065b[_0x1b7741(0x2d3)]%0x4==0x0||_0x11065b['length']%0x4==0x3||_0x11065b['length']%0x3==0x1?0x4:0x3;let _0x5198c9=0x0;_0x11065b[_0x1b7741(0x207)]((_0x4564ed,_0x50dc27)=>{const _0x58a751=_0x1b7741;if(_0x50dc27%_0x1a4db1==0x0)_0x22c562=[];_0x22c562[_0x58a751(0x250)]({'text':_0x4564ed[_0x58a751(0x1ba)]==_0x58a751(0x185)?'All\x20bots':'Bot\x20'+_0x4564ed[_0x58a751(0x1ba)],'callback_data':_0x4564ed[_0x58a751(0x1ba)]}),_0x50dc27%_0x1a4db1==0x0&&(_0x535759[_0x5198c9]=_0x22c562,_0x5198c9++);}),tgBot[_0x1b7741(0x239)](_0x4015e4['chat']['id'],_0x1b7741(0x24d),{'reply_markup':{'inline_keyboard':_0x535759}})[_0x1b7741(0x294)](_0x3326c0=>{telegramError(_0x3326c0);}),tgBot['on'](_0x1b7741(0x224),async _0x533002=>{const _0x1fbcbb=_0x1b7741,_0x2ec40e=_0x533002[_0x1fbcbb(0x2ba)],_0x3310ca=_0x533002[_0x1fbcbb(0x271)];tgBot[_0x1fbcbb(0x241)](_0x533002['id'])[_0x1fbcbb(0x299)](async()=>{const _0x44816f=_0x1fbcbb;_0x2ec40e==_0x44816f(0x185)?config[_0x44816f(0x207)](_0x2d19fa=>{restartBot(_0x2d19fa['botID']);}):restartBot(_0x2ec40e);}),tgBot[_0x1fbcbb(0x1ed)](_0x1fbcbb(0x224));});}}),tgBot[_0x135171(0x2f7)](/\/on/,_0x4cb5df=>{const _0x33fb7f=_0x135171;if(!validateTelegram(_0x4cb5df))return;tgBot['removeListener'](_0x33fb7f(0x224));const _0x1f0b2c=getDisabledBots();if(_0x1f0b2c[_0x33fb7f(0x2d3)]==0x0)tgBot['sendMessage'](_0x4cb5df[_0x33fb7f(0x220)]['id'],_0x33fb7f(0x2bb))['catch'](_0x10127a=>{telegramError(_0x10127a);});else{if(_0x1f0b2c[_0x33fb7f(0x2d3)]>0x1)_0x1f0b2c[_0x33fb7f(0x250)]({'botID':'all'});let _0x15b5c4=[],_0x62ee70=[];const _0x25fc21=_0x1f0b2c[_0x33fb7f(0x2d3)]%0x4==0x0||_0x1f0b2c[_0x33fb7f(0x2d3)]%0x4==0x3||_0x1f0b2c[_0x33fb7f(0x2d3)]%0x3==0x1?0x4:0x3;let _0x342784=0x0;_0x1f0b2c[_0x33fb7f(0x207)]((_0xeb2df2,_0x2227c9)=>{const _0x328242=_0x33fb7f;if(_0x2227c9%_0x25fc21==0x0)_0x62ee70=[];_0x62ee70[_0x328242(0x250)]({'text':_0xeb2df2[_0x328242(0x1ba)]==_0x328242(0x185)?_0x328242(0x18c):_0x328242(0x196)+_0xeb2df2[_0x328242(0x1ba)],'callback_data':_0xeb2df2['botID']}),_0x2227c9%_0x25fc21==0x0&&(_0x15b5c4[_0x342784]=_0x62ee70,_0x342784++);}),tgBot[_0x33fb7f(0x239)](_0x4cb5df['chat']['id'],_0x33fb7f(0x1b4),{'reply_markup':{'inline_keyboard':_0x15b5c4}})[_0x33fb7f(0x294)](_0x58694e=>{telegramError(_0x58694e);}),tgBot['on']('callback_query',async _0x515d0c=>{const _0x185606=_0x33fb7f,_0xee2b64=_0x515d0c[_0x185606(0x2ba)],_0x11df2a=_0x515d0c['message'];tgBot['answerCallbackQuery'](_0x515d0c['id'])['then'](async()=>{const _0x417410=_0x185606;_0xee2b64==_0x417410(0x185)?(tgBot[_0x417410(0x239)](_0x11df2a[_0x417410(0x220)]['id'],_0x417410(0x30f))[_0x417410(0x294)](_0x369693=>{telegramError(_0x369693);}),_0x1f0b2c[_0x417410(0x207)](_0x17a300=>{const _0x4f4590=_0x417410;if(_0x17a300[_0x4f4590(0x1ba)]!=_0x4f4590(0x185))toggleBot(_0x17a300['botID'],toggleStatus(_0x17a300[_0x4f4590(0x1ba)]),_0x4f4590(0x2b0));})):(tgBot[_0x417410(0x239)](_0x11df2a['chat']['id'],_0x417410(0x2b9)+_0xee2b64)[_0x417410(0x294)](_0x6531e6=>{telegramError(_0x6531e6);}),toggleBot(_0xee2b64,toggleStatus(_0xee2b64),_0x417410(0x2b0)));}),tgBot[_0x185606(0x1ed)](_0x185606(0x224));});}}),tgBot[_0x135171(0x2f7)](/\/off/,_0x44a510=>{const _0x5a31ee=_0x135171;if(!validateTelegram(_0x44a510))return;tgBot[_0x5a31ee(0x1ed)](_0x5a31ee(0x224));const _0x290cf7=getEnabledBots();if(_0x290cf7[_0x5a31ee(0x2d3)]==0x0)tgBot[_0x5a31ee(0x239)](_0x44a510['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x5a31ee(0x294)](_0x214832=>{telegramError(_0x214832);});else{if(_0x290cf7[_0x5a31ee(0x2d3)]>0x1)_0x290cf7[_0x5a31ee(0x250)]({'botID':_0x5a31ee(0x185)});let _0x2848bc=[],_0x13d516=[];const _0x4a38d3=_0x290cf7[_0x5a31ee(0x2d3)]%0x4==0x0||_0x290cf7['length']%0x4==0x3||_0x290cf7['length']%0x3==0x1?0x4:0x3;let _0x4d79cc=0x0;_0x290cf7[_0x5a31ee(0x207)]((_0x514880,_0x3749d9)=>{const _0x48614a=_0x5a31ee;if(_0x3749d9%_0x4a38d3==0x0)_0x13d516=[];_0x13d516[_0x48614a(0x250)]({'text':_0x514880[_0x48614a(0x1ba)]==_0x48614a(0x185)?_0x48614a(0x18c):'Bot\x20'+_0x514880[_0x48614a(0x1ba)],'callback_data':_0x514880[_0x48614a(0x1ba)]}),_0x3749d9%_0x4a38d3==0x0&&(_0x2848bc[_0x4d79cc]=_0x13d516,_0x4d79cc++);}),tgBot[_0x5a31ee(0x239)](_0x44a510[_0x5a31ee(0x220)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x2848bc}})['catch'](_0x456154=>{telegramError(_0x456154);}),tgBot['on']('callback_query',async _0x4fcf7c=>{const _0xbddbc4=_0x5a31ee,_0x16fa78=_0x4fcf7c['data'],_0x293555=_0x4fcf7c[_0xbddbc4(0x271)];tgBot[_0xbddbc4(0x241)](_0x4fcf7c['id'])[_0xbddbc4(0x299)](async()=>{const _0x1b09a6=_0xbddbc4;_0x16fa78==_0x1b09a6(0x185)?(tgBot[_0x1b09a6(0x239)](_0x293555[_0x1b09a6(0x220)]['id'],_0x1b09a6(0x181))[_0x1b09a6(0x294)](_0x525c51=>{telegramError(_0x525c51);}),_0x290cf7[_0x1b09a6(0x207)](_0x3fa3cb=>{const _0x5c191a=_0x1b09a6;if(_0x3fa3cb[_0x5c191a(0x1ba)]!=_0x5c191a(0x185))toggleBot(_0x3fa3cb[_0x5c191a(0x1ba)],toggleStatus(_0x3fa3cb['botID']),'stopped');})):(tgBot[_0x1b09a6(0x239)](_0x293555['chat']['id'],_0x1b09a6(0x1a5)+_0x16fa78)[_0x1b09a6(0x294)](_0x3e3c53=>{telegramError(_0x3e3c53);}),toggleBot(_0x16fa78,toggleStatus(_0x16fa78),_0x1b09a6(0x2b0)));}),tgBot[_0xbddbc4(0x1ed)]('callback_query');});}}),tgBot[_0x135171(0x2f7)](/\/portfolio/,_0x216446=>{const _0x44c3ef=_0x135171;if(!validateTelegram(_0x216446))return;tgBot['removeListener'](_0x44c3ef(0x224));const _0x420d29=getEnabledBots();if(_0x420d29[_0x44c3ef(0x2d3)]==0x0)tgBot['sendMessage'](_0x216446[_0x44c3ef(0x220)]['id'],_0x44c3ef(0x27e))[_0x44c3ef(0x294)](_0x5835aa=>{telegramError(_0x5835aa);});else{if(_0x420d29[_0x44c3ef(0x2d3)]>0x1){let _0x1f5fa3=[],_0xa60637=[];const _0x121fe0=_0x420d29['length']%0x4==0x0||_0x420d29[_0x44c3ef(0x2d3)]%0x4==0x3||_0x420d29[_0x44c3ef(0x2d3)]%0x3==0x1?0x4:0x3;let _0x2792c4=0x0;_0x420d29[_0x44c3ef(0x207)]((_0x375f6e,_0x45e384)=>{const _0x373397=_0x44c3ef;if(_0x45e384%_0x121fe0==0x0)_0xa60637=[];_0xa60637[_0x373397(0x250)]({'text':_0x373397(0x196)+_0x375f6e['botID'],'callback_data':_0x375f6e[_0x373397(0x1ba)]}),_0x45e384%_0x121fe0==0x0&&(_0x1f5fa3[_0x2792c4]=_0xa60637,_0x2792c4++);}),tgBot[_0x44c3ef(0x239)](_0x216446['chat']['id'],_0x44c3ef(0x22c),{'reply_markup':{'inline_keyboard':_0x1f5fa3}})[_0x44c3ef(0x294)](_0x3a14a7=>{telegramError(_0x3a14a7);}),tgBot['on']('callback_query',async _0xf90903=>{const _0x159674=_0x44c3ef,_0x15fb59=_0xf90903['data'],_0x39482b=_0xf90903[_0x159674(0x271)];tgBot[_0x159674(0x241)](_0xf90903['id'])[_0x159674(0x299)](async()=>{const _0x3f825f=_0x159674;if(pid[_0x15fb59])pid[_0x15fb59][_0x3f825f(0x1bb)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x159674(0x1ed)]('callback_query');});}else{const _0x492021=_0x420d29[0x0][_0x44c3ef(0x1ba)];if(pid[_0x492021])pid[_0x492021][_0x44c3ef(0x1bb)]({'function':_0x44c3ef(0x1fa),'args':null});}}}),tgBot[_0x135171(0x2f7)](/\/update/,async _0x4d62fd=>{const _0x40e42c=_0x135171;if(!validateTelegram(_0x4d62fd))return;tgBot['removeListener']('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x40e42c(0x239)](_0x4d62fd[_0x40e42c(0x220)]['id'],_0x40e42c(0x1df))[_0x40e42c(0x294)](_0x12c542=>{telegramError(_0x12c542);});else!validInstallation?tgBot['sendMessage'](_0x4d62fd[_0x40e42c(0x220)]['id'],_0x40e42c(0x23e))[_0x40e42c(0x294)](_0x25882a=>{telegramError(_0x25882a);}):(tgBot[_0x40e42c(0x239)](_0x4d62fd[_0x40e42c(0x220)]['id'],_0x40e42c(0x2cd),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x40e42c(0x26d)},{'text':'No','callback_data':'no'}]]}})[_0x40e42c(0x294)](_0x152710=>{telegramError(_0x152710);}),tgBot['on'](_0x40e42c(0x224),async _0x4f5357=>{const _0x200412=_0x40e42c,_0x143ef5=_0x4f5357[_0x200412(0x2ba)],_0x155ae6=_0x4f5357['message'];tgBot[_0x200412(0x241)](_0x4f5357['id'])[_0x200412(0x299)](async()=>{const _0x2ffcf0=_0x200412;_0x143ef5=='yes'&&(await tgBot[_0x2ffcf0(0x239)](_0x155ae6[_0x2ffcf0(0x220)]['id'],_0x2ffcf0(0x1c5))[_0x2ffcf0(0x294)](_0x2fb3a0=>{telegramError(_0x2fb3a0);}),updateBB());_0x143ef5=='no'&&await tgBot[_0x2ffcf0(0x239)](_0x155ae6[_0x2ffcf0(0x220)]['id'],_0x2ffcf0(0x327))['catch'](_0x2bc9e2=>{telegramError(_0x2bc9e2);});if(!settings['telegramChatId'])tgBot[_0x2ffcf0(0x239)](_0x155ae6[_0x2ffcf0(0x220)]['id'],_0x2ffcf0(0x28c))['catch'](_0x499c1e=>{telegramError(_0x499c1e);});}),tgBot[_0x200412(0x1ed)]('callback_query');}));}),tgBot[_0x135171(0x2f7)](/\/toggle/,_0x314a4c=>{const _0x1eaa2a=_0x135171;if(!validateTelegram(_0x314a4c))return;tgBot[_0x1eaa2a(0x1ed)](_0x1eaa2a(0x224));const _0x350f1b=getBotsWithMode();if(_0x350f1b[_0x1eaa2a(0x2d3)]==0x0)tgBot[_0x1eaa2a(0x239)](_0x314a4c['chat']['id'],_0x1eaa2a(0x27e))[_0x1eaa2a(0x294)](_0x25bcc0=>{telegramError(_0x25bcc0);});else{let _0x1bf8a6=[],_0x5d0f35=[];const _0x447362=0x2;let _0x364176=0x0;_0x350f1b[_0x1eaa2a(0x207)]((_0x24dbaa,_0x3b4d76)=>{const _0x45086b=_0x1eaa2a;if(_0x3b4d76%_0x447362==0x0)_0x5d0f35=[];_0x5d0f35['push']({'text':_0x45086b(0x196)+_0x24dbaa[_0x45086b(0x1ba)]+'\x20('+_0x24dbaa[_0x45086b(0x283)]+')','callback_data':_0x24dbaa['botID']}),_0x3b4d76%_0x447362==0x0&&(_0x1bf8a6[_0x364176]=_0x5d0f35,_0x364176++);}),tgBot[_0x1eaa2a(0x239)](_0x314a4c[_0x1eaa2a(0x220)]['id'],_0x1eaa2a(0x204),{'reply_markup':{'inline_keyboard':_0x1bf8a6}})[_0x1eaa2a(0x294)](_0x3f50b3=>{telegramError(_0x3f50b3);}),tgBot['on'](_0x1eaa2a(0x224),async _0x4a1fc6=>{const _0x1cba2f=_0x1eaa2a,_0x502971=_0x4a1fc6[_0x1cba2f(0x2ba)],_0x311a0d=_0x4a1fc6[_0x1cba2f(0x271)];tgBot[_0x1cba2f(0x241)](_0x4a1fc6['id'])[_0x1cba2f(0x299)](async()=>{const _0x361dd5=_0x1cba2f,_0x28ed68=_0x350f1b[_0x361dd5(0x275)](_0x1c6c16=>_0x1c6c16[_0x361dd5(0x1ba)]==_0x502971),_0x379e27=_0x28ed68[_0x361dd5(0x283)]==_0x361dd5(0x31b)?_0x361dd5(0x2fc):'auto';tgBot[_0x361dd5(0x239)](_0x311a0d[_0x361dd5(0x220)]['id'],_0x361dd5(0x287)+_0x502971+_0x361dd5(0x279)+_0x379e27+_0x361dd5(0x25e))[_0x361dd5(0x294)](_0x365ff7=>{telegramError(_0x365ff7);}),toggleBotMode(_0x502971);}),tgBot[_0x1cba2f(0x1ed)](_0x1cba2f(0x224));});}}),tgBot[_0x135171(0x2f7)](/\/names/,_0x4e7f93=>{const _0x50e9c0=_0x135171;if(!validateTelegram(_0x4e7f93))return;let _0x292c07='';config[_0x50e9c0(0x207)](_0x47c8e1=>{const _0x537254=_0x50e9c0;_0x292c07+=_0x537254(0x196)+_0x47c8e1[_0x537254(0x1ba)]+':\x20'+_0x47c8e1[_0x537254(0x1c9)]+'\x0a';}),tgBot[_0x50e9c0(0x239)](_0x4e7f93[_0x50e9c0(0x220)]['id'],_0x292c07,{'parse_mode':_0x50e9c0(0x29f)})[_0x50e9c0(0x294)](_0x1103f7=>{telegramError(_0x1103f7);});}),tgBot[_0x135171(0x2f7)](/\/disable/,_0x478524=>{const _0x14d3ff=_0x135171;if(!validateTelegram(_0x478524))return;tgBot[_0x14d3ff(0x239)](_0x478524[_0x14d3ff(0x220)]['id'],_0x14d3ff(0x20b))[_0x14d3ff(0x294)](_0x36d7f8=>{telegramError(_0x36d7f8);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x135171(0x2f7)](/\/help/,_0x4c8330=>{const _0x224cf8=_0x135171;if(!validateTelegram(_0x4c8330))return;tgBot['sendMessage'](_0x4c8330[_0x224cf8(0x220)]['id'],_0x58da38)['catch'](_0x50d10b=>{telegramError(_0x50d10b);});}),tgBot['on'](_0x135171(0x264),_0x1ac507=>{const _0x1f0d9b=_0x135171;_0x1ac507[_0x1f0d9b(0x2d0)]()[_0x1f0d9b(0x29b)](_0x1f0d9b(0x192))&&(logger['full'](_0x1f0d9b(0x1ab)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x1f0d9b(0x22e))['emit'](_0x1f0d9b(0x1ea),_0x1f0d9b(0x1ab)));}),process['once'](_0x135171(0x19d),()=>{const _0x1c70da=_0x135171;if(tgBot)tgBot[_0x1c70da(0x2fd)]();process[_0x1c70da(0x1a8)](0x1);}),process['once'](_0x135171(0x1a0),()=>{const _0x1b8dd9=_0x135171;if(tgBot)tgBot[_0x1b8dd9(0x2fd)]();process[_0x1b8dd9(0x1a8)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1b9f1b,_0x1c5702){const _0x39373d=_0x27ee64;if(settings['telegramEnabled']){if(settings[_0x39373d(0x190)]==_0x39373d(0x185)||(_0x1c5702[_0x39373d(0x305)]==_0x39373d(0x1bf)||_0x1c5702['type']=='warning'||_0x1c5702[_0x39373d(0x305)]==_0x39373d(0x2d8))&&settings[_0x39373d(0x190)]==_0x39373d(0x22f)||_0x1c5702[_0x39373d(0x305)]==_0x39373d(0x201)&&settings[_0x39373d(0x190)]==_0x39373d(0x2a1)){if(tgBot&&settings[_0x39373d(0x233)]){if(_0x1c5702[_0x39373d(0x238)])tgBot['sendMessage'](settings[_0x39373d(0x233)],_0x1c5702[_0x39373d(0x1c9)]+_0x39373d(0x21d)+_0x1c5702[_0x39373d(0x288)])[_0x39373d(0x294)](_0xf0d90f=>{telegramError(_0xf0d90f);});else tgBot['sendMessage'](settings[_0x39373d(0x233)],_0x39373d(0x196)+_0x1b9f1b+_0x39373d(0x21d)+_0x1c5702[_0x39373d(0x288)])['catch'](_0x3ed789=>{telegramError(_0x3ed789);});}}}}async function sendTelegramMsg(_0x912b67,_0x9728c=_0x27ee64(0x29f)){const _0x117236=_0x27ee64;return settings[_0x117236(0x2b3)]&&tgBot&&settings[_0x117236(0x233)]?(await tgBot[_0x117236(0x239)](settings[_0x117236(0x233)],_0x912b67,{'parse_mode':_0x9728c})[_0x117236(0x294)](_0x41ad42=>{telegramError(_0x41ad42);}),!![]):![];}function getDeviceWithIp(_0x522587){const _0x5466c1=_0x27ee64;return devices[_0x5466c1(0x275)](_0x59914d=>_0x59914d['ip']===_0x522587);}function temporaryAccess2FA(_0x206215,_0x3430bf){const _0x48a1f2=_0x27ee64;let _0x1382ce=new Date(),_0x224037=![];if(lastIpApproval){if(_0x1382ce-lastIpApproval<0x1388)_0x224037=!![];}lastIpApproval=new Date();if(_0x224037)return;tgBot&&settings[_0x48a1f2(0x233)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x48a1f2(0x239)](settings[_0x48a1f2(0x233)],_0x48a1f2(0x2c2)+normalizeIP(_0x3430bf)[_0x48a1f2(0x323)]+_0x48a1f2(0x2c6),{'parse_mode':_0x48a1f2(0x29f),'reply_markup':{'inline_keyboard':[[{'text':_0x48a1f2(0x2f6),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x48a1f2(0x276),'callback_data':'30'},{'text':_0x48a1f2(0x306),'callback_data':'reject'}]]}})[_0x48a1f2(0x294)](_0x72ec55=>{telegramError(_0x72ec55);}),tgBot['on']('callback_query',async _0x45342a=>{const _0x2a15e9=_0x48a1f2,_0xd4c9f=_0x45342a[_0x2a15e9(0x2ba)],_0x207512=_0x45342a['message'];tgBot['answerCallbackQuery'](_0x45342a['id'])[_0x2a15e9(0x299)](async()=>{const _0x153b9b=_0x2a15e9;devices[_0x206215]['telegramIpApproval']={'clientip':_0x3430bf,'timestamp':new Date()[_0x153b9b(0x1a2)](),'expiry':_0xd4c9f},_0xd4c9f!=_0x153b9b(0x306)?(await tgBot[_0x153b9b(0x239)](_0x207512[_0x153b9b(0x220)]['id'],_0x153b9b(0x255)+_0xd4c9f+'\x20minutes',{'parse_mode':_0x153b9b(0x29f)})[_0x153b9b(0x294)](_0x1de741=>{telegramError(_0x1de741);}),io['to'](_0x206215)[_0x153b9b(0x25f)](_0x153b9b(0x188),{'access':{'allow':![],'reason':_0x153b9b(0x19c),'token':null}})):(await tgBot[_0x153b9b(0x239)](_0x207512['chat']['id'],'Temporary\x20access\x20rejected')[_0x153b9b(0x294)](_0xacb83e=>{telegramError(_0xacb83e);}),io['to'](_0x206215)[_0x153b9b(0x25f)](_0x153b9b(0x188),{'access':{'allow':![],'reason':_0x153b9b(0x1e6),'token':null}}));}),tgBot[_0x2a15e9(0x1ed)]('callback_query');}));}function loginAccess2FA(_0x5ac225,_0x1ae8c5){const _0x3725e1=_0x27ee64;tgBot&&settings['telegramChatId']&&(tgBot[_0x3725e1(0x1ed)](_0x3725e1(0x224)),tgBot[_0x3725e1(0x239)](settings[_0x3725e1(0x233)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1ae8c5)[_0x3725e1(0x323)]+_0x3725e1(0x2c6),{'parse_mode':_0x3725e1(0x29f),'reply_markup':{'inline_keyboard':[[{'text':_0x3725e1(0x267),'callback_data':loginExpiry},{'text':_0x3725e1(0x306),'callback_data':_0x3725e1(0x306)}]]}})[_0x3725e1(0x294)](_0x531513=>{telegramError(_0x531513);}),tgBot['on'](_0x3725e1(0x224),async _0x36b364=>{const _0x42431d=_0x3725e1,_0x2efb6e=_0x36b364[_0x42431d(0x2ba)],_0x59db4a=_0x36b364[_0x42431d(0x271)];tgBot['answerCallbackQuery'](_0x36b364['id'])[_0x42431d(0x299)](async()=>{const _0x50eb4f=_0x42431d;devices[_0x5ac225]['telegram2FaApproval']={'clientip':_0x1ae8c5,'timestamp':new Date()[_0x50eb4f(0x1a2)](),'expiry':_0x2efb6e},_0x2efb6e!=_0x50eb4f(0x306)?(await tgBot['sendMessage'](_0x59db4a[_0x50eb4f(0x220)]['id'],_0x50eb4f(0x1e4),{'parse_mode':_0x50eb4f(0x29f)})[_0x50eb4f(0x294)](_0x2731c9=>{telegramError(_0x2731c9);}),io['to'](_0x5ac225)[_0x50eb4f(0x25f)](_0x50eb4f(0x188),{'access':{'allow':![],'reason':_0x50eb4f(0x19c),'token':null}})):(await tgBot[_0x50eb4f(0x239)](_0x59db4a[_0x50eb4f(0x220)]['id'],_0x50eb4f(0x30d))[_0x50eb4f(0x294)](_0x537054=>{telegramError(_0x537054);}),io['to'](_0x5ac225)['emit'](_0x50eb4f(0x188),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x42431d(0x224));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5e0cdc=_0x27ee64;return dbConfig['get'](_0x5e0cdc(0x30a))[_0x5e0cdc(0x248)](_0x5e0cdc(0x1ba))[_0x5e0cdc(0x1ae)]({'status':_0x5e0cdc(0x1b2)})['value']()||[];}function getDisabledBots(){const _0x2db921=_0x27ee64;return dbConfig[_0x2db921(0x262)](_0x2db921(0x30a))['sortBy']('botID')['filter']({'status':_0x2db921(0x2be)})['value']()||[];}function getBotAttributes(_0x40158f){const _0xddc237=_0x27ee64;let _0x678bd1={};const _0x23c5cd=configpath+'bot-'+_0x40158f+_0xddc237(0x260),_0x393d24=fs['existsSync'](_0x23c5cd);if(_0x393d24){const _0x168ade=fs['readFileSync'](_0x23c5cd);try{const _0xce8322=JSON['parse'](_0x168ade),_0x2ce2a0=_0xce8322?_0xce8322[_0xddc237(0x184)][0x0]['headless']:![];_0x678bd1[_0xddc237(0x283)]=_0x2ce2a0?_0xddc237(0x31b):'manual',_0x678bd1[_0xddc237(0x1c9)]=_0xce8322?_0xce8322['bot'][0x0]['botname']:_0xddc237(0x196)+_0x40158f;}catch(_0x459878){_0x678bd1[_0xddc237(0x283)]=_0xddc237(0x2fc),_0x678bd1[_0xddc237(0x1c9)]=_0xddc237(0x196)+_0x40158f;}}else _0x678bd1[_0xddc237(0x283)]='manual',_0x678bd1[_0xddc237(0x1c9)]=_0xddc237(0x196)+_0x40158f;return _0x678bd1;}function getBotsWithMode(){const _0x19552a=_0x27ee64,_0x1873f7=dbConfig[_0x19552a(0x262)](_0x19552a(0x30a))[_0x19552a(0x248)](_0x19552a(0x1ba))[_0x19552a(0x2ae)]()||[];return _0x1873f7[_0x19552a(0x207)](_0x20e0c3=>{const _0x363dc0=_0x19552a;let _0x57d520=getBotAttributes(_0x20e0c3[_0x363dc0(0x1ba)]);_0x20e0c3[_0x363dc0(0x283)]=_0x57d520[_0x363dc0(0x283)];}),_0x1873f7;}function getBotExchanges(){const _0x1744f1=_0x27ee64;let _0x32d591=[];const _0x4e76e2=dbConfig[_0x1744f1(0x262)](_0x1744f1(0x30a))[_0x1744f1(0x248)](_0x1744f1(0x1ba))['value']()||[];_0x4e76e2['forEach'](_0x3179aa=>{const _0x4bc4f2=_0x1744f1;if(_0x3179aa[_0x4bc4f2(0x188)]==_0x4bc4f2(0x1b2)){const _0x2c73aa=configpath+_0x4bc4f2(0x19f)+_0x3179aa[_0x4bc4f2(0x1ba)]+_0x4bc4f2(0x260),_0x7b60d8=fs['existsSync'](_0x2c73aa);let _0x2a1066;if(_0x7b60d8){const _0x2ded85=fs[_0x4bc4f2(0x227)](_0x2c73aa);try{const _0x46f24d=JSON[_0x4bc4f2(0x221)](_0x2ded85);_0x2a1066=_0x46f24d?_0x46f24d[_0x4bc4f2(0x184)][0x0][_0x4bc4f2(0x24c)]:null;}catch(_0x2028bf){}}if(_0x2a1066)_0x32d591[_0x4bc4f2(0x250)](_0x2a1066);}});const _0x21839a=[...new Set(_0x32d591)][_0x1744f1(0x2c3)]();return _0x21839a;}async function initUser(){const _0x3bc1ca=_0x27ee64;if(!settings[_0x3bc1ca(0x1c3)]){const _0x373ee8=uuidRandom();mixpanel['alias'](_0x373ee8),updateSetting('userid',_0x373ee8);}}async function initSecure(){const _0x809d62=_0x27ee64;let _0x4f37f6=getSecure();if(!_0x4f37f6['hasOwnProperty']('secret')){let _0x3e90f9=await generateKeys();_0x4f37f6['publicKey']=_0x3e90f9[_0x809d62(0x2c9)],_0x4f37f6[_0x809d62(0x2ca)]=_0x3e90f9[_0x809d62(0x2ca)],_0x4f37f6['secret']=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x4f37f6);}}function getSettings(){const _0x5dbb05=_0x27ee64;return dbSettings['get'](_0x5dbb05(0x20c))[_0x5dbb05(0x2ae)]()||{};}function getSecure(){const _0x1f0fa=_0x27ee64;return dbSecure[_0x1f0fa(0x262)](_0x1f0fa(0x28f))[_0x1f0fa(0x2ae)]()||{};}function getBlacklist(){const _0x2cf0a1=_0x27ee64;return dbSecure[_0x2cf0a1(0x262)](_0x2cf0a1(0x195))[_0x2cf0a1(0x2ae)]()||[];}function broadcastToBots(_0x5d337d,_0x1d95af){const _0x227ed0=_0x27ee64;config[_0x227ed0(0x207)](_0x42618f=>{const _0x5eb02c=_0x227ed0;if(_0x42618f[_0x5eb02c(0x188)]==_0x5eb02c(0x1b2)&&_0x42618f[_0x5eb02c(0x182)]==_0x5eb02c(0x215)){if(pid[_0x42618f[_0x5eb02c(0x1ba)]])pid[_0x42618f[_0x5eb02c(0x1ba)]]['send']({[_0x5d337d]:_0x1d95af});}});}function storeSettings(_0x692bdf,_0x17e28c=![]){const _0x234fd2=_0x27ee64;_0x692bdf={...settings,..._0x692bdf};if(_0x17e28c&&_0x692bdf[_0x234fd2(0x2ee)]!=_0x234fd2(0x21e)&&_0x692bdf[_0x234fd2(0x2ee)]!=_0x234fd2(0x1b9)&&_0x692bdf[_0x234fd2(0x2ee)]!=''){const _0x445954=crypt[_0x234fd2(0x1b7)](secure[_0x234fd2(0x2ca)],_0x692bdf[_0x234fd2(0x2ee)])[_0x234fd2(0x271)][_0x234fd2(0x2f4)]('@')[0x0],_0x4293e3=bcrypt[_0x234fd2(0x2b4)](_0x445954,saltRounds);_0x692bdf={..._0x692bdf,'bbPassword':_0x4293e3};}if(_0x17e28c&&_0x692bdf[_0x234fd2(0x2f0)]!=_0x234fd2(0x21e)&&_0x692bdf['telegramToken']!=_0x234fd2(0x1b9)&&_0x692bdf['telegramToken']!=''){const _0xbe04bb=crypt[_0x234fd2(0x1b7)](secure[_0x234fd2(0x2ca)],_0x692bdf[_0x234fd2(0x2f0)])[_0x234fd2(0x271)][_0x234fd2(0x2f4)]('@')[0x0];_0x692bdf={..._0x692bdf,'telegramToken':_0xbe04bb};}const _0x2a9253=_0x692bdf[_0x234fd2(0x2f0)]!=_0x234fd2(0x21e)&&_0x692bdf[_0x234fd2(0x2f0)]!=settings['telegramToken']||_0x692bdf[_0x234fd2(0x325)]!=settings[_0x234fd2(0x325)],_0x249c37=_0x692bdf[_0x234fd2(0x2f0)]==''||_0x692bdf[_0x234fd2(0x325)]=='';if(_0x2a9253)_0x692bdf[_0x234fd2(0x190)]='all';for(const [_0x388037,_0x3cb848]of Object[_0x234fd2(0x266)](_0x692bdf)){if(_0x388037==_0x234fd2(0x2f0)&&_0x3cb848==_0x234fd2(0x21e)){_0x692bdf['telegramToken']=settings[_0x234fd2(0x2f0)];continue;};if(_0x388037=='bbPassword'&&_0x3cb848==_0x234fd2(0x21e)){_0x692bdf['bbPassword']=settings[_0x234fd2(0x2ee)];continue;};dbSettings['set'](_0x234fd2(0x229)+_0x388037,_0x3cb848)[_0x234fd2(0x235)]();}settings=_0x692bdf,io['to'](_0x234fd2(0x22e))[_0x234fd2(0x25f)]('settings',cleanSettings()),broadcastToBots(_0x234fd2(0x2ce),settings[_0x234fd2(0x2ce)]);if(_0x2a9253&&!_0x249c37)initTelegram();if(_0x2a9253&&_0x249c37)disableTelegram();getAllClients()[_0x234fd2(0x207)](_0x269b45=>{const _0x249117=_0x234fd2;getSocket(_0x269b45['id'])[_0x249117(0x25f)](_0x249117(0x188),{'access':{'allow':![],'reason':_0x249117(0x19c),'token':null}});});}function updateSetting(_0x48f5ef,_0x45a3d3){const _0x14dec4=_0x27ee64;dbSettings[_0x14dec4(0x2a0)](_0x14dec4(0x229)+_0x48f5ef,_0x45a3d3)['write'](),settings=getSettings(),io['to'](_0x14dec4(0x22e))[_0x14dec4(0x25f)]('settings',cleanSettings());}function storeSecure(_0x3fcdd9){const _0x26e841=_0x27ee64;dbSecure['get'](_0x26e841(0x28f))[_0x26e841(0x250)](_0x3fcdd9)[_0x26e841(0x235)](),secure=_0x3fcdd9;}function addBlacklist(_0x1a78e3){const _0x3448aa=_0x27ee64;cleanBlacklist();let _0x5402c1;devices[_0x1a78e3][_0x3448aa(0x226)]?_0x5402c1=Math[_0x3448aa(0x2dd)](devices[_0x1a78e3][_0x3448aa(0x226)][_0x3448aa(0x1f1)],loginExpiry):_0x5402c1=loginExpiry,dbSecure[_0x3448aa(0x262)](_0x3448aa(0x195))[_0x3448aa(0x250)]({'expiry':new Date()['getTime']()+_0x5402c1*0x3c*0x3e8,'token':devices[_0x1a78e3]['access'][_0x3448aa(0x2e8)]})[_0x3448aa(0x235)](),blacklist=dbSecure['get'](_0x3448aa(0x195))['value']();}function cleanBlacklist(){const _0x2be9aa=_0x27ee64;let _0x322a37=dbSecure[_0x2be9aa(0x262)]('blacklist')[_0x2be9aa(0x318)]()[_0x2be9aa(0x2ae)](),_0x358889=new Date()[_0x2be9aa(0x1a2)]();_0x322a37[_0x2be9aa(0x207)](_0x15ee21=>{const _0x9007d6=_0x2be9aa;_0x15ee21[_0x9007d6(0x1f1)]<_0x358889&&dbSecure['get'](_0x9007d6(0x195))['remove']({'expiry':_0x15ee21['expiry']})[_0x9007d6(0x235)]();});}function initStates(){let _0x4d0c1c=getConfiguration();_0x4d0c1c['forEach'](_0x54fac0=>{const _0x30f020=_0x2df2;_0x54fac0[_0x30f020(0x182)]=_0x30f020(0x2b0);}),storeConfiguration(_0x4d0c1c);}function onKeys(){const _0x7bb6b8=new RSA();return new Promise(_0x4dbbbd=>{const _0x119d8d=_0x2df2;_0x7bb6b8[_0x119d8d(0x208)]()['then'](_0x1aa466=>{_0x4dbbbd(_0x1aa466);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1786e5=_0x27ee64;let _0x575861=getSettings(),_0x5d2376=![];!_0x575861[_0x1786e5(0x2a5)](_0x1786e5(0x1ef))&&(_0x575861[_0x1786e5(0x1ef)]=0x0,_0x5d2376=!![]);!_0x575861[_0x1786e5(0x2a5)](_0x1786e5(0x313))&&(_0x575861[_0x1786e5(0x313)]=0x0,_0x5d2376=!![]);!_0x575861['hasOwnProperty'](_0x1786e5(0x1b3))&&(_0x575861[_0x1786e5(0x1b3)]=_0x1786e5(0x2d5),_0x5d2376=!![]);if(_0x5d2376)storeSettings(_0x575861);}function storeConfiguration(_0x5ad2ed){const _0x1f8c9f=_0x27ee64;dbConfig[_0x1f8c9f(0x262)]('bots')[_0x1f8c9f(0x21c)]()['write'](),_0x5ad2ed[_0x1f8c9f(0x207)](_0x8cb476=>{const _0x389caa=_0x1f8c9f;delete _0x8cb476[_0x389caa(0x283)];}),dbConfig[_0x1f8c9f(0x262)](_0x1f8c9f(0x30a))[_0x1f8c9f(0x250)](..._0x5ad2ed)['write'](),config=_0x5ad2ed;}function resetPassword(){const _0x40ad0d=_0x27ee64;tgBot&&settings[_0x40ad0d(0x233)]&&(tgBot['removeListener'](_0x40ad0d(0x224)),tgBot[_0x40ad0d(0x239)](settings[_0x40ad0d(0x233)],_0x40ad0d(0x2ea),{'parse_mode':_0x40ad0d(0x29f),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x40ad0d(0x26d)},{'text':'no','callback_data':'no'}]]}})[_0x40ad0d(0x294)](_0x30c6b8=>{telegramError(_0x30c6b8);}),tgBot['on'](_0x40ad0d(0x224),async _0x51379d=>{const _0x199f73=_0x40ad0d,_0x5c256a=_0x51379d['data'],_0x136b83=_0x51379d['message'];tgBot[_0x199f73(0x241)](_0x51379d['id'])['then'](async()=>{const _0xd022e5=_0x199f73;if(_0x5c256a!='no'){const _0x187c2a=0xf,_0x286dae=_0xd022e5(0x2ac),_0x535bb8=Array[_0xd022e5(0x1c1)](crypto[_0xd022e5(0x2bd)](new Uint32Array(_0x187c2a)))[_0xd022e5(0x1b6)](_0x108a8a=>_0x286dae[_0x108a8a%_0x286dae['length']])['join'](''),_0x326d37=bcrypt[_0xd022e5(0x2b4)](_0x535bb8,saltRounds);storeSettings({'bbPassword':_0x326d37}),await tgBot[_0xd022e5(0x239)](_0x136b83['chat']['id'],_0xd022e5(0x31f)+_0x535bb8,{'parse_mode':_0xd022e5(0x29f)})['catch'](_0x5ee7e6=>{telegramError(_0x5ee7e6);});}else await tgBot['sendMessage'](_0x136b83[_0xd022e5(0x220)]['id'],_0xd022e5(0x2dc))[_0xd022e5(0x294)](_0x3289f5=>{telegramError(_0x3289f5);});}),tgBot[_0x199f73(0x1ed)](_0x199f73(0x224));}));}async function confirmRestore(_0x2a58c2,_0x1f3f9f){const _0x4998e2=_0x27ee64;tgBot&&settings[_0x4998e2(0x233)]&&(tgBot[_0x4998e2(0x1ed)](_0x4998e2(0x224)),await tgBot[_0x4998e2(0x239)](settings[_0x4998e2(0x233)],_0x4998e2(0x1e5),{'parse_mode':_0x4998e2(0x29f),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4998e2(0x294)](_0x56bcc1=>{telegramError(_0x56bcc1);}),tgBot['on'](_0x4998e2(0x224),async _0x40c226=>{const _0x4cf15f=_0x4998e2,_0x5a1437=_0x40c226[_0x4cf15f(0x2ba)],_0x3393be=_0x40c226['message'];tgBot[_0x4cf15f(0x241)](_0x40c226['id'])[_0x4cf15f(0x299)](async()=>{const _0xee7560=_0x4cf15f;_0x5a1437==_0xee7560(0x26d)?(await tgBot['sendMessage'](_0x3393be[_0xee7560(0x220)]['id'],_0xee7560(0x232),{'parse_mode':_0xee7560(0x29f)})[_0xee7560(0x294)](_0x1ab284=>{telegramError(_0x1ab284);}),unzipFile(_0x2a58c2,_0x1f3f9f)):await tgBot[_0xee7560(0x239)](_0x3393be[_0xee7560(0x220)]['id'],'Restore\x20process\x20aborted')['catch'](_0x102c2e=>{telegramError(_0x102c2e);});}),tgBot[_0x4cf15f(0x1ed)](_0x4cf15f(0x224));}));}function getServerTime(){const _0x2a52de=_0x27ee64,_0x285cfa=new Date();return _0x285cfa[_0x2a52de(0x217)]()+'/'+(_0x285cfa[_0x2a52de(0x303)]()+0x1)[_0x2a52de(0x2d0)]()[_0x2a52de(0x1de)](0x2,'0')+'/'+_0x285cfa['getDate']()[_0x2a52de(0x2d0)]()['padStart'](0x2,'0')+'\x20'+_0x285cfa[_0x2a52de(0x1ce)]()[_0x2a52de(0x2d0)]()[_0x2a52de(0x1de)](0x2,'0')+':'+_0x285cfa[_0x2a52de(0x1aa)]()[_0x2a52de(0x2d0)]()[_0x2a52de(0x1de)](0x2,'0')+':'+_0x285cfa[_0x2a52de(0x2ef)]()[_0x2a52de(0x2d0)]()[_0x2a52de(0x1de)](0x2,'0');}function getTimeStamp(){const _0x3cd1bd=_0x27ee64,_0x486b7a=shiftedTime();return _0x486b7a['getFullYear']()+'/'+(_0x486b7a[_0x3cd1bd(0x303)]()+0x1)[_0x3cd1bd(0x2d0)]()[_0x3cd1bd(0x1de)](0x2,'0')+'/'+_0x486b7a[_0x3cd1bd(0x223)]()[_0x3cd1bd(0x2d0)]()['padStart'](0x2,'0')+'\x20'+_0x486b7a[_0x3cd1bd(0x1ce)]()['toString']()[_0x3cd1bd(0x1de)](0x2,'0')+':'+_0x486b7a['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x486b7a[_0x3cd1bd(0x2ef)]()[_0x3cd1bd(0x2d0)]()[_0x3cd1bd(0x1de)](0x2,'0');}function shiftedTime(){const _0x2559c5=_0x27ee64,_0x506993=new Date();let _0x401f51=_0x506993;if(settings[_0x2559c5(0x2ce)]&&settings[_0x2559c5(0x2ce)]!==0x0)_0x401f51=fns['add'](_0x506993,{'hours':settings['timeshift']});return _0x401f51;}function startScheduler(){const _0x16627d=_0x27ee64,_0x102fba=new Date()['getUTCHours'](),_0x4d86ab=shiftedTime()[_0x16627d(0x1ce)]();_0x4d86ab==0x4&&backupConfigFiles();_0x4d86ab==0x0&&rotateLogFiles();_0x102fba%0x6==0x0&&triggerAnalytics();_0x102fba%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x2f1dc5=_0x27ee64;fs[_0x2f1dc5(0x2a7)](configpath,{'withFileTypes':!![]})['forEach'](_0x4b9fca=>{const _0x5c4e1f=_0x2f1dc5;if(!_0x4b9fca[_0x5c4e1f(0x2da)]())fs[_0x5c4e1f(0x1e2)](configpath+_0x4b9fca[_0x5c4e1f(0x1cf)],configbackuppath+_0x4b9fca['name']);});}function rotateLogFiles(){const _0x2c6997=_0x27ee64,_0x52cf21=fs[_0x2c6997(0x2fb)](logspath+'output-000.log'),_0x51917f=_0x52cf21[_0x2c6997(0x270)]/0x400;if(_0x51917f>0x32){let _0x68b286=fs[_0x2c6997(0x2a7)](logspath,{'withFileTypes':!![]});_0x68b286[_0x2c6997(0x2c3)]((_0x2f357a,_0x49a134)=>_0x2f357a[_0x2c6997(0x1cf)]<_0x49a134['name']?0x1:_0x49a134['name']<_0x2f357a[_0x2c6997(0x1cf)]?-0x1:0x0),_0x68b286[_0x2c6997(0x207)](_0x556b71=>{const _0x1d78bb=_0x2c6997;if(_0x556b71[_0x1d78bb(0x1cf)]==_0x1d78bb(0x258))fs['copyFileSync'](logspath+_0x556b71[_0x1d78bb(0x1cf)],logspath+_0x1d78bb(0x329));if(_0x556b71[_0x1d78bb(0x1cf)]==_0x1d78bb(0x214))fs[_0x1d78bb(0x1e2)](logspath+_0x556b71[_0x1d78bb(0x1cf)],logspath+_0x1d78bb(0x258));_0x556b71[_0x1d78bb(0x1cf)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x556b71[_0x1d78bb(0x1cf)],logspath+'output-001.log'),fs[_0x1d78bb(0x23a)](logspath+_0x556b71['name'],''));});}}async function zipFiles(_0xb4d8af){const _0x2bbd11=_0x27ee64;let _0x24ee50;if(_0xb4d8af==_0x2bbd11(0x193))_0x24ee50=logspath;if(_0xb4d8af=='backup')_0x24ee50=configpath;let _0x51c0f0=fs['readdirSync'](_0x24ee50,{'withFileTypes':!![]});const _0x457c52=new require(_0x2bbd11(0x2eb))();_0x51c0f0[_0x2bbd11(0x207)](_0xf9d758=>{const _0x3f752a=_0x2bbd11;if(!_0xf9d758[_0x3f752a(0x2da)]()){let _0x20ee45=fs[_0x3f752a(0x227)](_0x24ee50+_0xf9d758[_0x3f752a(0x1cf)]);const _0x516832=/^bot-[0-9]{3}-config.json$/,_0x213913=_0x516832[_0x3f752a(0x28b)](_0xf9d758[_0x3f752a(0x1cf)]);if(_0x213913){const _0x21233b=JSON[_0x3f752a(0x221)](_0x20ee45);_0x21233b[_0x3f752a(0x184)][0x0][_0x3f752a(0x27b)]='***',_0x21233b[_0x3f752a(0x184)][0x0][_0x3f752a(0x1be)]=_0x3f752a(0x1b9),_0x20ee45=JSON['stringify'](_0x21233b,null,0x2);}if(_0xf9d758[_0x3f752a(0x1cf)]==_0x3f752a(0x259)){const _0x373382=JSON[_0x3f752a(0x221)](_0x20ee45);if(_0x373382[_0x3f752a(0x20c)][_0x3f752a(0x2f2)])_0x373382['settings']['loginRequired']=![];if(_0x373382[_0x3f752a(0x20c)][_0x3f752a(0x2ee)])_0x373382[_0x3f752a(0x20c)][_0x3f752a(0x2ee)]='***';if(_0x373382['settings'][_0x3f752a(0x2f0)])_0x373382['settings'][_0x3f752a(0x2f0)]=_0x3f752a(0x1b9);if(_0x373382['settings'][_0x3f752a(0x233)])_0x373382['settings'][_0x3f752a(0x233)]=null;_0x20ee45=JSON[_0x3f752a(0x1d4)](_0x373382,null,0x2);}if(_0xf9d758[_0x3f752a(0x1cf)]!='bb-secure.json')_0x457c52[_0x3f752a(0x189)](_0xf9d758['name'],_0x20ee45);}});const _0x2ffc4e=_0x457c52['generate']({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0xb4d8af+_0x2bbd11(0x1f6)),_0x2ffc4e,_0x2bbd11(0x277));}async function unzipFile(_0x324a88,_0x5b379b){const _0x341b83=_0x27ee64;await backupConfigFiles(),fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x341b83(0x207)](_0x2e2a67=>{const _0x464cdd=_0x341b83;if(!_0x2e2a67[_0x464cdd(0x2da)]())fs[_0x464cdd(0x27d)](configpath+_0x2e2a67['name']);});const _0x3d267d=fs[_0x341b83(0x227)](_0x324a88+_0x5b379b,_0x341b83(0x277)),_0x376b39=new require(_0x341b83(0x2eb))(_0x3d267d,{'base64':![],'checkCRC32':!![]});Object[_0x341b83(0x2cb)](_0x376b39[_0x341b83(0x26e)])[_0x341b83(0x207)](_0x3be689=>{const _0x381a51=_0x341b83,_0xf8bc75=_0x376b39[_0x381a51(0x26e)][_0x3be689];fs['writeFileSync'](configpath+_0xf8bc75[_0x381a51(0x1cf)],_0xf8bc75[_0x381a51(0x20d)]);}),fs[_0x341b83(0x2a7)](temppath,{'withFileTypes':!![]})['forEach'](_0x2cb92f=>{const _0x1b53e6=_0x341b83;if(!_0x2cb92f[_0x1b53e6(0x2da)]())fs[_0x1b53e6(0x27d)](temppath+_0x2cb92f[_0x1b53e6(0x1cf)]);}),process['send']({'restore':!![]},_0x554e09=>{});}async function getPublicIp(){const _0x11af2f=_0x27ee64;try{const _0x3b20eb=await axios['get'](_0x11af2f(0x2ab));publicip=_0x3b20eb[_0x11af2f(0x2ba)]['ip'];}catch(_0x41086e){}}async function triggerAnalytics(){const _0x4bf342=_0x27ee64;if(!publicip)await getPublicIp();const _0x24f148=getBotsWithMode();let _0x1886cc=0x0;_0x24f148[_0x4bf342(0x207)](_0x53c76d=>{const _0x499e51=_0x4bf342;if(_0x53c76d['status']===_0x499e51(0x1b2))_0x1886cc++;});const _0x466354=getBotExchanges();mixpanel[_0x4bf342(0x2ec)](_0x4bf342(0x254),{'distinct_id':settings[_0x4bf342(0x1c3)],'ip':publicip,'version':serverversion,'numbots':_0x24f148['length'],'numbotsenabled':_0x1886cc,'exchanges':_0x466354});}async function getMessages(){const _0x5d5239=_0x27ee64,_0x122701=_0x5d5239(0x1a3),_0xea5665=new GraphQLClient(_0x122701),_0x13992e={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x181d30=serverversion[_0x5d5239(0x2f4)]('.'),_0x523485=_0x181d30[0x0]+'.'+_0x181d30[0x1],_0x1ea96e=Math['min'](settings[_0x5d5239(0x1ef)],settings[_0x5d5239(0x313)]),_0x2538de={'last':parseInt(_0x1ea96e),'bbm':_0x523485},_0x4ac864=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3bcc25;try{_0x3bcc25=await _0xea5665[_0x5d5239(0x317)](_0x4ac864,_0x2538de,_0x13992e);}catch(_0x46cf83){}if(_0x3bcc25&&_0x3bcc25[_0x5d5239(0x25b)]){let _0x4fe092=settings[_0x5d5239(0x1ef)];newMessages=[];for(const _0x42df0e of _0x3bcc25[_0x5d5239(0x25b)]){newMessages[_0x5d5239(0x250)](_0x42df0e);if(_0x42df0e[_0x5d5239(0x261)])updateSetting(_0x5d5239(0x1b3),_0x42df0e['bbvNew']);let _0x31faa8=_0x42df0e['bbvNew']?serverversion>=_0x42df0e[_0x5d5239(0x261)]:![];if(!_0x31faa8&&_0x42df0e[_0x5d5239(0x2d2)]>_0x4fe092){if(_0x42df0e[_0x5d5239(0x21b)]===_0x5d5239(0x320)||serverversion[_0x5d5239(0x2b1)](_0x42df0e[_0x5d5239(0x21b)])){let _0x4642aa=''+_0x42df0e[_0x5d5239(0x2d9)]+'\x0a\x0a'+_0x42df0e[_0x5d5239(0x271)];const _0x37f6c8=await sendTelegramMsg(toTelegramMarkdown(_0x4642aa),'Markdown');if(_0x37f6c8)_0x4fe092=_0x42df0e[_0x5d5239(0x2d2)];}}}updateAvailable=isNewerVersion(settings[_0x5d5239(0x1b3)],serverversion),updateSetting(_0x5d5239(0x1ef),_0x4fe092),emitMessages();}}function emitMessages(){const _0x5221e8=_0x27ee64,_0x4ca583=settings['lastmsgemitted'];let _0x103ad3=[];newMessages[_0x5221e8(0x207)](_0x52c974=>{const _0x45d750=_0x5221e8;_0x52c974[_0x45d750(0x2d2)]>_0x4ca583&&_0x103ad3['push'](_0x52c974);}),_0x103ad3[_0x5221e8(0x2d3)]>0x0&&getAllClients()[_0x5221e8(0x207)](_0x10d0eb=>{const _0x245626=_0x5221e8;getSocket(_0x10d0eb['id'])[_0x245626(0x25f)]('message',_0x103ad3);});}function confirmMessage(_0x3ad7df){updateSetting('lastmsgemitted',Number(_0x3ad7df));}function isNewerVersion(_0x3f30fe,_0x147498){const _0xfd6bea=_0x27ee64,_0x11ad69=_0x147498[_0xfd6bea(0x2f4)]('.'),_0x3e18e0=_0x3f30fe['split']('.');for(var _0x2656db=0x0;_0x2656db<_0x3e18e0[_0xfd6bea(0x2d3)];_0x2656db++){const _0x2b54b2=~~_0x3e18e0[_0x2656db],_0x507d34=~~_0x11ad69[_0x2656db];if(_0x2b54b2>_0x507d34)return!![];if(_0x2b54b2<_0x507d34)return![];}return![];}function toTelegramMarkdown(_0x316875){const _0x359639=_0x27ee64,_0x41be0b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x58e309=/\*{2}(.+?)\*{2}/gim;return _0x316875=_0x316875[_0x359639(0x18d)](_0x41be0b,_0x359639(0x1b1))[_0x359639(0x18d)](_0x58e309,_0x359639(0x1ec)),_0x316875;}async function validateConfigFile(){const _0x17d4eb=_0x27ee64,_0x178810=dbConfig[_0x17d4eb(0x262)](_0x17d4eb(0x30a))['sortBy']('botID')[_0x17d4eb(0x2ae)]()||[];if(_0x178810[_0x17d4eb(0x2d3)]==0x0){let _0x4c91b8=0x0,_0x51ab19=[];const _0x761cb2=/^bot-([0-9]{3})-config.json$/,_0x3bc4aa=fs[_0x17d4eb(0x2a7)](configpath);_0x3bc4aa[_0x17d4eb(0x207)](_0x15a4a1=>{const _0x5804c0=_0x17d4eb,_0x398457=_0x761cb2[_0x5804c0(0x18a)](_0x15a4a1);if(_0x398457){const _0x2417ff=_0x398457[0x1];let _0x2d5001=getBotAttributes(_0x2417ff);_0x51ab19[_0x5804c0(0x250)]({'botID':_0x2417ff,'botname':_0x2d5001[_0x5804c0(0x1c9)],'status':'disabled','live':'stopped'}),_0x4c91b8++;}}),_0x4c91b8!=0x0&&(dbConfig['get']('bots')[_0x17d4eb(0x25d)](_0x51ab19)['write'](),config=_0x51ab19,restoredConfigFile=_0x4c91b8);}}async function restoreConfigNotify(_0x33408b){const _0x45f42a=_0x27ee64;let _0x15189c;if(restoredConfigFile==0x1)_0x15189c='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x15189c=_0x45f42a(0x222);if(_0x33408b)io['to'](_0x45f42a(0x22e))['emit'](_0x45f42a(0x1ea),_0x15189c);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x45f42a(0x2e5)](_0x15189c),logger[_0x45f42a(0x2e5)]('-----------------------------------------------------------------------------------'),logger[_0x45f42a(0x2e5)]('');if(tgBot&&settings[_0x45f42a(0x233)]&&settings['telegramEvents']!='orders')tgBot['sendMessage'](settings[_0x45f42a(0x233)],_0x45f42a(0x211)+_0x15189c)[_0x45f42a(0x294)](_0x1cae3c=>{telegramError(_0x1cae3c);});}}function validateCredentials(_0x3aa6ee,_0x415c2d){const _0x475ee3=_0x27ee64;if(_0x3aa6ee[_0x475ee3(0x1d5)]==settings['bbUsername']&&bcrypt[_0x475ee3(0x242)](_0x3aa6ee[_0x475ee3(0x2e2)],settings['bbPassword'])){if(settings[_0x475ee3(0x231)])return{'allow':![],'reason':_0x475ee3(0x1b5),'token':null};else{const _0x3808cd=generateLoginToken(_0x415c2d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3808cd};}}else return{'allow':![],'reason':_0x475ee3(0x198),'token':null};}function refreshToken(_0x53deed){const _0x2c2729=_0x27ee64,_0x2367cd=generateLoginToken(_0x53deed);return{'allow':!![],'reason':_0x2c2729(0x2db),'token':_0x2367cd};}function validateAccess(_0x287227,_0x37e5ee,_0x2a78ed){const _0x50614d=_0x27ee64,_0x3c7edd=_0x2a78ed?_0x2a78ed:devices[_0x37e5ee]['ip'];let _0x5e5bce;const _0x2dc2cf=_0x1ff6b7=>{const _0x386298=_0x2df2;if(settings[_0x386298(0x2f2)]){if(settings[_0x386298(0x231)]){if(telegram2FaApproved(_0x37e5ee)){const _0x3457b0=generateLoginToken(_0x37e5ee);return{'allow':!![],'reason':_0x386298(0x1fc),'token':_0x3457b0};}else return{'allow':![],'reason':_0x386298(0x218),'token':null};}else return _0x5e5bce=validToken(_0x1ff6b7,_0x37e5ee),_0x5e5bce[_0x386298(0x2a5)](_0x386298(0x2d8))?{'allow':!![],'reason':_0x386298(0x326),'token':_0x1ff6b7}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x386298(0x1fb),'token':null};};if(settings[_0x50614d(0x26a)]){let _0x13b62f=[...settings[_0x50614d(0x210)],_0x50614d(0x1e8),_0x50614d(0x268),'127.0.0.1'];if(_0x13b62f[_0x50614d(0x29b)](_0x3c7edd))return _0x2dc2cf(_0x287227);else{_0x5e5bce=validToken(_0x287227,_0x37e5ee);if(_0x5e5bce[_0x50614d(0x2a5)](_0x50614d(0x2d8)))return _0x2dc2cf(_0x287227);else{if(telegramIpApproved(_0x37e5ee)){const _0x463e1b=generateToken(_0x37e5ee);return _0x5e5bce=_0x2dc2cf(_0x287227),_0x5e5bce[_0x50614d(0x219)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x463e1b}:_0x5e5bce;}else return settings[_0x50614d(0x243)]?{'allow':![],'reason':_0x50614d(0x295),'token':null}:{'allow':![],'reason':_0x50614d(0x1cc),'token':null};}}}else return _0x2dc2cf(_0x287227);}function timelyDecrypt(_0x535c0e,_0x25554f=!![]){const _0x2270b1=_0x27ee64;if(_0x535c0e)try{const _0x3ca7c0=crypt[_0x2270b1(0x1b7)](secure[_0x2270b1(0x2ca)],_0x535c0e)[_0x2270b1(0x271)],_0x452319=_0x3ca7c0[_0x2270b1(0x2f4)]('@')[0x0],_0x145ddf=_0x3ca7c0[_0x2270b1(0x2f4)]('@')[0x1],_0x2c98e3=new Date()[_0x2270b1(0x1a2)]();if(_0x25554f){if(_0x2c98e3-_0x145ddf<maxSecretAge*0x3e8)return _0x452319;else return![];}else return _0x452319;}catch(_0x45c00b){return![];}else return![];}const validToken=(_0x9d0b45,_0xd075e4)=>{const _0x2ca5ab=_0x27ee64,_0x244e98=devices[_0xd075e4]['ip'];if(!_0x9d0b45)return{'error':_0x2ca5ab(0x1c8)};for(let _0x2caf3a of blacklist){if(_0x2caf3a[_0x2ca5ab(0x2e8)]==_0x9d0b45)return{'error':_0x2ca5ab(0x2b7)};}let _0x5a2505;try{_0x5a2505=jwt[_0x2ca5ab(0x205)](_0x9d0b45,secure[_0x2ca5ab(0x2e1)]+_0xd075e4);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5a2505[_0x2ca5ab(0x2a5)](_0x2ca5ab(0x300))&&!_0x5a2505[_0x2ca5ab(0x2a5)]('username')||!_0x5a2505[_0x2ca5ab(0x2a5)](_0x2ca5ab(0x1ca)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x5a2505['hasOwnProperty']('username')&&_0x5a2505[_0x2ca5ab(0x2a5)](_0x2ca5ab(0x300))){const {clientip:_0x4bdca0}=_0x5a2505;return _0x244e98==_0x4bdca0?{'success':_0x2ca5ab(0x1ac)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5a2505[_0x2ca5ab(0x2a5)](_0x2ca5ab(0x1d5))&&_0x5a2505['hasOwnProperty']('clientip')){const {username:_0x4a491c,clientip:_0x51f00c}=_0x5a2505;return settings['bbUsername']==_0x4a491c&&_0x244e98==_0x51f00c?{'success':_0x2ca5ab(0x1ac)}:{'error':_0x2ca5ab(0x32a)};}}},generateLoginToken=_0x35a3d3=>{const _0xbc7164=_0x27ee64;if(_0x35a3d3){const _0x1516d1=devices[_0x35a3d3]['ip'];return jwt[_0xbc7164(0x21a)]({'username':settings[_0xbc7164(0x1d3)],'clientip':_0x1516d1},secure['secret']+_0x35a3d3,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x215b5a=>{const _0x548dcb=_0x27ee64;if(_0x215b5a){const _0x561f6b=devices[_0x215b5a]['ip'];return jwt[_0x548dcb(0x21a)]({'clientip':_0x561f6b},secure[_0x548dcb(0x2e1)]+_0x215b5a,{'expiresIn':devices[_0x215b5a][_0x548dcb(0x226)][_0x548dcb(0x1f1)]*0x3c});}else return![];},telegramIpApproved=_0xae6d59=>{const _0x443601=_0x27ee64;let _0x5557e7=![];return devices[_0xae6d59]['telegramIpApproval']&&devices[_0xae6d59][_0x443601(0x226)][_0x443601(0x1f1)]!='reject'&&(_0x5557e7=devices[_0xae6d59][_0x443601(0x226)][_0x443601(0x300)]==devices[_0xae6d59]['ip']&&new Date()[_0x443601(0x1a2)]()-devices[_0xae6d59][_0x443601(0x226)][_0x443601(0x324)]<devices[_0xae6d59]['telegramIpApproval'][_0x443601(0x1f1)]*0x3c*0x3e8),_0x5557e7;},telegram2FaApproved=_0x4f5328=>{const _0x5b1ec2=_0x27ee64;let _0x5303e2=![];return devices[_0x4f5328][_0x5b1ec2(0x25a)]&&devices[_0x4f5328]['telegram2FaApproval'][_0x5b1ec2(0x1f1)]!=_0x5b1ec2(0x306)&&(_0x5303e2=devices[_0x4f5328][_0x5b1ec2(0x25a)][_0x5b1ec2(0x300)]==devices[_0x4f5328]['ip']&&new Date()[_0x5b1ec2(0x1a2)]()-devices[_0x4f5328]['telegram2FaApproval'][_0x5b1ec2(0x324)]<devices[_0x4f5328]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x5303e2;},normalizeIP=_0x145c2d=>{const _0x2ad7e0=_0x27ee64;let _0x125247=null,_0x452a1c=null;if(ipaddr[_0x2ad7e0(0x246)](_0x145c2d)){const _0x4bcc33=ipaddr['parse'](_0x145c2d);_0x4bcc33[_0x2ad7e0(0x1d2)]()===_0x2ad7e0(0x29e)?(_0x4bcc33['isIPv4MappedAddress']()&&(_0x125247=_0x4bcc33['toIPv4Address']()['toString']()),_0x452a1c=_0x4bcc33[_0x2ad7e0(0x2d0)]()):(_0x125247=_0x4bcc33[_0x2ad7e0(0x2d0)](),_0x452a1c=_0x4bcc33[_0x2ad7e0(0x2ed)]()['toString']());}return{'show':_0x125247?_0x125247:_0x452a1c,'store':_0x452a1c};};function sleep(_0x49f291){return new Promise(_0x48e29b=>setTimeout(_0x48e29b,_0x49f291));}