const _0x2eaeb4=_0x5a9e;(function(_0x54f5dc,_0x513076){const _0x48a5f1=_0x5a9e,_0x1ebff7=_0x54f5dc();while(!![]){try{const _0x53d184=-parseInt(_0x48a5f1(0x257))/0x1*(-parseInt(_0x48a5f1(0x279))/0x2)+-parseInt(_0x48a5f1(0x308))/0x3*(parseInt(_0x48a5f1(0x2e5))/0x4)+-parseInt(_0x48a5f1(0x203))/0x5*(-parseInt(_0x48a5f1(0x2d0))/0x6)+-parseInt(_0x48a5f1(0x296))/0x7*(parseInt(_0x48a5f1(0x1f0))/0x8)+-parseInt(_0x48a5f1(0x253))/0x9+-parseInt(_0x48a5f1(0x2bb))/0xa*(-parseInt(_0x48a5f1(0x2bf))/0xb)+-parseInt(_0x48a5f1(0x2ba))/0xc*(parseInt(_0x48a5f1(0x29b))/0xd);if(_0x53d184===_0x513076)break;else _0x1ebff7['push'](_0x1ebff7['shift']());}catch(_0x46e556){_0x1ebff7['push'](_0x1ebff7['shift']());}}}(_0x50c9,0x8f6e7));const _0x2c556c=function(){let _0x5ec3f9=!![];return function(_0x39f43d,_0x328636){const _0x751cef=_0x5ec3f9?function(){const _0x238711=_0x5a9e;if(_0x328636){const _0x470352=_0x328636[_0x238711(0x247)](_0x39f43d,arguments);return _0x328636=null,_0x470352;}}:function(){};return _0x5ec3f9=![],_0x751cef;};}(),_0x1eba56=_0x2c556c(this,function(){const _0x476f6a=_0x5a9e;return _0x1eba56[_0x476f6a(0x25c)]()[_0x476f6a(0x2aa)]('(((.+)+)+)+$')['toString']()[_0x476f6a(0x30a)](_0x1eba56)[_0x476f6a(0x2aa)](_0x476f6a(0x242));});_0x1eba56();'use strict';process[_0x2eaeb4(0x1d6)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x2eaeb4(0x2f2)),low=require(_0x2eaeb4(0x286)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x2eaeb4(0x228)),crypto=require(_0x2eaeb4(0x200)),Crypt=require('hybrid-crypto-js')[_0x2eaeb4(0x194)],RSA=require(_0x2eaeb4(0x339))[_0x2eaeb4(0x1f5)],bcrypt=require(_0x2eaeb4(0x201)),jwt=require(_0x2eaeb4(0x1e6)),ipaddr=require('ipaddr.js'),argv=require(_0x2eaeb4(0x26b))(process[_0x2eaeb4(0x34b)][_0x2eaeb4(0x1b5)](0x2))[_0x2eaeb4(0x34b)],uuidRandom=require(_0x2eaeb4(0x183)),TelegramBot=require(_0x2eaeb4(0x269)),Mixpanel=require('mixpanel'),axios=require(_0x2eaeb4(0x27f)),{GraphQLClient,gql}=require(_0x2eaeb4(0x2e4)),util=require('util'),fileUpload=require(_0x2eaeb4(0x2de)),{networkInterfaces}=require('os'),PORT=argv[_0x2eaeb4(0x33f)]||_0x2eaeb4(0x191),pattern=/^[0-9]{2,4}$/;!pattern[_0x2eaeb4(0x1cc)](PORT)&&(console[_0x2eaeb4(0x1e9)](_0x2eaeb4(0x1ac)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x2eaeb4(0x1c8)](0x1));const HOST=argv[_0x2eaeb4(0x297)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x2eaeb4(0x17c)][_0x2eaeb4(0x1ff)];let bbpath=_0x2eaeb4(0x2cc),bbpath2='';const botfile='bot.js',configfile=_0x2eaeb4(0x175),settingsfile=_0x2eaeb4(0x1dd),securefile=_0x2eaeb4(0x197),environment=require('./'+bbpath2+_0x2eaeb4(0x272))['environment']||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2eaeb4(0x316)),configpath=userID?bbpath+_0x2eaeb4(0x1e8)+userID+'/':bbpath+_0x2eaeb4(0x1e8),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x2eaeb4(0x22b)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x2eaeb4(0x329)+userID+'/':bbpath+_0x2eaeb4(0x329),loggerfile=fs[_0x2eaeb4(0x337)](logspath+_0x2eaeb4(0x210),{'flags':'a'}),temppath=userID?bbpath+_0x2eaeb4(0x324)+userID+'/':bbpath+_0x2eaeb4(0x324);!fs[_0x2eaeb4(0x22e)](configpath)&&fs[_0x2eaeb4(0x1fa)](configpath);!fs[_0x2eaeb4(0x22e)](configbackuppath)&&fs[_0x2eaeb4(0x1fa)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x2eaeb4(0x1fa)](logspath);!fs[_0x2eaeb4(0x22e)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2eaeb4(0x30b)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2eaeb4(0x30b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2eaeb4(0x2ef),'onepagemode':![]}})[_0x2eaeb4(0x251)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x2eaeb4(0x2f4),'rsaStandard':_0x2eaeb4(0x1d4)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2eaeb4(0x2ea)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2eaeb4(0x225)]&&settings[_0x2eaeb4(0x225)]!=''&&settings[_0x2eaeb4(0x265)]&&settings[_0x2eaeb4(0x265)]!='')initTelegram();const parseColor=(_0x125203,_0x4abca3)=>{const _0x4ae49c=_0x2eaeb4,_0x2e72e7=/#[A-Z]{3}#/g;if(typeof _0x125203==_0x4ae49c(0x271)){!_0x4abca3?_0x125203=_0x125203['replace'](_0x2e72e7,''):(_0x125203=_0x125203[_0x4ae49c(0x223)](/#BLU#/g,_0x4ae49c(0x176)),_0x125203=_0x125203[_0x4ae49c(0x223)](/#RED#/g,'\x1b[31m'),_0x125203=_0x125203[_0x4ae49c(0x223)](/#YEL#/g,_0x4ae49c(0x32a)),_0x125203=_0x125203[_0x4ae49c(0x223)](/#MAG#/g,_0x4ae49c(0x31b)),_0x125203=_0x125203['replace'](/#CYA#/g,_0x4ae49c(0x2c5)),_0x125203=_0x125203[_0x4ae49c(0x223)](/#RES#/g,_0x4ae49c(0x2a6)));;}return _0x125203;},logger={'screen':_0x32b797=>{const _0x544099=_0x2eaeb4;console[_0x544099(0x1e9)](parseColor(_0x32b797,!![]));},'simple':_0x342444=>{const _0xb44300=_0x2eaeb4;console[_0xb44300(0x1e9)](parseColor(_0x342444,!![])),loggerfile[_0xb44300(0x251)](util[_0xb44300(0x30e)](parseColor(_0x342444,![]))+'\x0a');},'full':async _0x5b07a8=>{const _0x49caeb=_0x2eaeb4,_0x4ad8af=getTimeStamp()+_0x49caeb(0x17a)+_0x5b07a8;console[_0x49caeb(0x1e9)](parseColor(_0x4ad8af,!![])),loggerfile[_0x49caeb(0x251)](util[_0x49caeb(0x30e)](parseColor(_0x4ad8af,![]))+'\x0a');if(tgBot&&settings[_0x49caeb(0x21d)]&&settings['telegramEvents']!=_0x49caeb(0x277))await tgBot[_0x49caeb(0x2d7)](settings['telegramChatId'],_0x49caeb(0x1a5)+parseColor(_0x5b07a8,![]))[_0x49caeb(0x325)](_0x47b908=>{telegramError(_0x47b908);});},'debug':async(_0x567646,_0xb79e26='')=>{const _0x2838ce=_0x2eaeb4,_0x40c2d5=getTimeStamp()+_0x2838ce(0x1c2)+_0x567646;if(debugging)console[_0x2838ce(0x1e9)](parseColor(_0x40c2d5,!![]));loggerfile[_0x2838ce(0x251)](util[_0x2838ce(0x30e)](parseColor(_0x40c2d5,![]))+'\x0a');if(_0xb79e26){if(debugging)console[_0x2838ce(0x1e9)](_0xb79e26);loggerfile[_0x2838ce(0x251)](util[_0x2838ce(0x30e)](_0xb79e26)+'\x0a');}}};process['on'](_0x2eaeb4(0x28c),function(_0x13eb87){logger['simple'](_0x13eb87);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2eaeb4(0x275)),app=express(),http=require(_0x2eaeb4(0x16d))[_0x2eaeb4(0x209)](app);app[_0x2eaeb4(0x268)](fileUpload({'useTempFiles':!![]})),app[_0x2eaeb4(0x1af)]('/download/:type',async(_0x70d7c2,_0x426bf8)=>{const _0x493012=_0x2eaeb4,_0xefde0=_0x70d7c2[_0x493012(0x263)][_0x493012(0x1b6)],_0x48d9f7=getClientsWithBotID(_0x493012(0x2cb)),_0x16a1c5=_0x70d7c2[_0x493012(0x2f5)][_0x493012(0x280)],_0x4ee696=timelyDecrypt(_0x16a1c5,![]),_0x2dee72=_0x48d9f7[_0x493012(0x222)](_0x4b5814=>_0x4b5814['uuid']==_0x4ee696);if(_0x2dee72){const _0x27893f=normalizeIP(_0x70d7c2['socket'][_0x493012(0x254)])[_0x493012(0x29d)],_0xac50da=_0x70d7c2[_0x493012(0x2f5)]['tkn'];if(validateAccess(_0xac50da,_0x4ee696,_0x27893f)[_0x493012(0x23c)])_0xefde0==_0x493012(0x2ae)&&await backupConfigFiles(),await zipFiles(_0xefde0),_0x426bf8[_0x493012(0x2be)](zippath+(_0xefde0+_0x493012(0x171)),_0xcbdb9=>{const _0x36d60e=_0x493012;_0xcbdb9&&(logger[_0x36d60e(0x1f6)](_0x36d60e(0x2fd)+_0xefde0),logger[_0x36d60e(0x188)](_0xcbdb9));});else logger[_0x493012(0x1f6)](_0x493012(0x283)+_0xefde0+_0x493012(0x25a));}else logger[_0x493012(0x1f6)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0xefde0+_0x493012(0x17e));}),app['post'](_0x2eaeb4(0x2da),async(_0x40deb8,_0x21ba5c)=>{const _0x3aea2b=_0x2eaeb4,_0x1358f0=getClientsWithBotID(_0x3aea2b(0x2cb)),_0xd4060e=_0x40deb8['headers']['uuid'],_0x2f190e=timelyDecrypt(_0xd4060e,![]),_0xcb0585=_0x1358f0[_0x3aea2b(0x222)](_0x1fc8a1=>_0x1fc8a1[_0x3aea2b(0x280)]==_0x2f190e);logger[_0x3aea2b(0x20a)](_0x3aea2b(0x1c4));if(_0xcb0585){const _0x44142d=normalizeIP(_0x40deb8['socket'][_0x3aea2b(0x254)])[_0x3aea2b(0x29d)],_0x5d2d66=_0x40deb8[_0x3aea2b(0x2f5)][_0x3aea2b(0x28b)];if(validateAccess(_0x5d2d66,_0x2f190e,_0x44142d)[_0x3aea2b(0x23c)]){if(_0x40deb8[_0x3aea2b(0x1d8)]){const _0x36f138=_0x40deb8[_0x3aea2b(0x1d8)][_0x3aea2b(0x2b1)];await _0x36f138['mv'](temppath+_0x36f138[_0x3aea2b(0x285)]),_0x21ba5c[_0x3aea2b(0x34f)]({'status':!![],'message':_0x3aea2b(0x20e)});const _0x39be1b=getBotsWithMode();_0x39be1b[_0x3aea2b(0x178)]>0x0?confirmRestore(temppath,_0x36f138[_0x3aea2b(0x285)]):unzipFile(temppath,_0x36f138[_0x3aea2b(0x285)]);}}else logger[_0x3aea2b(0x1f6)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x3aea2b(0x1f6)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x2eaeb4(0x268)](express['static'](path['join'](__dirname,bbpath2,'build2'))),app[_0x2eaeb4(0x268)](express[_0x2eaeb4(0x1a6)](path[_0x2eaeb4(0x342)](__dirname,bbpath2,'build'))),app[_0x2eaeb4(0x1af)]('/',function(_0x1986ae,_0x3e15dc){const _0x1000d5=_0x2eaeb4;_0x3e15dc[_0x1000d5(0x307)](path['join'](__dirname,bbpath2,_0x1000d5(0x22d),_0x1000d5(0x2ca)));}),app[_0x2eaeb4(0x1af)](_0x2eaeb4(0x2b0),function(_0x4e9002,_0x40291b){const _0x2871f6=_0x2eaeb4;_0x40291b[_0x2871f6(0x307)](path['join'](__dirname,bbpath2,_0x2871f6(0x18d),_0x2871f6(0x2ca)));}),app[_0x2eaeb4(0x1af)](_0x2eaeb4(0x2c3),(_0x3379ac,_0x2fca4c)=>{const _0x7589ac=_0x2eaeb4;_0x2fca4c[_0x7589ac(0x307)](path['join'](__dirname,bbpath2,_0x7589ac(0x18d),_0x7589ac(0x2ca)));}),app[_0x2eaeb4(0x1af)](_0x2eaeb4(0x2b4),(_0x11ec42,_0x30e423)=>{const _0x55eebb=_0x2eaeb4;_0x30e423['sendFile'](path[_0x55eebb(0x342)](__dirname,bbpath2,_0x55eebb(0x18d),_0x55eebb(0x2ca)));}),app[_0x2eaeb4(0x1af)]('/:bot/coins',(_0x1d9f16,_0x3d004a)=>{const _0x5f4269=_0x2eaeb4;_0x3d004a[_0x5f4269(0x307)](path[_0x5f4269(0x342)](__dirname,bbpath2,_0x5f4269(0x18d),_0x5f4269(0x2ca)));}),app[_0x2eaeb4(0x1af)](_0x2eaeb4(0x2ad),(_0xa85aa1,_0x50419c)=>{const _0x1b19a2=_0x2eaeb4;_0x50419c[_0x1b19a2(0x307)](path[_0x1b19a2(0x342)](__dirname,bbpath2,_0x1b19a2(0x18d),_0x1b19a2(0x2ca)));}),app['get'](_0x2eaeb4(0x291),(_0x51c673,_0x53b94b)=>{const _0x57892d=_0x2eaeb4;_0x53b94b[_0x57892d(0x307)](path['join'](__dirname,bbpath2,_0x57892d(0x18d),_0x57892d(0x2ca)));}),app[_0x2eaeb4(0x1af)](_0x2eaeb4(0x2b5),(_0x715e39,_0x1a0275)=>{const _0x28fb1b=_0x2eaeb4;_0x1a0275[_0x28fb1b(0x307)](path['join'](__dirname,bbpath2,_0x28fb1b(0x18d),_0x28fb1b(0x2ca)));});if(HOST)http['listen'](PORT,HOST);else http[_0x2eaeb4(0x33a)](PORT);const io=require(_0x2eaeb4(0x281))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x365c73=_0x2eaeb4;let _0x32c1dd=_0x365c73(0x250);const _0x3bc6e3=networkInterfaces(),_0x50933b={};for(const _0x269c83 of Object[_0x365c73(0x1dc)](_0x3bc6e3)){for(const _0x493ed5 of _0x3bc6e3[_0x269c83]){if((_0x493ed5['family']=='IPv4'||_0x493ed5[_0x365c73(0x1f8)]==0x4)&&!_0x493ed5[_0x365c73(0x2b3)]){const _0x57a284=ipaddr['parse'](_0x493ed5['address'])[_0x365c73(0x1a7)]();_0x57a284!='private'&&(!_0x50933b[_0x269c83]&&(_0x50933b[_0x269c83]=[]),_0x50933b[_0x269c83][_0x365c73(0x229)](_0x493ed5[_0x365c73(0x1b2)]),_0x32c1dd=_0x493ed5[_0x365c73(0x1b2)]);}}}return{'serverip':_0x32c1dd,'netinterfaces':_0x50933b};}async function startServer(){const _0x2143b7=_0x2eaeb4,{serverip:_0x154546,netinterfaces:_0x103627}=getServerIP();logger[_0x2143b7(0x188)](''),logger['simple'](_0x2143b7(0x199)),await logger[_0x2143b7(0x1f6)](_0x2143b7(0x21f)+serverversion+_0x2143b7(0x32d)+(environment=='staging'?_0x2143b7(0x1c3):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x2143b7(0x1ce))+('=>\x20Go\x20to\x20#CYA#http://'+_0x154546+':'+PORT+_0x2143b7(0x2c9))),logger[_0x2143b7(0x188)](_0x2143b7(0x199));if(config[_0x2143b7(0x178)]!=0x0)for(const _0x4bb36c of config){if(_0x4bb36c['status']==_0x2143b7(0x170)||_0x4bb36c[_0x2143b7(0x27b)]==_0x2143b7(0x2a9))await logger[_0x2143b7(0x1f6)]('Starting\x20bot\x20|\x20Bot\x20'+_0x4bb36c['botID']+'\x20|\x20'+_0x4bb36c[_0x2143b7(0x1e7)]),startBot([_0x4bb36c[_0x2143b7(0x214)],userID],{'cwd':bbpath},function(_0x338754){if(_0x338754)logger['full'](_0x338754);});else(_0x4bb36c['status']=='disabled'||_0x4bb36c['status']=='new-disabled')&&await logger[_0x2143b7(0x1f6)](_0x2143b7(0x1c7)+_0x4bb36c[_0x2143b7(0x214)]+_0x2143b7(0x2a7)+_0x4bb36c[_0x2143b7(0x1e7)]);}else!newBot&&logger[_0x2143b7(0x188)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x2143b7(0x188)](''),await logger[_0x2143b7(0x20a)](_0x2143b7(0x1c9)+nodeversion),await logger[_0x2143b7(0x20a)](_0x2143b7(0x1f2),_0x103627);}function startSocket(){const _0xef59f8=_0x2eaeb4;io['on'](_0xef59f8(0x2fb),_0x1dbf1b=>{const _0xf1a216=_0xef59f8;let _0x4fb547,_0xd996b6,_0x11ad7f,_0x4bf196,_0x4e7376;const _0x5e7fb8=_0x1dbf1b[_0xf1a216(0x244)][_0xf1a216(0x2f5)][_0xf1a216(0x284)];_0xd996b6=_0x5e7fb8[_0xf1a216(0x23d)](/bot[0-9]{3}/);if(_0xd996b6)_0x11ad7f=_0xd996b6[0x0][_0xf1a216(0x23d)](/[0-9]{3}/);if(_0x11ad7f)_0x4fb547=_0x11ad7f[0x0];else _0x4fb547=_0xf1a216(0x2cb);const _0x59d4d3=_0x1dbf1b[_0xf1a216(0x244)]['auth'][_0xf1a216(0x185)];if(!_0x59d4d3)_0x1dbf1b[_0xf1a216(0x20f)]('status',{'publicKey':secure['publicKey']});else{_0x4bf196=timelyDecrypt(_0x59d4d3,![]);if(!_0x4bf196)_0x1dbf1b[_0xf1a216(0x20f)]('status',{'publicKey':secure[_0xf1a216(0x248)]});else{_0x4e7376=normalizeIP(_0x1dbf1b['conn']['remoteAddress'])['store'];if(!devices[_0x4bf196])devices[_0x4bf196]={'uuid':_0x4bf196,'access':{'token':null}};devices[_0x4bf196]['ip']=_0x4e7376;const _0x10e265=addClient(_0x1dbf1b['id'],_0x4bf196,_0x4fb547);setAccess(_0x10e265),emitMessages(),_0x1dbf1b['on'](_0xf1a216(0x260),_0x20a749=>{const _0x1b5741=_0xf1a216,_0x56af71=timelyDecrypt(_0x20a749[_0x1b5741(0x217)]);if(_0x56af71){_0x20a749={'username':_0x20a749[_0x1b5741(0x18a)],'password':_0x56af71},devices[_0x4bf196][_0x1b5741(0x2e6)]=validateCredentials(_0x20a749,_0x4bf196);if(devices[_0x4bf196][_0x1b5741(0x2e6)][_0x1b5741(0x23c)]==![]&&devices[_0x4bf196][_0x1b5741(0x2e6)][_0x1b5741(0x239)]==_0x1b5741(0x19d))_0x1dbf1b['emit'](_0x1b5741(0x27b),{'access':devices[_0x4bf196][_0x1b5741(0x2e6)]}),loginAccess2FA(_0x4bf196,_0x4e7376);else{if(devices[_0x4bf196][_0x1b5741(0x2e6)]['allow']==![]&&devices[_0x4bf196]['access']['reason']==_0x1b5741(0x1f4))_0x1dbf1b['emit'](_0x1b5741(0x27b),{'access':devices[_0x4bf196][_0x1b5741(0x2e6)]});else devices[_0x4bf196][_0x1b5741(0x2e6)][_0x1b5741(0x23c)]&&devices[_0x4bf196]['access']['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x4bf196)[_0x1b5741(0x181)](_0x1be235=>{setAccess(_0x1be235);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x4bf196[_0x1b5741(0x1b5)](-0x8)),setTokenRefresh(_0x4bf196),setSessionTimeout(_0x1b5741(0x260),_0x4bf196));}}else logger[_0x1b5741(0x1f6)](_0x1b5741(0x298));}),_0x1dbf1b['on'](_0xf1a216(0x241),()=>{resetPassword();}),_0x1dbf1b['on'](_0xf1a216(0x1fe),_0x4b0859=>{removeClient(_0x1dbf1b['id']);}),_0x4fb547==_0xf1a216(0x2cb)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x53c403){const _0x463ce5=_0x2eaeb4;if(_0x53c403!=_0x463ce5(0x2cb)&&config[_0x463ce5(0x173)]!=''){if(pid[_0x53c403])pid[_0x53c403][_0x463ce5(0x34f)]({'function':_0x463ce5(0x1ad),'args':null});}_0x53c403!=_0x463ce5(0x2cb)&&broadcastToBots(_0x463ce5(0x246),JSON['stringify'](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0xa3d0d2=>{const _0x366fbb=_0x5a9e;getSocket(_0xa3d0d2['id'])[_0x366fbb(0x20f)](_0x366fbb(0x27b),{'access':{'allow':![],'reason':_0x366fbb(0x28d),'token':null}});});}function getSocket(_0x455c28){const _0xe9b902=_0x2eaeb4;return io[_0xe9b902(0x2f3)][_0xe9b902(0x2f3)][_0xe9b902(0x1af)](_0x455c28);}function setAccess(_0x5c133f){const _0x591914=_0x2eaeb4,_0x483433=getSocket(_0x5c133f['id']),_0x770a81=_0x5c133f[_0x591914(0x280)],_0x597f67=_0x5c133f[_0x591914(0x1b0)];devices[_0x770a81]['access']=validateAccess(devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x202)],_0x770a81),logger['debug']('Setting\x20access:\x20'+devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x239)]+_0x591914(0x315)+_0x5c133f['id']['slice'](-0x8)+_0x591914(0x1a1)+_0x770a81[_0x591914(0x1b5)](-0x8)),_0x483433[_0x591914(0x342)](_0x770a81);if(devices[_0x770a81][_0x591914(0x2e6)]['allow']){_0x483433[_0x591914(0x342)](_0x597f67);if(_0x597f67==_0x591914(0x2cb))initializeSocketBotManager(_0x483433);else initializeSocketBot(_0x483433);initClient(_0x597f67);}devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x202)]&&devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x239)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x591914(0x1a8),_0x770a81),devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x202)]&&devices[_0x770a81][_0x591914(0x2e6)]['reason']==_0x591914(0x16b)&&setSessionTimeout('login',_0x770a81),_0x483433[_0x591914(0x20f)](_0x591914(0x27b),{'status':_0x5c133f[_0x591914(0x274)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x770a81]['access'],'externalip':devices[_0x770a81]['ip'],'publicKey':secure[_0x591914(0x248)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x23c)]==![]&&devices[_0x770a81][_0x591914(0x2e6)][_0x591914(0x239)]==_0x591914(0x2c8)&&temporaryAccess2FA(_0x770a81,devices[_0x770a81]['ip']);}function _0x5a9e(_0x36d763,_0x3aed6b){const _0xe8db2=_0x50c9();return _0x5a9e=function(_0x1eba56,_0x2c556c){_0x1eba56=_0x1eba56-0x16b;let _0x50c9ec=_0xe8db2[_0x1eba56];return _0x50c9ec;},_0x5a9e(_0x36d763,_0x3aed6b);}function setSessionTimeout(_0x5c71cd,_0x520d1e){const _0x52975a=_0x2eaeb4;let _0x163e7e;if(_0x5c71cd==_0x52975a(0x260))_0x163e7e=loginExpiry*0x3c*0x3e8;else _0x163e7e=devices[_0x520d1e][_0x52975a(0x1bf)]['expiry']*0x3c*0x3e8-(new Date()[_0x52975a(0x21b)]()-devices[_0x520d1e][_0x52975a(0x1bf)][_0x52975a(0x187)]);if(devices[_0x520d1e][_0x52975a(0x238)])clearTimeout(devices[_0x520d1e][_0x52975a(0x238)]);devices[_0x520d1e][_0x52975a(0x238)]=setTimeout(()=>{const _0x284164=_0x52975a;if(devices[_0x520d1e][_0x284164(0x26f)])clearTimeout(devices[_0x520d1e]['pidRefreshToken']);removeSocketListeners(_0x520d1e),addBlacklist(_0x520d1e),devices[_0x520d1e]['telegramIpApproval']=null,devices[_0x520d1e][_0x284164(0x295)]=null,devices[_0x520d1e][_0x284164(0x2e6)][_0x284164(0x202)]=null,logger[_0x284164(0x20a)](_0x284164(0x1e2)+_0x520d1e['slice'](-0x8)),devices[_0x520d1e][_0x284164(0x2e6)]=validateAccess(devices[_0x520d1e]['access']['token'],_0x520d1e),!(devices[_0x520d1e][_0x284164(0x2e6)]['allow']&&devices[_0x520d1e][_0x284164(0x2e6)][_0x284164(0x239)]=='login\x20not\x20required')&&(_0x5c71cd==_0x284164(0x260)?io['to'](_0x520d1e)[_0x284164(0x20f)](_0x284164(0x27b),{'access':{'allow':![],'reason':_0x284164(0x219),'token':null}}):io['to'](_0x520d1e)[_0x284164(0x20f)](_0x284164(0x27b),{'access':{'allow':![],'reason':_0x284164(0x23a),'token':null}})),devices[_0x520d1e]['access'][_0x284164(0x202)]=null;},_0x163e7e);}function _0x50c9(){const _0x209e81=['*$1*','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','find','replace','assign','telegramToken','Starting\x20Balance\x20Bot\x20reinstallation','temporary\x20access\x20rejected','path','push','Error\x20while\x20deleting\x20config\x20files:\x20','logs/','Unauthorized\x20attempt\x20to\x20delete\x20alerts','build2','existsSync','sendPortfolioTelegram','cloneDeep','Restarting\x20Bot\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','verify','readdirSync','set','track','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','pidExpireLogin','reason','temporary\x20access\x20timeout','restart','allow','match','once','telegram','Unauthorized\x20attempt\x20to\x20get\x20events','reset-password','(((.+)+)+)+$','https://api.ipify.org?format=json','handshake','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','bots','apply','publicKey','stop','User\x20has\x20been\x20validated','mtime','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','/metrics\x20-\x20show\x20bot\x20performance\x0a','delete-bot','output-002.log','[ip-address]','write','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','979866JdqXVE','remoteAddress','Notifications\x20disabled\x0a','resetHistory','2523VNXwdz','toIPv4MappedAddress','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','\x20(1)','Ok,\x20will\x20send\x20alert\x20notifications\x20only','toString','warning','storeFiat','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','login','restore-backup-file','privateKey','params','getHours','telegramUsername','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','update','use','node-telegram-bot-api','message','yargs/yargs','randomFillSync','randomBytes','bbPassword','pidRefreshToken','update-bb','string','version.json','storeHeadless','server','express','storeConfiguration','orders','hex','452chSPKm','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','status','includes','startsWith','then','axios','uuid','socket.io','loginRequired','Unauthorized\x20attempt\x20to\x20download\x20','referer','name','lowdb','30\x20min','output-000.log','stopPolling','function','tkn','uncaughtException','reload','data','Disabled\x20Bot\x20','Alerts','/:bot/configuration','reinstall','Your\x20installation\x20is\x20already\x20up\x20to\x20date','removeListener','telegram2FaApproval','1883wmatWd','host','Unauthorized\x20login\x20attempt\x20(timeout)','login\x20required','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','4201145kkTcED','showname','store','inherit','unlinkSync','min','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','-performance.json','from','Ok,\x20will\x20send\x20order\x20notifications\x20only','/on\x20-\x20start\x20bot(s)\x0a','\x1b[0m','\x20|\x20','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','new','search','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Starting\x20Balance\x20Bot\x20update','/:bot/history','backup','polling_error','/:bot','backupfile','Unauthorized\x20attempt\x20to\x20show\x20configuration','internal','/:bot/performance','/:bot/support','isIPv4MappedAddress','onText','127.0.0.1','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','12FIWvhD','5156300PVqPBi','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','backup-full','download','22kkgmYR','generate','place-order','Restore\x20backup\x20file\x20','/:bot/portfolio','/enable\x20-\x20enable\x20notifications\x0a','\x1b[36m','chat','-results.json','2FA\x20required','#RES#\x20if\x20running\x20on\x20server','index.html','botmanager','bb/','toIPv4Address','telegramEnabled','error','10842pgUHvZ','/update\x20-\x20update\x20Balance\x20Bot\x0a','add','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Bot\x20','getStartingBalances','sendMessage','auto','kill','/upload-backup','mode','all','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','express-fileupload','show-config','headless','Yes','store-configuration','Logged\x20out\x20user\x20...','graphql-request','482228eBvMId','access','5\x20min','get-backup-files','Invalid\x20username\x20or\x20IP\x20address','init','onepagemode','Invalid\x20authentication\x20token\x20(2)','accept','timeshift','0.0.0','secret','f2aRequired','date-fns','sockets','sha256','headers','exchange','disabled','settings','reject','backup-full@','connection','any','Failed\x20to\x20download\x20','exec','Unauthorized\x20attempt\x20to\x20get\x20messages','apiPassword','Notifications\x20types:\x20','cancel-loading','binary','success','isDirectory','telegrammsg','sendFile','21ESQUhK','/names\x20-\x20show\x20bot\x20names\x0a','constructor','defaults','request','getMonth','format','fork','No\x20authentication\x20token','expiry','userid','generateKeyPairAsync','sortBy','\x20|\x20client:\x20...','clients','alias','hashSync','number','/disable\x20-\x20disable\x20notifications\x0a','\x1b[35m','output-003.log','store-fiat','writeFileSync','add-bot','title','stopped','connected','Unauthorized\x20attempt\x20to\x20update\x20bot','temp/','catch','stringify','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','filter','zip/','\x1b[33m','/restart\x20-\x20restart\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','#RES#\x20','getFullYear','Restoring\x20bot(s)\x20from\x20backup','event','lastmsgtelegram','removeAllListeners','login\x20not\x20required','Backup\x20file\x20unzipped\x20and\x20stored','args','login\x20token\x20valid','createWriteStream','get-messages','hybrid-crypto-js','listen','padStart','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','endsWith','blacklist','port','sendMetricsTelegram','whitelist','join','Allow\x20login\x20from\x20IP\x20address\x20<b>','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Login\x20accepted','/status\x20-\x20show\x20bot(s)\x20status\x0a','Access\x20enabled\x20for\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','All\x20bots','remove','argv','showConfig','15\x20min','$1_$2_$3','send','2FA\x20login\x20token\x20generated','::1','http','get-logs','bbvReceive','enabled','.zip','No\x20bots\x20running\x20right\x20now','apiKey','bbvNew','bb-config.json','\x1b[34m','Password\x20reset\x20rejected','length','Login\x20rejected',':\x20Bot\x20Mgr\x20>\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','versions','All','\x20(2)','Notifications\x20disabled','latestversion','forEach','max','uuid-random','HTML','encryptedUuid','getDate','timestamp','simple','************','username','live','readFileSync','build','telegramEvents','Unauthorized\x20attempt\x20to\x20add\x20bot','new-disabled','3000','map','split','Crypt','manual','callback_query','bb-secure.json','logs','-----------------------------------------------------------------------------------','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','cancelLoading','entries','2FA\x20login\x20required','</b>\x20?','SIGTERM','DEFLATE','\x20|\x20user:\x20...','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','login\x20token\x20generated','Bot\x20Mgr\x20>\x20','static','range','2FA','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','store-settings',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Error:\x20Invalid\x20argument\x20','initclient','statSync','get','bot','clientip','address','\x20to\x20','temporary\x20access\x20not\x20allowed','slice','type','lastmsgemitted','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','alerts','logout','decrypt','output-001.log','***','telegramIpApproval','deleteHistoryAlerts','yes',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','(staging)','Backup\x20file\x20uploaded','\x20only\x0a','\x20mode','Idling\x20bot\x20\x20\x20|\x20Bot\x20','exit','Node.js\x20v','parse','whitelistEnabled','test','bbUsername','#RES#\x20if\x20running\x20locally\x0a','settings.','store-headless','\x20>\x20','notification','rmSync','RSA-OAEP','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','env','messages','files','copyFileSync','sort','\x20minutes','keys','bb-settings.json','secure','bot-','1000','started','Session\x20expired\x20for\x20user\x20...','Invalid\x20Telegram\x20token','kind','-config.json','jsonwebtoken','botname','config/','log','Orders','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','order','logged\x20out','Unauthorized\x20attempt\x20to\x20confirm\x20message','2312vHJgmD','file','Network\x20Interfaces:','<b>Balance\x20Bot\x20Status:</b>\x0a','invalid\x20credentials','RSA','full','Invalid\x20IP\x20address','family','-events.json','mkdirSync','Password\x20has\x20been\x20reset\x20to:\x20','size','Error\x20removing\x20old\x20backup\x20files:','disconnect','node','crypto','bcryptjs','token','940yHwxJR','Restore\x20process\x20aborted','/help\x20-\x20show\x20available\x20commands\x0a','running','answerCallbackQuery','Server','createServer','debug','getMinutes','reset-history','getSeconds','File\x20uploaded','emit','/output-000.log','confirm-message','node-zip','value','botID','sign','All\x20bots\x20running\x20right\x20now','password','Enabled\x20Bot\x20','access\x20timeout','hasOwnProperty','getTime','ipc','telegramChatId','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Starting\x20#RED#Balance\x20Bot\x20v'];_0x50c9=function(){return _0x209e81;};return _0x50c9();}function setTokenRefresh(_0x357eb8){const _0x48ffd4=_0x2eaeb4;if(devices[_0x357eb8][_0x48ffd4(0x26f)])clearTimeout(devices[_0x357eb8][_0x48ffd4(0x26f)]);devices[_0x357eb8][_0x48ffd4(0x26f)]=setTimeout(()=>{const _0xec3f77=_0x48ffd4;getClientsWithUuid(_0x357eb8)[_0xec3f77(0x178)]!=0x0?(devices[_0x357eb8][_0xec3f77(0x2e6)]=refreshToken(_0x357eb8),io['to'](_0x357eb8)[_0xec3f77(0x20f)](_0xec3f77(0x27b),{'status':_0xec3f77(0x322),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x357eb8][_0xec3f77(0x2e6)],'externalip':devices[_0x357eb8]['ip'],'publicKey':secure[_0xec3f77(0x248)],'validInstallation':validInstallation}),setTokenRefresh(_0x357eb8)):clearTimeout(devices[_0x357eb8][_0xec3f77(0x26f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5313f5){const _0x3beec7=_0x2eaeb4,_0x1aa77b=getClient(_0x5313f5['id'])['uuid'];_0x5313f5[_0x3beec7(0x20f)]('bots',config),_0x5313f5[_0x3beec7(0x20f)](_0x3beec7(0x2f8),cleanSettings()),_0x5313f5['on'](_0x3beec7(0x31f),_0x3a2aab=>{const _0x56b8a7=_0x3beec7;if(validateAccess(_0x3a2aab,_0x1aa77b)[_0x56b8a7(0x23c)])addBot();else logger[_0x56b8a7(0x1f6)](_0x56b8a7(0x18f));}),_0x5313f5['on']('update-bot',(_0xdc5365,_0x2390ba)=>{const _0x581dfb=_0x3beec7;if(validateAccess(_0x2390ba,_0x1aa77b)[_0x581dfb(0x23c)])toggleBot(_0xdc5365[_0x581dfb(0x214)],_0xdc5365['status'],_0xdc5365[_0x581dfb(0x18b)]);else logger[_0x581dfb(0x1f6)](_0x581dfb(0x323));}),_0x5313f5['on']('toggle-bot-mode',(_0x2edc4d,_0x1807d8)=>{const _0x411ace=_0x3beec7;if(validateAccess(_0x1807d8,_0x1aa77b)[_0x411ace(0x23c)])toggleBotMode(_0x2edc4d);else logger['full'](_0x411ace(0x323));}),_0x5313f5['on'](_0x3beec7(0x24e),(_0x2c6f1b,_0x5738fc)=>{const _0x39d42c=_0x3beec7;if(validateAccess(_0x5738fc,_0x1aa77b)[_0x39d42c(0x23c)])deleteBot(_0x2c6f1b);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x5313f5['on'](_0x3beec7(0x1aa),(_0x3fece6,_0xab3f5d)=>{const _0x195fd8=_0x3beec7;if(validateAccess(_0xab3f5d,_0x1aa77b)[_0x195fd8(0x23c)])storeSettings(_0x3fece6,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x5313f5['on'](_0x3beec7(0x270),_0x341798=>{const _0x48fb98=_0x3beec7;if(validateAccess(_0x341798,_0x1aa77b)[_0x48fb98(0x23c)])updateBB(_0x48fb98(0x267));else logger['full'](_0x48fb98(0x237));}),_0x5313f5['on']('reinstall-bb',_0x234d0e=>{const _0x1901d6=_0x3beec7;if(validateAccess(_0x234d0e,_0x1aa77b)[_0x1901d6(0x23c)])updateBB(_0x1901d6(0x292));else logger[_0x1901d6(0x1f6)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x5313f5['on'](_0x3beec7(0x2e8),_0x4ecf26=>{const _0x3ca8d9=_0x3beec7;if(validateAccess(_0x4ecf26,_0x1aa77b)[_0x3ca8d9(0x23c)]){const _0x18c059=getClient(_0x5313f5['id']);if(_0x18c059)getBackupFiles(_0x18c059[_0x3ca8d9(0x280)]);else logger[_0x3ca8d9(0x1f6)](_0x3ca8d9(0x19a));}else logger[_0x3ca8d9(0x1f6)](_0x3ca8d9(0x252));}),_0x5313f5['on'](_0x3beec7(0x261),(_0x141306,_0x443622)=>{const _0x1139fb=_0x3beec7;if(validateAccess(_0x443622,_0x1aa77b)[_0x1139fb(0x23c)])restoreBackupFile(_0x141306);else logger[_0x1139fb(0x1f6)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5313f5['on'](_0x3beec7(0x338),_0x321406=>{const _0x54b3b5=_0x3beec7;if(validateAccess(_0x321406,_0x1aa77b)[_0x54b3b5(0x23c)])getMessages();else logger[_0x54b3b5(0x1f6)](_0x54b3b5(0x2ff));}),_0x5313f5['on'](_0x3beec7(0x211),(_0x116252,_0x3c7031)=>{const _0x5259a9=_0x3beec7;if(validateAccess(_0x3c7031,_0x1aa77b)[_0x5259a9(0x23c)])confirmMessage(_0x116252);else logger[_0x5259a9(0x1f6)](_0x5259a9(0x1ef));}),_0x5313f5['on'](_0x3beec7(0x1bb),_0x4420e1=>{const _0x5c05f7=_0x3beec7;if(validateAccess(_0x4420e1,_0x1aa77b)['allow']){if(devices[_0x1aa77b]['pidRefreshToken'])clearTimeout(devices[_0x1aa77b][_0x5c05f7(0x26f)]);if(devices[_0x1aa77b]['pidExpireLogin'])clearTimeout(devices[_0x1aa77b][_0x5c05f7(0x238)]);removeSocketListeners(getClient(_0x5313f5['id'])['uuid']),addBlacklist(_0x1aa77b),devices[_0x1aa77b][_0x5c05f7(0x1bf)]=null,devices[_0x1aa77b]['telegram2FaApproval']=null,devices[_0x1aa77b][_0x5c05f7(0x2e6)][_0x5c05f7(0x202)]=null,logger[_0x5c05f7(0x20a)](_0x5c05f7(0x2e3)+_0x1aa77b[_0x5c05f7(0x1b5)](-0x8)),io['to'](getClient(_0x5313f5['id'])[_0x5c05f7(0x280)])[_0x5c05f7(0x20f)]('status',{'access':{'allow':![],'reason':_0x5c05f7(0x1ee),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x42beb5){const _0x2d23e7=_0x2eaeb4,_0x362f42=getClient(_0x42beb5['id'])[_0x2d23e7(0x1b0)],_0xbaaa3a=getClient(_0x42beb5['id'])[_0x2d23e7(0x280)];_0x42beb5['on'](_0x2d23e7(0x16e),(_0x4eb0c4,_0x42b666)=>{const _0x49d67d=_0x2d23e7;if(validateAccess(_0x42b666,_0xbaaa3a)[_0x49d67d(0x23c)]){if(pid[_0x362f42])pid[_0x362f42][_0x49d67d(0x34f)]({'function':'emitHistory','args':_0x4eb0c4});}else logger[_0x49d67d(0x1f6)](_0x49d67d(0x240));}),_0x42beb5['on']('delete-alerts',(_0x5357e7,_0x5359ed)=>{const _0x125dd5=_0x2d23e7;if(validateAccess(_0x5359ed,_0xbaaa3a)[_0x125dd5(0x23c)]){if(pid[_0x362f42])pid[_0x362f42]['send']({'function':_0x125dd5(0x1c0),'args':_0x5357e7});}else logger['full'](_0x125dd5(0x22c));}),_0x42beb5['on']('get-portfolio',(_0x5533ac,_0x424ee6)=>{const _0x5174f5=_0x2d23e7;if(validateAccess(_0x424ee6,_0xbaaa3a)[_0x5174f5(0x23c)]){if(pid[_0x362f42])pid[_0x362f42]['send']({'function':'getPortfolio','args':_0x5533ac});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x42beb5['on'](_0x2d23e7(0x2e2),(_0x326d39,_0x1b346e)=>{const _0x2767f9=_0x2d23e7;if(validateAccess(_0x1b346e,_0xbaaa3a)[_0x2767f9(0x23c)]){if(pid[_0x362f42])pid[_0x362f42][_0x2767f9(0x34f)]({'function':_0x2767f9(0x276),'args':_0x326d39});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x42beb5['on'](_0x2d23e7(0x1d0),(_0x2d44e9,_0x3df7d8)=>{const _0x463932=_0x2d23e7;if(validateAccess(_0x3df7d8,_0xbaaa3a)['allow']){if(pid[_0x362f42])pid[_0x362f42][_0x463932(0x34f)]({'function':_0x463932(0x273),'args':_0x2d44e9});}else logger['full'](_0x463932(0x245));}),_0x42beb5['on'](_0x2d23e7(0x31d),(_0x12ff2d,_0x44dd93)=>{const _0x3b30ea=_0x2d23e7;if(validateAccess(_0x44dd93,_0xbaaa3a)[_0x3b30ea(0x23c)]){if(pid[_0x362f42])pid[_0x362f42]['send']({'function':_0x3b30ea(0x25e),'args':_0x12ff2d});}else logger[_0x3b30ea(0x1f6)](_0x3b30ea(0x2ab));}),_0x42beb5['on'](_0x2d23e7(0x20c),_0x3a0672=>{const _0x1db951=_0x2d23e7;if(validateAccess(_0x3a0672,_0xbaaa3a)['allow']){if(pid[_0x362f42])pid[_0x362f42][_0x1db951(0x34f)]({'function':_0x1db951(0x256),'args':null});}else logger['full'](_0x1db951(0x1d5));}),_0x42beb5['on']('get-starting-balances',_0x1b4978=>{const _0x163e6f=_0x2d23e7;if(validateAccess(_0x1b4978,_0xbaaa3a)[_0x163e6f(0x23c)]){if(pid[_0x362f42])pid[_0x362f42][_0x163e6f(0x34f)]({'function':_0x163e6f(0x2d6),'args':null});}else logger[_0x163e6f(0x1f6)](_0x163e6f(0x2a1));}),_0x42beb5['on'](_0x2d23e7(0x2c1),(_0x102340,_0x401173)=>{const _0x5bbdf5=_0x2d23e7;if(validateAccess(_0x401173,_0xbaaa3a)[_0x5bbdf5(0x23c)]){if(pid[_0x362f42])pid[_0x362f42]['send']({'function':'placeOrder','args':_0x102340});}else logger[_0x5bbdf5(0x1f6)](_0x5bbdf5(0x2a8));}),_0x42beb5['on'](_0x2d23e7(0x302),_0x1f1b4b=>{const _0x39ffc3=_0x2d23e7;if(validateAccess(_0x1f1b4b,_0xbaaa3a)['allow']){if(pid[_0x362f42])pid[_0x362f42][_0x39ffc3(0x34f)]({'function':_0x39ffc3(0x19b),'args':null});}else logger[_0x39ffc3(0x1f6)](_0x39ffc3(0x2dd));}),_0x42beb5['on'](_0x2d23e7(0x2df),_0x4963ae=>{const _0x36ab80=_0x2d23e7;if(validateAccess(_0x4963ae,_0xbaaa3a)[_0x36ab80(0x23c)]){if(pid[_0x362f42])pid[_0x362f42][_0x36ab80(0x34f)]({'function':_0x36ab80(0x34c),'args':null});}else logger[_0x36ab80(0x1f6)](_0x36ab80(0x2b2));}),_0x42beb5['on'](_0x2d23e7(0x270),_0x377386=>{const _0x1a8f34=_0x2d23e7;if(validateAccess(_0x377386,_0xbaaa3a)[_0x1a8f34(0x23c)])updateBB(_0x1a8f34(0x267));else logger['full'](_0x1a8f34(0x237));}),_0x42beb5['on'](_0x2d23e7(0x338),_0x4df675=>{const _0x37b6df=_0x2d23e7;if(validateAccess(_0x4df675,_0xbaaa3a)[_0x37b6df(0x23c)])getMessages();else logger[_0x37b6df(0x1f6)](_0x37b6df(0x2ff));}),_0x42beb5['on'](_0x2d23e7(0x211),(_0x4972e4,_0x23426a)=>{const _0x1a5d0c=_0x2d23e7;if(validateAccess(_0x23426a,_0xbaaa3a)[_0x1a5d0c(0x23c)])confirmMessage(_0x4972e4);else logger[_0x1a5d0c(0x1f6)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x42beb5['on'](_0x2d23e7(0x1bb),_0x34c5d2=>{const _0x120c8c=_0x2d23e7;if(validateAccess(_0x34c5d2,_0xbaaa3a)['allow']){if(devices[_0xbaaa3a][_0x120c8c(0x26f)])clearTimeout(devices[_0xbaaa3a][_0x120c8c(0x26f)]);if(devices[_0xbaaa3a][_0x120c8c(0x238)])clearTimeout(devices[_0xbaaa3a][_0x120c8c(0x238)]);removeSocketListeners(getClient(_0x42beb5['id'])[_0x120c8c(0x280)]),addBlacklist(_0xbaaa3a),devices[_0xbaaa3a][_0x120c8c(0x1bf)]=null,devices[_0xbaaa3a]['telegram2FaApproval']=null,devices[_0xbaaa3a][_0x120c8c(0x2e6)][_0x120c8c(0x202)]=null,logger[_0x120c8c(0x20a)](_0x120c8c(0x2e3)+_0xbaaa3a[_0x120c8c(0x1b5)](-0x8)),io['to'](getClient(_0x42beb5['id'])[_0x120c8c(0x280)])[_0x120c8c(0x20f)]('status',{'access':{'allow':![],'reason':_0x120c8c(0x1ee),'token':null}});}else logger[_0x120c8c(0x1f6)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x59cdc4){const _0x15b7a6=_0x2eaeb4;getClientsWithUuid(_0x59cdc4)[_0x15b7a6(0x181)](_0x234d6d=>{const _0x706f1e=_0x15b7a6;getSocket(_0x234d6d['id'])[_0x706f1e(0x332)]();});}function cleanSettings(){const _0x707e6c=_0x2eaeb4;let _0x240710=settings;return settings['telegramToken']&&settings[_0x707e6c(0x225)]!=''&&(_0x240710={..._0x240710,'telegramToken':_0x707e6c(0x189)}),settings[_0x707e6c(0x26e)]&&settings[_0x707e6c(0x26e)]!=''&&(_0x240710={..._0x240710,'bbPassword':'************'}),(settings[_0x707e6c(0x26e)]&&settings['bbPassword']==_0x707e6c(0x1be)||settings[_0x707e6c(0x225)]&&settings['telegramToken']=='***')&&(_0x240710={..._0x240710,'restored':{'password':settings[_0x707e6c(0x26e)]=='***','telegram':settings[_0x707e6c(0x225)]=='***'}}),_0x240710;}async function updateBB(_0x2a98d4){const _0x46ecd1=_0x2eaeb4;await backupConfigFiles(),installingUpdate=!![],config[_0x46ecd1(0x181)](_0x2e6c92=>{const _0x18664d=_0x46ecd1;restartBot(_0x2e6c92[_0x18664d(0x214)]);});if(_0x2a98d4==_0x46ecd1(0x267))process['send']({'update':!![],'environment':environment},_0x2a252f=>{});else _0x2a98d4=='reinstall'&&process[_0x46ecd1(0x34f)]({'reinstall':!![],'environment':environment},_0xb7a7c5=>{});}function startBot(_0x1295e8,_0x2f7b9c,_0x40fbfd){const _0x1599d0=_0x2eaeb4;if(debugging)_0x1295e8['push']('-d');let _0x45dc98=![];const _0x2db09e=_0x1295e8[0x0];_0x2f7b9c={..._0x2f7b9c,'stdio':['inherit',_0x1599d0(0x29e),_0x1599d0(0x29e),_0x1599d0(0x21c)]},pid[_0x2db09e]=childProcess[_0x1599d0(0x30f)](botfile,_0x1295e8,_0x2f7b9c),pid[_0x2db09e]['on']('message',_0x5ce33d=>{const _0x2aa6b3=_0x1599d0;switch(Object[_0x2aa6b3(0x1dc)](_0x5ce33d)[0x0]){case _0x2aa6b3(0x1e7):updateBotName(_0x2db09e,_0x5ce33d['botname']);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x2db09e,_0x5ce33d['status']);break;case _0x2aa6b3(0x18b):updateLive(_0x2db09e,_0x5ce33d[_0x2aa6b3(0x18b)]);break;case _0x2aa6b3(0x1e1):updateLive(_0x2db09e,_0x5ce33d['started']),io['to'](_0x2db09e)[_0x2aa6b3(0x20f)]('status',{'access':{'allow':![],'reason':_0x2aa6b3(0x28d),'token':null}});break;case _0x2aa6b3(0x249):_0x5ce33d[_0x2aa6b3(0x249)]==_0x2aa6b3(0x23b)&&restartBot(_0x2db09e);_0x5ce33d[_0x2aa6b3(0x249)]==_0x2aa6b3(0x2d9)&&toggleBot(_0x2db09e,_0x2aa6b3(0x2f7),_0x2aa6b3(0x321));break;case _0x2aa6b3(0x23f):sendTelegram(_0x2db09e,_0x5ce33d[_0x2aa6b3(0x23f)]);break;case _0x2aa6b3(0x306):sendTelegramMsg(_0x5ce33d[_0x2aa6b3(0x306)]);break;case'function':io['to'](_0x2db09e)[_0x2aa6b3(0x20f)](_0x5ce33d[_0x2aa6b3(0x28a)],_0x5ce33d[_0x2aa6b3(0x335)]);break;}}),pid[_0x2db09e]['on'](_0x1599d0(0x2cf),function(_0x4d4318){if(_0x45dc98)return;_0x45dc98=!![],_0x40fbfd(_0x4d4318);}),pid[_0x2db09e]['on'](_0x1599d0(0x1c8),async function(_0x42cd7c){const _0x1ff7df=_0x1599d0;if(installingUpdate)return;if(_0x45dc98)return;_0x45dc98=!![],_0x40fbfd(null);const _0x114856=dbConfig[_0x1ff7df(0x1af)](_0x1ff7df(0x246))[_0x1ff7df(0x222)]({'botID':_0x2db09e})[_0x1ff7df(0x213)]();_0x114856&&(_0x114856[_0x1ff7df(0x27b)]==_0x1ff7df(0x170)||_0x114856[_0x1ff7df(0x27b)]=='new')&&(await sleep(0x3e8),updateLive(_0x2db09e,_0x1ff7df(0x321)),logger[_0x1ff7df(0x1f6)](_0x1ff7df(0x231)+_0x2db09e),startBot([_0x2db09e,userID],{'cwd':bbpath},function(_0x179822){if(_0x179822)logger['full'](_0x179822);}));});}function stopBot(_0x58357d){const _0x54cdf6=_0x2eaeb4;getClientsWithBotID(_0x58357d)[_0x54cdf6(0x181)](_0x253e13=>{const _0x406548=_0x54cdf6;getSocket(_0x253e13['id'])[_0x406548(0x1fe)](!![]),removeClient(_0x253e13['id']);}),pid[_0x58357d]&&(pid[_0x58357d][_0x54cdf6(0x2d9)](),pid[_0x58357d]=null);}function restartBot(_0x4c528d){const _0x2c912b=_0x2eaeb4;if(pid[_0x4c528d])pid[_0x4c528d][_0x2c912b(0x2d9)]();}function addBot(){const _0x567fe4=_0x2eaeb4;let _0x2d20bd;for(let _0x107528=0x1;_0x107528<0x3e9;_0x107528++){_0x2d20bd=_0x107528[_0x567fe4(0x25c)]()['padStart'](0x3,'0');let _0x667d54=config[_0x567fe4(0x222)](_0x19abe4=>_0x19abe4[_0x567fe4(0x214)]==_0x2d20bd);if(!_0x667d54)break;}if(_0x2d20bd===_0x567fe4(0x1e0)){logger[_0x567fe4(0x1f6)](_0x567fe4(0x29a));return;}logger[_0x567fe4(0x1f6)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x2d20bd),dbConfig[_0x567fe4(0x1af)]('bots')[_0x567fe4(0x229)]({'botID':_0x2d20bd,'botname':'Bot\x20'+_0x2d20bd,'status':'new','live':''})[_0x567fe4(0x251)](),startBot([_0x2d20bd,userID],{'cwd':bbpath},function(_0x253182){const _0x5516d3=_0x567fe4;if(_0x253182)logger[_0x5516d3(0x1f6)](_0x253182);}),config=getConfiguration(),io['to']('botmanager')[_0x567fe4(0x20f)](_0x567fe4(0x246),config),broadcastToBots(_0x567fe4(0x246),JSON[_0x567fe4(0x326)](config));}function deleteBot(_0x3a80b5){const _0x15ff47=_0x2eaeb4;getClientsWithBotID(_0x3a80b5)[_0x15ff47(0x181)](_0x2744ac=>{const _0x354adb=_0x15ff47;getSocket(_0x2744ac['id'])[_0x354adb(0x1fe)](!![]),removeClient(_0x2744ac['id']);}),dbConfig[_0x15ff47(0x1af)]('bots')[_0x15ff47(0x34a)]({'botID':_0x3a80b5})[_0x15ff47(0x251)](),logger[_0x15ff47(0x1f6)]('Deleted\x20Bot\x20'+_0x3a80b5),stopBot(_0x3a80b5);try{if(fs[_0x15ff47(0x22e)](path['join'](configpath,_0x15ff47(0x1df)+_0x3a80b5+_0x15ff47(0x1e5))))fs[_0x15ff47(0x29f)](path[_0x15ff47(0x342)](configpath,_0x15ff47(0x1df)+_0x3a80b5+_0x15ff47(0x1e5)));if(fs[_0x15ff47(0x22e)](path['join'](configpath,'bot-'+_0x3a80b5+_0x15ff47(0x1f9))))fs[_0x15ff47(0x29f)](path[_0x15ff47(0x342)](configpath,_0x15ff47(0x1df)+_0x3a80b5+_0x15ff47(0x1f9)));if(fs[_0x15ff47(0x22e)](path[_0x15ff47(0x342)](configpath,_0x15ff47(0x1df)+_0x3a80b5+_0x15ff47(0x2a2))))fs[_0x15ff47(0x29f)](path[_0x15ff47(0x342)](configpath,_0x15ff47(0x1df)+_0x3a80b5+_0x15ff47(0x2a2)));if(fs[_0x15ff47(0x22e)](path[_0x15ff47(0x342)](configpath,'bot-'+_0x3a80b5+'-results.json')))fs[_0x15ff47(0x29f)](path[_0x15ff47(0x342)](configpath,_0x15ff47(0x1df)+_0x3a80b5+_0x15ff47(0x2c7)));}catch(_0x33290e){if(_0x33290e)logger[_0x15ff47(0x1f6)](_0x15ff47(0x22a),_0x33290e);}config=getConfiguration(),io['to'](_0x15ff47(0x2cb))[_0x15ff47(0x20f)](_0x15ff47(0x246),config),broadcastToBots('bots',JSON[_0x15ff47(0x326)](config));}function toggleBot(_0x9c81b7,_0x1e6b4a,_0x576aba){const _0x37b443=_0x2eaeb4;dbConfig[_0x37b443(0x1af)](_0x37b443(0x246))[_0x37b443(0x222)]({'botID':_0x9c81b7})[_0x37b443(0x224)]({'status':_0x1e6b4a})[_0x37b443(0x224)]({'live':_0x576aba})['write']();if(_0x1e6b4a==_0x37b443(0x170)||_0x1e6b4a==_0x37b443(0x2a9))logger[_0x37b443(0x1f6)](_0x37b443(0x218)+_0x9c81b7),startBot([_0x9c81b7,userID],{'cwd':bbpath},function(_0x5b5093){if(_0x5b5093)logger['full'](_0x5b5093);});else(_0x1e6b4a=='disabled'||_0x1e6b4a==_0x37b443(0x190))&&(logger[_0x37b443(0x1f6)](_0x37b443(0x28f)+_0x9c81b7),stopBot(_0x9c81b7));config=getConfiguration(),io['to'](_0x37b443(0x2cb))[_0x37b443(0x20f)](_0x37b443(0x246),config),broadcastToBots(_0x37b443(0x246),JSON[_0x37b443(0x326)](config));}function toggleStatus(_0x96062){const _0x49f42d=_0x2eaeb4;let _0x584db7=dbConfig['get']('bots')[_0x49f42d(0x222)]({'botID':_0x96062})[_0x49f42d(0x213)](),_0xb38270;if(_0x584db7[_0x49f42d(0x27b)]==='enabled')_0xb38270='disabled';else{if(_0x584db7[_0x49f42d(0x27b)]===_0x49f42d(0x2a9))_0xb38270=_0x49f42d(0x190);else{if(_0x584db7[_0x49f42d(0x27b)]==='new-disabled')_0xb38270=_0x49f42d(0x2a9);else{if(_0x584db7['status']===_0x49f42d(0x2f7))_0xb38270=_0x49f42d(0x170);}}}return _0xb38270;}function updateStatus(_0x3272a4,_0x3dddba){const _0x1ac9bd=_0x2eaeb4;dbConfig['get'](_0x1ac9bd(0x246))['find']({'botID':_0x3272a4})['assign']({'status':_0x3dddba})[_0x1ac9bd(0x251)](),config=getConfiguration(),io['to'](_0x1ac9bd(0x2cb))['emit']('bots',config),broadcastToBots(_0x1ac9bd(0x246),JSON['stringify'](config));}function updateLive(_0x439e95,_0x4163a7){const _0x5137c6=_0x2eaeb4;dbConfig[_0x5137c6(0x1af)]('bots')[_0x5137c6(0x222)]({'botID':_0x439e95})[_0x5137c6(0x224)]({'live':_0x4163a7})[_0x5137c6(0x251)](),config=getConfiguration(),io['to'](_0x5137c6(0x2cb))[_0x5137c6(0x20f)](_0x5137c6(0x246),config),broadcastToBots(_0x5137c6(0x246),JSON[_0x5137c6(0x326)](config));}function updateBotName(_0x4eec09,_0x8bd661){const _0x28bd3d=_0x2eaeb4;dbConfig['get'](_0x28bd3d(0x246))[_0x28bd3d(0x222)]({'botID':_0x4eec09})[_0x28bd3d(0x224)]({'botname':_0x8bd661})[_0x28bd3d(0x251)](),config=getConfiguration(),io['to'](_0x28bd3d(0x2cb))[_0x28bd3d(0x20f)](_0x28bd3d(0x246),config),broadcastToBots(_0x28bd3d(0x246),JSON[_0x28bd3d(0x326)](config));}function updateBotManager(){const _0x1e7f0e=_0x2eaeb4;config=getConfiguration(),io['to'](_0x1e7f0e(0x2cb))[_0x1e7f0e(0x20f)](_0x1e7f0e(0x246),config),broadcastToBots(_0x1e7f0e(0x246),JSON[_0x1e7f0e(0x326)](config));}function toggleBotMode(_0x47eea9){const _0x156298=_0x2eaeb4;if(pid[_0x47eea9])pid[_0x47eea9]['send']({'function':'toggleBotMode','args':null});else{const _0x18fb6c=configpath+_0x156298(0x1df)+_0x47eea9+'-config.json',_0x596f5f=fs[_0x156298(0x18c)](_0x18fb6c),_0x37d562=JSON[_0x156298(0x1ca)](_0x596f5f),_0x4dfd28=_0x37d562[_0x156298(0x1b0)][0x0][_0x156298(0x2e0)];_0x37d562[_0x156298(0x1b0)][0x0][_0x156298(0x2e0)]=!_0x4dfd28;const _0x3e2f95=JSON['stringify'](_0x37d562,null,0x2);fs['writeFileSync'](_0x18fb6c,_0x3e2f95),config=getConfiguration(),io['to'](_0x156298(0x2cb))[_0x156298(0x20f)](_0x156298(0x246),config),broadcastToBots(_0x156298(0x246),JSON[_0x156298(0x326)](config));}}function telegramError(_0x1e150e){const _0x17cc1f=_0x2eaeb4;logger[_0x17cc1f(0x188)](getTimeStamp()+_0x17cc1f(0x1ab));}function validateTelegram(_0xcf723e){const _0x3e091c=_0x2eaeb4;if(_0xcf723e[_0x3e091c(0x2a3)]['username']!=settings[_0x3e091c(0x265)]&&'@'+_0xcf723e[_0x3e091c(0x2a3)][_0x3e091c(0x18a)]!=settings[_0x3e091c(0x265)])return tgBot[_0x3e091c(0x2d7)](_0xcf723e['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x3e091c(0x325)](_0x152597=>{telegramError(_0x152597);}),![];return!![];}async function initTelegram(){const _0x1bf9c5=_0x2eaeb4;if(tgBot)tgBot[_0x1bf9c5(0x289)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1bf9c5(0x225)],{'polling':!![]});let _0x5f2c15=_0x1bf9c5(0x348);_0x5f2c15+='\x0a',_0x5f2c15+=_0x1bf9c5(0x2c4),_0x5f2c15+=_0x1bf9c5(0x31a),_0x5f2c15+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5f2c15+=_0x1bf9c5(0x32b),_0x5f2c15+=_0x1bf9c5(0x2a5),_0x5f2c15+='/off\x20-\x20stop\x20bot(s)\x0a',_0x5f2c15+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x5f2c15+=_0x1bf9c5(0x309),_0x5f2c15+=_0x1bf9c5(0x346),_0x5f2c15+=_0x1bf9c5(0x24d),_0x5f2c15+=_0x1bf9c5(0x1a9),_0x5f2c15+=_0x1bf9c5(0x2d1),_0x5f2c15+=_0x1bf9c5(0x232),_0x5f2c15+=_0x1bf9c5(0x205);let _0x1be5dc=_0x1bf9c5(0x25f);_0x1be5dc+='\x0a',_0x1be5dc+=_0x5f2c15,tgBot[_0x1bf9c5(0x2b7)](/\/start/,_0xef5e36=>{const _0x49b9f6=_0x1bf9c5;if(!validateTelegram(_0xef5e36))return;if(settings['telegramChatId']!=_0xef5e36['chat']['id'])updateSetting('telegramChatId',_0xef5e36[_0x49b9f6(0x2c6)]['id']);updateSetting(_0x49b9f6(0x2ce),!![]),tgBot[_0x49b9f6(0x2d7)](_0xef5e36[_0x49b9f6(0x2c6)]['id'],_0x1be5dc)[_0x49b9f6(0x325)](_0x2b3003=>{telegramError(_0x2b3003);});}),tgBot['onText'](/\/enable/,_0x56b6b3=>{const _0x43385d=_0x1bf9c5;if(!validateTelegram(_0x56b6b3))return;if(settings[_0x43385d(0x21d)]!=_0x56b6b3[_0x43385d(0x2c6)]['id'])updateSetting(_0x43385d(0x21d),_0x56b6b3[_0x43385d(0x2c6)]['id']);updateSetting(_0x43385d(0x2ce),!![]),tgBot['sendMessage'](_0x56b6b3['chat']['id'],'Notifications\x20enabled')[_0x43385d(0x325)](_0x41ae17=>{telegramError(_0x41ae17);});}),tgBot['onText'](/\/config/,async _0x2a4a1d=>{const _0x4527a6=_0x1bf9c5;if(!validateTelegram(_0x2a4a1d))return;tgBot[_0x4527a6(0x294)](_0x4527a6(0x196)),tgBot['sendMessage'](_0x2a4a1d[_0x4527a6(0x2c6)]['id'],_0x4527a6(0x259),{'reply_markup':{'inline_keyboard':[[{'text':_0x4527a6(0x1ea),'callback_data':_0x4527a6(0x277)},{'text':_0x4527a6(0x290),'callback_data':_0x4527a6(0x1ba)},{'text':_0x4527a6(0x17d),'callback_data':_0x4527a6(0x2dc)}]]}})[_0x4527a6(0x325)](_0x11a85c=>{telegramError(_0x11a85c);}),tgBot['on'](_0x4527a6(0x196),async _0x30ff3c=>{const _0x3607ac=_0x4527a6,_0x198408=_0x30ff3c[_0x3607ac(0x28e)],_0x1f8050=_0x30ff3c['message'];tgBot[_0x3607ac(0x207)](_0x30ff3c['id'])[_0x3607ac(0x27e)](async()=>{const _0xed6961=_0x3607ac;_0x198408==_0xed6961(0x277)&&(updateSetting(_0xed6961(0x18e),_0xed6961(0x277)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x1f8050[_0xed6961(0x2c6)]['id'],_0xed6961(0x2a4))[_0xed6961(0x325)](_0x2fdf1f=>{telegramError(_0x2fdf1f);}));_0x198408==_0xed6961(0x1ba)&&(updateSetting(_0xed6961(0x18e),_0xed6961(0x1ba)),updateSetting('telegramEnabled',!![]),await tgBot[_0xed6961(0x2d7)](_0x1f8050[_0xed6961(0x2c6)]['id'],_0xed6961(0x25b))['catch'](_0x3632be=>{telegramError(_0x3632be);}));_0x198408==_0xed6961(0x2dc)&&(updateSetting('telegramEvents',_0xed6961(0x2dc)),updateSetting(_0xed6961(0x2ce),!![]),await tgBot[_0xed6961(0x2d7)](_0x1f8050[_0xed6961(0x2c6)]['id'],_0xed6961(0x1a2))['catch'](_0x3a7ff9=>{telegramError(_0x3a7ff9);}));if(!settings[_0xed6961(0x21d)])tgBot[_0xed6961(0x2d7)](_0x1f8050[_0xed6961(0x2c6)]['id'],_0xed6961(0x221))['catch'](_0x112cea=>{telegramError(_0x112cea);});}),tgBot[_0x3607ac(0x294)](_0x3607ac(0x196));});}),tgBot['onText'](/\/status/,_0x5715f4=>{const _0x1ae6df=_0x1bf9c5;if(!validateTelegram(_0x5715f4))return;const _0xff548d=getBotsWithMode();let _0x22db63=_0x1ae6df(0x1f3);config[_0x1ae6df(0x181)](_0x173830=>{const _0x2bb2e9=_0x1ae6df,_0x102ca0=_0xff548d['find'](_0x2b6c81=>_0x2b6c81[_0x2bb2e9(0x214)]==_0x173830[_0x2bb2e9(0x214)])[_0x2bb2e9(0x2db)];_0x22db63+=_0x2bb2e9(0x2d5)+_0x173830[_0x2bb2e9(0x214)]+':\x20'+_0x173830[_0x2bb2e9(0x27b)]+_0x2bb2e9(0x2a7)+_0x102ca0+_0x2bb2e9(0x2a7)+_0x173830['live']+'\x0a';}),_0x22db63+='\x0a',_0x22db63+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x22db63+=!settings[_0x1ae6df(0x2ce)]?_0x1ae6df(0x255):'Notifications\x20enabled\x0a',_0x22db63+=settings[_0x1ae6df(0x2ce)]?settings[_0x1ae6df(0x18e)]==_0x1ae6df(0x2dc)?_0x1ae6df(0x27a):_0x1ae6df(0x301)+settings[_0x1ae6df(0x18e)]+_0x1ae6df(0x1c5):'',tgBot[_0x1ae6df(0x2d7)](_0x5715f4[_0x1ae6df(0x2c6)]['id'],_0x22db63,{'parse_mode':_0x1ae6df(0x184)})[_0x1ae6df(0x325)](_0x5ce09b=>{telegramError(_0x5ce09b);});}),tgBot[_0x1bf9c5(0x2b7)](/\/restart/,_0x198db1=>{const _0x5a5bed=_0x1bf9c5;if(!validateTelegram(_0x198db1))return;tgBot[_0x5a5bed(0x294)](_0x5a5bed(0x196));const _0x1eda48=getEnabledBots();if(_0x1eda48[_0x5a5bed(0x178)]==0x0)tgBot['sendMessage'](_0x198db1['chat']['id'],_0x5a5bed(0x172))[_0x5a5bed(0x325)](_0x58041f=>{telegramError(_0x58041f);});else{if(_0x1eda48[_0x5a5bed(0x178)]>0x1)_0x1eda48['push']({'botID':_0x5a5bed(0x2dc)});let _0x31e30e=[],_0x26b338=[];const _0xfc86cd=_0x1eda48[_0x5a5bed(0x178)]%0x4==0x0||_0x1eda48['length']%0x4==0x3||_0x1eda48[_0x5a5bed(0x178)]%0x3==0x1?0x4:0x3;let _0x537093=0x0;_0x1eda48['forEach']((_0x476a87,_0x1eab6b)=>{const _0x400bb2=_0x5a5bed;if(_0x1eab6b%_0xfc86cd==0x0)_0x26b338=[];_0x26b338[_0x400bb2(0x229)]({'text':_0x476a87['botID']==_0x400bb2(0x2dc)?_0x400bb2(0x349):_0x400bb2(0x2d5)+_0x476a87[_0x400bb2(0x214)],'callback_data':_0x476a87[_0x400bb2(0x214)]}),_0x1eab6b%_0xfc86cd==0x0&&(_0x31e30e[_0x537093]=_0x26b338,_0x537093++);}),tgBot[_0x5a5bed(0x2d7)](_0x198db1['chat']['id'],_0x5a5bed(0x1eb),{'reply_markup':{'inline_keyboard':_0x31e30e}})[_0x5a5bed(0x325)](_0x496b11=>{telegramError(_0x496b11);}),tgBot['on'](_0x5a5bed(0x196),async _0x3ea0e1=>{const _0x508bd9=_0x5a5bed,_0x78b672=_0x3ea0e1[_0x508bd9(0x28e)],_0x57c684=_0x3ea0e1['message'];tgBot[_0x508bd9(0x207)](_0x3ea0e1['id'])[_0x508bd9(0x27e)](async()=>{const _0x5c2740=_0x508bd9;_0x78b672==_0x5c2740(0x2dc)?config[_0x5c2740(0x181)](_0x37cfce=>{const _0x516d29=_0x5c2740;restartBot(_0x37cfce[_0x516d29(0x214)]);}):restartBot(_0x78b672);}),tgBot[_0x508bd9(0x294)](_0x508bd9(0x196));});}}),tgBot[_0x1bf9c5(0x2b7)](/\/on/,_0x268214=>{const _0xfb6771=_0x1bf9c5;if(!validateTelegram(_0x268214))return;tgBot[_0xfb6771(0x294)](_0xfb6771(0x196));const _0x50d9b3=getDisabledBots();if(_0x50d9b3[_0xfb6771(0x178)]==0x0)tgBot[_0xfb6771(0x2d7)](_0x268214[_0xfb6771(0x2c6)]['id'],_0xfb6771(0x216))[_0xfb6771(0x325)](_0x59051c=>{telegramError(_0x59051c);});else{if(_0x50d9b3[_0xfb6771(0x178)]>0x1)_0x50d9b3[_0xfb6771(0x229)]({'botID':_0xfb6771(0x2dc)});let _0x2410cb=[],_0x407aa7=[];const _0x502a60=_0x50d9b3[_0xfb6771(0x178)]%0x4==0x0||_0x50d9b3[_0xfb6771(0x178)]%0x4==0x3||_0x50d9b3[_0xfb6771(0x178)]%0x3==0x1?0x4:0x3;let _0x201ee5=0x0;_0x50d9b3[_0xfb6771(0x181)]((_0x5778b3,_0x2d9319)=>{const _0x6802cb=_0xfb6771;if(_0x2d9319%_0x502a60==0x0)_0x407aa7=[];_0x407aa7['push']({'text':_0x5778b3[_0x6802cb(0x214)]=='all'?_0x6802cb(0x349):_0x6802cb(0x2d5)+_0x5778b3[_0x6802cb(0x214)],'callback_data':_0x5778b3['botID']}),_0x2d9319%_0x502a60==0x0&&(_0x2410cb[_0x201ee5]=_0x407aa7,_0x201ee5++);}),tgBot[_0xfb6771(0x2d7)](_0x268214['chat']['id'],_0xfb6771(0x1b8),{'reply_markup':{'inline_keyboard':_0x2410cb}})['catch'](_0x5de8dd=>{telegramError(_0x5de8dd);}),tgBot['on'](_0xfb6771(0x196),async _0x58b078=>{const _0x52f201=_0xfb6771,_0x53f927=_0x58b078[_0x52f201(0x28e)],_0x3b5848=_0x58b078[_0x52f201(0x26a)];tgBot[_0x52f201(0x207)](_0x58b078['id'])[_0x52f201(0x27e)](async()=>{const _0x4a9c0b=_0x52f201;_0x53f927==_0x4a9c0b(0x2dc)?(tgBot['sendMessage'](_0x3b5848['chat']['id'],_0x4a9c0b(0x32c))[_0x4a9c0b(0x325)](_0x6747ba=>{telegramError(_0x6747ba);}),_0x50d9b3[_0x4a9c0b(0x181)](_0x50f161=>{const _0x336413=_0x4a9c0b;if(_0x50f161[_0x336413(0x214)]!=_0x336413(0x2dc))toggleBot(_0x50f161[_0x336413(0x214)],toggleStatus(_0x50f161[_0x336413(0x214)]),_0x336413(0x321));})):(tgBot[_0x4a9c0b(0x2d7)](_0x3b5848[_0x4a9c0b(0x2c6)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x53f927)[_0x4a9c0b(0x325)](_0xfd5f78=>{telegramError(_0xfd5f78);}),toggleBot(_0x53f927,toggleStatus(_0x53f927),'stopped'));}),tgBot[_0x52f201(0x294)](_0x52f201(0x196));});}}),tgBot['onText'](/\/off/,_0x159162=>{const _0x20ff27=_0x1bf9c5;if(!validateTelegram(_0x159162))return;tgBot['removeListener']('callback_query');const _0x2fa86d=getEnabledBots();if(_0x2fa86d[_0x20ff27(0x178)]==0x0)tgBot[_0x20ff27(0x2d7)](_0x159162[_0x20ff27(0x2c6)]['id'],_0x20ff27(0x172))[_0x20ff27(0x325)](_0x42e398=>{telegramError(_0x42e398);});else{if(_0x2fa86d[_0x20ff27(0x178)]>0x1)_0x2fa86d[_0x20ff27(0x229)]({'botID':_0x20ff27(0x2dc)});let _0x32137d=[],_0x22e9a5=[];const _0x1550fb=_0x2fa86d[_0x20ff27(0x178)]%0x4==0x0||_0x2fa86d[_0x20ff27(0x178)]%0x4==0x3||_0x2fa86d[_0x20ff27(0x178)]%0x3==0x1?0x4:0x3;let _0x5a61a3=0x0;_0x2fa86d[_0x20ff27(0x181)]((_0xd48c83,_0x2fce5a)=>{const _0x24972c=_0x20ff27;if(_0x2fce5a%_0x1550fb==0x0)_0x22e9a5=[];_0x22e9a5[_0x24972c(0x229)]({'text':_0xd48c83[_0x24972c(0x214)]==_0x24972c(0x2dc)?_0x24972c(0x349):_0x24972c(0x2d5)+_0xd48c83[_0x24972c(0x214)],'callback_data':_0xd48c83[_0x24972c(0x214)]}),_0x2fce5a%_0x1550fb==0x0&&(_0x32137d[_0x5a61a3]=_0x22e9a5,_0x5a61a3++);}),tgBot[_0x20ff27(0x2d7)](_0x159162[_0x20ff27(0x2c6)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x32137d}})['catch'](_0x26147f=>{telegramError(_0x26147f);}),tgBot['on'](_0x20ff27(0x196),async _0xc4e8f5=>{const _0x28ec3c=_0x20ff27,_0x105b6b=_0xc4e8f5['data'],_0x5bd3fe=_0xc4e8f5[_0x28ec3c(0x26a)];tgBot[_0x28ec3c(0x207)](_0xc4e8f5['id'])[_0x28ec3c(0x27e)](async()=>{const _0x5c5acf=_0x28ec3c;_0x105b6b==_0x5c5acf(0x2dc)?(tgBot[_0x5c5acf(0x2d7)](_0x5bd3fe[_0x5c5acf(0x2c6)]['id'],_0x5c5acf(0x344))[_0x5c5acf(0x325)](_0x193651=>{telegramError(_0x193651);}),_0x2fa86d[_0x5c5acf(0x181)](_0x19901d=>{const _0x28657d=_0x5c5acf;if(_0x19901d[_0x28657d(0x214)]!=_0x28657d(0x2dc))toggleBot(_0x19901d[_0x28657d(0x214)],toggleStatus(_0x19901d[_0x28657d(0x214)]),_0x28657d(0x321));})):(tgBot['sendMessage'](_0x5bd3fe[_0x5c5acf(0x2c6)]['id'],_0x5c5acf(0x266)+_0x105b6b)[_0x5c5acf(0x325)](_0x4d5178=>{telegramError(_0x4d5178);}),toggleBot(_0x105b6b,toggleStatus(_0x105b6b),_0x5c5acf(0x321)));}),tgBot['removeListener'](_0x28ec3c(0x196));});}}),tgBot[_0x1bf9c5(0x2b7)](/\/metrics/,_0xd11893=>{const _0x432acf=_0x1bf9c5;if(!validateTelegram(_0xd11893))return;tgBot[_0x432acf(0x294)](_0x432acf(0x196));const _0x4df16f=getEnabledBots();if(_0x4df16f[_0x432acf(0x178)]==0x0)tgBot[_0x432acf(0x2d7)](_0xd11893[_0x432acf(0x2c6)]['id'],_0x432acf(0x172))[_0x432acf(0x325)](_0x517a62=>{telegramError(_0x517a62);});else{if(_0x4df16f[_0x432acf(0x178)]>0x1){let _0x2b54e4=[],_0x1dfa0c=[];const _0xebb215=_0x4df16f[_0x432acf(0x178)]%0x4==0x0||_0x4df16f[_0x432acf(0x178)]%0x4==0x3||_0x4df16f[_0x432acf(0x178)]%0x3==0x1?0x4:0x3;let _0x5ff926=0x0;_0x4df16f[_0x432acf(0x181)]((_0x22d29e,_0x57d9f9)=>{const _0x7d340d=_0x432acf;if(_0x57d9f9%_0xebb215==0x0)_0x1dfa0c=[];_0x1dfa0c[_0x7d340d(0x229)]({'text':_0x7d340d(0x2d5)+_0x22d29e[_0x7d340d(0x214)],'callback_data':_0x22d29e['botID']}),_0x57d9f9%_0xebb215==0x0&&(_0x2b54e4[_0x5ff926]=_0x1dfa0c,_0x5ff926++);}),tgBot[_0x432acf(0x2d7)](_0xd11893[_0x432acf(0x2c6)]['id'],_0x432acf(0x24c),{'reply_markup':{'inline_keyboard':_0x2b54e4}})[_0x432acf(0x325)](_0x1ca616=>{telegramError(_0x1ca616);}),tgBot['on'](_0x432acf(0x196),async _0x34afd2=>{const _0x3807f6=_0x432acf,_0xc08880=_0x34afd2[_0x3807f6(0x28e)],_0x384791=_0x34afd2[_0x3807f6(0x26a)];tgBot[_0x3807f6(0x207)](_0x34afd2['id'])[_0x3807f6(0x27e)](async()=>{const _0x4936bd=_0x3807f6;if(pid[_0xc08880])pid[_0xc08880][_0x4936bd(0x34f)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x3807f6(0x294)](_0x3807f6(0x196));});}else{const _0xa9dad2=_0x4df16f[0x0]['botID'];if(pid[_0xa9dad2])pid[_0xa9dad2][_0x432acf(0x34f)]({'function':_0x432acf(0x340),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x517031=>{const _0x11709d=_0x1bf9c5;if(!validateTelegram(_0x517031))return;tgBot[_0x11709d(0x294)](_0x11709d(0x196));const _0x22604f=getEnabledBots();if(_0x22604f[_0x11709d(0x178)]==0x0)tgBot['sendMessage'](_0x517031['chat']['id'],_0x11709d(0x172))[_0x11709d(0x325)](_0x51ea9c=>{telegramError(_0x51ea9c);});else{if(_0x22604f[_0x11709d(0x178)]>0x1){let _0x1d86b0=[],_0x1a35e7=[];const _0x39f80a=_0x22604f[_0x11709d(0x178)]%0x4==0x0||_0x22604f[_0x11709d(0x178)]%0x4==0x3||_0x22604f[_0x11709d(0x178)]%0x3==0x1?0x4:0x3;let _0x518bd6=0x0;_0x22604f['forEach']((_0x3340b4,_0x5d4d05)=>{const _0x5124dc=_0x11709d;if(_0x5d4d05%_0x39f80a==0x0)_0x1a35e7=[];_0x1a35e7[_0x5124dc(0x229)]({'text':_0x5124dc(0x2d5)+_0x3340b4[_0x5124dc(0x214)],'callback_data':_0x3340b4[_0x5124dc(0x214)]}),_0x5d4d05%_0x39f80a==0x0&&(_0x1d86b0[_0x518bd6]=_0x1a35e7,_0x518bd6++);}),tgBot[_0x11709d(0x2d7)](_0x517031[_0x11709d(0x2c6)]['id'],_0x11709d(0x33c),{'reply_markup':{'inline_keyboard':_0x1d86b0}})[_0x11709d(0x325)](_0x4d8fae=>{telegramError(_0x4d8fae);}),tgBot['on'](_0x11709d(0x196),async _0x35bf4b=>{const _0x364e54=_0x11709d,_0x4b1298=_0x35bf4b['data'],_0x2fa473=_0x35bf4b[_0x364e54(0x26a)];tgBot['answerCallbackQuery'](_0x35bf4b['id'])[_0x364e54(0x27e)](async()=>{const _0x52f529=_0x364e54;if(pid[_0x4b1298])pid[_0x4b1298]['send']({'function':_0x52f529(0x22f),'args':null});}),tgBot[_0x364e54(0x294)](_0x364e54(0x196));});}else{const _0x317af3=_0x22604f[0x0][_0x11709d(0x214)];if(pid[_0x317af3])pid[_0x317af3][_0x11709d(0x34f)]({'function':_0x11709d(0x22f),'args':null});}}}),tgBot[_0x1bf9c5(0x2b7)](/\/update/,async _0x96eeb1=>{const _0x4008a9=_0x1bf9c5;if(!validateTelegram(_0x96eeb1))return;tgBot['removeListener']('callback_query'),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x96eeb1[_0x4008a9(0x2c6)]['id'],_0x4008a9(0x293))[_0x4008a9(0x325)](_0x5f4e5f=>{telegramError(_0x5f4e5f);});else!validInstallation?tgBot[_0x4008a9(0x2d7)](_0x96eeb1[_0x4008a9(0x2c6)]['id'],_0x4008a9(0x1ec))[_0x4008a9(0x325)](_0x9ce22a=>{telegramError(_0x9ce22a);}):(tgBot[_0x4008a9(0x2d7)](_0x96eeb1[_0x4008a9(0x2c6)]['id'],_0x4008a9(0x17b),{'reply_markup':{'inline_keyboard':[[{'text':_0x4008a9(0x2e1),'callback_data':_0x4008a9(0x1c1)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x4f9c53=>{telegramError(_0x4f9c53);}),tgBot['on'](_0x4008a9(0x196),async _0x23ff73=>{const _0x8766b8=_0x4008a9,_0x305831=_0x23ff73['data'],_0x41da10=_0x23ff73['message'];tgBot[_0x8766b8(0x207)](_0x23ff73['id'])['then'](async()=>{const _0x20de36=_0x8766b8;_0x305831==_0x20de36(0x1c1)&&(await tgBot['sendMessage'](_0x41da10[_0x20de36(0x2c6)]['id'],_0x20de36(0x2ac))[_0x20de36(0x325)](_0x5450a8=>{telegramError(_0x5450a8);}),updateBB('update')),_0x305831=='no'&&await tgBot[_0x20de36(0x2d7)](_0x41da10['chat']['id'],_0x20de36(0x327))[_0x20de36(0x325)](_0x5ed8b2=>{telegramError(_0x5ed8b2);});}),tgBot[_0x8766b8(0x294)](_0x8766b8(0x196));}));}),tgBot[_0x1bf9c5(0x2b7)](/\/reinstall/,async _0x192759=>{const _0x1399e6=_0x1bf9c5;if(!validateTelegram(_0x192759))return;tgBot['removeListener'](_0x1399e6(0x196)),!validInstallation?tgBot[_0x1399e6(0x2d7)](_0x192759[_0x1399e6(0x2c6)]['id'],_0x1399e6(0x2d4))[_0x1399e6(0x325)](_0x133bbf=>{telegramError(_0x133bbf);}):(tgBot[_0x1399e6(0x2d7)](_0x192759[_0x1399e6(0x2c6)]['id'],_0x1399e6(0x21e),{'reply_markup':{'inline_keyboard':[[{'text':_0x1399e6(0x2e1),'callback_data':_0x1399e6(0x1c1)},{'text':'No','callback_data':'no'}]]}})[_0x1399e6(0x325)](_0x1e838e=>{telegramError(_0x1e838e);}),tgBot['on'](_0x1399e6(0x196),async _0x522306=>{const _0x40d758=_0x1399e6,_0x2178dc=_0x522306['data'],_0x55d0b7=_0x522306[_0x40d758(0x26a)];tgBot['answerCallbackQuery'](_0x522306['id'])[_0x40d758(0x27e)](async()=>{const _0x472a79=_0x40d758;_0x2178dc==_0x472a79(0x1c1)&&(await tgBot[_0x472a79(0x2d7)](_0x55d0b7[_0x472a79(0x2c6)]['id'],_0x472a79(0x226))[_0x472a79(0x325)](_0x5b413a=>{telegramError(_0x5b413a);}),updateBB(_0x472a79(0x292))),_0x2178dc=='no'&&await tgBot[_0x472a79(0x2d7)](_0x55d0b7[_0x472a79(0x2c6)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x472a79(0x325)](_0x187783=>{telegramError(_0x187783);});}),tgBot['removeListener'](_0x40d758(0x196));}));}),tgBot[_0x1bf9c5(0x2b7)](/\/toggle/,_0x1bdb8c=>{const _0x152eba=_0x1bf9c5;if(!validateTelegram(_0x1bdb8c))return;tgBot[_0x152eba(0x294)](_0x152eba(0x196));const _0x30d1c7=getBotsWithMode();if(_0x30d1c7[_0x152eba(0x178)]==0x0)tgBot[_0x152eba(0x2d7)](_0x1bdb8c[_0x152eba(0x2c6)]['id'],_0x152eba(0x172))[_0x152eba(0x325)](_0x5ded42=>{telegramError(_0x5ded42);});else{let _0x57be6a=[],_0x40bec5=[];const _0x36d567=0x2;let _0x21473d=0x0;_0x30d1c7[_0x152eba(0x181)]((_0x216d5c,_0x577206)=>{const _0x78edde=_0x152eba;if(_0x577206%_0x36d567==0x0)_0x40bec5=[];_0x40bec5[_0x78edde(0x229)]({'text':_0x78edde(0x2d5)+_0x216d5c[_0x78edde(0x214)]+'\x20('+_0x216d5c[_0x78edde(0x2db)]+')','callback_data':_0x216d5c[_0x78edde(0x214)]}),_0x577206%_0x36d567==0x0&&(_0x57be6a[_0x21473d]=_0x40bec5,_0x21473d++);}),tgBot[_0x152eba(0x2d7)](_0x1bdb8c['chat']['id'],_0x152eba(0x2bc),{'reply_markup':{'inline_keyboard':_0x57be6a}})[_0x152eba(0x325)](_0x5188c7=>{telegramError(_0x5188c7);}),tgBot['on'](_0x152eba(0x196),async _0x3bce32=>{const _0x2c596f=_0x152eba,_0x49b15=_0x3bce32[_0x2c596f(0x28e)],_0x21697d=_0x3bce32['message'];tgBot[_0x2c596f(0x207)](_0x3bce32['id'])[_0x2c596f(0x27e)](async()=>{const _0x186f5f=_0x2c596f,_0x19ccb8=_0x30d1c7['find'](_0x2975d9=>_0x2975d9[_0x186f5f(0x214)]==_0x49b15),_0x54822c=_0x19ccb8['mode']==_0x186f5f(0x2d8)?_0x186f5f(0x195):_0x186f5f(0x2d8);tgBot['sendMessage'](_0x21697d[_0x186f5f(0x2c6)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x49b15+_0x186f5f(0x1b3)+_0x54822c+_0x186f5f(0x1c6))['catch'](_0x2d83ba=>{telegramError(_0x2d83ba);}),toggleBotMode(_0x49b15);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x1bf9c5(0x2b7)](/\/names/,_0x28ce9c=>{const _0x3d873d=_0x1bf9c5;if(!validateTelegram(_0x28ce9c))return;let _0x4a4f15='';config[_0x3d873d(0x181)](_0x3400ce=>{const _0x3e6fb9=_0x3d873d;_0x4a4f15+=_0x3e6fb9(0x2d5)+_0x3400ce[_0x3e6fb9(0x214)]+':\x20'+_0x3400ce[_0x3e6fb9(0x1e7)]+'\x0a';}),tgBot['sendMessage'](_0x28ce9c['chat']['id'],_0x4a4f15,{'parse_mode':_0x3d873d(0x184)})[_0x3d873d(0x325)](_0x1bcc35=>{telegramError(_0x1bcc35);});}),tgBot[_0x1bf9c5(0x2b7)](/\/disable/,_0x32d4d6=>{const _0x13c164=_0x1bf9c5;if(!validateTelegram(_0x32d4d6))return;tgBot[_0x13c164(0x2d7)](_0x32d4d6[_0x13c164(0x2c6)]['id'],_0x13c164(0x17f))[_0x13c164(0x325)](_0x390485=>{telegramError(_0x390485);}),updateSetting(_0x13c164(0x2ce),![]);}),tgBot[_0x1bf9c5(0x2b7)](/\/help/,_0xd92488=>{const _0x11e777=_0x1bf9c5;if(!validateTelegram(_0xd92488))return;tgBot[_0x11e777(0x2d7)](_0xd92488[_0x11e777(0x2c6)]['id'],_0x5f2c15)['catch'](_0xccb7b=>{telegramError(_0xccb7b);});}),tgBot['on'](_0x1bf9c5(0x2af),_0x9b30d6=>{const _0x32681e=_0x1bf9c5;_0x9b30d6[_0x32681e(0x25c)]()[_0x32681e(0x27c)]('404\x20Not\x20Found')&&(logger[_0x32681e(0x1f6)](_0x32681e(0x1e3)),tgBot[_0x32681e(0x289)](),tgBot=null,io['to'](_0x32681e(0x2cb))['emit']('notification',_0x32681e(0x1e3)));}),process[_0x1bf9c5(0x23e)]('SIGINT',()=>{const _0x2877e0=_0x1bf9c5;if(tgBot)tgBot[_0x2877e0(0x289)]();process[_0x2877e0(0x1c8)](0x1);}),process['once'](_0x1bf9c5(0x19f),()=>{const _0x18f9f4=_0x1bf9c5;if(tgBot)tgBot[_0x18f9f4(0x289)]();process[_0x18f9f4(0x1c8)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x49412e,_0x438c72){const _0x2dd651=_0x2eaeb4;if(settings[_0x2dd651(0x2ce)]){if(settings[_0x2dd651(0x18e)]==_0x2dd651(0x2dc)||(_0x438c72[_0x2dd651(0x1b6)]==_0x2dd651(0x2cf)||_0x438c72[_0x2dd651(0x1b6)]==_0x2dd651(0x25d)||_0x438c72[_0x2dd651(0x1b6)]=='success')&&settings[_0x2dd651(0x18e)]==_0x2dd651(0x1ba)||_0x438c72['type']==_0x2dd651(0x1ed)&&settings['telegramEvents']==_0x2dd651(0x277)){if(tgBot&&settings['telegramChatId']){if(_0x438c72[_0x2dd651(0x29c)])tgBot[_0x2dd651(0x2d7)](settings[_0x2dd651(0x21d)],_0x438c72[_0x2dd651(0x1e7)]+_0x2dd651(0x1d1)+_0x438c72[_0x2dd651(0x330)])[_0x2dd651(0x325)](_0x4ab95f=>{telegramError(_0x4ab95f);});else tgBot[_0x2dd651(0x2d7)](settings[_0x2dd651(0x21d)],_0x2dd651(0x2d5)+_0x49412e+_0x2dd651(0x1d1)+_0x438c72[_0x2dd651(0x330)])[_0x2dd651(0x325)](_0x2d3ef3=>{telegramError(_0x2d3ef3);});}}}}async function sendTelegramMsg(_0x349bec,_0x3a3452='HTML'){const _0x1bb9a8=_0x2eaeb4;return settings[_0x1bb9a8(0x2ce)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x1bb9a8(0x2d7)](settings[_0x1bb9a8(0x21d)],_0x349bec,{'parse_mode':_0x3a3452})[_0x1bb9a8(0x325)](_0x44cc12=>{telegramError(_0x44cc12);}),!![]):![];}function getDeviceWithIp(_0x1e9122){const _0x2ed920=_0x2eaeb4;return devices[_0x2ed920(0x222)](_0x3d9f22=>_0x3d9f22['ip']===_0x1e9122);}function temporaryAccess2FA(_0xb2dac1,_0x44541d){const _0x34bf61=_0x2eaeb4;let _0x1632a7=new Date(),_0x58773e=![];if(lastIpApproval){if(_0x1632a7-lastIpApproval<0x1388)_0x58773e=!![];}lastIpApproval=new Date();if(_0x58773e)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x34bf61(0x2d7)](settings[_0x34bf61(0x21d)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x44541d)['show']+_0x34bf61(0x19e),{'parse_mode':_0x34bf61(0x184),'reply_markup':{'inline_keyboard':[[{'text':_0x34bf61(0x2e7),'callback_data':'5'},{'text':_0x34bf61(0x34d),'callback_data':'15'},{'text':_0x34bf61(0x287),'callback_data':'30'},{'text':_0x34bf61(0x2f9),'callback_data':_0x34bf61(0x2f9)}]]}})['catch'](_0x3f1c57=>{telegramError(_0x3f1c57);}),tgBot['on']('callback_query',async _0x3883a0=>{const _0x2ea9e8=_0x34bf61,_0x127b15=_0x3883a0['data'],_0x792fed=_0x3883a0[_0x2ea9e8(0x26a)];tgBot[_0x2ea9e8(0x207)](_0x3883a0['id'])[_0x2ea9e8(0x27e)](async()=>{const _0x42b0bb=_0x2ea9e8;devices[_0xb2dac1]['telegramIpApproval']={'clientip':_0x44541d,'timestamp':new Date()[_0x42b0bb(0x21b)](),'expiry':_0x127b15},_0x127b15!='reject'?(await tgBot['sendMessage'](_0x792fed[_0x42b0bb(0x2c6)]['id'],_0x42b0bb(0x347)+_0x127b15+_0x42b0bb(0x1db),{'parse_mode':_0x42b0bb(0x184)})['catch'](_0x34eafb=>{telegramError(_0x34eafb);}),io['to'](_0xb2dac1)[_0x42b0bb(0x20f)](_0x42b0bb(0x27b),{'access':{'allow':![],'reason':_0x42b0bb(0x28d),'token':null}})):(await tgBot[_0x42b0bb(0x2d7)](_0x792fed['chat']['id'],'Temporary\x20access\x20rejected')[_0x42b0bb(0x325)](_0xbdd367=>{telegramError(_0xbdd367);}),io['to'](_0xb2dac1)[_0x42b0bb(0x20f)](_0x42b0bb(0x27b),{'access':{'allow':![],'reason':_0x42b0bb(0x227),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x540410,_0x5bb76a){const _0xfc75d9=_0x2eaeb4;tgBot&&settings['telegramChatId']&&(tgBot[_0xfc75d9(0x294)](_0xfc75d9(0x196)),tgBot['sendMessage'](settings[_0xfc75d9(0x21d)],_0xfc75d9(0x343)+normalizeIP(_0x5bb76a)['show']+_0xfc75d9(0x19e),{'parse_mode':_0xfc75d9(0x184),'reply_markup':{'inline_keyboard':[[{'text':_0xfc75d9(0x2ed),'callback_data':loginExpiry},{'text':_0xfc75d9(0x2f9),'callback_data':_0xfc75d9(0x2f9)}]]}})[_0xfc75d9(0x325)](_0x2b8342=>{telegramError(_0x2b8342);}),tgBot['on'](_0xfc75d9(0x196),async _0x3e0782=>{const _0x40d3da=_0xfc75d9,_0x10d9d5=_0x3e0782['data'],_0x404ab5=_0x3e0782['message'];tgBot[_0x40d3da(0x207)](_0x3e0782['id'])[_0x40d3da(0x27e)](async()=>{const _0x3d55ae=_0x40d3da;devices[_0x540410][_0x3d55ae(0x295)]={'clientip':_0x5bb76a,'timestamp':new Date()['getTime'](),'expiry':_0x10d9d5},_0x10d9d5!=_0x3d55ae(0x2f9)?(await tgBot[_0x3d55ae(0x2d7)](_0x404ab5[_0x3d55ae(0x2c6)]['id'],_0x3d55ae(0x345),{'parse_mode':_0x3d55ae(0x184)})[_0x3d55ae(0x325)](_0x20004e=>{telegramError(_0x20004e);}),io['to'](_0x540410)[_0x3d55ae(0x20f)]('status',{'access':{'allow':![],'reason':_0x3d55ae(0x28d),'token':null}})):(await tgBot[_0x3d55ae(0x2d7)](_0x404ab5[_0x3d55ae(0x2c6)]['id'],_0x3d55ae(0x179))['catch'](_0x11c138=>{telegramError(_0x11c138);}),io['to'](_0x540410)[_0x3d55ae(0x20f)](_0x3d55ae(0x27b),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x40d3da(0x294)](_0x40d3da(0x196));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x35af6e=_0x2eaeb4;return dbConfig[_0x35af6e(0x1af)]('bots')['sortBy'](_0x35af6e(0x214))[_0x35af6e(0x328)]({'status':_0x35af6e(0x170)})['value']()||[];}function getDisabledBots(){const _0x1d43ad=_0x2eaeb4;return dbConfig['get'](_0x1d43ad(0x246))[_0x1d43ad(0x314)]('botID')[_0x1d43ad(0x328)]({'status':_0x1d43ad(0x2f7)})['value']()||[];}function getBotAttributes(_0x2921ea){const _0x464041=_0x2eaeb4;let _0x25fdd2={};const _0x5f4d73=configpath+'bot-'+_0x2921ea+_0x464041(0x1e5),_0x2be20d=fs[_0x464041(0x22e)](_0x5f4d73);if(_0x2be20d){const _0x4d6692=fs[_0x464041(0x18c)](_0x5f4d73);try{const _0x2f685d=JSON[_0x464041(0x1ca)](_0x4d6692),_0x2862aa=_0x2f685d?_0x2f685d[_0x464041(0x1b0)][0x0]['headless']:![];_0x25fdd2[_0x464041(0x2db)]=_0x2862aa?_0x464041(0x2d8):_0x464041(0x195),_0x25fdd2['botname']=_0x2f685d?_0x2f685d[_0x464041(0x1b0)][0x0][_0x464041(0x1e7)]:_0x464041(0x2d5)+_0x2921ea;}catch(_0x2ab024){_0x25fdd2[_0x464041(0x2db)]=_0x464041(0x195),_0x25fdd2[_0x464041(0x1e7)]=_0x464041(0x2d5)+_0x2921ea;}}else _0x25fdd2[_0x464041(0x2db)]=_0x464041(0x195),_0x25fdd2[_0x464041(0x1e7)]=_0x464041(0x2d5)+_0x2921ea;return _0x25fdd2;}function getBotsWithMode(){const _0xd63276=_0x2eaeb4,_0x1797a6=dbConfig[_0xd63276(0x1af)](_0xd63276(0x246))[_0xd63276(0x314)]('botID')[_0xd63276(0x213)]()||[];return _0x1797a6[_0xd63276(0x181)](_0x252a8f=>{const _0x57422a=_0xd63276;let _0x226039=getBotAttributes(_0x252a8f['botID']);_0x252a8f[_0x57422a(0x2db)]=_0x226039[_0x57422a(0x2db)];}),_0x1797a6;}function getBotExchanges(){const _0x581758=_0x2eaeb4;let _0x32d42d=[];const _0x2c9568=dbConfig['get']('bots')[_0x581758(0x314)](_0x581758(0x214))[_0x581758(0x213)]()||[];_0x2c9568[_0x581758(0x181)](_0x59ea07=>{const _0x1fdf81=_0x581758;if(_0x59ea07[_0x1fdf81(0x27b)]=='enabled'){const _0x299663=configpath+_0x1fdf81(0x1df)+_0x59ea07['botID']+_0x1fdf81(0x1e5),_0x4f01f2=fs[_0x1fdf81(0x22e)](_0x299663);let _0x23e5ce;if(_0x4f01f2){const _0x4c74ae=fs['readFileSync'](_0x299663);try{const _0x2890ff=JSON[_0x1fdf81(0x1ca)](_0x4c74ae);_0x23e5ce=_0x2890ff?_0x2890ff[_0x1fdf81(0x1b0)][0x0][_0x1fdf81(0x2f6)]:null;}catch(_0x17d859){}}if(_0x23e5ce)_0x32d42d[_0x1fdf81(0x229)](_0x23e5ce);}});const _0x471f22=[...new Set(_0x32d42d)]['sort']();return _0x471f22;}async function initUser(){const _0x30652e=_0x2eaeb4;if(!settings[_0x30652e(0x312)]){const _0x59381a=uuidRandom();mixpanel[_0x30652e(0x317)](_0x59381a),updateSetting('userid',_0x59381a);}}async function initSecure(){const _0x49f9a7=_0x2eaeb4;let _0x2df27a=getSecure();if(!_0x2df27a['hasOwnProperty'](_0x49f9a7(0x2f0))){let _0x42534d=await generateKeys();_0x2df27a['publicKey']=_0x42534d[_0x49f9a7(0x248)],_0x2df27a[_0x49f9a7(0x262)]=_0x42534d['privateKey'],_0x2df27a[_0x49f9a7(0x2f0)]=crypto[_0x49f9a7(0x26d)](0x20)[_0x49f9a7(0x25c)](_0x49f9a7(0x278));;storeSecure(_0x2df27a);}}function getSettings(){const _0x55b0e5=_0x2eaeb4;return dbSettings[_0x55b0e5(0x1af)](_0x55b0e5(0x2f8))[_0x55b0e5(0x213)]()||{};}function getSecure(){const _0x30b15d=_0x2eaeb4;return dbSecure[_0x30b15d(0x1af)](_0x30b15d(0x1de))['value']()||{};}function getBlacklist(){const _0x4c3580=_0x2eaeb4;return dbSecure[_0x4c3580(0x1af)](_0x4c3580(0x33e))[_0x4c3580(0x213)]()||[];}function broadcastToBots(_0x3368cd,_0x3bf2e7){const _0x5a0f9e=_0x2eaeb4;config[_0x5a0f9e(0x181)](_0x5a9f9c=>{const _0x1fe9bf=_0x5a0f9e;if(_0x5a9f9c[_0x1fe9bf(0x27b)]=='enabled'&&_0x5a9f9c[_0x1fe9bf(0x18b)]=='running'||_0x5a9f9c[_0x1fe9bf(0x27b)]==_0x1fe9bf(0x2a9)&&_0x5a9f9c['live']==_0x1fe9bf(0x206)){if(pid[_0x5a9f9c['botID']])pid[_0x5a9f9c[_0x1fe9bf(0x214)]][_0x1fe9bf(0x34f)]({[_0x3368cd]:_0x3bf2e7});}});}function storeSettings(_0x5b4c5a,_0xc056d3=![]){const _0x460ed8=_0x2eaeb4;_0x5b4c5a={...settings,..._0x5b4c5a};if(_0xc056d3&&_0x5b4c5a[_0x460ed8(0x26e)]!=_0x460ed8(0x189)&&_0x5b4c5a[_0x460ed8(0x26e)]!=_0x460ed8(0x1be)&&_0x5b4c5a[_0x460ed8(0x26e)]!=''){const _0x59e9b5=crypt[_0x460ed8(0x1bc)](secure['privateKey'],_0x5b4c5a[_0x460ed8(0x26e)])[_0x460ed8(0x26a)][_0x460ed8(0x193)]('@')[0x0],_0x3ed110=bcrypt[_0x460ed8(0x318)](_0x59e9b5,saltRounds);_0x5b4c5a={..._0x5b4c5a,'bbPassword':_0x3ed110};}if(_0xc056d3&&_0x5b4c5a[_0x460ed8(0x225)]!=_0x460ed8(0x189)&&_0x5b4c5a[_0x460ed8(0x225)]!=_0x460ed8(0x1be)&&_0x5b4c5a[_0x460ed8(0x225)]!=''){const _0x54d7bc=crypt['decrypt'](secure['privateKey'],_0x5b4c5a['telegramToken'])[_0x460ed8(0x26a)]['split']('@')[0x0];_0x5b4c5a={..._0x5b4c5a,'telegramToken':_0x54d7bc};}const _0x4ed90b=_0x5b4c5a['telegramToken']!=_0x460ed8(0x189)&&_0x5b4c5a[_0x460ed8(0x225)]!=settings[_0x460ed8(0x225)]||_0x5b4c5a['telegramUsername']!=settings['telegramUsername'],_0x232a61=_0x5b4c5a[_0x460ed8(0x225)]==''||_0x5b4c5a[_0x460ed8(0x265)]=='';if(_0x4ed90b)_0x5b4c5a[_0x460ed8(0x18e)]=_0x460ed8(0x2dc);for(const [_0xa4d22f,_0x184b25]of Object[_0x460ed8(0x19c)](_0x5b4c5a)){if(_0xa4d22f==_0x460ed8(0x225)&&_0x184b25=='************'){_0x5b4c5a[_0x460ed8(0x225)]=settings[_0x460ed8(0x225)];continue;};if(_0xa4d22f==_0x460ed8(0x26e)&&_0x184b25=='************'){_0x5b4c5a[_0x460ed8(0x26e)]=settings[_0x460ed8(0x26e)];continue;};dbSettings[_0x460ed8(0x235)](_0x460ed8(0x1cf)+_0xa4d22f,_0x184b25)[_0x460ed8(0x251)]();}settings=_0x5b4c5a,io['to'](_0x460ed8(0x2cb))[_0x460ed8(0x20f)](_0x460ed8(0x2f8),cleanSettings()),broadcastToBots(_0x460ed8(0x2ee),settings[_0x460ed8(0x2ee)]),broadcastToBots(_0x460ed8(0x2eb),settings[_0x460ed8(0x2eb)]);if(_0x4ed90b&&!_0x232a61)initTelegram();if(_0x4ed90b&&_0x232a61)disableTelegram();getAllClients()[_0x460ed8(0x181)](_0x2d76a2=>{const _0x12a082=_0x460ed8;getSocket(_0x2d76a2['id'])[_0x12a082(0x20f)](_0x12a082(0x27b),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x42fa93,_0x5bd069){const _0x2eb9cd=_0x2eaeb4;dbSettings[_0x2eb9cd(0x235)](_0x2eb9cd(0x1cf)+_0x42fa93,_0x5bd069)['write'](),settings=getSettings(),io['to'](_0x2eb9cd(0x2cb))['emit'](_0x2eb9cd(0x2f8),cleanSettings());}function storeSecure(_0x226760){const _0x194652=_0x2eaeb4;dbSecure[_0x194652(0x1af)](_0x194652(0x1de))[_0x194652(0x229)](_0x226760)[_0x194652(0x251)](),secure=_0x226760;}function addBlacklist(_0x165169){const _0x22e29d=_0x2eaeb4;cleanBlacklist();let _0x1d0956;devices[_0x165169][_0x22e29d(0x1bf)]?_0x1d0956=Math[_0x22e29d(0x182)](devices[_0x165169]['telegramIpApproval'][_0x22e29d(0x311)],loginExpiry):_0x1d0956=loginExpiry,dbSecure[_0x22e29d(0x1af)](_0x22e29d(0x33e))[_0x22e29d(0x229)]({'expiry':new Date()['getTime']()+_0x1d0956*0x3c*0x3e8,'token':devices[_0x165169][_0x22e29d(0x2e6)][_0x22e29d(0x202)]})[_0x22e29d(0x251)](),blacklist=dbSecure[_0x22e29d(0x1af)]('blacklist')[_0x22e29d(0x213)]();}function cleanBlacklist(){const _0x315672=_0x2eaeb4;let _0x3f3227=dbSecure[_0x315672(0x1af)](_0x315672(0x33e))[_0x315672(0x230)]()[_0x315672(0x213)](),_0x394d11=new Date()['getTime']();_0x3f3227[_0x315672(0x181)](_0xe947c6=>{const _0x17030d=_0x315672;_0xe947c6['expiry']<_0x394d11&&dbSecure[_0x17030d(0x1af)](_0x17030d(0x33e))[_0x17030d(0x34a)]({'expiry':_0xe947c6[_0x17030d(0x311)]})[_0x17030d(0x251)]();});}function initStates(){const _0x35e77f=_0x2eaeb4;let _0xff73bb=getConfiguration();_0xff73bb[_0x35e77f(0x181)](_0x2ce317=>{const _0x134a78=_0x35e77f;_0x2ce317['live']=_0x134a78(0x321);}),storeConfiguration(_0xff73bb);}function onKeys(){const _0xee5598=new RSA();return new Promise(_0x4fc159=>{const _0x41d3ed=_0x5a9e;_0xee5598[_0x41d3ed(0x313)]()[_0x41d3ed(0x27e)](_0x462915=>{_0x4fc159(_0x462915);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x298be9=_0x2eaeb4;let _0x17384e=getSettings(),_0x47700d=![];!_0x17384e[_0x298be9(0x21a)](_0x298be9(0x331))&&(_0x17384e[_0x298be9(0x331)]=0x0,_0x47700d=!![]);!_0x17384e[_0x298be9(0x21a)](_0x298be9(0x1b7))&&(_0x17384e['lastmsgemitted']=0x0,_0x47700d=!![]);!_0x17384e[_0x298be9(0x21a)](_0x298be9(0x180))&&(_0x17384e[_0x298be9(0x180)]=_0x298be9(0x2ef),_0x47700d=!![]);!_0x17384e[_0x298be9(0x21a)](_0x298be9(0x2eb))&&(_0x17384e[_0x298be9(0x2eb)]=![],_0x47700d=!![]);if(_0x47700d)storeSettings(_0x17384e);try{fs[_0x298be9(0x234)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x1cca12=>{const _0x309131=_0x298be9;if(!_0x1cca12[_0x309131(0x305)]()){if(!_0x1cca12['name'][_0x309131(0x27d)](_0x309131(0x2fa)))fs['unlinkSync'](configbackuppath+_0x1cca12['name']);}else fs['rmSync'](configbackuppath+_0x1cca12[_0x309131(0x285)],{'recursive':!![]});});}catch(_0x5673c5){logger['debug'](_0x298be9(0x1fd),_0x5673c5);}}function storeConfiguration(_0x7b6021){const _0x3f1611=_0x2eaeb4;dbConfig[_0x3f1611(0x1af)]('bots')[_0x3f1611(0x34a)]()[_0x3f1611(0x251)](),_0x7b6021['forEach'](_0x5d00e8=>{delete _0x5d00e8['mode'];}),dbConfig['get'](_0x3f1611(0x246))[_0x3f1611(0x229)](..._0x7b6021)[_0x3f1611(0x251)](),config=_0x7b6021;}function resetPassword(){const _0x3a2724=_0x2eaeb4;tgBot&&settings[_0x3a2724(0x21d)]&&(tgBot[_0x3a2724(0x294)](_0x3a2724(0x196)),tgBot['sendMessage'](settings['telegramChatId'],_0x3a2724(0x1a3),{'parse_mode':_0x3a2724(0x184),'reply_markup':{'inline_keyboard':[[{'text':_0x3a2724(0x1c1),'callback_data':_0x3a2724(0x1c1)},{'text':'no','callback_data':'no'}]]}})[_0x3a2724(0x325)](_0x2ceb7e=>{telegramError(_0x2ceb7e);}),tgBot['on'](_0x3a2724(0x196),async _0x51a350=>{const _0x48638e=_0x3a2724,_0x45d0b2=_0x51a350['data'],_0x4ebf0c=_0x51a350['message'];tgBot[_0x48638e(0x207)](_0x51a350['id'])['then'](async()=>{const _0x2ab31f=_0x48638e;if(_0x45d0b2!='no'){const _0x162230=0xf,_0x508dfd='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x3094ce=Array[_0x2ab31f(0x2a3)](crypto[_0x2ab31f(0x26c)](new Uint32Array(_0x162230)))[_0x2ab31f(0x192)](_0x1ec373=>_0x508dfd[_0x1ec373%_0x508dfd[_0x2ab31f(0x178)]])[_0x2ab31f(0x342)](''),_0x4af090=bcrypt[_0x2ab31f(0x318)](_0x3094ce,saltRounds);storeSettings({'bbPassword':_0x4af090}),await tgBot['sendMessage'](_0x4ebf0c[_0x2ab31f(0x2c6)]['id'],_0x2ab31f(0x1fb)+_0x3094ce,{'parse_mode':_0x2ab31f(0x184)})[_0x2ab31f(0x325)](_0x34579f=>{telegramError(_0x34579f);});}else await tgBot['sendMessage'](_0x4ebf0c['chat']['id'],_0x2ab31f(0x177))['catch'](_0x5e07ef=>{telegramError(_0x5e07ef);});}),tgBot[_0x48638e(0x294)](_0x48638e(0x196));}));}async function confirmRestore(_0x16c5d9,_0x336aaf){const _0x1b395d=_0x2eaeb4;io['to'](_0x1b395d(0x2cb))[_0x1b395d(0x20f)](_0x1b395d(0x1d2),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x1b395d(0x304)),tgBot&&settings[_0x1b395d(0x21d)]&&(tgBot['removeListener'](_0x1b395d(0x196)),await tgBot[_0x1b395d(0x2d7)](settings['telegramChatId'],_0x1b395d(0x1b9),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1b395d(0x1c1),'callback_data':_0x1b395d(0x1c1)},{'text':'no','callback_data':'no'}]]}})[_0x1b395d(0x325)](_0xf46aad=>{telegramError(_0xf46aad);}),tgBot['on'](_0x1b395d(0x196),async _0x1245e4=>{const _0x2b2ca4=_0x1b395d,_0x20bd1b=_0x1245e4['data'],_0x1a132f=_0x1245e4[_0x2b2ca4(0x26a)];tgBot[_0x2b2ca4(0x207)](_0x1245e4['id'])[_0x2b2ca4(0x27e)](async()=>{const _0x8f49b0=_0x2b2ca4;_0x20bd1b==_0x8f49b0(0x1c1)?(await tgBot['sendMessage'](_0x1a132f[_0x8f49b0(0x2c6)]['id'],_0x8f49b0(0x32f),{'parse_mode':'HTML'})[_0x8f49b0(0x325)](_0x59d1a1=>{telegramError(_0x59d1a1);}),unzipFile(_0x16c5d9,_0x336aaf)):(logger[_0x8f49b0(0x20a)](_0x8f49b0(0x204)),await tgBot['sendMessage'](_0x1a132f['chat']['id'],'Restore\x20process\x20aborted')[_0x8f49b0(0x325)](_0x24c49d=>{telegramError(_0x24c49d);}));}),tgBot[_0x2b2ca4(0x294)]('callback_query');}));}function getServerTime(){const _0x1d7a24=_0x2eaeb4,_0x12ae5f=new Date();return _0x12ae5f[_0x1d7a24(0x32e)]()+'/'+(_0x12ae5f[_0x1d7a24(0x30d)]()+0x1)[_0x1d7a24(0x25c)]()[_0x1d7a24(0x33b)](0x2,'0')+'/'+_0x12ae5f[_0x1d7a24(0x186)]()['toString']()[_0x1d7a24(0x33b)](0x2,'0')+'\x20'+_0x12ae5f['getHours']()[_0x1d7a24(0x25c)]()['padStart'](0x2,'0')+':'+_0x12ae5f[_0x1d7a24(0x20b)]()[_0x1d7a24(0x25c)]()[_0x1d7a24(0x33b)](0x2,'0')+':'+_0x12ae5f['getSeconds']()[_0x1d7a24(0x25c)]()[_0x1d7a24(0x33b)](0x2,'0');}function getTimeStamp(){const _0x3f3afb=_0x2eaeb4,_0x5b2b76=shiftedTime();return _0x5b2b76[_0x3f3afb(0x32e)]()+'/'+(_0x5b2b76[_0x3f3afb(0x30d)]()+0x1)[_0x3f3afb(0x25c)]()[_0x3f3afb(0x33b)](0x2,'0')+'/'+_0x5b2b76[_0x3f3afb(0x186)]()[_0x3f3afb(0x25c)]()[_0x3f3afb(0x33b)](0x2,'0')+'\x20'+_0x5b2b76[_0x3f3afb(0x264)]()[_0x3f3afb(0x25c)]()[_0x3f3afb(0x33b)](0x2,'0')+':'+_0x5b2b76[_0x3f3afb(0x20b)]()['toString']()[_0x3f3afb(0x33b)](0x2,'0')+':'+_0x5b2b76[_0x3f3afb(0x20d)]()[_0x3f3afb(0x25c)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x313d9d=_0x2eaeb4,_0x4706c8=shiftedTime();return _0x4706c8[_0x313d9d(0x32e)]()+(_0x4706c8[_0x313d9d(0x30d)]()+0x1)['toString']()[_0x313d9d(0x33b)](0x2,'0')+_0x4706c8['getDate']()[_0x313d9d(0x25c)]()[_0x313d9d(0x33b)](0x2,'0')+'-'+_0x4706c8[_0x313d9d(0x264)]()['toString']()[_0x313d9d(0x33b)](0x2,'0')+_0x4706c8[_0x313d9d(0x20b)]()[_0x313d9d(0x25c)]()[_0x313d9d(0x33b)](0x2,'0')+_0x4706c8[_0x313d9d(0x20d)]()[_0x313d9d(0x25c)]()[_0x313d9d(0x33b)](0x2,'0');}function shiftedTime(){const _0x1c7665=_0x2eaeb4,_0x52c021=new Date();let _0x15a73a=_0x52c021;if(settings[_0x1c7665(0x2ee)]&&settings['timeshift']!==0x0)_0x15a73a=fns[_0x1c7665(0x2d2)](_0x52c021,{'hours':settings[_0x1c7665(0x2ee)]});return _0x15a73a;}function startScheduler(){const _0x3d73d1=_0x2eaeb4,_0x1e32de=new Date()['getUTCHours'](),_0x3c96c5=shiftedTime()[_0x3d73d1(0x264)]();_0x3c96c5==0x4&&backupConfigFiles();_0x3c96c5==0x0&&rotateLogFiles();_0x1e32de%0x6==0x0&&triggerAnalytics();_0x1e32de%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2ed93f){const _0x183819=_0x2eaeb4;logger[_0x183819(0x20a)](_0x183819(0x2c2)+_0x2ed93f);const _0x475296=getBotsWithMode();_0x475296['length']>0x0?confirmRestore(configbackuppath,_0x2ed93f):unzipFile(configbackuppath,_0x2ed93f);}async function getBackupFiles(_0x288bca=null){const _0x3222d1=_0x2eaeb4;let _0x2ac9eb=[],_0x579f66=fs[_0x3222d1(0x234)](configbackuppath,{'withFileTypes':!![]});_0x579f66['sort']((_0x114832,_0x4a04a7)=>_0x114832[_0x3222d1(0x285)]<_0x4a04a7[_0x3222d1(0x285)]?0x1:_0x4a04a7[_0x3222d1(0x285)]<_0x114832['name']?-0x1:0x0),_0x579f66[_0x3222d1(0x181)](_0x6550d0=>{const _0x599b11=_0x3222d1;if(!_0x6550d0[_0x599b11(0x305)]()&&_0x6550d0[_0x599b11(0x285)]['startsWith'](_0x599b11(0x2fa))&&_0x6550d0[_0x599b11(0x285)][_0x599b11(0x33d)](_0x599b11(0x171))){const _0xce052e=formatDate(fs[_0x599b11(0x1ae)](configbackuppath+_0x6550d0[_0x599b11(0x285)])[_0x599b11(0x24b)]);_0x2ac9eb['push']({'name':_0x6550d0[_0x599b11(0x285)],'mtime':_0xce052e});}});if(_0x288bca)io['to'](_0x288bca)[_0x3222d1(0x20f)]('backup-files',_0x2ac9eb);else return _0x2ac9eb;}async function backupConfigFiles(){const _0x5fa7be=_0x2eaeb4;await zipFiles(_0x5fa7be(0x2bd));const _0x2c6413=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x2c6413+_0x5fa7be(0x171)));let _0x30f218=fs[_0x5fa7be(0x234)](configbackuppath,{'withFileTypes':!![]});_0x30f218[_0x5fa7be(0x1da)]((_0x201974,_0x59367c)=>_0x201974[_0x5fa7be(0x285)]<_0x59367c['name']?0x1:_0x59367c[_0x5fa7be(0x285)]<_0x201974[_0x5fa7be(0x285)]?-0x1:0x0),_0x30f218['length']>maxBackups&&fs[_0x5fa7be(0x29f)](configbackuppath+_0x30f218[_0x30f218[_0x5fa7be(0x178)]-0x1]['name']);}function rotateLogFiles(){const _0x39a9c3=_0x2eaeb4,_0x5c955c=fs['statSync'](logspath+'output-000.log'),_0x5ed83e=_0x5c955c[_0x39a9c3(0x1fc)]/0x400;if(_0x5ed83e>0x64){let _0x48aab7=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x48aab7[_0x39a9c3(0x1da)]((_0x82c5b0,_0x130060)=>_0x82c5b0[_0x39a9c3(0x285)]<_0x130060['name']?0x1:_0x130060['name']<_0x82c5b0[_0x39a9c3(0x285)]?-0x1:0x0),_0x48aab7['forEach'](_0x2cd647=>{const _0x22c6de=_0x39a9c3;if(_0x2cd647[_0x22c6de(0x285)]=='output-002.log')fs['copyFileSync'](logspath+_0x2cd647[_0x22c6de(0x285)],logspath+_0x22c6de(0x31c));if(_0x2cd647['name']==_0x22c6de(0x1bd))fs[_0x22c6de(0x1d9)](logspath+_0x2cd647[_0x22c6de(0x285)],logspath+_0x22c6de(0x24f));_0x2cd647['name']==_0x22c6de(0x288)&&(fs[_0x22c6de(0x1d9)](logspath+_0x2cd647['name'],logspath+_0x22c6de(0x1bd)),fs[_0x22c6de(0x31e)](logspath+_0x2cd647[_0x22c6de(0x285)],''));});}}async function zipFiles(_0x42cd89){const _0x442aae=_0x2eaeb4;let _0x13dd72;if(_0x42cd89==_0x442aae(0x198))_0x13dd72=logspath;if(_0x42cd89==_0x442aae(0x2ae))_0x13dd72=configpath;if(_0x42cd89==_0x442aae(0x2bd))_0x13dd72=configpath;let _0x571762=fs[_0x442aae(0x234)](_0x13dd72,{'withFileTypes':!![]});const _0x5cc95e=new require('node-zip')();_0x571762[_0x442aae(0x181)](_0xed9dab=>{const _0x5646ed=_0x442aae;if(!_0xed9dab[_0x5646ed(0x305)]()){let _0xe31bdf=fs['readFileSync'](_0x13dd72+_0xed9dab[_0x5646ed(0x285)]);if(_0x42cd89==_0x5646ed(0x2ae)){const _0x19ca47=/^bot-[0-9]{3}-config.json$/,_0x1e27ee=_0x19ca47[_0x5646ed(0x1cc)](_0xed9dab[_0x5646ed(0x285)]);if(_0x1e27ee){const _0xed71dc=JSON[_0x5646ed(0x1ca)](_0xe31bdf);if(_0xed71dc['bot'][0x0]){_0xed71dc[_0x5646ed(0x1b0)][0x0][_0x5646ed(0x173)]=_0x5646ed(0x1be),_0xed71dc[_0x5646ed(0x1b0)][0x0]['apiSecret']=_0x5646ed(0x1be);if(_0xed71dc[_0x5646ed(0x1b0)][0x0][_0x5646ed(0x300)])_0xed71dc[_0x5646ed(0x1b0)][0x0]['apiPassword']=_0x5646ed(0x1be);}_0xe31bdf=JSON['stringify'](_0xed71dc,null,0x2);}if(_0xed9dab[_0x5646ed(0x285)]==_0x5646ed(0x1dd)){const _0x599931=JSON[_0x5646ed(0x1ca)](_0xe31bdf);if(_0x599931['settings'][_0x5646ed(0x282)])_0x599931[_0x5646ed(0x2f8)][_0x5646ed(0x282)]=![];if(_0x599931[_0x5646ed(0x2f8)][_0x5646ed(0x26e)])_0x599931['settings'][_0x5646ed(0x26e)]=_0x5646ed(0x1be);if(_0x599931[_0x5646ed(0x2f8)]['telegramToken'])_0x599931[_0x5646ed(0x2f8)]['telegramToken']='***';if(_0x599931[_0x5646ed(0x2f8)][_0x5646ed(0x21d)])_0x599931[_0x5646ed(0x2f8)][_0x5646ed(0x21d)]=null;_0xe31bdf=JSON[_0x5646ed(0x326)](_0x599931,null,0x2);}if(_0xed9dab[_0x5646ed(0x285)]!=_0x5646ed(0x197))_0x5cc95e[_0x5646ed(0x1f1)](_0xed9dab[_0x5646ed(0x285)],_0xe31bdf);}else _0x5cc95e[_0x5646ed(0x1f1)](_0xed9dab[_0x5646ed(0x285)],_0xe31bdf);}});const _0x593c2e=_0x5cc95e[_0x442aae(0x2c0)]({'base64':![],'compression':_0x442aae(0x1a0)});fs[_0x442aae(0x31e)](zippath+(_0x42cd89+_0x442aae(0x171)),_0x593c2e,_0x442aae(0x303));}async function unzipFile(_0x205e4a,_0x314c26){const _0x2bd10f=_0x2eaeb4;fs[_0x2bd10f(0x234)](configpath,{'withFileTypes':!![]})[_0x2bd10f(0x181)](_0x14f411=>{if(!_0x14f411['isDirectory']())fs['rmSync'](configpath+_0x14f411['name']);});const _0x91c1a9=fs[_0x2bd10f(0x18c)](_0x205e4a+_0x314c26,_0x2bd10f(0x303)),_0x13a77c=new require(_0x2bd10f(0x212))(_0x91c1a9,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x13a77c[_0x2bd10f(0x1d8)])[_0x2bd10f(0x181)](_0x55b484=>{const _0x4b03d5=_0x2bd10f,_0x1350ec=_0x13a77c[_0x4b03d5(0x1d8)][_0x55b484];fs[_0x4b03d5(0x31e)](configpath+_0x1350ec[_0x4b03d5(0x285)],_0x1350ec['_data']);}),fs[_0x2bd10f(0x234)](temppath,{'withFileTypes':!![]})[_0x2bd10f(0x181)](_0x1b1d60=>{const _0x3d6319=_0x2bd10f;if(!_0x1b1d60[_0x3d6319(0x305)]())fs[_0x3d6319(0x1d3)](temppath+_0x1b1d60[_0x3d6319(0x285)]);}),logger[_0x2bd10f(0x20a)](_0x2bd10f(0x334)),process[_0x2bd10f(0x34f)]({'restore':!![]},_0x2a2d86=>{});}async function getPublicIp(){const _0x4dd2db=_0x2eaeb4;try{const _0x10bc11=await axios[_0x4dd2db(0x1af)](_0x4dd2db(0x243));publicip=_0x10bc11[_0x4dd2db(0x28e)]['ip'];}catch(_0x5e7b56){}}async function triggerAnalytics(){const _0x4600f9=_0x2eaeb4;if(!publicip)await getPublicIp();const _0xdedbf3=getBotsWithMode();let _0x1551c3=0x0;_0xdedbf3[_0x4600f9(0x181)](_0x3fb78c=>{const _0x5df877=_0x4600f9;if(_0x3fb78c[_0x5df877(0x27b)]===_0x5df877(0x170))_0x1551c3++;});const _0xaa7fbb=getBotExchanges();mixpanel[_0x4600f9(0x236)](_0x4600f9(0x208),{'distinct_id':settings[_0x4600f9(0x312)],'ip':publicip,'version':serverversion,'numbots':_0xdedbf3[_0x4600f9(0x178)],'numbotsenabled':_0x1551c3,'exchanges':_0xaa7fbb,'environment':environment});}async function getMessages(){const _0x3445cb=_0x2eaeb4,_0x1b98fe='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x43918c=new GraphQLClient(_0x1b98fe),_0x301e7a={'authorization':_0x3445cb(0x2b9)},_0x27ea11=serverversion[_0x3445cb(0x193)]('.'),_0x1db0af=_0x27ea11[0x0]+'.'+_0x27ea11[0x1],_0x5af6ae=Math[_0x3445cb(0x2a0)](settings[_0x3445cb(0x331)],settings[_0x3445cb(0x1b7)]),_0x37aff5={'last':parseInt(_0x5af6ae),'bbm':_0x1db0af},_0x52d667=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1a6726;try{_0x1a6726=await _0x43918c[_0x3445cb(0x30c)](_0x52d667,_0x37aff5,_0x301e7a);}catch(_0x5d5225){}if(_0x1a6726&&_0x1a6726[_0x3445cb(0x1d7)]){let _0x16e991=settings[_0x3445cb(0x331)];newMessages=[];for(const _0x2df8c4 of _0x1a6726[_0x3445cb(0x1d7)]){newMessages[_0x3445cb(0x229)](_0x2df8c4);let _0x4e7588=![];_0x2df8c4[_0x3445cb(0x174)]&&(updateSetting(_0x3445cb(0x180),_0x2df8c4['bbvNew']),_0x4e7588=isNewerVersion(serverversion,_0x2df8c4[_0x3445cb(0x174)])||serverversion==_0x2df8c4[_0x3445cb(0x174)]);if(!_0x4e7588&&_0x2df8c4[_0x3445cb(0x319)]>_0x16e991){if(_0x2df8c4['bbvReceive']===_0x3445cb(0x2fc)||serverversion[_0x3445cb(0x27d)](_0x2df8c4[_0x3445cb(0x16f)])){let _0x25abfd=''+_0x2df8c4[_0x3445cb(0x320)]+'\x0a\x0a'+_0x2df8c4['message'];const _0x36c908=await sendTelegramMsg(toTelegramMarkdown(_0x25abfd),'Markdown');if(_0x36c908)_0x16e991=_0x2df8c4[_0x3445cb(0x319)];}}}updateAvailable=isNewerVersion(settings[_0x3445cb(0x180)],serverversion),updateSetting(_0x3445cb(0x331),_0x16e991),emitMessages();}}function emitMessages(){const _0x3f37a1=_0x2eaeb4,_0x45973e=settings[_0x3f37a1(0x1b7)];let _0xed3dd2=[];newMessages[_0x3f37a1(0x181)](_0x41763d=>{const _0xc7a31f=_0x3f37a1;_0x41763d['number']>_0x45973e&&_0xed3dd2[_0xc7a31f(0x229)](_0x41763d);}),_0xed3dd2[_0x3f37a1(0x178)]>0x0&&getAllClients()[_0x3f37a1(0x181)](_0x259472=>{const _0x1da9cc=_0x3f37a1;getSocket(_0x259472['id'])[_0x1da9cc(0x20f)](_0x1da9cc(0x26a),_0xed3dd2);});}function confirmMessage(_0x56d66f){updateSetting('lastmsgemitted',Number(_0x56d66f));}function isNewerVersion(_0xb4899d,_0x238ba){const _0x5c63bf=_0x2eaeb4,_0x24bd2d=_0x238ba['split']('.'),_0x453674=_0xb4899d[_0x5c63bf(0x193)]('.');for(var _0x22bbb9=0x0;_0x22bbb9<_0x453674['length'];_0x22bbb9++){const _0xfc0f86=~~_0x453674[_0x22bbb9],_0x4fe8b8=~~_0x24bd2d[_0x22bbb9];if(_0xfc0f86>_0x4fe8b8)return!![];if(_0xfc0f86<_0x4fe8b8)return![];}return![];}function toTelegramMarkdown(_0x515115){const _0x2212c6=_0x2eaeb4,_0xf0a33f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x41fb12=/\*{2}(.+?)\*{2}/gim;return _0x515115=_0x515115[_0x2212c6(0x223)](_0xf0a33f,_0x2212c6(0x34e))['replace'](_0x41fb12,_0x2212c6(0x220)),_0x515115;}async function validateConfigFile(){const _0x27d7a6=_0x2eaeb4,_0x3f1498=dbConfig[_0x27d7a6(0x1af)]('bots')[_0x27d7a6(0x314)](_0x27d7a6(0x214))[_0x27d7a6(0x213)]()||[];if(_0x3f1498['length']==0x0){let _0x3cd630=0x0,_0x49f4ef=[];const _0x43e631=/^bot-([0-9]{3})-config.json$/,_0x9123fd=fs[_0x27d7a6(0x234)](configpath);_0x9123fd[_0x27d7a6(0x181)](_0x45f652=>{const _0x45f62a=_0x27d7a6,_0xe4933c=_0x43e631[_0x45f62a(0x2fe)](_0x45f652);if(_0xe4933c){const _0x16d946=_0xe4933c[0x1];let _0x33a606=getBotAttributes(_0x16d946);_0x49f4ef[_0x45f62a(0x229)]({'botID':_0x16d946,'botname':_0x33a606['botname'],'status':_0x45f62a(0x2f7),'live':_0x45f62a(0x321)}),_0x3cd630++;}}),_0x3cd630!=0x0&&(dbConfig[_0x27d7a6(0x1af)](_0x27d7a6(0x246))[_0x27d7a6(0x224)](_0x49f4ef)[_0x27d7a6(0x251)](),config=_0x49f4ef,restoredConfigFile=_0x3cd630);}}async function restoreConfigNotify(_0x125646){const _0x4d7a4f=_0x2eaeb4;let _0x439acf;if(restoredConfigFile==0x1)_0x439acf='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x439acf=_0x4d7a4f(0x2d3);if(_0x125646)io['to'](_0x4d7a4f(0x2cb))[_0x4d7a4f(0x20f)]('notification',_0x439acf);else{logger[_0x4d7a4f(0x188)](_0x4d7a4f(0x199)),logger[_0x4d7a4f(0x188)](_0x439acf),logger['simple'](_0x4d7a4f(0x199)),logger[_0x4d7a4f(0x188)]('');if(tgBot&&settings[_0x4d7a4f(0x21d)]&&settings['telegramEvents']!='orders')tgBot[_0x4d7a4f(0x2d7)](settings[_0x4d7a4f(0x21d)],_0x4d7a4f(0x1a5)+_0x439acf)[_0x4d7a4f(0x325)](_0x3a0f3e=>{telegramError(_0x3a0f3e);});}}function validateCredentials(_0x313f3a,_0x1a8653){const _0x42f313=_0x2eaeb4;if(_0x313f3a['username']==settings['bbUsername']&&bcrypt['compareSync'](_0x313f3a[_0x42f313(0x217)],settings['bbPassword'])){if(settings[_0x42f313(0x2f1)])return{'allow':![],'reason':_0x42f313(0x19d),'token':null};else{const _0xacfbaa=generateLoginToken(_0x1a8653);return{'allow':!![],'reason':_0x42f313(0x1a4),'token':_0xacfbaa};}}else return{'allow':![],'reason':_0x42f313(0x1f4),'token':null};}function refreshToken(_0x4b4fbc){const _0x105b4d=_0x2eaeb4,_0x350956=generateLoginToken(_0x4b4fbc);return{'allow':!![],'reason':_0x105b4d(0x1a4),'token':_0x350956};}function validateAccess(_0x224188,_0x2b3153,_0x429be7){const _0x756e1b=_0x2eaeb4,_0x44b3fb=_0x429be7?_0x429be7:devices[_0x2b3153]['ip'];let _0x1add95;const _0xcf80b8=_0x939e0d=>{const _0x23c5a6=_0x5a9e;if(settings[_0x23c5a6(0x282)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x2b3153)){const _0x1b6df7=generateLoginToken(_0x2b3153);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1b6df7};}else return{'allow':![],'reason':_0x23c5a6(0x299),'token':null};}else return _0x1add95=validToken(_0x939e0d,_0x2b3153),_0x1add95['hasOwnProperty'](_0x23c5a6(0x304))?{'allow':!![],'reason':_0x23c5a6(0x336),'token':_0x939e0d}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x23c5a6(0x333),'token':null};};if(settings[_0x756e1b(0x1cb)]){let _0x3942be=[...settings[_0x756e1b(0x341)],_0x756e1b(0x16c),'::ffff:127.0.0.1',_0x756e1b(0x2b8)];if(_0x3942be[_0x756e1b(0x27c)](_0x44b3fb))return _0xcf80b8(_0x224188);else{_0x1add95=validToken(_0x224188,_0x2b3153);if(_0x1add95[_0x756e1b(0x21a)](_0x756e1b(0x304)))return _0xcf80b8(_0x224188);else{if(telegramIpApproved(_0x2b3153)){const _0x290879=generateToken(_0x2b3153);return _0x1add95=_0xcf80b8(_0x224188),_0x1add95[_0x756e1b(0x23c)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x290879}:_0x1add95;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x756e1b(0x2c8),'token':null}:{'allow':![],'reason':_0x756e1b(0x1b4),'token':null};}}}else return _0xcf80b8(_0x224188);}function timelyDecrypt(_0x4a2df4,_0x48ccc2=!![]){const _0x8e139b=_0x2eaeb4;if(_0x4a2df4)try{const _0xc3bc42=crypt[_0x8e139b(0x1bc)](secure[_0x8e139b(0x262)],_0x4a2df4)['message'],_0x4d2d72=_0xc3bc42[_0x8e139b(0x193)]('@')[0x0],_0x5f3e2a=_0xc3bc42[_0x8e139b(0x193)]('@')[0x1],_0x513b6d=new Date()['getTime']();if(_0x48ccc2){if(_0x513b6d-_0x5f3e2a<maxSecretAge*0x3e8)return _0x4d2d72;else return![];}else return _0x4d2d72;}catch(_0x28031a){return![];}else return![];}const validToken=(_0x1f63f8,_0x354960)=>{const _0x9f3245=_0x2eaeb4,_0x2986b5=devices[_0x354960]['ip'];if(!_0x1f63f8)return{'error':_0x9f3245(0x310)};for(let _0x1eb67f of blacklist){if(_0x1eb67f['token']==_0x1f63f8)return{'error':'Token\x20blacklisted'};}let _0x2227f6;try{_0x2227f6=jwt[_0x9f3245(0x233)](_0x1f63f8,secure[_0x9f3245(0x2f0)]+_0x354960);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x2227f6[_0x9f3245(0x21a)](_0x9f3245(0x1b1))&&!_0x2227f6[_0x9f3245(0x21a)](_0x9f3245(0x18a))||!_0x2227f6[_0x9f3245(0x21a)]('exp'))return{'error':_0x9f3245(0x2ec)};if(!_0x2227f6[_0x9f3245(0x21a)](_0x9f3245(0x18a))&&_0x2227f6[_0x9f3245(0x21a)]('clientip')){const {clientip:_0x3440df}=_0x2227f6;return _0x2986b5==_0x3440df?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x9f3245(0x1f7)};}else{if(_0x2227f6[_0x9f3245(0x21a)](_0x9f3245(0x18a))&&_0x2227f6['hasOwnProperty'](_0x9f3245(0x1b1))){const {username:_0x401fb3,clientip:_0x1dcddd}=_0x2227f6;return settings[_0x9f3245(0x1cd)]==_0x401fb3&&_0x2986b5==_0x1dcddd?{'success':_0x9f3245(0x24a)}:{'error':_0x9f3245(0x2e9)};}}},generateLoginToken=_0x5e1a77=>{const _0x48bebd=_0x2eaeb4;if(_0x5e1a77){const _0x419e10=devices[_0x5e1a77]['ip'];return jwt[_0x48bebd(0x215)]({'username':settings[_0x48bebd(0x1cd)],'clientip':_0x419e10},secure[_0x48bebd(0x2f0)]+_0x5e1a77,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x411a39=>{const _0xa1bab5=_0x2eaeb4;if(_0x411a39){const _0x53c127=devices[_0x411a39]['ip'];return jwt[_0xa1bab5(0x215)]({'clientip':_0x53c127},secure[_0xa1bab5(0x2f0)]+_0x411a39,{'expiresIn':devices[_0x411a39][_0xa1bab5(0x1bf)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x5d9aa3=>{const _0x5ccf94=_0x2eaeb4;let _0x27f1f9=![];return devices[_0x5d9aa3][_0x5ccf94(0x1bf)]&&devices[_0x5d9aa3][_0x5ccf94(0x1bf)]['expiry']!=_0x5ccf94(0x2f9)&&(_0x27f1f9=devices[_0x5d9aa3][_0x5ccf94(0x1bf)][_0x5ccf94(0x1b1)]==devices[_0x5d9aa3]['ip']&&new Date()[_0x5ccf94(0x21b)]()-devices[_0x5d9aa3][_0x5ccf94(0x1bf)]['timestamp']<devices[_0x5d9aa3][_0x5ccf94(0x1bf)][_0x5ccf94(0x311)]*0x3c*0x3e8),_0x27f1f9;},telegram2FaApproved=_0x375a6f=>{const _0x110c58=_0x2eaeb4;let _0x1120a1=![];return devices[_0x375a6f][_0x110c58(0x295)]&&devices[_0x375a6f][_0x110c58(0x295)][_0x110c58(0x311)]!=_0x110c58(0x2f9)&&(_0x1120a1=devices[_0x375a6f]['telegram2FaApproval']['clientip']==devices[_0x375a6f]['ip']&&new Date()[_0x110c58(0x21b)]()-devices[_0x375a6f][_0x110c58(0x295)][_0x110c58(0x187)]<devices[_0x375a6f][_0x110c58(0x295)][_0x110c58(0x311)]*0x3c*0x3e8),_0x1120a1;},normalizeIP=_0x3387fb=>{const _0x332dbd=_0x2eaeb4;let _0x9b678c=null,_0x5e7881=null;if(ipaddr['isValid'](_0x3387fb)){const _0x107c63=ipaddr[_0x332dbd(0x1ca)](_0x3387fb);_0x107c63[_0x332dbd(0x1e4)]()==='ipv6'?(_0x107c63[_0x332dbd(0x2b6)]()&&(_0x9b678c=_0x107c63[_0x332dbd(0x2cd)]()[_0x332dbd(0x25c)]()),_0x5e7881=_0x107c63['toString']()):(_0x9b678c=_0x107c63[_0x332dbd(0x25c)](),_0x5e7881=_0x107c63[_0x332dbd(0x258)]()[_0x332dbd(0x25c)]());}return{'show':_0x9b678c?_0x9b678c:_0x5e7881,'store':_0x5e7881};};function formatDate(_0x24a85f){const _0x166a75=_0x2eaeb4;return _0x24a85f[_0x166a75(0x32e)]()+'/'+(_0x24a85f[_0x166a75(0x30d)]()+0x1)['toString']()[_0x166a75(0x33b)](0x2,'0')+'/'+_0x24a85f['getDate']()[_0x166a75(0x25c)]()['padStart'](0x2,'0')+'\x20'+_0x24a85f[_0x166a75(0x264)]()[_0x166a75(0x25c)]()[_0x166a75(0x33b)](0x2,'0')+':'+_0x24a85f[_0x166a75(0x20b)]()[_0x166a75(0x25c)]()[_0x166a75(0x33b)](0x2,'0')+':'+_0x24a85f[_0x166a75(0x20d)]()[_0x166a75(0x25c)]()[_0x166a75(0x33b)](0x2,'0');}function sleep(_0x5d2365){return new Promise(_0x5a1171=>setTimeout(_0x5a1171,_0x5d2365));}