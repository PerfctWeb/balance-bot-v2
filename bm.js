const _0x447343=_0x5c21;(function(_0xba990b,_0xab6721){const _0x3b659c=_0x5c21,_0x530a8=_0xba990b();while(!![]){try{const _0x18f8c6=-parseInt(_0x3b659c(0x2ed))/0x1+parseInt(_0x3b659c(0x22a))/0x2*(-parseInt(_0x3b659c(0x187))/0x3)+-parseInt(_0x3b659c(0x1d1))/0x4*(-parseInt(_0x3b659c(0x106))/0x5)+parseInt(_0x3b659c(0x218))/0x6*(parseInt(_0x3b659c(0x298))/0x7)+-parseInt(_0x3b659c(0x2d5))/0x8*(parseInt(_0x3b659c(0x244))/0x9)+parseInt(_0x3b659c(0x12e))/0xa+parseInt(_0x3b659c(0x1eb))/0xb;if(_0x18f8c6===_0xab6721)break;else _0x530a8['push'](_0x530a8['shift']());}catch(_0x54cd0a){_0x530a8['push'](_0x530a8['shift']());}}}(_0x3ec1,0x87bcd));const _0xbd8ed7=function(){let _0xc29a73=!![];return function(_0x39259b,_0x57d952){const _0x4b772e=_0xc29a73?function(){if(_0x57d952){const _0x44ad6a=_0x57d952['apply'](_0x39259b,arguments);return _0x57d952=null,_0x44ad6a;}}:function(){};return _0xc29a73=![],_0x4b772e;};}(),_0x55dda3=_0xbd8ed7(this,function(){const _0x4a425a=_0x5c21;return _0x55dda3[_0x4a425a(0x21f)]()[_0x4a425a(0x291)]('(((.+)+)+)+$')[_0x4a425a(0x21f)]()['constructor'](_0x55dda3)[_0x4a425a(0x291)](_0x4a425a(0x2b6));});_0x55dda3();'use strict';process[_0x447343(0x105)][_0x447343(0x167)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require(_0x447343(0x297)),path=require('path'),crypto=require(_0x447343(0x101)),Crypt=require(_0x447343(0x1bf))[_0x447343(0x13f)],RSA=require(_0x447343(0x1bf))[_0x447343(0x18d)],bcrypt=require(_0x447343(0x10a)),jwt=require(_0x447343(0x1ce)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x447343(0x224)][_0x447343(0x216)](0x2))[_0x447343(0x224)],uuidRandom=require(_0x447343(0x1aa)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x447343(0x16b)),axios=require('axios'),{GraphQLClient,gql}=require(_0x447343(0x13b)),util=require(_0x447343(0x126)),fileUpload=require(_0x447343(0x157)),{networkInterfaces}=require('os'),PORT=argv[_0x447343(0x282)]||_0x447343(0x17e),pattern=/^[0-9]{2,4}$/;!pattern[_0x447343(0x142)](PORT)&&(console[_0x447343(0x230)](_0x447343(0x145)+PORT+_0x447343(0x22e)),process[_0x447343(0x2b5)](0x1));const HOST=argv['host']||null,userID=argv[_0x447343(0x1ac)]||'',debugging=argv['d']||![],nodeversion=process[_0x447343(0x24e)][_0x447343(0x186)];let bbpath=_0x447343(0x2c8),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x447343(0x198),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x447343(0x2ba))[_0x447343(0x2be)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x447343(0x212)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x447343(0x214)),configpath=userID?bbpath+_0x447343(0x248)+userID+'/':bbpath+_0x447343(0x248),configbackuppath=configpath+_0x447343(0x2c4),logspath=userID?bbpath+_0x447343(0x19a)+userID+'/':bbpath+_0x447343(0x19a),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x447343(0x15b),loggerfile=fs[_0x447343(0x144)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x447343(0x1b6)+userID+'/':bbpath+'temp/';!fs[_0x447343(0x212)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x447343(0x2c2)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x447343(0x2c2)](logspath);!fs[_0x447343(0x212)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x447343(0x212)](temppath)&&fs[_0x447343(0x2c2)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x3ec1(){const _0x4fe079=['Restore\x20process\x20aborted','812nteJsH','reinstall','sendFile','2FA\x20required','\x20(2)','rmSync','update_yes','inlineKeyboard','stringify','fork','Notifications\x20disabled\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','data','\x20|\x20','stopped','padStart','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','live','reject','warning','RSA-OAEP','/:bot/history','login','getMinutes','login\x20token\x20generated','|@|','5416037SoKcOQ','private','get','telegramChatId','isValid','\x1b[35m','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','connection','-results.json','Restoring\x20bot(s)\x20from\x20backup','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','assign','\x20minutes','remoteAddress','login2fa_reject_','login\x20required','accept','apiKey','get-portfolio','name','ETH','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','f2aRequired','disable','Deleted\x20Bot\x20','\x20to\x20','telegramEvents','pidRefreshToken','readdirSync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','error',')\x20|\x20Bot\x20','botmanager',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','inherit','toggleBotMode','sign','/upload-backup','existsSync','allow','clients','Markdown','slice','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','257274UaCKue','All','reason','telegrammsg','init','toIPv4Address','alerts','toString','success','access','update-bot','_data','argv','SIGINT','marketcapApi','stop','#RES#','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','2BOoHYQ','store','15\x20min','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',',\x20must\x20be\x20a\x204\x20digit\x20number','clientip','log','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Starting\x20#RED#Balance\x20Bot\x20v','Idling\x20(','join','::ffff:127.0.0.1','\x1b[34m','password','backup','from','started','event','metrics','telegram2FaApproval','.zip','status\x20code\x20401','ipv6','tkn','/download/:type','-config.json','2213109HwcGTD','conn','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','auth','config/','You\x20can\x20use\x20the\x20following\x20commands:\x0a','version','new-disabled','apiPassword','6b67f3d61ee94b8f5c80b4affef4c4d9','versions','getStartingBalances','temporary\x20access\x20not\x20allowed','handshake','sortBy','emit','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','telegramUsername','writeFileSync','Login\x20accepted','store-configuration','logs','express','text','headless','show-config','Allow\x20login\x20from\x20IP\x20address\x20','alias','File\x20uploaded','portfolio','number','config_alerts','filter','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','telegramToken','\x1b[36m','Access\x20enabled\x20for\x20','lastmsgtelegram','full','reinstall-bb','encryptedUuid','reinstall_yes',':\x20Bot\x20Mgr\x20>\x20','\x20>\x20','Setting\x20access:\x20','getPortfolio','readFileSync','pidExpireLogin','botname','::1','settings.','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','split','hasOwnProperty','Enabled\x20Bot\x20','logged\x20out','whitelistEnabled','lastmsgemitted','initclient','all','bot-','HTML','port','family','bots','backupfile','sort','************','emitHistory','headers','socket','cloneDeep','address\x20already\x20in\x20use','Invalid\x20authentication\x20token\x20(1)','bbUsername','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','getMonth','search','removeAllListeners','callback','value','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20update\x20bot','lowdb/adapters/FileSync','21ryyjAq','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','message','/:bot','\x1b[31m','sendMetricsTelegram','Bot\x20Mgr\x20>\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','static','decrypt','store-headless','-----------------------------------------------------------------------------------','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Temporary\x20access\x20rejected','write','Node.js\x20v','backup-full.zip','-events.json','\x20-\x20','onepagemode','reset-password','whitelist','cancel-loading','sendPortfolioTelegram','index.html','reply','config_all','download','isDirectory','exit','(((.+)+)+)+$','defaults','title','Unauthorized\x20attempt\x20to\x20get\x20messages','version.json','Yes','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','createServer','environment','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','127.0.0.1','resetpw_yes','mkdirSync','debug','backup/','access\x20timeout','30\x20min','file','bb/','forEach','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','get-messages','/disable\x20-\x20disable\x20notifications\x0a','toIPv4MappedAddress','auto','SIGTERM','***','kill','secret','find','disconnect','24NctdAi','api-eu.mixpanel.com','Alerts','yes','mode','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Notifications\x20enabled','<b>Telegram\x20Bot\x20Status:</b>\x0a','button','get-starting-balances','files','=>\x20Go\x20to\x20#CYA#http://','notification','login\x20not\x20required','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','-performance.json','copyFileSync','Server','username','update-bb','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','replace','tempaccess_15_','421448wCWIbw','temporary\x20token\x20generated','enable','(staging)','No\x20bots\x20running\x20right\x20now','restore-backup-file','set','params','string','restart_','login2fa_','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','output-000.log','names','disabled','User\x20has\x20been\x20validated','/off\x20-\x20stop\x20bot(s)\x0a','add-bot','binary','place-order','getHours','config','toggle','orders','\x20(1)','simple','crypto','timeshift','getUTCHours','connected','env','25510UIFIxH','telegramIpApproval','output-001.log','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','bcryptjs','toggle-bot-mode','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','2FA\x20login\x20rejected','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','tempaccess_reject_','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','bbvNew','Session\x20expired\x20for\x20user\x20...','keys','statSync','manual','build','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','getDate','Error\x20while\x20deleting\x20config\x20files:\x20','reload','#RES#\x20if\x20running\x20on\x20server','type','publicKey','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','kind','2FA','timestamp','logout','botID','tempaccess_5_','util','resetpw_no','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','expiry','enabled','getTime','DEFLATE','temporaryAccessAllowed','10025330YdxTKc','socket.io','resetHistory','verify','/help\x20-\x20show\x20available\x20commands\x0a','messages','Unauthorized\x20attempt\x20to\x20add\x20bot','action','sockets','output-003.log','privateKey','uncaughtException','/names\x20-\x20show\x20bot\x20names\x0a','graphql-request','send','updatebotmanager','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Crypt','All\x20bots','Telegram\x20error:','test','blacklist','createWriteStream','Error:\x20Invalid\x20argument\x20','restart','/status\x20-\x20show\x20bot(s)\x20status\x0a','secure','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','toggle_','Invalid\x20authentication\x20token\x20(2)','Orders','telegramEnabled','Notifications\x20disabled','update','unlinkSync','randomBytes','getFullYear','exchange','chat','Unauthorized\x20attempt\x20to\x20download\x20','Telegraf\x20error:','express-fileupload','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','startsWith','Bot\x20','zip/','/start','status','request','backup-full@','tempaccess_30_','sendMessage','Restarting\x20Bot\x20','settings','store-fiat','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','output-002.log','NTBA_FIX_319','restore_no_','show','generate','mixpanel','[ip-address]','<b>Balance\x20Bot\x20Status:</b>\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','*$1*',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','5\x20min','latestversion','Backup\x20file\x20uploaded','getSeconds','metrics_','loginRequired','node-zip','Ok,\x20will\x20send\x20order\x20notifications\x20only','once','new','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20confirm\x20message','exec','3000','any','entries','update_no','/:bot/configuration','bbPassword','bbvReceive','format','node','2832333icrQzP','Notifications\x20types:\x20','\x20|\x20user:\x20...','hex','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','\x20only\x0a','RSA','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Invalid\x20IP\x20address','catch','/on\x20-\x20start\x20bot(s)\x0a','1000','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','push','Password\x20has\x20been\x20reset\x20to:\x20','use','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','bb-settings.json','0.0.0','logs/','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','placeOrder','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','command','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','bot','temporary\x20access\x20rejected','add','function','referer','Unauthorized\x20login\x20attempt\x20(timeout)','length','uuid','address','reinstall_no','uuid-random','post','user','track','close','backup-files','match','https://api.ipify.org?format=json','Failed\x20to\x20download\x20','parse','userid','Starting\x20Balance\x20Bot\x20update','temp/','off_','remove','http','endsWith','backup-full','Invalid\x20username\x20or\x20IP\x20address','build2','Unauthorized\x20attempt\x20to\x20show\x20configuration','hybrid-crypto-js','isIPv4MappedAddress','running','2FA\x20login\x20token\x20generated','/:bot/performance','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','bb-secure.json','token','editMessageReplyMarkup','Unauthorized\x20attempt\x20to\x20get\x20portfolio','storeFiat','Unauthorized\x20attempt\x20to\x20log\x20out','hashSync','generateKeyPairAsync','Restore\x20backup\x20file\x20','jsonwebtoken','Starting\x20('];_0x3ec1=function(){return _0x4fe079;};return _0x3ec1();}dbConfig[_0x447343(0x2b7)]({'bots':[]})[_0x447343(0x2a6)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x447343(0x2b7)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x447343(0x199),'onepagemode':![],'marketcapApi':''}})[_0x447343(0x2a6)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x447343(0x2a6)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x447343(0x1e5)});const saltRounds=0xa,mixpanel=Mixpanel[_0x447343(0x21c)](_0x447343(0x24d),{'host':_0x447343(0x2d6)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x447343(0x266)]&&(settings[_0x447343(0x266)]!=''&&settings[_0x447343(0x266)]!='***')&&settings[_0x447343(0x255)]&&settings[_0x447343(0x255)]!='')initTelegram();const parseColor=(_0x3df07d,_0x570db9)=>{const _0xe5ce02=_0x447343,_0x52ad1d=/#[A-Z]{3}#/g;if(typeof _0x3df07d==_0xe5ce02(0x2f5)){!_0x570db9?_0x3df07d=_0x3df07d[_0xe5ce02(0x2eb)](_0x52ad1d,''):(_0x3df07d=_0x3df07d['replace'](/#BLU#/g,_0xe5ce02(0x236)),_0x3df07d=_0x3df07d[_0xe5ce02(0x2eb)](/#RED#/g,_0xe5ce02(0x29c)),_0x3df07d=_0x3df07d[_0xe5ce02(0x2eb)](/#YEL#/g,'\x1b[33m'),_0x3df07d=_0x3df07d[_0xe5ce02(0x2eb)](/#MAG#/g,_0xe5ce02(0x1f0)),_0x3df07d=_0x3df07d[_0xe5ce02(0x2eb)](/#CYA#/g,_0xe5ce02(0x267)),_0x3df07d=_0x3df07d[_0xe5ce02(0x2eb)](/#RES#/g,'\x1b[0m'));;}return _0x3df07d;},logger={'screen':_0x552190=>{const _0x44feda=_0x447343;console[_0x44feda(0x230)](parseColor(_0x552190,!![]));},'simple':_0x3649e4=>{const _0x2acb07=_0x447343;console[_0x2acb07(0x230)](parseColor(_0x3649e4,!![])),loggerfile['write'](util['format'](parseColor(_0x3649e4,![]))+'\x0a');},'full':async _0x130da5=>{const _0x31fee2=_0x447343,_0x3f97d4=getTimeStamp()+_0x31fee2(0x26e)+_0x130da5;console[_0x31fee2(0x230)](parseColor(_0x3f97d4,!![])),loggerfile[_0x31fee2(0x2a6)](util[_0x31fee2(0x185)](parseColor(_0x3f97d4,![]))+'\x0a');if(tgBot&&settings[_0x31fee2(0x1ee)]&&settings[_0x31fee2(0x205)]!=_0x31fee2(0xfe))await sendTelegram(settings[_0x31fee2(0x1ee)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x130da5,![]));},'debug':async(_0x50e5a8,_0xde1193='')=>{const _0x59fbc4=_0x447343,_0x535ba6=getTimeStamp()+_0x59fbc4(0x170)+_0x50e5a8;if(debugging)console[_0x59fbc4(0x230)](parseColor(_0x535ba6,!![]));loggerfile[_0x59fbc4(0x2a6)](util[_0x59fbc4(0x185)](parseColor(_0x535ba6,![]))+'\x0a');if(_0xde1193){if(debugging)console[_0x59fbc4(0x230)](_0xde1193);loggerfile[_0x59fbc4(0x2a6)](util[_0x59fbc4(0x185)](_0xde1193)+'\x0a');}}};let terminating=![];process['on'](_0x447343(0x139),function(_0x271b9b){const _0x27f4fe=_0x447343;_0x271b9b[_0x27f4fe(0x21f)]()['includes'](_0x27f4fe(0x28c))?(logger[_0x27f4fe(0x100)](_0x27f4fe(0x231)+_0x271b9b['port']+_0x27f4fe(0x228)),process[_0x27f4fe(0x13c)]({'terminate':!![]},_0x59fb31=>{})):logger['simple'](_0x271b9b);}),process['on'](_0x447343(0x2b5),()=>{const _0xf95b98=_0x447343;stopAllBots(),process[_0xf95b98(0x2b5)](0x0);}),process['on'](_0x447343(0x2cf),()=>{const _0x21d89c=_0x447343;stopAllBots(),process[_0x21d89c(0x2b5)](0x0);}),process['on'](_0x447343(0x225),()=>{const _0x4ec14f=_0x447343;stopAllBots(),process[_0x4ec14f(0x2b5)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x447343(0x2ba))[_0x447343(0x24a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x447343(0x25a)),app=express(),http=require(_0x447343(0x1b9))[_0x447343(0x2bd)](app);app[_0x447343(0x196)](fileUpload({'useTempFiles':!![]})),app[_0x447343(0x1ed)](_0x447343(0x242),async(_0x33795b,_0x3443f6)=>{const _0x1093a6=_0x447343,_0x1626a5=_0x33795b[_0x1093a6(0x2f4)]['type'],_0x7c7b6=getClientsWithBotID(_0x1093a6(0x20b)),_0x4b1cd3=_0x33795b[_0x1093a6(0x289)][_0x1093a6(0x1a7)],_0x329bf3=timelyDecrypt(_0x4b1cd3,![]),_0x419e17=_0x7c7b6[_0x1093a6(0x2d3)](_0x1d290a=>_0x1d290a[_0x1093a6(0x1a7)]==_0x329bf3);if(_0x419e17){const _0xcd3f07=normalizeIP(_0x33795b[_0x1093a6(0x28a)][_0x1093a6(0x1f8)])[_0x1093a6(0x22b)],_0x3f5312=_0x33795b[_0x1093a6(0x289)][_0x1093a6(0x241)];if(validateAccess(_0x3f5312,_0x329bf3,_0xcd3f07)['allow'])_0x1626a5=='backup'&&await backupConfigFiles(),await zipFiles(_0x1626a5),_0x3443f6[_0x1093a6(0x2b3)](zippath+(_0x1626a5+_0x1093a6(0x23e)),_0x12414f=>{const _0x55ea74=_0x1093a6;_0x12414f&&(logger[_0x55ea74(0x26a)](_0x55ea74(0x1b2)+_0x1626a5),logger[_0x55ea74(0x100)](_0x12414f));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1626a5+_0x1093a6(0xff));}else logger[_0x1093a6(0x26a)](_0x1093a6(0x155)+_0x1626a5+_0x1093a6(0x1d5));}),app[_0x447343(0x1ab)](_0x447343(0x211),async(_0x14890c,_0x598495)=>{const _0x9fc0db=_0x447343,_0xfdd29f=getClientsWithBotID('botmanager'),_0x3ae188=_0x14890c[_0x9fc0db(0x289)][_0x9fc0db(0x1a7)],_0x5e2fdf=timelyDecrypt(_0x3ae188,![]),_0x525bf0=_0xfdd29f['find'](_0x43b51c=>_0x43b51c['uuid']==_0x5e2fdf);logger[_0x9fc0db(0x2c3)](_0x9fc0db(0x173));if(_0x525bf0){const _0xd88101=normalizeIP(_0x14890c['socket']['remoteAddress'])[_0x9fc0db(0x22b)],_0x56e232=_0x14890c[_0x9fc0db(0x289)][_0x9fc0db(0x241)];if(validateAccess(_0x56e232,_0x5e2fdf,_0xd88101)[_0x9fc0db(0x213)]){if(_0x14890c['files']){const _0x3750fb=_0x14890c[_0x9fc0db(0x2e0)][_0x9fc0db(0x285)];await _0x3750fb['mv'](temppath+_0x3750fb['name']),_0x598495[_0x9fc0db(0x13c)]({'status':!![],'message':_0x9fc0db(0x260)});const _0x2a8320=getBotsWithMode();_0x2a8320[_0x9fc0db(0x1a6)]>0x0?confirmRestore(temppath,_0x3750fb[_0x9fc0db(0x1fe)]):unzipFile(temppath,_0x3750fb[_0x9fc0db(0x1fe)]);}}else logger[_0x9fc0db(0x26a)](_0x9fc0db(0x18e));}else logger[_0x9fc0db(0x26a)](_0x9fc0db(0x128));}),app[_0x447343(0x196)](express['static'](path['join'](__dirname,bbpath2,'build2'))),app['use'](express[_0x447343(0x2a0)](path[_0x447343(0x234)](__dirname,bbpath2,_0x447343(0x116)))),app['get']('/',function(_0x1a2a38,_0x3de8b3){const _0x187a5e=_0x447343;_0x3de8b3['sendFile'](path['join'](__dirname,bbpath2,_0x187a5e(0x1bd),_0x187a5e(0x2b0)));}),app[_0x447343(0x1ed)](_0x447343(0x29b),function(_0x2a19d0,_0x17a125){const _0x55d153=_0x447343;_0x17a125[_0x55d153(0x1d3)](path[_0x55d153(0x234)](__dirname,bbpath2,_0x55d153(0x116),'index.html'));}),app[_0x447343(0x1ed)]('/:bot/portfolio',(_0x314f7b,_0x7c5eac)=>{const _0xfa065c=_0x447343;_0x7c5eac[_0xfa065c(0x1d3)](path[_0xfa065c(0x234)](__dirname,bbpath2,'build',_0xfa065c(0x2b0)));}),app[_0x447343(0x1ed)](_0x447343(0x1c3),(_0x249901,_0x445025)=>{const _0x8d0fb4=_0x447343;_0x445025[_0x8d0fb4(0x1d3)](path[_0x8d0fb4(0x234)](__dirname,bbpath2,'build',_0x8d0fb4(0x2b0)));}),app[_0x447343(0x1ed)]('/:bot/coins',(_0x2e048f,_0x27f4dd)=>{const _0x18375c=_0x447343;_0x27f4dd[_0x18375c(0x1d3)](path['join'](__dirname,bbpath2,_0x18375c(0x116),_0x18375c(0x2b0)));}),app[_0x447343(0x1ed)](_0x447343(0x1e6),(_0x5beb72,_0x2a6596)=>{const _0x175f04=_0x447343;_0x2a6596['sendFile'](path['join'](__dirname,bbpath2,_0x175f04(0x116),_0x175f04(0x2b0)));}),app['get'](_0x447343(0x182),(_0x59b00b,_0x6e5582)=>{const _0x4fe2e4=_0x447343;_0x6e5582['sendFile'](path[_0x4fe2e4(0x234)](__dirname,bbpath2,'build',_0x4fe2e4(0x2b0)));}),app[_0x447343(0x1ed)]('/:bot/support',(_0x587cd3,_0x125ed7)=>{const _0x2b87b4=_0x447343;_0x125ed7[_0x2b87b4(0x1d3)](path[_0x2b87b4(0x234)](__dirname,bbpath2,_0x2b87b4(0x116),_0x2b87b4(0x2b0)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x447343(0x12f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4e235e=_0x447343;let _0x58dce0=_0x4e235e(0x16c);const _0xc2c550=networkInterfaces(),_0x1a9000={};for(const _0x18a09d of Object[_0x4e235e(0x113)](_0xc2c550)){for(const _0x5e5e15 of _0xc2c550[_0x18a09d]){if((_0x5e5e15['family']=='IPv4'||_0x5e5e15[_0x4e235e(0x283)]==0x4)&&!_0x5e5e15['internal']){const _0x49123c=ipaddr[_0x4e235e(0x1b3)](_0x5e5e15[_0x4e235e(0x1a8)])['range']();_0x49123c!=_0x4e235e(0x1ec)&&(!_0x1a9000[_0x18a09d]&&(_0x1a9000[_0x18a09d]=[]),_0x1a9000[_0x18a09d][_0x4e235e(0x194)](_0x5e5e15[_0x4e235e(0x1a8)]),_0x58dce0=_0x5e5e15[_0x4e235e(0x1a8)]);}}}return{'serverip':_0x58dce0,'netinterfaces':_0x1a9000};}async function startServer(){const _0x16a2e4=_0x447343,{serverip:_0x49222a,netinterfaces:_0x15feba}=getServerIP();logger[_0x16a2e4(0x100)](''),logger[_0x16a2e4(0x100)]('-----------------------------------------------------------------------------------'),await logger[_0x16a2e4(0x26a)](_0x16a2e4(0x232)+serverversion+'#RES#\x20'+(environment=='staging'?_0x16a2e4(0x2f0):'')+'\x0a'+(_0x16a2e4(0x2da)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x16a2e4(0x2e1)+_0x49222a+':'+PORT+_0x16a2e4(0x11b))),logger[_0x16a2e4(0x100)](_0x16a2e4(0x2a3));if(config[_0x16a2e4(0x1a6)]!=0x0)for(const _0x39d0c6 of config){const _0x3e2f3b=_0x39d0c6[_0x16a2e4(0x2d9)]==_0x16a2e4(0x2ce)?'a':'m';if(_0x39d0c6[_0x16a2e4(0x15d)]==_0x16a2e4(0x12a)||_0x39d0c6[_0x16a2e4(0x15d)]==_0x16a2e4(0x17a))await logger[_0x16a2e4(0x26a)](_0x16a2e4(0x1cf)+_0x3e2f3b+_0x16a2e4(0x20a)+_0x39d0c6[_0x16a2e4(0x124)]+_0x16a2e4(0x1de)+_0x39d0c6[_0x16a2e4(0x274)]),startBot([_0x39d0c6[_0x16a2e4(0x124)],userID],{'cwd':bbpath},function(_0x408045){const _0x4fe1fa=_0x16a2e4;if(_0x408045)logger[_0x4fe1fa(0x26a)](_0x408045);});else(_0x39d0c6[_0x16a2e4(0x15d)]==_0x16a2e4(0xf5)||_0x39d0c6[_0x16a2e4(0x15d)]==_0x16a2e4(0x24b))&&await logger[_0x16a2e4(0x26a)](_0x16a2e4(0x233)+_0x3e2f3b+')\x20\x20\x20|\x20Bot\x20'+_0x39d0c6[_0x16a2e4(0x124)]+_0x16a2e4(0x1de)+_0x39d0c6[_0x16a2e4(0x274)]);}else!newBot&&logger[_0x16a2e4(0x100)](_0x16a2e4(0x1f5));if(newBot)addBot();logger[_0x16a2e4(0x100)](_0x16a2e4(0x2a3)),logger['simple'](''),await logger['debug'](_0x16a2e4(0x2a7)+nodeversion),await logger[_0x16a2e4(0x2c3)]('Network\x20Interfaces:',_0x15feba);}function startSocket(){const _0x935da7=_0x447343;io['on'](_0x935da7(0x1f2),_0x5c2399=>{const _0x5815f5=_0x935da7;let _0x7c5777,_0x13661f,_0x59718c,_0xa89bca,_0x35a068;const _0x2d072d=_0x5c2399[_0x5815f5(0x251)][_0x5815f5(0x289)][_0x5815f5(0x1a4)];_0x13661f=_0x2d072d[_0x5815f5(0x1b0)](/bot[0-9]{3}/);if(_0x13661f)_0x59718c=_0x13661f[0x0][_0x5815f5(0x1b0)](/[0-9]{3}/);if(_0x59718c)_0x7c5777=_0x59718c[0x0];else _0x7c5777=_0x5815f5(0x20b);const _0x4a3ebd=_0x5c2399[_0x5815f5(0x251)][_0x5815f5(0x247)][_0x5815f5(0x26c)];if(!_0x4a3ebd)_0x5c2399[_0x5815f5(0x253)](_0x5815f5(0x15d),{'publicKey':secure[_0x5815f5(0x11d)]});else{_0xa89bca=timelyDecrypt(_0x4a3ebd,![]);if(!_0xa89bca)_0x5c2399[_0x5815f5(0x253)](_0x5815f5(0x15d),{'publicKey':secure[_0x5815f5(0x11d)]});else{_0x35a068=normalizeIP(_0x5c2399[_0x5815f5(0x245)][_0x5815f5(0x1f8)])[_0x5815f5(0x22b)];if(!devices[_0xa89bca])devices[_0xa89bca]={'uuid':_0xa89bca,'access':{'token':null}};devices[_0xa89bca]['ip']=_0x35a068;const _0x260315=addClient(_0x5c2399['id'],_0xa89bca,_0x7c5777);setAccess(_0x260315),emitMessages(),_0x5c2399['on'](_0x5815f5(0x1e7),_0x39577d=>{const _0x2b0a51=_0x5815f5,_0x6494a4=timelyDecrypt(_0x39577d[_0x2b0a51(0x237)]);if(_0x6494a4){_0x39577d={'username':_0x39577d[_0x2b0a51(0x2e8)],'password':_0x6494a4},devices[_0xa89bca][_0x2b0a51(0x221)]=validateCredentials(_0x39577d,_0xa89bca);if(devices[_0xa89bca][_0x2b0a51(0x221)][_0x2b0a51(0x213)]==![]&&devices[_0xa89bca][_0x2b0a51(0x221)][_0x2b0a51(0x21a)]==_0x2b0a51(0x17b))_0x5c2399[_0x2b0a51(0x253)]('status',{'access':devices[_0xa89bca][_0x2b0a51(0x221)]}),loginAccess2FA(_0xa89bca,_0x35a068);else{if(devices[_0xa89bca][_0x2b0a51(0x221)][_0x2b0a51(0x213)]==![]&&devices[_0xa89bca][_0x2b0a51(0x221)]['reason']=='invalid\x20credentials')_0x5c2399[_0x2b0a51(0x253)]('status',{'access':devices[_0xa89bca][_0x2b0a51(0x221)]});else devices[_0xa89bca][_0x2b0a51(0x221)][_0x2b0a51(0x213)]&&devices[_0xa89bca][_0x2b0a51(0x221)][_0x2b0a51(0x21a)]==_0x2b0a51(0x1e9)&&(getClientsWithUuid(_0xa89bca)[_0x2b0a51(0x2c9)](_0x4862a8=>{setAccess(_0x4862a8);}),logger[_0x2b0a51(0x2c3)]('Logged\x20in\x20user\x20...'+_0xa89bca[_0x2b0a51(0x216)](-0x8)),setTokenRefresh(_0xa89bca),setSessionTimeout(_0x2b0a51(0x1e7),_0xa89bca));}}else logger[_0x2b0a51(0x26a)](_0x2b0a51(0x1a5));}),_0x5c2399['on'](_0x5815f5(0x2ac),()=>{resetPassword();}),_0x5c2399['on'](_0x5815f5(0x2d4),_0x50fc54=>{removeClient(_0x5c2399['id']);}),_0x7c5777=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1d52fd){const _0x24c515=_0x447343;if(_0x1d52fd!='botmanager'&&config[_0x24c515(0x1fc)]!=''){if(pid[_0x1d52fd])pid[_0x1d52fd][_0x24c515(0x13c)]({'function':_0x24c515(0x27e),'args':null});}_0x1d52fd!=_0x24c515(0x20b)&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x5def0f=_0x447343;getClientsWithBotID(_0x5def0f(0x20b))['forEach'](_0x114ac2=>{const _0x56b623=_0x5def0f;getSocket(_0x114ac2['id'])[_0x56b623(0x253)](_0x56b623(0x15d),{'access':{'allow':![],'reason':_0x56b623(0x11a),'token':null}});});}function getSocket(_0x298ea6){const _0x3b66b3=_0x447343;return io[_0x3b66b3(0x136)][_0x3b66b3(0x136)][_0x3b66b3(0x1ed)](_0x298ea6);}function setAccess(_0x3f2913){const _0x489aba=_0x447343,_0x3f15f0=getSocket(_0x3f2913['id']),_0x4ff240=_0x3f2913['uuid'],_0x2be4f9=_0x3f2913[_0x489aba(0x1a0)];devices[_0x4ff240][_0x489aba(0x221)]=validateAccess(devices[_0x4ff240]['access']['token'],_0x4ff240),logger['debug'](_0x489aba(0x270)+devices[_0x4ff240]['access'][_0x489aba(0x21a)]+'\x20|\x20client:\x20...'+_0x3f2913['id'][_0x489aba(0x216)](-0x8)+_0x489aba(0x189)+_0x4ff240['slice'](-0x8)),_0x3f15f0[_0x489aba(0x234)](_0x4ff240);if(devices[_0x4ff240][_0x489aba(0x221)][_0x489aba(0x213)]){_0x3f15f0['join'](_0x2be4f9);if(_0x2be4f9==_0x489aba(0x20b))initializeSocketBotManager(_0x3f15f0);else initializeSocketBot(_0x3f15f0);initClient(_0x2be4f9);}devices[_0x4ff240][_0x489aba(0x221)][_0x489aba(0x1c6)]&&devices[_0x4ff240][_0x489aba(0x221)]['reason']==_0x489aba(0x2ee)&&setSessionTimeout(_0x489aba(0x121),_0x4ff240),devices[_0x4ff240][_0x489aba(0x221)]['token']&&devices[_0x4ff240][_0x489aba(0x221)][_0x489aba(0x21a)]==_0x489aba(0x1c2)&&setSessionTimeout(_0x489aba(0x1e7),_0x4ff240),_0x3f15f0[_0x489aba(0x253)](_0x489aba(0x15d),{'status':_0x3f2913['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4ff240]['access'],'externalip':devices[_0x4ff240]['ip'],'publicKey':secure[_0x489aba(0x11d)],'userid':settings[_0x489aba(0x1b4)],'validInstallation':validInstallation}),devices[_0x4ff240][_0x489aba(0x221)]['allow']==![]&&devices[_0x4ff240]['access'][_0x489aba(0x21a)]==_0x489aba(0x1d4)&&temporaryAccess2FA(_0x4ff240,devices[_0x4ff240]['ip']);}function setSessionTimeout(_0x174547,_0x57e14f){const _0x20be3d=_0x447343;let _0x11ab2a;if(_0x174547==_0x20be3d(0x1e7))_0x11ab2a=loginExpiry*0x3c*0x3e8;else _0x11ab2a=devices[_0x57e14f][_0x20be3d(0x107)][_0x20be3d(0x129)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x57e14f]['telegramIpApproval']['timestamp']);if(devices[_0x57e14f][_0x20be3d(0x273)])clearTimeout(devices[_0x57e14f][_0x20be3d(0x273)]);devices[_0x57e14f][_0x20be3d(0x273)]=setTimeout(()=>{const _0x3ae496=_0x20be3d;if(devices[_0x57e14f]['pidRefreshToken'])clearTimeout(devices[_0x57e14f]['pidRefreshToken']);removeSocketListeners(_0x57e14f),addBlacklist(_0x57e14f),devices[_0x57e14f]['telegramIpApproval']=null,devices[_0x57e14f][_0x3ae496(0x23d)]=null,devices[_0x57e14f]['access']['token']=null,logger[_0x3ae496(0x2c3)](_0x3ae496(0x112)+_0x57e14f[_0x3ae496(0x216)](-0x8)),devices[_0x57e14f][_0x3ae496(0x221)]=validateAccess(devices[_0x57e14f][_0x3ae496(0x221)]['token'],_0x57e14f),!(devices[_0x57e14f]['access'][_0x3ae496(0x213)]&&devices[_0x57e14f][_0x3ae496(0x221)][_0x3ae496(0x21a)]=='login\x20not\x20required')&&(_0x174547=='login'?io['to'](_0x57e14f)[_0x3ae496(0x253)](_0x3ae496(0x15d),{'access':{'allow':![],'reason':_0x3ae496(0x2c5),'token':null}}):io['to'](_0x57e14f)[_0x3ae496(0x253)](_0x3ae496(0x15d),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x57e14f][_0x3ae496(0x221)]['token']=null;},_0x11ab2a);}function setTokenRefresh(_0x5294f7){const _0x4e2a51=_0x447343;if(devices[_0x5294f7][_0x4e2a51(0x206)])clearTimeout(devices[_0x5294f7]['pidRefreshToken']);devices[_0x5294f7][_0x4e2a51(0x206)]=setTimeout(()=>{const _0x22d183=_0x4e2a51;getClientsWithUuid(_0x5294f7)[_0x22d183(0x1a6)]!=0x0?(devices[_0x5294f7][_0x22d183(0x221)]=refreshToken(_0x5294f7),io['to'](_0x5294f7)[_0x22d183(0x253)]('status',{'status':_0x22d183(0x104),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5294f7][_0x22d183(0x221)],'externalip':devices[_0x5294f7]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x5294f7)):clearTimeout(devices[_0x5294f7][_0x22d183(0x206)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xd92db9){const _0x374be9=_0x447343,_0x69ae24=getClient(_0xd92db9['id'])[_0x374be9(0x1a7)];_0xd92db9[_0x374be9(0x253)](_0x374be9(0x284),config),_0xd92db9[_0x374be9(0x253)]('settings',cleanSettings()),_0xd92db9['on'](_0x374be9(0xf8),_0x329dd3=>{const _0x5ee736=_0x374be9;if(validateAccess(_0x329dd3,_0x69ae24)[_0x5ee736(0x213)])addBot();else logger[_0x5ee736(0x26a)](_0x5ee736(0x134));}),_0xd92db9['on'](_0x374be9(0x222),(_0x335d04,_0x3a778a)=>{const _0x20d7ea=_0x374be9;if(validateAccess(_0x3a778a,_0x69ae24)['allow'])toggleBot(_0x335d04[_0x20d7ea(0x124)],_0x335d04['status'],_0x335d04[_0x20d7ea(0x1e2)]);else logger[_0x20d7ea(0x26a)](_0x20d7ea(0x296));}),_0xd92db9['on'](_0x374be9(0x10b),(_0xbdc5c0,_0x2b9bf9)=>{const _0x2c97f3=_0x374be9;if(validateAccess(_0x2b9bf9,_0x69ae24)[_0x2c97f3(0x213)])toggleBotMode(_0xbdc5c0);else logger[_0x2c97f3(0x26a)](_0x2c97f3(0x296));}),_0xd92db9['on']('delete-bot',(_0x4803c8,_0x1fcca5)=>{const _0x2cfd44=_0x374be9;if(validateAccess(_0x1fcca5,_0x69ae24)['allow'])deleteBot(_0x4803c8);else logger[_0x2cfd44(0x26a)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0xd92db9['on']('store-settings',(_0x4d3c62,_0x1b7730)=>{const _0x4020d5=_0x374be9;if(validateAccess(_0x1b7730,_0x69ae24)[_0x4020d5(0x213)])storeSettings(_0x4d3c62,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0xd92db9['on'](_0x374be9(0x2e9),_0x54d434=>{const _0x3b3397=_0x374be9;if(validateAccess(_0x54d434,_0x69ae24)[_0x3b3397(0x213)])updateBB(_0x3b3397(0x14f));else logger[_0x3b3397(0x26a)](_0x3b3397(0x158));}),_0xd92db9['on'](_0x374be9(0x26b),_0x131d3e=>{const _0x493a65=_0x374be9;if(validateAccess(_0x131d3e,_0x69ae24)['allow'])updateBB(_0x493a65(0x1d2));else logger[_0x493a65(0x26a)](_0x493a65(0x217));}),_0xd92db9['on']('get-backup-files',_0x30377e=>{const _0x373830=_0x374be9;if(validateAccess(_0x30377e,_0x69ae24)[_0x373830(0x213)]){const _0x2f7418=getClient(_0xd92db9['id']);if(_0x2f7418)getBackupFiles(_0x2f7418['uuid']);else logger[_0x373830(0x26a)](_0x373830(0x29f));}else logger[_0x373830(0x26a)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0xd92db9['on'](_0x374be9(0x2f2),(_0x57d9ec,_0x587617)=>{const _0x1baeb0=_0x374be9;if(validateAccess(_0x587617,_0x69ae24)[_0x1baeb0(0x213)])restoreBackupFile(_0x57d9ec);else logger[_0x1baeb0(0x26a)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0xd92db9['on'](_0x374be9(0x2cb),_0x2c9431=>{const _0x417a44=_0x374be9;if(validateAccess(_0x2c9431,_0x69ae24)[_0x417a44(0x213)])getMessages();else logger['full'](_0x417a44(0x2b9));}),_0xd92db9['on']('confirm-message',(_0x44fcc7,_0x565bd9)=>{const _0x47dc8b=_0x374be9;if(validateAccess(_0x565bd9,_0x69ae24)[_0x47dc8b(0x213)])confirmMessage(_0x44fcc7);else logger[_0x47dc8b(0x26a)](_0x47dc8b(0x17c));}),_0xd92db9['on']('logout',_0x10d474=>{const _0xed5f49=_0x374be9;if(validateAccess(_0x10d474,_0x69ae24)[_0xed5f49(0x213)]){if(devices[_0x69ae24][_0xed5f49(0x206)])clearTimeout(devices[_0x69ae24]['pidRefreshToken']);if(devices[_0x69ae24][_0xed5f49(0x273)])clearTimeout(devices[_0x69ae24]['pidExpireLogin']);removeSocketListeners(getClient(_0xd92db9['id'])[_0xed5f49(0x1a7)]),addBlacklist(_0x69ae24),devices[_0x69ae24][_0xed5f49(0x107)]=null,devices[_0x69ae24][_0xed5f49(0x23d)]=null,devices[_0x69ae24][_0xed5f49(0x221)][_0xed5f49(0x1c6)]=null,logger[_0xed5f49(0x2c3)]('Logged\x20out\x20user\x20...'+_0x69ae24[_0xed5f49(0x216)](-0x8)),io['to'](getClient(_0xd92db9['id'])[_0xed5f49(0x1a7)])['emit']('status',{'access':{'allow':![],'reason':_0xed5f49(0x27b),'token':null}});}else logger[_0xed5f49(0x26a)](_0xed5f49(0x1ca));});}function initializeSocketBot(_0x3dc730){const _0x230671=_0x447343,_0x175dad=getClient(_0x3dc730['id'])[_0x230671(0x1a0)],_0x14c082=getClient(_0x3dc730['id'])[_0x230671(0x1a7)];_0x3dc730['on']('get-logs',(_0x4756fd,_0x2994b0)=>{const _0x571181=_0x230671;if(validateAccess(_0x2994b0,_0x14c082)[_0x571181(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x571181(0x13c)]({'function':_0x571181(0x288),'args':_0x4756fd});}else logger[_0x571181(0x26a)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x3dc730['on']('delete-alerts',(_0x377137,_0x41aac7)=>{const _0x1c8aea=_0x230671;if(validateAccess(_0x41aac7,_0x14c082)[_0x1c8aea(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x1c8aea(0x13c)]({'function':'deleteHistoryAlerts','args':_0x377137});}else logger[_0x1c8aea(0x26a)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x3dc730['on'](_0x230671(0x1fd),(_0x140452,_0x1a956d)=>{const _0x594176=_0x230671;if(validateAccess(_0x1a956d,_0x14c082)[_0x594176(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x594176(0x13c)]({'function':_0x594176(0x271),'args':_0x140452});}else logger[_0x594176(0x26a)](_0x594176(0x1c8));}),_0x3dc730['on'](_0x230671(0x258),(_0x26e380,_0x526549)=>{const _0x2be800=_0x230671;if(validateAccess(_0x526549,_0x14c082)[_0x2be800(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x2be800(0x13c)]({'function':'storeConfiguration','args':_0x26e380});}else logger[_0x2be800(0x26a)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x3dc730['on'](_0x230671(0x2a2),(_0x3d1f0d,_0x3e3d43)=>{const _0x184404=_0x230671;if(validateAccess(_0x3e3d43,_0x14c082)[_0x184404(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x184404(0x13c)]({'function':'storeHeadless','args':_0x3d1f0d});}else logger[_0x184404(0x26a)](_0x184404(0x246));}),_0x3dc730['on'](_0x230671(0x164),(_0x64f5c5,_0x3bb560)=>{const _0x43fe31=_0x230671;if(validateAccess(_0x3bb560,_0x14c082)['allow']){if(pid[_0x175dad])pid[_0x175dad]['send']({'function':_0x43fe31(0x1c9),'args':_0x64f5c5});}else logger[_0x43fe31(0x26a)](_0x43fe31(0x229));}),_0x3dc730['on']('reset-history',_0x532b60=>{const _0x13bcc1=_0x230671;if(validateAccess(_0x532b60,_0x14c082)[_0x13bcc1(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x13bcc1(0x13c)]({'function':_0x13bcc1(0x130),'args':null});}else logger[_0x13bcc1(0x26a)](_0x13bcc1(0x109));}),_0x3dc730['on'](_0x230671(0x2df),_0x3508d6=>{const _0x375b28=_0x230671;if(validateAccess(_0x3508d6,_0x14c082)[_0x375b28(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x375b28(0x13c)]({'function':_0x375b28(0x24f),'args':null});}else logger['full'](_0x375b28(0x19b));}),_0x3dc730['on'](_0x230671(0xfa),(_0x4f1c8f,_0x123265)=>{const _0x3e4d46=_0x230671;if(validateAccess(_0x123265,_0x14c082)[_0x3e4d46(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x3e4d46(0x13c)]({'function':_0x3e4d46(0x19c),'args':_0x4f1c8f});}else logger[_0x3e4d46(0x26a)](_0x3e4d46(0x277));}),_0x3dc730['on'](_0x230671(0x2ae),_0x202984=>{const _0x44c589=_0x230671;if(validateAccess(_0x202984,_0x14c082)[_0x44c589(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x44c589(0x13c)]({'function':'cancelLoading','args':null});}else logger[_0x44c589(0x26a)](_0x44c589(0x193));}),_0x3dc730['on'](_0x230671(0x25d),_0x3c3974=>{const _0x59a3e2=_0x230671;if(validateAccess(_0x3c3974,_0x14c082)[_0x59a3e2(0x213)]){if(pid[_0x175dad])pid[_0x175dad][_0x59a3e2(0x13c)]({'function':'showConfig','args':null});}else logger[_0x59a3e2(0x26a)](_0x59a3e2(0x1be));}),_0x3dc730['on'](_0x230671(0x2e9),_0x3078fa=>{const _0x318655=_0x230671;if(validateAccess(_0x3078fa,_0x14c082)['allow'])updateBB(_0x318655(0x14f));else logger['full'](_0x318655(0x158));}),_0x3dc730['on'](_0x230671(0x2cb),_0x3e7eb9=>{const _0x9633b3=_0x230671;if(validateAccess(_0x3e7eb9,_0x14c082)[_0x9633b3(0x213)])getMessages();else logger[_0x9633b3(0x26a)](_0x9633b3(0x2b9));}),_0x3dc730['on']('confirm-message',(_0x5322c6,_0x4b5700)=>{const _0x5a4bac=_0x230671;if(validateAccess(_0x4b5700,_0x14c082)['allow'])confirmMessage(_0x5322c6);else logger[_0x5a4bac(0x26a)](_0x5a4bac(0x17c));}),_0x3dc730['on'](_0x230671(0x123),_0x391252=>{const _0x31485e=_0x230671;if(validateAccess(_0x391252,_0x14c082)[_0x31485e(0x213)]){if(devices[_0x14c082][_0x31485e(0x206)])clearTimeout(devices[_0x14c082]['pidRefreshToken']);if(devices[_0x14c082][_0x31485e(0x273)])clearTimeout(devices[_0x14c082][_0x31485e(0x273)]);removeSocketListeners(getClient(_0x3dc730['id'])[_0x31485e(0x1a7)]),addBlacklist(_0x14c082),devices[_0x14c082][_0x31485e(0x107)]=null,devices[_0x14c082][_0x31485e(0x23d)]=null,devices[_0x14c082][_0x31485e(0x221)][_0x31485e(0x1c6)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x14c082[_0x31485e(0x216)](-0x8)),io['to'](getClient(_0x3dc730['id'])[_0x31485e(0x1a7)])[_0x31485e(0x253)](_0x31485e(0x15d),{'access':{'allow':![],'reason':_0x31485e(0x27b),'token':null}});}else logger[_0x31485e(0x26a)](_0x31485e(0x1ca));});}function removeSocketListeners(_0x3fd444){const _0x30e0c8=_0x447343;getClientsWithUuid(_0x3fd444)[_0x30e0c8(0x2c9)](_0x2fe8e6=>{const _0x36e012=_0x30e0c8;getSocket(_0x2fe8e6['id'])[_0x36e012(0x292)]();});}function cleanSettings(){const _0x593dd0=_0x447343;let _0x7ce25=settings;return settings[_0x593dd0(0x266)]&&settings[_0x593dd0(0x266)]!=''&&(_0x7ce25={..._0x7ce25,'telegramToken':_0x593dd0(0x287)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x7ce25={..._0x7ce25,'bbPassword':_0x593dd0(0x287)}),settings['marketcapApi']&&settings[_0x593dd0(0x226)]!=''&&(_0x7ce25={..._0x7ce25,'marketcapApi':_0x593dd0(0x287)}),(settings[_0x593dd0(0x183)]&&settings['bbPassword']==_0x593dd0(0x2d0)||settings['telegramToken']&&settings[_0x593dd0(0x266)]=='***'||settings['marketcapApi']&&settings['marketcapApi']=='***')&&(_0x7ce25={..._0x7ce25,'restored':{'password':settings[_0x593dd0(0x183)]==_0x593dd0(0x2d0),'telegram':settings[_0x593dd0(0x266)]==_0x593dd0(0x2d0),'marketcap':settings[_0x593dd0(0x226)]=='***'}}),_0x7ce25;}async function updateBB(_0x4c1441){const _0x33bc93=_0x447343;await backupConfigFiles(),installingUpdate=!![],config[_0x33bc93(0x2c9)](_0x3e1a6c=>{const _0x30bef2=_0x33bc93;restartBot(_0x3e1a6c[_0x30bef2(0x124)]);});if(_0x4c1441==_0x33bc93(0x14f))process[_0x33bc93(0x13c)]({'update':!![],'environment':environment},_0x21ed67=>{});else _0x4c1441=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x168a12=>{});}function startBot(_0x1f516f,_0x30c65f,_0x7c929e){const _0x1dbae4=_0x447343;if(debugging)_0x1f516f[_0x1dbae4(0x194)]('-d');let _0x346fcd=![];const _0xa32adc=_0x1f516f[0x0];_0x30c65f={..._0x30c65f,'stdio':[_0x1dbae4(0x20e),_0x1dbae4(0x20e),_0x1dbae4(0x20e),'ipc']},pid[_0xa32adc]=childProcess[_0x1dbae4(0x1da)](botfile,_0x1f516f,_0x30c65f),pid[_0xa32adc]['on']('message',_0x3d9dbf=>{const _0xb62dfa=_0x1dbae4;switch(Object[_0xb62dfa(0x113)](_0x3d9dbf)[0x0]){case _0xb62dfa(0x274):updateBotName(_0xa32adc,_0x3d9dbf['botname']);break;case _0xb62dfa(0x13d):updateBotManager();break;case'status':updateStatus(_0xa32adc,_0x3d9dbf['status']);break;case _0xb62dfa(0x1e2):updateLive(_0xa32adc,_0x3d9dbf[_0xb62dfa(0x1e2)]);break;case _0xb62dfa(0x23a):updateLive(_0xa32adc,_0x3d9dbf[_0xb62dfa(0x23a)]),io['to'](_0xa32adc)['emit'](_0xb62dfa(0x15d),{'access':{'allow':![],'reason':_0xb62dfa(0x11a),'token':null}});break;case _0xb62dfa(0x227):_0x3d9dbf[_0xb62dfa(0x227)]=='restart'&&restartBot(_0xa32adc);_0x3d9dbf[_0xb62dfa(0x227)]=='kill'&&toggleBot(_0xa32adc,_0xb62dfa(0xf5),'stopped');break;case'telegram':sendTelegramBot(_0xa32adc,_0x3d9dbf['telegram']);break;case _0xb62dfa(0x21b):sendTelegramMsg(_0x3d9dbf[_0xb62dfa(0x21b)]);break;case _0xb62dfa(0x1a3):io['to'](_0xa32adc)[_0xb62dfa(0x253)](_0x3d9dbf[_0xb62dfa(0x1a3)],_0x3d9dbf['args']);break;}}),pid[_0xa32adc]['on'](_0x1dbae4(0x209),function(_0x418bd4){if(_0x346fcd)return;_0x346fcd=!![],_0x7c929e(_0x418bd4);}),pid[_0xa32adc]['on'](_0x1dbae4(0x2b5),async function(_0xff8396){const _0x38bf1f=_0x1dbae4;if(terminating)return;if(installingUpdate){logger['debug'](_0x38bf1f(0x2ea)),io[_0x38bf1f(0x1ae)]();return;}if(_0x346fcd)return;_0x346fcd=!![],_0x7c929e(null);const _0x39cc47=dbConfig[_0x38bf1f(0x1ed)](_0x38bf1f(0x284))[_0x38bf1f(0x2d3)]({'botID':_0xa32adc})[_0x38bf1f(0x294)]();_0x39cc47&&(_0x39cc47['status']=='enabled'||_0x39cc47['status']==_0x38bf1f(0x17a))&&(await sleep(0x3e8),updateLive(_0xa32adc,'stopped'),logger[_0x38bf1f(0x26a)](_0x38bf1f(0x162)+_0xa32adc),startBot([_0xa32adc,userID],{'cwd':bbpath},function(_0xea2f3c){const _0x5d93cb=_0x38bf1f;if(_0xea2f3c)logger[_0x5d93cb(0x26a)](_0xea2f3c);}));});}function stopBot(_0x56a2e6){const _0x4fc35e=_0x447343;getClientsWithBotID(_0x56a2e6)[_0x4fc35e(0x2c9)](_0x1267e3=>{const _0xcc7374=_0x4fc35e;getSocket(_0x1267e3['id'])[_0xcc7374(0x2d4)](!![]),removeClient(_0x1267e3['id']);}),pid[_0x56a2e6]&&(pid[_0x56a2e6]['kill'](),pid[_0x56a2e6]=null);}function stopAllBots(){terminating=!![];const _0x462fe9=getEnabledBots();_0x462fe9['forEach'](_0xcf0420=>{const _0x1ebc38=_0x5c21;stopBot(_0xcf0420[_0x1ebc38(0x124)]);});}function restartBot(_0x5c5dc3){const _0x5b2d7b=_0x447343;if(pid[_0x5c5dc3])pid[_0x5c5dc3][_0x5b2d7b(0x2d1)]();}function addBot(){const _0x480fc3=_0x447343;let _0x22f10d;for(let _0x4c28f7=0x1;_0x4c28f7<0x3e9;_0x4c28f7++){_0x22f10d=_0x4c28f7[_0x480fc3(0x21f)]()[_0x480fc3(0x1e0)](0x3,'0');let _0x5d9f55=config['find'](_0x563677=>_0x563677['botID']==_0x22f10d);if(!_0x5d9f55)break;}if(_0x22f10d===_0x480fc3(0x192)){logger[_0x480fc3(0x26a)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x480fc3(0x26a)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x22f10d),dbConfig[_0x480fc3(0x1ed)](_0x480fc3(0x284))[_0x480fc3(0x194)]({'botID':_0x22f10d,'botname':_0x480fc3(0x15a)+_0x22f10d,'status':_0x480fc3(0x17a),'live':''})[_0x480fc3(0x2a6)](),startBot([_0x22f10d,userID],{'cwd':bbpath},function(_0x180a8d){const _0x5b4e0e=_0x480fc3;if(_0x180a8d)logger[_0x5b4e0e(0x26a)](_0x180a8d);}),config=getConfiguration(),io['to']('botmanager')[_0x480fc3(0x253)](_0x480fc3(0x284),config),broadcastToBots('bots',JSON[_0x480fc3(0x1d9)](config));}function deleteBot(_0x4e273f){const _0x1f842e=_0x447343;getClientsWithBotID(_0x4e273f)['forEach'](_0x352caa=>{const _0x5dff81=_0x5c21;getSocket(_0x352caa['id'])[_0x5dff81(0x2d4)](!![]),removeClient(_0x352caa['id']);}),dbConfig[_0x1f842e(0x1ed)](_0x1f842e(0x284))[_0x1f842e(0x1b8)]({'botID':_0x4e273f})[_0x1f842e(0x2a6)](),logger[_0x1f842e(0x26a)](_0x1f842e(0x203)+_0x4e273f),stopBot(_0x4e273f);try{if(fs[_0x1f842e(0x212)](path[_0x1f842e(0x234)](configpath,_0x1f842e(0x280)+_0x4e273f+'-config.json')))fs[_0x1f842e(0x150)](path[_0x1f842e(0x234)](configpath,_0x1f842e(0x280)+_0x4e273f+_0x1f842e(0x243)));if(fs[_0x1f842e(0x212)](path[_0x1f842e(0x234)](configpath,_0x1f842e(0x280)+_0x4e273f+_0x1f842e(0x2a9))))fs['unlinkSync'](path['join'](configpath,_0x1f842e(0x280)+_0x4e273f+_0x1f842e(0x2a9)));if(fs[_0x1f842e(0x212)](path[_0x1f842e(0x234)](configpath,'bot-'+_0x4e273f+'-performance.json')))fs['unlinkSync'](path[_0x1f842e(0x234)](configpath,_0x1f842e(0x280)+_0x4e273f+_0x1f842e(0x2e5)));if(fs['existsSync'](path[_0x1f842e(0x234)](configpath,_0x1f842e(0x280)+_0x4e273f+'-results.json')))fs[_0x1f842e(0x150)](path['join'](configpath,_0x1f842e(0x280)+_0x4e273f+_0x1f842e(0x1f3)));}catch(_0x57aff7){if(_0x57aff7)logger['full'](_0x1f842e(0x119),_0x57aff7);}config=getConfiguration(),io['to'](_0x1f842e(0x20b))[_0x1f842e(0x253)](_0x1f842e(0x284),config),broadcastToBots(_0x1f842e(0x284),JSON['stringify'](config));}function toggleBot(_0xaac270,_0x3ea4d3,_0x4c67eb){const _0x8266e3=_0x447343;dbConfig[_0x8266e3(0x1ed)](_0x8266e3(0x284))['find']({'botID':_0xaac270})[_0x8266e3(0x1f6)]({'status':_0x3ea4d3})[_0x8266e3(0x1f6)]({'live':_0x4c67eb})[_0x8266e3(0x2a6)]();if(_0x3ea4d3==_0x8266e3(0x12a)||_0x3ea4d3==_0x8266e3(0x17a))logger[_0x8266e3(0x26a)](_0x8266e3(0x27a)+_0xaac270),startBot([_0xaac270,userID],{'cwd':bbpath},function(_0x55ffc8){if(_0x55ffc8)logger['full'](_0x55ffc8);});else(_0x3ea4d3==_0x8266e3(0xf5)||_0x3ea4d3==_0x8266e3(0x24b))&&(logger[_0x8266e3(0x26a)]('Disabled\x20Bot\x20'+_0xaac270),stopBot(_0xaac270));config=getConfiguration(),io['to'](_0x8266e3(0x20b))[_0x8266e3(0x253)](_0x8266e3(0x284),config),broadcastToBots(_0x8266e3(0x284),JSON[_0x8266e3(0x1d9)](config));}function toggleStatus(_0x403c91){const _0x36eec5=_0x447343;let _0x2305de=dbConfig[_0x36eec5(0x1ed)](_0x36eec5(0x284))[_0x36eec5(0x2d3)]({'botID':_0x403c91})[_0x36eec5(0x294)](),_0x2bc5de;if(_0x2305de[_0x36eec5(0x15d)]===_0x36eec5(0x12a))_0x2bc5de='disabled';else{if(_0x2305de['status']==='new')_0x2bc5de=_0x36eec5(0x24b);else{if(_0x2305de[_0x36eec5(0x15d)]===_0x36eec5(0x24b))_0x2bc5de=_0x36eec5(0x17a);else{if(_0x2305de[_0x36eec5(0x15d)]===_0x36eec5(0xf5))_0x2bc5de=_0x36eec5(0x12a);}}}return _0x2bc5de;}function updateStatus(_0x288eb7,_0x39bc64){const _0x444f9f=_0x447343;dbConfig['get'](_0x444f9f(0x284))[_0x444f9f(0x2d3)]({'botID':_0x288eb7})[_0x444f9f(0x1f6)]({'status':_0x39bc64})[_0x444f9f(0x2a6)](),config=getConfiguration(),io['to'](_0x444f9f(0x20b))['emit']('bots',config),broadcastToBots(_0x444f9f(0x284),JSON['stringify'](config));}function updateLive(_0x847df6,_0x114748){const _0x4d5e40=_0x447343;dbConfig['get'](_0x4d5e40(0x284))[_0x4d5e40(0x2d3)]({'botID':_0x847df6})[_0x4d5e40(0x1f6)]({'live':_0x114748})[_0x4d5e40(0x2a6)](),config=getConfiguration(),io['to']('botmanager')[_0x4d5e40(0x253)](_0x4d5e40(0x284),config),broadcastToBots(_0x4d5e40(0x284),JSON[_0x4d5e40(0x1d9)](config));}function updateBotName(_0x115448,_0x5e6e3f){const _0x1bc522=_0x447343;dbConfig[_0x1bc522(0x1ed)](_0x1bc522(0x284))[_0x1bc522(0x2d3)]({'botID':_0x115448})[_0x1bc522(0x1f6)]({'botname':_0x5e6e3f})[_0x1bc522(0x2a6)](),config=getConfiguration(),io['to']('botmanager')[_0x1bc522(0x253)](_0x1bc522(0x284),config),broadcastToBots('bots',JSON[_0x1bc522(0x1d9)](config));}function updateBotManager(){const _0x218eb7=_0x447343;config=getConfiguration(),io['to'](_0x218eb7(0x20b))[_0x218eb7(0x253)](_0x218eb7(0x284),config),broadcastToBots('bots',JSON[_0x218eb7(0x1d9)](config));}function toggleBotMode(_0x37122e){const _0x5e9d8f=_0x447343;if(pid[_0x37122e])pid[_0x37122e][_0x5e9d8f(0x13c)]({'function':_0x5e9d8f(0x20f),'args':null});else{const _0x516e31=configpath+_0x5e9d8f(0x280)+_0x37122e+_0x5e9d8f(0x243),_0x7d1e96=fs[_0x5e9d8f(0x272)](_0x516e31),_0x41de9f=JSON[_0x5e9d8f(0x1b3)](_0x7d1e96),_0x12959f=_0x41de9f[_0x5e9d8f(0x1a0)][0x0]['headless'];_0x41de9f[_0x5e9d8f(0x1a0)][0x0][_0x5e9d8f(0x25c)]=!_0x12959f;const _0x7f3e1e=JSON['stringify'](_0x41de9f,null,0x2);fs[_0x5e9d8f(0x256)](_0x516e31,_0x7f3e1e),config=getConfiguration(),io['to'](_0x5e9d8f(0x20b))[_0x5e9d8f(0x253)](_0x5e9d8f(0x284),config),broadcastToBots(_0x5e9d8f(0x284),JSON['stringify'](config));}}function validateTelegram(_0x3a3c1b){const _0x39e197=_0x447343;if(_0x3a3c1b[_0x39e197(0x239)]['username']!=settings[_0x39e197(0x255)]&&'@'+_0x3a3c1b[_0x39e197(0x239)][_0x39e197(0x2e8)]!=settings['telegramUsername']||_0x3a3c1b[_0x39e197(0x154)]['id']!=settings[_0x39e197(0x1ee)])return sendTelegram(_0x3a3c1b[_0x39e197(0x154)]['id'],_0x39e197(0x28f),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x1af4e4=_0x447343;if(tgBot)tgBot[_0x1af4e4(0x227)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x4cc0d6=_0x1af4e4(0x249);_0x4cc0d6+='\x0a',_0x4cc0d6+='/enable\x20-\x20enable\x20notifications\x0a',_0x4cc0d6+=_0x1af4e4(0x2cc),_0x4cc0d6+=_0x1af4e4(0x149),_0x4cc0d6+=_0x1af4e4(0x1dc),_0x4cc0d6+=_0x1af4e4(0x191),_0x4cc0d6+=_0x1af4e4(0xf7),_0x4cc0d6+=_0x1af4e4(0x22d),_0x4cc0d6+=_0x1af4e4(0x13a),_0x4cc0d6+=_0x1af4e4(0x147),_0x4cc0d6+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x4cc0d6+=_0x1af4e4(0x16e),_0x4cc0d6+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x4cc0d6+=_0x1af4e4(0x197),_0x4cc0d6+=_0x1af4e4(0x132);let _0x3423c5=_0x1af4e4(0x18b);_0x3423c5+='\x0a',_0x3423c5+=_0x4cc0d6,tgBot[_0x1af4e4(0x190)]((_0x521bb3,_0x48f79f)=>{const _0x289759=_0x1af4e4;logger['simple'](getTimeStamp()+_0x289759(0x20c)),logger['debug'](_0x289759(0x156),_0x521bb3);}),tgBot[_0x1af4e4(0x196)](async(_0x2d5c76,_0x54088d)=>{const _0xea6ae4=_0x1af4e4;if(!(!settings[_0xea6ae4(0x1ee)]&&_0x2d5c76[_0xea6ae4(0x14f)][_0xea6ae4(0x29a)][_0xea6ae4(0x25b)]==_0xea6ae4(0x15c))){if(!validateTelegram(_0x2d5c76))return;}_0x54088d();}),tgBot['command']('start',async _0x12b708=>{const _0x39d731=_0x1af4e4;if(!settings[_0x39d731(0x1ee)])updateSetting(_0x39d731(0x1ee),_0x12b708[_0x39d731(0x154)]['id']);updateSetting(_0x39d731(0x14d),!![]);if(!validateTelegram(_0x12b708))return;await sendTelegram(_0x12b708[_0x39d731(0x154)]['id'],_0x3423c5);}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x2ef),async _0x14d942=>{const _0x570668=_0x1af4e4;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x14d942['chat']['id'],_0x570668(0x2dc));}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x202),async _0x36aba2=>{const _0x2417cb=_0x1af4e4;await sendTelegram(_0x36aba2[_0x2417cb(0x154)]['id'],_0x2417cb(0x14e)),updateSetting(_0x2417cb(0x14d),![]);}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0xfc),async _0x66b976=>{const _0x462231=_0x1af4e4,_0x448fe6=Markup['inlineKeyboard']([Markup[_0x462231(0x2de)][_0x462231(0x293)](_0x462231(0x14c),'config_orders'),Markup[_0x462231(0x2de)][_0x462231(0x293)](_0x462231(0x2d7),_0x462231(0x263)),Markup[_0x462231(0x2de)][_0x462231(0x293)](_0x462231(0x219),_0x462231(0x2b2))]);_0x66b976['reply'](_0x462231(0x165),_0x448fe6);}),tgBot[_0x1af4e4(0x135)]('config_orders',async _0x57ec0d=>{const _0x1cf992=_0x1af4e4;_0x57ec0d['editMessageReplyMarkup'](),updateSetting(_0x1cf992(0x205),_0x1cf992(0xfe)),updateSetting(_0x1cf992(0x14d),!![]),await sendTelegram(_0x57ec0d['chat']['id'],_0x1cf992(0x178));}),tgBot[_0x1af4e4(0x135)](_0x1af4e4(0x263),async _0x564b15=>{const _0x549244=_0x1af4e4;_0x564b15[_0x549244(0x1c7)](),updateSetting(_0x549244(0x205),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x564b15[_0x549244(0x154)]['id'],_0x549244(0x2db));}),tgBot[_0x1af4e4(0x135)](_0x1af4e4(0x2b2),async _0x4ee2d9=>{const _0x4a6c8d=_0x1af4e4;_0x4ee2d9[_0x4a6c8d(0x1c7)](),updateSetting(_0x4a6c8d(0x205),_0x4a6c8d(0x27f)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4ee2d9[_0x4a6c8d(0x154)]['id'],_0x4a6c8d(0x19d));}),tgBot[_0x1af4e4(0x19e)]('status',async _0x8fbaef=>{const _0x41e596=_0x1af4e4,_0x32a2bc=getBotsWithMode();let _0x3cd6e7=_0x41e596(0x16d);config[_0x41e596(0x2c9)](_0x930d69=>{const _0x597eae=_0x41e596,_0x3b3b5f=_0x32a2bc['find'](_0x42e20b=>_0x42e20b[_0x597eae(0x124)]==_0x930d69[_0x597eae(0x124)])[_0x597eae(0x2d9)];_0x3cd6e7+='Bot\x20'+_0x930d69[_0x597eae(0x124)]+':\x20'+_0x930d69[_0x597eae(0x15d)]+_0x597eae(0x1de)+_0x3b3b5f+_0x597eae(0x1de)+_0x930d69['live']+'\x0a';}),_0x3cd6e7+='\x0a',_0x3cd6e7+=_0x41e596(0x2dd),_0x3cd6e7+=!settings['telegramEnabled']?_0x41e596(0x1db):'Notifications\x20enabled\x0a',_0x3cd6e7+=settings['telegramEnabled']?settings[_0x41e596(0x205)]==_0x41e596(0x27f)?_0x41e596(0x265):_0x41e596(0x188)+settings[_0x41e596(0x205)]+_0x41e596(0x18c):'',await sendTelegram(_0x8fbaef[_0x41e596(0x154)]['id'],_0x3cd6e7,{'parse_mode':_0x41e596(0x281)});}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x146),async _0x329766=>{const _0xed93af=_0x1af4e4,_0xe96933=getEnabledBots();if(_0xe96933['length']==0x0)await sendTelegram(_0x329766[_0xed93af(0x154)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0xe96933[_0xed93af(0x1a6)]>0x1)_0xe96933[_0xed93af(0x194)]({'botID':_0xed93af(0x27f)});let _0x5bb07d=[],_0xdb06eb=[];const _0x206218=_0xe96933[_0xed93af(0x1a6)]%0x4==0x0||_0xe96933['length']%0x4==0x3||_0xe96933[_0xed93af(0x1a6)]%0x3==0x1?0x4:0x3;let _0x2172ee=0x0;_0xe96933[_0xed93af(0x2c9)]((_0x3c2072,_0x56b2d6)=>{const _0x4ec814=_0xed93af;if(_0x56b2d6%_0x206218==0x0)_0xdb06eb=[];_0xdb06eb[_0x4ec814(0x194)](Markup[_0x4ec814(0x2de)]['callback'](_0x3c2072['botID']==_0x4ec814(0x27f)?_0x4ec814(0x140):'Bot\x20'+_0x3c2072[_0x4ec814(0x124)],_0x4ec814(0xf0)+_0x3c2072[_0x4ec814(0x124)])),_0x56b2d6%_0x206218==0x0&&(_0x5bb07d[_0x2172ee]=_0xdb06eb,_0x2172ee++);});const _0x37668d=Markup[_0xed93af(0x1d8)](_0x5bb07d);_0x329766[_0xed93af(0x2b1)](_0xed93af(0x13e),_0x37668d);}}),tgBot[_0x1af4e4(0x135)](/restart_(.+)/,async _0x28a877=>{const _0x407b08=_0x1af4e4,_0x365f34=_0x28a877['match'][0x1];_0x28a877['editMessageReplyMarkup'](),_0x365f34==_0x407b08(0x27f)?config[_0x407b08(0x2c9)](_0x522bf1=>{restartBot(_0x522bf1['botID']);}):restartBot(_0x365f34);}),tgBot[_0x1af4e4(0x19e)]('on',async _0x2f1b72=>{const _0x25cdac=_0x1af4e4,_0xfd7f76=getDisabledBots();if(_0xfd7f76[_0x25cdac(0x1a6)]==0x0)await sendTelegram(_0x2f1b72[_0x25cdac(0x154)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0xfd7f76[_0x25cdac(0x1a6)]>0x1)_0xfd7f76[_0x25cdac(0x194)]({'botID':_0x25cdac(0x27f)});let _0x551389=[],_0x8a1b24=[];const _0x48f712=_0xfd7f76[_0x25cdac(0x1a6)]%0x4==0x0||_0xfd7f76[_0x25cdac(0x1a6)]%0x4==0x3||_0xfd7f76['length']%0x3==0x1?0x4:0x3;let _0x2ab6fc=0x0;_0xfd7f76['forEach']((_0x5bc36b,_0x263ffb)=>{const _0x31e94e=_0x25cdac;if(_0x263ffb%_0x48f712==0x0)_0x8a1b24=[];_0x8a1b24['push'](Markup['button'][_0x31e94e(0x293)](_0x5bc36b[_0x31e94e(0x124)]=='all'?_0x31e94e(0x140):_0x31e94e(0x15a)+_0x5bc36b[_0x31e94e(0x124)],'on_'+_0x5bc36b[_0x31e94e(0x124)])),_0x263ffb%_0x48f712==0x0&&(_0x551389[_0x2ab6fc]=_0x8a1b24,_0x2ab6fc++);});const _0x2039cb=Markup[_0x25cdac(0x1d8)](_0x551389);_0x2f1b72[_0x25cdac(0x2b1)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x2039cb);}}),tgBot[_0x1af4e4(0x135)](/on_(.+)/,async _0x57cf1d=>{const _0xb77780=_0x1af4e4,_0x8d1177=_0x57cf1d['match'][0x1];_0x57cf1d[_0xb77780(0x1c7)]();if(_0x8d1177=='all'){const _0x5a76bb=getDisabledBots();await sendTelegram(_0x57cf1d[_0xb77780(0x154)]['id'],_0xb77780(0x2ca)),_0x5a76bb[_0xb77780(0x2c9)](_0x29735e=>{const _0x589c01=_0xb77780;if(_0x29735e['botID']!='all')toggleBot(_0x29735e[_0x589c01(0x124)],toggleStatus(_0x29735e[_0x589c01(0x124)]),'stopped');});}else await sendTelegram(_0x57cf1d[_0xb77780(0x154)]['id'],_0xb77780(0x200)+_0x8d1177),toggleBot(_0x8d1177,toggleStatus(_0x8d1177),_0xb77780(0x1df));}),tgBot[_0x1af4e4(0x19e)]('off',async _0x52d398=>{const _0x2d4dd2=_0x1af4e4,_0x56ba7e=getEnabledBots();if(_0x56ba7e[_0x2d4dd2(0x1a6)]==0x0)await sendTelegram(_0x52d398[_0x2d4dd2(0x154)]['id'],_0x2d4dd2(0x2f1));else{if(_0x56ba7e[_0x2d4dd2(0x1a6)]>0x1)_0x56ba7e[_0x2d4dd2(0x194)]({'botID':_0x2d4dd2(0x27f)});let _0x3d956f=[],_0x1b35ed=[];const _0xab2b79=_0x56ba7e[_0x2d4dd2(0x1a6)]%0x4==0x0||_0x56ba7e[_0x2d4dd2(0x1a6)]%0x4==0x3||_0x56ba7e[_0x2d4dd2(0x1a6)]%0x3==0x1?0x4:0x3;let _0x1959fb=0x0;_0x56ba7e[_0x2d4dd2(0x2c9)]((_0x34a874,_0x24d086)=>{const _0x4f17d5=_0x2d4dd2;if(_0x24d086%_0xab2b79==0x0)_0x1b35ed=[];_0x1b35ed[_0x4f17d5(0x194)](Markup[_0x4f17d5(0x2de)][_0x4f17d5(0x293)](_0x34a874[_0x4f17d5(0x124)]==_0x4f17d5(0x27f)?'All\x20bots':'Bot\x20'+_0x34a874[_0x4f17d5(0x124)],_0x4f17d5(0x1b7)+_0x34a874[_0x4f17d5(0x124)])),_0x24d086%_0xab2b79==0x0&&(_0x3d956f[_0x1959fb]=_0x1b35ed,_0x1959fb++);});const _0x4839ae=Markup[_0x2d4dd2(0x1d8)](_0x3d956f);_0x52d398[_0x2d4dd2(0x2b1)](_0x2d4dd2(0xf2),_0x4839ae);}}),tgBot['action'](/off_(.+)/,async _0x40d1e7=>{const _0x10a095=_0x1af4e4,_0x1e0e93=_0x40d1e7[_0x10a095(0x1b0)][0x1];_0x40d1e7[_0x10a095(0x1c7)]();if(_0x1e0e93==_0x10a095(0x27f)){const _0x339f44=getEnabledBots();await sendTelegram(_0x40d1e7[_0x10a095(0x154)]['id'],_0x10a095(0x1f1)),_0x339f44[_0x10a095(0x2c9)](_0x2c0ded=>{const _0x5a1df4=_0x10a095;if(_0x2c0ded['botID']!=_0x5a1df4(0x27f))toggleBot(_0x2c0ded['botID'],toggleStatus(_0x2c0ded[_0x5a1df4(0x124)]),'stopped');});}else await sendTelegram(_0x40d1e7[_0x10a095(0x154)]['id'],_0x10a095(0x254)+_0x1e0e93),toggleBot(_0x1e0e93,toggleStatus(_0x1e0e93),_0x10a095(0x1df));}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x23c),async _0x54922b=>{const _0xe5b34c=_0x1af4e4,_0x26da30=getEnabledBots();if(_0x26da30[_0xe5b34c(0x1a6)]==0x0)await sendTelegram(_0x54922b[_0xe5b34c(0x154)]['id'],_0xe5b34c(0x2f1));else{if(_0x26da30['length']>0x1){let _0x31f018=[],_0x315756=[];const _0x408346=_0x26da30[_0xe5b34c(0x1a6)]%0x4==0x0||_0x26da30[_0xe5b34c(0x1a6)]%0x4==0x3||_0x26da30[_0xe5b34c(0x1a6)]%0x3==0x1?0x4:0x3;let _0x153853=0x0;_0x26da30[_0xe5b34c(0x2c9)]((_0x78d522,_0x54439a)=>{const _0x274664=_0xe5b34c;if(_0x54439a%_0x408346==0x0)_0x315756=[];_0x315756[_0x274664(0x194)](Markup[_0x274664(0x2de)][_0x274664(0x293)](_0x274664(0x15a)+_0x78d522[_0x274664(0x124)],_0x274664(0x175)+_0x78d522[_0x274664(0x124)])),_0x54439a%_0x408346==0x0&&(_0x31f018[_0x153853]=_0x315756,_0x153853++);});const _0x45aece=Markup['inlineKeyboard'](_0x31f018);_0x54922b[_0xe5b34c(0x2b1)](_0xe5b34c(0x10c),_0x45aece);}else{const _0x7c2c2=_0x26da30[0x0][_0xe5b34c(0x124)];if(pid[_0x7c2c2])pid[_0x7c2c2][_0xe5b34c(0x13c)]({'function':_0xe5b34c(0x29d),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x102c22=>{const _0x25ca3e=_0x1af4e4,_0x4c36c9=_0x102c22[_0x25ca3e(0x1b0)][0x1];_0x102c22['editMessageReplyMarkup']();if(pid[_0x4c36c9])pid[_0x4c36c9][_0x25ca3e(0x13c)]({'function':_0x25ca3e(0x29d),'args':null});}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x261),async _0x543eba=>{const _0x14f1d4=_0x1af4e4,_0xe8e346=getEnabledBots();if(_0xe8e346[_0x14f1d4(0x1a6)]==0x0)await sendTelegram(_0x543eba[_0x14f1d4(0x154)]['id'],_0x14f1d4(0x2f1));else{if(_0xe8e346[_0x14f1d4(0x1a6)]>0x1){let _0x1cdb69=[],_0x3456c3=[];const _0x52376a=_0xe8e346[_0x14f1d4(0x1a6)]%0x4==0x0||_0xe8e346[_0x14f1d4(0x1a6)]%0x4==0x3||_0xe8e346[_0x14f1d4(0x1a6)]%0x3==0x1?0x4:0x3;let _0x2a83ed=0x0;_0xe8e346[_0x14f1d4(0x2c9)]((_0x14a1ac,_0x4a23df)=>{const _0x57c547=_0x14f1d4;if(_0x4a23df%_0x52376a==0x0)_0x3456c3=[];_0x3456c3[_0x57c547(0x194)](Markup[_0x57c547(0x2de)][_0x57c547(0x293)](_0x57c547(0x15a)+_0x14a1ac[_0x57c547(0x124)],'portfolio_'+_0x14a1ac[_0x57c547(0x124)])),_0x4a23df%_0x52376a==0x0&&(_0x1cdb69[_0x2a83ed]=_0x3456c3,_0x2a83ed++);});const _0x34de74=Markup['inlineKeyboard'](_0x1cdb69);_0x543eba['reply'](_0x14f1d4(0x10e),_0x34de74);}else{const _0x453d8b=_0xe8e346[0x0]['botID'];if(pid[_0x453d8b])pid[_0x453d8b][_0x14f1d4(0x13c)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x1af4e4(0x135)](/portfolio_(.+)/,async _0x55259c=>{const _0x4826d5=_0x1af4e4,_0x1da663=_0x55259c[_0x4826d5(0x1b0)][0x1];_0x55259c['editMessageReplyMarkup']();if(pid[_0x1da663])pid[_0x1da663][_0x4826d5(0x13c)]({'function':_0x4826d5(0x2af),'args':null});}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x14f),async _0x47abaf=>{const _0xbf7506=_0x1af4e4;await getMessages();if(!updateAvailable)await sendTelegram(_0x47abaf[_0xbf7506(0x154)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x47abaf[_0xbf7506(0x154)]['id'],_0xbf7506(0x11e));else{const _0x595156=Markup[_0xbf7506(0x1d8)]([Markup['button'][_0xbf7506(0x293)](_0xbf7506(0x2bb),_0xbf7506(0x1d7)),Markup[_0xbf7506(0x2de)][_0xbf7506(0x293)]('No',_0xbf7506(0x181))]);_0x47abaf[_0xbf7506(0x2b1)](_0xbf7506(0x19f),_0x595156);}}}),tgBot[_0x1af4e4(0x135)](/update_(.+)/,async _0x2572a4=>{const _0x4fc6c7=_0x1af4e4,_0x4711e=_0x2572a4[_0x4fc6c7(0x1b0)][0x1];_0x2572a4[_0x4fc6c7(0x1c7)](),_0x4711e=='yes'&&(await sendTelegram(_0x2572a4[_0x4fc6c7(0x154)]['id'],_0x4fc6c7(0x1b5)),updateBB(_0x4fc6c7(0x14f))),_0x4711e=='no'&&await sendTelegram(_0x2572a4[_0x4fc6c7(0x154)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0x1d2),async _0x41406e=>{const _0x5d4aa6=_0x1af4e4;if(!validInstallation)await sendTelegram(_0x41406e[_0x5d4aa6(0x154)]['id'],_0x5d4aa6(0x2a4));else{const _0x1a2260=Markup['inlineKeyboard']([Markup[_0x5d4aa6(0x2de)][_0x5d4aa6(0x293)](_0x5d4aa6(0x2bb),_0x5d4aa6(0x26d)),Markup[_0x5d4aa6(0x2de)]['callback']('No',_0x5d4aa6(0x1a9))]);_0x41406e[_0x5d4aa6(0x2b1)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x1a2260);}}),tgBot['action'](/reinstall_(.+)/,async _0x3ac2df=>{const _0x345238=_0x1af4e4,_0x18c28a=_0x3ac2df[_0x345238(0x1b0)][0x1];_0x3ac2df[_0x345238(0x1c7)](),_0x18c28a=='yes'&&(await sendTelegram(_0x3ac2df[_0x345238(0x154)]['id'],_0x345238(0x295)),updateBB(_0x345238(0x1d2))),_0x18c28a=='no'&&await sendTelegram(_0x3ac2df[_0x345238(0x154)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0xfd),async _0x73f70e=>{const _0x17b9ae=_0x1af4e4,_0x543b68=getBotsWithMode();if(_0x543b68[_0x17b9ae(0x1a6)]==0x0)await sendTelegram(_0x73f70e['chat']['id'],_0x17b9ae(0x2f1));else{let _0x30b704=[],_0x188865=[];const _0x1af5f8=0x2;let _0x1ef6c2=0x0;_0x543b68[_0x17b9ae(0x2c9)]((_0x553652,_0x10fb52)=>{const _0x8683e4=_0x17b9ae;if(_0x10fb52%_0x1af5f8==0x0)_0x188865=[];_0x188865[_0x8683e4(0x194)](Markup['button'][_0x8683e4(0x293)](_0x8683e4(0x15a)+_0x553652[_0x8683e4(0x124)]+'\x20('+_0x553652[_0x8683e4(0x2d9)]+')',_0x8683e4(0x14a)+_0x553652[_0x8683e4(0x124)])),_0x10fb52%_0x1af5f8==0x0&&(_0x30b704[_0x1ef6c2]=_0x188865,_0x1ef6c2++);});const _0x55188f=Markup[_0x17b9ae(0x1d8)](_0x30b704);_0x73f70e[_0x17b9ae(0x2b1)](_0x17b9ae(0x2bf),_0x55188f);}}),tgBot[_0x1af4e4(0x135)](/toggle_(.+)/,async _0x4049d5=>{const _0x4ad094=_0x1af4e4,_0x1c8173=_0x4049d5[_0x4ad094(0x1b0)][0x1];_0x4049d5['editMessageReplyMarkup']();const _0x231a5f=getBotsWithMode(),_0x3dd2bc=_0x231a5f[_0x4ad094(0x2d3)](_0x446c23=>_0x446c23['botID']==_0x1c8173),_0x1077ca=_0x3dd2bc[_0x4ad094(0x2d9)]==_0x4ad094(0x2ce)?_0x4ad094(0x115):_0x4ad094(0x2ce);await sendTelegram(_0x4049d5[_0x4ad094(0x154)]['id'],_0x4ad094(0x208)+_0x1c8173+_0x4ad094(0x204)+_0x1077ca+'\x20mode'),toggleBotMode(_0x1c8173);}),tgBot[_0x1af4e4(0x19e)](_0x1af4e4(0xf4),async _0x1c0c53=>{const _0xb6ef5b=_0x1af4e4;let _0x287fa9='';config[_0xb6ef5b(0x2c9)](_0x564763=>{const _0x28576a=_0xb6ef5b;_0x287fa9+=_0x28576a(0x15a)+_0x564763['botID']+':\x20'+_0x564763['botname']+'\x0a';}),await sendTelegram(_0x1c0c53[_0xb6ef5b(0x154)]['id'],_0x287fa9,{'parse_mode':_0xb6ef5b(0x281)});}),tgBot[_0x1af4e4(0x19e)]('help',async _0x21e84f=>{const _0x4e9803=_0x1af4e4;await sendTelegram(_0x21e84f[_0x4e9803(0x154)]['id'],_0x4cc0d6);}),process[_0x1af4e4(0x179)](_0x1af4e4(0x225),()=>tgBot['stop'](_0x1af4e4(0x225))),process['once'](_0x1af4e4(0x2cf),()=>tgBot[_0x1af4e4(0x227)](_0x1af4e4(0x2cf))),tgBot['launch']();}}function disableTelegram(){const _0x3b3692=_0x447343;tgBot&&tgBot[_0x3b3692(0x227)]();}async function sendTelegram(_0x405c70,_0x293c9b,_0x118a72){const _0x108670=_0x447343;_0x118a72={..._0x118a72,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x108670(0x161)](_0x405c70,_0x293c9b,_0x118a72);}catch(_0xd544f7){console[_0x108670(0x230)](_0x108670(0x141),_0xd544f7);}}async function sendTelegramBot(_0x5aa252,_0x4ba076){const _0x1c1049=_0x447343;if(settings[_0x1c1049(0x14d)]){if(settings['telegramEvents']==_0x1c1049(0x27f)||(_0x4ba076[_0x1c1049(0x11c)]==_0x1c1049(0x209)||_0x4ba076[_0x1c1049(0x11c)]==_0x1c1049(0x1e4)||_0x4ba076[_0x1c1049(0x11c)]==_0x1c1049(0x220))&&settings[_0x1c1049(0x205)]==_0x1c1049(0x21e)||_0x4ba076[_0x1c1049(0x11c)]=='order'&&settings[_0x1c1049(0x205)]==_0x1c1049(0xfe)){if(tgBot&&settings[_0x1c1049(0x1ee)]){if(_0x4ba076['showname'])await sendTelegram(settings[_0x1c1049(0x1ee)],_0x4ba076[_0x1c1049(0x274)]+_0x1c1049(0x26f)+_0x4ba076[_0x1c1049(0x23b)]);else await sendTelegram(settings[_0x1c1049(0x1ee)],'Bot\x20'+_0x5aa252+'\x20>\x20'+_0x4ba076[_0x1c1049(0x23b)]);}}}}async function sendTelegramMsg(_0x230991,_0x14a1f8=_0x447343(0x281)){const _0x4e874a=_0x447343;return settings['telegramEnabled']&&tgBot&&settings[_0x4e874a(0x1ee)]?(await sendTelegram(settings['telegramChatId'],_0x230991,{'parse_mode':_0x14a1f8}),!![]):![];}function getDeviceWithIp(_0x16b709){return devices['find'](_0xe3f5e4=>_0xe3f5e4['ip']===_0x16b709);}async function temporaryAccess2FA(_0x2625ce,_0x5cc74d){const _0x1b3d01=_0x447343;let _0x27694b=new Date(),_0x4b4952=![];if(lastIpApproval){if(_0x27694b-lastIpApproval<0x1388)_0x4b4952=!![];}lastIpApproval=new Date();if(_0x4b4952)return;if(tgBot&&settings[_0x1b3d01(0x1ee)]){const _0x2fa937=uuidRandom();tmpStorage[_0x2fa937]={'uuid':_0x2625ce,'externalip':_0x5cc74d};const _0x214c13=Markup[_0x1b3d01(0x1d8)]([Markup[_0x1b3d01(0x2de)][_0x1b3d01(0x293)](_0x1b3d01(0x171),_0x1b3d01(0x125)+_0x2fa937),Markup[_0x1b3d01(0x2de)][_0x1b3d01(0x293)](_0x1b3d01(0x22c),_0x1b3d01(0x2ec)+_0x2fa937),Markup[_0x1b3d01(0x2de)][_0x1b3d01(0x293)](_0x1b3d01(0x2c6),_0x1b3d01(0x160)+_0x2fa937),Markup[_0x1b3d01(0x2de)][_0x1b3d01(0x293)](_0x1b3d01(0x1e3),_0x1b3d01(0x10f)+_0x2fa937)]);await sendTelegram(settings[_0x1b3d01(0x1ee)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x5cc74d)[_0x1b3d01(0x169)]+'\x20?',_0x214c13),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x49a44f=>{const _0x127721=_0x1b3d01,_0x4c5311=_0x49a44f[_0x127721(0x1b0)][0x1],_0x5c2e96=_0x49a44f[_0x127721(0x1b0)][0x2],{uuid:_0x6ddb7b,externalip:_0x37545d}=tmpStorage[_0x5c2e96];delete tmpStorage[_0x5c2e96],_0x49a44f[_0x127721(0x1c7)](),devices[_0x6ddb7b][_0x127721(0x107)]={'clientip':_0x37545d,'timestamp':new Date()['getTime'](),'expiry':_0x4c5311},_0x4c5311!=_0x127721(0x1e3)?(await sendTelegram(_0x49a44f[_0x127721(0x154)]['id'],_0x127721(0x268)+_0x4c5311+_0x127721(0x1f7),{'parse_mode':_0x127721(0x281)}),io['to'](_0x6ddb7b)[_0x127721(0x253)](_0x127721(0x15d),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x49a44f[_0x127721(0x154)]['id'],_0x127721(0x2a5)),io['to'](_0x6ddb7b)[_0x127721(0x253)](_0x127721(0x15d),{'access':{'allow':![],'reason':_0x127721(0x1a1),'token':null}}));});}}async function loginAccess2FA(_0x446fca,_0x5b92fd){const _0x404e17=_0x447343;if(tgBot&&settings[_0x404e17(0x1ee)]){const _0x192edf=uuidRandom();tmpStorage[_0x192edf]={'uuid':_0x446fca,'externalip':_0x5b92fd};const _0x2406b1=Markup['inlineKeyboard']([Markup[_0x404e17(0x2de)][_0x404e17(0x293)](_0x404e17(0x1fb),_0x404e17(0xf1)+loginExpiry+'_'+_0x192edf),Markup[_0x404e17(0x2de)][_0x404e17(0x293)](_0x404e17(0x1e3),_0x404e17(0x1f9)+_0x192edf)]);await sendTelegram(settings['telegramChatId'],_0x404e17(0x25e)+normalizeIP(_0x5b92fd)[_0x404e17(0x169)]+'\x20?',_0x2406b1),tgBot[_0x404e17(0x135)](/login2fa_(.+)_(.+)/,async _0x2905ff=>{const _0xb2cf7a=_0x404e17,_0x4a7bd9=_0x2905ff['match'][0x1],_0x56de70=_0x2905ff[_0xb2cf7a(0x1b0)][0x2],{uuid:_0x54c613,externalip:_0x39cdb2}=tmpStorage[_0x56de70];delete tmpStorage[_0x56de70],_0x2905ff['editMessageReplyMarkup'](),devices[_0x54c613][_0xb2cf7a(0x23d)]={'clientip':_0x39cdb2,'timestamp':new Date()[_0xb2cf7a(0x12b)](),'expiry':_0x4a7bd9},_0x4a7bd9!='reject'?(await sendTelegram(_0x2905ff['chat']['id'],_0xb2cf7a(0x257),{'parse_mode':_0xb2cf7a(0x281)}),io['to'](_0x54c613)['emit'](_0xb2cf7a(0x15d),{'access':{'allow':![],'reason':_0xb2cf7a(0x11a),'token':null}})):(await sendTelegram(_0x2905ff[_0xb2cf7a(0x154)]['id'],'Login\x20rejected'),io['to'](_0x54c613)[_0xb2cf7a(0x253)]('status',{'access':{'allow':![],'reason':_0xb2cf7a(0x10d),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1d29c9=_0x447343;return dbConfig[_0x1d29c9(0x1ed)](_0x1d29c9(0x284))[_0x1d29c9(0x252)](_0x1d29c9(0x124))[_0x1d29c9(0x264)]({'status':_0x1d29c9(0x12a)})[_0x1d29c9(0x294)]()||[];}function getDisabledBots(){const _0x2100b4=_0x447343;return dbConfig[_0x2100b4(0x1ed)]('bots')[_0x2100b4(0x252)]('botID')[_0x2100b4(0x264)]({'status':_0x2100b4(0xf5)})[_0x2100b4(0x294)]()||[];}function getBotAttributes(_0x430bf0){const _0x45184e=_0x447343;let _0x517fef={};const _0x3bb7f9=configpath+_0x45184e(0x280)+_0x430bf0+'-config.json',_0x37c49c=fs['existsSync'](_0x3bb7f9);if(_0x37c49c){const _0x1d8d7e=fs[_0x45184e(0x272)](_0x3bb7f9);try{const _0xe9f1b=JSON[_0x45184e(0x1b3)](_0x1d8d7e),_0xea9ae4=_0xe9f1b?_0xe9f1b['bot'][0x0][_0x45184e(0x25c)]:![];_0x517fef['mode']=_0xea9ae4?_0x45184e(0x2ce):_0x45184e(0x115),_0x517fef[_0x45184e(0x274)]=_0xe9f1b?_0xe9f1b[_0x45184e(0x1a0)][0x0][_0x45184e(0x274)]:_0x45184e(0x15a)+_0x430bf0;}catch(_0x443a87){_0x517fef[_0x45184e(0x2d9)]=_0x45184e(0x115),_0x517fef[_0x45184e(0x274)]=_0x45184e(0x15a)+_0x430bf0;}}else _0x517fef[_0x45184e(0x2d9)]='manual',_0x517fef['botname']=_0x45184e(0x15a)+_0x430bf0;return _0x517fef;}function getBotsWithMode(){const _0x4d89ae=_0x447343,_0x37d5c3=dbConfig[_0x4d89ae(0x1ed)]('bots')[_0x4d89ae(0x252)](_0x4d89ae(0x124))[_0x4d89ae(0x294)]()||[];return _0x37d5c3[_0x4d89ae(0x2c9)](_0x362163=>{const _0x491ec4=_0x4d89ae;let _0x181e88=getBotAttributes(_0x362163['botID']);_0x362163[_0x491ec4(0x2d9)]=_0x181e88[_0x491ec4(0x2d9)];}),_0x37d5c3;}function getBotExchanges(){const _0x17b76d=_0x447343;let _0x1473f6=[];const _0x4bb734=dbConfig[_0x17b76d(0x1ed)](_0x17b76d(0x284))[_0x17b76d(0x252)]('botID')['value']()||[];_0x4bb734[_0x17b76d(0x2c9)](_0x1e010a=>{const _0x4501fc=_0x17b76d;if(_0x1e010a[_0x4501fc(0x15d)]=='enabled'){const _0x50ad3b=configpath+_0x4501fc(0x280)+_0x1e010a[_0x4501fc(0x124)]+_0x4501fc(0x243),_0x291787=fs[_0x4501fc(0x212)](_0x50ad3b);let _0x267d81;if(_0x291787){const _0x4947e2=fs['readFileSync'](_0x50ad3b);try{const _0x5ad4f2=JSON[_0x4501fc(0x1b3)](_0x4947e2);_0x267d81=_0x5ad4f2?_0x5ad4f2['bot'][0x0][_0x4501fc(0x153)]:null;}catch(_0x22297c){}}if(_0x267d81)_0x1473f6[_0x4501fc(0x194)](_0x267d81);}});const _0x63619e=[...new Set(_0x1473f6)][_0x17b76d(0x286)]();return _0x63619e;}async function initUser(){const _0x11fb87=_0x447343;if(!settings[_0x11fb87(0x1b4)]){const _0x22b1e7=uuidRandom();mixpanel[_0x11fb87(0x25f)](_0x22b1e7),updateSetting(_0x11fb87(0x1b4),_0x22b1e7);}}async function initSecure(){const _0x18a390=_0x447343;let _0x56538f=getSecure();if(!_0x56538f[_0x18a390(0x279)](_0x18a390(0x2d2))){let _0x51adeb=await generateKeys();_0x56538f[_0x18a390(0x11d)]=_0x51adeb[_0x18a390(0x11d)],_0x56538f[_0x18a390(0x138)]=_0x51adeb[_0x18a390(0x138)],_0x56538f[_0x18a390(0x2d2)]=crypto[_0x18a390(0x151)](0x20)[_0x18a390(0x21f)](_0x18a390(0x18a));;storeSecure(_0x56538f);}}function getSettings(){const _0x4bea8d=_0x447343;return dbSettings[_0x4bea8d(0x1ed)]('settings')[_0x4bea8d(0x294)]()||{};}function getSecure(){const _0x17de4d=_0x447343;return dbSecure[_0x17de4d(0x1ed)](_0x17de4d(0x148))[_0x17de4d(0x294)]()||{};}function getBlacklist(){const _0x105171=_0x447343;return dbSecure[_0x105171(0x1ed)]('blacklist')[_0x105171(0x294)]()||[];}function broadcastToBots(_0x477b51,_0x267211){const _0xbc0412=_0x447343;config[_0xbc0412(0x2c9)](_0x39deeb=>{const _0x3c19eb=_0xbc0412;if(_0x39deeb[_0x3c19eb(0x15d)]==_0x3c19eb(0x12a)&&_0x39deeb[_0x3c19eb(0x1e2)]==_0x3c19eb(0x1c1)||_0x39deeb[_0x3c19eb(0x15d)]=='new'&&_0x39deeb[_0x3c19eb(0x1e2)]==_0x3c19eb(0x1c1)){if(pid[_0x39deeb[_0x3c19eb(0x124)]])pid[_0x39deeb['botID']]['send']({[_0x477b51]:_0x267211});}});}async function storeSettings(_0x435667,_0x3b6286=![]){const _0x48dd51=_0x447343;_0x435667={...settings,..._0x435667};if(_0x3b6286&&_0x435667['bbPassword']!=_0x48dd51(0x287)&&_0x435667[_0x48dd51(0x183)]!='***'&&_0x435667[_0x48dd51(0x183)]!=''){const _0x232aa4=crypt['decrypt'](secure[_0x48dd51(0x138)],_0x435667[_0x48dd51(0x183)])[_0x48dd51(0x29a)][_0x48dd51(0x278)](_0x48dd51(0x1ea))[0x0],_0x4a1ae0=bcrypt['hashSync'](_0x232aa4,saltRounds);_0x435667={..._0x435667,'bbPassword':_0x4a1ae0};}if(_0x3b6286&&_0x435667['telegramToken']!=_0x48dd51(0x287)&&_0x435667['telegramToken']!='***'&&_0x435667[_0x48dd51(0x266)]!=''){const _0x21c66c=crypt[_0x48dd51(0x2a1)](secure[_0x48dd51(0x138)],_0x435667[_0x48dd51(0x266)])[_0x48dd51(0x29a)]['split'](_0x48dd51(0x1ea))[0x0];_0x435667={..._0x435667,'telegramToken':_0x21c66c};}if(_0x3b6286&&_0x435667[_0x48dd51(0x226)]!=_0x48dd51(0x287)&&_0x435667[_0x48dd51(0x226)]!=_0x48dd51(0x2d0)&&_0x435667['marketcapApi']!=''){const _0x2fb064=crypt[_0x48dd51(0x2a1)](secure['privateKey'],_0x435667[_0x48dd51(0x226)])[_0x48dd51(0x29a)][_0x48dd51(0x278)](_0x48dd51(0x1ea))[0x0];_0x435667={..._0x435667,'marketcapApi':_0x2fb064};}const _0x4dc34b=_0x435667['telegramToken']!=_0x48dd51(0x287)&&_0x435667[_0x48dd51(0x266)]!=settings[_0x48dd51(0x266)]||_0x435667[_0x48dd51(0x255)]!=settings[_0x48dd51(0x255)],_0x5e0379=_0x435667['telegramToken']==''||_0x435667[_0x48dd51(0x255)]=='',_0xa099ae=_0x435667[_0x48dd51(0x226)]&&_0x435667[_0x48dd51(0x226)]!=_0x48dd51(0x287)&&_0x435667['marketcapApi']!=settings[_0x48dd51(0x266)];_0x4dc34b&&(_0x435667['telegramChatId']=null,_0x435667[_0x48dd51(0x205)]=_0x48dd51(0x27f));_0xa099ae&&await testMarketcapApi(_0x435667[_0x48dd51(0x226)]);for(const [_0x100608,_0x19bd7c]of Object[_0x48dd51(0x180)](_0x435667)){if(_0x100608==_0x48dd51(0x266)&&_0x19bd7c==_0x48dd51(0x287)){_0x435667['telegramToken']=settings['telegramToken'];continue;};if(_0x100608==_0x48dd51(0x183)&&_0x19bd7c==_0x48dd51(0x287)){_0x435667[_0x48dd51(0x183)]=settings['bbPassword'];continue;};if(_0x100608==_0x48dd51(0x226)&&_0x19bd7c==_0x48dd51(0x287)){_0x435667[_0x48dd51(0x226)]=settings['marketcapApi'];continue;};dbSettings[_0x48dd51(0x2f3)]('settings.'+_0x100608,_0x19bd7c)[_0x48dd51(0x2a6)]();}settings=_0x435667,io['to'](_0x48dd51(0x20b))[_0x48dd51(0x253)](_0x48dd51(0x163),cleanSettings()),broadcastToBots(_0x48dd51(0x102),settings[_0x48dd51(0x102)]),broadcastToBots(_0x48dd51(0x2ab),settings[_0x48dd51(0x2ab)]),broadcastToBots(_0x48dd51(0x226),settings[_0x48dd51(0x226)]);if(_0x4dc34b&&!_0x5e0379)initTelegram();if(_0x4dc34b&&_0x5e0379)disableTelegram();getAllClients()[_0x48dd51(0x2c9)](_0x35a549=>{const _0x1879af=_0x48dd51;getSocket(_0x35a549['id'])[_0x1879af(0x253)]('status',{'access':{'allow':![],'reason':_0x1879af(0x11a),'token':null}});});}async function testMarketcapApi(_0x1196e8){const _0x25bdc9=_0x447343,_0x4a344f=['BCT',_0x25bdc9(0x1ff)];let _0x34ee0c=null;try{_0x34ee0c=await axios[_0x25bdc9(0x1ed)](_0x25bdc9(0x11f),{'headers':{'X-CMC_PRO_API_KEY':_0x1196e8},'params':{'symbol':_0x4a344f[_0x25bdc9(0x21f)]()}});}catch(_0x250cca){_0x34ee0c=null,_0x250cca['toString']()['includes'](_0x25bdc9(0x23f))?(io['to'](_0x25bdc9(0x20b))[_0x25bdc9(0x253)](_0x25bdc9(0x2e2),_0x25bdc9(0x2bc)),logger[_0x25bdc9(0x26a)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')[_0x25bdc9(0x253)](_0x25bdc9(0x2e2),_0x25bdc9(0x1c4)),logger[_0x25bdc9(0x26a)](_0x25bdc9(0x1c4)),logger[_0x25bdc9(0x2c3)]('Error\x20details:',_0x250cca[_0x25bdc9(0x21f)]()+_0x25bdc9(0x2aa)+_0x250cca['code'])),await sleep(0xbb8);}}function updateSetting(_0x29c5ce,_0x26a21d){const _0x3afa8a=_0x447343;dbSettings['set'](_0x3afa8a(0x276)+_0x29c5ce,_0x26a21d)['write'](),settings=getSettings(),io['to'](_0x3afa8a(0x20b))[_0x3afa8a(0x253)]('settings',cleanSettings());}function storeSecure(_0x1c8cf1){const _0x50fde5=_0x447343;dbSecure[_0x50fde5(0x1ed)](_0x50fde5(0x148))['push'](_0x1c8cf1)[_0x50fde5(0x2a6)](),secure=_0x1c8cf1;}function _0x5c21(_0x33386e,_0x105289){const _0xdd1a4d=_0x3ec1();return _0x5c21=function(_0x55dda3,_0xbd8ed7){_0x55dda3=_0x55dda3-0xf0;let _0x3ec1c6=_0xdd1a4d[_0x55dda3];return _0x3ec1c6;},_0x5c21(_0x33386e,_0x105289);}function addBlacklist(_0x594219){const _0x5be49d=_0x447343;cleanBlacklist();let _0x46bcdd;devices[_0x594219][_0x5be49d(0x107)]?_0x46bcdd=Math['max'](devices[_0x594219][_0x5be49d(0x107)]['expiry'],loginExpiry):_0x46bcdd=loginExpiry,dbSecure[_0x5be49d(0x1ed)](_0x5be49d(0x143))[_0x5be49d(0x194)]({'expiry':new Date()[_0x5be49d(0x12b)]()+_0x46bcdd*0x3c*0x3e8,'token':devices[_0x594219][_0x5be49d(0x221)][_0x5be49d(0x1c6)]})['write'](),blacklist=dbSecure['get'](_0x5be49d(0x143))['value']();}function cleanBlacklist(){const _0x3c6b09=_0x447343;let _0x31d5a9=dbSecure[_0x3c6b09(0x1ed)](_0x3c6b09(0x143))[_0x3c6b09(0x28b)]()[_0x3c6b09(0x294)](),_0x1704ef=new Date()[_0x3c6b09(0x12b)]();_0x31d5a9[_0x3c6b09(0x2c9)](_0x326486=>{const _0x32d6ae=_0x3c6b09;_0x326486[_0x32d6ae(0x129)]<_0x1704ef&&dbSecure[_0x32d6ae(0x1ed)](_0x32d6ae(0x143))[_0x32d6ae(0x1b8)]({'expiry':_0x326486[_0x32d6ae(0x129)]})[_0x32d6ae(0x2a6)]();});}function initStates(){const _0x442152=_0x447343;let _0x40023c=getConfiguration();_0x40023c[_0x442152(0x2c9)](_0x235e5f=>{const _0x2f764d=_0x442152;_0x235e5f[_0x2f764d(0x1e2)]='stopped';}),storeConfiguration(_0x40023c);}function onKeys(){const _0x4d965e=new RSA();return new Promise(_0x47ff60=>{const _0x339de3=_0x5c21;_0x4d965e[_0x339de3(0x1cc)]()['then'](_0x525350=>{_0x47ff60(_0x525350);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1a273e=_0x447343;let _0x5618f2=getSettings(),_0x5de50d=![];!_0x5618f2['hasOwnProperty'](_0x1a273e(0x269))&&(_0x5618f2[_0x1a273e(0x269)]=0x0,_0x5de50d=!![]);!_0x5618f2['hasOwnProperty']('lastmsgemitted')&&(_0x5618f2[_0x1a273e(0x27d)]=0x0,_0x5de50d=!![]);!_0x5618f2[_0x1a273e(0x279)]('latestversion')&&(_0x5618f2[_0x1a273e(0x172)]=_0x1a273e(0x199),_0x5de50d=!![]);!_0x5618f2[_0x1a273e(0x279)](_0x1a273e(0x2ab))&&(_0x5618f2[_0x1a273e(0x2ab)]=![],_0x5de50d=!![]);!_0x5618f2[_0x1a273e(0x279)](_0x1a273e(0x226))&&(_0x5618f2[_0x1a273e(0x226)]='',_0x5de50d=!![]);if(_0x5de50d)storeSettings(_0x5618f2);try{fs[_0x1a273e(0x207)](configbackuppath,{'withFileTypes':!![]})[_0x1a273e(0x2c9)](_0x480d93=>{const _0x3fc58d=_0x1a273e;if(!_0x480d93['isDirectory']()){if(!_0x480d93[_0x3fc58d(0x1fe)]['startsWith'](_0x3fc58d(0x15f)))fs[_0x3fc58d(0x150)](configbackuppath+_0x480d93['name']);}else fs['rmSync'](configbackuppath+_0x480d93['name'],{'recursive':!![]});});}catch(_0x536ad7){logger[_0x1a273e(0x2c3)]('Error\x20removing\x20old\x20backup\x20files:',_0x536ad7);}}function storeConfiguration(_0x518df2){const _0x362a31=_0x447343;dbConfig[_0x362a31(0x1ed)](_0x362a31(0x284))[_0x362a31(0x1b8)]()[_0x362a31(0x2a6)](),dbConfig['get'](_0x362a31(0x284))[_0x362a31(0x194)](..._0x518df2)[_0x362a31(0x2a6)](),config=_0x518df2;}async function resetPassword(){const _0x19e81b=_0x447343;if(tgBot&&settings['telegramChatId']){const _0x2bd95d=Markup[_0x19e81b(0x1d8)]([Markup['button'][_0x19e81b(0x293)]('yes',_0x19e81b(0x2c1)),Markup[_0x19e81b(0x2de)][_0x19e81b(0x293)]('no',_0x19e81b(0x127))]);await sendTelegram(settings[_0x19e81b(0x1ee)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x2bd95d),tgBot[_0x19e81b(0x135)](/resetpw_(.+)/,async _0xc84a57=>{const _0x675838=_0x19e81b,_0x3b0888=_0xc84a57[_0x675838(0x1b0)][0x1];_0xc84a57[_0x675838(0x1c7)]();if(_0x3b0888!='no'){const _0x12efc7=0xf,_0x3bd6cb='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x332044=Array[_0x675838(0x239)](crypto['randomFillSync'](new Uint32Array(_0x12efc7)))['map'](_0x17299f=>_0x3bd6cb[_0x17299f%_0x3bd6cb[_0x675838(0x1a6)]])[_0x675838(0x234)](''),_0x5e9a35=bcrypt[_0x675838(0x1cb)](_0x332044,saltRounds);storeSettings({'bbPassword':_0x5e9a35}),await sendTelegram(_0xc84a57[_0x675838(0x154)]['id'],_0x675838(0x195)+_0x332044,{'parse_mode':_0x675838(0x281)});}else await sendTelegram(_0xc84a57[_0x675838(0x154)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x2b020c,_0x2c9e26){const _0x5842f1=_0x447343;io['to'](_0x5842f1(0x20b))[_0x5842f1(0x253)](_0x5842f1(0x2e2),_0x5842f1(0x2e4),'success');if(tgBot&&settings[_0x5842f1(0x1ee)]){const _0x49b236=uuidRandom();tmpStorage[_0x49b236]={'path':_0x2b020c,'filename':_0x2c9e26};const _0x2c0db8=Markup[_0x5842f1(0x1d8)]([Markup[_0x5842f1(0x2de)][_0x5842f1(0x293)](_0x5842f1(0x2d8),'restore_yes_'+_0x49b236),Markup[_0x5842f1(0x2de)]['callback']('no',_0x5842f1(0x168)+_0x49b236)]);await sendTelegram(settings[_0x5842f1(0x1ee)],_0x5842f1(0x299),_0x2c0db8),tgBot[_0x5842f1(0x135)](/restore_(.+)_(.+)/,async _0x4e657d=>{const _0x97271f=_0x5842f1,_0x4ec523=_0x4e657d[_0x97271f(0x1b0)][0x1],_0x309ce3=_0x4e657d[_0x97271f(0x1b0)][0x2],{path:_0x2bfc13,filename:_0x51378d}=tmpStorage[_0x309ce3];delete tmpStorage[_0x309ce3],_0x4e657d[_0x97271f(0x1c7)](),_0x4ec523==_0x97271f(0x2d8)?(logger[_0x97271f(0x2c3)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x4e657d['chat']['id'],_0x97271f(0x1f4),{'parse_mode':_0x97271f(0x281)}),unzipFile(_0x2bfc13,_0x51378d)):(logger['debug'](_0x97271f(0x1d0)),await sendTelegram(_0x4e657d[_0x97271f(0x154)]['id'],_0x97271f(0x1d0)));});}}function getServerTime(){const _0x8565b=_0x447343,_0x177b54=new Date();return _0x177b54['getFullYear']()+'/'+(_0x177b54[_0x8565b(0x290)]()+0x1)[_0x8565b(0x21f)]()[_0x8565b(0x1e0)](0x2,'0')+'/'+_0x177b54[_0x8565b(0x118)]()[_0x8565b(0x21f)]()[_0x8565b(0x1e0)](0x2,'0')+'\x20'+_0x177b54['getHours']()[_0x8565b(0x21f)]()[_0x8565b(0x1e0)](0x2,'0')+':'+_0x177b54['getMinutes']()['toString']()[_0x8565b(0x1e0)](0x2,'0')+':'+_0x177b54[_0x8565b(0x174)]()[_0x8565b(0x21f)]()[_0x8565b(0x1e0)](0x2,'0');}function getTimeStamp(){const _0x205cf9=_0x447343,_0x5d9f35=shiftedTime();return _0x5d9f35[_0x205cf9(0x152)]()+'/'+(_0x5d9f35[_0x205cf9(0x290)]()+0x1)[_0x205cf9(0x21f)]()[_0x205cf9(0x1e0)](0x2,'0')+'/'+_0x5d9f35['getDate']()[_0x205cf9(0x21f)]()[_0x205cf9(0x1e0)](0x2,'0')+'\x20'+_0x5d9f35[_0x205cf9(0xfb)]()[_0x205cf9(0x21f)]()[_0x205cf9(0x1e0)](0x2,'0')+':'+_0x5d9f35[_0x205cf9(0x1e8)]()[_0x205cf9(0x21f)]()[_0x205cf9(0x1e0)](0x2,'0')+':'+_0x5d9f35[_0x205cf9(0x174)]()[_0x205cf9(0x21f)]()[_0x205cf9(0x1e0)](0x2,'0');}function getCleanTimeStamp(){const _0x2f944e=_0x447343,_0x5d2548=shiftedTime();return _0x5d2548['getFullYear']()+(_0x5d2548[_0x2f944e(0x290)]()+0x1)[_0x2f944e(0x21f)]()['padStart'](0x2,'0')+_0x5d2548['getDate']()[_0x2f944e(0x21f)]()[_0x2f944e(0x1e0)](0x2,'0')+'-'+_0x5d2548[_0x2f944e(0xfb)]()[_0x2f944e(0x21f)]()[_0x2f944e(0x1e0)](0x2,'0')+_0x5d2548[_0x2f944e(0x1e8)]()[_0x2f944e(0x21f)]()[_0x2f944e(0x1e0)](0x2,'0')+_0x5d2548['getSeconds']()[_0x2f944e(0x21f)]()[_0x2f944e(0x1e0)](0x2,'0');}function shiftedTime(){const _0x1dfc71=_0x447343,_0x20ac94=new Date();let _0xd68228=_0x20ac94;if(settings[_0x1dfc71(0x102)]&&settings[_0x1dfc71(0x102)]!==0x0)_0xd68228=fns[_0x1dfc71(0x1a2)](_0x20ac94,{'hours':settings[_0x1dfc71(0x102)]});return _0xd68228;}function startScheduler(){const _0x1b8dea=_0x447343,_0x947d92=new Date()[_0x1b8dea(0x103)](),_0x4f5354=shiftedTime()[_0x1b8dea(0xfb)]();_0x4f5354==0x4&&backupConfigFiles();_0x4f5354==0x0&&rotateLogFiles();_0x947d92%0x6==0x0&&triggerAnalytics();_0x947d92%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5217b5){const _0x1e04db=_0x447343;logger['debug'](_0x1e04db(0x1cd)+_0x5217b5);const _0x545162=getBotsWithMode();_0x545162[_0x1e04db(0x1a6)]>0x0?confirmRestore(configbackuppath,_0x5217b5):unzipFile(configbackuppath,_0x5217b5);}async function getBackupFiles(_0x550555=null){const _0x112585=_0x447343;let _0x4bc9fa=[],_0x39eaad=fs[_0x112585(0x207)](configbackuppath,{'withFileTypes':!![]});_0x39eaad[_0x112585(0x286)]((_0x1c9029,_0x20c9b0)=>_0x1c9029[_0x112585(0x1fe)]<_0x20c9b0[_0x112585(0x1fe)]?0x1:_0x20c9b0[_0x112585(0x1fe)]<_0x1c9029[_0x112585(0x1fe)]?-0x1:0x0),_0x39eaad[_0x112585(0x2c9)](_0x1a1b7e=>{const _0x332111=_0x112585;if(!_0x1a1b7e['isDirectory']()&&_0x1a1b7e['name']['startsWith'](_0x332111(0x15f))&&_0x1a1b7e[_0x332111(0x1fe)][_0x332111(0x1ba)](_0x332111(0x23e))){const _0x515997=formatDate(fs[_0x332111(0x114)](configbackuppath+_0x1a1b7e['name'])['mtime']);_0x4bc9fa[_0x332111(0x194)]({'name':_0x1a1b7e[_0x332111(0x1fe)],'mtime':_0x515997});}});if(_0x550555)io['to'](_0x550555)[_0x112585(0x253)](_0x112585(0x1af),_0x4bc9fa);else return _0x4bc9fa;}async function backupConfigFiles(){const _0x3133fd=_0x447343;await zipFiles(_0x3133fd(0x1bb));const _0x153cb2=getCleanTimeStamp();fs[_0x3133fd(0x2e6)](zippath+_0x3133fd(0x2a8),configbackuppath+(_0x3133fd(0x15f)+_0x153cb2+_0x3133fd(0x23e)));let _0x45e133=fs[_0x3133fd(0x207)](configbackuppath,{'withFileTypes':!![]});_0x45e133[_0x3133fd(0x286)]((_0x1fb1da,_0xe859b0)=>_0x1fb1da['name']<_0xe859b0['name']?0x1:_0xe859b0[_0x3133fd(0x1fe)]<_0x1fb1da[_0x3133fd(0x1fe)]?-0x1:0x0),_0x45e133[_0x3133fd(0x1a6)]>maxBackups&&fs[_0x3133fd(0x150)](configbackuppath+_0x45e133[_0x45e133[_0x3133fd(0x1a6)]-0x1][_0x3133fd(0x1fe)]);}function rotateLogFiles(){const _0x34b293=_0x447343,_0x82a3d3=fs['statSync'](logspath+_0x34b293(0xf3)),_0x3d40f0=_0x82a3d3['size']/0x400;if(_0x3d40f0>0x64){let _0x5a424b=fs[_0x34b293(0x207)](logspath,{'withFileTypes':!![]});_0x5a424b[_0x34b293(0x286)]((_0x549ddd,_0x2afe95)=>_0x549ddd[_0x34b293(0x1fe)]<_0x2afe95[_0x34b293(0x1fe)]?0x1:_0x2afe95[_0x34b293(0x1fe)]<_0x549ddd[_0x34b293(0x1fe)]?-0x1:0x0),_0x5a424b[_0x34b293(0x2c9)](_0x285c04=>{const _0x45f9d1=_0x34b293;if(_0x285c04[_0x45f9d1(0x1fe)]=='output-002.log')fs[_0x45f9d1(0x2e6)](logspath+_0x285c04[_0x45f9d1(0x1fe)],logspath+_0x45f9d1(0x137));if(_0x285c04[_0x45f9d1(0x1fe)]==_0x45f9d1(0x108))fs[_0x45f9d1(0x2e6)](logspath+_0x285c04[_0x45f9d1(0x1fe)],logspath+_0x45f9d1(0x166));_0x285c04[_0x45f9d1(0x1fe)]==_0x45f9d1(0xf3)&&(fs[_0x45f9d1(0x2e6)](logspath+_0x285c04[_0x45f9d1(0x1fe)],logspath+_0x45f9d1(0x108)),fs[_0x45f9d1(0x256)](logspath+_0x285c04[_0x45f9d1(0x1fe)],''));});}}async function zipFiles(_0x125e57){const _0x1c4591=_0x447343;let _0xd89b4b;if(_0x125e57==_0x1c4591(0x259))_0xd89b4b=logspath;if(_0x125e57==_0x1c4591(0x238))_0xd89b4b=configpath;if(_0x125e57==_0x1c4591(0x1bb))_0xd89b4b=configpath;let _0x2a34d5=fs[_0x1c4591(0x207)](_0xd89b4b,{'withFileTypes':!![]});const _0x562454=new require(_0x1c4591(0x177))();_0x2a34d5[_0x1c4591(0x2c9)](_0x5b1878=>{const _0x51d9ff=_0x1c4591;if(!_0x5b1878[_0x51d9ff(0x2b4)]()){let _0x11ebdd=fs[_0x51d9ff(0x272)](_0xd89b4b+_0x5b1878[_0x51d9ff(0x1fe)]);if(_0x125e57=='backup'){const _0x43a6d0=/^bot-[0-9]{3}-config.json$/,_0x1bd207=_0x43a6d0[_0x51d9ff(0x142)](_0x5b1878[_0x51d9ff(0x1fe)]);if(_0x1bd207){const _0x12e976=JSON[_0x51d9ff(0x1b3)](_0x11ebdd);if(_0x12e976[_0x51d9ff(0x1a0)][0x0]){_0x12e976[_0x51d9ff(0x1a0)][0x0][_0x51d9ff(0x1fc)]=_0x51d9ff(0x2d0),_0x12e976[_0x51d9ff(0x1a0)][0x0]['apiSecret']=_0x51d9ff(0x2d0);if(_0x12e976['bot'][0x0]['apiPassword'])_0x12e976['bot'][0x0][_0x51d9ff(0x24c)]='***';}_0x11ebdd=JSON[_0x51d9ff(0x1d9)](_0x12e976,null,0x2);}if(_0x5b1878['name']=='bb-settings.json'){const _0x448fa1=JSON[_0x51d9ff(0x1b3)](_0x11ebdd);if(_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x176)])_0x448fa1['settings'][_0x51d9ff(0x176)]=![];if(_0x448fa1['settings']['bbPassword'])_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x183)]=_0x51d9ff(0x2d0);if(_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x266)])_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x266)]=_0x51d9ff(0x2d0);if(_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x1ee)])_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x1ee)]=null;if(_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x226)])_0x448fa1[_0x51d9ff(0x163)][_0x51d9ff(0x226)]='***';_0x11ebdd=JSON[_0x51d9ff(0x1d9)](_0x448fa1,null,0x2);}if(_0x5b1878[_0x51d9ff(0x1fe)]!=_0x51d9ff(0x1c5))_0x562454[_0x51d9ff(0x2c7)](_0x5b1878['name'],_0x11ebdd);}else _0x562454[_0x51d9ff(0x2c7)](_0x5b1878[_0x51d9ff(0x1fe)],_0x11ebdd);}});const _0x468899=_0x562454[_0x1c4591(0x16a)]({'base64':![],'compression':_0x1c4591(0x12c)});fs[_0x1c4591(0x256)](zippath+(_0x125e57+_0x1c4591(0x23e)),_0x468899,_0x1c4591(0xf9));}async function unzipFile(_0xbe81d0,_0x38e91a){const _0x53bb87=_0x447343;fs[_0x53bb87(0x207)](configpath,{'withFileTypes':!![]})[_0x53bb87(0x2c9)](_0x43bc96=>{const _0x553b38=_0x53bb87;if(!_0x43bc96[_0x553b38(0x2b4)]())fs[_0x553b38(0x1d6)](configpath+_0x43bc96['name']);});const _0x4c3a31=fs['readFileSync'](_0xbe81d0+_0x38e91a,'binary'),_0x3163d4=new require(_0x53bb87(0x177))(_0x4c3a31,{'base64':![],'checkCRC32':!![]});Object[_0x53bb87(0x113)](_0x3163d4[_0x53bb87(0x2e0)])[_0x53bb87(0x2c9)](_0x7d91c4=>{const _0x333844=_0x53bb87,_0x3438f1=_0x3163d4[_0x333844(0x2e0)][_0x7d91c4];fs[_0x333844(0x256)](configpath+_0x3438f1[_0x333844(0x1fe)],_0x3438f1[_0x333844(0x223)]);}),fs[_0x53bb87(0x207)](temppath,{'withFileTypes':!![]})[_0x53bb87(0x2c9)](_0x44aaa1=>{const _0x5aba95=_0x53bb87;if(!_0x44aaa1[_0x5aba95(0x2b4)]())fs[_0x5aba95(0x1d6)](temppath+_0x44aaa1[_0x5aba95(0x1fe)]);}),logger[_0x53bb87(0x2c3)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x53bb87(0x13c)]({'restore':!![]},_0x22efaa=>{});}async function getPublicIp(){const _0x1a5f13=_0x447343;try{const _0x25aeb5=await axios[_0x1a5f13(0x1ed)](_0x1a5f13(0x1b1));publicip=_0x25aeb5[_0x1a5f13(0x1dd)]['ip'];}catch(_0x58ffdc){}}async function triggerAnalytics(){const _0x38075e=_0x447343;if(!publicip)await getPublicIp();const _0x4d9543=getBotsWithMode();let _0x3e6421=0x0;_0x4d9543[_0x38075e(0x2c9)](_0x399a6f=>{const _0x3a0372=_0x38075e;if(_0x399a6f[_0x3a0372(0x15d)]===_0x3a0372(0x12a))_0x3e6421++;});const _0xc4cee2=getBotExchanges();mixpanel[_0x38075e(0x1ad)](_0x38075e(0x2e7),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4d9543[_0x38075e(0x1a6)],'numbotsenabled':_0x3e6421,'exchanges':_0xc4cee2,'environment':environment});}async function getMessages(){const _0x5840d3=_0x447343,_0x4b198f=_0x5840d3(0x1e1),_0x29e740=new GraphQLClient(_0x4b198f),_0x2d9560={'authorization':_0x5840d3(0x110)},_0x3dd5c5=serverversion['split']('.'),_0x16395a=_0x3dd5c5[0x0]+'.'+_0x3dd5c5[0x1],_0x5dc559=Math['min'](settings[_0x5840d3(0x269)],settings['lastmsgemitted']),_0x133d63={'last':parseInt(_0x5dc559),'bbm':_0x16395a},_0x45a567=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4f563b;try{_0x4f563b=await _0x29e740[_0x5840d3(0x15e)](_0x45a567,_0x133d63,_0x2d9560);}catch(_0x3e3f25){}if(_0x4f563b&&_0x4f563b[_0x5840d3(0x133)]){let _0x12879f=settings['lastmsgtelegram'];newMessages=[];for(const _0x538c2d of _0x4f563b[_0x5840d3(0x133)]){newMessages[_0x5840d3(0x194)](_0x538c2d);let _0x1f11f9=![];_0x538c2d['bbvNew']&&(updateSetting(_0x5840d3(0x172),_0x538c2d[_0x5840d3(0x111)]),_0x1f11f9=isNewerVersion(serverversion,_0x538c2d[_0x5840d3(0x111)])||serverversion==_0x538c2d['bbvNew']);if(!_0x1f11f9&&_0x538c2d[_0x5840d3(0x262)]>_0x12879f){if(_0x538c2d['bbvReceive']===_0x5840d3(0x17f)||serverversion[_0x5840d3(0x159)](_0x538c2d[_0x5840d3(0x184)])){let _0x4a63ba=''+_0x538c2d[_0x5840d3(0x2b8)]+'\x0a\x0a'+_0x538c2d[_0x5840d3(0x29a)];const _0x2cf3e6=await sendTelegramMsg(toTelegramMarkdown(_0x4a63ba),_0x5840d3(0x215));if(_0x2cf3e6)_0x12879f=_0x538c2d[_0x5840d3(0x262)];}}}updateAvailable=isNewerVersion(settings[_0x5840d3(0x172)],serverversion),updateSetting('lastmsgtelegram',_0x12879f),emitMessages();}}function emitMessages(){const _0x58e4d6=_0x447343,_0x3b7316=settings[_0x58e4d6(0x27d)];let _0x397fc4=[];newMessages[_0x58e4d6(0x2c9)](_0x4030f1=>{const _0x36d37a=_0x58e4d6;_0x4030f1[_0x36d37a(0x262)]>_0x3b7316&&_0x397fc4[_0x36d37a(0x194)](_0x4030f1);}),_0x397fc4[_0x58e4d6(0x1a6)]>0x0&&getAllClients()[_0x58e4d6(0x2c9)](_0x150171=>{const _0x381746=_0x58e4d6;getSocket(_0x150171['id'])[_0x381746(0x253)]('message',_0x397fc4);});}function confirmMessage(_0x42703d){updateSetting('lastmsgemitted',Number(_0x42703d));}function isNewerVersion(_0x56fce9,_0x594540){const _0x25b768=_0x447343,_0x28ae78=_0x594540['split']('.'),_0x14b25c=_0x56fce9[_0x25b768(0x278)]('.');for(var _0x38671c=0x0;_0x38671c<_0x14b25c[_0x25b768(0x1a6)];_0x38671c++){const _0x11f592=~~_0x14b25c[_0x38671c],_0x4cb21f=~~_0x28ae78[_0x38671c];if(_0x11f592>_0x4cb21f)return!![];if(_0x11f592<_0x4cb21f)return![];}return![];}function toTelegramMarkdown(_0x283a09){const _0x382986=_0x447343,_0x533927=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3e03ba=/\*{2}(.+?)\*{2}/gim;return _0x283a09=_0x283a09['replace'](_0x533927,'$1_$2_$3')['replace'](_0x3e03ba,_0x382986(0x16f)),_0x283a09;}async function validateConfigFile(){const _0x269b10=_0x447343,_0x84f788=dbConfig[_0x269b10(0x1ed)](_0x269b10(0x284))[_0x269b10(0x252)](_0x269b10(0x124))[_0x269b10(0x294)]()||[];if(_0x84f788[_0x269b10(0x1a6)]==0x0){let _0x4aacb1=0x0,_0x1d093f=[];const _0x4c4400=/^bot-([0-9]{3})-config.json$/,_0x22d8d3=fs[_0x269b10(0x207)](configpath);_0x22d8d3[_0x269b10(0x2c9)](_0x3f5b2a=>{const _0x9830f9=_0x269b10,_0x1c2441=_0x4c4400[_0x9830f9(0x17d)](_0x3f5b2a);if(_0x1c2441){const _0x1d8d87=_0x1c2441[0x1];let _0x4cecf8=getBotAttributes(_0x1d8d87);_0x1d093f[_0x9830f9(0x194)]({'botID':_0x1d8d87,'botname':_0x4cecf8[_0x9830f9(0x274)],'status':_0x9830f9(0xf5),'live':'stopped'}),_0x4aacb1++;}}),_0x4aacb1!=0x0&&(dbConfig[_0x269b10(0x1ed)](_0x269b10(0x284))['assign'](_0x1d093f)[_0x269b10(0x2a6)](),config=_0x1d093f,restoredConfigFile=_0x4aacb1);}}async function restoreConfigNotify(_0x5f1a31){const _0x3f1ae3=_0x447343;let _0x3e5e6d;if(restoredConfigFile==0x1)_0x3e5e6d=_0x3f1ae3(0x20d);else _0x3e5e6d=_0x3f1ae3(0x117);if(_0x5f1a31)io['to'](_0x3f1ae3(0x20b))[_0x3f1ae3(0x253)]('notification',_0x3e5e6d);else{logger['simple'](_0x3f1ae3(0x2a3)),logger[_0x3f1ae3(0x100)](_0x3e5e6d),logger[_0x3f1ae3(0x100)](_0x3f1ae3(0x2a3)),logger[_0x3f1ae3(0x100)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x3f1ae3(0x205)]!=_0x3f1ae3(0xfe))await sendTelegram(settings[_0x3f1ae3(0x1ee)],_0x3f1ae3(0x29e)+_0x3e5e6d);}}function validateCredentials(_0x3278b7,_0xfc1689){const _0x635f99=_0x447343;if(_0x3278b7[_0x635f99(0x2e8)]==settings[_0x635f99(0x28e)]&&bcrypt['compareSync'](_0x3278b7['password'],settings['bbPassword'])){if(settings[_0x635f99(0x201)])return{'allow':![],'reason':_0x635f99(0x17b),'token':null};else{const _0x214914=generateLoginToken(_0xfc1689);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x214914};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x27357b){const _0x50a735=_0x447343,_0x822279=generateLoginToken(_0x27357b);return{'allow':!![],'reason':_0x50a735(0x1e9),'token':_0x822279};}function validateAccess(_0x174f48,_0x288529,_0x443e43){const _0x31f684=_0x447343,_0x5d91c2=_0x443e43?_0x443e43:devices[_0x288529]['ip'];let _0x63238c;const _0x41780b=_0x202bb4=>{const _0x23a797=_0x5c21;if(settings['loginRequired']){if(settings[_0x23a797(0x201)]){if(telegram2FaApproved(_0x288529)){const _0x1688f6=generateLoginToken(_0x288529);return{'allow':!![],'reason':_0x23a797(0x1c2),'token':_0x1688f6};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x63238c=validToken(_0x202bb4,_0x288529),_0x63238c[_0x23a797(0x279)](_0x23a797(0x220))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x202bb4}:{'allow':![],'reason':_0x23a797(0x1fa),'token':null};}else return{'allow':!![],'reason':_0x23a797(0x2e3),'token':null};};if(settings[_0x31f684(0x27c)]){let _0x32e63b=[...settings[_0x31f684(0x2ad)],_0x31f684(0x275),_0x31f684(0x235),_0x31f684(0x2c0)];if(_0x32e63b['includes'](_0x5d91c2))return _0x41780b(_0x174f48);else{_0x63238c=validToken(_0x174f48,_0x288529);if(_0x63238c['hasOwnProperty'](_0x31f684(0x220)))return _0x41780b(_0x174f48);else{if(telegramIpApproved(_0x288529)){const _0xf38de=generateToken(_0x288529);return _0x63238c=_0x41780b(_0x174f48),_0x63238c[_0x31f684(0x213)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0xf38de}:_0x63238c;}else return settings[_0x31f684(0x12d)]?{'allow':![],'reason':_0x31f684(0x1d4),'token':null}:{'allow':![],'reason':_0x31f684(0x250),'token':null};}}}else return _0x41780b(_0x174f48);}function timelyDecrypt(_0x48f9e3,_0x5b940d=!![]){const _0x533c6c=_0x447343;if(_0x48f9e3)try{const _0x351a1e=crypt['decrypt'](secure['privateKey'],_0x48f9e3)[_0x533c6c(0x29a)],_0x25ce55=_0x351a1e['split']('|@|')[0x0],_0x378916=_0x351a1e['split'](_0x533c6c(0x1ea))[0x1],_0x37c033=new Date()[_0x533c6c(0x12b)]();if(_0x5b940d){if(_0x37c033-_0x378916<maxSecretAge*0x3e8)return _0x25ce55;else return![];}else return _0x25ce55;}catch(_0x6b0c32){return![];}else return![];}const validToken=(_0x13fc56,_0x1182df)=>{const _0x3a0953=_0x447343,_0xa312f4=devices[_0x1182df]['ip'];if(!_0x13fc56)return{'error':'No\x20authentication\x20token'};for(let _0x526e89 of blacklist){if(_0x526e89[_0x3a0953(0x1c6)]==_0x13fc56)return{'error':'Token\x20blacklisted'};}let _0x3774a3;try{_0x3774a3=jwt[_0x3a0953(0x131)](_0x13fc56,secure['secret']+_0x1182df);}catch{return{'error':_0x3a0953(0x28d)};}if(!_0x3774a3['hasOwnProperty'](_0x3a0953(0x22f))&&!_0x3774a3[_0x3a0953(0x279)](_0x3a0953(0x2e8))||!_0x3774a3[_0x3a0953(0x279)]('exp'))return{'error':_0x3a0953(0x14b)};if(!_0x3774a3[_0x3a0953(0x279)]('username')&&_0x3774a3['hasOwnProperty'](_0x3a0953(0x22f))){const {clientip:_0x4d20b9}=_0x3774a3;return _0xa312f4==_0x4d20b9?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3a0953(0x18f)};}else{if(_0x3774a3[_0x3a0953(0x279)](_0x3a0953(0x2e8))&&_0x3774a3[_0x3a0953(0x279)]('clientip')){const {username:_0x358de6,clientip:_0x545066}=_0x3774a3;return settings[_0x3a0953(0x28e)]==_0x358de6&&_0xa312f4==_0x545066?{'success':_0x3a0953(0xf6)}:{'error':_0x3a0953(0x1bc)};}}},generateLoginToken=_0xcefb0a=>{const _0x558b3f=_0x447343;if(_0xcefb0a){const _0x2ef7e4=devices[_0xcefb0a]['ip'];return jwt[_0x558b3f(0x210)]({'username':settings[_0x558b3f(0x28e)],'clientip':_0x2ef7e4},secure['secret']+_0xcefb0a,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x59277d=>{const _0x51e06a=_0x447343;if(_0x59277d){const _0x35a6c0=devices[_0x59277d]['ip'];return jwt['sign']({'clientip':_0x35a6c0},secure[_0x51e06a(0x2d2)]+_0x59277d,{'expiresIn':devices[_0x59277d][_0x51e06a(0x107)][_0x51e06a(0x129)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x26940f=>{const _0x5e1f88=_0x447343;let _0x5f5723=![];return devices[_0x26940f][_0x5e1f88(0x107)]&&devices[_0x26940f][_0x5e1f88(0x107)][_0x5e1f88(0x129)]!='reject'&&(_0x5f5723=devices[_0x26940f][_0x5e1f88(0x107)]['clientip']==devices[_0x26940f]['ip']&&new Date()[_0x5e1f88(0x12b)]()-devices[_0x26940f][_0x5e1f88(0x107)][_0x5e1f88(0x122)]<devices[_0x26940f]['telegramIpApproval'][_0x5e1f88(0x129)]*0x3c*0x3e8),_0x5f5723;},telegram2FaApproved=_0x5d2523=>{const _0x583a95=_0x447343;let _0x2d58f7=![];return devices[_0x5d2523]['telegram2FaApproval']&&devices[_0x5d2523][_0x583a95(0x23d)]['expiry']!='reject'&&(_0x2d58f7=devices[_0x5d2523][_0x583a95(0x23d)]['clientip']==devices[_0x5d2523]['ip']&&new Date()[_0x583a95(0x12b)]()-devices[_0x5d2523][_0x583a95(0x23d)][_0x583a95(0x122)]<devices[_0x5d2523]['telegram2FaApproval'][_0x583a95(0x129)]*0x3c*0x3e8),_0x2d58f7;},normalizeIP=_0x3b1406=>{const _0x1ee029=_0x447343;let _0x58fe3c=null,_0x30ee5f=null;if(ipaddr[_0x1ee029(0x1ef)](_0x3b1406)){const _0x584e20=ipaddr[_0x1ee029(0x1b3)](_0x3b1406);_0x584e20[_0x1ee029(0x120)]()===_0x1ee029(0x240)?(_0x584e20[_0x1ee029(0x1c0)]()&&(_0x58fe3c=_0x584e20[_0x1ee029(0x21d)]()['toString']()),_0x30ee5f=_0x584e20[_0x1ee029(0x21f)]()):(_0x58fe3c=_0x584e20['toString'](),_0x30ee5f=_0x584e20[_0x1ee029(0x2cd)]()[_0x1ee029(0x21f)]());}return{'show':_0x58fe3c?_0x58fe3c:_0x30ee5f,'store':_0x30ee5f};};function formatDate(_0x1c7f5f){const _0x5a3613=_0x447343;return _0x1c7f5f[_0x5a3613(0x152)]()+'/'+(_0x1c7f5f[_0x5a3613(0x290)]()+0x1)[_0x5a3613(0x21f)]()['padStart'](0x2,'0')+'/'+_0x1c7f5f[_0x5a3613(0x118)]()[_0x5a3613(0x21f)]()[_0x5a3613(0x1e0)](0x2,'0')+'\x20'+_0x1c7f5f[_0x5a3613(0xfb)]()[_0x5a3613(0x21f)]()[_0x5a3613(0x1e0)](0x2,'0')+':'+_0x1c7f5f[_0x5a3613(0x1e8)]()[_0x5a3613(0x21f)]()[_0x5a3613(0x1e0)](0x2,'0')+':'+_0x1c7f5f[_0x5a3613(0x174)]()['toString']()[_0x5a3613(0x1e0)](0x2,'0');}function sleep(_0xeaf93c){return new Promise(_0x5eef5e=>setTimeout(_0x5eef5e,_0xeaf93c));}