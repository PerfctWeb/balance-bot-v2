const _0x1f7dcf=_0x2bd8;(function(_0x5cf329,_0x1068ff){const _0x333c37=_0x2bd8,_0x2358b0=_0x5cf329();while(!![]){try{const _0x31dd8c=-parseInt(_0x333c37(0x298))/0x1+parseInt(_0x333c37(0x232))/0x2+parseInt(_0x333c37(0x243))/0x3+parseInt(_0x333c37(0x316))/0x4+parseInt(_0x333c37(0x31e))/0x5+parseInt(_0x333c37(0x34c))/0x6*(parseInt(_0x333c37(0x38b))/0x7)+-parseInt(_0x333c37(0x276))/0x8;if(_0x31dd8c===_0x1068ff)break;else _0x2358b0['push'](_0x2358b0['shift']());}catch(_0x1a5e2d){_0x2358b0['push'](_0x2358b0['shift']());}}}(_0x5d2a,0x9cc65));const _0x44675c=function(){let _0x1659e7=!![];return function(_0x2e3694,_0x3338e0){const _0x55076d=_0x1659e7?function(){if(_0x3338e0){const _0x590a01=_0x3338e0['apply'](_0x2e3694,arguments);return _0x3338e0=null,_0x590a01;}}:function(){};return _0x1659e7=![],_0x55076d;};}(),_0x23a7ff=_0x44675c(this,function(){const _0x950e8=_0x2bd8;return _0x23a7ff[_0x950e8(0x283)]()[_0x950e8(0x2f3)]('(((.+)+)+)+$')[_0x950e8(0x283)]()['constructor'](_0x23a7ff)[_0x950e8(0x2f3)](_0x950e8(0x25b));});_0x23a7ff();'use strict';process[_0x1f7dcf(0x37e)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x1f7dcf(0x2cf)),fs=require('fs'),fns=require(_0x1f7dcf(0x292)),low=require('lowdb'),FileSync=require(_0x1f7dcf(0x28a)),path=require(_0x1f7dcf(0x1bc)),crypto=require('crypto'),Crypt=require(_0x1f7dcf(0x23e))['Crypt'],RSA=require('hybrid-crypto-js')[_0x1f7dcf(0x38e)],bcrypt=require(_0x1f7dcf(0x307)),jwt=require(_0x1f7dcf(0x374)),ipaddr=require(_0x1f7dcf(0x327)),argv=require(_0x1f7dcf(0x210))(process[_0x1f7dcf(0x285)]['slice'](0x2))[_0x1f7dcf(0x285)],uuidRandom=require(_0x1f7dcf(0x347)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x1f7dcf(0x1e3)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x1f7dcf(0x326)),fileUpload=require(_0x1f7dcf(0x3ae)),{networkInterfaces}=require('os'),PORT=argv[_0x1f7dcf(0x341)]||_0x1f7dcf(0x394),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x1f7dcf(0x26f)](_0x1f7dcf(0x2e4)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x1f7dcf(0x27e)](0x1));const HOST=argv[_0x1f7dcf(0x2d2)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x1f7dcf(0x25e)][_0x1f7dcf(0x27c)];let bbpath=_0x1f7dcf(0x20f),bbpath2='';const botfile=_0x1f7dcf(0x335),configfile='bb-config.json',settingsfile=_0x1f7dcf(0x373),securefile=_0x1f7dcf(0x310),environment=require('./'+bbpath2+_0x1f7dcf(0x26c))[_0x1f7dcf(0x314)]||_0x1f7dcf(0x29a),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x1f7dcf(0x2e7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x1f7dcf(0x1b4)+userID+'/':bbpath+_0x1f7dcf(0x1b4),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x1f7dcf(0x1c6)+userID+'/':bbpath+_0x1f7dcf(0x1c6),zippath=userID?bbpath+_0x1f7dcf(0x201)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x1f7dcf(0x33b)](logspath+_0x1f7dcf(0x302),{'flags':'a'}),temppath=userID?bbpath+_0x1f7dcf(0x255)+userID+'/':bbpath+'temp/';!fs[_0x1f7dcf(0x2e7)](configpath)&&fs[_0x1f7dcf(0x1a8)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x1f7dcf(0x1a8)](configbackuppath);!fs[_0x1f7dcf(0x2e7)](logspath)&&fs[_0x1f7dcf(0x1a8)](logspath);!fs['existsSync'](zippath)&&fs[_0x1f7dcf(0x1a8)](zippath);!fs[_0x1f7dcf(0x2e7)](temppath)&&fs[_0x1f7dcf(0x1a8)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1f7dcf(0x2ec)]({'bots':[]})[_0x1f7dcf(0x39b)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1f7dcf(0x2ec)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x1f7dcf(0x39b)]();function _0x5d2a(){const _0x58e3f0=['CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','\x20|\x20','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','data','alias','\x1b[0m','kill','2372734ilsLEM','Notifications\x20enabled\x0a','output-003.log','connected','Unauthorized\x20attempt\x20to\x20get\x20messages','f2aRequired','blacklist','chat','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','emitHistory','hybrid-crypto-js','sendMetricsTelegram','internal','padStart','mode','213231iPUvuK','help','#RES#\x20if\x20running\x20locally\x0a','unlinkSync','storeFiat','\x1b[34m','#RES#','update-bb','find','token','All\x20bots\x20running\x20right\x20now','reply','Unauthorized\x20attempt\x20to\x20update\x20bot','verify','\x1b[33m','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','rmSync','reinstall_yes','temp/','_data','Error\x20while\x20deleting\x20config\x20files:\x20','reload','decrypt','track','(((.+)+)+)+$','emit','writeFileSync','versions','Node.js\x20v','file','family','1000','disconnect','static','files','bot-','toggle','lastmsgtelegram','secret','enable','CoinMarketCap\x20API\x20key\x20validated','version.json','Error\x20details:','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','log','version','uuid','hasOwnProperty','\x20minutes','express','success','13561088MCiKyS','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Telegram\x20error:','store','botname','length','node','bbvReceive','exit','Starting\x20#RED#Balance\x20Bot\x20v','restart','\x20mode','value','toString','apiSecret','argv','test','temporary\x20token\x20generated','parse','reinstall','lowdb/adapters/FileSync','getSeconds','http','bbPassword','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20add\x20bot','command','ipv6','date-fns','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','generate','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Starting\x20new\x20bot\x20|\x20Bot\x20','All','940522xnZYBa','getHours','production','function','restore-backup-file','SIGINT','/upload-backup','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','push','HTML','User\x20has\x20been\x20validated','password','/restart\x20-\x20restart\x20bot(s)\x0a','clientip','output-002.log','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','copyFileSync','store-configuration','Restore\x20process\x20confirmed','alerts','Login\x20rejected','randomBytes','Yes','any','No\x20bots\x20running\x20right\x20now','editMessageReplyMarkup','reason','|@|','all','params','new','2FA','start','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','-events.json','get-logs','names','config_alerts','settings.','Orders','accept','stringify','reinstall_no','split','catch','removeAllListeners','\x20to\x20','pidRefreshToken','store-settings','botmanager','Error\x20removing\x20old\x20backup\x20files:','\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','child_process','telegramEnabled','logout','host','toggle-bot-mode','address\x20already\x20in\x20use','Starting\x20(','enabled','.zip','index.html','remoteAddress','/:bot/support','inlineKeyboard','privateKey','format','bot','/download/:type','storeHeadless','Restore\x20process\x20aborted','<b>Balance\x20Bot\x20Status:</b>\x0a','startsWith','Error:\x20Invalid\x20argument\x20','RSA-OAEP','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','existsSync','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','listen','remove','bbvNew','defaults','Restoring\x20bot(s)\x20from\x20backup','string','delete-alerts','sendFile','isValid','Unauthorized\x20attempt\x20to\x20confirm\x20message','search','loginRequired','Notifications\x20disabled\x0a',':\x20Bot\x20Mgr\x20>\x20','resetpw_no','-performance.json','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','telegramIpApproval','backup-full','2FA\x20login\x20required','forEach','userid','handshake','cloneDeep','isIPv4MappedAddress','/output-000.log','temporary\x20access\x20rejected','/help\x20-\x20show\x20available\x20commands\x0a','fork','$1_$2_$3','bcryptjs','Unauthorized\x20attempt\x20to\x20log\x20out','tempaccess_30_','onepagemode','/disable\x20-\x20disable\x20notifications\x0a','Alerts','showname','Notifications\x20types:\x20','notification','bb-secure.json','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','manual','auto','environment','includes','3506240ePiJeU','stop','backup-files','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','2FA\x20login\x20rejected','disable','reset-password','connection','4454355AeFIYZ','getPortfolio','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20get\x20events','restart_','getDate','/:bot/coins','store-headless','util','ipaddr.js','name','settings','2FA\x20login\x20token\x20generated','backup','error','binary','use','Unauthorized\x20attempt\x20to\x20download\x20','Starting\x20Balance\x20Bot\x20update','Session\x20expired\x20for\x20user\x20...','BCT','yes','off_','bot.js','sort',')\x20\x20\x20|\x20Bot\x20','expiry','\x1b[35m','/metrics\x20-\x20show\x20bot\x20performance\x0a','createWriteStream','getUTCHours','DEFLATE','login','launch','marketcapApi','port','order','size','-results.json','map','backup-full.zip','uuid-random','statSync','reject','config_all','SIGTERM','20508PYunRH','telegramEvents','latestversion','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','tempaccess_5_','mtime','hex','127.0.0.1','Password\x20has\x20been\x20reset\x20to:\x20','getTime','temporary\x20access\x20timeout','portfolio','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','build2','Temporary\x20access\x20rejected','Markdown','once','number','Invalid\x20IP\x20address','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','set','login\x20token\x20valid','args','orders','Backup\x20file\x20uploaded','match','exchange','[ip-address]','/names\x20-\x20show\x20bot\x20names\x0a','telegramToken','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','ipc','on_','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','place-order','whitelist',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','type','bb-settings.json','jsonwebtoken','new-disabled','range','Setting\x20access:\x20','publicKey','get','access\x20timeout','metrics','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','\x20|\x20client:\x20...','env','Starting\x20Balance\x20Bot\x20reinstallation','\x20|\x20user:\x20...','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','apiPassword','\x1b[36m','randomFillSync','update_no','restore_no_','Ok,\x20will\x20send\x20alert\x20notifications\x20only','staging','code','***','518gGXvLU','backup-full@','You\x20can\x20use\x20the\x20following\x20commands:\x0a','RSA','socket.io','running','*$1*','invalid\x20credentials','kind','3000','Access\x20enabled\x20for\x20','getStartingBalances','/:bot/portfolio','login2fa_reject_','debug','button','write','whitelistEnabled','telegramUsername','/:bot/history','Notifications\x20enabled','Token\x20blacklisted','update-bot','sendMessage','/update\x20-\x20update\x20Balance\x20Bot\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','output-001.log','simple','Enabled\x20Bot\x20','2FA\x20required','replace','get-messages','#RES#\x20','close','Login\x20accepted','express-fileupload','IPv4','placeOrder','createServer','login2fa_','sendPortfolioTelegram','mkdirSync','assign','inherit','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','storeConfiguration','Invalid\x20username\x20or\x20IP\x20address','/start','isDirectory','Deleted\x20Bot\x20','socket','warning','-----------------------------------------------------------------------------------','config/','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','toggle_','exp','logs','timeshift','filter','exec','path','portfolio_','Logged\x20out\x20user\x20...','readFileSync','event','Restore\x20backup\x20file\x20','node-zip',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','headers','lastmsgemitted','logs/','access','0.0.0','telegram','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','full','apiKey','text','ETH','hashSync','logged\x20out','initclient','show-config','sign','/:bot/performance','Bot\x20','build','sockets','Which\x20bot\x20do\x20you\x20want\x20to\x20start?',')\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','login\x20token\x20generated','Your\x20installation\x20is\x20already\x20up\x20to\x20date','update','status','address','restore_yes_','keys','headless','mixpanel','callback','action','telegram2FaApproval','Idling\x20(','telegrammsg','init','join','send','Restarting\x20Bot\x20','temporary\x20access\x20not\x20allowed','Server','private','timestamp','tempaccess_15_','Disabled\x20Bot\x20','auth','from','allow','encryptedUuid','stopped','bbUsername','tkn','All\x20bots','messages','readdirSync','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','getMinutes','15\x20min','config_orders','zip/','pidExpireLogin','botID','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','config','Logged\x20in\x20user\x20...','Backup\x20file\x20unzipped\x20and\x20stored','then','\x20-\x20','bots','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','getFullYear','************','bb/','yargs/yargs','No\x20authentication\x20token','min','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','backupfile','Unauthorized\x20attempt\x20to\x20update\x20settings','6b67f3d61ee94b8f5c80b4affef4c4d9','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','telegramChatId','username','disabled','secure','cancelLoading','message','sortBy','referer','started','-config.json','show','post','toIPv4MappedAddress','Invalid\x20authentication\x20token\x20(2)','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','live','slice'];_0x5d2a=function(){return _0x58e3f0;};return _0x5d2a();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1f7dcf(0x2ec)]({'secure':{},'blacklist':[]})[_0x1f7dcf(0x39b)]();function _0x2bd8(_0x37c8db,_0x32f4eb){const _0x208db6=_0x5d2a();return _0x2bd8=function(_0x23a7ff,_0x44675c){_0x23a7ff=_0x23a7ff-0x1a8;let _0x5d2a3e=_0x208db6[_0x23a7ff];return _0x5d2a3e;},_0x2bd8(_0x37c8db,_0x32f4eb);}let crypt=new Crypt({'md':'sha256','rsaStandard':_0x1f7dcf(0x2e5)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1f7dcf(0x1e9)](_0x1f7dcf(0x217),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings['telegramToken']!=_0x1f7dcf(0x38a))&&settings[_0x1f7dcf(0x39d)]&&settings[_0x1f7dcf(0x39d)]!='')initTelegram();const parseColor=(_0x36b796,_0x5fc9a3)=>{const _0x1840ea=_0x1f7dcf,_0x25645c=/#[A-Z]{3}#/g;if(typeof _0x36b796==_0x1840ea(0x2ee)){!_0x5fc9a3?_0x36b796=_0x36b796[_0x1840ea(0x3a9)](_0x25645c,''):(_0x36b796=_0x36b796[_0x1840ea(0x3a9)](/#BLU#/g,_0x1840ea(0x248)),_0x36b796=_0x36b796[_0x1840ea(0x3a9)](/#RED#/g,'\x1b[31m'),_0x36b796=_0x36b796[_0x1840ea(0x3a9)](/#YEL#/g,_0x1840ea(0x251)),_0x36b796=_0x36b796[_0x1840ea(0x3a9)](/#MAG#/g,_0x1840ea(0x339)),_0x36b796=_0x36b796[_0x1840ea(0x3a9)](/#CYA#/g,_0x1840ea(0x383)),_0x36b796=_0x36b796[_0x1840ea(0x3a9)](/#RES#/g,_0x1840ea(0x230)));;}return _0x36b796;},logger={'screen':_0xf5b942=>{const _0x3bfefb=_0x1f7dcf;console[_0x3bfefb(0x26f)](parseColor(_0xf5b942,!![]));},'simple':_0x24981b=>{const _0x588806=_0x1f7dcf;console[_0x588806(0x26f)](parseColor(_0x24981b,!![])),loggerfile[_0x588806(0x39b)](util[_0x588806(0x2dd)](parseColor(_0x24981b,![]))+'\x0a');},'full':async _0x323a3e=>{const _0x37a53c=_0x1f7dcf,_0x43260a=getTimeStamp()+_0x37a53c(0x2f6)+_0x323a3e;console[_0x37a53c(0x26f)](parseColor(_0x43260a,!![])),loggerfile[_0x37a53c(0x39b)](util[_0x37a53c(0x2dd)](parseColor(_0x43260a,![]))+'\x0a');if(tgBot&&settings[_0x37a53c(0x219)]&&settings[_0x37a53c(0x34d)]!=_0x37a53c(0x364))await sendTelegram(settings[_0x37a53c(0x219)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x323a3e,![]));},'debug':async(_0xf8da60,_0x147456='')=>{const _0x1e9a82=_0x1f7dcf,_0x99103c=getTimeStamp()+_0x1e9a82(0x371)+_0xf8da60;if(debugging)console['log'](parseColor(_0x99103c,!![]));loggerfile[_0x1e9a82(0x39b)](util[_0x1e9a82(0x2dd)](parseColor(_0x99103c,![]))+'\x0a');if(_0x147456){if(debugging)console['log'](_0x147456);loggerfile[_0x1e9a82(0x39b)](util[_0x1e9a82(0x2dd)](_0x147456)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x1b8fd3){const _0x29ee07=_0x1f7dcf;_0x1b8fd3[_0x29ee07(0x283)]()[_0x29ee07(0x315)](_0x29ee07(0x2d4))?(logger[_0x29ee07(0x3a6)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x1b8fd3['port']+_0x29ee07(0x249)),process[_0x29ee07(0x1eb)]({'terminate':!![]},_0x1ad2b2=>{})):logger['simple'](_0x1b8fd3);}),process['on'](_0x1f7dcf(0x27e),()=>{const _0x2ffe4e=_0x1f7dcf;stopAllBots(),process[_0x2ffe4e(0x27e)](0x0);}),process['on']('SIGTERM',()=>{const _0x5b2b71=_0x1f7dcf;stopAllBots(),process[_0x5b2b71(0x27e)](0x0);}),process['on'](_0x1f7dcf(0x29d),()=>{const _0x5590e4=_0x1f7dcf;stopAllBots(),process[_0x5590e4(0x27e)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1f7dcf(0x270)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1f7dcf(0x274)),app=express(),http=require(_0x1f7dcf(0x28c))[_0x1f7dcf(0x3b1)](app);app[_0x1f7dcf(0x32e)](fileUpload({'useTempFiles':!![]})),app['get'](_0x1f7dcf(0x2df),async(_0x58571d,_0x555362)=>{const _0x409a63=_0x1f7dcf,_0x2f8594=_0x58571d[_0x409a63(0x2b6)][_0x409a63(0x372)],_0x541560=getClientsWithBotID('botmanager'),_0x573257=_0x58571d['headers'][_0x409a63(0x271)],_0x19eaa7=timelyDecrypt(_0x573257,![]),_0x10818d=_0x541560[_0x409a63(0x24b)](_0x22e41c=>_0x22e41c['uuid']==_0x19eaa7);if(_0x10818d){const _0x584944=normalizeIP(_0x58571d[_0x409a63(0x1b1)][_0x409a63(0x2d9)])[_0x409a63(0x279)],_0x16f476=_0x58571d[_0x409a63(0x1c4)][_0x409a63(0x1f9)];if(validateAccess(_0x16f476,_0x19eaa7,_0x584944)[_0x409a63(0x1f5)])_0x2f8594=='backup'&&await backupConfigFiles(),await zipFiles(_0x2f8594),_0x555362['download'](zippath+(_0x2f8594+'.zip'),_0x16f779=>{const _0x1e9802=_0x409a63;_0x16f779&&(logger['full']('Failed\x20to\x20download\x20'+_0x2f8594),logger[_0x1e9802(0x3a6)](_0x16f779));});else logger[_0x409a63(0x1cb)](_0x409a63(0x32f)+_0x2f8594+'\x20(1)');}else logger[_0x409a63(0x1cb)](_0x409a63(0x32f)+_0x2f8594+'\x20(2)');}),app[_0x1f7dcf(0x224)](_0x1f7dcf(0x29e),async(_0x46f45d,_0x4c1228)=>{const _0x3df963=_0x1f7dcf,_0x5b4900=getClientsWithBotID('botmanager'),_0x332917=_0x46f45d[_0x3df963(0x1c4)]['uuid'],_0x37e574=timelyDecrypt(_0x332917,![]),_0x448ee5=_0x5b4900[_0x3df963(0x24b)](_0x31ab72=>_0x31ab72[_0x3df963(0x271)]==_0x37e574);logger[_0x3df963(0x399)](_0x3df963(0x365));if(_0x448ee5){const _0x1d284c=normalizeIP(_0x46f45d[_0x3df963(0x1b1)][_0x3df963(0x2d9)])[_0x3df963(0x279)],_0x5edbad=_0x46f45d['headers'][_0x3df963(0x1f9)];if(validateAccess(_0x5edbad,_0x37e574,_0x1d284c)[_0x3df963(0x1f5)]){if(_0x46f45d['files']){const _0x230a79=_0x46f45d[_0x3df963(0x265)][_0x3df963(0x215)];await _0x230a79['mv'](temppath+_0x230a79[_0x3df963(0x328)]),_0x4c1228[_0x3df963(0x1eb)]({'status':!![],'message':'File\x20uploaded'});const _0xde0297=getBotsWithMode();_0xde0297['length']>0x0?confirmRestore(temppath,_0x230a79[_0x3df963(0x328)]):unzipFile(temppath,_0x230a79['name']);}}else logger[_0x3df963(0x1cb)](_0x3df963(0x1fd));}else logger['full'](_0x3df963(0x2f9));}),app[_0x1f7dcf(0x32e)](express[_0x1f7dcf(0x264)](path[_0x1f7dcf(0x1ea)](__dirname,bbpath2,_0x1f7dcf(0x35a)))),app[_0x1f7dcf(0x32e)](express['static'](path[_0x1f7dcf(0x1ea)](__dirname,bbpath2,_0x1f7dcf(0x1d6)))),app[_0x1f7dcf(0x379)]('/',function(_0x11627a,_0x1827ec){const _0x1cf940=_0x1f7dcf;_0x1827ec[_0x1cf940(0x2f0)](path[_0x1cf940(0x1ea)](__dirname,bbpath2,_0x1cf940(0x35a),_0x1cf940(0x2d8)));}),app[_0x1f7dcf(0x379)]('/:bot',function(_0x3abd06,_0x56b972){const _0x113656=_0x1f7dcf;_0x56b972[_0x113656(0x2f0)](path[_0x113656(0x1ea)](__dirname,bbpath2,'build',_0x113656(0x2d8)));}),app[_0x1f7dcf(0x379)](_0x1f7dcf(0x397),(_0x2f366f,_0x2a5fb3)=>{const _0x4400ff=_0x1f7dcf;_0x2a5fb3[_0x4400ff(0x2f0)](path[_0x4400ff(0x1ea)](__dirname,bbpath2,_0x4400ff(0x1d6),_0x4400ff(0x2d8)));}),app[_0x1f7dcf(0x379)](_0x1f7dcf(0x1d4),(_0x1f3547,_0x16243c)=>{const _0x38c80d=_0x1f7dcf;_0x16243c[_0x38c80d(0x2f0)](path[_0x38c80d(0x1ea)](__dirname,bbpath2,'build',_0x38c80d(0x2d8)));}),app[_0x1f7dcf(0x379)](_0x1f7dcf(0x324),(_0x47c551,_0x2c7fb0)=>{const _0x1af44a=_0x1f7dcf;_0x2c7fb0['sendFile'](path[_0x1af44a(0x1ea)](__dirname,bbpath2,_0x1af44a(0x1d6),'index.html'));}),app[_0x1f7dcf(0x379)](_0x1f7dcf(0x39e),(_0x87b53c,_0x5e2607)=>{const _0x44785f=_0x1f7dcf;_0x5e2607[_0x44785f(0x2f0)](path[_0x44785f(0x1ea)](__dirname,bbpath2,_0x44785f(0x1d6),_0x44785f(0x2d8)));}),app[_0x1f7dcf(0x379)]('/:bot/configuration',(_0x2e14bc,_0x121a50)=>{const _0x589d42=_0x1f7dcf;_0x121a50[_0x589d42(0x2f0)](path['join'](__dirname,bbpath2,_0x589d42(0x1d6),_0x589d42(0x2d8)));}),app[_0x1f7dcf(0x379)](_0x1f7dcf(0x2da),(_0xc30adc,_0x57d0c4)=>{const _0x4ea35a=_0x1f7dcf;_0x57d0c4['sendFile'](path[_0x4ea35a(0x1ea)](__dirname,bbpath2,_0x4ea35a(0x1d6),'index.html'));});if(HOST)http[_0x1f7dcf(0x2e9)](PORT,HOST);else http[_0x1f7dcf(0x2e9)](PORT);const io=require(_0x1f7dcf(0x38f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x377958=_0x1f7dcf;let _0x547681=_0x377958(0x368);const _0x5f3a68=networkInterfaces(),_0x45ef30={};for(const _0x527b3e of Object[_0x377958(0x1e1)](_0x5f3a68)){for(const _0x11b3c5 of _0x5f3a68[_0x527b3e]){if((_0x11b3c5[_0x377958(0x261)]==_0x377958(0x3af)||_0x11b3c5['family']==0x4)&&!_0x11b3c5[_0x377958(0x240)]){const _0x190851=ipaddr[_0x377958(0x288)](_0x11b3c5[_0x377958(0x1df)])[_0x377958(0x376)]();_0x190851!=_0x377958(0x1ef)&&(!_0x45ef30[_0x527b3e]&&(_0x45ef30[_0x527b3e]=[]),_0x45ef30[_0x527b3e]['push'](_0x11b3c5['address']),_0x547681=_0x11b3c5[_0x377958(0x1df)]);}}}return{'serverip':_0x547681,'netinterfaces':_0x45ef30};}async function startServer(){const _0x9ccd84=_0x1f7dcf,{serverip:_0x10d18e,netinterfaces:_0x30395a}=getServerIP();logger[_0x9ccd84(0x3a6)](''),logger[_0x9ccd84(0x3a6)](_0x9ccd84(0x1b3)),await logger[_0x9ccd84(0x1cb)](_0x9ccd84(0x27f)+serverversion+_0x9ccd84(0x3ab)+(environment==_0x9ccd84(0x388)?'(staging)':'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x9ccd84(0x245))+('=>\x20Go\x20to\x20#CYA#http://'+_0x10d18e+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x9ccd84(0x3a6)](_0x9ccd84(0x1b3));if(config[_0x9ccd84(0x27b)]!=0x0)for(const _0x5795ec of config){const _0x35d566=_0x5795ec[_0x9ccd84(0x242)]=='auto'?'a':'m';if(_0x5795ec[_0x9ccd84(0x1de)]==_0x9ccd84(0x2d6)||_0x5795ec[_0x9ccd84(0x1de)]==_0x9ccd84(0x2b7))await logger[_0x9ccd84(0x1cb)](_0x9ccd84(0x2d5)+_0x35d566+_0x9ccd84(0x1d9)+_0x5795ec[_0x9ccd84(0x203)]+'\x20|\x20'+_0x5795ec[_0x9ccd84(0x27a)]),startBot([_0x5795ec[_0x9ccd84(0x203)],userID],{'cwd':bbpath},function(_0x40541e){const _0x450f85=_0x9ccd84;if(_0x40541e)logger[_0x450f85(0x1cb)](_0x40541e);});else(_0x5795ec[_0x9ccd84(0x1de)]==_0x9ccd84(0x21b)||_0x5795ec[_0x9ccd84(0x1de)]=='new-disabled')&&await logger['full'](_0x9ccd84(0x1e7)+_0x35d566+_0x9ccd84(0x337)+_0x5795ec[_0x9ccd84(0x203)]+_0x9ccd84(0x22c)+_0x5795ec[_0x9ccd84(0x27a)]);}else!newBot&&logger[_0x9ccd84(0x3a6)](_0x9ccd84(0x311));if(newBot)addBot();logger[_0x9ccd84(0x3a6)](_0x9ccd84(0x1b3)),logger[_0x9ccd84(0x3a6)](''),await logger['debug'](_0x9ccd84(0x25f)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x30395a);}function startSocket(){const _0x21856f=_0x1f7dcf;io['on'](_0x21856f(0x31d),_0x75f170=>{const _0x16330c=_0x21856f;let _0x16ae1f,_0x5316eb,_0x251736,_0xf9573d,_0x574e9c;const _0x392d48=_0x75f170[_0x16330c(0x2ff)][_0x16330c(0x1c4)][_0x16330c(0x220)];_0x5316eb=_0x392d48[_0x16330c(0x366)](/bot[0-9]{3}/);if(_0x5316eb)_0x251736=_0x5316eb[0x0][_0x16330c(0x366)](/[0-9]{3}/);if(_0x251736)_0x16ae1f=_0x251736[0x0];else _0x16ae1f=_0x16330c(0x2cb);const _0xb879a2=_0x75f170[_0x16330c(0x2ff)][_0x16330c(0x1f3)][_0x16330c(0x1f6)];if(!_0xb879a2)_0x75f170[_0x16330c(0x25c)]('status',{'publicKey':secure['publicKey']});else{_0xf9573d=timelyDecrypt(_0xb879a2,![]);if(!_0xf9573d)_0x75f170[_0x16330c(0x25c)]('status',{'publicKey':secure[_0x16330c(0x378)]});else{_0x574e9c=normalizeIP(_0x75f170['conn'][_0x16330c(0x2d9)])[_0x16330c(0x279)];if(!devices[_0xf9573d])devices[_0xf9573d]={'uuid':_0xf9573d,'access':{'token':null}};devices[_0xf9573d]['ip']=_0x574e9c;const _0x5d764a=addClient(_0x75f170['id'],_0xf9573d,_0x16ae1f);setAccess(_0x5d764a),emitMessages(),_0x75f170['on']('login',_0x541e42=>{const _0x569d79=_0x16330c,_0x523d88=timelyDecrypt(_0x541e42['password'],!![],_0x569d79(0x2b4));if(_0x523d88){_0x541e42={'username':_0x541e42[_0x569d79(0x21a)],'password':_0x523d88},devices[_0xf9573d]['access']=validateCredentials(_0x541e42,_0xf9573d);if(devices[_0xf9573d][_0x569d79(0x1c7)][_0x569d79(0x1f5)]==![]&&devices[_0xf9573d][_0x569d79(0x1c7)][_0x569d79(0x2b3)]=='2FA\x20login\x20required')_0x75f170[_0x569d79(0x25c)](_0x569d79(0x1de),{'access':devices[_0xf9573d]['access']}),loginAccess2FA(_0xf9573d,_0x574e9c);else{if(devices[_0xf9573d][_0x569d79(0x1c7)][_0x569d79(0x1f5)]==![]&&devices[_0xf9573d][_0x569d79(0x1c7)][_0x569d79(0x2b3)]==_0x569d79(0x392))_0x75f170[_0x569d79(0x25c)]('status',{'access':devices[_0xf9573d][_0x569d79(0x1c7)]});else devices[_0xf9573d][_0x569d79(0x1c7)][_0x569d79(0x1f5)]&&devices[_0xf9573d][_0x569d79(0x1c7)][_0x569d79(0x2b3)]==_0x569d79(0x1db)&&(getClientsWithUuid(_0xf9573d)[_0x569d79(0x2fd)](_0x2654a5=>{setAccess(_0x2654a5);}),logger[_0x569d79(0x399)](_0x569d79(0x207)+_0xf9573d[_0x569d79(0x22a)](-0x8)),setTokenRefresh(_0xf9573d),setSessionTimeout(_0x569d79(0x33e),_0xf9573d));}}else logger[_0x569d79(0x1cb)](_0x569d79(0x23b));}),_0x75f170['on'](_0x16330c(0x31c),()=>{resetPassword();}),_0x75f170['on']('disconnect',_0x3e9fb4=>{removeClient(_0x75f170['id']);}),_0x16ae1f==_0x16330c(0x2cb)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x80583a){const _0xa9897b=_0x1f7dcf;if(_0x80583a!=_0xa9897b(0x2cb)&&config[_0xa9897b(0x1cc)]!=''){if(pid[_0x80583a])pid[_0x80583a][_0xa9897b(0x1eb)]({'function':_0xa9897b(0x1d1),'args':null});}_0x80583a!=_0xa9897b(0x2cb)&&broadcastToBots(_0xa9897b(0x20b),JSON[_0xa9897b(0x2c3)](config));}function reloadBotManager(){const _0x17c0e3=_0x1f7dcf;getClientsWithBotID(_0x17c0e3(0x2cb))['forEach'](_0xed1495=>{const _0x47c332=_0x17c0e3;getSocket(_0xed1495['id'])['emit'](_0x47c332(0x1de),{'access':{'allow':![],'reason':_0x47c332(0x258),'token':null}});});}function getSocket(_0x7241f8){const _0x51c9c7=_0x1f7dcf;return io[_0x51c9c7(0x1d7)][_0x51c9c7(0x1d7)][_0x51c9c7(0x379)](_0x7241f8);}function setAccess(_0x3594f6){const _0x477f86=_0x1f7dcf,_0x216aa5=getSocket(_0x3594f6['id']),_0x1c305d=_0x3594f6['uuid'],_0x22f919=_0x3594f6['bot'];devices[_0x1c305d]['access']=validateAccess(devices[_0x1c305d]['access'][_0x477f86(0x24c)],_0x1c305d),logger[_0x477f86(0x399)](_0x477f86(0x377)+devices[_0x1c305d][_0x477f86(0x1c7)][_0x477f86(0x2b3)]+_0x477f86(0x37d)+_0x3594f6['id'][_0x477f86(0x22a)](-0x8)+_0x477f86(0x380)+_0x1c305d[_0x477f86(0x22a)](-0x8)),_0x216aa5[_0x477f86(0x1ea)](_0x1c305d);if(devices[_0x1c305d][_0x477f86(0x1c7)]['allow']){_0x216aa5[_0x477f86(0x1ea)](_0x22f919);if(_0x22f919==_0x477f86(0x2cb))initializeSocketBotManager(_0x216aa5);else initializeSocketBot(_0x216aa5);initClient(_0x22f919);}devices[_0x1c305d][_0x477f86(0x1c7)][_0x477f86(0x24c)]&&devices[_0x1c305d][_0x477f86(0x1c7)]['reason']==_0x477f86(0x287)&&setSessionTimeout(_0x477f86(0x2b8),_0x1c305d),devices[_0x1c305d][_0x477f86(0x1c7)][_0x477f86(0x24c)]&&devices[_0x1c305d][_0x477f86(0x1c7)][_0x477f86(0x2b3)]==_0x477f86(0x32a)&&setSessionTimeout('login',_0x1c305d),_0x216aa5[_0x477f86(0x25c)](_0x477f86(0x1de),{'status':_0x3594f6['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1c305d][_0x477f86(0x1c7)],'externalip':devices[_0x1c305d]['ip'],'publicKey':secure[_0x477f86(0x378)],'userid':settings[_0x477f86(0x2fe)],'validInstallation':validInstallation}),devices[_0x1c305d]['access'][_0x477f86(0x1f5)]==![]&&devices[_0x1c305d][_0x477f86(0x1c7)][_0x477f86(0x2b3)]==_0x477f86(0x3a8)&&temporaryAccess2FA(_0x1c305d,devices[_0x1c305d]['ip']);}function setSessionTimeout(_0x11b4a9,_0x5905ac){const _0xe26148=_0x1f7dcf;let _0x4d8f45;if(_0x11b4a9==_0xe26148(0x33e))_0x4d8f45=loginExpiry*0x3c*0x3e8;else _0x4d8f45=devices[_0x5905ac][_0xe26148(0x2fa)][_0xe26148(0x338)]*0x3c*0x3e8-(new Date()[_0xe26148(0x355)]()-devices[_0x5905ac][_0xe26148(0x2fa)][_0xe26148(0x1f0)]);if(devices[_0x5905ac][_0xe26148(0x202)])clearTimeout(devices[_0x5905ac][_0xe26148(0x202)]);devices[_0x5905ac][_0xe26148(0x202)]=setTimeout(()=>{const _0x3e8f36=_0xe26148;if(devices[_0x5905ac][_0x3e8f36(0x2c9)])clearTimeout(devices[_0x5905ac][_0x3e8f36(0x2c9)]);removeSocketListeners(_0x5905ac),addBlacklist(_0x5905ac),devices[_0x5905ac]['telegramIpApproval']=null,devices[_0x5905ac][_0x3e8f36(0x1e6)]=null,devices[_0x5905ac][_0x3e8f36(0x1c7)]['token']=null,logger[_0x3e8f36(0x399)](_0x3e8f36(0x331)+_0x5905ac['slice'](-0x8)),devices[_0x5905ac][_0x3e8f36(0x1c7)]=validateAccess(devices[_0x5905ac][_0x3e8f36(0x1c7)][_0x3e8f36(0x24c)],_0x5905ac),!(devices[_0x5905ac][_0x3e8f36(0x1c7)][_0x3e8f36(0x1f5)]&&devices[_0x5905ac][_0x3e8f36(0x1c7)][_0x3e8f36(0x2b3)]=='login\x20not\x20required')&&(_0x11b4a9=='login'?io['to'](_0x5905ac)[_0x3e8f36(0x25c)](_0x3e8f36(0x1de),{'access':{'allow':![],'reason':_0x3e8f36(0x37a),'token':null}}):io['to'](_0x5905ac)['emit'](_0x3e8f36(0x1de),{'access':{'allow':![],'reason':_0x3e8f36(0x356),'token':null}})),devices[_0x5905ac]['access'][_0x3e8f36(0x24c)]=null;},_0x4d8f45);}function setTokenRefresh(_0x1cad0e){const _0x24645c=_0x1f7dcf;if(devices[_0x1cad0e]['pidRefreshToken'])clearTimeout(devices[_0x1cad0e][_0x24645c(0x2c9)]);devices[_0x1cad0e]['pidRefreshToken']=setTimeout(()=>{const _0x4a3817=_0x24645c;getClientsWithUuid(_0x1cad0e)[_0x4a3817(0x27b)]!=0x0?(devices[_0x1cad0e][_0x4a3817(0x1c7)]=refreshToken(_0x1cad0e),io['to'](_0x1cad0e)[_0x4a3817(0x25c)]('status',{'status':_0x4a3817(0x235),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1cad0e][_0x4a3817(0x1c7)],'externalip':devices[_0x1cad0e]['ip'],'publicKey':secure[_0x4a3817(0x378)],'validInstallation':validInstallation}),setTokenRefresh(_0x1cad0e)):clearTimeout(devices[_0x1cad0e]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x7a88b0){const _0x3956da=_0x1f7dcf,_0x63a9d2=getClient(_0x7a88b0['id'])[_0x3956da(0x271)];_0x7a88b0[_0x3956da(0x25c)](_0x3956da(0x20b),config),_0x7a88b0[_0x3956da(0x25c)](_0x3956da(0x329),cleanSettings()),_0x7a88b0['on']('add-bot',_0x514a8f=>{const _0x35efff=_0x3956da;if(validateAccess(_0x514a8f,_0x63a9d2)[_0x35efff(0x1f5)])addBot();else logger[_0x35efff(0x1cb)](_0x35efff(0x28f));}),_0x7a88b0['on'](_0x3956da(0x3a1),(_0x32b121,_0x5ad7ef)=>{const _0x5d4459=_0x3956da;if(validateAccess(_0x5ad7ef,_0x63a9d2)[_0x5d4459(0x1f5)])toggleBot(_0x32b121[_0x5d4459(0x203)],_0x32b121[_0x5d4459(0x1de)],_0x32b121['live']);else logger[_0x5d4459(0x1cb)](_0x5d4459(0x24f));}),_0x7a88b0['on'](_0x3956da(0x2d3),(_0x277804,_0x525079)=>{const _0x48766b=_0x3956da;if(validateAccess(_0x525079,_0x63a9d2)[_0x48766b(0x1f5)])toggleBotMode(_0x277804);else logger[_0x48766b(0x1cb)](_0x48766b(0x24f));}),_0x7a88b0['on']('delete-bot',(_0x4745d1,_0x58c6a4)=>{const _0x18b952=_0x3956da;if(validateAccess(_0x58c6a4,_0x63a9d2)[_0x18b952(0x1f5)])deleteBot(_0x4745d1);else logger[_0x18b952(0x1cb)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x7a88b0['on'](_0x3956da(0x2ca),(_0x37793a,_0x5ce315)=>{const _0x81ff63=_0x3956da;if(validateAccess(_0x5ce315,_0x63a9d2)[_0x81ff63(0x1f5)])storeSettings(_0x37793a,!![]);else logger[_0x81ff63(0x1cb)](_0x81ff63(0x216));}),_0x7a88b0['on'](_0x3956da(0x24a),_0x22f65c=>{const _0x8b8fd9=_0x3956da;if(validateAccess(_0x22f65c,_0x63a9d2)[_0x8b8fd9(0x1f5)])updateBB('update');else logger['full'](_0x8b8fd9(0x1ca));}),_0x7a88b0['on']('reinstall-bb',_0x956d71=>{const _0x4284c1=_0x3956da;if(validateAccess(_0x956d71,_0x63a9d2)[_0x4284c1(0x1f5)])updateBB(_0x4284c1(0x289));else logger['full'](_0x4284c1(0x23c));}),_0x7a88b0['on']('get-backup-files',_0x45424e=>{const _0x1f96fb=_0x3956da;if(validateAccess(_0x45424e,_0x63a9d2)[_0x1f96fb(0x1f5)]){const _0x5ae0ee=getClient(_0x7a88b0['id']);if(_0x5ae0ee)getBackupFiles(_0x5ae0ee[_0x1f96fb(0x271)]);else logger[_0x1f96fb(0x1cb)](_0x1f96fb(0x2bb));}else logger[_0x1f96fb(0x1cb)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x7a88b0['on'](_0x3956da(0x29c),(_0x576ea3,_0x954b1a)=>{const _0x4fa1d0=_0x3956da;if(validateAccess(_0x954b1a,_0x63a9d2)[_0x4fa1d0(0x1f5)])restoreBackupFile(_0x576ea3);else logger['full'](_0x4fa1d0(0x319));}),_0x7a88b0['on'](_0x3956da(0x3aa),_0x42ec3e=>{const _0x1fe302=_0x3956da;if(validateAccess(_0x42ec3e,_0x63a9d2)[_0x1fe302(0x1f5)])getMessages();else logger['full'](_0x1fe302(0x236));}),_0x7a88b0['on']('confirm-message',(_0x55edb3,_0x472275)=>{const _0x3843e4=_0x3956da;if(validateAccess(_0x472275,_0x63a9d2)[_0x3843e4(0x1f5)])confirmMessage(_0x55edb3);else logger['full'](_0x3843e4(0x2f2));}),_0x7a88b0['on']('logout',_0x49beb0=>{const _0x220438=_0x3956da;if(validateAccess(_0x49beb0,_0x63a9d2)[_0x220438(0x1f5)]){if(devices[_0x63a9d2][_0x220438(0x2c9)])clearTimeout(devices[_0x63a9d2]['pidRefreshToken']);if(devices[_0x63a9d2][_0x220438(0x202)])clearTimeout(devices[_0x63a9d2][_0x220438(0x202)]);removeSocketListeners(getClient(_0x7a88b0['id'])[_0x220438(0x271)]),addBlacklist(_0x63a9d2),devices[_0x63a9d2]['telegramIpApproval']=null,devices[_0x63a9d2][_0x220438(0x1e6)]=null,devices[_0x63a9d2][_0x220438(0x1c7)][_0x220438(0x24c)]=null,logger['debug'](_0x220438(0x1be)+_0x63a9d2[_0x220438(0x22a)](-0x8)),io['to'](getClient(_0x7a88b0['id'])[_0x220438(0x271)])[_0x220438(0x25c)](_0x220438(0x1de),{'access':{'allow':![],'reason':_0x220438(0x1d0),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4165aa){const _0x328f1a=_0x1f7dcf,_0x27a64b=getClient(_0x4165aa['id'])['bot'],_0x5eca43=getClient(_0x4165aa['id'])['uuid'];_0x4165aa['on'](_0x328f1a(0x2bd),(_0x112236,_0x295ed0)=>{const _0x4333b2=_0x328f1a;if(validateAccess(_0x295ed0,_0x5eca43)[_0x4333b2(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b]['send']({'function':_0x4333b2(0x23d),'args':_0x112236});}else logger['full'](_0x4333b2(0x321));}),_0x4165aa['on'](_0x328f1a(0x2ef),(_0x465326,_0x5c4243)=>{const _0x2cd633=_0x328f1a;if(validateAccess(_0x5c4243,_0x5eca43)[_0x2cd633(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x2cd633(0x1eb)]({'function':_0x2cd633(0x28e),'args':_0x465326});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x4165aa['on']('get-portfolio',(_0x2197a5,_0x3da4e2)=>{const _0x12ac41=_0x328f1a;if(validateAccess(_0x3da4e2,_0x5eca43)[_0x12ac41(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x12ac41(0x1eb)]({'function':_0x12ac41(0x31f),'args':_0x2197a5});}else logger['full'](_0x12ac41(0x359));}),_0x4165aa['on'](_0x328f1a(0x2aa),(_0x1e3f30,_0x386bc9)=>{const _0x4a491f=_0x328f1a;if(validateAccess(_0x386bc9,_0x5eca43)[_0x4a491f(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x4a491f(0x1eb)]({'function':_0x4a491f(0x1ac),'args':_0x1e3f30});}else logger[_0x4a491f(0x1cb)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x4165aa['on'](_0x328f1a(0x325),(_0x552218,_0x410e61)=>{const _0x2abcad=_0x328f1a;if(validateAccess(_0x410e61,_0x5eca43)[_0x2abcad(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x2abcad(0x1eb)]({'function':_0x2abcad(0x2e0),'args':_0x552218});}else logger[_0x2abcad(0x1cb)](_0x2abcad(0x36e));}),_0x4165aa['on']('store-fiat',(_0x28d3d0,_0x58203b)=>{const _0x1e1363=_0x328f1a;if(validateAccess(_0x58203b,_0x5eca43)['allow']){if(pid[_0x27a64b])pid[_0x27a64b]['send']({'function':_0x1e1363(0x247),'args':_0x28d3d0});}else logger[_0x1e1363(0x1cb)](_0x1e1363(0x205));}),_0x4165aa['on']('reset-history',_0x461151=>{const _0x5cc174=_0x328f1a;if(validateAccess(_0x461151,_0x5eca43)[_0x5cc174(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x5cc174(0x1eb)]({'function':'resetHistory','args':null});}else logger['full'](_0x5cc174(0x36b));}),_0x4165aa['on']('get-starting-balances',_0x2de20e=>{const _0x3517c6=_0x328f1a;if(validateAccess(_0x2de20e,_0x5eca43)['allow']){if(pid[_0x27a64b])pid[_0x27a64b][_0x3517c6(0x1eb)]({'function':_0x3517c6(0x396),'args':null});}else logger[_0x3517c6(0x1cb)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x4165aa['on'](_0x328f1a(0x36f),(_0x9fa0d1,_0x53de58)=>{const _0x3244a2=_0x328f1a;if(validateAccess(_0x53de58,_0x5eca43)[_0x3244a2(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x3244a2(0x1eb)]({'function':_0x3244a2(0x3b0),'args':_0x9fa0d1});}else logger['full'](_0x3244a2(0x1b5));}),_0x4165aa['on']('cancel-loading',_0x8b611e=>{const _0xd8a914=_0x328f1a;if(validateAccess(_0x8b611e,_0x5eca43)[_0xd8a914(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0xd8a914(0x1eb)]({'function':_0xd8a914(0x21d),'args':null});}else logger[_0xd8a914(0x1cb)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x4165aa['on'](_0x328f1a(0x1d2),_0x4b2587=>{const _0x20f3b3=_0x328f1a;if(validateAccess(_0x4b2587,_0x5eca43)[_0x20f3b3(0x1f5)]){if(pid[_0x27a64b])pid[_0x27a64b][_0x20f3b3(0x1eb)]({'function':'showConfig','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4165aa['on']('update-bb',_0x2e99ab=>{const _0x362fb1=_0x328f1a;if(validateAccess(_0x2e99ab,_0x5eca43)['allow'])updateBB(_0x362fb1(0x1dd));else logger[_0x362fb1(0x1cb)](_0x362fb1(0x1ca));}),_0x4165aa['on'](_0x328f1a(0x3aa),_0x16aab5=>{const _0x3249c5=_0x328f1a;if(validateAccess(_0x16aab5,_0x5eca43)[_0x3249c5(0x1f5)])getMessages();else logger['full'](_0x3249c5(0x236));}),_0x4165aa['on']('confirm-message',(_0x4f3100,_0x1a4ec6)=>{const _0x2334d3=_0x328f1a;if(validateAccess(_0x1a4ec6,_0x5eca43)[_0x2334d3(0x1f5)])confirmMessage(_0x4f3100);else logger[_0x2334d3(0x1cb)](_0x2334d3(0x2f2));}),_0x4165aa['on'](_0x328f1a(0x2d1),_0x49358c=>{const _0x158784=_0x328f1a;if(validateAccess(_0x49358c,_0x5eca43)['allow']){if(devices[_0x5eca43]['pidRefreshToken'])clearTimeout(devices[_0x5eca43][_0x158784(0x2c9)]);if(devices[_0x5eca43][_0x158784(0x202)])clearTimeout(devices[_0x5eca43][_0x158784(0x202)]);removeSocketListeners(getClient(_0x4165aa['id'])[_0x158784(0x271)]),addBlacklist(_0x5eca43),devices[_0x5eca43]['telegramIpApproval']=null,devices[_0x5eca43][_0x158784(0x1e6)]=null,devices[_0x5eca43][_0x158784(0x1c7)][_0x158784(0x24c)]=null,logger[_0x158784(0x399)](_0x158784(0x1be)+_0x5eca43[_0x158784(0x22a)](-0x8)),io['to'](getClient(_0x4165aa['id'])[_0x158784(0x271)])[_0x158784(0x25c)](_0x158784(0x1de),{'access':{'allow':![],'reason':_0x158784(0x1d0),'token':null}});}else logger[_0x158784(0x1cb)](_0x158784(0x308));});}function removeSocketListeners(_0xb2eab1){getClientsWithUuid(_0xb2eab1)['forEach'](_0x5955a2=>{const _0x7fb0d9=_0x2bd8;getSocket(_0x5955a2['id'])[_0x7fb0d9(0x2c7)]();});}function cleanSettings(){const _0x544206=_0x1f7dcf;let _0x549b1f=settings;return settings[_0x544206(0x36a)]&&settings[_0x544206(0x36a)]!=''&&(_0x549b1f={..._0x549b1f,'telegramToken':_0x544206(0x20e)}),settings[_0x544206(0x28d)]&&settings[_0x544206(0x28d)]!=''&&(_0x549b1f={..._0x549b1f,'bbPassword':_0x544206(0x20e)}),settings[_0x544206(0x340)]&&settings['marketcapApi']!=''&&(_0x549b1f={..._0x549b1f,'marketcapApi':_0x544206(0x20e)}),(settings[_0x544206(0x28d)]&&settings[_0x544206(0x28d)]==_0x544206(0x38a)||settings['telegramToken']&&settings['telegramToken']==_0x544206(0x38a)||settings[_0x544206(0x340)]&&settings['marketcapApi']=='***')&&(_0x549b1f={..._0x549b1f,'restored':{'password':settings['bbPassword']==_0x544206(0x38a),'telegram':settings[_0x544206(0x36a)]==_0x544206(0x38a),'marketcap':settings['marketcapApi']==_0x544206(0x38a)}}),_0x549b1f;}async function updateBB(_0xbad904){const _0x41196f=_0x1f7dcf;await backupConfigFiles(),installingUpdate=!![],config[_0x41196f(0x2fd)](_0x51dfcc=>{const _0x3af132=_0x41196f;restartBot(_0x51dfcc[_0x3af132(0x203)]);});if(_0xbad904=='update')process[_0x41196f(0x1eb)]({'update':!![],'environment':environment},_0x2c11dc=>{});else _0xbad904==_0x41196f(0x289)&&process[_0x41196f(0x1eb)]({'reinstall':!![],'environment':environment},_0x48e89a=>{});}function startBot(_0x376dc8,_0x26f3c9,_0x4d280d){const _0x518800=_0x1f7dcf;if(debugging)_0x376dc8['push']('-d');let _0x474605=![];const _0x1a23ce=_0x376dc8[0x0];_0x26f3c9={..._0x26f3c9,'stdio':[_0x518800(0x1aa),'inherit',_0x518800(0x1aa),_0x518800(0x36c)]},pid[_0x1a23ce]=childProcess[_0x518800(0x305)](botfile,_0x376dc8,_0x26f3c9),pid[_0x1a23ce]['on'](_0x518800(0x21e),_0x404d34=>{const _0x54234b=_0x518800;switch(Object[_0x54234b(0x1e1)](_0x404d34)[0x0]){case'botname':updateBotName(_0x1a23ce,_0x404d34[_0x54234b(0x27a)]);break;case'updatebotmanager':updateBotManager();break;case _0x54234b(0x1de):updateStatus(_0x1a23ce,_0x404d34['status']);break;case _0x54234b(0x229):updateLive(_0x1a23ce,_0x404d34['live']);break;case _0x54234b(0x221):updateLive(_0x1a23ce,_0x404d34[_0x54234b(0x221)]),io['to'](_0x1a23ce)['emit']('status',{'access':{'allow':![],'reason':_0x54234b(0x258),'token':null}});break;case _0x54234b(0x317):_0x404d34[_0x54234b(0x317)]==_0x54234b(0x280)&&restartBot(_0x1a23ce);_0x404d34['stop']==_0x54234b(0x231)&&toggleBot(_0x1a23ce,_0x54234b(0x21b),_0x54234b(0x1f7));break;case _0x54234b(0x1c9):sendTelegramBot(_0x1a23ce,_0x404d34['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x404d34[_0x54234b(0x1e8)]);break;case _0x54234b(0x29b):io['to'](_0x1a23ce)['emit'](_0x404d34[_0x54234b(0x29b)],_0x404d34[_0x54234b(0x363)]);break;}}),pid[_0x1a23ce]['on'](_0x518800(0x32c),function(_0xc9eae7){if(_0x474605)return;_0x474605=!![],_0x4d280d(_0xc9eae7);}),pid[_0x1a23ce]['on']('exit',async function(_0x9239be){const _0x26ebb8=_0x518800;if(terminating)return;if(installingUpdate){logger['debug']('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x26ebb8(0x3ac)]();return;}if(_0x474605)return;_0x474605=!![],_0x4d280d(null);const _0x35ed05=dbConfig[_0x26ebb8(0x379)]('bots')[_0x26ebb8(0x24b)]({'botID':_0x1a23ce})[_0x26ebb8(0x282)]();_0x35ed05&&(_0x35ed05['status']==_0x26ebb8(0x2d6)||_0x35ed05[_0x26ebb8(0x1de)]==_0x26ebb8(0x2b7))&&(await sleep(0x3e8),updateLive(_0x1a23ce,'stopped'),logger[_0x26ebb8(0x1cb)](_0x26ebb8(0x1ec)+_0x1a23ce),startBot([_0x1a23ce,userID],{'cwd':bbpath},function(_0x2c8db4){const _0x4460e6=_0x26ebb8;if(_0x2c8db4)logger[_0x4460e6(0x1cb)](_0x2c8db4);}));});}function stopBot(_0x437927){const _0x10ea50=_0x1f7dcf;getClientsWithBotID(_0x437927)[_0x10ea50(0x2fd)](_0x4cd8a3=>{const _0x4b8f02=_0x10ea50;getSocket(_0x4cd8a3['id'])[_0x4b8f02(0x263)](!![]),removeClient(_0x4cd8a3['id']);}),pid[_0x437927]&&(pid[_0x437927][_0x10ea50(0x231)](),pid[_0x437927]=null);}function stopAllBots(){terminating=!![];const _0x539b64=getEnabledBots();_0x539b64['forEach'](_0x31042d=>{const _0x529426=_0x2bd8;stopBot(_0x31042d[_0x529426(0x203)]);});}function restartBot(_0x10bb5c){const _0x39c094=_0x1f7dcf;if(pid[_0x10bb5c])pid[_0x10bb5c][_0x39c094(0x231)]();}function addBot(){const _0x30c443=_0x1f7dcf;let _0xa34054;for(let _0x5ffcad=0x1;_0x5ffcad<0x3e9;_0x5ffcad++){_0xa34054=_0x5ffcad[_0x30c443(0x283)]()[_0x30c443(0x241)](0x3,'0');let _0x495530=config[_0x30c443(0x24b)](_0x28ffd5=>_0x28ffd5[_0x30c443(0x203)]==_0xa34054);if(!_0x495530)break;}if(_0xa34054===_0x30c443(0x262)){logger[_0x30c443(0x1cb)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x30c443(0x1cb)](_0x30c443(0x296)+_0xa34054),dbConfig[_0x30c443(0x379)](_0x30c443(0x20b))[_0x30c443(0x2a0)]({'botID':_0xa34054,'botname':_0x30c443(0x1d5)+_0xa34054,'status':_0x30c443(0x2b7),'live':''})[_0x30c443(0x39b)](),startBot([_0xa34054,userID],{'cwd':bbpath},function(_0x5eb755){if(_0x5eb755)logger['full'](_0x5eb755);}),config=getConfiguration(),io['to'](_0x30c443(0x2cb))['emit'](_0x30c443(0x20b),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x11415a){const _0x47f9dc=_0x1f7dcf;getClientsWithBotID(_0x11415a)[_0x47f9dc(0x2fd)](_0x3fa1f1=>{const _0x43f7c3=_0x47f9dc;getSocket(_0x3fa1f1['id'])[_0x43f7c3(0x263)](!![]),removeClient(_0x3fa1f1['id']);}),dbConfig[_0x47f9dc(0x379)]('bots')[_0x47f9dc(0x2ea)]({'botID':_0x11415a})[_0x47f9dc(0x39b)](),logger[_0x47f9dc(0x1cb)](_0x47f9dc(0x1b0)+_0x11415a),stopBot(_0x11415a);try{if(fs[_0x47f9dc(0x2e7)](path[_0x47f9dc(0x1ea)](configpath,'bot-'+_0x11415a+_0x47f9dc(0x222))))fs[_0x47f9dc(0x246)](path[_0x47f9dc(0x1ea)](configpath,_0x47f9dc(0x266)+_0x11415a+'-config.json'));if(fs[_0x47f9dc(0x2e7)](path[_0x47f9dc(0x1ea)](configpath,'bot-'+_0x11415a+_0x47f9dc(0x2bc))))fs[_0x47f9dc(0x246)](path[_0x47f9dc(0x1ea)](configpath,_0x47f9dc(0x266)+_0x11415a+_0x47f9dc(0x2bc)));if(fs[_0x47f9dc(0x2e7)](path[_0x47f9dc(0x1ea)](configpath,_0x47f9dc(0x266)+_0x11415a+'-performance.json')))fs['unlinkSync'](path['join'](configpath,_0x47f9dc(0x266)+_0x11415a+_0x47f9dc(0x2f8)));if(fs['existsSync'](path[_0x47f9dc(0x1ea)](configpath,_0x47f9dc(0x266)+_0x11415a+'-results.json')))fs['unlinkSync'](path[_0x47f9dc(0x1ea)](configpath,_0x47f9dc(0x266)+_0x11415a+_0x47f9dc(0x344)));}catch(_0x3cb3a6){if(_0x3cb3a6)logger[_0x47f9dc(0x1cb)](_0x47f9dc(0x257),_0x3cb3a6);}config=getConfiguration(),io['to'](_0x47f9dc(0x2cb))[_0x47f9dc(0x25c)]('bots',config),broadcastToBots(_0x47f9dc(0x20b),JSON['stringify'](config));}function toggleBot(_0x47b95d,_0x48e072,_0x22fdd8){const _0x31aa63=_0x1f7dcf;dbConfig[_0x31aa63(0x379)](_0x31aa63(0x20b))[_0x31aa63(0x24b)]({'botID':_0x47b95d})[_0x31aa63(0x1a9)]({'status':_0x48e072})[_0x31aa63(0x1a9)]({'live':_0x22fdd8})['write']();if(_0x48e072==_0x31aa63(0x2d6)||_0x48e072==_0x31aa63(0x2b7))logger[_0x31aa63(0x1cb)](_0x31aa63(0x3a7)+_0x47b95d),startBot([_0x47b95d,userID],{'cwd':bbpath},function(_0xa1e44a){const _0x183a3e=_0x31aa63;if(_0xa1e44a)logger[_0x183a3e(0x1cb)](_0xa1e44a);});else(_0x48e072=='disabled'||_0x48e072==_0x31aa63(0x375))&&(logger[_0x31aa63(0x1cb)](_0x31aa63(0x1f2)+_0x47b95d),stopBot(_0x47b95d));config=getConfiguration(),io['to'](_0x31aa63(0x2cb))[_0x31aa63(0x25c)](_0x31aa63(0x20b),config),broadcastToBots(_0x31aa63(0x20b),JSON[_0x31aa63(0x2c3)](config));}function toggleStatus(_0x1f65f2){const _0x306588=_0x1f7dcf;let _0x424daa=dbConfig['get']('bots')[_0x306588(0x24b)]({'botID':_0x1f65f2})[_0x306588(0x282)](),_0x9c12e3;if(_0x424daa[_0x306588(0x1de)]===_0x306588(0x2d6))_0x9c12e3=_0x306588(0x21b);else{if(_0x424daa['status']==='new')_0x9c12e3=_0x306588(0x375);else{if(_0x424daa['status']===_0x306588(0x375))_0x9c12e3=_0x306588(0x2b7);else{if(_0x424daa[_0x306588(0x1de)]===_0x306588(0x21b))_0x9c12e3='enabled';}}}return _0x9c12e3;}function updateStatus(_0x165280,_0x36ec65){const _0x21282c=_0x1f7dcf;dbConfig[_0x21282c(0x379)]('bots')['find']({'botID':_0x165280})[_0x21282c(0x1a9)]({'status':_0x36ec65})[_0x21282c(0x39b)](),config=getConfiguration(),io['to'](_0x21282c(0x2cb))['emit'](_0x21282c(0x20b),config),broadcastToBots(_0x21282c(0x20b),JSON['stringify'](config));}function updateLive(_0x47221b,_0x58645f){const _0x8cd5a9=_0x1f7dcf;dbConfig['get']('bots')[_0x8cd5a9(0x24b)]({'botID':_0x47221b})[_0x8cd5a9(0x1a9)]({'live':_0x58645f})[_0x8cd5a9(0x39b)](),config=getConfiguration(),io['to'](_0x8cd5a9(0x2cb))[_0x8cd5a9(0x25c)](_0x8cd5a9(0x20b),config),broadcastToBots(_0x8cd5a9(0x20b),JSON['stringify'](config));}function updateBotName(_0x1a8d61,_0x34ee47){const _0x368524=_0x1f7dcf;dbConfig['get']('bots')[_0x368524(0x24b)]({'botID':_0x1a8d61})['assign']({'botname':_0x34ee47})[_0x368524(0x39b)](),config=getConfiguration(),io['to'](_0x368524(0x2cb))[_0x368524(0x25c)](_0x368524(0x20b),config),broadcastToBots(_0x368524(0x20b),JSON[_0x368524(0x2c3)](config));}function updateBotManager(){const _0x30e73a=_0x1f7dcf;config=getConfiguration(),io['to']('botmanager')[_0x30e73a(0x25c)](_0x30e73a(0x20b),config),broadcastToBots(_0x30e73a(0x20b),JSON['stringify'](config));}function toggleBotMode(_0x242293){const _0x1af344=_0x1f7dcf;if(pid[_0x242293])pid[_0x242293]['send']({'function':'toggleBotMode','args':null});else{const _0x3205fa=configpath+'bot-'+_0x242293+_0x1af344(0x222),_0x402cb2=fs[_0x1af344(0x1bf)](_0x3205fa),_0x1fbba8=JSON[_0x1af344(0x288)](_0x402cb2),_0x48c19b=_0x1fbba8['bot'][0x0][_0x1af344(0x1e2)];_0x1fbba8[_0x1af344(0x2de)][0x0][_0x1af344(0x1e2)]=!_0x48c19b;const _0x4223cf=JSON[_0x1af344(0x2c3)](_0x1fbba8,null,0x2);fs[_0x1af344(0x25d)](_0x3205fa,_0x4223cf),config=getConfiguration(),io['to'](_0x1af344(0x2cb))[_0x1af344(0x25c)](_0x1af344(0x20b),config),broadcastToBots(_0x1af344(0x20b),JSON[_0x1af344(0x2c3)](config));}}function validateTelegram(_0x39209d){const _0x1ff5a2=_0x1f7dcf;if(_0x39209d[_0x1ff5a2(0x1f4)][_0x1ff5a2(0x21a)]!=settings[_0x1ff5a2(0x39d)]&&'@'+_0x39209d[_0x1ff5a2(0x1f4)][_0x1ff5a2(0x21a)]!=settings['telegramUsername']||_0x39209d[_0x1ff5a2(0x239)]['id']!=settings['telegramChatId'])return sendTelegram(_0x39209d[_0x1ff5a2(0x239)]['id'],_0x1ff5a2(0x2e6),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x4042e6=_0x1f7dcf;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x3f6fb9=_0x4042e6(0x38d);_0x3f6fb9+='\x0a',_0x3f6fb9+='/enable\x20-\x20enable\x20notifications\x0a',_0x3f6fb9+=_0x4042e6(0x30b),_0x3f6fb9+=_0x4042e6(0x3a4),_0x3f6fb9+=_0x4042e6(0x2a4),_0x3f6fb9+='/on\x20-\x20start\x20bot(s)\x0a',_0x3f6fb9+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3f6fb9+=_0x4042e6(0x293),_0x3f6fb9+=_0x4042e6(0x369),_0x3f6fb9+=_0x4042e6(0x204),_0x3f6fb9+=_0x4042e6(0x33a),_0x3f6fb9+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3f6fb9+=_0x4042e6(0x3a3),_0x3f6fb9+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x3f6fb9+=_0x4042e6(0x304);let _0x581828=_0x4042e6(0x381);_0x581828+='\x0a',_0x581828+=_0x3f6fb9,tgBot[_0x4042e6(0x2c6)]((_0xa9c2dc,_0x438322)=>{const _0x48319e=_0x4042e6;logger[_0x48319e(0x3a6)](getTimeStamp()+_0x48319e(0x1c3)),logger[_0x48319e(0x399)]('Telegraf\x20error:',_0xa9c2dc);}),tgBot['use'](async(_0x4e5949,_0x4f1d05)=>{const _0x210aaf=_0x4042e6;if(!(!settings[_0x210aaf(0x219)]&&_0x4e5949[_0x210aaf(0x1dd)][_0x210aaf(0x21e)][_0x210aaf(0x1cd)]==_0x210aaf(0x1ae))){if(!validateTelegram(_0x4e5949))return;}_0x4f1d05();}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x2b9),async _0x698ccb=>{const _0x1bfb6b=_0x4042e6;if(!settings[_0x1bfb6b(0x219)])updateSetting(_0x1bfb6b(0x219),_0x698ccb[_0x1bfb6b(0x239)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x698ccb))return;await sendTelegram(_0x698ccb[_0x1bfb6b(0x239)]['id'],_0x581828);}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x26a),async _0x3c2d87=>{const _0x22fbb7=_0x4042e6;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3c2d87[_0x22fbb7(0x239)]['id'],_0x22fbb7(0x39f));}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x31b),async _0x2ce8d5=>{const _0x1be2c9=_0x4042e6;await sendTelegram(_0x2ce8d5['chat']['id'],'Notifications\x20disabled'),updateSetting(_0x1be2c9(0x2d0),![]);}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x206),async _0x41077f=>{const _0x3a07d8=_0x4042e6,_0x468d5e=Markup['inlineKeyboard']([Markup[_0x3a07d8(0x39a)]['callback'](_0x3a07d8(0x2c1),_0x3a07d8(0x200)),Markup[_0x3a07d8(0x39a)]['callback'](_0x3a07d8(0x30c),_0x3a07d8(0x2bf)),Markup[_0x3a07d8(0x39a)][_0x3a07d8(0x1e4)](_0x3a07d8(0x297),'config_all')]);_0x41077f[_0x3a07d8(0x24e)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x468d5e);}),tgBot[_0x4042e6(0x1e5)](_0x4042e6(0x200),async _0x1b2021=>{const _0x4af757=_0x4042e6;_0x1b2021[_0x4af757(0x2b2)](),updateSetting(_0x4af757(0x34d),_0x4af757(0x364)),updateSetting(_0x4af757(0x2d0),!![]),await sendTelegram(_0x1b2021[_0x4af757(0x239)]['id'],_0x4af757(0x320));}),tgBot['action'](_0x4042e6(0x2bf),async _0x6978b3=>{const _0x419c42=_0x4042e6;_0x6978b3[_0x419c42(0x2b2)](),updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x6978b3[_0x419c42(0x239)]['id'],_0x419c42(0x387));}),tgBot['action'](_0x4042e6(0x34a),async _0x314d16=>{const _0x20eed7=_0x4042e6;_0x314d16['editMessageReplyMarkup'](),updateSetting(_0x20eed7(0x34d),_0x20eed7(0x2b5)),updateSetting(_0x20eed7(0x2d0),!![]),await sendTelegram(_0x314d16['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command']('status',async _0x59c8d6=>{const _0x42cd10=_0x4042e6,_0x269dd7=getBotsWithMode();let _0x18c6b2=_0x42cd10(0x2e2);config[_0x42cd10(0x2fd)](_0x1d41b1=>{const _0x1563fb=_0x42cd10,_0x40b11b=_0x269dd7['find'](_0x2373de=>_0x2373de[_0x1563fb(0x203)]==_0x1d41b1['botID'])[_0x1563fb(0x242)];_0x18c6b2+=_0x1563fb(0x1d5)+_0x1d41b1['botID']+':\x20'+_0x1d41b1[_0x1563fb(0x1de)]+_0x1563fb(0x22c)+_0x40b11b+'\x20|\x20'+_0x1d41b1[_0x1563fb(0x229)]+'\x0a';}),_0x18c6b2+='\x0a',_0x18c6b2+=_0x42cd10(0x2ba),_0x18c6b2+=!settings[_0x42cd10(0x2d0)]?_0x42cd10(0x2f5):_0x42cd10(0x233),_0x18c6b2+=settings[_0x42cd10(0x2d0)]?settings['telegramEvents']==_0x42cd10(0x2b5)?_0x42cd10(0x214):_0x42cd10(0x30e)+settings[_0x42cd10(0x34d)]+'\x20only\x0a':'',await sendTelegram(_0x59c8d6[_0x42cd10(0x239)]['id'],_0x18c6b2,{'parse_mode':_0x42cd10(0x2a1)});}),tgBot['command']('restart',async _0x11d8e2=>{const _0x54e456=_0x4042e6,_0x218e6e=getEnabledBots();if(_0x218e6e['length']==0x0)await sendTelegram(_0x11d8e2['chat']['id'],_0x54e456(0x2b1));else{if(_0x218e6e[_0x54e456(0x27b)]>0x1)_0x218e6e[_0x54e456(0x2a0)]({'botID':_0x54e456(0x2b5)});let _0x5061e3=[],_0x4e2c55=[];const _0x3395de=_0x218e6e[_0x54e456(0x27b)]%0x4==0x0||_0x218e6e['length']%0x4==0x3||_0x218e6e[_0x54e456(0x27b)]%0x3==0x1?0x4:0x3;let _0x3b22d6=0x0;_0x218e6e['forEach']((_0x101924,_0x4181c4)=>{const _0x11eaba=_0x54e456;if(_0x4181c4%_0x3395de==0x0)_0x4e2c55=[];_0x4e2c55[_0x11eaba(0x2a0)](Markup[_0x11eaba(0x39a)][_0x11eaba(0x1e4)](_0x101924[_0x11eaba(0x203)]=='all'?_0x11eaba(0x1fa):_0x11eaba(0x1d5)+_0x101924[_0x11eaba(0x203)],_0x11eaba(0x322)+_0x101924['botID'])),_0x4181c4%_0x3395de==0x0&&(_0x5061e3[_0x3b22d6]=_0x4e2c55,_0x3b22d6++);});const _0x4c68ff=Markup[_0x54e456(0x2db)](_0x5061e3);_0x11d8e2[_0x54e456(0x24e)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x4c68ff);}}),tgBot[_0x4042e6(0x1e5)](/restart_(.+)/,async _0x25d0d3=>{const _0x455b0b=_0x4042e6,_0x19bf5e=_0x25d0d3[_0x455b0b(0x366)][0x1];_0x25d0d3[_0x455b0b(0x2b2)](),_0x19bf5e==_0x455b0b(0x2b5)?config[_0x455b0b(0x2fd)](_0x5ea35e=>{const _0x5c6ce9=_0x455b0b;restartBot(_0x5ea35e[_0x5c6ce9(0x203)]);}):restartBot(_0x19bf5e);}),tgBot[_0x4042e6(0x290)]('on',async _0x1764c6=>{const _0x22966e=_0x4042e6,_0x16488d=getDisabledBots();if(_0x16488d['length']==0x0)await sendTelegram(_0x1764c6[_0x22966e(0x239)]['id'],_0x22966e(0x24d));else{if(_0x16488d[_0x22966e(0x27b)]>0x1)_0x16488d[_0x22966e(0x2a0)]({'botID':_0x22966e(0x2b5)});let _0x25bed3=[],_0x124771=[];const _0x4ed436=_0x16488d[_0x22966e(0x27b)]%0x4==0x0||_0x16488d[_0x22966e(0x27b)]%0x4==0x3||_0x16488d[_0x22966e(0x27b)]%0x3==0x1?0x4:0x3;let _0x1bbc6e=0x0;_0x16488d[_0x22966e(0x2fd)]((_0x430982,_0x21e0c4)=>{const _0x451e69=_0x22966e;if(_0x21e0c4%_0x4ed436==0x0)_0x124771=[];_0x124771[_0x451e69(0x2a0)](Markup[_0x451e69(0x39a)][_0x451e69(0x1e4)](_0x430982['botID']==_0x451e69(0x2b5)?_0x451e69(0x1fa):_0x451e69(0x1d5)+_0x430982[_0x451e69(0x203)],_0x451e69(0x36d)+_0x430982[_0x451e69(0x203)])),_0x21e0c4%_0x4ed436==0x0&&(_0x25bed3[_0x1bbc6e]=_0x124771,_0x1bbc6e++);});const _0x22bac9=Markup[_0x22966e(0x2db)](_0x25bed3);_0x1764c6[_0x22966e(0x24e)](_0x22966e(0x1d8),_0x22bac9);}}),tgBot[_0x4042e6(0x1e5)](/on_(.+)/,async _0x2182f5=>{const _0x471b11=_0x4042e6,_0x3d0c33=_0x2182f5[_0x471b11(0x366)][0x1];_0x2182f5[_0x471b11(0x2b2)]();if(_0x3d0c33=='all'){const _0x53d0b1=getDisabledBots();await sendTelegram(_0x2182f5[_0x471b11(0x239)]['id'],_0x471b11(0x2a7)),_0x53d0b1[_0x471b11(0x2fd)](_0x32251e=>{const _0x360c06=_0x471b11;if(_0x32251e[_0x360c06(0x203)]!='all')toggleBot(_0x32251e[_0x360c06(0x203)],toggleStatus(_0x32251e[_0x360c06(0x203)]),_0x360c06(0x1f7));});}else await sendTelegram(_0x2182f5['chat']['id'],_0x471b11(0x227)+_0x3d0c33),toggleBot(_0x3d0c33,toggleStatus(_0x3d0c33),_0x471b11(0x1f7));}),tgBot[_0x4042e6(0x290)]('off',async _0x31008e=>{const _0x12c66c=_0x4042e6,_0x12ab6b=getEnabledBots();if(_0x12ab6b['length']==0x0)await sendTelegram(_0x31008e['chat']['id'],_0x12c66c(0x2b1));else{if(_0x12ab6b[_0x12c66c(0x27b)]>0x1)_0x12ab6b[_0x12c66c(0x2a0)]({'botID':_0x12c66c(0x2b5)});let _0x9d4094=[],_0x3f83a2=[];const _0x54fb33=_0x12ab6b[_0x12c66c(0x27b)]%0x4==0x0||_0x12ab6b[_0x12c66c(0x27b)]%0x4==0x3||_0x12ab6b[_0x12c66c(0x27b)]%0x3==0x1?0x4:0x3;let _0x66a578=0x0;_0x12ab6b[_0x12c66c(0x2fd)]((_0x918e55,_0x408e44)=>{const _0x929784=_0x12c66c;if(_0x408e44%_0x54fb33==0x0)_0x3f83a2=[];_0x3f83a2[_0x929784(0x2a0)](Markup['button'][_0x929784(0x1e4)](_0x918e55[_0x929784(0x203)]==_0x929784(0x2b5)?_0x929784(0x1fa):_0x929784(0x1d5)+_0x918e55[_0x929784(0x203)],_0x929784(0x334)+_0x918e55[_0x929784(0x203)])),_0x408e44%_0x54fb33==0x0&&(_0x9d4094[_0x66a578]=_0x3f83a2,_0x66a578++);});const _0x43b184=Markup[_0x12c66c(0x2db)](_0x9d4094);_0x31008e[_0x12c66c(0x24e)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x43b184);}}),tgBot['action'](/off_(.+)/,async _0x1c6e05=>{const _0x335b8c=_0x4042e6,_0x2b9b75=_0x1c6e05[_0x335b8c(0x366)][0x1];_0x1c6e05['editMessageReplyMarkup']();if(_0x2b9b75=='all'){const _0x26aebc=getEnabledBots();await sendTelegram(_0x1c6e05[_0x335b8c(0x239)]['id'],_0x335b8c(0x213)),_0x26aebc[_0x335b8c(0x2fd)](_0x58ac06=>{const _0xa9efec=_0x335b8c;if(_0x58ac06['botID']!='all')toggleBot(_0x58ac06['botID'],toggleStatus(_0x58ac06[_0xa9efec(0x203)]),'stopped');});}else await sendTelegram(_0x1c6e05['chat']['id'],_0x335b8c(0x34f)+_0x2b9b75),toggleBot(_0x2b9b75,toggleStatus(_0x2b9b75),'stopped');}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x37b),async _0x428e5d=>{const _0x1433d8=_0x4042e6,_0x1e90ec=getEnabledBots();if(_0x1e90ec['length']==0x0)await sendTelegram(_0x428e5d[_0x1433d8(0x239)]['id'],_0x1433d8(0x2b1));else{if(_0x1e90ec['length']>0x1){let _0x4be91c=[],_0x27223e=[];const _0x39c4ad=_0x1e90ec[_0x1433d8(0x27b)]%0x4==0x0||_0x1e90ec[_0x1433d8(0x27b)]%0x4==0x3||_0x1e90ec[_0x1433d8(0x27b)]%0x3==0x1?0x4:0x3;let _0x302450=0x0;_0x1e90ec['forEach']((_0x2198a1,_0x17787f)=>{const _0x5b4f70=_0x1433d8;if(_0x17787f%_0x39c4ad==0x0)_0x27223e=[];_0x27223e[_0x5b4f70(0x2a0)](Markup[_0x5b4f70(0x39a)][_0x5b4f70(0x1e4)](_0x5b4f70(0x1d5)+_0x2198a1[_0x5b4f70(0x203)],'metrics_'+_0x2198a1[_0x5b4f70(0x203)])),_0x17787f%_0x39c4ad==0x0&&(_0x4be91c[_0x302450]=_0x27223e,_0x302450++);});const _0xa4edf0=Markup[_0x1433d8(0x2db)](_0x4be91c);_0x428e5d[_0x1433d8(0x24e)](_0x1433d8(0x1ab),_0xa4edf0);}else{const _0x356c5a=_0x1e90ec[0x0][_0x1433d8(0x203)];if(pid[_0x356c5a])pid[_0x356c5a][_0x1433d8(0x1eb)]({'function':_0x1433d8(0x23f),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x2bd680=>{const _0x284ca9=_0x4042e6,_0x5a1ff7=_0x2bd680[_0x284ca9(0x366)][0x1];_0x2bd680['editMessageReplyMarkup']();if(pid[_0x5a1ff7])pid[_0x5a1ff7][_0x284ca9(0x1eb)]({'function':_0x284ca9(0x23f),'args':null});}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x357),async _0x1cb146=>{const _0x4cfe83=_0x4042e6,_0xf441c2=getEnabledBots();if(_0xf441c2[_0x4cfe83(0x27b)]==0x0)await sendTelegram(_0x1cb146[_0x4cfe83(0x239)]['id'],_0x4cfe83(0x2b1));else{if(_0xf441c2[_0x4cfe83(0x27b)]>0x1){let _0x2e542f=[],_0x9e20cf=[];const _0x27d647=_0xf441c2['length']%0x4==0x0||_0xf441c2[_0x4cfe83(0x27b)]%0x4==0x3||_0xf441c2[_0x4cfe83(0x27b)]%0x3==0x1?0x4:0x3;let _0x216a6b=0x0;_0xf441c2['forEach']((_0x92d99,_0x3c1e28)=>{const _0x4de671=_0x4cfe83;if(_0x3c1e28%_0x27d647==0x0)_0x9e20cf=[];_0x9e20cf['push'](Markup[_0x4de671(0x39a)]['callback']('Bot\x20'+_0x92d99[_0x4de671(0x203)],_0x4de671(0x1bd)+_0x92d99['botID'])),_0x3c1e28%_0x27d647==0x0&&(_0x2e542f[_0x216a6b]=_0x9e20cf,_0x216a6b++);});const _0x92065b=Markup['inlineKeyboard'](_0x2e542f);_0x1cb146['reply'](_0x4cfe83(0x20c),_0x92065b);}else{const _0x2c6ce0=_0xf441c2[0x0]['botID'];if(pid[_0x2c6ce0])pid[_0x2c6ce0][_0x4cfe83(0x1eb)]({'function':_0x4cfe83(0x3b3),'args':null});}}}),tgBot[_0x4042e6(0x1e5)](/portfolio_(.+)/,async _0x23d717=>{const _0xa4752d=_0x4042e6,_0x3f0134=_0x23d717[_0xa4752d(0x366)][0x1];_0x23d717[_0xa4752d(0x2b2)]();if(pid[_0x3f0134])pid[_0x3f0134][_0xa4752d(0x1eb)]({'function':_0xa4752d(0x3b3),'args':null});}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x1dd),async _0x5929ed=>{const _0x4040a4=_0x4042e6;await getMessages();if(!updateAvailable)await sendTelegram(_0x5929ed[_0x4040a4(0x239)]['id'],_0x4040a4(0x1dc));else{if(!validInstallation)await sendTelegram(_0x5929ed[_0x4040a4(0x239)]['id'],_0x4040a4(0x295));else{const _0xf49dde=Markup[_0x4040a4(0x2db)]([Markup[_0x4040a4(0x39a)]['callback'](_0x4040a4(0x2af),'update_yes'),Markup['button']['callback']('No',_0x4040a4(0x385))]);_0x5929ed['reply'](_0x4040a4(0x360),_0xf49dde);}}}),tgBot[_0x4042e6(0x1e5)](/update_(.+)/,async _0x11fd7d=>{const _0x258915=_0x4042e6,_0x1c6bc3=_0x11fd7d['match'][0x1];_0x11fd7d['editMessageReplyMarkup'](),_0x1c6bc3=='yes'&&(await sendTelegram(_0x11fd7d[_0x258915(0x239)]['id'],_0x258915(0x330)),updateBB('update')),_0x1c6bc3=='no'&&await sendTelegram(_0x11fd7d['chat']['id'],_0x258915(0x228));}),tgBot['command'](_0x4042e6(0x289),async _0x2c4e72=>{const _0x5b497f=_0x4042e6;if(!validInstallation)await sendTelegram(_0x2c4e72[_0x5b497f(0x239)]['id'],_0x5b497f(0x2e8));else{const _0x1e2074=Markup['inlineKeyboard']([Markup[_0x5b497f(0x39a)]['callback'](_0x5b497f(0x2af),_0x5b497f(0x254)),Markup[_0x5b497f(0x39a)]['callback']('No',_0x5b497f(0x2c4))]);_0x2c4e72['reply'](_0x5b497f(0x2a8),_0x1e2074);}}),tgBot[_0x4042e6(0x1e5)](/reinstall_(.+)/,async _0x54eb66=>{const _0x542fc3=_0x4042e6,_0x46e745=_0x54eb66[_0x542fc3(0x366)][0x1];_0x54eb66[_0x542fc3(0x2b2)](),_0x46e745==_0x542fc3(0x333)&&(await sendTelegram(_0x54eb66['chat']['id'],_0x542fc3(0x37f)),updateBB(_0x542fc3(0x289))),_0x46e745=='no'&&await sendTelegram(_0x54eb66[_0x542fc3(0x239)]['id'],_0x542fc3(0x26e));}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x267),async _0x259744=>{const _0x485277=_0x4042e6,_0x286d68=getBotsWithMode();if(_0x286d68[_0x485277(0x27b)]==0x0)await sendTelegram(_0x259744[_0x485277(0x239)]['id'],_0x485277(0x2b1));else{let _0x1926dc=[],_0x180cf2=[];const _0x4a6442=0x2;let _0xc87e29=0x0;_0x286d68['forEach']((_0x17e305,_0x3143d4)=>{const _0x8be0d9=_0x485277;if(_0x3143d4%_0x4a6442==0x0)_0x180cf2=[];_0x180cf2[_0x8be0d9(0x2a0)](Markup[_0x8be0d9(0x39a)]['callback'](_0x8be0d9(0x1d5)+_0x17e305['botID']+'\x20('+_0x17e305[_0x8be0d9(0x242)]+')',_0x8be0d9(0x1b6)+_0x17e305[_0x8be0d9(0x203)])),_0x3143d4%_0x4a6442==0x0&&(_0x1926dc[_0xc87e29]=_0x180cf2,_0xc87e29++);});const _0x35c53d=Markup[_0x485277(0x2db)](_0x1926dc);_0x259744[_0x485277(0x24e)](_0x485277(0x2ce),_0x35c53d);}}),tgBot[_0x4042e6(0x1e5)](/toggle_(.+)/,async _0x21fd41=>{const _0x121121=_0x4042e6,_0x382b99=_0x21fd41['match'][0x1];_0x21fd41[_0x121121(0x2b2)]();const _0x508cd8=getBotsWithMode(),_0x587da9=_0x508cd8[_0x121121(0x24b)](_0x527003=>_0x527003['botID']==_0x382b99),_0x38a3f2=_0x587da9[_0x121121(0x242)]==_0x121121(0x313)?_0x121121(0x312):_0x121121(0x313);await sendTelegram(_0x21fd41[_0x121121(0x239)]['id'],_0x121121(0x1da)+_0x382b99+_0x121121(0x2c8)+_0x38a3f2+_0x121121(0x281)),toggleBotMode(_0x382b99);}),tgBot['command'](_0x4042e6(0x2be),async _0x1fa6ff=>{const _0x25259f=_0x4042e6;let _0x528207='';config['forEach'](_0x445d73=>{const _0x561c46=_0x2bd8;_0x528207+='Bot\x20'+_0x445d73[_0x561c46(0x203)]+':\x20'+_0x445d73[_0x561c46(0x27a)]+'\x0a';}),await sendTelegram(_0x1fa6ff[_0x25259f(0x239)]['id'],_0x528207,{'parse_mode':'HTML'});}),tgBot[_0x4042e6(0x290)](_0x4042e6(0x244),async _0x579bc8=>{const _0x3e0579=_0x4042e6;await sendTelegram(_0x579bc8[_0x3e0579(0x239)]['id'],_0x3f6fb9);}),process[_0x4042e6(0x35d)](_0x4042e6(0x29d),()=>tgBot[_0x4042e6(0x317)](_0x4042e6(0x29d))),process['once'](_0x4042e6(0x34b),()=>tgBot[_0x4042e6(0x317)](_0x4042e6(0x34b))),tgBot[_0x4042e6(0x33f)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x27cbde,_0x481ae6,_0x5cd367){const _0x56de1e=_0x1f7dcf;_0x5cd367={..._0x5cd367,'disable_web_page_preview':!![]};try{await tgBot[_0x56de1e(0x1c9)][_0x56de1e(0x3a2)](_0x27cbde,_0x481ae6,_0x5cd367);}catch(_0x5d410c){console[_0x56de1e(0x26f)](_0x56de1e(0x278),_0x5d410c);}}async function sendTelegramBot(_0x350838,_0x1103b2){const _0x58a7bf=_0x1f7dcf;if(settings[_0x58a7bf(0x2d0)]){if(settings[_0x58a7bf(0x34d)]=='all'||(_0x1103b2[_0x58a7bf(0x372)]==_0x58a7bf(0x32c)||_0x1103b2[_0x58a7bf(0x372)]==_0x58a7bf(0x1b2)||_0x1103b2['type']==_0x58a7bf(0x275))&&settings[_0x58a7bf(0x34d)]==_0x58a7bf(0x2ac)||_0x1103b2[_0x58a7bf(0x372)]==_0x58a7bf(0x342)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x58a7bf(0x219)]){if(_0x1103b2[_0x58a7bf(0x30d)])await sendTelegram(settings[_0x58a7bf(0x219)],_0x1103b2[_0x58a7bf(0x27a)]+'\x20>\x20'+_0x1103b2[_0x58a7bf(0x1c0)]);else await sendTelegram(settings['telegramChatId'],_0x58a7bf(0x1d5)+_0x350838+_0x58a7bf(0x2cd)+_0x1103b2[_0x58a7bf(0x1c0)]);}}}}async function sendTelegramMsg(_0xbe51ec,_0x2c8425=_0x1f7dcf(0x2a1)){const _0x549826=_0x1f7dcf;return settings[_0x549826(0x2d0)]&&tgBot&&settings[_0x549826(0x219)]?(await sendTelegram(settings[_0x549826(0x219)],_0xbe51ec,{'parse_mode':_0x2c8425}),!![]):![];}function getDeviceWithIp(_0x674c23){const _0x51b798=_0x1f7dcf;return devices[_0x51b798(0x24b)](_0x19a571=>_0x19a571['ip']===_0x674c23);}async function temporaryAccess2FA(_0x14dea2,_0x4c1d83){const _0x1adb7e=_0x1f7dcf;let _0x5140b6=new Date(),_0xf4c181=![];if(lastIpApproval){if(_0x5140b6-lastIpApproval<0x1388)_0xf4c181=!![];}lastIpApproval=new Date();if(_0xf4c181)return;if(tgBot&&settings[_0x1adb7e(0x219)]){const _0x2a30f6=uuidRandom();tmpStorage[_0x2a30f6]={'uuid':_0x14dea2,'externalip':_0x4c1d83};const _0x4d20a4=Markup[_0x1adb7e(0x2db)]([Markup[_0x1adb7e(0x39a)]['callback']('5\x20min',_0x1adb7e(0x350)+_0x2a30f6),Markup[_0x1adb7e(0x39a)]['callback'](_0x1adb7e(0x1ff),_0x1adb7e(0x1f1)+_0x2a30f6),Markup['button']['callback']('30\x20min',_0x1adb7e(0x309)+_0x2a30f6),Markup[_0x1adb7e(0x39a)][_0x1adb7e(0x1e4)](_0x1adb7e(0x349),'tempaccess_reject_'+_0x2a30f6)]);await sendTelegram(settings[_0x1adb7e(0x219)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x4c1d83)[_0x1adb7e(0x223)]+'\x20?',_0x4d20a4),tgBot[_0x1adb7e(0x1e5)](/tempaccess_(.+)_(.+)/,async _0x3544ee=>{const _0x117c00=_0x1adb7e,_0x42e3fc=_0x3544ee[_0x117c00(0x366)][0x1],_0x48c12e=_0x3544ee[_0x117c00(0x366)][0x2],{uuid:_0x4ff5e0,externalip:_0x46e339}=tmpStorage[_0x48c12e];delete tmpStorage[_0x48c12e],_0x3544ee[_0x117c00(0x2b2)](),devices[_0x4ff5e0][_0x117c00(0x2fa)]={'clientip':_0x46e339,'timestamp':new Date()[_0x117c00(0x355)](),'expiry':_0x42e3fc},_0x42e3fc!='reject'?(await sendTelegram(_0x3544ee['chat']['id'],_0x117c00(0x395)+_0x42e3fc+_0x117c00(0x273),{'parse_mode':_0x117c00(0x2a1)}),io['to'](_0x4ff5e0)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x3544ee[_0x117c00(0x239)]['id'],_0x117c00(0x35b)),io['to'](_0x4ff5e0)[_0x117c00(0x25c)](_0x117c00(0x1de),{'access':{'allow':![],'reason':_0x117c00(0x303),'token':null}}));});}}async function loginAccess2FA(_0x455079,_0x372643){const _0x6c8d0b=_0x1f7dcf;if(tgBot&&settings[_0x6c8d0b(0x219)]){const _0x296179=uuidRandom();tmpStorage[_0x296179]={'uuid':_0x455079,'externalip':_0x372643};const _0x45768f=Markup['inlineKeyboard']([Markup[_0x6c8d0b(0x39a)][_0x6c8d0b(0x1e4)](_0x6c8d0b(0x2c2),_0x6c8d0b(0x3b2)+loginExpiry+'_'+_0x296179),Markup['button'][_0x6c8d0b(0x1e4)]('reject',_0x6c8d0b(0x398)+_0x296179)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x372643)['show']+'\x20?',_0x45768f),tgBot[_0x6c8d0b(0x1e5)](/login2fa_(.+)_(.+)/,async _0x2bd813=>{const _0x39f743=_0x6c8d0b,_0x34f11c=_0x2bd813['match'][0x1],_0x5c7fb=_0x2bd813['match'][0x2],{uuid:_0x3cce51,externalip:_0x19ae87}=tmpStorage[_0x5c7fb];delete tmpStorage[_0x5c7fb],_0x2bd813[_0x39f743(0x2b2)](),devices[_0x3cce51][_0x39f743(0x1e6)]={'clientip':_0x19ae87,'timestamp':new Date()['getTime'](),'expiry':_0x34f11c},_0x34f11c!=_0x39f743(0x349)?(await sendTelegram(_0x2bd813[_0x39f743(0x239)]['id'],_0x39f743(0x3ad),{'parse_mode':_0x39f743(0x2a1)}),io['to'](_0x3cce51)['emit']('status',{'access':{'allow':![],'reason':_0x39f743(0x258),'token':null}})):(await sendTelegram(_0x2bd813['chat']['id'],_0x39f743(0x2ad)),io['to'](_0x3cce51)[_0x39f743(0x25c)]('status',{'access':{'allow':![],'reason':_0x39f743(0x31a),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2ee31e=_0x1f7dcf;return dbConfig[_0x2ee31e(0x379)](_0x2ee31e(0x20b))[_0x2ee31e(0x21f)](_0x2ee31e(0x203))[_0x2ee31e(0x1ba)]({'status':_0x2ee31e(0x2d6)})[_0x2ee31e(0x282)]()||[];}function getDisabledBots(){const _0x2e571c=_0x1f7dcf;return dbConfig[_0x2e571c(0x379)](_0x2e571c(0x20b))[_0x2e571c(0x21f)]('botID')[_0x2e571c(0x1ba)]({'status':'disabled'})[_0x2e571c(0x282)]()||[];}function getBotAttributes(_0x1ba61d){const _0x182516=_0x1f7dcf;let _0x18ba27={};const _0x45e0a2=configpath+_0x182516(0x266)+_0x1ba61d+_0x182516(0x222),_0x7ffec5=fs[_0x182516(0x2e7)](_0x45e0a2);if(_0x7ffec5){const _0x4a2ddc=fs['readFileSync'](_0x45e0a2);try{const _0x1fbf31=JSON['parse'](_0x4a2ddc),_0x4f16b2=_0x1fbf31?_0x1fbf31[_0x182516(0x2de)][0x0][_0x182516(0x1e2)]:![];_0x18ba27['mode']=_0x4f16b2?_0x182516(0x313):_0x182516(0x312),_0x18ba27[_0x182516(0x27a)]=_0x1fbf31?_0x1fbf31['bot'][0x0][_0x182516(0x27a)]:'Bot\x20'+_0x1ba61d;}catch(_0x319378){_0x18ba27[_0x182516(0x242)]=_0x182516(0x312),_0x18ba27[_0x182516(0x27a)]='Bot\x20'+_0x1ba61d;}}else _0x18ba27[_0x182516(0x242)]=_0x182516(0x312),_0x18ba27[_0x182516(0x27a)]=_0x182516(0x1d5)+_0x1ba61d;return _0x18ba27;}function getBotsWithMode(){const _0x3ba4fe=_0x1f7dcf,_0x3e6b62=dbConfig[_0x3ba4fe(0x379)](_0x3ba4fe(0x20b))[_0x3ba4fe(0x21f)]('botID')[_0x3ba4fe(0x282)]()||[];return _0x3e6b62[_0x3ba4fe(0x2fd)](_0x4e3d22=>{const _0x13a183=_0x3ba4fe;let _0x34a977=getBotAttributes(_0x4e3d22[_0x13a183(0x203)]);_0x4e3d22[_0x13a183(0x242)]=_0x34a977[_0x13a183(0x242)];}),_0x3e6b62;}function getBotExchanges(){const _0x42d64f=_0x1f7dcf;let _0x108231=[];const _0x3712dd=dbConfig[_0x42d64f(0x379)]('bots')[_0x42d64f(0x21f)](_0x42d64f(0x203))[_0x42d64f(0x282)]()||[];_0x3712dd[_0x42d64f(0x2fd)](_0x2539ec=>{const _0x356aa0=_0x42d64f;if(_0x2539ec[_0x356aa0(0x1de)]==_0x356aa0(0x2d6)){const _0xf0dbb9=configpath+_0x356aa0(0x266)+_0x2539ec[_0x356aa0(0x203)]+_0x356aa0(0x222),_0x17d221=fs['existsSync'](_0xf0dbb9);let _0x518034;if(_0x17d221){const _0x28f9a0=fs[_0x356aa0(0x1bf)](_0xf0dbb9);try{const _0x16173f=JSON[_0x356aa0(0x288)](_0x28f9a0);_0x518034=_0x16173f?_0x16173f['bot'][0x0][_0x356aa0(0x367)]:null;}catch(_0x549c6a){}}if(_0x518034)_0x108231['push'](_0x518034);}});const _0x3662c3=[...new Set(_0x108231)][_0x42d64f(0x336)]();return _0x3662c3;}async function initUser(){const _0x220f09=_0x1f7dcf;if(!settings[_0x220f09(0x2fe)]){const _0x367700=uuidRandom();mixpanel[_0x220f09(0x22f)](_0x367700),updateSetting(_0x220f09(0x2fe),_0x367700);}}async function initSecure(){const _0x4d32ab=_0x1f7dcf;let _0x1edf0c=getSecure();if(!_0x1edf0c[_0x4d32ab(0x272)]('secret')){let _0x9defcf=await generateKeys();_0x1edf0c[_0x4d32ab(0x378)]=_0x9defcf[_0x4d32ab(0x378)],_0x1edf0c['privateKey']=_0x9defcf[_0x4d32ab(0x2dc)],_0x1edf0c['secret']=crypto[_0x4d32ab(0x2ae)](0x20)[_0x4d32ab(0x283)](_0x4d32ab(0x352));;storeSecure(_0x1edf0c);}}function getSettings(){const _0x70363a=_0x1f7dcf;return dbSettings[_0x70363a(0x379)](_0x70363a(0x329))[_0x70363a(0x282)]()||{};}function getSecure(){const _0x5c3b75=_0x1f7dcf;return dbSecure[_0x5c3b75(0x379)](_0x5c3b75(0x21c))[_0x5c3b75(0x282)]()||{};}function getBlacklist(){const _0x56a373=_0x1f7dcf;return dbSecure[_0x56a373(0x379)]('blacklist')[_0x56a373(0x282)]()||[];}function broadcastToBots(_0x27d9b0,_0x29a11b){const _0x1eb70a=_0x1f7dcf;config[_0x1eb70a(0x2fd)](_0xac1cb4=>{const _0x456168=_0x1eb70a;if(_0xac1cb4['status']==_0x456168(0x2d6)&&_0xac1cb4[_0x456168(0x229)]==_0x456168(0x390)||_0xac1cb4[_0x456168(0x1de)]==_0x456168(0x2b7)&&_0xac1cb4['live']==_0x456168(0x390)){if(pid[_0xac1cb4[_0x456168(0x203)]])pid[_0xac1cb4[_0x456168(0x203)]][_0x456168(0x1eb)]({[_0x27d9b0]:_0x29a11b});}});}async function storeSettings(_0x1215bd,_0x563191=![]){const _0x336534=_0x1f7dcf;_0x1215bd={...settings,..._0x1215bd};if(_0x563191&&_0x1215bd['bbPassword']!='************'&&_0x1215bd[_0x336534(0x28d)]!=_0x336534(0x38a)&&_0x1215bd[_0x336534(0x28d)]!=''){const _0x2012e1=crypt[_0x336534(0x259)](secure[_0x336534(0x2dc)],_0x1215bd['bbPassword'])[_0x336534(0x21e)][_0x336534(0x2c5)](_0x336534(0x2b4))[0x0],_0x5ede59=bcrypt[_0x336534(0x1cf)](_0x2012e1,saltRounds);_0x1215bd={..._0x1215bd,'bbPassword':_0x5ede59};}if(_0x563191&&_0x1215bd[_0x336534(0x36a)]!=_0x336534(0x20e)&&_0x1215bd[_0x336534(0x36a)]!='***'&&_0x1215bd[_0x336534(0x36a)]!=''){const _0x53e422=crypt['decrypt'](secure[_0x336534(0x2dc)],_0x1215bd[_0x336534(0x36a)])['message']['split'](_0x336534(0x2b4))[0x0];_0x1215bd={..._0x1215bd,'telegramToken':_0x53e422};}if(_0x563191&&_0x1215bd[_0x336534(0x340)]!=_0x336534(0x20e)&&_0x1215bd['marketcapApi']!=_0x336534(0x38a)&&_0x1215bd['marketcapApi']!=''){const _0x3f58cb=crypt[_0x336534(0x259)](secure[_0x336534(0x2dc)],_0x1215bd['marketcapApi'])[_0x336534(0x21e)]['split'](_0x336534(0x2b4))[0x0];_0x1215bd={..._0x1215bd,'marketcapApi':_0x3f58cb};}const _0x5a5c26=_0x1215bd[_0x336534(0x36a)]!='************'&&_0x1215bd[_0x336534(0x36a)]!=settings['telegramToken']||_0x1215bd[_0x336534(0x39d)]!=settings['telegramUsername'],_0x33a2e0=_0x1215bd[_0x336534(0x36a)]==''||_0x1215bd[_0x336534(0x39d)]=='',_0x106253=_0x1215bd['marketcapApi']&&_0x1215bd[_0x336534(0x340)]!=_0x336534(0x20e)&&_0x1215bd[_0x336534(0x340)]!=settings['telegramToken'];_0x5a5c26&&(_0x1215bd[_0x336534(0x219)]=null,_0x1215bd[_0x336534(0x34d)]='all');for(const [_0x22ba72,_0x333109]of Object['entries'](_0x1215bd)){if(_0x22ba72==_0x336534(0x36a)&&_0x333109=='************'){_0x1215bd[_0x336534(0x36a)]=settings[_0x336534(0x36a)];continue;};if(_0x22ba72==_0x336534(0x28d)&&_0x333109=='************'){_0x1215bd['bbPassword']=settings[_0x336534(0x28d)];continue;};if(_0x22ba72==_0x336534(0x340)&&_0x333109==_0x336534(0x20e)){_0x1215bd[_0x336534(0x340)]=settings[_0x336534(0x340)];continue;};dbSettings[_0x336534(0x361)](_0x336534(0x2c0)+_0x22ba72,_0x333109)['write']();}settings=_0x1215bd,io['to'](_0x336534(0x2cb))[_0x336534(0x25c)](_0x336534(0x329),cleanSettings()),broadcastToBots(_0x336534(0x1b9),settings[_0x336534(0x1b9)]),broadcastToBots(_0x336534(0x30a),settings['onepagemode']),broadcastToBots(_0x336534(0x340),settings[_0x336534(0x340)]);if(_0x5a5c26&&!_0x33a2e0)initTelegram();if(_0x5a5c26&&_0x33a2e0)disableTelegram();getAllClients()[_0x336534(0x2fd)](_0x4cadf4=>{const _0x39ea0c=_0x336534;getSocket(_0x4cadf4['id'])[_0x39ea0c(0x25c)]('status',{'access':{'allow':![],'reason':_0x39ea0c(0x258),'token':null}});}),_0x106253&&(await sleep(0xbb8),testMarketcapApi(_0x1215bd[_0x336534(0x340)]));}async function testMarketcapApi(_0x1410b9){const _0x4952a0=_0x1f7dcf,_0x1e5ce2=[_0x4952a0(0x332),_0x4952a0(0x1ce)];try{await axios['get'](_0x4952a0(0x218),{'headers':{'X-CMC_PRO_API_KEY':_0x1410b9},'params':{'symbol':_0x1e5ce2[_0x4952a0(0x283)]()}});}catch(_0x31ba7c){_0x31ba7c['toString']()['includes']('status\x20code\x20401')?(io['to'](_0x4952a0(0x2cb))[_0x4952a0(0x25c)](_0x4952a0(0x30f),_0x4952a0(0x37c)),logger[_0x4952a0(0x1cb)](_0x4952a0(0x37c))):(io['to'](_0x4952a0(0x2cb))[_0x4952a0(0x25c)]('notification',_0x4952a0(0x22b)),logger[_0x4952a0(0x1cb)](_0x4952a0(0x22b)),logger[_0x4952a0(0x399)](_0x4952a0(0x26d),_0x31ba7c[_0x4952a0(0x283)]()+_0x4952a0(0x20a)+_0x31ba7c[_0x4952a0(0x389)]));return;}logger['debug'](_0x4952a0(0x26b));}function updateSetting(_0x56a2ab,_0x55cd8c){const _0x406e2f=_0x1f7dcf;dbSettings[_0x406e2f(0x361)](_0x406e2f(0x2c0)+_0x56a2ab,_0x55cd8c)['write'](),settings=getSettings(),io['to'](_0x406e2f(0x2cb))[_0x406e2f(0x25c)](_0x406e2f(0x329),cleanSettings());}function storeSecure(_0x29b611){const _0x362eac=_0x1f7dcf;dbSecure[_0x362eac(0x379)]('secure')[_0x362eac(0x2a0)](_0x29b611)[_0x362eac(0x39b)](),secure=_0x29b611;}function addBlacklist(_0x2c9ea1){const _0x40a594=_0x1f7dcf;cleanBlacklist();let _0x4c29f0;devices[_0x2c9ea1]['telegramIpApproval']?_0x4c29f0=Math['max'](devices[_0x2c9ea1][_0x40a594(0x2fa)][_0x40a594(0x338)],loginExpiry):_0x4c29f0=loginExpiry,dbSecure['get'](_0x40a594(0x238))[_0x40a594(0x2a0)]({'expiry':new Date()[_0x40a594(0x355)]()+_0x4c29f0*0x3c*0x3e8,'token':devices[_0x2c9ea1][_0x40a594(0x1c7)][_0x40a594(0x24c)]})[_0x40a594(0x39b)](),blacklist=dbSecure[_0x40a594(0x379)](_0x40a594(0x238))[_0x40a594(0x282)]();}function cleanBlacklist(){const _0x469919=_0x1f7dcf;let _0x4e682a=dbSecure[_0x469919(0x379)](_0x469919(0x238))[_0x469919(0x300)]()[_0x469919(0x282)](),_0x5f266e=new Date()[_0x469919(0x355)]();_0x4e682a['forEach'](_0x4b7af3=>{const _0x26e7fe=_0x469919;_0x4b7af3['expiry']<_0x5f266e&&dbSecure[_0x26e7fe(0x379)]('blacklist')['remove']({'expiry':_0x4b7af3[_0x26e7fe(0x338)]})['write']();});}function initStates(){const _0x10a4c5=_0x1f7dcf;let _0x1128da=getConfiguration();_0x1128da[_0x10a4c5(0x2fd)](_0x44ca37=>{const _0x3db717=_0x10a4c5;_0x44ca37[_0x3db717(0x229)]=_0x3db717(0x1f7);}),storeConfiguration(_0x1128da);}function onKeys(){const _0x3765b6=new RSA();return new Promise(_0x514417=>{const _0x2b90c1=_0x2bd8;_0x3765b6['generateKeyPairAsync']()[_0x2b90c1(0x209)](_0xd79f72=>{_0x514417(_0xd79f72);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4a6d8d=_0x1f7dcf;let _0x3252cd=getSettings(),_0x3d38b=![];!_0x3252cd[_0x4a6d8d(0x272)]('lastmsgtelegram')&&(_0x3252cd[_0x4a6d8d(0x268)]=0x0,_0x3d38b=!![]);!_0x3252cd[_0x4a6d8d(0x272)](_0x4a6d8d(0x1c5))&&(_0x3252cd['lastmsgemitted']=0x0,_0x3d38b=!![]);!_0x3252cd[_0x4a6d8d(0x272)](_0x4a6d8d(0x34e))&&(_0x3252cd[_0x4a6d8d(0x34e)]=_0x4a6d8d(0x1c8),_0x3d38b=!![]);!_0x3252cd[_0x4a6d8d(0x272)]('onepagemode')&&(_0x3252cd[_0x4a6d8d(0x30a)]=![],_0x3d38b=!![]);!_0x3252cd[_0x4a6d8d(0x272)](_0x4a6d8d(0x340))&&(_0x3252cd[_0x4a6d8d(0x340)]='',_0x3d38b=!![]);if(_0x3d38b)storeSettings(_0x3252cd);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x4a6d8d(0x2fd)](_0x5c7138=>{const _0x28d8f3=_0x4a6d8d;if(!_0x5c7138['isDirectory']()){if(!_0x5c7138[_0x28d8f3(0x328)][_0x28d8f3(0x2e3)](_0x28d8f3(0x38c)))fs['unlinkSync'](configbackuppath+_0x5c7138['name']);}else fs[_0x28d8f3(0x253)](configbackuppath+_0x5c7138[_0x28d8f3(0x328)],{'recursive':!![]});});}catch(_0x2d8c44){logger['debug'](_0x4a6d8d(0x2cc),_0x2d8c44);}}function storeConfiguration(_0x59cd03){const _0x19a8f2=_0x1f7dcf;dbConfig['get']('bots')[_0x19a8f2(0x2ea)]()['write'](),dbConfig[_0x19a8f2(0x379)]('bots')[_0x19a8f2(0x2a0)](..._0x59cd03)['write'](),config=_0x59cd03;}async function resetPassword(){const _0xa2469e=_0x1f7dcf;if(tgBot&&settings[_0xa2469e(0x219)]){const _0x20de69=Markup[_0xa2469e(0x2db)]([Markup[_0xa2469e(0x39a)][_0xa2469e(0x1e4)]('yes','resetpw_yes'),Markup[_0xa2469e(0x39a)][_0xa2469e(0x1e4)]('no',_0xa2469e(0x2f7))]);await sendTelegram(settings[_0xa2469e(0x219)],_0xa2469e(0x22d),_0x20de69),tgBot[_0xa2469e(0x1e5)](/resetpw_(.+)/,async _0x66e01=>{const _0x5dddd8=_0xa2469e,_0x1bac37=_0x66e01[_0x5dddd8(0x366)][0x1];_0x66e01[_0x5dddd8(0x2b2)]();if(_0x1bac37!='no'){const _0x7f0769=0xf,_0x2c4e67=_0x5dddd8(0x29f),_0x3ddcb3=Array[_0x5dddd8(0x1f4)](crypto[_0x5dddd8(0x384)](new Uint32Array(_0x7f0769)))[_0x5dddd8(0x345)](_0x28206e=>_0x2c4e67[_0x28206e%_0x2c4e67[_0x5dddd8(0x27b)]])[_0x5dddd8(0x1ea)](''),_0x5825c6=bcrypt['hashSync'](_0x3ddcb3,saltRounds);storeSettings({'bbPassword':_0x5825c6}),await sendTelegram(_0x66e01['chat']['id'],_0x5dddd8(0x354)+_0x3ddcb3,{'parse_mode':'HTML'});}else await sendTelegram(_0x66e01[_0x5dddd8(0x239)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x281839,_0x55bc49){const _0x10d3ee=_0x1f7dcf;io['to'](_0x10d3ee(0x2cb))[_0x10d3ee(0x25c)](_0x10d3ee(0x30f),_0x10d3ee(0x252),_0x10d3ee(0x275));if(tgBot&&settings[_0x10d3ee(0x219)]){const _0x2a3681=uuidRandom();tmpStorage[_0x2a3681]={'path':_0x281839,'filename':_0x55bc49};const _0x817e3f=Markup[_0x10d3ee(0x2db)]([Markup[_0x10d3ee(0x39a)][_0x10d3ee(0x1e4)](_0x10d3ee(0x333),_0x10d3ee(0x1e0)+_0x2a3681),Markup['button'][_0x10d3ee(0x1e4)]('no',_0x10d3ee(0x386)+_0x2a3681)]);await sendTelegram(settings[_0x10d3ee(0x219)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x817e3f),tgBot[_0x10d3ee(0x1e5)](/restore_(.+)_(.+)/,async _0x5a43c7=>{const _0x517612=_0x10d3ee,_0x29f156=_0x5a43c7[_0x517612(0x366)][0x1],_0x1bfe9a=_0x5a43c7[_0x517612(0x366)][0x2],{path:_0x5b2759,filename:_0x178291}=tmpStorage[_0x1bfe9a];delete tmpStorage[_0x1bfe9a],_0x5a43c7[_0x517612(0x2b2)](),_0x29f156==_0x517612(0x333)?(logger['debug'](_0x517612(0x2ab)),await sendTelegram(_0x5a43c7[_0x517612(0x239)]['id'],_0x517612(0x2ed),{'parse_mode':_0x517612(0x2a1)}),unzipFile(_0x5b2759,_0x178291)):(logger[_0x517612(0x399)]('Restore\x20process\x20aborted'),await sendTelegram(_0x5a43c7['chat']['id'],_0x517612(0x2e1)));});}}function getServerTime(){const _0x3d2148=_0x1f7dcf,_0x5ee721=new Date();return _0x5ee721['getFullYear']()+'/'+(_0x5ee721['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x5ee721[_0x3d2148(0x323)]()[_0x3d2148(0x283)]()[_0x3d2148(0x241)](0x2,'0')+'\x20'+_0x5ee721[_0x3d2148(0x299)]()[_0x3d2148(0x283)]()[_0x3d2148(0x241)](0x2,'0')+':'+_0x5ee721[_0x3d2148(0x1fe)]()['toString']()['padStart'](0x2,'0')+':'+_0x5ee721['getSeconds']()[_0x3d2148(0x283)]()[_0x3d2148(0x241)](0x2,'0');}function getTimeStamp(){const _0x5bfd96=_0x1f7dcf,_0x4a73d8=shiftedTime();return _0x4a73d8[_0x5bfd96(0x20d)]()+'/'+(_0x4a73d8['getMonth']()+0x1)[_0x5bfd96(0x283)]()[_0x5bfd96(0x241)](0x2,'0')+'/'+_0x4a73d8[_0x5bfd96(0x323)]()['toString']()[_0x5bfd96(0x241)](0x2,'0')+'\x20'+_0x4a73d8['getHours']()[_0x5bfd96(0x283)]()['padStart'](0x2,'0')+':'+_0x4a73d8[_0x5bfd96(0x1fe)]()['toString']()[_0x5bfd96(0x241)](0x2,'0')+':'+_0x4a73d8[_0x5bfd96(0x28b)]()[_0x5bfd96(0x283)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x1578ff=_0x1f7dcf,_0x5849a1=shiftedTime();return _0x5849a1[_0x1578ff(0x20d)]()+(_0x5849a1['getMonth']()+0x1)[_0x1578ff(0x283)]()[_0x1578ff(0x241)](0x2,'0')+_0x5849a1[_0x1578ff(0x323)]()[_0x1578ff(0x283)]()['padStart'](0x2,'0')+'-'+_0x5849a1[_0x1578ff(0x299)]()[_0x1578ff(0x283)]()[_0x1578ff(0x241)](0x2,'0')+_0x5849a1[_0x1578ff(0x1fe)]()[_0x1578ff(0x283)]()[_0x1578ff(0x241)](0x2,'0')+_0x5849a1[_0x1578ff(0x28b)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x16175c=_0x1f7dcf,_0x3d1a8c=new Date();let _0x10e939=_0x3d1a8c;if(settings[_0x16175c(0x1b9)]&&settings[_0x16175c(0x1b9)]!==0x0)_0x10e939=fns['add'](_0x3d1a8c,{'hours':settings[_0x16175c(0x1b9)]});return _0x10e939;}async function startScheduler(){const _0x1325dc=_0x1f7dcf,_0xc2440d=new Date()[_0x1325dc(0x33c)](),_0x45f205=shiftedTime()['getHours']();_0x45f205==0x4&&backupConfigFiles(),_0x45f205==0x0&&rotateLogFiles(),_0xc2440d%0x6==0x0&&triggerAnalytics(),_0xc2440d%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x14c9eb){const _0xd93e98=_0x1f7dcf;logger['debug'](_0xd93e98(0x1c1)+_0x14c9eb);const _0x3c9760=getBotsWithMode();_0x3c9760[_0xd93e98(0x27b)]>0x0?confirmRestore(configbackuppath,_0x14c9eb):unzipFile(configbackuppath,_0x14c9eb);}async function getBackupFiles(_0x99eae6=null){const _0x1fb46e=_0x1f7dcf;let _0x20fc8a=[],_0x556be4=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x556be4[_0x1fb46e(0x336)]((_0x3f10ed,_0x359548)=>_0x3f10ed['name']<_0x359548[_0x1fb46e(0x328)]?0x1:_0x359548[_0x1fb46e(0x328)]<_0x3f10ed[_0x1fb46e(0x328)]?-0x1:0x0),_0x556be4[_0x1fb46e(0x2fd)](_0x5b52e6=>{const _0x9de759=_0x1fb46e;if(!_0x5b52e6[_0x9de759(0x1af)]()&&_0x5b52e6['name']['startsWith']('backup-full@')&&_0x5b52e6[_0x9de759(0x328)]['endsWith'](_0x9de759(0x2d7))){const _0x243fd0=formatDate(fs[_0x9de759(0x348)](configbackuppath+_0x5b52e6['name'])[_0x9de759(0x351)]);_0x20fc8a[_0x9de759(0x2a0)]({'name':_0x5b52e6[_0x9de759(0x328)],'mtime':_0x243fd0});}});if(_0x99eae6)io['to'](_0x99eae6)[_0x1fb46e(0x25c)](_0x1fb46e(0x318),_0x20fc8a);else return _0x20fc8a;}async function backupConfigFiles(){const _0x292878=_0x1f7dcf;await zipFiles('backup-full');const _0x47bc1e=getCleanTimeStamp();fs[_0x292878(0x2a9)](zippath+_0x292878(0x346),configbackuppath+(_0x292878(0x38c)+_0x47bc1e+_0x292878(0x2d7)));let _0x12a488=fs[_0x292878(0x1fc)](configbackuppath,{'withFileTypes':!![]});_0x12a488[_0x292878(0x336)]((_0x214136,_0x57fb99)=>_0x214136['name']<_0x57fb99[_0x292878(0x328)]?0x1:_0x57fb99[_0x292878(0x328)]<_0x214136[_0x292878(0x328)]?-0x1:0x0),_0x12a488[_0x292878(0x27b)]>maxBackups&&fs[_0x292878(0x246)](configbackuppath+_0x12a488[_0x12a488['length']-0x1]['name']);}function rotateLogFiles(){const _0x3fa0bc=_0x1f7dcf,_0x408772=fs[_0x3fa0bc(0x348)](logspath+'output-000.log'),_0x388c95=_0x408772[_0x3fa0bc(0x343)]/0x400;if(_0x388c95>0x64){let _0x40280d=fs[_0x3fa0bc(0x1fc)](logspath,{'withFileTypes':!![]});_0x40280d[_0x3fa0bc(0x336)]((_0x20bc23,_0x20b628)=>_0x20bc23['name']<_0x20b628[_0x3fa0bc(0x328)]?0x1:_0x20b628[_0x3fa0bc(0x328)]<_0x20bc23[_0x3fa0bc(0x328)]?-0x1:0x0),_0x40280d['forEach'](_0x4559d1=>{const _0x2f4ffa=_0x3fa0bc;if(_0x4559d1['name']=='output-002.log')fs[_0x2f4ffa(0x2a9)](logspath+_0x4559d1[_0x2f4ffa(0x328)],logspath+_0x2f4ffa(0x234));if(_0x4559d1[_0x2f4ffa(0x328)]==_0x2f4ffa(0x3a5))fs[_0x2f4ffa(0x2a9)](logspath+_0x4559d1[_0x2f4ffa(0x328)],logspath+_0x2f4ffa(0x2a6));_0x4559d1[_0x2f4ffa(0x328)]=='output-000.log'&&(fs[_0x2f4ffa(0x2a9)](logspath+_0x4559d1[_0x2f4ffa(0x328)],logspath+_0x2f4ffa(0x3a5)),fs['writeFileSync'](logspath+_0x4559d1[_0x2f4ffa(0x328)],''));});}}async function zipFiles(_0x80c5a9){const _0x4ddad4=_0x1f7dcf;let _0x4c6fc3;if(_0x80c5a9==_0x4ddad4(0x1b8))_0x4c6fc3=logspath;if(_0x80c5a9==_0x4ddad4(0x32b))_0x4c6fc3=configpath;if(_0x80c5a9==_0x4ddad4(0x2fb))_0x4c6fc3=configpath;let _0x218307=fs['readdirSync'](_0x4c6fc3,{'withFileTypes':!![]});const _0x9c41fe=new require(_0x4ddad4(0x1c2))();_0x218307['forEach'](_0x329820=>{const _0x4068af=_0x4ddad4;if(!_0x329820[_0x4068af(0x1af)]()){let _0x3b3eda=fs['readFileSync'](_0x4c6fc3+_0x329820[_0x4068af(0x328)]);if(_0x80c5a9=='backup'){const _0x24e5a8=/^bot-[0-9]{3}-config.json$/,_0x59a84c=_0x24e5a8[_0x4068af(0x286)](_0x329820[_0x4068af(0x328)]);if(_0x59a84c){const _0x4b8ff2=JSON[_0x4068af(0x288)](_0x3b3eda);if(_0x4b8ff2[_0x4068af(0x2de)][0x0]){_0x4b8ff2['bot'][0x0]['apiKey']=_0x4068af(0x38a),_0x4b8ff2[_0x4068af(0x2de)][0x0][_0x4068af(0x284)]=_0x4068af(0x38a);if(_0x4b8ff2['bot'][0x0][_0x4068af(0x382)])_0x4b8ff2[_0x4068af(0x2de)][0x0]['apiPassword']=_0x4068af(0x38a);}_0x3b3eda=JSON[_0x4068af(0x2c3)](_0x4b8ff2,null,0x2);}if(_0x329820[_0x4068af(0x328)]=='bb-settings.json'){const _0x278ebb=JSON[_0x4068af(0x288)](_0x3b3eda);if(_0x278ebb[_0x4068af(0x329)][_0x4068af(0x2f4)])_0x278ebb[_0x4068af(0x329)]['loginRequired']=![];if(_0x278ebb[_0x4068af(0x329)]['bbPassword'])_0x278ebb[_0x4068af(0x329)][_0x4068af(0x28d)]=_0x4068af(0x38a);if(_0x278ebb[_0x4068af(0x329)][_0x4068af(0x36a)])_0x278ebb[_0x4068af(0x329)][_0x4068af(0x36a)]='***';if(_0x278ebb[_0x4068af(0x329)][_0x4068af(0x219)])_0x278ebb[_0x4068af(0x329)][_0x4068af(0x219)]=null;if(_0x278ebb[_0x4068af(0x329)]['marketcapApi'])_0x278ebb[_0x4068af(0x329)][_0x4068af(0x340)]=_0x4068af(0x38a);_0x3b3eda=JSON[_0x4068af(0x2c3)](_0x278ebb,null,0x2);}if(_0x329820[_0x4068af(0x328)]!=_0x4068af(0x310))_0x9c41fe[_0x4068af(0x260)](_0x329820[_0x4068af(0x328)],_0x3b3eda);}else _0x9c41fe[_0x4068af(0x260)](_0x329820[_0x4068af(0x328)],_0x3b3eda);}});const _0x4e518a=_0x9c41fe[_0x4ddad4(0x294)]({'base64':![],'compression':_0x4ddad4(0x33d)});fs[_0x4ddad4(0x25d)](zippath+(_0x80c5a9+_0x4ddad4(0x2d7)),_0x4e518a,'binary');}async function unzipFile(_0x9efab4,_0x390807){const _0x5a165e=_0x1f7dcf;fs[_0x5a165e(0x1fc)](configpath,{'withFileTypes':!![]})[_0x5a165e(0x2fd)](_0x298953=>{const _0x629977=_0x5a165e;if(!_0x298953['isDirectory']())fs['rmSync'](configpath+_0x298953[_0x629977(0x328)]);});const _0x39a7af=fs['readFileSync'](_0x9efab4+_0x390807,_0x5a165e(0x32d)),_0x23de4b=new require(_0x5a165e(0x1c2))(_0x39a7af,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x23de4b['files'])[_0x5a165e(0x2fd)](_0x29179e=>{const _0x36ab16=_0x5a165e,_0x5d79a6=_0x23de4b['files'][_0x29179e];fs[_0x36ab16(0x25d)](configpath+_0x5d79a6['name'],_0x5d79a6[_0x36ab16(0x256)]);}),fs[_0x5a165e(0x1fc)](temppath,{'withFileTypes':!![]})[_0x5a165e(0x2fd)](_0x59176b=>{const _0x247881=_0x5a165e;if(!_0x59176b[_0x247881(0x1af)]())fs[_0x247881(0x253)](temppath+_0x59176b[_0x247881(0x328)]);}),logger[_0x5a165e(0x399)](_0x5a165e(0x208)),process[_0x5a165e(0x1eb)]({'restore':!![]},_0x510c74=>{});}async function getPublicIp(){const _0x20f15a=_0x1f7dcf;try{const _0x2c47b9=await axios[_0x20f15a(0x379)]('https://api.ipify.org?format=json');publicip=_0x2c47b9[_0x20f15a(0x22e)]['ip'];}catch(_0x577a83){}}async function triggerAnalytics(){const _0xfc5c8=_0x1f7dcf;if(!publicip)await getPublicIp();const _0x39822b=getBotsWithMode();let _0x170cfc=0x0;_0x39822b[_0xfc5c8(0x2fd)](_0x135697=>{const _0x29c12a=_0xfc5c8;if(_0x135697[_0x29c12a(0x1de)]==='enabled')_0x170cfc++;});const _0x18c3e2=getBotExchanges();mixpanel[_0xfc5c8(0x25a)](_0xfc5c8(0x1ee),{'distinct_id':settings[_0xfc5c8(0x2fe)],'ip':publicip,'version':serverversion,'numbots':_0x39822b[_0xfc5c8(0x27b)],'numbotsenabled':_0x170cfc,'exchanges':_0x18c3e2,'environment':environment});}async function getMessages(){const _0x596cd4=_0x1f7dcf,_0x5ef281='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x39fa2b=new GraphQLClient(_0x5ef281),_0x50f63f={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x399bad=serverversion['split']('.'),_0x13d5d3=_0x399bad[0x0]+'.'+_0x399bad[0x1],_0x85bbbd=Math[_0x596cd4(0x212)](settings[_0x596cd4(0x268)],settings[_0x596cd4(0x1c5)]),_0x1764bd={'last':parseInt(_0x85bbbd),'bbm':_0x13d5d3},_0x36ecf9=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x47ab54;try{_0x47ab54=await _0x39fa2b['request'](_0x36ecf9,_0x1764bd,_0x50f63f);}catch(_0x7ff4ee){}if(_0x47ab54&&_0x47ab54['messages']){let _0x5d40b1=settings['lastmsgtelegram'];newMessages=[];for(const _0xf03cbf of _0x47ab54[_0x596cd4(0x1fb)]){newMessages[_0x596cd4(0x2a0)](_0xf03cbf);let _0x33cced=![];_0xf03cbf['bbvNew']&&(updateSetting(_0x596cd4(0x34e),_0xf03cbf['bbvNew']),_0x33cced=isNewerVersion(serverversion,_0xf03cbf[_0x596cd4(0x2eb)])||serverversion==_0xf03cbf['bbvNew']);if(!_0x33cced&&_0xf03cbf[_0x596cd4(0x35e)]>_0x5d40b1){if(_0xf03cbf[_0x596cd4(0x27d)]===_0x596cd4(0x2b0)||serverversion[_0x596cd4(0x2e3)](_0xf03cbf[_0x596cd4(0x27d)])){let _0x48c3d8=''+_0xf03cbf['title']+'\x0a\x0a'+_0xf03cbf[_0x596cd4(0x21e)];const _0x40eace=await sendTelegramMsg(toTelegramMarkdown(_0x48c3d8),_0x596cd4(0x35c));if(_0x40eace)_0x5d40b1=_0xf03cbf[_0x596cd4(0x35e)];}}}updateAvailable=isNewerVersion(settings[_0x596cd4(0x34e)],serverversion),updateSetting(_0x596cd4(0x268),_0x5d40b1),emitMessages();}}function emitMessages(){const _0x4f56cc=_0x1f7dcf,_0x12f551=settings['lastmsgemitted'];let _0x1d4a38=[];newMessages[_0x4f56cc(0x2fd)](_0x493eab=>{const _0x10e5a7=_0x4f56cc;_0x493eab['number']>_0x12f551&&_0x1d4a38[_0x10e5a7(0x2a0)](_0x493eab);}),_0x1d4a38['length']>0x0&&getAllClients()[_0x4f56cc(0x2fd)](_0x4d694b=>{const _0xdea9f0=_0x4f56cc;getSocket(_0x4d694b['id'])[_0xdea9f0(0x25c)](_0xdea9f0(0x21e),_0x1d4a38);});}function confirmMessage(_0x513bb0){updateSetting('lastmsgemitted',Number(_0x513bb0));}function isNewerVersion(_0xaa248c,_0x559b8f){const _0x125feb=_0x1f7dcf,_0x2f2725=_0x559b8f[_0x125feb(0x2c5)]('.'),_0x57c08c=_0xaa248c['split']('.');for(var _0x2652c5=0x0;_0x2652c5<_0x57c08c[_0x125feb(0x27b)];_0x2652c5++){const _0x545d0e=~~_0x57c08c[_0x2652c5],_0x511fb3=~~_0x2f2725[_0x2652c5];if(_0x545d0e>_0x511fb3)return!![];if(_0x545d0e<_0x511fb3)return![];}return![];}function toTelegramMarkdown(_0x102c08){const _0x472c12=_0x1f7dcf,_0x10f204=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4aab31=/\*{2}(.+?)\*{2}/gim;return _0x102c08=_0x102c08[_0x472c12(0x3a9)](_0x10f204,_0x472c12(0x306))[_0x472c12(0x3a9)](_0x4aab31,_0x472c12(0x391)),_0x102c08;}async function validateConfigFile(){const _0x505037=_0x1f7dcf,_0x335400=dbConfig[_0x505037(0x379)]('bots')[_0x505037(0x21f)](_0x505037(0x203))[_0x505037(0x282)]()||[];if(_0x335400['length']==0x0){let _0x4c69ab=0x0,_0x39f6df=[];const _0x42019f=/^bot-([0-9]{3})-config.json$/,_0x27cd68=fs[_0x505037(0x1fc)](configpath);_0x27cd68[_0x505037(0x2fd)](_0x38ed77=>{const _0x560919=_0x505037,_0x44ce90=_0x42019f[_0x560919(0x1bb)](_0x38ed77);if(_0x44ce90){const _0x22458a=_0x44ce90[0x1];let _0x2dfcc2=getBotAttributes(_0x22458a);_0x39f6df['push']({'botID':_0x22458a,'botname':_0x2dfcc2['botname'],'status':_0x560919(0x21b),'live':_0x560919(0x1f7)}),_0x4c69ab++;}}),_0x4c69ab!=0x0&&(dbConfig[_0x505037(0x379)](_0x505037(0x20b))[_0x505037(0x1a9)](_0x39f6df)[_0x505037(0x39b)](),config=_0x39f6df,restoredConfigFile=_0x4c69ab);}}async function restoreConfigNotify(_0x5b9031){const _0x3efb55=_0x1f7dcf;let _0x33dd15;if(restoredConfigFile==0x1)_0x33dd15=_0x3efb55(0x23a);else _0x33dd15=_0x3efb55(0x277);if(_0x5b9031)io['to'](_0x3efb55(0x2cb))[_0x3efb55(0x25c)](_0x3efb55(0x30f),_0x33dd15);else{logger[_0x3efb55(0x3a6)](_0x3efb55(0x1b3)),logger[_0x3efb55(0x3a6)](_0x33dd15),logger['simple'](_0x3efb55(0x1b3)),logger[_0x3efb55(0x3a6)]('');if(tgBot&&settings[_0x3efb55(0x219)]&&settings[_0x3efb55(0x34d)]!=_0x3efb55(0x364))await sendTelegram(settings[_0x3efb55(0x219)],_0x3efb55(0x358)+_0x33dd15);}}function validateCredentials(_0xe265a,_0x5dff26){const _0x72504e=_0x1f7dcf;if(_0xe265a['username']==settings['bbUsername']&&bcrypt['compareSync'](_0xe265a[_0x72504e(0x2a3)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x72504e(0x2fc),'token':null};else{const _0x363727=generateLoginToken(_0x5dff26);return{'allow':!![],'reason':_0x72504e(0x1db),'token':_0x363727};}}else return{'allow':![],'reason':_0x72504e(0x392),'token':null};}function refreshToken(_0x5dc5af){const _0x18f882=_0x1f7dcf,_0x49a06d=generateLoginToken(_0x5dc5af);return{'allow':!![],'reason':_0x18f882(0x1db),'token':_0x49a06d};}function validateAccess(_0x537a67,_0x3cae71,_0x1af3c1){const _0xd6a32c=_0x1f7dcf,_0x3721b5=_0x1af3c1?_0x1af3c1:devices[_0x3cae71]['ip'];let _0x15f387;const _0x231791=_0x254a62=>{const _0xbc3649=_0x2bd8;if(settings[_0xbc3649(0x2f4)]){if(settings[_0xbc3649(0x237)]){if(telegram2FaApproved(_0x3cae71)){const _0x25a590=generateLoginToken(_0x3cae71);return{'allow':!![],'reason':_0xbc3649(0x32a),'token':_0x25a590};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x15f387=validToken(_0x254a62,_0x3cae71),_0x15f387[_0xbc3649(0x272)](_0xbc3649(0x275))?{'allow':!![],'reason':_0xbc3649(0x362),'token':_0x254a62}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0xd6a32c(0x39c)]){let _0x2cd4e4=[...settings[_0xd6a32c(0x370)],'::1','::ffff:127.0.0.1',_0xd6a32c(0x353)];if(_0x2cd4e4[_0xd6a32c(0x315)](_0x3721b5))return _0x231791(_0x537a67);else{_0x15f387=validToken(_0x537a67,_0x3cae71);if(_0x15f387[_0xd6a32c(0x272)](_0xd6a32c(0x275)))return _0x231791(_0x537a67);else{if(telegramIpApproved(_0x3cae71)){const _0x3eb92d=generateToken(_0x3cae71);return _0x15f387=_0x231791(_0x537a67),_0x15f387[_0xd6a32c(0x1f5)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3eb92d}:_0x15f387;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0xd6a32c(0x3a8),'token':null}:{'allow':![],'reason':_0xd6a32c(0x1ed),'token':null};}}}else return _0x231791(_0x537a67);}function timelyDecrypt(_0x1a8a7f,_0xca78fb,_0x5226ee='@'){const _0x27581b=_0x1f7dcf;if(_0x1a8a7f)try{const _0x595ffe=crypt[_0x27581b(0x259)](secure['privateKey'],_0x1a8a7f)[_0x27581b(0x21e)],_0x3e4d02=_0x595ffe[_0x27581b(0x2c5)](_0x5226ee)[0x0],_0x166a4c=_0x595ffe[_0x27581b(0x2c5)](_0x5226ee)[0x1],_0x4f05c6=new Date()[_0x27581b(0x355)]();if(_0xca78fb){if(_0x4f05c6-_0x166a4c<maxSecretAge*0x3e8)return _0x3e4d02;else return![];}else return _0x3e4d02;}catch(_0x1966a1){return![];}else return![];}const validToken=(_0x4b60e6,_0x1a6724)=>{const _0x3db1ef=_0x1f7dcf,_0x2073bb=devices[_0x1a6724]['ip'];if(!_0x4b60e6)return{'error':_0x3db1ef(0x211)};for(let _0x49b94d of blacklist){if(_0x49b94d[_0x3db1ef(0x24c)]==_0x4b60e6)return{'error':_0x3db1ef(0x3a0)};}let _0x15d5d5;try{_0x15d5d5=jwt[_0x3db1ef(0x250)](_0x4b60e6,secure['secret']+_0x1a6724);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x15d5d5[_0x3db1ef(0x272)](_0x3db1ef(0x2a5))&&!_0x15d5d5[_0x3db1ef(0x272)]('username')||!_0x15d5d5[_0x3db1ef(0x272)](_0x3db1ef(0x1b7)))return{'error':_0x3db1ef(0x226)};if(!_0x15d5d5['hasOwnProperty'](_0x3db1ef(0x21a))&&_0x15d5d5[_0x3db1ef(0x272)](_0x3db1ef(0x2a5))){const {clientip:_0x4d3bf9}=_0x15d5d5;return _0x2073bb==_0x4d3bf9?{'success':_0x3db1ef(0x2a2)}:{'error':_0x3db1ef(0x35f)};}else{if(_0x15d5d5['hasOwnProperty'](_0x3db1ef(0x21a))&&_0x15d5d5['hasOwnProperty'](_0x3db1ef(0x2a5))){const {username:_0x16de8c,clientip:_0x16ee09}=_0x15d5d5;return settings[_0x3db1ef(0x1f8)]==_0x16de8c&&_0x2073bb==_0x16ee09?{'success':_0x3db1ef(0x2a2)}:{'error':_0x3db1ef(0x1ad)};}}},generateLoginToken=_0x342b5f=>{const _0x56e6cd=_0x1f7dcf;if(_0x342b5f){const _0x1e0f5a=devices[_0x342b5f]['ip'];return jwt[_0x56e6cd(0x1d3)]({'username':settings['bbUsername'],'clientip':_0x1e0f5a},secure['secret']+_0x342b5f,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1a7077=>{const _0x20bbce=_0x1f7dcf;if(_0x1a7077){const _0x163c32=devices[_0x1a7077]['ip'];return jwt['sign']({'clientip':_0x163c32},secure[_0x20bbce(0x269)]+_0x1a7077,{'expiresIn':devices[_0x1a7077][_0x20bbce(0x2fa)][_0x20bbce(0x338)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x37fc3e=>{const _0x5976d0=_0x1f7dcf;let _0x3d0460=![];return devices[_0x37fc3e][_0x5976d0(0x2fa)]&&devices[_0x37fc3e][_0x5976d0(0x2fa)][_0x5976d0(0x338)]!='reject'&&(_0x3d0460=devices[_0x37fc3e][_0x5976d0(0x2fa)][_0x5976d0(0x2a5)]==devices[_0x37fc3e]['ip']&&new Date()[_0x5976d0(0x355)]()-devices[_0x37fc3e][_0x5976d0(0x2fa)][_0x5976d0(0x1f0)]<devices[_0x37fc3e][_0x5976d0(0x2fa)][_0x5976d0(0x338)]*0x3c*0x3e8),_0x3d0460;},telegram2FaApproved=_0x1d3987=>{const _0x29d8ca=_0x1f7dcf;let _0x3a3cbf=![];return devices[_0x1d3987]['telegram2FaApproval']&&devices[_0x1d3987][_0x29d8ca(0x1e6)]['expiry']!=_0x29d8ca(0x349)&&(_0x3a3cbf=devices[_0x1d3987][_0x29d8ca(0x1e6)][_0x29d8ca(0x2a5)]==devices[_0x1d3987]['ip']&&new Date()[_0x29d8ca(0x355)]()-devices[_0x1d3987][_0x29d8ca(0x1e6)][_0x29d8ca(0x1f0)]<devices[_0x1d3987]['telegram2FaApproval'][_0x29d8ca(0x338)]*0x3c*0x3e8),_0x3a3cbf;},normalizeIP=_0x1d74c4=>{const _0x1ccd20=_0x1f7dcf;let _0xc82fa9=null,_0x31c66c=null;if(ipaddr[_0x1ccd20(0x2f1)](_0x1d74c4)){const _0x5a52a9=ipaddr['parse'](_0x1d74c4);_0x5a52a9[_0x1ccd20(0x393)]()===_0x1ccd20(0x291)?(_0x5a52a9[_0x1ccd20(0x301)]()&&(_0xc82fa9=_0x5a52a9['toIPv4Address']()[_0x1ccd20(0x283)]()),_0x31c66c=_0x5a52a9[_0x1ccd20(0x283)]()):(_0xc82fa9=_0x5a52a9['toString'](),_0x31c66c=_0x5a52a9[_0x1ccd20(0x225)]()[_0x1ccd20(0x283)]());}return{'show':_0xc82fa9?_0xc82fa9:_0x31c66c,'store':_0x31c66c};};function formatDate(_0x343080){const _0x422299=_0x1f7dcf;return _0x343080[_0x422299(0x20d)]()+'/'+(_0x343080['getMonth']()+0x1)[_0x422299(0x283)]()[_0x422299(0x241)](0x2,'0')+'/'+_0x343080[_0x422299(0x323)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x343080[_0x422299(0x299)]()[_0x422299(0x283)]()[_0x422299(0x241)](0x2,'0')+':'+_0x343080[_0x422299(0x1fe)]()[_0x422299(0x283)]()[_0x422299(0x241)](0x2,'0')+':'+_0x343080[_0x422299(0x28b)]()[_0x422299(0x283)]()[_0x422299(0x241)](0x2,'0');}function sleep(_0x545300){return new Promise(_0x73c223=>setTimeout(_0x73c223,_0x545300));}