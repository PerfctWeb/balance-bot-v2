const _0x2ff023=_0x17a2;(function(_0x3948d0,_0x5f48ed){const _0x38350e=_0x17a2,_0x3cd5e8=_0x3948d0();while(!![]){try{const _0x227fdb=-parseInt(_0x38350e(0x31c))/0x1*(-parseInt(_0x38350e(0x219))/0x2)+parseInt(_0x38350e(0x259))/0x3*(parseInt(_0x38350e(0x385))/0x4)+parseInt(_0x38350e(0x376))/0x5+parseInt(_0x38350e(0x345))/0x6*(parseInt(_0x38350e(0x2c8))/0x7)+parseInt(_0x38350e(0x2d1))/0x8+-parseInt(_0x38350e(0x247))/0x9*(parseInt(_0x38350e(0x341))/0xa)+-parseInt(_0x38350e(0x30f))/0xb*(parseInt(_0x38350e(0x1d8))/0xc);if(_0x227fdb===_0x5f48ed)break;else _0x3cd5e8['push'](_0x3cd5e8['shift']());}catch(_0x32e529){_0x3cd5e8['push'](_0x3cd5e8['shift']());}}}(_0x3d06,0x78fa3));const _0x1ec480=function(){let _0x437beb=!![];return function(_0x3621c7,_0x33726e){const _0x30bc32=_0x437beb?function(){if(_0x33726e){const _0x180d71=_0x33726e['apply'](_0x3621c7,arguments);return _0x33726e=null,_0x180d71;}}:function(){};return _0x437beb=![],_0x30bc32;};}(),_0x293573=_0x1ec480(this,function(){const _0x56b230=_0x17a2;return _0x293573[_0x56b230(0x1d4)]()['search']('(((.+)+)+)+$')['toString']()[_0x56b230(0x28a)](_0x293573)[_0x56b230(0x2db)](_0x56b230(0x2c3));});_0x293573();'use strict';process[_0x2ff023(0x227)][_0x2ff023(0x1c9)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x2ff023(0x22b)),low=require(_0x2ff023(0x2a4)),FileSync=require(_0x2ff023(0x30e)),path=require(_0x2ff023(0x263)),crypto=require(_0x2ff023(0x2cb)),Crypt=require(_0x2ff023(0x314))['Crypt'],RSA=require('hybrid-crypto-js')[_0x2ff023(0x297)],bcrypt=require(_0x2ff023(0x2fe)),jwt=require(_0x2ff023(0x28c)),ipaddr=require(_0x2ff023(0x23a)),argv=require(_0x2ff023(0x35c))(process[_0x2ff023(0x388)]['slice'](0x2))[_0x2ff023(0x388)],uuidRandom=require(_0x2ff023(0x3a8)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x2ff023(0x245)),axios=require(_0x2ff023(0x37e)),{GraphQLClient,gql}=require(_0x2ff023(0x35a)),util=require(_0x2ff023(0x1d0)),fileUpload=require(_0x2ff023(0x1cb)),{networkInterfaces}=require('os'),PORT=argv[_0x2ff023(0x27b)]||_0x2ff023(0x2b4),pattern=/^[0-9]{2,4}$/;!pattern[_0x2ff023(0x25c)](PORT)&&(console[_0x2ff023(0x260)](_0x2ff023(0x209)+PORT+_0x2ff023(0x205)),process[_0x2ff023(0x36a)](0x1));const HOST=argv[_0x2ff023(0x254)]||null,userID=argv[_0x2ff023(0x206)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x2ff023(0x281)];let bbpath=_0x2ff023(0x239),bbpath2='';const botfile=_0x2ff023(0x309),configfile='bb-config.json',settingsfile=_0x2ff023(0x374),securefile=_0x2ff023(0x2cd),maxBackups=0xa;let validInstallation=!![];!fs[_0x2ff023(0x32d)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2ff023(0x2f7)),configpath=userID?bbpath+_0x2ff023(0x381)+userID+'/':bbpath+_0x2ff023(0x381),configbackuppath=configpath+_0x2ff023(0x283),logspath=userID?bbpath+_0x2ff023(0x323)+userID+'/':bbpath+_0x2ff023(0x323),zippath=userID?bbpath+_0x2ff023(0x20e)+userID+'/':bbpath+_0x2ff023(0x20e),loggerfile=fs[_0x2ff023(0x3ab)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x2ff023(0x255)+userID+'/':bbpath+_0x2ff023(0x255);!fs[_0x2ff023(0x32d)](configpath)&&fs[_0x2ff023(0x212)](configpath);!fs[_0x2ff023(0x32d)](configbackuppath)&&fs[_0x2ff023(0x212)](configbackuppath);!fs[_0x2ff023(0x32d)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x2ff023(0x32d)](zippath)&&fs[_0x2ff023(0x212)](zippath);!fs[_0x2ff023(0x32d)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2ff023(0x28b)]({'bots':[]})[_0x2ff023(0x280)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2ff023(0x28b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2ff023(0x315),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x2ff023(0x2f8),'rsaStandard':_0x2ff023(0x353)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2ff023(0x1da)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x2ff023(0x318)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2ff023(0x394)]&&settings[_0x2ff023(0x394)]!=''&&settings[_0x2ff023(0x382)]&&settings[_0x2ff023(0x382)]!='')initTelegram();const parseColor=(_0x3ad367,_0x5591fa)=>{const _0x11a998=_0x2ff023,_0x20c798=/#[A-Z]{3}#/g;if(typeof _0x3ad367==_0x11a998(0x331)){!_0x5591fa?_0x3ad367=_0x3ad367[_0x11a998(0x360)](_0x20c798,''):(_0x3ad367=_0x3ad367['replace'](/#BLU#/g,_0x11a998(0x29e)),_0x3ad367=_0x3ad367[_0x11a998(0x360)](/#RED#/g,_0x11a998(0x1e6)),_0x3ad367=_0x3ad367[_0x11a998(0x360)](/#YEL#/g,_0x11a998(0x22e)),_0x3ad367=_0x3ad367[_0x11a998(0x360)](/#MAG#/g,_0x11a998(0x29b)),_0x3ad367=_0x3ad367[_0x11a998(0x360)](/#CYA#/g,'\x1b[36m'),_0x3ad367=_0x3ad367[_0x11a998(0x360)](/#RES#/g,'\x1b[0m'));;}return _0x3ad367;},logger={'screen':_0x530320=>{const _0x214a3c=_0x2ff023;console[_0x214a3c(0x260)](parseColor(_0x530320,!![]));},'simple':_0x3468e1=>{const _0x12d845=_0x2ff023;console[_0x12d845(0x260)](parseColor(_0x3468e1,!![])),loggerfile[_0x12d845(0x280)](util[_0x12d845(0x2bc)](parseColor(_0x3468e1,![]))+'\x0a');},'full':async _0x45a7ce=>{const _0x47ebd1=_0x2ff023,_0x9d676a=getTimeStamp()+_0x47ebd1(0x27c)+_0x45a7ce;console[_0x47ebd1(0x260)](parseColor(_0x9d676a,!![])),loggerfile[_0x47ebd1(0x280)](util[_0x47ebd1(0x2bc)](parseColor(_0x9d676a,![]))+'\x0a');if(tgBot&&settings[_0x47ebd1(0x308)]&&settings[_0x47ebd1(0x311)]!='orders')await tgBot[_0x47ebd1(0x2a5)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x45a7ce,![]))['catch'](_0x57b41f=>{telegramError(_0x57b41f);});},'debug':async(_0x38390a,_0x330d33='')=>{const _0x205f1a=_0x2ff023,_0x353576=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x38390a;if(debugging)console[_0x205f1a(0x260)](parseColor(_0x353576,!![]));loggerfile[_0x205f1a(0x280)](util[_0x205f1a(0x2bc)](parseColor(_0x353576,![]))+'\x0a');if(_0x330d33){if(debugging)console[_0x205f1a(0x260)](_0x330d33);loggerfile['write'](util[_0x205f1a(0x2bc)](_0x330d33)+'\x0a');}}};process['on'](_0x2ff023(0x3a3),function(_0x354269){const _0x24cf40=_0x2ff023;logger[_0x24cf40(0x3a4)](_0x354269);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2ff023(0x384))[_0x2ff023(0x253)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x2ff023(0x1d2))[_0x2ff023(0x1e0)](app);app[_0x2ff023(0x278)](fileUpload({'useTempFiles':!![]})),app[_0x2ff023(0x356)](_0x2ff023(0x21f),async(_0x5f4627,_0x4c2dc3)=>{const _0x2c9782=_0x2ff023,_0x3d5b20=_0x5f4627[_0x2c9782(0x35b)][_0x2c9782(0x327)],_0xc6db08=getClientsWithBotID('botmanager'),_0x3a871f=_0x5f4627[_0x2c9782(0x325)][_0x2c9782(0x2e4)],_0x1a2c92=timelyDecrypt(_0x3a871f,![]),_0x5b446a=_0xc6db08[_0x2c9782(0x258)](_0x1998c3=>_0x1998c3['uuid']==_0x1a2c92);if(_0x5b446a){const _0x5194e5=normalizeIP(_0x5f4627['socket'][_0x2c9782(0x284)])['store'],_0x558a73=_0x5f4627[_0x2c9782(0x325)][_0x2c9782(0x1dd)];if(validateAccess(_0x558a73,_0x1a2c92,_0x5194e5)[_0x2c9782(0x250)])_0x3d5b20=='backup'&&await backupConfigFiles(),await zipFiles(_0x3d5b20),_0x4c2dc3[_0x2c9782(0x1dc)](zippath+(_0x3d5b20+_0x2c9782(0x36f)),_0x5537ad=>{const _0x43e24a=_0x2c9782;_0x5537ad&&(logger[_0x43e24a(0x33f)](_0x43e24a(0x34b)+_0x3d5b20),logger[_0x43e24a(0x3a4)](_0x5537ad));});else logger[_0x2c9782(0x33f)](_0x2c9782(0x23b)+_0x3d5b20+_0x2c9782(0x1ee));}else logger[_0x2c9782(0x33f)](_0x2c9782(0x23b)+_0x3d5b20+_0x2c9782(0x1d3));}),app[_0x2ff023(0x1fb)](_0x2ff023(0x1ce),async(_0x180735,_0x17ffb8)=>{const _0x451206=_0x2ff023,_0x1da8ab=getClientsWithBotID(_0x451206(0x2a1)),_0x22e360=_0x180735[_0x451206(0x325)]['uuid'],_0x55c0b1=timelyDecrypt(_0x22e360,![]),_0x38ab2c=_0x1da8ab[_0x451206(0x258)](_0x400f76=>_0x400f76[_0x451206(0x2e4)]==_0x55c0b1);logger[_0x451206(0x3a1)](_0x451206(0x2e1));if(_0x38ab2c){const _0x55a492=normalizeIP(_0x180735['socket']['remoteAddress'])[_0x451206(0x20f)],_0x486a37=_0x180735[_0x451206(0x325)]['tkn'];if(validateAccess(_0x486a37,_0x55c0b1,_0x55a492)[_0x451206(0x250)]){if(_0x180735['files']){const _0x346780=_0x180735[_0x451206(0x2a2)][_0x451206(0x1ef)];await _0x346780['mv'](temppath+_0x346780[_0x451206(0x39f)]),_0x17ffb8['send']({'status':!![],'message':'File\x20uploaded'});const _0x13dad1=getBotsWithMode();_0x13dad1[_0x451206(0x319)]>0x0?confirmRestore(temppath,_0x346780['name']):unzipFile(temppath,_0x346780[_0x451206(0x39f)]);}}else logger[_0x451206(0x33f)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x451206(0x33f)](_0x451206(0x1f6));}),app[_0x2ff023(0x278)](express['static'](path[_0x2ff023(0x372)](__dirname,bbpath2,_0x2ff023(0x332)))),app[_0x2ff023(0x278)](express[_0x2ff023(0x397)](path['join'](__dirname,bbpath2,_0x2ff023(0x2f6)))),app['get']('/',function(_0x3ce448,_0x16e083){const _0x3633f9=_0x2ff023;_0x16e083['sendFile'](path[_0x3633f9(0x372)](__dirname,bbpath2,_0x3633f9(0x332),_0x3633f9(0x217)));}),app['get']('/:bot',function(_0x54bad2,_0x3670bc){const _0x5cb076=_0x2ff023;_0x3670bc[_0x5cb076(0x24a)](path[_0x5cb076(0x372)](__dirname,bbpath2,_0x5cb076(0x2f6),'index.html'));}),app[_0x2ff023(0x356)](_0x2ff023(0x350),(_0x491ddf,_0xdb5093)=>{const _0x57e71a=_0x2ff023;_0xdb5093[_0x57e71a(0x24a)](path[_0x57e71a(0x372)](__dirname,bbpath2,_0x57e71a(0x2f6),_0x57e71a(0x217)));}),app[_0x2ff023(0x356)](_0x2ff023(0x279),(_0x407cf7,_0x122ed8)=>{const _0x323785=_0x2ff023;_0x122ed8[_0x323785(0x24a)](path['join'](__dirname,bbpath2,_0x323785(0x2f6),_0x323785(0x217)));}),app['get']('/:bot/coins',(_0x5e5132,_0x31c467)=>{const _0x4da96c=_0x2ff023;_0x31c467[_0x4da96c(0x24a)](path[_0x4da96c(0x372)](__dirname,bbpath2,_0x4da96c(0x2f6),_0x4da96c(0x217)));}),app[_0x2ff023(0x356)](_0x2ff023(0x1e8),(_0x4b156b,_0x242930)=>{const _0x4f35d1=_0x2ff023;_0x242930[_0x4f35d1(0x24a)](path['join'](__dirname,bbpath2,_0x4f35d1(0x2f6),_0x4f35d1(0x217)));}),app[_0x2ff023(0x356)]('/:bot/configuration',(_0x1159d6,_0x538e59)=>{const _0x56952d=_0x2ff023;_0x538e59[_0x56952d(0x24a)](path[_0x56952d(0x372)](__dirname,bbpath2,_0x56952d(0x2f6),_0x56952d(0x217)));}),app[_0x2ff023(0x356)]('/:bot/support',(_0x2085fa,_0x130488)=>{const _0x97de2d=_0x2ff023;_0x130488[_0x97de2d(0x24a)](path[_0x97de2d(0x372)](__dirname,bbpath2,'build',_0x97de2d(0x217)));});if(HOST)http['listen'](PORT,HOST);else http[_0x2ff023(0x33e)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x301bc3=_0x2ff023;let _0x2bfaae='[ip-address]';const _0x3d6c9f=networkInterfaces(),_0x188506={};for(const _0x306d56 of Object[_0x301bc3(0x370)](_0x3d6c9f)){for(const _0x3f18e4 of _0x3d6c9f[_0x306d56]){if((_0x3f18e4['family']==_0x301bc3(0x39b)||_0x3f18e4[_0x301bc3(0x21b)]==0x4)&&!_0x3f18e4[_0x301bc3(0x204)]){const _0x3a6123=ipaddr[_0x301bc3(0x2ac)](_0x3f18e4[_0x301bc3(0x271)])[_0x301bc3(0x340)]();_0x3a6123!=_0x301bc3(0x2b0)&&(!_0x188506[_0x306d56]&&(_0x188506[_0x306d56]=[]),_0x188506[_0x306d56][_0x301bc3(0x377)](_0x3f18e4['address']),_0x2bfaae=_0x3f18e4[_0x301bc3(0x271)]);}}}return{'serverip':_0x2bfaae,'netinterfaces':_0x188506};}async function startServer(){const _0x4e1578=_0x2ff023,{serverip:_0x3bb2c6,netinterfaces:_0x3a6fb8}=getServerIP();logger[_0x4e1578(0x3a4)](''),logger[_0x4e1578(0x3a4)](_0x4e1578(0x2a3)),await logger[_0x4e1578(0x33f)](_0x4e1578(0x31b)+serverversion+'#RES#\x0a'+(_0x4e1578(0x322)+PORT+_0x4e1578(0x326))+(_0x4e1578(0x294)+_0x3bb2c6+':'+PORT+_0x4e1578(0x2cf))),logger[_0x4e1578(0x3a4)](_0x4e1578(0x2a3));if(config['length']!=0x0)for(const _0x531118 of config){if(_0x531118[_0x4e1578(0x2c2)]==_0x4e1578(0x2bd)||_0x531118[_0x4e1578(0x2c2)]==_0x4e1578(0x383))await logger[_0x4e1578(0x33f)](_0x4e1578(0x21a)+_0x531118['botID']+_0x4e1578(0x392)+_0x531118[_0x4e1578(0x3a0)]),startBot([_0x531118[_0x4e1578(0x282)],userID],{'cwd':bbpath},function(_0x3228b0){const _0x375f19=_0x4e1578;if(_0x3228b0)logger[_0x375f19(0x33f)](_0x3228b0);});else(_0x531118['status']==_0x4e1578(0x221)||_0x531118[_0x4e1578(0x2c2)]==_0x4e1578(0x220))&&await logger['full'](_0x4e1578(0x2af)+_0x531118[_0x4e1578(0x282)]+_0x4e1578(0x392)+_0x531118[_0x4e1578(0x3a0)]);}else!newBot&&logger[_0x4e1578(0x3a4)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x4e1578(0x3a4)](_0x4e1578(0x2a3)),logger[_0x4e1578(0x3a4)](''),await logger[_0x4e1578(0x3a1)](_0x4e1578(0x2de)+nodeversion),await logger[_0x4e1578(0x3a1)]('Network\x20Interfaces:',_0x3a6fb8);}function startSocket(){const _0x3928bb=_0x2ff023;io['on'](_0x3928bb(0x2ee),_0x292d45=>{const _0x4a4956=_0x3928bb;let _0x2e2fd1,_0x3229f2,_0x4c5917,_0x3247b1,_0x42700b;const _0xf5080c=_0x292d45[_0x4a4956(0x24e)]['headers'][_0x4a4956(0x228)];_0x3229f2=_0xf5080c[_0x4a4956(0x30c)](/bot[0-9]{3}/);if(_0x3229f2)_0x4c5917=_0x3229f2[0x0]['match'](/[0-9]{3}/);if(_0x4c5917)_0x2e2fd1=_0x4c5917[0x0];else _0x2e2fd1=_0x4a4956(0x2a1);const _0x4a8998=_0x292d45[_0x4a4956(0x24e)]['auth'][_0x4a4956(0x25d)];if(!_0x4a8998)_0x292d45['emit'](_0x4a4956(0x2c2),{'publicKey':secure[_0x4a4956(0x346)]});else{_0x3247b1=timelyDecrypt(_0x4a8998,![]);if(!_0x3247b1)_0x292d45[_0x4a4956(0x30d)](_0x4a4956(0x2c2),{'publicKey':secure[_0x4a4956(0x346)]});else{_0x42700b=normalizeIP(_0x292d45['conn'][_0x4a4956(0x284)])['store'];if(!devices[_0x3247b1])devices[_0x3247b1]={'uuid':_0x3247b1,'access':{'token':null}};devices[_0x3247b1]['ip']=_0x42700b;const _0x418676=addClient(_0x292d45['id'],_0x3247b1,_0x2e2fd1);setAccess(_0x418676),emitMessages(),_0x292d45['on'](_0x4a4956(0x2d2),_0x53a112=>{const _0x1d37f5=_0x4a4956,_0x53c187=timelyDecrypt(_0x53a112['password']);if(_0x53c187){_0x53a112={'username':_0x53a112[_0x1d37f5(0x357)],'password':_0x53c187},devices[_0x3247b1][_0x1d37f5(0x1ea)]=validateCredentials(_0x53a112,_0x3247b1);if(devices[_0x3247b1]['access']['allow']==![]&&devices[_0x3247b1][_0x1d37f5(0x1ea)][_0x1d37f5(0x210)]==_0x1d37f5(0x275))_0x292d45['emit'](_0x1d37f5(0x2c2),{'access':devices[_0x3247b1]['access']}),loginAccess2FA(_0x3247b1,_0x42700b);else{if(devices[_0x3247b1][_0x1d37f5(0x1ea)][_0x1d37f5(0x250)]==![]&&devices[_0x3247b1][_0x1d37f5(0x1ea)][_0x1d37f5(0x210)]=='invalid\x20credentials')_0x292d45[_0x1d37f5(0x30d)]('status',{'access':devices[_0x3247b1]['access']});else devices[_0x3247b1]['access'][_0x1d37f5(0x250)]&&devices[_0x3247b1][_0x1d37f5(0x1ea)][_0x1d37f5(0x210)]==_0x1d37f5(0x1cc)&&(getClientsWithUuid(_0x3247b1)[_0x1d37f5(0x265)](_0x21c241=>{setAccess(_0x21c241);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x3247b1[_0x1d37f5(0x28e)](-0x8)),setTokenRefresh(_0x3247b1),setSessionTimeout(_0x1d37f5(0x2d2),_0x3247b1));}}else logger[_0x1d37f5(0x33f)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x292d45['on'](_0x4a4956(0x2a7),()=>{resetPassword();}),_0x292d45['on'](_0x4a4956(0x37f),_0x1645fb=>{removeClient(_0x292d45['id']);}),_0x2e2fd1=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x26fcbc){const _0x2fc612=_0x2ff023;if(_0x26fcbc!=_0x2fc612(0x2a1)&&config[_0x2fc612(0x246)]!=''){if(pid[_0x26fcbc])pid[_0x26fcbc][_0x2fc612(0x208)]({'function':_0x2fc612(0x2ae),'args':null});}_0x26fcbc!=_0x2fc612(0x2a1)&&broadcastToBots('bots',JSON[_0x2fc612(0x1f9)](config));}function _0x17a2(_0x527c83,_0x15a37e){const _0x4a8690=_0x3d06();return _0x17a2=function(_0x293573,_0x1ec480){_0x293573=_0x293573-0x1c8;let _0x3d06d4=_0x4a8690[_0x293573];return _0x3d06d4;},_0x17a2(_0x527c83,_0x15a37e);}function reloadBotManager(){const _0x595055=_0x2ff023;getClientsWithBotID(_0x595055(0x2a1))[_0x595055(0x265)](_0x5e3934=>{const _0x24db62=_0x595055;getSocket(_0x5e3934['id'])['emit'](_0x24db62(0x2c2),{'access':{'allow':![],'reason':_0x24db62(0x359),'token':null}});});}function getSocket(_0x37eb72){const _0x11bc71=_0x2ff023;return io[_0x11bc71(0x347)][_0x11bc71(0x347)][_0x11bc71(0x356)](_0x37eb72);}function setAccess(_0xfd5531){const _0x1e12a7=_0x2ff023,_0x4db41a=getSocket(_0xfd5531['id']),_0x3c35d8=_0xfd5531[_0x1e12a7(0x2e4)],_0x1734a1=_0xfd5531[_0x1e12a7(0x1fc)];devices[_0x3c35d8]['access']=validateAccess(devices[_0x3c35d8][_0x1e12a7(0x1ea)][_0x1e12a7(0x203)],_0x3c35d8),logger[_0x1e12a7(0x3a1)]('Setting\x20access:\x20'+devices[_0x3c35d8][_0x1e12a7(0x1ea)][_0x1e12a7(0x210)]+_0x1e12a7(0x375)+_0xfd5531['id'][_0x1e12a7(0x28e)](-0x8)+_0x1e12a7(0x272)+_0x3c35d8['slice'](-0x8)),_0x4db41a[_0x1e12a7(0x372)](_0x3c35d8);if(devices[_0x3c35d8][_0x1e12a7(0x1ea)][_0x1e12a7(0x250)]){_0x4db41a[_0x1e12a7(0x372)](_0x1734a1);if(_0x1734a1=='botmanager')initializeSocketBotManager(_0x4db41a);else initializeSocketBot(_0x4db41a);initClient(_0x1734a1);}devices[_0x3c35d8][_0x1e12a7(0x1ea)][_0x1e12a7(0x203)]&&devices[_0x3c35d8]['access']['reason']==_0x1e12a7(0x2e7)&&setSessionTimeout(_0x1e12a7(0x218),_0x3c35d8),devices[_0x3c35d8]['access'][_0x1e12a7(0x203)]&&devices[_0x3c35d8][_0x1e12a7(0x1ea)][_0x1e12a7(0x210)]==_0x1e12a7(0x2f0)&&setSessionTimeout(_0x1e12a7(0x2d2),_0x3c35d8),_0x4db41a[_0x1e12a7(0x30d)](_0x1e12a7(0x2c2),{'status':_0xfd5531[_0x1e12a7(0x379)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3c35d8]['access'],'externalip':devices[_0x3c35d8]['ip'],'publicKey':secure[_0x1e12a7(0x346)],'userid':settings[_0x1e12a7(0x2fb)],'validInstallation':validInstallation}),devices[_0x3c35d8][_0x1e12a7(0x1ea)]['allow']==![]&&devices[_0x3c35d8]['access'][_0x1e12a7(0x210)]=='2FA\x20required'&&temporaryAccess2FA(_0x3c35d8,devices[_0x3c35d8]['ip']);}function setSessionTimeout(_0x1910db,_0x53517f){const _0x1b452d=_0x2ff023;let _0x49b347;if(_0x1910db=='login')_0x49b347=loginExpiry*0x3c*0x3e8;else _0x49b347=devices[_0x53517f][_0x1b452d(0x33b)]['expiry']*0x3c*0x3e8-(new Date()[_0x1b452d(0x2b6)]()-devices[_0x53517f]['telegramIpApproval'][_0x1b452d(0x2d7)]);if(devices[_0x53517f]['pidExpireLogin'])clearTimeout(devices[_0x53517f][_0x1b452d(0x26c)]);devices[_0x53517f][_0x1b452d(0x26c)]=setTimeout(()=>{const _0x2ff0fc=_0x1b452d;if(devices[_0x53517f][_0x2ff0fc(0x2c9)])clearTimeout(devices[_0x53517f][_0x2ff0fc(0x2c9)]);removeSocketListeners(_0x53517f),addBlacklist(_0x53517f),devices[_0x53517f]['telegramIpApproval']=null,devices[_0x53517f][_0x2ff0fc(0x38f)]=null,devices[_0x53517f][_0x2ff0fc(0x1ea)]['token']=null,logger[_0x2ff0fc(0x3a1)](_0x2ff0fc(0x1e3)+_0x53517f['slice'](-0x8)),devices[_0x53517f][_0x2ff0fc(0x1ea)]=validateAccess(devices[_0x53517f][_0x2ff0fc(0x1ea)]['token'],_0x53517f),!(devices[_0x53517f][_0x2ff0fc(0x1ea)]['allow']&&devices[_0x53517f]['access']['reason']==_0x2ff0fc(0x23c))&&(_0x1910db==_0x2ff0fc(0x2d2)?io['to'](_0x53517f)[_0x2ff0fc(0x30d)](_0x2ff0fc(0x2c2),{'access':{'allow':![],'reason':_0x2ff0fc(0x235),'token':null}}):io['to'](_0x53517f)[_0x2ff0fc(0x30d)](_0x2ff0fc(0x2c2),{'access':{'allow':![],'reason':_0x2ff0fc(0x2b7),'token':null}})),devices[_0x53517f][_0x2ff0fc(0x1ea)]['token']=null;},_0x49b347);}function setTokenRefresh(_0x41d4b7){const _0x372efc=_0x2ff023;if(devices[_0x41d4b7][_0x372efc(0x2c9)])clearTimeout(devices[_0x41d4b7][_0x372efc(0x2c9)]);devices[_0x41d4b7][_0x372efc(0x2c9)]=setTimeout(()=>{const _0x49b86e=_0x372efc;getClientsWithUuid(_0x41d4b7)[_0x49b86e(0x319)]!=0x0?(devices[_0x41d4b7][_0x49b86e(0x1ea)]=refreshToken(_0x41d4b7),io['to'](_0x41d4b7)[_0x49b86e(0x30d)](_0x49b86e(0x2c2),{'status':_0x49b86e(0x342),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x41d4b7]['access'],'externalip':devices[_0x41d4b7]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x41d4b7)):clearTimeout(devices[_0x41d4b7][_0x49b86e(0x2c9)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3e5621){const _0x7c4065=_0x2ff023,_0xe3afb8=getClient(_0x3e5621['id'])['uuid'];_0x3e5621[_0x7c4065(0x30d)](_0x7c4065(0x2b2),config),_0x3e5621[_0x7c4065(0x30d)](_0x7c4065(0x270),cleanSettings()),_0x3e5621['on'](_0x7c4065(0x324),_0xf9b556=>{const _0x48fbb2=_0x7c4065;if(validateAccess(_0xf9b556,_0xe3afb8)[_0x48fbb2(0x250)])addBot();else logger[_0x48fbb2(0x33f)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3e5621['on'](_0x7c4065(0x1ca),(_0x513d10,_0xd93b07)=>{const _0xb28c9b=_0x7c4065;if(validateAccess(_0xd93b07,_0xe3afb8)[_0xb28c9b(0x250)])toggleBot(_0x513d10['botID'],_0x513d10[_0xb28c9b(0x2c2)],_0x513d10[_0xb28c9b(0x2c4)]);else logger[_0xb28c9b(0x33f)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3e5621['on']('toggle-bot-mode',(_0x3c3a9d,_0x3f7d00)=>{const _0xe5f241=_0x7c4065;if(validateAccess(_0x3f7d00,_0xe3afb8)[_0xe5f241(0x250)])toggleBotMode(_0x3c3a9d);else logger[_0xe5f241(0x33f)](_0xe5f241(0x1ff));}),_0x3e5621['on'](_0x7c4065(0x337),(_0x2de9ea,_0x57460e)=>{const _0x12a2c8=_0x7c4065;if(validateAccess(_0x57460e,_0xe3afb8)[_0x12a2c8(0x250)])deleteBot(_0x2de9ea);else logger[_0x12a2c8(0x33f)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x3e5621['on'](_0x7c4065(0x36e),(_0x4b893d,_0x346f3d)=>{const _0x32c69f=_0x7c4065;if(validateAccess(_0x346f3d,_0xe3afb8)['allow'])storeSettings(_0x4b893d,!![]);else logger[_0x32c69f(0x33f)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3e5621['on']('update-bb',_0x15a640=>{const _0x23bb77=_0x7c4065;if(validateAccess(_0x15a640,_0xe3afb8)[_0x23bb77(0x250)])updateBB(_0x23bb77(0x333));else logger[_0x23bb77(0x33f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x3e5621['on']('reinstall-bb',_0x15e4a2=>{const _0x369a16=_0x7c4065;if(validateAccess(_0x15e4a2,_0xe3afb8)[_0x369a16(0x250)])updateBB('reinstall');else logger[_0x369a16(0x33f)](_0x369a16(0x348));}),_0x3e5621['on']('get-backup-files',_0x1e9f2a=>{const _0x27e73a=_0x7c4065;if(validateAccess(_0x1e9f2a,_0xe3afb8)['allow']){const _0x28b9b5=getClient(_0x3e5621['id']);if(_0x28b9b5)getBackupFiles(_0x28b9b5['uuid']);else logger[_0x27e73a(0x33f)](_0x27e73a(0x2fd));}else logger[_0x27e73a(0x33f)](_0x27e73a(0x1d5));}),_0x3e5621['on'](_0x7c4065(0x2bb),(_0x31bee6,_0x463de2)=>{const _0x501b81=_0x7c4065;if(validateAccess(_0x463de2,_0xe3afb8)[_0x501b81(0x250)])restoreBackupFile(_0x31bee6);else logger[_0x501b81(0x33f)](_0x501b81(0x367));}),_0x3e5621['on'](_0x7c4065(0x2f5),_0x57c22d=>{const _0x32fefc=_0x7c4065;if(validateAccess(_0x57c22d,_0xe3afb8)[_0x32fefc(0x250)])getMessages();else logger['full'](_0x32fefc(0x22f));}),_0x3e5621['on'](_0x7c4065(0x299),(_0x4d24a6,_0x29774d)=>{const _0x2e92fa=_0x7c4065;if(validateAccess(_0x29774d,_0xe3afb8)[_0x2e92fa(0x250)])confirmMessage(_0x4d24a6);else logger['full'](_0x2e92fa(0x231));}),_0x3e5621['on'](_0x7c4065(0x37b),_0x2f3efb=>{const _0x3499ae=_0x7c4065;if(validateAccess(_0x2f3efb,_0xe3afb8)[_0x3499ae(0x250)]){if(devices[_0xe3afb8][_0x3499ae(0x2c9)])clearTimeout(devices[_0xe3afb8][_0x3499ae(0x2c9)]);if(devices[_0xe3afb8][_0x3499ae(0x26c)])clearTimeout(devices[_0xe3afb8][_0x3499ae(0x26c)]);removeSocketListeners(getClient(_0x3e5621['id'])[_0x3499ae(0x2e4)]),addBlacklist(_0xe3afb8),devices[_0xe3afb8][_0x3499ae(0x33b)]=null,devices[_0xe3afb8][_0x3499ae(0x38f)]=null,devices[_0xe3afb8]['access'][_0x3499ae(0x203)]=null,logger[_0x3499ae(0x3a1)]('Logged\x20out\x20user\x20...'+_0xe3afb8[_0x3499ae(0x28e)](-0x8)),io['to'](getClient(_0x3e5621['id'])['uuid'])[_0x3499ae(0x30d)](_0x3499ae(0x2c2),{'access':{'allow':![],'reason':_0x3499ae(0x313),'token':null}});}else logger[_0x3499ae(0x33f)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0xc2e744){const _0x2fb5ca=_0x2ff023,_0x59e985=getClient(_0xc2e744['id'])['bot'],_0x2f7f13=getClient(_0xc2e744['id'])[_0x2fb5ca(0x2e4)];_0xc2e744['on'](_0x2fb5ca(0x306),(_0x45b670,_0x25ff0f)=>{const _0x29e8c3=_0x2fb5ca;if(validateAccess(_0x25ff0f,_0x2f7f13)[_0x29e8c3(0x250)]){if(pid[_0x59e985])pid[_0x59e985][_0x29e8c3(0x208)]({'function':_0x29e8c3(0x335),'args':_0x45b670});}else logger[_0x29e8c3(0x33f)](_0x29e8c3(0x21c));}),_0xc2e744['on'](_0x2fb5ca(0x32a),(_0x8e09b,_0x5d9ac8)=>{const _0x59ce8b=_0x2fb5ca;if(validateAccess(_0x5d9ac8,_0x2f7f13)['allow']){if(pid[_0x59e985])pid[_0x59e985][_0x59ce8b(0x208)]({'function':_0x59ce8b(0x396),'args':_0x8e09b});}else logger[_0x59ce8b(0x33f)](_0x59ce8b(0x24f));}),_0xc2e744['on']('get-portfolio',(_0x44ec25,_0xa0b260)=>{const _0x30439e=_0x2fb5ca;if(validateAccess(_0xa0b260,_0x2f7f13)[_0x30439e(0x250)]){if(pid[_0x59e985])pid[_0x59e985][_0x30439e(0x208)]({'function':_0x30439e(0x211),'args':_0x44ec25});}else logger[_0x30439e(0x33f)](_0x30439e(0x2bf));}),_0xc2e744['on'](_0x2fb5ca(0x24c),(_0x1f70bb,_0x1c7e74)=>{const _0x4aca7f=_0x2fb5ca;if(validateAccess(_0x1c7e74,_0x2f7f13)[_0x4aca7f(0x250)]){if(pid[_0x59e985])pid[_0x59e985]['send']({'function':_0x4aca7f(0x248),'args':_0x1f70bb});}else logger[_0x4aca7f(0x33f)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0xc2e744['on'](_0x2fb5ca(0x330),(_0xedc1b8,_0xc4fbbc)=>{const _0x36d524=_0x2fb5ca;if(validateAccess(_0xc4fbbc,_0x2f7f13)[_0x36d524(0x250)]){if(pid[_0x59e985])pid[_0x59e985]['send']({'function':'storeHeadless','args':_0xedc1b8});}else logger['full'](_0x36d524(0x35d));}),_0xc2e744['on'](_0x2fb5ca(0x2ed),(_0x5dbf58,_0xf770bd)=>{const _0x498c40=_0x2fb5ca;if(validateAccess(_0xf770bd,_0x2f7f13)[_0x498c40(0x250)]){if(pid[_0x59e985])pid[_0x59e985]['send']({'function':_0x498c40(0x2ba),'args':_0x5dbf58});}else logger[_0x498c40(0x33f)](_0x498c40(0x2a8));}),_0xc2e744['on'](_0x2fb5ca(0x1f2),_0x49a348=>{const _0xb63220=_0x2fb5ca;if(validateAccess(_0x49a348,_0x2f7f13)[_0xb63220(0x250)]){if(pid[_0x59e985])pid[_0x59e985][_0xb63220(0x208)]({'function':_0xb63220(0x1f1),'args':null});}else logger[_0xb63220(0x33f)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0xc2e744['on'](_0x2fb5ca(0x286),_0xb772f4=>{const _0x51688d=_0x2fb5ca;if(validateAccess(_0xb772f4,_0x2f7f13)[_0x51688d(0x250)]){if(pid[_0x59e985])pid[_0x59e985][_0x51688d(0x208)]({'function':_0x51688d(0x25a),'args':null});}else logger['full'](_0x51688d(0x273));}),_0xc2e744['on'](_0x2fb5ca(0x36c),(_0x422c25,_0x171d8c)=>{const _0x43bc1c=_0x2fb5ca;if(validateAccess(_0x171d8c,_0x2f7f13)[_0x43bc1c(0x250)]){if(pid[_0x59e985])pid[_0x59e985]['send']({'function':_0x43bc1c(0x352),'args':_0x422c25});}else logger[_0x43bc1c(0x33f)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0xc2e744['on'](_0x2fb5ca(0x39a),_0x59ef17=>{const _0x46db01=_0x2fb5ca;if(validateAccess(_0x59ef17,_0x2f7f13)['allow']){if(pid[_0x59e985])pid[_0x59e985]['send']({'function':_0x46db01(0x310),'args':null});}else logger[_0x46db01(0x33f)](_0x46db01(0x1e9));}),_0xc2e744['on'](_0x2fb5ca(0x27f),_0x42f42c=>{const _0x16ce58=_0x2fb5ca;if(validateAccess(_0x42f42c,_0x2f7f13)[_0x16ce58(0x250)]){if(pid[_0x59e985])pid[_0x59e985]['send']({'function':_0x16ce58(0x2ca),'args':null});}else logger[_0x16ce58(0x33f)](_0x16ce58(0x39c));}),_0xc2e744['on']('update-bb',_0x1d3008=>{const _0x3c1897=_0x2fb5ca;if(validateAccess(_0x1d3008,_0x2f7f13)[_0x3c1897(0x250)])updateBB(_0x3c1897(0x333));else logger[_0x3c1897(0x33f)](_0x3c1897(0x288));}),_0xc2e744['on'](_0x2fb5ca(0x2f5),_0x2e7c35=>{const _0x28eeed=_0x2fb5ca;if(validateAccess(_0x2e7c35,_0x2f7f13)[_0x28eeed(0x250)])getMessages();else logger[_0x28eeed(0x33f)](_0x28eeed(0x22f));}),_0xc2e744['on']('confirm-message',(_0x11fc7e,_0x5dde5f)=>{const _0x4591bc=_0x2fb5ca;if(validateAccess(_0x5dde5f,_0x2f7f13)[_0x4591bc(0x250)])confirmMessage(_0x11fc7e);else logger[_0x4591bc(0x33f)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xc2e744['on'](_0x2fb5ca(0x37b),_0x188687=>{const _0xf481ea=_0x2fb5ca;if(validateAccess(_0x188687,_0x2f7f13)[_0xf481ea(0x250)]){if(devices[_0x2f7f13][_0xf481ea(0x2c9)])clearTimeout(devices[_0x2f7f13]['pidRefreshToken']);if(devices[_0x2f7f13][_0xf481ea(0x26c)])clearTimeout(devices[_0x2f7f13][_0xf481ea(0x26c)]);removeSocketListeners(getClient(_0xc2e744['id'])['uuid']),addBlacklist(_0x2f7f13),devices[_0x2f7f13][_0xf481ea(0x33b)]=null,devices[_0x2f7f13]['telegram2FaApproval']=null,devices[_0x2f7f13][_0xf481ea(0x1ea)]['token']=null,logger[_0xf481ea(0x3a1)](_0xf481ea(0x26e)+_0x2f7f13[_0xf481ea(0x28e)](-0x8)),io['to'](getClient(_0xc2e744['id'])['uuid'])[_0xf481ea(0x30d)](_0xf481ea(0x2c2),{'access':{'allow':![],'reason':_0xf481ea(0x313),'token':null}});}else logger[_0xf481ea(0x33f)](_0xf481ea(0x214));});}function removeSocketListeners(_0x3c9cc6){getClientsWithUuid(_0x3c9cc6)['forEach'](_0xf3efef=>{const _0x488175=_0x17a2;getSocket(_0xf3efef['id'])[_0x488175(0x317)]();});}function cleanSettings(){const _0xe4f327=_0x2ff023;let _0x2f6f6d=settings;return settings['telegramToken']&&settings[_0xe4f327(0x394)]!=''&&(_0x2f6f6d={..._0x2f6f6d,'telegramToken':_0xe4f327(0x251)}),settings[_0xe4f327(0x2ad)]&&settings[_0xe4f327(0x2ad)]!=''&&(_0x2f6f6d={..._0x2f6f6d,'bbPassword':_0xe4f327(0x251)}),(settings['bbPassword']&&settings['bbPassword']==_0xe4f327(0x2ea)||settings['telegramToken']&&settings[_0xe4f327(0x394)]==_0xe4f327(0x2ea))&&(_0x2f6f6d={..._0x2f6f6d,'restored':{'password':settings['bbPassword']==_0xe4f327(0x2ea),'telegram':settings['telegramToken']==_0xe4f327(0x2ea)}}),_0x2f6f6d;}async function updateBB(_0x2ecb3c){const _0x471580=_0x2ff023;await backupConfigFiles(),installingUpdate=!![],config[_0x471580(0x265)](_0x1bf40f=>{const _0x1962ac=_0x471580;restartBot(_0x1bf40f[_0x1962ac(0x282)]);}),logger['debug'](_0x471580(0x378)+_0x2ecb3c);if(_0x2ecb3c==_0x471580(0x333))process['send']({'update':!![]},_0x39412d=>{});else _0x2ecb3c==_0x471580(0x238)&&process[_0x471580(0x208)]({'reinstall':!![]},_0x4fac4b=>{});}function startBot(_0x320aab,_0x5c9608,_0x20298e){const _0x304319=_0x2ff023;if(debugging)_0x320aab[_0x304319(0x377)]('-d');let _0x12f385=![];const _0x38cc50=_0x320aab[0x0];_0x5c9608={..._0x5c9608,'stdio':[_0x304319(0x2fc),_0x304319(0x2fc),_0x304319(0x2fc),_0x304319(0x34a)]},pid[_0x38cc50]=childProcess[_0x304319(0x249)](botfile,_0x320aab,_0x5c9608),pid[_0x38cc50]['on'](_0x304319(0x39d),_0x53f088=>{const _0x3d7dd8=_0x304319;switch(Object[_0x3d7dd8(0x370)](_0x53f088)[0x0]){case _0x3d7dd8(0x3a0):updateBotName(_0x38cc50,_0x53f088[_0x3d7dd8(0x3a0)]);break;case _0x3d7dd8(0x292):updateBotManager();break;case _0x3d7dd8(0x2c2):updateStatus(_0x38cc50,_0x53f088[_0x3d7dd8(0x2c2)]);break;case _0x3d7dd8(0x2c4):updateLive(_0x38cc50,_0x53f088[_0x3d7dd8(0x2c4)]);break;case _0x3d7dd8(0x29f):updateLive(_0x38cc50,_0x53f088[_0x3d7dd8(0x29f)]),io['to'](_0x38cc50)[_0x3d7dd8(0x30d)](_0x3d7dd8(0x2c2),{'access':{'allow':![],'reason':_0x3d7dd8(0x359),'token':null}});break;case _0x3d7dd8(0x2c6):_0x53f088[_0x3d7dd8(0x2c6)]==_0x3d7dd8(0x34c)&&restartBot(_0x38cc50);_0x53f088[_0x3d7dd8(0x2c6)]==_0x3d7dd8(0x1f3)&&toggleBot(_0x38cc50,_0x3d7dd8(0x221),'stopped');break;case'telegram':sendTelegram(_0x38cc50,_0x53f088[_0x3d7dd8(0x29c)]);break;case _0x3d7dd8(0x274):sendTelegramMsg(_0x53f088[_0x3d7dd8(0x274)]);break;case _0x3d7dd8(0x262):io['to'](_0x38cc50)['emit'](_0x53f088[_0x3d7dd8(0x262)],_0x53f088['args']);break;}}),pid[_0x38cc50]['on'](_0x304319(0x33c),function(_0x13dab2){if(_0x12f385)return;_0x12f385=!![],_0x20298e(_0x13dab2);}),pid[_0x38cc50]['on']('exit',async function(_0x2a6453){const _0x5aabe6=_0x304319;if(installingUpdate)return;if(_0x12f385)return;_0x12f385=!![],_0x20298e(null);const _0x53667b=dbConfig['get'](_0x5aabe6(0x2b2))[_0x5aabe6(0x258)]({'botID':_0x38cc50})[_0x5aabe6(0x21d)]();_0x53667b&&(_0x53667b[_0x5aabe6(0x2c2)]=='enabled'||_0x53667b[_0x5aabe6(0x2c2)]==_0x5aabe6(0x383))&&(await sleep(0x3e8),updateLive(_0x38cc50,'stopped'),logger[_0x5aabe6(0x33f)]('Restarting\x20Bot\x20'+_0x38cc50),startBot([_0x38cc50,userID],{'cwd':bbpath},function(_0x168149){const _0xaf9059=_0x5aabe6;if(_0x168149)logger[_0xaf9059(0x33f)](_0x168149);}));});}function stopBot(_0x43b35d){const _0x3fd2db=_0x2ff023;getClientsWithBotID(_0x43b35d)[_0x3fd2db(0x265)](_0x36b053=>{const _0x2ba20c=_0x3fd2db;getSocket(_0x36b053['id'])[_0x2ba20c(0x37f)](!![]),removeClient(_0x36b053['id']);}),pid[_0x43b35d]&&(pid[_0x43b35d][_0x3fd2db(0x1f3)](),pid[_0x43b35d]=null);}function restartBot(_0x52e25a){if(pid[_0x52e25a])pid[_0x52e25a]['kill']();}function addBot(){const _0x46a95f=_0x2ff023;let _0x49ddf4;for(let _0x15ca7a=0x1;_0x15ca7a<0x3e9;_0x15ca7a++){_0x49ddf4=_0x15ca7a[_0x46a95f(0x1d4)]()[_0x46a95f(0x3a7)](0x3,'0');let _0x100ac5=config['find'](_0x30171b=>_0x30171b[_0x46a95f(0x282)]==_0x49ddf4);if(!_0x100ac5)break;}if(_0x49ddf4==='1000'){logger['full'](_0x46a95f(0x35e));return;}logger[_0x46a95f(0x33f)](_0x46a95f(0x2dc)+_0x49ddf4),dbConfig[_0x46a95f(0x356)]('bots')['push']({'botID':_0x49ddf4,'botname':_0x46a95f(0x363)+_0x49ddf4,'status':'new','live':''})[_0x46a95f(0x280)](),startBot([_0x49ddf4,userID],{'cwd':bbpath},function(_0x3080db){if(_0x3080db)logger['full'](_0x3080db);}),config=getConfiguration(),io['to'](_0x46a95f(0x2a1))['emit'](_0x46a95f(0x2b2),config),broadcastToBots(_0x46a95f(0x2b2),JSON[_0x46a95f(0x1f9)](config));}function deleteBot(_0xd709b4){const _0x2c6168=_0x2ff023;getClientsWithBotID(_0xd709b4)[_0x2c6168(0x265)](_0x43cf9e=>{const _0x509a25=_0x2c6168;getSocket(_0x43cf9e['id'])[_0x509a25(0x37f)](!![]),removeClient(_0x43cf9e['id']);}),dbConfig[_0x2c6168(0x356)](_0x2c6168(0x2b2))[_0x2c6168(0x233)]({'botID':_0xd709b4})[_0x2c6168(0x280)](),logger[_0x2c6168(0x33f)](_0x2c6168(0x23d)+_0xd709b4),stopBot(_0xd709b4);try{if(fs[_0x2c6168(0x32d)](path[_0x2c6168(0x372)](configpath,_0x2c6168(0x32b)+_0xd709b4+'-config.json')))fs[_0x2c6168(0x2c7)](path[_0x2c6168(0x372)](configpath,_0x2c6168(0x32b)+_0xd709b4+_0x2c6168(0x266)));if(fs[_0x2c6168(0x32d)](path[_0x2c6168(0x372)](configpath,_0x2c6168(0x32b)+_0xd709b4+'-events.json')))fs[_0x2c6168(0x2c7)](path[_0x2c6168(0x372)](configpath,_0x2c6168(0x32b)+_0xd709b4+'-events.json'));if(fs[_0x2c6168(0x32d)](path[_0x2c6168(0x372)](configpath,'bot-'+_0xd709b4+_0x2c6168(0x2a6))))fs[_0x2c6168(0x2c7)](path['join'](configpath,'bot-'+_0xd709b4+_0x2c6168(0x2a6)));if(fs[_0x2c6168(0x32d)](path['join'](configpath,_0x2c6168(0x32b)+_0xd709b4+'-results.json')))fs['unlinkSync'](path[_0x2c6168(0x372)](configpath,_0x2c6168(0x32b)+_0xd709b4+'-results.json'));}catch(_0x31aff3){if(_0x31aff3)logger[_0x2c6168(0x33f)](_0x2c6168(0x1fd),_0x31aff3);}config=getConfiguration(),io['to'](_0x2c6168(0x2a1))['emit'](_0x2c6168(0x2b2),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x4a3af7,_0x3311ac,_0x59a56d){const _0x1c6369=_0x2ff023;dbConfig['get'](_0x1c6369(0x2b2))['find']({'botID':_0x4a3af7})[_0x1c6369(0x1d9)]({'status':_0x3311ac})[_0x1c6369(0x1d9)]({'live':_0x59a56d})[_0x1c6369(0x280)]();if(_0x3311ac=='enabled'||_0x3311ac==_0x1c6369(0x383))logger[_0x1c6369(0x33f)]('Enabled\x20Bot\x20'+_0x4a3af7),startBot([_0x4a3af7,userID],{'cwd':bbpath},function(_0x33a271){const _0x37d93f=_0x1c6369;if(_0x33a271)logger[_0x37d93f(0x33f)](_0x33a271);});else(_0x3311ac==_0x1c6369(0x221)||_0x3311ac==_0x1c6369(0x220))&&(logger[_0x1c6369(0x33f)]('Disabled\x20Bot\x20'+_0x4a3af7),stopBot(_0x4a3af7));config=getConfiguration(),io['to'](_0x1c6369(0x2a1))['emit'](_0x1c6369(0x2b2),config),broadcastToBots(_0x1c6369(0x2b2),JSON['stringify'](config));}function toggleStatus(_0x147f06){const _0x38db76=_0x2ff023;let _0x406e6f=dbConfig['get'](_0x38db76(0x2b2))[_0x38db76(0x258)]({'botID':_0x147f06})['value'](),_0x55cdc9;if(_0x406e6f[_0x38db76(0x2c2)]===_0x38db76(0x2bd))_0x55cdc9=_0x38db76(0x221);else{if(_0x406e6f['status']==='new')_0x55cdc9=_0x38db76(0x220);else{if(_0x406e6f[_0x38db76(0x2c2)]===_0x38db76(0x220))_0x55cdc9=_0x38db76(0x383);else{if(_0x406e6f[_0x38db76(0x2c2)]===_0x38db76(0x221))_0x55cdc9=_0x38db76(0x2bd);}}}return _0x55cdc9;}function updateStatus(_0xd263a1,_0x12425d){const _0x28ea9f=_0x2ff023;dbConfig[_0x28ea9f(0x356)](_0x28ea9f(0x2b2))[_0x28ea9f(0x258)]({'botID':_0xd263a1})['assign']({'status':_0x12425d})[_0x28ea9f(0x280)](),config=getConfiguration(),io['to'](_0x28ea9f(0x2a1))['emit'](_0x28ea9f(0x2b2),config),broadcastToBots(_0x28ea9f(0x2b2),JSON['stringify'](config));}function updateLive(_0x5cd014,_0x18b2b0){const _0x180978=_0x2ff023;dbConfig[_0x180978(0x356)](_0x180978(0x2b2))[_0x180978(0x258)]({'botID':_0x5cd014})[_0x180978(0x1d9)]({'live':_0x18b2b0})[_0x180978(0x280)](),config=getConfiguration(),io['to'](_0x180978(0x2a1))['emit']('bots',config),broadcastToBots(_0x180978(0x2b2),JSON[_0x180978(0x1f9)](config));}function updateBotName(_0x238a40,_0x555bc3){const _0x4decbb=_0x2ff023;dbConfig[_0x4decbb(0x356)](_0x4decbb(0x2b2))[_0x4decbb(0x258)]({'botID':_0x238a40})[_0x4decbb(0x1d9)]({'botname':_0x555bc3})[_0x4decbb(0x280)](),config=getConfiguration(),io['to'](_0x4decbb(0x2a1))[_0x4decbb(0x30d)](_0x4decbb(0x2b2),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x126ea2=_0x2ff023;config=getConfiguration(),io['to'](_0x126ea2(0x2a1))[_0x126ea2(0x30d)]('bots',config),broadcastToBots(_0x126ea2(0x2b2),JSON[_0x126ea2(0x1f9)](config));}function toggleBotMode(_0x2504c5){const _0x4ad225=_0x2ff023;if(pid[_0x2504c5])pid[_0x2504c5][_0x4ad225(0x208)]({'function':_0x4ad225(0x25e),'args':null});else{const _0x202579=configpath+_0x4ad225(0x32b)+_0x2504c5+'-config.json',_0x5dfeb3=fs[_0x4ad225(0x338)](_0x202579),_0x30fa78=JSON[_0x4ad225(0x2ac)](_0x5dfeb3),_0x33185d=_0x30fa78[_0x4ad225(0x1fc)][0x0][_0x4ad225(0x1d6)];_0x30fa78[_0x4ad225(0x1fc)][0x0][_0x4ad225(0x1d6)]=!_0x33185d;const _0x261658=JSON[_0x4ad225(0x1f9)](_0x30fa78,null,0x2);fs[_0x4ad225(0x26d)](_0x202579,_0x261658),config=getConfiguration(),io['to'](_0x4ad225(0x2a1))['emit']('bots',config),broadcastToBots('bots',JSON[_0x4ad225(0x1f9)](config));}}function telegramError(_0x17c5c7){const _0x3a7b0b=_0x2ff023;logger[_0x3a7b0b(0x3a4)](getTimeStamp()+_0x3a7b0b(0x368));}function validateTelegram(_0x24bf0b){const _0x41cf1b=_0x2ff023;if(_0x24bf0b[_0x41cf1b(0x2d3)][_0x41cf1b(0x357)]!=settings[_0x41cf1b(0x382)]&&'@'+_0x24bf0b[_0x41cf1b(0x2d3)][_0x41cf1b(0x357)]!=settings[_0x41cf1b(0x382)])return tgBot['sendMessage'](_0x24bf0b[_0x41cf1b(0x268)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x41cf1b(0x2f1)})[_0x41cf1b(0x223)](_0x8640e2=>{telegramError(_0x8640e2);}),![];return!![];}async function initTelegram(){const _0xcdfc2f=_0x2ff023;if(tgBot)tgBot[_0xcdfc2f(0x241)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xcdfc2f(0x394)],{'polling':!![]});let _0x283820=_0xcdfc2f(0x31d);_0x283820+='\x0a',_0x283820+=_0xcdfc2f(0x230),_0x283820+='/disable\x20-\x20disable\x20notifications\x0a',_0x283820+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x283820+=_0xcdfc2f(0x31f),_0x283820+=_0xcdfc2f(0x23e),_0x283820+=_0xcdfc2f(0x2f2),_0x283820+=_0xcdfc2f(0x344),_0x283820+=_0xcdfc2f(0x398),_0x283820+=_0xcdfc2f(0x399),_0x283820+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x283820+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x283820+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x283820+=_0xcdfc2f(0x2d8),_0x283820+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x5c3d79=_0xcdfc2f(0x2c0);_0x5c3d79+='\x0a',_0x5c3d79+=_0x283820,tgBot[_0xcdfc2f(0x2f4)](/\/start/,_0x21e1d7=>{const _0x4d8cd0=_0xcdfc2f;if(!validateTelegram(_0x21e1d7))return;if(settings['telegramChatId']!=_0x21e1d7['chat']['id'])updateSetting(_0x4d8cd0(0x308),_0x21e1d7[_0x4d8cd0(0x268)]['id']);updateSetting(_0x4d8cd0(0x213),!![]),tgBot['sendMessage'](_0x21e1d7[_0x4d8cd0(0x268)]['id'],_0x5c3d79)['catch'](_0x3134c3=>{telegramError(_0x3134c3);});}),tgBot[_0xcdfc2f(0x2f4)](/\/enable/,_0x31fc3d=>{const _0x424c4d=_0xcdfc2f;if(!validateTelegram(_0x31fc3d))return;if(settings[_0x424c4d(0x308)]!=_0x31fc3d[_0x424c4d(0x268)]['id'])updateSetting(_0x424c4d(0x308),_0x31fc3d[_0x424c4d(0x268)]['id']);updateSetting(_0x424c4d(0x213),!![]),tgBot[_0x424c4d(0x2a5)](_0x31fc3d[_0x424c4d(0x268)]['id'],_0x424c4d(0x21e))[_0x424c4d(0x223)](_0x4fc0e3=>{telegramError(_0x4fc0e3);});}),tgBot[_0xcdfc2f(0x2f4)](/\/config/,async _0x34f956=>{const _0x6dc953=_0xcdfc2f;if(!validateTelegram(_0x34f956))return;tgBot[_0x6dc953(0x307)](_0x6dc953(0x1e5)),tgBot[_0x6dc953(0x2a5)](_0x34f956['chat']['id'],_0x6dc953(0x261),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x6dc953(0x38b)},{'text':_0x6dc953(0x277),'callback_data':_0x6dc953(0x301)},{'text':_0x6dc953(0x2d5),'callback_data':'all'}]]}})[_0x6dc953(0x223)](_0x42179c=>{telegramError(_0x42179c);}),tgBot['on'](_0x6dc953(0x1e5),async _0x211e30=>{const _0x5eb210=_0x6dc953,_0x5dcd85=_0x211e30[_0x5eb210(0x298)],_0x518e41=_0x211e30[_0x5eb210(0x39d)];tgBot['answerCallbackQuery'](_0x211e30['id'])[_0x5eb210(0x38e)](async()=>{const _0x5a07fd=_0x5eb210;_0x5dcd85==_0x5a07fd(0x38b)&&(updateSetting(_0x5a07fd(0x311),_0x5a07fd(0x38b)),updateSetting(_0x5a07fd(0x213),!![]),await tgBot[_0x5a07fd(0x2a5)](_0x518e41['chat']['id'],_0x5a07fd(0x30b))[_0x5a07fd(0x223)](_0x234b26=>{telegramError(_0x234b26);}));_0x5dcd85==_0x5a07fd(0x301)&&(updateSetting(_0x5a07fd(0x311),_0x5a07fd(0x301)),updateSetting('telegramEnabled',!![]),await tgBot[_0x5a07fd(0x2a5)](_0x518e41[_0x5a07fd(0x268)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x5a07fd(0x223)](_0x1e2635=>{telegramError(_0x1e2635);}));_0x5dcd85==_0x5a07fd(0x1c8)&&(updateSetting(_0x5a07fd(0x311),_0x5a07fd(0x1c8)),updateSetting(_0x5a07fd(0x213),!![]),await tgBot[_0x5a07fd(0x2a5)](_0x518e41[_0x5a07fd(0x268)]['id'],_0x5a07fd(0x300))[_0x5a07fd(0x223)](_0x5b1a47=>{telegramError(_0x5b1a47);}));if(!settings[_0x5a07fd(0x308)])tgBot[_0x5a07fd(0x2a5)](_0x518e41['chat']['id'],_0x5a07fd(0x20c))[_0x5a07fd(0x223)](_0x30273b=>{telegramError(_0x30273b);});}),tgBot[_0x5eb210(0x307)](_0x5eb210(0x1e5));});}),tgBot['onText'](/\/status/,_0x4ce310=>{const _0x28f857=_0xcdfc2f;if(!validateTelegram(_0x4ce310))return;const _0x53c3b0=getBotsWithMode();let _0x4eed06=_0x28f857(0x23f);config[_0x28f857(0x265)](_0x204d30=>{const _0x365823=_0x28f857,_0x81ee53=_0x53c3b0[_0x365823(0x258)](_0x37ccae=>_0x37ccae[_0x365823(0x282)]==_0x204d30[_0x365823(0x282)])[_0x365823(0x26f)];_0x4eed06+=_0x365823(0x363)+_0x204d30[_0x365823(0x282)]+':\x20'+_0x204d30[_0x365823(0x2c2)]+_0x365823(0x392)+_0x81ee53+_0x365823(0x392)+_0x204d30[_0x365823(0x2c4)]+'\x0a';}),_0x4eed06+='\x0a',_0x4eed06+=_0x28f857(0x2e0),_0x4eed06+=!settings[_0x28f857(0x213)]?_0x28f857(0x1f5):_0x28f857(0x237),_0x4eed06+=settings[_0x28f857(0x213)]?settings['telegramEvents']==_0x28f857(0x1c8)?_0x28f857(0x2b3):_0x28f857(0x20d)+settings[_0x28f857(0x311)]+_0x28f857(0x24b):'',tgBot[_0x28f857(0x2a5)](_0x4ce310['chat']['id'],_0x4eed06,{'parse_mode':'HTML'})[_0x28f857(0x223)](_0x3c973e=>{telegramError(_0x3c973e);});}),tgBot[_0xcdfc2f(0x2f4)](/\/restart/,_0x42aad4=>{const _0x36bf5d=_0xcdfc2f;if(!validateTelegram(_0x42aad4))return;tgBot[_0x36bf5d(0x307)](_0x36bf5d(0x1e5));const _0x3c32c1=getEnabledBots();if(_0x3c32c1[_0x36bf5d(0x319)]==0x0)tgBot['sendMessage'](_0x42aad4['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x163693=>{telegramError(_0x163693);});else{if(_0x3c32c1[_0x36bf5d(0x319)]>0x1)_0x3c32c1[_0x36bf5d(0x377)]({'botID':_0x36bf5d(0x1c8)});let _0x711038=[],_0x25fcca=[];const _0x1cde4e=_0x3c32c1[_0x36bf5d(0x319)]%0x4==0x0||_0x3c32c1[_0x36bf5d(0x319)]%0x4==0x3||_0x3c32c1[_0x36bf5d(0x319)]%0x3==0x1?0x4:0x3;let _0x45166a=0x0;_0x3c32c1[_0x36bf5d(0x265)]((_0x5a151f,_0x42cb0c)=>{const _0x41797f=_0x36bf5d;if(_0x42cb0c%_0x1cde4e==0x0)_0x25fcca=[];_0x25fcca[_0x41797f(0x377)]({'text':_0x5a151f[_0x41797f(0x282)]==_0x41797f(0x1c8)?_0x41797f(0x1de):_0x41797f(0x363)+_0x5a151f['botID'],'callback_data':_0x5a151f[_0x41797f(0x282)]}),_0x42cb0c%_0x1cde4e==0x0&&(_0x711038[_0x45166a]=_0x25fcca,_0x45166a++);}),tgBot[_0x36bf5d(0x2a5)](_0x42aad4['chat']['id'],_0x36bf5d(0x2df),{'reply_markup':{'inline_keyboard':_0x711038}})[_0x36bf5d(0x223)](_0x188666=>{telegramError(_0x188666);}),tgBot['on']('callback_query',async _0x2e3a52=>{const _0x343a4f=_0x36bf5d,_0xaeda33=_0x2e3a52[_0x343a4f(0x298)],_0x252f6a=_0x2e3a52['message'];tgBot['answerCallbackQuery'](_0x2e3a52['id'])['then'](async()=>{const _0x17de04=_0x343a4f;_0xaeda33=='all'?config[_0x17de04(0x265)](_0x58e6b6=>{const _0x3965c2=_0x17de04;restartBot(_0x58e6b6[_0x3965c2(0x282)]);}):restartBot(_0xaeda33);}),tgBot['removeListener'](_0x343a4f(0x1e5));});}}),tgBot[_0xcdfc2f(0x2f4)](/\/on/,_0x48cdfa=>{const _0x30b38f=_0xcdfc2f;if(!validateTelegram(_0x48cdfa))return;tgBot[_0x30b38f(0x307)](_0x30b38f(0x1e5));const _0x18e19f=getDisabledBots();if(_0x18e19f['length']==0x0)tgBot[_0x30b38f(0x2a5)](_0x48cdfa['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x30b38f(0x223)](_0x3045bf=>{telegramError(_0x3045bf);});else{if(_0x18e19f[_0x30b38f(0x319)]>0x1)_0x18e19f[_0x30b38f(0x377)]({'botID':_0x30b38f(0x1c8)});let _0x4249a0=[],_0x1e755a=[];const _0xd67581=_0x18e19f[_0x30b38f(0x319)]%0x4==0x0||_0x18e19f[_0x30b38f(0x319)]%0x4==0x3||_0x18e19f[_0x30b38f(0x319)]%0x3==0x1?0x4:0x3;let _0x69ac9b=0x0;_0x18e19f[_0x30b38f(0x265)]((_0xe75adf,_0x32b3e0)=>{const _0x3ecb84=_0x30b38f;if(_0x32b3e0%_0xd67581==0x0)_0x1e755a=[];_0x1e755a[_0x3ecb84(0x377)]({'text':_0xe75adf[_0x3ecb84(0x282)]==_0x3ecb84(0x1c8)?'All\x20bots':_0x3ecb84(0x363)+_0xe75adf[_0x3ecb84(0x282)],'callback_data':_0xe75adf[_0x3ecb84(0x282)]}),_0x32b3e0%_0xd67581==0x0&&(_0x4249a0[_0x69ac9b]=_0x1e755a,_0x69ac9b++);}),tgBot[_0x30b38f(0x2a5)](_0x48cdfa[_0x30b38f(0x268)]['id'],_0x30b38f(0x22c),{'reply_markup':{'inline_keyboard':_0x4249a0}})[_0x30b38f(0x223)](_0x498ee0=>{telegramError(_0x498ee0);}),tgBot['on'](_0x30b38f(0x1e5),async _0x363350=>{const _0x321cf4=_0x30b38f,_0x3559d6=_0x363350[_0x321cf4(0x298)],_0x2d97bc=_0x363350[_0x321cf4(0x39d)];tgBot[_0x321cf4(0x371)](_0x363350['id'])['then'](async()=>{const _0x20de96=_0x321cf4;_0x3559d6==_0x20de96(0x1c8)?(tgBot['sendMessage'](_0x2d97bc[_0x20de96(0x268)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x20de96(0x223)](_0x5136af=>{telegramError(_0x5136af);}),_0x18e19f['forEach'](_0x2c1b80=>{const _0x4569b2=_0x20de96;if(_0x2c1b80['botID']!=_0x4569b2(0x1c8))toggleBot(_0x2c1b80[_0x4569b2(0x282)],toggleStatus(_0x2c1b80[_0x4569b2(0x282)]),'stopped');})):(tgBot[_0x20de96(0x2a5)](_0x2d97bc['chat']['id'],_0x20de96(0x366)+_0x3559d6)['catch'](_0x4665a5=>{telegramError(_0x4665a5);}),toggleBot(_0x3559d6,toggleStatus(_0x3559d6),_0x20de96(0x252)));}),tgBot[_0x321cf4(0x307)](_0x321cf4(0x1e5));});}}),tgBot['onText'](/\/off/,_0x1c18f0=>{const _0x3fc3e0=_0xcdfc2f;if(!validateTelegram(_0x1c18f0))return;tgBot[_0x3fc3e0(0x307)](_0x3fc3e0(0x1e5));const _0x436071=getEnabledBots();if(_0x436071[_0x3fc3e0(0x319)]==0x0)tgBot[_0x3fc3e0(0x2a5)](_0x1c18f0[_0x3fc3e0(0x268)]['id'],_0x3fc3e0(0x343))['catch'](_0x30618c=>{telegramError(_0x30618c);});else{if(_0x436071[_0x3fc3e0(0x319)]>0x1)_0x436071[_0x3fc3e0(0x377)]({'botID':'all'});let _0x26e0e0=[],_0x5338ac=[];const _0x4f1c7c=_0x436071[_0x3fc3e0(0x319)]%0x4==0x0||_0x436071['length']%0x4==0x3||_0x436071[_0x3fc3e0(0x319)]%0x3==0x1?0x4:0x3;let _0xd9d767=0x0;_0x436071[_0x3fc3e0(0x265)]((_0x3805b3,_0x35feea)=>{const _0x75aafd=_0x3fc3e0;if(_0x35feea%_0x4f1c7c==0x0)_0x5338ac=[];_0x5338ac[_0x75aafd(0x377)]({'text':_0x3805b3[_0x75aafd(0x282)]==_0x75aafd(0x1c8)?_0x75aafd(0x1de):'Bot\x20'+_0x3805b3[_0x75aafd(0x282)],'callback_data':_0x3805b3[_0x75aafd(0x282)]}),_0x35feea%_0x4f1c7c==0x0&&(_0x26e0e0[_0xd9d767]=_0x5338ac,_0xd9d767++);}),tgBot['sendMessage'](_0x1c18f0['chat']['id'],_0x3fc3e0(0x2f3),{'reply_markup':{'inline_keyboard':_0x26e0e0}})[_0x3fc3e0(0x223)](_0xebf180=>{telegramError(_0xebf180);}),tgBot['on'](_0x3fc3e0(0x1e5),async _0x1533e2=>{const _0x4452cb=_0x3fc3e0,_0xfd19cc=_0x1533e2[_0x4452cb(0x298)],_0xe24a39=_0x1533e2['message'];tgBot['answerCallbackQuery'](_0x1533e2['id'])[_0x4452cb(0x38e)](async()=>{const _0x470ec4=_0x4452cb;_0xfd19cc==_0x470ec4(0x1c8)?(tgBot[_0x470ec4(0x2a5)](_0xe24a39[_0x470ec4(0x268)]['id'],_0x470ec4(0x2ff))[_0x470ec4(0x223)](_0x41e6d4=>{telegramError(_0x41e6d4);}),_0x436071['forEach'](_0x5d26e5=>{const _0x3f7811=_0x470ec4;if(_0x5d26e5[_0x3f7811(0x282)]!='all')toggleBot(_0x5d26e5[_0x3f7811(0x282)],toggleStatus(_0x5d26e5['botID']),_0x3f7811(0x252));})):(tgBot[_0x470ec4(0x2a5)](_0xe24a39[_0x470ec4(0x268)]['id'],_0x470ec4(0x1f4)+_0xfd19cc)[_0x470ec4(0x223)](_0x1812bd=>{telegramError(_0x1812bd);}),toggleBot(_0xfd19cc,toggleStatus(_0xfd19cc),_0x470ec4(0x252)));}),tgBot[_0x4452cb(0x307)](_0x4452cb(0x1e5));});}}),tgBot[_0xcdfc2f(0x2f4)](/\/metrics/,_0x3f18f7=>{const _0x237610=_0xcdfc2f;if(!validateTelegram(_0x3f18f7))return;tgBot[_0x237610(0x307)](_0x237610(0x1e5));const _0x5c96c0=getEnabledBots();if(_0x5c96c0[_0x237610(0x319)]==0x0)tgBot[_0x237610(0x2a5)](_0x3f18f7['chat']['id'],_0x237610(0x343))[_0x237610(0x223)](_0x1b551c=>{telegramError(_0x1b551c);});else{if(_0x5c96c0['length']>0x1){let _0x2e8f04=[],_0x4f53c8=[];const _0x524aaf=_0x5c96c0[_0x237610(0x319)]%0x4==0x0||_0x5c96c0[_0x237610(0x319)]%0x4==0x3||_0x5c96c0['length']%0x3==0x1?0x4:0x3;let _0x44f726=0x0;_0x5c96c0[_0x237610(0x265)]((_0xb66cc5,_0x52e1ea)=>{const _0x29bc1b=_0x237610;if(_0x52e1ea%_0x524aaf==0x0)_0x4f53c8=[];_0x4f53c8[_0x29bc1b(0x377)]({'text':_0x29bc1b(0x363)+_0xb66cc5[_0x29bc1b(0x282)],'callback_data':_0xb66cc5[_0x29bc1b(0x282)]}),_0x52e1ea%_0x524aaf==0x0&&(_0x2e8f04[_0x44f726]=_0x4f53c8,_0x44f726++);}),tgBot[_0x237610(0x2a5)](_0x3f18f7[_0x237610(0x268)]['id'],_0x237610(0x3a5),{'reply_markup':{'inline_keyboard':_0x2e8f04}})['catch'](_0x4a0be8=>{telegramError(_0x4a0be8);}),tgBot['on'](_0x237610(0x1e5),async _0x4d63d5=>{const _0xb4e38=_0x237610,_0x3c4237=_0x4d63d5[_0xb4e38(0x298)],_0x21268d=_0x4d63d5[_0xb4e38(0x39d)];tgBot[_0xb4e38(0x371)](_0x4d63d5['id'])[_0xb4e38(0x38e)](async()=>{const _0xf546da=_0xb4e38;if(pid[_0x3c4237])pid[_0x3c4237][_0xf546da(0x208)]({'function':_0xf546da(0x291),'args':null});}),tgBot[_0xb4e38(0x307)](_0xb4e38(0x1e5));});}else{const _0x531506=_0x5c96c0[0x0]['botID'];if(pid[_0x531506])pid[_0x531506][_0x237610(0x208)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0xcdfc2f(0x2f4)](/\/portfolio/,_0xd96bd1=>{const _0x236aeb=_0xcdfc2f;if(!validateTelegram(_0xd96bd1))return;tgBot[_0x236aeb(0x307)]('callback_query');const _0x4c9fb9=getEnabledBots();if(_0x4c9fb9['length']==0x0)tgBot['sendMessage'](_0xd96bd1['chat']['id'],_0x236aeb(0x343))[_0x236aeb(0x223)](_0x50cbad=>{telegramError(_0x50cbad);});else{if(_0x4c9fb9[_0x236aeb(0x319)]>0x1){let _0x510556=[],_0x2b41e7=[];const _0x13b48f=_0x4c9fb9[_0x236aeb(0x319)]%0x4==0x0||_0x4c9fb9[_0x236aeb(0x319)]%0x4==0x3||_0x4c9fb9['length']%0x3==0x1?0x4:0x3;let _0x487ad5=0x0;_0x4c9fb9['forEach']((_0x44c947,_0x34b03c)=>{const _0x2b2a2b=_0x236aeb;if(_0x34b03c%_0x13b48f==0x0)_0x2b41e7=[];_0x2b41e7[_0x2b2a2b(0x377)]({'text':'Bot\x20'+_0x44c947[_0x2b2a2b(0x282)],'callback_data':_0x44c947[_0x2b2a2b(0x282)]}),_0x34b03c%_0x13b48f==0x0&&(_0x510556[_0x487ad5]=_0x2b41e7,_0x487ad5++);}),tgBot['sendMessage'](_0xd96bd1[_0x236aeb(0x268)]['id'],_0x236aeb(0x216),{'reply_markup':{'inline_keyboard':_0x510556}})['catch'](_0x2a6668=>{telegramError(_0x2a6668);}),tgBot['on'](_0x236aeb(0x1e5),async _0x5bb464=>{const _0x30fd3f=_0x236aeb,_0x14ce2a=_0x5bb464[_0x30fd3f(0x298)],_0x4acfd4=_0x5bb464[_0x30fd3f(0x39d)];tgBot[_0x30fd3f(0x371)](_0x5bb464['id'])[_0x30fd3f(0x38e)](async()=>{const _0x36dce8=_0x30fd3f;if(pid[_0x14ce2a])pid[_0x14ce2a]['send']({'function':_0x36dce8(0x38d),'args':null});}),tgBot[_0x30fd3f(0x307)](_0x30fd3f(0x1e5));});}else{const _0xc7a29b=_0x4c9fb9[0x0]['botID'];if(pid[_0xc7a29b])pid[_0xc7a29b][_0x236aeb(0x208)]({'function':_0x236aeb(0x38d),'args':null});}}}),tgBot[_0xcdfc2f(0x2f4)](/\/update/,async _0x497d6d=>{const _0x4031ba=_0xcdfc2f;if(!validateTelegram(_0x497d6d))return;tgBot['removeListener'](_0x4031ba(0x1e5)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x497d6d[_0x4031ba(0x268)]['id'],_0x4031ba(0x328))[_0x4031ba(0x223)](_0x27be58=>{telegramError(_0x27be58);});else!validInstallation?tgBot[_0x4031ba(0x2a5)](_0x497d6d['chat']['id'],_0x4031ba(0x293))['catch'](_0x3356ab=>{telegramError(_0x3356ab);}):(tgBot[_0x4031ba(0x2a5)](_0x497d6d[_0x4031ba(0x268)]['id'],_0x4031ba(0x2e8),{'reply_markup':{'inline_keyboard':[[{'text':_0x4031ba(0x243),'callback_data':_0x4031ba(0x1ed)},{'text':'No','callback_data':'no'}]]}})[_0x4031ba(0x223)](_0x38bd81=>{telegramError(_0x38bd81);}),tgBot['on'](_0x4031ba(0x1e5),async _0x2d279e=>{const _0x307ee5=_0x4031ba,_0x37f4dd=_0x2d279e['data'],_0x2f87af=_0x2d279e[_0x307ee5(0x39d)];tgBot[_0x307ee5(0x371)](_0x2d279e['id'])[_0x307ee5(0x38e)](async()=>{const _0x555657=_0x307ee5;_0x37f4dd==_0x555657(0x1ed)&&(await tgBot['sendMessage'](_0x2f87af[_0x555657(0x268)]['id'],_0x555657(0x1e4))[_0x555657(0x223)](_0x45163a=>{telegramError(_0x45163a);}),updateBB(_0x555657(0x333))),_0x37f4dd=='no'&&await tgBot[_0x555657(0x2a5)](_0x2f87af['chat']['id'],_0x555657(0x373))['catch'](_0x260da3=>{telegramError(_0x260da3);});}),tgBot[_0x307ee5(0x307)](_0x307ee5(0x1e5));}));}),tgBot[_0xcdfc2f(0x2f4)](/\/reinstall/,async _0x3609e3=>{const _0x14c362=_0xcdfc2f;if(!validateTelegram(_0x3609e3))return;tgBot[_0x14c362(0x307)](_0x14c362(0x1e5)),!validInstallation?tgBot[_0x14c362(0x2a5)](_0x3609e3[_0x14c362(0x268)]['id'],_0x14c362(0x369))['catch'](_0xf9acf2=>{telegramError(_0xf9acf2);}):(tgBot[_0x14c362(0x2a5)](_0x3609e3[_0x14c362(0x268)]['id'],_0x14c362(0x25f),{'reply_markup':{'inline_keyboard':[[{'text':_0x14c362(0x243),'callback_data':_0x14c362(0x1ed)},{'text':'No','callback_data':'no'}]]}})[_0x14c362(0x223)](_0x3c6b90=>{telegramError(_0x3c6b90);}),tgBot['on'](_0x14c362(0x1e5),async _0x116ff3=>{const _0x2aac9f=_0x14c362,_0x4718eb=_0x116ff3[_0x2aac9f(0x298)],_0x4f0467=_0x116ff3['message'];tgBot[_0x2aac9f(0x371)](_0x116ff3['id'])[_0x2aac9f(0x38e)](async()=>{const _0x55bbb5=_0x2aac9f;_0x4718eb==_0x55bbb5(0x1ed)&&(await tgBot[_0x55bbb5(0x2a5)](_0x4f0467['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x55bbb5(0x223)](_0x1b19d6=>{telegramError(_0x1b19d6);}),updateBB(_0x55bbb5(0x238))),_0x4718eb=='no'&&await tgBot[_0x55bbb5(0x2a5)](_0x4f0467['chat']['id'],_0x55bbb5(0x2f9))[_0x55bbb5(0x223)](_0x33fe05=>{telegramError(_0x33fe05);});}),tgBot['removeListener'](_0x2aac9f(0x1e5));}));}),tgBot[_0xcdfc2f(0x2f4)](/\/toggle/,_0x77f960=>{const _0x554f48=_0xcdfc2f;if(!validateTelegram(_0x77f960))return;tgBot[_0x554f48(0x307)](_0x554f48(0x1e5));const _0x5e80db=getBotsWithMode();if(_0x5e80db[_0x554f48(0x319)]==0x0)tgBot['sendMessage'](_0x77f960[_0x554f48(0x268)]['id'],_0x554f48(0x343))[_0x554f48(0x223)](_0x708bb4=>{telegramError(_0x708bb4);});else{let _0x96ef7b=[],_0x21eb54=[];const _0x45fcd8=0x2;let _0x1ba16d=0x0;_0x5e80db[_0x554f48(0x265)]((_0x4507f3,_0x3b168a)=>{const _0xf07d5a=_0x554f48;if(_0x3b168a%_0x45fcd8==0x0)_0x21eb54=[];_0x21eb54['push']({'text':_0xf07d5a(0x363)+_0x4507f3[_0xf07d5a(0x282)]+'\x20('+_0x4507f3[_0xf07d5a(0x26f)]+')','callback_data':_0x4507f3[_0xf07d5a(0x282)]}),_0x3b168a%_0x45fcd8==0x0&&(_0x96ef7b[_0x1ba16d]=_0x21eb54,_0x1ba16d++);}),tgBot[_0x554f48(0x2a5)](_0x77f960[_0x554f48(0x268)]['id'],_0x554f48(0x28d),{'reply_markup':{'inline_keyboard':_0x96ef7b}})[_0x554f48(0x223)](_0x4b83e3=>{telegramError(_0x4b83e3);}),tgBot['on']('callback_query',async _0x17b7f0=>{const _0x3b6554=_0x554f48,_0x3e135f=_0x17b7f0[_0x3b6554(0x298)],_0xb145f9=_0x17b7f0[_0x3b6554(0x39d)];tgBot[_0x3b6554(0x371)](_0x17b7f0['id'])[_0x3b6554(0x38e)](async()=>{const _0x4d1e7b=_0x3b6554,_0x5b9d24=_0x5e80db[_0x4d1e7b(0x258)](_0x3e70d2=>_0x3e70d2['botID']==_0x3e135f),_0x1b38b2=_0x5b9d24[_0x4d1e7b(0x26f)]==_0x4d1e7b(0x276)?_0x4d1e7b(0x2be):_0x4d1e7b(0x276);tgBot[_0x4d1e7b(0x2a5)](_0xb145f9[_0x4d1e7b(0x268)]['id'],_0x4d1e7b(0x27d)+_0x3e135f+_0x4d1e7b(0x334)+_0x1b38b2+'\x20mode')['catch'](_0x44396d=>{telegramError(_0x44396d);}),toggleBotMode(_0x3e135f);}),tgBot[_0x3b6554(0x307)]('callback_query');});}}),tgBot[_0xcdfc2f(0x2f4)](/\/names/,_0x17ace5=>{const _0x2be472=_0xcdfc2f;if(!validateTelegram(_0x17ace5))return;let _0x2b106c='';config['forEach'](_0x3f4f4f=>{const _0x482200=_0x17a2;_0x2b106c+='Bot\x20'+_0x3f4f4f[_0x482200(0x282)]+':\x20'+_0x3f4f4f[_0x482200(0x3a0)]+'\x0a';}),tgBot[_0x2be472(0x2a5)](_0x17ace5[_0x2be472(0x268)]['id'],_0x2b106c,{'parse_mode':_0x2be472(0x2f1)})[_0x2be472(0x223)](_0x116335=>{telegramError(_0x116335);});}),tgBot[_0xcdfc2f(0x2f4)](/\/disable/,_0x2b8e26=>{const _0x8a5269=_0xcdfc2f;if(!validateTelegram(_0x2b8e26))return;tgBot['sendMessage'](_0x2b8e26[_0x8a5269(0x268)]['id'],_0x8a5269(0x1cf))[_0x8a5269(0x223)](_0x5a411f=>{telegramError(_0x5a411f);}),updateSetting(_0x8a5269(0x213),![]);}),tgBot['onText'](/\/help/,_0x565dab=>{const _0x569951=_0xcdfc2f;if(!validateTelegram(_0x565dab))return;tgBot[_0x569951(0x2a5)](_0x565dab['chat']['id'],_0x283820)[_0x569951(0x223)](_0x2ecbd6=>{telegramError(_0x2ecbd6);});}),tgBot['on'](_0xcdfc2f(0x2aa),_0x33bd9a=>{const _0x1702f7=_0xcdfc2f;_0x33bd9a[_0x1702f7(0x1d4)]()[_0x1702f7(0x264)]('404\x20Not\x20Found')&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x1702f7(0x241)](),tgBot=null,io['to'](_0x1702f7(0x2a1))[_0x1702f7(0x30d)](_0x1702f7(0x27e),_0x1702f7(0x2fa)));}),process[_0xcdfc2f(0x35f)](_0xcdfc2f(0x236),()=>{const _0x3359a1=_0xcdfc2f;if(tgBot)tgBot[_0x3359a1(0x241)]();process[_0x3359a1(0x36a)](0x1);}),process[_0xcdfc2f(0x35f)](_0xcdfc2f(0x285),()=>{const _0x3b44e5=_0xcdfc2f;if(tgBot)tgBot[_0x3b44e5(0x241)]();process['exit'](0x1);});}}function disableTelegram(){const _0x44296a=_0x2ff023;tgBot&&(tgBot[_0x44296a(0x241)](),tgBot=null);}function sendTelegram(_0x39e3f5,_0x87fc09){const _0x191b5e=_0x2ff023;if(settings[_0x191b5e(0x213)]){if(settings['telegramEvents']==_0x191b5e(0x1c8)||(_0x87fc09[_0x191b5e(0x327)]==_0x191b5e(0x33c)||_0x87fc09[_0x191b5e(0x327)]==_0x191b5e(0x2a0)||_0x87fc09['type']=='success')&&settings[_0x191b5e(0x311)]=='alerts'||_0x87fc09[_0x191b5e(0x327)]==_0x191b5e(0x29d)&&settings[_0x191b5e(0x311)]==_0x191b5e(0x38b)){if(tgBot&&settings[_0x191b5e(0x308)]){if(_0x87fc09[_0x191b5e(0x354)])tgBot[_0x191b5e(0x2a5)](settings['telegramChatId'],_0x87fc09['botname']+_0x191b5e(0x2eb)+_0x87fc09[_0x191b5e(0x390)])['catch'](_0x2b1a1f=>{telegramError(_0x2b1a1f);});else tgBot[_0x191b5e(0x2a5)](settings['telegramChatId'],'Bot\x20'+_0x39e3f5+'\x20>\x20'+_0x87fc09[_0x191b5e(0x390)])[_0x191b5e(0x223)](_0x36a3ac=>{telegramError(_0x36a3ac);});}}}}async function sendTelegramMsg(_0x239bf8,_0x202226=_0x2ff023(0x2f1)){const _0xc455e5=_0x2ff023;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0xc455e5(0x308)],_0x239bf8,{'parse_mode':_0x202226})[_0xc455e5(0x223)](_0x1bfa3d=>{telegramError(_0x1bfa3d);}),!![]):![];}function getDeviceWithIp(_0x237c13){const _0x8c62b3=_0x2ff023;return devices[_0x8c62b3(0x258)](_0x273189=>_0x273189['ip']===_0x237c13);}function temporaryAccess2FA(_0x32358e,_0xc994fa){const _0x57d97c=_0x2ff023;let _0x29ad1b=new Date(),_0x2c6fab=![];if(lastIpApproval){if(_0x29ad1b-lastIpApproval<0x1388)_0x2c6fab=!![];}lastIpApproval=new Date();if(_0x2c6fab)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x57d97c(0x307)](_0x57d97c(0x1e5)),tgBot[_0x57d97c(0x2a5)](settings[_0x57d97c(0x308)],_0x57d97c(0x26a)+normalizeIP(_0xc994fa)[_0x57d97c(0x30a)]+'</b>\x20?',{'parse_mode':_0x57d97c(0x2f1),'reply_markup':{'inline_keyboard':[[{'text':_0x57d97c(0x31a),'callback_data':'5'},{'text':_0x57d97c(0x2a9),'callback_data':'15'},{'text':_0x57d97c(0x2b5),'callback_data':'30'},{'text':_0x57d97c(0x320),'callback_data':_0x57d97c(0x320)}]]}})[_0x57d97c(0x223)](_0x13b87f=>{telegramError(_0x13b87f);}),tgBot['on'](_0x57d97c(0x1e5),async _0x286e48=>{const _0x170e46=_0x57d97c,_0x352b61=_0x286e48[_0x170e46(0x298)],_0x240060=_0x286e48[_0x170e46(0x39d)];tgBot[_0x170e46(0x371)](_0x286e48['id'])[_0x170e46(0x38e)](async()=>{const _0x1b1ec2=_0x170e46;devices[_0x32358e][_0x1b1ec2(0x33b)]={'clientip':_0xc994fa,'timestamp':new Date()[_0x1b1ec2(0x2b6)](),'expiry':_0x352b61},_0x352b61!='reject'?(await tgBot[_0x1b1ec2(0x2a5)](_0x240060[_0x1b1ec2(0x268)]['id'],'Access\x20enabled\x20for\x20'+_0x352b61+_0x1b1ec2(0x34f),{'parse_mode':_0x1b1ec2(0x2f1)})[_0x1b1ec2(0x223)](_0x5460ec=>{telegramError(_0x5460ec);}),io['to'](_0x32358e)['emit'](_0x1b1ec2(0x2c2),{'access':{'allow':![],'reason':_0x1b1ec2(0x359),'token':null}})):(await tgBot['sendMessage'](_0x240060[_0x1b1ec2(0x268)]['id'],_0x1b1ec2(0x2b9))[_0x1b1ec2(0x223)](_0x44482d=>{telegramError(_0x44482d);}),io['to'](_0x32358e)[_0x1b1ec2(0x30d)](_0x1b1ec2(0x2c2),{'access':{'allow':![],'reason':_0x1b1ec2(0x24d),'token':null}}));}),tgBot['removeListener'](_0x170e46(0x1e5));}));}function loginAccess2FA(_0x19d96d,_0x3f4c88){const _0x1f2ba3=_0x2ff023;tgBot&&settings[_0x1f2ba3(0x308)]&&(tgBot[_0x1f2ba3(0x307)]('callback_query'),tgBot[_0x1f2ba3(0x2a5)](settings[_0x1f2ba3(0x308)],_0x1f2ba3(0x2b1)+normalizeIP(_0x3f4c88)[_0x1f2ba3(0x30a)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':'reject'}]]}})['catch'](_0x5db6e0=>{telegramError(_0x5db6e0);}),tgBot['on'](_0x1f2ba3(0x1e5),async _0x4c2200=>{const _0x4af12a=_0x1f2ba3,_0x545aec=_0x4c2200[_0x4af12a(0x298)],_0x443554=_0x4c2200[_0x4af12a(0x39d)];tgBot[_0x4af12a(0x371)](_0x4c2200['id'])[_0x4af12a(0x38e)](async()=>{const _0x269dfa=_0x4af12a;devices[_0x19d96d][_0x269dfa(0x38f)]={'clientip':_0x3f4c88,'timestamp':new Date()[_0x269dfa(0x2b6)](),'expiry':_0x545aec},_0x545aec!=_0x269dfa(0x320)?(await tgBot['sendMessage'](_0x443554[_0x269dfa(0x268)]['id'],_0x269dfa(0x386),{'parse_mode':_0x269dfa(0x2f1)})[_0x269dfa(0x223)](_0x1c29e3=>{telegramError(_0x1c29e3);}),io['to'](_0x19d96d)[_0x269dfa(0x30d)](_0x269dfa(0x2c2),{'access':{'allow':![],'reason':_0x269dfa(0x359),'token':null}})):(await tgBot[_0x269dfa(0x2a5)](_0x443554[_0x269dfa(0x268)]['id'],_0x269dfa(0x2d4))[_0x269dfa(0x223)](_0x1aaa97=>{telegramError(_0x1aaa97);}),io['to'](_0x19d96d)[_0x269dfa(0x30d)]('status',{'access':{'allow':![],'reason':_0x269dfa(0x1df),'token':null}}));}),tgBot['removeListener'](_0x4af12a(0x1e5));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4d9af4=_0x2ff023;return dbConfig['get'](_0x4d9af4(0x2b2))[_0x4d9af4(0x1f7)](_0x4d9af4(0x282))[_0x4d9af4(0x1e1)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0xe7b0af=_0x2ff023;return dbConfig[_0xe7b0af(0x356)](_0xe7b0af(0x2b2))[_0xe7b0af(0x1f7)](_0xe7b0af(0x282))[_0xe7b0af(0x1e1)]({'status':_0xe7b0af(0x221)})[_0xe7b0af(0x21d)]()||[];}function getBotAttributes(_0x3f4a3c){const _0x2d6bd6=_0x2ff023;let _0x5b4b5a={};const _0x56bec3=configpath+_0x2d6bd6(0x32b)+_0x3f4a3c+'-config.json',_0x402e51=fs[_0x2d6bd6(0x32d)](_0x56bec3);if(_0x402e51){const _0x46dab7=fs[_0x2d6bd6(0x338)](_0x56bec3);try{const _0x3aed27=JSON[_0x2d6bd6(0x2ac)](_0x46dab7),_0xdb91d7=_0x3aed27?_0x3aed27[_0x2d6bd6(0x1fc)][0x0]['headless']:![];_0x5b4b5a[_0x2d6bd6(0x26f)]=_0xdb91d7?'auto':_0x2d6bd6(0x2be),_0x5b4b5a[_0x2d6bd6(0x3a0)]=_0x3aed27?_0x3aed27['bot'][0x0]['botname']:_0x2d6bd6(0x363)+_0x3f4a3c;}catch(_0x244206){_0x5b4b5a[_0x2d6bd6(0x26f)]='manual',_0x5b4b5a[_0x2d6bd6(0x3a0)]='Bot\x20'+_0x3f4a3c;}}else _0x5b4b5a['mode']=_0x2d6bd6(0x2be),_0x5b4b5a[_0x2d6bd6(0x3a0)]=_0x2d6bd6(0x363)+_0x3f4a3c;return _0x5b4b5a;}function getBotsWithMode(){const _0x319a82=_0x2ff023,_0x58ecdb=dbConfig['get']('bots')[_0x319a82(0x1f7)]('botID')[_0x319a82(0x21d)]()||[];return _0x58ecdb[_0x319a82(0x265)](_0x16a914=>{const _0x17c5af=_0x319a82;let _0x214ccc=getBotAttributes(_0x16a914['botID']);_0x16a914[_0x17c5af(0x26f)]=_0x214ccc[_0x17c5af(0x26f)];}),_0x58ecdb;}function getBotExchanges(){const _0x11bb01=_0x2ff023;let _0x395979=[];const _0x3c4d4f=dbConfig[_0x11bb01(0x356)](_0x11bb01(0x2b2))[_0x11bb01(0x1f7)](_0x11bb01(0x282))[_0x11bb01(0x21d)]()||[];_0x3c4d4f[_0x11bb01(0x265)](_0x22e6fd=>{const _0x52207b=_0x11bb01;if(_0x22e6fd['status']==_0x52207b(0x2bd)){const _0x374e5d=configpath+_0x52207b(0x32b)+_0x22e6fd['botID']+'-config.json',_0x275d2d=fs['existsSync'](_0x374e5d);let _0x3c9da7;if(_0x275d2d){const _0x9b0435=fs[_0x52207b(0x338)](_0x374e5d);try{const _0x21dd4d=JSON[_0x52207b(0x2ac)](_0x9b0435);_0x3c9da7=_0x21dd4d?_0x21dd4d['bot'][0x0][_0x52207b(0x364)]:null;}catch(_0x266ac0){}}if(_0x3c9da7)_0x395979[_0x52207b(0x377)](_0x3c9da7);}});const _0x26e373=[...new Set(_0x395979)][_0x11bb01(0x389)]();return _0x26e373;}async function initUser(){const _0x14d934=_0x2ff023;if(!settings[_0x14d934(0x2fb)]){const _0x19bd74=uuidRandom();mixpanel['alias'](_0x19bd74),updateSetting(_0x14d934(0x2fb),_0x19bd74);}}async function initSecure(){const _0x36e718=_0x2ff023;let _0x4483f3=getSecure();if(!_0x4483f3[_0x36e718(0x224)](_0x36e718(0x34d))){let _0x5015ea=await generateKeys();_0x4483f3[_0x36e718(0x346)]=_0x5015ea[_0x36e718(0x346)],_0x4483f3['privateKey']=_0x5015ea['privateKey'],_0x4483f3[_0x36e718(0x34d)]=crypto['randomBytes'](0x20)[_0x36e718(0x1d4)](_0x36e718(0x37c));;storeSecure(_0x4483f3);}}function getSettings(){const _0x33b262=_0x2ff023;return dbSettings[_0x33b262(0x356)](_0x33b262(0x270))['value']()||{};}function getSecure(){const _0x4cffb8=_0x2ff023;return dbSecure[_0x4cffb8(0x356)](_0x4cffb8(0x225))[_0x4cffb8(0x21d)]()||{};}function getBlacklist(){const _0x11773a=_0x2ff023;return dbSecure[_0x11773a(0x356)](_0x11773a(0x33a))[_0x11773a(0x21d)]()||[];}function broadcastToBots(_0x1057b1,_0x5ba79c){config['forEach'](_0x34bba0=>{const _0xd16f4a=_0x17a2;if(_0x34bba0[_0xd16f4a(0x2c2)]==_0xd16f4a(0x2bd)&&_0x34bba0[_0xd16f4a(0x2c4)]=='running'||_0x34bba0['status']==_0xd16f4a(0x383)&&_0x34bba0['live']=='running'){if(pid[_0x34bba0['botID']])pid[_0x34bba0['botID']][_0xd16f4a(0x208)]({[_0x1057b1]:_0x5ba79c});}});}function storeSettings(_0x18a881,_0x5d1ab5=![]){const _0x42073a=_0x2ff023;_0x18a881={...settings,..._0x18a881};if(_0x5d1ab5&&_0x18a881[_0x42073a(0x2ad)]!='************'&&_0x18a881['bbPassword']!=_0x42073a(0x2ea)&&_0x18a881['bbPassword']!=''){const _0x45d595=crypt[_0x42073a(0x358)](secure['privateKey'],_0x18a881[_0x42073a(0x2ad)])[_0x42073a(0x39d)][_0x42073a(0x222)]('@')[0x0],_0x786ee9=bcrypt[_0x42073a(0x1ec)](_0x45d595,saltRounds);_0x18a881={..._0x18a881,'bbPassword':_0x786ee9};}if(_0x5d1ab5&&_0x18a881[_0x42073a(0x394)]!=_0x42073a(0x251)&&_0x18a881['telegramToken']!=_0x42073a(0x2ea)&&_0x18a881['telegramToken']!=''){const _0x320ef8=crypt['decrypt'](secure[_0x42073a(0x2dd)],_0x18a881[_0x42073a(0x394)])[_0x42073a(0x39d)][_0x42073a(0x222)]('@')[0x0];_0x18a881={..._0x18a881,'telegramToken':_0x320ef8};}const _0x2de72c=_0x18a881['telegramToken']!=_0x42073a(0x251)&&_0x18a881[_0x42073a(0x394)]!=settings[_0x42073a(0x394)]||_0x18a881['telegramUsername']!=settings[_0x42073a(0x382)],_0x19aa55=_0x18a881[_0x42073a(0x394)]==''||_0x18a881[_0x42073a(0x382)]=='';if(_0x2de72c)_0x18a881[_0x42073a(0x311)]='all';for(const [_0x416393,_0x33e384]of Object['entries'](_0x18a881)){if(_0x416393==_0x42073a(0x394)&&_0x33e384=='************'){_0x18a881[_0x42073a(0x394)]=settings[_0x42073a(0x394)];continue;};if(_0x416393==_0x42073a(0x2ad)&&_0x33e384=='************'){_0x18a881['bbPassword']=settings[_0x42073a(0x2ad)];continue;};dbSettings[_0x42073a(0x2e3)]('settings.'+_0x416393,_0x33e384)['write']();}settings=_0x18a881,io['to'](_0x42073a(0x2a1))[_0x42073a(0x30d)]('settings',cleanSettings()),broadcastToBots(_0x42073a(0x362),settings[_0x42073a(0x362)]),broadcastToBots(_0x42073a(0x3a6),settings[_0x42073a(0x3a6)]);if(_0x2de72c&&!_0x19aa55)initTelegram();if(_0x2de72c&&_0x19aa55)disableTelegram();getAllClients()[_0x42073a(0x265)](_0x1e95f3=>{const _0x3d78c9=_0x42073a;getSocket(_0x1e95f3['id'])[_0x3d78c9(0x30d)]('status',{'access':{'allow':![],'reason':_0x3d78c9(0x359),'token':null}});});}function updateSetting(_0xc57fca,_0x1f070d){const _0x1290a0=_0x2ff023;dbSettings['set'](_0x1290a0(0x2da)+_0xc57fca,_0x1f070d)[_0x1290a0(0x280)](),settings=getSettings(),io['to'](_0x1290a0(0x2a1))[_0x1290a0(0x30d)](_0x1290a0(0x270),cleanSettings());}function storeSecure(_0x555f8c){const _0x489a95=_0x2ff023;dbSecure[_0x489a95(0x356)](_0x489a95(0x225))[_0x489a95(0x377)](_0x555f8c)[_0x489a95(0x280)](),secure=_0x555f8c;}function addBlacklist(_0x2fbd3f){const _0x44d0b9=_0x2ff023;cleanBlacklist();let _0x5f9daf;devices[_0x2fbd3f][_0x44d0b9(0x33b)]?_0x5f9daf=Math['max'](devices[_0x2fbd3f][_0x44d0b9(0x33b)][_0x44d0b9(0x3a9)],loginExpiry):_0x5f9daf=loginExpiry,dbSecure[_0x44d0b9(0x356)]('blacklist')[_0x44d0b9(0x377)]({'expiry':new Date()[_0x44d0b9(0x2b6)]()+_0x5f9daf*0x3c*0x3e8,'token':devices[_0x2fbd3f][_0x44d0b9(0x1ea)][_0x44d0b9(0x203)]})[_0x44d0b9(0x280)](),blacklist=dbSecure[_0x44d0b9(0x356)](_0x44d0b9(0x33a))[_0x44d0b9(0x21d)]();}function cleanBlacklist(){const _0x18e44f=_0x2ff023;let _0x13fb97=dbSecure[_0x18e44f(0x356)](_0x18e44f(0x33a))[_0x18e44f(0x2ce)]()[_0x18e44f(0x21d)](),_0x411618=new Date()[_0x18e44f(0x2b6)]();_0x13fb97['forEach'](_0x2a41a8=>{const _0x55c5e0=_0x18e44f;_0x2a41a8[_0x55c5e0(0x3a9)]<_0x411618&&dbSecure[_0x55c5e0(0x356)]('blacklist')['remove']({'expiry':_0x2a41a8[_0x55c5e0(0x3a9)]})['write']();});}function initStates(){const _0xf950e8=_0x2ff023;let _0x484c06=getConfiguration();_0x484c06[_0xf950e8(0x265)](_0x3beea5=>{const _0x24321c=_0xf950e8;_0x3beea5[_0x24321c(0x2c4)]=_0x24321c(0x252);}),storeConfiguration(_0x484c06);}function onKeys(){const _0x4c28b5=new RSA();return new Promise(_0x4ed41d=>{const _0x2a7b0a=_0x17a2;_0x4c28b5[_0x2a7b0a(0x289)]()[_0x2a7b0a(0x38e)](_0x2a629c=>{_0x4ed41d(_0x2a629c);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2ed2c6=_0x2ff023;let _0x39f76c=getSettings(),_0x5d7350=![];!_0x39f76c['hasOwnProperty']('lastmsgtelegram')&&(_0x39f76c[_0x2ed2c6(0x37d)]=0x0,_0x5d7350=!![]);!_0x39f76c['hasOwnProperty'](_0x2ed2c6(0x1fe))&&(_0x39f76c[_0x2ed2c6(0x1fe)]=0x0,_0x5d7350=!![]);!_0x39f76c[_0x2ed2c6(0x224)](_0x2ed2c6(0x20a))&&(_0x39f76c[_0x2ed2c6(0x20a)]=_0x2ed2c6(0x315),_0x5d7350=!![]);!_0x39f76c['hasOwnProperty']('onepagemode')&&(_0x39f76c[_0x2ed2c6(0x3a6)]=![],_0x5d7350=!![]);if(_0x5d7350)storeSettings(_0x39f76c);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x2ed2c6(0x265)](_0x4db0ba=>{const _0x473776=_0x2ed2c6;if(!_0x4db0ba[_0x473776(0x2ef)]()){if(!_0x4db0ba[_0x473776(0x39f)][_0x473776(0x312)](_0x473776(0x2e9)))fs[_0x473776(0x2c7)](configbackuppath+_0x4db0ba[_0x473776(0x39f)]);}else fs['rmSync'](configbackuppath+_0x4db0ba['name'],{'recursive':!![]});});}catch(_0x223aab){logger[_0x2ed2c6(0x3a1)](_0x2ed2c6(0x244),_0x223aab);}}function _0x3d06(){const _0x5d27eb=['settings','address','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','telegrammsg','2FA\x20login\x20required','auto','Alerts','use','/:bot/performance','rmSync','port',':\x20Bot\x20Mgr\x20>\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','notification','show-config','write','node','botID','backup/','remoteAddress','SIGTERM','get-starting-balances','number','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','generateKeyPairAsync','constructor','defaults','jsonwebtoken','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','slice','getDate','statSync','sendMetricsTelegram','updatebotmanager','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','=>\x20Go\x20to\x20#CYA#http://','logs','backup-full.zip','RSA','data','confirm-message','Restore\x20backup\x20file\x20','\x1b[35m','telegram','order','\x1b[34m','started','warning','botmanager','files','-----------------------------------------------------------------------------------','lowdb','sendMessage','-performance.json','reset-password','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','15\x20min','polling_error','binary','parse','bbPassword','initclient','Idling\x20bot\x20\x20\x20|\x20Bot\x20','private','Allow\x20login\x20from\x20IP\x20address\x20<b>','bots','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','3000','30\x20min','getTime','temporary\x20access\x20timeout','Server','Temporary\x20access\x20rejected','storeFiat','restore-backup-file','format','enabled','manual','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','toIPv4MappedAddress','status','(((.+)+)+)+$','live','exp','stop','unlinkSync','24913MNLEBU','pidRefreshToken','showConfig','crypto','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','bb-secure.json','cloneDeep','#RES#\x20if\x20running\x20on\x20server','Backup\x20file\x20unzipped\x20and\x20stored','3371792IfrPZi','login','from','Login\x20rejected','All','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','timestamp','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Markdown','settings.','search','Starting\x20new\x20bot\x20|\x20Bot\x20','privateKey','Node.js\x20v','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','<b>Telegram\x20Bot\x20Status:</b>\x0a','Backup\x20file\x20uploaded','temporary\x20access\x20not\x20allowed','set','uuid','getMinutes','Token\x20blacklisted','temporary\x20token\x20generated','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','backup-full@','***','\x20>\x20','backup-files','store-fiat','connection','isDirectory','2FA\x20login\x20token\x20generated','HTML','/off\x20-\x20stop\x20bot(s)\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','onText','get-messages','build','clients','sha256','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Invalid\x20Telegram\x20token','userid','inherit','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bcryptjs','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','alerts','::1','messages','temporaryAccessAllowed','copyFileSync','get-logs','removeListener','telegramChatId','bot.js','show','Ok,\x20will\x20send\x20order\x20notifications\x20only','match','emit','lowdb/adapters/FileSync','2057bUpNkg','cancelLoading','telegramEvents','startsWith','logged\x20out','hybrid-crypto-js','0.0.0','request','removeAllListeners','api-eu.mixpanel.com','length','5\x20min','Starting\x20#RED#Balance\x20Bot\x20v','1dBhkmy','You\x20can\x20use\x20the\x20following\x20commands:\x0a','getSeconds','/restart\x20-\x20restart\x20bot(s)\x0a','reject','verify','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','logs/','add-bot','headers','#RES#\x20if\x20running\x20locally\x0a','type','Your\x20installation\x20is\x20already\x20up\x20to\x20date','127.0.0.1','delete-alerts','bot-','readdirSync','existsSync','getMonth','backup','store-headless','string','build2','update','\x20to\x20','emitHistory','size','delete-bot','readFileSync','endsWith','blacklist','telegramIpApproval','error','bbvReceive','listen','full','range','7973230EgmIpO','connected','No\x20bots\x20running\x20right\x20now','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','6YIDvbI','publicKey','sockets','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','DEFLATE','ipc','Failed\x20to\x20download\x20','restart','secret','map','\x20minutes','/:bot/portfolio','Password\x20reset\x20rejected','placeOrder','RSA-OAEP','showname','compareSync','get','username','decrypt','reload','graphql-request','params','yargs/yargs','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','once','replace','backup-full','timeshift','Bot\x20','exchange','getFullYear','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','exit','apiSecret','place-order','login\x20required','store-settings','.zip','keys','answerCallbackQuery','join','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','bb-settings.json','\x20|\x20client:\x20...','556475oNWWJb','push','Starting\x20Balance\x20Bot\x20','server','title','logout','hex','lastmsgtelegram','axios','disconnect','success','config/','telegramUsername','new','version.json','4GsCWMe','Login\x20accepted','output-000.log','argv','sort','*$1*','orders','_data','sendPortfolioTelegram','then','telegram2FaApproval','event','login\x20token\x20valid','\x20|\x20','loginRequired','telegramToken','bbvNew','deleteHistoryAlerts','static','/names\x20-\x20show\x20bot\x20names\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','cancel-loading','IPv4','Unauthorized\x20attempt\x20to\x20show\x20configuration','message','getUTCHours','name','botname','debug','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','uncaughtException','simple','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','onepagemode','padStart','uuid-random','expiry','2FA\x20required','createWriteStream','randomFillSync','all','NTBA_FIX_319','update-bot','express-fileupload','login\x20token\x20generated','Bot\x20Mgr\x20>\x20','/upload-backup','Notifications\x20disabled','util','Invalid\x20authentication\x20token\x20(1)','http','\x20(2)','toString','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','headless','User\x20has\x20been\x20validated','26508wFvZiv','assign','init','add','download','tkn','All\x20bots','2FA\x20login\x20rejected','createServer','filter','getHours','Session\x20expired\x20for\x20user\x20...','Starting\x20Balance\x20Bot\x20update','callback_query','\x1b[31m','isValid','/:bot/history','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','access','password','hashSync','yes','\x20(1)','backupfile','min','resetHistory','reset-history','kill','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Notifications\x20disabled\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','sortBy','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','stringify','https://api.ipify.org?format=json','post','bot','Error\x20while\x20deleting\x20config\x20files:\x20','lastmsgemitted','Unauthorized\x20attempt\x20to\x20update\x20bot','whitelistEnabled','f2aRequired','Invalid\x20username\x20or\x20IP\x20address','token','internal',',\x20must\x20be\x20a\x204\x20digit\x20number','user','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','send','Error:\x20Invalid\x20argument\x20','latestversion','any','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Notifications\x20types:\x20','zip/','store','reason','getPortfolio','mkdirSync','telegramEnabled','Unauthorized\x20attempt\x20to\x20log\x20out','clientip','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','index.html','2FA','1488238trHAOV','Starting\x20bot\x20|\x20Bot\x20','family','Unauthorized\x20attempt\x20to\x20get\x20events','value','Notifications\x20enabled','/download/:type','new-disabled','disabled','split','catch','hasOwnProperty','secure','toIPv4Address','env','referer','ipv6','output-003.log','date-fns','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','bbUsername','\x1b[33m','Unauthorized\x20attempt\x20to\x20get\x20messages','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','mtime','remove','invalid\x20credentials','access\x20timeout','SIGINT','Notifications\x20enabled\x0a','reinstall','bb/','ipaddr.js','Unauthorized\x20attempt\x20to\x20download\x20','login\x20not\x20required','Deleted\x20Bot\x20','/on\x20-\x20start\x20bot(s)\x0a','<b>Balance\x20Bot\x20Status:</b>\x0a','isIPv4MappedAddress','stopPolling','apiPassword','Yes','Error\x20removing\x20old\x20backup\x20files:','mixpanel','apiKey','9HXPYMb','storeConfiguration','fork','sendFile','\x20only\x0a','store-configuration','temporary\x20access\x20rejected','handshake','Unauthorized\x20attempt\x20to\x20delete\x20alerts','allow','************','stopped','version','host','temp/','whitelist','output-001.log','find','1276446QBldFR','getStartingBalances','output-002.log','test','encryptedUuid','toggleBotMode','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','log','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','function','path','includes','forEach','-config.json','node-zip','chat','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','sign','pidExpireLogin','writeFileSync','Logged\x20out\x20user\x20...','mode'];_0x3d06=function(){return _0x5d27eb;};return _0x3d06();}function storeConfiguration(_0x299a83){const _0x3ad3b9=_0x2ff023;dbConfig[_0x3ad3b9(0x356)]('bots')[_0x3ad3b9(0x233)]()[_0x3ad3b9(0x280)](),_0x299a83[_0x3ad3b9(0x265)](_0x325a09=>{delete _0x325a09['mode'];}),dbConfig[_0x3ad3b9(0x356)](_0x3ad3b9(0x2b2))['push'](..._0x299a83)[_0x3ad3b9(0x280)](),config=_0x299a83;}function resetPassword(){const _0x3ec477=_0x2ff023;tgBot&&settings['telegramChatId']&&(tgBot[_0x3ec477(0x307)](_0x3ec477(0x1e5)),tgBot[_0x3ec477(0x2a5)](settings[_0x3ec477(0x308)],_0x3ec477(0x269),{'parse_mode':_0x3ec477(0x2f1),'reply_markup':{'inline_keyboard':[[{'text':_0x3ec477(0x1ed),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x3ec477(0x223)](_0x328117=>{telegramError(_0x328117);}),tgBot['on']('callback_query',async _0x49534b=>{const _0x2c7981=_0x3ec477,_0x572413=_0x49534b[_0x2c7981(0x298)],_0x3a0458=_0x49534b[_0x2c7981(0x39d)];tgBot[_0x2c7981(0x371)](_0x49534b['id'])[_0x2c7981(0x38e)](async()=>{const _0x2e4607=_0x2c7981;if(_0x572413!='no'){const _0x3b56c5=0xf,_0x580594=_0x2e4607(0x207),_0x28a080=Array[_0x2e4607(0x2d3)](crypto[_0x2e4607(0x3ac)](new Uint32Array(_0x3b56c5)))[_0x2e4607(0x34e)](_0x4de051=>_0x580594[_0x4de051%_0x580594[_0x2e4607(0x319)]])[_0x2e4607(0x372)](''),_0x5cc3a0=bcrypt['hashSync'](_0x28a080,saltRounds);storeSettings({'bbPassword':_0x5cc3a0}),await tgBot[_0x2e4607(0x2a5)](_0x3a0458[_0x2e4607(0x268)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x28a080,{'parse_mode':'HTML'})[_0x2e4607(0x223)](_0x5dd1de=>{telegramError(_0x5dd1de);});}else await tgBot[_0x2e4607(0x2a5)](_0x3a0458[_0x2e4607(0x268)]['id'],_0x2e4607(0x351))[_0x2e4607(0x223)](_0x1b999a=>{telegramError(_0x1b999a);});}),tgBot[_0x2c7981(0x307)](_0x2c7981(0x1e5));}));}async function confirmRestore(_0x4d1f26,_0x1e11bc){const _0x2ef0e8=_0x2ff023;io['to'](_0x2ef0e8(0x2a1))[_0x2ef0e8(0x30d)](_0x2ef0e8(0x27e),_0x2ef0e8(0x2d6),'success'),tgBot&&settings[_0x2ef0e8(0x308)]&&(tgBot[_0x2ef0e8(0x307)](_0x2ef0e8(0x1e5)),await tgBot[_0x2ef0e8(0x2a5)](settings['telegramChatId'],_0x2ef0e8(0x3a2),{'parse_mode':_0x2ef0e8(0x2f1),'reply_markup':{'inline_keyboard':[[{'text':_0x2ef0e8(0x1ed),'callback_data':_0x2ef0e8(0x1ed)},{'text':'no','callback_data':'no'}]]}})[_0x2ef0e8(0x223)](_0xfe197a=>{telegramError(_0xfe197a);}),tgBot['on'](_0x2ef0e8(0x1e5),async _0x25ee95=>{const _0x327756=_0x2ef0e8,_0x30f806=_0x25ee95[_0x327756(0x298)],_0x12b368=_0x25ee95[_0x327756(0x39d)];tgBot['answerCallbackQuery'](_0x25ee95['id'])[_0x327756(0x38e)](async()=>{const _0x5e7549=_0x327756;_0x30f806==_0x5e7549(0x1ed)?(await tgBot[_0x5e7549(0x2a5)](_0x12b368[_0x5e7549(0x268)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x5e7549(0x2f1)})[_0x5e7549(0x223)](_0x5d49de=>{telegramError(_0x5d49de);}),unzipFile(_0x4d1f26,_0x1e11bc)):(logger[_0x5e7549(0x3a1)]('Restore\x20process\x20aborted'),await tgBot[_0x5e7549(0x2a5)](_0x12b368['chat']['id'],'Restore\x20process\x20aborted')[_0x5e7549(0x223)](_0x1e9705=>{telegramError(_0x1e9705);}));}),tgBot[_0x327756(0x307)](_0x327756(0x1e5));}));}function getServerTime(){const _0x22ab2a=_0x2ff023,_0x14a9ad=new Date();return _0x14a9ad[_0x22ab2a(0x365)]()+'/'+(_0x14a9ad['getMonth']()+0x1)[_0x22ab2a(0x1d4)]()['padStart'](0x2,'0')+'/'+_0x14a9ad[_0x22ab2a(0x28f)]()[_0x22ab2a(0x1d4)]()[_0x22ab2a(0x3a7)](0x2,'0')+'\x20'+_0x14a9ad[_0x22ab2a(0x1e2)]()['toString']()[_0x22ab2a(0x3a7)](0x2,'0')+':'+_0x14a9ad[_0x22ab2a(0x2e5)]()[_0x22ab2a(0x1d4)]()[_0x22ab2a(0x3a7)](0x2,'0')+':'+_0x14a9ad[_0x22ab2a(0x31e)]()[_0x22ab2a(0x1d4)]()[_0x22ab2a(0x3a7)](0x2,'0');}function getTimeStamp(){const _0x2a8f71=_0x2ff023,_0x49d27b=shiftedTime();return _0x49d27b[_0x2a8f71(0x365)]()+'/'+(_0x49d27b[_0x2a8f71(0x32e)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x49d27b[_0x2a8f71(0x28f)]()[_0x2a8f71(0x1d4)]()['padStart'](0x2,'0')+'\x20'+_0x49d27b['getHours']()[_0x2a8f71(0x1d4)]()['padStart'](0x2,'0')+':'+_0x49d27b['getMinutes']()[_0x2a8f71(0x1d4)]()[_0x2a8f71(0x3a7)](0x2,'0')+':'+_0x49d27b[_0x2a8f71(0x31e)]()[_0x2a8f71(0x1d4)]()[_0x2a8f71(0x3a7)](0x2,'0');}function getCleanTimeStamp(){const _0x207b9d=_0x2ff023,_0x592462=shiftedTime();return _0x592462[_0x207b9d(0x365)]()+(_0x592462[_0x207b9d(0x32e)]()+0x1)[_0x207b9d(0x1d4)]()[_0x207b9d(0x3a7)](0x2,'0')+_0x592462[_0x207b9d(0x28f)]()[_0x207b9d(0x1d4)]()[_0x207b9d(0x3a7)](0x2,'0')+'-'+_0x592462[_0x207b9d(0x1e2)]()[_0x207b9d(0x1d4)]()[_0x207b9d(0x3a7)](0x2,'0')+_0x592462['getMinutes']()['toString']()['padStart'](0x2,'0')+_0x592462[_0x207b9d(0x31e)]()[_0x207b9d(0x1d4)]()[_0x207b9d(0x3a7)](0x2,'0');}function shiftedTime(){const _0x267cce=_0x2ff023,_0x325a87=new Date();let _0x40ac57=_0x325a87;if(settings[_0x267cce(0x362)]&&settings[_0x267cce(0x362)]!==0x0)_0x40ac57=fns[_0x267cce(0x1db)](_0x325a87,{'hours':settings['timeshift']});return _0x40ac57;}function startScheduler(){const _0x3c1b02=_0x2ff023,_0x55f67e=new Date()[_0x3c1b02(0x39e)](),_0x45b822=shiftedTime()[_0x3c1b02(0x1e2)]();_0x45b822==0x4&&backupConfigFiles();_0x45b822==0x0&&rotateLogFiles();_0x55f67e%0x6==0x0&&triggerAnalytics();_0x55f67e%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1efc1a){const _0x182458=_0x2ff023;logger[_0x182458(0x3a1)](_0x182458(0x29a)+_0x1efc1a);const _0x2df352=getBotsWithMode();_0x2df352['length']>0x0?confirmRestore(configbackuppath,_0x1efc1a):unzipFile(configbackuppath,_0x1efc1a);}async function getBackupFiles(_0x108bfa=null){const _0x14cd3f=_0x2ff023;let _0xb66b67=[],_0x296c34=fs[_0x14cd3f(0x32c)](configbackuppath,{'withFileTypes':!![]});_0x296c34[_0x14cd3f(0x389)]((_0x5e1fc1,_0x4154c8)=>_0x5e1fc1['name']<_0x4154c8[_0x14cd3f(0x39f)]?0x1:_0x4154c8[_0x14cd3f(0x39f)]<_0x5e1fc1[_0x14cd3f(0x39f)]?-0x1:0x0),_0x296c34[_0x14cd3f(0x265)](_0x46778d=>{const _0x10c2e1=_0x14cd3f;if(!_0x46778d[_0x10c2e1(0x2ef)]()&&_0x46778d[_0x10c2e1(0x39f)]['startsWith'](_0x10c2e1(0x2e9))&&_0x46778d[_0x10c2e1(0x39f)][_0x10c2e1(0x339)](_0x10c2e1(0x36f))){const _0x3dfade=formatDate(fs[_0x10c2e1(0x290)](configbackuppath+_0x46778d[_0x10c2e1(0x39f)])[_0x10c2e1(0x232)]);_0xb66b67[_0x10c2e1(0x377)]({'name':_0x46778d[_0x10c2e1(0x39f)],'mtime':_0x3dfade});}});if(_0x108bfa)io['to'](_0x108bfa)['emit'](_0x14cd3f(0x2ec),_0xb66b67);else return _0xb66b67;}async function backupConfigFiles(){const _0x139f22=_0x2ff023;await zipFiles(_0x139f22(0x361));const _0x438c1=getCleanTimeStamp();fs[_0x139f22(0x305)](zippath+_0x139f22(0x296),configbackuppath+(_0x139f22(0x2e9)+_0x438c1+_0x139f22(0x36f)));let _0x27e989=fs[_0x139f22(0x32c)](configbackuppath,{'withFileTypes':!![]});_0x27e989[_0x139f22(0x389)]((_0x1b2c0b,_0x4c7f01)=>_0x1b2c0b[_0x139f22(0x39f)]<_0x4c7f01[_0x139f22(0x39f)]?0x1:_0x4c7f01['name']<_0x1b2c0b['name']?-0x1:0x0),_0x27e989['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x27e989[_0x27e989[_0x139f22(0x319)]-0x1][_0x139f22(0x39f)]);}function rotateLogFiles(){const _0x2f473b=_0x2ff023,_0x1374d8=fs[_0x2f473b(0x290)](logspath+_0x2f473b(0x387)),_0x2fd5ff=_0x1374d8[_0x2f473b(0x336)]/0x400;if(_0x2fd5ff>0x64){let _0x72e505=fs[_0x2f473b(0x32c)](logspath,{'withFileTypes':!![]});_0x72e505[_0x2f473b(0x389)]((_0x543302,_0x347358)=>_0x543302[_0x2f473b(0x39f)]<_0x347358[_0x2f473b(0x39f)]?0x1:_0x347358[_0x2f473b(0x39f)]<_0x543302['name']?-0x1:0x0),_0x72e505[_0x2f473b(0x265)](_0x6ea2be=>{const _0x184f3e=_0x2f473b;if(_0x6ea2be[_0x184f3e(0x39f)]==_0x184f3e(0x25b))fs[_0x184f3e(0x305)](logspath+_0x6ea2be['name'],logspath+_0x184f3e(0x22a));if(_0x6ea2be['name']==_0x184f3e(0x257))fs[_0x184f3e(0x305)](logspath+_0x6ea2be[_0x184f3e(0x39f)],logspath+_0x184f3e(0x25b));_0x6ea2be[_0x184f3e(0x39f)]==_0x184f3e(0x387)&&(fs[_0x184f3e(0x305)](logspath+_0x6ea2be[_0x184f3e(0x39f)],logspath+_0x184f3e(0x257)),fs['writeFileSync'](logspath+_0x6ea2be['name'],''));});}}async function zipFiles(_0x419e8f){const _0x19f76d=_0x2ff023;let _0x3f99c2;if(_0x419e8f==_0x19f76d(0x295))_0x3f99c2=logspath;if(_0x419e8f==_0x19f76d(0x32f))_0x3f99c2=configpath;if(_0x419e8f=='backup-full')_0x3f99c2=configpath;let _0x5460c6=fs['readdirSync'](_0x3f99c2,{'withFileTypes':!![]});const _0x4265c8=new require(_0x19f76d(0x267))();_0x5460c6[_0x19f76d(0x265)](_0x34bb8d=>{const _0x493029=_0x19f76d;if(!_0x34bb8d[_0x493029(0x2ef)]()){let _0x2eacab=fs['readFileSync'](_0x3f99c2+_0x34bb8d['name']);if(_0x419e8f==_0x493029(0x32f)){const _0x59f9e4=/^bot-[0-9]{3}-config.json$/,_0x2bc37c=_0x59f9e4['test'](_0x34bb8d['name']);if(_0x2bc37c){const _0x5f3871=JSON[_0x493029(0x2ac)](_0x2eacab);if(_0x5f3871['bot'][0x0]){_0x5f3871[_0x493029(0x1fc)][0x0][_0x493029(0x246)]=_0x493029(0x2ea),_0x5f3871[_0x493029(0x1fc)][0x0][_0x493029(0x36b)]=_0x493029(0x2ea);if(_0x5f3871[_0x493029(0x1fc)][0x0][_0x493029(0x242)])_0x5f3871[_0x493029(0x1fc)][0x0][_0x493029(0x242)]=_0x493029(0x2ea);}_0x2eacab=JSON[_0x493029(0x1f9)](_0x5f3871,null,0x2);}if(_0x34bb8d[_0x493029(0x39f)]==_0x493029(0x374)){const _0x22afe5=JSON['parse'](_0x2eacab);if(_0x22afe5['settings'][_0x493029(0x393)])_0x22afe5['settings'][_0x493029(0x393)]=![];if(_0x22afe5['settings'][_0x493029(0x2ad)])_0x22afe5[_0x493029(0x270)]['bbPassword']=_0x493029(0x2ea);if(_0x22afe5[_0x493029(0x270)][_0x493029(0x394)])_0x22afe5['settings'][_0x493029(0x394)]=_0x493029(0x2ea);if(_0x22afe5['settings'][_0x493029(0x308)])_0x22afe5[_0x493029(0x270)][_0x493029(0x308)]=null;_0x2eacab=JSON[_0x493029(0x1f9)](_0x22afe5,null,0x2);}if(_0x34bb8d['name']!=_0x493029(0x2cd))_0x4265c8['file'](_0x34bb8d[_0x493029(0x39f)],_0x2eacab);}else _0x4265c8['file'](_0x34bb8d['name'],_0x2eacab);}});const _0x22dd6d=_0x4265c8['generate']({'base64':![],'compression':_0x19f76d(0x349)});fs[_0x19f76d(0x26d)](zippath+(_0x419e8f+_0x19f76d(0x36f)),_0x22dd6d,'binary');}async function unzipFile(_0x1e0114,_0x68ff91){const _0x1b533b=_0x2ff023;fs[_0x1b533b(0x32c)](configpath,{'withFileTypes':!![]})[_0x1b533b(0x265)](_0x409e4e=>{const _0x3c124f=_0x1b533b;if(!_0x409e4e[_0x3c124f(0x2ef)]())fs[_0x3c124f(0x27a)](configpath+_0x409e4e['name']);});const _0x1d9c10=fs[_0x1b533b(0x338)](_0x1e0114+_0x68ff91,_0x1b533b(0x2ab)),_0xff6193=new require('node-zip')(_0x1d9c10,{'base64':![],'checkCRC32':!![]});Object[_0x1b533b(0x370)](_0xff6193['files'])['forEach'](_0x2b321f=>{const _0x1702b8=_0x1b533b,_0x3b9d4a=_0xff6193['files'][_0x2b321f];fs[_0x1702b8(0x26d)](configpath+_0x3b9d4a[_0x1702b8(0x39f)],_0x3b9d4a[_0x1702b8(0x38c)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x1b533b(0x265)](_0x5c5297=>{const _0x1270a3=_0x1b533b;if(!_0x5c5297[_0x1270a3(0x2ef)]())fs[_0x1270a3(0x27a)](temppath+_0x5c5297[_0x1270a3(0x39f)]);}),logger[_0x1b533b(0x3a1)](_0x1b533b(0x2d0)),process[_0x1b533b(0x208)]({'restore':!![]},_0x396a84=>{});}async function getPublicIp(){const _0x52cbc2=_0x2ff023;try{const _0x199b71=await axios[_0x52cbc2(0x356)](_0x52cbc2(0x1fa));publicip=_0x199b71['data']['ip'];}catch(_0x3df19e){}}async function triggerAnalytics(){const _0x128238=_0x2ff023;if(!publicip)await getPublicIp();const _0x3d6bb5=getBotsWithMode();let _0x524c4c=0x0;_0x3d6bb5[_0x128238(0x265)](_0x20ba7c=>{if(_0x20ba7c['status']==='enabled')_0x524c4c++;});const _0x3dd2c8=getBotExchanges();mixpanel['track'](_0x128238(0x2b8),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3d6bb5[_0x128238(0x319)],'numbotsenabled':_0x524c4c,'exchanges':_0x3dd2c8});}async function getMessages(){const _0x2d6d31=_0x2ff023,_0x22afd5='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x37ab27=new GraphQLClient(_0x22afd5),_0x1a074d={'authorization':_0x2d6d31(0x2cc)},_0x5ef2f9=serverversion[_0x2d6d31(0x222)]('.'),_0x5d6f7d=_0x5ef2f9[0x0]+'.'+_0x5ef2f9[0x1],_0x42c3dc=Math[_0x2d6d31(0x1f0)](settings[_0x2d6d31(0x37d)],settings[_0x2d6d31(0x1fe)]),_0x3b1359={'last':parseInt(_0x42c3dc),'bbm':_0x5d6f7d},_0x9a482b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x24d353;try{_0x24d353=await _0x37ab27[_0x2d6d31(0x316)](_0x9a482b,_0x3b1359,_0x1a074d);}catch(_0x50a650){}if(_0x24d353&&_0x24d353['messages']){let _0x4fd540=settings['lastmsgtelegram'];newMessages=[];for(const _0x1475c9 of _0x24d353[_0x2d6d31(0x303)]){newMessages[_0x2d6d31(0x377)](_0x1475c9);if(_0x1475c9[_0x2d6d31(0x395)])updateSetting(_0x2d6d31(0x20a),_0x1475c9[_0x2d6d31(0x395)]);let _0x276025=_0x1475c9['bbvNew']?serverversion>=_0x1475c9[_0x2d6d31(0x395)]:![];if(!_0x276025&&_0x1475c9['number']>_0x4fd540){if(_0x1475c9[_0x2d6d31(0x33d)]===_0x2d6d31(0x20b)||serverversion[_0x2d6d31(0x312)](_0x1475c9[_0x2d6d31(0x33d)])){let _0x21cbf3=''+_0x1475c9[_0x2d6d31(0x37a)]+'\x0a\x0a'+_0x1475c9[_0x2d6d31(0x39d)];const _0x399a8a=await sendTelegramMsg(toTelegramMarkdown(_0x21cbf3),_0x2d6d31(0x2d9));if(_0x399a8a)_0x4fd540=_0x1475c9[_0x2d6d31(0x287)];}}}updateAvailable=isNewerVersion(settings[_0x2d6d31(0x20a)],serverversion),updateSetting('lastmsgtelegram',_0x4fd540),emitMessages();}}function emitMessages(){const _0x13ca87=_0x2ff023,_0x4b2167=settings[_0x13ca87(0x1fe)];let _0x5e2dbd=[];newMessages[_0x13ca87(0x265)](_0xfd8b22=>{const _0x52589a=_0x13ca87;_0xfd8b22[_0x52589a(0x287)]>_0x4b2167&&_0x5e2dbd[_0x52589a(0x377)](_0xfd8b22);}),_0x5e2dbd[_0x13ca87(0x319)]>0x0&&getAllClients()['forEach'](_0x3c2c1a=>{const _0x232623=_0x13ca87;getSocket(_0x3c2c1a['id'])[_0x232623(0x30d)](_0x232623(0x39d),_0x5e2dbd);});}function confirmMessage(_0x4e4629){const _0x17bf47=_0x2ff023;updateSetting(_0x17bf47(0x1fe),Number(_0x4e4629));}function isNewerVersion(_0xcd0d97,_0x2a3d4c){const _0xe0f301=_0x2ff023,_0x1d9323=_0x2a3d4c[_0xe0f301(0x222)]('.'),_0x4b8c4a=_0xcd0d97[_0xe0f301(0x222)]('.');for(var _0xdc0fc9=0x0;_0xdc0fc9<_0x4b8c4a[_0xe0f301(0x319)];_0xdc0fc9++){const _0x3336cb=~~_0x4b8c4a[_0xdc0fc9],_0x1c88b4=~~_0x1d9323[_0xdc0fc9];if(_0x3336cb>_0x1c88b4)return!![];if(_0x3336cb<_0x1c88b4)return![];}return![];}function toTelegramMarkdown(_0x3f2305){const _0x1a665d=_0x2ff023,_0x47e949=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x470d11=/\*{2}(.+?)\*{2}/gim;return _0x3f2305=_0x3f2305[_0x1a665d(0x360)](_0x47e949,'$1_$2_$3')['replace'](_0x470d11,_0x1a665d(0x38a)),_0x3f2305;}async function validateConfigFile(){const _0x3d3238=_0x2ff023,_0xe157ce=dbConfig[_0x3d3238(0x356)](_0x3d3238(0x2b2))[_0x3d3238(0x1f7)]('botID')[_0x3d3238(0x21d)]()||[];if(_0xe157ce['length']==0x0){let _0x255d58=0x0,_0x31699d=[];const _0x3d1806=/^bot-([0-9]{3})-config.json$/,_0x451a09=fs[_0x3d3238(0x32c)](configpath);_0x451a09[_0x3d3238(0x265)](_0xb75cf=>{const _0x53ec02=_0x3d3238,_0x2cbeda=_0x3d1806['exec'](_0xb75cf);if(_0x2cbeda){const _0x2dbd49=_0x2cbeda[0x1];let _0x2810d1=getBotAttributes(_0x2dbd49);_0x31699d['push']({'botID':_0x2dbd49,'botname':_0x2810d1[_0x53ec02(0x3a0)],'status':'disabled','live':_0x53ec02(0x252)}),_0x255d58++;}}),_0x255d58!=0x0&&(dbConfig['get']('bots')[_0x3d3238(0x1d9)](_0x31699d)[_0x3d3238(0x280)](),config=_0x31699d,restoredConfigFile=_0x255d58);}}async function restoreConfigNotify(_0x36b727){const _0x48f54b=_0x2ff023;let _0x50fa05;if(restoredConfigFile==0x1)_0x50fa05=_0x48f54b(0x1f8);else _0x50fa05='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x36b727)io['to'](_0x48f54b(0x2a1))['emit']('notification',_0x50fa05);else{logger[_0x48f54b(0x3a4)](_0x48f54b(0x2a3)),logger[_0x48f54b(0x3a4)](_0x50fa05),logger[_0x48f54b(0x3a4)]('-----------------------------------------------------------------------------------'),logger[_0x48f54b(0x3a4)]('');if(tgBot&&settings[_0x48f54b(0x308)]&&settings['telegramEvents']!=_0x48f54b(0x38b))tgBot[_0x48f54b(0x2a5)](settings[_0x48f54b(0x308)],_0x48f54b(0x1cd)+_0x50fa05)[_0x48f54b(0x223)](_0x59cebd=>{telegramError(_0x59cebd);});}}function validateCredentials(_0x111652,_0x2b4826){const _0x6897d4=_0x2ff023;if(_0x111652[_0x6897d4(0x357)]==settings['bbUsername']&&bcrypt[_0x6897d4(0x355)](_0x111652[_0x6897d4(0x1eb)],settings[_0x6897d4(0x2ad)])){if(settings[_0x6897d4(0x201)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x6ebfa=generateLoginToken(_0x2b4826);return{'allow':!![],'reason':_0x6897d4(0x1cc),'token':_0x6ebfa};}}else return{'allow':![],'reason':_0x6897d4(0x234),'token':null};}function refreshToken(_0x3705a2){const _0x377630=_0x2ff023,_0x4c4675=generateLoginToken(_0x3705a2);return{'allow':!![],'reason':_0x377630(0x1cc),'token':_0x4c4675};}function validateAccess(_0x8a93,_0x591405,_0x2bfa80){const _0xe1a210=_0x2ff023,_0x3333a8=_0x2bfa80?_0x2bfa80:devices[_0x591405]['ip'];let _0xeebd35;const _0x3d2258=_0x296517=>{const _0x34cdf5=_0x17a2;if(settings[_0x34cdf5(0x393)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x591405)){const _0xdaa8d1=generateLoginToken(_0x591405);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0xdaa8d1};}else return{'allow':![],'reason':_0x34cdf5(0x36d),'token':null};}else return _0xeebd35=validToken(_0x296517,_0x591405),_0xeebd35['hasOwnProperty'](_0x34cdf5(0x380))?{'allow':!![],'reason':_0x34cdf5(0x391),'token':_0x296517}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0xe1a210(0x200)]){let _0x4b6d1f=[...settings[_0xe1a210(0x256)],_0xe1a210(0x302),'::ffff:127.0.0.1',_0xe1a210(0x329)];if(_0x4b6d1f['includes'](_0x3333a8))return _0x3d2258(_0x8a93);else{_0xeebd35=validToken(_0x8a93,_0x591405);if(_0xeebd35[_0xe1a210(0x224)]('success'))return _0x3d2258(_0x8a93);else{if(telegramIpApproved(_0x591405)){const _0x6bdcf1=generateToken(_0x591405);return _0xeebd35=_0x3d2258(_0x8a93),_0xeebd35[_0xe1a210(0x250)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x6bdcf1}:_0xeebd35;}else return settings[_0xe1a210(0x304)]?{'allow':![],'reason':_0xe1a210(0x3aa),'token':null}:{'allow':![],'reason':_0xe1a210(0x2e2),'token':null};}}}else return _0x3d2258(_0x8a93);}function timelyDecrypt(_0x5399fb,_0x326f7f=!![]){const _0x4351e3=_0x2ff023;if(_0x5399fb)try{const _0xd040f6=crypt['decrypt'](secure[_0x4351e3(0x2dd)],_0x5399fb)[_0x4351e3(0x39d)],_0x85d5f7=_0xd040f6[_0x4351e3(0x222)]('@')[0x0],_0x13c1e8=_0xd040f6[_0x4351e3(0x222)]('@')[0x1],_0x39c9de=new Date()[_0x4351e3(0x2b6)]();if(_0x326f7f){if(_0x39c9de-_0x13c1e8<maxSecretAge*0x3e8)return _0x85d5f7;else return![];}else return _0x85d5f7;}catch(_0x5bef5a){return![];}else return![];}const validToken=(_0x56c31a,_0x761631)=>{const _0x5bba16=_0x2ff023,_0x547183=devices[_0x761631]['ip'];if(!_0x56c31a)return{'error':'No\x20authentication\x20token'};for(let _0x46b474 of blacklist){if(_0x46b474[_0x5bba16(0x203)]==_0x56c31a)return{'error':_0x5bba16(0x2e6)};}let _0x46bb12;try{_0x46bb12=jwt[_0x5bba16(0x321)](_0x56c31a,secure[_0x5bba16(0x34d)]+_0x761631);}catch{return{'error':_0x5bba16(0x1d1)};}if(!_0x46bb12['hasOwnProperty'](_0x5bba16(0x215))&&!_0x46bb12[_0x5bba16(0x224)](_0x5bba16(0x357))||!_0x46bb12[_0x5bba16(0x224)](_0x5bba16(0x2c5)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x46bb12[_0x5bba16(0x224)]('username')&&_0x46bb12['hasOwnProperty'](_0x5bba16(0x215))){const {clientip:_0x4838bf}=_0x46bb12;return _0x547183==_0x4838bf?{'success':_0x5bba16(0x1d7)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x46bb12['hasOwnProperty'](_0x5bba16(0x357))&&_0x46bb12[_0x5bba16(0x224)](_0x5bba16(0x215))){const {username:_0x27f5d7,clientip:_0x2e3f49}=_0x46bb12;return settings[_0x5bba16(0x22d)]==_0x27f5d7&&_0x547183==_0x2e3f49?{'success':_0x5bba16(0x1d7)}:{'error':_0x5bba16(0x202)};}}},generateLoginToken=_0x2838a9=>{const _0x5b0c79=_0x2ff023;if(_0x2838a9){const _0x3ed75a=devices[_0x2838a9]['ip'];return jwt[_0x5b0c79(0x26b)]({'username':settings[_0x5b0c79(0x22d)],'clientip':_0x3ed75a},secure['secret']+_0x2838a9,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xb1d3d8=>{const _0x7718db=_0x2ff023;if(_0xb1d3d8){const _0x14e001=devices[_0xb1d3d8]['ip'];return jwt['sign']({'clientip':_0x14e001},secure['secret']+_0xb1d3d8,{'expiresIn':devices[_0xb1d3d8][_0x7718db(0x33b)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x434ac2=>{const _0x38c095=_0x2ff023;let _0xa037f3=![];return devices[_0x434ac2][_0x38c095(0x33b)]&&devices[_0x434ac2][_0x38c095(0x33b)][_0x38c095(0x3a9)]!=_0x38c095(0x320)&&(_0xa037f3=devices[_0x434ac2][_0x38c095(0x33b)]['clientip']==devices[_0x434ac2]['ip']&&new Date()[_0x38c095(0x2b6)]()-devices[_0x434ac2][_0x38c095(0x33b)]['timestamp']<devices[_0x434ac2][_0x38c095(0x33b)][_0x38c095(0x3a9)]*0x3c*0x3e8),_0xa037f3;},telegram2FaApproved=_0x122c3e=>{const _0x21fbe3=_0x2ff023;let _0xb28f4b=![];return devices[_0x122c3e]['telegram2FaApproval']&&devices[_0x122c3e][_0x21fbe3(0x38f)][_0x21fbe3(0x3a9)]!='reject'&&(_0xb28f4b=devices[_0x122c3e][_0x21fbe3(0x38f)][_0x21fbe3(0x215)]==devices[_0x122c3e]['ip']&&new Date()[_0x21fbe3(0x2b6)]()-devices[_0x122c3e][_0x21fbe3(0x38f)]['timestamp']<devices[_0x122c3e]['telegram2FaApproval'][_0x21fbe3(0x3a9)]*0x3c*0x3e8),_0xb28f4b;},normalizeIP=_0x1164f2=>{const _0x399e0a=_0x2ff023;let _0x5bb91a=null,_0x1897c1=null;if(ipaddr[_0x399e0a(0x1e7)](_0x1164f2)){const _0x138ef1=ipaddr[_0x399e0a(0x2ac)](_0x1164f2);_0x138ef1['kind']()===_0x399e0a(0x229)?(_0x138ef1[_0x399e0a(0x240)]()&&(_0x5bb91a=_0x138ef1[_0x399e0a(0x226)]()[_0x399e0a(0x1d4)]()),_0x1897c1=_0x138ef1[_0x399e0a(0x1d4)]()):(_0x5bb91a=_0x138ef1[_0x399e0a(0x1d4)](),_0x1897c1=_0x138ef1[_0x399e0a(0x2c1)]()[_0x399e0a(0x1d4)]());}return{'show':_0x5bb91a?_0x5bb91a:_0x1897c1,'store':_0x1897c1};};function formatDate(_0x279c4d){const _0x289efc=_0x2ff023;return _0x279c4d['getFullYear']()+'/'+(_0x279c4d[_0x289efc(0x32e)]()+0x1)[_0x289efc(0x1d4)]()[_0x289efc(0x3a7)](0x2,'0')+'/'+_0x279c4d[_0x289efc(0x28f)]()[_0x289efc(0x1d4)]()[_0x289efc(0x3a7)](0x2,'0')+'\x20'+_0x279c4d['getHours']()[_0x289efc(0x1d4)]()['padStart'](0x2,'0')+':'+_0x279c4d[_0x289efc(0x2e5)]()[_0x289efc(0x1d4)]()[_0x289efc(0x3a7)](0x2,'0')+':'+_0x279c4d['getSeconds']()[_0x289efc(0x1d4)]()['padStart'](0x2,'0');}function sleep(_0x11bea9){return new Promise(_0x4489fb=>setTimeout(_0x4489fb,_0x11bea9));}