const _0x2f8d3d=_0x3893;(function(_0x26f476,_0x208165){const _0x451b66=_0x3893,_0x1e1c3e=_0x26f476();while(!![]){try{const _0x1afbec=-parseInt(_0x451b66(0x1d9))/0x1+parseInt(_0x451b66(0x123))/0x2*(-parseInt(_0x451b66(0x211))/0x3)+-parseInt(_0x451b66(0x143))/0x4+parseInt(_0x451b66(0x1c3))/0x5+parseInt(_0x451b66(0x1bd))/0x6*(parseInt(_0x451b66(0x1f9))/0x7)+-parseInt(_0x451b66(0x185))/0x8*(-parseInt(_0x451b66(0x1e0))/0x9)+parseInt(_0x451b66(0x159))/0xa;if(_0x1afbec===_0x208165)break;else _0x1e1c3e['push'](_0x1e1c3e['shift']());}catch(_0x5bfca0){_0x1e1c3e['push'](_0x1e1c3e['shift']());}}}(_0x128a,0x34ceb));const _0x5725b0=function(){let _0x5a1039=!![];return function(_0x54bf99,_0x4df84c){const _0x5aeafd=_0x5a1039?function(){const _0x1650cd=_0x3893;if(_0x4df84c){const _0x190aff=_0x4df84c[_0x1650cd(0x111)](_0x54bf99,arguments);return _0x4df84c=null,_0x190aff;}}:function(){};return _0x5a1039=![],_0x5aeafd;};}(),_0x5f0844=_0x5725b0(this,function(){const _0xb89243=_0x3893;return _0x5f0844['toString']()[_0xb89243(0x27b)](_0xb89243(0x23f))[_0xb89243(0x2a1)]()['constructor'](_0x5f0844)['search'](_0xb89243(0x23f));});_0x5f0844();'use strict';process[_0x2f8d3d(0x154)][_0x2f8d3d(0x221)]=0x1;const childProcess=require(_0x2f8d3d(0x193)),fs=require('fs'),fns=require(_0x2f8d3d(0x18d)),low=require(_0x2f8d3d(0x258)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x2f8d3d(0x29d)),Crypt=require(_0x2f8d3d(0x194))[_0x2f8d3d(0x15e)],RSA=require('hybrid-crypto-js')[_0x2f8d3d(0x28a)],bcrypt=require(_0x2f8d3d(0x168)),jwt=require(_0x2f8d3d(0x1cb)),ipaddr=require(_0x2f8d3d(0x1bb)),argv=require(_0x2f8d3d(0x1e5))(process[_0x2f8d3d(0x231)][_0x2f8d3d(0x188)](0x2))[_0x2f8d3d(0x231)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x2f8d3d(0x1b4)),Mixpanel=require(_0x2f8d3d(0x282)),axios=require(_0x2f8d3d(0x175)),{GraphQLClient,gql}=require(_0x2f8d3d(0x28c)),util=require(_0x2f8d3d(0x11b)),fileUpload=require(_0x2f8d3d(0x1ae)),PORT=argv['port']||_0x2f8d3d(0x17b),pattern=/^[0-9]{2,4}$/;!pattern[_0x2f8d3d(0x275)](PORT)&&(console[_0x2f8d3d(0x290)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x2f8d3d(0x187)),process[_0x2f8d3d(0x1b1)](0x1));const HOST=argv[_0x2f8d3d(0x13e)]||null,userID=argv[_0x2f8d3d(0x23a)]||'';let bbpath='bb/',bbpath2='';const botfile=_0x2f8d3d(0x136),configfile=_0x2f8d3d(0x160),settingsfile=_0x2f8d3d(0x263),securefile='bb-secure.json';let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2f8d3d(0x1a0)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x2f8d3d(0x191),configbackuppath=configpath+_0x2f8d3d(0x27d),logspath=userID?bbpath+_0x2f8d3d(0x182)+userID+'/':bbpath+_0x2f8d3d(0x182),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x2f8d3d(0x148),loggerfile=fs[_0x2f8d3d(0x1c1)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x2f8d3d(0x2a6)+userID+'/':bbpath+_0x2f8d3d(0x2a6);!fs[_0x2f8d3d(0x166)](configpath)&&fs[_0x2f8d3d(0x186)](configpath);!fs[_0x2f8d3d(0x166)](configbackuppath)&&fs[_0x2f8d3d(0x186)](configbackuppath);!fs[_0x2f8d3d(0x166)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x2f8d3d(0x166)](zippath)&&fs[_0x2f8d3d(0x186)](zippath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2f8d3d(0x15c)]({'bots':[]})[_0x2f8d3d(0x1d7)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2f8d3d(0x15c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2f8d3d(0x1d0)}})[_0x2f8d3d(0x1d7)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x2f8d3d(0x1d7)]();let crypt=new Crypt({'md':_0x2f8d3d(0x260),'rsaStandard':_0x2f8d3d(0x1b6)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2f8d3d(0x12b)](_0x2f8d3d(0x147),{'host':_0x2f8d3d(0x18f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2f8d3d(0x12e)]&&settings[_0x2f8d3d(0x12e)]!=''&&settings['telegramUsername']&&settings[_0x2f8d3d(0x206)]!='')initTelegram();const logger={'screen':_0x1b93ef=>{console['log'](_0x1b93ef);},'simple':_0x48608b=>{const _0x2f72d9=_0x2f8d3d;console[_0x2f72d9(0x290)](_0x48608b),loggerfile[_0x2f72d9(0x1d7)](util[_0x2f72d9(0x179)](_0x48608b)+'\x0a');},'full':async _0x15bfae=>{const _0x5e16e9=_0x2f8d3d,_0x17dfb3=getTimeStamp()+_0x5e16e9(0x1e3)+_0x15bfae;console[_0x5e16e9(0x290)](_0x17dfb3),loggerfile[_0x5e16e9(0x1d7)](util[_0x5e16e9(0x179)](_0x17dfb3)+'\x0a');if(tgBot&&settings[_0x5e16e9(0x269)]&&settings[_0x5e16e9(0x287)]!=_0x5e16e9(0x1fe))await tgBot[_0x5e16e9(0x165)](settings[_0x5e16e9(0x269)],_0x5e16e9(0x14a)+_0x15bfae)[_0x5e16e9(0x13a)](_0x276bc2=>{telegramError(_0x276bc2);});}};process['on'](_0x2f8d3d(0x1d2),function(_0x453c27){logger['simple'](_0x453c27);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x2f8d3d(0x28f)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2f8d3d(0x16f)),app=express(),http=require(_0x2f8d3d(0x224))[_0x2f8d3d(0x1f5)](app);app[_0x2f8d3d(0x234)](fileUpload({'useTempFiles':!![]})),app['get'](_0x2f8d3d(0x280),async(_0x426592,_0x148acb)=>{const _0x49ea2f=_0x2f8d3d,_0x8683ec=_0x426592[_0x49ea2f(0x285)][_0x49ea2f(0x20e)],_0x34b42d=getClientsWithBotID(_0x49ea2f(0x137)),_0x374b6c=_0x426592['headers']['uuid'],_0x29ab70=timelyDecrypt(_0x374b6c,![]),_0x1340a6=_0x34b42d[_0x49ea2f(0x272)](_0x3b6b78=>_0x3b6b78[_0x49ea2f(0x261)]==_0x29ab70);if(_0x1340a6){const _0x1b0bd1=normalizeIP(_0x426592[_0x49ea2f(0x1df)][_0x49ea2f(0x15d)])[_0x49ea2f(0x2af)],_0x9f987c=_0x426592['headers']['tkn'];if(validateAccess(_0x9f987c,_0x29ab70,_0x1b0bd1)[_0x49ea2f(0x1a7)])await zipFiles(_0x8683ec),_0x148acb[_0x49ea2f(0x2a7)](zippath+(_0x8683ec+_0x49ea2f(0x152)),_0x1face6=>{const _0x1d299b=_0x49ea2f;_0x1face6&&(logger['full'](_0x1d299b(0x18b)+_0x8683ec),logger[_0x1d299b(0x293)](_0x1face6));});else logger[_0x49ea2f(0x250)](_0x49ea2f(0x23b)+_0x8683ec+_0x49ea2f(0x226));}else logger[_0x49ea2f(0x250)](_0x49ea2f(0x23b)+_0x8683ec+_0x49ea2f(0x202));}),app[_0x2f8d3d(0x16c)](_0x2f8d3d(0x1ba),async(_0x36d91c,_0x4c71ee)=>{const _0x3dc20a=_0x2f8d3d,_0x5a94ea=getClientsWithBotID(_0x3dc20a(0x137)),_0xc9de1=_0x36d91c[_0x3dc20a(0x1e6)][_0x3dc20a(0x261)],_0x16aed8=timelyDecrypt(_0xc9de1,![]),_0x1abc37=_0x5a94ea[_0x3dc20a(0x272)](_0x3e51d5=>_0x3e51d5[_0x3dc20a(0x261)]==_0x16aed8);if(_0x1abc37){const _0x3ddade=normalizeIP(_0x36d91c[_0x3dc20a(0x1df)][_0x3dc20a(0x15d)])[_0x3dc20a(0x2af)],_0x1697d1=_0x36d91c[_0x3dc20a(0x1e6)]['tkn'];if(validateAccess(_0x1697d1,_0x16aed8,_0x3ddade)[_0x3dc20a(0x1a7)])try{if(!_0x36d91c[_0x3dc20a(0x140)])_0x4c71ee[_0x3dc20a(0x157)]({'status':![],'message':_0x3dc20a(0x139)});else{_0x4c71ee['send']({'status':!![],'message':_0x3dc20a(0x19b)});const _0x46c14f=_0x36d91c[_0x3dc20a(0x140)][_0x3dc20a(0x274)];await _0x46c14f['mv'](temppath+_0x46c14f['name']),confirmRestore(temppath,_0x46c14f['name']);}}catch(_0x3ad777){_0x4c71ee[_0x3dc20a(0x218)](0x1f4)[_0x3dc20a(0x157)](_0x3ad777);}else logger[_0x3dc20a(0x250)](_0x3dc20a(0x118));}else logger[_0x3dc20a(0x250)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x2f8d3d(0x234)](express['static'](path['join'](__dirname,bbpath2,_0x2f8d3d(0x1e4)))),app[_0x2f8d3d(0x234)](express[_0x2f8d3d(0x230)](path[_0x2f8d3d(0x19c)](__dirname,bbpath2,_0x2f8d3d(0x299)))),app[_0x2f8d3d(0x22e)]('/',function(_0x4a711a,_0x1f59c3){const _0x478e9d=_0x2f8d3d;_0x1f59c3[_0x478e9d(0x2aa)](path[_0x478e9d(0x19c)](__dirname,bbpath2,'build2',_0x478e9d(0x26a)));}),app[_0x2f8d3d(0x22e)](_0x2f8d3d(0x134),function(_0x3761d6,_0x592021){const _0x4c9057=_0x2f8d3d;_0x592021[_0x4c9057(0x2aa)](path[_0x4c9057(0x19c)](__dirname,bbpath2,_0x4c9057(0x299),_0x4c9057(0x26a)));}),app[_0x2f8d3d(0x22e)]('/:bot/portfolio',(_0x20d85b,_0x3f47b7)=>{const _0x268900=_0x2f8d3d;_0x3f47b7['sendFile'](path[_0x268900(0x19c)](__dirname,bbpath2,_0x268900(0x299),'index.html'));}),app[_0x2f8d3d(0x22e)]('/:bot/performance',(_0x4286d2,_0x47c30f)=>{const _0x4212a2=_0x2f8d3d;_0x47c30f[_0x4212a2(0x2aa)](path[_0x4212a2(0x19c)](__dirname,bbpath2,_0x4212a2(0x299),'index.html'));}),app[_0x2f8d3d(0x22e)](_0x2f8d3d(0x242),(_0x54b86a,_0x443eb5)=>{const _0x55b09b=_0x2f8d3d;_0x443eb5[_0x55b09b(0x2aa)](path[_0x55b09b(0x19c)](__dirname,bbpath2,_0x55b09b(0x299),_0x55b09b(0x26a)));}),app[_0x2f8d3d(0x22e)]('/:bot/history',(_0x4670ed,_0x41e0cc)=>{const _0x5b0010=_0x2f8d3d;_0x41e0cc[_0x5b0010(0x2aa)](path['join'](__dirname,bbpath2,_0x5b0010(0x299),'index.html'));}),app[_0x2f8d3d(0x22e)](_0x2f8d3d(0x12f),(_0x3088e6,_0x9ce412)=>{const _0x1840ae=_0x2f8d3d;_0x9ce412[_0x1840ae(0x2aa)](path[_0x1840ae(0x19c)](__dirname,bbpath2,_0x1840ae(0x299),'index.html'));}),app[_0x2f8d3d(0x22e)](_0x2f8d3d(0x12d),(_0x4ead55,_0x114ce9)=>{_0x114ce9['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x2f8d3d(0x196)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0xca1692=_0x2f8d3d;logger[_0xca1692(0x293)](''),logger['simple'](_0xca1692(0x219)),await logger[_0xca1692(0x250)](_0xca1692(0x1ea)+PORT),logger['simple'](_0xca1692(0x219));if(config[_0xca1692(0x25c)]!=0x0)for(const _0x27a622 of config){if(_0x27a622[_0xca1692(0x218)]==_0xca1692(0x1c0)||_0x27a622[_0xca1692(0x218)]=='new')await logger['full'](_0xca1692(0x1db)+_0x27a622[_0xca1692(0x138)]+_0xca1692(0x2a0)+_0x27a622[_0xca1692(0x1c4)]),startBot([_0x27a622[_0xca1692(0x138)],userID],{'cwd':bbpath},function(_0x18e5c4){const _0x55c0dc=_0xca1692;if(_0x18e5c4)logger[_0x55c0dc(0x250)](_0x18e5c4);});else(_0x27a622[_0xca1692(0x218)]==_0xca1692(0x1c5)||_0x27a622['status']==_0xca1692(0x200))&&await logger[_0xca1692(0x250)](_0xca1692(0x17c)+_0x27a622[_0xca1692(0x138)]+_0xca1692(0x2a0)+_0x27a622[_0xca1692(0x1c4)]);}else!newBot&&logger[_0xca1692(0x293)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger['simple']('');}function startSocket(){const _0x18dce6=_0x2f8d3d;io['on'](_0x18dce6(0x158),_0x463aca=>{const _0x4cfb0b=_0x18dce6;let _0x3e6d12,_0x24e13d,_0xc7fa8,_0x403118,_0x3dface;const _0xcb748c=_0x463aca[_0x4cfb0b(0x22f)][_0x4cfb0b(0x1e6)][_0x4cfb0b(0x2ad)];_0x24e13d=_0xcb748c[_0x4cfb0b(0x228)](/bot[0-9]{3}/);if(_0x24e13d)_0xc7fa8=_0x24e13d[0x0][_0x4cfb0b(0x228)](/[0-9]{3}/);if(_0xc7fa8)_0x3e6d12=_0xc7fa8[0x0];else _0x3e6d12=_0x4cfb0b(0x137);const _0x404d02=_0x463aca[_0x4cfb0b(0x22f)][_0x4cfb0b(0x236)]['encryptedUuid'];if(!_0x404d02)_0x463aca[_0x4cfb0b(0x210)](_0x4cfb0b(0x218),{'publicKey':secure[_0x4cfb0b(0x1dd)]});else{_0x403118=timelyDecrypt(_0x404d02,![]);if(!_0x403118)_0x463aca[_0x4cfb0b(0x210)](_0x4cfb0b(0x218),{'publicKey':secure[_0x4cfb0b(0x1dd)]});else{_0x3dface=normalizeIP(_0x463aca['conn'][_0x4cfb0b(0x15d)])[_0x4cfb0b(0x2af)];if(!devices[_0x403118])devices[_0x403118]={'uuid':_0x403118,'access':{'token':null}};devices[_0x403118]['ip']=_0x3dface;const _0x3d9a59=addClient(_0x463aca['id'],_0x403118,_0x3e6d12);setAccess(_0x3d9a59),emitMessages(),_0x463aca['on'](_0x4cfb0b(0x149),_0x214c8f=>{const _0x118216=_0x4cfb0b,_0x2d7fbd=timelyDecrypt(_0x214c8f[_0x118216(0x1a2)]);if(_0x2d7fbd){_0x214c8f={'username':_0x214c8f[_0x118216(0x21a)],'password':_0x2d7fbd},devices[_0x403118][_0x118216(0x17e)]=validateCredentials(_0x214c8f,_0x403118);if(devices[_0x403118][_0x118216(0x17e)][_0x118216(0x1a7)]==![]&&devices[_0x403118][_0x118216(0x17e)][_0x118216(0x1fc)]=='2FA\x20login\x20required')_0x463aca['emit'](_0x118216(0x218),{'access':devices[_0x403118][_0x118216(0x17e)]}),loginAccess2FA(_0x403118,_0x3dface);else{if(devices[_0x403118]['access'][_0x118216(0x1a7)]==![]&&devices[_0x403118][_0x118216(0x17e)][_0x118216(0x1fc)]==_0x118216(0x259))_0x463aca['emit'](_0x118216(0x218),{'access':devices[_0x403118][_0x118216(0x17e)]});else devices[_0x403118]['access'][_0x118216(0x1a7)]&&devices[_0x403118][_0x118216(0x17e)][_0x118216(0x1fc)]==_0x118216(0x1ac)&&(getClientsWithUuid(_0x403118)[_0x118216(0x24c)](_0x13ce4c=>{setAccess(_0x13ce4c);}),setTokenRefresh(_0x403118),setSessionTimeout(_0x118216(0x149),_0x403118));}}else logger[_0x118216(0x250)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x463aca['on'](_0x4cfb0b(0x215),()=>{resetPassword();}),_0x463aca['on'](_0x4cfb0b(0x237),_0x47580e=>{removeClient(_0x463aca['id']);}),_0x3e6d12==_0x4cfb0b(0x137)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xbf0ea8){const _0x20a0b5=_0x2f8d3d;if(_0xbf0ea8!=_0x20a0b5(0x137)&&config[_0x20a0b5(0x1eb)]!=''){if(pid[_0xbf0ea8])pid[_0xbf0ea8][_0x20a0b5(0x157)]({'function':_0x20a0b5(0x281),'args':null});}}function reloadBotManager(){const _0x2b5cc1=_0x2f8d3d;getClientsWithBotID(_0x2b5cc1(0x137))[_0x2b5cc1(0x24c)](_0x29c26f=>{const _0x3b869a=_0x2b5cc1;getSocket(_0x29c26f['id'])['emit'](_0x3b869a(0x218),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x17b8ab){const _0x3352bd=_0x2f8d3d;return io[_0x3352bd(0x150)][_0x3352bd(0x150)][_0x3352bd(0x22e)](_0x17b8ab);}function setAccess(_0x315309){const _0x5374f9=_0x2f8d3d,_0x4bdda2=getSocket(_0x315309['id']),_0x486c88=_0x315309[_0x5374f9(0x261)],_0x1f1135=_0x315309[_0x5374f9(0x233)];devices[_0x486c88]['access']=validateAccess(devices[_0x486c88][_0x5374f9(0x17e)]['token'],_0x486c88),_0x4bdda2[_0x5374f9(0x19c)](_0x486c88);if(devices[_0x486c88][_0x5374f9(0x17e)][_0x5374f9(0x1a7)]){_0x4bdda2[_0x5374f9(0x19c)](_0x1f1135);if(_0x1f1135==_0x5374f9(0x137))initializeSocketBotManager(_0x4bdda2);else initializeSocketBot(_0x4bdda2);initClient(_0x1f1135);}devices[_0x486c88][_0x5374f9(0x17e)][_0x5374f9(0x178)]&&devices[_0x486c88][_0x5374f9(0x17e)][_0x5374f9(0x1fc)]==_0x5374f9(0x23d)&&setSessionTimeout('2FA',_0x486c88),devices[_0x486c88][_0x5374f9(0x17e)][_0x5374f9(0x178)]&&devices[_0x486c88]['access'][_0x5374f9(0x1fc)]==_0x5374f9(0x126)&&setSessionTimeout(_0x5374f9(0x149),_0x486c88),_0x4bdda2['emit'](_0x5374f9(0x218),{'status':_0x315309[_0x5374f9(0x267)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x486c88][_0x5374f9(0x17e)],'externalip':devices[_0x486c88]['ip'],'publicKey':secure[_0x5374f9(0x1dd)],'userid':settings[_0x5374f9(0x1a4)],'validInstallation':validInstallation}),devices[_0x486c88][_0x5374f9(0x17e)][_0x5374f9(0x1a7)]==![]&&devices[_0x486c88][_0x5374f9(0x17e)][_0x5374f9(0x1fc)]==_0x5374f9(0x1bc)&&temporaryAccess2FA(_0x486c88,devices[_0x486c88]['ip']);}function setSessionTimeout(_0x3450d6,_0x1d4550){const _0x389073=_0x2f8d3d;let _0x1d00ae;if(_0x3450d6==_0x389073(0x149))_0x1d00ae=loginExpiry*0x3c*0x3e8;else _0x1d00ae=devices[_0x1d4550][_0x389073(0x172)][_0x389073(0x1b3)]*0x3c*0x3e8-(new Date()[_0x389073(0x1da)]()-devices[_0x1d4550][_0x389073(0x172)][_0x389073(0x251)]);if(devices[_0x1d4550][_0x389073(0x26b)])clearTimeout(devices[_0x1d4550][_0x389073(0x26b)]);devices[_0x1d4550]['pidExpireLogin']=setTimeout(()=>{const _0x27557f=_0x389073;if(devices[_0x1d4550][_0x27557f(0x247)])clearTimeout(devices[_0x1d4550]['pidRefreshToken']);removeSocketListeners(_0x1d4550),addBlacklist(_0x1d4550),devices[_0x1d4550][_0x27557f(0x172)]=null,devices[_0x1d4550][_0x27557f(0x1cc)]=null,devices[_0x1d4550][_0x27557f(0x17e)][_0x27557f(0x178)]=null,devices[_0x1d4550][_0x27557f(0x17e)]=validateAccess(devices[_0x1d4550][_0x27557f(0x17e)][_0x27557f(0x178)],_0x1d4550),!(devices[_0x1d4550][_0x27557f(0x17e)][_0x27557f(0x1a7)]&&devices[_0x1d4550]['access'][_0x27557f(0x1fc)]==_0x27557f(0x27f))&&(_0x3450d6==_0x27557f(0x149)?io['to'](_0x1d4550)['emit'](_0x27557f(0x218),{'access':{'allow':![],'reason':_0x27557f(0x1e9),'token':null}}):io['to'](_0x1d4550)[_0x27557f(0x210)](_0x27557f(0x218),{'access':{'allow':![],'reason':_0x27557f(0x296),'token':null}})),devices[_0x1d4550][_0x27557f(0x17e)]['token']=null;},_0x1d00ae);}function setTokenRefresh(_0x2bb42f){const _0x47a238=_0x2f8d3d;if(devices[_0x2bb42f][_0x47a238(0x247)])clearTimeout(devices[_0x2bb42f][_0x47a238(0x247)]);devices[_0x2bb42f][_0x47a238(0x247)]=setTimeout(()=>{const _0x273b3f=_0x47a238;getClientsWithUuid(_0x2bb42f)[_0x273b3f(0x25c)]!=0x0?(devices[_0x2bb42f][_0x273b3f(0x17e)]=refreshToken(_0x2bb42f),io['to'](_0x2bb42f)['emit'](_0x273b3f(0x218),{'status':_0x273b3f(0x24a),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2bb42f][_0x273b3f(0x17e)],'externalip':devices[_0x2bb42f]['ip'],'publicKey':secure[_0x273b3f(0x1dd)],'validInstallation':validInstallation}),setTokenRefresh(_0x2bb42f)):clearTimeout(devices[_0x2bb42f][_0x273b3f(0x247)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x38ef6c){const _0x4ed433=_0x2f8d3d,_0x5f4ef6=getClient(_0x38ef6c['id'])['uuid'];_0x38ef6c[_0x4ed433(0x210)](_0x4ed433(0x1f7),config),_0x38ef6c[_0x4ed433(0x210)](_0x4ed433(0x13f),cleanSettings()),_0x38ef6c['on'](_0x4ed433(0x12c),_0x5dc5de=>{const _0x13fc92=_0x4ed433;if(validateAccess(_0x5dc5de,_0x5f4ef6)[_0x13fc92(0x1a7)])addBot();else logger['full'](_0x13fc92(0x223));}),_0x38ef6c['on'](_0x4ed433(0x151),(_0xf7e8c9,_0xbadfb6)=>{const _0x3af356=_0x4ed433;if(validateAccess(_0xbadfb6,_0x5f4ef6)['allow'])toggleBot(_0xf7e8c9[_0x3af356(0x138)],_0xf7e8c9[_0x3af356(0x218)],_0xf7e8c9['live']);else logger[_0x3af356(0x250)](_0x3af356(0x1a6));}),_0x38ef6c['on'](_0x4ed433(0x1ec),(_0x453b5c,_0x275016)=>{const _0x2fa027=_0x4ed433;if(validateAccess(_0x275016,_0x5f4ef6)[_0x2fa027(0x1a7)])toggleBotMode(_0x453b5c);else logger[_0x2fa027(0x250)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x38ef6c['on'](_0x4ed433(0x190),(_0x1e0ab8,_0x3e6a90)=>{const _0x540de6=_0x4ed433;if(validateAccess(_0x3e6a90,_0x5f4ef6)[_0x540de6(0x1a7)])deleteBot(_0x1e0ab8);else logger[_0x540de6(0x250)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x38ef6c['on'](_0x4ed433(0x212),(_0x2b48d8,_0x2feb1c)=>{const _0x5b7db7=_0x4ed433;if(validateAccess(_0x2feb1c,_0x5f4ef6)[_0x5b7db7(0x1a7)])storeSettings(_0x2b48d8,!![]);else logger['full'](_0x5b7db7(0x222));}),_0x38ef6c['on'](_0x4ed433(0x24f),_0x4331f0=>{const _0x3aa20c=_0x4ed433;if(validateAccess(_0x4331f0,_0x5f4ef6)[_0x3aa20c(0x1a7)])updateBB();else logger[_0x3aa20c(0x250)](_0x3aa20c(0x156));}),_0x38ef6c['on'](_0x4ed433(0x1ee),_0x2a1b4d=>{const _0x53d061=_0x4ed433;if(validateAccess(_0x2a1b4d,_0x5f4ef6)[_0x53d061(0x1a7)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x38ef6c['on'](_0x4ed433(0x167),(_0x288e7b,_0xadc66)=>{const _0x3ea442=_0x4ed433;if(validateAccess(_0xadc66,_0x5f4ef6)[_0x3ea442(0x1a7)])confirmMessage(_0x288e7b);else logger[_0x3ea442(0x250)](_0x3ea442(0x1b2));}),_0x38ef6c['on']('logout',_0x43433d=>{const _0x2fe56e=_0x4ed433;if(validateAccess(_0x43433d,_0x5f4ef6)[_0x2fe56e(0x1a7)]){if(devices[_0x5f4ef6]['pidRefreshToken'])clearTimeout(devices[_0x5f4ef6]['pidRefreshToken']);if(devices[_0x5f4ef6][_0x2fe56e(0x26b)])clearTimeout(devices[_0x5f4ef6]['pidExpireLogin']);removeSocketListeners(getClient(_0x38ef6c['id'])[_0x2fe56e(0x261)]),addBlacklist(_0x5f4ef6),devices[_0x5f4ef6]['telegramIpApproval']=null,devices[_0x5f4ef6][_0x2fe56e(0x1cc)]=null,devices[_0x5f4ef6][_0x2fe56e(0x17e)][_0x2fe56e(0x178)]=null,io['to'](getClient(_0x38ef6c['id'])[_0x2fe56e(0x261)])[_0x2fe56e(0x210)](_0x2fe56e(0x218),{'access':{'allow':![],'reason':_0x2fe56e(0x23c),'token':null}});}else logger[_0x2fe56e(0x250)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x26eeb6){const _0x2e0949=_0x2f8d3d,_0x4871df=getClient(_0x26eeb6['id'])['bot'],_0x191d04=getClient(_0x26eeb6['id'])[_0x2e0949(0x261)];_0x26eeb6['on'](_0x2e0949(0x27a),(_0x4cdc1b,_0x339483)=>{const _0x281812=_0x2e0949;if(validateAccess(_0x339483,_0x191d04)[_0x281812(0x1a7)]){if(pid[_0x4871df])pid[_0x4871df]['send']({'function':_0x281812(0x26d),'args':_0x4cdc1b});}else logger[_0x281812(0x250)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x26eeb6['on'](_0x2e0949(0x1af),(_0x27b495,_0xf7bdae)=>{const _0x26329f=_0x2e0949;if(validateAccess(_0xf7bdae,_0x191d04)[_0x26329f(0x1a7)]){if(pid[_0x4871df])pid[_0x4871df][_0x26329f(0x157)]({'function':_0x26329f(0x16b),'args':_0x27b495});}else logger[_0x26329f(0x250)](_0x26329f(0x286));}),_0x26eeb6['on'](_0x2e0949(0x255),(_0x153095,_0x118dc3)=>{const _0x165b9f=_0x2e0949;if(validateAccess(_0x118dc3,_0x191d04)[_0x165b9f(0x1a7)]){if(pid[_0x4871df])pid[_0x4871df][_0x165b9f(0x157)]({'function':'getPortfolio','args':_0x153095});}else logger[_0x165b9f(0x250)](_0x165b9f(0x11c));}),_0x26eeb6['on'](_0x2e0949(0x208),(_0x35a67c,_0x976ab1)=>{const _0x172f09=_0x2e0949;if(validateAccess(_0x976ab1,_0x191d04)[_0x172f09(0x1a7)]){if(pid[_0x4871df])pid[_0x4871df]['send']({'function':_0x172f09(0x235),'args':_0x35a67c});}else logger[_0x172f09(0x250)](_0x172f09(0x265));}),_0x26eeb6['on'](_0x2e0949(0x117),(_0x5185de,_0x147a07)=>{const _0x409abc=_0x2e0949;if(validateAccess(_0x147a07,_0x191d04)['allow']){if(pid[_0x4871df])pid[_0x4871df][_0x409abc(0x157)]({'function':_0x409abc(0x29c),'args':_0x5185de});}else logger[_0x409abc(0x250)](_0x409abc(0x161));}),_0x26eeb6['on'](_0x2e0949(0x170),_0x572dcd=>{const _0x3e882e=_0x2e0949;if(validateAccess(_0x572dcd,_0x191d04)['allow']){if(pid[_0x4871df])pid[_0x4871df][_0x3e882e(0x157)]({'function':_0x3e882e(0x113),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x26eeb6['on']('place-order',(_0x42ea37,_0x1f2cae)=>{const _0x3a2fa2=_0x2e0949;if(validateAccess(_0x1f2cae,_0x191d04)['allow']){if(pid[_0x4871df])pid[_0x4871df][_0x3a2fa2(0x157)]({'function':_0x3a2fa2(0x1f8),'args':_0x42ea37});}else logger[_0x3a2fa2(0x250)](_0x3a2fa2(0x2a3));}),_0x26eeb6['on'](_0x2e0949(0x1c9),_0x22264c=>{const _0x22c645=_0x2e0949;if(validateAccess(_0x22264c,_0x191d04)[_0x22c645(0x1a7)]){if(pid[_0x4871df])pid[_0x4871df][_0x22c645(0x157)]({'function':_0x22c645(0x1d3),'args':null});}else logger[_0x22c645(0x250)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x26eeb6['on'](_0x2e0949(0x24f),_0x3fed7b=>{const _0x41e855=_0x2e0949;if(validateAccess(_0x3fed7b,_0x191d04)[_0x41e855(0x1a7)])updateBB();else logger[_0x41e855(0x250)](_0x41e855(0x156));}),_0x26eeb6['on']('get-messages',_0x50e891=>{const _0x23b34e=_0x2e0949;if(validateAccess(_0x50e891,_0x191d04)[_0x23b34e(0x1a7)])getMessages();else logger[_0x23b34e(0x250)](_0x23b34e(0x17a));}),_0x26eeb6['on'](_0x2e0949(0x167),(_0x459617,_0x14b086)=>{const _0x5f08a7=_0x2e0949;if(validateAccess(_0x14b086,_0x191d04)[_0x5f08a7(0x1a7)])confirmMessage(_0x459617);else logger['full'](_0x5f08a7(0x1b2));}),_0x26eeb6['on']('logout',_0x108350=>{const _0x5839e3=_0x2e0949;if(validateAccess(_0x108350,_0x191d04)[_0x5839e3(0x1a7)]){if(devices[_0x191d04][_0x5839e3(0x247)])clearTimeout(devices[_0x191d04]['pidRefreshToken']);if(devices[_0x191d04][_0x5839e3(0x26b)])clearTimeout(devices[_0x191d04][_0x5839e3(0x26b)]);removeSocketListeners(getClient(_0x26eeb6['id'])[_0x5839e3(0x261)]),addBlacklist(_0x191d04),devices[_0x191d04][_0x5839e3(0x172)]=null,devices[_0x191d04][_0x5839e3(0x1cc)]=null,devices[_0x191d04][_0x5839e3(0x17e)]['token']=null,io['to'](getClient(_0x26eeb6['id'])[_0x5839e3(0x261)])['emit'](_0x5839e3(0x218),{'access':{'allow':![],'reason':_0x5839e3(0x23c),'token':null}});}else logger[_0x5839e3(0x250)](_0x5839e3(0x28d));});}function removeSocketListeners(_0x2343ec){const _0x5be924=_0x2f8d3d;getClientsWithUuid(_0x2343ec)[_0x5be924(0x24c)](_0x327c5c=>{const _0x26439b=_0x5be924;getSocket(_0x327c5c['id'])[_0x26439b(0x21f)]();});}function cleanSettings(){const _0x40e891=_0x2f8d3d;let _0x3fe281=settings;return settings['telegramToken']&&settings[_0x40e891(0x12e)]!=''&&(_0x3fe281={..._0x3fe281,'telegramToken':'************'}),settings[_0x40e891(0x271)]&&settings[_0x40e891(0x271)]!=''&&(_0x3fe281={..._0x3fe281,'bbPassword':_0x40e891(0x1a9)}),(settings[_0x40e891(0x271)]&&settings[_0x40e891(0x271)]=='***'||settings[_0x40e891(0x12e)]&&settings['telegramToken']==_0x40e891(0x1c8))&&(_0x3fe281={..._0x3fe281,'restored':{'password':settings['bbPassword']==_0x40e891(0x1c8),'telegram':settings[_0x40e891(0x12e)]==_0x40e891(0x1c8)}}),_0x3fe281;}function updateBB(){const _0x2f8758=_0x2f8d3d;installingUpdate=!![],config['forEach'](_0x3249d8=>{const _0x56bbba=_0x3893;restartBot(_0x3249d8[_0x56bbba(0x138)]);}),process[_0x2f8758(0x157)]({'update':!![]},_0x19e887=>{});}function startBot(_0x3d7031,_0x2f8bab,_0x3455ab){const _0x19732b=_0x2f8d3d;let _0x31b8c0=![];const _0x670990=_0x3d7031[0x0];_0x2f8bab={..._0x2f8bab,'stdio':[_0x19732b(0x1dc),_0x19732b(0x1dc),'inherit',_0x19732b(0x1b7)]},pid[_0x670990]=childProcess[_0x19732b(0x24b)](botfile,_0x3d7031,_0x2f8bab),pid[_0x670990]['on']('message',_0x3ae252=>{const _0x50b18c=_0x19732b;switch(Object[_0x50b18c(0x22b)](_0x3ae252)[0x0]){case _0x50b18c(0x1c4):updateBotName(_0x670990,_0x3ae252[_0x50b18c(0x1c4)]);break;case _0x50b18c(0x25f):updateBotManager();break;case'status':updateStatus(_0x670990,_0x3ae252['status']);break;case _0x50b18c(0x204):updateLive(_0x670990,_0x3ae252['live']);break;case _0x50b18c(0x1b8):updateLive(_0x670990,_0x3ae252[_0x50b18c(0x1b8)]),io['to'](_0x670990)[_0x50b18c(0x210)]('status',{'access':{'allow':![],'reason':_0x50b18c(0x24e),'token':null}});break;case _0x50b18c(0x13c):_0x3ae252[_0x50b18c(0x13c)]==_0x50b18c(0x1f2)&&restartBot(_0x670990);_0x3ae252[_0x50b18c(0x13c)]==_0x50b18c(0x298)&&toggleBot(_0x670990,_0x50b18c(0x1c5),_0x50b18c(0x216));break;case _0x50b18c(0x1de):sendTelegram(_0x670990,_0x3ae252[_0x50b18c(0x1de)]);break;case'telegrammsg':sendTelegramMsg(_0x3ae252[_0x50b18c(0x2ae)]);break;case _0x50b18c(0x162):io['to'](_0x670990)['emit'](_0x3ae252[_0x50b18c(0x162)],_0x3ae252[_0x50b18c(0x18c)]);break;}}),pid[_0x670990]['on']('error',function(_0x2905a5){if(_0x31b8c0)return;_0x31b8c0=!![],_0x3455ab(_0x2905a5);}),pid[_0x670990]['on'](_0x19732b(0x1b1),async function(_0x111d7d){const _0x3ff85d=_0x19732b;if(installingUpdate)return;if(_0x31b8c0)return;_0x31b8c0=!![],_0x3455ab(null);const _0x26f736=dbConfig[_0x3ff85d(0x22e)](_0x3ff85d(0x1f7))[_0x3ff85d(0x272)]({'botID':_0x670990})[_0x3ff85d(0x125)]();_0x26f736&&(_0x26f736[_0x3ff85d(0x218)]==_0x3ff85d(0x1c0)||_0x26f736['status']==_0x3ff85d(0x278))&&(await sleep(0x3e8),updateLive(_0x670990,_0x3ff85d(0x216)),logger['full']('restarting\x20Bot\x20'+_0x670990),startBot([_0x670990,userID],{'cwd':bbpath},function(_0xf10590){const _0x294b66=_0x3ff85d;if(_0xf10590)logger[_0x294b66(0x250)](_0xf10590);}));});}function stopBot(_0x1da311){const _0x4dbfd3=_0x2f8d3d;getClientsWithBotID(_0x1da311)[_0x4dbfd3(0x24c)](_0x2d48cc=>{const _0xe088d6=_0x4dbfd3;getSocket(_0x2d48cc['id'])[_0xe088d6(0x237)](!![]),removeClient(_0x2d48cc['id']);}),pid[_0x1da311]&&(pid[_0x1da311][_0x4dbfd3(0x298)](),pid[_0x1da311]=null);}function restartBot(_0x16df86){if(pid[_0x16df86])pid[_0x16df86]['kill']();}function addBot(){const _0x2a12b2=_0x2f8d3d;let _0x1f511b;for(let _0x3bf7d4=0x1;_0x3bf7d4<0x3e9;_0x3bf7d4++){_0x1f511b=_0x3bf7d4[_0x2a12b2(0x2a1)]()[_0x2a12b2(0x2a5)](0x3,'0');let _0x3a8076=config[_0x2a12b2(0x272)](_0x194997=>_0x194997['botID']==_0x1f511b);if(!_0x3a8076)break;}if(_0x1f511b===_0x2a12b2(0x23e)){logger[_0x2a12b2(0x250)](_0x2a12b2(0x20c));return;}logger[_0x2a12b2(0x250)](_0x2a12b2(0x128)+_0x1f511b),dbConfig[_0x2a12b2(0x22e)](_0x2a12b2(0x1f7))[_0x2a12b2(0x13d)]({'botID':_0x1f511b,'botname':_0x2a12b2(0x240)+_0x1f511b,'status':'new','live':''})['write'](),startBot([_0x1f511b,userID],{'cwd':bbpath},function(_0x2b41ac){const _0x3a6409=_0x2a12b2;if(_0x2b41ac)logger[_0x3a6409(0x250)](_0x2b41ac);}),config=getConfiguration(),io['to'](_0x2a12b2(0x137))[_0x2a12b2(0x210)](_0x2a12b2(0x1f7),config);}function deleteBot(_0x5edd85){const _0x3e9a5a=_0x2f8d3d;getClientsWithBotID(_0x5edd85)[_0x3e9a5a(0x24c)](_0x26a8ec=>{const _0x4a7b17=_0x3e9a5a;getSocket(_0x26a8ec['id'])[_0x4a7b17(0x237)](!![]),removeClient(_0x26a8ec['id']);}),dbConfig[_0x3e9a5a(0x22e)](_0x3e9a5a(0x1f7))['remove']({'botID':_0x5edd85})[_0x3e9a5a(0x1d7)](),logger[_0x3e9a5a(0x250)](_0x3e9a5a(0x1cf)+_0x5edd85),stopBot(_0x5edd85);try{fs[_0x3e9a5a(0x227)](path[_0x3e9a5a(0x19c)](configpath,'bot-'+_0x5edd85+_0x3e9a5a(0x120))),fs[_0x3e9a5a(0x227)](path[_0x3e9a5a(0x19c)](configpath,_0x3e9a5a(0x289)+_0x5edd85+_0x3e9a5a(0x248))),fs[_0x3e9a5a(0x227)](path[_0x3e9a5a(0x19c)](configpath,_0x3e9a5a(0x289)+_0x5edd85+_0x3e9a5a(0x1ef))),fs[_0x3e9a5a(0x227)](path[_0x3e9a5a(0x19c)](configpath,_0x3e9a5a(0x289)+_0x5edd85+_0x3e9a5a(0x205)));}catch(_0x1ee64e){if(_0x1ee64e)logger['full']('error\x20while\x20deleting\x20config\x20files:\x20',_0x1ee64e);}config=getConfiguration(),io['to'](_0x3e9a5a(0x137))['emit'](_0x3e9a5a(0x1f7),config);}function toggleBot(_0x4cf35a,_0x121295,_0x1b5d8c){const _0x1bed74=_0x2f8d3d;dbConfig[_0x1bed74(0x22e)]('bots')[_0x1bed74(0x272)]({'botID':_0x4cf35a})[_0x1bed74(0x243)]({'status':_0x121295})[_0x1bed74(0x243)]({'live':_0x1b5d8c})[_0x1bed74(0x1d7)]();if(_0x121295==_0x1bed74(0x1c0)||_0x121295==_0x1bed74(0x278))logger[_0x1bed74(0x250)]('enabled\x20Bot\x20'+_0x4cf35a),startBot([_0x4cf35a,userID],{'cwd':bbpath},function(_0x3557e2){const _0x264a03=_0x1bed74;if(_0x3557e2)logger[_0x264a03(0x250)](_0x3557e2);});else(_0x121295=='disabled'||_0x121295=='new-disabled')&&(logger[_0x1bed74(0x250)](_0x1bed74(0x145)+_0x4cf35a),stopBot(_0x4cf35a));config=getConfiguration(),io['to'](_0x1bed74(0x137))[_0x1bed74(0x210)](_0x1bed74(0x1f7),config);}function toggleStatus(_0x1abe93){const _0x18e665=_0x2f8d3d;let _0x5c6066=dbConfig[_0x18e665(0x22e)]('bots')['find']({'botID':_0x1abe93})['value'](),_0x1dcf96;if(_0x5c6066[_0x18e665(0x218)]==='enabled')_0x1dcf96=_0x18e665(0x1c5);else{if(_0x5c6066[_0x18e665(0x218)]===_0x18e665(0x278))_0x1dcf96=_0x18e665(0x200);else{if(_0x5c6066['status']==='new-disabled')_0x1dcf96=_0x18e665(0x278);else{if(_0x5c6066['status']===_0x18e665(0x1c5))_0x1dcf96='enabled';}}}return _0x1dcf96;}function updateStatus(_0x2b226d,_0x381e89){const _0x100523=_0x2f8d3d;dbConfig['get'](_0x100523(0x1f7))[_0x100523(0x272)]({'botID':_0x2b226d})['assign']({'status':_0x381e89})[_0x100523(0x1d7)](),config=getConfiguration(),io['to'](_0x100523(0x137))[_0x100523(0x210)](_0x100523(0x1f7),config);}function updateLive(_0xa59b0d,_0x211768){const _0x5c30b3=_0x2f8d3d;dbConfig['get'](_0x5c30b3(0x1f7))[_0x5c30b3(0x272)]({'botID':_0xa59b0d})[_0x5c30b3(0x243)]({'live':_0x211768})[_0x5c30b3(0x1d7)](),config=getConfiguration(),io['to'](_0x5c30b3(0x137))[_0x5c30b3(0x210)](_0x5c30b3(0x1f7),config);}function updateBotName(_0x1035c7,_0x18ac10){const _0x53c7fc=_0x2f8d3d;dbConfig['get'](_0x53c7fc(0x1f7))['find']({'botID':_0x1035c7})[_0x53c7fc(0x243)]({'botname':_0x18ac10})[_0x53c7fc(0x1d7)](),config=getConfiguration(),io['to']('botmanager')[_0x53c7fc(0x210)]('bots',config);}function updateBotManager(){const _0x411ee9=_0x2f8d3d;config=getConfiguration(),io['to'](_0x411ee9(0x137))[_0x411ee9(0x210)]('bots',config);}function toggleBotMode(_0x387f12){const _0x127efd=_0x2f8d3d;if(pid[_0x387f12])pid[_0x387f12][_0x127efd(0x157)]({'function':'toggleBotMode','args':null});else{const _0x56bab6=configpath+_0x127efd(0x289)+_0x387f12+_0x127efd(0x120),_0x2635b3=fs['readFileSync'](_0x56bab6),_0x24f728=JSON[_0x127efd(0x15a)](_0x2635b3),_0x3546f0=_0x24f728[_0x127efd(0x233)][0x0]['headless'];_0x24f728[_0x127efd(0x233)][0x0][_0x127efd(0x1cd)]=!_0x3546f0;const _0x2e7498=JSON[_0x127efd(0x25e)](_0x24f728,null,0x2);fs[_0x127efd(0x254)](_0x56bab6,_0x2e7498),config=getConfiguration(),io['to']('botmanager')[_0x127efd(0x210)](_0x127efd(0x1f7),config);}}function telegramError(_0x3f1b0a){logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x1cc4c6){const _0x1ca6b5=_0x2f8d3d;if(_0x1cc4c6['from']['username']!=settings['telegramUsername']&&'@'+_0x1cc4c6[_0x1ca6b5(0x201)][_0x1ca6b5(0x21a)]!=settings[_0x1ca6b5(0x206)])return tgBot[_0x1ca6b5(0x165)](_0x1cc4c6[_0x1ca6b5(0x124)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x1ca6b5(0x291)})[_0x1ca6b5(0x13a)](_0x14ecb6=>{telegramError(_0x14ecb6);}),![];return!![];}async function initTelegram(){const _0x3302c1=_0x2f8d3d;if(tgBot)tgBot[_0x3302c1(0x1b0)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x337615=_0x3302c1(0x29a);_0x337615+='\x0a',_0x337615+=_0x3302c1(0x131),_0x337615+=_0x3302c1(0x1ca),_0x337615+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x337615+=_0x3302c1(0x11f),_0x337615+=_0x3302c1(0x214),_0x337615+=_0x3302c1(0x1b9),_0x337615+=_0x3302c1(0x114),_0x337615+='/names\x20-\x20show\x20bot\x20names\x0a',_0x337615+=_0x3302c1(0x268),_0x337615+=_0x3302c1(0x2a9),_0x337615+=_0x3302c1(0x14d),_0x337615+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x32c398=_0x3302c1(0x173);_0x32c398+='\x0a',_0x32c398+=_0x337615,tgBot[_0x3302c1(0x22c)](/\/start/,_0x5a4905=>{const _0x1a818f=_0x3302c1;if(!validateTelegram(_0x5a4905))return;if(settings[_0x1a818f(0x269)]!=_0x5a4905[_0x1a818f(0x124)]['id'])updateSetting(_0x1a818f(0x269),_0x5a4905[_0x1a818f(0x124)]['id']);updateSetting(_0x1a818f(0x192),!![]),tgBot[_0x1a818f(0x165)](_0x5a4905['chat']['id'],_0x32c398)['catch'](_0xdc9de=>{telegramError(_0xdc9de);});}),tgBot[_0x3302c1(0x22c)](/\/enable/,_0x3a9d17=>{const _0xa16944=_0x3302c1;if(!validateTelegram(_0x3a9d17))return;if(settings[_0xa16944(0x269)]!=_0x3a9d17[_0xa16944(0x124)]['id'])updateSetting(_0xa16944(0x269),_0x3a9d17[_0xa16944(0x124)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0xa16944(0x165)](_0x3a9d17['chat']['id'],'Notifications\x20enabled')[_0xa16944(0x13a)](_0x58fa98=>{telegramError(_0x58fa98);});}),tgBot[_0x3302c1(0x22c)](/\/config/,async _0x25f61b=>{const _0x2dc285=_0x3302c1;if(!validateTelegram(_0x25f61b))return;tgBot['removeListener']('callback_query'),tgBot[_0x2dc285(0x165)](_0x25f61b[_0x2dc285(0x124)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x2dc285(0x1fe)},{'text':'Alerts','callback_data':_0x2dc285(0x189)},{'text':_0x2dc285(0x19f),'callback_data':_0x2dc285(0x1f0)}]]}})[_0x2dc285(0x13a)](_0x4c76d3=>{telegramError(_0x4c76d3);}),tgBot['on'](_0x2dc285(0x14b),async _0x52f87d=>{const _0x24a1a1=_0x2dc285,_0x484c34=_0x52f87d[_0x24a1a1(0x132)],_0x37e0f3=_0x52f87d[_0x24a1a1(0x1d8)];tgBot[_0x24a1a1(0x207)](_0x52f87d['id'])[_0x24a1a1(0x18a)](async()=>{const _0x1f3657=_0x24a1a1;_0x484c34==_0x1f3657(0x1fe)&&(updateSetting('telegramEvents','orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x1f3657(0x165)](_0x37e0f3[_0x1f3657(0x124)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x1f3657(0x13a)](_0x1f095e=>{telegramError(_0x1f095e);}));_0x484c34==_0x1f3657(0x189)&&(updateSetting(_0x1f3657(0x287),_0x1f3657(0x189)),updateSetting(_0x1f3657(0x192),!![]),await tgBot['sendMessage'](_0x37e0f3[_0x1f3657(0x124)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x1f3657(0x13a)](_0x5a5c16=>{telegramError(_0x5a5c16);}));_0x484c34==_0x1f3657(0x1f0)&&(updateSetting(_0x1f3657(0x287),'all'),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x37e0f3[_0x1f3657(0x124)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x1f3657(0x13a)](_0x106461=>{telegramError(_0x106461);}));if(!settings[_0x1f3657(0x269)])tgBot[_0x1f3657(0x165)](_0x37e0f3[_0x1f3657(0x124)]['id'],_0x1f3657(0x203))['catch'](_0xf9b934=>{telegramError(_0xf9b934);});}),tgBot['removeListener'](_0x24a1a1(0x14b));});}),tgBot['onText'](/\/status/,_0x33717d=>{const _0x2d4b5d=_0x3302c1;if(!validateTelegram(_0x33717d))return;const _0x58520d=getBotsWithMode();let _0x14f3b1='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x2d4b5d(0x24c)](_0x43b57d=>{const _0x18919d=_0x2d4b5d,_0x5e1e72=_0x58520d[_0x18919d(0x272)](_0x1475f9=>_0x1475f9[_0x18919d(0x138)]==_0x43b57d[_0x18919d(0x138)])[_0x18919d(0x239)];_0x14f3b1+=_0x18919d(0x240)+_0x43b57d['botID']+':\x20'+_0x43b57d[_0x18919d(0x218)]+_0x18919d(0x2a0)+_0x5e1e72+_0x18919d(0x2a0)+_0x43b57d[_0x18919d(0x204)]+'\x0a';}),_0x14f3b1+='\x0a',_0x14f3b1+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x14f3b1+=!settings['telegramEnabled']?_0x2d4b5d(0x277):'Notifications\x20enabled\x0a',_0x14f3b1+=settings['telegramEnabled']?settings[_0x2d4b5d(0x287)]==_0x2d4b5d(0x1f0)?_0x2d4b5d(0x1f3):_0x2d4b5d(0x297)+settings[_0x2d4b5d(0x287)]+_0x2d4b5d(0x1ce):'',tgBot['sendMessage'](_0x33717d[_0x2d4b5d(0x124)]['id'],_0x14f3b1,{'parse_mode':'HTML'})[_0x2d4b5d(0x13a)](_0x2e4e8c=>{telegramError(_0x2e4e8c);});}),tgBot[_0x3302c1(0x22c)](/\/restart/,_0x38e52a=>{const _0x22c666=_0x3302c1;if(!validateTelegram(_0x38e52a))return;tgBot[_0x22c666(0x144)](_0x22c666(0x14b));const _0x1b2d47=getEnabledBots();if(_0x1b2d47[_0x22c666(0x25c)]==0x0)tgBot['sendMessage'](_0x38e52a['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x22c666(0x13a)](_0x3eb0df=>{telegramError(_0x3eb0df);});else{if(_0x1b2d47['length']>0x1)_0x1b2d47[_0x22c666(0x13d)]({'botID':_0x22c666(0x1f0)});let _0xcfee52=[],_0x270d7f=[];const _0x8461d6=_0x1b2d47['length']%0x4==0x0||_0x1b2d47[_0x22c666(0x25c)]%0x4==0x3||_0x1b2d47['length']%0x3==0x1?0x4:0x3;let _0x221bfb=0x0;_0x1b2d47[_0x22c666(0x24c)]((_0x1fca8f,_0x237649)=>{const _0x804a0d=_0x22c666;if(_0x237649%_0x8461d6==0x0)_0x270d7f=[];_0x270d7f[_0x804a0d(0x13d)]({'text':_0x1fca8f[_0x804a0d(0x138)]==_0x804a0d(0x1f0)?_0x804a0d(0x18e):_0x804a0d(0x240)+_0x1fca8f['botID'],'callback_data':_0x1fca8f[_0x804a0d(0x138)]}),_0x237649%_0x8461d6==0x0&&(_0xcfee52[_0x221bfb]=_0x270d7f,_0x221bfb++);}),tgBot[_0x22c666(0x165)](_0x38e52a[_0x22c666(0x124)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0xcfee52}})[_0x22c666(0x13a)](_0x2c4344=>{telegramError(_0x2c4344);}),tgBot['on'](_0x22c666(0x14b),async _0x817b1a=>{const _0x55c7f2=_0x22c666,_0x1fd4c4=_0x817b1a[_0x55c7f2(0x132)],_0x5a7f15=_0x817b1a[_0x55c7f2(0x1d8)];tgBot[_0x55c7f2(0x207)](_0x817b1a['id'])['then'](async()=>{const _0x1af8eb=_0x55c7f2;_0x1fd4c4=='all'?config[_0x1af8eb(0x24c)](_0x3e9b3b=>{restartBot(_0x3e9b3b['botID']);}):restartBot(_0x1fd4c4);}),tgBot[_0x55c7f2(0x144)](_0x55c7f2(0x14b));});}}),tgBot[_0x3302c1(0x22c)](/\/on/,_0x94f5a7=>{const _0x16ca03=_0x3302c1;if(!validateTelegram(_0x94f5a7))return;tgBot[_0x16ca03(0x144)](_0x16ca03(0x14b));const _0x3218c4=getDisabledBots();if(_0x3218c4[_0x16ca03(0x25c)]==0x0)tgBot[_0x16ca03(0x165)](_0x94f5a7[_0x16ca03(0x124)]['id'],_0x16ca03(0x1e7))['catch'](_0x34063f=>{telegramError(_0x34063f);});else{if(_0x3218c4['length']>0x1)_0x3218c4[_0x16ca03(0x13d)]({'botID':'all'});let _0x1b3773=[],_0x2e34ea=[];const _0x4cbfb4=_0x3218c4[_0x16ca03(0x25c)]%0x4==0x0||_0x3218c4[_0x16ca03(0x25c)]%0x4==0x3||_0x3218c4[_0x16ca03(0x25c)]%0x3==0x1?0x4:0x3;let _0x2710b7=0x0;_0x3218c4['forEach']((_0x1a4cb9,_0x1fd0b5)=>{const _0x30e2bf=_0x16ca03;if(_0x1fd0b5%_0x4cbfb4==0x0)_0x2e34ea=[];_0x2e34ea[_0x30e2bf(0x13d)]({'text':_0x1a4cb9['botID']=='all'?_0x30e2bf(0x18e):_0x30e2bf(0x240)+_0x1a4cb9['botID'],'callback_data':_0x1a4cb9[_0x30e2bf(0x138)]}),_0x1fd0b5%_0x4cbfb4==0x0&&(_0x1b3773[_0x2710b7]=_0x2e34ea,_0x2710b7++);}),tgBot[_0x16ca03(0x165)](_0x94f5a7[_0x16ca03(0x124)]['id'],_0x16ca03(0x164),{'reply_markup':{'inline_keyboard':_0x1b3773}})[_0x16ca03(0x13a)](_0x4be3ee=>{telegramError(_0x4be3ee);}),tgBot['on'](_0x16ca03(0x14b),async _0x142f6a=>{const _0x5ac471=_0x16ca03,_0x34acbb=_0x142f6a[_0x5ac471(0x132)],_0x5f3af7=_0x142f6a[_0x5ac471(0x1d8)];tgBot['answerCallbackQuery'](_0x142f6a['id'])[_0x5ac471(0x18a)](async()=>{const _0x40add5=_0x5ac471;_0x34acbb==_0x40add5(0x1f0)?(tgBot[_0x40add5(0x165)](_0x5f3af7['chat']['id'],_0x40add5(0x273))[_0x40add5(0x13a)](_0x413fe5=>{telegramError(_0x413fe5);}),_0x3218c4[_0x40add5(0x24c)](_0x5116f4=>{const _0x2640df=_0x40add5;if(_0x5116f4['botID']!=_0x2640df(0x1f0))toggleBot(_0x5116f4['botID'],toggleStatus(_0x5116f4[_0x2640df(0x138)]),'stopped');})):(tgBot[_0x40add5(0x165)](_0x5f3af7[_0x40add5(0x124)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x34acbb)[_0x40add5(0x13a)](_0x37cdba=>{telegramError(_0x37cdba);}),toggleBot(_0x34acbb,toggleStatus(_0x34acbb),'stopped'));}),tgBot['removeListener'](_0x5ac471(0x14b));});}}),tgBot['onText'](/\/off/,_0x540c36=>{const _0x201ade=_0x3302c1;if(!validateTelegram(_0x540c36))return;tgBot[_0x201ade(0x144)](_0x201ade(0x14b));const _0x1ac1b6=getEnabledBots();if(_0x1ac1b6['length']==0x0)tgBot['sendMessage'](_0x540c36[_0x201ade(0x124)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x1dc6f6=>{telegramError(_0x1dc6f6);});else{if(_0x1ac1b6['length']>0x1)_0x1ac1b6[_0x201ade(0x13d)]({'botID':_0x201ade(0x1f0)});let _0x2f1b71=[],_0x18f2cb=[];const _0x40da70=_0x1ac1b6['length']%0x4==0x0||_0x1ac1b6['length']%0x4==0x3||_0x1ac1b6[_0x201ade(0x25c)]%0x3==0x1?0x4:0x3;let _0x12200a=0x0;_0x1ac1b6['forEach']((_0x5630d6,_0x55671e)=>{const _0xe36b89=_0x201ade;if(_0x55671e%_0x40da70==0x0)_0x18f2cb=[];_0x18f2cb['push']({'text':_0x5630d6[_0xe36b89(0x138)]==_0xe36b89(0x1f0)?'All\x20bots':_0xe36b89(0x240)+_0x5630d6[_0xe36b89(0x138)],'callback_data':_0x5630d6[_0xe36b89(0x138)]}),_0x55671e%_0x40da70==0x0&&(_0x2f1b71[_0x12200a]=_0x18f2cb,_0x12200a++);}),tgBot[_0x201ade(0x165)](_0x540c36['chat']['id'],_0x201ade(0x195),{'reply_markup':{'inline_keyboard':_0x2f1b71}})[_0x201ade(0x13a)](_0xbdc386=>{telegramError(_0xbdc386);}),tgBot['on'](_0x201ade(0x14b),async _0x548226=>{const _0x339ba6=_0x201ade,_0x2f039c=_0x548226[_0x339ba6(0x132)],_0x681c5f=_0x548226['message'];tgBot[_0x339ba6(0x207)](_0x548226['id'])['then'](async()=>{const _0x1a273d=_0x339ba6;_0x2f039c==_0x1a273d(0x1f0)?(tgBot[_0x1a273d(0x165)](_0x681c5f[_0x1a273d(0x124)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x1a273d(0x13a)](_0x8ab993=>{telegramError(_0x8ab993);}),_0x1ac1b6[_0x1a273d(0x24c)](_0x1af52e=>{const _0x255028=_0x1a273d;if(_0x1af52e['botID']!='all')toggleBot(_0x1af52e['botID'],toggleStatus(_0x1af52e[_0x255028(0x138)]),_0x255028(0x216));})):(tgBot[_0x1a273d(0x165)](_0x681c5f[_0x1a273d(0x124)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x2f039c)[_0x1a273d(0x13a)](_0x450145=>{telegramError(_0x450145);}),toggleBot(_0x2f039c,toggleStatus(_0x2f039c),'stopped'));}),tgBot[_0x339ba6(0x144)](_0x339ba6(0x14b));});}}),tgBot[_0x3302c1(0x22c)](/\/portfolio/,_0x5eda8f=>{const _0x58b840=_0x3302c1;if(!validateTelegram(_0x5eda8f))return;tgBot[_0x58b840(0x144)]('callback_query');const _0x268c7c=getEnabledBots();if(_0x268c7c[_0x58b840(0x25c)]==0x0)tgBot[_0x58b840(0x165)](_0x5eda8f[_0x58b840(0x124)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x5c8eff=>{telegramError(_0x5c8eff);});else{if(_0x268c7c[_0x58b840(0x25c)]>0x1){let _0x5ad85f=[],_0x58fbfd=[];const _0x33543c=_0x268c7c[_0x58b840(0x25c)]%0x4==0x0||_0x268c7c[_0x58b840(0x25c)]%0x4==0x3||_0x268c7c[_0x58b840(0x25c)]%0x3==0x1?0x4:0x3;let _0x2aedf0=0x0;_0x268c7c[_0x58b840(0x24c)]((_0x468887,_0x4ed4a7)=>{const _0x4809e2=_0x58b840;if(_0x4ed4a7%_0x33543c==0x0)_0x58fbfd=[];_0x58fbfd['push']({'text':_0x4809e2(0x240)+_0x468887['botID'],'callback_data':_0x468887[_0x4809e2(0x138)]}),_0x4ed4a7%_0x33543c==0x0&&(_0x5ad85f[_0x2aedf0]=_0x58fbfd,_0x2aedf0++);}),tgBot['sendMessage'](_0x5eda8f['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x5ad85f}})[_0x58b840(0x13a)](_0x412e6f=>{telegramError(_0x412e6f);}),tgBot['on'](_0x58b840(0x14b),async _0x1ce98c=>{const _0x87eb08=_0x58b840,_0x4ccd14=_0x1ce98c[_0x87eb08(0x132)],_0x258d64=_0x1ce98c['message'];tgBot[_0x87eb08(0x207)](_0x1ce98c['id'])['then'](async()=>{const _0xb5ae88=_0x87eb08;if(pid[_0x4ccd14])pid[_0x4ccd14][_0xb5ae88(0x157)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x87eb08(0x144)](_0x87eb08(0x14b));});}else{const _0x2f0908=_0x268c7c[0x0][_0x58b840(0x138)];if(pid[_0x2f0908])pid[_0x2f0908][_0x58b840(0x157)]({'function':_0x58b840(0x20d),'args':null});}}}),tgBot[_0x3302c1(0x22c)](/\/update/,async _0x158b3a=>{const _0x1c90c3=_0x3302c1;if(!validateTelegram(_0x158b3a))return;tgBot['removeListener'](_0x1c90c3(0x14b)),await getMessages();if(!updateAvailable)tgBot[_0x1c90c3(0x165)](_0x158b3a[_0x1c90c3(0x124)]['id'],_0x1c90c3(0x213))[_0x1c90c3(0x13a)](_0x447010=>{telegramError(_0x447010);});else!validInstallation?tgBot[_0x1c90c3(0x165)](_0x158b3a['chat']['id'],_0x1c90c3(0x10e))['catch'](_0x5437ca=>{telegramError(_0x5437ca);}):(tgBot[_0x1c90c3(0x165)](_0x158b3a[_0x1c90c3(0x124)]['id'],_0x1c90c3(0x135),{'reply_markup':{'inline_keyboard':[[{'text':_0x1c90c3(0x25b),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x1c90c3(0x13a)](_0xf7da70=>{telegramError(_0xf7da70);}),tgBot['on'](_0x1c90c3(0x14b),async _0x1325d7=>{const _0x49758e=_0x1c90c3,_0x40e743=_0x1325d7['data'],_0x17fe5a=_0x1325d7[_0x49758e(0x1d8)];tgBot[_0x49758e(0x207)](_0x1325d7['id'])['then'](async()=>{const _0x4a0478=_0x49758e;_0x40e743=='yes'&&(await tgBot[_0x4a0478(0x165)](_0x17fe5a[_0x4a0478(0x124)]['id'],_0x4a0478(0x119))[_0x4a0478(0x13a)](_0x27a025=>{telegramError(_0x27a025);}),updateBB());_0x40e743=='no'&&await tgBot['sendMessage'](_0x17fe5a['chat']['id'],_0x4a0478(0x25d))[_0x4a0478(0x13a)](_0x512971=>{telegramError(_0x512971);});if(!settings[_0x4a0478(0x269)])tgBot[_0x4a0478(0x165)](_0x17fe5a[_0x4a0478(0x124)]['id'],_0x4a0478(0x203))[_0x4a0478(0x13a)](_0x3e8ced=>{telegramError(_0x3e8ced);});}),tgBot[_0x49758e(0x144)](_0x49758e(0x14b));}));}),tgBot[_0x3302c1(0x22c)](/\/toggle/,_0x2196e0=>{const _0xe9b43b=_0x3302c1;if(!validateTelegram(_0x2196e0))return;tgBot[_0xe9b43b(0x144)](_0xe9b43b(0x14b));const _0x1183ff=getBotsWithMode();if(_0x1183ff[_0xe9b43b(0x25c)]==0x0)tgBot[_0xe9b43b(0x165)](_0x2196e0[_0xe9b43b(0x124)]['id'],_0xe9b43b(0x16a))['catch'](_0x42353b=>{telegramError(_0x42353b);});else{let _0xa51598=[],_0x460ecc=[];const _0x1a1acf=0x2;let _0x3799e3=0x0;_0x1183ff[_0xe9b43b(0x24c)]((_0x11bb39,_0x485c4c)=>{const _0x113259=_0xe9b43b;if(_0x485c4c%_0x1a1acf==0x0)_0x460ecc=[];_0x460ecc[_0x113259(0x13d)]({'text':'Bot\x20'+_0x11bb39[_0x113259(0x138)]+'\x20('+_0x11bb39[_0x113259(0x239)]+')','callback_data':_0x11bb39[_0x113259(0x138)]}),_0x485c4c%_0x1a1acf==0x0&&(_0xa51598[_0x3799e3]=_0x460ecc,_0x3799e3++);}),tgBot[_0xe9b43b(0x165)](_0x2196e0[_0xe9b43b(0x124)]['id'],_0xe9b43b(0x276),{'reply_markup':{'inline_keyboard':_0xa51598}})[_0xe9b43b(0x13a)](_0x25b349=>{telegramError(_0x25b349);}),tgBot['on'](_0xe9b43b(0x14b),async _0x41fb49=>{const _0x5e81ab=_0xe9b43b,_0x528f20=_0x41fb49[_0x5e81ab(0x132)],_0x1bc20d=_0x41fb49[_0x5e81ab(0x1d8)];tgBot[_0x5e81ab(0x207)](_0x41fb49['id'])[_0x5e81ab(0x18a)](async()=>{const _0x334b0c=_0x5e81ab,_0x3664c1=_0x1183ff[_0x334b0c(0x272)](_0x870814=>_0x870814[_0x334b0c(0x138)]==_0x528f20),_0x280418=_0x3664c1[_0x334b0c(0x239)]=='auto'?_0x334b0c(0x1c2):_0x334b0c(0x1a5);tgBot[_0x334b0c(0x165)](_0x1bc20d[_0x334b0c(0x124)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x528f20+_0x334b0c(0x1fb)+_0x280418+'\x20mode')[_0x334b0c(0x13a)](_0xa8528d=>{telegramError(_0xa8528d);}),toggleBotMode(_0x528f20);}),tgBot[_0x5e81ab(0x144)](_0x5e81ab(0x14b));});}}),tgBot[_0x3302c1(0x22c)](/\/names/,_0x39a2a0=>{const _0x512afd=_0x3302c1;if(!validateTelegram(_0x39a2a0))return;let _0x343c90='';config[_0x512afd(0x24c)](_0x38c70e=>{const _0x3decb8=_0x512afd;_0x343c90+='Bot\x20'+_0x38c70e[_0x3decb8(0x138)]+':\x20'+_0x38c70e[_0x3decb8(0x1c4)]+'\x0a';}),tgBot[_0x512afd(0x165)](_0x39a2a0[_0x512afd(0x124)]['id'],_0x343c90,{'parse_mode':_0x512afd(0x291)})['catch'](_0x225d0f=>{telegramError(_0x225d0f);});}),tgBot[_0x3302c1(0x22c)](/\/disable/,_0x11ac88=>{const _0x464865=_0x3302c1;if(!validateTelegram(_0x11ac88))return;tgBot[_0x464865(0x165)](_0x11ac88['chat']['id'],_0x464865(0x241))[_0x464865(0x13a)](_0x41c99c=>{telegramError(_0x41c99c);}),updateSetting(_0x464865(0x192),![]);}),tgBot[_0x3302c1(0x22c)](/\/help/,_0x206c62=>{const _0x4d8531=_0x3302c1;if(!validateTelegram(_0x206c62))return;tgBot[_0x4d8531(0x165)](_0x206c62[_0x4d8531(0x124)]['id'],_0x337615)[_0x4d8531(0x13a)](_0x1926f2=>{telegramError(_0x1926f2);});}),tgBot['on'](_0x3302c1(0x153),_0x49d9bb=>{const _0x5f0485=_0x3302c1;_0x49d9bb[_0x5f0485(0x2a1)]()['includes']('404\x20Not\x20Found')&&(logger[_0x5f0485(0x250)](_0x5f0485(0x10d)),tgBot[_0x5f0485(0x1b0)](),tgBot=null,io['to'](_0x5f0485(0x137))['emit'](_0x5f0485(0x26f),'Invalid\x20Telegram\x20token'));}),process[_0x3302c1(0x1ab)](_0x3302c1(0x232),()=>{const _0x4613e1=_0x3302c1;if(tgBot)tgBot[_0x4613e1(0x1b0)]();process[_0x4613e1(0x1b1)](0x1);}),process[_0x3302c1(0x1ab)](_0x3302c1(0x1ed),()=>{const _0x10366c=_0x3302c1;if(tgBot)tgBot['stopPolling']();process[_0x10366c(0x1b1)](0x1);});}}function disableTelegram(){const _0x253072=_0x2f8d3d;tgBot&&(tgBot[_0x253072(0x1b0)](),tgBot=null);}function _0x128a(){const _0x38a4d9=['Starting\x20Balance\x20Bot\x20update','event','util','Unauthorized\x20attempt\x20to\x20get\x20portfolio','accept','number','/restart\x20-\x20restart\x20bot(s)\x0a','-config.json','Login\x20accepted','bb-secure.json','804274lYbIRm','chat','value','2FA\x20login\x20token\x20generated','showname','starting\x20new\x20bot\x20|\x20Bot\x20','::ffff:127.0.0.1','randomBytes','init','add-bot','/:bot/support','telegramToken','/:bot/configuration','isDirectory','/enable\x20-\x20enable\x20notifications\x0a','data','node-zip','/:bot','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','bot.js','botmanager','botID','No\x20file\x20uploaded','catch','exp','stop','push','host','settings','files','DEFLATE','2FA\x20login\x20required','1673060CnelyP','removeListener','disabled\x20Bot\x20','name','6b67f3d61ee94b8f5c80b4affef4c4d9','zip/','login','Bot\x20Mgr\x20>\x20','callback_query','success','/update\x20-\x20update\x20Balance\x20Bot\x0a','readdirSync','Password\x20reset\x20rejected','sockets','update-bot','.zip','polling_error','env','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','send','connection','6610880UYjyeD','parse','yes','defaults','remoteAddress','Crypt','sort','bb-config.json','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','function','Invalid\x20authentication\x20token\x20(2)','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','sendMessage','existsSync','confirm-message','bcryptjs','split','No\x20bots\x20running\x20right\x20now','deleteHistoryAlerts','post','lastmsgemitted','show','express','get-starting-balances','Invalid\x20IP\x20address','telegramIpApproval','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','15\x20min','axios','verify','getHours','token','format','Unauthorized\x20attempt\x20to\x20get\x20messages','3000','idling\x20bot\x20\x20\x20|\x20Bot\x20','output-000.log','access','Invalid\x20authentication\x20token\x20(1)','binary','decrypt','logs/','settings.','order','172856avQBUN','mkdirSync',',\x20must\x20be\x20a\x204\x20digit\x20number','slice','alerts','then','Failed\x20to\x20download\x20','args','date-fns','All\x20bots','api-eu.mixpanel.com','delete-bot','config/','telegramEnabled','child_process','hybrid-crypto-js','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','listen','login\x20token\x20valid','warning','alias','apiSecret','File\x20uploaded','join','</b>\x20?','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','All','clients','hashSync','password','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','userid','auto','Unauthorized\x20attempt\x20to\x20update\x20bot','allow','blacklist','************','127.0.0.1','once','login\x20token\x20generated','title','express-fileupload','delete-alerts','stopPolling','exit','Unauthorized\x20attempt\x20to\x20confirm\x20message','expiry','node-telegram-bot-api','$1_$2_$3','RSA-OAEP','ipc','started','/off\x20-\x20stop\x20bot(s)\x0a','/upload-backup','ipaddr.js','2FA\x20required','6ZsRdXI','\x20minutes','output-001.log','enabled','createWriteStream','manual','1143650RVKMdh','botname','disabled','30\x20min','generate','***','cancel-loading','/disable\x20-\x20disable\x20notifications\x0a','jsonwebtoken','telegram2FaApproval','headless','\x20only\x0a','deleted\x20Bot\x20','0.0.0','sign','uncaughtException','cancelLoading','Markdown','Access\x20enabled\x20for\x20','User\x20has\x20been\x20validated','write','message','181175ZdvPJf','getTime','starting\x20bot\x20|\x20Bot\x20','inherit','publicKey','telegram','socket','63haAFXi','5\x20min','randomFillSync',':\x20Bot\x20Mgr\x20>\x20','build2','yargs/yargs','headers','All\x20bots\x20running\x20right\x20now','bbUsername','access\x20timeout','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','apiKey','toggle-bot-mode','SIGTERM','get-messages','-performance.json','all','replace','restart','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','loginRequired','createServer','readFileSync','bots','placeOrder','1237663DbMarf','ipv6','\x20to\x20','reason','temporary\x20access\x20not\x20allowed','orders','sortBy','new-disabled','from','\x20(2)','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','live','-results.json','telegramUsername','answerCallbackQuery','store-configuration','toIPv4Address','rmSync','getDate','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','sendPortfolioTelegram','type','f2aRequired','emit','3GMeBaG','store-settings','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/on\x20-\x20start\x20bot(s)\x0a','reset-password','stopped','any','status','-----------------------------------------------------------------------------------','username','::1','whitelist','https://api.ipify.org?format=json','startsWith','removeAllListeners','Restore\x20process\x20aborted','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20add\x20bot','http','toIPv4MappedAddress','\x20(1)','unlinkSync','match','privateKey','set','keys','onText','statSync','get','handshake','static','argv','SIGINT','bot','use','storeConfiguration','auth','disconnect','add','mode','user','Unauthorized\x20attempt\x20to\x20download\x20','logged\x20out','temporary\x20token\x20generated','1000','(((.+)+)+)+$','Bot\x20','Notifications\x20disabled','/:bot/coins','assign','getSeconds','min','secure','pidRefreshToken','-events.json','backup','connected','fork','forEach','temporary\x20access\x20rejected','reload','update-bb','full','timestamp','lastmsgtelegram','request','writeFileSync','get-portfolio','getFullYear','_data','lowdb','invalid\x20credentials','kind','Yes','length','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','stringify','updatebotmanager','sha256','uuid','error','bb-settings.json','secret','Unauthorized\x20attempt\x20to\x20store\x20configuration','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','server','/status\x20-\x20show\x20bot(s)\x20status\x0a','telegramChatId','index.html','pidExpireLogin','clientip','emitHistory','messages','notification','getMonth','bbPassword','find','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','backupfile','test','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Notifications\x20disabled\x0a','new','output-002.log','get-logs','search','hex','backup/','2FA\x20login\x20rejected','login\x20not\x20required','/download/:type','initclient','mixpanel','map','remove','params','Unauthorized\x20attempt\x20to\x20delete\x20alerts','telegramEvents','latestversion','bot-','RSA','hasOwnProperty','graphql-request','Unauthorized\x20attempt\x20to\x20log\x20out','reject','version','log','HTML','Server','simple','login\x20required','file','temporary\x20access\x20timeout','Notifications\x20types:\x20','kill','build','You\x20can\x20use\x20the\x20following\x20commands:\x0a','\x20>\x20','storeHeadless','crypto','copyFileSync','getMinutes','\x20|\x20','toString','bbvNew','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','generateKeyPairAsync','padStart','temp/','download','timeshift','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','sendFile','bbvReceive','compareSync','referer','telegrammsg','store','Invalid\x20Telegram\x20token','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','includes','temporaryAccessAllowed','apply','filter','getStartingBalances','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Allow\x20login\x20from\x20IP\x20address\x20<b>','max','store-headless','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)'];_0x128a=function(){return _0x38a4d9;};return _0x128a();}function sendTelegram(_0x483d26,_0x3b2a99){const _0x458c48=_0x2f8d3d;if(settings[_0x458c48(0x192)]){if(settings[_0x458c48(0x287)]==_0x458c48(0x1f0)||(_0x3b2a99[_0x458c48(0x20e)]==_0x458c48(0x262)||_0x3b2a99[_0x458c48(0x20e)]==_0x458c48(0x198)||_0x3b2a99[_0x458c48(0x20e)]==_0x458c48(0x14c))&&settings[_0x458c48(0x287)]==_0x458c48(0x189)||_0x3b2a99[_0x458c48(0x20e)]==_0x458c48(0x184)&&settings[_0x458c48(0x287)]==_0x458c48(0x1fe)){if(tgBot&&settings['telegramChatId']){if(_0x3b2a99[_0x458c48(0x127)])tgBot['sendMessage'](settings[_0x458c48(0x269)],_0x3b2a99[_0x458c48(0x1c4)]+_0x458c48(0x29b)+_0x3b2a99[_0x458c48(0x11a)])[_0x458c48(0x13a)](_0xa46259=>{telegramError(_0xa46259);});else tgBot[_0x458c48(0x165)](settings[_0x458c48(0x269)],_0x458c48(0x240)+_0x483d26+_0x458c48(0x29b)+_0x3b2a99['event'])[_0x458c48(0x13a)](_0x12d665=>{telegramError(_0x12d665);});}}}}async function sendTelegramMsg(_0xcfbb40,_0x18ba0f=_0x2f8d3d(0x291)){const _0x56f4fe=_0x2f8d3d;return settings[_0x56f4fe(0x192)]&&tgBot&&settings[_0x56f4fe(0x269)]?(await tgBot[_0x56f4fe(0x165)](settings[_0x56f4fe(0x269)],_0xcfbb40,{'parse_mode':_0x18ba0f})[_0x56f4fe(0x13a)](_0x29b284=>{telegramError(_0x29b284);}),!![]):![];}function getDeviceWithIp(_0x42bb45){const _0x352f79=_0x2f8d3d;return devices[_0x352f79(0x272)](_0x569b67=>_0x569b67['ip']===_0x42bb45);}function temporaryAccess2FA(_0x357b63,_0x17f927){const _0x50b876=_0x2f8d3d;let _0x2d2894=new Date(),_0x1dd268=![];if(lastIpApproval){if(_0x2d2894-lastIpApproval<0x1388)_0x1dd268=!![];}lastIpApproval=new Date();if(_0x1dd268)return;tgBot&&settings[_0x50b876(0x269)]&&(tgBot['removeListener'](_0x50b876(0x14b)),tgBot['sendMessage'](settings[_0x50b876(0x269)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x17f927)[_0x50b876(0x16e)]+_0x50b876(0x19d),{'parse_mode':_0x50b876(0x291),'reply_markup':{'inline_keyboard':[[{'text':_0x50b876(0x1e1),'callback_data':'5'},{'text':_0x50b876(0x174),'callback_data':'15'},{'text':_0x50b876(0x1c6),'callback_data':'30'},{'text':_0x50b876(0x28e),'callback_data':_0x50b876(0x28e)}]]}})[_0x50b876(0x13a)](_0x1adacd=>{telegramError(_0x1adacd);}),tgBot['on'](_0x50b876(0x14b),async _0x5687fb=>{const _0x37f2b7=_0x50b876,_0x4263bf=_0x5687fb[_0x37f2b7(0x132)],_0x2dd405=_0x5687fb['message'];tgBot[_0x37f2b7(0x207)](_0x5687fb['id'])[_0x37f2b7(0x18a)](async()=>{const _0x434d91=_0x37f2b7;devices[_0x357b63]['telegramIpApproval']={'clientip':_0x17f927,'timestamp':new Date()[_0x434d91(0x1da)](),'expiry':_0x4263bf},_0x4263bf!='reject'?(await tgBot['sendMessage'](_0x2dd405[_0x434d91(0x124)]['id'],_0x434d91(0x1d5)+_0x4263bf+_0x434d91(0x1be),{'parse_mode':_0x434d91(0x291)})[_0x434d91(0x13a)](_0x1521a0=>{telegramError(_0x1521a0);}),io['to'](_0x357b63)[_0x434d91(0x210)](_0x434d91(0x218),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x434d91(0x165)](_0x2dd405['chat']['id'],'Temporary\x20access\x20rejected')[_0x434d91(0x13a)](_0x4d7ed3=>{telegramError(_0x4d7ed3);}),io['to'](_0x357b63)['emit']('status',{'access':{'allow':![],'reason':_0x434d91(0x24d),'token':null}}));}),tgBot[_0x37f2b7(0x144)](_0x37f2b7(0x14b));}));}function loginAccess2FA(_0x1dd37d,_0x112eb5){const _0x18151c=_0x2f8d3d;tgBot&&settings[_0x18151c(0x269)]&&(tgBot[_0x18151c(0x144)]('callback_query'),tgBot[_0x18151c(0x165)](settings[_0x18151c(0x269)],_0x18151c(0x115)+normalizeIP(_0x112eb5)['show']+'</b>\x20?',{'parse_mode':_0x18151c(0x291),'reply_markup':{'inline_keyboard':[[{'text':_0x18151c(0x11d),'callback_data':loginExpiry},{'text':_0x18151c(0x28e),'callback_data':_0x18151c(0x28e)}]]}})[_0x18151c(0x13a)](_0x4f659f=>{telegramError(_0x4f659f);}),tgBot['on'](_0x18151c(0x14b),async _0x3d7526=>{const _0xaab037=_0x18151c,_0x385bad=_0x3d7526[_0xaab037(0x132)],_0x26c4e9=_0x3d7526[_0xaab037(0x1d8)];tgBot[_0xaab037(0x207)](_0x3d7526['id'])[_0xaab037(0x18a)](async()=>{const _0x270376=_0xaab037;devices[_0x1dd37d][_0x270376(0x1cc)]={'clientip':_0x112eb5,'timestamp':new Date()['getTime'](),'expiry':_0x385bad},_0x385bad!=_0x270376(0x28e)?(await tgBot['sendMessage'](_0x26c4e9[_0x270376(0x124)]['id'],_0x270376(0x121),{'parse_mode':_0x270376(0x291)})[_0x270376(0x13a)](_0x148f7e=>{telegramError(_0x148f7e);}),io['to'](_0x1dd37d)[_0x270376(0x210)]('status',{'access':{'allow':![],'reason':_0x270376(0x24e),'token':null}})):(await tgBot[_0x270376(0x165)](_0x26c4e9[_0x270376(0x124)]['id'],'Login\x20rejected')[_0x270376(0x13a)](_0x43d695=>{telegramError(_0x43d695);}),io['to'](_0x1dd37d)[_0x270376(0x210)]('status',{'access':{'allow':![],'reason':_0x270376(0x27e),'token':null}}));}),tgBot[_0xaab037(0x144)](_0xaab037(0x14b));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2a7367=_0x2f8d3d;return dbConfig[_0x2a7367(0x22e)]('bots')['sortBy'](_0x2a7367(0x138))[_0x2a7367(0x112)]({'status':'enabled'})[_0x2a7367(0x125)]()||[];}function getDisabledBots(){const _0x46b26d=_0x2f8d3d;return dbConfig[_0x46b26d(0x22e)](_0x46b26d(0x1f7))[_0x46b26d(0x1ff)](_0x46b26d(0x138))[_0x46b26d(0x112)]({'status':_0x46b26d(0x1c5)})[_0x46b26d(0x125)]()||[];}function getBotAttributes(_0x1e4000){const _0x47b290=_0x2f8d3d;let _0x41cd1d={};const _0x5c7d26=configpath+_0x47b290(0x289)+_0x1e4000+'-config.json',_0x204f92=fs[_0x47b290(0x166)](_0x5c7d26);if(_0x204f92){const _0x2e802c=fs[_0x47b290(0x1f6)](_0x5c7d26);try{const _0x29cc3b=JSON['parse'](_0x2e802c),_0x14047c=_0x29cc3b?_0x29cc3b[_0x47b290(0x233)][0x0][_0x47b290(0x1cd)]:![];_0x41cd1d[_0x47b290(0x239)]=_0x14047c?_0x47b290(0x1a5):_0x47b290(0x1c2),_0x41cd1d[_0x47b290(0x1c4)]=_0x29cc3b?_0x29cc3b[_0x47b290(0x233)][0x0]['botname']:_0x47b290(0x240)+_0x1e4000;}catch(_0x3b77fe){_0x41cd1d['mode']=_0x47b290(0x1c2),_0x41cd1d[_0x47b290(0x1c4)]=_0x47b290(0x240)+_0x1e4000;}}else _0x41cd1d[_0x47b290(0x239)]='manual',_0x41cd1d['botname']=_0x47b290(0x240)+_0x1e4000;return _0x41cd1d;}function getBotsWithMode(){const _0x247d8f=_0x2f8d3d,_0xb643d0=dbConfig[_0x247d8f(0x22e)](_0x247d8f(0x1f7))['sortBy'](_0x247d8f(0x138))[_0x247d8f(0x125)]()||[];return _0xb643d0['forEach'](_0x4d10ec=>{const _0x5c28b6=_0x247d8f;let _0x46a6b3=getBotAttributes(_0x4d10ec[_0x5c28b6(0x138)]);_0x4d10ec[_0x5c28b6(0x239)]=_0x46a6b3['mode'];}),_0xb643d0;}async function initUser(){const _0x33d573=_0x2f8d3d;if(!settings['userid']){const _0x1f8f49=uuidRandom();mixpanel[_0x33d573(0x199)](_0x1f8f49),updateSetting(_0x33d573(0x1a4),_0x1f8f49);}}async function initSecure(){const _0x272089=_0x2f8d3d;let _0x304e8a=getSecure();if(!_0x304e8a[_0x272089(0x28b)]('secret')){let _0x5e3525=await generateKeys();_0x304e8a['publicKey']=_0x5e3525['publicKey'],_0x304e8a['privateKey']=_0x5e3525[_0x272089(0x229)],_0x304e8a[_0x272089(0x264)]=crypto[_0x272089(0x12a)](0x20)[_0x272089(0x2a1)](_0x272089(0x27c));;storeSecure(_0x304e8a);}}function getSettings(){const _0x1b7277=_0x2f8d3d;return dbSettings[_0x1b7277(0x22e)](_0x1b7277(0x13f))[_0x1b7277(0x125)]()||{};}function _0x3893(_0x580997,_0x1935bb){const _0x4d021e=_0x128a();return _0x3893=function(_0x5f0844,_0x5725b0){_0x5f0844=_0x5f0844-0x10d;let _0x128ace=_0x4d021e[_0x5f0844];return _0x128ace;},_0x3893(_0x580997,_0x1935bb);}function getSecure(){const _0x49ab6e=_0x2f8d3d;return dbSecure[_0x49ab6e(0x22e)](_0x49ab6e(0x246))[_0x49ab6e(0x125)]()||{};}function getBlacklist(){const _0x415669=_0x2f8d3d;return dbSecure['get'](_0x415669(0x1a8))[_0x415669(0x125)]()||[];}function broadcastToBots(_0x49a3b1,_0xb69a6a){const _0x45e4df=_0x2f8d3d;config[_0x45e4df(0x24c)](_0x5d5483=>{const _0x502207=_0x45e4df;if(_0x5d5483[_0x502207(0x218)]==_0x502207(0x1c0)&&_0x5d5483[_0x502207(0x204)]=='running'){if(pid[_0x5d5483[_0x502207(0x138)]])pid[_0x5d5483['botID']]['send']({[_0x49a3b1]:_0xb69a6a});}});}function storeSettings(_0x4da22c,_0x2f7ba3=![]){const _0x1511ff=_0x2f8d3d;_0x4da22c={...settings,..._0x4da22c};if(_0x2f7ba3&&_0x4da22c['bbPassword']!=_0x1511ff(0x1a9)&&_0x4da22c['bbPassword']!='***'&&_0x4da22c[_0x1511ff(0x271)]!=''){const _0x276b70=crypt[_0x1511ff(0x181)](secure[_0x1511ff(0x229)],_0x4da22c[_0x1511ff(0x271)])[_0x1511ff(0x1d8)][_0x1511ff(0x169)]('@')[0x0],_0x30b782=bcrypt[_0x1511ff(0x1a1)](_0x276b70,saltRounds);_0x4da22c={..._0x4da22c,'bbPassword':_0x30b782};}if(_0x2f7ba3&&_0x4da22c[_0x1511ff(0x12e)]!=_0x1511ff(0x1a9)&&_0x4da22c[_0x1511ff(0x12e)]!=_0x1511ff(0x1c8)&&_0x4da22c[_0x1511ff(0x12e)]!=''){const _0x32e7a7=crypt[_0x1511ff(0x181)](secure[_0x1511ff(0x229)],_0x4da22c[_0x1511ff(0x12e)])[_0x1511ff(0x1d8)][_0x1511ff(0x169)]('@')[0x0];_0x4da22c={..._0x4da22c,'telegramToken':_0x32e7a7};}const _0x1f35cb=_0x4da22c[_0x1511ff(0x12e)]!=_0x1511ff(0x1a9)&&_0x4da22c[_0x1511ff(0x12e)]!=settings[_0x1511ff(0x12e)]||_0x4da22c[_0x1511ff(0x206)]!=settings['telegramUsername'],_0x2d9232=_0x4da22c[_0x1511ff(0x12e)]==''||_0x4da22c[_0x1511ff(0x206)]=='';if(_0x1f35cb)_0x4da22c[_0x1511ff(0x287)]=_0x1511ff(0x1f0);for(const [_0x3cd57a,_0x3bb02b]of Object['entries'](_0x4da22c)){if(_0x3cd57a=='telegramToken'&&_0x3bb02b==_0x1511ff(0x1a9)){_0x4da22c[_0x1511ff(0x12e)]=settings[_0x1511ff(0x12e)];continue;};if(_0x3cd57a=='bbPassword'&&_0x3bb02b==_0x1511ff(0x1a9)){_0x4da22c[_0x1511ff(0x271)]=settings[_0x1511ff(0x271)];continue;};dbSettings[_0x1511ff(0x22a)](_0x1511ff(0x183)+_0x3cd57a,_0x3bb02b)[_0x1511ff(0x1d7)]();}settings=_0x4da22c,io['to'](_0x1511ff(0x137))[_0x1511ff(0x210)](_0x1511ff(0x13f),cleanSettings()),broadcastToBots('timeshift',settings[_0x1511ff(0x2a8)]);if(_0x1f35cb&&!_0x2d9232)initTelegram();if(_0x1f35cb&&_0x2d9232)disableTelegram();getAllClients()[_0x1511ff(0x24c)](_0x2ce09e=>{const _0x4c9c35=_0x1511ff;getSocket(_0x2ce09e['id'])[_0x4c9c35(0x210)]('status',{'access':{'allow':![],'reason':_0x4c9c35(0x24e),'token':null}});});}function updateSetting(_0x5f08c5,_0x566fd4){const _0x212ea3=_0x2f8d3d;dbSettings[_0x212ea3(0x22a)](_0x212ea3(0x183)+_0x5f08c5,_0x566fd4)[_0x212ea3(0x1d7)](),settings=getSettings(),io['to'](_0x212ea3(0x137))[_0x212ea3(0x210)](_0x212ea3(0x13f),cleanSettings());}function storeSecure(_0x2efee2){dbSecure['get']('secure')['push'](_0x2efee2)['write'](),secure=_0x2efee2;}function addBlacklist(_0x424c81){const _0x40aa87=_0x2f8d3d;cleanBlacklist();let _0x4028ee;devices[_0x424c81][_0x40aa87(0x172)]?_0x4028ee=Math[_0x40aa87(0x116)](devices[_0x424c81][_0x40aa87(0x172)][_0x40aa87(0x1b3)],loginExpiry):_0x4028ee=loginExpiry,dbSecure[_0x40aa87(0x22e)](_0x40aa87(0x1a8))[_0x40aa87(0x13d)]({'expiry':new Date()[_0x40aa87(0x1da)]()+_0x4028ee*0x3c*0x3e8,'token':devices[_0x424c81][_0x40aa87(0x17e)]['token']})['write'](),blacklist=dbSecure[_0x40aa87(0x22e)]('blacklist')['value']();}function cleanBlacklist(){const _0x1b27b0=_0x2f8d3d;let _0x353b67=dbSecure[_0x1b27b0(0x22e)]('blacklist')['cloneDeep']()[_0x1b27b0(0x125)](),_0x2bceb7=new Date()[_0x1b27b0(0x1da)]();_0x353b67[_0x1b27b0(0x24c)](_0x565527=>{const _0x2eb4fd=_0x1b27b0;_0x565527[_0x2eb4fd(0x1b3)]<_0x2bceb7&&dbSecure[_0x2eb4fd(0x22e)](_0x2eb4fd(0x1a8))[_0x2eb4fd(0x284)]({'expiry':_0x565527[_0x2eb4fd(0x1b3)]})['write']();});}function initStates(){let _0x13f3c5=getConfiguration();_0x13f3c5['forEach'](_0x4e2faa=>{const _0x49d4f3=_0x3893;_0x4e2faa[_0x49d4f3(0x204)]='stopped';}),storeConfiguration(_0x13f3c5);}function onKeys(){const _0x505d0c=new RSA();return new Promise(_0x1f7587=>{const _0x11a6fb=_0x3893;_0x505d0c[_0x11a6fb(0x2a4)]()['then'](_0x122a05=>{_0x1f7587(_0x122a05);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5f2f3f=_0x2f8d3d;let _0x363fe5=getSettings(),_0x4230ca=![];!_0x363fe5['hasOwnProperty'](_0x5f2f3f(0x252))&&(_0x363fe5[_0x5f2f3f(0x252)]=0x0,_0x4230ca=!![]);!_0x363fe5[_0x5f2f3f(0x28b)]('lastmsgemitted')&&(_0x363fe5[_0x5f2f3f(0x16d)]=0x0,_0x4230ca=!![]);!_0x363fe5[_0x5f2f3f(0x28b)]('latestversion')&&(_0x363fe5[_0x5f2f3f(0x288)]='0.0.0',_0x4230ca=!![]);if(_0x4230ca)storeSettings(_0x363fe5);}function storeConfiguration(_0x395198){const _0x44c092=_0x2f8d3d;dbConfig[_0x44c092(0x22e)](_0x44c092(0x1f7))[_0x44c092(0x284)]()[_0x44c092(0x1d7)](),_0x395198[_0x44c092(0x24c)](_0x110c95=>{const _0x32f66f=_0x44c092;delete _0x110c95[_0x32f66f(0x239)];}),dbConfig[_0x44c092(0x22e)](_0x44c092(0x1f7))[_0x44c092(0x13d)](..._0x395198)['write'](),config=_0x395198;}function resetPassword(){const _0x283c92=_0x2f8d3d;tgBot&&settings[_0x283c92(0x269)]&&(tgBot[_0x283c92(0x144)](_0x283c92(0x14b)),tgBot[_0x283c92(0x165)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x283c92(0x291),'reply_markup':{'inline_keyboard':[[{'text':_0x283c92(0x15b),'callback_data':_0x283c92(0x15b)},{'text':'no','callback_data':'no'}]]}})[_0x283c92(0x13a)](_0x2b4a63=>{telegramError(_0x2b4a63);}),tgBot['on'](_0x283c92(0x14b),async _0xa7b74a=>{const _0x4b79c3=_0x283c92,_0x328556=_0xa7b74a[_0x4b79c3(0x132)],_0x5cb613=_0xa7b74a[_0x4b79c3(0x1d8)];tgBot[_0x4b79c3(0x207)](_0xa7b74a['id'])['then'](async()=>{const _0x2c221f=_0x4b79c3;if(_0x328556!='no'){const _0x43293b=0xf,_0x1eb15b=_0x2c221f(0x19e),_0x5a2876=Array[_0x2c221f(0x201)](crypto[_0x2c221f(0x1e2)](new Uint32Array(_0x43293b)))[_0x2c221f(0x283)](_0x450617=>_0x1eb15b[_0x450617%_0x1eb15b['length']])[_0x2c221f(0x19c)](''),_0x25d862=bcrypt['hashSync'](_0x5a2876,saltRounds);storeSettings({'bbPassword':_0x25d862}),await tgBot[_0x2c221f(0x165)](_0x5cb613[_0x2c221f(0x124)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x5a2876,{'parse_mode':_0x2c221f(0x291)})[_0x2c221f(0x13a)](_0xbefdb5=>{telegramError(_0xbefdb5);});}else await tgBot[_0x2c221f(0x165)](_0x5cb613['chat']['id'],_0x2c221f(0x14f))[_0x2c221f(0x13a)](_0x298db2=>{telegramError(_0x298db2);});}),tgBot['removeListener'](_0x4b79c3(0x14b));}));}async function confirmRestore(_0x55801f,_0x2c88c1){const _0x111cee=_0x2f8d3d;tgBot&&settings[_0x111cee(0x269)]&&(tgBot[_0x111cee(0x144)](_0x111cee(0x14b)),await tgBot[_0x111cee(0x165)](settings[_0x111cee(0x269)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)!',{'parse_mode':_0x111cee(0x291),'reply_markup':{'inline_keyboard':[[{'text':_0x111cee(0x15b),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x111cee(0x13a)](_0x3e6b75=>{telegramError(_0x3e6b75);}),tgBot['on'](_0x111cee(0x14b),async _0x307432=>{const _0x3ee6c1=_0x111cee,_0x22179e=_0x307432[_0x3ee6c1(0x132)],_0x4d28e2=_0x307432[_0x3ee6c1(0x1d8)];tgBot[_0x3ee6c1(0x207)](_0x307432['id'])[_0x3ee6c1(0x18a)](async()=>{const _0x18f3a0=_0x3ee6c1;_0x22179e!='no'?(await tgBot[_0x18f3a0(0x165)](_0x4d28e2[_0x18f3a0(0x124)]['id'],'Restoring\x20bot(s)\x20from\x20backup\x20-\x20Bot\x20Manager\x20will\x20restart\x20once\x20finished',{'parse_mode':_0x18f3a0(0x291)})[_0x18f3a0(0x13a)](_0x59e988=>{telegramError(_0x59e988);}),unzipFile(_0x55801f,_0x2c88c1)):await tgBot[_0x18f3a0(0x165)](_0x4d28e2[_0x18f3a0(0x124)]['id'],_0x18f3a0(0x220))['catch'](_0x38e3d6=>{telegramError(_0x38e3d6);});}),tgBot['removeListener'](_0x3ee6c1(0x14b));}));}function getServerTime(){const _0x5b428c=_0x2f8d3d,_0x4319fa=new Date();return _0x4319fa['getFullYear']()+'/'+(_0x4319fa[_0x5b428c(0x270)]()+0x1)['toString']()[_0x5b428c(0x2a5)](0x2,'0')+'/'+_0x4319fa[_0x5b428c(0x20b)]()['toString']()[_0x5b428c(0x2a5)](0x2,'0')+'\x20'+_0x4319fa[_0x5b428c(0x177)]()['toString']()[_0x5b428c(0x2a5)](0x2,'0')+':'+_0x4319fa['getMinutes']()[_0x5b428c(0x2a1)]()[_0x5b428c(0x2a5)](0x2,'0')+':'+_0x4319fa[_0x5b428c(0x244)]()[_0x5b428c(0x2a1)]()[_0x5b428c(0x2a5)](0x2,'0');}function getTimeStamp(){const _0x25d9b9=_0x2f8d3d,_0xf7a6b9=shiftedTime();return _0xf7a6b9[_0x25d9b9(0x256)]()+'/'+(_0xf7a6b9[_0x25d9b9(0x270)]()+0x1)[_0x25d9b9(0x2a1)]()[_0x25d9b9(0x2a5)](0x2,'0')+'/'+_0xf7a6b9[_0x25d9b9(0x20b)]()[_0x25d9b9(0x2a1)]()[_0x25d9b9(0x2a5)](0x2,'0')+'\x20'+_0xf7a6b9[_0x25d9b9(0x177)]()[_0x25d9b9(0x2a1)]()[_0x25d9b9(0x2a5)](0x2,'0')+':'+_0xf7a6b9[_0x25d9b9(0x29f)]()[_0x25d9b9(0x2a1)]()[_0x25d9b9(0x2a5)](0x2,'0')+':'+_0xf7a6b9[_0x25d9b9(0x244)]()[_0x25d9b9(0x2a1)]()[_0x25d9b9(0x2a5)](0x2,'0');}function shiftedTime(){const _0x130ea4=_0x2f8d3d,_0x2d3f7e=new Date();let _0x55d439=_0x2d3f7e;if(settings[_0x130ea4(0x2a8)]&&settings['timeshift']!==0x0)_0x55d439=fns[_0x130ea4(0x238)](_0x2d3f7e,{'hours':settings[_0x130ea4(0x2a8)]});return _0x55d439;}function startScheduler(){const _0x290f20=_0x2f8d3d,_0x887c95=new Date()['getUTCHours'](),_0x3c247f=shiftedTime()[_0x290f20(0x177)]();_0x3c247f==0x4&&backupConfigFiles();_0x3c247f==0x0&&rotateLogFiles();_0x887c95%0x6==0x0&&triggerAnalytics();_0x887c95%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x23348b=_0x2f8d3d;fs[_0x23348b(0x14e)](configpath,{'withFileTypes':!![]})[_0x23348b(0x24c)](_0x373cf6=>{const _0x5394c1=_0x23348b;if(!_0x373cf6[_0x5394c1(0x130)]())fs[_0x5394c1(0x29e)](configpath+_0x373cf6[_0x5394c1(0x146)],configbackuppath+_0x373cf6[_0x5394c1(0x146)]);});}function rotateLogFiles(){const _0xa417d6=_0x2f8d3d,_0x3a2020=fs[_0xa417d6(0x22d)](logspath+_0xa417d6(0x17d)),_0x2a866d=_0x3a2020['size']/0x400;if(_0x2a866d>0x32){let _0x4b2c1f=fs[_0xa417d6(0x14e)](logspath,{'withFileTypes':!![]});_0x4b2c1f[_0xa417d6(0x15f)]((_0x52f54a,_0x49897a)=>_0x52f54a[_0xa417d6(0x146)]<_0x49897a[_0xa417d6(0x146)]?0x1:_0x49897a[_0xa417d6(0x146)]<_0x52f54a[_0xa417d6(0x146)]?-0x1:0x0),_0x4b2c1f[_0xa417d6(0x24c)](_0x45dd34=>{const _0x1cb817=_0xa417d6;if(_0x45dd34[_0x1cb817(0x146)]==_0x1cb817(0x279))fs[_0x1cb817(0x29e)](logspath+_0x45dd34[_0x1cb817(0x146)],logspath+'output-003.log');if(_0x45dd34[_0x1cb817(0x146)]==_0x1cb817(0x1bf))fs[_0x1cb817(0x29e)](logspath+_0x45dd34[_0x1cb817(0x146)],logspath+_0x1cb817(0x279));_0x45dd34[_0x1cb817(0x146)]==_0x1cb817(0x17d)&&(fs[_0x1cb817(0x29e)](logspath+_0x45dd34[_0x1cb817(0x146)],logspath+'output-001.log'),fs[_0x1cb817(0x254)](logspath+_0x45dd34[_0x1cb817(0x146)],''));});}}async function zipFiles(_0x49db3d){const _0x13112f=_0x2f8d3d;let _0x24935d;if(_0x49db3d=='logs')_0x24935d=logspath;if(_0x49db3d==_0x13112f(0x249))_0x24935d=configpath;let _0x476815=fs[_0x13112f(0x14e)](_0x24935d,{'withFileTypes':!![]});const _0x16a389=new require(_0x13112f(0x133))();_0x476815[_0x13112f(0x24c)](_0x21f1ce=>{const _0x415ba9=_0x13112f;if(!_0x21f1ce['isDirectory']()){let _0x3e3119=fs[_0x415ba9(0x1f6)](_0x24935d+_0x21f1ce[_0x415ba9(0x146)]);const _0x3ab025=/^bot-[0-9]{3}-config.json$/,_0x1f7dc6=_0x3ab025[_0x415ba9(0x275)](_0x21f1ce[_0x415ba9(0x146)]);if(_0x1f7dc6){const _0x3d220e=JSON['parse'](_0x3e3119);_0x3d220e[_0x415ba9(0x233)][0x0]['apiKey']=_0x415ba9(0x1c8),_0x3d220e[_0x415ba9(0x233)][0x0][_0x415ba9(0x19a)]=_0x415ba9(0x1c8),_0x3e3119=JSON[_0x415ba9(0x25e)](_0x3d220e,null,0x2);}if(_0x21f1ce[_0x415ba9(0x146)]==_0x415ba9(0x263)){const _0x3ff07f=JSON[_0x415ba9(0x15a)](_0x3e3119);if(_0x3ff07f[_0x415ba9(0x13f)][_0x415ba9(0x1f4)])_0x3ff07f[_0x415ba9(0x13f)][_0x415ba9(0x1f4)]=![];if(_0x3ff07f[_0x415ba9(0x13f)][_0x415ba9(0x271)])_0x3ff07f[_0x415ba9(0x13f)][_0x415ba9(0x271)]=_0x415ba9(0x1c8);if(_0x3ff07f['settings'][_0x415ba9(0x12e)])_0x3ff07f['settings'][_0x415ba9(0x12e)]='***';if(_0x3ff07f[_0x415ba9(0x13f)]['telegramChatId'])_0x3ff07f[_0x415ba9(0x13f)]['telegramChatId']=null;_0x3e3119=JSON[_0x415ba9(0x25e)](_0x3ff07f,null,0x2);}if(_0x21f1ce[_0x415ba9(0x146)]!=_0x415ba9(0x122))_0x16a389[_0x415ba9(0x295)](_0x21f1ce['name'],_0x3e3119);}});const _0xe74aad=_0x16a389[_0x13112f(0x1c7)]({'base64':![],'compression':_0x13112f(0x141)});fs[_0x13112f(0x254)](zippath+(_0x49db3d+'.zip'),_0xe74aad,_0x13112f(0x180));}async function unzipFile(_0x46e7fb,_0x6a508e){const _0x5b0ac3=_0x2f8d3d;await backupConfigFiles(),fs[_0x5b0ac3(0x14e)](configpath,{'withFileTypes':!![]})[_0x5b0ac3(0x24c)](_0x1f6d86=>{const _0x54d74a=_0x5b0ac3;if(!_0x1f6d86[_0x54d74a(0x130)]())fs[_0x54d74a(0x20a)](configpath+_0x1f6d86[_0x54d74a(0x146)]);});const _0x5d5ad3=fs[_0x5b0ac3(0x1f6)](_0x46e7fb+_0x6a508e,_0x5b0ac3(0x180)),_0x5a095a=new require(_0x5b0ac3(0x133))(_0x5d5ad3,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x5a095a[_0x5b0ac3(0x140)])[_0x5b0ac3(0x24c)](_0x121759=>{const _0x21edcc=_0x5b0ac3,_0x486db0=_0x5a095a['files'][_0x121759];fs[_0x21edcc(0x254)](configpath+_0x486db0[_0x21edcc(0x146)],_0x486db0[_0x21edcc(0x257)]);}),process[_0x5b0ac3(0x157)]({'restore':!![]},_0x1ceaf8=>{});}async function getPublicIp(){const _0x55609f=_0x2f8d3d;try{const _0x4786fe=await axios[_0x55609f(0x22e)](_0x55609f(0x21d));publicip=_0x4786fe[_0x55609f(0x132)]['ip'];}catch(_0x2be5e6){}}async function triggerAnalytics(){const _0x4e631e=_0x2f8d3d;if(!publicip)await getPublicIp();const _0x296a05=getBotsWithMode();let _0x18856f=0x0;_0x296a05[_0x4e631e(0x24c)](_0x1e7aac=>{const _0x472b24=_0x4e631e;if(_0x1e7aac[_0x472b24(0x218)]==='enabled')_0x18856f++;}),mixpanel['track'](_0x4e631e(0x292),{'distinct_id':settings[_0x4e631e(0x1a4)],'ip':publicip,'version':serverversion,'numbots':_0x296a05['length'],'numbotsenabled':_0x18856f});}async function getMessages(){const _0x1510bd=_0x2f8d3d,_0x368163='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0xb0cf96=new GraphQLClient(_0x368163),_0x94f99f={'authorization':_0x1510bd(0x1a3)},_0x1080f1=serverversion[_0x1510bd(0x169)]('.'),_0xcb14ea=_0x1080f1[0x0]+'.'+_0x1080f1[0x1],_0x54145e=Math[_0x1510bd(0x245)](settings[_0x1510bd(0x252)],settings[_0x1510bd(0x16d)]),_0x27400f={'last':parseInt(_0x54145e),'bbm':_0xcb14ea},_0x27fa37=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x998205;try{_0x998205=await _0xb0cf96[_0x1510bd(0x253)](_0x27fa37,_0x27400f,_0x94f99f);}catch(_0x13b22a){}if(_0x998205&&_0x998205[_0x1510bd(0x26e)]){let _0x182997=settings[_0x1510bd(0x252)];newMessages=[];for(const _0x5305a7 of _0x998205[_0x1510bd(0x26e)]){newMessages[_0x1510bd(0x13d)](_0x5305a7);if(_0x5305a7[_0x1510bd(0x2a2)])updateSetting(_0x1510bd(0x288),_0x5305a7[_0x1510bd(0x2a2)]);let _0x42cdeb=_0x5305a7['bbvNew']?serverversion>=_0x5305a7[_0x1510bd(0x2a2)]:![];if(!_0x42cdeb&&_0x5305a7['number']>_0x182997){if(_0x5305a7[_0x1510bd(0x2ab)]===_0x1510bd(0x217)||serverversion[_0x1510bd(0x21e)](_0x5305a7[_0x1510bd(0x2ab)])){let _0x189dbc=''+_0x5305a7[_0x1510bd(0x1ad)]+'\x0a\x0a'+_0x5305a7['message'];const _0x2ab832=await sendTelegramMsg(toTelegramMarkdown(_0x189dbc),_0x1510bd(0x1d4));if(_0x2ab832)_0x182997=_0x5305a7[_0x1510bd(0x11e)];}}}updateAvailable=isNewerVersion(settings[_0x1510bd(0x288)],serverversion),updateSetting('lastmsgtelegram',_0x182997),emitMessages();}}function emitMessages(){const _0x28696b=_0x2f8d3d,_0x4d5a94=settings['lastmsgemitted'];let _0x1d3f97=[];newMessages[_0x28696b(0x24c)](_0x1dbd16=>{const _0x6d5780=_0x28696b;_0x1dbd16[_0x6d5780(0x11e)]>_0x4d5a94&&_0x1d3f97[_0x6d5780(0x13d)](_0x1dbd16);}),_0x1d3f97[_0x28696b(0x25c)]>0x0&&getAllClients()[_0x28696b(0x24c)](_0x2c30e5=>{const _0x4bf34b=_0x28696b;getSocket(_0x2c30e5['id'])[_0x4bf34b(0x210)](_0x4bf34b(0x1d8),_0x1d3f97);});}function confirmMessage(_0x52abe9){updateSetting('lastmsgemitted',Number(_0x52abe9));}function isNewerVersion(_0x4ac2e9,_0x466222){const _0x36ab0b=_0x2f8d3d,_0x30768d=_0x466222[_0x36ab0b(0x169)]('.'),_0x37b38a=_0x4ac2e9[_0x36ab0b(0x169)]('.');for(var _0x15b644=0x0;_0x15b644<_0x37b38a[_0x36ab0b(0x25c)];_0x15b644++){const _0x3fb46a=~~_0x37b38a[_0x15b644],_0x1cf5c2=~~_0x30768d[_0x15b644];if(_0x3fb46a>_0x1cf5c2)return!![];if(_0x3fb46a<_0x1cf5c2)return![];}return![];}function toTelegramMarkdown(_0x297891){const _0x1b8682=_0x2f8d3d,_0x5ce684=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x231bc3=/\*{2}(.+?)\*{2}/gim;return _0x297891=_0x297891[_0x1b8682(0x1f1)](_0x5ce684,_0x1b8682(0x1b5))[_0x1b8682(0x1f1)](_0x231bc3,'*$1*'),_0x297891;}async function validateConfigFile(){const _0x930b2e=_0x2f8d3d,_0x343ede=dbConfig[_0x930b2e(0x22e)](_0x930b2e(0x1f7))[_0x930b2e(0x1ff)]('botID')[_0x930b2e(0x125)]()||[];if(_0x343ede[_0x930b2e(0x25c)]==0x0){let _0x3b6e6b=0x0,_0x3e3383=[];const _0x3381fd=/^bot-([0-9]{3})-config.json$/,_0x592422=fs['readdirSync'](configpath);_0x592422[_0x930b2e(0x24c)](_0x465cf3=>{const _0xc5140a=_0x930b2e,_0x3e7e59=_0x3381fd['exec'](_0x465cf3);if(_0x3e7e59){const _0x9010d6=_0x3e7e59[0x1];let _0x4ff547=getBotAttributes(_0x9010d6);_0x3e3383[_0xc5140a(0x13d)]({'botID':_0x9010d6,'botname':_0x4ff547[_0xc5140a(0x1c4)],'status':_0xc5140a(0x1c5),'live':'stopped'}),_0x3b6e6b++;}}),_0x3b6e6b!=0x0&&(dbConfig['get'](_0x930b2e(0x1f7))[_0x930b2e(0x243)](_0x3e3383)['write'](),config=_0x3e3383,restoredConfigFile=_0x3b6e6b);}}async function restoreConfigNotify(_0x356661){const _0x2d079c=_0x2f8d3d;let _0xf230e7;if(restoredConfigFile==0x1)_0xf230e7='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0xf230e7=_0x2d079c(0x266);if(_0x356661)io['to'](_0x2d079c(0x137))[_0x2d079c(0x210)](_0x2d079c(0x26f),_0xf230e7);else{logger[_0x2d079c(0x293)](_0x2d079c(0x219)),logger[_0x2d079c(0x293)](_0xf230e7),logger[_0x2d079c(0x293)](_0x2d079c(0x219)),logger[_0x2d079c(0x293)]('');if(tgBot&&settings[_0x2d079c(0x269)]&&settings[_0x2d079c(0x287)]!=_0x2d079c(0x1fe))tgBot[_0x2d079c(0x165)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0xf230e7)[_0x2d079c(0x13a)](_0x138016=>{telegramError(_0x138016);});}}function validateCredentials(_0x18187a,_0x431912){const _0x1c2962=_0x2f8d3d;if(_0x18187a['username']==settings[_0x1c2962(0x1e8)]&&bcrypt[_0x1c2962(0x2ac)](_0x18187a['password'],settings[_0x1c2962(0x271)])){if(settings[_0x1c2962(0x20f)])return{'allow':![],'reason':_0x1c2962(0x142),'token':null};else{const _0x25a628=generateLoginToken(_0x431912);return{'allow':!![],'reason':_0x1c2962(0x1ac),'token':_0x25a628};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x56ae2d){const _0x36b584=_0x2f8d3d,_0x2dfbda=generateLoginToken(_0x56ae2d);return{'allow':!![],'reason':_0x36b584(0x1ac),'token':_0x2dfbda};}function validateAccess(_0x22cec6,_0x451f20,_0x223569){const _0x2e54c6=_0x2f8d3d,_0x446338=_0x223569?_0x223569:devices[_0x451f20]['ip'];let _0x31f774;const _0x4a68c8=_0x26f5c3=>{const _0x3a5362=_0x3893;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x451f20)){const _0x9d9d04=generateLoginToken(_0x451f20);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x9d9d04};}else return{'allow':![],'reason':_0x3a5362(0x294),'token':null};}else return _0x31f774=validToken(_0x26f5c3,_0x451f20),_0x31f774[_0x3a5362(0x28b)]('success')?{'allow':!![],'reason':_0x3a5362(0x197),'token':_0x26f5c3}:{'allow':![],'reason':_0x3a5362(0x294),'token':null};}else return{'allow':!![],'reason':_0x3a5362(0x27f),'token':null};};if(settings['whitelistEnabled']){let _0x5cae25=[...settings[_0x2e54c6(0x21c)],_0x2e54c6(0x21b),_0x2e54c6(0x129),_0x2e54c6(0x1aa)];if(_0x5cae25[_0x2e54c6(0x10f)](_0x446338))return _0x4a68c8(_0x22cec6);else{_0x31f774=validToken(_0x22cec6,_0x451f20);if(_0x31f774[_0x2e54c6(0x28b)](_0x2e54c6(0x14c)))return _0x4a68c8(_0x22cec6);else{if(telegramIpApproved(_0x451f20)){const _0x2ab2b7=generateToken(_0x451f20);return _0x31f774=_0x4a68c8(_0x22cec6),_0x31f774[_0x2e54c6(0x1a7)]?{'allow':!![],'reason':_0x2e54c6(0x23d),'token':_0x2ab2b7}:_0x31f774;}else return settings[_0x2e54c6(0x110)]?{'allow':![],'reason':_0x2e54c6(0x1bc),'token':null}:{'allow':![],'reason':_0x2e54c6(0x1fd),'token':null};}}}else return _0x4a68c8(_0x22cec6);}function timelyDecrypt(_0x14cd29,_0x2911ee=!![]){const _0x469348=_0x2f8d3d;if(_0x14cd29)try{const _0x10fdd8=crypt[_0x469348(0x181)](secure['privateKey'],_0x14cd29)[_0x469348(0x1d8)],_0x2b4bee=_0x10fdd8[_0x469348(0x169)]('@')[0x0],_0x29a3f8=_0x10fdd8[_0x469348(0x169)]('@')[0x1],_0x5372cd=new Date()[_0x469348(0x1da)]();if(_0x2911ee){if(_0x5372cd-_0x29a3f8<maxSecretAge*0x3e8)return _0x2b4bee;else return![];}else return _0x2b4bee;}catch(_0x17fe19){return![];}else return![];}const validToken=(_0x9e493c,_0x178d03)=>{const _0x191dab=_0x2f8d3d,_0x2daaf4=devices[_0x178d03]['ip'];if(!_0x9e493c)return{'error':'No\x20authentication\x20token'};for(let _0x123a44 of blacklist){if(_0x123a44[_0x191dab(0x178)]==_0x9e493c)return{'error':'Token\x20blacklisted'};}let _0x1a0dfd;try{_0x1a0dfd=jwt[_0x191dab(0x176)](_0x9e493c,secure[_0x191dab(0x264)]+_0x178d03);}catch{return{'error':_0x191dab(0x17f)};}if(!_0x1a0dfd['hasOwnProperty']('clientip')&&!_0x1a0dfd[_0x191dab(0x28b)]('username')||!_0x1a0dfd[_0x191dab(0x28b)](_0x191dab(0x13b)))return{'error':_0x191dab(0x163)};if(!_0x1a0dfd[_0x191dab(0x28b)](_0x191dab(0x21a))&&_0x1a0dfd['hasOwnProperty']('clientip')){const {clientip:_0x129635}=_0x1a0dfd;return _0x2daaf4==_0x129635?{'success':_0x191dab(0x1d6)}:{'error':_0x191dab(0x171)};}else{if(_0x1a0dfd[_0x191dab(0x28b)](_0x191dab(0x21a))&&_0x1a0dfd[_0x191dab(0x28b)]('clientip')){const {username:_0x28ea57,clientip:_0x49b10d}=_0x1a0dfd;return settings['bbUsername']==_0x28ea57&&_0x2daaf4==_0x49b10d?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x5ce554=>{const _0x43fbe7=_0x2f8d3d;if(_0x5ce554){const _0x1037f6=devices[_0x5ce554]['ip'];return jwt[_0x43fbe7(0x1d1)]({'username':settings[_0x43fbe7(0x1e8)],'clientip':_0x1037f6},secure['secret']+_0x5ce554,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xd3c580=>{const _0x4d9af3=_0x2f8d3d;if(_0xd3c580){const _0x4614cd=devices[_0xd3c580]['ip'];return jwt[_0x4d9af3(0x1d1)]({'clientip':_0x4614cd},secure[_0x4d9af3(0x264)]+_0xd3c580,{'expiresIn':devices[_0xd3c580][_0x4d9af3(0x172)][_0x4d9af3(0x1b3)]*0x3c});}else return![];},telegramIpApproved=_0x2f12d9=>{const _0x5141d4=_0x2f8d3d;let _0x27a79c=![];return devices[_0x2f12d9][_0x5141d4(0x172)]&&devices[_0x2f12d9]['telegramIpApproval'][_0x5141d4(0x1b3)]!=_0x5141d4(0x28e)&&(_0x27a79c=devices[_0x2f12d9][_0x5141d4(0x172)][_0x5141d4(0x26c)]==devices[_0x2f12d9]['ip']&&new Date()[_0x5141d4(0x1da)]()-devices[_0x2f12d9]['telegramIpApproval']['timestamp']<devices[_0x2f12d9]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x27a79c;},telegram2FaApproved=_0xcff0fb=>{const _0x24a096=_0x2f8d3d;let _0x2aa822=![];return devices[_0xcff0fb]['telegram2FaApproval']&&devices[_0xcff0fb][_0x24a096(0x1cc)][_0x24a096(0x1b3)]!='reject'&&(_0x2aa822=devices[_0xcff0fb][_0x24a096(0x1cc)][_0x24a096(0x26c)]==devices[_0xcff0fb]['ip']&&new Date()[_0x24a096(0x1da)]()-devices[_0xcff0fb][_0x24a096(0x1cc)][_0x24a096(0x251)]<devices[_0xcff0fb][_0x24a096(0x1cc)]['expiry']*0x3c*0x3e8),_0x2aa822;},normalizeIP=_0x317f0d=>{const _0x12ac4c=_0x2f8d3d;let _0x5bdf09=null,_0x3cccdb=null;if(ipaddr['isValid'](_0x317f0d)){const _0x11cd1a=ipaddr[_0x12ac4c(0x15a)](_0x317f0d);_0x11cd1a[_0x12ac4c(0x25a)]()===_0x12ac4c(0x1fa)?(_0x11cd1a[_0x12ac4c(0x155)]()&&(_0x5bdf09=_0x11cd1a[_0x12ac4c(0x209)]()[_0x12ac4c(0x2a1)]()),_0x3cccdb=_0x11cd1a[_0x12ac4c(0x2a1)]()):(_0x5bdf09=_0x11cd1a[_0x12ac4c(0x2a1)](),_0x3cccdb=_0x11cd1a[_0x12ac4c(0x225)]()['toString']());}return{'show':_0x5bdf09?_0x5bdf09:_0x3cccdb,'store':_0x3cccdb};};function sleep(_0x42c549){return new Promise(_0x5546fe=>setTimeout(_0x5546fe,_0x42c549));}