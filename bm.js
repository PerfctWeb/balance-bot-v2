const _0x30403f=_0x2f85;function _0x5e39(){const _0x914764=['Error:\x20Invalid\x20argument\x20','908748eLDnTM','child_process','-config.json','Unauthorized\x20attempt\x20to\x20delete\x20alerts','disconnect','bbvNew','Restarting\x20Bot\x20','login\x20token\x20generated','debug','#RES#\x0a','lastmsgemitted','node-zip','port','ipc','express','update-bot','0.0.0','sendFile','<b>Telegram\x20Bot\x20Status:</b>\x0a','404\x20Not\x20Found','https://api.ipify.org?format=json','statSync','all','index.html','assign','Enabled\x20Bot\x20','place-order','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Backup\x20file\x20uploaded','randomFillSync','backup-full.zip','f2aRequired','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','User\x20has\x20been\x20validated','Invalid\x20IP\x20address','</b>\x20?','getSeconds','\x20>\x20','blacklist','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','bot','add-bot','apiSecret','zip/','catch','new-disabled','Crypt','reset-history','title','includes','ipv6','getTime','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','yes','file','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','parse','login\x20token\x20valid','reset-password','match','exchange','11933460FwQMqQ','Password\x20reset\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20portfolio','isIPv4MappedAddress','value','output-002.log','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','socket','cloneDeep','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','size','binary','auth','bot-','privateKey','writeFileSync','Backup\x20file\x20unzipped\x20and\x20stored','Deleted\x20Bot\x20','generateKeyPairAsync','get-starting-balances','Unauthorized\x20attempt\x20to\x20log\x20out','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','padStart','static','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','hasOwnProperty','full','getPortfolio','createServer','files','temporary\x20access\x20not\x20allowed','store-headless','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','toIPv4MappedAddress','version','unlinkSync','Notifications\x20disabled\x0a','socket.io','whitelist','Restore\x20backup\x20file\x20','*$1*','/:bot/portfolio','2FA\x20required','SIGINT','onepagemode','Unauthorized\x20attempt\x20to\x20store\x20configuration','logs/','telegramEvents','range','storeConfiguration','alias','bots','chat','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','10915768xTlbnH','clients','Notifications\x20types:\x20','2FA\x20login\x20token\x20generated','auto','existsSync','push','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','stringify','temporary\x20access\x20rejected','clientip','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled',':\x20Bot\x20Mgr\x20>\x20','2FA','listen','Error\x20while\x20deleting\x20config\x20files:\x20','1000','botID','/:bot/configuration','.zip','post','logged\x20out',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Network\x20Interfaces:','getDate','temporaryAccessAllowed','kill','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','manual','-events.json','placeOrder','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Notifications\x20disabled','\x20(2)','toggle-bot-mode','::1','botname','7hDdGkK','reject','readdirSync','warning','args','Unauthorized\x20attempt\x20to\x20update\x20bot','Yes','getMinutes','Unauthorized\x20attempt\x20to\x20delete\x20bot','allow','express-fileupload','getStartingBalances','Unauthorized\x20login\x20attempt\x20(timeout)','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','version.json','reinstall','backup-full','simple','apply','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','-----------------------------------------------------------------------------------','settings.','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','_data','inherit','build','login\x20not\x20required','reason','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','filter','argv','startsWith','logout','$1_$2_$3','log','get-logs','All\x20bots','emit','token','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','replace','getHours','add','Starting\x20bot\x20|\x20Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/help\x20-\x20show\x20available\x20commands\x0a','stopPolling','rmSync','remove','cancel-loading','\x1b[31m','get-messages','sendMessage','Unauthorized\x20attempt\x20to\x20confirm\x20message','event','invalid\x20credentials','removeAllListeners','/output-000.log','File\x20uploaded','any','toString','access','login','telegramEnabled','store-configuration','\x20(1)','isDirectory','-performance.json','running','sockets','2FA\x20login\x20required','sort','find','Invalid\x20Telegram\x20token','started','sign','Unauthorized\x20attempt\x20to\x20update\x20settings','restore-backup-file','timestamp','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','remoteAddress','Invalid\x20authentication\x20token\x20(2)','password','max','127.0.0.1','Restore\x20process\x20aborted','internal','readFileSync','telegramToken','Markdown','uuid','No\x20authentication\x20token','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','output-001.log','19986KdiJpn','Bot\x20Mgr\x20>\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','expiry','\x1b[34m','backup/','\x1b[0m','pidExpireLogin','show','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','live','format','hashSync','Logged\x20out\x20user\x20...','write','enabled','output-000.log','notification','mkdirSync','connection','mode','axios','verify','update','conn','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','tkn','(((.+)+)+)+$','************','getFullYear','stopped','Bot\x20','telegram2FaApproval','telegram','5\x20min','isValid','Unauthorized\x20attempt\x20to\x20show\x20configuration','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/:bot/coins','orders','Notifications\x20enabled','connected','\x20minutes','messages','Starting\x20Balance\x20Bot\x20update','/update\x20-\x20update\x20Balance\x20Bot\x0a','sortBy','Password\x20has\x20been\x20reset\x20to:\x20','alerts','randomBytes','publicKey','/download/:type','Access\x20enabled\x20for\x20','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','storeHeadless','logs','emitHistory','/restart\x20-\x20restart\x20bot(s)\x0a','bot.js','Logged\x20in\x20user\x20...','update-bb','headless','use','secure','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','access\x20timeout','resetHistory','latestversion','/metrics\x20-\x20show\x20bot\x20performance\x0a','sendMetricsTelegram','test','backup-files','telegramIpApproval','error','99144EfUTbC','/off\x20-\x20stop\x20bot(s)\x0a','updatebotmanager','copyFileSync','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Token\x20blacklisted','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','lowdb/adapters/FileSync','/disable\x20-\x20disable\x20notifications\x0a','showname','backup-full@','send','search','toIPv4Address','init','message','backup','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','secret','confirm-message',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','370jALDVc','type','lastmsgtelegram','Login\x20rejected','3000','server','All','/upload-backup','bbUsername','loginRequired','whitelistEnabled','referer','number','/names\x20-\x20show\x20bot\x20names\x0a','bbPassword','data','name','telegramChatId','versions','get-portfolio','lowdb','status','=>\x20Go\x20to\x20#BLU#http://localhost:','\x1b[33m','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','disabled','family','delete-alerts','646804yfCOJC','***','bb-config.json','from','callback_query','headers','telegrammsg','entries','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','new','join','stop','decrypt','accept','set','then','telegramUsername','forEach','date-fns','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','fork','\x20|\x20client:\x20...','function','split','request','bb-settings.json','onText','slice','config/','\x20|\x20','userid','=>\x20Go\x20to\x20#BLU#http://','All\x20bots\x20running\x20right\x20now','30\x20min','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','hybrid-crypto-js','reload','ipaddr.js','length','store-fiat','defaults','RSA','\x20only\x0a','settings','username','address','\x20|\x20user:\x20...','apiKey','build2','15\x20min','Disabled\x20Bot\x20','SIGTERM','removeListener','apiPassword','store','/on\x20-\x20start\x20bot(s)\x0a','temporary\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','HTML','botmanager','showConfig','314hUnXGb','No\x20bots\x20running\x20right\x20now','keys','Failed\x20to\x20download\x20','8884539Vhufpk','Unauthorized\x20attempt\x20to\x20get\x20messages','Invalid\x20username\x20or\x20IP\x20address','login\x20required','answerCallbackQuery','crypto','createWriteStream','Your\x20installation\x20is\x20already\x20up\x20to\x20date','DEFLATE','/status\x20-\x20show\x20bot(s)\x20status\x0a','storeFiat','get-backup-files','host','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20download\x20','pidRefreshToken','restart','uuid-random','mtime','RSA-OAEP','bbvReceive','#RES#\x20if\x20running\x20locally\x0a','<b>Balance\x20Bot\x20Status:</b>\x0a','Allow\x20login\x20from\x20IP\x20address\x20<b>','node','exit','IPv4','bcryptjs','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','compareSync','success','6b67f3d61ee94b8f5c80b4affef4c4d9','/:bot','Setting\x20access:\x20','timeshift','jsonwebtoken','track','kind','cancelLoading',',\x20must\x20be\x20a\x204\x20digit\x20number','order','getMonth','get'];_0x5e39=function(){return _0x914764;};return _0x5e39();}(function(_0x38af38,_0x3e98fd){const _0x4e70d1=_0x2f85,_0x2ef77b=_0x38af38();while(!![]){try{const _0x7757fe=-parseInt(_0x4e70d1(0x1e5))/0x1+parseInt(_0x4e70d1(0x222))/0x2*(parseInt(_0x4e70d1(0x16a))/0x3)+parseInt(_0x4e70d1(0x253))/0x4+-parseInt(_0x4e70d1(0x1c9))/0x5*(-parseInt(_0x4e70d1(0x1b4))/0x6)+-parseInt(_0x4e70d1(0x10c))/0x7*(parseInt(_0x4e70d1(0xe7))/0x8)+-parseInt(_0x4e70d1(0x226))/0x9+parseInt(_0x4e70d1(0xb1))/0xa;if(_0x7757fe===_0x3e98fd)break;else _0x2ef77b['push'](_0x2ef77b['shift']());}catch(_0x478db7){_0x2ef77b['push'](_0x2ef77b['shift']());}}}(_0x5e39,0xa8a6d));const _0x55e67a=function(){let _0x18fe0d=!![];return function(_0x3dded8,_0x4283ff){const _0x1d0e7c=_0x18fe0d?function(){const _0x10aaae=_0x2f85;if(_0x4283ff){const _0x39429d=_0x4283ff[_0x10aaae(0x11e)](_0x3dded8,arguments);return _0x4283ff=null,_0x39429d;}}:function(){};return _0x18fe0d=![],_0x1d0e7c;};}(),_0x1895bb=_0x55e67a(this,function(){const _0xa2d5fa=_0x2f85;return _0x1895bb[_0xa2d5fa(0x148)]()[_0xa2d5fa(0x1c0)]('(((.+)+)+)+$')[_0xa2d5fa(0x148)]()['constructor'](_0x1895bb)['search'](_0xa2d5fa(0x185));});_0x1895bb();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x30403f(0x254)),fs=require('fs'),fns=require(_0x30403f(0x1f7)),low=require(_0x30403f(0x1dd)),FileSync=require(_0x30403f(0x1bb)),path=require('path'),crypto=require(_0x30403f(0x22b)),Crypt=require(_0x30403f(0x208))[_0x30403f(0xa2)],RSA=require(_0x30403f(0x208))[_0x30403f(0x20e)],bcrypt=require(_0x30403f(0x241)),jwt=require(_0x30403f(0x24a)),ipaddr=require(_0x30403f(0x20a)),argv=require('yargs/yargs')(process[_0x30403f(0x12a)][_0x30403f(0x200)](0x2))[_0x30403f(0x12a)],uuidRandom=require(_0x30403f(0x237)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x30403f(0x17f)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x30403f(0x116)),{networkInterfaces}=require('os'),PORT=argv[_0x30403f(0x7f)]||_0x30403f(0x1cd),pattern=/^[0-9]{2,4}$/;!pattern[_0x30403f(0x1b0)](PORT)&&(console[_0x30403f(0x12e)](_0x30403f(0x252)+PORT+_0x30403f(0x24e)),process[_0x30403f(0x23f)](0x1));const HOST=argv[_0x30403f(0x232)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x30403f(0x1db)][_0x30403f(0x23e)];let bbpath='bb/',bbpath2='';const botfile=_0x30403f(0x1a4),configfile=_0x30403f(0x1e7),settingsfile=_0x30403f(0x1fe),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x30403f(0xe8)),configpath=userID?bbpath+_0x30403f(0x201)+userID+'/':bbpath+_0x30403f(0x201),configbackuppath=configpath+_0x30403f(0x16f),logspath=userID?bbpath+_0x30403f(0xdf)+userID+'/':bbpath+_0x30403f(0xdf),zippath=userID?bbpath+_0x30403f(0x9f)+userID+'/':bbpath+_0x30403f(0x9f),loggerfile=fs[_0x30403f(0x22c)](logspath+_0x30403f(0x145),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x30403f(0xec)](configpath)&&fs[_0x30403f(0x17c)](configpath);!fs[_0x30403f(0xec)](configbackuppath)&&fs[_0x30403f(0x17c)](configbackuppath);!fs[_0x30403f(0xec)](logspath)&&fs[_0x30403f(0x17c)](logspath);!fs[_0x30403f(0xec)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x30403f(0xec)](temppath)&&fs[_0x30403f(0x17c)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x30403f(0x20d)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x30403f(0x20d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x30403f(0x83),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x30403f(0x20d)]({'secure':{},'blacklist':[]})[_0x30403f(0x178)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x30403f(0x239)});const saltRounds=0xa,mixpanel=Mixpanel[_0x30403f(0x1c2)](_0x30403f(0x246),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x30403f(0x164)]!=''&&settings[_0x30403f(0x1f5)]&&settings[_0x30403f(0x1f5)]!='')initTelegram();const parseColor=(_0x5bf8c7,_0x2522f0)=>{const _0x26fc36=_0x30403f,_0x8cc9b3=/#[A-Z]{3}#/g;!_0x2522f0?_0x5bf8c7=_0x5bf8c7[_0x26fc36(0x134)](_0x8cc9b3,''):(_0x5bf8c7=_0x5bf8c7[_0x26fc36(0x134)](/#BLU#/g,_0x26fc36(0x16e)),_0x5bf8c7=_0x5bf8c7[_0x26fc36(0x134)](/#RED#/g,_0x26fc36(0x13e)),_0x5bf8c7=_0x5bf8c7['replace'](/#YEL#/g,_0x26fc36(0x1e0)),_0x5bf8c7=_0x5bf8c7['replace'](/#RES#/g,_0x26fc36(0x170)));;return _0x5bf8c7;},logger={'screen':_0x2c3fbf=>{const _0x21df57=_0x30403f;console[_0x21df57(0x12e)](parseColor(_0x2c3fbf,!![]));},'simple':_0x1ddfad=>{const _0x443670=_0x30403f;console['log'](parseColor(_0x1ddfad,!![])),loggerfile[_0x443670(0x178)](util[_0x443670(0x175)](parseColor(_0x1ddfad,![]))+'\x0a');},'full':async _0x2ae838=>{const _0x16c544=_0x30403f,_0x3f91de=getTimeStamp()+_0x16c544(0xf3)+_0x2ae838;console['log'](parseColor(_0x3f91de,!![])),loggerfile[_0x16c544(0x178)](util[_0x16c544(0x175)](parseColor(_0x3f91de,![]))+'\x0a');if(tgBot&&settings[_0x16c544(0x1da)]&&settings[_0x16c544(0xe0)]!=_0x16c544(0x191))await tgBot[_0x16c544(0x140)](settings[_0x16c544(0x1da)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x2ae838,![]))[_0x16c544(0xa0)](_0x12e021=>{telegramError(_0x12e021);});},'debug':async(_0x42ac49,_0xde9639='')=>{const _0x162c88=_0x30403f,_0x265ec8=getTimeStamp()+_0x162c88(0x1c8)+_0x42ac49;if(debugging)console[_0x162c88(0x12e)](parseColor(_0x265ec8,!![]));loggerfile[_0x162c88(0x178)](util[_0x162c88(0x175)](parseColor(_0x265ec8,![]))+'\x0a');if(_0xde9639){if(debugging)console[_0x162c88(0x12e)](_0xde9639);loggerfile['write'](util[_0x162c88(0x175)](_0xde9639)+'\x0a');}}};process['on']('uncaughtException',function(_0xb16a88){logger['simple'](_0xb16a88);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x30403f(0x11a))[_0x30403f(0xd3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x30403f(0x81)),app=express(),http=require('http')[_0x30403f(0xcd)](app);app[_0x30403f(0x1a8)](fileUpload({'useTempFiles':!![]})),app[_0x30403f(0x251)](_0x30403f(0x19d),async(_0x381506,_0x1a594d)=>{const _0x302adb=_0x30403f,_0x46a4f5=_0x381506['params'][_0x302adb(0x1ca)],_0x183352=getClientsWithBotID('botmanager'),_0x5f5c28=_0x381506['headers']['uuid'],_0x5e8af9=timelyDecrypt(_0x5f5c28,![]),_0x540307=_0x183352[_0x302adb(0x154)](_0x592400=>_0x592400[_0x302adb(0x166)]==_0x5e8af9);if(_0x540307){const _0x4f1316=normalizeIP(_0x381506['socket']['remoteAddress'])[_0x302adb(0x21b)],_0x2e6f3e=_0x381506[_0x302adb(0x1ea)]['tkn'];if(validateAccess(_0x2e6f3e,_0x5e8af9,_0x4f1316)[_0x302adb(0x115)])_0x46a4f5==_0x302adb(0x1c4)&&await backupConfigFiles(),await zipFiles(_0x46a4f5),_0x1a594d['download'](zippath+(_0x46a4f5+'.zip'),_0x32f1cc=>{const _0x1d2bbc=_0x302adb;_0x32f1cc&&(logger[_0x1d2bbc(0xcb)](_0x1d2bbc(0x225)+_0x46a4f5),logger[_0x1d2bbc(0x11d)](_0x32f1cc));});else logger[_0x302adb(0xcb)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x46a4f5+_0x302adb(0x14d));}else logger[_0x302adb(0xcb)](_0x302adb(0x234)+_0x46a4f5+_0x302adb(0x108));}),app[_0x30403f(0xfb)](_0x30403f(0x1d0),async(_0x33f681,_0xe53e32)=>{const _0x56d38a=_0x30403f,_0x2d1176=getClientsWithBotID(_0x56d38a(0x220)),_0x347775=_0x33f681[_0x56d38a(0x1ea)][_0x56d38a(0x166)],_0x1c7f8f=timelyDecrypt(_0x347775,![]),_0x3b7160=_0x2d1176['find'](_0x4afe7b=>_0x4afe7b[_0x56d38a(0x166)]==_0x1c7f8f);logger['debug'](_0x56d38a(0x90));if(_0x3b7160){const _0x510a22=normalizeIP(_0x33f681[_0x56d38a(0xb8)][_0x56d38a(0x15c)])[_0x56d38a(0x21b)],_0x4b433f=_0x33f681[_0x56d38a(0x1ea)][_0x56d38a(0x184)];if(validateAccess(_0x4b433f,_0x1c7f8f,_0x510a22)[_0x56d38a(0x115)]){if(_0x33f681[_0x56d38a(0xce)]){const _0xd5c018=_0x33f681[_0x56d38a(0xce)]['backupfile'];await _0xd5c018['mv'](temppath+_0xd5c018['name']),_0xe53e32[_0x56d38a(0x1bf)]({'status':!![],'message':_0x56d38a(0x146)});const _0x1deb65=getBotsWithMode();_0x1deb65[_0x56d38a(0x20b)]>0x0?confirmRestore(temppath,_0xd5c018[_0x56d38a(0x1d9)]):unzipFile(temppath,_0xd5c018[_0x56d38a(0x1d9)]);}}else logger[_0x56d38a(0xcb)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x56d38a(0xcb)](_0x56d38a(0x8f));}),app[_0x30403f(0x1a8)](express[_0x30403f(0xc8)](path[_0x30403f(0x1ef)](__dirname,bbpath2,_0x30403f(0x215)))),app[_0x30403f(0x1a8)](express[_0x30403f(0xc8)](path[_0x30403f(0x1ef)](__dirname,bbpath2,_0x30403f(0x125)))),app[_0x30403f(0x251)]('/',function(_0x3a2353,_0x4731d9){const _0x4e73ef=_0x30403f;_0x4731d9['sendFile'](path['join'](__dirname,bbpath2,_0x4e73ef(0x215),_0x4e73ef(0x8a)));}),app[_0x30403f(0x251)](_0x30403f(0x247),function(_0x320bd8,_0x430adc){const _0xbbadf2=_0x30403f;_0x430adc['sendFile'](path[_0xbbadf2(0x1ef)](__dirname,bbpath2,'build',_0xbbadf2(0x8a)));}),app[_0x30403f(0x251)](_0x30403f(0xda),(_0x5137a2,_0x265652)=>{const _0x49907e=_0x30403f;_0x265652['sendFile'](path[_0x49907e(0x1ef)](__dirname,bbpath2,_0x49907e(0x125),_0x49907e(0x8a)));}),app['get']('/:bot/performance',(_0x2ab543,_0x528596)=>{const _0xdd7ba5=_0x30403f;_0x528596['sendFile'](path[_0xdd7ba5(0x1ef)](__dirname,bbpath2,_0xdd7ba5(0x125),_0xdd7ba5(0x8a)));}),app[_0x30403f(0x251)](_0x30403f(0x190),(_0x2b9c70,_0x47113d)=>{const _0x43d588=_0x30403f;_0x47113d['sendFile'](path[_0x43d588(0x1ef)](__dirname,bbpath2,'build',_0x43d588(0x8a)));}),app['get']('/:bot/history',(_0x32a12e,_0x46405b)=>{const _0x1be2dc=_0x30403f;_0x46405b['sendFile'](path[_0x1be2dc(0x1ef)](__dirname,bbpath2,_0x1be2dc(0x125),_0x1be2dc(0x8a)));}),app[_0x30403f(0x251)](_0x30403f(0xf9),(_0x6ba925,_0x5b52e6)=>{const _0x4aa024=_0x30403f;_0x5b52e6[_0x4aa024(0x84)](path[_0x4aa024(0x1ef)](__dirname,bbpath2,'build','index.html'));}),app[_0x30403f(0x251)]('/:bot/support',(_0x469314,_0x338b4f)=>{const _0x57b4c2=_0x30403f;_0x338b4f[_0x57b4c2(0x84)](path[_0x57b4c2(0x1ef)](__dirname,bbpath2,_0x57b4c2(0x125),_0x57b4c2(0x8a)));});if(HOST)http[_0x30403f(0xf5)](PORT,HOST);else http['listen'](PORT);const io=require(_0x30403f(0xd6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5cbbb0=_0x30403f;let _0x265a78='[ip-address]';const _0xb4ec05=networkInterfaces(),_0xff7645={};for(const _0x1b338e of Object['keys'](_0xb4ec05)){for(const _0x1019b8 of _0xb4ec05[_0x1b338e]){if((_0x1019b8[_0x5cbbb0(0x1e3)]==_0x5cbbb0(0x240)||_0x1019b8['family']==0x4)&&!_0x1019b8[_0x5cbbb0(0x162)]){const _0x5f1287=ipaddr['parse'](_0x1019b8[_0x5cbbb0(0x212)])[_0x5cbbb0(0xe1)]();_0x5f1287!='private'&&(!_0xff7645[_0x1b338e]&&(_0xff7645[_0x1b338e]=[]),_0xff7645[_0x1b338e][_0x5cbbb0(0xed)](_0x1019b8[_0x5cbbb0(0x212)]),_0x265a78=_0x1019b8[_0x5cbbb0(0x212)]);}}}return logger[_0x5cbbb0(0x25b)](_0x5cbbb0(0xfe),_0xff7645),_0x265a78;}async function startServer(){const _0x434fcd=_0x30403f;logger['simple'](''),logger['simple'](_0x434fcd(0x120)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x434fcd(0x25c)+(_0x434fcd(0x1df)+PORT+_0x434fcd(0x23b))+(_0x434fcd(0x204)+getServerIP()+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),await logger[_0x434fcd(0x25b)]('Node.js\x20v'+nodeversion),logger[_0x434fcd(0x11d)](_0x434fcd(0x120));if(config[_0x434fcd(0x20b)]!=0x0)for(const _0x1b8884 of config){if(_0x1b8884[_0x434fcd(0x1de)]==_0x434fcd(0x179)||_0x1b8884[_0x434fcd(0x1de)]==_0x434fcd(0x1ee))await logger['full'](_0x434fcd(0x137)+_0x1b8884[_0x434fcd(0xf8)]+_0x434fcd(0x202)+_0x1b8884[_0x434fcd(0x10b)]),startBot([_0x1b8884[_0x434fcd(0xf8)],userID],{'cwd':bbpath},function(_0x176bcd){const _0x11cc85=_0x434fcd;if(_0x176bcd)logger[_0x11cc85(0xcb)](_0x176bcd);});else(_0x1b8884['status']==_0x434fcd(0x1e2)||_0x1b8884[_0x434fcd(0x1de)]=='new-disabled')&&await logger[_0x434fcd(0xcb)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x1b8884[_0x434fcd(0xf8)]+_0x434fcd(0x202)+_0x1b8884[_0x434fcd(0x10b)]);}else!newBot&&logger[_0x434fcd(0x11d)](_0x434fcd(0x1aa));if(newBot)addBot();logger[_0x434fcd(0x11d)]('-----------------------------------------------------------------------------------'),logger[_0x434fcd(0x11d)]('');}function startSocket(){const _0x257086=_0x30403f;io['on'](_0x257086(0x17d),_0x37a699=>{const _0x38cee5=_0x257086;let _0x205826,_0x185aad,_0xc8f9d8,_0x1c06f4,_0x5aec81;const _0x36dc36=_0x37a699['handshake'][_0x38cee5(0x1ea)][_0x38cee5(0x1d4)];_0x185aad=_0x36dc36[_0x38cee5(0xaf)](/bot[0-9]{3}/);if(_0x185aad)_0xc8f9d8=_0x185aad[0x0][_0x38cee5(0xaf)](/[0-9]{3}/);if(_0xc8f9d8)_0x205826=_0xc8f9d8[0x0];else _0x205826=_0x38cee5(0x220);const _0x101b26=_0x37a699['handshake'][_0x38cee5(0xbd)]['encryptedUuid'];if(!_0x101b26)_0x37a699[_0x38cee5(0x131)]('status',{'publicKey':secure[_0x38cee5(0x19c)]});else{_0x1c06f4=timelyDecrypt(_0x101b26,![]);if(!_0x1c06f4)_0x37a699['emit']('status',{'publicKey':secure[_0x38cee5(0x19c)]});else{_0x5aec81=normalizeIP(_0x37a699[_0x38cee5(0x182)][_0x38cee5(0x15c)])['store'];if(!devices[_0x1c06f4])devices[_0x1c06f4]={'uuid':_0x1c06f4,'access':{'token':null}};devices[_0x1c06f4]['ip']=_0x5aec81;const _0x24a1d8=addClient(_0x37a699['id'],_0x1c06f4,_0x205826);setAccess(_0x24a1d8),emitMessages(),_0x37a699['on'](_0x38cee5(0x14a),_0x75ae66=>{const _0xb87ec2=_0x38cee5,_0x35f92e=timelyDecrypt(_0x75ae66[_0xb87ec2(0x15e)]);if(_0x35f92e){_0x75ae66={'username':_0x75ae66['username'],'password':_0x35f92e},devices[_0x1c06f4]['access']=validateCredentials(_0x75ae66,_0x1c06f4);if(devices[_0x1c06f4]['access'][_0xb87ec2(0x115)]==![]&&devices[_0x1c06f4]['access']['reason']==_0xb87ec2(0x152))_0x37a699[_0xb87ec2(0x131)](_0xb87ec2(0x1de),{'access':devices[_0x1c06f4][_0xb87ec2(0x149)]}),loginAccess2FA(_0x1c06f4,_0x5aec81);else{if(devices[_0x1c06f4][_0xb87ec2(0x149)]['allow']==![]&&devices[_0x1c06f4][_0xb87ec2(0x149)]['reason']==_0xb87ec2(0x143))_0x37a699[_0xb87ec2(0x131)](_0xb87ec2(0x1de),{'access':devices[_0x1c06f4][_0xb87ec2(0x149)]});else devices[_0x1c06f4][_0xb87ec2(0x149)][_0xb87ec2(0x115)]&&devices[_0x1c06f4][_0xb87ec2(0x149)][_0xb87ec2(0x127)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1c06f4)[_0xb87ec2(0x1f6)](_0x1a9e55=>{setAccess(_0x1a9e55);}),logger[_0xb87ec2(0x25b)](_0xb87ec2(0x1a5)+_0x1c06f4['slice'](-0x8)),setTokenRefresh(_0x1c06f4),setSessionTimeout(_0xb87ec2(0x14a),_0x1c06f4));}}else logger['full'](_0xb87ec2(0x118));}),_0x37a699['on'](_0x38cee5(0xae),()=>{resetPassword();}),_0x37a699['on'](_0x38cee5(0x257),_0x299a51=>{removeClient(_0x37a699['id']);}),_0x205826==_0x38cee5(0x220)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function _0x2f85(_0x39d85b,_0x5d5839){const _0xc1eaf3=_0x5e39();return _0x2f85=function(_0x1895bb,_0x55e67a){_0x1895bb=_0x1895bb-0x7f;let _0x5e39e4=_0xc1eaf3[_0x1895bb];return _0x5e39e4;},_0x2f85(_0x39d85b,_0x5d5839);}function initClient(_0x36ee70){const _0x41cffd=_0x30403f;if(_0x36ee70!=_0x41cffd(0x220)&&config[_0x41cffd(0x214)]!=''){if(pid[_0x36ee70])pid[_0x36ee70][_0x41cffd(0x1bf)]({'function':'initclient','args':null});}_0x36ee70!=_0x41cffd(0x220)&&broadcastToBots(_0x41cffd(0xe4),JSON[_0x41cffd(0xef)](config));}function reloadBotManager(){const _0xca3c7=_0x30403f;getClientsWithBotID(_0xca3c7(0x220))[_0xca3c7(0x1f6)](_0x3af96a=>{const _0xaed17a=_0xca3c7;getSocket(_0x3af96a['id'])[_0xaed17a(0x131)](_0xaed17a(0x1de),{'access':{'allow':![],'reason':_0xaed17a(0x209),'token':null}});});}function getSocket(_0x349175){const _0x74eff6=_0x30403f;return io[_0x74eff6(0x151)][_0x74eff6(0x151)]['get'](_0x349175);}function setAccess(_0x49b62f){const _0x36c229=_0x30403f,_0x5c77a7=getSocket(_0x49b62f['id']),_0xe4fb8e=_0x49b62f[_0x36c229(0x166)],_0x548ddf=_0x49b62f[_0x36c229(0x9c)];devices[_0xe4fb8e][_0x36c229(0x149)]=validateAccess(devices[_0xe4fb8e][_0x36c229(0x149)][_0x36c229(0x132)],_0xe4fb8e),logger['debug'](_0x36c229(0x248)+devices[_0xe4fb8e][_0x36c229(0x149)][_0x36c229(0x127)]+_0x36c229(0x1fa)+_0x49b62f['id'][_0x36c229(0x200)](-0x8)+_0x36c229(0x213)+_0xe4fb8e[_0x36c229(0x200)](-0x8)),_0x5c77a7['join'](_0xe4fb8e);if(devices[_0xe4fb8e]['access'][_0x36c229(0x115)]){_0x5c77a7[_0x36c229(0x1ef)](_0x548ddf);if(_0x548ddf==_0x36c229(0x220))initializeSocketBotManager(_0x5c77a7);else initializeSocketBot(_0x5c77a7);initClient(_0x548ddf);}devices[_0xe4fb8e][_0x36c229(0x149)]['token']&&devices[_0xe4fb8e]['access'][_0x36c229(0x127)]==_0x36c229(0x21d)&&setSessionTimeout(_0x36c229(0xf4),_0xe4fb8e),devices[_0xe4fb8e][_0x36c229(0x149)]['token']&&devices[_0xe4fb8e][_0x36c229(0x149)][_0x36c229(0x127)]==_0x36c229(0xea)&&setSessionTimeout(_0x36c229(0x14a),_0xe4fb8e),_0x5c77a7[_0x36c229(0x131)](_0x36c229(0x1de),{'status':_0x49b62f[_0x36c229(0x1ce)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xe4fb8e][_0x36c229(0x149)],'externalip':devices[_0xe4fb8e]['ip'],'publicKey':secure[_0x36c229(0x19c)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0xe4fb8e][_0x36c229(0x149)][_0x36c229(0x115)]==![]&&devices[_0xe4fb8e][_0x36c229(0x149)][_0x36c229(0x127)]==_0x36c229(0xdb)&&temporaryAccess2FA(_0xe4fb8e,devices[_0xe4fb8e]['ip']);}function setSessionTimeout(_0x178584,_0x12af0f){const _0x4ea7ef=_0x30403f;let _0x4bcb93;if(_0x178584=='login')_0x4bcb93=loginExpiry*0x3c*0x3e8;else _0x4bcb93=devices[_0x12af0f]['telegramIpApproval'][_0x4ea7ef(0x16d)]*0x3c*0x3e8-(new Date()[_0x4ea7ef(0xa7)]()-devices[_0x12af0f]['telegramIpApproval'][_0x4ea7ef(0x15a)]);if(devices[_0x12af0f]['pidExpireLogin'])clearTimeout(devices[_0x12af0f][_0x4ea7ef(0x171)]);devices[_0x12af0f][_0x4ea7ef(0x171)]=setTimeout(()=>{const _0x3c8409=_0x4ea7ef;if(devices[_0x12af0f][_0x3c8409(0x235)])clearTimeout(devices[_0x12af0f][_0x3c8409(0x235)]);removeSocketListeners(_0x12af0f),addBlacklist(_0x12af0f),devices[_0x12af0f][_0x3c8409(0x1b2)]=null,devices[_0x12af0f][_0x3c8409(0x18a)]=null,devices[_0x12af0f][_0x3c8409(0x149)][_0x3c8409(0x132)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x12af0f[_0x3c8409(0x200)](-0x8)),devices[_0x12af0f][_0x3c8409(0x149)]=validateAccess(devices[_0x12af0f]['access']['token'],_0x12af0f),!(devices[_0x12af0f]['access'][_0x3c8409(0x115)]&&devices[_0x12af0f][_0x3c8409(0x149)][_0x3c8409(0x127)]==_0x3c8409(0x126))&&(_0x178584==_0x3c8409(0x14a)?io['to'](_0x12af0f)['emit'](_0x3c8409(0x1de),{'access':{'allow':![],'reason':_0x3c8409(0x1ab),'token':null}}):io['to'](_0x12af0f)['emit'](_0x3c8409(0x1de),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x12af0f][_0x3c8409(0x149)][_0x3c8409(0x132)]=null;},_0x4bcb93);}function setTokenRefresh(_0x45a36d){const _0x28d05c=_0x30403f;if(devices[_0x45a36d]['pidRefreshToken'])clearTimeout(devices[_0x45a36d]['pidRefreshToken']);devices[_0x45a36d][_0x28d05c(0x235)]=setTimeout(()=>{const _0x1a401e=_0x28d05c;getClientsWithUuid(_0x45a36d)[_0x1a401e(0x20b)]!=0x0?(devices[_0x45a36d]['access']=refreshToken(_0x45a36d),io['to'](_0x45a36d)['emit'](_0x1a401e(0x1de),{'status':_0x1a401e(0x193),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x45a36d][_0x1a401e(0x149)],'externalip':devices[_0x45a36d]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x45a36d)):clearTimeout(devices[_0x45a36d]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2991ee){const _0x4d6496=_0x30403f,_0x47b056=getClient(_0x2991ee['id'])[_0x4d6496(0x166)];_0x2991ee[_0x4d6496(0x131)]('bots',config),_0x2991ee['emit'](_0x4d6496(0x210),cleanSettings()),_0x2991ee['on'](_0x4d6496(0x9d),_0x419c46=>{const _0x1de88d=_0x4d6496;if(validateAccess(_0x419c46,_0x47b056)[_0x1de88d(0x115)])addBot();else logger[_0x1de88d(0xcb)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2991ee['on'](_0x4d6496(0x82),(_0xca76ed,_0x576b3c)=>{const _0x2eb2bb=_0x4d6496;if(validateAccess(_0x576b3c,_0x47b056)['allow'])toggleBot(_0xca76ed[_0x2eb2bb(0xf8)],_0xca76ed[_0x2eb2bb(0x1de)],_0xca76ed[_0x2eb2bb(0x174)]);else logger[_0x2eb2bb(0xcb)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2991ee['on'](_0x4d6496(0x109),(_0x5da6eb,_0x144d6d)=>{const _0x21a301=_0x4d6496;if(validateAccess(_0x144d6d,_0x47b056)[_0x21a301(0x115)])toggleBotMode(_0x5da6eb);else logger[_0x21a301(0xcb)](_0x21a301(0x111));}),_0x2991ee['on']('delete-bot',(_0x26bcbf,_0x547d8b)=>{const _0x50db98=_0x4d6496;if(validateAccess(_0x547d8b,_0x47b056)[_0x50db98(0x115)])deleteBot(_0x26bcbf);else logger[_0x50db98(0xcb)](_0x50db98(0x114));}),_0x2991ee['on']('store-settings',(_0x55e6f8,_0x2b87dd)=>{const _0x2e7069=_0x4d6496;if(validateAccess(_0x2b87dd,_0x47b056)['allow'])storeSettings(_0x55e6f8,!![]);else logger['full'](_0x2e7069(0x158));}),_0x2991ee['on']('update-bb',_0x49e694=>{const _0x4b60ed=_0x4d6496;if(validateAccess(_0x49e694,_0x47b056)[_0x4b60ed(0x115)])updateBB('update');else logger[_0x4b60ed(0xcb)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2991ee['on']('reinstall-bb',_0x3170c5=>{const _0x5c9c1d=_0x4d6496;if(validateAccess(_0x3170c5,_0x47b056)[_0x5c9c1d(0x115)])updateBB(_0x5c9c1d(0x11b));else logger[_0x5c9c1d(0xcb)](_0x5c9c1d(0x102));}),_0x2991ee['on'](_0x4d6496(0x231),_0x5cee69=>{const _0x588792=_0x4d6496;if(validateAccess(_0x5cee69,_0x47b056)[_0x588792(0x115)]){const _0x5e70d1=getClient(_0x2991ee['id']);if(_0x5e70d1)getBackupFiles(_0x5e70d1[_0x588792(0x166)]);else logger[_0x588792(0xcb)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x588792(0xcb)](_0x588792(0xab));}),_0x2991ee['on'](_0x4d6496(0x159),(_0x19a899,_0x415187)=>{const _0x270ead=_0x4d6496;if(validateAccess(_0x415187,_0x47b056)[_0x270ead(0x115)])restoreBackupFile(_0x19a899);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x2991ee['on'](_0x4d6496(0x13f),_0x4b1147=>{const _0x57888a=_0x4d6496;if(validateAccess(_0x4b1147,_0x47b056)['allow'])getMessages();else logger[_0x57888a(0xcb)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2991ee['on'](_0x4d6496(0x1c7),(_0x395d9a,_0x48d5a7)=>{const _0x483c0a=_0x4d6496;if(validateAccess(_0x48d5a7,_0x47b056)['allow'])confirmMessage(_0x395d9a);else logger[_0x483c0a(0xcb)](_0x483c0a(0x141));}),_0x2991ee['on']('logout',_0x1419c7=>{const _0x454b9b=_0x4d6496;if(validateAccess(_0x1419c7,_0x47b056)[_0x454b9b(0x115)]){if(devices[_0x47b056][_0x454b9b(0x235)])clearTimeout(devices[_0x47b056][_0x454b9b(0x235)]);if(devices[_0x47b056][_0x454b9b(0x171)])clearTimeout(devices[_0x47b056][_0x454b9b(0x171)]);removeSocketListeners(getClient(_0x2991ee['id'])[_0x454b9b(0x166)]),addBlacklist(_0x47b056),devices[_0x47b056]['telegramIpApproval']=null,devices[_0x47b056][_0x454b9b(0x18a)]=null,devices[_0x47b056][_0x454b9b(0x149)]['token']=null,logger[_0x454b9b(0x25b)](_0x454b9b(0x177)+_0x47b056[_0x454b9b(0x200)](-0x8)),io['to'](getClient(_0x2991ee['id'])['uuid'])[_0x454b9b(0x131)](_0x454b9b(0x1de),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x454b9b(0xcb)](_0x454b9b(0xc5));});}function initializeSocketBot(_0x2de071){const _0x371600=_0x30403f,_0x1e59ca=getClient(_0x2de071['id'])['bot'],_0x5bae1e=getClient(_0x2de071['id'])[_0x371600(0x166)];_0x2de071['on'](_0x371600(0x12f),(_0x1de2bd,_0xac4f86)=>{const _0x33c635=_0x371600;if(validateAccess(_0xac4f86,_0x5bae1e)[_0x33c635(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x33c635(0x1bf)]({'function':_0x33c635(0x1a2),'args':_0x1de2bd});}else logger[_0x33c635(0xcb)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x2de071['on'](_0x371600(0x1e4),(_0x31adfe,_0xf1bb3f)=>{const _0x191ed7=_0x371600;if(validateAccess(_0xf1bb3f,_0x5bae1e)[_0x191ed7(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x191ed7(0x1bf)]({'function':'deleteHistoryAlerts','args':_0x31adfe});}else logger[_0x191ed7(0xcb)](_0x191ed7(0x256));}),_0x2de071['on'](_0x371600(0x1dc),(_0x16cdeb,_0x2b7cb0)=>{const _0xc584cc=_0x371600;if(validateAccess(_0x2b7cb0,_0x5bae1e)[_0xc584cc(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0xc584cc(0x1bf)]({'function':_0xc584cc(0xcc),'args':_0x16cdeb});}else logger[_0xc584cc(0xcb)](_0xc584cc(0xb3));}),_0x2de071['on'](_0x371600(0x14c),(_0x204742,_0x103654)=>{const _0x345cf4=_0x371600;if(validateAccess(_0x103654,_0x5bae1e)[_0x345cf4(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x345cf4(0x1bf)]({'function':_0x345cf4(0xe2),'args':_0x204742});}else logger[_0x345cf4(0xcb)](_0x345cf4(0xde));}),_0x2de071['on'](_0x371600(0xd0),(_0x340df7,_0x4a544c)=>{const _0x8767f0=_0x371600;if(validateAccess(_0x4a544c,_0x5bae1e)[_0x8767f0(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x8767f0(0x1bf)]({'function':_0x8767f0(0x1a0),'args':_0x340df7});}else logger[_0x8767f0(0xcb)](_0x8767f0(0x183));}),_0x2de071['on'](_0x371600(0x20c),(_0x23702b,_0x5115b4)=>{const _0x4cb73e=_0x371600;if(validateAccess(_0x5115b4,_0x5bae1e)['allow']){if(pid[_0x1e59ca])pid[_0x1e59ca]['send']({'function':_0x4cb73e(0x230),'args':_0x23702b});}else logger[_0x4cb73e(0xcb)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x2de071['on'](_0x371600(0xa3),_0x2281c7=>{const _0x120c81=_0x371600;if(validateAccess(_0x2281c7,_0x5bae1e)[_0x120c81(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x120c81(0x1bf)]({'function':_0x120c81(0x1ac),'args':null});}else logger[_0x120c81(0xcb)](_0x120c81(0x15b));}),_0x2de071['on'](_0x371600(0xc4),_0x1cdd7d=>{const _0x21dbbe=_0x371600;if(validateAccess(_0x1cdd7d,_0x5bae1e)['allow']){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x21dbbe(0x1bf)]({'function':_0x21dbbe(0x117),'args':null});}else logger[_0x21dbbe(0xcb)](_0x21dbbe(0x11f));}),_0x2de071['on'](_0x371600(0x8d),(_0x4a7597,_0x921b8e)=>{const _0x5c5f46=_0x371600;if(validateAccess(_0x921b8e,_0x5bae1e)[_0x5c5f46(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca]['send']({'function':_0x5c5f46(0x105),'args':_0x4a7597});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x2de071['on'](_0x371600(0x13d),_0x4c29d1=>{const _0x1e3a50=_0x371600;if(validateAccess(_0x4c29d1,_0x5bae1e)[_0x1e3a50(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca][_0x1e3a50(0x1bf)]({'function':_0x1e3a50(0x24d),'args':null});}else logger[_0x1e3a50(0xcb)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x2de071['on']('show-config',_0x3b3f08=>{const _0x53d7e1=_0x371600;if(validateAccess(_0x3b3f08,_0x5bae1e)[_0x53d7e1(0x115)]){if(pid[_0x1e59ca])pid[_0x1e59ca]['send']({'function':_0x53d7e1(0x221),'args':null});}else logger[_0x53d7e1(0xcb)](_0x53d7e1(0x18e));}),_0x2de071['on'](_0x371600(0x1a6),_0x1773fb=>{const _0x410b7f=_0x371600;if(validateAccess(_0x1773fb,_0x5bae1e)[_0x410b7f(0x115)])updateBB(_0x410b7f(0x181));else logger[_0x410b7f(0xcb)](_0x410b7f(0x1ed));}),_0x2de071['on'](_0x371600(0x13f),_0x31cad5=>{const _0x2d9f12=_0x371600;if(validateAccess(_0x31cad5,_0x5bae1e)[_0x2d9f12(0x115)])getMessages();else logger[_0x2d9f12(0xcb)](_0x2d9f12(0x227));}),_0x2de071['on']('confirm-message',(_0xded79e,_0x301fd3)=>{const _0x54a491=_0x371600;if(validateAccess(_0x301fd3,_0x5bae1e)[_0x54a491(0x115)])confirmMessage(_0xded79e);else logger[_0x54a491(0xcb)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2de071['on'](_0x371600(0x12c),_0x12a0f2=>{const _0x46287e=_0x371600;if(validateAccess(_0x12a0f2,_0x5bae1e)['allow']){if(devices[_0x5bae1e][_0x46287e(0x235)])clearTimeout(devices[_0x5bae1e][_0x46287e(0x235)]);if(devices[_0x5bae1e][_0x46287e(0x171)])clearTimeout(devices[_0x5bae1e][_0x46287e(0x171)]);removeSocketListeners(getClient(_0x2de071['id'])[_0x46287e(0x166)]),addBlacklist(_0x5bae1e),devices[_0x5bae1e]['telegramIpApproval']=null,devices[_0x5bae1e][_0x46287e(0x18a)]=null,devices[_0x5bae1e][_0x46287e(0x149)][_0x46287e(0x132)]=null,logger[_0x46287e(0x25b)]('Logged\x20out\x20user\x20...'+_0x5bae1e[_0x46287e(0x200)](-0x8)),io['to'](getClient(_0x2de071['id'])[_0x46287e(0x166)])[_0x46287e(0x131)](_0x46287e(0x1de),{'access':{'allow':![],'reason':_0x46287e(0xfc),'token':null}});}else logger[_0x46287e(0xcb)](_0x46287e(0xc5));});}function removeSocketListeners(_0x14ab54){const _0xc0f406=_0x30403f;getClientsWithUuid(_0x14ab54)[_0xc0f406(0x1f6)](_0x46bc55=>{const _0x2fe518=_0xc0f406;getSocket(_0x46bc55['id'])[_0x2fe518(0x144)]();});}function cleanSettings(){const _0x22f842=_0x30403f;let _0x33536=settings;return settings[_0x22f842(0x164)]&&settings[_0x22f842(0x164)]!=''&&(_0x33536={..._0x33536,'telegramToken':_0x22f842(0x186)}),settings['bbPassword']&&settings[_0x22f842(0x1d7)]!=''&&(_0x33536={..._0x33536,'bbPassword':_0x22f842(0x186)}),(settings['bbPassword']&&settings[_0x22f842(0x1d7)]==_0x22f842(0x1e6)||settings['telegramToken']&&settings[_0x22f842(0x164)]=='***')&&(_0x33536={..._0x33536,'restored':{'password':settings[_0x22f842(0x1d7)]=='***','telegram':settings[_0x22f842(0x164)]==_0x22f842(0x1e6)}}),_0x33536;}async function updateBB(_0x37d296){const _0x1ab266=_0x30403f;await backupConfigFiles(),installingUpdate=!![],config[_0x1ab266(0x1f6)](_0x49d61e=>{restartBot(_0x49d61e['botID']);}),logger[_0x1ab266(0x25b)]('Starting\x20Balance\x20Bot\x20'+_0x37d296);if(_0x37d296==_0x1ab266(0x181))process[_0x1ab266(0x1bf)]({'update':!![]},_0x3fbca2=>{});else _0x37d296=='reinstall'&&process[_0x1ab266(0x1bf)]({'reinstall':!![]},_0x3d289d=>{});}function startBot(_0x192176,_0x4aebb3,_0x14a7bd){const _0x38793e=_0x30403f;if(debugging)_0x192176[_0x38793e(0xed)]('-d');let _0x2d35e8=![];const _0x1c1f75=_0x192176[0x0];_0x4aebb3={..._0x4aebb3,'stdio':['inherit',_0x38793e(0x124),'inherit',_0x38793e(0x80)]},pid[_0x1c1f75]=childProcess[_0x38793e(0x1f9)](botfile,_0x192176,_0x4aebb3),pid[_0x1c1f75]['on'](_0x38793e(0x1c3),_0x4bec38=>{const _0x4e7425=_0x38793e;switch(Object[_0x4e7425(0x224)](_0x4bec38)[0x0]){case _0x4e7425(0x10b):updateBotName(_0x1c1f75,_0x4bec38[_0x4e7425(0x10b)]);break;case _0x4e7425(0x1b6):updateBotManager();break;case'status':updateStatus(_0x1c1f75,_0x4bec38['status']);break;case _0x4e7425(0x174):updateLive(_0x1c1f75,_0x4bec38[_0x4e7425(0x174)]);break;case _0x4e7425(0x156):updateLive(_0x1c1f75,_0x4bec38[_0x4e7425(0x156)]),io['to'](_0x1c1f75)[_0x4e7425(0x131)](_0x4e7425(0x1de),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x4e7425(0x1f0):_0x4bec38[_0x4e7425(0x1f0)]==_0x4e7425(0x236)&&restartBot(_0x1c1f75);_0x4bec38[_0x4e7425(0x1f0)]=='kill'&&toggleBot(_0x1c1f75,_0x4e7425(0x1e2),_0x4e7425(0x188));break;case _0x4e7425(0x18b):sendTelegram(_0x1c1f75,_0x4bec38[_0x4e7425(0x18b)]);break;case _0x4e7425(0x1eb):sendTelegramMsg(_0x4bec38[_0x4e7425(0x1eb)]);break;case _0x4e7425(0x1fb):io['to'](_0x1c1f75)[_0x4e7425(0x131)](_0x4bec38['function'],_0x4bec38[_0x4e7425(0x110)]);break;}}),pid[_0x1c1f75]['on']('error',function(_0x2c5f6c){if(_0x2d35e8)return;_0x2d35e8=!![],_0x14a7bd(_0x2c5f6c);}),pid[_0x1c1f75]['on']('exit',async function(_0x228719){const _0x129923=_0x38793e;if(installingUpdate)return;if(_0x2d35e8)return;_0x2d35e8=!![],_0x14a7bd(null);const _0x1b76d9=dbConfig[_0x129923(0x251)](_0x129923(0xe4))['find']({'botID':_0x1c1f75})[_0x129923(0xb5)]();_0x1b76d9&&(_0x1b76d9[_0x129923(0x1de)]==_0x129923(0x179)||_0x1b76d9['status']=='new')&&(await sleep(0x3e8),updateLive(_0x1c1f75,_0x129923(0x188)),logger[_0x129923(0xcb)](_0x129923(0x259)+_0x1c1f75),startBot([_0x1c1f75,userID],{'cwd':bbpath},function(_0x2dd47a){const _0xac1cac=_0x129923;if(_0x2dd47a)logger[_0xac1cac(0xcb)](_0x2dd47a);}));});}function stopBot(_0x1cb670){const _0x4f922b=_0x30403f;getClientsWithBotID(_0x1cb670)[_0x4f922b(0x1f6)](_0x102129=>{const _0x4178dc=_0x4f922b;getSocket(_0x102129['id'])[_0x4178dc(0x257)](!![]),removeClient(_0x102129['id']);}),pid[_0x1cb670]&&(pid[_0x1cb670][_0x4f922b(0x101)](),pid[_0x1cb670]=null);}function restartBot(_0x500ed0){const _0x44fc56=_0x30403f;if(pid[_0x500ed0])pid[_0x500ed0][_0x44fc56(0x101)]();}function addBot(){const _0x530cd7=_0x30403f;let _0x12f57b;for(let _0x57ac0c=0x1;_0x57ac0c<0x3e9;_0x57ac0c++){_0x12f57b=_0x57ac0c[_0x530cd7(0x148)]()['padStart'](0x3,'0');let _0x4aaaf6=config['find'](_0x5e35d8=>_0x5e35d8[_0x530cd7(0xf8)]==_0x12f57b);if(!_0x4aaaf6)break;}if(_0x12f57b===_0x530cd7(0xf7)){logger[_0x530cd7(0xcb)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x12f57b),dbConfig[_0x530cd7(0x251)](_0x530cd7(0xe4))[_0x530cd7(0xed)]({'botID':_0x12f57b,'botname':_0x530cd7(0x189)+_0x12f57b,'status':'new','live':''})[_0x530cd7(0x178)](),startBot([_0x12f57b,userID],{'cwd':bbpath},function(_0x20b5d2){const _0x4cba3d=_0x530cd7;if(_0x20b5d2)logger[_0x4cba3d(0xcb)](_0x20b5d2);}),config=getConfiguration(),io['to']('botmanager')[_0x530cd7(0x131)](_0x530cd7(0xe4),config),broadcastToBots(_0x530cd7(0xe4),JSON[_0x530cd7(0xef)](config));}function deleteBot(_0xc95adc){const _0x12d290=_0x30403f;getClientsWithBotID(_0xc95adc)[_0x12d290(0x1f6)](_0x14e465=>{const _0x34dceb=_0x12d290;getSocket(_0x14e465['id'])[_0x34dceb(0x257)](!![]),removeClient(_0x14e465['id']);}),dbConfig[_0x12d290(0x251)]('bots')['remove']({'botID':_0xc95adc})[_0x12d290(0x178)](),logger[_0x12d290(0xcb)](_0x12d290(0xc2)+_0xc95adc),stopBot(_0xc95adc);try{if(fs[_0x12d290(0xec)](path[_0x12d290(0x1ef)](configpath,_0x12d290(0xbe)+_0xc95adc+_0x12d290(0x255))))fs[_0x12d290(0xd4)](path[_0x12d290(0x1ef)](configpath,'bot-'+_0xc95adc+'-config.json'));if(fs[_0x12d290(0xec)](path[_0x12d290(0x1ef)](configpath,_0x12d290(0xbe)+_0xc95adc+_0x12d290(0x104))))fs[_0x12d290(0xd4)](path[_0x12d290(0x1ef)](configpath,_0x12d290(0xbe)+_0xc95adc+_0x12d290(0x104)));if(fs[_0x12d290(0xec)](path[_0x12d290(0x1ef)](configpath,_0x12d290(0xbe)+_0xc95adc+_0x12d290(0x14f))))fs[_0x12d290(0xd4)](path[_0x12d290(0x1ef)](configpath,_0x12d290(0xbe)+_0xc95adc+_0x12d290(0x14f)));if(fs[_0x12d290(0xec)](path[_0x12d290(0x1ef)](configpath,'bot-'+_0xc95adc+'-results.json')))fs[_0x12d290(0xd4)](path[_0x12d290(0x1ef)](configpath,_0x12d290(0xbe)+_0xc95adc+'-results.json'));}catch(_0x4879cd){if(_0x4879cd)logger[_0x12d290(0xcb)](_0x12d290(0xf6),_0x4879cd);}config=getConfiguration(),io['to'](_0x12d290(0x220))['emit'](_0x12d290(0xe4),config),broadcastToBots(_0x12d290(0xe4),JSON[_0x12d290(0xef)](config));}function toggleBot(_0x11a337,_0x2c3dd8,_0x442c82){const _0x2f7d62=_0x30403f;dbConfig[_0x2f7d62(0x251)](_0x2f7d62(0xe4))[_0x2f7d62(0x154)]({'botID':_0x11a337})[_0x2f7d62(0x8b)]({'status':_0x2c3dd8})[_0x2f7d62(0x8b)]({'live':_0x442c82})[_0x2f7d62(0x178)]();if(_0x2c3dd8=='enabled'||_0x2c3dd8==_0x2f7d62(0x1ee))logger[_0x2f7d62(0xcb)](_0x2f7d62(0x8c)+_0x11a337),startBot([_0x11a337,userID],{'cwd':bbpath},function(_0x13365d){const _0x2b79b7=_0x2f7d62;if(_0x13365d)logger[_0x2b79b7(0xcb)](_0x13365d);});else(_0x2c3dd8==_0x2f7d62(0x1e2)||_0x2c3dd8==_0x2f7d62(0xa1))&&(logger['full'](_0x2f7d62(0x217)+_0x11a337),stopBot(_0x11a337));config=getConfiguration(),io['to'](_0x2f7d62(0x220))[_0x2f7d62(0x131)]('bots',config),broadcastToBots(_0x2f7d62(0xe4),JSON[_0x2f7d62(0xef)](config));}function toggleStatus(_0x319975){const _0x58611c=_0x30403f;let _0xac2c9f=dbConfig[_0x58611c(0x251)](_0x58611c(0xe4))[_0x58611c(0x154)]({'botID':_0x319975})['value'](),_0x339687;if(_0xac2c9f[_0x58611c(0x1de)]==='enabled')_0x339687=_0x58611c(0x1e2);else{if(_0xac2c9f[_0x58611c(0x1de)]==='new')_0x339687='new-disabled';else{if(_0xac2c9f['status']===_0x58611c(0xa1))_0x339687=_0x58611c(0x1ee);else{if(_0xac2c9f['status']===_0x58611c(0x1e2))_0x339687=_0x58611c(0x179);}}}return _0x339687;}function updateStatus(_0x34520f,_0x592c6a){const _0x216af8=_0x30403f;dbConfig[_0x216af8(0x251)](_0x216af8(0xe4))[_0x216af8(0x154)]({'botID':_0x34520f})[_0x216af8(0x8b)]({'status':_0x592c6a})[_0x216af8(0x178)](),config=getConfiguration(),io['to'](_0x216af8(0x220))[_0x216af8(0x131)](_0x216af8(0xe4),config),broadcastToBots(_0x216af8(0xe4),JSON[_0x216af8(0xef)](config));}function updateLive(_0x146734,_0x56b96f){const _0x1b2323=_0x30403f;dbConfig[_0x1b2323(0x251)](_0x1b2323(0xe4))['find']({'botID':_0x146734})[_0x1b2323(0x8b)]({'live':_0x56b96f})[_0x1b2323(0x178)](),config=getConfiguration(),io['to'](_0x1b2323(0x220))[_0x1b2323(0x131)](_0x1b2323(0xe4),config),broadcastToBots(_0x1b2323(0xe4),JSON[_0x1b2323(0xef)](config));}function updateBotName(_0x1c6c4b,_0x3a35cf){const _0x1594a5=_0x30403f;dbConfig['get'](_0x1594a5(0xe4))[_0x1594a5(0x154)]({'botID':_0x1c6c4b})[_0x1594a5(0x8b)]({'botname':_0x3a35cf})[_0x1594a5(0x178)](),config=getConfiguration(),io['to'](_0x1594a5(0x220))['emit'](_0x1594a5(0xe4),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x52bc3a=_0x30403f;config=getConfiguration(),io['to'](_0x52bc3a(0x220))[_0x52bc3a(0x131)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x48ca71){const _0x504684=_0x30403f;if(pid[_0x48ca71])pid[_0x48ca71]['send']({'function':'toggleBotMode','args':null});else{const _0x51ed4a=configpath+'bot-'+_0x48ca71+'-config.json',_0x14d31c=fs[_0x504684(0x163)](_0x51ed4a),_0x3510fb=JSON[_0x504684(0xac)](_0x14d31c),_0xaa5c3e=_0x3510fb['bot'][0x0]['headless'];_0x3510fb[_0x504684(0x9c)][0x0][_0x504684(0x1a7)]=!_0xaa5c3e;const _0xb5a1f3=JSON[_0x504684(0xef)](_0x3510fb,null,0x2);fs[_0x504684(0xc0)](_0x51ed4a,_0xb5a1f3),config=getConfiguration(),io['to'](_0x504684(0x220))['emit']('bots',config),broadcastToBots(_0x504684(0xe4),JSON[_0x504684(0xef)](config));}}function telegramError(_0x1d466e){const _0x4967b7=_0x30403f;logger[_0x4967b7(0x11d)](getTimeStamp()+_0x4967b7(0xfd));}function validateTelegram(_0x4c5932){const _0x3623a8=_0x30403f;if(_0x4c5932['from'][_0x3623a8(0x211)]!=settings[_0x3623a8(0x1f5)]&&'@'+_0x4c5932[_0x3623a8(0x1e8)][_0x3623a8(0x211)]!=settings[_0x3623a8(0x1f5)])return tgBot['sendMessage'](_0x4c5932[_0x3623a8(0xe5)]['id'],_0x3623a8(0x1ba),{'parse_mode':'HTML'})[_0x3623a8(0xa0)](_0x12032a=>{telegramError(_0x12032a);}),![];return!![];}async function initTelegram(){const _0x37a9eb=_0x30403f;if(tgBot)tgBot[_0x37a9eb(0x13a)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x59149e=_0x37a9eb(0x18f);_0x59149e+='\x0a',_0x59149e+='/enable\x20-\x20enable\x20notifications\x0a',_0x59149e+=_0x37a9eb(0x1bc),_0x59149e+=_0x37a9eb(0x1e1),_0x59149e+=_0x37a9eb(0x1a3),_0x59149e+=_0x37a9eb(0x21c),_0x59149e+=_0x37a9eb(0x1b5),_0x59149e+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x59149e+=_0x37a9eb(0x1d6),_0x59149e+=_0x37a9eb(0x22f),_0x59149e+=_0x37a9eb(0x1ae),_0x59149e+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x59149e+=_0x37a9eb(0x197),_0x59149e+=_0x37a9eb(0x243),_0x59149e+=_0x37a9eb(0x139);let _0x2bdac8=_0x37a9eb(0x1c5);_0x2bdac8+='\x0a',_0x2bdac8+=_0x59149e,tgBot['onText'](/\/start/,_0x5368eb=>{const _0x243cb0=_0x37a9eb;if(!validateTelegram(_0x5368eb))return;if(settings[_0x243cb0(0x1da)]!=_0x5368eb[_0x243cb0(0xe5)]['id'])updateSetting(_0x243cb0(0x1da),_0x5368eb[_0x243cb0(0xe5)]['id']);updateSetting(_0x243cb0(0x14b),!![]),tgBot[_0x243cb0(0x140)](_0x5368eb[_0x243cb0(0xe5)]['id'],_0x2bdac8)[_0x243cb0(0xa0)](_0x1a2972=>{telegramError(_0x1a2972);});}),tgBot[_0x37a9eb(0x1ff)](/\/enable/,_0x2c0ae0=>{const _0x50c3bd=_0x37a9eb;if(!validateTelegram(_0x2c0ae0))return;if(settings[_0x50c3bd(0x1da)]!=_0x2c0ae0[_0x50c3bd(0xe5)]['id'])updateSetting(_0x50c3bd(0x1da),_0x2c0ae0[_0x50c3bd(0xe5)]['id']);updateSetting(_0x50c3bd(0x14b),!![]),tgBot[_0x50c3bd(0x140)](_0x2c0ae0[_0x50c3bd(0xe5)]['id'],_0x50c3bd(0x192))[_0x50c3bd(0xa0)](_0x413240=>{telegramError(_0x413240);});}),tgBot['onText'](/\/config/,async _0x47876d=>{const _0xe7570c=_0x37a9eb;if(!validateTelegram(_0x47876d))return;tgBot['removeListener']('callback_query'),tgBot['sendMessage'](_0x47876d['chat']['id'],_0xe7570c(0xd1),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':'Alerts','callback_data':_0xe7570c(0x19a)},{'text':_0xe7570c(0x1cf),'callback_data':_0xe7570c(0x89)}]]}})[_0xe7570c(0xa0)](_0x37d077=>{telegramError(_0x37d077);}),tgBot['on'](_0xe7570c(0x1e9),async _0x183495=>{const _0x2c8ae3=_0xe7570c,_0x5d9801=_0x183495[_0x2c8ae3(0x1d8)],_0x2cd83a=_0x183495[_0x2c8ae3(0x1c3)];tgBot[_0x2c8ae3(0x22a)](_0x183495['id'])[_0x2c8ae3(0x1f4)](async()=>{const _0x2236e2=_0x2c8ae3;_0x5d9801==_0x2236e2(0x191)&&(updateSetting(_0x2236e2(0xe0),_0x2236e2(0x191)),updateSetting('telegramEnabled',!![]),await tgBot[_0x2236e2(0x140)](_0x2cd83a[_0x2236e2(0xe5)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x2236e2(0xa0)](_0x4b8965=>{telegramError(_0x4b8965);}));_0x5d9801==_0x2236e2(0x19a)&&(updateSetting(_0x2236e2(0xe0),_0x2236e2(0x19a)),updateSetting(_0x2236e2(0x14b),!![]),await tgBot[_0x2236e2(0x140)](_0x2cd83a[_0x2236e2(0xe5)]['id'],_0x2236e2(0x1b8))[_0x2236e2(0xa0)](_0x46ef2a=>{telegramError(_0x46ef2a);}));_0x5d9801=='all'&&(updateSetting(_0x2236e2(0xe0),_0x2236e2(0x89)),updateSetting(_0x2236e2(0x14b),!![]),await tgBot[_0x2236e2(0x140)](_0x2cd83a[_0x2236e2(0xe5)]['id'],_0x2236e2(0xe6))[_0x2236e2(0xa0)](_0x9ab16b=>{telegramError(_0x9ab16b);}));if(!settings[_0x2236e2(0x1da)])tgBot[_0x2236e2(0x140)](_0x2cd83a[_0x2236e2(0xe5)]['id'],_0x2236e2(0x19f))[_0x2236e2(0xa0)](_0x38dd9f=>{telegramError(_0x38dd9f);});}),tgBot[_0x2c8ae3(0x219)](_0x2c8ae3(0x1e9));});}),tgBot['onText'](/\/status/,_0x59d280=>{const _0x5d2d13=_0x37a9eb;if(!validateTelegram(_0x59d280))return;const _0x55f2d9=getBotsWithMode();let _0x4c03ae=_0x5d2d13(0x23c);config['forEach'](_0x45fc00=>{const _0x3aa4fb=_0x5d2d13,_0x5de2e9=_0x55f2d9['find'](_0x533342=>_0x533342['botID']==_0x45fc00['botID'])['mode'];_0x4c03ae+='Bot\x20'+_0x45fc00[_0x3aa4fb(0xf8)]+':\x20'+_0x45fc00[_0x3aa4fb(0x1de)]+'\x20|\x20'+_0x5de2e9+_0x3aa4fb(0x202)+_0x45fc00[_0x3aa4fb(0x174)]+'\x0a';}),_0x4c03ae+='\x0a',_0x4c03ae+=_0x5d2d13(0x85),_0x4c03ae+=!settings[_0x5d2d13(0x14b)]?_0x5d2d13(0xd5):_0x5d2d13(0x8e),_0x4c03ae+=settings[_0x5d2d13(0x14b)]?settings['telegramEvents']=='all'?_0x5d2d13(0x133):_0x5d2d13(0xe9)+settings[_0x5d2d13(0xe0)]+_0x5d2d13(0x20f):'',tgBot[_0x5d2d13(0x140)](_0x59d280[_0x5d2d13(0xe5)]['id'],_0x4c03ae,{'parse_mode':_0x5d2d13(0x21f)})['catch'](_0x3a1fbc=>{telegramError(_0x3a1fbc);});}),tgBot[_0x37a9eb(0x1ff)](/\/restart/,_0x32e7b2=>{const _0x11ae3a=_0x37a9eb;if(!validateTelegram(_0x32e7b2))return;tgBot['removeListener'](_0x11ae3a(0x1e9));const _0x25cab2=getEnabledBots();if(_0x25cab2[_0x11ae3a(0x20b)]==0x0)tgBot[_0x11ae3a(0x140)](_0x32e7b2[_0x11ae3a(0xe5)]['id'],_0x11ae3a(0x223))[_0x11ae3a(0xa0)](_0x43cb31=>{telegramError(_0x43cb31);});else{if(_0x25cab2['length']>0x1)_0x25cab2['push']({'botID':_0x11ae3a(0x89)});let _0x141df1=[],_0xdd97d7=[];const _0x14e171=_0x25cab2[_0x11ae3a(0x20b)]%0x4==0x0||_0x25cab2[_0x11ae3a(0x20b)]%0x4==0x3||_0x25cab2[_0x11ae3a(0x20b)]%0x3==0x1?0x4:0x3;let _0x3665f7=0x0;_0x25cab2['forEach']((_0x33a45e,_0xe1980f)=>{const _0xb236c2=_0x11ae3a;if(_0xe1980f%_0x14e171==0x0)_0xdd97d7=[];_0xdd97d7[_0xb236c2(0xed)]({'text':_0x33a45e[_0xb236c2(0xf8)]=='all'?_0xb236c2(0x130):_0xb236c2(0x189)+_0x33a45e[_0xb236c2(0xf8)],'callback_data':_0x33a45e['botID']}),_0xe1980f%_0x14e171==0x0&&(_0x141df1[_0x3665f7]=_0xdd97d7,_0x3665f7++);}),tgBot[_0x11ae3a(0x140)](_0x32e7b2[_0x11ae3a(0xe5)]['id'],_0x11ae3a(0x242),{'reply_markup':{'inline_keyboard':_0x141df1}})[_0x11ae3a(0xa0)](_0x4a9ee5=>{telegramError(_0x4a9ee5);}),tgBot['on'](_0x11ae3a(0x1e9),async _0x40f885=>{const _0x2bc33b=_0x11ae3a,_0x301117=_0x40f885[_0x2bc33b(0x1d8)],_0x274890=_0x40f885[_0x2bc33b(0x1c3)];tgBot[_0x2bc33b(0x22a)](_0x40f885['id'])['then'](async()=>{const _0x404e13=_0x2bc33b;_0x301117==_0x404e13(0x89)?config['forEach'](_0x557eb0=>{const _0x5174bf=_0x404e13;restartBot(_0x557eb0[_0x5174bf(0xf8)]);}):restartBot(_0x301117);}),tgBot[_0x2bc33b(0x219)](_0x2bc33b(0x1e9));});}}),tgBot[_0x37a9eb(0x1ff)](/\/on/,_0x1b6484=>{const _0xa5664c=_0x37a9eb;if(!validateTelegram(_0x1b6484))return;tgBot[_0xa5664c(0x219)](_0xa5664c(0x1e9));const _0xadd4a0=getDisabledBots();if(_0xadd4a0['length']==0x0)tgBot[_0xa5664c(0x140)](_0x1b6484[_0xa5664c(0xe5)]['id'],_0xa5664c(0x205))[_0xa5664c(0xa0)](_0x286633=>{telegramError(_0x286633);});else{if(_0xadd4a0['length']>0x1)_0xadd4a0[_0xa5664c(0xed)]({'botID':_0xa5664c(0x89)});let _0x42a4ca=[],_0x941b40=[];const _0x1ef3ef=_0xadd4a0[_0xa5664c(0x20b)]%0x4==0x0||_0xadd4a0[_0xa5664c(0x20b)]%0x4==0x3||_0xadd4a0[_0xa5664c(0x20b)]%0x3==0x1?0x4:0x3;let _0x4c7bce=0x0;_0xadd4a0[_0xa5664c(0x1f6)]((_0x1315c4,_0xd0f2ed)=>{const _0x1bd19e=_0xa5664c;if(_0xd0f2ed%_0x1ef3ef==0x0)_0x941b40=[];_0x941b40['push']({'text':_0x1315c4[_0x1bd19e(0xf8)]==_0x1bd19e(0x89)?_0x1bd19e(0x130):_0x1bd19e(0x189)+_0x1315c4['botID'],'callback_data':_0x1315c4['botID']}),_0xd0f2ed%_0x1ef3ef==0x0&&(_0x42a4ca[_0x4c7bce]=_0x941b40,_0x4c7bce++);}),tgBot[_0xa5664c(0x140)](_0x1b6484[_0xa5664c(0xe5)]['id'],_0xa5664c(0x119),{'reply_markup':{'inline_keyboard':_0x42a4ca}})[_0xa5664c(0xa0)](_0x996e66=>{telegramError(_0x996e66);}),tgBot['on']('callback_query',async _0x3ae8f4=>{const _0x65fcbe=_0xa5664c,_0x3ca881=_0x3ae8f4['data'],_0x5d52eb=_0x3ae8f4['message'];tgBot[_0x65fcbe(0x22a)](_0x3ae8f4['id'])[_0x65fcbe(0x1f4)](async()=>{const _0x344492=_0x65fcbe;_0x3ca881==_0x344492(0x89)?(tgBot[_0x344492(0x140)](_0x5d52eb['chat']['id'],_0x344492(0xc6))[_0x344492(0xa0)](_0x46906e=>{telegramError(_0x46906e);}),_0xadd4a0[_0x344492(0x1f6)](_0x39bfad=>{const _0x2191a3=_0x344492;if(_0x39bfad['botID']!='all')toggleBot(_0x39bfad[_0x2191a3(0xf8)],toggleStatus(_0x39bfad[_0x2191a3(0xf8)]),'stopped');})):(tgBot[_0x344492(0x140)](_0x5d52eb[_0x344492(0xe5)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x3ca881)['catch'](_0x4566e0=>{telegramError(_0x4566e0);}),toggleBot(_0x3ca881,toggleStatus(_0x3ca881),_0x344492(0x188)));}),tgBot[_0x65fcbe(0x219)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x4b5621=>{const _0x47b691=_0x37a9eb;if(!validateTelegram(_0x4b5621))return;tgBot[_0x47b691(0x219)](_0x47b691(0x1e9));const _0x3800bd=getEnabledBots();if(_0x3800bd[_0x47b691(0x20b)]==0x0)tgBot[_0x47b691(0x140)](_0x4b5621['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x47b691(0xa0)](_0x127a23=>{telegramError(_0x127a23);});else{if(_0x3800bd[_0x47b691(0x20b)]>0x1)_0x3800bd[_0x47b691(0xed)]({'botID':'all'});let _0x538644=[],_0x3b73b4=[];const _0x574b18=_0x3800bd[_0x47b691(0x20b)]%0x4==0x0||_0x3800bd['length']%0x4==0x3||_0x3800bd['length']%0x3==0x1?0x4:0x3;let _0x5798ff=0x0;_0x3800bd[_0x47b691(0x1f6)]((_0x281b89,_0x1117b0)=>{const _0x4ff116=_0x47b691;if(_0x1117b0%_0x574b18==0x0)_0x3b73b4=[];_0x3b73b4[_0x4ff116(0xed)]({'text':_0x281b89[_0x4ff116(0xf8)]==_0x4ff116(0x89)?_0x4ff116(0x130):_0x4ff116(0x189)+_0x281b89[_0x4ff116(0xf8)],'callback_data':_0x281b89[_0x4ff116(0xf8)]}),_0x1117b0%_0x574b18==0x0&&(_0x538644[_0x5798ff]=_0x3b73b4,_0x5798ff++);}),tgBot[_0x47b691(0x140)](_0x4b5621[_0x47b691(0xe5)]['id'],_0x47b691(0x21e),{'reply_markup':{'inline_keyboard':_0x538644}})[_0x47b691(0xa0)](_0x49e690=>{telegramError(_0x49e690);}),tgBot['on'](_0x47b691(0x1e9),async _0x32a5de=>{const _0x17070c=_0x47b691,_0x2b628d=_0x32a5de[_0x17070c(0x1d8)],_0x3962b8=_0x32a5de[_0x17070c(0x1c3)];tgBot[_0x17070c(0x22a)](_0x32a5de['id'])[_0x17070c(0x1f4)](async()=>{const _0x3b3e65=_0x17070c;_0x2b628d==_0x3b3e65(0x89)?(tgBot[_0x3b3e65(0x140)](_0x3962b8[_0x3b3e65(0xe5)]['id'],_0x3b3e65(0x233))[_0x3b3e65(0xa0)](_0x14a9af=>{telegramError(_0x14a9af);}),_0x3800bd['forEach'](_0x3ad533=>{const _0x4b9499=_0x3b3e65;if(_0x3ad533[_0x4b9499(0xf8)]!=_0x4b9499(0x89))toggleBot(_0x3ad533[_0x4b9499(0xf8)],toggleStatus(_0x3ad533['botID']),_0x4b9499(0x188));})):(tgBot[_0x3b3e65(0x140)](_0x3962b8[_0x3b3e65(0xe5)]['id'],_0x3b3e65(0x122)+_0x2b628d)[_0x3b3e65(0xa0)](_0x49d7c3=>{telegramError(_0x49d7c3);}),toggleBot(_0x2b628d,toggleStatus(_0x2b628d),_0x3b3e65(0x188)));}),tgBot[_0x17070c(0x219)](_0x17070c(0x1e9));});}}),tgBot[_0x37a9eb(0x1ff)](/\/metrics/,_0xf2d1af=>{const _0x492c6f=_0x37a9eb;if(!validateTelegram(_0xf2d1af))return;tgBot[_0x492c6f(0x219)](_0x492c6f(0x1e9));const _0x6651b3=getEnabledBots();if(_0x6651b3[_0x492c6f(0x20b)]==0x0)tgBot['sendMessage'](_0xf2d1af[_0x492c6f(0xe5)]['id'],_0x492c6f(0x223))['catch'](_0x490e4f=>{telegramError(_0x490e4f);});else{if(_0x6651b3[_0x492c6f(0x20b)]>0x1){let _0x43a603=[],_0x56149a=[];const _0x34dc07=_0x6651b3[_0x492c6f(0x20b)]%0x4==0x0||_0x6651b3[_0x492c6f(0x20b)]%0x4==0x3||_0x6651b3['length']%0x3==0x1?0x4:0x3;let _0x1e4387=0x0;_0x6651b3[_0x492c6f(0x1f6)]((_0x484314,_0x13d0d9)=>{const _0x47ec25=_0x492c6f;if(_0x13d0d9%_0x34dc07==0x0)_0x56149a=[];_0x56149a[_0x47ec25(0xed)]({'text':_0x47ec25(0x189)+_0x484314['botID'],'callback_data':_0x484314[_0x47ec25(0xf8)]}),_0x13d0d9%_0x34dc07==0x0&&(_0x43a603[_0x1e4387]=_0x56149a,_0x1e4387++);}),tgBot[_0x492c6f(0x140)](_0xf2d1af[_0x492c6f(0xe5)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x43a603}})[_0x492c6f(0xa0)](_0x3ab8e5=>{telegramError(_0x3ab8e5);}),tgBot['on'](_0x492c6f(0x1e9),async _0x41f889=>{const _0x2a629a=_0x492c6f,_0x20a651=_0x41f889[_0x2a629a(0x1d8)],_0x5642bb=_0x41f889[_0x2a629a(0x1c3)];tgBot['answerCallbackQuery'](_0x41f889['id'])[_0x2a629a(0x1f4)](async()=>{const _0x8775f7=_0x2a629a;if(pid[_0x20a651])pid[_0x20a651][_0x8775f7(0x1bf)]({'function':'sendMetricsTelegram','args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x2106fd=_0x6651b3[0x0]['botID'];if(pid[_0x2106fd])pid[_0x2106fd][_0x492c6f(0x1bf)]({'function':_0x492c6f(0x1af),'args':null});}}}),tgBot[_0x37a9eb(0x1ff)](/\/portfolio/,_0x3a33b8=>{const _0x57b3ba=_0x37a9eb;if(!validateTelegram(_0x3a33b8))return;tgBot[_0x57b3ba(0x219)](_0x57b3ba(0x1e9));const _0x553876=getEnabledBots();if(_0x553876['length']==0x0)tgBot[_0x57b3ba(0x140)](_0x3a33b8[_0x57b3ba(0xe5)]['id'],_0x57b3ba(0x223))[_0x57b3ba(0xa0)](_0x556610=>{telegramError(_0x556610);});else{if(_0x553876[_0x57b3ba(0x20b)]>0x1){let _0x494763=[],_0x2d60eb=[];const _0x216306=_0x553876[_0x57b3ba(0x20b)]%0x4==0x0||_0x553876[_0x57b3ba(0x20b)]%0x4==0x3||_0x553876[_0x57b3ba(0x20b)]%0x3==0x1?0x4:0x3;let _0x39c898=0x0;_0x553876[_0x57b3ba(0x1f6)]((_0x1ce06b,_0x2fec3b)=>{const _0x2362b0=_0x57b3ba;if(_0x2fec3b%_0x216306==0x0)_0x2d60eb=[];_0x2d60eb[_0x2362b0(0xed)]({'text':_0x2362b0(0x189)+_0x1ce06b['botID'],'callback_data':_0x1ce06b['botID']}),_0x2fec3b%_0x216306==0x0&&(_0x494763[_0x39c898]=_0x2d60eb,_0x39c898++);}),tgBot['sendMessage'](_0x3a33b8['chat']['id'],_0x57b3ba(0xee),{'reply_markup':{'inline_keyboard':_0x494763}})['catch'](_0x5948a1=>{telegramError(_0x5948a1);}),tgBot['on'](_0x57b3ba(0x1e9),async _0x21a244=>{const _0x63d442=_0x57b3ba,_0x19d014=_0x21a244[_0x63d442(0x1d8)],_0x124d07=_0x21a244[_0x63d442(0x1c3)];tgBot['answerCallbackQuery'](_0x21a244['id'])[_0x63d442(0x1f4)](async()=>{const _0x527455=_0x63d442;if(pid[_0x19d014])pid[_0x19d014][_0x527455(0x1bf)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x63d442(0x219)](_0x63d442(0x1e9));});}else{const _0x401822=_0x553876[0x0]['botID'];if(pid[_0x401822])pid[_0x401822]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x37a9eb(0x1ff)](/\/update/,async _0xeb27ac=>{const _0x3566b7=_0x37a9eb;if(!validateTelegram(_0xeb27ac))return;tgBot[_0x3566b7(0x219)](_0x3566b7(0x1e9)),await getMessages();if(!updateAvailable)tgBot[_0x3566b7(0x140)](_0xeb27ac[_0x3566b7(0xe5)]['id'],_0x3566b7(0x22d))[_0x3566b7(0xa0)](_0x36968f=>{telegramError(_0x36968f);});else!validInstallation?tgBot[_0x3566b7(0x140)](_0xeb27ac['chat']['id'],_0x3566b7(0x1f8))['catch'](_0x356c30=>{telegramError(_0x356c30);}):(tgBot[_0x3566b7(0x140)](_0xeb27ac[_0x3566b7(0xe5)]['id'],_0x3566b7(0x138),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0x32e97c=>{telegramError(_0x32e97c);}),tgBot['on'](_0x3566b7(0x1e9),async _0x4b23a7=>{const _0x292ae0=_0x3566b7,_0x491cc8=_0x4b23a7[_0x292ae0(0x1d8)],_0x2981cd=_0x4b23a7[_0x292ae0(0x1c3)];tgBot['answerCallbackQuery'](_0x4b23a7['id'])[_0x292ae0(0x1f4)](async()=>{const _0x3ddad8=_0x292ae0;_0x491cc8==_0x3ddad8(0xa9)&&(await tgBot[_0x3ddad8(0x140)](_0x2981cd[_0x3ddad8(0xe5)]['id'],_0x3ddad8(0x196))['catch'](_0x1b8d02=>{telegramError(_0x1b8d02);}),updateBB('update')),_0x491cc8=='no'&&await tgBot['sendMessage'](_0x2981cd['chat']['id'],_0x3ddad8(0xba))[_0x3ddad8(0xa0)](_0x7a9b79=>{telegramError(_0x7a9b79);});}),tgBot[_0x292ae0(0x219)](_0x292ae0(0x1e9));}));}),tgBot[_0x37a9eb(0x1ff)](/\/reinstall/,async _0x916ae8=>{const _0x33eb2b=_0x37a9eb;if(!validateTelegram(_0x916ae8))return;tgBot[_0x33eb2b(0x219)](_0x33eb2b(0x1e9)),!validInstallation?tgBot[_0x33eb2b(0x140)](_0x916ae8[_0x33eb2b(0xe5)]['id'],_0x33eb2b(0x207))['catch'](_0x262f86=>{telegramError(_0x262f86);}):(tgBot['sendMessage'](_0x916ae8['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x33eb2b(0x112),'callback_data':_0x33eb2b(0xa9)},{'text':'No','callback_data':'no'}]]}})[_0x33eb2b(0xa0)](_0x4a11e2=>{telegramError(_0x4a11e2);}),tgBot['on'](_0x33eb2b(0x1e9),async _0x1dd38c=>{const _0xce7bf9=_0x33eb2b,_0x23c832=_0x1dd38c[_0xce7bf9(0x1d8)],_0x4e7321=_0x1dd38c[_0xce7bf9(0x1c3)];tgBot['answerCallbackQuery'](_0x1dd38c['id'])['then'](async()=>{const _0x5103a5=_0xce7bf9;_0x23c832==_0x5103a5(0xa9)&&(await tgBot['sendMessage'](_0x4e7321[_0x5103a5(0xe5)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x5103a5(0xa0)](_0x54cb31=>{telegramError(_0x54cb31);}),updateBB(_0x5103a5(0x11b))),_0x23c832=='no'&&await tgBot[_0x5103a5(0x140)](_0x4e7321['chat']['id'],_0x5103a5(0xf2))[_0x5103a5(0xa0)](_0x25d6df=>{telegramError(_0x25d6df);});}),tgBot[_0xce7bf9(0x219)](_0xce7bf9(0x1e9));}));}),tgBot['onText'](/\/toggle/,_0x5af386=>{const _0x2f73cd=_0x37a9eb;if(!validateTelegram(_0x5af386))return;tgBot[_0x2f73cd(0x219)]('callback_query');const _0x52241f=getBotsWithMode();if(_0x52241f[_0x2f73cd(0x20b)]==0x0)tgBot['sendMessage'](_0x5af386['chat']['id'],_0x2f73cd(0x223))['catch'](_0x4a1392=>{telegramError(_0x4a1392);});else{let _0x5dde6c=[],_0x2b2a08=[];const _0x290019=0x2;let _0x25bfb4=0x0;_0x52241f[_0x2f73cd(0x1f6)]((_0x2a1cc9,_0x20030b)=>{const _0x460a8b=_0x2f73cd;if(_0x20030b%_0x290019==0x0)_0x2b2a08=[];_0x2b2a08[_0x460a8b(0xed)]({'text':_0x460a8b(0x189)+_0x2a1cc9['botID']+'\x20('+_0x2a1cc9[_0x460a8b(0x17e)]+')','callback_data':_0x2a1cc9[_0x460a8b(0xf8)]}),_0x20030b%_0x290019==0x0&&(_0x5dde6c[_0x25bfb4]=_0x2b2a08,_0x25bfb4++);}),tgBot['sendMessage'](_0x5af386[_0x2f73cd(0xe5)]['id'],_0x2f73cd(0x173),{'reply_markup':{'inline_keyboard':_0x5dde6c}})[_0x2f73cd(0xa0)](_0x4eb7be=>{telegramError(_0x4eb7be);}),tgBot['on']('callback_query',async _0x5876f1=>{const _0x345dbc=_0x2f73cd,_0x12e264=_0x5876f1[_0x345dbc(0x1d8)],_0x3bb9be=_0x5876f1[_0x345dbc(0x1c3)];tgBot[_0x345dbc(0x22a)](_0x5876f1['id'])['then'](async()=>{const _0x252af5=_0x345dbc,_0x1ba83a=_0x52241f[_0x252af5(0x154)](_0x578a4c=>_0x578a4c['botID']==_0x12e264),_0x3de1d8=_0x1ba83a[_0x252af5(0x17e)]=='auto'?_0x252af5(0x103):_0x252af5(0xeb);tgBot['sendMessage'](_0x3bb9be[_0x252af5(0xe5)]['id'],_0x252af5(0x94)+_0x12e264+'\x20to\x20'+_0x3de1d8+'\x20mode')[_0x252af5(0xa0)](_0x48cac9=>{telegramError(_0x48cac9);}),toggleBotMode(_0x12e264);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x37a9eb(0x1ff)](/\/names/,_0x26dd08=>{const _0x59131f=_0x37a9eb;if(!validateTelegram(_0x26dd08))return;let _0x2d6d4b='';config[_0x59131f(0x1f6)](_0x19acf0=>{const _0x16e061=_0x59131f;_0x2d6d4b+=_0x16e061(0x189)+_0x19acf0[_0x16e061(0xf8)]+':\x20'+_0x19acf0[_0x16e061(0x10b)]+'\x0a';}),tgBot['sendMessage'](_0x26dd08[_0x59131f(0xe5)]['id'],_0x2d6d4b,{'parse_mode':_0x59131f(0x21f)})[_0x59131f(0xa0)](_0x69bb2=>{telegramError(_0x69bb2);});}),tgBot[_0x37a9eb(0x1ff)](/\/disable/,_0x2f7321=>{const _0x27b30d=_0x37a9eb;if(!validateTelegram(_0x2f7321))return;tgBot['sendMessage'](_0x2f7321[_0x27b30d(0xe5)]['id'],_0x27b30d(0x107))['catch'](_0x42a035=>{telegramError(_0x42a035);}),updateSetting(_0x27b30d(0x14b),![]);}),tgBot['onText'](/\/help/,_0x9e5f4d=>{const _0x318095=_0x37a9eb;if(!validateTelegram(_0x9e5f4d))return;tgBot[_0x318095(0x140)](_0x9e5f4d['chat']['id'],_0x59149e)[_0x318095(0xa0)](_0x455a22=>{telegramError(_0x455a22);});}),tgBot['on']('polling_error',_0x3cdb5d=>{const _0x32a0eb=_0x37a9eb;_0x3cdb5d[_0x32a0eb(0x148)]()[_0x32a0eb(0xa5)](_0x32a0eb(0x86))&&(logger[_0x32a0eb(0xcb)](_0x32a0eb(0x155)),tgBot[_0x32a0eb(0x13a)](),tgBot=null,io['to'](_0x32a0eb(0x220))['emit'](_0x32a0eb(0x17b),'Invalid\x20Telegram\x20token'));}),process['once'](_0x37a9eb(0xdc),()=>{const _0x4f2f66=_0x37a9eb;if(tgBot)tgBot['stopPolling']();process[_0x4f2f66(0x23f)](0x1);}),process['once'](_0x37a9eb(0x218),()=>{const _0x34469a=_0x37a9eb;if(tgBot)tgBot[_0x34469a(0x13a)]();process[_0x34469a(0x23f)](0x1);});}}function disableTelegram(){const _0x3c0ebd=_0x30403f;tgBot&&(tgBot[_0x3c0ebd(0x13a)](),tgBot=null);}function sendTelegram(_0x5e6233,_0x14c8aa){const _0x31eabd=_0x30403f;if(settings[_0x31eabd(0x14b)]){if(settings[_0x31eabd(0xe0)]=='all'||(_0x14c8aa[_0x31eabd(0x1ca)]==_0x31eabd(0x1b3)||_0x14c8aa['type']==_0x31eabd(0x10f)||_0x14c8aa[_0x31eabd(0x1ca)]==_0x31eabd(0x245))&&settings[_0x31eabd(0xe0)]=='alerts'||_0x14c8aa[_0x31eabd(0x1ca)]==_0x31eabd(0x24f)&&settings[_0x31eabd(0xe0)]==_0x31eabd(0x191)){if(tgBot&&settings[_0x31eabd(0x1da)]){if(_0x14c8aa[_0x31eabd(0x1bd)])tgBot[_0x31eabd(0x140)](settings[_0x31eabd(0x1da)],_0x14c8aa[_0x31eabd(0x10b)]+_0x31eabd(0x99)+_0x14c8aa[_0x31eabd(0x142)])[_0x31eabd(0xa0)](_0x2a0b7e=>{telegramError(_0x2a0b7e);});else tgBot[_0x31eabd(0x140)](settings[_0x31eabd(0x1da)],_0x31eabd(0x189)+_0x5e6233+_0x31eabd(0x99)+_0x14c8aa[_0x31eabd(0x142)])[_0x31eabd(0xa0)](_0x176f8=>{telegramError(_0x176f8);});}}}}async function sendTelegramMsg(_0x160e49,_0x218eb8='HTML'){const _0x38d83d=_0x30403f;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await tgBot[_0x38d83d(0x140)](settings[_0x38d83d(0x1da)],_0x160e49,{'parse_mode':_0x218eb8})['catch'](_0x5b583e=>{telegramError(_0x5b583e);}),!![]):![];}function getDeviceWithIp(_0x9ab651){return devices['find'](_0x215004=>_0x215004['ip']===_0x9ab651);}function temporaryAccess2FA(_0x30bbfb,_0x2f06cd){const _0x52532a=_0x30403f;let _0x1b78bc=new Date(),_0x55b847=![];if(lastIpApproval){if(_0x1b78bc-lastIpApproval<0x1388)_0x55b847=!![];}lastIpApproval=new Date();if(_0x55b847)return;tgBot&&settings[_0x52532a(0x1da)]&&(tgBot[_0x52532a(0x219)]('callback_query'),tgBot[_0x52532a(0x140)](settings[_0x52532a(0x1da)],_0x52532a(0x9b)+normalizeIP(_0x2f06cd)[_0x52532a(0x172)]+_0x52532a(0x97),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x52532a(0x18c),'callback_data':'5'},{'text':_0x52532a(0x216),'callback_data':'15'},{'text':_0x52532a(0x206),'callback_data':'30'},{'text':'reject','callback_data':_0x52532a(0x10d)}]]}})[_0x52532a(0xa0)](_0x547f83=>{telegramError(_0x547f83);}),tgBot['on'](_0x52532a(0x1e9),async _0x46acc2=>{const _0x2e21c7=_0x52532a,_0x41349e=_0x46acc2[_0x2e21c7(0x1d8)],_0x2a7c70=_0x46acc2['message'];tgBot[_0x2e21c7(0x22a)](_0x46acc2['id'])[_0x2e21c7(0x1f4)](async()=>{const _0x2f34bb=_0x2e21c7;devices[_0x30bbfb][_0x2f34bb(0x1b2)]={'clientip':_0x2f06cd,'timestamp':new Date()['getTime'](),'expiry':_0x41349e},_0x41349e!=_0x2f34bb(0x10d)?(await tgBot[_0x2f34bb(0x140)](_0x2a7c70[_0x2f34bb(0xe5)]['id'],_0x2f34bb(0x19e)+_0x41349e+_0x2f34bb(0x194),{'parse_mode':_0x2f34bb(0x21f)})[_0x2f34bb(0xa0)](_0x4bb8d3=>{telegramError(_0x4bb8d3);}),io['to'](_0x30bbfb)[_0x2f34bb(0x131)](_0x2f34bb(0x1de),{'access':{'allow':![],'reason':_0x2f34bb(0x209),'token':null}})):(await tgBot[_0x2f34bb(0x140)](_0x2a7c70[_0x2f34bb(0xe5)]['id'],'Temporary\x20access\x20rejected')[_0x2f34bb(0xa0)](_0x2c6fc5=>{telegramError(_0x2c6fc5);}),io['to'](_0x30bbfb)[_0x2f34bb(0x131)](_0x2f34bb(0x1de),{'access':{'allow':![],'reason':_0x2f34bb(0xf0),'token':null}}));}),tgBot[_0x2e21c7(0x219)](_0x2e21c7(0x1e9));}));}function loginAccess2FA(_0x17b3db,_0xead334){const _0x424acc=_0x30403f;tgBot&&settings[_0x424acc(0x1da)]&&(tgBot[_0x424acc(0x219)]('callback_query'),tgBot[_0x424acc(0x140)](settings[_0x424acc(0x1da)],_0x424acc(0x23d)+normalizeIP(_0xead334)[_0x424acc(0x172)]+_0x424acc(0x97),{'parse_mode':_0x424acc(0x21f),'reply_markup':{'inline_keyboard':[[{'text':_0x424acc(0x1f2),'callback_data':loginExpiry},{'text':_0x424acc(0x10d),'callback_data':'reject'}]]}})[_0x424acc(0xa0)](_0x2302b3=>{telegramError(_0x2302b3);}),tgBot['on']('callback_query',async _0x166679=>{const _0x4e950c=_0x424acc,_0x2b2345=_0x166679[_0x4e950c(0x1d8)],_0x49f48=_0x166679[_0x4e950c(0x1c3)];tgBot[_0x4e950c(0x22a)](_0x166679['id'])[_0x4e950c(0x1f4)](async()=>{const _0xfdbdb9=_0x4e950c;devices[_0x17b3db][_0xfdbdb9(0x18a)]={'clientip':_0xead334,'timestamp':new Date()[_0xfdbdb9(0xa7)](),'expiry':_0x2b2345},_0x2b2345!=_0xfdbdb9(0x10d)?(await tgBot[_0xfdbdb9(0x140)](_0x49f48[_0xfdbdb9(0xe5)]['id'],'Login\x20accepted',{'parse_mode':_0xfdbdb9(0x21f)})[_0xfdbdb9(0xa0)](_0x2091ef=>{telegramError(_0x2091ef);}),io['to'](_0x17b3db)[_0xfdbdb9(0x131)](_0xfdbdb9(0x1de),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x49f48['chat']['id'],_0xfdbdb9(0x1cc))['catch'](_0x387545=>{telegramError(_0x387545);}),io['to'](_0x17b3db)[_0xfdbdb9(0x131)](_0xfdbdb9(0x1de),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x4e950c(0x219)](_0x4e950c(0x1e9));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x663179=_0x30403f;return dbConfig[_0x663179(0x251)](_0x663179(0xe4))['sortBy'](_0x663179(0xf8))[_0x663179(0x129)]({'status':'enabled'})[_0x663179(0xb5)]()||[];}function getDisabledBots(){const _0x23d199=_0x30403f;return dbConfig['get']('bots')[_0x23d199(0x198)](_0x23d199(0xf8))[_0x23d199(0x129)]({'status':'disabled'})[_0x23d199(0xb5)]()||[];}function getBotAttributes(_0x4ef515){const _0x4cb4e2=_0x30403f;let _0x3c1494={};const _0x5f306c=configpath+_0x4cb4e2(0xbe)+_0x4ef515+_0x4cb4e2(0x255),_0x54168b=fs[_0x4cb4e2(0xec)](_0x5f306c);if(_0x54168b){const _0x3bf8b2=fs[_0x4cb4e2(0x163)](_0x5f306c);try{const _0x55453f=JSON[_0x4cb4e2(0xac)](_0x3bf8b2),_0xc313dd=_0x55453f?_0x55453f['bot'][0x0][_0x4cb4e2(0x1a7)]:![];_0x3c1494['mode']=_0xc313dd?'auto':'manual',_0x3c1494['botname']=_0x55453f?_0x55453f['bot'][0x0][_0x4cb4e2(0x10b)]:'Bot\x20'+_0x4ef515;}catch(_0x2a492c){_0x3c1494[_0x4cb4e2(0x17e)]=_0x4cb4e2(0x103),_0x3c1494[_0x4cb4e2(0x10b)]='Bot\x20'+_0x4ef515;}}else _0x3c1494['mode']=_0x4cb4e2(0x103),_0x3c1494[_0x4cb4e2(0x10b)]=_0x4cb4e2(0x189)+_0x4ef515;return _0x3c1494;}function getBotsWithMode(){const _0x2251c0=_0x30403f,_0x2b3fe6=dbConfig[_0x2251c0(0x251)](_0x2251c0(0xe4))[_0x2251c0(0x198)](_0x2251c0(0xf8))[_0x2251c0(0xb5)]()||[];return _0x2b3fe6[_0x2251c0(0x1f6)](_0x2cfb93=>{const _0x3815ae=_0x2251c0;let _0x3fbd51=getBotAttributes(_0x2cfb93[_0x3815ae(0xf8)]);_0x2cfb93[_0x3815ae(0x17e)]=_0x3fbd51[_0x3815ae(0x17e)];}),_0x2b3fe6;}function getBotExchanges(){const _0x5f316f=_0x30403f;let _0x5e5926=[];const _0x5f0eda=dbConfig['get'](_0x5f316f(0xe4))[_0x5f316f(0x198)](_0x5f316f(0xf8))[_0x5f316f(0xb5)]()||[];_0x5f0eda['forEach'](_0x179583=>{const _0x44d3a6=_0x5f316f;if(_0x179583[_0x44d3a6(0x1de)]=='enabled'){const _0x344404=configpath+_0x44d3a6(0xbe)+_0x179583[_0x44d3a6(0xf8)]+_0x44d3a6(0x255),_0x2181d0=fs['existsSync'](_0x344404);let _0x214b5c;if(_0x2181d0){const _0x331fcd=fs[_0x44d3a6(0x163)](_0x344404);try{const _0x352384=JSON[_0x44d3a6(0xac)](_0x331fcd);_0x214b5c=_0x352384?_0x352384[_0x44d3a6(0x9c)][0x0][_0x44d3a6(0xb0)]:null;}catch(_0x565433){}}if(_0x214b5c)_0x5e5926['push'](_0x214b5c);}});const _0x2f10ad=[...new Set(_0x5e5926)][_0x5f316f(0x153)]();return _0x2f10ad;}async function initUser(){const _0x3974b0=_0x30403f;if(!settings['userid']){const _0x3577b5=uuidRandom();mixpanel[_0x3974b0(0xe3)](_0x3577b5),updateSetting(_0x3974b0(0x203),_0x3577b5);}}async function initSecure(){const _0x2d51c9=_0x30403f;let _0x45d1b1=getSecure();if(!_0x45d1b1[_0x2d51c9(0xca)](_0x2d51c9(0x1c6))){let _0xfedac4=await generateKeys();_0x45d1b1['publicKey']=_0xfedac4[_0x2d51c9(0x19c)],_0x45d1b1[_0x2d51c9(0xbf)]=_0xfedac4[_0x2d51c9(0xbf)],_0x45d1b1[_0x2d51c9(0x1c6)]=crypto[_0x2d51c9(0x19b)](0x20)[_0x2d51c9(0x148)]('hex');;storeSecure(_0x45d1b1);}}function getSettings(){const _0x11e6c4=_0x30403f;return dbSettings[_0x11e6c4(0x251)](_0x11e6c4(0x210))[_0x11e6c4(0xb5)]()||{};}function getSecure(){const _0x19d42b=_0x30403f;return dbSecure[_0x19d42b(0x251)](_0x19d42b(0x1a9))[_0x19d42b(0xb5)]()||{};}function getBlacklist(){const _0x1b3c7d=_0x30403f;return dbSecure[_0x1b3c7d(0x251)](_0x1b3c7d(0x9a))[_0x1b3c7d(0xb5)]()||[];}function broadcastToBots(_0x195230,_0x4d95a2){const _0x8dda1c=_0x30403f;config[_0x8dda1c(0x1f6)](_0x5ffcae=>{const _0x4df969=_0x8dda1c;if(_0x5ffcae['status']=='enabled'&&_0x5ffcae[_0x4df969(0x174)]==_0x4df969(0x150)||_0x5ffcae['status']=='new'&&_0x5ffcae[_0x4df969(0x174)]==_0x4df969(0x150)){if(pid[_0x5ffcae[_0x4df969(0xf8)]])pid[_0x5ffcae[_0x4df969(0xf8)]][_0x4df969(0x1bf)]({[_0x195230]:_0x4d95a2});}});}function storeSettings(_0x1dbe81,_0x6d58a8=![]){const _0x240170=_0x30403f;_0x1dbe81={...settings,..._0x1dbe81};if(_0x6d58a8&&_0x1dbe81[_0x240170(0x1d7)]!=_0x240170(0x186)&&_0x1dbe81[_0x240170(0x1d7)]!=_0x240170(0x1e6)&&_0x1dbe81[_0x240170(0x1d7)]!=''){const _0x23b564=crypt[_0x240170(0x1f1)](secure[_0x240170(0xbf)],_0x1dbe81[_0x240170(0x1d7)])['message']['split']('@')[0x0],_0xc022e0=bcrypt[_0x240170(0x176)](_0x23b564,saltRounds);_0x1dbe81={..._0x1dbe81,'bbPassword':_0xc022e0};}if(_0x6d58a8&&_0x1dbe81[_0x240170(0x164)]!=_0x240170(0x186)&&_0x1dbe81[_0x240170(0x164)]!=_0x240170(0x1e6)&&_0x1dbe81[_0x240170(0x164)]!=''){const _0x2c0aaf=crypt['decrypt'](secure[_0x240170(0xbf)],_0x1dbe81[_0x240170(0x164)])['message'][_0x240170(0x1fc)]('@')[0x0];_0x1dbe81={..._0x1dbe81,'telegramToken':_0x2c0aaf};}const _0x37e224=_0x1dbe81[_0x240170(0x164)]!=_0x240170(0x186)&&_0x1dbe81[_0x240170(0x164)]!=settings[_0x240170(0x164)]||_0x1dbe81[_0x240170(0x1f5)]!=settings['telegramUsername'],_0x4accff=_0x1dbe81[_0x240170(0x164)]==''||_0x1dbe81['telegramUsername']=='';if(_0x37e224)_0x1dbe81[_0x240170(0xe0)]=_0x240170(0x89);for(const [_0x10fad2,_0x503d6e]of Object[_0x240170(0x1ec)](_0x1dbe81)){if(_0x10fad2=='telegramToken'&&_0x503d6e==_0x240170(0x186)){_0x1dbe81[_0x240170(0x164)]=settings[_0x240170(0x164)];continue;};if(_0x10fad2==_0x240170(0x1d7)&&_0x503d6e==_0x240170(0x186)){_0x1dbe81[_0x240170(0x1d7)]=settings[_0x240170(0x1d7)];continue;};dbSettings[_0x240170(0x1f3)](_0x240170(0x121)+_0x10fad2,_0x503d6e)[_0x240170(0x178)]();}settings=_0x1dbe81,io['to']('botmanager')[_0x240170(0x131)]('settings',cleanSettings()),broadcastToBots(_0x240170(0x249),settings[_0x240170(0x249)]),broadcastToBots(_0x240170(0xdd),settings[_0x240170(0xdd)]);if(_0x37e224&&!_0x4accff)initTelegram();if(_0x37e224&&_0x4accff)disableTelegram();getAllClients()[_0x240170(0x1f6)](_0x12ff5b=>{const _0x977d03=_0x240170;getSocket(_0x12ff5b['id'])[_0x977d03(0x131)](_0x977d03(0x1de),{'access':{'allow':![],'reason':_0x977d03(0x209),'token':null}});});}function updateSetting(_0x3dd431,_0x325995){const _0x1d1283=_0x30403f;dbSettings[_0x1d1283(0x1f3)]('settings.'+_0x3dd431,_0x325995)[_0x1d1283(0x178)](),settings=getSettings(),io['to'](_0x1d1283(0x220))[_0x1d1283(0x131)]('settings',cleanSettings());}function storeSecure(_0x289c13){const _0x56a823=_0x30403f;dbSecure[_0x56a823(0x251)](_0x56a823(0x1a9))[_0x56a823(0xed)](_0x289c13)[_0x56a823(0x178)](),secure=_0x289c13;}function addBlacklist(_0x5af9ef){const _0x22d9e4=_0x30403f;cleanBlacklist();let _0x5ba1cf;devices[_0x5af9ef][_0x22d9e4(0x1b2)]?_0x5ba1cf=Math[_0x22d9e4(0x15f)](devices[_0x5af9ef][_0x22d9e4(0x1b2)]['expiry'],loginExpiry):_0x5ba1cf=loginExpiry,dbSecure[_0x22d9e4(0x251)](_0x22d9e4(0x9a))[_0x22d9e4(0xed)]({'expiry':new Date()[_0x22d9e4(0xa7)]()+_0x5ba1cf*0x3c*0x3e8,'token':devices[_0x5af9ef]['access'][_0x22d9e4(0x132)]})[_0x22d9e4(0x178)](),blacklist=dbSecure['get'](_0x22d9e4(0x9a))['value']();}function cleanBlacklist(){const _0x51caab=_0x30403f;let _0x365786=dbSecure[_0x51caab(0x251)](_0x51caab(0x9a))[_0x51caab(0xb9)]()[_0x51caab(0xb5)](),_0x46a9aa=new Date()[_0x51caab(0xa7)]();_0x365786['forEach'](_0x258304=>{const _0xd88ee=_0x51caab;_0x258304[_0xd88ee(0x16d)]<_0x46a9aa&&dbSecure[_0xd88ee(0x251)](_0xd88ee(0x9a))[_0xd88ee(0x13c)]({'expiry':_0x258304[_0xd88ee(0x16d)]})['write']();});}function initStates(){const _0xd3d725=_0x30403f;let _0x4e1a6b=getConfiguration();_0x4e1a6b[_0xd3d725(0x1f6)](_0x2c64a4=>{_0x2c64a4['live']='stopped';}),storeConfiguration(_0x4e1a6b);}function onKeys(){const _0x3eb3b9=new RSA();return new Promise(_0x54be45=>{const _0x43b752=_0x2f85;_0x3eb3b9[_0x43b752(0xc3)]()[_0x43b752(0x1f4)](_0x197966=>{_0x54be45(_0x197966);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4d731a=_0x30403f;let _0x1a9ab1=getSettings(),_0x1ef475=![];!_0x1a9ab1[_0x4d731a(0xca)](_0x4d731a(0x1cb))&&(_0x1a9ab1['lastmsgtelegram']=0x0,_0x1ef475=!![]);!_0x1a9ab1['hasOwnProperty']('lastmsgemitted')&&(_0x1a9ab1[_0x4d731a(0x25d)]=0x0,_0x1ef475=!![]);!_0x1a9ab1[_0x4d731a(0xca)](_0x4d731a(0x1ad))&&(_0x1a9ab1[_0x4d731a(0x1ad)]=_0x4d731a(0x83),_0x1ef475=!![]);!_0x1a9ab1[_0x4d731a(0xca)](_0x4d731a(0xdd))&&(_0x1a9ab1[_0x4d731a(0xdd)]=![],_0x1ef475=!![]);if(_0x1ef475)storeSettings(_0x1a9ab1);}function storeConfiguration(_0x36b02e){const _0x2a1822=_0x30403f;dbConfig[_0x2a1822(0x251)](_0x2a1822(0xe4))[_0x2a1822(0x13c)]()[_0x2a1822(0x178)](),_0x36b02e[_0x2a1822(0x1f6)](_0x1acd93=>{delete _0x1acd93['mode'];}),dbConfig[_0x2a1822(0x251)]('bots')[_0x2a1822(0xed)](..._0x36b02e)[_0x2a1822(0x178)](),config=_0x36b02e;}function resetPassword(){const _0x4da560=_0x30403f;tgBot&&settings[_0x4da560(0x1da)]&&(tgBot[_0x4da560(0x219)](_0x4da560(0x1e9)),tgBot['sendMessage'](settings[_0x4da560(0x1da)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4da560(0xa9),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1b4747=>{telegramError(_0x1b4747);}),tgBot['on']('callback_query',async _0x45977d=>{const _0x51bb1d=_0x4da560,_0x3ed906=_0x45977d['data'],_0x4d1c56=_0x45977d[_0x51bb1d(0x1c3)];tgBot[_0x51bb1d(0x22a)](_0x45977d['id'])[_0x51bb1d(0x1f4)](async()=>{const _0x52eb2e=_0x51bb1d;if(_0x3ed906!='no'){const _0x40fce2=0xf,_0x3bad6c=_0x52eb2e(0x16c),_0x185fb0=Array['from'](crypto[_0x52eb2e(0x91)](new Uint32Array(_0x40fce2)))['map'](_0x323fdc=>_0x3bad6c[_0x323fdc%_0x3bad6c[_0x52eb2e(0x20b)]])['join'](''),_0x175336=bcrypt[_0x52eb2e(0x176)](_0x185fb0,saltRounds);storeSettings({'bbPassword':_0x175336}),await tgBot['sendMessage'](_0x4d1c56[_0x52eb2e(0xe5)]['id'],_0x52eb2e(0x199)+_0x185fb0,{'parse_mode':_0x52eb2e(0x21f)})[_0x52eb2e(0xa0)](_0xc80026=>{telegramError(_0xc80026);});}else await tgBot[_0x52eb2e(0x140)](_0x4d1c56['chat']['id'],_0x52eb2e(0xb2))[_0x52eb2e(0xa0)](_0x4fa2a4=>{telegramError(_0x4fa2a4);});}),tgBot[_0x51bb1d(0x219)](_0x51bb1d(0x1e9));}));}async function confirmRestore(_0x577fac,_0x55d365){const _0x4f161c=_0x30403f;io['to'](_0x4f161c(0x220))[_0x4f161c(0x131)](_0x4f161c(0x17b),_0x4f161c(0x128),_0x4f161c(0x245)),tgBot&&settings[_0x4f161c(0x1da)]&&(tgBot[_0x4f161c(0x219)](_0x4f161c(0x1e9)),await tgBot[_0x4f161c(0x140)](settings['telegramChatId'],_0x4f161c(0x106),{'parse_mode':_0x4f161c(0x21f),'reply_markup':{'inline_keyboard':[[{'text':_0x4f161c(0xa9),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x5a9555=>{telegramError(_0x5a9555);}),tgBot['on'](_0x4f161c(0x1e9),async _0x5dc5d0=>{const _0x5aa5d3=_0x4f161c,_0x391325=_0x5dc5d0[_0x5aa5d3(0x1d8)],_0x1d772f=_0x5dc5d0[_0x5aa5d3(0x1c3)];tgBot[_0x5aa5d3(0x22a)](_0x5dc5d0['id'])[_0x5aa5d3(0x1f4)](async()=>{const _0x4be1f8=_0x5aa5d3;_0x391325==_0x4be1f8(0xa9)?(await tgBot[_0x4be1f8(0x140)](_0x1d772f['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x4be1f8(0x21f)})[_0x4be1f8(0xa0)](_0x31db09=>{telegramError(_0x31db09);}),unzipFile(_0x577fac,_0x55d365)):(logger[_0x4be1f8(0x25b)](_0x4be1f8(0x161)),await tgBot[_0x4be1f8(0x140)](_0x1d772f['chat']['id'],_0x4be1f8(0x161))[_0x4be1f8(0xa0)](_0xa01ed1=>{telegramError(_0xa01ed1);}));}),tgBot['removeListener'](_0x5aa5d3(0x1e9));}));}function getServerTime(){const _0x178695=_0x30403f,_0x5d318d=new Date();return _0x5d318d[_0x178695(0x187)]()+'/'+(_0x5d318d['getMonth']()+0x1)[_0x178695(0x148)]()['padStart'](0x2,'0')+'/'+_0x5d318d[_0x178695(0xff)]()[_0x178695(0x148)]()[_0x178695(0xc7)](0x2,'0')+'\x20'+_0x5d318d['getHours']()[_0x178695(0x148)]()[_0x178695(0xc7)](0x2,'0')+':'+_0x5d318d[_0x178695(0x113)]()[_0x178695(0x148)]()[_0x178695(0xc7)](0x2,'0')+':'+_0x5d318d[_0x178695(0x98)]()['toString']()[_0x178695(0xc7)](0x2,'0');}function getTimeStamp(){const _0x2fb464=_0x30403f,_0x2b8225=shiftedTime();return _0x2b8225['getFullYear']()+'/'+(_0x2b8225[_0x2fb464(0x250)]()+0x1)[_0x2fb464(0x148)]()[_0x2fb464(0xc7)](0x2,'0')+'/'+_0x2b8225[_0x2fb464(0xff)]()[_0x2fb464(0x148)]()['padStart'](0x2,'0')+'\x20'+_0x2b8225[_0x2fb464(0x135)]()[_0x2fb464(0x148)]()[_0x2fb464(0xc7)](0x2,'0')+':'+_0x2b8225['getMinutes']()[_0x2fb464(0x148)]()[_0x2fb464(0xc7)](0x2,'0')+':'+_0x2b8225[_0x2fb464(0x98)]()[_0x2fb464(0x148)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0xa5754e=_0x30403f,_0x3539ce=shiftedTime();return _0x3539ce[_0xa5754e(0x187)]()+(_0x3539ce[_0xa5754e(0x250)]()+0x1)[_0xa5754e(0x148)]()['padStart'](0x2,'0')+_0x3539ce['getDate']()[_0xa5754e(0x148)]()[_0xa5754e(0xc7)](0x2,'0')+'-'+_0x3539ce[_0xa5754e(0x135)]()['toString']()['padStart'](0x2,'0')+_0x3539ce['getMinutes']()[_0xa5754e(0x148)]()[_0xa5754e(0xc7)](0x2,'0')+_0x3539ce[_0xa5754e(0x98)]()[_0xa5754e(0x148)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x13ffb3=_0x30403f,_0x3d36c0=new Date();let _0x28c17a=_0x3d36c0;if(settings[_0x13ffb3(0x249)]&&settings[_0x13ffb3(0x249)]!==0x0)_0x28c17a=fns[_0x13ffb3(0x136)](_0x3d36c0,{'hours':settings['timeshift']});return _0x28c17a;}function startScheduler(){const _0x59d4c9=_0x30403f,_0x392781=new Date()['getUTCHours'](),_0x40cc6d=shiftedTime()[_0x59d4c9(0x135)]();_0x40cc6d==0x4&&backupConfigFiles();_0x40cc6d==0x0&&rotateLogFiles();_0x392781%0x6==0x0&&triggerAnalytics();_0x392781%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x538427){const _0x938938=_0x30403f;logger[_0x938938(0x25b)](_0x938938(0xd8)+_0x538427);const _0x2387f0=getBotsWithMode();_0x2387f0['length']>0x0?confirmRestore(configbackuppath,_0x538427):unzipFile(configbackuppath,_0x538427);}async function getBackupFiles(_0x39992d=null){const _0x11b4f0=_0x30403f;let _0x2abf5c=[],_0x3fa9c1=fs[_0x11b4f0(0x10e)](configbackuppath,{'withFileTypes':!![]});_0x3fa9c1['sort']((_0x160f1b,_0x3df635)=>_0x160f1b[_0x11b4f0(0x1d9)]<_0x3df635[_0x11b4f0(0x1d9)]?0x1:_0x3df635[_0x11b4f0(0x1d9)]<_0x160f1b[_0x11b4f0(0x1d9)]?-0x1:0x0),_0x3fa9c1['forEach'](_0x487c51=>{const _0x38ec67=_0x11b4f0;if(!_0x487c51[_0x38ec67(0x14e)]()&&_0x487c51[_0x38ec67(0x1d9)]['startsWith'](_0x38ec67(0x1be))&&_0x487c51[_0x38ec67(0x1d9)]['endsWith']('.zip')){const _0x293d54=formatDate(fs['statSync'](configbackuppath+_0x487c51[_0x38ec67(0x1d9)])[_0x38ec67(0x238)]);_0x2abf5c[_0x38ec67(0xed)]({'name':_0x487c51['name'],'mtime':_0x293d54});}});if(_0x39992d)io['to'](_0x39992d)[_0x11b4f0(0x131)](_0x11b4f0(0x1b1),_0x2abf5c);else return _0x2abf5c;}async function backupConfigFiles(){const _0x36dff=_0x30403f;await zipFiles('backup-full');const _0x357e35=getCleanTimeStamp();fs[_0x36dff(0x1b7)](zippath+_0x36dff(0x92),configbackuppath+('backup-full@'+_0x357e35+_0x36dff(0xfa)));let _0x161de1=fs[_0x36dff(0x10e)](configbackuppath,{'withFileTypes':!![]});_0x161de1[_0x36dff(0x153)]((_0x588cc7,_0x910b34)=>_0x588cc7[_0x36dff(0x1d9)]<_0x910b34[_0x36dff(0x1d9)]?0x1:_0x910b34[_0x36dff(0x1d9)]<_0x588cc7[_0x36dff(0x1d9)]?-0x1:0x0),_0x161de1[_0x36dff(0x20b)]>maxBackups&&fs[_0x36dff(0xd4)](configbackuppath+_0x161de1[maxBackups][_0x36dff(0x1d9)]);}function rotateLogFiles(){const _0x3c1cef=_0x30403f,_0x339bfa=fs[_0x3c1cef(0x88)](logspath+_0x3c1cef(0x17a)),_0xbf9a59=_0x339bfa[_0x3c1cef(0xbb)]/0x400;if(_0xbf9a59>0x64){let _0x50ef2b=fs[_0x3c1cef(0x10e)](logspath,{'withFileTypes':!![]});_0x50ef2b[_0x3c1cef(0x153)]((_0x1a6f2a,_0x5bdaf9)=>_0x1a6f2a['name']<_0x5bdaf9[_0x3c1cef(0x1d9)]?0x1:_0x5bdaf9['name']<_0x1a6f2a[_0x3c1cef(0x1d9)]?-0x1:0x0),_0x50ef2b['forEach'](_0x32cbf7=>{const _0x345f93=_0x3c1cef;if(_0x32cbf7[_0x345f93(0x1d9)]==_0x345f93(0xb6))fs[_0x345f93(0x1b7)](logspath+_0x32cbf7[_0x345f93(0x1d9)],logspath+'output-003.log');if(_0x32cbf7[_0x345f93(0x1d9)]=='output-001.log')fs[_0x345f93(0x1b7)](logspath+_0x32cbf7[_0x345f93(0x1d9)],logspath+'output-002.log');_0x32cbf7[_0x345f93(0x1d9)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x32cbf7[_0x345f93(0x1d9)],logspath+_0x345f93(0x169)),fs['writeFileSync'](logspath+_0x32cbf7['name'],''));});}}async function zipFiles(_0x1ee559){const _0x27506c=_0x30403f;let _0x129920;if(_0x1ee559==_0x27506c(0x1a1))_0x129920=logspath;if(_0x1ee559=='backup')_0x129920=configpath;if(_0x1ee559==_0x27506c(0x11c))_0x129920=configpath;let _0x38e85b=fs[_0x27506c(0x10e)](_0x129920,{'withFileTypes':!![]});const _0x56b89e=new require(_0x27506c(0x25e))();_0x38e85b[_0x27506c(0x1f6)](_0x411c67=>{const _0x56d779=_0x27506c;if(!_0x411c67[_0x56d779(0x14e)]()){let _0x415fee=fs['readFileSync'](_0x129920+_0x411c67[_0x56d779(0x1d9)]);if(_0x1ee559==_0x56d779(0x1c4)){const _0x408d5b=/^bot-[0-9]{3}-config.json$/,_0x170e14=_0x408d5b[_0x56d779(0x1b0)](_0x411c67[_0x56d779(0x1d9)]);if(_0x170e14){const _0x5b614e=JSON[_0x56d779(0xac)](_0x415fee);if(_0x5b614e[_0x56d779(0x9c)][0x0]){_0x5b614e['bot'][0x0][_0x56d779(0x214)]=_0x56d779(0x1e6),_0x5b614e[_0x56d779(0x9c)][0x0][_0x56d779(0x9e)]=_0x56d779(0x1e6);if(_0x5b614e[_0x56d779(0x9c)][0x0][_0x56d779(0x21a)])_0x5b614e[_0x56d779(0x9c)][0x0][_0x56d779(0x21a)]=_0x56d779(0x1e6);}_0x415fee=JSON[_0x56d779(0xef)](_0x5b614e,null,0x2);}if(_0x411c67['name']==_0x56d779(0x1fe)){const _0x566ae9=JSON[_0x56d779(0xac)](_0x415fee);if(_0x566ae9[_0x56d779(0x210)][_0x56d779(0x1d2)])_0x566ae9[_0x56d779(0x210)][_0x56d779(0x1d2)]=![];if(_0x566ae9[_0x56d779(0x210)]['bbPassword'])_0x566ae9[_0x56d779(0x210)]['bbPassword']='***';if(_0x566ae9['settings']['telegramToken'])_0x566ae9[_0x56d779(0x210)][_0x56d779(0x164)]=_0x56d779(0x1e6);if(_0x566ae9[_0x56d779(0x210)][_0x56d779(0x1da)])_0x566ae9['settings']['telegramChatId']=null;_0x415fee=JSON[_0x56d779(0xef)](_0x566ae9,null,0x2);}if(_0x411c67['name']!='bb-secure.json')_0x56b89e[_0x56d779(0xaa)](_0x411c67['name'],_0x415fee);}else _0x56b89e[_0x56d779(0xaa)](_0x411c67[_0x56d779(0x1d9)],_0x415fee);}});const _0x4365da=_0x56b89e['generate']({'base64':![],'compression':_0x27506c(0x22e)});fs['writeFileSync'](zippath+(_0x1ee559+_0x27506c(0xfa)),_0x4365da,_0x27506c(0xbc));}async function unzipFile(_0x18c5f1,_0x1f12fe){const _0x3b1518=_0x30403f;fs[_0x3b1518(0x10e)](configpath,{'withFileTypes':!![]})[_0x3b1518(0x1f6)](_0x322244=>{const _0x5e2265=_0x3b1518;if(!_0x322244[_0x5e2265(0x14e)]())fs['rmSync'](configpath+_0x322244[_0x5e2265(0x1d9)]);});const _0x3d2410=fs[_0x3b1518(0x163)](_0x18c5f1+_0x1f12fe,'binary'),_0x170b66=new require(_0x3b1518(0x25e))(_0x3d2410,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x170b66['files'])['forEach'](_0x13bb93=>{const _0xc4ff0e=_0x3b1518,_0x2d1f8c=_0x170b66[_0xc4ff0e(0xce)][_0x13bb93];fs[_0xc4ff0e(0xc0)](configpath+_0x2d1f8c[_0xc4ff0e(0x1d9)],_0x2d1f8c[_0xc4ff0e(0x123)]);}),fs[_0x3b1518(0x10e)](temppath,{'withFileTypes':!![]})[_0x3b1518(0x1f6)](_0x1c3434=>{const _0x4dc5de=_0x3b1518;if(!_0x1c3434[_0x4dc5de(0x14e)]())fs[_0x4dc5de(0x13b)](temppath+_0x1c3434[_0x4dc5de(0x1d9)]);}),logger['debug'](_0x3b1518(0xc1)),process[_0x3b1518(0x1bf)]({'restore':!![]},_0x4e5d81=>{});}async function getPublicIp(){const _0xcf91a1=_0x30403f;try{const _0x11c38b=await axios[_0xcf91a1(0x251)](_0xcf91a1(0x87));publicip=_0x11c38b[_0xcf91a1(0x1d8)]['ip'];}catch(_0x1d0cdc){}}async function triggerAnalytics(){const _0x3058ce=_0x30403f;if(!publicip)await getPublicIp();const _0x403f62=getBotsWithMode();let _0x323102=0x0;_0x403f62[_0x3058ce(0x1f6)](_0xc75d6a=>{const _0x4cdc96=_0x3058ce;if(_0xc75d6a['status']===_0x4cdc96(0x179))_0x323102++;});const _0x533312=getBotExchanges();mixpanel[_0x3058ce(0x24b)]('Server',{'distinct_id':settings[_0x3058ce(0x203)],'ip':publicip,'version':serverversion,'numbots':_0x403f62[_0x3058ce(0x20b)],'numbotsenabled':_0x323102,'exchanges':_0x533312});}async function getMessages(){const _0xb05a37=_0x30403f,_0x21e7f0=_0xb05a37(0x168),_0x47567f=new GraphQLClient(_0x21e7f0),_0x2000be={'authorization':_0xb05a37(0xb7)},_0x2701d0=serverversion[_0xb05a37(0x1fc)]('.'),_0x3a0dee=_0x2701d0[0x0]+'.'+_0x2701d0[0x1],_0x21f017=Math['min'](settings[_0xb05a37(0x1cb)],settings[_0xb05a37(0x25d)]),_0x59583d={'last':parseInt(_0x21f017),'bbm':_0x3a0dee},_0x110c8c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xf832ee;try{_0xf832ee=await _0x47567f[_0xb05a37(0x1fd)](_0x110c8c,_0x59583d,_0x2000be);}catch(_0xeb2c44){}if(_0xf832ee&&_0xf832ee[_0xb05a37(0x195)]){let _0x442448=settings['lastmsgtelegram'];newMessages=[];for(const _0x489c3c of _0xf832ee['messages']){newMessages[_0xb05a37(0xed)](_0x489c3c);if(_0x489c3c[_0xb05a37(0x258)])updateSetting(_0xb05a37(0x1ad),_0x489c3c[_0xb05a37(0x258)]);let _0x32cfec=_0x489c3c[_0xb05a37(0x258)]?serverversion>=_0x489c3c['bbvNew']:![];if(!_0x32cfec&&_0x489c3c[_0xb05a37(0x1d5)]>_0x442448){if(_0x489c3c[_0xb05a37(0x23a)]===_0xb05a37(0x147)||serverversion[_0xb05a37(0x12b)](_0x489c3c[_0xb05a37(0x23a)])){let _0x54ab0d=''+_0x489c3c[_0xb05a37(0xa4)]+'\x0a\x0a'+_0x489c3c[_0xb05a37(0x1c3)];const _0x4cd39c=await sendTelegramMsg(toTelegramMarkdown(_0x54ab0d),_0xb05a37(0x165));if(_0x4cd39c)_0x442448=_0x489c3c['number'];}}}updateAvailable=isNewerVersion(settings[_0xb05a37(0x1ad)],serverversion),updateSetting(_0xb05a37(0x1cb),_0x442448),emitMessages();}}function emitMessages(){const _0xf60e9a=_0x30403f,_0x4f8f68=settings[_0xf60e9a(0x25d)];let _0x3bec5b=[];newMessages[_0xf60e9a(0x1f6)](_0x208700=>{_0x208700['number']>_0x4f8f68&&_0x3bec5b['push'](_0x208700);}),_0x3bec5b[_0xf60e9a(0x20b)]>0x0&&getAllClients()[_0xf60e9a(0x1f6)](_0xae82f3=>{const _0x1d8c6f=_0xf60e9a;getSocket(_0xae82f3['id'])[_0x1d8c6f(0x131)](_0x1d8c6f(0x1c3),_0x3bec5b);});}function confirmMessage(_0x3466a1){const _0x44a3a7=_0x30403f;updateSetting(_0x44a3a7(0x25d),Number(_0x3466a1));}function isNewerVersion(_0x1eb800,_0x5416c8){const _0x194c7d=_0x30403f,_0x43b794=_0x5416c8['split']('.'),_0x403069=_0x1eb800['split']('.');for(var _0x110363=0x0;_0x110363<_0x403069[_0x194c7d(0x20b)];_0x110363++){const _0x2b966d=~~_0x403069[_0x110363],_0x41f6c9=~~_0x43b794[_0x110363];if(_0x2b966d>_0x41f6c9)return!![];if(_0x2b966d<_0x41f6c9)return![];}return![];}function toTelegramMarkdown(_0x277452){const _0x4fcd4e=_0x30403f,_0x125348=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3451b6=/\*{2}(.+?)\*{2}/gim;return _0x277452=_0x277452[_0x4fcd4e(0x134)](_0x125348,_0x4fcd4e(0x12d))[_0x4fcd4e(0x134)](_0x3451b6,_0x4fcd4e(0xd9)),_0x277452;}async function validateConfigFile(){const _0x116903=_0x30403f,_0x1782f9=dbConfig[_0x116903(0x251)](_0x116903(0xe4))[_0x116903(0x198)]('botID')[_0x116903(0xb5)]()||[];if(_0x1782f9[_0x116903(0x20b)]==0x0){let _0x170e0c=0x0,_0x4d0cf8=[];const _0x3df222=/^bot-([0-9]{3})-config.json$/,_0x51d188=fs['readdirSync'](configpath);_0x51d188[_0x116903(0x1f6)](_0x278603=>{const _0x3c0d36=_0x116903,_0x22c142=_0x3df222['exec'](_0x278603);if(_0x22c142){const _0x355663=_0x22c142[0x1];let _0x249316=getBotAttributes(_0x355663);_0x4d0cf8['push']({'botID':_0x355663,'botname':_0x249316[_0x3c0d36(0x10b)],'status':'disabled','live':_0x3c0d36(0x188)}),_0x170e0c++;}}),_0x170e0c!=0x0&&(dbConfig[_0x116903(0x251)](_0x116903(0xe4))[_0x116903(0x8b)](_0x4d0cf8)['write'](),config=_0x4d0cf8,restoredConfigFile=_0x170e0c);}}async function restoreConfigNotify(_0x505318){const _0x296581=_0x30403f;let _0xa9f209;if(restoredConfigFile==0x1)_0xa9f209=_0x296581(0xc9);else _0xa9f209=_0x296581(0xa8);if(_0x505318)io['to'](_0x296581(0x220))[_0x296581(0x131)]('notification',_0xa9f209);else{logger[_0x296581(0x11d)](_0x296581(0x120)),logger[_0x296581(0x11d)](_0xa9f209),logger[_0x296581(0x11d)]('-----------------------------------------------------------------------------------'),logger[_0x296581(0x11d)]('');if(tgBot&&settings[_0x296581(0x1da)]&&settings['telegramEvents']!=_0x296581(0x191))tgBot[_0x296581(0x140)](settings[_0x296581(0x1da)],_0x296581(0x16b)+_0xa9f209)['catch'](_0xcfb9c0=>{telegramError(_0xcfb9c0);});}}function validateCredentials(_0x45ad86,_0x510e3f){const _0x30f36f=_0x30403f;if(_0x45ad86[_0x30f36f(0x211)]==settings[_0x30f36f(0x1d1)]&&bcrypt[_0x30f36f(0x244)](_0x45ad86[_0x30f36f(0x15e)],settings[_0x30f36f(0x1d7)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x30f36f(0x152),'token':null};else{const _0x2565d1=generateLoginToken(_0x510e3f);return{'allow':!![],'reason':_0x30f36f(0x25a),'token':_0x2565d1};}}else return{'allow':![],'reason':_0x30f36f(0x143),'token':null};}function refreshToken(_0x5078ee){const _0x237c3a=_0x30403f,_0x530a7b=generateLoginToken(_0x5078ee);return{'allow':!![],'reason':_0x237c3a(0x25a),'token':_0x530a7b};}function validateAccess(_0x26fdf1,_0x201128,_0x1048ea){const _0x4845ef=_0x30403f,_0x3c41b1=_0x1048ea?_0x1048ea:devices[_0x201128]['ip'];let _0x2b0952;const _0x5b69dc=_0x4266d1=>{const _0x5e844d=_0x2f85;if(settings[_0x5e844d(0x1d2)]){if(settings[_0x5e844d(0x93)]){if(telegram2FaApproved(_0x201128)){const _0x56176f=generateLoginToken(_0x201128);return{'allow':!![],'reason':_0x5e844d(0xea),'token':_0x56176f};}else return{'allow':![],'reason':_0x5e844d(0x229),'token':null};}else return _0x2b0952=validToken(_0x4266d1,_0x201128),_0x2b0952[_0x5e844d(0xca)](_0x5e844d(0x245))?{'allow':!![],'reason':_0x5e844d(0xad),'token':_0x4266d1}:{'allow':![],'reason':_0x5e844d(0x229),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x4845ef(0x1d3)]){let _0x3ffbdc=[...settings[_0x4845ef(0xd7)],_0x4845ef(0x10a),'::ffff:127.0.0.1',_0x4845ef(0x160)];if(_0x3ffbdc[_0x4845ef(0xa5)](_0x3c41b1))return _0x5b69dc(_0x26fdf1);else{_0x2b0952=validToken(_0x26fdf1,_0x201128);if(_0x2b0952['hasOwnProperty'](_0x4845ef(0x245)))return _0x5b69dc(_0x26fdf1);else{if(telegramIpApproved(_0x201128)){const _0x184159=generateToken(_0x201128);return _0x2b0952=_0x5b69dc(_0x26fdf1),_0x2b0952[_0x4845ef(0x115)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x184159}:_0x2b0952;}else return settings[_0x4845ef(0x100)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x4845ef(0xcf),'token':null};}}}else return _0x5b69dc(_0x26fdf1);}function timelyDecrypt(_0x105428,_0x111b83=!![]){const _0x446108=_0x30403f;if(_0x105428)try{const _0x154fe4=crypt[_0x446108(0x1f1)](secure[_0x446108(0xbf)],_0x105428)[_0x446108(0x1c3)],_0x2551b9=_0x154fe4[_0x446108(0x1fc)]('@')[0x0],_0x23c55f=_0x154fe4[_0x446108(0x1fc)]('@')[0x1],_0x1b27fd=new Date()[_0x446108(0xa7)]();if(_0x111b83){if(_0x1b27fd-_0x23c55f<maxSecretAge*0x3e8)return _0x2551b9;else return![];}else return _0x2551b9;}catch(_0x24c059){return![];}else return![];}const validToken=(_0x5eb6d7,_0x827dd5)=>{const _0x2afdea=_0x30403f,_0x39cd97=devices[_0x827dd5]['ip'];if(!_0x5eb6d7)return{'error':_0x2afdea(0x167)};for(let _0x38bbe6 of blacklist){if(_0x38bbe6['token']==_0x5eb6d7)return{'error':_0x2afdea(0x1b9)};}let _0x1120bc;try{_0x1120bc=jwt[_0x2afdea(0x180)](_0x5eb6d7,secure[_0x2afdea(0x1c6)]+_0x827dd5);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x1120bc['hasOwnProperty'](_0x2afdea(0xf1))&&!_0x1120bc[_0x2afdea(0xca)](_0x2afdea(0x211))||!_0x1120bc[_0x2afdea(0xca)]('exp'))return{'error':_0x2afdea(0x15d)};if(!_0x1120bc[_0x2afdea(0xca)](_0x2afdea(0x211))&&_0x1120bc[_0x2afdea(0xca)](_0x2afdea(0xf1))){const {clientip:_0x161d36}=_0x1120bc;return _0x39cd97==_0x161d36?{'success':_0x2afdea(0x95)}:{'error':_0x2afdea(0x96)};}else{if(_0x1120bc[_0x2afdea(0xca)](_0x2afdea(0x211))&&_0x1120bc['hasOwnProperty'](_0x2afdea(0xf1))){const {username:_0x84915e,clientip:_0x5ac8f0}=_0x1120bc;return settings[_0x2afdea(0x1d1)]==_0x84915e&&_0x39cd97==_0x5ac8f0?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2afdea(0x228)};}}},generateLoginToken=_0x20aebd=>{const _0x32d8d2=_0x30403f;if(_0x20aebd){const _0x2c82b9=devices[_0x20aebd]['ip'];return jwt[_0x32d8d2(0x157)]({'username':settings[_0x32d8d2(0x1d1)],'clientip':_0x2c82b9},secure[_0x32d8d2(0x1c6)]+_0x20aebd,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1348f3=>{const _0x3ecdeb=_0x30403f;if(_0x1348f3){const _0xc85305=devices[_0x1348f3]['ip'];return jwt[_0x3ecdeb(0x157)]({'clientip':_0xc85305},secure[_0x3ecdeb(0x1c6)]+_0x1348f3,{'expiresIn':devices[_0x1348f3][_0x3ecdeb(0x1b2)][_0x3ecdeb(0x16d)]*0x3c});}else return![];},telegramIpApproved=_0xdf85e3=>{const _0x122343=_0x30403f;let _0x167d63=![];return devices[_0xdf85e3][_0x122343(0x1b2)]&&devices[_0xdf85e3]['telegramIpApproval']['expiry']!=_0x122343(0x10d)&&(_0x167d63=devices[_0xdf85e3][_0x122343(0x1b2)][_0x122343(0xf1)]==devices[_0xdf85e3]['ip']&&new Date()[_0x122343(0xa7)]()-devices[_0xdf85e3][_0x122343(0x1b2)]['timestamp']<devices[_0xdf85e3][_0x122343(0x1b2)]['expiry']*0x3c*0x3e8),_0x167d63;},telegram2FaApproved=_0x4c8089=>{const _0xd134a2=_0x30403f;let _0x23b62f=![];return devices[_0x4c8089][_0xd134a2(0x18a)]&&devices[_0x4c8089][_0xd134a2(0x18a)]['expiry']!=_0xd134a2(0x10d)&&(_0x23b62f=devices[_0x4c8089][_0xd134a2(0x18a)][_0xd134a2(0xf1)]==devices[_0x4c8089]['ip']&&new Date()[_0xd134a2(0xa7)]()-devices[_0x4c8089]['telegram2FaApproval'][_0xd134a2(0x15a)]<devices[_0x4c8089]['telegram2FaApproval'][_0xd134a2(0x16d)]*0x3c*0x3e8),_0x23b62f;},normalizeIP=_0x957717=>{const _0xf41e40=_0x30403f;let _0x371116=null,_0x39b615=null;if(ipaddr[_0xf41e40(0x18d)](_0x957717)){const _0xb6c5f7=ipaddr[_0xf41e40(0xac)](_0x957717);_0xb6c5f7[_0xf41e40(0x24c)]()===_0xf41e40(0xa6)?(_0xb6c5f7[_0xf41e40(0xb4)]()&&(_0x371116=_0xb6c5f7[_0xf41e40(0x1c1)]()[_0xf41e40(0x148)]()),_0x39b615=_0xb6c5f7[_0xf41e40(0x148)]()):(_0x371116=_0xb6c5f7[_0xf41e40(0x148)](),_0x39b615=_0xb6c5f7[_0xf41e40(0xd2)]()['toString']());}return{'show':_0x371116?_0x371116:_0x39b615,'store':_0x39b615};};function formatDate(_0x3e946f){const _0x461001=_0x30403f;return _0x3e946f[_0x461001(0x187)]()+'/'+(_0x3e946f['getMonth']()+0x1)[_0x461001(0x148)]()[_0x461001(0xc7)](0x2,'0')+'/'+_0x3e946f[_0x461001(0xff)]()[_0x461001(0x148)]()[_0x461001(0xc7)](0x2,'0')+'\x20'+_0x3e946f[_0x461001(0x135)]()['toString']()['padStart'](0x2,'0')+':'+_0x3e946f[_0x461001(0x113)]()[_0x461001(0x148)]()[_0x461001(0xc7)](0x2,'0')+':'+_0x3e946f[_0x461001(0x98)]()['toString']()[_0x461001(0xc7)](0x2,'0');}function sleep(_0x34a9ae){return new Promise(_0x4b2cfc=>setTimeout(_0x4b2cfc,_0x34a9ae));}