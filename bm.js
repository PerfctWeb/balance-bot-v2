const _0x2f8265=_0x70e7;(function(_0x46e013,_0x3b4a7d){const _0xb4a1b1=_0x70e7,_0x228c32=_0x46e013();while(!![]){try{const _0x20f030=parseInt(_0xb4a1b1(0x277))/0x1*(-parseInt(_0xb4a1b1(0x287))/0x2)+parseInt(_0xb4a1b1(0x32c))/0x3+-parseInt(_0xb4a1b1(0x1ca))/0x4*(-parseInt(_0xb4a1b1(0x203))/0x5)+-parseInt(_0xb4a1b1(0x2d4))/0x6*(parseInt(_0xb4a1b1(0x308))/0x7)+parseInt(_0xb4a1b1(0x183))/0x8*(parseInt(_0xb4a1b1(0x206))/0x9)+parseInt(_0xb4a1b1(0x2a9))/0xa*(-parseInt(_0xb4a1b1(0x1d6))/0xb)+parseInt(_0xb4a1b1(0x1db))/0xc*(parseInt(_0xb4a1b1(0x341))/0xd);if(_0x20f030===_0x3b4a7d)break;else _0x228c32['push'](_0x228c32['shift']());}catch(_0x29eb64){_0x228c32['push'](_0x228c32['shift']());}}}(_0x4582,0x1bbc4));const _0x22cd73=function(){let _0x3d3226=!![];return function(_0x2c80c4,_0x4f1d14){const _0x4d191d=_0x3d3226?function(){const _0x40c9ab=_0x70e7;if(_0x4f1d14){const _0x5c1532=_0x4f1d14[_0x40c9ab(0x1cc)](_0x2c80c4,arguments);return _0x4f1d14=null,_0x5c1532;}}:function(){};return _0x3d3226=![],_0x4d191d;};}(),_0x32f9e1=_0x22cd73(this,function(){const _0x1eb3d2=_0x70e7;return _0x32f9e1[_0x1eb3d2(0x1fc)]()['search']('(((.+)+)+)+$')[_0x1eb3d2(0x1fc)]()[_0x1eb3d2(0x2fc)](_0x32f9e1)[_0x1eb3d2(0x254)](_0x1eb3d2(0x25f));});_0x32f9e1();'use strict';process[_0x2f8265(0x312)][_0x2f8265(0x22c)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x2f8265(0x22b)),low=require(_0x2f8265(0x319)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x2f8265(0x30c)),crypto=require(_0x2f8265(0x15f)),Crypt=require(_0x2f8265(0x34f))[_0x2f8265(0x1ed)],RSA=require('hybrid-crypto-js')[_0x2f8265(0x196)],bcrypt=require(_0x2f8265(0x149)),jwt=require(_0x2f8265(0x1c0)),ipaddr=require(_0x2f8265(0x327)),argv=require('yargs/yargs')(process[_0x2f8265(0x2fb)][_0x2f8265(0x1cf)](0x2))[_0x2f8265(0x2fb)],uuidRandom=require(_0x2f8265(0x163)),{Telegraf,Markup}=require(_0x2f8265(0x1fd)),Mixpanel=require(_0x2f8265(0x31e)),axios=require(_0x2f8265(0x2b6)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x2f8265(0x32d)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x2f8265(0x314),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x2f8265(0x1d9)](_0x2f8265(0x315)+PORT+_0x2f8265(0x34b)),process[_0x2f8265(0x2c1)](0x1));const HOST=argv[_0x2f8265(0x2ab)]||null,userID=argv[_0x2f8265(0x2fd)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x2f8265(0x30b)];let bbpath='bb/',bbpath2='';const botfile=_0x2f8265(0x2d0),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+'version.json')[_0x2f8265(0x154)]||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2f8265(0x1a8)),configpath=userID?bbpath+_0x2f8265(0x2a2)+userID+'/':bbpath+_0x2f8265(0x2a2),configbackuppath=configpath+_0x2f8265(0x2ce),logspath=userID?bbpath+_0x2f8265(0x15d)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x2f8265(0x28f)+userID+'/':bbpath+_0x2f8265(0x28f),loggerfile=fs[_0x2f8265(0x2f8)](logspath+_0x2f8265(0x1df),{'flags':'a'}),temppath=userID?bbpath+_0x2f8265(0x20d)+userID+'/':bbpath+_0x2f8265(0x20d);!fs[_0x2f8265(0x170)](configpath)&&fs[_0x2f8265(0x298)](configpath);!fs[_0x2f8265(0x170)](configbackuppath)&&fs[_0x2f8265(0x298)](configbackuppath);!fs[_0x2f8265(0x170)](logspath)&&fs[_0x2f8265(0x298)](logspath);!fs['existsSync'](zippath)&&fs[_0x2f8265(0x298)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2f8265(0x25d)]({'bots':[]})[_0x2f8265(0x345)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2f8265(0x317),'onepagemode':![]}})[_0x2f8265(0x345)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2f8265(0x25d)]({'secure':{},'blacklist':[]})[_0x2f8265(0x345)]();let crypt=new Crypt({'md':_0x2f8265(0x253),'rsaStandard':_0x2f8265(0x347)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2f8265(0x2a8)](_0x2f8265(0x187),{'host':_0x2f8265(0x2f5)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2f8265(0x2ec)]&&(settings[_0x2f8265(0x2ec)]!=''&&settings[_0x2f8265(0x2ec)]!=_0x2f8265(0x1e0))&&settings[_0x2f8265(0x14c)]&&settings[_0x2f8265(0x14c)]!='')initTelegram();const parseColor=(_0x196f41,_0x1b1626)=>{const _0x1b5ec7=_0x2f8265,_0x1aee36=/#[A-Z]{3}#/g;if(typeof _0x196f41==_0x1b5ec7(0x282)){!_0x1b1626?_0x196f41=_0x196f41[_0x1b5ec7(0x32e)](_0x1aee36,''):(_0x196f41=_0x196f41[_0x1b5ec7(0x32e)](/#BLU#/g,'\x1b[34m'),_0x196f41=_0x196f41[_0x1b5ec7(0x32e)](/#RED#/g,'\x1b[31m'),_0x196f41=_0x196f41['replace'](/#YEL#/g,_0x1b5ec7(0x209)),_0x196f41=_0x196f41['replace'](/#MAG#/g,_0x1b5ec7(0x280)),_0x196f41=_0x196f41[_0x1b5ec7(0x32e)](/#CYA#/g,'\x1b[36m'),_0x196f41=_0x196f41[_0x1b5ec7(0x32e)](/#RES#/g,_0x1b5ec7(0x31a)));;}return _0x196f41;},logger={'screen':_0x5a775c=>{const _0x15de3a=_0x2f8265;console[_0x15de3a(0x1d9)](parseColor(_0x5a775c,!![]));},'simple':_0x5dfc38=>{const _0x50b77b=_0x2f8265;console[_0x50b77b(0x1d9)](parseColor(_0x5dfc38,!![])),loggerfile[_0x50b77b(0x345)](util['format'](parseColor(_0x5dfc38,![]))+'\x0a');},'full':async _0x4d9ec9=>{const _0x31bd55=_0x2f8265,_0x10dd4b=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4d9ec9;console[_0x31bd55(0x1d9)](parseColor(_0x10dd4b,!![])),loggerfile[_0x31bd55(0x345)](util[_0x31bd55(0x175)](parseColor(_0x10dd4b,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x31bd55(0x34e)]!=_0x31bd55(0x21e))await sendTelegram(settings[_0x31bd55(0x19e)],_0x31bd55(0x25a)+parseColor(_0x4d9ec9,![]));},'debug':async(_0x485528,_0x2d6e36='')=>{const _0x82663e=_0x2f8265,_0x14ea74=getTimeStamp()+_0x82663e(0x1de)+_0x485528;if(debugging)console[_0x82663e(0x1d9)](parseColor(_0x14ea74,!![]));loggerfile[_0x82663e(0x345)](util['format'](parseColor(_0x14ea74,![]))+'\x0a');if(_0x2d6e36){if(debugging)console[_0x82663e(0x1d9)](_0x2d6e36);loggerfile[_0x82663e(0x345)](util['format'](_0x2d6e36)+'\x0a');}}};process['on'](_0x2f8265(0x31f),function(_0x382cbe){logger['simple'](_0x382cbe);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2f8265(0x2ba))[_0x2f8265(0x267)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2f8265(0x1aa)),app=express(),http=require(_0x2f8265(0x17e))[_0x2f8265(0x184)](app);app[_0x2f8265(0x1a9)](fileUpload({'useTempFiles':!![]})),app[_0x2f8265(0x1f9)]('/download/:type',async(_0x43291f,_0x10b53f)=>{const _0x5d33ee=_0x2f8265,_0x3edf58=_0x43291f[_0x5d33ee(0x14f)][_0x5d33ee(0x1cd)],_0x1b6a16=getClientsWithBotID(_0x5d33ee(0x233)),_0x4aa27d=_0x43291f['headers'][_0x5d33ee(0x326)],_0x2ccff8=timelyDecrypt(_0x4aa27d,![]),_0x10e560=_0x1b6a16[_0x5d33ee(0x294)](_0x493d29=>_0x493d29[_0x5d33ee(0x326)]==_0x2ccff8);if(_0x10e560){const _0x4f4f7b=normalizeIP(_0x43291f[_0x5d33ee(0x339)]['remoteAddress'])[_0x5d33ee(0x23b)],_0x2e2cc7=_0x43291f[_0x5d33ee(0x330)]['tkn'];if(validateAccess(_0x2e2cc7,_0x2ccff8,_0x4f4f7b)[_0x5d33ee(0x307)])_0x3edf58==_0x5d33ee(0x30d)&&await backupConfigFiles(),await zipFiles(_0x3edf58),_0x10b53f[_0x5d33ee(0x2a7)](zippath+(_0x3edf58+_0x5d33ee(0x329)),_0x49d410=>{const _0x41a881=_0x5d33ee;_0x49d410&&(logger['full'](_0x41a881(0x1a7)+_0x3edf58),logger[_0x41a881(0x1c6)](_0x49d410));});else logger['full'](_0x5d33ee(0x1d8)+_0x3edf58+_0x5d33ee(0x16a));}else logger[_0x5d33ee(0x34c)](_0x5d33ee(0x1d8)+_0x3edf58+_0x5d33ee(0x1b8));}),app[_0x2f8265(0x261)](_0x2f8265(0x33b),async(_0x462988,_0x45658e)=>{const _0xb31fd8=_0x2f8265,_0x198485=getClientsWithBotID(_0xb31fd8(0x233)),_0x5e9d63=_0x462988[_0xb31fd8(0x330)][_0xb31fd8(0x326)],_0x30e9f9=timelyDecrypt(_0x5e9d63,![]),_0x47d43e=_0x198485[_0xb31fd8(0x294)](_0x30dd06=>_0x30dd06[_0xb31fd8(0x326)]==_0x30e9f9);logger[_0xb31fd8(0x29e)](_0xb31fd8(0x243));if(_0x47d43e){const _0x54f300=normalizeIP(_0x462988[_0xb31fd8(0x339)][_0xb31fd8(0x2ee)])[_0xb31fd8(0x23b)],_0x38f941=_0x462988[_0xb31fd8(0x330)][_0xb31fd8(0x166)];if(validateAccess(_0x38f941,_0x30e9f9,_0x54f300)[_0xb31fd8(0x307)]){if(_0x462988[_0xb31fd8(0x146)]){const _0x29bd97=_0x462988[_0xb31fd8(0x146)]['backupfile'];await _0x29bd97['mv'](temppath+_0x29bd97[_0xb31fd8(0x358)]),_0x45658e[_0xb31fd8(0x2e1)]({'status':!![],'message':'File\x20uploaded'});const _0x4f28ab=getBotsWithMode();_0x4f28ab[_0xb31fd8(0x335)]>0x0?confirmRestore(temppath,_0x29bd97[_0xb31fd8(0x358)]):unzipFile(temppath,_0x29bd97[_0xb31fd8(0x358)]);}}else logger['full'](_0xb31fd8(0x191));}else logger[_0xb31fd8(0x34c)](_0xb31fd8(0x338));}),app[_0x2f8265(0x1a9)](express[_0x2f8265(0x303)](path[_0x2f8265(0x2b1)](__dirname,bbpath2,_0x2f8265(0x24c)))),app['use'](express[_0x2f8265(0x303)](path[_0x2f8265(0x2b1)](__dirname,bbpath2,'build'))),app[_0x2f8265(0x1f9)]('/',function(_0x94e488,_0x51d098){const _0x5b90cb=_0x2f8265;_0x51d098[_0x5b90cb(0x2d1)](path['join'](__dirname,bbpath2,_0x5b90cb(0x24c),_0x5b90cb(0x1d5)));}),app['get']('/:bot',function(_0x69e4b,_0x13d4a4){const _0x17a7bd=_0x2f8265;_0x13d4a4[_0x17a7bd(0x2d1)](path[_0x17a7bd(0x2b1)](__dirname,bbpath2,'build',_0x17a7bd(0x1d5)));}),app['get'](_0x2f8265(0x1ce),(_0x2238b1,_0xaecedb)=>{const _0x25399c=_0x2f8265;_0xaecedb[_0x25399c(0x2d1)](path[_0x25399c(0x2b1)](__dirname,bbpath2,_0x25399c(0x22e),'index.html'));}),app[_0x2f8265(0x1f9)](_0x2f8265(0x306),(_0x21771b,_0x24cf7d)=>{const _0x3f694c=_0x2f8265;_0x24cf7d[_0x3f694c(0x2d1)](path[_0x3f694c(0x2b1)](__dirname,bbpath2,_0x3f694c(0x22e),_0x3f694c(0x1d5)));}),app['get'](_0x2f8265(0x18d),(_0x1b2a98,_0x48e628)=>{const _0x37fb9b=_0x2f8265;_0x48e628[_0x37fb9b(0x2d1)](path['join'](__dirname,bbpath2,_0x37fb9b(0x22e),_0x37fb9b(0x1d5)));}),app[_0x2f8265(0x1f9)](_0x2f8265(0x2c7),(_0x5645b0,_0x3dda9f)=>{const _0x137c11=_0x2f8265;_0x3dda9f[_0x137c11(0x2d1)](path['join'](__dirname,bbpath2,_0x137c11(0x22e),_0x137c11(0x1d5)));}),app[_0x2f8265(0x1f9)](_0x2f8265(0x1f3),(_0x50129f,_0x361476)=>{const _0x46b2dc=_0x2f8265;_0x361476[_0x46b2dc(0x2d1)](path[_0x46b2dc(0x2b1)](__dirname,bbpath2,_0x46b2dc(0x22e),_0x46b2dc(0x1d5)));}),app[_0x2f8265(0x1f9)](_0x2f8265(0x226),(_0x5acd60,_0x4944f1)=>{const _0x38533=_0x2f8265;_0x4944f1[_0x38533(0x2d1)](path[_0x38533(0x2b1)](__dirname,bbpath2,_0x38533(0x22e),_0x38533(0x1d5)));});if(HOST)http[_0x2f8265(0x256)](PORT,HOST);else http[_0x2f8265(0x256)](PORT);const io=require(_0x2f8265(0x18c))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1e8eb1=_0x2f8265;let _0xc35296=_0x1e8eb1(0x21d);const _0x5b254f=networkInterfaces(),_0x632919={};for(const _0x472287 of Object[_0x1e8eb1(0x152)](_0x5b254f)){for(const _0x351726 of _0x5b254f[_0x472287]){if((_0x351726['family']==_0x1e8eb1(0x324)||_0x351726[_0x1e8eb1(0x27d)]==0x4)&&!_0x351726[_0x1e8eb1(0x185)]){const _0x5294bc=ipaddr['parse'](_0x351726['address'])[_0x1e8eb1(0x2fa)]();_0x5294bc!=_0x1e8eb1(0x2d7)&&(!_0x632919[_0x472287]&&(_0x632919[_0x472287]=[]),_0x632919[_0x472287][_0x1e8eb1(0x1f5)](_0x351726['address']),_0xc35296=_0x351726[_0x1e8eb1(0x177)]);}}}return{'serverip':_0xc35296,'netinterfaces':_0x632919};}async function startServer(){const _0x2cf1f8=_0x2f8265,{serverip:_0x1c7ad6,netinterfaces:_0x1f5876}=getServerIP();logger[_0x2cf1f8(0x1c6)](''),logger[_0x2cf1f8(0x1c6)](_0x2cf1f8(0x2a1)),await logger[_0x2cf1f8(0x34c)](_0x2cf1f8(0x17c)+serverversion+_0x2cf1f8(0x353)+(environment==_0x2cf1f8(0x333)?_0x2cf1f8(0x2d8):'')+'\x0a'+(_0x2cf1f8(0x1a3)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2cf1f8(0x27c)+_0x1c7ad6+':'+PORT+_0x2cf1f8(0x2a5))),logger[_0x2cf1f8(0x1c6)](_0x2cf1f8(0x2a1));if(config[_0x2cf1f8(0x335)]!=0x0)for(const _0x3837a5 of config){const _0x377a71=_0x3837a5[_0x2cf1f8(0x217)]==_0x2cf1f8(0x28a)?'a':'m';if(_0x3837a5['status']=='enabled'||_0x3837a5[_0x2cf1f8(0x2d9)]=='new')await logger['full'](_0x2cf1f8(0x336)+_0x377a71+_0x2cf1f8(0x216)+_0x3837a5[_0x2cf1f8(0x151)]+_0x2cf1f8(0x161)+_0x3837a5[_0x2cf1f8(0x318)]),startBot([_0x3837a5[_0x2cf1f8(0x151)],userID],{'cwd':bbpath},function(_0x1b3c96){const _0xbd6a9e=_0x2cf1f8;if(_0x1b3c96)logger[_0xbd6a9e(0x34c)](_0x1b3c96);});else(_0x3837a5['status']==_0x2cf1f8(0x20c)||_0x3837a5['status']==_0x2cf1f8(0x2fe))&&await logger[_0x2cf1f8(0x34c)](_0x2cf1f8(0x200)+_0x377a71+_0x2cf1f8(0x2dc)+_0x3837a5[_0x2cf1f8(0x151)]+'\x20|\x20'+_0x3837a5[_0x2cf1f8(0x318)]);}else!newBot&&logger[_0x2cf1f8(0x1c6)](_0x2cf1f8(0x179));if(newBot)addBot();logger[_0x2cf1f8(0x1c6)]('-----------------------------------------------------------------------------------'),logger[_0x2cf1f8(0x1c6)](''),await logger['debug'](_0x2cf1f8(0x320)+nodeversion),await logger[_0x2cf1f8(0x29e)](_0x2cf1f8(0x27e),_0x1f5876);}function startSocket(){const _0x5c77f0=_0x2f8265;io['on'](_0x5c77f0(0x29c),_0x1544cf=>{const _0x4b7c53=_0x5c77f0;let _0x3f398c,_0x300955,_0x18ca2f,_0x1bbef6,_0x3ccc28;const _0x87c4e3=_0x1544cf[_0x4b7c53(0x1b4)][_0x4b7c53(0x330)]['referer'];_0x300955=_0x87c4e3['match'](/bot[0-9]{3}/);if(_0x300955)_0x18ca2f=_0x300955[0x0][_0x4b7c53(0x1e7)](/[0-9]{3}/);if(_0x18ca2f)_0x3f398c=_0x18ca2f[0x0];else _0x3f398c=_0x4b7c53(0x233);const _0x599c01=_0x1544cf['handshake'][_0x4b7c53(0x269)][_0x4b7c53(0x328)];if(!_0x599c01)_0x1544cf[_0x4b7c53(0x2b0)](_0x4b7c53(0x2d9),{'publicKey':secure[_0x4b7c53(0x20e)]});else{_0x1bbef6=timelyDecrypt(_0x599c01,![]);if(!_0x1bbef6)_0x1544cf['emit'](_0x4b7c53(0x2d9),{'publicKey':secure[_0x4b7c53(0x20e)]});else{_0x3ccc28=normalizeIP(_0x1544cf[_0x4b7c53(0x2af)]['remoteAddress'])[_0x4b7c53(0x23b)];if(!devices[_0x1bbef6])devices[_0x1bbef6]={'uuid':_0x1bbef6,'access':{'token':null}};devices[_0x1bbef6]['ip']=_0x3ccc28;const _0x23c149=addClient(_0x1544cf['id'],_0x1bbef6,_0x3f398c);setAccess(_0x23c149),emitMessages(),_0x1544cf['on'](_0x4b7c53(0x2c5),_0x24bd16=>{const _0x158d5b=_0x4b7c53,_0x2b8ca7=timelyDecrypt(_0x24bd16[_0x158d5b(0x257)]);if(_0x2b8ca7){_0x24bd16={'username':_0x24bd16[_0x158d5b(0x240)],'password':_0x2b8ca7},devices[_0x1bbef6]['access']=validateCredentials(_0x24bd16,_0x1bbef6);if(devices[_0x1bbef6][_0x158d5b(0x2e5)][_0x158d5b(0x307)]==![]&&devices[_0x1bbef6]['access'][_0x158d5b(0x2aa)]==_0x158d5b(0x16d))_0x1544cf[_0x158d5b(0x2b0)](_0x158d5b(0x2d9),{'access':devices[_0x1bbef6]['access']}),loginAccess2FA(_0x1bbef6,_0x3ccc28);else{if(devices[_0x1bbef6][_0x158d5b(0x2e5)][_0x158d5b(0x307)]==![]&&devices[_0x1bbef6]['access'][_0x158d5b(0x2aa)]==_0x158d5b(0x17a))_0x1544cf['emit']('status',{'access':devices[_0x1bbef6][_0x158d5b(0x2e5)]});else devices[_0x1bbef6][_0x158d5b(0x2e5)]['allow']&&devices[_0x1bbef6][_0x158d5b(0x2e5)][_0x158d5b(0x2aa)]==_0x158d5b(0x29b)&&(getClientsWithUuid(_0x1bbef6)[_0x158d5b(0x214)](_0x348358=>{setAccess(_0x348358);}),logger[_0x158d5b(0x29e)]('Logged\x20in\x20user\x20...'+_0x1bbef6[_0x158d5b(0x1cf)](-0x8)),setTokenRefresh(_0x1bbef6),setSessionTimeout(_0x158d5b(0x2c5),_0x1bbef6));}}else logger['full'](_0x158d5b(0x1f0));}),_0x1544cf['on']('reset-password',()=>{resetPassword();}),_0x1544cf['on'](_0x4b7c53(0x19d),_0x31d1c1=>{removeClient(_0x1544cf['id']);}),_0x3f398c==_0x4b7c53(0x233)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4def83){const _0x5d98e5=_0x2f8265;if(_0x4def83!=_0x5d98e5(0x233)&&config['apiKey']!=''){if(pid[_0x4def83])pid[_0x4def83][_0x5d98e5(0x2e1)]({'function':_0x5d98e5(0x28d),'args':null});}_0x4def83!=_0x5d98e5(0x233)&&broadcastToBots('bots',JSON[_0x5d98e5(0x172)](config));}function reloadBotManager(){const _0x18b02f=_0x2f8265;getClientsWithBotID(_0x18b02f(0x233))[_0x18b02f(0x214)](_0x24a817=>{const _0x137538=_0x18b02f;getSocket(_0x24a817['id'])['emit'](_0x137538(0x2d9),{'access':{'allow':![],'reason':_0x137538(0x270),'token':null}});});}function getSocket(_0x39a8ce){const _0x32a636=_0x2f8265;return io[_0x32a636(0x1c5)][_0x32a636(0x1c5)][_0x32a636(0x1f9)](_0x39a8ce);}function setAccess(_0x545857){const _0x3fa33b=_0x2f8265,_0x32833f=getSocket(_0x545857['id']),_0x3c5c44=_0x545857[_0x3fa33b(0x326)],_0x13dcd4=_0x545857[_0x3fa33b(0x2cc)];devices[_0x3c5c44]['access']=validateAccess(devices[_0x3c5c44][_0x3fa33b(0x2e5)]['token'],_0x3c5c44),logger[_0x3fa33b(0x29e)](_0x3fa33b(0x26b)+devices[_0x3c5c44][_0x3fa33b(0x2e5)][_0x3fa33b(0x2aa)]+_0x3fa33b(0x1f8)+_0x545857['id'][_0x3fa33b(0x1cf)](-0x8)+_0x3fa33b(0x1c4)+_0x3c5c44[_0x3fa33b(0x1cf)](-0x8)),_0x32833f[_0x3fa33b(0x2b1)](_0x3c5c44);if(devices[_0x3c5c44][_0x3fa33b(0x2e5)]['allow']){_0x32833f[_0x3fa33b(0x2b1)](_0x13dcd4);if(_0x13dcd4==_0x3fa33b(0x233))initializeSocketBotManager(_0x32833f);else initializeSocketBot(_0x32833f);initClient(_0x13dcd4);}devices[_0x3c5c44][_0x3fa33b(0x2e5)][_0x3fa33b(0x242)]&&devices[_0x3c5c44]['access']['reason']==_0x3fa33b(0x2f1)&&setSessionTimeout('2FA',_0x3c5c44),devices[_0x3c5c44][_0x3fa33b(0x2e5)][_0x3fa33b(0x242)]&&devices[_0x3c5c44][_0x3fa33b(0x2e5)][_0x3fa33b(0x2aa)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x3c5c44),_0x32833f[_0x3fa33b(0x2b0)]('status',{'status':_0x545857[_0x3fa33b(0x1d2)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3c5c44][_0x3fa33b(0x2e5)],'externalip':devices[_0x3c5c44]['ip'],'publicKey':secure[_0x3fa33b(0x20e)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x3c5c44][_0x3fa33b(0x2e5)][_0x3fa33b(0x307)]==![]&&devices[_0x3c5c44][_0x3fa33b(0x2e5)][_0x3fa33b(0x2aa)]==_0x3fa33b(0x156)&&temporaryAccess2FA(_0x3c5c44,devices[_0x3c5c44]['ip']);}function setSessionTimeout(_0x2fd54c,_0x2053f5){const _0x50a684=_0x2f8265;let _0x12e6d3;if(_0x2fd54c==_0x50a684(0x2c5))_0x12e6d3=loginExpiry*0x3c*0x3e8;else _0x12e6d3=devices[_0x2053f5][_0x50a684(0x249)][_0x50a684(0x1c3)]*0x3c*0x3e8-(new Date()[_0x50a684(0x1e2)]()-devices[_0x2053f5][_0x50a684(0x249)][_0x50a684(0x173)]);if(devices[_0x2053f5][_0x50a684(0x212)])clearTimeout(devices[_0x2053f5][_0x50a684(0x212)]);devices[_0x2053f5][_0x50a684(0x212)]=setTimeout(()=>{const _0x2a969a=_0x50a684;if(devices[_0x2053f5][_0x2a969a(0x1f6)])clearTimeout(devices[_0x2053f5]['pidRefreshToken']);removeSocketListeners(_0x2053f5),addBlacklist(_0x2053f5),devices[_0x2053f5]['telegramIpApproval']=null,devices[_0x2053f5]['telegram2FaApproval']=null,devices[_0x2053f5][_0x2a969a(0x2e5)][_0x2a969a(0x242)]=null,logger[_0x2a969a(0x29e)](_0x2a969a(0x162)+_0x2053f5[_0x2a969a(0x1cf)](-0x8)),devices[_0x2053f5]['access']=validateAccess(devices[_0x2053f5][_0x2a969a(0x2e5)][_0x2a969a(0x242)],_0x2053f5),!(devices[_0x2053f5]['access'][_0x2a969a(0x307)]&&devices[_0x2053f5][_0x2a969a(0x2e5)][_0x2a969a(0x2aa)]=='login\x20not\x20required')&&(_0x2fd54c=='login'?io['to'](_0x2053f5)[_0x2a969a(0x2b0)](_0x2a969a(0x2d9),{'access':{'allow':![],'reason':_0x2a969a(0x16e),'token':null}}):io['to'](_0x2053f5)[_0x2a969a(0x2b0)](_0x2a969a(0x2d9),{'access':{'allow':![],'reason':_0x2a969a(0x194),'token':null}})),devices[_0x2053f5][_0x2a969a(0x2e5)][_0x2a969a(0x242)]=null;},_0x12e6d3);}function setTokenRefresh(_0x446ad3){const _0x397e1e=_0x2f8265;if(devices[_0x446ad3][_0x397e1e(0x1f6)])clearTimeout(devices[_0x446ad3][_0x397e1e(0x1f6)]);devices[_0x446ad3][_0x397e1e(0x1f6)]=setTimeout(()=>{const _0x2d2fe6=_0x397e1e;getClientsWithUuid(_0x446ad3)[_0x2d2fe6(0x335)]!=0x0?(devices[_0x446ad3]['access']=refreshToken(_0x446ad3),io['to'](_0x446ad3)[_0x2d2fe6(0x2b0)]('status',{'status':_0x2d2fe6(0x147),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x446ad3][_0x2d2fe6(0x2e5)],'externalip':devices[_0x446ad3]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x446ad3)):clearTimeout(devices[_0x446ad3][_0x2d2fe6(0x1f6)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x434a74){const _0x27bb35=_0x2f8265,_0x5cced6=getClient(_0x434a74['id'])[_0x27bb35(0x326)];_0x434a74[_0x27bb35(0x2b0)](_0x27bb35(0x168),config),_0x434a74[_0x27bb35(0x2b0)](_0x27bb35(0x264),cleanSettings()),_0x434a74['on'](_0x27bb35(0x262),_0x318fc4=>{const _0x352748=_0x27bb35;if(validateAccess(_0x318fc4,_0x5cced6)[_0x352748(0x307)])addBot();else logger[_0x352748(0x34c)](_0x352748(0x145));}),_0x434a74['on'](_0x27bb35(0x33a),(_0x192b28,_0x220fe9)=>{const _0x17e316=_0x27bb35;if(validateAccess(_0x220fe9,_0x5cced6)[_0x17e316(0x307)])toggleBot(_0x192b28[_0x17e316(0x151)],_0x192b28[_0x17e316(0x2d9)],_0x192b28[_0x17e316(0x349)]);else logger['full'](_0x17e316(0x157));}),_0x434a74['on'](_0x27bb35(0x148),(_0x437e6f,_0x2d8dd3)=>{const _0x253f7a=_0x27bb35;if(validateAccess(_0x2d8dd3,_0x5cced6)[_0x253f7a(0x307)])toggleBotMode(_0x437e6f);else logger[_0x253f7a(0x34c)](_0x253f7a(0x157));}),_0x434a74['on']('delete-bot',(_0x58651f,_0x44c86c)=>{const _0x507999=_0x27bb35;if(validateAccess(_0x44c86c,_0x5cced6)[_0x507999(0x307)])deleteBot(_0x58651f);else logger[_0x507999(0x34c)](_0x507999(0x248));}),_0x434a74['on'](_0x27bb35(0x189),(_0x54146e,_0x36a7f0)=>{const _0x271337=_0x27bb35;if(validateAccess(_0x36a7f0,_0x5cced6)[_0x271337(0x307)])storeSettings(_0x54146e,!![]);else logger['full'](_0x271337(0x2db));}),_0x434a74['on'](_0x27bb35(0x205),_0x43ad64=>{const _0x202e5b=_0x27bb35;if(validateAccess(_0x43ad64,_0x5cced6)[_0x202e5b(0x307)])updateBB('update');else logger[_0x202e5b(0x34c)](_0x202e5b(0x281));}),_0x434a74['on'](_0x27bb35(0x2e4),_0x52aa1b=>{const _0x170a56=_0x27bb35;if(validateAccess(_0x52aa1b,_0x5cced6)[_0x170a56(0x307)])updateBB(_0x170a56(0x1a4));else logger[_0x170a56(0x34c)](_0x170a56(0x251));}),_0x434a74['on']('get-backup-files',_0x1bfb82=>{const _0x33f42e=_0x27bb35;if(validateAccess(_0x1bfb82,_0x5cced6)[_0x33f42e(0x307)]){const _0x59981d=getClient(_0x434a74['id']);if(_0x59981d)getBackupFiles(_0x59981d['uuid']);else logger[_0x33f42e(0x34c)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x434a74['on'](_0x27bb35(0x24a),(_0x5c3411,_0x22e4ac)=>{const _0x30efd0=_0x27bb35;if(validateAccess(_0x22e4ac,_0x5cced6)[_0x30efd0(0x307)])restoreBackupFile(_0x5c3411);else logger[_0x30efd0(0x34c)](_0x30efd0(0x21f));}),_0x434a74['on'](_0x27bb35(0x23a),_0x318764=>{const _0x3f0031=_0x27bb35;if(validateAccess(_0x318764,_0x5cced6)[_0x3f0031(0x307)])getMessages();else logger[_0x3f0031(0x34c)](_0x3f0031(0x197));}),_0x434a74['on'](_0x27bb35(0x2f4),(_0x37bdc2,_0x4d7f34)=>{const _0x289179=_0x27bb35;if(validateAccess(_0x4d7f34,_0x5cced6)[_0x289179(0x307)])confirmMessage(_0x37bdc2);else logger[_0x289179(0x34c)](_0x289179(0x342));}),_0x434a74['on']('logout',_0x5a4f6d=>{const _0x15f8cd=_0x27bb35;if(validateAccess(_0x5a4f6d,_0x5cced6)['allow']){if(devices[_0x5cced6]['pidRefreshToken'])clearTimeout(devices[_0x5cced6]['pidRefreshToken']);if(devices[_0x5cced6][_0x15f8cd(0x212)])clearTimeout(devices[_0x5cced6]['pidExpireLogin']);removeSocketListeners(getClient(_0x434a74['id'])[_0x15f8cd(0x326)]),addBlacklist(_0x5cced6),devices[_0x5cced6][_0x15f8cd(0x249)]=null,devices[_0x5cced6][_0x15f8cd(0x1dc)]=null,devices[_0x5cced6][_0x15f8cd(0x2e5)][_0x15f8cd(0x242)]=null,logger['debug'](_0x15f8cd(0x1dd)+_0x5cced6[_0x15f8cd(0x1cf)](-0x8)),io['to'](getClient(_0x434a74['id'])[_0x15f8cd(0x326)])[_0x15f8cd(0x2b0)](_0x15f8cd(0x2d9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x15f8cd(0x34c)](_0x15f8cd(0x25c));});}function initializeSocketBot(_0x18c5e6){const _0x1ef2a0=_0x2f8265,_0x322bd1=getClient(_0x18c5e6['id'])['bot'],_0x2b9bb2=getClient(_0x18c5e6['id'])['uuid'];_0x18c5e6['on']('get-logs',(_0x3ec25f,_0x4e1eb1)=>{const _0x56faf1=_0x70e7;if(validateAccess(_0x4e1eb1,_0x2b9bb2)['allow']){if(pid[_0x322bd1])pid[_0x322bd1][_0x56faf1(0x2e1)]({'function':_0x56faf1(0x245),'args':_0x3ec25f});}else logger[_0x56faf1(0x34c)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x18c5e6['on'](_0x1ef2a0(0x1a0),(_0x5e6612,_0xa4d54f)=>{const _0x5b5a0c=_0x1ef2a0;if(validateAccess(_0xa4d54f,_0x2b9bb2)['allow']){if(pid[_0x322bd1])pid[_0x322bd1][_0x5b5a0c(0x2e1)]({'function':'deleteHistoryAlerts','args':_0x5e6612});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x18c5e6['on'](_0x1ef2a0(0x1d7),(_0x21effb,_0x32b256)=>{const _0x41e3e0=_0x1ef2a0;if(validateAccess(_0x32b256,_0x2b9bb2)[_0x41e3e0(0x307)]){if(pid[_0x322bd1])pid[_0x322bd1]['send']({'function':_0x41e3e0(0x2cb),'args':_0x21effb});}else logger[_0x41e3e0(0x34c)](_0x41e3e0(0x1ae));}),_0x18c5e6['on'](_0x1ef2a0(0x2de),(_0x2749ba,_0x58e411)=>{const _0x295f28=_0x1ef2a0;if(validateAccess(_0x58e411,_0x2b9bb2)[_0x295f28(0x307)]){if(pid[_0x322bd1])pid[_0x322bd1][_0x295f28(0x2e1)]({'function':_0x295f28(0x33c),'args':_0x2749ba});}else logger[_0x295f28(0x34c)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x18c5e6['on'](_0x1ef2a0(0x284),(_0x11f85e,_0x4614ee)=>{const _0x8b09d3=_0x1ef2a0;if(validateAccess(_0x4614ee,_0x2b9bb2)[_0x8b09d3(0x307)]){if(pid[_0x322bd1])pid[_0x322bd1][_0x8b09d3(0x2e1)]({'function':_0x8b09d3(0x186),'args':_0x11f85e});}else logger[_0x8b09d3(0x34c)](_0x8b09d3(0x286));}),_0x18c5e6['on'](_0x1ef2a0(0x304),(_0x41d86c,_0x406c94)=>{const _0x1f4d51=_0x1ef2a0;if(validateAccess(_0x406c94,_0x2b9bb2)['allow']){if(pid[_0x322bd1])pid[_0x322bd1][_0x1f4d51(0x2e1)]({'function':_0x1f4d51(0x2c8),'args':_0x41d86c});}else logger['full'](_0x1f4d51(0x30e));}),_0x18c5e6['on']('reset-history',_0x158b8f=>{const _0x312a14=_0x1ef2a0;if(validateAccess(_0x158b8f,_0x2b9bb2)['allow']){if(pid[_0x322bd1])pid[_0x322bd1]['send']({'function':_0x312a14(0x323),'args':null});}else logger['full'](_0x312a14(0x1a1));}),_0x18c5e6['on'](_0x1ef2a0(0x313),_0x483260=>{const _0x2da7c6=_0x1ef2a0;if(validateAccess(_0x483260,_0x2b9bb2)['allow']){if(pid[_0x322bd1])pid[_0x322bd1]['send']({'function':_0x2da7c6(0x1e4),'args':null});}else logger['full'](_0x2da7c6(0x15a));}),_0x18c5e6['on'](_0x1ef2a0(0x355),(_0x2fbeb9,_0x46b35c)=>{const _0x4bb07f=_0x1ef2a0;if(validateAccess(_0x46b35c,_0x2b9bb2)['allow']){if(pid[_0x322bd1])pid[_0x322bd1][_0x4bb07f(0x2e1)]({'function':'placeOrder','args':_0x2fbeb9});}else logger[_0x4bb07f(0x34c)](_0x4bb07f(0x1e5));}),_0x18c5e6['on'](_0x1ef2a0(0x1e3),_0x158583=>{const _0x5cc855=_0x1ef2a0;if(validateAccess(_0x158583,_0x2b9bb2)[_0x5cc855(0x307)]){if(pid[_0x322bd1])pid[_0x322bd1]['send']({'function':'cancelLoading','args':null});}else logger[_0x5cc855(0x34c)](_0x5cc855(0x2d2));}),_0x18c5e6['on']('show-config',_0xbe89f0=>{const _0x483f4a=_0x1ef2a0;if(validateAccess(_0xbe89f0,_0x2b9bb2)[_0x483f4a(0x307)]){if(pid[_0x322bd1])pid[_0x322bd1][_0x483f4a(0x2e1)]({'function':_0x483f4a(0x302),'args':null});}else logger[_0x483f4a(0x34c)](_0x483f4a(0x23d));}),_0x18c5e6['on']('update-bb',_0x28b788=>{const _0xad2698=_0x1ef2a0;if(validateAccess(_0x28b788,_0x2b9bb2)[_0xad2698(0x307)])updateBB(_0xad2698(0x2b8));else logger[_0xad2698(0x34c)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x18c5e6['on']('get-messages',_0x5508dd=>{const _0x38a3bf=_0x1ef2a0;if(validateAccess(_0x5508dd,_0x2b9bb2)[_0x38a3bf(0x307)])getMessages();else logger['full'](_0x38a3bf(0x197));}),_0x18c5e6['on'](_0x1ef2a0(0x2f4),(_0x2be1b8,_0x34b645)=>{const _0x406477=_0x1ef2a0;if(validateAccess(_0x34b645,_0x2b9bb2)[_0x406477(0x307)])confirmMessage(_0x2be1b8);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x18c5e6['on'](_0x1ef2a0(0x21b),_0x121d71=>{const _0x2b3231=_0x1ef2a0;if(validateAccess(_0x121d71,_0x2b9bb2)['allow']){if(devices[_0x2b9bb2][_0x2b3231(0x1f6)])clearTimeout(devices[_0x2b9bb2][_0x2b3231(0x1f6)]);if(devices[_0x2b9bb2][_0x2b3231(0x212)])clearTimeout(devices[_0x2b9bb2]['pidExpireLogin']);removeSocketListeners(getClient(_0x18c5e6['id'])['uuid']),addBlacklist(_0x2b9bb2),devices[_0x2b9bb2][_0x2b3231(0x249)]=null,devices[_0x2b9bb2][_0x2b3231(0x1dc)]=null,devices[_0x2b9bb2][_0x2b3231(0x2e5)][_0x2b3231(0x242)]=null,logger['debug'](_0x2b3231(0x1dd)+_0x2b9bb2[_0x2b3231(0x1cf)](-0x8)),io['to'](getClient(_0x18c5e6['id'])[_0x2b3231(0x326)])[_0x2b3231(0x2b0)](_0x2b3231(0x2d9),{'access':{'allow':![],'reason':_0x2b3231(0x22a),'token':null}});}else logger[_0x2b3231(0x34c)](_0x2b3231(0x25c));});}function removeSocketListeners(_0x1a3415){getClientsWithUuid(_0x1a3415)['forEach'](_0x1d867c=>{const _0x331502=_0x70e7;getSocket(_0x1d867c['id'])[_0x331502(0x213)]();});}function cleanSettings(){const _0x12f06e=_0x2f8265;let _0x1a0855=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x1a0855={..._0x1a0855,'telegramToken':_0x12f06e(0x2df)}),settings[_0x12f06e(0x220)]&&settings[_0x12f06e(0x220)]!=''&&(_0x1a0855={..._0x1a0855,'bbPassword':_0x12f06e(0x2df)}),(settings[_0x12f06e(0x220)]&&settings['bbPassword']=='***'||settings[_0x12f06e(0x2ec)]&&settings[_0x12f06e(0x2ec)]==_0x12f06e(0x1e0))&&(_0x1a0855={..._0x1a0855,'restored':{'password':settings[_0x12f06e(0x220)]==_0x12f06e(0x1e0),'telegram':settings[_0x12f06e(0x2ec)]=='***'}}),_0x1a0855;}async function updateBB(_0x3dbebe){const _0x4278cd=_0x2f8265;await backupConfigFiles(),installingUpdate=!![],config[_0x4278cd(0x214)](_0x5f1356=>{restartBot(_0x5f1356['botID']);});if(_0x3dbebe==_0x4278cd(0x2b8))process['send']({'update':!![],'environment':environment},_0x178647=>{});else _0x3dbebe==_0x4278cd(0x1a4)&&process[_0x4278cd(0x2e1)]({'reinstall':!![],'environment':environment},_0x301e10=>{});}function startBot(_0x30c726,_0x8fad04,_0xfc3312){const _0x3425fe=_0x2f8265;if(debugging)_0x30c726[_0x3425fe(0x1f5)]('-d');let _0x3286e2=![];const _0x4a6621=_0x30c726[0x0];_0x8fad04={..._0x8fad04,'stdio':[_0x3425fe(0x1b7),_0x3425fe(0x1b7),_0x3425fe(0x1b7),_0x3425fe(0x357)]},pid[_0x4a6621]=childProcess[_0x3425fe(0x297)](botfile,_0x30c726,_0x8fad04),pid[_0x4a6621]['on'](_0x3425fe(0x20b),_0x273044=>{const _0x2b7df1=_0x3425fe;switch(Object[_0x2b7df1(0x152)](_0x273044)[0x0]){case _0x2b7df1(0x318):updateBotName(_0x4a6621,_0x273044[_0x2b7df1(0x318)]);break;case _0x2b7df1(0x1ea):updateBotManager();break;case _0x2b7df1(0x2d9):updateStatus(_0x4a6621,_0x273044[_0x2b7df1(0x2d9)]);break;case'live':updateLive(_0x4a6621,_0x273044[_0x2b7df1(0x349)]);break;case'started':updateLive(_0x4a6621,_0x273044[_0x2b7df1(0x279)]),io['to'](_0x4a6621)[_0x2b7df1(0x2b0)](_0x2b7df1(0x2d9),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x2b7df1(0x322):_0x273044[_0x2b7df1(0x322)]==_0x2b7df1(0x193)&&restartBot(_0x4a6621);_0x273044[_0x2b7df1(0x322)]==_0x2b7df1(0x352)&&toggleBot(_0x4a6621,_0x2b7df1(0x20c),'stopped');break;case'telegram':sendTelegramBot(_0x4a6621,_0x273044[_0x2b7df1(0x2c3)]);break;case _0x2b7df1(0x2f6):sendTelegramMsg(_0x273044['telegrammsg']);break;case'function':io['to'](_0x4a6621)['emit'](_0x273044['function'],_0x273044[_0x2b7df1(0x354)]);break;}}),pid[_0x4a6621]['on'](_0x3425fe(0x1f2),function(_0x13a7e5){if(_0x3286e2)return;_0x3286e2=!![],_0xfc3312(_0x13a7e5);}),pid[_0x4a6621]['on'](_0x3425fe(0x2c1),async function(_0x49e637){const _0x4ce4c0=_0x3425fe;if(installingUpdate){logger['debug'](_0x4ce4c0(0x316)),io['close']();return;}if(_0x3286e2)return;_0x3286e2=!![],_0xfc3312(null);const _0x26b81a=dbConfig[_0x4ce4c0(0x1f9)](_0x4ce4c0(0x168))[_0x4ce4c0(0x294)]({'botID':_0x4a6621})[_0x4ce4c0(0x300)]();_0x26b81a&&(_0x26b81a[_0x4ce4c0(0x2d9)]==_0x4ce4c0(0x301)||_0x26b81a['status']=='new')&&(await sleep(0x3e8),updateLive(_0x4a6621,'stopped'),logger[_0x4ce4c0(0x34c)]('Restarting\x20Bot\x20'+_0x4a6621),startBot([_0x4a6621,userID],{'cwd':bbpath},function(_0x4c8ff1){const _0x3ae224=_0x4ce4c0;if(_0x4c8ff1)logger[_0x3ae224(0x34c)](_0x4c8ff1);}));});}function stopBot(_0x3e519a){const _0x3c13e0=_0x2f8265;getClientsWithBotID(_0x3e519a)['forEach'](_0x47a2a0=>{const _0x16cd83=_0x70e7;getSocket(_0x47a2a0['id'])[_0x16cd83(0x19d)](!![]),removeClient(_0x47a2a0['id']);}),pid[_0x3e519a]&&(pid[_0x3e519a][_0x3c13e0(0x352)](),pid[_0x3e519a]=null);}function restartBot(_0x223373){const _0x13eff8=_0x2f8265;if(pid[_0x223373])pid[_0x223373][_0x13eff8(0x352)]();}function addBot(){const _0x592d7e=_0x2f8265;let _0x55d921;for(let _0x368adc=0x1;_0x368adc<0x3e9;_0x368adc++){_0x55d921=_0x368adc[_0x592d7e(0x1fc)]()[_0x592d7e(0x252)](0x3,'0');let _0x512963=config[_0x592d7e(0x294)](_0x10f29b=>_0x10f29b[_0x592d7e(0x151)]==_0x55d921);if(!_0x512963)break;}if(_0x55d921===_0x592d7e(0x2e0)){logger['full'](_0x592d7e(0x2e2));return;}logger['full'](_0x592d7e(0x1fb)+_0x55d921),dbConfig['get']('bots')[_0x592d7e(0x1f5)]({'botID':_0x55d921,'botname':_0x592d7e(0x174)+_0x55d921,'status':_0x592d7e(0x188),'live':''})[_0x592d7e(0x345)](),startBot([_0x55d921,userID],{'cwd':bbpath},function(_0x25c839){const _0x392318=_0x592d7e;if(_0x25c839)logger[_0x392318(0x34c)](_0x25c839);}),config=getConfiguration(),io['to'](_0x592d7e(0x233))[_0x592d7e(0x2b0)](_0x592d7e(0x168),config),broadcastToBots(_0x592d7e(0x168),JSON[_0x592d7e(0x172)](config));}function deleteBot(_0x14ecfc){const _0x11934e=_0x2f8265;getClientsWithBotID(_0x14ecfc)[_0x11934e(0x214)](_0x5aa05b=>{const _0x3a854f=_0x11934e;getSocket(_0x5aa05b['id'])[_0x3a854f(0x19d)](!![]),removeClient(_0x5aa05b['id']);}),dbConfig['get'](_0x11934e(0x168))[_0x11934e(0x182)]({'botID':_0x14ecfc})[_0x11934e(0x345)](),logger['full']('Deleted\x20Bot\x20'+_0x14ecfc),stopBot(_0x14ecfc);try{if(fs[_0x11934e(0x170)](path[_0x11934e(0x2b1)](configpath,_0x11934e(0x24d)+_0x14ecfc+_0x11934e(0x2cf))))fs[_0x11934e(0x1ef)](path['join'](configpath,_0x11934e(0x24d)+_0x14ecfc+_0x11934e(0x2cf)));if(fs[_0x11934e(0x170)](path['join'](configpath,_0x11934e(0x24d)+_0x14ecfc+'-events.json')))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x14ecfc+_0x11934e(0x16c)));if(fs[_0x11934e(0x170)](path[_0x11934e(0x2b1)](configpath,_0x11934e(0x24d)+_0x14ecfc+'-performance.json')))fs[_0x11934e(0x1ef)](path[_0x11934e(0x2b1)](configpath,_0x11934e(0x24d)+_0x14ecfc+_0x11934e(0x356)));if(fs[_0x11934e(0x170)](path['join'](configpath,'bot-'+_0x14ecfc+_0x11934e(0x15b))))fs[_0x11934e(0x1ef)](path[_0x11934e(0x2b1)](configpath,_0x11934e(0x24d)+_0x14ecfc+_0x11934e(0x15b)));}catch(_0x5d2b1e){if(_0x5d2b1e)logger[_0x11934e(0x34c)](_0x11934e(0x34a),_0x5d2b1e);}config=getConfiguration(),io['to'](_0x11934e(0x233))['emit'](_0x11934e(0x168),config),broadcastToBots('bots',JSON[_0x11934e(0x172)](config));}function toggleBot(_0x485818,_0x46b120,_0xf27b07){const _0x28fc40=_0x2f8265;dbConfig[_0x28fc40(0x1f9)]('bots')[_0x28fc40(0x294)]({'botID':_0x485818})[_0x28fc40(0x150)]({'status':_0x46b120})[_0x28fc40(0x150)]({'live':_0xf27b07})[_0x28fc40(0x345)]();if(_0x46b120==_0x28fc40(0x301)||_0x46b120==_0x28fc40(0x188))logger['full']('Enabled\x20Bot\x20'+_0x485818),startBot([_0x485818,userID],{'cwd':bbpath},function(_0x41ed1e){if(_0x41ed1e)logger['full'](_0x41ed1e);});else(_0x46b120=='disabled'||_0x46b120==_0x28fc40(0x2fe))&&(logger[_0x28fc40(0x34c)]('Disabled\x20Bot\x20'+_0x485818),stopBot(_0x485818));config=getConfiguration(),io['to'](_0x28fc40(0x233))['emit'](_0x28fc40(0x168),config),broadcastToBots(_0x28fc40(0x168),JSON[_0x28fc40(0x172)](config));}function toggleStatus(_0x547024){const _0x5a4340=_0x2f8265;let _0x3390e2=dbConfig[_0x5a4340(0x1f9)]('bots')[_0x5a4340(0x294)]({'botID':_0x547024})[_0x5a4340(0x300)](),_0x2b915e;if(_0x3390e2[_0x5a4340(0x2d9)]===_0x5a4340(0x301))_0x2b915e=_0x5a4340(0x20c);else{if(_0x3390e2[_0x5a4340(0x2d9)]==='new')_0x2b915e=_0x5a4340(0x2fe);else{if(_0x3390e2[_0x5a4340(0x2d9)]===_0x5a4340(0x2fe))_0x2b915e=_0x5a4340(0x188);else{if(_0x3390e2[_0x5a4340(0x2d9)]==='disabled')_0x2b915e=_0x5a4340(0x301);}}}return _0x2b915e;}function updateStatus(_0xd62ba,_0x440014){const _0xd3431=_0x2f8265;dbConfig[_0xd3431(0x1f9)](_0xd3431(0x168))[_0xd3431(0x294)]({'botID':_0xd62ba})[_0xd3431(0x150)]({'status':_0x440014})[_0xd3431(0x345)](),config=getConfiguration(),io['to'](_0xd3431(0x233))[_0xd3431(0x2b0)](_0xd3431(0x168),config),broadcastToBots('bots',JSON[_0xd3431(0x172)](config));}function updateLive(_0x3423ea,_0x3c902f){const _0xb76a94=_0x2f8265;dbConfig['get'](_0xb76a94(0x168))[_0xb76a94(0x294)]({'botID':_0x3423ea})[_0xb76a94(0x150)]({'live':_0x3c902f})[_0xb76a94(0x345)](),config=getConfiguration(),io['to']('botmanager')[_0xb76a94(0x2b0)]('bots',config),broadcastToBots('bots',JSON[_0xb76a94(0x172)](config));}function updateBotName(_0x3c0d03,_0x425687){const _0x30aafd=_0x2f8265;dbConfig[_0x30aafd(0x1f9)](_0x30aafd(0x168))[_0x30aafd(0x294)]({'botID':_0x3c0d03})[_0x30aafd(0x150)]({'botname':_0x425687})[_0x30aafd(0x345)](),config=getConfiguration(),io['to']('botmanager')[_0x30aafd(0x2b0)]('bots',config),broadcastToBots(_0x30aafd(0x168),JSON[_0x30aafd(0x172)](config));}function updateBotManager(){const _0xc9b2f7=_0x2f8265;config=getConfiguration(),io['to'](_0xc9b2f7(0x233))['emit'](_0xc9b2f7(0x168),config),broadcastToBots(_0xc9b2f7(0x168),JSON[_0xc9b2f7(0x172)](config));}function toggleBotMode(_0x191d9f){const _0x51a6da=_0x2f8265;if(pid[_0x191d9f])pid[_0x191d9f]['send']({'function':'toggleBotMode','args':null});else{const _0x4be1ef=configpath+_0x51a6da(0x24d)+_0x191d9f+_0x51a6da(0x2cf),_0x56361e=fs[_0x51a6da(0x2bf)](_0x4be1ef),_0x22edfb=JSON['parse'](_0x56361e),_0x599e74=_0x22edfb[_0x51a6da(0x2cc)][0x0][_0x51a6da(0x14e)];_0x22edfb[_0x51a6da(0x2cc)][0x0]['headless']=!_0x599e74;const _0x549cec=JSON[_0x51a6da(0x172)](_0x22edfb,null,0x2);fs[_0x51a6da(0x293)](_0x4be1ef,_0x549cec),config=getConfiguration(),io['to'](_0x51a6da(0x233))[_0x51a6da(0x2b0)]('bots',config),broadcastToBots(_0x51a6da(0x168),JSON[_0x51a6da(0x172)](config));}}function validateTelegram(_0x21dc64){const _0x10b0b6=_0x2f8265;if(_0x21dc64['from'][_0x10b0b6(0x240)]!=settings[_0x10b0b6(0x14c)]&&'@'+_0x21dc64[_0x10b0b6(0x15c)][_0x10b0b6(0x240)]!=settings[_0x10b0b6(0x14c)]||_0x21dc64['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x21dc64['chat']['id'],_0x10b0b6(0x288),{'parse_mode':_0x10b0b6(0x2d3)}),![];return!![];}async function initTelegram(){const _0x2ecad2=_0x2f8265;if(tgBot)tgBot[_0x2ecad2(0x322)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x2ecad2(0x2ec)]);let _0x5dd61a=_0x2ecad2(0x1ac);_0x5dd61a+='\x0a',_0x5dd61a+=_0x2ecad2(0x181),_0x5dd61a+=_0x2ecad2(0x310),_0x5dd61a+=_0x2ecad2(0x33e),_0x5dd61a+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x5dd61a+=_0x2ecad2(0x305),_0x5dd61a+=_0x2ecad2(0x232),_0x5dd61a+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x5dd61a+='/names\x20-\x20show\x20bot\x20names\x0a',_0x5dd61a+=_0x2ecad2(0x14d),_0x5dd61a+=_0x2ecad2(0x24b),_0x5dd61a+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x5dd61a+=_0x2ecad2(0x31d),_0x5dd61a+=_0x2ecad2(0x201),_0x5dd61a+=_0x2ecad2(0x204);let _0x2fb949=_0x2ecad2(0x210);_0x2fb949+='\x0a',_0x2fb949+=_0x5dd61a,tgBot[_0x2ecad2(0x291)]((_0xe7851f,_0x44342d)=>{const _0x7ac7e=_0x2ecad2;logger[_0x7ac7e(0x1c6)](getTimeStamp()+_0x7ac7e(0x24f)),logger[_0x7ac7e(0x29e)](_0x7ac7e(0x2ac),_0xe7851f);}),tgBot[_0x2ecad2(0x1a9)](async(_0x3c4660,_0x17ae87)=>{const _0x38f907=_0x2ecad2;if(!(!settings[_0x38f907(0x19e)]&&_0x3c4660[_0x38f907(0x2b8)][_0x38f907(0x20b)][_0x38f907(0x239)]==_0x38f907(0x192))){if(!validateTelegram(_0x3c4660))return;}_0x17ae87();}),tgBot[_0x2ecad2(0x2a6)](_0x2ecad2(0x26a),async _0x594206=>{const _0x3b5455=_0x2ecad2;if(!settings[_0x3b5455(0x19e)])updateSetting('telegramChatId',_0x594206[_0x3b5455(0x2c4)]['id']);updateSetting(_0x3b5455(0x255),!![]);if(!validateTelegram(_0x594206))return;await sendTelegram(_0x594206[_0x3b5455(0x2c4)]['id'],_0x2fb949);}),tgBot['command'](_0x2ecad2(0x292),async _0x28acfa=>{const _0x131e9f=_0x2ecad2;updateSetting(_0x131e9f(0x255),!![]),await sendTelegram(_0x28acfa[_0x131e9f(0x2c4)]['id'],_0x131e9f(0x160));}),tgBot[_0x2ecad2(0x2a6)]('disable',async _0x45ab4a=>{const _0x4548f1=_0x2ecad2;await sendTelegram(_0x45ab4a['chat']['id'],_0x4548f1(0x2cd)),updateSetting('telegramEnabled',![]);}),tgBot[_0x2ecad2(0x2a6)]('config',async _0x4dbcda=>{const _0x49db6c=_0x2ecad2,_0x450fc7=Markup[_0x49db6c(0x1d1)]([Markup[_0x49db6c(0x238)][_0x49db6c(0x1f1)](_0x49db6c(0x25e),_0x49db6c(0x19f)),Markup['button'][_0x49db6c(0x1f1)](_0x49db6c(0x2bc),'config_alerts'),Markup[_0x49db6c(0x238)][_0x49db6c(0x1f1)](_0x49db6c(0x1bb),_0x49db6c(0x1d4))]);_0x4dbcda[_0x49db6c(0x26f)](_0x49db6c(0x2da),_0x450fc7);}),tgBot[_0x2ecad2(0x2ef)](_0x2ecad2(0x19f),async _0x57910a=>{const _0x11f317=_0x2ecad2;_0x57910a[_0x11f317(0x237)](),updateSetting(_0x11f317(0x34e),_0x11f317(0x21e)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x57910a[_0x11f317(0x2c4)]['id'],_0x11f317(0x265));}),tgBot[_0x2ecad2(0x2ef)](_0x2ecad2(0x272),async _0xec46d2=>{const _0x292838=_0x2ecad2;_0xec46d2[_0x292838(0x237)](),updateSetting(_0x292838(0x34e),_0x292838(0x21c)),updateSetting(_0x292838(0x255),!![]),await sendTelegram(_0xec46d2['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x2ecad2(0x2ef)](_0x2ecad2(0x1d4),async _0x246ae8=>{const _0x1b08ac=_0x2ecad2;_0x246ae8[_0x1b08ac(0x237)](),updateSetting(_0x1b08ac(0x34e),'all'),updateSetting(_0x1b08ac(0x255),!![]),await sendTelegram(_0x246ae8[_0x1b08ac(0x2c4)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x2ecad2(0x2a6)]('status',async _0x18bf44=>{const _0xfac047=_0x2ecad2,_0x266a46=getBotsWithMode();let _0x454a91=_0xfac047(0x2b2);config[_0xfac047(0x214)](_0x42fa03=>{const _0x5a6a28=_0xfac047,_0x2c9295=_0x266a46[_0x5a6a28(0x294)](_0x7d2847=>_0x7d2847[_0x5a6a28(0x151)]==_0x42fa03[_0x5a6a28(0x151)])[_0x5a6a28(0x217)];_0x454a91+=_0x5a6a28(0x174)+_0x42fa03['botID']+':\x20'+_0x42fa03[_0x5a6a28(0x2d9)]+_0x5a6a28(0x161)+_0x2c9295+_0x5a6a28(0x161)+_0x42fa03[_0x5a6a28(0x349)]+'\x0a';}),_0x454a91+='\x0a',_0x454a91+=_0xfac047(0x165),_0x454a91+=!settings['telegramEnabled']?_0xfac047(0x1bd):_0xfac047(0x359),_0x454a91+=settings[_0xfac047(0x255)]?settings[_0xfac047(0x34e)]==_0xfac047(0x275)?_0xfac047(0x164):_0xfac047(0x15e)+settings[_0xfac047(0x34e)]+_0xfac047(0x295):'',await sendTelegram(_0x18bf44['chat']['id'],_0x454a91,{'parse_mode':'HTML'});}),tgBot[_0x2ecad2(0x2a6)](_0x2ecad2(0x193),async _0x193b11=>{const _0x310777=_0x2ecad2,_0x3ce338=getEnabledBots();if(_0x3ce338[_0x310777(0x335)]==0x0)await sendTelegram(_0x193b11[_0x310777(0x2c4)]['id'],_0x310777(0x1e1));else{if(_0x3ce338[_0x310777(0x335)]>0x1)_0x3ce338['push']({'botID':_0x310777(0x275)});let _0x35499c=[],_0x330628=[];const _0x2c01a8=_0x3ce338[_0x310777(0x335)]%0x4==0x0||_0x3ce338[_0x310777(0x335)]%0x4==0x3||_0x3ce338[_0x310777(0x335)]%0x3==0x1?0x4:0x3;let _0x3f78c1=0x0;_0x3ce338[_0x310777(0x214)]((_0x41c309,_0x2224e0)=>{const _0x3e23cf=_0x310777;if(_0x2224e0%_0x2c01a8==0x0)_0x330628=[];_0x330628[_0x3e23cf(0x1f5)](Markup['button'][_0x3e23cf(0x1f1)](_0x41c309[_0x3e23cf(0x151)]==_0x3e23cf(0x275)?'All\x20bots':_0x3e23cf(0x174)+_0x41c309[_0x3e23cf(0x151)],_0x3e23cf(0x211)+_0x41c309[_0x3e23cf(0x151)])),_0x2224e0%_0x2c01a8==0x0&&(_0x35499c[_0x3f78c1]=_0x330628,_0x3f78c1++);});const _0x4a29a3=Markup[_0x310777(0x1d1)](_0x35499c);_0x193b11['reply'](_0x310777(0x1ad),_0x4a29a3);}}),tgBot[_0x2ecad2(0x2ef)](/restart_(.+)/,async _0x14ad14=>{const _0x49e201=_0x2ecad2,_0x35184e=_0x14ad14[_0x49e201(0x1e7)][0x1];_0x14ad14[_0x49e201(0x237)](),_0x35184e==_0x49e201(0x275)?config['forEach'](_0x1757e1=>{const _0x44ea85=_0x49e201;restartBot(_0x1757e1[_0x44ea85(0x151)]);}):restartBot(_0x35184e);}),tgBot[_0x2ecad2(0x2a6)]('on',async _0x168d1c=>{const _0x3c59cb=_0x2ecad2,_0x182f80=getDisabledBots();if(_0x182f80['length']==0x0)await sendTelegram(_0x168d1c[_0x3c59cb(0x2c4)]['id'],_0x3c59cb(0x2f9));else{if(_0x182f80['length']>0x1)_0x182f80['push']({'botID':'all'});let _0x2d043f=[],_0x4378e9=[];const _0x41b0b9=_0x182f80[_0x3c59cb(0x335)]%0x4==0x0||_0x182f80['length']%0x4==0x3||_0x182f80[_0x3c59cb(0x335)]%0x3==0x1?0x4:0x3;let _0x37fe4c=0x0;_0x182f80['forEach']((_0x1d65cb,_0x256d79)=>{const _0x416bf6=_0x3c59cb;if(_0x256d79%_0x41b0b9==0x0)_0x4378e9=[];_0x4378e9[_0x416bf6(0x1f5)](Markup['button'][_0x416bf6(0x1f1)](_0x1d65cb[_0x416bf6(0x151)]==_0x416bf6(0x275)?_0x416bf6(0x33d):_0x416bf6(0x174)+_0x1d65cb[_0x416bf6(0x151)],_0x416bf6(0x19c)+_0x1d65cb[_0x416bf6(0x151)])),_0x256d79%_0x41b0b9==0x0&&(_0x2d043f[_0x37fe4c]=_0x4378e9,_0x37fe4c++);});const _0x42c4c5=Markup[_0x3c59cb(0x1d1)](_0x2d043f);_0x168d1c[_0x3c59cb(0x26f)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x42c4c5);}}),tgBot['action'](/on_(.+)/,async _0x94a9c3=>{const _0x5e9f22=_0x2ecad2,_0x4e150e=_0x94a9c3['match'][0x1];_0x94a9c3['editMessageReplyMarkup']();if(_0x4e150e==_0x5e9f22(0x275)){const _0x43c11e=getDisabledBots();await sendTelegram(_0x94a9c3[_0x5e9f22(0x2c4)]['id'],_0x5e9f22(0x260)),_0x43c11e['forEach'](_0x197806=>{const _0xb52ecb=_0x5e9f22;if(_0x197806[_0xb52ecb(0x151)]!='all')toggleBot(_0x197806[_0xb52ecb(0x151)],toggleStatus(_0x197806[_0xb52ecb(0x151)]),'stopped');});}else await sendTelegram(_0x94a9c3['chat']['id'],_0x5e9f22(0x266)+_0x4e150e),toggleBot(_0x4e150e,toggleStatus(_0x4e150e),'stopped');}),tgBot['command'](_0x2ecad2(0x199),async _0x3d3023=>{const _0x280ada=_0x2ecad2,_0x4853d0=getEnabledBots();if(_0x4853d0[_0x280ada(0x335)]==0x0)await sendTelegram(_0x3d3023[_0x280ada(0x2c4)]['id'],_0x280ada(0x1e1));else{if(_0x4853d0['length']>0x1)_0x4853d0[_0x280ada(0x1f5)]({'botID':_0x280ada(0x275)});let _0x5206d7=[],_0x434a87=[];const _0x3660f4=_0x4853d0[_0x280ada(0x335)]%0x4==0x0||_0x4853d0[_0x280ada(0x335)]%0x4==0x3||_0x4853d0['length']%0x3==0x1?0x4:0x3;let _0x3f23f8=0x0;_0x4853d0[_0x280ada(0x214)]((_0x1ff56c,_0xf76331)=>{const _0x5ef6a2=_0x280ada;if(_0xf76331%_0x3660f4==0x0)_0x434a87=[];_0x434a87[_0x5ef6a2(0x1f5)](Markup[_0x5ef6a2(0x238)]['callback'](_0x1ff56c[_0x5ef6a2(0x151)]=='all'?_0x5ef6a2(0x33d):_0x5ef6a2(0x174)+_0x1ff56c['botID'],_0x5ef6a2(0x1ab)+_0x1ff56c[_0x5ef6a2(0x151)])),_0xf76331%_0x3660f4==0x0&&(_0x5206d7[_0x3f23f8]=_0x434a87,_0x3f23f8++);});const _0x4b4f3d=Markup['inlineKeyboard'](_0x5206d7);_0x3d3023['reply'](_0x280ada(0x1ee),_0x4b4f3d);}}),tgBot[_0x2ecad2(0x2ef)](/off_(.+)/,async _0x1df6aa=>{const _0x243912=_0x2ecad2,_0x2c24d2=_0x1df6aa[_0x243912(0x1e7)][0x1];_0x1df6aa[_0x243912(0x237)]();if(_0x2c24d2==_0x243912(0x275)){const _0xe3b47f=getEnabledBots();await sendTelegram(_0x1df6aa[_0x243912(0x2c4)]['id'],_0x243912(0x207)),_0xe3b47f['forEach'](_0x472be3=>{const _0x636b6f=_0x243912;if(_0x472be3['botID']!=_0x636b6f(0x275))toggleBot(_0x472be3[_0x636b6f(0x151)],toggleStatus(_0x472be3[_0x636b6f(0x151)]),_0x636b6f(0x1d3));});}else await sendTelegram(_0x1df6aa[_0x243912(0x2c4)]['id'],_0x243912(0x309)+_0x2c24d2),toggleBot(_0x2c24d2,toggleStatus(_0x2c24d2),_0x243912(0x1d3));}),tgBot['command'](_0x2ecad2(0x340),async _0x2add24=>{const _0x5c14d0=_0x2ecad2,_0x3c9c05=getEnabledBots();if(_0x3c9c05[_0x5c14d0(0x335)]==0x0)await sendTelegram(_0x2add24[_0x5c14d0(0x2c4)]['id'],_0x5c14d0(0x1e1));else{if(_0x3c9c05[_0x5c14d0(0x335)]>0x1){let _0x5d2083=[],_0x2f1433=[];const _0x1a7ff2=_0x3c9c05[_0x5c14d0(0x335)]%0x4==0x0||_0x3c9c05['length']%0x4==0x3||_0x3c9c05[_0x5c14d0(0x335)]%0x3==0x1?0x4:0x3;let _0x5c5697=0x0;_0x3c9c05[_0x5c14d0(0x214)]((_0x33a5c9,_0x28197c)=>{const _0xd7d8c0=_0x5c14d0;if(_0x28197c%_0x1a7ff2==0x0)_0x2f1433=[];_0x2f1433['push'](Markup[_0xd7d8c0(0x238)][_0xd7d8c0(0x1f1)](_0xd7d8c0(0x174)+_0x33a5c9[_0xd7d8c0(0x151)],'metrics_'+_0x33a5c9[_0xd7d8c0(0x151)])),_0x28197c%_0x1a7ff2==0x0&&(_0x5d2083[_0x5c5697]=_0x2f1433,_0x5c5697++);});const _0x1ffd12=Markup[_0x5c14d0(0x1d1)](_0x5d2083);_0x2add24[_0x5c14d0(0x26f)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x1ffd12);}else{const _0x2151df=_0x3c9c05[0x0][_0x5c14d0(0x151)];if(pid[_0x2151df])pid[_0x2151df][_0x5c14d0(0x2e1)]({'function':_0x5c14d0(0x1b3),'args':null});}}}),tgBot[_0x2ecad2(0x2ef)](/metrics_(.+)/,async _0x4ea793=>{const _0x2aa1f5=_0x2ecad2,_0x3cd765=_0x4ea793['match'][0x1];_0x4ea793[_0x2aa1f5(0x237)]();if(pid[_0x3cd765])pid[_0x3cd765][_0x2aa1f5(0x2e1)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x2ecad2(0x23f),async _0x41b013=>{const _0x4ee8e8=_0x2ecad2,_0x4eb677=getEnabledBots();if(_0x4eb677['length']==0x0)await sendTelegram(_0x41b013['chat']['id'],_0x4ee8e8(0x1e1));else{if(_0x4eb677[_0x4ee8e8(0x335)]>0x1){let _0x41f346=[],_0x245e44=[];const _0x17c26c=_0x4eb677[_0x4ee8e8(0x335)]%0x4==0x0||_0x4eb677[_0x4ee8e8(0x335)]%0x4==0x3||_0x4eb677[_0x4ee8e8(0x335)]%0x3==0x1?0x4:0x3;let _0x10c90c=0x0;_0x4eb677['forEach']((_0x403496,_0x2093f4)=>{const _0x20494c=_0x4ee8e8;if(_0x2093f4%_0x17c26c==0x0)_0x245e44=[];_0x245e44['push'](Markup['button'][_0x20494c(0x1f1)](_0x20494c(0x174)+_0x403496[_0x20494c(0x151)],_0x20494c(0x346)+_0x403496['botID'])),_0x2093f4%_0x17c26c==0x0&&(_0x41f346[_0x10c90c]=_0x245e44,_0x10c90c++);});const _0x50c5ac=Markup['inlineKeyboard'](_0x41f346);_0x41b013['reply'](_0x4ee8e8(0x263),_0x50c5ac);}else{const _0x419dc8=_0x4eb677[0x0][_0x4ee8e8(0x151)];if(pid[_0x419dc8])pid[_0x419dc8][_0x4ee8e8(0x2e1)]({'function':_0x4ee8e8(0x195),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x10a10e=>{const _0x1fcb5c=_0x2ecad2,_0x3c0a14=_0x10a10e[_0x1fcb5c(0x1e7)][0x1];_0x10a10e[_0x1fcb5c(0x237)]();if(pid[_0x3c0a14])pid[_0x3c0a14]['send']({'function':_0x1fcb5c(0x195),'args':null});}),tgBot['command']('update',async _0x571b43=>{const _0x425ee1=_0x2ecad2;await getMessages();if(!updateAvailable)await sendTelegram(_0x571b43[_0x425ee1(0x2c4)]['id'],_0x425ee1(0x325));else{if(!validInstallation)await sendTelegram(_0x571b43['chat']['id'],_0x425ee1(0x1c2));else{const _0x34ef85=Markup[_0x425ee1(0x1d1)]([Markup[_0x425ee1(0x238)][_0x425ee1(0x1f1)](_0x425ee1(0x190),_0x425ee1(0x31b)),Markup[_0x425ee1(0x238)]['callback']('No',_0x425ee1(0x274))]);_0x571b43[_0x425ee1(0x26f)](_0x425ee1(0x159),_0x34ef85);}}}),tgBot[_0x2ecad2(0x2ef)](/update_(.+)/,async _0x1fbb1d=>{const _0x28dc03=_0x2ecad2,_0x349129=_0x1fbb1d[_0x28dc03(0x1e7)][0x1];_0x1fbb1d[_0x28dc03(0x237)](),_0x349129==_0x28dc03(0x1cb)&&(await sendTelegram(_0x1fbb1d[_0x28dc03(0x2c4)]['id'],_0x28dc03(0x167)),updateBB('update')),_0x349129=='no'&&await sendTelegram(_0x1fbb1d[_0x28dc03(0x2c4)]['id'],_0x28dc03(0x32a));}),tgBot[_0x2ecad2(0x2a6)](_0x2ecad2(0x1a4),async _0x16a456=>{const _0x9788b3=_0x2ecad2;if(!validInstallation)await sendTelegram(_0x16a456[_0x9788b3(0x2c4)]['id'],_0x9788b3(0x230));else{const _0x532441=Markup[_0x9788b3(0x1d1)]([Markup['button'][_0x9788b3(0x1f1)](_0x9788b3(0x190),_0x9788b3(0x1b9)),Markup['button'][_0x9788b3(0x1f1)]('No',_0x9788b3(0x1be))]);_0x16a456[_0x9788b3(0x26f)](_0x9788b3(0x26e),_0x532441);}}),tgBot['action'](/reinstall_(.+)/,async _0x10d63d=>{const _0x2fb347=_0x2ecad2,_0x4d2c2a=_0x10d63d[_0x2fb347(0x1e7)][0x1];_0x10d63d[_0x2fb347(0x237)](),_0x4d2c2a==_0x2fb347(0x1cb)&&(await sendTelegram(_0x10d63d[_0x2fb347(0x2c4)]['id'],_0x2fb347(0x1af)),updateBB('reinstall')),_0x4d2c2a=='no'&&await sendTelegram(_0x10d63d[_0x2fb347(0x2c4)]['id'],_0x2fb347(0x2a4));}),tgBot[_0x2ecad2(0x2a6)](_0x2ecad2(0x26c),async _0x5def8b=>{const _0x170cee=_0x2ecad2,_0x88b0c2=getBotsWithMode();if(_0x88b0c2[_0x170cee(0x335)]==0x0)await sendTelegram(_0x5def8b[_0x170cee(0x2c4)]['id'],_0x170cee(0x1e1));else{let _0x2b31c7=[],_0x4e46e2=[];const _0x2014e6=0x2;let _0x569e9b=0x0;_0x88b0c2[_0x170cee(0x214)]((_0x5e8ae8,_0x4b0b2e)=>{const _0x4e082d=_0x170cee;if(_0x4b0b2e%_0x2014e6==0x0)_0x4e46e2=[];_0x4e46e2['push'](Markup['button'][_0x4e082d(0x1f1)](_0x4e082d(0x174)+_0x5e8ae8[_0x4e082d(0x151)]+'\x20('+_0x5e8ae8['mode']+')','toggle_'+_0x5e8ae8[_0x4e082d(0x151)])),_0x4b0b2e%_0x2014e6==0x0&&(_0x2b31c7[_0x569e9b]=_0x4e46e2,_0x569e9b++);});const _0x50cbba=Markup[_0x170cee(0x1d1)](_0x2b31c7);_0x5def8b['reply'](_0x170cee(0x25b),_0x50cbba);}}),tgBot[_0x2ecad2(0x2ef)](/toggle_(.+)/,async _0x3ac50e=>{const _0x4617cf=_0x2ecad2,_0x371505=_0x3ac50e['match'][0x1];_0x3ac50e[_0x4617cf(0x237)]();const _0x161e71=getBotsWithMode(),_0x166d0f=_0x161e71[_0x4617cf(0x294)](_0x27d901=>_0x27d901[_0x4617cf(0x151)]==_0x371505),_0x502398=_0x166d0f['mode']=='auto'?_0x4617cf(0x155):_0x4617cf(0x28a);await sendTelegram(_0x3ac50e[_0x4617cf(0x2c4)]['id'],_0x4617cf(0x227)+_0x371505+'\x20to\x20'+_0x502398+_0x4617cf(0x244)),toggleBotMode(_0x371505);}),tgBot[_0x2ecad2(0x2a6)](_0x2ecad2(0x22d),async _0x17177f=>{const _0x593d8d=_0x2ecad2;let _0x20bc5e='';config['forEach'](_0x3b3625=>{const _0x4b0317=_0x70e7;_0x20bc5e+=_0x4b0317(0x174)+_0x3b3625[_0x4b0317(0x151)]+':\x20'+_0x3b3625[_0x4b0317(0x318)]+'\x0a';}),await sendTelegram(_0x17177f['chat']['id'],_0x20bc5e,{'parse_mode':_0x593d8d(0x2d3)});}),tgBot[_0x2ecad2(0x2a6)](_0x2ecad2(0x30f),async _0x4a3da2=>{const _0x4b26a8=_0x2ecad2;await sendTelegram(_0x4a3da2[_0x4b26a8(0x2c4)]['id'],_0x5dd61a);}),process[_0x2ecad2(0x1c9)](_0x2ecad2(0x18b),()=>tgBot[_0x2ecad2(0x322)](_0x2ecad2(0x18b))),process['once'](_0x2ecad2(0x2ea),()=>tgBot[_0x2ecad2(0x322)]('SIGTERM')),tgBot[_0x2ecad2(0x1c8)]();}}function disableTelegram(){const _0x1ab23a=_0x2f8265;tgBot&&tgBot[_0x1ab23a(0x322)]();}async function sendTelegram(_0x99be34,_0x14c41b,_0x560ef){const _0x14c5c4=_0x2f8265;try{await tgBot['telegram'][_0x14c5c4(0x250)](_0x99be34,_0x14c41b,_0x560ef);}catch(_0x300b63){console[_0x14c5c4(0x1d9)]('Telegram\x20error:',_0x300b63);}}async function sendTelegramBot(_0x47f682,_0x544a3e){const _0x2c9bc9=_0x2f8265;if(settings[_0x2c9bc9(0x255)]){if(settings['telegramEvents']==_0x2c9bc9(0x275)||(_0x544a3e[_0x2c9bc9(0x1cd)]==_0x2c9bc9(0x1f2)||_0x544a3e['type']==_0x2c9bc9(0x273)||_0x544a3e[_0x2c9bc9(0x1cd)]==_0x2c9bc9(0x2d6))&&settings[_0x2c9bc9(0x34e)]=='alerts'||_0x544a3e[_0x2c9bc9(0x1cd)]=='order'&&settings[_0x2c9bc9(0x34e)]==_0x2c9bc9(0x21e)){if(tgBot&&settings[_0x2c9bc9(0x19e)]){if(_0x544a3e['showname'])await sendTelegram(settings[_0x2c9bc9(0x19e)],_0x544a3e[_0x2c9bc9(0x318)]+_0x2c9bc9(0x20a)+_0x544a3e[_0x2c9bc9(0x1f4)]);else await sendTelegram(settings[_0x2c9bc9(0x19e)],'Bot\x20'+_0x47f682+_0x2c9bc9(0x20a)+_0x544a3e['event']);}}}}async function sendTelegramMsg(_0x1c9f32,_0x4d232c=_0x2f8265(0x2d3)){const _0x26bda9=_0x2f8265;return settings[_0x26bda9(0x255)]&&tgBot&&settings[_0x26bda9(0x19e)]?(await sendTelegram(settings['telegramChatId'],_0x1c9f32,{'parse_mode':_0x4d232c}),!![]):![];}function getDeviceWithIp(_0x154b50){const _0x35a879=_0x2f8265;return devices[_0x35a879(0x294)](_0x3c8e26=>_0x3c8e26['ip']===_0x154b50);}async function temporaryAccess2FA(_0x1cf0f1,_0x42adcc){const _0x3189b2=_0x2f8265;let _0x4a86f4=new Date(),_0xca3eee=![];if(lastIpApproval){if(_0x4a86f4-lastIpApproval<0x1388)_0xca3eee=!![];}lastIpApproval=new Date();if(_0xca3eee)return;if(tgBot&&settings[_0x3189b2(0x19e)]){const _0x5bfe51=Markup['inlineKeyboard']([Markup[_0x3189b2(0x238)][_0x3189b2(0x1f1)]('5\x20min',_0x3189b2(0x2f3)),Markup['button'][_0x3189b2(0x1f1)]('15\x20min',_0x3189b2(0x26d)),Markup[_0x3189b2(0x238)][_0x3189b2(0x1f1)](_0x3189b2(0x1b0),_0x3189b2(0x2f7)),Markup[_0x3189b2(0x238)]['callback'](_0x3189b2(0x2bd),_0x3189b2(0x16b))]);await sendTelegram(settings[_0x3189b2(0x19e)],_0x3189b2(0x2c0)+normalizeIP(_0x42adcc)[_0x3189b2(0x2b3)]+'\x20?',_0x5bfe51),tgBot[_0x3189b2(0x2ef)](/tempaccess_(.+)/,async _0xa33779=>{const _0x131508=_0x3189b2,_0x19b243=_0xa33779[_0x131508(0x1e7)][0x1];_0xa33779[_0x131508(0x237)](),devices[_0x1cf0f1][_0x131508(0x249)]={'clientip':_0x42adcc,'timestamp':new Date()[_0x131508(0x1e2)](),'expiry':_0x19b243},_0x19b243!=_0x131508(0x2bd)?(await sendTelegram(_0xa33779[_0x131508(0x2c4)]['id'],_0x131508(0x2b7)+_0x19b243+_0x131508(0x158),{'parse_mode':_0x131508(0x2d3)}),io['to'](_0x1cf0f1)[_0x131508(0x2b0)](_0x131508(0x2d9),{'access':{'allow':![],'reason':_0x131508(0x270),'token':null}})):(await sendTelegram(_0xa33779[_0x131508(0x2c4)]['id'],_0x131508(0x171)),io['to'](_0x1cf0f1)['emit']('status',{'access':{'allow':![],'reason':_0x131508(0x23c),'token':null}}));});}}async function loginAccess2FA(_0x4941dd,_0x2e4b20){const _0x353122=_0x2f8265;if(tgBot&&settings[_0x353122(0x19e)]){const _0x45b3e4=Markup[_0x353122(0x1d1)]([Markup[_0x353122(0x238)][_0x353122(0x1f1)](_0x353122(0x34d),_0x353122(0x31c)+loginExpiry),Markup[_0x353122(0x238)]['callback'](_0x353122(0x2bd),_0x353122(0x296))]);await sendTelegram(settings[_0x353122(0x19e)],_0x353122(0x1b1)+normalizeIP(_0x2e4b20)[_0x353122(0x2b3)]+'\x20?',_0x45b3e4),tgBot[_0x353122(0x2ef)](/login2fa_(.+)/,async _0x5b577c=>{const _0x3f938c=_0x353122,_0x31c2c1=_0x5b577c['match'][0x1];_0x5b577c['editMessageReplyMarkup'](),devices[_0x4941dd][_0x3f938c(0x1dc)]={'clientip':_0x2e4b20,'timestamp':new Date()[_0x3f938c(0x1e2)](),'expiry':_0x31c2c1},_0x31c2c1!=_0x3f938c(0x2bd)?(await sendTelegram(_0x5b577c[_0x3f938c(0x2c4)]['id'],_0x3f938c(0x24e),{'parse_mode':_0x3f938c(0x2d3)}),io['to'](_0x4941dd)['emit'](_0x3f938c(0x2d9),{'access':{'allow':![],'reason':_0x3f938c(0x270),'token':null}})):(await sendTelegram(_0x5b577c[_0x3f938c(0x2c4)]['id'],_0x3f938c(0x258)),io['to'](_0x4941dd)[_0x3f938c(0x2b0)](_0x3f938c(0x2d9),{'access':{'allow':![],'reason':_0x3f938c(0x23e),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4fa9a4=_0x2f8265;return dbConfig[_0x4fa9a4(0x1f9)]('bots')['sortBy'](_0x4fa9a4(0x151))[_0x4fa9a4(0x311)]({'status':'enabled'})[_0x4fa9a4(0x300)]()||[];}function getDisabledBots(){const _0x1ba867=_0x2f8265;return dbConfig['get'](_0x1ba867(0x168))[_0x1ba867(0x1bc)](_0x1ba867(0x151))[_0x1ba867(0x311)]({'status':_0x1ba867(0x20c)})['value']()||[];}function getBotAttributes(_0x457e06){const _0x5f0373=_0x2f8265;let _0x24ede8={};const _0x4de4ea=configpath+_0x5f0373(0x24d)+_0x457e06+'-config.json',_0x2fd026=fs[_0x5f0373(0x170)](_0x4de4ea);if(_0x2fd026){const _0x165b23=fs[_0x5f0373(0x2bf)](_0x4de4ea);try{const _0x3a2c32=JSON['parse'](_0x165b23),_0x438e8c=_0x3a2c32?_0x3a2c32[_0x5f0373(0x2cc)][0x0][_0x5f0373(0x14e)]:![];_0x24ede8[_0x5f0373(0x217)]=_0x438e8c?_0x5f0373(0x28a):_0x5f0373(0x155),_0x24ede8[_0x5f0373(0x318)]=_0x3a2c32?_0x3a2c32[_0x5f0373(0x2cc)][0x0]['botname']:_0x5f0373(0x174)+_0x457e06;}catch(_0x33b569){_0x24ede8[_0x5f0373(0x217)]=_0x5f0373(0x155),_0x24ede8[_0x5f0373(0x318)]=_0x5f0373(0x174)+_0x457e06;}}else _0x24ede8[_0x5f0373(0x217)]=_0x5f0373(0x155),_0x24ede8['botname']=_0x5f0373(0x174)+_0x457e06;return _0x24ede8;}function getBotsWithMode(){const _0x2ceab0=_0x2f8265,_0x4d363b=dbConfig[_0x2ceab0(0x1f9)](_0x2ceab0(0x168))[_0x2ceab0(0x1bc)](_0x2ceab0(0x151))[_0x2ceab0(0x300)]()||[];return _0x4d363b[_0x2ceab0(0x214)](_0x3597dd=>{const _0x825eac=_0x2ceab0;let _0x2242e2=getBotAttributes(_0x3597dd['botID']);_0x3597dd['mode']=_0x2242e2[_0x825eac(0x217)];}),_0x4d363b;}function getBotExchanges(){const _0x4bc735=_0x2f8265;let _0x263b43=[];const _0x3100e1=dbConfig['get'](_0x4bc735(0x168))[_0x4bc735(0x1bc)](_0x4bc735(0x151))['value']()||[];_0x3100e1['forEach'](_0x195bb1=>{const _0x11d6b1=_0x4bc735;if(_0x195bb1['status']=='enabled'){const _0x8fdb8c=configpath+_0x11d6b1(0x24d)+_0x195bb1[_0x11d6b1(0x151)]+_0x11d6b1(0x2cf),_0x5031ff=fs[_0x11d6b1(0x170)](_0x8fdb8c);let _0x30720d;if(_0x5031ff){const _0x87cfd5=fs[_0x11d6b1(0x2bf)](_0x8fdb8c);try{const _0xc2a48c=JSON[_0x11d6b1(0x350)](_0x87cfd5);_0x30720d=_0xc2a48c?_0xc2a48c[_0x11d6b1(0x2cc)][0x0][_0x11d6b1(0x14b)]:null;}catch(_0x5f4884){}}if(_0x30720d)_0x263b43['push'](_0x30720d);}});const _0x54c991=[...new Set(_0x263b43)][_0x4bc735(0x27b)]();return _0x54c991;}async function initUser(){const _0x183aaa=_0x2f8265;if(!settings[_0x183aaa(0x2bb)]){const _0x10bcbd=uuidRandom();mixpanel[_0x183aaa(0x29f)](_0x10bcbd),updateSetting(_0x183aaa(0x2bb),_0x10bcbd);}}async function initSecure(){const _0x35f571=_0x2f8265;let _0x3571a9=getSecure();if(!_0x3571a9[_0x35f571(0x1fa)](_0x35f571(0x28e))){let _0x1c71fb=await generateKeys();_0x3571a9[_0x35f571(0x20e)]=_0x1c71fb['publicKey'],_0x3571a9[_0x35f571(0x236)]=_0x1c71fb[_0x35f571(0x236)],_0x3571a9['secret']=crypto[_0x35f571(0x1ff)](0x20)[_0x35f571(0x1fc)](_0x35f571(0x1a6));;storeSecure(_0x3571a9);}}function getSettings(){const _0x13cf40=_0x2f8265;return dbSettings[_0x13cf40(0x1f9)]('settings')[_0x13cf40(0x300)]()||{};}function getSecure(){const _0xead50f=_0x2f8265;return dbSecure[_0xead50f(0x1f9)](_0xead50f(0x247))[_0xead50f(0x300)]()||{};}function getBlacklist(){const _0x51908f=_0x2f8265;return dbSecure['get'](_0x51908f(0x348))[_0x51908f(0x300)]()||[];}function broadcastToBots(_0x4412d1,_0x4bc344){const _0x29aa0f=_0x2f8265;config[_0x29aa0f(0x214)](_0x29485c=>{const _0x3e58b4=_0x29aa0f;if(_0x29485c[_0x3e58b4(0x2d9)]==_0x3e58b4(0x301)&&_0x29485c[_0x3e58b4(0x349)]==_0x3e58b4(0x27f)||_0x29485c[_0x3e58b4(0x2d9)]==_0x3e58b4(0x188)&&_0x29485c[_0x3e58b4(0x349)]==_0x3e58b4(0x27f)){if(pid[_0x29485c[_0x3e58b4(0x151)]])pid[_0x29485c[_0x3e58b4(0x151)]][_0x3e58b4(0x2e1)]({[_0x4412d1]:_0x4bc344});}});}function storeSettings(_0x4c6569,_0x879cd9=![]){const _0x157ff8=_0x2f8265;_0x4c6569={...settings,..._0x4c6569};if(_0x879cd9&&_0x4c6569[_0x157ff8(0x220)]!=_0x157ff8(0x2df)&&_0x4c6569[_0x157ff8(0x220)]!=_0x157ff8(0x1e0)&&_0x4c6569[_0x157ff8(0x220)]!=''){const _0x3f732b=crypt[_0x157ff8(0x219)](secure[_0x157ff8(0x236)],_0x4c6569[_0x157ff8(0x220)])[_0x157ff8(0x20b)]['split']('@')[0x0],_0x1f9efa=bcrypt['hashSync'](_0x3f732b,saltRounds);_0x4c6569={..._0x4c6569,'bbPassword':_0x1f9efa};}if(_0x879cd9&&_0x4c6569[_0x157ff8(0x2ec)]!=_0x157ff8(0x2df)&&_0x4c6569[_0x157ff8(0x2ec)]!=_0x157ff8(0x1e0)&&_0x4c6569['telegramToken']!=''){const _0x1cde9f=crypt[_0x157ff8(0x219)](secure['privateKey'],_0x4c6569[_0x157ff8(0x2ec)])['message'][_0x157ff8(0x225)]('@')[0x0];_0x4c6569={..._0x4c6569,'telegramToken':_0x1cde9f};}const _0x362091=_0x4c6569['telegramToken']!=_0x157ff8(0x2df)&&_0x4c6569[_0x157ff8(0x2ec)]!=settings[_0x157ff8(0x2ec)]||_0x4c6569[_0x157ff8(0x14c)]!=settings['telegramUsername'],_0x836c98=_0x4c6569[_0x157ff8(0x2ec)]==''||_0x4c6569[_0x157ff8(0x14c)]=='';_0x362091&&(_0x4c6569[_0x157ff8(0x19e)]=null,_0x4c6569[_0x157ff8(0x34e)]=_0x157ff8(0x275));for(const [_0x20e8a9,_0x5146c1]of Object['entries'](_0x4c6569)){if(_0x20e8a9=='telegramToken'&&_0x5146c1==_0x157ff8(0x2df)){_0x4c6569[_0x157ff8(0x2ec)]=settings['telegramToken'];continue;};if(_0x20e8a9==_0x157ff8(0x220)&&_0x5146c1==_0x157ff8(0x2df)){_0x4c6569[_0x157ff8(0x220)]=settings[_0x157ff8(0x220)];continue;};dbSettings['set'](_0x157ff8(0x16f)+_0x20e8a9,_0x5146c1)[_0x157ff8(0x345)]();}settings=_0x4c6569,io['to'](_0x157ff8(0x233))[_0x157ff8(0x2b0)]('settings',cleanSettings()),broadcastToBots(_0x157ff8(0x2e9),settings[_0x157ff8(0x2e9)]),broadcastToBots(_0x157ff8(0x33f),settings['onepagemode']);if(_0x362091&&!_0x836c98)initTelegram();if(_0x362091&&_0x836c98)disableTelegram();getAllClients()['forEach'](_0x5bfc4e=>{const _0x1d814a=_0x157ff8;getSocket(_0x5bfc4e['id'])[_0x1d814a(0x2b0)]('status',{'access':{'allow':![],'reason':_0x1d814a(0x270),'token':null}});});}function updateSetting(_0x188075,_0x11fdd5){const _0x4903c7=_0x2f8265;dbSettings[_0x4903c7(0x2b5)](_0x4903c7(0x16f)+_0x188075,_0x11fdd5)[_0x4903c7(0x345)](),settings=getSettings(),io['to'](_0x4903c7(0x233))['emit'](_0x4903c7(0x264),cleanSettings());}function storeSecure(_0x29d42d){const _0x5ad09b=_0x2f8265;dbSecure[_0x5ad09b(0x1f9)]('secure')[_0x5ad09b(0x1f5)](_0x29d42d)['write'](),secure=_0x29d42d;}function addBlacklist(_0x12ecf9){const _0x1c991c=_0x2f8265;cleanBlacklist();let _0x518e1f;devices[_0x12ecf9][_0x1c991c(0x249)]?_0x518e1f=Math[_0x1c991c(0x32b)](devices[_0x12ecf9][_0x1c991c(0x249)][_0x1c991c(0x1c3)],loginExpiry):_0x518e1f=loginExpiry,dbSecure[_0x1c991c(0x1f9)](_0x1c991c(0x348))['push']({'expiry':new Date()['getTime']()+_0x518e1f*0x3c*0x3e8,'token':devices[_0x12ecf9][_0x1c991c(0x2e5)][_0x1c991c(0x242)]})[_0x1c991c(0x345)](),blacklist=dbSecure[_0x1c991c(0x1f9)]('blacklist')['value']();}function cleanBlacklist(){const _0x201c33=_0x2f8265;let _0x59eeda=dbSecure[_0x201c33(0x1f9)](_0x201c33(0x348))[_0x201c33(0x18e)]()['value'](),_0x5dcaaa=new Date()[_0x201c33(0x1e2)]();_0x59eeda[_0x201c33(0x214)](_0x2408b9=>{const _0x31f5ea=_0x201c33;_0x2408b9[_0x31f5ea(0x1c3)]<_0x5dcaaa&&dbSecure[_0x31f5ea(0x1f9)](_0x31f5ea(0x348))['remove']({'expiry':_0x2408b9['expiry']})[_0x31f5ea(0x345)]();});}function initStates(){const _0x335fdb=_0x2f8265;let _0x125b03=getConfiguration();_0x125b03[_0x335fdb(0x214)](_0x9a589f=>{const _0x93c0d8=_0x335fdb;_0x9a589f[_0x93c0d8(0x349)]=_0x93c0d8(0x1d3);}),storeConfiguration(_0x125b03);}function onKeys(){const _0x2d148e=new RSA();return new Promise(_0xcf77aa=>{const _0x3d3ecf=_0x70e7;_0x2d148e['generateKeyPairAsync']()[_0x3d3ecf(0x228)](_0x279def=>{_0xcf77aa(_0x279def);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3d9644=_0x2f8265;let _0x1a300f=getSettings(),_0x1c62ea=![];!_0x1a300f[_0x3d9644(0x1fa)](_0x3d9644(0x29d))&&(_0x1a300f['lastmsgtelegram']=0x0,_0x1c62ea=!![]);!_0x1a300f['hasOwnProperty'](_0x3d9644(0x28b))&&(_0x1a300f[_0x3d9644(0x28b)]=0x0,_0x1c62ea=!![]);!_0x1a300f[_0x3d9644(0x1fa)](_0x3d9644(0x19b))&&(_0x1a300f[_0x3d9644(0x19b)]=_0x3d9644(0x317),_0x1c62ea=!![]);!_0x1a300f[_0x3d9644(0x1fa)](_0x3d9644(0x33f))&&(_0x1a300f[_0x3d9644(0x33f)]=![],_0x1c62ea=!![]);if(_0x1c62ea)storeSettings(_0x1a300f);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x3d9644(0x214)](_0x2aaed3=>{const _0x5b67bc=_0x3d9644;if(!_0x2aaed3[_0x5b67bc(0x289)]()){if(!_0x2aaed3[_0x5b67bc(0x358)][_0x5b67bc(0x169)](_0x5b67bc(0x17b)))fs[_0x5b67bc(0x1ef)](configbackuppath+_0x2aaed3[_0x5b67bc(0x358)]);}else fs[_0x5b67bc(0x1a2)](configbackuppath+_0x2aaed3[_0x5b67bc(0x358)],{'recursive':!![]});});}catch(_0x3cdb37){logger[_0x3d9644(0x29e)]('Error\x20removing\x20old\x20backup\x20files:',_0x3cdb37);}}function storeConfiguration(_0x135161){const _0x1c526a=_0x2f8265;dbConfig[_0x1c526a(0x1f9)](_0x1c526a(0x168))['remove']()[_0x1c526a(0x345)](),dbConfig[_0x1c526a(0x1f9)](_0x1c526a(0x168))[_0x1c526a(0x1f5)](..._0x135161)[_0x1c526a(0x345)](),config=_0x135161;}async function resetPassword(){const _0x3673d1=_0x2f8265;if(tgBot&&settings[_0x3673d1(0x19e)]){const _0x164768=Markup[_0x3673d1(0x1d1)]([Markup[_0x3673d1(0x238)][_0x3673d1(0x1f1)](_0x3673d1(0x1cb),'resetpw_yes'),Markup['button'][_0x3673d1(0x1f1)]('no',_0x3673d1(0x1b6))]);await sendTelegram(settings['telegramChatId'],_0x3673d1(0x224),_0x164768),tgBot['action'](/resetpw_(.+)/,async _0x489d4a=>{const _0x58eeea=_0x3673d1,_0x3e4343=_0x489d4a['match'][0x1];_0x489d4a[_0x58eeea(0x237)]();if(_0x3e4343!='no'){const _0x54d9cc=0xf,_0x2903c1='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1cefa6=Array[_0x58eeea(0x15c)](crypto[_0x58eeea(0x351)](new Uint32Array(_0x54d9cc)))[_0x58eeea(0x1a5)](_0x3c2a4a=>_0x2903c1[_0x3c2a4a%_0x2903c1[_0x58eeea(0x335)]])['join'](''),_0x26d204=bcrypt[_0x58eeea(0x2a3)](_0x1cefa6,saltRounds);storeSettings({'bbPassword':_0x26d204}),await sendTelegram(_0x489d4a[_0x58eeea(0x2c4)]['id'],_0x58eeea(0x268)+_0x1cefa6,{'parse_mode':_0x58eeea(0x2d3)});}else await sendTelegram(_0x489d4a['chat']['id'],_0x58eeea(0x2ff));});}}async function confirmRestore(_0x32b62a,_0x448e06){const _0x39c641=_0x2f8265;io['to'](_0x39c641(0x233))[_0x39c641(0x2b0)](_0x39c641(0x241),_0x39c641(0x2ca),_0x39c641(0x2d6));if(tgBot&&settings[_0x39c641(0x19e)]){const _0x1ee25e=Markup[_0x39c641(0x1d1)]([Markup[_0x39c641(0x238)][_0x39c641(0x1f1)]('yes',_0x39c641(0x1e9)),Markup[_0x39c641(0x238)][_0x39c641(0x1f1)]('no','restore_no')]);await sendTelegram(settings[_0x39c641(0x19e)],_0x39c641(0x1ba),_0x1ee25e),tgBot[_0x39c641(0x2ef)](/restore_(.+)/,async _0x970f16=>{const _0xc42dcb=_0x39c641,_0x12a60f=_0x970f16['match'][0x1];_0x970f16[_0xc42dcb(0x237)](),_0x12a60f==_0xc42dcb(0x1cb)?(logger[_0xc42dcb(0x29e)](_0xc42dcb(0x1f7)),await sendTelegram(_0x970f16[_0xc42dcb(0x2c4)]['id'],_0xc42dcb(0x1d0),{'parse_mode':_0xc42dcb(0x2d3)}),unzipFile(_0x32b62a,_0x448e06)):(logger[_0xc42dcb(0x29e)](_0xc42dcb(0x2f0)),await sendTelegram(_0x970f16[_0xc42dcb(0x2c4)]['id'],_0xc42dcb(0x2f0)));});}}function getServerTime(){const _0x359e2f=_0x2f8265,_0x1ad458=new Date();return _0x1ad458[_0x359e2f(0x231)]()+'/'+(_0x1ad458['getMonth']()+0x1)['toString']()[_0x359e2f(0x252)](0x2,'0')+'/'+_0x1ad458[_0x359e2f(0x18a)]()[_0x359e2f(0x1fc)]()[_0x359e2f(0x252)](0x2,'0')+'\x20'+_0x1ad458[_0x359e2f(0x2e7)]()['toString']()['padStart'](0x2,'0')+':'+_0x1ad458[_0x359e2f(0x14a)]()[_0x359e2f(0x1fc)]()['padStart'](0x2,'0')+':'+_0x1ad458[_0x359e2f(0x246)]()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x50e20c=_0x2f8265,_0x76e3ac=shiftedTime();return _0x76e3ac[_0x50e20c(0x231)]()+'/'+(_0x76e3ac[_0x50e20c(0x2c9)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x76e3ac[_0x50e20c(0x18a)]()['toString']()[_0x50e20c(0x252)](0x2,'0')+'\x20'+_0x76e3ac[_0x50e20c(0x2e7)]()[_0x50e20c(0x1fc)]()[_0x50e20c(0x252)](0x2,'0')+':'+_0x76e3ac[_0x50e20c(0x14a)]()[_0x50e20c(0x1fc)]()[_0x50e20c(0x252)](0x2,'0')+':'+_0x76e3ac['getSeconds']()['toString']()[_0x50e20c(0x252)](0x2,'0');}function getCleanTimeStamp(){const _0x318f46=_0x2f8265,_0x42458d=shiftedTime();return _0x42458d[_0x318f46(0x231)]()+(_0x42458d[_0x318f46(0x2c9)]()+0x1)['toString']()[_0x318f46(0x252)](0x2,'0')+_0x42458d[_0x318f46(0x18a)]()['toString']()[_0x318f46(0x252)](0x2,'0')+'-'+_0x42458d[_0x318f46(0x2e7)]()['toString']()[_0x318f46(0x252)](0x2,'0')+_0x42458d['getMinutes']()[_0x318f46(0x1fc)]()['padStart'](0x2,'0')+_0x42458d[_0x318f46(0x246)]()[_0x318f46(0x1fc)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x23b946=_0x2f8265,_0x3a962a=new Date();let _0x178472=_0x3a962a;if(settings[_0x23b946(0x2e9)]&&settings['timeshift']!==0x0)_0x178472=fns['add'](_0x3a962a,{'hours':settings['timeshift']});return _0x178472;}function startScheduler(){const _0x104d48=new Date()['getUTCHours'](),_0x47e341=shiftedTime()['getHours']();_0x47e341==0x4&&backupConfigFiles();_0x47e341==0x0&&rotateLogFiles();_0x104d48%0x6==0x0&&triggerAnalytics();_0x104d48%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x31684b){const _0x2bacdd=_0x2f8265;logger['debug'](_0x2bacdd(0x198)+_0x31684b);const _0x14461e=getBotsWithMode();_0x14461e[_0x2bacdd(0x335)]>0x0?confirmRestore(configbackuppath,_0x31684b):unzipFile(configbackuppath,_0x31684b);}async function getBackupFiles(_0x1a7b67=null){const _0x444603=_0x2f8265;let _0x423638=[],_0x1bfaa9=fs[_0x444603(0x1e8)](configbackuppath,{'withFileTypes':!![]});_0x1bfaa9['sort']((_0x29c872,_0x3ee1c)=>_0x29c872[_0x444603(0x358)]<_0x3ee1c[_0x444603(0x358)]?0x1:_0x3ee1c[_0x444603(0x358)]<_0x29c872[_0x444603(0x358)]?-0x1:0x0),_0x1bfaa9['forEach'](_0x1eea00=>{const _0x2e13b6=_0x444603;if(!_0x1eea00[_0x2e13b6(0x289)]()&&_0x1eea00[_0x2e13b6(0x358)][_0x2e13b6(0x169)](_0x2e13b6(0x17b))&&_0x1eea00[_0x2e13b6(0x358)][_0x2e13b6(0x2d5)](_0x2e13b6(0x329))){const _0x2c3dda=formatDate(fs[_0x2e13b6(0x344)](configbackuppath+_0x1eea00[_0x2e13b6(0x358)])[_0x2e13b6(0x1e6)]);_0x423638[_0x2e13b6(0x1f5)]({'name':_0x1eea00[_0x2e13b6(0x358)],'mtime':_0x2c3dda});}});if(_0x1a7b67)io['to'](_0x1a7b67)[_0x444603(0x2b0)](_0x444603(0x2f2),_0x423638);else return _0x423638;}function _0x70e7(_0x4f52c4,_0x4d79b0){const _0x347f60=_0x4582();return _0x70e7=function(_0x32f9e1,_0x22cd73){_0x32f9e1=_0x32f9e1-0x145;let _0x45822d=_0x347f60[_0x32f9e1];return _0x45822d;},_0x70e7(_0x4f52c4,_0x4d79b0);}async function backupConfigFiles(){const _0x7fc2d1=_0x2f8265;await zipFiles(_0x7fc2d1(0x2ed));const _0x15fbe6=getCleanTimeStamp();fs[_0x7fc2d1(0x1c1)](zippath+_0x7fc2d1(0x2ae),configbackuppath+(_0x7fc2d1(0x17b)+_0x15fbe6+'.zip'));let _0x136af8=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x136af8[_0x7fc2d1(0x27b)]((_0x5658d8,_0x64e29b)=>_0x5658d8['name']<_0x64e29b[_0x7fc2d1(0x358)]?0x1:_0x64e29b[_0x7fc2d1(0x358)]<_0x5658d8[_0x7fc2d1(0x358)]?-0x1:0x0),_0x136af8['length']>maxBackups&&fs[_0x7fc2d1(0x1ef)](configbackuppath+_0x136af8[_0x136af8[_0x7fc2d1(0x335)]-0x1][_0x7fc2d1(0x358)]);}function rotateLogFiles(){const _0x2f39c0=_0x2f8265,_0x416403=fs[_0x2f39c0(0x344)](logspath+'output-000.log'),_0x41076c=_0x416403[_0x2f39c0(0x343)]/0x400;if(_0x41076c>0x64){let _0x183395=fs[_0x2f39c0(0x1e8)](logspath,{'withFileTypes':!![]});_0x183395[_0x2f39c0(0x27b)]((_0xfcf92d,_0xef3275)=>_0xfcf92d[_0x2f39c0(0x358)]<_0xef3275[_0x2f39c0(0x358)]?0x1:_0xef3275['name']<_0xfcf92d['name']?-0x1:0x0),_0x183395[_0x2f39c0(0x214)](_0x1e0aeb=>{const _0x47f4ad=_0x2f39c0;if(_0x1e0aeb['name']==_0x47f4ad(0x22f))fs[_0x47f4ad(0x1c1)](logspath+_0x1e0aeb[_0x47f4ad(0x358)],logspath+_0x47f4ad(0x271));if(_0x1e0aeb[_0x47f4ad(0x358)]==_0x47f4ad(0x215))fs[_0x47f4ad(0x1c1)](logspath+_0x1e0aeb['name'],logspath+_0x47f4ad(0x22f));_0x1e0aeb[_0x47f4ad(0x358)]=='output-000.log'&&(fs[_0x47f4ad(0x1c1)](logspath+_0x1e0aeb[_0x47f4ad(0x358)],logspath+_0x47f4ad(0x215)),fs[_0x47f4ad(0x293)](logspath+_0x1e0aeb[_0x47f4ad(0x358)],''));});}}function _0x4582(){const _0x32140f=['then','file','logged\x20out','date-fns','NTBA_FIX_319','names','build','output-002.log','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','getFullYear','/off\x20-\x20stop\x20bot(s)\x0a','botmanager','Invalid\x20authentication\x20token\x20(1)','temporary\x20access\x20not\x20allowed','privateKey','editMessageReplyMarkup','button','text','get-messages','store','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20show\x20configuration','2FA\x20login\x20rejected','portfolio','username','notification','token','Backup\x20file\x20uploaded','\x20mode','emitHistory','getSeconds','secure','Unauthorized\x20attempt\x20to\x20delete\x20bot','telegramIpApproval','restore-backup-file','/metrics\x20-\x20show\x20bot\x20performance\x0a','build2','bot-','Login\x20accepted',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','sendMessage','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','padStart','sha256','search','telegramEnabled','listen','password','Login\x20rejected','track','Bot\x20Mgr\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Unauthorized\x20attempt\x20to\x20log\x20out','defaults','Orders','(((.+)+)+)+$','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','post','add-bot','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','settings','Ok,\x20will\x20send\x20order\x20notifications\x20only','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','version','Password\x20has\x20been\x20reset\x20to:\x20','auth','start','Setting\x20access:\x20','toggle','tempaccess_15','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','reply','reload','output-003.log','config_alerts','warning','update_no','all','*$1*','513czbSDR','::ffff:127.0.0.1','started','loginRequired','sort','=>\x20Go\x20to\x20#CYA#http://','family','Network\x20Interfaces:','running','\x1b[35m','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','string','toIPv4Address','store-headless','apiKey','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','538staFhd','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','isDirectory','auto','lastmsgemitted','request','initclient','secret','zip/','Invalid\x20username\x20or\x20IP\x20address','catch','enable','writeFileSync','find','\x20only\x0a','login2fa_reject','fork','mkdirSync','data','login\x20not\x20required','login\x20token\x20generated','connection','lastmsgtelegram','debug','alias','clientip','-----------------------------------------------------------------------------------','config/','hashSync','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','#RES#\x20if\x20running\x20on\x20server','command','download','init','20fztnFv','reason','host','Telegraf\x20error:','any','backup-full.zip','conn','emit','join','<b>Balance\x20Bot\x20Status:</b>\x0a','show','test','set','axios','Access\x20enabled\x20for\x20','update','2FA\x20login\x20token\x20generated','version.json','userid','Alerts','reject','compareSync','readFileSync','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','exit','$1_$2_$3','telegram','chat','login','DEFLATE','/:bot/history','storeFiat','getMonth','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','getPortfolio','bot','Notifications\x20disabled','backup/','-config.json','bot.js','sendFile','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','HTML','30OMtYMD','endsWith','success','private','(staging)','status','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Unauthorized\x20attempt\x20to\x20update\x20settings',')\x20\x20\x20|\x20Bot\x20','isValid','store-configuration','************','1000','send','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bbUsername','reinstall-bb','access','_data','getHours','127.0.0.1','timeshift','SIGTERM','isIPv4MappedAddress','telegramToken','backup-full','remoteAddress','action','Restore\x20process\x20aborted','temporary\x20token\x20generated','backup-files','tempaccess_5','confirm-message','api-eu.mixpanel.com','telegrammsg','tempaccess_30','createWriteStream','All\x20bots\x20running\x20right\x20now','range','argv','constructor','user','new-disabled','Password\x20reset\x20rejected','value','enabled','showConfig','static','store-fiat','/on\x20-\x20start\x20bot(s)\x0a','/:bot/performance','allow','30002Avpigj','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','https://api.ipify.org?format=json','node','path','backup','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','help','/disable\x20-\x20disable\x20notifications\x0a','filter','env','get-starting-balances','3000','Error:\x20Invalid\x20argument\x20','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','0.0.0','botname','lowdb','\x1b[0m','update_yes','login2fa_','/update\x20-\x20update\x20Balance\x20Bot\x0a','mixpanel','uncaughtException','Node.js\x20v','temporaryAccessAllowed','stop','resetHistory','IPv4','Your\x20installation\x20is\x20already\x20up\x20to\x20date','uuid','ipaddr.js','encryptedUuid','.zip','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','max','358518HcwXpR','express-fileupload','replace','number','headers','binary','::1','staging','messages','length','Starting\x20(','bbvNew','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','socket','update-bot','/upload-backup','storeConfiguration','All\x20bots','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','onepagemode','metrics','182AsQcBj','Unauthorized\x20attempt\x20to\x20confirm\x20message','size','statSync','write','portfolio_','RSA-OAEP','blacklist','live','Error\x20while\x20deleting\x20config\x20files:\x20',',\x20must\x20be\x20a\x204\x20digit\x20number','full','accept','telegramEvents','hybrid-crypto-js','parse','randomFillSync','kill','#RES#\x20','args','place-order','-performance.json','ipc','name','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','files','connected','toggle-bot-mode','bcryptjs','getMinutes','exchange','telegramUsername','/status\x20-\x20show\x20bot(s)\x20status\x0a','headless','params','assign','botID','keys','title','environment','manual','2FA\x20required','Unauthorized\x20attempt\x20to\x20update\x20bot','\x20minutes','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','-results.json','from','logs/','Notifications\x20types:\x20','crypto','Notifications\x20enabled','\x20|\x20','Session\x20expired\x20for\x20user\x20...','uuid-random','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','<b>Telegram\x20Bot\x20Status:</b>\x0a','tkn','Starting\x20Balance\x20Bot\x20update','bots','startsWith','\x20(1)','tempaccess_reject','-events.json','2FA\x20login\x20required','access\x20timeout','settings.','existsSync','Temporary\x20access\x20rejected','stringify','timestamp','Bot\x20','format','Backup\x20file\x20unzipped\x20and\x20stored','address','Invalid\x20IP\x20address','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','invalid\x20credentials','backup-full@','Starting\x20#RED#Balance\x20Bot\x20v','Markdown','http','login\x20required','logs','/enable\x20-\x20enable\x20notifications\x0a','remove','31736WRnRTu','createServer','internal','storeHeadless','6b67f3d61ee94b8f5c80b4affef4c4d9','new','store-settings','getDate','SIGINT','socket.io','/:bot/coins','cloneDeep','sign','Yes','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','/start','restart','temporary\x20access\x20timeout','sendPortfolioTelegram','RSA','Unauthorized\x20attempt\x20to\x20get\x20messages','Restore\x20backup\x20file\x20','off','verify','latestversion','on_','disconnect','telegramChatId','config_orders','delete-alerts','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','rmSync','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','reinstall','map','hex','Failed\x20to\x20download\x20','clients','use','express','off_','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Starting\x20Balance\x20Bot\x20reinstallation','30\x20min','Allow\x20login\x20from\x20IP\x20address\x20','bbvReceive','sendMetricsTelegram','handshake','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','resetpw_no','inherit','\x20(2)','reinstall_yes','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','All','sortBy','Notifications\x20disabled\x0a','reinstall_no','exec','jsonwebtoken','copyFileSync','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','expiry','\x20|\x20user:\x20...','sockets','simple','apiSecret','launch','once','17508TKnuKR','yes','apply','type','/:bot/portfolio','slice','Restoring\x20bot(s)\x20from\x20backup','inlineKeyboard','server','stopped','config_all','index.html','866734wrkgeF','get-portfolio','Unauthorized\x20attempt\x20to\x20download\x20','log','bb-secure.json','182136qMsFfQ','telegram2FaApproval','Logged\x20out\x20user\x20...',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','/output-000.log','***','No\x20bots\x20running\x20right\x20now','getTime','cancel-loading','getStartingBalances','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','mtime','match','readdirSync','restore_yes','updatebotmanager','ipv6','kind','Crypt','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','unlinkSync','Unauthorized\x20login\x20attempt\x20(timeout)','callback','error','/:bot/configuration','event','push','pidRefreshToken','Restore\x20process\x20confirmed','\x20|\x20client:\x20...','get','hasOwnProperty','Starting\x20new\x20bot\x20|\x20Bot\x20','toString','telegraf','exp','randomBytes','Idling\x20(','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','User\x20has\x20been\x20validated','90ihomXc','/help\x20-\x20show\x20available\x20commands\x0a','update-bb','45xmYghV','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','apiPassword','\x1b[33m','\x20>\x20','message','disabled','temp/','publicKey','f2aRequired','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','restart_','pidExpireLogin','removeAllListeners','forEach','output-001.log',')\x20|\x20Bot\x20','mode','toIPv4MappedAddress','decrypt','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','logout','alerts','[ip-address]','orders','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','bbPassword','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','node-zip','min','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','split','/:bot/support','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'];_0x4582=function(){return _0x32140f;};return _0x4582();}async function zipFiles(_0x432867){const _0x245d64=_0x2f8265;let _0x209624;if(_0x432867==_0x245d64(0x180))_0x209624=logspath;if(_0x432867==_0x245d64(0x30d))_0x209624=configpath;if(_0x432867==_0x245d64(0x2ed))_0x209624=configpath;let _0x407ddc=fs[_0x245d64(0x1e8)](_0x209624,{'withFileTypes':!![]});const _0xcf6334=new require(_0x245d64(0x222))();_0x407ddc[_0x245d64(0x214)](_0x53dead=>{const _0x53dd74=_0x245d64;if(!_0x53dead[_0x53dd74(0x289)]()){let _0x4e5563=fs[_0x53dd74(0x2bf)](_0x209624+_0x53dead[_0x53dd74(0x358)]);if(_0x432867==_0x53dd74(0x30d)){const _0x36eae3=/^bot-[0-9]{3}-config.json$/,_0xd4b675=_0x36eae3[_0x53dd74(0x2b4)](_0x53dead[_0x53dd74(0x358)]);if(_0xd4b675){const _0x37b501=JSON[_0x53dd74(0x350)](_0x4e5563);if(_0x37b501['bot'][0x0]){_0x37b501[_0x53dd74(0x2cc)][0x0][_0x53dd74(0x285)]=_0x53dd74(0x1e0),_0x37b501[_0x53dd74(0x2cc)][0x0][_0x53dd74(0x1c7)]='***';if(_0x37b501[_0x53dd74(0x2cc)][0x0][_0x53dd74(0x208)])_0x37b501[_0x53dd74(0x2cc)][0x0][_0x53dd74(0x208)]=_0x53dd74(0x1e0);}_0x4e5563=JSON[_0x53dd74(0x172)](_0x37b501,null,0x2);}if(_0x53dead['name']=='bb-settings.json'){const _0x3a32ce=JSON['parse'](_0x4e5563);if(_0x3a32ce['settings'][_0x53dd74(0x27a)])_0x3a32ce[_0x53dd74(0x264)][_0x53dd74(0x27a)]=![];if(_0x3a32ce[_0x53dd74(0x264)]['bbPassword'])_0x3a32ce[_0x53dd74(0x264)][_0x53dd74(0x220)]=_0x53dd74(0x1e0);if(_0x3a32ce['settings'][_0x53dd74(0x2ec)])_0x3a32ce['settings'][_0x53dd74(0x2ec)]=_0x53dd74(0x1e0);if(_0x3a32ce[_0x53dd74(0x264)][_0x53dd74(0x19e)])_0x3a32ce['settings'][_0x53dd74(0x19e)]=null;_0x4e5563=JSON[_0x53dd74(0x172)](_0x3a32ce,null,0x2);}if(_0x53dead[_0x53dd74(0x358)]!=_0x53dd74(0x1da))_0xcf6334[_0x53dd74(0x229)](_0x53dead[_0x53dd74(0x358)],_0x4e5563);}else _0xcf6334[_0x53dd74(0x229)](_0x53dead[_0x53dd74(0x358)],_0x4e5563);}});const _0x138254=_0xcf6334['generate']({'base64':![],'compression':_0x245d64(0x2c6)});fs[_0x245d64(0x293)](zippath+(_0x432867+_0x245d64(0x329)),_0x138254,_0x245d64(0x331));}async function unzipFile(_0x42db7a,_0x5b246e){const _0x5cb440=_0x2f8265;fs[_0x5cb440(0x1e8)](configpath,{'withFileTypes':!![]})[_0x5cb440(0x214)](_0x18084a=>{const _0x1dd0c=_0x5cb440;if(!_0x18084a['isDirectory']())fs['rmSync'](configpath+_0x18084a[_0x1dd0c(0x358)]);});const _0x2b3645=fs[_0x5cb440(0x2bf)](_0x42db7a+_0x5b246e,_0x5cb440(0x331)),_0x184164=new require('node-zip')(_0x2b3645,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x184164[_0x5cb440(0x146)])['forEach'](_0x29c68d=>{const _0x1b9020=_0x5cb440,_0x57b622=_0x184164[_0x1b9020(0x146)][_0x29c68d];fs[_0x1b9020(0x293)](configpath+_0x57b622[_0x1b9020(0x358)],_0x57b622[_0x1b9020(0x2e6)]);}),fs[_0x5cb440(0x1e8)](temppath,{'withFileTypes':!![]})[_0x5cb440(0x214)](_0x4cd84a=>{const _0x10f811=_0x5cb440;if(!_0x4cd84a['isDirectory']())fs[_0x10f811(0x1a2)](temppath+_0x4cd84a[_0x10f811(0x358)]);}),logger[_0x5cb440(0x29e)](_0x5cb440(0x176)),process['send']({'restore':!![]},_0x35bd82=>{});}async function getPublicIp(){const _0x298b52=_0x2f8265;try{const _0x4dcbc7=await axios[_0x298b52(0x1f9)](_0x298b52(0x30a));publicip=_0x4dcbc7[_0x298b52(0x299)]['ip'];}catch(_0x50ad85){}}async function triggerAnalytics(){const _0x44d54a=_0x2f8265;if(!publicip)await getPublicIp();const _0x3e2f07=getBotsWithMode();let _0x565abd=0x0;_0x3e2f07[_0x44d54a(0x214)](_0x30aaf5=>{const _0x2baeae=_0x44d54a;if(_0x30aaf5[_0x2baeae(0x2d9)]===_0x2baeae(0x301))_0x565abd++;});const _0xcdabe=getBotExchanges();mixpanel[_0x44d54a(0x259)]('Server',{'distinct_id':settings[_0x44d54a(0x2bb)],'ip':publicip,'version':serverversion,'numbots':_0x3e2f07[_0x44d54a(0x335)],'numbotsenabled':_0x565abd,'exchanges':_0xcdabe,'environment':environment});}async function getMessages(){const _0x3f6e57=_0x2f8265,_0x1d41b0=_0x3f6e57(0x221),_0x2c7bd9=new GraphQLClient(_0x1d41b0),_0x47cb16={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5d8ca7=serverversion[_0x3f6e57(0x225)]('.'),_0xa08157=_0x5d8ca7[0x0]+'.'+_0x5d8ca7[0x1],_0x1a058a=Math[_0x3f6e57(0x223)](settings['lastmsgtelegram'],settings[_0x3f6e57(0x28b)]),_0x7938a2={'last':parseInt(_0x1a058a),'bbm':_0xa08157},_0x49dd32=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xe4ca55;try{_0xe4ca55=await _0x2c7bd9[_0x3f6e57(0x28c)](_0x49dd32,_0x7938a2,_0x47cb16);}catch(_0x564b83){}if(_0xe4ca55&&_0xe4ca55[_0x3f6e57(0x334)]){let _0x58398c=settings['lastmsgtelegram'];newMessages=[];for(const _0x5a5f2f of _0xe4ca55[_0x3f6e57(0x334)]){newMessages[_0x3f6e57(0x1f5)](_0x5a5f2f);let _0x546454=![];_0x5a5f2f[_0x3f6e57(0x337)]&&(updateSetting(_0x3f6e57(0x19b),_0x5a5f2f[_0x3f6e57(0x337)]),_0x546454=isNewerVersion(serverversion,_0x5a5f2f['bbvNew'])||serverversion==_0x5a5f2f[_0x3f6e57(0x337)]);if(!_0x546454&&_0x5a5f2f['number']>_0x58398c){if(_0x5a5f2f['bbvReceive']===_0x3f6e57(0x2ad)||serverversion[_0x3f6e57(0x169)](_0x5a5f2f[_0x3f6e57(0x1b2)])){let _0x5ac6f9=''+_0x5a5f2f[_0x3f6e57(0x153)]+'\x0a\x0a'+_0x5a5f2f[_0x3f6e57(0x20b)];const _0x35693d=await sendTelegramMsg(toTelegramMarkdown(_0x5ac6f9),_0x3f6e57(0x17d));if(_0x35693d)_0x58398c=_0x5a5f2f[_0x3f6e57(0x32f)];}}}updateAvailable=isNewerVersion(settings[_0x3f6e57(0x19b)],serverversion),updateSetting('lastmsgtelegram',_0x58398c),emitMessages();}}function emitMessages(){const _0x2b478c=_0x2f8265,_0x3cea05=settings[_0x2b478c(0x28b)];let _0x3725b9=[];newMessages[_0x2b478c(0x214)](_0x1d690e=>{const _0x47132e=_0x2b478c;_0x1d690e['number']>_0x3cea05&&_0x3725b9[_0x47132e(0x1f5)](_0x1d690e);}),_0x3725b9[_0x2b478c(0x335)]>0x0&&getAllClients()['forEach'](_0x17d8ec=>{const _0x3f8279=_0x2b478c;getSocket(_0x17d8ec['id'])[_0x3f8279(0x2b0)](_0x3f8279(0x20b),_0x3725b9);});}function confirmMessage(_0x5b5468){updateSetting('lastmsgemitted',Number(_0x5b5468));}function isNewerVersion(_0x37fde0,_0x1f3096){const _0x1e9107=_0x2f8265,_0x52a4e9=_0x1f3096[_0x1e9107(0x225)]('.'),_0x27c257=_0x37fde0['split']('.');for(var _0xd14c0e=0x0;_0xd14c0e<_0x27c257[_0x1e9107(0x335)];_0xd14c0e++){const _0x135f99=~~_0x27c257[_0xd14c0e],_0xe9c947=~~_0x52a4e9[_0xd14c0e];if(_0x135f99>_0xe9c947)return!![];if(_0x135f99<_0xe9c947)return![];}return![];}function toTelegramMarkdown(_0x10fc2f){const _0xec51c=_0x2f8265,_0xfa5210=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1b0e0c=/\*{2}(.+?)\*{2}/gim;return _0x10fc2f=_0x10fc2f[_0xec51c(0x32e)](_0xfa5210,_0xec51c(0x2c2))[_0xec51c(0x32e)](_0x1b0e0c,_0xec51c(0x276)),_0x10fc2f;}async function validateConfigFile(){const _0x20ad78=_0x2f8265,_0x34b426=dbConfig['get'](_0x20ad78(0x168))[_0x20ad78(0x1bc)]('botID')[_0x20ad78(0x300)]()||[];if(_0x34b426[_0x20ad78(0x335)]==0x0){let _0x57967a=0x0,_0x56f8ea=[];const _0x492d14=/^bot-([0-9]{3})-config.json$/,_0x143dd2=fs[_0x20ad78(0x1e8)](configpath);_0x143dd2['forEach'](_0x2d5c0f=>{const _0x331504=_0x20ad78,_0x386cf9=_0x492d14[_0x331504(0x1bf)](_0x2d5c0f);if(_0x386cf9){const _0x5c5c67=_0x386cf9[0x1];let _0x57d47c=getBotAttributes(_0x5c5c67);_0x56f8ea[_0x331504(0x1f5)]({'botID':_0x5c5c67,'botname':_0x57d47c['botname'],'status':_0x331504(0x20c),'live':_0x331504(0x1d3)}),_0x57967a++;}}),_0x57967a!=0x0&&(dbConfig[_0x20ad78(0x1f9)](_0x20ad78(0x168))['assign'](_0x56f8ea)['write'](),config=_0x56f8ea,restoredConfigFile=_0x57967a);}}async function restoreConfigNotify(_0x385bab){const _0x5d21ff=_0x2f8265;let _0x5235ec;if(restoredConfigFile==0x1)_0x5235ec=_0x5d21ff(0x1b5);else _0x5235ec=_0x5d21ff(0x21a);if(_0x385bab)io['to'](_0x5d21ff(0x233))[_0x5d21ff(0x2b0)](_0x5d21ff(0x241),_0x5235ec);else{logger[_0x5d21ff(0x1c6)](_0x5d21ff(0x2a1)),logger[_0x5d21ff(0x1c6)](_0x5235ec),logger[_0x5d21ff(0x1c6)](_0x5d21ff(0x2a1)),logger[_0x5d21ff(0x1c6)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x5d21ff(0x34e)]!=_0x5d21ff(0x21e))await sendTelegram(settings[_0x5d21ff(0x19e)],_0x5d21ff(0x25a)+_0x5235ec);}}function validateCredentials(_0x1cd872,_0x5f8380){const _0x521273=_0x2f8265;if(_0x1cd872[_0x521273(0x240)]==settings[_0x521273(0x2e3)]&&bcrypt[_0x521273(0x2be)](_0x1cd872[_0x521273(0x257)],settings[_0x521273(0x220)])){if(settings[_0x521273(0x20f)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x1531cd=generateLoginToken(_0x5f8380);return{'allow':!![],'reason':_0x521273(0x29b),'token':_0x1531cd};}}else return{'allow':![],'reason':_0x521273(0x17a),'token':null};}function refreshToken(_0xf3afe3){const _0x50ec6b=generateLoginToken(_0xf3afe3);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x50ec6b};}function validateAccess(_0x22ff33,_0x18b912,_0x2fbb83){const _0x3d559e=_0x2f8265,_0x5d8b86=_0x2fbb83?_0x2fbb83:devices[_0x18b912]['ip'];let _0xc0615;const _0x138801=_0x39b012=>{const _0x4fdd72=_0x70e7;if(settings[_0x4fdd72(0x27a)]){if(settings[_0x4fdd72(0x20f)]){if(telegram2FaApproved(_0x18b912)){const _0x2b559f=generateLoginToken(_0x18b912);return{'allow':!![],'reason':_0x4fdd72(0x2b9),'token':_0x2b559f};}else return{'allow':![],'reason':_0x4fdd72(0x17f),'token':null};}else return _0xc0615=validToken(_0x39b012,_0x18b912),_0xc0615[_0x4fdd72(0x1fa)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x39b012}:{'allow':![],'reason':_0x4fdd72(0x17f),'token':null};}else return{'allow':!![],'reason':_0x4fdd72(0x29a),'token':null};};if(settings['whitelistEnabled']){let _0x56834e=[...settings['whitelist'],_0x3d559e(0x332),_0x3d559e(0x278),_0x3d559e(0x2e8)];if(_0x56834e['includes'](_0x5d8b86))return _0x138801(_0x22ff33);else{_0xc0615=validToken(_0x22ff33,_0x18b912);if(_0xc0615['hasOwnProperty'](_0x3d559e(0x2d6)))return _0x138801(_0x22ff33);else{if(telegramIpApproved(_0x18b912)){const _0x3dda7c=generateToken(_0x18b912);return _0xc0615=_0x138801(_0x22ff33),_0xc0615[_0x3d559e(0x307)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3dda7c}:_0xc0615;}else return settings[_0x3d559e(0x321)]?{'allow':![],'reason':_0x3d559e(0x156),'token':null}:{'allow':![],'reason':_0x3d559e(0x235),'token':null};}}}else return _0x138801(_0x22ff33);}function timelyDecrypt(_0x8dc86a,_0x50742a=!![]){const _0x3bdc28=_0x2f8265;if(_0x8dc86a)try{const _0x26940a=crypt[_0x3bdc28(0x219)](secure[_0x3bdc28(0x236)],_0x8dc86a)['message'],_0x2b871f=_0x26940a[_0x3bdc28(0x225)]('@')[0x0],_0x3e294e=_0x26940a['split']('@')[0x1],_0x165a1c=new Date()[_0x3bdc28(0x1e2)]();if(_0x50742a){if(_0x165a1c-_0x3e294e<maxSecretAge*0x3e8)return _0x2b871f;else return![];}else return _0x2b871f;}catch(_0x5d6c6c){return![];}else return![];}const validToken=(_0x263496,_0x26c378)=>{const _0x456190=_0x2f8265,_0x5e9e56=devices[_0x26c378]['ip'];if(!_0x263496)return{'error':'No\x20authentication\x20token'};for(let _0x217ba7 of blacklist){if(_0x217ba7['token']==_0x263496)return{'error':'Token\x20blacklisted'};}let _0x11f52e;try{_0x11f52e=jwt[_0x456190(0x19a)](_0x263496,secure[_0x456190(0x28e)]+_0x26c378);}catch{return{'error':_0x456190(0x234)};}if(!_0x11f52e[_0x456190(0x1fa)](_0x456190(0x2a0))&&!_0x11f52e[_0x456190(0x1fa)](_0x456190(0x240))||!_0x11f52e[_0x456190(0x1fa)](_0x456190(0x1fe)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x11f52e[_0x456190(0x1fa)](_0x456190(0x240))&&_0x11f52e[_0x456190(0x1fa)](_0x456190(0x2a0))){const {clientip:_0x32b91b}=_0x11f52e;return _0x5e9e56==_0x32b91b?{'success':_0x456190(0x202)}:{'error':_0x456190(0x178)};}else{if(_0x11f52e[_0x456190(0x1fa)](_0x456190(0x240))&&_0x11f52e['hasOwnProperty'](_0x456190(0x2a0))){const {username:_0x288419,clientip:_0x50f76d}=_0x11f52e;return settings[_0x456190(0x2e3)]==_0x288419&&_0x5e9e56==_0x50f76d?{'success':_0x456190(0x202)}:{'error':_0x456190(0x290)};}}},generateLoginToken=_0x313d18=>{const _0xac3f04=_0x2f8265;if(_0x313d18){const _0x3d944a=devices[_0x313d18]['ip'];return jwt['sign']({'username':settings[_0xac3f04(0x2e3)],'clientip':_0x3d944a},secure[_0xac3f04(0x28e)]+_0x313d18,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x40ff5d=>{const _0x1d81e4=_0x2f8265;if(_0x40ff5d){const _0x4ba2a4=devices[_0x40ff5d]['ip'];return jwt[_0x1d81e4(0x18f)]({'clientip':_0x4ba2a4},secure[_0x1d81e4(0x28e)]+_0x40ff5d,{'expiresIn':devices[_0x40ff5d][_0x1d81e4(0x249)][_0x1d81e4(0x1c3)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x2c2001=>{const _0x5140ac=_0x2f8265;let _0x57da09=![];return devices[_0x2c2001][_0x5140ac(0x249)]&&devices[_0x2c2001]['telegramIpApproval'][_0x5140ac(0x1c3)]!=_0x5140ac(0x2bd)&&(_0x57da09=devices[_0x2c2001][_0x5140ac(0x249)][_0x5140ac(0x2a0)]==devices[_0x2c2001]['ip']&&new Date()[_0x5140ac(0x1e2)]()-devices[_0x2c2001][_0x5140ac(0x249)][_0x5140ac(0x173)]<devices[_0x2c2001][_0x5140ac(0x249)][_0x5140ac(0x1c3)]*0x3c*0x3e8),_0x57da09;},telegram2FaApproved=_0x4a0cc9=>{const _0x3f8c6d=_0x2f8265;let _0x342ace=![];return devices[_0x4a0cc9][_0x3f8c6d(0x1dc)]&&devices[_0x4a0cc9][_0x3f8c6d(0x1dc)]['expiry']!='reject'&&(_0x342ace=devices[_0x4a0cc9][_0x3f8c6d(0x1dc)][_0x3f8c6d(0x2a0)]==devices[_0x4a0cc9]['ip']&&new Date()['getTime']()-devices[_0x4a0cc9][_0x3f8c6d(0x1dc)][_0x3f8c6d(0x173)]<devices[_0x4a0cc9]['telegram2FaApproval'][_0x3f8c6d(0x1c3)]*0x3c*0x3e8),_0x342ace;},normalizeIP=_0x3e4976=>{const _0x28ea6d=_0x2f8265;let _0x510ab5=null,_0x19aad8=null;if(ipaddr[_0x28ea6d(0x2dd)](_0x3e4976)){const _0x1ba078=ipaddr[_0x28ea6d(0x350)](_0x3e4976);_0x1ba078[_0x28ea6d(0x1ec)]()===_0x28ea6d(0x1eb)?(_0x1ba078[_0x28ea6d(0x2eb)]()&&(_0x510ab5=_0x1ba078[_0x28ea6d(0x283)]()[_0x28ea6d(0x1fc)]()),_0x19aad8=_0x1ba078[_0x28ea6d(0x1fc)]()):(_0x510ab5=_0x1ba078[_0x28ea6d(0x1fc)](),_0x19aad8=_0x1ba078[_0x28ea6d(0x218)]()['toString']());}return{'show':_0x510ab5?_0x510ab5:_0x19aad8,'store':_0x19aad8};};function formatDate(_0x5c2443){const _0x333396=_0x2f8265;return _0x5c2443[_0x333396(0x231)]()+'/'+(_0x5c2443['getMonth']()+0x1)[_0x333396(0x1fc)]()['padStart'](0x2,'0')+'/'+_0x5c2443[_0x333396(0x18a)]()[_0x333396(0x1fc)]()[_0x333396(0x252)](0x2,'0')+'\x20'+_0x5c2443['getHours']()[_0x333396(0x1fc)]()[_0x333396(0x252)](0x2,'0')+':'+_0x5c2443[_0x333396(0x14a)]()[_0x333396(0x1fc)]()[_0x333396(0x252)](0x2,'0')+':'+_0x5c2443['getSeconds']()[_0x333396(0x1fc)]()['padStart'](0x2,'0');}function sleep(_0x3b671d){return new Promise(_0x13cea7=>setTimeout(_0x13cea7,_0x3b671d));}