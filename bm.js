const _0x31a8d6=_0x4a9b;(function(_0xcf76,_0x311dba){const _0x2bde40=_0x4a9b,_0x21b212=_0xcf76();while(!![]){try{const _0x3145e7=-parseInt(_0x2bde40(0x349))/0x1+parseInt(_0x2bde40(0x31d))/0x2+parseInt(_0x2bde40(0x31b))/0x3*(parseInt(_0x2bde40(0x35a))/0x4)+-parseInt(_0x2bde40(0x205))/0x5+-parseInt(_0x2bde40(0x1c3))/0x6+-parseInt(_0x2bde40(0x354))/0x7*(-parseInt(_0x2bde40(0x2e9))/0x8)+-parseInt(_0x2bde40(0x1e3))/0x9*(-parseInt(_0x2bde40(0x1c7))/0xa);if(_0x3145e7===_0x311dba)break;else _0x21b212['push'](_0x21b212['shift']());}catch(_0x2d45bc){_0x21b212['push'](_0x21b212['shift']());}}}(_0x1deb,0x9afcc));const _0x8dca57=function(){let _0x2b5632=!![];return function(_0x571c37,_0x54b53e){const _0x4a0ef8=_0x2b5632?function(){if(_0x54b53e){const _0x5b9ecd=_0x54b53e['apply'](_0x571c37,arguments);return _0x54b53e=null,_0x5b9ecd;}}:function(){};return _0x2b5632=![],_0x4a0ef8;};}(),_0x1eff5c=_0x8dca57(this,function(){const _0x5a41f2=_0x4a9b;return _0x1eff5c[_0x5a41f2(0x317)]()['search']('(((.+)+)+)+$')[_0x5a41f2(0x317)]()['constructor'](_0x1eff5c)[_0x5a41f2(0x1d4)](_0x5a41f2(0x2cc));});_0x1eff5c();'use strict';process[_0x31a8d6(0x22e)][_0x31a8d6(0x215)]=0x1;const childProcess=require(_0x31a8d6(0x336)),fs=require('fs'),fns=require(_0x31a8d6(0x2aa)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x31a8d6(0x25b)),crypto=require(_0x31a8d6(0x270)),Crypt=require(_0x31a8d6(0x2ff))[_0x31a8d6(0x21b)],RSA=require(_0x31a8d6(0x2ff))[_0x31a8d6(0x308)],bcrypt=require('bcryptjs'),jwt=require(_0x31a8d6(0x366)),ipaddr=require(_0x31a8d6(0x324)),argv=require(_0x31a8d6(0x1d8))(process[_0x31a8d6(0x257)][_0x31a8d6(0x1cf)](0x2))[_0x31a8d6(0x257)],uuidRandom=require(_0x31a8d6(0x2fe)),TelegramBot=require(_0x31a8d6(0x314)),Mixpanel=require(_0x31a8d6(0x2a5)),axios=require(_0x31a8d6(0x328)),{GraphQLClient,gql}=require(_0x31a8d6(0x1fb)),util=require('util'),fileUpload=require(_0x31a8d6(0x282)),PORT=argv['port']||_0x31a8d6(0x242),pattern=/^[0-9]{2,4}$/;!pattern[_0x31a8d6(0x276)](PORT)&&(console[_0x31a8d6(0x34c)](_0x31a8d6(0x1e0)+PORT+_0x31a8d6(0x27f)),process[_0x31a8d6(0x264)](0x1));const HOST=argv[_0x31a8d6(0x2f6)]||null,userID=argv['user']||'',debugging=argv['d']||![];let bbpath=_0x31a8d6(0x1b6),bbpath2='';const botfile=_0x31a8d6(0x223),configfile='bb-config.json',settingsfile=_0x31a8d6(0x1e2),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x31a8d6(0x1af)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x31a8d6(0x344)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x31a8d6(0x236),configbackuppath=configpath+_0x31a8d6(0x331),logspath=userID?bbpath+_0x31a8d6(0x367)+userID+'/':bbpath+_0x31a8d6(0x367),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x31a8d6(0x1ed),loggerfile=fs[_0x31a8d6(0x2c4)](logspath+_0x31a8d6(0x2ba),{'flags':'a'}),temppath=userID?bbpath+_0x31a8d6(0x1b0)+userID+'/':bbpath+'temp/';!fs[_0x31a8d6(0x1af)](configpath)&&fs[_0x31a8d6(0x2dd)](configpath);!fs[_0x31a8d6(0x1af)](configbackuppath)&&fs[_0x31a8d6(0x2dd)](configbackuppath);!fs[_0x31a8d6(0x1af)](logspath)&&fs[_0x31a8d6(0x2dd)](logspath);!fs[_0x31a8d6(0x1af)](zippath)&&fs[_0x31a8d6(0x2dd)](zippath);!fs[_0x31a8d6(0x1af)](temppath)&&fs[_0x31a8d6(0x2dd)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x31a8d6(0x302)}})[_0x31a8d6(0x31f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x31a8d6(0x1ea)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x31a8d6(0x219),'rsaStandard':_0x31a8d6(0x2a4)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x31a8d6(0x21d),{'host':_0x31a8d6(0x33c)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x31a8d6(0x21a)]&&settings[_0x31a8d6(0x21a)]!=''&&settings[_0x31a8d6(0x30d)]&&settings[_0x31a8d6(0x30d)]!='')initTelegram();const logger={'screen':_0x4f7d86=>{const _0x50d032=_0x31a8d6;console[_0x50d032(0x34c)](_0x4f7d86);},'simple':_0x38e62e=>{const _0x4b85ea=_0x31a8d6;console[_0x4b85ea(0x34c)](_0x38e62e),loggerfile[_0x4b85ea(0x31f)](util[_0x4b85ea(0x1d1)](_0x38e62e)+'\x0a');},'full':async _0x4f3ade=>{const _0x2a688d=_0x31a8d6,_0x58303b=getTimeStamp()+_0x2a688d(0x1be)+_0x4f3ade;console[_0x2a688d(0x34c)](_0x58303b),loggerfile[_0x2a688d(0x31f)](util['format'](_0x58303b)+'\x0a');if(tgBot&&settings[_0x2a688d(0x335)]&&settings[_0x2a688d(0x348)]!=_0x2a688d(0x34b))await tgBot[_0x2a688d(0x1f4)](settings[_0x2a688d(0x335)],_0x2a688d(0x2bd)+_0x4f3ade)[_0x2a688d(0x304)](_0x5bae78=>{telegramError(_0x5bae78);});},'debug':async(_0x30b55d,_0x414f74='')=>{const _0x5e6b26=_0x31a8d6,_0x2bbddb=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x30b55d;if(debugging)console[_0x5e6b26(0x34c)](_0x2bbddb);loggerfile[_0x5e6b26(0x31f)](util['format'](_0x2bbddb)+'\x0a');if(_0x414f74){if(debugging)console[_0x5e6b26(0x34c)](_0x414f74);loggerfile[_0x5e6b26(0x31f)](util['format'](_0x414f74)+'\x0a');}}};process['on'](_0x31a8d6(0x1b8),function(_0x2c0102){const _0x483abb=_0x31a8d6;logger[_0x483abb(0x273)](_0x2c0102);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x31a8d6(0x1e9))[_0x31a8d6(0x35d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x31a8d6(0x221)),app=express(),http=require(_0x31a8d6(0x2ed))[_0x31a8d6(0x252)](app);app[_0x31a8d6(0x36d)](fileUpload({'useTempFiles':!![]})),app[_0x31a8d6(0x1f5)]('/download/:type',async(_0x48c7a9,_0x5b6bdc)=>{const _0x5ab2cb=_0x31a8d6,_0x21783e=_0x48c7a9[_0x5ab2cb(0x1d9)][_0x5ab2cb(0x201)],_0x3f3ab7=getClientsWithBotID(_0x5ab2cb(0x253)),_0x517501=_0x48c7a9[_0x5ab2cb(0x1e7)][_0x5ab2cb(0x1bc)],_0x397c02=timelyDecrypt(_0x517501,![]),_0x576a5f=_0x3f3ab7['find'](_0x20db3a=>_0x20db3a['uuid']==_0x397c02);if(_0x576a5f){const _0x76c93f=normalizeIP(_0x48c7a9[_0x5ab2cb(0x34e)][_0x5ab2cb(0x1f7)])[_0x5ab2cb(0x22c)],_0x7e7b9b=_0x48c7a9['headers']['tkn'];if(validateAccess(_0x7e7b9b,_0x397c02,_0x76c93f)[_0x5ab2cb(0x25e)])_0x21783e=='backup'&&await backupConfigFiles(),await zipFiles(_0x21783e),_0x5b6bdc['download'](zippath+(_0x21783e+_0x5ab2cb(0x363)),_0x3defc1=>{const _0x4c6385=_0x5ab2cb;_0x3defc1&&(logger[_0x4c6385(0x2d1)](_0x4c6385(0x279)+_0x21783e),logger[_0x4c6385(0x273)](_0x3defc1));});else logger[_0x5ab2cb(0x2d1)](_0x5ab2cb(0x33d)+_0x21783e+_0x5ab2cb(0x2d3));}else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x21783e+_0x5ab2cb(0x34a));}),app[_0x31a8d6(0x30b)](_0x31a8d6(0x220),async(_0x4fa7b5,_0x279b44)=>{const _0x90f1bb=_0x31a8d6,_0x49f124=getClientsWithBotID(_0x90f1bb(0x253)),_0x1304b3=_0x4fa7b5['headers']['uuid'],_0x328e7c=timelyDecrypt(_0x1304b3,![]),_0xad2e00=_0x49f124[_0x90f1bb(0x1c5)](_0x3f1a0a=>_0x3f1a0a[_0x90f1bb(0x1bc)]==_0x328e7c);logger[_0x90f1bb(0x214)]('Backup\x20file\x20uploaded');if(_0xad2e00){const _0x5f3ce4=normalizeIP(_0x4fa7b5['socket'][_0x90f1bb(0x1f7)])[_0x90f1bb(0x22c)],_0x59189d=_0x4fa7b5['headers'][_0x90f1bb(0x299)];if(validateAccess(_0x59189d,_0x328e7c,_0x5f3ce4)[_0x90f1bb(0x25e)]){if(_0x4fa7b5[_0x90f1bb(0x1dd)]){const _0xb65797=_0x4fa7b5[_0x90f1bb(0x1dd)]['backupfile'];await _0xb65797['mv'](temppath+_0xb65797['name']),_0x279b44['send']({'status':!![],'message':_0x90f1bb(0x2eb)});const _0x172968=getBotsWithMode();_0x172968[_0x90f1bb(0x350)]>0x0?confirmRestore(temppath,_0xb65797[_0x90f1bb(0x228)]):unzipFile(temppath,_0xb65797['name']);}}else logger[_0x90f1bb(0x2d1)](_0x90f1bb(0x2ac));}else logger[_0x90f1bb(0x2d1)](_0x90f1bb(0x320));}),app[_0x31a8d6(0x36d)](express['static'](path[_0x31a8d6(0x25a)](__dirname,bbpath2,_0x31a8d6(0x1ad)))),app[_0x31a8d6(0x36d)](express[_0x31a8d6(0x2a3)](path[_0x31a8d6(0x25a)](__dirname,bbpath2,_0x31a8d6(0x338)))),app[_0x31a8d6(0x1f5)]('/',function(_0x158a74,_0x3ff6e2){const _0x9d37ef=_0x31a8d6;_0x3ff6e2[_0x9d37ef(0x1ae)](path[_0x9d37ef(0x25a)](__dirname,bbpath2,_0x9d37ef(0x1ad),_0x9d37ef(0x1dc)));}),app[_0x31a8d6(0x1f5)](_0x31a8d6(0x2d2),function(_0x1a8c7b,_0xc6d85e){const _0x3f49a1=_0x31a8d6;_0xc6d85e[_0x3f49a1(0x1ae)](path[_0x3f49a1(0x25a)](__dirname,bbpath2,_0x3f49a1(0x338),_0x3f49a1(0x1dc)));}),app[_0x31a8d6(0x1f5)](_0x31a8d6(0x29c),(_0xcb524a,_0x480477)=>{const _0x665f53=_0x31a8d6;_0x480477['sendFile'](path[_0x665f53(0x25a)](__dirname,bbpath2,_0x665f53(0x338),_0x665f53(0x1dc)));}),app[_0x31a8d6(0x1f5)](_0x31a8d6(0x28e),(_0x59a5ff,_0x457cb8)=>{const _0x55f4af=_0x31a8d6;_0x457cb8[_0x55f4af(0x1ae)](path[_0x55f4af(0x25a)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x31a8d6(0x2b5),(_0x47b335,_0x523bd8)=>{const _0x2f5975=_0x31a8d6;_0x523bd8[_0x2f5975(0x1ae)](path[_0x2f5975(0x25a)](__dirname,bbpath2,_0x2f5975(0x338),_0x2f5975(0x1dc)));}),app[_0x31a8d6(0x1f5)](_0x31a8d6(0x27d),(_0x3e8f6e,_0x2aeb96)=>{const _0x4bee63=_0x31a8d6;_0x2aeb96[_0x4bee63(0x1ae)](path[_0x4bee63(0x25a)](__dirname,bbpath2,_0x4bee63(0x338),'index.html'));}),app[_0x31a8d6(0x1f5)](_0x31a8d6(0x230),(_0x155c35,_0x2157a7)=>{const _0x4fca6b=_0x31a8d6;_0x2157a7[_0x4fca6b(0x1ae)](path[_0x4fca6b(0x25a)](__dirname,bbpath2,_0x4fca6b(0x338),_0x4fca6b(0x1dc)));}),app[_0x31a8d6(0x1f5)](_0x31a8d6(0x34d),(_0x5b1156,_0x42dbee)=>{const _0x52a6e5=_0x31a8d6;_0x42dbee['sendFile'](path[_0x52a6e5(0x25a)](__dirname,bbpath2,_0x52a6e5(0x338),_0x52a6e5(0x1dc)));});if(HOST)http[_0x31a8d6(0x28f)](PORT,HOST);else http[_0x31a8d6(0x28f)](PORT);const io=require(_0x31a8d6(0x346))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x46caab=_0x31a8d6;logger[_0x46caab(0x273)](''),logger[_0x46caab(0x273)](_0x46caab(0x313)),await logger[_0x46caab(0x2d1)](_0x46caab(0x303)+PORT),logger[_0x46caab(0x273)]('-----------------------------------------------------------------------------------');if(config[_0x46caab(0x350)]!=0x0)for(const _0x2e50b of config){if(_0x2e50b['status']==_0x46caab(0x342)||_0x2e50b[_0x46caab(0x28c)]==_0x46caab(0x286))await logger['full'](_0x46caab(0x1bb)+_0x2e50b[_0x46caab(0x365)]+_0x46caab(0x2de)+_0x2e50b[_0x46caab(0x2b9)]),startBot([_0x2e50b[_0x46caab(0x365)],userID],{'cwd':bbpath},function(_0x3de59c){const _0x235fea=_0x46caab;if(_0x3de59c)logger[_0x235fea(0x2d1)](_0x3de59c);});else(_0x2e50b[_0x46caab(0x28c)]==_0x46caab(0x291)||_0x2e50b[_0x46caab(0x28c)]==_0x46caab(0x1b2))&&await logger[_0x46caab(0x2d1)]('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x2e50b['botID']+_0x46caab(0x2de)+_0x2e50b[_0x46caab(0x2b9)]);}else!newBot&&logger[_0x46caab(0x273)](_0x46caab(0x2db));if(newBot)addBot();logger[_0x46caab(0x273)](_0x46caab(0x313)),logger[_0x46caab(0x273)]('');}function startSocket(){const _0xca63c3=_0x31a8d6;io['on'](_0xca63c3(0x241),_0x47757c=>{const _0x3b2a74=_0xca63c3;let _0x2a75c4,_0x405ea6,_0x5c4239,_0x275e15,_0x3bbc4b;const _0x44fe7c=_0x47757c[_0x3b2a74(0x2ad)][_0x3b2a74(0x1e7)][_0x3b2a74(0x277)];_0x405ea6=_0x44fe7c['match'](/bot[0-9]{3}/);if(_0x405ea6)_0x5c4239=_0x405ea6[0x0][_0x3b2a74(0x2a1)](/[0-9]{3}/);if(_0x5c4239)_0x2a75c4=_0x5c4239[0x0];else _0x2a75c4=_0x3b2a74(0x253);const _0x29c063=_0x47757c[_0x3b2a74(0x2ad)][_0x3b2a74(0x2fa)][_0x3b2a74(0x1bd)];if(!_0x29c063)_0x47757c[_0x3b2a74(0x307)](_0x3b2a74(0x28c),{'publicKey':secure[_0x3b2a74(0x1d3)]});else{_0x275e15=timelyDecrypt(_0x29c063,![]);if(!_0x275e15)_0x47757c[_0x3b2a74(0x307)]('status',{'publicKey':secure[_0x3b2a74(0x1d3)]});else{_0x3bbc4b=normalizeIP(_0x47757c[_0x3b2a74(0x1e6)][_0x3b2a74(0x1f7)])[_0x3b2a74(0x22c)];if(!devices[_0x275e15])devices[_0x275e15]={'uuid':_0x275e15,'access':{'token':null}};devices[_0x275e15]['ip']=_0x3bbc4b;const _0xcc4999=addClient(_0x47757c['id'],_0x275e15,_0x2a75c4);setAccess(_0xcc4999),emitMessages(),_0x47757c['on'](_0x3b2a74(0x343),_0x250ba6=>{const _0x3b7871=_0x3b2a74,_0x2dd43c=timelyDecrypt(_0x250ba6[_0x3b7871(0x2c7)]);if(_0x2dd43c){_0x250ba6={'username':_0x250ba6[_0x3b7871(0x2b0)],'password':_0x2dd43c},devices[_0x275e15][_0x3b7871(0x32e)]=validateCredentials(_0x250ba6,_0x275e15);if(devices[_0x275e15][_0x3b7871(0x32e)][_0x3b7871(0x25e)]==![]&&devices[_0x275e15][_0x3b7871(0x32e)]['reason']==_0x3b7871(0x2d6))_0x47757c[_0x3b7871(0x307)]('status',{'access':devices[_0x275e15][_0x3b7871(0x32e)]}),loginAccess2FA(_0x275e15,_0x3bbc4b);else{if(devices[_0x275e15][_0x3b7871(0x32e)][_0x3b7871(0x25e)]==![]&&devices[_0x275e15][_0x3b7871(0x32e)][_0x3b7871(0x2ab)]==_0x3b7871(0x2b4))_0x47757c['emit']('status',{'access':devices[_0x275e15][_0x3b7871(0x32e)]});else devices[_0x275e15][_0x3b7871(0x32e)][_0x3b7871(0x25e)]&&devices[_0x275e15]['access']['reason']==_0x3b7871(0x309)&&(getClientsWithUuid(_0x275e15)[_0x3b7871(0x2a6)](_0x3f4349=>{setAccess(_0x3f4349);}),setTokenRefresh(_0x275e15),setSessionTimeout('login',_0x275e15));}}else logger[_0x3b7871(0x2d1)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x47757c['on'](_0x3b2a74(0x323),()=>{resetPassword();}),_0x47757c['on'](_0x3b2a74(0x26b),_0x500d83=>{removeClient(_0x47757c['id']);}),_0x2a75c4==_0x3b2a74(0x253)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5684af){const _0x3794e2=_0x31a8d6;if(_0x5684af!=_0x3794e2(0x253)&&config[_0x3794e2(0x2e6)]!=''){if(pid[_0x5684af])pid[_0x5684af][_0x3794e2(0x206)]({'function':_0x3794e2(0x362),'args':null});}}function reloadBotManager(){const _0x428ec4=_0x31a8d6;getClientsWithBotID(_0x428ec4(0x253))['forEach'](_0x5af060=>{const _0x451a6c=_0x428ec4;getSocket(_0x5af060['id'])[_0x451a6c(0x307)](_0x451a6c(0x28c),{'access':{'allow':![],'reason':_0x451a6c(0x202),'token':null}});});}function getSocket(_0xdac857){const _0x4f8986=_0x31a8d6;return io[_0x4f8986(0x203)][_0x4f8986(0x203)][_0x4f8986(0x1f5)](_0xdac857);}function setAccess(_0x36a17f){const _0x4677fb=_0x31a8d6,_0x2dda48=getSocket(_0x36a17f['id']),_0x520ef6=_0x36a17f[_0x4677fb(0x1bc)],_0x10d6b5=_0x36a17f[_0x4677fb(0x224)];devices[_0x520ef6][_0x4677fb(0x32e)]=validateAccess(devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x2be)],_0x520ef6),_0x2dda48[_0x4677fb(0x25a)](_0x520ef6);if(devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x25e)]){_0x2dda48[_0x4677fb(0x25a)](_0x10d6b5);if(_0x10d6b5==_0x4677fb(0x253))initializeSocketBotManager(_0x2dda48);else initializeSocketBot(_0x2dda48);initClient(_0x10d6b5);}devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x2be)]&&devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x2ab)]==_0x4677fb(0x301)&&setSessionTimeout(_0x4677fb(0x210),_0x520ef6),devices[_0x520ef6][_0x4677fb(0x32e)]['token']&&devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x2ab)]==_0x4677fb(0x357)&&setSessionTimeout(_0x4677fb(0x343),_0x520ef6),_0x2dda48[_0x4677fb(0x307)]('status',{'status':_0x36a17f['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x520ef6]['access'],'externalip':devices[_0x520ef6]['ip'],'publicKey':secure[_0x4677fb(0x1d3)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x25e)]==![]&&devices[_0x520ef6][_0x4677fb(0x32e)][_0x4677fb(0x2ab)]==_0x4677fb(0x311)&&temporaryAccess2FA(_0x520ef6,devices[_0x520ef6]['ip']);}function setSessionTimeout(_0x2da434,_0x1ab656){const _0x526ca6=_0x31a8d6;let _0x41688f;if(_0x2da434==_0x526ca6(0x343))_0x41688f=loginExpiry*0x3c*0x3e8;else _0x41688f=devices[_0x1ab656][_0x526ca6(0x2a8)][_0x526ca6(0x2e1)]*0x3c*0x3e8-(new Date()[_0x526ca6(0x2b6)]()-devices[_0x1ab656][_0x526ca6(0x2a8)][_0x526ca6(0x29d)]);if(devices[_0x1ab656]['pidExpireLogin'])clearTimeout(devices[_0x1ab656][_0x526ca6(0x2f4)]);devices[_0x1ab656]['pidExpireLogin']=setTimeout(()=>{const _0x2d2ba0=_0x526ca6;if(devices[_0x1ab656][_0x2d2ba0(0x32c)])clearTimeout(devices[_0x1ab656][_0x2d2ba0(0x32c)]);removeSocketListeners(_0x1ab656),addBlacklist(_0x1ab656),devices[_0x1ab656][_0x2d2ba0(0x2a8)]=null,devices[_0x1ab656][_0x2d2ba0(0x30f)]=null,devices[_0x1ab656]['access']['token']=null,devices[_0x1ab656][_0x2d2ba0(0x32e)]=validateAccess(devices[_0x1ab656]['access']['token'],_0x1ab656),!(devices[_0x1ab656][_0x2d2ba0(0x32e)]['allow']&&devices[_0x1ab656][_0x2d2ba0(0x32e)][_0x2d2ba0(0x2ab)]==_0x2d2ba0(0x2ef))&&(_0x2da434==_0x2d2ba0(0x343)?io['to'](_0x1ab656)[_0x2d2ba0(0x307)](_0x2d2ba0(0x28c),{'access':{'allow':![],'reason':_0x2d2ba0(0x23e),'token':null}}):io['to'](_0x1ab656)['emit'](_0x2d2ba0(0x28c),{'access':{'allow':![],'reason':_0x2d2ba0(0x255),'token':null}})),devices[_0x1ab656][_0x2d2ba0(0x32e)][_0x2d2ba0(0x2be)]=null;},_0x41688f);}function setTokenRefresh(_0x22d973){const _0x145885=_0x31a8d6;if(devices[_0x22d973][_0x145885(0x32c)])clearTimeout(devices[_0x22d973][_0x145885(0x32c)]);devices[_0x22d973]['pidRefreshToken']=setTimeout(()=>{const _0x19b889=_0x145885;getClientsWithUuid(_0x22d973)['length']!=0x0?(devices[_0x22d973][_0x19b889(0x32e)]=refreshToken(_0x22d973),io['to'](_0x22d973)[_0x19b889(0x307)](_0x19b889(0x28c),{'status':_0x19b889(0x2d8),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x22d973]['access'],'externalip':devices[_0x22d973]['ip'],'publicKey':secure[_0x19b889(0x1d3)],'validInstallation':validInstallation}),setTokenRefresh(_0x22d973)):clearTimeout(devices[_0x22d973][_0x19b889(0x32c)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2c018d){const _0x55b383=_0x31a8d6,_0x12d388=getClient(_0x2c018d['id'])['uuid'];_0x2c018d[_0x55b383(0x307)](_0x55b383(0x225),config),_0x2c018d['emit'](_0x55b383(0x1f8),cleanSettings()),_0x2c018d['on']('add-bot',_0x5e8b60=>{const _0x544371=_0x55b383;if(validateAccess(_0x5e8b60,_0x12d388)['allow'])addBot();else logger[_0x544371(0x2d1)](_0x544371(0x22b));}),_0x2c018d['on'](_0x55b383(0x290),(_0xaf2aaf,_0x5c7171)=>{const _0x4d641a=_0x55b383;if(validateAccess(_0x5c7171,_0x12d388)['allow'])toggleBot(_0xaf2aaf[_0x4d641a(0x365)],_0xaf2aaf[_0x4d641a(0x28c)],_0xaf2aaf[_0x4d641a(0x337)]);else logger[_0x4d641a(0x2d1)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2c018d['on']('toggle-bot-mode',(_0x3adeb2,_0x579e04)=>{const _0x4ef034=_0x55b383;if(validateAccess(_0x579e04,_0x12d388)[_0x4ef034(0x25e)])toggleBotMode(_0x3adeb2);else logger[_0x4ef034(0x2d1)](_0x4ef034(0x27b));}),_0x2c018d['on'](_0x55b383(0x20e),(_0x5a6bb0,_0x104778)=>{const _0x112919=_0x55b383;if(validateAccess(_0x104778,_0x12d388)[_0x112919(0x25e)])deleteBot(_0x5a6bb0);else logger[_0x112919(0x2d1)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x2c018d['on'](_0x55b383(0x1e8),(_0x34187e,_0x19f602)=>{const _0x5f591a=_0x55b383;if(validateAccess(_0x19f602,_0x12d388)[_0x5f591a(0x25e)])storeSettings(_0x34187e,!![]);else logger[_0x5f591a(0x2d1)](_0x5f591a(0x368));}),_0x2c018d['on']('update-bb',_0x2beaf6=>{const _0x4959ea=_0x55b383;if(validateAccess(_0x2beaf6,_0x12d388)[_0x4959ea(0x25e)])updateBB(_0x4959ea(0x249));else logger[_0x4959ea(0x2d1)](_0x4959ea(0x1d7));}),_0x2c018d['on'](_0x55b383(0x1b9),_0x4477b1=>{const _0x422487=_0x55b383;if(validateAccess(_0x4477b1,_0x12d388)['allow'])updateBB(_0x422487(0x306));else logger[_0x422487(0x2d1)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x2c018d['on'](_0x55b383(0x27e),_0x25f478=>{const _0x5a7e6b=_0x55b383;if(validateAccess(_0x25f478,_0x12d388)[_0x5a7e6b(0x25e)])getBackupFiles(getClient(_0x2c018d['id'])[_0x5a7e6b(0x1bc)]);else logger[_0x5a7e6b(0x2d1)](_0x5a7e6b(0x360));}),_0x2c018d['on'](_0x55b383(0x24d),(_0x562548,_0x42495e)=>{const _0x12775b=_0x55b383;if(validateAccess(_0x42495e,_0x12d388)[_0x12775b(0x25e)])restoreBackupFile(_0x562548);else logger['full'](_0x12775b(0x30e));}),_0x2c018d['on'](_0x55b383(0x259),_0x412b05=>{const _0x1e3633=_0x55b383;if(validateAccess(_0x412b05,_0x12d388)[_0x1e3633(0x25e)])getMessages();else logger[_0x1e3633(0x2d1)](_0x1e3633(0x26d));}),_0x2c018d['on'](_0x55b383(0x284),(_0x47c810,_0x50156a)=>{if(validateAccess(_0x50156a,_0x12d388)['allow'])confirmMessage(_0x47c810);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2c018d['on'](_0x55b383(0x29e),_0x11350e=>{const _0x30ce94=_0x55b383;if(validateAccess(_0x11350e,_0x12d388)[_0x30ce94(0x25e)]){if(devices[_0x12d388][_0x30ce94(0x32c)])clearTimeout(devices[_0x12d388]['pidRefreshToken']);if(devices[_0x12d388][_0x30ce94(0x2f4)])clearTimeout(devices[_0x12d388][_0x30ce94(0x2f4)]);removeSocketListeners(getClient(_0x2c018d['id'])['uuid']),addBlacklist(_0x12d388),devices[_0x12d388]['telegramIpApproval']=null,devices[_0x12d388]['telegram2FaApproval']=null,devices[_0x12d388][_0x30ce94(0x32e)][_0x30ce94(0x2be)]=null,io['to'](getClient(_0x2c018d['id'])[_0x30ce94(0x1bc)])['emit'](_0x30ce94(0x28c),{'access':{'allow':![],'reason':_0x30ce94(0x238),'token':null}});}else logger[_0x30ce94(0x2d1)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x379f15){const _0x47fc7b=_0x31a8d6,_0x1899f3=getClient(_0x379f15['id'])['bot'],_0x337ab4=getClient(_0x379f15['id'])[_0x47fc7b(0x1bc)];_0x379f15['on'](_0x47fc7b(0x334),(_0x487b5c,_0x26b2cf)=>{const _0x36b2bb=_0x47fc7b;if(validateAccess(_0x26b2cf,_0x337ab4)[_0x36b2bb(0x25e)]){if(pid[_0x1899f3])pid[_0x1899f3][_0x36b2bb(0x206)]({'function':_0x36b2bb(0x2d4),'args':_0x487b5c});}else logger[_0x36b2bb(0x2d1)](_0x36b2bb(0x28a));}),_0x379f15['on'](_0x47fc7b(0x33f),(_0x2e8d41,_0x533a31)=>{const _0x7fcaae=_0x47fc7b;if(validateAccess(_0x533a31,_0x337ab4)['allow']){if(pid[_0x1899f3])pid[_0x1899f3][_0x7fcaae(0x206)]({'function':'deleteHistoryAlerts','args':_0x2e8d41});}else logger['full'](_0x7fcaae(0x246));}),_0x379f15['on'](_0x47fc7b(0x217),(_0x3f2402,_0x52b09d)=>{const _0x21dd89=_0x47fc7b;if(validateAccess(_0x52b09d,_0x337ab4)['allow']){if(pid[_0x1899f3])pid[_0x1899f3][_0x21dd89(0x206)]({'function':'getPortfolio','args':_0x3f2402});}else logger[_0x21dd89(0x2d1)](_0x21dd89(0x1c2));}),_0x379f15['on'](_0x47fc7b(0x275),(_0x5579c6,_0x487633)=>{const _0x3a0c71=_0x47fc7b;if(validateAccess(_0x487633,_0x337ab4)[_0x3a0c71(0x25e)]){if(pid[_0x1899f3])pid[_0x1899f3][_0x3a0c71(0x206)]({'function':_0x3a0c71(0x31e),'args':_0x5579c6});}else logger[_0x3a0c71(0x2d1)](_0x3a0c71(0x2ee));}),_0x379f15['on'](_0x47fc7b(0x248),(_0x1f2d1a,_0x10d257)=>{const _0x3780bc=_0x47fc7b;if(validateAccess(_0x10d257,_0x337ab4)['allow']){if(pid[_0x1899f3])pid[_0x1899f3][_0x3780bc(0x206)]({'function':_0x3780bc(0x1c4),'args':_0x1f2d1a});}else logger['full'](_0x3780bc(0x227));}),_0x379f15['on'](_0x47fc7b(0x326),_0x2557dc=>{const _0x37b39d=_0x47fc7b;if(validateAccess(_0x2557dc,_0x337ab4)[_0x37b39d(0x25e)]){if(pid[_0x1899f3])pid[_0x1899f3][_0x37b39d(0x206)]({'function':'getStartingBalances','args':null});}else logger[_0x37b39d(0x2d1)](_0x37b39d(0x229));}),_0x379f15['on']('place-order',(_0x2a3b92,_0x304b9a)=>{const _0x135fd9=_0x47fc7b;if(validateAccess(_0x304b9a,_0x337ab4)['allow']){if(pid[_0x1899f3])pid[_0x1899f3][_0x135fd9(0x206)]({'function':'placeOrder','args':_0x2a3b92});}else logger[_0x135fd9(0x2d1)](_0x135fd9(0x373));}),_0x379f15['on'](_0x47fc7b(0x327),_0x32a369=>{const _0x34baf5=_0x47fc7b;if(validateAccess(_0x32a369,_0x337ab4)[_0x34baf5(0x25e)]){if(pid[_0x1899f3])pid[_0x1899f3]['send']({'function':_0x34baf5(0x1c8),'args':null});}else logger[_0x34baf5(0x2d1)](_0x34baf5(0x1fd));}),_0x379f15['on'](_0x47fc7b(0x33a),_0x516aee=>{const _0x3b5dfb=_0x47fc7b;if(validateAccess(_0x516aee,_0x337ab4)[_0x3b5dfb(0x25e)]){if(pid[_0x1899f3])pid[_0x1899f3][_0x3b5dfb(0x206)]({'function':_0x3b5dfb(0x2f5),'args':null});}else logger['full'](_0x3b5dfb(0x226));}),_0x379f15['on'](_0x47fc7b(0x1c6),_0x4a3622=>{const _0x32c9fd=_0x47fc7b;if(validateAccess(_0x4a3622,_0x337ab4)[_0x32c9fd(0x25e)])updateBB(_0x32c9fd(0x249));else logger[_0x32c9fd(0x2d1)](_0x32c9fd(0x1d7));}),_0x379f15['on'](_0x47fc7b(0x259),_0x2ad31b=>{const _0x3588e6=_0x47fc7b;if(validateAccess(_0x2ad31b,_0x337ab4)['allow'])getMessages();else logger[_0x3588e6(0x2d1)](_0x3588e6(0x26d));}),_0x379f15['on']('confirm-message',(_0x23948f,_0x15639f)=>{const _0x44dc9a=_0x47fc7b;if(validateAccess(_0x15639f,_0x337ab4)[_0x44dc9a(0x25e)])confirmMessage(_0x23948f);else logger[_0x44dc9a(0x2d1)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x379f15['on'](_0x47fc7b(0x29e),_0x26decc=>{const _0xa12c7e=_0x47fc7b;if(validateAccess(_0x26decc,_0x337ab4)['allow']){if(devices[_0x337ab4][_0xa12c7e(0x32c)])clearTimeout(devices[_0x337ab4][_0xa12c7e(0x32c)]);if(devices[_0x337ab4]['pidExpireLogin'])clearTimeout(devices[_0x337ab4]['pidExpireLogin']);removeSocketListeners(getClient(_0x379f15['id'])['uuid']),addBlacklist(_0x337ab4),devices[_0x337ab4][_0xa12c7e(0x2a8)]=null,devices[_0x337ab4][_0xa12c7e(0x30f)]=null,devices[_0x337ab4][_0xa12c7e(0x32e)][_0xa12c7e(0x2be)]=null,io['to'](getClient(_0x379f15['id'])[_0xa12c7e(0x1bc)])[_0xa12c7e(0x307)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0xd53390){const _0x52916d=_0x31a8d6;getClientsWithUuid(_0xd53390)[_0x52916d(0x2a6)](_0x5e21fa=>{const _0x342d14=_0x52916d;getSocket(_0x5e21fa['id'])[_0x342d14(0x20d)]();});}function cleanSettings(){const _0x16aed8=_0x31a8d6;let _0xbe4143=settings;return settings[_0x16aed8(0x21a)]&&settings[_0x16aed8(0x21a)]!=''&&(_0xbe4143={..._0xbe4143,'telegramToken':_0x16aed8(0x26e)}),settings[_0x16aed8(0x295)]&&settings[_0x16aed8(0x295)]!=''&&(_0xbe4143={..._0xbe4143,'bbPassword':_0x16aed8(0x26e)}),(settings['bbPassword']&&settings[_0x16aed8(0x295)]==_0x16aed8(0x364)||settings[_0x16aed8(0x21a)]&&settings[_0x16aed8(0x21a)]==_0x16aed8(0x364))&&(_0xbe4143={..._0xbe4143,'restored':{'password':settings['bbPassword']==_0x16aed8(0x364),'telegram':settings[_0x16aed8(0x21a)]==_0x16aed8(0x364)}}),_0xbe4143;}async function updateBB(_0x10f82e){const _0x287335=_0x31a8d6;await backupConfigFiles(),installingUpdate=!![],config[_0x287335(0x2a6)](_0x584f96=>{restartBot(_0x584f96['botID']);}),logger[_0x287335(0x214)](_0x287335(0x2d9)+_0x10f82e);if(_0x10f82e=='update')process[_0x287335(0x206)]({'update':!![]},_0x5c21ce=>{});else _0x10f82e=='reinstall'&&process['send']({'reinstall':!![]},_0x37d238=>{});}function startBot(_0xa090f6,_0x12caae,_0x2de624){const _0x34db60=_0x31a8d6;if(debugging)_0xa090f6['push']('-d');let _0x349df3=![];const _0x4e88c4=_0xa090f6[0x0];_0x12caae={..._0x12caae,'stdio':[_0x34db60(0x1ba),'inherit',_0x34db60(0x1ba),_0x34db60(0x288)]},pid[_0x4e88c4]=childProcess[_0x34db60(0x25c)](botfile,_0xa090f6,_0x12caae),pid[_0x4e88c4]['on'](_0x34db60(0x28b),_0x48a38b=>{const _0x539364=_0x34db60;switch(Object[_0x539364(0x280)](_0x48a38b)[0x0]){case _0x539364(0x2b9):updateBotName(_0x4e88c4,_0x48a38b[_0x539364(0x2b9)]);break;case _0x539364(0x263):updateBotManager();break;case _0x539364(0x28c):updateStatus(_0x4e88c4,_0x48a38b[_0x539364(0x28c)]);break;case _0x539364(0x337):updateLive(_0x4e88c4,_0x48a38b['live']);break;case'started':updateLive(_0x4e88c4,_0x48a38b[_0x539364(0x237)]),io['to'](_0x4e88c4)[_0x539364(0x307)](_0x539364(0x28c),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x539364(0x353):_0x48a38b[_0x539364(0x353)]==_0x539364(0x283)&&restartBot(_0x4e88c4);_0x48a38b[_0x539364(0x353)]==_0x539364(0x2c0)&&toggleBot(_0x4e88c4,_0x539364(0x291),_0x539364(0x298));break;case'telegram':sendTelegram(_0x4e88c4,_0x48a38b['telegram']);break;case _0x539364(0x332):sendTelegramMsg(_0x48a38b[_0x539364(0x332)]);break;case _0x539364(0x20b):io['to'](_0x4e88c4)['emit'](_0x48a38b[_0x539364(0x20b)],_0x48a38b[_0x539364(0x24b)]);break;}}),pid[_0x4e88c4]['on'](_0x34db60(0x1e4),function(_0x334765){if(_0x349df3)return;_0x349df3=!![],_0x2de624(_0x334765);}),pid[_0x4e88c4]['on'](_0x34db60(0x264),async function(_0x581867){const _0xd5fe0d=_0x34db60;if(installingUpdate)return;if(_0x349df3)return;_0x349df3=!![],_0x2de624(null);const _0x4fcd74=dbConfig[_0xd5fe0d(0x1f5)]('bots')['find']({'botID':_0x4e88c4})[_0xd5fe0d(0x24f)]();_0x4fcd74&&(_0x4fcd74[_0xd5fe0d(0x28c)]=='enabled'||_0x4fcd74[_0xd5fe0d(0x28c)]==_0xd5fe0d(0x286))&&(await sleep(0x3e8),updateLive(_0x4e88c4,_0xd5fe0d(0x298)),logger[_0xd5fe0d(0x2d1)](_0xd5fe0d(0x29a)+_0x4e88c4),startBot([_0x4e88c4,userID],{'cwd':bbpath},function(_0x5d277f){if(_0x5d277f)logger['full'](_0x5d277f);}));});}function stopBot(_0x42f7de){const _0xa489a3=_0x31a8d6;getClientsWithBotID(_0x42f7de)[_0xa489a3(0x2a6)](_0x19b72d=>{getSocket(_0x19b72d['id'])['disconnect'](!![]),removeClient(_0x19b72d['id']);}),pid[_0x42f7de]&&(pid[_0x42f7de][_0xa489a3(0x2c0)](),pid[_0x42f7de]=null);}function restartBot(_0x5d36ff){const _0x156c8d=_0x31a8d6;if(pid[_0x5d36ff])pid[_0x5d36ff][_0x156c8d(0x2c0)]();}function addBot(){const _0x35b75a=_0x31a8d6;let _0x48f356;for(let _0x34401b=0x1;_0x34401b<0x3e9;_0x34401b++){_0x48f356=_0x34401b[_0x35b75a(0x317)]()['padStart'](0x3,'0');let _0x29e326=config[_0x35b75a(0x1c5)](_0x21adb9=>_0x21adb9[_0x35b75a(0x365)]==_0x48f356);if(!_0x29e326)break;}if(_0x48f356===_0x35b75a(0x300)){logger[_0x35b75a(0x2d1)]('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x35b75a(0x2d1)](_0x35b75a(0x30a)+_0x48f356),dbConfig[_0x35b75a(0x1f5)](_0x35b75a(0x225))[_0x35b75a(0x28d)]({'botID':_0x48f356,'botname':_0x35b75a(0x29f)+_0x48f356,'status':'new','live':''})[_0x35b75a(0x31f)](),startBot([_0x48f356,userID],{'cwd':bbpath},function(_0x51e27e){const _0x437982=_0x35b75a;if(_0x51e27e)logger[_0x437982(0x2d1)](_0x51e27e);}),config=getConfiguration(),io['to'](_0x35b75a(0x253))[_0x35b75a(0x307)](_0x35b75a(0x225),config);}function deleteBot(_0x18e4af){const _0x960de7=_0x31a8d6;getClientsWithBotID(_0x18e4af)[_0x960de7(0x2a6)](_0x53c9f8=>{const _0x234850=_0x960de7;getSocket(_0x53c9f8['id'])[_0x234850(0x26b)](!![]),removeClient(_0x53c9f8['id']);}),dbConfig[_0x960de7(0x1f5)](_0x960de7(0x225))[_0x960de7(0x339)]({'botID':_0x18e4af})['write'](),logger[_0x960de7(0x2d1)](_0x960de7(0x266)+_0x18e4af),stopBot(_0x18e4af);try{if(fs[_0x960de7(0x1af)](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+_0x960de7(0x27a))))fs[_0x960de7(0x321)](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+_0x960de7(0x27a)));if(fs['existsSync'](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+'-events.json')))fs['unlinkSync'](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+'-events.json'));if(fs[_0x960de7(0x1af)](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+_0x960de7(0x351))))fs[_0x960de7(0x321)](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+_0x960de7(0x351)));if(fs[_0x960de7(0x1af)](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+'-results.json')))fs[_0x960de7(0x321)](path[_0x960de7(0x25a)](configpath,_0x960de7(0x2bf)+_0x18e4af+_0x960de7(0x2f2)));}catch(_0x56e40c){if(_0x56e40c)logger[_0x960de7(0x2d1)](_0x960de7(0x256),_0x56e40c);}config=getConfiguration(),io['to'](_0x960de7(0x253))[_0x960de7(0x307)](_0x960de7(0x225),config);}function toggleBot(_0x4a4818,_0xb77a15,_0x32340f){const _0x34009c=_0x31a8d6;dbConfig[_0x34009c(0x1f5)](_0x34009c(0x225))[_0x34009c(0x1c5)]({'botID':_0x4a4818})[_0x34009c(0x371)]({'status':_0xb77a15})[_0x34009c(0x371)]({'live':_0x32340f})['write']();if(_0xb77a15==_0x34009c(0x342)||_0xb77a15==_0x34009c(0x286))logger['full'](_0x34009c(0x1cc)+_0x4a4818),startBot([_0x4a4818,userID],{'cwd':bbpath},function(_0x2bf15a){const _0x2be7bf=_0x34009c;if(_0x2bf15a)logger[_0x2be7bf(0x2d1)](_0x2bf15a);});else(_0xb77a15==_0x34009c(0x291)||_0xb77a15==_0x34009c(0x1b2))&&(logger[_0x34009c(0x2d1)](_0x34009c(0x2e5)+_0x4a4818),stopBot(_0x4a4818));config=getConfiguration(),io['to']('botmanager')[_0x34009c(0x307)](_0x34009c(0x225),config);}function toggleStatus(_0x247ac0){const _0x77d0a=_0x31a8d6;let _0x3f7863=dbConfig[_0x77d0a(0x1f5)]('bots')[_0x77d0a(0x1c5)]({'botID':_0x247ac0})[_0x77d0a(0x24f)](),_0x39874d;if(_0x3f7863[_0x77d0a(0x28c)]===_0x77d0a(0x342))_0x39874d=_0x77d0a(0x291);else{if(_0x3f7863[_0x77d0a(0x28c)]==='new')_0x39874d=_0x77d0a(0x1b2);else{if(_0x3f7863[_0x77d0a(0x28c)]===_0x77d0a(0x1b2))_0x39874d='new';else{if(_0x3f7863[_0x77d0a(0x28c)]===_0x77d0a(0x291))_0x39874d=_0x77d0a(0x342);}}}return _0x39874d;}function updateStatus(_0x19f1f1,_0x50d339){const _0x2c60ab=_0x31a8d6;dbConfig[_0x2c60ab(0x1f5)](_0x2c60ab(0x225))[_0x2c60ab(0x1c5)]({'botID':_0x19f1f1})[_0x2c60ab(0x371)]({'status':_0x50d339})[_0x2c60ab(0x31f)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x2c60ab(0x225),config);}function updateLive(_0x1ca830,_0x380771){const _0x42db63=_0x31a8d6;dbConfig[_0x42db63(0x1f5)](_0x42db63(0x225))[_0x42db63(0x1c5)]({'botID':_0x1ca830})[_0x42db63(0x371)]({'live':_0x380771})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x42db63(0x307)](_0x42db63(0x225),config);}function updateBotName(_0x1da66d,_0x278dc7){const _0x56c462=_0x31a8d6;dbConfig['get'](_0x56c462(0x225))[_0x56c462(0x1c5)]({'botID':_0x1da66d})[_0x56c462(0x371)]({'botname':_0x278dc7})[_0x56c462(0x31f)](),config=getConfiguration(),io['to'](_0x56c462(0x253))[_0x56c462(0x307)]('bots',config);}function updateBotManager(){const _0x463f2d=_0x31a8d6;config=getConfiguration(),io['to'](_0x463f2d(0x253))[_0x463f2d(0x307)]('bots',config);}function toggleBotMode(_0x4bd290){const _0x186d3d=_0x31a8d6;if(pid[_0x4bd290])pid[_0x4bd290][_0x186d3d(0x206)]({'function':_0x186d3d(0x1eb),'args':null});else{const _0x6e25dd=configpath+_0x186d3d(0x2bf)+_0x4bd290+'-config.json',_0x2f73af=fs[_0x186d3d(0x34f)](_0x6e25dd),_0x2b2cb8=JSON[_0x186d3d(0x2b7)](_0x2f73af),_0xe0f6c3=_0x2b2cb8[_0x186d3d(0x224)][0x0][_0x186d3d(0x281)];_0x2b2cb8[_0x186d3d(0x224)][0x0]['headless']=!_0xe0f6c3;const _0x574e33=JSON[_0x186d3d(0x297)](_0x2b2cb8,null,0x2);fs[_0x186d3d(0x322)](_0x6e25dd,_0x574e33),config=getConfiguration(),io['to'](_0x186d3d(0x253))[_0x186d3d(0x307)](_0x186d3d(0x225),config);}}function telegramError(_0x42c149){const _0x6de8d7=_0x31a8d6;logger[_0x6de8d7(0x273)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x575af7){const _0x3bf5cb=_0x31a8d6;if(_0x575af7['from'][_0x3bf5cb(0x2b0)]!=settings['telegramUsername']&&'@'+_0x575af7[_0x3bf5cb(0x1ac)][_0x3bf5cb(0x2b0)]!=settings['telegramUsername'])return tgBot['sendMessage'](_0x575af7[_0x3bf5cb(0x1fe)]['id'],_0x3bf5cb(0x1d0),{'parse_mode':'HTML'})[_0x3bf5cb(0x304)](_0x2b1354=>{telegramError(_0x2b1354);}),![];return!![];}async function initTelegram(){const _0x370f94=_0x31a8d6;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x370f94(0x21a)],{'polling':!![]});let _0x28ce9c='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x28ce9c+='\x0a',_0x28ce9c+='/enable\x20-\x20enable\x20notifications\x0a',_0x28ce9c+=_0x370f94(0x1c1),_0x28ce9c+=_0x370f94(0x1cb),_0x28ce9c+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x28ce9c+=_0x370f94(0x278),_0x28ce9c+=_0x370f94(0x207),_0x28ce9c+=_0x370f94(0x222),_0x28ce9c+='/names\x20-\x20show\x20bot\x20names\x0a',_0x28ce9c+=_0x370f94(0x2d0),_0x28ce9c+=_0x370f94(0x1fa),_0x28ce9c+=_0x370f94(0x36c),_0x28ce9c+=_0x370f94(0x2c3),_0x28ce9c+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x451057=_0x370f94(0x294);_0x451057+='\x0a',_0x451057+=_0x28ce9c,tgBot[_0x370f94(0x358)](/\/start/,_0x48b63b=>{const _0x36c7c0=_0x370f94;if(!validateTelegram(_0x48b63b))return;if(settings[_0x36c7c0(0x335)]!=_0x48b63b[_0x36c7c0(0x1fe)]['id'])updateSetting(_0x36c7c0(0x335),_0x48b63b[_0x36c7c0(0x1fe)]['id']);updateSetting(_0x36c7c0(0x25d),!![]),tgBot['sendMessage'](_0x48b63b['chat']['id'],_0x451057)[_0x36c7c0(0x304)](_0x2b7e5a=>{telegramError(_0x2b7e5a);});}),tgBot[_0x370f94(0x358)](/\/enable/,_0x3692e8=>{const _0x25c00b=_0x370f94;if(!validateTelegram(_0x3692e8))return;if(settings[_0x25c00b(0x335)]!=_0x3692e8['chat']['id'])updateSetting(_0x25c00b(0x335),_0x3692e8[_0x25c00b(0x1fe)]['id']);updateSetting(_0x25c00b(0x25d),!![]),tgBot[_0x25c00b(0x1f4)](_0x3692e8['chat']['id'],'Notifications\x20enabled')[_0x25c00b(0x304)](_0x16f9db=>{telegramError(_0x16f9db);});}),tgBot[_0x370f94(0x358)](/\/config/,async _0x58f9bd=>{const _0x7bc7dd=_0x370f94;if(!validateTelegram(_0x58f9bd))return;tgBot[_0x7bc7dd(0x204)](_0x7bc7dd(0x22a)),tgBot['sendMessage'](_0x58f9bd[_0x7bc7dd(0x1fe)]['id'],_0x7bc7dd(0x2e3),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x7bc7dd(0x34b)},{'text':_0x7bc7dd(0x2b1),'callback_data':_0x7bc7dd(0x32d)},{'text':_0x7bc7dd(0x2af),'callback_data':_0x7bc7dd(0x234)}]]}})['catch'](_0x1504c6=>{telegramError(_0x1504c6);}),tgBot['on'](_0x7bc7dd(0x22a),async _0x418120=>{const _0x4b4c3c=_0x7bc7dd,_0x2336ba=_0x418120[_0x4b4c3c(0x2f8)],_0x390daa=_0x418120[_0x4b4c3c(0x28b)];tgBot[_0x4b4c3c(0x23f)](_0x418120['id'])[_0x4b4c3c(0x258)](async()=>{const _0x3d1eb0=_0x4b4c3c;_0x2336ba==_0x3d1eb0(0x34b)&&(updateSetting(_0x3d1eb0(0x348),_0x3d1eb0(0x34b)),updateSetting(_0x3d1eb0(0x25d),!![]),await tgBot['sendMessage'](_0x390daa['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x21994d=>{telegramError(_0x21994d);}));_0x2336ba=='alerts'&&(updateSetting('telegramEvents',_0x3d1eb0(0x32d)),updateSetting(_0x3d1eb0(0x25d),!![]),await tgBot[_0x3d1eb0(0x1f4)](_0x390daa[_0x3d1eb0(0x1fe)]['id'],_0x3d1eb0(0x262))['catch'](_0x3e81c3=>{telegramError(_0x3e81c3);}));_0x2336ba==_0x3d1eb0(0x234)&&(updateSetting(_0x3d1eb0(0x348),_0x3d1eb0(0x234)),updateSetting(_0x3d1eb0(0x25d),!![]),await tgBot[_0x3d1eb0(0x1f4)](_0x390daa[_0x3d1eb0(0x1fe)]['id'],_0x3d1eb0(0x32f))['catch'](_0x3628e4=>{telegramError(_0x3628e4);}));if(!settings['telegramChatId'])tgBot[_0x3d1eb0(0x1f4)](_0x390daa[_0x3d1eb0(0x1fe)]['id'],_0x3d1eb0(0x1f3))[_0x3d1eb0(0x304)](_0x14e961=>{telegramError(_0x14e961);});}),tgBot['removeListener'](_0x4b4c3c(0x22a));});}),tgBot['onText'](/\/status/,_0x1b03a3=>{const _0x20ad05=_0x370f94;if(!validateTelegram(_0x1b03a3))return;const _0x24e4e1=getBotsWithMode();let _0x155549='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x20ad05(0x2a6)](_0x3da106=>{const _0x215744=_0x20ad05,_0x4403ba=_0x24e4e1[_0x215744(0x1c5)](_0x40511a=>_0x40511a[_0x215744(0x365)]==_0x3da106['botID'])[_0x215744(0x254)];_0x155549+=_0x215744(0x29f)+_0x3da106[_0x215744(0x365)]+':\x20'+_0x3da106['status']+_0x215744(0x2de)+_0x4403ba+_0x215744(0x2de)+_0x3da106['live']+'\x0a';}),_0x155549+='\x0a',_0x155549+=_0x20ad05(0x247),_0x155549+=!settings['telegramEnabled']?_0x20ad05(0x239):'Notifications\x20enabled\x0a',_0x155549+=settings[_0x20ad05(0x25d)]?settings[_0x20ad05(0x348)]==_0x20ad05(0x234)?_0x20ad05(0x21c):_0x20ad05(0x26f)+settings[_0x20ad05(0x348)]+'\x20only\x0a':'',tgBot[_0x20ad05(0x1f4)](_0x1b03a3[_0x20ad05(0x1fe)]['id'],_0x155549,{'parse_mode':_0x20ad05(0x1f9)})['catch'](_0x3a2537=>{telegramError(_0x3a2537);});}),tgBot['onText'](/\/restart/,_0x40d166=>{const _0x5b6496=_0x370f94;if(!validateTelegram(_0x40d166))return;tgBot['removeListener'](_0x5b6496(0x22a));const _0x4a8637=getEnabledBots();if(_0x4a8637[_0x5b6496(0x350)]==0x0)tgBot[_0x5b6496(0x1f4)](_0x40d166[_0x5b6496(0x1fe)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x85c71b=>{telegramError(_0x85c71b);});else{if(_0x4a8637[_0x5b6496(0x350)]>0x1)_0x4a8637[_0x5b6496(0x28d)]({'botID':'all'});let _0x1eacdc=[],_0x59d4d1=[];const _0x34c76c=_0x4a8637['length']%0x4==0x0||_0x4a8637['length']%0x4==0x3||_0x4a8637['length']%0x3==0x1?0x4:0x3;let _0x25df19=0x0;_0x4a8637[_0x5b6496(0x2a6)]((_0x1d2318,_0x432eeb)=>{const _0x1f36c2=_0x5b6496;if(_0x432eeb%_0x34c76c==0x0)_0x59d4d1=[];_0x59d4d1[_0x1f36c2(0x28d)]({'text':_0x1d2318[_0x1f36c2(0x365)]==_0x1f36c2(0x234)?_0x1f36c2(0x20a):_0x1f36c2(0x29f)+_0x1d2318[_0x1f36c2(0x365)],'callback_data':_0x1d2318['botID']}),_0x432eeb%_0x34c76c==0x0&&(_0x1eacdc[_0x25df19]=_0x59d4d1,_0x25df19++);}),tgBot[_0x5b6496(0x1f4)](_0x40d166[_0x5b6496(0x1fe)]['id'],_0x5b6496(0x1de),{'reply_markup':{'inline_keyboard':_0x1eacdc}})[_0x5b6496(0x304)](_0x5133a3=>{telegramError(_0x5133a3);}),tgBot['on'](_0x5b6496(0x22a),async _0x528a58=>{const _0x4e57e1=_0x5b6496,_0x4a43a5=_0x528a58['data'],_0x39bec3=_0x528a58[_0x4e57e1(0x28b)];tgBot[_0x4e57e1(0x23f)](_0x528a58['id'])[_0x4e57e1(0x258)](async()=>{const _0x5ec673=_0x4e57e1;_0x4a43a5==_0x5ec673(0x234)?config['forEach'](_0x2425d2=>{restartBot(_0x2425d2['botID']);}):restartBot(_0x4a43a5);}),tgBot['removeListener'](_0x4e57e1(0x22a));});}}),tgBot[_0x370f94(0x358)](/\/on/,_0x2dff08=>{const _0xf5d37b=_0x370f94;if(!validateTelegram(_0x2dff08))return;tgBot[_0xf5d37b(0x204)](_0xf5d37b(0x22a));const _0x420ed0=getDisabledBots();if(_0x420ed0['length']==0x0)tgBot[_0xf5d37b(0x1f4)](_0x2dff08[_0xf5d37b(0x1fe)]['id'],_0xf5d37b(0x333))['catch'](_0x2e5f08=>{telegramError(_0x2e5f08);});else{if(_0x420ed0['length']>0x1)_0x420ed0[_0xf5d37b(0x28d)]({'botID':'all'});let _0x53dda6=[],_0x590571=[];const _0x32f377=_0x420ed0[_0xf5d37b(0x350)]%0x4==0x0||_0x420ed0[_0xf5d37b(0x350)]%0x4==0x3||_0x420ed0[_0xf5d37b(0x350)]%0x3==0x1?0x4:0x3;let _0x65d723=0x0;_0x420ed0['forEach']((_0x59a363,_0x30a434)=>{const _0x1d58cd=_0xf5d37b;if(_0x30a434%_0x32f377==0x0)_0x590571=[];_0x590571[_0x1d58cd(0x28d)]({'text':_0x59a363[_0x1d58cd(0x365)]=='all'?'All\x20bots':_0x1d58cd(0x29f)+_0x59a363['botID'],'callback_data':_0x59a363[_0x1d58cd(0x365)]}),_0x30a434%_0x32f377==0x0&&(_0x53dda6[_0x65d723]=_0x590571,_0x65d723++);}),tgBot[_0xf5d37b(0x1f4)](_0x2dff08[_0xf5d37b(0x1fe)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x53dda6}})['catch'](_0x2471a8=>{telegramError(_0x2471a8);}),tgBot['on'](_0xf5d37b(0x22a),async _0x25e94e=>{const _0xd813b7=_0xf5d37b,_0x42076a=_0x25e94e[_0xd813b7(0x2f8)],_0x34de22=_0x25e94e[_0xd813b7(0x28b)];tgBot[_0xd813b7(0x23f)](_0x25e94e['id'])[_0xd813b7(0x258)](async()=>{const _0x4e43a0=_0xd813b7;_0x42076a==_0x4e43a0(0x234)?(tgBot[_0x4e43a0(0x1f4)](_0x34de22[_0x4e43a0(0x1fe)]['id'],_0x4e43a0(0x232))[_0x4e43a0(0x304)](_0x498e7b=>{telegramError(_0x498e7b);}),_0x420ed0[_0x4e43a0(0x2a6)](_0x454794=>{const _0x1d81f0=_0x4e43a0;if(_0x454794['botID']!=_0x1d81f0(0x234))toggleBot(_0x454794[_0x1d81f0(0x365)],toggleStatus(_0x454794[_0x1d81f0(0x365)]),'stopped');})):(tgBot[_0x4e43a0(0x1f4)](_0x34de22[_0x4e43a0(0x1fe)]['id'],_0x4e43a0(0x33e)+_0x42076a)['catch'](_0x13fda1=>{telegramError(_0x13fda1);}),toggleBot(_0x42076a,toggleStatus(_0x42076a),'stopped'));}),tgBot['removeListener'](_0xd813b7(0x22a));});}}),tgBot[_0x370f94(0x358)](/\/off/,_0x140c55=>{const _0x3201f7=_0x370f94;if(!validateTelegram(_0x140c55))return;tgBot[_0x3201f7(0x204)]('callback_query');const _0x2298f5=getEnabledBots();if(_0x2298f5[_0x3201f7(0x350)]==0x0)tgBot[_0x3201f7(0x1f4)](_0x140c55['chat']['id'],_0x3201f7(0x36b))[_0x3201f7(0x304)](_0x52eb42=>{telegramError(_0x52eb42);});else{if(_0x2298f5[_0x3201f7(0x350)]>0x1)_0x2298f5[_0x3201f7(0x28d)]({'botID':'all'});let _0x1c8fff=[],_0x3c73ef=[];const _0x45989f=_0x2298f5[_0x3201f7(0x350)]%0x4==0x0||_0x2298f5[_0x3201f7(0x350)]%0x4==0x3||_0x2298f5[_0x3201f7(0x350)]%0x3==0x1?0x4:0x3;let _0x58c36c=0x0;_0x2298f5[_0x3201f7(0x2a6)]((_0x5708fb,_0x3267cf)=>{const _0x450713=_0x3201f7;if(_0x3267cf%_0x45989f==0x0)_0x3c73ef=[];_0x3c73ef['push']({'text':_0x5708fb[_0x450713(0x365)]==_0x450713(0x234)?'All\x20bots':'Bot\x20'+_0x5708fb[_0x450713(0x365)],'callback_data':_0x5708fb[_0x450713(0x365)]}),_0x3267cf%_0x45989f==0x0&&(_0x1c8fff[_0x58c36c]=_0x3c73ef,_0x58c36c++);}),tgBot['sendMessage'](_0x140c55['chat']['id'],_0x3201f7(0x289),{'reply_markup':{'inline_keyboard':_0x1c8fff}})[_0x3201f7(0x304)](_0x2cd97f=>{telegramError(_0x2cd97f);}),tgBot['on'](_0x3201f7(0x22a),async _0x4d45df=>{const _0x2324c5=_0x3201f7,_0xfc4d82=_0x4d45df[_0x2324c5(0x2f8)],_0x3a4b4e=_0x4d45df[_0x2324c5(0x28b)];tgBot[_0x2324c5(0x23f)](_0x4d45df['id'])[_0x2324c5(0x258)](async()=>{const _0x1845ff=_0x2324c5;_0xfc4d82=='all'?(tgBot[_0x1845ff(0x1f4)](_0x3a4b4e[_0x1845ff(0x1fe)]['id'],_0x1845ff(0x2b2))['catch'](_0x3ff58e=>{telegramError(_0x3ff58e);}),_0x2298f5['forEach'](_0x908360=>{const _0x1d5f31=_0x1845ff;if(_0x908360['botID']!=_0x1d5f31(0x234))toggleBot(_0x908360[_0x1d5f31(0x365)],toggleStatus(_0x908360[_0x1d5f31(0x365)]),_0x1d5f31(0x298));})):(tgBot['sendMessage'](_0x3a4b4e[_0x1845ff(0x1fe)]['id'],_0x1845ff(0x345)+_0xfc4d82)['catch'](_0x5cbe8e=>{telegramError(_0x5cbe8e);}),toggleBot(_0xfc4d82,toggleStatus(_0xfc4d82),_0x1845ff(0x298)));}),tgBot[_0x2324c5(0x204)](_0x2324c5(0x22a));});}}),tgBot[_0x370f94(0x358)](/\/portfolio/,_0x1cab39=>{const _0x4f9f9a=_0x370f94;if(!validateTelegram(_0x1cab39))return;tgBot['removeListener'](_0x4f9f9a(0x22a));const _0x18544a=getEnabledBots();if(_0x18544a['length']==0x0)tgBot['sendMessage'](_0x1cab39[_0x4f9f9a(0x1fe)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4f9f9a(0x304)](_0x158eb5=>{telegramError(_0x158eb5);});else{if(_0x18544a[_0x4f9f9a(0x350)]>0x1){let _0x23ce0d=[],_0x567454=[];const _0x521996=_0x18544a[_0x4f9f9a(0x350)]%0x4==0x0||_0x18544a[_0x4f9f9a(0x350)]%0x4==0x3||_0x18544a[_0x4f9f9a(0x350)]%0x3==0x1?0x4:0x3;let _0x1a1ac7=0x0;_0x18544a[_0x4f9f9a(0x2a6)]((_0x2e487e,_0x498e48)=>{const _0x4b7e33=_0x4f9f9a;if(_0x498e48%_0x521996==0x0)_0x567454=[];_0x567454[_0x4b7e33(0x28d)]({'text':'Bot\x20'+_0x2e487e[_0x4b7e33(0x365)],'callback_data':_0x2e487e[_0x4b7e33(0x365)]}),_0x498e48%_0x521996==0x0&&(_0x23ce0d[_0x1a1ac7]=_0x567454,_0x1a1ac7++);}),tgBot[_0x4f9f9a(0x1f4)](_0x1cab39[_0x4f9f9a(0x1fe)]['id'],_0x4f9f9a(0x32b),{'reply_markup':{'inline_keyboard':_0x23ce0d}})[_0x4f9f9a(0x304)](_0xaa7706=>{telegramError(_0xaa7706);}),tgBot['on']('callback_query',async _0xd57f52=>{const _0x565ff5=_0x4f9f9a,_0x401b67=_0xd57f52['data'],_0x303f14=_0xd57f52[_0x565ff5(0x28b)];tgBot['answerCallbackQuery'](_0xd57f52['id'])[_0x565ff5(0x258)](async()=>{const _0x99e976=_0x565ff5;if(pid[_0x401b67])pid[_0x401b67][_0x99e976(0x206)]({'function':_0x99e976(0x23b),'args':null});}),tgBot[_0x565ff5(0x204)](_0x565ff5(0x22a));});}else{const _0xdd6583=_0x18544a[0x0]['botID'];if(pid[_0xdd6583])pid[_0xdd6583]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x370f94(0x358)](/\/update/,async _0x2364d8=>{const _0x235c81=_0x370f94;if(!validateTelegram(_0x2364d8))return;tgBot[_0x235c81(0x204)](_0x235c81(0x22a)),await getMessages();if(!updateAvailable)tgBot[_0x235c81(0x1f4)](_0x2364d8['chat']['id'],_0x235c81(0x1d6))[_0x235c81(0x304)](_0x25374e=>{telegramError(_0x25374e);});else!validInstallation?tgBot[_0x235c81(0x1f4)](_0x2364d8[_0x235c81(0x1fe)]['id'],_0x235c81(0x2bb))[_0x235c81(0x304)](_0x59eab2=>{telegramError(_0x59eab2);}):(tgBot['sendMessage'](_0x2364d8[_0x235c81(0x1fe)]['id'],_0x235c81(0x31c),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x235c81(0x304)](_0x459944=>{telegramError(_0x459944);}),tgBot['on']('callback_query',async _0x4e64ff=>{const _0x44b6d3=_0x235c81,_0xd22b31=_0x4e64ff[_0x44b6d3(0x2f8)],_0x29f8b9=_0x4e64ff[_0x44b6d3(0x28b)];tgBot['answerCallbackQuery'](_0x4e64ff['id'])[_0x44b6d3(0x258)](async()=>{const _0x4226ee=_0x44b6d3;_0xd22b31==_0x4226ee(0x316)&&(await tgBot[_0x4226ee(0x1f4)](_0x29f8b9[_0x4226ee(0x1fe)]['id'],_0x4226ee(0x1d5))[_0x4226ee(0x304)](_0x4275d8=>{telegramError(_0x4275d8);}),updateBB(_0x4226ee(0x249))),_0xd22b31=='no'&&await tgBot[_0x4226ee(0x1f4)](_0x29f8b9[_0x4226ee(0x1fe)]['id'],_0x4226ee(0x2fc))[_0x4226ee(0x304)](_0x33d356=>{telegramError(_0x33d356);});}),tgBot['removeListener'](_0x44b6d3(0x22a));}));}),tgBot[_0x370f94(0x358)](/\/reinstall/,async _0x15624f=>{const _0x49d36f=_0x370f94;if(!validateTelegram(_0x15624f))return;tgBot[_0x49d36f(0x204)](_0x49d36f(0x22a)),!validInstallation?tgBot[_0x49d36f(0x1f4)](_0x15624f['chat']['id'],_0x49d36f(0x372))[_0x49d36f(0x304)](_0x5418d8=>{telegramError(_0x5418d8);}):(tgBot[_0x49d36f(0x1f4)](_0x15624f[_0x49d36f(0x1fe)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x49d36f(0x316)},{'text':'No','callback_data':'no'}]]}})['catch'](_0xef8a1f=>{telegramError(_0xef8a1f);}),tgBot['on'](_0x49d36f(0x22a),async _0x4abc3a=>{const _0x743d2e=_0x49d36f,_0x35d371=_0x4abc3a[_0x743d2e(0x2f8)],_0x139962=_0x4abc3a[_0x743d2e(0x28b)];tgBot['answerCallbackQuery'](_0x4abc3a['id'])[_0x743d2e(0x258)](async()=>{const _0xc5c8ce=_0x743d2e;_0x35d371=='yes'&&(await tgBot[_0xc5c8ce(0x1f4)](_0x139962[_0xc5c8ce(0x1fe)]['id'],_0xc5c8ce(0x209))[_0xc5c8ce(0x304)](_0x2de512=>{telegramError(_0x2de512);}),updateBB(_0xc5c8ce(0x306))),_0x35d371=='no'&&await tgBot[_0xc5c8ce(0x1f4)](_0x139962[_0xc5c8ce(0x1fe)]['id'],_0xc5c8ce(0x243))[_0xc5c8ce(0x304)](_0x4e515a=>{telegramError(_0x4e515a);});}),tgBot[_0x743d2e(0x204)]('callback_query');}));}),tgBot[_0x370f94(0x358)](/\/toggle/,_0x1f720d=>{const _0xc120ef=_0x370f94;if(!validateTelegram(_0x1f720d))return;tgBot[_0xc120ef(0x204)](_0xc120ef(0x22a));const _0x3bbc29=getBotsWithMode();if(_0x3bbc29[_0xc120ef(0x350)]==0x0)tgBot[_0xc120ef(0x1f4)](_0x1f720d[_0xc120ef(0x1fe)]['id'],_0xc120ef(0x36b))[_0xc120ef(0x304)](_0x6e1e43=>{telegramError(_0x6e1e43);});else{let _0x360fe2=[],_0x18a2b8=[];const _0x304013=0x2;let _0x40dc45=0x0;_0x3bbc29[_0xc120ef(0x2a6)]((_0x272ab9,_0x21c375)=>{const _0x15fa09=_0xc120ef;if(_0x21c375%_0x304013==0x0)_0x18a2b8=[];_0x18a2b8['push']({'text':_0x15fa09(0x29f)+_0x272ab9[_0x15fa09(0x365)]+'\x20('+_0x272ab9[_0x15fa09(0x254)]+')','callback_data':_0x272ab9[_0x15fa09(0x365)]}),_0x21c375%_0x304013==0x0&&(_0x360fe2[_0x40dc45]=_0x18a2b8,_0x40dc45++);}),tgBot[_0xc120ef(0x1f4)](_0x1f720d[_0xc120ef(0x1fe)]['id'],_0xc120ef(0x272),{'reply_markup':{'inline_keyboard':_0x360fe2}})[_0xc120ef(0x304)](_0x21e5d0=>{telegramError(_0x21e5d0);}),tgBot['on'](_0xc120ef(0x22a),async _0x1dcba4=>{const _0x5de2a7=_0xc120ef,_0x519138=_0x1dcba4['data'],_0xc65b0f=_0x1dcba4['message'];tgBot[_0x5de2a7(0x23f)](_0x1dcba4['id'])['then'](async()=>{const _0x4f97f5=_0x5de2a7,_0x22a3af=_0x3bbc29[_0x4f97f5(0x1c5)](_0x146842=>_0x146842['botID']==_0x519138),_0x5ac284=_0x22a3af[_0x4f97f5(0x254)]=='auto'?_0x4f97f5(0x1bf):'auto';tgBot[_0x4f97f5(0x1f4)](_0xc65b0f[_0x4f97f5(0x1fe)]['id'],_0x4f97f5(0x267)+_0x519138+_0x4f97f5(0x2da)+_0x5ac284+_0x4f97f5(0x245))[_0x4f97f5(0x304)](_0x4b6879=>{telegramError(_0x4b6879);}),toggleBotMode(_0x519138);}),tgBot[_0x5de2a7(0x204)]('callback_query');});}}),tgBot[_0x370f94(0x358)](/\/names/,_0x1cdcb5=>{const _0x34df7b=_0x370f94;if(!validateTelegram(_0x1cdcb5))return;let _0x33a2b8='';config[_0x34df7b(0x2a6)](_0x35a7d2=>{const _0x1105d5=_0x34df7b;_0x33a2b8+='Bot\x20'+_0x35a7d2[_0x1105d5(0x365)]+':\x20'+_0x35a7d2['botname']+'\x0a';}),tgBot['sendMessage'](_0x1cdcb5[_0x34df7b(0x1fe)]['id'],_0x33a2b8,{'parse_mode':_0x34df7b(0x1f9)})[_0x34df7b(0x304)](_0x3ad639=>{telegramError(_0x3ad639);});}),tgBot[_0x370f94(0x358)](/\/disable/,_0x50ba59=>{const _0x4d4b2a=_0x370f94;if(!validateTelegram(_0x50ba59))return;tgBot['sendMessage'](_0x50ba59[_0x4d4b2a(0x1fe)]['id'],_0x4d4b2a(0x1da))[_0x4d4b2a(0x304)](_0x3377c2=>{telegramError(_0x3377c2);}),updateSetting(_0x4d4b2a(0x25d),![]);}),tgBot[_0x370f94(0x358)](/\/help/,_0x4705ec=>{const _0x5606fa=_0x370f94;if(!validateTelegram(_0x4705ec))return;tgBot[_0x5606fa(0x1f4)](_0x4705ec[_0x5606fa(0x1fe)]['id'],_0x28ce9c)['catch'](_0x2bf305=>{telegramError(_0x2bf305);});}),tgBot['on']('polling_error',_0x48ab63=>{const _0xb8c4eb=_0x370f94;_0x48ab63[_0xb8c4eb(0x317)]()[_0xb8c4eb(0x1b7)](_0xb8c4eb(0x356))&&(logger[_0xb8c4eb(0x2d1)](_0xb8c4eb(0x341)),tgBot[_0xb8c4eb(0x35f)](),tgBot=null,io['to'](_0xb8c4eb(0x253))[_0xb8c4eb(0x307)](_0xb8c4eb(0x251),_0xb8c4eb(0x341)));}),process['once']('SIGINT',()=>{const _0x1c3e4a=_0x370f94;if(tgBot)tgBot[_0x1c3e4a(0x35f)]();process[_0x1c3e4a(0x264)](0x1);}),process[_0x370f94(0x2c5)](_0x370f94(0x1fc),()=>{const _0x1787e3=_0x370f94;if(tgBot)tgBot['stopPolling']();process[_0x1787e3(0x264)](0x1);});}}function disableTelegram(){const _0x21eca8=_0x31a8d6;tgBot&&(tgBot[_0x21eca8(0x35f)](),tgBot=null);}function sendTelegram(_0x31ee71,_0x36d83){const _0x274673=_0x31a8d6;if(settings[_0x274673(0x25d)]){if(settings['telegramEvents']==_0x274673(0x234)||(_0x36d83[_0x274673(0x201)]==_0x274673(0x1e4)||_0x36d83[_0x274673(0x201)]==_0x274673(0x1f0)||_0x36d83[_0x274673(0x201)]==_0x274673(0x293))&&settings[_0x274673(0x348)]==_0x274673(0x32d)||_0x36d83[_0x274673(0x201)]==_0x274673(0x250)&&settings['telegramEvents']==_0x274673(0x34b)){if(tgBot&&settings[_0x274673(0x335)]){if(_0x36d83[_0x274673(0x369)])tgBot[_0x274673(0x1f4)](settings[_0x274673(0x335)],_0x36d83['botname']+_0x274673(0x2dc)+_0x36d83[_0x274673(0x2e8)])[_0x274673(0x304)](_0x103660=>{telegramError(_0x103660);});else tgBot[_0x274673(0x1f4)](settings[_0x274673(0x335)],_0x274673(0x29f)+_0x31ee71+_0x274673(0x2dc)+_0x36d83[_0x274673(0x2e8)])[_0x274673(0x304)](_0x4afaff=>{telegramError(_0x4afaff);});}}}}async function sendTelegramMsg(_0x2d11e4,_0x4254b0='HTML'){const _0x5ebcda=_0x31a8d6;return settings[_0x5ebcda(0x25d)]&&tgBot&&settings[_0x5ebcda(0x335)]?(await tgBot[_0x5ebcda(0x1f4)](settings[_0x5ebcda(0x335)],_0x2d11e4,{'parse_mode':_0x4254b0})['catch'](_0xd90432=>{telegramError(_0xd90432);}),!![]):![];}function getDeviceWithIp(_0x5866e0){const _0x4fbe23=_0x31a8d6;return devices[_0x4fbe23(0x1c5)](_0x2d5c0a=>_0x2d5c0a['ip']===_0x5866e0);}function temporaryAccess2FA(_0x47f0e4,_0x57cb19){const _0x1a5e73=_0x31a8d6;let _0x22d87b=new Date(),_0x54d33a=![];if(lastIpApproval){if(_0x22d87b-lastIpApproval<0x1388)_0x54d33a=!![];}lastIpApproval=new Date();if(_0x54d33a)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x1a5e73(0x204)]('callback_query'),tgBot[_0x1a5e73(0x1f4)](settings[_0x1a5e73(0x335)],_0x1a5e73(0x2a0)+normalizeIP(_0x57cb19)[_0x1a5e73(0x2c2)]+_0x1a5e73(0x1b3),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1a5e73(0x2b3),'callback_data':'5'},{'text':_0x1a5e73(0x2f3),'callback_data':'15'},{'text':_0x1a5e73(0x35c),'callback_data':'30'},{'text':_0x1a5e73(0x213),'callback_data':_0x1a5e73(0x213)}]]}})[_0x1a5e73(0x304)](_0x1df848=>{telegramError(_0x1df848);}),tgBot['on'](_0x1a5e73(0x22a),async _0x5752fb=>{const _0x510a9f=_0x1a5e73,_0x5e77c1=_0x5752fb[_0x510a9f(0x2f8)],_0x5e5d5d=_0x5752fb[_0x510a9f(0x28b)];tgBot[_0x510a9f(0x23f)](_0x5752fb['id'])[_0x510a9f(0x258)](async()=>{const _0x5625fb=_0x510a9f;devices[_0x47f0e4][_0x5625fb(0x2a8)]={'clientip':_0x57cb19,'timestamp':new Date()['getTime'](),'expiry':_0x5e77c1},_0x5e77c1!=_0x5625fb(0x213)?(await tgBot[_0x5625fb(0x1f4)](_0x5e5d5d[_0x5625fb(0x1fe)]['id'],_0x5625fb(0x35e)+_0x5e77c1+_0x5625fb(0x269),{'parse_mode':_0x5625fb(0x1f9)})[_0x5625fb(0x304)](_0x2965b7=>{telegramError(_0x2965b7);}),io['to'](_0x47f0e4)['emit'](_0x5625fb(0x28c),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x5625fb(0x1f4)](_0x5e5d5d[_0x5625fb(0x1fe)]['id'],_0x5625fb(0x211))['catch'](_0x27b047=>{telegramError(_0x27b047);}),io['to'](_0x47f0e4)[_0x5625fb(0x307)](_0x5625fb(0x28c),{'access':{'allow':![],'reason':_0x5625fb(0x325),'token':null}}));}),tgBot['removeListener'](_0x510a9f(0x22a));}));}function loginAccess2FA(_0x7005b,_0x2e3720){const _0x4d0f2e=_0x31a8d6;tgBot&&settings['telegramChatId']&&(tgBot[_0x4d0f2e(0x204)](_0x4d0f2e(0x22a)),tgBot[_0x4d0f2e(0x1f4)](settings[_0x4d0f2e(0x335)],_0x4d0f2e(0x287)+normalizeIP(_0x2e3720)['show']+'</b>\x20?',{'parse_mode':_0x4d0f2e(0x1f9),'reply_markup':{'inline_keyboard':[[{'text':_0x4d0f2e(0x2a2),'callback_data':loginExpiry},{'text':_0x4d0f2e(0x213),'callback_data':_0x4d0f2e(0x213)}]]}})[_0x4d0f2e(0x304)](_0x3a3edd=>{telegramError(_0x3a3edd);}),tgBot['on'](_0x4d0f2e(0x22a),async _0x598d45=>{const _0x53a62c=_0x4d0f2e,_0x4ff256=_0x598d45['data'],_0x36bd70=_0x598d45[_0x53a62c(0x28b)];tgBot[_0x53a62c(0x23f)](_0x598d45['id'])['then'](async()=>{const _0x4d8351=_0x53a62c;devices[_0x7005b][_0x4d8351(0x30f)]={'clientip':_0x2e3720,'timestamp':new Date()['getTime'](),'expiry':_0x4ff256},_0x4ff256!='reject'?(await tgBot[_0x4d8351(0x1f4)](_0x36bd70['chat']['id'],_0x4d8351(0x33b),{'parse_mode':_0x4d8351(0x1f9)})[_0x4d8351(0x304)](_0x4cafa0=>{telegramError(_0x4cafa0);}),io['to'](_0x7005b)[_0x4d8351(0x307)](_0x4d8351(0x28c),{'access':{'allow':![],'reason':_0x4d8351(0x202),'token':null}})):(await tgBot[_0x4d8351(0x1f4)](_0x36bd70[_0x4d8351(0x1fe)]['id'],'Login\x20rejected')[_0x4d8351(0x304)](_0x5afde8=>{telegramError(_0x5afde8);}),io['to'](_0x7005b)[_0x4d8351(0x307)]('status',{'access':{'allow':![],'reason':_0x4d8351(0x233),'token':null}}));}),tgBot[_0x53a62c(0x204)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x46b8d5=_0x31a8d6;return dbConfig['get'](_0x46b8d5(0x225))[_0x46b8d5(0x1cd)]('botID')['filter']({'status':_0x46b8d5(0x342)})[_0x46b8d5(0x24f)]()||[];}function getDisabledBots(){const _0x494e07=_0x31a8d6;return dbConfig[_0x494e07(0x1f5)](_0x494e07(0x225))['sortBy'](_0x494e07(0x365))[_0x494e07(0x1db)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x38a131){const _0x140884=_0x31a8d6;let _0xe01f03={};const _0x4cf331=configpath+_0x140884(0x2bf)+_0x38a131+'-config.json',_0x2d74a2=fs[_0x140884(0x1af)](_0x4cf331);if(_0x2d74a2){const _0x51b6ba=fs['readFileSync'](_0x4cf331);try{const _0x3e4c09=JSON[_0x140884(0x2b7)](_0x51b6ba),_0x43f3a3=_0x3e4c09?_0x3e4c09[_0x140884(0x224)][0x0][_0x140884(0x281)]:![];_0xe01f03[_0x140884(0x254)]=_0x43f3a3?'auto':_0x140884(0x1bf),_0xe01f03[_0x140884(0x2b9)]=_0x3e4c09?_0x3e4c09[_0x140884(0x224)][0x0][_0x140884(0x2b9)]:'Bot\x20'+_0x38a131;}catch(_0x3e6190){_0xe01f03[_0x140884(0x254)]=_0x140884(0x1bf),_0xe01f03[_0x140884(0x2b9)]=_0x140884(0x29f)+_0x38a131;}}else _0xe01f03['mode']=_0x140884(0x1bf),_0xe01f03['botname']='Bot\x20'+_0x38a131;return _0xe01f03;}function getBotsWithMode(){const _0xcd60e6=_0x31a8d6,_0x3e5cce=dbConfig[_0xcd60e6(0x1f5)](_0xcd60e6(0x225))['sortBy'](_0xcd60e6(0x365))[_0xcd60e6(0x24f)]()||[];return _0x3e5cce[_0xcd60e6(0x2a6)](_0x365a70=>{const _0x2e9e39=_0xcd60e6;let _0x141eab=getBotAttributes(_0x365a70['botID']);_0x365a70['mode']=_0x141eab[_0x2e9e39(0x254)];}),_0x3e5cce;}function getBotExchanges(){const _0x3099d4=_0x31a8d6;let _0x228734=[];const _0x4789fe=dbConfig[_0x3099d4(0x1f5)](_0x3099d4(0x225))[_0x3099d4(0x1cd)](_0x3099d4(0x365))['value']()||[];_0x4789fe[_0x3099d4(0x2a6)](_0x29820d=>{const _0x348cbb=_0x3099d4;if(_0x29820d[_0x348cbb(0x28c)]==_0x348cbb(0x342)){const _0x59c74f=configpath+_0x348cbb(0x2bf)+_0x29820d['botID']+_0x348cbb(0x27a),_0x1996ed=fs[_0x348cbb(0x1af)](_0x59c74f);let _0x4df5a5;if(_0x1996ed){const _0x1e7748=fs['readFileSync'](_0x59c74f);try{const _0x385554=JSON[_0x348cbb(0x2b7)](_0x1e7748);_0x4df5a5=_0x385554?_0x385554[_0x348cbb(0x224)][0x0][_0x348cbb(0x23a)]:null;}catch(_0x2f9b19){}}if(_0x4df5a5)_0x228734[_0x348cbb(0x28d)](_0x4df5a5);}});const _0x4acbbc=[...new Set(_0x228734)]['sort']();return _0x4acbbc;}async function initUser(){const _0x68f607=_0x31a8d6;if(!settings['userid']){const _0x3110ed=uuidRandom();mixpanel[_0x68f607(0x261)](_0x3110ed),updateSetting('userid',_0x3110ed);}}async function initSecure(){const _0x2f3c5a=_0x31a8d6;let _0x524dfe=getSecure();if(!_0x524dfe[_0x2f3c5a(0x1f2)](_0x2f3c5a(0x310))){let _0x1097be=await generateKeys();_0x524dfe[_0x2f3c5a(0x1d3)]=_0x1097be[_0x2f3c5a(0x1d3)],_0x524dfe[_0x2f3c5a(0x1e5)]=_0x1097be[_0x2f3c5a(0x1e5)],_0x524dfe[_0x2f3c5a(0x310)]=crypto[_0x2f3c5a(0x1ee)](0x20)['toString']('hex');;storeSecure(_0x524dfe);}}function getSettings(){const _0x4c39d0=_0x31a8d6;return dbSettings[_0x4c39d0(0x1f5)](_0x4c39d0(0x1f8))[_0x4c39d0(0x24f)]()||{};}function getSecure(){const _0x5f5987=_0x31a8d6;return dbSecure[_0x5f5987(0x1f5)](_0x5f5987(0x1f1))[_0x5f5987(0x24f)]()||{};}function getBlacklist(){const _0x1d3c7f=_0x31a8d6;return dbSecure['get']('blacklist')[_0x1d3c7f(0x24f)]()||[];}function broadcastToBots(_0x1b6793,_0x509bc9){config['forEach'](_0xd8439c=>{const _0x13cf22=_0x4a9b;if(_0xd8439c[_0x13cf22(0x28c)]==_0x13cf22(0x342)&&_0xd8439c[_0x13cf22(0x337)]==_0x13cf22(0x2b8)){if(pid[_0xd8439c[_0x13cf22(0x365)]])pid[_0xd8439c[_0x13cf22(0x365)]]['send']({[_0x1b6793]:_0x509bc9});}});}function storeSettings(_0x2f517e,_0x3147d9=![]){const _0x10e965=_0x31a8d6;_0x2f517e={...settings,..._0x2f517e};if(_0x3147d9&&_0x2f517e[_0x10e965(0x295)]!=_0x10e965(0x26e)&&_0x2f517e[_0x10e965(0x295)]!=_0x10e965(0x364)&&_0x2f517e[_0x10e965(0x295)]!=''){const _0xfd7870=crypt[_0x10e965(0x216)](secure['privateKey'],_0x2f517e[_0x10e965(0x295)])['message'][_0x10e965(0x25f)]('@')[0x0],_0x50e466=bcrypt[_0x10e965(0x2e7)](_0xfd7870,saltRounds);_0x2f517e={..._0x2f517e,'bbPassword':_0x50e466};}if(_0x3147d9&&_0x2f517e[_0x10e965(0x21a)]!=_0x10e965(0x26e)&&_0x2f517e[_0x10e965(0x21a)]!=_0x10e965(0x364)&&_0x2f517e[_0x10e965(0x21a)]!=''){const _0x58a347=crypt['decrypt'](secure[_0x10e965(0x1e5)],_0x2f517e[_0x10e965(0x21a)])[_0x10e965(0x28b)][_0x10e965(0x25f)]('@')[0x0];_0x2f517e={..._0x2f517e,'telegramToken':_0x58a347};}const _0x5522a3=_0x2f517e[_0x10e965(0x21a)]!=_0x10e965(0x26e)&&_0x2f517e[_0x10e965(0x21a)]!=settings[_0x10e965(0x21a)]||_0x2f517e[_0x10e965(0x30d)]!=settings[_0x10e965(0x30d)],_0x101ecb=_0x2f517e[_0x10e965(0x21a)]==''||_0x2f517e['telegramUsername']=='';if(_0x5522a3)_0x2f517e[_0x10e965(0x348)]=_0x10e965(0x234);for(const [_0xc87d45,_0x173f2d]of Object['entries'](_0x2f517e)){if(_0xc87d45==_0x10e965(0x21a)&&_0x173f2d==_0x10e965(0x26e)){_0x2f517e[_0x10e965(0x21a)]=settings[_0x10e965(0x21a)];continue;};if(_0xc87d45==_0x10e965(0x295)&&_0x173f2d==_0x10e965(0x26e)){_0x2f517e['bbPassword']=settings[_0x10e965(0x295)];continue;};dbSettings[_0x10e965(0x2ce)](_0x10e965(0x361)+_0xc87d45,_0x173f2d)[_0x10e965(0x31f)]();}settings=_0x2f517e,io['to']('botmanager')[_0x10e965(0x307)]('settings',cleanSettings()),broadcastToBots(_0x10e965(0x2ea),settings['timeshift']);if(_0x5522a3&&!_0x101ecb)initTelegram();if(_0x5522a3&&_0x101ecb)disableTelegram();getAllClients()[_0x10e965(0x2a6)](_0x496443=>{const _0x4ba36e=_0x10e965;getSocket(_0x496443['id'])[_0x4ba36e(0x307)](_0x4ba36e(0x28c),{'access':{'allow':![],'reason':_0x4ba36e(0x202),'token':null}});});}function updateSetting(_0x374e6c,_0x1b0797){const _0x506eb7=_0x31a8d6;dbSettings[_0x506eb7(0x2ce)](_0x506eb7(0x361)+_0x374e6c,_0x1b0797)[_0x506eb7(0x31f)](),settings=getSettings(),io['to'](_0x506eb7(0x253))['emit'](_0x506eb7(0x1f8),cleanSettings());}function storeSecure(_0x3997e1){const _0x9eb21a=_0x31a8d6;dbSecure[_0x9eb21a(0x1f5)](_0x9eb21a(0x1f1))[_0x9eb21a(0x28d)](_0x3997e1)['write'](),secure=_0x3997e1;}function addBlacklist(_0x15928e){const _0x415183=_0x31a8d6;cleanBlacklist();let _0x57e369;devices[_0x15928e][_0x415183(0x2a8)]?_0x57e369=Math[_0x415183(0x340)](devices[_0x15928e]['telegramIpApproval'][_0x415183(0x2e1)],loginExpiry):_0x57e369=loginExpiry,dbSecure['get'](_0x415183(0x29b))[_0x415183(0x28d)]({'expiry':new Date()[_0x415183(0x2b6)]()+_0x57e369*0x3c*0x3e8,'token':devices[_0x15928e][_0x415183(0x32e)][_0x415183(0x2be)]})[_0x415183(0x31f)](),blacklist=dbSecure[_0x415183(0x1f5)](_0x415183(0x29b))[_0x415183(0x24f)]();}function cleanBlacklist(){const _0x3a31c5=_0x31a8d6;let _0x4a29a2=dbSecure['get']('blacklist')['cloneDeep']()[_0x3a31c5(0x24f)](),_0x4dd977=new Date()[_0x3a31c5(0x2b6)]();_0x4a29a2[_0x3a31c5(0x2a6)](_0x1e5ac3=>{const _0x3d69da=_0x3a31c5;_0x1e5ac3[_0x3d69da(0x2e1)]<_0x4dd977&&dbSecure[_0x3d69da(0x1f5)]('blacklist')[_0x3d69da(0x339)]({'expiry':_0x1e5ac3['expiry']})[_0x3d69da(0x31f)]();});}function initStates(){let _0x194484=getConfiguration();_0x194484['forEach'](_0x33e441=>{const _0x3649b7=_0x4a9b;_0x33e441[_0x3649b7(0x337)]='stopped';}),storeConfiguration(_0x194484);}function onKeys(){const _0x87dd29=new RSA();return new Promise(_0x49441d=>{const _0x5e998c=_0x4a9b;_0x87dd29[_0x5e998c(0x31a)]()[_0x5e998c(0x258)](_0x195ed0=>{_0x49441d(_0x195ed0);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2d52f8=_0x31a8d6;let _0x567ef4=getSettings(),_0x2a154b=![];!_0x567ef4[_0x2d52f8(0x1f2)](_0x2d52f8(0x2d5))&&(_0x567ef4['lastmsgtelegram']=0x0,_0x2a154b=!![]);!_0x567ef4[_0x2d52f8(0x1f2)](_0x2d52f8(0x2d7))&&(_0x567ef4[_0x2d52f8(0x2d7)]=0x0,_0x2a154b=!![]);!_0x567ef4['hasOwnProperty']('latestversion')&&(_0x567ef4[_0x2d52f8(0x271)]='0.0.0',_0x2a154b=!![]);if(_0x2a154b)storeSettings(_0x567ef4);}function storeConfiguration(_0x4c97d8){const _0x740f95=_0x31a8d6;dbConfig['get'](_0x740f95(0x225))[_0x740f95(0x339)]()[_0x740f95(0x31f)](),_0x4c97d8['forEach'](_0x52ff4f=>{const _0x5a8bed=_0x740f95;delete _0x52ff4f[_0x5a8bed(0x254)];}),dbConfig[_0x740f95(0x1f5)](_0x740f95(0x225))['push'](..._0x4c97d8)[_0x740f95(0x31f)](),config=_0x4c97d8;}function resetPassword(){const _0x5c2ad3=_0x31a8d6;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x5c2ad3(0x22a)),tgBot['sendMessage'](settings[_0x5c2ad3(0x335)],_0x5c2ad3(0x1f6),{'parse_mode':_0x5c2ad3(0x1f9),'reply_markup':{'inline_keyboard':[[{'text':_0x5c2ad3(0x316),'callback_data':_0x5c2ad3(0x316)},{'text':'no','callback_data':'no'}]]}})[_0x5c2ad3(0x304)](_0x3962e0=>{telegramError(_0x3962e0);}),tgBot['on'](_0x5c2ad3(0x22a),async _0x20e8f5=>{const _0x1038da=_0x5c2ad3,_0x223a04=_0x20e8f5['data'],_0x1de179=_0x20e8f5['message'];tgBot[_0x1038da(0x23f)](_0x20e8f5['id'])[_0x1038da(0x258)](async()=>{const _0x1e7859=_0x1038da;if(_0x223a04!='no'){const _0x499983=0xf,_0x2f13ee=_0x1e7859(0x296),_0x8be199=Array[_0x1e7859(0x1ac)](crypto['randomFillSync'](new Uint32Array(_0x499983)))['map'](_0x3b753c=>_0x2f13ee[_0x3b753c%_0x2f13ee['length']])['join'](''),_0x4a9c37=bcrypt['hashSync'](_0x8be199,saltRounds);storeSettings({'bbPassword':_0x4a9c37}),await tgBot[_0x1e7859(0x1f4)](_0x1de179[_0x1e7859(0x1fe)]['id'],_0x1e7859(0x208)+_0x8be199,{'parse_mode':'HTML'})[_0x1e7859(0x304)](_0x20ddc1=>{telegramError(_0x20ddc1);});}else await tgBot['sendMessage'](_0x1de179[_0x1e7859(0x1fe)]['id'],_0x1e7859(0x370))['catch'](_0x3cf8ca=>{telegramError(_0x3cf8ca);});}),tgBot[_0x1038da(0x204)](_0x1038da(0x22a));}));}async function confirmRestore(_0x204be5,_0x370933){const _0x44847e=_0x31a8d6;io['to'](_0x44847e(0x253))['emit'](_0x44847e(0x251),_0x44847e(0x315),_0x44847e(0x293)),tgBot&&settings[_0x44847e(0x335)]&&(tgBot[_0x44847e(0x204)](_0x44847e(0x22a)),await tgBot['sendMessage'](settings[_0x44847e(0x335)],_0x44847e(0x200),{'parse_mode':_0x44847e(0x1f9),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x44847e(0x316)},{'text':'no','callback_data':'no'}]]}})[_0x44847e(0x304)](_0x224bef=>{telegramError(_0x224bef);}),tgBot['on'](_0x44847e(0x22a),async _0x22c01d=>{const _0x9a626=_0x44847e,_0x28e509=_0x22c01d['data'],_0x284764=_0x22c01d[_0x9a626(0x28b)];tgBot[_0x9a626(0x23f)](_0x22c01d['id'])[_0x9a626(0x258)](async()=>{const _0x403bc1=_0x9a626;_0x28e509==_0x403bc1(0x316)?(await tgBot[_0x403bc1(0x1f4)](_0x284764['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x403bc1(0x1f9)})['catch'](_0x113e38=>{telegramError(_0x113e38);}),unzipFile(_0x204be5,_0x370933)):(logger['debug']('Restore\x20process\x20aborted'),await tgBot[_0x403bc1(0x1f4)](_0x284764[_0x403bc1(0x1fe)]['id'],'Restore\x20process\x20aborted')[_0x403bc1(0x304)](_0x13b01d=>{telegramError(_0x13b01d);}));}),tgBot['removeListener'](_0x9a626(0x22a));}));}function getServerTime(){const _0x42b0ae=_0x31a8d6,_0x232deb=new Date();return _0x232deb[_0x42b0ae(0x1ff)]()+'/'+(_0x232deb[_0x42b0ae(0x2f9)]()+0x1)[_0x42b0ae(0x317)]()[_0x42b0ae(0x260)](0x2,'0')+'/'+_0x232deb['getDate']()[_0x42b0ae(0x317)]()[_0x42b0ae(0x260)](0x2,'0')+'\x20'+_0x232deb[_0x42b0ae(0x24c)]()['toString']()[_0x42b0ae(0x260)](0x2,'0')+':'+_0x232deb[_0x42b0ae(0x1df)]()['toString']()[_0x42b0ae(0x260)](0x2,'0')+':'+_0x232deb[_0x42b0ae(0x30c)]()[_0x42b0ae(0x317)]()[_0x42b0ae(0x260)](0x2,'0');}function _0x1deb(){const _0x43ac3f=['error\x20while\x20deleting\x20config\x20files:\x20','argv','then','get-messages','join','path','fork','telegramEnabled','allow','split','padStart','alias','Ok,\x20will\x20send\x20alert\x20notifications\x20only','updatebotmanager','exit','rmSync','deleted\x20Bot\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','backup','\x20minutes','backup-full@','disconnect','Server','Unauthorized\x20attempt\x20to\x20get\x20messages','************','Notifications\x20types:\x20','crypto','latestversion','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','simple','any','store-configuration','test','referer','/on\x20-\x20start\x20bot(s)\x0a','Failed\x20to\x20download\x20','-config.json','Unauthorized\x20attempt\x20to\x20update\x20bot','Token\x20blacklisted','/:bot/history','get-backup-files',',\x20must\x20be\x20a\x204\x20digit\x20number','keys','headless','express-fileupload','restart','confirm-message','sort','new','Allow\x20login\x20from\x20IP\x20address\x20<b>','ipc','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20get\x20logs','message','status','push','/:bot/performance','listen','update-bot','disabled','copyFileSync','success','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','bbPassword','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','stringify','stopped','tkn','restarting\x20Bot\x20','blacklist','/:bot/portfolio','timestamp','logout','Bot\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','match','accept','static','RSA-OAEP','mixpanel','forEach','loginRequired','telegramIpApproval','output-000.log','date-fns','reason','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','handshake','readdirSync','All','username','Alerts','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','5\x20min','invalid\x20credentials','/:bot/coins','getTime','parse','running','botname','/output-000.log','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','bbUsername','Bot\x20Mgr\x20>\x20','token','bot-','kill','toIPv4MappedAddress','show','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','createWriteStream','once','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','password','exp','whitelistEnabled','mtime','isValid','(((.+)+)+)+$','file','set','number','/status\x20-\x20show\x20bot(s)\x20status\x0a','full','/:bot','\x20(1)','emitHistory','lastmsgtelegram','2FA\x20login\x20required','lastmsgemitted','connected','Starting\x20Balance\x20Bot\x20','\x20to\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','\x20>\x20','mkdirSync','\x20|\x20','f2aRequired','size','expiry','getUTCHours','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Restore\x20backup\x20file\x20','disabled\x20Bot\x20','apiKey','hashSync','event','17720NCxIpD','timeshift','File\x20uploaded','whitelist','http','Unauthorized\x20attempt\x20to\x20store\x20configuration','login\x20not\x20required','backup-full.zip','getDate','-results.json','15\x20min','pidExpireLogin','showConfig','host','compareSync','data','getMonth','auth','exec','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','backup-full','uuid-random','hybrid-crypto-js','1000','temporary\x20token\x20generated','0.0.0','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','catch','Invalid\x20authentication\x20token\x20(2)','reinstall','emit','RSA','login\x20token\x20generated','starting\x20new\x20bot\x20|\x20Bot\x20','post','getSeconds','telegramUsername','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','telegram2FaApproval','secret','2FA\x20required','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','-----------------------------------------------------------------------------------','node-telegram-bot-api','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','yes','toString','login\x20token\x20valid','Invalid\x20username\x20or\x20IP\x20address','generateKeyPairAsync','66OakRDi','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','469810xHKWfz','storeConfiguration','write','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','unlinkSync','writeFileSync','reset-password','ipaddr.js','temporary\x20access\x20rejected','get-starting-balances','cancel-loading','axios','generate','add','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','pidRefreshToken','alerts','access','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','track','backup/','telegrammsg','All\x20bots\x20running\x20right\x20now','get-logs','telegramChatId','child_process','live','build','remove','show-config','Login\x20accepted','api-eu.mixpanel.com','Unauthorized\x20attempt\x20to\x20download\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','delete-alerts','max','Invalid\x20Telegram\x20token','enabled','login','clients','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','socket.io','DEFLATE','telegramEvents','16932NdwdQF','\x20(2)','orders','log','/:bot/support','socket','readFileSync','length','-performance.json','isDirectory','stop','147SnLbQz','apiSecret','404\x20Not\x20Found','2FA\x20login\x20token\x20generated','onText','output-002.log','140136kWhxZw','https://api.ipify.org?format=json','30\x20min','version','Access\x20enabled\x20for\x20','stopPolling','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','settings.','initclient','.zip','***','botID','jsonwebtoken','logs/','Unauthorized\x20attempt\x20to\x20update\x20settings','showname','toIPv4Address','No\x20bots\x20running\x20right\x20now','/update\x20-\x20update\x20Balance\x20Bot\x0a','use','clientip','bbvReceive','Password\x20reset\x20rejected','assign','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','from','build2','sendFile','existsSync','temp/','::ffff:127.0.0.1','new-disabled','</b>\x20?','bb-secure.json','_data','bb/','includes','uncaughtException','reinstall-bb','inherit','starting\x20bot\x20|\x20Bot\x20','uuid','encryptedUuid',':\x20Bot\x20Mgr\x20>\x20','manual','node-zip','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','2634834cXsqYl','storeHeadless','find','update-bb','110JiUnim','cancelLoading','logs','Invalid\x20authentication\x20token\x20(1)','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','enabled\x20Bot\x20','sortBy','min','slice','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','format','ipv6','publicKey','search','Starting\x20Balance\x20Bot\x20update','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','yargs/yargs','params','Notifications\x20disabled','filter','index.html','files','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getMinutes','Error:\x20Invalid\x20argument\x20','messages','bb-settings.json','752013SeaVYf','error','privateKey','conn','headers','store-settings','version.json','defaults','toggleBotMode','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','zip/','randomBytes','isIPv4MappedAddress','warning','secure','hasOwnProperty','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','sendMessage','get','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','remoteAddress','settings','HTML','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','graphql-request','SIGTERM','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','chat','getFullYear','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','type','reload','sockets','removeListener','4401980OcgBrx','send','/off\x20-\x20stop\x20bot(s)\x0a','Password\x20has\x20been\x20reset\x20to:\x20','Starting\x20Balance\x20Bot\x20reinstallation','All\x20bots','function','Invalid\x20IP\x20address','removeAllListeners','delete-bot','login\x20required','2FA','Temporary\x20access\x20rejected','sign','reject','debug','NTBA_FIX_319','decrypt','get-portfolio','verify','sha256','telegramToken','Crypt','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','6b67f3d61ee94b8f5c80b4affef4c4d9','output-001.log','replace','/upload-backup','express','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','bot.js','bot','bots','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','name','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','callback_query','Unauthorized\x20attempt\x20to\x20add\x20bot','store','statSync','env','::1','/:bot/configuration','backup-files','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','2FA\x20login\x20rejected','all','No\x20authentication\x20token','config/','started','logged\x20out','Notifications\x20disabled\x0a','exchange','sendPortfolioTelegram','binary','request','access\x20timeout','answerCallbackQuery','output-003.log','connection','3000','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','temporary\x20access\x20not\x20allowed','\x20mode','Unauthorized\x20attempt\x20to\x20delete\x20alerts','<b>Telegram\x20Bot\x20Status:</b>\x0a','store-headless','update','bbvNew','args','getHours','restore-backup-file','Markdown','value','order','notification','createServer','botmanager','mode','temporary\x20access\x20timeout'];_0x1deb=function(){return _0x43ac3f;};return _0x1deb();}function getTimeStamp(){const _0x152975=_0x31a8d6,_0x22b5e3=shiftedTime();return _0x22b5e3['getFullYear']()+'/'+(_0x22b5e3[_0x152975(0x2f9)]()+0x1)[_0x152975(0x317)]()['padStart'](0x2,'0')+'/'+_0x22b5e3[_0x152975(0x2f1)]()[_0x152975(0x317)]()['padStart'](0x2,'0')+'\x20'+_0x22b5e3['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x22b5e3['getMinutes']()[_0x152975(0x317)]()[_0x152975(0x260)](0x2,'0')+':'+_0x22b5e3[_0x152975(0x30c)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x14685c=_0x31a8d6,_0x946a94=shiftedTime();return _0x946a94[_0x14685c(0x1ff)]()+(_0x946a94[_0x14685c(0x2f9)]()+0x1)[_0x14685c(0x317)]()['padStart'](0x2,'0')+_0x946a94[_0x14685c(0x2f1)]()['toString']()[_0x14685c(0x260)](0x2,'0')+'-'+_0x946a94[_0x14685c(0x24c)]()['toString']()['padStart'](0x2,'0')+_0x946a94[_0x14685c(0x1df)]()[_0x14685c(0x317)]()[_0x14685c(0x260)](0x2,'0')+_0x946a94[_0x14685c(0x30c)]()['toString']()[_0x14685c(0x260)](0x2,'0');}function shiftedTime(){const _0x23a41a=_0x31a8d6,_0x4922cf=new Date();let _0x41bcda=_0x4922cf;if(settings[_0x23a41a(0x2ea)]&&settings[_0x23a41a(0x2ea)]!==0x0)_0x41bcda=fns[_0x23a41a(0x32a)](_0x4922cf,{'hours':settings['timeshift']});return _0x41bcda;}function _0x4a9b(_0x416e89,_0x151a57){const _0x5d6ec5=_0x1deb();return _0x4a9b=function(_0x1eff5c,_0x8dca57){_0x1eff5c=_0x1eff5c-0x1ac;let _0x1deb4a=_0x5d6ec5[_0x1eff5c];return _0x1deb4a;},_0x4a9b(_0x416e89,_0x151a57);}function startScheduler(){const _0x43a0ca=_0x31a8d6,_0x3227fe=new Date()[_0x43a0ca(0x2e2)](),_0x1842c0=shiftedTime()['getHours']();_0x1842c0==0x4&&backupConfigFiles();_0x1842c0==0x0&&rotateLogFiles();_0x3227fe%0x6==0x0&&triggerAnalytics();_0x3227fe%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3a15ae){const _0x28f264=_0x31a8d6;logger[_0x28f264(0x214)](_0x28f264(0x2e4)+_0x3a15ae);const _0x6fc9d5=getBotsWithMode();_0x6fc9d5[_0x28f264(0x350)]>0x0?confirmRestore(configbackuppath,_0x3a15ae):unzipFile(configbackuppath,_0x3a15ae);}async function getBackupFiles(_0x23f870=null){const _0x38a477=_0x31a8d6;let _0x2fa5bc=[],_0x5f24a0=fs[_0x38a477(0x2ae)](configbackuppath,{'withFileTypes':!![]});_0x5f24a0[_0x38a477(0x285)]((_0x43f398,_0x2a0874)=>_0x43f398['name']<_0x2a0874[_0x38a477(0x228)]?0x1:_0x2a0874[_0x38a477(0x228)]<_0x43f398[_0x38a477(0x228)]?-0x1:0x0),_0x5f24a0[_0x38a477(0x2a6)](_0x2124cb=>{const _0x2c985d=_0x38a477;if(!_0x2124cb[_0x2c985d(0x352)]()){const _0x37c8cc=formatDate(fs[_0x2c985d(0x22d)](configbackuppath+_0x2124cb[_0x2c985d(0x228)])[_0x2c985d(0x2ca)]);_0x2fa5bc[_0x2c985d(0x28d)]({'name':_0x2124cb['name'],'mtime':_0x37c8cc});}});if(_0x23f870)io['to'](_0x23f870)[_0x38a477(0x307)](_0x38a477(0x231),_0x2fa5bc);else return _0x2fa5bc;}async function backupConfigFiles(){const _0x163350=_0x31a8d6;await zipFiles(_0x163350(0x2fd));const _0x1a7d40=getCleanTimeStamp();fs[_0x163350(0x292)](zippath+_0x163350(0x2f0),configbackuppath+(_0x163350(0x26a)+_0x1a7d40+'.zip'));let _0x3f65d3=fs[_0x163350(0x2ae)](configbackuppath,{'withFileTypes':!![]});_0x3f65d3[_0x163350(0x285)]((_0x335491,_0x17f714)=>_0x335491[_0x163350(0x228)]<_0x17f714[_0x163350(0x228)]?0x1:_0x17f714[_0x163350(0x228)]<_0x335491[_0x163350(0x228)]?-0x1:0x0),_0x3f65d3[_0x163350(0x350)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x3f65d3[maxBackups][_0x163350(0x228)]);}function rotateLogFiles(){const _0x29861a=_0x31a8d6,_0x504116=fs[_0x29861a(0x22d)](logspath+'output-000.log'),_0x5aa083=_0x504116[_0x29861a(0x2e0)]/0x400;if(_0x5aa083>0x32){let _0x4e1488=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x4e1488[_0x29861a(0x285)]((_0x5cd51d,_0x5d49de)=>_0x5cd51d[_0x29861a(0x228)]<_0x5d49de[_0x29861a(0x228)]?0x1:_0x5d49de[_0x29861a(0x228)]<_0x5cd51d[_0x29861a(0x228)]?-0x1:0x0),_0x4e1488[_0x29861a(0x2a6)](_0x1b4490=>{const _0x5cb70a=_0x29861a;if(_0x1b4490[_0x5cb70a(0x228)]==_0x5cb70a(0x359))fs[_0x5cb70a(0x292)](logspath+_0x1b4490[_0x5cb70a(0x228)],logspath+_0x5cb70a(0x240));if(_0x1b4490[_0x5cb70a(0x228)]=='output-001.log')fs[_0x5cb70a(0x292)](logspath+_0x1b4490['name'],logspath+_0x5cb70a(0x359));_0x1b4490['name']==_0x5cb70a(0x2a9)&&(fs['copyFileSync'](logspath+_0x1b4490[_0x5cb70a(0x228)],logspath+_0x5cb70a(0x21e)),fs[_0x5cb70a(0x322)](logspath+_0x1b4490[_0x5cb70a(0x228)],''));});}}async function zipFiles(_0x23abf2){const _0x4e3b17=_0x31a8d6;let _0x16cb37;if(_0x23abf2==_0x4e3b17(0x1c9))_0x16cb37=logspath;if(_0x23abf2==_0x4e3b17(0x268))_0x16cb37=configpath;if(_0x23abf2==_0x4e3b17(0x2fd))_0x16cb37=configpath;let _0xd8461=fs[_0x4e3b17(0x2ae)](_0x16cb37,{'withFileTypes':!![]});const _0x2880fa=new require(_0x4e3b17(0x1c0))();_0xd8461[_0x4e3b17(0x2a6)](_0x47dfca=>{const _0x1e97f9=_0x4e3b17;if(!_0x47dfca[_0x1e97f9(0x352)]()){let _0x37e2e6=fs[_0x1e97f9(0x34f)](_0x16cb37+_0x47dfca[_0x1e97f9(0x228)]);if(_0x23abf2==_0x1e97f9(0x268)){const _0x75d7e2=/^bot-[0-9]{3}-config.json$/,_0x2f94c6=_0x75d7e2[_0x1e97f9(0x276)](_0x47dfca[_0x1e97f9(0x228)]);if(_0x2f94c6){const _0x511318=JSON[_0x1e97f9(0x2b7)](_0x37e2e6);_0x511318[_0x1e97f9(0x224)][0x0]&&(_0x511318[_0x1e97f9(0x224)][0x0][_0x1e97f9(0x2e6)]=_0x1e97f9(0x364),_0x511318[_0x1e97f9(0x224)][0x0][_0x1e97f9(0x355)]=_0x1e97f9(0x364)),_0x37e2e6=JSON[_0x1e97f9(0x297)](_0x511318,null,0x2);}if(_0x47dfca[_0x1e97f9(0x228)]==_0x1e97f9(0x1e2)){const _0x1e7215=JSON[_0x1e97f9(0x2b7)](_0x37e2e6);if(_0x1e7215[_0x1e97f9(0x1f8)][_0x1e97f9(0x2a7)])_0x1e7215[_0x1e97f9(0x1f8)][_0x1e97f9(0x2a7)]=![];if(_0x1e7215[_0x1e97f9(0x1f8)]['bbPassword'])_0x1e7215['settings'][_0x1e97f9(0x295)]='***';if(_0x1e7215['settings']['telegramToken'])_0x1e7215[_0x1e97f9(0x1f8)]['telegramToken']='***';if(_0x1e7215['settings'][_0x1e97f9(0x335)])_0x1e7215[_0x1e97f9(0x1f8)][_0x1e97f9(0x335)]=null;_0x37e2e6=JSON[_0x1e97f9(0x297)](_0x1e7215,null,0x2);}if(_0x47dfca[_0x1e97f9(0x228)]!=_0x1e97f9(0x1b4))_0x2880fa[_0x1e97f9(0x2cd)](_0x47dfca[_0x1e97f9(0x228)],_0x37e2e6);}else _0x2880fa['file'](_0x47dfca[_0x1e97f9(0x228)],_0x37e2e6);}});const _0xfc0406=_0x2880fa[_0x4e3b17(0x329)]({'base64':![],'compression':_0x4e3b17(0x347)});fs['writeFileSync'](zippath+(_0x23abf2+_0x4e3b17(0x363)),_0xfc0406,_0x4e3b17(0x23c));}async function unzipFile(_0x4a36d2,_0x5e42c7){const _0x468a13=_0x31a8d6;fs[_0x468a13(0x2ae)](configpath,{'withFileTypes':!![]})[_0x468a13(0x2a6)](_0x1397ec=>{const _0x204e24=_0x468a13;if(!_0x1397ec['isDirectory']())fs[_0x204e24(0x265)](configpath+_0x1397ec[_0x204e24(0x228)]);});const _0x286abc=fs[_0x468a13(0x34f)](_0x4a36d2+_0x5e42c7,_0x468a13(0x23c)),_0x4598e3=new require('node-zip')(_0x286abc,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x4598e3['files'])[_0x468a13(0x2a6)](_0x503c53=>{const _0x2ffff6=_0x468a13,_0x51888a=_0x4598e3[_0x2ffff6(0x1dd)][_0x503c53];fs[_0x2ffff6(0x322)](configpath+_0x51888a[_0x2ffff6(0x228)],_0x51888a[_0x2ffff6(0x1b5)]);}),fs[_0x468a13(0x2ae)](temppath,{'withFileTypes':!![]})[_0x468a13(0x2a6)](_0x5bcd08=>{const _0x4db819=_0x468a13;if(!_0x5bcd08[_0x4db819(0x352)]())fs['rmSync'](temppath+_0x5bcd08[_0x4db819(0x228)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x468a13(0x206)]({'restore':!![]},_0x13c935=>{});}async function getPublicIp(){const _0xae0494=_0x31a8d6;try{const _0xa86b1a=await axios[_0xae0494(0x1f5)](_0xae0494(0x35b));publicip=_0xa86b1a[_0xae0494(0x2f8)]['ip'];}catch(_0x14b01d){}}async function triggerAnalytics(){const _0x3eb8d4=_0x31a8d6;if(!publicip)await getPublicIp();const _0x453b49=getBotsWithMode();let _0x412ad2=0x0;_0x453b49[_0x3eb8d4(0x2a6)](_0x593f70=>{const _0x2ebdc7=_0x3eb8d4;if(_0x593f70[_0x2ebdc7(0x28c)]===_0x2ebdc7(0x342))_0x412ad2++;});const _0x3a7ebb=getBotExchanges();mixpanel[_0x3eb8d4(0x330)](_0x3eb8d4(0x26c),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x453b49['length'],'numbotsenabled':_0x412ad2,'exchanges':_0x3a7ebb});}async function getMessages(){const _0x42c3ab=_0x31a8d6,_0x57c914=_0x42c3ab(0x2c6),_0x550a13=new GraphQLClient(_0x57c914),_0x1a68d2={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x6ca5af=serverversion[_0x42c3ab(0x25f)]('.'),_0x272c6b=_0x6ca5af[0x0]+'.'+_0x6ca5af[0x1],_0x5ad8bf=Math[_0x42c3ab(0x1ce)](settings[_0x42c3ab(0x2d5)],settings['lastmsgemitted']),_0x1174a7={'last':parseInt(_0x5ad8bf),'bbm':_0x272c6b},_0x110bd9=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xa1eb8d;try{_0xa1eb8d=await _0x550a13[_0x42c3ab(0x23d)](_0x110bd9,_0x1174a7,_0x1a68d2);}catch(_0x2b554f){}if(_0xa1eb8d&&_0xa1eb8d[_0x42c3ab(0x1e1)]){let _0x3ac312=settings[_0x42c3ab(0x2d5)];newMessages=[];for(const _0x1db762 of _0xa1eb8d[_0x42c3ab(0x1e1)]){newMessages[_0x42c3ab(0x28d)](_0x1db762);if(_0x1db762['bbvNew'])updateSetting('latestversion',_0x1db762[_0x42c3ab(0x24a)]);let _0x35f451=_0x1db762[_0x42c3ab(0x24a)]?serverversion>=_0x1db762[_0x42c3ab(0x24a)]:![];if(!_0x35f451&&_0x1db762[_0x42c3ab(0x2cf)]>_0x3ac312){if(_0x1db762[_0x42c3ab(0x36f)]===_0x42c3ab(0x274)||serverversion['startsWith'](_0x1db762['bbvReceive'])){let _0x56ffb9=''+_0x1db762['title']+'\x0a\x0a'+_0x1db762[_0x42c3ab(0x28b)];const _0xb10e6a=await sendTelegramMsg(toTelegramMarkdown(_0x56ffb9),_0x42c3ab(0x24e));if(_0xb10e6a)_0x3ac312=_0x1db762[_0x42c3ab(0x2cf)];}}}updateAvailable=isNewerVersion(settings[_0x42c3ab(0x271)],serverversion),updateSetting(_0x42c3ab(0x2d5),_0x3ac312),emitMessages();}}function emitMessages(){const _0x3a7999=_0x31a8d6,_0x3ca66f=settings[_0x3a7999(0x2d7)];let _0x12b5e6=[];newMessages[_0x3a7999(0x2a6)](_0x22543f=>{const _0x4b7f92=_0x3a7999;_0x22543f[_0x4b7f92(0x2cf)]>_0x3ca66f&&_0x12b5e6['push'](_0x22543f);}),_0x12b5e6['length']>0x0&&getAllClients()['forEach'](_0x2237b2=>{const _0x3f18a6=_0x3a7999;getSocket(_0x2237b2['id'])[_0x3f18a6(0x307)](_0x3f18a6(0x28b),_0x12b5e6);});}function confirmMessage(_0x542c3e){updateSetting('lastmsgemitted',Number(_0x542c3e));}function isNewerVersion(_0x47960d,_0x2799a5){const _0x5ce465=_0x31a8d6,_0x2b4a0c=_0x2799a5[_0x5ce465(0x25f)]('.'),_0x456be=_0x47960d[_0x5ce465(0x25f)]('.');for(var _0x2761db=0x0;_0x2761db<_0x456be[_0x5ce465(0x350)];_0x2761db++){const _0x22075b=~~_0x456be[_0x2761db],_0x58092d=~~_0x2b4a0c[_0x2761db];if(_0x22075b>_0x58092d)return!![];if(_0x22075b<_0x58092d)return![];}return![];}function toTelegramMarkdown(_0x2187d5){const _0xea5ba2=_0x31a8d6,_0x5608da=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x242491=/\*{2}(.+?)\*{2}/gim;return _0x2187d5=_0x2187d5[_0xea5ba2(0x21f)](_0x5608da,'$1_$2_$3')[_0xea5ba2(0x21f)](_0x242491,'*$1*'),_0x2187d5;}async function validateConfigFile(){const _0x4842bf=_0x31a8d6,_0x4d29e8=dbConfig[_0x4842bf(0x1f5)](_0x4842bf(0x225))['sortBy']('botID')[_0x4842bf(0x24f)]()||[];if(_0x4d29e8[_0x4842bf(0x350)]==0x0){let _0xc390d7=0x0,_0x13979c=[];const _0x3448fe=/^bot-([0-9]{3})-config.json$/,_0x34b4c9=fs['readdirSync'](configpath);_0x34b4c9[_0x4842bf(0x2a6)](_0x1bc0d0=>{const _0x5eddf7=_0x4842bf,_0x6b6fdb=_0x3448fe[_0x5eddf7(0x2fb)](_0x1bc0d0);if(_0x6b6fdb){const _0x212ab7=_0x6b6fdb[0x1];let _0x1551aa=getBotAttributes(_0x212ab7);_0x13979c[_0x5eddf7(0x28d)]({'botID':_0x212ab7,'botname':_0x1551aa[_0x5eddf7(0x2b9)],'status':_0x5eddf7(0x291),'live':_0x5eddf7(0x298)}),_0xc390d7++;}}),_0xc390d7!=0x0&&(dbConfig[_0x4842bf(0x1f5)](_0x4842bf(0x225))[_0x4842bf(0x371)](_0x13979c)[_0x4842bf(0x31f)](),config=_0x13979c,restoredConfigFile=_0xc390d7);}}async function restoreConfigNotify(_0x39a0e7){const _0x4633ad=_0x31a8d6;let _0x54e2be;if(restoredConfigFile==0x1)_0x54e2be=_0x4633ad(0x312);else _0x54e2be=_0x4633ad(0x1ec);if(_0x39a0e7)io['to'](_0x4633ad(0x253))[_0x4633ad(0x307)](_0x4633ad(0x251),_0x54e2be);else{logger['simple'](_0x4633ad(0x313)),logger['simple'](_0x54e2be),logger[_0x4633ad(0x273)](_0x4633ad(0x313)),logger[_0x4633ad(0x273)]('');if(tgBot&&settings[_0x4633ad(0x335)]&&settings['telegramEvents']!=_0x4633ad(0x34b))tgBot[_0x4633ad(0x1f4)](settings[_0x4633ad(0x335)],_0x4633ad(0x2bd)+_0x54e2be)[_0x4633ad(0x304)](_0x5b5933=>{telegramError(_0x5b5933);});}}function validateCredentials(_0xc99cca,_0x5c09e3){const _0x274ab2=_0x31a8d6;if(_0xc99cca['username']==settings[_0x274ab2(0x2bc)]&&bcrypt[_0x274ab2(0x2f7)](_0xc99cca[_0x274ab2(0x2c7)],settings['bbPassword'])){if(settings[_0x274ab2(0x2df)])return{'allow':![],'reason':_0x274ab2(0x2d6),'token':null};else{const _0x2e1309=generateLoginToken(_0x5c09e3);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2e1309};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x4a5844){const _0x27e9ee=_0x31a8d6,_0x5d0f47=generateLoginToken(_0x4a5844);return{'allow':!![],'reason':_0x27e9ee(0x309),'token':_0x5d0f47};}function validateAccess(_0x30173d,_0x40d239,_0x27ed7e){const _0x2e73a3=_0x31a8d6,_0x14adb9=_0x27ed7e?_0x27ed7e:devices[_0x40d239]['ip'];let _0x297ede;const _0x1894b8=_0x1c39e0=>{const _0x21bf95=_0x4a9b;if(settings[_0x21bf95(0x2a7)]){if(settings[_0x21bf95(0x2df)]){if(telegram2FaApproved(_0x40d239)){const _0x5af11f=generateLoginToken(_0x40d239);return{'allow':!![],'reason':_0x21bf95(0x357),'token':_0x5af11f};}else return{'allow':![],'reason':_0x21bf95(0x20f),'token':null};}else return _0x297ede=validToken(_0x1c39e0,_0x40d239),_0x297ede[_0x21bf95(0x1f2)]('success')?{'allow':!![],'reason':_0x21bf95(0x318),'token':_0x1c39e0}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x21bf95(0x2ef),'token':null};};if(settings[_0x2e73a3(0x2c9)]){let _0x52ae9d=[...settings[_0x2e73a3(0x2ec)],_0x2e73a3(0x22f),_0x2e73a3(0x1b1),'127.0.0.1'];if(_0x52ae9d[_0x2e73a3(0x1b7)](_0x14adb9))return _0x1894b8(_0x30173d);else{_0x297ede=validToken(_0x30173d,_0x40d239);if(_0x297ede[_0x2e73a3(0x1f2)]('success'))return _0x1894b8(_0x30173d);else{if(telegramIpApproved(_0x40d239)){const _0x5b4ab8=generateToken(_0x40d239);return _0x297ede=_0x1894b8(_0x30173d),_0x297ede[_0x2e73a3(0x25e)]?{'allow':!![],'reason':_0x2e73a3(0x301),'token':_0x5b4ab8}:_0x297ede;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x2e73a3(0x244),'token':null};}}}else return _0x1894b8(_0x30173d);}function timelyDecrypt(_0xdaed3c,_0x3c6feb=!![]){const _0x5a8016=_0x31a8d6;if(_0xdaed3c)try{const _0x37590a=crypt[_0x5a8016(0x216)](secure[_0x5a8016(0x1e5)],_0xdaed3c)['message'],_0x4bc1db=_0x37590a[_0x5a8016(0x25f)]('@')[0x0],_0x16b947=_0x37590a[_0x5a8016(0x25f)]('@')[0x1],_0x151d06=new Date()[_0x5a8016(0x2b6)]();if(_0x3c6feb){if(_0x151d06-_0x16b947<maxSecretAge*0x3e8)return _0x4bc1db;else return![];}else return _0x4bc1db;}catch(_0x425762){return![];}else return![];}const validToken=(_0x411ec2,_0x53d0cd)=>{const _0x538b92=_0x31a8d6,_0x4607cf=devices[_0x53d0cd]['ip'];if(!_0x411ec2)return{'error':_0x538b92(0x235)};for(let _0x1aa739 of blacklist){if(_0x1aa739['token']==_0x411ec2)return{'error':_0x538b92(0x27c)};}let _0x158d5c;try{_0x158d5c=jwt[_0x538b92(0x218)](_0x411ec2,secure['secret']+_0x53d0cd);}catch{return{'error':_0x538b92(0x1ca)};}if(!_0x158d5c[_0x538b92(0x1f2)](_0x538b92(0x36e))&&!_0x158d5c[_0x538b92(0x1f2)](_0x538b92(0x2b0))||!_0x158d5c[_0x538b92(0x1f2)](_0x538b92(0x2c8)))return{'error':_0x538b92(0x305)};if(!_0x158d5c[_0x538b92(0x1f2)]('username')&&_0x158d5c[_0x538b92(0x1f2)]('clientip')){const {clientip:_0x327464}=_0x158d5c;return _0x4607cf==_0x327464?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x538b92(0x20c)};}else{if(_0x158d5c[_0x538b92(0x1f2)](_0x538b92(0x2b0))&&_0x158d5c[_0x538b92(0x1f2)]('clientip')){const {username:_0x359904,clientip:_0x5deeff}=_0x158d5c;return settings[_0x538b92(0x2bc)]==_0x359904&&_0x4607cf==_0x5deeff?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x538b92(0x319)};}}},generateLoginToken=_0x11deb8=>{const _0x12d1cd=_0x31a8d6;if(_0x11deb8){const _0x3f63e6=devices[_0x11deb8]['ip'];return jwt['sign']({'username':settings[_0x12d1cd(0x2bc)],'clientip':_0x3f63e6},secure[_0x12d1cd(0x310)]+_0x11deb8,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xe2214b=>{const _0x9634bb=_0x31a8d6;if(_0xe2214b){const _0x38d63e=devices[_0xe2214b]['ip'];return jwt[_0x9634bb(0x212)]({'clientip':_0x38d63e},secure[_0x9634bb(0x310)]+_0xe2214b,{'expiresIn':devices[_0xe2214b]['telegramIpApproval'][_0x9634bb(0x2e1)]*0x3c});}else return![];},telegramIpApproved=_0x440b8d=>{const _0x505cbb=_0x31a8d6;let _0x5eafcd=![];return devices[_0x440b8d][_0x505cbb(0x2a8)]&&devices[_0x440b8d]['telegramIpApproval']['expiry']!='reject'&&(_0x5eafcd=devices[_0x440b8d][_0x505cbb(0x2a8)][_0x505cbb(0x36e)]==devices[_0x440b8d]['ip']&&new Date()[_0x505cbb(0x2b6)]()-devices[_0x440b8d][_0x505cbb(0x2a8)]['timestamp']<devices[_0x440b8d][_0x505cbb(0x2a8)][_0x505cbb(0x2e1)]*0x3c*0x3e8),_0x5eafcd;},telegram2FaApproved=_0x3607a9=>{const _0x3fd007=_0x31a8d6;let _0x5282aa=![];return devices[_0x3607a9]['telegram2FaApproval']&&devices[_0x3607a9][_0x3fd007(0x30f)][_0x3fd007(0x2e1)]!=_0x3fd007(0x213)&&(_0x5282aa=devices[_0x3607a9]['telegram2FaApproval'][_0x3fd007(0x36e)]==devices[_0x3607a9]['ip']&&new Date()[_0x3fd007(0x2b6)]()-devices[_0x3607a9][_0x3fd007(0x30f)][_0x3fd007(0x29d)]<devices[_0x3607a9][_0x3fd007(0x30f)][_0x3fd007(0x2e1)]*0x3c*0x3e8),_0x5282aa;},normalizeIP=_0x647dbb=>{const _0x30ef34=_0x31a8d6;let _0x5ef232=null,_0x125255=null;if(ipaddr[_0x30ef34(0x2cb)](_0x647dbb)){const _0x3213cd=ipaddr[_0x30ef34(0x2b7)](_0x647dbb);_0x3213cd['kind']()===_0x30ef34(0x1d2)?(_0x3213cd[_0x30ef34(0x1ef)]()&&(_0x5ef232=_0x3213cd[_0x30ef34(0x36a)]()[_0x30ef34(0x317)]()),_0x125255=_0x3213cd[_0x30ef34(0x317)]()):(_0x5ef232=_0x3213cd[_0x30ef34(0x317)](),_0x125255=_0x3213cd[_0x30ef34(0x2c1)]()[_0x30ef34(0x317)]());}return{'show':_0x5ef232?_0x5ef232:_0x125255,'store':_0x125255};};function formatDate(_0x542a72){const _0x1f1c4b=_0x31a8d6;return _0x542a72[_0x1f1c4b(0x1ff)]()+'/'+(_0x542a72['getMonth']()+0x1)[_0x1f1c4b(0x317)]()[_0x1f1c4b(0x260)](0x2,'0')+'/'+_0x542a72[_0x1f1c4b(0x2f1)]()[_0x1f1c4b(0x317)]()[_0x1f1c4b(0x260)](0x2,'0')+'\x20'+_0x542a72[_0x1f1c4b(0x24c)]()[_0x1f1c4b(0x317)]()[_0x1f1c4b(0x260)](0x2,'0')+':'+_0x542a72[_0x1f1c4b(0x1df)]()['toString']()[_0x1f1c4b(0x260)](0x2,'0')+':'+_0x542a72[_0x1f1c4b(0x30c)]()['toString']()[_0x1f1c4b(0x260)](0x2,'0');}function sleep(_0x42f255){return new Promise(_0x5cf255=>setTimeout(_0x5cf255,_0x42f255));}