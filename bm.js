const _0x521e86=_0x7004;(function(_0x431606,_0x17340b){const _0x242257=_0x7004,_0x1e9a42=_0x431606();while(!![]){try{const _0x48c41f=-parseInt(_0x242257(0x299))/0x1+-parseInt(_0x242257(0x1d2))/0x2+parseInt(_0x242257(0x2a3))/0x3+parseInt(_0x242257(0x2e6))/0x4*(parseInt(_0x242257(0x234))/0x5)+-parseInt(_0x242257(0x274))/0x6+parseInt(_0x242257(0x28c))/0x7+parseInt(_0x242257(0x30f))/0x8;if(_0x48c41f===_0x17340b)break;else _0x1e9a42['push'](_0x1e9a42['shift']());}catch(_0x456ced){_0x1e9a42['push'](_0x1e9a42['shift']());}}}(_0x2453,0xb0e83));const _0x21dc7d=function(){let _0x3d6fb8=!![];return function(_0x58247e,_0x4a014c){const _0xd466d8=_0x3d6fb8?function(){const _0x445b75=_0x7004;if(_0x4a014c){const _0x57ac8a=_0x4a014c[_0x445b75(0x298)](_0x58247e,arguments);return _0x4a014c=null,_0x57ac8a;}}:function(){};return _0x3d6fb8=![],_0xd466d8;};}(),_0x10cd9d=_0x21dc7d(this,function(){const _0x46b7f3=_0x7004;return _0x10cd9d[_0x46b7f3(0x29b)]()[_0x46b7f3(0x203)](_0x46b7f3(0x2b1))[_0x46b7f3(0x29b)]()['constructor'](_0x10cd9d)['search'](_0x46b7f3(0x2b1));});_0x10cd9d();'use strict';process[_0x521e86(0x154)][_0x521e86(0x1db)]=0x1;const childProcess=require(_0x521e86(0x2a1)),fs=require('fs'),fns=require(_0x521e86(0x2a7)),low=require(_0x521e86(0x153)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x521e86(0x2d1)),crypto=require(_0x521e86(0x325)),Crypt=require(_0x521e86(0x21e))[_0x521e86(0x2ab)],RSA=require(_0x521e86(0x21e))[_0x521e86(0x1f0)],bcrypt=require(_0x521e86(0x31b)),jwt=require(_0x521e86(0x26c)),ipaddr=require(_0x521e86(0x1de)),argv=require(_0x521e86(0x2d7))(process['argv'][_0x521e86(0x26a)](0x2))['argv'],uuidRandom=require(_0x521e86(0x155)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x521e86(0x2ee)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x521e86(0x2e8)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x521e86(0x31a)]||_0x521e86(0x1b0),pattern=/^[0-9]{2,4}$/;!pattern[_0x521e86(0x2bf)](PORT)&&(console[_0x521e86(0x1e6)](_0x521e86(0x30b)+PORT+_0x521e86(0x314)),process[_0x521e86(0x2c4)](0x1));const HOST=argv[_0x521e86(0x222)]||null,userID=argv[_0x521e86(0x2dc)]||'',debugging=argv['d']||![],nodeversion=process[_0x521e86(0x271)][_0x521e86(0x272)];let bbpath=_0x521e86(0x2b2),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x521e86(0x21b),securefile=_0x521e86(0x2dd),environment=require('./'+bbpath2+'version.json')['environment']||_0x521e86(0x30c),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x521e86(0x1a4)),configpath=userID?bbpath+_0x521e86(0x266)+userID+'/':bbpath+_0x521e86(0x266),configbackuppath=configpath+_0x521e86(0x26f),logspath=userID?bbpath+_0x521e86(0x24a)+userID+'/':bbpath+_0x521e86(0x24a),zippath=userID?bbpath+_0x521e86(0x17b)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x521e86(0x193)](logspath+_0x521e86(0x1ff),{'flags':'a'}),temppath=userID?bbpath+_0x521e86(0x1df)+userID+'/':bbpath+_0x521e86(0x1df);!fs[_0x521e86(0x2c3)](configpath)&&fs[_0x521e86(0x304)](configpath);!fs[_0x521e86(0x2c3)](configbackuppath)&&fs[_0x521e86(0x304)](configbackuppath);!fs[_0x521e86(0x2c3)](logspath)&&fs[_0x521e86(0x304)](logspath);!fs[_0x521e86(0x2c3)](zippath)&&fs[_0x521e86(0x304)](zippath);!fs[_0x521e86(0x2c3)](temppath)&&fs[_0x521e86(0x304)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x2453(){const _0x6cca77=['reinstall-bb','-performance.json','Bot\x20','min',':\x20Bot\x20Mgr\x20>\x20','botname','rmSync','sortBy','Unauthorized\x20attempt\x20to\x20update\x20settings','initclient','name','Notifications\x20enabled','reinstall','hasOwnProperty','compareSync','post','Login\x20rejected','stopPolling','logs/','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','mode','uuid','Ok,\x20will\x20send\x20order\x20notifications\x20only','logs','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','secret','onText','output-000.log','Unauthorized\x20attempt\x20to\x20get\x20messages','cloneDeep','internal','\x1b[31m','sendMessage','auth','new-disabled','referer','Starting\x20new\x20bot\x20|\x20Bot\x20','alerts','bot','login\x20token\x20generated','/:bot/configuration','Token\x20blacklisted','lastmsgemitted','data','File\x20uploaded','config/','Invalid\x20authentication\x20token\x20(2)','node-zip','Server','slice','All\x20bots','jsonwebtoken','User\x20has\x20been\x20validated','error','backup/','Deleted\x20Bot\x20','versions','node','\x20>\x20','5959920mrnbVb','Ok,\x20will\x20send\x20alert\x20notifications\x20only','loginRequired','apiSecret','ipv6','#RES#\x20if\x20running\x20on\x20server','store','any','telegramEvents','output-001.log','manual','Starting\x20bot\x20|\x20Bot\x20','replace','remove','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','headless','Invalid\x20authentication\x20token\x20(1)','getPortfolio','/metrics\x20-\x20show\x20bot\x20performance\x0a','startsWith','decrypt','Error\x20removing\x20old\x20backup\x20files:','Yes','params','8817620OhtQFl','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','0.0.0','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','new','hashSync','*$1*','uncaughtException','Backup\x20file\x20unzipped\x20and\x20stored','login\x20token\x20valid','reason','apply','1006401crdZjW','number','toString','alias','/:bot/portfolio','exp','files','Invalid\x20IP\x20address','child_process','resetHistory','4003416kibksm','/names\x20-\x20show\x20bot\x20names\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','backupfile','date-fns','telegramEnabled','keys','get-backup-files','Crypt','***','restore-backup-file','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Idling\x20bot\x20\x20\x20|\x20Bot\x20','store-settings','(((.+)+)+)+$','bb/','getUTCHours','All\x20bots\x20running\x20right\x20now','kill','blacklist','::ffff:127.0.0.1','apiPassword','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','backup','clientip','Password\x20reset\x20rejected','parse','(staging)','test','2FA\x20required','storeFiat','allow','existsSync','exit','storeConfiguration','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','store-fiat','sha256','disabled','debug','2FA\x20login\x20token\x20generated','sendFile','getStartingBalances','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','-results.json','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','path','socket','reload','Error\x20while\x20deleting\x20config\x20files:\x20','size','get-portfolio','yargs/yargs','getHours','polling_error','</b>\x20?','backup-full@','user','bb-secure.json','getTime','secure','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','telegram','temporaryAccessAllowed','download','padStart','3369668lHvHGq','timeshift','util','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','\x1b[35m','\x20mode','#RES#\x20if\x20running\x20locally\x0a','address','mixpanel','function','removeListener','show','bot-','conn','add','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','all','Notifications\x20disabled\x0a','send','/off\x20-\x20stop\x20bot(s)\x0a','/disable\x20-\x20disable\x20notifications\x0a','tkn','reject','pidRefreshToken','build','filter','success','readdirSync','username','All','mkdirSync','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','push','telegramIpApproval','family','botID','telegram2FaApproval','Error:\x20Invalid\x20argument\x20','production','apiKey','request','600312FiPePM','exec','emit','format','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins',',\x20must\x20be\x20a\x204\x20digit\x20number','temporary\x20access\x20timeout','split','Alerts',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','backup-files','port','bcryptjs','\x1b[36m','started','settings','range','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','listen','status','crypto','/:bot','warning','title','notification','onepagemode','endsWith','backup-full','live','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','lowdb','env','uuid-random','bots','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','https://api.ipify.org?format=json','binary','temporary\x20access\x20rejected','mtime','Markdown','delete-bot','Unauthorized\x20attempt\x20to\x20delete\x20alerts','access','login\x20required','remoteAddress','2FA\x20login\x20required','get-starting-balances','update-bb','telegrammsg','f2aRequired','messages','callback_query','use','getFullYear','init','latestversion','hex','match','logout','lastmsgtelegram','token','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','=>\x20Go\x20to\x20#CYA#http://','yes','args','\x1b[33m','http','/upload-backup','SIGINT','output-002.log','zip/','static','toggle-bot-mode','build2','readFileSync','removeAllListeners','sockets','Restoring\x20bot(s)\x20from\x20backup','update','<b>Balance\x20Bot\x20Status:</b>\x0a','disconnect','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','access\x20timeout','Notifications\x20enabled\x0a','Failed\x20to\x20download\x20','bbvReceive','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','socket.io','expiry','getSeconds','************','temporary\x20token\x20generated','createWriteStream','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','bbPassword','set','join','place-order','toIPv4MappedAddress','-config.json','write','telegramToken','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','privateKey','event','backup-full.zip','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Logged\x20out\x20user\x20...','inherit','clients','staging','$1_$2_$3','::1','stop','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20download\x20','show-config','sort','showname','Temporary\x20access\x20rejected','showConfig','3000','type','Unauthorized\x20attempt\x20to\x20get\x20portfolio','pidExpireLogin','Unauthorized\x20attempt\x20to\x20log\x20out','then','5\x20min','auto','toggleBotMode','Bot\x20Mgr\x20>\x20','/on\x20-\x20start\x20bot(s)\x0a','/help\x20-\x20show\x20available\x20commands\x0a','.zip','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','generate','\x20|\x20client:\x20...','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','enabled','telegramChatId','find','Unauthorized\x20attempt\x20to\x20update\x20bot','stopped','length','getMinutes','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','sign','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','assign','reset-history','get','writeFileSync','private','Disabled\x20Bot\x20','1574512dmFFCy','getDate','chat','store-headless','bbUsername','getMonth','-----------------------------------------------------------------------------------','value','max','NTBA_FIX_319','\x20only\x0a','\x20|\x20','ipaddr.js','temp/','botmanager','get-logs','\x20(1)','delete-alerts','\x1b[34m','statSync','log','/status\x20-\x20show\x20bot(s)\x20status\x0a','1000','Unauthorized\x20attempt\x20to\x20store\x20configuration','full','IPv4','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','index.html','\x20to\x20','version','RSA','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','update-bot','Invalid\x20username\x20or\x20IP\x20address','login','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','orders','from','Starting\x20Balance\x20Bot\x20reinstallation','copyFileSync','\x20|\x20user:\x20...','30\x20min','telegramUsername','isDirectory','/output-000.log','DEFLATE','publicKey','bbvNew','search','userid','/:bot/history','sendMetricsTelegram','/restart\x20-\x20restart\x20bot(s)\x0a','stringify','get-messages','\x20(2)','settings.','_data','/:bot/coins','logged\x20out','HTML','Login\x20accepted','handshake','Restore\x20backup\x20file\x20','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','sendPortfolioTelegram','forEach','defaults','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Restore\x20process\x20aborted','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','storeHeadless','bb-settings.json','answerCallbackQuery','Password\x20has\x20been\x20reset\x20to:\x20','hybrid-crypto-js','track','invalid\x20credentials','store-configuration','host','-events.json','timestamp','once','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','password','404\x20Not\x20Found','catch','headers','Invalid\x20Telegram\x20token','simple','message','unlinkSync','emitHistory','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/:bot/performance','fork','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','5KRDoEu','randomBytes','confirm-message','Unauthorized\x20attempt\x20to\x20show\x20configuration'];_0x2453=function(){return _0x6cca77;};return _0x2453();}dbConfig[_0x521e86(0x216)]({'bots':[]})[_0x521e86(0x19b)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x521e86(0x216)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x521e86(0x28e),'onepagemode':![]}})[_0x521e86(0x19b)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x521e86(0x216)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x521e86(0x2c8),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x521e86(0x16b)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x521e86(0x19c)]&&settings['telegramToken']!=''&&settings[_0x521e86(0x1fd)]&&settings[_0x521e86(0x1fd)]!='')initTelegram();const parseColor=(_0xb3622f,_0x16352b)=>{const _0x23e8e6=_0x521e86,_0x3c7933=/#[A-Z]{3}#/g;if(typeof _0xb3622f=='string'){!_0x16352b?_0xb3622f=_0xb3622f[_0x23e8e6(0x280)](_0x3c7933,''):(_0xb3622f=_0xb3622f[_0x23e8e6(0x280)](/#BLU#/g,_0x23e8e6(0x1e4)),_0xb3622f=_0xb3622f['replace'](/#RED#/g,_0x23e8e6(0x258)),_0xb3622f=_0xb3622f[_0x23e8e6(0x280)](/#YEL#/g,_0x23e8e6(0x176)),_0xb3622f=_0xb3622f['replace'](/#MAG#/g,_0x23e8e6(0x2ea)),_0xb3622f=_0xb3622f['replace'](/#CYA#/g,_0x23e8e6(0x31c)),_0xb3622f=_0xb3622f[_0x23e8e6(0x280)](/#RES#/g,'\x1b[0m'));;}return _0xb3622f;},logger={'screen':_0xabaa15=>{const _0x3203ba=_0x521e86;console[_0x3203ba(0x1e6)](parseColor(_0xabaa15,!![]));},'simple':_0x37c8a2=>{const _0x40da43=_0x521e86;console[_0x40da43(0x1e6)](parseColor(_0x37c8a2,!![])),loggerfile[_0x40da43(0x19b)](util[_0x40da43(0x312)](parseColor(_0x37c8a2,![]))+'\x0a');},'full':async _0x506868=>{const _0x2e4bb8=_0x521e86,_0x193750=getTimeStamp()+_0x2e4bb8(0x23c)+_0x506868;console[_0x2e4bb8(0x1e6)](parseColor(_0x193750,!![])),loggerfile[_0x2e4bb8(0x19b)](util[_0x2e4bb8(0x312)](parseColor(_0x193750,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x2e4bb8(0x27c)]!=_0x2e4bb8(0x1f7))await tgBot[_0x2e4bb8(0x259)](settings[_0x2e4bb8(0x1c2)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x506868,![]))[_0x2e4bb8(0x229)](_0x3608aa=>{telegramError(_0x3608aa);});},'debug':async(_0x300ea5,_0x4f5124='')=>{const _0x3ef85a=_0x521e86,_0x17566e=getTimeStamp()+_0x3ef85a(0x318)+_0x300ea5;if(debugging)console[_0x3ef85a(0x1e6)](parseColor(_0x17566e,!![]));loggerfile[_0x3ef85a(0x19b)](util['format'](parseColor(_0x17566e,![]))+'\x0a');if(_0x4f5124){if(debugging)console[_0x3ef85a(0x1e6)](_0x4f5124);loggerfile[_0x3ef85a(0x19b)](util[_0x3ef85a(0x312)](_0x4f5124)+'\x0a');}}};process['on'](_0x521e86(0x294),function(_0x28eb11){const _0x323a1a=_0x521e86;logger[_0x323a1a(0x22c)](_0x28eb11);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x521e86(0x1ef)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x521e86(0x177))['createServer'](app);app[_0x521e86(0x169)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x51b9d1,_0x2da3d0)=>{const _0xe4c823=_0x521e86,_0x4821e1=_0x51b9d1[_0xe4c823(0x28b)][_0xe4c823(0x1b1)],_0x2a87fa=getClientsWithBotID(_0xe4c823(0x1e0)),_0xe00388=_0x51b9d1[_0xe4c823(0x22a)][_0xe4c823(0x24e)],_0x5465aa=timelyDecrypt(_0xe00388,![]),_0x50d32d=_0x2a87fa[_0xe4c823(0x1c3)](_0x306963=>_0x306963[_0xe4c823(0x24e)]==_0x5465aa);if(_0x50d32d){const _0x532979=normalizeIP(_0x51b9d1['socket']['remoteAddress'])['store'],_0x1cd49e=_0x51b9d1[_0xe4c823(0x22a)][_0xe4c823(0x2fb)];if(validateAccess(_0x1cd49e,_0x5465aa,_0x532979)['allow'])_0x4821e1==_0xe4c823(0x2ba)&&await backupConfigFiles(),await zipFiles(_0x4821e1),_0x2da3d0[_0xe4c823(0x2e4)](zippath+(_0x4821e1+'.zip'),_0x463107=>{const _0x5da23f=_0xe4c823;_0x463107&&(logger[_0x5da23f(0x1ea)](_0x5da23f(0x18a)+_0x4821e1),logger[_0x5da23f(0x22c)](_0x463107));});else logger['full'](_0xe4c823(0x1aa)+_0x4821e1+_0xe4c823(0x1e2));}else logger[_0xe4c823(0x1ea)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x4821e1+_0xe4c823(0x20a));}),app[_0x521e86(0x247)](_0x521e86(0x178),async(_0x1bbc94,_0x5c98ac)=>{const _0x2cdf47=_0x521e86,_0x43ce7e=getClientsWithBotID(_0x2cdf47(0x1e0)),_0x2807c4=_0x1bbc94[_0x2cdf47(0x22a)][_0x2cdf47(0x24e)],_0x25af2b=timelyDecrypt(_0x2807c4,![]),_0x5632c2=_0x43ce7e[_0x2cdf47(0x1c3)](_0x15acc5=>_0x15acc5[_0x2cdf47(0x24e)]==_0x25af2b);logger[_0x2cdf47(0x2ca)]('Backup\x20file\x20uploaded');if(_0x5632c2){const _0x55d260=normalizeIP(_0x1bbc94[_0x2cdf47(0x2d2)][_0x2cdf47(0x161)])[_0x2cdf47(0x27a)],_0x4155e3=_0x1bbc94[_0x2cdf47(0x22a)][_0x2cdf47(0x2fb)];if(validateAccess(_0x4155e3,_0x25af2b,_0x55d260)[_0x2cdf47(0x2c2)]){if(_0x1bbc94[_0x2cdf47(0x29f)]){const _0x195fbd=_0x1bbc94[_0x2cdf47(0x29f)][_0x2cdf47(0x2a6)];await _0x195fbd['mv'](temppath+_0x195fbd[_0x2cdf47(0x242)]),_0x5c98ac['send']({'status':!![],'message':_0x2cdf47(0x265)});const _0x373b22=getBotsWithMode();_0x373b22[_0x2cdf47(0x1c6)]>0x0?confirmRestore(temppath,_0x195fbd[_0x2cdf47(0x242)]):unzipFile(temppath,_0x195fbd['name']);}}else logger[_0x2cdf47(0x1ea)](_0x2cdf47(0x187));}else logger[_0x2cdf47(0x1ea)](_0x2cdf47(0x19d));}),app[_0x521e86(0x169)](express[_0x521e86(0x17c)](path['join'](__dirname,bbpath2,_0x521e86(0x17e)))),app[_0x521e86(0x169)](express[_0x521e86(0x17c)](path[_0x521e86(0x197)](__dirname,bbpath2,_0x521e86(0x2fe)))),app['get']('/',function(_0x10b9a3,_0x200103){const _0x145271=_0x521e86;_0x200103[_0x145271(0x2cc)](path['join'](__dirname,bbpath2,_0x145271(0x17e),_0x145271(0x1ed)));}),app[_0x521e86(0x1ce)](_0x521e86(0x326),function(_0x3bb525,_0xe5df29){const _0x1b5477=_0x521e86;_0xe5df29[_0x1b5477(0x2cc)](path[_0x1b5477(0x197)](__dirname,bbpath2,'build',_0x1b5477(0x1ed)));}),app[_0x521e86(0x1ce)](_0x521e86(0x29d),(_0x452aba,_0x6b4fa7)=>{const _0x331e3f=_0x521e86;_0x6b4fa7[_0x331e3f(0x2cc)](path[_0x331e3f(0x197)](__dirname,bbpath2,_0x331e3f(0x2fe),_0x331e3f(0x1ed)));}),app['get'](_0x521e86(0x231),(_0x5208eb,_0x26bf74)=>{const _0x335aef=_0x521e86;_0x26bf74['sendFile'](path['join'](__dirname,bbpath2,_0x335aef(0x2fe),_0x335aef(0x1ed)));}),app[_0x521e86(0x1ce)](_0x521e86(0x20d),(_0x2cbd24,_0x121637)=>{const _0x12e115=_0x521e86;_0x121637[_0x12e115(0x2cc)](path[_0x12e115(0x197)](__dirname,bbpath2,'build','index.html'));}),app[_0x521e86(0x1ce)](_0x521e86(0x205),(_0x306607,_0x24b0fa)=>{const _0x14a8f6=_0x521e86;_0x24b0fa[_0x14a8f6(0x2cc)](path['join'](__dirname,bbpath2,'build',_0x14a8f6(0x1ed)));}),app[_0x521e86(0x1ce)](_0x521e86(0x261),(_0x10959e,_0x39685e)=>{const _0x4bba82=_0x521e86;_0x39685e[_0x4bba82(0x2cc)](path[_0x4bba82(0x197)](__dirname,bbpath2,_0x4bba82(0x2fe),_0x4bba82(0x1ed)));}),app['get']('/:bot/support',(_0x4ea2c5,_0x733707)=>{const _0x178a37=_0x521e86;_0x733707['sendFile'](path['join'](__dirname,bbpath2,_0x178a37(0x2fe),_0x178a37(0x1ed)));});if(HOST)http[_0x521e86(0x323)](PORT,HOST);else http[_0x521e86(0x323)](PORT);const io=require(_0x521e86(0x18e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xbbb3b9=_0x521e86;let _0x39169e='[ip-address]';const _0x4e1f2b=networkInterfaces(),_0x596e96={};for(const _0x3c2d09 of Object[_0xbbb3b9(0x2a9)](_0x4e1f2b)){for(const _0x1d73e5 of _0x4e1f2b[_0x3c2d09]){if((_0x1d73e5[_0xbbb3b9(0x308)]==_0xbbb3b9(0x1eb)||_0x1d73e5[_0xbbb3b9(0x308)]==0x4)&&!_0x1d73e5[_0xbbb3b9(0x257)]){const _0x1069ed=ipaddr[_0xbbb3b9(0x2bd)](_0x1d73e5[_0xbbb3b9(0x2ed)])[_0xbbb3b9(0x31f)]();_0x1069ed!=_0xbbb3b9(0x1d0)&&(!_0x596e96[_0x3c2d09]&&(_0x596e96[_0x3c2d09]=[]),_0x596e96[_0x3c2d09]['push'](_0x1d73e5[_0xbbb3b9(0x2ed)]),_0x39169e=_0x1d73e5[_0xbbb3b9(0x2ed)]);}}}return{'serverip':_0x39169e,'netinterfaces':_0x596e96};}async function startServer(){const _0x5bed06=_0x521e86,{serverip:_0x3807da,netinterfaces:_0x361e7b}=getServerIP();logger[_0x5bed06(0x22c)](''),logger[_0x5bed06(0x22c)]('-----------------------------------------------------------------------------------'),await logger[_0x5bed06(0x1ea)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x5bed06(0x1a5)?_0x5bed06(0x2be):'')+'\x0a'+(_0x5bed06(0x233)+PORT+_0x5bed06(0x2ec))+(_0x5bed06(0x173)+_0x3807da+':'+PORT+_0x5bed06(0x279))),logger[_0x5bed06(0x22c)](_0x5bed06(0x1d8));if(config[_0x5bed06(0x1c6)]!=0x0)for(const _0x1bce2f of config){if(_0x1bce2f[_0x5bed06(0x324)]==_0x5bed06(0x1c1)||_0x1bce2f[_0x5bed06(0x324)]==_0x5bed06(0x291))await logger[_0x5bed06(0x1ea)](_0x5bed06(0x27f)+_0x1bce2f[_0x5bed06(0x309)]+'\x20|\x20'+_0x1bce2f[_0x5bed06(0x23d)]),startBot([_0x1bce2f['botID'],userID],{'cwd':bbpath},function(_0x45bfdc){if(_0x45bfdc)logger['full'](_0x45bfdc);});else(_0x1bce2f[_0x5bed06(0x324)]==_0x5bed06(0x2c9)||_0x1bce2f[_0x5bed06(0x324)]==_0x5bed06(0x25b))&&await logger[_0x5bed06(0x1ea)](_0x5bed06(0x2af)+_0x1bce2f[_0x5bed06(0x309)]+_0x5bed06(0x1dd)+_0x1bce2f[_0x5bed06(0x23d)]);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x5bed06(0x22c)]('-----------------------------------------------------------------------------------'),logger[_0x5bed06(0x22c)](''),await logger[_0x5bed06(0x2ca)]('Node.js\x20v'+nodeversion),await logger[_0x5bed06(0x2ca)]('Network\x20Interfaces:',_0x361e7b);}function startSocket(){io['on']('connection',_0x5057fc=>{const _0xe2503f=_0x7004;let _0x487ad6,_0x23bda5,_0x962e52,_0xeba7cb,_0x427cfa;const _0x3fda61=_0x5057fc['handshake'][_0xe2503f(0x22a)][_0xe2503f(0x25c)];_0x23bda5=_0x3fda61[_0xe2503f(0x16e)](/bot[0-9]{3}/);if(_0x23bda5)_0x962e52=_0x23bda5[0x0][_0xe2503f(0x16e)](/[0-9]{3}/);if(_0x962e52)_0x487ad6=_0x962e52[0x0];else _0x487ad6=_0xe2503f(0x1e0);const _0xcd26a0=_0x5057fc[_0xe2503f(0x211)][_0xe2503f(0x25a)]['encryptedUuid'];if(!_0xcd26a0)_0x5057fc[_0xe2503f(0x311)](_0xe2503f(0x324),{'publicKey':secure[_0xe2503f(0x201)]});else{_0xeba7cb=timelyDecrypt(_0xcd26a0,![]);if(!_0xeba7cb)_0x5057fc[_0xe2503f(0x311)](_0xe2503f(0x324),{'publicKey':secure[_0xe2503f(0x201)]});else{_0x427cfa=normalizeIP(_0x5057fc[_0xe2503f(0x2f3)]['remoteAddress'])[_0xe2503f(0x27a)];if(!devices[_0xeba7cb])devices[_0xeba7cb]={'uuid':_0xeba7cb,'access':{'token':null}};devices[_0xeba7cb]['ip']=_0x427cfa;const _0x1302e4=addClient(_0x5057fc['id'],_0xeba7cb,_0x487ad6);setAccess(_0x1302e4),emitMessages(),_0x5057fc['on'](_0xe2503f(0x1f5),_0x21cac0=>{const _0x3bf3de=_0xe2503f,_0xbaf50b=timelyDecrypt(_0x21cac0[_0x3bf3de(0x227)]);if(_0xbaf50b){_0x21cac0={'username':_0x21cac0['username'],'password':_0xbaf50b},devices[_0xeba7cb][_0x3bf3de(0x15f)]=validateCredentials(_0x21cac0,_0xeba7cb);if(devices[_0xeba7cb][_0x3bf3de(0x15f)][_0x3bf3de(0x2c2)]==![]&&devices[_0xeba7cb][_0x3bf3de(0x15f)][_0x3bf3de(0x297)]=='2FA\x20login\x20required')_0x5057fc[_0x3bf3de(0x311)](_0x3bf3de(0x324),{'access':devices[_0xeba7cb][_0x3bf3de(0x15f)]}),loginAccess2FA(_0xeba7cb,_0x427cfa);else{if(devices[_0xeba7cb][_0x3bf3de(0x15f)][_0x3bf3de(0x2c2)]==![]&&devices[_0xeba7cb][_0x3bf3de(0x15f)]['reason']==_0x3bf3de(0x220))_0x5057fc[_0x3bf3de(0x311)](_0x3bf3de(0x324),{'access':devices[_0xeba7cb][_0x3bf3de(0x15f)]});else devices[_0xeba7cb][_0x3bf3de(0x15f)]['allow']&&devices[_0xeba7cb][_0x3bf3de(0x15f)][_0x3bf3de(0x297)]==_0x3bf3de(0x260)&&(getClientsWithUuid(_0xeba7cb)[_0x3bf3de(0x215)](_0x1cb5bd=>{setAccess(_0x1cb5bd);}),logger[_0x3bf3de(0x2ca)]('Logged\x20in\x20user\x20...'+_0xeba7cb[_0x3bf3de(0x26a)](-0x8)),setTokenRefresh(_0xeba7cb),setSessionTimeout(_0x3bf3de(0x1f5),_0xeba7cb));}}else logger[_0x3bf3de(0x1ea)](_0x3bf3de(0x321));}),_0x5057fc['on']('reset-password',()=>{resetPassword();}),_0x5057fc['on'](_0xe2503f(0x185),_0x1ec76f=>{removeClient(_0x5057fc['id']);}),_0x487ad6=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xcb6e3c){const _0x215c3c=_0x521e86;if(_0xcb6e3c!=_0x215c3c(0x1e0)&&config['apiKey']!=''){if(pid[_0xcb6e3c])pid[_0xcb6e3c][_0x215c3c(0x2f8)]({'function':_0x215c3c(0x241),'args':null});}_0xcb6e3c!='botmanager'&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x33f4a7=_0x521e86;getClientsWithBotID('botmanager')[_0x33f4a7(0x215)](_0x3f8678=>{const _0xdcca2c=_0x33f4a7;getSocket(_0x3f8678['id'])[_0xdcca2c(0x311)](_0xdcca2c(0x324),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x4f0a89){const _0x18e947=_0x521e86;return io[_0x18e947(0x181)][_0x18e947(0x181)][_0x18e947(0x1ce)](_0x4f0a89);}function setAccess(_0x154a64){const _0x31b6ec=_0x521e86,_0xb07d77=getSocket(_0x154a64['id']),_0x40ad2b=_0x154a64[_0x31b6ec(0x24e)],_0x384349=_0x154a64[_0x31b6ec(0x25f)];devices[_0x40ad2b][_0x31b6ec(0x15f)]=validateAccess(devices[_0x40ad2b]['access'][_0x31b6ec(0x171)],_0x40ad2b),logger[_0x31b6ec(0x2ca)]('Setting\x20access:\x20'+devices[_0x40ad2b]['access'][_0x31b6ec(0x297)]+_0x31b6ec(0x1bf)+_0x154a64['id'][_0x31b6ec(0x26a)](-0x8)+_0x31b6ec(0x1fb)+_0x40ad2b['slice'](-0x8)),_0xb07d77[_0x31b6ec(0x197)](_0x40ad2b);if(devices[_0x40ad2b][_0x31b6ec(0x15f)][_0x31b6ec(0x2c2)]){_0xb07d77[_0x31b6ec(0x197)](_0x384349);if(_0x384349==_0x31b6ec(0x1e0))initializeSocketBotManager(_0xb07d77);else initializeSocketBot(_0xb07d77);initClient(_0x384349);}devices[_0x40ad2b][_0x31b6ec(0x15f)][_0x31b6ec(0x171)]&&devices[_0x40ad2b][_0x31b6ec(0x15f)]['reason']==_0x31b6ec(0x192)&&setSessionTimeout('2FA',_0x40ad2b),devices[_0x40ad2b][_0x31b6ec(0x15f)][_0x31b6ec(0x171)]&&devices[_0x40ad2b][_0x31b6ec(0x15f)]['reason']==_0x31b6ec(0x2cb)&&setSessionTimeout(_0x31b6ec(0x1f5),_0x40ad2b),_0xb07d77[_0x31b6ec(0x311)](_0x31b6ec(0x324),{'status':_0x154a64['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x40ad2b][_0x31b6ec(0x15f)],'externalip':devices[_0x40ad2b]['ip'],'publicKey':secure[_0x31b6ec(0x201)],'userid':settings[_0x31b6ec(0x204)],'validInstallation':validInstallation}),devices[_0x40ad2b][_0x31b6ec(0x15f)][_0x31b6ec(0x2c2)]==![]&&devices[_0x40ad2b][_0x31b6ec(0x15f)][_0x31b6ec(0x297)]==_0x31b6ec(0x2c0)&&temporaryAccess2FA(_0x40ad2b,devices[_0x40ad2b]['ip']);}function setSessionTimeout(_0x22e698,_0x561524){const _0xa3de0=_0x521e86;let _0x239d6b;if(_0x22e698==_0xa3de0(0x1f5))_0x239d6b=loginExpiry*0x3c*0x3e8;else _0x239d6b=devices[_0x561524][_0xa3de0(0x307)]['expiry']*0x3c*0x3e8-(new Date()[_0xa3de0(0x2de)]()-devices[_0x561524][_0xa3de0(0x307)]['timestamp']);if(devices[_0x561524][_0xa3de0(0x1b3)])clearTimeout(devices[_0x561524]['pidExpireLogin']);devices[_0x561524][_0xa3de0(0x1b3)]=setTimeout(()=>{const _0x27c966=_0xa3de0;if(devices[_0x561524][_0x27c966(0x2fd)])clearTimeout(devices[_0x561524][_0x27c966(0x2fd)]);removeSocketListeners(_0x561524),addBlacklist(_0x561524),devices[_0x561524][_0x27c966(0x307)]=null,devices[_0x561524][_0x27c966(0x30a)]=null,devices[_0x561524][_0x27c966(0x15f)]['token']=null,logger[_0x27c966(0x2ca)]('Session\x20expired\x20for\x20user\x20...'+_0x561524['slice'](-0x8)),devices[_0x561524][_0x27c966(0x15f)]=validateAccess(devices[_0x561524]['access'][_0x27c966(0x171)],_0x561524),!(devices[_0x561524]['access'][_0x27c966(0x2c2)]&&devices[_0x561524][_0x27c966(0x15f)][_0x27c966(0x297)]==_0x27c966(0x18c))&&(_0x22e698==_0x27c966(0x1f5)?io['to'](_0x561524)[_0x27c966(0x311)]('status',{'access':{'allow':![],'reason':_0x27c966(0x188),'token':null}}):io['to'](_0x561524)[_0x27c966(0x311)](_0x27c966(0x324),{'access':{'allow':![],'reason':_0x27c966(0x315),'token':null}})),devices[_0x561524]['access'][_0x27c966(0x171)]=null;},_0x239d6b);}function setTokenRefresh(_0x2dcbd2){const _0x4bc83c=_0x521e86;if(devices[_0x2dcbd2][_0x4bc83c(0x2fd)])clearTimeout(devices[_0x2dcbd2][_0x4bc83c(0x2fd)]);devices[_0x2dcbd2]['pidRefreshToken']=setTimeout(()=>{const _0x394df6=_0x4bc83c;getClientsWithUuid(_0x2dcbd2)['length']!=0x0?(devices[_0x2dcbd2][_0x394df6(0x15f)]=refreshToken(_0x2dcbd2),io['to'](_0x2dcbd2)['emit']('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2dcbd2][_0x394df6(0x15f)],'externalip':devices[_0x2dcbd2]['ip'],'publicKey':secure[_0x394df6(0x201)],'validInstallation':validInstallation}),setTokenRefresh(_0x2dcbd2)):clearTimeout(devices[_0x2dcbd2][_0x394df6(0x2fd)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2aa503){const _0x578470=_0x521e86,_0x3691b1=getClient(_0x2aa503['id'])[_0x578470(0x24e)];_0x2aa503[_0x578470(0x311)]('bots',config),_0x2aa503[_0x578470(0x311)](_0x578470(0x31e),cleanSettings()),_0x2aa503['on']('add-bot',_0x1b20f0=>{const _0x28723b=_0x578470;if(validateAccess(_0x1b20f0,_0x3691b1)[_0x28723b(0x2c2)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2aa503['on'](_0x578470(0x1f3),(_0x1ad458,_0x159a0a)=>{const _0x5ed8c3=_0x578470;if(validateAccess(_0x159a0a,_0x3691b1)[_0x5ed8c3(0x2c2)])toggleBot(_0x1ad458[_0x5ed8c3(0x309)],_0x1ad458[_0x5ed8c3(0x324)],_0x1ad458['live']);else logger[_0x5ed8c3(0x1ea)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2aa503['on'](_0x578470(0x17d),(_0x24b36f,_0x4f34a7)=>{const _0x53957e=_0x578470;if(validateAccess(_0x4f34a7,_0x3691b1)['allow'])toggleBotMode(_0x24b36f);else logger['full'](_0x53957e(0x1c4));}),_0x2aa503['on'](_0x578470(0x15d),(_0x3cf43c,_0x1b3b47)=>{const _0x32ddc4=_0x578470;if(validateAccess(_0x1b3b47,_0x3691b1)[_0x32ddc4(0x2c2)])deleteBot(_0x3cf43c);else logger[_0x32ddc4(0x1ea)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x2aa503['on'](_0x578470(0x2b0),(_0x4d2b6d,_0xc97524)=>{const _0x286c20=_0x578470;if(validateAccess(_0xc97524,_0x3691b1)[_0x286c20(0x2c2)])storeSettings(_0x4d2b6d,!![]);else logger[_0x286c20(0x1ea)](_0x286c20(0x240));}),_0x2aa503['on']('update-bb',_0x5710ad=>{const _0x577b63=_0x578470;if(validateAccess(_0x5710ad,_0x3691b1)[_0x577b63(0x2c2)])updateBB(_0x577b63(0x183));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2aa503['on'](_0x578470(0x238),_0x35fdd7=>{const _0x905de6=_0x578470;if(validateAccess(_0x35fdd7,_0x3691b1)[_0x905de6(0x2c2)])updateBB(_0x905de6(0x244));else logger[_0x905de6(0x1ea)](_0x905de6(0x18d));}),_0x2aa503['on'](_0x578470(0x2aa),_0x175dc5=>{const _0x1c47ce=_0x578470;if(validateAccess(_0x175dc5,_0x3691b1)[_0x1c47ce(0x2c2)]){const _0x1a752c=getClient(_0x2aa503['id']);if(_0x1a752c)getBackupFiles(_0x1a752c[_0x1c47ce(0x24e)]);else logger[_0x1c47ce(0x1ea)](_0x1c47ce(0x217));}else logger['full'](_0x1c47ce(0x2ae));}),_0x2aa503['on'](_0x578470(0x2ad),(_0x374fd3,_0x15e32f)=>{const _0x29aa6d=_0x578470;if(validateAccess(_0x15e32f,_0x3691b1)[_0x29aa6d(0x2c2)])restoreBackupFile(_0x374fd3);else logger[_0x29aa6d(0x1ea)](_0x29aa6d(0x1cb));}),_0x2aa503['on'](_0x578470(0x209),_0x862b60=>{const _0x4dcd55=_0x578470;if(validateAccess(_0x862b60,_0x3691b1)[_0x4dcd55(0x2c2)])getMessages();else logger[_0x4dcd55(0x1ea)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2aa503['on']('confirm-message',(_0x27d38d,_0x1ed32b)=>{const _0x1bb361=_0x578470;if(validateAccess(_0x1ed32b,_0x3691b1)['allow'])confirmMessage(_0x27d38d);else logger[_0x1bb361(0x1ea)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2aa503['on'](_0x578470(0x16f),_0x10cb3a=>{const _0x497839=_0x578470;if(validateAccess(_0x10cb3a,_0x3691b1)[_0x497839(0x2c2)]){if(devices[_0x3691b1][_0x497839(0x2fd)])clearTimeout(devices[_0x3691b1][_0x497839(0x2fd)]);if(devices[_0x3691b1][_0x497839(0x1b3)])clearTimeout(devices[_0x3691b1][_0x497839(0x1b3)]);removeSocketListeners(getClient(_0x2aa503['id'])[_0x497839(0x24e)]),addBlacklist(_0x3691b1),devices[_0x3691b1]['telegramIpApproval']=null,devices[_0x3691b1][_0x497839(0x30a)]=null,devices[_0x3691b1][_0x497839(0x15f)]['token']=null,logger[_0x497839(0x2ca)](_0x497839(0x1a2)+_0x3691b1[_0x497839(0x26a)](-0x8)),io['to'](getClient(_0x2aa503['id'])['uuid'])[_0x497839(0x311)](_0x497839(0x324),{'access':{'allow':![],'reason':_0x497839(0x20e),'token':null}});}else logger[_0x497839(0x1ea)](_0x497839(0x1b4));});}function initializeSocketBot(_0x21de1c){const _0x146ffa=_0x521e86,_0x578728=getClient(_0x21de1c['id'])[_0x146ffa(0x25f)],_0x748954=getClient(_0x21de1c['id'])[_0x146ffa(0x24e)];_0x21de1c['on'](_0x146ffa(0x1e1),(_0x4878f7,_0x201c23)=>{const _0xc2b282=_0x146ffa;if(validateAccess(_0x201c23,_0x748954)[_0xc2b282(0x2c2)]){if(pid[_0x578728])pid[_0x578728][_0xc2b282(0x2f8)]({'function':_0xc2b282(0x22f),'args':_0x4878f7});}else logger[_0xc2b282(0x1ea)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x21de1c['on'](_0x146ffa(0x1e3),(_0x37416a,_0x586f71)=>{const _0x1e8bae=_0x146ffa;if(validateAccess(_0x586f71,_0x748954)[_0x1e8bae(0x2c2)]){if(pid[_0x578728])pid[_0x578728][_0x1e8bae(0x2f8)]({'function':'deleteHistoryAlerts','args':_0x37416a});}else logger[_0x1e8bae(0x1ea)](_0x1e8bae(0x15e));}),_0x21de1c['on'](_0x146ffa(0x2d6),(_0x25bf2e,_0x256373)=>{const _0x2f36a0=_0x146ffa;if(validateAccess(_0x256373,_0x748954)[_0x2f36a0(0x2c2)]){if(pid[_0x578728])pid[_0x578728][_0x2f36a0(0x2f8)]({'function':_0x2f36a0(0x285),'args':_0x25bf2e});}else logger['full'](_0x2f36a0(0x1b2));}),_0x21de1c['on'](_0x146ffa(0x221),(_0x2bff68,_0x4a25c7)=>{const _0x1632c7=_0x146ffa;if(validateAccess(_0x4a25c7,_0x748954)[_0x1632c7(0x2c2)]){if(pid[_0x578728])pid[_0x578728][_0x1632c7(0x2f8)]({'function':_0x1632c7(0x2c5),'args':_0x2bff68});}else logger[_0x1632c7(0x1ea)](_0x1632c7(0x1e9));}),_0x21de1c['on'](_0x146ffa(0x1d5),(_0x2a056b,_0x5986f8)=>{const _0x2c6741=_0x146ffa;if(validateAccess(_0x5986f8,_0x748954)[_0x2c6741(0x2c2)]){if(pid[_0x578728])pid[_0x578728]['send']({'function':_0x2c6741(0x21a),'args':_0x2a056b});}else logger[_0x2c6741(0x1ea)](_0x2c6741(0x1a1));}),_0x21de1c['on'](_0x146ffa(0x2c7),(_0x1ff816,_0x2758eb)=>{const _0x51a5fa=_0x146ffa;if(validateAccess(_0x2758eb,_0x748954)['allow']){if(pid[_0x578728])pid[_0x578728][_0x51a5fa(0x2f8)]({'function':_0x51a5fa(0x2c1),'args':_0x1ff816});}else logger[_0x51a5fa(0x1ea)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x21de1c['on'](_0x146ffa(0x1cd),_0x365566=>{const _0x43776c=_0x146ffa;if(validateAccess(_0x365566,_0x748954)[_0x43776c(0x2c2)]){if(pid[_0x578728])pid[_0x578728][_0x43776c(0x2f8)]({'function':_0x43776c(0x2a2),'args':null});}else logger[_0x43776c(0x1ea)](_0x43776c(0x28d));}),_0x21de1c['on'](_0x146ffa(0x163),_0x271905=>{const _0x1a8d0c=_0x146ffa;if(validateAccess(_0x271905,_0x748954)[_0x1a8d0c(0x2c2)]){if(pid[_0x578728])pid[_0x578728][_0x1a8d0c(0x2f8)]({'function':_0x1a8d0c(0x2cd),'args':null});}else logger[_0x1a8d0c(0x1ea)](_0x1a8d0c(0x305));}),_0x21de1c['on'](_0x146ffa(0x198),(_0x117e2e,_0x357b11)=>{const _0x340334=_0x146ffa;if(validateAccess(_0x357b11,_0x748954)['allow']){if(pid[_0x578728])pid[_0x578728][_0x340334(0x2f8)]({'function':'placeOrder','args':_0x117e2e});}else logger[_0x340334(0x1ea)](_0x340334(0x1f1));}),_0x21de1c['on']('cancel-loading',_0x1e8776=>{const _0x1b8b43=_0x146ffa;if(validateAccess(_0x1e8776,_0x748954)[_0x1b8b43(0x2c2)]){if(pid[_0x578728])pid[_0x578728]['send']({'function':'cancelLoading','args':null});}else logger[_0x1b8b43(0x1ea)](_0x1b8b43(0x313));}),_0x21de1c['on'](_0x146ffa(0x1ab),_0x5f53a8=>{const _0x327ac9=_0x146ffa;if(validateAccess(_0x5f53a8,_0x748954)['allow']){if(pid[_0x578728])pid[_0x578728][_0x327ac9(0x2f8)]({'function':_0x327ac9(0x1af),'args':null});}else logger['full'](_0x327ac9(0x237));}),_0x21de1c['on'](_0x146ffa(0x164),_0x334593=>{const _0x29ae62=_0x146ffa;if(validateAccess(_0x334593,_0x748954)[_0x29ae62(0x2c2)])updateBB(_0x29ae62(0x183));else logger[_0x29ae62(0x1ea)](_0x29ae62(0x230));}),_0x21de1c['on'](_0x146ffa(0x209),_0x271ab1=>{const _0x9dcb13=_0x146ffa;if(validateAccess(_0x271ab1,_0x748954)[_0x9dcb13(0x2c2)])getMessages();else logger[_0x9dcb13(0x1ea)](_0x9dcb13(0x255));}),_0x21de1c['on'](_0x146ffa(0x236),(_0x2cbe44,_0x341f4c)=>{const _0x19eb16=_0x146ffa;if(validateAccess(_0x341f4c,_0x748954)[_0x19eb16(0x2c2)])confirmMessage(_0x2cbe44);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x21de1c['on'](_0x146ffa(0x16f),_0x419b54=>{const _0x180167=_0x146ffa;if(validateAccess(_0x419b54,_0x748954)['allow']){if(devices[_0x748954][_0x180167(0x2fd)])clearTimeout(devices[_0x748954][_0x180167(0x2fd)]);if(devices[_0x748954][_0x180167(0x1b3)])clearTimeout(devices[_0x748954][_0x180167(0x1b3)]);removeSocketListeners(getClient(_0x21de1c['id'])[_0x180167(0x24e)]),addBlacklist(_0x748954),devices[_0x748954][_0x180167(0x307)]=null,devices[_0x748954][_0x180167(0x30a)]=null,devices[_0x748954][_0x180167(0x15f)][_0x180167(0x171)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x748954[_0x180167(0x26a)](-0x8)),io['to'](getClient(_0x21de1c['id'])[_0x180167(0x24e)])[_0x180167(0x311)]('status',{'access':{'allow':![],'reason':_0x180167(0x20e),'token':null}});}else logger['full'](_0x180167(0x1b4));});}function removeSocketListeners(_0x230134){getClientsWithUuid(_0x230134)['forEach'](_0x1ae556=>{const _0x40f6f4=_0x7004;getSocket(_0x1ae556['id'])[_0x40f6f4(0x180)]();});}function cleanSettings(){const _0x260ece=_0x521e86;let _0x20e13d=settings;return settings[_0x260ece(0x19c)]&&settings[_0x260ece(0x19c)]!=''&&(_0x20e13d={..._0x20e13d,'telegramToken':'************'}),settings[_0x260ece(0x195)]&&settings['bbPassword']!=''&&(_0x20e13d={..._0x20e13d,'bbPassword':_0x260ece(0x191)}),(settings[_0x260ece(0x195)]&&settings[_0x260ece(0x195)]==_0x260ece(0x2ac)||settings[_0x260ece(0x19c)]&&settings['telegramToken']==_0x260ece(0x2ac))&&(_0x20e13d={..._0x20e13d,'restored':{'password':settings[_0x260ece(0x195)]==_0x260ece(0x2ac),'telegram':settings[_0x260ece(0x19c)]==_0x260ece(0x2ac)}}),_0x20e13d;}async function updateBB(_0x4fbf66){const _0xe29cb5=_0x521e86;await backupConfigFiles(),installingUpdate=!![],config[_0xe29cb5(0x215)](_0x15353e=>{const _0x1abb78=_0xe29cb5;restartBot(_0x15353e[_0x1abb78(0x309)]);});if(_0x4fbf66==_0xe29cb5(0x183))process['send']({'update':!![],'environment':environment},_0x39adc1=>{});else _0x4fbf66==_0xe29cb5(0x244)&&process[_0xe29cb5(0x2f8)]({'reinstall':!![],'environment':environment},_0x38f97a=>{});}function startBot(_0x3d0ea6,_0x27536a,_0x94f1ca){const _0x1f762b=_0x521e86;if(debugging)_0x3d0ea6['push']('-d');let _0x5d2d17=![];const _0x252bac=_0x3d0ea6[0x0];_0x27536a={..._0x27536a,'stdio':['inherit','inherit',_0x1f762b(0x1a3),'ipc']},pid[_0x252bac]=childProcess[_0x1f762b(0x232)](botfile,_0x3d0ea6,_0x27536a),pid[_0x252bac]['on']('message',_0x5e7789=>{const _0x6f6ed8=_0x1f762b;switch(Object[_0x6f6ed8(0x2a9)](_0x5e7789)[0x0]){case _0x6f6ed8(0x23d):updateBotName(_0x252bac,_0x5e7789['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x6f6ed8(0x324):updateStatus(_0x252bac,_0x5e7789[_0x6f6ed8(0x324)]);break;case _0x6f6ed8(0x150):updateLive(_0x252bac,_0x5e7789[_0x6f6ed8(0x150)]);break;case _0x6f6ed8(0x31d):updateLive(_0x252bac,_0x5e7789[_0x6f6ed8(0x31d)]),io['to'](_0x252bac)['emit'](_0x6f6ed8(0x324),{'access':{'allow':![],'reason':_0x6f6ed8(0x2d3),'token':null}});break;case _0x6f6ed8(0x1a8):_0x5e7789[_0x6f6ed8(0x1a8)]=='restart'&&restartBot(_0x252bac);_0x5e7789[_0x6f6ed8(0x1a8)]=='kill'&&toggleBot(_0x252bac,_0x6f6ed8(0x2c9),_0x6f6ed8(0x1c5));break;case _0x6f6ed8(0x2e2):sendTelegram(_0x252bac,_0x5e7789['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x5e7789[_0x6f6ed8(0x165)]);break;case _0x6f6ed8(0x2ef):io['to'](_0x252bac)[_0x6f6ed8(0x311)](_0x5e7789[_0x6f6ed8(0x2ef)],_0x5e7789[_0x6f6ed8(0x175)]);break;}}),pid[_0x252bac]['on']('error',function(_0x386248){if(_0x5d2d17)return;_0x5d2d17=!![],_0x94f1ca(_0x386248);}),pid[_0x252bac]['on'](_0x1f762b(0x2c4),async function(_0x5c17af){const _0x599634=_0x1f762b;if(installingUpdate)return;if(_0x5d2d17)return;_0x5d2d17=!![],_0x94f1ca(null);const _0x59650f=dbConfig['get'](_0x599634(0x156))['find']({'botID':_0x252bac})[_0x599634(0x1d9)]();_0x59650f&&(_0x59650f[_0x599634(0x324)]==_0x599634(0x1c1)||_0x59650f['status']==_0x599634(0x291))&&(await sleep(0x3e8),updateLive(_0x252bac,_0x599634(0x1c5)),logger['full']('Restarting\x20Bot\x20'+_0x252bac),startBot([_0x252bac,userID],{'cwd':bbpath},function(_0x3ee365){if(_0x3ee365)logger['full'](_0x3ee365);}));});}function stopBot(_0x412b85){const _0x4021ad=_0x521e86;getClientsWithBotID(_0x412b85)[_0x4021ad(0x215)](_0x37d49e=>{const _0x146f5d=_0x4021ad;getSocket(_0x37d49e['id'])[_0x146f5d(0x185)](!![]),removeClient(_0x37d49e['id']);}),pid[_0x412b85]&&(pid[_0x412b85]['kill'](),pid[_0x412b85]=null);}function restartBot(_0x2f16b6){const _0x55fb48=_0x521e86;if(pid[_0x2f16b6])pid[_0x2f16b6][_0x55fb48(0x2b5)]();}function addBot(){const _0x3b8ce8=_0x521e86;let _0x1da7f2;for(let _0x5b0bde=0x1;_0x5b0bde<0x3e9;_0x5b0bde++){_0x1da7f2=_0x5b0bde['toString']()[_0x3b8ce8(0x2e5)](0x3,'0');let _0x414fe1=config[_0x3b8ce8(0x1c3)](_0x439bd2=>_0x439bd2[_0x3b8ce8(0x309)]==_0x1da7f2);if(!_0x414fe1)break;}if(_0x1da7f2===_0x3b8ce8(0x1e8)){logger[_0x3b8ce8(0x1ea)](_0x3b8ce8(0x2ce));return;}logger['full'](_0x3b8ce8(0x25d)+_0x1da7f2),dbConfig[_0x3b8ce8(0x1ce)](_0x3b8ce8(0x156))[_0x3b8ce8(0x306)]({'botID':_0x1da7f2,'botname':_0x3b8ce8(0x23a)+_0x1da7f2,'status':_0x3b8ce8(0x291),'live':''})[_0x3b8ce8(0x19b)](),startBot([_0x1da7f2,userID],{'cwd':bbpath},function(_0x29a6ef){const _0x22d93a=_0x3b8ce8;if(_0x29a6ef)logger[_0x22d93a(0x1ea)](_0x29a6ef);}),config=getConfiguration(),io['to'](_0x3b8ce8(0x1e0))[_0x3b8ce8(0x311)](_0x3b8ce8(0x156),config),broadcastToBots(_0x3b8ce8(0x156),JSON['stringify'](config));}function deleteBot(_0x4f04b0){const _0x1604bc=_0x521e86;getClientsWithBotID(_0x4f04b0)[_0x1604bc(0x215)](_0x3a661f=>{const _0x38b1d6=_0x1604bc;getSocket(_0x3a661f['id'])[_0x38b1d6(0x185)](!![]),removeClient(_0x3a661f['id']);}),dbConfig[_0x1604bc(0x1ce)](_0x1604bc(0x156))[_0x1604bc(0x281)]({'botID':_0x4f04b0})[_0x1604bc(0x19b)](),logger['full'](_0x1604bc(0x270)+_0x4f04b0),stopBot(_0x4f04b0);try{if(fs['existsSync'](path[_0x1604bc(0x197)](configpath,'bot-'+_0x4f04b0+'-config.json')))fs['unlinkSync'](path[_0x1604bc(0x197)](configpath,_0x1604bc(0x2f2)+_0x4f04b0+_0x1604bc(0x19a)));if(fs[_0x1604bc(0x2c3)](path[_0x1604bc(0x197)](configpath,_0x1604bc(0x2f2)+_0x4f04b0+_0x1604bc(0x223))))fs[_0x1604bc(0x22e)](path[_0x1604bc(0x197)](configpath,_0x1604bc(0x2f2)+_0x4f04b0+_0x1604bc(0x223)));if(fs[_0x1604bc(0x2c3)](path[_0x1604bc(0x197)](configpath,_0x1604bc(0x2f2)+_0x4f04b0+'-performance.json')))fs[_0x1604bc(0x22e)](path[_0x1604bc(0x197)](configpath,_0x1604bc(0x2f2)+_0x4f04b0+_0x1604bc(0x239)));if(fs[_0x1604bc(0x2c3)](path['join'](configpath,_0x1604bc(0x2f2)+_0x4f04b0+_0x1604bc(0x2cf))))fs['unlinkSync'](path['join'](configpath,_0x1604bc(0x2f2)+_0x4f04b0+'-results.json'));}catch(_0x3cf8f6){if(_0x3cf8f6)logger[_0x1604bc(0x1ea)](_0x1604bc(0x2d4),_0x3cf8f6);}config=getConfiguration(),io['to'](_0x1604bc(0x1e0))[_0x1604bc(0x311)](_0x1604bc(0x156),config),broadcastToBots(_0x1604bc(0x156),JSON[_0x1604bc(0x208)](config));}function toggleBot(_0xdc4990,_0x307f6b,_0xa8200){const _0x1a9334=_0x521e86;dbConfig['get'](_0x1a9334(0x156))[_0x1a9334(0x1c3)]({'botID':_0xdc4990})['assign']({'status':_0x307f6b})[_0x1a9334(0x1cc)]({'live':_0xa8200})[_0x1a9334(0x19b)]();if(_0x307f6b==_0x1a9334(0x1c1)||_0x307f6b==_0x1a9334(0x291))logger[_0x1a9334(0x1ea)]('Enabled\x20Bot\x20'+_0xdc4990),startBot([_0xdc4990,userID],{'cwd':bbpath},function(_0x322035){const _0x269671=_0x1a9334;if(_0x322035)logger[_0x269671(0x1ea)](_0x322035);});else(_0x307f6b==_0x1a9334(0x2c9)||_0x307f6b=='new-disabled')&&(logger['full'](_0x1a9334(0x1d1)+_0xdc4990),stopBot(_0xdc4990));config=getConfiguration(),io['to'](_0x1a9334(0x1e0))[_0x1a9334(0x311)](_0x1a9334(0x156),config),broadcastToBots(_0x1a9334(0x156),JSON['stringify'](config));}function toggleStatus(_0x26a502){const _0x1575c5=_0x521e86;let _0x453798=dbConfig[_0x1575c5(0x1ce)]('bots')[_0x1575c5(0x1c3)]({'botID':_0x26a502})[_0x1575c5(0x1d9)](),_0x1bedf2;if(_0x453798[_0x1575c5(0x324)]===_0x1575c5(0x1c1))_0x1bedf2=_0x1575c5(0x2c9);else{if(_0x453798[_0x1575c5(0x324)]==='new')_0x1bedf2=_0x1575c5(0x25b);else{if(_0x453798[_0x1575c5(0x324)]===_0x1575c5(0x25b))_0x1bedf2=_0x1575c5(0x291);else{if(_0x453798['status']==='disabled')_0x1bedf2='enabled';}}}return _0x1bedf2;}function updateStatus(_0x62230f,_0xc1d63e){const _0xdeb6a1=_0x521e86;dbConfig[_0xdeb6a1(0x1ce)](_0xdeb6a1(0x156))['find']({'botID':_0x62230f})['assign']({'status':_0xc1d63e})[_0xdeb6a1(0x19b)](),config=getConfiguration(),io['to'](_0xdeb6a1(0x1e0))[_0xdeb6a1(0x311)](_0xdeb6a1(0x156),config),broadcastToBots(_0xdeb6a1(0x156),JSON[_0xdeb6a1(0x208)](config));}function updateLive(_0x5d01b3,_0x47be62){const _0x457925=_0x521e86;dbConfig[_0x457925(0x1ce)](_0x457925(0x156))[_0x457925(0x1c3)]({'botID':_0x5d01b3})['assign']({'live':_0x47be62})[_0x457925(0x19b)](),config=getConfiguration(),io['to']('botmanager')[_0x457925(0x311)](_0x457925(0x156),config),broadcastToBots(_0x457925(0x156),JSON['stringify'](config));}function updateBotName(_0x416858,_0x2effa1){const _0x22d6f2=_0x521e86;dbConfig[_0x22d6f2(0x1ce)](_0x22d6f2(0x156))[_0x22d6f2(0x1c3)]({'botID':_0x416858})['assign']({'botname':_0x2effa1})[_0x22d6f2(0x19b)](),config=getConfiguration(),io['to']('botmanager')[_0x22d6f2(0x311)](_0x22d6f2(0x156),config),broadcastToBots('bots',JSON[_0x22d6f2(0x208)](config));}function updateBotManager(){const _0x28f8c5=_0x521e86;config=getConfiguration(),io['to'](_0x28f8c5(0x1e0))['emit'](_0x28f8c5(0x156),config),broadcastToBots(_0x28f8c5(0x156),JSON[_0x28f8c5(0x208)](config));}function toggleBotMode(_0x5224d4){const _0x220e2d=_0x521e86;if(pid[_0x5224d4])pid[_0x5224d4][_0x220e2d(0x2f8)]({'function':_0x220e2d(0x1b8),'args':null});else{const _0x3c4a8e=configpath+'bot-'+_0x5224d4+_0x220e2d(0x19a),_0x5c4f61=fs[_0x220e2d(0x17f)](_0x3c4a8e),_0x4dee82=JSON[_0x220e2d(0x2bd)](_0x5c4f61),_0x1542e0=_0x4dee82[_0x220e2d(0x25f)][0x0][_0x220e2d(0x283)];_0x4dee82[_0x220e2d(0x25f)][0x0][_0x220e2d(0x283)]=!_0x1542e0;const _0x13eb21=JSON[_0x220e2d(0x208)](_0x4dee82,null,0x2);fs[_0x220e2d(0x1cf)](_0x3c4a8e,_0x13eb21),config=getConfiguration(),io['to'](_0x220e2d(0x1e0))[_0x220e2d(0x311)](_0x220e2d(0x156),config),broadcastToBots(_0x220e2d(0x156),JSON[_0x220e2d(0x208)](config));}}function telegramError(_0x593ac8){const _0x2aedd3=_0x521e86;logger[_0x2aedd3(0x22c)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0xe35e5a){const _0x2e22a7=_0x521e86;if(_0xe35e5a['from'][_0x2e22a7(0x302)]!=settings['telegramUsername']&&'@'+_0xe35e5a[_0x2e22a7(0x1f8)][_0x2e22a7(0x302)]!=settings[_0x2e22a7(0x1fd)])return tgBot[_0x2e22a7(0x259)](_0xe35e5a['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x2e22a7(0x20f)})['catch'](_0x8f8b16=>{telegramError(_0x8f8b16);}),![];return!![];}async function initTelegram(){const _0x350880=_0x521e86;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3c7fdb='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3c7fdb+='\x0a',_0x3c7fdb+='/enable\x20-\x20enable\x20notifications\x0a',_0x3c7fdb+=_0x350880(0x2fa),_0x3c7fdb+=_0x350880(0x251),_0x3c7fdb+=_0x350880(0x207),_0x3c7fdb+=_0x350880(0x1ba),_0x3c7fdb+=_0x350880(0x2f9),_0x3c7fdb+=_0x350880(0x1f2),_0x3c7fdb+=_0x350880(0x2a4),_0x3c7fdb+=_0x350880(0x1e7),_0x3c7fdb+=_0x350880(0x286),_0x3c7fdb+=_0x350880(0x1c8),_0x3c7fdb+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x3c7fdb+=_0x350880(0x2e9),_0x3c7fdb+=_0x350880(0x1bb);let _0x1b6bdf='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1b6bdf+='\x0a',_0x1b6bdf+=_0x3c7fdb,tgBot[_0x350880(0x253)](/\/start/,_0x4f744f=>{const _0x1964df=_0x350880;if(!validateTelegram(_0x4f744f))return;if(settings['telegramChatId']!=_0x4f744f[_0x1964df(0x1d4)]['id'])updateSetting(_0x1964df(0x1c2),_0x4f744f[_0x1964df(0x1d4)]['id']);updateSetting(_0x1964df(0x2a8),!![]),tgBot[_0x1964df(0x259)](_0x4f744f[_0x1964df(0x1d4)]['id'],_0x1b6bdf)['catch'](_0x28a87d=>{telegramError(_0x28a87d);});}),tgBot[_0x350880(0x253)](/\/enable/,_0xf5a026=>{const _0x18dcfa=_0x350880;if(!validateTelegram(_0xf5a026))return;if(settings[_0x18dcfa(0x1c2)]!=_0xf5a026[_0x18dcfa(0x1d4)]['id'])updateSetting(_0x18dcfa(0x1c2),_0xf5a026[_0x18dcfa(0x1d4)]['id']);updateSetting(_0x18dcfa(0x2a8),!![]),tgBot[_0x18dcfa(0x259)](_0xf5a026['chat']['id'],_0x18dcfa(0x243))[_0x18dcfa(0x229)](_0x5e88cc=>{telegramError(_0x5e88cc);});}),tgBot[_0x350880(0x253)](/\/config/,async _0x18da5c=>{const _0x484340=_0x350880;if(!validateTelegram(_0x18da5c))return;tgBot[_0x484340(0x2f0)](_0x484340(0x168)),tgBot[_0x484340(0x259)](_0x18da5c['chat']['id'],_0x484340(0x2f5),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x484340(0x1f7)},{'text':_0x484340(0x317),'callback_data':_0x484340(0x25e)},{'text':_0x484340(0x303),'callback_data':_0x484340(0x2f6)}]]}})[_0x484340(0x229)](_0x49da1f=>{telegramError(_0x49da1f);}),tgBot['on'](_0x484340(0x168),async _0x5a291a=>{const _0x22f8dd=_0x484340,_0x4939c2=_0x5a291a['data'],_0x3ddb9e=_0x5a291a[_0x22f8dd(0x22d)];tgBot[_0x22f8dd(0x21c)](_0x5a291a['id'])['then'](async()=>{const _0x279ce8=_0x22f8dd;_0x4939c2==_0x279ce8(0x1f7)&&(updateSetting(_0x279ce8(0x27c),'orders'),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x3ddb9e['chat']['id'],_0x279ce8(0x24f))[_0x279ce8(0x229)](_0x31c27d=>{telegramError(_0x31c27d);}));_0x4939c2=='alerts'&&(updateSetting('telegramEvents',_0x279ce8(0x25e)),updateSetting('telegramEnabled',!![]),await tgBot[_0x279ce8(0x259)](_0x3ddb9e[_0x279ce8(0x1d4)]['id'],_0x279ce8(0x275))[_0x279ce8(0x229)](_0x252131=>{telegramError(_0x252131);}));_0x4939c2==_0x279ce8(0x2f6)&&(updateSetting(_0x279ce8(0x27c),_0x279ce8(0x2f6)),updateSetting(_0x279ce8(0x2a8),!![]),await tgBot[_0x279ce8(0x259)](_0x3ddb9e[_0x279ce8(0x1d4)]['id'],_0x279ce8(0x1ec))['catch'](_0xd6068c=>{telegramError(_0xd6068c);}));if(!settings[_0x279ce8(0x1c2)])tgBot[_0x279ce8(0x259)](_0x3ddb9e[_0x279ce8(0x1d4)]['id'],_0x279ce8(0x226))[_0x279ce8(0x229)](_0x1c9444=>{telegramError(_0x1c9444);});}),tgBot[_0x22f8dd(0x2f0)]('callback_query');});}),tgBot[_0x350880(0x253)](/\/status/,_0x2d06f7=>{const _0x325313=_0x350880;if(!validateTelegram(_0x2d06f7))return;const _0x325ec4=getBotsWithMode();let _0x8fedd9=_0x325313(0x184);config[_0x325313(0x215)](_0x1551f1=>{const _0xe2812=_0x325313,_0x22901f=_0x325ec4[_0xe2812(0x1c3)](_0x498e70=>_0x498e70['botID']==_0x1551f1[_0xe2812(0x309)])[_0xe2812(0x24d)];_0x8fedd9+='Bot\x20'+_0x1551f1[_0xe2812(0x309)]+':\x20'+_0x1551f1[_0xe2812(0x324)]+'\x20|\x20'+_0x22901f+_0xe2812(0x1dd)+_0x1551f1[_0xe2812(0x150)]+'\x0a';}),_0x8fedd9+='\x0a',_0x8fedd9+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x8fedd9+=!settings[_0x325313(0x2a8)]?_0x325313(0x2f7):_0x325313(0x189),_0x8fedd9+=settings['telegramEnabled']?settings[_0x325313(0x27c)]==_0x325313(0x2f6)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x325313(0x27c)]+_0x325313(0x1dc):'',tgBot[_0x325313(0x259)](_0x2d06f7[_0x325313(0x1d4)]['id'],_0x8fedd9,{'parse_mode':_0x325313(0x20f)})[_0x325313(0x229)](_0x2cc20d=>{telegramError(_0x2cc20d);});}),tgBot[_0x350880(0x253)](/\/restart/,_0x592afb=>{const _0x2e8d8d=_0x350880;if(!validateTelegram(_0x592afb))return;tgBot[_0x2e8d8d(0x2f0)](_0x2e8d8d(0x168));const _0x2a8518=getEnabledBots();if(_0x2a8518[_0x2e8d8d(0x1c6)]==0x0)tgBot['sendMessage'](_0x592afb[_0x2e8d8d(0x1d4)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x2e8d8d(0x229)](_0x46a144=>{telegramError(_0x46a144);});else{if(_0x2a8518[_0x2e8d8d(0x1c6)]>0x1)_0x2a8518['push']({'botID':'all'});let _0x44b485=[],_0x1dc578=[];const _0x48baaa=_0x2a8518['length']%0x4==0x0||_0x2a8518[_0x2e8d8d(0x1c6)]%0x4==0x3||_0x2a8518[_0x2e8d8d(0x1c6)]%0x3==0x1?0x4:0x3;let _0x14d548=0x0;_0x2a8518[_0x2e8d8d(0x215)]((_0x24fb9e,_0x47a32d)=>{const _0x1457bc=_0x2e8d8d;if(_0x47a32d%_0x48baaa==0x0)_0x1dc578=[];_0x1dc578[_0x1457bc(0x306)]({'text':_0x24fb9e['botID']==_0x1457bc(0x2f6)?_0x1457bc(0x26b):_0x1457bc(0x23a)+_0x24fb9e[_0x1457bc(0x309)],'callback_data':_0x24fb9e[_0x1457bc(0x309)]}),_0x47a32d%_0x48baaa==0x0&&(_0x44b485[_0x14d548]=_0x1dc578,_0x14d548++);}),tgBot[_0x2e8d8d(0x259)](_0x592afb[_0x2e8d8d(0x1d4)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x44b485}})[_0x2e8d8d(0x229)](_0x1cbe2c=>{telegramError(_0x1cbe2c);}),tgBot['on'](_0x2e8d8d(0x168),async _0x28ee79=>{const _0x4d9707=_0x2e8d8d,_0x5b6bfd=_0x28ee79[_0x4d9707(0x264)],_0x494c0e=_0x28ee79['message'];tgBot[_0x4d9707(0x21c)](_0x28ee79['id'])[_0x4d9707(0x1b5)](async()=>{const _0x1dd270=_0x4d9707;_0x5b6bfd==_0x1dd270(0x2f6)?config[_0x1dd270(0x215)](_0x2fcbea=>{restartBot(_0x2fcbea['botID']);}):restartBot(_0x5b6bfd);}),tgBot[_0x4d9707(0x2f0)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x4e7eb7=>{const _0x162c10=_0x350880;if(!validateTelegram(_0x4e7eb7))return;tgBot[_0x162c10(0x2f0)](_0x162c10(0x168));const _0x59faa7=getDisabledBots();if(_0x59faa7['length']==0x0)tgBot[_0x162c10(0x259)](_0x4e7eb7[_0x162c10(0x1d4)]['id'],_0x162c10(0x2b4))[_0x162c10(0x229)](_0x3969a3=>{telegramError(_0x3969a3);});else{if(_0x59faa7[_0x162c10(0x1c6)]>0x1)_0x59faa7['push']({'botID':'all'});let _0x56bb56=[],_0x3e9d8f=[];const _0x5cc837=_0x59faa7[_0x162c10(0x1c6)]%0x4==0x0||_0x59faa7[_0x162c10(0x1c6)]%0x4==0x3||_0x59faa7[_0x162c10(0x1c6)]%0x3==0x1?0x4:0x3;let _0x24ba5d=0x0;_0x59faa7[_0x162c10(0x215)]((_0x5a6b99,_0x5b3176)=>{const _0x4dae5a=_0x162c10;if(_0x5b3176%_0x5cc837==0x0)_0x3e9d8f=[];_0x3e9d8f[_0x4dae5a(0x306)]({'text':_0x5a6b99[_0x4dae5a(0x309)]==_0x4dae5a(0x2f6)?_0x4dae5a(0x26b):'Bot\x20'+_0x5a6b99[_0x4dae5a(0x309)],'callback_data':_0x5a6b99['botID']}),_0x5b3176%_0x5cc837==0x0&&(_0x56bb56[_0x24ba5d]=_0x3e9d8f,_0x24ba5d++);}),tgBot[_0x162c10(0x259)](_0x4e7eb7[_0x162c10(0x1d4)]['id'],_0x162c10(0x290),{'reply_markup':{'inline_keyboard':_0x56bb56}})['catch'](_0x17a5ff=>{telegramError(_0x17a5ff);}),tgBot['on'](_0x162c10(0x168),async _0xe52cdd=>{const _0x5e73b8=_0x162c10,_0x8b43cb=_0xe52cdd[_0x5e73b8(0x264)],_0x331443=_0xe52cdd['message'];tgBot['answerCallbackQuery'](_0xe52cdd['id'])[_0x5e73b8(0x1b5)](async()=>{const _0x409c56=_0x5e73b8;_0x8b43cb==_0x409c56(0x2f6)?(tgBot['sendMessage'](_0x331443[_0x409c56(0x1d4)]['id'],_0x409c56(0x219))[_0x409c56(0x229)](_0x2ded7b=>{telegramError(_0x2ded7b);}),_0x59faa7[_0x409c56(0x215)](_0x2061fd=>{const _0x5b0175=_0x409c56;if(_0x2061fd[_0x5b0175(0x309)]!=_0x5b0175(0x2f6))toggleBot(_0x2061fd[_0x5b0175(0x309)],toggleStatus(_0x2061fd[_0x5b0175(0x309)]),_0x5b0175(0x1c5));})):(tgBot[_0x409c56(0x259)](_0x331443[_0x409c56(0x1d4)]['id'],_0x409c56(0x322)+_0x8b43cb)[_0x409c56(0x229)](_0x1348b1=>{telegramError(_0x1348b1);}),toggleBot(_0x8b43cb,toggleStatus(_0x8b43cb),_0x409c56(0x1c5)));}),tgBot[_0x5e73b8(0x2f0)](_0x5e73b8(0x168));});}}),tgBot[_0x350880(0x253)](/\/off/,_0x27a2cf=>{const _0x15804a=_0x350880;if(!validateTelegram(_0x27a2cf))return;tgBot[_0x15804a(0x2f0)](_0x15804a(0x168));const _0x4c4aad=getEnabledBots();if(_0x4c4aad['length']==0x0)tgBot[_0x15804a(0x259)](_0x27a2cf['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x15804a(0x229)](_0x203f19=>{telegramError(_0x203f19);});else{if(_0x4c4aad[_0x15804a(0x1c6)]>0x1)_0x4c4aad[_0x15804a(0x306)]({'botID':_0x15804a(0x2f6)});let _0x1148da=[],_0x5cf788=[];const _0x41700d=_0x4c4aad[_0x15804a(0x1c6)]%0x4==0x0||_0x4c4aad['length']%0x4==0x3||_0x4c4aad[_0x15804a(0x1c6)]%0x3==0x1?0x4:0x3;let _0xa0e3f0=0x0;_0x4c4aad['forEach']((_0x3a0236,_0x1ffb6e)=>{const _0x2e3148=_0x15804a;if(_0x1ffb6e%_0x41700d==0x0)_0x5cf788=[];_0x5cf788['push']({'text':_0x3a0236[_0x2e3148(0x309)]==_0x2e3148(0x2f6)?_0x2e3148(0x26b):_0x2e3148(0x23a)+_0x3a0236[_0x2e3148(0x309)],'callback_data':_0x3a0236['botID']}),_0x1ffb6e%_0x41700d==0x0&&(_0x1148da[_0xa0e3f0]=_0x5cf788,_0xa0e3f0++);}),tgBot[_0x15804a(0x259)](_0x27a2cf[_0x15804a(0x1d4)]['id'],_0x15804a(0x2d0),{'reply_markup':{'inline_keyboard':_0x1148da}})['catch'](_0x43524b=>{telegramError(_0x43524b);}),tgBot['on'](_0x15804a(0x168),async _0x368c25=>{const _0x1deda0=_0x15804a,_0x244844=_0x368c25['data'],_0x1c78eb=_0x368c25[_0x1deda0(0x22d)];tgBot[_0x1deda0(0x21c)](_0x368c25['id'])['then'](async()=>{const _0x1ce64e=_0x1deda0;_0x244844==_0x1ce64e(0x2f6)?(tgBot['sendMessage'](_0x1c78eb[_0x1ce64e(0x1d4)]['id'],_0x1ce64e(0x2c6))[_0x1ce64e(0x229)](_0x411e93=>{telegramError(_0x411e93);}),_0x4c4aad['forEach'](_0x42adc9=>{const _0x281098=_0x1ce64e;if(_0x42adc9[_0x281098(0x309)]!='all')toggleBot(_0x42adc9[_0x281098(0x309)],toggleStatus(_0x42adc9['botID']),_0x281098(0x1c5));})):(tgBot['sendMessage'](_0x1c78eb['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x244844)[_0x1ce64e(0x229)](_0x55ea17=>{telegramError(_0x55ea17);}),toggleBot(_0x244844,toggleStatus(_0x244844),_0x1ce64e(0x1c5)));}),tgBot[_0x1deda0(0x2f0)](_0x1deda0(0x168));});}}),tgBot[_0x350880(0x253)](/\/metrics/,_0x356b0e=>{const _0x1086a8=_0x350880;if(!validateTelegram(_0x356b0e))return;tgBot[_0x1086a8(0x2f0)](_0x1086a8(0x168));const _0x288d55=getEnabledBots();if(_0x288d55[_0x1086a8(0x1c6)]==0x0)tgBot[_0x1086a8(0x259)](_0x356b0e[_0x1086a8(0x1d4)]['id'],_0x1086a8(0x1ca))[_0x1086a8(0x229)](_0x335f61=>{telegramError(_0x335f61);});else{if(_0x288d55['length']>0x1){let _0x43558f=[],_0x87b96c=[];const _0x1b201a=_0x288d55[_0x1086a8(0x1c6)]%0x4==0x0||_0x288d55[_0x1086a8(0x1c6)]%0x4==0x3||_0x288d55['length']%0x3==0x1?0x4:0x3;let _0x1b93f0=0x0;_0x288d55[_0x1086a8(0x215)]((_0x223a25,_0x565e51)=>{const _0x46b565=_0x1086a8;if(_0x565e51%_0x1b201a==0x0)_0x87b96c=[];_0x87b96c[_0x46b565(0x306)]({'text':_0x46b565(0x23a)+_0x223a25['botID'],'callback_data':_0x223a25[_0x46b565(0x309)]}),_0x565e51%_0x1b201a==0x0&&(_0x43558f[_0x1b93f0]=_0x87b96c,_0x1b93f0++);}),tgBot[_0x1086a8(0x259)](_0x356b0e['chat']['id'],_0x1086a8(0x282),{'reply_markup':{'inline_keyboard':_0x43558f}})[_0x1086a8(0x229)](_0x2f98e7=>{telegramError(_0x2f98e7);}),tgBot['on'](_0x1086a8(0x168),async _0x262ace=>{const _0x9212e=_0x1086a8,_0x196434=_0x262ace[_0x9212e(0x264)],_0x19dfa0=_0x262ace['message'];tgBot[_0x9212e(0x21c)](_0x262ace['id'])[_0x9212e(0x1b5)](async()=>{const _0x5a7ff0=_0x9212e;if(pid[_0x196434])pid[_0x196434][_0x5a7ff0(0x2f8)]({'function':_0x5a7ff0(0x206),'args':null});}),tgBot[_0x9212e(0x2f0)](_0x9212e(0x168));});}else{const _0x37f8cf=_0x288d55[0x0][_0x1086a8(0x309)];if(pid[_0x37f8cf])pid[_0x37f8cf]['send']({'function':_0x1086a8(0x206),'args':null});}}}),tgBot[_0x350880(0x253)](/\/portfolio/,_0x2ba48f=>{const _0x1fb8fa=_0x350880;if(!validateTelegram(_0x2ba48f))return;tgBot[_0x1fb8fa(0x2f0)](_0x1fb8fa(0x168));const _0x22b446=getEnabledBots();if(_0x22b446['length']==0x0)tgBot[_0x1fb8fa(0x259)](_0x2ba48f[_0x1fb8fa(0x1d4)]['id'],_0x1fb8fa(0x1ca))[_0x1fb8fa(0x229)](_0x5c242f=>{telegramError(_0x5c242f);});else{if(_0x22b446[_0x1fb8fa(0x1c6)]>0x1){let _0x4202b2=[],_0x414139=[];const _0x14038c=_0x22b446[_0x1fb8fa(0x1c6)]%0x4==0x0||_0x22b446['length']%0x4==0x3||_0x22b446[_0x1fb8fa(0x1c6)]%0x3==0x1?0x4:0x3;let _0x3169fa=0x0;_0x22b446[_0x1fb8fa(0x215)]((_0x3501f4,_0xd73adb)=>{const _0x5e4e8d=_0x1fb8fa;if(_0xd73adb%_0x14038c==0x0)_0x414139=[];_0x414139[_0x5e4e8d(0x306)]({'text':_0x5e4e8d(0x23a)+_0x3501f4['botID'],'callback_data':_0x3501f4[_0x5e4e8d(0x309)]}),_0xd73adb%_0x14038c==0x0&&(_0x4202b2[_0x3169fa]=_0x414139,_0x3169fa++);}),tgBot['sendMessage'](_0x2ba48f[_0x1fb8fa(0x1d4)]['id'],_0x1fb8fa(0x1bd),{'reply_markup':{'inline_keyboard':_0x4202b2}})[_0x1fb8fa(0x229)](_0x484c09=>{telegramError(_0x484c09);}),tgBot['on'](_0x1fb8fa(0x168),async _0x33dca7=>{const _0x46d1c5=_0x1fb8fa,_0xad12a=_0x33dca7[_0x46d1c5(0x264)],_0x4fe648=_0x33dca7['message'];tgBot['answerCallbackQuery'](_0x33dca7['id'])[_0x46d1c5(0x1b5)](async()=>{const _0x40a4ab=_0x46d1c5;if(pid[_0xad12a])pid[_0xad12a][_0x40a4ab(0x2f8)]({'function':_0x40a4ab(0x214),'args':null});}),tgBot[_0x46d1c5(0x2f0)](_0x46d1c5(0x168));});}else{const _0x435521=_0x22b446[0x0][_0x1fb8fa(0x309)];if(pid[_0x435521])pid[_0x435521][_0x1fb8fa(0x2f8)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x350880(0x253)](/\/update/,async _0x19aa26=>{const _0x51f9ac=_0x350880;if(!validateTelegram(_0x19aa26))return;tgBot[_0x51f9ac(0x2f0)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x51f9ac(0x259)](_0x19aa26['chat']['id'],_0x51f9ac(0x28f))[_0x51f9ac(0x229)](_0x3dec47=>{telegramError(_0x3dec47);});else!validInstallation?tgBot['sendMessage'](_0x19aa26[_0x51f9ac(0x1d4)]['id'],_0x51f9ac(0x213))[_0x51f9ac(0x229)](_0x318322=>{telegramError(_0x318322);}):(tgBot[_0x51f9ac(0x259)](_0x19aa26[_0x51f9ac(0x1d4)]['id'],_0x51f9ac(0x2e1),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x51f9ac(0x174)},{'text':'No','callback_data':'no'}]]}})[_0x51f9ac(0x229)](_0x341d81=>{telegramError(_0x341d81);}),tgBot['on']('callback_query',async _0x1d6e57=>{const _0x11b6de=_0x51f9ac,_0x4eb82d=_0x1d6e57[_0x11b6de(0x264)],_0x36251e=_0x1d6e57[_0x11b6de(0x22d)];tgBot['answerCallbackQuery'](_0x1d6e57['id'])[_0x11b6de(0x1b5)](async()=>{const _0x356f5f=_0x11b6de;_0x4eb82d==_0x356f5f(0x174)&&(await tgBot[_0x356f5f(0x259)](_0x36251e[_0x356f5f(0x1d4)]['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0xff4eb8=>{telegramError(_0xff4eb8);}),updateBB(_0x356f5f(0x183))),_0x4eb82d=='no'&&await tgBot[_0x356f5f(0x259)](_0x36251e['chat']['id'],_0x356f5f(0x152))[_0x356f5f(0x229)](_0x2be871=>{telegramError(_0x2be871);});}),tgBot[_0x11b6de(0x2f0)](_0x11b6de(0x168));}));}),tgBot['onText'](/\/reinstall/,async _0x3289cc=>{const _0x212996=_0x350880;if(!validateTelegram(_0x3289cc))return;tgBot['removeListener'](_0x212996(0x168)),!validInstallation?tgBot[_0x212996(0x259)](_0x3289cc[_0x212996(0x1d4)]['id'],_0x212996(0x157))['catch'](_0x43d032=>{telegramError(_0x43d032);}):(tgBot['sendMessage'](_0x3289cc['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x212996(0x28a),'callback_data':_0x212996(0x174)},{'text':'No','callback_data':'no'}]]}})[_0x212996(0x229)](_0x54d50d=>{telegramError(_0x54d50d);}),tgBot['on']('callback_query',async _0x244d44=>{const _0x1ede34=_0x212996,_0x2bce55=_0x244d44['data'],_0x31dd8b=_0x244d44[_0x1ede34(0x22d)];tgBot[_0x1ede34(0x21c)](_0x244d44['id'])[_0x1ede34(0x1b5)](async()=>{const _0x532af2=_0x1ede34;_0x2bce55==_0x532af2(0x174)&&(await tgBot[_0x532af2(0x259)](_0x31dd8b[_0x532af2(0x1d4)]['id'],_0x532af2(0x1f9))[_0x532af2(0x229)](_0x33b9d5=>{telegramError(_0x33b9d5);}),updateBB('reinstall')),_0x2bce55=='no'&&await tgBot[_0x532af2(0x259)](_0x31dd8b['chat']['id'],_0x532af2(0x320))[_0x532af2(0x229)](_0x2b0e0b=>{telegramError(_0x2b0e0b);});}),tgBot[_0x1ede34(0x2f0)](_0x1ede34(0x168));}));}),tgBot['onText'](/\/toggle/,_0x11d92d=>{const _0x3da1fb=_0x350880;if(!validateTelegram(_0x11d92d))return;tgBot[_0x3da1fb(0x2f0)](_0x3da1fb(0x168));const _0x16d7e8=getBotsWithMode();if(_0x16d7e8['length']==0x0)tgBot[_0x3da1fb(0x259)](_0x11d92d[_0x3da1fb(0x1d4)]['id'],_0x3da1fb(0x1ca))[_0x3da1fb(0x229)](_0x31918c=>{telegramError(_0x31918c);});else{let _0x24e686=[],_0x202fa7=[];const _0x2e2792=0x2;let _0x5e02f6=0x0;_0x16d7e8['forEach']((_0x4b9dd0,_0x5db28b)=>{const _0x1116c2=_0x3da1fb;if(_0x5db28b%_0x2e2792==0x0)_0x202fa7=[];_0x202fa7[_0x1116c2(0x306)]({'text':'Bot\x20'+_0x4b9dd0['botID']+'\x20('+_0x4b9dd0['mode']+')','callback_data':_0x4b9dd0[_0x1116c2(0x309)]}),_0x5db28b%_0x2e2792==0x0&&(_0x24e686[_0x5e02f6]=_0x202fa7,_0x5e02f6++);}),tgBot[_0x3da1fb(0x259)](_0x11d92d[_0x3da1fb(0x1d4)]['id'],_0x3da1fb(0x1f6),{'reply_markup':{'inline_keyboard':_0x24e686}})['catch'](_0x40940c=>{telegramError(_0x40940c);}),tgBot['on'](_0x3da1fb(0x168),async _0x350b49=>{const _0x23b44a=_0x3da1fb,_0x4790ec=_0x350b49[_0x23b44a(0x264)],_0x45e49c=_0x350b49[_0x23b44a(0x22d)];tgBot[_0x23b44a(0x21c)](_0x350b49['id'])[_0x23b44a(0x1b5)](async()=>{const _0x3be46b=_0x23b44a,_0x4e3b7b=_0x16d7e8['find'](_0xca6cde=>_0xca6cde['botID']==_0x4790ec),_0x5e085c=_0x4e3b7b[_0x3be46b(0x24d)]==_0x3be46b(0x1b7)?_0x3be46b(0x27e):_0x3be46b(0x1b7);tgBot[_0x3be46b(0x259)](_0x45e49c[_0x3be46b(0x1d4)]['id'],_0x3be46b(0x24b)+_0x4790ec+_0x3be46b(0x1ee)+_0x5e085c+_0x3be46b(0x2eb))['catch'](_0xe1c6e6=>{telegramError(_0xe1c6e6);}),toggleBotMode(_0x4790ec);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x350880(0x253)](/\/names/,_0x196bd9=>{const _0x30499e=_0x350880;if(!validateTelegram(_0x196bd9))return;let _0x36a5e2='';config[_0x30499e(0x215)](_0x103514=>{const _0x1bbe9b=_0x30499e;_0x36a5e2+=_0x1bbe9b(0x23a)+_0x103514[_0x1bbe9b(0x309)]+':\x20'+_0x103514[_0x1bbe9b(0x23d)]+'\x0a';}),tgBot[_0x30499e(0x259)](_0x196bd9['chat']['id'],_0x36a5e2,{'parse_mode':'HTML'})['catch'](_0xbab8cc=>{telegramError(_0xbab8cc);});}),tgBot[_0x350880(0x253)](/\/disable/,_0x5e4991=>{const _0xda062f=_0x350880;if(!validateTelegram(_0x5e4991))return;tgBot[_0xda062f(0x259)](_0x5e4991['chat']['id'],_0xda062f(0x1a9))[_0xda062f(0x229)](_0x132494=>{telegramError(_0x132494);}),updateSetting(_0xda062f(0x2a8),![]);}),tgBot[_0x350880(0x253)](/\/help/,_0x5aa303=>{const _0x361b92=_0x350880;if(!validateTelegram(_0x5aa303))return;tgBot['sendMessage'](_0x5aa303['chat']['id'],_0x3c7fdb)[_0x361b92(0x229)](_0x4c540e=>{telegramError(_0x4c540e);});}),tgBot['on'](_0x350880(0x2d9),_0xbd7f89=>{const _0x473988=_0x350880;_0xbd7f89[_0x473988(0x29b)]()['includes'](_0x473988(0x228))&&(logger[_0x473988(0x1ea)]('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null,io['to'](_0x473988(0x1e0))[_0x473988(0x311)](_0x473988(0x329),_0x473988(0x22b)));}),process[_0x350880(0x225)](_0x350880(0x179),()=>{const _0x57e7ea=_0x350880;if(tgBot)tgBot[_0x57e7ea(0x249)]();process[_0x57e7ea(0x2c4)](0x1);}),process['once']('SIGTERM',()=>{const _0x5d7d4e=_0x350880;if(tgBot)tgBot[_0x5d7d4e(0x249)]();process[_0x5d7d4e(0x2c4)](0x1);});}}function disableTelegram(){const _0x52fb26=_0x521e86;tgBot&&(tgBot[_0x52fb26(0x249)](),tgBot=null);}function sendTelegram(_0x5d7283,_0x40ef49){const _0x48a651=_0x521e86;if(settings[_0x48a651(0x2a8)]){if(settings['telegramEvents']==_0x48a651(0x2f6)||(_0x40ef49[_0x48a651(0x1b1)]==_0x48a651(0x26e)||_0x40ef49[_0x48a651(0x1b1)]==_0x48a651(0x327)||_0x40ef49[_0x48a651(0x1b1)]==_0x48a651(0x300))&&settings['telegramEvents']==_0x48a651(0x25e)||_0x40ef49['type']=='order'&&settings['telegramEvents']=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x40ef49[_0x48a651(0x1ad)])tgBot[_0x48a651(0x259)](settings[_0x48a651(0x1c2)],_0x40ef49[_0x48a651(0x23d)]+_0x48a651(0x273)+_0x40ef49[_0x48a651(0x19f)])['catch'](_0x45f762=>{telegramError(_0x45f762);});else tgBot[_0x48a651(0x259)](settings['telegramChatId'],_0x48a651(0x23a)+_0x5d7283+_0x48a651(0x273)+_0x40ef49['event'])[_0x48a651(0x229)](_0x41d5e8=>{telegramError(_0x41d5e8);});}}}}async function sendTelegramMsg(_0x5e4419,_0x34cba2=_0x521e86(0x20f)){const _0xa0710b=_0x521e86;return settings[_0xa0710b(0x2a8)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0xa0710b(0x259)](settings[_0xa0710b(0x1c2)],_0x5e4419,{'parse_mode':_0x34cba2})[_0xa0710b(0x229)](_0x23e822=>{telegramError(_0x23e822);}),!![]):![];}function getDeviceWithIp(_0x181019){const _0x5a07a4=_0x521e86;return devices[_0x5a07a4(0x1c3)](_0x151abf=>_0x151abf['ip']===_0x181019);}function temporaryAccess2FA(_0x5d5a83,_0x1bc147){const _0x32d61e=_0x521e86;let _0x4371e2=new Date(),_0x1d10b8=![];if(lastIpApproval){if(_0x4371e2-lastIpApproval<0x1388)_0x1d10b8=!![];}lastIpApproval=new Date();if(_0x1d10b8)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x32d61e(0x2f0)]('callback_query'),tgBot[_0x32d61e(0x259)](settings[_0x32d61e(0x1c2)],_0x32d61e(0x151)+normalizeIP(_0x1bc147)[_0x32d61e(0x2f1)]+_0x32d61e(0x2da),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x32d61e(0x1b6),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x32d61e(0x1fc),'callback_data':'30'},{'text':_0x32d61e(0x2fc),'callback_data':_0x32d61e(0x2fc)}]]}})[_0x32d61e(0x229)](_0x2c5f88=>{telegramError(_0x2c5f88);}),tgBot['on'](_0x32d61e(0x168),async _0x899467=>{const _0x30e149=_0x32d61e,_0x4c4044=_0x899467[_0x30e149(0x264)],_0x500057=_0x899467[_0x30e149(0x22d)];tgBot[_0x30e149(0x21c)](_0x899467['id'])[_0x30e149(0x1b5)](async()=>{const _0x1cf0c9=_0x30e149;devices[_0x5d5a83][_0x1cf0c9(0x307)]={'clientip':_0x1bc147,'timestamp':new Date()[_0x1cf0c9(0x2de)](),'expiry':_0x4c4044},_0x4c4044!=_0x1cf0c9(0x2fc)?(await tgBot[_0x1cf0c9(0x259)](_0x500057[_0x1cf0c9(0x1d4)]['id'],'Access\x20enabled\x20for\x20'+_0x4c4044+'\x20minutes',{'parse_mode':'HTML'})[_0x1cf0c9(0x229)](_0x217b0a=>{telegramError(_0x217b0a);}),io['to'](_0x5d5a83)[_0x1cf0c9(0x311)](_0x1cf0c9(0x324),{'access':{'allow':![],'reason':_0x1cf0c9(0x2d3),'token':null}})):(await tgBot[_0x1cf0c9(0x259)](_0x500057[_0x1cf0c9(0x1d4)]['id'],_0x1cf0c9(0x1ae))[_0x1cf0c9(0x229)](_0x4d1eab=>{telegramError(_0x4d1eab);}),io['to'](_0x5d5a83)[_0x1cf0c9(0x311)](_0x1cf0c9(0x324),{'access':{'allow':![],'reason':_0x1cf0c9(0x15a),'token':null}}));}),tgBot[_0x30e149(0x2f0)](_0x30e149(0x168));}));}function loginAccess2FA(_0x238cf9,_0xf327c4){const _0x225b60=_0x521e86;tgBot&&settings[_0x225b60(0x1c2)]&&(tgBot['removeListener'](_0x225b60(0x168)),tgBot[_0x225b60(0x259)](settings['telegramChatId'],_0x225b60(0x186)+normalizeIP(_0xf327c4)['show']+_0x225b60(0x2da),{'parse_mode':_0x225b60(0x20f),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x225b60(0x2fc)}]]}})[_0x225b60(0x229)](_0x11157f=>{telegramError(_0x11157f);}),tgBot['on'](_0x225b60(0x168),async _0x586ffc=>{const _0x56790e=_0x225b60,_0x4a9dbe=_0x586ffc[_0x56790e(0x264)],_0x4c3e40=_0x586ffc[_0x56790e(0x22d)];tgBot[_0x56790e(0x21c)](_0x586ffc['id'])[_0x56790e(0x1b5)](async()=>{const _0x579820=_0x56790e;devices[_0x238cf9]['telegram2FaApproval']={'clientip':_0xf327c4,'timestamp':new Date()['getTime'](),'expiry':_0x4a9dbe},_0x4a9dbe!=_0x579820(0x2fc)?(await tgBot['sendMessage'](_0x4c3e40[_0x579820(0x1d4)]['id'],_0x579820(0x210),{'parse_mode':_0x579820(0x20f)})[_0x579820(0x229)](_0x1bda21=>{telegramError(_0x1bda21);}),io['to'](_0x238cf9)[_0x579820(0x311)]('status',{'access':{'allow':![],'reason':_0x579820(0x2d3),'token':null}})):(await tgBot[_0x579820(0x259)](_0x4c3e40[_0x579820(0x1d4)]['id'],_0x579820(0x248))[_0x579820(0x229)](_0x4324a0=>{telegramError(_0x4324a0);}),io['to'](_0x238cf9)[_0x579820(0x311)](_0x579820(0x324),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x56790e(0x2f0)](_0x56790e(0x168));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5d19b4=_0x521e86;return dbConfig[_0x5d19b4(0x1ce)](_0x5d19b4(0x156))[_0x5d19b4(0x23f)](_0x5d19b4(0x309))[_0x5d19b4(0x2ff)]({'status':_0x5d19b4(0x1c1)})['value']()||[];}function getDisabledBots(){const _0x565944=_0x521e86;return dbConfig[_0x565944(0x1ce)](_0x565944(0x156))[_0x565944(0x23f)](_0x565944(0x309))['filter']({'status':_0x565944(0x2c9)})['value']()||[];}function getBotAttributes(_0x5e1b32){const _0x30238c=_0x521e86;let _0x3bfd66={};const _0x18eca9=configpath+_0x30238c(0x2f2)+_0x5e1b32+_0x30238c(0x19a),_0x1d602a=fs[_0x30238c(0x2c3)](_0x18eca9);if(_0x1d602a){const _0x5551c3=fs[_0x30238c(0x17f)](_0x18eca9);try{const _0x309cda=JSON[_0x30238c(0x2bd)](_0x5551c3),_0x2cd1a9=_0x309cda?_0x309cda[_0x30238c(0x25f)][0x0][_0x30238c(0x283)]:![];_0x3bfd66[_0x30238c(0x24d)]=_0x2cd1a9?_0x30238c(0x1b7):'manual',_0x3bfd66[_0x30238c(0x23d)]=_0x309cda?_0x309cda[_0x30238c(0x25f)][0x0][_0x30238c(0x23d)]:_0x30238c(0x23a)+_0x5e1b32;}catch(_0x2b3890){_0x3bfd66[_0x30238c(0x24d)]=_0x30238c(0x27e),_0x3bfd66[_0x30238c(0x23d)]='Bot\x20'+_0x5e1b32;}}else _0x3bfd66[_0x30238c(0x24d)]=_0x30238c(0x27e),_0x3bfd66['botname']=_0x30238c(0x23a)+_0x5e1b32;return _0x3bfd66;}function getBotsWithMode(){const _0x4cb443=_0x521e86,_0x3d0b42=dbConfig[_0x4cb443(0x1ce)](_0x4cb443(0x156))['sortBy'](_0x4cb443(0x309))[_0x4cb443(0x1d9)]()||[];return _0x3d0b42[_0x4cb443(0x215)](_0x1d2d4c=>{const _0x3e1122=_0x4cb443;let _0x519f02=getBotAttributes(_0x1d2d4c[_0x3e1122(0x309)]);_0x1d2d4c[_0x3e1122(0x24d)]=_0x519f02[_0x3e1122(0x24d)];}),_0x3d0b42;}function getBotExchanges(){const _0x35b3f1=_0x521e86;let _0xe52fc2=[];const _0x45cd00=dbConfig[_0x35b3f1(0x1ce)]('bots')['sortBy']('botID')[_0x35b3f1(0x1d9)]()||[];_0x45cd00['forEach'](_0xf0021f=>{const _0x4e260e=_0x35b3f1;if(_0xf0021f[_0x4e260e(0x324)]==_0x4e260e(0x1c1)){const _0x2cf104=configpath+_0x4e260e(0x2f2)+_0xf0021f[_0x4e260e(0x309)]+_0x4e260e(0x19a),_0xd5f64e=fs[_0x4e260e(0x2c3)](_0x2cf104);let _0x10217a;if(_0xd5f64e){const _0x55aec9=fs['readFileSync'](_0x2cf104);try{const _0xd29a5f=JSON[_0x4e260e(0x2bd)](_0x55aec9);_0x10217a=_0xd29a5f?_0xd29a5f[_0x4e260e(0x25f)][0x0]['exchange']:null;}catch(_0x244d76){}}if(_0x10217a)_0xe52fc2['push'](_0x10217a);}});const _0x53b2c1=[...new Set(_0xe52fc2)][_0x35b3f1(0x1ac)]();return _0x53b2c1;}async function initUser(){const _0x44e967=_0x521e86;if(!settings[_0x44e967(0x204)]){const _0x3a3ee2=uuidRandom();mixpanel[_0x44e967(0x29c)](_0x3a3ee2),updateSetting(_0x44e967(0x204),_0x3a3ee2);}}async function initSecure(){const _0x346a2c=_0x521e86;let _0x4776e6=getSecure();if(!_0x4776e6['hasOwnProperty'](_0x346a2c(0x252))){let _0x5ee0ce=await generateKeys();_0x4776e6[_0x346a2c(0x201)]=_0x5ee0ce[_0x346a2c(0x201)],_0x4776e6[_0x346a2c(0x19e)]=_0x5ee0ce[_0x346a2c(0x19e)],_0x4776e6[_0x346a2c(0x252)]=crypto[_0x346a2c(0x235)](0x20)[_0x346a2c(0x29b)](_0x346a2c(0x16d));;storeSecure(_0x4776e6);}}function getSettings(){const _0x22faf7=_0x521e86;return dbSettings[_0x22faf7(0x1ce)](_0x22faf7(0x31e))[_0x22faf7(0x1d9)]()||{};}function getSecure(){const _0xc3858c=_0x521e86;return dbSecure['get'](_0xc3858c(0x2df))[_0xc3858c(0x1d9)]()||{};}function getBlacklist(){const _0x14d518=_0x521e86;return dbSecure[_0x14d518(0x1ce)](_0x14d518(0x2b6))[_0x14d518(0x1d9)]()||[];}function broadcastToBots(_0x55d0db,_0x565fca){const _0x4f4264=_0x521e86;config[_0x4f4264(0x215)](_0x347396=>{const _0x14fed7=_0x4f4264;if(_0x347396['status']==_0x14fed7(0x1c1)&&_0x347396[_0x14fed7(0x150)]=='running'||_0x347396['status']==_0x14fed7(0x291)&&_0x347396['live']=='running'){if(pid[_0x347396[_0x14fed7(0x309)]])pid[_0x347396[_0x14fed7(0x309)]][_0x14fed7(0x2f8)]({[_0x55d0db]:_0x565fca});}});}function storeSettings(_0x5d21c8,_0x48394a=![]){const _0x344bd4=_0x521e86;_0x5d21c8={...settings,..._0x5d21c8};if(_0x48394a&&_0x5d21c8[_0x344bd4(0x195)]!='************'&&_0x5d21c8['bbPassword']!=_0x344bd4(0x2ac)&&_0x5d21c8[_0x344bd4(0x195)]!=''){const _0x52820a=crypt[_0x344bd4(0x288)](secure[_0x344bd4(0x19e)],_0x5d21c8['bbPassword'])[_0x344bd4(0x22d)][_0x344bd4(0x316)]('@')[0x0],_0x483f5b=bcrypt['hashSync'](_0x52820a,saltRounds);_0x5d21c8={..._0x5d21c8,'bbPassword':_0x483f5b};}if(_0x48394a&&_0x5d21c8[_0x344bd4(0x19c)]!='************'&&_0x5d21c8[_0x344bd4(0x19c)]!=_0x344bd4(0x2ac)&&_0x5d21c8[_0x344bd4(0x19c)]!=''){const _0x34bc31=crypt['decrypt'](secure[_0x344bd4(0x19e)],_0x5d21c8[_0x344bd4(0x19c)])[_0x344bd4(0x22d)][_0x344bd4(0x316)]('@')[0x0];_0x5d21c8={..._0x5d21c8,'telegramToken':_0x34bc31};}const _0x57b5f9=_0x5d21c8[_0x344bd4(0x19c)]!='************'&&_0x5d21c8[_0x344bd4(0x19c)]!=settings[_0x344bd4(0x19c)]||_0x5d21c8[_0x344bd4(0x1fd)]!=settings[_0x344bd4(0x1fd)],_0x309bde=_0x5d21c8[_0x344bd4(0x19c)]==''||_0x5d21c8['telegramUsername']=='';if(_0x57b5f9)_0x5d21c8[_0x344bd4(0x27c)]=_0x344bd4(0x2f6);for(const [_0x1b437a,_0x24a791]of Object['entries'](_0x5d21c8)){if(_0x1b437a==_0x344bd4(0x19c)&&_0x24a791=='************'){_0x5d21c8[_0x344bd4(0x19c)]=settings[_0x344bd4(0x19c)];continue;};if(_0x1b437a==_0x344bd4(0x195)&&_0x24a791==_0x344bd4(0x191)){_0x5d21c8['bbPassword']=settings[_0x344bd4(0x195)];continue;};dbSettings[_0x344bd4(0x196)](_0x344bd4(0x20b)+_0x1b437a,_0x24a791)['write']();}settings=_0x5d21c8,io['to'](_0x344bd4(0x1e0))[_0x344bd4(0x311)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x344bd4(0x2e7)]),broadcastToBots('onepagemode',settings['onepagemode']);if(_0x57b5f9&&!_0x309bde)initTelegram();if(_0x57b5f9&&_0x309bde)disableTelegram();getAllClients()[_0x344bd4(0x215)](_0x1479cd=>{const _0x5155c6=_0x344bd4;getSocket(_0x1479cd['id'])[_0x5155c6(0x311)]('status',{'access':{'allow':![],'reason':_0x5155c6(0x2d3),'token':null}});});}function updateSetting(_0x3ebcfe,_0x510ad7){const _0x47c488=_0x521e86;dbSettings['set'](_0x47c488(0x20b)+_0x3ebcfe,_0x510ad7)['write'](),settings=getSettings(),io['to'](_0x47c488(0x1e0))[_0x47c488(0x311)](_0x47c488(0x31e),cleanSettings());}function storeSecure(_0x388672){const _0x10d1c8=_0x521e86;dbSecure['get'](_0x10d1c8(0x2df))[_0x10d1c8(0x306)](_0x388672)['write'](),secure=_0x388672;}function addBlacklist(_0x26c8dc){const _0x1f9a3f=_0x521e86;cleanBlacklist();let _0x2489e1;devices[_0x26c8dc][_0x1f9a3f(0x307)]?_0x2489e1=Math[_0x1f9a3f(0x1da)](devices[_0x26c8dc][_0x1f9a3f(0x307)][_0x1f9a3f(0x18f)],loginExpiry):_0x2489e1=loginExpiry,dbSecure[_0x1f9a3f(0x1ce)](_0x1f9a3f(0x2b6))[_0x1f9a3f(0x306)]({'expiry':new Date()['getTime']()+_0x2489e1*0x3c*0x3e8,'token':devices[_0x26c8dc]['access'][_0x1f9a3f(0x171)]})[_0x1f9a3f(0x19b)](),blacklist=dbSecure['get'](_0x1f9a3f(0x2b6))[_0x1f9a3f(0x1d9)]();}function cleanBlacklist(){const _0x522674=_0x521e86;let _0xb6727d=dbSecure[_0x522674(0x1ce)](_0x522674(0x2b6))[_0x522674(0x256)]()[_0x522674(0x1d9)](),_0x2997e6=new Date()[_0x522674(0x2de)]();_0xb6727d[_0x522674(0x215)](_0x4e1ffa=>{const _0x3be688=_0x522674;_0x4e1ffa[_0x3be688(0x18f)]<_0x2997e6&&dbSecure[_0x3be688(0x1ce)]('blacklist')[_0x3be688(0x281)]({'expiry':_0x4e1ffa[_0x3be688(0x18f)]})[_0x3be688(0x19b)]();});}function initStates(){let _0xc83167=getConfiguration();_0xc83167['forEach'](_0xeae7e5=>{const _0x1784be=_0x7004;_0xeae7e5['live']=_0x1784be(0x1c5);}),storeConfiguration(_0xc83167);}function onKeys(){const _0x202e1f=new RSA();return new Promise(_0x247eeb=>{_0x202e1f['generateKeyPairAsync']()['then'](_0x431313=>{_0x247eeb(_0x431313);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3e8432=_0x521e86;let _0x292ca4=getSettings(),_0x4d5c03=![];!_0x292ca4['hasOwnProperty'](_0x3e8432(0x170))&&(_0x292ca4['lastmsgtelegram']=0x0,_0x4d5c03=!![]);!_0x292ca4['hasOwnProperty'](_0x3e8432(0x263))&&(_0x292ca4[_0x3e8432(0x263)]=0x0,_0x4d5c03=!![]);!_0x292ca4[_0x3e8432(0x245)](_0x3e8432(0x16c))&&(_0x292ca4[_0x3e8432(0x16c)]='0.0.0',_0x4d5c03=!![]);!_0x292ca4[_0x3e8432(0x245)](_0x3e8432(0x32a))&&(_0x292ca4[_0x3e8432(0x32a)]=![],_0x4d5c03=!![]);if(_0x4d5c03)storeSettings(_0x292ca4);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x2c96b5=>{const _0x84263a=_0x3e8432;if(!_0x2c96b5['isDirectory']()){if(!_0x2c96b5[_0x84263a(0x242)][_0x84263a(0x287)](_0x84263a(0x2db)))fs[_0x84263a(0x22e)](configbackuppath+_0x2c96b5[_0x84263a(0x242)]);}else fs[_0x84263a(0x23e)](configbackuppath+_0x2c96b5['name'],{'recursive':!![]});});}catch(_0x23b91f){logger[_0x3e8432(0x2ca)](_0x3e8432(0x289),_0x23b91f);}}function storeConfiguration(_0x437492){const _0x34a265=_0x521e86;dbConfig[_0x34a265(0x1ce)](_0x34a265(0x156))[_0x34a265(0x281)]()['write'](),_0x437492[_0x34a265(0x215)](_0x1b2531=>{const _0x348b9b=_0x34a265;delete _0x1b2531[_0x348b9b(0x24d)];}),dbConfig['get'](_0x34a265(0x156))[_0x34a265(0x306)](..._0x437492)[_0x34a265(0x19b)](),config=_0x437492;}function resetPassword(){const _0x5015d3=_0x521e86;tgBot&&settings[_0x5015d3(0x1c2)]&&(tgBot[_0x5015d3(0x2f0)](_0x5015d3(0x168)),tgBot[_0x5015d3(0x259)](settings[_0x5015d3(0x1c2)],_0x5015d3(0x172),{'parse_mode':_0x5015d3(0x20f),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x5015d3(0x174)},{'text':'no','callback_data':'no'}]]}})[_0x5015d3(0x229)](_0x48c347=>{telegramError(_0x48c347);}),tgBot['on']('callback_query',async _0x436ec3=>{const _0x55c2ef=_0x5015d3,_0x2cbf71=_0x436ec3['data'],_0x4010ce=_0x436ec3[_0x55c2ef(0x22d)];tgBot[_0x55c2ef(0x21c)](_0x436ec3['id'])[_0x55c2ef(0x1b5)](async()=>{const _0x5aeecc=_0x55c2ef;if(_0x2cbf71!='no'){const _0x27ee8e=0xf,_0x497178=_0x5aeecc(0x194),_0x37ede0=Array[_0x5aeecc(0x1f8)](crypto['randomFillSync'](new Uint32Array(_0x27ee8e)))['map'](_0x3c4eeb=>_0x497178[_0x3c4eeb%_0x497178[_0x5aeecc(0x1c6)]])[_0x5aeecc(0x197)](''),_0x1f6f7c=bcrypt[_0x5aeecc(0x292)](_0x37ede0,saltRounds);storeSettings({'bbPassword':_0x1f6f7c}),await tgBot['sendMessage'](_0x4010ce['chat']['id'],_0x5aeecc(0x21d)+_0x37ede0,{'parse_mode':_0x5aeecc(0x20f)})[_0x5aeecc(0x229)](_0x163bed=>{telegramError(_0x163bed);});}else await tgBot['sendMessage'](_0x4010ce[_0x5aeecc(0x1d4)]['id'],_0x5aeecc(0x2bc))[_0x5aeecc(0x229)](_0xbeb632=>{telegramError(_0xbeb632);});}),tgBot['removeListener'](_0x55c2ef(0x168));}));}async function confirmRestore(_0x3afe25,_0x2d5358){const _0x2c75e8=_0x521e86;io['to'](_0x2c75e8(0x1e0))['emit'](_0x2c75e8(0x329),_0x2c75e8(0x2b9),_0x2c75e8(0x300)),tgBot&&settings[_0x2c75e8(0x1c2)]&&(tgBot[_0x2c75e8(0x2f0)](_0x2c75e8(0x168)),await tgBot[_0x2c75e8(0x259)](settings[_0x2c75e8(0x1c2)],_0x2c75e8(0x24c),{'parse_mode':_0x2c75e8(0x20f),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x2c75e8(0x229)](_0x29cbda=>{telegramError(_0x29cbda);}),tgBot['on']('callback_query',async _0x15a5a8=>{const _0x46925d=_0x2c75e8,_0x257cb3=_0x15a5a8[_0x46925d(0x264)],_0x2fd672=_0x15a5a8[_0x46925d(0x22d)];tgBot['answerCallbackQuery'](_0x15a5a8['id'])['then'](async()=>{const _0xf47929=_0x46925d;_0x257cb3=='yes'?(await tgBot[_0xf47929(0x259)](_0x2fd672[_0xf47929(0x1d4)]['id'],_0xf47929(0x182),{'parse_mode':_0xf47929(0x20f)})[_0xf47929(0x229)](_0x5084de=>{telegramError(_0x5084de);}),unzipFile(_0x3afe25,_0x2d5358)):(logger[_0xf47929(0x2ca)](_0xf47929(0x218)),await tgBot[_0xf47929(0x259)](_0x2fd672['chat']['id'],_0xf47929(0x218))[_0xf47929(0x229)](_0xff26be=>{telegramError(_0xff26be);}));}),tgBot[_0x46925d(0x2f0)](_0x46925d(0x168));}));}function getServerTime(){const _0x26c872=_0x521e86,_0x37c940=new Date();return _0x37c940['getFullYear']()+'/'+(_0x37c940[_0x26c872(0x1d7)]()+0x1)['toString']()[_0x26c872(0x2e5)](0x2,'0')+'/'+_0x37c940[_0x26c872(0x1d3)]()[_0x26c872(0x29b)]()[_0x26c872(0x2e5)](0x2,'0')+'\x20'+_0x37c940[_0x26c872(0x2d8)]()[_0x26c872(0x29b)]()[_0x26c872(0x2e5)](0x2,'0')+':'+_0x37c940['getMinutes']()[_0x26c872(0x29b)]()[_0x26c872(0x2e5)](0x2,'0')+':'+_0x37c940[_0x26c872(0x190)]()[_0x26c872(0x29b)]()[_0x26c872(0x2e5)](0x2,'0');}function getTimeStamp(){const _0x2540e7=_0x521e86,_0x2036fd=shiftedTime();return _0x2036fd[_0x2540e7(0x16a)]()+'/'+(_0x2036fd[_0x2540e7(0x1d7)]()+0x1)[_0x2540e7(0x29b)]()[_0x2540e7(0x2e5)](0x2,'0')+'/'+_0x2036fd[_0x2540e7(0x1d3)]()[_0x2540e7(0x29b)]()[_0x2540e7(0x2e5)](0x2,'0')+'\x20'+_0x2036fd[_0x2540e7(0x2d8)]()['toString']()[_0x2540e7(0x2e5)](0x2,'0')+':'+_0x2036fd['getMinutes']()[_0x2540e7(0x29b)]()['padStart'](0x2,'0')+':'+_0x2036fd['getSeconds']()['toString']()[_0x2540e7(0x2e5)](0x2,'0');}function getCleanTimeStamp(){const _0x414782=_0x521e86,_0xa51d22=shiftedTime();return _0xa51d22[_0x414782(0x16a)]()+(_0xa51d22[_0x414782(0x1d7)]()+0x1)['toString']()[_0x414782(0x2e5)](0x2,'0')+_0xa51d22[_0x414782(0x1d3)]()[_0x414782(0x29b)]()[_0x414782(0x2e5)](0x2,'0')+'-'+_0xa51d22[_0x414782(0x2d8)]()['toString']()['padStart'](0x2,'0')+_0xa51d22[_0x414782(0x1c7)]()['toString']()[_0x414782(0x2e5)](0x2,'0')+_0xa51d22[_0x414782(0x190)]()[_0x414782(0x29b)]()[_0x414782(0x2e5)](0x2,'0');}function shiftedTime(){const _0x2b703d=_0x521e86,_0x29ff98=new Date();let _0x530752=_0x29ff98;if(settings[_0x2b703d(0x2e7)]&&settings['timeshift']!==0x0)_0x530752=fns[_0x2b703d(0x2f4)](_0x29ff98,{'hours':settings['timeshift']});return _0x530752;}function startScheduler(){const _0xf3b70b=_0x521e86,_0x2a1e7b=new Date()[_0xf3b70b(0x2b3)](),_0x19dca8=shiftedTime()[_0xf3b70b(0x2d8)]();_0x19dca8==0x4&&backupConfigFiles();_0x19dca8==0x0&&rotateLogFiles();_0x2a1e7b%0x6==0x0&&triggerAnalytics();_0x2a1e7b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x32525f){const _0x5b45a3=_0x521e86;logger[_0x5b45a3(0x2ca)](_0x5b45a3(0x212)+_0x32525f);const _0x113ed1=getBotsWithMode();_0x113ed1[_0x5b45a3(0x1c6)]>0x0?confirmRestore(configbackuppath,_0x32525f):unzipFile(configbackuppath,_0x32525f);}function _0x7004(_0x29dcdd,_0x39a8ca){const _0x3d3d70=_0x2453();return _0x7004=function(_0x10cd9d,_0x21dc7d){_0x10cd9d=_0x10cd9d-0x14f;let _0x245386=_0x3d3d70[_0x10cd9d];return _0x245386;},_0x7004(_0x29dcdd,_0x39a8ca);}async function getBackupFiles(_0x11f495=null){const _0x1f781c=_0x521e86;let _0x46969d=[],_0x20798c=fs[_0x1f781c(0x301)](configbackuppath,{'withFileTypes':!![]});_0x20798c[_0x1f781c(0x1ac)]((_0x4ccb8f,_0x5db1a3)=>_0x4ccb8f['name']<_0x5db1a3['name']?0x1:_0x5db1a3['name']<_0x4ccb8f['name']?-0x1:0x0),_0x20798c['forEach'](_0xc6cfa1=>{const _0x398ea2=_0x1f781c;if(!_0xc6cfa1[_0x398ea2(0x1fe)]()&&_0xc6cfa1[_0x398ea2(0x242)][_0x398ea2(0x287)](_0x398ea2(0x2db))&&_0xc6cfa1[_0x398ea2(0x242)][_0x398ea2(0x32b)]('.zip')){const _0x5a37ac=formatDate(fs['statSync'](configbackuppath+_0xc6cfa1['name'])[_0x398ea2(0x15b)]);_0x46969d[_0x398ea2(0x306)]({'name':_0xc6cfa1[_0x398ea2(0x242)],'mtime':_0x5a37ac});}});if(_0x11f495)io['to'](_0x11f495)[_0x1f781c(0x311)](_0x1f781c(0x319),_0x46969d);else return _0x46969d;}async function backupConfigFiles(){const _0x162cc1=_0x521e86;await zipFiles(_0x162cc1(0x14f));const _0x163b77=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x162cc1(0x1a0),configbackuppath+('backup-full@'+_0x163b77+'.zip'));let _0x28dbd3=fs[_0x162cc1(0x301)](configbackuppath,{'withFileTypes':!![]});_0x28dbd3[_0x162cc1(0x1ac)]((_0x50dad5,_0x87991e)=>_0x50dad5[_0x162cc1(0x242)]<_0x87991e[_0x162cc1(0x242)]?0x1:_0x87991e[_0x162cc1(0x242)]<_0x50dad5[_0x162cc1(0x242)]?-0x1:0x0),_0x28dbd3[_0x162cc1(0x1c6)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x28dbd3[_0x28dbd3[_0x162cc1(0x1c6)]-0x1][_0x162cc1(0x242)]);}function rotateLogFiles(){const _0x5ad1f5=_0x521e86,_0x4677b3=fs[_0x5ad1f5(0x1e5)](logspath+_0x5ad1f5(0x254)),_0x3e2f06=_0x4677b3[_0x5ad1f5(0x2d5)]/0x400;if(_0x3e2f06>0x64){let _0x9db642=fs[_0x5ad1f5(0x301)](logspath,{'withFileTypes':!![]});_0x9db642[_0x5ad1f5(0x1ac)]((_0x1d98de,_0x56322d)=>_0x1d98de[_0x5ad1f5(0x242)]<_0x56322d[_0x5ad1f5(0x242)]?0x1:_0x56322d[_0x5ad1f5(0x242)]<_0x1d98de[_0x5ad1f5(0x242)]?-0x1:0x0),_0x9db642[_0x5ad1f5(0x215)](_0x48b520=>{const _0x3dfa92=_0x5ad1f5;if(_0x48b520[_0x3dfa92(0x242)]=='output-002.log')fs[_0x3dfa92(0x1fa)](logspath+_0x48b520[_0x3dfa92(0x242)],logspath+'output-003.log');if(_0x48b520['name']==_0x3dfa92(0x27d))fs[_0x3dfa92(0x1fa)](logspath+_0x48b520['name'],logspath+_0x3dfa92(0x17a));_0x48b520[_0x3dfa92(0x242)]==_0x3dfa92(0x254)&&(fs[_0x3dfa92(0x1fa)](logspath+_0x48b520[_0x3dfa92(0x242)],logspath+_0x3dfa92(0x27d)),fs[_0x3dfa92(0x1cf)](logspath+_0x48b520[_0x3dfa92(0x242)],''));});}}async function zipFiles(_0x5884f0){const _0x395804=_0x521e86;let _0x1a7dab;if(_0x5884f0==_0x395804(0x250))_0x1a7dab=logspath;if(_0x5884f0=='backup')_0x1a7dab=configpath;if(_0x5884f0==_0x395804(0x14f))_0x1a7dab=configpath;let _0x4d6d8f=fs[_0x395804(0x301)](_0x1a7dab,{'withFileTypes':!![]});const _0x3a7d33=new require(_0x395804(0x268))();_0x4d6d8f['forEach'](_0x42a62d=>{const _0x377d7f=_0x395804;if(!_0x42a62d[_0x377d7f(0x1fe)]()){let _0x4285d7=fs[_0x377d7f(0x17f)](_0x1a7dab+_0x42a62d[_0x377d7f(0x242)]);if(_0x5884f0==_0x377d7f(0x2ba)){const _0x223f47=/^bot-[0-9]{3}-config.json$/,_0x42caf2=_0x223f47['test'](_0x42a62d[_0x377d7f(0x242)]);if(_0x42caf2){const _0x1d5be9=JSON[_0x377d7f(0x2bd)](_0x4285d7);if(_0x1d5be9[_0x377d7f(0x25f)][0x0]){_0x1d5be9[_0x377d7f(0x25f)][0x0][_0x377d7f(0x30d)]=_0x377d7f(0x2ac),_0x1d5be9[_0x377d7f(0x25f)][0x0][_0x377d7f(0x277)]=_0x377d7f(0x2ac);if(_0x1d5be9['bot'][0x0][_0x377d7f(0x2b8)])_0x1d5be9[_0x377d7f(0x25f)][0x0]['apiPassword']=_0x377d7f(0x2ac);}_0x4285d7=JSON[_0x377d7f(0x208)](_0x1d5be9,null,0x2);}if(_0x42a62d['name']==_0x377d7f(0x21b)){const _0x2a3572=JSON['parse'](_0x4285d7);if(_0x2a3572[_0x377d7f(0x31e)][_0x377d7f(0x276)])_0x2a3572['settings'][_0x377d7f(0x276)]=![];if(_0x2a3572[_0x377d7f(0x31e)]['bbPassword'])_0x2a3572['settings'][_0x377d7f(0x195)]=_0x377d7f(0x2ac);if(_0x2a3572['settings'][_0x377d7f(0x19c)])_0x2a3572[_0x377d7f(0x31e)]['telegramToken']='***';if(_0x2a3572[_0x377d7f(0x31e)][_0x377d7f(0x1c2)])_0x2a3572['settings']['telegramChatId']=null;_0x4285d7=JSON[_0x377d7f(0x208)](_0x2a3572,null,0x2);}if(_0x42a62d[_0x377d7f(0x242)]!='bb-secure.json')_0x3a7d33['file'](_0x42a62d['name'],_0x4285d7);}else _0x3a7d33['file'](_0x42a62d[_0x377d7f(0x242)],_0x4285d7);}});const _0x88fb5a=_0x3a7d33[_0x395804(0x1be)]({'base64':![],'compression':_0x395804(0x200)});fs[_0x395804(0x1cf)](zippath+(_0x5884f0+_0x395804(0x1bc)),_0x88fb5a,_0x395804(0x159));}async function unzipFile(_0x353799,_0x372e1c){const _0x4c7507=_0x521e86;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x19b777=>{const _0xeb2820=_0x7004;if(!_0x19b777[_0xeb2820(0x1fe)]())fs[_0xeb2820(0x23e)](configpath+_0x19b777['name']);});const _0x9f61f5=fs[_0x4c7507(0x17f)](_0x353799+_0x372e1c,'binary'),_0x4d2dec=new require(_0x4c7507(0x268))(_0x9f61f5,{'base64':![],'checkCRC32':!![]});Object[_0x4c7507(0x2a9)](_0x4d2dec[_0x4c7507(0x29f)])[_0x4c7507(0x215)](_0x4746dc=>{const _0x267bdb=_0x4c7507,_0x3743a6=_0x4d2dec[_0x267bdb(0x29f)][_0x4746dc];fs[_0x267bdb(0x1cf)](configpath+_0x3743a6['name'],_0x3743a6[_0x267bdb(0x20c)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x4c7507(0x215)](_0x3439da=>{const _0x283bbb=_0x4c7507;if(!_0x3439da[_0x283bbb(0x1fe)]())fs['rmSync'](temppath+_0x3439da[_0x283bbb(0x242)]);}),logger[_0x4c7507(0x2ca)](_0x4c7507(0x295)),process[_0x4c7507(0x2f8)]({'restore':!![]},_0x2d88b7=>{});}async function getPublicIp(){const _0x7e065=_0x521e86;try{const _0xd79af2=await axios[_0x7e065(0x1ce)](_0x7e065(0x158));publicip=_0xd79af2[_0x7e065(0x264)]['ip'];}catch(_0x54170b){}}async function triggerAnalytics(){const _0x415048=_0x521e86;if(!publicip)await getPublicIp();const _0x117a7c=getBotsWithMode();let _0x9f271e=0x0;_0x117a7c['forEach'](_0x2c4213=>{const _0x440195=_0x7004;if(_0x2c4213[_0x440195(0x324)]===_0x440195(0x1c1))_0x9f271e++;});const _0xd765ce=getBotExchanges();mixpanel[_0x415048(0x21f)](_0x415048(0x269),{'distinct_id':settings[_0x415048(0x204)],'ip':publicip,'version':serverversion,'numbots':_0x117a7c[_0x415048(0x1c6)],'numbotsenabled':_0x9f271e,'exchanges':_0xd765ce,'environment':environment});}async function getMessages(){const _0x935311=_0x521e86,_0x354252=_0x935311(0x2a5),_0x289902=new GraphQLClient(_0x354252),_0x4327e8={'authorization':_0x935311(0x2e0)},_0x391375=serverversion[_0x935311(0x316)]('.'),_0x4f2c9f=_0x391375[0x0]+'.'+_0x391375[0x1],_0x3e31e6=Math[_0x935311(0x23b)](settings[_0x935311(0x170)],settings[_0x935311(0x263)]),_0x3f4b6b={'last':parseInt(_0x3e31e6),'bbm':_0x4f2c9f},_0x5dd425=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x46040c;try{_0x46040c=await _0x289902[_0x935311(0x30e)](_0x5dd425,_0x3f4b6b,_0x4327e8);}catch(_0x54d7c7){}if(_0x46040c&&_0x46040c[_0x935311(0x167)]){let _0x57808c=settings[_0x935311(0x170)];newMessages=[];for(const _0x38c729 of _0x46040c[_0x935311(0x167)]){newMessages[_0x935311(0x306)](_0x38c729);let _0x401af2=![];_0x38c729[_0x935311(0x202)]&&(updateSetting(_0x935311(0x16c),_0x38c729[_0x935311(0x202)]),_0x401af2=isNewerVersion(serverversion,_0x38c729[_0x935311(0x202)])||serverversion==_0x38c729['bbvNew']);if(!_0x401af2&&_0x38c729[_0x935311(0x29a)]>_0x57808c){if(_0x38c729[_0x935311(0x18b)]===_0x935311(0x27b)||serverversion[_0x935311(0x287)](_0x38c729[_0x935311(0x18b)])){let _0x26033b=''+_0x38c729[_0x935311(0x328)]+'\x0a\x0a'+_0x38c729[_0x935311(0x22d)];const _0x1bcb64=await sendTelegramMsg(toTelegramMarkdown(_0x26033b),_0x935311(0x15c));if(_0x1bcb64)_0x57808c=_0x38c729['number'];}}}updateAvailable=isNewerVersion(settings[_0x935311(0x16c)],serverversion),updateSetting(_0x935311(0x170),_0x57808c),emitMessages();}}function emitMessages(){const _0x1798d5=_0x521e86,_0x384375=settings['lastmsgemitted'];let _0x93bd78=[];newMessages[_0x1798d5(0x215)](_0x29e0e5=>{const _0x38f054=_0x1798d5;_0x29e0e5[_0x38f054(0x29a)]>_0x384375&&_0x93bd78[_0x38f054(0x306)](_0x29e0e5);}),_0x93bd78[_0x1798d5(0x1c6)]>0x0&&getAllClients()[_0x1798d5(0x215)](_0x19bdcd=>{const _0x221066=_0x1798d5;getSocket(_0x19bdcd['id'])[_0x221066(0x311)]('message',_0x93bd78);});}function confirmMessage(_0x4053f0){const _0x4e431c=_0x521e86;updateSetting(_0x4e431c(0x263),Number(_0x4053f0));}function isNewerVersion(_0x44bee8,_0x7b7636){const _0x4f3ad3=_0x521e86,_0x569d1c=_0x7b7636[_0x4f3ad3(0x316)]('.'),_0x5f5184=_0x44bee8[_0x4f3ad3(0x316)]('.');for(var _0x3ecb93=0x0;_0x3ecb93<_0x5f5184[_0x4f3ad3(0x1c6)];_0x3ecb93++){const _0x161285=~~_0x5f5184[_0x3ecb93],_0x408e55=~~_0x569d1c[_0x3ecb93];if(_0x161285>_0x408e55)return!![];if(_0x161285<_0x408e55)return![];}return![];}function toTelegramMarkdown(_0x56a114){const _0x54c386=_0x521e86,_0x3835c5=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2e3927=/\*{2}(.+?)\*{2}/gim;return _0x56a114=_0x56a114['replace'](_0x3835c5,_0x54c386(0x1a6))[_0x54c386(0x280)](_0x2e3927,_0x54c386(0x293)),_0x56a114;}async function validateConfigFile(){const _0x49d043=_0x521e86,_0x1bec0e=dbConfig[_0x49d043(0x1ce)](_0x49d043(0x156))['sortBy'](_0x49d043(0x309))[_0x49d043(0x1d9)]()||[];if(_0x1bec0e[_0x49d043(0x1c6)]==0x0){let _0x5501bb=0x0,_0x4278bb=[];const _0x197c33=/^bot-([0-9]{3})-config.json$/,_0x58dffc=fs[_0x49d043(0x301)](configpath);_0x58dffc[_0x49d043(0x215)](_0x5ead08=>{const _0x594a59=_0x49d043,_0x359476=_0x197c33[_0x594a59(0x310)](_0x5ead08);if(_0x359476){const _0x50c78f=_0x359476[0x1];let _0x5a84ae=getBotAttributes(_0x50c78f);_0x4278bb[_0x594a59(0x306)]({'botID':_0x50c78f,'botname':_0x5a84ae[_0x594a59(0x23d)],'status':'disabled','live':_0x594a59(0x1c5)}),_0x5501bb++;}}),_0x5501bb!=0x0&&(dbConfig['get'](_0x49d043(0x156))[_0x49d043(0x1cc)](_0x4278bb)[_0x49d043(0x19b)](),config=_0x4278bb,restoredConfigFile=_0x5501bb);}}async function restoreConfigNotify(_0x4f5f75){const _0x919915=_0x521e86;let _0x696029;if(restoredConfigFile==0x1)_0x696029='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x696029=_0x919915(0x1c0);if(_0x4f5f75)io['to'](_0x919915(0x1e0))[_0x919915(0x311)](_0x919915(0x329),_0x696029);else{logger[_0x919915(0x22c)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x696029),logger[_0x919915(0x22c)](_0x919915(0x1d8)),logger[_0x919915(0x22c)]('');if(tgBot&&settings[_0x919915(0x1c2)]&&settings[_0x919915(0x27c)]!='orders')tgBot[_0x919915(0x259)](settings[_0x919915(0x1c2)],_0x919915(0x1b9)+_0x696029)[_0x919915(0x229)](_0x14b59f=>{telegramError(_0x14b59f);});}}function validateCredentials(_0x30b64f,_0x1a8abc){const _0x28f8c7=_0x521e86;if(_0x30b64f[_0x28f8c7(0x302)]==settings[_0x28f8c7(0x1d6)]&&bcrypt[_0x28f8c7(0x246)](_0x30b64f[_0x28f8c7(0x227)],settings[_0x28f8c7(0x195)])){if(settings[_0x28f8c7(0x166)])return{'allow':![],'reason':_0x28f8c7(0x162),'token':null};else{const _0x498a97=generateLoginToken(_0x1a8abc);return{'allow':!![],'reason':_0x28f8c7(0x260),'token':_0x498a97};}}else return{'allow':![],'reason':_0x28f8c7(0x220),'token':null};}function refreshToken(_0x5b9215){const _0x276a54=_0x521e86,_0x242a81=generateLoginToken(_0x5b9215);return{'allow':!![],'reason':_0x276a54(0x260),'token':_0x242a81};}function validateAccess(_0x3a5fbe,_0x30c124,_0x3924fd){const _0x20c194=_0x521e86,_0x2c91e5=_0x3924fd?_0x3924fd:devices[_0x30c124]['ip'];let _0x2cbf98;const _0x359c24=_0x4480ab=>{const _0x52d384=_0x7004;if(settings[_0x52d384(0x276)]){if(settings[_0x52d384(0x166)]){if(telegram2FaApproved(_0x30c124)){const _0xa07f49=generateLoginToken(_0x30c124);return{'allow':!![],'reason':_0x52d384(0x2cb),'token':_0xa07f49};}else return{'allow':![],'reason':_0x52d384(0x160),'token':null};}else return _0x2cbf98=validToken(_0x4480ab,_0x30c124),_0x2cbf98['hasOwnProperty'](_0x52d384(0x300))?{'allow':!![],'reason':_0x52d384(0x296),'token':_0x4480ab}:{'allow':![],'reason':_0x52d384(0x160),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x4bfdff=[...settings['whitelist'],_0x20c194(0x1a7),_0x20c194(0x2b7),'127.0.0.1'];if(_0x4bfdff['includes'](_0x2c91e5))return _0x359c24(_0x3a5fbe);else{_0x2cbf98=validToken(_0x3a5fbe,_0x30c124);if(_0x2cbf98[_0x20c194(0x245)](_0x20c194(0x300)))return _0x359c24(_0x3a5fbe);else{if(telegramIpApproved(_0x30c124)){const _0x5ef195=generateToken(_0x30c124);return _0x2cbf98=_0x359c24(_0x3a5fbe),_0x2cbf98[_0x20c194(0x2c2)]?{'allow':!![],'reason':_0x20c194(0x192),'token':_0x5ef195}:_0x2cbf98;}else return settings[_0x20c194(0x2e3)]?{'allow':![],'reason':_0x20c194(0x2c0),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x359c24(_0x3a5fbe);}function timelyDecrypt(_0x492f10,_0x162a2a=!![]){const _0x5e232f=_0x521e86;if(_0x492f10)try{const _0x20b792=crypt['decrypt'](secure[_0x5e232f(0x19e)],_0x492f10)[_0x5e232f(0x22d)],_0x4895dc=_0x20b792[_0x5e232f(0x316)]('@')[0x0],_0x75e68=_0x20b792[_0x5e232f(0x316)]('@')[0x1],_0x110f1a=new Date()[_0x5e232f(0x2de)]();if(_0x162a2a){if(_0x110f1a-_0x75e68<maxSecretAge*0x3e8)return _0x4895dc;else return![];}else return _0x4895dc;}catch(_0x56d55e){return![];}else return![];}const validToken=(_0xbcd884,_0x9ee180)=>{const _0x488498=_0x521e86,_0x245ea5=devices[_0x9ee180]['ip'];if(!_0xbcd884)return{'error':'No\x20authentication\x20token'};for(let _0x220ac5 of blacklist){if(_0x220ac5[_0x488498(0x171)]==_0xbcd884)return{'error':_0x488498(0x262)};}let _0x1b3e8a;try{_0x1b3e8a=jwt['verify'](_0xbcd884,secure['secret']+_0x9ee180);}catch{return{'error':_0x488498(0x284)};}if(!_0x1b3e8a['hasOwnProperty'](_0x488498(0x2bb))&&!_0x1b3e8a[_0x488498(0x245)](_0x488498(0x302))||!_0x1b3e8a[_0x488498(0x245)](_0x488498(0x29e)))return{'error':_0x488498(0x267)};if(!_0x1b3e8a[_0x488498(0x245)](_0x488498(0x302))&&_0x1b3e8a[_0x488498(0x245)](_0x488498(0x2bb))){const {clientip:_0x507150}=_0x1b3e8a;return _0x245ea5==_0x507150?{'success':_0x488498(0x26d)}:{'error':_0x488498(0x2a0)};}else{if(_0x1b3e8a[_0x488498(0x245)](_0x488498(0x302))&&_0x1b3e8a['hasOwnProperty'](_0x488498(0x2bb))){const {username:_0x599557,clientip:_0x559177}=_0x1b3e8a;return settings[_0x488498(0x1d6)]==_0x599557&&_0x245ea5==_0x559177?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x488498(0x1f4)};}}},generateLoginToken=_0x4f7398=>{const _0xb4206a=_0x521e86;if(_0x4f7398){const _0x42e0dc=devices[_0x4f7398]['ip'];return jwt[_0xb4206a(0x1c9)]({'username':settings[_0xb4206a(0x1d6)],'clientip':_0x42e0dc},secure['secret']+_0x4f7398,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x35b439=>{const _0x173c0f=_0x521e86;if(_0x35b439){const _0x24ae6d=devices[_0x35b439]['ip'];return jwt[_0x173c0f(0x1c9)]({'clientip':_0x24ae6d},secure[_0x173c0f(0x252)]+_0x35b439,{'expiresIn':devices[_0x35b439][_0x173c0f(0x307)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x547d42=>{const _0x1ea259=_0x521e86;let _0x232131=![];return devices[_0x547d42]['telegramIpApproval']&&devices[_0x547d42][_0x1ea259(0x307)][_0x1ea259(0x18f)]!=_0x1ea259(0x2fc)&&(_0x232131=devices[_0x547d42][_0x1ea259(0x307)][_0x1ea259(0x2bb)]==devices[_0x547d42]['ip']&&new Date()[_0x1ea259(0x2de)]()-devices[_0x547d42][_0x1ea259(0x307)][_0x1ea259(0x224)]<devices[_0x547d42]['telegramIpApproval'][_0x1ea259(0x18f)]*0x3c*0x3e8),_0x232131;},telegram2FaApproved=_0x52de38=>{const _0x1b1cd9=_0x521e86;let _0x46923b=![];return devices[_0x52de38][_0x1b1cd9(0x30a)]&&devices[_0x52de38][_0x1b1cd9(0x30a)][_0x1b1cd9(0x18f)]!='reject'&&(_0x46923b=devices[_0x52de38][_0x1b1cd9(0x30a)][_0x1b1cd9(0x2bb)]==devices[_0x52de38]['ip']&&new Date()[_0x1b1cd9(0x2de)]()-devices[_0x52de38][_0x1b1cd9(0x30a)][_0x1b1cd9(0x224)]<devices[_0x52de38][_0x1b1cd9(0x30a)][_0x1b1cd9(0x18f)]*0x3c*0x3e8),_0x46923b;},normalizeIP=_0x1fbfb6=>{const _0x343423=_0x521e86;let _0x38cc12=null,_0x1f80b8=null;if(ipaddr['isValid'](_0x1fbfb6)){const _0x5ac2c4=ipaddr[_0x343423(0x2bd)](_0x1fbfb6);_0x5ac2c4['kind']()===_0x343423(0x278)?(_0x5ac2c4['isIPv4MappedAddress']()&&(_0x38cc12=_0x5ac2c4['toIPv4Address']()[_0x343423(0x29b)]()),_0x1f80b8=_0x5ac2c4[_0x343423(0x29b)]()):(_0x38cc12=_0x5ac2c4[_0x343423(0x29b)](),_0x1f80b8=_0x5ac2c4[_0x343423(0x199)]()[_0x343423(0x29b)]());}return{'show':_0x38cc12?_0x38cc12:_0x1f80b8,'store':_0x1f80b8};};function formatDate(_0x25c413){const _0x14d381=_0x521e86;return _0x25c413[_0x14d381(0x16a)]()+'/'+(_0x25c413[_0x14d381(0x1d7)]()+0x1)[_0x14d381(0x29b)]()[_0x14d381(0x2e5)](0x2,'0')+'/'+_0x25c413[_0x14d381(0x1d3)]()['toString']()[_0x14d381(0x2e5)](0x2,'0')+'\x20'+_0x25c413[_0x14d381(0x2d8)]()[_0x14d381(0x29b)]()[_0x14d381(0x2e5)](0x2,'0')+':'+_0x25c413[_0x14d381(0x1c7)]()[_0x14d381(0x29b)]()[_0x14d381(0x2e5)](0x2,'0')+':'+_0x25c413[_0x14d381(0x190)]()[_0x14d381(0x29b)]()[_0x14d381(0x2e5)](0x2,'0');}function sleep(_0x58ea2f){return new Promise(_0x4bfb11=>setTimeout(_0x4bfb11,_0x58ea2f));}