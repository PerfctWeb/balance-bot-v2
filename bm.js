const _0x4e5dcf=_0x3687;(function(_0x17c2b3,_0x1f99de){const _0x1bcc38=_0x3687,_0x5ea638=_0x17c2b3();while(!![]){try{const _0x547e13=-parseInt(_0x1bcc38(0x1d9))/0x1*(parseInt(_0x1bcc38(0x2ee))/0x2)+-parseInt(_0x1bcc38(0x2d3))/0x3+-parseInt(_0x1bcc38(0x2f6))/0x4+parseInt(_0x1bcc38(0x15c))/0x5+parseInt(_0x1bcc38(0x1f1))/0x6+-parseInt(_0x1bcc38(0x128))/0x7+parseInt(_0x1bcc38(0x205))/0x8;if(_0x547e13===_0x1f99de)break;else _0x5ea638['push'](_0x5ea638['shift']());}catch(_0x430272){_0x5ea638['push'](_0x5ea638['shift']());}}}(_0x36b7,0xb9268));const _0x4c7cd5=function(){let _0x6e3d8e=!![];return function(_0x1fe5a3,_0x247c19){const _0x1c2cda=_0x6e3d8e?function(){const _0x5c5349=_0x3687;if(_0x247c19){const _0x1bb060=_0x247c19[_0x5c5349(0x246)](_0x1fe5a3,arguments);return _0x247c19=null,_0x1bb060;}}:function(){};return _0x6e3d8e=![],_0x1c2cda;};}(),_0x4c2e75=_0x4c7cd5(this,function(){const _0x57a078=_0x3687;return _0x4c2e75['toString']()['search'](_0x57a078(0x2d0))[_0x57a078(0x147)]()['constructor'](_0x4c2e75)[_0x57a078(0x133)]('(((.+)+)+)+$');});_0x4c2e75();'use strict';process[_0x4e5dcf(0x1ea)][_0x4e5dcf(0x17d)]=0x1;const childProcess=require(_0x4e5dcf(0x25d)),fs=require('fs'),fns=require(_0x4e5dcf(0x2f9)),low=require('lowdb'),FileSync=require(_0x4e5dcf(0x276)),path=require(_0x4e5dcf(0x244)),crypto=require(_0x4e5dcf(0x1a6)),Crypt=require('hybrid-crypto-js')[_0x4e5dcf(0x1ec)],RSA=require(_0x4e5dcf(0x1b5))['RSA'],bcrypt=require('bcryptjs'),jwt=require(_0x4e5dcf(0x23b)),ipaddr=require(_0x4e5dcf(0x13f)),argv=require(_0x4e5dcf(0x260))(process[_0x4e5dcf(0x158)]['slice'](0x2))['argv'],uuidRandom=require(_0x4e5dcf(0x174)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x4e5dcf(0x27f)),axios=require('axios'),{GraphQLClient,gql}=require(_0x4e5dcf(0x2e6)),util=require(_0x4e5dcf(0x28b)),fileUpload=require(_0x4e5dcf(0x1e5)),{networkInterfaces}=require('os'),PORT=argv[_0x4e5dcf(0x160)]||_0x4e5dcf(0x287),pattern=/^[0-9]{2,4}$/;!pattern[_0x4e5dcf(0x25c)](PORT)&&(console[_0x4e5dcf(0x15b)](_0x4e5dcf(0x2a5)+PORT+_0x4e5dcf(0x252)),process[_0x4e5dcf(0x1b1)](0x1));const HOST=argv[_0x4e5dcf(0x144)]||null,userID=argv[_0x4e5dcf(0x2b8)]||'',debugging=argv['d']||![],nodeversion=process[_0x4e5dcf(0x197)][_0x4e5dcf(0x2a3)];let bbpath=_0x4e5dcf(0x1d1),bbpath2='';const botfile=_0x4e5dcf(0x1ac),configfile=_0x4e5dcf(0x16a),settingsfile=_0x4e5dcf(0x166),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x4e5dcf(0x29a))['environment']||_0x4e5dcf(0x1a3),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4e5dcf(0x233)),configpath=userID?bbpath+_0x4e5dcf(0x163)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x4e5dcf(0x2c6)+userID+'/':bbpath+_0x4e5dcf(0x2c6),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x4e5dcf(0x1cf),loggerfile=fs[_0x4e5dcf(0x17c)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x4e5dcf(0x2a1);!fs['existsSync'](configpath)&&fs[_0x4e5dcf(0x1f8)](configpath);!fs[_0x4e5dcf(0x26f)](configbackuppath)&&fs[_0x4e5dcf(0x1f8)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x4e5dcf(0x1f8)](logspath);!fs['existsSync'](zippath)&&fs[_0x4e5dcf(0x1f8)](zippath);!fs[_0x4e5dcf(0x26f)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x4e5dcf(0x286)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4e5dcf(0x277)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4e5dcf(0x2ca),'onepagemode':![]}})[_0x4e5dcf(0x286)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4e5dcf(0x277)]({'secure':{},'blacklist':[]})[_0x4e5dcf(0x286)]();let crypt=new Crypt({'md':_0x4e5dcf(0x25e),'rsaStandard':_0x4e5dcf(0x184)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4e5dcf(0x1ab)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x4e5dcf(0x28c)]!='')initTelegram();const parseColor=(_0xc990,_0x57e6c9)=>{const _0x4fbed0=_0x4e5dcf,_0xf69a04=/#[A-Z]{3}#/g;if(typeof _0xc990==_0x4fbed0(0x157)){!_0x57e6c9?_0xc990=_0xc990[_0x4fbed0(0x2ce)](_0xf69a04,''):(_0xc990=_0xc990[_0x4fbed0(0x2ce)](/#BLU#/g,_0x4fbed0(0x1d5)),_0xc990=_0xc990[_0x4fbed0(0x2ce)](/#RED#/g,'\x1b[31m'),_0xc990=_0xc990[_0x4fbed0(0x2ce)](/#YEL#/g,_0x4fbed0(0x301)),_0xc990=_0xc990['replace'](/#MAG#/g,_0x4fbed0(0x1d0)),_0xc990=_0xc990['replace'](/#CYA#/g,_0x4fbed0(0x264)),_0xc990=_0xc990['replace'](/#RES#/g,'\x1b[0m'));;}return _0xc990;},logger={'screen':_0xda03a2=>{const _0x141d71=_0x4e5dcf;console[_0x141d71(0x15b)](parseColor(_0xda03a2,!![]));},'simple':_0x688e55=>{const _0x102aca=_0x4e5dcf;console[_0x102aca(0x15b)](parseColor(_0x688e55,!![])),loggerfile[_0x102aca(0x286)](util[_0x102aca(0x2a9)](parseColor(_0x688e55,![]))+'\x0a');},'full':async _0xff4316=>{const _0x2b3d03=_0x4e5dcf,_0x4164fd=getTimeStamp()+_0x2b3d03(0x1b3)+_0xff4316;console[_0x2b3d03(0x15b)](parseColor(_0x4164fd,!![])),loggerfile[_0x2b3d03(0x286)](util[_0x2b3d03(0x2a9)](parseColor(_0x4164fd,![]))+'\x0a');if(tgBot&&settings[_0x2b3d03(0x224)]&&settings[_0x2b3d03(0x1aa)]!='orders')await tgBot[_0x2b3d03(0x229)](settings[_0x2b3d03(0x224)],_0x2b3d03(0x304)+parseColor(_0xff4316,![]))[_0x2b3d03(0x17b)](_0x3afaa8=>{telegramError(_0x3afaa8);});},'debug':async(_0x396316,_0x1c7ac3='')=>{const _0xa1fd2b=_0x4e5dcf,_0x49c845=getTimeStamp()+_0xa1fd2b(0x2b5)+_0x396316;if(debugging)console[_0xa1fd2b(0x15b)](parseColor(_0x49c845,!![]));loggerfile['write'](util[_0xa1fd2b(0x2a9)](parseColor(_0x49c845,![]))+'\x0a');if(_0x1c7ac3){if(debugging)console['log'](_0x1c7ac3);loggerfile['write'](util[_0xa1fd2b(0x2a9)](_0x1c7ac3)+'\x0a');}}};process['on']('uncaughtException',function(_0x1a94cf){const _0x4dec60=_0x4e5dcf;logger[_0x4dec60(0x145)](_0x1a94cf);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4e5dcf(0x29a))[_0x4e5dcf(0x27e)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4e5dcf(0x2a0)),app=express(),http=require('http')[_0x4e5dcf(0x14b)](app);app[_0x4e5dcf(0x25b)](fileUpload({'useTempFiles':!![]})),app[_0x4e5dcf(0x17a)](_0x4e5dcf(0x2f1),async(_0x408869,_0x4be219)=>{const _0x4e9c2b=_0x4e5dcf,_0x1f1b36=_0x408869['params'][_0x4e9c2b(0x12a)],_0x43969a=getClientsWithBotID('botmanager'),_0x29541c=_0x408869['headers']['uuid'],_0x21ac23=timelyDecrypt(_0x29541c,![]),_0x3d15a2=_0x43969a['find'](_0x5f04b0=>_0x5f04b0[_0x4e9c2b(0x1e6)]==_0x21ac23);if(_0x3d15a2){const _0x469f90=normalizeIP(_0x408869[_0x4e9c2b(0x1e9)][_0x4e9c2b(0x159)])[_0x4e9c2b(0x216)],_0x1a8924=_0x408869[_0x4e9c2b(0x283)][_0x4e9c2b(0x206)];if(validateAccess(_0x1a8924,_0x21ac23,_0x469f90)[_0x4e9c2b(0x2e3)])_0x1f1b36==_0x4e9c2b(0x175)&&await backupConfigFiles(),await zipFiles(_0x1f1b36),_0x4be219[_0x4e9c2b(0x245)](zippath+(_0x1f1b36+_0x4e9c2b(0x18c)),_0x518d36=>{const _0x2162da=_0x4e9c2b;_0x518d36&&(logger['full'](_0x2162da(0x234)+_0x1f1b36),logger[_0x2162da(0x145)](_0x518d36));});else logger[_0x4e9c2b(0x1a0)](_0x4e9c2b(0x143)+_0x1f1b36+_0x4e9c2b(0x2c5));}else logger[_0x4e9c2b(0x1a0)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1f1b36+_0x4e9c2b(0x247));}),app[_0x4e5dcf(0x162)]('/upload-backup',async(_0x3635cd,_0x344bb7)=>{const _0x35ac5a=_0x4e5dcf,_0x1bdfa7=getClientsWithBotID(_0x35ac5a(0x1df)),_0x4a5dae=_0x3635cd[_0x35ac5a(0x283)]['uuid'],_0x1eec59=timelyDecrypt(_0x4a5dae,![]),_0x492ba5=_0x1bdfa7[_0x35ac5a(0x13b)](_0x5371a2=>_0x5371a2[_0x35ac5a(0x1e6)]==_0x1eec59);logger['debug'](_0x35ac5a(0x227));if(_0x492ba5){const _0x19b621=normalizeIP(_0x3635cd['socket'][_0x35ac5a(0x159)])[_0x35ac5a(0x216)],_0x9e4513=_0x3635cd[_0x35ac5a(0x283)][_0x35ac5a(0x206)];if(validateAccess(_0x9e4513,_0x1eec59,_0x19b621)['allow']){if(_0x3635cd['files']){const _0x15d7a8=_0x3635cd[_0x35ac5a(0x172)][_0x35ac5a(0x221)];await _0x15d7a8['mv'](temppath+_0x15d7a8['name']),_0x344bb7['send']({'status':!![],'message':_0x35ac5a(0x1cb)});const _0x50d612=getBotsWithMode();_0x50d612[_0x35ac5a(0x1de)]>0x0?confirmRestore(temppath,_0x15d7a8['name']):unzipFile(temppath,_0x15d7a8[_0x35ac5a(0x1c7)]);}}else logger[_0x35ac5a(0x1a0)](_0x35ac5a(0x208));}else logger[_0x35ac5a(0x1a0)](_0x35ac5a(0x1c4));}),app[_0x4e5dcf(0x25b)](express['static'](path[_0x4e5dcf(0x17e)](__dirname,bbpath2,'build2'))),app[_0x4e5dcf(0x25b)](express[_0x4e5dcf(0x1c0)](path[_0x4e5dcf(0x17e)](__dirname,bbpath2,'build'))),app[_0x4e5dcf(0x17a)]('/',function(_0x491bb6,_0x4ba7d1){const _0x5eed47=_0x4e5dcf;_0x4ba7d1[_0x5eed47(0x189)](path['join'](__dirname,bbpath2,_0x5eed47(0x12d),_0x5eed47(0x22e)));}),app[_0x4e5dcf(0x17a)](_0x4e5dcf(0x19a),function(_0x21aa61,_0x42fcf4){const _0x58f5f8=_0x4e5dcf;_0x42fcf4[_0x58f5f8(0x189)](path[_0x58f5f8(0x17e)](__dirname,bbpath2,_0x58f5f8(0x149),_0x58f5f8(0x22e)));}),app['get'](_0x4e5dcf(0x1f0),(_0x294b6c,_0x27de5f)=>{const _0xfaef2b=_0x4e5dcf;_0x27de5f[_0xfaef2b(0x189)](path[_0xfaef2b(0x17e)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x4e5dcf(0x19f),(_0x17a958,_0x430409)=>{const _0x1cfac5=_0x4e5dcf;_0x430409[_0x1cfac5(0x189)](path[_0x1cfac5(0x17e)](__dirname,bbpath2,'build',_0x1cfac5(0x22e)));}),app['get'](_0x4e5dcf(0x2b9),(_0x559000,_0x162f32)=>{const _0x4a8fc2=_0x4e5dcf;_0x162f32['sendFile'](path[_0x4a8fc2(0x17e)](__dirname,bbpath2,_0x4a8fc2(0x149),_0x4a8fc2(0x22e)));}),app[_0x4e5dcf(0x17a)](_0x4e5dcf(0x126),(_0x449101,_0x468999)=>{const _0x4209f6=_0x4e5dcf;_0x468999[_0x4209f6(0x189)](path[_0x4209f6(0x17e)](__dirname,bbpath2,_0x4209f6(0x149),_0x4209f6(0x22e)));}),app[_0x4e5dcf(0x17a)](_0x4e5dcf(0x1a4),(_0xe2ec2d,_0x1e7814)=>{const _0x1bc274=_0x4e5dcf;_0x1e7814[_0x1bc274(0x189)](path[_0x1bc274(0x17e)](__dirname,bbpath2,'build','index.html'));}),app[_0x4e5dcf(0x17a)](_0x4e5dcf(0x300),(_0xcc8010,_0x5071d3)=>{const _0x30a5d0=_0x4e5dcf;_0x5071d3[_0x30a5d0(0x189)](path[_0x30a5d0(0x17e)](__dirname,bbpath2,_0x30a5d0(0x149),_0x30a5d0(0x22e)));});if(HOST)http[_0x4e5dcf(0x185)](PORT,HOST);else http[_0x4e5dcf(0x185)](PORT);const io=require(_0x4e5dcf(0x2b6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x246ecf=_0x4e5dcf;let _0x4a95b2=_0x246ecf(0x231);const _0x18e170=networkInterfaces(),_0x3c45b5={};for(const _0x533d96 of Object['keys'](_0x18e170)){for(const _0x39340e of _0x18e170[_0x533d96]){if((_0x39340e[_0x246ecf(0x2ab)]==_0x246ecf(0x29c)||_0x39340e[_0x246ecf(0x2ab)]==0x4)&&!_0x39340e[_0x246ecf(0x1be)]){const _0x55b19a=ipaddr['parse'](_0x39340e[_0x246ecf(0x1a8)])[_0x246ecf(0x168)]();_0x55b19a!=_0x246ecf(0x278)&&(!_0x3c45b5[_0x533d96]&&(_0x3c45b5[_0x533d96]=[]),_0x3c45b5[_0x533d96][_0x246ecf(0x1cc)](_0x39340e[_0x246ecf(0x1a8)]),_0x4a95b2=_0x39340e[_0x246ecf(0x1a8)]);}}}return{'serverip':_0x4a95b2,'netinterfaces':_0x3c45b5};}async function startServer(){const _0x27a24b=_0x4e5dcf,{serverip:_0x27605b,netinterfaces:_0x4271a1}=getServerIP();logger[_0x27a24b(0x145)](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x27a24b(0x1a0)](_0x27a24b(0x2a6)+serverversion+'#RES#\x20'+(environment=='staging'?_0x27a24b(0x236):'')+'\x0a'+(_0x27a24b(0x1da)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x27a24b(0x18f)+_0x27605b+':'+PORT+_0x27a24b(0x1c2))),logger['simple'](_0x27a24b(0x22c));if(config[_0x27a24b(0x1de)]!=0x0)for(const _0x366271 of config){if(_0x366271[_0x27a24b(0x2fe)]==_0x27a24b(0x1b8)||_0x366271['status']=='new')await logger['full'](_0x27a24b(0x2a7)+_0x366271[_0x27a24b(0x306)]+_0x27a24b(0x18a)+_0x366271['botname']),startBot([_0x366271[_0x27a24b(0x306)],userID],{'cwd':bbpath},function(_0x1ec1f2){if(_0x1ec1f2)logger['full'](_0x1ec1f2);});else(_0x366271[_0x27a24b(0x2fe)]==_0x27a24b(0x193)||_0x366271[_0x27a24b(0x2fe)]==_0x27a24b(0x15a))&&await logger[_0x27a24b(0x1a0)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x366271[_0x27a24b(0x306)]+_0x27a24b(0x18a)+_0x366271[_0x27a24b(0x199)]);}else!newBot&&logger[_0x27a24b(0x145)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x27a24b(0x145)](_0x27a24b(0x22c)),logger[_0x27a24b(0x145)](''),await logger['debug'](_0x27a24b(0x214)+nodeversion),await logger['debug'](_0x27a24b(0x125),_0x4271a1);}function _0x36b7(){const _0x4cbdc4=['/restart\x20-\x20restart\x20bot(s)\x0a','store','set','size','/disable\x20-\x20disable\x20notifications\x0a','apiSecret','getFullYear','getSeconds','temporary\x20access\x20timeout','stop','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','readdirSync','backupfile','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','slice','telegramChatId','Temporary\x20access\x20rejected','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Backup\x20file\x20uploaded','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','sendMessage','isValid','showname','-----------------------------------------------------------------------------------','warning','index.html','lastmsgemitted','Invalid\x20authentication\x20token\x20(2)','[ip-address]','timeshift','clients','Failed\x20to\x20download\x20','sort','(staging)','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','whitelist','success','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','jsonwebtoken','split','127.0.0.1','cloneDeep','assign','Enabled\x20Bot\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','getDate','telegram2FaApproval','path','download','apply','\x20(2)','chat','telegram','event','backup-files','Restarting\x20Bot\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','access','entries','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','reload',',\x20must\x20be\x20a\x204\x20digit\x20number','keys','storeHeadless','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Invalid\x20Telegram\x20token','30\x20min','getMonth','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','get-starting-balances','use','test','child_process','sha256','settings','yargs/yargs','Ok,\x20will\x20send\x20alert\x20notifications\x20only','onText','toggle-bot-mode','\x1b[36m','login','\x20mode','copyFileSync','resetHistory','reinstall-bb','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','secret','auto','randomBytes','place-order','existsSync','hex','/help\x20-\x20show\x20available\x20commands\x0a','getStartingBalances','live','Your\x20installation\x20is\x20already\x20up\x20to\x20date','$1_$2_$3','lowdb/adapters/FileSync','defaults','private','/on\x20-\x20start\x20bot(s)\x0a','f2aRequired','node-zip','Unauthorized\x20attempt\x20to\x20delete\x20alerts','pidExpireLogin','version','mixpanel','bots','Password\x20has\x20been\x20reset\x20to:\x20','2FA\x20login\x20required','headers','readFileSync','update-bb','write','3000','temporaryAccessAllowed','stopped','\x20to\x20','util','telegramUsername','yes','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','endsWith','headless','privateKey','bot','manual','Backup\x20file\x20unzipped\x20and\x20stored','reinstall','login\x20token\x20valid','Unauthorized\x20attempt\x20to\x20show\x20configuration','Yes','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','version.json','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','IPv4','generateKeyPairAsync','sendMetricsTelegram','server','express','temp/','invalid\x20credentials','node','/enable\x20-\x20enable\x20notifications\x0a','Error:\x20Invalid\x20argument\x20','Starting\x20#RED#Balance\x20Bot\x20v','Starting\x20bot\x20|\x20Bot\x20','login\x20required','format','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','family','Unauthorized\x20attempt\x20to\x20confirm\x20message','fork','max','Setting\x20access:\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','15\x20min','telegramEnabled','Unauthorized\x20attempt\x20to\x20update\x20settings','Deleted\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','socket.io','removeListener','user','/:bot/coins','data','handshake','No\x20authentication\x20token','https://api.ipify.org?format=json','Notifications\x20enabled\x0a','Restore\x20backup\x20file\x20','getMinutes','Unauthorized\x20attempt\x20to\x20store\x20configuration','-results.json','includes','messages','\x20(1)','logs/','bbPassword','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','telegramIpApproval','0.0.0','debug','\x20>\x20','disconnect','replace','Notifications\x20disabled\x0a','(((.+)+)+)+$','get-portfolio','-events.json','3586212EqKWwh','alerts','Notifications\x20enabled','restart','alias','connection','value','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','login\x20not\x20required','5\x20min','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','2FA','started','cancelLoading','backup-full','2FA\x20login\x20rejected','allow','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','hasOwnProperty','graphql-request','/off\x20-\x20stop\x20bot(s)\x0a','forEach','telegrammsg','exp','settings.','/status\x20-\x20show\x20bot(s)\x20status\x0a','2FA\x20required','2oOLZZk','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','toggleBotMode','/download/:type','Error\x20while\x20deleting\x20config\x20files:\x20','sortBy','Unauthorized\x20attempt\x20to\x20log\x20out','reason','5445368SnMqvx','number','delete-bot','date-fns','publicKey','kill','args','once','status','***','/:bot/support','\x1b[33m','running','bot-','Bot\x20Mgr\x20>\x20','bbUsername','botID','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','send','output-000.log','then','padStart','Network\x20Interfaces:','/:bot/history','Invalid\x20username\x20or\x20IP\x20address','5785353qgggBX','answerCallbackQuery','type','min','getHours','build2','Markdown','login\x20token\x20generated','<b>Telegram\x20Bot\x20Status:</b>\x0a','*$1*','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','search','temporary\x20token\x20generated','initclient','lastmsgtelegram','referer','store-headless','reset-history','All\x20bots\x20running\x20right\x20now','find','remove','removeAllListeners','username','ipaddr.js','telegramToken','kind','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20download\x20','host','simple','reject','toString','generate','build','file','createServer','encryptedUuid','access\x20timeout','Notifications\x20types:\x20','apiKey','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','All','show-config','get-messages','message','from','reset-password','string','argv','remoteAddress','new-disabled','log','5582000kRLUNr','No\x20bots\x20running\x20right\x20now','Access\x20enabled\x20for\x20','\x20|\x20client:\x20...','port','sendPortfolioTelegram','post','config/','apiPassword','Restore\x20process\x20aborted','bb-settings.json','placeOrder','range','/update\x20-\x20update\x20Balance\x20Bot\x0a','bb-config.json','getUTCHours','Login\x20accepted','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getPortfolio','hashSync','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','map','files','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','uuid-random','backup','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20login\x20attempt\x20(timeout)','Session\x20expired\x20for\x20user\x20...','title','get','catch','createWriteStream','NTBA_FIX_319','join','exec','loginRequired','HTML','bb-secure.json',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','RSA-OAEP','listen','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Invalid\x20IP\x20address','User\x20has\x20been\x20validated','sendFile','\x20|\x20','userid','.zip','Logged\x20out\x20user\x20...','-config.json','=>\x20Go\x20to\x20#CYA#http://','statSync','::ffff:127.0.0.1','function','disabled','getTime','verify','onepagemode','versions','************','botname','/:bot','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','timestamp','new','latestversion','/:bot/performance','full','<b>Balance\x20Bot\x20Status:</b>\x0a','</b>\x20?','production','/:bot/configuration','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','crypto','rmSync','address','startsWith','telegramEvents','init','bot.js','Unauthorized\x20attempt\x20to\x20update\x20bot','unlinkSync','backup-full@','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','exit','logs',':\x20Bot\x20Mgr\x20>\x20','randomFillSync','hybrid-crypto-js','sockets','You\x20can\x20use\x20the\x20following\x20commands:\x0a','enabled','filter','updatebotmanager','writeFileSync','restore-backup-file','DEFLATE','internal','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','static','-performance.json','#RES#\x20if\x20running\x20on\x20server','ipc','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','callback_query','Bot\x20','name','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','bbvNew','/names\x20-\x20show\x20bot\x20names\x0a','File\x20uploaded','push','mtime','emit','zip/','\x1b[35m','bb/','storeFiat','mode','Unauthorized\x20attempt\x20to\x20add\x20bot','\x1b[34m','Unauthorized\x20attempt\x20to\x20get\x20events','emitHistory','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','1508347WPjAeJ','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','toIPv4MappedAddress','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20get\x20messages','length','botmanager','ipv6','logged\x20out','isDirectory','Disabled\x20Bot\x20','exchange','express-fileupload','uuid','Invalid\x20authentication\x20token\x20(1)','binary','socket','env','sign','Crypt','decrypt','show','bbvReceive','/:bot/portfolio','5131146WXGjJX','confirm-message','token','update','store-configuration','all','Server','mkdirSync','stopPolling','Logged\x20in\x20user\x20...','Notifications\x20disabled','cancel-loading','output-001.log','expiry','All\x20bots','parse','pidRefreshToken','blacklist','clientip','temporary\x20access\x20rejected','29426856QdXXSM','tkn','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','get-logs','password','Error\x20removing\x20old\x20backup\x20files:','orders','stringify','notification','Allow\x20login\x20from\x20IP\x20address\x20<b>','Starting\x20Balance\x20Bot\x20reinstallation','Starting\x20Balance\x20Bot\x20update','match','inherit','Node.js\x20v'];_0x36b7=function(){return _0x4cbdc4;};return _0x36b7();}function startSocket(){const _0x43aab2=_0x4e5dcf;io['on'](_0x43aab2(0x2d8),_0x416cb6=>{const _0x3f86f1=_0x43aab2;let _0x1b609d,_0x537074,_0x1584ca,_0x2e4fca,_0x2e3012;const _0x1a7e9e=_0x416cb6['handshake'][_0x3f86f1(0x283)][_0x3f86f1(0x137)];_0x537074=_0x1a7e9e['match'](/bot[0-9]{3}/);if(_0x537074)_0x1584ca=_0x537074[0x0][_0x3f86f1(0x212)](/[0-9]{3}/);if(_0x1584ca)_0x1b609d=_0x1584ca[0x0];else _0x1b609d=_0x3f86f1(0x1df);const _0x278da4=_0x416cb6[_0x3f86f1(0x2bb)]['auth'][_0x3f86f1(0x14c)];if(!_0x278da4)_0x416cb6['emit'](_0x3f86f1(0x2fe),{'publicKey':secure[_0x3f86f1(0x2fa)]});else{_0x2e4fca=timelyDecrypt(_0x278da4,![]);if(!_0x2e4fca)_0x416cb6[_0x3f86f1(0x1ce)](_0x3f86f1(0x2fe),{'publicKey':secure[_0x3f86f1(0x2fa)]});else{_0x2e3012=normalizeIP(_0x416cb6['conn']['remoteAddress'])['store'];if(!devices[_0x2e4fca])devices[_0x2e4fca]={'uuid':_0x2e4fca,'access':{'token':null}};devices[_0x2e4fca]['ip']=_0x2e3012;const _0x1273ba=addClient(_0x416cb6['id'],_0x2e4fca,_0x1b609d);setAccess(_0x1273ba),emitMessages(),_0x416cb6['on'](_0x3f86f1(0x265),_0x2f35f8=>{const _0x457112=_0x3f86f1,_0x192f9c=timelyDecrypt(_0x2f35f8['password']);if(_0x192f9c){_0x2f35f8={'username':_0x2f35f8[_0x457112(0x13e)],'password':_0x192f9c},devices[_0x2e4fca]['access']=validateCredentials(_0x2f35f8,_0x2e4fca);if(devices[_0x2e4fca][_0x457112(0x24e)][_0x457112(0x2e3)]==![]&&devices[_0x2e4fca][_0x457112(0x24e)][_0x457112(0x2f5)]=='2FA\x20login\x20required')_0x416cb6[_0x457112(0x1ce)](_0x457112(0x2fe),{'access':devices[_0x2e4fca]['access']}),loginAccess2FA(_0x2e4fca,_0x2e3012);else{if(devices[_0x2e4fca][_0x457112(0x24e)][_0x457112(0x2e3)]==![]&&devices[_0x2e4fca][_0x457112(0x24e)][_0x457112(0x2f5)]==_0x457112(0x2a2))_0x416cb6['emit'](_0x457112(0x2fe),{'access':devices[_0x2e4fca][_0x457112(0x24e)]});else devices[_0x2e4fca][_0x457112(0x24e)]['allow']&&devices[_0x2e4fca][_0x457112(0x24e)][_0x457112(0x2f5)]==_0x457112(0x12f)&&(getClientsWithUuid(_0x2e4fca)[_0x457112(0x2e8)](_0x167fb8=>{setAccess(_0x167fb8);}),logger[_0x457112(0x2cb)](_0x457112(0x1fa)+_0x2e4fca[_0x457112(0x223)](-0x8)),setTokenRefresh(_0x2e4fca),setSessionTimeout(_0x457112(0x265),_0x2e4fca));}}else logger['full'](_0x457112(0x177));}),_0x416cb6['on'](_0x3f86f1(0x156),()=>{resetPassword();}),_0x416cb6['on'](_0x3f86f1(0x2cd),_0x4c1ffb=>{removeClient(_0x416cb6['id']);}),_0x1b609d==_0x3f86f1(0x1df)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1971d7){const _0xac7a89=_0x4e5dcf;if(_0x1971d7!=_0xac7a89(0x1df)&&config[_0xac7a89(0x14f)]!=''){if(pid[_0x1971d7])pid[_0x1971d7][_0xac7a89(0x308)]({'function':_0xac7a89(0x135),'args':null});}_0x1971d7!='botmanager'&&broadcastToBots(_0xac7a89(0x280),JSON[_0xac7a89(0x20d)](config));}function reloadBotManager(){const _0x3cd4da=_0x4e5dcf;getClientsWithBotID(_0x3cd4da(0x1df))[_0x3cd4da(0x2e8)](_0x515e26=>{const _0x22db47=_0x3cd4da;getSocket(_0x515e26['id'])[_0x22db47(0x1ce)](_0x22db47(0x2fe),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x3bc0eb){const _0x3b3519=_0x4e5dcf;return io[_0x3b3519(0x1b6)]['sockets']['get'](_0x3bc0eb);}function setAccess(_0x3e0a97){const _0x352a01=_0x4e5dcf,_0x13e412=getSocket(_0x3e0a97['id']),_0x37b4ed=_0x3e0a97['uuid'],_0x15feb9=_0x3e0a97['bot'];devices[_0x37b4ed][_0x352a01(0x24e)]=validateAccess(devices[_0x37b4ed][_0x352a01(0x24e)][_0x352a01(0x1f3)],_0x37b4ed),logger[_0x352a01(0x2cb)](_0x352a01(0x2af)+devices[_0x37b4ed]['access'][_0x352a01(0x2f5)]+_0x352a01(0x15f)+_0x3e0a97['id'][_0x352a01(0x223)](-0x8)+'\x20|\x20user:\x20...'+_0x37b4ed[_0x352a01(0x223)](-0x8)),_0x13e412[_0x352a01(0x17e)](_0x37b4ed);if(devices[_0x37b4ed][_0x352a01(0x24e)]['allow']){_0x13e412[_0x352a01(0x17e)](_0x15feb9);if(_0x15feb9==_0x352a01(0x1df))initializeSocketBotManager(_0x13e412);else initializeSocketBot(_0x13e412);initClient(_0x15feb9);}devices[_0x37b4ed][_0x352a01(0x24e)][_0x352a01(0x1f3)]&&devices[_0x37b4ed][_0x352a01(0x24e)][_0x352a01(0x2f5)]==_0x352a01(0x134)&&setSessionTimeout(_0x352a01(0x2de),_0x37b4ed),devices[_0x37b4ed][_0x352a01(0x24e)][_0x352a01(0x1f3)]&&devices[_0x37b4ed][_0x352a01(0x24e)][_0x352a01(0x2f5)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x352a01(0x265),_0x37b4ed),_0x13e412[_0x352a01(0x1ce)](_0x352a01(0x2fe),{'status':_0x3e0a97[_0x352a01(0x29f)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x37b4ed][_0x352a01(0x24e)],'externalip':devices[_0x37b4ed]['ip'],'publicKey':secure[_0x352a01(0x2fa)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x37b4ed][_0x352a01(0x24e)]['allow']==![]&&devices[_0x37b4ed][_0x352a01(0x24e)][_0x352a01(0x2f5)]==_0x352a01(0x2ed)&&temporaryAccess2FA(_0x37b4ed,devices[_0x37b4ed]['ip']);}function setSessionTimeout(_0x5699ad,_0x48d301){const _0x4955f3=_0x4e5dcf;let _0xc6efb0;if(_0x5699ad==_0x4955f3(0x265))_0xc6efb0=loginExpiry*0x3c*0x3e8;else _0xc6efb0=devices[_0x48d301][_0x4955f3(0x2c9)]['expiry']*0x3c*0x3e8-(new Date()[_0x4955f3(0x194)]()-devices[_0x48d301]['telegramIpApproval'][_0x4955f3(0x19c)]);if(devices[_0x48d301]['pidExpireLogin'])clearTimeout(devices[_0x48d301][_0x4955f3(0x27d)]);devices[_0x48d301][_0x4955f3(0x27d)]=setTimeout(()=>{const _0x29e302=_0x4955f3;if(devices[_0x48d301][_0x29e302(0x201)])clearTimeout(devices[_0x48d301][_0x29e302(0x201)]);removeSocketListeners(_0x48d301),addBlacklist(_0x48d301),devices[_0x48d301][_0x29e302(0x2c9)]=null,devices[_0x48d301][_0x29e302(0x243)]=null,devices[_0x48d301][_0x29e302(0x24e)][_0x29e302(0x1f3)]=null,logger['debug'](_0x29e302(0x178)+_0x48d301[_0x29e302(0x223)](-0x8)),devices[_0x48d301][_0x29e302(0x24e)]=validateAccess(devices[_0x48d301][_0x29e302(0x24e)][_0x29e302(0x1f3)],_0x48d301),!(devices[_0x48d301]['access'][_0x29e302(0x2e3)]&&devices[_0x48d301][_0x29e302(0x24e)][_0x29e302(0x2f5)]==_0x29e302(0x2db))&&(_0x5699ad==_0x29e302(0x265)?io['to'](_0x48d301)[_0x29e302(0x1ce)](_0x29e302(0x2fe),{'access':{'allow':![],'reason':_0x29e302(0x14d),'token':null}}):io['to'](_0x48d301)['emit']('status',{'access':{'allow':![],'reason':_0x29e302(0x21d),'token':null}})),devices[_0x48d301][_0x29e302(0x24e)][_0x29e302(0x1f3)]=null;},_0xc6efb0);}function setTokenRefresh(_0x40a0f1){if(devices[_0x40a0f1]['pidRefreshToken'])clearTimeout(devices[_0x40a0f1]['pidRefreshToken']);devices[_0x40a0f1]['pidRefreshToken']=setTimeout(()=>{const _0x314fbb=_0x3687;getClientsWithUuid(_0x40a0f1)[_0x314fbb(0x1de)]!=0x0?(devices[_0x40a0f1][_0x314fbb(0x24e)]=refreshToken(_0x40a0f1),io['to'](_0x40a0f1)[_0x314fbb(0x1ce)]('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x40a0f1][_0x314fbb(0x24e)],'externalip':devices[_0x40a0f1]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x40a0f1)):clearTimeout(devices[_0x40a0f1][_0x314fbb(0x201)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x193ee5){const _0x5715a7=_0x4e5dcf,_0x35ba07=getClient(_0x193ee5['id'])[_0x5715a7(0x1e6)];_0x193ee5[_0x5715a7(0x1ce)](_0x5715a7(0x280),config),_0x193ee5[_0x5715a7(0x1ce)](_0x5715a7(0x25f),cleanSettings()),_0x193ee5['on']('add-bot',_0x2e018b=>{const _0x329406=_0x5715a7;if(validateAccess(_0x2e018b,_0x35ba07)[_0x329406(0x2e3)])addBot();else logger['full'](_0x329406(0x1d4));}),_0x193ee5['on']('update-bot',(_0x2d22b8,_0x11df65)=>{const _0x47f56e=_0x5715a7;if(validateAccess(_0x11df65,_0x35ba07)[_0x47f56e(0x2e3)])toggleBot(_0x2d22b8[_0x47f56e(0x306)],_0x2d22b8['status'],_0x2d22b8[_0x47f56e(0x273)]);else logger[_0x47f56e(0x1a0)](_0x47f56e(0x1ad));}),_0x193ee5['on'](_0x5715a7(0x263),(_0x1caffa,_0x423f0c)=>{const _0x4420d5=_0x5715a7;if(validateAccess(_0x423f0c,_0x35ba07)[_0x4420d5(0x2e3)])toggleBotMode(_0x1caffa);else logger['full'](_0x4420d5(0x1ad));}),_0x193ee5['on'](_0x5715a7(0x2f8),(_0x1f94b3,_0x5559ab)=>{const _0x2a04f0=_0x5715a7;if(validateAccess(_0x5559ab,_0x35ba07)['allow'])deleteBot(_0x1f94b3);else logger[_0x2a04f0(0x1a0)](_0x2a04f0(0x176));}),_0x193ee5['on']('store-settings',(_0x32a2b6,_0x327e2d)=>{const _0x30c6cd=_0x5715a7;if(validateAccess(_0x327e2d,_0x35ba07)[_0x30c6cd(0x2e3)])storeSettings(_0x32a2b6,!![]);else logger['full'](_0x30c6cd(0x2b3));}),_0x193ee5['on'](_0x5715a7(0x285),_0x551ce1=>{const _0x498ff4=_0x5715a7;if(validateAccess(_0x551ce1,_0x35ba07)[_0x498ff4(0x2e3)])updateBB(_0x498ff4(0x1f4));else logger[_0x498ff4(0x1a0)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x193ee5['on'](_0x5715a7(0x269),_0x484863=>{const _0x3070c1=_0x5715a7;if(validateAccess(_0x484863,_0x35ba07)[_0x3070c1(0x2e3)])updateBB(_0x3070c1(0x295));else logger[_0x3070c1(0x1a0)](_0x3070c1(0x19b));}),_0x193ee5['on']('get-backup-files',_0x4cb75f=>{const _0x5ce813=_0x5715a7;if(validateAccess(_0x4cb75f,_0x35ba07)['allow']){const _0x523367=getClient(_0x193ee5['id']);if(_0x523367)getBackupFiles(_0x523367[_0x5ce813(0x1e6)]);else logger[_0x5ce813(0x1a0)](_0x5ce813(0x1a5));}else logger[_0x5ce813(0x1a0)](_0x5ce813(0x26a));}),_0x193ee5['on'](_0x5715a7(0x1bc),(_0x4f5f1e,_0x3b8336)=>{const _0xc4b4b4=_0x5715a7;if(validateAccess(_0x3b8336,_0x35ba07)[_0xc4b4b4(0x2e3)])restoreBackupFile(_0x4f5f1e);else logger['full'](_0xc4b4b4(0x255));}),_0x193ee5['on'](_0x5715a7(0x153),_0x329d35=>{const _0x4f31eb=_0x5715a7;if(validateAccess(_0x329d35,_0x35ba07)['allow'])getMessages();else logger[_0x4f31eb(0x1a0)](_0x4f31eb(0x1dd));}),_0x193ee5['on'](_0x5715a7(0x1f2),(_0x5c7219,_0x5bd8e9)=>{const _0x49f5f6=_0x5715a7;if(validateAccess(_0x5bd8e9,_0x35ba07)['allow'])confirmMessage(_0x5c7219);else logger[_0x49f5f6(0x1a0)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x193ee5['on']('logout',_0x143d67=>{const _0x35c39e=_0x5715a7;if(validateAccess(_0x143d67,_0x35ba07)['allow']){if(devices[_0x35ba07][_0x35c39e(0x201)])clearTimeout(devices[_0x35ba07][_0x35c39e(0x201)]);if(devices[_0x35ba07][_0x35c39e(0x27d)])clearTimeout(devices[_0x35ba07][_0x35c39e(0x27d)]);removeSocketListeners(getClient(_0x193ee5['id'])[_0x35c39e(0x1e6)]),addBlacklist(_0x35ba07),devices[_0x35ba07][_0x35c39e(0x2c9)]=null,devices[_0x35ba07][_0x35c39e(0x243)]=null,devices[_0x35ba07][_0x35c39e(0x24e)][_0x35c39e(0x1f3)]=null,logger['debug'](_0x35c39e(0x18d)+_0x35ba07[_0x35c39e(0x223)](-0x8)),io['to'](getClient(_0x193ee5['id'])[_0x35c39e(0x1e6)])[_0x35c39e(0x1ce)](_0x35c39e(0x2fe),{'access':{'allow':![],'reason':_0x35c39e(0x1e1),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x393d95){const _0x3a4156=_0x4e5dcf,_0x241063=getClient(_0x393d95['id'])[_0x3a4156(0x292)],_0x331b7d=getClient(_0x393d95['id'])['uuid'];_0x393d95['on'](_0x3a4156(0x209),(_0x3afb9f,_0x2d6ad0)=>{const _0x36197d=_0x3a4156;if(validateAccess(_0x2d6ad0,_0x331b7d)[_0x36197d(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0x36197d(0x308)]({'function':_0x36197d(0x1d7),'args':_0x3afb9f});}else logger[_0x36197d(0x1a0)](_0x36197d(0x1d6));}),_0x393d95['on']('delete-alerts',(_0x4ded24,_0x3842d3)=>{const _0xfb885=_0x3a4156;if(validateAccess(_0x3842d3,_0x331b7d)[_0xfb885(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0xfb885(0x308)]({'function':'deleteHistoryAlerts','args':_0x4ded24});}else logger[_0xfb885(0x1a0)](_0xfb885(0x27c));}),_0x393d95['on'](_0x3a4156(0x2d1),(_0x1117a3,_0x91cd5)=>{const _0xbf27f7=_0x3a4156;if(validateAccess(_0x91cd5,_0x331b7d)[_0xbf27f7(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0xbf27f7(0x308)]({'function':_0xbf27f7(0x16e),'args':_0x1117a3});}else logger['full'](_0xbf27f7(0x142));}),_0x393d95['on'](_0x3a4156(0x1f5),(_0x4f7d7e,_0x46d5f3)=>{const _0x2119d6=_0x3a4156;if(validateAccess(_0x46d5f3,_0x331b7d)[_0x2119d6(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0x2119d6(0x308)]({'function':'storeConfiguration','args':_0x4f7d7e});}else logger['full'](_0x2119d6(0x2c1));}),_0x393d95['on'](_0x3a4156(0x138),(_0x16920f,_0x4c10ee)=>{const _0x27a00c=_0x3a4156;if(validateAccess(_0x4c10ee,_0x331b7d)[_0x27a00c(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0x27a00c(0x308)]({'function':_0x27a00c(0x254),'args':_0x16920f});}else logger[_0x27a00c(0x1a0)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x393d95['on']('store-fiat',(_0x55b424,_0x28beb2)=>{const _0x5a0cd8=_0x3a4156;if(validateAccess(_0x28beb2,_0x331b7d)[_0x5a0cd8(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0x5a0cd8(0x308)]({'function':_0x5a0cd8(0x1d2),'args':_0x55b424});}else logger[_0x5a0cd8(0x1a0)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x393d95['on'](_0x3a4156(0x139),_0x20c1d6=>{const _0x2d19e1=_0x3a4156;if(validateAccess(_0x20c1d6,_0x331b7d)[_0x2d19e1(0x2e3)]){if(pid[_0x241063])pid[_0x241063]['send']({'function':_0x2d19e1(0x268),'args':null});}else logger[_0x2d19e1(0x1a0)](_0x2d19e1(0x2aa));}),_0x393d95['on'](_0x3a4156(0x25a),_0x583c68=>{const _0x24e291=_0x3a4156;if(validateAccess(_0x583c68,_0x331b7d)[_0x24e291(0x2e3)]){if(pid[_0x241063])pid[_0x241063]['send']({'function':_0x24e291(0x272),'args':null});}else logger[_0x24e291(0x1a0)](_0x24e291(0x173));}),_0x393d95['on'](_0x3a4156(0x26e),(_0x5cd532,_0x3f606d)=>{const _0xcb8250=_0x3a4156;if(validateAccess(_0x3f606d,_0x331b7d)[_0xcb8250(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0xcb8250(0x308)]({'function':_0xcb8250(0x167),'args':_0x5cd532});}else logger[_0xcb8250(0x1a0)](_0xcb8250(0x28e));}),_0x393d95['on'](_0x3a4156(0x1fc),_0x5b527f=>{const _0x4ddd3f=_0x3a4156;if(validateAccess(_0x5b527f,_0x331b7d)[_0x4ddd3f(0x2e3)]){if(pid[_0x241063])pid[_0x241063][_0x4ddd3f(0x308)]({'function':_0x4ddd3f(0x2e0),'args':null});}else logger[_0x4ddd3f(0x1a0)](_0x4ddd3f(0x307));}),_0x393d95['on'](_0x3a4156(0x152),_0x36bf7b=>{const _0x51c28d=_0x3a4156;if(validateAccess(_0x36bf7b,_0x331b7d)['allow']){if(pid[_0x241063])pid[_0x241063][_0x51c28d(0x308)]({'function':'showConfig','args':null});}else logger[_0x51c28d(0x1a0)](_0x51c28d(0x297));}),_0x393d95['on'](_0x3a4156(0x285),_0x31081b=>{const _0x1cf1bc=_0x3a4156;if(validateAccess(_0x31081b,_0x331b7d)[_0x1cf1bc(0x2e3)])updateBB(_0x1cf1bc(0x1f4));else logger['full'](_0x1cf1bc(0x2dd));}),_0x393d95['on'](_0x3a4156(0x153),_0x5345bb=>{const _0xccb233=_0x3a4156;if(validateAccess(_0x5345bb,_0x331b7d)[_0xccb233(0x2e3)])getMessages();else logger[_0xccb233(0x1a0)](_0xccb233(0x1dd));}),_0x393d95['on']('confirm-message',(_0x25f0a7,_0x1fb10b)=>{const _0xb98dad=_0x3a4156;if(validateAccess(_0x1fb10b,_0x331b7d)['allow'])confirmMessage(_0x25f0a7);else logger[_0xb98dad(0x1a0)](_0xb98dad(0x2ac));}),_0x393d95['on']('logout',_0x24dc9b=>{const _0x2764dc=_0x3a4156;if(validateAccess(_0x24dc9b,_0x331b7d)['allow']){if(devices[_0x331b7d]['pidRefreshToken'])clearTimeout(devices[_0x331b7d][_0x2764dc(0x201)]);if(devices[_0x331b7d][_0x2764dc(0x27d)])clearTimeout(devices[_0x331b7d][_0x2764dc(0x27d)]);removeSocketListeners(getClient(_0x393d95['id'])[_0x2764dc(0x1e6)]),addBlacklist(_0x331b7d),devices[_0x331b7d][_0x2764dc(0x2c9)]=null,devices[_0x331b7d][_0x2764dc(0x243)]=null,devices[_0x331b7d][_0x2764dc(0x24e)][_0x2764dc(0x1f3)]=null,logger[_0x2764dc(0x2cb)](_0x2764dc(0x18d)+_0x331b7d['slice'](-0x8)),io['to'](getClient(_0x393d95['id'])[_0x2764dc(0x1e6)])['emit'](_0x2764dc(0x2fe),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x2764dc(0x1a0)](_0x2764dc(0x2f4));});}function removeSocketListeners(_0x51b8c7){const _0x3292da=_0x4e5dcf;getClientsWithUuid(_0x51b8c7)[_0x3292da(0x2e8)](_0x4643ea=>{const _0x491d98=_0x3292da;getSocket(_0x4643ea['id'])[_0x491d98(0x13d)]();});}function cleanSettings(){const _0x4c2699=_0x4e5dcf;let _0x4caa36=settings;return settings['telegramToken']&&settings[_0x4c2699(0x140)]!=''&&(_0x4caa36={..._0x4caa36,'telegramToken':_0x4c2699(0x198)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x4caa36={..._0x4caa36,'bbPassword':_0x4c2699(0x198)}),(settings[_0x4c2699(0x2c7)]&&settings['bbPassword']==_0x4c2699(0x2ff)||settings['telegramToken']&&settings[_0x4c2699(0x140)]=='***')&&(_0x4caa36={..._0x4caa36,'restored':{'password':settings['bbPassword']==_0x4c2699(0x2ff),'telegram':settings[_0x4c2699(0x140)]=='***'}}),_0x4caa36;}async function updateBB(_0x1d4fae){const _0x44a83c=_0x4e5dcf;await backupConfigFiles(),installingUpdate=!![],config[_0x44a83c(0x2e8)](_0x1532af=>{const _0x3cc0d4=_0x44a83c;restartBot(_0x1532af[_0x3cc0d4(0x306)]);});if(_0x1d4fae==_0x44a83c(0x1f4))process[_0x44a83c(0x308)]({'update':!![],'environment':environment},_0x4810ed=>{});else _0x1d4fae==_0x44a83c(0x295)&&process['send']({'reinstall':!![],'environment':environment},_0x5cc5e7=>{});}function startBot(_0x3275f5,_0x1b2486,_0x49ad05){const _0x2db9fd=_0x4e5dcf;if(debugging)_0x3275f5[_0x2db9fd(0x1cc)]('-d');let _0x1e3ec5=![];const _0x2bbdfd=_0x3275f5[0x0];_0x1b2486={..._0x1b2486,'stdio':[_0x2db9fd(0x213),'inherit',_0x2db9fd(0x213),_0x2db9fd(0x1c3)]},pid[_0x2bbdfd]=childProcess[_0x2db9fd(0x2ad)](botfile,_0x3275f5,_0x1b2486),pid[_0x2bbdfd]['on'](_0x2db9fd(0x154),_0x3dd670=>{const _0x44dd32=_0x2db9fd;switch(Object[_0x44dd32(0x253)](_0x3dd670)[0x0]){case _0x44dd32(0x199):updateBotName(_0x2bbdfd,_0x3dd670[_0x44dd32(0x199)]);break;case _0x44dd32(0x1ba):updateBotManager();break;case'status':updateStatus(_0x2bbdfd,_0x3dd670['status']);break;case _0x44dd32(0x273):updateLive(_0x2bbdfd,_0x3dd670[_0x44dd32(0x273)]);break;case _0x44dd32(0x2df):updateLive(_0x2bbdfd,_0x3dd670[_0x44dd32(0x2df)]),io['to'](_0x2bbdfd)[_0x44dd32(0x1ce)]('status',{'access':{'allow':![],'reason':_0x44dd32(0x251),'token':null}});break;case _0x44dd32(0x21e):_0x3dd670[_0x44dd32(0x21e)]==_0x44dd32(0x2d6)&&restartBot(_0x2bbdfd);_0x3dd670[_0x44dd32(0x21e)]==_0x44dd32(0x2fb)&&toggleBot(_0x2bbdfd,_0x44dd32(0x193),_0x44dd32(0x289));break;case _0x44dd32(0x249):sendTelegram(_0x2bbdfd,_0x3dd670['telegram']);break;case _0x44dd32(0x2e9):sendTelegramMsg(_0x3dd670[_0x44dd32(0x2e9)]);break;case _0x44dd32(0x192):io['to'](_0x2bbdfd)['emit'](_0x3dd670[_0x44dd32(0x192)],_0x3dd670[_0x44dd32(0x2fc)]);break;}}),pid[_0x2bbdfd]['on']('error',function(_0x58ecc5){if(_0x1e3ec5)return;_0x1e3ec5=!![],_0x49ad05(_0x58ecc5);}),pid[_0x2bbdfd]['on'](_0x2db9fd(0x1b1),async function(_0xd45ed0){const _0x33a54f=_0x2db9fd;if(installingUpdate)return;if(_0x1e3ec5)return;_0x1e3ec5=!![],_0x49ad05(null);const _0x222fda=dbConfig[_0x33a54f(0x17a)](_0x33a54f(0x280))[_0x33a54f(0x13b)]({'botID':_0x2bbdfd})[_0x33a54f(0x2d9)]();_0x222fda&&(_0x222fda[_0x33a54f(0x2fe)]==_0x33a54f(0x1b8)||_0x222fda[_0x33a54f(0x2fe)]==_0x33a54f(0x19d))&&(await sleep(0x3e8),updateLive(_0x2bbdfd,_0x33a54f(0x289)),logger['full'](_0x33a54f(0x24c)+_0x2bbdfd),startBot([_0x2bbdfd,userID],{'cwd':bbpath},function(_0x4eff61){const _0x5ab2e0=_0x33a54f;if(_0x4eff61)logger[_0x5ab2e0(0x1a0)](_0x4eff61);}));});}function stopBot(_0x59df92){getClientsWithBotID(_0x59df92)['forEach'](_0x57cab5=>{getSocket(_0x57cab5['id'])['disconnect'](!![]),removeClient(_0x57cab5['id']);}),pid[_0x59df92]&&(pid[_0x59df92]['kill'](),pid[_0x59df92]=null);}function restartBot(_0x19cb7a){const _0x5de778=_0x4e5dcf;if(pid[_0x19cb7a])pid[_0x19cb7a][_0x5de778(0x2fb)]();}function addBot(){const _0x2cfadc=_0x4e5dcf;let _0x1fcfb7;for(let _0x1d41ca=0x1;_0x1d41ca<0x3e9;_0x1d41ca++){_0x1fcfb7=_0x1d41ca[_0x2cfadc(0x147)]()[_0x2cfadc(0x124)](0x3,'0');let _0xbefd34=config[_0x2cfadc(0x13b)](_0x10eb8d=>_0x10eb8d[_0x2cfadc(0x306)]==_0x1fcfb7);if(!_0xbefd34)break;}if(_0x1fcfb7==='1000'){logger['full'](_0x2cfadc(0x2e4));return;}logger[_0x2cfadc(0x1a0)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1fcfb7),dbConfig[_0x2cfadc(0x17a)]('bots')[_0x2cfadc(0x1cc)]({'botID':_0x1fcfb7,'botname':_0x2cfadc(0x1c6)+_0x1fcfb7,'status':_0x2cfadc(0x19d),'live':''})[_0x2cfadc(0x286)](),startBot([_0x1fcfb7,userID],{'cwd':bbpath},function(_0x39cbd5){const _0x252b5e=_0x2cfadc;if(_0x39cbd5)logger[_0x252b5e(0x1a0)](_0x39cbd5);}),config=getConfiguration(),io['to']('botmanager')[_0x2cfadc(0x1ce)]('bots',config),broadcastToBots(_0x2cfadc(0x280),JSON[_0x2cfadc(0x20d)](config));}function deleteBot(_0x56833d){const _0xfffb0e=_0x4e5dcf;getClientsWithBotID(_0x56833d)[_0xfffb0e(0x2e8)](_0x2560b2=>{const _0xef1490=_0xfffb0e;getSocket(_0x2560b2['id'])[_0xef1490(0x2cd)](!![]),removeClient(_0x2560b2['id']);}),dbConfig['get'](_0xfffb0e(0x280))['remove']({'botID':_0x56833d})['write'](),logger[_0xfffb0e(0x1a0)](_0xfffb0e(0x2b4)+_0x56833d),stopBot(_0x56833d);try{if(fs[_0xfffb0e(0x26f)](path['join'](configpath,_0xfffb0e(0x303)+_0x56833d+_0xfffb0e(0x18e))))fs[_0xfffb0e(0x1ae)](path['join'](configpath,_0xfffb0e(0x303)+_0x56833d+_0xfffb0e(0x18e)));if(fs['existsSync'](path[_0xfffb0e(0x17e)](configpath,'bot-'+_0x56833d+_0xfffb0e(0x2d2))))fs[_0xfffb0e(0x1ae)](path[_0xfffb0e(0x17e)](configpath,_0xfffb0e(0x303)+_0x56833d+'-events.json'));if(fs['existsSync'](path[_0xfffb0e(0x17e)](configpath,_0xfffb0e(0x303)+_0x56833d+_0xfffb0e(0x1c1))))fs['unlinkSync'](path['join'](configpath,_0xfffb0e(0x303)+_0x56833d+_0xfffb0e(0x1c1)));if(fs[_0xfffb0e(0x26f)](path[_0xfffb0e(0x17e)](configpath,_0xfffb0e(0x303)+_0x56833d+_0xfffb0e(0x2c2))))fs['unlinkSync'](path[_0xfffb0e(0x17e)](configpath,'bot-'+_0x56833d+_0xfffb0e(0x2c2)));}catch(_0x38b512){if(_0x38b512)logger[_0xfffb0e(0x1a0)](_0xfffb0e(0x2f2),_0x38b512);}config=getConfiguration(),io['to'](_0xfffb0e(0x1df))[_0xfffb0e(0x1ce)]('bots',config),broadcastToBots(_0xfffb0e(0x280),JSON[_0xfffb0e(0x20d)](config));}function toggleBot(_0x37fdb8,_0x4da688,_0x11b928){const _0x2bf30c=_0x4e5dcf;dbConfig[_0x2bf30c(0x17a)](_0x2bf30c(0x280))[_0x2bf30c(0x13b)]({'botID':_0x37fdb8})[_0x2bf30c(0x23f)]({'status':_0x4da688})[_0x2bf30c(0x23f)]({'live':_0x11b928})[_0x2bf30c(0x286)]();if(_0x4da688=='enabled'||_0x4da688==_0x2bf30c(0x19d))logger[_0x2bf30c(0x1a0)](_0x2bf30c(0x240)+_0x37fdb8),startBot([_0x37fdb8,userID],{'cwd':bbpath},function(_0x223b0a){const _0x5d1e87=_0x2bf30c;if(_0x223b0a)logger[_0x5d1e87(0x1a0)](_0x223b0a);});else(_0x4da688=='disabled'||_0x4da688=='new-disabled')&&(logger[_0x2bf30c(0x1a0)](_0x2bf30c(0x1e3)+_0x37fdb8),stopBot(_0x37fdb8));config=getConfiguration(),io['to'](_0x2bf30c(0x1df))[_0x2bf30c(0x1ce)](_0x2bf30c(0x280),config),broadcastToBots(_0x2bf30c(0x280),JSON['stringify'](config));}function toggleStatus(_0x197fc6){const _0x38a75f=_0x4e5dcf;let _0x273c62=dbConfig[_0x38a75f(0x17a)](_0x38a75f(0x280))[_0x38a75f(0x13b)]({'botID':_0x197fc6})['value'](),_0x3ed913;if(_0x273c62['status']===_0x38a75f(0x1b8))_0x3ed913=_0x38a75f(0x193);else{if(_0x273c62[_0x38a75f(0x2fe)]===_0x38a75f(0x19d))_0x3ed913=_0x38a75f(0x15a);else{if(_0x273c62['status']===_0x38a75f(0x15a))_0x3ed913='new';else{if(_0x273c62[_0x38a75f(0x2fe)]===_0x38a75f(0x193))_0x3ed913=_0x38a75f(0x1b8);}}}return _0x3ed913;}function updateStatus(_0x27655f,_0x2b8141){const _0x19fae8=_0x4e5dcf;dbConfig['get'](_0x19fae8(0x280))[_0x19fae8(0x13b)]({'botID':_0x27655f})[_0x19fae8(0x23f)]({'status':_0x2b8141})[_0x19fae8(0x286)](),config=getConfiguration(),io['to'](_0x19fae8(0x1df))[_0x19fae8(0x1ce)]('bots',config),broadcastToBots(_0x19fae8(0x280),JSON[_0x19fae8(0x20d)](config));}function updateLive(_0x5b06d,_0x2e7eae){const _0x5aa35b=_0x4e5dcf;dbConfig[_0x5aa35b(0x17a)](_0x5aa35b(0x280))[_0x5aa35b(0x13b)]({'botID':_0x5b06d})['assign']({'live':_0x2e7eae})[_0x5aa35b(0x286)](),config=getConfiguration(),io['to']('botmanager')[_0x5aa35b(0x1ce)](_0x5aa35b(0x280),config),broadcastToBots('bots',JSON[_0x5aa35b(0x20d)](config));}function updateBotName(_0x2f2862,_0x379c94){const _0xfb99ca=_0x4e5dcf;dbConfig[_0xfb99ca(0x17a)](_0xfb99ca(0x280))[_0xfb99ca(0x13b)]({'botID':_0x2f2862})['assign']({'botname':_0x379c94})[_0xfb99ca(0x286)](),config=getConfiguration(),io['to'](_0xfb99ca(0x1df))[_0xfb99ca(0x1ce)](_0xfb99ca(0x280),config),broadcastToBots('bots',JSON[_0xfb99ca(0x20d)](config));}function updateBotManager(){const _0x599ca0=_0x4e5dcf;config=getConfiguration(),io['to'](_0x599ca0(0x1df))[_0x599ca0(0x1ce)](_0x599ca0(0x280),config),broadcastToBots(_0x599ca0(0x280),JSON['stringify'](config));}function toggleBotMode(_0x27b580){const _0x1d2d20=_0x4e5dcf;if(pid[_0x27b580])pid[_0x27b580][_0x1d2d20(0x308)]({'function':_0x1d2d20(0x2f0),'args':null});else{const _0x342a59=configpath+_0x1d2d20(0x303)+_0x27b580+_0x1d2d20(0x18e),_0x588b52=fs['readFileSync'](_0x342a59),_0x428e56=JSON[_0x1d2d20(0x200)](_0x588b52),_0x195e02=_0x428e56[_0x1d2d20(0x292)][0x0][_0x1d2d20(0x290)];_0x428e56[_0x1d2d20(0x292)][0x0][_0x1d2d20(0x290)]=!_0x195e02;const _0x42428a=JSON[_0x1d2d20(0x20d)](_0x428e56,null,0x2);fs[_0x1d2d20(0x1bb)](_0x342a59,_0x42428a),config=getConfiguration(),io['to']('botmanager')[_0x1d2d20(0x1ce)](_0x1d2d20(0x280),config),broadcastToBots('bots',JSON['stringify'](config));}}function telegramError(_0x145f64){const _0x4dd531=_0x4e5dcf;logger[_0x4dd531(0x145)](getTimeStamp()+_0x4dd531(0x183));}function validateTelegram(_0x1b6847){const _0x3c1d67=_0x4e5dcf;if(_0x1b6847[_0x3c1d67(0x155)][_0x3c1d67(0x13e)]!=settings['telegramUsername']&&'@'+_0x1b6847[_0x3c1d67(0x155)]['username']!=settings[_0x3c1d67(0x28c)])return tgBot[_0x3c1d67(0x229)](_0x1b6847[_0x3c1d67(0x248)]['id'],_0x3c1d67(0x250),{'parse_mode':_0x3c1d67(0x181)})[_0x3c1d67(0x17b)](_0x3281be=>{telegramError(_0x3281be);}),![];return!![];}async function initTelegram(){const _0x4f99df=_0x4e5dcf;if(tgBot)tgBot[_0x4f99df(0x1f9)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4f99df(0x140)],{'polling':!![]});let _0x3864e8=_0x4f99df(0x1b7);_0x3864e8+='\x0a',_0x3864e8+=_0x4f99df(0x2a4),_0x3864e8+=_0x4f99df(0x219),_0x3864e8+=_0x4f99df(0x24d),_0x3864e8+=_0x4f99df(0x215),_0x3864e8+=_0x4f99df(0x279),_0x3864e8+=_0x4f99df(0x2e7),_0x3864e8+=_0x4f99df(0x2da),_0x3864e8+=_0x4f99df(0x1ca),_0x3864e8+=_0x4f99df(0x2ec),_0x3864e8+=_0x4f99df(0x241),_0x3864e8+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3864e8+=_0x4f99df(0x169),_0x3864e8+=_0x4f99df(0x1c8),_0x3864e8+=_0x4f99df(0x271);let _0x481182=_0x4f99df(0x1b0);_0x481182+='\x0a',_0x481182+=_0x3864e8,tgBot['onText'](/\/start/,_0x405786=>{const _0x17b1ec=_0x4f99df;if(!validateTelegram(_0x405786))return;if(settings['telegramChatId']!=_0x405786['chat']['id'])updateSetting(_0x17b1ec(0x224),_0x405786[_0x17b1ec(0x248)]['id']);updateSetting(_0x17b1ec(0x2b2),!![]),tgBot[_0x17b1ec(0x229)](_0x405786[_0x17b1ec(0x248)]['id'],_0x481182)[_0x17b1ec(0x17b)](_0x919db7=>{telegramError(_0x919db7);});}),tgBot[_0x4f99df(0x262)](/\/enable/,_0x49a553=>{const _0x2f6a3c=_0x4f99df;if(!validateTelegram(_0x49a553))return;if(settings['telegramChatId']!=_0x49a553[_0x2f6a3c(0x248)]['id'])updateSetting(_0x2f6a3c(0x224),_0x49a553[_0x2f6a3c(0x248)]['id']);updateSetting(_0x2f6a3c(0x2b2),!![]),tgBot[_0x2f6a3c(0x229)](_0x49a553['chat']['id'],_0x2f6a3c(0x2d5))['catch'](_0x5e02e1=>{telegramError(_0x5e02e1);});}),tgBot['onText'](/\/config/,async _0x1ae3c2=>{const _0x3dffcc=_0x4f99df;if(!validateTelegram(_0x1ae3c2))return;tgBot['removeListener'](_0x3dffcc(0x1c5)),tgBot[_0x3dffcc(0x229)](_0x1ae3c2[_0x3dffcc(0x248)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x3dffcc(0x20c)},{'text':'Alerts','callback_data':_0x3dffcc(0x2d4)},{'text':_0x3dffcc(0x151),'callback_data':_0x3dffcc(0x1f6)}]]}})[_0x3dffcc(0x17b)](_0x32fd02=>{telegramError(_0x32fd02);}),tgBot['on']('callback_query',async _0x3677bc=>{const _0x5849b6=_0x3dffcc,_0x3794aa=_0x3677bc[_0x5849b6(0x2ba)],_0x5457f7=_0x3677bc[_0x5849b6(0x154)];tgBot['answerCallbackQuery'](_0x3677bc['id'])[_0x5849b6(0x30a)](async()=>{const _0x78a6b4=_0x5849b6;_0x3794aa=='orders'&&(updateSetting(_0x78a6b4(0x1aa),_0x78a6b4(0x20c)),updateSetting(_0x78a6b4(0x2b2),!![]),await tgBot['sendMessage'](_0x5457f7[_0x78a6b4(0x248)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x78a6b4(0x17b)](_0x3bcf6c=>{telegramError(_0x3bcf6c);}));_0x3794aa==_0x78a6b4(0x2d4)&&(updateSetting(_0x78a6b4(0x1aa),_0x78a6b4(0x2d4)),updateSetting(_0x78a6b4(0x2b2),!![]),await tgBot[_0x78a6b4(0x229)](_0x5457f7[_0x78a6b4(0x248)]['id'],_0x78a6b4(0x261))[_0x78a6b4(0x17b)](_0x4f11ad=>{telegramError(_0x4f11ad);}));_0x3794aa==_0x78a6b4(0x1f6)&&(updateSetting(_0x78a6b4(0x1aa),_0x78a6b4(0x1f6)),updateSetting(_0x78a6b4(0x2b2),!![]),await tgBot[_0x78a6b4(0x229)](_0x5457f7[_0x78a6b4(0x248)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x78a6b4(0x17b)](_0x2c786b=>{telegramError(_0x2c786b);}));if(!settings[_0x78a6b4(0x224)])tgBot[_0x78a6b4(0x229)](_0x5457f7[_0x78a6b4(0x248)]['id'],_0x78a6b4(0x186))[_0x78a6b4(0x17b)](_0x43f619=>{telegramError(_0x43f619);});}),tgBot[_0x5849b6(0x2b7)](_0x5849b6(0x1c5));});}),tgBot['onText'](/\/status/,_0x5abf26=>{const _0x29e01d=_0x4f99df;if(!validateTelegram(_0x5abf26))return;const _0x4a7753=getBotsWithMode();let _0x2cda6d=_0x29e01d(0x1a1);config[_0x29e01d(0x2e8)](_0xc12043=>{const _0xe657b6=_0x29e01d,_0x29506b=_0x4a7753[_0xe657b6(0x13b)](_0x1d720f=>_0x1d720f['botID']==_0xc12043[_0xe657b6(0x306)])[_0xe657b6(0x1d3)];_0x2cda6d+=_0xe657b6(0x1c6)+_0xc12043['botID']+':\x20'+_0xc12043['status']+_0xe657b6(0x18a)+_0x29506b+_0xe657b6(0x18a)+_0xc12043[_0xe657b6(0x273)]+'\x0a';}),_0x2cda6d+='\x0a',_0x2cda6d+=_0x29e01d(0x130),_0x2cda6d+=!settings[_0x29e01d(0x2b2)]?_0x29e01d(0x2cf):_0x29e01d(0x2be),_0x2cda6d+=settings[_0x29e01d(0x2b2)]?settings['telegramEvents']=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x29e01d(0x14e)+settings[_0x29e01d(0x1aa)]+'\x20only\x0a':'',tgBot['sendMessage'](_0x5abf26['chat']['id'],_0x2cda6d,{'parse_mode':_0x29e01d(0x181)})[_0x29e01d(0x17b)](_0x3d0be3=>{telegramError(_0x3d0be3);});}),tgBot[_0x4f99df(0x262)](/\/restart/,_0x82d707=>{const _0x1f3ed6=_0x4f99df;if(!validateTelegram(_0x82d707))return;tgBot[_0x1f3ed6(0x2b7)](_0x1f3ed6(0x1c5));const _0x2a4ca7=getEnabledBots();if(_0x2a4ca7['length']==0x0)tgBot['sendMessage'](_0x82d707[_0x1f3ed6(0x248)]['id'],_0x1f3ed6(0x15d))['catch'](_0x3cc676=>{telegramError(_0x3cc676);});else{if(_0x2a4ca7[_0x1f3ed6(0x1de)]>0x1)_0x2a4ca7['push']({'botID':_0x1f3ed6(0x1f6)});let _0x412c1e=[],_0x504b88=[];const _0x2cef73=_0x2a4ca7[_0x1f3ed6(0x1de)]%0x4==0x0||_0x2a4ca7[_0x1f3ed6(0x1de)]%0x4==0x3||_0x2a4ca7[_0x1f3ed6(0x1de)]%0x3==0x1?0x4:0x3;let _0xd6a673=0x0;_0x2a4ca7[_0x1f3ed6(0x2e8)]((_0x431427,_0x3a3421)=>{const _0x40194b=_0x1f3ed6;if(_0x3a3421%_0x2cef73==0x0)_0x504b88=[];_0x504b88[_0x40194b(0x1cc)]({'text':_0x431427['botID']==_0x40194b(0x1f6)?_0x40194b(0x1ff):_0x40194b(0x1c6)+_0x431427[_0x40194b(0x306)],'callback_data':_0x431427[_0x40194b(0x306)]}),_0x3a3421%_0x2cef73==0x0&&(_0x412c1e[_0xd6a673]=_0x504b88,_0xd6a673++);}),tgBot['sendMessage'](_0x82d707[_0x1f3ed6(0x248)]['id'],_0x1f3ed6(0x16d),{'reply_markup':{'inline_keyboard':_0x412c1e}})['catch'](_0x529534=>{telegramError(_0x529534);}),tgBot['on'](_0x1f3ed6(0x1c5),async _0x4d395d=>{const _0x38ca91=_0x1f3ed6,_0x38fe2f=_0x4d395d[_0x38ca91(0x2ba)],_0xb04898=_0x4d395d[_0x38ca91(0x154)];tgBot[_0x38ca91(0x129)](_0x4d395d['id'])[_0x38ca91(0x30a)](async()=>{const _0x24e6e2=_0x38ca91;_0x38fe2f==_0x24e6e2(0x1f6)?config[_0x24e6e2(0x2e8)](_0x8c2566=>{restartBot(_0x8c2566['botID']);}):restartBot(_0x38fe2f);}),tgBot['removeListener'](_0x38ca91(0x1c5));});}}),tgBot[_0x4f99df(0x262)](/\/on/,_0x51a2fe=>{const _0x4a8577=_0x4f99df;if(!validateTelegram(_0x51a2fe))return;tgBot[_0x4a8577(0x2b7)](_0x4a8577(0x1c5));const _0x52b341=getDisabledBots();if(_0x52b341['length']==0x0)tgBot[_0x4a8577(0x229)](_0x51a2fe[_0x4a8577(0x248)]['id'],_0x4a8577(0x13a))[_0x4a8577(0x17b)](_0x32c0a3=>{telegramError(_0x32c0a3);});else{if(_0x52b341[_0x4a8577(0x1de)]>0x1)_0x52b341[_0x4a8577(0x1cc)]({'botID':_0x4a8577(0x1f6)});let _0x33eb7=[],_0x303414=[];const _0x131caa=_0x52b341[_0x4a8577(0x1de)]%0x4==0x0||_0x52b341[_0x4a8577(0x1de)]%0x4==0x3||_0x52b341[_0x4a8577(0x1de)]%0x3==0x1?0x4:0x3;let _0x2eaac3=0x0;_0x52b341[_0x4a8577(0x2e8)]((_0x11c23b,_0x2ab29b)=>{const _0x22652f=_0x4a8577;if(_0x2ab29b%_0x131caa==0x0)_0x303414=[];_0x303414['push']({'text':_0x11c23b['botID']==_0x22652f(0x1f6)?_0x22652f(0x1ff):'Bot\x20'+_0x11c23b['botID'],'callback_data':_0x11c23b[_0x22652f(0x306)]}),_0x2ab29b%_0x131caa==0x0&&(_0x33eb7[_0x2eaac3]=_0x303414,_0x2eaac3++);}),tgBot[_0x4a8577(0x229)](_0x51a2fe[_0x4a8577(0x248)]['id'],_0x4a8577(0x237),{'reply_markup':{'inline_keyboard':_0x33eb7}})['catch'](_0x14979d=>{telegramError(_0x14979d);}),tgBot['on'](_0x4a8577(0x1c5),async _0x4ded53=>{const _0x4ba193=_0x4a8577,_0x5d68d0=_0x4ded53['data'],_0x18d930=_0x4ded53[_0x4ba193(0x154)];tgBot[_0x4ba193(0x129)](_0x4ded53['id'])[_0x4ba193(0x30a)](async()=>{const _0x92f136=_0x4ba193;_0x5d68d0==_0x92f136(0x1f6)?(tgBot[_0x92f136(0x229)](_0x18d930[_0x92f136(0x248)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x92f136(0x17b)](_0x229b72=>{telegramError(_0x229b72);}),_0x52b341[_0x92f136(0x2e8)](_0x5bee3a=>{const _0x48702b=_0x92f136;if(_0x5bee3a[_0x48702b(0x306)]!=_0x48702b(0x1f6))toggleBot(_0x5bee3a[_0x48702b(0x306)],toggleStatus(_0x5bee3a[_0x48702b(0x306)]),_0x48702b(0x289));})):(tgBot[_0x92f136(0x229)](_0x18d930[_0x92f136(0x248)]['id'],_0x92f136(0x299)+_0x5d68d0)[_0x92f136(0x17b)](_0xdd5f24=>{telegramError(_0xdd5f24);}),toggleBot(_0x5d68d0,toggleStatus(_0x5d68d0),_0x92f136(0x289)));}),tgBot['removeListener'](_0x4ba193(0x1c5));});}}),tgBot[_0x4f99df(0x262)](/\/off/,_0x165d1b=>{const _0xbf8d47=_0x4f99df;if(!validateTelegram(_0x165d1b))return;tgBot[_0xbf8d47(0x2b7)](_0xbf8d47(0x1c5));const _0x198864=getEnabledBots();if(_0x198864[_0xbf8d47(0x1de)]==0x0)tgBot['sendMessage'](_0x165d1b['chat']['id'],_0xbf8d47(0x15d))[_0xbf8d47(0x17b)](_0x259ffb=>{telegramError(_0x259ffb);});else{if(_0x198864[_0xbf8d47(0x1de)]>0x1)_0x198864['push']({'botID':_0xbf8d47(0x1f6)});let _0x41bf02=[],_0x1424ba=[];const _0x2e0657=_0x198864[_0xbf8d47(0x1de)]%0x4==0x0||_0x198864[_0xbf8d47(0x1de)]%0x4==0x3||_0x198864['length']%0x3==0x1?0x4:0x3;let _0x22a134=0x0;_0x198864[_0xbf8d47(0x2e8)]((_0x3d8da5,_0x18c54f)=>{const _0x44b708=_0xbf8d47;if(_0x18c54f%_0x2e0657==0x0)_0x1424ba=[];_0x1424ba[_0x44b708(0x1cc)]({'text':_0x3d8da5[_0x44b708(0x306)]=='all'?_0x44b708(0x1ff):_0x44b708(0x1c6)+_0x3d8da5[_0x44b708(0x306)],'callback_data':_0x3d8da5[_0x44b708(0x306)]}),_0x18c54f%_0x2e0657==0x0&&(_0x41bf02[_0x22a134]=_0x1424ba,_0x22a134++);}),tgBot[_0xbf8d47(0x229)](_0x165d1b['chat']['id'],_0xbf8d47(0x1d8),{'reply_markup':{'inline_keyboard':_0x41bf02}})['catch'](_0x53df3f=>{telegramError(_0x53df3f);}),tgBot['on'](_0xbf8d47(0x1c5),async _0x3df50e=>{const _0xfb8169=_0xbf8d47,_0x2e6fda=_0x3df50e['data'],_0xd7e4c=_0x3df50e[_0xfb8169(0x154)];tgBot[_0xfb8169(0x129)](_0x3df50e['id'])[_0xfb8169(0x30a)](async()=>{const _0x26149c=_0xfb8169;_0x2e6fda==_0x26149c(0x1f6)?(tgBot[_0x26149c(0x229)](_0xd7e4c[_0x26149c(0x248)]['id'],_0x26149c(0x150))[_0x26149c(0x17b)](_0x174d50=>{telegramError(_0x174d50);}),_0x198864[_0x26149c(0x2e8)](_0x43a3de=>{const _0x544cb3=_0x26149c;if(_0x43a3de[_0x544cb3(0x306)]!=_0x544cb3(0x1f6))toggleBot(_0x43a3de[_0x544cb3(0x306)],toggleStatus(_0x43a3de[_0x544cb3(0x306)]),_0x544cb3(0x289));})):(tgBot[_0x26149c(0x229)](_0xd7e4c[_0x26149c(0x248)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x2e6fda)['catch'](_0x126cba=>{telegramError(_0x126cba);}),toggleBot(_0x2e6fda,toggleStatus(_0x2e6fda),_0x26149c(0x289)));}),tgBot[_0xfb8169(0x2b7)](_0xfb8169(0x1c5));});}}),tgBot['onText'](/\/metrics/,_0x549df5=>{const _0x200e4b=_0x4f99df;if(!validateTelegram(_0x549df5))return;tgBot[_0x200e4b(0x2b7)](_0x200e4b(0x1c5));const _0x2f729a=getEnabledBots();if(_0x2f729a['length']==0x0)tgBot[_0x200e4b(0x229)](_0x549df5[_0x200e4b(0x248)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x200e4b(0x17b)](_0x378b21=>{telegramError(_0x378b21);});else{if(_0x2f729a['length']>0x1){let _0x3c6cb5=[],_0x5244d2=[];const _0x29479e=_0x2f729a['length']%0x4==0x0||_0x2f729a[_0x200e4b(0x1de)]%0x4==0x3||_0x2f729a['length']%0x3==0x1?0x4:0x3;let _0x43e77c=0x0;_0x2f729a['forEach']((_0x1fb60c,_0x835a97)=>{const _0x5720e2=_0x200e4b;if(_0x835a97%_0x29479e==0x0)_0x5244d2=[];_0x5244d2[_0x5720e2(0x1cc)]({'text':_0x5720e2(0x1c6)+_0x1fb60c['botID'],'callback_data':_0x1fb60c[_0x5720e2(0x306)]}),_0x835a97%_0x29479e==0x0&&(_0x3c6cb5[_0x43e77c]=_0x5244d2,_0x43e77c++);}),tgBot[_0x200e4b(0x229)](_0x549df5[_0x200e4b(0x248)]['id'],_0x200e4b(0x2c8),{'reply_markup':{'inline_keyboard':_0x3c6cb5}})[_0x200e4b(0x17b)](_0x26d2ff=>{telegramError(_0x26d2ff);}),tgBot['on']('callback_query',async _0x2c5b66=>{const _0x2334ff=_0x200e4b,_0x36d638=_0x2c5b66['data'],_0x26f763=_0x2c5b66[_0x2334ff(0x154)];tgBot[_0x2334ff(0x129)](_0x2c5b66['id'])['then'](async()=>{const _0x3ebc97=_0x2334ff;if(pid[_0x36d638])pid[_0x36d638][_0x3ebc97(0x308)]({'function':_0x3ebc97(0x29e),'args':null});}),tgBot[_0x2334ff(0x2b7)]('callback_query');});}else{const _0x5abf80=_0x2f729a[0x0][_0x200e4b(0x306)];if(pid[_0x5abf80])pid[_0x5abf80][_0x200e4b(0x308)]({'function':_0x200e4b(0x29e),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x2fbaac=>{const _0x3e494f=_0x4f99df;if(!validateTelegram(_0x2fbaac))return;tgBot[_0x3e494f(0x2b7)](_0x3e494f(0x1c5));const _0x442569=getEnabledBots();if(_0x442569[_0x3e494f(0x1de)]==0x0)tgBot[_0x3e494f(0x229)](_0x2fbaac[_0x3e494f(0x248)]['id'],_0x3e494f(0x15d))['catch'](_0x5e26bd=>{telegramError(_0x5e26bd);});else{if(_0x442569[_0x3e494f(0x1de)]>0x1){let _0x2d07ef=[],_0x5eb631=[];const _0xfcb835=_0x442569[_0x3e494f(0x1de)]%0x4==0x0||_0x442569['length']%0x4==0x3||_0x442569[_0x3e494f(0x1de)]%0x3==0x1?0x4:0x3;let _0x84b3df=0x0;_0x442569[_0x3e494f(0x2e8)]((_0x3dbe81,_0x51b522)=>{const _0x4df26a=_0x3e494f;if(_0x51b522%_0xfcb835==0x0)_0x5eb631=[];_0x5eb631[_0x4df26a(0x1cc)]({'text':_0x4df26a(0x1c6)+_0x3dbe81[_0x4df26a(0x306)],'callback_data':_0x3dbe81[_0x4df26a(0x306)]}),_0x51b522%_0xfcb835==0x0&&(_0x2d07ef[_0x84b3df]=_0x5eb631,_0x84b3df++);}),tgBot[_0x3e494f(0x229)](_0x2fbaac['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x2d07ef}})[_0x3e494f(0x17b)](_0x49df44=>{telegramError(_0x49df44);}),tgBot['on'](_0x3e494f(0x1c5),async _0x510b5b=>{const _0x22992f=_0x3e494f,_0xf1c69a=_0x510b5b[_0x22992f(0x2ba)],_0x442a73=_0x510b5b[_0x22992f(0x154)];tgBot[_0x22992f(0x129)](_0x510b5b['id'])[_0x22992f(0x30a)](async()=>{const _0x18d428=_0x22992f;if(pid[_0xf1c69a])pid[_0xf1c69a][_0x18d428(0x308)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x22992f(0x2b7)](_0x22992f(0x1c5));});}else{const _0x3deab9=_0x442569[0x0][_0x3e494f(0x306)];if(pid[_0x3deab9])pid[_0x3deab9]['send']({'function':_0x3e494f(0x161),'args':null});}}}),tgBot[_0x4f99df(0x262)](/\/update/,async _0x1c2dce=>{const _0xe7376e=_0x4f99df;if(!validateTelegram(_0x1c2dce))return;tgBot['removeListener'](_0xe7376e(0x1c5)),await getMessages();if(!updateAvailable)tgBot[_0xe7376e(0x229)](_0x1c2dce[_0xe7376e(0x248)]['id'],_0xe7376e(0x274))['catch'](_0x360e3d=>{telegramError(_0x360e3d);});else!validInstallation?tgBot['sendMessage'](_0x1c2dce[_0xe7376e(0x248)]['id'],_0xe7376e(0x29b))[_0xe7376e(0x17b)](_0x891f22=>{telegramError(_0x891f22);}):(tgBot[_0xe7376e(0x229)](_0x1c2dce[_0xe7376e(0x248)]['id'],_0xe7376e(0x228),{'reply_markup':{'inline_keyboard':[[{'text':_0xe7376e(0x298),'callback_data':_0xe7376e(0x28d)},{'text':'No','callback_data':'no'}]]}})[_0xe7376e(0x17b)](_0x548c76=>{telegramError(_0x548c76);}),tgBot['on'](_0xe7376e(0x1c5),async _0x40def6=>{const _0x58f9a1=_0xe7376e,_0x5313a3=_0x40def6[_0x58f9a1(0x2ba)],_0x321593=_0x40def6[_0x58f9a1(0x154)];tgBot[_0x58f9a1(0x129)](_0x40def6['id'])[_0x58f9a1(0x30a)](async()=>{const _0x2e986b=_0x58f9a1;_0x5313a3==_0x2e986b(0x28d)&&(await tgBot['sendMessage'](_0x321593[_0x2e986b(0x248)]['id'],_0x2e986b(0x211))['catch'](_0x24f398=>{telegramError(_0x24f398);}),updateBB(_0x2e986b(0x1f4))),_0x5313a3=='no'&&await tgBot[_0x2e986b(0x229)](_0x321593[_0x2e986b(0x248)]['id'],_0x2e986b(0x1bf))[_0x2e986b(0x17b)](_0xcc9d5a=>{telegramError(_0xcc9d5a);});}),tgBot[_0x58f9a1(0x2b7)]('callback_query');}));}),tgBot[_0x4f99df(0x262)](/\/reinstall/,async _0x48e9e6=>{const _0x20fc00=_0x4f99df;if(!validateTelegram(_0x48e9e6))return;tgBot['removeListener'](_0x20fc00(0x1c5)),!validInstallation?tgBot[_0x20fc00(0x229)](_0x48e9e6[_0x20fc00(0x248)]['id'],_0x20fc00(0x2ef))['catch'](_0x3b73b9=>{telegramError(_0x3b73b9);}):(tgBot['sendMessage'](_0x48e9e6[_0x20fc00(0x248)]['id'],_0x20fc00(0x170),{'reply_markup':{'inline_keyboard':[[{'text':_0x20fc00(0x298),'callback_data':_0x20fc00(0x28d)},{'text':'No','callback_data':'no'}]]}})[_0x20fc00(0x17b)](_0x5aa5b8=>{telegramError(_0x5aa5b8);}),tgBot['on'](_0x20fc00(0x1c5),async _0x5ebcae=>{const _0xf3d311=_0x20fc00,_0x598320=_0x5ebcae[_0xf3d311(0x2ba)],_0x17a5b4=_0x5ebcae[_0xf3d311(0x154)];tgBot['answerCallbackQuery'](_0x5ebcae['id'])[_0xf3d311(0x30a)](async()=>{const _0x4087f1=_0xf3d311;_0x598320==_0x4087f1(0x28d)&&(await tgBot[_0x4087f1(0x229)](_0x17a5b4[_0x4087f1(0x248)]['id'],_0x4087f1(0x210))[_0x4087f1(0x17b)](_0x2cc2df=>{telegramError(_0x2cc2df);}),updateBB(_0x4087f1(0x295))),_0x598320=='no'&&await tgBot['sendMessage'](_0x17a5b4[_0x4087f1(0x248)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x4087f1(0x17b)](_0x4fd33f=>{telegramError(_0x4fd33f);});}),tgBot[_0xf3d311(0x2b7)](_0xf3d311(0x1c5));}));}),tgBot[_0x4f99df(0x262)](/\/toggle/,_0x2a7528=>{const _0x3890e0=_0x4f99df;if(!validateTelegram(_0x2a7528))return;tgBot[_0x3890e0(0x2b7)](_0x3890e0(0x1c5));const _0x23bb7b=getBotsWithMode();if(_0x23bb7b[_0x3890e0(0x1de)]==0x0)tgBot[_0x3890e0(0x229)](_0x2a7528[_0x3890e0(0x248)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x3890e0(0x17b)](_0x28d0ba=>{telegramError(_0x28d0ba);});else{let _0x326cf8=[],_0x2caf1f=[];const _0x483a6e=0x2;let _0x26d007=0x0;_0x23bb7b[_0x3890e0(0x2e8)]((_0x498f65,_0x4a832a)=>{const _0x1d879b=_0x3890e0;if(_0x4a832a%_0x483a6e==0x0)_0x2caf1f=[];_0x2caf1f[_0x1d879b(0x1cc)]({'text':_0x1d879b(0x1c6)+_0x498f65[_0x1d879b(0x306)]+'\x20('+_0x498f65[_0x1d879b(0x1d3)]+')','callback_data':_0x498f65[_0x1d879b(0x306)]}),_0x4a832a%_0x483a6e==0x0&&(_0x326cf8[_0x26d007]=_0x2caf1f,_0x26d007++);}),tgBot[_0x3890e0(0x229)](_0x2a7528[_0x3890e0(0x248)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x326cf8}})['catch'](_0x4a5f77=>{telegramError(_0x4a5f77);}),tgBot['on'](_0x3890e0(0x1c5),async _0x98dc62=>{const _0x595444=_0x3890e0,_0x6ebb3f=_0x98dc62[_0x595444(0x2ba)],_0x25e092=_0x98dc62[_0x595444(0x154)];tgBot[_0x595444(0x129)](_0x98dc62['id'])['then'](async()=>{const _0x577781=_0x595444,_0x39de37=_0x23bb7b[_0x577781(0x13b)](_0xe815ce=>_0xe815ce['botID']==_0x6ebb3f),_0x33db2c=_0x39de37['mode']==_0x577781(0x26c)?_0x577781(0x293):'auto';tgBot[_0x577781(0x229)](_0x25e092[_0x577781(0x248)]['id'],_0x577781(0x23a)+_0x6ebb3f+_0x577781(0x28a)+_0x33db2c+_0x577781(0x266))['catch'](_0x4efe0b=>{telegramError(_0x4efe0b);}),toggleBotMode(_0x6ebb3f);}),tgBot[_0x595444(0x2b7)](_0x595444(0x1c5));});}}),tgBot[_0x4f99df(0x262)](/\/names/,_0x146202=>{const _0x270b40=_0x4f99df;if(!validateTelegram(_0x146202))return;let _0x889148='';config[_0x270b40(0x2e8)](_0x3fd34f=>{const _0x3db351=_0x270b40;_0x889148+=_0x3db351(0x1c6)+_0x3fd34f[_0x3db351(0x306)]+':\x20'+_0x3fd34f[_0x3db351(0x199)]+'\x0a';}),tgBot[_0x270b40(0x229)](_0x146202[_0x270b40(0x248)]['id'],_0x889148,{'parse_mode':_0x270b40(0x181)})[_0x270b40(0x17b)](_0x3847fd=>{telegramError(_0x3847fd);});}),tgBot[_0x4f99df(0x262)](/\/disable/,_0x499ade=>{const _0x489856=_0x4f99df;if(!validateTelegram(_0x499ade))return;tgBot[_0x489856(0x229)](_0x499ade[_0x489856(0x248)]['id'],_0x489856(0x1fb))['catch'](_0x3aa16f=>{telegramError(_0x3aa16f);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x4f99df(0x262)](/\/help/,_0x406a39=>{const _0x1aef78=_0x4f99df;if(!validateTelegram(_0x406a39))return;tgBot[_0x1aef78(0x229)](_0x406a39[_0x1aef78(0x248)]['id'],_0x3864e8)[_0x1aef78(0x17b)](_0xde69c4=>{telegramError(_0xde69c4);});}),tgBot['on']('polling_error',_0x134581=>{const _0x5ad6d5=_0x4f99df;_0x134581['toString']()[_0x5ad6d5(0x2c3)]('404\x20Not\x20Found')&&(logger['full'](_0x5ad6d5(0x256)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x5ad6d5(0x1df))[_0x5ad6d5(0x1ce)](_0x5ad6d5(0x20e),_0x5ad6d5(0x256)));}),process[_0x4f99df(0x2fd)]('SIGINT',()=>{const _0xd1e943=_0x4f99df;if(tgBot)tgBot[_0xd1e943(0x1f9)]();process[_0xd1e943(0x1b1)](0x1);}),process['once']('SIGTERM',()=>{const _0x55e025=_0x4f99df;if(tgBot)tgBot[_0x55e025(0x1f9)]();process[_0x55e025(0x1b1)](0x1);});}}function disableTelegram(){const _0x1c17c4=_0x4e5dcf;tgBot&&(tgBot[_0x1c17c4(0x1f9)](),tgBot=null);}function sendTelegram(_0x36f58a,_0x31ac63){const _0xb08a1f=_0x4e5dcf;if(settings[_0xb08a1f(0x2b2)]){if(settings[_0xb08a1f(0x1aa)]==_0xb08a1f(0x1f6)||(_0x31ac63[_0xb08a1f(0x12a)]=='error'||_0x31ac63[_0xb08a1f(0x12a)]==_0xb08a1f(0x22d)||_0x31ac63['type']==_0xb08a1f(0x239))&&settings[_0xb08a1f(0x1aa)]==_0xb08a1f(0x2d4)||_0x31ac63['type']=='order'&&settings[_0xb08a1f(0x1aa)]==_0xb08a1f(0x20c)){if(tgBot&&settings[_0xb08a1f(0x224)]){if(_0x31ac63[_0xb08a1f(0x22b)])tgBot[_0xb08a1f(0x229)](settings[_0xb08a1f(0x224)],_0x31ac63[_0xb08a1f(0x199)]+_0xb08a1f(0x2cc)+_0x31ac63[_0xb08a1f(0x24a)])[_0xb08a1f(0x17b)](_0x41f0f4=>{telegramError(_0x41f0f4);});else tgBot[_0xb08a1f(0x229)](settings['telegramChatId'],_0xb08a1f(0x1c6)+_0x36f58a+'\x20>\x20'+_0x31ac63[_0xb08a1f(0x24a)])[_0xb08a1f(0x17b)](_0x4beb02=>{telegramError(_0x4beb02);});}}}}async function sendTelegramMsg(_0x5d2892,_0x3aac42=_0x4e5dcf(0x181)){const _0x3e7b41=_0x4e5dcf;return settings[_0x3e7b41(0x2b2)]&&tgBot&&settings[_0x3e7b41(0x224)]?(await tgBot[_0x3e7b41(0x229)](settings[_0x3e7b41(0x224)],_0x5d2892,{'parse_mode':_0x3aac42})[_0x3e7b41(0x17b)](_0x158622=>{telegramError(_0x158622);}),!![]):![];}function getDeviceWithIp(_0x5a90dd){return devices['find'](_0x8b2854=>_0x8b2854['ip']===_0x5a90dd);}function temporaryAccess2FA(_0x5b02cc,_0x1586ee){const _0x5c53a4=_0x4e5dcf;let _0x2bf6a7=new Date(),_0x4391ea=![];if(lastIpApproval){if(_0x2bf6a7-lastIpApproval<0x1388)_0x4391ea=!![];}lastIpApproval=new Date();if(_0x4391ea)return;tgBot&&settings[_0x5c53a4(0x224)]&&(tgBot['removeListener'](_0x5c53a4(0x1c5)),tgBot[_0x5c53a4(0x229)](settings[_0x5c53a4(0x224)],_0x5c53a4(0x132)+normalizeIP(_0x1586ee)[_0x5c53a4(0x1ee)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5c53a4(0x2dc),'callback_data':'5'},{'text':_0x5c53a4(0x2b1),'callback_data':'15'},{'text':_0x5c53a4(0x257),'callback_data':'30'},{'text':_0x5c53a4(0x146),'callback_data':'reject'}]]}})[_0x5c53a4(0x17b)](_0x26228a=>{telegramError(_0x26228a);}),tgBot['on']('callback_query',async _0x8d5c3c=>{const _0x3a799e=_0x5c53a4,_0xd9a15b=_0x8d5c3c[_0x3a799e(0x2ba)],_0x2cc302=_0x8d5c3c[_0x3a799e(0x154)];tgBot[_0x3a799e(0x129)](_0x8d5c3c['id'])['then'](async()=>{const _0x29dc8f=_0x3a799e;devices[_0x5b02cc]['telegramIpApproval']={'clientip':_0x1586ee,'timestamp':new Date()[_0x29dc8f(0x194)](),'expiry':_0xd9a15b},_0xd9a15b!=_0x29dc8f(0x146)?(await tgBot['sendMessage'](_0x2cc302[_0x29dc8f(0x248)]['id'],_0x29dc8f(0x15e)+_0xd9a15b+'\x20minutes',{'parse_mode':_0x29dc8f(0x181)})['catch'](_0x344951=>{telegramError(_0x344951);}),io['to'](_0x5b02cc)[_0x29dc8f(0x1ce)]('status',{'access':{'allow':![],'reason':_0x29dc8f(0x251),'token':null}})):(await tgBot['sendMessage'](_0x2cc302[_0x29dc8f(0x248)]['id'],_0x29dc8f(0x225))['catch'](_0x583f27=>{telegramError(_0x583f27);}),io['to'](_0x5b02cc)['emit'](_0x29dc8f(0x2fe),{'access':{'allow':![],'reason':_0x29dc8f(0x204),'token':null}}));}),tgBot[_0x3a799e(0x2b7)](_0x3a799e(0x1c5));}));}function loginAccess2FA(_0x469dcb,_0x19bbe1){const _0x309ea0=_0x4e5dcf;tgBot&&settings[_0x309ea0(0x224)]&&(tgBot[_0x309ea0(0x2b7)](_0x309ea0(0x1c5)),tgBot['sendMessage'](settings[_0x309ea0(0x224)],_0x309ea0(0x20f)+normalizeIP(_0x19bbe1)[_0x309ea0(0x1ee)]+_0x309ea0(0x1a2),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x309ea0(0x146)}]]}})[_0x309ea0(0x17b)](_0x3fd9ef=>{telegramError(_0x3fd9ef);}),tgBot['on'](_0x309ea0(0x1c5),async _0x53656d=>{const _0xa277fe=_0x309ea0,_0x361ef7=_0x53656d[_0xa277fe(0x2ba)],_0x2a7db7=_0x53656d[_0xa277fe(0x154)];tgBot[_0xa277fe(0x129)](_0x53656d['id'])['then'](async()=>{const _0x4d1449=_0xa277fe;devices[_0x469dcb]['telegram2FaApproval']={'clientip':_0x19bbe1,'timestamp':new Date()[_0x4d1449(0x194)](),'expiry':_0x361ef7},_0x361ef7!='reject'?(await tgBot[_0x4d1449(0x229)](_0x2a7db7[_0x4d1449(0x248)]['id'],_0x4d1449(0x16c),{'parse_mode':_0x4d1449(0x181)})['catch'](_0x2f1aad=>{telegramError(_0x2f1aad);}),io['to'](_0x469dcb)['emit'](_0x4d1449(0x2fe),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x4d1449(0x229)](_0x2a7db7[_0x4d1449(0x248)]['id'],'Login\x20rejected')[_0x4d1449(0x17b)](_0x1f60b2=>{telegramError(_0x1f60b2);}),io['to'](_0x469dcb)['emit'](_0x4d1449(0x2fe),{'access':{'allow':![],'reason':_0x4d1449(0x2e2),'token':null}}));}),tgBot[_0xa277fe(0x2b7)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x314f30=_0x4e5dcf;return dbConfig[_0x314f30(0x17a)](_0x314f30(0x280))['sortBy']('botID')[_0x314f30(0x1b9)]({'status':_0x314f30(0x1b8)})['value']()||[];}function getDisabledBots(){const _0x968358=_0x4e5dcf;return dbConfig['get']('bots')[_0x968358(0x2f3)]('botID')[_0x968358(0x1b9)]({'status':_0x968358(0x193)})[_0x968358(0x2d9)]()||[];}function getBotAttributes(_0x43fcac){const _0x241b60=_0x4e5dcf;let _0x5ee354={};const _0x50beff=configpath+_0x241b60(0x303)+_0x43fcac+'-config.json',_0x13cc74=fs['existsSync'](_0x50beff);if(_0x13cc74){const _0x450aee=fs['readFileSync'](_0x50beff);try{const _0x2cbe24=JSON[_0x241b60(0x200)](_0x450aee),_0x22b720=_0x2cbe24?_0x2cbe24['bot'][0x0]['headless']:![];_0x5ee354[_0x241b60(0x1d3)]=_0x22b720?'auto':_0x241b60(0x293),_0x5ee354[_0x241b60(0x199)]=_0x2cbe24?_0x2cbe24[_0x241b60(0x292)][0x0][_0x241b60(0x199)]:_0x241b60(0x1c6)+_0x43fcac;}catch(_0x2ebe97){_0x5ee354[_0x241b60(0x1d3)]=_0x241b60(0x293),_0x5ee354[_0x241b60(0x199)]=_0x241b60(0x1c6)+_0x43fcac;}}else _0x5ee354[_0x241b60(0x1d3)]='manual',_0x5ee354[_0x241b60(0x199)]=_0x241b60(0x1c6)+_0x43fcac;return _0x5ee354;}function getBotsWithMode(){const _0x90e39c=_0x4e5dcf,_0x415fec=dbConfig[_0x90e39c(0x17a)]('bots')[_0x90e39c(0x2f3)](_0x90e39c(0x306))[_0x90e39c(0x2d9)]()||[];return _0x415fec['forEach'](_0x156c9e=>{const _0x1a44ac=_0x90e39c;let _0x54ad6d=getBotAttributes(_0x156c9e[_0x1a44ac(0x306)]);_0x156c9e['mode']=_0x54ad6d[_0x1a44ac(0x1d3)];}),_0x415fec;}function getBotExchanges(){const _0x15b8a0=_0x4e5dcf;let _0x103cba=[];const _0x19b46b=dbConfig['get'](_0x15b8a0(0x280))[_0x15b8a0(0x2f3)](_0x15b8a0(0x306))[_0x15b8a0(0x2d9)]()||[];_0x19b46b[_0x15b8a0(0x2e8)](_0x59916f=>{const _0x338eec=_0x15b8a0;if(_0x59916f[_0x338eec(0x2fe)]==_0x338eec(0x1b8)){const _0x32afb3=configpath+_0x338eec(0x303)+_0x59916f[_0x338eec(0x306)]+_0x338eec(0x18e),_0x1ad1fa=fs[_0x338eec(0x26f)](_0x32afb3);let _0x2968b7;if(_0x1ad1fa){const _0x167269=fs['readFileSync'](_0x32afb3);try{const _0x4b917e=JSON[_0x338eec(0x200)](_0x167269);_0x2968b7=_0x4b917e?_0x4b917e[_0x338eec(0x292)][0x0][_0x338eec(0x1e4)]:null;}catch(_0x157817){}}if(_0x2968b7)_0x103cba[_0x338eec(0x1cc)](_0x2968b7);}});const _0x4fb28b=[...new Set(_0x103cba)][_0x15b8a0(0x235)]();return _0x4fb28b;}async function initUser(){const _0x34854d=_0x4e5dcf;if(!settings[_0x34854d(0x18b)]){const _0x256fc9=uuidRandom();mixpanel[_0x34854d(0x2d7)](_0x256fc9),updateSetting(_0x34854d(0x18b),_0x256fc9);}}async function initSecure(){const _0x35b89a=_0x4e5dcf;let _0x468953=getSecure();if(!_0x468953['hasOwnProperty'](_0x35b89a(0x26b))){let _0x2089f1=await generateKeys();_0x468953[_0x35b89a(0x2fa)]=_0x2089f1[_0x35b89a(0x2fa)],_0x468953[_0x35b89a(0x291)]=_0x2089f1[_0x35b89a(0x291)],_0x468953[_0x35b89a(0x26b)]=crypto[_0x35b89a(0x26d)](0x20)[_0x35b89a(0x147)](_0x35b89a(0x270));;storeSecure(_0x468953);}}function getSettings(){const _0x3f469b=_0x4e5dcf;return dbSettings['get'](_0x3f469b(0x25f))[_0x3f469b(0x2d9)]()||{};}function getSecure(){const _0x4bec38=_0x4e5dcf;return dbSecure['get']('secure')[_0x4bec38(0x2d9)]()||{};}function getBlacklist(){const _0x3a3476=_0x4e5dcf;return dbSecure[_0x3a3476(0x17a)]('blacklist')[_0x3a3476(0x2d9)]()||[];}function broadcastToBots(_0x35177c,_0x4cceb6){const _0x3c8c84=_0x4e5dcf;config[_0x3c8c84(0x2e8)](_0x169524=>{const _0x1adfb2=_0x3c8c84;if(_0x169524[_0x1adfb2(0x2fe)]==_0x1adfb2(0x1b8)&&_0x169524[_0x1adfb2(0x273)]==_0x1adfb2(0x302)||_0x169524[_0x1adfb2(0x2fe)]=='new'&&_0x169524[_0x1adfb2(0x273)]==_0x1adfb2(0x302)){if(pid[_0x169524[_0x1adfb2(0x306)]])pid[_0x169524[_0x1adfb2(0x306)]]['send']({[_0x35177c]:_0x4cceb6});}});}function storeSettings(_0x551364,_0xce7a75=![]){const _0x24cad3=_0x4e5dcf;_0x551364={...settings,..._0x551364};if(_0xce7a75&&_0x551364['bbPassword']!='************'&&_0x551364[_0x24cad3(0x2c7)]!=_0x24cad3(0x2ff)&&_0x551364[_0x24cad3(0x2c7)]!=''){const _0x36158c=crypt[_0x24cad3(0x1ed)](secure['privateKey'],_0x551364[_0x24cad3(0x2c7)])[_0x24cad3(0x154)][_0x24cad3(0x23c)]('@')[0x0],_0xf04610=bcrypt[_0x24cad3(0x16f)](_0x36158c,saltRounds);_0x551364={..._0x551364,'bbPassword':_0xf04610};}if(_0xce7a75&&_0x551364[_0x24cad3(0x140)]!=_0x24cad3(0x198)&&_0x551364[_0x24cad3(0x140)]!=_0x24cad3(0x2ff)&&_0x551364[_0x24cad3(0x140)]!=''){const _0x26eeb8=crypt[_0x24cad3(0x1ed)](secure[_0x24cad3(0x291)],_0x551364[_0x24cad3(0x140)])[_0x24cad3(0x154)][_0x24cad3(0x23c)]('@')[0x0];_0x551364={..._0x551364,'telegramToken':_0x26eeb8};}const _0x4e6772=_0x551364['telegramToken']!=_0x24cad3(0x198)&&_0x551364['telegramToken']!=settings[_0x24cad3(0x140)]||_0x551364['telegramUsername']!=settings[_0x24cad3(0x28c)],_0x36d57a=_0x551364[_0x24cad3(0x140)]==''||_0x551364['telegramUsername']=='';if(_0x4e6772)_0x551364['telegramEvents']='all';for(const [_0x1279da,_0x4934c9]of Object[_0x24cad3(0x24f)](_0x551364)){if(_0x1279da=='telegramToken'&&_0x4934c9==_0x24cad3(0x198)){_0x551364[_0x24cad3(0x140)]=settings[_0x24cad3(0x140)];continue;};if(_0x1279da==_0x24cad3(0x2c7)&&_0x4934c9==_0x24cad3(0x198)){_0x551364['bbPassword']=settings[_0x24cad3(0x2c7)];continue;};dbSettings['set'](_0x24cad3(0x2eb)+_0x1279da,_0x4934c9)[_0x24cad3(0x286)]();}settings=_0x551364,io['to'](_0x24cad3(0x1df))['emit']('settings',cleanSettings()),broadcastToBots(_0x24cad3(0x232),settings['timeshift']),broadcastToBots('onepagemode',settings[_0x24cad3(0x196)]);if(_0x4e6772&&!_0x36d57a)initTelegram();if(_0x4e6772&&_0x36d57a)disableTelegram();getAllClients()[_0x24cad3(0x2e8)](_0x13171c=>{const _0xccc10b=_0x24cad3;getSocket(_0x13171c['id'])[_0xccc10b(0x1ce)](_0xccc10b(0x2fe),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x1c82c1,_0x195eeb){const _0x16abe2=_0x4e5dcf;dbSettings[_0x16abe2(0x217)](_0x16abe2(0x2eb)+_0x1c82c1,_0x195eeb)['write'](),settings=getSettings(),io['to']('botmanager')[_0x16abe2(0x1ce)](_0x16abe2(0x25f),cleanSettings());}function storeSecure(_0x44f1b4){const _0x3bc566=_0x4e5dcf;dbSecure['get']('secure')['push'](_0x44f1b4)[_0x3bc566(0x286)](),secure=_0x44f1b4;}function addBlacklist(_0x211ea9){const _0x5e7f78=_0x4e5dcf;cleanBlacklist();let _0x5a057d;devices[_0x211ea9][_0x5e7f78(0x2c9)]?_0x5a057d=Math[_0x5e7f78(0x2ae)](devices[_0x211ea9][_0x5e7f78(0x2c9)][_0x5e7f78(0x1fe)],loginExpiry):_0x5a057d=loginExpiry,dbSecure[_0x5e7f78(0x17a)](_0x5e7f78(0x202))[_0x5e7f78(0x1cc)]({'expiry':new Date()[_0x5e7f78(0x194)]()+_0x5a057d*0x3c*0x3e8,'token':devices[_0x211ea9][_0x5e7f78(0x24e)][_0x5e7f78(0x1f3)]})[_0x5e7f78(0x286)](),blacklist=dbSecure[_0x5e7f78(0x17a)]('blacklist')[_0x5e7f78(0x2d9)]();}function cleanBlacklist(){const _0x4c3fff=_0x4e5dcf;let _0x4d49e5=dbSecure[_0x4c3fff(0x17a)](_0x4c3fff(0x202))[_0x4c3fff(0x23e)]()[_0x4c3fff(0x2d9)](),_0x580e55=new Date()[_0x4c3fff(0x194)]();_0x4d49e5[_0x4c3fff(0x2e8)](_0x41826d=>{const _0x26a1a5=_0x4c3fff;_0x41826d[_0x26a1a5(0x1fe)]<_0x580e55&&dbSecure[_0x26a1a5(0x17a)](_0x26a1a5(0x202))[_0x26a1a5(0x13c)]({'expiry':_0x41826d['expiry']})[_0x26a1a5(0x286)]();});}function initStates(){const _0xfe2100=_0x4e5dcf;let _0x2bec30=getConfiguration();_0x2bec30[_0xfe2100(0x2e8)](_0xb4c20a=>{const _0x183849=_0xfe2100;_0xb4c20a['live']=_0x183849(0x289);}),storeConfiguration(_0x2bec30);}function onKeys(){const _0x5e6755=new RSA();return new Promise(_0x1b0335=>{const _0x5167b0=_0x3687;_0x5e6755[_0x5167b0(0x29d)]()['then'](_0x593ded=>{_0x1b0335(_0x593ded);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3ffd24=_0x4e5dcf;let _0x1566d8=getSettings(),_0x25286e=![];!_0x1566d8[_0x3ffd24(0x2e5)](_0x3ffd24(0x136))&&(_0x1566d8['lastmsgtelegram']=0x0,_0x25286e=!![]);!_0x1566d8[_0x3ffd24(0x2e5)]('lastmsgemitted')&&(_0x1566d8[_0x3ffd24(0x22f)]=0x0,_0x25286e=!![]);!_0x1566d8['hasOwnProperty'](_0x3ffd24(0x19e))&&(_0x1566d8[_0x3ffd24(0x19e)]=_0x3ffd24(0x2ca),_0x25286e=!![]);!_0x1566d8[_0x3ffd24(0x2e5)](_0x3ffd24(0x196))&&(_0x1566d8[_0x3ffd24(0x196)]=![],_0x25286e=!![]);if(_0x25286e)storeSettings(_0x1566d8);try{fs[_0x3ffd24(0x220)](configbackuppath,{'withFileTypes':!![]})[_0x3ffd24(0x2e8)](_0x24563b=>{const _0x36a8d0=_0x3ffd24;if(!_0x24563b[_0x36a8d0(0x1e2)]()){if(!_0x24563b[_0x36a8d0(0x1c7)]['startsWith']('backup-full@'))fs[_0x36a8d0(0x1ae)](configbackuppath+_0x24563b[_0x36a8d0(0x1c7)]);}else fs[_0x36a8d0(0x1a7)](configbackuppath+_0x24563b[_0x36a8d0(0x1c7)],{'recursive':!![]});});}catch(_0x3828b6){logger[_0x3ffd24(0x2cb)](_0x3ffd24(0x20b),_0x3828b6);}}function storeConfiguration(_0x3af695){const _0x390566=_0x4e5dcf;dbConfig[_0x390566(0x17a)]('bots')[_0x390566(0x13c)]()[_0x390566(0x286)](),_0x3af695[_0x390566(0x2e8)](_0x132a0f=>{const _0x56f5d3=_0x390566;delete _0x132a0f[_0x56f5d3(0x1d3)];}),dbConfig[_0x390566(0x17a)](_0x390566(0x280))[_0x390566(0x1cc)](..._0x3af695)[_0x390566(0x286)](),config=_0x3af695;}function resetPassword(){const _0x39ea2b=_0x4e5dcf;tgBot&&settings['telegramChatId']&&(tgBot[_0x39ea2b(0x2b7)](_0x39ea2b(0x1c5)),tgBot['sendMessage'](settings['telegramChatId'],_0x39ea2b(0x222),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x39ea2b(0x28d),'callback_data':_0x39ea2b(0x28d)},{'text':'no','callback_data':'no'}]]}})[_0x39ea2b(0x17b)](_0x2f39d1=>{telegramError(_0x2f39d1);}),tgBot['on'](_0x39ea2b(0x1c5),async _0x1e1be0=>{const _0x38816d=_0x39ea2b,_0x22173d=_0x1e1be0[_0x38816d(0x2ba)],_0x4fd69f=_0x1e1be0['message'];tgBot[_0x38816d(0x129)](_0x1e1be0['id'])[_0x38816d(0x30a)](async()=>{const _0x1ebdf6=_0x38816d;if(_0x22173d!='no'){const _0x2c9af5=0xf,_0x325e23=_0x1ebdf6(0x2b0),_0x309f43=Array[_0x1ebdf6(0x155)](crypto[_0x1ebdf6(0x1b4)](new Uint32Array(_0x2c9af5)))[_0x1ebdf6(0x171)](_0x562971=>_0x325e23[_0x562971%_0x325e23[_0x1ebdf6(0x1de)]])[_0x1ebdf6(0x17e)](''),_0x16d1ff=bcrypt[_0x1ebdf6(0x16f)](_0x309f43,saltRounds);storeSettings({'bbPassword':_0x16d1ff}),await tgBot['sendMessage'](_0x4fd69f[_0x1ebdf6(0x248)]['id'],_0x1ebdf6(0x281)+_0x309f43,{'parse_mode':_0x1ebdf6(0x181)})[_0x1ebdf6(0x17b)](_0x2cc760=>{telegramError(_0x2cc760);});}else await tgBot[_0x1ebdf6(0x229)](_0x4fd69f[_0x1ebdf6(0x248)]['id'],'Password\x20reset\x20rejected')[_0x1ebdf6(0x17b)](_0x260bc1=>{telegramError(_0x260bc1);});}),tgBot[_0x38816d(0x2b7)]('callback_query');}));}async function confirmRestore(_0x255600,_0x56c36c){const _0x55a246=_0x4e5dcf;io['to'](_0x55a246(0x1df))[_0x55a246(0x1ce)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','success'),tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),await tgBot[_0x55a246(0x229)](settings[_0x55a246(0x224)],_0x55a246(0x1dc),{'parse_mode':_0x55a246(0x181),'reply_markup':{'inline_keyboard':[[{'text':_0x55a246(0x28d),'callback_data':_0x55a246(0x28d)},{'text':'no','callback_data':'no'}]]}})[_0x55a246(0x17b)](_0x43ddad=>{telegramError(_0x43ddad);}),tgBot['on'](_0x55a246(0x1c5),async _0x411cef=>{const _0x24ea70=_0x55a246,_0x46f4f0=_0x411cef[_0x24ea70(0x2ba)],_0x3e4f8b=_0x411cef[_0x24ea70(0x154)];tgBot[_0x24ea70(0x129)](_0x411cef['id'])['then'](async()=>{const _0x3dedec=_0x24ea70;_0x46f4f0==_0x3dedec(0x28d)?(await tgBot[_0x3dedec(0x229)](_0x3e4f8b[_0x3dedec(0x248)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x3dedec(0x181)})[_0x3dedec(0x17b)](_0x21d584=>{telegramError(_0x21d584);}),unzipFile(_0x255600,_0x56c36c)):(logger['debug'](_0x3dedec(0x165)),await tgBot[_0x3dedec(0x229)](_0x3e4f8b[_0x3dedec(0x248)]['id'],'Restore\x20process\x20aborted')[_0x3dedec(0x17b)](_0x2484e9=>{telegramError(_0x2484e9);}));}),tgBot['removeListener'](_0x24ea70(0x1c5));}));}function getServerTime(){const _0x298429=_0x4e5dcf,_0x33d80b=new Date();return _0x33d80b[_0x298429(0x21b)]()+'/'+(_0x33d80b['getMonth']()+0x1)[_0x298429(0x147)]()[_0x298429(0x124)](0x2,'0')+'/'+_0x33d80b[_0x298429(0x242)]()[_0x298429(0x147)]()[_0x298429(0x124)](0x2,'0')+'\x20'+_0x33d80b['getHours']()[_0x298429(0x147)]()[_0x298429(0x124)](0x2,'0')+':'+_0x33d80b[_0x298429(0x2c0)]()[_0x298429(0x147)]()['padStart'](0x2,'0')+':'+_0x33d80b[_0x298429(0x21c)]()[_0x298429(0x147)]()[_0x298429(0x124)](0x2,'0');}function getTimeStamp(){const _0x356668=_0x4e5dcf,_0x3076dc=shiftedTime();return _0x3076dc[_0x356668(0x21b)]()+'/'+(_0x3076dc[_0x356668(0x258)]()+0x1)['toString']()[_0x356668(0x124)](0x2,'0')+'/'+_0x3076dc['getDate']()[_0x356668(0x147)]()[_0x356668(0x124)](0x2,'0')+'\x20'+_0x3076dc[_0x356668(0x12c)]()[_0x356668(0x147)]()[_0x356668(0x124)](0x2,'0')+':'+_0x3076dc['getMinutes']()['toString']()[_0x356668(0x124)](0x2,'0')+':'+_0x3076dc[_0x356668(0x21c)]()[_0x356668(0x147)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x3b79d5=_0x4e5dcf,_0x1047aa=shiftedTime();return _0x1047aa['getFullYear']()+(_0x1047aa[_0x3b79d5(0x258)]()+0x1)[_0x3b79d5(0x147)]()[_0x3b79d5(0x124)](0x2,'0')+_0x1047aa[_0x3b79d5(0x242)]()[_0x3b79d5(0x147)]()[_0x3b79d5(0x124)](0x2,'0')+'-'+_0x1047aa['getHours']()[_0x3b79d5(0x147)]()[_0x3b79d5(0x124)](0x2,'0')+_0x1047aa['getMinutes']()[_0x3b79d5(0x147)]()[_0x3b79d5(0x124)](0x2,'0')+_0x1047aa[_0x3b79d5(0x21c)]()[_0x3b79d5(0x147)]()[_0x3b79d5(0x124)](0x2,'0');}function shiftedTime(){const _0x4c7781=_0x4e5dcf,_0x47905e=new Date();let _0x4b93a5=_0x47905e;if(settings[_0x4c7781(0x232)]&&settings[_0x4c7781(0x232)]!==0x0)_0x4b93a5=fns['add'](_0x47905e,{'hours':settings[_0x4c7781(0x232)]});return _0x4b93a5;}function startScheduler(){const _0x330656=_0x4e5dcf,_0x4b2885=new Date()[_0x330656(0x16b)](),_0x5c2ca0=shiftedTime()[_0x330656(0x12c)]();_0x5c2ca0==0x4&&backupConfigFiles();_0x5c2ca0==0x0&&rotateLogFiles();_0x4b2885%0x6==0x0&&triggerAnalytics();_0x4b2885%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function _0x3687(_0x541646,_0x40f026){const _0x55e94d=_0x36b7();return _0x3687=function(_0x4c2e75,_0x4c7cd5){_0x4c2e75=_0x4c2e75-0x124;let _0x36b7c8=_0x55e94d[_0x4c2e75];return _0x36b7c8;},_0x3687(_0x541646,_0x40f026);}async function restoreBackupFile(_0x4947f8){const _0x4cb753=_0x4e5dcf;logger['debug'](_0x4cb753(0x2bf)+_0x4947f8);const _0x55d463=getBotsWithMode();_0x55d463['length']>0x0?confirmRestore(configbackuppath,_0x4947f8):unzipFile(configbackuppath,_0x4947f8);}async function getBackupFiles(_0x117f94=null){const _0x14dac9=_0x4e5dcf;let _0x26510e=[],_0x287039=fs[_0x14dac9(0x220)](configbackuppath,{'withFileTypes':!![]});_0x287039[_0x14dac9(0x235)]((_0x3e59d7,_0x419e21)=>_0x3e59d7['name']<_0x419e21[_0x14dac9(0x1c7)]?0x1:_0x419e21['name']<_0x3e59d7[_0x14dac9(0x1c7)]?-0x1:0x0),_0x287039[_0x14dac9(0x2e8)](_0x32b4df=>{const _0x4c8d75=_0x14dac9;if(!_0x32b4df[_0x4c8d75(0x1e2)]()&&_0x32b4df[_0x4c8d75(0x1c7)][_0x4c8d75(0x1a9)](_0x4c8d75(0x1af))&&_0x32b4df[_0x4c8d75(0x1c7)][_0x4c8d75(0x28f)](_0x4c8d75(0x18c))){const _0x5ca66f=formatDate(fs['statSync'](configbackuppath+_0x32b4df['name'])[_0x4c8d75(0x1cd)]);_0x26510e[_0x4c8d75(0x1cc)]({'name':_0x32b4df[_0x4c8d75(0x1c7)],'mtime':_0x5ca66f});}});if(_0x117f94)io['to'](_0x117f94)[_0x14dac9(0x1ce)](_0x14dac9(0x24b),_0x26510e);else return _0x26510e;}async function backupConfigFiles(){const _0x24a1c4=_0x4e5dcf;await zipFiles('backup-full');const _0x39b8e8=getCleanTimeStamp();fs[_0x24a1c4(0x267)](zippath+'backup-full.zip',configbackuppath+(_0x24a1c4(0x1af)+_0x39b8e8+_0x24a1c4(0x18c)));let _0x3aabd2=fs[_0x24a1c4(0x220)](configbackuppath,{'withFileTypes':!![]});_0x3aabd2[_0x24a1c4(0x235)]((_0x42ab4b,_0xdcccb7)=>_0x42ab4b[_0x24a1c4(0x1c7)]<_0xdcccb7['name']?0x1:_0xdcccb7[_0x24a1c4(0x1c7)]<_0x42ab4b[_0x24a1c4(0x1c7)]?-0x1:0x0),_0x3aabd2[_0x24a1c4(0x1de)]>maxBackups&&fs[_0x24a1c4(0x1ae)](configbackuppath+_0x3aabd2[_0x3aabd2[_0x24a1c4(0x1de)]-0x1][_0x24a1c4(0x1c7)]);}function rotateLogFiles(){const _0x29a95f=_0x4e5dcf,_0xb9eec5=fs[_0x29a95f(0x190)](logspath+_0x29a95f(0x309)),_0x5c773e=_0xb9eec5[_0x29a95f(0x218)]/0x400;if(_0x5c773e>0x64){let _0x57dce3=fs[_0x29a95f(0x220)](logspath,{'withFileTypes':!![]});_0x57dce3[_0x29a95f(0x235)]((_0xb0a2aa,_0x203000)=>_0xb0a2aa[_0x29a95f(0x1c7)]<_0x203000['name']?0x1:_0x203000['name']<_0xb0a2aa[_0x29a95f(0x1c7)]?-0x1:0x0),_0x57dce3[_0x29a95f(0x2e8)](_0x1e1e5d=>{const _0x26c97f=_0x29a95f;if(_0x1e1e5d[_0x26c97f(0x1c7)]=='output-002.log')fs[_0x26c97f(0x267)](logspath+_0x1e1e5d[_0x26c97f(0x1c7)],logspath+'output-003.log');if(_0x1e1e5d[_0x26c97f(0x1c7)]==_0x26c97f(0x1fd))fs[_0x26c97f(0x267)](logspath+_0x1e1e5d['name'],logspath+'output-002.log');_0x1e1e5d['name']==_0x26c97f(0x309)&&(fs[_0x26c97f(0x267)](logspath+_0x1e1e5d[_0x26c97f(0x1c7)],logspath+_0x26c97f(0x1fd)),fs[_0x26c97f(0x1bb)](logspath+_0x1e1e5d['name'],''));});}}async function zipFiles(_0x175762){const _0x8f3bb8=_0x4e5dcf;let _0x2fe8af;if(_0x175762==_0x8f3bb8(0x1b2))_0x2fe8af=logspath;if(_0x175762==_0x8f3bb8(0x175))_0x2fe8af=configpath;if(_0x175762==_0x8f3bb8(0x2e1))_0x2fe8af=configpath;let _0x5d212c=fs[_0x8f3bb8(0x220)](_0x2fe8af,{'withFileTypes':!![]});const _0x468ae2=new require('node-zip')();_0x5d212c[_0x8f3bb8(0x2e8)](_0x2b09fa=>{const _0x1353ca=_0x8f3bb8;if(!_0x2b09fa['isDirectory']()){let _0x8ffaaf=fs[_0x1353ca(0x284)](_0x2fe8af+_0x2b09fa['name']);if(_0x175762==_0x1353ca(0x175)){const _0xe3f8f5=/^bot-[0-9]{3}-config.json$/,_0x16db60=_0xe3f8f5[_0x1353ca(0x25c)](_0x2b09fa[_0x1353ca(0x1c7)]);if(_0x16db60){const _0x9619=JSON[_0x1353ca(0x200)](_0x8ffaaf);if(_0x9619['bot'][0x0]){_0x9619[_0x1353ca(0x292)][0x0]['apiKey']='***',_0x9619[_0x1353ca(0x292)][0x0][_0x1353ca(0x21a)]=_0x1353ca(0x2ff);if(_0x9619[_0x1353ca(0x292)][0x0][_0x1353ca(0x164)])_0x9619[_0x1353ca(0x292)][0x0]['apiPassword']=_0x1353ca(0x2ff);}_0x8ffaaf=JSON[_0x1353ca(0x20d)](_0x9619,null,0x2);}if(_0x2b09fa['name']==_0x1353ca(0x166)){const _0x55f555=JSON[_0x1353ca(0x200)](_0x8ffaaf);if(_0x55f555[_0x1353ca(0x25f)][_0x1353ca(0x180)])_0x55f555['settings'][_0x1353ca(0x180)]=![];if(_0x55f555[_0x1353ca(0x25f)][_0x1353ca(0x2c7)])_0x55f555[_0x1353ca(0x25f)][_0x1353ca(0x2c7)]=_0x1353ca(0x2ff);if(_0x55f555[_0x1353ca(0x25f)]['telegramToken'])_0x55f555[_0x1353ca(0x25f)][_0x1353ca(0x140)]=_0x1353ca(0x2ff);if(_0x55f555['settings'][_0x1353ca(0x224)])_0x55f555['settings'][_0x1353ca(0x224)]=null;_0x8ffaaf=JSON[_0x1353ca(0x20d)](_0x55f555,null,0x2);}if(_0x2b09fa['name']!=_0x1353ca(0x182))_0x468ae2[_0x1353ca(0x14a)](_0x2b09fa['name'],_0x8ffaaf);}else _0x468ae2[_0x1353ca(0x14a)](_0x2b09fa[_0x1353ca(0x1c7)],_0x8ffaaf);}});const _0xc591f0=_0x468ae2[_0x8f3bb8(0x148)]({'base64':![],'compression':_0x8f3bb8(0x1bd)});fs[_0x8f3bb8(0x1bb)](zippath+(_0x175762+_0x8f3bb8(0x18c)),_0xc591f0,_0x8f3bb8(0x1e8));}async function unzipFile(_0x1de681,_0x28d28d){const _0x7739ca=_0x4e5dcf;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x10df4e=>{if(!_0x10df4e['isDirectory']())fs['rmSync'](configpath+_0x10df4e['name']);});const _0x1c8480=fs['readFileSync'](_0x1de681+_0x28d28d,'binary'),_0x46d7d2=new require(_0x7739ca(0x27b))(_0x1c8480,{'base64':![],'checkCRC32':!![]});Object[_0x7739ca(0x253)](_0x46d7d2[_0x7739ca(0x172)])['forEach'](_0x156b5d=>{const _0x599311=_0x7739ca,_0x4ce92f=_0x46d7d2[_0x599311(0x172)][_0x156b5d];fs[_0x599311(0x1bb)](configpath+_0x4ce92f[_0x599311(0x1c7)],_0x4ce92f['_data']);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x5e73cc=>{const _0x7353e=_0x7739ca;if(!_0x5e73cc['isDirectory']())fs['rmSync'](temppath+_0x5e73cc[_0x7353e(0x1c7)]);}),logger['debug'](_0x7739ca(0x294)),process[_0x7739ca(0x308)]({'restore':!![]},_0x3e317d=>{});}async function getPublicIp(){const _0x2a8256=_0x4e5dcf;try{const _0x125ec9=await axios[_0x2a8256(0x17a)](_0x2a8256(0x2bd));publicip=_0x125ec9[_0x2a8256(0x2ba)]['ip'];}catch(_0x4a4a3a){}}async function triggerAnalytics(){const _0x33a8bb=_0x4e5dcf;if(!publicip)await getPublicIp();const _0x5a0e60=getBotsWithMode();let _0x2e93ea=0x0;_0x5a0e60[_0x33a8bb(0x2e8)](_0x10737d=>{const _0xd042a9=_0x33a8bb;if(_0x10737d[_0xd042a9(0x2fe)]===_0xd042a9(0x1b8))_0x2e93ea++;});const _0x3312f5=getBotExchanges();mixpanel['track'](_0x33a8bb(0x1f7),{'distinct_id':settings[_0x33a8bb(0x18b)],'ip':publicip,'version':serverversion,'numbots':_0x5a0e60[_0x33a8bb(0x1de)],'numbotsenabled':_0x2e93ea,'exchanges':_0x3312f5,'environment':environment});}async function getMessages(){const _0x1920d6=_0x4e5dcf,_0x3cb65e=_0x1920d6(0x226),_0x4203b8=new GraphQLClient(_0x3cb65e),_0x202fdd={'authorization':_0x1920d6(0x21f)},_0x37d1fd=serverversion[_0x1920d6(0x23c)]('.'),_0x590c1d=_0x37d1fd[0x0]+'.'+_0x37d1fd[0x1],_0x21762c=Math[_0x1920d6(0x12b)](settings[_0x1920d6(0x136)],settings[_0x1920d6(0x22f)]),_0xe4c553={'last':parseInt(_0x21762c),'bbm':_0x590c1d},_0x5aa875=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x56dad1;try{_0x56dad1=await _0x4203b8['request'](_0x5aa875,_0xe4c553,_0x202fdd);}catch(_0x521c4e){}if(_0x56dad1&&_0x56dad1[_0x1920d6(0x2c4)]){let _0x41c165=settings['lastmsgtelegram'];newMessages=[];for(const _0x5648bc of _0x56dad1['messages']){newMessages[_0x1920d6(0x1cc)](_0x5648bc);let _0x2c308c=![];_0x5648bc[_0x1920d6(0x1c9)]&&(updateSetting(_0x1920d6(0x19e),_0x5648bc['bbvNew']),_0x2c308c=isNewerVersion(serverversion,_0x5648bc[_0x1920d6(0x1c9)])||serverversion==_0x5648bc[_0x1920d6(0x1c9)]);if(!_0x2c308c&&_0x5648bc[_0x1920d6(0x2f7)]>_0x41c165){if(_0x5648bc[_0x1920d6(0x1ef)]==='any'||serverversion['startsWith'](_0x5648bc[_0x1920d6(0x1ef)])){let _0x5b1e81=''+_0x5648bc[_0x1920d6(0x179)]+'\x0a\x0a'+_0x5648bc[_0x1920d6(0x154)];const _0x294fe9=await sendTelegramMsg(toTelegramMarkdown(_0x5b1e81),_0x1920d6(0x12e));if(_0x294fe9)_0x41c165=_0x5648bc[_0x1920d6(0x2f7)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x41c165),emitMessages();}}function emitMessages(){const _0x325a3e=_0x4e5dcf,_0x40ad27=settings['lastmsgemitted'];let _0x37efcf=[];newMessages[_0x325a3e(0x2e8)](_0x328ecd=>{const _0xcf4712=_0x325a3e;_0x328ecd[_0xcf4712(0x2f7)]>_0x40ad27&&_0x37efcf[_0xcf4712(0x1cc)](_0x328ecd);}),_0x37efcf[_0x325a3e(0x1de)]>0x0&&getAllClients()['forEach'](_0x52645e=>{const _0x5743c6=_0x325a3e;getSocket(_0x52645e['id'])[_0x5743c6(0x1ce)](_0x5743c6(0x154),_0x37efcf);});}function confirmMessage(_0x27e0ea){updateSetting('lastmsgemitted',Number(_0x27e0ea));}function isNewerVersion(_0x8c2634,_0x29cde2){const _0x28543c=_0x4e5dcf,_0x5d3fbb=_0x29cde2[_0x28543c(0x23c)]('.'),_0x47d448=_0x8c2634['split']('.');for(var _0x3c48=0x0;_0x3c48<_0x47d448[_0x28543c(0x1de)];_0x3c48++){const _0x405e1d=~~_0x47d448[_0x3c48],_0x9ecb8e=~~_0x5d3fbb[_0x3c48];if(_0x405e1d>_0x9ecb8e)return!![];if(_0x405e1d<_0x9ecb8e)return![];}return![];}function toTelegramMarkdown(_0x4907e9){const _0x4420c5=_0x4e5dcf,_0x4d1b8d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4c0aa6=/\*{2}(.+?)\*{2}/gim;return _0x4907e9=_0x4907e9[_0x4420c5(0x2ce)](_0x4d1b8d,_0x4420c5(0x275))['replace'](_0x4c0aa6,_0x4420c5(0x131)),_0x4907e9;}async function validateConfigFile(){const _0x5254f6=_0x4e5dcf,_0x4d9710=dbConfig['get'](_0x5254f6(0x280))[_0x5254f6(0x2f3)](_0x5254f6(0x306))[_0x5254f6(0x2d9)]()||[];if(_0x4d9710[_0x5254f6(0x1de)]==0x0){let _0x1ffe9d=0x0,_0x29f65a=[];const _0xf081e7=/^bot-([0-9]{3})-config.json$/,_0x681ac=fs[_0x5254f6(0x220)](configpath);_0x681ac['forEach'](_0x24c818=>{const _0x131bca=_0x5254f6,_0x2b27b3=_0xf081e7[_0x131bca(0x17f)](_0x24c818);if(_0x2b27b3){const _0x1ce124=_0x2b27b3[0x1];let _0x43f123=getBotAttributes(_0x1ce124);_0x29f65a[_0x131bca(0x1cc)]({'botID':_0x1ce124,'botname':_0x43f123['botname'],'status':'disabled','live':_0x131bca(0x289)}),_0x1ffe9d++;}}),_0x1ffe9d!=0x0&&(dbConfig[_0x5254f6(0x17a)](_0x5254f6(0x280))['assign'](_0x29f65a)[_0x5254f6(0x286)](),config=_0x29f65a,restoredConfigFile=_0x1ffe9d);}}async function restoreConfigNotify(_0x2225d6){const _0x25fa42=_0x4e5dcf;let _0x6a0ee2;if(restoredConfigFile==0x1)_0x6a0ee2=_0x25fa42(0x259);else _0x6a0ee2='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x2225d6)io['to']('botmanager')['emit'](_0x25fa42(0x20e),_0x6a0ee2);else{logger[_0x25fa42(0x145)](_0x25fa42(0x22c)),logger[_0x25fa42(0x145)](_0x6a0ee2),logger[_0x25fa42(0x145)](_0x25fa42(0x22c)),logger[_0x25fa42(0x145)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x25fa42(0x1aa)]!='orders')tgBot[_0x25fa42(0x229)](settings['telegramChatId'],_0x25fa42(0x304)+_0x6a0ee2)[_0x25fa42(0x17b)](_0x2e4177=>{telegramError(_0x2e4177);});}}function validateCredentials(_0x472966,_0x44c7e7){const _0x547cb7=_0x4e5dcf;if(_0x472966[_0x547cb7(0x13e)]==settings[_0x547cb7(0x305)]&&bcrypt['compareSync'](_0x472966[_0x547cb7(0x20a)],settings[_0x547cb7(0x2c7)])){if(settings[_0x547cb7(0x27a)])return{'allow':![],'reason':_0x547cb7(0x282),'token':null};else{const _0xc4bafa=generateLoginToken(_0x44c7e7);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xc4bafa};}}else return{'allow':![],'reason':_0x547cb7(0x2a2),'token':null};}function refreshToken(_0x1691ae){const _0x520870=generateLoginToken(_0x1691ae);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x520870};}function validateAccess(_0x77a75,_0x34e2c6,_0x1c083f){const _0x20576f=_0x4e5dcf,_0x568997=_0x1c083f?_0x1c083f:devices[_0x34e2c6]['ip'];let _0x268b36;const _0x1b91f1=_0x5f043d=>{const _0x21e8cd=_0x3687;if(settings[_0x21e8cd(0x180)]){if(settings[_0x21e8cd(0x27a)]){if(telegram2FaApproved(_0x34e2c6)){const _0x51420d=generateLoginToken(_0x34e2c6);return{'allow':!![],'reason':_0x21e8cd(0x207),'token':_0x51420d};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x268b36=validToken(_0x5f043d,_0x34e2c6),_0x268b36[_0x21e8cd(0x2e5)](_0x21e8cd(0x239))?{'allow':!![],'reason':_0x21e8cd(0x296),'token':_0x5f043d}:{'allow':![],'reason':_0x21e8cd(0x2a8),'token':null};}else return{'allow':!![],'reason':_0x21e8cd(0x2db),'token':null};};if(settings['whitelistEnabled']){let _0x221e0d=[...settings[_0x20576f(0x238)],'::1',_0x20576f(0x191),_0x20576f(0x23d)];if(_0x221e0d['includes'](_0x568997))return _0x1b91f1(_0x77a75);else{_0x268b36=validToken(_0x77a75,_0x34e2c6);if(_0x268b36['hasOwnProperty'](_0x20576f(0x239)))return _0x1b91f1(_0x77a75);else{if(telegramIpApproved(_0x34e2c6)){const _0x2571c4=generateToken(_0x34e2c6);return _0x268b36=_0x1b91f1(_0x77a75),_0x268b36[_0x20576f(0x2e3)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x2571c4}:_0x268b36;}else return settings[_0x20576f(0x288)]?{'allow':![],'reason':_0x20576f(0x2ed),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x1b91f1(_0x77a75);}function timelyDecrypt(_0x2597ad,_0x415ee5=!![]){const _0x1d27ef=_0x4e5dcf;if(_0x2597ad)try{const _0x576789=crypt[_0x1d27ef(0x1ed)](secure[_0x1d27ef(0x291)],_0x2597ad)[_0x1d27ef(0x154)],_0x4d91ee=_0x576789[_0x1d27ef(0x23c)]('@')[0x0],_0x2d36d7=_0x576789[_0x1d27ef(0x23c)]('@')[0x1],_0x444a71=new Date()[_0x1d27ef(0x194)]();if(_0x415ee5){if(_0x444a71-_0x2d36d7<maxSecretAge*0x3e8)return _0x4d91ee;else return![];}else return _0x4d91ee;}catch(_0x2c89b0){return![];}else return![];}const validToken=(_0x100571,_0x35e80d)=>{const _0x4859e6=_0x4e5dcf,_0x4eef19=devices[_0x35e80d]['ip'];if(!_0x100571)return{'error':_0x4859e6(0x2bc)};for(let _0x41f24d of blacklist){if(_0x41f24d[_0x4859e6(0x1f3)]==_0x100571)return{'error':'Token\x20blacklisted'};}let _0x5b84c9;try{_0x5b84c9=jwt[_0x4859e6(0x195)](_0x100571,secure[_0x4859e6(0x26b)]+_0x35e80d);}catch{return{'error':_0x4859e6(0x1e7)};}if(!_0x5b84c9['hasOwnProperty'](_0x4859e6(0x203))&&!_0x5b84c9[_0x4859e6(0x2e5)]('username')||!_0x5b84c9[_0x4859e6(0x2e5)](_0x4859e6(0x2ea)))return{'error':_0x4859e6(0x230)};if(!_0x5b84c9[_0x4859e6(0x2e5)]('username')&&_0x5b84c9[_0x4859e6(0x2e5)](_0x4859e6(0x203))){const {clientip:_0x5de73b}=_0x5b84c9;return _0x4eef19==_0x5de73b?{'success':_0x4859e6(0x188)}:{'error':_0x4859e6(0x187)};}else{if(_0x5b84c9[_0x4859e6(0x2e5)](_0x4859e6(0x13e))&&_0x5b84c9['hasOwnProperty'](_0x4859e6(0x203))){const {username:_0x396dab,clientip:_0x63b459}=_0x5b84c9;return settings[_0x4859e6(0x305)]==_0x396dab&&_0x4eef19==_0x63b459?{'success':_0x4859e6(0x188)}:{'error':_0x4859e6(0x127)};}}},generateLoginToken=_0x4b2430=>{const _0x2fd7b7=_0x4e5dcf;if(_0x4b2430){const _0x305594=devices[_0x4b2430]['ip'];return jwt['sign']({'username':settings[_0x2fd7b7(0x305)],'clientip':_0x305594},secure['secret']+_0x4b2430,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2503e9=>{const _0x4a5d21=_0x4e5dcf;if(_0x2503e9){const _0x34e982=devices[_0x2503e9]['ip'];return jwt[_0x4a5d21(0x1eb)]({'clientip':_0x34e982},secure['secret']+_0x2503e9,{'expiresIn':devices[_0x2503e9]['telegramIpApproval'][_0x4a5d21(0x1fe)]*0x3c});}else return![];},telegramIpApproved=_0x11ba3e=>{const _0x104916=_0x4e5dcf;let _0x4656f6=![];return devices[_0x11ba3e][_0x104916(0x2c9)]&&devices[_0x11ba3e]['telegramIpApproval'][_0x104916(0x1fe)]!=_0x104916(0x146)&&(_0x4656f6=devices[_0x11ba3e][_0x104916(0x2c9)][_0x104916(0x203)]==devices[_0x11ba3e]['ip']&&new Date()[_0x104916(0x194)]()-devices[_0x11ba3e][_0x104916(0x2c9)][_0x104916(0x19c)]<devices[_0x11ba3e][_0x104916(0x2c9)]['expiry']*0x3c*0x3e8),_0x4656f6;},telegram2FaApproved=_0x5481b1=>{const _0x6589fa=_0x4e5dcf;let _0x2c6f42=![];return devices[_0x5481b1][_0x6589fa(0x243)]&&devices[_0x5481b1][_0x6589fa(0x243)][_0x6589fa(0x1fe)]!=_0x6589fa(0x146)&&(_0x2c6f42=devices[_0x5481b1][_0x6589fa(0x243)]['clientip']==devices[_0x5481b1]['ip']&&new Date()['getTime']()-devices[_0x5481b1][_0x6589fa(0x243)][_0x6589fa(0x19c)]<devices[_0x5481b1][_0x6589fa(0x243)][_0x6589fa(0x1fe)]*0x3c*0x3e8),_0x2c6f42;},normalizeIP=_0x3424f1=>{const _0xa1f90d=_0x4e5dcf;let _0x305fa0=null,_0x5895b5=null;if(ipaddr[_0xa1f90d(0x22a)](_0x3424f1)){const _0x1bfdbe=ipaddr[_0xa1f90d(0x200)](_0x3424f1);_0x1bfdbe[_0xa1f90d(0x141)]()===_0xa1f90d(0x1e0)?(_0x1bfdbe['isIPv4MappedAddress']()&&(_0x305fa0=_0x1bfdbe['toIPv4Address']()[_0xa1f90d(0x147)]()),_0x5895b5=_0x1bfdbe['toString']()):(_0x305fa0=_0x1bfdbe[_0xa1f90d(0x147)](),_0x5895b5=_0x1bfdbe[_0xa1f90d(0x1db)]()[_0xa1f90d(0x147)]());}return{'show':_0x305fa0?_0x305fa0:_0x5895b5,'store':_0x5895b5};};function formatDate(_0x488647){const _0x1863c7=_0x4e5dcf;return _0x488647['getFullYear']()+'/'+(_0x488647['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x488647['getDate']()[_0x1863c7(0x147)]()[_0x1863c7(0x124)](0x2,'0')+'\x20'+_0x488647[_0x1863c7(0x12c)]()[_0x1863c7(0x147)]()[_0x1863c7(0x124)](0x2,'0')+':'+_0x488647[_0x1863c7(0x2c0)]()['toString']()[_0x1863c7(0x124)](0x2,'0')+':'+_0x488647[_0x1863c7(0x21c)]()[_0x1863c7(0x147)]()[_0x1863c7(0x124)](0x2,'0');}function sleep(_0x4a5c2a){return new Promise(_0x592503=>setTimeout(_0x592503,_0x4a5c2a));}