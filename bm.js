const _0x5347cb=_0xf239;(function(_0xfb386c,_0x82375c){const _0x173d7d=_0xf239,_0x3573ff=_0xfb386c();while(!![]){try{const _0x393e7c=-parseInt(_0x173d7d(0xee))/0x1+parseInt(_0x173d7d(0x277))/0x2+parseInt(_0x173d7d(0x21a))/0x3*(parseInt(_0x173d7d(0x2e9))/0x4)+-parseInt(_0x173d7d(0x1c8))/0x5*(-parseInt(_0x173d7d(0x158))/0x6)+-parseInt(_0x173d7d(0x24d))/0x7+parseInt(_0x173d7d(0x28e))/0x8+-parseInt(_0x173d7d(0x1d8))/0x9;if(_0x393e7c===_0x82375c)break;else _0x3573ff['push'](_0x3573ff['shift']());}catch(_0x4b46e9){_0x3573ff['push'](_0x3573ff['shift']());}}}(_0x5eab,0x1d34f));const _0x2394a3=function(){let _0x5e34d0=!![];return function(_0x32d8bb,_0x208a92){const _0x1c5e2d=_0x5e34d0?function(){const _0x2e23cf=_0xf239;if(_0x208a92){const _0x1a77a8=_0x208a92[_0x2e23cf(0x278)](_0x32d8bb,arguments);return _0x208a92=null,_0x1a77a8;}}:function(){};return _0x5e34d0=![],_0x1c5e2d;};}(),_0x4e53d4=_0x2394a3(this,function(){const _0x52c70c=_0xf239;return _0x4e53d4[_0x52c70c(0x1ff)]()['search']('(((.+)+)+)+$')[_0x52c70c(0x1ff)]()[_0x52c70c(0x18b)](_0x4e53d4)[_0x52c70c(0x207)](_0x52c70c(0x2e7));});_0x4e53d4();'use strict';process['env'][_0x5347cb(0x1a2)]=0x1;const childProcess=require(_0x5347cb(0x1c2)),fs=require('fs'),fns=require(_0x5347cb(0x1f4)),low=require(_0x5347cb(0x1e0)),FileSync=require(_0x5347cb(0x293)),path=require(_0x5347cb(0x232)),crypto=require(_0x5347cb(0x1a7)),forge=require('node-forge'),bcrypt=require(_0x5347cb(0x221)),jwt=require('jsonwebtoken'),ipaddr=require(_0x5347cb(0x121)),argv=require(_0x5347cb(0x27c))(process[_0x5347cb(0x16b)][_0x5347cb(0x2e0)](0x2))[_0x5347cb(0x16b)],uuidRandom=require(_0x5347cb(0x13c)),{Telegraf,Markup}=require(_0x5347cb(0x2c3)),Mixpanel=require('mixpanel'),axios=require(_0x5347cb(0x255)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x5347cb(0x102)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x5347cb(0x26c)](PORT)&&(console[_0x5347cb(0xf3)](_0x5347cb(0x1a0)+PORT+_0x5347cb(0xe6)),process[_0x5347cb(0x2c1)](0x1));const HOST=argv['host']||null,userID=argv[_0x5347cb(0x236)]||'',debugging=argv['d']||![],nodeversion=process[_0x5347cb(0x2f6)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x5347cb(0x126),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x5347cb(0x1ec))[_0x5347cb(0x208)]||_0x5347cb(0x2d8),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5347cb(0x15c)),configpath=userID?bbpath+_0x5347cb(0x147)+userID+'/':bbpath+_0x5347cb(0x147),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x5347cb(0x148),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x5347cb(0x1ae),loggerfile=fs[_0x5347cb(0x160)](logspath+_0x5347cb(0x180),{'flags':'a'}),temppath=userID?bbpath+_0x5347cb(0x1c3)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x5347cb(0x2f0)](configpath);!fs[_0x5347cb(0x1cb)](configbackuppath)&&fs[_0x5347cb(0x2f0)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x5347cb(0x2f0)](logspath);!fs[_0x5347cb(0x1cb)](zippath)&&fs[_0x5347cb(0x2f0)](zippath);!fs['existsSync'](temppath)&&fs[_0x5347cb(0x2f0)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5347cb(0xf2)]({'bots':[]})[_0x5347cb(0x2d7)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5347cb(0x1cc),'onepagemode':![],'marketcapApi':''}})[_0x5347cb(0x2d7)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5347cb(0xf2)]({'secure':{},'blacklist':[]})[_0x5347cb(0x2d7)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x5347cb(0x20b)](_0x5347cb(0x133),{'host':_0x5347cb(0x294)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x5347cb(0x198)]&&(settings[_0x5347cb(0x198)]!=''&&settings[_0x5347cb(0x198)]!='***')&&settings[_0x5347cb(0x1b2)]&&settings[_0x5347cb(0x1b2)]!='')initTelegram();const parseColor=(_0x5f2642,_0x3b852f)=>{const _0x19c380=_0x5347cb,_0xcfc69c=/#[A-Z]{3}#/g;if(typeof _0x5f2642=='string'){!_0x3b852f?_0x5f2642=_0x5f2642[_0x19c380(0x2d1)](_0xcfc69c,''):(_0x5f2642=_0x5f2642['replace'](/#BLU#/g,_0x19c380(0x122)),_0x5f2642=_0x5f2642[_0x19c380(0x2d1)](/#RED#/g,_0x19c380(0x14d)),_0x5f2642=_0x5f2642['replace'](/#YEL#/g,_0x19c380(0x2c9)),_0x5f2642=_0x5f2642[_0x19c380(0x2d1)](/#MAG#/g,_0x19c380(0x2e3)),_0x5f2642=_0x5f2642[_0x19c380(0x2d1)](/#CYA#/g,_0x19c380(0x20e)),_0x5f2642=_0x5f2642[_0x19c380(0x2d1)](/#RES#/g,_0x19c380(0x170)));;}return _0x5f2642;},logger={'screen':_0x4543f5=>{const _0x12dfdf=_0x5347cb;console[_0x12dfdf(0xf3)](parseColor(_0x4543f5,!![]));},'simple':_0x5dcbad=>{const _0x1f18f1=_0x5347cb;console['log'](parseColor(_0x5dcbad,!![])),loggerfile['write'](util[_0x1f18f1(0x11d)](parseColor(_0x5dcbad,![]))+'\x0a');},'full':async _0x2a6a79=>{const _0x3e6208=_0x5347cb,_0x40b8b8=getTimeStamp()+_0x3e6208(0x27d)+_0x2a6a79;console[_0x3e6208(0xf3)](parseColor(_0x40b8b8,!![])),loggerfile[_0x3e6208(0x2d7)](util[_0x3e6208(0x11d)](parseColor(_0x40b8b8,![]))+'\x0a');if(tgBot&&settings[_0x3e6208(0x27a)]&&settings['telegramEvents']!=_0x3e6208(0x19d))await sendTelegram(settings[_0x3e6208(0x27a)],_0x3e6208(0x229)+parseColor(_0x2a6a79,![]));},'debug':async(_0x434ff8,_0x5bdadd='')=>{const _0x3b328e=_0x5347cb,_0x197a52=getTimeStamp()+_0x3b328e(0xe7)+_0x434ff8;if(debugging)console[_0x3b328e(0xf3)](parseColor(_0x197a52,!![]));loggerfile[_0x3b328e(0x2d7)](util['format'](parseColor(_0x197a52,![]))+'\x0a');if(_0x5bdadd){if(debugging)console['log'](_0x5bdadd);loggerfile[_0x3b328e(0x2d7)](util[_0x3b328e(0x11d)](_0x5bdadd)+'\x0a');}}};let terminating=![];process['on'](_0x5347cb(0x203),function(_0x4f4081){const _0x162d40=_0x5347cb;_0x4f4081[_0x162d40(0x1ff)]()[_0x162d40(0x1ce)](_0x162d40(0x1aa))?(logger[_0x162d40(0x139)](_0x162d40(0xed)+_0x4f4081[_0x162d40(0x102)]+_0x162d40(0x19a)),process[_0x162d40(0x10f)]({'terminate':!![]},_0x4668c5=>{})):logger[_0x162d40(0x139)](_0x4f4081);}),process['on'](_0x5347cb(0x2c1),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x5347cb(0x152),()=>{const _0x490d25=_0x5347cb;stopAllBots(),process[_0x490d25(0x2c1)](0x0);}),process['on'](_0x5347cb(0x21e),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5347cb(0x1ec))[_0x5347cb(0x1b6)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x5347cb(0x190))['createServer'](app);app[_0x5347cb(0x145)](fileUpload({'useTempFiles':!![]})),app['get'](_0x5347cb(0x2f3),async(_0x5507dd,_0x40f8e0)=>{const _0x589607=_0x5347cb,_0x5a2b6f=_0x5507dd[_0x589607(0x217)][_0x589607(0x246)],_0x4b9ece=getClientsWithBotID(_0x589607(0x183)),_0x132643=_0x5507dd[_0x589607(0x286)][_0x589607(0x1a1)],_0x4568b7=timelyDecrypt(_0x132643,![]),_0x418ae2=_0x4b9ece[_0x589607(0xef)](_0xe797d2=>_0xe797d2['uuid']==_0x4568b7);if(_0x418ae2){const _0x2908bf=normalizeIP(_0x5507dd[_0x589607(0x186)][_0x589607(0x18f)])[_0x589607(0x2da)],_0x498131=_0x5507dd['headers']['tkn'];if(validateAccess(_0x498131,_0x4568b7,_0x2908bf)['allow'])_0x5a2b6f==_0x589607(0x263)&&await backupConfigFiles(),await zipFiles(_0x5a2b6f),_0x40f8e0['download'](zippath+(_0x5a2b6f+_0x589607(0x1bf)),_0x35bf1a=>{const _0x52ef48=_0x589607;_0x35bf1a&&(logger[_0x52ef48(0x101)](_0x52ef48(0x24c)+_0x5a2b6f),logger[_0x52ef48(0x139)](_0x35bf1a));});else logger[_0x589607(0x101)](_0x589607(0x227)+_0x5a2b6f+_0x589607(0x14b));}else logger[_0x589607(0x101)](_0x589607(0x227)+_0x5a2b6f+_0x589607(0x295));}),app['post'](_0x5347cb(0x2f7),async(_0x59908c,_0x32a9c2)=>{const _0x1c1c46=_0x5347cb,_0x121465=getClientsWithBotID('botmanager'),_0x1ec772=_0x59908c[_0x1c1c46(0x286)][_0x1c1c46(0x1a1)],_0x271343=timelyDecrypt(_0x1ec772,![]),_0x1c761c=_0x121465[_0x1c1c46(0xef)](_0x45e402=>_0x45e402[_0x1c1c46(0x1a1)]==_0x271343);logger['debug'](_0x1c1c46(0x1bc));if(_0x1c761c){const _0x30224c=normalizeIP(_0x59908c[_0x1c1c46(0x186)]['remoteAddress'])[_0x1c1c46(0x2da)],_0x2de82e=_0x59908c[_0x1c1c46(0x286)][_0x1c1c46(0x296)];if(validateAccess(_0x2de82e,_0x271343,_0x30224c)[_0x1c1c46(0x155)]){if(_0x59908c[_0x1c1c46(0x285)]){const _0x150d3d=_0x59908c[_0x1c1c46(0x285)][_0x1c1c46(0x20d)];await _0x150d3d['mv'](temppath+_0x150d3d[_0x1c1c46(0x245)]),_0x32a9c2['send']({'status':!![],'message':_0x1c1c46(0x1d5)});const _0x308220=getBotsWithMode();_0x308220[_0x1c1c46(0x1d0)]>0x0?confirmRestore(temppath,_0x150d3d[_0x1c1c46(0x245)]):unzipFile(temppath,_0x150d3d[_0x1c1c46(0x245)]);}}else logger[_0x1c1c46(0x101)](_0x1c1c46(0x191));}else logger['full'](_0x1c1c46(0x264));}),app[_0x5347cb(0x145)](express[_0x5347cb(0x185)](path['join'](__dirname,bbpath2,'build2'))),app['use'](express[_0x5347cb(0x185)](path['join'](__dirname,bbpath2,_0x5347cb(0x20a)))),app['get']('/',function(_0x1ba5ca,_0x17d3c7){const _0x30570b=_0x5347cb;_0x17d3c7[_0x30570b(0x2ad)](path['join'](__dirname,bbpath2,_0x30570b(0x288),'index.html'));}),app[_0x5347cb(0x23c)]('/:bot',function(_0x52b641,_0x1fda0d){const _0xfeea32=_0x5347cb;_0x1fda0d[_0xfeea32(0x2ad)](path[_0xfeea32(0x241)](__dirname,bbpath2,_0xfeea32(0x20a),'index.html'));}),app[_0x5347cb(0x23c)](_0x5347cb(0x2b4),(_0x1f08d9,_0x26a963)=>{const _0x51d073=_0x5347cb;_0x26a963[_0x51d073(0x2ad)](path[_0x51d073(0x241)](__dirname,bbpath2,'build',_0x51d073(0x219)));}),app[_0x5347cb(0x23c)]('/:bot/performance',(_0x50c8d9,_0x8ceb98)=>{const _0x220753=_0x5347cb;_0x8ceb98[_0x220753(0x2ad)](path['join'](__dirname,bbpath2,'build',_0x220753(0x219)));}),app[_0x5347cb(0x23c)](_0x5347cb(0x150),(_0x236a79,_0x56ed38)=>{const _0x93884b=_0x5347cb;_0x56ed38[_0x93884b(0x2ad)](path[_0x93884b(0x241)](__dirname,bbpath2,_0x93884b(0x20a),_0x93884b(0x219)));}),app[_0x5347cb(0x23c)](_0x5347cb(0x262),(_0x1f1e6d,_0x11c68a)=>{const _0x4905ef=_0x5347cb;_0x11c68a[_0x4905ef(0x2ad)](path['join'](__dirname,bbpath2,'build',_0x4905ef(0x219)));}),app[_0x5347cb(0x23c)](_0x5347cb(0xe9),(_0x32c093,_0x442dad)=>{const _0x18a621=_0x5347cb;_0x442dad[_0x18a621(0x2ad)](path['join'](__dirname,bbpath2,_0x18a621(0x20a),_0x18a621(0x219)));}),app[_0x5347cb(0x23c)]('/:bot/support',(_0x13cf17,_0x2c0fcb)=>{const _0xa59e6=_0x5347cb;_0x2c0fcb[_0xa59e6(0x2ad)](path[_0xa59e6(0x241)](__dirname,bbpath2,_0xa59e6(0x20a),_0xa59e6(0x219)));});if(HOST)http[_0x5347cb(0x26e)](PORT,HOST);else http[_0x5347cb(0x26e)](PORT);const io=require(_0x5347cb(0x2a5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x54a201=_0x5347cb;let _0x2b3843=_0x54a201(0x25b);const _0x30c050=networkInterfaces(),_0x2459fd={};for(const _0x5823bb of Object[_0x54a201(0x1f8)](_0x30c050)){for(const _0x32f930 of _0x30c050[_0x5823bb]){if((_0x32f930[_0x54a201(0x14c)]==_0x54a201(0x15b)||_0x32f930[_0x54a201(0x14c)]==0x4)&&!_0x32f930[_0x54a201(0x22f)]){const _0x4d76d1=ipaddr[_0x54a201(0x275)](_0x32f930[_0x54a201(0x2cd)])[_0x54a201(0x175)]();_0x4d76d1!='private'&&(!_0x2459fd[_0x5823bb]&&(_0x2459fd[_0x5823bb]=[]),_0x2459fd[_0x5823bb][_0x54a201(0x128)](_0x32f930['address']),_0x2b3843=_0x32f930[_0x54a201(0x2cd)]);}}}return{'serverip':_0x2b3843,'netinterfaces':_0x2459fd};}async function startServer(){const _0x52c2bb=_0x5347cb,{serverip:_0x13e0c1,netinterfaces:_0x12594f}=getServerIP();logger[_0x52c2bb(0x139)](''),logger[_0x52c2bb(0x139)](_0x52c2bb(0x261)),await logger[_0x52c2bb(0x101)](_0x52c2bb(0x17d)+serverversion+_0x52c2bb(0x2c4)+(environment==_0x52c2bb(0x2c2)?_0x52c2bb(0xec):'')+'\x0a'+(_0x52c2bb(0x1e3)+PORT+_0x52c2bb(0x2e4))+(_0x52c2bb(0x250)+_0x13e0c1+':'+PORT+_0x52c2bb(0x188))),logger[_0x52c2bb(0x139)](_0x52c2bb(0x261));if(config[_0x52c2bb(0x1d0)]!=0x0)for(const _0x571c62 of config){const _0x1d7c98=_0x571c62[_0x52c2bb(0x292)]=='auto'?'a':'m';if(_0x571c62[_0x52c2bb(0x2eb)]==_0x52c2bb(0x1b9)||_0x571c62[_0x52c2bb(0x2eb)]==_0x52c2bb(0x29e))await logger[_0x52c2bb(0x101)](_0x52c2bb(0x173)+_0x1d7c98+_0x52c2bb(0x1db)+_0x571c62[_0x52c2bb(0x1e9)]+_0x52c2bb(0x238)+_0x571c62[_0x52c2bb(0x1b0)]),startBot([_0x571c62[_0x52c2bb(0x1e9)],userID],{'cwd':bbpath},function(_0x40ffc7){if(_0x40ffc7)logger['full'](_0x40ffc7);});else(_0x571c62[_0x52c2bb(0x2eb)]==_0x52c2bb(0x2b1)||_0x571c62[_0x52c2bb(0x2eb)]==_0x52c2bb(0x225))&&await logger[_0x52c2bb(0x101)](_0x52c2bb(0x1fc)+_0x1d7c98+_0x52c2bb(0x26b)+_0x571c62[_0x52c2bb(0x1e9)]+_0x52c2bb(0x238)+_0x571c62[_0x52c2bb(0x1b0)]);}else!newBot&&logger[_0x52c2bb(0x139)](_0x52c2bb(0x156));if(newBot)addBot();logger[_0x52c2bb(0x139)](_0x52c2bb(0x261)),logger[_0x52c2bb(0x139)](''),await logger[_0x52c2bb(0x157)]('Node.js\x20v'+nodeversion),await logger[_0x52c2bb(0x157)](_0x52c2bb(0x251),_0x12594f);}function startSocket(){const _0xf2b1f2=_0x5347cb;io['on'](_0xf2b1f2(0x22e),_0x4ac2a2=>{const _0x118507=_0xf2b1f2;let _0x3a5f53,_0x37c4f9,_0x281c9b,_0x1f0a25,_0x3db184;const _0xa404e5=_0x4ac2a2[_0x118507(0x187)][_0x118507(0x286)][_0x118507(0x247)];_0x37c4f9=_0xa404e5[_0x118507(0x19b)](/bot[0-9]{3}/);if(_0x37c4f9)_0x281c9b=_0x37c4f9[0x0][_0x118507(0x19b)](/[0-9]{3}/);if(_0x281c9b)_0x3a5f53=_0x281c9b[0x0];else _0x3a5f53=_0x118507(0x183);const _0x52a2b1=_0x4ac2a2[_0x118507(0x187)][_0x118507(0x24a)][_0x118507(0x164)];if(!_0x52a2b1)_0x4ac2a2[_0x118507(0x178)](_0x118507(0x2eb),{'publicKey':secure[_0x118507(0x174)]});else{_0x1f0a25=timelyDecrypt(_0x52a2b1,![]);if(!_0x1f0a25)_0x4ac2a2[_0x118507(0x178)](_0x118507(0x2eb),{'publicKey':secure['publicKey']});else{_0x3db184=normalizeIP(_0x4ac2a2[_0x118507(0x2f8)][_0x118507(0x18f)])[_0x118507(0x2da)];if(!devices[_0x1f0a25])devices[_0x1f0a25]={'uuid':_0x1f0a25,'access':{'token':null}};devices[_0x1f0a25]['ip']=_0x3db184;const _0x408a40=addClient(_0x4ac2a2['id'],_0x1f0a25,_0x3a5f53);setAccess(_0x408a40),emitMessages(),_0x4ac2a2['on'](_0x118507(0x1bd),_0x2a85ac=>{const _0x55e67f=_0x118507,_0x4d0e76=timelyDecrypt(_0x2a85ac[_0x55e67f(0x12d)],!![],'|@|');if(_0x4d0e76){_0x2a85ac={'username':_0x2a85ac[_0x55e67f(0x254)],'password':_0x4d0e76},devices[_0x1f0a25][_0x55e67f(0x1d1)]=validateCredentials(_0x2a85ac,_0x1f0a25);if(devices[_0x1f0a25][_0x55e67f(0x1d1)][_0x55e67f(0x155)]==![]&&devices[_0x1f0a25][_0x55e67f(0x1d1)][_0x55e67f(0x21f)]==_0x55e67f(0x280))_0x4ac2a2[_0x55e67f(0x178)](_0x55e67f(0x2eb),{'access':devices[_0x1f0a25][_0x55e67f(0x1d1)]}),loginAccess2FA(_0x1f0a25,_0x3db184);else{if(devices[_0x1f0a25][_0x55e67f(0x1d1)][_0x55e67f(0x155)]==![]&&devices[_0x1f0a25][_0x55e67f(0x1d1)]['reason']==_0x55e67f(0x239))_0x4ac2a2['emit'](_0x55e67f(0x2eb),{'access':devices[_0x1f0a25][_0x55e67f(0x1d1)]});else devices[_0x1f0a25][_0x55e67f(0x1d1)][_0x55e67f(0x155)]&&devices[_0x1f0a25][_0x55e67f(0x1d1)][_0x55e67f(0x21f)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1f0a25)[_0x55e67f(0x1fe)](_0x261b47=>{setAccess(_0x261b47);}),logger[_0x55e67f(0x157)](_0x55e67f(0x2b8)+_0x1f0a25['slice'](-0x8)),setTokenRefresh(_0x1f0a25),setSessionTimeout(_0x55e67f(0x1bd),_0x1f0a25));}}else logger['full'](_0x55e67f(0x1f2));}),_0x4ac2a2['on'](_0x118507(0x117),()=>{resetPassword();}),_0x4ac2a2['on'](_0x118507(0x268),_0x315e04=>{removeClient(_0x4ac2a2['id']);}),_0x3a5f53=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x21c448){const _0x137308=_0x5347cb;if(_0x21c448!='botmanager'&&config[_0x137308(0x270)]!=''){if(pid[_0x21c448])pid[_0x21c448][_0x137308(0x10f)]({'function':_0x137308(0x21c),'args':null});}_0x21c448!=_0x137308(0x183)&&broadcastToBots('bots',JSON[_0x137308(0x2d5)](config));}function reloadBotManager(){const _0x106c35=_0x5347cb;getClientsWithBotID('botmanager')[_0x106c35(0x1fe)](_0x554fe6=>{const _0x460456=_0x106c35;getSocket(_0x554fe6['id'])['emit'](_0x460456(0x2eb),{'access':{'allow':![],'reason':_0x460456(0x2a8),'token':null}});});}function getSocket(_0x33b5d8){const _0x500810=_0x5347cb,_0x29a0b4=io[_0x500810(0x12e)]['get']('/');return _0x29a0b4[_0x500810(0x233)][_0x500810(0x23c)](_0x33b5d8);}function setAccess(_0x2358f2){const _0x265e88=_0x5347cb,_0x659e3b=getSocket(_0x2358f2['id']),_0x588937=_0x2358f2['uuid'],_0xd0e0e2=_0x2358f2['bot'];devices[_0x588937][_0x265e88(0x1d1)]=validateAccess(devices[_0x588937][_0x265e88(0x1d1)]['token'],_0x588937),logger[_0x265e88(0x157)](_0x265e88(0x1c6)+devices[_0x588937][_0x265e88(0x1d1)][_0x265e88(0x21f)]+'\x20|\x20client:\x20...'+_0x2358f2['id'][_0x265e88(0x2e0)](-0x8)+_0x265e88(0x193)+_0x588937[_0x265e88(0x2e0)](-0x8)),_0x659e3b[_0x265e88(0x241)](_0x588937);if(devices[_0x588937]['access']['allow']){_0x659e3b['join'](_0xd0e0e2);if(_0xd0e0e2==_0x265e88(0x183))initializeSocketBotManager(_0x659e3b);else initializeSocketBot(_0x659e3b);initClient(_0xd0e0e2);}devices[_0x588937][_0x265e88(0x1d1)][_0x265e88(0x1de)]&&devices[_0x588937][_0x265e88(0x1d1)][_0x265e88(0x21f)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x265e88(0x1f6),_0x588937),devices[_0x588937][_0x265e88(0x1d1)][_0x265e88(0x1de)]&&devices[_0x588937][_0x265e88(0x1d1)]['reason']==_0x265e88(0x197)&&setSessionTimeout('login',_0x588937),_0x659e3b[_0x265e88(0x178)](_0x265e88(0x2eb),{'status':_0x2358f2[_0x265e88(0x17b)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x588937][_0x265e88(0x1d1)],'externalip':devices[_0x588937]['ip'],'publicKey':secure[_0x265e88(0x174)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x588937]['access'][_0x265e88(0x155)]==![]&&devices[_0x588937][_0x265e88(0x1d1)][_0x265e88(0x21f)]==_0x265e88(0x169)&&temporaryAccess2FA(_0x588937,devices[_0x588937]['ip']);}function setSessionTimeout(_0x5b14f6,_0x382c53){const _0x15b978=_0x5347cb;let _0x1116d9;if(_0x5b14f6==_0x15b978(0x1bd))_0x1116d9=loginExpiry*0x3c*0x3e8;else _0x1116d9=devices[_0x382c53][_0x15b978(0x118)][_0x15b978(0x1f3)]*0x3c*0x3e8-(new Date()[_0x15b978(0x1f0)]()-devices[_0x382c53][_0x15b978(0x118)][_0x15b978(0x189)]);if(devices[_0x382c53][_0x15b978(0x177)])clearTimeout(devices[_0x382c53][_0x15b978(0x177)]);devices[_0x382c53]['pidExpireLogin']=setTimeout(()=>{const _0x772b0c=_0x15b978;if(devices[_0x382c53]['pidRefreshToken'])clearTimeout(devices[_0x382c53][_0x772b0c(0x151)]);removeSocketListeners(_0x382c53),addBlacklist(_0x382c53),devices[_0x382c53]['telegramIpApproval']=null,devices[_0x382c53][_0x772b0c(0x1f7)]=null,devices[_0x382c53]['access']['token']=null,logger[_0x772b0c(0x157)]('Session\x20expired\x20for\x20user\x20...'+_0x382c53[_0x772b0c(0x2e0)](-0x8)),devices[_0x382c53][_0x772b0c(0x1d1)]=validateAccess(devices[_0x382c53][_0x772b0c(0x1d1)][_0x772b0c(0x1de)],_0x382c53),!(devices[_0x382c53][_0x772b0c(0x1d1)][_0x772b0c(0x155)]&&devices[_0x382c53][_0x772b0c(0x1d1)][_0x772b0c(0x21f)]=='login\x20not\x20required')&&(_0x5b14f6==_0x772b0c(0x1bd)?io['to'](_0x382c53)[_0x772b0c(0x178)](_0x772b0c(0x2eb),{'access':{'allow':![],'reason':_0x772b0c(0x13d),'token':null}}):io['to'](_0x382c53)['emit']('status',{'access':{'allow':![],'reason':_0x772b0c(0x165),'token':null}})),devices[_0x382c53][_0x772b0c(0x1d1)]['token']=null;},_0x1116d9);}function _0x5eab(){const _0x51aed9=['botname','decode64','telegramUsername','chat','util','stop','version','callback','filter','enabled','secure','getMonth','Backup\x20file\x20uploaded','login','started','.zip','unlinkSync','No\x20authentication\x20token','child_process','temp/','show','manual','Setting\x20access:\x20','-events.json','5wuimMI','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','kill','existsSync','0.0.0','binary','includes','\x20files\x20over\x20Telegram:','length','access','toggle_','update-bb','/metrics\x20-\x20show\x20bot\x20performance\x0a','File\x20uploaded','output-001.log','Unauthorized\x20attempt\x20to\x20get\x20messages','636903OuOQHL','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','temporary\x20access\x20rejected',')\x20|\x20Bot\x20','restore_yes_','add-bot','token','toggleBotMode','lowdb','Password\x20reset\x20rejected','store-headless','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Temporary\x20access\x20rejected','auto','hashSync','telegramEvents','botID','backup-full@','\x20-\x20','version.json','compareSync','delete-alerts','2FA\x20login\x20rejected','getTime','Restore\x20process\x20confirmed','Unauthorized\x20login\x20attempt\x20(timeout)','expiry','date-fns','reset-history','2FA','telegram2FaApproval','keys','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','bot-','Invalid\x20username\x20or\x20IP\x20address','Idling\x20(','sign','forEach','toString','isValid','logged\x20out','replyWithDocument','uncaughtException','*$1*','Invalid\x20IP\x20address','login2fa_','search','environment','show-config','build','init','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','backupfile','\x1b[36m','/help\x20-\x20show\x20available\x20commands\x0a','latestversion','sendPortfolioTelegram','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','$1_$2_$3','close','live','/disable\x20-\x20disable\x20notifications\x0a','params','Invalid\x20authentication\x20token\x20(2)','index.html','8583YAYNIw','Your\x20installation\x20is\x20already\x20up\x20to\x20date','initclient','/names\x20-\x20show\x20bot\x20names\x0a','SIGINT','reason','getMinutes','bcryptjs','tempaccess_5_','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','CoinMarketCap\x20API\x20key\x20validated','new-disabled','stopped','Unauthorized\x20attempt\x20to\x20download\x20','No\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20','get-portfolio','config_all','updatebotmanager','\x20only\x0a','connection','internal','generateKeyPair','127.0.0.1','path','sockets','inlineKeyboard','update_no','user','getUTCHours','\x20|\x20','invalid\x20credentials','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','get','login\x20token\x20valid','getFullYear','::ffff:127.0.0.1','/restart\x20-\x20restart\x20bot(s)\x0a','join','/start','action','get-starting-balances','name','type','referer','track','config','auth','Unauthorized\x20attempt\x20to\x20add\x20bot','Failed\x20to\x20download\x20','805182hZwSVA','button','loginRequired','=>\x20Go\x20to\x20#CYA#http://','Network\x20Interfaces:','toggle-bot-mode','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','username','axios','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','update','isIPv4MappedAddress','Bot\x20','RSA-OAEP','[ip-address]','startsWith','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','cancel-loading','Orders','-----------------------------------------------------------------------------------','/:bot/history','backup','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','HTML','onepagemode','lastmsgtelegram','disconnect','resetHistory','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',')\x20\x20\x20|\x20Bot\x20','test','fork','listen','Error\x20details:','apiKey','https://api.ipify.org?format=json','publicKeyToPem','Token\x20blacklisted','|@|','parse','config_orders','469456cBsILq','apply','messages','telegramChatId','lastmsgemitted','yargs/yargs',':\x20Bot\x20Mgr\x20>\x20','all','<b>Balance\x20Bot\x20Status:</b>\x0a','2FA\x20login\x20required','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','storeFiat','storeHeadless','rmSync','files','headers','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','build2','error','<b>Telegram\x20Bot\x20Status:</b>\x0a','enable','update-bot','mtime','555880QPzPjg','Unauthorized\x20attempt\x20to\x20show\x20configuration','catch','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','mode','lowdb/adapters/FileSync','api-eu.mixpanel.com','\x20(2)','tkn','start','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20confirm\x20message','settings.','sort','message','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','new','writeFileSync','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','All\x20bots','store-configuration','socket.io','code','Notifications\x20enabled','reload','telegramEnabled','ipc','restart_','getSeconds','sendFile','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','DEFLATE','disabled','remove','secret','/:bot/portfolio','f2aRequired','resetpw_yes','update_yes','Logged\x20in\x20user\x20...','temporary\x20access\x20not\x20allowed','endsWith','tempaccess_30_','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','success','once','privateKey','backup-full','exit','staging','telegraf','#RES#\x20','apiPassword','help','add','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','\x1b[33m','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Error\x20while\x20deleting\x20config\x20files:\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','address','isDirectory','pki','names','replace','temporaryAccessAllowed','delete-bot','editMessageReplyMarkup','stringify','off_','write','production','BCT','store','restart','disable','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','bb-settings.json','output-003.log','slice','rsa','randomFillSync','\x1b[35m','#RES#\x20if\x20running\x20locally\x0a','Unauthorized\x20attempt\x20to\x20get\x20events','confirm-message','(((.+)+)+)+$','statSync','152wLMTbd','/off\x20-\x20stop\x20bot(s)\x0a','status','order','args','-config.json','data','mkdirSync','placeOrder','emitHistory','/download/:type','Access\x20enabled\x20for\x20','Telegraf\x20error:','versions','/upload-backup','conn','get-logs',',\x20must\x20be\x20a\x204\x20digit\x20number',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','notification','/:bot/configuration','padStart','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','(staging)','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','127405duWyEC','find','Markdown','bbvReceive','defaults','log','bbvNew','then','15\x20min','split','store-settings','cloneDeep','command','inherit','reinstall','async','You\x20can\x20use\x20the\x20following\x20commands:\x0a','getDate','\x20to\x20','full','port','decrypt','assign','Alerts','blacklist','reinstall_yes','Unauthorized\x20attempt\x20to\x20get\x20portfolio','logs','value','Unauthorized\x20attempt\x20to\x20update\x20settings','deleteHistoryAlerts','entries','launch','send','backup-full.zip','copyFileSync','readFileSync','config_alerts','reject','bots','toggle','reset-password','telegramIpApproval','output-002.log','hex','Notifications\x20enabled\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','format','clientip','get-messages','exec','ipaddr.js','\x1b[34m','yes','restore_no_','/status\x20-\x20show\x20bot(s)\x20status\x0a','bot.js','telegrammsg','push','Unauthorized\x20attempt\x20to\x20log\x20out','marketcapApi','from','file','password','_nsps','reinstall-bb','accept','-results.json','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','6b67f3d61ee94b8f5c80b4affef4c4d9','hasOwnProperty','\x20>\x20','Notifications\x20disabled\x0a','Logged\x20out\x20user\x20...','portfolio_','simple','Starting\x20new\x20bot\x20|\x20Bot\x20','toIPv4Address','uuid-random','access\x20timeout','text','Error\x20sending\x20','\x20mode','string','getStartingBalances','Login\x20rejected','sortBy','use','status\x20code\x20401','config/','logs/','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','generateAsync','\x20(1)','family','\x1b[31m','create','restore-backup-file','/:bot/coins','pidRefreshToken','SIGTERM','Error\x20removing\x20old\x20backup\x20files:','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','allow','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','debug','119388wgvDwZ','************','event','IPv4','clients','-performance.json','Login\x20accepted','on_','createWriteStream','toIPv4MappedAddress','bbUsername','randomBytes','encryptedUuid','temporary\x20access\x20timeout','settings','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','getPortfolio','2FA\x20required','headless','argv','bb-secure.json','sha256','Deleted\x20Bot\x20','readdirSync','\x1b[0m','Restore\x20process\x20aborted','showname','Starting\x20(','publicKey','range','logout','pidExpireLogin','emit','warning','alerts','server','userid','Starting\x20#RED#Balance\x20Bot\x20v','1000','getHours','/output-000.log','removeAllListeners','bot','botmanager','number','static','socket','handshake','#RES#\x20if\x20running\x20on\x20server','timestamp','timeshift','constructor','telegram','off','bbPassword','remoteAddress','http','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','cancelLoading','\x20|\x20user:\x20...','Starting\x20Balance\x20Bot\x20reinstallation','tempaccess_15_','Allow\x20login\x20from\x20IP\x20address\x20','2FA\x20login\x20token\x20generated','telegramToken','reply','#RES#','match','All\x20bots\x20running\x20right\x20now','orders','ETH','set','Error:\x20Invalid\x20argument\x20','uuid','NTBA_FIX_319','Server','Ok,\x20will\x20send\x20order\x20notifications\x20only','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20store\x20configuration','crypto','***','Yes','address\x20already\x20in\x20use','/update\x20-\x20update\x20Balance\x20Bot\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','function','zip/','--------------------------------------'];_0x5eab=function(){return _0x51aed9;};return _0x5eab();}function setTokenRefresh(_0x16e4c6){const _0x8027a5=_0x5347cb;if(devices[_0x16e4c6][_0x8027a5(0x151)])clearTimeout(devices[_0x16e4c6]['pidRefreshToken']);devices[_0x16e4c6][_0x8027a5(0x151)]=setTimeout(()=>{const _0x2ec36b=_0x8027a5;getClientsWithUuid(_0x16e4c6)[_0x2ec36b(0x1d0)]!=0x0?(devices[_0x16e4c6][_0x2ec36b(0x1d1)]=refreshToken(_0x16e4c6),io['to'](_0x16e4c6)[_0x2ec36b(0x178)](_0x2ec36b(0x2eb),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x16e4c6][_0x2ec36b(0x1d1)],'externalip':devices[_0x16e4c6]['ip'],'publicKey':secure[_0x2ec36b(0x174)],'validInstallation':validInstallation}),setTokenRefresh(_0x16e4c6)):clearTimeout(devices[_0x16e4c6]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x24fa3e){const _0x582fa4=_0x5347cb,_0x43b92e=getClient(_0x24fa3e['id'])[_0x582fa4(0x1a1)];_0x24fa3e[_0x582fa4(0x178)](_0x582fa4(0x115),config),_0x24fa3e[_0x582fa4(0x178)]('settings',cleanSettings()),_0x24fa3e['on'](_0x582fa4(0x1dd),_0x2b478c=>{const _0x2221c2=_0x582fa4;if(validateAccess(_0x2b478c,_0x43b92e)['allow'])addBot();else logger[_0x2221c2(0x101)](_0x2221c2(0x24b));}),_0x24fa3e['on'](_0x582fa4(0x28c),(_0xe43613,_0x128712)=>{const _0x3c9e15=_0x582fa4;if(validateAccess(_0x128712,_0x43b92e)[_0x3c9e15(0x155)])toggleBot(_0xe43613[_0x3c9e15(0x1e9)],_0xe43613[_0x3c9e15(0x2eb)],_0xe43613['live']);else logger[_0x3c9e15(0x101)](_0x3c9e15(0x25d));}),_0x24fa3e['on'](_0x582fa4(0x252),(_0x4e659c,_0x3f423b)=>{const _0x39b913=_0x582fa4;if(validateAccess(_0x3f423b,_0x43b92e)[_0x39b913(0x155)])toggleBotMode(_0x4e659c);else logger['full'](_0x39b913(0x25d));}),_0x24fa3e['on'](_0x582fa4(0x2d3),(_0xcfeda,_0x177db0)=>{const _0x290002=_0x582fa4;if(validateAccess(_0x177db0,_0x43b92e)[_0x290002(0x155)])deleteBot(_0xcfeda);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x24fa3e['on'](_0x582fa4(0xf8),(_0x22c67d,_0x1d279a)=>{const _0x3501c9=_0x582fa4;if(validateAccess(_0x1d279a,_0x43b92e)[_0x3501c9(0x155)])storeSettings(_0x22c67d,!![]);else logger[_0x3501c9(0x101)](_0x3501c9(0x10b));}),_0x24fa3e['on'](_0x582fa4(0x1d3),_0x2fec6c=>{const _0x304b55=_0x582fa4;if(validateAccess(_0x2fec6c,_0x43b92e)[_0x304b55(0x155)])updateBB(_0x304b55(0x257));else logger['full'](_0x304b55(0x149));}),_0x24fa3e['on'](_0x582fa4(0x12f),_0x350904=>{const _0x1a140c=_0x582fa4;if(validateAccess(_0x350904,_0x43b92e)[_0x1a140c(0x155)])updateBB(_0x1a140c(0xfc));else logger[_0x1a140c(0x101)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x24fa3e['on']('get-backup-files',_0x3874b2=>{const _0x169c1a=_0x582fa4;if(validateAccess(_0x3874b2,_0x43b92e)[_0x169c1a(0x155)]){const _0x343570=getClient(_0x24fa3e['id']);if(_0x343570)getBackupFiles(_0x343570['uuid']);else logger[_0x169c1a(0x101)](_0x169c1a(0x298));}else logger[_0x169c1a(0x101)](_0x169c1a(0x25e));}),_0x24fa3e['on'](_0x582fa4(0x14f),(_0x5d0b45,_0x418c8f)=>{const _0x584a0a=_0x582fa4;if(validateAccess(_0x418c8f,_0x43b92e)[_0x584a0a(0x155)])restoreBackupFile(_0x5d0b45);else logger[_0x584a0a(0x101)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x24fa3e['on'](_0x582fa4(0x11f),_0x1ae617=>{const _0x11b666=_0x582fa4;if(validateAccess(_0x1ae617,_0x43b92e)[_0x11b666(0x155)])getMessages();else logger[_0x11b666(0x101)](_0x11b666(0x1d7));}),_0x24fa3e['on'](_0x582fa4(0x2e6),(_0x2ca233,_0x9f40d0)=>{const _0x12fc7a=_0x582fa4;if(validateAccess(_0x9f40d0,_0x43b92e)[_0x12fc7a(0x155)])confirmMessage(_0x2ca233);else logger[_0x12fc7a(0x101)](_0x12fc7a(0x299));}),_0x24fa3e['on'](_0x582fa4(0x176),_0x5b2588=>{const _0x4f6520=_0x582fa4;if(validateAccess(_0x5b2588,_0x43b92e)[_0x4f6520(0x155)]){if(devices[_0x43b92e]['pidRefreshToken'])clearTimeout(devices[_0x43b92e]['pidRefreshToken']);if(devices[_0x43b92e][_0x4f6520(0x177)])clearTimeout(devices[_0x43b92e]['pidExpireLogin']);removeSocketListeners(getClient(_0x24fa3e['id'])[_0x4f6520(0x1a1)]),addBlacklist(_0x43b92e),devices[_0x43b92e][_0x4f6520(0x118)]=null,devices[_0x43b92e]['telegram2FaApproval']=null,devices[_0x43b92e][_0x4f6520(0x1d1)][_0x4f6520(0x1de)]=null,logger[_0x4f6520(0x157)](_0x4f6520(0x137)+_0x43b92e[_0x4f6520(0x2e0)](-0x8)),io['to'](getClient(_0x24fa3e['id'])[_0x4f6520(0x1a1)])['emit'](_0x4f6520(0x2eb),{'access':{'allow':![],'reason':_0x4f6520(0x201),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x2f8ed3){const _0x54f0ed=_0x5347cb,_0x13df78=getClient(_0x2f8ed3['id'])[_0x54f0ed(0x182)],_0x9e30b0=getClient(_0x2f8ed3['id'])['uuid'];_0x2f8ed3['on'](_0x54f0ed(0xe5),(_0xd6f15,_0x541e67)=>{const _0x5754d6=_0x54f0ed;if(validateAccess(_0x541e67,_0x9e30b0)[_0x5754d6(0x155)]){if(pid[_0x13df78])pid[_0x13df78][_0x5754d6(0x10f)]({'function':_0x5754d6(0x2f2),'args':_0xd6f15});}else logger[_0x5754d6(0x101)](_0x5754d6(0x2e5));}),_0x2f8ed3['on'](_0x54f0ed(0x1ee),(_0xcf08bb,_0x128f85)=>{const _0x47aae6=_0x54f0ed;if(validateAccess(_0x128f85,_0x9e30b0)[_0x47aae6(0x155)]){if(pid[_0x13df78])pid[_0x13df78]['send']({'function':_0x47aae6(0x10c),'args':_0xcf08bb});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2f8ed3['on'](_0x54f0ed(0x22a),(_0x270122,_0x25e1b5)=>{const _0x16df79=_0x54f0ed;if(validateAccess(_0x25e1b5,_0x9e30b0)[_0x16df79(0x155)]){if(pid[_0x13df78])pid[_0x13df78][_0x16df79(0x10f)]({'function':_0x16df79(0x168),'args':_0x270122});}else logger[_0x16df79(0x101)](_0x16df79(0x108));}),_0x2f8ed3['on'](_0x54f0ed(0x2a4),(_0x1c9900,_0xa6f150)=>{const _0x3b8f92=_0x54f0ed;if(validateAccess(_0xa6f150,_0x9e30b0)['allow']){if(pid[_0x13df78])pid[_0x13df78][_0x3b8f92(0x10f)]({'function':'storeConfiguration','args':_0x1c9900});}else logger[_0x3b8f92(0x101)](_0x3b8f92(0x1a6));}),_0x2f8ed3['on'](_0x54f0ed(0x1e2),(_0x251560,_0x5250d1)=>{const _0x6bbabb=_0x54f0ed;if(validateAccess(_0x5250d1,_0x9e30b0)[_0x6bbabb(0x155)]){if(pid[_0x13df78])pid[_0x13df78][_0x6bbabb(0x10f)]({'function':_0x6bbabb(0x283),'args':_0x251560});}else logger[_0x6bbabb(0x101)](_0x6bbabb(0x1d9));}),_0x2f8ed3['on']('store-fiat',(_0x4c5262,_0x1ac7e5)=>{const _0x1a275b=_0x54f0ed;if(validateAccess(_0x1ac7e5,_0x9e30b0)[_0x1a275b(0x155)]){if(pid[_0x13df78])pid[_0x13df78]['send']({'function':_0x1a275b(0x282),'args':_0x4c5262});}else logger['full'](_0x1a275b(0x132));}),_0x2f8ed3['on'](_0x54f0ed(0x1f5),_0x6e0ed9=>{const _0x21c799=_0x54f0ed;if(validateAccess(_0x6e0ed9,_0x9e30b0)['allow']){if(pid[_0x13df78])pid[_0x13df78][_0x21c799(0x10f)]({'function':_0x21c799(0x269),'args':null});}else logger[_0x21c799(0x101)](_0x21c799(0x2ca));}),_0x2f8ed3['on'](_0x54f0ed(0x244),_0x12bd76=>{const _0x1aaf21=_0x54f0ed;if(validateAccess(_0x12bd76,_0x9e30b0)[_0x1aaf21(0x155)]){if(pid[_0x13df78])pid[_0x13df78][_0x1aaf21(0x10f)]({'function':_0x1aaf21(0x142),'args':null});}else logger[_0x1aaf21(0x101)](_0x1aaf21(0x1c9));}),_0x2f8ed3['on']('place-order',(_0x466167,_0xe33cfc)=>{const _0x4a310c=_0x54f0ed;if(validateAccess(_0xe33cfc,_0x9e30b0)['allow']){if(pid[_0x13df78])pid[_0x13df78][_0x4a310c(0x10f)]({'function':_0x4a310c(0x2f1),'args':_0x466167});}else logger[_0x4a310c(0x101)](_0x4a310c(0x2a2));}),_0x2f8ed3['on'](_0x54f0ed(0x25f),_0x2bbcdd=>{const _0x1d9a81=_0x54f0ed;if(validateAccess(_0x2bbcdd,_0x9e30b0)[_0x1d9a81(0x155)]){if(pid[_0x13df78])pid[_0x13df78][_0x1d9a81(0x10f)]({'function':_0x1d9a81(0x192),'args':null});}else logger['full'](_0x1d9a81(0x2a0));}),_0x2f8ed3['on'](_0x54f0ed(0x209),_0x320174=>{const _0x11d703=_0x54f0ed;if(validateAccess(_0x320174,_0x9e30b0)['allow']){if(pid[_0x13df78])pid[_0x13df78][_0x11d703(0x10f)]({'function':'showConfig','args':null});}else logger[_0x11d703(0x101)](_0x11d703(0x28f));}),_0x2f8ed3['on']('update-bb',_0x17b60e=>{const _0x2ec469=_0x54f0ed;if(validateAccess(_0x17b60e,_0x9e30b0)[_0x2ec469(0x155)])updateBB(_0x2ec469(0x257));else logger[_0x2ec469(0x101)](_0x2ec469(0x149));}),_0x2f8ed3['on']('get-messages',_0x196d83=>{const _0x1df8bd=_0x54f0ed;if(validateAccess(_0x196d83,_0x9e30b0)['allow'])getMessages();else logger[_0x1df8bd(0x101)](_0x1df8bd(0x1d7));}),_0x2f8ed3['on'](_0x54f0ed(0x2e6),(_0x4cfc88,_0x3e0d6e)=>{const _0x4e7fe3=_0x54f0ed;if(validateAccess(_0x3e0d6e,_0x9e30b0)[_0x4e7fe3(0x155)])confirmMessage(_0x4cfc88);else logger[_0x4e7fe3(0x101)](_0x4e7fe3(0x299));}),_0x2f8ed3['on']('logout',_0x33da08=>{const _0x2760c6=_0x54f0ed;if(validateAccess(_0x33da08,_0x9e30b0)[_0x2760c6(0x155)]){if(devices[_0x9e30b0][_0x2760c6(0x151)])clearTimeout(devices[_0x9e30b0][_0x2760c6(0x151)]);if(devices[_0x9e30b0][_0x2760c6(0x177)])clearTimeout(devices[_0x9e30b0][_0x2760c6(0x177)]);removeSocketListeners(getClient(_0x2f8ed3['id'])[_0x2760c6(0x1a1)]),addBlacklist(_0x9e30b0),devices[_0x9e30b0]['telegramIpApproval']=null,devices[_0x9e30b0]['telegram2FaApproval']=null,devices[_0x9e30b0][_0x2760c6(0x1d1)]['token']=null,logger[_0x2760c6(0x157)](_0x2760c6(0x137)+_0x9e30b0[_0x2760c6(0x2e0)](-0x8)),io['to'](getClient(_0x2f8ed3['id'])['uuid'])[_0x2760c6(0x178)](_0x2760c6(0x2eb),{'access':{'allow':![],'reason':_0x2760c6(0x201),'token':null}});}else logger[_0x2760c6(0x101)](_0x2760c6(0x129));});}function removeSocketListeners(_0x3d7a68){getClientsWithUuid(_0x3d7a68)['forEach'](_0x82e1e8=>{const _0x405f35=_0xf239;getSocket(_0x82e1e8['id'])[_0x405f35(0x181)]();});}function cleanSettings(){const _0xfb4996=_0x5347cb;let _0xac00a7=settings;return settings[_0xfb4996(0x198)]&&settings['telegramToken']!=''&&(_0xac00a7={..._0xac00a7,'telegramToken':_0xfb4996(0x159)}),settings['bbPassword']&&settings[_0xfb4996(0x18e)]!=''&&(_0xac00a7={..._0xac00a7,'bbPassword':_0xfb4996(0x159)}),settings[_0xfb4996(0x12a)]&&settings['marketcapApi']!=''&&(_0xac00a7={..._0xac00a7,'marketcapApi':_0xfb4996(0x159)}),(settings[_0xfb4996(0x18e)]&&settings['bbPassword']==_0xfb4996(0x1a8)||settings[_0xfb4996(0x198)]&&settings['telegramToken']==_0xfb4996(0x1a8)||settings[_0xfb4996(0x12a)]&&settings[_0xfb4996(0x12a)]==_0xfb4996(0x1a8))&&(_0xac00a7={..._0xac00a7,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0xfb4996(0x198)]==_0xfb4996(0x1a8),'marketcap':settings['marketcapApi']==_0xfb4996(0x1a8)}}),_0xac00a7;}async function updateBB(_0xc448d1){const _0xa2e6ec=_0x5347cb;await backupConfigFiles(),installingUpdate=!![],config[_0xa2e6ec(0x1fe)](_0x1efa4f=>{const _0x1da8a1=_0xa2e6ec;restartBot(_0x1efa4f[_0x1da8a1(0x1e9)]);});if(_0xc448d1==_0xa2e6ec(0x257))process['send']({'update':!![],'environment':environment},_0x1df80e=>{});else _0xc448d1==_0xa2e6ec(0xfc)&&process['send']({'reinstall':!![],'environment':environment},_0x28e02a=>{});}function startBot(_0x361b04,_0x97518d,_0x1b3264){const _0x2a4ef3=_0x5347cb;if(debugging)_0x361b04[_0x2a4ef3(0x128)]('-d');let _0x394dfa=![];const _0x1f0847=_0x361b04[0x0];_0x97518d={..._0x97518d,'stdio':[_0x2a4ef3(0xfb),'inherit',_0x2a4ef3(0xfb),_0x2a4ef3(0x2aa)]},pid[_0x1f0847]=childProcess[_0x2a4ef3(0x26d)](botfile,_0x361b04,_0x97518d),pid[_0x1f0847]['on'](_0x2a4ef3(0x29c),_0x175b73=>{const _0x3858ab=_0x2a4ef3;switch(Object[_0x3858ab(0x1f8)](_0x175b73)[0x0]){case'botname':updateBotName(_0x1f0847,_0x175b73[_0x3858ab(0x1b0)]);break;case _0x3858ab(0x22c):updateBotManager();break;case _0x3858ab(0x2eb):updateStatus(_0x1f0847,_0x175b73[_0x3858ab(0x2eb)]);break;case _0x3858ab(0x215):updateLive(_0x1f0847,_0x175b73[_0x3858ab(0x215)]);break;case _0x3858ab(0x1be):updateLive(_0x1f0847,_0x175b73['started']),io['to'](_0x1f0847)[_0x3858ab(0x178)](_0x3858ab(0x2eb),{'access':{'allow':![],'reason':_0x3858ab(0x2a8),'token':null}});break;case'stop':_0x175b73[_0x3858ab(0x1b5)]==_0x3858ab(0x2db)&&restartBot(_0x1f0847);_0x175b73[_0x3858ab(0x1b5)]==_0x3858ab(0x1ca)&&toggleBot(_0x1f0847,_0x3858ab(0x2b1),_0x3858ab(0x226));break;case _0x3858ab(0x18c):sendTelegramBot(_0x1f0847,_0x175b73[_0x3858ab(0x18c)]);break;case _0x3858ab(0x127):sendTelegramMsg(_0x175b73[_0x3858ab(0x127)]);break;case _0x3858ab(0x1ad):io['to'](_0x1f0847)[_0x3858ab(0x178)](_0x175b73[_0x3858ab(0x1ad)],_0x175b73[_0x3858ab(0x2ed)]);break;}}),pid[_0x1f0847]['on'](_0x2a4ef3(0x289),function(_0x5389ea){if(_0x394dfa)return;_0x394dfa=!![],_0x1b3264(_0x5389ea);}),pid[_0x1f0847]['on']('exit',async function(_0x5a1923){const _0x3844b3=_0x2a4ef3;if(terminating)return;if(installingUpdate){io[_0x3844b3(0x214)]();return;}if(_0x394dfa)return;_0x394dfa=!![],_0x1b3264(null);const _0xb77867=dbConfig['get'](_0x3844b3(0x115))[_0x3844b3(0xef)]({'botID':_0x1f0847})[_0x3844b3(0x10a)]();_0xb77867&&(_0xb77867[_0x3844b3(0x2eb)]==_0x3844b3(0x1b9)||_0xb77867['status']=='new')&&(await sleep(0x3e8),updateLive(_0x1f0847,_0x3844b3(0x226)),logger['full']('Restarting\x20Bot\x20'+_0x1f0847),startBot([_0x1f0847,userID],{'cwd':bbpath},function(_0xe0747c){if(_0xe0747c)logger['full'](_0xe0747c);}));});}function _0xf239(_0x585464,_0x1f56ea){const _0x4593de=_0x5eab();return _0xf239=function(_0x4e53d4,_0x2394a3){_0x4e53d4=_0x4e53d4-0xe5;let _0x5eabfc=_0x4593de[_0x4e53d4];return _0x5eabfc;},_0xf239(_0x585464,_0x1f56ea);}function stopBot(_0x41c903){const _0x35f9ee=_0x5347cb;getClientsWithBotID(_0x41c903)['forEach'](_0x2f40c2=>{const _0x3ef0af=_0xf239;getSocket(_0x2f40c2['id'])[_0x3ef0af(0x268)](!![]),removeClient(_0x2f40c2['id']);}),pid[_0x41c903]&&(pid[_0x41c903][_0x35f9ee(0x1ca)](),pid[_0x41c903]=null);}function stopAllBots(){terminating=!![];const _0x29038f=getEnabledBots();_0x29038f['forEach'](_0x5be196=>{const _0x55afc5=_0xf239;stopBot(_0x5be196[_0x55afc5(0x1e9)]);});}function restartBot(_0x4046c4){const _0x3b61e1=_0x5347cb;if(pid[_0x4046c4])pid[_0x4046c4][_0x3b61e1(0x1ca)]();}function addBot(){const _0x14cbd=_0x5347cb;let _0x290962;for(let _0x5b2759=0x1;_0x5b2759<0x3e9;_0x5b2759++){_0x290962=_0x5b2759[_0x14cbd(0x1ff)]()[_0x14cbd(0xea)](0x3,'0');let _0x34bd6b=config[_0x14cbd(0xef)](_0x2e2b3a=>_0x2e2b3a[_0x14cbd(0x1e9)]==_0x290962);if(!_0x34bd6b)break;}if(_0x290962===_0x14cbd(0x17e)){logger[_0x14cbd(0x101)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x14cbd(0x101)](_0x14cbd(0x13a)+_0x290962),dbConfig['get'](_0x14cbd(0x115))[_0x14cbd(0x128)]({'botID':_0x290962,'botname':_0x14cbd(0x259)+_0x290962,'status':_0x14cbd(0x29e),'live':''})[_0x14cbd(0x2d7)](),startBot([_0x290962,userID],{'cwd':bbpath},function(_0x484b58){const _0x1b48ee=_0x14cbd;if(_0x484b58)logger[_0x1b48ee(0x101)](_0x484b58);}),config=getConfiguration(),io['to'](_0x14cbd(0x183))[_0x14cbd(0x178)](_0x14cbd(0x115),config),broadcastToBots(_0x14cbd(0x115),JSON[_0x14cbd(0x2d5)](config));}function deleteBot(_0x18b479){const _0x2e69c0=_0x5347cb;getClientsWithBotID(_0x18b479)[_0x2e69c0(0x1fe)](_0x49c6ee=>{const _0x3c95b1=_0x2e69c0;getSocket(_0x49c6ee['id'])[_0x3c95b1(0x268)](!![]),removeClient(_0x49c6ee['id']);}),dbConfig[_0x2e69c0(0x23c)](_0x2e69c0(0x115))[_0x2e69c0(0x2b2)]({'botID':_0x18b479})[_0x2e69c0(0x2d7)](),logger[_0x2e69c0(0x101)](_0x2e69c0(0x16e)+_0x18b479),stopBot(_0x18b479);try{if(fs[_0x2e69c0(0x1cb)](path[_0x2e69c0(0x241)](configpath,_0x2e69c0(0x1fa)+_0x18b479+_0x2e69c0(0x2ee))))fs[_0x2e69c0(0x1c0)](path['join'](configpath,_0x2e69c0(0x1fa)+_0x18b479+_0x2e69c0(0x2ee)));if(fs[_0x2e69c0(0x1cb)](path[_0x2e69c0(0x241)](configpath,_0x2e69c0(0x1fa)+_0x18b479+_0x2e69c0(0x1c7))))fs['unlinkSync'](path['join'](configpath,_0x2e69c0(0x1fa)+_0x18b479+_0x2e69c0(0x1c7)));if(fs['existsSync'](path[_0x2e69c0(0x241)](configpath,'bot-'+_0x18b479+_0x2e69c0(0x15d))))fs[_0x2e69c0(0x1c0)](path['join'](configpath,'bot-'+_0x18b479+_0x2e69c0(0x15d)));if(fs['existsSync'](path[_0x2e69c0(0x241)](configpath,_0x2e69c0(0x1fa)+_0x18b479+'-results.json')))fs['unlinkSync'](path[_0x2e69c0(0x241)](configpath,_0x2e69c0(0x1fa)+_0x18b479+_0x2e69c0(0x131)));}catch(_0x3cc7e5){if(_0x3cc7e5)logger[_0x2e69c0(0x101)](_0x2e69c0(0x2cb),_0x3cc7e5);}config=getConfiguration(),io['to'](_0x2e69c0(0x183))[_0x2e69c0(0x178)](_0x2e69c0(0x115),config),broadcastToBots(_0x2e69c0(0x115),JSON['stringify'](config));}function toggleBot(_0x7efae7,_0x5a65c5,_0x1b7688){const _0x1f2b42=_0x5347cb;dbConfig[_0x1f2b42(0x23c)]('bots')['find']({'botID':_0x7efae7})[_0x1f2b42(0x104)]({'status':_0x5a65c5})[_0x1f2b42(0x104)]({'live':_0x1b7688})[_0x1f2b42(0x2d7)]();if(_0x5a65c5==_0x1f2b42(0x1b9)||_0x5a65c5==_0x1f2b42(0x29e))logger[_0x1f2b42(0x101)]('Enabled\x20Bot\x20'+_0x7efae7),startBot([_0x7efae7,userID],{'cwd':bbpath},function(_0x85282a){const _0x582ec3=_0x1f2b42;if(_0x85282a)logger[_0x582ec3(0x101)](_0x85282a);});else(_0x5a65c5==_0x1f2b42(0x2b1)||_0x5a65c5==_0x1f2b42(0x225))&&(logger[_0x1f2b42(0x101)]('Disabled\x20Bot\x20'+_0x7efae7),stopBot(_0x7efae7));config=getConfiguration(),io['to'](_0x1f2b42(0x183))[_0x1f2b42(0x178)](_0x1f2b42(0x115),config),broadcastToBots(_0x1f2b42(0x115),JSON['stringify'](config));}function toggleStatus(_0x383dbc){const _0x38d00b=_0x5347cb;let _0x4ad8ab=dbConfig[_0x38d00b(0x23c)](_0x38d00b(0x115))[_0x38d00b(0xef)]({'botID':_0x383dbc})[_0x38d00b(0x10a)](),_0x2e3c6e;if(_0x4ad8ab[_0x38d00b(0x2eb)]===_0x38d00b(0x1b9))_0x2e3c6e=_0x38d00b(0x2b1);else{if(_0x4ad8ab['status']==='new')_0x2e3c6e='new-disabled';else{if(_0x4ad8ab[_0x38d00b(0x2eb)]===_0x38d00b(0x225))_0x2e3c6e='new';else{if(_0x4ad8ab['status']===_0x38d00b(0x2b1))_0x2e3c6e=_0x38d00b(0x1b9);}}}return _0x2e3c6e;}function updateStatus(_0x5b6b67,_0x421dce){const _0x54425f=_0x5347cb;dbConfig['get'](_0x54425f(0x115))[_0x54425f(0xef)]({'botID':_0x5b6b67})[_0x54425f(0x104)]({'status':_0x421dce})[_0x54425f(0x2d7)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x54425f(0x115),JSON[_0x54425f(0x2d5)](config));}function updateLive(_0x19fe91,_0x42ebe1){const _0xae46cc=_0x5347cb;dbConfig['get'](_0xae46cc(0x115))[_0xae46cc(0xef)]({'botID':_0x19fe91})[_0xae46cc(0x104)]({'live':_0x42ebe1})[_0xae46cc(0x2d7)](),config=getConfiguration(),io['to'](_0xae46cc(0x183))[_0xae46cc(0x178)]('bots',config),broadcastToBots(_0xae46cc(0x115),JSON[_0xae46cc(0x2d5)](config));}function updateBotName(_0x557db2,_0x4e6113){const _0x5995eb=_0x5347cb;dbConfig[_0x5995eb(0x23c)](_0x5995eb(0x115))['find']({'botID':_0x557db2})[_0x5995eb(0x104)]({'botname':_0x4e6113})[_0x5995eb(0x2d7)](),config=getConfiguration(),io['to'](_0x5995eb(0x183))[_0x5995eb(0x178)](_0x5995eb(0x115),config),broadcastToBots(_0x5995eb(0x115),JSON[_0x5995eb(0x2d5)](config));}function updateBotManager(){const _0x4be1fe=_0x5347cb;config=getConfiguration(),io['to']('botmanager')[_0x4be1fe(0x178)]('bots',config),broadcastToBots(_0x4be1fe(0x115),JSON[_0x4be1fe(0x2d5)](config));}function toggleBotMode(_0x5ecbe7){const _0x127172=_0x5347cb;if(pid[_0x5ecbe7])pid[_0x5ecbe7][_0x127172(0x10f)]({'function':_0x127172(0x1df),'args':null});else{const _0x1e6070=configpath+_0x127172(0x1fa)+_0x5ecbe7+'-config.json',_0x2796cb=fs[_0x127172(0x112)](_0x1e6070),_0x1dbec1=JSON[_0x127172(0x275)](_0x2796cb),_0xbc7384=_0x1dbec1[_0x127172(0x182)][0x0][_0x127172(0x16a)];_0x1dbec1[_0x127172(0x182)][0x0][_0x127172(0x16a)]=!_0xbc7384;const _0x317e56=JSON[_0x127172(0x2d5)](_0x1dbec1,null,0x2);fs[_0x127172(0x29f)](_0x1e6070,_0x317e56),config=getConfiguration(),io['to'](_0x127172(0x183))[_0x127172(0x178)]('bots',config),broadcastToBots(_0x127172(0x115),JSON[_0x127172(0x2d5)](config));}}function validateTelegram(_0x4f7df6){const _0x2fd6c3=_0x5347cb;if(_0x4f7df6[_0x2fd6c3(0x12b)]['username']!=settings[_0x2fd6c3(0x1b2)]&&'@'+_0x4f7df6[_0x2fd6c3(0x12b)][_0x2fd6c3(0x254)]!=settings['telegramUsername']||_0x4f7df6[_0x2fd6c3(0x1b3)]['id']!=settings[_0x2fd6c3(0x27a)])return sendTelegram(_0x4f7df6[_0x2fd6c3(0x1b3)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x2c0f42=_0x5347cb;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x17901a=_0x2c0f42(0xfe);_0x17901a+='\x0a',_0x17901a+='/enable\x20-\x20enable\x20notifications\x0a',_0x17901a+=_0x2c0f42(0x216),_0x17901a+=_0x2c0f42(0x11c),_0x17901a+=_0x2c0f42(0x240),_0x17901a+='/on\x20-\x20start\x20bot(s)\x0a',_0x17901a+=_0x2c0f42(0x2ea),_0x17901a+=_0x2c0f42(0x1ac),_0x17901a+=_0x2c0f42(0x21d),_0x17901a+=_0x2c0f42(0x125),_0x17901a+=_0x2c0f42(0x1d4),_0x17901a+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x17901a+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x17901a+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x17901a+=_0x2c0f42(0x1ab),_0x17901a+=_0x2c0f42(0x20c),_0x17901a+=_0x2c0f42(0x20f);let _0x1c2193='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1c2193+='\x0a',_0x1c2193+=_0x17901a,tgBot[_0x2c0f42(0x290)]((_0x504b18,_0x391abb)=>{const _0x12ec12=_0x2c0f42;logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x12ec12(0x157)](_0x12ec12(0x2f5),_0x504b18);}),tgBot['use'](async(_0x1ee75f,_0x2a3882)=>{const _0x272314=_0x2c0f42;if(!(!settings['telegramChatId']&&_0x1ee75f[_0x272314(0x257)]['message'][_0x272314(0x13e)]==_0x272314(0x242))){if(!validateTelegram(_0x1ee75f))return;}_0x2a3882();}),tgBot['command'](_0x2c0f42(0x297),async _0x441322=>{const _0x30d4b5=_0x2c0f42;if(_0x441322['from'][_0x30d4b5(0x254)]==settings[_0x30d4b5(0x1b2)]||'@'+_0x441322[_0x30d4b5(0x12b)][_0x30d4b5(0x254)]==settings[_0x30d4b5(0x1b2)]){if(!settings[_0x30d4b5(0x27a)])updateSetting(_0x30d4b5(0x27a),_0x441322[_0x30d4b5(0x1b3)]['id']);}if(!validateTelegram(_0x441322))return;updateSetting(_0x30d4b5(0x2a9),!![]),await sendTelegram(_0x441322['chat']['id'],_0x1c2193);}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x28b),async _0x31b283=>{const _0x3e6e5b=_0x2c0f42;updateSetting(_0x3e6e5b(0x2a9),!![]),await sendTelegram(_0x31b283['chat']['id'],_0x3e6e5b(0x2a7));}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x2dc),async _0x488e77=>{const _0x28b500=_0x2c0f42;await sendTelegram(_0x488e77[_0x28b500(0x1b3)]['id'],'Notifications\x20disabled'),updateSetting(_0x28b500(0x2a9),![]);}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x249),async _0xa00001=>{const _0x4063cc=_0x2c0f42,_0x23517d=Markup[_0x4063cc(0x234)]([Markup[_0x4063cc(0x24e)][_0x4063cc(0x1b7)](_0x4063cc(0x260),_0x4063cc(0x276)),Markup['button'][_0x4063cc(0x1b7)](_0x4063cc(0x105),_0x4063cc(0x113)),Markup[_0x4063cc(0x24e)]['callback']('All',_0x4063cc(0x22b))]);_0xa00001['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x23517d);}),tgBot[_0x2c0f42(0x243)](_0x2c0f42(0x276),async _0x110ab1=>{const _0x42e0a5=_0x2c0f42;_0x110ab1['editMessageReplyMarkup'](),updateSetting(_0x42e0a5(0x1e8),_0x42e0a5(0x19d)),updateSetting(_0x42e0a5(0x2a9),!![]),await sendTelegram(_0x110ab1[_0x42e0a5(0x1b3)]['id'],_0x42e0a5(0x1a4));}),tgBot[_0x2c0f42(0x243)](_0x2c0f42(0x113),async _0x221ccd=>{const _0x3d2748=_0x2c0f42;_0x221ccd[_0x3d2748(0x2d4)](),updateSetting(_0x3d2748(0x1e8),_0x3d2748(0x17a)),updateSetting(_0x3d2748(0x2a9),!![]),await sendTelegram(_0x221ccd[_0x3d2748(0x1b3)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x2c0f42(0x243)]('config_all',async _0x34097e=>{const _0x516236=_0x2c0f42;_0x34097e[_0x516236(0x2d4)](),updateSetting('telegramEvents',_0x516236(0x27e)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x34097e[_0x516236(0x1b3)]['id'],_0x516236(0x23b));}),tgBot['command'](_0x2c0f42(0x2eb),async _0x16028d=>{const _0x43b4eb=_0x2c0f42,_0x326bb9=getBotsWithMode();let _0x2d7cbc=_0x43b4eb(0x27f);config[_0x43b4eb(0x1fe)](_0x6dfc1e=>{const _0x5f21d6=_0x43b4eb,_0x385f5f=_0x326bb9[_0x5f21d6(0xef)](_0x2080d2=>_0x2080d2[_0x5f21d6(0x1e9)]==_0x6dfc1e['botID'])['mode'];_0x2d7cbc+='Bot\x20'+_0x6dfc1e[_0x5f21d6(0x1e9)]+':\x20'+_0x6dfc1e[_0x5f21d6(0x2eb)]+'\x20|\x20'+_0x385f5f+_0x5f21d6(0x238)+_0x6dfc1e['live']+'\x0a';}),_0x2d7cbc+='\x0a',_0x2d7cbc+=_0x43b4eb(0x28a),_0x2d7cbc+=!settings['telegramEnabled']?_0x43b4eb(0x136):_0x43b4eb(0x11b),_0x2d7cbc+=settings[_0x43b4eb(0x2a9)]?settings[_0x43b4eb(0x1e8)]==_0x43b4eb(0x27e)?_0x43b4eb(0x281):'Notifications\x20types:\x20'+settings[_0x43b4eb(0x1e8)]+_0x43b4eb(0x22d):'',await sendTelegram(_0x16028d[_0x43b4eb(0x1b3)]['id'],_0x2d7cbc,{'parse_mode':'HTML'});}),tgBot['command'](_0x2c0f42(0x2db),async _0x594576=>{const _0x132132=_0x2c0f42,_0x43587c=getEnabledBots();if(_0x43587c[_0x132132(0x1d0)]==0x0)await sendTelegram(_0x594576['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x43587c[_0x132132(0x1d0)]>0x1)_0x43587c[_0x132132(0x128)]({'botID':_0x132132(0x27e)});let _0x3935e7=[],_0x18dbf4=[];const _0x146662=_0x43587c[_0x132132(0x1d0)]%0x4==0x0||_0x43587c[_0x132132(0x1d0)]%0x4==0x3||_0x43587c[_0x132132(0x1d0)]%0x3==0x1?0x4:0x3;let _0xf260e3=0x0;_0x43587c[_0x132132(0x1fe)]((_0x326ce5,_0x285534)=>{const _0x10cfb0=_0x132132;if(_0x285534%_0x146662==0x0)_0x18dbf4=[];_0x18dbf4[_0x10cfb0(0x128)](Markup[_0x10cfb0(0x24e)][_0x10cfb0(0x1b7)](_0x326ce5['botID']==_0x10cfb0(0x27e)?_0x10cfb0(0x2a3):_0x10cfb0(0x259)+_0x326ce5['botID'],_0x10cfb0(0x2ab)+_0x326ce5['botID'])),_0x285534%_0x146662==0x0&&(_0x3935e7[_0xf260e3]=_0x18dbf4,_0xf260e3++);});const _0xc2c96d=Markup[_0x132132(0x234)](_0x3935e7);_0x594576[_0x132132(0x199)](_0x132132(0x291),_0xc2c96d);}}),tgBot['action'](/restart_(.+)/,async _0x530953=>{const _0x36372c=_0x2c0f42,_0x43002d=_0x530953[_0x36372c(0x19b)][0x1];_0x530953[_0x36372c(0x2d4)](),_0x43002d=='all'?config[_0x36372c(0x1fe)](_0x1c176c=>{const _0x14e670=_0x36372c;restartBot(_0x1c176c[_0x14e670(0x1e9)]);}):restartBot(_0x43002d);}),tgBot['command']('on',async _0x51f51e=>{const _0x67de90=_0x2c0f42,_0x6f2214=getDisabledBots();if(_0x6f2214['length']==0x0)await sendTelegram(_0x51f51e[_0x67de90(0x1b3)]['id'],_0x67de90(0x19c));else{if(_0x6f2214[_0x67de90(0x1d0)]>0x1)_0x6f2214[_0x67de90(0x128)]({'botID':_0x67de90(0x27e)});let _0xc8fa2a=[],_0x4953e5=[];const _0x20a6d0=_0x6f2214[_0x67de90(0x1d0)]%0x4==0x0||_0x6f2214['length']%0x4==0x3||_0x6f2214['length']%0x3==0x1?0x4:0x3;let _0x5e77e1=0x0;_0x6f2214[_0x67de90(0x1fe)]((_0x2f06d9,_0x19c4ee)=>{const _0x21cbbe=_0x67de90;if(_0x19c4ee%_0x20a6d0==0x0)_0x4953e5=[];_0x4953e5[_0x21cbbe(0x128)](Markup[_0x21cbbe(0x24e)][_0x21cbbe(0x1b7)](_0x2f06d9[_0x21cbbe(0x1e9)]=='all'?_0x21cbbe(0x2a3):_0x21cbbe(0x259)+_0x2f06d9[_0x21cbbe(0x1e9)],_0x21cbbe(0x15f)+_0x2f06d9['botID'])),_0x19c4ee%_0x20a6d0==0x0&&(_0xc8fa2a[_0x5e77e1]=_0x4953e5,_0x5e77e1++);});const _0xf93822=Markup[_0x67de90(0x234)](_0xc8fa2a);_0x51f51e[_0x67de90(0x199)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0xf93822);}}),tgBot[_0x2c0f42(0x243)](/on_(.+)/,async _0x53d82c=>{const _0x3b934e=_0x2c0f42,_0x5bdc4d=_0x53d82c[_0x3b934e(0x19b)][0x1];_0x53d82c[_0x3b934e(0x2d4)]();if(_0x5bdc4d==_0x3b934e(0x27e)){const _0x80e031=getDisabledBots();await sendTelegram(_0x53d82c[_0x3b934e(0x1b3)]['id'],_0x3b934e(0x2c8)),_0x80e031[_0x3b934e(0x1fe)](_0x1088f7=>{const _0x153418=_0x3b934e;if(_0x1088f7['botID']!=_0x153418(0x27e))toggleBot(_0x1088f7[_0x153418(0x1e9)],toggleStatus(_0x1088f7[_0x153418(0x1e9)]),'stopped');});}else await sendTelegram(_0x53d82c[_0x3b934e(0x1b3)]['id'],_0x3b934e(0x23a)+_0x5bdc4d),toggleBot(_0x5bdc4d,toggleStatus(_0x5bdc4d),_0x3b934e(0x226));}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x18d),async _0x145866=>{const _0x37594c=_0x2c0f42,_0x2f374c=getEnabledBots();if(_0x2f374c[_0x37594c(0x1d0)]==0x0)await sendTelegram(_0x145866['chat']['id'],_0x37594c(0x228));else{if(_0x2f374c[_0x37594c(0x1d0)]>0x1)_0x2f374c[_0x37594c(0x128)]({'botID':_0x37594c(0x27e)});let _0x1f6373=[],_0x37aaef=[];const _0x1218a9=_0x2f374c[_0x37594c(0x1d0)]%0x4==0x0||_0x2f374c[_0x37594c(0x1d0)]%0x4==0x3||_0x2f374c['length']%0x3==0x1?0x4:0x3;let _0x30dd70=0x0;_0x2f374c[_0x37594c(0x1fe)]((_0x4eb7bc,_0x5e2059)=>{const _0x5c4164=_0x37594c;if(_0x5e2059%_0x1218a9==0x0)_0x37aaef=[];_0x37aaef[_0x5c4164(0x128)](Markup[_0x5c4164(0x24e)][_0x5c4164(0x1b7)](_0x4eb7bc['botID']==_0x5c4164(0x27e)?_0x5c4164(0x2a3):_0x5c4164(0x259)+_0x4eb7bc[_0x5c4164(0x1e9)],_0x5c4164(0x2d6)+_0x4eb7bc[_0x5c4164(0x1e9)])),_0x5e2059%_0x1218a9==0x0&&(_0x1f6373[_0x30dd70]=_0x37aaef,_0x30dd70++);});const _0x3bd73b=Markup[_0x37594c(0x234)](_0x1f6373);_0x145866[_0x37594c(0x199)](_0x37594c(0x256),_0x3bd73b);}}),tgBot['action'](/off_(.+)/,async _0x24a2a6=>{const _0x3db38e=_0x2c0f42,_0x1e50d1=_0x24a2a6[_0x3db38e(0x19b)][0x1];_0x24a2a6[_0x3db38e(0x2d4)]();if(_0x1e50d1==_0x3db38e(0x27e)){const _0xbeea05=getEnabledBots();await sendTelegram(_0x24a2a6[_0x3db38e(0x1b3)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0xbeea05[_0x3db38e(0x1fe)](_0x571e7d=>{const _0x24d480=_0x3db38e;if(_0x571e7d[_0x24d480(0x1e9)]!=_0x24d480(0x27e))toggleBot(_0x571e7d[_0x24d480(0x1e9)],toggleStatus(_0x571e7d[_0x24d480(0x1e9)]),_0x24d480(0x226));});}else await sendTelegram(_0x24a2a6[_0x3db38e(0x1b3)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x1e50d1),toggleBot(_0x1e50d1,toggleStatus(_0x1e50d1),_0x3db38e(0x226));}),tgBot[_0x2c0f42(0xfa)]('metrics',async _0x15cec2=>{const _0xaf6172=_0x2c0f42,_0x3b1329=getEnabledBots();if(_0x3b1329[_0xaf6172(0x1d0)]==0x0)await sendTelegram(_0x15cec2['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3b1329[_0xaf6172(0x1d0)]>0x1){let _0x2994bf=[],_0x187479=[];const _0x90f382=_0x3b1329['length']%0x4==0x0||_0x3b1329[_0xaf6172(0x1d0)]%0x4==0x3||_0x3b1329[_0xaf6172(0x1d0)]%0x3==0x1?0x4:0x3;let _0x13a450=0x0;_0x3b1329[_0xaf6172(0x1fe)]((_0x4e6d0a,_0x27659d)=>{const _0x21a463=_0xaf6172;if(_0x27659d%_0x90f382==0x0)_0x187479=[];_0x187479['push'](Markup[_0x21a463(0x24e)][_0x21a463(0x1b7)](_0x21a463(0x259)+_0x4e6d0a[_0x21a463(0x1e9)],'metrics_'+_0x4e6d0a['botID'])),_0x27659d%_0x90f382==0x0&&(_0x2994bf[_0x13a450]=_0x187479,_0x13a450++);});const _0x1775ee=Markup[_0xaf6172(0x234)](_0x2994bf);_0x15cec2['reply'](_0xaf6172(0x2ae),_0x1775ee);}else{const _0x3c73f1=_0x3b1329[0x0][_0xaf6172(0x1e9)];if(pid[_0x3c73f1])pid[_0x3c73f1][_0xaf6172(0x10f)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2c0f42(0x243)](/metrics_(.+)/,async _0x29df84=>{const _0x1549b3=_0x2c0f42,_0x3e1784=_0x29df84[_0x1549b3(0x19b)][0x1];_0x29df84[_0x1549b3(0x2d4)]();if(pid[_0x3e1784])pid[_0x3e1784]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x2c0f42(0xfa)]('portfolio',async _0x777eb3=>{const _0x2c36c7=_0x2c0f42,_0x1b82cd=getEnabledBots();if(_0x1b82cd[_0x2c36c7(0x1d0)]==0x0)await sendTelegram(_0x777eb3[_0x2c36c7(0x1b3)]['id'],_0x2c36c7(0x228));else{if(_0x1b82cd[_0x2c36c7(0x1d0)]>0x1){let _0x316244=[],_0x4568b6=[];const _0x49350a=_0x1b82cd[_0x2c36c7(0x1d0)]%0x4==0x0||_0x1b82cd[_0x2c36c7(0x1d0)]%0x4==0x3||_0x1b82cd['length']%0x3==0x1?0x4:0x3;let _0x96f947=0x0;_0x1b82cd[_0x2c36c7(0x1fe)]((_0x7777f7,_0x1ea20c)=>{const _0x5bb9e1=_0x2c36c7;if(_0x1ea20c%_0x49350a==0x0)_0x4568b6=[];_0x4568b6[_0x5bb9e1(0x128)](Markup['button'][_0x5bb9e1(0x1b7)](_0x5bb9e1(0x259)+_0x7777f7[_0x5bb9e1(0x1e9)],_0x5bb9e1(0x138)+_0x7777f7['botID'])),_0x1ea20c%_0x49350a==0x0&&(_0x316244[_0x96f947]=_0x4568b6,_0x96f947++);});const _0x814812=Markup[_0x2c36c7(0x234)](_0x316244);_0x777eb3[_0x2c36c7(0x199)](_0x2c36c7(0x223),_0x814812);}else{const _0xd925ff=_0x1b82cd[0x0][_0x2c36c7(0x1e9)];if(pid[_0xd925ff])pid[_0xd925ff][_0x2c36c7(0x10f)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x2c0f42(0x243)](/portfolio_(.+)/,async _0x5bd968=>{const _0x5bbe6c=_0x2c0f42,_0x1f1898=_0x5bd968[_0x5bbe6c(0x19b)][0x1];_0x5bd968[_0x5bbe6c(0x2d4)]();if(pid[_0x1f1898])pid[_0x1f1898][_0x5bbe6c(0x10f)]({'function':_0x5bbe6c(0x211),'args':null});}),tgBot['command']('logs',async _0x2a5659=>{const _0x3debc4=_0x2c0f42,_0xa82711=_0x3debc4(0x109);await zipFiles(_0xa82711);const _0x587af1=zippath+(_0xa82711+_0x3debc4(0x1bf));_0x2a5659[_0x3debc4(0x202)]({'source':_0x587af1})['then'](()=>{})['catch'](_0x52e9f6=>logger[_0x3debc4(0x157)]('Error\x20sending\x20'+_0xa82711+_0x3debc4(0x1cf),_0x52e9f6));}),tgBot[_0x2c0f42(0xfa)]('backup',async _0xffceb7=>{const _0x16a3af=_0x2c0f42,_0x59bca3='backup';await backupConfigFiles(),await zipFiles(_0x59bca3);const _0x2bd307=zippath+(_0x59bca3+_0x16a3af(0x1bf));_0xffceb7[_0x16a3af(0x202)]({'source':_0x2bd307})[_0x16a3af(0xf5)](()=>{})[_0x16a3af(0x290)](_0x3f13cf=>logger['debug'](_0x16a3af(0x13f)+_0x59bca3+_0x16a3af(0x1cf),_0x3f13cf));}),tgBot['command']('update',async _0x28c74a=>{const _0x366860=_0x2c0f42;await getMessages();if(!updateAvailable)await sendTelegram(_0x28c74a['chat']['id'],_0x366860(0x21b));else{if(!validInstallation)await sendTelegram(_0x28c74a['chat']['id'],_0x366860(0x2bc));else{const _0xcec642=Markup[_0x366860(0x234)]([Markup[_0x366860(0x24e)][_0x366860(0x1b7)](_0x366860(0x1a9),_0x366860(0x2b7)),Markup['button'][_0x366860(0x1b7)]('No',_0x366860(0x235))]);_0x28c74a[_0x366860(0x199)](_0x366860(0x2af),_0xcec642);}}}),tgBot[_0x2c0f42(0x243)](/update_(.+)/,async _0x1b0f29=>{const _0x2a9e39=_0x2c0f42,_0x11e432=_0x1b0f29[_0x2a9e39(0x19b)][0x1];_0x1b0f29[_0x2a9e39(0x2d4)](),_0x11e432=='yes'&&(await sendTelegram(_0x1b0f29[_0x2a9e39(0x1b3)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x2a9e39(0x257))),_0x11e432=='no'&&await sendTelegram(_0x1b0f29[_0x2a9e39(0x1b3)]['id'],_0x2a9e39(0x253));}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0xfc),async _0x5bd598=>{const _0x20b1a2=_0x2c0f42;if(!validInstallation)await sendTelegram(_0x5bd598['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x25e493=Markup[_0x20b1a2(0x234)]([Markup[_0x20b1a2(0x24e)][_0x20b1a2(0x1b7)]('Yes',_0x20b1a2(0x107)),Markup[_0x20b1a2(0x24e)][_0x20b1a2(0x1b7)]('No','reinstall_no')]);_0x5bd598[_0x20b1a2(0x199)](_0x20b1a2(0x26a),_0x25e493);}}),tgBot[_0x2c0f42(0x243)](/reinstall_(.+)/,async _0xd50dbf=>{const _0x564db7=_0x2c0f42,_0x53ac3e=_0xd50dbf[_0x564db7(0x19b)][0x1];_0xd50dbf[_0x564db7(0x2d4)](),_0x53ac3e==_0x564db7(0x123)&&(await sendTelegram(_0xd50dbf[_0x564db7(0x1b3)]['id'],_0x564db7(0x194)),updateBB(_0x564db7(0xfc))),_0x53ac3e=='no'&&await sendTelegram(_0xd50dbf[_0x564db7(0x1b3)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x116),async _0x59a814=>{const _0x2a3201=_0x2c0f42,_0x281dd0=getBotsWithMode();if(_0x281dd0[_0x2a3201(0x1d0)]==0x0)await sendTelegram(_0x59a814['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x203e9d=[],_0x26c464=[];const _0x2176fc=0x2;let _0x21faf3=0x0;_0x281dd0[_0x2a3201(0x1fe)]((_0x2d46f9,_0x5e5750)=>{const _0x442edd=_0x2a3201;if(_0x5e5750%_0x2176fc==0x0)_0x26c464=[];_0x26c464['push'](Markup[_0x442edd(0x24e)][_0x442edd(0x1b7)](_0x442edd(0x259)+_0x2d46f9[_0x442edd(0x1e9)]+'\x20('+_0x2d46f9[_0x442edd(0x292)]+')',_0x442edd(0x1d2)+_0x2d46f9[_0x442edd(0x1e9)])),_0x5e5750%_0x2176fc==0x0&&(_0x203e9d[_0x21faf3]=_0x26c464,_0x21faf3++);});const _0x23b573=Markup[_0x2a3201(0x234)](_0x203e9d);_0x59a814[_0x2a3201(0x199)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x23b573);}}),tgBot[_0x2c0f42(0x243)](/toggle_(.+)/,async _0x2c757e=>{const _0x3141b0=_0x2c0f42,_0x1052d4=_0x2c757e[_0x3141b0(0x19b)][0x1];_0x2c757e[_0x3141b0(0x2d4)]();const _0x4e335f=getBotsWithMode(),_0x43d19e=_0x4e335f[_0x3141b0(0xef)](_0x14cff6=>_0x14cff6['botID']==_0x1052d4),_0x38b449=_0x43d19e[_0x3141b0(0x292)]==_0x3141b0(0x1e6)?'manual':_0x3141b0(0x1e6);await sendTelegram(_0x2c757e[_0x3141b0(0x1b3)]['id'],_0x3141b0(0x154)+_0x1052d4+_0x3141b0(0x100)+_0x38b449+_0x3141b0(0x140)),toggleBotMode(_0x1052d4);}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x2d0),async _0x595cc4=>{const _0x4249a1=_0x2c0f42;let _0x1266a7='';config[_0x4249a1(0x1fe)](_0x53fae7=>{const _0x51107d=_0x4249a1;_0x1266a7+=_0x51107d(0x259)+_0x53fae7['botID']+':\x20'+_0x53fae7['botname']+'\x0a';}),await sendTelegram(_0x595cc4['chat']['id'],_0x1266a7,{'parse_mode':_0x4249a1(0x265)});}),tgBot[_0x2c0f42(0xfa)](_0x2c0f42(0x2c6),async _0x17efa5=>{const _0x69224f=_0x2c0f42;await sendTelegram(_0x17efa5[_0x69224f(0x1b3)]['id'],_0x17901a);}),process[_0x2c0f42(0x2be)](_0x2c0f42(0x21e),()=>tgBot[_0x2c0f42(0x1b5)](_0x2c0f42(0x21e))),process[_0x2c0f42(0x2be)]('SIGTERM',()=>tgBot[_0x2c0f42(0x1b5)](_0x2c0f42(0x152))),tgBot[_0x2c0f42(0x10e)]();}function disableTelegram(){const _0x1410d8=_0x5347cb;tgBot&&tgBot[_0x1410d8(0x1b5)]();}async function sendTelegram(_0x2fa1f4,_0x19a5f0,_0x1f6aa0){const _0x1e17b1=_0x5347cb;_0x1f6aa0={..._0x1f6aa0,'disable_web_page_preview':!![]};try{await tgBot[_0x1e17b1(0x18c)]['sendMessage'](_0x2fa1f4,_0x19a5f0,_0x1f6aa0);}catch(_0x577b45){console[_0x1e17b1(0xf3)]('Telegram\x20error:',_0x577b45);}}async function sendTelegramBot(_0x409933,_0x44eee1){const _0x306d01=_0x5347cb;if(settings['telegramEnabled']){if(settings[_0x306d01(0x1e8)]==_0x306d01(0x27e)||(_0x44eee1[_0x306d01(0x246)]==_0x306d01(0x289)||_0x44eee1['type']==_0x306d01(0x179)||_0x44eee1[_0x306d01(0x246)]=='success')&&settings[_0x306d01(0x1e8)]==_0x306d01(0x17a)||_0x44eee1['type']==_0x306d01(0x2ec)&&settings[_0x306d01(0x1e8)]==_0x306d01(0x19d)){if(tgBot&&settings[_0x306d01(0x27a)]){if(_0x44eee1[_0x306d01(0x172)])await sendTelegram(settings[_0x306d01(0x27a)],_0x44eee1[_0x306d01(0x1b0)]+_0x306d01(0x135)+_0x44eee1[_0x306d01(0x15a)]);else await sendTelegram(settings[_0x306d01(0x27a)],_0x306d01(0x259)+_0x409933+_0x306d01(0x135)+_0x44eee1[_0x306d01(0x15a)]);}}}}async function sendTelegramMsg(_0x4894a6,_0x3f9f1f=_0x5347cb(0x265)){const _0x1d8cfc=_0x5347cb;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x1d8cfc(0x27a)],_0x4894a6,{'parse_mode':_0x3f9f1f}),!![]):![];}function getDeviceWithIp(_0x2fc5c9){const _0x5a09c5=_0x5347cb;return devices[_0x5a09c5(0xef)](_0x3f6bbb=>_0x3f6bbb['ip']===_0x2fc5c9);}async function temporaryAccess2FA(_0x3dc9af,_0x39500f){const _0xca7e07=_0x5347cb;let _0xff32e9=new Date(),_0x153b82=![];if(lastIpApproval){if(_0xff32e9-lastIpApproval<0x1388)_0x153b82=!![];}lastIpApproval=new Date();if(_0x153b82)return;if(tgBot&&settings['telegramChatId']){const _0xc87d86=uuidRandom();tmpStorage[_0xc87d86]={'uuid':_0x3dc9af,'externalip':_0x39500f};const _0x5b4630=Markup[_0xca7e07(0x234)]([Markup['button']['callback']('5\x20min',_0xca7e07(0x222)+_0xc87d86),Markup['button'][_0xca7e07(0x1b7)](_0xca7e07(0xf6),_0xca7e07(0x195)+_0xc87d86),Markup[_0xca7e07(0x24e)][_0xca7e07(0x1b7)]('30\x20min',_0xca7e07(0x2bb)+_0xc87d86),Markup[_0xca7e07(0x24e)][_0xca7e07(0x1b7)](_0xca7e07(0x114),'tempaccess_reject_'+_0xc87d86)]);await sendTelegram(settings[_0xca7e07(0x27a)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x39500f)[_0xca7e07(0x1c4)]+'\x20?',_0x5b4630),tgBot[_0xca7e07(0x243)](/tempaccess_(.+)_(.+)/,async _0x15f258=>{const _0x1cc6bd=_0xca7e07,_0x483eed=_0x15f258[_0x1cc6bd(0x19b)][0x1],_0x4afdb1=_0x15f258[_0x1cc6bd(0x19b)][0x2],{uuid:_0x221e69,externalip:_0x2adb95}=tmpStorage[_0x4afdb1];delete tmpStorage[_0x4afdb1],_0x15f258['editMessageReplyMarkup'](),devices[_0x221e69]['telegramIpApproval']={'clientip':_0x2adb95,'timestamp':new Date()[_0x1cc6bd(0x1f0)](),'expiry':_0x483eed},_0x483eed!='reject'?(await sendTelegram(_0x15f258[_0x1cc6bd(0x1b3)]['id'],_0x1cc6bd(0x2f4)+_0x483eed+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x221e69)[_0x1cc6bd(0x178)]('status',{'access':{'allow':![],'reason':_0x1cc6bd(0x2a8),'token':null}})):(await sendTelegram(_0x15f258[_0x1cc6bd(0x1b3)]['id'],_0x1cc6bd(0x1e5)),io['to'](_0x221e69)['emit'](_0x1cc6bd(0x2eb),{'access':{'allow':![],'reason':_0x1cc6bd(0x1da),'token':null}}));});}}async function loginAccess2FA(_0x4e9bee,_0x3374d0){const _0x471560=_0x5347cb;if(tgBot&&settings[_0x471560(0x27a)]){const _0x301250=uuidRandom();tmpStorage[_0x301250]={'uuid':_0x4e9bee,'externalip':_0x3374d0};const _0x559814=Markup[_0x471560(0x234)]([Markup[_0x471560(0x24e)][_0x471560(0x1b7)](_0x471560(0x130),_0x471560(0x206)+loginExpiry+'_'+_0x301250),Markup[_0x471560(0x24e)]['callback'](_0x471560(0x114),'login2fa_reject_'+_0x301250)]);await sendTelegram(settings[_0x471560(0x27a)],_0x471560(0x196)+normalizeIP(_0x3374d0)[_0x471560(0x1c4)]+'\x20?',_0x559814),tgBot[_0x471560(0x243)](/login2fa_(.+)_(.+)/,async _0x2e3ebf=>{const _0x3773a3=_0x471560,_0x3a8313=_0x2e3ebf[_0x3773a3(0x19b)][0x1],_0x9c90d9=_0x2e3ebf[_0x3773a3(0x19b)][0x2],{uuid:_0x58edf7,externalip:_0x685ec}=tmpStorage[_0x9c90d9];delete tmpStorage[_0x9c90d9],_0x2e3ebf[_0x3773a3(0x2d4)](),devices[_0x58edf7][_0x3773a3(0x1f7)]={'clientip':_0x685ec,'timestamp':new Date()[_0x3773a3(0x1f0)](),'expiry':_0x3a8313},_0x3a8313!='reject'?(await sendTelegram(_0x2e3ebf[_0x3773a3(0x1b3)]['id'],_0x3773a3(0x15e),{'parse_mode':_0x3773a3(0x265)}),io['to'](_0x58edf7)[_0x3773a3(0x178)](_0x3773a3(0x2eb),{'access':{'allow':![],'reason':_0x3773a3(0x2a8),'token':null}})):(await sendTelegram(_0x2e3ebf['chat']['id'],_0x3773a3(0x143)),io['to'](_0x58edf7)[_0x3773a3(0x178)]('status',{'access':{'allow':![],'reason':_0x3773a3(0x1ef),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xfd25e6=_0x5347cb;return dbConfig['get']('bots')[_0xfd25e6(0x144)](_0xfd25e6(0x1e9))[_0xfd25e6(0x1b8)]({'status':_0xfd25e6(0x1b9)})[_0xfd25e6(0x10a)]()||[];}function getDisabledBots(){const _0x54c639=_0x5347cb;return dbConfig[_0x54c639(0x23c)](_0x54c639(0x115))['sortBy'](_0x54c639(0x1e9))[_0x54c639(0x1b8)]({'status':_0x54c639(0x2b1)})['value']()||[];}function getBotAttributes(_0xddbc84){const _0x1b51f5=_0x5347cb;let _0x4e5ffe={};const _0x435381=configpath+'bot-'+_0xddbc84+'-config.json',_0x1a0d92=fs[_0x1b51f5(0x1cb)](_0x435381);if(_0x1a0d92){const _0x4b7ec1=fs[_0x1b51f5(0x112)](_0x435381);try{const _0x8235f8=JSON['parse'](_0x4b7ec1),_0x5c3fa3=_0x8235f8?_0x8235f8['bot'][0x0][_0x1b51f5(0x16a)]:![];_0x4e5ffe[_0x1b51f5(0x292)]=_0x5c3fa3?'auto':_0x1b51f5(0x1c5),_0x4e5ffe[_0x1b51f5(0x1b0)]=_0x8235f8?_0x8235f8[_0x1b51f5(0x182)][0x0][_0x1b51f5(0x1b0)]:_0x1b51f5(0x259)+_0xddbc84;}catch(_0x61fafb){_0x4e5ffe[_0x1b51f5(0x292)]=_0x1b51f5(0x1c5),_0x4e5ffe['botname']=_0x1b51f5(0x259)+_0xddbc84;}}else _0x4e5ffe[_0x1b51f5(0x292)]='manual',_0x4e5ffe['botname']='Bot\x20'+_0xddbc84;return _0x4e5ffe;}function getBotsWithMode(){const _0x4e37f3=_0x5347cb,_0x2553e3=dbConfig[_0x4e37f3(0x23c)](_0x4e37f3(0x115))[_0x4e37f3(0x144)](_0x4e37f3(0x1e9))[_0x4e37f3(0x10a)]()||[];return _0x2553e3[_0x4e37f3(0x1fe)](_0x235983=>{const _0x3646ff=_0x4e37f3;let _0x2552e4=getBotAttributes(_0x235983['botID']);_0x235983[_0x3646ff(0x292)]=_0x2552e4['mode'];}),_0x2553e3;}function getBotExchanges(){const _0x40b4c6=_0x5347cb;let _0x59c322=[];const _0x47e3fa=dbConfig[_0x40b4c6(0x23c)](_0x40b4c6(0x115))[_0x40b4c6(0x144)]('botID')['value']()||[];_0x47e3fa[_0x40b4c6(0x1fe)](_0x2d6221=>{const _0x274d3c=_0x40b4c6;if(_0x2d6221[_0x274d3c(0x2eb)]==_0x274d3c(0x1b9)){const _0x1a5ca1=configpath+_0x274d3c(0x1fa)+_0x2d6221[_0x274d3c(0x1e9)]+'-config.json',_0x1ab01a=fs[_0x274d3c(0x1cb)](_0x1a5ca1);let _0x52e61f;if(_0x1ab01a){const _0x413c7b=fs[_0x274d3c(0x112)](_0x1a5ca1);try{const _0x13ac01=JSON[_0x274d3c(0x275)](_0x413c7b);_0x52e61f=_0x13ac01?_0x13ac01['bot'][0x0]['exchange']:null;}catch(_0xfac728){}}if(_0x52e61f)_0x59c322[_0x274d3c(0x128)](_0x52e61f);}});const _0x305ccf=[...new Set(_0x59c322)][_0x40b4c6(0x29b)]();return _0x305ccf;}async function initUser(){const _0x39190e=_0x5347cb;if(!settings[_0x39190e(0x17c)]){const _0x34ecb2=uuidRandom();mixpanel['alias'](_0x34ecb2),updateSetting('userid',_0x34ecb2);}}async function initSecure(){const _0x42b6bc=_0x5347cb;let _0x52a267=getSecure();if(!_0x52a267[_0x42b6bc(0x134)]('secret')){let _0x440cab=await generateKeys();_0x52a267[_0x42b6bc(0x174)]=_0x440cab[_0x42b6bc(0x174)],_0x52a267[_0x42b6bc(0x2bf)]=_0x440cab['privateKey'],_0x52a267['secret']=crypto[_0x42b6bc(0x163)](0x20)['toString'](_0x42b6bc(0x11a));;storeSecure(_0x52a267);}}function getSettings(){const _0x5722b1=_0x5347cb;return dbSettings[_0x5722b1(0x23c)]('settings')[_0x5722b1(0x10a)]()||{};}function getSecure(){const _0x2f4958=_0x5347cb;return dbSecure[_0x2f4958(0x23c)](_0x2f4958(0x1ba))[_0x2f4958(0x10a)]()||{};}function getBlacklist(){const _0x594a20=_0x5347cb;return dbSecure['get'](_0x594a20(0x106))[_0x594a20(0x10a)]()||[];}function broadcastToBots(_0x36b5cf,_0x26397f){const _0x285a07=_0x5347cb;config[_0x285a07(0x1fe)](_0x6c3fd7=>{const _0x3b2951=_0x285a07;if(_0x6c3fd7['status']==_0x3b2951(0x1b9)&&_0x6c3fd7[_0x3b2951(0x215)]=='running'||_0x6c3fd7['status']==_0x3b2951(0x29e)&&_0x6c3fd7[_0x3b2951(0x215)]=='running'){if(pid[_0x6c3fd7[_0x3b2951(0x1e9)]])pid[_0x6c3fd7[_0x3b2951(0x1e9)]][_0x3b2951(0x10f)]({[_0x36b5cf]:_0x26397f});}});}async function storeSettings(_0x573896,_0x41e7c1=![]){const _0x11af78=_0x5347cb;_0x573896={...settings,..._0x573896};if(_0x41e7c1&&_0x573896['bbPassword']!=_0x11af78(0x159)&&_0x573896[_0x11af78(0x18e)]!=_0x11af78(0x1a8)&&_0x573896['bbPassword']!=''){const _0x39d4d0=decryptRSA(secure[_0x11af78(0x2bf)],_0x573896[_0x11af78(0x18e)])[_0x11af78(0xf7)](_0x11af78(0x274))[0x0],_0x3556bc=bcrypt['hashSync'](_0x39d4d0,saltRounds);_0x573896={..._0x573896,'bbPassword':_0x3556bc};}if(_0x41e7c1&&_0x573896[_0x11af78(0x198)]!=_0x11af78(0x159)&&_0x573896[_0x11af78(0x198)]!=_0x11af78(0x1a8)&&_0x573896[_0x11af78(0x198)]!=''){const _0x3c56fe=decryptRSA(secure[_0x11af78(0x2bf)],_0x573896[_0x11af78(0x198)])[_0x11af78(0xf7)](_0x11af78(0x274))[0x0];_0x573896={..._0x573896,'telegramToken':_0x3c56fe};}if(_0x41e7c1&&_0x573896[_0x11af78(0x12a)]!=_0x11af78(0x159)&&_0x573896[_0x11af78(0x12a)]!=_0x11af78(0x1a8)&&_0x573896[_0x11af78(0x12a)]!=''){const _0x30ac92=decryptRSA(secure[_0x11af78(0x2bf)],_0x573896[_0x11af78(0x12a)])[_0x11af78(0xf7)](_0x11af78(0x274))[0x0];_0x573896={..._0x573896,'marketcapApi':_0x30ac92};}const _0x47c9c9=_0x573896[_0x11af78(0x198)]!='************'&&_0x573896[_0x11af78(0x198)]!=settings['telegramToken']||_0x573896['telegramUsername']!=settings[_0x11af78(0x1b2)],_0x46d44c=_0x573896['telegramToken']==''||_0x573896[_0x11af78(0x1b2)]=='',_0x22f5cc=_0x573896['marketcapApi']&&_0x573896['marketcapApi']!='************'&&_0x573896['marketcapApi']!=settings[_0x11af78(0x198)];_0x47c9c9&&(_0x573896['telegramChatId']=null,_0x573896['telegramEvents']=_0x11af78(0x27e));for(const [_0x19cae1,_0xbf7f0e]of Object[_0x11af78(0x10d)](_0x573896)){if(_0x19cae1==_0x11af78(0x198)&&_0xbf7f0e=='************'){_0x573896[_0x11af78(0x198)]=settings[_0x11af78(0x198)];continue;};if(_0x19cae1==_0x11af78(0x18e)&&_0xbf7f0e==_0x11af78(0x159)){_0x573896[_0x11af78(0x18e)]=settings['bbPassword'];continue;};if(_0x19cae1==_0x11af78(0x12a)&&_0xbf7f0e==_0x11af78(0x159)){_0x573896[_0x11af78(0x12a)]=settings[_0x11af78(0x12a)];continue;};dbSettings['set'](_0x11af78(0x29a)+_0x19cae1,_0xbf7f0e)[_0x11af78(0x2d7)]();}settings=_0x573896,io['to'](_0x11af78(0x183))[_0x11af78(0x178)](_0x11af78(0x166),cleanSettings()),broadcastToBots('timeshift',settings[_0x11af78(0x18a)]),broadcastToBots(_0x11af78(0x266),settings['onepagemode']),broadcastToBots(_0x11af78(0x12a),settings[_0x11af78(0x12a)]);if(_0x47c9c9&&!_0x46d44c)initTelegram();if(_0x47c9c9&&_0x46d44c)disableTelegram();getAllClients()[_0x11af78(0x1fe)](_0x137592=>{const _0x44c77e=_0x11af78;getSocket(_0x137592['id'])['emit'](_0x44c77e(0x2eb),{'access':{'allow':![],'reason':_0x44c77e(0x2a8),'token':null}});}),_0x22f5cc&&(await sleep(0xbb8),testMarketcapApi(_0x573896[_0x11af78(0x12a)]));}async function testMarketcapApi(_0x20958b){const _0x2cff67=_0x5347cb,_0x5eeda9=[_0x2cff67(0x2d9),_0x2cff67(0x19e)];try{await axios[_0x2cff67(0x23c)](_0x2cff67(0x167),{'headers':{'X-CMC_PRO_API_KEY':_0x20958b},'params':{'symbol':_0x5eeda9[_0x2cff67(0x1ff)]()}});}catch(_0x2fa647){_0x2fa647[_0x2cff67(0x1ff)]()['includes'](_0x2cff67(0x146))?(io['to']('botmanager')[_0x2cff67(0x178)]('notification','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x2cff67(0x101)](_0x2cff67(0x2cc))):(io['to']('botmanager')[_0x2cff67(0x178)](_0x2cff67(0xe8),_0x2cff67(0xeb)),logger[_0x2cff67(0x101)](_0x2cff67(0xeb)),logger['debug'](_0x2cff67(0x26f),_0x2fa647[_0x2cff67(0x1ff)]()+_0x2cff67(0x1eb)+_0x2fa647[_0x2cff67(0x2a6)]));return;}logger[_0x2cff67(0x157)](_0x2cff67(0x224));}function updateSetting(_0x28cbbd,_0x141720){const _0x32263a=_0x5347cb;dbSettings[_0x32263a(0x19f)](_0x32263a(0x29a)+_0x28cbbd,_0x141720)['write'](),settings=getSettings(),io['to']('botmanager')[_0x32263a(0x178)](_0x32263a(0x166),cleanSettings());}function storeSecure(_0x21450d){const _0x11bed8=_0x5347cb;dbSecure[_0x11bed8(0x23c)](_0x11bed8(0x1ba))[_0x11bed8(0x128)](_0x21450d)['write'](),secure=_0x21450d;}function addBlacklist(_0x96024c){const _0x4d0f6f=_0x5347cb;cleanBlacklist();let _0x154692;devices[_0x96024c][_0x4d0f6f(0x118)]?_0x154692=Math['max'](devices[_0x96024c]['telegramIpApproval'][_0x4d0f6f(0x1f3)],loginExpiry):_0x154692=loginExpiry,dbSecure[_0x4d0f6f(0x23c)](_0x4d0f6f(0x106))[_0x4d0f6f(0x128)]({'expiry':new Date()[_0x4d0f6f(0x1f0)]()+_0x154692*0x3c*0x3e8,'token':devices[_0x96024c][_0x4d0f6f(0x1d1)][_0x4d0f6f(0x1de)]})[_0x4d0f6f(0x2d7)](),blacklist=dbSecure[_0x4d0f6f(0x23c)]('blacklist')[_0x4d0f6f(0x10a)]();}function cleanBlacklist(){const _0x24d0ac=_0x5347cb;let _0x409fef=dbSecure[_0x24d0ac(0x23c)](_0x24d0ac(0x106))[_0x24d0ac(0xf9)]()[_0x24d0ac(0x10a)](),_0x447e61=new Date()[_0x24d0ac(0x1f0)]();_0x409fef['forEach'](_0xb01207=>{const _0x282e40=_0x24d0ac;_0xb01207[_0x282e40(0x1f3)]<_0x447e61&&dbSecure[_0x282e40(0x23c)](_0x282e40(0x106))['remove']({'expiry':_0xb01207[_0x282e40(0x1f3)]})[_0x282e40(0x2d7)]();});}function initStates(){const _0x449e1c=_0x5347cb;let _0x41be6c=getConfiguration();_0x41be6c[_0x449e1c(0x1fe)](_0x104df6=>{const _0x35dab3=_0x449e1c;_0x104df6[_0x35dab3(0x215)]='stopped';}),storeConfiguration(_0x41be6c);}async function generateKeys(){const _0x9c4c20=_0x5347cb,_0x4904e0=forge[_0x9c4c20(0x2cf)][_0x9c4c20(0x2e1)][_0x9c4c20(0x230)]({'bits':0x1000,'e':0x10001}),_0x208cf3=forge[_0x9c4c20(0x2cf)]['privateKeyToPem'](_0x4904e0[_0x9c4c20(0x2bf)]),_0x1ffd47=forge[_0x9c4c20(0x2cf)][_0x9c4c20(0x272)](_0x4904e0['publicKey']);return{'privateKey':_0x208cf3,'publicKey':_0x1ffd47};}async function oneTimeMigration(){const _0x4baf20=_0x5347cb;let _0x4bedd7=getSettings(),_0x13d39e=![];!_0x4bedd7['hasOwnProperty'](_0x4baf20(0x267))&&(_0x4bedd7['lastmsgtelegram']=0x0,_0x13d39e=!![]);!_0x4bedd7[_0x4baf20(0x134)](_0x4baf20(0x27b))&&(_0x4bedd7[_0x4baf20(0x27b)]=0x0,_0x13d39e=!![]);!_0x4bedd7[_0x4baf20(0x134)](_0x4baf20(0x210))&&(_0x4bedd7[_0x4baf20(0x210)]=_0x4baf20(0x1cc),_0x13d39e=!![]);!_0x4bedd7[_0x4baf20(0x134)](_0x4baf20(0x266))&&(_0x4bedd7[_0x4baf20(0x266)]=![],_0x13d39e=!![]);!_0x4bedd7[_0x4baf20(0x134)](_0x4baf20(0x12a))&&(_0x4bedd7[_0x4baf20(0x12a)]='',_0x13d39e=!![]);if(_0x13d39e)storeSettings(_0x4bedd7);try{fs[_0x4baf20(0x16f)](configbackuppath,{'withFileTypes':!![]})[_0x4baf20(0x1fe)](_0x5a042c=>{const _0x4a11d2=_0x4baf20;if(!_0x5a042c[_0x4a11d2(0x2ce)]()){if(!_0x5a042c[_0x4a11d2(0x245)][_0x4a11d2(0x25c)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x5a042c[_0x4a11d2(0x245)]);}else fs[_0x4a11d2(0x284)](configbackuppath+_0x5a042c['name'],{'recursive':!![]});});}catch(_0x32263f){logger['debug'](_0x4baf20(0x153),_0x32263f);}}function storeConfiguration(_0xbbfcbc){const _0x2a4f65=_0x5347cb;dbConfig[_0x2a4f65(0x23c)](_0x2a4f65(0x115))[_0x2a4f65(0x2b2)]()[_0x2a4f65(0x2d7)](),dbConfig['get'](_0x2a4f65(0x115))[_0x2a4f65(0x128)](..._0xbbfcbc)[_0x2a4f65(0x2d7)](),config=_0xbbfcbc;}async function resetPassword(){const _0x4d2b16=_0x5347cb;if(tgBot&&settings[_0x4d2b16(0x27a)]){const _0x300d95=Markup[_0x4d2b16(0x234)]([Markup[_0x4d2b16(0x24e)][_0x4d2b16(0x1b7)](_0x4d2b16(0x123),_0x4d2b16(0x2b6)),Markup[_0x4d2b16(0x24e)]['callback']('no','resetpw_no')]);await sendTelegram(settings[_0x4d2b16(0x27a)],_0x4d2b16(0x2dd),_0x300d95),tgBot[_0x4d2b16(0x243)](/resetpw_(.+)/,async _0xdad7af=>{const _0x6bb350=_0x4d2b16,_0x369f0b=_0xdad7af[_0x6bb350(0x19b)][0x1];_0xdad7af[_0x6bb350(0x2d4)]();if(_0x369f0b!='no'){const _0x2ab447=0xf,_0x373a01=_0x6bb350(0x1e4),_0x52b43a=Array[_0x6bb350(0x12b)](crypto[_0x6bb350(0x2e2)](new Uint32Array(_0x2ab447)))['map'](_0x49a1c1=>_0x373a01[_0x49a1c1%_0x373a01[_0x6bb350(0x1d0)]])[_0x6bb350(0x241)](''),_0x12a77e=bcrypt[_0x6bb350(0x1e7)](_0x52b43a,saltRounds);storeSettings({'bbPassword':_0x12a77e}),await sendTelegram(_0xdad7af[_0x6bb350(0x1b3)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x52b43a,{'parse_mode':_0x6bb350(0x265)});}else await sendTelegram(_0xdad7af[_0x6bb350(0x1b3)]['id'],_0x6bb350(0x1e1));});}}async function confirmRestore(_0x1e3dc2,_0x38f7f6){const _0x7ef8ac=_0x5347cb;io['to'](_0x7ef8ac(0x183))[_0x7ef8ac(0x178)](_0x7ef8ac(0xe8),_0x7ef8ac(0x29d),_0x7ef8ac(0x2bd));if(tgBot&&settings[_0x7ef8ac(0x27a)]){const _0x985dd2=uuidRandom();tmpStorage[_0x985dd2]={'path':_0x1e3dc2,'filename':_0x38f7f6};const _0x30d592=Markup[_0x7ef8ac(0x234)]([Markup[_0x7ef8ac(0x24e)][_0x7ef8ac(0x1b7)](_0x7ef8ac(0x123),_0x7ef8ac(0x1dc)+_0x985dd2),Markup[_0x7ef8ac(0x24e)][_0x7ef8ac(0x1b7)]('no',_0x7ef8ac(0x124)+_0x985dd2)]);await sendTelegram(settings[_0x7ef8ac(0x27a)],_0x7ef8ac(0x1f9),_0x30d592),tgBot[_0x7ef8ac(0x243)](/restore_(.+)_(.+)/,async _0xff4a4e=>{const _0x34ea35=_0x7ef8ac,_0x519f0=_0xff4a4e[_0x34ea35(0x19b)][0x1],_0x1cdca9=_0xff4a4e['match'][0x2],{path:_0x130605,filename:_0x2b88af}=tmpStorage[_0x1cdca9];delete tmpStorage[_0x1cdca9],_0xff4a4e[_0x34ea35(0x2d4)](),_0x519f0=='yes'?(logger['debug'](_0x34ea35(0x1f1)),await sendTelegram(_0xff4a4e['chat']['id'],_0x34ea35(0x1a5),{'parse_mode':'HTML'}),unzipFile(_0x130605,_0x2b88af)):(logger[_0x34ea35(0x157)](_0x34ea35(0x171)),await sendTelegram(_0xff4a4e[_0x34ea35(0x1b3)]['id'],_0x34ea35(0x171)));});}}function getServerTime(){const _0x4949d3=_0x5347cb,_0x512ba6=new Date();return _0x512ba6[_0x4949d3(0x23e)]()+'/'+(_0x512ba6[_0x4949d3(0x1bb)]()+0x1)[_0x4949d3(0x1ff)]()[_0x4949d3(0xea)](0x2,'0')+'/'+_0x512ba6[_0x4949d3(0xff)]()[_0x4949d3(0x1ff)]()[_0x4949d3(0xea)](0x2,'0')+'\x20'+_0x512ba6['getHours']()[_0x4949d3(0x1ff)]()[_0x4949d3(0xea)](0x2,'0')+':'+_0x512ba6[_0x4949d3(0x220)]()[_0x4949d3(0x1ff)]()[_0x4949d3(0xea)](0x2,'0')+':'+_0x512ba6[_0x4949d3(0x2ac)]()[_0x4949d3(0x1ff)]()[_0x4949d3(0xea)](0x2,'0');}function getTimeStamp(){const _0x126a52=_0x5347cb,_0x2a481b=shiftedTime();return _0x2a481b[_0x126a52(0x23e)]()+'/'+(_0x2a481b['getMonth']()+0x1)[_0x126a52(0x1ff)]()['padStart'](0x2,'0')+'/'+_0x2a481b[_0x126a52(0xff)]()[_0x126a52(0x1ff)]()[_0x126a52(0xea)](0x2,'0')+'\x20'+_0x2a481b[_0x126a52(0x17f)]()[_0x126a52(0x1ff)]()[_0x126a52(0xea)](0x2,'0')+':'+_0x2a481b[_0x126a52(0x220)]()['toString']()[_0x126a52(0xea)](0x2,'0')+':'+_0x2a481b[_0x126a52(0x2ac)]()['toString']()[_0x126a52(0xea)](0x2,'0');}function getCleanTimeStamp(){const _0x405984=_0x5347cb,_0x3f094f=shiftedTime();return _0x3f094f[_0x405984(0x23e)]()+(_0x3f094f[_0x405984(0x1bb)]()+0x1)[_0x405984(0x1ff)]()[_0x405984(0xea)](0x2,'0')+_0x3f094f[_0x405984(0xff)]()['toString']()[_0x405984(0xea)](0x2,'0')+'-'+_0x3f094f[_0x405984(0x17f)]()[_0x405984(0x1ff)]()[_0x405984(0xea)](0x2,'0')+_0x3f094f[_0x405984(0x220)]()[_0x405984(0x1ff)]()[_0x405984(0xea)](0x2,'0')+_0x3f094f[_0x405984(0x2ac)]()['toString']()[_0x405984(0xea)](0x2,'0');}function shiftedTime(){const _0xe41001=_0x5347cb,_0xdc600=new Date();let _0x4af705=_0xdc600;if(settings[_0xe41001(0x18a)]&&settings[_0xe41001(0x18a)]!==0x0)_0x4af705=fns[_0xe41001(0x2c7)](_0xdc600,{'hours':settings[_0xe41001(0x18a)]});return _0x4af705;}async function startScheduler(){const _0x1e80b6=_0x5347cb,_0x38f115=new Date()[_0x1e80b6(0x237)](),_0x51a491=shiftedTime()['getHours']();_0x51a491==0x4&&backupConfigFiles(),_0x51a491==0x0&&(rotateLogFiles(),logger['debug'](_0x1e80b6(0x1af)),logger[_0x1e80b6(0x157)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x1e80b6(0x2c4)+(environment==_0x1e80b6(0x2c2)?_0x1e80b6(0xec):'')),logger[_0x1e80b6(0x157)](_0x1e80b6(0x1af))),_0x38f115%0x6==0x0&&triggerAnalytics(),_0x38f115%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x480f20){const _0x2cf868=_0x5347cb;logger[_0x2cf868(0x157)]('Restore\x20backup\x20file\x20'+_0x480f20);const _0x5cfad4=getBotsWithMode();_0x5cfad4[_0x2cf868(0x1d0)]>0x0?confirmRestore(configbackuppath,_0x480f20):unzipFile(configbackuppath,_0x480f20);}async function getBackupFiles(_0x28cc68=null){const _0x5a6fa1=_0x5347cb;let _0x42c913=[],_0x3b3524=fs[_0x5a6fa1(0x16f)](configbackuppath,{'withFileTypes':!![]});_0x3b3524['sort']((_0x30762e,_0x19b320)=>_0x30762e[_0x5a6fa1(0x245)]<_0x19b320[_0x5a6fa1(0x245)]?0x1:_0x19b320[_0x5a6fa1(0x245)]<_0x30762e[_0x5a6fa1(0x245)]?-0x1:0x0),_0x3b3524[_0x5a6fa1(0x1fe)](_0x465ea9=>{const _0x417b05=_0x5a6fa1;if(!_0x465ea9[_0x417b05(0x2ce)]()&&_0x465ea9['name'][_0x417b05(0x25c)](_0x417b05(0x1ea))&&_0x465ea9[_0x417b05(0x245)][_0x417b05(0x2ba)]('.zip')){const _0x134814=formatDate(fs[_0x417b05(0x2e8)](configbackuppath+_0x465ea9[_0x417b05(0x245)])[_0x417b05(0x28d)]);_0x42c913[_0x417b05(0x128)]({'name':_0x465ea9[_0x417b05(0x245)],'mtime':_0x134814});}});if(_0x28cc68)io['to'](_0x28cc68)['emit']('backup-files',_0x42c913);else return _0x42c913;}async function backupConfigFiles(){const _0x4c305=_0x5347cb;await zipFiles(_0x4c305(0x2c0));const _0x27c820=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x4c305(0x110),configbackuppath+(_0x4c305(0x1ea)+_0x27c820+_0x4c305(0x1bf)));let _0x559c73=fs[_0x4c305(0x16f)](configbackuppath,{'withFileTypes':!![]});_0x559c73['sort']((_0x1bb88d,_0x28287f)=>_0x1bb88d[_0x4c305(0x245)]<_0x28287f[_0x4c305(0x245)]?0x1:_0x28287f['name']<_0x1bb88d['name']?-0x1:0x0),_0x559c73[_0x4c305(0x1d0)]>maxBackups&&fs[_0x4c305(0x1c0)](configbackuppath+_0x559c73[_0x559c73[_0x4c305(0x1d0)]-0x1]['name']);}function rotateLogFiles(){const _0x40564c=_0x5347cb,_0x545a0e=fs[_0x40564c(0x2e8)](logspath+'output-000.log'),_0x25c8a8=_0x545a0e['size']/0x400;if(_0x25c8a8>0x64){let _0x455727=fs[_0x40564c(0x16f)](logspath,{'withFileTypes':!![]});_0x455727[_0x40564c(0x29b)]((_0x150ec7,_0x35d79f)=>_0x150ec7[_0x40564c(0x245)]<_0x35d79f[_0x40564c(0x245)]?0x1:_0x35d79f[_0x40564c(0x245)]<_0x150ec7[_0x40564c(0x245)]?-0x1:0x0),_0x455727[_0x40564c(0x1fe)](_0x20b3ec=>{const _0xa969aa=_0x40564c;if(_0x20b3ec[_0xa969aa(0x245)]==_0xa969aa(0x119))fs[_0xa969aa(0x111)](logspath+_0x20b3ec[_0xa969aa(0x245)],logspath+_0xa969aa(0x2df));if(_0x20b3ec['name']=='output-001.log')fs[_0xa969aa(0x111)](logspath+_0x20b3ec[_0xa969aa(0x245)],logspath+_0xa969aa(0x119));_0x20b3ec[_0xa969aa(0x245)]=='output-000.log'&&(fs[_0xa969aa(0x111)](logspath+_0x20b3ec[_0xa969aa(0x245)],logspath+_0xa969aa(0x1d6)),fs[_0xa969aa(0x29f)](logspath+_0x20b3ec['name'],''));});}}async function zipFiles(_0x19da29){const _0x433e25=_0x5347cb;let _0x52b3eb;if(_0x19da29==_0x433e25(0x109))_0x52b3eb=logspath;if(_0x19da29==_0x433e25(0x263))_0x52b3eb=configpath;if(_0x19da29==_0x433e25(0x2c0))_0x52b3eb=configpath;let _0x28420f=fs[_0x433e25(0x16f)](_0x52b3eb,{'withFileTypes':!![]});const _0x30176a=new JSZip();_0x28420f['forEach'](_0x20b2f0=>{const _0x2dc345=_0x433e25;if(!_0x20b2f0['isDirectory']()){let _0x1b1cba=fs[_0x2dc345(0x112)](_0x52b3eb+_0x20b2f0[_0x2dc345(0x245)]);if(_0x19da29==_0x2dc345(0x263)){const _0x289214=/^bot-[0-9]{3}-config.json$/,_0x4600a0=_0x289214[_0x2dc345(0x26c)](_0x20b2f0[_0x2dc345(0x245)]);if(_0x4600a0){const _0x53cc3d=JSON[_0x2dc345(0x275)](_0x1b1cba);if(_0x53cc3d['bot'][0x0]){_0x53cc3d[_0x2dc345(0x182)][0x0][_0x2dc345(0x270)]=_0x2dc345(0x1a8),_0x53cc3d[_0x2dc345(0x182)][0x0]['apiSecret']=_0x2dc345(0x1a8);if(_0x53cc3d[_0x2dc345(0x182)][0x0][_0x2dc345(0x2c5)])_0x53cc3d[_0x2dc345(0x182)][0x0][_0x2dc345(0x2c5)]=_0x2dc345(0x1a8);}_0x1b1cba=JSON[_0x2dc345(0x2d5)](_0x53cc3d,null,0x2);}if(_0x20b2f0[_0x2dc345(0x245)]==_0x2dc345(0x2de)){const _0x2c558c=JSON['parse'](_0x1b1cba);if(_0x2c558c['settings'][_0x2dc345(0x24f)])_0x2c558c[_0x2dc345(0x166)][_0x2dc345(0x24f)]=![];if(_0x2c558c[_0x2dc345(0x166)][_0x2dc345(0x18e)])_0x2c558c['settings'][_0x2dc345(0x18e)]=_0x2dc345(0x1a8);if(_0x2c558c[_0x2dc345(0x166)]['telegramToken'])_0x2c558c[_0x2dc345(0x166)]['telegramToken']=_0x2dc345(0x1a8);if(_0x2c558c['settings']['telegramChatId'])_0x2c558c['settings'][_0x2dc345(0x27a)]=null;if(_0x2c558c[_0x2dc345(0x166)][_0x2dc345(0x12a)])_0x2c558c['settings'][_0x2dc345(0x12a)]=_0x2dc345(0x1a8);_0x1b1cba=JSON[_0x2dc345(0x2d5)](_0x2c558c,null,0x2);}if(_0x20b2f0['name']!=_0x2dc345(0x16c))_0x30176a[_0x2dc345(0x12c)](_0x20b2f0[_0x2dc345(0x245)],_0x1b1cba);}else _0x30176a[_0x2dc345(0x12c)](_0x20b2f0[_0x2dc345(0x245)],_0x1b1cba);}});const _0x327b0e=await _0x30176a[_0x433e25(0x14a)]({'type':'string','base64':![],'compression':_0x433e25(0x2b0)});fs[_0x433e25(0x29f)](zippath+(_0x19da29+_0x433e25(0x1bf)),_0x327b0e,_0x433e25(0x1cd));}async function unzipFile(_0xefaf9,_0x1f8898){const _0x95812a=_0x5347cb;fs[_0x95812a(0x16f)](configpath,{'withFileTypes':!![]})[_0x95812a(0x1fe)](_0x29149b=>{const _0x4d0b63=_0x95812a;if(!_0x29149b[_0x4d0b63(0x2ce)]())fs['rmSync'](configpath+_0x29149b[_0x4d0b63(0x245)]);});const _0x5d7b2=fs[_0x95812a(0x112)](_0xefaf9+_0x1f8898,_0x95812a(0x1cd)),_0x407c18=await JSZip['loadAsync'](_0x5d7b2,{'base64':![],'checkCRC32':!![]});for(const _0x10c79f of Object[_0x95812a(0x1f8)](_0x407c18[_0x95812a(0x285)])){const _0x1ca569=_0x407c18[_0x95812a(0x285)][_0x10c79f],_0x1fd19b=await _0x1ca569[_0x95812a(0xfd)](_0x95812a(0x141));fs[_0x95812a(0x29f)](configpath+_0x1ca569['name'],_0x1fd19b);}fs[_0x95812a(0x16f)](temppath,{'withFileTypes':!![]})['forEach'](_0x4202fe=>{const _0x3218b4=_0x95812a;if(!_0x4202fe[_0x3218b4(0x2ce)]())fs['rmSync'](temppath+_0x4202fe['name']);}),logger[_0x95812a(0x157)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x95812a(0x10f)]({'restore':!![]},_0x50585e=>{});}async function getPublicIp(){const _0x27e5a8=_0x5347cb;try{const _0x33380b=await axios['get'](_0x27e5a8(0x271));publicip=_0x33380b[_0x27e5a8(0x2ef)]['ip'];}catch(_0x111d79){}}async function triggerAnalytics(){const _0x3ecdf7=_0x5347cb;if(!publicip)await getPublicIp();const _0x5414ca=getBotsWithMode();let _0x15e2b3=0x0;_0x5414ca[_0x3ecdf7(0x1fe)](_0x50f703=>{const _0x5a5f11=_0x3ecdf7;if(_0x50f703[_0x5a5f11(0x2eb)]==='enabled')_0x15e2b3++;});const _0x44d4b4=getBotExchanges();mixpanel[_0x3ecdf7(0x248)](_0x3ecdf7(0x1a3),{'distinct_id':settings[_0x3ecdf7(0x17c)],'ip':publicip,'version':serverversion,'numbots':_0x5414ca['length'],'numbotsenabled':_0x15e2b3,'exchanges':_0x44d4b4,'environment':environment});}async function getMessages(){const _0x5b3e62=_0x5347cb,_0x54c75f='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4ba02c=new GraphQLClient(_0x54c75f),_0x5b2dcc={'authorization':_0x5b3e62(0x212)},_0x1a94a3=serverversion[_0x5b3e62(0xf7)]('.'),_0x1819b3=_0x1a94a3[0x0]+'.'+_0x1a94a3[0x1],_0xab8cd6=Math['min'](settings[_0x5b3e62(0x267)],settings['lastmsgemitted']),_0x180a69={'last':parseInt(_0xab8cd6),'bbm':_0x1819b3},_0x2599f4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5b521e;try{_0x5b521e=await _0x4ba02c['request'](_0x2599f4,_0x180a69,_0x5b2dcc);}catch(_0x362fe5){}if(_0x5b521e&&_0x5b521e[_0x5b3e62(0x279)]){let _0x2d2170=settings[_0x5b3e62(0x267)];newMessages=[];for(const _0x4592ce of _0x5b521e[_0x5b3e62(0x279)]){newMessages[_0x5b3e62(0x128)](_0x4592ce);let _0x3c4d89=![];_0x4592ce[_0x5b3e62(0xf4)]&&(updateSetting(_0x5b3e62(0x210),_0x4592ce['bbvNew']),_0x3c4d89=isNewerVersion(serverversion,_0x4592ce[_0x5b3e62(0xf4)])||serverversion==_0x4592ce['bbvNew']);if(!_0x3c4d89&&_0x4592ce[_0x5b3e62(0x184)]>_0x2d2170){if(_0x4592ce['bbvReceive']==='any'||serverversion[_0x5b3e62(0x25c)](_0x4592ce[_0x5b3e62(0xf1)])){let _0x1cc858=''+_0x4592ce['title']+'\x0a\x0a'+_0x4592ce['message'];const _0x4bda0d=await sendTelegramMsg(toTelegramMarkdown(_0x1cc858),_0x5b3e62(0xf0));if(_0x4bda0d)_0x2d2170=_0x4592ce[_0x5b3e62(0x184)];}}}updateAvailable=isNewerVersion(settings[_0x5b3e62(0x210)],serverversion),updateSetting('lastmsgtelegram',_0x2d2170),emitMessages();}}function emitMessages(){const _0x2f82b0=_0x5347cb,_0x18ed19=settings['lastmsgemitted'];let _0x2f8e0b=[];newMessages['forEach'](_0x3cb487=>{const _0x85c75a=_0xf239;_0x3cb487['number']>_0x18ed19&&_0x2f8e0b[_0x85c75a(0x128)](_0x3cb487);}),_0x2f8e0b[_0x2f82b0(0x1d0)]>0x0&&getAllClients()[_0x2f82b0(0x1fe)](_0x2f628b=>{const _0x1a4aba=_0x2f82b0;getSocket(_0x2f628b['id'])['emit'](_0x1a4aba(0x29c),_0x2f8e0b);});}function confirmMessage(_0x1310aa){const _0xa0cbc3=_0x5347cb;updateSetting(_0xa0cbc3(0x27b),Number(_0x1310aa));}function isNewerVersion(_0x354e09,_0x3b8f10){const _0x1d780e=_0x3b8f10['split']('.'),_0x268311=_0x354e09['split']('.');for(var _0x22ef82=0x0;_0x22ef82<_0x268311['length'];_0x22ef82++){const _0x19de1e=~~_0x268311[_0x22ef82],_0x11a03a=~~_0x1d780e[_0x22ef82];if(_0x19de1e>_0x11a03a)return!![];if(_0x19de1e<_0x11a03a)return![];}return![];}function toTelegramMarkdown(_0x461506){const _0x206b35=_0x5347cb,_0x9177ee=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x9b8bb2=/\*{2}(.+?)\*{2}/gim;return _0x461506=_0x461506[_0x206b35(0x2d1)](_0x9177ee,_0x206b35(0x213))[_0x206b35(0x2d1)](_0x9b8bb2,_0x206b35(0x204)),_0x461506;}async function validateConfigFile(){const _0x360da9=_0x5347cb,_0x3beb3d=dbConfig[_0x360da9(0x23c)](_0x360da9(0x115))['sortBy'](_0x360da9(0x1e9))['value']()||[];if(_0x3beb3d[_0x360da9(0x1d0)]==0x0){let _0x834fd4=0x0,_0x5a82e9=[];const _0x5df214=/^bot-([0-9]{3})-config.json$/,_0x3daa4e=fs[_0x360da9(0x16f)](configpath);_0x3daa4e[_0x360da9(0x1fe)](_0x5c454d=>{const _0x3ec367=_0x360da9,_0x10af5c=_0x5df214[_0x3ec367(0x120)](_0x5c454d);if(_0x10af5c){const _0x6033e4=_0x10af5c[0x1];let _0x4fe5be=getBotAttributes(_0x6033e4);_0x5a82e9[_0x3ec367(0x128)]({'botID':_0x6033e4,'botname':_0x4fe5be[_0x3ec367(0x1b0)],'status':'disabled','live':_0x3ec367(0x226)}),_0x834fd4++;}}),_0x834fd4!=0x0&&(dbConfig[_0x360da9(0x23c)]('bots')[_0x360da9(0x104)](_0x5a82e9)['write'](),config=_0x5a82e9,restoredConfigFile=_0x834fd4);}}async function restoreConfigNotify(_0x4f5402){const _0x1d7f4f=_0x5347cb;let _0x54a61c;if(restoredConfigFile==0x1)_0x54a61c=_0x1d7f4f(0x287);else _0x54a61c='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x4f5402)io['to'](_0x1d7f4f(0x183))['emit'](_0x1d7f4f(0xe8),_0x54a61c);else{logger[_0x1d7f4f(0x139)]('-----------------------------------------------------------------------------------'),logger[_0x1d7f4f(0x139)](_0x54a61c),logger[_0x1d7f4f(0x139)]('-----------------------------------------------------------------------------------'),logger[_0x1d7f4f(0x139)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x1d7f4f(0x1e8)]!=_0x1d7f4f(0x19d))await sendTelegram(settings[_0x1d7f4f(0x27a)],_0x1d7f4f(0x229)+_0x54a61c);}}function decryptRSA(_0x4d6c2b,_0x1cb4f3){const _0x56e68f=_0x5347cb,_0x5837c0=forge[_0x56e68f(0x2cf)]['privateKeyFromPem'](_0x4d6c2b),_0x4fdb02=_0x5837c0[_0x56e68f(0x103)](forge[_0x56e68f(0x1b4)][_0x56e68f(0x1b1)](_0x1cb4f3),_0x56e68f(0x25a),{'md':forge['md'][_0x56e68f(0x16d)][_0x56e68f(0x14e)](),'mgf1':{'md':forge['md'][_0x56e68f(0x16d)]['create']()}});return _0x4fdb02;}function validateCredentials(_0x1f8957,_0x3f3ca1){const _0x1e8023=_0x5347cb;if(_0x1f8957[_0x1e8023(0x254)]==settings['bbUsername']&&bcrypt[_0x1e8023(0x1ed)](_0x1f8957[_0x1e8023(0x12d)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x1e8023(0x280),'token':null};else{const _0x32d17c=generateLoginToken(_0x3f3ca1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x32d17c};}}else return{'allow':![],'reason':_0x1e8023(0x239),'token':null};}function refreshToken(_0x55e0ed){const _0x2c0b0b=generateLoginToken(_0x55e0ed);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2c0b0b};}function validateAccess(_0x496d41,_0x4ef53a,_0x218f6c){const _0x4f9759=_0x5347cb,_0x34bb35=_0x218f6c?_0x218f6c:devices[_0x4ef53a]['ip'];let _0x3d109e;const _0x180870=_0x464726=>{const _0x33b24b=_0xf239;if(settings[_0x33b24b(0x24f)]){if(settings[_0x33b24b(0x2b5)]){if(telegram2FaApproved(_0x4ef53a)){const _0x58b1d7=generateLoginToken(_0x4ef53a);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x58b1d7};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x3d109e=validToken(_0x464726,_0x4ef53a),_0x3d109e[_0x33b24b(0x134)]('success')?{'allow':!![],'reason':_0x33b24b(0x23d),'token':_0x464726}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x7febcf=[...settings['whitelist'],'::1',_0x4f9759(0x23f),_0x4f9759(0x231)];if(_0x7febcf['includes'](_0x34bb35))return _0x180870(_0x496d41);else{_0x3d109e=validToken(_0x496d41,_0x4ef53a);if(_0x3d109e[_0x4f9759(0x134)]('success'))return _0x180870(_0x496d41);else{if(telegramIpApproved(_0x4ef53a)){const _0x4d8c37=generateToken(_0x4ef53a);return _0x3d109e=_0x180870(_0x496d41),_0x3d109e[_0x4f9759(0x155)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x4d8c37}:_0x3d109e;}else return settings[_0x4f9759(0x2d2)]?{'allow':![],'reason':_0x4f9759(0x169),'token':null}:{'allow':![],'reason':_0x4f9759(0x2b9),'token':null};}}}else return _0x180870(_0x496d41);}function timelyDecrypt(_0x58ea44,_0x6f89f,_0x205c0c='@'){const _0x5844bd=_0x5347cb;if(_0x58ea44)try{const _0x1b6d13=decryptRSA(secure[_0x5844bd(0x2bf)],_0x58ea44),_0x581e8b=_0x1b6d13[_0x5844bd(0xf7)](_0x205c0c)[0x0],_0x473034=_0x1b6d13['split'](_0x205c0c)[0x1],_0x20e097=new Date()[_0x5844bd(0x1f0)]();if(_0x6f89f){if(_0x20e097-_0x473034<maxSecretAge*0x3e8)return _0x581e8b;else return![];}else return _0x581e8b;}catch(_0x3ee196){return![];}else return![];}const validToken=(_0x3ef9af,_0x2c067c)=>{const _0x516edd=_0x5347cb,_0x11e0ed=devices[_0x2c067c]['ip'];if(!_0x3ef9af)return{'error':_0x516edd(0x1c1)};for(let _0xe78851 of blacklist){if(_0xe78851['token']==_0x3ef9af)return{'error':_0x516edd(0x273)};}let _0x29188a;try{_0x29188a=jwt['verify'](_0x3ef9af,secure[_0x516edd(0x2b3)]+_0x2c067c);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x29188a[_0x516edd(0x134)](_0x516edd(0x11e))&&!_0x29188a[_0x516edd(0x134)](_0x516edd(0x254))||!_0x29188a[_0x516edd(0x134)]('exp'))return{'error':_0x516edd(0x218)};if(!_0x29188a[_0x516edd(0x134)]('username')&&_0x29188a[_0x516edd(0x134)](_0x516edd(0x11e))){const {clientip:_0x2f9a19}=_0x29188a;return _0x11e0ed==_0x2f9a19?{'success':_0x516edd(0x2a1)}:{'error':_0x516edd(0x205)};}else{if(_0x29188a[_0x516edd(0x134)](_0x516edd(0x254))&&_0x29188a['hasOwnProperty'](_0x516edd(0x11e))){const {username:_0x2b2703,clientip:_0xf252fc}=_0x29188a;return settings['bbUsername']==_0x2b2703&&_0x11e0ed==_0xf252fc?{'success':_0x516edd(0x2a1)}:{'error':_0x516edd(0x1fb)};}}},generateLoginToken=_0x394cf1=>{const _0x1b4bbe=_0x5347cb;if(_0x394cf1){const _0x2e208e=devices[_0x394cf1]['ip'];return jwt['sign']({'username':settings[_0x1b4bbe(0x162)],'clientip':_0x2e208e},secure['secret']+_0x394cf1,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1fe9e4=>{const _0x2e095b=_0x5347cb;if(_0x1fe9e4){const _0x236922=devices[_0x1fe9e4]['ip'];return jwt[_0x2e095b(0x1fd)]({'clientip':_0x236922},secure[_0x2e095b(0x2b3)]+_0x1fe9e4,{'expiresIn':devices[_0x1fe9e4][_0x2e095b(0x118)][_0x2e095b(0x1f3)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5d3ee5=>{const _0x361a8a=_0x5347cb;let _0x537d2e=![];return devices[_0x5d3ee5][_0x361a8a(0x118)]&&devices[_0x5d3ee5][_0x361a8a(0x118)][_0x361a8a(0x1f3)]!=_0x361a8a(0x114)&&(_0x537d2e=devices[_0x5d3ee5][_0x361a8a(0x118)]['clientip']==devices[_0x5d3ee5]['ip']&&new Date()[_0x361a8a(0x1f0)]()-devices[_0x5d3ee5][_0x361a8a(0x118)]['timestamp']<devices[_0x5d3ee5][_0x361a8a(0x118)][_0x361a8a(0x1f3)]*0x3c*0x3e8),_0x537d2e;},telegram2FaApproved=_0x301861=>{const _0x9b09d7=_0x5347cb;let _0x38982b=![];return devices[_0x301861][_0x9b09d7(0x1f7)]&&devices[_0x301861][_0x9b09d7(0x1f7)][_0x9b09d7(0x1f3)]!='reject'&&(_0x38982b=devices[_0x301861][_0x9b09d7(0x1f7)][_0x9b09d7(0x11e)]==devices[_0x301861]['ip']&&new Date()[_0x9b09d7(0x1f0)]()-devices[_0x301861][_0x9b09d7(0x1f7)][_0x9b09d7(0x189)]<devices[_0x301861][_0x9b09d7(0x1f7)][_0x9b09d7(0x1f3)]*0x3c*0x3e8),_0x38982b;},normalizeIP=_0xe2a579=>{const _0x17f064=_0x5347cb;let _0x3950b3=null,_0x2b3dad=null;if(ipaddr[_0x17f064(0x200)](_0xe2a579)){const _0x1c9c25=ipaddr[_0x17f064(0x275)](_0xe2a579);_0x1c9c25['kind']()==='ipv6'?(_0x1c9c25[_0x17f064(0x258)]()&&(_0x3950b3=_0x1c9c25[_0x17f064(0x13b)]()[_0x17f064(0x1ff)]()),_0x2b3dad=_0x1c9c25[_0x17f064(0x1ff)]()):(_0x3950b3=_0x1c9c25[_0x17f064(0x1ff)](),_0x2b3dad=_0x1c9c25[_0x17f064(0x161)]()[_0x17f064(0x1ff)]());}return{'show':_0x3950b3?_0x3950b3:_0x2b3dad,'store':_0x2b3dad};};function formatDate(_0x3a27f4){const _0x49de85=_0x5347cb;return _0x3a27f4[_0x49de85(0x23e)]()+'/'+(_0x3a27f4[_0x49de85(0x1bb)]()+0x1)[_0x49de85(0x1ff)]()[_0x49de85(0xea)](0x2,'0')+'/'+_0x3a27f4[_0x49de85(0xff)]()[_0x49de85(0x1ff)]()[_0x49de85(0xea)](0x2,'0')+'\x20'+_0x3a27f4[_0x49de85(0x17f)]()[_0x49de85(0x1ff)]()[_0x49de85(0xea)](0x2,'0')+':'+_0x3a27f4[_0x49de85(0x220)]()[_0x49de85(0x1ff)]()[_0x49de85(0xea)](0x2,'0')+':'+_0x3a27f4[_0x49de85(0x2ac)]()[_0x49de85(0x1ff)]()[_0x49de85(0xea)](0x2,'0');}function sleep(_0x1a63cc){return new Promise(_0x4945de=>setTimeout(_0x4945de,_0x1a63cc));}