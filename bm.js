const _0x29a69b=_0xfb4a;(function(_0x5d6f59,_0x2c3b2c){const _0x5b1c10=_0xfb4a,_0x525c13=_0x5d6f59();while(!![]){try{const _0x19bf7d=-parseInt(_0x5b1c10(0x2f1))/0x1*(parseInt(_0x5b1c10(0x1a5))/0x2)+-parseInt(_0x5b1c10(0x217))/0x3*(parseInt(_0x5b1c10(0x2f8))/0x4)+-parseInt(_0x5b1c10(0x2b1))/0x5*(parseInt(_0x5b1c10(0x2e3))/0x6)+parseInt(_0x5b1c10(0x232))/0x7*(-parseInt(_0x5b1c10(0x27b))/0x8)+-parseInt(_0x5b1c10(0x254))/0x9*(parseInt(_0x5b1c10(0x297))/0xa)+-parseInt(_0x5b1c10(0x20e))/0xb*(-parseInt(_0x5b1c10(0x1ed))/0xc)+parseInt(_0x5b1c10(0x1a9))/0xd;if(_0x19bf7d===_0x2c3b2c)break;else _0x525c13['push'](_0x525c13['shift']());}catch(_0x512d4d){_0x525c13['push'](_0x525c13['shift']());}}}(_0x3693,0x5f368));const _0x315b22=function(){let _0x280661=!![];return function(_0x34a1a5,_0x465d07){const _0x1bb296=_0x280661?function(){if(_0x465d07){const _0x201456=_0x465d07['apply'](_0x34a1a5,arguments);return _0x465d07=null,_0x201456;}}:function(){};return _0x280661=![],_0x1bb296;};}(),_0x4e6098=_0x315b22(this,function(){const _0x990ebf=_0xfb4a;return _0x4e6098['toString']()[_0x990ebf(0x1ab)](_0x990ebf(0x28b))['toString']()[_0x990ebf(0x284)](_0x4e6098)[_0x990ebf(0x1ab)](_0x990ebf(0x28b));});_0x4e6098();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x29a69b(0x1f1)),fs=require('fs'),fns=require(_0x29a69b(0x2d9)),low=require(_0x29a69b(0x264)),FileSync=require(_0x29a69b(0x204)),path=require('path'),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x29a69b(0x1a4)],RSA=require(_0x29a69b(0x30b))[_0x29a69b(0x2f4)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x29a69b(0x292))(process[_0x29a69b(0x1d1)][_0x29a69b(0x1fe)](0x2))[_0x29a69b(0x1d1)],uuidRandom=require(_0x29a69b(0x2ed)),TelegramBot=require(_0x29a69b(0x25e)),Mixpanel=require(_0x29a69b(0x29b)),axios=require(_0x29a69b(0x259)),{GraphQLClient,gql}=require(_0x29a69b(0x1dc)),util=require('util'),fileUpload=require(_0x29a69b(0x1c6)),PORT=argv[_0x29a69b(0x29a)]||_0x29a69b(0x2d3),pattern=/^[0-9]{2,4}$/;!pattern[_0x29a69b(0x29d)](PORT)&&(console[_0x29a69b(0x1da)](_0x29a69b(0x25d)+PORT+_0x29a69b(0x241)),process[_0x29a69b(0x2e5)](0x1));const HOST=argv[_0x29a69b(0x30c)]||null,userID=argv[_0x29a69b(0x208)]||'';let bbpath=_0x29a69b(0x302),bbpath2='';const botfile='bot.js',configfile=_0x29a69b(0x2a6),settingsfile=_0x29a69b(0x2ee),securefile='bb-secure.json';let validInstallation=!![];!fs[_0x29a69b(0x1f5)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x29a69b(0x1a7)),configpath=userID?bbpath+_0x29a69b(0x29f)+userID+'/':bbpath+_0x29a69b(0x29f),configbackuppath=configpath+_0x29a69b(0x281),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x29a69b(0x246),zippath=userID?bbpath+_0x29a69b(0x1ce)+userID+'/':bbpath+_0x29a69b(0x1ce),loggerfile=fs['createWriteStream'](logspath+_0x29a69b(0x20a),{'flags':'a'}),temppath=userID?bbpath+_0x29a69b(0x1b4)+userID+'/':bbpath+_0x29a69b(0x1b4);!fs[_0x29a69b(0x1f5)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x29a69b(0x1f5)](configbackuppath)&&fs[_0x29a69b(0x197)](configbackuppath);!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs[_0x29a69b(0x197)](zippath);!fs[_0x29a69b(0x1f5)](temppath)&&fs[_0x29a69b(0x197)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x29a69b(0x207)]({'bots':[]})[_0x29a69b(0x21b)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0'}})[_0x29a69b(0x21b)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x29a69b(0x207)]({'secure':{},'blacklist':[]})[_0x29a69b(0x21b)]();let crypt=new Crypt({'md':_0x29a69b(0x300),'rsaStandard':_0x29a69b(0x235)});const saltRounds=0xa,mixpanel=Mixpanel[_0x29a69b(0x2da)](_0x29a69b(0x2ae),{'host':_0x29a69b(0x248)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x29a69b(0x315)]&&settings[_0x29a69b(0x315)]!=''&&settings[_0x29a69b(0x1e0)]&&settings[_0x29a69b(0x1e0)]!='')initTelegram();const logger={'screen':_0x189cb8=>{console['log'](_0x189cb8);},'simple':_0x16d43f=>{const _0x8508d=_0x29a69b;console[_0x8508d(0x1da)](_0x16d43f),loggerfile[_0x8508d(0x21b)](util['format'](_0x16d43f)+'\x0a');},'full':async _0x3cdfc8=>{const _0xdf9be6=_0x29a69b,_0x53e806=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x3cdfc8;console[_0xdf9be6(0x1da)](_0x53e806),loggerfile[_0xdf9be6(0x21b)](util[_0xdf9be6(0x236)](_0x53e806)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0xdf9be6(0x283)]!=_0xdf9be6(0x2f5))await tgBot[_0xdf9be6(0x30d)](settings[_0xdf9be6(0x2c1)],_0xdf9be6(0x2a1)+_0x3cdfc8)[_0xdf9be6(0x27f)](_0x1ca8b4=>{telegramError(_0x1ca8b4);});}};process['on'](_0x29a69b(0x325),function(_0x119907){const _0x144996=_0x29a69b;logger[_0x144996(0x2d8)](_0x119907);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x29a69b(0x270)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x29a69b(0x1b9)),app=express(),http=require(_0x29a69b(0x21c))[_0x29a69b(0x265)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x29a69b(0x27d)](_0x29a69b(0x2c8),async(_0x4fae68,_0x300bff)=>{const _0xffacc6=_0x29a69b,_0x4950e3=_0x4fae68[_0xffacc6(0x2ab)][_0xffacc6(0x20b)],_0x131004=getClientsWithBotID('botmanager'),_0x1b779d=_0x4fae68[_0xffacc6(0x1f9)]['uuid'],_0x4000be=timelyDecrypt(_0x1b779d,![]),_0x54be2a=_0x131004[_0xffacc6(0x30a)](_0x5dca88=>_0x5dca88[_0xffacc6(0x287)]==_0x4000be);if(_0x54be2a){const _0x26fe25=normalizeIP(_0x4fae68[_0xffacc6(0x1af)][_0xffacc6(0x194)])[_0xffacc6(0x1a2)],_0x3c34b8=_0x4fae68[_0xffacc6(0x1f9)]['tkn'];if(validateAccess(_0x3c34b8,_0x4000be,_0x26fe25)[_0xffacc6(0x2cd)])await zipFiles(_0x4950e3),_0x300bff[_0xffacc6(0x1b6)](zippath+(_0x4950e3+'.zip'),_0xb4f543=>{const _0x281aea=_0xffacc6;_0xb4f543&&(logger['full']('Failed\x20to\x20download\x20'+_0x4950e3),logger[_0x281aea(0x2d8)](_0xb4f543));});else logger[_0xffacc6(0x1dd)](_0xffacc6(0x322)+_0x4950e3+_0xffacc6(0x213));}else logger['full'](_0xffacc6(0x322)+_0x4950e3+_0xffacc6(0x242));}),app[_0x29a69b(0x2a4)]('/upload-backup',async(_0x1abb10,_0x4adc0c)=>{const _0x436739=_0x29a69b,_0x3ed85d=getClientsWithBotID(_0x436739(0x2a0)),_0xe01025=_0x1abb10[_0x436739(0x1f9)]['uuid'],_0x2508e2=timelyDecrypt(_0xe01025,![]),_0x5698d9=_0x3ed85d[_0x436739(0x30a)](_0x555aca=>_0x555aca[_0x436739(0x287)]==_0x2508e2);if(_0x5698d9){const _0x5081dc=normalizeIP(_0x1abb10['socket'][_0x436739(0x194)])['store'],_0x5e6504=_0x1abb10['headers'][_0x436739(0x215)];if(validateAccess(_0x5e6504,_0x2508e2,_0x5081dc)[_0x436739(0x2cd)]){if(_0x1abb10[_0x436739(0x212)]){const _0x47b0e0=_0x1abb10[_0x436739(0x212)][_0x436739(0x228)];await _0x47b0e0['mv'](temppath+_0x47b0e0[_0x436739(0x273)]),_0x4adc0c[_0x436739(0x1f7)]({'status':!![],'message':_0x436739(0x294)});const _0xb1c11a=getBotsWithMode();_0xb1c11a[_0x436739(0x190)]>0x0?confirmRestore(temppath,_0x47b0e0[_0x436739(0x273)]):unzipFile(temppath,_0x47b0e0['name']);}}else logger[_0x436739(0x1dd)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x436739(0x1dd)](_0x436739(0x324));}),app[_0x29a69b(0x307)](express[_0x29a69b(0x2b2)](path[_0x29a69b(0x24f)](__dirname,bbpath2,_0x29a69b(0x1db)))),app[_0x29a69b(0x307)](express[_0x29a69b(0x2b2)](path['join'](__dirname,bbpath2,_0x29a69b(0x299)))),app[_0x29a69b(0x27d)]('/',function(_0x378084,_0x3c8fee){const _0x322a3d=_0x29a69b;_0x3c8fee[_0x322a3d(0x22b)](path[_0x322a3d(0x24f)](__dirname,bbpath2,_0x322a3d(0x1db),'index.html'));}),app['get'](_0x29a69b(0x290),function(_0x1e88e1,_0x3fbf3a){const _0x2d959c=_0x29a69b;_0x3fbf3a[_0x2d959c(0x22b)](path[_0x2d959c(0x24f)](__dirname,bbpath2,_0x2d959c(0x299),_0x2d959c(0x20d)));}),app[_0x29a69b(0x27d)]('/:bot/portfolio',(_0x32ca13,_0x43380a)=>{const _0x23b107=_0x29a69b;_0x43380a[_0x23b107(0x22b)](path[_0x23b107(0x24f)](__dirname,bbpath2,_0x23b107(0x299),_0x23b107(0x20d)));}),app[_0x29a69b(0x27d)](_0x29a69b(0x31d),(_0x565b5d,_0x52deab)=>{const _0x34a672=_0x29a69b;_0x52deab[_0x34a672(0x22b)](path[_0x34a672(0x24f)](__dirname,bbpath2,_0x34a672(0x299),_0x34a672(0x20d)));}),app[_0x29a69b(0x27d)]('/:bot/coins',(_0x10c627,_0x3f621e)=>{const _0x57d5eb=_0x29a69b;_0x3f621e[_0x57d5eb(0x22b)](path['join'](__dirname,bbpath2,_0x57d5eb(0x299),_0x57d5eb(0x20d)));}),app[_0x29a69b(0x27d)](_0x29a69b(0x19e),(_0x31853e,_0x455a59)=>{const _0x2686f5=_0x29a69b;_0x455a59[_0x2686f5(0x22b)](path[_0x2686f5(0x24f)](__dirname,bbpath2,_0x2686f5(0x299),'index.html'));}),app[_0x29a69b(0x27d)](_0x29a69b(0x240),(_0xe0289a,_0x4b4395)=>{const _0x473efc=_0x29a69b;_0x4b4395['sendFile'](path[_0x473efc(0x24f)](__dirname,bbpath2,_0x473efc(0x299),_0x473efc(0x20d)));}),app[_0x29a69b(0x27d)]('/:bot/support',(_0x32e735,_0x6d2f7)=>{const _0x19c589=_0x29a69b;_0x6d2f7[_0x19c589(0x22b)](path[_0x19c589(0x24f)](__dirname,bbpath2,_0x19c589(0x299),_0x19c589(0x20d)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x29a69b(0x319))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x1d7d8f=_0x29a69b;logger['simple'](''),logger[_0x1d7d8f(0x2d8)]('-----------------------------------------------------------------------------------'),await logger[_0x1d7d8f(0x1dd)](_0x1d7d8f(0x2ba)+PORT),logger[_0x1d7d8f(0x2d8)](_0x1d7d8f(0x1d8));if(config[_0x1d7d8f(0x190)]!=0x0)for(const _0x38f9a9 of config){if(_0x38f9a9[_0x1d7d8f(0x271)]==_0x1d7d8f(0x2d4)||_0x38f9a9['status']=='new')await logger[_0x1d7d8f(0x1dd)]('starting\x20bot\x20|\x20Bot\x20'+_0x38f9a9['botID']+_0x1d7d8f(0x19a)+_0x38f9a9[_0x1d7d8f(0x1eb)]),startBot([_0x38f9a9[_0x1d7d8f(0x196)],userID],{'cwd':bbpath},function(_0x320bac){const _0x3130c6=_0x1d7d8f;if(_0x320bac)logger[_0x3130c6(0x1dd)](_0x320bac);});else(_0x38f9a9[_0x1d7d8f(0x271)]==_0x1d7d8f(0x278)||_0x38f9a9[_0x1d7d8f(0x271)]=='new-disabled')&&await logger[_0x1d7d8f(0x1dd)](_0x1d7d8f(0x279)+_0x38f9a9['botID']+_0x1d7d8f(0x19a)+_0x38f9a9[_0x1d7d8f(0x1eb)]);}else!newBot&&logger[_0x1d7d8f(0x2d8)](_0x1d7d8f(0x1d5));if(newBot)addBot();logger[_0x1d7d8f(0x2d8)]('-----------------------------------------------------------------------------------'),logger['simple']('');}function startSocket(){io['on']('connection',_0x3d9c81=>{const _0x32396a=_0xfb4a;let _0x2e9bc6,_0x2692e4,_0x2b3ee7,_0x50164d,_0x1ca78a;const _0x23c679=_0x3d9c81['handshake']['headers'][_0x32396a(0x2c2)];_0x2692e4=_0x23c679[_0x32396a(0x18d)](/bot[0-9]{3}/);if(_0x2692e4)_0x2b3ee7=_0x2692e4[0x0][_0x32396a(0x18d)](/[0-9]{3}/);if(_0x2b3ee7)_0x2e9bc6=_0x2b3ee7[0x0];else _0x2e9bc6=_0x32396a(0x2a0);const _0x41d3e2=_0x3d9c81['handshake'][_0x32396a(0x2b7)]['encryptedUuid'];if(!_0x41d3e2)_0x3d9c81['emit']('status',{'publicKey':secure[_0x32396a(0x202)]});else{_0x50164d=timelyDecrypt(_0x41d3e2,![]);if(!_0x50164d)_0x3d9c81[_0x32396a(0x28a)](_0x32396a(0x271),{'publicKey':secure[_0x32396a(0x202)]});else{_0x1ca78a=normalizeIP(_0x3d9c81[_0x32396a(0x2d1)][_0x32396a(0x194)])[_0x32396a(0x1a2)];if(!devices[_0x50164d])devices[_0x50164d]={'uuid':_0x50164d,'access':{'token':null}};devices[_0x50164d]['ip']=_0x1ca78a;const _0x2cf351=addClient(_0x3d9c81['id'],_0x50164d,_0x2e9bc6);setAccess(_0x2cf351),emitMessages(),_0x3d9c81['on']('login',_0x227913=>{const _0x3da2fb=_0x32396a,_0x2387c2=timelyDecrypt(_0x227913[_0x3da2fb(0x19c)]);if(_0x2387c2){_0x227913={'username':_0x227913[_0x3da2fb(0x1fb)],'password':_0x2387c2},devices[_0x50164d]['access']=validateCredentials(_0x227913,_0x50164d);if(devices[_0x50164d][_0x3da2fb(0x2ea)][_0x3da2fb(0x2cd)]==![]&&devices[_0x50164d]['access']['reason']==_0x3da2fb(0x222))_0x3d9c81[_0x3da2fb(0x28a)](_0x3da2fb(0x271),{'access':devices[_0x50164d][_0x3da2fb(0x2ea)]}),loginAccess2FA(_0x50164d,_0x1ca78a);else{if(devices[_0x50164d][_0x3da2fb(0x2ea)][_0x3da2fb(0x2cd)]==![]&&devices[_0x50164d]['access']['reason']==_0x3da2fb(0x1e6))_0x3d9c81['emit']('status',{'access':devices[_0x50164d][_0x3da2fb(0x2ea)]});else devices[_0x50164d][_0x3da2fb(0x2ea)][_0x3da2fb(0x2cd)]&&devices[_0x50164d][_0x3da2fb(0x2ea)][_0x3da2fb(0x2c5)]==_0x3da2fb(0x1d2)&&(getClientsWithUuid(_0x50164d)['forEach'](_0x2d62c3=>{setAccess(_0x2d62c3);}),setTokenRefresh(_0x50164d),setSessionTimeout('login',_0x50164d));}}else logger[_0x3da2fb(0x1dd)](_0x3da2fb(0x19d));}),_0x3d9c81['on'](_0x32396a(0x303),()=>{resetPassword();}),_0x3d9c81['on'](_0x32396a(0x2f0),_0x3a9f9e=>{removeClient(_0x3d9c81['id']);}),_0x2e9bc6==_0x32396a(0x2a0)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x48ffcd){const _0x4e37f5=_0x29a69b;if(_0x48ffcd!=_0x4e37f5(0x2a0)&&config[_0x4e37f5(0x233)]!=''){if(pid[_0x48ffcd])pid[_0x48ffcd][_0x4e37f5(0x1f7)]({'function':_0x4e37f5(0x26c),'args':null});}}function reloadBotManager(){const _0x42ada9=_0x29a69b;getClientsWithBotID(_0x42ada9(0x2a0))[_0x42ada9(0x1df)](_0x576107=>{const _0x48e364=_0x42ada9;getSocket(_0x576107['id'])[_0x48e364(0x28a)](_0x48e364(0x271),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x5987eb){const _0x22e9b5=_0x29a69b;return io[_0x22e9b5(0x193)][_0x22e9b5(0x193)][_0x22e9b5(0x27d)](_0x5987eb);}function setAccess(_0x38b3e7){const _0x1f316=_0x29a69b,_0x163118=getSocket(_0x38b3e7['id']),_0x1e72e5=_0x38b3e7['uuid'],_0x2424ad=_0x38b3e7[_0x1f316(0x2e4)];devices[_0x1e72e5][_0x1f316(0x2ea)]=validateAccess(devices[_0x1e72e5]['access']['token'],_0x1e72e5),_0x163118[_0x1f316(0x24f)](_0x1e72e5);if(devices[_0x1e72e5][_0x1f316(0x2ea)][_0x1f316(0x2cd)]){_0x163118[_0x1f316(0x24f)](_0x2424ad);if(_0x2424ad==_0x1f316(0x2a0))initializeSocketBotManager(_0x163118);else initializeSocketBot(_0x163118);initClient(_0x2424ad);}devices[_0x1e72e5][_0x1f316(0x2ea)][_0x1f316(0x2e9)]&&devices[_0x1e72e5][_0x1f316(0x2ea)][_0x1f316(0x2c5)]==_0x1f316(0x27c)&&setSessionTimeout('2FA',_0x1e72e5),devices[_0x1e72e5]['access'][_0x1f316(0x2e9)]&&devices[_0x1e72e5][_0x1f316(0x2ea)][_0x1f316(0x2c5)]==_0x1f316(0x234)&&setSessionTimeout(_0x1f316(0x23d),_0x1e72e5),_0x163118['emit']('status',{'status':_0x38b3e7['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1e72e5][_0x1f316(0x2ea)],'externalip':devices[_0x1e72e5]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x1f316(0x231)],'validInstallation':validInstallation}),devices[_0x1e72e5][_0x1f316(0x2ea)][_0x1f316(0x2cd)]==![]&&devices[_0x1e72e5][_0x1f316(0x2ea)][_0x1f316(0x2c5)]=='2FA\x20required'&&temporaryAccess2FA(_0x1e72e5,devices[_0x1e72e5]['ip']);}function setSessionTimeout(_0x445d34,_0x66ed5b){const _0x3bf391=_0x29a69b;let _0x274faf;if(_0x445d34==_0x3bf391(0x23d))_0x274faf=loginExpiry*0x3c*0x3e8;else _0x274faf=devices[_0x66ed5b][_0x3bf391(0x24b)]['expiry']*0x3c*0x3e8-(new Date()[_0x3bf391(0x320)]()-devices[_0x66ed5b][_0x3bf391(0x24b)][_0x3bf391(0x223)]);if(devices[_0x66ed5b][_0x3bf391(0x1ef)])clearTimeout(devices[_0x66ed5b][_0x3bf391(0x1ef)]);devices[_0x66ed5b]['pidExpireLogin']=setTimeout(()=>{const _0x283cf8=_0x3bf391;if(devices[_0x66ed5b][_0x283cf8(0x21d)])clearTimeout(devices[_0x66ed5b][_0x283cf8(0x21d)]);removeSocketListeners(_0x66ed5b),addBlacklist(_0x66ed5b),devices[_0x66ed5b]['telegramIpApproval']=null,devices[_0x66ed5b][_0x283cf8(0x224)]=null,devices[_0x66ed5b][_0x283cf8(0x2ea)]['token']=null,devices[_0x66ed5b]['access']=validateAccess(devices[_0x66ed5b][_0x283cf8(0x2ea)][_0x283cf8(0x2e9)],_0x66ed5b),!(devices[_0x66ed5b]['access']['allow']&&devices[_0x66ed5b][_0x283cf8(0x2ea)][_0x283cf8(0x2c5)]=='login\x20not\x20required')&&(_0x445d34==_0x283cf8(0x23d)?io['to'](_0x66ed5b)[_0x283cf8(0x28a)](_0x283cf8(0x271),{'access':{'allow':![],'reason':_0x283cf8(0x2c0),'token':null}}):io['to'](_0x66ed5b)[_0x283cf8(0x28a)](_0x283cf8(0x271),{'access':{'allow':![],'reason':_0x283cf8(0x192),'token':null}})),devices[_0x66ed5b][_0x283cf8(0x2ea)][_0x283cf8(0x2e9)]=null;},_0x274faf);}function setTokenRefresh(_0x43ff7c){const _0x30a4bd=_0x29a69b;if(devices[_0x43ff7c][_0x30a4bd(0x21d)])clearTimeout(devices[_0x43ff7c]['pidRefreshToken']);devices[_0x43ff7c][_0x30a4bd(0x21d)]=setTimeout(()=>{const _0x35b3dc=_0x30a4bd;getClientsWithUuid(_0x43ff7c)[_0x35b3dc(0x190)]!=0x0?(devices[_0x43ff7c]['access']=refreshToken(_0x43ff7c),io['to'](_0x43ff7c)[_0x35b3dc(0x28a)](_0x35b3dc(0x271),{'status':_0x35b3dc(0x291),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x43ff7c][_0x35b3dc(0x2ea)],'externalip':devices[_0x43ff7c]['ip'],'publicKey':secure[_0x35b3dc(0x202)],'validInstallation':validInstallation}),setTokenRefresh(_0x43ff7c)):clearTimeout(devices[_0x43ff7c][_0x35b3dc(0x21d)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x58e0c7){const _0x2ffbfe=_0x29a69b,_0x8db546=getClient(_0x58e0c7['id'])[_0x2ffbfe(0x287)];_0x58e0c7['emit']('bots',config),_0x58e0c7[_0x2ffbfe(0x28a)]('settings',cleanSettings()),_0x58e0c7['on'](_0x2ffbfe(0x1c4),_0x15158c=>{const _0x3923b4=_0x2ffbfe;if(validateAccess(_0x15158c,_0x8db546)[_0x3923b4(0x2cd)])addBot();else logger[_0x3923b4(0x1dd)](_0x3923b4(0x261));}),_0x58e0c7['on'](_0x2ffbfe(0x2c4),(_0x416c50,_0x386a5f)=>{const _0x361e13=_0x2ffbfe;if(validateAccess(_0x386a5f,_0x8db546)['allow'])toggleBot(_0x416c50['botID'],_0x416c50['status'],_0x416c50[_0x361e13(0x1c0)]);else logger[_0x361e13(0x1dd)](_0x361e13(0x1a3));}),_0x58e0c7['on']('toggle-bot-mode',(_0x2be7bb,_0x8e46b2)=>{const _0x4ec1aa=_0x2ffbfe;if(validateAccess(_0x8e46b2,_0x8db546)['allow'])toggleBotMode(_0x2be7bb);else logger[_0x4ec1aa(0x1dd)](_0x4ec1aa(0x1a3));}),_0x58e0c7['on'](_0x2ffbfe(0x1e3),(_0x4188c0,_0x39bdc3)=>{const _0x625a3f=_0x2ffbfe;if(validateAccess(_0x39bdc3,_0x8db546)[_0x625a3f(0x2cd)])deleteBot(_0x4188c0);else logger[_0x625a3f(0x1dd)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x58e0c7['on']('store-settings',(_0x24e61e,_0x1e1755)=>{const _0x28dd13=_0x2ffbfe;if(validateAccess(_0x1e1755,_0x8db546)['allow'])storeSettings(_0x24e61e,!![]);else logger[_0x28dd13(0x1dd)](_0x28dd13(0x314));}),_0x58e0c7['on'](_0x2ffbfe(0x2d2),_0x1f5022=>{const _0x4c84ca=_0x2ffbfe;if(validateAccess(_0x1f5022,_0x8db546)[_0x4c84ca(0x2cd)])updateBB();else logger[_0x4c84ca(0x1dd)](_0x4c84ca(0x22a));}),_0x58e0c7['on']('get-messages',_0x274cd1=>{const _0x3dc764=_0x2ffbfe;if(validateAccess(_0x274cd1,_0x8db546)['allow'])getMessages();else logger[_0x3dc764(0x1dd)](_0x3dc764(0x2fa));}),_0x58e0c7['on'](_0x2ffbfe(0x295),(_0x7d4563,_0xa700fc)=>{const _0x49e482=_0x2ffbfe;if(validateAccess(_0xa700fc,_0x8db546)[_0x49e482(0x2cd)])confirmMessage(_0x7d4563);else logger[_0x49e482(0x1dd)](_0x49e482(0x2ec));}),_0x58e0c7['on'](_0x2ffbfe(0x198),_0x3cad02=>{const _0xf2677a=_0x2ffbfe;if(validateAccess(_0x3cad02,_0x8db546)[_0xf2677a(0x2cd)]){if(devices[_0x8db546][_0xf2677a(0x21d)])clearTimeout(devices[_0x8db546][_0xf2677a(0x21d)]);if(devices[_0x8db546][_0xf2677a(0x1ef)])clearTimeout(devices[_0x8db546][_0xf2677a(0x1ef)]);removeSocketListeners(getClient(_0x58e0c7['id'])['uuid']),addBlacklist(_0x8db546),devices[_0x8db546][_0xf2677a(0x24b)]=null,devices[_0x8db546][_0xf2677a(0x224)]=null,devices[_0x8db546]['access']['token']=null,io['to'](getClient(_0x58e0c7['id'])['uuid'])['emit'](_0xf2677a(0x271),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0xf2677a(0x288));});}function initializeSocketBot(_0xf5261){const _0x3a5d80=_0x29a69b,_0x3c39bb=getClient(_0xf5261['id'])[_0x3a5d80(0x2e4)],_0x501702=getClient(_0xf5261['id'])['uuid'];_0xf5261['on']('get-logs',(_0x36ca09,_0x5f6846)=>{const _0x3713f1=_0x3a5d80;if(validateAccess(_0x5f6846,_0x501702)[_0x3713f1(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb]['send']({'function':'emitHistory','args':_0x36ca09});}else logger[_0x3713f1(0x1dd)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0xf5261['on'](_0x3a5d80(0x23a),(_0x4e4929,_0x18713a)=>{const _0x5dae9f=_0x3a5d80;if(validateAccess(_0x18713a,_0x501702)['allow']){if(pid[_0x3c39bb])pid[_0x3c39bb][_0x5dae9f(0x1f7)]({'function':'deleteHistoryAlerts','args':_0x4e4929});}else logger[_0x5dae9f(0x1dd)](_0x5dae9f(0x323));}),_0xf5261['on'](_0x3a5d80(0x1ec),(_0x510351,_0x4c6416)=>{const _0x3d00bd=_0x3a5d80;if(validateAccess(_0x4c6416,_0x501702)[_0x3d00bd(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb][_0x3d00bd(0x1f7)]({'function':'getPortfolio','args':_0x510351});}else logger[_0x3d00bd(0x1dd)](_0x3d00bd(0x30e));}),_0xf5261['on'](_0x3a5d80(0x31f),(_0x265d15,_0x36dbe6)=>{const _0x2238fd=_0x3a5d80;if(validateAccess(_0x36dbe6,_0x501702)[_0x2238fd(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb][_0x2238fd(0x1f7)]({'function':_0x2238fd(0x209),'args':_0x265d15});}else logger[_0x2238fd(0x1dd)](_0x2238fd(0x206));}),_0xf5261['on']('store-headless',(_0x121019,_0x2e1493)=>{const _0x17888e=_0x3a5d80;if(validateAccess(_0x2e1493,_0x501702)[_0x17888e(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb][_0x17888e(0x1f7)]({'function':_0x17888e(0x277),'args':_0x121019});}else logger[_0x17888e(0x1dd)](_0x17888e(0x2a3));}),_0xf5261['on'](_0x3a5d80(0x305),_0x5ea6e1=>{const _0x59a552=_0x3a5d80;if(validateAccess(_0x5ea6e1,_0x501702)[_0x59a552(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb]['send']({'function':'getStartingBalances','args':null});}else logger[_0x59a552(0x1dd)](_0x59a552(0x1ee));}),_0xf5261['on'](_0x3a5d80(0x1cb),(_0x54aa14,_0x3e73fe)=>{const _0xd42b3a=_0x3a5d80;if(validateAccess(_0x3e73fe,_0x501702)[_0xd42b3a(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb][_0xd42b3a(0x1f7)]({'function':_0xd42b3a(0x28c),'args':_0x54aa14});}else logger['full'](_0xd42b3a(0x1e5));}),_0xf5261['on'](_0x3a5d80(0x21e),_0x1f5854=>{const _0x59d309=_0x3a5d80;if(validateAccess(_0x1f5854,_0x501702)[_0x59d309(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb]['send']({'function':_0x59d309(0x310),'args':null});}else logger[_0x59d309(0x1dd)](_0x59d309(0x225));}),_0xf5261['on'](_0x3a5d80(0x2e8),_0x578028=>{const _0x14a9b5=_0x3a5d80;if(validateAccess(_0x578028,_0x501702)[_0x14a9b5(0x2cd)]){if(pid[_0x3c39bb])pid[_0x3c39bb][_0x14a9b5(0x1f7)]({'function':_0x14a9b5(0x185),'args':null});}else logger['full'](_0x14a9b5(0x2a2));}),_0xf5261['on'](_0x3a5d80(0x2d2),_0x3a7811=>{const _0x39280b=_0x3a5d80;if(validateAccess(_0x3a7811,_0x501702)[_0x39280b(0x2cd)])updateBB();else logger['full'](_0x39280b(0x22a));}),_0xf5261['on'](_0x3a5d80(0x1d6),_0x41ddd3=>{const _0x5b7c0c=_0x3a5d80;if(validateAccess(_0x41ddd3,_0x501702)['allow'])getMessages();else logger[_0x5b7c0c(0x1dd)](_0x5b7c0c(0x2fa));}),_0xf5261['on'](_0x3a5d80(0x295),(_0x550908,_0x56224e)=>{const _0x1b4450=_0x3a5d80;if(validateAccess(_0x56224e,_0x501702)['allow'])confirmMessage(_0x550908);else logger[_0x1b4450(0x1dd)](_0x1b4450(0x2ec));}),_0xf5261['on'](_0x3a5d80(0x198),_0x4d3aef=>{const _0x2f32e1=_0x3a5d80;if(validateAccess(_0x4d3aef,_0x501702)[_0x2f32e1(0x2cd)]){if(devices[_0x501702][_0x2f32e1(0x21d)])clearTimeout(devices[_0x501702][_0x2f32e1(0x21d)]);if(devices[_0x501702][_0x2f32e1(0x1ef)])clearTimeout(devices[_0x501702][_0x2f32e1(0x1ef)]);removeSocketListeners(getClient(_0xf5261['id'])[_0x2f32e1(0x287)]),addBlacklist(_0x501702),devices[_0x501702]['telegramIpApproval']=null,devices[_0x501702][_0x2f32e1(0x224)]=null,devices[_0x501702][_0x2f32e1(0x2ea)]['token']=null,io['to'](getClient(_0xf5261['id'])['uuid'])[_0x2f32e1(0x28a)](_0x2f32e1(0x271),{'access':{'allow':![],'reason':_0x2f32e1(0x22c),'token':null}});}else logger[_0x2f32e1(0x1dd)](_0x2f32e1(0x288));});}function removeSocketListeners(_0x4e9503){getClientsWithUuid(_0x4e9503)['forEach'](_0x4e8af5=>{const _0x4bb76b=_0xfb4a;getSocket(_0x4e8af5['id'])[_0x4bb76b(0x2e7)]();});}function cleanSettings(){const _0x28809c=_0x29a69b;let _0x56c7af=settings;return settings[_0x28809c(0x315)]&&settings[_0x28809c(0x315)]!=''&&(_0x56c7af={..._0x56c7af,'telegramToken':'************'}),settings[_0x28809c(0x227)]&&settings[_0x28809c(0x227)]!=''&&(_0x56c7af={..._0x56c7af,'bbPassword':_0x28809c(0x266)}),(settings[_0x28809c(0x227)]&&settings[_0x28809c(0x227)]==_0x28809c(0x280)||settings[_0x28809c(0x315)]&&settings['telegramToken']==_0x28809c(0x280))&&(_0x56c7af={..._0x56c7af,'restored':{'password':settings[_0x28809c(0x227)]==_0x28809c(0x280),'telegram':settings[_0x28809c(0x315)]==_0x28809c(0x280)}}),_0x56c7af;}function updateBB(){const _0x5b9b47=_0x29a69b;installingUpdate=!![],config['forEach'](_0x180add=>{const _0xe5c700=_0xfb4a;restartBot(_0x180add[_0xe5c700(0x196)]);}),process[_0x5b9b47(0x1f7)]({'update':!![]},_0x3d39de=>{});}function startBot(_0x98810c,_0x3123aa,_0x2b7e59){const _0x362c87=_0x29a69b;let _0x3d8a91=![];const _0x2dbaf6=_0x98810c[0x0];_0x3123aa={..._0x3123aa,'stdio':['inherit',_0x362c87(0x24e),_0x362c87(0x24e),'ipc']},pid[_0x2dbaf6]=childProcess[_0x362c87(0x1f6)](botfile,_0x98810c,_0x3123aa),pid[_0x2dbaf6]['on'](_0x362c87(0x1e8),_0x133c76=>{const _0x765135=_0x362c87;switch(Object['keys'](_0x133c76)[0x0]){case _0x765135(0x1eb):updateBotName(_0x2dbaf6,_0x133c76[_0x765135(0x1eb)]);break;case'updatebotmanager':updateBotManager();break;case _0x765135(0x271):updateStatus(_0x2dbaf6,_0x133c76[_0x765135(0x271)]);break;case _0x765135(0x1c0):updateLive(_0x2dbaf6,_0x133c76[_0x765135(0x1c0)]);break;case'started':updateLive(_0x2dbaf6,_0x133c76['started']),io['to'](_0x2dbaf6)[_0x765135(0x28a)](_0x765135(0x271),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x765135(0x249):_0x133c76[_0x765135(0x249)]==_0x765135(0x1cf)&&restartBot(_0x2dbaf6);_0x133c76[_0x765135(0x249)]==_0x765135(0x1a6)&&toggleBot(_0x2dbaf6,'disabled',_0x765135(0x2c9));break;case'telegram':sendTelegram(_0x2dbaf6,_0x133c76[_0x765135(0x31b)]);break;case _0x765135(0x216):sendTelegramMsg(_0x133c76['telegrammsg']);break;case'function':io['to'](_0x2dbaf6)['emit'](_0x133c76[_0x765135(0x258)],_0x133c76[_0x765135(0x256)]);break;}}),pid[_0x2dbaf6]['on']('error',function(_0x4b194d){if(_0x3d8a91)return;_0x3d8a91=!![],_0x2b7e59(_0x4b194d);}),pid[_0x2dbaf6]['on'](_0x362c87(0x2e5),async function(_0x413c0a){const _0x1f6016=_0x362c87;if(installingUpdate)return;if(_0x3d8a91)return;_0x3d8a91=!![],_0x2b7e59(null);const _0x33a42a=dbConfig[_0x1f6016(0x27d)](_0x1f6016(0x2fd))[_0x1f6016(0x30a)]({'botID':_0x2dbaf6})['value']();_0x33a42a&&(_0x33a42a[_0x1f6016(0x271)]==_0x1f6016(0x2d4)||_0x33a42a[_0x1f6016(0x271)]==_0x1f6016(0x1c7))&&(await sleep(0x3e8),updateLive(_0x2dbaf6,_0x1f6016(0x2c9)),logger['full'](_0x1f6016(0x238)+_0x2dbaf6),startBot([_0x2dbaf6,userID],{'cwd':bbpath},function(_0x106607){const _0x41b9fd=_0x1f6016;if(_0x106607)logger[_0x41b9fd(0x1dd)](_0x106607);}));});}function stopBot(_0x117b68){getClientsWithBotID(_0x117b68)['forEach'](_0x5ac764=>{const _0x5836d9=_0xfb4a;getSocket(_0x5ac764['id'])[_0x5836d9(0x2f0)](!![]),removeClient(_0x5ac764['id']);}),pid[_0x117b68]&&(pid[_0x117b68]['kill'](),pid[_0x117b68]=null);}function restartBot(_0x40a504){if(pid[_0x40a504])pid[_0x40a504]['kill']();}function addBot(){const _0x3fdfd2=_0x29a69b;let _0x17f55e;for(let _0x3186b=0x1;_0x3186b<0x3e9;_0x3186b++){_0x17f55e=_0x3186b[_0x3fdfd2(0x201)]()[_0x3fdfd2(0x276)](0x3,'0');let _0x47a772=config['find'](_0x176d3a=>_0x176d3a['botID']==_0x17f55e);if(!_0x47a772)break;}if(_0x17f55e===_0x3fdfd2(0x275)){logger['full'](_0x3fdfd2(0x1ca));return;}logger[_0x3fdfd2(0x1dd)](_0x3fdfd2(0x326)+_0x17f55e),dbConfig['get']('bots')[_0x3fdfd2(0x26b)]({'botID':_0x17f55e,'botname':_0x3fdfd2(0x1fa)+_0x17f55e,'status':_0x3fdfd2(0x1c7),'live':''})[_0x3fdfd2(0x21b)](),startBot([_0x17f55e,userID],{'cwd':bbpath},function(_0x368a3e){const _0x31ced0=_0x3fdfd2;if(_0x368a3e)logger[_0x31ced0(0x1dd)](_0x368a3e);}),config=getConfiguration(),io['to'](_0x3fdfd2(0x2a0))[_0x3fdfd2(0x28a)](_0x3fdfd2(0x2fd),config);}function deleteBot(_0x12ebc2){const _0xc365d9=_0x29a69b;getClientsWithBotID(_0x12ebc2)[_0xc365d9(0x1df)](_0x3ae3ca=>{const _0xabfc1c=_0xc365d9;getSocket(_0x3ae3ca['id'])[_0xabfc1c(0x2f0)](!![]),removeClient(_0x3ae3ca['id']);}),dbConfig[_0xc365d9(0x27d)](_0xc365d9(0x2fd))[_0xc365d9(0x31c)]({'botID':_0x12ebc2})[_0xc365d9(0x21b)](),logger[_0xc365d9(0x1dd)](_0xc365d9(0x1c3)+_0x12ebc2),stopBot(_0x12ebc2);try{if(fs['existsSync'](path['join'](configpath,_0xc365d9(0x211)+_0x12ebc2+_0xc365d9(0x186))))fs[_0xc365d9(0x31a)](path['join'](configpath,_0xc365d9(0x211)+_0x12ebc2+'-config.json'));if(fs[_0xc365d9(0x1f5)](path[_0xc365d9(0x24f)](configpath,_0xc365d9(0x211)+_0x12ebc2+_0xc365d9(0x1bc))))fs[_0xc365d9(0x31a)](path[_0xc365d9(0x24f)](configpath,_0xc365d9(0x211)+_0x12ebc2+_0xc365d9(0x1bc)));if(fs[_0xc365d9(0x1f5)](path['join'](configpath,_0xc365d9(0x211)+_0x12ebc2+_0xc365d9(0x2f6))))fs[_0xc365d9(0x31a)](path[_0xc365d9(0x24f)](configpath,'bot-'+_0x12ebc2+'-performance.json'));if(fs[_0xc365d9(0x1f5)](path[_0xc365d9(0x24f)](configpath,'bot-'+_0x12ebc2+_0xc365d9(0x2a8))))fs['unlinkSync'](path[_0xc365d9(0x24f)](configpath,_0xc365d9(0x211)+_0x12ebc2+_0xc365d9(0x2a8)));}catch(_0x522336){if(_0x522336)logger['full'](_0xc365d9(0x298),_0x522336);}config=getConfiguration(),io['to'](_0xc365d9(0x2a0))[_0xc365d9(0x28a)](_0xc365d9(0x2fd),config);}function toggleBot(_0x13e54b,_0x2e8446,_0x36c662){const _0x143db4=_0x29a69b;dbConfig[_0x143db4(0x27d)]('bots')['find']({'botID':_0x13e54b})[_0x143db4(0x1a0)]({'status':_0x2e8446})[_0x143db4(0x1a0)]({'live':_0x36c662})[_0x143db4(0x21b)]();if(_0x2e8446=='enabled'||_0x2e8446==_0x143db4(0x1c7))logger[_0x143db4(0x1dd)](_0x143db4(0x1d7)+_0x13e54b),startBot([_0x13e54b,userID],{'cwd':bbpath},function(_0x3b3860){if(_0x3b3860)logger['full'](_0x3b3860);});else(_0x2e8446=='disabled'||_0x2e8446==_0x143db4(0x2d7))&&(logger['full'](_0x143db4(0x20f)+_0x13e54b),stopBot(_0x13e54b));config=getConfiguration(),io['to'](_0x143db4(0x2a0))[_0x143db4(0x28a)](_0x143db4(0x2fd),config);}function toggleStatus(_0x48ff1a){const _0xa05884=_0x29a69b;let _0x455f37=dbConfig[_0xa05884(0x27d)]('bots')['find']({'botID':_0x48ff1a})[_0xa05884(0x318)](),_0x2d29bf;if(_0x455f37[_0xa05884(0x271)]===_0xa05884(0x2d4))_0x2d29bf=_0xa05884(0x278);else{if(_0x455f37[_0xa05884(0x271)]===_0xa05884(0x1c7))_0x2d29bf=_0xa05884(0x2d7);else{if(_0x455f37[_0xa05884(0x271)]===_0xa05884(0x2d7))_0x2d29bf=_0xa05884(0x1c7);else{if(_0x455f37[_0xa05884(0x271)]===_0xa05884(0x278))_0x2d29bf=_0xa05884(0x2d4);}}}return _0x2d29bf;}function updateStatus(_0x4b32ab,_0x324746){const _0x35d58e=_0x29a69b;dbConfig[_0x35d58e(0x27d)](_0x35d58e(0x2fd))[_0x35d58e(0x30a)]({'botID':_0x4b32ab})['assign']({'status':_0x324746})['write'](),config=getConfiguration(),io['to'](_0x35d58e(0x2a0))['emit'](_0x35d58e(0x2fd),config);}function updateLive(_0x251942,_0x3a8b26){const _0x3d47d1=_0x29a69b;dbConfig[_0x3d47d1(0x27d)](_0x3d47d1(0x2fd))[_0x3d47d1(0x30a)]({'botID':_0x251942})[_0x3d47d1(0x1a0)]({'live':_0x3a8b26})[_0x3d47d1(0x21b)](),config=getConfiguration(),io['to'](_0x3d47d1(0x2a0))['emit'](_0x3d47d1(0x2fd),config);}function updateBotName(_0x2069e5,_0x5b56b3){const _0x4835f4=_0x29a69b;dbConfig[_0x4835f4(0x27d)]('bots')[_0x4835f4(0x30a)]({'botID':_0x2069e5})['assign']({'botname':_0x5b56b3})[_0x4835f4(0x21b)](),config=getConfiguration(),io['to']('botmanager')[_0x4835f4(0x28a)](_0x4835f4(0x2fd),config);}function updateBotManager(){const _0x5b9472=_0x29a69b;config=getConfiguration(),io['to'](_0x5b9472(0x2a0))[_0x5b9472(0x28a)]('bots',config);}function toggleBotMode(_0x504688){const _0x5f2548=_0x29a69b;if(pid[_0x504688])pid[_0x504688][_0x5f2548(0x1f7)]({'function':_0x5f2548(0x1cd),'args':null});else{const _0x1a8c58=configpath+_0x5f2548(0x211)+_0x504688+_0x5f2548(0x186),_0x39f46d=fs[_0x5f2548(0x25f)](_0x1a8c58),_0x35671d=JSON[_0x5f2548(0x1f8)](_0x39f46d),_0x3caf02=_0x35671d[_0x5f2548(0x2e4)][0x0][_0x5f2548(0x2db)];_0x35671d[_0x5f2548(0x2e4)][0x0]['headless']=!_0x3caf02;const _0x14cd3a=JSON[_0x5f2548(0x1cc)](_0x35671d,null,0x2);fs[_0x5f2548(0x1c5)](_0x1a8c58,_0x14cd3a),config=getConfiguration(),io['to'](_0x5f2548(0x2a0))[_0x5f2548(0x28a)](_0x5f2548(0x2fd),config);}}function telegramError(_0x1983cf){const _0x45247d=_0x29a69b;logger[_0x45247d(0x2d8)](getTimeStamp()+_0x45247d(0x304));}function validateTelegram(_0x20b357){const _0x28875e=_0x29a69b;if(_0x20b357[_0x28875e(0x1c1)][_0x28875e(0x1fb)]!=settings['telegramUsername']&&'@'+_0x20b357[_0x28875e(0x1c1)][_0x28875e(0x1fb)]!=settings[_0x28875e(0x1e0)])return tgBot[_0x28875e(0x30d)](_0x20b357['chat']['id'],_0x28875e(0x2c6),{'parse_mode':'HTML'})['catch'](_0x311642=>{telegramError(_0x311642);}),![];return!![];}async function initTelegram(){const _0x413600=_0x29a69b;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x413600(0x315)],{'polling':!![]});let _0xf3ad31=_0x413600(0x1b3);_0xf3ad31+='\x0a',_0xf3ad31+=_0x413600(0x22d),_0xf3ad31+='/disable\x20-\x20disable\x20notifications\x0a',_0xf3ad31+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0xf3ad31+=_0x413600(0x205),_0xf3ad31+=_0x413600(0x2df),_0xf3ad31+=_0x413600(0x1ba),_0xf3ad31+=_0x413600(0x237),_0xf3ad31+=_0x413600(0x1ad),_0xf3ad31+=_0x413600(0x2bc),_0xf3ad31+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0xf3ad31+=_0x413600(0x253),_0xf3ad31+=_0x413600(0x229);let _0x153bda=_0x413600(0x2b4);_0x153bda+='\x0a',_0x153bda+=_0xf3ad31,tgBot[_0x413600(0x286)](/\/start/,_0x54a62e=>{const _0x4048d8=_0x413600;if(!validateTelegram(_0x54a62e))return;if(settings[_0x4048d8(0x2c1)]!=_0x54a62e[_0x4048d8(0x2eb)]['id'])updateSetting(_0x4048d8(0x2c1),_0x54a62e[_0x4048d8(0x2eb)]['id']);updateSetting(_0x4048d8(0x2b5),!![]),tgBot[_0x4048d8(0x30d)](_0x54a62e[_0x4048d8(0x2eb)]['id'],_0x153bda)[_0x4048d8(0x27f)](_0x5f392f=>{telegramError(_0x5f392f);});}),tgBot['onText'](/\/enable/,_0x547c91=>{const _0x4d4b3b=_0x413600;if(!validateTelegram(_0x547c91))return;if(settings['telegramChatId']!=_0x547c91['chat']['id'])updateSetting(_0x4d4b3b(0x2c1),_0x547c91[_0x4d4b3b(0x2eb)]['id']);updateSetting(_0x4d4b3b(0x2b5),!![]),tgBot['sendMessage'](_0x547c91[_0x4d4b3b(0x2eb)]['id'],_0x4d4b3b(0x187))[_0x4d4b3b(0x27f)](_0x22db67=>{telegramError(_0x22db67);});}),tgBot[_0x413600(0x286)](/\/config/,async _0x3c231c=>{const _0x1a5eac=_0x413600;if(!validateTelegram(_0x3c231c))return;tgBot[_0x1a5eac(0x2cc)](_0x1a5eac(0x308)),tgBot['sendMessage'](_0x3c231c[_0x1a5eac(0x2eb)]['id'],_0x1a5eac(0x2e1),{'reply_markup':{'inline_keyboard':[[{'text':_0x1a5eac(0x1b8),'callback_data':_0x1a5eac(0x2f5)},{'text':'Alerts','callback_data':_0x1a5eac(0x239)},{'text':'All','callback_data':_0x1a5eac(0x1aa)}]]}})[_0x1a5eac(0x27f)](_0x41089a=>{telegramError(_0x41089a);}),tgBot['on'](_0x1a5eac(0x308),async _0xf151f8=>{const _0x2a5887=_0x1a5eac,_0x454bf7=_0xf151f8['data'],_0x1724a8=_0xf151f8[_0x2a5887(0x1e8)];tgBot['answerCallbackQuery'](_0xf151f8['id'])['then'](async()=>{const _0x229229=_0x2a5887;_0x454bf7=='orders'&&(updateSetting('telegramEvents','orders'),updateSetting(_0x229229(0x2b5),!![]),await tgBot[_0x229229(0x30d)](_0x1724a8[_0x229229(0x2eb)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x229229(0x27f)](_0x38248b=>{telegramError(_0x38248b);}));_0x454bf7==_0x229229(0x239)&&(updateSetting(_0x229229(0x283),_0x229229(0x239)),updateSetting(_0x229229(0x2b5),!![]),await tgBot[_0x229229(0x30d)](_0x1724a8[_0x229229(0x2eb)]['id'],_0x229229(0x289))['catch'](_0x4d4c72=>{telegramError(_0x4d4c72);}));_0x454bf7=='all'&&(updateSetting('telegramEvents','all'),updateSetting(_0x229229(0x2b5),!![]),await tgBot['sendMessage'](_0x1724a8[_0x229229(0x2eb)]['id'],_0x229229(0x247))['catch'](_0x1f5618=>{telegramError(_0x1f5618);}));if(!settings['telegramChatId'])tgBot[_0x229229(0x30d)](_0x1724a8[_0x229229(0x2eb)]['id'],_0x229229(0x2be))['catch'](_0x1c6874=>{telegramError(_0x1c6874);});}),tgBot[_0x2a5887(0x2cc)]('callback_query');});}),tgBot[_0x413600(0x286)](/\/status/,_0x232513=>{const _0x78f076=_0x413600;if(!validateTelegram(_0x232513))return;const _0x434a32=getBotsWithMode();let _0x59ab29=_0x78f076(0x2de);config[_0x78f076(0x1df)](_0x1d4c79=>{const _0x2c0758=_0x78f076,_0x36f6df=_0x434a32[_0x2c0758(0x30a)](_0x1d87cb=>_0x1d87cb[_0x2c0758(0x196)]==_0x1d4c79[_0x2c0758(0x196)])[_0x2c0758(0x214)];_0x59ab29+=_0x2c0758(0x1fa)+_0x1d4c79[_0x2c0758(0x196)]+':\x20'+_0x1d4c79[_0x2c0758(0x271)]+_0x2c0758(0x19a)+_0x36f6df+'\x20|\x20'+_0x1d4c79['live']+'\x0a';}),_0x59ab29+='\x0a',_0x59ab29+=_0x78f076(0x2cb),_0x59ab29+=!settings[_0x78f076(0x2b5)]?'Notifications\x20disabled\x0a':_0x78f076(0x19b),_0x59ab29+=settings[_0x78f076(0x2b5)]?settings[_0x78f076(0x283)]==_0x78f076(0x1aa)?_0x78f076(0x26d):_0x78f076(0x327)+settings[_0x78f076(0x283)]+'\x20only\x0a':'',tgBot[_0x78f076(0x30d)](_0x232513['chat']['id'],_0x59ab29,{'parse_mode':_0x78f076(0x25b)})[_0x78f076(0x27f)](_0x536db8=>{telegramError(_0x536db8);});}),tgBot['onText'](/\/restart/,_0x3a834c=>{const _0x379073=_0x413600;if(!validateTelegram(_0x3a834c))return;tgBot['removeListener'](_0x379073(0x308));const _0x424e0b=getEnabledBots();if(_0x424e0b[_0x379073(0x190)]==0x0)tgBot['sendMessage'](_0x3a834c[_0x379073(0x2eb)]['id'],_0x379073(0x1fc))[_0x379073(0x27f)](_0xd3ce65=>{telegramError(_0xd3ce65);});else{if(_0x424e0b[_0x379073(0x190)]>0x1)_0x424e0b[_0x379073(0x26b)]({'botID':_0x379073(0x1aa)});let _0x332f5d=[],_0x495072=[];const _0xe8d22=_0x424e0b['length']%0x4==0x0||_0x424e0b[_0x379073(0x190)]%0x4==0x3||_0x424e0b[_0x379073(0x190)]%0x3==0x1?0x4:0x3;let _0x382451=0x0;_0x424e0b['forEach']((_0x4325ce,_0x42aae7)=>{const _0x1b3660=_0x379073;if(_0x42aae7%_0xe8d22==0x0)_0x495072=[];_0x495072['push']({'text':_0x4325ce[_0x1b3660(0x196)]==_0x1b3660(0x1aa)?_0x1b3660(0x1b2):'Bot\x20'+_0x4325ce[_0x1b3660(0x196)],'callback_data':_0x4325ce[_0x1b3660(0x196)]}),_0x42aae7%_0xe8d22==0x0&&(_0x332f5d[_0x382451]=_0x495072,_0x382451++);}),tgBot[_0x379073(0x30d)](_0x3a834c['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x332f5d}})[_0x379073(0x27f)](_0x10e609=>{telegramError(_0x10e609);}),tgBot['on'](_0x379073(0x308),async _0x6d6d94=>{const _0x5972d9=_0x379073,_0x54e4ec=_0x6d6d94['data'],_0x14fc40=_0x6d6d94[_0x5972d9(0x1e8)];tgBot[_0x5972d9(0x252)](_0x6d6d94['id'])['then'](async()=>{const _0x5dc023=_0x5972d9;_0x54e4ec=='all'?config[_0x5dc023(0x1df)](_0xd9613=>{const _0x611918=_0x5dc023;restartBot(_0xd9613[_0x611918(0x196)]);}):restartBot(_0x54e4ec);}),tgBot[_0x5972d9(0x2cc)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x51b6b1=>{const _0x2af68d=_0x413600;if(!validateTelegram(_0x51b6b1))return;tgBot[_0x2af68d(0x2cc)](_0x2af68d(0x308));const _0x359e55=getDisabledBots();if(_0x359e55[_0x2af68d(0x190)]==0x0)tgBot[_0x2af68d(0x30d)](_0x51b6b1[_0x2af68d(0x2eb)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x2af68d(0x27f)](_0x53b7ba=>{telegramError(_0x53b7ba);});else{if(_0x359e55[_0x2af68d(0x190)]>0x1)_0x359e55[_0x2af68d(0x26b)]({'botID':'all'});let _0x43fe12=[],_0x516e8b=[];const _0x2f238d=_0x359e55[_0x2af68d(0x190)]%0x4==0x0||_0x359e55['length']%0x4==0x3||_0x359e55['length']%0x3==0x1?0x4:0x3;let _0x37d3a2=0x0;_0x359e55['forEach']((_0x2404b2,_0x49526f)=>{const _0x1b2f96=_0x2af68d;if(_0x49526f%_0x2f238d==0x0)_0x516e8b=[];_0x516e8b[_0x1b2f96(0x26b)]({'text':_0x2404b2[_0x1b2f96(0x196)]=='all'?_0x1b2f96(0x1b2):_0x1b2f96(0x1fa)+_0x2404b2[_0x1b2f96(0x196)],'callback_data':_0x2404b2[_0x1b2f96(0x196)]}),_0x49526f%_0x2f238d==0x0&&(_0x43fe12[_0x37d3a2]=_0x516e8b,_0x37d3a2++);}),tgBot[_0x2af68d(0x30d)](_0x51b6b1['chat']['id'],_0x2af68d(0x18f),{'reply_markup':{'inline_keyboard':_0x43fe12}})[_0x2af68d(0x27f)](_0x101510=>{telegramError(_0x101510);}),tgBot['on'](_0x2af68d(0x308),async _0x26b7e2=>{const _0x71c780=_0x2af68d,_0x1eea59=_0x26b7e2[_0x71c780(0x296)],_0x160b6a=_0x26b7e2[_0x71c780(0x1e8)];tgBot['answerCallbackQuery'](_0x26b7e2['id'])[_0x71c780(0x1b1)](async()=>{const _0x6dcce3=_0x71c780;_0x1eea59==_0x6dcce3(0x1aa)?(tgBot[_0x6dcce3(0x30d)](_0x160b6a[_0x6dcce3(0x2eb)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x3b7dc3=>{telegramError(_0x3b7dc3);}),_0x359e55[_0x6dcce3(0x1df)](_0x153fda=>{const _0x4562eb=_0x6dcce3;if(_0x153fda[_0x4562eb(0x196)]!='all')toggleBot(_0x153fda[_0x4562eb(0x196)],toggleStatus(_0x153fda[_0x4562eb(0x196)]),'stopped');})):(tgBot['sendMessage'](_0x160b6a[_0x6dcce3(0x2eb)]['id'],_0x6dcce3(0x1c2)+_0x1eea59)[_0x6dcce3(0x27f)](_0x2463f5=>{telegramError(_0x2463f5);}),toggleBot(_0x1eea59,toggleStatus(_0x1eea59),_0x6dcce3(0x2c9)));}),tgBot[_0x71c780(0x2cc)](_0x71c780(0x308));});}}),tgBot[_0x413600(0x286)](/\/off/,_0x437aa0=>{const _0x11d172=_0x413600;if(!validateTelegram(_0x437aa0))return;tgBot['removeListener'](_0x11d172(0x308));const _0x5ec2f9=getEnabledBots();if(_0x5ec2f9[_0x11d172(0x190)]==0x0)tgBot['sendMessage'](_0x437aa0[_0x11d172(0x2eb)]['id'],_0x11d172(0x1fc))[_0x11d172(0x27f)](_0x2d4ff5=>{telegramError(_0x2d4ff5);});else{if(_0x5ec2f9[_0x11d172(0x190)]>0x1)_0x5ec2f9[_0x11d172(0x26b)]({'botID':_0x11d172(0x1aa)});let _0x4d88fa=[],_0x38f94e=[];const _0x39445c=_0x5ec2f9[_0x11d172(0x190)]%0x4==0x0||_0x5ec2f9[_0x11d172(0x190)]%0x4==0x3||_0x5ec2f9['length']%0x3==0x1?0x4:0x3;let _0x1c5dd4=0x0;_0x5ec2f9[_0x11d172(0x1df)]((_0x396312,_0x1d995e)=>{const _0x2f5167=_0x11d172;if(_0x1d995e%_0x39445c==0x0)_0x38f94e=[];_0x38f94e[_0x2f5167(0x26b)]({'text':_0x396312[_0x2f5167(0x196)]=='all'?_0x2f5167(0x1b2):_0x2f5167(0x1fa)+_0x396312['botID'],'callback_data':_0x396312[_0x2f5167(0x196)]}),_0x1d995e%_0x39445c==0x0&&(_0x4d88fa[_0x1c5dd4]=_0x38f94e,_0x1c5dd4++);}),tgBot[_0x11d172(0x30d)](_0x437aa0['chat']['id'],_0x11d172(0x2cf),{'reply_markup':{'inline_keyboard':_0x4d88fa}})[_0x11d172(0x27f)](_0x477128=>{telegramError(_0x477128);}),tgBot['on'](_0x11d172(0x308),async _0x1dde6a=>{const _0x1ff2de=_0x11d172,_0x502040=_0x1dde6a[_0x1ff2de(0x296)],_0x451301=_0x1dde6a[_0x1ff2de(0x1e8)];tgBot[_0x1ff2de(0x252)](_0x1dde6a['id'])['then'](async()=>{const _0x1c59ec=_0x1ff2de;_0x502040==_0x1c59ec(0x1aa)?(tgBot[_0x1c59ec(0x30d)](_0x451301[_0x1c59ec(0x2eb)]['id'],_0x1c59ec(0x1d4))[_0x1c59ec(0x27f)](_0x12d564=>{telegramError(_0x12d564);}),_0x5ec2f9[_0x1c59ec(0x1df)](_0x4a5829=>{const _0x4b56ac=_0x1c59ec;if(_0x4a5829[_0x4b56ac(0x196)]!='all')toggleBot(_0x4a5829['botID'],toggleStatus(_0x4a5829[_0x4b56ac(0x196)]),'stopped');})):(tgBot[_0x1c59ec(0x30d)](_0x451301[_0x1c59ec(0x2eb)]['id'],_0x1c59ec(0x30f)+_0x502040)[_0x1c59ec(0x27f)](_0x39e94f=>{telegramError(_0x39e94f);}),toggleBot(_0x502040,toggleStatus(_0x502040),'stopped'));}),tgBot['removeListener'](_0x1ff2de(0x308));});}}),tgBot[_0x413600(0x286)](/\/portfolio/,_0x21d8b5=>{const _0x4db203=_0x413600;if(!validateTelegram(_0x21d8b5))return;tgBot['removeListener'](_0x4db203(0x308));const _0x141e45=getEnabledBots();if(_0x141e45['length']==0x0)tgBot['sendMessage'](_0x21d8b5[_0x4db203(0x2eb)]['id'],_0x4db203(0x1fc))['catch'](_0x199904=>{telegramError(_0x199904);});else{if(_0x141e45[_0x4db203(0x190)]>0x1){let _0x137aaa=[],_0x55defc=[];const _0x5c6e40=_0x141e45[_0x4db203(0x190)]%0x4==0x0||_0x141e45['length']%0x4==0x3||_0x141e45[_0x4db203(0x190)]%0x3==0x1?0x4:0x3;let _0x14fea5=0x0;_0x141e45[_0x4db203(0x1df)]((_0x399c8f,_0x313819)=>{const _0x2b23bc=_0x4db203;if(_0x313819%_0x5c6e40==0x0)_0x55defc=[];_0x55defc[_0x2b23bc(0x26b)]({'text':_0x2b23bc(0x1fa)+_0x399c8f[_0x2b23bc(0x196)],'callback_data':_0x399c8f[_0x2b23bc(0x196)]}),_0x313819%_0x5c6e40==0x0&&(_0x137aaa[_0x14fea5]=_0x55defc,_0x14fea5++);}),tgBot['sendMessage'](_0x21d8b5['chat']['id'],_0x4db203(0x2e0),{'reply_markup':{'inline_keyboard':_0x137aaa}})[_0x4db203(0x27f)](_0x4a1d37=>{telegramError(_0x4a1d37);}),tgBot['on'](_0x4db203(0x308),async _0x4c71a9=>{const _0x485989=_0x4db203,_0xd050ab=_0x4c71a9[_0x485989(0x296)],_0x1f435a=_0x4c71a9[_0x485989(0x1e8)];tgBot[_0x485989(0x252)](_0x4c71a9['id'])[_0x485989(0x1b1)](async()=>{const _0x33ab6f=_0x485989;if(pid[_0xd050ab])pid[_0xd050ab][_0x33ab6f(0x1f7)]({'function':_0x33ab6f(0x267),'args':null});}),tgBot[_0x485989(0x2cc)](_0x485989(0x308));});}else{const _0x4489c0=_0x141e45[0x0][_0x4db203(0x196)];if(pid[_0x4489c0])pid[_0x4489c0]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x413600(0x286)](/\/update/,async _0x4a583c=>{const _0x897b3=_0x413600;if(!validateTelegram(_0x4a583c))return;tgBot[_0x897b3(0x2cc)](_0x897b3(0x308)),await getMessages();if(!updateAvailable)tgBot[_0x897b3(0x30d)](_0x4a583c[_0x897b3(0x2eb)]['id'],_0x897b3(0x1ff))[_0x897b3(0x27f)](_0xd116bd=>{telegramError(_0xd116bd);});else!validInstallation?tgBot[_0x897b3(0x30d)](_0x4a583c['chat']['id'],_0x897b3(0x262))[_0x897b3(0x27f)](_0xdf9ecf=>{telegramError(_0xdf9ecf);}):(tgBot[_0x897b3(0x30d)](_0x4a583c[_0x897b3(0x2eb)]['id'],_0x897b3(0x203),{'reply_markup':{'inline_keyboard':[[{'text':_0x897b3(0x2fc),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x897b3(0x27f)](_0x427078=>{telegramError(_0x427078);}),tgBot['on'](_0x897b3(0x308),async _0x556ba6=>{const _0x3084e3=_0x897b3,_0x1481a7=_0x556ba6['data'],_0x1a06ec=_0x556ba6['message'];tgBot[_0x3084e3(0x252)](_0x556ba6['id'])[_0x3084e3(0x1b1)](async()=>{const _0x1747ab=_0x3084e3;_0x1481a7==_0x1747ab(0x1bb)&&(await tgBot[_0x1747ab(0x30d)](_0x1a06ec[_0x1747ab(0x2eb)]['id'],_0x1747ab(0x311))[_0x1747ab(0x27f)](_0x317d86=>{telegramError(_0x317d86);}),updateBB());_0x1481a7=='no'&&await tgBot[_0x1747ab(0x30d)](_0x1a06ec[_0x1747ab(0x2eb)]['id'],_0x1747ab(0x189))[_0x1747ab(0x27f)](_0x3c70b8=>{telegramError(_0x3c70b8);});if(!settings[_0x1747ab(0x2c1)])tgBot[_0x1747ab(0x30d)](_0x1a06ec[_0x1747ab(0x2eb)]['id'],_0x1747ab(0x2be))[_0x1747ab(0x27f)](_0x17f0b2=>{telegramError(_0x17f0b2);});}),tgBot[_0x3084e3(0x2cc)]('callback_query');}));}),tgBot[_0x413600(0x286)](/\/toggle/,_0x2de735=>{const _0x296641=_0x413600;if(!validateTelegram(_0x2de735))return;tgBot['removeListener'](_0x296641(0x308));const _0x1fd360=getBotsWithMode();if(_0x1fd360[_0x296641(0x190)]==0x0)tgBot[_0x296641(0x30d)](_0x2de735[_0x296641(0x2eb)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x296641(0x27f)](_0x56be35=>{telegramError(_0x56be35);});else{let _0xf9fc19=[],_0x33242d=[];const _0x514a41=0x2;let _0x1ce4ed=0x0;_0x1fd360[_0x296641(0x1df)]((_0x35801c,_0x325076)=>{const _0xbcdf0d=_0x296641;if(_0x325076%_0x514a41==0x0)_0x33242d=[];_0x33242d[_0xbcdf0d(0x26b)]({'text':'Bot\x20'+_0x35801c['botID']+'\x20('+_0x35801c[_0xbcdf0d(0x214)]+')','callback_data':_0x35801c[_0xbcdf0d(0x196)]}),_0x325076%_0x514a41==0x0&&(_0xf9fc19[_0x1ce4ed]=_0x33242d,_0x1ce4ed++);}),tgBot[_0x296641(0x30d)](_0x2de735[_0x296641(0x2eb)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0xf9fc19}})[_0x296641(0x27f)](_0x41f968=>{telegramError(_0x41f968);}),tgBot['on'](_0x296641(0x308),async _0x56318b=>{const _0x1fd771=_0x296641,_0xc58e27=_0x56318b[_0x1fd771(0x296)],_0x1f0f81=_0x56318b[_0x1fd771(0x1e8)];tgBot[_0x1fd771(0x252)](_0x56318b['id'])[_0x1fd771(0x1b1)](async()=>{const _0x5a44a9=_0x1fd771,_0x1a3bb8=_0x1fd360['find'](_0x42749f=>_0x42749f[_0x5a44a9(0x196)]==_0xc58e27),_0xa4add9=_0x1a3bb8[_0x5a44a9(0x214)]==_0x5a44a9(0x28d)?_0x5a44a9(0x26e):_0x5a44a9(0x28d);tgBot[_0x5a44a9(0x30d)](_0x1f0f81[_0x5a44a9(0x2eb)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0xc58e27+_0x5a44a9(0x1bd)+_0xa4add9+_0x5a44a9(0x1d0))[_0x5a44a9(0x27f)](_0x26e166=>{telegramError(_0x26e166);}),toggleBotMode(_0xc58e27);}),tgBot[_0x1fd771(0x2cc)](_0x1fd771(0x308));});}}),tgBot[_0x413600(0x286)](/\/names/,_0xae3f23=>{const _0x30364b=_0x413600;if(!validateTelegram(_0xae3f23))return;let _0x5a3ded='';config[_0x30364b(0x1df)](_0x3bc85f=>{const _0x2e09db=_0x30364b;_0x5a3ded+=_0x2e09db(0x1fa)+_0x3bc85f['botID']+':\x20'+_0x3bc85f[_0x2e09db(0x1eb)]+'\x0a';}),tgBot[_0x30364b(0x30d)](_0xae3f23[_0x30364b(0x2eb)]['id'],_0x5a3ded,{'parse_mode':_0x30364b(0x25b)})[_0x30364b(0x27f)](_0x16b898=>{telegramError(_0x16b898);});}),tgBot[_0x413600(0x286)](/\/disable/,_0x1ae85b=>{const _0x177ecc=_0x413600;if(!validateTelegram(_0x1ae85b))return;tgBot[_0x177ecc(0x30d)](_0x1ae85b['chat']['id'],_0x177ecc(0x2fb))['catch'](_0x449499=>{telegramError(_0x449499);}),updateSetting(_0x177ecc(0x2b5),![]);}),tgBot[_0x413600(0x286)](/\/help/,_0x15f174=>{const _0x53e3ae=_0x413600;if(!validateTelegram(_0x15f174))return;tgBot[_0x53e3ae(0x30d)](_0x15f174[_0x53e3ae(0x2eb)]['id'],_0xf3ad31)[_0x53e3ae(0x27f)](_0x34073d=>{telegramError(_0x34073d);});}),tgBot['on'](_0x413600(0x1ac),_0x4ae177=>{const _0x31b0dc=_0x413600;_0x4ae177['toString']()[_0x31b0dc(0x317)](_0x31b0dc(0x313))&&(logger[_0x31b0dc(0x1dd)](_0x31b0dc(0x257)),tgBot[_0x31b0dc(0x220)](),tgBot=null,io['to'](_0x31b0dc(0x2a0))[_0x31b0dc(0x28a)]('notification',_0x31b0dc(0x257)));}),process[_0x413600(0x2ce)](_0x413600(0x18c),()=>{const _0x15e5b2=_0x413600;if(tgBot)tgBot['stopPolling']();process[_0x15e5b2(0x2e5)](0x1);}),process[_0x413600(0x2ce)](_0x413600(0x301),()=>{const _0x56b88f=_0x413600;if(tgBot)tgBot[_0x56b88f(0x220)]();process[_0x56b88f(0x2e5)](0x1);});}}function disableTelegram(){const _0x9bdd9d=_0x29a69b;tgBot&&(tgBot[_0x9bdd9d(0x220)](),tgBot=null);}function sendTelegram(_0x58b52f,_0x13816a){const _0x40a5ea=_0x29a69b;if(settings['telegramEnabled']){if(settings[_0x40a5ea(0x283)]==_0x40a5ea(0x1aa)||(_0x13816a['type']==_0x40a5ea(0x2e2)||_0x13816a[_0x40a5ea(0x20b)]==_0x40a5ea(0x226)||_0x13816a[_0x40a5ea(0x20b)]=='success')&&settings[_0x40a5ea(0x283)]==_0x40a5ea(0x239)||_0x13816a[_0x40a5ea(0x20b)]==_0x40a5ea(0x2f2)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x40a5ea(0x2c1)]){if(_0x13816a[_0x40a5ea(0x25c)])tgBot[_0x40a5ea(0x30d)](settings[_0x40a5ea(0x2c1)],_0x13816a[_0x40a5ea(0x1eb)]+'\x20>\x20'+_0x13816a[_0x40a5ea(0x27a)])[_0x40a5ea(0x27f)](_0x2e733e=>{telegramError(_0x2e733e);});else tgBot[_0x40a5ea(0x30d)](settings[_0x40a5ea(0x2c1)],'Bot\x20'+_0x58b52f+_0x40a5ea(0x2ff)+_0x13816a[_0x40a5ea(0x27a)])[_0x40a5ea(0x27f)](_0x1098b9=>{telegramError(_0x1098b9);});}}}}async function sendTelegramMsg(_0x357148,_0x3b9c3c=_0x29a69b(0x25b)){const _0x43f7cd=_0x29a69b;return settings[_0x43f7cd(0x2b5)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0x43f7cd(0x2c1)],_0x357148,{'parse_mode':_0x3b9c3c})[_0x43f7cd(0x27f)](_0x313cfc=>{telegramError(_0x313cfc);}),!![]):![];}function getDeviceWithIp(_0x50b71e){return devices['find'](_0xa70005=>_0xa70005['ip']===_0x50b71e);}function temporaryAccess2FA(_0x4bcde0,_0x1c73e9){const _0x322734=_0x29a69b;let _0x319b12=new Date(),_0x1e9da7=![];if(lastIpApproval){if(_0x319b12-lastIpApproval<0x1388)_0x1e9da7=!![];}lastIpApproval=new Date();if(_0x1e9da7)return;tgBot&&settings[_0x322734(0x2c1)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x322734(0x30d)](settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1c73e9)[_0x322734(0x274)]+_0x322734(0x285),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x322734(0x1bf),'callback_data':'15'},{'text':_0x322734(0x1ae),'callback_data':'30'},{'text':_0x322734(0x2af),'callback_data':_0x322734(0x2af)}]]}})[_0x322734(0x27f)](_0x3d8572=>{telegramError(_0x3d8572);}),tgBot['on'](_0x322734(0x308),async _0x5809f8=>{const _0x3574fb=_0x322734,_0x5d6a4a=_0x5809f8['data'],_0x4282fa=_0x5809f8['message'];tgBot[_0x3574fb(0x252)](_0x5809f8['id'])[_0x3574fb(0x1b1)](async()=>{const _0x1f39f6=_0x3574fb;devices[_0x4bcde0][_0x1f39f6(0x24b)]={'clientip':_0x1c73e9,'timestamp':new Date()[_0x1f39f6(0x320)](),'expiry':_0x5d6a4a},_0x5d6a4a!=_0x1f39f6(0x2af)?(await tgBot['sendMessage'](_0x4282fa['chat']['id'],_0x1f39f6(0x29c)+_0x5d6a4a+_0x1f39f6(0x2bb),{'parse_mode':_0x1f39f6(0x25b)})[_0x1f39f6(0x27f)](_0x50d819=>{telegramError(_0x50d819);}),io['to'](_0x4bcde0)[_0x1f39f6(0x28a)](_0x1f39f6(0x271),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x1f39f6(0x30d)](_0x4282fa[_0x1f39f6(0x2eb)]['id'],_0x1f39f6(0x1f0))[_0x1f39f6(0x27f)](_0x3187f1=>{telegramError(_0x3187f1);}),io['to'](_0x4bcde0)[_0x1f39f6(0x28a)](_0x1f39f6(0x271),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x3574fb(0x2cc)](_0x3574fb(0x308));}));}function loginAccess2FA(_0x63c621,_0x2b5367){const _0x42195a=_0x29a69b;tgBot&&settings[_0x42195a(0x2c1)]&&(tgBot[_0x42195a(0x2cc)](_0x42195a(0x308)),tgBot['sendMessage'](settings[_0x42195a(0x2c1)],_0x42195a(0x2b9)+normalizeIP(_0x2b5367)['show']+_0x42195a(0x285),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x42195a(0x26f),'callback_data':loginExpiry},{'text':_0x42195a(0x2af),'callback_data':_0x42195a(0x2af)}]]}})[_0x42195a(0x27f)](_0x2f0604=>{telegramError(_0x2f0604);}),tgBot['on'](_0x42195a(0x308),async _0x5d85c9=>{const _0x4c95b3=_0x42195a,_0x3b695c=_0x5d85c9[_0x4c95b3(0x296)],_0x5e2c38=_0x5d85c9[_0x4c95b3(0x1e8)];tgBot[_0x4c95b3(0x252)](_0x5d85c9['id'])[_0x4c95b3(0x1b1)](async()=>{const _0x51c8b1=_0x4c95b3;devices[_0x63c621]['telegram2FaApproval']={'clientip':_0x2b5367,'timestamp':new Date()[_0x51c8b1(0x320)](),'expiry':_0x3b695c},_0x3b695c!='reject'?(await tgBot[_0x51c8b1(0x30d)](_0x5e2c38[_0x51c8b1(0x2eb)]['id'],'Login\x20accepted',{'parse_mode':_0x51c8b1(0x25b)})[_0x51c8b1(0x27f)](_0x2a5627=>{telegramError(_0x2a5627);}),io['to'](_0x63c621)['emit']('status',{'access':{'allow':![],'reason':_0x51c8b1(0x23e),'token':null}})):(await tgBot['sendMessage'](_0x5e2c38[_0x51c8b1(0x2eb)]['id'],_0x51c8b1(0x1f3))[_0x51c8b1(0x27f)](_0x443c41=>{telegramError(_0x443c41);}),io['to'](_0x63c621)['emit'](_0x51c8b1(0x271),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x4c95b3(0x2cc)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x49bd86=_0x29a69b;return dbConfig[_0x49bd86(0x27d)](_0x49bd86(0x2fd))[_0x49bd86(0x2d5)](_0x49bd86(0x196))[_0x49bd86(0x230)]({'status':_0x49bd86(0x2d4)})[_0x49bd86(0x318)]()||[];}function getDisabledBots(){const _0x2c4c52=_0x29a69b;return dbConfig[_0x2c4c52(0x27d)](_0x2c4c52(0x2fd))[_0x2c4c52(0x2d5)](_0x2c4c52(0x196))[_0x2c4c52(0x230)]({'status':_0x2c4c52(0x278)})[_0x2c4c52(0x318)]()||[];}function getBotAttributes(_0x48cd39){const _0x2c25ea=_0x29a69b;let _0x2d96e4={};const _0x2a4e2a=configpath+_0x2c25ea(0x211)+_0x48cd39+_0x2c25ea(0x186),_0x40d499=fs['existsSync'](_0x2a4e2a);if(_0x40d499){const _0x4e81ea=fs[_0x2c25ea(0x25f)](_0x2a4e2a);try{const _0x3f498a=JSON[_0x2c25ea(0x1f8)](_0x4e81ea),_0x139561=_0x3f498a?_0x3f498a['bot'][0x0][_0x2c25ea(0x2db)]:![];_0x2d96e4[_0x2c25ea(0x214)]=_0x139561?_0x2c25ea(0x28d):_0x2c25ea(0x26e),_0x2d96e4[_0x2c25ea(0x1eb)]=_0x3f498a?_0x3f498a[_0x2c25ea(0x2e4)][0x0]['botname']:_0x2c25ea(0x1fa)+_0x48cd39;}catch(_0xf8ce32){_0x2d96e4[_0x2c25ea(0x214)]=_0x2c25ea(0x26e),_0x2d96e4[_0x2c25ea(0x1eb)]=_0x2c25ea(0x1fa)+_0x48cd39;}}else _0x2d96e4['mode']=_0x2c25ea(0x26e),_0x2d96e4['botname']=_0x2c25ea(0x1fa)+_0x48cd39;return _0x2d96e4;}function getBotsWithMode(){const _0x5e192b=_0x29a69b,_0x409848=dbConfig[_0x5e192b(0x27d)]('bots')[_0x5e192b(0x2d5)](_0x5e192b(0x196))[_0x5e192b(0x318)]()||[];return _0x409848[_0x5e192b(0x1df)](_0x2cd5c9=>{const _0x516f2d=_0x5e192b;let _0x43a01b=getBotAttributes(_0x2cd5c9['botID']);_0x2cd5c9['mode']=_0x43a01b[_0x516f2d(0x214)];}),_0x409848;}function getBotExchanges(){const _0x5bba7b=_0x29a69b;let _0x1eb324=[];const _0x1761dc=dbConfig[_0x5bba7b(0x27d)](_0x5bba7b(0x2fd))[_0x5bba7b(0x2d5)]('botID')[_0x5bba7b(0x318)]()||[];_0x1761dc[_0x5bba7b(0x1df)](_0x5ef1f6=>{const _0x1c4a01=_0x5bba7b;if(_0x5ef1f6[_0x1c4a01(0x271)]==_0x1c4a01(0x2d4)){const _0x55279b=configpath+_0x1c4a01(0x211)+_0x5ef1f6[_0x1c4a01(0x196)]+_0x1c4a01(0x186),_0x166ddd=fs[_0x1c4a01(0x1f5)](_0x55279b);let _0x292d60;if(_0x166ddd){const _0x3e79b4=fs[_0x1c4a01(0x25f)](_0x55279b);try{const _0x9eb2b1=JSON[_0x1c4a01(0x1f8)](_0x3e79b4);_0x292d60=_0x9eb2b1?_0x9eb2b1[_0x1c4a01(0x2e4)][0x0]['exchange']:null;}catch(_0x4ab4a7){}}if(_0x292d60)_0x1eb324[_0x1c4a01(0x26b)](_0x292d60);}});const _0x100c40=[...new Set(_0x1eb324)][_0x5bba7b(0x199)]();return _0x100c40;}async function initUser(){const _0x208b8d=_0x29a69b;if(!settings[_0x208b8d(0x231)]){const _0x120119=uuidRandom();mixpanel[_0x208b8d(0x2aa)](_0x120119),updateSetting(_0x208b8d(0x231),_0x120119);}}async function initSecure(){const _0x242c50=_0x29a69b;let _0x3f4190=getSecure();if(!_0x3f4190[_0x242c50(0x23b)](_0x242c50(0x20c))){let _0x2b3ad7=await generateKeys();_0x3f4190[_0x242c50(0x202)]=_0x2b3ad7['publicKey'],_0x3f4190[_0x242c50(0x2fe)]=_0x2b3ad7[_0x242c50(0x2fe)],_0x3f4190['secret']=crypto[_0x242c50(0x1d3)](0x20)[_0x242c50(0x201)](_0x242c50(0x2bd));;storeSecure(_0x3f4190);}}function getSettings(){const _0x2d5393=_0x29a69b;return dbSettings[_0x2d5393(0x27d)](_0x2d5393(0x21a))[_0x2d5393(0x318)]()||{};}function getSecure(){const _0x4fdc12=_0x29a69b;return dbSecure[_0x4fdc12(0x27d)]('secure')[_0x4fdc12(0x318)]()||{};}function getBlacklist(){const _0x227131=_0x29a69b;return dbSecure['get'](_0x227131(0x191))['value']()||[];}function broadcastToBots(_0x55291a,_0x3bd4c9){const _0x94224e=_0x29a69b;config[_0x94224e(0x1df)](_0x5568d2=>{const _0x1ea2ba=_0x94224e;if(_0x5568d2[_0x1ea2ba(0x271)]=='enabled'&&_0x5568d2[_0x1ea2ba(0x1c0)]=='running'){if(pid[_0x5568d2[_0x1ea2ba(0x196)]])pid[_0x5568d2['botID']]['send']({[_0x55291a]:_0x3bd4c9});}});}function storeSettings(_0x293395,_0x1c414f=![]){const _0x5bcf42=_0x29a69b;_0x293395={...settings,..._0x293395};if(_0x1c414f&&_0x293395[_0x5bcf42(0x227)]!=_0x5bcf42(0x266)&&_0x293395[_0x5bcf42(0x227)]!='***'&&_0x293395[_0x5bcf42(0x227)]!=''){const _0x22a6f8=crypt['decrypt'](secure[_0x5bcf42(0x2fe)],_0x293395[_0x5bcf42(0x227)])[_0x5bcf42(0x1e8)][_0x5bcf42(0x321)]('@')[0x0],_0x1c9f6c=bcrypt[_0x5bcf42(0x1f2)](_0x22a6f8,saltRounds);_0x293395={..._0x293395,'bbPassword':_0x1c9f6c};}if(_0x1c414f&&_0x293395[_0x5bcf42(0x315)]!=_0x5bcf42(0x266)&&_0x293395[_0x5bcf42(0x315)]!=_0x5bcf42(0x280)&&_0x293395[_0x5bcf42(0x315)]!=''){const _0x516901=crypt[_0x5bcf42(0x251)](secure[_0x5bcf42(0x2fe)],_0x293395[_0x5bcf42(0x315)])[_0x5bcf42(0x1e8)][_0x5bcf42(0x321)]('@')[0x0];_0x293395={..._0x293395,'telegramToken':_0x516901};}const _0x383082=_0x293395[_0x5bcf42(0x315)]!=_0x5bcf42(0x266)&&_0x293395[_0x5bcf42(0x315)]!=settings[_0x5bcf42(0x315)]||_0x293395['telegramUsername']!=settings[_0x5bcf42(0x1e0)],_0x454ca1=_0x293395[_0x5bcf42(0x315)]==''||_0x293395[_0x5bcf42(0x1e0)]=='';if(_0x383082)_0x293395[_0x5bcf42(0x283)]=_0x5bcf42(0x1aa);for(const [_0xb5f696,_0x3af035]of Object[_0x5bcf42(0x1b0)](_0x293395)){if(_0xb5f696==_0x5bcf42(0x315)&&_0x3af035==_0x5bcf42(0x266)){_0x293395[_0x5bcf42(0x315)]=settings[_0x5bcf42(0x315)];continue;};if(_0xb5f696==_0x5bcf42(0x227)&&_0x3af035==_0x5bcf42(0x266)){_0x293395[_0x5bcf42(0x227)]=settings[_0x5bcf42(0x227)];continue;};dbSettings[_0x5bcf42(0x24d)](_0x5bcf42(0x2a5)+_0xb5f696,_0x3af035)[_0x5bcf42(0x21b)]();}settings=_0x293395,io['to'](_0x5bcf42(0x2a0))[_0x5bcf42(0x28a)](_0x5bcf42(0x21a),cleanSettings()),broadcastToBots('timeshift',settings[_0x5bcf42(0x18a)]);if(_0x383082&&!_0x454ca1)initTelegram();if(_0x383082&&_0x454ca1)disableTelegram();getAllClients()[_0x5bcf42(0x1df)](_0x5dfa89=>{const _0x4e7026=_0x5bcf42;getSocket(_0x5dfa89['id'])['emit'](_0x4e7026(0x271),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x438417,_0x507eea){const _0x173d02=_0x29a69b;dbSettings['set'](_0x173d02(0x2a5)+_0x438417,_0x507eea)[_0x173d02(0x21b)](),settings=getSettings(),io['to'](_0x173d02(0x2a0))[_0x173d02(0x28a)](_0x173d02(0x21a),cleanSettings());}function storeSecure(_0x3d13df){const _0x11cf1e=_0x29a69b;dbSecure[_0x11cf1e(0x27d)](_0x11cf1e(0x1e4))[_0x11cf1e(0x26b)](_0x3d13df)[_0x11cf1e(0x21b)](),secure=_0x3d13df;}function addBlacklist(_0x3744f4){const _0x55b888=_0x29a69b;cleanBlacklist();let _0x2a1edb;devices[_0x3744f4][_0x55b888(0x24b)]?_0x2a1edb=Math['max'](devices[_0x3744f4][_0x55b888(0x24b)][_0x55b888(0x1b5)],loginExpiry):_0x2a1edb=loginExpiry,dbSecure[_0x55b888(0x27d)](_0x55b888(0x191))['push']({'expiry':new Date()['getTime']()+_0x2a1edb*0x3c*0x3e8,'token':devices[_0x3744f4][_0x55b888(0x2ea)][_0x55b888(0x2e9)]})[_0x55b888(0x21b)](),blacklist=dbSecure['get'](_0x55b888(0x191))['value']();}function cleanBlacklist(){const _0x56b00a=_0x29a69b;let _0x5bb088=dbSecure[_0x56b00a(0x27d)](_0x56b00a(0x191))[_0x56b00a(0x1a1)]()['value'](),_0xf55a0f=new Date()['getTime']();_0x5bb088[_0x56b00a(0x1df)](_0x5e14ac=>{const _0x1fe7f4=_0x56b00a;_0x5e14ac[_0x1fe7f4(0x1b5)]<_0xf55a0f&&dbSecure[_0x1fe7f4(0x27d)](_0x1fe7f4(0x191))[_0x1fe7f4(0x31c)]({'expiry':_0x5e14ac[_0x1fe7f4(0x1b5)]})[_0x1fe7f4(0x21b)]();});}function _0xfb4a(_0xbae643,_0x40dd8c){const _0x564278=_0x3693();return _0xfb4a=function(_0x4e6098,_0x315b22){_0x4e6098=_0x4e6098-0x185;let _0x36939e=_0x564278[_0x4e6098];return _0x36939e;},_0xfb4a(_0xbae643,_0x40dd8c);}function initStates(){const _0x5d42a8=_0x29a69b;let _0x46ad63=getConfiguration();_0x46ad63[_0x5d42a8(0x1df)](_0xa437a4=>{const _0x24fcb2=_0x5d42a8;_0xa437a4[_0x24fcb2(0x1c0)]=_0x24fcb2(0x2c9);}),storeConfiguration(_0x46ad63);}function onKeys(){const _0x341c4d=new RSA();return new Promise(_0x425f58=>{const _0x176b9e=_0xfb4a;_0x341c4d[_0x176b9e(0x22f)]()[_0x176b9e(0x1b1)](_0x59a330=>{_0x425f58(_0x59a330);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x375208=_0x29a69b;let _0x4e0956=getSettings(),_0x5e9789=![];!_0x4e0956['hasOwnProperty'](_0x375208(0x268))&&(_0x4e0956[_0x375208(0x268)]=0x0,_0x5e9789=!![]);!_0x4e0956[_0x375208(0x23b)](_0x375208(0x218))&&(_0x4e0956['lastmsgemitted']=0x0,_0x5e9789=!![]);!_0x4e0956[_0x375208(0x23b)](_0x375208(0x272))&&(_0x4e0956[_0x375208(0x272)]='0.0.0',_0x5e9789=!![]);if(_0x5e9789)storeSettings(_0x4e0956);}function _0x3693(){const _0x35a34e=['stopPolling','verify','2FA\x20login\x20required','timestamp','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','warning','bbPassword','backupfile','/help\x20-\x20show\x20available\x20commands\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','sendFile','logged\x20out','/enable\x20-\x20enable\x20notifications\x0a','toIPv4Address','generateKeyPairAsync','filter','userid','7YRsjHT','apiKey','2FA\x20login\x20token\x20generated','RSA-OAEP','format','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','restarting\x20Bot\x20','alerts','delete-alerts','hasOwnProperty','rmSync','login','reload','isIPv4MappedAddress','/:bot/configuration',',\x20must\x20be\x20a\x204\x20digit\x20number','\x20(2)','output-003.log','*$1*','bbUsername','logs/','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','api-eu.mixpanel.com','stop','getDate','telegramIpApproval','https://api.ipify.org?format=json','set','inherit','join','Invalid\x20authentication\x20token\x20(2)','decrypt','answerCallbackQuery','/update\x20-\x20update\x20Balance\x20Bot\x0a','54tSIzEc','isValid','args','Invalid\x20Telegram\x20token','function','axios','exec','HTML','showname','Error:\x20Invalid\x20argument\x20','node-telegram-bot-api','readFileSync','replace','Unauthorized\x20attempt\x20to\x20add\x20bot','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','login\x20not\x20required','lowdb','createServer','************','sendPortfolioTelegram','lastmsgtelegram','node-zip','compareSync','push','initclient','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','manual','accept','version','status','latestversion','name','show','1000','padStart','storeHeadless','disabled','idling\x20bot\x20\x20\x20|\x20Bot\x20','event','2881552QcLkzx','temporary\x20token\x20generated','get','127.0.0.1','catch','***','backup/','randomFillSync','telegramEvents','constructor','</b>\x20?','onText','uuid','Unauthorized\x20attempt\x20to\x20log\x20out','Ok,\x20will\x20send\x20alert\x20notifications\x20only','emit','(((.+)+)+)+$','placeOrder','auto','copyFileSync','f2aRequired','/:bot','connected','yargs/yargs','bbvReceive','File\x20uploaded','confirm-message','data','1066630sNsMlU','error\x20while\x20deleting\x20config\x20files:\x20','build','port','mixpanel','Access\x20enabled\x20for\x20','test','kind','config/','botmanager','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','post','settings.','bb-config.json','bb-secure.json','-results.json','whitelistEnabled','alias','params','Token\x20blacklisted','whitelist','6b67f3d61ee94b8f5c80b4affef4c4d9','reject','title','5VZOlht','static','login\x20required','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','telegramEnabled','::ffff:127.0.0.1','auth','User\x20has\x20been\x20validated','Allow\x20login\x20from\x20IP\x20address\x20<b>','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','\x20minutes','/status\x20-\x20show\x20bot(s)\x20status\x0a','hex','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','output-002.log','access\x20timeout','telegramChatId','referer','clientip','update-bot','reason','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','/download/:type','stopped','.zip','<b>Telegram\x20Bot\x20Status:</b>\x0a','removeListener','allow','once','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','getFullYear','conn','update-bb','3000','enabled','sortBy','Password\x20has\x20been\x20reset\x20to:\x20','new-disabled','simple','date-fns','init','headless','Password\x20reset\x20rejected','No\x20authentication\x20token','<b>Balance\x20Bot\x20Status:</b>\x0a','/on\x20-\x20start\x20bot(s)\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','error','839892YYPakR','bot','exit','readdirSync','removeAllListeners','show-config','token','access','chat','Unauthorized\x20attempt\x20to\x20confirm\x20message','uuid-random','bb-settings.json','isDirectory','disconnect','115reBseL','order','loginRequired','RSA','orders','-performance.json','keys','464ZPtrJl','min','Unauthorized\x20attempt\x20to\x20get\x20messages','Notifications\x20disabled','Yes','bots','privateKey','\x20>\x20','sha256','SIGTERM','bb/','reset-password',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','get-starting-balances','getSeconds','use','callback_query','Markdown','find','hybrid-crypto-js','host','sendMessage','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','cancelLoading','Starting\x20Balance\x20Bot\x20update','ipv6','404\x20Not\x20Found','Unauthorized\x20attempt\x20to\x20update\x20settings','telegramToken','Invalid\x20IP\x20address','includes','value','socket.io','unlinkSync','telegram','remove','/:bot/performance','getHours','store-configuration','getTime','split','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','uncaughtException','starting\x20new\x20bot\x20|\x20Bot\x20','Notifications\x20types:\x20','temporary\x20access\x20not\x20allowed','showConfig','-config.json','Notifications\x20enabled','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','timeshift','binary','SIGINT','match','request','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','length','blacklist','temporary\x20access\x20timeout','sockets','remoteAddress','add','botID','mkdirSync','logout','sort','\x20|\x20','Notifications\x20enabled\x0a','password','Unauthorized\x20login\x20attempt\x20(timeout)','/:bot/history','logs','assign','cloneDeep','store','Unauthorized\x20attempt\x20to\x20update\x20bot','Crypt','6950NaMtAj','kill','clients','DEFLATE','25253774rYvAZe','all','search','polling_error','/names\x20-\x20show\x20bot\x20names\x0a','30\x20min','socket','entries','then','All\x20bots','You\x20can\x20use\x20the\x20following\x20commands:\x0a','temp/','expiry','download','2FA\x20required','Orders','express','/off\x20-\x20stop\x20bot(s)\x0a','yes','-events.json','\x20to\x20','track','15\x20min','live','from','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','deleted\x20Bot\x20','add-bot','writeFileSync','express-fileupload','new','number','getMonth','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','place-order','stringify','toggleBotMode','zip/','restart','\x20mode','argv','login\x20token\x20generated','randomBytes','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','get-messages','enabled\x20Bot\x20','-----------------------------------------------------------------------------------','statSync','log','build2','graphql-request','full','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','forEach','telegramUsername','login\x20token\x20valid','size','delete-bot','secure','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','invalid\x20credentials','messages','message','bbvNew','Server','botname','get-portfolio','109692FnLvgo','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','pidExpireLogin','Temporary\x20access\x20rejected','child_process','hashSync','Login\x20rejected','any','existsSync','fork','send','parse','headers','Bot\x20','username','No\x20bots\x20running\x20right\x20now','getMinutes','slice','Your\x20installation\x20is\x20already\x20up\x20to\x20date','exp','toString','publicKey','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','lowdb/adapters/FileSync','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20store\x20configuration','defaults','user','storeConfiguration','/output-000.log','type','secret','index.html','143jfIJeo','disabled\x20Bot\x20','temporaryAccessAllowed','bot-','files','\x20(1)','mode','tkn','telegrammsg','3405zQzQsT','lastmsgemitted','map','settings','write','http','pidRefreshToken','cancel-loading','output-001.log'];_0x3693=function(){return _0x35a34e;};return _0x3693();}function storeConfiguration(_0x77c9e7){const _0x53f5bc=_0x29a69b;dbConfig[_0x53f5bc(0x27d)](_0x53f5bc(0x2fd))[_0x53f5bc(0x31c)]()[_0x53f5bc(0x21b)](),_0x77c9e7[_0x53f5bc(0x1df)](_0xcc2f1f=>{delete _0xcc2f1f['mode'];}),dbConfig[_0x53f5bc(0x27d)](_0x53f5bc(0x2fd))[_0x53f5bc(0x26b)](..._0x77c9e7)[_0x53f5bc(0x21b)](),config=_0x77c9e7;}function resetPassword(){const _0x4d7ecb=_0x29a69b;tgBot&&settings[_0x4d7ecb(0x2c1)]&&(tgBot[_0x4d7ecb(0x2cc)](_0x4d7ecb(0x308)),tgBot['sendMessage'](settings[_0x4d7ecb(0x2c1)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x4d7ecb(0x25b),'reply_markup':{'inline_keyboard':[[{'text':_0x4d7ecb(0x1bb),'callback_data':_0x4d7ecb(0x1bb)},{'text':'no','callback_data':'no'}]]}})[_0x4d7ecb(0x27f)](_0x237440=>{telegramError(_0x237440);}),tgBot['on']('callback_query',async _0x277d44=>{const _0x22b288=_0x4d7ecb,_0x31e0a8=_0x277d44['data'],_0x46925e=_0x277d44[_0x22b288(0x1e8)];tgBot['answerCallbackQuery'](_0x277d44['id'])[_0x22b288(0x1b1)](async()=>{const _0x2bef40=_0x22b288;if(_0x31e0a8!='no'){const _0x27b640=0xf,_0x5dfdf9=_0x2bef40(0x1de),_0x3427a2=Array[_0x2bef40(0x1c1)](crypto[_0x2bef40(0x282)](new Uint32Array(_0x27b640)))[_0x2bef40(0x219)](_0x1572d0=>_0x5dfdf9[_0x1572d0%_0x5dfdf9[_0x2bef40(0x190)]])[_0x2bef40(0x24f)](''),_0xe114ae=bcrypt[_0x2bef40(0x1f2)](_0x3427a2,saltRounds);storeSettings({'bbPassword':_0xe114ae}),await tgBot[_0x2bef40(0x30d)](_0x46925e[_0x2bef40(0x2eb)]['id'],_0x2bef40(0x2d6)+_0x3427a2,{'parse_mode':'HTML'})[_0x2bef40(0x27f)](_0x3854af=>{telegramError(_0x3854af);});}else await tgBot[_0x2bef40(0x30d)](_0x46925e[_0x2bef40(0x2eb)]['id'],_0x2bef40(0x2dc))[_0x2bef40(0x27f)](_0x21a6c5=>{telegramError(_0x21a6c5);});}),tgBot[_0x22b288(0x2cc)](_0x22b288(0x308));}));}async function confirmRestore(_0x2f92a5,_0x2821ca){const _0x44f3ab=_0x29a69b;tgBot&&settings[_0x44f3ab(0x2c1)]&&(tgBot['removeListener'](_0x44f3ab(0x308)),await tgBot[_0x44f3ab(0x30d)](settings[_0x44f3ab(0x2c1)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x44f3ab(0x25b),'reply_markup':{'inline_keyboard':[[{'text':_0x44f3ab(0x1bb),'callback_data':_0x44f3ab(0x1bb)},{'text':'no','callback_data':'no'}]]}})[_0x44f3ab(0x27f)](_0x340b43=>{telegramError(_0x340b43);}),tgBot['on']('callback_query',async _0x32b125=>{const _0x20d49c=_0x44f3ab,_0x1af41f=_0x32b125[_0x20d49c(0x296)],_0x4ab788=_0x32b125[_0x20d49c(0x1e8)];tgBot[_0x20d49c(0x252)](_0x32b125['id'])[_0x20d49c(0x1b1)](async()=>{const _0x2f2a6f=_0x20d49c;_0x1af41f==_0x2f2a6f(0x1bb)?(await tgBot[_0x2f2a6f(0x30d)](_0x4ab788[_0x2f2a6f(0x2eb)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x2f2a6f(0x25b)})['catch'](_0x446bcb=>{telegramError(_0x446bcb);}),unzipFile(_0x2f92a5,_0x2821ca)):await tgBot[_0x2f2a6f(0x30d)](_0x4ab788[_0x2f2a6f(0x2eb)]['id'],'Restore\x20process\x20aborted')['catch'](_0x277c5d=>{telegramError(_0x277c5d);});}),tgBot['removeListener'](_0x20d49c(0x308));}));}function getServerTime(){const _0x2fd5e8=_0x29a69b,_0x265833=new Date();return _0x265833['getFullYear']()+'/'+(_0x265833[_0x2fd5e8(0x1c9)]()+0x1)[_0x2fd5e8(0x201)]()[_0x2fd5e8(0x276)](0x2,'0')+'/'+_0x265833[_0x2fd5e8(0x24a)]()[_0x2fd5e8(0x201)]()[_0x2fd5e8(0x276)](0x2,'0')+'\x20'+_0x265833['getHours']()[_0x2fd5e8(0x201)]()[_0x2fd5e8(0x276)](0x2,'0')+':'+_0x265833[_0x2fd5e8(0x1fd)]()[_0x2fd5e8(0x201)]()[_0x2fd5e8(0x276)](0x2,'0')+':'+_0x265833[_0x2fd5e8(0x306)]()[_0x2fd5e8(0x201)]()[_0x2fd5e8(0x276)](0x2,'0');}function getTimeStamp(){const _0x5107ce=_0x29a69b,_0x258b0e=shiftedTime();return _0x258b0e[_0x5107ce(0x2d0)]()+'/'+(_0x258b0e[_0x5107ce(0x1c9)]()+0x1)[_0x5107ce(0x201)]()[_0x5107ce(0x276)](0x2,'0')+'/'+_0x258b0e['getDate']()['toString']()[_0x5107ce(0x276)](0x2,'0')+'\x20'+_0x258b0e[_0x5107ce(0x31e)]()['toString']()['padStart'](0x2,'0')+':'+_0x258b0e[_0x5107ce(0x1fd)]()[_0x5107ce(0x201)]()[_0x5107ce(0x276)](0x2,'0')+':'+_0x258b0e[_0x5107ce(0x306)]()['toString']()[_0x5107ce(0x276)](0x2,'0');}function shiftedTime(){const _0x4b5f4e=_0x29a69b,_0xe6132d=new Date();let _0x5f0031=_0xe6132d;if(settings[_0x4b5f4e(0x18a)]&&settings[_0x4b5f4e(0x18a)]!==0x0)_0x5f0031=fns[_0x4b5f4e(0x195)](_0xe6132d,{'hours':settings[_0x4b5f4e(0x18a)]});return _0x5f0031;}function startScheduler(){const _0x484024=_0x29a69b,_0x5280a2=new Date()['getUTCHours'](),_0x45cd03=shiftedTime()[_0x484024(0x31e)]();_0x45cd03==0x4&&backupConfigFiles();_0x45cd03==0x0&&rotateLogFiles();_0x5280a2%0x6==0x0&&triggerAnalytics();_0x5280a2%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x514416=_0x29a69b;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x514416(0x1df)](_0x2b4dfb=>{const _0x53aea5=_0x514416;if(!_0x2b4dfb[_0x53aea5(0x2ef)]())fs[_0x53aea5(0x28e)](configpath+_0x2b4dfb[_0x53aea5(0x273)],configbackuppath+_0x2b4dfb[_0x53aea5(0x273)]);});}function rotateLogFiles(){const _0x3ed4d0=_0x29a69b,_0x1a13cf=fs[_0x3ed4d0(0x1d9)](logspath+'output-000.log'),_0x528255=_0x1a13cf[_0x3ed4d0(0x1e2)]/0x400;if(_0x528255>0x32){let _0xd1fe2=fs[_0x3ed4d0(0x2e6)](logspath,{'withFileTypes':!![]});_0xd1fe2[_0x3ed4d0(0x199)]((_0x142c3e,_0x4e25d9)=>_0x142c3e[_0x3ed4d0(0x273)]<_0x4e25d9[_0x3ed4d0(0x273)]?0x1:_0x4e25d9[_0x3ed4d0(0x273)]<_0x142c3e[_0x3ed4d0(0x273)]?-0x1:0x0),_0xd1fe2['forEach'](_0x2f3591=>{const _0x1c74e7=_0x3ed4d0;if(_0x2f3591[_0x1c74e7(0x273)]=='output-002.log')fs[_0x1c74e7(0x28e)](logspath+_0x2f3591['name'],logspath+_0x1c74e7(0x243));if(_0x2f3591[_0x1c74e7(0x273)]==_0x1c74e7(0x21f))fs[_0x1c74e7(0x28e)](logspath+_0x2f3591[_0x1c74e7(0x273)],logspath+_0x1c74e7(0x2bf));_0x2f3591[_0x1c74e7(0x273)]=='output-000.log'&&(fs[_0x1c74e7(0x28e)](logspath+_0x2f3591[_0x1c74e7(0x273)],logspath+'output-001.log'),fs[_0x1c74e7(0x1c5)](logspath+_0x2f3591[_0x1c74e7(0x273)],''));});}}async function zipFiles(_0x42b999){const _0x24d5c3=_0x29a69b;let _0x2b458a;if(_0x42b999==_0x24d5c3(0x19f))_0x2b458a=logspath;if(_0x42b999=='backup')_0x2b458a=configpath;let _0x5a2243=fs[_0x24d5c3(0x2e6)](_0x2b458a,{'withFileTypes':!![]});const _0x18ed6b=new require(_0x24d5c3(0x269))();_0x5a2243['forEach'](_0x5862fe=>{const _0x4cfe1b=_0x24d5c3;if(!_0x5862fe[_0x4cfe1b(0x2ef)]()){let _0x3d166e=fs[_0x4cfe1b(0x25f)](_0x2b458a+_0x5862fe[_0x4cfe1b(0x273)]);const _0x45243f=/^bot-[0-9]{3}-config.json$/,_0x42c15a=_0x45243f[_0x4cfe1b(0x29d)](_0x5862fe[_0x4cfe1b(0x273)]);if(_0x42c15a){const _0x5edc30=JSON[_0x4cfe1b(0x1f8)](_0x3d166e);_0x5edc30[_0x4cfe1b(0x2e4)][0x0]['apiKey']=_0x4cfe1b(0x280),_0x5edc30['bot'][0x0]['apiSecret']=_0x4cfe1b(0x280),_0x3d166e=JSON[_0x4cfe1b(0x1cc)](_0x5edc30,null,0x2);}if(_0x5862fe['name']==_0x4cfe1b(0x2ee)){const _0x573302=JSON[_0x4cfe1b(0x1f8)](_0x3d166e);if(_0x573302[_0x4cfe1b(0x21a)]['loginRequired'])_0x573302['settings'][_0x4cfe1b(0x2f3)]=![];if(_0x573302[_0x4cfe1b(0x21a)][_0x4cfe1b(0x227)])_0x573302[_0x4cfe1b(0x21a)][_0x4cfe1b(0x227)]=_0x4cfe1b(0x280);if(_0x573302[_0x4cfe1b(0x21a)][_0x4cfe1b(0x315)])_0x573302[_0x4cfe1b(0x21a)][_0x4cfe1b(0x315)]=_0x4cfe1b(0x280);if(_0x573302[_0x4cfe1b(0x21a)][_0x4cfe1b(0x2c1)])_0x573302['settings'][_0x4cfe1b(0x2c1)]=null;_0x3d166e=JSON[_0x4cfe1b(0x1cc)](_0x573302,null,0x2);}if(_0x5862fe[_0x4cfe1b(0x273)]!=_0x4cfe1b(0x2a7))_0x18ed6b['file'](_0x5862fe[_0x4cfe1b(0x273)],_0x3d166e);}});const _0x6ced7b=_0x18ed6b['generate']({'base64':![],'compression':_0x24d5c3(0x1a8)});fs[_0x24d5c3(0x1c5)](zippath+(_0x42b999+_0x24d5c3(0x2ca)),_0x6ced7b,_0x24d5c3(0x18b));}async function unzipFile(_0x31da9b,_0x47a845){const _0x2b360d=_0x29a69b;await backupConfigFiles(),fs[_0x2b360d(0x2e6)](configpath,{'withFileTypes':!![]})[_0x2b360d(0x1df)](_0x5eb143=>{const _0x2886a1=_0x2b360d;if(!_0x5eb143['isDirectory']())fs[_0x2886a1(0x23c)](configpath+_0x5eb143['name']);});const _0x11ae63=fs[_0x2b360d(0x25f)](_0x31da9b+_0x47a845,_0x2b360d(0x18b)),_0x526e4a=new require('node-zip')(_0x11ae63,{'base64':![],'checkCRC32':!![]});Object[_0x2b360d(0x2f7)](_0x526e4a[_0x2b360d(0x212)])[_0x2b360d(0x1df)](_0x1601cf=>{const _0x5ad470=_0x2b360d,_0x510a1=_0x526e4a['files'][_0x1601cf];fs['writeFileSync'](configpath+_0x510a1[_0x5ad470(0x273)],_0x510a1['_data']);}),fs[_0x2b360d(0x2e6)](temppath,{'withFileTypes':!![]})[_0x2b360d(0x1df)](_0x2de7b7=>{const _0x4195ed=_0x2b360d;if(!_0x2de7b7[_0x4195ed(0x2ef)]())fs[_0x4195ed(0x23c)](temppath+_0x2de7b7[_0x4195ed(0x273)]);}),process[_0x2b360d(0x1f7)]({'restore':!![]},_0x58f480=>{});}async function getPublicIp(){const _0xff0363=_0x29a69b;try{const _0x59c256=await axios['get'](_0xff0363(0x24c));publicip=_0x59c256['data']['ip'];}catch(_0x4c80d8){}}async function triggerAnalytics(){const _0x7124b4=_0x29a69b;if(!publicip)await getPublicIp();const _0x3b901e=getBotsWithMode();let _0x3bf991=0x0;_0x3b901e[_0x7124b4(0x1df)](_0x524d1b=>{const _0x1fc8dc=_0x7124b4;if(_0x524d1b[_0x1fc8dc(0x271)]===_0x1fc8dc(0x2d4))_0x3bf991++;});const _0x44e568=getBotExchanges();mixpanel[_0x7124b4(0x1be)](_0x7124b4(0x1ea),{'distinct_id':settings[_0x7124b4(0x231)],'ip':publicip,'version':serverversion,'numbots':_0x3b901e[_0x7124b4(0x190)],'numbotsenabled':_0x3bf991,'exchanges':_0x44e568});}async function getMessages(){const _0x1d5c20=_0x29a69b,_0x568410=_0x1d5c20(0x2c7),_0x24089e=new GraphQLClient(_0x568410),_0x487875={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x4de724=serverversion[_0x1d5c20(0x321)]('.'),_0x11fd48=_0x4de724[0x0]+'.'+_0x4de724[0x1],_0x33e5ee=Math[_0x1d5c20(0x2f9)](settings[_0x1d5c20(0x268)],settings[_0x1d5c20(0x218)]),_0x5991cd={'last':parseInt(_0x33e5ee),'bbm':_0x11fd48},_0x10e314=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x126f14;try{_0x126f14=await _0x24089e[_0x1d5c20(0x18e)](_0x10e314,_0x5991cd,_0x487875);}catch(_0x38c4c3){}if(_0x126f14&&_0x126f14[_0x1d5c20(0x1e7)]){let _0x485acc=settings[_0x1d5c20(0x268)];newMessages=[];for(const _0x20a135 of _0x126f14[_0x1d5c20(0x1e7)]){newMessages[_0x1d5c20(0x26b)](_0x20a135);if(_0x20a135[_0x1d5c20(0x1e9)])updateSetting('latestversion',_0x20a135[_0x1d5c20(0x1e9)]);let _0x39b17a=_0x20a135['bbvNew']?serverversion>=_0x20a135[_0x1d5c20(0x1e9)]:![];if(!_0x39b17a&&_0x20a135['number']>_0x485acc){if(_0x20a135['bbvReceive']===_0x1d5c20(0x1f4)||serverversion['startsWith'](_0x20a135[_0x1d5c20(0x293)])){let _0x4760ec=''+_0x20a135[_0x1d5c20(0x2b0)]+'\x0a\x0a'+_0x20a135[_0x1d5c20(0x1e8)];const _0x2e8cc3=await sendTelegramMsg(toTelegramMarkdown(_0x4760ec),_0x1d5c20(0x309));if(_0x2e8cc3)_0x485acc=_0x20a135[_0x1d5c20(0x1c8)];}}}updateAvailable=isNewerVersion(settings[_0x1d5c20(0x272)],serverversion),updateSetting(_0x1d5c20(0x268),_0x485acc),emitMessages();}}function emitMessages(){const _0x334ea8=_0x29a69b,_0x3b04f6=settings['lastmsgemitted'];let _0x47b4f6=[];newMessages[_0x334ea8(0x1df)](_0x215d6e=>{_0x215d6e['number']>_0x3b04f6&&_0x47b4f6['push'](_0x215d6e);}),_0x47b4f6[_0x334ea8(0x190)]>0x0&&getAllClients()[_0x334ea8(0x1df)](_0x47584b=>{const _0x1639a4=_0x334ea8;getSocket(_0x47584b['id'])['emit'](_0x1639a4(0x1e8),_0x47b4f6);});}function confirmMessage(_0x5db787){const _0x286f1f=_0x29a69b;updateSetting(_0x286f1f(0x218),Number(_0x5db787));}function isNewerVersion(_0xcfd83f,_0x43b45d){const _0x33e8c3=_0x29a69b,_0xef20ec=_0x43b45d[_0x33e8c3(0x321)]('.'),_0x27330d=_0xcfd83f[_0x33e8c3(0x321)]('.');for(var _0x5c23bd=0x0;_0x5c23bd<_0x27330d[_0x33e8c3(0x190)];_0x5c23bd++){const _0x53028f=~~_0x27330d[_0x5c23bd],_0x594856=~~_0xef20ec[_0x5c23bd];if(_0x53028f>_0x594856)return!![];if(_0x53028f<_0x594856)return![];}return![];}function toTelegramMarkdown(_0x4b8ecc){const _0x11a383=_0x29a69b,_0x5bbedf=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xb7c19a=/\*{2}(.+?)\*{2}/gim;return _0x4b8ecc=_0x4b8ecc[_0x11a383(0x260)](_0x5bbedf,'$1_$2_$3')[_0x11a383(0x260)](_0xb7c19a,_0x11a383(0x244)),_0x4b8ecc;}async function validateConfigFile(){const _0x1a5bfa=_0x29a69b,_0xe19b89=dbConfig[_0x1a5bfa(0x27d)](_0x1a5bfa(0x2fd))[_0x1a5bfa(0x2d5)](_0x1a5bfa(0x196))[_0x1a5bfa(0x318)]()||[];if(_0xe19b89[_0x1a5bfa(0x190)]==0x0){let _0x385bc4=0x0,_0x34aed7=[];const _0x5e631d=/^bot-([0-9]{3})-config.json$/,_0x4d9418=fs[_0x1a5bfa(0x2e6)](configpath);_0x4d9418[_0x1a5bfa(0x1df)](_0x43f4b0=>{const _0x5e94d7=_0x1a5bfa,_0xf2ca41=_0x5e631d[_0x5e94d7(0x25a)](_0x43f4b0);if(_0xf2ca41){const _0x2aff97=_0xf2ca41[0x1];let _0x473ca6=getBotAttributes(_0x2aff97);_0x34aed7[_0x5e94d7(0x26b)]({'botID':_0x2aff97,'botname':_0x473ca6[_0x5e94d7(0x1eb)],'status':_0x5e94d7(0x278),'live':_0x5e94d7(0x2c9)}),_0x385bc4++;}}),_0x385bc4!=0x0&&(dbConfig[_0x1a5bfa(0x27d)](_0x1a5bfa(0x2fd))[_0x1a5bfa(0x1a0)](_0x34aed7)[_0x1a5bfa(0x21b)](),config=_0x34aed7,restoredConfigFile=_0x385bc4);}}async function restoreConfigNotify(_0x3f0a45){const _0x598b6e=_0x29a69b;let _0x357b0b;if(restoredConfigFile==0x1)_0x357b0b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x357b0b=_0x598b6e(0x188);if(_0x3f0a45)io['to'](_0x598b6e(0x2a0))[_0x598b6e(0x28a)]('notification',_0x357b0b);else{logger[_0x598b6e(0x2d8)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x357b0b),logger[_0x598b6e(0x2d8)]('-----------------------------------------------------------------------------------'),logger[_0x598b6e(0x2d8)]('');if(tgBot&&settings[_0x598b6e(0x2c1)]&&settings[_0x598b6e(0x283)]!=_0x598b6e(0x2f5))tgBot[_0x598b6e(0x30d)](settings[_0x598b6e(0x2c1)],_0x598b6e(0x2a1)+_0x357b0b)[_0x598b6e(0x27f)](_0x436e7e=>{telegramError(_0x436e7e);});}}function validateCredentials(_0xd3dbe8,_0x20fd8e){const _0xde58c9=_0x29a69b;if(_0xd3dbe8[_0xde58c9(0x1fb)]==settings[_0xde58c9(0x245)]&&bcrypt[_0xde58c9(0x26a)](_0xd3dbe8['password'],settings[_0xde58c9(0x227)])){if(settings[_0xde58c9(0x28f)])return{'allow':![],'reason':_0xde58c9(0x222),'token':null};else{const _0x40d645=generateLoginToken(_0x20fd8e);return{'allow':!![],'reason':_0xde58c9(0x1d2),'token':_0x40d645};}}else return{'allow':![],'reason':_0xde58c9(0x1e6),'token':null};}function refreshToken(_0x246879){const _0x329803=generateLoginToken(_0x246879);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x329803};}function validateAccess(_0x56deb5,_0x5b2e0e,_0x1ae182){const _0xb17f73=_0x29a69b,_0x34521a=_0x1ae182?_0x1ae182:devices[_0x5b2e0e]['ip'];let _0x598827;const _0x396d49=_0x4ff9b7=>{const _0xbaec7f=_0xfb4a;if(settings[_0xbaec7f(0x2f3)]){if(settings[_0xbaec7f(0x28f)]){if(telegram2FaApproved(_0x5b2e0e)){const _0x436316=generateLoginToken(_0x5b2e0e);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x436316};}else return{'allow':![],'reason':_0xbaec7f(0x2b3),'token':null};}else return _0x598827=validToken(_0x4ff9b7,_0x5b2e0e),_0x598827[_0xbaec7f(0x23b)]('success')?{'allow':!![],'reason':_0xbaec7f(0x1e1),'token':_0x4ff9b7}:{'allow':![],'reason':_0xbaec7f(0x2b3),'token':null};}else return{'allow':!![],'reason':_0xbaec7f(0x263),'token':null};};if(settings[_0xb17f73(0x2a9)]){let _0x3672a0=[...settings[_0xb17f73(0x2ad)],'::1',_0xb17f73(0x2b6),_0xb17f73(0x27e)];if(_0x3672a0[_0xb17f73(0x317)](_0x34521a))return _0x396d49(_0x56deb5);else{_0x598827=validToken(_0x56deb5,_0x5b2e0e);if(_0x598827[_0xb17f73(0x23b)]('success'))return _0x396d49(_0x56deb5);else{if(telegramIpApproved(_0x5b2e0e)){const _0x43fa1f=generateToken(_0x5b2e0e);return _0x598827=_0x396d49(_0x56deb5),_0x598827[_0xb17f73(0x2cd)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x43fa1f}:_0x598827;}else return settings[_0xb17f73(0x210)]?{'allow':![],'reason':_0xb17f73(0x1b7),'token':null}:{'allow':![],'reason':_0xb17f73(0x328),'token':null};}}}else return _0x396d49(_0x56deb5);}function timelyDecrypt(_0x15c799,_0x2cf224=!![]){const _0x56508f=_0x29a69b;if(_0x15c799)try{const _0x42ca0f=crypt['decrypt'](secure[_0x56508f(0x2fe)],_0x15c799)[_0x56508f(0x1e8)],_0x2d222b=_0x42ca0f[_0x56508f(0x321)]('@')[0x0],_0x22f862=_0x42ca0f['split']('@')[0x1],_0x8948e7=new Date()[_0x56508f(0x320)]();if(_0x2cf224){if(_0x8948e7-_0x22f862<maxSecretAge*0x3e8)return _0x2d222b;else return![];}else return _0x2d222b;}catch(_0x3f63c){return![];}else return![];}const validToken=(_0x4b712e,_0x403b9a)=>{const _0x5c07af=_0x29a69b,_0x5964ff=devices[_0x403b9a]['ip'];if(!_0x4b712e)return{'error':_0x5c07af(0x2dd)};for(let _0x1b81ae of blacklist){if(_0x1b81ae['token']==_0x4b712e)return{'error':_0x5c07af(0x2ac)};}let _0x1a1f7c;try{_0x1a1f7c=jwt[_0x5c07af(0x221)](_0x4b712e,secure[_0x5c07af(0x20c)]+_0x403b9a);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x1a1f7c[_0x5c07af(0x23b)](_0x5c07af(0x2c3))&&!_0x1a1f7c[_0x5c07af(0x23b)](_0x5c07af(0x1fb))||!_0x1a1f7c[_0x5c07af(0x23b)](_0x5c07af(0x200)))return{'error':_0x5c07af(0x250)};if(!_0x1a1f7c['hasOwnProperty'](_0x5c07af(0x1fb))&&_0x1a1f7c[_0x5c07af(0x23b)]('clientip')){const {clientip:_0x5d1b67}=_0x1a1f7c;return _0x5964ff==_0x5d1b67?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x5c07af(0x316)};}else{if(_0x1a1f7c[_0x5c07af(0x23b)](_0x5c07af(0x1fb))&&_0x1a1f7c[_0x5c07af(0x23b)]('clientip')){const {username:_0x56e6b1,clientip:_0x1fee42}=_0x1a1f7c;return settings[_0x5c07af(0x245)]==_0x56e6b1&&_0x5964ff==_0x1fee42?{'success':_0x5c07af(0x2b8)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x36a937=>{if(_0x36a937){const _0x231a2c=devices[_0x36a937]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x231a2c},secure['secret']+_0x36a937,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2e4f61=>{const _0x4add2c=_0x29a69b;if(_0x2e4f61){const _0x1be59f=devices[_0x2e4f61]['ip'];return jwt['sign']({'clientip':_0x1be59f},secure['secret']+_0x2e4f61,{'expiresIn':devices[_0x2e4f61]['telegramIpApproval'][_0x4add2c(0x1b5)]*0x3c});}else return![];},telegramIpApproved=_0x1fc4fe=>{const _0x21407b=_0x29a69b;let _0x5c2e95=![];return devices[_0x1fc4fe][_0x21407b(0x24b)]&&devices[_0x1fc4fe]['telegramIpApproval'][_0x21407b(0x1b5)]!=_0x21407b(0x2af)&&(_0x5c2e95=devices[_0x1fc4fe]['telegramIpApproval'][_0x21407b(0x2c3)]==devices[_0x1fc4fe]['ip']&&new Date()[_0x21407b(0x320)]()-devices[_0x1fc4fe][_0x21407b(0x24b)][_0x21407b(0x223)]<devices[_0x1fc4fe][_0x21407b(0x24b)][_0x21407b(0x1b5)]*0x3c*0x3e8),_0x5c2e95;},telegram2FaApproved=_0x181e88=>{const _0x4708c9=_0x29a69b;let _0x4870cc=![];return devices[_0x181e88][_0x4708c9(0x224)]&&devices[_0x181e88]['telegram2FaApproval']['expiry']!=_0x4708c9(0x2af)&&(_0x4870cc=devices[_0x181e88]['telegram2FaApproval'][_0x4708c9(0x2c3)]==devices[_0x181e88]['ip']&&new Date()['getTime']()-devices[_0x181e88]['telegram2FaApproval'][_0x4708c9(0x223)]<devices[_0x181e88][_0x4708c9(0x224)][_0x4708c9(0x1b5)]*0x3c*0x3e8),_0x4870cc;},normalizeIP=_0x43f157=>{const _0x39ae80=_0x29a69b;let _0x323665=null,_0x591a20=null;if(ipaddr[_0x39ae80(0x255)](_0x43f157)){const _0x40057d=ipaddr[_0x39ae80(0x1f8)](_0x43f157);_0x40057d[_0x39ae80(0x29e)]()===_0x39ae80(0x312)?(_0x40057d[_0x39ae80(0x23f)]()&&(_0x323665=_0x40057d[_0x39ae80(0x22e)]()[_0x39ae80(0x201)]()),_0x591a20=_0x40057d[_0x39ae80(0x201)]()):(_0x323665=_0x40057d[_0x39ae80(0x201)](),_0x591a20=_0x40057d['toIPv4MappedAddress']()[_0x39ae80(0x201)]());}return{'show':_0x323665?_0x323665:_0x591a20,'store':_0x591a20};};function sleep(_0x22de3c){return new Promise(_0x1ea5e8=>setTimeout(_0x1ea5e8,_0x22de3c));}