const _0x2fa3a5=_0x4f83;(function(_0x288179,_0x3de6a7){const _0x8ef9cc=_0x4f83,_0x342fa0=_0x288179();while(!![]){try{const _0x19cace=parseInt(_0x8ef9cc(0x2c0))/0x1*(parseInt(_0x8ef9cc(0x2dc))/0x2)+-parseInt(_0x8ef9cc(0x37b))/0x3+parseInt(_0x8ef9cc(0x22c))/0x4*(parseInt(_0x8ef9cc(0x300))/0x5)+parseInt(_0x8ef9cc(0x1ec))/0x6+-parseInt(_0x8ef9cc(0x296))/0x7+parseInt(_0x8ef9cc(0x2d7))/0x8+-parseInt(_0x8ef9cc(0x1c6))/0x9;if(_0x19cace===_0x3de6a7)break;else _0x342fa0['push'](_0x342fa0['shift']());}catch(_0x5bad9a){_0x342fa0['push'](_0x342fa0['shift']());}}}(_0xbe57,0x4185b));const _0x55a041=function(){let _0x5a9416=!![];return function(_0x3b40e3,_0x2a4ec1){const _0x1b603c=_0x5a9416?function(){const _0xc0199d=_0x4f83;if(_0x2a4ec1){const _0x1cd908=_0x2a4ec1[_0xc0199d(0x31f)](_0x3b40e3,arguments);return _0x2a4ec1=null,_0x1cd908;}}:function(){};return _0x5a9416=![],_0x1b603c;};}(),_0x2970ea=_0x55a041(this,function(){const _0x24be7c=_0x4f83;return _0x2970ea[_0x24be7c(0x310)]()['search'](_0x24be7c(0x2d3))[_0x24be7c(0x310)]()[_0x24be7c(0x342)](_0x2970ea)[_0x24be7c(0x1d7)]('(((.+)+)+)+$');});_0x2970ea();'use strict';process['env'][_0x2fa3a5(0x295)]=0x1;const childProcess=require(_0x2fa3a5(0x345)),fs=require('fs'),fns=require(_0x2fa3a5(0x324)),low=require('lowdb'),FileSync=require(_0x2fa3a5(0x1be)),path=require('path'),crypto=require(_0x2fa3a5(0x29a)),Crypt=require(_0x2fa3a5(0x375))[_0x2fa3a5(0x22e)],RSA=require(_0x2fa3a5(0x375))[_0x2fa3a5(0x1e3)],bcrypt=require('bcryptjs'),jwt=require(_0x2fa3a5(0x1ef)),ipaddr=require('ipaddr.js'),argv=require(_0x2fa3a5(0x318))(process['argv'][_0x2fa3a5(0x226)](0x2))[_0x2fa3a5(0x1ed)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x2fa3a5(0x2b8)),Mixpanel=require(_0x2fa3a5(0x367)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x2fa3a5(0x307)),fileUpload=require(_0x2fa3a5(0x2ea)),PORT=argv['port']||_0x2fa3a5(0x2f3),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x2fa3a5(0x347)](_0x2fa3a5(0x270)+PORT+_0x2fa3a5(0x1f1)),process[_0x2fa3a5(0x291)](0x1));const HOST=argv['host']||null,userID=argv[_0x2fa3a5(0x355)]||'',debugging=argv['d']||![];function _0xbe57(){const _0x20a667=['temporary\x20access\x20rejected','userid','25AFSeaB','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20get\x20portfolio','clients','mtime','placeOrder','createWriteStream','util','messages','Unauthorized\x20attempt\x20to\x20add\x20bot','.zip','live','logs/','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Idling\x20bot\x20\x20\x20|\x20Bot\x20','message','toString','includes','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','encryptedUuid','warning','storeHeadless','Deleted\x20Bot\x20','removeListener','yargs/yargs','backup','format','telegramIpApproval','static','127.0.0.1','botID','apply','sendFile','Unauthorized\x20attempt\x20to\x20update\x20bot','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','login','date-fns','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','notification','auto','allow','started','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','stop','set','from','Restore\x20backup\x20file\x20','bb-settings.json','startsWith','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','getUTCHours','timestamp','password','size','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','\x20|\x20','conn','/update\x20-\x20update\x20Balance\x20Bot\x0a','hex','bbvReceive','/:bot/history','bot','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','tkn','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','login\x20token\x20generated','constructor','all','get-logs','child_process','new','log','inherit','Unauthorized\x20attempt\x20to\x20show\x20configuration','All\x20bots','login\x20token\x20valid','version','endsWith','store-headless','Allow\x20login\x20from\x20IP\x20address\x20<b>','value','ipv6','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','reject','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','user','/on\x20-\x20start\x20bot(s)\x0a','uuid','\x20to\x20','apiKey','zip/','uncaughtException','5\x20min','Invalid\x20authentication\x20token\x20(2)','logged\x20out','then','data','Notifications\x20disabled','Ok,\x20will\x20send\x20order\x20notifications\x20only','Your\x20installation\x20is\x20already\x20up\x20to\x20date','mode','Unauthorized\x20attempt\x20to\x20log\x20out','updatebotmanager','mixpanel','express','***','temporary\x20access\x20timeout','auth','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','No\x20authentication\x20token','assign','listen','full','getDate','max','-----------------------------------------------------------------------------------','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','hybrid-crypto-js','disabled','sortBy',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','write','File\x20uploaded','146703gQFfca','answerCallbackQuery','handshake','compareSync','getStartingBalances','filter','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','2FA\x20login\x20required','show-config','store-settings','lowdb/adapters/FileSync','\x20(1)','************','/:bot/portfolio','timeshift','expiry','stopped','latestversion','7845075wOqSyU','sockets','Login\x20rejected','replace','callback_query','Logged\x20out\x20user\x20...','place-order','bb/','writeFileSync','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20download\x20','update-bot','Enabled\x20Bot\x20','Alerts','bb-config.json','use','getFullYear','search','send','randomFillSync','get-messages','getPortfolio','Unauthorized\x20attempt\x20to\x20update\x20settings','username','reset-history','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','botname','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','get-starting-balances','RSA','enabled','isValid','HTML','entries','order','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','join','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','1354320rqOtlH','argv','manual','jsonwebtoken','find',',\x20must\x20be\x20a\x204\x20digit\x20number','hashSync','bot-','store-configuration','30\x20min','fork','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','bbUsername','2FA','toIPv4MappedAddress','function','pidExpireLogin',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','backupfile','copyFileSync','store','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','\x20>\x20','whitelistEnabled','parse','clientip','post','mkdirSync','number','event','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','telegramEnabled','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','args','bbPassword','Notifications\x20disabled\x0a','existsSync','Notifications\x20types:\x20','DEFLATE','reason','chat','f2aRequired','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Backup\x20file\x20uploaded','Server','telegrammsg','kind','storeConfiguration','output-002.log','hasOwnProperty','-results.json','decrypt','\x20mode','onepagemode','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20confirm\x20message','get','slice','forEach','onText','getMinutes','<b>Telegram\x20Bot\x20Status:</b>\x0a','yes','373004HGJOKO','isIPv4MappedAddress','Crypt','/:bot/coins','settings','socket.io','login\x20not\x20required','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','readdirSync','telegramUsername','any','min','reset-password','/off\x20-\x20stop\x20bot(s)\x0a','botmanager','bbvNew','randomBytes','exp','secret','/:bot/support','/upload-backup','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','/:bot/configuration','secure','whitelist','lastmsgemitted','sign','generate','Login\x20accepted','No\x20bots\x20running\x20right\x20now','headless','storeFiat','simple','bots','Temporary\x20access\x20rejected','getMonth','Backup\x20file\x20unzipped\x20and\x20stored','publicKey','Ok,\x20will\x20send\x20alert\x20notifications\x20only','index.html','temporaryAccessAllowed','</b>\x20?','emit','readFileSync','/:bot','type',':\x20Bot\x20Mgr\x20>\x20','match','error','new-disabled','stringify','alerts','socket','polling_error','build','store-fiat','output-001.log','Unauthorized\x20attempt\x20to\x20delete\x20bot','connected','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','map','\x20|\x20user:\x20...','Starting\x20Balance\x20Bot\x20','deleteHistoryAlerts','invalid\x20credentials','/metrics\x20-\x20show\x20bot\x20performance\x0a','Password\x20reset\x20rejected','Error:\x20Invalid\x20argument\x20','initclient','output-003.log','Invalid\x20Telegram\x20token','-config.json','track','telegramEvents','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','name','toIPv4Address','statSync','show','/restart\x20-\x20restart\x20bot(s)\x0a','*$1*','params','defaults','0.0.0','toggle-bot-mode','https://api.ipify.org?format=json','/enable\x20-\x20enable\x20notifications\x0a','Notifications\x20enabled','restore-backup-file','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','keys','isDirectory','debug','sha256','backup-full.zip','files','update-bb','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','file','exit','2FA\x20required','404\x20Not\x20Found','bot.js','NTBA_FIX_319','1640016FWBiWl','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','stopPolling','init','crypto','getSeconds','Markdown','telegramToken','sendPortfolioTelegram','::1','access','Restarting\x20Bot\x20','privateKey','catch','backup-files','temp/','/disable\x20-\x20disable\x20notifications\x0a','blacklist','disconnect','SIGINT','removeAllListeners','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','config/','build2','temporary\x20access\x20not\x20allowed','2FA\x20login\x20token\x20generated','Bot\x20Mgr\x20>\x20','Bot\x20','Invalid\x20IP\x20address','RSA-OAEP','referer','-events.json','telegramChatId','node-telegram-bot-api','getTime','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','cancel-loading','get-portfolio','orders','temporary\x20token\x20generated','/names\x20-\x20show\x20bot\x20names\x0a','24gTcAlV','version.json','reinstall','logs','resetHistory','remove','headers','-performance.json','cancelLoading','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','once','\x20(2)','apiSecret','sendMetricsTelegram','generateKeyPairAsync','pidRefreshToken','Yes','token','(((.+)+)+)+$','split','rmSync','<b>Balance\x20Bot\x20Status:</b>\x0a','1879200PJYglZ','unlinkSync','showname','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','6b67f3d61ee94b8f5c80b4affef4c4d9','41364ZsiRlY','sendMessage','sort','kill','length','showConfig','All','getHours','createServer','backup-full@','remoteAddress','reinstall-bb','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','padStart','express-fileupload','running','SIGTERM','update','backup-full','Starting\x20bot\x20|\x20Bot\x20','reload','Restore\x20process\x20aborted','accept','3000','telegram2FaApproval','push','Unauthorized\x20attempt\x20to\x20get\x20messages','confirm-message','success','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Disabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','$1_$2_$3','status'];_0xbe57=function(){return _0x20a667;};return _0xbe57();}let bbpath=_0x2fa3a5(0x1cd),bbpath2='';const botfile=_0x2fa3a5(0x294),configfile=_0x2fa3a5(0x1d4),settingsfile=_0x2fa3a5(0x32f),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x2fa3a5(0x210)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2fa3a5(0x303)),configpath=userID?bbpath+_0x2fa3a5(0x2ad)+userID+'/':bbpath+_0x2fa3a5(0x2ad),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x2fa3a5(0x30c)+userID+'/':bbpath+_0x2fa3a5(0x30c),zippath=userID?bbpath+_0x2fa3a5(0x35a)+userID+'/':bbpath+_0x2fa3a5(0x35a),loggerfile=fs[_0x2fa3a5(0x306)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x2fa3a5(0x2a5);!fs[_0x2fa3a5(0x210)](configpath)&&fs[_0x2fa3a5(0x207)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x2fa3a5(0x207)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x2fa3a5(0x207)](logspath);!fs[_0x2fa3a5(0x210)](zippath)&&fs[_0x2fa3a5(0x207)](zippath);!fs[_0x2fa3a5(0x210)](temppath)&&fs[_0x2fa3a5(0x207)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x2fa3a5(0x379)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2fa3a5(0x27f)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2fa3a5(0x280),'onepagemode':![]}})[_0x2fa3a5(0x379)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2fa3a5(0x27f)]({'secure':{},'blacklist':[]})[_0x2fa3a5(0x379)]();let crypt=new Crypt({'md':_0x2fa3a5(0x28b),'rsaStandard':_0x2fa3a5(0x2b4)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2fa3a5(0x299)](_0x2fa3a5(0x2db),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x2fa3a5(0x29d)]!=''&&settings[_0x2fa3a5(0x235)]&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x564c19=>{const _0x135946=_0x2fa3a5;console[_0x135946(0x347)](_0x564c19);},'simple':_0x4fc58a=>{const _0x7894d4=_0x2fa3a5;console[_0x7894d4(0x347)](_0x4fc58a),loggerfile['write'](util['format'](_0x4fc58a)+'\x0a');},'full':async _0x248334=>{const _0x5974be=_0x2fa3a5,_0x3f94cd=getTimeStamp()+_0x5974be(0x25b)+_0x248334;console[_0x5974be(0x347)](_0x3f94cd),loggerfile['write'](util[_0x5974be(0x31a)](_0x3f94cd)+'\x0a');if(tgBot&&settings[_0x5974be(0x2b7)]&&settings[_0x5974be(0x276)]!='orders')await tgBot[_0x5974be(0x2dd)](settings[_0x5974be(0x2b7)],_0x5974be(0x2b1)+_0x248334)['catch'](_0x1bc653=>{telegramError(_0x1bc653);});},'debug':async(_0x5db9b6,_0x547361='')=>{const _0xb854c6=_0x2fa3a5,_0x24c6a9=getTimeStamp()+_0xb854c6(0x1fd)+_0x5db9b6;if(debugging)console[_0xb854c6(0x347)](_0x24c6a9);loggerfile[_0xb854c6(0x379)](util[_0xb854c6(0x31a)](_0x24c6a9)+'\x0a');if(_0x547361){if(debugging)console['log'](_0x547361);loggerfile[_0xb854c6(0x379)](util['format'](_0x547361)+'\x0a');}}};process['on'](_0x2fa3a5(0x35b),function(_0xb586bd){const _0xe3ceb7=_0x2fa3a5;logger[_0xe3ceb7(0x24d)](_0xb586bd);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2fa3a5(0x2c1))[_0x2fa3a5(0x34c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2fa3a5(0x368)),app=express(),http=require('http')[_0x2fa3a5(0x2e4)](app);app[_0x2fa3a5(0x1d5)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x28f68c,_0x3956fb)=>{const _0x43c0b6=_0x2fa3a5,_0x5a855d=_0x28f68c[_0x43c0b6(0x27e)][_0x43c0b6(0x25a)],_0xf9c5d4=getClientsWithBotID(_0x43c0b6(0x23a)),_0x385e0e=_0x28f68c[_0x43c0b6(0x2c6)]['uuid'],_0x44e6ee=timelyDecrypt(_0x385e0e,![]),_0xaf236d=_0xf9c5d4[_0x43c0b6(0x1f0)](_0xa64db3=>_0xa64db3[_0x43c0b6(0x357)]==_0x44e6ee);if(_0xaf236d){const _0x57dfbb=normalizeIP(_0x28f68c[_0x43c0b6(0x261)][_0x43c0b6(0x2e6)])['store'],_0x43dc75=_0x28f68c['headers'][_0x43c0b6(0x33f)];if(validateAccess(_0x43dc75,_0x44e6ee,_0x57dfbb)[_0x43c0b6(0x328)])_0x5a855d=='backup'&&await backupConfigFiles(),await zipFiles(_0x5a855d),_0x3956fb['download'](zippath+(_0x5a855d+_0x43c0b6(0x30a)),_0x425e1f=>{const _0x18e853=_0x43c0b6;_0x425e1f&&(logger[_0x18e853(0x370)]('Failed\x20to\x20download\x20'+_0x5a855d),logger[_0x18e853(0x24d)](_0x425e1f));});else logger[_0x43c0b6(0x370)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x5a855d+_0x43c0b6(0x1bf));}else logger['full'](_0x43c0b6(0x1d0)+_0x5a855d+_0x43c0b6(0x2cc));}),app[_0x2fa3a5(0x206)](_0x2fa3a5(0x240),async(_0x59761c,_0x300ea3)=>{const _0x12f4bf=_0x2fa3a5,_0x51e2d7=getClientsWithBotID(_0x12f4bf(0x23a)),_0x5834ae=_0x59761c['headers'][_0x12f4bf(0x357)],_0x187593=timelyDecrypt(_0x5834ae,![]),_0x423f96=_0x51e2d7[_0x12f4bf(0x1f0)](_0x6941e3=>_0x6941e3['uuid']==_0x187593);logger['debug'](_0x12f4bf(0x217));if(_0x423f96){const _0x51f8fa=normalizeIP(_0x59761c[_0x12f4bf(0x261)][_0x12f4bf(0x2e6)])[_0x12f4bf(0x200)],_0x4a19f0=_0x59761c[_0x12f4bf(0x2c6)][_0x12f4bf(0x33f)];if(validateAccess(_0x4a19f0,_0x187593,_0x51f8fa)[_0x12f4bf(0x328)]){if(_0x59761c['files']){const _0x16aae0=_0x59761c[_0x12f4bf(0x28d)][_0x12f4bf(0x1fe)];await _0x16aae0['mv'](temppath+_0x16aae0[_0x12f4bf(0x278)]),_0x300ea3[_0x12f4bf(0x1d8)]({'status':!![],'message':_0x12f4bf(0x37a)});const _0x50c883=getBotsWithMode();_0x50c883[_0x12f4bf(0x2e0)]>0x0?confirmRestore(temppath,_0x16aae0[_0x12f4bf(0x278)]):unzipFile(temppath,_0x16aae0[_0x12f4bf(0x278)]);}}else logger[_0x12f4bf(0x370)](_0x12f4bf(0x352));}else logger[_0x12f4bf(0x370)](_0x12f4bf(0x340));}),app[_0x2fa3a5(0x1d5)](express[_0x2fa3a5(0x31c)](path['join'](__dirname,bbpath2,_0x2fa3a5(0x2ae)))),app[_0x2fa3a5(0x1d5)](express['static'](path[_0x2fa3a5(0x1ea)](__dirname,bbpath2,_0x2fa3a5(0x263)))),app[_0x2fa3a5(0x225)]('/',function(_0x5201f9,_0x1ac485){const _0x5cef41=_0x2fa3a5;_0x1ac485[_0x5cef41(0x320)](path[_0x5cef41(0x1ea)](__dirname,bbpath2,_0x5cef41(0x2ae),'index.html'));}),app[_0x2fa3a5(0x225)](_0x2fa3a5(0x259),function(_0x4f41c2,_0x1a05e7){const _0x5e4a05=_0x2fa3a5;_0x1a05e7[_0x5e4a05(0x320)](path[_0x5e4a05(0x1ea)](__dirname,bbpath2,_0x5e4a05(0x263),_0x5e4a05(0x254)));}),app[_0x2fa3a5(0x225)](_0x2fa3a5(0x1c1),(_0x2c0422,_0xf2202e)=>{const _0x22a551=_0x2fa3a5;_0xf2202e[_0x22a551(0x320)](path[_0x22a551(0x1ea)](__dirname,bbpath2,'build','index.html'));}),app[_0x2fa3a5(0x225)]('/:bot/performance',(_0x248096,_0x3c255e)=>{const _0xd56d4f=_0x2fa3a5;_0x3c255e[_0xd56d4f(0x320)](path[_0xd56d4f(0x1ea)](__dirname,bbpath2,'build',_0xd56d4f(0x254)));}),app[_0x2fa3a5(0x225)](_0x2fa3a5(0x22f),(_0x162c20,_0x5903d7)=>{const _0xa7f71c=_0x2fa3a5;_0x5903d7[_0xa7f71c(0x320)](path['join'](__dirname,bbpath2,_0xa7f71c(0x263),_0xa7f71c(0x254)));}),app['get'](_0x2fa3a5(0x33c),(_0x2ec910,_0x23f589)=>{const _0x10f61b=_0x2fa3a5;_0x23f589['sendFile'](path[_0x10f61b(0x1ea)](__dirname,bbpath2,'build',_0x10f61b(0x254)));}),app['get'](_0x2fa3a5(0x243),(_0x401aac,_0x542e51)=>{const _0x27b320=_0x2fa3a5;_0x542e51[_0x27b320(0x320)](path[_0x27b320(0x1ea)](__dirname,bbpath2,'build',_0x27b320(0x254)));}),app[_0x2fa3a5(0x225)](_0x2fa3a5(0x23f),(_0x26e12f,_0x50d630)=>{const _0x56f428=_0x2fa3a5;_0x50d630[_0x56f428(0x320)](path[_0x56f428(0x1ea)](__dirname,bbpath2,_0x56f428(0x263),_0x56f428(0x254)));});if(HOST)http[_0x2fa3a5(0x36f)](PORT,HOST);else http['listen'](PORT);const io=require(_0x2fa3a5(0x231))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x4eaf20=_0x2fa3a5;logger[_0x4eaf20(0x24d)](''),logger[_0x4eaf20(0x24d)](_0x4eaf20(0x373)),await logger[_0x4eaf20(0x370)](_0x4eaf20(0x287)+PORT),logger[_0x4eaf20(0x24d)](_0x4eaf20(0x373));if(config['length']!=0x0)for(const _0xd0723f of config){if(_0xd0723f[_0x4eaf20(0x2fd)]==_0x4eaf20(0x1e4)||_0xd0723f[_0x4eaf20(0x2fd)]==_0x4eaf20(0x346))await logger[_0x4eaf20(0x370)](_0x4eaf20(0x2ef)+_0xd0723f[_0x4eaf20(0x31e)]+_0x4eaf20(0x337)+_0xd0723f[_0x4eaf20(0x1e0)]),startBot([_0xd0723f[_0x4eaf20(0x31e)],userID],{'cwd':bbpath},function(_0x165dc4){if(_0x165dc4)logger['full'](_0x165dc4);});else(_0xd0723f[_0x4eaf20(0x2fd)]==_0x4eaf20(0x376)||_0xd0723f[_0x4eaf20(0x2fd)]==_0x4eaf20(0x25e))&&await logger[_0x4eaf20(0x370)](_0x4eaf20(0x30e)+_0xd0723f['botID']+_0x4eaf20(0x337)+_0xd0723f[_0x4eaf20(0x1e0)]);}else!newBot&&logger[_0x4eaf20(0x24d)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple'](_0x4eaf20(0x373)),logger[_0x4eaf20(0x24d)]('');}function startSocket(){io['on']('connection',_0x951f32=>{const _0x2146fd=_0x4f83;let _0x346920,_0x42d027,_0x4247fa,_0x39f9ac,_0xb353af;const _0xf6d63f=_0x951f32[_0x2146fd(0x37d)][_0x2146fd(0x2c6)][_0x2146fd(0x2b5)];_0x42d027=_0xf6d63f[_0x2146fd(0x25c)](/bot[0-9]{3}/);if(_0x42d027)_0x4247fa=_0x42d027[0x0][_0x2146fd(0x25c)](/[0-9]{3}/);if(_0x4247fa)_0x346920=_0x4247fa[0x0];else _0x346920=_0x2146fd(0x23a);const _0x13cc4d=_0x951f32[_0x2146fd(0x37d)][_0x2146fd(0x36b)][_0x2146fd(0x313)];if(!_0x13cc4d)_0x951f32[_0x2146fd(0x257)](_0x2146fd(0x2fd),{'publicKey':secure[_0x2146fd(0x252)]});else{_0x39f9ac=timelyDecrypt(_0x13cc4d,![]);if(!_0x39f9ac)_0x951f32['emit'](_0x2146fd(0x2fd),{'publicKey':secure[_0x2146fd(0x252)]});else{_0xb353af=normalizeIP(_0x951f32[_0x2146fd(0x338)][_0x2146fd(0x2e6)])[_0x2146fd(0x200)];if(!devices[_0x39f9ac])devices[_0x39f9ac]={'uuid':_0x39f9ac,'access':{'token':null}};devices[_0x39f9ac]['ip']=_0xb353af;const _0x355eb7=addClient(_0x951f32['id'],_0x39f9ac,_0x346920);setAccess(_0x355eb7),emitMessages(),_0x951f32['on'](_0x2146fd(0x323),_0x36c35e=>{const _0x167ed9=_0x2146fd,_0x582d3b=timelyDecrypt(_0x36c35e[_0x167ed9(0x334)]);if(_0x582d3b){_0x36c35e={'username':_0x36c35e[_0x167ed9(0x1dd)],'password':_0x582d3b},devices[_0x39f9ac][_0x167ed9(0x2a0)]=validateCredentials(_0x36c35e,_0x39f9ac);if(devices[_0x39f9ac][_0x167ed9(0x2a0)][_0x167ed9(0x328)]==![]&&devices[_0x39f9ac][_0x167ed9(0x2a0)][_0x167ed9(0x213)]=='2FA\x20login\x20required')_0x951f32[_0x167ed9(0x257)](_0x167ed9(0x2fd),{'access':devices[_0x39f9ac][_0x167ed9(0x2a0)]}),loginAccess2FA(_0x39f9ac,_0xb353af);else{if(devices[_0x39f9ac][_0x167ed9(0x2a0)][_0x167ed9(0x328)]==![]&&devices[_0x39f9ac][_0x167ed9(0x2a0)]['reason']==_0x167ed9(0x26d))_0x951f32[_0x167ed9(0x257)](_0x167ed9(0x2fd),{'access':devices[_0x39f9ac][_0x167ed9(0x2a0)]});else devices[_0x39f9ac][_0x167ed9(0x2a0)]['allow']&&devices[_0x39f9ac]['access'][_0x167ed9(0x213)]==_0x167ed9(0x341)&&(getClientsWithUuid(_0x39f9ac)[_0x167ed9(0x227)](_0x269818=>{setAccess(_0x269818);}),logger[_0x167ed9(0x28a)]('Logged\x20in\x20user\x20...'+_0x39f9ac[_0x167ed9(0x226)](-0x8)),setTokenRefresh(_0x39f9ac),setSessionTimeout(_0x167ed9(0x323),_0x39f9ac));}}else logger[_0x167ed9(0x370)](_0x167ed9(0x1cf));}),_0x951f32['on'](_0x2146fd(0x238),()=>{resetPassword();}),_0x951f32['on']('disconnect',_0x4f1a90=>{removeClient(_0x951f32['id']);}),_0x346920==_0x2146fd(0x23a)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1d39ac){const _0x4dad06=_0x2fa3a5;if(_0x1d39ac!=_0x4dad06(0x23a)&&config['apiKey']!=''){if(pid[_0x1d39ac])pid[_0x1d39ac][_0x4dad06(0x1d8)]({'function':_0x4dad06(0x271),'args':null});}_0x1d39ac!='botmanager'&&broadcastToBots(_0x4dad06(0x24e),JSON[_0x4dad06(0x25f)](config));}function reloadBotManager(){const _0x648e02=_0x2fa3a5;getClientsWithBotID(_0x648e02(0x23a))[_0x648e02(0x227)](_0x115932=>{const _0x3bd7d7=_0x648e02;getSocket(_0x115932['id'])['emit'](_0x3bd7d7(0x2fd),{'access':{'allow':![],'reason':_0x3bd7d7(0x2f0),'token':null}});});}function getSocket(_0x286941){const _0x530bfc=_0x2fa3a5;return io['sockets'][_0x530bfc(0x1c7)][_0x530bfc(0x225)](_0x286941);}function setAccess(_0x32bcfd){const _0x273b8f=_0x2fa3a5,_0xd17371=getSocket(_0x32bcfd['id']),_0x1be02d=_0x32bcfd[_0x273b8f(0x357)],_0x101140=_0x32bcfd[_0x273b8f(0x33d)];devices[_0x1be02d][_0x273b8f(0x2a0)]=validateAccess(devices[_0x1be02d][_0x273b8f(0x2a0)]['token'],_0x1be02d),logger[_0x273b8f(0x28a)]('Setting\x20access:\x20'+devices[_0x1be02d][_0x273b8f(0x2a0)][_0x273b8f(0x213)]+'\x20|\x20client:\x20...'+_0x32bcfd['id'][_0x273b8f(0x226)](-0x8)+_0x273b8f(0x26a)+_0x1be02d[_0x273b8f(0x226)](-0x8)),_0xd17371[_0x273b8f(0x1ea)](_0x1be02d);if(devices[_0x1be02d][_0x273b8f(0x2a0)][_0x273b8f(0x328)]){_0xd17371[_0x273b8f(0x1ea)](_0x101140);if(_0x101140==_0x273b8f(0x23a))initializeSocketBotManager(_0xd17371);else initializeSocketBot(_0xd17371);initClient(_0x101140);}devices[_0x1be02d][_0x273b8f(0x2a0)]['token']&&devices[_0x1be02d][_0x273b8f(0x2a0)][_0x273b8f(0x213)]==_0x273b8f(0x2be)&&setSessionTimeout(_0x273b8f(0x1f9),_0x1be02d),devices[_0x1be02d][_0x273b8f(0x2a0)][_0x273b8f(0x2d2)]&&devices[_0x1be02d]['access']['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x1be02d),_0xd17371[_0x273b8f(0x257)](_0x273b8f(0x2fd),{'status':_0x32bcfd['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1be02d][_0x273b8f(0x2a0)],'externalip':devices[_0x1be02d]['ip'],'publicKey':secure[_0x273b8f(0x252)],'userid':settings[_0x273b8f(0x2ff)],'validInstallation':validInstallation}),devices[_0x1be02d][_0x273b8f(0x2a0)][_0x273b8f(0x328)]==![]&&devices[_0x1be02d]['access'][_0x273b8f(0x213)]==_0x273b8f(0x292)&&temporaryAccess2FA(_0x1be02d,devices[_0x1be02d]['ip']);}function setSessionTimeout(_0x363abd,_0x122fc6){const _0x79902d=_0x2fa3a5;let _0x6785e1;if(_0x363abd=='login')_0x6785e1=loginExpiry*0x3c*0x3e8;else _0x6785e1=devices[_0x122fc6][_0x79902d(0x31b)][_0x79902d(0x1c3)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x122fc6][_0x79902d(0x31b)][_0x79902d(0x333)]);if(devices[_0x122fc6][_0x79902d(0x1fc)])clearTimeout(devices[_0x122fc6][_0x79902d(0x1fc)]);devices[_0x122fc6][_0x79902d(0x1fc)]=setTimeout(()=>{const _0x3611b6=_0x79902d;if(devices[_0x122fc6]['pidRefreshToken'])clearTimeout(devices[_0x122fc6][_0x3611b6(0x2d0)]);removeSocketListeners(_0x122fc6),addBlacklist(_0x122fc6),devices[_0x122fc6][_0x3611b6(0x31b)]=null,devices[_0x122fc6][_0x3611b6(0x2f4)]=null,devices[_0x122fc6][_0x3611b6(0x2a0)][_0x3611b6(0x2d2)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x122fc6[_0x3611b6(0x226)](-0x8)),devices[_0x122fc6][_0x3611b6(0x2a0)]=validateAccess(devices[_0x122fc6]['access'][_0x3611b6(0x2d2)],_0x122fc6),!(devices[_0x122fc6][_0x3611b6(0x2a0)][_0x3611b6(0x328)]&&devices[_0x122fc6][_0x3611b6(0x2a0)][_0x3611b6(0x213)]==_0x3611b6(0x232))&&(_0x363abd=='login'?io['to'](_0x122fc6)[_0x3611b6(0x257)](_0x3611b6(0x2fd),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x122fc6)[_0x3611b6(0x257)](_0x3611b6(0x2fd),{'access':{'allow':![],'reason':_0x3611b6(0x36a),'token':null}})),devices[_0x122fc6]['access']['token']=null;},_0x6785e1);}function setTokenRefresh(_0x26393b){const _0x560622=_0x2fa3a5;if(devices[_0x26393b][_0x560622(0x2d0)])clearTimeout(devices[_0x26393b][_0x560622(0x2d0)]);devices[_0x26393b][_0x560622(0x2d0)]=setTimeout(()=>{const _0x202898=_0x560622;getClientsWithUuid(_0x26393b)[_0x202898(0x2e0)]!=0x0?(devices[_0x26393b][_0x202898(0x2a0)]=refreshToken(_0x26393b),io['to'](_0x26393b)[_0x202898(0x257)](_0x202898(0x2fd),{'status':_0x202898(0x267),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x26393b][_0x202898(0x2a0)],'externalip':devices[_0x26393b]['ip'],'publicKey':secure[_0x202898(0x252)],'validInstallation':validInstallation}),setTokenRefresh(_0x26393b)):clearTimeout(devices[_0x26393b]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4ff34d){const _0x265e97=_0x2fa3a5,_0x4e2219=getClient(_0x4ff34d['id'])[_0x265e97(0x357)];_0x4ff34d[_0x265e97(0x257)](_0x265e97(0x24e),config),_0x4ff34d[_0x265e97(0x257)](_0x265e97(0x230),cleanSettings()),_0x4ff34d['on']('add-bot',_0xd61778=>{const _0x317d9d=_0x265e97;if(validateAccess(_0xd61778,_0x4e2219)[_0x317d9d(0x328)])addBot();else logger[_0x317d9d(0x370)](_0x317d9d(0x309));}),_0x4ff34d['on'](_0x265e97(0x1d1),(_0x4a8d81,_0x382fe0)=>{const _0x411e91=_0x265e97;if(validateAccess(_0x382fe0,_0x4e2219)['allow'])toggleBot(_0x4a8d81[_0x411e91(0x31e)],_0x4a8d81[_0x411e91(0x2fd)],_0x4a8d81[_0x411e91(0x30b)]);else logger[_0x411e91(0x370)](_0x411e91(0x321));}),_0x4ff34d['on'](_0x265e97(0x281),(_0x556e40,_0x421668)=>{const _0xb7c9a3=_0x265e97;if(validateAccess(_0x421668,_0x4e2219)['allow'])toggleBotMode(_0x556e40);else logger[_0xb7c9a3(0x370)](_0xb7c9a3(0x321));}),_0x4ff34d['on']('delete-bot',(_0xce00c0,_0x11c514)=>{const _0xe80315=_0x265e97;if(validateAccess(_0x11c514,_0x4e2219)[_0xe80315(0x328)])deleteBot(_0xce00c0);else logger[_0xe80315(0x370)](_0xe80315(0x266));}),_0x4ff34d['on'](_0x265e97(0x384),(_0x35211c,_0x313939)=>{const _0x286058=_0x265e97;if(validateAccess(_0x313939,_0x4e2219)[_0x286058(0x328)])storeSettings(_0x35211c,!![]);else logger[_0x286058(0x370)](_0x286058(0x1dc));}),_0x4ff34d['on']('update-bb',_0x3d50c9=>{const _0x30d926=_0x265e97;if(validateAccess(_0x3d50c9,_0x4e2219)[_0x30d926(0x328)])updateBB(_0x30d926(0x2ed));else logger[_0x30d926(0x370)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4ff34d['on'](_0x265e97(0x2e7),_0x1cd679=>{const _0x292586=_0x265e97;if(validateAccess(_0x1cd679,_0x4e2219)[_0x292586(0x328)])updateBB('reinstall');else logger[_0x292586(0x370)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4ff34d['on']('get-backup-files',_0x39bf59=>{const _0xb92217=_0x265e97;if(validateAccess(_0x39bf59,_0x4e2219)['allow']){const _0x3f4ff0=getClient(_0x4ff34d['id']);if(_0x3f4ff0)getBackupFiles(_0x3f4ff0['uuid']);else logger[_0xb92217(0x370)](_0xb92217(0x36c));}else logger['full'](_0xb92217(0x33e));}),_0x4ff34d['on'](_0x265e97(0x285),(_0x5e79eb,_0x3ed567)=>{const _0x34ddb7=_0x265e97;if(validateAccess(_0x3ed567,_0x4e2219)[_0x34ddb7(0x328)])restoreBackupFile(_0x5e79eb);else logger[_0x34ddb7(0x370)](_0x34ddb7(0x241));}),_0x4ff34d['on'](_0x265e97(0x1da),_0xb485ce=>{const _0x282eca=_0x265e97;if(validateAccess(_0xb485ce,_0x4e2219)[_0x282eca(0x328)])getMessages();else logger[_0x282eca(0x370)](_0x282eca(0x2f6));}),_0x4ff34d['on'](_0x265e97(0x2f7),(_0x2ad963,_0x411529)=>{const _0x586f38=_0x265e97;if(validateAccess(_0x411529,_0x4e2219)[_0x586f38(0x328)])confirmMessage(_0x2ad963);else logger['full'](_0x586f38(0x224));}),_0x4ff34d['on']('logout',_0x4b8893=>{const _0x2a03da=_0x265e97;if(validateAccess(_0x4b8893,_0x4e2219)[_0x2a03da(0x328)]){if(devices[_0x4e2219][_0x2a03da(0x2d0)])clearTimeout(devices[_0x4e2219]['pidRefreshToken']);if(devices[_0x4e2219][_0x2a03da(0x1fc)])clearTimeout(devices[_0x4e2219][_0x2a03da(0x1fc)]);removeSocketListeners(getClient(_0x4ff34d['id'])['uuid']),addBlacklist(_0x4e2219),devices[_0x4e2219][_0x2a03da(0x31b)]=null,devices[_0x4e2219][_0x2a03da(0x2f4)]=null,devices[_0x4e2219][_0x2a03da(0x2a0)][_0x2a03da(0x2d2)]=null,logger[_0x2a03da(0x28a)](_0x2a03da(0x1cb)+_0x4e2219['slice'](-0x8)),io['to'](getClient(_0x4ff34d['id'])[_0x2a03da(0x357)])[_0x2a03da(0x257)](_0x2a03da(0x2fd),{'access':{'allow':![],'reason':_0x2a03da(0x35e),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x21a608){const _0x27fa75=_0x2fa3a5,_0x59eee3=getClient(_0x21a608['id'])[_0x27fa75(0x33d)],_0x41db20=getClient(_0x21a608['id'])[_0x27fa75(0x357)];_0x21a608['on'](_0x27fa75(0x344),(_0x2d75cc,_0x38d21c)=>{const _0x5a2072=_0x27fa75;if(validateAccess(_0x38d21c,_0x41db20)[_0x5a2072(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x5a2072(0x1d8)]({'function':'emitHistory','args':_0x2d75cc});}else logger[_0x5a2072(0x370)](_0x5a2072(0x223));}),_0x21a608['on']('delete-alerts',(_0x117473,_0x121b00)=>{const _0x5e1395=_0x27fa75;if(validateAccess(_0x121b00,_0x41db20)['allow']){if(pid[_0x59eee3])pid[_0x59eee3]['send']({'function':_0x5e1395(0x26c),'args':_0x117473});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x21a608['on'](_0x27fa75(0x2bc),(_0x166b34,_0x19997a)=>{const _0x4edfdd=_0x27fa75;if(validateAccess(_0x19997a,_0x41db20)[_0x4edfdd(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3]['send']({'function':_0x4edfdd(0x1db),'args':_0x166b34});}else logger[_0x4edfdd(0x370)](_0x4edfdd(0x302));}),_0x21a608['on'](_0x27fa75(0x1f4),(_0x3b5e27,_0xe2e2a0)=>{const _0x481b6d=_0x27fa75;if(validateAccess(_0xe2e2a0,_0x41db20)[_0x481b6d(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x481b6d(0x1d8)]({'function':_0x481b6d(0x21b),'args':_0x3b5e27});}else logger[_0x481b6d(0x370)](_0x481b6d(0x2ca));}),_0x21a608['on'](_0x27fa75(0x34e),(_0x56d9aa,_0x1a37ee)=>{const _0x127b54=_0x27fa75;if(validateAccess(_0x1a37ee,_0x41db20)[_0x127b54(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x127b54(0x1d8)]({'function':_0x127b54(0x315),'args':_0x56d9aa});}else logger['full'](_0x127b54(0x2ba));}),_0x21a608['on'](_0x27fa75(0x264),(_0x838863,_0x5680ec)=>{const _0x35cd8e=_0x27fa75;if(validateAccess(_0x5680ec,_0x41db20)[_0x35cd8e(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3]['send']({'function':_0x35cd8e(0x24c),'args':_0x838863});}else logger['full'](_0x35cd8e(0x2fb));}),_0x21a608['on'](_0x27fa75(0x1de),_0x3b9f41=>{const _0x2845e1=_0x27fa75;if(validateAccess(_0x3b9f41,_0x41db20)[_0x2845e1(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x2845e1(0x1d8)]({'function':_0x2845e1(0x2c4),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x21a608['on'](_0x27fa75(0x1e2),_0x1a1e47=>{const _0x459c55=_0x27fa75;if(validateAccess(_0x1a1e47,_0x41db20)[_0x459c55(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x459c55(0x1d8)]({'function':_0x459c55(0x37f),'args':null});}else logger[_0x459c55(0x370)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x21a608['on'](_0x27fa75(0x1cc),(_0x14c98b,_0x1aaee2)=>{const _0x49069d=_0x27fa75;if(validateAccess(_0x1aaee2,_0x41db20)[_0x49069d(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x49069d(0x1d8)]({'function':_0x49069d(0x305),'args':_0x14c98b});}else logger[_0x49069d(0x370)](_0x49069d(0x2da));}),_0x21a608['on'](_0x27fa75(0x2bb),_0x1a7882=>{const _0x56ccdf=_0x27fa75;if(validateAccess(_0x1a7882,_0x41db20)[_0x56ccdf(0x328)]){if(pid[_0x59eee3])pid[_0x59eee3][_0x56ccdf(0x1d8)]({'function':_0x56ccdf(0x2c8),'args':null});}else logger[_0x56ccdf(0x370)](_0x56ccdf(0x381));}),_0x21a608['on'](_0x27fa75(0x383),_0x2a3f51=>{const _0x2eaf1d=_0x27fa75;if(validateAccess(_0x2a3f51,_0x41db20)['allow']){if(pid[_0x59eee3])pid[_0x59eee3][_0x2eaf1d(0x1d8)]({'function':_0x2eaf1d(0x2e1),'args':null});}else logger[_0x2eaf1d(0x370)](_0x2eaf1d(0x349));}),_0x21a608['on'](_0x27fa75(0x28e),_0x41b34d=>{const _0x54cb6b=_0x27fa75;if(validateAccess(_0x41b34d,_0x41db20)[_0x54cb6b(0x328)])updateBB(_0x54cb6b(0x2ed));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x21a608['on'](_0x27fa75(0x1da),_0x554dc2=>{const _0x325da3=_0x27fa75;if(validateAccess(_0x554dc2,_0x41db20)[_0x325da3(0x328)])getMessages();else logger[_0x325da3(0x370)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x21a608['on'](_0x27fa75(0x2f7),(_0x9406c1,_0x39aa19)=>{const _0x5b7695=_0x27fa75;if(validateAccess(_0x39aa19,_0x41db20)[_0x5b7695(0x328)])confirmMessage(_0x9406c1);else logger['full'](_0x5b7695(0x224));}),_0x21a608['on']('logout',_0x1379de=>{const _0x1c2124=_0x27fa75;if(validateAccess(_0x1379de,_0x41db20)[_0x1c2124(0x328)]){if(devices[_0x41db20][_0x1c2124(0x2d0)])clearTimeout(devices[_0x41db20][_0x1c2124(0x2d0)]);if(devices[_0x41db20]['pidExpireLogin'])clearTimeout(devices[_0x41db20][_0x1c2124(0x1fc)]);removeSocketListeners(getClient(_0x21a608['id'])[_0x1c2124(0x357)]),addBlacklist(_0x41db20),devices[_0x41db20][_0x1c2124(0x31b)]=null,devices[_0x41db20][_0x1c2124(0x2f4)]=null,devices[_0x41db20][_0x1c2124(0x2a0)][_0x1c2124(0x2d2)]=null,logger['debug'](_0x1c2124(0x1cb)+_0x41db20[_0x1c2124(0x226)](-0x8)),io['to'](getClient(_0x21a608['id'])[_0x1c2124(0x357)])[_0x1c2124(0x257)](_0x1c2124(0x2fd),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x1c2124(0x365));});}function removeSocketListeners(_0x465f9c){getClientsWithUuid(_0x465f9c)['forEach'](_0x203676=>{const _0x4e8dfd=_0x4f83;getSocket(_0x203676['id'])[_0x4e8dfd(0x2aa)]();});}function cleanSettings(){const _0x3bbf27=_0x2fa3a5;let _0x343f2a=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x343f2a={..._0x343f2a,'telegramToken':_0x3bbf27(0x1c0)}),settings[_0x3bbf27(0x20e)]&&settings['bbPassword']!=''&&(_0x343f2a={..._0x343f2a,'bbPassword':_0x3bbf27(0x1c0)}),(settings[_0x3bbf27(0x20e)]&&settings['bbPassword']==_0x3bbf27(0x369)||settings[_0x3bbf27(0x29d)]&&settings[_0x3bbf27(0x29d)]==_0x3bbf27(0x369))&&(_0x343f2a={..._0x343f2a,'restored':{'password':settings[_0x3bbf27(0x20e)]==_0x3bbf27(0x369),'telegram':settings[_0x3bbf27(0x29d)]==_0x3bbf27(0x369)}}),_0x343f2a;}async function updateBB(_0x58efb1){const _0x1dcaee=_0x2fa3a5;await backupConfigFiles(),installingUpdate=!![],config[_0x1dcaee(0x227)](_0x8a70a4=>{const _0x5e6cf1=_0x1dcaee;restartBot(_0x8a70a4[_0x5e6cf1(0x31e)]);}),logger['debug'](_0x1dcaee(0x26b)+_0x58efb1);if(_0x58efb1=='update')process[_0x1dcaee(0x1d8)]({'update':!![]},_0xfd0c00=>{});else _0x58efb1==_0x1dcaee(0x2c2)&&process[_0x1dcaee(0x1d8)]({'reinstall':!![]},_0x110283=>{});}function startBot(_0x56f1d8,_0x1de22b,_0x4ca278){const _0x15a5c6=_0x2fa3a5;if(debugging)_0x56f1d8[_0x15a5c6(0x2f5)]('-d');let _0x245f0a=![];const _0x24026d=_0x56f1d8[0x0];_0x1de22b={..._0x1de22b,'stdio':[_0x15a5c6(0x348),_0x15a5c6(0x348),_0x15a5c6(0x348),'ipc']},pid[_0x24026d]=childProcess[_0x15a5c6(0x1f6)](botfile,_0x56f1d8,_0x1de22b),pid[_0x24026d]['on']('message',_0x1ca443=>{const _0x384520=_0x15a5c6;switch(Object['keys'](_0x1ca443)[0x0]){case _0x384520(0x1e0):updateBotName(_0x24026d,_0x1ca443[_0x384520(0x1e0)]);break;case _0x384520(0x366):updateBotManager();break;case'status':updateStatus(_0x24026d,_0x1ca443[_0x384520(0x2fd)]);break;case'live':updateLive(_0x24026d,_0x1ca443['live']);break;case _0x384520(0x329):updateLive(_0x24026d,_0x1ca443[_0x384520(0x329)]),io['to'](_0x24026d)[_0x384520(0x257)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x1ca443[_0x384520(0x32b)]=='restart'&&restartBot(_0x24026d);_0x1ca443[_0x384520(0x32b)]=='kill'&&toggleBot(_0x24026d,_0x384520(0x376),_0x384520(0x1c4));break;case'telegram':sendTelegram(_0x24026d,_0x1ca443['telegram']);break;case _0x384520(0x219):sendTelegramMsg(_0x1ca443[_0x384520(0x219)]);break;case _0x384520(0x1fb):io['to'](_0x24026d)[_0x384520(0x257)](_0x1ca443[_0x384520(0x1fb)],_0x1ca443[_0x384520(0x20d)]);break;}}),pid[_0x24026d]['on'](_0x15a5c6(0x25d),function(_0x1c2fae){if(_0x245f0a)return;_0x245f0a=!![],_0x4ca278(_0x1c2fae);}),pid[_0x24026d]['on'](_0x15a5c6(0x291),async function(_0x1eecfa){const _0x116c44=_0x15a5c6;if(installingUpdate)return;if(_0x245f0a)return;_0x245f0a=!![],_0x4ca278(null);const _0x26e2a2=dbConfig[_0x116c44(0x225)]('bots')[_0x116c44(0x1f0)]({'botID':_0x24026d})[_0x116c44(0x350)]();_0x26e2a2&&(_0x26e2a2[_0x116c44(0x2fd)]==_0x116c44(0x1e4)||_0x26e2a2[_0x116c44(0x2fd)]==_0x116c44(0x346))&&(await sleep(0x3e8),updateLive(_0x24026d,_0x116c44(0x1c4)),logger[_0x116c44(0x370)](_0x116c44(0x2a1)+_0x24026d),startBot([_0x24026d,userID],{'cwd':bbpath},function(_0x3de6bc){const _0x5c2b7f=_0x116c44;if(_0x3de6bc)logger[_0x5c2b7f(0x370)](_0x3de6bc);}));});}function stopBot(_0x4d72bb){const _0x9daf25=_0x2fa3a5;getClientsWithBotID(_0x4d72bb)['forEach'](_0x2516c5=>{getSocket(_0x2516c5['id'])['disconnect'](!![]),removeClient(_0x2516c5['id']);}),pid[_0x4d72bb]&&(pid[_0x4d72bb][_0x9daf25(0x2df)](),pid[_0x4d72bb]=null);}function restartBot(_0x30342c){const _0x45b686=_0x2fa3a5;if(pid[_0x30342c])pid[_0x30342c][_0x45b686(0x2df)]();}function addBot(){const _0x3b6df4=_0x2fa3a5;let _0x534050;for(let _0x1391d6=0x1;_0x1391d6<0x3e9;_0x1391d6++){_0x534050=_0x1391d6[_0x3b6df4(0x310)]()['padStart'](0x3,'0');let _0x26adbc=config['find'](_0x49e437=>_0x49e437[_0x3b6df4(0x31e)]==_0x534050);if(!_0x26adbc)break;}if(_0x534050==='1000'){logger[_0x3b6df4(0x370)](_0x3b6df4(0x325));return;}logger[_0x3b6df4(0x370)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x534050),dbConfig[_0x3b6df4(0x225)](_0x3b6df4(0x24e))[_0x3b6df4(0x2f5)]({'botID':_0x534050,'botname':_0x3b6df4(0x2b2)+_0x534050,'status':_0x3b6df4(0x346),'live':''})[_0x3b6df4(0x379)](),startBot([_0x534050,userID],{'cwd':bbpath},function(_0x596494){const _0x406677=_0x3b6df4;if(_0x596494)logger[_0x406677(0x370)](_0x596494);}),config=getConfiguration(),io['to'](_0x3b6df4(0x23a))['emit'](_0x3b6df4(0x24e),config),broadcastToBots('bots',JSON[_0x3b6df4(0x25f)](config));}function deleteBot(_0x37f033){const _0x1f8e03=_0x2fa3a5;getClientsWithBotID(_0x37f033)[_0x1f8e03(0x227)](_0x3ac90a=>{const _0x68a817=_0x1f8e03;getSocket(_0x3ac90a['id'])[_0x68a817(0x2a8)](!![]),removeClient(_0x3ac90a['id']);}),dbConfig['get'](_0x1f8e03(0x24e))[_0x1f8e03(0x2c5)]({'botID':_0x37f033})[_0x1f8e03(0x379)](),logger[_0x1f8e03(0x370)](_0x1f8e03(0x316)+_0x37f033),stopBot(_0x37f033);try{if(fs[_0x1f8e03(0x210)](path['join'](configpath,_0x1f8e03(0x1f3)+_0x37f033+_0x1f8e03(0x274))))fs[_0x1f8e03(0x2d8)](path['join'](configpath,_0x1f8e03(0x1f3)+_0x37f033+_0x1f8e03(0x274)));if(fs[_0x1f8e03(0x210)](path[_0x1f8e03(0x1ea)](configpath,_0x1f8e03(0x1f3)+_0x37f033+_0x1f8e03(0x2b6))))fs[_0x1f8e03(0x2d8)](path[_0x1f8e03(0x1ea)](configpath,'bot-'+_0x37f033+_0x1f8e03(0x2b6)));if(fs['existsSync'](path[_0x1f8e03(0x1ea)](configpath,_0x1f8e03(0x1f3)+_0x37f033+_0x1f8e03(0x2c7))))fs[_0x1f8e03(0x2d8)](path[_0x1f8e03(0x1ea)](configpath,_0x1f8e03(0x1f3)+_0x37f033+_0x1f8e03(0x2c7)));if(fs['existsSync'](path[_0x1f8e03(0x1ea)](configpath,_0x1f8e03(0x1f3)+_0x37f033+_0x1f8e03(0x21e))))fs['unlinkSync'](path[_0x1f8e03(0x1ea)](configpath,_0x1f8e03(0x1f3)+_0x37f033+'-results.json'));}catch(_0x5d283d){if(_0x5d283d)logger[_0x1f8e03(0x370)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x5d283d);}config=getConfiguration(),io['to']('botmanager')[_0x1f8e03(0x257)](_0x1f8e03(0x24e),config),broadcastToBots(_0x1f8e03(0x24e),JSON['stringify'](config));}function toggleBot(_0x5e96d2,_0x33ba15,_0xabd1e8){const _0x42925e=_0x2fa3a5;dbConfig[_0x42925e(0x225)](_0x42925e(0x24e))['find']({'botID':_0x5e96d2})[_0x42925e(0x36e)]({'status':_0x33ba15})[_0x42925e(0x36e)]({'live':_0xabd1e8})[_0x42925e(0x379)]();if(_0x33ba15=='enabled'||_0x33ba15=='new')logger[_0x42925e(0x370)](_0x42925e(0x1d2)+_0x5e96d2),startBot([_0x5e96d2,userID],{'cwd':bbpath},function(_0x38067e){const _0x466776=_0x42925e;if(_0x38067e)logger[_0x466776(0x370)](_0x38067e);});else(_0x33ba15==_0x42925e(0x376)||_0x33ba15==_0x42925e(0x25e))&&(logger['full'](_0x42925e(0x2fa)+_0x5e96d2),stopBot(_0x5e96d2));config=getConfiguration(),io['to'](_0x42925e(0x23a))[_0x42925e(0x257)](_0x42925e(0x24e),config),broadcastToBots('bots',JSON[_0x42925e(0x25f)](config));}function toggleStatus(_0x2afdde){const _0x25de42=_0x2fa3a5;let _0x596bcf=dbConfig[_0x25de42(0x225)](_0x25de42(0x24e))[_0x25de42(0x1f0)]({'botID':_0x2afdde})[_0x25de42(0x350)](),_0x19255f;if(_0x596bcf[_0x25de42(0x2fd)]===_0x25de42(0x1e4))_0x19255f=_0x25de42(0x376);else{if(_0x596bcf[_0x25de42(0x2fd)]===_0x25de42(0x346))_0x19255f='new-disabled';else{if(_0x596bcf[_0x25de42(0x2fd)]==='new-disabled')_0x19255f=_0x25de42(0x346);else{if(_0x596bcf['status']===_0x25de42(0x376))_0x19255f=_0x25de42(0x1e4);}}}return _0x19255f;}function updateStatus(_0x3651a4,_0x52910f){const _0xc7002e=_0x2fa3a5;dbConfig[_0xc7002e(0x225)](_0xc7002e(0x24e))[_0xc7002e(0x1f0)]({'botID':_0x3651a4})[_0xc7002e(0x36e)]({'status':_0x52910f})['write'](),config=getConfiguration(),io['to'](_0xc7002e(0x23a))['emit']('bots',config),broadcastToBots(_0xc7002e(0x24e),JSON[_0xc7002e(0x25f)](config));}function updateLive(_0xf244dc,_0x3a013e){const _0x1c6e28=_0x2fa3a5;dbConfig[_0x1c6e28(0x225)](_0x1c6e28(0x24e))['find']({'botID':_0xf244dc})[_0x1c6e28(0x36e)]({'live':_0x3a013e})['write'](),config=getConfiguration(),io['to'](_0x1c6e28(0x23a))[_0x1c6e28(0x257)](_0x1c6e28(0x24e),config),broadcastToBots(_0x1c6e28(0x24e),JSON[_0x1c6e28(0x25f)](config));}function updateBotName(_0x1916cf,_0x141d01){const _0x5a2863=_0x2fa3a5;dbConfig[_0x5a2863(0x225)](_0x5a2863(0x24e))[_0x5a2863(0x1f0)]({'botID':_0x1916cf})['assign']({'botname':_0x141d01})[_0x5a2863(0x379)](),config=getConfiguration(),io['to'](_0x5a2863(0x23a))[_0x5a2863(0x257)](_0x5a2863(0x24e),config),broadcastToBots(_0x5a2863(0x24e),JSON['stringify'](config));}function updateBotManager(){const _0x547cf8=_0x2fa3a5;config=getConfiguration(),io['to'](_0x547cf8(0x23a))['emit']('bots',config),broadcastToBots(_0x547cf8(0x24e),JSON[_0x547cf8(0x25f)](config));}function toggleBotMode(_0x1eee9b){const _0x5149df=_0x2fa3a5;if(pid[_0x1eee9b])pid[_0x1eee9b][_0x5149df(0x1d8)]({'function':'toggleBotMode','args':null});else{const _0x269cf7=configpath+'bot-'+_0x1eee9b+_0x5149df(0x274),_0x496155=fs['readFileSync'](_0x269cf7),_0x208675=JSON['parse'](_0x496155),_0x5899ff=_0x208675[_0x5149df(0x33d)][0x0][_0x5149df(0x24b)];_0x208675[_0x5149df(0x33d)][0x0]['headless']=!_0x5899ff;const _0x53f4f3=JSON[_0x5149df(0x25f)](_0x208675,null,0x2);fs['writeFileSync'](_0x269cf7,_0x53f4f3),config=getConfiguration(),io['to'](_0x5149df(0x23a))[_0x5149df(0x257)](_0x5149df(0x24e),config),broadcastToBots(_0x5149df(0x24e),JSON['stringify'](config));}}function telegramError(_0x401fda){const _0x21c0c8=_0x2fa3a5;logger[_0x21c0c8(0x24d)](getTimeStamp()+_0x21c0c8(0x378));}function validateTelegram(_0x33dcd5){const _0x9b33b3=_0x2fa3a5;if(_0x33dcd5[_0x9b33b3(0x32d)]['username']!=settings[_0x9b33b3(0x235)]&&'@'+_0x33dcd5['from'][_0x9b33b3(0x1dd)]!=settings[_0x9b33b3(0x235)])return tgBot[_0x9b33b3(0x2dd)](_0x33dcd5[_0x9b33b3(0x214)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x9b33b3(0x2a3)](_0x49d99a=>{telegramError(_0x49d99a);}),![];return!![];}async function initTelegram(){const _0x3b3cad=_0x2fa3a5;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3ae6ca='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3ae6ca+='\x0a',_0x3ae6ca+=_0x3b3cad(0x283),_0x3ae6ca+=_0x3b3cad(0x2a6),_0x3ae6ca+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x3ae6ca+=_0x3b3cad(0x27c),_0x3ae6ca+=_0x3b3cad(0x356),_0x3ae6ca+=_0x3b3cad(0x239),_0x3ae6ca+=_0x3b3cad(0x354),_0x3ae6ca+=_0x3b3cad(0x2bf),_0x3ae6ca+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x3ae6ca+=_0x3b3cad(0x26e),_0x3ae6ca+=_0x3b3cad(0x277),_0x3ae6ca+=_0x3b3cad(0x339),_0x3ae6ca+=_0x3b3cad(0x1f7),_0x3ae6ca+='/help\x20-\x20show\x20available\x20commands\x0a';let _0xb5960e=_0x3b3cad(0x297);_0xb5960e+='\x0a',_0xb5960e+=_0x3ae6ca,tgBot[_0x3b3cad(0x228)](/\/start/,_0x412c5a=>{const _0x333020=_0x3b3cad;if(!validateTelegram(_0x412c5a))return;if(settings['telegramChatId']!=_0x412c5a[_0x333020(0x214)]['id'])updateSetting(_0x333020(0x2b7),_0x412c5a[_0x333020(0x214)]['id']);updateSetting(_0x333020(0x20b),!![]),tgBot[_0x333020(0x2dd)](_0x412c5a['chat']['id'],_0xb5960e)[_0x333020(0x2a3)](_0x38ff7b=>{telegramError(_0x38ff7b);});}),tgBot[_0x3b3cad(0x228)](/\/enable/,_0x458af1=>{const _0x364052=_0x3b3cad;if(!validateTelegram(_0x458af1))return;if(settings[_0x364052(0x2b7)]!=_0x458af1[_0x364052(0x214)]['id'])updateSetting(_0x364052(0x2b7),_0x458af1[_0x364052(0x214)]['id']);updateSetting(_0x364052(0x20b),!![]),tgBot[_0x364052(0x2dd)](_0x458af1['chat']['id'],_0x364052(0x284))['catch'](_0x1a6d34=>{telegramError(_0x1a6d34);});}),tgBot['onText'](/\/config/,async _0x571cdc=>{const _0x351122=_0x3b3cad;if(!validateTelegram(_0x571cdc))return;tgBot[_0x351122(0x317)]('callback_query'),tgBot[_0x351122(0x2dd)](_0x571cdc[_0x351122(0x214)]['id'],_0x351122(0x201),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x351122(0x2bd)},{'text':_0x351122(0x1d3),'callback_data':_0x351122(0x260)},{'text':_0x351122(0x2e2),'callback_data':_0x351122(0x343)}]]}})['catch'](_0x4517bc=>{telegramError(_0x4517bc);}),tgBot['on'](_0x351122(0x1ca),async _0x3b84b2=>{const _0x387203=_0x351122,_0x4ace79=_0x3b84b2[_0x387203(0x360)],_0x4abaad=_0x3b84b2[_0x387203(0x30f)];tgBot[_0x387203(0x37c)](_0x3b84b2['id'])[_0x387203(0x35f)](async()=>{const _0x162bf0=_0x387203;_0x4ace79==_0x162bf0(0x2bd)&&(updateSetting(_0x162bf0(0x276),_0x162bf0(0x2bd)),updateSetting(_0x162bf0(0x20b),!![]),await tgBot[_0x162bf0(0x2dd)](_0x4abaad[_0x162bf0(0x214)]['id'],_0x162bf0(0x362))[_0x162bf0(0x2a3)](_0x586e14=>{telegramError(_0x586e14);}));_0x4ace79==_0x162bf0(0x260)&&(updateSetting(_0x162bf0(0x276),_0x162bf0(0x260)),updateSetting(_0x162bf0(0x20b),!![]),await tgBot[_0x162bf0(0x2dd)](_0x4abaad[_0x162bf0(0x214)]['id'],_0x162bf0(0x253))[_0x162bf0(0x2a3)](_0x48bec3=>{telegramError(_0x48bec3);}));_0x4ace79==_0x162bf0(0x343)&&(updateSetting(_0x162bf0(0x276),'all'),updateSetting('telegramEnabled',!![]),await tgBot[_0x162bf0(0x2dd)](_0x4abaad[_0x162bf0(0x214)]['id'],_0x162bf0(0x1e9))[_0x162bf0(0x2a3)](_0x323b78=>{telegramError(_0x323b78);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x4abaad[_0x162bf0(0x214)]['id'],_0x162bf0(0x2e8))['catch'](_0x5bd699=>{telegramError(_0x5bd699);});}),tgBot[_0x387203(0x317)]('callback_query');});}),tgBot[_0x3b3cad(0x228)](/\/status/,_0x1e8c9d=>{const _0x4d9d45=_0x3b3cad;if(!validateTelegram(_0x1e8c9d))return;const _0x42a0fa=getBotsWithMode();let _0x39112c=_0x4d9d45(0x2d6);config[_0x4d9d45(0x227)](_0x23e3a8=>{const _0x4409ac=_0x4d9d45,_0x370102=_0x42a0fa['find'](_0x37561c=>_0x37561c[_0x4409ac(0x31e)]==_0x23e3a8[_0x4409ac(0x31e)])[_0x4409ac(0x364)];_0x39112c+='Bot\x20'+_0x23e3a8[_0x4409ac(0x31e)]+':\x20'+_0x23e3a8[_0x4409ac(0x2fd)]+'\x20|\x20'+_0x370102+_0x4409ac(0x337)+_0x23e3a8['live']+'\x0a';}),_0x39112c+='\x0a',_0x39112c+=_0x4d9d45(0x22a),_0x39112c+=!settings[_0x4d9d45(0x20b)]?_0x4d9d45(0x20f):'Notifications\x20enabled\x0a',_0x39112c+=settings['telegramEnabled']?settings[_0x4d9d45(0x276)]=='all'?_0x4d9d45(0x286):_0x4d9d45(0x211)+settings[_0x4d9d45(0x276)]+'\x20only\x0a':'',tgBot[_0x4d9d45(0x2dd)](_0x1e8c9d[_0x4d9d45(0x214)]['id'],_0x39112c,{'parse_mode':_0x4d9d45(0x1e6)})[_0x4d9d45(0x2a3)](_0x5f59ee=>{telegramError(_0x5f59ee);});}),tgBot[_0x3b3cad(0x228)](/\/restart/,_0x28fc17=>{const _0x4b7724=_0x3b3cad;if(!validateTelegram(_0x28fc17))return;tgBot[_0x4b7724(0x317)](_0x4b7724(0x1ca));const _0x403c7a=getEnabledBots();if(_0x403c7a[_0x4b7724(0x2e0)]==0x0)tgBot['sendMessage'](_0x28fc17[_0x4b7724(0x214)]['id'],_0x4b7724(0x24a))['catch'](_0x1d9545=>{telegramError(_0x1d9545);});else{if(_0x403c7a['length']>0x1)_0x403c7a['push']({'botID':_0x4b7724(0x343)});let _0xa5e8f9=[],_0x52e69e=[];const _0x450810=_0x403c7a[_0x4b7724(0x2e0)]%0x4==0x0||_0x403c7a[_0x4b7724(0x2e0)]%0x4==0x3||_0x403c7a[_0x4b7724(0x2e0)]%0x3==0x1?0x4:0x3;let _0x45ae55=0x0;_0x403c7a['forEach']((_0x4118fd,_0x5bdd3b)=>{const _0x4813ee=_0x4b7724;if(_0x5bdd3b%_0x450810==0x0)_0x52e69e=[];_0x52e69e[_0x4813ee(0x2f5)]({'text':_0x4118fd['botID']==_0x4813ee(0x343)?_0x4813ee(0x34a):_0x4813ee(0x2b2)+_0x4118fd[_0x4813ee(0x31e)],'callback_data':_0x4118fd[_0x4813ee(0x31e)]}),_0x5bdd3b%_0x450810==0x0&&(_0xa5e8f9[_0x45ae55]=_0x52e69e,_0x45ae55++);}),tgBot[_0x4b7724(0x2dd)](_0x28fc17[_0x4b7724(0x214)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0xa5e8f9}})[_0x4b7724(0x2a3)](_0x3e26d3=>{telegramError(_0x3e26d3);}),tgBot['on'](_0x4b7724(0x1ca),async _0xf58ff5=>{const _0x27b7ba=_0x4b7724,_0x570472=_0xf58ff5[_0x27b7ba(0x360)],_0x2047e7=_0xf58ff5['message'];tgBot[_0x27b7ba(0x37c)](_0xf58ff5['id'])[_0x27b7ba(0x35f)](async()=>{const _0xe72977=_0x27b7ba;_0x570472==_0xe72977(0x343)?config[_0xe72977(0x227)](_0x213be9=>{restartBot(_0x213be9['botID']);}):restartBot(_0x570472);}),tgBot[_0x27b7ba(0x317)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x4db853=>{const _0xaaf568=_0x3b3cad;if(!validateTelegram(_0x4db853))return;tgBot[_0xaaf568(0x317)](_0xaaf568(0x1ca));const _0x175225=getDisabledBots();if(_0x175225[_0xaaf568(0x2e0)]==0x0)tgBot[_0xaaf568(0x2dd)](_0x4db853[_0xaaf568(0x214)]['id'],'All\x20bots\x20running\x20right\x20now')[_0xaaf568(0x2a3)](_0x368f2e=>{telegramError(_0x368f2e);});else{if(_0x175225[_0xaaf568(0x2e0)]>0x1)_0x175225[_0xaaf568(0x2f5)]({'botID':_0xaaf568(0x343)});let _0x51f67b=[],_0x2e5c7b=[];const _0x59ff35=_0x175225[_0xaaf568(0x2e0)]%0x4==0x0||_0x175225[_0xaaf568(0x2e0)]%0x4==0x3||_0x175225['length']%0x3==0x1?0x4:0x3;let _0x377ffb=0x0;_0x175225[_0xaaf568(0x227)]((_0x523c5a,_0x5d0c1d)=>{const _0x3a1d7c=_0xaaf568;if(_0x5d0c1d%_0x59ff35==0x0)_0x2e5c7b=[];_0x2e5c7b[_0x3a1d7c(0x2f5)]({'text':_0x523c5a[_0x3a1d7c(0x31e)]=='all'?'All\x20bots':_0x3a1d7c(0x2b2)+_0x523c5a[_0x3a1d7c(0x31e)],'callback_data':_0x523c5a['botID']}),_0x5d0c1d%_0x59ff35==0x0&&(_0x51f67b[_0x377ffb]=_0x2e5c7b,_0x377ffb++);}),tgBot[_0xaaf568(0x2dd)](_0x4db853[_0xaaf568(0x214)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x51f67b}})[_0xaaf568(0x2a3)](_0x5b211a=>{telegramError(_0x5b211a);}),tgBot['on'](_0xaaf568(0x1ca),async _0x5f53bf=>{const _0x27fa56=_0xaaf568,_0x5bc6b3=_0x5f53bf['data'],_0x485715=_0x5f53bf[_0x27fa56(0x30f)];tgBot[_0x27fa56(0x37c)](_0x5f53bf['id'])[_0x27fa56(0x35f)](async()=>{const _0x2ad559=_0x27fa56;_0x5bc6b3=='all'?(tgBot[_0x2ad559(0x2dd)](_0x485715['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x3250dc=>{telegramError(_0x3250dc);}),_0x175225['forEach'](_0x447fc8=>{const _0x2194c1=_0x2ad559;if(_0x447fc8[_0x2194c1(0x31e)]!=_0x2194c1(0x343))toggleBot(_0x447fc8[_0x2194c1(0x31e)],toggleStatus(_0x447fc8['botID']),_0x2194c1(0x1c4));})):(tgBot['sendMessage'](_0x485715['chat']['id'],_0x2ad559(0x20c)+_0x5bc6b3)[_0x2ad559(0x2a3)](_0x9d3fc9=>{telegramError(_0x9d3fc9);}),toggleBot(_0x5bc6b3,toggleStatus(_0x5bc6b3),_0x2ad559(0x1c4)));}),tgBot[_0x27fa56(0x317)](_0x27fa56(0x1ca));});}}),tgBot[_0x3b3cad(0x228)](/\/off/,_0x1272b5=>{const _0x502a91=_0x3b3cad;if(!validateTelegram(_0x1272b5))return;tgBot[_0x502a91(0x317)](_0x502a91(0x1ca));const _0x5bfbc6=getEnabledBots();if(_0x5bfbc6[_0x502a91(0x2e0)]==0x0)tgBot[_0x502a91(0x2dd)](_0x1272b5[_0x502a91(0x214)]['id'],_0x502a91(0x24a))[_0x502a91(0x2a3)](_0x558054=>{telegramError(_0x558054);});else{if(_0x5bfbc6[_0x502a91(0x2e0)]>0x1)_0x5bfbc6[_0x502a91(0x2f5)]({'botID':'all'});let _0x131ebe=[],_0x1dfd55=[];const _0x462aa6=_0x5bfbc6[_0x502a91(0x2e0)]%0x4==0x0||_0x5bfbc6[_0x502a91(0x2e0)]%0x4==0x3||_0x5bfbc6[_0x502a91(0x2e0)]%0x3==0x1?0x4:0x3;let _0xfbfe15=0x0;_0x5bfbc6['forEach']((_0x21de54,_0x3f1448)=>{const _0x54b455=_0x502a91;if(_0x3f1448%_0x462aa6==0x0)_0x1dfd55=[];_0x1dfd55[_0x54b455(0x2f5)]({'text':_0x21de54[_0x54b455(0x31e)]==_0x54b455(0x343)?_0x54b455(0x34a):_0x54b455(0x2b2)+_0x21de54[_0x54b455(0x31e)],'callback_data':_0x21de54[_0x54b455(0x31e)]}),_0x3f1448%_0x462aa6==0x0&&(_0x131ebe[_0xfbfe15]=_0x1dfd55,_0xfbfe15++);}),tgBot[_0x502a91(0x2dd)](_0x1272b5['chat']['id'],_0x502a91(0x216),{'reply_markup':{'inline_keyboard':_0x131ebe}})[_0x502a91(0x2a3)](_0x2809cb=>{telegramError(_0x2809cb);}),tgBot['on'](_0x502a91(0x1ca),async _0x1b826b=>{const _0x54fdac=_0x502a91,_0x3bb89c=_0x1b826b[_0x54fdac(0x360)],_0x2caf81=_0x1b826b[_0x54fdac(0x30f)];tgBot['answerCallbackQuery'](_0x1b826b['id'])[_0x54fdac(0x35f)](async()=>{const _0x51ec20=_0x54fdac;_0x3bb89c==_0x51ec20(0x343)?(tgBot[_0x51ec20(0x2dd)](_0x2caf81[_0x51ec20(0x214)]['id'],_0x51ec20(0x268))[_0x51ec20(0x2a3)](_0x1b8431=>{telegramError(_0x1b8431);}),_0x5bfbc6['forEach'](_0x50aeff=>{const _0x36bbfd=_0x51ec20;if(_0x50aeff[_0x36bbfd(0x31e)]!='all')toggleBot(_0x50aeff[_0x36bbfd(0x31e)],toggleStatus(_0x50aeff[_0x36bbfd(0x31e)]),_0x36bbfd(0x1c4));})):(tgBot[_0x51ec20(0x2dd)](_0x2caf81[_0x51ec20(0x214)]['id'],_0x51ec20(0x233)+_0x3bb89c)['catch'](_0x406777=>{telegramError(_0x406777);}),toggleBot(_0x3bb89c,toggleStatus(_0x3bb89c),_0x51ec20(0x1c4)));}),tgBot[_0x54fdac(0x317)](_0x54fdac(0x1ca));});}}),tgBot['onText'](/\/metrics/,_0x11d828=>{const _0x96a90c=_0x3b3cad;if(!validateTelegram(_0x11d828))return;tgBot[_0x96a90c(0x317)](_0x96a90c(0x1ca));const _0x50f5d9=getEnabledBots();if(_0x50f5d9[_0x96a90c(0x2e0)]==0x0)tgBot['sendMessage'](_0x11d828['chat']['id'],_0x96a90c(0x24a))[_0x96a90c(0x2a3)](_0x4b35c6=>{telegramError(_0x4b35c6);});else{if(_0x50f5d9[_0x96a90c(0x2e0)]>0x1){let _0x116fcb=[],_0x52cf10=[];const _0x5d66a0=_0x50f5d9[_0x96a90c(0x2e0)]%0x4==0x0||_0x50f5d9['length']%0x4==0x3||_0x50f5d9[_0x96a90c(0x2e0)]%0x3==0x1?0x4:0x3;let _0x37c24e=0x0;_0x50f5d9[_0x96a90c(0x227)]((_0x382366,_0x54e949)=>{const _0x1e6f53=_0x96a90c;if(_0x54e949%_0x5d66a0==0x0)_0x52cf10=[];_0x52cf10[_0x1e6f53(0x2f5)]({'text':_0x1e6f53(0x2b2)+_0x382366[_0x1e6f53(0x31e)],'callback_data':_0x382366[_0x1e6f53(0x31e)]}),_0x54e949%_0x5d66a0==0x0&&(_0x116fcb[_0x37c24e]=_0x52cf10,_0x37c24e++);}),tgBot['sendMessage'](_0x11d828[_0x96a90c(0x214)]['id'],_0x96a90c(0x312),{'reply_markup':{'inline_keyboard':_0x116fcb}})['catch'](_0x1ca066=>{telegramError(_0x1ca066);}),tgBot['on'](_0x96a90c(0x1ca),async _0x539c3e=>{const _0x2bb172=_0x96a90c,_0x300464=_0x539c3e[_0x2bb172(0x360)],_0x44a1f1=_0x539c3e['message'];tgBot['answerCallbackQuery'](_0x539c3e['id'])[_0x2bb172(0x35f)](async()=>{const _0x961164=_0x2bb172;if(pid[_0x300464])pid[_0x300464][_0x961164(0x1d8)]({'function':_0x961164(0x2ce),'args':null});}),tgBot['removeListener'](_0x2bb172(0x1ca));});}else{const _0x2d374d=_0x50f5d9[0x0][_0x96a90c(0x31e)];if(pid[_0x2d374d])pid[_0x2d374d][_0x96a90c(0x1d8)]({'function':_0x96a90c(0x2ce),'args':null});}}}),tgBot[_0x3b3cad(0x228)](/\/portfolio/,_0x3a837f=>{const _0x25494a=_0x3b3cad;if(!validateTelegram(_0x3a837f))return;tgBot[_0x25494a(0x317)](_0x25494a(0x1ca));const _0x5049dd=getEnabledBots();if(_0x5049dd[_0x25494a(0x2e0)]==0x0)tgBot[_0x25494a(0x2dd)](_0x3a837f[_0x25494a(0x214)]['id'],_0x25494a(0x24a))[_0x25494a(0x2a3)](_0x379859=>{telegramError(_0x379859);});else{if(_0x5049dd[_0x25494a(0x2e0)]>0x1){let _0x4abbac=[],_0x141e0e=[];const _0x30226d=_0x5049dd[_0x25494a(0x2e0)]%0x4==0x0||_0x5049dd[_0x25494a(0x2e0)]%0x4==0x3||_0x5049dd[_0x25494a(0x2e0)]%0x3==0x1?0x4:0x3;let _0x4643a8=0x0;_0x5049dd[_0x25494a(0x227)]((_0xbc8fe2,_0x4ef79e)=>{const _0x3f8ab8=_0x25494a;if(_0x4ef79e%_0x30226d==0x0)_0x141e0e=[];_0x141e0e[_0x3f8ab8(0x2f5)]({'text':_0x3f8ab8(0x2b2)+_0xbc8fe2[_0x3f8ab8(0x31e)],'callback_data':_0xbc8fe2[_0x3f8ab8(0x31e)]}),_0x4ef79e%_0x30226d==0x0&&(_0x4abbac[_0x4643a8]=_0x141e0e,_0x4643a8++);}),tgBot[_0x25494a(0x2dd)](_0x3a837f[_0x25494a(0x214)]['id'],_0x25494a(0x2ac),{'reply_markup':{'inline_keyboard':_0x4abbac}})[_0x25494a(0x2a3)](_0x51a968=>{telegramError(_0x51a968);}),tgBot['on'](_0x25494a(0x1ca),async _0x30bc2d=>{const _0x5d16b1=_0x25494a,_0x3d0a82=_0x30bc2d['data'],_0x32a96c=_0x30bc2d[_0x5d16b1(0x30f)];tgBot[_0x5d16b1(0x37c)](_0x30bc2d['id'])[_0x5d16b1(0x35f)](async()=>{const _0x5e88bc=_0x5d16b1;if(pid[_0x3d0a82])pid[_0x3d0a82][_0x5e88bc(0x1d8)]({'function':_0x5e88bc(0x29e),'args':null});}),tgBot[_0x5d16b1(0x317)](_0x5d16b1(0x1ca));});}else{const _0x461cd1=_0x5049dd[0x0][_0x25494a(0x31e)];if(pid[_0x461cd1])pid[_0x461cd1][_0x25494a(0x1d8)]({'function':_0x25494a(0x29e),'args':null});}}}),tgBot[_0x3b3cad(0x228)](/\/update/,async _0x21be78=>{const _0x1b10e7=_0x3b3cad;if(!validateTelegram(_0x21be78))return;tgBot['removeListener'](_0x1b10e7(0x1ca)),await getMessages();if(!updateAvailable)tgBot[_0x1b10e7(0x2dd)](_0x21be78[_0x1b10e7(0x214)]['id'],_0x1b10e7(0x363))['catch'](_0x5617ef=>{telegramError(_0x5617ef);});else!validInstallation?tgBot[_0x1b10e7(0x2dd)](_0x21be78[_0x1b10e7(0x214)]['id'],_0x1b10e7(0x20a))['catch'](_0x5bc1a7=>{telegramError(_0x5bc1a7);}):(tgBot[_0x1b10e7(0x2dd)](_0x21be78[_0x1b10e7(0x214)]['id'],_0x1b10e7(0x2ab),{'reply_markup':{'inline_keyboard':[[{'text':_0x1b10e7(0x2d1),'callback_data':_0x1b10e7(0x22b)},{'text':'No','callback_data':'no'}]]}})[_0x1b10e7(0x2a3)](_0x109488=>{telegramError(_0x109488);}),tgBot['on'](_0x1b10e7(0x1ca),async _0x5eb585=>{const _0x9bb18a=_0x1b10e7,_0x3d928e=_0x5eb585[_0x9bb18a(0x360)],_0x582568=_0x5eb585[_0x9bb18a(0x30f)];tgBot[_0x9bb18a(0x37c)](_0x5eb585['id'])[_0x9bb18a(0x35f)](async()=>{const _0xb1d08b=_0x9bb18a;_0x3d928e==_0xb1d08b(0x22b)&&(await tgBot[_0xb1d08b(0x2dd)](_0x582568['chat']['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0x317aaf=>{telegramError(_0x317aaf);}),updateBB('update')),_0x3d928e=='no'&&await tgBot[_0xb1d08b(0x2dd)](_0x582568[_0xb1d08b(0x214)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0xb1d08b(0x2a3)](_0x3867e5=>{telegramError(_0x3867e5);});}),tgBot[_0x9bb18a(0x317)](_0x9bb18a(0x1ca));}));}),tgBot[_0x3b3cad(0x228)](/\/reinstall/,async _0x7f508c=>{const _0x30c7d6=_0x3b3cad;if(!validateTelegram(_0x7f508c))return;tgBot['removeListener'](_0x30c7d6(0x1ca)),!validInstallation?tgBot[_0x30c7d6(0x2dd)](_0x7f508c[_0x30c7d6(0x214)]['id'],_0x30c7d6(0x374))[_0x30c7d6(0x2a3)](_0xde7d38=>{telegramError(_0xde7d38);}):(tgBot[_0x30c7d6(0x2dd)](_0x7f508c[_0x30c7d6(0x214)]['id'],_0x30c7d6(0x2f9),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x30c7d6(0x2a3)](_0x5e9125=>{telegramError(_0x5e9125);}),tgBot['on']('callback_query',async _0x5b53ab=>{const _0x457cff=_0x30c7d6,_0x5d635f=_0x5b53ab[_0x457cff(0x360)],_0x43432f=_0x5b53ab[_0x457cff(0x30f)];tgBot[_0x457cff(0x37c)](_0x5b53ab['id'])[_0x457cff(0x35f)](async()=>{const _0x5d9587=_0x457cff;_0x5d635f=='yes'&&(await tgBot[_0x5d9587(0x2dd)](_0x43432f[_0x5d9587(0x214)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x5d9587(0x2a3)](_0x47ba56=>{telegramError(_0x47ba56);}),updateBB(_0x5d9587(0x2c2))),_0x5d635f=='no'&&await tgBot[_0x5d9587(0x2dd)](_0x43432f[_0x5d9587(0x214)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x5d9587(0x2a3)](_0x37f187=>{telegramError(_0x37f187);});}),tgBot[_0x457cff(0x317)](_0x457cff(0x1ca));}));}),tgBot[_0x3b3cad(0x228)](/\/toggle/,_0x33ee16=>{const _0x23cd15=_0x3b3cad;if(!validateTelegram(_0x33ee16))return;tgBot['removeListener'](_0x23cd15(0x1ca));const _0x7f30ac=getBotsWithMode();if(_0x7f30ac[_0x23cd15(0x2e0)]==0x0)tgBot[_0x23cd15(0x2dd)](_0x33ee16[_0x23cd15(0x214)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x23cd15(0x2a3)](_0xbd7ccb=>{telegramError(_0xbd7ccb);});else{let _0x2f2a96=[],_0xb17f1d=[];const _0x2474f0=0x2;let _0x29ba10=0x0;_0x7f30ac[_0x23cd15(0x227)]((_0x170217,_0x392ee3)=>{const _0x2bf16c=_0x23cd15;if(_0x392ee3%_0x2474f0==0x0)_0xb17f1d=[];_0xb17f1d[_0x2bf16c(0x2f5)]({'text':'Bot\x20'+_0x170217[_0x2bf16c(0x31e)]+'\x20('+_0x170217[_0x2bf16c(0x364)]+')','callback_data':_0x170217[_0x2bf16c(0x31e)]}),_0x392ee3%_0x2474f0==0x0&&(_0x2f2a96[_0x29ba10]=_0xb17f1d,_0x29ba10++);}),tgBot[_0x23cd15(0x2dd)](_0x33ee16['chat']['id'],_0x23cd15(0x336),{'reply_markup':{'inline_keyboard':_0x2f2a96}})[_0x23cd15(0x2a3)](_0x6f0262=>{telegramError(_0x6f0262);}),tgBot['on'](_0x23cd15(0x1ca),async _0x226368=>{const _0x30b739=_0x23cd15,_0x5a15e1=_0x226368['data'],_0xd2db08=_0x226368[_0x30b739(0x30f)];tgBot[_0x30b739(0x37c)](_0x226368['id'])[_0x30b739(0x35f)](async()=>{const _0x473bd3=_0x30b739,_0x3d0890=_0x7f30ac[_0x473bd3(0x1f0)](_0x318e27=>_0x318e27[_0x473bd3(0x31e)]==_0x5a15e1),_0x211260=_0x3d0890[_0x473bd3(0x364)]==_0x473bd3(0x327)?_0x473bd3(0x1ee):_0x473bd3(0x327);tgBot[_0x473bd3(0x2dd)](_0xd2db08['chat']['id'],_0x473bd3(0x30d)+_0x5a15e1+_0x473bd3(0x358)+_0x211260+_0x473bd3(0x220))['catch'](_0x533d58=>{telegramError(_0x533d58);}),toggleBotMode(_0x5a15e1);}),tgBot[_0x30b739(0x317)](_0x30b739(0x1ca));});}}),tgBot[_0x3b3cad(0x228)](/\/names/,_0x5b3293=>{const _0x2eba3f=_0x3b3cad;if(!validateTelegram(_0x5b3293))return;let _0xa34a18='';config[_0x2eba3f(0x227)](_0x68e489=>{const _0x368815=_0x2eba3f;_0xa34a18+='Bot\x20'+_0x68e489[_0x368815(0x31e)]+':\x20'+_0x68e489[_0x368815(0x1e0)]+'\x0a';}),tgBot[_0x2eba3f(0x2dd)](_0x5b3293['chat']['id'],_0xa34a18,{'parse_mode':_0x2eba3f(0x1e6)})[_0x2eba3f(0x2a3)](_0x37f8ec=>{telegramError(_0x37f8ec);});}),tgBot['onText'](/\/disable/,_0x559c48=>{const _0x1e36b5=_0x3b3cad;if(!validateTelegram(_0x559c48))return;tgBot[_0x1e36b5(0x2dd)](_0x559c48[_0x1e36b5(0x214)]['id'],_0x1e36b5(0x361))[_0x1e36b5(0x2a3)](_0x12bf82=>{telegramError(_0x12bf82);}),updateSetting(_0x1e36b5(0x20b),![]);}),tgBot[_0x3b3cad(0x228)](/\/help/,_0x5bf6a8=>{const _0x3a93f5=_0x3b3cad;if(!validateTelegram(_0x5bf6a8))return;tgBot[_0x3a93f5(0x2dd)](_0x5bf6a8[_0x3a93f5(0x214)]['id'],_0x3ae6ca)[_0x3a93f5(0x2a3)](_0x13196a=>{telegramError(_0x13196a);});}),tgBot['on'](_0x3b3cad(0x262),_0x678fb2=>{const _0x53bef4=_0x3b3cad;_0x678fb2[_0x53bef4(0x310)]()[_0x53bef4(0x311)](_0x53bef4(0x293))&&(logger[_0x53bef4(0x370)](_0x53bef4(0x273)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')['emit'](_0x53bef4(0x326),'Invalid\x20Telegram\x20token'));}),process[_0x3b3cad(0x2cb)](_0x3b3cad(0x2a9),()=>{const _0x549632=_0x3b3cad;if(tgBot)tgBot[_0x549632(0x298)]();process[_0x549632(0x291)](0x1);}),process[_0x3b3cad(0x2cb)](_0x3b3cad(0x2ec),()=>{const _0x1ca5af=_0x3b3cad;if(tgBot)tgBot[_0x1ca5af(0x298)]();process['exit'](0x1);});}}function disableTelegram(){const _0xb7cf0f=_0x2fa3a5;tgBot&&(tgBot[_0xb7cf0f(0x298)](),tgBot=null);}function sendTelegram(_0x511ec8,_0x5118ba){const _0x4dd29c=_0x2fa3a5;if(settings[_0x4dd29c(0x20b)]){if(settings[_0x4dd29c(0x276)]=='all'||(_0x5118ba['type']=='error'||_0x5118ba[_0x4dd29c(0x25a)]==_0x4dd29c(0x314)||_0x5118ba[_0x4dd29c(0x25a)]==_0x4dd29c(0x2f8))&&settings[_0x4dd29c(0x276)]=='alerts'||_0x5118ba[_0x4dd29c(0x25a)]==_0x4dd29c(0x1e8)&&settings[_0x4dd29c(0x276)]==_0x4dd29c(0x2bd)){if(tgBot&&settings['telegramChatId']){if(_0x5118ba[_0x4dd29c(0x2d9)])tgBot[_0x4dd29c(0x2dd)](settings[_0x4dd29c(0x2b7)],_0x5118ba[_0x4dd29c(0x1e0)]+_0x4dd29c(0x202)+_0x5118ba[_0x4dd29c(0x209)])['catch'](_0x13dc5a=>{telegramError(_0x13dc5a);});else tgBot[_0x4dd29c(0x2dd)](settings[_0x4dd29c(0x2b7)],_0x4dd29c(0x2b2)+_0x511ec8+_0x4dd29c(0x202)+_0x5118ba[_0x4dd29c(0x209)])[_0x4dd29c(0x2a3)](_0x5a610f=>{telegramError(_0x5a610f);});}}}}async function sendTelegramMsg(_0x2a33e1,_0x3a6def=_0x2fa3a5(0x1e6)){const _0x518a97=_0x2fa3a5;return settings['telegramEnabled']&&tgBot&&settings[_0x518a97(0x2b7)]?(await tgBot['sendMessage'](settings[_0x518a97(0x2b7)],_0x2a33e1,{'parse_mode':_0x3a6def})['catch'](_0x350c68=>{telegramError(_0x350c68);}),!![]):![];}function getDeviceWithIp(_0x55726d){return devices['find'](_0x5d53ca=>_0x5d53ca['ip']===_0x55726d);}function temporaryAccess2FA(_0x4f8a21,_0x1c6f09){const _0x1634bc=_0x2fa3a5;let _0x3a291f=new Date(),_0x48150f=![];if(lastIpApproval){if(_0x3a291f-lastIpApproval<0x1388)_0x48150f=!![];}lastIpApproval=new Date();if(_0x48150f)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x1634bc(0x317)](_0x1634bc(0x1ca)),tgBot['sendMessage'](settings[_0x1634bc(0x2b7)],_0x1634bc(0x1e1)+normalizeIP(_0x1c6f09)[_0x1634bc(0x27b)]+'</b>\x20?',{'parse_mode':_0x1634bc(0x1e6),'reply_markup':{'inline_keyboard':[[{'text':_0x1634bc(0x35c),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x1634bc(0x1f5),'callback_data':'30'},{'text':_0x1634bc(0x353),'callback_data':_0x1634bc(0x353)}]]}})[_0x1634bc(0x2a3)](_0x5d9398=>{telegramError(_0x5d9398);}),tgBot['on'](_0x1634bc(0x1ca),async _0x2d1f92=>{const _0x5bd3e5=_0x1634bc,_0x45218f=_0x2d1f92[_0x5bd3e5(0x360)],_0x389685=_0x2d1f92[_0x5bd3e5(0x30f)];tgBot[_0x5bd3e5(0x37c)](_0x2d1f92['id'])['then'](async()=>{const _0x1ac800=_0x5bd3e5;devices[_0x4f8a21][_0x1ac800(0x31b)]={'clientip':_0x1c6f09,'timestamp':new Date()[_0x1ac800(0x2b9)](),'expiry':_0x45218f},_0x45218f!=_0x1ac800(0x353)?(await tgBot[_0x1ac800(0x2dd)](_0x389685[_0x1ac800(0x214)]['id'],'Access\x20enabled\x20for\x20'+_0x45218f+'\x20minutes',{'parse_mode':_0x1ac800(0x1e6)})[_0x1ac800(0x2a3)](_0x23c56=>{telegramError(_0x23c56);}),io['to'](_0x4f8a21)[_0x1ac800(0x257)](_0x1ac800(0x2fd),{'access':{'allow':![],'reason':_0x1ac800(0x2f0),'token':null}})):(await tgBot[_0x1ac800(0x2dd)](_0x389685[_0x1ac800(0x214)]['id'],_0x1ac800(0x24f))[_0x1ac800(0x2a3)](_0x4368c8=>{telegramError(_0x4368c8);}),io['to'](_0x4f8a21)[_0x1ac800(0x257)](_0x1ac800(0x2fd),{'access':{'allow':![],'reason':_0x1ac800(0x2fe),'token':null}}));}),tgBot[_0x5bd3e5(0x317)](_0x5bd3e5(0x1ca));}));}function loginAccess2FA(_0x4fcc4b,_0x3408d4){const _0x1891e6=_0x2fa3a5;tgBot&&settings[_0x1891e6(0x2b7)]&&(tgBot[_0x1891e6(0x317)](_0x1891e6(0x1ca)),tgBot[_0x1891e6(0x2dd)](settings['telegramChatId'],_0x1891e6(0x34f)+normalizeIP(_0x3408d4)['show']+_0x1891e6(0x256),{'parse_mode':_0x1891e6(0x1e6),'reply_markup':{'inline_keyboard':[[{'text':_0x1891e6(0x2f2),'callback_data':loginExpiry},{'text':_0x1891e6(0x353),'callback_data':_0x1891e6(0x353)}]]}})[_0x1891e6(0x2a3)](_0x3e71bd=>{telegramError(_0x3e71bd);}),tgBot['on'](_0x1891e6(0x1ca),async _0x23c075=>{const _0x17d2cd=_0x1891e6,_0x5783a7=_0x23c075[_0x17d2cd(0x360)],_0x48f443=_0x23c075[_0x17d2cd(0x30f)];tgBot[_0x17d2cd(0x37c)](_0x23c075['id'])[_0x17d2cd(0x35f)](async()=>{const _0x871054=_0x17d2cd;devices[_0x4fcc4b][_0x871054(0x2f4)]={'clientip':_0x3408d4,'timestamp':new Date()['getTime'](),'expiry':_0x5783a7},_0x5783a7!=_0x871054(0x353)?(await tgBot[_0x871054(0x2dd)](_0x48f443[_0x871054(0x214)]['id'],_0x871054(0x249),{'parse_mode':_0x871054(0x1e6)})['catch'](_0x13806c=>{telegramError(_0x13806c);}),io['to'](_0x4fcc4b)['emit']('status',{'access':{'allow':![],'reason':_0x871054(0x2f0),'token':null}})):(await tgBot['sendMessage'](_0x48f443[_0x871054(0x214)]['id'],_0x871054(0x1c8))['catch'](_0x279678=>{telegramError(_0x279678);}),io['to'](_0x4fcc4b)[_0x871054(0x257)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x17d2cd(0x317)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1fd17f=_0x2fa3a5;return dbConfig[_0x1fd17f(0x225)](_0x1fd17f(0x24e))[_0x1fd17f(0x377)](_0x1fd17f(0x31e))[_0x1fd17f(0x380)]({'status':'enabled'})[_0x1fd17f(0x350)]()||[];}function getDisabledBots(){const _0x1105dd=_0x2fa3a5;return dbConfig[_0x1105dd(0x225)](_0x1105dd(0x24e))[_0x1105dd(0x377)](_0x1105dd(0x31e))[_0x1105dd(0x380)]({'status':_0x1105dd(0x376)})['value']()||[];}function getBotAttributes(_0x43c4c7){const _0x206ba8=_0x2fa3a5;let _0x43edc9={};const _0x5ddc54=configpath+_0x206ba8(0x1f3)+_0x43c4c7+_0x206ba8(0x274),_0x2978c7=fs[_0x206ba8(0x210)](_0x5ddc54);if(_0x2978c7){const _0x49f081=fs[_0x206ba8(0x258)](_0x5ddc54);try{const _0x11e19c=JSON[_0x206ba8(0x204)](_0x49f081),_0x3f54a9=_0x11e19c?_0x11e19c['bot'][0x0][_0x206ba8(0x24b)]:![];_0x43edc9['mode']=_0x3f54a9?_0x206ba8(0x327):_0x206ba8(0x1ee),_0x43edc9[_0x206ba8(0x1e0)]=_0x11e19c?_0x11e19c['bot'][0x0][_0x206ba8(0x1e0)]:'Bot\x20'+_0x43c4c7;}catch(_0xd3318c){_0x43edc9[_0x206ba8(0x364)]=_0x206ba8(0x1ee),_0x43edc9[_0x206ba8(0x1e0)]=_0x206ba8(0x2b2)+_0x43c4c7;}}else _0x43edc9['mode']=_0x206ba8(0x1ee),_0x43edc9[_0x206ba8(0x1e0)]=_0x206ba8(0x2b2)+_0x43c4c7;return _0x43edc9;}function getBotsWithMode(){const _0x2eb901=_0x2fa3a5,_0x1d1412=dbConfig[_0x2eb901(0x225)](_0x2eb901(0x24e))[_0x2eb901(0x377)]('botID')[_0x2eb901(0x350)]()||[];return _0x1d1412[_0x2eb901(0x227)](_0x2ce20c=>{const _0x1bd61f=_0x2eb901;let _0x5a552b=getBotAttributes(_0x2ce20c['botID']);_0x2ce20c[_0x1bd61f(0x364)]=_0x5a552b[_0x1bd61f(0x364)];}),_0x1d1412;}function getBotExchanges(){const _0x45bea7=_0x2fa3a5;let _0x44a7ae=[];const _0x535bd0=dbConfig[_0x45bea7(0x225)](_0x45bea7(0x24e))[_0x45bea7(0x377)](_0x45bea7(0x31e))['value']()||[];_0x535bd0['forEach'](_0x38449e=>{const _0x5df7f9=_0x45bea7;if(_0x38449e['status']==_0x5df7f9(0x1e4)){const _0x24147e=configpath+_0x5df7f9(0x1f3)+_0x38449e[_0x5df7f9(0x31e)]+_0x5df7f9(0x274),_0x1785cb=fs[_0x5df7f9(0x210)](_0x24147e);let _0x1790e5;if(_0x1785cb){const _0xcb35f8=fs['readFileSync'](_0x24147e);try{const _0x4adc8e=JSON[_0x5df7f9(0x204)](_0xcb35f8);_0x1790e5=_0x4adc8e?_0x4adc8e['bot'][0x0]['exchange']:null;}catch(_0x4a7fb4){}}if(_0x1790e5)_0x44a7ae[_0x5df7f9(0x2f5)](_0x1790e5);}});const _0x350f0e=[...new Set(_0x44a7ae)][_0x45bea7(0x2de)]();return _0x350f0e;}async function initUser(){const _0x47932a=_0x2fa3a5;if(!settings[_0x47932a(0x2ff)]){const _0x585a7e=uuidRandom();mixpanel['alias'](_0x585a7e),updateSetting(_0x47932a(0x2ff),_0x585a7e);}}async function initSecure(){const _0x69d0ef=_0x2fa3a5;let _0x73d09e=getSecure();if(!_0x73d09e[_0x69d0ef(0x21d)](_0x69d0ef(0x23e))){let _0x57e0fc=await generateKeys();_0x73d09e[_0x69d0ef(0x252)]=_0x57e0fc[_0x69d0ef(0x252)],_0x73d09e[_0x69d0ef(0x2a2)]=_0x57e0fc['privateKey'],_0x73d09e[_0x69d0ef(0x23e)]=crypto[_0x69d0ef(0x23c)](0x20)[_0x69d0ef(0x310)](_0x69d0ef(0x33a));;storeSecure(_0x73d09e);}}function getSettings(){const _0x2f28c2=_0x2fa3a5;return dbSettings['get'](_0x2f28c2(0x230))[_0x2f28c2(0x350)]()||{};}function getSecure(){const _0x51f9b3=_0x2fa3a5;return dbSecure[_0x51f9b3(0x225)](_0x51f9b3(0x244))[_0x51f9b3(0x350)]()||{};}function getBlacklist(){const _0x2635d0=_0x2fa3a5;return dbSecure[_0x2635d0(0x225)](_0x2635d0(0x2a7))[_0x2635d0(0x350)]()||[];}function broadcastToBots(_0x42dbe3,_0x25129b){const _0x51d2bf=_0x2fa3a5;config[_0x51d2bf(0x227)](_0x522dd0=>{const _0x1a3707=_0x51d2bf;if(_0x522dd0[_0x1a3707(0x2fd)]==_0x1a3707(0x1e4)&&_0x522dd0[_0x1a3707(0x30b)]==_0x1a3707(0x2eb)||_0x522dd0['status']==_0x1a3707(0x346)&&_0x522dd0[_0x1a3707(0x30b)]==_0x1a3707(0x2eb)){if(pid[_0x522dd0['botID']])pid[_0x522dd0[_0x1a3707(0x31e)]]['send']({[_0x42dbe3]:_0x25129b});}});}function storeSettings(_0x540180,_0x1c3d7e=![]){const _0x4133fd=_0x2fa3a5;_0x540180={...settings,..._0x540180};if(_0x1c3d7e&&_0x540180[_0x4133fd(0x20e)]!=_0x4133fd(0x1c0)&&_0x540180[_0x4133fd(0x20e)]!=_0x4133fd(0x369)&&_0x540180['bbPassword']!=''){const _0x454e50=crypt[_0x4133fd(0x21f)](secure[_0x4133fd(0x2a2)],_0x540180[_0x4133fd(0x20e)])[_0x4133fd(0x30f)][_0x4133fd(0x2d4)]('@')[0x0],_0x5a6a8c=bcrypt[_0x4133fd(0x1f2)](_0x454e50,saltRounds);_0x540180={..._0x540180,'bbPassword':_0x5a6a8c};}if(_0x1c3d7e&&_0x540180[_0x4133fd(0x29d)]!='************'&&_0x540180[_0x4133fd(0x29d)]!=_0x4133fd(0x369)&&_0x540180[_0x4133fd(0x29d)]!=''){const _0xe2d966=crypt['decrypt'](secure['privateKey'],_0x540180[_0x4133fd(0x29d)])['message'][_0x4133fd(0x2d4)]('@')[0x0];_0x540180={..._0x540180,'telegramToken':_0xe2d966};}const _0x268c91=_0x540180['telegramToken']!=_0x4133fd(0x1c0)&&_0x540180[_0x4133fd(0x29d)]!=settings[_0x4133fd(0x29d)]||_0x540180[_0x4133fd(0x235)]!=settings['telegramUsername'],_0x1b714c=_0x540180[_0x4133fd(0x29d)]==''||_0x540180['telegramUsername']=='';if(_0x268c91)_0x540180[_0x4133fd(0x276)]='all';for(const [_0x1b1611,_0x5225de]of Object[_0x4133fd(0x1e7)](_0x540180)){if(_0x1b1611==_0x4133fd(0x29d)&&_0x5225de==_0x4133fd(0x1c0)){_0x540180[_0x4133fd(0x29d)]=settings['telegramToken'];continue;};if(_0x1b1611==_0x4133fd(0x20e)&&_0x5225de==_0x4133fd(0x1c0)){_0x540180[_0x4133fd(0x20e)]=settings[_0x4133fd(0x20e)];continue;};dbSettings[_0x4133fd(0x32c)]('settings.'+_0x1b1611,_0x5225de)[_0x4133fd(0x379)]();}settings=_0x540180,io['to'](_0x4133fd(0x23a))[_0x4133fd(0x257)]('settings',cleanSettings()),broadcastToBots(_0x4133fd(0x1c2),settings['timeshift']),broadcastToBots('onepagemode',settings[_0x4133fd(0x221)]);if(_0x268c91&&!_0x1b714c)initTelegram();if(_0x268c91&&_0x1b714c)disableTelegram();getAllClients()[_0x4133fd(0x227)](_0x5ad111=>{const _0x15e950=_0x4133fd;getSocket(_0x5ad111['id'])['emit'](_0x15e950(0x2fd),{'access':{'allow':![],'reason':_0x15e950(0x2f0),'token':null}});});}function _0x4f83(_0x393189,_0x90f695){const _0x42e6a5=_0xbe57();return _0x4f83=function(_0x2970ea,_0x55a041){_0x2970ea=_0x2970ea-0x1be;let _0xbe57ca=_0x42e6a5[_0x2970ea];return _0xbe57ca;},_0x4f83(_0x393189,_0x90f695);}function updateSetting(_0x519c9e,_0x5e27ad){const _0x1314c7=_0x2fa3a5;dbSettings[_0x1314c7(0x32c)]('settings.'+_0x519c9e,_0x5e27ad)[_0x1314c7(0x379)](),settings=getSettings(),io['to']('botmanager')[_0x1314c7(0x257)]('settings',cleanSettings());}function storeSecure(_0x400004){const _0x479b33=_0x2fa3a5;dbSecure['get'](_0x479b33(0x244))[_0x479b33(0x2f5)](_0x400004)[_0x479b33(0x379)](),secure=_0x400004;}function addBlacklist(_0x2b7863){const _0x422a63=_0x2fa3a5;cleanBlacklist();let _0x1cfd2c;devices[_0x2b7863][_0x422a63(0x31b)]?_0x1cfd2c=Math[_0x422a63(0x372)](devices[_0x2b7863][_0x422a63(0x31b)][_0x422a63(0x1c3)],loginExpiry):_0x1cfd2c=loginExpiry,dbSecure[_0x422a63(0x225)]('blacklist')[_0x422a63(0x2f5)]({'expiry':new Date()[_0x422a63(0x2b9)]()+_0x1cfd2c*0x3c*0x3e8,'token':devices[_0x2b7863]['access'][_0x422a63(0x2d2)]})['write'](),blacklist=dbSecure[_0x422a63(0x225)](_0x422a63(0x2a7))['value']();}function cleanBlacklist(){const _0x174cf1=_0x2fa3a5;let _0x41b03e=dbSecure['get'](_0x174cf1(0x2a7))['cloneDeep']()[_0x174cf1(0x350)](),_0x2f9f2b=new Date()['getTime']();_0x41b03e[_0x174cf1(0x227)](_0x3b9b13=>{const _0x42011f=_0x174cf1;_0x3b9b13[_0x42011f(0x1c3)]<_0x2f9f2b&&dbSecure[_0x42011f(0x225)](_0x42011f(0x2a7))['remove']({'expiry':_0x3b9b13[_0x42011f(0x1c3)]})['write']();});}function initStates(){const _0x3243e0=_0x2fa3a5;let _0x9ff16f=getConfiguration();_0x9ff16f[_0x3243e0(0x227)](_0x42b14c=>{const _0x28f3ee=_0x3243e0;_0x42b14c[_0x28f3ee(0x30b)]=_0x28f3ee(0x1c4);}),storeConfiguration(_0x9ff16f);}function onKeys(){const _0x15b178=new RSA();return new Promise(_0x4e5cb=>{const _0x12ffcd=_0x4f83;_0x15b178[_0x12ffcd(0x2cf)]()[_0x12ffcd(0x35f)](_0x5c0a94=>{_0x4e5cb(_0x5c0a94);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5aed86=_0x2fa3a5;let _0x2cafe5=getSettings(),_0x4825c1=![];!_0x2cafe5[_0x5aed86(0x21d)]('lastmsgtelegram')&&(_0x2cafe5[_0x5aed86(0x301)]=0x0,_0x4825c1=!![]);!_0x2cafe5[_0x5aed86(0x21d)](_0x5aed86(0x246))&&(_0x2cafe5[_0x5aed86(0x246)]=0x0,_0x4825c1=!![]);!_0x2cafe5[_0x5aed86(0x21d)](_0x5aed86(0x1c5))&&(_0x2cafe5[_0x5aed86(0x1c5)]='0.0.0',_0x4825c1=!![]);!_0x2cafe5['hasOwnProperty'](_0x5aed86(0x221))&&(_0x2cafe5['onepagemode']=![],_0x4825c1=!![]);if(_0x4825c1)storeSettings(_0x2cafe5);}function storeConfiguration(_0x560910){const _0x40194b=_0x2fa3a5;dbConfig['get'](_0x40194b(0x24e))[_0x40194b(0x2c5)]()['write'](),_0x560910[_0x40194b(0x227)](_0x589e41=>{const _0x1bfc4c=_0x40194b;delete _0x589e41[_0x1bfc4c(0x364)];}),dbConfig['get'](_0x40194b(0x24e))['push'](..._0x560910)['write'](),config=_0x560910;}function resetPassword(){const _0x9e3552=_0x2fa3a5;tgBot&&settings['telegramChatId']&&(tgBot[_0x9e3552(0x317)](_0x9e3552(0x1ca)),tgBot[_0x9e3552(0x2dd)](settings['telegramChatId'],_0x9e3552(0x1df),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x9e3552(0x22b),'callback_data':_0x9e3552(0x22b)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2baf64=>{telegramError(_0x2baf64);}),tgBot['on']('callback_query',async _0x415d1f=>{const _0x19abb=_0x9e3552,_0x35f10d=_0x415d1f[_0x19abb(0x360)],_0xc94bb3=_0x415d1f['message'];tgBot[_0x19abb(0x37c)](_0x415d1f['id'])[_0x19abb(0x35f)](async()=>{const _0x1f0f1b=_0x19abb;if(_0x35f10d!='no'){const _0x16ac0a=0xf,_0x292ab2=_0x1f0f1b(0x32a),_0x1bed94=Array[_0x1f0f1b(0x32d)](crypto[_0x1f0f1b(0x1d9)](new Uint32Array(_0x16ac0a)))[_0x1f0f1b(0x269)](_0x15539f=>_0x292ab2[_0x15539f%_0x292ab2[_0x1f0f1b(0x2e0)]])[_0x1f0f1b(0x1ea)](''),_0x3e296b=bcrypt['hashSync'](_0x1bed94,saltRounds);storeSettings({'bbPassword':_0x3e296b}),await tgBot[_0x1f0f1b(0x2dd)](_0xc94bb3[_0x1f0f1b(0x214)]['id'],_0x1f0f1b(0x2c9)+_0x1bed94,{'parse_mode':_0x1f0f1b(0x1e6)})[_0x1f0f1b(0x2a3)](_0x443469=>{telegramError(_0x443469);});}else await tgBot[_0x1f0f1b(0x2dd)](_0xc94bb3['chat']['id'],_0x1f0f1b(0x26f))[_0x1f0f1b(0x2a3)](_0x4a4601=>{telegramError(_0x4a4601);});}),tgBot[_0x19abb(0x317)](_0x19abb(0x1ca));}));}async function confirmRestore(_0x257c4f,_0x33c58a){const _0x26f666=_0x2fa3a5;io['to'](_0x26f666(0x23a))[_0x26f666(0x257)]('notification',_0x26f666(0x1eb),_0x26f666(0x2f8)),tgBot&&settings['telegramChatId']&&(tgBot[_0x26f666(0x317)]('callback_query'),await tgBot[_0x26f666(0x2dd)](settings[_0x26f666(0x2b7)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x26f666(0x1e6),'reply_markup':{'inline_keyboard':[[{'text':_0x26f666(0x22b),'callback_data':_0x26f666(0x22b)},{'text':'no','callback_data':'no'}]]}})[_0x26f666(0x2a3)](_0x3c21c4=>{telegramError(_0x3c21c4);}),tgBot['on'](_0x26f666(0x1ca),async _0x480560=>{const _0x4a5c27=_0x26f666,_0x3f0d4c=_0x480560[_0x4a5c27(0x360)],_0x3ba82e=_0x480560[_0x4a5c27(0x30f)];tgBot[_0x4a5c27(0x37c)](_0x480560['id'])[_0x4a5c27(0x35f)](async()=>{const _0x2c4320=_0x4a5c27;_0x3f0d4c==_0x2c4320(0x22b)?(await tgBot[_0x2c4320(0x2dd)](_0x3ba82e[_0x2c4320(0x214)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'})[_0x2c4320(0x2a3)](_0x40c7bf=>{telegramError(_0x40c7bf);}),unzipFile(_0x257c4f,_0x33c58a)):(logger[_0x2c4320(0x28a)](_0x2c4320(0x2f1)),await tgBot[_0x2c4320(0x2dd)](_0x3ba82e[_0x2c4320(0x214)]['id'],_0x2c4320(0x2f1))[_0x2c4320(0x2a3)](_0x16d38e=>{telegramError(_0x16d38e);}));}),tgBot[_0x4a5c27(0x317)](_0x4a5c27(0x1ca));}));}function getServerTime(){const _0x3d2ed7=_0x2fa3a5,_0x4bdaa7=new Date();return _0x4bdaa7['getFullYear']()+'/'+(_0x4bdaa7[_0x3d2ed7(0x250)]()+0x1)['toString']()[_0x3d2ed7(0x2e9)](0x2,'0')+'/'+_0x4bdaa7[_0x3d2ed7(0x371)]()[_0x3d2ed7(0x310)]()['padStart'](0x2,'0')+'\x20'+_0x4bdaa7[_0x3d2ed7(0x2e3)]()[_0x3d2ed7(0x310)]()[_0x3d2ed7(0x2e9)](0x2,'0')+':'+_0x4bdaa7[_0x3d2ed7(0x229)]()['toString']()[_0x3d2ed7(0x2e9)](0x2,'0')+':'+_0x4bdaa7[_0x3d2ed7(0x29b)]()[_0x3d2ed7(0x310)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1f8361=_0x2fa3a5,_0x295798=shiftedTime();return _0x295798[_0x1f8361(0x1d6)]()+'/'+(_0x295798['getMonth']()+0x1)[_0x1f8361(0x310)]()['padStart'](0x2,'0')+'/'+_0x295798[_0x1f8361(0x371)]()[_0x1f8361(0x310)]()['padStart'](0x2,'0')+'\x20'+_0x295798[_0x1f8361(0x2e3)]()[_0x1f8361(0x310)]()[_0x1f8361(0x2e9)](0x2,'0')+':'+_0x295798['getMinutes']()[_0x1f8361(0x310)]()[_0x1f8361(0x2e9)](0x2,'0')+':'+_0x295798[_0x1f8361(0x29b)]()[_0x1f8361(0x310)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x3e7e8d=_0x2fa3a5,_0x4bd565=shiftedTime();return _0x4bd565['getFullYear']()+(_0x4bd565[_0x3e7e8d(0x250)]()+0x1)[_0x3e7e8d(0x310)]()[_0x3e7e8d(0x2e9)](0x2,'0')+_0x4bd565[_0x3e7e8d(0x371)]()['toString']()[_0x3e7e8d(0x2e9)](0x2,'0')+'-'+_0x4bd565[_0x3e7e8d(0x2e3)]()[_0x3e7e8d(0x310)]()['padStart'](0x2,'0')+_0x4bd565['getMinutes']()[_0x3e7e8d(0x310)]()[_0x3e7e8d(0x2e9)](0x2,'0')+_0x4bd565['getSeconds']()[_0x3e7e8d(0x310)]()[_0x3e7e8d(0x2e9)](0x2,'0');}function shiftedTime(){const _0x1ce610=_0x2fa3a5,_0x224b56=new Date();let _0x5ac21c=_0x224b56;if(settings[_0x1ce610(0x1c2)]&&settings[_0x1ce610(0x1c2)]!==0x0)_0x5ac21c=fns['add'](_0x224b56,{'hours':settings['timeshift']});return _0x5ac21c;}function startScheduler(){const _0x582013=_0x2fa3a5,_0x54fe0c=new Date()[_0x582013(0x332)](),_0x4d432a=shiftedTime()['getHours']();_0x4d432a==0x4&&backupConfigFiles();_0x4d432a==0x0&&rotateLogFiles();_0x54fe0c%0x6==0x0&&triggerAnalytics();_0x54fe0c%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1e5996){const _0x70ae2d=_0x2fa3a5;logger['debug'](_0x70ae2d(0x32e)+_0x1e5996);const _0xd2d953=getBotsWithMode();_0xd2d953[_0x70ae2d(0x2e0)]>0x0?confirmRestore(configbackuppath,_0x1e5996):unzipFile(configbackuppath,_0x1e5996);}async function getBackupFiles(_0xd03731=null){const _0x428d9a=_0x2fa3a5;let _0x5694c5=[],_0x282759=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x282759[_0x428d9a(0x2de)]((_0x4878db,_0x520897)=>_0x4878db[_0x428d9a(0x278)]<_0x520897[_0x428d9a(0x278)]?0x1:_0x520897[_0x428d9a(0x278)]<_0x4878db['name']?-0x1:0x0),_0x282759[_0x428d9a(0x227)](_0x43c5a4=>{const _0xcaf093=_0x428d9a;if(!_0x43c5a4[_0xcaf093(0x289)]()&&_0x43c5a4[_0xcaf093(0x278)][_0xcaf093(0x330)](_0xcaf093(0x2e5))&&_0x43c5a4['name'][_0xcaf093(0x34d)]('.zip')){const _0x593b2a=formatDate(fs['statSync'](configbackuppath+_0x43c5a4[_0xcaf093(0x278)])[_0xcaf093(0x304)]);_0x5694c5[_0xcaf093(0x2f5)]({'name':_0x43c5a4[_0xcaf093(0x278)],'mtime':_0x593b2a});}});if(_0xd03731)io['to'](_0xd03731)[_0x428d9a(0x257)](_0x428d9a(0x2a4),_0x5694c5);else return _0x5694c5;}async function backupConfigFiles(){const _0x41f185=_0x2fa3a5;await zipFiles(_0x41f185(0x2ee));const _0x25a9ee=getCleanTimeStamp();fs[_0x41f185(0x1ff)](zippath+_0x41f185(0x28c),configbackuppath+('backup-full@'+_0x25a9ee+'.zip'));let _0x2c6df3=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2c6df3[_0x41f185(0x2de)]((_0x3e8040,_0x1aa7a5)=>_0x3e8040[_0x41f185(0x278)]<_0x1aa7a5[_0x41f185(0x278)]?0x1:_0x1aa7a5[_0x41f185(0x278)]<_0x3e8040[_0x41f185(0x278)]?-0x1:0x0),_0x2c6df3['length']>maxBackups&&fs[_0x41f185(0x2d8)](configbackuppath+_0x2c6df3[maxBackups][_0x41f185(0x278)]);}function rotateLogFiles(){const _0x38da9f=_0x2fa3a5,_0x5043b0=fs[_0x38da9f(0x27a)](logspath+'output-000.log'),_0x56db98=_0x5043b0[_0x38da9f(0x335)]/0x400;if(_0x56db98>0x64){let _0x4344a4=fs[_0x38da9f(0x234)](logspath,{'withFileTypes':!![]});_0x4344a4['sort']((_0x3b18f3,_0x407692)=>_0x3b18f3[_0x38da9f(0x278)]<_0x407692['name']?0x1:_0x407692[_0x38da9f(0x278)]<_0x3b18f3[_0x38da9f(0x278)]?-0x1:0x0),_0x4344a4['forEach'](_0x58cc9b=>{const _0x49a2b6=_0x38da9f;if(_0x58cc9b[_0x49a2b6(0x278)]==_0x49a2b6(0x21c))fs[_0x49a2b6(0x1ff)](logspath+_0x58cc9b[_0x49a2b6(0x278)],logspath+_0x49a2b6(0x272));if(_0x58cc9b[_0x49a2b6(0x278)]==_0x49a2b6(0x265))fs[_0x49a2b6(0x1ff)](logspath+_0x58cc9b[_0x49a2b6(0x278)],logspath+_0x49a2b6(0x21c));_0x58cc9b[_0x49a2b6(0x278)]=='output-000.log'&&(fs[_0x49a2b6(0x1ff)](logspath+_0x58cc9b[_0x49a2b6(0x278)],logspath+_0x49a2b6(0x265)),fs[_0x49a2b6(0x1ce)](logspath+_0x58cc9b[_0x49a2b6(0x278)],''));});}}async function zipFiles(_0xf799b3){const _0x334d92=_0x2fa3a5;let _0x5be260;if(_0xf799b3==_0x334d92(0x2c3))_0x5be260=logspath;if(_0xf799b3==_0x334d92(0x319))_0x5be260=configpath;if(_0xf799b3=='backup-full')_0x5be260=configpath;let _0x442b0d=fs[_0x334d92(0x234)](_0x5be260,{'withFileTypes':!![]});const _0x46ced0=new require('node-zip')();_0x442b0d['forEach'](_0x1895a6=>{const _0x443ce6=_0x334d92;if(!_0x1895a6['isDirectory']()){let _0x27d1ca=fs[_0x443ce6(0x258)](_0x5be260+_0x1895a6[_0x443ce6(0x278)]);if(_0xf799b3==_0x443ce6(0x319)){const _0x17518c=/^bot-[0-9]{3}-config.json$/,_0x56489e=_0x17518c['test'](_0x1895a6[_0x443ce6(0x278)]);if(_0x56489e){const _0x2c1e5c=JSON['parse'](_0x27d1ca);_0x2c1e5c['bot'][0x0]&&(_0x2c1e5c[_0x443ce6(0x33d)][0x0][_0x443ce6(0x359)]=_0x443ce6(0x369),_0x2c1e5c['bot'][0x0][_0x443ce6(0x2cd)]=_0x443ce6(0x369)),_0x27d1ca=JSON[_0x443ce6(0x25f)](_0x2c1e5c,null,0x2);}if(_0x1895a6['name']==_0x443ce6(0x32f)){const _0x392f07=JSON[_0x443ce6(0x204)](_0x27d1ca);if(_0x392f07[_0x443ce6(0x230)]['loginRequired'])_0x392f07[_0x443ce6(0x230)]['loginRequired']=![];if(_0x392f07[_0x443ce6(0x230)]['bbPassword'])_0x392f07['settings'][_0x443ce6(0x20e)]='***';if(_0x392f07[_0x443ce6(0x230)][_0x443ce6(0x29d)])_0x392f07[_0x443ce6(0x230)]['telegramToken']=_0x443ce6(0x369);if(_0x392f07[_0x443ce6(0x230)][_0x443ce6(0x2b7)])_0x392f07[_0x443ce6(0x230)][_0x443ce6(0x2b7)]=null;_0x27d1ca=JSON[_0x443ce6(0x25f)](_0x392f07,null,0x2);}if(_0x1895a6[_0x443ce6(0x278)]!='bb-secure.json')_0x46ced0[_0x443ce6(0x290)](_0x1895a6[_0x443ce6(0x278)],_0x27d1ca);}else _0x46ced0['file'](_0x1895a6[_0x443ce6(0x278)],_0x27d1ca);}});const _0x45d0f3=_0x46ced0[_0x334d92(0x248)]({'base64':![],'compression':_0x334d92(0x212)});fs['writeFileSync'](zippath+(_0xf799b3+_0x334d92(0x30a)),_0x45d0f3,'binary');}async function unzipFile(_0x335c88,_0x1627b6){const _0x4e2cbb=_0x2fa3a5;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x1e8821=>{const _0x22341e=_0x4f83;if(!_0x1e8821[_0x22341e(0x289)]())fs[_0x22341e(0x2d5)](configpath+_0x1e8821[_0x22341e(0x278)]);});const _0x13eac2=fs[_0x4e2cbb(0x258)](_0x335c88+_0x1627b6,'binary'),_0x3c9473=new require('node-zip')(_0x13eac2,{'base64':![],'checkCRC32':!![]});Object[_0x4e2cbb(0x288)](_0x3c9473[_0x4e2cbb(0x28d)])['forEach'](_0x14bfb7=>{const _0x2d3fb1=_0x4e2cbb,_0x56572f=_0x3c9473[_0x2d3fb1(0x28d)][_0x14bfb7];fs[_0x2d3fb1(0x1ce)](configpath+_0x56572f[_0x2d3fb1(0x278)],_0x56572f['_data']);}),fs[_0x4e2cbb(0x234)](temppath,{'withFileTypes':!![]})['forEach'](_0x5a8831=>{const _0x46cedb=_0x4e2cbb;if(!_0x5a8831['isDirectory']())fs[_0x46cedb(0x2d5)](temppath+_0x5a8831[_0x46cedb(0x278)]);}),logger[_0x4e2cbb(0x28a)](_0x4e2cbb(0x251)),process[_0x4e2cbb(0x1d8)]({'restore':!![]},_0x32f39c=>{});}async function getPublicIp(){const _0x18679b=_0x2fa3a5;try{const _0x417835=await axios[_0x18679b(0x225)](_0x18679b(0x282));publicip=_0x417835[_0x18679b(0x360)]['ip'];}catch(_0x476a26){}}async function triggerAnalytics(){const _0x43aa36=_0x2fa3a5;if(!publicip)await getPublicIp();const _0x4d3c23=getBotsWithMode();let _0x133e6a=0x0;_0x4d3c23[_0x43aa36(0x227)](_0x1104b2=>{const _0x42d908=_0x43aa36;if(_0x1104b2[_0x42d908(0x2fd)]==='enabled')_0x133e6a++;});const _0x3cb356=getBotExchanges();mixpanel[_0x43aa36(0x275)](_0x43aa36(0x218),{'distinct_id':settings[_0x43aa36(0x2ff)],'ip':publicip,'version':serverversion,'numbots':_0x4d3c23[_0x43aa36(0x2e0)],'numbotsenabled':_0x133e6a,'exchanges':_0x3cb356});}async function getMessages(){const _0x51b870=_0x2fa3a5,_0x47d073=_0x51b870(0x242),_0x4aa17f=new GraphQLClient(_0x47d073),_0x749472={'authorization':_0x51b870(0x331)},_0x1e408a=serverversion[_0x51b870(0x2d4)]('.'),_0x318fa3=_0x1e408a[0x0]+'.'+_0x1e408a[0x1],_0xc2ff57=Math[_0x51b870(0x237)](settings[_0x51b870(0x301)],settings[_0x51b870(0x246)]),_0x52e100={'last':parseInt(_0xc2ff57),'bbm':_0x318fa3},_0x1db16a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5e59ff;try{_0x5e59ff=await _0x4aa17f['request'](_0x1db16a,_0x52e100,_0x749472);}catch(_0x2ab2ba){}if(_0x5e59ff&&_0x5e59ff[_0x51b870(0x308)]){let _0x57edbb=settings[_0x51b870(0x301)];newMessages=[];for(const _0xa169de of _0x5e59ff[_0x51b870(0x308)]){newMessages[_0x51b870(0x2f5)](_0xa169de);if(_0xa169de['bbvNew'])updateSetting(_0x51b870(0x1c5),_0xa169de[_0x51b870(0x23b)]);let _0x4098eb=_0xa169de['bbvNew']?serverversion>=_0xa169de[_0x51b870(0x23b)]:![];if(!_0x4098eb&&_0xa169de[_0x51b870(0x208)]>_0x57edbb){if(_0xa169de[_0x51b870(0x33b)]===_0x51b870(0x236)||serverversion['startsWith'](_0xa169de[_0x51b870(0x33b)])){let _0x3b1110=''+_0xa169de['title']+'\x0a\x0a'+_0xa169de[_0x51b870(0x30f)];const _0xe5f886=await sendTelegramMsg(toTelegramMarkdown(_0x3b1110),_0x51b870(0x29c));if(_0xe5f886)_0x57edbb=_0xa169de[_0x51b870(0x208)];}}}updateAvailable=isNewerVersion(settings[_0x51b870(0x1c5)],serverversion),updateSetting(_0x51b870(0x301),_0x57edbb),emitMessages();}}function emitMessages(){const _0x554667=_0x2fa3a5,_0x668d02=settings['lastmsgemitted'];let _0x29dab5=[];newMessages[_0x554667(0x227)](_0x1e8f8f=>{const _0x501599=_0x554667;_0x1e8f8f[_0x501599(0x208)]>_0x668d02&&_0x29dab5[_0x501599(0x2f5)](_0x1e8f8f);}),_0x29dab5['length']>0x0&&getAllClients()[_0x554667(0x227)](_0x2b5b0e=>{getSocket(_0x2b5b0e['id'])['emit']('message',_0x29dab5);});}function confirmMessage(_0xd6afcc){const _0x42f7ba=_0x2fa3a5;updateSetting(_0x42f7ba(0x246),Number(_0xd6afcc));}function isNewerVersion(_0x412378,_0x4bd46d){const _0x1764bd=_0x2fa3a5,_0x26a523=_0x4bd46d[_0x1764bd(0x2d4)]('.'),_0x315728=_0x412378[_0x1764bd(0x2d4)]('.');for(var _0x1c0c25=0x0;_0x1c0c25<_0x315728[_0x1764bd(0x2e0)];_0x1c0c25++){const _0x321a6b=~~_0x315728[_0x1c0c25],_0x2aa0fd=~~_0x26a523[_0x1c0c25];if(_0x321a6b>_0x2aa0fd)return!![];if(_0x321a6b<_0x2aa0fd)return![];}return![];}function toTelegramMarkdown(_0xa61465){const _0x439604=_0x2fa3a5,_0x14feb2=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4edbed=/\*{2}(.+?)\*{2}/gim;return _0xa61465=_0xa61465[_0x439604(0x1c9)](_0x14feb2,_0x439604(0x2fc))['replace'](_0x4edbed,_0x439604(0x27d)),_0xa61465;}async function validateConfigFile(){const _0x445bfc=_0x2fa3a5,_0x95619d=dbConfig[_0x445bfc(0x225)]('bots')['sortBy']('botID')[_0x445bfc(0x350)]()||[];if(_0x95619d['length']==0x0){let _0x15d55b=0x0,_0x32c5d1=[];const _0x1cd5f8=/^bot-([0-9]{3})-config.json$/,_0x1593b7=fs['readdirSync'](configpath);_0x1593b7[_0x445bfc(0x227)](_0x47397a=>{const _0x443130=_0x445bfc,_0x5b10c7=_0x1cd5f8['exec'](_0x47397a);if(_0x5b10c7){const _0x3849a1=_0x5b10c7[0x1];let _0xb5d18c=getBotAttributes(_0x3849a1);_0x32c5d1[_0x443130(0x2f5)]({'botID':_0x3849a1,'botname':_0xb5d18c[_0x443130(0x1e0)],'status':_0x443130(0x376),'live':_0x443130(0x1c4)}),_0x15d55b++;}}),_0x15d55b!=0x0&&(dbConfig[_0x445bfc(0x225)](_0x445bfc(0x24e))['assign'](_0x32c5d1)[_0x445bfc(0x379)](),config=_0x32c5d1,restoredConfigFile=_0x15d55b);}}async function restoreConfigNotify(_0x5aa4af){const _0x17c460=_0x2fa3a5;let _0x5f318d;if(restoredConfigFile==0x1)_0x5f318d=_0x17c460(0x28f);else _0x5f318d=_0x17c460(0x322);if(_0x5aa4af)io['to'](_0x17c460(0x23a))[_0x17c460(0x257)](_0x17c460(0x326),_0x5f318d);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x17c460(0x24d)](_0x5f318d),logger['simple'](_0x17c460(0x373)),logger[_0x17c460(0x24d)]('');if(tgBot&&settings[_0x17c460(0x2b7)]&&settings[_0x17c460(0x276)]!=_0x17c460(0x2bd))tgBot[_0x17c460(0x2dd)](settings[_0x17c460(0x2b7)],'Bot\x20Mgr\x20>\x20'+_0x5f318d)[_0x17c460(0x2a3)](_0x662d20=>{telegramError(_0x662d20);});}}function validateCredentials(_0x37af4b,_0x3a9c82){const _0x5e43db=_0x2fa3a5;if(_0x37af4b[_0x5e43db(0x1dd)]==settings[_0x5e43db(0x1f8)]&&bcrypt[_0x5e43db(0x37e)](_0x37af4b['password'],settings['bbPassword'])){if(settings[_0x5e43db(0x215)])return{'allow':![],'reason':_0x5e43db(0x382),'token':null};else{const _0x57db2d=generateLoginToken(_0x3a9c82);return{'allow':!![],'reason':_0x5e43db(0x341),'token':_0x57db2d};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x5a50ca){const _0x23b29e=_0x2fa3a5,_0xdadd9e=generateLoginToken(_0x5a50ca);return{'allow':!![],'reason':_0x23b29e(0x341),'token':_0xdadd9e};}function validateAccess(_0x47efc3,_0x356070,_0x1e2f7b){const _0x93578a=_0x2fa3a5,_0x4f2b78=_0x1e2f7b?_0x1e2f7b:devices[_0x356070]['ip'];let _0x113349;const _0x437c82=_0x441886=>{const _0x4a5bb4=_0x4f83;if(settings['loginRequired']){if(settings[_0x4a5bb4(0x215)]){if(telegram2FaApproved(_0x356070)){const _0x2837c9=generateLoginToken(_0x356070);return{'allow':!![],'reason':_0x4a5bb4(0x2b0),'token':_0x2837c9};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x113349=validToken(_0x441886,_0x356070),_0x113349[_0x4a5bb4(0x21d)](_0x4a5bb4(0x2f8))?{'allow':!![],'reason':_0x4a5bb4(0x34b),'token':_0x441886}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x4a5bb4(0x232),'token':null};};if(settings[_0x93578a(0x203)]){let _0x264ac9=[...settings[_0x93578a(0x245)],_0x93578a(0x29f),'::ffff:127.0.0.1',_0x93578a(0x31d)];if(_0x264ac9['includes'](_0x4f2b78))return _0x437c82(_0x47efc3);else{_0x113349=validToken(_0x47efc3,_0x356070);if(_0x113349[_0x93578a(0x21d)](_0x93578a(0x2f8)))return _0x437c82(_0x47efc3);else{if(telegramIpApproved(_0x356070)){const _0x4fff7e=generateToken(_0x356070);return _0x113349=_0x437c82(_0x47efc3),_0x113349['allow']?{'allow':!![],'reason':_0x93578a(0x2be),'token':_0x4fff7e}:_0x113349;}else return settings[_0x93578a(0x255)]?{'allow':![],'reason':_0x93578a(0x292),'token':null}:{'allow':![],'reason':_0x93578a(0x2af),'token':null};}}}else return _0x437c82(_0x47efc3);}function timelyDecrypt(_0x2d2bb8,_0x4c0cbd=!![]){const _0x2678d8=_0x2fa3a5;if(_0x2d2bb8)try{const _0x15fbf0=crypt[_0x2678d8(0x21f)](secure[_0x2678d8(0x2a2)],_0x2d2bb8)[_0x2678d8(0x30f)],_0x46385b=_0x15fbf0[_0x2678d8(0x2d4)]('@')[0x0],_0x41ce6f=_0x15fbf0[_0x2678d8(0x2d4)]('@')[0x1],_0x8d78c=new Date()[_0x2678d8(0x2b9)]();if(_0x4c0cbd){if(_0x8d78c-_0x41ce6f<maxSecretAge*0x3e8)return _0x46385b;else return![];}else return _0x46385b;}catch(_0x1b4da7){return![];}else return![];}const validToken=(_0x2f49f7,_0x3bb991)=>{const _0x245a69=_0x2fa3a5,_0x2f7bb7=devices[_0x3bb991]['ip'];if(!_0x2f49f7)return{'error':_0x245a69(0x36d)};for(let _0x2934f6 of blacklist){if(_0x2934f6['token']==_0x2f49f7)return{'error':_0x245a69(0x222)};}let _0x15368c;try{_0x15368c=jwt['verify'](_0x2f49f7,secure['secret']+_0x3bb991);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x15368c[_0x245a69(0x21d)](_0x245a69(0x205))&&!_0x15368c[_0x245a69(0x21d)](_0x245a69(0x1dd))||!_0x15368c[_0x245a69(0x21d)](_0x245a69(0x23d)))return{'error':_0x245a69(0x35d)};if(!_0x15368c[_0x245a69(0x21d)](_0x245a69(0x1dd))&&_0x15368c[_0x245a69(0x21d)](_0x245a69(0x205))){const {clientip:_0x380739}=_0x15368c;return _0x2f7bb7==_0x380739?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x245a69(0x2b3)};}else{if(_0x15368c['hasOwnProperty'](_0x245a69(0x1dd))&&_0x15368c[_0x245a69(0x21d)](_0x245a69(0x205))){const {username:_0x83e71d,clientip:_0x5ed8c9}=_0x15368c;return settings['bbUsername']==_0x83e71d&&_0x2f7bb7==_0x5ed8c9?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x302891=>{const _0x4114c5=_0x2fa3a5;if(_0x302891){const _0x191169=devices[_0x302891]['ip'];return jwt[_0x4114c5(0x247)]({'username':settings[_0x4114c5(0x1f8)],'clientip':_0x191169},secure['secret']+_0x302891,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2b9c6a=>{const _0xe86cb2=_0x2fa3a5;if(_0x2b9c6a){const _0x150f32=devices[_0x2b9c6a]['ip'];return jwt[_0xe86cb2(0x247)]({'clientip':_0x150f32},secure[_0xe86cb2(0x23e)]+_0x2b9c6a,{'expiresIn':devices[_0x2b9c6a]['telegramIpApproval'][_0xe86cb2(0x1c3)]*0x3c});}else return![];},telegramIpApproved=_0x9ce40e=>{const _0x15a8ae=_0x2fa3a5;let _0x161b87=![];return devices[_0x9ce40e][_0x15a8ae(0x31b)]&&devices[_0x9ce40e][_0x15a8ae(0x31b)][_0x15a8ae(0x1c3)]!=_0x15a8ae(0x353)&&(_0x161b87=devices[_0x9ce40e][_0x15a8ae(0x31b)][_0x15a8ae(0x205)]==devices[_0x9ce40e]['ip']&&new Date()['getTime']()-devices[_0x9ce40e][_0x15a8ae(0x31b)][_0x15a8ae(0x333)]<devices[_0x9ce40e][_0x15a8ae(0x31b)][_0x15a8ae(0x1c3)]*0x3c*0x3e8),_0x161b87;},telegram2FaApproved=_0x32e6ba=>{const _0x47fd5b=_0x2fa3a5;let _0x5c9c05=![];return devices[_0x32e6ba][_0x47fd5b(0x2f4)]&&devices[_0x32e6ba][_0x47fd5b(0x2f4)][_0x47fd5b(0x1c3)]!='reject'&&(_0x5c9c05=devices[_0x32e6ba]['telegram2FaApproval'][_0x47fd5b(0x205)]==devices[_0x32e6ba]['ip']&&new Date()['getTime']()-devices[_0x32e6ba][_0x47fd5b(0x2f4)][_0x47fd5b(0x333)]<devices[_0x32e6ba]['telegram2FaApproval'][_0x47fd5b(0x1c3)]*0x3c*0x3e8),_0x5c9c05;},normalizeIP=_0x58b2bb=>{const _0x4b6fb2=_0x2fa3a5;let _0x1504da=null,_0x1e23c2=null;if(ipaddr[_0x4b6fb2(0x1e5)](_0x58b2bb)){const _0x2d6d57=ipaddr[_0x4b6fb2(0x204)](_0x58b2bb);_0x2d6d57[_0x4b6fb2(0x21a)]()===_0x4b6fb2(0x351)?(_0x2d6d57[_0x4b6fb2(0x22d)]()&&(_0x1504da=_0x2d6d57[_0x4b6fb2(0x279)]()['toString']()),_0x1e23c2=_0x2d6d57[_0x4b6fb2(0x310)]()):(_0x1504da=_0x2d6d57[_0x4b6fb2(0x310)](),_0x1e23c2=_0x2d6d57[_0x4b6fb2(0x1fa)]()[_0x4b6fb2(0x310)]());}return{'show':_0x1504da?_0x1504da:_0x1e23c2,'store':_0x1e23c2};};function formatDate(_0x33cc61){const _0xd15c76=_0x2fa3a5;return _0x33cc61[_0xd15c76(0x1d6)]()+'/'+(_0x33cc61[_0xd15c76(0x250)]()+0x1)['toString']()[_0xd15c76(0x2e9)](0x2,'0')+'/'+_0x33cc61[_0xd15c76(0x371)]()[_0xd15c76(0x310)]()['padStart'](0x2,'0')+'\x20'+_0x33cc61[_0xd15c76(0x2e3)]()[_0xd15c76(0x310)]()['padStart'](0x2,'0')+':'+_0x33cc61[_0xd15c76(0x229)]()[_0xd15c76(0x310)]()[_0xd15c76(0x2e9)](0x2,'0')+':'+_0x33cc61[_0xd15c76(0x29b)]()[_0xd15c76(0x310)]()[_0xd15c76(0x2e9)](0x2,'0');}function sleep(_0x327876){return new Promise(_0x5129cf=>setTimeout(_0x5129cf,_0x327876));}