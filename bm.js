const _0x40eb46=_0x38fd;(function(_0x54d3fd,_0x3d98f9){const _0x2fcc12=_0x38fd,_0x270f64=_0x54d3fd();while(!![]){try{const _0x4de7d1=parseInt(_0x2fcc12(0x213))/0x1+parseInt(_0x2fcc12(0x2c5))/0x2*(-parseInt(_0x2fcc12(0x1cd))/0x3)+parseInt(_0x2fcc12(0x1a8))/0x4+parseInt(_0x2fcc12(0xe8))/0x5*(parseInt(_0x2fcc12(0x119))/0x6)+parseInt(_0x2fcc12(0x284))/0x7*(-parseInt(_0x2fcc12(0x2a3))/0x8)+-parseInt(_0x2fcc12(0x193))/0x9+parseInt(_0x2fcc12(0x120))/0xa*(parseInt(_0x2fcc12(0x1b5))/0xb);if(_0x4de7d1===_0x3d98f9)break;else _0x270f64['push'](_0x270f64['shift']());}catch(_0x4d3b2e){_0x270f64['push'](_0x270f64['shift']());}}}(_0xd078,0xecb94));const _0xd429e1=function(){let _0x2aa362=!![];return function(_0x16b172,_0x464ae8){const _0x59ffa9=_0x2aa362?function(){if(_0x464ae8){const _0x452298=_0x464ae8['apply'](_0x16b172,arguments);return _0x464ae8=null,_0x452298;}}:function(){};return _0x2aa362=![],_0x59ffa9;};}(),_0x36d34f=_0xd429e1(this,function(){const _0x614f32=_0x38fd;return _0x36d34f[_0x614f32(0x158)]()[_0x614f32(0x172)](_0x614f32(0x171))[_0x614f32(0x158)]()[_0x614f32(0x277)](_0x36d34f)[_0x614f32(0x172)]('(((.+)+)+)+$');});_0x36d34f();'use strict';process[_0x40eb46(0x1bc)][_0x40eb46(0x1de)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x40eb46(0x1bd)),FileSync=require(_0x40eb46(0x268)),path=require(_0x40eb46(0x251)),crypto=require(_0x40eb46(0x257)),Crypt=require(_0x40eb46(0x232))[_0x40eb46(0x148)],RSA=require('hybrid-crypto-js')[_0x40eb46(0x2ad)],bcrypt=require(_0x40eb46(0x14b)),jwt=require(_0x40eb46(0x1ae)),ipaddr=require(_0x40eb46(0x281)),argv=require(_0x40eb46(0x1bf))(process['argv'][_0x40eb46(0x1b1)](0x2))[_0x40eb46(0xfc)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x40eb46(0x226)),Mixpanel=require('mixpanel'),axios=require(_0x40eb46(0x2ae)),{GraphQLClient,gql}=require(_0x40eb46(0x2ba)),util=require('util'),fileUpload=require(_0x40eb46(0x1ee)),{networkInterfaces}=require('os'),PORT=argv[_0x40eb46(0x14d)]||_0x40eb46(0x17b),pattern=/^[0-9]{2,4}$/;!pattern[_0x40eb46(0x222)](PORT)&&(console[_0x40eb46(0x18d)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x40eb46(0x17c)](0x1));const HOST=argv[_0x40eb46(0x26e)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x40eb46(0x12e)][_0x40eb46(0x2ac)],environment=require(_0x40eb46(0x1a9))[_0x40eb46(0x254)]||_0x40eb46(0x280);let bbpath=_0x40eb46(0x260),bbpath2='';const botfile=_0x40eb46(0x136),configfile=_0x40eb46(0x10e),settingsfile=_0x40eb46(0x1e5),securefile=_0x40eb46(0x22c),maxBackups=0xa;let validInstallation=!![];!fs[_0x40eb46(0x1f9)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x40eb46(0x231)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x40eb46(0x297),configbackuppath=configpath+_0x40eb46(0x282),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x40eb46(0x11a),zippath=userID?bbpath+_0x40eb46(0x240)+userID+'/':bbpath+_0x40eb46(0x240),loggerfile=fs[_0x40eb46(0x212)](logspath+_0x40eb46(0x25c),{'flags':'a'}),temppath=userID?bbpath+_0x40eb46(0x1ab)+userID+'/':bbpath+_0x40eb46(0x1ab);!fs['existsSync'](configpath)&&fs[_0x40eb46(0x161)](configpath);!fs[_0x40eb46(0x1f9)](configbackuppath)&&fs[_0x40eb46(0x161)](configbackuppath);!fs[_0x40eb46(0x1f9)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x40eb46(0x1f9)](zippath)&&fs[_0x40eb46(0x161)](zippath);!fs[_0x40eb46(0x1f9)](temppath)&&fs[_0x40eb46(0x161)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x40eb46(0x10f)]({'bots':[]})[_0x40eb46(0x262)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x40eb46(0x10f)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x40eb46(0x20e),'onepagemode':![]}})[_0x40eb46(0x262)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x40eb46(0x10f)]({'secure':{},'blacklist':[]})[_0x40eb46(0x262)]();let crypt=new Crypt({'md':_0x40eb46(0x1f1),'rsaStandard':_0x40eb46(0x224)});const saltRounds=0xa,mixpanel=Mixpanel[_0x40eb46(0xfe)](_0x40eb46(0x272),{'host':_0x40eb46(0xf6)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x40eb46(0x271)]&&settings['telegramToken']!=''&&settings[_0x40eb46(0x20a)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x352fb6,_0xfbfbf3)=>{const _0x552e4f=_0x40eb46,_0x64ed5=/#[A-Z]{3}#/g;if(typeof _0x352fb6==_0x552e4f(0x2bc)){!_0xfbfbf3?_0x352fb6=_0x352fb6[_0x552e4f(0x162)](_0x64ed5,''):(_0x352fb6=_0x352fb6[_0x552e4f(0x162)](/#BLU#/g,_0x552e4f(0x1c5)),_0x352fb6=_0x352fb6[_0x552e4f(0x162)](/#RED#/g,_0x552e4f(0x192)),_0x352fb6=_0x352fb6[_0x552e4f(0x162)](/#YEL#/g,_0x552e4f(0x2ab)),_0x352fb6=_0x352fb6[_0x552e4f(0x162)](/#MAG#/g,_0x552e4f(0x295)),_0x352fb6=_0x352fb6['replace'](/#CYA#/g,_0x552e4f(0x22a)),_0x352fb6=_0x352fb6[_0x552e4f(0x162)](/#RES#/g,_0x552e4f(0x1ff)));;}return _0x352fb6;},logger={'screen':_0x1d4a6c=>{console['log'](parseColor(_0x1d4a6c,!![]));},'simple':_0x5530b9=>{const _0x137f73=_0x40eb46;console[_0x137f73(0x18d)](parseColor(_0x5530b9,!![])),loggerfile[_0x137f73(0x262)](util[_0x137f73(0x1b6)](parseColor(_0x5530b9,![]))+'\x0a');},'full':async _0x505c32=>{const _0x2143ad=_0x40eb46,_0x16bc7a=getTimeStamp()+_0x2143ad(0x178)+_0x505c32;console[_0x2143ad(0x18d)](parseColor(_0x16bc7a,!![])),loggerfile[_0x2143ad(0x262)](util['format'](parseColor(_0x16bc7a,![]))+'\x0a');if(tgBot&&settings[_0x2143ad(0x17f)]&&settings[_0x2143ad(0x23a)]!=_0x2143ad(0x13e))await tgBot[_0x2143ad(0x109)](settings['telegramChatId'],_0x2143ad(0x12d)+parseColor(_0x505c32,![]))['catch'](_0x40fc7e=>{telegramError(_0x40fc7e);});},'debug':async(_0x52a027,_0x393a09='')=>{const _0x5cf017=_0x40eb46,_0x2d528e=getTimeStamp()+_0x5cf017(0x117)+_0x52a027;if(debugging)console[_0x5cf017(0x18d)](parseColor(_0x2d528e,!![]));loggerfile[_0x5cf017(0x262)](util[_0x5cf017(0x1b6)](parseColor(_0x2d528e,![]))+'\x0a');if(_0x393a09){if(debugging)console[_0x5cf017(0x18d)](_0x393a09);loggerfile[_0x5cf017(0x262)](util[_0x5cf017(0x1b6)](_0x393a09)+'\x0a');}}};process['on'](_0x40eb46(0x1c1),function(_0x4d6288){const _0x24a13d=_0x40eb46;logger[_0x24a13d(0x258)](_0x4d6288);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x40eb46(0x14a)),app=express(),http=require('http')[_0x40eb46(0xef)](app);app[_0x40eb46(0x110)](fileUpload({'useTempFiles':!![]})),app[_0x40eb46(0x273)](_0x40eb46(0x1fd),async(_0x175cc9,_0x57e32b)=>{const _0x25d728=_0x40eb46,_0x6cc5b3=_0x175cc9[_0x25d728(0x132)][_0x25d728(0x14c)],_0x3af29d=getClientsWithBotID(_0x25d728(0x206)),_0x13f56d=_0x175cc9[_0x25d728(0x18c)][_0x25d728(0x199)],_0x4a1f12=timelyDecrypt(_0x13f56d,![]),_0x5f0a33=_0x3af29d['find'](_0x1ec5d7=>_0x1ec5d7[_0x25d728(0x199)]==_0x4a1f12);if(_0x5f0a33){const _0x4752ea=normalizeIP(_0x175cc9[_0x25d728(0x26a)][_0x25d728(0x114)])[_0x25d728(0x1d7)],_0x2990fc=_0x175cc9[_0x25d728(0x18c)][_0x25d728(0x259)];if(validateAccess(_0x2990fc,_0x4a1f12,_0x4752ea)[_0x25d728(0x1d4)])_0x6cc5b3==_0x25d728(0x24f)&&await backupConfigFiles(),await zipFiles(_0x6cc5b3),_0x57e32b[_0x25d728(0x255)](zippath+(_0x6cc5b3+_0x25d728(0x270)),_0x431571=>{const _0xd94652=_0x25d728;_0x431571&&(logger[_0xd94652(0x22f)](_0xd94652(0x16b)+_0x6cc5b3),logger['simple'](_0x431571));});else logger[_0x25d728(0x22f)](_0x25d728(0x200)+_0x6cc5b3+'\x20(1)');}else logger[_0x25d728(0x22f)](_0x25d728(0x200)+_0x6cc5b3+'\x20(2)');}),app[_0x40eb46(0x29c)]('/upload-backup',async(_0x3d5a09,_0xd94305)=>{const _0xdfff10=_0x40eb46,_0x45ca52=getClientsWithBotID(_0xdfff10(0x206)),_0x325c37=_0x3d5a09['headers']['uuid'],_0x4dc540=timelyDecrypt(_0x325c37,![]),_0x911b20=_0x45ca52[_0xdfff10(0x2af)](_0x1f0c11=>_0x1f0c11[_0xdfff10(0x199)]==_0x4dc540);logger[_0xdfff10(0x138)](_0xdfff10(0x27a));if(_0x911b20){const _0x3a5a97=normalizeIP(_0x3d5a09[_0xdfff10(0x26a)][_0xdfff10(0x114)])[_0xdfff10(0x1d7)],_0x35f041=_0x3d5a09[_0xdfff10(0x18c)][_0xdfff10(0x259)];if(validateAccess(_0x35f041,_0x4dc540,_0x3a5a97)['allow']){if(_0x3d5a09[_0xdfff10(0x23b)]){const _0x2862bd=_0x3d5a09['files'][_0xdfff10(0xee)];await _0x2862bd['mv'](temppath+_0x2862bd[_0xdfff10(0x173)]),_0xd94305['send']({'status':!![],'message':_0xdfff10(0x174)});const _0x313e16=getBotsWithMode();_0x313e16[_0xdfff10(0x24a)]>0x0?confirmRestore(temppath,_0x2862bd[_0xdfff10(0x173)]):unzipFile(temppath,_0x2862bd[_0xdfff10(0x173)]);}}else logger[_0xdfff10(0x22f)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0xdfff10(0x22f)](_0xdfff10(0x115));}),app[_0x40eb46(0x110)](express['static'](path[_0x40eb46(0x274)](__dirname,bbpath2,_0x40eb46(0x116)))),app[_0x40eb46(0x110)](express[_0x40eb46(0x248)](path[_0x40eb46(0x274)](__dirname,bbpath2,_0x40eb46(0x1f3)))),app[_0x40eb46(0x273)]('/',function(_0x2c908c,_0x26488d){const _0x5c7413=_0x40eb46;_0x26488d[_0x5c7413(0xf2)](path['join'](__dirname,bbpath2,_0x5c7413(0x116),_0x5c7413(0x247)));}),app[_0x40eb46(0x273)](_0x40eb46(0x25f),function(_0x592ae7,_0x3e8000){const _0x2d8de3=_0x40eb46;_0x3e8000['sendFile'](path[_0x2d8de3(0x274)](__dirname,bbpath2,'build',_0x2d8de3(0x247)));}),app[_0x40eb46(0x273)]('/:bot/portfolio',(_0x3cb1ff,_0x41815b)=>{const _0x294a2d=_0x40eb46;_0x41815b[_0x294a2d(0xf2)](path[_0x294a2d(0x274)](__dirname,bbpath2,_0x294a2d(0x1f3),_0x294a2d(0x247)));}),app[_0x40eb46(0x273)]('/:bot/performance',(_0x359daa,_0x2a2db0)=>{const _0xccfb5a=_0x40eb46;_0x2a2db0['sendFile'](path[_0xccfb5a(0x274)](__dirname,bbpath2,_0xccfb5a(0x1f3),_0xccfb5a(0x247)));}),app[_0x40eb46(0x273)](_0x40eb46(0x155),(_0x2a24f4,_0x320e08)=>{const _0x5ef233=_0x40eb46;_0x320e08[_0x5ef233(0xf2)](path[_0x5ef233(0x274)](__dirname,bbpath2,_0x5ef233(0x1f3),_0x5ef233(0x247)));}),app[_0x40eb46(0x273)](_0x40eb46(0x230),(_0x479d04,_0x487995)=>{const _0x319cde=_0x40eb46;_0x487995[_0x319cde(0xf2)](path[_0x319cde(0x274)](__dirname,bbpath2,_0x319cde(0x1f3),_0x319cde(0x247)));}),app[_0x40eb46(0x273)]('/:bot/configuration',(_0x3c3435,_0x3cc964)=>{const _0x343163=_0x40eb46;_0x3cc964[_0x343163(0xf2)](path[_0x343163(0x274)](__dirname,bbpath2,'build','index.html'));}),app[_0x40eb46(0x273)](_0x40eb46(0x2c1),(_0x520f03,_0x2e76e7)=>{const _0x2e9c8a=_0x40eb46;_0x2e76e7[_0x2e9c8a(0xf2)](path['join'](__dirname,bbpath2,_0x2e9c8a(0x1f3),_0x2e9c8a(0x247)));});if(HOST)http['listen'](PORT,HOST);else http[_0x40eb46(0x1c3)](PORT);const io=require(_0x40eb46(0x2b6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1e3dc1=_0x40eb46;let _0x254e73='[ip-address]';const _0x1896ce=networkInterfaces(),_0x16d336={};for(const _0x5b3038 of Object[_0x1e3dc1(0x198)](_0x1896ce)){for(const _0x8d9a19 of _0x1896ce[_0x5b3038]){if((_0x8d9a19[_0x1e3dc1(0x25d)]==_0x1e3dc1(0x190)||_0x8d9a19[_0x1e3dc1(0x25d)]==0x4)&&!_0x8d9a19[_0x1e3dc1(0x128)]){const _0x22915a=ipaddr[_0x1e3dc1(0x21b)](_0x8d9a19[_0x1e3dc1(0xf0)])[_0x1e3dc1(0x241)]();_0x22915a!='private'&&(!_0x16d336[_0x5b3038]&&(_0x16d336[_0x5b3038]=[]),_0x16d336[_0x5b3038][_0x1e3dc1(0x185)](_0x8d9a19[_0x1e3dc1(0xf0)]),_0x254e73=_0x8d9a19[_0x1e3dc1(0xf0)]);}}}return{'serverip':_0x254e73,'netinterfaces':_0x16d336};}async function startServer(){const _0x5f3c37=_0x40eb46,{serverip:_0x22058a,netinterfaces:_0x3392c3}=getServerIP();logger[_0x5f3c37(0x258)](''),logger[_0x5f3c37(0x258)]('-----------------------------------------------------------------------------------'),await logger[_0x5f3c37(0x22f)](_0x5f3c37(0x135)+serverversion+'#RES#\x20'+(environment==_0x5f3c37(0x263)?_0x5f3c37(0x286):'')+'\x0a'+(_0x5f3c37(0x163)+PORT+_0x5f3c37(0x2b0))+('=>\x20Go\x20to\x20#CYA#http://'+_0x22058a+':'+PORT+_0x5f3c37(0x1fe))),logger['simple'](_0x5f3c37(0x29b));if(config[_0x5f3c37(0x24a)]!=0x0)for(const _0x3d0a85 of config){if(_0x3d0a85[_0x5f3c37(0x26c)]==_0x5f3c37(0x11b)||_0x3d0a85[_0x5f3c37(0x26c)]==_0x5f3c37(0x12c))await logger[_0x5f3c37(0x22f)](_0x5f3c37(0x1e9)+_0x3d0a85[_0x5f3c37(0x18e)]+_0x5f3c37(0x150)+_0x3d0a85[_0x5f3c37(0x15b)]),startBot([_0x3d0a85[_0x5f3c37(0x18e)],userID],{'cwd':bbpath},function(_0x3ef328){if(_0x3ef328)logger['full'](_0x3ef328);});else(_0x3d0a85['status']==_0x5f3c37(0x151)||_0x3d0a85[_0x5f3c37(0x26c)]=='new-disabled')&&await logger[_0x5f3c37(0x22f)](_0x5f3c37(0x1ca)+_0x3d0a85['botID']+_0x5f3c37(0x150)+_0x3d0a85['botname']);}else!newBot&&logger[_0x5f3c37(0x258)](_0x5f3c37(0x25e));if(newBot)addBot();logger['simple'](_0x5f3c37(0x29b)),logger[_0x5f3c37(0x258)](''),await logger[_0x5f3c37(0x138)](_0x5f3c37(0x2a5)+nodeversion),await logger[_0x5f3c37(0x138)]('Network\x20Interfaces:',_0x3392c3);}function startSocket(){io['on']('connection',_0x4b550e=>{const _0x21db60=_0x38fd;let _0x411915,_0x39a58b,_0x3857b4,_0x2be6a1,_0x28d4a9;const _0x941d1b=_0x4b550e[_0x21db60(0x250)][_0x21db60(0x18c)][_0x21db60(0x23d)];_0x39a58b=_0x941d1b[_0x21db60(0xf5)](/bot[0-9]{3}/);if(_0x39a58b)_0x3857b4=_0x39a58b[0x0][_0x21db60(0xf5)](/[0-9]{3}/);if(_0x3857b4)_0x411915=_0x3857b4[0x0];else _0x411915=_0x21db60(0x206);const _0x42712d=_0x4b550e[_0x21db60(0x250)][_0x21db60(0x15f)][_0x21db60(0x29d)];if(!_0x42712d)_0x4b550e['emit'](_0x21db60(0x26c),{'publicKey':secure[_0x21db60(0x1ec)]});else{_0x2be6a1=timelyDecrypt(_0x42712d,![]);if(!_0x2be6a1)_0x4b550e[_0x21db60(0x214)](_0x21db60(0x26c),{'publicKey':secure[_0x21db60(0x1ec)]});else{_0x28d4a9=normalizeIP(_0x4b550e['conn']['remoteAddress'])[_0x21db60(0x1d7)];if(!devices[_0x2be6a1])devices[_0x2be6a1]={'uuid':_0x2be6a1,'access':{'token':null}};devices[_0x2be6a1]['ip']=_0x28d4a9;const _0x1da309=addClient(_0x4b550e['id'],_0x2be6a1,_0x411915);setAccess(_0x1da309),emitMessages(),_0x4b550e['on'](_0x21db60(0x14e),_0x40347c=>{const _0x36174c=_0x21db60,_0x472472=timelyDecrypt(_0x40347c[_0x36174c(0xf4)]);if(_0x472472){_0x40347c={'username':_0x40347c[_0x36174c(0x202)],'password':_0x472472},devices[_0x2be6a1][_0x36174c(0x27e)]=validateCredentials(_0x40347c,_0x2be6a1);if(devices[_0x2be6a1][_0x36174c(0x27e)][_0x36174c(0x1d4)]==![]&&devices[_0x2be6a1][_0x36174c(0x27e)]['reason']==_0x36174c(0x21e))_0x4b550e['emit'](_0x36174c(0x26c),{'access':devices[_0x2be6a1][_0x36174c(0x27e)]}),loginAccess2FA(_0x2be6a1,_0x28d4a9);else{if(devices[_0x2be6a1][_0x36174c(0x27e)][_0x36174c(0x1d4)]==![]&&devices[_0x2be6a1][_0x36174c(0x27e)][_0x36174c(0x2c3)]=='invalid\x20credentials')_0x4b550e[_0x36174c(0x214)](_0x36174c(0x26c),{'access':devices[_0x2be6a1][_0x36174c(0x27e)]});else devices[_0x2be6a1]['access'][_0x36174c(0x1d4)]&&devices[_0x2be6a1][_0x36174c(0x27e)][_0x36174c(0x2c3)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x2be6a1)[_0x36174c(0x1fa)](_0x3ebb80=>{setAccess(_0x3ebb80);}),logger['debug'](_0x36174c(0x1a6)+_0x2be6a1['slice'](-0x8)),setTokenRefresh(_0x2be6a1),setSessionTimeout(_0x36174c(0x14e),_0x2be6a1));}}else logger[_0x36174c(0x22f)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x4b550e['on'](_0x21db60(0x147),()=>{resetPassword();}),_0x4b550e['on'](_0x21db60(0x112),_0x2f4fc2=>{removeClient(_0x4b550e['id']);}),_0x411915=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x52e9e3){const _0x3b2c1c=_0x40eb46;if(_0x52e9e3!='botmanager'&&config['apiKey']!=''){if(pid[_0x52e9e3])pid[_0x52e9e3]['send']({'function':'initclient','args':null});}_0x52e9e3!=_0x3b2c1c(0x206)&&broadcastToBots(_0x3b2c1c(0x1d3),JSON[_0x3b2c1c(0x15e)](config));}function reloadBotManager(){const _0x544aa1=_0x40eb46;getClientsWithBotID(_0x544aa1(0x206))[_0x544aa1(0x1fa)](_0x59d96f=>{const _0x55688e=_0x544aa1;getSocket(_0x59d96f['id'])[_0x55688e(0x214)](_0x55688e(0x26c),{'access':{'allow':![],'reason':_0x55688e(0x11c),'token':null}});});}function getSocket(_0x4b2fc3){const _0x26688a=_0x40eb46;return io['sockets'][_0x26688a(0x182)][_0x26688a(0x273)](_0x4b2fc3);}function setAccess(_0x3968ef){const _0xc657ea=_0x40eb46,_0x205aca=getSocket(_0x3968ef['id']),_0x1ce2d5=_0x3968ef['uuid'],_0x528dd1=_0x3968ef['bot'];devices[_0x1ce2d5][_0xc657ea(0x27e)]=validateAccess(devices[_0x1ce2d5][_0xc657ea(0x27e)][_0xc657ea(0x26d)],_0x1ce2d5),logger[_0xc657ea(0x138)](_0xc657ea(0x216)+devices[_0x1ce2d5][_0xc657ea(0x27e)][_0xc657ea(0x2c3)]+_0xc657ea(0x19d)+_0x3968ef['id'][_0xc657ea(0x1b1)](-0x8)+_0xc657ea(0x1c2)+_0x1ce2d5[_0xc657ea(0x1b1)](-0x8)),_0x205aca[_0xc657ea(0x274)](_0x1ce2d5);if(devices[_0x1ce2d5]['access']['allow']){_0x205aca[_0xc657ea(0x274)](_0x528dd1);if(_0x528dd1=='botmanager')initializeSocketBotManager(_0x205aca);else initializeSocketBot(_0x205aca);initClient(_0x528dd1);}devices[_0x1ce2d5][_0xc657ea(0x27e)][_0xc657ea(0x26d)]&&devices[_0x1ce2d5][_0xc657ea(0x27e)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0xc657ea(0x1eb),_0x1ce2d5),devices[_0x1ce2d5][_0xc657ea(0x27e)][_0xc657ea(0x26d)]&&devices[_0x1ce2d5][_0xc657ea(0x27e)][_0xc657ea(0x2c3)]==_0xc657ea(0xe6)&&setSessionTimeout('login',_0x1ce2d5),_0x205aca[_0xc657ea(0x214)](_0xc657ea(0x26c),{'status':_0x3968ef[_0xc657ea(0x188)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1ce2d5][_0xc657ea(0x27e)],'externalip':devices[_0x1ce2d5]['ip'],'publicKey':secure[_0xc657ea(0x1ec)],'userid':settings[_0xc657ea(0x2a8)],'validInstallation':validInstallation}),devices[_0x1ce2d5][_0xc657ea(0x27e)][_0xc657ea(0x1d4)]==![]&&devices[_0x1ce2d5]['access']['reason']==_0xc657ea(0x1a4)&&temporaryAccess2FA(_0x1ce2d5,devices[_0x1ce2d5]['ip']);}function setSessionTimeout(_0xbefea8,_0x131406){const _0x199d20=_0x40eb46;let _0x4af721;if(_0xbefea8==_0x199d20(0x14e))_0x4af721=loginExpiry*0x3c*0x3e8;else _0x4af721=devices[_0x131406]['telegramIpApproval'][_0x199d20(0x1e8)]*0x3c*0x3e8-(new Date()[_0x199d20(0x18a)]()-devices[_0x131406][_0x199d20(0x28d)][_0x199d20(0x2b5)]);if(devices[_0x131406][_0x199d20(0x19c)])clearTimeout(devices[_0x131406][_0x199d20(0x19c)]);devices[_0x131406][_0x199d20(0x19c)]=setTimeout(()=>{const _0x2e4702=_0x199d20;if(devices[_0x131406][_0x2e4702(0x13b)])clearTimeout(devices[_0x131406]['pidRefreshToken']);removeSocketListeners(_0x131406),addBlacklist(_0x131406),devices[_0x131406][_0x2e4702(0x28d)]=null,devices[_0x131406][_0x2e4702(0x156)]=null,devices[_0x131406][_0x2e4702(0x27e)][_0x2e4702(0x26d)]=null,logger[_0x2e4702(0x138)]('Session\x20expired\x20for\x20user\x20...'+_0x131406[_0x2e4702(0x1b1)](-0x8)),devices[_0x131406][_0x2e4702(0x27e)]=validateAccess(devices[_0x131406][_0x2e4702(0x27e)][_0x2e4702(0x26d)],_0x131406),!(devices[_0x131406][_0x2e4702(0x27e)][_0x2e4702(0x1d4)]&&devices[_0x131406][_0x2e4702(0x27e)]['reason']==_0x2e4702(0xed))&&(_0xbefea8==_0x2e4702(0x14e)?io['to'](_0x131406)[_0x2e4702(0x214)](_0x2e4702(0x26c),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x131406)['emit'](_0x2e4702(0x26c),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x131406][_0x2e4702(0x27e)]['token']=null;},_0x4af721);}function setTokenRefresh(_0x5dd958){const _0x5778de=_0x40eb46;if(devices[_0x5dd958][_0x5778de(0x13b)])clearTimeout(devices[_0x5dd958][_0x5778de(0x13b)]);devices[_0x5dd958][_0x5778de(0x13b)]=setTimeout(()=>{const _0xe164b0=_0x5778de;getClientsWithUuid(_0x5dd958)[_0xe164b0(0x24a)]!=0x0?(devices[_0x5dd958]['access']=refreshToken(_0x5dd958),io['to'](_0x5dd958)[_0xe164b0(0x214)](_0xe164b0(0x26c),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5dd958][_0xe164b0(0x27e)],'externalip':devices[_0x5dd958]['ip'],'publicKey':secure[_0xe164b0(0x1ec)],'validInstallation':validInstallation}),setTokenRefresh(_0x5dd958)):clearTimeout(devices[_0x5dd958][_0xe164b0(0x13b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x34875c){const _0x2fd0df=_0x40eb46,_0x195905=getClient(_0x34875c['id'])['uuid'];_0x34875c[_0x2fd0df(0x214)]('bots',config),_0x34875c[_0x2fd0df(0x214)](_0x2fd0df(0x184),cleanSettings()),_0x34875c['on'](_0x2fd0df(0x2a1),_0x49dc7c=>{const _0x2bd0af=_0x2fd0df;if(validateAccess(_0x49dc7c,_0x195905)['allow'])addBot();else logger[_0x2bd0af(0x22f)](_0x2bd0af(0xfb));}),_0x34875c['on'](_0x2fd0df(0x102),(_0xfcd36d,_0x513a90)=>{const _0x4660c=_0x2fd0df;if(validateAccess(_0x513a90,_0x195905)[_0x4660c(0x1d4)])toggleBot(_0xfcd36d[_0x4660c(0x18e)],_0xfcd36d['status'],_0xfcd36d[_0x4660c(0x141)]);else logger[_0x4660c(0x22f)](_0x4660c(0x137));}),_0x34875c['on'](_0x2fd0df(0x298),(_0x2f5d57,_0x486ee4)=>{const _0x4a1d45=_0x2fd0df;if(validateAccess(_0x486ee4,_0x195905)[_0x4a1d45(0x1d4)])toggleBotMode(_0x2f5d57);else logger[_0x4a1d45(0x22f)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x34875c['on'](_0x2fd0df(0x1da),(_0x1e85d7,_0xaf7a49)=>{const _0x3755d2=_0x2fd0df;if(validateAccess(_0xaf7a49,_0x195905)[_0x3755d2(0x1d4)])deleteBot(_0x1e85d7);else logger[_0x3755d2(0x22f)](_0x3755d2(0x140));}),_0x34875c['on'](_0x2fd0df(0x218),(_0x58919c,_0x1c9b8c)=>{const _0x256532=_0x2fd0df;if(validateAccess(_0x1c9b8c,_0x195905)[_0x256532(0x1d4)])storeSettings(_0x58919c,!![]);else logger[_0x256532(0x22f)](_0x256532(0x1d6));}),_0x34875c['on'](_0x2fd0df(0x287),_0x36459d=>{const _0x509913=_0x2fd0df;if(validateAccess(_0x36459d,_0x195905)['allow'])updateBB(_0x509913(0x26b));else logger[_0x509913(0x22f)](_0x509913(0x1b0));}),_0x34875c['on']('reinstall-bb',_0x2921a8=>{const _0x2f1c63=_0x2fd0df;if(validateAccess(_0x2921a8,_0x195905)['allow'])updateBB(_0x2f1c63(0x129));else logger[_0x2f1c63(0x22f)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x34875c['on'](_0x2fd0df(0x195),_0x5ae0e0=>{const _0x516858=_0x2fd0df;if(validateAccess(_0x5ae0e0,_0x195905)[_0x516858(0x1d4)]){const _0x134cca=getClient(_0x34875c['id']);if(_0x134cca)getBackupFiles(_0x134cca[_0x516858(0x199)]);else logger[_0x516858(0x22f)](_0x516858(0x23c));}else logger[_0x516858(0x22f)](_0x516858(0x121));}),_0x34875c['on'](_0x2fd0df(0x288),(_0x282ead,_0x5a7e62)=>{const _0x1446dd=_0x2fd0df;if(validateAccess(_0x5a7e62,_0x195905)[_0x1446dd(0x1d4)])restoreBackupFile(_0x282ead);else logger[_0x1446dd(0x22f)](_0x1446dd(0x246));}),_0x34875c['on']('get-messages',_0x53f58a=>{const _0x53d913=_0x2fd0df;if(validateAccess(_0x53f58a,_0x195905)[_0x53d913(0x1d4)])getMessages();else logger[_0x53d913(0x22f)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x34875c['on'](_0x2fd0df(0x26f),(_0x338b31,_0x31862a)=>{const _0x285ba3=_0x2fd0df;if(validateAccess(_0x31862a,_0x195905)[_0x285ba3(0x1d4)])confirmMessage(_0x338b31);else logger[_0x285ba3(0x22f)](_0x285ba3(0x221));}),_0x34875c['on']('logout',_0x694e82=>{const _0x3998a3=_0x2fd0df;if(validateAccess(_0x694e82,_0x195905)['allow']){if(devices[_0x195905][_0x3998a3(0x13b)])clearTimeout(devices[_0x195905][_0x3998a3(0x13b)]);if(devices[_0x195905][_0x3998a3(0x19c)])clearTimeout(devices[_0x195905][_0x3998a3(0x19c)]);removeSocketListeners(getClient(_0x34875c['id'])[_0x3998a3(0x199)]),addBlacklist(_0x195905),devices[_0x195905]['telegramIpApproval']=null,devices[_0x195905]['telegram2FaApproval']=null,devices[_0x195905][_0x3998a3(0x27e)]['token']=null,logger[_0x3998a3(0x138)]('Logged\x20out\x20user\x20...'+_0x195905[_0x3998a3(0x1b1)](-0x8)),io['to'](getClient(_0x34875c['id'])[_0x3998a3(0x199)])[_0x3998a3(0x214)](_0x3998a3(0x26c),{'access':{'allow':![],'reason':_0x3998a3(0x2bd),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x3afa99){const _0x6f537c=_0x40eb46,_0x7c9ad=getClient(_0x3afa99['id'])[_0x6f537c(0x238)],_0x36bf9e=getClient(_0x3afa99['id'])['uuid'];_0x3afa99['on']('get-logs',(_0x358bf4,_0x308e93)=>{const _0x580866=_0x6f537c;if(validateAccess(_0x308e93,_0x36bf9e)[_0x580866(0x1d4)]){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x580866(0x170)]({'function':'emitHistory','args':_0x358bf4});}else logger[_0x580866(0x22f)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x3afa99['on'](_0x6f537c(0x1ce),(_0x227278,_0x341c95)=>{const _0x7c8b58=_0x6f537c;if(validateAccess(_0x341c95,_0x36bf9e)[_0x7c8b58(0x1d4)]){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x7c8b58(0x170)]({'function':_0x7c8b58(0x225),'args':_0x227278});}else logger[_0x7c8b58(0x22f)](_0x7c8b58(0x215));}),_0x3afa99['on'](_0x6f537c(0x105),(_0x1cd70d,_0x4fd96e)=>{const _0x24fbe9=_0x6f537c;if(validateAccess(_0x4fd96e,_0x36bf9e)[_0x24fbe9(0x1d4)]){if(pid[_0x7c9ad])pid[_0x7c9ad]['send']({'function':_0x24fbe9(0x207),'args':_0x1cd70d});}else logger[_0x24fbe9(0x22f)](_0x24fbe9(0x25b));}),_0x3afa99['on']('store-configuration',(_0x30e026,_0x307f30)=>{const _0x33c07c=_0x6f537c;if(validateAccess(_0x307f30,_0x36bf9e)['allow']){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x33c07c(0x170)]({'function':'storeConfiguration','args':_0x30e026});}else logger[_0x33c07c(0x22f)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x3afa99['on'](_0x6f537c(0x1db),(_0x2ee38a,_0x3e6b42)=>{const _0x193441=_0x6f537c;if(validateAccess(_0x3e6b42,_0x36bf9e)[_0x193441(0x1d4)]){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x193441(0x170)]({'function':'storeHeadless','args':_0x2ee38a});}else logger[_0x193441(0x22f)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3afa99['on'](_0x6f537c(0x16e),(_0x591db4,_0x290873)=>{const _0x2d9045=_0x6f537c;if(validateAccess(_0x290873,_0x36bf9e)['allow']){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x2d9045(0x170)]({'function':_0x2d9045(0x1c4),'args':_0x591db4});}else logger['full'](_0x2d9045(0x1c9));}),_0x3afa99['on'](_0x6f537c(0x201),_0x3d1f36=>{const _0x5cd57a=_0x6f537c;if(validateAccess(_0x3d1f36,_0x36bf9e)['allow']){if(pid[_0x7c9ad])pid[_0x7c9ad]['send']({'function':_0x5cd57a(0x1df),'args':null});}else logger[_0x5cd57a(0x22f)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x3afa99['on'](_0x6f537c(0x10c),_0x19a969=>{const _0x585e3d=_0x6f537c;if(validateAccess(_0x19a969,_0x36bf9e)['allow']){if(pid[_0x7c9ad])pid[_0x7c9ad]['send']({'function':_0x585e3d(0xf7),'args':null});}else logger[_0x585e3d(0x22f)](_0x585e3d(0x21c));}),_0x3afa99['on'](_0x6f537c(0x275),(_0x2d2145,_0x1488f0)=>{const _0x42da05=_0x6f537c;if(validateAccess(_0x1488f0,_0x36bf9e)[_0x42da05(0x1d4)]){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x42da05(0x170)]({'function':_0x42da05(0xeb),'args':_0x2d2145});}else logger['full'](_0x42da05(0x144));}),_0x3afa99['on'](_0x6f537c(0x1ad),_0x1ad5e1=>{const _0x369c77=_0x6f537c;if(validateAccess(_0x1ad5e1,_0x36bf9e)[_0x369c77(0x1d4)]){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x369c77(0x170)]({'function':_0x369c77(0x290),'args':null});}else logger[_0x369c77(0x22f)](_0x369c77(0x29e));}),_0x3afa99['on'](_0x6f537c(0x2b7),_0x44471c=>{const _0x459fce=_0x6f537c;if(validateAccess(_0x44471c,_0x36bf9e)['allow']){if(pid[_0x7c9ad])pid[_0x7c9ad][_0x459fce(0x170)]({'function':'showConfig','args':null});}else logger[_0x459fce(0x22f)](_0x459fce(0x15d));}),_0x3afa99['on'](_0x6f537c(0x287),_0x32831b=>{const _0x218b76=_0x6f537c;if(validateAccess(_0x32831b,_0x36bf9e)[_0x218b76(0x1d4)])updateBB('update');else logger[_0x218b76(0x22f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x3afa99['on']('get-messages',_0x1356fa=>{const _0x5e9b52=_0x6f537c;if(validateAccess(_0x1356fa,_0x36bf9e)[_0x5e9b52(0x1d4)])getMessages();else logger[_0x5e9b52(0x22f)](_0x5e9b52(0x1a7));}),_0x3afa99['on'](_0x6f537c(0x26f),(_0xe769f1,_0x3625d3)=>{const _0x47e9f5=_0x6f537c;if(validateAccess(_0x3625d3,_0x36bf9e)[_0x47e9f5(0x1d4)])confirmMessage(_0xe769f1);else logger[_0x47e9f5(0x22f)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3afa99['on'](_0x6f537c(0x1e7),_0x48aee7=>{const _0x375c42=_0x6f537c;if(validateAccess(_0x48aee7,_0x36bf9e)['allow']){if(devices[_0x36bf9e][_0x375c42(0x13b)])clearTimeout(devices[_0x36bf9e]['pidRefreshToken']);if(devices[_0x36bf9e][_0x375c42(0x19c)])clearTimeout(devices[_0x36bf9e][_0x375c42(0x19c)]);removeSocketListeners(getClient(_0x3afa99['id'])[_0x375c42(0x199)]),addBlacklist(_0x36bf9e),devices[_0x36bf9e][_0x375c42(0x28d)]=null,devices[_0x36bf9e]['telegram2FaApproval']=null,devices[_0x36bf9e][_0x375c42(0x27e)][_0x375c42(0x26d)]=null,logger['debug'](_0x375c42(0x10b)+_0x36bf9e[_0x375c42(0x1b1)](-0x8)),io['to'](getClient(_0x3afa99['id'])['uuid'])[_0x375c42(0x214)](_0x375c42(0x26c),{'access':{'allow':![],'reason':_0x375c42(0x2bd),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x247f7e){const _0x5783b5=_0x40eb46;getClientsWithUuid(_0x247f7e)[_0x5783b5(0x1fa)](_0x502013=>{const _0xd5fc40=_0x5783b5;getSocket(_0x502013['id'])[_0xd5fc40(0x233)]();});}function cleanSettings(){const _0x145a00=_0x40eb46;let _0x114a92=settings;return settings[_0x145a00(0x271)]&&settings[_0x145a00(0x271)]!=''&&(_0x114a92={..._0x114a92,'telegramToken':'************'}),settings[_0x145a00(0x22b)]&&settings[_0x145a00(0x22b)]!=''&&(_0x114a92={..._0x114a92,'bbPassword':_0x145a00(0x28e)}),(settings[_0x145a00(0x22b)]&&settings[_0x145a00(0x22b)]==_0x145a00(0x24c)||settings['telegramToken']&&settings[_0x145a00(0x271)]==_0x145a00(0x24c))&&(_0x114a92={..._0x114a92,'restored':{'password':settings[_0x145a00(0x22b)]==_0x145a00(0x24c),'telegram':settings[_0x145a00(0x271)]==_0x145a00(0x24c)}}),_0x114a92;}async function updateBB(_0x3af583){const _0x345084=_0x40eb46;await backupConfigFiles(),installingUpdate=!![],config[_0x345084(0x1fa)](_0x5622f7=>{const _0x252b47=_0x345084;restartBot(_0x5622f7[_0x252b47(0x18e)]);});if(_0x3af583=='update')process['send']({'update':!![],'environment':environment},_0x562b58=>{});else _0x3af583==_0x345084(0x129)&&process[_0x345084(0x170)]({'reinstall':!![],'environment':environment},_0x2232c1=>{});}function startBot(_0x1997da,_0x265636,_0x5d090b){const _0x3e8388=_0x40eb46;if(debugging)_0x1997da[_0x3e8388(0x185)]('-d');let _0x11bea5=![];const _0x8ebc35=_0x1997da[0x0];_0x265636={..._0x265636,'stdio':[_0x3e8388(0x146),_0x3e8388(0x146),_0x3e8388(0x146),_0x3e8388(0xe9)]},pid[_0x8ebc35]=childProcess[_0x3e8388(0x19b)](botfile,_0x1997da,_0x265636),pid[_0x8ebc35]['on'](_0x3e8388(0x227),_0x6cbfcf=>{const _0x175923=_0x3e8388;switch(Object[_0x175923(0x198)](_0x6cbfcf)[0x0]){case'botname':updateBotName(_0x8ebc35,_0x6cbfcf[_0x175923(0x15b)]);break;case _0x175923(0x1f7):updateBotManager();break;case _0x175923(0x26c):updateStatus(_0x8ebc35,_0x6cbfcf[_0x175923(0x26c)]);break;case _0x175923(0x141):updateLive(_0x8ebc35,_0x6cbfcf[_0x175923(0x141)]);break;case'started':updateLive(_0x8ebc35,_0x6cbfcf[_0x175923(0x252)]),io['to'](_0x8ebc35)[_0x175923(0x214)]('status',{'access':{'allow':![],'reason':_0x175923(0x11c),'token':null}});break;case'stop':_0x6cbfcf[_0x175923(0x1be)]==_0x175923(0x168)&&restartBot(_0x8ebc35);_0x6cbfcf[_0x175923(0x1be)]==_0x175923(0x266)&&toggleBot(_0x8ebc35,_0x175923(0x151),_0x175923(0x1e1));break;case _0x175923(0xf9):sendTelegram(_0x8ebc35,_0x6cbfcf[_0x175923(0xf9)]);break;case _0x175923(0x189):sendTelegramMsg(_0x6cbfcf[_0x175923(0x189)]);break;case _0x175923(0x196):io['to'](_0x8ebc35)[_0x175923(0x214)](_0x6cbfcf['function'],_0x6cbfcf[_0x175923(0x211)]);break;}}),pid[_0x8ebc35]['on']('error',function(_0x583b64){if(_0x11bea5)return;_0x11bea5=!![],_0x5d090b(_0x583b64);}),pid[_0x8ebc35]['on']('exit',async function(_0x584411){const _0xc272ee=_0x3e8388;if(installingUpdate)return;if(_0x11bea5)return;_0x11bea5=!![],_0x5d090b(null);const _0x3a8ada=dbConfig[_0xc272ee(0x273)]('bots')[_0xc272ee(0x2af)]({'botID':_0x8ebc35})[_0xc272ee(0xf1)]();_0x3a8ada&&(_0x3a8ada[_0xc272ee(0x26c)]==_0xc272ee(0x11b)||_0x3a8ada[_0xc272ee(0x26c)]==_0xc272ee(0x12c))&&(await sleep(0x3e8),updateLive(_0x8ebc35,'stopped'),logger['full'](_0xc272ee(0x24b)+_0x8ebc35),startBot([_0x8ebc35,userID],{'cwd':bbpath},function(_0x13af67){const _0x145c1b=_0xc272ee;if(_0x13af67)logger[_0x145c1b(0x22f)](_0x13af67);}));});}function stopBot(_0x1c25b0){const _0x5ceba4=_0x40eb46;getClientsWithBotID(_0x1c25b0)[_0x5ceba4(0x1fa)](_0x1be6a6=>{const _0x42c380=_0x5ceba4;getSocket(_0x1be6a6['id'])[_0x42c380(0x112)](!![]),removeClient(_0x1be6a6['id']);}),pid[_0x1c25b0]&&(pid[_0x1c25b0]['kill'](),pid[_0x1c25b0]=null);}function restartBot(_0x18f8b2){if(pid[_0x18f8b2])pid[_0x18f8b2]['kill']();}function addBot(){const _0x25d198=_0x40eb46;let _0x2da47;for(let _0x5e93bb=0x1;_0x5e93bb<0x3e9;_0x5e93bb++){_0x2da47=_0x5e93bb[_0x25d198(0x158)]()[_0x25d198(0xfa)](0x3,'0');let _0x1b2de4=config[_0x25d198(0x2af)](_0x3b9603=>_0x3b9603[_0x25d198(0x18e)]==_0x2da47);if(!_0x1b2de4)break;}if(_0x2da47===_0x25d198(0x20d)){logger[_0x25d198(0x22f)](_0x25d198(0xfd));return;}logger[_0x25d198(0x22f)](_0x25d198(0x17e)+_0x2da47),dbConfig[_0x25d198(0x273)](_0x25d198(0x1d3))['push']({'botID':_0x2da47,'botname':'Bot\x20'+_0x2da47,'status':_0x25d198(0x12c),'live':''})[_0x25d198(0x262)](),startBot([_0x2da47,userID],{'cwd':bbpath},function(_0x115026){const _0x5751a5=_0x25d198;if(_0x115026)logger[_0x5751a5(0x22f)](_0x115026);}),config=getConfiguration(),io['to'](_0x25d198(0x206))[_0x25d198(0x214)]('bots',config),broadcastToBots(_0x25d198(0x1d3),JSON[_0x25d198(0x15e)](config));}function deleteBot(_0x3e0ab0){const _0x407bb9=_0x40eb46;getClientsWithBotID(_0x3e0ab0)[_0x407bb9(0x1fa)](_0x2f5ed9=>{const _0x2cf3ab=_0x407bb9;getSocket(_0x2f5ed9['id'])[_0x2cf3ab(0x112)](!![]),removeClient(_0x2f5ed9['id']);}),dbConfig[_0x407bb9(0x273)]('bots')[_0x407bb9(0x18f)]({'botID':_0x3e0ab0})['write'](),logger[_0x407bb9(0x22f)]('Deleted\x20Bot\x20'+_0x3e0ab0),stopBot(_0x3e0ab0);try{if(fs['existsSync'](path[_0x407bb9(0x274)](configpath,'bot-'+_0x3e0ab0+_0x407bb9(0x1b3))))fs[_0x407bb9(0x223)](path[_0x407bb9(0x274)](configpath,_0x407bb9(0x16d)+_0x3e0ab0+_0x407bb9(0x1b3)));if(fs['existsSync'](path[_0x407bb9(0x274)](configpath,_0x407bb9(0x16d)+_0x3e0ab0+'-events.json')))fs[_0x407bb9(0x223)](path[_0x407bb9(0x274)](configpath,'bot-'+_0x3e0ab0+_0x407bb9(0x134)));if(fs[_0x407bb9(0x1f9)](path[_0x407bb9(0x274)](configpath,_0x407bb9(0x16d)+_0x3e0ab0+'-performance.json')))fs[_0x407bb9(0x223)](path[_0x407bb9(0x274)](configpath,_0x407bb9(0x16d)+_0x3e0ab0+_0x407bb9(0xe7)));if(fs[_0x407bb9(0x1f9)](path[_0x407bb9(0x274)](configpath,_0x407bb9(0x16d)+_0x3e0ab0+_0x407bb9(0x203))))fs['unlinkSync'](path[_0x407bb9(0x274)](configpath,_0x407bb9(0x16d)+_0x3e0ab0+'-results.json'));}catch(_0xe98c3){if(_0xe98c3)logger[_0x407bb9(0x22f)](_0x407bb9(0x22e),_0xe98c3);}config=getConfiguration(),io['to'](_0x407bb9(0x206))['emit'](_0x407bb9(0x1d3),config),broadcastToBots('bots',JSON[_0x407bb9(0x15e)](config));}function toggleBot(_0x1a0038,_0x54ac8e,_0xa2ae64){const _0x4ee57e=_0x40eb46;dbConfig['get']('bots')['find']({'botID':_0x1a0038})['assign']({'status':_0x54ac8e})[_0x4ee57e(0x1ef)]({'live':_0xa2ae64})['write']();if(_0x54ac8e=='enabled'||_0x54ac8e==_0x4ee57e(0x12c))logger[_0x4ee57e(0x22f)]('Enabled\x20Bot\x20'+_0x1a0038),startBot([_0x1a0038,userID],{'cwd':bbpath},function(_0x402015){const _0x2d3180=_0x4ee57e;if(_0x402015)logger[_0x2d3180(0x22f)](_0x402015);});else(_0x54ac8e==_0x4ee57e(0x151)||_0x54ac8e==_0x4ee57e(0xf3))&&(logger[_0x4ee57e(0x22f)](_0x4ee57e(0x204)+_0x1a0038),stopBot(_0x1a0038));config=getConfiguration(),io['to'](_0x4ee57e(0x206))[_0x4ee57e(0x214)](_0x4ee57e(0x1d3),config),broadcastToBots(_0x4ee57e(0x1d3),JSON[_0x4ee57e(0x15e)](config));}function toggleStatus(_0x5ac71d){const _0x2166f8=_0x40eb46;let _0x48f53c=dbConfig[_0x2166f8(0x273)](_0x2166f8(0x1d3))[_0x2166f8(0x2af)]({'botID':_0x5ac71d})[_0x2166f8(0xf1)](),_0x5b9c2a;if(_0x48f53c[_0x2166f8(0x26c)]===_0x2166f8(0x11b))_0x5b9c2a='disabled';else{if(_0x48f53c[_0x2166f8(0x26c)]===_0x2166f8(0x12c))_0x5b9c2a=_0x2166f8(0xf3);else{if(_0x48f53c[_0x2166f8(0x26c)]===_0x2166f8(0xf3))_0x5b9c2a=_0x2166f8(0x12c);else{if(_0x48f53c['status']===_0x2166f8(0x151))_0x5b9c2a=_0x2166f8(0x11b);}}}return _0x5b9c2a;}function updateStatus(_0x1e6b5c,_0x1ef108){const _0x40243a=_0x40eb46;dbConfig[_0x40243a(0x273)](_0x40243a(0x1d3))['find']({'botID':_0x1e6b5c})[_0x40243a(0x1ef)]({'status':_0x1ef108})[_0x40243a(0x262)](),config=getConfiguration(),io['to'](_0x40243a(0x206))[_0x40243a(0x214)](_0x40243a(0x1d3),config),broadcastToBots(_0x40243a(0x1d3),JSON[_0x40243a(0x15e)](config));}function updateLive(_0x3a9fde,_0x463b4e){const _0x1d09e5=_0x40eb46;dbConfig['get'](_0x1d09e5(0x1d3))[_0x1d09e5(0x2af)]({'botID':_0x3a9fde})[_0x1d09e5(0x1ef)]({'live':_0x463b4e})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x1d09e5(0x214)](_0x1d09e5(0x1d3),config),broadcastToBots('bots',JSON[_0x1d09e5(0x15e)](config));}function updateBotName(_0x233c5f,_0x3a6995){const _0x256d69=_0x40eb46;dbConfig[_0x256d69(0x273)](_0x256d69(0x1d3))[_0x256d69(0x2af)]({'botID':_0x233c5f})['assign']({'botname':_0x3a6995})[_0x256d69(0x262)](),config=getConfiguration(),io['to']('botmanager')[_0x256d69(0x214)]('bots',config),broadcastToBots(_0x256d69(0x1d3),JSON['stringify'](config));}function updateBotManager(){const _0x431819=_0x40eb46;config=getConfiguration(),io['to']('botmanager')[_0x431819(0x214)](_0x431819(0x1d3),config),broadcastToBots(_0x431819(0x1d3),JSON[_0x431819(0x15e)](config));}function toggleBotMode(_0x8cd466){const _0x3794ae=_0x40eb46;if(pid[_0x8cd466])pid[_0x8cd466]['send']({'function':_0x3794ae(0x1fb),'args':null});else{const _0x452bad=configpath+_0x3794ae(0x16d)+_0x8cd466+_0x3794ae(0x1b3),_0x4b6517=fs[_0x3794ae(0x2a6)](_0x452bad),_0x1e41d7=JSON[_0x3794ae(0x21b)](_0x4b6517),_0x423f01=_0x1e41d7[_0x3794ae(0x238)][0x0]['headless'];_0x1e41d7[_0x3794ae(0x238)][0x0]['headless']=!_0x423f01;const _0x36ae80=JSON[_0x3794ae(0x15e)](_0x1e41d7,null,0x2);fs[_0x3794ae(0x2c2)](_0x452bad,_0x36ae80),config=getConfiguration(),io['to']('botmanager')[_0x3794ae(0x214)](_0x3794ae(0x1d3),config),broadcastToBots(_0x3794ae(0x1d3),JSON[_0x3794ae(0x15e)](config));}}function telegramError(_0x341638){const _0x3f5a1a=_0x40eb46;logger[_0x3f5a1a(0x258)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x453c38){const _0x2eaae9=_0x40eb46;if(_0x453c38[_0x2eaae9(0x261)][_0x2eaae9(0x202)]!=settings[_0x2eaae9(0x20a)]&&'@'+_0x453c38[_0x2eaae9(0x261)]['username']!=settings[_0x2eaae9(0x20a)])return tgBot['sendMessage'](_0x453c38['chat']['id'],_0x2eaae9(0x1b7),{'parse_mode':_0x2eaae9(0x164)})[_0x2eaae9(0x27b)](_0xacd89c=>{telegramError(_0xacd89c);}),![];return!![];}async function initTelegram(){const _0x1d85c6=_0x40eb46;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x1bb282=_0x1d85c6(0x2b1);_0x1bb282+='\x0a',_0x1bb282+='/enable\x20-\x20enable\x20notifications\x0a',_0x1bb282+=_0x1d85c6(0x1f8),_0x1bb282+=_0x1d85c6(0x267),_0x1bb282+=_0x1d85c6(0x2be),_0x1bb282+=_0x1d85c6(0x23f),_0x1bb282+=_0x1d85c6(0x279),_0x1bb282+=_0x1d85c6(0x24d),_0x1bb282+='/names\x20-\x20show\x20bot\x20names\x0a',_0x1bb282+=_0x1d85c6(0x2c0),_0x1bb282+=_0x1d85c6(0x157),_0x1bb282+=_0x1d85c6(0x1af),_0x1bb282+=_0x1d85c6(0x27c),_0x1bb282+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x1bb282+=_0x1d85c6(0x1cb);let _0x1556d9='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1556d9+='\x0a',_0x1556d9+=_0x1bb282,tgBot[_0x1d85c6(0x104)](/\/start/,_0x14660c=>{const _0x4bf2c0=_0x1d85c6;if(!validateTelegram(_0x14660c))return;if(settings[_0x4bf2c0(0x17f)]!=_0x14660c[_0x4bf2c0(0x167)]['id'])updateSetting('telegramChatId',_0x14660c[_0x4bf2c0(0x167)]['id']);updateSetting(_0x4bf2c0(0x276),!![]),tgBot[_0x4bf2c0(0x109)](_0x14660c['chat']['id'],_0x1556d9)[_0x4bf2c0(0x27b)](_0x42640e=>{telegramError(_0x42640e);});}),tgBot[_0x1d85c6(0x104)](/\/enable/,_0x110d00=>{const _0x463c49=_0x1d85c6;if(!validateTelegram(_0x110d00))return;if(settings[_0x463c49(0x17f)]!=_0x110d00[_0x463c49(0x167)]['id'])updateSetting(_0x463c49(0x17f),_0x110d00[_0x463c49(0x167)]['id']);updateSetting(_0x463c49(0x276),!![]),tgBot[_0x463c49(0x109)](_0x110d00[_0x463c49(0x167)]['id'],'Notifications\x20enabled')[_0x463c49(0x27b)](_0x24f645=>{telegramError(_0x24f645);});}),tgBot['onText'](/\/config/,async _0x587c7b=>{const _0x1fa2aa=_0x1d85c6;if(!validateTelegram(_0x587c7b))return;tgBot['removeListener']('callback_query'),tgBot[_0x1fa2aa(0x109)](_0x587c7b[_0x1fa2aa(0x167)]['id'],_0x1fa2aa(0x175),{'reply_markup':{'inline_keyboard':[[{'text':_0x1fa2aa(0x27f),'callback_data':'orders'},{'text':_0x1fa2aa(0x108),'callback_data':_0x1fa2aa(0x13d)},{'text':_0x1fa2aa(0x14f),'callback_data':'all'}]]}})['catch'](_0x426cb6=>{telegramError(_0x426cb6);}),tgBot['on'](_0x1fa2aa(0x194),async _0xf54279=>{const _0x377b87=_0x1fa2aa,_0x1b6879=_0xf54279[_0x377b87(0x106)],_0x2ccba8=_0xf54279[_0x377b87(0x227)];tgBot[_0x377b87(0x1dd)](_0xf54279['id'])[_0x377b87(0x28b)](async()=>{const _0x1f19ec=_0x377b87;_0x1b6879==_0x1f19ec(0x13e)&&(updateSetting('telegramEvents',_0x1f19ec(0x13e)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x2ccba8[_0x1f19ec(0x167)]['id'],_0x1f19ec(0x16f))['catch'](_0x234cf5=>{telegramError(_0x234cf5);}));_0x1b6879==_0x1f19ec(0x13d)&&(updateSetting(_0x1f19ec(0x23a),_0x1f19ec(0x13d)),updateSetting(_0x1f19ec(0x276),!![]),await tgBot['sendMessage'](_0x2ccba8['chat']['id'],_0x1f19ec(0x133))[_0x1f19ec(0x27b)](_0x3ad1fd=>{telegramError(_0x3ad1fd);}));_0x1b6879=='all'&&(updateSetting('telegramEvents',_0x1f19ec(0x205)),updateSetting(_0x1f19ec(0x276),!![]),await tgBot['sendMessage'](_0x2ccba8[_0x1f19ec(0x167)]['id'],_0x1f19ec(0x29f))['catch'](_0x50b7b8=>{telegramError(_0x50b7b8);}));if(!settings[_0x1f19ec(0x17f)])tgBot[_0x1f19ec(0x109)](_0x2ccba8[_0x1f19ec(0x167)]['id'],_0x1f19ec(0x11f))[_0x1f19ec(0x27b)](_0x3e0dd9=>{telegramError(_0x3e0dd9);});}),tgBot[_0x377b87(0x1d1)](_0x377b87(0x194));});}),tgBot['onText'](/\/status/,_0xe27a56=>{const _0x210732=_0x1d85c6;if(!validateTelegram(_0xe27a56))return;const _0x56c0bc=getBotsWithMode();let _0x323b3b='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x210732(0x1fa)](_0x16f80f=>{const _0x36f61c=_0x210732,_0x3a6485=_0x56c0bc[_0x36f61c(0x2af)](_0x341e2c=>_0x341e2c[_0x36f61c(0x18e)]==_0x16f80f[_0x36f61c(0x18e)])[_0x36f61c(0x1c0)];_0x323b3b+=_0x36f61c(0x285)+_0x16f80f[_0x36f61c(0x18e)]+':\x20'+_0x16f80f[_0x36f61c(0x26c)]+_0x36f61c(0x150)+_0x3a6485+'\x20|\x20'+_0x16f80f[_0x36f61c(0x141)]+'\x0a';}),_0x323b3b+='\x0a',_0x323b3b+=_0x210732(0x1f6),_0x323b3b+=!settings['telegramEnabled']?_0x210732(0x1c7):_0x210732(0x1d8),_0x323b3b+=settings[_0x210732(0x276)]?settings['telegramEvents']=='all'?_0x210732(0x2a4):_0x210732(0x299)+settings[_0x210732(0x23a)]+'\x20only\x0a':'',tgBot['sendMessage'](_0xe27a56[_0x210732(0x167)]['id'],_0x323b3b,{'parse_mode':_0x210732(0x164)})[_0x210732(0x27b)](_0x4e578f=>{telegramError(_0x4e578f);});}),tgBot[_0x1d85c6(0x104)](/\/restart/,_0x561618=>{const _0x2e1b09=_0x1d85c6;if(!validateTelegram(_0x561618))return;tgBot[_0x2e1b09(0x1d1)](_0x2e1b09(0x194));const _0x20a175=getEnabledBots();if(_0x20a175['length']==0x0)tgBot[_0x2e1b09(0x109)](_0x561618['chat']['id'],_0x2e1b09(0x197))['catch'](_0x3f9059=>{telegramError(_0x3f9059);});else{if(_0x20a175[_0x2e1b09(0x24a)]>0x1)_0x20a175[_0x2e1b09(0x185)]({'botID':_0x2e1b09(0x205)});let _0x353899=[],_0x2e397a=[];const _0x5e39cb=_0x20a175[_0x2e1b09(0x24a)]%0x4==0x0||_0x20a175['length']%0x4==0x3||_0x20a175['length']%0x3==0x1?0x4:0x3;let _0x2cbd07=0x0;_0x20a175[_0x2e1b09(0x1fa)]((_0x3bf303,_0x72dddf)=>{const _0x45c5c1=_0x2e1b09;if(_0x72dddf%_0x5e39cb==0x0)_0x2e397a=[];_0x2e397a[_0x45c5c1(0x185)]({'text':_0x3bf303[_0x45c5c1(0x18e)]=='all'?_0x45c5c1(0x142):_0x45c5c1(0x285)+_0x3bf303[_0x45c5c1(0x18e)],'callback_data':_0x3bf303[_0x45c5c1(0x18e)]}),_0x72dddf%_0x5e39cb==0x0&&(_0x353899[_0x2cbd07]=_0x2e397a,_0x2cbd07++);}),tgBot[_0x2e1b09(0x109)](_0x561618[_0x2e1b09(0x167)]['id'],_0x2e1b09(0x1f0),{'reply_markup':{'inline_keyboard':_0x353899}})['catch'](_0x37d6ff=>{telegramError(_0x37d6ff);}),tgBot['on'](_0x2e1b09(0x194),async _0x245662=>{const _0xa4e824=_0x2e1b09,_0x5d61aa=_0x245662[_0xa4e824(0x106)],_0x250c77=_0x245662[_0xa4e824(0x227)];tgBot[_0xa4e824(0x1dd)](_0x245662['id'])['then'](async()=>{const _0x3e962e=_0xa4e824;_0x5d61aa==_0x3e962e(0x205)?config[_0x3e962e(0x1fa)](_0x502e2f=>{const _0x58acc0=_0x3e962e;restartBot(_0x502e2f[_0x58acc0(0x18e)]);}):restartBot(_0x5d61aa);}),tgBot['removeListener'](_0xa4e824(0x194));});}}),tgBot[_0x1d85c6(0x104)](/\/on/,_0x564c6f=>{const _0x1a055d=_0x1d85c6;if(!validateTelegram(_0x564c6f))return;tgBot[_0x1a055d(0x1d1)](_0x1a055d(0x194));const _0x52056d=getDisabledBots();if(_0x52056d[_0x1a055d(0x24a)]==0x0)tgBot[_0x1a055d(0x109)](_0x564c6f['chat']['id'],_0x1a055d(0x11d))[_0x1a055d(0x27b)](_0x3baf86=>{telegramError(_0x3baf86);});else{if(_0x52056d[_0x1a055d(0x24a)]>0x1)_0x52056d[_0x1a055d(0x185)]({'botID':_0x1a055d(0x205)});let _0x23febf=[],_0x2535f1=[];const _0x5817a0=_0x52056d[_0x1a055d(0x24a)]%0x4==0x0||_0x52056d[_0x1a055d(0x24a)]%0x4==0x3||_0x52056d[_0x1a055d(0x24a)]%0x3==0x1?0x4:0x3;let _0x2e6aff=0x0;_0x52056d[_0x1a055d(0x1fa)]((_0x5dc6fe,_0xa00a22)=>{const _0x4ff771=_0x1a055d;if(_0xa00a22%_0x5817a0==0x0)_0x2535f1=[];_0x2535f1[_0x4ff771(0x185)]({'text':_0x5dc6fe[_0x4ff771(0x18e)]==_0x4ff771(0x205)?_0x4ff771(0x142):_0x4ff771(0x285)+_0x5dc6fe[_0x4ff771(0x18e)],'callback_data':_0x5dc6fe[_0x4ff771(0x18e)]}),_0xa00a22%_0x5817a0==0x0&&(_0x23febf[_0x2e6aff]=_0x2535f1,_0x2e6aff++);}),tgBot['sendMessage'](_0x564c6f['chat']['id'],_0x1a055d(0x278),{'reply_markup':{'inline_keyboard':_0x23febf}})[_0x1a055d(0x27b)](_0x528086=>{telegramError(_0x528086);}),tgBot['on'](_0x1a055d(0x194),async _0x1e4ab5=>{const _0x20d962=_0x1a055d,_0x2598f3=_0x1e4ab5['data'],_0x1f346b=_0x1e4ab5[_0x20d962(0x227)];tgBot['answerCallbackQuery'](_0x1e4ab5['id'])[_0x20d962(0x28b)](async()=>{const _0x2733ef=_0x20d962;_0x2598f3==_0x2733ef(0x205)?(tgBot['sendMessage'](_0x1f346b[_0x2733ef(0x167)]['id'],_0x2733ef(0x28f))[_0x2733ef(0x27b)](_0x560d67=>{telegramError(_0x560d67);}),_0x52056d[_0x2733ef(0x1fa)](_0x3c4734=>{const _0x5c2f98=_0x2733ef;if(_0x3c4734[_0x5c2f98(0x18e)]!=_0x5c2f98(0x205))toggleBot(_0x3c4734[_0x5c2f98(0x18e)],toggleStatus(_0x3c4734['botID']),'stopped');})):(tgBot[_0x2733ef(0x109)](_0x1f346b['chat']['id'],_0x2733ef(0x176)+_0x2598f3)[_0x2733ef(0x27b)](_0x5959c3=>{telegramError(_0x5959c3);}),toggleBot(_0x2598f3,toggleStatus(_0x2598f3),'stopped'));}),tgBot[_0x20d962(0x1d1)](_0x20d962(0x194));});}}),tgBot[_0x1d85c6(0x104)](/\/off/,_0x5f548d=>{const _0x7226dc=_0x1d85c6;if(!validateTelegram(_0x5f548d))return;tgBot[_0x7226dc(0x1d1)]('callback_query');const _0x35244d=getEnabledBots();if(_0x35244d[_0x7226dc(0x24a)]==0x0)tgBot[_0x7226dc(0x109)](_0x5f548d['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x7226dc(0x27b)](_0x466a37=>{telegramError(_0x466a37);});else{if(_0x35244d['length']>0x1)_0x35244d[_0x7226dc(0x185)]({'botID':_0x7226dc(0x205)});let _0x38e851=[],_0x3ab05a=[];const _0x23f5a3=_0x35244d[_0x7226dc(0x24a)]%0x4==0x0||_0x35244d[_0x7226dc(0x24a)]%0x4==0x3||_0x35244d[_0x7226dc(0x24a)]%0x3==0x1?0x4:0x3;let _0x3cfe12=0x0;_0x35244d[_0x7226dc(0x1fa)]((_0x43a00c,_0xc3068d)=>{const _0x400996=_0x7226dc;if(_0xc3068d%_0x23f5a3==0x0)_0x3ab05a=[];_0x3ab05a[_0x400996(0x185)]({'text':_0x43a00c[_0x400996(0x18e)]==_0x400996(0x205)?_0x400996(0x142):_0x400996(0x285)+_0x43a00c[_0x400996(0x18e)],'callback_data':_0x43a00c['botID']}),_0xc3068d%_0x23f5a3==0x0&&(_0x38e851[_0x3cfe12]=_0x3ab05a,_0x3cfe12++);}),tgBot[_0x7226dc(0x109)](_0x5f548d[_0x7226dc(0x167)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x38e851}})[_0x7226dc(0x27b)](_0xb709f9=>{telegramError(_0xb709f9);}),tgBot['on']('callback_query',async _0x2ad197=>{const _0x4a0f74=_0x7226dc,_0x1d2faa=_0x2ad197[_0x4a0f74(0x106)],_0xebdd05=_0x2ad197[_0x4a0f74(0x227)];tgBot['answerCallbackQuery'](_0x2ad197['id'])[_0x4a0f74(0x28b)](async()=>{const _0x1483bd=_0x4a0f74;_0x1d2faa==_0x1483bd(0x205)?(tgBot[_0x1483bd(0x109)](_0xebdd05[_0x1483bd(0x167)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x1483bd(0x27b)](_0x33d2c1=>{telegramError(_0x33d2c1);}),_0x35244d[_0x1483bd(0x1fa)](_0x40ed3d=>{const _0x3c4296=_0x1483bd;if(_0x40ed3d[_0x3c4296(0x18e)]!=_0x3c4296(0x205))toggleBot(_0x40ed3d[_0x3c4296(0x18e)],toggleStatus(_0x40ed3d[_0x3c4296(0x18e)]),_0x3c4296(0x1e1));})):(tgBot[_0x1483bd(0x109)](_0xebdd05[_0x1483bd(0x167)]['id'],_0x1483bd(0x1d5)+_0x1d2faa)[_0x1483bd(0x27b)](_0x3db436=>{telegramError(_0x3db436);}),toggleBot(_0x1d2faa,toggleStatus(_0x1d2faa),'stopped'));}),tgBot[_0x4a0f74(0x1d1)]('callback_query');});}}),tgBot['onText'](/\/metrics/,_0xca26ce=>{const _0x5adffc=_0x1d85c6;if(!validateTelegram(_0xca26ce))return;tgBot[_0x5adffc(0x1d1)](_0x5adffc(0x194));const _0xb82346=getEnabledBots();if(_0xb82346[_0x5adffc(0x24a)]==0x0)tgBot['sendMessage'](_0xca26ce['chat']['id'],_0x5adffc(0x197))[_0x5adffc(0x27b)](_0x25a18e=>{telegramError(_0x25a18e);});else{if(_0xb82346[_0x5adffc(0x24a)]>0x1){let _0x8e4887=[],_0x50a373=[];const _0x4320bb=_0xb82346[_0x5adffc(0x24a)]%0x4==0x0||_0xb82346['length']%0x4==0x3||_0xb82346[_0x5adffc(0x24a)]%0x3==0x1?0x4:0x3;let _0x4ec9f5=0x0;_0xb82346[_0x5adffc(0x1fa)]((_0x40bfb4,_0x25c008)=>{const _0x36c648=_0x5adffc;if(_0x25c008%_0x4320bb==0x0)_0x50a373=[];_0x50a373[_0x36c648(0x185)]({'text':_0x36c648(0x285)+_0x40bfb4[_0x36c648(0x18e)],'callback_data':_0x40bfb4['botID']}),_0x25c008%_0x4320bb==0x0&&(_0x8e4887[_0x4ec9f5]=_0x50a373,_0x4ec9f5++);}),tgBot[_0x5adffc(0x109)](_0xca26ce[_0x5adffc(0x167)]['id'],_0x5adffc(0x126),{'reply_markup':{'inline_keyboard':_0x8e4887}})[_0x5adffc(0x27b)](_0x5ddbae=>{telegramError(_0x5ddbae);}),tgBot['on'](_0x5adffc(0x194),async _0x7d97b=>{const _0x50074d=_0x5adffc,_0xf5deac=_0x7d97b['data'],_0x46a712=_0x7d97b[_0x50074d(0x227)];tgBot['answerCallbackQuery'](_0x7d97b['id'])[_0x50074d(0x28b)](async()=>{const _0x2e9a19=_0x50074d;if(pid[_0xf5deac])pid[_0xf5deac]['send']({'function':_0x2e9a19(0x283),'args':null});}),tgBot[_0x50074d(0x1d1)](_0x50074d(0x194));});}else{const _0xa16bd1=_0xb82346[0x0][_0x5adffc(0x18e)];if(pid[_0xa16bd1])pid[_0xa16bd1][_0x5adffc(0x170)]({'function':_0x5adffc(0x283),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x1c7e71=>{const _0x23691d=_0x1d85c6;if(!validateTelegram(_0x1c7e71))return;tgBot[_0x23691d(0x1d1)](_0x23691d(0x194));const _0x57d728=getEnabledBots();if(_0x57d728[_0x23691d(0x24a)]==0x0)tgBot['sendMessage'](_0x1c7e71['chat']['id'],_0x23691d(0x197))[_0x23691d(0x27b)](_0x251448=>{telegramError(_0x251448);});else{if(_0x57d728[_0x23691d(0x24a)]>0x1){let _0x3cb4ea=[],_0xa9c157=[];const _0x4ef4cc=_0x57d728[_0x23691d(0x24a)]%0x4==0x0||_0x57d728[_0x23691d(0x24a)]%0x4==0x3||_0x57d728[_0x23691d(0x24a)]%0x3==0x1?0x4:0x3;let _0x453303=0x0;_0x57d728[_0x23691d(0x1fa)]((_0x1e643b,_0xb2d8cb)=>{const _0x15657e=_0x23691d;if(_0xb2d8cb%_0x4ef4cc==0x0)_0xa9c157=[];_0xa9c157[_0x15657e(0x185)]({'text':'Bot\x20'+_0x1e643b[_0x15657e(0x18e)],'callback_data':_0x1e643b[_0x15657e(0x18e)]}),_0xb2d8cb%_0x4ef4cc==0x0&&(_0x3cb4ea[_0x453303]=_0xa9c157,_0x453303++);}),tgBot[_0x23691d(0x109)](_0x1c7e71[_0x23691d(0x167)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x3cb4ea}})[_0x23691d(0x27b)](_0x4ae659=>{telegramError(_0x4ae659);}),tgBot['on']('callback_query',async _0x106f4a=>{const _0x46c83f=_0x23691d,_0x204d14=_0x106f4a[_0x46c83f(0x106)],_0x9544a1=_0x106f4a[_0x46c83f(0x227)];tgBot[_0x46c83f(0x1dd)](_0x106f4a['id'])[_0x46c83f(0x28b)](async()=>{const _0x298eae=_0x46c83f;if(pid[_0x204d14])pid[_0x204d14][_0x298eae(0x170)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x58438e=_0x57d728[0x0][_0x23691d(0x18e)];if(pid[_0x58438e])pid[_0x58438e][_0x23691d(0x170)]({'function':_0x23691d(0x220),'args':null});}}}),tgBot[_0x1d85c6(0x104)](/\/update/,async _0x5c53b7=>{const _0x5f274f=_0x1d85c6;if(!validateTelegram(_0x5c53b7))return;tgBot[_0x5f274f(0x1d1)](_0x5f274f(0x194)),await getMessages();if(!updateAvailable)tgBot[_0x5f274f(0x109)](_0x5c53b7[_0x5f274f(0x167)]['id'],_0x5f274f(0x1c8))['catch'](_0x1d73f5=>{telegramError(_0x1d73f5);});else!validInstallation?tgBot[_0x5f274f(0x109)](_0x5c53b7[_0x5f274f(0x167)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x5f274f(0x27b)](_0x208135=>{telegramError(_0x208135);}):(tgBot[_0x5f274f(0x109)](_0x5c53b7[_0x5f274f(0x167)]['id'],_0x5f274f(0x12b),{'reply_markup':{'inline_keyboard':[[{'text':_0x5f274f(0xf8),'callback_data':_0x5f274f(0x2b2)},{'text':'No','callback_data':'no'}]]}})[_0x5f274f(0x27b)](_0x553173=>{telegramError(_0x553173);}),tgBot['on']('callback_query',async _0xb822d4=>{const _0x36a750=_0x5f274f,_0x1eb7fa=_0xb822d4[_0x36a750(0x106)],_0x17c9ad=_0xb822d4[_0x36a750(0x227)];tgBot[_0x36a750(0x1dd)](_0xb822d4['id'])[_0x36a750(0x28b)](async()=>{const _0x3b9687=_0x36a750;_0x1eb7fa=='yes'&&(await tgBot[_0x3b9687(0x109)](_0x17c9ad[_0x3b9687(0x167)]['id'],_0x3b9687(0x25a))[_0x3b9687(0x27b)](_0x287748=>{telegramError(_0x287748);}),updateBB(_0x3b9687(0x26b))),_0x1eb7fa=='no'&&await tgBot[_0x3b9687(0x109)](_0x17c9ad['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x3b9687(0x27b)](_0x21977f=>{telegramError(_0x21977f);});}),tgBot[_0x36a750(0x1d1)](_0x36a750(0x194));}));}),tgBot['onText'](/\/reinstall/,async _0x2cfded=>{const _0x4ad8df=_0x1d85c6;if(!validateTelegram(_0x2cfded))return;tgBot['removeListener'](_0x4ad8df(0x194)),!validInstallation?tgBot[_0x4ad8df(0x109)](_0x2cfded['chat']['id'],_0x4ad8df(0x229))[_0x4ad8df(0x27b)](_0x12c1fc=>{telegramError(_0x12c1fc);}):(tgBot[_0x4ad8df(0x109)](_0x2cfded[_0x4ad8df(0x167)]['id'],_0x4ad8df(0x13f),{'reply_markup':{'inline_keyboard':[[{'text':_0x4ad8df(0xf8),'callback_data':_0x4ad8df(0x2b2)},{'text':'No','callback_data':'no'}]]}})[_0x4ad8df(0x27b)](_0x5e65f7=>{telegramError(_0x5e65f7);}),tgBot['on'](_0x4ad8df(0x194),async _0x450e49=>{const _0x1f2827=_0x4ad8df,_0x454330=_0x450e49[_0x1f2827(0x106)],_0x18aec9=_0x450e49[_0x1f2827(0x227)];tgBot[_0x1f2827(0x1dd)](_0x450e49['id'])[_0x1f2827(0x28b)](async()=>{const _0x556949=_0x1f2827;_0x454330==_0x556949(0x2b2)&&(await tgBot['sendMessage'](_0x18aec9[_0x556949(0x167)]['id'],_0x556949(0x101))[_0x556949(0x27b)](_0x2fdd62=>{telegramError(_0x2fdd62);}),updateBB(_0x556949(0x129))),_0x454330=='no'&&await tgBot[_0x556949(0x109)](_0x18aec9['chat']['id'],_0x556949(0x130))[_0x556949(0x27b)](_0x57f704=>{telegramError(_0x57f704);});}),tgBot[_0x1f2827(0x1d1)]('callback_query');}));}),tgBot[_0x1d85c6(0x104)](/\/toggle/,_0x228b62=>{const _0x30e4a0=_0x1d85c6;if(!validateTelegram(_0x228b62))return;tgBot['removeListener'](_0x30e4a0(0x194));const _0x3bffe5=getBotsWithMode();if(_0x3bffe5[_0x30e4a0(0x24a)]==0x0)tgBot['sendMessage'](_0x228b62[_0x30e4a0(0x167)]['id'],_0x30e4a0(0x197))['catch'](_0x17dc81=>{telegramError(_0x17dc81);});else{let _0x17edcb=[],_0x305674=[];const _0x123d16=0x2;let _0x45d009=0x0;_0x3bffe5[_0x30e4a0(0x1fa)]((_0x1bfd06,_0x49c540)=>{const _0x1c6f94=_0x30e4a0;if(_0x49c540%_0x123d16==0x0)_0x305674=[];_0x305674[_0x1c6f94(0x185)]({'text':_0x1c6f94(0x285)+_0x1bfd06[_0x1c6f94(0x18e)]+'\x20('+_0x1bfd06[_0x1c6f94(0x1c0)]+')','callback_data':_0x1bfd06['botID']}),_0x49c540%_0x123d16==0x0&&(_0x17edcb[_0x45d009]=_0x305674,_0x45d009++);}),tgBot[_0x30e4a0(0x109)](_0x228b62[_0x30e4a0(0x167)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x17edcb}})['catch'](_0x453713=>{telegramError(_0x453713);}),tgBot['on']('callback_query',async _0x33463e=>{const _0x578a53=_0x30e4a0,_0x1806c1=_0x33463e[_0x578a53(0x106)],_0x2459d2=_0x33463e[_0x578a53(0x227)];tgBot['answerCallbackQuery'](_0x33463e['id'])[_0x578a53(0x28b)](async()=>{const _0x5ed5af=_0x578a53,_0x3a5ac8=_0x3bffe5[_0x5ed5af(0x2af)](_0x45e283=>_0x45e283[_0x5ed5af(0x18e)]==_0x1806c1),_0x58d9c7=_0x3a5ac8[_0x5ed5af(0x1c0)]==_0x5ed5af(0x2a2)?'manual':'auto';tgBot[_0x5ed5af(0x109)](_0x2459d2['chat']['id'],_0x5ed5af(0x103)+_0x1806c1+_0x5ed5af(0x125)+_0x58d9c7+_0x5ed5af(0x191))['catch'](_0x1b5ac2=>{telegramError(_0x1b5ac2);}),toggleBotMode(_0x1806c1);}),tgBot[_0x578a53(0x1d1)](_0x578a53(0x194));});}}),tgBot[_0x1d85c6(0x104)](/\/names/,_0x2bb409=>{const _0x279363=_0x1d85c6;if(!validateTelegram(_0x2bb409))return;let _0x2cc5a1='';config[_0x279363(0x1fa)](_0x2aac8d=>{const _0x5eb061=_0x279363;_0x2cc5a1+=_0x5eb061(0x285)+_0x2aac8d[_0x5eb061(0x18e)]+':\x20'+_0x2aac8d['botname']+'\x0a';}),tgBot[_0x279363(0x109)](_0x2bb409[_0x279363(0x167)]['id'],_0x2cc5a1,{'parse_mode':'HTML'})[_0x279363(0x27b)](_0x4e5630=>{telegramError(_0x4e5630);});}),tgBot[_0x1d85c6(0x104)](/\/disable/,_0xff8833=>{const _0x19c657=_0x1d85c6;if(!validateTelegram(_0xff8833))return;tgBot['sendMessage'](_0xff8833[_0x19c657(0x167)]['id'],_0x19c657(0x291))[_0x19c657(0x27b)](_0x4d6a84=>{telegramError(_0x4d6a84);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x1d85c6(0x104)](/\/help/,_0x6dffbd=>{const _0x56a07f=_0x1d85c6;if(!validateTelegram(_0x6dffbd))return;tgBot[_0x56a07f(0x109)](_0x6dffbd[_0x56a07f(0x167)]['id'],_0x1bb282)[_0x56a07f(0x27b)](_0x2e2cb1=>{telegramError(_0x2e2cb1);});}),tgBot['on'](_0x1d85c6(0x265),_0x785b63=>{const _0x4f03ac=_0x1d85c6;_0x785b63[_0x4f03ac(0x158)]()[_0x4f03ac(0x1cc)](_0x4f03ac(0xea))&&(logger[_0x4f03ac(0x22f)]('Invalid\x20Telegram\x20token'),tgBot[_0x4f03ac(0x180)](),tgBot=null,io['to'](_0x4f03ac(0x206))[_0x4f03ac(0x214)](_0x4f03ac(0x1cf),'Invalid\x20Telegram\x20token'));}),process[_0x1d85c6(0x236)]('SIGINT',()=>{const _0x3bc498=_0x1d85c6;if(tgBot)tgBot['stopPolling']();process[_0x3bc498(0x17c)](0x1);}),process[_0x1d85c6(0x236)](_0x1d85c6(0x2aa),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x181cd4,_0x2a2f03){const _0x671d6=_0x40eb46;if(settings['telegramEnabled']){if(settings[_0x671d6(0x23a)]=='all'||(_0x2a2f03[_0x671d6(0x14c)]==_0x671d6(0x153)||_0x2a2f03[_0x671d6(0x14c)]==_0x671d6(0x2c4)||_0x2a2f03[_0x671d6(0x14c)]==_0x671d6(0x113))&&settings['telegramEvents']==_0x671d6(0x13d)||_0x2a2f03[_0x671d6(0x14c)]==_0x671d6(0x1ea)&&settings[_0x671d6(0x23a)]==_0x671d6(0x13e)){if(tgBot&&settings['telegramChatId']){if(_0x2a2f03['showname'])tgBot['sendMessage'](settings[_0x671d6(0x17f)],_0x2a2f03['botname']+_0x671d6(0x256)+_0x2a2f03[_0x671d6(0x123)])[_0x671d6(0x27b)](_0x358df9=>{telegramError(_0x358df9);});else tgBot[_0x671d6(0x109)](settings[_0x671d6(0x17f)],_0x671d6(0x285)+_0x181cd4+_0x671d6(0x256)+_0x2a2f03[_0x671d6(0x123)])['catch'](_0x4efd68=>{telegramError(_0x4efd68);});}}}}async function sendTelegramMsg(_0x2a22d0,_0x12d150=_0x40eb46(0x164)){const _0x4ea3a9=_0x40eb46;return settings[_0x4ea3a9(0x276)]&&tgBot&&settings[_0x4ea3a9(0x17f)]?(await tgBot[_0x4ea3a9(0x109)](settings['telegramChatId'],_0x2a22d0,{'parse_mode':_0x12d150})['catch'](_0x1f2fea=>{telegramError(_0x1f2fea);}),!![]):![];}function getDeviceWithIp(_0x2be587){const _0x22e4f1=_0x40eb46;return devices[_0x22e4f1(0x2af)](_0x3f1b1a=>_0x3f1b1a['ip']===_0x2be587);}function temporaryAccess2FA(_0x1a1415,_0x2c6eb4){const _0x18f377=_0x40eb46;let _0x260564=new Date(),_0x59e3ff=![];if(lastIpApproval){if(_0x260564-lastIpApproval<0x1388)_0x59e3ff=!![];}lastIpApproval=new Date();if(_0x59e3ff)return;tgBot&&settings[_0x18f377(0x17f)]&&(tgBot[_0x18f377(0x1d1)](_0x18f377(0x194)),tgBot[_0x18f377(0x109)](settings['telegramChatId'],_0x18f377(0x29a)+normalizeIP(_0x2c6eb4)[_0x18f377(0x239)]+_0x18f377(0x234),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x18f377(0x235),'callback_data':'5'},{'text':_0x18f377(0x24e),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':_0x18f377(0x1d2)}]]}})[_0x18f377(0x27b)](_0x3160f7=>{telegramError(_0x3160f7);}),tgBot['on'](_0x18f377(0x194),async _0x10e52f=>{const _0xf6d893=_0x18f377,_0x543c86=_0x10e52f[_0xf6d893(0x106)],_0x4a9f5d=_0x10e52f[_0xf6d893(0x227)];tgBot[_0xf6d893(0x1dd)](_0x10e52f['id'])[_0xf6d893(0x28b)](async()=>{const _0x929f46=_0xf6d893;devices[_0x1a1415]['telegramIpApproval']={'clientip':_0x2c6eb4,'timestamp':new Date()[_0x929f46(0x18a)](),'expiry':_0x543c86},_0x543c86!=_0x929f46(0x1d2)?(await tgBot[_0x929f46(0x109)](_0x4a9f5d['chat']['id'],_0x929f46(0x19f)+_0x543c86+_0x929f46(0x1dc),{'parse_mode':_0x929f46(0x164)})[_0x929f46(0x27b)](_0x43bbe7=>{telegramError(_0x43bbe7);}),io['to'](_0x1a1415)[_0x929f46(0x214)](_0x929f46(0x26c),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x929f46(0x109)](_0x4a9f5d[_0x929f46(0x167)]['id'],_0x929f46(0xec))['catch'](_0x2f8750=>{telegramError(_0x2f8750);}),io['to'](_0x1a1415)[_0x929f46(0x214)]('status',{'access':{'allow':![],'reason':_0x929f46(0x10a),'token':null}}));}),tgBot[_0xf6d893(0x1d1)](_0xf6d893(0x194));}));}function loginAccess2FA(_0x30c162,_0x59b9e8){const _0x36e352=_0x40eb46;tgBot&&settings[_0x36e352(0x17f)]&&(tgBot[_0x36e352(0x1d1)]('callback_query'),tgBot[_0x36e352(0x109)](settings['telegramChatId'],_0x36e352(0x22d)+normalizeIP(_0x59b9e8)['show']+_0x36e352(0x234),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x36e352(0x1d2),'callback_data':_0x36e352(0x1d2)}]]}})['catch'](_0x573a81=>{telegramError(_0x573a81);}),tgBot['on'](_0x36e352(0x194),async _0x340a36=>{const _0x3deb85=_0x36e352,_0x1f1c23=_0x340a36[_0x3deb85(0x106)],_0x1499ee=_0x340a36['message'];tgBot[_0x3deb85(0x1dd)](_0x340a36['id'])[_0x3deb85(0x28b)](async()=>{const _0x919e5c=_0x3deb85;devices[_0x30c162][_0x919e5c(0x156)]={'clientip':_0x59b9e8,'timestamp':new Date()[_0x919e5c(0x18a)](),'expiry':_0x1f1c23},_0x1f1c23!=_0x919e5c(0x1d2)?(await tgBot['sendMessage'](_0x1499ee[_0x919e5c(0x167)]['id'],'Login\x20accepted',{'parse_mode':_0x919e5c(0x164)})[_0x919e5c(0x27b)](_0x439b87=>{telegramError(_0x439b87);}),io['to'](_0x30c162)[_0x919e5c(0x214)](_0x919e5c(0x26c),{'access':{'allow':![],'reason':_0x919e5c(0x11c),'token':null}})):(await tgBot['sendMessage'](_0x1499ee[_0x919e5c(0x167)]['id'],'Login\x20rejected')[_0x919e5c(0x27b)](_0x96f066=>{telegramError(_0x96f066);}),io['to'](_0x30c162)[_0x919e5c(0x214)]('status',{'access':{'allow':![],'reason':_0x919e5c(0x143),'token':null}}));}),tgBot['removeListener'](_0x3deb85(0x194));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xf786fd=_0x40eb46;return dbConfig[_0xf786fd(0x273)](_0xf786fd(0x1d3))[_0xf786fd(0x154)](_0xf786fd(0x18e))['filter']({'status':_0xf786fd(0x11b)})[_0xf786fd(0xf1)]()||[];}function getDisabledBots(){const _0x3f8388=_0x40eb46;return dbConfig['get'](_0x3f8388(0x1d3))[_0x3f8388(0x154)](_0x3f8388(0x18e))[_0x3f8388(0x11e)]({'status':_0x3f8388(0x151)})[_0x3f8388(0xf1)]()||[];}function getBotAttributes(_0x585405){const _0x51c203=_0x40eb46;let _0x1cd59a={};const _0x281c5c=configpath+'bot-'+_0x585405+_0x51c203(0x1b3),_0x22f585=fs[_0x51c203(0x1f9)](_0x281c5c);if(_0x22f585){const _0x5678b9=fs['readFileSync'](_0x281c5c);try{const _0x1b84e8=JSON[_0x51c203(0x21b)](_0x5678b9),_0x29be99=_0x1b84e8?_0x1b84e8[_0x51c203(0x238)][0x0][_0x51c203(0x16a)]:![];_0x1cd59a[_0x51c203(0x1c0)]=_0x29be99?'auto':_0x51c203(0x1f5),_0x1cd59a[_0x51c203(0x15b)]=_0x1b84e8?_0x1b84e8[_0x51c203(0x238)][0x0][_0x51c203(0x15b)]:_0x51c203(0x285)+_0x585405;}catch(_0x3adba6){_0x1cd59a['mode']='manual',_0x1cd59a[_0x51c203(0x15b)]=_0x51c203(0x285)+_0x585405;}}else _0x1cd59a[_0x51c203(0x1c0)]=_0x51c203(0x1f5),_0x1cd59a[_0x51c203(0x15b)]=_0x51c203(0x285)+_0x585405;return _0x1cd59a;}function getBotsWithMode(){const _0x406cd8=_0x40eb46,_0x4b321b=dbConfig['get'](_0x406cd8(0x1d3))[_0x406cd8(0x154)](_0x406cd8(0x18e))[_0x406cd8(0xf1)]()||[];return _0x4b321b[_0x406cd8(0x1fa)](_0x22d223=>{const _0x2df26e=_0x406cd8;let _0x1a66b7=getBotAttributes(_0x22d223[_0x2df26e(0x18e)]);_0x22d223[_0x2df26e(0x1c0)]=_0x1a66b7[_0x2df26e(0x1c0)];}),_0x4b321b;}function getBotExchanges(){const _0x32b40e=_0x40eb46;let _0x174ad8=[];const _0x13812a=dbConfig[_0x32b40e(0x273)](_0x32b40e(0x1d3))['sortBy'](_0x32b40e(0x18e))[_0x32b40e(0xf1)]()||[];_0x13812a[_0x32b40e(0x1fa)](_0x3fbcb7=>{const _0x27d1c0=_0x32b40e;if(_0x3fbcb7[_0x27d1c0(0x26c)]==_0x27d1c0(0x11b)){const _0x3742a0=configpath+_0x27d1c0(0x16d)+_0x3fbcb7[_0x27d1c0(0x18e)]+_0x27d1c0(0x1b3),_0x42585d=fs['existsSync'](_0x3742a0);let _0x118ec9;if(_0x42585d){const _0x5063fa=fs[_0x27d1c0(0x2a6)](_0x3742a0);try{const _0xf7de17=JSON[_0x27d1c0(0x21b)](_0x5063fa);_0x118ec9=_0xf7de17?_0xf7de17[_0x27d1c0(0x238)][0x0][_0x27d1c0(0x296)]:null;}catch(_0x477c31){}}if(_0x118ec9)_0x174ad8[_0x27d1c0(0x185)](_0x118ec9);}});const _0x492ec7=[...new Set(_0x174ad8)][_0x32b40e(0x294)]();return _0x492ec7;}async function initUser(){const _0x2e1500=_0x40eb46;if(!settings['userid']){const _0x37f0bb=uuidRandom();mixpanel['alias'](_0x37f0bb),updateSetting(_0x2e1500(0x2a8),_0x37f0bb);}}async function initSecure(){const _0x11dbf8=_0x40eb46;let _0x20968d=getSecure();if(!_0x20968d[_0x11dbf8(0x1c6)](_0x11dbf8(0x1ba))){let _0x231785=await generateKeys();_0x20968d[_0x11dbf8(0x1ec)]=_0x231785[_0x11dbf8(0x1ec)],_0x20968d[_0x11dbf8(0x208)]=_0x231785[_0x11dbf8(0x208)],_0x20968d[_0x11dbf8(0x1ba)]=crypto[_0x11dbf8(0x210)](0x20)[_0x11dbf8(0x158)](_0x11dbf8(0x2b8));;storeSecure(_0x20968d);}}function getSettings(){const _0x35640f=_0x40eb46;return dbSettings[_0x35640f(0x273)](_0x35640f(0x184))['value']()||{};}function getSecure(){const _0x2902e0=_0x40eb46;return dbSecure['get']('secure')[_0x2902e0(0xf1)]()||{};}function getBlacklist(){const _0xe9780c=_0x40eb46;return dbSecure[_0xe9780c(0x273)]('blacklist')[_0xe9780c(0xf1)]()||[];}function broadcastToBots(_0x285b00,_0x259758){config['forEach'](_0x57ec7b=>{const _0x2a7085=_0x38fd;if(_0x57ec7b['status']=='enabled'&&_0x57ec7b[_0x2a7085(0x141)]=='running'||_0x57ec7b[_0x2a7085(0x26c)]=='new'&&_0x57ec7b[_0x2a7085(0x141)]==_0x2a7085(0x237)){if(pid[_0x57ec7b[_0x2a7085(0x18e)]])pid[_0x57ec7b['botID']]['send']({[_0x285b00]:_0x259758});}});}function storeSettings(_0x2bb9a0,_0x4f9677=![]){const _0x22a578=_0x40eb46;_0x2bb9a0={...settings,..._0x2bb9a0};if(_0x4f9677&&_0x2bb9a0[_0x22a578(0x22b)]!='************'&&_0x2bb9a0[_0x22a578(0x22b)]!=_0x22a578(0x24c)&&_0x2bb9a0['bbPassword']!=''){const _0x1597fe=crypt[_0x22a578(0x28c)](secure[_0x22a578(0x208)],_0x2bb9a0[_0x22a578(0x22b)])[_0x22a578(0x227)][_0x22a578(0x28a)]('@')[0x0],_0x525a44=bcrypt[_0x22a578(0x21a)](_0x1597fe,saltRounds);_0x2bb9a0={..._0x2bb9a0,'bbPassword':_0x525a44};}if(_0x4f9677&&_0x2bb9a0[_0x22a578(0x271)]!=_0x22a578(0x28e)&&_0x2bb9a0[_0x22a578(0x271)]!=_0x22a578(0x24c)&&_0x2bb9a0[_0x22a578(0x271)]!=''){const _0x1a50f1=crypt[_0x22a578(0x28c)](secure['privateKey'],_0x2bb9a0[_0x22a578(0x271)])[_0x22a578(0x227)][_0x22a578(0x28a)]('@')[0x0];_0x2bb9a0={..._0x2bb9a0,'telegramToken':_0x1a50f1};}const _0x4bc6b6=_0x2bb9a0[_0x22a578(0x271)]!='************'&&_0x2bb9a0[_0x22a578(0x271)]!=settings['telegramToken']||_0x2bb9a0[_0x22a578(0x20a)]!=settings[_0x22a578(0x20a)],_0x3cfdf4=_0x2bb9a0[_0x22a578(0x271)]==''||_0x2bb9a0['telegramUsername']=='';if(_0x4bc6b6)_0x2bb9a0['telegramEvents']=_0x22a578(0x205);for(const [_0x401e3a,_0x42aa23]of Object[_0x22a578(0x1a2)](_0x2bb9a0)){if(_0x401e3a==_0x22a578(0x271)&&_0x42aa23==_0x22a578(0x28e)){_0x2bb9a0[_0x22a578(0x271)]=settings['telegramToken'];continue;};if(_0x401e3a=='bbPassword'&&_0x42aa23==_0x22a578(0x28e)){_0x2bb9a0['bbPassword']=settings[_0x22a578(0x22b)];continue;};dbSettings[_0x22a578(0x209)](_0x22a578(0x20c)+_0x401e3a,_0x42aa23)[_0x22a578(0x262)]();}settings=_0x2bb9a0,io['to'](_0x22a578(0x206))[_0x22a578(0x214)](_0x22a578(0x184),cleanSettings()),broadcastToBots(_0x22a578(0x19a),settings[_0x22a578(0x19a)]),broadcastToBots(_0x22a578(0x166),settings[_0x22a578(0x166)]);if(_0x4bc6b6&&!_0x3cfdf4)initTelegram();if(_0x4bc6b6&&_0x3cfdf4)disableTelegram();getAllClients()[_0x22a578(0x1fa)](_0x5eadf3=>{const _0x55b05a=_0x22a578;getSocket(_0x5eadf3['id'])['emit']('status',{'access':{'allow':![],'reason':_0x55b05a(0x11c),'token':null}});});}function updateSetting(_0x625942,_0x4e3e28){const _0xe7e52a=_0x40eb46;dbSettings['set'](_0xe7e52a(0x20c)+_0x625942,_0x4e3e28)[_0xe7e52a(0x262)](),settings=getSettings(),io['to'](_0xe7e52a(0x206))['emit'](_0xe7e52a(0x184),cleanSettings());}function storeSecure(_0x34b4cd){const _0x17f10e=_0x40eb46;dbSecure['get'](_0x17f10e(0x139))[_0x17f10e(0x185)](_0x34b4cd)[_0x17f10e(0x262)](),secure=_0x34b4cd;}function addBlacklist(_0x3e8d80){const _0x54092a=_0x40eb46;cleanBlacklist();let _0x517c60;devices[_0x3e8d80][_0x54092a(0x28d)]?_0x517c60=Math['max'](devices[_0x3e8d80][_0x54092a(0x28d)][_0x54092a(0x1e8)],loginExpiry):_0x517c60=loginExpiry,dbSecure[_0x54092a(0x273)](_0x54092a(0x2b9))[_0x54092a(0x185)]({'expiry':new Date()['getTime']()+_0x517c60*0x3c*0x3e8,'token':devices[_0x3e8d80][_0x54092a(0x27e)][_0x54092a(0x26d)]})['write'](),blacklist=dbSecure[_0x54092a(0x273)]('blacklist')[_0x54092a(0xf1)]();}function cleanBlacklist(){const _0xa7be31=_0x40eb46;let _0x46a885=dbSecure[_0xa7be31(0x273)](_0xa7be31(0x2b9))['cloneDeep']()['value'](),_0x3bd6f1=new Date()[_0xa7be31(0x18a)]();_0x46a885[_0xa7be31(0x1fa)](_0x282a05=>{const _0x345bcf=_0xa7be31;_0x282a05[_0x345bcf(0x1e8)]<_0x3bd6f1&&dbSecure[_0x345bcf(0x273)](_0x345bcf(0x2b9))[_0x345bcf(0x18f)]({'expiry':_0x282a05[_0x345bcf(0x1e8)]})['write']();});}function _0x38fd(_0x18fc86,_0x19636c){const _0x67ac9a=_0xd078();return _0x38fd=function(_0x36d34f,_0xd429e1){_0x36d34f=_0x36d34f-0xe5;let _0x38fd8f=_0x67ac9a[_0x36d34f];return _0x38fd8f;},_0x38fd(_0x18fc86,_0x19636c);}function initStates(){const _0x8c876b=_0x40eb46;let _0x211f71=getConfiguration();_0x211f71[_0x8c876b(0x1fa)](_0x3652e6=>{const _0x45ac70=_0x8c876b;_0x3652e6[_0x45ac70(0x141)]=_0x45ac70(0x1e1);}),storeConfiguration(_0x211f71);}function onKeys(){const _0x532dd8=new RSA();return new Promise(_0x393b37=>{const _0x3c99db=_0x38fd;_0x532dd8[_0x3c99db(0x27d)]()[_0x3c99db(0x28b)](_0x596ca1=>{_0x393b37(_0x596ca1);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x461e00=_0x40eb46;let _0x57df3c=getSettings(),_0x917842=![];!_0x57df3c[_0x461e00(0x1c6)]('lastmsgtelegram')&&(_0x57df3c[_0x461e00(0x186)]=0x0,_0x917842=!![]);!_0x57df3c[_0x461e00(0x1c6)]('lastmsgemitted')&&(_0x57df3c[_0x461e00(0x2a7)]=0x0,_0x917842=!![]);!_0x57df3c['hasOwnProperty']('latestversion')&&(_0x57df3c[_0x461e00(0x1e3)]=_0x461e00(0x20e),_0x917842=!![]);!_0x57df3c['hasOwnProperty'](_0x461e00(0x166))&&(_0x57df3c[_0x461e00(0x166)]=![],_0x917842=!![]);if(_0x917842)storeSettings(_0x57df3c);try{fs[_0x461e00(0x181)](configbackuppath,{'withFileTypes':!![]})[_0x461e00(0x1fa)](_0x13077c=>{const _0x313ec0=_0x461e00;if(!_0x13077c['isDirectory']()){if(!_0x13077c['name']['startsWith'](_0x313ec0(0x177)))fs['unlinkSync'](configbackuppath+_0x13077c['name']);}else fs[_0x313ec0(0x18b)](configbackuppath+_0x13077c[_0x313ec0(0x173)],{'recursive':!![]});});}catch(_0x10b3e8){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x10b3e8);}}function storeConfiguration(_0x15f510){const _0x22543d=_0x40eb46;dbConfig['get'](_0x22543d(0x1d3))[_0x22543d(0x18f)]()[_0x22543d(0x262)](),_0x15f510[_0x22543d(0x1fa)](_0x4c10e1=>{const _0xba6e5d=_0x22543d;delete _0x4c10e1[_0xba6e5d(0x1c0)];}),dbConfig[_0x22543d(0x273)](_0x22543d(0x1d3))[_0x22543d(0x185)](..._0x15f510)[_0x22543d(0x262)](),config=_0x15f510;}function _0xd078(){const _0x98143e=['internal','reinstall','getUTCHours','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','new','Bot\x20Mgr\x20>\x20','versions','Invalid\x20authentication\x20token\x20(2)','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Token\x20blacklisted','params','Ok,\x20will\x20send\x20alert\x20notifications\x20only','-events.json','Starting\x20#RED#Balance\x20Bot\x20v','bot.js','Unauthorized\x20attempt\x20to\x20update\x20bot','debug','secure','logs','pidRefreshToken','invalid\x20credentials','alerts','orders','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20delete\x20bot','live','All\x20bots','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','isIPv4MappedAddress','inherit','reset-password','Crypt','bbUsername','express','bcryptjs','type','port','login','All','\x20|\x20','disabled','output-001.log','error','sortBy','/:bot/coins','telegram2FaApproval','/metrics\x20-\x20show\x20bot\x20performance\x0a','toString','$1_$2_$3','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','botname','exec','Unauthorized\x20attempt\x20to\x20show\x20configuration','stringify','auth','add','mkdirSync','replace','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','HTML','temporary\x20access\x20not\x20allowed','onepagemode','chat','restart','compareSync','headless','Failed\x20to\x20download\x20','verify','bot-','store-fiat','Ok,\x20will\x20send\x20order\x20notifications\x20only','send','(((.+)+)+)+$','search','name','File\x20uploaded','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','backup-full@',':\x20Bot\x20Mgr\x20>\x20','login\x20token\x20generated','getFullYear','3000','exit','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Starting\x20new\x20bot\x20|\x20Bot\x20','telegramChatId','stopPolling','readdirSync','sockets','isDirectory','settings','push','lastmsgtelegram','startsWith','server','telegrammsg','getTime','rmSync','headers','log','botID','remove','IPv4','\x20mode','\x1b[31m','12490740EajAaL','callback_query','get-backup-files','function','No\x20bots\x20running\x20right\x20now','keys','uuid','timeshift','fork','pidExpireLogin','\x20|\x20client:\x20...','backup-full','Access\x20enabled\x20for\x20','generate','bbvReceive','entries','number','2FA\x20required','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20get\x20messages','161212dFgXIk','./version.json','whitelist','temp/','temporaryAccessAllowed','cancel-loading','jsonwebtoken','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','slice','request','-config.json','mtime','33530321tdtoIh','format','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','temporary\x20token\x20generated','whitelistEnabled','secret','endsWith','env','lowdb','stop','yargs/yargs','mode','uncaughtException','\x20|\x20user:\x20...','listen','storeFiat','\x1b[34m','hasOwnProperty','Notifications\x20disabled\x0a','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Idling\x20bot\x20\x20\x20|\x20Bot\x20','/help\x20-\x20show\x20available\x20commands\x0a','includes','3fRclvs','delete-alerts','notification','Password\x20reset\x20rejected','removeListener','reject','bots','allow','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','store','Notifications\x20enabled\x0a','backup-full.zip','delete-bot','store-headless','\x20minutes','answerCallbackQuery','NTBA_FIX_319','resetHistory','node-zip','stopped','ipv6','latestversion','_data','bb-settings.json','apiPassword','logout','expiry','Starting\x20bot\x20|\x20Bot\x20','order','2FA','publicKey','bbvNew','express-fileupload','assign','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','sha256','127.0.0.1','build','clientip','manual','<b>Telegram\x20Bot\x20Status:</b>\x0a','updatebotmanager','/disable\x20-\x20disable\x20notifications\x0a','existsSync','forEach','toggleBotMode','binary','/download/:type','#RES#\x20if\x20running\x20on\x20server','\x1b[0m','Unauthorized\x20attempt\x20to\x20download\x20','reset-history','username','-results.json','Disabled\x20Bot\x20','all','botmanager','getPortfolio','privateKey','set','telegramUsername','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','settings.','1000','0.0.0','https://api.ipify.org?format=json','randomBytes','args','createWriteStream','82649YTCHdd','emit','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Setting\x20access:\x20','toIPv4Address','store-settings','output-002.log','hashSync','parse','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','getDate','2FA\x20login\x20required','apiSecret','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20confirm\x20message','test','unlinkSync','RSA-OAEP','deleteHistoryAlerts','node-telegram-bot-api','message','toIPv4MappedAddress','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','\x1b[36m','bbPassword','bb-secure.json','Allow\x20login\x20from\x20IP\x20address\x20<b>','Error\x20while\x20deleting\x20config\x20files:\x20','full','/:bot/history','clients','hybrid-crypto-js','removeAllListeners','</b>\x20?','5\x20min','once','running','bot','show','telegramEvents','files','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','referer','getHours','/on\x20-\x20start\x20bot(s)\x0a','zip/','range','getSeconds','login\x20token\x20valid','file','output-003.log','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','index.html','static','title','length','Restarting\x20Bot\x20','***','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','15\x20min','backup','handshake','path','started','any','environment','download','\x20>\x20','crypto','simple','tkn','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/output-000.log','family','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/:bot','bb/','from','write','staging','Invalid\x20authentication\x20token\x20(1)','polling_error','kill','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','lowdb/adapters/FileSync','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','socket','update','status','token','host','confirm-message','.zip','telegramToken','6b67f3d61ee94b8f5c80b4affef4c4d9','get','join','place-order','telegramEnabled','constructor','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/off\x20-\x20stop\x20bot(s)\x0a','Backup\x20file\x20uploaded','catch','/update\x20-\x20update\x20Balance\x20Bot\x0a','generateKeyPairAsync','access','Orders','production','ipaddr.js','backup/','sendMetricsTelegram','153839sMeXJM','Bot\x20','(staging)','update-bb','restore-backup-file','Restore\x20process\x20aborted','split','then','decrypt','telegramIpApproval','************','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','cancelLoading','Notifications\x20disabled','statSync','track','sort','\x1b[35m','exchange','config/','toggle-bot-mode','Notifications\x20types:\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','-----------------------------------------------------------------------------------','post','encryptedUuid','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','add-bot','auto','272uFbubb','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Node.js\x20v','readFileSync','lastmsgemitted','userid','output-000.log','SIGTERM','\x1b[33m','node','RSA','axios','find','#RES#\x20if\x20running\x20locally\x0a','You\x20can\x20use\x20the\x20following\x20commands:\x0a','yes','loginRequired','copyFileSync','timestamp','socket.io','show-config','hex','blacklist','graphql-request','sign','string','logged\x20out','/restart\x20-\x20restart\x20bot(s)\x0a','Restoring\x20bot(s)\x20from\x20backup','/status\x20-\x20show\x20bot(s)\x20status\x0a','/:bot/support','writeFileSync','reason','warning','438596oVSsvL','User\x20has\x20been\x20validated','2FA\x20login\x20token\x20generated','-performance.json','5GQzmVn','ipc','404\x20Not\x20Found','placeOrder','Temporary\x20access\x20rejected','login\x20not\x20required','backupfile','createServer','address','value','sendFile','new-disabled','password','match','api-eu.mixpanel.com','getStartingBalances','Yes','telegram','padStart','Unauthorized\x20attempt\x20to\x20add\x20bot','argv','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','init','getMinutes','min','Starting\x20Balance\x20Bot\x20reinstallation','update-bot','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','onText','get-portfolio','data','map','Alerts','sendMessage','temporary\x20access\x20rejected','Logged\x20out\x20user\x20...','get-starting-balances','f2aRequired','bb-config.json','defaults','use','Restore\x20backup\x20file\x20','disconnect','success','remoteAddress','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','build2',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','login\x20required','916998ewDUMX','logs/','enabled','reload','All\x20bots\x20running\x20right\x20now','filter','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','10GDNFMR','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','backup-files','event','::ffff:127.0.0.1','\x20to\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','getMonth'];_0xd078=function(){return _0x98143e;};return _0xd078();}function resetPassword(){const _0x6766a1=_0x40eb46;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x6766a1(0x109)](settings[_0x6766a1(0x17f)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x6766a1(0x2b2),'callback_data':_0x6766a1(0x2b2)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1fb06a=>{telegramError(_0x1fb06a);}),tgBot['on'](_0x6766a1(0x194),async _0x14ac0e=>{const _0x268799=_0x6766a1,_0x41eae6=_0x14ac0e[_0x268799(0x106)],_0xb27609=_0x14ac0e[_0x268799(0x227)];tgBot['answerCallbackQuery'](_0x14ac0e['id'])['then'](async()=>{const _0x4a830b=_0x268799;if(_0x41eae6!='no'){const _0x279a59=0xf,_0x1e883d=_0x4a830b(0x269),_0x482d29=Array[_0x4a830b(0x261)](crypto['randomFillSync'](new Uint32Array(_0x279a59)))[_0x4a830b(0x107)](_0x224cca=>_0x1e883d[_0x224cca%_0x1e883d['length']])[_0x4a830b(0x274)](''),_0x16b4af=bcrypt['hashSync'](_0x482d29,saltRounds);storeSettings({'bbPassword':_0x16b4af}),await tgBot[_0x4a830b(0x109)](_0xb27609['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x482d29,{'parse_mode':_0x4a830b(0x164)})['catch'](_0x27f352=>{telegramError(_0x27f352);});}else await tgBot['sendMessage'](_0xb27609[_0x4a830b(0x167)]['id'],_0x4a830b(0x1d0))[_0x4a830b(0x27b)](_0x11e191=>{telegramError(_0x11e191);});}),tgBot['removeListener'](_0x268799(0x194));}));}async function confirmRestore(_0x2b6793,_0x1113d8){const _0x24b8d7=_0x40eb46;io['to'](_0x24b8d7(0x206))[_0x24b8d7(0x214)]('notification',_0x24b8d7(0x2a0),'success'),tgBot&&settings['telegramChatId']&&(tgBot[_0x24b8d7(0x1d1)](_0x24b8d7(0x194)),await tgBot['sendMessage'](settings[_0x24b8d7(0x17f)],_0x24b8d7(0x17d),{'parse_mode':_0x24b8d7(0x164),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x24b8d7(0x2b2)},{'text':'no','callback_data':'no'}]]}})[_0x24b8d7(0x27b)](_0x52f63c=>{telegramError(_0x52f63c);}),tgBot['on']('callback_query',async _0x44ae06=>{const _0x20d0fd=_0x24b8d7,_0x62e6e6=_0x44ae06[_0x20d0fd(0x106)],_0x2aaee2=_0x44ae06['message'];tgBot['answerCallbackQuery'](_0x44ae06['id'])[_0x20d0fd(0x28b)](async()=>{const _0x553e88=_0x20d0fd;_0x62e6e6==_0x553e88(0x2b2)?(await tgBot[_0x553e88(0x109)](_0x2aaee2[_0x553e88(0x167)]['id'],_0x553e88(0x2bf),{'parse_mode':'HTML'})[_0x553e88(0x27b)](_0x1f927d=>{telegramError(_0x1f927d);}),unzipFile(_0x2b6793,_0x1113d8)):(logger[_0x553e88(0x138)](_0x553e88(0x289)),await tgBot[_0x553e88(0x109)](_0x2aaee2[_0x553e88(0x167)]['id'],'Restore\x20process\x20aborted')['catch'](_0x286a90=>{telegramError(_0x286a90);}));}),tgBot[_0x20d0fd(0x1d1)](_0x20d0fd(0x194));}));}function getServerTime(){const _0x10f1ce=_0x40eb46,_0x587b6b=new Date();return _0x587b6b[_0x10f1ce(0x17a)]()+'/'+(_0x587b6b[_0x10f1ce(0x127)]()+0x1)['toString']()[_0x10f1ce(0xfa)](0x2,'0')+'/'+_0x587b6b[_0x10f1ce(0x21d)]()[_0x10f1ce(0x158)]()[_0x10f1ce(0xfa)](0x2,'0')+'\x20'+_0x587b6b[_0x10f1ce(0x23e)]()[_0x10f1ce(0x158)]()[_0x10f1ce(0xfa)](0x2,'0')+':'+_0x587b6b[_0x10f1ce(0xff)]()[_0x10f1ce(0x158)]()[_0x10f1ce(0xfa)](0x2,'0')+':'+_0x587b6b[_0x10f1ce(0x242)]()['toString']()[_0x10f1ce(0xfa)](0x2,'0');}function getTimeStamp(){const _0x4458b5=_0x40eb46,_0x34ffdf=shiftedTime();return _0x34ffdf[_0x4458b5(0x17a)]()+'/'+(_0x34ffdf[_0x4458b5(0x127)]()+0x1)[_0x4458b5(0x158)]()[_0x4458b5(0xfa)](0x2,'0')+'/'+_0x34ffdf[_0x4458b5(0x21d)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x34ffdf[_0x4458b5(0x23e)]()[_0x4458b5(0x158)]()[_0x4458b5(0xfa)](0x2,'0')+':'+_0x34ffdf[_0x4458b5(0xff)]()['toString']()[_0x4458b5(0xfa)](0x2,'0')+':'+_0x34ffdf[_0x4458b5(0x242)]()['toString']()[_0x4458b5(0xfa)](0x2,'0');}function getCleanTimeStamp(){const _0x536a10=_0x40eb46,_0x246f99=shiftedTime();return _0x246f99[_0x536a10(0x17a)]()+(_0x246f99[_0x536a10(0x127)]()+0x1)[_0x536a10(0x158)]()[_0x536a10(0xfa)](0x2,'0')+_0x246f99['getDate']()[_0x536a10(0x158)]()['padStart'](0x2,'0')+'-'+_0x246f99['getHours']()[_0x536a10(0x158)]()[_0x536a10(0xfa)](0x2,'0')+_0x246f99[_0x536a10(0xff)]()[_0x536a10(0x158)]()[_0x536a10(0xfa)](0x2,'0')+_0x246f99['getSeconds']()[_0x536a10(0x158)]()[_0x536a10(0xfa)](0x2,'0');}function shiftedTime(){const _0x243b03=_0x40eb46,_0x4463f0=new Date();let _0xf7ba47=_0x4463f0;if(settings[_0x243b03(0x19a)]&&settings[_0x243b03(0x19a)]!==0x0)_0xf7ba47=fns[_0x243b03(0x160)](_0x4463f0,{'hours':settings[_0x243b03(0x19a)]});return _0xf7ba47;}function startScheduler(){const _0x5a7f3b=_0x40eb46,_0xec2497=new Date()[_0x5a7f3b(0x12a)](),_0xf46aa3=shiftedTime()[_0x5a7f3b(0x23e)]();_0xf46aa3==0x4&&backupConfigFiles();_0xf46aa3==0x0&&rotateLogFiles();_0xec2497%0x6==0x0&&triggerAnalytics();_0xec2497%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x189ea3){const _0x41bd26=_0x40eb46;logger['debug'](_0x41bd26(0x111)+_0x189ea3);const _0xf1db76=getBotsWithMode();_0xf1db76[_0x41bd26(0x24a)]>0x0?confirmRestore(configbackuppath,_0x189ea3):unzipFile(configbackuppath,_0x189ea3);}async function getBackupFiles(_0x2d09fb=null){const _0x398f62=_0x40eb46;let _0x57a89c=[],_0x3f80ec=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3f80ec[_0x398f62(0x294)]((_0x101807,_0x1034f4)=>_0x101807[_0x398f62(0x173)]<_0x1034f4['name']?0x1:_0x1034f4[_0x398f62(0x173)]<_0x101807['name']?-0x1:0x0),_0x3f80ec[_0x398f62(0x1fa)](_0x4a121c=>{const _0x5c7877=_0x398f62;if(!_0x4a121c[_0x5c7877(0x183)]()&&_0x4a121c[_0x5c7877(0x173)][_0x5c7877(0x187)]('backup-full@')&&_0x4a121c[_0x5c7877(0x173)][_0x5c7877(0x1bb)](_0x5c7877(0x270))){const _0x35e5bc=formatDate(fs[_0x5c7877(0x292)](configbackuppath+_0x4a121c['name'])[_0x5c7877(0x1b4)]);_0x57a89c[_0x5c7877(0x185)]({'name':_0x4a121c[_0x5c7877(0x173)],'mtime':_0x35e5bc});}});if(_0x2d09fb)io['to'](_0x2d09fb)['emit'](_0x398f62(0x122),_0x57a89c);else return _0x57a89c;}async function backupConfigFiles(){const _0x1948b4=_0x40eb46;await zipFiles(_0x1948b4(0x19e));const _0x8db4d9=getCleanTimeStamp();fs[_0x1948b4(0x2b4)](zippath+_0x1948b4(0x1d9),configbackuppath+(_0x1948b4(0x177)+_0x8db4d9+'.zip'));let _0x3bb7a0=fs[_0x1948b4(0x181)](configbackuppath,{'withFileTypes':!![]});_0x3bb7a0['sort']((_0x3ddad4,_0x593638)=>_0x3ddad4[_0x1948b4(0x173)]<_0x593638[_0x1948b4(0x173)]?0x1:_0x593638[_0x1948b4(0x173)]<_0x3ddad4[_0x1948b4(0x173)]?-0x1:0x0),_0x3bb7a0[_0x1948b4(0x24a)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x3bb7a0[_0x3bb7a0[_0x1948b4(0x24a)]-0x1][_0x1948b4(0x173)]);}function rotateLogFiles(){const _0x2847c7=_0x40eb46,_0x1c5ea4=fs[_0x2847c7(0x292)](logspath+_0x2847c7(0x2a9)),_0x2975f7=_0x1c5ea4['size']/0x400;if(_0x2975f7>0x64){let _0x11c095=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x11c095['sort']((_0x23c5cd,_0x23c470)=>_0x23c5cd[_0x2847c7(0x173)]<_0x23c470[_0x2847c7(0x173)]?0x1:_0x23c470[_0x2847c7(0x173)]<_0x23c5cd[_0x2847c7(0x173)]?-0x1:0x0),_0x11c095[_0x2847c7(0x1fa)](_0x5876c1=>{const _0x1d944c=_0x2847c7;if(_0x5876c1['name']==_0x1d944c(0x219))fs[_0x1d944c(0x2b4)](logspath+_0x5876c1['name'],logspath+_0x1d944c(0x245));if(_0x5876c1[_0x1d944c(0x173)]==_0x1d944c(0x152))fs[_0x1d944c(0x2b4)](logspath+_0x5876c1[_0x1d944c(0x173)],logspath+_0x1d944c(0x219));_0x5876c1['name']==_0x1d944c(0x2a9)&&(fs[_0x1d944c(0x2b4)](logspath+_0x5876c1[_0x1d944c(0x173)],logspath+'output-001.log'),fs[_0x1d944c(0x2c2)](logspath+_0x5876c1[_0x1d944c(0x173)],''));});}}async function zipFiles(_0x73787c){const _0x5a6631=_0x40eb46;let _0x27e0a5;if(_0x73787c==_0x5a6631(0x13a))_0x27e0a5=logspath;if(_0x73787c==_0x5a6631(0x24f))_0x27e0a5=configpath;if(_0x73787c=='backup-full')_0x27e0a5=configpath;let _0x4e6d3c=fs['readdirSync'](_0x27e0a5,{'withFileTypes':!![]});const _0x17940f=new require(_0x5a6631(0x1e0))();_0x4e6d3c['forEach'](_0x5abb62=>{const _0x1805f8=_0x5a6631;if(!_0x5abb62[_0x1805f8(0x183)]()){let _0x201a83=fs[_0x1805f8(0x2a6)](_0x27e0a5+_0x5abb62[_0x1805f8(0x173)]);if(_0x73787c==_0x1805f8(0x24f)){const _0xad38a9=/^bot-[0-9]{3}-config.json$/,_0x531f83=_0xad38a9[_0x1805f8(0x222)](_0x5abb62['name']);if(_0x531f83){const _0x5f1ed4=JSON['parse'](_0x201a83);if(_0x5f1ed4['bot'][0x0]){_0x5f1ed4[_0x1805f8(0x238)][0x0]['apiKey']=_0x1805f8(0x24c),_0x5f1ed4[_0x1805f8(0x238)][0x0][_0x1805f8(0x21f)]=_0x1805f8(0x24c);if(_0x5f1ed4[_0x1805f8(0x238)][0x0][_0x1805f8(0x1e6)])_0x5f1ed4[_0x1805f8(0x238)][0x0][_0x1805f8(0x1e6)]=_0x1805f8(0x24c);}_0x201a83=JSON[_0x1805f8(0x15e)](_0x5f1ed4,null,0x2);}if(_0x5abb62[_0x1805f8(0x173)]=='bb-settings.json'){const _0x4efc16=JSON['parse'](_0x201a83);if(_0x4efc16[_0x1805f8(0x184)][_0x1805f8(0x2b3)])_0x4efc16[_0x1805f8(0x184)]['loginRequired']=![];if(_0x4efc16[_0x1805f8(0x184)][_0x1805f8(0x22b)])_0x4efc16[_0x1805f8(0x184)][_0x1805f8(0x22b)]=_0x1805f8(0x24c);if(_0x4efc16[_0x1805f8(0x184)][_0x1805f8(0x271)])_0x4efc16['settings'][_0x1805f8(0x271)]=_0x1805f8(0x24c);if(_0x4efc16[_0x1805f8(0x184)]['telegramChatId'])_0x4efc16[_0x1805f8(0x184)]['telegramChatId']=null;_0x201a83=JSON['stringify'](_0x4efc16,null,0x2);}if(_0x5abb62[_0x1805f8(0x173)]!='bb-secure.json')_0x17940f[_0x1805f8(0x244)](_0x5abb62[_0x1805f8(0x173)],_0x201a83);}else _0x17940f[_0x1805f8(0x244)](_0x5abb62[_0x1805f8(0x173)],_0x201a83);}});const _0x120de7=_0x17940f[_0x5a6631(0x1a0)]({'base64':![],'compression':'DEFLATE'});fs[_0x5a6631(0x2c2)](zippath+(_0x73787c+_0x5a6631(0x270)),_0x120de7,_0x5a6631(0x1fc));}async function unzipFile(_0x58e2f9,_0x24e896){const _0x2dc9b6=_0x40eb46;fs[_0x2dc9b6(0x181)](configpath,{'withFileTypes':!![]})[_0x2dc9b6(0x1fa)](_0x66650=>{const _0x1af0c1=_0x2dc9b6;if(!_0x66650[_0x1af0c1(0x183)]())fs['rmSync'](configpath+_0x66650[_0x1af0c1(0x173)]);});const _0x1c7457=fs['readFileSync'](_0x58e2f9+_0x24e896,'binary'),_0x2aa0a4=new require(_0x2dc9b6(0x1e0))(_0x1c7457,{'base64':![],'checkCRC32':!![]});Object[_0x2dc9b6(0x198)](_0x2aa0a4[_0x2dc9b6(0x23b)])[_0x2dc9b6(0x1fa)](_0x58b427=>{const _0x5e5a07=_0x2dc9b6,_0x4073d7=_0x2aa0a4[_0x5e5a07(0x23b)][_0x58b427];fs[_0x5e5a07(0x2c2)](configpath+_0x4073d7[_0x5e5a07(0x173)],_0x4073d7[_0x5e5a07(0x1e4)]);}),fs[_0x2dc9b6(0x181)](temppath,{'withFileTypes':!![]})['forEach'](_0x2f9fbe=>{const _0x5c1d57=_0x2dc9b6;if(!_0x2f9fbe[_0x5c1d57(0x183)]())fs[_0x5c1d57(0x18b)](temppath+_0x2f9fbe[_0x5c1d57(0x173)]);}),logger[_0x2dc9b6(0x138)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x2dc9b6(0x170)]({'restore':!![]},_0x17639a=>{});}async function getPublicIp(){const _0x3f31dd=_0x40eb46;try{const _0x31f830=await axios['get'](_0x3f31dd(0x20f));publicip=_0x31f830[_0x3f31dd(0x106)]['ip'];}catch(_0x4cbfd3){}}async function triggerAnalytics(){const _0x16f5ff=_0x40eb46;if(!publicip)await getPublicIp();const _0x2b3407=getBotsWithMode();let _0x245fde=0x0;_0x2b3407[_0x16f5ff(0x1fa)](_0x31b477=>{const _0x4402fc=_0x16f5ff;if(_0x31b477[_0x4402fc(0x26c)]===_0x4402fc(0x11b))_0x245fde++;});const _0x1f2b6b=getBotExchanges();mixpanel[_0x16f5ff(0x293)]('Server',{'distinct_id':settings[_0x16f5ff(0x2a8)],'ip':publicip,'version':serverversion,'numbots':_0x2b3407['length'],'numbotsenabled':_0x245fde,'exchanges':_0x1f2b6b});}async function getMessages(){const _0x1ccbfd=_0x40eb46,_0x501c33=_0x1ccbfd(0x20b),_0x3b261b=new GraphQLClient(_0x501c33),_0x48deb5={'authorization':_0x1ccbfd(0x15a)},_0x53cbae=serverversion[_0x1ccbfd(0x28a)]('.'),_0x4d5c44=_0x53cbae[0x0]+'.'+_0x53cbae[0x1],_0x2e848e=Math[_0x1ccbfd(0x100)](settings[_0x1ccbfd(0x186)],settings[_0x1ccbfd(0x2a7)]),_0x57776f={'last':parseInt(_0x2e848e),'bbm':_0x4d5c44},_0x5cc381=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x41d1f3;try{_0x41d1f3=await _0x3b261b[_0x1ccbfd(0x1b2)](_0x5cc381,_0x57776f,_0x48deb5);}catch(_0x439bf5){}if(_0x41d1f3&&_0x41d1f3['messages']){let _0x4a9cb6=settings[_0x1ccbfd(0x186)];newMessages=[];for(const _0x3e233b of _0x41d1f3['messages']){newMessages[_0x1ccbfd(0x185)](_0x3e233b);if(_0x3e233b[_0x1ccbfd(0x1ed)])updateSetting(_0x1ccbfd(0x1e3),_0x3e233b[_0x1ccbfd(0x1ed)]);let _0x78ea33=_0x3e233b['bbvNew']?serverversion>=_0x3e233b['bbvNew']:![];if(!_0x78ea33&&_0x3e233b[_0x1ccbfd(0x1a3)]>_0x4a9cb6){if(_0x3e233b[_0x1ccbfd(0x1a1)]===_0x1ccbfd(0x253)||serverversion['startsWith'](_0x3e233b[_0x1ccbfd(0x1a1)])){let _0x1b3454=''+_0x3e233b[_0x1ccbfd(0x249)]+'\x0a\x0a'+_0x3e233b[_0x1ccbfd(0x227)];const _0x389549=await sendTelegramMsg(toTelegramMarkdown(_0x1b3454),'Markdown');if(_0x389549)_0x4a9cb6=_0x3e233b['number'];}}}updateAvailable=isNewerVersion(settings[_0x1ccbfd(0x1e3)],serverversion),updateSetting(_0x1ccbfd(0x186),_0x4a9cb6),emitMessages();}}function emitMessages(){const _0x522285=_0x40eb46,_0xe2e48b=settings[_0x522285(0x2a7)];let _0x45a9dc=[];newMessages[_0x522285(0x1fa)](_0x1dcf25=>{const _0x2e135c=_0x522285;_0x1dcf25[_0x2e135c(0x1a3)]>_0xe2e48b&&_0x45a9dc['push'](_0x1dcf25);}),_0x45a9dc[_0x522285(0x24a)]>0x0&&getAllClients()[_0x522285(0x1fa)](_0x318feb=>{const _0xeff3d8=_0x522285;getSocket(_0x318feb['id'])[_0xeff3d8(0x214)](_0xeff3d8(0x227),_0x45a9dc);});}function confirmMessage(_0x399b5d){updateSetting('lastmsgemitted',Number(_0x399b5d));}function isNewerVersion(_0x23f514,_0x324331){const _0x20a63a=_0x40eb46,_0x1ea52c=_0x324331['split']('.'),_0x244ed5=_0x23f514['split']('.');for(var _0x4d6636=0x0;_0x4d6636<_0x244ed5[_0x20a63a(0x24a)];_0x4d6636++){const _0x5549d3=~~_0x244ed5[_0x4d6636],_0x441c57=~~_0x1ea52c[_0x4d6636];if(_0x5549d3>_0x441c57)return!![];if(_0x5549d3<_0x441c57)return![];}return![];}function toTelegramMarkdown(_0x4ca01a){const _0x3e5f05=_0x40eb46,_0x410a8d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3eabaa=/\*{2}(.+?)\*{2}/gim;return _0x4ca01a=_0x4ca01a[_0x3e5f05(0x162)](_0x410a8d,_0x3e5f05(0x159))[_0x3e5f05(0x162)](_0x3eabaa,'*$1*'),_0x4ca01a;}async function validateConfigFile(){const _0x41adc8=_0x40eb46,_0x5d32ee=dbConfig[_0x41adc8(0x273)](_0x41adc8(0x1d3))[_0x41adc8(0x154)](_0x41adc8(0x18e))[_0x41adc8(0xf1)]()||[];if(_0x5d32ee[_0x41adc8(0x24a)]==0x0){let _0x3fa460=0x0,_0x4c171e=[];const _0x107204=/^bot-([0-9]{3})-config.json$/,_0x167d01=fs['readdirSync'](configpath);_0x167d01[_0x41adc8(0x1fa)](_0x349bdd=>{const _0x34b45a=_0x41adc8,_0x3b9bf3=_0x107204[_0x34b45a(0x15c)](_0x349bdd);if(_0x3b9bf3){const _0x46754a=_0x3b9bf3[0x1];let _0x1a8af1=getBotAttributes(_0x46754a);_0x4c171e[_0x34b45a(0x185)]({'botID':_0x46754a,'botname':_0x1a8af1[_0x34b45a(0x15b)],'status':_0x34b45a(0x151),'live':_0x34b45a(0x1e1)}),_0x3fa460++;}}),_0x3fa460!=0x0&&(dbConfig[_0x41adc8(0x273)](_0x41adc8(0x1d3))[_0x41adc8(0x1ef)](_0x4c171e)[_0x41adc8(0x262)](),config=_0x4c171e,restoredConfigFile=_0x3fa460);}}async function restoreConfigNotify(_0x593df8){const _0x8e5a9=_0x40eb46;let _0x4601b2;if(restoredConfigFile==0x1)_0x4601b2='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x4601b2=_0x8e5a9(0x1a5);if(_0x593df8)io['to'](_0x8e5a9(0x206))['emit']('notification',_0x4601b2);else{logger[_0x8e5a9(0x258)](_0x8e5a9(0x29b)),logger[_0x8e5a9(0x258)](_0x4601b2),logger[_0x8e5a9(0x258)]('-----------------------------------------------------------------------------------'),logger[_0x8e5a9(0x258)]('');if(tgBot&&settings[_0x8e5a9(0x17f)]&&settings[_0x8e5a9(0x23a)]!=_0x8e5a9(0x13e))tgBot[_0x8e5a9(0x109)](settings['telegramChatId'],_0x8e5a9(0x12d)+_0x4601b2)[_0x8e5a9(0x27b)](_0x8bd236=>{telegramError(_0x8bd236);});}}function validateCredentials(_0x30da06,_0x4a978a){const _0x57cc49=_0x40eb46;if(_0x30da06[_0x57cc49(0x202)]==settings[_0x57cc49(0x149)]&&bcrypt[_0x57cc49(0x169)](_0x30da06[_0x57cc49(0xf4)],settings[_0x57cc49(0x22b)])){if(settings[_0x57cc49(0x10d)])return{'allow':![],'reason':_0x57cc49(0x21e),'token':null};else{const _0x1503c9=generateLoginToken(_0x4a978a);return{'allow':!![],'reason':_0x57cc49(0x179),'token':_0x1503c9};}}else return{'allow':![],'reason':_0x57cc49(0x13c),'token':null};}function refreshToken(_0x772c32){const _0x5ae691=_0x40eb46,_0x433166=generateLoginToken(_0x772c32);return{'allow':!![],'reason':_0x5ae691(0x179),'token':_0x433166};}function validateAccess(_0x397a23,_0x14ea58,_0x43301d){const _0x1115f4=_0x40eb46,_0x447c80=_0x43301d?_0x43301d:devices[_0x14ea58]['ip'];let _0x3db68c;const _0x365c6b=_0x16607d=>{const _0xafb4b=_0x38fd;if(settings[_0xafb4b(0x2b3)]){if(settings[_0xafb4b(0x10d)]){if(telegram2FaApproved(_0x14ea58)){const _0x30f648=generateLoginToken(_0x14ea58);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x30f648};}else return{'allow':![],'reason':_0xafb4b(0x118),'token':null};}else return _0x3db68c=validToken(_0x16607d,_0x14ea58),_0x3db68c[_0xafb4b(0x1c6)](_0xafb4b(0x113))?{'allow':!![],'reason':_0xafb4b(0x243),'token':_0x16607d}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0xafb4b(0xed),'token':null};};if(settings[_0x1115f4(0x1b9)]){let _0x5f0d2d=[...settings[_0x1115f4(0x1aa)],'::1',_0x1115f4(0x124),_0x1115f4(0x1f2)];if(_0x5f0d2d[_0x1115f4(0x1cc)](_0x447c80))return _0x365c6b(_0x397a23);else{_0x3db68c=validToken(_0x397a23,_0x14ea58);if(_0x3db68c['hasOwnProperty'](_0x1115f4(0x113)))return _0x365c6b(_0x397a23);else{if(telegramIpApproved(_0x14ea58)){const _0x7a0a03=generateToken(_0x14ea58);return _0x3db68c=_0x365c6b(_0x397a23),_0x3db68c['allow']?{'allow':!![],'reason':_0x1115f4(0x1b8),'token':_0x7a0a03}:_0x3db68c;}else return settings[_0x1115f4(0x1ac)]?{'allow':![],'reason':_0x1115f4(0x1a4),'token':null}:{'allow':![],'reason':_0x1115f4(0x165),'token':null};}}}else return _0x365c6b(_0x397a23);}function timelyDecrypt(_0x137a23,_0x3091b1=!![]){const _0xdfaa15=_0x40eb46;if(_0x137a23)try{const _0x26f311=crypt[_0xdfaa15(0x28c)](secure[_0xdfaa15(0x208)],_0x137a23)[_0xdfaa15(0x227)],_0x230f77=_0x26f311[_0xdfaa15(0x28a)]('@')[0x0],_0xc362a=_0x26f311[_0xdfaa15(0x28a)]('@')[0x1],_0x3ab436=new Date()['getTime']();if(_0x3091b1){if(_0x3ab436-_0xc362a<maxSecretAge*0x3e8)return _0x230f77;else return![];}else return _0x230f77;}catch(_0x136802){return![];}else return![];}const validToken=(_0x1ec130,_0xaeb177)=>{const _0x33cf55=_0x40eb46,_0x3571a4=devices[_0xaeb177]['ip'];if(!_0x1ec130)return{'error':'No\x20authentication\x20token'};for(let _0x3ae614 of blacklist){if(_0x3ae614['token']==_0x1ec130)return{'error':_0x33cf55(0x131)};}let _0x4a12fd;try{_0x4a12fd=jwt[_0x33cf55(0x16c)](_0x1ec130,secure[_0x33cf55(0x1ba)]+_0xaeb177);}catch{return{'error':_0x33cf55(0x264)};}if(!_0x4a12fd[_0x33cf55(0x1c6)]('clientip')&&!_0x4a12fd[_0x33cf55(0x1c6)]('username')||!_0x4a12fd[_0x33cf55(0x1c6)]('exp'))return{'error':_0x33cf55(0x12f)};if(!_0x4a12fd[_0x33cf55(0x1c6)](_0x33cf55(0x202))&&_0x4a12fd[_0x33cf55(0x1c6)](_0x33cf55(0x1f4))){const {clientip:_0x30abc8}=_0x4a12fd;return _0x3571a4==_0x30abc8?{'success':_0x33cf55(0xe5)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x4a12fd[_0x33cf55(0x1c6)]('username')&&_0x4a12fd['hasOwnProperty'](_0x33cf55(0x1f4))){const {username:_0x14a8b3,clientip:_0x112c17}=_0x4a12fd;return settings['bbUsername']==_0x14a8b3&&_0x3571a4==_0x112c17?{'success':_0x33cf55(0xe5)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x239074=>{const _0x3ce3e8=_0x40eb46;if(_0x239074){const _0x3587a8=devices[_0x239074]['ip'];return jwt[_0x3ce3e8(0x2bb)]({'username':settings[_0x3ce3e8(0x149)],'clientip':_0x3587a8},secure[_0x3ce3e8(0x1ba)]+_0x239074,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x256b70=>{const _0x4722ac=_0x40eb46;if(_0x256b70){const _0x1aad38=devices[_0x256b70]['ip'];return jwt[_0x4722ac(0x2bb)]({'clientip':_0x1aad38},secure[_0x4722ac(0x1ba)]+_0x256b70,{'expiresIn':devices[_0x256b70][_0x4722ac(0x28d)][_0x4722ac(0x1e8)]*0x3c});}else return![];},telegramIpApproved=_0x56867b=>{const _0x4124a1=_0x40eb46;let _0x3090a4=![];return devices[_0x56867b][_0x4124a1(0x28d)]&&devices[_0x56867b][_0x4124a1(0x28d)][_0x4124a1(0x1e8)]!=_0x4124a1(0x1d2)&&(_0x3090a4=devices[_0x56867b][_0x4124a1(0x28d)][_0x4124a1(0x1f4)]==devices[_0x56867b]['ip']&&new Date()[_0x4124a1(0x18a)]()-devices[_0x56867b][_0x4124a1(0x28d)][_0x4124a1(0x2b5)]<devices[_0x56867b]['telegramIpApproval'][_0x4124a1(0x1e8)]*0x3c*0x3e8),_0x3090a4;},telegram2FaApproved=_0x43e173=>{const _0x5b6ff2=_0x40eb46;let _0x73f479=![];return devices[_0x43e173][_0x5b6ff2(0x156)]&&devices[_0x43e173][_0x5b6ff2(0x156)][_0x5b6ff2(0x1e8)]!=_0x5b6ff2(0x1d2)&&(_0x73f479=devices[_0x43e173][_0x5b6ff2(0x156)][_0x5b6ff2(0x1f4)]==devices[_0x43e173]['ip']&&new Date()[_0x5b6ff2(0x18a)]()-devices[_0x43e173]['telegram2FaApproval'][_0x5b6ff2(0x2b5)]<devices[_0x43e173][_0x5b6ff2(0x156)][_0x5b6ff2(0x1e8)]*0x3c*0x3e8),_0x73f479;},normalizeIP=_0x4e1b98=>{const _0x5ee152=_0x40eb46;let _0x470dc2=null,_0x3328dd=null;if(ipaddr['isValid'](_0x4e1b98)){const _0x4ef5f2=ipaddr[_0x5ee152(0x21b)](_0x4e1b98);_0x4ef5f2['kind']()===_0x5ee152(0x1e2)?(_0x4ef5f2[_0x5ee152(0x145)]()&&(_0x470dc2=_0x4ef5f2[_0x5ee152(0x217)]()[_0x5ee152(0x158)]()),_0x3328dd=_0x4ef5f2['toString']()):(_0x470dc2=_0x4ef5f2[_0x5ee152(0x158)](),_0x3328dd=_0x4ef5f2[_0x5ee152(0x228)]()[_0x5ee152(0x158)]());}return{'show':_0x470dc2?_0x470dc2:_0x3328dd,'store':_0x3328dd};};function formatDate(_0x524f5f){const _0x41f9db=_0x40eb46;return _0x524f5f['getFullYear']()+'/'+(_0x524f5f[_0x41f9db(0x127)]()+0x1)[_0x41f9db(0x158)]()['padStart'](0x2,'0')+'/'+_0x524f5f[_0x41f9db(0x21d)]()['toString']()[_0x41f9db(0xfa)](0x2,'0')+'\x20'+_0x524f5f[_0x41f9db(0x23e)]()['toString']()[_0x41f9db(0xfa)](0x2,'0')+':'+_0x524f5f[_0x41f9db(0xff)]()[_0x41f9db(0x158)]()[_0x41f9db(0xfa)](0x2,'0')+':'+_0x524f5f['getSeconds']()[_0x41f9db(0x158)]()['padStart'](0x2,'0');}function sleep(_0x5aed66){return new Promise(_0x219f75=>setTimeout(_0x219f75,_0x5aed66));}