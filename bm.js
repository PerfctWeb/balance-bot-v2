const _0xf346f5=_0x2548;(function(_0x59c652,_0x396bcb){const _0x149054=_0x2548,_0x46f211=_0x59c652();while(!![]){try{const _0x3ff683=parseInt(_0x149054(0x15a))/0x1+-parseInt(_0x149054(0x246))/0x2*(-parseInt(_0x149054(0x183))/0x3)+-parseInt(_0x149054(0xdf))/0x4+-parseInt(_0x149054(0x19c))/0x5*(-parseInt(_0x149054(0x20b))/0x6)+parseInt(_0x149054(0x271))/0x7*(-parseInt(_0x149054(0x197))/0x8)+parseInt(_0x149054(0x256))/0x9*(-parseInt(_0x149054(0x1f6))/0xa)+-parseInt(_0x149054(0x22b))/0xb*(-parseInt(_0x149054(0x179))/0xc);if(_0x3ff683===_0x396bcb)break;else _0x46f211['push'](_0x46f211['shift']());}catch(_0xdcb703){_0x46f211['push'](_0x46f211['shift']());}}}(_0xc6ba,0x7c719));const _0x1ac098=function(){let _0xe6796f=!![];return function(_0x23ab7e,_0x663c18){const _0x5a0172=_0xe6796f?function(){if(_0x663c18){const _0x3e345f=_0x663c18['apply'](_0x23ab7e,arguments);return _0x663c18=null,_0x3e345f;}}:function(){};return _0xe6796f=![],_0x5a0172;};}(),_0x5e3f77=_0x1ac098(this,function(){const _0x4c6e53=_0x2548;return _0x5e3f77['toString']()['search'](_0x4c6e53(0x128))[_0x4c6e53(0x1c1)]()['constructor'](_0x5e3f77)[_0x4c6e53(0x29b)](_0x4c6e53(0x128));});_0x5e3f77();'use strict';process['env'][_0xf346f5(0x1a0)]=0x1;const childProcess=require(_0xf346f5(0x219)),fs=require('fs'),fns=require(_0xf346f5(0xe7)),low=require(_0xf346f5(0x2ad)),FileSync=require(_0xf346f5(0x225)),path=require(_0xf346f5(0x262)),crypto=require(_0xf346f5(0x109)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0xf346f5(0x1e9))[_0xf346f5(0x29f)],bcrypt=require(_0xf346f5(0x11c)),jwt=require(_0xf346f5(0xb0)),ipaddr=require(_0xf346f5(0xd2)),argv=require(_0xf346f5(0x14c))(process[_0xf346f5(0x19e)][_0xf346f5(0x1aa)](0x2))[_0xf346f5(0x19e)],uuidRandom=require(_0xf346f5(0x9d)),{Telegraf,Markup}=require(_0xf346f5(0x11e)),Mixpanel=require(_0xf346f5(0xbd)),axios=require('axios'),{GraphQLClient,gql}=require(_0xf346f5(0xc3)),util=require('util'),fileUpload=require(_0xf346f5(0x1cd)),{networkInterfaces}=require('os'),PORT=argv[_0xf346f5(0x1c2)]||_0xf346f5(0x137),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0xf346f5(0x259)](_0xf346f5(0x102)+PORT+_0xf346f5(0x22c)),process[_0xf346f5(0x25f)](0x1));const HOST=argv[_0xf346f5(0xc7)]||null,userID=argv[_0xf346f5(0x124)]||'',debugging=argv['d']||![],nodeversion=process[_0xf346f5(0x166)][_0xf346f5(0x1f9)];let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0xf346f5(0x1a4),settingsfile=_0xf346f5(0x297),securefile='bb-secure.json',environment=require('./'+bbpath2+_0xf346f5(0x240))[_0xf346f5(0x15c)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0xf346f5(0x218)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xf346f5(0x146)),configpath=userID?bbpath+_0xf346f5(0x1c0)+userID+'/':bbpath+_0xf346f5(0x1c0),configbackuppath=configpath+_0xf346f5(0x1f8),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0xf346f5(0x224),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0xf346f5(0x295),loggerfile=fs[_0xf346f5(0x11a)](logspath+_0xf346f5(0x1e3),{'flags':'a'}),temppath=userID?bbpath+_0xf346f5(0x14d)+userID+'/':bbpath+_0xf346f5(0x14d);!fs[_0xf346f5(0x218)](configpath)&&fs[_0xf346f5(0x21a)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0xf346f5(0x21a)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0xf346f5(0x21a)](logspath);!fs[_0xf346f5(0x218)](zippath)&&fs[_0xf346f5(0x21a)](zippath);!fs[_0xf346f5(0x218)](temppath)&&fs[_0xf346f5(0x21a)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xf346f5(0x107)]({'bots':[]})[_0xf346f5(0x11f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xf346f5(0x107)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xf346f5(0xb6),'onepagemode':![],'marketcapApi':''}})[_0xf346f5(0x11f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xf346f5(0x107)]({'secure':{},'blacklist':[]})[_0xf346f5(0x11f)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0xf346f5(0xa2)});const saltRounds=0xa,mixpanel=Mixpanel[_0xf346f5(0xfd)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0xf346f5(0x1b9)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xf346f5(0x127)]&&(settings['telegramToken']!=''&&settings['telegramToken']!=_0xf346f5(0x164))&&settings[_0xf346f5(0x165)]&&settings[_0xf346f5(0x165)]!='')initTelegram();const parseColor=(_0x9d2585,_0x25722f)=>{const _0x3f6e4c=_0xf346f5,_0x236b38=/#[A-Z]{3}#/g;if(typeof _0x9d2585==_0x3f6e4c(0x1b2)){!_0x25722f?_0x9d2585=_0x9d2585['replace'](_0x236b38,''):(_0x9d2585=_0x9d2585[_0x3f6e4c(0x19f)](/#BLU#/g,'\x1b[34m'),_0x9d2585=_0x9d2585[_0x3f6e4c(0x19f)](/#RED#/g,_0x3f6e4c(0x1a1)),_0x9d2585=_0x9d2585[_0x3f6e4c(0x19f)](/#YEL#/g,_0x3f6e4c(0x181)),_0x9d2585=_0x9d2585['replace'](/#MAG#/g,_0x3f6e4c(0x222)),_0x9d2585=_0x9d2585[_0x3f6e4c(0x19f)](/#CYA#/g,'\x1b[36m'),_0x9d2585=_0x9d2585['replace'](/#RES#/g,_0x3f6e4c(0x1b8)));;}return _0x9d2585;},logger={'screen':_0x34acd5=>{console['log'](parseColor(_0x34acd5,!![]));},'simple':_0x146472=>{const _0x599e23=_0xf346f5;console[_0x599e23(0x259)](parseColor(_0x146472,!![])),loggerfile[_0x599e23(0x11f)](util[_0x599e23(0xa6)](parseColor(_0x146472,![]))+'\x0a');},'full':async _0xec7cd0=>{const _0x5efd41=_0xf346f5,_0x15cf55=getTimeStamp()+_0x5efd41(0xc4)+_0xec7cd0;console[_0x5efd41(0x259)](parseColor(_0x15cf55,!![])),loggerfile['write'](util['format'](parseColor(_0x15cf55,![]))+'\x0a');if(tgBot&&settings[_0x5efd41(0x207)]&&settings[_0x5efd41(0x1ac)]!='orders')await sendTelegram(settings[_0x5efd41(0x207)],_0x5efd41(0x229)+parseColor(_0xec7cd0,![]));},'debug':async(_0x192807,_0x555af1='')=>{const _0x461f52=_0xf346f5,_0x35a0bc=getTimeStamp()+_0x461f52(0x20d)+_0x192807;if(debugging)console[_0x461f52(0x259)](parseColor(_0x35a0bc,!![]));loggerfile['write'](util['format'](parseColor(_0x35a0bc,![]))+'\x0a');if(_0x555af1){if(debugging)console[_0x461f52(0x259)](_0x555af1);loggerfile[_0x461f52(0x11f)](util['format'](_0x555af1)+'\x0a');}}};let terminating=![];process['on'](_0xf346f5(0x129),function(_0x283a21){const _0x531e1c=_0xf346f5;_0x283a21['toString']()['includes'](_0x531e1c(0x272))?(logger[_0x531e1c(0x173)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x283a21[_0x531e1c(0x1c2)]+_0x531e1c(0x267)),process['send']({'terminate':!![]},_0x4759a1=>{})):logger[_0x531e1c(0x173)](_0x283a21);}),process['on'](_0xf346f5(0x25f),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0xf346f5(0x155),()=>{const _0x9a3543=_0xf346f5;stopAllBots(),process[_0x9a3543(0x25f)](0x0);}),process['on'](_0xf346f5(0x1cf),()=>{const _0x231931=_0xf346f5;stopAllBots(),process[_0x231931(0x25f)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xf346f5(0x240))[_0xf346f5(0x217)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0xf346f5(0x1d5)](app);app[_0xf346f5(0x1b7)](fileUpload({'useTempFiles':!![]})),app[_0xf346f5(0x151)]('/download/:type',async(_0x1f1f04,_0x3de4b9)=>{const _0xacf224=_0xf346f5,_0x417639=_0x1f1f04['params'][_0xacf224(0x154)],_0x1dec71=getClientsWithBotID(_0xacf224(0x245)),_0x51e112=_0x1f1f04['headers'][_0xacf224(0xe4)],_0x9f3259=timelyDecrypt(_0x51e112,![]),_0x40feee=_0x1dec71['find'](_0x4cd2b2=>_0x4cd2b2[_0xacf224(0xe4)]==_0x9f3259);if(_0x40feee){const _0x2a6967=normalizeIP(_0x1f1f04[_0xacf224(0xe6)][_0xacf224(0x19d)])[_0xacf224(0x242)],_0x1743c4=_0x1f1f04[_0xacf224(0x1a3)]['tkn'];if(validateAccess(_0x1743c4,_0x9f3259,_0x2a6967)['allow'])_0x417639==_0xacf224(0x29d)&&await backupConfigFiles(),await zipFiles(_0x417639),_0x3de4b9['download'](zippath+(_0x417639+'.zip'),_0x4519c1=>{const _0x12b8c5=_0xacf224;_0x4519c1&&(logger[_0x12b8c5(0x29e)](_0x12b8c5(0x223)+_0x417639),logger[_0x12b8c5(0x173)](_0x4519c1));});else logger[_0xacf224(0x29e)](_0xacf224(0x10b)+_0x417639+_0xacf224(0x136));}else logger[_0xacf224(0x29e)](_0xacf224(0x10b)+_0x417639+_0xacf224(0xe2));}),app[_0xf346f5(0x26d)](_0xf346f5(0xf1),async(_0x992309,_0x314ec1)=>{const _0x446dfc=_0xf346f5,_0x4ae183=getClientsWithBotID(_0x446dfc(0x245)),_0x36f3aa=_0x992309['headers']['uuid'],_0x1ac427=timelyDecrypt(_0x36f3aa,![]),_0x32c067=_0x4ae183[_0x446dfc(0x192)](_0x8add93=>_0x8add93[_0x446dfc(0xe4)]==_0x1ac427);logger[_0x446dfc(0x141)]('Backup\x20file\x20uploaded');if(_0x32c067){const _0x57ecb8=normalizeIP(_0x992309[_0x446dfc(0xe6)][_0x446dfc(0x19d)])[_0x446dfc(0x242)],_0x269f86=_0x992309[_0x446dfc(0x1a3)][_0x446dfc(0x1c6)];if(validateAccess(_0x269f86,_0x1ac427,_0x57ecb8)['allow']){if(_0x992309[_0x446dfc(0x167)]){const _0x91946f=_0x992309[_0x446dfc(0x167)][_0x446dfc(0x27c)];await _0x91946f['mv'](temppath+_0x91946f[_0x446dfc(0x1db)]),_0x314ec1[_0x446dfc(0x24e)]({'status':!![],'message':_0x446dfc(0xe5)});const _0x31aa59=getBotsWithMode();_0x31aa59[_0x446dfc(0x21b)]>0x0?confirmRestore(temppath,_0x91946f[_0x446dfc(0x1db)]):unzipFile(temppath,_0x91946f[_0x446dfc(0x1db)]);}}else logger[_0x446dfc(0x29e)](_0x446dfc(0x1f7));}else logger[_0x446dfc(0x29e)](_0x446dfc(0xb4));}),app['use'](express[_0xf346f5(0x142)](path[_0xf346f5(0x29a)](__dirname,bbpath2,_0xf346f5(0x1f3)))),app['use'](express[_0xf346f5(0x142)](path[_0xf346f5(0x29a)](__dirname,bbpath2,'build'))),app[_0xf346f5(0x151)]('/',function(_0x4b2719,_0x41bcf4){const _0x3a8d4e=_0xf346f5;_0x41bcf4[_0x3a8d4e(0x168)](path[_0x3a8d4e(0x29a)](__dirname,bbpath2,_0x3a8d4e(0x1f3),'index.html'));}),app['get']('/:bot',function(_0x49a415,_0x169ea7){const _0x183eb9=_0xf346f5;_0x169ea7[_0x183eb9(0x168)](path[_0x183eb9(0x29a)](__dirname,bbpath2,_0x183eb9(0x291),_0x183eb9(0xc1)));}),app[_0xf346f5(0x151)](_0xf346f5(0x133),(_0xc148a1,_0x4b6f63)=>{const _0x13f8e9=_0xf346f5;_0x4b6f63['sendFile'](path[_0x13f8e9(0x29a)](__dirname,bbpath2,_0x13f8e9(0x291),_0x13f8e9(0xc1)));}),app[_0xf346f5(0x151)](_0xf346f5(0x111),(_0x14d303,_0x1e6702)=>{const _0x4f8c50=_0xf346f5;_0x1e6702[_0x4f8c50(0x168)](path[_0x4f8c50(0x29a)](__dirname,bbpath2,'build',_0x4f8c50(0xc1)));}),app['get']('/:bot/coins',(_0x4fa5a8,_0x19d3a4)=>{const _0x20d005=_0xf346f5;_0x19d3a4[_0x20d005(0x168)](path['join'](__dirname,bbpath2,'build',_0x20d005(0xc1)));}),app[_0xf346f5(0x151)](_0xf346f5(0x27b),(_0x3c9b5d,_0x490b85)=>{const _0x305d02=_0xf346f5;_0x490b85[_0x305d02(0x168)](path[_0x305d02(0x29a)](__dirname,bbpath2,_0x305d02(0x291),_0x305d02(0xc1)));}),app[_0xf346f5(0x151)](_0xf346f5(0x16a),(_0x19da5d,_0x56b219)=>{const _0xa5f2fc=_0xf346f5;_0x56b219['sendFile'](path['join'](__dirname,bbpath2,_0xa5f2fc(0x291),_0xa5f2fc(0xc1)));}),app[_0xf346f5(0x151)](_0xf346f5(0x17a),(_0x322aa0,_0x255e23)=>{const _0x2ffcdf=_0xf346f5;_0x255e23[_0x2ffcdf(0x168)](path[_0x2ffcdf(0x29a)](__dirname,bbpath2,_0x2ffcdf(0x291),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0xf346f5(0x2aa)](PORT);const io=require(_0xf346f5(0x9e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x40ac3b=_0xf346f5;let _0x5c78dd='[ip-address]';const _0x5606ed=networkInterfaces(),_0x2044bd={};for(const _0x48211e of Object[_0x40ac3b(0x16d)](_0x5606ed)){for(const _0x2c5c10 of _0x5606ed[_0x48211e]){if((_0x2c5c10[_0x40ac3b(0xb5)]=='IPv4'||_0x2c5c10['family']==0x4)&&!_0x2c5c10[_0x40ac3b(0x1c8)]){const _0x5315b0=ipaddr['parse'](_0x2c5c10[_0x40ac3b(0x1e5)])[_0x40ac3b(0x14f)]();_0x5315b0!=_0x40ac3b(0x152)&&(!_0x2044bd[_0x48211e]&&(_0x2044bd[_0x48211e]=[]),_0x2044bd[_0x48211e][_0x40ac3b(0x150)](_0x2c5c10[_0x40ac3b(0x1e5)]),_0x5c78dd=_0x2c5c10[_0x40ac3b(0x1e5)]);}}}return{'serverip':_0x5c78dd,'netinterfaces':_0x2044bd};}async function startServer(){const _0x324a30=_0xf346f5,{serverip:_0x1727ed,netinterfaces:_0x5881ff}=getServerIP();logger['simple'](''),logger['simple'](_0x324a30(0x277)),await logger[_0x324a30(0x29e)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x324a30(0x290)+(environment==_0x324a30(0x1d3)?_0x324a30(0x23f):'')+'\x0a'+(_0x324a30(0xfb)+PORT+_0x324a30(0x1c5))+(_0x324a30(0xaf)+_0x1727ed+':'+PORT+_0x324a30(0x28c))),logger[_0x324a30(0x173)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x5447ad of config){const _0x4bd233=_0x5447ad[_0x324a30(0x13f)]==_0x324a30(0xb9)?'a':'m';if(_0x5447ad[_0x324a30(0x289)]==_0x324a30(0x121)||_0x5447ad[_0x324a30(0x289)]==_0x324a30(0x23d))await logger['full']('Starting\x20('+_0x4bd233+_0x324a30(0x261)+_0x5447ad['botID']+_0x324a30(0x204)+_0x5447ad[_0x324a30(0x1a7)]),startBot([_0x5447ad['botID'],userID],{'cwd':bbpath},function(_0x599a96){const _0x5dfda7=_0x324a30;if(_0x599a96)logger[_0x5dfda7(0x29e)](_0x599a96);});else(_0x5447ad[_0x324a30(0x289)]==_0x324a30(0xa3)||_0x5447ad['status']==_0x324a30(0x18f))&&await logger[_0x324a30(0x29e)](_0x324a30(0x284)+_0x4bd233+_0x324a30(0x287)+_0x5447ad[_0x324a30(0x22e)]+'\x20|\x20'+_0x5447ad[_0x324a30(0x1a7)]);}else!newBot&&logger['simple'](_0x324a30(0xbe));if(newBot)addBot();logger[_0x324a30(0x173)]('-----------------------------------------------------------------------------------'),logger[_0x324a30(0x173)](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger['debug'](_0x324a30(0x1cb),_0x5881ff);}function startSocket(){io['on']('connection',_0x2ac313=>{const _0x386696=_0x2548;let _0x1a9d76,_0x5061ef,_0x553b44,_0x1658ca,_0x173735;const _0x1c14c7=_0x2ac313[_0x386696(0x191)][_0x386696(0x1a3)][_0x386696(0x10f)];_0x5061ef=_0x1c14c7[_0x386696(0x23c)](/bot[0-9]{3}/);if(_0x5061ef)_0x553b44=_0x5061ef[0x0][_0x386696(0x23c)](/[0-9]{3}/);if(_0x553b44)_0x1a9d76=_0x553b44[0x0];else _0x1a9d76=_0x386696(0x245);const _0xddaa50=_0x2ac313['handshake'][_0x386696(0x14e)][_0x386696(0x1b5)];if(!_0xddaa50)_0x2ac313['emit']('status',{'publicKey':secure[_0x386696(0x1d4)]});else{_0x1658ca=timelyDecrypt(_0xddaa50,![]);if(!_0x1658ca)_0x2ac313['emit'](_0x386696(0x289),{'publicKey':secure[_0x386696(0x1d4)]});else{_0x173735=normalizeIP(_0x2ac313[_0x386696(0x122)][_0x386696(0x19d)])[_0x386696(0x242)];if(!devices[_0x1658ca])devices[_0x1658ca]={'uuid':_0x1658ca,'access':{'token':null}};devices[_0x1658ca]['ip']=_0x173735;const _0x49dd64=addClient(_0x2ac313['id'],_0x1658ca,_0x1a9d76);setAccess(_0x49dd64),emitMessages(),_0x2ac313['on'](_0x386696(0x15e),_0x42de24=>{const _0x2bf934=_0x386696,_0x13632c=timelyDecrypt(_0x42de24[_0x2bf934(0x123)],!![],_0x2bf934(0x2a0));if(_0x13632c){_0x42de24={'username':_0x42de24[_0x2bf934(0x1ae)],'password':_0x13632c},devices[_0x1658ca][_0x2bf934(0x201)]=validateCredentials(_0x42de24,_0x1658ca);if(devices[_0x1658ca][_0x2bf934(0x201)][_0x2bf934(0x17e)]==![]&&devices[_0x1658ca][_0x2bf934(0x201)][_0x2bf934(0x1d1)]=='2FA\x20login\x20required')_0x2ac313[_0x2bf934(0x1e8)]('status',{'access':devices[_0x1658ca][_0x2bf934(0x201)]}),loginAccess2FA(_0x1658ca,_0x173735);else{if(devices[_0x1658ca]['access'][_0x2bf934(0x17e)]==![]&&devices[_0x1658ca][_0x2bf934(0x201)]['reason']==_0x2bf934(0x250))_0x2ac313[_0x2bf934(0x1e8)](_0x2bf934(0x289),{'access':devices[_0x1658ca][_0x2bf934(0x201)]});else devices[_0x1658ca]['access'][_0x2bf934(0x17e)]&&devices[_0x1658ca][_0x2bf934(0x201)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1658ca)[_0x2bf934(0x263)](_0x434624=>{setAccess(_0x434624);}),logger[_0x2bf934(0x141)]('Logged\x20in\x20user\x20...'+_0x1658ca[_0x2bf934(0x1aa)](-0x8)),setTokenRefresh(_0x1658ca),setSessionTimeout('login',_0x1658ca));}}else logger[_0x2bf934(0x29e)](_0x2bf934(0x226));}),_0x2ac313['on'](_0x386696(0x1ba),()=>{resetPassword();}),_0x2ac313['on']('disconnect',_0x10bba8=>{removeClient(_0x2ac313['id']);}),_0x1a9d76==_0x386696(0x245)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x422b52){const _0x34a252=_0xf346f5;if(_0x422b52!=_0x34a252(0x245)&&config['apiKey']!=''){if(pid[_0x422b52])pid[_0x422b52][_0x34a252(0x24e)]({'function':_0x34a252(0xf0),'args':null});}_0x422b52!=_0x34a252(0x245)&&broadcastToBots(_0x34a252(0x118),JSON[_0x34a252(0xce)](config));}function reloadBotManager(){const _0x4d4a5b=_0xf346f5;getClientsWithBotID(_0x4d4a5b(0x245))[_0x4d4a5b(0x263)](_0x1b5343=>{const _0x2ae72f=_0x4d4a5b;getSocket(_0x1b5343['id'])[_0x2ae72f(0x1e8)](_0x2ae72f(0x289),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x2a7ec7){const _0x349fef=_0xf346f5;return io[_0x349fef(0xbb)]['sockets'][_0x349fef(0x151)](_0x2a7ec7);}function setAccess(_0x29a223){const _0x15392b=_0xf346f5,_0x34c65d=getSocket(_0x29a223['id']),_0x416beb=_0x29a223[_0x15392b(0xe4)],_0x5ea3d9=_0x29a223[_0x15392b(0x1eb)];devices[_0x416beb][_0x15392b(0x201)]=validateAccess(devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x115)],_0x416beb),logger[_0x15392b(0x141)](_0x15392b(0x1e1)+devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x1d1)]+_0x15392b(0x299)+_0x29a223['id'][_0x15392b(0x1aa)](-0x8)+_0x15392b(0x21e)+_0x416beb[_0x15392b(0x1aa)](-0x8)),_0x34c65d[_0x15392b(0x29a)](_0x416beb);if(devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x17e)]){_0x34c65d[_0x15392b(0x29a)](_0x5ea3d9);if(_0x5ea3d9==_0x15392b(0x245))initializeSocketBotManager(_0x34c65d);else initializeSocketBot(_0x34c65d);initClient(_0x5ea3d9);}devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x115)]&&devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x1d1)]==_0x15392b(0x2a6)&&setSessionTimeout(_0x15392b(0x241),_0x416beb),devices[_0x416beb][_0x15392b(0x201)]['token']&&devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x1d1)]==_0x15392b(0x162)&&setSessionTimeout(_0x15392b(0x15e),_0x416beb),_0x34c65d[_0x15392b(0x1e8)](_0x15392b(0x289),{'status':_0x29a223['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x416beb]['access'],'externalip':devices[_0x416beb]['ip'],'publicKey':secure[_0x15392b(0x1d4)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x416beb]['access'][_0x15392b(0x17e)]==![]&&devices[_0x416beb][_0x15392b(0x201)][_0x15392b(0x1d1)]==_0x15392b(0x28e)&&temporaryAccess2FA(_0x416beb,devices[_0x416beb]['ip']);}function _0xc6ba(){const _0xd7b37a=['mkdirSync','length','get-portfolio','Markdown','\x20|\x20user:\x20...','min','statSync','\x20minutes','\x1b[35m','Failed\x20to\x20download\x20','logs/','lowdb/adapters/FileSync','Unauthorized\x20login\x20attempt\x20(timeout)','getTime','Allow\x20login\x20from\x20IP\x20address\x20','Bot\x20Mgr\x20>\x20','restart','1689325TWiBxN',',\x20must\x20be\x20a\x204\x20digit\x20number','cancel-loading','botID','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','showConfig','cancelLoading','Unauthorized\x20attempt\x20to\x20confirm\x20message','toggleBotMode','cloneDeep','secure','fork','headless','delete-bot','-results.json','from','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','match','new','data','(staging)','version.json','2FA','store','generate','readdirSync','botmanager','2VKRSTO','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','toggle-bot-mode','stop','isDirectory','store-configuration','storeFiat','config','send','2FA\x20login\x20required','invalid\x20credentials','kill','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','generateKeyPairAsync','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20get\x20events','369asuOgw','button','toggle','log','test','assign','output-003.log','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','bbPassword','exit','number',')\x20|\x20Bot\x20','path','forEach','/on\x20-\x20start\x20bot(s)\x0a','disable','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','#RES#','getHours','clientip','Your\x20installation\x20is\x20already\x20up\x20to\x20date','whitelistEnabled','login\x20token\x20generated','post','getSeconds','notification','map','490VkvYlu','address\x20already\x20in\x20use','Unauthorized\x20attempt\x20to\x20log\x20out','Login\x20rejected','temporary\x20access\x20not\x20allowed','login\x20not\x20required','-----------------------------------------------------------------------------------','Error\x20while\x20deleting\x20config\x20files:\x20','tempaccess_reject_','silentRestart','/:bot/history','backupfile','enable','whitelist','filter','callback','catch','Starting\x20new\x20bot\x20|\x20Bot\x20','Notifications\x20enabled','Idling\x20(','-events.json','size',')\x20\x20\x20|\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','status','getStartingBalances','/restart\x20-\x20restart\x20bot(s)\x0a','#RES#\x20if\x20running\x20on\x20server','Ok,\x20will\x20send\x20order\x20notifications\x20only','2FA\x20required','\x20to\x20','#RES#\x20','build','logout','exec','function','zip/','text','bb-settings.json','userid','\x20|\x20client:\x20...','join','search','writeFileSync','backup','full','RSA','|@|','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','telegram2FaApproval','entries','editMessageReplyMarkup','Session\x20expired\x20for\x20user\x20...','temporary\x20token\x20generated','max','manual','value','listen','\x20only\x0a','place-order','lowdb','started','login2fa_','/update\x20-\x20update\x20Balance\x20Bot\x0a','uuid-random','socket.io','config_all','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Restoring\x20bot(s)\x20from\x20backup','RSA-OAEP','disabled','apiSecret','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','format','code','get-messages','Token\x20blacklisted','DEFLATE','/disable\x20-\x20disable\x20notifications\x0a','resetpw_yes','orders','pidExpireLogin','=>\x20Go\x20to\x20#CYA#http://','jsonwebtoken','disconnect','::ffff:127.0.0.1','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','family','0.0.0','Logged\x20out\x20user\x20...','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','auto','sendPortfolioTelegram','sockets','latestversion','mixpanel','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','.zip','index.html','padStart','graphql-request',':\x20Bot\x20Mgr\x20>\x20','output-002.log','127.0.0.1','host','event','restore-backup-file','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Telegraf\x20error:','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','HTML','stringify','reload','lastmsgtelegram','reinstall','ipaddr.js','hashSync','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','settings','sendMetricsTelegram','off_','file','config_alerts','includes','temporary\x20access\x20rejected','live','Restore\x20process\x20aborted','$1_$2_$3','1111028kAItoN','telegramEnabled','reject','\x20(2)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','uuid','File\x20uploaded','socket','date-fns','randomBytes','Notifications\x20disabled','updatebotmanager','ipv6','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','tempaccess_15_','_data','inlineKeyboard','initclient','/upload-backup','sign','All','mtime','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegramIpApproval','exp','-config.json','output-000.log','Starting\x20Balance\x20Bot\x20update','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','accept','init','Unauthorized\x20attempt\x20to\x20update\x20bot','getMonth','Unauthorized\x20attempt\x20to\x20store\x20configuration','/status\x20-\x20show\x20bot(s)\x20status\x0a','Error:\x20Invalid\x20argument\x20','Ok,\x20will\x20send\x20alert\x20notifications\x20only','resetHistory','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Unauthorized\x20attempt\x20to\x20get\x20portfolio','defaults','apiKey','crypto','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Unauthorized\x20attempt\x20to\x20download\x20','reply','timeshift','apiPassword','referer','rmSync','/:bot/performance','bot-','chat','No\x20authentication\x20token','token','alias','start','bots','privateKey','createWriteStream','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','bcryptjs','Error\x20details:','telegraf','write','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','enabled','conn','password','user','\x20>\x20','title','telegramToken','(((.+)+)+)+$','uncaughtException','15\x20min','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','off','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','timestamp','/help\x20-\x20show\x20available\x20commands\x0a','5\x20min','success','Deleted\x20Bot\x20','/:bot/portfolio','/start','Unauthorized\x20attempt\x20to\x20add\x20bot','\x20(1)','3000','Restore\x20process\x20confirmed','split','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','All\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20delete\x20alerts','isIPv4MappedAddress','remove','mode','update-bot','debug','static','login2fa_reject_','Backup\x20file\x20unzipped\x20and\x20stored','showname','clients','backup-full@','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','kind','command','yargs/yargs','temp/','auth','range','push','get','private','unlinkSync','type','SIGTERM','Restarting\x20Bot\x20','status\x20code\x20401','storeHeadless','restore_no_','227995ggZKgy','stopped','environment','storeConfiguration','login','login\x20token\x20valid','update_yes','secret','2FA\x20login\x20token\x20generated','bbUsername','***','telegramUsername','versions','files','sendFile','loginRequired','/:bot/configuration','hasOwnProperty','Bot\x20','keys','yes','User\x20has\x20been\x20validated','30\x20min','inherit','portfolio','simple','Notifications\x20types:\x20','*$1*','metrics_','getDate','binary','12vwNDsu','/:bot/support','messages','All\x20bots','toIPv4Address','allow','reinstall_no','reset-history','\x1b[33m','getUTCHours','585267dVuTAV','Orders','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','set','deleteHistoryAlerts','resetpw_no','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','names','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','error','BCT','close','new-disabled','any','handshake','find','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','getFullYear','settings.','update_no','49008JXiOsY','bbvNew','************','Login\x20accepted','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','15SqUSLz','remoteAddress','argv','replace','NTBA_FIX_319','\x1b[31m','sort','headers','bb-config.json','blacklist','Enabled\x20Bot\x20','botname','backup-full','readFileSync','slice','restore_yes_','telegramEvents','decrypt','username','bb-secure.json','store-fiat','getMinutes','string','copyFileSync','bbvReceive','encryptedUuid','\x20mode','use','\x1b[0m','api-eu.mixpanel.com','reset-password','then','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','/off\x20-\x20stop\x20bot(s)\x0a','hex','config/','toString','port','reinstall_yes','expiry','#RES#\x20if\x20running\x20locally\x0a','tkn','show','internal','telegrammsg','warning','Network\x20Interfaces:','Restore\x20backup\x20file\x20','express-fileupload','verify','SIGINT','Invalid\x20IP\x20address','reason','sortBy','staging','publicKey','createServer','<b>Balance\x20Bot\x20Status:</b>\x0a','temporaryAccessAllowed','endsWith','logged\x20out','removeAllListeners','name','f2aRequired','Password\x20has\x20been\x20reset\x20to:\x20','onepagemode','confirm-message','add','Setting\x20access:\x20','compareSync','/output-000.log','metrics','address','parse','startsWith','emit','hybrid-crypto-js','running','bot','telegram','pidRefreshToken','temporary\x20access\x20timeout','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','-performance.json','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','build2','No\x20bots\x20running\x20right\x20now','Yes','50430NjjfNN','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','backup/','node','login\x20required','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','ipc','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','marketcapApi','get-backup-files','access','on_','Unauthorized\x20attempt\x20to\x20update\x20settings','\x20|\x20','tempaccess_30_','all','telegramChatId','once','2FA\x20login\x20rejected','action','1692804AieUSp','update',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','message','Access\x20enabled\x20for\x20','help','Notifications\x20enabled\x0a','get-starting-balances','alerts','lastmsgemitted','node-zip','config_orders','version','existsSync','child_process'];_0xc6ba=function(){return _0xd7b37a;};return _0xc6ba();}function setSessionTimeout(_0x3433dc,_0x61529b){const _0x2506d5=_0xf346f5;let _0x43c867;if(_0x3433dc==_0x2506d5(0x15e))_0x43c867=loginExpiry*0x3c*0x3e8;else _0x43c867=devices[_0x61529b][_0x2506d5(0xf6)][_0x2506d5(0x1c4)]*0x3c*0x3e8-(new Date()[_0x2506d5(0x227)]()-devices[_0x61529b][_0x2506d5(0xf6)][_0x2506d5(0x12e)]);if(devices[_0x61529b][_0x2506d5(0xae)])clearTimeout(devices[_0x61529b][_0x2506d5(0xae)]);devices[_0x61529b][_0x2506d5(0xae)]=setTimeout(()=>{const _0x3bb7ed=_0x2506d5;if(devices[_0x61529b][_0x3bb7ed(0x1ed)])clearTimeout(devices[_0x61529b][_0x3bb7ed(0x1ed)]);removeSocketListeners(_0x61529b),addBlacklist(_0x61529b),devices[_0x61529b]['telegramIpApproval']=null,devices[_0x61529b][_0x3bb7ed(0x2a2)]=null,devices[_0x61529b][_0x3bb7ed(0x201)][_0x3bb7ed(0x115)]=null,logger[_0x3bb7ed(0x141)](_0x3bb7ed(0x2a5)+_0x61529b['slice'](-0x8)),devices[_0x61529b][_0x3bb7ed(0x201)]=validateAccess(devices[_0x61529b][_0x3bb7ed(0x201)][_0x3bb7ed(0x115)],_0x61529b),!(devices[_0x61529b]['access'][_0x3bb7ed(0x17e)]&&devices[_0x61529b]['access'][_0x3bb7ed(0x1d1)]==_0x3bb7ed(0x276))&&(_0x3433dc=='login'?io['to'](_0x61529b)['emit']('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x61529b)[_0x3bb7ed(0x1e8)](_0x3bb7ed(0x289),{'access':{'allow':![],'reason':_0x3bb7ed(0x1ee),'token':null}})),devices[_0x61529b][_0x3bb7ed(0x201)][_0x3bb7ed(0x115)]=null;},_0x43c867);}function setTokenRefresh(_0x8df66){const _0x2ba56b=_0xf346f5;if(devices[_0x8df66][_0x2ba56b(0x1ed)])clearTimeout(devices[_0x8df66][_0x2ba56b(0x1ed)]);devices[_0x8df66][_0x2ba56b(0x1ed)]=setTimeout(()=>{const _0x23be1a=_0x2ba56b;getClientsWithUuid(_0x8df66)[_0x23be1a(0x21b)]!=0x0?(devices[_0x8df66]['access']=refreshToken(_0x8df66),io['to'](_0x8df66)[_0x23be1a(0x1e8)](_0x23be1a(0x289),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x8df66][_0x23be1a(0x201)],'externalip':devices[_0x8df66]['ip'],'publicKey':secure[_0x23be1a(0x1d4)],'validInstallation':validInstallation}),setTokenRefresh(_0x8df66)):clearTimeout(devices[_0x8df66][_0x23be1a(0x1ed)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function _0x2548(_0x550992,_0xe35c2c){const _0xf89179=_0xc6ba();return _0x2548=function(_0x5e3f77,_0x1ac098){_0x5e3f77=_0x5e3f77-0x9b;let _0xc6ba61=_0xf89179[_0x5e3f77];return _0xc6ba61;},_0x2548(_0x550992,_0xe35c2c);}function initializeSocketBotManager(_0x1c4a52){const _0x36c072=_0xf346f5,_0x5970df=getClient(_0x1c4a52['id'])[_0x36c072(0xe4)];_0x1c4a52[_0x36c072(0x1e8)](_0x36c072(0x118),config),_0x1c4a52['emit'](_0x36c072(0xd5),cleanSettings()),_0x1c4a52['on']('add-bot',_0x1323c1=>{const _0x1713f2=_0x36c072;if(validateAccess(_0x1323c1,_0x5970df)[_0x1713f2(0x17e)])addBot();else logger['full'](_0x1713f2(0x135));}),_0x1c4a52['on'](_0x36c072(0x140),(_0x233ff4,_0x556ca4)=>{const _0x20a0a4=_0x36c072;if(validateAccess(_0x556ca4,_0x5970df)[_0x20a0a4(0x17e)])toggleBot(_0x233ff4[_0x20a0a4(0x22e)],_0x233ff4[_0x20a0a4(0x289)],_0x233ff4['live']);else logger[_0x20a0a4(0x29e)](_0x20a0a4(0xfe));}),_0x1c4a52['on'](_0x36c072(0x248),(_0x3129a3,_0x5eac3b)=>{const _0x29acd2=_0x36c072;if(validateAccess(_0x5eac3b,_0x5970df)[_0x29acd2(0x17e)])toggleBotMode(_0x3129a3);else logger[_0x29acd2(0x29e)](_0x29acd2(0xfe));}),_0x1c4a52['on'](_0x36c072(0x238),(_0xf7bf1b,_0x53284f)=>{const _0x5ed15c=_0x36c072;if(validateAccess(_0x53284f,_0x5970df)[_0x5ed15c(0x17e)])deleteBot(_0xf7bf1b);else logger[_0x5ed15c(0x29e)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1c4a52['on']('store-settings',(_0x24bc1f,_0x360df3)=>{const _0x4fc922=_0x36c072;if(validateAccess(_0x360df3,_0x5970df)['allow'])storeSettings(_0x24bc1f,!![]);else logger[_0x4fc922(0x29e)](_0x4fc922(0x203));}),_0x1c4a52['on']('update-bb',_0x55314d=>{const _0x52ba84=_0x36c072;if(validateAccess(_0x55314d,_0x5970df)[_0x52ba84(0x17e)])updateBB(_0x52ba84(0x20c));else logger[_0x52ba84(0x29e)](_0x52ba84(0xb8));}),_0x1c4a52['on']('reinstall-bb',_0x5616fa=>{const _0x26b8a9=_0x36c072;if(validateAccess(_0x5616fa,_0x5970df)[_0x26b8a9(0x17e)])updateBB(_0x26b8a9(0xd1));else logger[_0x26b8a9(0x29e)](_0x26b8a9(0x252));}),_0x1c4a52['on'](_0x36c072(0x200),_0x303a56=>{const _0x49efb5=_0x36c072;if(validateAccess(_0x303a56,_0x5970df)[_0x49efb5(0x17e)]){const _0xaa2b9d=getClient(_0x1c4a52['id']);if(_0xaa2b9d)getBackupFiles(_0xaa2b9d[_0x49efb5(0xe4)]);else logger[_0x49efb5(0x29e)](_0x49efb5(0xcc));}else logger[_0x49efb5(0x29e)](_0x49efb5(0x23b));}),_0x1c4a52['on'](_0x36c072(0xc9),(_0x14ef98,_0x2ac1fa)=>{const _0x7325f4=_0x36c072;if(validateAccess(_0x2ac1fa,_0x5970df)[_0x7325f4(0x17e)])restoreBackupFile(_0x14ef98);else logger[_0x7325f4(0x29e)](_0x7325f4(0xa0));}),_0x1c4a52['on'](_0x36c072(0xa8),_0x354058=>{const _0x2f6c12=_0x36c072;if(validateAccess(_0x354058,_0x5970df)[_0x2f6c12(0x17e)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1c4a52['on']('confirm-message',(_0x50c832,_0x39d64f)=>{const _0x4ee767=_0x36c072;if(validateAccess(_0x39d64f,_0x5970df)[_0x4ee767(0x17e)])confirmMessage(_0x50c832);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1c4a52['on']('logout',_0x33a71c=>{const _0x31cc04=_0x36c072;if(validateAccess(_0x33a71c,_0x5970df)[_0x31cc04(0x17e)]){if(devices[_0x5970df]['pidRefreshToken'])clearTimeout(devices[_0x5970df][_0x31cc04(0x1ed)]);if(devices[_0x5970df][_0x31cc04(0xae)])clearTimeout(devices[_0x5970df][_0x31cc04(0xae)]);removeSocketListeners(getClient(_0x1c4a52['id'])[_0x31cc04(0xe4)]),addBlacklist(_0x5970df),devices[_0x5970df][_0x31cc04(0xf6)]=null,devices[_0x5970df]['telegram2FaApproval']=null,devices[_0x5970df][_0x31cc04(0x201)][_0x31cc04(0x115)]=null,logger[_0x31cc04(0x141)](_0x31cc04(0xb7)+_0x5970df['slice'](-0x8)),io['to'](getClient(_0x1c4a52['id'])['uuid'])[_0x31cc04(0x1e8)]('status',{'access':{'allow':![],'reason':_0x31cc04(0x1d9),'token':null}});}else logger[_0x31cc04(0x29e)](_0x31cc04(0x273));});}function initializeSocketBot(_0x2c0896){const _0x195637=_0xf346f5,_0x42aa2c=getClient(_0x2c0896['id'])[_0x195637(0x1eb)],_0x2da6c2=getClient(_0x2c0896['id'])[_0x195637(0xe4)];_0x2c0896['on']('get-logs',(_0x30d3af,_0x19d24a)=>{const _0x474d21=_0x195637;if(validateAccess(_0x19d24a,_0x2da6c2)[_0x474d21(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x474d21(0x24e)]({'function':'emitHistory','args':_0x30d3af});}else logger['full'](_0x474d21(0x255));}),_0x2c0896['on']('delete-alerts',(_0x976ae3,_0x12fb54)=>{const _0x543283=_0x195637;if(validateAccess(_0x12fb54,_0x2da6c2)[_0x543283(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x543283(0x24e)]({'function':_0x543283(0x187),'args':_0x976ae3});}else logger[_0x543283(0x29e)](_0x543283(0x13c));}),_0x2c0896['on'](_0x195637(0x21c),(_0x3f1274,_0x4da14f)=>{const _0x47931e=_0x195637;if(validateAccess(_0x4da14f,_0x2da6c2)[_0x47931e(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c]['send']({'function':'getPortfolio','args':_0x3f1274});}else logger[_0x47931e(0x29e)](_0x47931e(0x106));}),_0x2c0896['on'](_0x195637(0x24b),(_0x3316db,_0x8c0a2a)=>{const _0x12d8e1=_0x195637;if(validateAccess(_0x8c0a2a,_0x2da6c2)['allow']){if(pid[_0x42aa2c])pid[_0x42aa2c]['send']({'function':_0x12d8e1(0x15d),'args':_0x3316db});}else logger[_0x12d8e1(0x29e)](_0x12d8e1(0x100));}),_0x2c0896['on']('store-headless',(_0x53a9a5,_0x536cf5)=>{const _0x4cd993=_0x195637;if(validateAccess(_0x536cf5,_0x2da6c2)['allow']){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x4cd993(0x24e)]({'function':_0x4cd993(0x158),'args':_0x53a9a5});}else logger['full'](_0x4cd993(0x1bd));}),_0x2c0896['on'](_0x195637(0x1b0),(_0x5e793e,_0x91bfbc)=>{const _0x230d8f=_0x195637;if(validateAccess(_0x91bfbc,_0x2da6c2)[_0x230d8f(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x230d8f(0x24e)]({'function':_0x230d8f(0x24c),'args':_0x5e793e});}else logger[_0x230d8f(0x29e)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x2c0896['on'](_0x195637(0x180),_0x3828e8=>{const _0x370abf=_0x195637;if(validateAccess(_0x3828e8,_0x2da6c2)[_0x370abf(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x370abf(0x24e)]({'function':_0x370abf(0x104),'args':null});}else logger[_0x370abf(0x29e)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2c0896['on'](_0x195637(0x212),_0x3ba75d=>{const _0x1af3e3=_0x195637;if(validateAccess(_0x3ba75d,_0x2da6c2)[_0x1af3e3(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x1af3e3(0x24e)]({'function':_0x1af3e3(0x28a),'args':null});}else logger['full'](_0x1af3e3(0x1bc));}),_0x2c0896['on'](_0x195637(0x2ac),(_0xfbf597,_0x1f995d)=>{const _0x4f0c6b=_0x195637;if(validateAccess(_0x1f995d,_0x2da6c2)[_0x4f0c6b(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c][_0x4f0c6b(0x24e)]({'function':'placeOrder','args':_0xfbf597});}else logger[_0x4f0c6b(0x29e)](_0x4f0c6b(0xec));}),_0x2c0896['on'](_0x195637(0x22d),_0x48d077=>{const _0x462958=_0x195637;if(validateAccess(_0x48d077,_0x2da6c2)[_0x462958(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c]['send']({'function':_0x462958(0x231),'args':null});}else logger['full'](_0x462958(0x12b));}),_0x2c0896['on']('show-config',_0xe05bf2=>{const _0x1e1d33=_0x195637;if(validateAccess(_0xe05bf2,_0x2da6c2)[_0x1e1d33(0x17e)]){if(pid[_0x42aa2c])pid[_0x42aa2c]['send']({'function':_0x1e1d33(0x230),'args':null});}else logger[_0x1e1d33(0x29e)](_0x1e1d33(0x149));}),_0x2c0896['on']('update-bb',_0x4e900f=>{const _0x1e689e=_0x195637;if(validateAccess(_0x4e900f,_0x2da6c2)['allow'])updateBB(_0x1e689e(0x20c));else logger[_0x1e689e(0x29e)](_0x1e689e(0xb8));}),_0x2c0896['on']('get-messages',_0x499c43=>{const _0xfe9ad6=_0x195637;if(validateAccess(_0x499c43,_0x2da6c2)[_0xfe9ad6(0x17e)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2c0896['on'](_0x195637(0x1df),(_0x13a6c1,_0x4f4dfc)=>{const _0x19e4f1=_0x195637;if(validateAccess(_0x4f4dfc,_0x2da6c2)[_0x19e4f1(0x17e)])confirmMessage(_0x13a6c1);else logger['full'](_0x19e4f1(0x232));}),_0x2c0896['on'](_0x195637(0x292),_0x16280e=>{const _0x459c3c=_0x195637;if(validateAccess(_0x16280e,_0x2da6c2)[_0x459c3c(0x17e)]){if(devices[_0x2da6c2][_0x459c3c(0x1ed)])clearTimeout(devices[_0x2da6c2][_0x459c3c(0x1ed)]);if(devices[_0x2da6c2][_0x459c3c(0xae)])clearTimeout(devices[_0x2da6c2]['pidExpireLogin']);removeSocketListeners(getClient(_0x2c0896['id'])[_0x459c3c(0xe4)]),addBlacklist(_0x2da6c2),devices[_0x2da6c2][_0x459c3c(0xf6)]=null,devices[_0x2da6c2]['telegram2FaApproval']=null,devices[_0x2da6c2]['access']['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x2da6c2[_0x459c3c(0x1aa)](-0x8)),io['to'](getClient(_0x2c0896['id'])['uuid'])['emit'](_0x459c3c(0x289),{'access':{'allow':![],'reason':_0x459c3c(0x1d9),'token':null}});}else logger[_0x459c3c(0x29e)](_0x459c3c(0x273));});}function removeSocketListeners(_0x1aebe0){const _0x23465e=_0xf346f5;getClientsWithUuid(_0x1aebe0)[_0x23465e(0x263)](_0x40aeb4=>{const _0x4fe6a6=_0x23465e;getSocket(_0x40aeb4['id'])[_0x4fe6a6(0x1da)]();});}function cleanSettings(){const _0x3b826e=_0xf346f5;let _0x5e48eb=settings;return settings[_0x3b826e(0x127)]&&settings[_0x3b826e(0x127)]!=''&&(_0x5e48eb={..._0x5e48eb,'telegramToken':'************'}),settings[_0x3b826e(0x25e)]&&settings[_0x3b826e(0x25e)]!=''&&(_0x5e48eb={..._0x5e48eb,'bbPassword':_0x3b826e(0x199)}),settings[_0x3b826e(0x1ff)]&&settings[_0x3b826e(0x1ff)]!=''&&(_0x5e48eb={..._0x5e48eb,'marketcapApi':_0x3b826e(0x199)}),(settings[_0x3b826e(0x25e)]&&settings[_0x3b826e(0x25e)]=='***'||settings[_0x3b826e(0x127)]&&settings['telegramToken']==_0x3b826e(0x164)||settings[_0x3b826e(0x1ff)]&&settings[_0x3b826e(0x1ff)]==_0x3b826e(0x164))&&(_0x5e48eb={..._0x5e48eb,'restored':{'password':settings[_0x3b826e(0x25e)]==_0x3b826e(0x164),'telegram':settings['telegramToken']==_0x3b826e(0x164),'marketcap':settings[_0x3b826e(0x1ff)]==_0x3b826e(0x164)}}),_0x5e48eb;}async function updateBB(_0x42fee0){const _0xcba1d7=_0xf346f5;await backupConfigFiles(),installingUpdate=!![],config[_0xcba1d7(0x263)](_0x1fb1a9=>{restartBot(_0x1fb1a9['botID']);});if(_0x42fee0==_0xcba1d7(0x20c))process[_0xcba1d7(0x24e)]({'update':!![],'environment':environment},_0x16f9fa=>{});else _0x42fee0==_0xcba1d7(0xd1)&&process[_0xcba1d7(0x24e)]({'reinstall':!![],'environment':environment},_0x10860a=>{});}function startBot(_0x1cde91,_0x193d6a,_0x2fb286){const _0x3bf987=_0xf346f5;if(debugging)_0x1cde91[_0x3bf987(0x150)]('-d');let _0x11c12a=![];const _0x34c4d4=_0x1cde91[0x0];_0x193d6a={..._0x193d6a,'stdio':[_0x3bf987(0x171),_0x3bf987(0x171),'inherit',_0x3bf987(0x1fc)]},pid[_0x34c4d4]=childProcess[_0x3bf987(0x236)](botfile,_0x1cde91,_0x193d6a),pid[_0x34c4d4]['on']('message',_0x3cb80f=>{const _0x38b4bf=_0x3bf987;switch(Object[_0x38b4bf(0x16d)](_0x3cb80f)[0x0]){case _0x38b4bf(0x1a7):updateBotName(_0x34c4d4,_0x3cb80f[_0x38b4bf(0x1a7)]);break;case _0x38b4bf(0xea):updateBotManager();break;case _0x38b4bf(0x289):updateStatus(_0x34c4d4,_0x3cb80f[_0x38b4bf(0x289)]);break;case'live':updateLive(_0x34c4d4,_0x3cb80f[_0x38b4bf(0xdc)]);break;case _0x38b4bf(0x2ae):updateLive(_0x34c4d4,_0x3cb80f[_0x38b4bf(0x2ae)]),io['to'](_0x34c4d4)[_0x38b4bf(0x1e8)]('status',{'access':{'allow':![],'reason':_0x38b4bf(0xcf),'token':null}});break;case _0x38b4bf(0x249):_0x3cb80f[_0x38b4bf(0x249)]==_0x38b4bf(0x22a)&&restartBot(_0x34c4d4);_0x3cb80f[_0x38b4bf(0x249)]==_0x38b4bf(0x251)&&toggleBot(_0x34c4d4,_0x38b4bf(0xa3),_0x38b4bf(0x15b));break;case _0x38b4bf(0x1ec):sendTelegramBot(_0x34c4d4,_0x3cb80f[_0x38b4bf(0x1ec)]);break;case _0x38b4bf(0x1c9):sendTelegramMsg(_0x3cb80f[_0x38b4bf(0x1c9)]);break;case _0x38b4bf(0x294):io['to'](_0x34c4d4)[_0x38b4bf(0x1e8)](_0x3cb80f[_0x38b4bf(0x294)],_0x3cb80f['args']);break;}}),pid[_0x34c4d4]['on'](_0x3bf987(0x18c),function(_0x73f675){if(_0x11c12a)return;_0x11c12a=!![],_0x2fb286(_0x73f675);}),pid[_0x34c4d4]['on']('exit',async function(_0xcd67cd){const _0x991e38=_0x3bf987;if(terminating)return;if(installingUpdate){logger['debug'](_0x991e38(0x2a1)),io[_0x991e38(0x18e)]();return;}if(_0x11c12a)return;_0x11c12a=!![],_0x2fb286(null);const _0x561a58=dbConfig[_0x991e38(0x151)](_0x991e38(0x118))[_0x991e38(0x192)]({'botID':_0x34c4d4})[_0x991e38(0x2a9)]();_0x561a58&&(_0x561a58[_0x991e38(0x289)]=='enabled'||_0x561a58[_0x991e38(0x289)]==_0x991e38(0x23d))&&(await sleep(0x3e8),updateLive(_0x34c4d4,_0x991e38(0x15b)),_0xcd67cd==0x4d?logger[_0x991e38(0x141)]('Restarting\x20(silent)\x20Bot\x20'+_0x34c4d4):logger[_0x991e38(0x29e)](_0x991e38(0x156)+_0x34c4d4),startBot([_0x34c4d4,userID],{'cwd':bbpath},function(_0x538d8f){if(_0x538d8f)logger['full'](_0x538d8f);}));});}function stopBot(_0x1db88b){const _0x45b44e=_0xf346f5;getClientsWithBotID(_0x1db88b)[_0x45b44e(0x263)](_0x855ecf=>{getSocket(_0x855ecf['id'])['disconnect'](!![]),removeClient(_0x855ecf['id']);}),pid[_0x1db88b]&&(pid[_0x1db88b][_0x45b44e(0x251)](),pid[_0x1db88b]=null);}function stopAllBots(){const _0x383740=_0xf346f5;terminating=!![];const _0x366a71=getEnabledBots();_0x366a71[_0x383740(0x263)](_0x330569=>{const _0x3201dc=_0x383740;stopBot(_0x330569[_0x3201dc(0x22e)]);});}function restartBot(_0x3fded3){const _0x8639e6=_0xf346f5;if(pid[_0x3fded3])pid[_0x3fded3][_0x8639e6(0x251)]();}function restartAllBots(){const _0x2bc30d=getEnabledBots();_0x2bc30d['forEach'](()=>{const _0xc5071b=_0x2548;broadcastToBots(_0xc5071b(0x294),_0xc5071b(0x27a));});}function addBot(){const _0x4e8b89=_0xf346f5;let _0x3c9e3d;for(let _0x29b04e=0x1;_0x29b04e<0x3e9;_0x29b04e++){_0x3c9e3d=_0x29b04e[_0x4e8b89(0x1c1)]()['padStart'](0x3,'0');let _0x1f04ce=config[_0x4e8b89(0x192)](_0xde9197=>_0xde9197[_0x4e8b89(0x22e)]==_0x3c9e3d);if(!_0x1f04ce)break;}if(_0x3c9e3d==='1000'){logger[_0x4e8b89(0x29e)](_0x4e8b89(0x13a));return;}logger[_0x4e8b89(0x29e)](_0x4e8b89(0x282)+_0x3c9e3d),dbConfig[_0x4e8b89(0x151)](_0x4e8b89(0x118))[_0x4e8b89(0x150)]({'botID':_0x3c9e3d,'botname':_0x4e8b89(0x16c)+_0x3c9e3d,'status':_0x4e8b89(0x23d),'live':''})['write'](),startBot([_0x3c9e3d,userID],{'cwd':bbpath},function(_0x2095bb){const _0x5c81a5=_0x4e8b89;if(_0x2095bb)logger[_0x5c81a5(0x29e)](_0x2095bb);}),config=getConfiguration(),io['to'](_0x4e8b89(0x245))[_0x4e8b89(0x1e8)](_0x4e8b89(0x118),config),broadcastToBots(_0x4e8b89(0x118),JSON[_0x4e8b89(0xce)](config));}function deleteBot(_0x29c3ac){const _0x2ac09c=_0xf346f5;getClientsWithBotID(_0x29c3ac)[_0x2ac09c(0x263)](_0x23e971=>{const _0x244e80=_0x2ac09c;getSocket(_0x23e971['id'])[_0x244e80(0xb1)](!![]),removeClient(_0x23e971['id']);}),dbConfig[_0x2ac09c(0x151)]('bots')[_0x2ac09c(0x13e)]({'botID':_0x29c3ac})[_0x2ac09c(0x11f)](),logger['full'](_0x2ac09c(0x132)+_0x29c3ac),stopBot(_0x29c3ac);try{if(fs[_0x2ac09c(0x218)](path[_0x2ac09c(0x29a)](configpath,_0x2ac09c(0x112)+_0x29c3ac+'-config.json')))fs['unlinkSync'](path[_0x2ac09c(0x29a)](configpath,_0x2ac09c(0x112)+_0x29c3ac+_0x2ac09c(0xf8)));if(fs[_0x2ac09c(0x218)](path[_0x2ac09c(0x29a)](configpath,_0x2ac09c(0x112)+_0x29c3ac+_0x2ac09c(0x285))))fs['unlinkSync'](path[_0x2ac09c(0x29a)](configpath,'bot-'+_0x29c3ac+_0x2ac09c(0x285)));if(fs[_0x2ac09c(0x218)](path[_0x2ac09c(0x29a)](configpath,'bot-'+_0x29c3ac+_0x2ac09c(0x1f1))))fs['unlinkSync'](path['join'](configpath,_0x2ac09c(0x112)+_0x29c3ac+_0x2ac09c(0x1f1)));if(fs['existsSync'](path[_0x2ac09c(0x29a)](configpath,_0x2ac09c(0x112)+_0x29c3ac+_0x2ac09c(0x239))))fs['unlinkSync'](path[_0x2ac09c(0x29a)](configpath,_0x2ac09c(0x112)+_0x29c3ac+_0x2ac09c(0x239)));}catch(_0x36c530){if(_0x36c530)logger['full'](_0x2ac09c(0x278),_0x36c530);}config=getConfiguration(),io['to'](_0x2ac09c(0x245))[_0x2ac09c(0x1e8)](_0x2ac09c(0x118),config),broadcastToBots(_0x2ac09c(0x118),JSON[_0x2ac09c(0xce)](config));}function toggleBot(_0x54b86c,_0x52aeed,_0x1c0fe1){const _0x3a19b1=_0xf346f5;dbConfig[_0x3a19b1(0x151)](_0x3a19b1(0x118))[_0x3a19b1(0x192)]({'botID':_0x54b86c})[_0x3a19b1(0x25b)]({'status':_0x52aeed})[_0x3a19b1(0x25b)]({'live':_0x1c0fe1})[_0x3a19b1(0x11f)]();if(_0x52aeed=='enabled'||_0x52aeed=='new')logger[_0x3a19b1(0x29e)](_0x3a19b1(0x1a6)+_0x54b86c),startBot([_0x54b86c,userID],{'cwd':bbpath},function(_0x57f8f7){if(_0x57f8f7)logger['full'](_0x57f8f7);});else(_0x52aeed=='disabled'||_0x52aeed==_0x3a19b1(0x18f))&&(logger[_0x3a19b1(0x29e)]('Disabled\x20Bot\x20'+_0x54b86c),stopBot(_0x54b86c));config=getConfiguration(),io['to'](_0x3a19b1(0x245))[_0x3a19b1(0x1e8)](_0x3a19b1(0x118),config),broadcastToBots(_0x3a19b1(0x118),JSON[_0x3a19b1(0xce)](config));}function toggleStatus(_0x3e9928){const _0x31d6d1=_0xf346f5;let _0x392c87=dbConfig[_0x31d6d1(0x151)](_0x31d6d1(0x118))['find']({'botID':_0x3e9928})['value'](),_0x5bcd05;if(_0x392c87[_0x31d6d1(0x289)]===_0x31d6d1(0x121))_0x5bcd05='disabled';else{if(_0x392c87['status']==='new')_0x5bcd05=_0x31d6d1(0x18f);else{if(_0x392c87['status']===_0x31d6d1(0x18f))_0x5bcd05=_0x31d6d1(0x23d);else{if(_0x392c87[_0x31d6d1(0x289)]===_0x31d6d1(0xa3))_0x5bcd05=_0x31d6d1(0x121);}}}return _0x5bcd05;}function updateStatus(_0x59f303,_0x4e212f){const _0x9abb93=_0xf346f5;dbConfig[_0x9abb93(0x151)](_0x9abb93(0x118))[_0x9abb93(0x192)]({'botID':_0x59f303})[_0x9abb93(0x25b)]({'status':_0x4e212f})[_0x9abb93(0x11f)](),config=getConfiguration(),io['to']('botmanager')[_0x9abb93(0x1e8)](_0x9abb93(0x118),config),broadcastToBots(_0x9abb93(0x118),JSON[_0x9abb93(0xce)](config));}function updateLive(_0x2f6b8d,_0x471c57){const _0x1b3a06=_0xf346f5;dbConfig[_0x1b3a06(0x151)](_0x1b3a06(0x118))[_0x1b3a06(0x192)]({'botID':_0x2f6b8d})['assign']({'live':_0x471c57})[_0x1b3a06(0x11f)](),config=getConfiguration(),io['to']('botmanager')[_0x1b3a06(0x1e8)]('bots',config),broadcastToBots('bots',JSON[_0x1b3a06(0xce)](config));}function updateBotName(_0x4b1954,_0x5c016e){const _0x4b9ad8=_0xf346f5;dbConfig[_0x4b9ad8(0x151)](_0x4b9ad8(0x118))[_0x4b9ad8(0x192)]({'botID':_0x4b1954})[_0x4b9ad8(0x25b)]({'botname':_0x5c016e})['write'](),config=getConfiguration(),io['to'](_0x4b9ad8(0x245))[_0x4b9ad8(0x1e8)](_0x4b9ad8(0x118),config),broadcastToBots(_0x4b9ad8(0x118),JSON['stringify'](config));}function updateBotManager(){const _0x4cb61a=_0xf346f5;config=getConfiguration(),io['to'](_0x4cb61a(0x245))[_0x4cb61a(0x1e8)](_0x4cb61a(0x118),config),broadcastToBots(_0x4cb61a(0x118),JSON['stringify'](config));}function toggleBotMode(_0x19b4a){const _0x53eea4=_0xf346f5;if(pid[_0x19b4a])pid[_0x19b4a][_0x53eea4(0x24e)]({'function':_0x53eea4(0x233),'args':null});else{const _0x48fa95=configpath+_0x53eea4(0x112)+_0x19b4a+_0x53eea4(0xf8),_0x4dc244=fs['readFileSync'](_0x48fa95),_0x2a1da=JSON['parse'](_0x4dc244),_0xd6cb90=_0x2a1da['bot'][0x0][_0x53eea4(0x237)];_0x2a1da[_0x53eea4(0x1eb)][0x0][_0x53eea4(0x237)]=!_0xd6cb90;const _0x592fa7=JSON[_0x53eea4(0xce)](_0x2a1da,null,0x2);fs['writeFileSync'](_0x48fa95,_0x592fa7),config=getConfiguration(),io['to']('botmanager')['emit'](_0x53eea4(0x118),config),broadcastToBots(_0x53eea4(0x118),JSON[_0x53eea4(0xce)](config));}}function validateTelegram(_0x3df808){const _0x2b4746=_0xf346f5;if(_0x3df808[_0x2b4746(0x23a)][_0x2b4746(0x1ae)]!=settings[_0x2b4746(0x165)]&&'@'+_0x3df808[_0x2b4746(0x23a)][_0x2b4746(0x1ae)]!=settings[_0x2b4746(0x165)]||_0x3df808[_0x2b4746(0x113)]['id']!=settings['telegramChatId'])return sendTelegram(_0x3df808[_0x2b4746(0x113)]['id'],_0x2b4746(0x1f0),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x469c40=_0xf346f5;if(tgBot)tgBot[_0x469c40(0x249)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x469c40(0x127)]);let _0x41804a='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x41804a+='\x0a',_0x41804a+='/enable\x20-\x20enable\x20notifications\x0a',_0x41804a+=_0x469c40(0xab),_0x41804a+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x41804a+=_0x469c40(0x28b),_0x41804a+=_0x469c40(0x264),_0x41804a+=_0x469c40(0x1be),_0x41804a+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x41804a+='/names\x20-\x20show\x20bot\x20names\x0a',_0x41804a+=_0x469c40(0x101),_0x41804a+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x41804a+=_0x469c40(0x120),_0x41804a+=_0x469c40(0x9c),_0x41804a+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x41804a+=_0x469c40(0x12f);let _0x300613=_0x469c40(0x1fe);_0x300613+='\x0a',_0x300613+=_0x41804a,tgBot[_0x469c40(0x281)]((_0x1d147a,_0x5d1182)=>{const _0x3734e9=_0x469c40;logger['simple'](getTimeStamp()+_0x3734e9(0x288)),logger['debug'](_0x3734e9(0xcb),_0x1d147a);}),tgBot[_0x469c40(0x1b7)](async(_0x1717f1,_0xdcd7a1)=>{const _0x444be5=_0x469c40;if(!(!settings[_0x444be5(0x207)]&&_0x1717f1['update']['message'][_0x444be5(0x296)]==_0x444be5(0x134))){if(!validateTelegram(_0x1717f1))return;}_0xdcd7a1();}),tgBot[_0x469c40(0x14b)](_0x469c40(0x117),async _0x2f858a=>{const _0x57ed3b=_0x469c40;if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x2f858a[_0x57ed3b(0x113)]['id']);updateSetting(_0x57ed3b(0xe0),!![]);if(!validateTelegram(_0x2f858a))return;await sendTelegram(_0x2f858a['chat']['id'],_0x300613);}),tgBot['command'](_0x469c40(0x27d),async _0x4aacfd=>{const _0x1fae83=_0x469c40;updateSetting(_0x1fae83(0xe0),!![]),await sendTelegram(_0x4aacfd[_0x1fae83(0x113)]['id'],_0x1fae83(0x283));}),tgBot[_0x469c40(0x14b)](_0x469c40(0x265),async _0x2cf735=>{const _0x498180=_0x469c40;await sendTelegram(_0x2cf735[_0x498180(0x113)]['id'],_0x498180(0xe9)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x469c40(0x24d),async _0x3ed038=>{const _0x50a0a5=_0x469c40,_0x8bd58f=Markup['inlineKeyboard']([Markup[_0x50a0a5(0x257)]['callback'](_0x50a0a5(0x184),_0x50a0a5(0x216)),Markup[_0x50a0a5(0x257)][_0x50a0a5(0x280)]('Alerts',_0x50a0a5(0xd9)),Markup['button'][_0x50a0a5(0x280)](_0x50a0a5(0xf3),_0x50a0a5(0x9f))]);_0x3ed038[_0x50a0a5(0x10c)](_0x50a0a5(0xb3),_0x8bd58f);}),tgBot['action'](_0x469c40(0x216),async _0x2c3954=>{const _0x1c2f7e=_0x469c40;_0x2c3954[_0x1c2f7e(0x2a4)](),updateSetting('telegramEvents',_0x1c2f7e(0xad)),updateSetting(_0x1c2f7e(0xe0),!![]),await sendTelegram(_0x2c3954[_0x1c2f7e(0x113)]['id'],_0x1c2f7e(0x28d));}),tgBot['action'](_0x469c40(0xd9),async _0x54a15f=>{const _0x48fd53=_0x469c40;_0x54a15f[_0x48fd53(0x2a4)](),updateSetting(_0x48fd53(0x1ac),_0x48fd53(0x213)),updateSetting(_0x48fd53(0xe0),!![]),await sendTelegram(_0x54a15f[_0x48fd53(0x113)]['id'],_0x48fd53(0x103));}),tgBot['action'](_0x469c40(0x9f),async _0x404cf4=>{const _0x48aabd=_0x469c40;_0x404cf4[_0x48aabd(0x2a4)](),updateSetting(_0x48aabd(0x1ac),'all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x404cf4[_0x48aabd(0x113)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x469c40(0x289),async _0x4049ad=>{const _0x26fae8=_0x469c40,_0x136ba4=getBotsWithMode();let _0x368bc8=_0x26fae8(0x1d6);config[_0x26fae8(0x263)](_0xe0238e=>{const _0x55b1b6=_0x26fae8,_0x50f287=_0x136ba4[_0x55b1b6(0x192)](_0x3fe51b=>_0x3fe51b[_0x55b1b6(0x22e)]==_0xe0238e[_0x55b1b6(0x22e)])['mode'];_0x368bc8+=_0x55b1b6(0x16c)+_0xe0238e[_0x55b1b6(0x22e)]+':\x20'+_0xe0238e['status']+_0x55b1b6(0x204)+_0x50f287+_0x55b1b6(0x204)+_0xe0238e[_0x55b1b6(0xdc)]+'\x0a';}),_0x368bc8+='\x0a',_0x368bc8+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x368bc8+=!settings[_0x26fae8(0xe0)]?'Notifications\x20disabled\x0a':_0x26fae8(0x211),_0x368bc8+=settings['telegramEnabled']?settings[_0x26fae8(0x1ac)]=='all'?_0x26fae8(0x1fb):_0x26fae8(0x174)+settings[_0x26fae8(0x1ac)]+_0x26fae8(0x2ab):'',await sendTelegram(_0x4049ad[_0x26fae8(0x113)]['id'],_0x368bc8,{'parse_mode':_0x26fae8(0xcd)});}),tgBot['command'](_0x469c40(0x22a),async _0x133a90=>{const _0x1a920b=_0x469c40,_0x1b75a5=getEnabledBots();if(_0x1b75a5[_0x1a920b(0x21b)]==0x0)await sendTelegram(_0x133a90['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1b75a5[_0x1a920b(0x21b)]>0x1)_0x1b75a5[_0x1a920b(0x150)]({'botID':_0x1a920b(0x206)});let _0x5c8d17=[],_0x2cd31d=[];const _0x5a842d=_0x1b75a5['length']%0x4==0x0||_0x1b75a5[_0x1a920b(0x21b)]%0x4==0x3||_0x1b75a5['length']%0x3==0x1?0x4:0x3;let _0x631a4a=0x0;_0x1b75a5['forEach']((_0x4f16fe,_0x5b0a75)=>{const _0x2598c6=_0x1a920b;if(_0x5b0a75%_0x5a842d==0x0)_0x2cd31d=[];_0x2cd31d['push'](Markup[_0x2598c6(0x257)]['callback'](_0x4f16fe['botID']=='all'?_0x2598c6(0x17c):_0x2598c6(0x16c)+_0x4f16fe[_0x2598c6(0x22e)],'restart_'+_0x4f16fe[_0x2598c6(0x22e)])),_0x5b0a75%_0x5a842d==0x0&&(_0x5c8d17[_0x631a4a]=_0x2cd31d,_0x631a4a++);});const _0x150308=Markup['inlineKeyboard'](_0x5c8d17);_0x133a90['reply'](_0x1a920b(0x189),_0x150308);}}),tgBot[_0x469c40(0x20a)](/restart_(.+)/,async _0x194e25=>{const _0x2b1bfc=_0x469c40,_0x10648a=_0x194e25[_0x2b1bfc(0x23c)][0x1];_0x194e25['editMessageReplyMarkup'](),_0x10648a=='all'?config[_0x2b1bfc(0x263)](_0x4e1853=>{const _0x732998=_0x2b1bfc;restartBot(_0x4e1853[_0x732998(0x22e)]);}):restartBot(_0x10648a);}),tgBot[_0x469c40(0x14b)]('on',async _0x25a26f=>{const _0x1a104e=_0x469c40,_0x3e8f97=getDisabledBots();if(_0x3e8f97[_0x1a104e(0x21b)]==0x0)await sendTelegram(_0x25a26f[_0x1a104e(0x113)]['id'],_0x1a104e(0x13b));else{if(_0x3e8f97['length']>0x1)_0x3e8f97['push']({'botID':_0x1a104e(0x206)});let _0x445cec=[],_0x523196=[];const _0x3ae4b2=_0x3e8f97[_0x1a104e(0x21b)]%0x4==0x0||_0x3e8f97[_0x1a104e(0x21b)]%0x4==0x3||_0x3e8f97['length']%0x3==0x1?0x4:0x3;let _0x550d42=0x0;_0x3e8f97[_0x1a104e(0x263)]((_0x4b2831,_0x46d8f1)=>{const _0x45cc56=_0x1a104e;if(_0x46d8f1%_0x3ae4b2==0x0)_0x523196=[];_0x523196[_0x45cc56(0x150)](Markup[_0x45cc56(0x257)][_0x45cc56(0x280)](_0x4b2831['botID']=='all'?_0x45cc56(0x17c):'Bot\x20'+_0x4b2831['botID'],_0x45cc56(0x202)+_0x4b2831[_0x45cc56(0x22e)])),_0x46d8f1%_0x3ae4b2==0x0&&(_0x445cec[_0x550d42]=_0x523196,_0x550d42++);});const _0x27b2fd=Markup[_0x1a104e(0xef)](_0x445cec);_0x25a26f['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x27b2fd);}}),tgBot[_0x469c40(0x20a)](/on_(.+)/,async _0x292ebd=>{const _0x121751=_0x469c40,_0x357632=_0x292ebd[_0x121751(0x23c)][0x1];_0x292ebd[_0x121751(0x2a4)]();if(_0x357632=='all'){const _0x56d6b1=getDisabledBots();await sendTelegram(_0x292ebd[_0x121751(0x113)]['id'],_0x121751(0x25d)),_0x56d6b1[_0x121751(0x263)](_0x9d646=>{const _0x49a106=_0x121751;if(_0x9d646[_0x49a106(0x22e)]!=_0x49a106(0x206))toggleBot(_0x9d646[_0x49a106(0x22e)],toggleStatus(_0x9d646[_0x49a106(0x22e)]),_0x49a106(0x15b));});}else await sendTelegram(_0x292ebd[_0x121751(0x113)]['id'],_0x121751(0x11b)+_0x357632),toggleBot(_0x357632,toggleStatus(_0x357632),_0x121751(0x15b));}),tgBot['command'](_0x469c40(0x12c),async _0x187a5e=>{const _0x1c41ce=_0x469c40,_0x4432b3=getEnabledBots();if(_0x4432b3['length']==0x0)await sendTelegram(_0x187a5e[_0x1c41ce(0x113)]['id'],_0x1c41ce(0x1f4));else{if(_0x4432b3['length']>0x1)_0x4432b3[_0x1c41ce(0x150)]({'botID':_0x1c41ce(0x206)});let _0x27c752=[],_0x567b09=[];const _0x51ebed=_0x4432b3[_0x1c41ce(0x21b)]%0x4==0x0||_0x4432b3[_0x1c41ce(0x21b)]%0x4==0x3||_0x4432b3[_0x1c41ce(0x21b)]%0x3==0x1?0x4:0x3;let _0x552bcf=0x0;_0x4432b3[_0x1c41ce(0x263)]((_0x4d0eda,_0x2d73fb)=>{const _0x5e8728=_0x1c41ce;if(_0x2d73fb%_0x51ebed==0x0)_0x567b09=[];_0x567b09[_0x5e8728(0x150)](Markup['button'][_0x5e8728(0x280)](_0x4d0eda[_0x5e8728(0x22e)]==_0x5e8728(0x206)?_0x5e8728(0x17c):_0x5e8728(0x16c)+_0x4d0eda[_0x5e8728(0x22e)],_0x5e8728(0xd7)+_0x4d0eda['botID'])),_0x2d73fb%_0x51ebed==0x0&&(_0x27c752[_0x552bcf]=_0x567b09,_0x552bcf++);});const _0x343a26=Markup[_0x1c41ce(0xef)](_0x27c752);_0x187a5e[_0x1c41ce(0x10c)](_0x1c41ce(0x18b),_0x343a26);}}),tgBot[_0x469c40(0x20a)](/off_(.+)/,async _0xdc90fc=>{const _0x13d952=_0x469c40,_0x280255=_0xdc90fc[_0x13d952(0x23c)][0x1];_0xdc90fc[_0x13d952(0x2a4)]();if(_0x280255==_0x13d952(0x206)){const _0x36d1f4=getEnabledBots();await sendTelegram(_0xdc90fc[_0x13d952(0x113)]['id'],_0x13d952(0x12d)),_0x36d1f4[_0x13d952(0x263)](_0x1229e0=>{const _0x3f209c=_0x13d952;if(_0x1229e0[_0x3f209c(0x22e)]!=_0x3f209c(0x206))toggleBot(_0x1229e0['botID'],toggleStatus(_0x1229e0[_0x3f209c(0x22e)]),_0x3f209c(0x15b));});}else await sendTelegram(_0xdc90fc[_0x13d952(0x113)]['id'],_0x13d952(0x148)+_0x280255),toggleBot(_0x280255,toggleStatus(_0x280255),_0x13d952(0x15b));}),tgBot['command'](_0x469c40(0x1e4),async _0x5f0182=>{const _0x2502aa=_0x469c40,_0x2c03ce=getEnabledBots();if(_0x2c03ce[_0x2502aa(0x21b)]==0x0)await sendTelegram(_0x5f0182[_0x2502aa(0x113)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2c03ce['length']>0x1){let _0x4d9335=[],_0x40ab5f=[];const _0x5cb5b4=_0x2c03ce[_0x2502aa(0x21b)]%0x4==0x0||_0x2c03ce[_0x2502aa(0x21b)]%0x4==0x3||_0x2c03ce[_0x2502aa(0x21b)]%0x3==0x1?0x4:0x3;let _0x56e23d=0x0;_0x2c03ce[_0x2502aa(0x263)]((_0x3a983a,_0x520cb6)=>{const _0x43c032=_0x2502aa;if(_0x520cb6%_0x5cb5b4==0x0)_0x40ab5f=[];_0x40ab5f['push'](Markup[_0x43c032(0x257)]['callback']('Bot\x20'+_0x3a983a[_0x43c032(0x22e)],_0x43c032(0x176)+_0x3a983a['botID'])),_0x520cb6%_0x5cb5b4==0x0&&(_0x4d9335[_0x56e23d]=_0x40ab5f,_0x56e23d++);});const _0x2ba44b=Markup[_0x2502aa(0xef)](_0x4d9335);_0x5f0182[_0x2502aa(0x10c)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x2ba44b);}else{const _0xe4f0b4=_0x2c03ce[0x0][_0x2502aa(0x22e)];if(pid[_0xe4f0b4])pid[_0xe4f0b4][_0x2502aa(0x24e)]({'function':_0x2502aa(0xd6),'args':null});}}}),tgBot[_0x469c40(0x20a)](/metrics_(.+)/,async _0x29e268=>{const _0x17597b=_0x469c40,_0x8c5a84=_0x29e268[_0x17597b(0x23c)][0x1];_0x29e268[_0x17597b(0x2a4)]();if(pid[_0x8c5a84])pid[_0x8c5a84][_0x17597b(0x24e)]({'function':_0x17597b(0xd6),'args':null});}),tgBot[_0x469c40(0x14b)](_0x469c40(0x172),async _0x5603e7=>{const _0x73e3be=_0x469c40,_0x17b23a=getEnabledBots();if(_0x17b23a['length']==0x0)await sendTelegram(_0x5603e7[_0x73e3be(0x113)]['id'],_0x73e3be(0x1f4));else{if(_0x17b23a[_0x73e3be(0x21b)]>0x1){let _0x2a2564=[],_0x2d7261=[];const _0x26fa03=_0x17b23a[_0x73e3be(0x21b)]%0x4==0x0||_0x17b23a[_0x73e3be(0x21b)]%0x4==0x3||_0x17b23a[_0x73e3be(0x21b)]%0x3==0x1?0x4:0x3;let _0x2c1211=0x0;_0x17b23a['forEach']((_0x579334,_0x449433)=>{const _0x5b0673=_0x73e3be;if(_0x449433%_0x26fa03==0x0)_0x2d7261=[];_0x2d7261[_0x5b0673(0x150)](Markup['button']['callback'](_0x5b0673(0x16c)+_0x579334['botID'],'portfolio_'+_0x579334[_0x5b0673(0x22e)])),_0x449433%_0x26fa03==0x0&&(_0x2a2564[_0x2c1211]=_0x2d7261,_0x2c1211++);});const _0x4fe8ce=Markup['inlineKeyboard'](_0x2a2564);_0x5603e7['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x4fe8ce);}else{const _0x5d5922=_0x17b23a[0x0][_0x73e3be(0x22e)];if(pid[_0x5d5922])pid[_0x5d5922][_0x73e3be(0x24e)]({'function':_0x73e3be(0xba),'args':null});}}}),tgBot[_0x469c40(0x20a)](/portfolio_(.+)/,async _0x5b2605=>{const _0x4c4fb5=_0x469c40,_0x36322d=_0x5b2605[_0x4c4fb5(0x23c)][0x1];_0x5b2605['editMessageReplyMarkup']();if(pid[_0x36322d])pid[_0x36322d][_0x4c4fb5(0x24e)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x469c40(0x14b)]('update',async _0x213561=>{const _0x5f038b=_0x469c40;await getMessages();if(!updateAvailable)await sendTelegram(_0x213561[_0x5f038b(0x113)]['id'],_0x5f038b(0x26a));else{if(!validInstallation)await sendTelegram(_0x213561['chat']['id'],_0x5f038b(0x10a));else{const _0x448546=Markup[_0x5f038b(0xef)]([Markup[_0x5f038b(0x257)][_0x5f038b(0x280)](_0x5f038b(0x1f5),_0x5f038b(0x160)),Markup[_0x5f038b(0x257)][_0x5f038b(0x280)]('No',_0x5f038b(0x196))]);_0x213561[_0x5f038b(0x10c)](_0x5f038b(0x247),_0x448546);}}}),tgBot[_0x469c40(0x20a)](/update_(.+)/,async _0x33e234=>{const _0x3d2085=_0x469c40,_0x1bff82=_0x33e234[_0x3d2085(0x23c)][0x1];_0x33e234['editMessageReplyMarkup'](),_0x1bff82==_0x3d2085(0x16e)&&(await sendTelegram(_0x33e234['chat']['id'],_0x3d2085(0xfa)),updateBB(_0x3d2085(0x20c))),_0x1bff82=='no'&&await sendTelegram(_0x33e234[_0x3d2085(0x113)]['id'],_0x3d2085(0x19b));}),tgBot[_0x469c40(0x14b)](_0x469c40(0xd1),async _0xec21bb=>{const _0x5b90fa=_0x469c40;if(!validInstallation)await sendTelegram(_0xec21bb['chat']['id'],_0x5b90fa(0xf5));else{const _0x587e23=Markup['inlineKeyboard']([Markup[_0x5b90fa(0x257)][_0x5b90fa(0x280)]('Yes',_0x5b90fa(0x1c3)),Markup['button'][_0x5b90fa(0x280)]('No',_0x5b90fa(0x17f))]);_0xec21bb[_0x5b90fa(0x10c)](_0x5b90fa(0x1fd),_0x587e23);}}),tgBot[_0x469c40(0x20a)](/reinstall_(.+)/,async _0x107963=>{const _0x1462fa=_0x469c40,_0x5f184a=_0x107963[_0x1462fa(0x23c)][0x1];_0x107963[_0x1462fa(0x2a4)](),_0x5f184a==_0x1462fa(0x16e)&&(await sendTelegram(_0x107963['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x1462fa(0xd1))),_0x5f184a=='no'&&await sendTelegram(_0x107963['chat']['id'],_0x1462fa(0x185));}),tgBot[_0x469c40(0x14b)](_0x469c40(0x258),async _0x240887=>{const _0x48ff8c=_0x469c40,_0x4f424a=getBotsWithMode();if(_0x4f424a[_0x48ff8c(0x21b)]==0x0)await sendTelegram(_0x240887[_0x48ff8c(0x113)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x44686c=[],_0x1f03e4=[];const _0x35792c=0x2;let _0x51ed36=0x0;_0x4f424a['forEach']((_0x517b02,_0x2a455c)=>{const _0x1df868=_0x48ff8c;if(_0x2a455c%_0x35792c==0x0)_0x1f03e4=[];_0x1f03e4[_0x1df868(0x150)](Markup[_0x1df868(0x257)][_0x1df868(0x280)](_0x1df868(0x16c)+_0x517b02[_0x1df868(0x22e)]+'\x20('+_0x517b02[_0x1df868(0x13f)]+')','toggle_'+_0x517b02[_0x1df868(0x22e)])),_0x2a455c%_0x35792c==0x0&&(_0x44686c[_0x51ed36]=_0x1f03e4,_0x51ed36++);});const _0xa61254=Markup[_0x48ff8c(0xef)](_0x44686c);_0x240887[_0x48ff8c(0x10c)](_0x48ff8c(0x22f),_0xa61254);}}),tgBot['action'](/toggle_(.+)/,async _0x2704ee=>{const _0x359451=_0x469c40,_0x337b5f=_0x2704ee[_0x359451(0x23c)][0x1];_0x2704ee[_0x359451(0x2a4)]();const _0x15811a=getBotsWithMode(),_0x107351=_0x15811a[_0x359451(0x192)](_0x29358c=>_0x29358c['botID']==_0x337b5f),_0x437f3b=_0x107351[_0x359451(0x13f)]==_0x359451(0xb9)?_0x359451(0x2a8):_0x359451(0xb9);await sendTelegram(_0x2704ee['chat']['id'],_0x359451(0xa5)+_0x337b5f+_0x359451(0x28f)+_0x437f3b+_0x359451(0x1b6)),toggleBotMode(_0x337b5f);}),tgBot[_0x469c40(0x14b)](_0x469c40(0x18a),async _0x1d7f4d=>{const _0x36b504=_0x469c40;let _0x98c7e2='';config['forEach'](_0x28ab1a=>{const _0x2a7766=_0x2548;_0x98c7e2+='Bot\x20'+_0x28ab1a[_0x2a7766(0x22e)]+':\x20'+_0x28ab1a['botname']+'\x0a';}),await sendTelegram(_0x1d7f4d[_0x36b504(0x113)]['id'],_0x98c7e2,{'parse_mode':_0x36b504(0xcd)});}),tgBot[_0x469c40(0x14b)](_0x469c40(0x210),async _0x36a434=>{const _0x16d2bd=_0x469c40;await sendTelegram(_0x36a434[_0x16d2bd(0x113)]['id'],_0x41804a);}),process['once']('SIGINT',()=>tgBot['stop'](_0x469c40(0x1cf))),process[_0x469c40(0x208)](_0x469c40(0x155),()=>tgBot[_0x469c40(0x249)](_0x469c40(0x155))),tgBot['launch']();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x4c4abf,_0x53a422,_0xf63991){const _0x54e6aa=_0xf346f5;_0xf63991={..._0xf63991,'disable_web_page_preview':!![]};try{await tgBot[_0x54e6aa(0x1ec)]['sendMessage'](_0x4c4abf,_0x53a422,_0xf63991);}catch(_0x4b1384){console[_0x54e6aa(0x259)]('Telegram\x20error:',_0x4b1384);}}async function sendTelegramBot(_0x57a4d6,_0xd0cabe){const _0x2438a7=_0xf346f5;if(settings[_0x2438a7(0xe0)]){if(settings['telegramEvents']==_0x2438a7(0x206)||(_0xd0cabe[_0x2438a7(0x154)]==_0x2438a7(0x18c)||_0xd0cabe['type']==_0x2438a7(0x1ca)||_0xd0cabe[_0x2438a7(0x154)]==_0x2438a7(0x131))&&settings['telegramEvents']=='alerts'||_0xd0cabe['type']=='order'&&settings['telegramEvents']=='orders'){if(tgBot&&settings['telegramChatId']){if(_0xd0cabe[_0x2438a7(0x145)])await sendTelegram(settings[_0x2438a7(0x207)],_0xd0cabe['botname']+_0x2438a7(0x125)+_0xd0cabe[_0x2438a7(0xc8)]);else await sendTelegram(settings['telegramChatId'],_0x2438a7(0x16c)+_0x57a4d6+_0x2438a7(0x125)+_0xd0cabe[_0x2438a7(0xc8)]);}}}}async function sendTelegramMsg(_0x3e17b0,_0x4bb021=_0xf346f5(0xcd)){const _0x46cca6=_0xf346f5;return settings['telegramEnabled']&&tgBot&&settings[_0x46cca6(0x207)]?(await sendTelegram(settings[_0x46cca6(0x207)],_0x3e17b0,{'parse_mode':_0x4bb021}),!![]):![];}function getDeviceWithIp(_0x58997a){const _0x22e6d5=_0xf346f5;return devices[_0x22e6d5(0x192)](_0x4646e7=>_0x4646e7['ip']===_0x58997a);}async function temporaryAccess2FA(_0xa4c2e2,_0x1b4922){const _0x210557=_0xf346f5;let _0x658e88=new Date(),_0x259e59=![];if(lastIpApproval){if(_0x658e88-lastIpApproval<0x1388)_0x259e59=!![];}lastIpApproval=new Date();if(_0x259e59)return;if(tgBot&&settings[_0x210557(0x207)]){const _0x2a3027=uuidRandom();tmpStorage[_0x2a3027]={'uuid':_0xa4c2e2,'externalip':_0x1b4922};const _0x529380=Markup[_0x210557(0xef)]([Markup[_0x210557(0x257)][_0x210557(0x280)](_0x210557(0x130),'tempaccess_5_'+_0x2a3027),Markup[_0x210557(0x257)][_0x210557(0x280)](_0x210557(0x12a),_0x210557(0xed)+_0x2a3027),Markup['button'][_0x210557(0x280)](_0x210557(0x170),_0x210557(0x205)+_0x2a3027),Markup[_0x210557(0x257)][_0x210557(0x280)]('reject',_0x210557(0x279)+_0x2a3027)]);await sendTelegram(settings[_0x210557(0x207)],_0x210557(0xd4)+normalizeIP(_0x1b4922)[_0x210557(0x1c7)]+'\x20?',_0x529380),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x181d6d=>{const _0x31d499=_0x210557,_0x1d1084=_0x181d6d['match'][0x1],_0x280350=_0x181d6d[_0x31d499(0x23c)][0x2],{uuid:_0x3bc4cd,externalip:_0x328bce}=tmpStorage[_0x280350];delete tmpStorage[_0x280350],_0x181d6d['editMessageReplyMarkup'](),devices[_0x3bc4cd]['telegramIpApproval']={'clientip':_0x328bce,'timestamp':new Date()[_0x31d499(0x227)](),'expiry':_0x1d1084},_0x1d1084!=_0x31d499(0xe1)?(await sendTelegram(_0x181d6d[_0x31d499(0x113)]['id'],_0x31d499(0x20f)+_0x1d1084+_0x31d499(0x221),{'parse_mode':_0x31d499(0xcd)}),io['to'](_0x3bc4cd)[_0x31d499(0x1e8)](_0x31d499(0x289),{'access':{'allow':![],'reason':_0x31d499(0xcf),'token':null}})):(await sendTelegram(_0x181d6d[_0x31d499(0x113)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x3bc4cd)['emit']('status',{'access':{'allow':![],'reason':_0x31d499(0xdb),'token':null}}));});}}async function loginAccess2FA(_0x5d0bd2,_0x4d9a38){const _0x46c083=_0xf346f5;if(tgBot&&settings[_0x46c083(0x207)]){const _0x319af5=uuidRandom();tmpStorage[_0x319af5]={'uuid':_0x5d0bd2,'externalip':_0x4d9a38};const _0x1d39b4=Markup['inlineKeyboard']([Markup[_0x46c083(0x257)]['callback'](_0x46c083(0xfc),_0x46c083(0x9b)+loginExpiry+'_'+_0x319af5),Markup[_0x46c083(0x257)][_0x46c083(0x280)]('reject',_0x46c083(0x143)+_0x319af5)]);await sendTelegram(settings['telegramChatId'],_0x46c083(0x228)+normalizeIP(_0x4d9a38)['show']+'\x20?',_0x1d39b4),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x541e5e=>{const _0x26c843=_0x46c083,_0x4eb4d9=_0x541e5e[_0x26c843(0x23c)][0x1],_0x3f80c5=_0x541e5e[_0x26c843(0x23c)][0x2],{uuid:_0x2545e9,externalip:_0x296e9a}=tmpStorage[_0x3f80c5];delete tmpStorage[_0x3f80c5],_0x541e5e[_0x26c843(0x2a4)](),devices[_0x2545e9][_0x26c843(0x2a2)]={'clientip':_0x296e9a,'timestamp':new Date()['getTime'](),'expiry':_0x4eb4d9},_0x4eb4d9!=_0x26c843(0xe1)?(await sendTelegram(_0x541e5e[_0x26c843(0x113)]['id'],_0x26c843(0x19a),{'parse_mode':_0x26c843(0xcd)}),io['to'](_0x2545e9)[_0x26c843(0x1e8)](_0x26c843(0x289),{'access':{'allow':![],'reason':_0x26c843(0xcf),'token':null}})):(await sendTelegram(_0x541e5e['chat']['id'],_0x26c843(0x274)),io['to'](_0x2545e9)[_0x26c843(0x1e8)](_0x26c843(0x289),{'access':{'allow':![],'reason':_0x26c843(0x209),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x416642=_0xf346f5;return dbConfig['get'](_0x416642(0x118))[_0x416642(0x1d2)](_0x416642(0x22e))[_0x416642(0x27f)]({'status':_0x416642(0x121)})[_0x416642(0x2a9)]()||[];}function getDisabledBots(){const _0x5b79ad=_0xf346f5;return dbConfig[_0x5b79ad(0x151)]('bots')[_0x5b79ad(0x1d2)]('botID')[_0x5b79ad(0x27f)]({'status':_0x5b79ad(0xa3)})[_0x5b79ad(0x2a9)]()||[];}function getBotAttributes(_0x5d3cf5){const _0x48952f=_0xf346f5;let _0x1f5484={};const _0x22728c=configpath+_0x48952f(0x112)+_0x5d3cf5+_0x48952f(0xf8),_0xdc48fa=fs[_0x48952f(0x218)](_0x22728c);if(_0xdc48fa){const _0x5ac8c6=fs[_0x48952f(0x1a9)](_0x22728c);try{const _0xe9c89c=JSON[_0x48952f(0x1e6)](_0x5ac8c6),_0x414712=_0xe9c89c?_0xe9c89c[_0x48952f(0x1eb)][0x0][_0x48952f(0x237)]:![];_0x1f5484[_0x48952f(0x13f)]=_0x414712?'auto':_0x48952f(0x2a8),_0x1f5484['botname']=_0xe9c89c?_0xe9c89c['bot'][0x0][_0x48952f(0x1a7)]:'Bot\x20'+_0x5d3cf5;}catch(_0x1599a6){_0x1f5484[_0x48952f(0x13f)]='manual',_0x1f5484[_0x48952f(0x1a7)]=_0x48952f(0x16c)+_0x5d3cf5;}}else _0x1f5484[_0x48952f(0x13f)]=_0x48952f(0x2a8),_0x1f5484['botname']='Bot\x20'+_0x5d3cf5;return _0x1f5484;}function getBotsWithMode(){const _0x444581=_0xf346f5,_0x3eb55d=dbConfig[_0x444581(0x151)](_0x444581(0x118))['sortBy'](_0x444581(0x22e))[_0x444581(0x2a9)]()||[];return _0x3eb55d['forEach'](_0x5a3078=>{const _0x2c922b=_0x444581;let _0x16e518=getBotAttributes(_0x5a3078[_0x2c922b(0x22e)]);_0x5a3078['mode']=_0x16e518[_0x2c922b(0x13f)];}),_0x3eb55d;}function getBotExchanges(){const _0x289d8c=_0xf346f5;let _0x251bb8=[];const _0x24f111=dbConfig[_0x289d8c(0x151)](_0x289d8c(0x118))[_0x289d8c(0x1d2)]('botID')[_0x289d8c(0x2a9)]()||[];_0x24f111[_0x289d8c(0x263)](_0xdaabc0=>{const _0x16c37c=_0x289d8c;if(_0xdaabc0[_0x16c37c(0x289)]==_0x16c37c(0x121)){const _0x26fc80=configpath+_0x16c37c(0x112)+_0xdaabc0[_0x16c37c(0x22e)]+_0x16c37c(0xf8),_0x3c4ecf=fs['existsSync'](_0x26fc80);let _0x466e36;if(_0x3c4ecf){const _0x1d8a9b=fs[_0x16c37c(0x1a9)](_0x26fc80);try{const _0x9a1f9f=JSON[_0x16c37c(0x1e6)](_0x1d8a9b);_0x466e36=_0x9a1f9f?_0x9a1f9f[_0x16c37c(0x1eb)][0x0]['exchange']:null;}catch(_0x15dc32){}}if(_0x466e36)_0x251bb8[_0x16c37c(0x150)](_0x466e36);}});const _0x326056=[...new Set(_0x251bb8)][_0x289d8c(0x1a2)]();return _0x326056;}async function initUser(){const _0x5dac06=_0xf346f5;if(!settings[_0x5dac06(0x298)]){const _0x36b83e=uuidRandom();mixpanel[_0x5dac06(0x116)](_0x36b83e),updateSetting(_0x5dac06(0x298),_0x36b83e);}}async function initSecure(){const _0x2650c2=_0xf346f5;let _0x5eea81=getSecure();if(!_0x5eea81[_0x2650c2(0x16b)]('secret')){let _0x2a271e=await generateKeys();_0x5eea81['publicKey']=_0x2a271e[_0x2650c2(0x1d4)],_0x5eea81[_0x2650c2(0x119)]=_0x2a271e['privateKey'],_0x5eea81[_0x2650c2(0x161)]=crypto[_0x2650c2(0xe8)](0x20)['toString'](_0x2650c2(0x1bf));;storeSecure(_0x5eea81);}}function getSettings(){const _0x218748=_0xf346f5;return dbSettings[_0x218748(0x151)]('settings')[_0x218748(0x2a9)]()||{};}function getSecure(){const _0x53a8d6=_0xf346f5;return dbSecure[_0x53a8d6(0x151)]('secure')[_0x53a8d6(0x2a9)]()||{};}function getBlacklist(){const _0xa87fa0=_0xf346f5;return dbSecure[_0xa87fa0(0x151)](_0xa87fa0(0x1a5))[_0xa87fa0(0x2a9)]()||[];}function broadcastToBots(_0x15f07a,_0xc7299f){config['forEach'](_0x367146=>{const _0xc80d00=_0x2548;if(_0x367146[_0xc80d00(0x289)]==_0xc80d00(0x121)&&_0x367146[_0xc80d00(0xdc)]==_0xc80d00(0x1ea)||_0x367146[_0xc80d00(0x289)]==_0xc80d00(0x23d)&&_0x367146[_0xc80d00(0xdc)]==_0xc80d00(0x1ea)){if(pid[_0x367146['botID']])pid[_0x367146[_0xc80d00(0x22e)]][_0xc80d00(0x24e)]({[_0x15f07a]:_0xc7299f});}});}async function storeSettings(_0x47d3a9,_0x4152fa=![]){const _0x37b936=_0xf346f5;_0x47d3a9={...settings,..._0x47d3a9};if(_0x4152fa&&_0x47d3a9[_0x37b936(0x25e)]!='************'&&_0x47d3a9[_0x37b936(0x25e)]!=_0x37b936(0x164)&&_0x47d3a9[_0x37b936(0x25e)]!=''){const _0x5db8c9=crypt[_0x37b936(0x1ad)](secure[_0x37b936(0x119)],_0x47d3a9[_0x37b936(0x25e)])[_0x37b936(0x20e)][_0x37b936(0x139)]('|@|')[0x0],_0x548860=bcrypt[_0x37b936(0xd3)](_0x5db8c9,saltRounds);_0x47d3a9={..._0x47d3a9,'bbPassword':_0x548860};}if(_0x4152fa&&_0x47d3a9['telegramToken']!='************'&&_0x47d3a9['telegramToken']!=_0x37b936(0x164)&&_0x47d3a9[_0x37b936(0x127)]!=''){const _0x4cd3b6=crypt[_0x37b936(0x1ad)](secure[_0x37b936(0x119)],_0x47d3a9[_0x37b936(0x127)])['message']['split'](_0x37b936(0x2a0))[0x0];_0x47d3a9={..._0x47d3a9,'telegramToken':_0x4cd3b6};}if(_0x4152fa&&_0x47d3a9['marketcapApi']!=_0x37b936(0x199)&&_0x47d3a9[_0x37b936(0x1ff)]!=_0x37b936(0x164)&&_0x47d3a9[_0x37b936(0x1ff)]!=''){const _0x2e260e=crypt[_0x37b936(0x1ad)](secure[_0x37b936(0x119)],_0x47d3a9[_0x37b936(0x1ff)])[_0x37b936(0x20e)][_0x37b936(0x139)](_0x37b936(0x2a0))[0x0];_0x47d3a9={..._0x47d3a9,'marketcapApi':_0x2e260e};}const _0x4d97ef=_0x47d3a9['telegramToken']!=_0x37b936(0x199)&&_0x47d3a9[_0x37b936(0x127)]!=settings[_0x37b936(0x127)]||_0x47d3a9['telegramUsername']!=settings[_0x37b936(0x165)],_0x24dc10=_0x47d3a9[_0x37b936(0x127)]==''||_0x47d3a9['telegramUsername']=='',_0x31beb2=_0x47d3a9[_0x37b936(0x1ff)]&&_0x47d3a9['marketcapApi']!=_0x37b936(0x199)&&_0x47d3a9[_0x37b936(0x1ff)]!=settings[_0x37b936(0x127)];_0x4d97ef&&(_0x47d3a9['telegramChatId']=null,_0x47d3a9[_0x37b936(0x1ac)]='all');for(const [_0x37236a,_0x345b53]of Object[_0x37b936(0x2a3)](_0x47d3a9)){if(_0x37236a=='telegramToken'&&_0x345b53==_0x37b936(0x199)){_0x47d3a9[_0x37b936(0x127)]=settings[_0x37b936(0x127)];continue;};if(_0x37236a==_0x37b936(0x25e)&&_0x345b53==_0x37b936(0x199)){_0x47d3a9[_0x37b936(0x25e)]=settings[_0x37b936(0x25e)];continue;};if(_0x37236a==_0x37b936(0x1ff)&&_0x345b53==_0x37b936(0x199)){_0x47d3a9[_0x37b936(0x1ff)]=settings[_0x37b936(0x1ff)];continue;};dbSettings[_0x37b936(0x186)](_0x37b936(0x195)+_0x37236a,_0x345b53)[_0x37b936(0x11f)]();}settings=_0x47d3a9,io['to'](_0x37b936(0x245))[_0x37b936(0x1e8)](_0x37b936(0xd5),cleanSettings()),broadcastToBots(_0x37b936(0x10d),settings['timeshift']),broadcastToBots(_0x37b936(0x1de),settings[_0x37b936(0x1de)]),broadcastToBots('marketcapApi',settings[_0x37b936(0x1ff)]);if(_0x4d97ef&&!_0x24dc10)initTelegram();if(_0x4d97ef&&_0x24dc10)disableTelegram();getAllClients()[_0x37b936(0x263)](_0x592bd2=>{const _0x15d6c7=_0x37b936;getSocket(_0x592bd2['id'])['emit'](_0x15d6c7(0x289),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x31beb2&&(await sleep(0xbb8),testMarketcapApi(_0x47d3a9[_0x37b936(0x1ff)]));}async function testMarketcapApi(_0x305054){const _0xdf106e=_0xf346f5,_0x3d7011=[_0xdf106e(0x18d),'ETH'];try{await axios['get']('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x305054},'params':{'symbol':_0x3d7011[_0xdf106e(0x1c1)]()}});}catch(_0xa80750){_0xa80750[_0xdf106e(0x1c1)]()[_0xdf106e(0xda)](_0xdf106e(0x157))?(io['to'](_0xdf106e(0x245))[_0xdf106e(0x1e8)]('notification',_0xdf106e(0xca)),logger[_0xdf106e(0x29e)](_0xdf106e(0xca))):(io['to'](_0xdf106e(0x245))[_0xdf106e(0x1e8)](_0xdf106e(0x26f),_0xdf106e(0x1f2)),logger[_0xdf106e(0x29e)](_0xdf106e(0x1f2)),logger[_0xdf106e(0x141)](_0xdf106e(0x11d),_0xa80750[_0xdf106e(0x1c1)]()+'\x20-\x20'+_0xa80750[_0xdf106e(0xa7)]));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x2172a3,_0x20faed){const _0x4166d0=_0xf346f5;dbSettings[_0x4166d0(0x186)](_0x4166d0(0x195)+_0x2172a3,_0x20faed)[_0x4166d0(0x11f)](),settings=getSettings(),io['to'](_0x4166d0(0x245))['emit'](_0x4166d0(0xd5),cleanSettings());}function storeSecure(_0x1c6a5d){const _0x47549c=_0xf346f5;dbSecure[_0x47549c(0x151)](_0x47549c(0x235))[_0x47549c(0x150)](_0x1c6a5d)[_0x47549c(0x11f)](),secure=_0x1c6a5d;}function addBlacklist(_0x9509b1){const _0x3bc1b5=_0xf346f5;cleanBlacklist();let _0x9811c7;devices[_0x9509b1][_0x3bc1b5(0xf6)]?_0x9811c7=Math[_0x3bc1b5(0x2a7)](devices[_0x9509b1]['telegramIpApproval'][_0x3bc1b5(0x1c4)],loginExpiry):_0x9811c7=loginExpiry,dbSecure[_0x3bc1b5(0x151)]('blacklist')[_0x3bc1b5(0x150)]({'expiry':new Date()['getTime']()+_0x9811c7*0x3c*0x3e8,'token':devices[_0x9509b1][_0x3bc1b5(0x201)][_0x3bc1b5(0x115)]})['write'](),blacklist=dbSecure['get'](_0x3bc1b5(0x1a5))[_0x3bc1b5(0x2a9)]();}function cleanBlacklist(){const _0x700246=_0xf346f5;let _0x23fa48=dbSecure[_0x700246(0x151)](_0x700246(0x1a5))[_0x700246(0x234)]()[_0x700246(0x2a9)](),_0x19c95d=new Date()[_0x700246(0x227)]();_0x23fa48[_0x700246(0x263)](_0x13e45c=>{const _0x3098cf=_0x700246;_0x13e45c['expiry']<_0x19c95d&&dbSecure[_0x3098cf(0x151)](_0x3098cf(0x1a5))[_0x3098cf(0x13e)]({'expiry':_0x13e45c[_0x3098cf(0x1c4)]})[_0x3098cf(0x11f)]();});}function initStates(){let _0x34884b=getConfiguration();_0x34884b['forEach'](_0x21a193=>{const _0x2923bf=_0x2548;_0x21a193[_0x2923bf(0xdc)]=_0x2923bf(0x15b);}),storeConfiguration(_0x34884b);}function onKeys(){const _0x5127ee=new RSA();return new Promise(_0x49d11e=>{const _0xdee1ce=_0x2548;_0x5127ee[_0xdee1ce(0x253)]()[_0xdee1ce(0x1bb)](_0xdd1626=>{_0x49d11e(_0xdd1626);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x13bfab=_0xf346f5;let _0x23a8e2=getSettings(),_0x3f8f9f=![];!_0x23a8e2[_0x13bfab(0x16b)](_0x13bfab(0xd0))&&(_0x23a8e2[_0x13bfab(0xd0)]=0x0,_0x3f8f9f=!![]);!_0x23a8e2[_0x13bfab(0x16b)](_0x13bfab(0x214))&&(_0x23a8e2[_0x13bfab(0x214)]=0x0,_0x3f8f9f=!![]);!_0x23a8e2[_0x13bfab(0x16b)](_0x13bfab(0xbc))&&(_0x23a8e2[_0x13bfab(0xbc)]=_0x13bfab(0xb6),_0x3f8f9f=!![]);!_0x23a8e2[_0x13bfab(0x16b)](_0x13bfab(0x1de))&&(_0x23a8e2[_0x13bfab(0x1de)]=![],_0x3f8f9f=!![]);!_0x23a8e2[_0x13bfab(0x16b)](_0x13bfab(0x1ff))&&(_0x23a8e2['marketcapApi']='',_0x3f8f9f=!![]);if(_0x3f8f9f)storeSettings(_0x23a8e2);try{fs[_0x13bfab(0x244)](configbackuppath,{'withFileTypes':!![]})[_0x13bfab(0x263)](_0x1e57c3=>{const _0x35b858=_0x13bfab;if(!_0x1e57c3['isDirectory']()){if(!_0x1e57c3[_0x35b858(0x1db)][_0x35b858(0x1e7)](_0x35b858(0x147)))fs[_0x35b858(0x153)](configbackuppath+_0x1e57c3[_0x35b858(0x1db)]);}else fs[_0x35b858(0x110)](configbackuppath+_0x1e57c3[_0x35b858(0x1db)],{'recursive':!![]});});}catch(_0x1e6cc6){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x1e6cc6);}}function storeConfiguration(_0x5c57e3){const _0x570ed5=_0xf346f5;dbConfig[_0x570ed5(0x151)]('bots')[_0x570ed5(0x13e)]()[_0x570ed5(0x11f)](),dbConfig['get']('bots')[_0x570ed5(0x150)](..._0x5c57e3)[_0x570ed5(0x11f)](),config=_0x5c57e3;}async function resetPassword(){const _0x3c1e3f=_0xf346f5;if(tgBot&&settings[_0x3c1e3f(0x207)]){const _0x248684=Markup[_0x3c1e3f(0xef)]([Markup[_0x3c1e3f(0x257)][_0x3c1e3f(0x280)](_0x3c1e3f(0x16e),_0x3c1e3f(0xac)),Markup[_0x3c1e3f(0x257)][_0x3c1e3f(0x280)]('no',_0x3c1e3f(0x188))]);await sendTelegram(settings[_0x3c1e3f(0x207)],_0x3c1e3f(0xe3),_0x248684),tgBot[_0x3c1e3f(0x20a)](/resetpw_(.+)/,async _0x135cb0=>{const _0x36a6c1=_0x3c1e3f,_0x1572a6=_0x135cb0[_0x36a6c1(0x23c)][0x1];_0x135cb0[_0x36a6c1(0x2a4)]();if(_0x1572a6!='no'){const _0x3620c9=0xf,_0x6e2ff5='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1d69ef=Array[_0x36a6c1(0x23a)](crypto['randomFillSync'](new Uint32Array(_0x3620c9)))[_0x36a6c1(0x270)](_0x51c557=>_0x6e2ff5[_0x51c557%_0x6e2ff5[_0x36a6c1(0x21b)]])[_0x36a6c1(0x29a)](''),_0xb1ab18=bcrypt['hashSync'](_0x1d69ef,saltRounds);storeSettings({'bbPassword':_0xb1ab18}),await sendTelegram(_0x135cb0[_0x36a6c1(0x113)]['id'],_0x36a6c1(0x1dd)+_0x1d69ef,{'parse_mode':_0x36a6c1(0xcd)});}else await sendTelegram(_0x135cb0['chat']['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x4c9a3b,_0x3d5be3){const _0x5818b0=_0xf346f5;io['to'](_0x5818b0(0x245))[_0x5818b0(0x1e8)](_0x5818b0(0x26f),_0x5818b0(0x105),_0x5818b0(0x131));if(tgBot&&settings['telegramChatId']){const _0x476340=uuidRandom();tmpStorage[_0x476340]={'path':_0x4c9a3b,'filename':_0x3d5be3};const _0x4277f8=Markup[_0x5818b0(0xef)]([Markup[_0x5818b0(0x257)][_0x5818b0(0x280)](_0x5818b0(0x16e),_0x5818b0(0x1ab)+_0x476340),Markup[_0x5818b0(0x257)][_0x5818b0(0x280)]('no',_0x5818b0(0x159)+_0x476340)]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x4277f8),tgBot[_0x5818b0(0x20a)](/restore_(.+)_(.+)/,async _0x3caca1=>{const _0x44edfd=_0x5818b0,_0x2fe825=_0x3caca1[_0x44edfd(0x23c)][0x1],_0xdd34ac=_0x3caca1[_0x44edfd(0x23c)][0x2],{path:_0x18f004,filename:_0x357da5}=tmpStorage[_0xdd34ac];delete tmpStorage[_0xdd34ac],_0x3caca1[_0x44edfd(0x2a4)](),_0x2fe825==_0x44edfd(0x16e)?(logger[_0x44edfd(0x141)](_0x44edfd(0x138)),await sendTelegram(_0x3caca1[_0x44edfd(0x113)]['id'],_0x44edfd(0xa1),{'parse_mode':_0x44edfd(0xcd)}),unzipFile(_0x18f004,_0x357da5)):(logger['debug'](_0x44edfd(0xdd)),await sendTelegram(_0x3caca1[_0x44edfd(0x113)]['id'],_0x44edfd(0xdd)));});}}function getServerTime(){const _0x5acb63=_0xf346f5,_0x5b4c6b=new Date();return _0x5b4c6b[_0x5acb63(0x194)]()+'/'+(_0x5b4c6b[_0x5acb63(0xff)]()+0x1)[_0x5acb63(0x1c1)]()['padStart'](0x2,'0')+'/'+_0x5b4c6b['getDate']()[_0x5acb63(0x1c1)]()['padStart'](0x2,'0')+'\x20'+_0x5b4c6b[_0x5acb63(0x268)]()[_0x5acb63(0x1c1)]()[_0x5acb63(0xc2)](0x2,'0')+':'+_0x5b4c6b['getMinutes']()[_0x5acb63(0x1c1)]()[_0x5acb63(0xc2)](0x2,'0')+':'+_0x5b4c6b[_0x5acb63(0x26e)]()[_0x5acb63(0x1c1)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x4b4d06=_0xf346f5,_0x597745=shiftedTime();return _0x597745[_0x4b4d06(0x194)]()+'/'+(_0x597745[_0x4b4d06(0xff)]()+0x1)[_0x4b4d06(0x1c1)]()[_0x4b4d06(0xc2)](0x2,'0')+'/'+_0x597745[_0x4b4d06(0x177)]()[_0x4b4d06(0x1c1)]()['padStart'](0x2,'0')+'\x20'+_0x597745[_0x4b4d06(0x268)]()[_0x4b4d06(0x1c1)]()[_0x4b4d06(0xc2)](0x2,'0')+':'+_0x597745[_0x4b4d06(0x1b1)]()[_0x4b4d06(0x1c1)]()[_0x4b4d06(0xc2)](0x2,'0')+':'+_0x597745[_0x4b4d06(0x26e)]()[_0x4b4d06(0x1c1)]()[_0x4b4d06(0xc2)](0x2,'0');}function getCleanTimeStamp(){const _0x19560d=_0xf346f5,_0x4646e2=shiftedTime();return _0x4646e2[_0x19560d(0x194)]()+(_0x4646e2[_0x19560d(0xff)]()+0x1)[_0x19560d(0x1c1)]()[_0x19560d(0xc2)](0x2,'0')+_0x4646e2['getDate']()[_0x19560d(0x1c1)]()['padStart'](0x2,'0')+'-'+_0x4646e2[_0x19560d(0x268)]()[_0x19560d(0x1c1)]()[_0x19560d(0xc2)](0x2,'0')+_0x4646e2[_0x19560d(0x1b1)]()[_0x19560d(0x1c1)]()[_0x19560d(0xc2)](0x2,'0')+_0x4646e2['getSeconds']()[_0x19560d(0x1c1)]()[_0x19560d(0xc2)](0x2,'0');}function shiftedTime(){const _0x406063=_0xf346f5,_0x4e8487=new Date();let _0x5177cc=_0x4e8487;if(settings[_0x406063(0x10d)]&&settings['timeshift']!==0x0)_0x5177cc=fns[_0x406063(0x1e0)](_0x4e8487,{'hours':settings[_0x406063(0x10d)]});return _0x5177cc;}async function startScheduler(){const _0xffdea4=_0xf346f5,_0x24f6e1=new Date()[_0xffdea4(0x182)](),_0xf5f9f9=shiftedTime()[_0xffdea4(0x268)]();_0xf5f9f9==0x4&&backupConfigFiles(),_0xf5f9f9==0x5&&restartAllBots(),_0xf5f9f9==0x0&&rotateLogFiles(),_0x24f6e1%0x6==0x0&&triggerAnalytics(),_0x24f6e1%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x1b7057){const _0x58311f=_0xf346f5;logger[_0x58311f(0x141)](_0x58311f(0x1cc)+_0x1b7057);const _0x3b4d52=getBotsWithMode();_0x3b4d52[_0x58311f(0x21b)]>0x0?confirmRestore(configbackuppath,_0x1b7057):unzipFile(configbackuppath,_0x1b7057);}async function getBackupFiles(_0x2bfd3e=null){const _0x4d9588=_0xf346f5;let _0x2bd8fd=[],_0x13d72f=fs[_0x4d9588(0x244)](configbackuppath,{'withFileTypes':!![]});_0x13d72f['sort']((_0xa11730,_0x3200f7)=>_0xa11730[_0x4d9588(0x1db)]<_0x3200f7['name']?0x1:_0x3200f7['name']<_0xa11730[_0x4d9588(0x1db)]?-0x1:0x0),_0x13d72f[_0x4d9588(0x263)](_0x5c6623=>{const _0xeed215=_0x4d9588;if(!_0x5c6623[_0xeed215(0x24a)]()&&_0x5c6623[_0xeed215(0x1db)][_0xeed215(0x1e7)](_0xeed215(0x147))&&_0x5c6623['name'][_0xeed215(0x1d8)](_0xeed215(0xc0))){const _0x2853e9=formatDate(fs[_0xeed215(0x220)](configbackuppath+_0x5c6623['name'])[_0xeed215(0xf4)]);_0x2bd8fd['push']({'name':_0x5c6623['name'],'mtime':_0x2853e9});}});if(_0x2bfd3e)io['to'](_0x2bfd3e)[_0x4d9588(0x1e8)]('backup-files',_0x2bd8fd);else return _0x2bd8fd;}async function backupConfigFiles(){const _0x55d503=_0xf346f5;await zipFiles('backup-full');const _0xbc9733=getCleanTimeStamp();fs[_0x55d503(0x1b3)](zippath+'backup-full.zip',configbackuppath+(_0x55d503(0x147)+_0xbc9733+'.zip'));let _0x41fb0f=fs[_0x55d503(0x244)](configbackuppath,{'withFileTypes':!![]});_0x41fb0f[_0x55d503(0x1a2)]((_0x26913d,_0x410b32)=>_0x26913d[_0x55d503(0x1db)]<_0x410b32['name']?0x1:_0x410b32[_0x55d503(0x1db)]<_0x26913d[_0x55d503(0x1db)]?-0x1:0x0),_0x41fb0f[_0x55d503(0x21b)]>maxBackups&&fs[_0x55d503(0x153)](configbackuppath+_0x41fb0f[_0x41fb0f[_0x55d503(0x21b)]-0x1][_0x55d503(0x1db)]);}function rotateLogFiles(){const _0x585ec4=_0xf346f5,_0x1e8c04=fs[_0x585ec4(0x220)](logspath+_0x585ec4(0xf9)),_0x1dadfe=_0x1e8c04[_0x585ec4(0x286)]/0x400;if(_0x1dadfe>0x64){let _0x9f06b5=fs[_0x585ec4(0x244)](logspath,{'withFileTypes':!![]});_0x9f06b5['sort']((_0x1ab401,_0x3756a6)=>_0x1ab401[_0x585ec4(0x1db)]<_0x3756a6[_0x585ec4(0x1db)]?0x1:_0x3756a6[_0x585ec4(0x1db)]<_0x1ab401[_0x585ec4(0x1db)]?-0x1:0x0),_0x9f06b5[_0x585ec4(0x263)](_0x2a5170=>{const _0x4ab9e2=_0x585ec4;if(_0x2a5170[_0x4ab9e2(0x1db)]==_0x4ab9e2(0xc5))fs[_0x4ab9e2(0x1b3)](logspath+_0x2a5170[_0x4ab9e2(0x1db)],logspath+_0x4ab9e2(0x25c));if(_0x2a5170[_0x4ab9e2(0x1db)]=='output-001.log')fs[_0x4ab9e2(0x1b3)](logspath+_0x2a5170[_0x4ab9e2(0x1db)],logspath+_0x4ab9e2(0xc5));_0x2a5170[_0x4ab9e2(0x1db)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x2a5170[_0x4ab9e2(0x1db)],logspath+'output-001.log'),fs[_0x4ab9e2(0x29c)](logspath+_0x2a5170[_0x4ab9e2(0x1db)],''));});}}async function zipFiles(_0x2485d7){const _0x4206c8=_0xf346f5;let _0x4684b8;if(_0x2485d7=='logs')_0x4684b8=logspath;if(_0x2485d7==_0x4206c8(0x29d))_0x4684b8=configpath;if(_0x2485d7==_0x4206c8(0x1a8))_0x4684b8=configpath;let _0x24aa88=fs[_0x4206c8(0x244)](_0x4684b8,{'withFileTypes':!![]});const _0x50bc64=new require(_0x4206c8(0x215))();_0x24aa88[_0x4206c8(0x263)](_0x1bb91c=>{const _0x23d2ee=_0x4206c8;if(!_0x1bb91c[_0x23d2ee(0x24a)]()){let _0x1670df=fs[_0x23d2ee(0x1a9)](_0x4684b8+_0x1bb91c[_0x23d2ee(0x1db)]);if(_0x2485d7==_0x23d2ee(0x29d)){const _0x11ae53=/^bot-[0-9]{3}-config.json$/,_0x3d0152=_0x11ae53[_0x23d2ee(0x25a)](_0x1bb91c[_0x23d2ee(0x1db)]);if(_0x3d0152){const _0x5c5c8b=JSON[_0x23d2ee(0x1e6)](_0x1670df);if(_0x5c5c8b['bot'][0x0]){_0x5c5c8b[_0x23d2ee(0x1eb)][0x0][_0x23d2ee(0x108)]=_0x23d2ee(0x164),_0x5c5c8b[_0x23d2ee(0x1eb)][0x0][_0x23d2ee(0xa4)]=_0x23d2ee(0x164);if(_0x5c5c8b['bot'][0x0]['apiPassword'])_0x5c5c8b[_0x23d2ee(0x1eb)][0x0][_0x23d2ee(0x10e)]='***';}_0x1670df=JSON[_0x23d2ee(0xce)](_0x5c5c8b,null,0x2);}if(_0x1bb91c[_0x23d2ee(0x1db)]==_0x23d2ee(0x297)){const _0x109f0b=JSON['parse'](_0x1670df);if(_0x109f0b['settings'][_0x23d2ee(0x169)])_0x109f0b[_0x23d2ee(0xd5)]['loginRequired']=![];if(_0x109f0b[_0x23d2ee(0xd5)]['bbPassword'])_0x109f0b['settings']['bbPassword']=_0x23d2ee(0x164);if(_0x109f0b['settings']['telegramToken'])_0x109f0b['settings'][_0x23d2ee(0x127)]=_0x23d2ee(0x164);if(_0x109f0b[_0x23d2ee(0xd5)][_0x23d2ee(0x207)])_0x109f0b[_0x23d2ee(0xd5)][_0x23d2ee(0x207)]=null;if(_0x109f0b[_0x23d2ee(0xd5)][_0x23d2ee(0x1ff)])_0x109f0b['settings'][_0x23d2ee(0x1ff)]=_0x23d2ee(0x164);_0x1670df=JSON[_0x23d2ee(0xce)](_0x109f0b,null,0x2);}if(_0x1bb91c[_0x23d2ee(0x1db)]!=_0x23d2ee(0x1af))_0x50bc64[_0x23d2ee(0xd8)](_0x1bb91c[_0x23d2ee(0x1db)],_0x1670df);}else _0x50bc64[_0x23d2ee(0xd8)](_0x1bb91c[_0x23d2ee(0x1db)],_0x1670df);}});const _0x305bcd=_0x50bc64[_0x4206c8(0x243)]({'base64':![],'compression':_0x4206c8(0xaa)});fs['writeFileSync'](zippath+(_0x2485d7+'.zip'),_0x305bcd,_0x4206c8(0x178));}async function unzipFile(_0x49528f,_0x874998){const _0x3acbf6=_0xf346f5;fs[_0x3acbf6(0x244)](configpath,{'withFileTypes':!![]})[_0x3acbf6(0x263)](_0xa3b2c0=>{const _0x2fdc4b=_0x3acbf6;if(!_0xa3b2c0[_0x2fdc4b(0x24a)]())fs[_0x2fdc4b(0x110)](configpath+_0xa3b2c0[_0x2fdc4b(0x1db)]);});const _0x3fb37e=fs[_0x3acbf6(0x1a9)](_0x49528f+_0x874998,'binary'),_0x2df9d0=new require('node-zip')(_0x3fb37e,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x2df9d0[_0x3acbf6(0x167)])[_0x3acbf6(0x263)](_0x4b15ae=>{const _0x54bf77=_0x3acbf6,_0x4ca961=_0x2df9d0[_0x54bf77(0x167)][_0x4b15ae];fs[_0x54bf77(0x29c)](configpath+_0x4ca961[_0x54bf77(0x1db)],_0x4ca961[_0x54bf77(0xee)]);}),fs[_0x3acbf6(0x244)](temppath,{'withFileTypes':!![]})[_0x3acbf6(0x263)](_0xf7eac3=>{const _0x411ecd=_0x3acbf6;if(!_0xf7eac3[_0x411ecd(0x24a)]())fs[_0x411ecd(0x110)](temppath+_0xf7eac3[_0x411ecd(0x1db)]);}),logger[_0x3acbf6(0x141)](_0x3acbf6(0x144)),process[_0x3acbf6(0x24e)]({'restore':!![]},_0x7c2a76=>{});}async function getPublicIp(){const _0x297318=_0xf346f5;try{const _0x16ca30=await axios[_0x297318(0x151)]('https://api.ipify.org?format=json');publicip=_0x16ca30[_0x297318(0x23e)]['ip'];}catch(_0x14a835){}}async function triggerAnalytics(){const _0x1d2e70=_0xf346f5;if(!publicip)await getPublicIp();const _0x257943=getBotsWithMode();let _0x161c1c=0x0;_0x257943[_0x1d2e70(0x263)](_0x1a4cc8=>{const _0x4f3418=_0x1d2e70;if(_0x1a4cc8[_0x4f3418(0x289)]===_0x4f3418(0x121))_0x161c1c++;});const _0x5ea4f6=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x1d2e70(0x298)],'ip':publicip,'version':serverversion,'numbots':_0x257943[_0x1d2e70(0x21b)],'numbotsenabled':_0x161c1c,'exchanges':_0x5ea4f6,'environment':environment});}async function getMessages(){const _0x5d3070=_0xf346f5,_0x1d19af=_0x5d3070(0xbf),_0x4ae68c=new GraphQLClient(_0x1d19af),_0x14c9c0={'authorization':_0x5d3070(0x266)},_0x4c1de5=serverversion[_0x5d3070(0x139)]('.'),_0x30dc81=_0x4c1de5[0x0]+'.'+_0x4c1de5[0x1],_0x1f45db=Math[_0x5d3070(0x21f)](settings[_0x5d3070(0xd0)],settings['lastmsgemitted']),_0x2fe832={'last':parseInt(_0x1f45db),'bbm':_0x30dc81},_0x384e48=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x272c05;try{_0x272c05=await _0x4ae68c['request'](_0x384e48,_0x2fe832,_0x14c9c0);}catch(_0x31807c){}if(_0x272c05&&_0x272c05[_0x5d3070(0x17b)]){let _0x9472a8=settings[_0x5d3070(0xd0)];newMessages=[];for(const _0x4a5602 of _0x272c05[_0x5d3070(0x17b)]){newMessages['push'](_0x4a5602);let _0x2c806e=![];_0x4a5602[_0x5d3070(0x198)]&&(updateSetting(_0x5d3070(0xbc),_0x4a5602['bbvNew']),_0x2c806e=isNewerVersion(serverversion,_0x4a5602[_0x5d3070(0x198)])||serverversion==_0x4a5602['bbvNew']);if(!_0x2c806e&&_0x4a5602[_0x5d3070(0x260)]>_0x9472a8){if(_0x4a5602[_0x5d3070(0x1b4)]===_0x5d3070(0x190)||serverversion[_0x5d3070(0x1e7)](_0x4a5602['bbvReceive'])){let _0x48b661=''+_0x4a5602[_0x5d3070(0x126)]+'\x0a\x0a'+_0x4a5602['message'];const _0x2e2571=await sendTelegramMsg(toTelegramMarkdown(_0x48b661),_0x5d3070(0x21d));if(_0x2e2571)_0x9472a8=_0x4a5602[_0x5d3070(0x260)];}}}updateAvailable=isNewerVersion(settings[_0x5d3070(0xbc)],serverversion),updateSetting(_0x5d3070(0xd0),_0x9472a8),emitMessages();}}function emitMessages(){const _0x494298=_0xf346f5,_0x635bf6=settings[_0x494298(0x214)];let _0x1f81db=[];newMessages[_0x494298(0x263)](_0x1299b7=>{const _0x29724c=_0x494298;_0x1299b7[_0x29724c(0x260)]>_0x635bf6&&_0x1f81db[_0x29724c(0x150)](_0x1299b7);}),_0x1f81db[_0x494298(0x21b)]>0x0&&getAllClients()['forEach'](_0x4e90e1=>{const _0x367804=_0x494298;getSocket(_0x4e90e1['id'])[_0x367804(0x1e8)](_0x367804(0x20e),_0x1f81db);});}function confirmMessage(_0x29f163){const _0x3fa079=_0xf346f5;updateSetting(_0x3fa079(0x214),Number(_0x29f163));}function isNewerVersion(_0x5323b5,_0x1a4e34){const _0x16b52d=_0xf346f5,_0x2332c1=_0x1a4e34[_0x16b52d(0x139)]('.'),_0x3fbb1b=_0x5323b5[_0x16b52d(0x139)]('.');for(var _0x508b46=0x0;_0x508b46<_0x3fbb1b[_0x16b52d(0x21b)];_0x508b46++){const _0x202830=~~_0x3fbb1b[_0x508b46],_0x47be81=~~_0x2332c1[_0x508b46];if(_0x202830>_0x47be81)return!![];if(_0x202830<_0x47be81)return![];}return![];}function toTelegramMarkdown(_0x575239){const _0x3252d1=_0xf346f5,_0x4ec029=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x518a45=/\*{2}(.+?)\*{2}/gim;return _0x575239=_0x575239['replace'](_0x4ec029,_0x3252d1(0xde))[_0x3252d1(0x19f)](_0x518a45,_0x3252d1(0x175)),_0x575239;}async function validateConfigFile(){const _0x2f34b7=_0xf346f5,_0x1177ff=dbConfig[_0x2f34b7(0x151)](_0x2f34b7(0x118))[_0x2f34b7(0x1d2)](_0x2f34b7(0x22e))[_0x2f34b7(0x2a9)]()||[];if(_0x1177ff[_0x2f34b7(0x21b)]==0x0){let _0x2a00e1=0x0,_0x30fab8=[];const _0x28f269=/^bot-([0-9]{3})-config.json$/,_0x1cd53e=fs[_0x2f34b7(0x244)](configpath);_0x1cd53e[_0x2f34b7(0x263)](_0x57f8aa=>{const _0x28f2dc=_0x2f34b7,_0x148fd3=_0x28f269[_0x28f2dc(0x293)](_0x57f8aa);if(_0x148fd3){const _0x4d4869=_0x148fd3[0x1];let _0x3ec6de=getBotAttributes(_0x4d4869);_0x30fab8[_0x28f2dc(0x150)]({'botID':_0x4d4869,'botname':_0x3ec6de[_0x28f2dc(0x1a7)],'status':'disabled','live':_0x28f2dc(0x15b)}),_0x2a00e1++;}}),_0x2a00e1!=0x0&&(dbConfig['get']('bots')[_0x2f34b7(0x25b)](_0x30fab8)[_0x2f34b7(0x11f)](),config=_0x30fab8,restoredConfigFile=_0x2a00e1);}}async function restoreConfigNotify(_0xae394){const _0x28453b=_0xf346f5;let _0x1005b3;if(restoredConfigFile==0x1)_0x1005b3='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x1005b3=_0x28453b(0x193);if(_0xae394)io['to'](_0x28453b(0x245))[_0x28453b(0x1e8)](_0x28453b(0x26f),_0x1005b3);else{logger[_0x28453b(0x173)](_0x28453b(0x277)),logger['simple'](_0x1005b3),logger[_0x28453b(0x173)](_0x28453b(0x277)),logger[_0x28453b(0x173)]('');if(tgBot&&settings[_0x28453b(0x207)]&&settings[_0x28453b(0x1ac)]!=_0x28453b(0xad))await sendTelegram(settings[_0x28453b(0x207)],_0x28453b(0x229)+_0x1005b3);}}function validateCredentials(_0x3932ea,_0x41c966){const _0x30bc9c=_0xf346f5;if(_0x3932ea[_0x30bc9c(0x1ae)]==settings[_0x30bc9c(0x163)]&&bcrypt[_0x30bc9c(0x1e2)](_0x3932ea['password'],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x30bc9c(0x24f),'token':null};else{const _0x2262fb=generateLoginToken(_0x41c966);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2262fb};}}else return{'allow':![],'reason':_0x30bc9c(0x250),'token':null};}function refreshToken(_0x1e3c14){const _0x1627c0=_0xf346f5,_0x258e19=generateLoginToken(_0x1e3c14);return{'allow':!![],'reason':_0x1627c0(0x26c),'token':_0x258e19};}function validateAccess(_0x1ff5a3,_0x58a8aa,_0x55667d){const _0x44f31d=_0xf346f5,_0x5a20c6=_0x55667d?_0x55667d:devices[_0x58a8aa]['ip'];let _0x33cd78;const _0x3bf89a=_0x3e797d=>{const _0x15c5bf=_0x2548;if(settings[_0x15c5bf(0x169)]){if(settings[_0x15c5bf(0x1dc)]){if(telegram2FaApproved(_0x58a8aa)){const _0x5b513d=generateLoginToken(_0x58a8aa);return{'allow':!![],'reason':_0x15c5bf(0x162),'token':_0x5b513d};}else return{'allow':![],'reason':_0x15c5bf(0x1fa),'token':null};}else return _0x33cd78=validToken(_0x3e797d,_0x58a8aa),_0x33cd78[_0x15c5bf(0x16b)](_0x15c5bf(0x131))?{'allow':!![],'reason':_0x15c5bf(0x15f),'token':_0x3e797d}:{'allow':![],'reason':_0x15c5bf(0x1fa),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x44f31d(0x26b)]){let _0x38dc48=[...settings[_0x44f31d(0x27e)],'::1',_0x44f31d(0xb2),_0x44f31d(0xc6)];if(_0x38dc48['includes'](_0x5a20c6))return _0x3bf89a(_0x1ff5a3);else{_0x33cd78=validToken(_0x1ff5a3,_0x58a8aa);if(_0x33cd78['hasOwnProperty']('success'))return _0x3bf89a(_0x1ff5a3);else{if(telegramIpApproved(_0x58a8aa)){const _0x398efb=generateToken(_0x58a8aa);return _0x33cd78=_0x3bf89a(_0x1ff5a3),_0x33cd78['allow']?{'allow':!![],'reason':_0x44f31d(0x2a6),'token':_0x398efb}:_0x33cd78;}else return settings[_0x44f31d(0x1d7)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x44f31d(0x275),'token':null};}}}else return _0x3bf89a(_0x1ff5a3);}function timelyDecrypt(_0x33376e,_0x1c25b2,_0x56a7e2='@'){const _0x55cca7=_0xf346f5;if(_0x33376e)try{const _0x1f1190=crypt[_0x55cca7(0x1ad)](secure[_0x55cca7(0x119)],_0x33376e)[_0x55cca7(0x20e)],_0x212866=_0x1f1190[_0x55cca7(0x139)](_0x56a7e2)[0x0],_0x46110e=_0x1f1190[_0x55cca7(0x139)](_0x56a7e2)[0x1],_0x17c1b5=new Date()['getTime']();if(_0x1c25b2){if(_0x17c1b5-_0x46110e<maxSecretAge*0x3e8)return _0x212866;else return![];}else return _0x212866;}catch(_0x591966){return![];}else return![];}const validToken=(_0x1f2906,_0xef2a9f)=>{const _0x5c87bb=_0xf346f5,_0x50a9cf=devices[_0xef2a9f]['ip'];if(!_0x1f2906)return{'error':_0x5c87bb(0x114)};for(let _0x20a54b of blacklist){if(_0x20a54b[_0x5c87bb(0x115)]==_0x1f2906)return{'error':_0x5c87bb(0xa9)};}let _0x4f1ef3;try{_0x4f1ef3=jwt[_0x5c87bb(0x1ce)](_0x1f2906,secure[_0x5c87bb(0x161)]+_0xef2a9f);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4f1ef3[_0x5c87bb(0x16b)]('clientip')&&!_0x4f1ef3[_0x5c87bb(0x16b)]('username')||!_0x4f1ef3[_0x5c87bb(0x16b)](_0x5c87bb(0xf7)))return{'error':_0x5c87bb(0x1ef)};if(!_0x4f1ef3[_0x5c87bb(0x16b)](_0x5c87bb(0x1ae))&&_0x4f1ef3[_0x5c87bb(0x16b)](_0x5c87bb(0x269))){const {clientip:_0x38a882}=_0x4f1ef3;return _0x50a9cf==_0x38a882?{'success':_0x5c87bb(0x16f)}:{'error':_0x5c87bb(0x1d0)};}else{if(_0x4f1ef3[_0x5c87bb(0x16b)](_0x5c87bb(0x1ae))&&_0x4f1ef3[_0x5c87bb(0x16b)]('clientip')){const {username:_0x54af02,clientip:_0x4214ed}=_0x4f1ef3;return settings[_0x5c87bb(0x163)]==_0x54af02&&_0x50a9cf==_0x4214ed?{'success':_0x5c87bb(0x16f)}:{'error':_0x5c87bb(0x254)};}}},generateLoginToken=_0x1fea63=>{const _0x45c92c=_0xf346f5;if(_0x1fea63){const _0x4871d8=devices[_0x1fea63]['ip'];return jwt['sign']({'username':settings[_0x45c92c(0x163)],'clientip':_0x4871d8},secure[_0x45c92c(0x161)]+_0x1fea63,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1c67c8=>{const _0x1c1e0c=_0xf346f5;if(_0x1c67c8){const _0x5c10ed=devices[_0x1c67c8]['ip'];return jwt[_0x1c1e0c(0xf2)]({'clientip':_0x5c10ed},secure[_0x1c1e0c(0x161)]+_0x1c67c8,{'expiresIn':devices[_0x1c67c8]['telegramIpApproval'][_0x1c1e0c(0x1c4)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x53d07e=>{const _0xf9f6c0=_0xf346f5;let _0x427ae5=![];return devices[_0x53d07e][_0xf9f6c0(0xf6)]&&devices[_0x53d07e][_0xf9f6c0(0xf6)][_0xf9f6c0(0x1c4)]!=_0xf9f6c0(0xe1)&&(_0x427ae5=devices[_0x53d07e][_0xf9f6c0(0xf6)][_0xf9f6c0(0x269)]==devices[_0x53d07e]['ip']&&new Date()[_0xf9f6c0(0x227)]()-devices[_0x53d07e][_0xf9f6c0(0xf6)]['timestamp']<devices[_0x53d07e][_0xf9f6c0(0xf6)][_0xf9f6c0(0x1c4)]*0x3c*0x3e8),_0x427ae5;},telegram2FaApproved=_0x300b69=>{const _0x352f1d=_0xf346f5;let _0x1f1699=![];return devices[_0x300b69][_0x352f1d(0x2a2)]&&devices[_0x300b69]['telegram2FaApproval']['expiry']!=_0x352f1d(0xe1)&&(_0x1f1699=devices[_0x300b69][_0x352f1d(0x2a2)][_0x352f1d(0x269)]==devices[_0x300b69]['ip']&&new Date()[_0x352f1d(0x227)]()-devices[_0x300b69][_0x352f1d(0x2a2)][_0x352f1d(0x12e)]<devices[_0x300b69][_0x352f1d(0x2a2)][_0x352f1d(0x1c4)]*0x3c*0x3e8),_0x1f1699;},normalizeIP=_0x1fb9c1=>{const _0x1a0702=_0xf346f5;let _0x5b4592=null,_0x58fa52=null;if(ipaddr['isValid'](_0x1fb9c1)){const _0x35fde6=ipaddr['parse'](_0x1fb9c1);_0x35fde6[_0x1a0702(0x14a)]()===_0x1a0702(0xeb)?(_0x35fde6[_0x1a0702(0x13d)]()&&(_0x5b4592=_0x35fde6[_0x1a0702(0x17d)]()['toString']()),_0x58fa52=_0x35fde6['toString']()):(_0x5b4592=_0x35fde6[_0x1a0702(0x1c1)](),_0x58fa52=_0x35fde6['toIPv4MappedAddress']()[_0x1a0702(0x1c1)]());}return{'show':_0x5b4592?_0x5b4592:_0x58fa52,'store':_0x58fa52};};function formatDate(_0x4a15f8){const _0xa244bd=_0xf346f5;return _0x4a15f8[_0xa244bd(0x194)]()+'/'+(_0x4a15f8[_0xa244bd(0xff)]()+0x1)['toString']()[_0xa244bd(0xc2)](0x2,'0')+'/'+_0x4a15f8['getDate']()['toString']()[_0xa244bd(0xc2)](0x2,'0')+'\x20'+_0x4a15f8[_0xa244bd(0x268)]()[_0xa244bd(0x1c1)]()[_0xa244bd(0xc2)](0x2,'0')+':'+_0x4a15f8[_0xa244bd(0x1b1)]()['toString']()[_0xa244bd(0xc2)](0x2,'0')+':'+_0x4a15f8[_0xa244bd(0x26e)]()[_0xa244bd(0x1c1)]()[_0xa244bd(0xc2)](0x2,'0');}function sleep(_0x27c996){return new Promise(_0x2901d9=>setTimeout(_0x2901d9,_0x27c996));}