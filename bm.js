const _0x4d89ed=_0x2b05;(function(_0x42831e,_0x20523d){const _0x433b49=_0x2b05,_0x97473a=_0x42831e();while(!![]){try{const _0x4c6ac3=-parseInt(_0x433b49(0x2d1))/0x1*(-parseInt(_0x433b49(0x2bb))/0x2)+-parseInt(_0x433b49(0x15a))/0x3*(-parseInt(_0x433b49(0x2dc))/0x4)+-parseInt(_0x433b49(0x2c5))/0x5*(-parseInt(_0x433b49(0x195))/0x6)+-parseInt(_0x433b49(0x207))/0x7*(-parseInt(_0x433b49(0x12a))/0x8)+parseInt(_0x433b49(0x2b6))/0x9+parseInt(_0x433b49(0x295))/0xa*(parseInt(_0x433b49(0x2f5))/0xb)+parseInt(_0x433b49(0x2cb))/0xc*(-parseInt(_0x433b49(0x13d))/0xd);if(_0x4c6ac3===_0x20523d)break;else _0x97473a['push'](_0x97473a['shift']());}catch(_0x258a49){_0x97473a['push'](_0x97473a['shift']());}}}(_0x2b3f,0x7e50b));const _0x1b14d1=function(){let _0x16a7f4=!![];return function(_0x489439,_0x1d579){const _0x4b10a4=_0x16a7f4?function(){if(_0x1d579){const _0xc1f649=_0x1d579['apply'](_0x489439,arguments);return _0x1d579=null,_0xc1f649;}}:function(){};return _0x16a7f4=![],_0x4b10a4;};}(),_0x334eb1=_0x1b14d1(this,function(){const _0x37e9e7=_0x2b05;return _0x334eb1['toString']()['search'](_0x37e9e7(0x20e))['toString']()[_0x37e9e7(0x212)](_0x334eb1)['search']('(((.+)+)+)+$');});_0x334eb1();'use strict';process[_0x4d89ed(0x28e)][_0x4d89ed(0x12d)]=0x1;const childProcess=require(_0x4d89ed(0x1b7)),fs=require('fs'),fns=require(_0x4d89ed(0x189)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x4d89ed(0x13a)),crypto=require(_0x4d89ed(0x1ee)),Crypt=require(_0x4d89ed(0x2ca))['Crypt'],RSA=require(_0x4d89ed(0x2ca))[_0x4d89ed(0x25c)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x4d89ed(0x1b5)),argv=require(_0x4d89ed(0x114))(process[_0x4d89ed(0xff)][_0x4d89ed(0x164)](0x2))[_0x4d89ed(0xff)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x4d89ed(0x108)),axios=require('axios'),{GraphQLClient,gql}=require(_0x4d89ed(0x1b8)),util=require('util'),fileUpload=require(_0x4d89ed(0x158)),{networkInterfaces}=require('os'),PORT=argv[_0x4d89ed(0x103)]||_0x4d89ed(0x2a1),pattern=/^[0-9]{2,4}$/;!pattern[_0x4d89ed(0x1b2)](PORT)&&(console[_0x4d89ed(0x14a)](_0x4d89ed(0x242)+PORT+_0x4d89ed(0x170)),process['exit'](0x1));const HOST=argv[_0x4d89ed(0xf6)]||null,userID=argv[_0x4d89ed(0x23f)]||'',debugging=argv['d']||![],nodeversion=process[_0x4d89ed(0x211)][_0x4d89ed(0x138)];let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0x4d89ed(0x149),settingsfile=_0x4d89ed(0x168),securefile=_0x4d89ed(0x2af),environment=require('./'+bbpath2+'version.json')[_0x4d89ed(0x27b)]||_0x4d89ed(0x241),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4d89ed(0x2ce)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4d89ed(0x20b)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x4d89ed(0x202),configbackuppath=configpath+_0x4d89ed(0x144),logspath=userID?bbpath+_0x4d89ed(0x279)+userID+'/':bbpath+_0x4d89ed(0x279),zippath=userID?bbpath+_0x4d89ed(0x2c1)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x4d89ed(0x2c0)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x4d89ed(0xf4)+userID+'/':bbpath+_0x4d89ed(0xf4);!fs[_0x4d89ed(0x2ce)](configpath)&&fs[_0x4d89ed(0x15f)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x4d89ed(0x15f)](configbackuppath);!fs[_0x4d89ed(0x2ce)](logspath)&&fs[_0x4d89ed(0x15f)](logspath);!fs[_0x4d89ed(0x2ce)](zippath)&&fs[_0x4d89ed(0x15f)](zippath);!fs['existsSync'](temppath)&&fs[_0x4d89ed(0x15f)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4d89ed(0x1a5)]({'bots':[]})[_0x4d89ed(0x11a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x2b05(_0x3ea46c,_0x313817){const _0x2ceee1=_0x2b3f();return _0x2b05=function(_0x334eb1,_0x1b14d1){_0x334eb1=_0x334eb1-0xf4;let _0x2b3f7f=_0x2ceee1[_0x334eb1];return _0x2b3f7f;},_0x2b05(_0x3ea46c,_0x313817);}dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4d89ed(0x16f),'onepagemode':![],'marketcapApi':''}})[_0x4d89ed(0x11a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4d89ed(0x1a5)]({'secure':{},'blacklist':[]})[_0x4d89ed(0x11a)]();let crypt=new Crypt({'md':_0x4d89ed(0x119),'rsaStandard':_0x4d89ed(0x12e)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4d89ed(0xfe)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x4d89ed(0x1b9)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x4d89ed(0x1a4)]!=''&&settings['telegramToken']!=_0x4d89ed(0x16b))&&settings[_0x4d89ed(0x219)]&&settings[_0x4d89ed(0x219)]!='')initTelegram();const parseColor=(_0x30d736,_0xc150cb)=>{const _0x18de5c=_0x4d89ed,_0x4acc88=/#[A-Z]{3}#/g;if(typeof _0x30d736==_0x18de5c(0x2c3)){!_0xc150cb?_0x30d736=_0x30d736[_0x18de5c(0x1d3)](_0x4acc88,''):(_0x30d736=_0x30d736[_0x18de5c(0x1d3)](/#BLU#/g,_0x18de5c(0x121)),_0x30d736=_0x30d736[_0x18de5c(0x1d3)](/#RED#/g,_0x18de5c(0x19f)),_0x30d736=_0x30d736['replace'](/#YEL#/g,'\x1b[33m'),_0x30d736=_0x30d736['replace'](/#MAG#/g,_0x18de5c(0x24d)),_0x30d736=_0x30d736['replace'](/#CYA#/g,_0x18de5c(0x183)),_0x30d736=_0x30d736[_0x18de5c(0x1d3)](/#RES#/g,_0x18de5c(0x28b)));;}return _0x30d736;},logger={'screen':_0x4b647b=>{const _0x51ba91=_0x4d89ed;console[_0x51ba91(0x14a)](parseColor(_0x4b647b,!![]));},'simple':_0x2c8b02=>{const _0x185976=_0x4d89ed;console['log'](parseColor(_0x2c8b02,!![])),loggerfile[_0x185976(0x11a)](util['format'](parseColor(_0x2c8b02,![]))+'\x0a');},'full':async _0x55e6ad=>{const _0x5b8da2=_0x4d89ed,_0x271601=getTimeStamp()+_0x5b8da2(0x29e)+_0x55e6ad;console[_0x5b8da2(0x14a)](parseColor(_0x271601,!![])),loggerfile[_0x5b8da2(0x11a)](util[_0x5b8da2(0x21e)](parseColor(_0x271601,![]))+'\x0a');if(tgBot&&settings[_0x5b8da2(0x105)]&&settings['telegramEvents']!=_0x5b8da2(0x12c))await sendTelegram(settings['telegramChatId'],_0x5b8da2(0x296)+parseColor(_0x55e6ad,![]));},'debug':async(_0x397203,_0x1ad054='')=>{const _0x25082a=_0x4d89ed,_0x31e421=getTimeStamp()+_0x25082a(0x2e0)+_0x397203;if(debugging)console[_0x25082a(0x14a)](parseColor(_0x31e421,!![]));loggerfile['write'](util[_0x25082a(0x21e)](parseColor(_0x31e421,![]))+'\x0a');if(_0x1ad054){if(debugging)console[_0x25082a(0x14a)](_0x1ad054);loggerfile[_0x25082a(0x11a)](util['format'](_0x1ad054)+'\x0a');}}};let terminating=![];process['on'](_0x4d89ed(0x180),function(_0x324f1e){const _0x2045cd=_0x4d89ed;_0x324f1e[_0x2045cd(0x274)]()[_0x2045cd(0x214)](_0x2045cd(0x28c))?(logger[_0x2045cd(0x184)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x324f1e[_0x2045cd(0x103)]+_0x2045cd(0x215)),process[_0x2045cd(0x25b)]({'terminate':!![]},_0x222a5e=>{})):logger[_0x2045cd(0x184)](_0x324f1e);}),process['on']('exit',()=>{const _0x54404c=_0x4d89ed;stopAllBots(),process[_0x54404c(0x267)](0x0);}),process['on'](_0x4d89ed(0x2ad),()=>{const _0x29e49e=_0x4d89ed;stopAllBots(),process[_0x29e49e(0x267)](0x0);}),process['on']('SIGINT',()=>{const _0x2248af=_0x4d89ed;stopAllBots(),process[_0x2248af(0x267)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4d89ed(0x1bc))[_0x4d89ed(0x26a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4d89ed(0x1d4)),app=express(),http=require('http')['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x4d89ed(0x124)](_0x4d89ed(0x2a7),async(_0x56fb19,_0x175361)=>{const _0x305240=_0x4d89ed,_0x2b2035=_0x56fb19['params']['type'],_0x133fd5=getClientsWithBotID(_0x305240(0x1c7)),_0x289d1c=_0x56fb19['headers']['uuid'],_0x60ee28=timelyDecrypt(_0x289d1c,![]),_0x1b7d13=_0x133fd5[_0x305240(0x122)](_0x14e744=>_0x14e744['uuid']==_0x60ee28);if(_0x1b7d13){const _0x316a47=normalizeIP(_0x56fb19[_0x305240(0x10f)]['remoteAddress'])[_0x305240(0x24e)],_0x5ef57d=_0x56fb19[_0x305240(0x1f7)][_0x305240(0x1eb)];if(validateAccess(_0x5ef57d,_0x60ee28,_0x316a47)[_0x305240(0x260)])_0x2b2035==_0x305240(0x23d)&&await backupConfigFiles(),await zipFiles(_0x2b2035),_0x175361[_0x305240(0x200)](zippath+(_0x2b2035+_0x305240(0x2ed)),_0x1c2c3e=>{const _0x1453a0=_0x305240;_0x1c2c3e&&(logger[_0x1453a0(0x221)](_0x1453a0(0x1ac)+_0x2b2035),logger[_0x1453a0(0x184)](_0x1c2c3e));});else logger['full'](_0x305240(0x2f2)+_0x2b2035+_0x305240(0x2a0));}else logger[_0x305240(0x221)](_0x305240(0x2f2)+_0x2b2035+'\x20(2)');}),app[_0x4d89ed(0x1e3)](_0x4d89ed(0x17c),async(_0x40b479,_0x3cd4f3)=>{const _0x3c6982=_0x4d89ed,_0x312cf1=getClientsWithBotID(_0x3c6982(0x1c7)),_0x21d0c4=_0x40b479[_0x3c6982(0x1f7)]['uuid'],_0x2db501=timelyDecrypt(_0x21d0c4,![]),_0x411512=_0x312cf1[_0x3c6982(0x122)](_0x27f98c=>_0x27f98c[_0x3c6982(0x224)]==_0x2db501);logger[_0x3c6982(0x1da)]('Backup\x20file\x20uploaded');if(_0x411512){const _0x6fc5df=normalizeIP(_0x40b479['socket']['remoteAddress'])[_0x3c6982(0x24e)],_0x59a7c4=_0x40b479['headers'][_0x3c6982(0x1eb)];if(validateAccess(_0x59a7c4,_0x2db501,_0x6fc5df)['allow']){if(_0x40b479[_0x3c6982(0x26b)]){const _0x2bec1a=_0x40b479['files'][_0x3c6982(0x1ec)];await _0x2bec1a['mv'](temppath+_0x2bec1a[_0x3c6982(0x1a3)]),_0x3cd4f3['send']({'status':!![],'message':_0x3c6982(0x249)});const _0x176f7a=getBotsWithMode();_0x176f7a[_0x3c6982(0x2c6)]>0x0?confirmRestore(temppath,_0x2bec1a[_0x3c6982(0x1a3)]):unzipFile(temppath,_0x2bec1a['name']);}}else logger[_0x3c6982(0x221)](_0x3c6982(0x18a));}else logger[_0x3c6982(0x221)](_0x3c6982(0x116));}),app['use'](express[_0x4d89ed(0x2e5)](path[_0x4d89ed(0x27a)](__dirname,bbpath2,_0x4d89ed(0x2d2)))),app[_0x4d89ed(0x2b9)](express[_0x4d89ed(0x2e5)](path[_0x4d89ed(0x27a)](__dirname,bbpath2,_0x4d89ed(0x270)))),app[_0x4d89ed(0x124)]('/',function(_0x258023,_0x3f830b){const _0x57418b=_0x4d89ed;_0x3f830b['sendFile'](path[_0x57418b(0x27a)](__dirname,bbpath2,_0x57418b(0x2d2),'index.html'));}),app[_0x4d89ed(0x124)](_0x4d89ed(0xf9),function(_0x4a0aa3,_0x539892){const _0x50f570=_0x4d89ed;_0x539892[_0x50f570(0x2c7)](path['join'](__dirname,bbpath2,_0x50f570(0x270),_0x50f570(0x24a)));}),app[_0x4d89ed(0x124)](_0x4d89ed(0x148),(_0x7efbb2,_0x322cf3)=>{const _0x28530c=_0x4d89ed;_0x322cf3[_0x28530c(0x2c7)](path['join'](__dirname,bbpath2,'build',_0x28530c(0x24a)));}),app[_0x4d89ed(0x124)](_0x4d89ed(0x246),(_0x3a3126,_0xecc03)=>{const _0x5153ae=_0x4d89ed;_0xecc03[_0x5153ae(0x2c7)](path[_0x5153ae(0x27a)](__dirname,bbpath2,_0x5153ae(0x270),'index.html'));}),app[_0x4d89ed(0x124)](_0x4d89ed(0x16a),(_0x2bb01c,_0x59e648)=>{const _0x483863=_0x4d89ed;_0x59e648['sendFile'](path[_0x483863(0x27a)](__dirname,bbpath2,_0x483863(0x270),_0x483863(0x24a)));}),app[_0x4d89ed(0x124)](_0x4d89ed(0x1f2),(_0x91af21,_0x2608f4)=>{const _0x210b11=_0x4d89ed;_0x2608f4[_0x210b11(0x2c7)](path[_0x210b11(0x27a)](__dirname,bbpath2,_0x210b11(0x270),_0x210b11(0x24a)));}),app[_0x4d89ed(0x124)](_0x4d89ed(0x1fe),(_0x5e8041,_0x32a243)=>{const _0x4d0df7=_0x4d89ed;_0x32a243[_0x4d0df7(0x2c7)](path[_0x4d0df7(0x27a)](__dirname,bbpath2,'build',_0x4d0df7(0x24a)));}),app[_0x4d89ed(0x124)](_0x4d89ed(0x1cf),(_0x16c782,_0x11d4cd)=>{const _0xeacc55=_0x4d89ed;_0x11d4cd[_0xeacc55(0x2c7)](path['join'](__dirname,bbpath2,'build',_0xeacc55(0x24a)));});if(HOST)http[_0x4d89ed(0x111)](PORT,HOST);else http['listen'](PORT);function _0x2b3f(){const _0x4d5a08=['Session\x20expired\x20for\x20user\x20...','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','getDate','_data','HTML','blacklist','Failed\x20to\x20download\x20','event','handshake','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getUTCHours','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','test','Telegraf\x20error:','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','ipaddr.js','timestamp','child_process','graphql-request','api-eu.mixpanel.com','CoinMarketCap\x20API\x20key\x20validated','off','version.json','title','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','startsWith','reply','/off\x20-\x20stop\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20confirm\x20message','cancel-loading','keys','backup-files','botmanager','Unauthorized\x20attempt\x20to\x20delete\x20alerts','reinstall','update','config_all','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','config_orders','token','/:bot/support','order','clientip','value','replace','express','min','Notifications\x20disabled\x0a','copyFileSync','getSeconds','request','debug','warning','Markdown','statSync','whitelist','once','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','isValid','getMinutes','post','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','SIGINT','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','callback','getFullYear','restore_no_','bot-','tkn','backupfile','randomFillSync','crypto',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Starting\x20(','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/:bot/history','reload','telegrammsg','userid','error','headers','update-bb','enable','username','You\x20can\x20use\x20the\x20following\x20commands:\x0a','address','sockets','/:bot/configuration','launch','download','Notifications\x20enabled','config/','temporary\x20access\x20not\x20allowed','(staging)','https://api.ipify.org?format=json','invalid\x20credentials','5040161kxVCyO','running','\x20|\x20','add','clients','sign','editMessageReplyMarkup','(((.+)+)+)+$','temporaryAccessAllowed','manual','versions','constructor','start','includes','#RES#','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Token\x20blacklisted','enabled','telegramUsername','accept','size','set','exchange','format','temporary\x20token\x20generated','from','full','alerts','Unauthorized\x20attempt\x20to\x20add\x20bot','uuid','placeOrder','button','backup-full','tempaccess_reject_','sendMessage','settings.','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','storeConfiguration','metrics','server','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Password\x20has\x20been\x20reset\x20to:\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','pidExpireLogin','login\x20token\x20valid','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Your\x20installation\x20is\x20already\x20up\x20to\x20date','staging','=>\x20Go\x20to\x20#CYA#http://','disconnect','get-messages','reason','yes','backup','toIPv4MappedAddress','user','\x20only\x0a','production','Error:\x20Invalid\x20argument\x20','Unauthorized\x20attempt\x20to\x20update\x20bot','confirm-message','backup-full@','/:bot/performance','loginRequired','restore-backup-file','File\x20uploaded','index.html','$1_$2_$3','getMonth','\x1b[35m','store',')\x20\x20\x20|\x20Bot\x20','store-fiat','expiry','bots','Orders','Logged\x20out\x20user\x20...','Starting\x20Balance\x20Bot\x20reinstallation','chat','disabled','file','toggle','data','send','RSA','Login\x20rejected','Bot\x20','output-001.log','allow','update-bot','node-zip','toIPv4Address','Unauthorized\x20attempt\x20to\x20get\x20events','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','No\x20authentication\x20token','exit','login\x20not\x20required','emit','version','files','Invalid\x20username\x20or\x20IP\x20address','timeshift','new','command','build','pidRefreshToken','names','cloneDeep','toString','compareSync','reset-history','password','Notifications\x20types:\x20','logs/','join','environment','args','emitHistory','-events.json','Error\x20while\x20deleting\x20config\x20files:\x20','Yes','kind','max','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','\x20to\x20','User\x20has\x20been\x20validated','messages','lastmsgtelegram','backup-full.zip','getTime','decrypt','\x1b[0m','address\x20already\x20in\x20use','reinstall-bb','env','Invalid\x20authentication\x20token\x20(1)','show','15\x20min','push','login\x20required','Starting\x20#RED#Balance\x20Bot\x20v','74520praQul','Bot\x20Mgr\x20>\x20','auth','split','live','started','Starting\x20new\x20bot\x20|\x20Bot\x20','marketcapApi','notification',':\x20Bot\x20Mgr\x20>\x20','new-disabled','\x20(1)','3000','Starting\x20Balance\x20Bot\x20update','stopped','Deleted\x20Bot\x20','privateKey','lastmsgemitted','/download/:type','metrics_','entries','close','range','removeAllListeners','SIGTERM','logout','bb-secure.json','output-000.log','map','text','writeFileSync','\x20minutes','family','6911118AHUjHV','kill','************','use','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','2QNkFRT','readFileSync','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Network\x20Interfaces:','output-003.log','createWriteStream','zip/','sendPortfolioTelegram','string','\x20>\x20','5qVPgps','length','sendFile','status','/metrics\x20-\x20show\x20bot\x20performance\x0a','hybrid-crypto-js','40920792UquvOF','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Login\x20accepted','existsSync','login2fa_reject_','Restoring\x20bot(s)\x20from\x20backup','960065wPwCeb','build2','binary','config_alerts','-results.json','apiKey','getPortfolio','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','bbvNew','Unauthorized\x20attempt\x20to\x20store\x20configuration','2FA\x20login\x20rejected','28GNCZmW','publicKey','disable','exp',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','show-config','endsWith','botID','assign','static','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','sortBy','unlinkSync','login\x20token\x20generated','botname','bbUsername','auto','.zip','getHours','All','Restore\x20process\x20aborted','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20download\x20','padStart','get-backup-files','495IVfwOF','whitelistEnabled','-config.json','temp/','remove','host','Error\x20details:','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','/:bot','reinstall_no','onepagemode','stringify','/restart\x20-\x20restart\x20bot(s)\x0a','init','argv','type','/help\x20-\x20show\x20available\x20commands\x0a','place-order','port','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','telegramChatId','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','inlineKeyboard','mixpanel','get-logs','rmSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','private','then','/on\x20-\x20start\x20bot(s)\x0a','socket','resetpw_yes','listen','bot','isDirectory','yargs/yargs','\x20mode','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','#RES#\x20if\x20running\x20on\x20server','/disable\x20-\x20disable\x20notifications\x0a','sha256','write','headless','match','showname','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','settings','conn','\x1b[34m','find','access\x20timeout','get','latestversion','sort','sendMetricsTelegram','Alerts','hasOwnProperty','8pePCnj','success','orders','NTBA_FIX_319','RSA-OAEP','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','delete-alerts','update_yes','DEFLATE','temporary\x20access\x20timeout','Node.js\x20v','Enabled\x20Bot\x20','Notifications\x20disabled','secret','node','forEach','path','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','referer','13cEDuxo','2FA\x20required','#RES#\x20','mode','Unauthorized\x20attempt\x20to\x20log\x20out','Ok,\x20will\x20send\x20order\x20notifications\x20only','#RES#\x20if\x20running\x20locally\x0a','backup/','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','hashSync','action','/:bot/portfolio','bb-config.json','log','message','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Temporary\x20access\x20rejected','No\x20bots\x20running\x20right\x20now','readdirSync','deleteHistoryAlerts','tempaccess_15_','parse','restart_','login','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','All\x20bots','number','express-fileupload','logged\x20out','249555iVEZjP','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','ipv6','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','mkdirSync','track','reject','telegram2FaApproval','function','slice','Access\x20enabled\x20for\x20','Allow\x20login\x20from\x20IP\x20address\x20','all','bb-settings.json','apiPassword','/:bot/coins','***','Restore\x20backup\x20file\x20','bbPassword','portfolio','0.0.0',',\x20must\x20be\x20a\x204\x20digit\x20number','Unauthorized\x20attempt\x20to\x20update\x20settings','telegramEnabled','add-bot','output-002.log','updatebotmanager','update_no','mtime','get-starting-balances','BCT','|@|','Setting\x20access:\x20','/upload-backup','telegramIpApproval','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20get\x20messages','uncaughtException','2FA\x20login\x20token\x20generated','resetHistory','\x1b[36m','simple','tempaccess_5_','config','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','connected','date-fns','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Invalid\x20IP\x20address','status\x20code\x20401','access','\x20|\x20client:\x20...','Backup\x20file\x20unzipped\x20and\x20stored','telegram',')\x20|\x20Bot\x20','ETH','stop','restart','3370968WWAaLY','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','filter','exec','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20show\x20configuration','toggle-bot-mode','2FA\x20login\x20required','-performance.json','Invalid\x20authentication\x20token\x20(2)','\x1b[31m','telegramEvents','-----------------------------------------------------------------------------------','generateKeyPairAsync','name','telegramToken','defaults'];_0x2b3f=function(){return _0x4d5a08;};return _0x2b3f();}const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x13966d=_0x4d89ed;let _0xecb63c='[ip-address]';const _0x351c65=networkInterfaces(),_0x1e4897={};for(const _0x3a05b7 of Object['keys'](_0x351c65)){for(const _0xa22fd3 of _0x351c65[_0x3a05b7]){if((_0xa22fd3[_0x13966d(0x2b5)]=='IPv4'||_0xa22fd3[_0x13966d(0x2b5)]==0x4)&&!_0xa22fd3['internal']){const _0x1e51e5=ipaddr['parse'](_0xa22fd3[_0x13966d(0x1fc)])[_0x13966d(0x2ab)]();_0x1e51e5!=_0x13966d(0x10c)&&(!_0x1e4897[_0x3a05b7]&&(_0x1e4897[_0x3a05b7]=[]),_0x1e4897[_0x3a05b7][_0x13966d(0x292)](_0xa22fd3[_0x13966d(0x1fc)]),_0xecb63c=_0xa22fd3[_0x13966d(0x1fc)]);}}}return{'serverip':_0xecb63c,'netinterfaces':_0x1e4897};}async function startServer(){const _0x40df52=_0x4d89ed,{serverip:_0x5a176f,netinterfaces:_0xd03965}=getServerIP();logger['simple'](''),logger[_0x40df52(0x184)]('-----------------------------------------------------------------------------------'),await logger[_0x40df52(0x221)](_0x40df52(0x294)+serverversion+_0x40df52(0x13f)+(environment==_0x40df52(0x237)?_0x40df52(0x204):'')+'\x0a'+(_0x40df52(0x1be)+PORT+_0x40df52(0x143))+(_0x40df52(0x238)+_0x5a176f+':'+PORT+_0x40df52(0x117))),logger[_0x40df52(0x184)](_0x40df52(0x1a1));if(config['length']!=0x0)for(const _0x48fd8d of config){const _0x287283=_0x48fd8d['mode']=='auto'?'a':'m';if(_0x48fd8d[_0x40df52(0x2c8)]==_0x40df52(0x218)||_0x48fd8d['status']=='new')await logger[_0x40df52(0x221)](_0x40df52(0x1f0)+_0x287283+_0x40df52(0x191)+_0x48fd8d[_0x40df52(0x2e3)]+_0x40df52(0x209)+_0x48fd8d['botname']),startBot([_0x48fd8d['botID'],userID],{'cwd':bbpath},function(_0x5394b2){const _0x210d0a=_0x40df52;if(_0x5394b2)logger[_0x210d0a(0x221)](_0x5394b2);});else(_0x48fd8d['status']=='disabled'||_0x48fd8d['status']=='new-disabled')&&await logger['full']('Idling\x20('+_0x287283+_0x40df52(0x24f)+_0x48fd8d[_0x40df52(0x2e3)]+_0x40df52(0x209)+_0x48fd8d[_0x40df52(0x2ea)]);}else!newBot&&logger[_0x40df52(0x184)](_0x40df52(0x1f1));if(newBot)addBot();logger[_0x40df52(0x184)](_0x40df52(0x1a1)),logger[_0x40df52(0x184)](''),await logger[_0x40df52(0x1da)](_0x40df52(0x134)+nodeversion),await logger[_0x40df52(0x1da)](_0x40df52(0x2be),_0xd03965);}function startSocket(){io['on']('connection',_0x35984c=>{const _0xbb5153=_0x2b05;let _0xb0b706,_0x1aa681,_0x4b83e6,_0x5bca69,_0x5233d6;const _0x487a2e=_0x35984c['handshake']['headers'][_0xbb5153(0x13c)];_0x1aa681=_0x487a2e['match'](/bot[0-9]{3}/);if(_0x1aa681)_0x4b83e6=_0x1aa681[0x0][_0xbb5153(0x11c)](/[0-9]{3}/);if(_0x4b83e6)_0xb0b706=_0x4b83e6[0x0];else _0xb0b706=_0xbb5153(0x1c7);const _0x29aa0e=_0x35984c[_0xbb5153(0x1ae)][_0xbb5153(0x297)]['encryptedUuid'];if(!_0x29aa0e)_0x35984c[_0xbb5153(0x269)](_0xbb5153(0x2c8),{'publicKey':secure[_0xbb5153(0x2dd)]});else{_0x5bca69=timelyDecrypt(_0x29aa0e,![]);if(!_0x5bca69)_0x35984c[_0xbb5153(0x269)]('status',{'publicKey':secure[_0xbb5153(0x2dd)]});else{_0x5233d6=normalizeIP(_0x35984c[_0xbb5153(0x120)]['remoteAddress'])[_0xbb5153(0x24e)];if(!devices[_0x5bca69])devices[_0x5bca69]={'uuid':_0x5bca69,'access':{'token':null}};devices[_0x5bca69]['ip']=_0x5233d6;const _0x224837=addClient(_0x35984c['id'],_0x5bca69,_0xb0b706);setAccess(_0x224837),emitMessages(),_0x35984c['on'](_0xbb5153(0x154),_0x5674f4=>{const _0x67695e=_0xbb5153,_0x30c83e=timelyDecrypt(_0x5674f4[_0x67695e(0x277)],!![],_0x67695e(0x17a));if(_0x30c83e){_0x5674f4={'username':_0x5674f4[_0x67695e(0x1fa)],'password':_0x30c83e},devices[_0x5bca69][_0x67695e(0x18d)]=validateCredentials(_0x5674f4,_0x5bca69);if(devices[_0x5bca69][_0x67695e(0x18d)][_0x67695e(0x260)]==![]&&devices[_0x5bca69]['access'][_0x67695e(0x23b)]==_0x67695e(0x19c))_0x35984c[_0x67695e(0x269)](_0x67695e(0x2c8),{'access':devices[_0x5bca69][_0x67695e(0x18d)]}),loginAccess2FA(_0x5bca69,_0x5233d6);else{if(devices[_0x5bca69]['access'][_0x67695e(0x260)]==![]&&devices[_0x5bca69]['access'][_0x67695e(0x23b)]==_0x67695e(0x206))_0x35984c[_0x67695e(0x269)]('status',{'access':devices[_0x5bca69][_0x67695e(0x18d)]});else devices[_0x5bca69][_0x67695e(0x18d)][_0x67695e(0x260)]&&devices[_0x5bca69][_0x67695e(0x18d)][_0x67695e(0x23b)]==_0x67695e(0x2e9)&&(getClientsWithUuid(_0x5bca69)['forEach'](_0x3d36e6=>{setAccess(_0x3d36e6);}),logger[_0x67695e(0x1da)]('Logged\x20in\x20user\x20...'+_0x5bca69[_0x67695e(0x164)](-0x8)),setTokenRefresh(_0x5bca69),setSessionTimeout(_0x67695e(0x154),_0x5bca69));}}else logger[_0x67695e(0x221)](_0x67695e(0x17e));}),_0x35984c['on']('reset-password',()=>{resetPassword();}),_0x35984c['on'](_0xbb5153(0x239),_0x3b875c=>{removeClient(_0x35984c['id']);}),_0xb0b706==_0xbb5153(0x1c7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x488d32){const _0x44de77=_0x4d89ed;if(_0x488d32!=_0x44de77(0x1c7)&&config[_0x44de77(0x2d6)]!=''){if(pid[_0x488d32])pid[_0x488d32]['send']({'function':'initclient','args':null});}_0x488d32!=_0x44de77(0x1c7)&&broadcastToBots(_0x44de77(0x252),JSON[_0x44de77(0xfc)](config));}function reloadBotManager(){const _0xfaf81d=_0x4d89ed;getClientsWithBotID(_0xfaf81d(0x1c7))['forEach'](_0x53eb94=>{const _0x4b3fe1=_0xfaf81d;getSocket(_0x53eb94['id'])[_0x4b3fe1(0x269)]('status',{'access':{'allow':![],'reason':_0x4b3fe1(0x1f3),'token':null}});});}function getSocket(_0x20bc9c){const _0x199c2b=_0x4d89ed;return io['sockets'][_0x199c2b(0x1fd)][_0x199c2b(0x124)](_0x20bc9c);}function setAccess(_0x419f2e){const _0x15aba3=_0x4d89ed,_0x50ba7d=getSocket(_0x419f2e['id']),_0x3f748f=_0x419f2e[_0x15aba3(0x224)],_0x352548=_0x419f2e[_0x15aba3(0x112)];devices[_0x3f748f][_0x15aba3(0x18d)]=validateAccess(devices[_0x3f748f][_0x15aba3(0x18d)][_0x15aba3(0x1ce)],_0x3f748f),logger[_0x15aba3(0x1da)](_0x15aba3(0x17b)+devices[_0x3f748f][_0x15aba3(0x18d)][_0x15aba3(0x23b)]+_0x15aba3(0x18e)+_0x419f2e['id'][_0x15aba3(0x164)](-0x8)+'\x20|\x20user:\x20...'+_0x3f748f[_0x15aba3(0x164)](-0x8)),_0x50ba7d['join'](_0x3f748f);if(devices[_0x3f748f][_0x15aba3(0x18d)]['allow']){_0x50ba7d[_0x15aba3(0x27a)](_0x352548);if(_0x352548==_0x15aba3(0x1c7))initializeSocketBotManager(_0x50ba7d);else initializeSocketBot(_0x50ba7d);initClient(_0x352548);}devices[_0x3f748f]['access'][_0x15aba3(0x1ce)]&&devices[_0x3f748f][_0x15aba3(0x18d)]['reason']==_0x15aba3(0x21f)&&setSessionTimeout('2FA',_0x3f748f),devices[_0x3f748f][_0x15aba3(0x18d)][_0x15aba3(0x1ce)]&&devices[_0x3f748f][_0x15aba3(0x18d)][_0x15aba3(0x23b)]==_0x15aba3(0x181)&&setSessionTimeout(_0x15aba3(0x154),_0x3f748f),_0x50ba7d[_0x15aba3(0x269)]('status',{'status':_0x419f2e[_0x15aba3(0x22e)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3f748f][_0x15aba3(0x18d)],'externalip':devices[_0x3f748f]['ip'],'publicKey':secure[_0x15aba3(0x2dd)],'userid':settings[_0x15aba3(0x1f5)],'validInstallation':validInstallation}),devices[_0x3f748f][_0x15aba3(0x18d)][_0x15aba3(0x260)]==![]&&devices[_0x3f748f][_0x15aba3(0x18d)][_0x15aba3(0x23b)]==_0x15aba3(0x13e)&&temporaryAccess2FA(_0x3f748f,devices[_0x3f748f]['ip']);}function setSessionTimeout(_0x542a3e,_0x7e7dce){const _0x4aadf5=_0x4d89ed;let _0x4e94da;if(_0x542a3e==_0x4aadf5(0x154))_0x4e94da=loginExpiry*0x3c*0x3e8;else _0x4e94da=devices[_0x7e7dce]['telegramIpApproval'][_0x4aadf5(0x251)]*0x3c*0x3e8-(new Date()[_0x4aadf5(0x289)]()-devices[_0x7e7dce][_0x4aadf5(0x17d)]['timestamp']);if(devices[_0x7e7dce][_0x4aadf5(0x233)])clearTimeout(devices[_0x7e7dce][_0x4aadf5(0x233)]);devices[_0x7e7dce][_0x4aadf5(0x233)]=setTimeout(()=>{const _0x5b487f=_0x4aadf5;if(devices[_0x7e7dce][_0x5b487f(0x271)])clearTimeout(devices[_0x7e7dce][_0x5b487f(0x271)]);removeSocketListeners(_0x7e7dce),addBlacklist(_0x7e7dce),devices[_0x7e7dce]['telegramIpApproval']=null,devices[_0x7e7dce][_0x5b487f(0x162)]=null,devices[_0x7e7dce]['access'][_0x5b487f(0x1ce)]=null,logger[_0x5b487f(0x1da)](_0x5b487f(0x1a6)+_0x7e7dce[_0x5b487f(0x164)](-0x8)),devices[_0x7e7dce][_0x5b487f(0x18d)]=validateAccess(devices[_0x7e7dce][_0x5b487f(0x18d)]['token'],_0x7e7dce),!(devices[_0x7e7dce][_0x5b487f(0x18d)][_0x5b487f(0x260)]&&devices[_0x7e7dce][_0x5b487f(0x18d)][_0x5b487f(0x23b)]==_0x5b487f(0x268))&&(_0x542a3e==_0x5b487f(0x154)?io['to'](_0x7e7dce)[_0x5b487f(0x269)](_0x5b487f(0x2c8),{'access':{'allow':![],'reason':_0x5b487f(0x123),'token':null}}):io['to'](_0x7e7dce)[_0x5b487f(0x269)](_0x5b487f(0x2c8),{'access':{'allow':![],'reason':_0x5b487f(0x133),'token':null}})),devices[_0x7e7dce][_0x5b487f(0x18d)][_0x5b487f(0x1ce)]=null;},_0x4e94da);}function setTokenRefresh(_0x1cd731){const _0x2c3322=_0x4d89ed;if(devices[_0x1cd731][_0x2c3322(0x271)])clearTimeout(devices[_0x1cd731]['pidRefreshToken']);devices[_0x1cd731][_0x2c3322(0x271)]=setTimeout(()=>{const _0x2f8295=_0x2c3322;getClientsWithUuid(_0x1cd731)['length']!=0x0?(devices[_0x1cd731]['access']=refreshToken(_0x1cd731),io['to'](_0x1cd731)[_0x2f8295(0x269)](_0x2f8295(0x2c8),{'status':_0x2f8295(0x188),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1cd731][_0x2f8295(0x18d)],'externalip':devices[_0x1cd731]['ip'],'publicKey':secure[_0x2f8295(0x2dd)],'validInstallation':validInstallation}),setTokenRefresh(_0x1cd731)):clearTimeout(devices[_0x1cd731][_0x2f8295(0x271)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x55f275){const _0x4981c4=_0x4d89ed,_0x6edb7d=getClient(_0x55f275['id'])[_0x4981c4(0x224)];_0x55f275[_0x4981c4(0x269)](_0x4981c4(0x252),config),_0x55f275[_0x4981c4(0x269)](_0x4981c4(0x11f),cleanSettings()),_0x55f275['on'](_0x4981c4(0x173),_0x26f490=>{const _0x6249d8=_0x4981c4;if(validateAccess(_0x26f490,_0x6edb7d)['allow'])addBot();else logger[_0x6249d8(0x221)](_0x6249d8(0x223));}),_0x55f275['on'](_0x4981c4(0x261),(_0x24b45d,_0x2ab3c6)=>{const _0x3a48ac=_0x4981c4;if(validateAccess(_0x2ab3c6,_0x6edb7d)[_0x3a48ac(0x260)])toggleBot(_0x24b45d[_0x3a48ac(0x2e3)],_0x24b45d[_0x3a48ac(0x2c8)],_0x24b45d['live']);else logger[_0x3a48ac(0x221)](_0x3a48ac(0x243));}),_0x55f275['on'](_0x4981c4(0x19b),(_0x5a6438,_0x3d2cb8)=>{const _0x463178=_0x4981c4;if(validateAccess(_0x3d2cb8,_0x6edb7d)[_0x463178(0x260)])toggleBotMode(_0x5a6438);else logger[_0x463178(0x221)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x55f275['on']('delete-bot',(_0x2ece3f,_0x3e0945)=>{const _0x2fd83e=_0x4981c4;if(validateAccess(_0x3e0945,_0x6edb7d)['allow'])deleteBot(_0x2ece3f);else logger[_0x2fd83e(0x221)](_0x2fd83e(0x199));}),_0x55f275['on']('store-settings',(_0x227510,_0x3520da)=>{const _0x2d385f=_0x4981c4;if(validateAccess(_0x3520da,_0x6edb7d)[_0x2d385f(0x260)])storeSettings(_0x227510,!![]);else logger['full'](_0x2d385f(0x171));}),_0x55f275['on'](_0x4981c4(0x1f8),_0x82e1ea=>{const _0x4e52f9=_0x4981c4;if(validateAccess(_0x82e1ea,_0x6edb7d)[_0x4e52f9(0x260)])updateBB(_0x4e52f9(0x1ca));else logger[_0x4e52f9(0x221)](_0x4e52f9(0x2d8));}),_0x55f275['on'](_0x4981c4(0x28d),_0x1f4a4e=>{const _0x35b891=_0x4981c4;if(validateAccess(_0x1f4a4e,_0x6edb7d)['allow'])updateBB('reinstall');else logger[_0x35b891(0x221)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x55f275['on'](_0x4981c4(0x2f4),_0x373b87=>{const _0x26d5c0=_0x4981c4;if(validateAccess(_0x373b87,_0x6edb7d)['allow']){const _0x25cada=getClient(_0x55f275['id']);if(_0x25cada)getBackupFiles(_0x25cada[_0x26d5c0(0x224)]);else logger[_0x26d5c0(0x221)](_0x26d5c0(0x145));}else logger['full'](_0x26d5c0(0x1b4));}),_0x55f275['on'](_0x4981c4(0x248),(_0x1ac9b6,_0x2d7e89)=>{if(validateAccess(_0x2d7e89,_0x6edb7d)['allow'])restoreBackupFile(_0x1ac9b6);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x55f275['on'](_0x4981c4(0x23a),_0x5b8b1a=>{const _0x2ad618=_0x4981c4;if(validateAccess(_0x5b8b1a,_0x6edb7d)['allow'])getMessages();else logger['full'](_0x2ad618(0x17f));}),_0x55f275['on'](_0x4981c4(0x244),(_0x37aaa6,_0x246296)=>{const _0x3ba24e=_0x4981c4;if(validateAccess(_0x246296,_0x6edb7d)[_0x3ba24e(0x260)])confirmMessage(_0x37aaa6);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x55f275['on'](_0x4981c4(0x2ae),_0x5eca62=>{const _0x4bd3f2=_0x4981c4;if(validateAccess(_0x5eca62,_0x6edb7d)['allow']){if(devices[_0x6edb7d]['pidRefreshToken'])clearTimeout(devices[_0x6edb7d][_0x4bd3f2(0x271)]);if(devices[_0x6edb7d][_0x4bd3f2(0x233)])clearTimeout(devices[_0x6edb7d][_0x4bd3f2(0x233)]);removeSocketListeners(getClient(_0x55f275['id'])[_0x4bd3f2(0x224)]),addBlacklist(_0x6edb7d),devices[_0x6edb7d][_0x4bd3f2(0x17d)]=null,devices[_0x6edb7d][_0x4bd3f2(0x162)]=null,devices[_0x6edb7d][_0x4bd3f2(0x18d)]['token']=null,logger[_0x4bd3f2(0x1da)]('Logged\x20out\x20user\x20...'+_0x6edb7d['slice'](-0x8)),io['to'](getClient(_0x55f275['id'])['uuid'])[_0x4bd3f2(0x269)]('status',{'access':{'allow':![],'reason':_0x4bd3f2(0x159),'token':null}});}else logger['full'](_0x4bd3f2(0x141));});}function initializeSocketBot(_0x2b4963){const _0x1f7e09=_0x4d89ed,_0x6758e1=getClient(_0x2b4963['id'])[_0x1f7e09(0x112)],_0x5a061b=getClient(_0x2b4963['id'])[_0x1f7e09(0x224)];_0x2b4963['on'](_0x1f7e09(0x109),(_0x912e19,_0x223a36)=>{const _0x4acb47=_0x1f7e09;if(validateAccess(_0x223a36,_0x5a061b)[_0x4acb47(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x4acb47(0x25b)]({'function':_0x4acb47(0x27d),'args':_0x912e19});}else logger[_0x4acb47(0x221)](_0x4acb47(0x264));}),_0x2b4963['on'](_0x1f7e09(0x130),(_0x523077,_0x5998af)=>{const _0xd60335=_0x1f7e09;if(validateAccess(_0x5998af,_0x5a061b)[_0xd60335(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0xd60335(0x25b)]({'function':_0xd60335(0x150),'args':_0x523077});}else logger['full'](_0xd60335(0x1c8));}),_0x2b4963['on']('get-portfolio',(_0x1d64e6,_0xaab256)=>{const _0x3ab95d=_0x1f7e09;if(validateAccess(_0xaab256,_0x5a061b)[_0x3ab95d(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x3ab95d(0x25b)]({'function':_0x3ab95d(0x2d7),'args':_0x1d64e6});}else logger[_0x3ab95d(0x221)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x2b4963['on']('store-configuration',(_0x251723,_0x213798)=>{const _0x11ac73=_0x1f7e09;if(validateAccess(_0x213798,_0x5a061b)['allow']){if(pid[_0x6758e1])pid[_0x6758e1][_0x11ac73(0x25b)]({'function':_0x11ac73(0x22c),'args':_0x251723});}else logger[_0x11ac73(0x221)](_0x11ac73(0x2da));}),_0x2b4963['on']('store-headless',(_0x298a18,_0x3baf95)=>{const _0x500a37=_0x1f7e09;if(validateAccess(_0x3baf95,_0x5a061b)[_0x500a37(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x500a37(0x25b)]({'function':'storeHeadless','args':_0x298a18});}else logger[_0x500a37(0x221)](_0x500a37(0x155));}),_0x2b4963['on'](_0x1f7e09(0x250),(_0x3eda23,_0x2109dd)=>{const _0xe90014=_0x1f7e09;if(validateAccess(_0x2109dd,_0x5a061b)[_0xe90014(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0xe90014(0x25b)]({'function':'storeFiat','args':_0x3eda23});}else logger[_0xe90014(0x221)](_0xe90014(0x104));}),_0x2b4963['on'](_0x1f7e09(0x276),_0x386906=>{const _0x2b04f5=_0x1f7e09;if(validateAccess(_0x386906,_0x5a061b)[_0x2b04f5(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x2b04f5(0x25b)]({'function':_0x2b04f5(0x182),'args':null});}else logger[_0x2b04f5(0x221)](_0x2b04f5(0x22f));}),_0x2b4963['on'](_0x1f7e09(0x178),_0x12fc55=>{const _0x22d0a4=_0x1f7e09;if(validateAccess(_0x12fc55,_0x5a061b)[_0x22d0a4(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x22d0a4(0x25b)]({'function':'getStartingBalances','args':null});}else logger[_0x22d0a4(0x221)](_0x22d0a4(0x2e6));}),_0x2b4963['on'](_0x1f7e09(0x102),(_0x1ef991,_0xffc5b4)=>{const _0x52c7db=_0x1f7e09;if(validateAccess(_0xffc5b4,_0x5a061b)[_0x52c7db(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x52c7db(0x25b)]({'function':_0x52c7db(0x225),'args':_0x1ef991});}else logger['full'](_0x52c7db(0x10b));}),_0x2b4963['on'](_0x1f7e09(0x1c4),_0x116871=>{const _0x39dfa0=_0x1f7e09;if(validateAccess(_0x116871,_0x5a061b)[_0x39dfa0(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1]['send']({'function':'cancelLoading','args':null});}else logger[_0x39dfa0(0x221)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x2b4963['on'](_0x1f7e09(0x2e1),_0x525861=>{const _0x7e74af=_0x1f7e09;if(validateAccess(_0x525861,_0x5a061b)[_0x7e74af(0x260)]){if(pid[_0x6758e1])pid[_0x6758e1][_0x7e74af(0x25b)]({'function':'showConfig','args':null});}else logger[_0x7e74af(0x221)](_0x7e74af(0x19a));}),_0x2b4963['on'](_0x1f7e09(0x1f8),_0x1961ec=>{const _0x11aaec=_0x1f7e09;if(validateAccess(_0x1961ec,_0x5a061b)[_0x11aaec(0x260)])updateBB('update');else logger[_0x11aaec(0x221)](_0x11aaec(0x2d8));}),_0x2b4963['on'](_0x1f7e09(0x23a),_0x421e08=>{const _0x17a580=_0x1f7e09;if(validateAccess(_0x421e08,_0x5a061b)[_0x17a580(0x260)])getMessages();else logger['full'](_0x17a580(0x17f));}),_0x2b4963['on'](_0x1f7e09(0x244),(_0x5bc252,_0xf68f4d)=>{const _0x47a11b=_0x1f7e09;if(validateAccess(_0xf68f4d,_0x5a061b)[_0x47a11b(0x260)])confirmMessage(_0x5bc252);else logger[_0x47a11b(0x221)](_0x47a11b(0x1c3));}),_0x2b4963['on'](_0x1f7e09(0x2ae),_0x14b685=>{const _0x47510d=_0x1f7e09;if(validateAccess(_0x14b685,_0x5a061b)[_0x47510d(0x260)]){if(devices[_0x5a061b][_0x47510d(0x271)])clearTimeout(devices[_0x5a061b][_0x47510d(0x271)]);if(devices[_0x5a061b][_0x47510d(0x233)])clearTimeout(devices[_0x5a061b][_0x47510d(0x233)]);removeSocketListeners(getClient(_0x2b4963['id'])[_0x47510d(0x224)]),addBlacklist(_0x5a061b),devices[_0x5a061b]['telegramIpApproval']=null,devices[_0x5a061b]['telegram2FaApproval']=null,devices[_0x5a061b]['access']['token']=null,logger[_0x47510d(0x1da)](_0x47510d(0x254)+_0x5a061b[_0x47510d(0x164)](-0x8)),io['to'](getClient(_0x2b4963['id'])[_0x47510d(0x224)])['emit']('status',{'access':{'allow':![],'reason':_0x47510d(0x159),'token':null}});}else logger[_0x47510d(0x221)](_0x47510d(0x141));});}function removeSocketListeners(_0xdb754b){const _0x4c9159=_0x4d89ed;getClientsWithUuid(_0xdb754b)[_0x4c9159(0x139)](_0x4e4ee9=>{const _0x311945=_0x4c9159;getSocket(_0x4e4ee9['id'])[_0x311945(0x2ac)]();});}function cleanSettings(){const _0x41c1f4=_0x4d89ed;let _0x5432e0=settings;return settings[_0x41c1f4(0x1a4)]&&settings[_0x41c1f4(0x1a4)]!=''&&(_0x5432e0={..._0x5432e0,'telegramToken':_0x41c1f4(0x2b8)}),settings[_0x41c1f4(0x16d)]&&settings['bbPassword']!=''&&(_0x5432e0={..._0x5432e0,'bbPassword':_0x41c1f4(0x2b8)}),settings['marketcapApi']&&settings['marketcapApi']!=''&&(_0x5432e0={..._0x5432e0,'marketcapApi':_0x41c1f4(0x2b8)}),(settings[_0x41c1f4(0x16d)]&&settings[_0x41c1f4(0x16d)]=='***'||settings['telegramToken']&&settings['telegramToken']==_0x41c1f4(0x16b)||settings[_0x41c1f4(0x29c)]&&settings[_0x41c1f4(0x29c)]==_0x41c1f4(0x16b))&&(_0x5432e0={..._0x5432e0,'restored':{'password':settings['bbPassword']==_0x41c1f4(0x16b),'telegram':settings[_0x41c1f4(0x1a4)]==_0x41c1f4(0x16b),'marketcap':settings[_0x41c1f4(0x29c)]=='***'}}),_0x5432e0;}async function updateBB(_0x5c3504){const _0x50131f=_0x4d89ed;await backupConfigFiles(),installingUpdate=!![],config[_0x50131f(0x139)](_0x336051=>{const _0x3877e0=_0x50131f;restartBot(_0x336051[_0x3877e0(0x2e3)]);});if(_0x5c3504==_0x50131f(0x1ca))process[_0x50131f(0x25b)]({'update':!![],'environment':environment},_0x41ac9d=>{});else _0x5c3504=='reinstall'&&process[_0x50131f(0x25b)]({'reinstall':!![],'environment':environment},_0x5df701=>{});}function startBot(_0x2a03c7,_0x5e5879,_0x18397d){const _0x9d562=_0x4d89ed;if(debugging)_0x2a03c7['push']('-d');let _0x5639c9=![];const _0x57cc3e=_0x2a03c7[0x0];_0x5e5879={..._0x5e5879,'stdio':['inherit','inherit','inherit','ipc']},pid[_0x57cc3e]=childProcess['fork'](botfile,_0x2a03c7,_0x5e5879),pid[_0x57cc3e]['on']('message',_0x39ef8a=>{const _0x13a41a=_0x2b05;switch(Object[_0x13a41a(0x1c5)](_0x39ef8a)[0x0]){case _0x13a41a(0x2ea):updateBotName(_0x57cc3e,_0x39ef8a[_0x13a41a(0x2ea)]);break;case _0x13a41a(0x175):updateBotManager();break;case _0x13a41a(0x2c8):updateStatus(_0x57cc3e,_0x39ef8a[_0x13a41a(0x2c8)]);break;case _0x13a41a(0x299):updateLive(_0x57cc3e,_0x39ef8a[_0x13a41a(0x299)]);break;case _0x13a41a(0x29a):updateLive(_0x57cc3e,_0x39ef8a[_0x13a41a(0x29a)]),io['to'](_0x57cc3e)[_0x13a41a(0x269)](_0x13a41a(0x2c8),{'access':{'allow':![],'reason':_0x13a41a(0x1f3),'token':null}});break;case _0x13a41a(0x193):_0x39ef8a[_0x13a41a(0x193)]==_0x13a41a(0x194)&&restartBot(_0x57cc3e);_0x39ef8a['stop']==_0x13a41a(0x2b7)&&toggleBot(_0x57cc3e,'disabled',_0x13a41a(0x2a3));break;case'telegram':sendTelegramBot(_0x57cc3e,_0x39ef8a['telegram']);break;case _0x13a41a(0x1f4):sendTelegramMsg(_0x39ef8a[_0x13a41a(0x1f4)]);break;case _0x13a41a(0x163):io['to'](_0x57cc3e)['emit'](_0x39ef8a['function'],_0x39ef8a[_0x13a41a(0x27c)]);break;}}),pid[_0x57cc3e]['on'](_0x9d562(0x1f6),function(_0x458ff6){if(_0x5639c9)return;_0x5639c9=!![],_0x18397d(_0x458ff6);}),pid[_0x57cc3e]['on']('exit',async function(_0x2c7ca1){const _0x5b6df1=_0x9d562;if(terminating)return;if(installingUpdate){logger[_0x5b6df1(0x1da)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x5b6df1(0x2aa)]();return;}if(_0x5639c9)return;_0x5639c9=!![],_0x18397d(null);const _0x400412=dbConfig[_0x5b6df1(0x124)](_0x5b6df1(0x252))[_0x5b6df1(0x122)]({'botID':_0x57cc3e})[_0x5b6df1(0x1d2)]();_0x400412&&(_0x400412[_0x5b6df1(0x2c8)]=='enabled'||_0x400412[_0x5b6df1(0x2c8)]=='new')&&(await sleep(0x3e8),updateLive(_0x57cc3e,_0x5b6df1(0x2a3)),logger['full']('Restarting\x20Bot\x20'+_0x57cc3e),startBot([_0x57cc3e,userID],{'cwd':bbpath},function(_0x36a10f){if(_0x36a10f)logger['full'](_0x36a10f);}));});}function stopBot(_0x1f0b07){const _0x341672=_0x4d89ed;getClientsWithBotID(_0x1f0b07)[_0x341672(0x139)](_0x290064=>{getSocket(_0x290064['id'])['disconnect'](!![]),removeClient(_0x290064['id']);}),pid[_0x1f0b07]&&(pid[_0x1f0b07][_0x341672(0x2b7)](),pid[_0x1f0b07]=null);}function stopAllBots(){terminating=!![];const _0x169a37=getEnabledBots();_0x169a37['forEach'](_0x590af1=>{const _0xf01095=_0x2b05;stopBot(_0x590af1[_0xf01095(0x2e3)]);});}function restartBot(_0x123fbc){const _0x3f67fb=_0x4d89ed;if(pid[_0x123fbc])pid[_0x123fbc][_0x3f67fb(0x2b7)]();}function addBot(){const _0x2cb5ae=_0x4d89ed;let _0x40de75;for(let _0x2a2618=0x1;_0x2a2618<0x3e9;_0x2a2618++){_0x40de75=_0x2a2618[_0x2cb5ae(0x274)]()[_0x2cb5ae(0x2f3)](0x3,'0');let _0x21066a=config[_0x2cb5ae(0x122)](_0x372399=>_0x372399[_0x2cb5ae(0x2e3)]==_0x40de75);if(!_0x21066a)break;}if(_0x40de75==='1000'){logger[_0x2cb5ae(0x221)](_0x2cb5ae(0x216));return;}logger[_0x2cb5ae(0x221)](_0x2cb5ae(0x29b)+_0x40de75),dbConfig[_0x2cb5ae(0x124)]('bots')[_0x2cb5ae(0x292)]({'botID':_0x40de75,'botname':'Bot\x20'+_0x40de75,'status':_0x2cb5ae(0x26e),'live':''})[_0x2cb5ae(0x11a)](),startBot([_0x40de75,userID],{'cwd':bbpath},function(_0x2eb315){const _0x54427f=_0x2cb5ae;if(_0x2eb315)logger[_0x54427f(0x221)](_0x2eb315);}),config=getConfiguration(),io['to'](_0x2cb5ae(0x1c7))[_0x2cb5ae(0x269)](_0x2cb5ae(0x252),config),broadcastToBots(_0x2cb5ae(0x252),JSON['stringify'](config));}function deleteBot(_0x1aeb27){const _0x1eeb58=_0x4d89ed;getClientsWithBotID(_0x1aeb27)[_0x1eeb58(0x139)](_0x4faab2=>{const _0x36dd02=_0x1eeb58;getSocket(_0x4faab2['id'])[_0x36dd02(0x239)](!![]),removeClient(_0x4faab2['id']);}),dbConfig[_0x1eeb58(0x124)](_0x1eeb58(0x252))[_0x1eeb58(0xf5)]({'botID':_0x1aeb27})['write'](),logger[_0x1eeb58(0x221)](_0x1eeb58(0x2a4)+_0x1aeb27),stopBot(_0x1aeb27);try{if(fs[_0x1eeb58(0x2ce)](path[_0x1eeb58(0x27a)](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+'-config.json')))fs[_0x1eeb58(0x2e8)](path['join'](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+_0x1eeb58(0x2f7)));if(fs[_0x1eeb58(0x2ce)](path['join'](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+_0x1eeb58(0x27e))))fs[_0x1eeb58(0x2e8)](path[_0x1eeb58(0x27a)](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+_0x1eeb58(0x27e)));if(fs['existsSync'](path[_0x1eeb58(0x27a)](configpath,'bot-'+_0x1aeb27+_0x1eeb58(0x19d))))fs[_0x1eeb58(0x2e8)](path[_0x1eeb58(0x27a)](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+'-performance.json'));if(fs[_0x1eeb58(0x2ce)](path[_0x1eeb58(0x27a)](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+_0x1eeb58(0x2d5))))fs[_0x1eeb58(0x2e8)](path[_0x1eeb58(0x27a)](configpath,_0x1eeb58(0x1ea)+_0x1aeb27+'-results.json'));}catch(_0x38d2d0){if(_0x38d2d0)logger[_0x1eeb58(0x221)](_0x1eeb58(0x27f),_0x38d2d0);}config=getConfiguration(),io['to'](_0x1eeb58(0x1c7))[_0x1eeb58(0x269)](_0x1eeb58(0x252),config),broadcastToBots(_0x1eeb58(0x252),JSON[_0x1eeb58(0xfc)](config));}function toggleBot(_0x5326ef,_0x5a9dc0,_0xe00d8a){const _0xd84176=_0x4d89ed;dbConfig['get'](_0xd84176(0x252))[_0xd84176(0x122)]({'botID':_0x5326ef})[_0xd84176(0x2e4)]({'status':_0x5a9dc0})[_0xd84176(0x2e4)]({'live':_0xe00d8a})[_0xd84176(0x11a)]();if(_0x5a9dc0==_0xd84176(0x218)||_0x5a9dc0==_0xd84176(0x26e))logger[_0xd84176(0x221)](_0xd84176(0x135)+_0x5326ef),startBot([_0x5326ef,userID],{'cwd':bbpath},function(_0x599ae2){const _0x8771f4=_0xd84176;if(_0x599ae2)logger[_0x8771f4(0x221)](_0x599ae2);});else(_0x5a9dc0=='disabled'||_0x5a9dc0==_0xd84176(0x29f))&&(logger['full']('Disabled\x20Bot\x20'+_0x5326ef),stopBot(_0x5326ef));config=getConfiguration(),io['to']('botmanager')[_0xd84176(0x269)]('bots',config),broadcastToBots(_0xd84176(0x252),JSON[_0xd84176(0xfc)](config));}function toggleStatus(_0x427268){const _0x153039=_0x4d89ed;let _0x100566=dbConfig['get'](_0x153039(0x252))[_0x153039(0x122)]({'botID':_0x427268})[_0x153039(0x1d2)](),_0x968b2c;if(_0x100566[_0x153039(0x2c8)]===_0x153039(0x218))_0x968b2c=_0x153039(0x257);else{if(_0x100566[_0x153039(0x2c8)]==='new')_0x968b2c=_0x153039(0x29f);else{if(_0x100566[_0x153039(0x2c8)]===_0x153039(0x29f))_0x968b2c=_0x153039(0x26e);else{if(_0x100566[_0x153039(0x2c8)]===_0x153039(0x257))_0x968b2c=_0x153039(0x218);}}}return _0x968b2c;}function updateStatus(_0x256fe1,_0x87388f){const _0x26a3eb=_0x4d89ed;dbConfig[_0x26a3eb(0x124)]('bots')[_0x26a3eb(0x122)]({'botID':_0x256fe1})[_0x26a3eb(0x2e4)]({'status':_0x87388f})['write'](),config=getConfiguration(),io['to'](_0x26a3eb(0x1c7))[_0x26a3eb(0x269)](_0x26a3eb(0x252),config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x2c837f,_0x469676){const _0x3cdda5=_0x4d89ed;dbConfig['get'](_0x3cdda5(0x252))['find']({'botID':_0x2c837f})[_0x3cdda5(0x2e4)]({'live':_0x469676})[_0x3cdda5(0x11a)](),config=getConfiguration(),io['to'](_0x3cdda5(0x1c7))['emit'](_0x3cdda5(0x252),config),broadcastToBots(_0x3cdda5(0x252),JSON[_0x3cdda5(0xfc)](config));}function updateBotName(_0x51c0f1,_0x147b96){const _0x293aed=_0x4d89ed;dbConfig[_0x293aed(0x124)]('bots')[_0x293aed(0x122)]({'botID':_0x51c0f1})[_0x293aed(0x2e4)]({'botname':_0x147b96})['write'](),config=getConfiguration(),io['to'](_0x293aed(0x1c7))[_0x293aed(0x269)](_0x293aed(0x252),config),broadcastToBots('bots',JSON[_0x293aed(0xfc)](config));}function updateBotManager(){const _0x6ff651=_0x4d89ed;config=getConfiguration(),io['to'](_0x6ff651(0x1c7))[_0x6ff651(0x269)](_0x6ff651(0x252),config),broadcastToBots(_0x6ff651(0x252),JSON[_0x6ff651(0xfc)](config));}function toggleBotMode(_0xbe9d4c){const _0x3682e9=_0x4d89ed;if(pid[_0xbe9d4c])pid[_0xbe9d4c][_0x3682e9(0x25b)]({'function':'toggleBotMode','args':null});else{const _0x367382=configpath+_0x3682e9(0x1ea)+_0xbe9d4c+'-config.json',_0x19b5e4=fs['readFileSync'](_0x367382),_0xfcb329=JSON[_0x3682e9(0x152)](_0x19b5e4),_0x29e7c4=_0xfcb329[_0x3682e9(0x112)][0x0][_0x3682e9(0x11b)];_0xfcb329[_0x3682e9(0x112)][0x0][_0x3682e9(0x11b)]=!_0x29e7c4;const _0x5e9cf5=JSON[_0x3682e9(0xfc)](_0xfcb329,null,0x2);fs[_0x3682e9(0x2b3)](_0x367382,_0x5e9cf5),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON[_0x3682e9(0xfc)](config));}}function validateTelegram(_0x1c21ad){const _0x309cdb=_0x4d89ed;if(_0x1c21ad[_0x309cdb(0x220)][_0x309cdb(0x1fa)]!=settings['telegramUsername']&&'@'+_0x1c21ad['from'][_0x309cdb(0x1fa)]!=settings['telegramUsername']||_0x1c21ad[_0x309cdb(0x256)]['id']!=settings['telegramChatId'])return sendTelegram(_0x1c21ad['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x309cdb(0x1aa)}),![];return!![];}async function initTelegram(){const _0x3205a1=_0x4d89ed;if(tgBot)tgBot[_0x3205a1(0x193)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x3205a1(0x1a4)]);let _0x550173=_0x3205a1(0x1fb);_0x550173+='\x0a',_0x550173+='/enable\x20-\x20enable\x20notifications\x0a',_0x550173+=_0x3205a1(0x118),_0x550173+=_0x3205a1(0x2ba),_0x550173+=_0x3205a1(0xfd),_0x550173+=_0x3205a1(0x10e),_0x550173+=_0x3205a1(0x1c1),_0x550173+=_0x3205a1(0x283),_0x550173+='/names\x20-\x20show\x20bot\x20names\x0a',_0x550173+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x550173+=_0x3205a1(0x2c9),_0x550173+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x550173+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x550173+=_0x3205a1(0x2bd),_0x550173+=_0x3205a1(0x101);let _0x3f89a8='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x3f89a8+='\x0a',_0x3f89a8+=_0x550173,tgBot['catch']((_0x541f54,_0x30c0c0)=>{const _0x8033b6=_0x3205a1;logger[_0x8033b6(0x184)](getTimeStamp()+_0x8033b6(0x1ef)),logger[_0x8033b6(0x1da)](_0x8033b6(0x1b3),_0x541f54);}),tgBot[_0x3205a1(0x2b9)](async(_0x3632fc,_0x517d04)=>{const _0x4ad3e2=_0x3205a1;if(!(!settings[_0x4ad3e2(0x105)]&&_0x3632fc['update']['message'][_0x4ad3e2(0x2b2)]=='/start')){if(!validateTelegram(_0x3632fc))return;}_0x517d04();}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x213),async _0x2fc7b9=>{const _0x2c0e55=_0x3205a1;if(!settings[_0x2c0e55(0x105)])updateSetting(_0x2c0e55(0x105),_0x2fc7b9[_0x2c0e55(0x256)]['id']);updateSetting(_0x2c0e55(0x172),!![]);if(!validateTelegram(_0x2fc7b9))return;await sendTelegram(_0x2fc7b9['chat']['id'],_0x3f89a8);}),tgBot['command'](_0x3205a1(0x1f9),async _0xb78c00=>{const _0x30d222=_0x3205a1;updateSetting(_0x30d222(0x172),!![]),await sendTelegram(_0xb78c00['chat']['id'],_0x30d222(0x201));}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x2de),async _0x1246f7=>{const _0x4f8faa=_0x3205a1;await sendTelegram(_0x1246f7[_0x4f8faa(0x256)]['id'],_0x4f8faa(0x136)),updateSetting(_0x4f8faa(0x172),![]);}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x186),async _0x46c427=>{const _0x4902ee=_0x3205a1,_0x11335c=Markup[_0x4902ee(0x107)]([Markup[_0x4902ee(0x226)][_0x4902ee(0x1e7)](_0x4902ee(0x253),_0x4902ee(0x1cd)),Markup['button']['callback'](_0x4902ee(0x128),_0x4902ee(0x2d4)),Markup['button'][_0x4902ee(0x1e7)](_0x4902ee(0x2ef),'config_all')]);_0x46c427[_0x4902ee(0x1c0)](_0x4902ee(0x230),_0x11335c);}),tgBot[_0x3205a1(0x147)](_0x3205a1(0x1cd),async _0xa7197a=>{const _0x2524cb=_0x3205a1;_0xa7197a[_0x2524cb(0x20d)](),updateSetting(_0x2524cb(0x1a0),_0x2524cb(0x12c)),updateSetting(_0x2524cb(0x172),!![]),await sendTelegram(_0xa7197a[_0x2524cb(0x256)]['id'],_0x2524cb(0x142));}),tgBot[_0x3205a1(0x147)](_0x3205a1(0x2d4),async _0x3ee6eb=>{const _0x41e061=_0x3205a1;_0x3ee6eb[_0x41e061(0x20d)](),updateSetting(_0x41e061(0x1a0),_0x41e061(0x222)),updateSetting(_0x41e061(0x172),!![]),await sendTelegram(_0x3ee6eb[_0x41e061(0x256)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x3205a1(0x147)](_0x3205a1(0x1cb),async _0x4f4169=>{const _0x12bf5d=_0x3205a1;_0x4f4169[_0x12bf5d(0x20d)](),updateSetting('telegramEvents',_0x12bf5d(0x167)),updateSetting(_0x12bf5d(0x172),!![]),await sendTelegram(_0x4f4169[_0x12bf5d(0x256)]['id'],_0x12bf5d(0x106));}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x2c8),async _0x35459d=>{const _0x44fe69=_0x3205a1,_0x35890d=getBotsWithMode();let _0x3f351e='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x44fe69(0x139)](_0x3dccaf=>{const _0x43c6e8=_0x44fe69,_0x9278cc=_0x35890d[_0x43c6e8(0x122)](_0x4c023d=>_0x4c023d[_0x43c6e8(0x2e3)]==_0x3dccaf[_0x43c6e8(0x2e3)])['mode'];_0x3f351e+=_0x43c6e8(0x25e)+_0x3dccaf[_0x43c6e8(0x2e3)]+':\x20'+_0x3dccaf['status']+'\x20|\x20'+_0x9278cc+_0x43c6e8(0x209)+_0x3dccaf['live']+'\x0a';}),_0x3f351e+='\x0a',_0x3f351e+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x3f351e+=!settings[_0x44fe69(0x172)]?_0x44fe69(0x1d6):'Notifications\x20enabled\x0a',_0x3f351e+=settings[_0x44fe69(0x172)]?settings[_0x44fe69(0x1a0)]==_0x44fe69(0x167)?_0x44fe69(0x1e6):_0x44fe69(0x278)+settings[_0x44fe69(0x1a0)]+_0x44fe69(0x240):'',await sendTelegram(_0x35459d[_0x44fe69(0x256)]['id'],_0x3f351e,{'parse_mode':_0x44fe69(0x1aa)});}),tgBot[_0x3205a1(0x26f)]('restart',async _0x5b6f7b=>{const _0x7869c0=_0x3205a1,_0x3d8c7c=getEnabledBots();if(_0x3d8c7c[_0x7869c0(0x2c6)]==0x0)await sendTelegram(_0x5b6f7b[_0x7869c0(0x256)]['id'],_0x7869c0(0x14e));else{if(_0x3d8c7c[_0x7869c0(0x2c6)]>0x1)_0x3d8c7c[_0x7869c0(0x292)]({'botID':_0x7869c0(0x167)});let _0x17ee2c=[],_0x4e4d0a=[];const _0x26eaf0=_0x3d8c7c['length']%0x4==0x0||_0x3d8c7c[_0x7869c0(0x2c6)]%0x4==0x3||_0x3d8c7c[_0x7869c0(0x2c6)]%0x3==0x1?0x4:0x3;let _0x5eeb9a=0x0;_0x3d8c7c[_0x7869c0(0x139)]((_0x1d8692,_0x5b7c4f)=>{const _0x221359=_0x7869c0;if(_0x5b7c4f%_0x26eaf0==0x0)_0x4e4d0a=[];_0x4e4d0a[_0x221359(0x292)](Markup[_0x221359(0x226)]['callback'](_0x1d8692[_0x221359(0x2e3)]=='all'?_0x221359(0x156):_0x221359(0x25e)+_0x1d8692['botID'],_0x221359(0x153)+_0x1d8692['botID'])),_0x5b7c4f%_0x26eaf0==0x0&&(_0x17ee2c[_0x5eeb9a]=_0x4e4d0a,_0x5eeb9a++);});const _0xc10da7=Markup['inlineKeyboard'](_0x17ee2c);_0x5b6f7b[_0x7869c0(0x1c0)](_0x7869c0(0x1af),_0xc10da7);}}),tgBot['action'](/restart_(.+)/,async _0x1161c9=>{const _0x1ffa9c=_0x3205a1,_0x44aa80=_0x1161c9[_0x1ffa9c(0x11c)][0x1];_0x1161c9['editMessageReplyMarkup'](),_0x44aa80==_0x1ffa9c(0x167)?config['forEach'](_0x191e1d=>{const _0x5b19ce=_0x1ffa9c;restartBot(_0x191e1d[_0x5b19ce(0x2e3)]);}):restartBot(_0x44aa80);}),tgBot['command']('on',async _0x5b1654=>{const _0x354e2a=_0x3205a1,_0x404e0c=getDisabledBots();if(_0x404e0c['length']==0x0)await sendTelegram(_0x5b1654['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x404e0c[_0x354e2a(0x2c6)]>0x1)_0x404e0c['push']({'botID':_0x354e2a(0x167)});let _0x2a1993=[],_0x4efdf9=[];const _0x4d5905=_0x404e0c[_0x354e2a(0x2c6)]%0x4==0x0||_0x404e0c[_0x354e2a(0x2c6)]%0x4==0x3||_0x404e0c[_0x354e2a(0x2c6)]%0x3==0x1?0x4:0x3;let _0x588a6f=0x0;_0x404e0c[_0x354e2a(0x139)]((_0x5bddec,_0x3bf8ac)=>{const _0x490a2b=_0x354e2a;if(_0x3bf8ac%_0x4d5905==0x0)_0x4efdf9=[];_0x4efdf9[_0x490a2b(0x292)](Markup['button'][_0x490a2b(0x1e7)](_0x5bddec['botID']==_0x490a2b(0x167)?_0x490a2b(0x156):_0x490a2b(0x25e)+_0x5bddec[_0x490a2b(0x2e3)],'on_'+_0x5bddec[_0x490a2b(0x2e3)])),_0x3bf8ac%_0x4d5905==0x0&&(_0x2a1993[_0x588a6f]=_0x4efdf9,_0x588a6f++);});const _0x1647d0=Markup[_0x354e2a(0x107)](_0x2a1993);_0x5b1654[_0x354e2a(0x1c0)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x1647d0);}}),tgBot['action'](/on_(.+)/,async _0x3f3ed2=>{const _0x4e1dc2=_0x3205a1,_0x449304=_0x3f3ed2[_0x4e1dc2(0x11c)][0x1];_0x3f3ed2[_0x4e1dc2(0x20d)]();if(_0x449304==_0x4e1dc2(0x167)){const _0x2cec4b=getDisabledBots();await sendTelegram(_0x3f3ed2[_0x4e1dc2(0x256)]['id'],_0x4e1dc2(0x232)),_0x2cec4b[_0x4e1dc2(0x139)](_0x314c0f=>{const _0x36a4c3=_0x4e1dc2;if(_0x314c0f[_0x36a4c3(0x2e3)]!=_0x36a4c3(0x167))toggleBot(_0x314c0f[_0x36a4c3(0x2e3)],toggleStatus(_0x314c0f[_0x36a4c3(0x2e3)]),_0x36a4c3(0x2a3));});}else await sendTelegram(_0x3f3ed2['chat']['id'],_0x4e1dc2(0x265)+_0x449304),toggleBot(_0x449304,toggleStatus(_0x449304),'stopped');}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x1bb),async _0x5d1522=>{const _0x585350=_0x3205a1,_0x2e795a=getEnabledBots();if(_0x2e795a[_0x585350(0x2c6)]==0x0)await sendTelegram(_0x5d1522[_0x585350(0x256)]['id'],_0x585350(0x14e));else{if(_0x2e795a[_0x585350(0x2c6)]>0x1)_0x2e795a[_0x585350(0x292)]({'botID':_0x585350(0x167)});let _0x12fbe9=[],_0x3b350f=[];const _0xdf9004=_0x2e795a['length']%0x4==0x0||_0x2e795a[_0x585350(0x2c6)]%0x4==0x3||_0x2e795a[_0x585350(0x2c6)]%0x3==0x1?0x4:0x3;let _0x197f91=0x0;_0x2e795a['forEach']((_0x491681,_0x15a6e5)=>{const _0x48b3a1=_0x585350;if(_0x15a6e5%_0xdf9004==0x0)_0x3b350f=[];_0x3b350f['push'](Markup[_0x48b3a1(0x226)][_0x48b3a1(0x1e7)](_0x491681['botID']=='all'?_0x48b3a1(0x156):'Bot\x20'+_0x491681[_0x48b3a1(0x2e3)],'off_'+_0x491681['botID'])),_0x15a6e5%_0xdf9004==0x0&&(_0x12fbe9[_0x197f91]=_0x3b350f,_0x197f91++);});const _0x3c0464=Markup[_0x585350(0x107)](_0x12fbe9);_0x5d1522[_0x585350(0x1c0)](_0x585350(0x235),_0x3c0464);}}),tgBot[_0x3205a1(0x147)](/off_(.+)/,async _0xf0520b=>{const _0x3b263f=_0x3205a1,_0x2a0bfc=_0xf0520b['match'][0x1];_0xf0520b['editMessageReplyMarkup']();if(_0x2a0bfc=='all'){const _0x34a8f3=getEnabledBots();await sendTelegram(_0xf0520b['chat']['id'],_0x3b263f(0x1c2)),_0x34a8f3['forEach'](_0xaedb58=>{const _0x307493=_0x3b263f;if(_0xaedb58['botID']!=_0x307493(0x167))toggleBot(_0xaedb58[_0x307493(0x2e3)],toggleStatus(_0xaedb58[_0x307493(0x2e3)]),_0x307493(0x2a3));});}else await sendTelegram(_0xf0520b[_0x3b263f(0x256)]['id'],_0x3b263f(0x11e)+_0x2a0bfc),toggleBot(_0x2a0bfc,toggleStatus(_0x2a0bfc),_0x3b263f(0x2a3));}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x22d),async _0x35dbbb=>{const _0x408b00=_0x3205a1,_0x9cc95d=getEnabledBots();if(_0x9cc95d[_0x408b00(0x2c6)]==0x0)await sendTelegram(_0x35dbbb[_0x408b00(0x256)]['id'],_0x408b00(0x14e));else{if(_0x9cc95d['length']>0x1){let _0x331d30=[],_0x3cf45e=[];const _0x21ef78=_0x9cc95d[_0x408b00(0x2c6)]%0x4==0x0||_0x9cc95d[_0x408b00(0x2c6)]%0x4==0x3||_0x9cc95d['length']%0x3==0x1?0x4:0x3;let _0x1608b7=0x0;_0x9cc95d['forEach']((_0x453b82,_0x1aa822)=>{const _0x279ce7=_0x408b00;if(_0x1aa822%_0x21ef78==0x0)_0x3cf45e=[];_0x3cf45e['push'](Markup['button'][_0x279ce7(0x1e7)]('Bot\x20'+_0x453b82[_0x279ce7(0x2e3)],_0x279ce7(0x2a8)+_0x453b82['botID'])),_0x1aa822%_0x21ef78==0x0&&(_0x331d30[_0x1608b7]=_0x3cf45e,_0x1608b7++);});const _0x4d3f70=Markup[_0x408b00(0x107)](_0x331d30);_0x35dbbb['reply'](_0x408b00(0x12f),_0x4d3f70);}else{const _0xc9b6a7=_0x9cc95d[0x0]['botID'];if(pid[_0xc9b6a7])pid[_0xc9b6a7][_0x408b00(0x25b)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x3205a1(0x147)](/metrics_(.+)/,async _0x170b43=>{const _0x2f804d=_0x3205a1,_0x2141b0=_0x170b43[_0x2f804d(0x11c)][0x1];_0x170b43[_0x2f804d(0x20d)]();if(pid[_0x2141b0])pid[_0x2141b0][_0x2f804d(0x25b)]({'function':_0x2f804d(0x127),'args':null});}),tgBot['command'](_0x3205a1(0x16e),async _0x5bd91c=>{const _0x2b2e23=_0x3205a1,_0x45847b=getEnabledBots();if(_0x45847b[_0x2b2e23(0x2c6)]==0x0)await sendTelegram(_0x5bd91c[_0x2b2e23(0x256)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x45847b['length']>0x1){let _0x331101=[],_0x1d2201=[];const _0x5f2c5e=_0x45847b[_0x2b2e23(0x2c6)]%0x4==0x0||_0x45847b['length']%0x4==0x3||_0x45847b[_0x2b2e23(0x2c6)]%0x3==0x1?0x4:0x3;let _0x2672a5=0x0;_0x45847b[_0x2b2e23(0x139)]((_0x5482dd,_0x16c5d3)=>{const _0x29be8f=_0x2b2e23;if(_0x16c5d3%_0x5f2c5e==0x0)_0x1d2201=[];_0x1d2201[_0x29be8f(0x292)](Markup[_0x29be8f(0x226)][_0x29be8f(0x1e7)](_0x29be8f(0x25e)+_0x5482dd[_0x29be8f(0x2e3)],'portfolio_'+_0x5482dd['botID'])),_0x16c5d3%_0x5f2c5e==0x0&&(_0x331101[_0x2672a5]=_0x1d2201,_0x2672a5++);});const _0x5e001e=Markup[_0x2b2e23(0x107)](_0x331101);_0x5bd91c[_0x2b2e23(0x1c0)](_0x2b2e23(0x15d),_0x5e001e);}else{const _0x19ac92=_0x45847b[0x0][_0x2b2e23(0x2e3)];if(pid[_0x19ac92])pid[_0x19ac92][_0x2b2e23(0x25b)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x3205a1(0x147)](/portfolio_(.+)/,async _0x18b439=>{const _0x1b8889=_0x3205a1,_0x27c885=_0x18b439[_0x1b8889(0x11c)][0x1];_0x18b439['editMessageReplyMarkup']();if(pid[_0x27c885])pid[_0x27c885][_0x1b8889(0x25b)]({'function':_0x1b8889(0x2c2),'args':null});}),tgBot[_0x3205a1(0x26f)]('update',async _0xcd153d=>{const _0x2a15be=_0x3205a1;await getMessages();if(!updateAvailable)await sendTelegram(_0xcd153d['chat']['id'],_0x2a15be(0x236));else{if(!validInstallation)await sendTelegram(_0xcd153d[_0x2a15be(0x256)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x52f0a4=Markup[_0x2a15be(0x107)]([Markup['button']['callback']('Yes',_0x2a15be(0x131)),Markup[_0x2a15be(0x226)][_0x2a15be(0x1e7)]('No',_0x2a15be(0x176))]);_0xcd153d[_0x2a15be(0x1c0)](_0x2a15be(0x1e0),_0x52f0a4);}}}),tgBot[_0x3205a1(0x147)](/update_(.+)/,async _0xdff761=>{const _0xe0b83f=_0x3205a1,_0x51de5a=_0xdff761[_0xe0b83f(0x11c)][0x1];_0xdff761[_0xe0b83f(0x20d)](),_0x51de5a==_0xe0b83f(0x23c)&&(await sendTelegram(_0xdff761['chat']['id'],_0xe0b83f(0x2a2)),updateBB(_0xe0b83f(0x1ca))),_0x51de5a=='no'&&await sendTelegram(_0xdff761[_0xe0b83f(0x256)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x1c9),async _0x403162=>{const _0x4ffd4d=_0x3205a1;if(!validInstallation)await sendTelegram(_0x403162[_0x4ffd4d(0x256)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0xa7d764=Markup['inlineKeyboard']([Markup[_0x4ffd4d(0x226)]['callback'](_0x4ffd4d(0x280),'reinstall_yes'),Markup['button']['callback']('No',_0x4ffd4d(0xfa))]);_0x403162['reply'](_0x4ffd4d(0x1a7),_0xa7d764);}}),tgBot[_0x3205a1(0x147)](/reinstall_(.+)/,async _0x380e80=>{const _0x5106d3=_0x3205a1,_0x3f0779=_0x380e80[_0x5106d3(0x11c)][0x1];_0x380e80[_0x5106d3(0x20d)](),_0x3f0779==_0x5106d3(0x23c)&&(await sendTelegram(_0x380e80[_0x5106d3(0x256)]['id'],_0x5106d3(0x255)),updateBB(_0x5106d3(0x1c9))),_0x3f0779=='no'&&await sendTelegram(_0x380e80[_0x5106d3(0x256)]['id'],_0x5106d3(0x14c));}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x259),async _0x226c6c=>{const _0x433b67=_0x3205a1,_0x415603=getBotsWithMode();if(_0x415603[_0x433b67(0x2c6)]==0x0)await sendTelegram(_0x226c6c['chat']['id'],_0x433b67(0x14e));else{let _0x208dd4=[],_0x3a5e09=[];const _0x20b814=0x2;let _0x40f7fb=0x0;_0x415603[_0x433b67(0x139)]((_0x2a85d3,_0x585432)=>{const _0x19c247=_0x433b67;if(_0x585432%_0x20b814==0x0)_0x3a5e09=[];_0x3a5e09[_0x19c247(0x292)](Markup[_0x19c247(0x226)]['callback'](_0x19c247(0x25e)+_0x2a85d3['botID']+'\x20('+_0x2a85d3[_0x19c247(0x140)]+')','toggle_'+_0x2a85d3[_0x19c247(0x2e3)])),_0x585432%_0x20b814==0x0&&(_0x208dd4[_0x40f7fb]=_0x3a5e09,_0x40f7fb++);});const _0xbd2fe9=Markup[_0x433b67(0x107)](_0x208dd4);_0x226c6c[_0x433b67(0x1c0)](_0x433b67(0x22b),_0xbd2fe9);}}),tgBot[_0x3205a1(0x147)](/toggle_(.+)/,async _0x50de15=>{const _0x41221b=_0x3205a1,_0x3feb41=_0x50de15[_0x41221b(0x11c)][0x1];_0x50de15[_0x41221b(0x20d)]();const _0x33edac=getBotsWithMode(),_0x1830fd=_0x33edac[_0x41221b(0x122)](_0x57310c=>_0x57310c[_0x41221b(0x2e3)]==_0x3feb41),_0x58042f=_0x1830fd[_0x41221b(0x140)]==_0x41221b(0x2ec)?_0x41221b(0x210):_0x41221b(0x2ec);await sendTelegram(_0x50de15['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3feb41+_0x41221b(0x284)+_0x58042f+_0x41221b(0x115)),toggleBotMode(_0x3feb41);}),tgBot[_0x3205a1(0x26f)](_0x3205a1(0x272),async _0x340e6c=>{const _0x2eb68b=_0x3205a1;let _0x1cc999='';config[_0x2eb68b(0x139)](_0x252b70=>{const _0x234192=_0x2eb68b;_0x1cc999+=_0x234192(0x25e)+_0x252b70['botID']+':\x20'+_0x252b70[_0x234192(0x2ea)]+'\x0a';}),await sendTelegram(_0x340e6c['chat']['id'],_0x1cc999,{'parse_mode':'HTML'});}),tgBot[_0x3205a1(0x26f)]('help',async _0x586e71=>{const _0x487633=_0x3205a1;await sendTelegram(_0x586e71[_0x487633(0x256)]['id'],_0x550173);}),process[_0x3205a1(0x1df)](_0x3205a1(0x1e5),()=>tgBot[_0x3205a1(0x193)](_0x3205a1(0x1e5))),process['once'](_0x3205a1(0x2ad),()=>tgBot[_0x3205a1(0x193)](_0x3205a1(0x2ad))),tgBot[_0x3205a1(0x1ff)]();}}function disableTelegram(){const _0x120192=_0x4d89ed;tgBot&&tgBot[_0x120192(0x193)]();}async function sendTelegram(_0x1f92da,_0x160a41,_0x41c69f){const _0x525bbd=_0x4d89ed;_0x41c69f={..._0x41c69f,'disable_web_page_preview':!![]};try{await tgBot[_0x525bbd(0x190)][_0x525bbd(0x229)](_0x1f92da,_0x160a41,_0x41c69f);}catch(_0x1b92de){console[_0x525bbd(0x14a)]('Telegram\x20error:',_0x1b92de);}}async function sendTelegramBot(_0x7e9c17,_0x175faa){const _0x156615=_0x4d89ed;if(settings[_0x156615(0x172)]){if(settings[_0x156615(0x1a0)]==_0x156615(0x167)||(_0x175faa[_0x156615(0x100)]==_0x156615(0x1f6)||_0x175faa[_0x156615(0x100)]==_0x156615(0x1db)||_0x175faa[_0x156615(0x100)]=='success')&&settings[_0x156615(0x1a0)]==_0x156615(0x222)||_0x175faa[_0x156615(0x100)]==_0x156615(0x1d0)&&settings[_0x156615(0x1a0)]==_0x156615(0x12c)){if(tgBot&&settings[_0x156615(0x105)]){if(_0x175faa[_0x156615(0x11d)])await sendTelegram(settings['telegramChatId'],_0x175faa[_0x156615(0x2ea)]+_0x156615(0x2c4)+_0x175faa[_0x156615(0x1ad)]);else await sendTelegram(settings['telegramChatId'],_0x156615(0x25e)+_0x7e9c17+'\x20>\x20'+_0x175faa[_0x156615(0x1ad)]);}}}}async function sendTelegramMsg(_0x3bbc77,_0x346460='HTML'){const _0x4ccbda=_0x4d89ed;return settings[_0x4ccbda(0x172)]&&tgBot&&settings[_0x4ccbda(0x105)]?(await sendTelegram(settings[_0x4ccbda(0x105)],_0x3bbc77,{'parse_mode':_0x346460}),!![]):![];}function getDeviceWithIp(_0x3472d6){const _0x193d7b=_0x4d89ed;return devices[_0x193d7b(0x122)](_0xc78053=>_0xc78053['ip']===_0x3472d6);}async function temporaryAccess2FA(_0x29a7d7,_0x3adf10){const _0x1bdd09=_0x4d89ed;let _0x16b2cd=new Date(),_0x1a6a48=![];if(lastIpApproval){if(_0x16b2cd-lastIpApproval<0x1388)_0x1a6a48=!![];}lastIpApproval=new Date();if(_0x1a6a48)return;if(tgBot&&settings[_0x1bdd09(0x105)]){const _0x2a167e=uuidRandom();tmpStorage[_0x2a167e]={'uuid':_0x29a7d7,'externalip':_0x3adf10};const _0x479454=Markup[_0x1bdd09(0x107)]([Markup[_0x1bdd09(0x226)]['callback']('5\x20min',_0x1bdd09(0x185)+_0x2a167e),Markup[_0x1bdd09(0x226)][_0x1bdd09(0x1e7)](_0x1bdd09(0x291),_0x1bdd09(0x151)+_0x2a167e),Markup['button'][_0x1bdd09(0x1e7)]('30\x20min','tempaccess_30_'+_0x2a167e),Markup['button'][_0x1bdd09(0x1e7)](_0x1bdd09(0x161),_0x1bdd09(0x228)+_0x2a167e)]);await sendTelegram(settings['telegramChatId'],_0x1bdd09(0x15b)+normalizeIP(_0x3adf10)[_0x1bdd09(0x290)]+'\x20?',_0x479454),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x33ea4d=>{const _0xb0c9dc=_0x1bdd09,_0x182162=_0x33ea4d[_0xb0c9dc(0x11c)][0x1],_0xb22d01=_0x33ea4d[_0xb0c9dc(0x11c)][0x2],{uuid:_0x4996bb,externalip:_0x328b5d}=tmpStorage[_0xb22d01];delete tmpStorage[_0xb22d01],_0x33ea4d['editMessageReplyMarkup'](),devices[_0x4996bb][_0xb0c9dc(0x17d)]={'clientip':_0x328b5d,'timestamp':new Date()['getTime'](),'expiry':_0x182162},_0x182162!=_0xb0c9dc(0x161)?(await sendTelegram(_0x33ea4d[_0xb0c9dc(0x256)]['id'],_0xb0c9dc(0x165)+_0x182162+_0xb0c9dc(0x2b4),{'parse_mode':_0xb0c9dc(0x1aa)}),io['to'](_0x4996bb)[_0xb0c9dc(0x269)](_0xb0c9dc(0x2c8),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x33ea4d[_0xb0c9dc(0x256)]['id'],_0xb0c9dc(0x14d)),io['to'](_0x4996bb)[_0xb0c9dc(0x269)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x3e5a26,_0x2fc160){const _0x39242=_0x4d89ed;if(tgBot&&settings[_0x39242(0x105)]){const _0x88361=uuidRandom();tmpStorage[_0x88361]={'uuid':_0x3e5a26,'externalip':_0x2fc160};const _0xc22f44=Markup[_0x39242(0x107)]([Markup[_0x39242(0x226)][_0x39242(0x1e7)](_0x39242(0x21a),'login2fa_'+loginExpiry+'_'+_0x88361),Markup[_0x39242(0x226)][_0x39242(0x1e7)](_0x39242(0x161),_0x39242(0x2cf)+_0x88361)]);await sendTelegram(settings[_0x39242(0x105)],_0x39242(0x166)+normalizeIP(_0x2fc160)[_0x39242(0x290)]+'\x20?',_0xc22f44),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x32c352=>{const _0x13d8f6=_0x39242,_0x42724b=_0x32c352[_0x13d8f6(0x11c)][0x1],_0x502164=_0x32c352[_0x13d8f6(0x11c)][0x2],{uuid:_0x2914a0,externalip:_0x26b2e9}=tmpStorage[_0x502164];delete tmpStorage[_0x502164],_0x32c352[_0x13d8f6(0x20d)](),devices[_0x2914a0][_0x13d8f6(0x162)]={'clientip':_0x26b2e9,'timestamp':new Date()['getTime'](),'expiry':_0x42724b},_0x42724b!=_0x13d8f6(0x161)?(await sendTelegram(_0x32c352[_0x13d8f6(0x256)]['id'],_0x13d8f6(0x2cd),{'parse_mode':_0x13d8f6(0x1aa)}),io['to'](_0x2914a0)[_0x13d8f6(0x269)](_0x13d8f6(0x2c8),{'access':{'allow':![],'reason':_0x13d8f6(0x1f3),'token':null}})):(await sendTelegram(_0x32c352['chat']['id'],_0x13d8f6(0x25d)),io['to'](_0x2914a0)['emit'](_0x13d8f6(0x2c8),{'access':{'allow':![],'reason':_0x13d8f6(0x2db),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x44ed1c=_0x4d89ed;return dbConfig[_0x44ed1c(0x124)]('bots')['sortBy']('botID')[_0x44ed1c(0x197)]({'status':_0x44ed1c(0x218)})['value']()||[];}function getDisabledBots(){const _0x291519=_0x4d89ed;return dbConfig['get']('bots')[_0x291519(0x2e7)](_0x291519(0x2e3))[_0x291519(0x197)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x58bfbd){const _0x581f97=_0x4d89ed;let _0x11c6f9={};const _0x2c0daa=configpath+'bot-'+_0x58bfbd+_0x581f97(0x2f7),_0x4aae8a=fs[_0x581f97(0x2ce)](_0x2c0daa);if(_0x4aae8a){const _0x2a6dc3=fs[_0x581f97(0x2bc)](_0x2c0daa);try{const _0x38336d=JSON['parse'](_0x2a6dc3),_0x410ee8=_0x38336d?_0x38336d[_0x581f97(0x112)][0x0][_0x581f97(0x11b)]:![];_0x11c6f9['mode']=_0x410ee8?_0x581f97(0x2ec):_0x581f97(0x210),_0x11c6f9[_0x581f97(0x2ea)]=_0x38336d?_0x38336d['bot'][0x0][_0x581f97(0x2ea)]:'Bot\x20'+_0x58bfbd;}catch(_0x39cf6d){_0x11c6f9[_0x581f97(0x140)]=_0x581f97(0x210),_0x11c6f9[_0x581f97(0x2ea)]=_0x581f97(0x25e)+_0x58bfbd;}}else _0x11c6f9['mode']='manual',_0x11c6f9[_0x581f97(0x2ea)]=_0x581f97(0x25e)+_0x58bfbd;return _0x11c6f9;}function getBotsWithMode(){const _0x1946b6=_0x4d89ed,_0x2a1200=dbConfig[_0x1946b6(0x124)](_0x1946b6(0x252))[_0x1946b6(0x2e7)]('botID')['value']()||[];return _0x2a1200[_0x1946b6(0x139)](_0x9c751e=>{const _0x505417=_0x1946b6;let _0x3aa9ab=getBotAttributes(_0x9c751e[_0x505417(0x2e3)]);_0x9c751e[_0x505417(0x140)]=_0x3aa9ab['mode'];}),_0x2a1200;}function getBotExchanges(){const _0x565ac0=_0x4d89ed;let _0x3af8d6=[];const _0x5dacc5=dbConfig['get'](_0x565ac0(0x252))['sortBy']('botID')['value']()||[];_0x5dacc5[_0x565ac0(0x139)](_0x44ccd6=>{const _0x5a7ec2=_0x565ac0;if(_0x44ccd6['status']=='enabled'){const _0x14980b=configpath+_0x5a7ec2(0x1ea)+_0x44ccd6[_0x5a7ec2(0x2e3)]+_0x5a7ec2(0x2f7),_0x233e30=fs['existsSync'](_0x14980b);let _0x18781d;if(_0x233e30){const _0x4f309b=fs[_0x5a7ec2(0x2bc)](_0x14980b);try{const _0x92f569=JSON[_0x5a7ec2(0x152)](_0x4f309b);_0x18781d=_0x92f569?_0x92f569[_0x5a7ec2(0x112)][0x0][_0x5a7ec2(0x21d)]:null;}catch(_0x3da5ec){}}if(_0x18781d)_0x3af8d6[_0x5a7ec2(0x292)](_0x18781d);}});const _0x45c34f=[...new Set(_0x3af8d6)][_0x565ac0(0x126)]();return _0x45c34f;}async function initUser(){const _0x40c147=_0x4d89ed;if(!settings[_0x40c147(0x1f5)]){const _0x1406be=uuidRandom();mixpanel['alias'](_0x1406be),updateSetting(_0x40c147(0x1f5),_0x1406be);}}async function initSecure(){const _0x21743f=_0x4d89ed;let _0x475455=getSecure();if(!_0x475455[_0x21743f(0x129)](_0x21743f(0x137))){let _0x950baa=await generateKeys();_0x475455[_0x21743f(0x2dd)]=_0x950baa[_0x21743f(0x2dd)],_0x475455[_0x21743f(0x2a5)]=_0x950baa['privateKey'],_0x475455['secret']=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x475455);}}function getSettings(){const _0x12d4a0=_0x4d89ed;return dbSettings[_0x12d4a0(0x124)](_0x12d4a0(0x11f))[_0x12d4a0(0x1d2)]()||{};}function getSecure(){const _0x25f17c=_0x4d89ed;return dbSecure[_0x25f17c(0x124)]('secure')[_0x25f17c(0x1d2)]()||{};}function getBlacklist(){const _0x770fad=_0x4d89ed;return dbSecure[_0x770fad(0x124)](_0x770fad(0x1ab))[_0x770fad(0x1d2)]()||[];}function broadcastToBots(_0x28bd69,_0x3a6309){const _0x18f351=_0x4d89ed;config[_0x18f351(0x139)](_0x2cc387=>{const _0x3101d8=_0x18f351;if(_0x2cc387[_0x3101d8(0x2c8)]=='enabled'&&_0x2cc387[_0x3101d8(0x299)]=='running'||_0x2cc387[_0x3101d8(0x2c8)]==_0x3101d8(0x26e)&&_0x2cc387[_0x3101d8(0x299)]==_0x3101d8(0x208)){if(pid[_0x2cc387[_0x3101d8(0x2e3)]])pid[_0x2cc387[_0x3101d8(0x2e3)]][_0x3101d8(0x25b)]({[_0x28bd69]:_0x3a6309});}});}async function storeSettings(_0x301e7b,_0xb7f605=![]){const _0x28931c=_0x4d89ed;_0x301e7b={...settings,..._0x301e7b};if(_0xb7f605&&_0x301e7b[_0x28931c(0x16d)]!=_0x28931c(0x2b8)&&_0x301e7b[_0x28931c(0x16d)]!=_0x28931c(0x16b)&&_0x301e7b[_0x28931c(0x16d)]!=''){const _0x1328a6=crypt[_0x28931c(0x28a)](secure[_0x28931c(0x2a5)],_0x301e7b[_0x28931c(0x16d)])[_0x28931c(0x14b)][_0x28931c(0x298)](_0x28931c(0x17a))[0x0],_0x57c740=bcrypt[_0x28931c(0x146)](_0x1328a6,saltRounds);_0x301e7b={..._0x301e7b,'bbPassword':_0x57c740};}if(_0xb7f605&&_0x301e7b[_0x28931c(0x1a4)]!='************'&&_0x301e7b[_0x28931c(0x1a4)]!=_0x28931c(0x16b)&&_0x301e7b[_0x28931c(0x1a4)]!=''){const _0x11ba18=crypt[_0x28931c(0x28a)](secure[_0x28931c(0x2a5)],_0x301e7b[_0x28931c(0x1a4)])[_0x28931c(0x14b)][_0x28931c(0x298)]('|@|')[0x0];_0x301e7b={..._0x301e7b,'telegramToken':_0x11ba18};}if(_0xb7f605&&_0x301e7b[_0x28931c(0x29c)]!=_0x28931c(0x2b8)&&_0x301e7b[_0x28931c(0x29c)]!=_0x28931c(0x16b)&&_0x301e7b[_0x28931c(0x29c)]!=''){const _0xc049cc=crypt['decrypt'](secure['privateKey'],_0x301e7b[_0x28931c(0x29c)])['message'][_0x28931c(0x298)](_0x28931c(0x17a))[0x0];_0x301e7b={..._0x301e7b,'marketcapApi':_0xc049cc};}const _0xb32ff7=_0x301e7b[_0x28931c(0x1a4)]!=_0x28931c(0x2b8)&&_0x301e7b[_0x28931c(0x1a4)]!=settings[_0x28931c(0x1a4)]||_0x301e7b[_0x28931c(0x219)]!=settings[_0x28931c(0x219)],_0x36423c=_0x301e7b[_0x28931c(0x1a4)]==''||_0x301e7b[_0x28931c(0x219)]=='',_0x3a2301=_0x301e7b[_0x28931c(0x29c)]&&_0x301e7b['marketcapApi']!=_0x28931c(0x2b8)&&_0x301e7b['marketcapApi']!=settings[_0x28931c(0x1a4)];_0xb32ff7&&(_0x301e7b[_0x28931c(0x105)]=null,_0x301e7b[_0x28931c(0x1a0)]=_0x28931c(0x167));for(const [_0x324b07,_0x2802c9]of Object[_0x28931c(0x2a9)](_0x301e7b)){if(_0x324b07==_0x28931c(0x1a4)&&_0x2802c9==_0x28931c(0x2b8)){_0x301e7b[_0x28931c(0x1a4)]=settings['telegramToken'];continue;};if(_0x324b07==_0x28931c(0x16d)&&_0x2802c9==_0x28931c(0x2b8)){_0x301e7b[_0x28931c(0x16d)]=settings[_0x28931c(0x16d)];continue;};if(_0x324b07=='marketcapApi'&&_0x2802c9==_0x28931c(0x2b8)){_0x301e7b['marketcapApi']=settings[_0x28931c(0x29c)];continue;};dbSettings[_0x28931c(0x21c)](_0x28931c(0x22a)+_0x324b07,_0x2802c9)[_0x28931c(0x11a)]();}settings=_0x301e7b,io['to'](_0x28931c(0x1c7))[_0x28931c(0x269)](_0x28931c(0x11f),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots('onepagemode',settings[_0x28931c(0xfb)]),broadcastToBots('marketcapApi',settings[_0x28931c(0x29c)]);if(_0xb32ff7&&!_0x36423c)initTelegram();if(_0xb32ff7&&_0x36423c)disableTelegram();getAllClients()[_0x28931c(0x139)](_0x3661ec=>{const _0x2381a2=_0x28931c;getSocket(_0x3661ec['id'])[_0x2381a2(0x269)](_0x2381a2(0x2c8),{'access':{'allow':![],'reason':_0x2381a2(0x1f3),'token':null}});}),_0x3a2301&&(await sleep(0xbb8),testMarketcapApi(_0x301e7b[_0x28931c(0x29c)]));}async function testMarketcapApi(_0x4191bb){const _0x322448=_0x4d89ed,_0x174108=[_0x322448(0x179),_0x322448(0x192)];try{await axios[_0x322448(0x124)](_0x322448(0xf8),{'headers':{'X-CMC_PRO_API_KEY':_0x4191bb},'params':{'symbol':_0x174108[_0x322448(0x274)]()}});}catch(_0x5b30f2){_0x5b30f2[_0x322448(0x274)]()[_0x322448(0x214)](_0x322448(0x18c))?(io['to'](_0x322448(0x1c7))['emit'](_0x322448(0x29d),_0x322448(0x196)),logger[_0x322448(0x221)](_0x322448(0x196))):(io['to'](_0x322448(0x1c7))[_0x322448(0x269)](_0x322448(0x29d),_0x322448(0x1b1)),logger[_0x322448(0x221)](_0x322448(0x1b1)),logger[_0x322448(0x1da)](_0x322448(0xf7),_0x5b30f2['toString']()+'\x20-\x20'+_0x5b30f2['code']));return;}logger[_0x322448(0x1da)](_0x322448(0x1ba));}function updateSetting(_0x27f9fb,_0x6984cd){const _0x246e7d=_0x4d89ed;dbSettings[_0x246e7d(0x21c)](_0x246e7d(0x22a)+_0x27f9fb,_0x6984cd)[_0x246e7d(0x11a)](),settings=getSettings(),io['to']('botmanager')[_0x246e7d(0x269)](_0x246e7d(0x11f),cleanSettings());}function storeSecure(_0x3f7213){const _0x21c6c5=_0x4d89ed;dbSecure[_0x21c6c5(0x124)]('secure')[_0x21c6c5(0x292)](_0x3f7213)[_0x21c6c5(0x11a)](),secure=_0x3f7213;}function addBlacklist(_0xa034bb){const _0x1b28f5=_0x4d89ed;cleanBlacklist();let _0xf18f11;devices[_0xa034bb]['telegramIpApproval']?_0xf18f11=Math[_0x1b28f5(0x282)](devices[_0xa034bb][_0x1b28f5(0x17d)][_0x1b28f5(0x251)],loginExpiry):_0xf18f11=loginExpiry,dbSecure['get'](_0x1b28f5(0x1ab))['push']({'expiry':new Date()[_0x1b28f5(0x289)]()+_0xf18f11*0x3c*0x3e8,'token':devices[_0xa034bb][_0x1b28f5(0x18d)][_0x1b28f5(0x1ce)]})[_0x1b28f5(0x11a)](),blacklist=dbSecure[_0x1b28f5(0x124)](_0x1b28f5(0x1ab))[_0x1b28f5(0x1d2)]();}function cleanBlacklist(){const _0x25e4b4=_0x4d89ed;let _0x4e69cf=dbSecure[_0x25e4b4(0x124)](_0x25e4b4(0x1ab))[_0x25e4b4(0x273)]()[_0x25e4b4(0x1d2)](),_0x1989f7=new Date()[_0x25e4b4(0x289)]();_0x4e69cf['forEach'](_0x5af6e2=>{const _0x31f4fa=_0x25e4b4;_0x5af6e2[_0x31f4fa(0x251)]<_0x1989f7&&dbSecure[_0x31f4fa(0x124)](_0x31f4fa(0x1ab))[_0x31f4fa(0xf5)]({'expiry':_0x5af6e2[_0x31f4fa(0x251)]})[_0x31f4fa(0x11a)]();});}function initStates(){const _0x1307c7=_0x4d89ed;let _0x2b8159=getConfiguration();_0x2b8159[_0x1307c7(0x139)](_0x1598b8=>{const _0x1e6f7e=_0x1307c7;_0x1598b8[_0x1e6f7e(0x299)]=_0x1e6f7e(0x2a3);}),storeConfiguration(_0x2b8159);}function onKeys(){const _0x312f48=new RSA();return new Promise(_0x211fdf=>{const _0x543158=_0x2b05;_0x312f48[_0x543158(0x1a2)]()[_0x543158(0x10d)](_0xf74859=>{_0x211fdf(_0xf74859);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2b0282=_0x4d89ed;let _0x4f2bd2=getSettings(),_0x358549=![];!_0x4f2bd2['hasOwnProperty'](_0x2b0282(0x287))&&(_0x4f2bd2[_0x2b0282(0x287)]=0x0,_0x358549=!![]);!_0x4f2bd2['hasOwnProperty']('lastmsgemitted')&&(_0x4f2bd2[_0x2b0282(0x2a6)]=0x0,_0x358549=!![]);!_0x4f2bd2['hasOwnProperty'](_0x2b0282(0x125))&&(_0x4f2bd2[_0x2b0282(0x125)]=_0x2b0282(0x16f),_0x358549=!![]);!_0x4f2bd2[_0x2b0282(0x129)]('onepagemode')&&(_0x4f2bd2[_0x2b0282(0xfb)]=![],_0x358549=!![]);!_0x4f2bd2[_0x2b0282(0x129)](_0x2b0282(0x29c))&&(_0x4f2bd2[_0x2b0282(0x29c)]='',_0x358549=!![]);if(_0x358549)storeSettings(_0x4f2bd2);try{fs[_0x2b0282(0x14f)](configbackuppath,{'withFileTypes':!![]})[_0x2b0282(0x139)](_0x2057eb=>{const _0xc49a59=_0x2b0282;if(!_0x2057eb[_0xc49a59(0x113)]()){if(!_0x2057eb['name'][_0xc49a59(0x1bf)](_0xc49a59(0x245)))fs[_0xc49a59(0x2e8)](configbackuppath+_0x2057eb[_0xc49a59(0x1a3)]);}else fs[_0xc49a59(0x10a)](configbackuppath+_0x2057eb[_0xc49a59(0x1a3)],{'recursive':!![]});});}catch(_0x42ead3){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x42ead3);}}function storeConfiguration(_0x3aec9d){const _0x3c87c5=_0x4d89ed;dbConfig[_0x3c87c5(0x124)]('bots')[_0x3c87c5(0xf5)]()[_0x3c87c5(0x11a)](),dbConfig[_0x3c87c5(0x124)](_0x3c87c5(0x252))[_0x3c87c5(0x292)](..._0x3aec9d)['write'](),config=_0x3aec9d;}async function resetPassword(){const _0xebb9c0=_0x4d89ed;if(tgBot&&settings['telegramChatId']){const _0x1f9c03=Markup[_0xebb9c0(0x107)]([Markup[_0xebb9c0(0x226)][_0xebb9c0(0x1e7)](_0xebb9c0(0x23c),_0xebb9c0(0x110)),Markup[_0xebb9c0(0x226)][_0xebb9c0(0x1e7)]('no','resetpw_no')]);await sendTelegram(settings[_0xebb9c0(0x105)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x1f9c03),tgBot[_0xebb9c0(0x147)](/resetpw_(.+)/,async _0x562df0=>{const _0xaf6fb6=_0xebb9c0,_0x309a28=_0x562df0[_0xaf6fb6(0x11c)][0x1];_0x562df0[_0xaf6fb6(0x20d)]();if(_0x309a28!='no'){const _0x340a06=0xf,_0x44ae99=_0xaf6fb6(0x187),_0x105ae0=Array['from'](crypto[_0xaf6fb6(0x1ed)](new Uint32Array(_0x340a06)))[_0xaf6fb6(0x2b1)](_0x5659e7=>_0x44ae99[_0x5659e7%_0x44ae99[_0xaf6fb6(0x2c6)]])[_0xaf6fb6(0x27a)](''),_0x11913f=bcrypt[_0xaf6fb6(0x146)](_0x105ae0,saltRounds);storeSettings({'bbPassword':_0x11913f}),await sendTelegram(_0x562df0[_0xaf6fb6(0x256)]['id'],_0xaf6fb6(0x231)+_0x105ae0,{'parse_mode':'HTML'});}else await sendTelegram(_0x562df0[_0xaf6fb6(0x256)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x34ce16,_0x28af58){const _0x14474d=_0x4d89ed;io['to']('botmanager')['emit']('notification',_0x14474d(0x13b),_0x14474d(0x12b));if(tgBot&&settings[_0x14474d(0x105)]){const _0x17f8a5=uuidRandom();tmpStorage[_0x17f8a5]={'path':_0x34ce16,'filename':_0x28af58};const _0x481ac6=Markup['inlineKeyboard']([Markup[_0x14474d(0x226)][_0x14474d(0x1e7)]('yes','restore_yes_'+_0x17f8a5),Markup[_0x14474d(0x226)][_0x14474d(0x1e7)]('no',_0x14474d(0x1e9)+_0x17f8a5)]);await sendTelegram(settings[_0x14474d(0x105)],_0x14474d(0x15e),_0x481ac6),tgBot[_0x14474d(0x147)](/restore_(.+)_(.+)/,async _0x2c9c3d=>{const _0x3f4321=_0x14474d,_0x27731f=_0x2c9c3d[_0x3f4321(0x11c)][0x1],_0x2c68f7=_0x2c9c3d[_0x3f4321(0x11c)][0x2],{path:_0x5d9e5b,filename:_0x113081}=tmpStorage[_0x2c68f7];delete tmpStorage[_0x2c68f7],_0x2c9c3d[_0x3f4321(0x20d)](),_0x27731f==_0x3f4321(0x23c)?(logger[_0x3f4321(0x1da)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x2c9c3d[_0x3f4321(0x256)]['id'],_0x3f4321(0x2d0),{'parse_mode':'HTML'}),unzipFile(_0x5d9e5b,_0x113081)):(logger[_0x3f4321(0x1da)](_0x3f4321(0x2f0)),await sendTelegram(_0x2c9c3d[_0x3f4321(0x256)]['id'],_0x3f4321(0x2f0)));});}}function getServerTime(){const _0x2cdd00=_0x4d89ed,_0x5e4b66=new Date();return _0x5e4b66[_0x2cdd00(0x1e8)]()+'/'+(_0x5e4b66[_0x2cdd00(0x24c)]()+0x1)[_0x2cdd00(0x274)]()['padStart'](0x2,'0')+'/'+_0x5e4b66[_0x2cdd00(0x1a8)]()[_0x2cdd00(0x274)]()[_0x2cdd00(0x2f3)](0x2,'0')+'\x20'+_0x5e4b66[_0x2cdd00(0x2ee)]()[_0x2cdd00(0x274)]()['padStart'](0x2,'0')+':'+_0x5e4b66[_0x2cdd00(0x1e2)]()['toString']()[_0x2cdd00(0x2f3)](0x2,'0')+':'+_0x5e4b66[_0x2cdd00(0x1d8)]()[_0x2cdd00(0x274)]()[_0x2cdd00(0x2f3)](0x2,'0');}function getTimeStamp(){const _0x45d704=_0x4d89ed,_0x1150b6=shiftedTime();return _0x1150b6['getFullYear']()+'/'+(_0x1150b6[_0x45d704(0x24c)]()+0x1)[_0x45d704(0x274)]()['padStart'](0x2,'0')+'/'+_0x1150b6[_0x45d704(0x1a8)]()['toString']()[_0x45d704(0x2f3)](0x2,'0')+'\x20'+_0x1150b6[_0x45d704(0x2ee)]()['toString']()['padStart'](0x2,'0')+':'+_0x1150b6[_0x45d704(0x1e2)]()[_0x45d704(0x274)]()[_0x45d704(0x2f3)](0x2,'0')+':'+_0x1150b6['getSeconds']()['toString']()[_0x45d704(0x2f3)](0x2,'0');}function getCleanTimeStamp(){const _0x49a79f=_0x4d89ed,_0x41acc4=shiftedTime();return _0x41acc4[_0x49a79f(0x1e8)]()+(_0x41acc4[_0x49a79f(0x24c)]()+0x1)[_0x49a79f(0x274)]()['padStart'](0x2,'0')+_0x41acc4[_0x49a79f(0x1a8)]()[_0x49a79f(0x274)]()['padStart'](0x2,'0')+'-'+_0x41acc4['getHours']()['toString']()[_0x49a79f(0x2f3)](0x2,'0')+_0x41acc4[_0x49a79f(0x1e2)]()[_0x49a79f(0x274)]()[_0x49a79f(0x2f3)](0x2,'0')+_0x41acc4[_0x49a79f(0x1d8)]()[_0x49a79f(0x274)]()[_0x49a79f(0x2f3)](0x2,'0');}function shiftedTime(){const _0x138f89=_0x4d89ed,_0x10859a=new Date();let _0x5cddd5=_0x10859a;if(settings[_0x138f89(0x26d)]&&settings[_0x138f89(0x26d)]!==0x0)_0x5cddd5=fns[_0x138f89(0x20a)](_0x10859a,{'hours':settings['timeshift']});return _0x5cddd5;}async function startScheduler(){const _0xa228f4=_0x4d89ed,_0x2d014e=new Date()[_0xa228f4(0x1b0)](),_0x174a15=shiftedTime()[_0xa228f4(0x2ee)]();_0x174a15==0x4&&backupConfigFiles(),_0x174a15==0x0&&rotateLogFiles(),_0x2d014e%0x6==0x0&&triggerAnalytics(),_0x2d014e%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x1d04e9){const _0x3035f1=_0x4d89ed;logger[_0x3035f1(0x1da)](_0x3035f1(0x16c)+_0x1d04e9);const _0x5224ce=getBotsWithMode();_0x5224ce[_0x3035f1(0x2c6)]>0x0?confirmRestore(configbackuppath,_0x1d04e9):unzipFile(configbackuppath,_0x1d04e9);}async function getBackupFiles(_0x267209=null){const _0x49b895=_0x4d89ed;let _0xa97207=[],_0x42bd7e=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x42bd7e[_0x49b895(0x126)]((_0x1076e8,_0x39fa1e)=>_0x1076e8[_0x49b895(0x1a3)]<_0x39fa1e['name']?0x1:_0x39fa1e[_0x49b895(0x1a3)]<_0x1076e8[_0x49b895(0x1a3)]?-0x1:0x0),_0x42bd7e[_0x49b895(0x139)](_0x1a9e15=>{const _0x2d83a6=_0x49b895;if(!_0x1a9e15[_0x2d83a6(0x113)]()&&_0x1a9e15[_0x2d83a6(0x1a3)]['startsWith'](_0x2d83a6(0x245))&&_0x1a9e15[_0x2d83a6(0x1a3)][_0x2d83a6(0x2e2)](_0x2d83a6(0x2ed))){const _0x214124=formatDate(fs[_0x2d83a6(0x1dd)](configbackuppath+_0x1a9e15[_0x2d83a6(0x1a3)])[_0x2d83a6(0x177)]);_0xa97207[_0x2d83a6(0x292)]({'name':_0x1a9e15[_0x2d83a6(0x1a3)],'mtime':_0x214124});}});if(_0x267209)io['to'](_0x267209)[_0x49b895(0x269)](_0x49b895(0x1c6),_0xa97207);else return _0xa97207;}async function backupConfigFiles(){const _0x25acac=_0x4d89ed;await zipFiles(_0x25acac(0x227));const _0x31c01c=getCleanTimeStamp();fs[_0x25acac(0x1d7)](zippath+_0x25acac(0x288),configbackuppath+(_0x25acac(0x245)+_0x31c01c+_0x25acac(0x2ed)));let _0x5f22de=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x5f22de['sort']((_0x530e79,_0x572787)=>_0x530e79[_0x25acac(0x1a3)]<_0x572787[_0x25acac(0x1a3)]?0x1:_0x572787[_0x25acac(0x1a3)]<_0x530e79[_0x25acac(0x1a3)]?-0x1:0x0),_0x5f22de[_0x25acac(0x2c6)]>maxBackups&&fs[_0x25acac(0x2e8)](configbackuppath+_0x5f22de[_0x5f22de[_0x25acac(0x2c6)]-0x1][_0x25acac(0x1a3)]);}function rotateLogFiles(){const _0x415b5b=_0x4d89ed,_0x37383b=fs[_0x415b5b(0x1dd)](logspath+_0x415b5b(0x2b0)),_0x2ca789=_0x37383b[_0x415b5b(0x21b)]/0x400;if(_0x2ca789>0x64){let _0x7b7c11=fs[_0x415b5b(0x14f)](logspath,{'withFileTypes':!![]});_0x7b7c11[_0x415b5b(0x126)]((_0x30bf89,_0x349988)=>_0x30bf89[_0x415b5b(0x1a3)]<_0x349988['name']?0x1:_0x349988[_0x415b5b(0x1a3)]<_0x30bf89[_0x415b5b(0x1a3)]?-0x1:0x0),_0x7b7c11['forEach'](_0x3a8ad0=>{const _0x27ced4=_0x415b5b;if(_0x3a8ad0['name']==_0x27ced4(0x174))fs['copyFileSync'](logspath+_0x3a8ad0['name'],logspath+_0x27ced4(0x2bf));if(_0x3a8ad0[_0x27ced4(0x1a3)]==_0x27ced4(0x25f))fs['copyFileSync'](logspath+_0x3a8ad0[_0x27ced4(0x1a3)],logspath+'output-002.log');_0x3a8ad0[_0x27ced4(0x1a3)]==_0x27ced4(0x2b0)&&(fs[_0x27ced4(0x1d7)](logspath+_0x3a8ad0[_0x27ced4(0x1a3)],logspath+_0x27ced4(0x25f)),fs['writeFileSync'](logspath+_0x3a8ad0[_0x27ced4(0x1a3)],''));});}}async function zipFiles(_0x3a1c28){const _0x3b4115=_0x4d89ed;let _0x1df667;if(_0x3a1c28=='logs')_0x1df667=logspath;if(_0x3a1c28==_0x3b4115(0x23d))_0x1df667=configpath;if(_0x3a1c28==_0x3b4115(0x227))_0x1df667=configpath;let _0xf8de98=fs[_0x3b4115(0x14f)](_0x1df667,{'withFileTypes':!![]});const _0x132ad3=new require(_0x3b4115(0x262))();_0xf8de98['forEach'](_0x1f065a=>{const _0xb43389=_0x3b4115;if(!_0x1f065a[_0xb43389(0x113)]()){let _0x2cc7e2=fs[_0xb43389(0x2bc)](_0x1df667+_0x1f065a[_0xb43389(0x1a3)]);if(_0x3a1c28==_0xb43389(0x23d)){const _0x10bbf6=/^bot-[0-9]{3}-config.json$/,_0x148b73=_0x10bbf6[_0xb43389(0x1b2)](_0x1f065a[_0xb43389(0x1a3)]);if(_0x148b73){const _0x365923=JSON[_0xb43389(0x152)](_0x2cc7e2);if(_0x365923[_0xb43389(0x112)][0x0]){_0x365923['bot'][0x0]['apiKey']=_0xb43389(0x16b),_0x365923[_0xb43389(0x112)][0x0]['apiSecret']=_0xb43389(0x16b);if(_0x365923[_0xb43389(0x112)][0x0][_0xb43389(0x169)])_0x365923['bot'][0x0][_0xb43389(0x169)]='***';}_0x2cc7e2=JSON[_0xb43389(0xfc)](_0x365923,null,0x2);}if(_0x1f065a[_0xb43389(0x1a3)]==_0xb43389(0x168)){const _0x57665b=JSON['parse'](_0x2cc7e2);if(_0x57665b[_0xb43389(0x11f)][_0xb43389(0x247)])_0x57665b[_0xb43389(0x11f)][_0xb43389(0x247)]=![];if(_0x57665b[_0xb43389(0x11f)]['bbPassword'])_0x57665b[_0xb43389(0x11f)][_0xb43389(0x16d)]=_0xb43389(0x16b);if(_0x57665b[_0xb43389(0x11f)][_0xb43389(0x1a4)])_0x57665b['settings']['telegramToken']=_0xb43389(0x16b);if(_0x57665b[_0xb43389(0x11f)][_0xb43389(0x105)])_0x57665b[_0xb43389(0x11f)]['telegramChatId']=null;if(_0x57665b[_0xb43389(0x11f)]['marketcapApi'])_0x57665b[_0xb43389(0x11f)][_0xb43389(0x29c)]='***';_0x2cc7e2=JSON[_0xb43389(0xfc)](_0x57665b,null,0x2);}if(_0x1f065a['name']!=_0xb43389(0x2af))_0x132ad3[_0xb43389(0x258)](_0x1f065a[_0xb43389(0x1a3)],_0x2cc7e2);}else _0x132ad3[_0xb43389(0x258)](_0x1f065a['name'],_0x2cc7e2);}});const _0x2ade9e=_0x132ad3['generate']({'base64':![],'compression':_0x3b4115(0x132)});fs[_0x3b4115(0x2b3)](zippath+(_0x3a1c28+_0x3b4115(0x2ed)),_0x2ade9e,_0x3b4115(0x2d3));}async function unzipFile(_0x3c38d9,_0x2a23ef){const _0x269cdf=_0x4d89ed;fs[_0x269cdf(0x14f)](configpath,{'withFileTypes':!![]})[_0x269cdf(0x139)](_0x5c6992=>{const _0x228045=_0x269cdf;if(!_0x5c6992[_0x228045(0x113)]())fs['rmSync'](configpath+_0x5c6992[_0x228045(0x1a3)]);});const _0x1b0208=fs[_0x269cdf(0x2bc)](_0x3c38d9+_0x2a23ef,_0x269cdf(0x2d3)),_0x553ca0=new require(_0x269cdf(0x262))(_0x1b0208,{'base64':![],'checkCRC32':!![]});Object[_0x269cdf(0x1c5)](_0x553ca0[_0x269cdf(0x26b)])[_0x269cdf(0x139)](_0x30b76a=>{const _0x5b2095=_0x269cdf,_0x2fb723=_0x553ca0[_0x5b2095(0x26b)][_0x30b76a];fs['writeFileSync'](configpath+_0x2fb723[_0x5b2095(0x1a3)],_0x2fb723[_0x5b2095(0x1a9)]);}),fs[_0x269cdf(0x14f)](temppath,{'withFileTypes':!![]})['forEach'](_0x43a0e4=>{const _0x1c5500=_0x269cdf;if(!_0x43a0e4[_0x1c5500(0x113)]())fs[_0x1c5500(0x10a)](temppath+_0x43a0e4[_0x1c5500(0x1a3)]);}),logger[_0x269cdf(0x1da)](_0x269cdf(0x18f)),process[_0x269cdf(0x25b)]({'restore':!![]},_0x57a135=>{});}async function getPublicIp(){const _0x264f38=_0x4d89ed;try{const _0x1b7980=await axios[_0x264f38(0x124)](_0x264f38(0x205));publicip=_0x1b7980[_0x264f38(0x25a)]['ip'];}catch(_0x421a5){}}async function triggerAnalytics(){const _0x298ecd=_0x4d89ed;if(!publicip)await getPublicIp();const _0x46152b=getBotsWithMode();let _0x419ab2=0x0;_0x46152b[_0x298ecd(0x139)](_0x34f389=>{const _0x52af65=_0x298ecd;if(_0x34f389[_0x52af65(0x2c8)]==='enabled')_0x419ab2++;});const _0xbf4c35=getBotExchanges();mixpanel[_0x298ecd(0x160)]('Server',{'distinct_id':settings[_0x298ecd(0x1f5)],'ip':publicip,'version':serverversion,'numbots':_0x46152b[_0x298ecd(0x2c6)],'numbotsenabled':_0x419ab2,'exchanges':_0xbf4c35,'environment':environment});}async function getMessages(){const _0x1de061=_0x4d89ed,_0x2444d6=_0x1de061(0x2cc),_0x1e8531=new GraphQLClient(_0x2444d6),_0x4f87c7={'authorization':_0x1de061(0x1cc)},_0x367994=serverversion[_0x1de061(0x298)]('.'),_0x43e3c4=_0x367994[0x0]+'.'+_0x367994[0x1],_0x472f76=Math[_0x1de061(0x1d5)](settings[_0x1de061(0x287)],settings['lastmsgemitted']),_0x569c3f={'last':parseInt(_0x472f76),'bbm':_0x43e3c4},_0x694549=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1a0951;try{_0x1a0951=await _0x1e8531[_0x1de061(0x1d9)](_0x694549,_0x569c3f,_0x4f87c7);}catch(_0x4ce26a){}if(_0x1a0951&&_0x1a0951[_0x1de061(0x286)]){let _0x2e257d=settings[_0x1de061(0x287)];newMessages=[];for(const _0x58d0cc of _0x1a0951[_0x1de061(0x286)]){newMessages[_0x1de061(0x292)](_0x58d0cc);let _0x4f9d68=![];_0x58d0cc['bbvNew']&&(updateSetting('latestversion',_0x58d0cc[_0x1de061(0x2d9)]),_0x4f9d68=isNewerVersion(serverversion,_0x58d0cc[_0x1de061(0x2d9)])||serverversion==_0x58d0cc['bbvNew']);if(!_0x4f9d68&&_0x58d0cc[_0x1de061(0x157)]>_0x2e257d){if(_0x58d0cc['bbvReceive']==='any'||serverversion['startsWith'](_0x58d0cc['bbvReceive'])){let _0x538e92=''+_0x58d0cc[_0x1de061(0x1bd)]+'\x0a\x0a'+_0x58d0cc[_0x1de061(0x14b)];const _0x21eda5=await sendTelegramMsg(toTelegramMarkdown(_0x538e92),_0x1de061(0x1dc));if(_0x21eda5)_0x2e257d=_0x58d0cc[_0x1de061(0x157)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x1de061(0x287),_0x2e257d),emitMessages();}}function emitMessages(){const _0x20c377=_0x4d89ed,_0x1e8574=settings[_0x20c377(0x2a6)];let _0x3a77e8=[];newMessages['forEach'](_0x3bac5d=>{const _0x4ec1e9=_0x20c377;_0x3bac5d[_0x4ec1e9(0x157)]>_0x1e8574&&_0x3a77e8[_0x4ec1e9(0x292)](_0x3bac5d);}),_0x3a77e8[_0x20c377(0x2c6)]>0x0&&getAllClients()[_0x20c377(0x139)](_0x574e44=>{const _0x37e12a=_0x20c377;getSocket(_0x574e44['id'])[_0x37e12a(0x269)]('message',_0x3a77e8);});}function confirmMessage(_0xb18d05){const _0x28ed23=_0x4d89ed;updateSetting(_0x28ed23(0x2a6),Number(_0xb18d05));}function isNewerVersion(_0x238214,_0x5e9d84){const _0x279c0e=_0x4d89ed,_0x86ba88=_0x5e9d84['split']('.'),_0x477452=_0x238214['split']('.');for(var _0x3da207=0x0;_0x3da207<_0x477452[_0x279c0e(0x2c6)];_0x3da207++){const _0x17230d=~~_0x477452[_0x3da207],_0x3f58ea=~~_0x86ba88[_0x3da207];if(_0x17230d>_0x3f58ea)return!![];if(_0x17230d<_0x3f58ea)return![];}return![];}function toTelegramMarkdown(_0x3d2953){const _0x269482=_0x4d89ed,_0x2550fe=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2a121f=/\*{2}(.+?)\*{2}/gim;return _0x3d2953=_0x3d2953[_0x269482(0x1d3)](_0x2550fe,_0x269482(0x24b))[_0x269482(0x1d3)](_0x2a121f,'*$1*'),_0x3d2953;}async function validateConfigFile(){const _0x456281=_0x4d89ed,_0x5afebf=dbConfig[_0x456281(0x124)]('bots')['sortBy']('botID')[_0x456281(0x1d2)]()||[];if(_0x5afebf[_0x456281(0x2c6)]==0x0){let _0x2510fb=0x0,_0x483786=[];const _0x2f4a72=/^bot-([0-9]{3})-config.json$/,_0x5a0df7=fs[_0x456281(0x14f)](configpath);_0x5a0df7[_0x456281(0x139)](_0x275c3b=>{const _0x499a30=_0x456281,_0x45409e=_0x2f4a72[_0x499a30(0x198)](_0x275c3b);if(_0x45409e){const _0x221a4c=_0x45409e[0x1];let _0x464bcb=getBotAttributes(_0x221a4c);_0x483786[_0x499a30(0x292)]({'botID':_0x221a4c,'botname':_0x464bcb[_0x499a30(0x2ea)],'status':_0x499a30(0x257),'live':_0x499a30(0x2a3)}),_0x2510fb++;}}),_0x2510fb!=0x0&&(dbConfig[_0x456281(0x124)](_0x456281(0x252))[_0x456281(0x2e4)](_0x483786)[_0x456281(0x11a)](),config=_0x483786,restoredConfigFile=_0x2510fb);}}async function restoreConfigNotify(_0xbac96e){const _0x116265=_0x4d89ed;let _0xb1a62b;if(restoredConfigFile==0x1)_0xb1a62b=_0x116265(0x1e4);else _0xb1a62b=_0x116265(0x2f1);if(_0xbac96e)io['to'](_0x116265(0x1c7))[_0x116265(0x269)](_0x116265(0x29d),_0xb1a62b);else{logger[_0x116265(0x184)]('-----------------------------------------------------------------------------------'),logger['simple'](_0xb1a62b),logger[_0x116265(0x184)](_0x116265(0x1a1)),logger[_0x116265(0x184)]('');if(tgBot&&settings[_0x116265(0x105)]&&settings[_0x116265(0x1a0)]!=_0x116265(0x12c))await sendTelegram(settings[_0x116265(0x105)],_0x116265(0x296)+_0xb1a62b);}}function validateCredentials(_0x526252,_0x3bdee7){const _0x3d1c48=_0x4d89ed;if(_0x526252['username']==settings[_0x3d1c48(0x2eb)]&&bcrypt[_0x3d1c48(0x275)](_0x526252[_0x3d1c48(0x277)],settings[_0x3d1c48(0x16d)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x3d1c48(0x19c),'token':null};else{const _0xcc6945=generateLoginToken(_0x3bdee7);return{'allow':!![],'reason':_0x3d1c48(0x2e9),'token':_0xcc6945};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x54ad9a){const _0x35f6cd=_0x4d89ed,_0x5a5ca0=generateLoginToken(_0x54ad9a);return{'allow':!![],'reason':_0x35f6cd(0x2e9),'token':_0x5a5ca0};}function validateAccess(_0x2ceb2d,_0x39c45c,_0x255b3d){const _0xd5a9b9=_0x4d89ed,_0x4c2c68=_0x255b3d?_0x255b3d:devices[_0x39c45c]['ip'];let _0x39fb51;const _0x87bfba=_0x2d8410=>{const _0x1d1d10=_0x2b05;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x39c45c)){const _0x388abf=generateLoginToken(_0x39c45c);return{'allow':!![],'reason':_0x1d1d10(0x181),'token':_0x388abf};}else return{'allow':![],'reason':_0x1d1d10(0x293),'token':null};}else return _0x39fb51=validToken(_0x2d8410,_0x39c45c),_0x39fb51[_0x1d1d10(0x129)](_0x1d1d10(0x12b))?{'allow':!![],'reason':_0x1d1d10(0x234),'token':_0x2d8410}:{'allow':![],'reason':_0x1d1d10(0x293),'token':null};}else return{'allow':!![],'reason':_0x1d1d10(0x268),'token':null};};if(settings[_0xd5a9b9(0x2f6)]){let _0x27618d=[...settings[_0xd5a9b9(0x1de)],'::1','::ffff:127.0.0.1','127.0.0.1'];if(_0x27618d['includes'](_0x4c2c68))return _0x87bfba(_0x2ceb2d);else{_0x39fb51=validToken(_0x2ceb2d,_0x39c45c);if(_0x39fb51[_0xd5a9b9(0x129)]('success'))return _0x87bfba(_0x2ceb2d);else{if(telegramIpApproved(_0x39c45c)){const _0x51c84a=generateToken(_0x39c45c);return _0x39fb51=_0x87bfba(_0x2ceb2d),_0x39fb51[_0xd5a9b9(0x260)]?{'allow':!![],'reason':_0xd5a9b9(0x21f),'token':_0x51c84a}:_0x39fb51;}else return settings[_0xd5a9b9(0x20f)]?{'allow':![],'reason':_0xd5a9b9(0x13e),'token':null}:{'allow':![],'reason':_0xd5a9b9(0x203),'token':null};}}}else return _0x87bfba(_0x2ceb2d);}function timelyDecrypt(_0x11c5d0,_0x2fdb83,_0x237b17='@'){const _0x1c2202=_0x4d89ed;if(_0x11c5d0)try{const _0x24d92b=crypt[_0x1c2202(0x28a)](secure[_0x1c2202(0x2a5)],_0x11c5d0)[_0x1c2202(0x14b)],_0x370148=_0x24d92b[_0x1c2202(0x298)](_0x237b17)[0x0],_0x350be3=_0x24d92b['split'](_0x237b17)[0x1],_0x1d4e91=new Date()[_0x1c2202(0x289)]();if(_0x2fdb83){if(_0x1d4e91-_0x350be3<maxSecretAge*0x3e8)return _0x370148;else return![];}else return _0x370148;}catch(_0x388115){return![];}else return![];}const validToken=(_0x51f3e1,_0x2c1a0f)=>{const _0x531060=_0x4d89ed,_0x34f111=devices[_0x2c1a0f]['ip'];if(!_0x51f3e1)return{'error':_0x531060(0x266)};for(let _0x317a2b of blacklist){if(_0x317a2b[_0x531060(0x1ce)]==_0x51f3e1)return{'error':_0x531060(0x217)};}let _0x5312ca;try{_0x5312ca=jwt['verify'](_0x51f3e1,secure[_0x531060(0x137)]+_0x2c1a0f);}catch{return{'error':_0x531060(0x28f)};}if(!_0x5312ca[_0x531060(0x129)](_0x531060(0x1d1))&&!_0x5312ca[_0x531060(0x129)]('username')||!_0x5312ca[_0x531060(0x129)](_0x531060(0x2df)))return{'error':_0x531060(0x19e)};if(!_0x5312ca[_0x531060(0x129)]('username')&&_0x5312ca[_0x531060(0x129)](_0x531060(0x1d1))){const {clientip:_0x140fe3}=_0x5312ca;return _0x34f111==_0x140fe3?{'success':_0x531060(0x285)}:{'error':_0x531060(0x18b)};}else{if(_0x5312ca[_0x531060(0x129)]('username')&&_0x5312ca[_0x531060(0x129)](_0x531060(0x1d1))){const {username:_0x56a6b9,clientip:_0x1fd71a}=_0x5312ca;return settings[_0x531060(0x2eb)]==_0x56a6b9&&_0x34f111==_0x1fd71a?{'success':_0x531060(0x285)}:{'error':_0x531060(0x26c)};}}},generateLoginToken=_0x916c96=>{const _0x1ba842=_0x4d89ed;if(_0x916c96){const _0x1ac41c=devices[_0x916c96]['ip'];return jwt[_0x1ba842(0x20c)]({'username':settings[_0x1ba842(0x2eb)],'clientip':_0x1ac41c},secure[_0x1ba842(0x137)]+_0x916c96,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x2f4eaf=>{const _0x23b397=_0x4d89ed;if(_0x2f4eaf){const _0x17441f=devices[_0x2f4eaf]['ip'];return jwt[_0x23b397(0x20c)]({'clientip':_0x17441f},secure[_0x23b397(0x137)]+_0x2f4eaf,{'expiresIn':devices[_0x2f4eaf]['telegramIpApproval'][_0x23b397(0x251)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x37cddf=>{const _0x217dc8=_0x4d89ed;let _0x548d8c=![];return devices[_0x37cddf][_0x217dc8(0x17d)]&&devices[_0x37cddf]['telegramIpApproval'][_0x217dc8(0x251)]!=_0x217dc8(0x161)&&(_0x548d8c=devices[_0x37cddf][_0x217dc8(0x17d)]['clientip']==devices[_0x37cddf]['ip']&&new Date()[_0x217dc8(0x289)]()-devices[_0x37cddf][_0x217dc8(0x17d)][_0x217dc8(0x1b6)]<devices[_0x37cddf][_0x217dc8(0x17d)]['expiry']*0x3c*0x3e8),_0x548d8c;},telegram2FaApproved=_0x57ff17=>{const _0x3f5123=_0x4d89ed;let _0x50f03f=![];return devices[_0x57ff17]['telegram2FaApproval']&&devices[_0x57ff17]['telegram2FaApproval'][_0x3f5123(0x251)]!=_0x3f5123(0x161)&&(_0x50f03f=devices[_0x57ff17][_0x3f5123(0x162)][_0x3f5123(0x1d1)]==devices[_0x57ff17]['ip']&&new Date()[_0x3f5123(0x289)]()-devices[_0x57ff17][_0x3f5123(0x162)][_0x3f5123(0x1b6)]<devices[_0x57ff17][_0x3f5123(0x162)][_0x3f5123(0x251)]*0x3c*0x3e8),_0x50f03f;},normalizeIP=_0x413ada=>{const _0x48c8a5=_0x4d89ed;let _0x257907=null,_0x1c1578=null;if(ipaddr[_0x48c8a5(0x1e1)](_0x413ada)){const _0x5661f3=ipaddr[_0x48c8a5(0x152)](_0x413ada);_0x5661f3[_0x48c8a5(0x281)]()===_0x48c8a5(0x15c)?(_0x5661f3['isIPv4MappedAddress']()&&(_0x257907=_0x5661f3[_0x48c8a5(0x263)]()[_0x48c8a5(0x274)]()),_0x1c1578=_0x5661f3['toString']()):(_0x257907=_0x5661f3[_0x48c8a5(0x274)](),_0x1c1578=_0x5661f3[_0x48c8a5(0x23e)]()[_0x48c8a5(0x274)]());}return{'show':_0x257907?_0x257907:_0x1c1578,'store':_0x1c1578};};function formatDate(_0x1e1a9e){const _0xe80a9c=_0x4d89ed;return _0x1e1a9e[_0xe80a9c(0x1e8)]()+'/'+(_0x1e1a9e[_0xe80a9c(0x24c)]()+0x1)['toString']()[_0xe80a9c(0x2f3)](0x2,'0')+'/'+_0x1e1a9e[_0xe80a9c(0x1a8)]()[_0xe80a9c(0x274)]()['padStart'](0x2,'0')+'\x20'+_0x1e1a9e[_0xe80a9c(0x2ee)]()[_0xe80a9c(0x274)]()['padStart'](0x2,'0')+':'+_0x1e1a9e[_0xe80a9c(0x1e2)]()['toString']()[_0xe80a9c(0x2f3)](0x2,'0')+':'+_0x1e1a9e[_0xe80a9c(0x1d8)]()[_0xe80a9c(0x274)]()[_0xe80a9c(0x2f3)](0x2,'0');}function sleep(_0x2c3408){return new Promise(_0x47c78a=>setTimeout(_0x47c78a,_0x2c3408));}