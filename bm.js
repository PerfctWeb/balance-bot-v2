const _0xcab4db=_0x4e8e;(function(_0x478fc7,_0x1458f8){const _0x276595=_0x4e8e,_0x5727f7=_0x478fc7();while(!![]){try{const _0x3c33a8=parseInt(_0x276595(0x1ea))/0x1*(parseInt(_0x276595(0x222))/0x2)+parseInt(_0x276595(0x17b))/0x3+parseInt(_0x276595(0x1c5))/0x4+parseInt(_0x276595(0x18e))/0x5+parseInt(_0x276595(0x1bb))/0x6*(-parseInt(_0x276595(0x312))/0x7)+parseInt(_0x276595(0x1b8))/0x8+parseInt(_0x276595(0x1f2))/0x9;if(_0x3c33a8===_0x1458f8)break;else _0x5727f7['push'](_0x5727f7['shift']());}catch(_0x1a5179){_0x5727f7['push'](_0x5727f7['shift']());}}}(_0x2ec9,0x74e0d));const _0x11c8e2=function(){let _0x172141=!![];return function(_0x16ff63,_0xd98ef5){const _0x1736b2=_0x172141?function(){const _0x52e0d1=_0x4e8e;if(_0xd98ef5){const _0x686517=_0xd98ef5[_0x52e0d1(0x1b0)](_0x16ff63,arguments);return _0xd98ef5=null,_0x686517;}}:function(){};return _0x172141=![],_0x1736b2;};}(),_0x4d8407=_0x11c8e2(this,function(){const _0x1ebef0=_0x4e8e;return _0x4d8407['toString']()['search']('(((.+)+)+)+$')['toString']()[_0x1ebef0(0x2c8)](_0x4d8407)[_0x1ebef0(0x1d7)](_0x1ebef0(0x2d5));});_0x4d8407();'use strict';process[_0xcab4db(0x24b)]['NTBA_FIX_319']=0x1;const childProcess=require(_0xcab4db(0x186)),fs=require('fs'),fns=require(_0xcab4db(0x31d)),low=require(_0xcab4db(0x223)),FileSync=require(_0xcab4db(0x165)),path=require(_0xcab4db(0x16b)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0xcab4db(0x251))[_0xcab4db(0x1f8)],bcrypt=require(_0xcab4db(0x1cb)),jwt=require(_0xcab4db(0x27b)),ipaddr=require(_0xcab4db(0x2fd)),argv=require(_0xcab4db(0x1dc))(process[_0xcab4db(0x1e0)][_0xcab4db(0x274)](0x2))['argv'],uuidRandom=require('uuid-random'),TelegramBot=require(_0xcab4db(0x25c)),Mixpanel=require(_0xcab4db(0x287)),axios=require(_0xcab4db(0x1b5)),{GraphQLClient,gql}=require(_0xcab4db(0x15c)),util=require(_0xcab4db(0x1a9)),fileUpload=require('express-fileupload'),PORT=argv['port']||_0xcab4db(0x2cd),pattern=/^[0-9]{2,4}$/;!pattern[_0xcab4db(0x2ca)](PORT)&&(console[_0xcab4db(0x2cf)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0xcab4db(0x1c3)]||null,userID=argv[_0xcab4db(0x249)]||'',debugging=argv['d']||![];let bbpath=_0xcab4db(0x193),bbpath2='';const botfile=_0xcab4db(0x2e1),configfile=_0xcab4db(0x31a),settingsfile=_0xcab4db(0x1e1),securefile=_0xcab4db(0x309),maxBackups=0xa;let validInstallation=!![];!fs[_0xcab4db(0x201)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xcab4db(0x259)),configpath=userID?bbpath+_0xcab4db(0x2d6)+userID+'/':bbpath+_0xcab4db(0x2d6),configbackuppath=configpath+_0xcab4db(0x306),logspath=userID?bbpath+_0xcab4db(0x23c)+userID+'/':bbpath+_0xcab4db(0x23c),zippath=userID?bbpath+_0xcab4db(0x189)+userID+'/':bbpath+'zip/',loggerfile=fs[_0xcab4db(0x2ad)](logspath+_0xcab4db(0x320),{'flags':'a'}),temppath=userID?bbpath+_0xcab4db(0x1d0)+userID+'/':bbpath+_0xcab4db(0x1d0);!fs[_0xcab4db(0x201)](configpath)&&fs[_0xcab4db(0x24a)](configpath);!fs[_0xcab4db(0x201)](configbackuppath)&&fs[_0xcab4db(0x24a)](configbackuppath);!fs[_0xcab4db(0x201)](logspath)&&fs[_0xcab4db(0x24a)](logspath);!fs[_0xcab4db(0x201)](zippath)&&fs['mkdirSync'](zippath);!fs[_0xcab4db(0x201)](temppath)&&fs[_0xcab4db(0x24a)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xcab4db(0x22d)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xcab4db(0x22d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xcab4db(0x171),'onepagemode':![]}})[_0xcab4db(0x275)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xcab4db(0x22d)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0xcab4db(0x2f7),'rsaStandard':_0xcab4db(0x1fb)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0xcab4db(0x1a4),{'host':_0xcab4db(0x29b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xcab4db(0x197)]&&settings[_0xcab4db(0x197)]!=''&&settings[_0xcab4db(0x26a)]&&settings[_0xcab4db(0x26a)]!='')initTelegram();const logger={'screen':_0x5177cc=>{const _0x30d543=_0xcab4db;console[_0x30d543(0x2cf)](_0x5177cc);},'simple':_0x5e8ee8=>{const _0x2167b5=_0xcab4db;console[_0x2167b5(0x2cf)](_0x5e8ee8),loggerfile[_0x2167b5(0x275)](util[_0x2167b5(0x216)](_0x5e8ee8)+'\x0a');},'full':async _0x299b75=>{const _0x51fc2e=_0xcab4db,_0x4d47b1=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x299b75;console[_0x51fc2e(0x2cf)](_0x4d47b1),loggerfile[_0x51fc2e(0x275)](util[_0x51fc2e(0x216)](_0x4d47b1)+'\x0a');if(tgBot&&settings[_0x51fc2e(0x1ca)]&&settings[_0x51fc2e(0x278)]!=_0x51fc2e(0x164))await tgBot[_0x51fc2e(0x2b4)](settings[_0x51fc2e(0x1ca)],_0x51fc2e(0x264)+_0x299b75)[_0x51fc2e(0x27c)](_0x45fd59=>{telegramError(_0x45fd59);});},'debug':async(_0x4eb71a,_0x20c90a='')=>{const _0xd16f01=_0xcab4db,_0x1e6001=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x4eb71a;if(debugging)console[_0xd16f01(0x2cf)](_0x1e6001);loggerfile[_0xd16f01(0x275)](util['format'](_0x1e6001)+'\x0a');if(_0x20c90a){if(debugging)console[_0xd16f01(0x2cf)](_0x20c90a);loggerfile['write'](util[_0xd16f01(0x216)](_0x20c90a)+'\x0a');}}};process['on']('uncaughtException',function(_0x29d2c5){const _0x34f637=_0xcab4db;logger[_0x34f637(0x28e)](_0x29d2c5);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xcab4db(0x21a))[_0xcab4db(0x16d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0xcab4db(0x23d))[_0xcab4db(0x226)](app);app[_0xcab4db(0x203)](fileUpload({'useTempFiles':!![]})),app[_0xcab4db(0x2e6)](_0xcab4db(0x237),async(_0x5756a1,_0x1e4f6a)=>{const _0x4e5432=_0xcab4db,_0x10102a=_0x5756a1[_0x4e5432(0x240)][_0x4e5432(0x270)],_0x1de0a4=getClientsWithBotID(_0x4e5432(0x217)),_0x5e11a2=_0x5756a1[_0x4e5432(0x221)][_0x4e5432(0x247)],_0x609cac=timelyDecrypt(_0x5e11a2,![]),_0x26db4d=_0x1de0a4['find'](_0x55caf9=>_0x55caf9[_0x4e5432(0x247)]==_0x609cac);if(_0x26db4d){const _0xa4b03d=normalizeIP(_0x5756a1[_0x4e5432(0x2dd)]['remoteAddress'])['store'],_0x38957f=_0x5756a1['headers'][_0x4e5432(0x2b7)];if(validateAccess(_0x38957f,_0x609cac,_0xa4b03d)['allow'])_0x10102a==_0x4e5432(0x28c)&&await backupConfigFiles(),await zipFiles(_0x10102a),_0x1e4f6a[_0x4e5432(0x192)](zippath+(_0x10102a+'.zip'),_0x1e6532=>{const _0x19e833=_0x4e5432;_0x1e6532&&(logger['full'](_0x19e833(0x283)+_0x10102a),logger[_0x19e833(0x28e)](_0x1e6532));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x10102a+_0x4e5432(0x2f8));}else logger['full'](_0x4e5432(0x25f)+_0x10102a+_0x4e5432(0x1b2));}),app[_0xcab4db(0x168)](_0xcab4db(0x195),async(_0x55daf5,_0x18d5ce)=>{const _0x25681b=_0xcab4db,_0x4fe8e5=getClientsWithBotID(_0x25681b(0x217)),_0x38a83f=_0x55daf5[_0x25681b(0x221)][_0x25681b(0x247)],_0x44e0b0=timelyDecrypt(_0x38a83f,![]),_0x334047=_0x4fe8e5[_0x25681b(0x288)](_0x33a6ed=>_0x33a6ed[_0x25681b(0x247)]==_0x44e0b0);logger['debug'](_0x25681b(0x1e6));if(_0x334047){const _0x26cdf4=normalizeIP(_0x55daf5[_0x25681b(0x2dd)][_0x25681b(0x29c)])['store'],_0x59a69c=_0x55daf5[_0x25681b(0x221)]['tkn'];if(validateAccess(_0x59a69c,_0x44e0b0,_0x26cdf4)[_0x25681b(0x1f0)]){if(_0x55daf5['files']){const _0x3f0c98=_0x55daf5['files'][_0x25681b(0x198)];await _0x3f0c98['mv'](temppath+_0x3f0c98[_0x25681b(0x2ed)]),_0x18d5ce[_0x25681b(0x219)]({'status':!![],'message':_0x25681b(0x1a3)});const _0x2ea9e7=getBotsWithMode();_0x2ea9e7[_0x25681b(0x1e2)]>0x0?confirmRestore(temppath,_0x3f0c98['name']):unzipFile(temppath,_0x3f0c98[_0x25681b(0x2ed)]);}}else logger[_0x25681b(0x1b6)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x25681b(0x1b6)](_0x25681b(0x244));}),app[_0xcab4db(0x203)](express[_0xcab4db(0x25e)](path['join'](__dirname,bbpath2,_0xcab4db(0x1c6)))),app[_0xcab4db(0x203)](express[_0xcab4db(0x25e)](path[_0xcab4db(0x190)](__dirname,bbpath2,'build'))),app['get']('/',function(_0xafc49e,_0x3f6b4){const _0x36db12=_0xcab4db;_0x3f6b4['sendFile'](path[_0x36db12(0x190)](__dirname,bbpath2,_0x36db12(0x1c6),_0x36db12(0x1a5)));}),app['get'](_0xcab4db(0x1ff),function(_0x1d97fa,_0x3bf675){const _0x385adf=_0xcab4db;_0x3bf675[_0x385adf(0x1be)](path[_0x385adf(0x190)](__dirname,bbpath2,_0x385adf(0x298),_0x385adf(0x1a5)));}),app['get'](_0xcab4db(0x322),(_0x35dd2b,_0x5f11bf)=>{const _0x295501=_0xcab4db;_0x5f11bf[_0x295501(0x1be)](path['join'](__dirname,bbpath2,_0x295501(0x298),'index.html'));}),app[_0xcab4db(0x2e6)](_0xcab4db(0x23e),(_0x5083be,_0x58ec03)=>{const _0x59d76e=_0xcab4db;_0x58ec03[_0x59d76e(0x1be)](path['join'](__dirname,bbpath2,_0x59d76e(0x298),_0x59d76e(0x1a5)));}),app['get'](_0xcab4db(0x176),(_0x3081a0,_0x11ef37)=>{const _0x37cf67=_0xcab4db;_0x11ef37[_0x37cf67(0x1be)](path['join'](__dirname,bbpath2,'build',_0x37cf67(0x1a5)));}),app['get'](_0xcab4db(0x160),(_0x109f1c,_0x2e7cb6)=>{const _0x46bad4=_0xcab4db;_0x2e7cb6[_0x46bad4(0x1be)](path[_0x46bad4(0x190)](__dirname,bbpath2,'build',_0x46bad4(0x1a5)));}),app[_0xcab4db(0x2e6)]('/:bot/configuration',(_0x1866ee,_0x3872d2)=>{const _0x332c69=_0xcab4db;_0x3872d2[_0x332c69(0x1be)](path[_0x332c69(0x190)](__dirname,bbpath2,_0x332c69(0x298),'index.html'));}),app[_0xcab4db(0x2e6)]('/:bot/support',(_0x5a02d5,_0x3258e7)=>{const _0x2115e5=_0xcab4db;_0x3258e7[_0x2115e5(0x1be)](path[_0x2115e5(0x190)](__dirname,bbpath2,_0x2115e5(0x298),_0x2115e5(0x1a5)));});if(HOST)http[_0xcab4db(0x2df)](PORT,HOST);else http[_0xcab4db(0x2df)](PORT);const io=require(_0xcab4db(0x319))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x18f7fd=_0xcab4db;logger[_0x18f7fd(0x28e)](''),logger[_0x18f7fd(0x28e)]('-----------------------------------------------------------------------------------'),await logger[_0x18f7fd(0x1b6)](_0x18f7fd(0x1de)+PORT),logger[_0x18f7fd(0x28e)](_0x18f7fd(0x2dc));if(config[_0x18f7fd(0x1e2)]!=0x0)for(const _0x3ac342 of config){if(_0x3ac342[_0x18f7fd(0x1c9)]==_0x18f7fd(0x2d0)||_0x3ac342['status']=='new')await logger['full'](_0x18f7fd(0x2e8)+_0x3ac342[_0x18f7fd(0x315)]+_0x18f7fd(0x22b)+_0x3ac342[_0x18f7fd(0x1c4)]),startBot([_0x3ac342[_0x18f7fd(0x315)],userID],{'cwd':bbpath},function(_0x1add26){const _0x4de8fd=_0x18f7fd;if(_0x1add26)logger[_0x4de8fd(0x1b6)](_0x1add26);});else(_0x3ac342['status']==_0x18f7fd(0x2e2)||_0x3ac342[_0x18f7fd(0x1c9)]==_0x18f7fd(0x199))&&await logger[_0x18f7fd(0x1b6)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x3ac342['botID']+_0x18f7fd(0x22b)+_0x3ac342['botname']);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x18f7fd(0x28e)](_0x18f7fd(0x2dc)),logger[_0x18f7fd(0x28e)]('');}function startSocket(){const _0x4d1de0=_0xcab4db;io['on'](_0x4d1de0(0x2ee),_0x221073=>{const _0x375b7e=_0x4d1de0;let _0x5ab1af,_0x580097,_0x761764,_0x591469,_0x5b4a4a;const _0x1c7904=_0x221073['handshake'][_0x375b7e(0x221)][_0x375b7e(0x20b)];_0x580097=_0x1c7904['match'](/bot[0-9]{3}/);if(_0x580097)_0x761764=_0x580097[0x0]['match'](/[0-9]{3}/);if(_0x761764)_0x5ab1af=_0x761764[0x0];else _0x5ab1af=_0x375b7e(0x217);const _0xb0c709=_0x221073[_0x375b7e(0x250)][_0x375b7e(0x2da)]['encryptedUuid'];if(!_0xb0c709)_0x221073[_0x375b7e(0x1ab)](_0x375b7e(0x1c9),{'publicKey':secure[_0x375b7e(0x185)]});else{_0x591469=timelyDecrypt(_0xb0c709,![]);if(!_0x591469)_0x221073[_0x375b7e(0x1ab)](_0x375b7e(0x1c9),{'publicKey':secure['publicKey']});else{_0x5b4a4a=normalizeIP(_0x221073['conn'][_0x375b7e(0x29c)])[_0x375b7e(0x302)];if(!devices[_0x591469])devices[_0x591469]={'uuid':_0x591469,'access':{'token':null}};devices[_0x591469]['ip']=_0x5b4a4a;const _0x4b3917=addClient(_0x221073['id'],_0x591469,_0x5ab1af);setAccess(_0x4b3917),emitMessages(),_0x221073['on']('login',_0x169faa=>{const _0x36154f=_0x375b7e,_0xec5395=timelyDecrypt(_0x169faa['password']);if(_0xec5395){_0x169faa={'username':_0x169faa[_0x36154f(0x1d5)],'password':_0xec5395},devices[_0x591469][_0x36154f(0x2d1)]=validateCredentials(_0x169faa,_0x591469);if(devices[_0x591469][_0x36154f(0x2d1)]['allow']==![]&&devices[_0x591469][_0x36154f(0x2d1)][_0x36154f(0x17e)]==_0x36154f(0x163))_0x221073[_0x36154f(0x1ab)]('status',{'access':devices[_0x591469][_0x36154f(0x2d1)]}),loginAccess2FA(_0x591469,_0x5b4a4a);else{if(devices[_0x591469][_0x36154f(0x2d1)][_0x36154f(0x1f0)]==![]&&devices[_0x591469]['access'][_0x36154f(0x17e)]==_0x36154f(0x18d))_0x221073['emit']('status',{'access':devices[_0x591469][_0x36154f(0x2d1)]});else devices[_0x591469]['access'][_0x36154f(0x1f0)]&&devices[_0x591469]['access'][_0x36154f(0x17e)]==_0x36154f(0x17a)&&(getClientsWithUuid(_0x591469)[_0x36154f(0x2a9)](_0x3b4f2d=>{setAccess(_0x3b4f2d);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x591469['slice'](-0x8)),setTokenRefresh(_0x591469),setSessionTimeout(_0x36154f(0x1e7),_0x591469));}}else logger['full'](_0x36154f(0x276));}),_0x221073['on'](_0x375b7e(0x2a3),()=>{resetPassword();}),_0x221073['on'](_0x375b7e(0x2ae),_0x1fd7bc=>{removeClient(_0x221073['id']);}),_0x5ab1af=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x296e1a){const _0x21f3bd=_0xcab4db;if(_0x296e1a!=_0x21f3bd(0x217)&&config['apiKey']!=''){if(pid[_0x296e1a])pid[_0x296e1a][_0x21f3bd(0x219)]({'function':_0x21f3bd(0x241),'args':null});}_0x296e1a!=_0x21f3bd(0x217)&&broadcastToBots(_0x21f3bd(0x2d8),JSON['stringify'](config));}function reloadBotManager(){const _0x137a57=_0xcab4db;getClientsWithBotID(_0x137a57(0x217))[_0x137a57(0x2a9)](_0x586c37=>{const _0x4a1ac8=_0x137a57;getSocket(_0x586c37['id'])['emit'](_0x4a1ac8(0x1c9),{'access':{'allow':![],'reason':_0x4a1ac8(0x29f),'token':null}});});}function getSocket(_0x576d9a){const _0x186d09=_0xcab4db;return io[_0x186d09(0x323)][_0x186d09(0x323)][_0x186d09(0x2e6)](_0x576d9a);}function setAccess(_0x6c36ea){const _0xd9c672=_0xcab4db,_0x152ce6=getSocket(_0x6c36ea['id']),_0x1b4689=_0x6c36ea[_0xd9c672(0x247)],_0x366790=_0x6c36ea[_0xd9c672(0x308)];devices[_0x1b4689]['access']=validateAccess(devices[_0x1b4689][_0xd9c672(0x2d1)][_0xd9c672(0x19e)],_0x1b4689),logger['debug']('Setting\x20access:\x20'+devices[_0x1b4689][_0xd9c672(0x2d1)][_0xd9c672(0x17e)]+'\x20|\x20client:\x20...'+_0x6c36ea['id'][_0xd9c672(0x274)](-0x8)+_0xd9c672(0x1f1)+_0x1b4689[_0xd9c672(0x274)](-0x8)),_0x152ce6[_0xd9c672(0x190)](_0x1b4689);if(devices[_0x1b4689][_0xd9c672(0x2d1)]['allow']){_0x152ce6[_0xd9c672(0x190)](_0x366790);if(_0x366790==_0xd9c672(0x217))initializeSocketBotManager(_0x152ce6);else initializeSocketBot(_0x152ce6);initClient(_0x366790);}devices[_0x1b4689][_0xd9c672(0x2d1)][_0xd9c672(0x19e)]&&devices[_0x1b4689][_0xd9c672(0x2d1)]['reason']==_0xd9c672(0x2c3)&&setSessionTimeout(_0xd9c672(0x2a7),_0x1b4689),devices[_0x1b4689][_0xd9c672(0x2d1)][_0xd9c672(0x19e)]&&devices[_0x1b4689][_0xd9c672(0x2d1)][_0xd9c672(0x17e)]==_0xd9c672(0x310)&&setSessionTimeout(_0xd9c672(0x1e7),_0x1b4689),_0x152ce6[_0xd9c672(0x1ab)](_0xd9c672(0x1c9),{'status':_0x6c36ea[_0xd9c672(0x307)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1b4689][_0xd9c672(0x2d1)],'externalip':devices[_0x1b4689]['ip'],'publicKey':secure[_0xd9c672(0x185)],'userid':settings[_0xd9c672(0x1bd)],'validInstallation':validInstallation}),devices[_0x1b4689][_0xd9c672(0x2d1)][_0xd9c672(0x1f0)]==![]&&devices[_0x1b4689][_0xd9c672(0x2d1)]['reason']==_0xd9c672(0x184)&&temporaryAccess2FA(_0x1b4689,devices[_0x1b4689]['ip']);}function _0x4e8e(_0x4b5c85,_0x159cff){const _0x5b4013=_0x2ec9();return _0x4e8e=function(_0x4d8407,_0x11c8e2){_0x4d8407=_0x4d8407-0x15c;let _0x2ec9a5=_0x5b4013[_0x4d8407];return _0x2ec9a5;},_0x4e8e(_0x4b5c85,_0x159cff);}function setSessionTimeout(_0x54cb49,_0x5d20ec){const _0x2323bd=_0xcab4db;let _0xe9b9e2;if(_0x54cb49=='login')_0xe9b9e2=loginExpiry*0x3c*0x3e8;else _0xe9b9e2=devices[_0x5d20ec][_0x2323bd(0x2ac)][_0x2323bd(0x2e9)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x5d20ec][_0x2323bd(0x2ac)]['timestamp']);if(devices[_0x5d20ec]['pidExpireLogin'])clearTimeout(devices[_0x5d20ec][_0x2323bd(0x24e)]);devices[_0x5d20ec][_0x2323bd(0x24e)]=setTimeout(()=>{const _0x3a6180=_0x2323bd;if(devices[_0x5d20ec]['pidRefreshToken'])clearTimeout(devices[_0x5d20ec][_0x3a6180(0x269)]);removeSocketListeners(_0x5d20ec),addBlacklist(_0x5d20ec),devices[_0x5d20ec][_0x3a6180(0x2ac)]=null,devices[_0x5d20ec]['telegram2FaApproval']=null,devices[_0x5d20ec][_0x3a6180(0x2d1)]['token']=null,logger[_0x3a6180(0x22f)](_0x3a6180(0x233)+_0x5d20ec[_0x3a6180(0x274)](-0x8)),devices[_0x5d20ec][_0x3a6180(0x2d1)]=validateAccess(devices[_0x5d20ec][_0x3a6180(0x2d1)][_0x3a6180(0x19e)],_0x5d20ec),!(devices[_0x5d20ec][_0x3a6180(0x2d1)][_0x3a6180(0x1f0)]&&devices[_0x5d20ec]['access']['reason']==_0x3a6180(0x31e))&&(_0x54cb49==_0x3a6180(0x1e7)?io['to'](_0x5d20ec)[_0x3a6180(0x1ab)](_0x3a6180(0x1c9),{'access':{'allow':![],'reason':_0x3a6180(0x2e3),'token':null}}):io['to'](_0x5d20ec)['emit'](_0x3a6180(0x1c9),{'access':{'allow':![],'reason':_0x3a6180(0x282),'token':null}})),devices[_0x5d20ec]['access'][_0x3a6180(0x19e)]=null;},_0xe9b9e2);}function setTokenRefresh(_0x5c04a1){const _0x54bf18=_0xcab4db;if(devices[_0x5c04a1][_0x54bf18(0x269)])clearTimeout(devices[_0x5c04a1]['pidRefreshToken']);devices[_0x5c04a1][_0x54bf18(0x269)]=setTimeout(()=>{const _0x18f756=_0x54bf18;getClientsWithUuid(_0x5c04a1)['length']!=0x0?(devices[_0x5c04a1][_0x18f756(0x2d1)]=refreshToken(_0x5c04a1),io['to'](_0x5c04a1)[_0x18f756(0x1ab)](_0x18f756(0x1c9),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5c04a1][_0x18f756(0x2d1)],'externalip':devices[_0x5c04a1]['ip'],'publicKey':secure[_0x18f756(0x185)],'validInstallation':validInstallation}),setTokenRefresh(_0x5c04a1)):clearTimeout(devices[_0x5c04a1][_0x18f756(0x269)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x41e06b){const _0x4d5eac=_0xcab4db,_0x2d9d23=getClient(_0x41e06b['id'])[_0x4d5eac(0x247)];_0x41e06b['emit'](_0x4d5eac(0x2d8),config),_0x41e06b[_0x4d5eac(0x1ab)](_0x4d5eac(0x28a),cleanSettings()),_0x41e06b['on'](_0x4d5eac(0x1b7),_0x33bb47=>{const _0x5be5c4=_0x4d5eac;if(validateAccess(_0x33bb47,_0x2d9d23)[_0x5be5c4(0x1f0)])addBot();else logger['full'](_0x5be5c4(0x25d));}),_0x41e06b['on'](_0x4d5eac(0x1bf),(_0x2800ee,_0x549f15)=>{const _0x230e10=_0x4d5eac;if(validateAccess(_0x549f15,_0x2d9d23)['allow'])toggleBot(_0x2800ee['botID'],_0x2800ee[_0x230e10(0x1c9)],_0x2800ee['live']);else logger['full'](_0x230e10(0x256));}),_0x41e06b['on'](_0x4d5eac(0x27e),(_0x2d1cc0,_0x4e4565)=>{const _0x817dc8=_0x4d5eac;if(validateAccess(_0x4e4565,_0x2d9d23)[_0x817dc8(0x1f0)])toggleBotMode(_0x2d1cc0);else logger[_0x817dc8(0x1b6)](_0x817dc8(0x256));}),_0x41e06b['on'](_0x4d5eac(0x220),(_0x5f57d0,_0x379123)=>{const _0x4e955f=_0x4d5eac;if(validateAccess(_0x379123,_0x2d9d23)[_0x4e955f(0x1f0)])deleteBot(_0x5f57d0);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x41e06b['on']('store-settings',(_0x1f1bb2,_0x431abb)=>{const _0x1167c7=_0x4d5eac;if(validateAccess(_0x431abb,_0x2d9d23)[_0x1167c7(0x1f0)])storeSettings(_0x1f1bb2,!![]);else logger[_0x1167c7(0x1b6)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x41e06b['on'](_0x4d5eac(0x175),_0x510776=>{const _0x174cf0=_0x4d5eac;if(validateAccess(_0x510776,_0x2d9d23)['allow'])updateBB('update');else logger[_0x174cf0(0x1b6)](_0x174cf0(0x258));}),_0x41e06b['on'](_0x4d5eac(0x2ec),_0x3577a2=>{const _0x4eb881=_0x4d5eac;if(validateAccess(_0x3577a2,_0x2d9d23)[_0x4eb881(0x1f0)])updateBB(_0x4eb881(0x1db));else logger[_0x4eb881(0x1b6)](_0x4eb881(0x2c9));}),_0x41e06b['on'](_0x4d5eac(0x2fb),_0x57337d=>{const _0x1446b2=_0x4d5eac;if(validateAccess(_0x57337d,_0x2d9d23)[_0x1446b2(0x1f0)]){const _0x3a019e=getClient(_0x41e06b['id']);if(_0x3a019e)getBackupFiles(_0x3a019e['uuid']);else logger[_0x1446b2(0x1b6)](_0x1446b2(0x257));}else logger[_0x1446b2(0x1b6)](_0x1446b2(0x2f9));}),_0x41e06b['on']('restore-backup-file',(_0x4c82e7,_0x3d3925)=>{if(validateAccess(_0x3d3925,_0x2d9d23)['allow'])restoreBackupFile(_0x4c82e7);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x41e06b['on'](_0x4d5eac(0x22a),_0x3f3b65=>{const _0x59bdf0=_0x4d5eac;if(validateAccess(_0x3f3b65,_0x2d9d23)[_0x59bdf0(0x1f0)])getMessages();else logger[_0x59bdf0(0x1b6)](_0x59bdf0(0x2b3));}),_0x41e06b['on'](_0x4d5eac(0x1f9),(_0x4ef170,_0x3f9800)=>{const _0x5e755b=_0x4d5eac;if(validateAccess(_0x3f9800,_0x2d9d23)['allow'])confirmMessage(_0x4ef170);else logger[_0x5e755b(0x1b6)](_0x5e755b(0x21e));}),_0x41e06b['on'](_0x4d5eac(0x209),_0x42a9e5=>{const _0x185148=_0x4d5eac;if(validateAccess(_0x42a9e5,_0x2d9d23)['allow']){if(devices[_0x2d9d23][_0x185148(0x269)])clearTimeout(devices[_0x2d9d23][_0x185148(0x269)]);if(devices[_0x2d9d23][_0x185148(0x24e)])clearTimeout(devices[_0x2d9d23][_0x185148(0x24e)]);removeSocketListeners(getClient(_0x41e06b['id'])[_0x185148(0x247)]),addBlacklist(_0x2d9d23),devices[_0x2d9d23][_0x185148(0x2ac)]=null,devices[_0x2d9d23][_0x185148(0x2d7)]=null,devices[_0x2d9d23][_0x185148(0x2d1)]['token']=null,logger[_0x185148(0x22f)](_0x185148(0x19a)+_0x2d9d23[_0x185148(0x274)](-0x8)),io['to'](getClient(_0x41e06b['id'])['uuid'])[_0x185148(0x1ab)](_0x185148(0x1c9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x185148(0x1b6)](_0x185148(0x1b3));});}function initializeSocketBot(_0x391d07){const _0x5cb09e=_0xcab4db,_0x42c341=getClient(_0x391d07['id'])[_0x5cb09e(0x308)],_0x39c7e6=getClient(_0x391d07['id'])['uuid'];_0x391d07['on'](_0x5cb09e(0x20e),(_0x27c4a0,_0x3dfc7b)=>{const _0x30f151=_0x5cb09e;if(validateAccess(_0x3dfc7b,_0x39c7e6)['allow']){if(pid[_0x42c341])pid[_0x42c341]['send']({'function':_0x30f151(0x24f),'args':_0x27c4a0});}else logger[_0x30f151(0x1b6)](_0x30f151(0x207));}),_0x391d07['on'](_0x5cb09e(0x19c),(_0x1a802f,_0x901a4e)=>{const _0x3adf7a=_0x5cb09e;if(validateAccess(_0x901a4e,_0x39c7e6)[_0x3adf7a(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341][_0x3adf7a(0x219)]({'function':'deleteHistoryAlerts','args':_0x1a802f});}else logger[_0x3adf7a(0x1b6)](_0x3adf7a(0x15e));}),_0x391d07['on'](_0x5cb09e(0x181),(_0x4ad09e,_0xa14d1f)=>{const _0x4942bf=_0x5cb09e;if(validateAccess(_0xa14d1f,_0x39c7e6)[_0x4942bf(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341][_0x4942bf(0x219)]({'function':'getPortfolio','args':_0x4ad09e});}else logger[_0x4942bf(0x1b6)](_0x4942bf(0x2a6));}),_0x391d07['on'](_0x5cb09e(0x2ff),(_0x4f9aac,_0x2957d4)=>{const _0x4a9543=_0x5cb09e;if(validateAccess(_0x2957d4,_0x39c7e6)[_0x4a9543(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341]['send']({'function':'storeConfiguration','args':_0x4f9aac});}else logger[_0x4a9543(0x1b6)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x391d07['on'](_0x5cb09e(0x2c1),(_0x3ea6d6,_0x4b700e)=>{const _0x4ee084=_0x5cb09e;if(validateAccess(_0x4b700e,_0x39c7e6)[_0x4ee084(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341][_0x4ee084(0x219)]({'function':_0x4ee084(0x19b),'args':_0x3ea6d6});}else logger['full'](_0x4ee084(0x23f));}),_0x391d07['on']('store-fiat',(_0x449b2e,_0x442b5e)=>{const _0x4059d6=_0x5cb09e;if(validateAccess(_0x442b5e,_0x39c7e6)[_0x4059d6(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341][_0x4059d6(0x219)]({'function':'storeFiat','args':_0x449b2e});}else logger['full'](_0x4059d6(0x30f));}),_0x391d07['on'](_0x5cb09e(0x268),_0xf1e5ef=>{const _0xf0e29e=_0x5cb09e;if(validateAccess(_0xf1e5ef,_0x39c7e6)['allow']){if(pid[_0x42c341])pid[_0x42c341][_0xf0e29e(0x219)]({'function':_0xf0e29e(0x18c),'args':null});}else logger[_0xf0e29e(0x1b6)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x391d07['on']('get-starting-balances',_0x346493=>{const _0x1cfd69=_0x5cb09e;if(validateAccess(_0x346493,_0x39c7e6)[_0x1cfd69(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341]['send']({'function':_0x1cfd69(0x1a2),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x391d07['on'](_0x5cb09e(0x26d),(_0x295097,_0x231bb8)=>{const _0x4e89a6=_0x5cb09e;if(validateAccess(_0x231bb8,_0x39c7e6)['allow']){if(pid[_0x42c341])pid[_0x42c341][_0x4e89a6(0x219)]({'function':_0x4e89a6(0x294),'args':_0x295097});}else logger[_0x4e89a6(0x1b6)](_0x4e89a6(0x2ce));}),_0x391d07['on'](_0x5cb09e(0x318),_0x435f65=>{const _0x1db411=_0x5cb09e;if(validateAccess(_0x435f65,_0x39c7e6)[_0x1db411(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341][_0x1db411(0x219)]({'function':_0x1db411(0x1b1),'args':null});}else logger[_0x1db411(0x1b6)](_0x1db411(0x292));}),_0x391d07['on'](_0x5cb09e(0x180),_0x5a884e=>{const _0x3bec7d=_0x5cb09e;if(validateAccess(_0x5a884e,_0x39c7e6)[_0x3bec7d(0x1f0)]){if(pid[_0x42c341])pid[_0x42c341][_0x3bec7d(0x219)]({'function':_0x3bec7d(0x204),'args':null});}else logger['full'](_0x3bec7d(0x22e));}),_0x391d07['on']('update-bb',_0x5f5884=>{const _0x3e3d42=_0x5cb09e;if(validateAccess(_0x5f5884,_0x39c7e6)[_0x3e3d42(0x1f0)])updateBB(_0x3e3d42(0x284));else logger['full'](_0x3e3d42(0x258));}),_0x391d07['on'](_0x5cb09e(0x22a),_0x13e652=>{const _0x416c4f=_0x5cb09e;if(validateAccess(_0x13e652,_0x39c7e6)[_0x416c4f(0x1f0)])getMessages();else logger[_0x416c4f(0x1b6)](_0x416c4f(0x2b3));}),_0x391d07['on'](_0x5cb09e(0x1f9),(_0x4d5182,_0x318aad)=>{const _0x3a7ab7=_0x5cb09e;if(validateAccess(_0x318aad,_0x39c7e6)[_0x3a7ab7(0x1f0)])confirmMessage(_0x4d5182);else logger[_0x3a7ab7(0x1b6)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x391d07['on'](_0x5cb09e(0x209),_0x10a466=>{const _0x5717b8=_0x5cb09e;if(validateAccess(_0x10a466,_0x39c7e6)[_0x5717b8(0x1f0)]){if(devices[_0x39c7e6][_0x5717b8(0x269)])clearTimeout(devices[_0x39c7e6]['pidRefreshToken']);if(devices[_0x39c7e6][_0x5717b8(0x24e)])clearTimeout(devices[_0x39c7e6][_0x5717b8(0x24e)]);removeSocketListeners(getClient(_0x391d07['id'])['uuid']),addBlacklist(_0x39c7e6),devices[_0x39c7e6][_0x5717b8(0x2ac)]=null,devices[_0x39c7e6][_0x5717b8(0x2d7)]=null,devices[_0x39c7e6][_0x5717b8(0x2d1)][_0x5717b8(0x19e)]=null,logger['debug'](_0x5717b8(0x19a)+_0x39c7e6['slice'](-0x8)),io['to'](getClient(_0x391d07['id'])[_0x5717b8(0x247)])['emit']('status',{'access':{'allow':![],'reason':_0x5717b8(0x230),'token':null}});}else logger[_0x5717b8(0x1b6)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x434029){getClientsWithUuid(_0x434029)['forEach'](_0x118bef=>{const _0x8626c2=_0x4e8e;getSocket(_0x118bef['id'])[_0x8626c2(0x255)]();});}function _0x2ec9(){const _0x3c0e5c=['version','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','new','0.0.0','backup-full.zip','getMinutes','isIPv4MappedAddress','update-bb','/:bot/coins','Error\x20while\x20deleting\x20config\x20files:\x20','************','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','login\x20token\x20generated','40950qjeqLC','Yes','restart','reason','Restore\x20process\x20aborted','show-config','get-portfolio','/update\x20-\x20update\x20Balance\x20Bot\x0a','updatebotmanager','2FA\x20required','publicKey','child_process','min','getDate','zip/','Restore\x20backup\x20file\x20','Orders','resetHistory','invalid\x20credentials','976805SpujTm','randomBytes','join','value','download','bb/','verify','/upload-backup','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','telegramToken','backupfile','new-disabled','Logged\x20out\x20user\x20...','storeHeadless','delete-alerts','getUTCHours','token','stopPolling','getFullYear','.zip','getStartingBalances','File\x20uploaded','6b67f3d61ee94b8f5c80b4affef4c4d9','index.html','track','readdirSync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','util','/metrics\x20-\x20show\x20bot\x20performance\x0a','emit','notification','auto','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','All','apply','cancelLoading','\x20(2)','Unauthorized\x20attempt\x20to\x20log\x20out','chat','axios','full','add-bot','695664JzmzYq','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','title','6ntMPVS','1000','userid','sendFile','update-bot','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','sendMetricsTelegram','error','host','botname','1228696reNHuk','build2','<b>Balance\x20Bot\x20Status:</b>\x0a','/on\x20-\x20start\x20bot(s)\x0a','status','telegramChatId','bcryptjs','Notifications\x20disabled','mode','headless','\x20mode','temp/','toIPv4Address','rmSync','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','username','endsWith','search','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','telegramEnabled','push','reinstall','yargs/yargs','sort','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','decrypt','argv','bb-settings.json','length','keys','telegrammsg','order','Backup\x20file\x20uploaded','login','***','isValid','628SMnECw','then','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','\x20to\x20','getHours','allow','\x20|\x20user:\x20...','489843hRkkBC','statSync','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','generate','includes','_data','RSA','confirm-message','settings.','RSA-OAEP','whitelist','https://api.ipify.org?format=json','hasOwnProperty','/:bot','messages','existsSync','alerts','use','showConfig','30\x20min','split','Unauthorized\x20attempt\x20to\x20get\x20events','inherit','logout','onepagemode','referer','reject','telegram','get-logs','onText','Starting\x20Balance\x20Bot\x20update','assign','temporary\x20access\x20not\x20allowed','\x20>\x20','number','Alerts','format','botmanager','removeListener','send','version.json','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','stop','copyFileSync','Unauthorized\x20attempt\x20to\x20confirm\x20message','exec','delete-bot','headers','1894TOWvVw','lowdb','success','files','createServer','login\x20required','startsWith','callback_query','get-messages','\x20|\x20',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','defaults','Unauthorized\x20attempt\x20to\x20show\x20configuration','debug','logged\x20out','/off\x20-\x20stop\x20bot(s)\x0a','backup-files','Session\x20expired\x20for\x20user\x20...','SIGTERM','Notifications\x20enabled\x0a','args','/download/:type','Starting\x20new\x20bot\x20|\x20Bot\x20','hex','answerCallbackQuery','clientip','logs/','http','/:bot/performance','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','params','initclient','stringify','running','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','live','data','uuid','Invalid\x20username\x20or\x20IP\x20address','user','mkdirSync','env','You\x20can\x20use\x20the\x20following\x20commands:\x0a','unlinkSync','pidExpireLogin','emitHistory','handshake','hybrid-crypto-js','No\x20authentication\x20token','User\x20has\x20been\x20validated','filter','removeAllListeners','Unauthorized\x20attempt\x20to\x20update\x20bot','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','clients','manual','lastmsgemitted','node-telegram-bot-api','Unauthorized\x20attempt\x20to\x20add\x20bot','static','Unauthorized\x20attempt\x20to\x20download\x20','accept','set','toString','any','Bot\x20Mgr\x20>\x20','stopped','$1_$2_$3','padStart','reset-history','pidRefreshToken','telegramUsername','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','sortBy','place-order','backup-full@','sendPortfolioTelegram','type','logs','-performance.json','bbvNew','slice','write','Unauthorized\x20login\x20attempt\x20(timeout)','started','telegramEvents','randomFillSync','getTime','jsonwebtoken','catch','max','toggle-bot-mode','bbUsername','bbvReceive','output-000.log','temporary\x20access\x20timeout','Failed\x20to\x20download\x20','update','mtime','kill','mixpanel','find','backup-full','settings','blacklist','backup','/enable\x20-\x20enable\x20notifications\x0a','simple','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Enabled\x20Bot\x20','privateKey','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','function','placeOrder','ipc','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','sign','build','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','file','api-eu.mixpanel.com','remoteAddress','Password\x20has\x20been\x20reset\x20to:\x20','writeFileSync','reload','HTML','2FA\x20login\x20rejected','apiSecret','reset-password','loginRequired','Disabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','2FA','/restart\x20-\x20restart\x20bot(s)\x0a','forEach','getMonth','Notifications\x20types:\x20','telegramIpApproval','createWriteStream','disconnect','hashSync','/status\x20-\x20show\x20bot(s)\x20status\x0a','size','request','Unauthorized\x20attempt\x20to\x20get\x20messages','sendMessage','output-002.log','15\x20min','tkn','All\x20bots\x20running\x20right\x20now','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/disable\x20-\x20disable\x20notifications\x0a','Invalid\x20Telegram\x20token','-events.json','Notifications\x20enabled','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Allow\x20login\x20from\x20IP\x20address\x20<b>','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','store-headless','node-zip','temporary\x20token\x20generated','event','message','alias','warning','constructor','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','test','-config.json','Your\x20installation\x20is\x20already\x20up\x20to\x20date','3000','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','log','enabled','access','bbPassword','readFileSync','bot-','(((.+)+)+)+$','config/','telegram2FaApproval','bots','All\x20bots','auth','\x20minutes','-----------------------------------------------------------------------------------','socket','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','listen','exp','bot.js','disabled','access\x20timeout','exit','once','get','/help\x20-\x20show\x20available\x20commands\x0a','Starting\x20bot\x20|\x20Bot\x20','expiry','Bot\x20','replace','reinstall-bb','name','connection','toIPv4MappedAddress','Notifications\x20disabled\x0a','fork','show','latestversion','getSeconds','cloneDeep','Backup\x20file\x20unzipped\x20and\x20stored','sha256','\x20(1)','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','isDirectory','get-backup-files','f2aRequired','ipaddr.js','parse','store-configuration','remove','Password\x20reset\x20rejected','store','exchange','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','showname','backup/','server','bot','bb-secure.json','timeshift','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','from','whitelistEnabled','Markdown','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','2FA\x20login\x20token\x20generated','DEFLATE','5414871BujUPs','404\x20Not\x20Found','kind','botID','lastmsgtelegram','login\x20token\x20valid','cancel-loading','socket.io','bb-config.json','/names\x20-\x20show\x20bot\x20names\x0a','all','date-fns','login\x20not\x20required','No\x20bots\x20running\x20right\x20now','/output-000.log','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','/:bot/portfolio','sockets','graphql-request','binary','Unauthorized\x20attempt\x20to\x20delete\x20alerts','</b>\x20?','/:bot/history','yes','Restarting\x20Bot\x20','2FA\x20login\x20required','orders','lowdb/adapters/FileSync','secret','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','post','temporaryAccessAllowed','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','path','5\x20min'];_0x2ec9=function(){return _0x3c0e5c;};return _0x2ec9();}function cleanSettings(){const _0x37bf89=_0xcab4db;let _0x35a4f9=settings;return settings[_0x37bf89(0x197)]&&settings['telegramToken']!=''&&(_0x35a4f9={..._0x35a4f9,'telegramToken':_0x37bf89(0x178)}),settings[_0x37bf89(0x2d2)]&&settings[_0x37bf89(0x2d2)]!=''&&(_0x35a4f9={..._0x35a4f9,'bbPassword':_0x37bf89(0x178)}),(settings[_0x37bf89(0x2d2)]&&settings[_0x37bf89(0x2d2)]=='***'||settings[_0x37bf89(0x197)]&&settings[_0x37bf89(0x197)]==_0x37bf89(0x1e8))&&(_0x35a4f9={..._0x35a4f9,'restored':{'password':settings['bbPassword']==_0x37bf89(0x1e8),'telegram':settings[_0x37bf89(0x197)]==_0x37bf89(0x1e8)}}),_0x35a4f9;}async function updateBB(_0xd533da){const _0x46a85b=_0xcab4db;await backupConfigFiles(),installingUpdate=!![],config[_0x46a85b(0x2a9)](_0x5efdea=>{const _0x2090bb=_0x46a85b;restartBot(_0x5efdea[_0x2090bb(0x315)]);}),logger['debug']('Starting\x20Balance\x20Bot\x20'+_0xd533da);if(_0xd533da==_0x46a85b(0x284))process[_0x46a85b(0x219)]({'update':!![]},_0x5033e9=>{});else _0xd533da==_0x46a85b(0x1db)&&process[_0x46a85b(0x219)]({'reinstall':!![]},_0x42ac27=>{});}function startBot(_0x12716e,_0x2aa223,_0x21e861){const _0xf66857=_0xcab4db;if(debugging)_0x12716e[_0xf66857(0x1da)]('-d');let _0x217b8b=![];const _0x670c52=_0x12716e[0x0];_0x2aa223={..._0x2aa223,'stdio':[_0xf66857(0x208),_0xf66857(0x208),_0xf66857(0x208),_0xf66857(0x295)]},pid[_0x670c52]=childProcess[_0xf66857(0x2f1)](botfile,_0x12716e,_0x2aa223),pid[_0x670c52]['on']('message',_0x5ec7c0=>{const _0x1084c8=_0xf66857;switch(Object[_0x1084c8(0x1e3)](_0x5ec7c0)[0x0]){case _0x1084c8(0x1c4):updateBotName(_0x670c52,_0x5ec7c0[_0x1084c8(0x1c4)]);break;case _0x1084c8(0x183):updateBotManager();break;case _0x1084c8(0x1c9):updateStatus(_0x670c52,_0x5ec7c0['status']);break;case _0x1084c8(0x245):updateLive(_0x670c52,_0x5ec7c0[_0x1084c8(0x245)]);break;case _0x1084c8(0x277):updateLive(_0x670c52,_0x5ec7c0['started']),io['to'](_0x670c52)[_0x1084c8(0x1ab)](_0x1084c8(0x1c9),{'access':{'allow':![],'reason':_0x1084c8(0x29f),'token':null}});break;case'stop':_0x5ec7c0['stop']==_0x1084c8(0x17d)&&restartBot(_0x670c52);_0x5ec7c0[_0x1084c8(0x21c)]=='kill'&&toggleBot(_0x670c52,_0x1084c8(0x2e2),_0x1084c8(0x265));break;case _0x1084c8(0x20d):sendTelegram(_0x670c52,_0x5ec7c0[_0x1084c8(0x20d)]);break;case _0x1084c8(0x1e4):sendTelegramMsg(_0x5ec7c0['telegrammsg']);break;case _0x1084c8(0x293):io['to'](_0x670c52)[_0x1084c8(0x1ab)](_0x5ec7c0['function'],_0x5ec7c0[_0x1084c8(0x236)]);break;}}),pid[_0x670c52]['on'](_0xf66857(0x1c2),function(_0x1de838){if(_0x217b8b)return;_0x217b8b=!![],_0x21e861(_0x1de838);}),pid[_0x670c52]['on'](_0xf66857(0x2e4),async function(_0x20121e){const _0x386609=_0xf66857;if(installingUpdate)return;if(_0x217b8b)return;_0x217b8b=!![],_0x21e861(null);const _0x16c0cc=dbConfig[_0x386609(0x2e6)](_0x386609(0x2d8))[_0x386609(0x288)]({'botID':_0x670c52})[_0x386609(0x191)]();_0x16c0cc&&(_0x16c0cc[_0x386609(0x1c9)]==_0x386609(0x2d0)||_0x16c0cc[_0x386609(0x1c9)]==_0x386609(0x170))&&(await sleep(0x3e8),updateLive(_0x670c52,_0x386609(0x265)),logger[_0x386609(0x1b6)](_0x386609(0x162)+_0x670c52),startBot([_0x670c52,userID],{'cwd':bbpath},function(_0x4733ed){if(_0x4733ed)logger['full'](_0x4733ed);}));});}function stopBot(_0x1a3a2b){const _0x1f7946=_0xcab4db;getClientsWithBotID(_0x1a3a2b)[_0x1f7946(0x2a9)](_0x4e08ea=>{const _0x18590f=_0x1f7946;getSocket(_0x4e08ea['id'])[_0x18590f(0x2ae)](!![]),removeClient(_0x4e08ea['id']);}),pid[_0x1a3a2b]&&(pid[_0x1a3a2b][_0x1f7946(0x286)](),pid[_0x1a3a2b]=null);}function restartBot(_0x4763b7){const _0x2735e6=_0xcab4db;if(pid[_0x4763b7])pid[_0x4763b7][_0x2735e6(0x286)]();}function addBot(){const _0x3443c5=_0xcab4db;let _0x347a13;for(let _0x1b07a9=0x1;_0x1b07a9<0x3e9;_0x1b07a9++){_0x347a13=_0x1b07a9[_0x3443c5(0x262)]()[_0x3443c5(0x267)](0x3,'0');let _0x462257=config['find'](_0x47dffe=>_0x47dffe[_0x3443c5(0x315)]==_0x347a13);if(!_0x462257)break;}if(_0x347a13===_0x3443c5(0x1bc)){logger[_0x3443c5(0x1b6)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x3443c5(0x1b6)](_0x3443c5(0x238)+_0x347a13),dbConfig[_0x3443c5(0x2e6)]('bots')[_0x3443c5(0x1da)]({'botID':_0x347a13,'botname':'Bot\x20'+_0x347a13,'status':_0x3443c5(0x170),'live':''})['write'](),startBot([_0x347a13,userID],{'cwd':bbpath},function(_0x5a77ac){const _0x3c0872=_0x3443c5;if(_0x5a77ac)logger[_0x3c0872(0x1b6)](_0x5a77ac);}),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x3443c5(0x2d8),JSON[_0x3443c5(0x242)](config));}function deleteBot(_0x55293d){const _0x332bf4=_0xcab4db;getClientsWithBotID(_0x55293d)['forEach'](_0xedf998=>{const _0x24f867=_0x4e8e;getSocket(_0xedf998['id'])[_0x24f867(0x2ae)](!![]),removeClient(_0xedf998['id']);}),dbConfig[_0x332bf4(0x2e6)]('bots')['remove']({'botID':_0x55293d})[_0x332bf4(0x275)](),logger['full']('Deleted\x20Bot\x20'+_0x55293d),stopBot(_0x55293d);try{if(fs[_0x332bf4(0x201)](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+_0x332bf4(0x2cb))))fs['unlinkSync'](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+_0x332bf4(0x2cb)));if(fs[_0x332bf4(0x201)](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+_0x332bf4(0x2bc))))fs['unlinkSync'](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+_0x332bf4(0x2bc)));if(fs[_0x332bf4(0x201)](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+_0x332bf4(0x272))))fs['unlinkSync'](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+_0x332bf4(0x272)));if(fs[_0x332bf4(0x201)](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+'-results.json')))fs[_0x332bf4(0x24d)](path[_0x332bf4(0x190)](configpath,_0x332bf4(0x2d4)+_0x55293d+'-results.json'));}catch(_0x6f8e88){if(_0x6f8e88)logger[_0x332bf4(0x1b6)](_0x332bf4(0x177),_0x6f8e88);}config=getConfiguration(),io['to'](_0x332bf4(0x217))[_0x332bf4(0x1ab)](_0x332bf4(0x2d8),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x250370,_0x1715e6,_0x542c33){const _0x490c91=_0xcab4db;dbConfig[_0x490c91(0x2e6)](_0x490c91(0x2d8))['find']({'botID':_0x250370})[_0x490c91(0x211)]({'status':_0x1715e6})[_0x490c91(0x211)]({'live':_0x542c33})[_0x490c91(0x275)]();if(_0x1715e6==_0x490c91(0x2d0)||_0x1715e6==_0x490c91(0x170))logger['full'](_0x490c91(0x290)+_0x250370),startBot([_0x250370,userID],{'cwd':bbpath},function(_0x419530){const _0x81f29e=_0x490c91;if(_0x419530)logger[_0x81f29e(0x1b6)](_0x419530);});else(_0x1715e6==_0x490c91(0x2e2)||_0x1715e6==_0x490c91(0x199))&&(logger[_0x490c91(0x1b6)](_0x490c91(0x2a5)+_0x250370),stopBot(_0x250370));config=getConfiguration(),io['to']('botmanager')[_0x490c91(0x1ab)](_0x490c91(0x2d8),config),broadcastToBots(_0x490c91(0x2d8),JSON['stringify'](config));}function toggleStatus(_0x4efa9d){const _0x3089d6=_0xcab4db;let _0x53f0c3=dbConfig[_0x3089d6(0x2e6)]('bots')[_0x3089d6(0x288)]({'botID':_0x4efa9d})[_0x3089d6(0x191)](),_0x230b7e;if(_0x53f0c3[_0x3089d6(0x1c9)]==='enabled')_0x230b7e='disabled';else{if(_0x53f0c3[_0x3089d6(0x1c9)]===_0x3089d6(0x170))_0x230b7e='new-disabled';else{if(_0x53f0c3['status']===_0x3089d6(0x199))_0x230b7e=_0x3089d6(0x170);else{if(_0x53f0c3['status']==='disabled')_0x230b7e=_0x3089d6(0x2d0);}}}return _0x230b7e;}function updateStatus(_0x28508e,_0x4c129c){const _0xc683a2=_0xcab4db;dbConfig['get'](_0xc683a2(0x2d8))[_0xc683a2(0x288)]({'botID':_0x28508e})[_0xc683a2(0x211)]({'status':_0x4c129c})[_0xc683a2(0x275)](),config=getConfiguration(),io['to'](_0xc683a2(0x217))[_0xc683a2(0x1ab)](_0xc683a2(0x2d8),config),broadcastToBots(_0xc683a2(0x2d8),JSON[_0xc683a2(0x242)](config));}function updateLive(_0x1e1cb0,_0x2967d3){const _0x58f197=_0xcab4db;dbConfig['get']('bots')[_0x58f197(0x288)]({'botID':_0x1e1cb0})[_0x58f197(0x211)]({'live':_0x2967d3})[_0x58f197(0x275)](),config=getConfiguration(),io['to']('botmanager')[_0x58f197(0x1ab)](_0x58f197(0x2d8),config),broadcastToBots('bots',JSON[_0x58f197(0x242)](config));}function updateBotName(_0xf9bcc8,_0x1ce85d){const _0x49107f=_0xcab4db;dbConfig[_0x49107f(0x2e6)](_0x49107f(0x2d8))[_0x49107f(0x288)]({'botID':_0xf9bcc8})[_0x49107f(0x211)]({'botname':_0x1ce85d})[_0x49107f(0x275)](),config=getConfiguration(),io['to'](_0x49107f(0x217))['emit'](_0x49107f(0x2d8),config),broadcastToBots('bots',JSON[_0x49107f(0x242)](config));}function updateBotManager(){const _0x4f3e40=_0xcab4db;config=getConfiguration(),io['to'](_0x4f3e40(0x217))[_0x4f3e40(0x1ab)](_0x4f3e40(0x2d8),config),broadcastToBots(_0x4f3e40(0x2d8),JSON[_0x4f3e40(0x242)](config));}function toggleBotMode(_0x4cc588){const _0x97a8db=_0xcab4db;if(pid[_0x4cc588])pid[_0x4cc588]['send']({'function':'toggleBotMode','args':null});else{const _0x45404b=configpath+'bot-'+_0x4cc588+_0x97a8db(0x2cb),_0x482514=fs['readFileSync'](_0x45404b),_0x103c6d=JSON[_0x97a8db(0x2fe)](_0x482514),_0x1053e1=_0x103c6d[_0x97a8db(0x308)][0x0][_0x97a8db(0x1ce)];_0x103c6d[_0x97a8db(0x308)][0x0]['headless']=!_0x1053e1;const _0x386f4f=JSON[_0x97a8db(0x242)](_0x103c6d,null,0x2);fs[_0x97a8db(0x29e)](_0x45404b,_0x386f4f),config=getConfiguration(),io['to'](_0x97a8db(0x217))['emit'](_0x97a8db(0x2d8),config),broadcastToBots(_0x97a8db(0x2d8),JSON[_0x97a8db(0x242)](config));}}function telegramError(_0x3eec03){const _0x4b0ac7=_0xcab4db;logger[_0x4b0ac7(0x28e)](getTimeStamp()+_0x4b0ac7(0x22c));}function validateTelegram(_0x18771d){const _0x596169=_0xcab4db;if(_0x18771d[_0x596169(0x30c)][_0x596169(0x1d5)]!=settings[_0x596169(0x26a)]&&'@'+_0x18771d[_0x596169(0x30c)][_0x596169(0x1d5)]!=settings[_0x596169(0x26a)])return tgBot[_0x596169(0x2b4)](_0x18771d[_0x596169(0x1b4)]['id'],_0x596169(0x299),{'parse_mode':_0x596169(0x2a0)})[_0x596169(0x27c)](_0x506d0e=>{telegramError(_0x506d0e);}),![];return!![];}async function initTelegram(){const _0x1bca38=_0xcab4db;if(tgBot)tgBot[_0x1bca38(0x19f)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1bca38(0x197)],{'polling':!![]});let _0x1cc1f5=_0x1bca38(0x24c);_0x1cc1f5+='\x0a',_0x1cc1f5+=_0x1bca38(0x28d),_0x1cc1f5+=_0x1bca38(0x2ba),_0x1cc1f5+=_0x1bca38(0x2b9),_0x1cc1f5+=_0x1bca38(0x2a8),_0x1cc1f5+=_0x1bca38(0x1c8),_0x1cc1f5+=_0x1bca38(0x231),_0x1cc1f5+=_0x1bca38(0x321),_0x1cc1f5+=_0x1bca38(0x31b),_0x1cc1f5+=_0x1bca38(0x2b0),_0x1cc1f5+=_0x1bca38(0x1aa),_0x1cc1f5+=_0x1bca38(0x16a),_0x1cc1f5+=_0x1bca38(0x182),_0x1cc1f5+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x1cc1f5+=_0x1bca38(0x2e7);let _0x2eca60='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2eca60+='\x0a',_0x2eca60+=_0x1cc1f5,tgBot[_0x1bca38(0x20f)](/\/start/,_0x329f60=>{const _0x3c0dd9=_0x1bca38;if(!validateTelegram(_0x329f60))return;if(settings[_0x3c0dd9(0x1ca)]!=_0x329f60[_0x3c0dd9(0x1b4)]['id'])updateSetting(_0x3c0dd9(0x1ca),_0x329f60['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x3c0dd9(0x2b4)](_0x329f60[_0x3c0dd9(0x1b4)]['id'],_0x2eca60)[_0x3c0dd9(0x27c)](_0x5c4d5b=>{telegramError(_0x5c4d5b);});}),tgBot[_0x1bca38(0x20f)](/\/enable/,_0x1afb13=>{const _0x88447c=_0x1bca38;if(!validateTelegram(_0x1afb13))return;if(settings[_0x88447c(0x1ca)]!=_0x1afb13[_0x88447c(0x1b4)]['id'])updateSetting('telegramChatId',_0x1afb13[_0x88447c(0x1b4)]['id']);updateSetting(_0x88447c(0x1d9),!![]),tgBot['sendMessage'](_0x1afb13[_0x88447c(0x1b4)]['id'],_0x88447c(0x2bd))[_0x88447c(0x27c)](_0x23b636=>{telegramError(_0x23b636);});}),tgBot['onText'](/\/config/,async _0x44e7f7=>{const _0xdb960d=_0x1bca38;if(!validateTelegram(_0x44e7f7))return;tgBot[_0xdb960d(0x218)](_0xdb960d(0x229)),tgBot[_0xdb960d(0x2b4)](_0x44e7f7[_0xdb960d(0x1b4)]['id'],_0xdb960d(0x296),{'reply_markup':{'inline_keyboard':[[{'text':_0xdb960d(0x18b),'callback_data':'orders'},{'text':_0xdb960d(0x215),'callback_data':'alerts'},{'text':_0xdb960d(0x1af),'callback_data':_0xdb960d(0x31c)}]]}})[_0xdb960d(0x27c)](_0x5daed1=>{telegramError(_0x5daed1);}),tgBot['on'](_0xdb960d(0x229),async _0x57cf2c=>{const _0x41f22a=_0xdb960d,_0x138ea5=_0x57cf2c[_0x41f22a(0x246)],_0x4606f4=_0x57cf2c['message'];tgBot[_0x41f22a(0x23a)](_0x57cf2c['id'])[_0x41f22a(0x1eb)](async()=>{const _0x401fcd=_0x41f22a;_0x138ea5==_0x401fcd(0x164)&&(updateSetting(_0x401fcd(0x278),_0x401fcd(0x164)),updateSetting(_0x401fcd(0x1d9),!![]),await tgBot[_0x401fcd(0x2b4)](_0x4606f4['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x401fcd(0x27c)](_0x48c237=>{telegramError(_0x48c237);}));_0x138ea5==_0x401fcd(0x202)&&(updateSetting(_0x401fcd(0x278),_0x401fcd(0x202)),updateSetting(_0x401fcd(0x1d9),!![]),await tgBot['sendMessage'](_0x4606f4[_0x401fcd(0x1b4)]['id'],_0x401fcd(0x28f))['catch'](_0x288bef=>{telegramError(_0x288bef);}));_0x138ea5==_0x401fcd(0x31c)&&(updateSetting(_0x401fcd(0x278),_0x401fcd(0x31c)),updateSetting(_0x401fcd(0x1d9),!![]),await tgBot['sendMessage'](_0x4606f4[_0x401fcd(0x1b4)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x401fcd(0x27c)](_0x4b4f35=>{telegramError(_0x4b4f35);}));if(!settings['telegramChatId'])tgBot[_0x401fcd(0x2b4)](_0x4606f4[_0x401fcd(0x1b4)]['id'],_0x401fcd(0x2c0))[_0x401fcd(0x27c)](_0x4beb35=>{telegramError(_0x4beb35);});}),tgBot[_0x41f22a(0x218)]('callback_query');});}),tgBot[_0x1bca38(0x20f)](/\/status/,_0x524c24=>{const _0x18a13e=_0x1bca38;if(!validateTelegram(_0x524c24))return;const _0x3b40cd=getBotsWithMode();let _0x99a142=_0x18a13e(0x1c7);config[_0x18a13e(0x2a9)](_0x37025d=>{const _0x2f268e=_0x18a13e,_0x556b7e=_0x3b40cd[_0x2f268e(0x288)](_0x208026=>_0x208026['botID']==_0x37025d[_0x2f268e(0x315)])[_0x2f268e(0x1cd)];_0x99a142+=_0x2f268e(0x2ea)+_0x37025d['botID']+':\x20'+_0x37025d[_0x2f268e(0x1c9)]+'\x20|\x20'+_0x556b7e+_0x2f268e(0x22b)+_0x37025d['live']+'\x0a';}),_0x99a142+='\x0a',_0x99a142+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x99a142+=!settings[_0x18a13e(0x1d9)]?_0x18a13e(0x2f0):_0x18a13e(0x235),_0x99a142+=settings[_0x18a13e(0x1d9)]?settings[_0x18a13e(0x278)]==_0x18a13e(0x31c)?_0x18a13e(0x1ed):_0x18a13e(0x2ab)+settings['telegramEvents']+'\x20only\x0a':'',tgBot['sendMessage'](_0x524c24['chat']['id'],_0x99a142,{'parse_mode':_0x18a13e(0x2a0)})[_0x18a13e(0x27c)](_0x28be9b=>{telegramError(_0x28be9b);});}),tgBot[_0x1bca38(0x20f)](/\/restart/,_0x39802b=>{const _0x2a2ca4=_0x1bca38;if(!validateTelegram(_0x39802b))return;tgBot[_0x2a2ca4(0x218)](_0x2a2ca4(0x229));const _0x106e2f=getEnabledBots();if(_0x106e2f[_0x2a2ca4(0x1e2)]==0x0)tgBot['sendMessage'](_0x39802b[_0x2a2ca4(0x1b4)]['id'],_0x2a2ca4(0x31f))[_0x2a2ca4(0x27c)](_0x452024=>{telegramError(_0x452024);});else{if(_0x106e2f[_0x2a2ca4(0x1e2)]>0x1)_0x106e2f[_0x2a2ca4(0x1da)]({'botID':_0x2a2ca4(0x31c)});let _0x23eca5=[],_0x367cf4=[];const _0x49ef3a=_0x106e2f[_0x2a2ca4(0x1e2)]%0x4==0x0||_0x106e2f[_0x2a2ca4(0x1e2)]%0x4==0x3||_0x106e2f['length']%0x3==0x1?0x4:0x3;let _0x8f76aa=0x0;_0x106e2f[_0x2a2ca4(0x2a9)]((_0x293887,_0x1223eb)=>{const _0x52f8fd=_0x2a2ca4;if(_0x1223eb%_0x49ef3a==0x0)_0x367cf4=[];_0x367cf4['push']({'text':_0x293887[_0x52f8fd(0x315)]==_0x52f8fd(0x31c)?'All\x20bots':_0x52f8fd(0x2ea)+_0x293887[_0x52f8fd(0x315)],'callback_data':_0x293887['botID']}),_0x1223eb%_0x49ef3a==0x0&&(_0x23eca5[_0x8f76aa]=_0x367cf4,_0x8f76aa++);}),tgBot[_0x2a2ca4(0x2b4)](_0x39802b['chat']['id'],_0x2a2ca4(0x16e),{'reply_markup':{'inline_keyboard':_0x23eca5}})[_0x2a2ca4(0x27c)](_0x5ce3f2=>{telegramError(_0x5ce3f2);}),tgBot['on'](_0x2a2ca4(0x229),async _0x2216a0=>{const _0x1b3cb1=_0x2a2ca4,_0x7c9a3a=_0x2216a0[_0x1b3cb1(0x246)],_0xf670af=_0x2216a0['message'];tgBot[_0x1b3cb1(0x23a)](_0x2216a0['id'])[_0x1b3cb1(0x1eb)](async()=>{const _0x525938=_0x1b3cb1;_0x7c9a3a==_0x525938(0x31c)?config[_0x525938(0x2a9)](_0x2990df=>{const _0x2b2876=_0x525938;restartBot(_0x2990df[_0x2b2876(0x315)]);}):restartBot(_0x7c9a3a);}),tgBot['removeListener'](_0x1b3cb1(0x229));});}}),tgBot[_0x1bca38(0x20f)](/\/on/,_0x34cafd=>{const _0x5310c4=_0x1bca38;if(!validateTelegram(_0x34cafd))return;tgBot['removeListener'](_0x5310c4(0x229));const _0x5a9624=getDisabledBots();if(_0x5a9624[_0x5310c4(0x1e2)]==0x0)tgBot[_0x5310c4(0x2b4)](_0x34cafd[_0x5310c4(0x1b4)]['id'],_0x5310c4(0x2b8))[_0x5310c4(0x27c)](_0x42b5be=>{telegramError(_0x42b5be);});else{if(_0x5a9624['length']>0x1)_0x5a9624[_0x5310c4(0x1da)]({'botID':_0x5310c4(0x31c)});let _0x27568b=[],_0x25702a=[];const _0x1ad630=_0x5a9624[_0x5310c4(0x1e2)]%0x4==0x0||_0x5a9624[_0x5310c4(0x1e2)]%0x4==0x3||_0x5a9624[_0x5310c4(0x1e2)]%0x3==0x1?0x4:0x3;let _0x27cada=0x0;_0x5a9624[_0x5310c4(0x2a9)]((_0x4f76f5,_0x108f4c)=>{const _0x386c70=_0x5310c4;if(_0x108f4c%_0x1ad630==0x0)_0x25702a=[];_0x25702a[_0x386c70(0x1da)]({'text':_0x4f76f5['botID']==_0x386c70(0x31c)?_0x386c70(0x2d9):'Bot\x20'+_0x4f76f5[_0x386c70(0x315)],'callback_data':_0x4f76f5['botID']}),_0x108f4c%_0x1ad630==0x0&&(_0x27568b[_0x27cada]=_0x25702a,_0x27cada++);}),tgBot[_0x5310c4(0x2b4)](_0x34cafd[_0x5310c4(0x1b4)]['id'],_0x5310c4(0x2be),{'reply_markup':{'inline_keyboard':_0x27568b}})[_0x5310c4(0x27c)](_0xe5ee6e=>{telegramError(_0xe5ee6e);}),tgBot['on'](_0x5310c4(0x229),async _0x3455ee=>{const _0x372df5=_0x5310c4,_0x170ffb=_0x3455ee[_0x372df5(0x246)],_0x26da9c=_0x3455ee['message'];tgBot[_0x372df5(0x23a)](_0x3455ee['id'])[_0x372df5(0x1eb)](async()=>{const _0x401772=_0x372df5;_0x170ffb=='all'?(tgBot[_0x401772(0x2b4)](_0x26da9c[_0x401772(0x1b4)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x401772(0x27c)](_0x13c637=>{telegramError(_0x13c637);}),_0x5a9624[_0x401772(0x2a9)](_0x3cbaa0=>{const _0xfe439f=_0x401772;if(_0x3cbaa0[_0xfe439f(0x315)]!=_0xfe439f(0x31c))toggleBot(_0x3cbaa0[_0xfe439f(0x315)],toggleStatus(_0x3cbaa0['botID']),_0xfe439f(0x265));})):(tgBot[_0x401772(0x2b4)](_0x26da9c[_0x401772(0x1b4)]['id'],_0x401772(0x1ae)+_0x170ffb)[_0x401772(0x27c)](_0x448e5a=>{telegramError(_0x448e5a);}),toggleBot(_0x170ffb,toggleStatus(_0x170ffb),_0x401772(0x265)));}),tgBot[_0x372df5(0x218)](_0x372df5(0x229));});}}),tgBot['onText'](/\/off/,_0x205330=>{const _0x143ab4=_0x1bca38;if(!validateTelegram(_0x205330))return;tgBot[_0x143ab4(0x218)](_0x143ab4(0x229));const _0x4922cc=getEnabledBots();if(_0x4922cc[_0x143ab4(0x1e2)]==0x0)tgBot[_0x143ab4(0x2b4)](_0x205330['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x143ab4(0x27c)](_0x4ebcac=>{telegramError(_0x4ebcac);});else{if(_0x4922cc[_0x143ab4(0x1e2)]>0x1)_0x4922cc[_0x143ab4(0x1da)]({'botID':_0x143ab4(0x31c)});let _0x2fc32b=[],_0x303c47=[];const _0x12f15a=_0x4922cc[_0x143ab4(0x1e2)]%0x4==0x0||_0x4922cc[_0x143ab4(0x1e2)]%0x4==0x3||_0x4922cc[_0x143ab4(0x1e2)]%0x3==0x1?0x4:0x3;let _0x43d132=0x0;_0x4922cc[_0x143ab4(0x2a9)]((_0x2e6d19,_0x3461b4)=>{const _0x1c4cfb=_0x143ab4;if(_0x3461b4%_0x12f15a==0x0)_0x303c47=[];_0x303c47[_0x1c4cfb(0x1da)]({'text':_0x2e6d19[_0x1c4cfb(0x315)]=='all'?_0x1c4cfb(0x2d9):_0x1c4cfb(0x2ea)+_0x2e6d19[_0x1c4cfb(0x315)],'callback_data':_0x2e6d19['botID']}),_0x3461b4%_0x12f15a==0x0&&(_0x2fc32b[_0x43d132]=_0x303c47,_0x43d132++);}),tgBot[_0x143ab4(0x2b4)](_0x205330['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x2fc32b}})['catch'](_0x243987=>{telegramError(_0x243987);}),tgBot['on'](_0x143ab4(0x229),async _0x2c3f09=>{const _0x1cce63=_0x143ab4,_0xa9e38e=_0x2c3f09[_0x1cce63(0x246)],_0xe19c6a=_0x2c3f09[_0x1cce63(0x2c5)];tgBot[_0x1cce63(0x23a)](_0x2c3f09['id'])[_0x1cce63(0x1eb)](async()=>{const _0x159af8=_0x1cce63;_0xa9e38e==_0x159af8(0x31c)?(tgBot[_0x159af8(0x2b4)](_0xe19c6a['chat']['id'],_0x159af8(0x21b))[_0x159af8(0x27c)](_0x221ed3=>{telegramError(_0x221ed3);}),_0x4922cc[_0x159af8(0x2a9)](_0x469798=>{const _0xb64f9=_0x159af8;if(_0x469798[_0xb64f9(0x315)]!='all')toggleBot(_0x469798[_0xb64f9(0x315)],toggleStatus(_0x469798[_0xb64f9(0x315)]),_0xb64f9(0x265));})):(tgBot['sendMessage'](_0xe19c6a[_0x159af8(0x1b4)]['id'],_0x159af8(0x2de)+_0xa9e38e)[_0x159af8(0x27c)](_0x39416=>{telegramError(_0x39416);}),toggleBot(_0xa9e38e,toggleStatus(_0xa9e38e),_0x159af8(0x265)));}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/metrics/,_0x5c4e3d=>{const _0x6f2a27=_0x1bca38;if(!validateTelegram(_0x5c4e3d))return;tgBot['removeListener']('callback_query');const _0x411b3f=getEnabledBots();if(_0x411b3f[_0x6f2a27(0x1e2)]==0x0)tgBot['sendMessage'](_0x5c4e3d['chat']['id'],_0x6f2a27(0x31f))[_0x6f2a27(0x27c)](_0x5ddc91=>{telegramError(_0x5ddc91);});else{if(_0x411b3f[_0x6f2a27(0x1e2)]>0x1){let _0xbfa537=[],_0x2cebe9=[];const _0x78c7d6=_0x411b3f[_0x6f2a27(0x1e2)]%0x4==0x0||_0x411b3f[_0x6f2a27(0x1e2)]%0x4==0x3||_0x411b3f[_0x6f2a27(0x1e2)]%0x3==0x1?0x4:0x3;let _0xb69ceb=0x0;_0x411b3f[_0x6f2a27(0x2a9)]((_0x1861f9,_0xb5a87f)=>{const _0x34922e=_0x6f2a27;if(_0xb5a87f%_0x78c7d6==0x0)_0x2cebe9=[];_0x2cebe9[_0x34922e(0x1da)]({'text':_0x34922e(0x2ea)+_0x1861f9[_0x34922e(0x315)],'callback_data':_0x1861f9['botID']}),_0xb5a87f%_0x78c7d6==0x0&&(_0xbfa537[_0xb69ceb]=_0x2cebe9,_0xb69ceb++);}),tgBot[_0x6f2a27(0x2b4)](_0x5c4e3d[_0x6f2a27(0x1b4)]['id'],_0x6f2a27(0x179),{'reply_markup':{'inline_keyboard':_0xbfa537}})[_0x6f2a27(0x27c)](_0x37a848=>{telegramError(_0x37a848);}),tgBot['on']('callback_query',async _0x3a3813=>{const _0x27f119=_0x6f2a27,_0x52c324=_0x3a3813[_0x27f119(0x246)],_0x371412=_0x3a3813[_0x27f119(0x2c5)];tgBot[_0x27f119(0x23a)](_0x3a3813['id'])[_0x27f119(0x1eb)](async()=>{const _0x2597a3=_0x27f119;if(pid[_0x52c324])pid[_0x52c324][_0x2597a3(0x219)]({'function':_0x2597a3(0x1c1),'args':null});}),tgBot[_0x27f119(0x218)](_0x27f119(0x229));});}else{const _0x59c4cb=_0x411b3f[0x0][_0x6f2a27(0x315)];if(pid[_0x59c4cb])pid[_0x59c4cb][_0x6f2a27(0x219)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x1bca38(0x20f)](/\/portfolio/,_0x5eeb3b=>{const _0x3ff4c2=_0x1bca38;if(!validateTelegram(_0x5eeb3b))return;tgBot['removeListener'](_0x3ff4c2(0x229));const _0x5f1506=getEnabledBots();if(_0x5f1506[_0x3ff4c2(0x1e2)]==0x0)tgBot['sendMessage'](_0x5eeb3b['chat']['id'],_0x3ff4c2(0x31f))['catch'](_0x1791f3=>{telegramError(_0x1791f3);});else{if(_0x5f1506['length']>0x1){let _0x1b0f27=[],_0x42dd6d=[];const _0x56fc13=_0x5f1506['length']%0x4==0x0||_0x5f1506[_0x3ff4c2(0x1e2)]%0x4==0x3||_0x5f1506[_0x3ff4c2(0x1e2)]%0x3==0x1?0x4:0x3;let _0x2142b0=0x0;_0x5f1506[_0x3ff4c2(0x2a9)]((_0x819295,_0x49fa91)=>{const _0x1858d7=_0x3ff4c2;if(_0x49fa91%_0x56fc13==0x0)_0x42dd6d=[];_0x42dd6d[_0x1858d7(0x1da)]({'text':_0x1858d7(0x2ea)+_0x819295[_0x1858d7(0x315)],'callback_data':_0x819295[_0x1858d7(0x315)]}),_0x49fa91%_0x56fc13==0x0&&(_0x1b0f27[_0x2142b0]=_0x42dd6d,_0x2142b0++);}),tgBot[_0x3ff4c2(0x2b4)](_0x5eeb3b[_0x3ff4c2(0x1b4)]['id'],_0x3ff4c2(0x1ec),{'reply_markup':{'inline_keyboard':_0x1b0f27}})['catch'](_0x1e633e=>{telegramError(_0x1e633e);}),tgBot['on'](_0x3ff4c2(0x229),async _0x228622=>{const _0x36e86f=_0x3ff4c2,_0x3a455b=_0x228622[_0x36e86f(0x246)],_0x21e7ff=_0x228622[_0x36e86f(0x2c5)];tgBot[_0x36e86f(0x23a)](_0x228622['id'])[_0x36e86f(0x1eb)](async()=>{const _0x53152f=_0x36e86f;if(pid[_0x3a455b])pid[_0x3a455b][_0x53152f(0x219)]({'function':_0x53152f(0x26f),'args':null});}),tgBot[_0x36e86f(0x218)](_0x36e86f(0x229));});}else{const _0x47ae41=_0x5f1506[0x0][_0x3ff4c2(0x315)];if(pid[_0x47ae41])pid[_0x47ae41][_0x3ff4c2(0x219)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x1bca38(0x20f)](/\/update/,async _0x48fdef=>{const _0x27b305=_0x1bca38;if(!validateTelegram(_0x48fdef))return;tgBot[_0x27b305(0x218)](_0x27b305(0x229)),await getMessages();if(!updateAvailable)tgBot[_0x27b305(0x2b4)](_0x48fdef[_0x27b305(0x1b4)]['id'],_0x27b305(0x2cc))[_0x27b305(0x27c)](_0x1cd505=>{telegramError(_0x1cd505);});else!validInstallation?tgBot[_0x27b305(0x2b4)](_0x48fdef[_0x27b305(0x1b4)]['id'],_0x27b305(0x1d4))[_0x27b305(0x27c)](_0x48a5fe=>{telegramError(_0x48a5fe);}):(tgBot[_0x27b305(0x2b4)](_0x48fdef[_0x27b305(0x1b4)]['id'],_0x27b305(0x16f),{'reply_markup':{'inline_keyboard':[[{'text':_0x27b305(0x17c),'callback_data':_0x27b305(0x161)},{'text':'No','callback_data':'no'}]]}})[_0x27b305(0x27c)](_0x156a78=>{telegramError(_0x156a78);}),tgBot['on'](_0x27b305(0x229),async _0x5b6e6f=>{const _0x195b16=_0x27b305,_0x1c7569=_0x5b6e6f[_0x195b16(0x246)],_0x516289=_0x5b6e6f[_0x195b16(0x2c5)];tgBot[_0x195b16(0x23a)](_0x5b6e6f['id'])[_0x195b16(0x1eb)](async()=>{const _0x423540=_0x195b16;_0x1c7569==_0x423540(0x161)&&(await tgBot[_0x423540(0x2b4)](_0x516289[_0x423540(0x1b4)]['id'],_0x423540(0x210))[_0x423540(0x27c)](_0x4cb5cd=>{telegramError(_0x4cb5cd);}),updateBB(_0x423540(0x284))),_0x1c7569=='no'&&await tgBot[_0x423540(0x2b4)](_0x516289[_0x423540(0x1b4)]['id'],_0x423540(0x1d8))[_0x423540(0x27c)](_0x4ad514=>{telegramError(_0x4ad514);});}),tgBot[_0x195b16(0x218)](_0x195b16(0x229));}));}),tgBot[_0x1bca38(0x20f)](/\/reinstall/,async _0x4c60ba=>{const _0x593f0a=_0x1bca38;if(!validateTelegram(_0x4c60ba))return;tgBot[_0x593f0a(0x218)](_0x593f0a(0x229)),!validInstallation?tgBot['sendMessage'](_0x4c60ba[_0x593f0a(0x1b4)]['id'],_0x593f0a(0x1b9))[_0x593f0a(0x27c)](_0x1a78f7=>{telegramError(_0x1a78f7);}):(tgBot['sendMessage'](_0x4c60ba[_0x593f0a(0x1b4)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x593f0a(0x17c),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x593f0a(0x27c)](_0xb114ee=>{telegramError(_0xb114ee);}),tgBot['on'](_0x593f0a(0x229),async _0x4b2e9a=>{const _0x37e883=_0x593f0a,_0x2ed883=_0x4b2e9a[_0x37e883(0x246)],_0x17312d=_0x4b2e9a[_0x37e883(0x2c5)];tgBot['answerCallbackQuery'](_0x4b2e9a['id'])[_0x37e883(0x1eb)](async()=>{const _0x2e84f6=_0x37e883;_0x2ed883==_0x2e84f6(0x161)&&(await tgBot[_0x2e84f6(0x2b4)](_0x17312d[_0x2e84f6(0x1b4)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x2e84f6(0x27c)](_0x46bf01=>{telegramError(_0x46bf01);}),updateBB(_0x2e84f6(0x1db))),_0x2ed883=='no'&&await tgBot['sendMessage'](_0x17312d[_0x2e84f6(0x1b4)]['id'],_0x2e84f6(0x304))['catch'](_0x50719d=>{telegramError(_0x50719d);});}),tgBot[_0x37e883(0x218)](_0x37e883(0x229));}));}),tgBot[_0x1bca38(0x20f)](/\/toggle/,_0x178351=>{const _0x26fbec=_0x1bca38;if(!validateTelegram(_0x178351))return;tgBot['removeListener'](_0x26fbec(0x229));const _0x491eba=getBotsWithMode();if(_0x491eba[_0x26fbec(0x1e2)]==0x0)tgBot[_0x26fbec(0x2b4)](_0x178351[_0x26fbec(0x1b4)]['id'],_0x26fbec(0x31f))[_0x26fbec(0x27c)](_0x11a12d=>{telegramError(_0x11a12d);});else{let _0x4b8e10=[],_0x1190f4=[];const _0x4ffe95=0x2;let _0x42b75e=0x0;_0x491eba[_0x26fbec(0x2a9)]((_0x5e059d,_0x3ae4b9)=>{const _0x4f71bd=_0x26fbec;if(_0x3ae4b9%_0x4ffe95==0x0)_0x1190f4=[];_0x1190f4[_0x4f71bd(0x1da)]({'text':_0x4f71bd(0x2ea)+_0x5e059d[_0x4f71bd(0x315)]+'\x20('+_0x5e059d[_0x4f71bd(0x1cd)]+')','callback_data':_0x5e059d[_0x4f71bd(0x315)]}),_0x3ae4b9%_0x4ffe95==0x0&&(_0x4b8e10[_0x42b75e]=_0x1190f4,_0x42b75e++);}),tgBot[_0x26fbec(0x2b4)](_0x178351[_0x26fbec(0x1b4)]['id'],_0x26fbec(0x1f4),{'reply_markup':{'inline_keyboard':_0x4b8e10}})[_0x26fbec(0x27c)](_0x40267b=>{telegramError(_0x40267b);}),tgBot['on'](_0x26fbec(0x229),async _0x33c30e=>{const _0x2bb62e=_0x26fbec,_0x343c83=_0x33c30e['data'],_0x173f04=_0x33c30e[_0x2bb62e(0x2c5)];tgBot['answerCallbackQuery'](_0x33c30e['id'])[_0x2bb62e(0x1eb)](async()=>{const _0x149201=_0x2bb62e,_0x467bb7=_0x491eba['find'](_0x4675a0=>_0x4675a0[_0x149201(0x315)]==_0x343c83),_0x4bed48=_0x467bb7[_0x149201(0x1cd)]=='auto'?_0x149201(0x25a):_0x149201(0x1ad);tgBot[_0x149201(0x2b4)](_0x173f04[_0x149201(0x1b4)]['id'],_0x149201(0x1a8)+_0x343c83+_0x149201(0x1ee)+_0x4bed48+_0x149201(0x1cf))[_0x149201(0x27c)](_0x55efce=>{telegramError(_0x55efce);}),toggleBotMode(_0x343c83);}),tgBot[_0x2bb62e(0x218)](_0x2bb62e(0x229));});}}),tgBot['onText'](/\/names/,_0x2f4085=>{const _0x30daee=_0x1bca38;if(!validateTelegram(_0x2f4085))return;let _0x50298d='';config[_0x30daee(0x2a9)](_0x292035=>{const _0x2316a0=_0x30daee;_0x50298d+='Bot\x20'+_0x292035[_0x2316a0(0x315)]+':\x20'+_0x292035[_0x2316a0(0x1c4)]+'\x0a';}),tgBot[_0x30daee(0x2b4)](_0x2f4085[_0x30daee(0x1b4)]['id'],_0x50298d,{'parse_mode':_0x30daee(0x2a0)})[_0x30daee(0x27c)](_0x45330b=>{telegramError(_0x45330b);});}),tgBot[_0x1bca38(0x20f)](/\/disable/,_0x3ad91b=>{const _0x1de67b=_0x1bca38;if(!validateTelegram(_0x3ad91b))return;tgBot[_0x1de67b(0x2b4)](_0x3ad91b[_0x1de67b(0x1b4)]['id'],_0x1de67b(0x1cc))[_0x1de67b(0x27c)](_0x34da0c=>{telegramError(_0x34da0c);}),updateSetting(_0x1de67b(0x1d9),![]);}),tgBot[_0x1bca38(0x20f)](/\/help/,_0x34b7b4=>{const _0x1f6699=_0x1bca38;if(!validateTelegram(_0x34b7b4))return;tgBot['sendMessage'](_0x34b7b4[_0x1f6699(0x1b4)]['id'],_0x1cc1f5)[_0x1f6699(0x27c)](_0xe5ff5a=>{telegramError(_0xe5ff5a);});}),tgBot['on']('polling_error',_0x43b412=>{const _0x5b1e06=_0x1bca38;_0x43b412[_0x5b1e06(0x262)]()[_0x5b1e06(0x1f6)](_0x5b1e06(0x313))&&(logger[_0x5b1e06(0x1b6)](_0x5b1e06(0x2bb)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x5b1e06(0x217))['emit'](_0x5b1e06(0x1ac),_0x5b1e06(0x2bb)));}),process[_0x1bca38(0x2e5)]('SIGINT',()=>{const _0xb5aaeb=_0x1bca38;if(tgBot)tgBot[_0xb5aaeb(0x19f)]();process[_0xb5aaeb(0x2e4)](0x1);}),process[_0x1bca38(0x2e5)](_0x1bca38(0x234),()=>{const _0xe5450a=_0x1bca38;if(tgBot)tgBot[_0xe5450a(0x19f)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x5b56fc,_0x2637f0){const _0x2c5249=_0xcab4db;if(settings[_0x2c5249(0x1d9)]){if(settings[_0x2c5249(0x278)]=='all'||(_0x2637f0[_0x2c5249(0x270)]=='error'||_0x2637f0[_0x2c5249(0x270)]==_0x2c5249(0x2c7)||_0x2637f0[_0x2c5249(0x270)]==_0x2c5249(0x224))&&settings[_0x2c5249(0x278)]=='alerts'||_0x2637f0[_0x2c5249(0x270)]==_0x2c5249(0x1e5)&&settings['telegramEvents']==_0x2c5249(0x164)){if(tgBot&&settings['telegramChatId']){if(_0x2637f0[_0x2c5249(0x305)])tgBot[_0x2c5249(0x2b4)](settings['telegramChatId'],_0x2637f0[_0x2c5249(0x1c4)]+_0x2c5249(0x213)+_0x2637f0[_0x2c5249(0x2c4)])[_0x2c5249(0x27c)](_0x453622=>{telegramError(_0x453622);});else tgBot['sendMessage'](settings['telegramChatId'],_0x2c5249(0x2ea)+_0x5b56fc+_0x2c5249(0x213)+_0x2637f0[_0x2c5249(0x2c4)])[_0x2c5249(0x27c)](_0x3a64bc=>{telegramError(_0x3a64bc);});}}}}async function sendTelegramMsg(_0x532e95,_0x5b3364=_0xcab4db(0x2a0)){const _0x1c45eb=_0xcab4db;return settings[_0x1c45eb(0x1d9)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x1c45eb(0x2b4)](settings[_0x1c45eb(0x1ca)],_0x532e95,{'parse_mode':_0x5b3364})[_0x1c45eb(0x27c)](_0x177775=>{telegramError(_0x177775);}),!![]):![];}function getDeviceWithIp(_0x24affc){const _0x43a642=_0xcab4db;return devices[_0x43a642(0x288)](_0x386ba3=>_0x386ba3['ip']===_0x24affc);}function temporaryAccess2FA(_0xa29891,_0x197605){const _0x1e786b=_0xcab4db;let _0x1998c0=new Date(),_0x5ba8f7=![];if(lastIpApproval){if(_0x1998c0-lastIpApproval<0x1388)_0x5ba8f7=!![];}lastIpApproval=new Date();if(_0x5ba8f7)return;tgBot&&settings[_0x1e786b(0x1ca)]&&(tgBot['removeListener'](_0x1e786b(0x229)),tgBot[_0x1e786b(0x2b4)](settings[_0x1e786b(0x1ca)],_0x1e786b(0x196)+normalizeIP(_0x197605)['show']+'</b>\x20?',{'parse_mode':_0x1e786b(0x2a0),'reply_markup':{'inline_keyboard':[[{'text':_0x1e786b(0x16c),'callback_data':'5'},{'text':_0x1e786b(0x2b6),'callback_data':'15'},{'text':_0x1e786b(0x205),'callback_data':'30'},{'text':_0x1e786b(0x20c),'callback_data':_0x1e786b(0x20c)}]]}})[_0x1e786b(0x27c)](_0x4089e2=>{telegramError(_0x4089e2);}),tgBot['on'](_0x1e786b(0x229),async _0x174d86=>{const _0x254f47=_0x1e786b,_0x36f80d=_0x174d86[_0x254f47(0x246)],_0x602231=_0x174d86[_0x254f47(0x2c5)];tgBot[_0x254f47(0x23a)](_0x174d86['id'])[_0x254f47(0x1eb)](async()=>{const _0x12f021=_0x254f47;devices[_0xa29891][_0x12f021(0x2ac)]={'clientip':_0x197605,'timestamp':new Date()[_0x12f021(0x27a)](),'expiry':_0x36f80d},_0x36f80d!=_0x12f021(0x20c)?(await tgBot[_0x12f021(0x2b4)](_0x602231[_0x12f021(0x1b4)]['id'],'Access\x20enabled\x20for\x20'+_0x36f80d+_0x12f021(0x2db),{'parse_mode':'HTML'})[_0x12f021(0x27c)](_0x5b1601=>{telegramError(_0x5b1601);}),io['to'](_0xa29891)['emit'](_0x12f021(0x1c9),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x12f021(0x2b4)](_0x602231[_0x12f021(0x1b4)]['id'],'Temporary\x20access\x20rejected')[_0x12f021(0x27c)](_0x8b1c2=>{telegramError(_0x8b1c2);}),io['to'](_0xa29891)[_0x12f021(0x1ab)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x254f47(0x218)](_0x254f47(0x229));}));}function loginAccess2FA(_0x4dbdde,_0x680a2b){const _0x281f10=_0xcab4db;tgBot&&settings[_0x281f10(0x1ca)]&&(tgBot[_0x281f10(0x218)](_0x281f10(0x229)),tgBot[_0x281f10(0x2b4)](settings[_0x281f10(0x1ca)],_0x281f10(0x2bf)+normalizeIP(_0x680a2b)[_0x281f10(0x2f2)]+_0x281f10(0x15f),{'parse_mode':_0x281f10(0x2a0),'reply_markup':{'inline_keyboard':[[{'text':_0x281f10(0x260),'callback_data':loginExpiry},{'text':_0x281f10(0x20c),'callback_data':_0x281f10(0x20c)}]]}})[_0x281f10(0x27c)](_0x43f3ac=>{telegramError(_0x43f3ac);}),tgBot['on'](_0x281f10(0x229),async _0x48a098=>{const _0x304a47=_0x281f10,_0x1b6ecc=_0x48a098[_0x304a47(0x246)],_0x52c027=_0x48a098[_0x304a47(0x2c5)];tgBot[_0x304a47(0x23a)](_0x48a098['id'])['then'](async()=>{const _0x5532bb=_0x304a47;devices[_0x4dbdde][_0x5532bb(0x2d7)]={'clientip':_0x680a2b,'timestamp':new Date()[_0x5532bb(0x27a)](),'expiry':_0x1b6ecc},_0x1b6ecc!='reject'?(await tgBot['sendMessage'](_0x52c027[_0x5532bb(0x1b4)]['id'],'Login\x20accepted',{'parse_mode':_0x5532bb(0x2a0)})[_0x5532bb(0x27c)](_0x1f096=>{telegramError(_0x1f096);}),io['to'](_0x4dbdde)[_0x5532bb(0x1ab)](_0x5532bb(0x1c9),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x5532bb(0x2b4)](_0x52c027[_0x5532bb(0x1b4)]['id'],'Login\x20rejected')['catch'](_0xb80537=>{telegramError(_0xb80537);}),io['to'](_0x4dbdde)['emit']('status',{'access':{'allow':![],'reason':_0x5532bb(0x2a1),'token':null}}));}),tgBot[_0x304a47(0x218)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4ac033=_0xcab4db;return dbConfig[_0x4ac033(0x2e6)](_0x4ac033(0x2d8))['sortBy'](_0x4ac033(0x315))[_0x4ac033(0x254)]({'status':_0x4ac033(0x2d0)})[_0x4ac033(0x191)]()||[];}function getDisabledBots(){const _0x382877=_0xcab4db;return dbConfig['get'](_0x382877(0x2d8))[_0x382877(0x26c)](_0x382877(0x315))[_0x382877(0x254)]({'status':_0x382877(0x2e2)})['value']()||[];}function getBotAttributes(_0x2d00e8){const _0x1f359e=_0xcab4db;let _0x52d4fb={};const _0x34e558=configpath+_0x1f359e(0x2d4)+_0x2d00e8+_0x1f359e(0x2cb),_0x5b2b8c=fs[_0x1f359e(0x201)](_0x34e558);if(_0x5b2b8c){const _0x2072a8=fs[_0x1f359e(0x2d3)](_0x34e558);try{const _0x22e5de=JSON[_0x1f359e(0x2fe)](_0x2072a8),_0x525a53=_0x22e5de?_0x22e5de['bot'][0x0][_0x1f359e(0x1ce)]:![];_0x52d4fb[_0x1f359e(0x1cd)]=_0x525a53?'auto':_0x1f359e(0x25a),_0x52d4fb[_0x1f359e(0x1c4)]=_0x22e5de?_0x22e5de[_0x1f359e(0x308)][0x0][_0x1f359e(0x1c4)]:_0x1f359e(0x2ea)+_0x2d00e8;}catch(_0x231ef2){_0x52d4fb['mode']='manual',_0x52d4fb[_0x1f359e(0x1c4)]=_0x1f359e(0x2ea)+_0x2d00e8;}}else _0x52d4fb['mode']='manual',_0x52d4fb[_0x1f359e(0x1c4)]=_0x1f359e(0x2ea)+_0x2d00e8;return _0x52d4fb;}function getBotsWithMode(){const _0x5d7261=_0xcab4db,_0x187f69=dbConfig[_0x5d7261(0x2e6)](_0x5d7261(0x2d8))['sortBy'](_0x5d7261(0x315))[_0x5d7261(0x191)]()||[];return _0x187f69[_0x5d7261(0x2a9)](_0x44a7d8=>{const _0x2c5050=_0x5d7261;let _0x340bc5=getBotAttributes(_0x44a7d8[_0x2c5050(0x315)]);_0x44a7d8['mode']=_0x340bc5[_0x2c5050(0x1cd)];}),_0x187f69;}function getBotExchanges(){const _0x4b1e8a=_0xcab4db;let _0x1fd515=[];const _0x59c4f7=dbConfig[_0x4b1e8a(0x2e6)](_0x4b1e8a(0x2d8))['sortBy'](_0x4b1e8a(0x315))[_0x4b1e8a(0x191)]()||[];_0x59c4f7[_0x4b1e8a(0x2a9)](_0x3cfb32=>{const _0x48aa5a=_0x4b1e8a;if(_0x3cfb32[_0x48aa5a(0x1c9)]==_0x48aa5a(0x2d0)){const _0x3d2948=configpath+_0x48aa5a(0x2d4)+_0x3cfb32[_0x48aa5a(0x315)]+'-config.json',_0x27f0f0=fs[_0x48aa5a(0x201)](_0x3d2948);let _0x81b62;if(_0x27f0f0){const _0x370ee4=fs[_0x48aa5a(0x2d3)](_0x3d2948);try{const _0x283bd6=JSON[_0x48aa5a(0x2fe)](_0x370ee4);_0x81b62=_0x283bd6?_0x283bd6[_0x48aa5a(0x308)][0x0][_0x48aa5a(0x303)]:null;}catch(_0xe4553a){}}if(_0x81b62)_0x1fd515[_0x48aa5a(0x1da)](_0x81b62);}});const _0x45f08b=[...new Set(_0x1fd515)][_0x4b1e8a(0x1dd)]();return _0x45f08b;}async function initUser(){const _0x409736=_0xcab4db;if(!settings[_0x409736(0x1bd)]){const _0x16aaba=uuidRandom();mixpanel[_0x409736(0x2c6)](_0x16aaba),updateSetting('userid',_0x16aaba);}}async function initSecure(){const _0x1a939e=_0xcab4db;let _0x1cf355=getSecure();if(!_0x1cf355['hasOwnProperty'](_0x1a939e(0x166))){let _0x17a6d9=await generateKeys();_0x1cf355[_0x1a939e(0x185)]=_0x17a6d9[_0x1a939e(0x185)],_0x1cf355[_0x1a939e(0x291)]=_0x17a6d9[_0x1a939e(0x291)],_0x1cf355['secret']=crypto[_0x1a939e(0x18f)](0x20)[_0x1a939e(0x262)](_0x1a939e(0x239));;storeSecure(_0x1cf355);}}function getSettings(){const _0x25a42d=_0xcab4db;return dbSettings[_0x25a42d(0x2e6)](_0x25a42d(0x28a))[_0x25a42d(0x191)]()||{};}function getSecure(){const _0x4df0fe=_0xcab4db;return dbSecure[_0x4df0fe(0x2e6)]('secure')[_0x4df0fe(0x191)]()||{};}function getBlacklist(){const _0x46e70e=_0xcab4db;return dbSecure['get'](_0x46e70e(0x28b))[_0x46e70e(0x191)]()||[];}function broadcastToBots(_0x45a4f4,_0x20841b){const _0x2ff2e8=_0xcab4db;config[_0x2ff2e8(0x2a9)](_0x3e26dd=>{const _0x5b17a1=_0x2ff2e8;if(_0x3e26dd['status']=='enabled'&&_0x3e26dd[_0x5b17a1(0x245)]==_0x5b17a1(0x243)||_0x3e26dd[_0x5b17a1(0x1c9)]==_0x5b17a1(0x170)&&_0x3e26dd[_0x5b17a1(0x245)]=='running'){if(pid[_0x3e26dd[_0x5b17a1(0x315)]])pid[_0x3e26dd[_0x5b17a1(0x315)]][_0x5b17a1(0x219)]({[_0x45a4f4]:_0x20841b});}});}function storeSettings(_0x251022,_0x2f8aa1=![]){const _0xc192ae=_0xcab4db;_0x251022={...settings,..._0x251022};if(_0x2f8aa1&&_0x251022[_0xc192ae(0x2d2)]!=_0xc192ae(0x178)&&_0x251022['bbPassword']!='***'&&_0x251022[_0xc192ae(0x2d2)]!=''){const _0x5c8ea2=crypt[_0xc192ae(0x1df)](secure[_0xc192ae(0x291)],_0x251022[_0xc192ae(0x2d2)])[_0xc192ae(0x2c5)][_0xc192ae(0x206)]('@')[0x0],_0x28b8f9=bcrypt[_0xc192ae(0x2af)](_0x5c8ea2,saltRounds);_0x251022={..._0x251022,'bbPassword':_0x28b8f9};}if(_0x2f8aa1&&_0x251022[_0xc192ae(0x197)]!='************'&&_0x251022[_0xc192ae(0x197)]!=_0xc192ae(0x1e8)&&_0x251022['telegramToken']!=''){const _0xd12c17=crypt['decrypt'](secure['privateKey'],_0x251022[_0xc192ae(0x197)])['message'][_0xc192ae(0x206)]('@')[0x0];_0x251022={..._0x251022,'telegramToken':_0xd12c17};}const _0x550924=_0x251022[_0xc192ae(0x197)]!='************'&&_0x251022['telegramToken']!=settings['telegramToken']||_0x251022[_0xc192ae(0x26a)]!=settings[_0xc192ae(0x26a)],_0x33da3d=_0x251022[_0xc192ae(0x197)]==''||_0x251022['telegramUsername']=='';if(_0x550924)_0x251022['telegramEvents']=_0xc192ae(0x31c);for(const [_0x2c4ca3,_0x3d596d]of Object['entries'](_0x251022)){if(_0x2c4ca3==_0xc192ae(0x197)&&_0x3d596d==_0xc192ae(0x178)){_0x251022['telegramToken']=settings[_0xc192ae(0x197)];continue;};if(_0x2c4ca3==_0xc192ae(0x2d2)&&_0x3d596d=='************'){_0x251022[_0xc192ae(0x2d2)]=settings[_0xc192ae(0x2d2)];continue;};dbSettings[_0xc192ae(0x261)](_0xc192ae(0x1fa)+_0x2c4ca3,_0x3d596d)['write']();}settings=_0x251022,io['to'](_0xc192ae(0x217))[_0xc192ae(0x1ab)](_0xc192ae(0x28a),cleanSettings()),broadcastToBots(_0xc192ae(0x30a),settings[_0xc192ae(0x30a)]),broadcastToBots(_0xc192ae(0x20a),settings['onepagemode']);if(_0x550924&&!_0x33da3d)initTelegram();if(_0x550924&&_0x33da3d)disableTelegram();getAllClients()['forEach'](_0x5eb129=>{const _0x4b8108=_0xc192ae;getSocket(_0x5eb129['id'])[_0x4b8108(0x1ab)](_0x4b8108(0x1c9),{'access':{'allow':![],'reason':_0x4b8108(0x29f),'token':null}});});}function updateSetting(_0x383dc4,_0x8de400){const _0x321e75=_0xcab4db;dbSettings[_0x321e75(0x261)](_0x321e75(0x1fa)+_0x383dc4,_0x8de400)[_0x321e75(0x275)](),settings=getSettings(),io['to'](_0x321e75(0x217))[_0x321e75(0x1ab)](_0x321e75(0x28a),cleanSettings());}function storeSecure(_0xd9033){const _0x4d18c5=_0xcab4db;dbSecure[_0x4d18c5(0x2e6)]('secure')['push'](_0xd9033)['write'](),secure=_0xd9033;}function addBlacklist(_0x58092c){const _0xf041a7=_0xcab4db;cleanBlacklist();let _0x5b794d;devices[_0x58092c][_0xf041a7(0x2ac)]?_0x5b794d=Math[_0xf041a7(0x27d)](devices[_0x58092c][_0xf041a7(0x2ac)][_0xf041a7(0x2e9)],loginExpiry):_0x5b794d=loginExpiry,dbSecure[_0xf041a7(0x2e6)]('blacklist')[_0xf041a7(0x1da)]({'expiry':new Date()[_0xf041a7(0x27a)]()+_0x5b794d*0x3c*0x3e8,'token':devices[_0x58092c][_0xf041a7(0x2d1)][_0xf041a7(0x19e)]})[_0xf041a7(0x275)](),blacklist=dbSecure[_0xf041a7(0x2e6)](_0xf041a7(0x28b))[_0xf041a7(0x191)]();}function cleanBlacklist(){const _0x3cd5e6=_0xcab4db;let _0x153ff9=dbSecure[_0x3cd5e6(0x2e6)](_0x3cd5e6(0x28b))[_0x3cd5e6(0x2f5)]()[_0x3cd5e6(0x191)](),_0x198496=new Date()[_0x3cd5e6(0x27a)]();_0x153ff9[_0x3cd5e6(0x2a9)](_0xa0f8c4=>{const _0x99d267=_0x3cd5e6;_0xa0f8c4[_0x99d267(0x2e9)]<_0x198496&&dbSecure['get'](_0x99d267(0x28b))[_0x99d267(0x300)]({'expiry':_0xa0f8c4[_0x99d267(0x2e9)]})[_0x99d267(0x275)]();});}function initStates(){let _0x15ea15=getConfiguration();_0x15ea15['forEach'](_0x4f94b1=>{const _0x5ec132=_0x4e8e;_0x4f94b1[_0x5ec132(0x245)]=_0x5ec132(0x265);}),storeConfiguration(_0x15ea15);}function onKeys(){const _0x554bcd=new RSA();return new Promise(_0x541b6d=>{_0x554bcd['generateKeyPairAsync']()['then'](_0x1b7cfe=>{_0x541b6d(_0x1b7cfe);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3f1dc5=_0xcab4db;let _0x23e081=getSettings(),_0x4b8bd3=![];!_0x23e081[_0x3f1dc5(0x1fe)]('lastmsgtelegram')&&(_0x23e081[_0x3f1dc5(0x316)]=0x0,_0x4b8bd3=!![]);!_0x23e081[_0x3f1dc5(0x1fe)](_0x3f1dc5(0x25b))&&(_0x23e081[_0x3f1dc5(0x25b)]=0x0,_0x4b8bd3=!![]);!_0x23e081[_0x3f1dc5(0x1fe)](_0x3f1dc5(0x2f3))&&(_0x23e081['latestversion']=_0x3f1dc5(0x171),_0x4b8bd3=!![]);!_0x23e081[_0x3f1dc5(0x1fe)](_0x3f1dc5(0x20a))&&(_0x23e081[_0x3f1dc5(0x20a)]=![],_0x4b8bd3=!![]);if(_0x4b8bd3)storeSettings(_0x23e081);}function storeConfiguration(_0x3e059f){const _0x3e0f92=_0xcab4db;dbConfig[_0x3e0f92(0x2e6)](_0x3e0f92(0x2d8))[_0x3e0f92(0x300)]()[_0x3e0f92(0x275)](),_0x3e059f[_0x3e0f92(0x2a9)](_0x4e4085=>{const _0xe3a262=_0x3e0f92;delete _0x4e4085[_0xe3a262(0x1cd)];}),dbConfig['get'](_0x3e0f92(0x2d8))[_0x3e0f92(0x1da)](..._0x3e059f)[_0x3e0f92(0x275)](),config=_0x3e059f;}function resetPassword(){const _0x21ab39=_0xcab4db;tgBot&&settings[_0x21ab39(0x1ca)]&&(tgBot['removeListener'](_0x21ab39(0x229)),tgBot['sendMessage'](settings['telegramChatId'],_0x21ab39(0x1c0),{'parse_mode':_0x21ab39(0x2a0),'reply_markup':{'inline_keyboard':[[{'text':_0x21ab39(0x161),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x21ab39(0x27c)](_0x4df601=>{telegramError(_0x4df601);}),tgBot['on'](_0x21ab39(0x229),async _0x23bbf8=>{const _0x3aed5e=_0x21ab39,_0x1055cc=_0x23bbf8[_0x3aed5e(0x246)],_0xacbdca=_0x23bbf8[_0x3aed5e(0x2c5)];tgBot[_0x3aed5e(0x23a)](_0x23bbf8['id'])[_0x3aed5e(0x1eb)](async()=>{const _0x354056=_0x3aed5e;if(_0x1055cc!='no'){const _0x1d92c2=0xf,_0x42ea5e=_0x354056(0x167),_0x204a34=Array[_0x354056(0x30c)](crypto[_0x354056(0x279)](new Uint32Array(_0x1d92c2)))['map'](_0xcacca0=>_0x42ea5e[_0xcacca0%_0x42ea5e['length']])[_0x354056(0x190)](''),_0xed6ed9=bcrypt[_0x354056(0x2af)](_0x204a34,saltRounds);storeSettings({'bbPassword':_0xed6ed9}),await tgBot[_0x354056(0x2b4)](_0xacbdca['chat']['id'],_0x354056(0x29d)+_0x204a34,{'parse_mode':_0x354056(0x2a0)})[_0x354056(0x27c)](_0x402c73=>{telegramError(_0x402c73);});}else await tgBot[_0x354056(0x2b4)](_0xacbdca[_0x354056(0x1b4)]['id'],_0x354056(0x301))[_0x354056(0x27c)](_0x549cf9=>{telegramError(_0x549cf9);});}),tgBot[_0x3aed5e(0x218)](_0x3aed5e(0x229));}));}async function confirmRestore(_0x4dc54a,_0x57d5ae){const _0xf4c9c5=_0xcab4db;io['to'](_0xf4c9c5(0x217))['emit']('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0xf4c9c5(0x224)),tgBot&&settings[_0xf4c9c5(0x1ca)]&&(tgBot[_0xf4c9c5(0x218)](_0xf4c9c5(0x229)),await tgBot['sendMessage'](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0xf4c9c5(0x161),'callback_data':_0xf4c9c5(0x161)},{'text':'no','callback_data':'no'}]]}})[_0xf4c9c5(0x27c)](_0x173d86=>{telegramError(_0x173d86);}),tgBot['on'](_0xf4c9c5(0x229),async _0x507c28=>{const _0x7f1c86=_0xf4c9c5,_0x41c73e=_0x507c28[_0x7f1c86(0x246)],_0x1aeb8b=_0x507c28[_0x7f1c86(0x2c5)];tgBot[_0x7f1c86(0x23a)](_0x507c28['id'])[_0x7f1c86(0x1eb)](async()=>{const _0x4fb53c=_0x7f1c86;_0x41c73e=='yes'?(await tgBot[_0x4fb53c(0x2b4)](_0x1aeb8b[_0x4fb53c(0x1b4)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'})[_0x4fb53c(0x27c)](_0x476256=>{telegramError(_0x476256);}),unzipFile(_0x4dc54a,_0x57d5ae)):(logger[_0x4fb53c(0x22f)](_0x4fb53c(0x17f)),await tgBot[_0x4fb53c(0x2b4)](_0x1aeb8b[_0x4fb53c(0x1b4)]['id'],_0x4fb53c(0x17f))['catch'](_0xa6ef73=>{telegramError(_0xa6ef73);}));}),tgBot[_0x7f1c86(0x218)]('callback_query');}));}function getServerTime(){const _0x3eccb3=_0xcab4db,_0x4762b8=new Date();return _0x4762b8[_0x3eccb3(0x1a0)]()+'/'+(_0x4762b8['getMonth']()+0x1)[_0x3eccb3(0x262)]()[_0x3eccb3(0x267)](0x2,'0')+'/'+_0x4762b8['getDate']()['toString']()[_0x3eccb3(0x267)](0x2,'0')+'\x20'+_0x4762b8['getHours']()[_0x3eccb3(0x262)]()[_0x3eccb3(0x267)](0x2,'0')+':'+_0x4762b8['getMinutes']()[_0x3eccb3(0x262)]()[_0x3eccb3(0x267)](0x2,'0')+':'+_0x4762b8[_0x3eccb3(0x2f4)]()[_0x3eccb3(0x262)]()[_0x3eccb3(0x267)](0x2,'0');}function getTimeStamp(){const _0xc1322b=_0xcab4db,_0x510e0a=shiftedTime();return _0x510e0a[_0xc1322b(0x1a0)]()+'/'+(_0x510e0a[_0xc1322b(0x2aa)]()+0x1)[_0xc1322b(0x262)]()[_0xc1322b(0x267)](0x2,'0')+'/'+_0x510e0a[_0xc1322b(0x188)]()[_0xc1322b(0x262)]()[_0xc1322b(0x267)](0x2,'0')+'\x20'+_0x510e0a[_0xc1322b(0x1ef)]()['toString']()[_0xc1322b(0x267)](0x2,'0')+':'+_0x510e0a[_0xc1322b(0x173)]()[_0xc1322b(0x262)]()['padStart'](0x2,'0')+':'+_0x510e0a[_0xc1322b(0x2f4)]()[_0xc1322b(0x262)]()[_0xc1322b(0x267)](0x2,'0');}function getCleanTimeStamp(){const _0xbca430=_0xcab4db,_0x9a181d=shiftedTime();return _0x9a181d[_0xbca430(0x1a0)]()+(_0x9a181d[_0xbca430(0x2aa)]()+0x1)[_0xbca430(0x262)]()['padStart'](0x2,'0')+_0x9a181d['getDate']()[_0xbca430(0x262)]()[_0xbca430(0x267)](0x2,'0')+'-'+_0x9a181d[_0xbca430(0x1ef)]()[_0xbca430(0x262)]()[_0xbca430(0x267)](0x2,'0')+_0x9a181d[_0xbca430(0x173)]()[_0xbca430(0x262)]()[_0xbca430(0x267)](0x2,'0')+_0x9a181d[_0xbca430(0x2f4)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x42b737=_0xcab4db,_0x54f963=new Date();let _0x426b96=_0x54f963;if(settings[_0x42b737(0x30a)]&&settings[_0x42b737(0x30a)]!==0x0)_0x426b96=fns['add'](_0x54f963,{'hours':settings['timeshift']});return _0x426b96;}function startScheduler(){const _0x283791=_0xcab4db,_0x4dc7bf=new Date()[_0x283791(0x19d)](),_0x3007f0=shiftedTime()[_0x283791(0x1ef)]();_0x3007f0==0x4&&backupConfigFiles();_0x3007f0==0x0&&rotateLogFiles();_0x4dc7bf%0x6==0x0&&triggerAnalytics();_0x4dc7bf%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x552d78){const _0x2ea74e=_0xcab4db;logger[_0x2ea74e(0x22f)](_0x2ea74e(0x18a)+_0x552d78);const _0x277ab3=getBotsWithMode();_0x277ab3[_0x2ea74e(0x1e2)]>0x0?confirmRestore(configbackuppath,_0x552d78):unzipFile(configbackuppath,_0x552d78);}async function getBackupFiles(_0x1f9a6a=null){const _0x1d27ed=_0xcab4db;let _0x481f0f=[],_0x308250=fs[_0x1d27ed(0x1a7)](configbackuppath,{'withFileTypes':!![]});_0x308250[_0x1d27ed(0x1dd)]((_0x140b18,_0x1506eb)=>_0x140b18[_0x1d27ed(0x2ed)]<_0x1506eb['name']?0x1:_0x1506eb[_0x1d27ed(0x2ed)]<_0x140b18[_0x1d27ed(0x2ed)]?-0x1:0x0),_0x308250[_0x1d27ed(0x2a9)](_0x19ebcd=>{const _0x4db038=_0x1d27ed;if(!_0x19ebcd['isDirectory']()&&_0x19ebcd[_0x4db038(0x2ed)]['startsWith'](_0x4db038(0x26e))&&_0x19ebcd[_0x4db038(0x2ed)][_0x4db038(0x1d6)](_0x4db038(0x1a1))){const _0x2b3520=formatDate(fs[_0x4db038(0x1f3)](configbackuppath+_0x19ebcd[_0x4db038(0x2ed)])[_0x4db038(0x285)]);_0x481f0f[_0x4db038(0x1da)]({'name':_0x19ebcd[_0x4db038(0x2ed)],'mtime':_0x2b3520});}});if(_0x1f9a6a)io['to'](_0x1f9a6a)[_0x1d27ed(0x1ab)](_0x1d27ed(0x232),_0x481f0f);else return _0x481f0f;}async function backupConfigFiles(){const _0x2b1b0e=_0xcab4db;await zipFiles(_0x2b1b0e(0x289));const _0x2fa8b3=getCleanTimeStamp();fs[_0x2b1b0e(0x21d)](zippath+_0x2b1b0e(0x172),configbackuppath+(_0x2b1b0e(0x26e)+_0x2fa8b3+_0x2b1b0e(0x1a1)));let _0xf6cee=fs[_0x2b1b0e(0x1a7)](configbackuppath,{'withFileTypes':!![]});_0xf6cee['sort']((_0x6913e6,_0x25e323)=>_0x6913e6[_0x2b1b0e(0x2ed)]<_0x25e323['name']?0x1:_0x25e323['name']<_0x6913e6['name']?-0x1:0x0),_0xf6cee[_0x2b1b0e(0x1e2)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0xf6cee[maxBackups]['name']);}function rotateLogFiles(){const _0x4c5965=_0xcab4db,_0x131c4f=fs['statSync'](logspath+_0x4c5965(0x281)),_0x2ca19b=_0x131c4f[_0x4c5965(0x2b1)]/0x400;if(_0x2ca19b>0x64){let _0x1a3476=fs[_0x4c5965(0x1a7)](logspath,{'withFileTypes':!![]});_0x1a3476[_0x4c5965(0x1dd)]((_0xbfdb10,_0x29180e)=>_0xbfdb10[_0x4c5965(0x2ed)]<_0x29180e[_0x4c5965(0x2ed)]?0x1:_0x29180e[_0x4c5965(0x2ed)]<_0xbfdb10[_0x4c5965(0x2ed)]?-0x1:0x0),_0x1a3476[_0x4c5965(0x2a9)](_0x39bf31=>{const _0x67ecb1=_0x4c5965;if(_0x39bf31[_0x67ecb1(0x2ed)]==_0x67ecb1(0x2b5))fs[_0x67ecb1(0x21d)](logspath+_0x39bf31['name'],logspath+'output-003.log');if(_0x39bf31['name']=='output-001.log')fs['copyFileSync'](logspath+_0x39bf31['name'],logspath+_0x67ecb1(0x2b5));_0x39bf31['name']==_0x67ecb1(0x281)&&(fs[_0x67ecb1(0x21d)](logspath+_0x39bf31[_0x67ecb1(0x2ed)],logspath+'output-001.log'),fs[_0x67ecb1(0x29e)](logspath+_0x39bf31[_0x67ecb1(0x2ed)],''));});}}async function zipFiles(_0x4d026d){const _0x9a57d9=_0xcab4db;let _0x3da45f;if(_0x4d026d==_0x9a57d9(0x271))_0x3da45f=logspath;if(_0x4d026d==_0x9a57d9(0x28c))_0x3da45f=configpath;if(_0x4d026d==_0x9a57d9(0x289))_0x3da45f=configpath;let _0x2a2e71=fs[_0x9a57d9(0x1a7)](_0x3da45f,{'withFileTypes':!![]});const _0x1ae851=new require(_0x9a57d9(0x2c2))();_0x2a2e71[_0x9a57d9(0x2a9)](_0x50650f=>{const _0x42b678=_0x9a57d9;if(!_0x50650f['isDirectory']()){let _0x477c82=fs['readFileSync'](_0x3da45f+_0x50650f[_0x42b678(0x2ed)]);if(_0x4d026d==_0x42b678(0x28c)){const _0x169169=/^bot-[0-9]{3}-config.json$/,_0x35cec6=_0x169169[_0x42b678(0x2ca)](_0x50650f[_0x42b678(0x2ed)]);if(_0x35cec6){const _0x206694=JSON[_0x42b678(0x2fe)](_0x477c82);_0x206694[_0x42b678(0x308)][0x0]&&(_0x206694[_0x42b678(0x308)][0x0]['apiKey']=_0x42b678(0x1e8),_0x206694[_0x42b678(0x308)][0x0][_0x42b678(0x2a2)]=_0x42b678(0x1e8)),_0x477c82=JSON[_0x42b678(0x242)](_0x206694,null,0x2);}if(_0x50650f[_0x42b678(0x2ed)]==_0x42b678(0x1e1)){const _0xb20510=JSON[_0x42b678(0x2fe)](_0x477c82);if(_0xb20510[_0x42b678(0x28a)][_0x42b678(0x2a4)])_0xb20510[_0x42b678(0x28a)][_0x42b678(0x2a4)]=![];if(_0xb20510[_0x42b678(0x28a)]['bbPassword'])_0xb20510[_0x42b678(0x28a)][_0x42b678(0x2d2)]=_0x42b678(0x1e8);if(_0xb20510[_0x42b678(0x28a)][_0x42b678(0x197)])_0xb20510[_0x42b678(0x28a)][_0x42b678(0x197)]=_0x42b678(0x1e8);if(_0xb20510[_0x42b678(0x28a)][_0x42b678(0x1ca)])_0xb20510[_0x42b678(0x28a)][_0x42b678(0x1ca)]=null;_0x477c82=JSON[_0x42b678(0x242)](_0xb20510,null,0x2);}if(_0x50650f[_0x42b678(0x2ed)]!=_0x42b678(0x309))_0x1ae851[_0x42b678(0x29a)](_0x50650f[_0x42b678(0x2ed)],_0x477c82);}else _0x1ae851['file'](_0x50650f[_0x42b678(0x2ed)],_0x477c82);}});const _0x34ff78=_0x1ae851[_0x9a57d9(0x1f5)]({'base64':![],'compression':_0x9a57d9(0x311)});fs['writeFileSync'](zippath+(_0x4d026d+'.zip'),_0x34ff78,_0x9a57d9(0x15d));}async function unzipFile(_0x1c0918,_0x482cdb){const _0x1c8768=_0xcab4db;fs[_0x1c8768(0x1a7)](configpath,{'withFileTypes':!![]})[_0x1c8768(0x2a9)](_0x460782=>{const _0x397307=_0x1c8768;if(!_0x460782[_0x397307(0x2fa)]())fs[_0x397307(0x1d2)](configpath+_0x460782[_0x397307(0x2ed)]);});const _0x500548=fs['readFileSync'](_0x1c0918+_0x482cdb,_0x1c8768(0x15d)),_0x1f9c52=new require(_0x1c8768(0x2c2))(_0x500548,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x1f9c52[_0x1c8768(0x225)])[_0x1c8768(0x2a9)](_0x55fa34=>{const _0x55ba8f=_0x1c8768,_0x20831f=_0x1f9c52[_0x55ba8f(0x225)][_0x55fa34];fs[_0x55ba8f(0x29e)](configpath+_0x20831f[_0x55ba8f(0x2ed)],_0x20831f[_0x55ba8f(0x1f7)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x1c8768(0x2a9)](_0x73af4d=>{const _0x4f631f=_0x1c8768;if(!_0x73af4d['isDirectory']())fs[_0x4f631f(0x1d2)](temppath+_0x73af4d['name']);}),logger[_0x1c8768(0x22f)](_0x1c8768(0x2f6)),process['send']({'restore':!![]},_0x56b957=>{});}async function getPublicIp(){const _0x27bb92=_0xcab4db;try{const _0x3c33e7=await axios[_0x27bb92(0x2e6)](_0x27bb92(0x1fd));publicip=_0x3c33e7[_0x27bb92(0x246)]['ip'];}catch(_0x587c0d){}}async function triggerAnalytics(){const _0x447931=_0xcab4db;if(!publicip)await getPublicIp();const _0x4684a7=getBotsWithMode();let _0x1cfab2=0x0;_0x4684a7[_0x447931(0x2a9)](_0x175c19=>{const _0x425f04=_0x447931;if(_0x175c19[_0x425f04(0x1c9)]===_0x425f04(0x2d0))_0x1cfab2++;});const _0x2a4131=getBotExchanges();mixpanel[_0x447931(0x1a6)]('Server',{'distinct_id':settings[_0x447931(0x1bd)],'ip':publicip,'version':serverversion,'numbots':_0x4684a7[_0x447931(0x1e2)],'numbotsenabled':_0x1cfab2,'exchanges':_0x2a4131});}async function getMessages(){const _0x27045c=_0xcab4db,_0x69b2f2=_0x27045c(0x30b),_0x2ae031=new GraphQLClient(_0x69b2f2),_0x7efc5={'authorization':_0x27045c(0x1d3)},_0x15288a=serverversion[_0x27045c(0x206)]('.'),_0x4eecc1=_0x15288a[0x0]+'.'+_0x15288a[0x1],_0x455b25=Math[_0x27045c(0x187)](settings[_0x27045c(0x316)],settings[_0x27045c(0x25b)]),_0x4e4b36={'last':parseInt(_0x455b25),'bbm':_0x4eecc1},_0x4f5912=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x25ff24;try{_0x25ff24=await _0x2ae031[_0x27045c(0x2b2)](_0x4f5912,_0x4e4b36,_0x7efc5);}catch(_0x23995e){}if(_0x25ff24&&_0x25ff24[_0x27045c(0x200)]){let _0x1cf8c6=settings[_0x27045c(0x316)];newMessages=[];for(const _0x40e9bf of _0x25ff24[_0x27045c(0x200)]){newMessages[_0x27045c(0x1da)](_0x40e9bf);if(_0x40e9bf['bbvNew'])updateSetting(_0x27045c(0x2f3),_0x40e9bf[_0x27045c(0x273)]);let _0x1fbd1c=_0x40e9bf[_0x27045c(0x273)]?serverversion>=_0x40e9bf['bbvNew']:![];if(!_0x1fbd1c&&_0x40e9bf[_0x27045c(0x214)]>_0x1cf8c6){if(_0x40e9bf[_0x27045c(0x280)]===_0x27045c(0x263)||serverversion[_0x27045c(0x228)](_0x40e9bf['bbvReceive'])){let _0x32b01c=''+_0x40e9bf[_0x27045c(0x1ba)]+'\x0a\x0a'+_0x40e9bf[_0x27045c(0x2c5)];const _0x4f0fda=await sendTelegramMsg(toTelegramMarkdown(_0x32b01c),_0x27045c(0x30e));if(_0x4f0fda)_0x1cf8c6=_0x40e9bf[_0x27045c(0x214)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x1cf8c6),emitMessages();}}function emitMessages(){const _0x2f230d=_0xcab4db,_0x5815c=settings[_0x2f230d(0x25b)];let _0x4a8de8=[];newMessages['forEach'](_0x3ea759=>{const _0x45ccaf=_0x2f230d;_0x3ea759[_0x45ccaf(0x214)]>_0x5815c&&_0x4a8de8['push'](_0x3ea759);}),_0x4a8de8[_0x2f230d(0x1e2)]>0x0&&getAllClients()[_0x2f230d(0x2a9)](_0x14299a=>{const _0x435751=_0x2f230d;getSocket(_0x14299a['id'])['emit'](_0x435751(0x2c5),_0x4a8de8);});}function confirmMessage(_0x59c830){const _0x2527e4=_0xcab4db;updateSetting(_0x2527e4(0x25b),Number(_0x59c830));}function isNewerVersion(_0x5adc97,_0x30a092){const _0x168ffa=_0xcab4db,_0x5dc674=_0x30a092[_0x168ffa(0x206)]('.'),_0x35e0ef=_0x5adc97[_0x168ffa(0x206)]('.');for(var _0x16082f=0x0;_0x16082f<_0x35e0ef[_0x168ffa(0x1e2)];_0x16082f++){const _0x4424d=~~_0x35e0ef[_0x16082f],_0x5bb428=~~_0x5dc674[_0x16082f];if(_0x4424d>_0x5bb428)return!![];if(_0x4424d<_0x5bb428)return![];}return![];}function toTelegramMarkdown(_0x2fc668){const _0x3f14fb=_0xcab4db,_0xe56e0b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4dc422=/\*{2}(.+?)\*{2}/gim;return _0x2fc668=_0x2fc668[_0x3f14fb(0x2eb)](_0xe56e0b,_0x3f14fb(0x266))[_0x3f14fb(0x2eb)](_0x4dc422,'*$1*'),_0x2fc668;}async function validateConfigFile(){const _0x3b5172=_0xcab4db,_0x452e8f=dbConfig[_0x3b5172(0x2e6)](_0x3b5172(0x2d8))[_0x3b5172(0x26c)](_0x3b5172(0x315))[_0x3b5172(0x191)]()||[];if(_0x452e8f['length']==0x0){let _0x14795c=0x0,_0x3be0c7=[];const _0x58b803=/^bot-([0-9]{3})-config.json$/,_0x517f69=fs[_0x3b5172(0x1a7)](configpath);_0x517f69[_0x3b5172(0x2a9)](_0x160cb5=>{const _0x33f32a=_0x3b5172,_0x1c02e8=_0x58b803[_0x33f32a(0x21f)](_0x160cb5);if(_0x1c02e8){const _0x18a4f6=_0x1c02e8[0x1];let _0x20628b=getBotAttributes(_0x18a4f6);_0x3be0c7[_0x33f32a(0x1da)]({'botID':_0x18a4f6,'botname':_0x20628b[_0x33f32a(0x1c4)],'status':_0x33f32a(0x2e2),'live':_0x33f32a(0x265)}),_0x14795c++;}}),_0x14795c!=0x0&&(dbConfig[_0x3b5172(0x2e6)](_0x3b5172(0x2d8))[_0x3b5172(0x211)](_0x3be0c7)[_0x3b5172(0x275)](),config=_0x3be0c7,restoredConfigFile=_0x14795c);}}async function restoreConfigNotify(_0x8dd39e){const _0x286a02=_0xcab4db;let _0x2a2b0c;if(restoredConfigFile==0x1)_0x2a2b0c=_0x286a02(0x26b);else _0x2a2b0c='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x8dd39e)io['to'](_0x286a02(0x217))[_0x286a02(0x1ab)](_0x286a02(0x1ac),_0x2a2b0c);else{logger[_0x286a02(0x28e)](_0x286a02(0x2dc)),logger['simple'](_0x2a2b0c),logger[_0x286a02(0x28e)](_0x286a02(0x2dc)),logger[_0x286a02(0x28e)]('');if(tgBot&&settings[_0x286a02(0x1ca)]&&settings[_0x286a02(0x278)]!=_0x286a02(0x164))tgBot[_0x286a02(0x2b4)](settings['telegramChatId'],_0x286a02(0x264)+_0x2a2b0c)[_0x286a02(0x27c)](_0xbad538=>{telegramError(_0xbad538);});}}function validateCredentials(_0x34b821,_0x3c2f68){const _0x2839f3=_0xcab4db;if(_0x34b821[_0x2839f3(0x1d5)]==settings[_0x2839f3(0x27f)]&&bcrypt['compareSync'](_0x34b821['password'],settings[_0x2839f3(0x2d2)])){if(settings[_0x2839f3(0x2fc)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0xc028e3=generateLoginToken(_0x3c2f68);return{'allow':!![],'reason':_0x2839f3(0x17a),'token':_0xc028e3};}}else return{'allow':![],'reason':_0x2839f3(0x18d),'token':null};}function refreshToken(_0x353ab4){const _0x50f1c8=_0xcab4db,_0x3c2b2d=generateLoginToken(_0x353ab4);return{'allow':!![],'reason':_0x50f1c8(0x17a),'token':_0x3c2b2d};}function validateAccess(_0x5f0e93,_0x2469ed,_0x1856c0){const _0x172eb6=_0xcab4db,_0x4af04f=_0x1856c0?_0x1856c0:devices[_0x2469ed]['ip'];let _0xc92fbb;const _0x4ec860=_0x396497=>{const _0x952fdc=_0x4e8e;if(settings[_0x952fdc(0x2a4)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x2469ed)){const _0x4e82a1=generateLoginToken(_0x2469ed);return{'allow':!![],'reason':_0x952fdc(0x310),'token':_0x4e82a1};}else return{'allow':![],'reason':_0x952fdc(0x227),'token':null};}else return _0xc92fbb=validToken(_0x396497,_0x2469ed),_0xc92fbb['hasOwnProperty'](_0x952fdc(0x224))?{'allow':!![],'reason':_0x952fdc(0x317),'token':_0x396497}:{'allow':![],'reason':_0x952fdc(0x227),'token':null};}else return{'allow':!![],'reason':_0x952fdc(0x31e),'token':null};};if(settings[_0x172eb6(0x30d)]){let _0x2ef03e=[...settings[_0x172eb6(0x1fc)],'::1','::ffff:127.0.0.1','127.0.0.1'];if(_0x2ef03e[_0x172eb6(0x1f6)](_0x4af04f))return _0x4ec860(_0x5f0e93);else{_0xc92fbb=validToken(_0x5f0e93,_0x2469ed);if(_0xc92fbb[_0x172eb6(0x1fe)](_0x172eb6(0x224)))return _0x4ec860(_0x5f0e93);else{if(telegramIpApproved(_0x2469ed)){const _0x4f1d99=generateToken(_0x2469ed);return _0xc92fbb=_0x4ec860(_0x5f0e93),_0xc92fbb[_0x172eb6(0x1f0)]?{'allow':!![],'reason':_0x172eb6(0x2c3),'token':_0x4f1d99}:_0xc92fbb;}else return settings[_0x172eb6(0x169)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x172eb6(0x212),'token':null};}}}else return _0x4ec860(_0x5f0e93);}function timelyDecrypt(_0x799385,_0x26ce71=!![]){const _0x388ccc=_0xcab4db;if(_0x799385)try{const _0x300b99=crypt['decrypt'](secure[_0x388ccc(0x291)],_0x799385)[_0x388ccc(0x2c5)],_0x4b83e7=_0x300b99[_0x388ccc(0x206)]('@')[0x0],_0x55d194=_0x300b99['split']('@')[0x1],_0x59de3c=new Date()[_0x388ccc(0x27a)]();if(_0x26ce71){if(_0x59de3c-_0x55d194<maxSecretAge*0x3e8)return _0x4b83e7;else return![];}else return _0x4b83e7;}catch(_0x362f26){return![];}else return![];}const validToken=(_0x141ae0,_0xdede0d)=>{const _0x2d7631=_0xcab4db,_0x2b2bf2=devices[_0xdede0d]['ip'];if(!_0x141ae0)return{'error':_0x2d7631(0x252)};for(let _0x1b77b8 of blacklist){if(_0x1b77b8[_0x2d7631(0x19e)]==_0x141ae0)return{'error':'Token\x20blacklisted'};}let _0x440766;try{_0x440766=jwt[_0x2d7631(0x194)](_0x141ae0,secure[_0x2d7631(0x166)]+_0xdede0d);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x440766[_0x2d7631(0x1fe)](_0x2d7631(0x23b))&&!_0x440766[_0x2d7631(0x1fe)]('username')||!_0x440766[_0x2d7631(0x1fe)](_0x2d7631(0x2e0)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x440766[_0x2d7631(0x1fe)](_0x2d7631(0x1d5))&&_0x440766[_0x2d7631(0x1fe)](_0x2d7631(0x23b))){const {clientip:_0x409066}=_0x440766;return _0x2b2bf2==_0x409066?{'success':_0x2d7631(0x253)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x440766[_0x2d7631(0x1fe)](_0x2d7631(0x1d5))&&_0x440766[_0x2d7631(0x1fe)]('clientip')){const {username:_0x4adf4d,clientip:_0x3538cf}=_0x440766;return settings[_0x2d7631(0x27f)]==_0x4adf4d&&_0x2b2bf2==_0x3538cf?{'success':_0x2d7631(0x253)}:{'error':_0x2d7631(0x248)};}}},generateLoginToken=_0x49c2de=>{const _0x21eaa9=_0xcab4db;if(_0x49c2de){const _0xe37757=devices[_0x49c2de]['ip'];return jwt[_0x21eaa9(0x297)]({'username':settings['bbUsername'],'clientip':_0xe37757},secure[_0x21eaa9(0x166)]+_0x49c2de,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x46d9ca=>{const _0x4e950c=_0xcab4db;if(_0x46d9ca){const _0x4e5392=devices[_0x46d9ca]['ip'];return jwt[_0x4e950c(0x297)]({'clientip':_0x4e5392},secure['secret']+_0x46d9ca,{'expiresIn':devices[_0x46d9ca][_0x4e950c(0x2ac)][_0x4e950c(0x2e9)]*0x3c});}else return![];},telegramIpApproved=_0x3b6258=>{const _0x2bc076=_0xcab4db;let _0x1520b0=![];return devices[_0x3b6258][_0x2bc076(0x2ac)]&&devices[_0x3b6258][_0x2bc076(0x2ac)][_0x2bc076(0x2e9)]!=_0x2bc076(0x20c)&&(_0x1520b0=devices[_0x3b6258][_0x2bc076(0x2ac)][_0x2bc076(0x23b)]==devices[_0x3b6258]['ip']&&new Date()['getTime']()-devices[_0x3b6258][_0x2bc076(0x2ac)]['timestamp']<devices[_0x3b6258][_0x2bc076(0x2ac)][_0x2bc076(0x2e9)]*0x3c*0x3e8),_0x1520b0;},telegram2FaApproved=_0x197845=>{const _0x228d4c=_0xcab4db;let _0x1c4365=![];return devices[_0x197845][_0x228d4c(0x2d7)]&&devices[_0x197845]['telegram2FaApproval'][_0x228d4c(0x2e9)]!='reject'&&(_0x1c4365=devices[_0x197845][_0x228d4c(0x2d7)][_0x228d4c(0x23b)]==devices[_0x197845]['ip']&&new Date()['getTime']()-devices[_0x197845][_0x228d4c(0x2d7)]['timestamp']<devices[_0x197845][_0x228d4c(0x2d7)][_0x228d4c(0x2e9)]*0x3c*0x3e8),_0x1c4365;},normalizeIP=_0x771752=>{const _0x16b42f=_0xcab4db;let _0x26e98e=null,_0x429a54=null;if(ipaddr[_0x16b42f(0x1e9)](_0x771752)){const _0x5c0aed=ipaddr['parse'](_0x771752);_0x5c0aed[_0x16b42f(0x314)]()==='ipv6'?(_0x5c0aed[_0x16b42f(0x174)]()&&(_0x26e98e=_0x5c0aed[_0x16b42f(0x1d1)]()[_0x16b42f(0x262)]()),_0x429a54=_0x5c0aed['toString']()):(_0x26e98e=_0x5c0aed[_0x16b42f(0x262)](),_0x429a54=_0x5c0aed[_0x16b42f(0x2ef)]()[_0x16b42f(0x262)]());}return{'show':_0x26e98e?_0x26e98e:_0x429a54,'store':_0x429a54};};function formatDate(_0x4ad0cf){const _0x3bc552=_0xcab4db;return _0x4ad0cf[_0x3bc552(0x1a0)]()+'/'+(_0x4ad0cf[_0x3bc552(0x2aa)]()+0x1)['toString']()[_0x3bc552(0x267)](0x2,'0')+'/'+_0x4ad0cf[_0x3bc552(0x188)]()[_0x3bc552(0x262)]()['padStart'](0x2,'0')+'\x20'+_0x4ad0cf[_0x3bc552(0x1ef)]()['toString']()['padStart'](0x2,'0')+':'+_0x4ad0cf['getMinutes']()[_0x3bc552(0x262)]()['padStart'](0x2,'0')+':'+_0x4ad0cf[_0x3bc552(0x2f4)]()[_0x3bc552(0x262)]()[_0x3bc552(0x267)](0x2,'0');}function sleep(_0x50bf33){return new Promise(_0x3347f8=>setTimeout(_0x3347f8,_0x50bf33));}